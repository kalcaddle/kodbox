<?php
 goto Dɽ˿; eʦ: define($_SERVER[][227], 2); define($_SERVER[][228], 3); define($_SERVER[][229], 1); goto bծ; fݭ: class Message { function __construct() { } public function send($c = '', $A独 = array(), $e = "\x74\145\170\164") { goto bĜ; E: Hook::trigger($f޴[1318], $A꾗); goto a״; Dš: $A独 = array($f޴[983] => isset($A独[$f޴[983]]) ? $A独[$f޴[983]] : $f޴[33], $f޴[535] => isset($A独[$f޴[535]]) ? $A独[$f޴[535]] : $f޴[33]); if (empty($c) || empty($A独[$f޴[983]]) && empty($A独[$f޴[535]])) { return !1; } $A꾗 = array($f޴[1257] => $d韚, $f޴[1317] => $A独); goto E; bĜ: $f޴ =& $_SERVER[]; $d韚 = array($f޴[29] => $f޴[1315], $f޴[705] => $c); if (in_array($e, array($f޴[1315], $f޴[1316]))) { $d韚[$f޴[29]] = $e; } goto Dš; a״: } } $C = LIB_DIR . $_SERVER[][1319]; $eƎ = $_SERVER[][1320]; goto aΟ; Dɠ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto F⋟; fķ: $this->in =& $in; $this->values[$a凵[6]] =& $config; $this->values[$a凵[7]] =& $in; goto Aé̆; Aé̆: $this->tpl = TEMPLATE . MOD . $a凵[8]; $this->_classObjectID = mt_rand(0, 10000); goto Aې͗; F⋟: $a凵 =& $_SERVER[]; global $in, $config; $this->config =& $config; goto fķ; Aې͗: } public function loadClass($cР) { if (1 === func_num_args()) { $this->{$cР} = new $cР(); } else { $fߨ = new ReflectionClass($cР); $b׶ӱ = func_get_args(); array_shift($b׶ӱ); $this->{$cР} = $fߨ->newInstanceArgs($b׶ӱ); } return $this->{$cР}; } protected function assign($a瘨, $BȒ) { $this->values[$a瘨] = $BȒ; } protected function display($aצ) { ob_end_clean(); extract($this->values); require $this->tpl . $aצ; } } class DbSqliteBase extends Db { public function __construct($C˶ = '') { $a =& $_SERVER[]; if (!extension_loaded($a[9])) { think_exception(think_lang($a[10]) . $a[11]); } if (!empty($C˶)) { if (!isset($C˶[$a[12]])) { $C˶[$a[12]] = 438; } $this->config = $C˶; if (empty($this->config[$a[13]])) { $this->config[$a[13]] = array(); } } } public function connect($dӐ = '', $b셞 = 0) { $Aܬ =& $_SERVER[]; if (!isset($this->linkID[$b셞])) { goto d; d: if (empty($dӐ)) { $dӐ = $this->config; } $A = !empty($dӐ[$Aܬ[13]][$Aܬ[14]]) ? $dӐ[$Aܬ[13]][$Aܬ[14]] : $this->pconnect; $Dԕ = $A ? $Aܬ[15] : $Aܬ[16]; goto b庌; Eߕ: @sqlite_busy_timeout($this->linkID[$b셞], 30000); if (1 != think_config($Aܬ[18])) { unset($this->config); } goto bٮ; b庌: $this->linkID[$b셞] = $Dԕ($dӐ[$Aܬ[17]], $dӐ[$Aܬ[12]]); if (!$this->linkID[$b셞]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto Eߕ; bٮ: } return $this->linkID[$b셞]; } public function free() { $this->queryID = null; } public function query($dА) { goto e; c孾̗: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $f浜 = $this->getAll(); return $f浜; } goto Fޘ; fꉐ: $this->queryStr = $dА; if ($this->queryID) { $this->free(); } think_action_status($Ať[19], 1); goto fϺߌ; fϺߌ: think_status($Ať[20]); $this->queryID = sqlite_query($this->_linkID, $dА); $this->debug(); goto c孾̗; e: $Ať =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fꉐ; Fޘ: } public function execute($C) { goto a͚; A䝻˧: think_status($eܸ[20]); $Bᥗ = sqlite_exec($this->_linkID, $C); $this->debug(); goto cҟʧ; a͚: $eܸ =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d; d: $this->queryStr = $C; if ($this->queryID) { $this->free(); } think_action_status($eܸ[21], 1); goto A䝻˧; cҟʧ: if (!1 === $Bᥗ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto E㱇; E㱇: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A䍜 = sqlite_query($this->_linkID, $_SERVER[][23]); if (!$A䍜) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $DĐ = sqlite_query($this->_linkID, $_SERVER[][24]); if (!$DĐ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Cˑ = array(); if ($this->numRows > 0) { for ($Cǚ놖 = 0; $Cǚ놖 < $this->numRows; $Cǚ놖++) { $Cˑ[$Cǚ놖] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Cˑ; } public function getFields($fà) { $eտڿѿ =& $_SERVER[]; $fӴ = $this->query($eտڿѿ[25] . $fà . $eտڿѿ[26]); $eҥƃ = array(); if ($fӴ) { foreach ($fӴ as $c => $d) { $eҥƃ[$d[$eտڿѿ[27]]] = array($eտڿѿ[28] => $d[$eտڿѿ[27]], $eտڿѿ[29] => $d[$eտڿѿ[30]], $eտڿѿ[31] => (bool) ($d[$eտڿѿ[32]] === $eտڿѿ[33]), $eտڿѿ[34] => $d[$eտڿѿ[35]], $eտڿѿ[36] => strtolower($d[$eտڿѿ[37]]) == $eտڿѿ[38], $eտڿѿ[39] => strtolower($d[$eտڿѿ[40]]) == $eտڿѿ[41]); } } return $eҥƃ; } public function getTables($fÕ⏢ = '') { $f߉ =& $_SERVER[]; $c⿽ = $this->query($f߉[42] . $f߉[43] . $f߉[44]); $EǙ = array(); foreach ($c⿽ as $B艄 => $b뱅δ) { $EǙ[$B艄] = current($b뱅δ); } return $EǙ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $CΩ =& $_SERVER[]; $F˫ = sqlite_last_error($this->_linkID); $this->error = $F˫ . $CΩ[4] . sqlite_error_string($F˫); if ($CΩ[33] != $this->queryStr) { $this->error .= LNG($CΩ[45]) . $this->queryStr; } think_trace($this->error, $CΩ[33], $CΩ[46]); return $this->error; } public function escapeString($eᜐ) { return sqlite_escape_string($eᜐ); } public function parseLimit($D峽) { $bܽξ =& $_SERVER[]; $cц = $bܽξ[33]; if (!empty($D峽)) { $D峽 = explode($bܽξ[47], $D峽); if (count($D峽) > 1) { $cц .= $bܽξ[48] . $D峽[1] . $bܽξ[49] . $D峽[0] . $bܽξ[50]; } else { $cц .= $bܽξ[48] . $D峽[0] . $bܽξ[50]; } } return $cц; } } class DbSqlite3Base extends Db { public function __construct($a = '') { $F =& $_SERVER[]; if (!class_exists($F[51])) { think_exception(think_lang($F[10]) . $F[52]); } if (!empty($a)) { if (!isset($a[$F[12]])) { $a[$F[12]] = 438; } $this->config = $a; if (empty($this->config[$F[13]])) { $this->config[$F[13]] = array(); } } } public function connect($D䂳 = '', $bĵ = 0) { $A =& $_SERVER[]; if (!isset($this->linkID[$bĵ])) { if (empty($D䂳)) { $D䂳 = $this->config; } $this->linkID[$bĵ] = new SQLite3($D䂳[$A[17]]); if (!$this->linkID[$bĵ]) { think_exception($this->linkID[$bĵ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$bĵ]->busyTimeout(30000); if (1 != think_config($A[18])) { unset($this->config); } } return $this->linkID[$bĵ]; } public function free() { $this->queryID = null; } public function query($bӝꇽ) { goto EΡ; aŬ㼂: think_status($D[20]); $this->queryID = $this->_linkID->query($bӝꇽ); $this->debug(); goto EА; EΡ: $D =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Cȳ; EА: if (!1 === $this->queryID) { $this->error(); return !1; } else { $dɈޅ = $this->getAll(); $this->numRows = count($dɈޅ); return $dɈޅ; } goto fͷ; Cȳ: $this->queryStr = $bӝꇽ; if ($this->queryID) { $this->free(); } think_action_status($D[19], 1); goto aŬ㼂; fͷ: } public function execute($eՔ) { goto F֗; b䈆: think_status($C[20]); $b; = $this->_linkID->exec($eՔ); $this->debug(); goto B뇲; B뇲: if (!1 === $b;) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto aֲ; aݕ: $this->queryStr = $eՔ; if ($this->queryID) { $this->free(); } think_action_status($C[21], 1); goto b䈆; F֗: $C =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aݕ; aֲ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Fۙ = $this->_linkID->query($_SERVER[][23]); if (!$Fۙ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $AƝ = $this->_linkID->query($_SERVER[][24]); if (!$AƝ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Eح = array(); while ($E = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Eح[] = $E; } $this->queryID->reset(); return $Eح; } public function getFields($a̚쇨) { $C =& $_SERVER[]; $Aؔ = $this->query($C[25] . $a̚쇨 . $C[26]); $Aۜ = array(); if ($Aؔ) { foreach ($Aؔ as $dϺ߲ => $bȈ) { $Aۜ[$bȈ[$C[28]]] = array($C[28] => $bȈ[$C[28]], $C[29] => $bȈ[$C[29]], $C[31] => (bool) ($bȈ[$C[31]] === $C[33]), $C[34] => $bȈ[$C[53]], $C[36] => (bool) $bȈ[$C[54]], $C[39] => (bool) $bȈ[$C[54]]); } } return $Aۜ; } public function getTables($Aұ߸ = '') { $Fվૣ =& $_SERVER[]; $F = $this->query($Fվૣ[42] . $Fվૣ[43] . $Fվૣ[44]); $bꃃ = array(); foreach ($F as $eު => $EÈ) { $bꃃ[$eު] = current($EÈ); } return $bꃃ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $cٍ =& $_SERVER[]; $this->error = $this->_linkID->lastErrorMsg(); if ($cٍ[33] != $this->queryStr) { $this->error .= LNG($cٍ[45]) . $this->queryStr; } think_trace($this->error, $cٍ[33], $cٍ[46]); return $this->error; } public function escapeString($fᩥՠ) { $eˤ =& $_SERVER[]; if ($this->_linkID) { return $this->_linkID->escapeString($fᩥՠ); } return str_ireplace($eˤ[55], $eˤ[56], $fᩥՠ); } public function parseLimit($BЛ锡) { $Dۭ =& $_SERVER[]; $bĜ = $Dۭ[33]; if (!empty($BЛ锡)) { $BЛ锡 = explode($Dۭ[47], $BЛ锡); if (count($BЛ锡) > 1) { $bĜ .= $Dۭ[48] . $BЛ锡[1] . $Dۭ[49] . $BЛ锡[0] . $Dۭ[50]; } else { $bĜ .= $Dۭ[48] . $BЛ锡[0] . $Dۭ[50]; } } return $bĜ; } } goto Eč; F: class HttpAuth { public static function get() { $B =& $_SERVER[]; $Bꦲ = $B[33]; $E = $B[33]; if (isset($_SERVER[$B[1774]])) { $Bꦲ = $_SERVER[$B[1774]]; $E = $_SERVER[$B[1775]]; } elseif (isset($_SERVER[$B[1776]])) { $eԽ = $_SERVER[$B[1776]]; if (strpos(strtolower($eԽ), $B[1777]) === 0) { $D = explode($B[4], base64_decode(substr($eԽ, 6))); $Bꦲ = isset($D[0]) ? $D[0] : $B[33]; $E = isset($D[1]) ? $D[1] : 0; } } return array($B[535] => $Bꦲ, $B[909] => $E); } public static function error() { goto C; e: header($Fŝ[1780]); header($Fŝ[1781]); header($Fŝ[1274]); goto AŔ; C: $Fŝ =& $_SERVER[]; header($Fŝ[1778]); header($Fŝ[1779]); goto e; AŔ: die; goto C; C: } public static function make($c߱, $eԉ) { $B =& $_SERVER[]; return $B[1782] + base64_encode($c߱ . $B[4] . $eԉ); } } class HttpDavClient { public function __construct($fړ, $c̶ϱ, $c暰΄) { $this->header = array(); $this->userName = $c̶ϱ; $this->userPassowrd = $c暰΄; } protected function makePath($Eǹ) { return $Eǹ; } protected function setHeader($a, $Aџ銨 = false) { if ($Aџ銨 === !1) { $this->header[] = $a; } else { $this->header[] = $a . $_SERVER[][892] . $Aџ銨; } } public function move($Aܻׄ, $Eʤ, $F = '') { $d؍ =& $_SERVER[]; $this->setHeader($d؍[1783], $this->makePath($Eʤ)); $this->setHeader($d؍[1784], $d؍[1785]); if ($F) { $this->setHeader($d؍[1786], $d؍[937] . $F . $d؍[940]); } return $this->send($d؍[1787], $Aܻׄ); } public function copy($cݐ, $Dܐ) { $Fێ =& $_SERVER[]; $this->setHeader($Fێ[1783], $this->makePath($Dܐ)); $this->setHeader($Fێ[1784], $Fێ[1785]); return $this->send($Fێ[1788], $cݐ); } public function mkcol($C) { $Ať؏ =& $_SERVER[]; $this->setHeader($Ať؏[1784], $Ať؏[1785]); return $this->send($Ať؏[1789], $C); } public function delete($cٛ, $FІս = '') { $b =& $_SERVER[]; if ($FІս) { $this->setHeader($b[1786], $b[937] . $FІս . $b[940]); } return $this->send($b[1262], $cٛ); } public function propfind($f픖) { $dŸ =& $_SERVER[]; $this->setHeader($dŸ[1790], $dŸ[83]); $this->setHeader($dŸ[1791], $dŸ[1792]); $EƖ = $dŸ[1793]; return $this->send($dŸ[1794], $f픖, $EƖ); } public function options($B) { return $this->send($_SERVER[][1795], $B); } public function get($f押λ) { return $this->send($_SERVER[][216], $f押λ); } public function put($B, $e߉, $bڐ = '') { $DҬ =& $_SERVER[]; if ($bڐ) { $this->setHeader($DҬ[1786], $DҬ[937] . $bڐ . $DҬ[940]); } return $this->send($DҬ[214], $B, $e߉); } protected function send($A햄ح, $Dŉĝ, $F = false, $a = false) { goto Bڇ; f: curl_setopt($E٧ȓ, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($E٧ȓ, CURLOPT_SSL_VERIFYHOST, !1); $e = curl_exec($E٧ȓ); goto B͐; Aނᆷ: $this->setHeader($EԐ); if ($F) { $F = $Eۨ[1797] . $F; } if (!request_url_safe($Dŉĝ)) { return !1; } goto e; e: curl_setopt($E٧ȓ, CURLOPT_HTTPHEADER, $this->header); curl_setopt($E٧ȓ, CURLOPT_RETURNTRANSFER, !0); curl_setopt($E٧ȓ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto f; Bڇ: $Eۨ =& $_SERVER[]; $EԐ = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($Eۨ[1796], $Eۨ[50]); goto Aނᆷ; B͐: $this->header = array(); return $e; goto D; e: $E٧ȓ = curl_init($Dŉĝ); curl_setopt($E٧ȓ, CURLOPT_CUSTOMREQUEST, $A햄ح); curl_setopt($E٧ȓ, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto e; D: } } class HttpDavServer { public function __construct($bɴߗ, $aР) { $this->root = $bɴߗ; $this->initPath($aР); $this->start(); } public function initPath($eϢ) { $aθ =& $_SERVER[]; $d׉ˇ = rtrim($_SERVER[$aθ[1402]], $aθ[8]) . $aθ[8]; $this->urlBase = substr($d׉ˇ, 0, strpos($d׉ˇ, $eϢ) + 1); $this->urlBase = rtrim($this->urlBase, $aθ[8]) . $eϢ; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $d =& $_SERVER[]; $Dˈ = HttpAuth::get(); if ($Dˈ[$d[535]] == $d[1798] && $Dˈ[$d[909]] == $d[1799]) { return !0; } HttpAuth::error(); } public function start() { goto f; f: $e =& $_SERVER[]; $this->checkUser(); $e = $e[144] . HttpHeader::method(); goto fУɲ; fУɲ: if (!method_exists($this, $e)) { pr($e . $e[1800]); die; } $a⎗ = array($e[1801], $e[1802]); if (!in_array($e, $a⎗) && !$this->pathExists($this->path)) { $fû = array($e[1042] => 404); } else { $fû = $this->{$e}(); } goto a΋҄; a΋҄: if (!$fû) { return; } self::response($fû); goto e莎; e莎: } public function pathGet($D = false) { $dΤ =& $_SERVER[]; $aǑ = $D ? $_SERVER[$dΤ[1803]] : $_SERVER[$dΤ[1402]]; $aǑ = KodIO::clear(rawurldecode($aǑ)); if (!strstr($aǑ, KodIO::clear($this->urlBase))) { return !1; } return substr($aǑ, strpos($aǑ, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($c) { return file_exists($c); } public function pathMkdir($aͽ) { return mkdir($aͽ, 511, !0); } public function pathInfo($a) { return path_info($a); } public function pathList($c) { return path_list($c); } public function pathOut($F鉠ͫ) { echo file_get_contents($F鉠ͫ); } public function pathPut($FĶŎ, $e߃ = '') { if (!$e߃) { return file_put_contents($FĶŎ, $_SERVER[][33]); } return move_path($e߃, $FĶŎ); } public function pathRemove($Cן) { if (is_file($Cן)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($c̅, $aЄ) { return move_path($c̅, $aЄ); } public function pathCopy($c٥, $fߒ) { return copy_dir($c٥, $fߒ); } public function parsePath($cׄ) { return $cׄ; } public function parseItem($f͚, $Dح) { goto eѻ௭; AẴѻ: $Fͥ氶 = array($fɜ[1804] => KodIO::clear($this->urlBase . $c), $fɜ[107] => @gmdate($fɜ[1805], $f͚[$fɜ[107]]), $fɜ[187] => @gmdate($fɜ[1806], $f͚[$fɜ[187]]), $fɜ[77] => $f͚[$fɜ[77]] ? $f͚[$fɜ[77]] : 0); return $Fͥ氶; goto F瞰ǒ; f䟼ǪØ: if ($Dح) { $c = $fɜ[8] . str_replace($fɜ[172], $fɜ[8], rawurlencode($this->pathGet())); } if (!trim($f͚[$fɜ[107]])) { $f͚[$fɜ[107]] = time(); } if (!trim($f͚[$fɜ[187]])) { $f͚[$fɜ[187]] = time(); } goto AẴѻ; eѻ௭: $fɜ =& $_SERVER[]; $c = $this->pathGet() . $fɜ[8] . $f͚[$fɜ[28]]; $c = $fɜ[8] . str_replace($fɜ[172], $fɜ[8], rawurlencode($c)); goto f䟼ǪØ; F瞰ǒ: } public function parseItemXml($Bޡ, $aβ) { $f֤ =& $_SERVER[]; $Cތ = $this->parseItem($Bޡ, $aβ); if ($Bޡ[$f֤[29]] == $f֤[76]) { $e = $f֤[1807]; $e .= $f֤[1808]; } else { $fÌ = $Bޡ[$f֤[160]] ? $Bޡ[$f֤[160]] : get_path_ext($Bޡ[$f֤[28]]); $B = get_file_mime($fÌ); $e = $f֤[1809]; $e .= "\x3c\104\x3a\x67\145\164\143\157\156\164\145\x6e\x74\x74\171\160\x65\x3e{$B}\74\57\x44\72\147\145\164\x63\157\x6e\164\x65\x6e\164\x74\x79\x70\145\76"; } return "\12\x9\11\x3c\x44\72\162\145\x73\160\x6f\156\163\x65\76\12\11\11\11\74\104\72\x68\162\x65\x66\x3e{$Cތ[$f֤[1804]]}\x3c\57\104\x3a\150\x72\145\x66\x3e\xa\x9\x9\x9\74\104\x3a\160\x72\157\x70\x73\x74\x61\164\76\xa\x9\11\x9\11\74\x44\72\160\x72\x6f\160\x3e\xa\11\11\x9\11\11\74\x44\x3a\147\145\x74\x6c\x61\x73\164\155\157\x64\x69\x66\x69\x65\144\x3e{$Cތ[$f֤[107]]}\x3c\x2f\x44\x3a\x67\145\x74\x6c\x61\163\x74\x6d\x6f\144\151\x66\x69\145\x64\76\12\x9\x9\11\11\x9\x3c\104\x3a\x63\x72\x65\141\164\151\x6f\x6e\x64\141\164\145\76{$Cތ[$f֤[187]]}\74\57\x44\72\143\x72\145\141\x74\x69\x6f\156\x64\x61\x74\x65\76\12\11\x9\x9\x9\x9\74\x44\x3a\x67\x65\164\143\157\x6e\164\145\156\x74\154\x65\x6e\x67\164\x68\x3e{$Cތ[$f֤[77]]}\74\57\x44\72\x67\x65\164\143\x6f\156\164\x65\x6e\x74\154\145\156\x67\164\150\76\xa\11\x9\11\11\11{$e}\12\x9\x9\x9\x9\74\57\x44\x3a\160\x72\157\x70\x3e\xa\x9\11\x9\x9\74\104\72\163\164\x61\x74\165\x73\x3e\x48\x54\124\x50\x2f\x31\x2e\61\40\62\60\60\x20\117\x4b\74\x2f\x44\x3a\163\x74\141\x74\165\163\76\12\x9\x9\x9\74\x2f\x44\x3a\x70\x72\x6f\x70\x73\164\141\164\x3e\xa\11\11\x3c\57\x44\x3a\162\145\x73\160\157\x6e\163\145\76"; } public function pathListMerge($eڅ) { goto c㙡; cӺ妎: return $eҬ; goto f; c㙡: $eŐ =& $_SERVER[]; if (!$eڅ) { return $eڅ; } $C = array($eŐ[73], $eŐ[74], $eŐ[1810]); goto Eֆ; Eֆ: $eҬ = array(); foreach ($eڅ as $eҼ => $F؈) { if (!in_array($eҼ, $C) || !is_array($F؈)) { continue; } $eҬ = array_merge($eҬ, $F؈); } foreach ($eҬ as &$b٩ٴ) { $b٩ٴ[$eŐ[28]] = str_replace($eŐ[8], $eŐ[1404], $b٩ٴ[$eŐ[28]]); } goto cӺ妎; f: } public function httpPROPFIND() { goto F֏; BŚ: if ($A잔) { $a嗠 = array($bȽ); } else { $bȽ[$F皭[28]] = $F皭[33]; $a嗠 = array_merge(array($bȽ), $a嗠); } $d󺍹 = $F皭[33]; foreach ($a嗠 as $bć) { $d󺍹 .= $this->parseItemXml($bć, $A잔); } goto dǙ; DǧԵ: $bȽ = $Aӷϼ[$F皭[1811]]; if (!is_array($a嗠) || $bȽ[$F皭[1812]] === !1) { return array($F皭[1813] => 404, $F皭[1814] => $F皭[1815]); } $A잔 = $bȽ[$F皭[29]] == $F皭[167] || HttpHeader::get($F皭[1790]) == $F皭[468]; goto BŚ; dǙ: return array($F皭[1813] => 207, $F皭[1814] => "\74\x44\72\155\165\x6c\x74\x69\x73\164\x61\x74\165\163\40\x78\x6d\x6c\x6e\163\x3a\x44\75\42\x44\x41\126\x3a\42\x3e\xa{$d󺍹}\12\x3c\57\104\x3a\x6d\165\x6c\164\151\163\x74\x61\x74\x75\163\76"); goto fȽ; F֏: $F皭 =& $_SERVER[]; $Aӷϼ = $this->pathList($this->path); $a嗠 = $this->pathListMerge($Aӷϼ); goto DǧԵ; fȽ: } public function httpHEAD() { $F葨߃ =& $_SERVER[]; $bܚ = $this->pathInfo($this->path); if (!$bܚ || $bܚ[$F葨߃[29]] == $F葨߃[76]) { return array($F葨߃[1042] => 200, $F葨߃[1218] => array($F葨߃[1816])); } return array($F葨߃[1042] => 200, $F葨߃[1218] => array($F葨߃[1817], $F葨߃[136], $F葨߃[1818] . $bܚ[$F葨߃[77]], $F葨߃[1819] . get_file_mime($bܚ[$F葨߃[160]]), $F葨߃[132] . gmdate($F葨߃[1805], $bܚ[$F葨߃[1265]]) . $F葨߃[1820], $F葨߃[1821])); } public function httpOPTIONS() { $bٕ޲ =& $_SERVER[]; return array($bٕ޲[1042] => 200, $bٕ޲[1218] => array($bٕ޲[1822], $bٕ޲[1823], $bٕ޲[1824], $bٕ޲[1274])); } public function httpPROPPATCH() { $d̚ =& $_SERVER[]; $EΝ = $d̚[1825] . $_SERVER[$d̚[1402]] . $d̚[1826]; return array($d̚[1813] => 207, $d̚[1814] => "\74\104\72\155\165\154\164\x69\163\164\141\x74\x75\163\x20\x78\155\x6c\x6e\163\x3a\104\75\42\104\101\126\72\42\76\xa{$EΝ}\12\x3c\x2f\x44\72\x6d\x75\154\164\151\163\164\x61\x74\165\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $b =& $_SERVER[]; $Aú = $this->uploadFile(); if ($Aú) { $B = 204; } else { $Aú = $b[33]; $B = 201; } $f = $this->pathPut($this->path, $Aú); if ($f == !1) { $B = 404; } return array($b[1813] => $B); } private function uploadFile() { goto C; F: $eٴ· = @fopen($d砆Ҕ, $F ʖ[1536]); $C٫ = @fopen($F ʖ[1828], $F ʖ[1535]); if (!$C٫ || !$eٴ·) { @unlink($d砆Ҕ); return !1; } goto C; C: $F ʖ =& $_SERVER[]; @mk_dir(TEMP_FILES); $d砆Ҕ = TEMP_FILES . $F ʖ[1827] . rand_string(32); goto F; E͊: if (@filesize($d砆Ҕ) > 0) { return $d砆Ҕ; } @unlink($d砆Ҕ); return !1; goto DɆͫ; C: while (!feof($C٫)) { fwrite($eٴ·, fread($C٫, 1024 * 200)); } fclose($C٫); fclose($eٴ·); goto E͊; DɆͫ: } public function httpMKCOL() { $A떬Ŋ =& $_SERVER[]; if ($this->pathExists($this->path)) { return array($A떬Ŋ[1042] => 409); } $Dӆ = $this->pathMkdir($this->path); return array($A떬Ŋ[1042] => $Dӆ ? 201 : 403); } public function httpMOVE() { $c =& $_SERVER[]; $aḯ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$c[1829]])) { $C[$c[1830]] = $_SERVER[$c[1829]] == $c[1831]; } $ĉ = $this->pathMove($this->path, $aḯ); return array($c[1042] => $ĉ ? 201 : 404); } public function httpCOPY() { $c癬 = $this->parsePath($this->pathGet(!0)); $cϬ = $this->pathCopy($this->path, $c癬); return array($_SERVER[][1042] => $cϬ ? 201 : 404); } public function httpDELETE() { $e۠ = $this->pathRemove($this->path); return array($_SERVER[][1042] => $e۠ ? 200 : 503); } public function httpLOCK() { $cۚ =& $_SERVER[]; $a = md5($this->path); $A = $cۚ[1832] . $this->xmlGet($cۚ[1833]) . $cۚ[1834] . $a . $cۚ[1835]; return array($cۚ[1042] => 200, $cۚ[1218] => array($cۚ[1836] . $a, $cۚ[1837]), $cۚ[1838] => $A); } public function httpUNLOCK() { return array($_SERVER[][1042] => 204); } public function xmlGet($B) { goto cʮյ; cʮյ: $AϞ =& $_SERVER[]; static $d͘ʠ = false; if (!$d͘ʠ) { $Fݭ = file_get_contents($AϞ[1839]); $d͘ʠ = new DOMDocument(); $d͘ʠ->loadXML($Fݭ); } goto bՂ; BұҌ݆: return $AϞ[33]; goto b΅; bՂ: $e = array_shift(explode($AϞ[8], $B)); $C = $d͘ʠ->getElementsByTagNameNS($AϞ[1840], $e); if ($C) { return $C[0]->nodeValue; } goto BұҌ݆; b΅: } public static function response($bŪ) { goto Dͣ; Dͣ: $E =& $_SERVER[]; $D = is_array($bŪ[$E[1218]]) ? $bŪ[$E[1218]] : array(); $D[] = HttpHeader::code($bŪ[$E[1042]]); goto c׮; c׮: $D[] = $E[1780]; $D[] = $E[1781]; foreach ($D as $e) { header($e); } goto Eκޥ; Eκޥ: if (is_string($bŪ[$E[1838]])) { header($E[1841]); $Eԩ = $E[1842] . $E[217] . $bŪ[$E[1838]]; echo $Eԩ; } goto B㌘; B㌘: } } goto c; bծ: define($_SERVER[][230], 0); define($_SERVER[][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\154\x65", "\x6f\x72\144\x65\x72", "\x61\x6c\151\141\x73", "\150\141\166\x69\x6e\x67", "\147\x72\x6f\165\x70", "\x6c\x6f\143\153", "\x64\x69\163\x74\x69\x6e\143\x74", "\141\x75\x74\x6f", "\x66\x69\154\164\x65\x72", "\x76\141\x6c\151\144\x61\164\x65", "\x72\145\x73\x75\x6c\164", "\x62\x69\x6e\x64", "\164\157\153\x65\156"); public function __construct($Eܛݲ = '', $Fؔ = '', $F = '') { $A =& $_SERVER[]; $this->_initialize(); if (!empty($Eܛݲ)) { if (strpos($Eܛݲ, $A[91])) { list($this->dbName, $this->name) = explode($A[91], $Eܛݲ); } else { $this->name = $Eܛݲ; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($Fؔ)) { $this->tablePrefix = $A[33]; } elseif ($A[33] != $Fؔ) { $this->tablePrefix = $Fؔ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($A[232]); } $this->db(0, empty($this->connection) ? $F : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $b =& $_SERVER[]; if (empty($this->fields)) { if (think_config($b[233])) { $bɖ݌ = $this->dbName ? $this->dbName : think_config($b[234]); $cãհ = think_var_cache($b[235] . strtolower(get_path_this($bɖ݌) . $b[91] . $this->name)); if ($cãհ) { $cĻ = think_config($b[236]); if (empty($cĻ) || $cãհ[$b[237]] == $cĻ) { $this->fields = $cãհ; return; } } } $this->flush(); } } public function flush() { goto a͸ǲ; Dأ: foreach ($E as $C => $c̅) { $BՈ[$C] = $c̅[$dք[29]]; if ($c̅[$dք[36]]) { $this->fields[$dք[239]] = $C; if ($c̅[$dք[39]]) { $this->fields[$dք[238]] = !0; } } } $this->fields[$dք[240]] = $BՈ; if (think_config($dք[236])) { $this->fields[$dք[237]] = think_config($dք[236]); } goto b𽄩; a͸ǲ: $dք =& $_SERVER[]; $this->db->setModel($this->name); $E = $this->db->getFields($this->getTableName()); goto cܚ; cܚ: if (!$E) { return !1; } $this->fields = array_keys($E); $this->fields[$dք[238]] = !1; goto Dأ; b𽄩: if (think_config($dք[233])) { $Eσ = $this->dbName ? $this->dbName : think_config($dք[234]); think_var_cache($dք[235] . strtolower(get_path_this($Eσ) . $dք[91] . $this->name), $this->fields); } goto A; A: } public function switchModel($E, $Aۊ = array()) { $Aք =& $_SERVER[]; $cЅ = ucwords(strtolower($E)) . $Aք[241]; if (!class_exists($cЅ)) { think_exception($cЅ . think_lang($Aք[242])); } $this->_extModel = new $cЅ($this->name); if (!empty($Aۊ)) { foreach ($Aۊ as $F) { $this->_extModel->setProperty($F, $this->{$F}); } } return $this->_extModel; } public function __set($B, $f) { $this->data[$B] = $f; } public function __get($e޾) { return isset($this->data[$e޾]) ? $this->data[$e޾] : null; } public function __isset($D۠) { return isset($this->data[$D۠]); } public function __unset($Fݏ) { unset($this->data[$Fݏ]); } public function __call($e⛃, $Eұ) { $B =& $_SERVER[]; if (in_array(strtolower($e⛃), $this->methods, !0)) { $this->options[strtolower($e⛃)] = $Eұ[0]; return $this; } elseif (in_array(strtolower($e⛃), array($B[243], $B[244], $B[245], $B[246], $B[247]), !0)) { $Fߒ = isset($Eұ[0]) ? $Eұ[0] : $B[176]; $Fߒ = $this->db->parseKey($Fߒ); return $this->getField(strtoupper($e⛃) . $B[248] . $Fߒ . $B[249] . $e⛃, $B[243]); } elseif (strtolower(substr($e⛃, 0, 5)) == $B[250]) { $Fߒ = think_parse_name(substr($e⛃, 5)); $ė[$Fߒ] = $Eұ[0]; return $this->where($ė)->find(); } elseif (strtolower(substr($e⛃, 0, 10)) == $B[251]) { $F٣ = think_parse_name(substr($e⛃, 10)); $ė[$F٣] = $Eұ[0]; return $this->where($ė)->getField($Eұ[1]); } elseif (isset($this->_scope[$e⛃])) { return $this->scope($e⛃, $Eұ[0]); } elseif (method_exists($this, $e⛃)) { array_unshift($Eұ, $e⛃); return call_user_func_array(array($this, $B[252]), $Eұ); } else { return call_user_func_array(array(parent, $e⛃), $Eұ); } } protected function call() { goto f; D،ۉ: if (isset($d[$f]) && $d[$f] === $aӆ) { think_exception(__CLASS__ . $a[4] . $aӆ . think_lang($a[253])); return; } $d[] = $aӆ; if (method_exists($this, $a[254])) { $C = call_user_func_array(array($this, $a[255]), array($aۤ, $d)); if (!is_null($C) && $C !== !1) { return $C; } } goto d֣; b: $aۤ = $aӆ; if (is_array($aӆ)) { $aۤ = $aӆ[1]; $aӆ = $aӆ[0]; } $f = count($d) - 1; goto D،ۉ; f: $a =& $_SERVER[]; $d = func_get_args(); $aӆ = array_shift($d); goto b; d֣: $CЭϘ = call_user_func_array(array($this, $aӆ), $d); if (method_exists($this, $a[256])) { $C = call_user_func_array(array($this, $a[257]), array($aۤ, $d, $CЭϘ)); if ($C) { return $C; } } return $CЭϘ; goto Dᑫ; Dᑫ: } protected function _initialize() { } protected function _facade($eⓇ) { $a둬 =& $_SERVER[]; if (!empty($this->fields)) { foreach ($eⓇ as $CӛƄ => $fˊ) { if (!in_array($CӛƄ, $this->fields, !0)) { unset($eⓇ[$CӛƄ]); } elseif (is_scalar($fˊ)) { $this->_parseType($eⓇ, $CӛƄ); } } } if (!empty($this->options[$a둬[258]])) { $eⓇ = array_map($this->options[$a둬[258]], $eⓇ); unset($this->options[$a둬[258]]); } $this->_beforeWrite($eⓇ); return $eⓇ; } protected function _beforeWrite(&$c) { } public function add($D֡ = '', $aȱ = array(), $d = false) { goto B; C: return $Aִ; goto E; B: if (empty($D֡)) { if (!empty($this->data)) { $D֡ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[][259]); return !1; } } $aȱ = $this->_parseOptions($aȱ); $D֡ = $this->_facade($D֡); goto aڦ; aڦ: if (!1 === $this->_beforeInsert($D֡, $aȱ)) { return !1; } $Aִ = $this->db->insert($D֡, $aȱ, $d); if (!1 !== $Aִ) { $b碭񉺎 = $this->getLastInsID(); if ($b碭񉺎) { $D֡[$this->getPk()] = $b碭񉺎; $this->_after_insert($D֡, $aȱ); return $b碭񉺎; } $this->_after_insert($D֡, $aȱ); } goto C; E: } protected function _beforeInsert(&$a˘, $F) { } protected function _after_insert($bıܿ, $c) { } public function addAll($cܛ, $a鰝 = array(), $fЬ޴ = false) { goto bȮ; c؞: foreach ($cܛ as $CȪؚ => $bҎ) { $cܛ[$CȪؚ] = $this->_facade($bҎ); } if (method_exists($this->db, $Aň[260])) { $aǕք = $this->db->insertAll($cܛ, $a鰝, $fЬ޴); } else { $this->startTrans(); foreach ($cܛ as $CȪؚ => $bҎ) { $aǕք = $this->db->insert($bҎ, $a鰝, $fЬ޴); } $this->commit(); } if (!1 !== $aǕք) { $aږǦ = $this->getLastInsID(); if ($aږǦ) { return $aږǦ; } } goto Fܞ; Fܞ: return $aǕք; goto b룕; bȮ: $Aň =& $_SERVER[]; if (empty($cܛ)) { $this->error = think_lang($Aň[259]); return !1; } $a鰝 = $this->_parseOptions($a鰝); goto c؞; b룕: } public function selectAdd($a = '', $f۞ = '', $fߘ = array()) { $dݫʽ =& $_SERVER[]; $fߘ = $this->_parseOptions($fߘ); if (!1 === ($Bὅ = $this->db->selectInsert($a ? $a : $fߘ[$dݫʽ[261]], $f۞ ? $f۞ : $this->getTableName(), $fߘ))) { $this->error = think_lang($dݫʽ[262]); return !1; } else { return $Bὅ; } } public function save($C = '', $d̒ = array()) { goto C; Eܻ: if (!1 !== $d̆) { if (isset($cĶ)) { $C[$d] = $cĶ; } $this->_afterUpdate($C, $d̒); } return $d̆; goto A҈݈; Eѝ: $d̒ = $this->_parseOptions($d̒); $d = $this->getPk(); if (!isset($d̒[$A[263]])) { if (isset($C[$d])) { $Eë󞮔[$d] = $C[$d]; $d̒[$A[263]] = $Eë󞮔; unset($C[$d]); } else { $this->error = think_lang($A[262]); return !1; } } goto a; C: $A =& $_SERVER[]; if (empty($C)) { if (!empty($this->data)) { $C = $this->data; $this->data = array(); } else { $this->error = think_lang($A[259]); return !1; } } $C = $this->_facade($C); goto Eѝ; a: if (is_array($d̒[$A[263]]) && isset($d̒[$A[263]][$d])) { $cĶ = $d̒[$A[263]][$d]; } if (!1 === $this->_beforeUpdate($C, $d̒)) { return !1; } $d̆ = $this->db->update($C, $d̒); goto Eܻ; A҈݈: } protected function _beforeUpdate(&$E, $B˄ϡ) { } protected function _afterUpdate($f·, $Bւ) { } public function delete($F = array()) { goto d; BЋ: $b = $this->db->delete($F); if (!1 !== $b) { $e = array(); if (isset($Fƾ)) { $e[$fѬ] = $Fƾ; } $this->_after_delete($e, $F); } return $b; goto EҾ; Eďȹ: if (is_numeric($F) || is_string($F)) { if (strpos($F, $c[47])) { $e٤ڕ[$fѬ] = array($c[264], $F); } else { $e٤ڕ[$fѬ] = $F; } $this->options[$c[263]] = $e٤ڕ; } $F = $this->_parseOptions(); if (is_array($F[$c[263]]) && isset($F[$c[263]][$fѬ])) { $Fƾ = $F[$c[263]][$fѬ]; } goto BЋ; d: $c =& $_SERVER[]; if (empty($F) && empty($this->options[$c[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $fѬ = $this->getPk(); goto Eďȹ; EҾ: } protected function _after_delete($d, $bۥ) { } public function select($d = array()) { goto e; e: $dЦ =& $_SERVER[]; if (is_string($d) || is_numeric($d)) { $D = $this->getPk(); if (strpos($d, $dЦ[47])) { $Fێ[$D] = array($dЦ[264], $d); } else { $Fێ[$D] = $d; } $this->options[$dЦ[263]] = $Fێ; } elseif (!1 === $d) { $d = $this->_parseOptions(); return $dЦ[265] . $this->db->buildSelectSql($d) . $dЦ[266]; } $d = $this->_parseOptions(); goto cύ렏; E՜: $this->_afterSelect($Cؤ잓, $d); return $Cؤ잓; goto aݿ; cύ렏: $Cؤ잓 = $this->db->select($d); if (!1 === $Cؤ잓) { return !1; } if (empty($Cؤ잓)) { return null; } goto E՜; aݿ: } protected function _afterSelect(&$Bș, $F) { } public function buildSql($B٣ = array()) { $b =& $_SERVER[]; $B٣ = $this->_parseOptions($B٣); return $b[265] . $this->db->buildSelectSql($B٣) . $b[266]; } public function optionsValue($AÉڔԑ = null) { if (is_null($AÉڔԑ)) { return $this->options; } elseif (is_array($AÉڔԑ)) { $this->options = array_merge($this->options, $AÉڔԑ); } } protected function _parseOptions($Eԃ맋 = array()) { goto Fո; e̒ݦ: if (!isset($Eԃ맋[$B̮[267]])) { $Eԃ맋[$B̮[267]] = $this->getTableName(); $b = $this->fields; } else { $b = $this->getDbFields(); } if (!empty($Eԃ맋[$B̮[268]])) { $Eԃ맋[$B̮[267]] .= $B̮[50] . $Eԃ맋[$B̮[268]]; } $Eԃ맋[$B̮[269]] = $this->name; goto Cīʋ; Fո: $B̮ =& $_SERVER[]; if (is_array($Eԃ맋)) { $Eԃ맋 = array_merge($this->options, $Eԃ맋); } $this->options = array(); goto e̒ݦ; Cīʋ: if (isset($Eԃ맋[$B̮[263]]) && is_array($Eԃ맋[$B̮[263]]) && !empty($b) && !isset($Eԃ맋[$B̮[270]]) && !isset($Eԃ맋[$B̮[267]])) { foreach ($Eԃ맋[$B̮[263]] as $C쌼 => $aڋ) { $C쌼 = trim($C쌼); if (in_array($C쌼, $b, !0)) { if (is_scalar($aڋ)) { $this->_parseType($Eԃ맋[$B̮[263]], $C쌼); } } elseif (!is_numeric($C쌼) && $B̮[70] != substr($C쌼, 0, 1) && !1 === strpos($C쌼, $B̮[91]) && !1 === strpos($C쌼, $B̮[248]) && !1 === strpos($C쌼, $B̮[271]) && !1 === strpos($C쌼, $B̮[272])) { unset($Eԃ맋[$B̮[263]][$C쌼]); } } } $this->_options_filter($Eԃ맋); return $Eԃ맋; goto cڮ; cڮ: } protected function _options_filter(&$FƆ) { } protected function _parseType(&$fٗڿ, $f) { $e؃䞎բ =& $_SERVER[]; if (empty($this->options[$e؃䞎բ[273]][$e؃䞎բ[4] . $f])) { $cĿ = strtolower($this->fields[$e؃䞎բ[240]][$f]); if (!1 !== strpos($cĿ, $e؃䞎բ[274])) { } elseif (!1 === strpos($cĿ, $e؃䞎բ[275]) && !1 !== strpos($cĿ, $e؃䞎բ[276])) { $fٗڿ[$f] = intval($fٗڿ[$f]); } elseif (!1 !== strpos($cĿ, $e؃䞎բ[277]) || !1 !== strpos($cĿ, $e؃䞎բ[278])) { $fٗڿ[$f] = floatval($fٗڿ[$f]); } elseif (!1 !== strpos($cĿ, $e؃䞎բ[279])) { $fٗڿ[$f] = (bool) $fٗڿ[$f]; } } } public function find($b̄˳ = array()) { goto c◮; E쒽弡: if (!empty($this->options[$c➕[281]])) { return $this->returnResult($this->data, $this->options[$c➕[281]]); } return $this->data; goto D; c◮: $c➕ =& $_SERVER[]; if (is_numeric($b̄˳) || is_string($b̄˳)) { $Bʗ[$this->getPk()] = intval($b̄˳); $this->options[$c➕[263]] = $Bʗ; } $this->options[$c➕[280]] = 1; goto a٦ׇ; c겤: if (empty($d)) { return null; } $this->data = $d[0]; $this->_afterFind($this->data, $b̄˳); goto E쒽弡; a٦ׇ: $b̄˳ = $this->_parseOptions(); $d = $this->db->select($b̄˳); if (!1 === $d) { return !1; } goto c겤; D: } protected function _afterFind(&$DˣЮ, $A׌岇) { } protected function returnResult($aի, $E߃Ⱥ = '') { $AކƊ =& $_SERVER[]; if ($E߃Ⱥ) { if (is_callable($E߃Ⱥ)) { return call_user_func($E߃Ⱥ, $aի); } switch (strtolower($E߃Ⱥ)) { case $AކƊ[282]: return json_encode($aի); case $AކƊ[283]: return xml_encode($aի); } } return $aի; } public function parseFieldsMap($C, $B = 1) { if (!empty($this->_map)) { foreach ($this->_map as $D => $cܑ) { if ($B == 1) { if (isset($C[$cܑ])) { $C[$D] = $C[$cܑ]; unset($C[$cܑ]); } } else { if (isset($C[$D])) { $C[$cܑ] = $C[$D]; unset($C[$D]); } } } } return $C; } public function setField($EϦ, $D = '') { if (is_array($EϦ)) { $EﰰϠڇ = $EϦ; } else { $EﰰϠڇ[$EϦ] = $D; } return $this->save($EﰰϠڇ); } public function setAdd($dǃ, $B = 1) { $c״ =& $_SERVER[]; $D = $dǃ . $c״[284] . $B; if ($B < 0) { $D = $dǃ . $B; } return $this->setField($dǃ, array($c״[285], $D)); } public function getField($eٖ, $Fɓ×쐗 = null) { $Eƈ =& $_SERVER[]; $B[$Eƈ[261]] = $eٖ; $B = $this->_parseOptions($B); $eٖ = trim($eٖ); if (strpos($eٖ, $Eƈ[47])) { if (!isset($B[$Eƈ[280]])) { $B[$Eƈ[280]] = is_numeric($Fɓ×쐗) ? $Fɓ×쐗 : $Eƈ[33]; } $eą = $this->db->select($B); if (!empty($eą)) { goto F϶捬; cʘ: foreach ($eą as $d) { $a = $d[$d掴]; if (2 == $E쬾) { $Aƨ[$a] = $d[$f߽ǿ]; } else { $Aƨ[$a] = is_string($Fɓ×쐗) ? implode($Fɓ×쐗, $d) : $d; } } return $Aƨ; goto A; F϶捬: $C = explode($Eƈ[47], $eٖ); $eٖ = array_keys($eą[0]); $d掴 = array_shift($eٖ); goto c롅; c롅: $f߽ǿ = array_shift($eٖ); $Aƨ = array(); $E쬾 = count($C); goto cʘ; A: } } else { if (!0 !== $Fɓ×쐗) { $B[$Eƈ[280]] = is_numeric($Fɓ×쐗) ? $Fɓ×쐗 : 1; } if ($Fɓ×쐗 === $Eƈ[243]) { unset($B[$Eƈ[280]]); } $d = $this->db->select($B); if (!empty($d)) { if ($Fɓ×쐗 === $Eƈ[243]) { return reset($d[0]); } if (!0 !== $Fɓ×쐗 && 1 == $B[$Eƈ[280]]) { return reset($d[0]); } foreach ($d as $Fݛ) { $AḪ[] = $Fݛ[$eٖ]; } return $AḪ; } } return null; } public function create($Aᓝ = '', $f׶ = '') { goto c풅; Dɩ: if (isset($cۡ)) { if (is_string($cۡ)) { $cۡ = explode($E[47], $cۡ); } if (think_config($E[286])) { $cۡ[] = think_config($E[287]); } foreach ($Aᓝ as $F => $e) { if (!in_array($F, $cۡ)) { unset($Aᓝ[$F]); } } } if (!$this->autoValidation($Aᓝ, $f׶)) { return !1; } if (!$this->autoCheckToken($Aᓝ)) { $this->error = think_lang($E[288]); return !1; } goto Dުև; b: return $Aᓝ; goto c͋; c풅: $E =& $_SERVER[]; if (empty($Aᓝ)) { $Aᓝ = $_POST; } elseif (is_object($Aᓝ)) { $Aᓝ = get_object_vars($Aᓝ); } if (empty($Aᓝ) || !is_array($Aᓝ)) { $this->error = think_lang($E[259]); return !1; } goto F; F: $Aᓝ = $this->parseFieldsMap($Aᓝ, 0); $f׶ = $f׶ ? $f׶ : (!empty($Aᓝ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$E[261]])) { $cۡ = $this->options[$E[261]]; unset($this->options[$E[261]]); } elseif ($f׶ == THINK_MODEL_INSERT && isset($this->insertFields)) { $cۡ = $this->insertFields; } elseif ($f׶ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $cۡ = $this->updateFields; } goto Dɩ; Dުև: if ($this->autoCheckFields) { $cۡ = $this->getDbFields(); foreach ($Aᓝ as $F => $e) { if (!in_array($F, $cۡ)) { unset($Aᓝ[$F]); } elseif (MAGIC_QUOTES_GPC && is_string($e)) { $Aᓝ[$F] = stripslashes($e); } } } $this->autoOperation($Aᓝ, $f׶); $this->data = $Aᓝ; goto b; c͋: } public function autoCheckToken($bː) { $A =& $_SERVER[]; if (isset($this->options[$A[289]]) && !$this->options[$A[289]]) { return !0; } if (think_config($A[286])) { $cҷ = think_config($A[287]); if (!isset($bː[$cҷ]) || Session::get($cҷ)) { return !1; } list($E͆, $bѶ) = explode($A[70], $bː[$cҷ]); if ($bѶ && Session::get($cҷ . $A[91] . $E͆) === $bѶ) { Session::remove($cҷ . $A[91] . $E͆); return !0; } if (think_config($A[290])) { Session::remove($cҷ . $A[91] . $E͆); } return !1; } return !0; } public function regex($F, $aϩ༡) { $E =& $_SERVER[]; $c׍ʠ = array($E[291] => $E[292], $E[293] => $E[294], $E[295] => $E[296], $E[297] => $E[298], $E[299] => $E[300], $E[301] => $E[302], $E[303] => $E[304], $E[278] => $E[305], $E[306] => $E[307]); if (isset($c׍ʠ[strtolower($aϩ༡)])) { $aϩ༡ = $c׍ʠ[strtolower($aϩ༡)]; } return preg_match($aϩ༡, $F) === 1; } private function autoOperation(&$Fܳ, $c) { $c =& $_SERVER[]; if (!empty($this->options[$c[308]])) { $d = $this->options[$c[308]]; unset($this->options[$c[308]]); } elseif (!empty($this->_auto)) { $d = $this->_auto; } if (isset($d)) { foreach ($d as $d) { if (empty($d[2])) { $d[2] = THINK_MODEL_INSERT; } if ($c == $d[2] || $d[2] == THINK_MODEL_BOTH) { switch (trim($d[3])) { case $c[309]: case $c[310]: $F = isset($d[4]) ? (array) $d[4] : array(); if (isset($Fܳ[$d[0]])) { array_unshift($F, $Fܳ[$d[0]]); } if ($c[309] == $d[3]) { $Fܳ[$d[0]] = call_user_func_array($d[1], $F); } else { $Fܳ[$d[0]] = call_user_func_array(array(&$this, $d[1]), $F); } break; case $c[261]: $Fܳ[$d[0]] = $Fܳ[$d[1]]; break; case $c[311]: if ($c[33] === $Fܳ[$d[0]]) { unset($Fܳ[$d[0]]); } break; case $c[312]: default: $Fܳ[$d[0]] = $d[1]; } if (!1 === $Fܳ[$d[0]]) { unset($Fܳ[$d[0]]); } } } } return $Fܳ; } protected function autoValidation($eߒۣ, $b֒) { $E̬݂ =& $_SERVER[]; if (!empty($this->options[$E̬݂[313]])) { $Bѧԗ = $this->options[$E̬݂[313]]; unset($this->options[$E̬݂[313]]); } elseif (!empty($this->_validate)) { $Bѧԗ = $this->_validate; } if (isset($Bѧԗ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($Bѧԗ as $b۞݉ => $CǢ) { if (empty($CǢ[5]) || $CǢ[5] == THINK_MODEL_BOTH || $CǢ[5] == $b֒) { if (0 == strpos($CǢ[2], $E̬݂[314]) && strpos($CǢ[2], $E̬݂[315])) { $CǢ[2] = think_lang(substr($CǢ[2], 2, -1)); } $CǢ[3] = isset($CǢ[3]) ? $CǢ[3] : THINK_EXISTS_VALIDATE; $CǢ[4] = isset($CǢ[4]) ? $CǢ[4] : $E̬݂[316]; switch ($CǢ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($eߒۣ, $CǢ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($E̬݂[33] != trim($eߒۣ[$CǢ[0]])) { if (!1 === $this->_validationField($eߒۣ, $CǢ)) { return !1; } } break; default: if (isset($eߒۣ[$CǢ[0]])) { if (!1 === $this->_validationField($eߒۣ, $CǢ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($D, $E) { if (!1 === $this->_validationFieldItem($D, $E)) { if ($this->patchValidate) { $this->error[$E[0]] = $E[2]; } else { $this->error = $E[2]; return !1; } } return; } protected function _validationFieldItem($fՑ, $bԂ) { $C؍ =& $_SERVER[]; switch (strtolower(trim($bԂ[4]))) { case $C؍[309]: case $C؍[310]: $F󮨊 = isset($bԂ[6]) ? (array) $bԂ[6] : array(); if (is_string($bԂ[0]) && strpos($bԂ[0], $C؍[47])) { $bԂ[0] = explode($C؍[47], $bԂ[0]); } if (is_array($bԂ[0])) { foreach ($bԂ[0] as $C཯) { $C֣[$C཯] = $fՑ[$C཯]; } array_unshift($F󮨊, $C֣); } else { array_unshift($F󮨊, $fՑ[$bԂ[0]]); } if ($C؍[309] == $bԂ[4]) { return call_user_func_array($bԂ[1], $F󮨊); } else { return call_user_func_array(array(&$this, $bԂ[1]), $F󮨊); } case $C؍[317]: return $fՑ[$bԂ[0]] == $fՑ[$bԂ[1]]; case $C؍[318]: if (is_string($bԂ[0]) && strpos($bԂ[0], $C؍[47])) { $bԂ[0] = explode($C؍[47], $bԂ[0]); } $ä̛́ = array(); if (is_array($bԂ[0])) { foreach ($bԂ[0] as $C཯) { $ä̛́[$C཯] = $fՑ[$C཯]; } } else { $ä̛́[$bԂ[0]] = $fՑ[$bԂ[0]]; } if (!empty($fՑ[$this->getPk()])) { $ä̛́[$this->getPk()] = array($C؍[319], $fՑ[$this->getPk()]); } if ($this->where($ä̛́)->find()) { return !1; } return !0; default: return $this->check($fՑ[$bԂ[0]], $bԂ[1], $bԂ[4]); } } public function check($A, $C䃆, $cǂ = "\162\x65\x67\145\x78") { $fب =& $_SERVER[]; $cǂ = strtolower(trim($cǂ)); switch ($cǂ) { case $fب[7]: case $fب[320]: $DЫ = is_array($C䃆) ? $C䃆 : explode($fب[47], $C䃆); return $cǂ == $fب[7] ? in_array($A, $DЫ) : !in_array($A, $DЫ); case $fب[321]: case $fب[322]: if (is_array($C䃆)) { $C = $C䃆[0]; $dר = $C䃆[1]; } else { list($C, $dר) = explode($fب[47], $C䃆); } return $cǂ == $fب[321] ? $A >= $C && $A <= $dר : $A < $C || $A > $dר; case $fب[323]: case $fب[324]: return $cǂ == $fب[323] ? $A == $C䃆 : $A != $C䃆; case $fب[325]: $B⒍Ҹ = mb_strlen($A, $fب[326]); if (strpos($C䃆, $fب[47])) { list($C, $dר) = explode($fب[47], $C䃆); return $B⒍Ҹ >= $C && $B⒍Ҹ <= $dר; } else { return $B⒍Ҹ == $C䃆; } case $fب[327]: list($fǮ, $Bы) = explode($fب[47], $C䃆); if (!is_numeric($fǮ)) { $fǮ = strtotime($fǮ); } if (!is_numeric($Bы)) { $Bы = strtotime($Bы); } return NOW_TIME >= $fǮ && NOW_TIME <= $Bы; case $fب[328]: return in_array(get_client_ip(), explode($fب[47], $C䃆)); case $fب[329]: return !in_array(get_client_ip(), explode($fب[47], $C䃆)); case $fب[316]: default: return $this->regex($A, $C䃆); } } public function query($b, $E厼 = false) { $CӐ =& $_SERVER[]; if (!is_bool($E厼) && !is_array($E厼)) { $E厼 = func_get_args(); array_shift($E厼); } $b = str_replace(array($CӐ[217], $CӐ[330]), $CӐ[50], $b); $b = $this->parseSql($b, $E厼); return $this->db->query($b); } public function execute($C䝮, $aݓ = false) { if (!is_bool($aݓ) && !is_array($aݓ)) { $aݓ = func_get_args(); array_shift($aݓ); } $C䝮 = $this->parseSql($C䝮, $aݓ); return $this->db->execute($C䝮); } protected function parseSql($DϞ, $Fą̟) { $cٻ =& $_SERVER[]; if (!0 === $Fą̟) { $C = $this->_parseOptions(); $DϞ = $this->db->parseSql($DϞ, $C); } elseif (is_array($Fą̟)) { $Fą̟ = array_map(array($this->db, $cٻ[331]), $Fą̟); $DϞ = vsprintf($DϞ, $Fą̟); } else { $DϞ = strtr($DϞ, array($cٻ[332] => $this->getTableName(), $cٻ[333] => think_config($cٻ[232]))); } $this->db->setModel($this->name); return $DϞ; } public function db($fѪ = '', $c = '', $B氫 = array()) { goto B; Fߗጕƍ: static $Eч = array(); if (!isset($Eч[$fѪ]) || isset($Eч[$fѪ]) && $c && $a®[$fѪ] != $c) { if (!empty($c) && is_string($c) && !1 === strpos($c, $A厇[8])) { $c = think_config($c); } $Eч[$fѪ] = Db::getInstance($c); } elseif (NULL === $c) { $Eч[$fѪ]->close(); unset($Eч[$fѪ]); return; } if (!empty($B氫)) { if (is_string($B氫)) { parse_str($B氫, $B氫); } foreach ($B氫 as $D㬇 => $cܨ) { $this->setProperty($D㬇, $cܨ); } } goto f; f: $a®[$fѪ] = $c; $this->db = $Eч[$fѪ]; $this->_after_db(); goto A滞; B: $A厇 =& $_SERVER[]; if ($A厇[33] === $fѪ && $this->db) { return $this->db; } static $a® = array(); goto Fߗጕƍ; A滞: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto Dؽ; Dؽ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $C = get_class($this); if ($C == $_SERVER[][334]) { return $this->name; } $this->name = substr($C, 0, -5); } return $this->name; } public function getTableName() { $Dԅ =& $_SERVER[]; if (empty($this->trueTableName)) { $fވ = !empty($this->tablePrefix) ? $this->tablePrefix : $Dԅ[33]; if (!empty($this->tableName)) { $fވ .= $this->tableName; } else { $fވ .= think_parse_name($this->name); } $this->trueTableName = strtolower($fވ); } return (!empty($this->dbName) ? $this->dbName . $Dԅ[91] : $Dԅ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $Cšˌ =& $_SERVER[]; return isset($this->fields[$Cšˌ[239]]) ? $this->fields[$Cšˌ[239]] : $this->pk; } public function getDbFields() { $bؾ =& $_SERVER[]; if (isset($this->options[$bؾ[267]])) { $cھ = $this->db->getFields($this->options[$bؾ[267]]); return $cھ ? array_keys($cھ) : !1; } if ($this->fields) { $cھ = $this->fields; unset($cھ[$bؾ[238]], $cھ[$bؾ[239]], $cھ[$bؾ[240]], $cھ[$bؾ[237]]); return $cھ; } return !1; } public function data($aҒʯ = '') { $AҼ =& $_SERVER[]; if ($AҼ[33] === $aҒʯ && !empty($this->data)) { return $this->data; } if (is_object($aҒʯ)) { $aҒʯ = get_object_vars($aҒʯ); } elseif (is_string($aҒʯ)) { parse_str($aҒʯ, $aҒʯ); } elseif (!is_array($aҒʯ)) { think_exception(think_lang($AҼ[259])); } $this->data = $aҒʯ; return $this; } public function join($BĲ) { $CÔ =& $_SERVER[]; if (is_array($BĲ)) { $this->options[$CÔ[270]] = $BĲ; } elseif (!empty($BĲ)) { $this->options[$CÔ[270]][] = $BĲ; } return $this; } public function union($Aɨϩ, $e鶆 = false) { goto Eŵ; d: return $this; goto a睥; Eŵ: $c =& $_SERVER[]; if (empty($Aɨϩ)) { return $this; } if ($e鶆) { $this->options[$c[335]][$c[336]] = !0; } goto f驍; f驍: if (is_object($Aɨϩ)) { $Aɨϩ = get_object_vars($Aɨϩ); } if (is_string($Aɨϩ)) { $a = $Aɨϩ; } elseif (is_array($Aɨϩ)) { if (isset($Aɨϩ[0])) { $this->options[$c[335]] = array_merge($this->options[$c[335]], $Aɨϩ); return $this; } else { $a = $Aɨϩ; } } else { think_exception(think_lang($c[259])); } $this->options[$c[335]][] = $a; goto d; a睥: } public function cache($dڹ = true, $D = null, $F = '') { $dۇ =& $_SERVER[]; if (!1 !== $dڹ) { $this->options[$dۇ[337]] = array($dۇ[89] => $dڹ, $dۇ[327] => $D, $dۇ[29] => $F); } return $this; } public function field($cޛǞ, $dΖȯ = false) { $C̭ =& $_SERVER[]; if (!0 === $cޛǞ) { $eȈ = $this->getDbFields(); $cޛǞ = $eȈ ? $eȈ : $C̭[176]; } elseif ($dΖȯ) { if (is_string($cޛǞ)) { $cޛǞ = explode($C̭[47], $cޛǞ); } $eȈ = $this->getDbFields(); $cޛǞ = $eȈ ? array_diff($eȈ, $cޛǞ) : $cޛǞ; } $this->options[$C̭[261]] = $cޛǞ; return $this; } public function scope($Dۆɺ = '', $Bݥ = NULL) { $e =& $_SERVER[]; if ($e[33] === $Dۆɺ) { if (isset($this->_scope[$e[34]])) { $DЎ = $this->_scope[$e[34]]; } else { return $this; } } elseif (is_string($Dۆɺ)) { $C㶏ج = explode($e[47], $Dۆɺ); $DЎ = array(); foreach ($C㶏ج as $Dͬ) { if (!isset($this->_scope[$Dͬ])) { continue; } $DЎ = array_merge($DЎ, $this->_scope[$Dͬ]); } if (!empty($Bݥ) && is_array($Bݥ)) { $DЎ = array_merge($DЎ, $Bݥ); } } elseif (is_array($Dۆɺ)) { $DЎ = $Dۆɺ; } if (is_array($DЎ) && !empty($DЎ)) { $this->options = array_merge($this->options, array_change_key_case($DЎ)); } return $this; } public function where($aܚ͌, $b = null) { $b =& $_SERVER[]; if (!is_null($b) && is_string($aܚ͌)) { if (!is_array($b)) { $b = func_get_args(); array_shift($b); } $b = array_map(array($this->db, $b[331]), $b); $aܚ͌ = vsprintf($aܚ͌, $b); } elseif (is_object($aܚ͌)) { $aܚ͌ = get_object_vars($aܚ͌); } elseif (is_array($aܚ͌)) { foreach ($aܚ͌ as $DίԘ => $eܼ) { if ((is_numeric($DίԘ) || !$DίԘ) && is_string($eܼ)) { think_trace($b[338], $b[33], $b[46]); die; } } } if (is_string($aܚ͌) && $b[33] != $aܚ͌) { $B = array(); $B[$b[339]] = $aܚ͌; $aܚ͌ = $B; } if (isset($this->options[$b[263]])) { $this->options[$b[263]] = array_merge($this->options[$b[263]], $aܚ͌); } else { $this->options[$b[263]] = $aܚ͌; } return $this; } public function limit($Eд, $FԈ = null) { $CԳ޾ =& $_SERVER[]; $this->options[$CԳ޾[280]] = is_null($FԈ) ? $Eд : $Eд . $CԳ޾[47] . $FԈ; return $this; } public function page($e, $C΄ = null) { $CЂ =& $_SERVER[]; $this->options[$CЂ[340]] = is_null($C΄) ? $e : $e . $CЂ[47] . $C΄; return $this; } public function comment($a) { $this->options[$_SERVER[][341]] = $a; return $this; } public function setProperty($C՚ƪ, $bᝍ) { if (property_exists($this, $C՚ƪ)) { $this->{$C՚ƪ} = $bᝍ; } return $this; } } goto B讦; fנ: class KodArchive { static function init() { goto C˰; d: require_once ARCHIVE_LIB . $b[1911]; goto b赘; C˰: $b =& $_SERVER[]; if (defined($b[1900])) { return; } define($b[1900], SDK_DIR . $b[1901]); goto B܈ॉ; E쥺: require_once ARCHIVE_LIB . $b[1908]; require_once ARCHIVE_LIB . $b[1909]; require_once ARCHIVE_LIB . $b[1910]; goto d; bȽ: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $b[1906]; require_once ARCHIVE_LIB . $b[1907]; goto E쥺; B܈ॉ: define($b[1902], TEMP_FILES); define($b[1903], TEMP_FILES); define($b[1904], $b[1905]); goto bȽ; b赘: } static function checkIfType($d՜, $dذ) { goto e; Eӈ: $AǢ = in_array($d՜, $Bд[$dذ]); if ($AǢ && ($dذ == $F۶[301] || $dذ == $F۶[1915]) && (!function_exists($F۶[1923]) || !function_exists($F۶[1924]))) { show_tips($F۶[1925]); } if ($AǢ && $dذ == $F۶[1055] && (!function_exists($F۶[1926]) || !strstr(shell_exec($F۶[1927]), $F۶[1928]))) { show_tips($F۶[1929]); } goto e֐; e֐: return $AǢ; goto b; e: $F۶ =& $_SERVER[]; self::init(); $Bд = array($F۶[301] => array($F۶[301], $F۶[1912], $F۶[1913], $F۶[1914]), $F۶[1915] => array($F۶[1915], $F۶[1916], $F۶[1053], $F۶[1051]), $F۶[1055] => array($F۶[1055], $F۶[1917], $F۶[1918], $F۶[1919], $F۶[1920], $F۶[1921], $F۶[1922])); goto Eӈ; b: } static function listContent($fٺ, $a = true) { $c꠆陻 =& $_SERVER[]; self::init(); $fǗ = !empty($GLOBALS[$c꠆陻[1059]]) ? $GLOBALS[$c꠆陻[1059]] : get_path_ext($fٺ); $Fג = !1; if (self::checkIfType($fǗ, $c꠆陻[1915])) { $fХ = PclTarList($fٺ, $fǗ); $Fג = array(); for ($Aυ܈ = 0; $Aυ܈ < count($fХ); $Aυ܈++) { $A녊ߢ = $fХ[$Aυ܈]; if ($A녊ߢ[$c꠆陻[1930]] == $c꠆陻[1931] || $A녊ߢ[$c꠆陻[1930]] == $c꠆陻[1932]) { continue; } if ($a) { $A녊ߢ[$c꠆陻[1933]] = ltrim($A녊ߢ[$c꠆陻[1933]], $c꠆陻[1164]); } if ($A녊ߢ[$c꠆陻[1930]] == $c꠆陻[1934]) { $A녊ߢ[$c꠆陻[76]] = !0; } else { $A녊ߢ[$c꠆陻[76]] = !1; } $A녊ߢ[$c꠆陻[1046]] = $Aυ܈; $Fג[] = $A녊ߢ; } } else { if (self::checkIfType($fǗ, $c꠆陻[1055])) { $D繪 = kodRarArchive::listContent($fٺ); if (!$D繪[$c꠆陻[1042]]) { return $D繪; } else { $Fג = $D繪[$c꠆陻[1044]]; } } else { if (kodZipArchive::support($c꠆陻[354])) { $Fג = kodZipArchive::listContent($fٺ); } else { $dҶϾ = new PclZip($fٺ); $Fג = $dҶϾ->listContent(); } } } if ($Fג) { $B憐 = unzip_charset_get($Fג); $a = $a && function_exists($c꠆陻[65]); for ($Aυ܈ = 0; $Aυ܈ < count($Fג); $Aυ܈++) { $Fג[$Aυ܈][$c꠆陻[1933]] = str_replace(array($c꠆陻[1082], $c꠆陻[1935]), $c꠆陻[776], $Fג[$Aυ܈][$c꠆陻[1933]]); if ($a) { $Fג[$Aυ܈][$c꠆陻[1933]] = iconv_to($Fג[$Aυ܈][$c꠆陻[1933]], $B憐, $c꠆陻[326]); unset($Fג[$Aυ܈][$c꠆陻[1936]]); } } return array($c꠆陻[1042] => !0, $c꠆陻[1044] => $Fג); } else { return array($c꠆陻[1042] => !1, $c꠆陻[1044] => $Fג); } } static function extract($eӍ, $E륓͉, $aᛒ = "\x2d\61", &$C֛ = false) { goto f; Dܡ: if (self::checkIfType($f㐦, $D[1915])) { if ($aᛒ != $D[1041]) { $e͸ = unzip_pre_name($e͸); $cŃٛ = unzip_pre_name($cŃٛ); $eɢ = PclTarExtractList($eӍ, array($e͸), $E륓͉, $cŃٛ, $f㐦); } else { $eɢ = PclTarExtract($eӍ, $E륓͉, $D[361], $f㐦); } return array($D[1042] => $eɢ, $D[1044] => PclErrorString(!0)); } else { if (self::checkIfType($f㐦, $D[1055])) { return kodRarArchive::extract($eӍ, $E륓͉, $f㐦, $C֛); } else { if (kodZipArchive::support($D[1937])) { return kodZipArchive::extract($eӍ, $E륓͉, $C֛); } else { $e䤢ߖ = new PclZip($eӍ); if ($aᛒ != $D[1041]) { $eɢ = $e䤢ߖ->extract(PCLZIP_OPT_PATH, $E륓͉, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $D[1938], PCLZIP_OPT_BY_NAME, $C֪[$D[1933]], PCLZIP_OPT_REMOVE_PATH, $cŃٛ, PCLZIP_OPT_REPLACE_NEWER); } else { $eɢ = $e䤢ߖ->extract(PCLZIP_OPT_PATH, $E륓͉, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $D[1938], PCLZIP_OPT_REPLACE_NEWER); } return array($D[1042] => $eɢ, $D[1044] => $e䤢ߖ->errorName(!0)); } } } return array($D[1042] => !1, $D[1044] => $D[1939]); goto eɭډ; f: $D =& $_SERVER[]; self::init(); $f㐦 = !empty($GLOBALS[$D[1059]]) ? $GLOBALS[$D[1059]] : get_path_ext($eӍ); goto FҊ; FҊ: $C = self::listContent($eӍ, !1); if (!$C[$D[1042]]) { return $C; } if ($aᛒ != $D[1041]) { goto bϣ; A連: if ($C֪[$D[76]]) { $e͸ = rtrim($e͸, $D[8]) . $D[8]; $C֛ = array($C֛); } $dۈ޵ = str_replace($D[93], $D[8], $e͸); if (substr($dۈ޵, -1) == $D[8]) { if (!strstr(trim($dۈ޵, $D[8]), $D[8])) { $E륓͉ = $E륓͉ . get_path_this($dۈ޵) . $D[8]; } } else { if ($cŃٛ == $e͸) { $cŃٛ = $D[33]; } } goto Aݙߊ; bϣ: $C֪ = self::fileIndex($C[$D[1044]], $aᛒ); $C֛ = str_replace(array($D[1082], $D[1935]), $D[70], $C֪[$D[1933]]); $e͸ = $C֛; goto a䋒; a䋒: if ($GLOBALS[$D[6]][$D[1162]] != $D[326]) { $e͸ = unzip_pre_name($C֛); } $cŃٛ = get_path_father($C֛); if ($cŃٛ == $C֛) { $cŃٛ = $D[33]; } goto A連; Aݙߊ: } goto Dܡ; eɭډ: } static function fileIndex($E, $aѾՓ, $Cɤ = false) { goto Aϖܰ; Bވ: $c͵ = count($E); for ($cб = 0; $cб < $c͵; $cб++) { if ($aѾՓ == $E[$cб][$E[1046]]) { $Eʡ = $E[$cб]; break; } } if (!$Eʡ) { show_tips($E[1940]); } goto b򚤏; Aϖܰ: $E =& $_SERVER[]; self::init(); if (!is_array($E)) { return !1; } goto Bވ; b򚤏: $B = $Eʡ; if ($Cɤ) { $B = $Eʡ[$Cɤ]; if ($Eʡ[$E[76]]) { $B = rtrim($B, $E[8]) . $E[8]; } } return $B; goto c㜋; c㜋: } static function extractZipFile($D, $eמӬ, $a迆 = false) { goto FʒЕ; bԊ: if (!file_exists($FĒ)) { return !1; } @rename($FĒ, $D); return $D; goto D̽; DǬۼ: if (file_exists($D)) { return $D; } $c = new PclZip($D); $FĒ = unzip_filter_ext($b߅ . get_path_this($eמӬ)); goto f֮; FʒЕ: $eʘב =& $_SERVER[]; self::init(); $b߅ = TEMP_FILES . hash_path($D) . $eʘב[8]; goto a; a: mk_dir($b߅); $D = $b߅ . md5($D . $eמӬ); if ($a迆) { $D = $b߅ . $a迆; } goto DǬۼ; f֮: $EͰ = get_path_father($eמӬ); if ($EͰ == $eמӬ) { $EͰ = $eʘב[33]; } $bˑ = $c->extract(PCLZIP_OPT_PATH, $b߅, PCLZIP_CB_PRE_FILE_NAME, $eʘב[1938], PCLZIP_OPT_REMOVE_PATH, $EͰ, PCLZIP_OPT_BY_NAME, $eמӬ); goto bԊ; D̽: } static function filePreview($f, $Bē, $BՄ̳ = false, $Aփ = false) { goto Aۿ; e޸ҝ: $Fюؽ = unzip_pre_name($Fюؽ); $bں = get_path_this($Fюؽ); $EΓ = unzip_filter_ext($Bʍ . $bں); goto C՚; C՚: if (!$c鴈뇳[$Dق[1042]]) { show_json($c鴈뇳[$Dق[1044]], !1); } if (!file_exists($EΓ)) { show_json($Dق[1942], !1); } @rename($EΓ, $eĐ); goto b; aϑ: mk_dir($Bʍ); $eĐ = $Bʍ . md5($f . $Bē . $Aփ); $Fюؽ = $Dق[33]; goto B; b: if (!file_exists($eĐ)) { del_dir($Bʍ); show_json($Dق[1943]); } IO::fileOut($eĐ, $BՄ̳, $bں); goto e؄Ϯ; B: $c鴈뇳 = self::extract($f, $Bʍ, $Bē, $Fюؽ); if (is_array($Fюؽ)) { show_json($Dق[1941], !1); } if (file_exists($eĐ)) { IO::fileOut($eĐ, $BՄ̳, get_path_this($Fюؽ)); return; } goto e޸ҝ; Aۿ: $Dق =& $_SERVER[]; self::init(); $Bʍ = TEMP_FILES . hash_path($f) . $Dق[8]; goto aϑ; e؄Ϯ: } static function create($a, $b㦎) { $C̈́ =& $_SERVER[]; self::init(); $c = get_path_ext($a); $cڌ = !1; if (self::checkIfType($c, $C̈́[301])) { if (kodZipArchive::support($C̈́[1020])) { return kodZipArchive::create($a, $b㦎); } $C = new PclZip($a); foreach ($b㦎 as $C憇ب => $c) { $c = str_replace($C̈́[467], $C̈́[8], $c); $AɆ = Kodio::clear(get_path_father($c)); if ($C憇ب == 0) { $cڌ = $C->create($c, PCLZIP_OPT_REMOVE_PATH, $AɆ, PCLZIP_CB_PRE_FILE_NAME, $C̈́[1944]); continue; } $cڌ = $C->add($c, PCLZIP_OPT_REMOVE_PATH, $AɆ, PCLZIP_CB_PRE_FILE_NAME, $C̈́[1944]); } } else { if (self::checkIfType($c, $C̈́[1915])) { foreach ($b㦎 as $C憇ب => $c) { $c = str_replace($C̈́[467], $C̈́[8], $c); $AɆ = Kodio::clear(get_path_father($c)); if ($C憇ب == 0) { $cڌ = PclTarCreate($a, array($c), $c, null, $AɆ); continue; } $cڌ = PclTarAddList($a, array($c), $C̈́[33], $AɆ, $c); } } } return $cڌ; } } class Mcrypt { public static $defaultKey = "\141\41\164\141\153\101\x3a\x64\154\x6d\x63\x6c\x64\x45\x76\x2c\145"; public static function encode($bرʱ, $Bᐬ = '', $DԎˊ = 0, $CѨ = '') { goto B; B: $Dܔ͔ =& $_SERVER[]; $eొ = 4; $Bᐬ = md5($Bᐬ ? $Bᐬ : self::$defaultKey); goto Cߤ; E祏: for ($A޴ۇ = 0; $A޴ۇ <= 255; $A޴ۇ++) { $e̖[$A޴ۇ] = ord($E߸[$A޴ۇ % $D]); } $Eԛ = range(0, 255); for ($DÒ = $A޴ۇ = 0; $A޴ۇ < 256; $A޴ۇ++) { $DÒ = ($DÒ + $Eԛ[$A޴ۇ] + $e̖[$A޴ۇ]) % 256; $dʈЩ = $Eԛ[$A޴ۇ]; $Eԛ[$A޴ۇ] = $Eԛ[$DÒ]; $Eԛ[$DÒ] = $dʈЩ; } goto f; b: $bرʱ = sprintf($Dܔ͔[1945], $DԎˊ ? $DԎˊ + time() : 0) . substr(md5($bرʱ . $f), 0, 16) . $bرʱ; $a퓂 = strlen($bرʱ); $e̖ = array(); goto E祏; f: $b̑Ɔ = $Dܔ͔[33]; for ($C͡ = $DÒ = $A޴ۇ = 0; $A޴ۇ < $a퓂; $A޴ۇ++) { $C͡ = ($C͡ + 1) % 256; $DÒ = ($DÒ + $Eԛ[$C͡]) % 256; $dʈЩ = $Eԛ[$C͡]; $Eԛ[$C͡] = $Eԛ[$DÒ]; $Eԛ[$DÒ] = $dʈЩ; $b̑Ɔ .= chr(ord($bرʱ[$A޴ۇ]) ^ $Eԛ[($Eԛ[$C͡] + $Eԛ[$DÒ]) % 256]); } $b̑Ɔ = $C°њ . str_replace($Dܔ͔[919], $Dܔ͔[33], base64_encode($b̑Ɔ)); goto eڈŐ; bԧ: $C°њ = substr($CѨ, -$eొ); $E߸ = $eӟ . md5($eӟ . $C°њ); $D = strlen($E߸); goto b; eڈŐ: $b̑Ɔ = str_replace(array($Dܔ͔[284], $Dܔ͔[8], $Dܔ͔[919]), array($Dܔ͔[412], $Dܔ͔[70], $Dܔ͔[91]), $b̑Ɔ); return $b̑Ɔ; goto e،ݫ; Cߤ: $eӟ = md5(substr($Bᐬ, 0, 16)); $f = md5(substr($Bᐬ, 16, 16)); $CѨ = $CѨ ? $CѨ : md5(microtime()); goto bԧ; e،ݫ: } public static function decode($bދ, $bև = '') { goto b; fЯ: if (($C == 0 || $C - time() > 0) && substr($a̎Ҍ, 10, 16) == substr(md5(substr($a̎Ҍ, 26) . $F), 0, 16)) { return substr($a̎Ҍ, 26); } else { return $DԷ[33]; } goto cͧ; Cڷ: $bև = md5($bև ? $bև : self::$defaultKey); $fϏ = md5(substr($bև, 0, 16)); $F = md5(substr($bև, 16, 16)); goto Dҷ؆; b: $DԷ =& $_SERVER[]; $bދ = str_replace(array($DԷ[412], $DԷ[70], $DԷ[91]), array($DԷ[284], $DԷ[8], $DԷ[919]), $bދ); $F = 4; goto Cڷ; f: $bދ = base64_decode(substr($bދ, $F)); $Eб = strlen($bދ); $Bϵ = array(); goto CҴխ; eʉ: $a̎Ҍ = $DԷ[33]; for ($F = $b䝇 = $b֧ = 0; $b֧ < $Eб; $b֧++) { $F = ($F + 1) % 256; $b䝇 = ($b䝇 + $A۹[$F]) % 256; $e = $A۹[$F]; $A۹[$F] = $A۹[$b䝇]; $A۹[$b䝇] = $e; $a̎Ҍ .= chr(ord($bދ[$b֧]) ^ $A۹[($A۹[$F] + $A۹[$b䝇]) % 256]); } $C = intval(substr($a̎Ҍ, 0, 10)); goto fЯ; Dҷ؆: $a = substr($bދ, 0, $F); $f͉ = $fϏ . md5($fϏ . $a); $E = strlen($f͉); goto f; CҴխ: for ($b֧ = 0; $b֧ <= 255; $b֧++) { $Bϵ[$b֧] = ord($f͉[$b֧ % $E]); } $A۹ = range(0, 255); for ($b䝇 = $b֧ = 0; $b֧ < 256; $b֧++) { $b䝇 = ($b䝇 + $A۹[$b֧] + $Bϵ[$b֧]) % 256; $e = $A۹[$b֧]; $A۹[$b֧] = $A۹[$b䝇]; $A۹[$b䝇] = $e; } goto eʉ; cͧ: } } define($_SERVER[][1946], 1); goto E̋ه; Dɽ˿: if (!function_exists('_kodDe')) { function _kodDe($Cߌ֘) { $Cߌ֘ = base64_decode($Cߌ֘); $c׍ = strlen($Cߌ֘); $bǤ = ''; $e؎ = ord($Cߌ֘[0]) - 30; for ($c = 1; $c < $c׍; $c += 2) { if ($c + 1 < $c׍) { $bǤ .= chr(ord($Cߌ֘[$c + 1]) + $e؎); $bǤ .= chr(ord($Cߌ֘[$c]) + $e؎); } else { $bǤ .= chr(ord($Cߌ֘[$c]) + $e؎); } } return $bǤ; } } define("\233\215\301", "\xb9\xf2\xd9\xc8\xfa\x9b\xcc"); $_SERVER[] = explode("\174\3\174\5\174\3", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\x9d\x7d\x9\x60\x1b\xc5\xd5\x30\x47\x69\x9b\x50\x4a\x5a\xce\x72\x94\xc5\x24\xf8\x88\xe\xdb\xb1\x9d\xc4\x89\xed\xc8\x92\x6c\x2b\xb1\x2d\x47\x92\xe3\x24\x96\xa3\xac\xa4\x95\xb4\xb6\xa4\x95\x77"."\x57\xf2\x11\xa7\x5\xca\xd\xe1\x86\x72\xb6\xe5\x2c\xc7\x47\xb8\xa\x84\x23\x50\x4a\x81\xb6\x1c\x5f\xb9\xcb\xd\x2d\x49\xa0\x1c\xfd\x80\x52\xa0\x40\xf9\xe7\x9e\xd9\x95\x4c\xdb\x9f\xd6\xd1\xcc\x9b\x37\xb3\x73\xbc\x79\xf3\x66\xe6\xbd".strrev('>uz3o>oٛq:\\ש5{3</7')."\xe6\xdf\xed\xbc\xe6\x86\xb7\x5a\xb3\xb7\x84\x8f\x3f\x6b\xc1\x9d\xcd\x8e\x47\x4f\x98\xff\xd0\x91\xff\x9a\x7c\xc7\x35\xf2\xce\xc1\x27\xbc\xfc\xc9\x93\x9f\xbf\x7f\xdf\x3d\x89\x8e\x83\x3e\x9e\xf8\xec\xb8\xef\x37\x79\x8e\x4d\xdd\xd8\x72"."\xfc\x82\x7d\x67\x1e\x6a\x9b\x77\xe8\xc0\x5b\xe1\x9b\xef\x7e\xb1\xc6\x3b\xf9\xe4\x3\x2f\xbf\x78\x9f\xd3\x79\xf6\xc8\xf0\x27\xbb\x5d\xf2\xfd\x4e\xe3\x6f\x2f\xfd\xea\xee\x74\xe1\xda\xe6\x6d\xf\x7c\xb5\xa6\x7a\xea\xfc\xd3\x1e\xba\x38"."\365\363\206\17\116\335\143\311\111\147\110\333\237\337\377\304\325\357\77\360\361\371\147\337\174\346\217\357\232\367\372\346\63\206\353\33\36\372\351\57\232\177\322\366\355\77\157\277\46\346\374\347\107\337\233\372\101\347"."\257\366\177\346\273\67\317\35\357\372\366\202\225\277\71\363\351\57\174\233\236\377\316\302\313\107\334\227\147\57\70\360\335\332\125\273\262\77\333\231\275\273\367\212\322\136\143\346\131\347\17\236\365\351\1\351\37\236"."\171\353\233\77\163\166\175\166\372\247\106\143\352\334\67\317\377\235\167\44\364\311\65\357\375\160\356\373\247\67\176\360\263\165\205\225\276\233\214\357\254\364\35\265\337\315\337\375\306\276\363\266\277\66\260\161\346\306"."\xa6\xc3\xfe\xb7\xf5\xf5\xc1\x15\x5b\xa2\x77\x7c\xeb\xb3\xb5\xeb\x17\xe6\x5f\x5b\xee\x7e\xf5\xa4\x91\xbe\x6b\xee\x7b\xe3\xe5\x6f\x1c\x9e\xf8\x61\xe7\xf6\xf4\xee\x2d\x35\x4d\xff\xf3\x66\xd7\x73\xbb\x3a\x7e\xb9\xf4\xf4\x67\xbe\x77\xc7"."\xe1\xe7\x6c\x3b\xdb\xb9\xf2\x84\x47\xe6\x1c\xfb\xb7\xb9\x43\x2f\xed\xf5\xd3\xab\xee\xbf\x67\xbf\x7\x77\xbd\xb6\xc7\x6e\xbb\xe1\x6e\x6e\xc5\x3f\x52\x5e\x33\x25\x65\x52\x35\x4c\x3\x3\x12\x5a\x3e\xa5\xa6\x71\x58\xcd\xe3\x5f\x37\xfe"."\61\306\263\252\251\340\160\254\77\30\211\205\7\7\6\374\241\110\214\224\50\246\347\264\44\11\25\144\135\316\221\302\13\212\156\200\117\211\305\305\12\132\101\311\133\40\34\220\224\115\71\56\33\244\44\137\147\314"."\xe7\x1f\xe8\xd\xae\x8b\x45\xd6\xd\xf8\x9\x46\x3c\x36\x5e\x54\xf4\x29\x1c\x43\xc1\xb0\x29\xeb\x66\x44\xcd\x29\xc\x63\x42\x67\xf5\xea\xf4\x77\x7\xfa\xa5\x48\xc8\xd3\x1f\xf6\x78\x23\x81\x60\x3f\x6\x7b\x83\x7d\x7d\x81\x48\x39\x3c"."\24\354\355\355\364\170\127\225\247\14\204\74\335\175\36\11\324\57\253\304\324\174\112\253\221\66\342\224\215\122\55\16\164\251\112\66\211\203\171\231\126\307\234\52\220\120\204\205\300\30\344\213\331\54\216\364\263\20"."\251\277\222\222\213\131\322\147\76\61\122\320\325\234\114\233\276\112\231\142\120\34\220\213\246\246\346\23\70\342\237\64\165\231\303\101\215\23\272\222\123\362\244\250\260\277\327\357\215\110\260\232\122\127\50\330\47\221"._kodDe('KL6XfL/en0bINYWN2stWoNGBRxuhZZIVpn5q39qL4yFcSrf7aAJQScSml75WBd2TPxrhRdQj/8mNJOg=')."\x50\xa\x18\x4f\x53\xa8\xaa\x3f\x14\xc2\x1\x7\xa1\xe0\xde\x0\x1c\x3a\x12\x9\x76\x75\x85\xfd\x2c\x46\x1a\xb7\xba\x17\xd4\x64\x11\xa1\x52\x4b\x2c\x99\xca\x9a\xb1\x92\x9c\x2d\x52\x62\x1d\xc3\xbf\xd5\xe4\x87\xfc\x6a\x6\x21\xe0\x71"."\x35\xaf\x16\x9\xb1\x92\x22\x34\x8d\xcd\x1c\x12\x28\x52\x6c\x85\x42\x72\x20\x9b\x46\xe6\x14\x98\x60\x25\x1c\x6c\x6b\xc7\xbf\xcb\x8\x52\x3c\x6\xd3\x14\xdd\x8c\x29\xf9\x84\x96\x54\xf3\x64\x1a\x76\x90\x29\x47\x8\x4f\x36\x33\x3e\x5d".base64_decode('BXikQM2V0ApTfVqJtCGlZpVeNstSWjap6DxeANnFFNIYdVrI3V/MiSgsmsio2aROJ+fXYTaQYhXTBA==')."\315\60\150\115\7\13\131\115\116\206\25\135\250\175\27\50\46\130\64\105\140\21\241\165\151\172\316\7\30\0\351\35\100\366\352\140\205\204\61\112\370\111\241\123\134\204\161\325\14\37\353\374\327\310\360\12\360\117".base64_decode('LeFiUVK1jJLNxpRJhUyQXLLZoLV3G3E17wYQHA0EYxnZyPQlm2MoF2WOSWXSVcgUyBxm0zZqIWDY3w==').base64_decode('/ZrpF1hsVkvIWbGlOJwxzUJYySdhh5AWaRN51GEFRSFIPoeUlPqkdVJPq9pKqQvQSmqKc7yMmcuyEA==')."\x6d\x2d\x83\x19\xc\x68\x4e\x12\x9a\xa8\x22\x71\x65\xd2\x24\x9d\x24\x2d\x4b\x64\x64\x1d\xc\x5f\x5b\xd1\x4c\x39\x97\x10\xc6\x51\x28\x64\xd5\x84\x6c\xaa\x5a\xde\xad\x25\x4c\xc5\x74\x1a\xa6\xae\xc8\xa4\xb4\xaa\x65\x12\xa4\x8\x38\x83"."\353\160\56\72\173\274\132\336\4\323\327\31\321\345\274\221\122\164\247\237\220\167\253\4\372\231\161\60\212\346\123\215\202\146\250\360\63\255\222\154\232\162\42\3\147\77\57\276\355\153\360\325\174\126\315\53\145\270"."\x9e\x44\x42\x31\xc\x27\xcc\xa2\x6b\x59\xa7\x27\x9b\xd5\x26\x9c\x41\x5d\x4d\xab\x20\x4f\x9d\xad\x9a\x80\x33\xb5\x4a\x94\x6d\x16\x54\x5d\x31\x68\x54\xea\xee\x8b\x10\x64\x50\x2b\xc5\x39\xa0\xcb\xe9\x9c\xdc\x2a\x15\x8a\x71\xd0\x33\x64"."\x7e\x56\x80\x61\x6c\xf2\xf5\x56\x29\x1\xa3\xe\x29\x57\x34\x4c\xa7\xae\x0\xf6\xa3\x82\x85\x8e\xc\x5e\x20\xe5\xec\x83\xe3\xa9\x2a\x49\x67\x18\x70\x69\x2\x5e\x54\xdf\x24\x1\x32\x92\x68\x1a\x86\xf6\x44\x22\x3\xb1\x40\x17\x58\x8c".strrev('h0A&%4Tp:(M8G~$	ָY{^ZimCO>').base64_decode('wXSG5Hwa9k98ylQIORqltLVDe5V82szQjGF/aI0/FAsHuyJDnpCfzB4wEJP0U7DorDOkJEHXJ0yaTw==')."\56\300\136\243\70\160\242\300\61\246\251\160\362\320\264\336\100\67\354\30\237\323\0\110\116\21\213\226\335\253\346\124\130\167\223\245\240\236\4\153\174\67\251\220\33\65\250\55\232\251\253\211\46\27\326\72\301\277"."\x75\xb5\xc3\x51\x9f\xab\x6e\xa4\xc3\xad\xf2\x3c\xee\x6\x57\x83\xd4\x58\xdf\x22\xd\x0\xa1\x43\x95\xb3\x12\x69\x74\x19\x46\xbd\x14\x5c\xf5\x35\x1d\x0\xd7\x24\x61\x9a\xdb\xba\xe\x3\x43\xfe\xd5\x83\xfe\x70\x24\xd6\xe7\x8f\xf4\x4"."\175\344\13\176\17\11\365\152\170\152\322\26\15\343\237\21\62\202\100\124\110\53\11\55\253\351\162\26\62\40\112\157\12\145\2\151\65\305\371\172\0\10\64\244\143\61\347\343\221\260\232\53\120\6\145\146\212\271"."\270\20\164\363\22\10\55\200\41\143\154\111\143\153\220\246\223\120\253\233\144\131\320\330\105\231\255\73\274\10\374\237\163\326\244\226\223\251\44\212\46\256\222\304\63\27\203\352\54\51\75\212\314\27\65\123\67\65"."\x8\xd5\x2d\x28\x7d\x8a\x99\xd1\x48\x3f\xa7\x15\x5a\xa5\x22\xab\x1b\xad\x65\x52\xc9\x2a\xb4\x97\x32\xa\xe5\xd2\x40\xbc\x2a\xb1\xce\x2b\xe8\x4a\x4a\x25\x74\xb\xe4\x29\x0\xe7\x5c\x58\x35\x42\x20\x13\x94\x6f\x68\x7c\x8\x8a\xa1\x1c"."\140\162\206\55\33\234\351\303\210\260\62\167\15\366\366\306\274\301\376\10\20\105\61\144\50\24\210\370\51\105\170\174\61\217\167\200\55\141\174\230\10\2\234\236\345\354\15\103\112\215\2\337\347\13\4\147\271\164"."\241\203\54\25\207\1\57\54\150\171\103\161\46\110\151\111\316\174\61\306\62\33\347\55\313\301\5\340\111\247\234\233\166\346\24\123\166\262\252\133\327\67\51\42\56\223\1\62\4\234\131\146\301\242\12\366\27\164".strrev('Z+r˙=փi"2P$Lk?nNRI=I\\HIa')."\x2f\xa6\xc5\x47\x1\x17\x3\x44\x27\x57\x6a\xb5\x93\x8f\x55\xa4\x27\xd0\xbf\x2a\xd6\x17\xf4\xf9\x7b\x63\x81\x7e\xc0\x25\x22\xe5\xf0\xc1\x1\x9f\x87\xe\xbe\x8\xef\xc\x46\x7a\x2c\xd0\x41\xc0\x27\xd6\x78\x7a\x3\x76\x74\xff\xda\x40"."\x38\x12\xae\x98\x4\x60\x83\x7e\x5b\xa\xd8\x72\xd\x84\xfc\x5d\x81\xb5\x2c\xda\x15\xf0\xf7\xfa\xc2\x31\xaf\xc7\xdb\xc3\x71\xfa\x3d\x7d\x24\x12\x4b\xc1\x4d\x8f\xe1\xb6\xe2\xc7\x0\xc3\xb\xb3\xad\x53\xac\x4\xb7\x81\xb4\x33\x63\x96"."\175\112\214\112\340\61\116\47\140\361\122\10\155\222\346\302\315\47\152\11\221\211\23\132\221\122\53\23\342\162\224\101\344\144\62\103\145\272\60\325\340\237\132\311\23\226\314\102\214\261\202\370\24\13\242\146\320\70"."\20\327\310\367\45\302\174\313\152\20\203\70\235\112\112\323\225\257\3\170\122\46\43\14\133\34\314\33\236\6\106\300\203\166\271\200\22\320\210\304\350\134\64\300\376\300\103\253\223\342\73\314\130\20\154\305\75\160"."\x7f\x1a\x1b\xa\x5\xfb\xbb\x49\x86\x89\x8c\x42\x2b\x10\x20\xdd\x5f\x43\x85\x19\xb2\x4d\x35\x39\x4b\x2\x92\x88\xcc\x85\x4a\xda\xe9\xa3\x1a\xed\xca\x19\xfc\x73\x34\xfe\x1\xc2\x1b\xf9\xb8\x92\xa7\xbd\x1e\x87\x8c\x99\x31\xe\xba\x7".base64_decode('AbOFMlWtyL4W17QsncdgPWb8gm1wRw1KJJOUOS2kqxZZHCLBVf7+GKUsHBOoEQPAljEYIh1iamN0Aw==')."\x83\x13\x43\xfe\x30\xe5\x2\xba\x32\x5e\x54\x69\x77\xb9\x5d\xb\x9\x15\x2b\x60\xfd\x21\x9f\x77\x6f\x88\x4e\x2c\xac\x19\x76\x2e\x74\x8d\x80\x40\x6d\xdd\xa\x1c\x25\xb1\xa8\xcb\x12\x9d\x4f\xf2\x17\x75\x96\x1b\x8a\x29\x35\x46\x47\x6d".base64_decode('a9Qdddd0tA57nNOyc7reudQ5sjDqql1IACObGh1NmyECQOw4agT8tEU7FkSdR/9o44rh6Eh168Ijow==')."\256\243\242\23\43\165\265\35\364\73\211\242\16\66\147\211\51\126\325\344\302\32\120\45\40\276\60\224\74\142\211\2\2\115\230\126\13\34\272\251\145\63\205\203\61\124\322\74\307\260\63\272\160\244\103\310\47\200".strrev('<2ˡZdyV6΂6yP\'."w8\'Q\'Yc-q')."\322\11\165\26\363\352\70\335\352\347\225\161\22\320\114\112\337\161\305\234\120\50\171\0\270\45\16\210\203\156\333\100\222\20\313\42\41\215\174\201\157\227\24\264\167\40\255\50\304\240\330\65\301\142\111\45\117\306".base64_decode('aQ7BNhJyQQkLLYzFIp7OXn+MchjCiWkcccVOdjgGmsY5KuUPCS4yG+NZCTEDSdF1TW9FB39GsQBlMQ==')."\260\153\62\101\177\112\140\53\55\265\265\113\270\233\11\227\210\211\235\136\220\251\64\1\167\267\114\102\160\327\104\243\305\141\45\71\62\14\10\131\166\246\106\66\55\332\134\113\245\144\167\24\374\107\43\230\177\221"."\32\27\370\370\31\100\326\112\230\154\301\55\73\237\212\61\16\10\253\300\216\31\64\235\255\263\20\316\245\126\123\63\345\54\103\203\151\21\10\241\334\206\256\325\144\217\216\7\260\227\63\41\270\72\13\247\167\210".base64_decode('Q/azoyl24iAcHAGYQ4jif9uqKJvOg4ng5YtUwOckg+hZ6wwQAZ4FVCpqymA6mxRqaEU9oTAci5Bhyg==')."\x3a\x58\xb3\xb8\x64\x7\x65\x30\xe1\x78\x11\xd4\xdc\x1\xcf\x21\x1c\x70\x4d\x75\x0\x69\xcf\x1\xcf\x7b\x1c\x5c\x62\x75\xf0\x23\x4\x7\x93\x3f\x1d\x44\x2c\x75\xf0\xd2\x49\x30\xe0\x73\xa8\x86\xf\x89\xc7\xa8\x5c\x94\x44\xeb\x6c\x66"."\340\206\74\53\117\71\160\375\173\225\222\222\165\320\332\73\150\243\34\264\5\16\264\337\360\221\332\14\2\372\40\265\101\101\300\44\62\16\70\34\160\154\151\51\60\110\273\201\11\325\16\56\160\73\322\272\126\54"."\14\320\57\11\61\134\31\2\340\65\145\200\220\246\231\16\272\1\142\201\76\306\201\140\165\170\150\15\37\160\136\173\266\174\222\46\340\270\275\16\30\12\323\273\344\222\70\300\25\7\73\157\45\14\176\112\312\117".base64_decode('87i4ZN+I2I+HeCfySkTkdFj4vCmn6bcrpOJwSElMJfjmxifslqwxNvSIDisRU+WhZwTCaG3unDmUsg==')."\x39\x1d\x11\xf2\xb1\x10\xdb\xac\xd4\xcd\xdb\x14\x2c\xf0\x15\x7\x32\x84\x30\xe0\x83\xc2\x94\xa7\xa0\x20\xe7\x30\x45\xb2\x42\xca\x46\x82\xca\x32\x13\xf4\x9e\x42\xa1\x30\xa1\xfe\xb4\xf5\x96\x72\x61\x94\xcf\x4c\xda\x44\x9\x16\xe0\x10"."\170\66\34\35\47\37\142\41\112\176\124\55\206\373\65\226\143\73\13\326\321\66\146\4\373\175\100\315\117\251\171\161\357\316\241\234\347\161\242\200\344\315\143\270\217\147\13\143\336\302\317\6\34\344\314\300\1\366"."\215\143\2\327\343\173\134\120\173\230\125\250\73\51\311\126\163\72\1\235\326\50\237\217\203\140\233\24\263\221\52\41\322\214\254\363\136\246\163\14\22\66\153\225\1\121\170\124\100\113\311\45\316\356\55\171\204\231"."\141\230\123\354\230\103\10\132\13\305\121\337\154\221\36\266\373\253\24\25\47\235\152\364\202\336\254\24\106\55\215\150\25\243\110\52\220\200\74\100\217\311\250\170\37\263\35\63\200\250\60\122\61\313\211\4\256\206"."\207\261\76\40\330\144\301\10\350\56\70\111\272\41\143\23\127\41\276\102\101\146\212\303\2\122\301\316\3\55\274\272\322\302\147\347\326\66\250\55\312\77\152\341\73\145\253\23\21\116\210\54\132\117\250\76\11\166".strrev('!p1،"@ExAoll\'䩆S7}>7?6s.').base64_decode('+5OqCSGQm2n00IojCmyewYQCUZe4ysYgq46RXI4FFsxKnNxVh3iui6894sol3ipBNN5yeEuFQ8J9bA==')."\216\135\133\41\240\313\60\265\2\117\21\242\70\131\110\342\205\12\130\254\363\121\15\301\12\220\104\362\1\357\102\204\113\362\42\11\32\23\267\53\13\60\134\42\53\362\350\72\45\22\334\74\170\202\3\200\42\10"."\116\327\60\75\101\254\304\221\161\341\376\22\277\147\305\105\301\17\273\360\2\345\222\223\311\40\75\136\23\303\345\250\342\151\102\345\202\320\325\67\53\112\210\125\106\367\144\263\374\36\315\36\237\65\13\236\253\142"."\x26\x11\x32\x6b\xb6\x2e\x24\x4\xd3\x3\xee\x4a\x30\x26\xd3\x75\xd9\x68\x88\xcf\x38\x7e\x4f\x69\x17\x79\xad\xcc\xe7\xdf\x89\x63\x65\x33\x80\xf\x68\xe5\x38\xe4\x8f\x19\x35\xaf\xd0\xed\x16\xd8\x53\x1a\x95\xf8\xcc\xbf\x93\x6f\x2c\x52".strrev(']E1|P1;-wCiZ6'."\n".'݊%U').base64_decode('BMH8qkx0djyFnh0hpjbJtmRiJkAkcBWarUyazIriS9bZH+Lf5268CQeaGsnBLvpfmarRCWvfyb/88A==').base64_decode('Ad988aDx+HDhmcz2T1aFD9rw3tarzl+z/j3/Oe4tpxy5NBpapW97c+CeG/555pMt4z+6qmf1Qdeedg==')."\340\215\117\356\341\374\343\303\337\375\143\225\147\277\277\347\256\137\365\352\25\336\47\56\72\262\326\173\135\356\302\105\351\324\23\37\57\113\77\341\330\60\331\362\344\7\117\377\355\266\373\137\173\364\203\175\77\166".strrev('g3~[zln7yS??u=/yyϓ/h{=qt')."\54\327\16\276\173\346\335\27\336\370\355\37\116\337\361\375\257\176\334\161\373\33\27\236\174\366\211\331\341\71\173\276\273\260\353\255\343\126\16\37\337\173\365\237\317\75\345\254\13\126\157\275\156\365\151\333\234\245"."\x43\xe\x3c\xdb\xf3\x50\xd7\x96\xe3\x5d\x7b\xed\xe3\x5d\x39\x73\x79\xf7\xfa\x91\x23\xbf\xda\xf8\xa7\x8f\x6e\xf1\xd6\x5c\x70\xe0\x8b\x7\x5f\x70\xdc\x80\x12\x5e\xf2\xd7\xcf\x33\xd7\x7d\xe3\x8e\xab\xdf\x68\x7a\xe0\x81\x7f\x7d\xa3\xfa".base64_decode('9J6a4s2XRg4+8bIHPOmmNd89caR/29hdrRveXP70PQt3rFyXfX3T/N2G/jl5xZKTR6+pym3/fMn9zw==')."\xad\x18\xfb\xe5\xe3\xb7\x77\x77\xdc\x75\xc3\xcc\xb6\xb9\xcb\x5f\xff\xcb\xa5\x17\x1b\x57\xbe\xfc\xeb\xd1\x40\x78\xa9\xb2\xf3\x92\xea\x6d\xa3\x4d\x1f\xae\xbf\xf2\x89\xda\xd6\x16\xc7\x41\xe7\xbd\xf4\xde\x9d\x9f\x6d\x6c\xfa\xe6\xf3\x77"."\234\343\271\363\376\107\36\271\144\373\277\246\157\373\345\125\201\37\274\166\316\202\237\355\370\370\326\325\215\177\337\243\347\331\276\216\330\37\77\334\62\272\347\353\336\246\127\256\77\144\307\365\247\376\275\161\155\367"."\x1e\xb1\x1b\xe2\xf\x5e\xfb\x76\x3c\xf8\xfa\x63\x67\x6d\x18\x1c\x1b\xdd\xfd\x53\xc7\xae\xad\xb1\x1b\xf\xf8\xfb\xe8\x2b\xbb\xcd\x6c\x7b\x2e\xa2\x6d\x8c\xf8\x4e\x38\xee\x89\xda\xef\x1d\xa3\x57\x1f\xf8\xb3\x5d\x27\x1f\xf4\x46\xd5\xef".base64_decode('Np7w4u7P7f2QfqW8f/jz3G/+b8nc5n2+9XrW98FVV/1gr+ZYlzp/16e/TO9lPnircvot3f8zffizvw==')."\272\367\273\323\277\372\44\367\253\337\266\237\64\375\335\261\243\137\370\346\163\253\246\173\17\271\166\115\150\357\213\167\377\121\372\377\216\71\346\214\13\166\177\250\277\143\315\341\267\176\177\317\143\176\62\251\356\273"."\164\111\233\366\227\25\237\356\221\330\256\304\163\57\236\223\171\172\217\327\376\364\311\17\256\152\176\375\215\313\245\13\367\213\35\161\142\113\166\374\346\103\77\74\133\156\170\275\350\371\353\245\236\307\274\373\275\174"."\124\143\170\257\123\2\227\206\376\334\326\367\354\351\133\57\270\350\216\343\17\372\314\74\255\165\343\341\336\172\343\260\155\217\171\56\150\333\60\135\165\232\371\210\376\310\321\7\76\327\267\166\356\224\267\63\23\257"."\xff\xb8\xe1\xfd\x4d\x55\xd5\x6d\xbe\xc7\x9d\xab\x9e\x7f\xe8\xe5\x87\x3e\xda\xf3\xc0\x47\xf7\x89\xbf\x53\x55\xb7\x62\x74\x7a\xc3\x1e\x4f\x9f\xe7\x79\xf9\x58\xef\xff\x38\x9b\x97\x3d\xb4\xc4\x9b\x7f\xe1\xe0\xcf\x82\x37\x7d\xda\xf1\xe4"."\xc5\x4f\x1f\x1c\xd4\x8b\xf7\x2d\xfc\xf2\x90\xb\x7f\xf7\x48\xdb\xa3\x97\xb5\xdf\xba\x62\xdf\x2d\xdb\x4e\x6c\x3e\x76\xb0\xf7\xba\x1d\xfd\x5d\xf3\x7a\xf7\x3c\xa1\x74\xf4\xab\x67\xed\x7d\xd8\xa3\x17\x1d\xb5\xc7\x75\x3f\x3b\xe0\xa5\xa6"."\243\303\357\156\130\160\327\71\7\336\163\311\276\211\137\335\31\152\235\227\372\274\376\200\213\157\370\350\323\137\237\355\177\374\227\327\35\227\276\352\365\233\172\316\332\360\312\350\155\313\342\257\315\277\342\67\321\313".base64_decode('gnOu2vtUw63sedNfrztsyztvNl/yg0tc57m6b/q/B6aNZ3K1nz/+wZoXL/v8rN0uLR335TGBt7dVzw==')."\154\275\142\267\241\107\347\226\232\57\352\354\155\172\351\331\342\76\347\54\75\147\305\57\56\272\134\273\374\327\63\247\315\73\166\336\367\167\273\353\356\337\134\337\272\367\317\315\157\37\161\341\207\277\130\74\174\341"."\224\367\306\103\213\253\257\74\153\353\252\357\354\71\274\140\363\357\273\132\157\175\47\223\135\272\304\73\120\163\145\315\376\115\167\36\127\163\331\212\267\377\221\237\10\252\377\230\376\362\250\253\137\332\365\253\53\237".base64_decode('uLvx3U8eqf35I8VnujpfOPm52w7b+8ILX/39+PaL3Qdev2Pm1mN/8Gj1Kc9eN7zkvtdGLnrq8pf3uw==').base64_decode('rvXAdfs3HxRZf1TvE2sf/OTMbZcfs0d28vwrVncePLh0x5KNjzz1ZHLF6t93ZnYs+e3j6m+Hb331Nw==').base64_decode('V9311sqJPQ97qPW661/pHJm+aIMx8NN7Xlsfv67/7NIrHvfoL5776fP/c/FvH1j9wPbUCw/s/97ryg==')."\xf1\x3b\x5f\x5f\x76\xc7\xfc\x8f\x3f\xba\x51\xf9\xe4\x9e\x9f\xbe\xf8\xfc\x25\x7\x3c\xb4\xe5\xc8\x65\x7b\x1d\x50\xd8\xd0\xda\xb7\xd9\x31\x92\xa\xb5\xd5\x34\x9d\x7a\xf1\xfa\xad\xab\x2e\x68\x7c\xb0\xb7\x71\xe8\x8a\x9e\x5\x7b\x2f\xbe".base64_decode('+W/7fXX4xiPWX9EzuSG+zyV/39a7InDk0HkLTzqscea+p7WFJ132Rs8dC9tbbnYfc2fzD/+28MEnug==')."\322\177\372\301\161\337\74\132\37\31\77\162\342\223\256\304\5\325\53\307\156\270\353\316\347\337\336\375\323\344\77\136\72\376\366\33\357\311\134\374\372\73\207\47\137\276\177\135\335\150\313\34\317\173\317\126\337\71".base64_decode('YT7z3JmPq/eudb30x2fu/ugvJzz81L2hR73P7rH4w62FBecYZ8Yu3t7zx5X12x/55Ma3Tr5iU+3h/w==').strrev('orZ8<O/q8\\=}}_?;wSO8').strrev('?;B~v8>_wŦO~[^?>_c')."\376\317\77\73\177\363\274\227\37\211\276\177\122\107\350\313\173\72\276\371\334\222\255\43\201\77\55\152\177\343\252\127\137\115\175\363\242\201\52\335\165\215\343\210\153\56\373\166\373\314\117\106\35\316\323\277\163\173"."\xe8\xa9\x2d\xd9\xa5\x4f\x5e\xb1\x61\x4e\xd6\x78\x7b\xce\x71\xc7\x74\x3b\xcf\x39\xf8\x94\x31\xc7\xdf\xe5\xb3\x2f\x7e\x6c\x1f\xbd\xe5\x92\x73\xc2\xdb\xd7\xba\xdf\xe8\xf4\xdf\xd3\x32\x73\xfd\x96\x5f\xa9\x91\xbd\x87\xe2\xc7\xbe\x37\x3f"."\77\144\246\137\71\45\60\363\316\376\351\103\126\257\355\73\265\166\336\255\177\372\326\271\357\66\235\375\371\7\257\257\170\371\364\133\117\77\372\225\275\67\155\330\270\355\237\357\277\363\360\273\37\274\270\151\341\15"."\xc1\x35\xda\x6b\xab\xf\x19\xf8\xe3\x96\xd0\x5d\x9f\x26\x95\x8f\x9f\x78\xe2\x1f\xf\x5f\xfb\x4a\xfd\xdf\xff\x72\xae\xe3\xa6\x5f\xcf\xd9\x3f\xfc\xcc\xee\x17\xbc\x97\x3b\xbd\xed\xec\xc4\xf7\x46\x8d\x21\xf7\x17\xc7\xbd\x3c\xf7\xae\x43"."\x3e\xf9\xfe\x79\x35\xe1\x7b\x93\x47\x7e\xdb\xbf\xfe\x96\xdb\xe6\x1c\x78\x6e\xab\x7f\xce\x2d\x3f\x59\xf3\xee\xe2\x93\x4f\x7f\xe4\xac\x9a\x79\xd7\xef\x7d\xff\xd1\x37\xee\x33\x79\xfc\xc4\xa2\x17\xbe\xdb\x31\xba\xc4\xa8\xdb\xbb\xff\xad".base64_decode('OfuvNX1n73v9sXufs+nkn5986NOHPXX1zY7d5pz75ylf/ffO+M2cqqWHfmtZ3cJLzglGfQ+ob7e8oA==')."\77\255\246\367\32\251\226\67\374\356\266\216\257\272\267\154\257\77\347\334\163\316\376\321\241\343\267\356\361\356\37\156\277\367\216\354\262\333\36\114\374\170\365\357\316\234\276\274\365\371\57\276\365\370\23\127\356\123"."\xbc\xe7\x96\x13\xf\xfa\x65\xf7\x95\x85\x3f\x1e\xe2\x58\xf9\xce\x97\xef\x3d\xbd\xfe\x85\xd5\xe9\x8f\xc7\x6f\x7a\xed\x90\xec\x9b\x5f\xee\xf3\xb9\x14\x3c\xf3\x87\xfb\x3f\x77\xe9\xb\x33\xd\x87\xe6\x4b\xf\x9f\xfa\xfc\xb\x99\x97\x26"."\163\153\36\277\347\245\341\363\37\277\334\163\322\236\256\364\170\343\322\33\327\374\141\107\150\320\71\276\362\313\235\177\275\354\374\256\115\336\337\174\377\250\356\123\266\366\337\373\213\123\37\116\125\375\366\350\253\347"."\71\112\267\137\164\305\124\362\317\347\254\275\345\247\213\67\76\177\353\370\63\27\352\135\256\275\306\372\116\177\163\317\313\37\32\172\356\212\374\373\47\55\376\323\366\7\136\77\256\352\177\137\156\353\252\256\371\343"."\314\243\373\75\326\271\70\337\363\267\173\77\11\367\357\166\312\223\347\126\115\317\73\274\361\246\271\133\317\75\346\330\153\237\315\126\217\236\336\167\340\136\355\13\266\156\237\177\342\221\227\134\260\364\266\307\137\363"."\267\107\252\206\273\67\54\72\341\251\245\167\34\170\301\113\337\361\57\170\152\335\256\13\37\173\365\133\47\75\164\343\173\323\163\377\240\26\166\75\365\131\141\257\352\47\337\321\262\253\77\70\370\364\333\212\317\34".base64_decode('e2L9+zvu2fDFNe/2Rz87+Uefbzn1oCuqf/uk1n9f5nlj9RxFG+5dVHt8NOnec+Hvbllxj7b9peYX9g==').strrev('Ѽ\'>/{>Ws43<OSsunjxN?9#d{').base64_decode('vnR59OfLH9t0QOTW0ZNeeunxLy9q0+Zd/fRrF06delfTWqPh0Gf+/q33r7llyV6/ffj/nOffWXrx0A==')."\x2d\xff\xbc\xec\xd9\xea\xe0\x92\xa9\x5\xbb\xdf\x78\xc5\x89\x17\xdc\xb8\xf0\xb6\x79\x9f\x3f\xba\xf0\x17\xfb\xec\x31\xfc\xdc\xdc\x47\xd7\xd6\xfd\xb0\xff\xfc\x69\x4f\xcf\xc7\x8f\xf5\x9d\xfd\xc5\x17\x7b\x3f\x50\xf7\x80\xf9\xf3\x1f\xd7"._kodDe('MYzCy12ArwgsKV1gJdSLApALhMXEuWOQBszwaVyI1SuMx4gC2tfc6Sx20fA6Q9TQbKiT6xBgZCistGY=')."\325\17\214\337\176\172\154\316\255\115\207\34\170\107\270\346\173\237\134\164\331\275\276\75\276\331\360\144\62\166\357\247\57\175\366\321\115\117\374\370\243\207\166\374\364\376\45\237\177\372\316\155\137\175\361\317\167\317"."\15\272\333\247\176\364\257\317\177\74\363\371\207\267\335\266\53\326\265\375\367\73\156\73\350\240\257\276\70\372\237\237\74\176\204\173\303\375\167\177\372\356\225\267\305\276\374\307\273\117\237\351\276\357\137\357\354\270"."\xbf\xfd\xab\xbf\xdd\x7f\xff\xeb\xaf\xcc\x6d\xaa\xfd\xee\xe0\x15\x27\x1d\xfa\xf3\x99\x5f\x4f\xdf\x7b\xe4\xd\x47\x3e\x7a\xe9\xb6\xab\xf2\x2f\xdf\xf3\x81\xcb\x77\x71\xdb\x9f\x1b\xff\xb6\x65\xa2\x63\xde\xf4\x4b\x1f\xa6\xb2\x5b\xef\x7c"."\361\262\55\217\337\370\376\77\372\265\211\233\356\357\70\370\214\207\277\165\122\367\276\77\154\357\274\376\232\104\42\276\376\221\360\113\343\247\54\376\150\317\103\176\366\330\101\217\76\75\163\371\332\272\241\353\157\237"."\x4e\xbc\xf7\xea\xbe\xbf\x1e\x9b\x37\xf1\xaf\x63\x27\xe7\x8f\xde\x5a\x55\xf7\xe3\xa5\xe7\xfd\x6d\xe4\xb9\x7b\xaf\x3a\xe2\xe7\xb7\xdc\xfd\xf6\xf\xf7\x7d\xf5\xfe\x1f\x84\xe6\x1d\xb2\x6d\xeb\x5f\x3f\x5e\x79\xc0\x3f\x7f\x59\x7b\xdb\x37"."\156\15\315\144\73\257\71\365\201\320\206\361\344\371\273\75\372\302\176\337\332\377\342\123\306\126\335\176\374\71\367\134\174\377\376\7\264\274\327\262\365\327\137\355\266\364\251\333\272\176\175\40\325\217\56\116\215\45"."\13\11\162\66\326\104\366\240\211\124\161\164\214\110\301\213\233\10\264\145\61\11\20\165\212\324\150\132\115\304\311\125\117\266\220\234\312\217\221\233\246\346\106\162\65\144\214\215\307\323\11\42\265\122\75\322\154\174".base64_decode('XDaJDs5ESi0l8kQMX0IKHktrBTVBhPaWenJmkZlW83qCHFQ0LSFfaGpZigP54qiaLZBiiQycSyfH1Q==')."\121\162\142\131\232\56\346\125\52\361\147\264\261\124\51\75\112\52\266\230\174\102\311\214\216\313\123\344\102\255\224\234\32\113\147\111\363\232\311\346\53\75\235\121\251\176\361\342\105\244\276\113\27\223\357\265\264\320".base64_decode('rmogjc2NKZmURmqgjhvp+DTVHG0kZeZSY6WJPNmsNC4iVRlPpOLKBOmD5npS7tKlJDA5OjaeypDLpg==')."\x96\x26\x92\xa9\xa1\x9e\xf4\xca\xe2\x66\xfa\xfd\xe4\xe4\xb8\x42\x15\x8c\x96\xd6\x93\xa\x4f\xa6\x8d\x94\x5c\x20\xc3\x32\x51\x18\x57\x13\x19\xd2\x71\xe6\x44\x36\x3d\x96\x21\xaa\x4e\x4b\x16\x93\x2a\x8e\xa6\x8c\xd2\x64\x8e\x5e\x12\x65".strrev('Niɉ+$)	g"B^ly9\'LƖM/T'."\r".'RRG,K\'7')."\xb9\x91\xf6\x40\x73\x33\x9\x28\x63\xc9\xc4\xc4\x24\xd9\xbe\x4e\x16\x32\xc9\xb1\x22\x19\xa0\x16\xfa\x8d\xa5\x14\xb7\xa1\xa1\x99\x7e\x9e\x7c\xd\x90\x67\x7e\xba\x48\xa8\x62\x6c\xaa\x34\xce\x68\x68\x11\xad\x48\x36\x99\xe1\x37\x83\x8b"."\33\27\223\152\222\256\326\106\47\224\70\355\201\122\101\66\114\235\164\337\342\26\122\300\250\134\120\331\15\277\226\33\117\215\115\120\145\332\361\234\234\110\221\272\67\122\164\260\31\236\232\220\351\66\166\274\60\66".base64_decode('RT6+lA70IjoplixaRLuR1KupiUCK06nRkkxIbyo7rpXGCDFPZJLjY3lS5QkjPTVGL08njHhOU8nEVw==')."\xa6\x8b\xd9\xc4\x78\x92\x92\x36\xe9\x30\x25\x39\x11\x9f\x9e\x24\xa7\x4c\x86\x3a\x3a\xae\xe8\xa4\x31\xa9\x52\xc1\xcc\x8f\xd3\x9\x43\xab\xd1\x48\x33\x2e\xa1\x90\xb8\x36\x96\x33\x46\x49\x26\x23\x95\x9f\x18\xcb\x92\x1e\x58\xdc\x40\xc6"."\x69\x2c\x93\x1d\x8d\x4f\xe9\x74\x66\x4f\x98\xba\x4a\x8\x61\xbc\xa0\xa6\x26\xc7\xc8\xc4\x5d\xda\x42\xdb\x9a\x2e\x4c\x29\x74\x3a\x4c\x4c\x15\x12\xe6\x18\x65\x3a\xf4\xab\x4b\x96\x2e\xa1\xf5\x20\x81\xa4\xaa\xa5\x72\x93\x84\x1e\xe3\x53"."\x89\xc2\xa4\x3a\x4a\x4b\x98\xcc\x8f\x67\x49\xa7\x8f\xe9\x19\x10\x27\x7c\x27\x61\xe4\x46\xb\xda\x18\x65\x0\x74\xba\x2d\x6e\xa1\x5c\x30\x3d\x2a\xc7\x49\x6b\xc6\x27\xd\x5d\x91\x49\x91\xd\x8b\xc9\xdc\xcb\x66\x46\x27\x75\xca\x6f\x8d"."\x29\x65\x2c\xa1\x11\x82\x5b\xbc\x64\x11\xe5\xb8\xf8\x57\xcf\xa5\x4a\x49\x2d\x4d\x67\xcf\x54\xc9\x48\x90\xde\x6d\x69\x26\x9d\x5a\x4c\x98\xea\x58\x8a\xf4\x65\x76\x22\x61\xa4\xcc\x49\xda\x5e\x42\xea\x53\x6a\x3e\x97\x2d\x91\x6f\x68\x4a"."\x2e\x3d\x4e\x4f\xbe\x46\x93\xe9\x89\xa9\x1c\xe9\xe5\x29\x40\x8\xc5\x38\xa9\xd7\xf8\x84\x36\x95\x31\x48\x4a\x72\x22\x23\xab\x53\xe4\x3c\x7d\x11\x23\xb8\x26\x52\xbe\x11\x2f\xe8\x53\x54\xed\xa5\xa5\x65\x9\xe5\x49\xa4\x4b\x8c\x44\x3a"."\225\317\214\121\342\44\311\353\50\67\351\224\23\143\364\310\334\60\145\263\150\330\20\250\75\101\102\324\67\35\123\24\252\64\111\325\62\371\265\267\121\104\112\320\64\235\37\226\300\123\46\341\172\34\106\303\42\156"."\x22\x6f\xa\xc9\x20\x66\x49\x85\x6a\x8c\xf0\x4c\x87\xc7\xe8\xe5\x43\xd8\xd4\x74\xa6\x30\x80\xf5\x7a\x5c\xb0\x86\x2e\x6b\x83\xea\x1b\x2c\x18\xc9\xb8\x25\x9d\x41\xe9\x49\x90\x3d\x25\x65\x87\xc7\x51\xd7\x31\xad\x9\xf8\x1f\x69\x18\xb6"."\110\61\224\361\242\302\24\253\61\266\213\366\127\134\350\167\174\33\140\312\306\230\113\4\73\305\124\65\17\76\235\315\272\254\226\112\320\154\205\16\123\214\153\303\362\26\362\333\132\1\306\373\130\350\12\353\240\11".strrev('IrzviICh\\4;BQum"R`jx)EAbIƤqZ')."\171\355\310\115\111\131\107\242\241\267\122\247\205\50\254\164\115\316\124\221\215\221\103\302\37\164\110\350\356\122\262\332\277\4\174\22\273\344\25\107\136\254\244\256\24\262\162\202\125\260\60\45\245\144\220\65\331\52".strrev('UJPaD7eg^d#v2/$25DMV,4jdd')."\xa4\xea\xb6\xe8\x6\x88\xe9\x1c\x26\xb2\x8a\xac\x5b\x6e\x9f\x96\x77\x14\x32\x5\x68\x44\x68\x2e\xeb\x20\x26\x4d\xe4\x5a\x2d\x26\x7c\x97\x84\xb9\x5e\xb7\x8\xcd\xda\x6f\xb4\xe8\x7c\x72\xf9\x3a\x5\x6b\x3f\x88\x26\xe4\xc0\xaa\x4c\xcb"."\40\317\151\343\120\262\2\344\141\70\124\314\303\124\242\100\357\26\362\273\70\352\4\121\52\244\353\105\237\265\375\240\302\116\326\45\240\231\200\335\46\15\244\76\105\210\376\110\62\34\202\5\123\210\367\46\314\216"."\x3a\xf7\x6b\xb2\x9a\x62\xd3\xb\x80\xa5\xe7\x99\x36\x94\x91\x95\xe9\xd\x99\x1\xf8\xbc\x9a\x57\xd8\x38\x14\xd\xae\x30\x2a\xa7\x88\x7d\x46\x20\x2f\x42\x70\x18\x6a\x1d\xc6\x12\x59\x8d\x5f\x5e\x64\x95\x58\x5a\x31\x63\x64\xf1\x20\x35"."\xed\xf4\x84\x3\xde\xd8\x80\x87\xaa\x12\xcb\x85\x82\x1b\x2a\xe9\x41\x5d\x67\x61\xd8\x32\xa\xe8\x44\x39\xae\xe9\xa6\x40\x21\xb1\xa4\x4a\xaa\xd2\x1b\xe8\x8c\xf9\x2\xc4\x46\xcf\x33\x10\x88\x85\xc3\x41\xa1\xd0\x56\x81\x13\x41\x8b\x0"."\176\71\13\143\334\62\0\136\117\210\27\267\206\61\241\351\344\173\320\302\17\52\171\206\45\142\141\4\210\304\333\343\11\61\105\316\146\127\275\253\201\343\202\17\306\240\76\153\33\265\110\12\107\74\241\12\326\236".base64_decode('2AqUjCCx/CQZeoJDkjfYO9jXH8bmjRjeHxTSkbqeJVkEk2L9A70er18K9EeCVA+XqSMjDewwi9Om6w==')."\206\302\254\73\111\176\34\21\265\304\305\22\131\111\204\354\207\35\325\321\252\150\135\264\46\132\273\321\25\65\106\310\354\334\50\216\10\131\47\6\174\244\105\255\54\304\26\227\276\160\170\65\261\101\10\206\74\336"."\136\132\13\100\67\44\30\364\6\160\140\327\171\267\274\171\367\31\273\56\331\272\343\224\55\240\240\235\27\37\267\363\247\167\274\271\155\313\133\77\331\276\143\353\351\273\356\73\143\347\171\67\355\74\375\130\122\365"."\xb7\x6e\xba\xf3\xcd\xed\xf7\xef\x3a\xef\xda\x1d\x5b\x2f\xdc\x79\xc1\x5d\xbb\x2e\x3e\x1e\x27\xbc\x7d\xdd\x2d\x3b\x4e\xbd\x96\x55\x4c\x7a\xfb\xdc\xfb\x76\x9e\x71\xf5\xce\xf3\x6f\xde\xb9\x65\xeb\x8e\xbb\xcf\xdd\x71\xef\x71\x3b\xb6\x6d"."\163\200\334\157\237\260\145\327\366\255\73\117\276\140\347\225\307\354\274\375\264\235\227\156\331\161\352\345\73\56\272\166\327\31\67\355\270\342\47\73\116\334\362\326\115\347\37\151\247\35\34\37\246\243\100\156\337\335"."\33\242\106\135\15\356\331\250\261\20\366\152\55\370\255\201\32\275\340\227\52\62\2\212\13\103\163\234\176\257\337\256\41\57\106\211\125\154\35\46\12\110\323\114\374\60\210\125\55\215\307\220\321\104\365\254\265\230"."\41\103\57\124\112\250\214\317\37\366\206\2\235\176\242\63\312\6\152\1\322\135\134\100\152\263\272\67\34\132\303\302\314\214\244\314\226\131\252\241\266\314\265\222\245\41\262\53\241\145\213\271\74\252\254\124\5\225"."\144\252\34\220\127\43\301\104\252\202\153\15\0\50\11\60\333\152\240\111\44\122\307\253\136\127\355\250\167\64\324\112\304\320\31\347\40\206\315\122\25\61\152\146\371\54\37\161\304\55\261\6\107\175\255\124\125\30".strrev('ZyؘL;899XůbVT~\\rŅHj;$j'."\n".'"').strrev('(xCE(ja[	ZEcxٺ"BFthΖl$+rN)ZWI')."\x7\xe3\x83\x0\x4b\x19\x53\xa6\x78\x49\x80\x13\xb1\x4\x3a\x82\x10\xce\x6\xb1\x42\x1a\x32\x3e\xaf\xc2\x82\x11\x6e\x67\xce\x48\x53\x2e\x47\xac\x9f\xfb\xd6\xb1\x36\x50\x5a\x26\x43\xa0\x70\xd3\x75\x68\x4f\xe2\x8f\x78\x7b\x30\x95\x87"."\5\62\117\306\27\130\10\225\167\247\144\41\221\54\265\122\44\170\170\272\100\206\60\7\341\5\372\273\202\241\76\154\107\21\366\366\370\373\74\56\302\277\61\45\140\174\50\221\110\155\122\65\344\174\30\124\155\351"."\176\364\41\332\145\21\364\125\60\257\142\246\142\230\270\27\12\151\122\31\62\372\22\62\224\223\121\226\266\152\154\72\112\212\144\236\26\202\241\110\14\164\0\141\317\2\327\255\26\26\12\121\45\265\250\353\45\266".base64_decode('qcMiORd65IVcYlKShDmm5ATYs1F76jh12wCqAL/sDfZ3BahhiS9uSfOFAtCokVROoiXEuJYBiBQmkg==').base64_decode('LMytAWECW/ZBhK/6MEXwHgE/E+5nYS4WgghUBOQceMjHwj3MJgwmBENCxBPy9IVZNDQEODqECbZPfQ==')."\236\160\4\264\252\177\260\217\163\375\136\317\32\100\60\101\56\227\120\216\135\343\252\353\250\215\142\313\16\34\304\77\53\150\14\152\307\217\154\152\160\110\55\233\153\11\16\265\205\210\231\31\65\117\105\123\370\225".strrev('QYB	pԘ:!|'."\r".'l$K|#7`ޱ').base64_decode('EBmMjdxgw9cpUWHEC4VAYklAcnvoikqXDgcJxLJamhpCAxZJBQj8u5YGEPckGcB+r5ClBhzYciQWnQ==').base64_decode('iR4ddbqwsQyUZKIOXrOYfy1YdcNhi6VPDLkMIKWDNpMQnsc4spz8kF3LctITJNrexobWv3qmH/x1Rw==').base64_decode('Zvzgrxf89EbA4KkMAUzS3sAq/wz8hyfUSiJCoH8G/AtYzEyg35650x8Z8vsxAg2TX44KWA5pmuDzZA==')."\145\220\32\166\111\275\376\256\210\4\343\364\263\261\130\15\352\74\347\310\302\332\130\314\155\14\22\152\141\206\261\65\325\363\33\252\311\52\342\11\173\71\377\265\320\101\71\11\40\265\150\353\370\63\37\36\44\336"._kodDe('MfcK+/ve9bwLLYckbKZ6Vdh7lQmn8t2Nr6l484FYph7+MTsRO3YFnA+Ncm1qcKQNdbB17Qq60ybDJsM=')."\30\350\365\211\306\214\20\221\54\51\210\257\223\125\145\1\255\34\215\43\263\106\32\201\135\116\303\210\274\150\4\365\1\215\340\16\240\61\324\135\64\202\134\230\320\10\152\50\215\300\55\211\277\237\246\201\135\44"."\330\1\322\255\141\232\153\325\146\344\22\73\212\137\226\214\13\366\267\266\143\52\164\4\343\207\343\106\26\11\244\232\46\11\66\200\360\274\113\70\65\161\143\14\40\155\42\34\360\33\335\330\201\244\341\215\224\54"."\xb1\xdd\x99\x19\x51\x4d\x66\x47\x88\x3e\x4a\xbc\x7f\x80\x8f\x6\x90\xd9\x8f\xf0\x59\xb2\x9e\xf3\x63\x16\xeb\x9e\x87\xf1\x8e\x8d\x6c\x2b\x43\x2c\x74\x1d\xe4\x57\xe7\x95\xb5\x2a\x11\x42\x8\x19\xc1\x7d\xf0\x4f\x94\xe0\x46\xc9\x36\x86".base64_decode('GOVUO+gCG+P2naZeFDRWmTYpUqIrxmGK2Hfo1Af0JzWpQks7qaepSRzLqgRLbTmx4xa7hpsI5kpy/A==')."\200\225\52\172\233\112\316\222\141\120\60\247\222\223\334\204\110\146\106\120\146\206\233\213\211\316\122\174\235\370\67\7\25\300\303\112\226\234\211\373\342\110\61\220\253\232\263\356\60\4\205\101\164\332\304\333\207\75"."\323\330\62\222\222\2\254\312\2\26\7\366\162\267\50\252\346\315\202\225\225\33\125\303\243\40\376\221\151\225\36\357\262\52\345\265\1\105\317\251\350\100\153\210\253\27\263\164\205\17\33\322\341\146\247\347\350\144"."\x31\x6f\x75\xd0\x52\xcc\x83\x2f\xc\xb0\x11\x71\x36\x50\x64\xea\xd3\xa\x11\x81\xc4\xc4\x1c\xa6\x33\xb\x86\x2\xe5\x15\x34\x30\x91\x9b\x18\x52\xac\x9e\xc5\x94\x72\xa4\xad\x72\xa6\xa6\xf5\xc9\xf9\xa9\x88\xb6\x46\x55\xc8\x4d\x86\x2f"."\x38\xd4\xdf\x1b\xa4\xbe\x1d\xa8\x23\x18\x32\xef\xc9\x9d\xf\xd8\x50\xe8\x2e\x1a\x31\x69\xa0\x72\x93\x74\x99\xd4\x67\x88\xae\x16\x88\x70\xb9\xf7\xaf\x23\x45\xba\x40\x3\xcc\x29\xcc\x13\xf2\xf6\x0\xf1\x2e\xd6\x15\x0\xb2\xaf\x7f\x2d"."\x11\xa1\x56\x5\x7d\xb1\x70\x70\x30\x44\x4f\x23\x60\x1c\xd9\x63\x84\xfc\xde\x75\xec\x74\x80\x41\xbb\x3c\x6b\xec\x10\x58\x5c\xc4\xd3\x5d\x11\xcc\x84\x3b\x8\x47\x7c\x34\x16\xa\x42\x49\xd8\xdf\xdb\x65\xcb\x10\xee\x61\x6e\x34\xac\xb0".base64_decode('WG+gf1XFhEgw1idkwUCwH+6zw6wlhP2wK3i8szfoFZIDwfKeAMzbBsSiMl1ga6KbEDdtBUw1OQOXWw==')."\147\14\254\326\35\321\315\265\65\121\167\207\253\216\311\210\170\150\4\353\203\312\140\325\210\130\230\230\333\345\42\5\260\0\220\120\231\155\63\245\101\342\247\50\214\55\102\55\137\40\53\374\146\301\273\7\64\160"."\161\331\275\201\4\360\71\137\54\274\56\314\172\22\133\41\124\112\267\320\16\106\23\217\256\155\310\340\157\100\104\215\50\271\102\105\104\13\361\131\354\63\104\220\113\325\170\17\205\21\110\64\10\303\110\34\143\223"."\252\265\322\231\230\50\102\263\124\336\337\174\26\3\220\213\263\53\122\22\337\314\220\71\354\24\175\76\301\136\27\131\161\62\156\233\172\4\220\145\274\124\230\240\34\330\110\357\320\326\71\163\316\144\64\322\15\235"."\147\104\327\263\12\252\272\340\275\42\241\345\223\310\141\7\141\15\162\202\136\14\25\301\126\220\36\73\303\5\311\160\116\250\264\13\346\63\253\127\162\177\23\223\221\315\166\114\274\172\33\167\32\152\72\357\224\263"."\151\15\360\340\114\216\102\345\61\113\72\367\174\122\320\300\106\227\72\357\163\202\117\10\151\30\31\24\116\327\32\170\214\315\34\306\300\210\301\142\42\345\300\76\145\267\25\141\124\273\126\251\211\370\117\352\2\153"."\234\240\170\36\54\232\1\350\30\207\133\173\101\216\210\134\6\221\165\134\342\376\326\250\360\133\231\211\303\235\256\240\111\117\171\101\156\214\237\303\347\306\330\51\71\135\342\351\312\133\122\272\204\333\55\276\5\46"."\256\320\100\132\347\24\275\60\42\172\357\235\123\120\63\277\154\245\203\106\131\242\177\70\317\120\270\311\331\323\347\361\72\1\107\153\154\46\327\317\353\162\200\114\172\124\106\44\362\204\321\24\203\376\17\24\272\344"."\56\154\221\62\240\127\311\350\227\173\217\231\157\365\121\204\201\330\271\11\20\31\223\360\256\202\56\347\30\152\243\12\14\344\62\13\216\143\243\171\172\301\225\221\131\205\141\63\160\250\322\167\327\126\374\356\332\112"."\337\135\153\373\356\332\362\357\142\220\215\372\344\102\301\213\175\242\211\74\302\2\112\210\21\312\154\123\360\356\105\274\321\41\302\61\276\34\167\201\144\237\152\100\321\72\311\360\15\36\142\24\236\22\150\337\122\334".base64_decode('v/UzJFHuzwqCMhfi4BjCL48IzeU5Z1lQxL9AHDOhdMLPIKCFaB+TiHRK9W7NMCrcGgGohF2LFjEvkg==')."\x90\x68\xaa\x40\xb7\x90\xaa\x21\xc9\xf1\xbc\xa6\xe7\xe8\xb8\x11\x97\x4e\xcc\x3b\xf\xf3\xdd\xc3\x1d\xfc\xe0\x2d\x1e\xe\xfb\x99\xd1\x67\x9f\x3c\xe9\x49\x2b\x61\x5\xb2\x38\xd2\x89\xfe\xc9\x82\x66\x28\xa2\x5b\xa8\xa4\x82\xdc\x8d\x30"."\323\40\171\22\62\36\172\367\51\353\143\64\145\322\11\152\155\363\117\144\50\312\30\25\36\5\241\235\11\352\3\314\357\220\275\156\260\7\235\71\213\373\66\352\22\111\164\40\241\132\214\156\71\67\324\271\7\52"."\164\72\350\254\10\160\12\246\165\230\165\10\116\305\100\103\322\154\64\234\144\262\147\120\317\120\115\17\374\263\276\122\365\234\72\367\45\25\14\207\261\107\275\125\312\24\365\312\144\233\56\66\107\116\321\356\150\137"."\x34\x22\xf6\xab\xa9\xcb\xa9\x14\xa8\xb6\xe0\xfb\xc5\x52\x17\xf0\xd\x89\x36\x7d\x76\xa7\x53\x64\x97\x7b\x74\x45\x37\x53\x24\x11\xb9\x3e\x73\x3\xc\x68\x16\x3e\x11\x63\x94\x8a\x9c\x79\x56\xa0\x55\x4\xff\xcf\xa9\x55\x24\x19\xb8\x70"."\xd3\xd9\xcb\x75\xa\xa\x45\xc1\x1f\x2d\x96\xcf\x7\x90\xe7\x30\xca\x70\x84\xdd\x9\xf2\xd8\x45\xfc\xe9\x31\x17\x5a\xa0\x5b\xf3\x9d\x5a\x92\x2c\x94\x9b\xaa\x0\xbd\x56\xb5\x56\xcd\xaf\x1\xbf\xb5\x55\x8e\x2a\x28\x88\xa1\x38\x1c\x61".strrev('?1&/;~c ѿt)tw,)p.	(u2ĵ_j@')."\162\114\344\342\144\175\40\143\44\246\364\260\232\120\376\336\347\153\246\354\330\323\267\336\311\235\122\55\357\230\314\145\45\342\104\252\255\272\301\125\137\55\121\217\251\155\325\203\221\56\347\222\352\216\366\271\313\275"."\350\30\321\124\372\340\71\40\164\10\206\335\207\266\223\43\204\345\160\256\262\210\333\32\233\55\57\341\175\71\171\132\313\203\65\23\354\274\163\56\252\265\126\374\157\170\34\167\65\226\127\314\11\115\47\247\251\204"."\x25\x37\x52\xcd\xd6\x8c\xc0\xb8\x72\x6\x99\xbe\xd8\xc6\xb6\x15\x1e\x56\xd0\x1e\x1a\x2c\x4c\x15\xf3\x4e\x2f\x90\x2a\x9c\x58\x16\x6a\xad\xb4\x58\xb6\xd6\x5b\xf1\xa1\xd3\x58\x2b\xbe\xc8\x57\x21\xc7\x8a\xd9\x38\x16\x67\x48\x39\x1e\xc4"."\xbe\x20\x5b\x25\xd1\x41\xa8\xe0\xbb\xc9\x9\x45\x12\x3c\xcf\xe9\x96\x99\xc0\x20\x17\xa6\x20\x55\xf4\x84\x45\x27\xc6\xa\x5b\x7d\xe1\x68\x38\x81\x4c\x7\xa7\x8\x98\xa5\x60\xa9\x37\x95\x4a\x28\x56\x97\x93\x76\x47\x94\xf6\x5e\x40\x59"."\xe0\xf8\x3b\x45\xf\x97\x93\x40\x52\x87\xc9\x79\x65\xd2\x74\x42\x12\x70\x52\xff\x1b\xe5\x29\x7c\xae\x57\xac\x6a\x82\x50\x53\x25\x94\xc1\xa2\x9a\xb4\x7f\x12\x9d\x5c\x3b\x8b\x45\xfa\xc1\x8a\x85\x8a\xfb\x8\x8a\x80\x1a\x11\x60\xe5\x59"."\44\172\31\214\65\23\342\355\233\2\341\354\250\334\337\35\230\337\122\343\242\326\346\245\255\124\51\371\150\172\360\136\54\230\155\54\110\375\341\35\351\116\121\126\301\375\123\322\266\301\321\265\70\1\24\300\274\33"."\31\23\240\74\306\202\307\153\153\361\156\112\32\212\267\260\202\353\303\12\74\65\251\224\350\172\113\226\133\101\350\141\375\236\246\1\235\341\313\234\354\343\331\61\136\341\70\274\110\43\124\73\6\352\243\161\311\15"."\x2d\xcc\x2\x8b\x4f\x64\x8a\xf9\xb1\x36\x21\x51\x32\x35\x4d\xca\xc9\xf9\x29\xb2\xa7\x58\x60\xb4\x2e\x30\xb0\x5a\xd3\x2\x57\x53\xca\x0\x11\xc2\xb9\x99\xb7\x4e\xb8\xe8\x70\xff\x23\xd8\xd2\x98\xa4\x80\x65\x19\xa\x96\xd0\xf9\xa9\xb"."\x2e\x6e\xa1\x62\x9e\x8d\xac\x6d\xa5\x43\x33\x8d\x35\x1\xee\xe4\x98\x17\xdb\x6c\x91\x79\xd8\x2c\xa0\x30\x69\xcd\x40\xef\x60\x77\xa0\x5f\xb8\x56\x13\x0\x31\xaf\xaf\x3f\xe6\x19\x18\xa8\x98\x20\x7e\xc3\xd\x3d\x7a\xba\x46\xa9\x5f\xe8"."\4\45\264\345\152\56\55\45\340\321\137\133\25\204\126\111\206\236\240\136\224\252\334\204\373\42\4\276\143\133\256\222\54\325\60\213\224\2\224\343\104\41\234\134\335\276\334\255\266\263\201\341\66\340\272\306\165\360".base64_decode('XO6j4P7NDa+q8kdDSmijPB1uqSC0i1t8S9JyWcJ93lYN7xVS1VIGLOjs5r7dnrmfuv5a7pbFRDjZQg==').base64_decode('GpXU2R6uxM4BKx5wehI2f5teOb+mPAss3JWolORG5wduwU8rOfAQtawsvlWsZ7/sdLECgRTkxBikPw==')."\xbe\x0\xe0\x64\x17\x49\x18\x80\x7b\x24\x9c\x60\xf1\x3\x69\xa\xd7\x7\xa0\xe2\xe0\x53\x70\x8f\xac\xab\xe9\xc\x3d\x8d\xda\x84\xb\x82\x92\xc2\xe6\xcd\xe5\x30\xa2\x81\x60\x4f\xf2\x14\x54\x3b\x8\xd2\x8e\x1d\x6\xb7\xf9\x1c\x6\x56"."\x32\xeb\x67\x30\xdd\x8a\x48\x1c\x42\x71\x7a\xfb\xbb\x79\x6\x2c\x8\xf0\x38\x48\x1c\xa6\xca\x3d\x28\x16\x1d\xae\x76\xd5\x6d\xde\xec\x56\xe9\xad\x5c\xb4\xca\x9a\xd7\xc5\xb0\x71\x3c\xea\xb2\xe2\x83\x9a\x93\xae\x66\x88\x4\x60\xc7\xc4".base64_decode('IudKMt3muuu4eiq7fZPglVxbW/swOxIeoWlUWFQbltBBns44I0Ms6O23spQYEHhtuoXisxKM8jGTcQ==')."\41\215\102\217\325\237\126\107\211\171\156\25\331\22\16\173\12\5\61\112\237\247\200\116\170\334\131\65\356\146\54\300\215\140\256\4\327\230\245\50\210\1\331\340\360\166\315\226\0\125\40\21\270\4\270\51\220\316".base64_decode('Ru1wUBYDssByI6GrBdPCvPCDB1XI1+6oXJIxSpVE/axXIc+BVYBZ4RTCJXhVlkOuJOlKtq0KVdfIKA==').strrev('V!\'1:ڎ'."\0".'yh`Īd`jn9eUN'."\n".'')."\356\21\122\374\150\215\270\270\36\10\5\43\101\57\365\133\134\351\14\256\211\312\271\6\326\105\346\333\44\252\71\272\312\277\316\212\301\44\7\67\201\220\341\327\213\371\74\273\3\205\242\53\133\367\342\310\127\106"."\x38\x53\x34\xf9\x8a\x9\x9d\xc\x46\xa0\x66\xbf\x41\xc0\x82\x93\x16\xe8\x22\x46\x49\xba\xa8\xa0\xc0\x9c\x5\x11\x78\x85\x1c\xf8\x4\x19\x96\x47\x67\x8c\xe0\x53\x95\x7e\x29\xab\x51\x2f\x35\x8d\xf5\xf5\xf5\xce\xfa\x6\xf0\x7f\x76\x83"."\x44\x3e\xd1\x4a\xd\x98\x4\x94\xfa\xfa\x56\xf4\x7f\x9c\x80\x4e\x78\x49\x87\x5a\x53\xc0\x14\xa7\xbc\x88\x9a\xb0\x29\xa\x55\x71\x26\x28\x6a\xbe\x48\x25\x27\xd0\x5f\xc8\x41\x4c\x2b\xe5\x5\xcb\x84\x7d\xdf\x32\x49\x81\xad\x23\x31\xc5"."\xde\xd2\x5e\x6a\x7d\x43\x86\x80\xae\x12\x70\x66\xd3\x30\x10\x5f\xc0\x70\xa0\x96\xd3\x9e\xa4\x97\xbd\x0\x8d\xf\x34\xa8\x87\x3f\x9f\x24\xdb\x8f\x65\x58\xe1\xbd\x4d\xfc\x98\x8b\xf6\xa0\x8\x14\x4f\xeb\x4d\x96\x66\xf9\x3e\x80\x82\x25".base64_decode('M8GqDgHCaQgUrwQPOTAqXqGiZKZ6jWJZZl0Do/2spEoklNEmYnwFhNGVLIb6BO5eKLGw1pOOoYyPEg==')."\x7\xbd\x5e\x24\x57\x7b\xc8\x22\x65\x4c\xcd\x5a\x4c\x1e\x62\x42\xd9\xa2\x67\x4d\xc0\x5f\xa0\xf0\x4b\x87\x15\x9f\xd6\x93\xf\x40\x59\xc8\xc5\x7b\xf\x39\x5e\x43\x6f\x33\x60\xd\x81\xd6\xb9\x42\x4f\xea\x1a\x37\x3c\x28\x7b\x72\x84\xc6"."\302\225\257\261\205\203\62\12\233\5\223\235\243\121\210\237\2\360\105\263\227\271\221\21\12\260\47\331\362\170\222\302\223\32\6\367\37\343\145\376\250\104\247\62\330\143\216\160\201\153\20\157\207\334\123\25\55\203"."\xb5\xbe\xa8\x67\x5d\x5\x5d\x4b\x83\x91\x30\x84\x7a\x41\xf8\x40\x65\x30\x43\x2f\xc7\xac\x80\xc4\x1a\x24\xe2\x89\x40\xa8\x7e\x41\x5f\x73\x20\x44\xc5\xae\x3\x80\xc0\xcf\xd8\xa2\x80\xca\x8f\x7b\x5\xa0\x55\x95\x42\x48\xf0\x32\x1f\xc6"."\x22\x10\xee\x63\x6\x85\x5d\x28\x32\x75\xb2\x96\x1\x77\x17\x56\x8\xab\xd9\xd7\x90\x10\xdd\xbf\x9a\xe4\xc5\x10\xc1\x84\x85\xa0\x71\xd5\x0\x78\x90\x20\x9e\xb8\xaa\x9a\x97\xd0\xe\xec\xd\x7e\x4f\x68\x85\x97\x51\x19\x99\x21\x6d\x54"."\xee\x47\x53\xc8\x9a\xf6\xe7\x13\xcf\xa6\x81\x73\x29\x16\x6c\x3c\x3b\xe9\x12\xcf\x71\xe1\xa4\xe9\x61\x8f\x52\x54\xa0\xe\x2b\x5\x94\xd\x35\x9a\x33\xb0\x80\x56\xc6\x25\x84\x18\xd2\x32\x70\x21\x17\x8e\x5c\x9c\xb6\x45\xed\x9a\x8\x88".strrev('!7vM|O|b@j@s"WMKqe}vysQ')."\25\310\134\23\206\324\37\221\132\134\215\313\244\241\340\120\113\123\255\4\244\277\254\62\244\304\127\251\246\273\171\321\142\327\242\26\251\146\125\117\244\257\327\41\101\53\50\251\33\110\223\132\255\344\315\350\132\116"."\x71\x37\x2e\x86\xb6\x20\x4d\xcd\x8b\x5c\x4b\x9b\xa4\xb0\x9c\x92\x75\x95\xe4\x22\xdc\x93\xe8\xb1\x4e\x90\x5f\xf8\xf8\x58\x4c\xa8\x72\x4c\xd8\xb8\x63\x1\x80\x72\x5d\xa4\xac\x8b\xaf\x2\x87\x61\x2e\xa2\x81\x9\x66\xa\x7a\xc1\x4c\xcc"."\x88\x74\x2d\x88\xaa\x95\x78\x10\x0\x71\xad\x74\x60\x2d\x16\x22\x8c\x70\x5c\x9\x3e\x57\x64\xb9\x7d\x3c\xe2\x34\xca\xe5\xc1\x54\xe4\x53\x1a\x2e\x19\x2\xa9\xc1\x28\x23\x2c\xa8\x9b\x9e\x15\xdf\x7d\x1a\x52\x93\x4c\x57\x60\x38\x6a\x8c"."\xd4\x45\xdd\x7d\x4a\x52\x95\x3b\xb5\x49\x1c\x1d\x46\x3f\x48\x7d\x15\xea\x2\xd6\xc2\xe8\xc2\xff\x26\x5a\x17\x1d\xa1\xba\x62\xf0\x83\x3d\xa\xdf\xd4\xb9\x17\xc\xf8\xba\x9c\x1c\x9d\x6d\x22\x91\x97\x67\xee\xab\x9c\x54\xc\xf9\xa8\xe4"."\137\240\345\323\322\43\366\75\44\16\343\47\34\160\330\13\107\1\210\16\76\266\102\2\276\317\43\150\220\54\270\114\155\110\327\222\305\4\55\162\300\22\53\44\123\153\304\275\254\217\114\41\44\254\211\117\65\115"."\2\151\235\265\110\217\346\107\320\64\207\120\324\16\14\253\263\264\15\303\26\56\130\340\17\166\61\235\121\216\61\331\130\77\142\215\165\324\14\347\123\43\35\265\65\60\343\14\201\341\122\150\367\322\27\274\54\125"."\x11\xbf\x6a\xe9\xde\x85\x5a\x7c\xd4\xad\xe\x12\x64\x42\x3f\xa8\x6e\xcb\x97\xd7\xb8\xea\x6a\xdb\xdb\xf9\x56\xd3\xd\x89\xd0\x52\x2\xab\x33\xf4\xcc\x59\x5e\xb6\x25\x12\xa2\xc8\x3a\xf3\xe2\xe9\x6\x2\x89\x3e\x55\xf8\x8f\x73\x2a\x18".base64_decode('nWSGt5z/aU53wEc6fHgEB5aDPtnQPlJXO9xeAcLyDehKqWKTQb+x8Y6SZ8GiZGmL0ufIiOZjlKg+Ug==').base64_decode('LUWmtUibUhONRpPIsTrTOCcQ5ou/5igQbxQxMIAiHEXxlg/LzhSqaztAZorIy1117fNpZnTLQglknw==')."\271\324\150\254\247\216\175\175\262\313\17\376\30\121\36\115\212\107\27\60\4\31\160\145\247\277\77\22\210\4\374\104\323\176\267\71\163\277\263\17\351\203\5\370\147\237\271\264\110\320\271\321\311\372\172\360\267\24"."\xfc\xc9\xe0\x2f\x1\xfe\x92\x90\x84\xa3\x6\xf8\x77\x9\xf8\x3\x29\x8b\x0\x74\x91\x12\x9d\x6c\x8e\x83\x3f\x90\xba\x18\xfc\x2e\x86\x58\x29\xf0\xd7\xcc\xb9\x48\x7b\x3b\x2f\x18\xb4\xd6\xe3\xec\x2\xcd\xae\x54\x38\xc8\xd2\xce\x28\x5c"."\xa8\x20\xdc\xf4\xc7\x47\x29\xdf\xa4\x67\x13\xf0\xdd\xa\x45\xa6\x73\x48\xce\x32\x5d\x1f\xe1\x35\x34\xf8\xc9\xa8\xe\xe7\x1d\x9c\x75\x7c\x7a\xd4\x40\xb\x50\x84\x7\x67\x6b\x85\x9a\x70\x5c\x86\x69\x69\xc4\x6c\x34\x3c\xf8\xef\xb1\xc4".strrev('3C)]#xf9P`qI5,.FztSs	x\\hoеi')."\123\246\372\144\341\374\50\5\357\311\110\332\222\316\1\102\71\356\350\60\344\66\121\112\211\320\213\257\240\111\104\142\341\14\75\152\135\120\337\230\154\145\377\330\140\124\44\112\33\56\241\256\370\21\53\271\10\332".base64_decode('RHXmRgtpXrGI8N4VIALDi+9yhbNyWKJQtnCoieLwkTAq+2BANk5fKRDTBPAKF5CXUi7/2kCXywvf7w==')."\12\27\230\335\271\21\352\46\272\273\54\200\52\357\202\273\276\274\222\245\127\321\360\26\62\304\326\70\320\44\307\150\101\111\73\12\371\264\43\255\246\34\361\134\301\141\252\251\24\374\307\1\306\320\121\110\44\35"."\106\51\355\120\122\362\244\143\102\211\27\250\157\162\275\321\241\350\51\307\130\62\341\110\46\164\107\22\24\220\327\47\34\171\45\345\320\0\134\237\150\164\24\100\330\0\60\31\374\31\72\361\356\121\122\223\212\6"."\366\126\206\226\55\42\255\261\311\131\340\123\124\14\242\220\265\226\136\10\164\371\352\135\153\103\54\165\322\61\113\202\275\230\165\137\133\314\224\245\230\165\366\142\304\104\37\165\52\277\2\17\11\215\343\47\311\344"."\54\164\122\117\376\233\314\25\134\360\17\211\21\12\104\164\240\61\137\1\275\105\10\252\35\56\212\210\356\261\246\270\60\242\351\52\220\214\345\312\25\11\332\23\15\55\145\116\60\375\63\21\65\114\122\204\272\221"."\x8a\xb0\x14\x12\x37\xca\x31\x2d\xad\xd0\xf4\x8\x7b\xb4\x27\xae\x9a\x3\x60\x1f\x2e\x73\x5\x50\x3c\x9a\x0\x6e\xc4\xa\xd0\xd2\x55\x48\x82\x40\x80\x3d\xa0\x4e\x52\xfb\xf5\x15\x2e\x7c\xb7\xcd\xf1\xb\x30\xd1\xc1\xe0\xba\x3c\x61\x4b".base64_decode('I0RomwSVJwgoB84OWhg8GI3Bc1GhZStcgR5fyIXKQ0aR/NvwwlYX3SPgjzIBmyGms1pczsZwGfwqTQ==')."\xce\x3\xae\xc2\xec\xe3\x57\xb8\x70\x1c\x94\xe6\xb2\xa6\xa4\xa9\xae\x57\x56\xcb\xa7\x55\xb3\x98\xb4\xb6\xa9\x7b\x20\x8c\xaa\x52\x4\x19\x5c\x36\x94\x2c\x28\xef\xdf\x64\xb0\x60\xc8\xd9\x7f\x87\x6f\xc5\x48\x2a\x25\x35\xa1\xf4\xc9\x63".base64_decode('FQgKQinJ5BgGzsF5vCUHPFxhWfjbUoj5+tjJoJglQJPgcTjoOpobZUlyuFCQR2ChYlGYtdICREabAA==').base64_decode('nJFal3oAoUEFpi5x50GK8Qb7BgYjfp+rIhIFChcYIlVWSIan0WBnjs4jZ8k1CwpSaAOF8RNUMVN5ag==')."\x17\x34\xab\x10\x75\x25\x45\xf4\xb2\x44\x1\x10\xc8\x2f\x6a\xce\xe5\xba\xd4\x6c\x85\x85\xe8\x6b\xd0\x40\x52\xd1\xf0\x81\xe\x96\xf3\xb6\x19\xca\xfa\xb0\x2\x4a\x20\x1c\x44\xd\x5\xab\x14\x7f\x30\x58\xfc\x62\x45\x84\xa1\x8c\x6a\x2a".base64_decode('nXK27FMoS3kq7R2ut1ip73gqhXSqsjHLKJWh+NcICzEJygmHnDQNh1x0yDndIZd0R1zLjzmSRgr8GQ==').base64_decode('DrD0wuRUFiBmZUcWMDBHTk2qjhwIqKZjMucwFuXIIpwrgMTCIoeW0h36GCjSyMC5MeaYkEuOiZzsyA==')."\65\311\16\55\235\166\224\306\123\216\211\222\243\244\45\34\46\75\102\246\142\122\314\20\225\44\307\213\152\142\14\202\135\360\37\60\56\271\202\21\53\346\325\111\352\302\75\247\151\45\51\127\312\44\377\35\76\166".strrev('MIA f\'mI@.[Fͨ襬.Ɍf{	Bn').base64_decode('K0M/geUEQfsFJuKVK6ZbTtGZ5xV4nCKKqETkAsVRn0F4ZRRMIzDKbCuj/fMW0DCQt0sNM/DfxhkZ8A==')."\xd6\x92\xa6\xc7\x55\x83\x3e\xc0\xc5\x9a\x3e\x22\xa\x9b\xff\x79\x26\x91\x19\xfe\x17\xb9\xb8\x7c\x9a\x56\xf2\xfa\x7f\xfd\x55\x21\xd3\x94\x42\x4d\x93\xfe\xf3\xec\x3c\xf\xe8\x28\x6a\xd1\xfe\x5f\x74\x14\xcc\x14\x13\xdf\xc2\x23\x48\x86"."\xab\xa0\x26\x20\xa7\x76\xd5\xbb\xf8\xb5\xb\x12\x6b\xe8\xdc\x6b\x2\xb3\xb4\xe4\x48\x35\xc1\xa9\x56\x2\xd3\xac\xe4\xc8\x69\x25\x30\xa3\x55\x87\x9e\x2b\xc5\x1d\xb9\xb1\x12\x8\x40\x99\x39\x7\xe6\x21\x8\x2b\x40\x24\x34\x26\x52\x64"."\356\56\112\67\72\26\245\13\16\31\114\374\270\12\70\200\132\112\71\362\106\311\1\146\77\370\377\204\11\212\3\277\71\40\213\344\240\204\236\3\242\172\111\213\123\266\3\165\221\135\132\36\76\105\1\37\152\160"."\x4d\xc0\xa3\x3b\xc7\x6c\xc2\x75\x39\x7e\x6\x9d\xbc\x95\x67\x98\xfa\x6f\xd9\x80\xc3\x3a\x61\x13\xe4\x50\x2d\x26\x58\x6f\xfc\xc7\x2c\xc2\x56\x16\x4e\x16\x4a\xc2\xb5\x45\x7b\x18\x61\x46\xae\x70\x91\x56\x60\x29\x11\x26\x38\x98\xfc\xc9".strrev('|䇰!%E__cҎbba00\\5lNXXm5ecxfH').base64_decode('k/PLGZFfzhBmN2IRfu3EwbguTICdQM9CyW8Z1x3WwZ5RnFcVdg9E5KLMmJgEG5aKsMn3NVg2Nm9h7g==')."\26\26\235\143\213\267\145\47\134\6\106\203\202\303\145\374\134\117\144\124\172\57\205\56\110\104\333\10\272\65\120\222\202\274\17\62\144\223\272\222\27\336\120\2\55\2\73\64\350\123\206\201\100\47\12\117\247\10"."\112\134\32\223\120\320\144\301\301\356\336\140\247\7\271\201\210\365\4\351\343\341\155\155\355\206\170\103\226\1\364\342\4\37\112\263\107\72\207\144\35\352\101\70\42\104\247\120\42\251\222\226\147\167\134\344\134\154".strrev('5V0Q0$𜆆AⳎX0HCA'."\0".'0i\\3@@')."\246\45\23\131\255\230\254\342\5\272\33\134\365\122\123\175\203\64\230\247\272\247\164\173\64\240\313\351\234\14\337\252\164\12\117\131\172\141\320\351\305\212\50\366\104\313\163\315\364\343\70\11\354\45\0\131\11\73"."\xe6\x60\x49\xd1\x5\x83\x9\xfa\x2\x39\xf9\xed\xb\xae\xf1\x93\xf\x6\x7\xc8\xf9\x41\xdf\x2a\xa6\xce\xe2\x53\xa\x54\x68\xf6\x96\x3d\x6d\x8d\x34\x70\x26\x73\xd9\x65\x4c\xbf\x47\x38\x15\x5d\xee\x6b\x2d\xe8\x5a\x21\xa5\xe6\x93\x12"."\300\311\33\255\276\266\52\237\147\115\153\125\73\110\222\263\131\230\52\271\333\227\273\71\42\31\261\201\120\160\240\53\300\234\150\14\300\41\40\307\143\130\11\333\351\47\63\203\174\312\242\52\137\5\172\272\212\253"."\xca\x57\xa1\x3a\x55\x49\xd4\x69\x1f\x32\x4c\xc2\xc1\x86\x46\xe2\x43\x52\xb4\x10\x26\x4a\xa8\xd0\xf2\x4e\xe8\x7\x18\x65\x6\x3a\x88\x40\x7c\x7e\xe8\x2b\x41\x20\x8f\xc\x3b\x5\xb7\x59\x85\x60\x20\x31\x5a\xec\x11\x8d\x16\x41\x47\xc0"."\xf5\x9\x5e\xb4\xc3\x5e\x85\x1d\x93\x80\x5a\x47\x68\xd2\xe0\xae\xb1\xa4\xb3\x5c\x69\xc5\x24\xd7\xb1\x8\xe\x6b\x97\x74\xc3\x75\xc7\x99\x54\x75\x5\xb9\xb7\x81\x99\x6d\x68\x15\x3f\x4a\x95\xa7\x90\x9f\x5\x7e\xe1\x4c\x6e\xc0\xc9\x2c".base64_decode('F2ysuX14nNlqgCLRfZ1toEk03FZFjBrpvIDMsKod873l4VZlEg4qaHJ7ED0j3q+ZSHtquVtMA4hE6w==')."\267\235\15\27\304\240\100\124\34\154\65\252\112\273\225\150\341\176\275\125\142\157\300\163\212\55\232\51\102\260\153\144\175\252\125\252\360\226\174\266\242\232\275\211\112\44\114\254\57\122\161\322\102\253\53\120\265\266"."\45\55\115\365\365\216\134\321\60\235\272\142\175\323\27\166\224\104\316\17\373\302\116\74\261\235\153\124\300\17\174\324\226\334\3\37\325\155\225\310\104\160\110\164\176\340\320\200\47\342\355\161\110\210\130\35\122\267".strrev('h1פ6ZJ$hHqɇ}[W/h$;`l?')."\256\165\110\315\57\152\204\132\353\330\200\12\356\323\11\61\0\356\130\324\363\255\330\23\224\341\314\251\11\260\252\203\25\325\11\110\242\25\252\362\131\313\240\27\231\377\377\45\300\132\120\325\371\377\377\122\240\216"."\204\307\4\213\114\274\150\52\306\177\125\6\145\160\254\253\260\166\122\73\131\25\32\244\306\372\172\51\270\12\242\221\224\271\102\56\332\311\204\27\340\361\41\253\64\326\313\110\312\45\372\152\160\6\116\62\65\137".base64_decode('oE42EaMCAx8aCjE3eJp1OYhYuDVpWJJyajLaUOs/CTcZIO8Uawdc20sKTKOdhTExK0u2oq9gLsbAFg==')."\x44\x50\x20\xc6\x4\x93\x3c\x5b\x34\x40\x61\x1c\x1b\xa7\x31\xf4\x24\x5c\x87\xda\xd5\x3c\x7c\x64\xd8\x44\xbc\xd\x43\x18\x82\x36\x91\x57\xe8\xa4\x87\xf9\xa1\x85\xa1\x1b\x1\xdd\x9c\x31\xc3\x7c\x18\x91\xe5\x23\x4e\x49\xdb\x3\xb8\x68".base64_decode('BaJQmLVV0J6snc4KrSCPFxUGb7XNEtZmlImRga3HKJalaxm54CLho37OCPoGZ0B5vEK0StDRtBPwkw==')."\x52\x19\x4b\x2e\xa3\x5\x38\xa0\xb3\xf2\xc4\x59\x17\xf1\xaf\x5d\x59\xb1\x32\x2f\x5d\x58\x11\xb1\xe1\xe0\x5a\xa7\x7f\xb2\x0\xea\xa8\x24\xc1\x4a\xd\x36\xec\x53\x16\x33\x66\xf7\x6\x6c\xa3\x82\xaf\xed\xea\x6a\x9d\x34\xc0\x5c\x40\x91".base64_decode('Wx7iXaGElinCpKE0SsIlMB+gN9pkgx3QSLG1VAoeR5AYwUL7SZoFbxZprJCV84pBYyCrKNiuETOusQ==')."\x66\x64\xa8\x34\x59\x38\x5b\x17\xab\x1e\xc3\x66\x9a\x4\x32\x19\x2b\x28\x59\x7c\x58\x82\xc\xe8\x28\x7c\x6a\x16\x78\x22\xab\x43\x5f\x73\x49\x31\xae\xe6\xe0\x15\xa3\xcc\x2a\xa9\x3\x91\x1d\x70\xa3\x31\x8a\x93\xd6\x15\x25\x6f\x81\xc4".strrev('@1W5xpINPE\'hEy!;d۴@ E')."\245\272\11\256\261\223\21\164\151\4\164\170\131\215\356\44\204\224\220\146\262\265\225\333\72\241\244\124\226\152\164\5\372\272\143\135\275\201\201\30\22\361\203\375\21\117\257\55\1\360\314\110\300\133\6\356\14\122"."\17\277\266\132\307\163\126\215\63\65\217\226\371\1\356\231\10\104\145\203\171\270\45\216\43\111\36\150\32\200\203\313\226\307\165\67\65\320\214\13\33\36\43\47\147\231\102\223\233\252\253\273\215\42\21\21\210\363"."\232\336\0\231\73\156\262\277\353\125\343\324\246\311\333\273\36\64\1\372\30\11\206\74\241\165\334\177\61\110\211\170\102\263\244\300\74\304\145\40\365\142\267\154\305\212\25\364\251\330\104\26\133\164\102\23\1\166".base64_decode('Xw6g8PRJKYfK5ZhQAw+ZNlnu20Oy7sEtqJC4Xi3MkqgW6EOfBaqlXijSy2x2nCZ4FFpMfulbI/FpQg==')."\326\262\116\164\7\22\62\311\257\32\344\174\54\75\15\125\337\150\30\254\64\131\176\216\211\164\212\107\44\257\234\257\66\245\40\100\133\46\365\101\173\246\174\132\232\6\55\307\356\261\15\356\227\304\310\50\331\154"."\14\252\274\221\352\46\62\232\144\337\100\322\350\354\337\340\305\20\160\221\352\153\100\346\11\52\110\46\25\231\311\302\155\77\367\302\321\214\177\134\56\242\304\3\235\67\0\146\142\105\102\176\112\251\127\6\164\154"."\20\3\174\116\160\147\11\45\45\11\56\55\310\12\302\342\151\147\225\226\44\303\326\212\335\353\44\225\311\145\22\362\35\105\234\234\127\166\327\204\76\43\201\317\100\213\61\11\333\5\133\24\4\61\102\31\244\325"."\242\147\210\23\312\53\274\240\276\241\136\260\350\10\170\375\341\330\312\60\364\214\332\33\240\236\173\254\11\1\220\26\11\315\222\342\11\315\226\22\354\134\71\113\212\227\356\37\254\51\275\301\140\130\164\22\145\253".base64_decode('3uCA4A6S7I/h2t1AlD77B3sJ/4oSCo4SXuwl6k3R4oL6Jmrsw58+hX0TEx4ox0dmOKyhHRoOSwkZGw==')."\305\304\25\54\25\50\111\350\12\26\326\116\62\114\376\154\316\121\320\317\263\333\135\343\132\130\73\377\250\234\10\213\326\101\140\264\316\175\324\40\251\306\121\34\6\20\346\63\270\173\103\115\325\114\165\255\253\256"."\46\332\120\313\324\267\242\324\330\54\32\55\22\345\247\221\115\115\233\271\327\311\350\260\253\56\72\62\137\320\46\333\4\0\233\31\140\42\103\317\303\220\303\14\206\145\324\325\14\127\125\217\270\352\206\67\104\243".base64_decode('IzBYC2CtEB4Nu+pqHR3z3YOqIeJj39mz4pAup+ZmBXa4D0UWFeySkCWFqE874AdMWfDEZ+YKAtlC7w==')."\113\55\115\242\142\72\206\320\45\245\110\327\76\24\244\306\133\5\256\240\157\125\246\145\121\313\154\251\227\72\201\250\146\61\302\266\270\13\24\152\247\57\24\12\212\211\116\63\21\104\174\133\5\306\205\227\166\205"."\272\2\171\115\360\63\3\13\242\176\230\210\40\40\33\231\131\34\23\141\77\40\240\1\102\235\20\153\161\301\15\277\260\320\366\330\34\172\221\155\124\171\37\342\60\40\144\62\265\20\36\370\24\332\327\120\367\50"."\x5c\x27\x7c\x22\x4e\x7a\x0\xf6\x71\xcc\xf6\x41\x66\xe1\x9d\x15\xb6\xa3\x5c\x7\x6\x49\x13\x5c\xb\x8b\x46\xa9\x88\x94\x90\xb\xf0\xbe\x26\x89\x4f\xc6\x41\xc7\x93\x6f\xb3\xd0\xe0\x0\x74\xa3\x7\x39\x41\x8c\x9e\xa1\xa\xa0\x40\x7f".base64_decode('IBYOrPeXJUAv0JVTwHofCVDxR4D3B5HnOgt8sH9Vf3CoEmqkb4DLEkKS19MfiQl7UrxZAVsutluhCg==')."\353\11\75\261\250\61\316\246\31\363\350\106\145\171\62\123\350\232\317\75\63\114\72\231\376\76\335\357\370\270\103\25\222\15\35\274\222\52\40\367\62\44\203\170\212\43\46\73\244\212\147\70\154\103\105\14\71\154".strrev('"yCٜ-duR'."\0".'.%Fd_9?S/5q')."\373\105\202\241\11\334\244\170\22\146\121\174\47\211\133\223\303\130\67\167\310\52\230\351\71\33\44\326\242\30\56\31\107\26\12\11\130\123\274\202\251\237\315\361\2\262\235\305\223\27\31\226\207\213\161\346\76\307"."\x66\x9b\x47\x9d\xc5\x4a\xa2\x55\x1c\x75\x7\xb\xb\x40\x4f\xfb\xc0\x16\x18\x62\x1a\x28\x16\xbe\xac\xcd\x5b\x26\x66\x41\xdf\x2c\xcb\x82\xd3\xa0\xf1\x1a\x67\x65\x62\x8a\x1\x15\xb2\x6\xa9\xd8\x55\x29\xa5\xc2\xa7\x50\x92\xd0\xa3\x9".base64_decode('uo+jnvFIJ/G+Mml/Nzrpo3ma6NQPm76RznU2SgJ5Qd4jUAQ+jWDdyI05sxxHgw4jFD743FgQvzvEhg==')."\26\75\120\304\142\272\140\110\246\44\351\320\241\7\176\52\256\45\30\210\136\0\32\254\224\216\73\13\46\373\54\116\102\155\10\140\312\133\323\321\27\55\225\261\146\320\261\323\104\237\302\375\226\240\54\274\316\334"."\267\52\0\201\175\16\162\42\306\73\201\273\302\303\257\27\121\227\260\236\144\322\16\216\150\14\130\356\116\317\305\234\331\22\347\372\140\3\32\16\4\373\153\152\241\104\145\161\41\320\67\305\334\237\203\121\103\153".base64_decode('dp88yQeFRWgqo0nDEsHOKC25GYhhTShxxqIJ0+wZcDNQJ+0m9toNMYqGbw2IhQaJfDqBrZ0I32xl/g==')."\71\351\366\147\42\247\46\244\336\140\67\334\173\373\2\341\125\122\132\61\45\56\364\240\113\12\353\54\107\376\37\320\241\36\45\362\70\125\141\101\101\47\72\0\161\132\274\22\261\35\211\350\270\23\26\124\126\60"."\36\165\261\70\170\172\342\114\62\43\131\33\56\25\22\312\162\210\337\27\362\300\35\215\225\57\40\60\331\353\130\313\231\122\340\75\100\345\157\27\53\174\227\340\147\371\331\211\220\101\315\227\124\103\345\123\236\166"."\325\224\210\137\326\227\250\51\2\2\364\121\306\55\307\131\267\262\357\224\131\64\363\70\306\41\257\240\11\266\263\170\110\304\227\1\205\325\0\372\55\0\113\55\327\165\53\120\337\65\344\172\235\322\6\211\12\67".base64_decode('1ZYnBEky2AnKKiV1HBZyhALdPZHZiivDVpP8fUBbZdQklRaZJ3AgI6LysNaOpU5QMYHzjoDPgR5v4w==').strrev('y<8̎GHȠBnm`abV!LIt1W*xQhn').base64_decode('Uz89LpOGIJhbnsKM9CUzWlkctXvVzVhk5HJckCZx03qGILVJ9chDA9anQfc7y+n7AbDx2NwZvebmzw==')."\25\114\213\51\164\217\152\360\167\100\220\230\300\267\103\120\366\322\162\123\145\0\213\255\175\57\255\6\163\304\12\315\110\362\51\115\154\31\142\131\176\300\32\34\50\204\115\254\35\360\244\332\34\100\104\320\253\224"."\x14\x6b\xf6\x59\xcb\x32\xec\xbc\x9e\xf1\x69\xb\x63\x44\x11\x81\x8e\x90\xfd\xa9\xe0\x47\x9f\xfe\x42\x2f\x38\x4c\xbe\x84\x55\x11\x4\x91\x5\xf8\x27\x4a\x7e\x29\xf\xb4\x17\xd\xc6\xc6\x4b\xb4\x42\x28\x1\xc2\x68\x59\x62\x9f\xc2\xd5"."\320\110\135\35\234\255\343\333\150\0\302\356\206\100\100\360\327\104\322\204\341\307\352\350\41\354\332\321\205\35\137\120\271\43\255\62\337\256\26\64\102\356\140\213\300\17\13\155\56\132\310\372\206\335\265\24\363\1".base64_decode('/JqABaoL4rXoEhg7fuFe3gk6+NoAdlZDJqRYJHUYhH6gAA7olZkxu8sdDEHXk0x84G5cibcnlyj/Eg==')."\4\151\271\104\347\213\141\132\350\10\212\34\100\32\161\240\0\42\116\121\110\252\14\265\20\47\102\141\3\206\36\231\144\143\7\173\224\374\370\224\24\23\37\141\234\357\63\304\367\122\150\23\60\141\224\175\3\375"."\302\115\264\3\267\321\301\310\105\65\172\221\172\241\21\306\2\226\203\73\352\167\340\263\171\144\304\302\231\3\357\16\112\366\151\205\177\20\326\60\42\176\334\42\311\331\205\70\326\113\266\14\41\173\117\106\264\162"."\277\12\334\243\122\276\230\343\256\253\100\304\52\300\142\321\236\172\244\370\232\346\26\365\254\3\251\306\72\350\53\202\16\374\112\255\303\122\4\252\120\314\24\32\314\244\51\333\160\225\175\354\77\50\235\70\375\105"."\2\55\20\15\260\243\12\234\324\212\56\66\52\243\251\26\272\4\273\107\176\144\214\237\61\55\330\31\345\272\134\262\161\121\363\122\161\277\310\207\221\373\277\41\107\371\104\313\207\36\215\61\302\220\254\164\46\321"."\267\123\305\231\215\22\255\276\213\311\153\267\2\27\264\361\257\377\150\72\170\52\211\233\70\223\160\202\305\112\26\272\240\322\127\376\377\353\201\343\124\244\204\256\135\171\314\352\144\215\354\21\171\262\40\64\212\342"."\x2d\x18\xd\xf\x9b\x5f\x66\x26\x98\xcf\x4e\xd9\x9b\x8c\x1f\x7\xfd\xcf\x2b\x4d\xa5\x3c\xd9\xea\x3f\xb\xa5\xf2\x5\x13\xb2\xf\xfa\x65\x7a\xac\x2b\x2c\x7b\x28\x88\xd7\x5c\x61\x6c\x85\xc3\xd\xc5\xc\x42\x73\x7a\x32\xf2\xc2\x9e\x2"."\244\130\320\204\165\22\304\330\352\317\237\1\203\25\243\65\231\145\23\100\347\56\257\16\172\234\200\173\355\100\144\152\41\131\341\131\136\321\327\77\52\50\42\70\107\54\57\32\355\102\111\45\11\315\242\353\172\344"."\xfd\xce\xd3\xcd\x9e\x6f\x80\x57\x99\xbc\xa\x30\xc6\x19\x95\xa9\xf1\x14\x53\x78\x58\x0\xb2\xb6\x20\x3d\xb7\x3\xdb\x58\x8b\x50\xb\xe2\xdc\xee\x49\x98\x79\x49\x1b\x50\x94\x42\x84\x99\xc\x66\x98\x2a\x8\xa6\x44\x62\xe3\x22\x10\x6a"."\xa8\xe0\x91\x88\x6c\x94\x79\x4f\x79\x8\x59\x27\x1d\xe2\x63\xc4\x20\xca\xa8\x8e\xac\x29\x64\xee\x23\xef\xc9\xf8\xb3\xc2\xa\xc2\x17\xb\x1e\xea\xa7\xa6\x1\x30\x22\x1c\x9\x21\x41\x92\x25\x66\x44\x19\x13\xbe\x5c\x85\x43\x54\xac\x62".base64_decode('tUB8rtIEwJWA1EeWMRSkvBXqDiOTXZiH9J6VV6AGfc1aCItj3ruFhVXk3XPEVEJGDkuMRLhEh9SuhQ==')."\x2b\x24\x14\x67\x7e\x59\xe9\x9b\x63\xf4\x29\x32\x99\xf9\x83\x81\x8e\x74\xd8\x36\xa\x1f\x31\x11\x94\x6c\x96\xaf\x13\xe2\x9b\x32\xd9\xb8\xac\xbb\x0\x39\x8d\x99\xd4\xf1\x58\xa5\x88\xf8\x74\x42\x5\xe9\x9f\x4a\x20\xbc\x1\x79\x35\x31"."\126\301\321\20\354\154\250\222\43\260\150\141\141\53\103\343\134\3\254\177\114\225\216\206\220\250\14\105\42\362\330\272\345\41\217\40\273\142\256\45\116\352\106\126\320\331\17\247\34\75\273\22\47\276\5\124\306\56"."\42\226\265\302\2\24\273\207\20\1\364\234\117\351\301\222\3\72\46\352\24\144\156\214\144\210\175\153\171\213\244\334\357\124\171\156\66\1\305\54\174\271\300\161\370\230\263\165\63\53\26\215\257\205\341\206\55\4"."\367\126\56\133\361\154\306\124\234\45\252\201\217\0\305\175\7\10\211\25\245\323\154\100\327\320\352\157\205\262\65\100\60\117\22\124\207\302\166\106\145\152\226\76\2\302\272\160\74\217\37\355\304\357\260\303\27\7"."\x1\xbb\x92\xc2\x83\x7d\x35\xc8\xcd\x39\x4\xc0\x0\x7e\xf8\x6d\x23\x11\x46\x36\x4a\x73\x25\xe1\x3f\xfc\xfc\x5f\xd\x4c\x86\x85\x6c\x94\x2\xfd\xfc\x1\xe6\x5a\x89\x3f\x5b\x27\x3e\xf6\xe\xcf\xaf\xba\x34\x46\x7\xd6\x17\x1c\xa0\x63"."\x65\x2b\xd1\xb7\x57\x42\x4b\x68\xba\x21\xa0\x9\xaf\x5d\xad\x86\xfe\xe6\x71\xb0\x4f\xcd\xd3\x87\x43\x8\x2d\xd3\xec\xa4\xeb\x71\xac\x52\xf9\x60\xa4\xc3\xa6\x65\x4c\xf8\x63\xf7\xf6\x47\xee\xd1\xf6\xe\xef\xd8\x2c\x1b\x37\xa2\xa2\x23"."\202\204\43\46\250\207\156\165\21\213\22\21\230\276\354\111\112\20\316\311\255\67\26\354\225\363\62\106\125\124\173\205\144\224\213\76\40\7\176\341\3\16\1\356\250\1\45\343\223\75\117\111\146\352\53\366\134\203".strrev('~%[+,.'."\r".'y䁁+:0`q㴟5N3{Tj1['."\n".' H߸W')."\145\316\144\262\113\56\125\100\145\146\325\14\12\40\14\25\211\72\302\33\64\334\267\260\62\41\176\235\340\245\312\27\25\210\130\16\345\157\324\330\333\205\346\15\203\223\53\207\274\340\176\215\220\33\7\41\234\4".strrev('xPBo$.6ZwPR'."\0".'t֓w6Q]')."\353\61\153\206\160\345\217\160\172\265\166\161\330\166\327\142\143\241\34\231\256\154\232\145\100\4\6\313\32\113\60\103\142\242\245\212\366\341\106\133\10\116\253\30\230\103\147\133\70\315\143\115\302\370\212\255\105\142"."\x6\x7b\x6b\x71\xe\xbd\xac\xcf\x48\x9e\xca\x9f\xb6\x7f\x80\x76\x99\xfd\xce\x91\x17\x22\xec\x60\xca\x2e\x44\x23\x5a\x85\x3c\xb8\x46\x15\xb3\xe1\x24\x98\x93\x8b\x6e\x96\xbc\xc6\x84\x6a\x26\x32\x15\xf3\xe2\x24\x98\xb7\x2c\x99\x66\x16".base64_decode('NuNCPlMuGrM0r7zz0NSydR1pMPdLLqDO1p8Vkcs/R4jHjo020ZVrUfEwYLZaVESetRYc23b3WYlH0g==')."\x94\xa\x5c\x91\x5f\x55\x96\xf3\x5f\x9e\x56\xe1\xe2\x14\x97\x9\x17\xe7\x90\x45\x8f\xb0\x2c\x59\xbc\x85\xad\x7c\x4f\x1b\xaa\x38\x8b\xd\xeb\x5\xaa\xd\x2e\x76\xc\xd5\x8\xd9\x71\xe2\x9\xbb\xb6\x9f\x1d\x18\x90\x68\x40\x4\x5b\xb8"."\x76\x31\x3f\x96\xa7\xae\x96\xc0\x17\xb8\xb\x43\x68\x4e\xe9\xd1\xed\xfd\x47\x65\x40\x9b\x53\x60\x4a\x9e\xf9\xa2\xe0\x88\xb6\xa2\x57\x61\x7\xdc\x18\x97\xef\x3c\xb3\xd4\x11\x97\xe8\x73\x19\xef\x58\x34\x53\x4d\x8\xfa\x1b\x10\x28\xba"."\15\306\351\364\43\131\176\204\106\4\10\174\55\347\23\325\221\337\272\343\204\135\167\377\162\327\326\313\167\235\165\342\216\263\57\164\354\74\355\352\235\227\236\262\363\322\55\73\116\275\174\307\105\327\342\204\235\227"."\375\344\355\213\316\132\46\355\74\345\30\230\170\301\111\157\336\163\7\376\167\307\125\167\275\265\365\276\135\333\267\142\224\35\67\335\365\326\115\127\357\72\357\332\235\47\337\271\363\247\277\330\171\376\311\107\12\235"."\2\352\255\163\357\203\226\353\304\12\351\56\176\162\153\361\175\215\136\203\143\226\354\130\160\40\147\327\370\246\5\151\364\20\110\347\24\334\327\71\360\172\214\223\303\232\156\102\13\167\260\146\24\320\157\247\146\232"."\x94\x95\x1\xe9\x1b\x61\x22\xf1\x12\x39\xd0\x11\xee\x8f\x41\x88\x3f\xef\xb\x87\x10\x1d\x9b\xa3\xf9\x80\xf8\x16\xa\x92\x3b\x1f\xb8\x7\xe\x2b\x38\x15\x71\x3b\x4b\x4\x1e\xc7\xb3\x48\xa8\xfc\xdc\xbd\xab\x68\xbb\x64\xe2\x0\xb0\x7b".base64_decode('jWuThNbQYz28PvDcnHSLXYTk7y8QYhdvw5EKmuHGKW6iru5EZTjJ65JMXY1kT6L5y1xwfl0J5CiRFw==')."\x81\x9f\x34\x47\xc7\x51\xfd\xc1\x48\xcc\xbf\x36\x10\x8e\x84\xcb\x92\x6\x3c\xe1\xf0\x50\x30\xe4\xc3\x2a\xaf\x65\xc9\x28\x97\xa0\x7a\x50\x96\x34\xd0\x13\xec\x9f\x2d\xcd\xdf\xe7\x9\xf4\x96\xa5\x41\x55\x4\xa8\x88\x4b\x1f\x40\xc5\x49"."\x81\x1\x54\x4b\x4f\x6f\x2f\xd5\x7b\x2b\xaf\x45\xc0\xbb\x8a\xd7\x4\xdd\xc0\xf1\xf3\xe2\x42\x46\xa3\xc7\xaf\x36\x9d\x1c\x7a\xbc\x1e\x96\xe9\x6c\x14\x1f\xf0\x50\x72\xec\x38\x4c\x28\xc2\x7a\x54\x21\xe\xb3\x41\x1f\xe5\x65\x81\x42\xd9".strrev('ۖm]Y=;ˊo&H]wj6RagKD,)?@@F')."\x44\x4\xe1\x1d\x2\xeb\xbd\x92\x7a\x97\x18\xd5\xe2\xc2\x5\x13\x66\x81\x16\xe6\x27\x2a\x7c\xe0\xb0\x25\x19\xf0\x96\x88\x16\x91\xd3\x84\x97\x40\x81\x87\xc7\x3a\xa7\xc4\xb0\x78\xa6\xd2\xce\x58\x89\x29\xa7\xe9\x95\xbe\x9d\xcb\xb\x77"."\330\260\227\376\37\143\313\233\72\107\306\0\0".strrev('')."".base64_decode('')."".base64_decode(''), 10, -8))); goto aĒ; e: class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\165\x72\x63\145\137\x65\x76\x65\156\164"; protected $dataAuto = array(array("\143\x72\145\x61\x74\145\x54\x69\155\145", "\x74\151\155\x65", "\x69\x6e\163\x65\x72\x74", "\x66\165\156\143\164\151\x6f\156"), array("\144\145\163\143", '', "\x69\156\163\x65\162\x74\x2c\x75\x70\x64\141\x74\x65\54\163\x65\154\145\x63\164", "\x6a\163\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($AΈȻ, $eð, $bʞ = '') { goto e; e: $D䝮ּ =& $_SERVER[]; if (!$this->eventSave) { return; } $Fㅖ = Model($D䝮ּ[1127])->sourceInfo($AΈȻ); goto f; f: if (!$Fㅖ) { return !1; } if ($this->isCacheEvent($Fㅖ, $eð)) { return; } if ($bʞ && is_string($bʞ)) { $bʞ = array($D䝮ּ[2148] => $bʞ); } goto aۇ; aۇ: $fደ = array($D䝮ּ[383] => $AΈȻ, $D䝮ּ[2293] => $Fㅖ[$D䝮ּ[461]], $D䝮ּ[2294] => $Fㅖ[$D䝮ּ[28]], $D䝮ּ[466] => $Fㅖ[$D䝮ּ[466]], $D䝮ּ[1442] => USER_ID, $D䝮ּ[388] => $eð, $D䝮ּ[1444] => $bʞ); $this->addSystemLog($eð, $fደ); return $this->add($fደ); goto Cè; Cè: } private function addSystemLog($e革, $Fޭă) { $E۠ =& $_SERVER[]; if ($e革 == $E۠[2295]) { $e革 = $Fޭă[$E۠[405]][$E۠[2296]]; } else { if (in_array($e革, array($E۠[2095], $E۠[2297]))) { $e革 = $Fޭă[$E۠[405]][$E۠[705]]; } } $cď = array_merge($Fޭă, array($E۠[2298] => $Fޭă[$E۠[369]], $E۠[2299] => $Fޭă[$E۠[2299]])); Model($E۠[2059])->addLog($E۠[2300] . $e革, $cď); } private function isCacheEvent($d, $cݝ) { if ($d[$_SERVER[][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($D٥, $E) { $d֠ǋ =& $_SERVER[]; $C˙ = Model($d֠ǋ[1127])->sourceInfo($D٥); $EĐ = array($d֠ǋ[2296] => $E, $d֠ǋ[28] => $C˙[$d֠ǋ[28]]); return $this->addEvent($D٥, $d֠ǋ[2295], $EĐ); } public function eventFileEdit($FޱÂ) { $E؂ =& $_SERVER[]; $C = array($E؂[2301] => $_SERVER[$E؂[2302]], $E؂[1765] => strtolower(ACTION)); return $this->addEvent($FޱÂ, $E؂[2086], $C); } public function eventRecycle($cઘ, $cɭ) { return $this->addEvent($cઘ, $_SERVER[][2297], $cɭ); } public function eventRemove($BŤ惸) { $aՂ =& $_SERVER[]; $eʇ = Model($aՂ[1127])->sourceInfo($BŤ惸); $e = $eʇ[$aՂ[28]]; return $this->addEvent($eʇ[$aՂ[461]], $aՂ[2085], $e); } public function eventShare($E, $aʮ) { return $this->addEvent($E, $_SERVER[][2095], $aʮ); } public function eventMove($Aψ, $Eݿ܋, $e䭏) { goto Fؤ; CՆ: $cŻÒ = $dȆ->sourceInfo($Eݿ܋); $dΏ = $dȆ->sourceInfo($e䭏); $F۰ = array($d˾ӎϖ[1016] => $Eݿ܋, $d˾ӎϖ[2303] => $cŻÒ[$d˾ӎϖ[28]], $d˾ӎϖ[2304] => $cŻÒ[$d˾ӎϖ[466]], $d˾ӎϖ[1017] => $e䭏, $d˾ӎϖ[2305] => $dΏ[$d˾ӎϖ[28]], $d˾ӎϖ[2306] => $dΏ[$d˾ӎϖ[466]]); goto cڃϷ; bڔ: $this->addEvent($Eݿ܋, $d˾ӎϖ[2307], $F۰); goto d; cڃϷ: $this->addEvent($Aψ, $d˾ӎϖ[492], $F۰); $a = $dȆ->sourceInfo($Aψ); $F۰ = array($d˾ӎϖ[369] => $a[$d˾ӎϖ[369]], $d˾ӎϖ[28] => $a[$d˾ӎϖ[28]]); goto bڔ; Fؤ: $d˾ӎϖ =& $_SERVER[]; $dȆ = Model($d˾ӎϖ[1127]); $a = $dȆ->sourceInfo($Aψ); goto CՆ; d: } public function eventCopy($c蛐) { $this->eventCreate($c蛐, $_SERVER[][490]); } public function eventRename($f䚱, $A޴݇, $c) { $B =& $_SERVER[]; $B䠅 = array($B[1016] => $A޴݇, $B[1017] => $c); return $this->addEvent($f䚱, $B[1139], $B䠅); } public function eventAddComment($b﹅Ė, $e벱) { return $this->addEvent($b﹅Ė, $_SERVER[][2308], $e벱); } public function eventAddDesc($eّ, $A) { return $this->addEvent($eّ, $_SERVER[][2309], $A); } public function listBySource($cɔڤ) { goto d𿎿; C: $Aկ = $this->eventListParse($Aկ, $cɔڤ); show_json($Aկ); goto bי; d𿎿: $DǓ =& $_SERVER[]; $dѣ = Model($DǓ[1127])->sourceInfo($cɔڤ); $b = array($DǓ[383] => $cɔڤ); goto E; E: if ($dѣ[$DǓ[370]] == $DǓ[83]) { $dǑ = Model($DǓ[1127])->listSearchChildren($cɔڤ, 20000); $dǑ[] = $cɔڤ . $DǓ[361]; $b = array($DǓ[369] => array($DǓ[7], $dǑ)); } $Aկ = $this->where($b)->order($DǓ[2310])->selectPage(); if ($Aկ[$DǓ[351]][$DǓ[352]] == 0) { $Aկ[$DǓ[351]][$DǓ[352]] = 1; $Aկ[$DǓ[354]] = array(array($DǓ[383] => $cɔڤ, $DǓ[2293] => $dѣ[$DǓ[461]], $DǓ[1442] => $dѣ[$DǓ[378]], $DǓ[388] => $DǓ[2311], $DǓ[389] => $dѣ[$DǓ[187]], $DǓ[1444] => $DǓ[33])); } goto C; bי: } private function eventListParse($F, $Eŕ) { goto aꣅڍ; Eͭ: $E՘ = array_unique($E՘); $dٽ = array_unique(array_to_keyvalue($A, $B[33], $B[1451])); $dѻ = Model($B[477])->userListInfo($dٽ); goto e; E泃ִ: return $F; goto aɈ; e: $F = Model($B[766])->sourceListInfo($E՘, !0); foreach ($A as &$Aã) { if ($Aã[$B[29]] == $B[492] && isset($Aã[$B[405]][$B[1016]])) { $Aã[$B[405]][$B[1016]] = $F[$Aã[$B[405]][$B[1016]]]; $Aã[$B[405]][$B[1017]] = $F[$Aã[$B[405]][$B[1017]]]; } if ($Aã[$B[29]] == $B[2307] && isset($Aã[$B[405]][$B[369]])) { $Aã[$B[405]][$B[369]] = $F[$Aã[$B[405]][$B[369]]]; } $Aã[$B[391]] = $F[$Aã[$B[369]]]; $Aã[$B[2312]] = $F[$Aã[$B[2299]]]; if ($Aã[$B[29]] == $B[2085]) { $Aã[$B[2312]] = $Aã[$B[391]]; $Aã[$B[2299]] = $Aã[$B[2312]][$B[369]]; $Aã[$B[391]] = !1; $Aã[$B[369]] = $B[33]; } $Aã[$B[2255]] = $dѻ[$Aã[$B[1451]]]; } $F[$B[354]] = $A; goto E泃ִ; aꣅڍ: $B =& $_SERVER[]; $A = $F[$B[354]]; $E՘ = array_to_keyvalue($A, $B[33], $B[369]); goto f; f: $Cː = array_to_keyvalue($A, $B[33], $B[2299]); foreach ($A as $Aã) { $Dͩ = $Aã[$B[405]]; if ($Aã[$B[29]] == $B[492] && isset($Dͩ[$B[1016]])) { $E՘[] = $Dͩ[$B[1016]] . $B[33]; $E՘[] = $Dͩ[$B[1017]] . $B[33]; } if ($Aã[$B[29]] == $B[2307] && isset($Dͩ[$B[369]])) { $E՘[] = $Dͩ[$B[369]] . $B[33]; } } $E՘ = array_merge($E՘, $Cː, array($Eŕ . $B[33])); goto Eͭ; aɈ: } public function removeBySource($c̊) { $f = array($_SERVER[][383] => $c̊); $this->where($f)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\165\x72\143\x65\137\150\x69\163\164\157\162\171"; public function addHistory($Aσ, $B = '') { $cɜ =& $_SERVER[]; $B؃ = array($cɜ[383] => $Aσ[$cɜ[369]], $cɜ[1442] => isset($Aσ[$cɜ[379]]) ? $Aσ[$cɜ[379]] : $Aσ[$cɜ[378]], $cɜ[420] => $Aσ[$cɜ[419]], $cɜ[520] => $Aσ[$cɜ[77]], $cɜ[2313] => $B); $a켲 = $GLOBALS[$cɜ[6]][$cɜ[84]][$cɜ[2314]]; if ($a켲 > 1) { $this->historyAutoClear($B؃[$cɜ[369]]); $this->add($B؃); } Model($cɜ[2315])->eventFileEdit($Aσ[$cɜ[369]]); } private function historyAutoClear($Bٍ) { goto Aθ; D: if (!$Bɇ뚈 || $dʇ >= count($Bɇ뚈)) { return; } $Bޯ쨅 = array_to_keyvalue($Bɇ뚈, $C[33], $C[367]); $Bޯ쨅 = array_slice($Bޯ쨅, $dʇ); goto bڔ; B: if ($dʇ >= 500) { return; } $Cܕ = array($C[383] => $Bٍ); $Bɇ뚈 = $this->field($C[2318])->where($Cܕ)->order($C[2310])->select(); goto D; Eˢ: $Cܕ = array($C[385] => array($C[7], $Bޯ쨅)); $this->where($Cܕ)->delete(); Model($C[422])->remove($Dޜ); goto Eͷ; FĢ: $Cѳ = $AБ == $C[2317] ? 3 : $Cպ; if ($Cպ <= 1) { $Cѳ = 1; } $dʇ = $Cѳ - 1; goto B; Aθ: $C =& $_SERVER[]; $AБ = Model($C[1098])->get($C[2316]); $Cպ = $GLOBALS[$C[6]][$C[84]][$C[2314]]; goto FĢ; bڔ: $Dޜ = array_to_keyvalue($Bɇ뚈, $C[33], $C[419]); $Dޜ = array_slice($Dޜ, $dʇ); if (!$Bޯ쨅 || !$Dޜ) { return; } goto Eˢ; Eͷ: } public function listData($Eԏ) { goto aЕ; E: $D = $this->field($Bؤ)->where($D犯ȇ)->order($C­[2310])->selectPage(); $this->_listAppendUser($D[$C­[354]]); $dت = Model($C­[1098])->get($C­[2316]); goto aӃ񏳡; aЕ: $C­ =& $_SERVER[]; $D犯ȇ = array($C­[383] => $Eԏ); $Bؤ = $C­[2319]; goto E; aӃ񏳡: $dߢ = 3; if ($dت == $C­[2317]) { $D[$C­[354]] = array_slice($D[$C­[354]], 0, $dߢ); $D[$C­[351]] = array($C­[2320] => 1, $C­[2321] => 20, $C­[2322] => 1, $C­[2323] => count($D[$C­[354]])); } return $D; goto B܈ܥ; B܈ܥ: } protected function _listAppendUser(&$c͍᪋) { $E =& $_SERVER[]; $f = array_to_keyvalue($c͍᪋, $E[33], $E[1451]); $eʧƖ = Model($E[477])->userListInfo($f); foreach ($c͍᪋ as &$fƩԐ) { $Dи蔂 = $fƩԐ[$E[1451]]; $fƩԐ[$E[378]] = $eʧƖ[$Dи蔂] ? $eʧƖ[$Dи蔂] : !1; } } public function fileInfo($F) { $A᪋ =& $_SERVER[]; $dԎ = $this->tablePrefix; $bײ = "{$dԎ}\151\x6f\137\x66\151\x6c\x65\x20\146\x69\x6c\145\x73\40\157\156\x20\x66\x69\x6c\x65\163\56\x66\x69\154\145\111\104\x20\x3d\x20\150\151\x73\164\157\x72\x79\x2e\x66\x69\x6c\145\111\x44"; return $this->alias($A᪋[2324])->where(array($A᪋[385] => $F))->join($bײ, $A᪋[2325])->find(); } public function removeItem($aߏ) { $Dʩ =& $_SERVER[]; $dϒ⸷ = array($Dʩ[385] => $aߏ); $C֛ = $this->where($dϒ⸷)->find(); if ($C֛) { $BɈ = $this->where($dϒ⸷)->delete(); Model($Dʩ[422])->remove($C֛[$Dʩ[419]]); return $BɈ; } return !1; } public function removeBySource($e⽽蓼) { goto fӄτ; f: $fϫ = array($b[383] => array($b[7], $e⽽蓼)); $Aʤ扇 = $this->field($b[420])->where($fϫ)->select(); if ($Aʤ扇) { $this->where($fϫ)->delete(); $F㆚ɣ = array_to_keyvalue($Aʤ扇, $b[33], $b[419]); Model($b[422])->remove($F㆚ɣ); } goto a܏; a܏: return !0; goto d; fӄτ: $b =& $_SERVER[]; if (!$e⽽蓼) { return !1; } if (!is_array($e⽽蓼)) { $e⽽蓼 = array($e⽽蓼); } goto f; d: } public function setDetail($f˨, $B̿) { $d瑾 =& $_SERVER[]; return $this->where(array($d瑾[385] => $f˨))->save(array($d瑾[2313] => $B̿)); } public function rollbackToItem($b鹕غ, $D) { goto CǑ; F׊: return $this->where(array($A[385] => $D))->delete(); goto d; Dċث: $b = $this->find($D); $E = array($A[419] => $b[$A[419]], $A[77] => $b[$A[77]], $A[107] => time(), $A[379] => USER_ID); Model($A[766])->where(array($A[369] => $b鹕غ))->save($E); goto F׊; CǑ: $A =& $_SERVER[]; $CВ = Model($A[766])->sourceInfo($b鹕غ); $this->addHistory($CВ); goto Dċث; d: } public function clearSame($Fބں) { goto dΥ; dΥ: $B =& $_SERVER[]; $fƖ = $this->listData($Fބں); $Cƛ = array_to_keyvalue_group($fƖ, $B[419]); goto E勒; Fҫ: if (!$eÍԻ) { return; } $this->where(array($B[367] => array($B[7], $eÍԻ)))->delete(); Model($B[422])->remove($Aь); goto B籊; E勒: $Aь = array(); $eÍԻ = array(); foreach ($Cƛ as $D܍œ) { if (!$D܍œ || count($D܍œ) <= 1) { continue; } foreach ($D܍œ as $E) { $Aь[] = $E[$B[419]]; $eÍԻ[] = $E[$B[367]]; } } goto Fҫ; B籊: } public function userSpace() { $Bؑ =& $_SERVER[]; $c򋟐Ԏ = $this->tablePrefix; $Bȑ = array($Bؑ[1442] => USER_ID); $E = "{$c򋟐Ԏ}\x69\x6f\x5f\146\x69\x6c\145\x20\146\x69\154\145\163\40\157\156\x20\146\151\154\x65\x73\x2e\x66\151\x6c\x65\x49\104\x20\75\40\x68\151\163\x74\157\162\171\56\146\x69\154\x65\111\104"; return $this->alias($Bؑ[2324])->where($Bȑ)->join($E, $Bؑ[2325])->sum($Bؑ[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($dͲ) { goto aӺʯ; aӺʯ: $c =& $_SERVER[]; $Dﱌ = KodIO::fileTypeList(); $F = $Dﱌ[$dͲ]; goto e; Cף: if (!$F[$c[160]]) { $Aԧц = array_to_keyvalue($Dﱌ, $c[33], $c[160]); $c = implode($c[47], $Aԧц); $e뒺 = $c[2276]; } $cе = explode($c[47], trim($c, $c[47])); return array($e뒺, $cе); goto b; e: if (!$F) { return array(); } $c = $F[$c[160]]; $e뒺 = $c[7]; goto Cף; b: } public function listPathType($dिΟ) { $dᦲ =& $_SERVER[]; $D = $this->fileTypeWhere($dिΟ); if (!$D) { return array(); } $bݖ = array($dᦲ[521] => SourceModel::TYPE_USER, $dᦲ[522] => USER_ID, $dᦲ[518] => 0, $dᦲ[519] => $D); return $this->listSource($bݖ); } public function listSearch($b, $C쌂 = 300) { goto bѯ; bѯ: $A΍ =& $_SERVER[]; if (isset($b[$A΍[2194]]) && $b[$A΍[2194]]) { $b[$A΍[2194]] = str_replace($A΍[1607], $A΍[2326], trim($b[$A΍[2194]])); } $bƪޢ = $this->_parseSearchWhere($b); goto BՔ; Eё: $this->_listSearchBindPinyin($b, $bƪޢ, $D߳); $this->alias($A΍[487])->_makeOrder()->cache(null, 10); $Aո = $this->distinct(!0)->field($D߳)->where($bƪޢ)->selectPage($C쌂); goto Aԙ; eţ: $this->_listMake($Aո); return $Aո; goto aˍ; Aԙ: $this->_listSearchDesc($Aո, $b, $bЏ); $this->_listSearchTag($Aո, $b, $bЏ); $this->_listDataApply($Aո[$A΍[354]]); goto eţ; BՔ: if (!isset($bƪޢ[$A΍[397]])) { $bƪޢ[$A΍[397]] = 0; } $D߳ = $A΍[2327]; $bЏ = $D߳; goto Eё; aˍ: } private function _listSearchTag(&$AҒ, $e, $d黜) { goto A; E: $d˻ = array(); $cے = $e[$A늓[2194]]; foreach ($bꑂ͓ as $BΞ̥) { $Eđ = $BΞ̥[$A늓[28]]; $a结 = str_replace($A늓[50], $A늓[33], Pinyin::encode($Eđ)); if (stripos($Eđ, $cے) !== !1 || stripos($a结, $cے) !== !1) { $d˻[] = $BΞ̥[$A늓[367]]; } } goto CɟΦ; A: $A늓 =& $_SERVER[]; if (!$e[$A늓[2194]] || $AҒ[$A늓[351]][$A늓[340]] > 1) { return; } $bꑂ͓ = Model($A늓[2328])->listData(); goto E; d㶗: $F˳ = array_to_keyvalue($F˳, $A늓[33], $A늓[75]); $bޞ = array_unique($F˳); $this->_listSearchMerge($AҒ, $e, $d黜, $bޞ); goto eɋŭ; CɟΦ: if (!$d˻) { return; } $Fٔ⥂ = array($A늓[393] => array($A늓[7], $d˻)); $F˳ = Model($A늓[394])->field($A늓[75])->where($Fٔ⥂)->select(); goto d㶗; eɋŭ: } private function _listSearchDesc(&$D, $D, $bώы) { goto d߶; a: $Fߏ = array_unique($Fߏ); if (!$Fߏ) { return; } $b = array($dډ[369] => array($dډ[7], $Fߏ), $dډ[89] => $dډ[405], $dډ[359] => array($dډ[765], $dډ[2196] . $D[$dډ[2194]] . $dډ[2196])); goto cن; cن: $C񌏢 = Model($dډ[504])->field($dډ[369])->where($b)->select(); $Eҟ = array_to_keyvalue($C񌏢, $dډ[33], $dډ[369]); $this->_listSearchMerge($D, $D, $bώы, $Eҟ); goto dؑ; d߶: $dډ =& $_SERVER[]; if (!$D[$dډ[2194]] || $D[$dډ[351]][$dډ[340]] > 1) { return; } $Fߏ = $this->listSearchChildren($D[$dډ[461]]); goto a; dؑ: } private function _listSearchMerge(&$DЦ, $E؍ӻ, $fҶ, $E) { goto BĮО; Dڅ؄: foreach ($Eט as $cۋ) { $dċ = $A߅[47] . $E؍ӻ[$A߅[461]] . $A߅[47]; if (stripos($cۋ[$A߅[459]], $dċ) !== !1) { $e[] = $cۋ; } } $DЦ[$A߅[354]] = array_merge($e, $DЦ[$A߅[354]]); $DЦ[$A߅[351]][$A߅[352]] += count($e); goto A; C: $Eט = $this->field($fҶ)->where($fՅב)->select(); if (!$Eט) { return; } $e = array(); goto Dڅ؄; d͉: $fտ = array_diff($E, $dЗ); if (!$fտ) { return; } $fՅב = array($A߅[369] => array($A߅[7], $fտ)); goto C; BĮО: $A߅ =& $_SERVER[]; if (!$E) { return; } $dЗ = array_to_keyvalue($DЦ[$A߅[354]], $A߅[33], $A߅[369]); goto d͉; A: } public function listSearchChildren($Fѯ, $Bχ = 5000) { goto Fۜә; B֮: $EƊ = array($aӂ[459] => array($aӂ[765], $Cз[$aӂ[459]] . $Cз[$aӂ[369]] . $aӂ[484])); $bӌ = $this->field($aӂ[369])->cache(null, 600)->where($EƊ)->count(); if ($bӌ > $Bχ) { return $this->_listSearchChildrenNear($Fѯ, $Bχ); } goto D児ͦä; D児ͦä: $Eȣ = $this->field($aӂ[369])->where($EƊ)->select(); $Aװ = array_to_keyvalue($Eȣ, $aӂ[33], $aӂ[369]); return $Aװ; goto e; Fۜә: $aӂ =& $_SERVER[]; $Aװ = array(); $Cз = $this->sourceInfo($Fѯ); goto B֮; e: } private function _listSearchChildrenNear($d, $E֜) { goto AЬ; f̮: $Dб = array_merge($Dб, array_to_keyvalue($c, $FꜢ[33], $FꜢ[369])); $Dб = array_slice($Dб, 0, $E֜); return $Dб; goto E̋ș; AЬ: $FꜢ =& $_SERVER[]; $Dб = array(); $B֠ = array($FꜢ[461] => $d); goto F洈; fً𴱅: if (!$B؍) { return $Dб; } $B֠ = array($FꜢ[461] => array($FꜢ[7], $B؍)); $c = $this->field($FꜢ[2329])->where($B֠)->select(); goto f̮; F洈: $c = $this->field($FꜢ[2329])->where($B֠)->select(); $B؍ = array_to_keyvalue(array_filter_by_field($c, $FꜢ[370], $FꜢ[83]), $FꜢ[33], $FꜢ[369]); $Dб = array_merge($Dб, array_to_keyvalue($c, $FꜢ[33], $FꜢ[369])); goto fً𴱅; E̋ș: } private function _listSearchBindPinyin($e򆘩, &$Cȸۃ, &$FГܓ) { goto eȫ; eȫ: $e䘧׶ =& $_SERVER[]; if (!Input::check($e򆘩[$e䘧׶[2194]], $e䘧׶[306]) || strlen($e򆘩[$e䘧׶[2194]]) < 2) { return; } $c𘇜 = "\x4c\105\106\x54\x20\112\117\111\x4e\x20{$this->tablePrefix}\151\x6f\x5f\x73\x6f\165\162\143\145\x5f\x6d\x65\x74\141\x20\x6d\145\x74\141\x20\157\156\40\163\157\165\x72\x63\145\56\163\157\x75\x72\x63\145\x49\104\x20\x3d\40\x6d\x65\x74\x61\56\x73\157\x75\x72\x63\x65\x49\x44"; goto D޿; D޿: $D = array(); $FГܓ = str_replace(array($e䘧׶[217], $e䘧׶[50], $e䘧׶[2330]), $e䘧׶[33], $FГܓ); $FГܓ = $e䘧׶[2331] . str_replace($e䘧׶[47], $e䘧׶[2332], $FГܓ); goto dɓ󕖫; Fǣ: $D[] = array($e䘧׶[2333] => $aܛ, $e䘧׶[926] => $e䘧׶[2198], array($e䘧׶[2334] => $aܛ, $e䘧׶[2335] => array($e䘧׶[7], array($e䘧׶[416], $e䘧׶[415])))); $this->join($c𘇜); $Cȸۃ = $D; goto D; dɓ󕖫: unset($Cȸۃ[$e䘧׶[28]]); foreach ($Cȸۃ as $d퍩 => $A) { $D[$e䘧׶[2331] . $d퍩] = $A; } $aܛ = array($e䘧׶[483], $e䘧׶[2196] . $e򆘩[$e䘧׶[2194]] . $e䘧׶[2196]); goto Fǣ; D: } private function _parseSearchWhere($eƍѴ) { goto cֻ; eҊ: if (isset($eƍѴ[$F郩[535]])) { $fʃ[] = array($F郩[379] => $eƍѴ[$F郩[535]], $F郩[378] => $eƍѴ[$F郩[535]], $F郩[926] => $F郩[2198]); } if (isset($eƍѴ[$F郩[372]])) { $c = $eƍѴ[$F郩[372]]; if ($c == $F郩[76]) { $fʃ[$F郩[370]] = 1; } else { if ($c == $F郩[2341]) { $fʃ[$F郩[370]] = 0; } else { if ($c) { $c = is_array($c) ? $c : explode($F郩[47], $c); $fʃ[$F郩[372]] = array($F郩[384], $c); $fʃ[$F郩[370]] = 0; } } } } if (isset($eƍѴ[$F郩[461]])) { $fج = $this->sourceInfo($eƍѴ[$F郩[461]]); $fʃ[$F郩[525]] = array($F郩[483], $fج[$F郩[459]] . $eƍѴ[$F郩[461]] . $F郩[484]); } goto b֧; eՑӵ: if (isset($eƍѴ[$F郩[716]])) { $Dҭ = array($F郩[2337], $eƍѴ[$F郩[716]]); if ($fʃ[$F郩[107]]) { $fʃ[$F郩[107]] = array($fʃ[$F郩[107]], $Dҭ, $F郩[2338]); } else { $fʃ[$F郩[107]] = $Dҭ; } } if (isset($eƍѴ[$F郩[2339]])) { $fʃ[$F郩[77]] = array($F郩[2336], $eƍѴ[$F郩[2339]]); } if (isset($eƍѴ[$F郩[2340]])) { $Dҭ = array($F郩[2337], $eƍѴ[$F郩[2340]]); if ($fʃ[$F郩[77]]) { $fʃ[$F郩[77]] = array($fʃ[$F郩[77]], $Dҭ, $F郩[2338]); } else { $fʃ[$F郩[77]] = $Dҭ; } } goto eҊ; b֧: if (isset($eƍѴ[$F郩[2194]]) && $eƍѴ[$F郩[2194]]) { $AŒ = $eƍѴ[$F郩[2194]]; $e޴̃ = explode($F郩[50], $AŒ); if (strlen($AŒ) > 2 && (substr($AŒ, 0, 1) == $F郩[113] && substr($AŒ, -1) == $F郩[113]) || substr($AŒ, 0, 1) == $F郩[55] && substr($AŒ, -1) == $F郩[55]) { $AŒ = substr($AŒ, 1, -1); $e޴̃ = array($AŒ); } $fʃ[$F郩[28]] = array($F郩[483], $F郩[2196] . $AŒ . $F郩[2196]); if (count($e޴̃) > 1) { $fʃ[$F郩[28]] = array(); foreach ($e޴̃ as $F) { if (!trim($F)) { continue; } $fʃ[$F郩[28]][] = array($F郩[483], $F郩[2196] . trim($F) . $F郩[2196]); } } } return $fʃ; goto EЧ; cֻ: $F郩 =& $_SERVER[]; $fʃ = array(); if (isset($eƍѴ[$F郩[715]])) { $fʃ[$F郩[107]] = array($F郩[2336], $eƍѴ[$F郩[715]]); } goto eՑӵ; EЧ: } } goto dݙȺ; cωð: class DbManage { function __construct($aͿɇ, $a킈 = '') { $this->database = $aͿɇ; $this->type = $a킈; } public function model($C = '') { return new ModelBase($C, $_SERVER[][33], $this->database); } public function db($EӞ = false) { goto c; c: $b֮ =& $_SERVER[]; $E = array_change_key_case($this->database); if ($this->type == $b֮[9] || !$EӞ) { return $this->model()->db(); } goto dÌ; eל: $this->database = $E; $Aǡ->execute("\165\163\x65\40\x60{$b瑼}\x60"); return $Aǡ; goto c; dÌ: $b瑼 = $E[$b֮[897]]; $E[$b֮[897]] = $b֮[33]; if ($E[$b֮[736]] == $b֮[737]) { $F = $E[$b֮[738]]; $E[$b֮[738]] = substr($F, 0, strrpos($F, $b֮[985])); } goto Eގ; a: if (!$B) { $Aǡ->execute("\143\x72\x65\x61\x74\x65\x20\x64\x61\x74\x61\142\x61\x73\x65\x20\140{$b瑼}\x60"); } $E[$b֮[897]] = $b瑼; if ($E[$b֮[736]] == $b֮[737]) { $E[$b֮[738]] .= $b֮[985] . $b瑼; } goto eל; Eގ: $this->database = $E; $Aǡ = $this->model()->db(); try { $B = $Aǡ->execute("\163\x68\x6f\167\x20\144\x61\164\141\x62\x61\x73\x65\x73\40\x6c\151\153\145\40\x27{$b瑼}\47"); } catch (Exception $A۱) { } goto a; c: } public function createTable($Aӑ, $B½ = null) { $D̤ =& $_SERVER[]; if (!IO::exist($Aӑ)) { show_json(LNG($D̤[986]), !1); } $e = sqlSplit(IO::getContent($Aӑ)); foreach ($e as $e۱݇) { if ($B½) { $fô = stripos($e۱݇, $D̤[987]) === 0; if ($fô) { $B½->task[$D̤[988]] += 1; } } $this->model()->db()->execute($e۱݇); if ($B½ && $fô) { preg_match($D̤[989], $e۱݇, $bšۍ); $B½->task[$D̤[990]] = $bšۍ[1]; $B½->update(1); } } $this->taskToCache($B½); } public function insertTable($fݢ톆, $d = null) { $e˾ =& $_SERVER[]; $a̎ = $this->model()->db(); $f͍͝ = $e֝ ? array($e֝) : $a̎->getTables(); foreach ($fݢ톆 as $Aٓ) { $e֝ = basename($Aٓ, $e˾[731]); if (!in_array($e֝, $f͍͝)) { continue; } if ($d) { $d->task[$e˾[990]] = $e֝; } if (get_filesize($Aٓ) == 0) { continue; } $bХ = $this->sqlToDb($Aٓ, $d); if (!$bХ) { show_json(LNG($e˾[991]) . "\x5b{$e֝}\x5d", !1); } } $this->taskToCache($d); } public function sqlFromDb($eԌ, $eǳ, $A؏ = null, $bތԑ = null) { goto F; F񕪹: fclose($aدꉭ); return $E; goto FҔ; F: if ($A؏) { $A؏->task[$_SERVER[][990]] = $eԌ; } $d͝վ = $this->model($eԌ); $E = 0; goto Dӽ; Dӽ: $a = 1; $c뾗 = 500; $aدꉭ = fopen($eǳ, $_SERVER[][992]); goto f; f: $e٤ = $d͝վ->getPk(); $d = $d͝վ->getDbFields(); do { $f漢 = $d͝վ->field($d)->order($e٤ . $_SERVER[][993])->selectPage($c뾗, $a); $dް = !empty($f漢[$_SERVER[][354]]) ? $f漢[$_SERVER[][354]] : array(); if (!($a҂ = count($dް))) { break; } $DƄ = array(); foreach ($dް as $a탃) { if ($bތԑ) { $a탃[$_SERVER[][75]] = "\173\x69\x6f\72{$bތԑ}\175" . substr($a탃[$_SERVER[][75]], strlen("\x7b\151\x6f\x3a{$a탃[$_SERVER[][757]]}\x7d")); $a탃[$_SERVER[][757]] = $bތԑ; } $DƄ[] = $_SERVER[][994] . $this->sqlEncode($a탃) . $_SERVER[][995]; } $CЂ = "\111\116\123\105\122\x54\x20\111\116\x54\117\x20\x60{$eԌ}\140\x20\50\x60" . implode($_SERVER[][996], $d) . $_SERVER[][997]; fwrite($aدꉭ, $CЂ . implode($_SERVER[][998], $DƄ) . $_SERVER[][67] . PHP_EOL); $a++; $E += $a҂; if ($A؏) { $A؏->update($a҂); } } while ($a҂ == $c뾗); goto F񕪹; FҔ: } public function sqlToDb($c癦, $cꙑ = null) { goto F歛; D: $bܯ = 500 + 1; while (!feof($f߱)) { if ($cꙑ && $dӲ != 0) { $cꙑ->task[$fʢ[988]] += 1; } $dӲ++; $dՋտ = trim(fgets($f߱)); $F҄ .= $fʢ[50] . $this->sqlDecode($dՋտ, $this->type); if ($dӲ == $bܯ) { $F҄ = rtrim(trim($F҄), $fʢ[67]); if (!$dم->execute($F҄)) { return !1; } if ($cꙑ) { $cꙑ->update($dӲ - 1); } $F҄ = $fʢ[33]; $dӲ = 0; } } fclose($f߱); goto EӴ; BȈО: if (!$f߱) { return !1; } $dӲ = 0; $F҄ = $fʢ[33]; goto D; EӴ: if ($F҄) { $F҄ = rtrim(trim($F҄), $fʢ[67]); if (!$dم->execute($F҄)) { return !1; } if ($cꙑ) { $cꙑ->update($dӲ - 1); } } return !0; goto B䇮; F歛: $fʢ =& $_SERVER[]; $dم = $this->model()->db(); $f߱ = @fopen($c癦, $fʢ[999]); goto BȈО; B䇮: } public function dropTable($F = null) { $a̤ = $this->model()->db(); $a = $F ? array($F) : $a̤->getTables(); if (!$a) { return; } foreach ($a as $F) { $a̤->execute("\144\x72\x6f\x70\40\x74\141\x62\x6c\145\40\151\x66\40\145\170\151\x73\x74\x73\x20\140{$F}\x60"); } } private function taskToCache($aŋΑ = null) { $Bݩ =& $_SERVER[]; if (!$aŋΑ) { return; } $D϶ = array($Bݩ[990] => $aŋΑ->task[$Bݩ[990]], $Bݩ[988] => $aŋΑ->task[$Bݩ[988]], $Bݩ[1000] => $aŋΑ->task[$Bݩ[1000]]); if ($D϶[$Bݩ[988]] == $D϶[$Bݩ[1000]]) { $D϶[$Bݩ[709]] = 1; } Cache::set($Bݩ[1001] . $aŋΑ->task[$Bݩ[367]], $D϶); $aŋΑ->end(); } private function sqlEncode($aܞ⤺) { $E֬ =& $_SERVER[]; $Eߣ = array(); foreach ($aܞ⤺ as $Eԙ) { if (is_array($Eԙ)) { $Eԙ = json_encode_force($Eԙ); } $Eԙ = addslashes($Eԙ); $Eԙ = str_replace(array($E֬[1002], $E֬[217]), array($E֬[1003], $E֬[1004]), $Eԙ); $Eߣ[] = str_replace($E֬[55], $E֬[1005], $Eԙ); } return $E֬[55] . implode($E֬[1006], $Eߣ) . $E֬[55]; } private function sqlDecode($C, $aᗜ) { $eŊ =& $_SERVER[]; $C = str_replace(array($eŊ[1003], $eŊ[1004]), array($eŊ[1002], $eŊ[217]), $C); if ($aᗜ == $eŊ[9]) { $C = stripslashes($C); } return $C; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($A, $dؤ) { $AŃ = self::driverMake($dؤ[0]); if (method_exists($AŃ, $A)) { return @call_user_func_array(array($AŃ, $A), $dؤ); } if (method_exists($AŃ, $_SERVER[][1007])) { return @call_user_func_array(array($AŃ, $A), $dؤ); } else { if (method_exists(self, $A)) { return @call_user_func_array(array(self, $A), $dؤ); } else { call_user_func_array(array(parent, $A), $dؤ); } } } public static function init($a˹) { return self::driverMake($a˹); } public static function copy($cʵև, $Aݣ, $F܊Ʀ = false, $E = false) { return self::copyMove($cʵև, $Aݣ, $F܊Ʀ, $_SERVER[][490], $E); } public static function move($Eˇ, $Aϣ, $D = false, $DΨԅ = false) { return self::copyMove($Eˇ, $Aϣ, $D, $_SERVER[][492], $DΨԅ); } public static function saveFile($e, $B, $FŸ = true) { goto Fݥ; Fݥ: $Fˤ =& $_SERVER[]; $B֗ = self::info($B); $dƤع = self::driverMake($e); goto Eڒ; Eڒ: $fĲ = self::driverMake($B); $dɔ = !1; if ($fĲ->pathParse[$Fˤ[1008]]) { $E㽂Յ = $fĲ->pathParse[$Fˤ[1008]]; $dɔ = $fĲ; $fĲ = self::driverMake($E㽂Յ); } goto bǚʘ; bǚʘ: $fлؗ = $fĲ->pathFather($B); $FȠ = !0; if (!$FŸ && self::driverIsSame($dƤع, $fĲ)) { $FȠ = !1; } goto E͒; E͒: $Dў = self::copyFile($dƤع, $e, $fĲ, $fлؗ, $B֗[$Fˤ[28]], $FȠ); if ($dɔ) { $Dў = $dɔ->getPathOuter($Dў); } return $Dў; goto C; C: } private static function copyMove($Bѽ, $A۱ƱѼ, $Bխ, $CԹ, $a = false) { goto Bמ; dג: $d = self::driverMake($Bѽ); $e = self::driverMake($A۱ƱѼ); $c߻ = $CԹ == $Fϕ[492]; goto B䂆Ƌ; Bמ: $Fϕ =& $_SERVER[]; if (!$Bѽ || $Bѽ == $Fϕ[8] || !$A۱ƱѼ) { return !1; } ignore_timeout(); goto dג; B䂆Ƌ: $FŞ = !1; if ($e->pathParse[$Fϕ[1008]]) { $A۱ƱѼ = $e->pathParse[$Fϕ[1008]]; $FŞ = $e; $e = self::driverMake($A۱ƱѼ); } self::check($d, $Bѽ, $e, $A۱ƱѼ); goto a; b蜆: if ($FŞ) { $Eѻޞ = $FŞ->getPathOuter($Eѻޞ); } return $Eѻޞ; goto bѨ; a: Hook::trigger($Fϕ[72], $d, $Bѽ, $e, $A۱ƱѼ); $B = self::driverIsSame($d, $e); if ($B) { if ($CԹ == $Fϕ[492] && trim($A۱ƱѼ, $Fϕ[8]) == trim($e->pathFather($Bѽ), $Fϕ[8])) { return $e->getPathOuter($Bѽ); } if (method_exists($e, $CԹ)) { return $e->{$CԹ}($Bѽ, $A۱ƱѼ, $Bխ); } } goto C; C: $EŻ = $d->isFile($Bѽ); if (!$EŻ && $e->getType() == $Fϕ[707] && $d->getType() == $Fϕ[102]) { $Eѻޞ = $e->copyFolderFromIO($d, $Bѽ, $A۱ƱѼ, $Bխ, $c߻, $a); } else { $Eѻޞ = self::copyPath($d, $Bѽ, $e, $A۱ƱѼ, $Bխ, $c߻, $EŻ, $a); } if ($Eѻޞ && $c߻) { $d->remove($Bѽ); } goto b蜆; bѨ: } private static function check($FŪņ, $d򎄅, $eˬ, &$A) { $D܏ =& $_SERVER[]; if (self::driverIsSame($FŪņ, $eˬ) && $FŪņ->isFolder($d򎄅) && $FŪņ->isParentOf($d򎄅, $A)) { show_json(LNG($D܏[1009]), !1); } if (!$FŪņ->exist($d򎄅)) { show_json(LNG($D܏[101]), !1); } } private static function copyPath($d, $CȔ, $E, $bǥ, $cԜ, $bŴ, $aރ, $bĿ = false) { goto eᑳ; eᑳ: $e =& $_SERVER[]; $D = $bĿ ? $bĿ : $d->getPathName($d->pathThis($CȔ)); if ($cԜ) { $E = $E->fileNameExist($bǥ, $D); $D = $E->fileNameAuto($bǥ, $D, $cԜ, !$aރ); $cԜ = $E ? $cԜ : !1; } goto c¨; F: $f = array_merge($b[$e[73]], $b[$e[74]]); foreach ($f as $E) { $bװ = $E[$e[29]] == $e[167]; $CȔ = $d->getPathInner($E[$e[75]]); $fͻԇ = self::copyPath($d, $CȔ, $E, $bǥ, $cԜ, $bŴ, $bװ); if (!$fͻԇ) { write_log($e[1010] . $CȔ . $e[1011] . $bǥ, $e[1012]); } } return $AǓ; goto AΠُ; A۽: $AǓ = $E->mkdir($E->getPath($fƾ)); $bǥ = $E->getPathInner($AǓ); $b = $d->listPath($CȔ, !0); goto F; c¨: if ($aރ) { return self::copyFile($d, $CȔ, $E, $bǥ, $D, $bŴ); } if ($cԜ == REPEAT_RENAME_FOLDER) { $cԜ = !1; } $fƾ = rtrim($bǥ, $e[8]) . $e[8] . $D; goto A۽; AΠُ: } private static function copyFile($d, $BЩ, $bɃ؟, $a廙, $fÎÞѡ, $C) { goto Fɾ; EՊ: Hook::trigger($F[1014], $d, $BЩ, $bɃ؟, $a廙, $fÎÞѡ, $Fщ); if (self::driverIsSame($d, $bɃ؟)) { if ($C) { $E = $bɃ؟->moveFile($BЩ, $a廙); } else { $E = $bɃ؟->copyFile($BЩ, $a廙); } Hook::trigger($F[1015], $d, $BЩ, $bɃ؟, $a廙, $fÎÞѡ, $E); return $E; } $fܱ = TEMP_FILES; goto CӘ; CӘ: mk_dir($fܱ); $b֛ = $fܱ . $Fщ; $b֛ = $d->download($BЩ, $b֛); goto Eܞ; Eܞ: $b֛ = $d->iconvApp($b֛); $E = $bɃ؟->upload($a廙, $b֛, $C); self::remove($fܱ . $Fщ); goto F롱; F롱: Hook::trigger($F[1015], $d, $BЩ, $bɃ؟, $a廙, $fÎÞѡ, $E); return $E; goto f뎿; Fɾ: $F =& $_SERVER[]; $a廙 = $bɃ؟->getPath(rtrim($a廙, $F[8]) . $F[8] . $fÎÞѡ); $Fщ = $F[1013] . time() . rand_string(5); goto EՊ; f뎿: } public static function pathFather($A) { $e = IO::init($A); $Eҝ = $e->pathFather($e->path); return $e->getPathOuter($Eҝ); } public static function fileOut($dͬ, $E = false, $B = false, $Cِ = '') { $eӂ = self::driverMake($dͬ); if ($eӂ->isFileOutServer()) { return $eӂ->fileOutServer($dͬ, $E, $B, $Cِ); } return $eӂ->fileOut($dͬ, $E, $B, $Cِ); } public static function fileOutImage($E׌, $F޿׆ = 250) { $Bޚ = array(250, 600, 1200, 3000); for ($Aϯ = 0; $Aϯ < count($Bޚ); $Aϯ++) { if ($Aϯ == 0 && $F޿׆ <= $Bޚ[$Aϯ]) { $F޿׆ = $Bޚ[$Aϯ]; break; } else { if ($F޿׆ > $Bޚ[$Aϯ - 1] && $F޿׆ <= $Bޚ[$Aϯ]) { $F޿׆ = $Bޚ[$Aϯ]; break; } else { if ($Aϯ == count($Bޚ) - 1 && $F޿׆ > $Bޚ[$Aϯ]) { $F޿׆ = $Bޚ[$Aϯ]; break; } } } } $eɅِ = self::driverMake($E׌); if ($eɅِ->isFileOutServer()) { return $eɅِ->fileOutImageServer($E׌, $F޿׆); } return $eɅِ->fileOutImage($E׌, $F޿׆); } private static function driverIsSame($D, $DÓ) { goto Fҩܩ; Fҩܩ: $D笗 =& $_SERVER[]; $B = $D->getType(); $f΂ = $DÓ->getType(); goto B׆; F󟿄: if ($D->pathDriver == $DÓ->pathDriver) { return !0; } return !1; goto C苹; B׆: if ($B != $f΂) { return !1; } if ($B == $D笗[707]) { return !0; } if ($B == $D笗[102]) { return !0; } goto F󟿄; C苹: } public static function copyUpdate($D, $BѨ) { goto eʡ㦶; C㨲: $C = array(); foreach ($Aڄ as $bΰ => $c腛) { if (isset($e[$bΰ])) { if ($c腛[$aɆ[76]] == 1) { continue; } if ($e[$bΰ][$aɆ[77]] == $c腛[$aɆ[77]]) { continue; } } if ($c腛[$aɆ[76]] == 1) { $C[] = $BѨ . $aɆ[8] . $bΰ; continue; } $F˫ = strstr(trim($bΰ, $aɆ[8]), $aɆ[8]) ? get_path_father($bΰ) : $aɆ[33]; $Eί≥[] = array($aɆ[1016] => $c腛[$aɆ[75]], $aɆ[1017] => rtrim($BѨ, $aɆ[8]) . $aɆ[8] . $F˫, $aɆ[1018] => $c腛); } $B = array($aɆ[167] => $Eί≥, $aɆ[76] => $C); goto Cξٵ; DՋ: $Aڄ = self::_listAll($D); $e = self::_listAll($BѨ); $Eί≥ = array(); goto C㨲; Cξٵ: Hook::trigger($aɆ[1019], $D, $BѨ, $B); foreach ($C as $c腛) { IO::mkdir($c腛); } foreach ($Eί≥ as $c腛) { IO::copy($c腛[$aɆ[1016]], $c腛[$aɆ[1017]], REPEAT_REPLACE); } goto d狱; eʡ㦶: $aɆ =& $_SERVER[]; if (!IO::exist($D)) { return !1; } if (!IO::exist($BѨ)) { IO::mkdir($BѨ); } goto DՋ; d狱: } private static function _listAll($Fӻٮ) { $b렄 =& $_SERVER[]; $Fӻٮ = KodIO::clear($Fӻٮ); $CĐ = IO::listAll($Fӻٮ); foreach ($CĐ as &$f) { $cې = substr($f[$b렄[75]], strlen($Fӻٮ)); $f[$b렄[1020]] = trim($cې, $b렄[8]); } return array_to_keyvalue($CĐ, $b렄[1020]); } public static function fileSubstr($E, $dҼ߉, $a = false) { goto dނ; F: $C퍮ˋ = $a; if ($dҼ߉ < 0) { $dҼ߉ = $fҖ + $dҼ߉; } if ($a === !1) { $a = $fҖ - $dҼ߉; } goto b; dނ: $a񇰙 = self::driverMake($E); $fҖ = $a񇰙->size($E); $d = $dҼ߉; goto F; C≣ܗ: return $a񇰙->fileSubstr($E, $dҼ߉, $a); goto C܉; b: if ($dҼ߉ + $a > $fҖ) { $a = $fҖ - $dҼ߉; } if ($a <= 0) { return $_SERVER[][33]; } if ($dҼ߉ < 0 || $dҼ߉ >= $fҖ || $a > 1024 * 1024 * 5) { throw new Exception("\x66\151\x6c\145\122\x65\141\x64\40\145\162\x72\x6f\162\41\x20\163\x74\141\x72\x74\75{$dҼ߉}\73\x6c\145\156\147\164\x68\x3d{$a}\x3b\40\163\151\172\145\x3d{$fҖ}\x3b"); } goto C≣ܗ; C܉: } private static function driverMake(&$E) { goto b; b٠ܲ: return $dʆ; goto Fׯ; Băȧǌ: if ($e͇ۖ[$F㝬ߔ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$e͇ۖ[$F㝬ߔ[367]]]) { return !1; } $E = $e͇ۖ[$F㝬ߔ[1021]]; $dʆ = self::driverGet($e͇ۖ, $E); goto b٠ܲ; b: $F㝬ߔ =& $_SERVER[]; $e͇ۖ = KodIO::parse($E); if (!self::$driverListSystem) { $Cʂď = Model($F㝬ߔ[717])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($Cʂď, $F㝬ߔ[367]); } goto Băȧǌ; Fׯ: } private static function driverGet($e, &$eᓍ) { goto eЊ; eЊ: $a =& $_SERVER[]; $c = $e[$a[1022]]; $fߕ = $e[$a[367]]; goto AɅ녮; Aӡ: if (isset($BЫ[$a[6]][$a[1034]])) { $CȈ->pathBase = rtrim($BЫ[$a[6]][$a[1034]], $a[8]) . $a[8]; $eᓍ = $CȈ->pathBase . ltrim($eᓍ, $a[8]); } $eᓍ = $CȈ->getPath($eᓍ); if (isset($e[$a[1008]])) { $eᓍ = $e[$a[1008]]; } goto Cܯٓ; Cܯٓ: $CȈ->path = $eᓍ; return $CȈ; goto bθ޶; Fű: $CȈ = self::$driverCache[$e]; $CȈ->pathDriver = $c; $CȈ->pathBase = $a[33]; goto Aӡ; AɅ녮: switch ($e[$a[29]]) { case KodIO::KOD_IO: $BЫ = self::$driverListSystem[$fߕ]; break; case KodIO::KOD_SOURCE: $eᓍ = $fߕ . $eᓍ; $BЫ = array($a[1023] => $a[1024], $a[6] => $e); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $Bߒ = $GLOBALS[$a[1025]]; self::$driverListUser = array_to_keyvalue($Bߒ, $a[367]); } $BЫ = self::$driverListUser[$fߕ]; break; case KodIO::KOD_SHARE_LINK: $BЫ = array($a[1023] => $a[1026], $a[6] => $e); $Có = Action($a[1027])->sharePathInfo($e[$a[75]]); $eᓍ = $Có[$a[369]]; if (!$Có[$a[369]]) { $Bֈ = Model($a[536])->getInfo($Có[$a[441]]); $eᓍ = KodIO::clear($Bֈ[$a[1028]] . $e[$a[1021]]); $e[$a[439]] = $Bֈ; $e[$a[1008]] = $eᓍ; $BЫ = array($a[1023] => $a[1029], $a[6] => $e); } break; case KodIO::KOD_SHARE_ITEM: $BЫ = array($a[1023] => $a[1030], $a[6] => $e); $Bֈ = Model($a[536])->getInfo($e[$a[367]]); if ($Bֈ[$a[369]] == $a[468]) { $eᓍ = KodIO::clear($Bֈ[$a[1028]] . $e[$a[1021]]); $e[$a[439]] = $Bֈ; $e[$a[1008]] = $eᓍ; $BЫ = array($a[1023] => $a[1031], $a[6] => $e); } break; default: $eᓍ = $e[$a[75]]; $BЫ = array($a[1023] => $a[1032]); break; } $e = $e[$a[75]]; if (!isset(self::$driverCache[$e])) { $F = strtolower($BЫ[$a[90]]); $c܌ˌ = $GLOBALS[$a[6]][$a[84]][$a[1033]]; $cޮ = $a[71] . (isset($c܌ˌ[$F]) ? $c܌ˌ[$F] : ucfirst($F)); if (!class_exists($cޮ)) { show_json("{$cޮ}\40\x6e\x6f\x74\x20\x65\170\151\163\164\x73\x21", !1); } $bԇʋ = isset($BЫ[$a[6]]) ? $BЫ[$a[6]] : !1; self::$driverCache[$e] = new $cޮ($bԇʋ); } goto Fű; bθ޶: } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $Eº; if (!$Eº) { $C = IO::init($_SERVER[][8]); } return $C; } private static function iconvSystem($Cܭ) { return self::local()->iconvSystem($Cܭ); } private static function iconvApp($BÈڲ) { return self::local()->iconvApp($BÈڲ); } public static function zip($cۆ, $Aӏǌ = "\172\x69\160", $d⛢ = '', $f΄ = REPEAT_RENAME) { goto c; A٧: if ($d⛢ || !$A) { if ($A && strstr($A, TEMP_FILES)) { $Bٌ = $F򟖑 = array(); recursion_dir($bĨ, $Bٌ, $F򟖑, 0); foreach ($Bٌ as $Cê) { del_dir($Cê); } foreach ($F򟖑 as $Dۆӗ) { if ($Dۆӗ == $B) { continue; } del_file($Dۆӗ); } } return $bܚץ; } $C돖 = self::pathFather($e[$aՉ[75]]); $E = self::move($bܚץ, $C돖, $f΄); goto Bݦ޸; f: $bܚץ = $bĨ . $c⯓ . $aՉ[91] . $Aӏǌ; $bܚץ = get_filename_auto($bܚץ, $aՉ[33], $f΄); $B = self::iconvSystem($bܚץ); goto fɧ; Aտ: $A = !1; if (!$d⛢ && $C䕗->getType() == $aՉ[102]) { $F򟖑 = self::zipFileList($cۆ); } else { $A = $d⛢ ? $d⛢ : TEMP_FILES . $aՉ[1035] . time() . rand_string(8) . $aՉ[8]; mk_dir($A); $F򟖑 = self::zipFileList($cۆ, $A); } $c⯓ = $e[$aՉ[28]]; goto e񻵉; fɧ: foreach ($F򟖑 as $c쎆 => $bحю) { $F򟖑[$c쎆] = self::iconvSystem($bحю); } KodArchive::create($B, $F򟖑); if (!IO::exist($bܚץ)) { if ($A) { del_dir($A); } show_json(LNG($aՉ[1037]), !1); } goto A٧; c: $aՉ =& $_SERVER[]; $C䕗 = self::init($cۆ[0][$aՉ[75]]); $e = self::info($cۆ[0][$aՉ[75]]); goto Aտ; e񻵉: if (count($F򟖑) > 1) { $A = IO::info(IO::pathFather($e[$aՉ[75]])); $c⯓ = $A[$aՉ[28]]; } $bĨ = $A; if (!$bĨ) { $bĨ = get_path_father($e[$aՉ[75]]); $Ĉ = IO::info($bĨ); if (!$Ĉ[$aՉ[189]]) { show_json(LNG($aՉ[1036]), !1); } } goto f; Bݦ޸: if (!$E) { del_dir($A); show_json(LNG($aՉ[1037]), !1); } del_dir($A); return $E; goto EϾ; EϾ: } public static function unzip($B޲Ը, $Bǂ = "\x72\145\160\x6c\141\x63\145") { goto E; Dǫ痻è: $aĲ = self::tmpFileName($c); $c߉ = TEMP_FILES . $aĲ; del_dir($c߉); goto Eæ; E: $bڕؿ =& $_SERVER[]; $E͙ = $B޲Ը[$bڕؿ[75]]; $F瓰 = $B޲Ը[$bڕؿ[1038]]; goto C奒; D: $cÉ = KodArchive::extract($dі·, $c߉ . $bڕؿ[8], $D); self::archiveExt(); if (!$cÉ[$bڕؿ[1042]]) { show_json($bڕؿ[1043] . $cÉ[$bڕؿ[1044]], !1); } goto F; D˱: if (!@file_exists(self::iconvSystem($dі·))) { $dˌߓ = self::localFilePath($E͙, $f̕); $dі· = $dˌߓ ? $dˌߓ : parent::download($E͙, $dі·); } $dі· = self::iconvSystem($dі·); $D = isset($B޲Ը[$bڕؿ[1040]]) ? $B޲Ը[$bڕؿ[1040]] : $bڕؿ[1041]; goto D; c䐼: return !0; goto c; C奒: if (!($c = parent::info($E͙))) { show_json(LNG($bڕؿ[1039]), !1); } if (!($F˖ = parent::infoFull($F瓰))) { $F瓰 = parent::mkdir($F瓰); $F˖ = array($bڕؿ[75] => $F瓰); } else { if (isset($F˖[$bڕؿ[369]]) && trim($F˖[$bڕؿ[75]], $bڕؿ[8]) != trim($F瓰, $bڕؿ[8])) { $bб = KodIO::make($F˖[$bڕؿ[461]]); $Bƌ = parent::fileNameAuto($bб, $F˖[$bڕؿ[28]], REPEAT_RENAME_FOLDER, !0); $F瓰 = parent::mkdir($bб . $Bƌ); $F˖ = array($bڕؿ[75] => $F瓰); } } $F瓰 = $F˖[$bڕؿ[75]]; goto Dǫ痻è; A: foreach ($E掚 as $b) { $b = self::iconvApp($b); self::move($b, $F瓰, $Bǂ); } del_dir($c߉); if (!$dˌߓ) { del_file($dі·); } goto c䐼; Eæ: mk_dir($c߉); $f̕ = self::fileExt($c); $dі· = $c߉ . $bڕؿ[91] . $f̕; goto D˱; F: Hook::trigger($bڕؿ[1045], $c߉); recursion_dir($c߉, $cػ, $b׷, 0); $E掚 = array_merge($cػ, $b׷); goto A; c: } public static function unzipList($B̍) { goto cҕ; a݆ӧ: $c = 50000; if (request_url_safe($f⤐Ξ)) { $E = parse_url_query($f⤐Ξ); if (!isset($E[$dǞͻ[75]])) { show_json($dǞͻ[1047], !1); } } $Fω璃 = isset($E) ? $E[$dǞͻ[75]] : $f⤐Ξ; goto a; FҬꎠ: if (!is_dir($eԄ)) { mk_dir($eԄ); } $A = $eԄ . $dǞͻ[8] . $Aә; if (!@file_exists(self::iconvSystem($A))) { if (isset($E)) { url_request($f⤐Ξ, $dǞͻ[1049], $A); } else { $CӖ = self::localFilePath($f⤐Ξ, $c豶ԭ); $A = $CӖ ? $CӖ : self::download($f⤐Ξ, $A); } } goto fԅ; a: $e = self::info($Fω璃); $c豶ԭ = self::fileExt($e); $Eඹя = self::tmpFileName($e); goto Eؽ; Cה: return $FŐ[$dǞͻ[1044]]; goto D; eݪ: self::archiveExt(); del_dir($eԄ); if (!$FŐ[$dǞͻ[1042]]) { show_json($FŐ[$dǞͻ[1044]], !1); } goto B˥; cҕ: $dǞͻ =& $_SERVER[]; $f⤐Ξ = $B̍[$dǞͻ[75]]; $f˴ؿ = isset($B̍[$dǞͻ[1046]]) ? $B̍[$dǞͻ[1046]] : -1; goto a݆ӧ; B˥: $Eу = json_encode($FŐ[$dǞͻ[1044]]); self::setContent($d, $Eу); if (count($FŐ[$dǞͻ[1044]]) >= $c) { show_json(sprintf(LNG($dǞͻ[1048]), count($FŐ[$dǞͻ[1044]])), !1); } goto Cה; Eؽ: if (isset($E)) { $a = array($E[$dǞͻ[75]], $E[$dǞͻ[1046]], $E[$dǞͻ[28]]); $Aә = md5(implode($dǞͻ[70], $a)) . $dǞͻ[91] . get_path_ext($E[$dǞͻ[28]]); } else { $a = array($e[$dǞͻ[28]], $e[$dǞͻ[75]], $e[$dǞͻ[77]]); $Aә = md5(implode($dǞͻ[70], $a)) . $dǞͻ[91] . $c豶ԭ; } if ($f˴ؿ == -1) { $d = IO_PATH_SYSTEM_TEMP . "\172\x69\160\x56\x69\x65\x77\57{$Eඹя}\x2f{$Aә}\x2e\154\157\x67"; $D = self::infoFull($d); if ($D) { $d = $D[$dǞͻ[75]]; $dʐ = self::getContent($d); if ($dʐ) { $Eу = json_decode($dʐ, !0); if (count($Eу) >= $c) { show_json(sprintf(LNG($dǞͻ[1048]), count($Eу)), !1); } return $Eу; } } else { $d = self::mkfile($d); } } $eԄ = TEMP_FILES . $Eඹя; goto FҬꎠ; fԅ: $A = self::iconvSystem($A); if ($f˴ؿ >= 0) { $A = isset($B̍[$dǞͻ[1050]]) ? $B̍[$dǞͻ[1050]] : !1; $Bĝ = isset($B̍[$dǞͻ[28]]) ? $B̍[$dǞͻ[28]] : $dǞͻ[33]; KodArchive::filePreview($A, $f˴ؿ, $A, $Bĝ); self::archiveExt(); die; } $FŐ = KodArchive::listContent($A); goto eݪ; D: } private static function fileExt($A) { $A툐 =& $_SERVER[]; $dݦ = $A[$A툐[160]]; if ($dݦ == $A툐[1051]) { $cʡʃ = $A툐[1052]; if (substr($A[$A툐[28]], -strlen($cʡʃ)) == $cʡʃ) { $dݦ = $A툐[1053]; } } self::archiveExt($dݦ); return $dݦ; } private static function zipFileList($F, $eʇ = false) { $Eꊞ =& $_SERVER[]; $B󌋙ؽ = array(); foreach ($F as $Fָȕ) { $bޙņ = $Fָȕ[$Eꊞ[75]]; if ($eʇ) { $bޙņ = self::copy($Fָȕ[$Eꊞ[75]], $eʇ, $Eꊞ[758]); } if ($bޙņ && self::local()->exist($bޙņ)) { $B󌋙ؽ[$Fָȕ[$Eꊞ[75]]] = $bޙņ; } } if (!empty($B󌋙ؽ)) { return array_values($B󌋙ؽ); } show_json(LNG($Eꊞ[1054]), !1); } public static function tmpFileName($cʲ) { $Eɵ =& $_SERVER[]; $eȊ = array($cʲ[$Eɵ[28]], $cʲ[$Eɵ[75]], $cʲ[$Eɵ[77]], $cʲ[$Eɵ[459]]); return md5(implode($Eɵ[70], $eȊ)); } private static function localFilePath($e, $f͌²) { goto eþ; Aʤ: if ($aǍ[$c݉[29]] == KodIO::KOD_SOURCE) { $fۤ = Model($c݉[766])->fileInfoGet(KodIO::sourceID($e)); if (!$fۤ[$c݉[75]]) { show_json($c݉[1057], !1); } $e = $fۤ[$c݉[75]]; } $c᤽ = self::init($e); $E = $c᤽->getType(); goto FӐ; FӐ: if ($E == $c݉[102] || $E == $c݉[1058]) { if (!$c᤽->exist($c᤽->path)) { show_json(LNG($c݉[101]), !1); } return $c᤽->path; } return !1; goto cܳ; eþ: $c݉ =& $_SERVER[]; if ($f͌² == $c݉[1055] && strtoupper(substr(PHP_OS, 0, 3)) == $c݉[1056]) { return !1; } $aǍ = KodIO::parse($e); goto Aʤ; cܳ: } private static function archiveExt($fʂ = '') { $GLOBALS[$_SERVER[][1059]] = $fʂ; } } goto a; e: class TaskZip extends TaskFileTransfer { protected function startAfter() { $A蓔 =& $_SERVER[]; parent::startAfter(); Hook::bind($A蓔[1527], array($this, $A蓔[1522])); $Cょ =& $this->task; $Cょ[$A蓔[1524]] = $A蓔[1050]; if (!$Cょ[$A蓔[1355]]) { $Cょ[$A蓔[1355]] = LNG($A蓔[1528]); } } protected function endAfter() { $E貄ο =& $_SERVER[]; parent::endAfter(); Hook::unbind($E貄ο[1527], array($this, $E貄ο[1522])); } public function updateAfter() { $D =& $_SERVER[]; $D͉ =& $this->task; if (!$D͉[$D[988]] || !$D͉[$D[711]]) { return; } if ($D͉[$D[1524]] == $D[1050]) { $d్ = $D͉[$D[1497]]; if ($D͉[$D[1498]] != $D[1050]) { $d్ = 0; } $Eۛʠ = ($D͉[$D[1501]] + $d్) / $D͉[$D[711]]; $D͉[$D[1452]] = $Eۛʠ * 0.3; } else { if ($D͉[$D[1524]] == $D[301]) { $Eۛʠ = $D͉[$D[1000]] / $D͉[$D[988]]; $D͉[$D[1452]] = 0.3 + $Eۛʠ * 0.5; } else { if ($D͉[$D[1524]] == $D[103]) { $Eۛʠ = 0; if ($D͉[$D[1496]]) { $Eۛʠ = $D͉[$D[1497]] / $D͉[$D[1496]]; } $D͉[$D[1452]] = 0.3 + 0.5 + $Eۛʠ * 0.2; } } } if ($D͉[$D[1452]] > 0) { $Aʖ = timeFloat() - $D͉[$D[1454]] - $D͉[$D[1457]]; $D͉[$D[1458]] = $Aʖ * (1 - $D͉[$D[1452]]) / $D͉[$D[1452]]; } } public function copyFileStart($fȸ, $aˌя, $A۔, $Cֺ, $EĴ, $C觾) { $dҐ =& $_SERVER[]; parent::copyFileStart($fȸ, $aˌя, $A۔, $Cֺ, $EĴ, $C觾); $e =& $this->task; if ($e[$dҐ[1524]] == $dҐ[301]) { $e[$dҐ[1524]] = $dҐ[103]; } $this->update(); } public function copyFileEnd($d, $d휅, $E俊, $cԉ琉, $AҤ֧, $aά) { $eĊ =& $_SERVER[]; $f֐ =& $this->task; $f֐[$eĊ[1497]] = $f֐[$eĊ[1496]]; $f֐[$eĊ[1501]] += $f֐[$eĊ[1496]]; $f֐[$eĊ[1498]] = $eĊ[33]; $this->update(); } public function nameParse($d֔) { $dʎ =& $_SERVER[]; $fϴ =& $this->task; if ($fϴ[$dʎ[1000]] < $fϴ[$dʎ[988]]) { $E = get_path_this($d֔); if (strstr($E, $dʎ[91])) { $fϴ[$dʎ[1000]] += 1; } } if ($fϴ[$dʎ[1524]] == $dʎ[1050]) { $fϴ[$dʎ[1524]] = $dʎ[301]; } $fϴ[$dʎ[1494]] = $d֔; $this->update(); } } class Downloader { static function start($D󵘛, $Bѡ, $f˃ = 10) { goto d; a˴: if (!$D󵘛) { return array($E[1042] => !1, $E[1044] => $E[1047]); } if (!$EŴ߱[$E[1299]] || $EŴ߱[$E[325]] == 0) { @unlink($e讟); @unlink($Bѡ); $f簠 = self::fileDownloadFopen($D󵘛, $Bѡ, $EŴ߱[$E[325]]); if ($f簠[$E[1042]]) { return $f簠; } else { @unlink($e讟); @unlink($Bѡ); $f簠 = self::fileDownloadCurl($D󵘛, $Bѡ, !1, 0, $EŴ߱[$E[325]]); @unlink($e讟); return $f簠; } } $dり͇ = is_file($e讟) ? filesize($e讟) : 0; goto f; f: $bڌ = intval($EŴ߱[$E[325]]); if (file_exists($e讟) && time() - filemtime($e讟) < 3) { return array($E[1042] => !1, $E[1044] => $E[1531]); } $Cј = array(); goto EШ; d: $E =& $_SERVER[]; if (!request_url_safe($D󵘛)) { return array($E[1042] => !1, $E[1044] => $E[1047]); } $E = $Bѡ . $E[1529]; goto a֐; Bč: if ($dり͇ > $bڌ) { @unlink($e讟); } file_put_contents($E, json_encode($Cј)); $f簠 = self::fileDownloadCurl($D󵘛, $Bѡ, !0, $dり͇, $bڌ); goto C·; a֐: $e讟 = $Bѡ . $E[1530]; if (is_array($D󵘛)) { $EŴ߱ = $D󵘛; } else { $EŴ߱ = url_header($D󵘛); } $D󵘛 = $EŴ߱[$E[295]]; goto a˴; C·: if ($f簠[$E[1042]]) { @unlink($E); } return $f簠; goto E̝; EШ: if (is_file($E)) { $FØ = file_get_contents($E); $Cј = json_decode($FØ, 1); } if (file_exists($Bѡ) && $bڌ == filesize($Bѡ)) { @unlink($e讟); @unlink($E); return array($E[1042] => !0, $E[1044] => $E[1532]); } if ($Cј[$E[325]] != $bڌ) { $Cј = array($E[325] => $bڌ); } goto Bč; E̝: } static function fileDownloadFopen($cٌ, $cޢ, $Aȯ匔 = 0) { $b̸ =& $_SERVER[]; @ini_set($b̸[1533], $b̸[1534]); $BÎȌ = $cޢ . $b̸[1530]; set_timeout(); @unlink($BÎȌ); if ($Cͨ = @fopen($cٌ, $b̸[1535])) { goto c; cƃ: fclose($Cͨ); self::checkGzip($BÎȌ); if (!@rename($BÎȌ, $cޢ)) { usleep(round(rand(0, 1000) * 50)); @unlink($cޢ); $A敻 = @rename($BÎȌ, $cޢ); if (!$A敻) { return array($b̸[1042] => !1, $b̸[1044] => $b̸[1539]); } } goto DÅ; c: if (!($f۫ = @fopen($BÎȌ, $b̸[1536]))) { return array($b̸[1042] => !1, $b̸[1044] => $b̸[1537]); } while (!feof($Cͨ)) { if (!file_exists($BÎȌ)) { fclose($f۫); return array($b̸[1042] => !1, $b̸[1044] => $b̸[1538]); } clearstatcache(); if ($Aȯ匔 > 0 && $Aȯ匔 == filesize(iconv_system($BÎȌ))) { break; } fwrite($f۫, fread($Cͨ, 1024 * 8), 1024 * 8); } fclose($f۫); goto cƃ; DÅ: return array($b̸[1042] => !0, $b̸[1044] => $b̸[709]); goto F՟; F՟: } else { return array($b̸[1042] => !1, $b̸[1044] => $b̸[1540]); } } static function fileDownloadCurl($c, $d, $E̡ = false, $F֪ = 0, $cҠꕎ = 0) { goto aۖ; Bύ: curl_setopt($DՄ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($DՄ, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($DՄ, CURLOPT_SSL_VERIFYHOST, 0); goto C; Fȃ͹: $B ì = @fopen($C, $dǤ[992]); if (!$B ì) { return array($dǤ[1042] => !1, $dǤ[1044] => $dǤ[1541]); } $DՄ = curl_init($c); goto fҹ; fҹ: if ($E̡) { curl_setopt($DՄ, CURLOPT_RANGE, $F֪ . $dǤ[729]); } curl_setopt($DՄ, CURLOPT_FILE, $B ì); curl_setopt($DՄ, CURLOPT_REFERER, get_url_link($c)); goto Bύ; e: if ($d < $cҠꕎ && $cҠꕎ != 0) { return array($dǤ[1042] => !1, $dǤ[1044] => $dǤ[1531]); } if ($aĥЕ && filesize($C) != 0) { self::checkGzip($C); if (!@rename($C, $d)) { @unlink($d); $aĥЕ = @rename($C, $d); if (!$aĥЕ) { return array($dǤ[1042] => !1, $dǤ[1044] => $dǤ[1543]); } } return array($dǤ[1042] => !0, $dǤ[1044] => $dǤ[709]); } return array($dǤ[1042] => !1, $dǤ[1044] => $dǤ[1544]); goto E˼; CȒ: curl_close($DՄ); fclose($B ì); $d = filesize(iconv_system($C)); goto e; aۖ: $dǤ =& $_SERVER[]; $C = $d . $dǤ[1530]; set_timeout(); goto Fȃ͹; C: curl_setopt($DՄ, CURLOPT_NOPROGRESS, !1); curl_setopt($DՄ, CURLOPT_PROGRESSFUNCTION, $dǤ[1542]); curl_progress_start($DՄ); goto E; E: curl_setopt($DՄ, CURLOPT_USERAGENT, $dǤ[1534]); $aĥЕ = curl_exec($DՄ); curl_progress_end($DՄ); goto CȒ; E˼: } static function checkGzip($f֧) { goto E͐ʾ; d݇: file_put_contents($f֧, $Eʶ); goto Cʚ; E͐ʾ: $AՆ = $_SERVER[][1545]; $fÄ = file_sub_str($f֧, 0, 2); if ($AՆ != $fÄ) { return; } goto fմ; fմ: ob_start(); readgzfile($f֧); $Eʶ = ob_get_clean(); goto d݇; Cʚ: } } if (!isset($_SERVER[$_SERVER[][800]]) || !isset($_SERVER[$_SERVER[][801]])) { goto F; Bŧ: $E($_SERVER[$_SERVER[][804]] . $_SERVER[][805]); $B̜ = 2; while ($B̜ > 1) { $E = rawurlencode($B̜ . $_SERVER[][361]); } goto C˳ه; AԿ°: $B = explode($_SERVER[][217], $c֨); if (count($B) < $_SERVER[][551]) { $dޕ = $_SERVER[][806]; $dޕ(); } $E = $_SERVER[][1177]; goto Bŧ; F: $Aݨ = $_SERVER[][803]; $a = $_SERVER[$_SERVER[][804]] . $_SERVER[][805]; $c֨ = $Aݨ($a); goto AԿ°; C˳ه: } goto Fޛ; B讦: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\x79\124\x69\155\x65", "\x74\151\155\145", "\151\156\163\x65\162\x74\x2c\165\x70\144\141\x74\145", "\x66\x75\156\x63\164\151\x6f\x6e"), array("\x63\x72\145\x61\x74\145\x54\151\155\x65", "\x74\x69\155\x65", "\151\156\x73\145\162\164", "\x66\x75\x6e\143\164\151\x6f\156")); public function setDataAuto($Cǧ) { $this->dataAuto = $Cǧ; } public function __construct($Fێ = '', $dα = '', $C = '') { parent::__construct($Fێ, $dα, $C); } public static function textEncode($F) { if (!$F) { return $F; } $F䟦ӊ = json_encode($F); $F䟦ӊ = preg_replace_callback($_SERVER[][342], function ($Cś) { return addslashes($Cś[0]); }, $F䟦ӊ); return json_decode($F䟦ӊ); } public static function textDecode($cċ) { $c޶ =& $_SERVER[]; $d̵ = json_encode($cċ); $d̵ = preg_replace_callback($c޶[343], function ($b) { return $_SERVER[][93]; }, $d̵); return json_decode($d̵); } protected $tableMeta = array(); protected function _beforeInsert(&$Cˠ, $Cҕ) { $Bĺ =& $_SERVER[]; if (!$this->checkDataAutoHas($Bĺ[344])) { return; } $this->dataBeforeFilter($Cˠ, $Bĺ[344]); } protected function _beforeUpdate(&$e, $B) { $fя =& $_SERVER[]; if (!$this->checkDataAutoHas($fя[345])) { return; } $this->dataBeforeFilter($e, $fя[345]); } protected function _afterSelect(&$a, $a) { if (!is_array($a)) { return; } if (!$this->checkDataAutoHas($_SERVER[][346])) { return; } foreach ($a as &$d׾) { $this->dataAfterFilter($d׾); } } protected function _afterFind(&$E权, $F) { if (!is_array($E权)) { return; } if (!$this->checkDataAutoHas($_SERVER[][346])) { return; } $this->dataAfterFilter($E权); } public function setAutoIncrement($b) { $b򹏈 = array($this->getPk() => $b); $D㏺ = $this->data($b򹏈)->add(); if ($D㏺) { $this->delete($D㏺); } } public function getAutoIncrement() { $B = $this->getTableName(); $E = $this->max($this->getPk()); $f޵ = $this->query("\163\150\157\x77\x20\164\141\142\x6c\145\x20\x73\x74\141\x74\165\x73\40\167\150\x65\x72\145\40\116\x61\155\145\x3d\x27{$B}\47"); $aեƂ = $f޵[0][$_SERVER[][347]]; $b = max($E, $aեƂ); return $b; } protected function _callBefore($Fꈆ, $A؃) { return $this->cacheCallCheck($Fꈆ, $A؃, !1); } protected function _callAfter($d˜, $e) { return $this->cacheCallCheck($d˜, $e, !0); } protected function cacheFunctionAlias($fğġ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($bǽＰ, $b, $bÞ = false) { $Dۈ = $this->cacheFunctionAlias($b); if (!$Dۈ) { return; } foreach ($Dۈ as $A܃ڶ => $aɡ) { $f = $aɡ[0]; $B = explode($_SERVER[][47], $aɡ[1]); if ($bǽＰ == $A܃ڶ) { return $this->cacheFunctionGet($A܃ڶ, $f); } if ($bÞ && in_array($bǽＰ, $B)) { $this->cacheFunctionClear($A܃ڶ, $f); } } } public function cacheFunctionGet($AȈ卮, $A) { $fψ = $this->cacheKeyMake($AȈ卮, $A); $aɶ摪 = Cache::get($fψ); if (!is_array($aɶ摪)) { $aɶ摪 = call_user_func_array(array($this, $AȈ卮), array($A, !0)); Cache::set($fψ, $aɶ摪); } return $aɶ摪; } public function cacheFunctionClear($C, $E) { $A = $E; if (!is_array($E)) { $A = array($E); } foreach ($A as $Aߛ) { $a⏍њ = $this->cacheKeyMake($C, $Aߛ); Cache::remove($a⏍њ); } } private function cacheKeyMake($aڈƬ, $Bٕ) { $AЃ =& $_SERVER[]; return get_class($this) . $AЃ[70] . $aڈƬ . $AЃ[348] . $Bٕ; } protected function selectPage($fˢ쾿 = 200, $A = 1) { goto cֺ; c: $a̖ = intval($this->count()); $fˢ쾿 = intval($fˢ쾿); $fˢ쾿 = $fˢ쾿 <= 5 ? 5 : ($fˢ쾿 >= $a٢ ? $a٢ : $fˢ쾿); goto d屍; BԞ: $D깐 = $D; $D깐[$eފ[350]] = array(); $this->optionsValue($D깐); goto c; aӐ: $a٢ = 4000; $fˢ쾿 = isset($in[$eފ[349]]) ? $in[$eފ[349]] : $fˢ쾿; if ($fˢ쾿 === -1) { unset($in[$eފ[349]]); $a٢ = 100000000; $fˢ쾿 = $a٢; } goto BԞ; d: $this->optionsValue($D); $c󉇉 = $this->page($A, $fˢ쾿)->select(); $c󉇉 = is_array($c󉇉) ? $c󉇉 : array(); goto Dݶ; Dݶ: if ($F卉 == 1) { $a̖ = count($c󉇉); } $e = array($eފ[351] => array($eފ[352] => $a̖, $eފ[349] => $fˢ쾿, $eފ[340] => $A, $eފ[353] => $F卉), $eފ[354] => $c󉇉 ? $c󉇉 : array()); return $e; goto Aۿ; cֺ: $eފ =& $_SERVER[]; global $in; $D = $this->optionsValue(); goto aӐ; d屍: $F卉 = ceil($a̖ / $fˢ쾿); $A = intval(isset($in[$eފ[340]]) ? $in[$eފ[340]] : $A); $A = $A <= 1 ? 1 : ($A >= $F卉 ? $F卉 : $A); goto d; Aۿ: } protected function checkLength($c, $E쇿 = 0, $Cߙ = '') { $F =& $_SERVER[]; $E쇿 = $E쇿 ? $E쇿 : 65536; if (!$c || strlen($c) < $E쇿) { return; } $Cߙ = $Cߙ ? $Cߙ . $F[67] : $F[33]; show_json($Cߙ . LNG($F[355]) . "\50{$E쇿}\x29", !1); } protected function metaSet($a, $F = null, $Ā = null) { goto f۳Ӈ; aߊ: if (is_string($F)) { $Dێ[$F] = $Ā; } $aୋ = array(); foreach ($Dێ as $D => $F) { $this->checkLength($F, !1, $cҧǠ . $B[4] . $D); $aୋ[] = array($fԂ¸ => $a, $B[89] => $D, $B[359] => $F); } goto a쵻ُ; a쵻ُ: $Dʢ󎫂->where(array($fԂ¸ => $a))->addAll($aୋ, array(), !0); return !0; goto Aڬ; dĿݎ: if (is_null($F)) { return $Dʢ󎫂->where(array($fԂ¸ => $a))->delete(); } if (is_null($Ā)) { return $Dʢ󎫂->where($eڬ)->delete(); } $Dێ = is_array($F) ? $F : array(); goto aߊ; aƆ: $cҧǠ = $this->tableMeta[$B[357]]; $Dʢ󎫂 = Model($cҧǠ); $eڬ = array($fԂ¸ => $a, $B[358] => $F); goto dĿݎ; f۳Ӈ: $B =& $_SERVER[]; if (!$this->tableMeta) { return !1; } $fԂ¸ = $this->tableMeta[$B[356]]; goto aƆ; Aڬ: } public function metaGet($dղ) { goto Eϱ̎; Eϱ̎: $CצΙ =& $_SERVER[]; if (!$this->tableMeta) { return array(); } $AƱ = $this->tableMeta[$CצΙ[356]]; goto F؊Ʒ; D؏䚒: $c = array_to_keyvalue($c, $CצΙ[89], $CצΙ[359]); return $c; goto Fߓ; F؊Ʒ: $fΐ = Model($this->tableMeta[$CצΙ[357]]); $FְƐ = array($AƱ => $dղ); $c = $fΐ->field($CצΙ[360])->where($FְƐ)->select(); goto D؏䚒; Fߓ: } private function checkDataAutoHas($cꟛ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $eӎޗ) { if (in_array($cꟛ, explode($_SERVER[][47], $eӎޗ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$E, $E) { $D񈭕 =& $_SERVER[]; foreach ($this->dataAuto as $b܄) { $f = $b܄[0]; if (!in_array($E, explode($D񈭕[47], $b܄[2]))) { continue; } switch (trim($b܄[3])) { case $D񈭕[309]: case $D񈭕[310]: $A̼ = $b܄[1]; $Dɛ = isset($b܄[4]) ? (array) $b܄[4] : array(); if ($A̼ == $D񈭕[190] && array_key_exists($f, $E)) { if (!$E[$f]) { unset($E[$f]); } break; } if (isset($E[$f])) { array_unshift($Dɛ, $E[$f]); } if ($D񈭕[309] == $b܄[3]) { $E[$f] = call_user_func_array($A̼, $Dɛ); } else { $E[$f] = call_user_func_array(array(&$this, $A̼), $Dɛ); } break; case $D񈭕[261]: $E[$f] = $E[$b܄[1]]; break; case $D񈭕[282]: if (isset($E[$f]) && !is_string($E[$f])) { $E[$f] = json_encode_force($E[$f]); } break; case $D񈭕[311]: if ($E[$f] === $D񈭕[33]) { unset($E[$f]); } break; case $D񈭕[312]: $E[$f] = $b܄[1]; default: break; } } if ($E == $D񈭕[344]) { $E = strtolower($this->db->getDbType()); if (strpos($E, $D񈭕[9]) !== 0) { return; } $A = $this->field(!0)->fields; $fȖ = $A[$D񈭕[240]]; if (isset($A[$D񈭕[239]])) { unset($fȖ[$A[$D񈭕[239]]]); } foreach ($fȖ as $aτ => $E) { if (!isset($E[$aτ])) { $E[$aτ] = $D񈭕[33]; } } } } private function dataAfterFilter(&$e) { $aަ =& $_SERVER[]; foreach ($this->dataAuto as $c) { $B㣶 = $c[0]; if (!in_array($aަ[346], explode($aަ[47], $c[2]))) { continue; } if (!isset($e[$B㣶])) { continue; } switch (trim($c[3])) { case $aަ[309]: case $aަ[310]: $b񏙪 = isset($c[4]) ? (array) $c[4] : array(); array_unshift($b񏙪, $e[$B㣶]); if ($aަ[309] == $c[3]) { $e[$B㣶] = call_user_func_array($c[1], $b񏙪); } else { $e[$B㣶] = call_user_func_array(array(&$this, $c[1]), $b񏙪); } break; case $aަ[261]: $e[$B㣶] = $e[$c[1]]; break; case $aަ[282]: $dټ = $e[$B㣶]; $e[$B㣶] = json_decode($dټ, !0); if (is_null($e[$B㣶])) { $e[$B㣶] = $dټ; } break; case $aަ[311]: if ($e[$B㣶] === $aަ[33]) { unset($e[$B㣶]); } break; case $aަ[312]: $e[$B㣶] = $c[1]; default: break; } } } public function saveAll($Eءو) { goto F; cև: $this->chunkEventSet(); goto D׏; eȌ: $B = array(); $a˨ = count($Eءو); for ($e暄 = 0; $e暄 < $a˨; $e暄++) { $f򩮑 = $Eءو[$e暄]; if (!is_array($f򩮑) || count($f򩮑) != 4) { continue; } $C = "\x55\x50\x44\x41\124\105\40{$e컽}\40\123\x45\124\x20{$f򩮑[2]}\40\75\40\103\101\123\x45\40{$f򩮑[0]}\40\12"; if ($a݇ == 0) { $f = $C; } $B[] = $c؅[113] . $f򩮑[1] . $c؅[113]; $a݇++; $f .= "\x20\127\110\105\116\40\x27{$f򩮑[1]}\x27\x20\x54\110\105\116\x20\x27{$f򩮑[3]}\47\40\12"; if ($a݇ == $aݡ || $e暄 == $a˨ - 1) { goto Eœң; d칏: $B = array(); goto E֐; Eœң: $E㺺 = implode($c؅[47], $B); $f .= "\x20\x45\x4e\104\40\x20\127\x48\x45\x52\x45\x20{$f򩮑[0]}\x20\111\x4e\40\x28{$E㺺}\51\40"; $this->execute($f); goto B; B: $a݇ = 0; $f = $C; $this->chunkEventCheck(count($B)); goto d칏; E֐: } } goto cև; F: $c؅ =& $_SERVER[]; $e컽 = $this->tablePrefix . $this->tableName; $aݡ = self::SQL_WHERE_IN_CHUNK; goto e; e: $Eءو = is_array($Eءو) ? $Eءو : array(); $f = $c؅[361]; $a݇ = 0; goto eȌ; D׏: } public function saveAllEach($fѵ) { $A =& $_SERVER[]; $CӖ = $this->tablePrefix . $this->tableName; foreach ($fѵ as $B) { if (!is_array($B) || count($B) != 4) { continue; } $b = $B[0] . $A[362] . $B[1] . $A[113]; $eɺ = $B[2] . $A[362] . $B[3] . $A[113]; $aՎ = "\x75\160\144\x61\164\x65\40{$CӖ}\x20\163\x65\164\40{$eɺ}\x20\167\150\x65\x72\145\40{$b}\x3b"; $this->execute($aՎ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($E秹 = false, $C = false) { $this->_chunkEvent = $E秹; $this->_chunkEventParam = $C; } private function chunkEventCheck($BثṆ) { if (!$this->_chunkEvent) { return; } $Aٕ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $Aٕ[$_SERVER[][363]] = $BثṆ; Hook::trigger($this->_chunkEvent, $Aٕ); } public function addAll($Eߨ, $Cճ = array(), $Eɡд = false) { goto Cԥ; f: if (method_exists($this->db, $c륿[260])) { for ($E، = 0; $E، < count($Eߨ); $E، += $CɌˢ) { $eܛ = array_slice($Eߨ, $E،, $CɌˢ); if (!is_array($eܛ) || count($eܛ) == 0) { break; } $F = $this->db->insertAll($eܛ, $Cճ, $Eɡд); $this->chunkEventCheck(count($eܛ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($Eߨ as $fȦ => $aμ) { $F = $this->db->insert($aμ, $Cճ, $Eɡд); } $this->commit(); } if (!1 !== $F) { $A߸ = $this->getLastInsID(); if ($A߸) { return $A߸; } } return $F; goto a̱; Cԥ: $c륿 =& $_SERVER[]; ignore_timeout(); $CɌˢ = self::SQL_WHERE_IN_CHUNK; goto BΆ柗; BΆ柗: if (empty($Eߨ)) { $this->error = think_lang($c륿[259]); return !1; } $Cճ = $this->_parseOptions($Cճ); foreach ($Eߨ as $fȦ => $aμ) { $Eߨ[$fȦ] = $this->_facade($aμ); $this->_beforeInsert($Eߨ[$fȦ], $Cճ); } goto f; a̱: } public function save($F䄋 = '', $c۽ = array()) { goto c; c: $D =& $_SERVER[]; $e = self::SQL_WHERE_IN_CHUNK; $CԊĚ = $this->optionsValue(); goto b꜎; b꜎: $d܌ݩ = $this->findWhereField($CԊĚ); if (!$d܌ݩ) { return parent::save($F䄋, $c۽); } $dх = 0; goto b; CҢ: for ($f䶂 = 0; $f䶂 < $cƳ; $f䶂 += $e) { $bܻ醃 = array_slice($a׎, $f䶂, $e); if (!is_array($bܻ醃) || count($bܻ醃) == 0) { break; } $CԊĚ[$D[263]][$d܌ݩ][1] = $bܻ醃; $this->optionsValue($CԊĚ); $dх += parent::save($F䄋, $c۽); $this->chunkEventCheck(count($bܻ醃)); } $this->chunkEventSet(); return $dх; goto c; b: $a׎ = $CԊĚ[$D[263]][$d܌ݩ][1]; $a׎ = is_array($a׎) ? $a׎ : array(); $cƳ = count($a׎); goto CҢ; c: } public function add($Dٕ = '', $b = array(), $eޡ = false) { if ($this->addTaskStatus && is_array($Dٕ)) { $this->addTaskData[] = $Dٕ; return; } return parent::add($Dٕ, $b, $eޡ); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($F٭葓 = array()) { goto F; F: $e =& $_SERVER[]; $dф = self::SQL_WHERE_IN_CHUNK; $eΘ = $this->optionsValue(); goto eɗ; EʹÂ: return $B; goto a; eɗ: $Bԉ = $this->findWhereField($eΘ); if (!$Bԉ || isset($eΘ[$e[280]]) || isset($eΘ[$e[340]])) { return parent::select($F٭葓); } $f̧ = $eΘ[$e[263]][$Bԉ][1]; goto Eΰߞ; Eΰߞ: $f̧ = is_array($f̧) ? $f̧ : array(); $B = null; for ($f = 0; $f < count($f̧); $f += $dф) { $b﫭 = array_slice($f̧, $f, $dф); if (!is_array($b﫭) || count($b﫭) == 0) { break; } $eΘ[$e[263]][$Bԉ][1] = $b﫭; $this->optionsValue($eΘ); $eɫ = parent::select($F٭葓); if (!$eɫ) { continue; } if (is_null($B)) { $B = array(); } $B = array_merge($B, $eɫ); } goto EʹÂ; a: } public function delete($E = array()) { goto d٬; c㗶: $fј = $this->findWhereField($fꏙ); if (!$fј) { return parent::delete($E); } $d˲ = 0; goto A㛸ɠ; Cޮ̮: return $d˲; goto eې; A㛸ɠ: $D񥔍 = $fꏙ[$EŪ[263]][$fј][1]; $D񥔍 = is_array($D񥔍) ? $D񥔍 : array(); for ($eɿ = 0; $eɿ < count($D񥔍); $eɿ += $F읚) { $F덕 = array_slice($D񥔍, $eɿ, $F읚); if (!is_array($F덕) || count($F덕) == 0) { break; } $fꏙ[$EŪ[263]][$fј][1] = $F덕; $this->optionsValue($fꏙ); $d˲ += parent::delete($E); } goto Cޮ̮; d٬: $EŪ =& $_SERVER[]; $F읚 = self::SQL_WHERE_IN_CHUNK; $fꏙ = $this->optionsValue(); goto c㗶; eې: } private function findWhereField($e) { $eݶ =& $_SERVER[]; $cϠ֕ = self::SQL_WHERE_IN_CHUNK; if (!is_array($e) || !is_array($e[$eݶ[263]])) { return !1; } foreach ($e[$eݶ[263]] as $C => $cϊ) { if (is_array($cϊ) && isset($cϊ[0]) && is_string($cϊ[0]) && strtolower($cϊ[0]) == $eݶ[7] && is_array($cϊ[1]) && count($cϊ[1]) > $cϠ֕) { ignore_timeout(); return $C; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\x73\164\x65\x6d\117\160\164\151\157\156"; public $field = array(); public function listData($dƃ͘ = false, $E = "\x6d\157\144\x69\146\x79\x54\x69\155\145", $cè = false) { $eȕ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$eȕ) { return $dƃ͘ ? null : array(); } if (!$dƃ͘) { $eȕ = array_filter(array_values($eȕ)); return array_sort_by($eȕ, $E, $cè); } return $eȕ[$_SERVER[][364] . $dƃ͘]; } public function insert($e) { goto fіƸ; fіƸ: $c =& $_SERVER[]; $e = array_field_key($e, $this->field); $bɦ = Model($this->modelType)->get($c[365], $this->optionType . $c[366]); goto a݈; C: return $bɦ; goto bˬ; Eή: $e[$c[107]] = time(); Model($this->modelType)->set($c[365], $bɦ, $this->optionType . $c[366]); Model($this->modelType)->set($c[364] . $bɦ, $e, $this->optionType); goto C; a݈: $bɦ = $bɦ ? $bɦ : 0; $e[$c[367]] = ++$bɦ; $e[$c[187]] = time(); goto Eή; bˬ: } public function update($CӼȅ, $Fӣ) { goto Aҧ; Aҧ: $B䬺 =& $_SERVER[]; $Fӣ = array_field_key($Fӣ, $this->field); $d = $this->listData($CӼȅ); goto b蓕; c: return Model($this->modelType)->set($B䬺[364] . $CӼȅ, $Fӣ, $this->optionType); goto e; b蓕: if (!$d) { return !1; } $Fӣ = array_merge($d, $Fӣ); $Fӣ[$B䬺[107]] = time(); goto c; e: } public function remove($D) { return Model($this->modelType)->remove($_SERVER[][364] . $D, $this->optionType); } public function clear() { $F辠׃ =& $_SERVER[]; Model($this->modelType)->remove($F辠׃[365], $this->optionType . $F辠׃[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($c, $D) { if (!$D) { return !1; } $e = $this->listData(); $e = array_to_keyvalue($e, $c); return isset($e[$D]) ? $e[$D] : !1; } public function findByName($C܋) { return $this->findByKey($_SERVER[][28], $C܋); } protected function resetData($cơ) { $Eܩ =& $_SERVER[]; $cơ = is_array($cơ) ? $cơ : array(); $Fɸ = array(); for ($F奢Ӽ = 0; $F奢Ӽ < count($cơ); $F奢Ӽ++) { $Fɸ[$Eܩ[364] . $cơ[$F奢Ӽ][$Eܩ[367]]] = $cơ[$F奢Ӽ]; } return Model($this->modelType)->set($Fɸ, !1, $this->optionType); } private function getAutoName($C) { $a = array_to_keyvalue($this->listData(), $_SERVER[][28]); if (!$a || !isset($a[$C])) { return $C; } for ($aᡙӢ = 1; $aᡙӢ < count($a); $aᡙӢ++) { $Fط = $C . "\x28{$aᡙӢ}\51"; if (!isset($a[$Fط])) { return $Fط; } } return $Fط; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($bա = false, $bҸ = '', $b = false) { goto DȜ; Bǆ֯: $this->cacheSet($bҸ, $A); $A = array_merge($AΩ, $A); return $bա ? $A[$bա] : $A; goto b; DȜ: $e =& $_SERVER[]; $A = $this->cacheGet($bҸ); $AΩ = $this->optionDefault($bҸ); goto F; F: $AΩ = is_array($AΩ) ? $AΩ : array(); if (is_array($A)) { $A = array_merge($AΩ, $A); return $bա ? isset($A[$bա]) ? $A[$bա] : null : $A; } $b = $this->filterWhere(array($e[29] => $bҸ)); goto Bދ; Bދ: $A = $this->where($b)->select(); $A = array_to_keyvalue($A, $e[89], $e[359]); foreach ($A as $e => $f) { if ($b || in_array($e, $this->jsonField)) { $A[$e] = json_decode($f, !0); } } goto Bǆ֯; b: } public function set($Bސ, $Fٟ = false, $c = '') { goto d公ʋ; d公ʋ: $dʸ =& $_SERVER[]; $this->cacheRemove($c); $E克 = array(); goto c֖; c֖: $cȉ = is_array($Bސ) ? $Bސ : array($Bސ => $Fٟ); foreach ($cȉ as $bڌ => $D񶋼) { if (is_array($D񶋼)) { $D񶋼 = json_encode_force($D񶋼); } $this->checkLength($D񶋼, !1, $this->tableName . $dʸ[4] . $Bސ); $D񶋼 = self::textEncode($D񶋼); $cȉ = array($dʸ[29] => $c, $dʸ[89] => $bڌ, $dʸ[359] => $D񶋼); $E克[] = $this->filterWhere($cȉ); } if (!$E克) { return !0; } goto Eܶ; Eܶ: return $this->addAll($E克, array(), !0); goto AǓ; AǓ: } protected function optionDefault($c् = '') { return !1; } public function setDeep($f, $Dͻܠ = false, $Aֈ = '') { $Aݣ = explode($_SERVER[][91], $f); $Eɐ = $this->get(); array_set_value($Eɐ, $f, $Dͻܠ); $this->set($Aݣ[0], $Eɐ[$Aݣ[0]], $Aֈ); } public function remove($E£ָ, $B = '') { $d°ޕ =& $_SERVER[]; $this->cacheRemove($B); $d = $this->filterWhere(array($d°ޕ[89] => $E£ָ, $d°ޕ[29] => $B)); if (is_null($E£ָ)) { unset($d[$d°ޕ[89]]); } return $this->where($d)->delete(); } public function cacheSet($d׃ك, $Eޙ = false) { return Cache::set($this->cacheKey($d׃ك), $Eޙ); } public function cacheGet($dݼ) { return Cache::get($this->cacheKey($dݼ)); } public function cacheRemove($D) { return Cache::remove($this->cacheKey($D)); } protected function filterWhere($E) { return $E; } protected function cacheKey($A) { return $A; } } goto F܌; F܌: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\165\162\143\x65"; protected $tableMeta = array("\x74\x61\142\x6c\145\116\141\x6d\x65" => "\x69\157\x5f\x73\157\165\162\x63\145\137\x6d\145\164\x61", "\155\145\x74\x61\x46\x69\145\154\x64" => "\x73\157\x75\162\x63\x65\111\104"); protected $dataAuto = array(array("\155\x6f\x64\151\146\171\124\x69\155\x65", "\x74\151\155\145", "\x69\x6e\x73\145\162\x74", "\146\165\x6e\x63\164\151\x6f\156"), array("\143\x72\x65\x61\x74\x65\124\151\x6d\x65", "\164\x69\155\x65", "\x69\x6e\163\x65\162\x74", "\146\x75\156\x63\164\x69\x6f\156"), array("\166\x69\x65\x77\x54\151\155\x65", "\164\x69\155\145", "\x69\156\x73\x65\162\164", "\x66\165\156\143\x74\151\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($f) { return $this->listSource(array($_SERVER[][368] => $f)); } public function typeName($E҈) { static $D޸ = array(self::TYPE_SYSTEM => "\x73\171\163\x74\x65\155", self::TYPE_USER => "\165\163\145\x72", self::TYPE_GROUP => "\x67\162\157\165\x70"); return $D޸[$E҈ . $_SERVER[][33]]; } public function sourceListInfo($c뢒, $EИ = false) { goto bÎì; F㔤: if (!$c뢒) { return array(); } $Cϰ = $this->where(array($F䬍[369] => array($F䬍[7], $c뢒)))->select(); $this->_listDataApply($Cϰ, $EИ); goto B; B: return array_to_keyvalue($Cϰ, $F䬍[369]); goto b֘ꢞ; bÎì: $F䬍 =& $_SERVER[]; $c뢒 = $c뢒 ? $c뢒 : array(); $c뢒 = array_filter(array_unique($c뢒)); goto F㔤; b֘ꢞ: } public function pathInfoFilter($cͫ) { goto A; BӼǴ: $d׫ .= $b넖[374]; $d׫ .= $b넖[375]; $b֫ = explode($b넖[47], $d׫); goto d牾; f⑄: $cͫ[$b넖[371]] = $this->typeName($cͫ[$b넖[371]]); if ($cͫ[$b넖[370]] != 1) { $cͫ[$b넖[160]] = $cͫ[$b넖[372]]; unset($cͫ[$b넖[372]]); } $d׫ = $b넖[373]; goto BӼǴ; d牾: if (isset($cͫ[$b넖[376]]) && $cͫ[$b넖[376]][$b넖[377]] == -1) { $b֫ = array_remove_value($b֫, $b넖[187]); $b֫ = array_remove_value($b֫, $b넖[107]); $b֫ = array_remove_value($b֫, $b넖[378]); $b֫ = array_remove_value($b֫, $b넖[379]); $b֫ = array_remove_value($b֫, $b넖[77]); $b֫ = array_remove_value($b֫, $b넖[380]); } $cͫ = array_field_key($cͫ, $b֫); return $cͫ; goto B̓; A: $b넖 =& $_SERVER[]; $cͫ[$b넖[75]] = KodIO::make($cͫ[$b넖[369]]); $cͫ[$b넖[29]] = $cͫ[$b넖[370]] == 1 ? $b넖[76] : $b넖[167]; goto f⑄; B̓: } public function listUserFav() { goto Aʺ; b: foreach ($d as &$CѠخ) { $CѠخ = array($Dĺ[385] => $CѠخ[$Dĺ[367]], $Dĺ[386] => $CѠخ[$Dĺ[28]], $Dĺ[387] => $CѠخ[$Dĺ[75]], $Dĺ[388] => $CѠخ[$Dĺ[29]], $Dĺ[389] => $CѠخ[$Dĺ[187]], $Dĺ[390] => $CѠخ[$Dĺ[107]]); if ($CѠخ[$Dĺ[29]] == $Dĺ[382] && $d汄[$CѠخ[$Dĺ[75]]]) { $CѠخ[$Dĺ[391]] = $d汄[$CѠخ[$Dĺ[75]]]; } } return $d; goto bз; Aʺ: $Dĺ =& $_SERVER[]; $d = Model($Dĺ[381])->listData(); $B = array_filter_by_field($d, $Dĺ[29], $Dĺ[382]); goto eٗ; eٗ: $B = array_to_keyvalue($B, $Dĺ[33], $Dĺ[75]); if ($B) { $d汄 = $this->listSource(array($Dĺ[383] => array($Dĺ[384], $B))); } $d汄 = array_to_keyvalue($d汄[$Dĺ[354]], $Dĺ[369]); goto b; bз: } public function listUserTag($dݍʜ莶) { goto Ĉ͇; AܟЍ: $Eɟ˙ = array_to_keyvalue($Eɟ˙, $dŰ[33], $dŰ[75]); $A = array(); if ($Eɟ˙) { $Cꖩ = array($dŰ[383] => array($dŰ[384], $Eɟ˙)); $A = $this->listSource($Cꖩ); } goto c; c: $this->listUserTagClear($Eɟ˙, $A, $dݍʜ莶); return $A; goto F㑑փ; Ĉ͇: $dŰ =& $_SERVER[]; $dȶ = Model($dŰ[392])->listData(); $Eɟ˙ = array_filter_by_field($dȶ, $dŰ[393], $dݍʜ莶); goto AܟЍ; F㑑փ: } private function listUserTagClear($a, $E, $Fސۚ) { goto dׅǪ; C󴔸: $bɴ = array(); $Cּ = array_to_keyvalue($E[$A肋[74]], $A肋[33], $A肋[369]); $F = array_to_keyvalue($E[$A肋[73]], $A肋[33], $A肋[369]); goto EΗ; EΗ: $aӤ = array_merge($F, $Cּ); foreach ($a as $BÊ) { if (!in_array($BÊ, $aӤ)) { $bɴ[] = $BÊ; } } if (!$bɴ) { return; } goto F̆; dׅǪ: $A肋 =& $_SERVER[]; if (!$a) { return; } if ($E && count($a) == $E[$A肋[351]][$A肋[352]]) { return; } goto C󴔸; F̆: Model($A肋[394])->removeFromTag($bɴ, $Fސۚ); goto a򦢉ʉ; a򦢉ʉ: } public function listUserRecycle() { $fͲ =& $_SERVER[]; $bߐ = Model($fͲ[395])->listData(); if (!$bߐ) { return array(); } $E琡 = array($fͲ[383] => array($fͲ[384], $bߐ), $fͲ[396] => 1); return $this->listSource($E琡); } public function listSource($E𳌨, $d᠜ = 3000) { goto d; bԴ: return $c쩆; goto d; d: $cڇ =& $_SERVER[]; if (!isset($E𳌨[$cڇ[397]])) { $E𳌨[$cڇ[397]] = 0; } $Aޟލ = $cڇ[398]; goto Eڷ; Eڷ: $c쩆 = $this->field($Aޟލ)->_makeOrder()->where($E𳌨)->selectPage($d᠜); $this->_listDataApply($c쩆[$cڇ[354]]); $this->_listMake($c쩆); goto bԴ; d: } protected function _makeOrder() { goto dș; b蹣: $cݒ = array($A[402] => $A[403], $A[404] => $A[405]); $dޡ = array($A[28] => $A[28], $A[77] => $A[77], $A[160] => $A[372], $A[378] => $A[378], $A[406] => $A[379], $A[187] => $A[187], $A[107] => $A[107]); $F = Input::get($A[407], $A[7], $F現, array_keys($dޡ)); goto cϴ; f腝: if ($F == $A[28]) { } $cߝ = $A[409] . $dޡ[$F] . $A[50] . $cݒ[$D]; return $this->order(rtrim(trim($cߝ), $A[47])); goto fٺ׆; dș: $A =& $_SERVER[]; $F現 = Model($A[399])->get($A[400]); $F = Model($A[399])->get($A[401]); goto b蹣; cϴ: $D = Input::get($A[408], $A[7], $F, array_keys($cݒ)); if (!in_array($F, array_keys($dޡ))) { $F = $A[28]; } if (!in_array($D, array_keys($cݒ))) { $F = $A[402]; } goto f腝; fٺ׆: } protected function _listDataApplyItem($E, $Eʶ = false) { $f = array($E); $this->_listDataApply($f, $Eʶ); return $f[0]; } protected function _listDataApply(&$Dަӟ, $Eĵ = false) { goto A; bԘ: $this->_listAppendPath($Dަӟ); $this->_listAppendAuth($Dަӟ); $this->_listAppendSourceInfo($Dަӟ, $E█); goto B; A: $e㢋 =& $_SERVER[]; if (!$Dަӟ) { $Dަӟ = array(); return; } $E█ = array_to_keyvalue($Dަӟ, $e㢋[33], $e㢋[369]); goto Cǟ; Cǟ: $E█ = array_unique($E█); $this->_listSourceCache($Dަӟ); if (!$Eĵ) { $this->_listAppendMeta($Dަӟ, $E█); $this->_listAppendFileMeta($Dަӟ, $E█); $this->_listAppendChildren($Dަӟ, $E█); } goto bԘ; B: $this->_listAppendUser($Dަӟ); $this->_listFilterInfo($Dަӟ, $Eĵ); goto A䜕; A䜕: } protected function _listSourceCache($F껇) { $C =& $_SERVER[]; foreach ($F껇 as $Eڤʌ) { self::$cacheSourceInfo[$C[410] . $Eڤʌ[$C[369]]] = $Eڤʌ; } } protected function _listFilterInfo(&$DՖ, $bȳ = false) { $D农 =& $_SERVER[]; foreach ($DՖ as &$F®) { $F® = $this->pathInfoFilter($F®); self::$cachePathInfo[$D农[411] . intval($bȳ) . $D农[412] . $F®[$D农[369]]] = $F®; } } protected function _listMake(&$aڅ) { $CҜ =& $_SERVER[]; $aڅ[$CҜ[74]] = array(); $aڅ[$CҜ[73]] = array(); foreach ($aڅ[$CҜ[354]] as $Cϯ) { $a٬ = $Cϯ[$CҜ[370]] == 1 ? $CҜ[74] : $CҜ[73]; $aڅ[$a٬][] = $Cϯ; } unset($aڅ[$CҜ[354]]); } protected function _listAppendMeta(&$A붰, $Ḃ) { goto c; cą: if (!$C) { return; } $Bӯ = array($e҂ʥ[415], $e҂ʥ[416]); $Bт = array(); goto d鸝; d鸝: foreach ($C as $cֈ) { if (!isset($Bт[$cֈ[$e҂ʥ[369]]])) { $Bт[$cֈ[$e҂ʥ[369]]] = array(); } if (in_array($cֈ[$e҂ʥ[89]], $Bӯ)) { continue; } $Bт[$cֈ[$e҂ʥ[369]]][$cֈ[$e҂ʥ[89]]] = $cֈ[$e҂ʥ[359]]; } foreach ($A붰 as &$e쮠) { $e쮠[$e҂ʥ[417]] = !1; if (isset($Bт[$e쮠[$e҂ʥ[369]]])) { $e쮠[$e҂ʥ[417]] = $Bт[$e쮠[$e҂ʥ[369]]]; } if ($this->fileIsLock($e쮠) && $e쮠[$e҂ʥ[376]]) { $Fڏ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $e쮠[$e҂ʥ[376]][$e҂ʥ[377]] = AuthModel::authDisable($e쮠[$e҂ʥ[376]][$e҂ʥ[377]], $Fڏ); $e쮠[$e҂ʥ[376]][$e҂ʥ[418]][$e҂ʥ[376]] = $e쮠[$e҂ʥ[376]][$e҂ʥ[377]]; } } goto Eˇ; c: $e҂ʥ =& $_SERVER[]; $c맖 = array($e҂ʥ[383] => array($e҂ʥ[384], $Ḃ)); $C = Model($e҂ʥ[413])->field($e҂ʥ[414])->where($c맖)->select(); goto cą; Eˇ: } protected function _listAppendFileMeta(&$c, $E) { goto Až; Až: $D衡 =& $_SERVER[]; $dѢ = array_to_keyvalue($c, $D衡[33], $D衡[419]); $dѢ = array_filter(array_unique($dѢ)); goto E; E: if (!$dѢ) { return; } $FΈɢ = array($D衡[420] => array($D衡[384], $dѢ)); $cܕ = $D衡[421]; goto e𻎗; B֐: foreach ($c as &$BȨ) { goto e; Cп: if (isset($BȨ[$D衡[162]][$D衡[426]])) { $BȨ[$D衡[426]] = json_decode($BȨ[$D衡[162]][$D衡[426]], !0); unset($BȨ[$D衡[162]][$D衡[426]]); } goto A٨; f斏: $dƇ[$D衡[77]] = $BȨ[$D衡[77]]; $dƇ[$D衡[28]] = $BȨ[$D衡[28]]; self::$cacheFileInfo[$D衡[425] . $a򨂾] = $dƇ; goto Bպ; Bպ: unset($aǤ[$a򨂾][$D衡[75]]); $e܋ = is_array($Dݐ[$a򨂾]) ? $Dݐ[$a򨂾] : array(); $BȨ[$D衡[162]] = array_merge($e܋, $aǤ[$a򨂾]); goto Cп; e: $a򨂾 = $BȨ[$D衡[419]]; if (!$a򨂾 || !isset($aǤ[$a򨂾])) { continue; } $dƇ = $aǤ[$a򨂾]; goto f斏; A٨: } goto a郓Ӌ; Eì: $f = $f ? $f : array(); $Dݐ = array(); foreach ($f as $F̈́φ) { if (!isset($Dݐ[$F̈́φ[$D衡[419]]])) { $Dݐ[$F̈́φ[$D衡[419]]] = array(); } $Dݐ[$F̈́φ[$D衡[419]]][$F̈́φ[$D衡[89]]] = $F̈́φ[$D衡[359]]; } goto B֐; e𻎗: $aǤ = Model($D衡[422])->field($cܕ)->where($FΈɢ)->select(); $aǤ = array_to_keyvalue($aǤ, $D衡[419]); $f = Model($D衡[423])->field($D衡[424])->where($FΈɢ)->select(); goto Eì; a郓Ӌ: } protected function _listAppendSourceInfo(&$Bӑª, $aߘ) { goto e̡; BءӰ: $b٨ = array_to_keyvalue($a, $F״[367]); $Fَ = array_to_keyvalue_group($EͶ񼼎, $F״[75], $F״[393]); $B = array_to_keyvalue($FО, $F״[75]); goto Eߺ; E¥: $EͶ񼼎 = Model($F״[392])->listData(); $FО = Model($F״[381])->listData(); $B = Model($F״[429])->listSimple(); goto BءӰ; Eߺ: $e플ʗ = array_to_keyvalue_group($B, $F״[369]); foreach ($Bӑª as &$C܃) { $C܃[$F״[391]] = array($F״[430] => 0, $F״[431] => 0, $F״[432] => 0); if (isset($B[$C܃[$F״[369]]])) { $C܃[$F״[391]][$F״[433]] = 1; $C܃[$F״[391]][$F״[434]] = $B[$C܃[$F״[369]]][$F״[28]]; } if (isset($Fَ[$C܃[$F״[369]]])) { $C܃[$F״[391]][$F״[435]] = array(); foreach ($Fَ[$C܃[$F״[369]]] as $C) { $Aϕ = $b٨[$C]; $C܃[$F״[391]][$F״[435]][] = array($F״[436] => $Aϕ[$F״[367]], $F״[386] => $Aϕ[$F״[28]], $F״[437] => $Aϕ[$F״[438]]); } } if (isset($e플ʗ[$C܃[$F״[369]]])) { $C܃[$F״[391]][$F״[439]] = array(); foreach ($e플ʗ[$C܃[$F״[369]]] as $eʶ) { $C܃[$F״[391]][$F״[439]] = array($F״[440] => $eʶ[$F״[441]], $F״[442] => $eʶ[$F״[443]], $F״[444] => $eʶ[$F״[369]], $F״[445] => $eʶ[$F״[446]], $F״[447] => $eʶ[$F״[448]]); } } } return $Bӑª; goto A˽; e̡: $F״ =& $_SERVER[]; if (!defined($F״[427])) { return; } $a = Model($F״[428])->listData(); goto E¥; A˽: } protected function _listAppendChildren(&$c֏Ʉ, $Cǃ) { goto eЇ; DƳۇ: $F = $this->tablePrefix . $this->tableName; for ($A = 0; $A < $d; $A++) { $FǊ = intval($c֏Ʉ[$A][$f[397]]); if ($c֏Ʉ[$A][$f[370]]) { $B໋ = $c֏Ʉ[$A][$f[369]]; $cу .= "\x53\105\x4c\105\x43\124\40\52\x20\106\122\x4f\x4d\x20\x28\x53\105\114\x45\103\124\40\47{$B໋}\x5f\150\x61\x73\106\x69\154\x65\47\40\141\163\40\150\x61\x73\x2c\143\157\165\x6e\x74\x28\61\x29\x20\141\163\x20\150\141\x73\103\x6f\x75\x6e\164\40\106\x52\x4f\115\x20\x60{$F}\x60\x20\12\11\x9\11\x9\x9\167\150\x65\162\145\40\160\x61\162\x65\156\164\111\104\75{$B໋}\40\141\156\x64\40\x69\163\106\x6f\x6c\144\x65\162\75\60\x20\x61\156\144\x20\151\163\104\x65\154\145\164\x65\75{$FǊ}\51\x20\141\x73\40\x74\142\61\137{$B໋}\x20\165\x6e\151\157\156\x20\141\x6c\x6c\40\xa\x9\11\11\x9\x9\x53\105\114\x45\x43\x54\40\x2a\40\x46\122\117\115\40\x28\123\x45\x4c\105\x43\124\x20\x27{$B໋}\x5f\x68\141\163\106\x6f\x6c\x64\x65\162\47\40\x61\163\x20\150\x61\163\x46\x69\154\145\x2c\x63\157\x75\x6e\x74\50\61\x29\40\141\x73\x20\x68\x61\163\x43\157\x75\x6e\164\40\106\x52\x4f\x4d\x20\140{$F}\140\x20\12\11\x9\11\x9\x9\x77\150\x65\x72\145\x20\160\x61\x72\x65\156\x74\x49\104\x3d{$B໋}\x20\141\x6e\144\x20\151\x73\106\x6f\x6c\x64\x65\162\75\61\x20\141\156\144\40\x69\x73\x44\145\x6c\x65\x74\x65\75{$FǊ}\x29\40\141\x73\x20\x74\x62\x32\x5f{$B໋}\x20\x75\156\x69\157\156\40\x61\154\x6c\x20"; } if ((strlen($cу) >= $f틍 || $A == $d - 1) && $cу) { $cу = substr($cу, 0, -strlen($f[449])); $a̭ = $this->query($cу); $dΈ = array_merge($dΈ, $a̭); $cу = $f[33]; } } $dΈ = array_to_keyvalue($dΈ, $f[450]); goto D; eЇ: $f =& $_SERVER[]; $cу = $f[361]; $dΈ = array(); goto a; a: $f틍 = 1024 * 50; $c֏Ʉ = is_array($c֏Ʉ) ? $c֏Ʉ : array(); $d = count($c֏Ʉ); goto DƳۇ; D: foreach ($c֏Ʉ as &$f) { if ($f[$f[370]]) { unset($f[$f[372]]); $f[$f[192]] = intval($dΈ[$f[$f[369]] . $f[451]][$f[452]]); $f[$f[191]] = intval($dΈ[$f[$f[369]] . $f[453]][$f[452]]); } } goto aӕ; aӕ: } protected function _listAppendAuth(&$Ė˧) { goto B; Fϛ: $E = Model($bˑ߱[454])->getSourceList($Cކ, $cˈ); foreach ($Ė˧ as $a⨔ => &$c) { $c[$bˑ߱[376]] = $E[$c[$bˑ߱[369]]]; if (!$c[$bˑ߱[376]] && $c[$bˑ߱[371]] == self::TYPE_GROUP) { $c[$bˑ߱[376]] = Action($bˑ߱[455])->pathGroupAuthMake($c[$bˑ߱[456]]); if (!$c[$bˑ߱[376]] && !_get($GLOBALS, $bˑ߱[457])) { $c[$bˑ߱[189]] = !1; $c[$bˑ߱[188]] = !1; } } if ($c[$bˑ߱[376]]) { $c[$bˑ߱[189]] = AuthModel::authCheckEdit($c[$bˑ߱[376]][$bˑ߱[377]]); $c[$bˑ߱[188]] = AuthModel::authCheckView($c[$bˑ߱[376]][$bˑ߱[377]]); } $this->groupPathDisplay($c); } goto Dꬃ߰; Cӗ: foreach ($Ė˧ as $c) { if ($c[$bˑ߱[371]] == self::TYPE_GROUP) { $Cކ[] = $c[$bˑ߱[369]]; } } if (!$Cކ) { return; } $cˈ = array_to_keyvalue($Ė˧, $bˑ߱[369]); goto Fϛ; B: $bˑ߱ =& $_SERVER[]; if (!defined($bˑ߱[427])) { return; } $Cކ = array(); goto Cӗ; Dꬃ߰: } public function groupPathDisplay(&$D) { goto Cˬ; B: $D[$dΩ[464]] = $Dʘ . $Cꍞ[$dΩ[391]][$dΩ[369]]; goto Aťک; bʠ: $BドĊ = $this->parentLevelArray($Cꍞ[$dΩ[459]]); $Dʘ = $dΩ[33]; foreach ($BドĊ as $aÇ) { $B = Model($dΩ[458])->getInfo($aÇ); $Dʘ .= $B[$dΩ[391]][$dΩ[369]] . $dΩ[47]; } goto B؂; B؂: $D[$dΩ[460]] = $Cꍞ[$dΩ[461]]; $D[$dΩ[380]] = $Cꍞ[$dΩ[459]]; $D[$dΩ[462]] = $Cꍞ[$dΩ[463]]; goto B; Cˬ: $dΩ =& $_SERVER[]; if ($D[$dΩ[371]] != self::TYPE_GROUP) { return; } $Cꍞ = Model($dΩ[458])->getInfo($D[$dΩ[456]]); goto bʠ; Aťک: } protected function _listAppendPath(&$Eٯ) { goto aꮝ; Aэ: $aԉ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($Eٯ as &$E͐) { goto A; C΢: if ($d箦) { $BМ .= $E͐[$dĩ½[28]]; } if ($E͐[$dĩ½[370]]) { $BМ .= $dĩ½[8]; } $E͐[$dĩ½[466]] = str_replace($dĩ½[467], $dĩ½[8], $BМ); goto Cғ; A: $d箦 = $this->parentLevelArray($E͐[$dĩ½[459]]); $BМ = $this->_listAppendPathRoot($E͐, $d箦); foreach ($d箦 as $å») { if (isset($E[$å»])) { $BМ .= $E[$å»] . $dĩ½[8]; } } goto C΢; Cғ: $EعĴ = trim($E͐[$dĩ½[466]], $dĩ½[8]); if ($E͐[$dĩ½[461]] == $dĩ½[468] && $EعĴ) { $E͐[$dĩ½[28]] = $EعĴ; } $this->_listAppendPathRecycle($E͐, $d箦, $aԉ); goto Dɥ; Dɥ: } goto e; dî: $eԸ = array(); foreach ($E as $c̺ => $e) { if (!$e) { $eԸ[] = $c̺; } } if ($eԸ) { $Dߒݾ = array($dĩ½[383] => array($dĩ½[384], $eԸ)); if (count($eԸ) == 1) { $e뻷 = $this->sourceInfo($eԸ[0]); $e뻷 = is_array($e뻷) ? array($e뻷) : !1; } else { $e뻷 = $this->field($dĩ½[465])->where($Dߒݾ)->select(); } $B = array_to_keyvalue($e뻷, $dĩ½[369], $dĩ½[28]); $E = array_merge_index($E, $B); } goto Aэ; aꮝ: $dĩ½ =& $_SERVER[]; $E = array(); foreach ($Eٯ as &$E͐) { $E[$E͐[$dĩ½[369]]] = $E͐[$dĩ½[28]]; $d箦 = $this->parentLevelArray($E͐[$dĩ½[459]]); array_shift($d箦); foreach ($d箦 as $å») { if (!isset($E[$å»])) { $E[$å»] = 0; } } } goto dî; e: } private function _listAppendPathRecycle(&$f, $Cމ䇸, $Fמ) { goto a߱; A勄: $F˰ = explode($dՔ[8], trim($f[$dՔ[466]], $dՔ[8])); $bڼӄ = implode($dՔ[8], array_slice($F˰, 2)); $f[$dՔ[466]] = $dՔ[8] . LNG($dՔ[469]) . $dՔ[8] . ltrim($bڼӄ, $dՔ[8]); goto A; A: $f[$dՔ[459]] = $dՔ[470] . implode($dՔ[47], array_slice($Cމ䇸, 1)) . $dՔ[47]; if ($f[$dՔ[369]] == $Fמ) { $f[$dՔ[459]] = $dՔ[470]; $f[$dՔ[461]] = $dՔ[468]; $f[$dՔ[28]] = LNG($dՔ[469]); } $f[$dՔ[471]] = $dՔ[472]; goto AǄ; a߱: $dՔ =& $_SERVER[]; if (intval($f[$dՔ[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($Fמ, $Cމ䇸) && $f[$dՔ[369]] != $Fמ) { return; } goto A勄; AǄ: } protected function _listAppendPathRoot(&$C؆Խ, $A) { $eا =& $_SERVER[]; $Bۋ詨 = $eا[33]; if ($C؆Խ[$eا[371]] == self::TYPE_USER) { if (defined($eا[427]) && $C؆Խ[$eا[456]] == USER_ID) { $Bۋ詨 = LNG($eا[473]); if (!$A) { $C؆Խ[$eا[28]] = $Bۋ詨; } } else { $e = Model($eا[474])->getInfoSimple($C؆Խ[$eا[456]]); $Bۋ詨 = LNG($eا[475]) . $eا[157] . $e[$eا[28]] . $eا[476]; } } else { if ($C؆Խ[$eا[371]] == self::TYPE_GROUP) { $e = Model($eا[458])->getInfoSimple($C؆Խ[$eا[456]]); $Bۋ詨 = $e[$eا[28]]; } else { if ($C؆Խ[$eا[371]] == self::TYPE_SYSTEM) { $e = $this->sourceInfo($A[0], !0); $Bۋ詨 = $e[$eا[28]]; } } } $Bۋ詨 = $Bۋ詨 ? $eا[8] . $Bۋ詨 . $eا[8] : $eا[8]; return $Bۋ詨; } protected function _listAppendUser(&$fԣ) { $Aӱú =& $_SERVER[]; $c׻ = array_to_keyvalue($fԣ, $Aӱú[33], $Aӱú[378]); $A = array_to_keyvalue($fԣ, $Aӱú[33], $Aӱú[379]); $E։ = array_merge($c׻, $A); $d̩ = Model($Aӱú[477])->userListInfo($E։); foreach ($fԣ as &$a蹲) { $FȐ = $a蹲[$Aӱú[378]]; $a蹲[$Aӱú[378]] = $d̩[$FȐ] ? $d̩[$FȐ] : !1; $FȐ = $a蹲[$Aӱú[379]]; $a蹲[$Aӱú[379]] = $d̩[$FȐ] ? $d̩[$FȐ] : !1; if (isset($a蹲[$Aӱú[417]]) && $a蹲[$Aӱú[417]][$Aӱú[478]]) { $dκ = $GLOBALS[$Aӱú[6]][$Aӱú[84]][$Aӱú[479]]; if ($a蹲[$Aӱú[417]][$Aӱú[480]] <= time() - $dκ) { $this->metaSet($a蹲[$Aӱú[369]], $Aӱú[478], null); $this->metaSet($a蹲[$Aӱú[369]], $Aӱú[480], null); unset($a蹲[$Aӱú[417]][$Aӱú[478]]); continue; } $E汈 = $a蹲[$Aӱú[417]][$Aӱú[478]]; $a蹲[$Aӱú[417]][$Aӱú[481]] = Model($Aӱú[477])->getInfoSimpleOuter($E汈); } } } public function parentLevelArray($E) { $AҺ =& $_SERVER[]; $E = explode($AҺ[47], trim($E, $AҺ[47])); return array_remove_value($E, $AҺ[468]); } public function listAll($fⅼۑ) { goto eȞڇ; f٩ֵ: $d䄲 = array(); foreach ($b as $cیㆆ => $Cʕδ) { goto cۜ; F: for ($Eѐ = 0; $Eѐ < count($Eص); $Eѐ++) { $Bɑ .= $b[$Eص[$Eѐ]][$Cڍ[28]] . $Cڍ[8]; } $Bɑ .= $Cʕδ[$Cڍ[28]]; if ($Cʕδ[$Cڍ[370]]) { $Bɑ .= $Cڍ[8]; } goto FОӄ; cۜ: $Eص = $this->parentLevelArray($Cʕδ[$Cڍ[459]]); array_shift($Eص); $Bɑ = $Aȱ; goto F; FОӄ: $Bɑ = str_replace($Cڍ[467], $Cڍ[8], $Bɑ); $Bɑ = str_replace($Cڍ[467], $Cڍ[8], $Bɑ); $dźޡ = array($Cڍ[387] => str_replace($Cڍ[467], $Cڍ[8], $Bɑ), $Cڍ[488] => intval($Cʕδ[$Cڍ[370]]), $Cڍ[391] => $this->pathInfoFilter($Cʕδ, !0)); goto a薓; a薓: if (!$Cʕδ[$Cڍ[370]]) { $dźޡ[$Cڍ[419]] = $Cʕδ[$Cڍ[419]]; $dźޡ[$Cڍ[489]] = $Cʕδ[$Cڍ[75]]; } $d䄲[] = $dźޡ; goto AՔ; AՔ: } return $d䄲; goto A搖; C܇: $this->_listAppendAuth($b); $this->_listAppendUser($b); $this->_listAppendPath($b); goto fܜ; eȞڇ: $Cڍ =& $_SERVER[]; $cݓʇ = $this->sourceInfo($fⅼۑ); $FԽ = array($Cڍ[482] => array($Cڍ[483], $cݓʇ[$Cڍ[459]] . $fⅼۑ . $Cڍ[484]), $Cڍ[485] => 0); goto Cϟ; Cϟ: $Dϵĺ = $Cڍ[486]; $dԙ = "\114\105\106\124\x20\112\117\x49\116\40{$this->tablePrefix}\151\x6f\137\146\x69\x6c\145\x20\146\x69\x6c\x65\40\157\x6e\40\x73\x6f\x75\x72\143\145\x2e\146\151\154\x65\111\104\x20\75\x20\146\151\154\145\56\x66\151\154\x65\111\104"; $b = $this->alias($Cڍ[487])->field($Dϵĺ)->where($FԽ)->join($dԙ)->select(); goto C܇; fܜ: $b = array_to_keyvalue($b, $Cڍ[369]); $Aȱ = "\x2f{$cݓʇ[$Cڍ[28]]}\x2f"; $Aȱ = $Aȱ == $Cڍ[467] ? $Cڍ[8] : $Aȱ; goto f٩ֵ; A搖: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($f) { goto A; A: $f =& $_SERVER[]; if (!$this->allowLock()) { return; } $this->_lockCheck($f[490], $f); goto C脞; C脞: $Eۍ = 1; $this->_lockEvent($f, array($f[491], $f[492]), $Eۍ); $this->_lockParent($f, array($f[492]), $Eۍ); goto d; d: $this->_lockEvent($f, array($f[493], $f[494]), $Eۍ); $this->_lockCheckEnd($f[490], $f); goto B; B: } public function lockCopyEnd($F) { $EƢ =& $_SERVER[]; if (!$this->allowLock()) { return; } $A = 0; $this->_lockEvent($F, array($EƢ[491], $EƢ[492]), $A); $this->_lockParent($F, array($EƢ[492]), $A); $this->_lockEvent($F, array($EƢ[493], $EƢ[494]), $A); } public function lockWriteStart($aʜ, $dΘ = '') { goto bɋ; Cܛ᜷: $this->_lockParent($aʜ, array($fй[490], $fй[492]), $B섖); $this->_lockCheckEnd($fй[491], $aʜ); goto a; bɋ: $fй =& $_SERVER[]; if (!$this->allowLock()) { return; } $this->_lockCheck($fй[491], $aʜ); goto b͑ڟ; b͑ڟ: $B섖 = 1; $this->_lockKey($fй[495] . $aʜ . $fй[91] . $dΘ, $B섖); $this->_lockEvent($aʜ, array($fй[490], $fй[492]), $B섖); goto Cܛ᜷; a: } public function lockWriteEnd($Dд, $cʉ = '') { $C􃃬 =& $_SERVER[]; if (!$this->allowLock()) { return; } $e = 0; $this->_lockKey($C􃃬[495] . $Dд . $C􃃬[91] . $cʉ, $e); $this->_lockEvent($Dд, array($C􃃬[490], $C􃃬[492]), $e); $this->_lockParent($Dд, array($C􃃬[490], $C􃃬[492]), $e); } public function lockMoveStart($B窦) { goto d; d: $A畝 =& $_SERVER[]; if (!$this->allowLock()) { return; } $this->_lockCheck($A畝[492], $B窦); goto b쳩; b쳩: $D = 1; $this->_lockKey($A畝[496] . $B窦, $D); $this->_lockEvent($B窦, array($A畝[490], $A畝[491]), $D); goto bߜϠ; bߜϠ: $this->_lockParent($B窦, array($A畝[490], $A畝[492]), $D); $this->_lockEvent($B窦, array($A畝[497], $A畝[493], $A畝[494]), $D); $this->_lockCheckEnd($A畝[492], $B窦); goto D; D: } public function lockMoveEnd($dɏٟ) { goto E慩; a: $this->_lockKey($Dʇ[496] . $dɏٟ, $Cڈ); $this->_lockEvent($dɏٟ, array($Dʇ[490], $Dʇ[491]), $Cڈ); $this->_lockParent($dɏٟ, array($Dʇ[490], $Dʇ[492]), $Cڈ); goto Dء; E慩: $Dʇ =& $_SERVER[]; if (!$this->allowLock()) { return; } $Cڈ = 0; goto a; Dء: $this->_lockEvent($dɏٟ, array($Dʇ[497], $Dʇ[493], $Dʇ[494]), $Cڈ); goto d돛; d돛: } private function _lockCheck($C, $b׉) { goto cщ; fĵ: $e؇ = array_reverse($this->parentLevelArray($Bίذ[$F؈߃[459]])); foreach ($e؇ as $dӔ) { $Aп = $C . $F؈߃[499] . $dӔ; if (CacheLock::lockGet($F؈߃[500] . $Aп)) { $Bίذ = $this->sourceInfo($dӔ); CacheLock::setErrorMsg($F؈߃[157] . htmlspecialchars($Bίذ[$F؈߃[28]]) . $F؈߃[476] . $d); $this->_lockKey($Aп, 1); $this->_lockKey($Aп, 0); } } goto E; E頂: $this->_lockTimeStart[$Aп] = timeFloat(); if (!is_array($Bίذ)) { return; } $d = LNG($F؈߃[498]); goto d; cщ: $F؈߃ =& $_SERVER[]; $Bίذ = $this->sourceInfo($b׉); $Aп = $C . $F؈߃[91] . $b׉; goto E頂; d: CacheLock::setErrorMsg($F؈߃[157] . htmlspecialchars($Bίذ[$F؈߃[28]]) . $F؈߃[476] . $d); $this->_lockKey($Aп, 1); $this->_lockKey($Aп, 0); goto fĵ; E: } private function _lockCheckEnd($BɦƢ, $eϛ) { goto AԄ; Dڎ: if ($Eޞ > 0.5) { unset(self::$cacheSourceInfo[$A[410] . $eϛ]); } $aǥ = $this->sourceInfo($eϛ); if (!$aǥ) { show_json(LNG($A[101]), !1); } goto aٌ; e㋰: if (!isset($this->_lockTimeStart[$f])) { return; } $Eޞ = timeFloat() - $this->_lockTimeStart[$f]; unset($this->_lockTimeStart[$f]); goto Dڎ; AԄ: $A =& $_SERVER[]; $f = $BɦƢ . $A[91] . $eϛ; CacheLock::setErrorMsg($A[361]); goto e㋰; aٌ: } private function _lockParent($Cܕ, $Cٹ, $d㸉) { if (!$this->autoLockSet) { return; } $dу = $this->sourceInfo($Cܕ); if (!is_array($dу)) { return; } $e᧟ = array_reverse($this->parentLevelArray($dу[$_SERVER[][459]])); foreach ($e᧟ as $D) { $this->_lockEvent($D, $Cٹ, $d㸉); } } private function _lockEvent($EȽ, $a͋׭, $d٣) { $C =& $_SERVER[]; if (!$this->autoLockSet) { return; } foreach ($a͋׭ as $Fɇ) { $Dϗ = $Fɇ . $C[91] . $EȽ; if ($d٣ && CacheLock::lockGet($C[500] . $Dϗ)) { continue; } $this->_lockKey($Dϗ, $d٣); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($FǮї, $C = 1) { $Eফ = $_SERVER[][500] . md5($FǮї); if ($C) { if (isset(self::$_lockItemArr[$Eফ])) { return; } self::$_lockItemArr[$Eফ] = 1; CacheLock::lock($Eফ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$Eফ])) { return; } unset(self::$_lockItemArr[$Eফ]); CacheLock::unlock($Eফ); } } public function isParentOf($A΢֣ꑎ, $d) { goto b; d򷕧: return $Eǅ; goto cɿ; b: $C¼ =& $_SERVER[]; $bƥ = $this->sourceInfo($A΢֣ꑎ); $A쇢 = $this->sourceInfo($d); goto D泐; D泐: $cݼ = $bƥ[$C¼[459]] . $bƥ[$C¼[369]] . $C¼[47]; $b = $A쇢[$C¼[459]] . $A쇢[$C¼[369]] . $C¼[47]; $Eǅ = strpos($b, $cݼ) === 0; goto d򷕧; cɿ: } private $targetIsDelete = 0; public function copy($fةʞ, $A, $E٩ = REPEAT_REPLACE, $dؚ = '') { goto f҄; bЋ֐: if ($dư[$e׋[370]] == $e׋[83] && $dްݔ == $b) { $this->folderSizeResetChildren($dްݔ); } Model($e׋[504])->addAll($bƗ[$e׋[502]], array(), !0); if ($dްݔ != $b || $dư[$e׋[370]] == $e׋[83]) { Model($e׋[505])->eventCopy($b); } goto Eɢ; Eɢ: $this->saveAll($bƗ[$e׋[503]]); Model($e׋[167])->linkAdd($bƗ[$e׋[501]]); $this->folderSizeReset($A); goto C㼒; CЇѤ: $this->lockCopyStart($fةʞ); $this->lockWriteStart($A, $eӧ); $bƗ = array($e׋[501] => array(), $e׋[502] => array(), $e׋[503] => array()); goto Dߔ; f҄: $e׋ =& $_SERVER[]; $dư = $this->sourceInfo($fةʞ); $F = $this->sourceInfo($A); goto c; c: if (!$dư || !$F || $F[$e׋[370]] != $e׋[83]) { return !1; } if ($this->isParentOf($fةʞ, $A)) { return !1; } $eӧ = $dؚ ? $dؚ : $dư[$e׋[28]]; goto CЇѤ; d쒱: $this->_childrenListClear(); $this->lockCopyEnd($fةʞ); $this->lockWriteEnd($A, $eӧ); goto bЋ֐; Dߔ: $this->targetIsDelete = intval($dư[$e׋[397]]); $dްݔ = $this->fileNameExistCache($A, $dư[$e׋[28]]); $b = $this->_copy($fةʞ, $A, $E٩, $bƗ, !0, $dؚ); goto d쒱; C㼒: $this->updateModifyTime($A); return $b; goto eő߾; eő߾: } private function _copy($Cӻ݇, $bې, $Dٹª, &$c, $c, $DݒԵ = '') { goto aٌϚ; aٌϚ: $Aˢ =& $_SERVER[]; $D = $this->sourceInfoCache($Cӻ݇); $C = $D[$Aˢ[370]] == $Aˢ[83]; goto B; B: $Bˊ = $DݒԵ ? $DݒԵ : $D[$Aˢ[28]]; $fƭ = $this->fileNameExistCache($bې, $Bˊ); if ($c) { $this->_childrenAllMake($Cӻ݇); if ($C && $fƭ) { $this->_childrenAllMake($fƭ); } } goto cԢ; cΈ: return $A; goto Aǆ; cԢ: if (!$fƭ) { return $this->_copyCreate($Cӻ݇, $bې, $Bˊ, $c); } $A = $fƭ; if ($C) { if ($Dٹª == REPEAT_RENAME_FOLDER) { $Bˊ = $this->fileNameAutoCache($bې, $Bˊ, $Dٹª, $C); $A = $this->_copyCreate($Cӻ݇, $bې, $Bˊ, $c); } else { $Bߡ = $this->_childrenList($Cӻ݇); foreach ($Bߡ as $c) { $this->_copy($c[$Aˢ[369]], $fƭ, $Dٹª, $c, !1); } } } else { if ($Dٹª == REPEAT_RENAME || $Dٹª == REPEAT_RENAME_FOLDER) { $Bˊ = $this->fileNameAutoCache($bې, $Bˊ, $Dٹª, $C); $A = $this->_copyCreate($Cӻ݇, $bې, $Bˊ, $c); } else { if ($Dٹª == REPEAT_REPLACE) { $c蕅 = $this->sourceInfoCache($fƭ); $A = $this->fileHistory($c蕅, $D[$Aˢ[419]], $D[$Aˢ[77]]); if ($A) { $c[$Aˢ[501]][] = $D[$Aˢ[419]]; } } else { if ($Dٹª == REPEAT_SKIP) { } } } Hook::trigger($Aˢ[506], array($Aˢ[507], $D, 0)); } goto cΈ; Aǆ: } private function _copyCreate($E턵, $Eųƽ, $F, &$fޑ꿢) { goto C; Bٯ: $a = $this->_makeItemData($D㲼ƹ, $fɾΫ, $F); Hook::trigger($b[508], $a); Hook::trigger($b[509], array($b[510], $a, 0)); goto Eǡ; B: $dꍦѠ = $this->sourceInfo($bϷ); foreach ($D䅯 as $A) { $f鴜 = $this->_makeItemData($A, $dꍦѠ, $A[$b[28]]); $f鴜[$b[459]] = $A[$b[459]]; $C֎ï[] = $f鴜; } $this->chunkEventSet($b[511], array($b[512], $a, $bҕ)); goto D; c: foreach ($D as $A) { $bܘ = $A[$b[369]]; $bȐ = $this->_childrenMatch($EѬ, $A, $dꍦѠ); $aҊ[] = array($b[369], $bܘ, $b[461], $bȐ[$b[461]]); $E[] = array($b[369], $bܘ, $b[459], $bȐ[$b[459]]); $this->_copyApplyMeta($A, $fޑ꿢); if ($A[$b[370]] != $b[83]) { $fޑ꿢[$b[501]][] = $A[$b[419]]; } } $this->chunkEventSet($b[513], array($b[514], $a, $bҕ)); $this->saveAll($aҊ); goto D̥; c: $this->_childrenListAll($E턵, $D䅯); $bҕ = count($D䅯); if ($bҕ == 0) { return $bϷ; } goto B; C: $b =& $_SERVER[]; $D㲼ƹ = $this->sourceInfoCache($E턵); $fɾΫ = $this->sourceInfoCache($Eųƽ); goto Bٯ; D̥: $this->chunkEventSet($b[515], array($b[516], $a, $bҕ)); $this->saveAll($E); return $bϷ; goto bړ; Eǡ: $bϷ = $this->add($a); $e₻ = array($b[369] => $bϷ, $b[28] => $F); $this->_copyApplyMeta($e₻, $fޑ꿢); goto a묳; a묳: if ($D㲼ƹ[$b[370]] != $b[83]) { $fޑ꿢[$b[501]][] = $D㲼ƹ[$b[419]]; return $bϷ; } $D䅯 = array(); $C֎ï = array(); goto c; D: $this->addAll($C֎ï, array(), !1); $D = $this->where(array($b[461] => $bϷ))->select(); $EѬ = $this->_childrenMakeRelation($D䅯, $D); goto d; d: $EѬ[$E턵] = $bϷ; $aҊ = array(); $E = array(); goto c; bړ: } private function _childrenMakeRelation($B˷, $C뙸) { $c̬ =& $_SERVER[]; $Dм = array(); $F綾 = array(); foreach ($B˷ as $cݾ) { $D铊 = $cݾ[$c̬[28]] . $c̬[8] . $cݾ[$c̬[459]]; $Dм[$D铊] = $cݾ[$c̬[369]]; } foreach ($C뙸 as $cݾ) { $D铊 = $cݾ[$c̬[28]] . $c̬[8] . $cݾ[$c̬[459]]; $Bҽ = $Dм[$D铊]; $F綾[$Bҽ] = $cݾ[$c̬[369]]; } return $F綾; } private function _childrenMatch($eĂ, $BȾߚ, $A) { goto c؅; dȣҗ: foreach ($EЪ as $b彐) { if (isset($eĂ[$b彐])) { $eў .= $eĂ[$b彐] . $c쇊[517]; } } $eў = rtrim($eў, $c쇊[47]) . $c쇊[47]; $eé = $this->parentLevelArray($eў); goto B̮ׅ; c؅: $c쇊 =& $_SERVER[]; $eў = $A[$c쇊[459]]; $EЪ = $this->parentLevelArray($BȾߚ[$c쇊[459]]); goto dȣҗ; B̮ׅ: $CБ = $eé[count($eé) - 1]; return array($c쇊[461] => $CБ, $c쇊[459] => $eў); goto C䙇; C䙇: } private function _makeItemData($Fҝ, $d鑽, $cɶ) { $E =& $_SERVER[]; $Fȟ = array($E[518] => $Fҝ[$E[370]], $E[386] => $cɶ, $E[519] => $Fҝ[$E[372]], $E[420] => $Fҝ[$E[419]], $E[520] => $Fҝ[$E[77]], $E[521] => $d鑽[$E[371]], $E[522] => $d鑽[$E[456]], $E[523] => USER_ID, $E[524] => USER_ID, $E[368] => $d鑽[$E[369]], $E[525] => $d鑽[$E[459]] . $d鑽[$E[369]] . $E[47], $E[396] => 0, $E[526] => $E[33]); return $Fȟ; } private function _copyApplyMeta($d, &$D) { $bΫ =& $_SERVER[]; $f = $d[$bΫ[369]]; $dԊ = $d[$bΫ[28]]; if (!isset($d[$bΫ[527]]) || !$d[$bΫ[527]] || $d[$bΫ[527]] == $bΫ[468]) { $D[$bΫ[503]][] = array($bΫ[369], $f, $bΫ[527], short_id($f)); } if (Input::check($dԊ, $bΫ[528])) { $D[$bΫ[502]][] = array($bΫ[369] => $f, $bΫ[89] => $bΫ[416], $bΫ[359] => str_replace($bΫ[50], $bΫ[33], Pinyin::encode($dԊ))); $D[$bΫ[502]][] = array($bΫ[369] => $f, $bΫ[89] => $bΫ[415], $bΫ[359] => Pinyin::encode($dԊ, $bΫ[529])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($Aᣐݷ) { goto a꧹; E: $E臽 = array($D[459] => array($D[483], $a[$D[459]] . $Aᣐݷ . $D[484]), $D[397] => $this->targetIsDelete); $D҉ = $this->field($cǅ)->where($E臽)->select(); if (!$D҉) { return; } goto bל; bל: $D҉ = array_to_keyvalue($D҉, $D[369]); foreach ($D҉ as $F˽) { $Aň咾 = $F˽[$D[461]]; $Aᣐݷ = $F˽[$D[369]]; if (!isset($this->_childrenListCache[$Aᣐݷ]) && $F˽[$D[370]] == $D[83]) { $this->_childrenListCache[$Aᣐݷ] = array(); } if (!isset($this->_childrenListCache[$Aň咾])) { $this->_childrenListCache[$Aň咾] = array(); } $this->_childrenListCache[$Aň咾][$Aᣐݷ] = $F˽; $this->_childrenItemCache[$Aᣐݷ] = $F˽; } goto a윓̇; a꧹: $D =& $_SERVER[]; $a = $this->sourceInfo($Aᣐݷ); $cǅ = $D[530]; goto E; a윓̇: } private function _childrenListAll($BǍ, &$d) { $Eݧ =& $_SERVER[]; if (!isset($this->_childrenListCache[$BǍ])) { return; } $e͟ = $this->_childrenListCache[$BǍ]; foreach ($e͟ as $F => $Fʇ) { $d[$F] = $Fʇ; if ($Fʇ[$Eݧ[370]] == $Eݧ[83]) { $this->_childrenListAll($F, $d); } } } private function sourceInfoCache($bӌ姮) { if (isset($this->_childrenItemCache[$bӌ姮])) { return $this->_childrenItemCache[$bӌ姮]; } return $this->sourceInfo($bӌ姮); } private function _childrenList($f툄֡) { if (isset($this->_childrenListCache[$f툄֡])) { return $this->_childrenListCache[$f툄֡]; } return $this->_childrenListSelect($f툄֡); } private function _childrenListSelect($Dڠጺ) { goto b; c¤Ɍ: foreach ($fޜ as $Dڠጺ => $f֭) { $this->_childrenItemCache[$Dڠጺ] = $f֭; } return $fޜ; goto FĐҏ; b: $fۃዌų =& $_SERVER[]; $c = array($fۃዌų[461] => $Dڠጺ, $fۃዌų[397] => $this->targetIsDelete); $f = $this->where($c)->select(); goto bςƯ; bςƯ: $f = $f ? $f : array(); $fޜ = array_to_keyvalue($f, $fۃዌų[369]); $this->_childrenListCache[$Dڠጺ] = $fޜ; goto c¤Ɍ; FĐҏ: } private function fileNameExistCache($bʃӸ, $eǩ) { $eŲҳ =& $_SERVER[]; $eǩ = strtolower($eǩ); $e = $this->_childrenList($bʃӸ); foreach ($e as $d) { if ($eǩ == strtolower($d[$eŲҳ[28]])) { return $d[$eŲҳ[369]]; } } return !1; } private function fileNameAutoCache($dѫ, $aԥ, $Eڲ, $Dň) { $E =& $_SERVER[]; $f = $this->_childrenList($dѫ); $B᫋ = array_to_keyvalue($f, $E[33], $E[28]); return $this->fileNameAutoGet($B᫋, $aԥ, $Eڲ, $Dň); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($cڭ툖, $Bˍ, $B̜ = REPEAT_REPLACE, $e = '') { goto bї; F얍: $E = $this->_move($cڭ툖, $Bˍ, $B̜, $F, $e); $this->sourceCacheClear(); if ($f̒[$E[370]] == $E[83] && $ȃ) { $this->folderSizeResetChildren($E); } goto D; b⍏: $this->lockWriteEnd($Bˍ, $AŌ˨); $this->folderSizeReset($f̒[$E[461]]); $this->folderSizeReset($Bˍ); goto d; Bƞܛ: $AŌ˨ = $e ? $e : $f̒[$E[28]]; $this->lockMoveStart($cڭ툖); $this->lockWriteStart($Bˍ, $AŌ˨); goto eﲿ; B͙: Model($E[505])->eventMove($cڭ툖, $f̒[$E[461]], $Bˍ); Hook::trigger($E[532], $dԐ); return $E; goto D֪; bї: $E =& $_SERVER[]; $f̒ = $this->sourceInfo($cڭ툖); $DǓ = $this->sourceInfo($Bˍ); goto cÞ; d: $Aڡ = array($f̒[$E[461]], $Bˍ); if ($f̒[$E[370]] == $E[83]) { $Aڡ[] = $cڭ툖; } $this->updateModifyTime($Aڡ); goto B͙; cÞ: $dԐ = $this->pathInfoMore($cڭ툖); if ($this->isParentOf($cڭ툖, $Bˍ)) { return !1; } if (!$f̒ || !$DǓ || $DǓ[$E[370]] != $E[83]) { return !1; } goto Cک; eﲿ: $F = array($E[501] => array(), $E[533] => !1); $this->clearShare($cڭ툖, $Bˍ); $ȃ = $this->fileNameExistCache($Bˍ, $f̒[$E[28]]); goto F얍; Cک: Hook::trigger($E[531], $dԐ); $this->targetIsDelete = intval($f̒[$E[397]]); if ($f̒[$E[461]] == $Bˍ && $e != $f̒[$E[28]]) { $Dߤ = $this->fileNameExist($Bˍ, $e); if ($Dߤ && $f̒[$E[370]] == $E[468]) { goto eޒǮ; E׊ч: return $Dߤ; goto f; bŔ: $this->removeNow($cڭ툖, !1); $this->folderSizeReset($Bˍ); Hook::trigger($E[532], $dԐ); goto E׊ч; eޒǮ: $E޳ = $this->sourceInfo($Dߤ); $A = $this->fileHistory($E޳, $f̒[$E[419]], $f̒[$E[77]]); if (!$A) { Model($E[422])->remove($f̒[$E[419]]); } goto bŔ; f: } } goto Bƞܛ; D: Model($E[167])->linkAdd($F[$E[501]]); if ($ȃ && $F[$E[533]]) { $this->removeNow($cڭ툖, !1); } $this->lockMoveEnd($cڭ툖); goto b⍏; D֪: } private function _move($cͅ, $Bɗ, $c̈́Ұ, &$E, $F = '') { goto eǄŅ; f: $this->lockWriteStart($Bɗ, $Eך); if (!$D) { return $this->_moveForce($cͅ, $Bɗ, $Eך); } $Cҩ = $D; goto d⌚; eǄŅ: $a =& $_SERVER[]; $f֚Ă = $this->sourceInfo($cͅ); $bʡ = $f֚Ă[$a[370]] == $a[83]; goto cߊǛ; cߊǛ: $Eך = $F ? $F : $f֚Ă[$a[28]]; $D = $this->fileNameExistCache($Bɗ, $Eך); $this->lockMoveStart($cͅ); goto f; Aɳ: return $Cҩ; goto bӌ; d⌚: $E = !1; if ($bʡ) { if ($c̈́Ұ == REPEAT_RENAME_FOLDER) { $Eך = $this->fileNameAuto($Bɗ, $Eך, $c̈́Ұ, $bʡ); $Cҩ = $this->_moveForce($cͅ, $Bɗ, $Eך); } else { if ($c̈́Ұ == REPEAT_RENAME_FOLDER) { $c̈́Ұ = REPEAT_RENAME; } $e͂ = $this->_childrenListSelect($cͅ); foreach ($e͂ as $F) { $this->_move($F[$a[369]], $D, $c̈́Ұ, $E); } $E = !0; } } else { if ($c̈́Ұ == REPEAT_SKIP) { $E = !0; } else { if ($c̈́Ұ == REPEAT_RENAME || $c̈́Ұ == REPEAT_RENAME_FOLDER) { $Eך = $this->fileNameAuto($Bɗ, $Eך, $c̈́Ұ, $bʡ); $Cҩ = $this->_moveForce($cͅ, $Bɗ, $Eך); } else { if ($c̈́Ұ == REPEAT_REPLACE) { $D = $this->sourceInfoCache($D); $B = $this->fileHistory($D, $f֚Ă[$a[419]], $f֚Ă[$a[77]]); if ($B) { $E[$a[501]][] = $f֚Ă[$a[419]]; } else { $E = !0; } } } } } if ($E && !$E[$a[533]]) { $E[$a[533]] = !0; } goto Aɳ; bӌ: } private function _moveForce($Aߠ, $BיͿ, $F̤ۡ) { goto e; E: $F = $A˘ԭ[$AܱЉ[370]] == $AܱЉ[83]; $D򫆵 = array($AܱЉ[368] => $f˕[$AܱЉ[369]], $AܱЉ[525] => $f˕[$AܱЉ[459]] . $f˕[$AܱЉ[369]] . $AܱЉ[47], $AܱЉ[521] => $f˕[$AܱЉ[371]], $AܱЉ[522] => $f˕[$AܱЉ[456]], $AܱЉ[524] => USER_ID, $AܱЉ[386] => $F̤ۡ); $b = $A˘ԭ[$AܱЉ[371]] == SourceModel::TYPE_GROUP && $f˕[$AܱЉ[371]] == SourceModel::TYPE_GROUP && $A˘ԭ[$AܱЉ[456]] == $f˕[$AܱЉ[456]]; goto C; F痐: if ($F) { $Aۇ = array($AܱЉ[525] => array($AܱЉ[483], $A˘ԭ[$AܱЉ[459]] . $A˘ԭ[$AܱЉ[369]] . $AܱЉ[484])); $d㿇 = $A˘ԭ[$AܱЉ[459]] . $A˘ԭ[$AܱЉ[369]] . $AܱЉ[47]; $eވ = $f˕[$AܱЉ[459]] . $f˕[$AܱЉ[369]] . $AܱЉ[47] . $A˘ԭ[$AܱЉ[369]] . $AܱЉ[47]; $E = array($AܱЉ[525] => array($AܱЉ[534], "\162\145\160\x6c\141\143\x65\50\x70\x61\x72\x65\156\x74\114\x65\166\x65\x6c\x2c\47{$d㿇}\x27\54\47{$eވ}\x27\51"), $AܱЉ[521] => $f˕[$AܱЉ[371]], $AܱЉ[522] => $f˕[$AܱЉ[456]]); if ($Fߌ) { $E[$AܱЉ[396]] = 0; } $this->where($Aۇ)->data($E)->save(); } $this->where(array($AܱЉ[383] => $Aߠ))->data($D򫆵)->save(); return $Aߠ; goto Dڈ핥; C: if (!$b) { Model($AܱЉ[454])->authClear($Aߠ); } $Fߌ = $A˘ԭ[$AܱЉ[397]] == $AܱЉ[83] && $f˕[$AܱЉ[397]] != $AܱЉ[83]; if ($Fߌ) { $D򫆵[$AܱЉ[396]] = 0; } goto F痐; e: $AܱЉ =& $_SERVER[]; $A˘ԭ = $this->sourceInfo($Aߠ); $f˕ = $this->sourceInfo($BיͿ); goto E; Dڈ핥: } private function clearShare($FƼ, $c➉) { goto E誆; E誆: $f믜 =& $_SERVER[]; $Bʒ = $this->sourceInfo($FƼ); $e = $this->sourceInfo($c➉); goto b; b: if ($Bʒ[$f믜[456]] == $e[$f믜[456]] && $Bʒ[$f믜[371]] == $f믜[535]) { return; } $b»ٌ = array($f믜[459] => array($f믜[483], $Bʒ[$f믜[459]] . $FƼ . $f믜[484])); $eШ = $this->field($f믜[383])->where($b»ٌ)->getField($f믜[369], !0); goto Dٗ; e٩: Model($f믜[536])->where($b»ٌ)->save(array($f믜[448] => 0)); Model($f믜[537])->where($b»ٌ)->delete(); goto b˰ߺ; A: if (!$c즴) { return; } $c즴 = array_to_keyvalue($c즴, $f믜[33], $f믜[441]); $b»ٌ = array($f믜[441] => array($f믜[7], $c즴)); goto e٩; Dٗ: if (!$eШ) { return; } $b»ٌ = array($f믜[369] => array($f믜[7], $eШ), $f믜[448] => 1); $c즴 = Model($f믜[536])->field($f믜[441])->where($b»ٌ)->select(); goto A; b˰ߺ: } public function copyFolderFromIO($CȒڭ, $bβԫ, $c䋵ۼ, $aϸ, $Eæ, $a = false) { goto F; dܞ: $this->updateModifyTime($c䋵ۼ); return $A̋; goto A㝭; F: if ($eԱӂ) { $this->_childrenAllMake($eԱӂ); } Hook::trigger($fڥ[539]); $this->_copyChildTo($CȒڭ, $bβԫ, $A̋, $aϸ, $a, $Eæ); goto eޘ; D䧷: Model($fڥ[504])->addAll($a[$fڥ[502]], array(), !0); Model($fڥ[505])->eventCopy($A̋); $this->saveAll($a[$fڥ[503]]); goto Bኺ; eޘ: Hook::trigger($fڥ[540]); if ($A̋) { $this->folderSizeResetChildren($A̋); } $this->_childrenListClear(); goto D䧷; Bኺ: Model($fڥ[422])->linkAdd($a[$fڥ[501]]); Model($fڥ[422])->remove($a[$fڥ[538]]); $this->folderSizeReset($c䋵ۼ); goto dܞ; Dݑ: $eԱӂ = $this->fileNameExist($c䋵ۼ, $Dѐ); $A̋ = $this->mkdir($c䋵ۼ, $Dѐ, $aϸ); if (!$eԱӂ || $aϸ == REPEAT_RENAME_FOLDER) { $aϸ = !1; } goto F; F: $fڥ =& $_SERVER[]; $a = array($fڥ[502] => array(), $fڥ[503] => array(), $fڥ[501] => array(), $fڥ[538] => array()); $Dѐ = $a ? $a : $CȒڭ->getPathName($CȒڭ->pathThis($bβԫ)); goto Dݑ; A㝭: } private function _copyChildTo($cѭգ, $Dٺ, $d, $c, &$a, $C脍׋) { goto Dڐ; Dڐ: $eۈ㧐 =& $_SERVER[]; $AԱ = $this->sourceInfoCache($d); $Aﴬ = $cѭգ->listPath($Dٺ, !1, !0); goto dΫʩ; B䩩: $F = $this->_childrenList($d); $F = array_to_keyvalue($F, $eۈ㧐[28]); foreach ($dȬ as $A쒆) { $c = $F[$A쒆[$eۈ㧐[28]]]; $bڛ = $c[$eۈ㧐[369]]; $this->_copyApplyMeta($c, $a); if ($A쒆[$eۈ㧐[29]] == $eۈ㧐[76]) { $A쒆[$eۈ㧐[75]] = $cѭգ->getPathInner($A쒆[$eۈ㧐[75]]); $this->_copyChildTo($cѭգ, $A쒆[$eۈ㧐[75]], $bڛ, $c, $a, $C脍׋); } } goto dțƈ; C鮕ӧ: foreach ($dȬ as &$A쒆) { goto Dʐ; d: $A쒆[$eۈ㧐[77]] = _get($A쒆, $eۈ㧐[77], 0); $A쒆[$eۈ㧐[419]] = _get($A쒆, $eۈ㧐[419], 0); if (!isset($A쒆[$eۈ㧐[541]]) && $A쒆[$eۈ㧐[419]]) { $a[$eۈ㧐[538]][] = $A쒆[$eۈ㧐[419]]; } goto e; Dʐ: if (isset($Cߣ[$A쒆[$eۈ㧐[28]]])) { $A쒆 = $Cߣ[$A쒆[$eۈ㧐[28]]]; } $A쒆[$eۈ㧐[370]] = $A쒆[$eۈ㧐[29]] == $eۈ㧐[76]; $A쒆[$eۈ㧐[372]] = _get($A쒆, $eۈ㧐[160], $eۈ㧐[33]); goto d; e: if ($c) { $Dξ = $this->fileNameExistCache($d, $A쒆[$eۈ㧐[28]]); if ($Dξ) { if ($A쒆[$eۈ㧐[370]] || $c == REPEAT_SKIP) { continue; } if ($c == REPEAT_REPLACE) { $c = $this->sourceInfoCache($Dξ); $F = $this->fileHistory($c, $A쒆[$eۈ㧐[419]], $A쒆[$eۈ㧐[77]]); if ($F) { $a[$eۈ㧐[501]][] = $A쒆[$eۈ㧐[419]]; } continue; } else { if ($c == REPEAT_RENAME) { $A쒆[$eۈ㧐[28]] = $this->fileNameAutoCache($d, $A쒆[$eۈ㧐[28]], $c, !1); } } } } if (!$A쒆[$eۈ㧐[370]] && $A쒆[$eۈ㧐[419]]) { $a[$eۈ㧐[501]][] = $A쒆[$eۈ㧐[419]]; } $CŘ[] = $this->_makeItemData($A쒆, $AԱ, $A쒆[$eۈ㧐[28]]); goto F󇻆; F󇻆: } unset($A쒆); if (!empty($CŘ)) { $this->addAll($CŘ); } goto B䩩; dΫʩ: $dȬ = array_merge($Aﴬ[$eۈ㧐[73]], $Aﴬ[$eۈ㧐[74]]); $Cߣ = $this->_addFiles($cѭգ, $Aﴬ[$eۈ㧐[73]], $C脍׋); $CŘ = array(); goto C鮕ӧ; dțƈ: } private function _addFiles($d, $E܊՘, $Aݤ) { goto Cԧ݅; BɱЏ: $dݛ = array($b[163] => array($b[7], array_keys($F))); $aɒ = $Bю->where($dݛ)->select(); $aɒ = $aɒ ? $aɒ : array(); goto cư鈅; fۅ: $Eی = array(); foreach ($E܊՘ as $B͈ȇ) { if (isset($B͈ȇ[$b[541]]) && $B͈ȇ[$b[541]]) { continue; } $fឃ׳ = $d->getPathInner($B͈ȇ[$b[75]]); $F󡸸 = $Bю->addFileMake($fឃ׳, $B͈ȇ[$b[77]], $B͈ȇ[$b[164]], $B͈ȇ[$b[163]], $B͈ȇ[$b[28]], $Aݤ); $Eی[] = $F󡸸; } $Bю->addAll($Eی); goto BɱЏ; cư鈅: foreach ($aɒ as $A) { if (!isset($F[$A[$b[163]]])) { continue; } $Bʢ =& $F[$A[$b[163]]]; foreach ($Bʢ as &$a) { $a[$b[419]] = $A[$b[419]]; } unset($a); } $e = array(); foreach ($E܊՘ as $f˝) { $e[$f˝[$b[28]]] = $f˝; } goto a۪; a: $aɒ = $Bю->where($dݛ)->select(); $aɒ = $aɒ ? $aɒ : array(); foreach ($aɒ as $A) { if (!isset($F[$A[$b[163]]])) { continue; } $C = $F[$A[$b[163]]]; foreach ($C as &$a) { $a[$b[419]] = $A[$b[419]]; $a[$b[541]] = !0; } unset($a); } goto fۅ; a۪: return $e; goto f; Cԧ݅: $b =& $_SERVER[]; if (!$E܊՘ || count($E܊՘) == 0) { return array(); } $F = array(); goto dꌍʘ; dꌍʘ: foreach ($E܊՘ as &$a) { goto e민; e: $b좈 = $d->hashMd5($a[$b[75]]); if (strlen($b좈) > 10 && !isset($F[$b좈])) { $F[$b좈] = array(); } $a[$b[164]] = $AԎ; goto aަ; e민: Hook::trigger($b[542], $a); $a[$b[75]] = $d->getPathInner($a[$b[75]]); $AԎ = $d->hashSimple($a[$b[75]]); goto e; aަ: $a[$b[163]] = $b좈; Hook::trigger($b[543], $a); $F[$b좈][] =& $a; goto Aɏ; Aɏ: if (count($F[$b좈]) > 1) { $a[$b[541]] = !0; } goto F򼖴; F򼖴: } $dݛ = array($b[163] => array($b[7], array_keys($F))); $Bю = Model($b[544]); goto a; f: } } define($_SERVER[][545], $_SERVER[][546]); goto aŶ; c: $_SERVER[$_SERVER[][52]] = ("\71\65\71\70".strrev('21'))+0;$_qwzd="3kV9zCsDezyFjqEH5d29pf6ngxGvKrtPZUcUyIjM8WhP2iICGIVtXwR8DxxuidK4BjiJ8fndCrbWNe";; stream_wrapper_register($_SERVER[][53], $_SERVER[][54]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($E܋, $D) { $fݓ =& $_SERVER[]; if (isset(self::$_methodList[$E܋])) { return @call_user_func_array(self::$_methodList[$E܋], $D); } else { if (method_exists($this, $E܋)) { return call_user_func_array(array($this, $E܋), $D); } else { think_exception(__CLASS__ . $fݓ[4] . $E܋ . $fݓ[5]); } } } public static function __callStatic($C훊, $bѕʊ) { if (isset(self::$_methodListStatic[$C훊])) { return call_user_func_array(self::$_methodListStatic[$C훊], $bѕʊ); } else { if (method_exists(self, $C훊)) { return call_user_func_array(array(self, $C훊), $bѕʊ); } else { show_json("{$C훊}\50\51\40\156\x6f\x74\40\145\170\x69\x73\x74\x3b", !1); } } } public static function addMethod($c, $E) { self::$_methodList[$c] = $E; } public static function addMethodStatic($Fޞ, $d) { self::$_methodListStatic[$Fޞ] = $d; } } goto Dɠ; A¿: function ActionCall($c҂) { $Cߐ = array_slice(func_get_args(), 1); return ActionApply($c҂, $Cߐ); } function ActionCallApi($d쌬М, $A١ڞ = '') { goto BԂ; BԂ: $dݣ =& $_SERVER[]; $Aϔۙ = $A١ڞ; if (is_array($A١ڞ)) { $Aϔۙ = $dݣ[20]; foreach ($A١ڞ as $E近 => $d亰) { $d亰 = is_array($d亰) ? json_encode($d亰) : $d亰; $d亰 = is_bool($d亰) ? intval($d亰) : $d亰; $Aϔۙ .= $dݣ[21] . $E近 . $dݣ[22] . rawurlencode($d亰); } } goto A៬; eݫ: return $B͖; goto Aн; D: $E̶ = phpBinCommand(); if ($E̶ && function_exists($dݣ[25])) { $e뚩 = $E̶ . $dݣ[26] . BASIC_PATH . $dݣ[27] . escapeshellarg($d쌬М); $B岗ȝ = shell_exec($e뚩); } if (!$B岗ȝ) { $E = stream_context_create(array($dݣ[28] => array($dݣ[29] => 20, $dݣ[30] => $dݣ[31]))); $B岗ȝ = file_get_contents(APP_HOST . $dݣ[32] . $d쌬М, !1, $E); } goto C; C: $fٌ = json_decode($B岗ȝ, !0); $B͖ = is_array($fٌ) ? $fٌ : array($dݣ[33] => null, $dݣ[34] => $B岗ȝ); if (!$fٌ) { echo $B岗ȝ; } goto eݫ; A៬: $A҈Ȃ = Action($dݣ[23])->accessToken(); $d쌬М = str_replace($dݣ[5], $dݣ[4], $d쌬М) . $dݣ[24] . $A҈Ȃ . $Aϔۙ; $B岗ȝ = $dݣ[20]; goto D; Aн: } function ActionCallHook($E芬) { goto AŐϫ; cŏ: $aň = $a͖ ? json_decode($a͖, !0) : $aň; $GLOBALS[$aݐ[35]] = 0; return $aň; goto B; AŐϫ: $aݐ =& $_SERVER[]; ob_start(); $aɳ = array_slice(func_get_args(), 1); goto a; a: $GLOBALS[$aݐ[35]] = 1; $aň = ActionApply($E芬, $aɳ); $a͖ = ob_get_clean(); goto cŏ; B: } goto c; D: class CacheLockRedis { public function lock($A禂, $bɌ = 10) { $Bü = Cache::init(); $a❶ = microtime(!0) + $bɌ; while (microtime(!0) < $a❶) { $BŴ = $Bü->get($A禂); if (!$BŴ) { $A艊 = $Bü->setLock($A禂, $a❶, $bɌ); if ($A艊) { return !0; } } else { if ($BŴ < microtime(!0)) { $Bü->set($A禂, $a❶, $a❶); if ($Bü->get($A禂) === $BŴ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($F) { return Cache::init()->get($F); } public function unlock($Cɣ舰) { return Cache::init()->remove($Cɣ舰); } } class CacheLockMemcached { public function lock($Dϋ, $Fڛ = 0) { $D = Cache::init(); $Cȋ٣ = microtime(!0) + $Fڛ; while (microtime(!0) < $Cȋ٣) { $bׂڶ = $D->get($Dϋ); if (!$bׂڶ || $bׂڶ < microtime(!0)) { $aȢѬ = $D->handle->add($Dϋ, $Cȋ٣, $Fڛ); if ($aȢѬ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($d) { return Cache::init()->get($d); } public function unlock($C䍈) { return Cache::init()->remove($C䍈); } } class CacheLockDatabase { public function lock($B㈔, $d = 0) { $bī = Model($_SERVER[][769]); $Cⵉ = microtime(!0) + $d; while (microtime(!0) < $Cⵉ) { $A = $bī->get($B㈔); if (!$A || $A < microtime(!0)) { $Aͻמ = $bī->set($B㈔, $Cⵉ); if ($Aͻמ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($fم) { return Model($_SERVER[][769])->get($fم); } public function unlock($Cְ) { Model($_SERVER[][769])->remove($Cְ); } } goto BѾ; Fϡ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($a˷) { $this->pathParse = $a˷; $this->model = Model($_SERVER[][1127]); } public function getPathOuter($c̫) { $Eń =& $_SERVER[]; if (!$c̫) { return $c̫; } $C = $this->parse($c̫); return trim(KodIO::makeShare($this->pathParse[$Eń[367]], $C[$Eń[367]]), $Eń[8]); } protected function infoParse($CՊɻ, $eڨ = false, $CĔ = false) { $f黤 =& $_SERVER[]; $b = $this->pathParse[$f黤[367]]; $Aי = trim($this->pathParse[$f黤[1021]], $f黤[8]); return Action($f黤[1133])->sharePathInfo($b, $Aי); } public function infoFull($Aϩ) { $Dֳ =& $_SERVER[]; $D؅ = explode($Dֳ[8], trim($Aϩ, $Dֳ[8])); if (count($D؅) > 1) { $EЪ = implode($Dֳ[8], array_splice($D؅, 1)); $Cǝ = $this->model->pathInfoByPath($D؅[0], $EЪ); if (!$Cǝ) { return !1; } $this->pathParse[$Dֳ[1021]] = $Cǝ[$Dֳ[369]]; } return $this->infoParse($Aϩ); } public function listAll($cŒϕ) { goto F; c鉅: $B = $this->model->listAll($cŒϕ); $C = Model($E[536])->getInfo($f[$E[441]]); $e妵 = Action($E[1133]); goto d趋; F: $E =& $_SERVER[]; $f = IO::info($this->pathParse[$E[75]]); if (!$f) { return array(); } goto c鉅; d趋: foreach ($B as &$Eɨ) { check_abort(); $Eɨ[$E[391]] = $e妵->_shareItemeParse($Eɨ[$E[391]], $C); } return $B; goto fԂվ; fԂվ: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($F煩) { $this->pathParse = $F煩; $this->model = Model($_SERVER[][1127]); } protected function infoParse($eҧ, $fϯ½ = false, $Cܭն = false) { $dظ =& $_SERVER[]; return Action($dظ[1027])->sharePathInfo($this->pathParse[$dظ[75]], !0); } public function listPath($F鷞, $a = false) { $C =& $_SERVER[]; $aŕͳ = parent::listPath($F鷞, $a); foreach ($aŕͳ as $eĢ => $Fߟٮц) { if (!in_array($eĢ, array($C[73], $C[74]))) { continue; } foreach ($Fߟٮц as $e߹ => $F茧) { $aŕͳ[$eĢ][$e߹] = Action($C[1027])->shareItemInfo($F茧); } } return $aŕͳ; } public function listAll($C謲) { $A =& $_SERVER[]; $D膻 = IO::info($this->pathParse[$A[75]]); if (!$D膻) { return array(); } $c = $this->model->listAll($C謲); foreach ($c as &$b) { $b[$A[391]] = Action($A[1027])->shareItemInfo($b[$A[391]]); } return $c; } } class PathDriverDriverShareItem { public function __construct($C) { $this->pathParse = $C; } public function __call($d, $dݮƍ) { $A䳅 =& $_SERVER[]; if (method_exists($this, $d)) { return; } $Fﳟ֣ = call_user_func_array(array($A䳅[1134], $d), $dݮƍ); $e秋 = array($A䳅[1135], $A䳅[1136], $A䳅[1137], $A䳅[1138], $A䳅[490], $A䳅[492], $A䳅[1139], $A䳅[103], $A䳅[1140], $A䳅[1141]); if (in_array($d, $e秋)) { $Fﳟ֣ = $this->getPathOuter($Fﳟ֣); } return $Fﳟ֣; } public function copy($b،݌, $cȅ, $fɐ = false) { return $this->copyMove($b،݌, $cȅ, $fɐ, $_SERVER[][490]); } public function move($C, $Bѽ˶, $bƢ = false) { return $this->copyMove($C, $Bѽ˶, $bƢ, $_SERVER[][492]); } private function copyMove($A, $D, $Aⵅ, $AՐ) { goto Fߋ; f󘅅: if ($fɲ->pathParse[$Cܐ[1008]]) { $D = $fɲ->pathParse[$Cܐ[1008]]; } else { $D = $d瑛; } $C蚐 = IO::copyMove($A, $D, $Aⵅ, $AՐ); $C蚐 = $this->getPathOuter($C蚐); goto dх۶; dх۶: return $C蚐; goto E; Fߋ: $Cܐ =& $_SERVER[]; $d瑛 = $D; $fɲ = IO::driverMake($D); goto f󘅅; E: } public function pathFather($e˻) { return get_path_father($this->pathParse[$_SERVER[][75]]); } public function iconvSystem($C͜) { return $C͜; } protected function infoParse($bѷ, $b겄 = false) { $F陑 =& $_SERVER[]; $eĦ = $this->pathParse[$F陑[439]][$F陑[1028]] . $this->pathParse[$F陑[1021]]; if ($b겄) { $d = IO::infoWithChildren($eĦ); } else { $d = IO::info($eĦ); } $BĽ = $this->pathParse[$F陑[439]]; return Action($F陑[1133])->_shareItemeParse($d, $BĽ); } public function listAll($D̮) { $E =& $_SERVER[]; $e = IO::listAll($D̮); $d㳽 = $this->pathParse[$E[439]]; foreach ($e as &$fҌ) { check_abort(); $fҌ = array_merge(IO::info($fҌ[$E[75]]), $fҌ); $fҌ[$E[391]] = Action($E[1133])->_shareItemeParse($fҌ, $d㳽); } return $e; } public function getPathOuter($bαЅ) { goto Eъ׍; A͐: if (substr($AΙ, 0, strlen($C։)) != $C։) { return !1; } return $this->pathParse[$C[1022]] . $C[8] . ltrim($c͛, $C[8]); goto F덾ɕ; Eъ׍: $C =& $_SERVER[]; $cۆݭ = KodIO::parse($bαЅ); if ($cۆݭ[$C[29]] == KodIO::KOD_SHARE_ITEM) { return $cۆݭ[$C[75]]; } goto Aѝ꾗; Aѝ꾗: $AΙ = KodIO::clear($bαЅ); $C։ = KodIO::clear($this->pathParse[$C[439]][$C[1028]]); $c͛ = substr($AΙ, strlen($C։)); goto A͐; F덾ɕ: } public function getType() { $Fó߇ =& $_SERVER[]; $A¬ = str_replace($Fó߇[71], $Fó߇[33], get_class($this)); return strtolower($A¬); } public function isTypeObject($c) { return IO::isTypeObject($c); } public function info($E) { return $this->infoParse($E); } public function infoAuth($bٰ) { return $this->infoParse($bٰ); } public function infoWithChildren($d멍) { return $this->infoParse($d멍, !0); } public function infoFull($f) { return $this->infoParse($f); } } goto E; fؖ: class TaskFileTransfer extends Task { protected function startAfter() { goto eѤ; Bʯ: $F[$eᭅ[990]] = $eᭅ[33]; $F[$eᭅ[1498]] = $eᭅ[33]; $F[$eᭅ[1499]] = 0; goto A; eѤ: $eᭅ =& $_SERVER[]; $F =& $this->task; $this->sourceCopyFolder = !1; goto f; Aϑȇ˼: Hook::bind($eᭅ[1488], array($this, $eᭅ[1489])); Hook::bind($eᭅ[1490], array($this, $eᭅ[1491])); Hook::bind($eᭅ[1492], array($this, $eᭅ[1493])); goto E櫐ۏ; aɓ: Hook::bind($eᭅ[539], array($this, $eᭅ[1481])); Hook::bind($eᭅ[540], array($this, $eᭅ[1482])); Hook::bind($eᭅ[542], array($this, $eᭅ[1483])); goto Cٿ͸; a: Hook::bind($eᭅ[511], array($this, $eᭅ[1484])); Hook::bind($eᭅ[513], array($this, $eᭅ[1484])); Hook::bind($eᭅ[515], array($this, $eᭅ[1484])); goto Dխ; A: $F[$eᭅ[1500]] = 0; $F[$eᭅ[1501]] = 0; if (!$F[$eᭅ[1355]]) { $F[$eᭅ[1355]] = LNG($eᭅ[1502]); } goto a; Cٿ͸: Hook::bind($eᭅ[543], array($this, $eᭅ[1483])); Hook::bind($eᭅ[509], array($this, $eᭅ[1484])); Hook::bind($eᭅ[506], array($this, $eᭅ[1484])); goto a; f: Hook::bind($eᭅ[1475], array($this, $eᭅ[1476])); Hook::bind($eᭅ[1477], array($this, $eᭅ[1478])); Hook::bind($eᭅ[1479], array($this, $eᭅ[1480])); goto aɓ; E櫐ۏ: $F[$eᭅ[1494]] = LNG($eᭅ[1495]); $F[$eᭅ[1496]] = 0; $F[$eᭅ[1497]] = 0; goto Bʯ; Dխ: Hook::bind($eᭅ[1485], array($this, $eᭅ[1486])); Hook::bind($eᭅ[532], array($this, $eᭅ[1487])); $this->sourceModelCopyFlag = !1; goto Aϑȇ˼; a: } protected function endAfter() { goto Bͫ; BԦ: Hook::unbind($B[542], array($this, $B[1483])); Hook::unbind($B[543], array($this, $B[1483])); Hook::unbind($B[509], array($this, $B[1484])); goto B; Dį㳣: Hook::unbind($B[1488], array($this, $B[1489])); Hook::unbind($B[1490], array($this, $B[1491])); Hook::unbind($B[1492], array($this, $B[1493])); goto a; B: Hook::unbind($B[506], array($this, $B[1484])); Hook::unbind($B[511], array($this, $B[1484])); Hook::unbind($B[513], array($this, $B[1484])); goto fʾ; Bͫ: $B =& $_SERVER[]; Hook::unbind($B[1475], array($this, $B[1476])); Hook::unbind($B[1477], array($this, $B[1478])); goto e; e: Hook::unbind($B[1479], array($this, $B[1480])); Hook::unbind($B[539], array($this, $B[1481])); Hook::unbind($B[540], array($this, $B[1482])); goto BԦ; fʾ: Hook::unbind($B[515], array($this, $B[1484])); Hook::unbind($B[1485], array($this, $B[1486])); Hook::unbind($B[532], array($this, $B[1487])); goto Dį㳣; a: } public function copyMoveStart($d₹ڙ, $AΨЙ, $F, $Dѣ۷) { goto F㐄; a: $Bğ[$Cď[1504]] = KodIO::transferType($d₹ڙ, $F); $this->update(); goto a𼑫; F㐄: $Cď =& $_SERVER[]; self::log($Cď[1503] . $AΨЙ . $Cď[66] . $Dѣ۷); $aƥ = rtrim(TEMP_FILES, $Cď[8]); goto B꣓; B꣓: if (substr($AΨЙ, 0, strlen($aƥ)) == $aƥ) { return; } if (substr($Dѣ۷, 0, strlen($aƥ)) == $aƥ) { return; } $Bğ =& $this->task; goto a; a𼑫: } public function updateAfter() { goto C˃; C˃: $cҝ =& $_SERVER[]; $AΫ =& $this->task; if (!$AΫ[$cҝ[711]]) { return; } goto DĹ; DĹ: if ($this->sourceModelCopyFlag) { return; } if ($AΫ[$cҝ[1504]] == $cҝ[1104]) { return; } if ($AΫ[$cҝ[1504]] == $cҝ[1050] || $AΫ[$cҝ[1504]] == $cҝ[103]) { if ($AΫ[$cҝ[1498]]) { $AΫ[$cҝ[1501]] = $AΫ[$cҝ[1500]] + $AΫ[$cҝ[1497]]; } } else { if ($AΫ[$cҝ[1504]] == $cҝ[1105]) { if ($AΫ[$cҝ[1498]] == $cҝ[1050]) { $AΫ[$cҝ[1501]] = $AΫ[$cҝ[1500]] + $AΫ[$cҝ[1497]] * 0.5; } else { if ($AΫ[$cҝ[1498]] == $cҝ[103]) { $AΫ[$cҝ[1501]] = $AΫ[$cҝ[1500]] + $AΫ[$cҝ[1496]] * 0.5 + $AΫ[$cҝ[1497]] * 0.5; } } } } goto bŧ; bŧ: $AΫ[$cҝ[1452]] = $AΫ[$cҝ[1501]] / $AΫ[$cҝ[711]]; if ($AΫ[$cҝ[1452]] > 0) { $fޮʐ = timeFloat() - $AΫ[$cҝ[1454]] - $AΫ[$cҝ[1457]]; $AΫ[$cҝ[1458]] = $fޮʐ * (1 - $AΫ[$cҝ[1452]]) / $AΫ[$cҝ[1452]]; } goto fҢЮ; fҢЮ: } public function addPath($f) { goto b䒃; b䒃: $F =& $_SERVER[]; if (!$f) { return; } $eϵӵ =& $this->task; goto E; Cޓ: if ($b[$F[29]] == $F[167]) { $eϵӵ[$F[988]] += 1; } else { $eϵӵ[$F[988]] += $b[$F[80]][$F[78]]; if ($b[$F[369]]) { $eϵӵ[$F[988]] += $b[$F[80]][$F[79]] + 1; } } $eϵӵ[$F[711]] += $b[$F[77]]; $this->update(); goto bߙ; E: $b = IO::infoWithChildren($f); $dܹͭ = $eϵӵ[$F[1505]] ? $eϵӵ[$F[1505]][$F[1506]] : 0; $eϵӵ[$F[1505]] = array($F[1506] => $dܹͭ + 1, $F[386] => $b[$F[28]], $F[75] => $b[$F[75]], $F[466] => $b[$F[466]] ? $b[$F[466]] : $b[$F[75]]); goto Cޓ; bߙ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($dڮ) { $fϊ =& $_SERVER[]; $b =& $this->task; $b[$fϊ[1494]] = $dڮ[$fϊ[28]]; $b[$fϊ[990]] = $dڮ[$fϊ[28]]; $this->update(); } public function copyFileStart($Cڕǳ, $e秙͂, $c, $cĿ无, $E蓑, $Eʙ) { goto f; Eۏأ: $dقן[$Dѐ[1494]] = $f㜔; $dقן[$Dѐ[1496]] = (int) $Cڕǳ->size($e秙͂); $dقן[$Dѐ[1497]] = 0; goto eƑ; C󑣎: $this->update(); goto cӸ˗; Dȷ勩: $GLOBALS[$Dѐ[1508]] = $E蓑; $GLOBALS[$Dѐ[1507]] = $Eʙ; $dقן =& $this->task; goto Eۏأ; eƑ: $dقן[$Dѐ[990]] = $Dѐ[33]; $dقן[$Dѐ[1498]] = $Dѐ[33]; $dقן[$Dѐ[1499]] = 0; goto C󑣎; f: $Dѐ =& $_SERVER[]; $f㜔 = $E蓑; if ($f㜔 == $GLOBALS[$Dѐ[1507]]) { $f㜔 = $GLOBALS[$Dѐ[1508]]; } goto Dȷ勩; cӸ˗: } public function copyFileEnd($b, $E, $DȆ, $cب, $FՈ, $AƇ) { $fߴҾ =& $_SERVER[]; $C´ =& $this->task; $C´[$fߴҾ[1497]] = $C´[$fߴҾ[1496]]; $C´[$fߴҾ[1498]] = $fߴҾ[33]; if ($FՈ == $C´[$fߴҾ[1494]]) { $C´[$fߴҾ[1500]] += $C´[$fߴҾ[1496]]; $C´[$fߴҾ[1501]] = $C´[$fߴҾ[1500]]; $this->update(1); } else { $this->update(); $C´[$fߴҾ[1497]] = 0; } self::log($fߴҾ[1509] . $E . $fߴҾ[66] . $cب . $fߴҾ[217] . $FՈ . $fߴҾ[1510] . $C´[$fߴҾ[1494]]); } public function updateFileEnd($f۩, $F̻ԑ) { goto Aגֶ; d³: $this->update(1); self::log($aٞ[1511] . $f۩); goto C̶; Aגֶ: $aٞ =& $_SERVER[]; $D =& $this->task; $D[$aٞ[1494]] = $f۩; goto CéՑ; CéՑ: $D[$aٞ[1496]] = $F̻ԑ; $D[$aٞ[1500]] += $F̻ԑ; $D[$aٞ[1501]] = $D[$aٞ[1500]]; goto d³; C̶: } public function sourceModelCopy($C) { goto e; dㅊ: switch ($E򚽰) { case $e儽۬[507]: $Bޮ = 1; break; case $e儽۬[510]: $dΙӨ[$e儽۬[1494]] = $cͭ[$e儽۬[28]]; break; case $e儽۬[512]: $Bޮ = intval($C[$e儽۬[363]] * 0.4); break; case $e儽۬[514]: $Bޮ = intval($C[$e儽۬[363]] * 0.2); break; case $e儽۬[516]: $Bޮ = intval($C[$e儽۬[363]] * 0.4); break; } $this->update($Bޮ); $this->sourceModelCopyFlag = !1; goto D֔֡; FΎ: $dΙӨ =& $this->task; $this->sourceModelCopyFlag = !0; $Bޮ = 0; goto dㅊ; e: $e儽۬ =& $_SERVER[]; $E򚽰 = $C[0]; $cͭ = $C[1]; goto FΎ; D֔֡: } public function sourceRemove($a, $Cؤŧ) { $E쏞 =& $_SERVER[]; $this->sourceModelCopyFlag = !0; $FԵ = 1; if (isset($a[$E쏞[80]])) { $FԵ = $a[$E쏞[80]][$E쏞[78]] + $a[$E쏞[80]][$E쏞[79]] + 1; } $this->update($FԵ); $this->sourceModelCopyFlag = !1; } public function sourceMove($B) { $this->sourceRemove($B, !1); } public function curlProgress($FǺܾ, $A, $A, $Dѩξ, $E̩) { $A߲ =& $_SERVER[]; $b׷ =& $this->task; if ($E̩ > 0) { $b׷[$A߲[990]] = $A߲[1512]; $b׷[$A߲[1498]] = $A߲[103]; if ($b׷[$A߲[1496]] == $Dѩξ || $Dѩξ > 1024 * 1024) { $b׷[$A߲[1497]] = $E̩; } if ($b׷[$A߲[1499]]) { $b׷[$A߲[1497]] = $E̩ + $b׷[$A߲[1499]]; } } else { if ($A > 0) { if ($b׷[$A߲[1496]] == $A) { $b׷[$A߲[1497]] = $A; $b׷[$A߲[990]] = $A߲[1513]; $b׷[$A߲[1498]] = $A߲[1050]; } } } $this->update(); } public function curlProgressStart($f) { } public function curlProgressEnd($fǎ) { $EϤ =& $_SERVER[]; $c㋆Ÿ =& $this->task; $D = curl_getinfo($fǎ); $e뇮 = $D[$EϤ[1514]]; if ($c㋆Ÿ[$EϤ[1498]] == $EϤ[103] && $e뇮) { $c㋆Ÿ[$EϤ[1499]] += $e뇮; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $aם =& $_SERVER[]; $Fީ =& $this->task; $Fީ[$aם[1515]] = 1; Hook::bind($aם[1488], array($this, $aם[1516])); Hook::bind($aם[1490], array($this, $aם[1517])); Hook::bind($aם[1492], array($this, $aם[1518])); } protected function endAfter() { $A =& $_SERVER[]; Hook::unbind($A[1488], array($this, $A[1516])); Hook::unbind($A[1490], array($this, $A[1517])); Hook::unbind($A[1492], array($this, $A[1518])); } public function progressStart($f) { $D =& $_SERVER[]; $eɩǑ = curl_getinfo($f); self::log($D[1519] . $eɩǑ[$D[295]]); self::valueSet($this->task[$D[367]], $this->task); } public function progressEnd($F腳) { $E堋 =& $_SERVER[]; self::log($E堋[1520] . $this->task[$E堋[367]]); $this->end(); } public function progress($B, $Eؚצ, $eϢ, $A, $dƲ) { $aх =& $_SERVER[]; $Dݓ =& $this->task; if ($dƲ > 0) { $Dݓ[$aх[988]] = $Dݓ[$aх[988]] == 0 ? $A : $Dݓ[$aх[988]]; $Dݓ[$aх[1000]] = $dƲ; } else { if ($eϢ > 0) { $Dݓ[$aх[988]] = $Dݓ[$aх[988]] == 0 ? $Eؚצ : $Dݓ[$aх[988]]; $Dݓ[$aх[1000]] = $eϢ; } } $this->update(); self::log("\160\x72\x6f\x67\x72\145\x73\163\110\x74\x74\160\72\144\x6f\x77\156\x3a{$eϢ}\x2f{$Eؚצ}\x3b\x20\x75\160\154\157\x61\x64\x3a{$dƲ}\57{$A}\73"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto a؏˭; bդ: Hook::bind($F򏢍[1045], array($this, $F򏢍[1523])); $D =& $this->task; $D[$F򏢍[1524]] = $F򏢍[1050]; goto aۈЬ; aۈЬ: if (!$D[$F򏢍[1355]]) { $D[$F򏢍[1355]] = LNG($F򏢍[1525]); } goto D̓; a؏˭: $F򏢍 =& $_SERVER[]; parent::startAfter(); Hook::bind($F򏢍[1521], array($this, $F򏢍[1522])); goto bդ; D̓: } protected function endAfter() { $bȱ =& $_SERVER[]; parent::endAfter(); Hook::unbind($bȱ[1521], array($this, $bȱ[1522])); Hook::unbind($bȱ[1045], array($this, $bȱ[1523])); } public function updateAfter() { $Ǎԭ =& $_SERVER[]; $a荘 =& $this->task; if (!$a荘[$Ǎԭ[988]] || !$a荘[$Ǎԭ[711]]) { return; } if ($a荘[$Ǎԭ[1524]] == $Ǎԭ[1050]) { $eų = 0; if ($a荘[$Ǎԭ[1496]]) { $eų = $a荘[$Ǎԭ[1497]] / $a荘[$Ǎԭ[1496]]; } $a荘[$Ǎԭ[1452]] = $eų * 0.3; } else { if ($a荘[$Ǎԭ[1524]] == $Ǎԭ[301]) { $eų = $a荘[$Ǎԭ[1000]] / $a荘[$Ǎԭ[988]]; $a荘[$Ǎԭ[1452]] = 0.3 + $eų * 0.4; } else { if ($a荘[$Ǎԭ[1524]] == $Ǎԭ[103]) { $c辑 = 0; if ($a荘[$Ǎԭ[1498]] == $Ǎԭ[103]) { $c辑 = $a荘[$Ǎԭ[1497]]; } $eų = ($a荘[$Ǎԭ[1501]] + $c辑) / $a荘[$Ǎԭ[711]]; $a荘[$Ǎԭ[1452]] = 0.3 + 0.4 + $eų * 0.3; } } } if ($a荘[$Ǎԭ[1452]] > 0) { $aؑ = timeFloat() - $a荘[$Ǎԭ[1454]] - $a荘[$Ǎԭ[1457]]; $a荘[$Ǎԭ[1458]] = $aؑ * (1 - $a荘[$Ǎԭ[1452]]) / $a荘[$Ǎԭ[1452]]; } } public function addFile($F) { goto eĎ; aħ: $bՉֺ[$f[988]] = 1; $aɛ = 0; $bՉֺ[$f[1505]] = array($f[1506] => $aɛ + 1, $f[386] => $Eא[$f[28]], $f[75] => $Eא[$f[75]], $f[466] => $Eא[$f[466]] ? $Eא[$f[466]] : $Eא[$f[75]]); goto fǼ; Dψ: $bՉֺ[$f[1494]] = $Eא[$f[28]]; $bՉֺ[$f[1496]] = $Eא[$f[77]]; $bՉֺ[$f[1497]] = 0; goto C; eĎ: $f =& $_SERVER[]; $bՉֺ =& $this->task; $Eא = IO::info($F); goto Dψ; C: $bՉֺ[$f[990]] = $f[1513]; $bՉֺ[$f[1498]] = $f[1050]; $bՉֺ[$f[711]] = $Eא[$f[77]]; goto aħ; fǼ: $this->update(); goto a̧; a̧: } public function unzipAfter($Dʊ) { goto C; e: $b᰹[$fɵ[1000]] = 0; $b᰹[$fɵ[1496]] = 0; $b᰹[$fɵ[1497]] = 0; goto A١; C: $c쪒ή = IO::infoWithChildren($Dʊ); $bĭ = 0; $b᰹[$fɵ[1505]] = array($fɵ[1506] => $bĭ + 1, $fɵ[386] => $c쪒ή[$fɵ[28]], $fɵ[75] => $c쪒ή[$fɵ[75]], $fɵ[466] => $c쪒ή[$fɵ[466]] ? $c쪒ή[$fɵ[466]] : $c쪒ή[$fɵ[75]]); goto Dƫ; C: $fɵ =& $_SERVER[]; $b᰹ =& $this->task; $b᰹[$fɵ[1524]] = $fɵ[103]; goto C; A١: $b᰹[$fɵ[1494]] = $fɵ[33]; $b᰹[$fɵ[1501]] = 0; $b᰹[$fɵ[711]] = $c쪒ή[$fɵ[77]]; goto f; Dƫ: if ($c쪒ή[$fɵ[29]] == $fɵ[167]) { $b᰹[$fɵ[988]] = 1; } else { $b᰹[$fɵ[988]] = $c쪒ή[$fɵ[80]][$fɵ[78]]; } $b᰹[$fɵ[990]] = $fɵ[33]; $b᰹[$fɵ[1498]] = 0; goto e; f: $this->update(); self::log($fɵ[1526] . json_encode(array($b᰹, $c쪒ή))); goto cزۄ; cزۄ: } public function nameParse($fʅӿ) { goto F᱂; Fɝ: $C݈ƿ = get_path_this($fʅӿ); if (strstr($C݈ƿ, $e[91])) { $D蘶[$e[1000]] += 1; $D蘶[$e[988]] += 1; } $D蘶[$e[1494]] = $fʅӿ; goto c; F᱂: $e =& $_SERVER[]; $D蘶 =& $this->task; if ($D蘶[$e[1524]] == $e[1050]) { $D蘶[$e[1524]] = $e[301]; $D蘶[$e[1501]] = 0; $D蘶[$e[711]] = 0; } goto Fɝ; c: $this->update(); goto Aз; Aз: } } goto e; E̋ه: define($_SERVER[][1947], 2); define($_SERVER[][1948], 3); define($_SERVER[][1949], 4); goto Bөÿ; c޹: function Action($bק = '') { goto aѕ; bҔƋ: if (isset($f[$D𚶟])) { return $f[$D𚶟]; } $bק = trim(str_replace($d[4], $d[5], $bק), $d[4]); $dɘ = explode($d[5], $bק); goto a⼅; d㖐ރ: if (isset($f[$AዏՕ])) { return $f[$AዏՕ]; } if (is_file($c䕖)) { include_once $c䕖; } if (!class_exists($Fʧ)) { return actionCallError("\133{$bק}\40\75\x3e\40{$Fʧ}\135\x20\x63\154\x61\x73\x73\x20\x6e\x6f\x74\x20\145\170\x69\x73\x74\163\x21"); } goto dșŰ; a⼅: $Fů۷ = strtolower($dɘ[0]); if (substr($Fů۷, -6) == $d[6]) { $bק = substr($dɘ[0], 0, -6); $Fʧ = $bק . $d[7]; $c䕖 = $d[8]; if (isset($dɘ[1]) && substr(strtolower($dɘ[1]), -5) == $d[9]) { $Fʧ = $bק . $dɘ[1]; $c䕖 = $d[10] . $dɘ[1] . $d[11]; } else { if (count($dɘ) == 3) { $Fʧ = $bק . $dɘ[1] . $dɘ[2]; $c䕖 = $d[12] . $dɘ[1] . $d[13] . $dɘ[2] . $d[11]; } } $c䕖 = PLUGIN_DIR . $bק . $d[4] . $c䕖; } else { if (substr($Fů۷, -5) == $d[9]) { $bק = substr($dɘ[0], 0, -5); return Model($bק); } else { $Fʧ = $dɘ[0] . $dɘ[1]; $c䕖 = CONTROLLER_DIR . $dɘ[0] . $d[4] . $dɘ[1] . $d[14]; } } $AዏՕ = strtolower($Fʧ); goto d㖐ރ; aѕ: $d =& $_SERVER[]; static $f = array(); $D𚶟 = $bק; goto bҔƋ; dșŰ: $f[$AዏՕ] = new $Fʧ(); $f[$D𚶟] = $f[$AዏՕ]; return $f[$AዏՕ]; goto e; e: } function ActionApply($c, $BѪ = array()) { goto Ă; D긏: $F֗о = substr($c, 0, $A); $A = substr($c, $A + 1); $A = Action($F֗о); goto D盐; Ă: if (is_array($c)) { return call_user_func_array($c, $BѪ); } if (function_exists($c)) { return call_user_func_array($c, $BѪ); } $A = strrpos($c, $_SERVER[][5]); goto D긏; D盐: if (!method_exists($A, $A)) { return actionCallError("{$c}\40\x6d\x65\x74\150\x6f\x64\40\156\x6f\164\40\x65\x78\151\163\164\163\41"); } $c = call_user_func_array(array($A, $A), $BѪ); return $c; goto Bѕ; Bѕ: } function actionCallError($AƜ) { $C子̛ =& $_SERVER[]; $fɇ = json_encode_force(array($C子̛[15] => this_url(), $C子̛[16] => $GLOBALS[$C子̛[16]])); $fɇ = str_replace(array($C子̛[17]), array($C子̛[4]), $fɇ); return write_log($AƜ . $C子̛[18] . $fɇ, $C子̛[19]); } goto A¿; c: function beforeShutdown() { Hook::trigger($_SERVER[][36]); } $_SERVER[$_SERVER[][37]] = BASIC_PATH; $_SERVER[$_SERVER[][38]] = LIB_DIR; goto A; FӧŲ: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $Fڡ =& $_SERVER[]; $dг = array(array($Fڡ[386] => LNG($Fڡ[2119]), $Fڡ[2120] => $Fڡ[2121], $Fڡ[2122] => 6, $Fڡ[2123] => 1, $Fڡ[2124] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Fڡ[386] => LNG($Fڡ[2125]), $Fڡ[2120] => $Fڡ[2126], $Fڡ[2122] => 1, $Fڡ[2123] => 1, $Fڡ[2124] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fڡ[386] => LNG($Fڡ[2127]), $Fڡ[2120] => $Fڡ[2128], $Fڡ[2122] => 2, $Fڡ[2123] => 1, $Fڡ[2124] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fڡ[386] => LNG($Fڡ[2129]), $Fڡ[2120] => $Fڡ[2128], $Fڡ[2122] => 3, $Fڡ[2123] => 1, $Fڡ[2124] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fڡ[386] => LNG($Fڡ[2130]), $Fڡ[2120] => $Fڡ[2131], $Fڡ[2122] => 4, $Fڡ[2123] => 1, $Fڡ[2124] => self::AUTH_SHOW | self::AUTH_VIEW), array($Fڡ[386] => LNG($Fڡ[2132]), $Fڡ[2120] => $Fڡ[2133], $Fڡ[2122] => 5, $Fڡ[2123] => 1, $Fڡ[2124] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Fڡ[386] => LNG($Fڡ[2134]), $Fڡ[2120] => $Fڡ[2135], $Fڡ[2122] => 7, $Fڡ[2123] => 1, $Fڡ[2124] => 0)); return $dг; } public static function authCheck($B, $cҊ) { $B = intval($B); if (_get($GLOBALS, $_SERVER[][457])) { return !0; } if ($B <= 0) { return !1; } if (($B & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($B & $cҊ); } public static function authCheckShow($C) { return self::authCheck($C, self::AUTH_SHOW); } public static function authCheckView($D) { return self::authCheck($D, self::AUTH_VIEW); } public static function authCheckDownload($F) { return self::authCheck($F, self::AUTH_DOWNLOAD); } public static function authCheckUpload($Aԋ) { return self::authCheck($Aԋ, self::AUTH_UPLOAD); } public static function authCheckEdit($Cψߠ) { return self::authCheck($Cψߠ, self::AUTH_EDIT); } public static function authCheckRemove($Cϟ) { return self::authCheck($Cϟ, self::AUTH_REMOVE); } public static function authCheckShare($cʊ) { return self::authCheck($cʊ, self::AUTH_SHARE); } public static function authCheckComment($d) { return self::authCheck($d, self::AUTH_COMMENT); } public static function authCheckEvent($D) { return self::authCheck($D, self::AUTH_EVENT); } public static function authCheckRoot($eΎ) { return self::authCheck($eΎ, self::AUTH_ROOT); } public static function authDisable($a叄, $b) { if (intval($a叄) <= 0) { return 0; } return intval($a叄) & ~$b; } public $optionType = "\123\x79\163\x74\x65\155\x2e\x73\157\x75\x72\143\x65\101\x75\x74\x68\x4c\151\163\164"; public $field = array("\156\141\x6d\x65", "\x61\165\x74\150", "\154\141\x62\x65\154", "\144\151\163\x70\x6c\141\171", "\x73\171\163\x74\x65\155", "\x73\157\162\164"); public function initData() { $aŇ = $this->authDefault(); foreach ($aŇ as $D俸ٰ) { $this->add($D俸ٰ); } } public function listData($Fɺ = false, $a = "\x73\x6f\162\x74", $DƟ = false) { return parent::listData($Fɺ, $a, $DƟ); } public function update($DËɜ, $CǄ) { $Bٕ =& $_SERVER[]; $Bے = parent::listData($DËɜ); $cٷل = $this->findByName($CǄ[$Bٕ[28]]); if (!$Bے || $cٷل && $cٷل[$Bٕ[367]] != $Bے[$Bٕ[367]]) { return !1; } $this->filterAuth($CǄ[$Bٕ[376]]); return parent::update($DËɜ, $CǄ); } public function remove($fΖ) { $eߝ܌ = parent::listData($fΖ); if (!$eߝ܌ || $eߝ܌[$_SERVER[][1090]]) { return !1; } return parent::remove($fΖ); } public function add($D = array()) { goto Eί; A: return parent::insert($D); goto eԃۃ; fܣ: $D = array_merge($b֔, $D); $D[$a[2139]] = $this->getSort(); $this->filterAuth($D[$a[376]]); goto A; Eί: $a =& $_SERVER[]; if ($this->findByName($D[$a[28]])) { return !1; } $b֔ = array($a[28] => $a[33], $a[376] => 1, $a[2136] => $a[2137], $a[2138] => 1, $a[1090] => 0, $a[2139] => 0); goto fܣ; eԃۃ: } private function getSort() { $c =& $_SERVER[]; $fҢ = parent::listData(); $Aۋݮ = array_to_keyvalue($fҢ, $c[33], $c[2139]); return empty($Aۋݮ) ? 0 : max($Aۋݮ) + 1; } private function filterAuth(&$Eٔю) { goto f; aɜʄ: foreach ($A as $fՂѠ) { if ($Eٔю & $fՂѠ) { $D̛[] = $fՂѠ; } } if (in_array(self::AUTH_ROOT, $D̛)) { $Eٔю = array_sum($A); return; } $aѲ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto D; D: foreach ($D̛ as $fՂѠ) { if (isset($aѲ[$fՂѠ])) { $D̛ = array_merge($D̛, $aѲ[$fՂѠ]); } } $D̛[] = self::AUTH_SHOW; $Eٔю = array_sum(array_unique($D̛)); goto cº; f: if (!$Eٔю) { return; } $A = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $D̛ = array(); goto aɜʄ; cº: } public function sort($Cߴ, $b) { return parent::update($Cߴ, $b); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\155\56\142\141\143\x6b\x75\x70\114\x69\x73\164"; public $field = array("\x69\x6f", "\156\141\x6d\145", "\163\x74\x61\x74\x75\163", "\143\157\156\164\145\156\164", "\162\x65\163\165\x6c\x74", "\164\x69\x6d\145\x46\162\157\x6d", "\164\151\155\145\124\157"); public function config() { goto Cل; c: Action($b[2140])->taskInit(); $fШ = Model($b[2141])->listData(); foreach ($fШ as $BŮ) { if ($BŮ[$b[1090]] == $b[83] && $BŮ[$b[1439]] == $b[2142]) { $FԲ = $BŮ; break; } } goto AƂ; AƂ: if (isset($FԲ[$b[190]])) { $FԲ[$b[190]] = json_decode($FԲ[$b[190]], !0); } if (isset($c焆[$b[190]])) { $FԲ[$b[190]][$b[1426]] = $c焆[$b[190]]; unset($c焆[$b[190]]); } return array_merge($FԲ, $c焆); goto eҳ녘; Cل: $b =& $_SERVER[]; $c焆 = Model($b[1098])->get($b[727]); $c焆 = json_decode($c焆, !0); goto a˕Ǔ; a˕Ǔ: $c焆 = is_array($c焆) ? $c焆 : array(); if (!isset($c焆[$b[705]])) { $c焆[$b[705]] = $b[468]; } $FԲ = array(); goto c; eҳ녘: } public function listData($E糖 = false, $D˓ = "\155\x6f\144\x69\x66\x79\124\x69\x6d\145", $Aܦ = false) { return parent::listData($E糖, $D˓, !0); } public function lastItem() { $eǛǨ = $this->listData(); return !empty($eǛǨ[0]) ? $eǛǨ[0] : null; } public function kill($Eȇۧ) { goto E; E򕌌ʜ: return $this->remove($Eȇۧ); goto Cǣð; E: $C =& $_SERVER[]; $aǏ = $this->listData($Eȇۧ); if (!$aǏ || empty($aǏ[$C[28]])) { return !0; } goto B̴ʖو; C: $Bل = $aǏ[$C[28]]; $AӉ = TEMP_FILES . $C[723] . $Bل . $C[8]; IO::remove($AӉ, !1); goto E򕌌ʜ; B̴ʖو: Task::kill($C[726]); Task::kill($C[742]); Task::kill($C[750]); goto C; Cǣð: } public function remove($E) { $c = $this->listData($E); if (!$c) { return !0; } return $this->backupRemove($c); } private function backupRemove($cܦ׉) { $B =& $_SERVER[]; parent::remove($cܦ׉[$B[367]]); $c = "\x7b\x69\x6f\x3a{$cܦ׉[$B[704]]}\175\x2f\144\x61\x74\141\x62\x61\163\x65\57\x62\x61\x63\x6b\165\160\137" . $cܦ׉[$B[28]]; IO::remove($c, !1); return !0; } public function start() { goto dҎ; A弍: if (!$e܇׉ || $e܇׉[$CйȽ[1423]] != $CйȽ[83]) { return !1; } $c݈ = $this->process(); foreach ($c݈ as $cӋ) { if ($cӋ) { return Task::restart($cӋ[$CйȽ[367]]); } } goto F; Aް: if (!$dˍ->dbFile()) { return !1; } if ($e܇׉[$CйȽ[705]] == $CйȽ[468]) { $dˍ->file(); } Backup::set(array($CйȽ[702] => 1, $CйȽ[716] => time())); goto E; dҎ: $CйȽ =& $_SERVER[]; if ($GLOBALS[$CйȽ[6]][$CйȽ[84]][$CйȽ[2143]] != $CйȽ[83]) { return !0; } $e܇׉ = $this->config(); goto A弍; E: return !0; goto B䠗; F: $dˍ = new Backup(); $dˍ->keep(); if (!$dˍ->db()) { return !1; } goto Aް; B䠗: } public function process() { $bɌ =& $_SERVER[]; return array($bɌ[707] => Task::get($bɌ[726]), $bɌ[710] => Task::get($bɌ[742]), $bɌ[167] => Task::get($bɌ[750])); } public function restore() { $d =& $_SERVER[]; ActionCall($d[2144], !0, 1); ActionCall($d[2144], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\155\x6d\x65\x6e\164"; protected $tableMeta = array("\x74\x61\x62\154\x65\x4e\x61\155\x65" => "\x63\x6f\x6d\155\145\156\164\137\155\x65\164\x61", "\x6d\145\x74\141\106\x69\x65\x6c\144" => "\x63\157\155\155\145\156\x74\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($f꘳) { $d箭 =& $_SERVER[]; if ($f꘳[$d箭[2145]]) { $D㭫 = $this->where(array($d箭[2146] => $f꘳[$d箭[2145]]))->find(); if (!$D㭫 || $D㭫[$d箭[371]] != $f꘳[$d箭[371]] || $D㭫[$d箭[456]] != $f꘳[$d箭[456]]) { return !1; } $this->where(array($d箭[2146] => $f꘳[$d箭[2145]]))->setAdd($d箭[2147], 1); } return $this->add($f꘳); } public function remove($c΋ܙ) { $F =& $_SERVER[]; $e = array($F[2146] => $c΋ܙ); $cբҦ = $this->where($e)->find(); if ($cբҦ[$F[2145]]) { $this->where(array($F[2146] => $cբҦ[$F[2145]]))->setAdd($F[2147], -1); } return $this->where($e)->delete(); } public function edit($Fդ̆, $b諉) { $C =& $_SERVER[]; $EĨ = array($C[2146] => $Fդ̆); return $this->where($EĨ)->save(array($C[2148] => $b諉)); } public function prasise($Dݑ) { $dկ =& $_SERVER[]; $Fز = Model($dկ[2149]); $dކσ = array($dկ[2146] => $Dݑ, $dկ[1442] => USER_ID); $dчʊ = $Fز->where($dކσ)->find(); if (!$dчʊ) { $Fز->add($dކσ); $Eع = $this->where(array($dկ[2146] => $Dݑ))->setAdd($dկ[2150], 1); } else { $Fز->where($dކσ)->delete(); $Eع = $this->where(array($dկ[2146] => $Dݑ))->setAdd($dկ[2150], -1); } return $Eع; } public function targetInfo($C̤, $cҪ) { goto fՓ; EϜ: $Dڑ = "\x52\111\107\x48\x54\40\112\117\111\116\40{$this->tablePrefix}\143\157\x6d\x6d\145\156\164\137\x70\162\x61\151\163\145\40\163\164\x61\162\x20\157\156\40\x63\157\x6d\155\x65\x6e\x74\56\143\157\x6d\x6d\145\156\164\x49\x44\40\75\40\163\x74\x61\x72\x2e\x63\157\x6d\155\x65\x6e\x74\111\x44"; $Dʑ = $this->alias($Dو[341])->where($Fǧʇ)->join($Dڑ, $Dو[2151])->count(); $FÙŌ = array($Dو[2152] => $E, $Dو[2153] => $Dʑ); goto c˳ț; c˳ț: return $FÙŌ; goto CϠ; fՓ: $Dو =& $_SERVER[]; $Fǧʇ = array($Dو[521] => $C̤, $Dو[522] => $cҪ); $E = $this->where($Fǧʇ)->count(); goto EϜ; CϠ: } public function listData($cީ) { $bƆ =& $_SERVER[]; if (isset($cީ[$bƆ[2154]])) { if ($cީ[$bƆ[2154]]) { $cީ[$bƆ[2155]] = array($bƆ[940], intval($cީ[$bƆ[2154]])); } unset($cީ[$bƆ[2154]]); } if (isset($cީ[$bƆ[2156]])) { if ($cީ[$bƆ[2156]]) { $cީ[$bƆ[2155]] = array($bƆ[937], intval($cީ[$bƆ[2156]])); } unset($cީ[$bƆ[2156]]); } return $this->_listData($cީ); } private function _listData($e) { $E։ =& $_SERVER[]; $a۟Ŋ = $this->where($e)->_makeOrder()->selectPage(100); $this->_listAppendParent($a۟Ŋ[$E։[354]]); $this->_listAppendUser($a۟Ŋ[$E։[354]]); $this->_listAppendMeta($a۟Ŋ[$E։[354]]); return $a۟Ŋ; } private function _makeOrder() { $Cצތ =& $_SERVER[]; $A = array($Cצތ[2150], $Cצތ[2147], $Cצތ[187]); $bڵ = Input::get($Cצތ[407], $Cצތ[7], $Cצތ[389], $A); $a = Input::get($Cצތ[408], $Cצތ[7], $Cצތ[1444], array($Cצތ[2157], $Cצތ[405])); $B = $bڵ . $Cצތ[50] . $a; return $this->order($B); } private function _listAppendParent(&$eΆ) { goto bω; dɻ: if (!$cՍĭ) { return; } $e = $this->where(array($bԚƌ[2146] => array($bԚƌ[7], $cՍĭ)))->select(); $e = array_to_keyvalue($e, $bԚƌ[2155]); goto bү; bү: foreach ($eΆ as &$Bӵ) { if (isset($e[$Bӵ[$bԚƌ[2145]]])) { $Bӵ[$bԚƌ[2158]] = $e[$Bӵ[$bԚƌ[2145]]]; } } goto B; bω: $bԚƌ =& $_SERVER[]; $cՍĭ = array_unique(array_to_keyvalue($eΆ, $bԚƌ[33], $bԚƌ[2145])); $cՍĭ = array_remove_value($cՍĭ, $bԚƌ[468]); goto dɻ; B: } private function _listAppendUser(&$d) { goto e; aԴ: if (count($a鰶) == 0) { return; } foreach ($d as $Eۄ) { if (isset($Eۄ[$b䇷[2158]])) { $a鰶[] = $Eۄ[$b䇷[2158]][$b䇷[1451]]; } } $dڐ = Model($b䇷[477])->userListInfo($a鰶); goto F۰; F۰: foreach ($d as &$Eۄ) { $Eۄ[$b䇷[535]] = $dڐ[$Eۄ[$b䇷[1451]]]; if (isset($Eۄ[$b䇷[2158]])) { $Eۄ[$b䇷[2158]][$b䇷[535]] = $dڐ[$Eۄ[$b䇷[2158]][$b䇷[1451]]]; } } goto cϿ뇋; e: $b䇷 =& $_SERVER[]; $a鰶 = array_unique(array_to_keyvalue($d, $b䇷[33], $b䇷[1451])); $a鰶 = array_remove_value($a鰶, $b䇷[468]); goto aԴ; cϿ뇋: } private function _listAppendMeta(&$DǕ) { goto E򂌠; eߝ⶘: if (!$Eתތ) { return; } foreach ($DǕ as $ǎ̛) { if (isset($ǎ̛[$bǍꍣ[2158]])) { $Eתތ[] = $ǎ̛[$bǍꍣ[2158]][$bǍꍣ[2155]]; } } $dз = $this->metaList($Eתތ); goto fй; E򂌠: $bǍꍣ =& $_SERVER[]; $Eתތ = array_unique(array_to_keyvalue($DǕ, $bǍꍣ[33], $bǍꍣ[2155])); $Eתތ = array_remove_value($Eתތ, $bǍꍣ[468]); goto eߝ⶘; fй: if (!$dз) { return !1; } foreach ($DǕ as &$ǎ̛) { $ǎ̛[$bǍꍣ[417]] = $dз[$ǎ̛[$bǍꍣ[2155]]]; if (isset($ǎ̛[$bǍꍣ[2158]])) { $ǎ̛[$bǍꍣ[2158]][$bǍꍣ[417]] = $dз[$ǎ̛[$bǍꍣ[2158]][$bǍꍣ[2155]]]; } } goto DȚҚÜ; DȚҚÜ: } private function metaList($B) { goto AО; EʴТ: return $Bٗ ? $Bٗ : array(); goto A؊; B: $Bٗ = Model($a䌲[2159])->where($d)->select(); $Bٗ = array_to_keyvalue_group($Bٗ, $a䌲[2155]); foreach ($Bٗ as $a => $cǺ) { $aɒ = array(); foreach ($cǺ as $B½) { $aɒ[$B½[$a䌲[89]]] = $B½[$a䌲[359]]; } $Bٗ[$a] = $aɒ; } goto EʴТ; AО: $a䌲 =& $_SERVER[]; if (!$B) { return array(); } $d = array($a䌲[2155] => array($a䌲[7], $B)); goto B; A؊: } } goto e͙; Aȑ: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $D窵գ =& $_SERVER[]; self::$name = date($D窵գ[700]); if (!($C냴ƨ = Model($D窵գ[701])->lastItem())) { $C냴ƨ = $this->initData(); } else { self::$name = $C냴ƨ[$D窵գ[28]]; if ($C냴ƨ[$D窵գ[702]] == $D窵գ[83]) { self::$name = date($D窵գ[703]); $C⬧ = 0; if (isset($C냴ƨ[$D窵գ[281]][$D窵գ[167]][$D窵գ[419]])) { $C⬧ = (int) $C냴ƨ[$D窵գ[281]][$D窵գ[167]][$D窵գ[419]]; } if ($C냴ƨ[$D窵գ[28]] == self::$name) { Model($D窵գ[701])->remove($C냴ƨ[$D窵գ[367]]); } $C냴ƨ = $this->initData($C⬧, $C냴ƨ[$D窵գ[704]]); } else { $this->checkStore($C냴ƨ[$D窵գ[704]]); } } self::$option = $C냴ƨ; } private function initData($cȎ = 0, $Bǵ = '') { goto eʇ; eʇ: $Ağ =& $_SERVER[]; $eՍޚ = Model($Ağ[701])->config(); if ($Bǵ && $eՍޚ[$Ağ[704]] != $Bǵ) { $cȎ = 0; } goto e; a᭩: $Eۄ؊[$Ağ[367]] = $e; return $Eۄ؊; goto d皴; e: $this->checkStore($eՍޚ[$Ağ[704]]); $Eۄ؊ = array($Ağ[704] => $eՍޚ[$Ağ[704]], $Ağ[28] => self::$name, $Ağ[702] => 0, $Ağ[705] => $eՍޚ[$Ağ[705]], $Ağ[281] => array($Ağ[706] => array($Ağ[702] => 0), $Ağ[707] => array($Ağ[702] => 0, $Ağ[708] => 0, $Ağ[709] => 0, $Ağ[29] => $Ağ[33]), $Ağ[710] => array($Ağ[702] => 0, $Ağ[708] => 0, $Ağ[709] => 0), $Ağ[167] => array($Ağ[702] => 0, $Ağ[711] => 0, $Ağ[712] => 0, $Ağ[713] => 0, $Ağ[714] => 0, $Ağ[419] => $cȎ)), $Ağ[715] => time(), $Ağ[716] => 0); $e = Model($Ağ[701])->insert($Eۄ؊); goto a᭩; d皴: } private function checkStore($e 卛) { $aޯ =& $_SERVER[]; $e = Model($aޯ[717])->listData($e 卛); Model($aޯ[717])->checkConfig($e); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[][701])->findByName(self::$name); } return self::$option; } public static function set($BŎ) { $fЊ =& $_SERVER[]; $f߹ = self::get(); foreach ($BŎ as $eߙ => $Fʦզϥ) { $b郒ߥ = explode($fЊ[91], $eߙ); $b许 = count($b郒ߥ); switch ($b许) { case 1: $f߹[$b郒ߥ[0]] = $Fʦզϥ; break; case 2: $f߹[$b郒ߥ[0]][$b郒ߥ[1]] = $Fʦզϥ; break; case 3: $f߹[$b郒ߥ[0]][$b郒ߥ[1]][$b郒ߥ[2]] = $Fʦզϥ; break; } } Model($fЊ[701])->update($f߹[$fЊ[367]], $f߹); self::$option = $f߹; return self::$option; } public function keep() { $fʡɢ =& $_SERVER[]; $e = self::get(); if ($e[$fʡɢ[281]][$fʡɢ[706]][$fʡɢ[702]] == $fʡɢ[83]) { return; } $this->backupKeep($e); self::set(array($fʡɢ[718] => 1)); } private function backupKeep($Dʷǳ) { goto Dౡ; Dౡ: $F㤌 =& $_SERVER[]; $C양 = Model($F㤌[701])->listData(); if (empty($C양)) { return; } goto dԡݙ; B: for ($cߌ = 0; $cߌ < 12; $cߌ++) { $eǣ[] = date($F㤌[719], strtotime("\x2d{$cߌ}\x20\x6d\x6f\x6e\164\150\x73")); } $eǣ = array_unique($eǣ); foreach ($C양 as $cゆ) { if (!empty($cゆ[$F㤌[28]]) && in_array($cゆ[$F㤌[28]], $eǣ)) { continue; } Model($F㤌[701])->remove($cゆ[$F㤌[367]]); $BԾ = "\173\151\x6f\72{$Dʷǳ[$F㤌[704]]}\175\57\x64\x61\164\141\x62\x61\163\145\x2f\x62\x61\x63\x6b\x75\x70\137{$cゆ[$F㤌[28]]}"; IO::remove($BԾ, !1); } goto FƐ; dԡݙ: $cߌ = 0; $eǣ = array(); foreach ($C양 as $cゆ) { if ($cߌ >= 7) { break; } $eǣ[] = $cゆ[$F㤌[28]]; $cߌ++; } goto B; FƐ: } public function db() { goto AŤ; AŤ: $D൹ =& $_SERVER[]; $b͝Ʌ = self::get(); if ($b͝Ʌ[$D൹[281]][$D൹[707]][$D൹[702]] == $D൹[83]) { return !0; } goto cξ; cξ: $B = new BackupDb(); if (!$B->index()) { return !1; } self::set(array($D൹[720] => 1)); goto B𜲓; B𜲓: return !0; goto Dǎ䒩; Dǎ䒩: } public function dbFile() { goto fӂ; c߄: return !0; goto eክΎ; Bә: $bࡻ = new BackupDbFile(); if (!$bࡻ->index()) { return !1; } self::set(array($bČ[721] => 1)); goto c߄; fӂ: $bČ =& $_SERVER[]; $D΄ = self::get(); if ($D΄[$bČ[281]][$bČ[710]][$bČ[702]] == $bČ[83]) { return !0; } goto Bә; eክΎ: } public function file() { $E =& $_SERVER[]; $F = self::get(); if ($F[$E[281]][$E[167]][$E[702]] == $E[83]) { return !0; } if (!isset($F[$E[705]]) || $F[$E[705]] == $E[468]) { $fЂ = new BackupFile(); if (!$fЂ->index()) { return !1; } } self::set(array($E[722] => 1, $E[702] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto f; f: $D׮߱ =& $_SERVER[]; $a = Backup::get(); self::$io = $a[$D׮߱[704]]; goto B; A: $B򡨉 = new DbManage($c⬽, $FՅ); $b = TEMP_FILES . $D׮߱[723] . self::$name . $D׮߱[8]; del_dir($b); goto b; E։: Backup::set($A); return !0; goto c; B: self::$name = $a[$D׮߱[28]]; $c⬽ = $GLOBALS[$D׮߱[6]][$D׮߱[17]]; $FՅ = $this->_dbType($c⬽); goto A; eǢ: foreach ($cƤ as $Eʅ) { $aߊ = $b . $Eʅ . $D׮߱[731]; $A؊ڽ = null; if ($Eʅ == $D׮߱[732] && (!isset($a[$D׮߱[705]]) || $a[$D׮߱[705]] == $D׮߱[468])) { $A؊ڽ = self::$io; } $dۊ += $B򡨉->sqlFromDb($Eʅ, $aߊ, $B݄, $A؊ڽ); } $B݄->end(); $A = array($D׮߱[733] => $FՅ, $D׮߱[720] => 1, $D׮߱[734] => $dۊ, $D׮߱[735] => $dۊ); goto E։; a۰: $cƤ = array_diff($cƤ, array($D׮߱[724], $D׮߱[725])); foreach ($cƤ as $Eʅ) { $E΅ += $B򡨉->model($Eʅ)->count(); } $B݄ = new Task($D׮߱[726], $D׮߱[727], $E΅, LNG($D׮߱[728]) . $D׮߱[729] . LNG($D׮߱[730])); goto eǢ; b: mk_dir($b); $E΅ = $dۊ = 0; $cƤ = $B򡨉->db()->getTables(); goto a۰; c: } private function _dbType($C) { goto Cٗ; bɉ: return $f; goto aۑ; Bç: if ($f == $a䈲[737]) { $Fͅވ = explode($a䈲[4], $C[$a䈲[738]]); $f = $Fͅވ[0]; } $Aᶾ = array($a䈲[739] => $a䈲[9], $a䈲[740] => $a䈲[741]); if (isset($Aᶾ[$f])) { $f = $Aᶾ[$f]; } goto bɉ; Cٗ: $a䈲 =& $_SERVER[]; $C = array_change_key_case($C); $f = $C[$a䈲[736]]; goto Bç; aۑ: } } class BackupDbFile { public function __construct() { } public function index() { goto Fݞސ; Fݞސ: $C =& $_SERVER[]; $eٴ = Backup::get(); $e۔ = $eٴ[$C[28]]; goto F; F: $f˔ = TEMP_FILES . "\x62\141\x63\x6b\165\x70\x5f{$e۔}\57"; $b° = "\x7b\151\157\72{$eٴ[$C[704]]}\175\57\x64\x61\x74\x61\x62\141\x73\x65\57"; IO::mkdir($b° . "\142\141\143\x6b\165\x70\137{$e۔}\x2f"); goto A; A繑: $f˻ = CONTROLLER_DIR . $C[746]; IO::copy($cδ˷, $b° . "\142\141\143\153\x75\160\x5f{$e۔}\57"); IO::copy($f˻, $b° . "\142\x61\143\153\x75\x70\137{$e۔}\x2f"); goto F狆; BƊ: Backup::set(array($C[744] => $E˵[$C[77]])); IO::move($f˔, $b°); $cδ˷ = CONTROLLER_DIR . $C[745]; goto A繑; A: $bм = new TaskFileTransfer($C[742], $C[727], 0, LNG($C[728]) . $C[412] . LNG($C[730]) . $C[743]); $bм->addPath($f˔); $E˵ = IO::infoWithChildren($f˔); goto BƊ; F狆: $bм->end(); Backup::set(array($C[747] => $E˵[$C[77]])); return !0; goto f; f: } } goto Eԅ; E: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($DԂ) { $this->pathParse = $DԂ; } protected function infoParse($f, $E礉 = false) { $b濞 =& $_SERVER[]; return Action($b濞[1027])->sharePathInfo($this->pathParse[$b濞[75]], !0, $E礉); } public function listPath($D̗, $fߍە = false) { $Dق =& $_SERVER[]; $Fĸ = IO::listPath($D̗, $fߍە); foreach ($Fĸ as $d纍 => $cؖ) { if (!in_array($d纍, array($Dق[73], $Dق[74]))) { continue; } foreach ($cؖ as $Cݻ => $Bϯ) { $Bϯ = Action($Dق[1142])->parsePathChildren($Bϯ, array($Dق[387] => $D̗)); $Fĸ[$d纍][$Cݻ] = Action($Dق[1027])->shareItemInfo($Bϯ); } } return $Fĸ; } public function listAll($EǼ˛) { $cӄ =& $_SERVER[]; $cؿ = IO::listAll($EǼ˛); foreach ($cؿ as &$fĮ) { $fĮ = array_merge(IO::info($fĮ[$cӄ[75]]), $fĮ); $fĮ[$cӄ[391]] = Action($cӄ[1027])->shareItemInfo($fĮ); } return $cؿ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($A) { parent::__construct($A); $this->signatureVersion($_SERVER[][200]); } public function uploadFormData($Aƫ, $d = 3600) { goto aʲ; aʲ: $d눹 =& $_SERVER[]; $e͋ = $d눹[185]; $a = $d눹[1143]; goto fҍ; fҍ: $aҍ = $d눹[59]; $a߆ = gmdate($d눹[1144]); $CН = gmdate($d눹[703]); goto eϡ; c틓: $cҰ͊ = base64_encode(json_encode($A)); $cۅ = hash_hmac($d눹[1153], $CН, $d눹[1154] . $this->secret, !0); $eӃ = hash_hmac($d눹[1153], $this->region, $cۅ, !0); goto CҲ; eϡ: $F = $d눹[1145]; $d񷹝 = $d . $d눹[33]; $cɭ = $d눹[1110]; goto c; CҲ: $Cݺ = hash_hmac($d눹[1153], $aҍ, $eӃ, !0); $F = hash_hmac($d눹[1153], $F, $Cݺ, !0); $fǐ = hash_hmac($d눹[1153], $cҰ͊, $F); goto fّ֕; fّ֕: $F = array($d눹[199] => $d눹[33], $d눹[1155] => $d눹[33], $d눹[1114] => $e͋, $d눹[1118] => $cɭ, $d눹[1122] => $cҰ͊, $d눹[1156] => $e͜, $d눹[1157] => $a, $d눹[1158] => $a߆, $d눹[1159] => $d񷹝, $d눹[1160] => $fǐ, $d눹[169] => $this->getHost()); return $F; goto aƥ; c: $E涃 = array($this->accessKey, $CН, $this->region, $aҍ, $F); $e͜ = implode($d눹[8], $E涃); $A = array($d눹[1112] => gmdate($d눹[1111], strtotime($d눹[1146])), $d눹[1113] => array(array($d눹[1115] => $this->bucket), array($d눹[1114] => $e͋), array($d눹[1116], $d눹[1117], $d눹[33]), array($d눹[1116], $d눹[1147], $d눹[33]), array($d눹[1116], $d눹[1148], $d눹[33]), array($d눹[1118] => $cɭ), array($d눹[1149] => $e͜), array($d눹[1150] => $a), array($d눹[1151] => $a߆), array($d눹[1152] => $d񷹝))); goto c틓; aƥ: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = FALSE; public function __construct($d썛) { parent::__construct(); if (count($d썛) > 0) { $this->_init($d썛); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($eȚ) { $fվ =& $_SERVER[]; global $config; $this->appCharset = $config[$fվ[1161]]; $this->systemCharset = $config[$fվ[1162]]; if (isset($eȚ[$fվ[1163]]) && $eȚ[$fվ[1163]]) { $this->systemCharset = $eȚ[$fվ[1163]]; } } public function iconvApp($F) { return $this->iconvTo($F, $this->systemCharset, $this->appCharset); } public function iconvSystem($cϋ) { return $this->iconvTo($cϋ, $this->appCharset, $this->systemCharset); } public function getPathOuter($b) { goto C侅; d脆: return $this->pathDriver . $D㝲[8] . ltrim($b, $D㝲[8]); goto d; C: if (substr($B얙, 0, 2) == $D㝲[1164]) { $B얙 = BASIC_PATH . substr($B얙, 2); } if (substr($b, 0, 2) == $D㝲[1164]) { $b = BASIC_PATH . substr($b, 2); } $B얙 = KodIO::clear($B얙); goto eƢᆠ; C侅: $D㝲 =& $_SERVER[]; $B얙 = $this->iconvApp($this->pathBase); $b = $this->iconvApp($b); goto C; eƢᆠ: $b = KodIO::clear($b); $b = substr($b, strlen($B얙)); if (empty($this->pathDriver)) { return $b; } goto d脆; d: } private function _init($AϐԆ = array()) { goto Dǫ; d: $aϠɝ = isset($eɼ[$Cچ[168]]) && $eɼ[$Cچ[168]] == $Cچ[1167] ? !0 : !1; $this->scheme = $aϠɝ ? $Cچ[1168] : $Cچ[1169]; $this->port = isset($eɼ[$Cچ[170]]) ? $eɼ[$Cچ[170]] : 21; goto BɎ; BɎ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return; } $dʡ = @ftp_login($this->connect, $this->username, $this->userpass); goto D˃; Dǫ: $Cچ =& $_SERVER[]; if (!function_exists($Cچ[1165])) { show_json(LNG($Cچ[1166]), !1); } $this->charsetReset($AϐԆ); goto bʃ; D˃: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); @ftp_pasv($this->connect, !0); $eَ[$dۇ] = array($Cچ[1170] => $this->connect, $Cچ[169] => $this->host, $Cچ[168] => $this->scheme, $Cچ[170] => $this->port); goto d꿠; bʃ: foreach ($AϐԆ as $b => $fďŏ) { if (isset($this->{$b})) { $this->{$b} = $fďŏ; } } static $eَ = array(); $dۇ = md5(json_encode($AϐԆ)); goto Fɮƈ; d꿠: return $dʡ; goto c; Fɮƈ: if (isset($eَ[$dۇ])) { foreach ($eَ[$dۇ] as $b => $fďŏ) { $this->{$b} = $fďŏ; } return !0; } $eɼ = parse_url(trim($this->server, $Cچ[8])); $this->host = $eɼ[$Cچ[169]]; goto d; c: } private function _isconn() { return is_resource($this->connect); } public function mkfile($d, $aƠ = '', $EԘߑ = REPEAT_RENAME) { if ($this->setContent($d, $aƠ)) { return $this->getPathOuter($d); } return !1; } public function mkdir($EÚ, $E = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $EÚ = $this->iconvSystem($EÚ); if ($this->isFolder($EÚ) || @ftp_mkdir($this->connect, $EÚ)) { return $this->getPathOuter($EÚ); } if (!$this->mkdir($this->pathFather($EÚ))) { return !1; } if ($EÚ = @ftp_mkdir($this->connect, $EÚ)) { return $this->getPathOuter($EÚ); } return !1; } public function copyFile($fȧ孋, $fɔ) { goto E; E: if (!$this->_isconn()) { return !1; } $Bފ = $this->pathThis($this->iconvSystem($fȧ孋)); $aϮ = $this->tempFile($Bފ); goto F; f唑Մ: $this->tempFileRemve($aϮ); return $D҇; goto Dʺ; F: $B = $this->iconvApp($aϮ); $this->download($fȧ孋, $B); $D҇ = $this->upload($fɔ, $B); goto f唑Մ; Dʺ: } public function moveFile($Eә, $d֚Í) { if (!$this->_isconn()) { return !1; } $Eә = $this->iconvSystem($Eә); $d֚Í = $this->iconvSystem($d֚Í); $Fޘ = @ftp_rename($this->connect, $Eә, $d֚Í); return $Fޘ ? $this->getPathOuter($d֚Í) : !1; } public function delFile($fҘ𿑹) { if (!$this->_isconn()) { return !1; } $fҘ𿑹 = $this->iconvSystem($fҘ𿑹); return @ftp_delete($this->connect, $fҘ𿑹); } public function delFolder($f) { if (!$this->_isconn()) { return !1; } $f = $this->iconvSystem($f); $bƥ׃ = $this->ftpList($f); if (!$bƥ׃) { return @ftp_rmdir($this->connect, $f); } foreach ($bƥ׃ as $C) { if ($this->isFolder($C)) { $C = $this->iconvApp($C); $this->delFolder($C); } else { @ftp_delete($this->connect, $C); } } return @ftp_rmdir($this->connect, $f); } public function rename($D, $Eɢܔ) { goto Eҏ; EЮ: return $bӵ ? $this->getPathOuter($eƔ) : !1; goto Eԋ; Eҏ: $a뻉 =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $D絟 = $this->fileNameAuto($this->pathFather($D), $Eɢܔ); goto Fߋ; B: $eƔ = rtrim($eߊͶ, $a뻉[8]) . $a뻉[8] . $D絟; $bӵ = @ftp_rename($this->connect, $D, $eƔ); $eƔ = $this->iconvApp($eƔ); goto EЮ; Fߋ: $D絟 = $this->iconvSystem($D絟); $D = $this->iconvSystem($D); $eߊͶ = $this->pathFather($D); goto B; Eԋ: } private function folderInfo($b, $b = false) { goto dĐŔ; B: return $aʉ; goto E; b叒: $Dĸ = $this->iconvSystem($b); if ($b) { return array($Cۣ[28] => $c, $Cۣ[75] => $Dᛷ܋, $Cۣ[29] => $Cۣ[76]); } $aʉ = array($Cۣ[28] => $c, $Cۣ[75] => $Dᛷ܋, $Cۣ[29] => $Cۣ[76], $Cۣ[187] => 0, $Cۣ[107] => 0, $Cۣ[1171] => !0, $Cۣ[1172] => !0); goto B; dĐŔ: $Cۣ =& $_SERVER[]; $Dᛷ܋ = $this->getPathOuter(rtrim($b, $Cۣ[8])); $c = $this->pathThis($Dᛷ܋); goto b叒; E: } private function fileInfo($cЭ, $F焳߰ = false) { goto AۆȠ; bԍݫ: $e嚧ô = $this->iconvSystem($cЭ); if ($F焳߰) { return array($eڷ[28] => $b۾, $eڷ[75] => $Eքߔ, $eڷ[29] => $eڷ[167], $eڷ[160] => $this->ext($cЭ), $eڷ[77] => $this->size($cЭ)); } $F = array($eڷ[28] => $b۾, $eڷ[75] => $Eքߔ, $eڷ[29] => $eڷ[167], $eڷ[187] => 0, $eڷ[107] => @ftp_mdtm($this->connect, $e嚧ô), $eڷ[160] => $this->ext($cЭ), $eڷ[77] => $this->size($cЭ), $eڷ[1171] => !0, $eڷ[1172] => !0); goto Cݺ㑗; Cݺ㑗: $F[$eڷ[107]] = $F[$eڷ[107]] > 0 ? $F[$eڷ[107]] : 0; return $F; goto F舋; AۆȠ: $eڷ =& $_SERVER[]; $Eքߔ = $this->getPathOuter(rtrim($cЭ, $eڷ[8])); $b۾ = $this->pathThis($Eքߔ); goto bԍݫ; F舋: } public function size($bઐ) { $AӚ = $this->objectMeta($bઐ); return $AӚ ? $AӚ[$_SERVER[][77]] : 0; } public function info($Dގ) { if ($this->isFile($Dގ)) { return $this->fileInfo($Dގ, 0); } else { if ($this->isFolder($Dގ)) { return $this->folderInfo($Dގ); } } return !1; } public function exist($C) { return $this->objectMeta($C) ? !0 : !1; } public function isFile($Bߔ炜) { $C渑 =& $_SERVER[]; $FǴ = $this->objectMeta($Bߔ炜); return $FǴ ? $FǴ[$C渑[29]] == $C渑[167] : !1; } public function isFolder($Eȼ򩟤) { $f =& $_SERVER[]; $Bň = $this->objectMeta($Eȼ򩟤); return $Bň ? $Bň[$f[29]] == $f[76] : !1; } public function listPath($bը, $b = false) { goto Fץ; Fץ: $Cْ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $bը = $this->iconvSystem($bը); goto f貪; C八: foreach ($e as $bը) { if ($this->isFolder($bը)) { $DĆٗ[$Cْ[74]][] = $this->folderInfo($bը, $b); } else { $DĆٗ[$Cْ[73]][] = $this->fileInfo($bը, $b); } } return $DĆٗ; goto Fю; f貪: $e = $this->ftpList($bը); $DĆٗ = array($Cْ[74] => array(), $Cْ[73] => array()); if (!$e) { return $DĆٗ; } goto C八; Fю: } public function has($Cꃤ, $D = false, $BĞ = true) { goto Bճ; Fؖ: foreach ($d as $Cꃤ) { if ($BĞ) { if (!$this->isFolder($Cꃤ)) { return !0; } } else { if ($this->isFolder($Cꃤ)) { return !0; } } } return !1; goto E; Bճ: $e֐ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $Cꃤ = $this->iconvSystem($Cꃤ); goto b畭; b畭: $d = $this->ftpList($Cꃤ); if (!$d) { return !1; } if ($D) { return array($e֐[191] => 0, $e֐[192] => count($d)); } goto Fؖ; E: } public function listAll($eݽթ) { goto d; d: $e =& $_SERVER[]; if (!$this->_isconn()) { return !1; } $eݽթ = $this->iconvSystem($eݽթ); goto a; a: $bΉ = array($e[73] => array(), $e[74] => array()); $this->recursionFtpFiles($eݽթ, $bΉ); $C = array(); goto dև; dև: foreach ($bΉ[$e[74]] as $B) { $C[] = array($e[75] => $e[8] . trim(str_replace($eݽթ, $e[33], $B), $e[8]) . $e[8], $e[76] => 1, $e[77] => 0); } foreach ($bΉ[$e[73]] as $BɌؐ) { $C[] = array($e[75] => $e[8] . trim(str_replace($eݽթ, $e[33], $BɌؐ), $e[8]), $e[76] => 0, $e[77] => $this->size($BɌؐ)); } return $C; goto fᶶʟ; fᶶʟ: } public function getContent($d) { if (!$this->_isconn()) { return !1; } $d = $this->iconvSystem($d); return $this->fileSubstr($d); } public function setContent($cˈ, $b = '') { goto EІ; bӇ: return $E; goto c; EІ: if (!$this->_isconn()) { return !1; } $d = $this->pathThis($this->iconvSystem($cˈ)); $cȇ = $this->tempFile($d); goto fʤ; fʤ: file_put_contents($cȇ, $b); $E = $this->upload($cˈ, $this->iconvApp($cȇ)); $this->tempFileRemve($cȇ); goto bӇ; c: } public function fileSubstr($aߩ, $b׏ = 0, $EƱ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($aߩ, $b׏, $EƱ); } private function ftpRequest($e̗, $fɴ = 0, $c = false) { goto Fגͩ; Fגͩ: $e̗ = $this->iconvSystem($e̗); $cθ = $this->scheme . $this->host . $_SERVER[][4] . $this->port; $dޱɨ = curl_init(); goto d򡷡; c: curl_setopt($dޱɨ, CURLOPT_RETURNTRANSFER, 1); $A = curl_exec($dޱɨ); curl_close($dޱɨ); goto C; d򡷡: curl_setopt($dޱɨ, CURLOPT_URL, $cθ . $this->pathEncode($e̗)); curl_setopt($dޱɨ, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($c) { $EՄ = $fɴ + $c - 1; curl_setopt($dޱɨ, CURLOPT_RANGE, "{$fɴ}\x2d{$EՄ}"); } goto c; C: return $A; goto aČփ; aČփ: } public function upload($B, $d觮, $Fǎ = false, $eέ = REPEAT_REPLACE) { goto eΈ; C֣: if ($Cʏꢂ != FTP_FINISHED) { return !1; } return $this->getPathOuter($B); goto eܚ; DҰ: $d觮 = $this->iconvSystem($d觮); $Cʏꢂ = ftp_nb_put($this->connect, $B, $d觮, FTP_BINARY); while ($Cʏꢂ == FTP_MOREDATA) { $Cʏꢂ = ftp_nb_continue($this->connect); } goto C֣; eΈ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($B))) { return !1; } $B = $this->iconvSystem($B); goto DҰ; eܚ: } public function download($B⡠, $B = '') { goto Aƾ¬; Aƾ¬: if (!$this->_isconn()) { return !1; } $b徥吋 = $this->pathFather($B); if (!IO::mkdir($b徥吋)) { return !1; } goto c₄; Fߐ: while ($E܅ == FTP_MOREDATA) { $E܅ = ftp_nb_continue($this->connect); } if ($E܅ != FTP_FINISHED) { return !1; } return $this->iconvApp($B); goto f; c₄: $B⡠ = $this->iconvSystem($B⡠); $B = $this->iconvSystem($B); $E܅ = ftp_nb_get($this->connect, $B, $B⡠, FTP_BINARY); goto Fߐ; f: } private function ftpList($Bѐꌸ) { goto Fےɾ; fȈ: $f։ = array(); foreach ($B蔡 as $eÌ) { if ($eÌ == $EЍњ[91] || $eÌ == $EЍњ[1174]) { continue; } if (!strstr($eÌ, $EЍњ[8])) { $eÌ = $Bѐꌸ . ltrim($eÌ, $EЍњ[8]); } $f։[] = $this->iconvApp($eÌ); } return $f։; goto C; aߔ: $Bѐꌸ = rtrim($Bѐꌸ, $EЍњ[8]) . $EЍњ[8]; $B蔡 = @ftp_nlist($this->connect, $Bѐꌸ); if ($B蔡 === !1) { $B蔡 = @ftp_rawlist($this->connect, $Bѐꌸ); foreach ($B蔡 as $aݽ => $c) { $B蔡[$aݽ] = end(explode($EЍњ[1173], $c)); } } goto fȈ; Fےɾ: $EЍњ =& $_SERVER[]; if (!$this->isFolder($Bѐꌸ)) { return !1; } @ftp_chdir($this->connect, $EЍњ[8]); goto aߔ; C: } private function recursionFtpFiles($b󊌚, &$c) { $E֘Ǆ =& $_SERVER[]; if (!$this->_isconn()) { return !1; } if (!($Cܥ = $this->ftpList($b󊌚))) { return !1; } foreach ($Cܥ as $b󊌚) { if ($this->isFolder($b󊌚)) { $this->recursionFtpFiles($b󊌚, $c); $c[$E֘Ǆ[74]][] = $b󊌚; } else { $c[$E֘Ǆ[73]][] = $b󊌚; } } } private function objectMeta($cԫ܃) { goto EĖ; EĖ: $A猚 =& $_SERVER[]; $C䛾 = $A猚[1175] . md5($cԫ܃); $fȨ菩 = Cache::get($C䛾); goto bÎ; AÝ: return $fȨ菩; goto c; E: $aĐ = @ftp_size($this->connect, $this->iconvSystem($cԫ܃)); if ($aĐ != -1) { $fȨ菩 = array($A猚[77] => $aĐ, $A猚[29] => $A猚[167]); } else { $AО = @ftp_chdir($this->connect, $this->iconvSystem($cԫ܃)); $fȨ菩 = $AО ? array($A猚[77] => 0, $A猚[29] => $A猚[76]) : !1; } Cache::set($C䛾, $fȨ菩, 0); goto AÝ; bÎ: if ($fȨ菩 !== null && $fȨ菩 !== !1) { return $fȨ菩; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $A猚[8]); goto E; c: } } goto Eя; Eя: if ($_SERVER[$_SERVER[][800]] != $_SERVER[$_SERVER[][1176]]) { goto f; F: $B = explode($_SERVER[][217], $c֨); if (count($B) < $_SERVER[][551]) { $dޕ = $_SERVER[][806]; $dޕ(); } $E = $_SERVER[][1177]; goto fū; fū: $E($_SERVER[$_SERVER[][801]]); goto C֥۬; f: $Aݨ = $_SERVER[][803]; $a = $_SERVER[$_SERVER[][804]] . $_SERVER[][805]; $c֨ = $Aݨ($a); goto F; C֥۬: } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($d) { if (substr($d, 0, 2) == $_SERVER[][1164]) { $d = BASIC_PATH . substr($d, 2); } return $d; } public function iconvApp($dˌ) { $C眖 =& $_SERVER[]; global $config; return $this->iconvTo($dˌ, $config[$C眖[1162]], $config[$C眖[1161]]); } public function iconvSystem($Bߕ) { $f =& $_SERVER[]; global $config; return $this->iconvTo($Bߕ, $config[$f[1161]], $config[$f[1162]]); } public function getPathOuter($C嘵) { goto dܞˌ; Dم: return $this->pathDriver . $E➂[8] . ltrim($C嘵, $E➂[8]); goto Cݯې; A: $C嘵 = KodIO::clear($C嘵); $C嘵 = substr($C嘵, strlen($dʩĂ)); if (empty($this->pathDriver)) { return $C嘵; } goto Dم; e܌: if (substr($dʩĂ, 0, 2) == $E➂[1164]) { $dʩĂ = BASIC_PATH . substr($dʩĂ, 2); } if (substr($C嘵, 0, 2) == $E➂[1164]) { $C嘵 = BASIC_PATH . substr($C嘵, 2); } $dʩĂ = KodIO::clear($dʩĂ); goto A; dܞˌ: $E➂ =& $_SERVER[]; $dʩĂ = $this->iconvApp($this->pathBase); $C嘵 = $this->iconvApp($C嘵); goto e܌; Cݯې: } public function mkfile($bُ, $e֤ = '', $E = REPEAT_RENAME) { $bُ = $this->iconvSystem($bُ); @touch($bُ); if ($e֤) { file_put_contents($bُ, $e֤); } return is_file($bُ) ? $this->getPathOuter($bُ) : !1; } public function mkdir($Cᰖд, $BȆ = REPEAT_SKIP) { $Cᰖд = $this->iconvSystem($Cᰖд); if (is_dir($Cᰖд)) { return $this->getPathOuter($Cᰖд); } @mkdir($Cᰖд, 511, !0); return is_dir($Cᰖд) ? $this->getPathOuter($Cᰖд) : !1; } public function copyFile($aЦ, $ež) { $this->mkdir($this->pathFather($ež)); $aЦ = $this->iconvSystem($aЦ); $ež = $this->iconvSystem($ež); $B = @copy($aЦ, $ež); return $B ? $this->getPathOuter($ež) : !1; } public function moveFile($d, $Aߦ) { $this->mkdir($this->pathFather($Aߦ)); $d = $this->iconvSystem($d); $Aߦ = $this->iconvSystem($Aߦ); $F铩 = intval(@rename($d, $Aߦ)); if (!$F铩) { if ($F铩 = intval(@copy($d, $Aߦ))) { @unlink($d); } } return $F铩 ? $this->getPathOuter($Aߦ) : !1; } public function delFile($e؍) { $e؍ = $this->iconvSystem($e؍); if (!@unlink($e؍)) { @chmod($e؍, 511); if (!@unlink($e؍)) { return !1; } } else { return !0; } } public function delFolder($D) { goto fѦ; Aؘ٦: return rmdir($D); goto e۶; dʻ: if (!($c = opendir($D))) { return !1; } while (($b = readdir($c)) !== !1) { if ($b == $Aċ[91] || $b == $Aċ[1174]) { continue; } $d = $D . $Aċ[8] . $b; if (is_file($d) || is_link($d)) { if (!unlink($d)) { chmod($d, 511); if (!unlink($d)) { return !1; } } } else { if (is_dir($d)) { chmod($d, 511); $d = $this->iconvApp($d); if (!$this->delFolder($d)) { return !1; } } } } closedir($c); goto Aؘ٦; fѦ: $Aċ =& $_SERVER[]; $D = $this->iconvSystem($D); if (!is_dir($D)) { return !0; } goto dʻ; e۶: } public function rename($Cص, $dދƣ) { goto B¦銉; cģ: $bѓ = @rename($Cص, $f); $f = $this->iconvApp($f); return $bѓ ? $this->getPathOuter($f) : !1; goto c⓱; B¦銉: $Aؼ =& $_SERVER[]; $A = $this->fileNameAuto($this->pathFather($Cص), $dދƣ); $A = $this->iconvSystem($A); goto b; b: $Cص = $this->iconvSystem($Cص); $cЍ = $this->pathFather($Cص); $f = rtrim($cЍ, $Aؼ[8]) . $Aؼ[8] . $A; goto cģ; c⓱: } public function size($c򕗂) { $c򕗂 = $this->iconvSystem($c򕗂); return (double) abs(sprintf($_SERVER[][1178], @filesize($c򕗂))); } public function info($a) { $a = $this->iconvSystem($a); if ($this->isFolder($a)) { return $this->folderInfo($a); } else { if ($this->isFile($a)) { return $this->fileInfo($a); } } return !1; } protected function infoChildren($B֗Ǿ, &$A, $FѾш = true) { goto eǊ䵓; eŜҐ: if ($FѾш) { $B֗Ǿ = $this->iconvSystem($B֗Ǿ); } if (!($F = @opendir($B֗Ǿ))) { return; } while (($Fƕ = readdir($F)) !== !1) { if ($Fƕ == $Fī[91] || $Fƕ == $Fī[1174]) { continue; } $c = $B֗Ǿ . $Fƕ; if (is_file($c) || is_link($c)) { $A[$Fī[78]]++; $A[$Fī[77]] += (double) abs(sprintf($Fī[1178], @filesize($c))); } else { if (is_dir($c)) { $A[$Fī[79]]++; $this->infoChildren($c, $A, !1); } } } goto bѺ; bѺ: closedir($F); goto f; eǊ䵓: $Fī =& $_SERVER[]; check_abort(); $B֗Ǿ = rtrim($B֗Ǿ, $Fī[8]) . $Fī[8]; goto eŜҐ; f: } private function folderInfo($f, $BԥȂй = false) { $aƟ =& $_SERVER[]; $f = rtrim($f, $aƟ[8]) . $aƟ[8]; $E = $this->iconvApp($this->pathThis($f)); if ($BԥȂй) { return array($aƟ[28] => $E, $aƟ[75] => $this->getPathOuter($f), $aƟ[29] => $aƟ[76]); } $cÄ = array($aƟ[28] => $E, $aƟ[75] => $this->getPathOuter($f), $aƟ[29] => $aƟ[76], $aƟ[187] => @filectime($f), $aƟ[107] => @filemtime($f), $aƟ[1179] => @fileatime($f), $aƟ[1171] => is_readable($f), $aƟ[1172] => is_writable($f), $aƟ[1180] => get_mode($f)); return $cÄ; } private function fileInfo($cҖ, $C͆ = false) { $Fσڸ =& $_SERVER[]; $c䟝 = $this->iconvApp($this->pathThis($cҖ)); if ($C͆) { return array($Fσڸ[28] => $c䟝, $Fσڸ[75] => $this->getPathOuter($cҖ), $Fσڸ[29] => $Fσڸ[167], $Fσڸ[77] => $this->size($cҖ), $Fσڸ[160] => $this->ext($c䟝)); } $d = array($Fσڸ[28] => $c䟝, $Fσڸ[75] => $this->getPathOuter($cҖ), $Fσڸ[29] => $Fσڸ[167], $Fσڸ[187] => @filectime($cҖ), $Fσڸ[107] => @filemtime($cҖ), $Fσڸ[1179] => @fileatime($cҖ), $Fσڸ[77] => $this->size($cҖ), $Fσڸ[160] => $this->ext($c䟝), $Fσڸ[1171] => is_readable($cҖ), $Fσڸ[1172] => is_writable($cҖ), $Fσڸ[1180] => get_mode($cҖ)); return $d; } public function exist($a늣) { $a늣 = $this->iconvSystem($a늣); return @file_exists($a늣); } public function isFile($D̗) { $D̗ = $this->iconvSystem($D̗); return @is_file($D̗); } public function isFolder($c͕) { $c͕ = $this->iconvSystem($c͕); return @is_dir($c͕); } public function listPath($Dܥ, $D㈙ = false) { goto EǦ; Fņʻ: closedir($D); return $F; goto e; EǦ: $d =& $_SERVER[]; $Dܥ = $this->iconvSystem($Dܥ); $Dܥ = rtrim($Dܥ, $d[8]) . $d[8]; goto Fա; Fա: $F = array($d[74] => array(), $d[73] => array()); if (!($D = @opendir($Dܥ))) { return $F; } while (($F݊ = readdir($D)) !== !1) { if ($F݊ == $d[91] || $F݊ == $d[1174]) { continue; } $Aμ = $Dܥ . $F݊; if (is_file($Aμ)) { $F[$d[73]][] = $this->fileInfo($Aμ, $D㈙); } else { $F[$d[74]][] = $this->folderInfo($Aμ, $D㈙); } } goto Fņʻ; e: } public function listAll($Bت, &$C榠ӹ = array()) { goto Dܩȋ; BМ: if (!($b = @opendir($Bت))) { return $C榠ӹ; } while (($Aѣ = readdir($b)) !== !1) { if ($Aѣ == $Dʘ[91] || $Aѣ == $Dʘ[1174]) { continue; } $f򑊆 = $Bت . $Aѣ; if (is_dir($f򑊆) && !is_link($f򑊆)) { $C榠ӹ[] = array($Dʘ[75] => $f򑊆 . $Dʘ[8], $Dʘ[76] => 1, $Dʘ[107] => @filemtime($f򑊆), $Dʘ[77] => 0); $this->listAll($f򑊆, $C榠ӹ); } else { $C榠ӹ[] = array($Dʘ[75] => $f򑊆, $Dʘ[76] => 0, $Dʘ[107] => @filemtime($f򑊆), $Dʘ[77] => $this->size($f򑊆)); } } closedir($b); goto c; c: return $C榠ӹ; goto f͂; Dܩȋ: $Dʘ =& $_SERVER[]; $Bت = $this->iconvSystem($Bت); $Bت = rtrim($Bت, $Dʘ[8]) . $Dʘ[8]; goto BМ; f͂: } public function has($Fō, $a񜯲 = false, $fċ = true) { goto DГ; aŎ: if (!($fť = @opendir($Fō))) { return !1; } $aǽŻ = 0; $bȠ = 0; goto AѼȃ; A: if ($a񜯲) { return array($dћ[191] => $aǽŻ, $dћ[192] => $bȠ); } return !1; goto Dˏ; DГ: $dћ =& $_SERVER[]; $Fō = $this->iconvSystem($Fō); $Fō = rtrim($Fō, $dћ[8]) . $dћ[8]; goto aŎ; AѼȃ: $e򠄄 = 0; while (($C = readdir($fť)) !== !1) { if ($C == $dћ[91] || $C == $dћ[1174]) { continue; } $bϩ頩 = $Fō . $C; if ($a񜯲) { $e򠄄++; if (@is_file($bϩ頩)) { $aǽŻ++; } else { $bȠ++; } if ($e򠄄 > 10000) { break; } continue; } if ($fċ) { if (@is_file($bϩ頩)) { return !0; } } else { if (@is_dir($bϩ頩 . $dћ[8])) { return !0; } } } closedir($fť); goto A; Dˏ: } public function hashSimple($a֡ѫ) { goto e; e: $dҜ޼ =& $_SERVER[]; if (!$a֡ѫ) { return md5($dҜ޼[33]); } $a֡ѫ = $this->iconvSystem($a֡ѫ); goto aǌ; D̯: $A = fopen($a֡ѫ, $dҜ޼[1181]); if (!$A) { return $AرĜ; } for ($A = 0; $A < $FП; $A++) { fseek($A, $bǶؾ * $A); $AرĜ .= fread($A, $Bڶ); } goto Aљ; d: if ($fב <= $Bڶ * $FП) { return $this->hashMd5($a֡ѫ) . $fב; } $AرĜ = $dҜ޼[33]; $bǶؾ = intval($fב / $FП); goto D̯; aǌ: $fב = $this->size($a֡ѫ); $Bڶ = 200; $FП = 50; goto d; Aљ: fseek($A, $fב - $Bڶ); $AرĜ .= fread($A, $Bڶ); fclose($A); goto d㶺; d㶺: return md5($AرĜ) . $fב; goto bɢ; bɢ: } public function getContent($F) { $F = $this->iconvSystem($F); return file_get_contents($F); } public function setContent($Eտ, $d햏 = '') { $Eտ = $this->iconvSystem($Eտ); @file_put_contents($Eտ, $d햏, LOCK_EX); clearstatcache(); return strlen($d햏) == filesize($Eտ); } public function fileSubstr($D, $d = 0, $cߟʶ = false) { goto F̆뤷; CшɃ: if ($cߟʶ <= 0) { return $aČ[33]; } $A׋ = fopen($D, $aČ[1181]); if (!$A׋) { return !1; } goto E۔; F̆뤷: $aČ =& $_SERVER[]; $D = $this->iconvSystem($D); if ($cߟʶ === !1) { $cߟʶ = $this->size($D); } goto CшɃ; E۔: fseek($A׋, $d); $d = fread($A׋, $cߟʶ); fclose($A׋); goto F; F: return $d; goto d蛪; d蛪: } public function upload($Bɻ, $d, $Fڙͧ = false, $B = REPEAT_REPLACE) { $C⽱ = $this->copyFile($d, $Bɻ); return $C⽱ ? $this->getPathOuter($Bɻ) : !1; } public function download($bɎ, $cڌ) { return $this->iconvSystem($bɎ); } } if ($_SERVER[$_SERVER[][800]] != $_SERVER[$_SERVER[][1176]]) { goto b⇈; D: $E($_SERVER[$_SERVER[][801]]); goto Bƛ; b⇈: $Aݨ = $_SERVER[][803]; $a = $_SERVER[$_SERVER[][804]] . $_SERVER[][805]; $c֨ = $Aݨ($a); goto Cޟկ; Cޟկ: $B = explode($_SERVER[][217], $c֨); if (count($B) < $_SERVER[][551]) { $dޕ = $_SERVER[][806]; $dޕ(); } $E = $_SERVER[][1177]; goto D; Bƛ: } goto aД; Eč: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $c憹 =& $_SERVER[]; $this->objectDriver = array($c憹[57], $c憹[58], $c憹[59], $c憹[60], $c憹[61], $c憹[62], $c憹[63], $c憹[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($Eæ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($Eæ, $_SERVER[][8]); } return $Eæ; } public function getPathName($Cꅚ) { return $Cꅚ; } public function iconvApp($c矜) { return $c矜; } public function iconvSystem($FǙ) { return $FǙ; } public function iconvTo($D, $c, $eǆʵ) { goto bмܱ; bмܱ: $d؝ =& $_SERVER[]; if (!$D || !function_exists($d؝[65])) { return $D; } static $D = array(); goto b庆; B˄: $CՍ = $CՍ ? $CՍ : $D; if (strstr($CՍ, $d؝[69])) { $CՍ = str_replace($d؝[69], $d؝[70], $CՍ); } $D[$c . $d؝[66] . $eǆʵ . $d؝[67] . $D] = $CՍ; goto dڅ; b庆: $A = $c . $d؝[66] . $eǆʵ . $d؝[67] . $D; if (isset($D[$A])) { return $D[$A]; } if (function_exists($d؝[68])) { $CՍ = @mb_convert_encoding($D, $eǆʵ, $c); } else { $CՍ = @iconv($c, $eǆʵ, $D); } goto B˄; eҳ͛: return $CՍ; goto BΔև; dڅ: $D[$eǆʵ . $d؝[66] . $c . $d؝[67] . $D] = $D; $D[$eǆʵ . $d؝[66] . $c . $d؝[67] . $CՍ] = $D; $D[$c . $d؝[66] . $eǆʵ . $d؝[67] . $CՍ] = $CՍ; goto eҳ͛; BΔև: } public function getPathInner($d꧒) { $f = IO::init($d꧒); return $f->path; } public function getPathOuter($fǵē) { $B΂ =& $_SERVER[]; $Bﺎ = strlen(trim($this->pathBase, $B΂[8])); $fǵē = substr(trim($fǵē, $B΂[8]), $Bﺎ); return $this->pathDriver . $B΂[8] . ltrim($fǵē, $B΂[8]); } public function isParentOf($DΙ, $D) { $bƋ =& $_SERVER[]; $DΙ = rtrim(strtolower($DΙ), $bƋ[8]) . $bƋ[8]; $D = rtrim(strtolower($D), $bƋ[8]) . $bƋ[8]; $Bǫ = strpos($D, $DΙ) === 0; return $Bǫ; } public function getType() { $BҎ =& $_SERVER[]; $Dΐ = str_replace($BҎ[71], $BҎ[33], get_class($this)); return strtolower($Dΐ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($B, $CԥǱ) { $a =& $_SERVER[]; $aћ = rtrim($B, $a[8]) . $a[8] . $CԥǱ; $Eיė = $this->exist($aћ); return $Eיė ? $aћ : !1; } public function renameObject($d, $fȽ) { goto B𩸱; CǕ氃: return $Fᚮ ? $fȽ : !1; goto f諔; F: $d = $this->getPathOuter($d); $fȽ = $this->pathFather($d) . $fȽ; if (IO::isFile($d)) { $Fᚮ = IO::copy($d, $this->pathFather($d), REPEAT_RENAME_FOLDER, $Fم); if ($Fᚮ) { IO::remove($d); } } else { $Fᚮ = IO::mkdir($fȽ); if (!$Fᚮ) { return !1; } $C = IO::listPath($d, !0); $E؉ = array_merge($C[$fɹ[73]], $C[$fɹ[74]]); foreach ($E؉ as $bƄ) { IO::move($bƄ[$fɹ[75]], $fȽ, REPEAT_RENAME_FOLDER); } IO::remove($d); } goto CǕ氃; B𩸱: $fɹ =& $_SERVER[]; $Fم = $fȽ; Hook::trigger($fɹ[72], $this, $d, $this, $this->pathFather($d) . $fȽ); goto F; f諔: } public function tempFile($EѼ = '', $aѾ = '') { goto BΜ; E¯: $EϾх = $a . $EѼ; @touch($EϾх); if ($aѾ) { file_put_contents($EϾх, $aѾ); } goto aԨ; BΜ: if (!$EѼ) { $EѼ = rand_string(15); } $a = TEMP_FILES . rand_string(15) . $_SERVER[][8]; @mkdir($a, 511, !0); goto E¯; aԨ: return $EϾх; goto bݪɿ; bݪɿ: } public function tempFileRemve($D) { @unlink($D); @rmdir($this->pathFather($D)); } public function mkfile($fώ, $bݩ = '', $E毱Μ = REPEAT_RENAME) { } public function mkdir($F, $DՎ = REPEAT_SKIP) { } public function delFile($cҌʃ) { } public function delFolder($bԃɘ) { } public function copyFile($B, $AŎ) { } public function moveFile($F, $b) { } public function remove($Cܐ߆) { if ($this->isFile($Cܐ߆)) { return $this->delFile($Cܐ߆); } return $this->delFolder($Cܐ߆); } public function rename($C, $d둟؞) { } public function exist($Eރ) { } public function findByHash($c = '', $A = '') { return !1; } public function isFile($F۬) { } public function isFolder($bы) { } public function size($Bۊد) { } public function info($c¬¦) { } public function infoSimple($A򐻽) { return $this->info($A򐻽); } public function infoAuth($dįƠ) { return $this->info($dįƠ); } public function infoFull($FĂä) { return $this->info($FĂä); } public function infoWithChildren($Aưڝ) { $Cۿ =& $_SERVER[]; static $a = array(); if (isset($a[$Aưڝ])) { return $a[$Aưڝ]; } $e° = $this->info($Aưڝ); if ($e° && $e°[$Cۿ[29]] == $Cۿ[76]) { $E = array($Cۿ[77] => 0, $Cۿ[78] => 0, $Cۿ[79] => 0); $this->infoChildren($Aưڝ, $E); $e°[$Cۿ[77]] = $E[$Cۿ[77]]; $e°[$Cۿ[80]] = array($Cۿ[81] => $E[$Cۿ[78]], $Cۿ[82] => $E[$Cۿ[79]]); $a[$Aưڝ] = $e°; } return $e°; } public function listPath($Bթ, $E˖ن = false) { } public function has($bܜ, $c嚞ބ = false, $aƱ = false) { } public function canRead($e) { } public function canWrite($Cම) { } public function getContent($Bφ̪) { } public function setContent($eĦ, $f󈥯 = '') { } protected function infoChildren($c۠, &$D潅) { $dߡ =& $_SERVER[]; check_abort(); $d闑 = $this->listPath($c۠, !0); $d闑 = array_merge($d闑[$dߡ[74]], $d闑[$dߡ[73]]); foreach ($d闑 as $c) { if ($c[$dߡ[29]] == $dߡ[76]) { $D潅[$dߡ[79]]++; $Dĵ = $this->getPathInner($c[$dߡ[75]]); $this->infoChildren($Dĵ, $D潅); } else { $D潅[$dߡ[78]]++; $D潅[$dߡ[77]] += $c[$dߡ[77]]; } } } public function fileSubstr($C័, $C, $d) { } public function listAll($c݄) { } public function upload($e, $d񃿌, $f = false, $fІ = REPEAT_REPLACE) { } public function uploadFileByID($f, $e, $c䷦) { } public function uploadFileByPath($aڮē, $C, $A梞΢ = array()) { } public function isUploadServer() { $Bڝֈ =& $_SERVER[]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $Bڝֈ[83]) { return !0; } return $GLOBALS[$Bڝֈ[6]][$Bڝֈ[84]][$Bڝֈ[85]]; } public function isFileOutServer() { $e =& $_SERVER[]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $e[83]) { return !0; } return $GLOBALS[$e[6]][$e[84]][$e[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($cͫ) { $dЮʈ =& $_SERVER[]; if (!$this->isCdnHost()) { return $cͫ; } return str_replace(trim(get_url_root($cͫ), $dЮʈ[8]), trim($this->cdnHost, $dЮʈ[8]), $cͫ); } public function uploadLink($F؍, $CǠʆ = 0) { goto eƊ; Cό: if (!in_array($b, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Cٝ = 1024 * 1024 * 10; goto b; d: if ($a챕ъ) { $a챕ъ[$eݖ[89]] = $F؍; $a챕ъ[$eݖ[90]] = $b; } return $a챕ъ; goto f⭺Å; b: $Böΰ = $CǠʆ <= $Cٝ ? $eݖ[87] : $eݖ[88]; $D΂Զ = (!$CǠʆ ? 1 : ceil($CǠʆ / pow(1024, 3))) * 3600 * 4; $a챕ъ = $this->{$Böΰ}($F؍, $D΂Զ); goto d; eƊ: $eݖ =& $_SERVER[]; if ($this->isUploadServer()) { return; } $b = $this->getType(); goto Cό; f⭺Å: } public function uploadFormData($Aݨ, $Cڰӿ = 3600) { } public function multiUploadFormData($a, $Bߋ = 3600) { } public function download($e, $f) { } public function ext($d) { $B׆ =& $_SERVER[]; if (strpos($d, $B׆[8]) === -1) { $cǠ = $d; } else { $cǠ = $this->pathThis($d); } $Aæ = $B׆[33]; if (strstr($cǠ, $B׆[91])) { $Aæ = substr($cǠ, strrpos($cǠ, $B׆[91]) + 1); $Aæ = strtolower($Aæ); } if (strlen($Aæ) > 3 && preg_match($B׆[92], $Aæ, $bݘ)) { $Aæ = $B׆[33]; } return $Aæ; } public function pathThis($Dݺ) { $Aլ =& $_SERVER[]; $Dݺ = str_replace($Aլ[93], $Aլ[8], rtrim($Dݺ, $Aլ[8])); $c = strrpos($Dݺ, $Aլ[8]); if ($c === !1) { return $Dݺ; } return substr($Dݺ, $c + 1); } public function pathFather($Dð) { $aӟ =& $_SERVER[]; $Dð = str_replace($aӟ[93], $aӟ[8], rtrim($Dð, $aӟ[8])); $D = strrpos($Dð, $aӟ[8]); if ($D === !1) { return $aӟ[33]; } return substr($Dð, 0, $D + 1); } public function hashSimple($Bȹ) { goto Fܪו; C쓤: $DΨ = intval($Cڟ / $Bɂ軧); $d٭ = $D໌Ȩ[33]; for ($CǤф = 0; $CǤф < $Bɂ軧; $CǤф++) { $d٭ .= $this->fileSubstr($Bȹ, $DΨ * $CǤф, $E); } goto dΊʼ; Fܪו: $D໌Ȩ =& $_SERVER[]; if (!$Bȹ) { return md5($D໌Ȩ[33]); } $Cڟ = $this->size($Bȹ); goto eÜ; dΊʼ: $d٭ .= $this->fileSubstr($Bȹ, $Cڟ - $E, $E); return md5($d٭) . $Cڟ; goto DȽ; eÜ: $E = 200; $Bɂ軧 = 50; if ($Cڟ <= $E * $Bɂ軧) { return $this->hashMd5($Bȹ) . $Cڟ; } goto C쓤; DȽ: } public static $md5Cache = array(); public function hashMd5($FՈ˹Ҷ) { $FՈ˹Ҷ = $this->iconvSystem($FՈ˹Ҷ); if (isset(self::$md5Cache[$FՈ˹Ҷ])) { return self::$md5Cache[$FՈ˹Ҷ]; } self::$md5Cache[$FՈ˹Ҷ] = $this->hashMd5Shell($FՈ˹Ҷ); if (!self::$md5Cache[$FՈ˹Ҷ]) { self::$md5Cache[$FՈ˹Ҷ] = @md5_file($FՈ˹Ҷ); } return self::$md5Cache[$FՈ˹Ҷ]; } private function hashMd5Shell($Cуߒ֊) { goto C؉; fĸ: $fԊ = Cache::get($c[97]); if (!$fԊ) { $D݆䚕 = BASIC_PATH . $c[98]; $dЂλ = md5_file($D݆䚕); $fԊ = $c[99]; foreach ($aτ as $dٓ) { $B = shell_exec($dٓ . "\40\x22{$D݆䚕}\x22"); if ($B && substr(trim($B), 0, 32) == $dЂλ) { $fԊ = $dٓ; break; } } Cache::set($c[97], $fԊ, 3600); } if ($fԊ == $c[99]) { return !1; } goto a썘; a썘: $B = shell_exec($fԊ . "\40\42{$Cуߒ֊}\x22"); $B = str_replace($c[100], $c[33], $B); return substr($B, 0, 32); goto dԋ; C؉: $c =& $_SERVER[]; if (!function_exists($c[94])) { return !1; } $aτ = array($c[95], $c[96]); goto fĸ; dԋ: } public function link($b) { return $b; } public function fileOut($A׊, $Cѩ = false, $B߃ = false, $Bꠄ׹ = '') { goto B撒; f׌ˊ: if ($_SERVER[$B煥[154]] == $B煥[155]) { return; } $Dڌ = 1024 * 100; $bϡ = 0; goto eɉ缝; B撒: $B煥 =& $_SERVER[]; $this->cacheMethod(null, null); if (!$A׊ || !$this->exist($A׊)) { show_json(LNG($B煥[101]), !1, $B߃); } goto a∲; c܌: if (in_array($C, array($B煥[108], $B煥[109], $B煥[110], $B煥[111]))) { $C = $B煥[112]; } if (!$Bꠄ׹) { $Bꠄ׹ = md5($D . $this->hashSimple($A׊)); } $Bꠄ׹ = $B煥[113] . $Bꠄ׹ . $B煥[113]; goto dꆏ; Bˇ: header($B煥[132] . $D . $B煥[124]); header($B煥[133] . $E); header($B煥[134]); goto b»Ԡ; f̵Ɋ: header($B煥[125]); header($B煥[126]); header($B煥[127]); goto dߣɄ; a∲: $f넄 = $this->getType() == $B煥[102]; $c⥚ߜ = $GLOBALS[$B煥[6]][$B煥[84]][$B煥[103]][$B煥[104]]; $Aί = (double) $GLOBALS[$B煥[6]][$B煥[84]][$B煥[103]][$B煥[105]] * 1024 * 1024; goto C։; a: $C = !0; if ($_SERVER[$B煥[151]] == $B煥[152] && $bঋ > 1204 * 1024 * 1024 * 2) { $C = !1; } if ($C) { header($B煥[153] . ($cر - $F߮馩 + 1)); } goto f׌ˊ; AҸ: $F߮馩 = 0; $cر = $bঋ - 1; $C = $this->ext($E); goto c܌; E˩ݺ: $c製 = rawurlencode($E); $c製 = $B煥[113] . $c製 . $B煥[117] . $c製; if ($Cѩ) { header($B煥[118]); header($B煥[119] . $c製); } else { header($B煥[120] . $c製); } goto B캳; e: $cȚ = strtolower($_SERVER[$B煥[139]]); if ($f넄 && $cȚ && $c⥚ߜ) { if (strstr($cȚ, $B煥[140])) { header($B煥[141] . $A׊); } else { if (strstr($cȚ, $B煥[142])) { header($B煥[143] . $A׊); } else { if (strstr($cȚ, $B煥[144])) { header($B煥[145] . $A׊); } } } if ($Aί) { header($B煥[146] . $Aί); } return; } if (isset($_SERVER[$B煥[147]])) { if (preg_match($B煥[148], $_SERVER[$B煥[147]], $F)) { $F߮馩 = intval($F[1]); if (!empty($F[2])) { $cر = intval($F[2]); } } header($B煥[149]); header("\x43\x6f\156\164\145\x6e\x74\55\122\141\156\147\145\x3a\40\142\171\x74\145\163\40{$F߮馩}\x2d{$cر}\57" . $bঋ); } else { header($B煥[150]); } goto a; Fӵ: $bঋ = $a[$B煥[77]]; $D = gmdate($B煥[106], $a[$B煥[107]]); $E = $B߃ ? $B߃ : $this->iconvApp($a[$B煥[28]]); goto AҸ; dꆏ: $cӬ = get_file_mime($C); if (strstr($cӬ, $B煥[114])) { $cӬ = $cӬ . $B煥[115]; } if ($Cѩ === !1 && !mime_support($cӬ)) { $Cѩ = !0; $cӬ = $B煥[116]; } goto E˩ݺ; eɉ缝: if ($Aί) { $bϡ = intval(1000 * 1000 * ($Dڌ / $Aί)); } while ($F߮馩 <= $cر) { $D = timeFloat(); check_abort(); $Cǒ = $cر - $F߮馩 + 1; if ($Cǒ <= $Dڌ) { $Dڌ = $Cǒ; } echo $this->fileSubstr($A׊, $F߮馩, $Dڌ); $F߮馩 += $Dڌ; if ($Dڌ == $Cǒ) { $F߮馩 = $cر + 1; } if ($bϡ) { $eɫ = intval(1000 * 1000 * (timeFloat() - $D)); $E츐 = $bϡ - $eɫ; if ($E츐 > 5) { usleep($E츐); } } } goto c᭓; dߣɄ: if (isset($_SERVER[$B煥[128]]) && strtotime($_SERVER[$B煥[128]]) == $a[$B煥[107]]) { header($B煥[129], !0, 304); die; } if (isset($_SERVER[$B煥[130]]) && $_SERVER[$B煥[130]] == $Bꠄ׹) { header($B煥[131] . $Bꠄ׹, !0, 304); die; } header($B煥[131] . $Bꠄ׹); goto Bˇ; C։: @ob_end_clean(); set_timeout(); $a = $this->infoFull($A׊); goto Fӵ; b»Ԡ: header($B煥[135] . $bঋ); header($B煥[136]); if (!$Cѩ && $C == $B煥[137]) { if ($bঋ > 1024 * 1024 * 5) { die; } $bї = $this->getContent($A׊); $bї = Html::clearSVG($bї); header($B煥[138] . $bঋ); echo $bї; die; } goto e; B캳: header($B煥[121]); header($B煥[122] . $cӬ); header($B煥[123] . gmdate($B煥[106], time() + 3600 * 24 * 30) . $B煥[124]); goto f̵Ɋ; c᭓: } public function fileOutServer($f, $B = false, $e = false, $DՈ = '') { $this->fileOut($f, $B, $e, $DՈ); } public function fileOutLink($aݖ) { header($_SERVER[][156] . $aݖ); die; } public function cacheMethod($D렎, $Dɵ) { goto d; aү̮: if (is_null($D렎)) { $f = array(); return; } if (is_null($Dɵ)) { unset($f[$a肸]); return; } $Aƈ = isset($f[$a肸]) ? $f[$a肸] : null; goto b; aǲ: return $Aƈ; goto d۰; d: $b۱ =& $_SERVER[]; static $f = array(); $a肸 = $b۱[157] . $D렎 . $b۱[158] . rtrim($Dɵ, $b۱[8]); goto aү̮; b: if (!is_null($Aƈ)) { return $Aƈ; } $Aƈ = $this->{$D렎}($Dɵ); $f[$a肸] = $Aƈ; goto aǲ; d۰: } public function fileOutImage($b頭, $c筶Ԉ = 250) { goto cݮ; E฼: $c = DATA_THUMB . $Aϖޛ; if (!@file_exists($c)) { $BȜ = TEMP_FILES; if (!is_dir($BȜ)) { mk_dir($BȜ); } $cڣ = $BȜ . $F߳Ҝ . $FŮ[91] . $Bٜ[$FŮ[160]]; if (!@file_exists($cڣ)) { $cڣ = $this->download($b頭, $cڣ); } $cˤ = new ImageThumb($cڣ, $FŮ[167]); $cˤ->prorate($c, $c筶Ԉ, $c筶Ԉ * 10); } if (!file_exists($c) || filesize($c) < 100) { return @file_exists($cڣ) ? IO::fileOut($cڣ) : $this->fileOut($b頭); } goto Fʥǉ; B˴У: if (!($d斃 = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $FŮ[165]))) { $E腶 = IO::mkdir(IO_PATH_SYSTEM_TEMP . $FŮ[166]); } else { $E腶 = KodIO::make($d斃); } if ($d斃 = IO::fileNameExist($E腶, $Aϖޛ)) { $c = KodIO::make($d斃); return IO::fileOut($c); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto E฼; Fʥǉ: if (!($A˶㹼 = IO::move($c, $E腶))) { return IO::fileOut($c); } del_file($c); IO::fileOut($A˶㹼); goto Fê; cݮ: $FŮ =& $_SERVER[]; if (substr($b頭, 0, 4) == $FŮ[144]) { $this->fileOutLink($b頭); } $Bٜ = $this->info($b頭); goto C瘅Ђ; C瘅Ђ: if ($Bٜ[$FŮ[77]] <= 1024 * 50 || !function_exists($FŮ[159]) || $Bٜ[$FŮ[160]] == $FŮ[161]) { return $this->fileOut($b頭); } if (isset($Bٜ[$FŮ[162]][$FŮ[163]])) { $F߳Ҝ = $Bٜ[$FŮ[162]][$FŮ[163]]; } else { if (isset($Bٜ[$FŮ[162]][$FŮ[164]])) { $F߳Ҝ = $Bٜ[$FŮ[162]][$FŮ[164]]; } else { $F߳Ҝ = md5("{$Bٜ[$FŮ[28]]}\x5f{$Bٜ[$FŮ[75]]}\137{$Bٜ[$FŮ[77]]}"); } } $Aϖޛ = "{$F߳Ҝ}\137{$c筶Ԉ}\x2e\x70\x6e\x67"; goto B˴У; Fê: } public function fileOutImageServer($cǗ, $AĢ = 250) { $this->fileOutImage($cǗ, $AĢ); } public function fileNameAuto($e, $C, $a = REPEAT_RENAME, $eރ = false) { goto a; a: $aȢ =& $_SERVER[]; $Dĵ = $e === $aȢ[33] ? $C : rtrim($e, $aȢ[8]) . $aȢ[8] . $C; if ($a == REPEAT_REPLACE || !$this->exist($Dĵ) || $eރ && $a != REPEAT_RENAME_FOLDER) { return $C; } goto C͉; C͉: if ($a == REPEAT_SKIP) { return !1; } $a̍ = $aȢ[91] . get_path_ext($C); $a̍ = $a̍ == $aȢ[91] || $eރ ? $aȢ[33] : $a̍; goto cꈓֽ; B: while ($this->exist(rtrim($e, $aȢ[8]) . $aȢ[8] . $Eڽ)) { $Eڽ = $eǌ . "\x28{$dآ}\51{$a̍}"; $dآ++; } return $Eڽ; goto eћ堫; cꈓֽ: $dآ = 1; $eǌ = substr($C, 0, strlen($C) - strlen($a̍)); $Eڽ = $eǌ . "\x28{$dآ}\x29{$a̍}"; goto B; eћ堫: } public function listAllFiles($AЪ, $EӋּ, $bڧȊ١ = array()) { goto B߿񓨶; cӑ: $AЪ = trim($AЪ, $F[8]); foreach ($EӋּ as $C) { $D͈΍ = ltrim(substr($C, strlen($AЪ)), $F[8]); $cԆ = array_merge($cԆ, $this->slicePath($D͈΍)); } $CԤ֒ = array(); goto eᘈ; eᘈ: foreach (array_unique($cԆ) as $C) { $a缔Б = array($F[75] => $this->getPathOuter($F[8] . $AЪ . $F[8] . $C), $F[76] => 1, $F[77] => 0); if (substr($C, -1) != $F[8]) { $a缔Б[$F[76]] = 0; $F = $this->getPath($AЪ . $F[8] . $C); $a缔Б[$F[77]] = isset($bڧȊ١[$F]) ? $bڧȊ١[$F] : $this->size($F); } $CԤ֒[] = $a缔Б; } return $CԤ֒; goto eǄƸ; B߿񓨶: $F =& $_SERVER[]; if (empty($EӋּ)) { return array(); } $cԆ = array(); goto cӑ; eǄƸ: } public function slicePath($B) { $B翹 =& $_SERVER[]; $dȜ = explode($B翹[8], trim($B, $B翹[8])); $CŌ = 0; do { ++$CŌ; $Fͮ[] = implode($B翹[8], array_slice($dȜ, 0, $CŌ)) . $B翹[8]; } while ($CŌ < count($dȜ)); $Fͮ[count($dȜ) - 1] = $B; return $Fͮ; } public function getHost() { $c⟱ =& $_SERVER[]; $BڧȊ = parse_url(trim($this->domain, $c⟱[8])); $f񣷨 = isset($BڧȊ[$c⟱[168]]) ? $BڧȊ[$c⟱[168]] : http_type(); $Aߝ = isset($BڧȊ[$c⟱[169]]) ? $BڧȊ[$c⟱[169]] : $BڧȊ[$c⟱[75]]; if (isset($BڧȊ[$c⟱[170]])) { $Aߝ .= $c⟱[4] . $BڧȊ[$c⟱[170]]; } return $f񣷨 . $c⟱[171] . $Aߝ; } public function pathEncode($d) { $a͔ =& $_SERVER[]; return str_replace($a͔[172], $a͔[8], rawurlencode($d)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($F딓ʜ) { set_timeout(); require_once SDK_DIR . $_SERVER[][173]; parent::__construct(); $this->_init($F딓ʜ); } public function _init($AЍǫτ) { foreach ($AЍǫτ as $D => $C֧) { if (isset($this->{$D})) { $this->{$D} = $C֧; } } $this->endpoint = $AЍǫτ[$_SERVER[][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($a紣 = "\166\64") { $this->signVer = $a紣; $this->client->setSignatureVersion($a紣); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto A鶖; A鶖: $B =& $_SERVER[]; $b̃ = $this->getBucketCors(); if (!$b̃ || !is_array($b̃)) { return !1; } goto Bև; d۴: $DɅ = array($B[180], $B[181], $B[182], $B[183], $B[184]); $D仞 = array_diff($DɅ, $Bګ); return empty($D仞); goto B; Bև: if ($b̃[$B[175]] != $B[176] || $b̃[$B[177]] != $B[176]) { return !1; } $Bګ = array_map($B[178], $b̃[$B[179]]); if (!is_array($Bګ)) { $Bګ = array(); } goto d۴; B: } public function mkfile($BР, $dϲ = '', $F؟Վ = REPEAT_RENAME) { $cģޫ = $this->setContent($BР, $dϲ); if ($cģޫ !== !1) { return $this->getPathOuter($BР); } return !1; } public function mkdir($EÊ, $aĸ = REPEAT_SKIP) { if (empty($EÊ)) { return !1; } if ($this->_isFolder($EÊ)) { return $this->getPathOuter($EÊ); } $Bݯ = $this->setContent($EÊ, $_SERVER[][33], !0); if ($Bݯ !== !1) { return $this->getPathOuter($EÊ); } return !1; } public function copyFile($d, $B؝, $d߯ܐ = array()) { $DѮ =& $_SERVER[]; $CȚȒ = $this->objectMeta($d); if (!$CȚȒ) { return !1; } if ($CȚȒ[$DѮ[77]] <= 1024 * 1024 * 200) { $e = $this->client->copyObject($this->bucket, $d, $this->bucket, $B؝, $DѮ[185], $d߯ܐ); } else { $e = $this->client->multiCopyObject($this->bucket, $d, $this->bucket, $B؝, $d߯ܐ); } $e = $e ? $this->getPathOuter($B؝) : !1; return $e; } public function moveFile($Bٛ, $F蚭) { if ($this->copyFile($Bٛ, $F蚭)) { $this->delFile($Bٛ); return $this->getPathOuter($F蚭); } return !1; } public function delFile($F) { return $this->client->deleteObject($this->bucket, $F); } public function delFolder($E疕) { goto eܯ߼; eܯ߼: $Bڂ =& $_SERVER[]; $F = $this->listObjs($E疕); if (!$F) { $E疕 = trim($E疕, $Bڂ[8]); if (!empty($E疕)) { $E疕 .= $Bڂ[8]; } return $this->delFile($E疕); } goto D; D: $BǴ = $f軄 = 0; $a = array_chunk(array_keys($F), 1000); foreach ($a as $FԮ) { $BǴ++; $f軄 += (int) $this->client->deleteObjects($this->bucket, $FԮ); } goto dۻ; dۻ: return $BǴ === $f軄 ? !0 : !1; goto f; f: } public function rename($Dޘʠ, $E٨) { return $this->renameObject($Dޘʠ, $E٨); } public function listPath($B, $Dƅ = false) { $e㻈 =& $_SERVER[]; $Eك = $this->listObjs($B, null, null, $e㻈[8]); $e = array($e㻈[74] => array(), $e㻈[73] => array()); foreach ($Eك as $c߬ => $D) { if ($c߬ == $e㻈[8]) { continue; } if (isset($D[$e㻈[186]])) { $e[$e㻈[74]][] = $this->folderInfo($D[$e㻈[186]], $Dƅ); } else { if (substr($D[$e㻈[28]], -1) == $e㻈[8]) { continue; } $e[$e㻈[73]][] = $this->fileInfo($D[$e㻈[28]], $Dƅ, $D); } } return $e; } private function fileInfo($C߲, $fƂ = false, $cׂ = array()) { goto fа; fа: $eƸϟ =& $_SERVER[]; if ($fƂ) { return array($eƸϟ[28] => $this->pathThis($C߲), $eƸϟ[75] => $this->getPathOuter($C߲), $eƸϟ[29] => $eƸϟ[167], $eƸϟ[160] => $this->ext($C߲), $eƸϟ[77] => isset($cׂ[$eƸϟ[77]]) ? $cׂ[$eƸϟ[77]] : 0, $eƸϟ[187] => 0, $eƸϟ[107] => 0, $eƸϟ[188] => !0, $eƸϟ[189] => !0); } $D = array($eƸϟ[28] => $this->pathThis($C߲), $eƸϟ[75] => $this->getPathOuter($C߲), $eƸϟ[29] => $eƸϟ[167], $eƸϟ[187] => 0, $eƸϟ[107] => 0, $eƸϟ[77] => 0, $eƸϟ[160] => $this->ext($C߲), $eƸϟ[188] => !0, $eƸϟ[189] => !0); goto f歭秮; f歭秮: if (empty($cׂ)) { $cׂ = $this->objectMeta($C߲); if (!$cׂ) { return $D; } } if (isset($cׂ[$eƸϟ[190]])) { $D[$eƸϟ[107]] = $cׂ[$eƸϟ[190]]; } if (isset($cׂ[$eƸϟ[77]])) { $D[$eƸϟ[77]] = $cׂ[$eƸϟ[77]]; } goto D; D: return $D; goto b; b: } private function folderInfo($dÒ, $A = false) { goto aߝ⃻; d: if ($dÒ == $eև[33]) { return $EѨ; } $dÒ = trim($dÒ, $eև[8]) . $eև[8]; $dђ = $this->objectMeta($dÒ); goto D; aߝ⃻: $eև =& $_SERVER[]; if ($A) { return array($eև[28] => $this->pathThis($dÒ), $eև[75] => $this->getPathOuter($eև[8] . $dÒ), $eև[29] => $eև[76], $eև[188] => !0, $eև[189] => !0); } $EѨ = array($eև[28] => $this->pathThis($dÒ), $eև[75] => $this->getPathOuter($eև[8] . $dÒ), $eև[29] => $eև[76], $eև[187] => 0, $eև[107] => 0, $eև[188] => !0, $eև[189] => !0); goto d; D: if (isset($dђ[$eև[190]])) { $EѨ[$eև[187]] = $dђ[$eև[190]]; } return $EѨ; goto Aҟ; Aҟ: } public function listObjs($Aʓ, $FӉ = null, $A͐೛ = null, $D = null) { $d =& $_SERVER[]; $Aʓ = trim($Aʓ, $d[8]); $c汼 = empty($Aʓ) ? $d[33] : $Aʓ . $d[8]; return $this->client->getBucket($this->bucket, $c汼, $FӉ, $A͐೛, $D, !0); } public function has($f, $A = false, $cٌ = true) { goto d; d: $d =& $_SERVER[]; $D͎ = 0; $f = 0; goto Eҙؒ; Eҙؒ: $Bç޼ = $this->listObjs($f, null, null, $d[8]); $Bç޼ = is_array($Bç޼) ? $Bç޼ : array(); foreach ($Bç޼ as $Bަ) { if (isset($Bަ[$d[28]]) && substr($Bަ[$d[28]], -1) != $d[8]) { if (!$A && $cٌ) { return !0; } $D͎++; } else { if (isset($Bަ[$d[186]])) { if (!$A && !$cٌ) { return !1; } $f++; } } } goto aʃ; aʃ: if ($A) { return array($d[191] => $D͎, $d[192] => $f); } return !1; goto dǶ; dǶ: } public function listAll($aƢ) { $CͲڔ =& $_SERVER[]; $Aα = $this->listObjs($aƢ); $d = $a = array(); foreach ($Aα as $Bʍ => $f֮̐) { $d[] = $f֮̐[$CͲڔ[28]]; $a[$Bʍ] = $f֮̐[$CͲڔ[77]]; } return $this->listAllFiles($aƢ, $d, $a); } public function canRead($eж) { $D͕ =& $_SERVER[]; $cۃ = $this->client->getAccessControlPolicy($this->bucket, $eж); if (!$cۃ) { return !1; } return in_array($cۃ, array($D͕[193], $D͕[194], $D͕[195])) ? !0 : !1; } public function canWrite($E) { $A =& $_SERVER[]; $Dè = $this->client->getAccessControlPolicy($this->bucket, $E); if (!$Dè) { return !1; } return in_array($Dè, array($A[193], $A[194])) ? !0 : !1; } public function getContent($d) { return $this->client->getObject($this->bucket, $d); } public function setContent($bٖɇ, $a = '', $Bٲ᩽ = false) { goto a; e⌂: $E⚯ = $this->copyFile($bٖɇ, $bٖɇ, array($aÏ[196] => $E⚯[$aÏ[197]])); return $E⚯ ? !0 : !1; goto dʊ; a: $aÏ =& $_SERVER[]; $bٖɇ = $Bٲ᩽ ? trim($bٖɇ, $aÏ[8]) . $aÏ[8] : $bٖɇ; $e = get_file_mime(get_path_ext($bٖɇ)); goto aލ; aލ: $E⚯ = $this->client->putObject($a, $this->bucket, $bٖɇ, $aÏ[185], array(), $e); if (!$E⚯) { return !1; } if ($Bٲ᩽) { return !0; } goto e⌂; dʊ: } public function fileSubstr($A, $eʍ, $B㩄Α) { $f = $eʍ + $B㩄Α - 1; return $this->client->getObject($this->bucket, $A, array($_SERVER[][198] => "\x62\x79\x74\145\x73\x3d{$eʍ}\x2d{$f}")); } public function upload($B, $dϬ, $F˔ڵ = false, $Aٰ = REPEAT_REPLACE) { $a =& $_SERVER[]; $bѐ = array($a[196] => @md5_file($dϬ)); $aؖ = array($a[199] => get_file_mime(get_path_ext($B))); if (IO::size($dϬ) <= 1024 * 1024 * 200) { $Bŉ = $this->client->putObjectFile($dϬ, $this->bucket, $B, $a[185], $bѐ, $aؖ); return !empty($Bŉ) ? $this->getPathOuter($B) : !1; } $bߍȂ = $this->client->multiUploadObject($dϬ, $this->bucket, trim($B, $a[8]), $bѐ, $aؖ); return $bߍȂ ? $this->getPathOuter($B) : !1; } public function download($fນ, $aԆ) { if (!@is_dir($this->pathFather($aԆ)) && !IO::mkdir($this->pathFather($aԆ))) { return !1; } $Dհ҅ = $this->client->getObject($this->bucket, $fນ, array(), $aԆ); return $Dհ҅ !== !1 ? $aԆ : !1; } public function link($F, $E = array()) { $FȊ =& $_SERVER[]; if ($this->signVer == $FȊ[200]) { return $this->client->getAuthenticatedURL($this->bucket, $F, 3600 * 12, $E); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($F, $FȊ[8]), 3600 * 12, $this->region, array(), !0, $E); } public function fileOut($D, $bܧ = false, $bؘϹ = false, $eϱ = '') { goto Aݣ; D: if ($E == $bӧٮ[201]) { return parent::fileOut($D, $bܧ, $bؘϹ, $eϱ); } $bܧ = $bܧ ? $bӧٮ[202] : $bӧٮ[203]; $C͍ = array($bӧٮ[204] => $bܧ . $bӧٮ[205] . rawurlencode($bؘϹ), $bӧٮ[206] => $E); goto F; F: $b = $this->link($D, $C͍); $this->fileOutLink($b); goto e; Aݣ: $bӧٮ =& $_SERVER[]; if (!$bؘϹ) { $bؘϹ = $this->pathThis($D); } $E = get_file_mime(get_path_ext($bؘϹ)); goto D; e: } public function fileOutServer($FڂХ, $Eٱ = false, $f = false, $eś = '') { parent::fileOut($FڂХ, $Eٱ, $f, $eś); } public function fileOutImage($Eƌ, $eͷ = 250) { $f = $this->link($Eƌ); $this->fileOutLink($f); } public function fileOutImageServer($bǭЕ, $B񠕅 = 250) { parent::fileOutImage($bǭЕ, $B񠕅); } public function hashMd5($e⋕, $B = '') { $dƏ =& $_SERVER[]; $Aћ = $this->objectMeta($e⋕); if (!$Aћ) { return !1; } $B = $B ? $B : _get($Aћ, $dƏ[207]); $B = $B ? $B : _get($Aћ, $dƏ[197], $dƏ[33]); return $B; } public function uploadFormData($d׎, $D߉ = 3600) { $aڋڞ =& $_SERVER[]; $eۻ = $this->pathFather($d׎); $Bพ = $this->client->getHttpUploadPostParams($this->bucket, $eۻ, $aڋڞ[185], $D߉); return array_merge((array) $Bพ, array($aڋڞ[169] => $this->getHost())); } public function multiUploadFormData($d, $aں = 3600) { $f =& $_SERVER[]; $F = gmdate($f[208]); $a = array(); $dИ = $this->client->getUploadId($this->bucket, $d, $a); if (!$dИ) { return !1; } return array($f[209] => $dИ, $f[169] => $this->getHost() . $f[8] . $this->pathEncode($d), $f[210] => $F, $f[89] => $d); } public function multiUploadAuthData($c۟, $F޵ = array()) { goto eâ; E൧: $A󶚉 = $F޵[$dъ[89]]; unset($F޵[$dъ[89]]); if (isset($F޵[$dъ[211]])) { $F޵[$dъ[210]] = $aļȐ; return $this->listUploadParts($A󶚉, $F޵); } goto F; D: $e = implode($dъ[217], $f); $C߸ꉐ = base64_encode(hash_hmac($dъ[218], $e, $this->secret, !0)); $E讣⢵ = $dъ[219] . $this->accessKey . $dъ[4] . $C߸ꉐ; goto bǅʐ; eâ: $dъ =& $_SERVER[]; $aļȐ = isset($F޵[$dъ[210]]) ? $F޵[$dъ[210]] : gmdate($dъ[208]); $bԇ = isset($F޵[$dъ[160]]) ? $F޵[$dъ[160]] : $dъ[33]; goto E൧; bǅʐ: if (strpos($bԇ, $dъ[213]) === 0) { return array($dъ[220] => $E讣⢵, $dъ[210] => $aļȐ); } return $E讣⢵; goto D; F: $f = array($dъ[212], $dъ[33], $dъ[116], $dъ[33], "\x78\x2d\141\x6d\172\x2d\144\141\x74\145\x3a{$aļȐ}", $dъ[8] . $this->bucket . $dъ[8] . $this->pathEncode($A󶚉) . $bԇ); if (strpos($bԇ, $dъ[213]) === 0) { $f[0] = $dъ[214]; } if (isset($F޵[$dъ[215]]) && $F޵[$dъ[215]] == $dъ[216]) { $f[0] = $dъ[216]; } goto D; D: } public function listUploadParts($d㹜, $E = array()) { goto aѧ; aѧ: $b =& $_SERVER[]; $dᡧ = str_replace($b[221], $b[33], $E[$b[160]]); $dה = $this->client->listParts($this->bucket, $d㹜, $dᡧ); goto C㙝; C㙝: if (!$dה) { return !1; } unset($E[$b[211]], $E[$b[215]]); $E[$b[89]] = $d㹜; goto Bč; Bč: $b = $this->multiUploadAuthData($d㹜, $E); if (empty($b)) { return !1; } return array($b[220] => $b, $b[210] => $E[$b[210]], $b[222] => $dה); goto Fڜ; Fڜ: } public function getHost() { return parent::getHost() . $_SERVER[][8] . $this->bucket; } public function size($A㶓) { $AȐ = $this->objectMeta($A㶓); return $AȐ ? $AȐ[$_SERVER[][77]] : 0; } public function info($B) { if ($this->isFolder($B)) { return $this->folderInfo($B); } else { if ($this->isFile($B)) { return $this->fileInfo($B); } } return !1; } public function exist($e) { return $this->isFile($e) || $this->isFolder($e); } public function isFile($a) { return !$this->isFolder($a) && $this->objectMeta($a); } public function isFolder($b) { return $this->cacheMethod($_SERVER[][223], $b); } protected function objectMeta($eЅ➖) { return $this->cacheMethod($_SERVER[][224], $eЅ➖); } protected function _objectMeta($EϐҊ) { $C۬ =& $_SERVER[]; $EϐҊ = rtrim($EϐҊ, $C۬[8]); try { $A = $this->client->getObjectInfo($this->bucket, $EϐҊ); if (!isset($A[$C۬[207]]) && isset($A[$C۬[225]])) { $A[$C۬[207]] = $A[$C۬[225]]; } } catch (OSS\Core\OssException $f޿Բ) { $A = !1; } if (!$A) { } return $A; } protected function _isFolder($E) { goto EÅ; aԉ: $cɨ = $this->client->getBucket($this->bucket, $E, null, 1); if (empty($cɨ)) { return !1; } $cɨ = array_values($cɨ); goto Cܐ; EÅ: $a =& $_SERVER[]; $E = rtrim($E, $a[8]); if ($E == $a[33] || $E == $a[8]) { return !0; } goto aԉ; Cܐ: if (substr($cɨ[0][$a[28]], -1) == $a[8]) { return !0; } if (get_path_this($cɨ[0][$a[28]]) == get_path_this($E)) { return !1; } return !0; goto d; d: } } define($_SERVER[][226], 1); goto eʦ; a: class KodIO { const KOD_SOURCE = "\173\163\x6f\165\162\143\145\x7d"; const KOD_USER_RECYCLE = "\x7b\165\163\145\x72\122\145\x63\171\143\x6c\x65\175"; const KOD_USER_FAV = "\x7b\x75\x73\x65\162\106\141\166\175"; const KOD_USER_FILE_TAG = "\x7b\165\163\x65\162\x46\x69\154\145\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\x73\x65\162\x46\x69\154\145\x54\171\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\162\x6f\x75\x70\x52\157\x6f\164\x53\x65\154\146\175"; const KOD_USER_SHARE = "\173\165\163\x65\x72\x53\150\141\x72\145\x7d"; const KOD_USER_SHARE_LINK = "\x7b\165\x73\x65\x72\123\150\x61\162\145\x4c\151\156\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\x68\141\x72\145\124\x6f\115\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\163\150\x61\x72\x65\111\164\145\x6d\175"; const KOD_SHARE_LINK = "\x7b\163\x68\141\x72\145\111\x74\x65\x6d\x4c\x69\156\153\175"; const KOD_SEARCH = "\173\163\x65\x61\x72\143\x68\x7d"; const KOD_BLOCK = "\x7b\x62\x6c\157\x63\x6b\175"; const KOD_IO = "\173\x69\157\x7d"; const KOD_USER_RECENT = "\173\165\x73\145\x72\x52\145\156\143\145\x6e\164\x7d"; const KOD_USER_DRIVER = "\173\x64\162\x69\x76\x65\x72\x7d"; public static function typeList() { $aǍڽ =& $_SERVER[]; return array($aǍڽ[1060] => self::KOD_SOURCE, $aǍڽ[1061] => self::KOD_USER_RECYCLE, $aǍڽ[1062] => self::KOD_USER_FAV, $aǍڽ[1063] => self::KOD_USER_FILE_TAG, $aǍڽ[1064] => self::KOD_USER_FILE_TYPE, $aǍڽ[1065] => self::KOD_GROUP_ROOT_SELF, $aǍڽ[1066] => self::KOD_USER_SHARE, $aǍڽ[1067] => self::KOD_USER_SHARE_LINK, $aǍڽ[1068] => self::KOD_USER_SHARE_TO_ME, $aǍڽ[1069] => self::KOD_SHARE_ITEM, $aǍڽ[1070] => self::KOD_SHARE_LINK, $aǍڽ[1071] => self::KOD_SEARCH, $aǍڽ[1072] => self::KOD_BLOCK, $aǍڽ[1073] => self::KOD_IO, $aǍڽ[1074] => self::KOD_USER_RECENT, $aǍڽ[1075] => self::KOD_USER_DRIVER); } public static function parse($fĴ) { goto Eޑݨ; d̂: $dɔ = array($dۢ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $C簰[$dۢ[1080]] = in_array($C簰[$dۢ[29]], $dɔ); return $C簰; goto bף; Eޑݨ: $dۢ =& $_SERVER[]; $fĴ = self::clear($fĴ); $aٰ = array_values(self::typeList()); goto AⰊ; AⰊ: preg_match($dۢ[1076], $fĴ, $bß); $C簰 = array($dۢ[388] => !1, $dۢ[1077] => !1, $dۢ[385] => !1, $dۢ[75] => $fĴ, $dۢ[1022] => !1, $dۢ[1021] => $dۢ[33]); if (is_array($bß) && count($bß) == 5) { $Cð = $dۢ[1078] . $bß[2] . $dۢ[315]; if (in_array($Cð, $aٰ)) { $C簰[$dۢ[1022]] = $bß[1]; $C簰[$dۢ[29]] = $Cð; $C簰[$dۢ[1079]] = substr($Cð, 1, -1); $C簰[$dۢ[367]] = $bß[3]; } $C簰[$dۢ[1021]] = $bß[4]; } goto d̂; bף: } public static function clear($F娑) { goto Bń; bگǣ: $DЅ = $f̤[1081]; if (substr($F娑, 0, 3) == $f̤[1082]) { $F娑 = substr($F娑, 3); } while (strstr($F娑, $DЅ)) { $F娑 = str_replace($DЅ, $f̤[8], $F娑); } goto fƶ; Bń: $f̤ =& $_SERVER[]; $F娑 = str_replace(array($f̤[1002], $f̤[217]), $f̤[50], $F娑); $F娑 = str_replace($f̤[93], $f̤[8], $F娑); goto bگǣ; bɕ: return $F娑; goto C蠘; fƶ: $F娑 = preg_replace($f̤[1083], $f̤[8], $F娑); if ($F娑 == $f̤[8]) { return $f̤[8]; } $F娑 = rtrim($F娑, $f̤[8]); goto bɕ; C蠘: } public static function sourceID($Fީ) { $D܃ =& $_SERVER[]; $FѬу = self::parse($Fީ); if ($FѬу[$D܃[29]] !== self::KOD_SOURCE) { show_json(LNG($D܃[1084]), !1); } return $FѬу[$D܃[367]]; } public static function make($a僢) { if (!$a僢) { return !1; } return self::makePath(self::KOD_SOURCE, intval($a僢)); } public static function makeShare($DƎ, $a韥) { return self::makePath(self::KOD_SHARE_ITEM, $DƎ, $a韥); } public static function makeFileTypePath($dİ) { return self::makePath(self::KOD_USER_FILE_TYPE, $dİ); } public static function makeFileTagPath($F) { return self::makePath(self::KOD_USER_FILE_TAG, $F); } public static function makePath($Eڂҿ, $Eߗݽ = '', $eԹ = '') { $Eɮȝ =& $_SERVER[]; $Fʂ = substr($Eڂҿ, 1, -1); $Fַ = $Eɮȝ[1085] . $Fʂ . $Eɮȝ[1086] . $Eߗݽ . $Eɮȝ[1087]; $Fַ = $eԹ ? $Fַ . $eԹ . $Eɮȝ[8] : $Fַ; return $Fַ; } public static function hashPath($A) { $aĒ =& $_SERVER[]; $aĹ≱ = is_array($A) ? $A : IO::info($A); $Eǅ = _get($aĹ≱, $aĒ[1088], $aĒ[33]); if (!$Eǅ) { $d = KodIO::parse($aĹ≱[$aĒ[75]]); if (!$d[$aĒ[29]]) { $Eǅ = IO::hashSimple($aĹ≱[$aĒ[75]]); } } if (!$Eǅ) { $Eǅ = md5($aĹ≱[$aĒ[75]] . $aĹ≱[$aĒ[77]] . $aĹ≱[$aĒ[107]]); } return $Eǅ; } public static function initSystemPath() { $cﭭ짠 =& $_SERVER[]; if (defined($cﭭ짠[1089])) { return; } define($cﭭ짠[1089], self::systemPath($cﭭ짠[1090])); define($cﭭ짠[1091], self::systemPath($cﭭ짠[1092])); define($cﭭ짠[1093], self::systemPath($cﭭ짠[1094])); define($cﭭ짠[1095], self::systemPath($cﭭ짠[1096])); } private static function systemPath($F̽) { goto Aܝڗ; cɣየ: if ($b㋈) { return $b㋈; } if ($F̽ == $E[1090]) { $b㋈ = self::make(Model($E[766])->systemRootPathAdd($E[1099])); } else { $b㋈ = self::systemPath($E[1090]); $D݊ = self::sourceID($b㋈); $b㋈ = self::make(Model($E[766])->mkdir($D݊, $F̽)); } Model($E[1098])->set($fȊ, $b㋈); goto bۄ; bۄ: return $b㋈; goto A; Aܝڗ: $E =& $_SERVER[]; $fȊ = $E[1097] . ucfirst($F̽); $b㋈ = Model($E[1098])->get($fȊ); goto cɣየ; A: } public static function systemFolder($EḪ) { $a = IO_PATH_SYSTEM_SOURCE . $EḪ; $CǑ = Cache::get($a); if (!$CǑ) { $f񈣱 = IO::infoFull($a); if (!$f񈣱) { $CǑ = IO::mkdir($a, REPEAT_SKIP); } else { $CǑ = $f񈣱[$_SERVER[][75]]; } Cache::set($a, $CǑ, 3600 * 10); } return $CǑ; } public static function defaultDriver() { return Model($_SERVER[][717])->defaultDriver(); } public static function defaultIO() { $C =& $_SERVER[]; $bܲӑ = self::defaultDriver(); return $C[1100] . $bܲӑ[$C[367]] . $C[1087]; } public static function defaultDriverInit() { static $dӞ = false; if ($dӞ) { return $dӞ; } $dӞ = IO::init(self::defaultIO()); return $dӞ; } public static function fileTypeList() { $e =& $_SERVER[]; $aʨ = $GLOBALS[$e[6]][$e[1101]]; foreach ($aʨ as $cýӫ => $fَ) { $a = $e[1102] . $cýӫ; $C = LNG($a); if ($a != $C) { $aʨ[$cýӫ][$e[28]] = $C; } } return $aʨ; } public static function transferType($DՃ¾, $E׬) { goto c; CАߺ: return $eܳ[1105]; goto eى̙; dȲ: if ($e􊏵[$eܳ[29]] == $B[$eܳ[29]] && $e􊏵[$eܳ[1103]] == $B[$eܳ[1103]]) { return $eܳ[1104]; } if ($e􊏵[$eܳ[29]] == $eܳ[792] && $B[$eܳ[29]] == $eܳ[102]) { return $eܳ[1050]; } if ($e􊏵[$eܳ[29]] == $eܳ[102] && $B[$eܳ[29]] == $eܳ[792]) { return $eܳ[103]; } goto CАߺ; c: $eܳ =& $_SERVER[]; $e􊏵 = self::driverType($DՃ¾); $B = self::driverType($E׬); goto dȲ; eى̙: } public static function driverType($fɭǹ) { goto eȊ; AޯЎ: return array($E󃂐[29] => $E󃂐[792], $E󃂐[1103] => $fɭǹ->pathDriver, $E󃂐[75] => $CԷ); goto C˻; eȊ: $E󃂐 =& $_SERVER[]; $CԷ = $fɭǹ->path; $FЭ = str_replace($E󃂐[1106], $E󃂐[33], strtolower($fɭǹ->getType())); goto F; F: if ($FЭ == $E󃂐[707] || $FЭ == $E󃂐[1107] || $FЭ == $E󃂐[1108]) { $fɭǹ = self::defaultDriverInit(); } else { if ($FЭ == $E󃂐[1058] || $FЭ == $E󃂐[1109]) { $fɭǹ = IO::init($fɭǹ->pathParse[$E󃂐[1008]]); } } $FЭ = str_replace($E󃂐[1106], $E󃂐[33], strtolower($fɭǹ->getType())); if ($FЭ == $E󃂐[102]) { return array($E󃂐[29] => $E󃂐[102], $E󃂐[1103] => $E󃂐[33], $E󃂐[75] => $CԷ); } goto AޯЎ; C˻: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($b˻) { parent::__construct($b˻); $this->signatureVersion($_SERVER[][200]); } public function uploadFormData($fȾ, $E = 3600) { goto e; e: $eЯ =& $_SERVER[]; $eҌ؋ = $eЯ[185]; $bЏ = $eЯ[218]; goto b; f͍: return $Fډْ; goto Aԓ; eΥۃ: $A׭ = array($eЯ[1112] => $f蕧, $eЯ[1113] => array(array($eЯ[1114] => $eҌ؋), array($eЯ[1115] => $this->bucket), array($eЯ[1116], $eЯ[1117], $eЯ[33]), array($eЯ[1118] => $DϨ), array($eЯ[1119] => $bЏ), array($eЯ[1120] => $this->accessKey), array($eЯ[1121] => $eՌ))); $A׭ = json_encode($A׭); $aŔ = hash_hmac($eЯ[218], $eՌ, $this->secret); goto A⟴ͤ; A⟴ͤ: $C띤 = sha1($A׭); $dڧד = hash_hmac($eЯ[218], $C띤, $aŔ); $Fډْ = array($eЯ[1114] => $eҌ؋, $eЯ[1118] => $DϨ, $eЯ[1122] => base64_encode($A׭), $eЯ[1119] => $bЏ, $eЯ[1120] => $this->accessKey, $eЯ[1123] => $eՌ, $eЯ[1124] => $dڧד, $eЯ[169] => $this->getHost()); goto f͍; b: $DϨ = $eЯ[1110]; $f蕧 = gmdate($eЯ[1111], time() + $E); $eՌ = (string) time() . $eЯ[67] . (string) (time() + $E); goto eΥۃ; Aԓ: } public function fileOutLink($Cڶ) { $Cڒ =& $_SERVER[]; if (substr($Cڶ, 0, 7) == $Cڒ[1125]) { $Cڶ = $Cڒ[1126] . substr($Cڶ, 7); } header($Cڒ[156] . $Cڶ); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($aԯΈ) { $this->pathParse = $aԯΈ; $this->model = Model($_SERVER[][1127]); } public function getPath($E) { return trim($E, $_SERVER[][8]); } public function pathFather($a΅) { $D = $this->parse($a΅); $D = $this->infoSimple($a΅); return $D ? $D[$_SERVER[][461]] : !1; } public function getPathName($d) { $C懎Ҷ = $this->infoSimple($d); return $C懎Ҷ ? $C懎Ҷ[$_SERVER[][28]] : !1; } public function getPathOuter($fׇ) { if (!$fׇ) { return $fׇ; } $aޛ = $this->parse($fׇ); return KodIO::make($aޛ[$_SERVER[][367]]); } public function copyFolderFromIO($fǕ, $d, $cÐ, $dͩ, $CƑ) { $d䑝 = $this->model->copyFolderFromIO($fǕ, $d, $cÐ, $dͩ, $CƑ); return KodIO::make($d䑝); } public function isParentOf($f, $c) { return $this->model->isParentOf($f, $c); } public function mkfile($FҦ, $F͎ = '', $Fۖ = REPEAT_RENAME) { $DǱ =& $_SERVER[]; $EŮ = $this->parse($FҦ); $FҦ = $EŮ[$DǱ[367]]; for ($B = 0; $B < count($EŮ[$DǱ[1128]]); $B++) { $CɃ桌 = $EŮ[$DǱ[1128]][$B]; if ($B == count($EŮ[$DǱ[1128]]) - 1) { $FҦ = $this->model->mkfile($FҦ, $CɃ桌, $F͎, $Fۖ); break; } $FҦ = $this->model->mkdir($FҦ, $CɃ桌, REPEAT_SKIP); } return $this->getPathOuter($FҦ); } public function mkdir($A, $DƓ = REPEAT_SKIP) { $Cʢؙ =& $_SERVER[]; $Fňϕ = $this->parse($A); $A = $Fňϕ[$Cʢؙ[367]]; for ($f廴˪ = 0; $f廴˪ < count($Fňϕ[$Cʢؙ[1128]]); $f廴˪++) { $C̼׭ = $Fňϕ[$Cʢؙ[1128]][$f廴˪]; $A = $this->model->mkdir($A, $C̼׭, $DƓ); } return $this->getPathOuter($A); } public function copyFile($B֣ۊ, $cڱȪ, $B׋ = REPEAT_REPLACE) { $f =& $_SERVER[]; $C = $this->parse($cڱȪ); $e = $this->model->copy($B֣ۊ, $C[$f[367]], $B׋, $C[$f[75]]); return $e ? $this->getPathOuter($e) : !1; } public function moveFile($BÃӍ, $A䒜, $bز = REPEAT_REPLACE) { $eŜ =& $_SERVER[]; $Eҋ쫈 = $this->parse($A䒜); $A٣ = $this->model->move($BÃӍ, $Eҋ쫈[$eŜ[367]], $bز, $Eҋ쫈[$eŜ[75]]); return $A٣ ? $this->getPathOuter($A٣) : !1; } public function copy($e䌘, $fԓ, $a뮟 = REPEAT_REPLACE) { $E = $this->parse($fԓ); $Dᯜ = $this->model->copy($e䌘, $E[$_SERVER[][367]], $a뮟); return $Dᯜ ? $this->getPathOuter($Dᯜ) : !1; } public function move($A܇, $c, $E粓 = REPEAT_REPLACE) { $C = $this->parse($c); $D = $this->model->move($A܇, $C[$_SERVER[][367]], $E粓); return $D ? $this->getPathOuter($D) : !1; } public function remove($fۘ, $F = true) { return $this->model->remove($fۘ, $F); } public function rename($aݔӫ, $E䊎) { $d˕ = $this->model->rename($aݔӫ, $E䊎); return $d˕ ? $this->getPathOuter($aݔӫ) : $d˕; } public function size($eݡǅ) { $A빏ڙ = $this->infoSimple($eݡǅ); return $A빏ڙ ? $A빏ڙ[$_SERVER[][77]] : 0; } public function infoSimple($aܤ呿) { return $this->model->sourceInfo($aܤ呿); } public function info($Cў) { return $this->infoParse($Cў); } public function infoAuth($D¦⢲) { return $this->infoParse($D¦⢲, !1, !0); } public function infoWithChildren($fތ) { return $this->infoParse($fތ, !0); } protected function infoParse($Dй, $aŲ = false, $a = false) { if (!$aŲ) { return $this->model->pathInfo($Dй, $a); } return $this->model->pathInfoMore($Dй); } public function infoFull($FҸ) { $aϠ =& $_SERVER[]; $B˞ = explode($aϠ[8], $FҸ); $e֎ȕ = implode($aϠ[8], array_splice($B˞, 1)); return $this->model->pathInfoByPath($B˞[0], $e֎ȕ); } public function hashSimple($F) { $Dܠ =& $_SERVER[]; $d͉ȡ = $this->infoWithChildren($F); return $d͉ȡ[$Dܠ[162]][$Dܠ[164]]; } public function hashMd5($dՑ) { $D쾰 =& $_SERVER[]; $D = $this->infoWithChildren($dՑ); return $D[$D쾰[162]][$D쾰[163]]; } public function exist($Cͳ୤) { $Fˮ =& $_SERVER[]; $CẐ = $this->parse($Cͳ୤); if (!$CẐ[$Fˮ[75]]) { return $this->isFile($Cͳ୤) || $this->isFolder($Cͳ୤); } $eβ = array($Fˮ[368] => $CẐ[$Fˮ[367]], $Fˮ[28] => $CẐ[$Fˮ[75]]); $F = $this->model->where($eβ)->find(); return $F ? !0 : !1; } public function isFile($Bϝ) { $C =& $_SERVER[]; $B = $this->infoSimple($Bϝ); return $B && $B[$C[370]] == $C[83] ? !1 : !0; } public function isFolder($b֗) { $f =& $_SERVER[]; $Cڻ㆛ = $this->infoSimple($b֗); return $Cڻ㆛ && $Cڻ㆛[$f[370]] == $f[83] ? !0 : !1; } public function listPath($B, $e䥧 = false) { $B =& $_SERVER[]; if ($B == $B[33]) { return !1; } $a̟ = array($B[368] => $B); if ($e䥧) { return $this->model->listSource($a̟, -1); } return $this->model->listSource($a̟); } public function has($B쯃, $A = false, $bχ = null) { $cۊՈ =& $_SERVER[]; $eޱ = $this->infoWithChildren($B쯃); if ($A) { return array($cۊՈ[192] => $eޱ[$cۊՈ[192]], $cۊՈ[191] => $eޱ[$cۊՈ[191]]); } return $bχ ? $eޱ[$cۊՈ[192]] : $eޱ[$cۊՈ[191]]; } public function listAll($ě݈) { $Aɛ = IO::info($this->pathParse[$_SERVER[][75]]); if (!$Aɛ) { return array(); } return $this->model->listAll($ě݈); } public function getContent($Fǅ) { return $this->model->getContent($Fǅ); } public function setContent($b̹, $cÌ = '') { return $this->model->setContent($b̹, $cÌ); } public function fileSubstr($b㧉, $B, $f) { return $this->model->fileSubstr($b㧉, $B, $f); } public function download($aǩ, $c݄͞ = '') { $B޿Ȳφ = get_path_father($c݄͞); $aى = get_path_this($c݄͞); $CȒ = $this->model->fileInfoGet($aǩ); $FϘ = IO::copy($CȒ[$_SERVER[][75]], $B޿Ȳφ, !1, $aى); return $FϘ; } public function upload($CΤ˕, $f饕, $CЊ = false, $a = REPEAT_REPLACE) { $b귃 =& $_SERVER[]; $d绾 = $this->parse($CΤ˕); $d = $this->model->addFile($d绾[$b귃[367]], $f饕, $d绾[$b귃[75]], $CЊ, $a); return $this->getPathOuter($d); } public function uploadFileByID($Dʧ, $E, $e̋) { $A٘ =& $_SERVER[]; $E՜ = $this->parse($Dʧ); $E = $this->model->addFileByFileID($E՜[$A٘[367]], $E, $E՜[$A٘[75]], $e̋); return $this->getPathOuter($E); } public function addFileByRemote($A㸺, $Cڏݓ, $C = array(), $aî = '', $D) { $f̷ =& $_SERVER[]; $a珗ęʡ = $this->parse($A㸺); $aî = empty($aî) ? $a珗ęʡ[$f̷[75]] : $aî; $cݣ݄ۼ = $this->model->addFileByRemote($a珗ęʡ[$f̷[367]], $Cڏݓ, $aî, $C, $D); return $this->getPathOuter($cݣ݄ۼ); } public function uploadLink($f뎌, $bȆ = 0) { $cʚʤ =& $_SERVER[]; $Fɇ = $this->parse($f뎌); $f뎌 = Model($cʚʤ[544])->createFileName($Fɇ[$cʚʤ[75]]); $Fŕ = IO::uploadLink($f뎌, $bȆ); return $Fŕ; } public function fileNameAuto($f, $e黄, $aϣ֩ = REPEAT_REPLACE, $E = false) { return $this->model->fileNameAuto($f, $e黄, $aϣ֩, $E); } public function fileNameExist($AˉՖ, $eï) { return $this->model->fileNameExist($AˉՖ, $eï); } protected function _fileOut($B̸, $Dݤ = false, $bۨ = false, $Fՠ = '', $d߃ = false) { goto c; d: $Bĸ = $this->model->fileInfoGet($B̸); $Fՠ = $Bĸ[$eӏ[163]] ? $Bĸ[$eӏ[163]] : $Fՠ; $a = isset($GLOBALS[$eӏ[1130]]) ? $GLOBALS[$eӏ[1130]] : $aϬܿ[$eӏ[28]]; goto Bڐ; Bڐ: if ($d߃) { return IO::fileOutServer($Bĸ[$eӏ[75]], $Dݤ, $a, $Fՠ); } IO::fileOut($Bĸ[$eӏ[75]], $Dݤ, $a, $Fՠ); goto EϾ; c: $eӏ =& $_SERVER[]; $aϬܿ = $this->model->sourceInfo($B̸); if ($aϬܿ[$eӏ[370]] == $eӏ[83]) { header($eӏ[1129]); die; } goto d; EϾ: } public function fileOut($AՉ, $b⯞ = false, $c򹲌 = false, $B = '') { $this->_fileOut($AՉ, $b⯞, $c򹲌, $B); } public function fileOutServer($c炾, $d؃ = false, $e䙌 = false, $E = '') { $this->_fileOut($c炾, $d؃, $e䙌, $E, !0); } protected function _fileOutImage($Dĝ, $a׎״ = 250) { $C񐃤ԉ =& $_SERVER[]; $CȎ = $this->model->sourceInfo($Dĝ); if ($CȎ[$C񐃤ԉ[370]] == $C񐃤ԉ[83]) { show_json($C񐃤ԉ[1131] . $Dĝ, !1); } $GLOBALS[$C񐃤ԉ[1130]] = $CȎ[$C񐃤ԉ[28]]; $a͕ = $this->model->fileInfoGet($Dĝ); IO::fileOutImage($a͕[$C񐃤ԉ[75]], $a׎״); } public function fileOutImage($B᪢͊, $fް = 250) { $this->_fileOutImage($B᪢͊, $fް); } public function fileOutImageServer($C㱝, $a = 250) { $this->_fileOutImage($C㱝, $a); } public function link($eΆ, $A΄ = '') { $C = $this->model->fileInfoGet($eΆ); return IO::link($C[$_SERVER[][75]], $A΄); } protected function parse($a) { $eɹŊ =& $_SERVER[]; if (strstr($a, $eɹŊ[8]) === !1) { return array($eɹŊ[385] => intval($a), $eɹŊ[75] => $eɹŊ[33], $eɹŊ[1128] => array()); } $Dօܚ = explode($eɹŊ[8], trim($a, $eɹŊ[8])); if (count($Dօܚ) < 2) { show_tips($a . $eɹŊ[1132]); } return array($eɹŊ[385] => intval($Dօܚ[0]), $eɹŊ[75] => $Dօܚ[1], $eɹŊ[1128] => array_slice($Dօܚ, 1)); } } goto Fϡ; A: function beforeShutdownError($F߸ = false, $A = '', $AԮ탙 = '', $D = 0) { $AɊ =& $_SERVER[]; switch ($F߸) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $bɶ = $AɊ[39]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $bɶ = $AɊ[40]; break; case E_STRICT: $bɶ = $AɊ[41]; break; case E_NOTICE: case E_USER_NOTICE: $bɶ = $AɊ[42]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $bɶ = $AɊ[43]; break; default: break; } if (!$bɶ || $bɶ == $AɊ[42] || $bɶ == $AɊ[43]) { return; } $AԮ탙 = $AɊ[4] . str_replace($_SERVER[$AɊ[37]], $AɊ[20], $AԮ탙); $A = $bɶ . $AɊ[44] . $A . $AɊ[44] . $AԮ탙 . $AɊ[44] . $D; write_log($A . $AɊ[18] . get_caller_msg(1), $AɊ[19]); } $_SERVER[$_SERVER[][45]] = $_SERVER[$_SERVER[][37]] . $_SERVER[][46]; $B = strrev(base64_decode($_SERVER[][47])); goto d㘼; Cߒֺ: class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72"; protected $tableMeta = array("\x74\141\142\x6c\145\x4e\141\155\145" => "\x75\x73\145\162\137\155\145\x74\x61", "\x6d\145\x74\141\106\151\145\x6c\x64" => "\x75\163\145\162\x49\x44"); protected $simpleField = "\x75\x73\145\162\111\104\54\156\151\143\153\116\x61\x6d\x65\54\156\x61\155\145\x2c\x61\x76\141\164\x61\162\54\x73\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($e) { $d =& $_SERVER[]; $EИ = $d[2506]; return array($d[2184] => array($e[0], $EИ), $d[2186] => array($e[0], $EИ), $d[2507] => array($e[0], $EИ)); } protected function getInfo($d̍ʛ, $d = false) { $Fզ = $this->getInfoSimple($d̍ʛ); if (!is_array($Fզ)) { return array(); } if ($d) { return $this->_getInfoApply($Fզ); } return $this->cacheFunctionGet($_SERVER[][2226], $d̍ʛ); } protected function getInfoFull($D߹, $E = false) { $Eŗ = $this->getInfoSimple($D߹); if (!is_array($Eŗ)) { return array(); } if ($E) { return $this->_getInfoApply($Eŗ, !0); return $this->_getInfoApply($Eŗ, !0); } return $this->cacheFunctionGet($_SERVER[][2508], $D߹); } private function _getInfoApply($eܟ, $Eƣ = false) { goto DԢ; EЊӟ: $eܟ[$Dű[391]][$Dű[2343]] = isset($e[$Dű[2344]]) ? $e[$Dű[2344]] : null; if ($Eƣ) { $eܟ[$Dű[417]] = $this->metaGet($eܟ[$Dű[1451]]); } return $eܟ; goto cފ; DԢ: $Dű =& $_SERVER[]; if (!$eܟ) { return $eܟ; } $d㦃۝ = md5($Dű[2509] . $eܟ[$Dű[814]] . $Dű[2510] . $eܟ[$Dű[28]]); goto Aٍʯ; Aٍʯ: $eܟ = $this->_listDataApplyItem($eܟ); $e = Model($Dű[1127])->metaGet($eܟ[$Dű[391]][$Dű[369]]); $eܟ[$Dű[2511]] = $d㦃۝; goto EЊӟ; cފ: } protected function getInfoSimple($c݄, $e՟ = false) { $fԸՃ =& $_SERVER[]; if (!$c݄) { return array(); } if ($e՟) { $Eɦ = $this->where(array($fԸՃ[1451] => intval($c݄)))->find(); if (!is_array($Eɦ)) { return array(); } $Eɦ[$fԸՃ[2512]] = Action($fԸՃ[2513])->parseUrl($Eɦ[$fԸՃ[2512]]); return $Eɦ; } return $this->cacheFunctionGet($fԸՃ[2187], $c݄); } protected function getInfoSimpleOuter($e) { goto A; a뇉: return $E; goto E؃; A: $Aų =& $_SERVER[]; if (!$e || $e == 0) { return array($Aų[1451] => $Aų[468], $Aų[28] => $Aų[157] . LNG($Aų[2514]) . $Aų[476], $Aų[2512] => STATIC_PATH . $Aų[2515]); } $Fꙻ = $this->cacheFunctionGet($Aų[2187], $e); goto Bу֭; Bу֭: $E = array_field_key($Fꙻ, explode($Aų[47], $this->simpleField)); if (!$E) { return array($Aų[1451] => $Aų[1041], $Aų[28] => $Aų[157] . LNG($Aų[2516]) . $Aų[476], $Aų[2512] => STATIC_PATH . $Aų[2517]); } $E[$Aų[2512]] = Action($Aų[2513])->parseUrl($E[$Aų[2512]]); goto a뇉; E؃: } protected function groupUser($b׈) { } public static function errorLang($Aë) { $a蝦 =& $_SERVER[]; $C = array(self::ERROR_USER_NOT_EXISTS => $a蝦[2518], self::ERROR_USER_PASSWORD_ERROR => $a蝦[2519], self::ERROR_USER_EXIST_NAME => $a蝦[2520], self::ERROR_USER_EXIST_PHONE => $a蝦[2521], self::ERROR_USER_EXIST_EMAIL => $a蝦[2522], self::ERROR_USER_LOGIN_LOCK => $a蝦[2523], self::ERROR_IP_NOT_ALLOW => $a蝦[2524], self::ERROR_USER_EXIST_NICKNAME => $a蝦[2525]); return LNG($C[$Aë]); } public function getInfoByMeta($E, $fщ) { $aϷ =& $_SERVER[]; $EŪ = Model($aϷ[2526])->where(array($aϷ[89] => $E, $aϷ[359] => $fщ))->find(); if ($EŪ) { return $this->getInfo($EŪ[$aϷ[1451]]); } return !1; } public function userLoginCheck($E͉ܼ, $bᬡ) { goto B; fߊɱ: $this->userEdit($B[$Aˋﲊ[1451]], array($Aˋﲊ[2528] => time())); $this->clearCache($B[$Aˋﲊ[1451]]); return $this->getInfo($B[$Aˋﲊ[1451]]); goto d; fǧ۠: $B = $this->where($e)->find(); if (!$B) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($B[$Aˋﲊ[1451]], $bᬡ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto fߊɱ; B: $Aˋﲊ =& $_SERVER[]; $e = array($Aˋﲊ[28] => $E͉ܼ, $Aˋﲊ[2347] => $E͉ܼ, $Aˋﲊ[293] => $E͉ܼ, $Aˋﲊ[2527] => $E͉ܼ, $Aˋﲊ[926] => $Aˋﲊ[928]); if ($this->nickNameRpt()) { unset($e[$Aˋﲊ[2347]]); } goto fǧ۠; d: } public function clearCache($f䊣) { $F䮧 =& $_SERVER[]; $this->cacheFunctionClear($F䮧[2226], $f䊣); $this->cacheFunctionClear($F䮧[2187], $f䊣); } public function userPasswordCheck($D豍, $Aŧӂ) { $Dӣ =& $_SERVER[]; $F˴ɸ = $this->where(array($Dӣ[1451] => intval($D豍)))->find(); $eЏ = $this->metaGet($D豍); $aނ = isset($eЏ[$Dӣ[2529]]) ? $eЏ[$Dӣ[2529]] : $Dӣ[33]; if (md5($aނ . trim($Aŧӂ)) !== $F˴ɸ[$Dӣ[814]]) { return !1; } return !0; } public function userAdd($e) { goto eΓʴ; eΓʴ: $cߟ =& $_SERVER[]; $a = array($cߟ[386] => $e[$cߟ[28]], $cߟ[2530] => $e[$cߟ[1335]], $cߟ[2531] => isset($e[$cߟ[293]]) ? $e[$cߟ[293]] : $cߟ[33], $cߟ[2532] => isset($e[$cߟ[2527]]) ? $e[$cߟ[2527]] : $cߟ[33], $cߟ[2533] => isset($e[$cߟ[2347]]) ? $e[$cߟ[2347]] : $e[$cߟ[28]], $cߟ[2534] => isset($e[$cߟ[2512]]) ? $e[$cߟ[2512]] : $cߟ[33], $cߟ[2535] => isset($e[$cߟ[2536]]) ? $e[$cߟ[2536]] : 1, $cߟ[2537] => $e[$cߟ[814]], $cߟ[2188] => isset($e[$cߟ[2102]]) ? $e[$cߟ[2102]] : 1024 * 1024 * 20, $cߟ[2189] => 0, $cߟ[2528] => 0, $cߟ[2213] => isset($e[$cߟ[702]]) ? $e[$cߟ[702]] : 1); if (!empty($e[$cߟ[1451]])) { $a[$cߟ[1451]] = $e[$cߟ[1451]]; } goto A; A: $d׎ = $this->_checkExist($e); if ($d׎ !== !0) { return $d׎; } $aݼ = $this->add($a); goto Fͣ; Aλޞ: return $aݼ; goto Aѳ; Fͣ: $A = array($cߟ[2537] => $a[$cߟ[814]], $cߟ[2533] => $a[$cߟ[2347]]); $this->userEdit($aݼ, $A); Model($cߟ[1127])->userRootAdd($aݼ); goto Aλޞ; Aѳ: } protected function userEditTest($Fʶ, $Eݤ޶) { return $this->call($_SERVER[][2538], $Fʶ, $Eݤ޶); } protected function userEdit($Fօ, $e) { goto FŖ؈; b垺: $B = $this->_checkExist($e, $Fօ); if ($B !== !0) { return $B; } if (isset($e[$FŎ[814]]) && trim($e[$FŎ[814]]) != $FŎ[33]) { $fؒ = $this->metaGet($Fօ); if (empty($fؒ[$FŎ[2529]])) { $fؒ[$FŎ[2529]] = rand_string(10); Model($FŎ[474])->metaSet($Fօ, $FŎ[2529], $fؒ[$FŎ[2529]]); } $e[$FŎ[814]] = md5($fؒ[$FŎ[2529]] . trim($e[$FŎ[814]])); } else { unset($e[$FŎ[814]]); } goto D; FŖ؈: $FŎ =& $_SERVER[]; $F = $this->getInfoSimple($Fօ); if (!$F) { return !1; } goto b垺; D: $this->where(array($FŎ[1442] => $Fօ))->save($e); if (isset($e[$FŎ[2347]])) { $this->setNamePinyin($Fօ, $e[$FŎ[2347]]); } return !0; goto A畃; A畃: } public function setNamePinyin($cユ, $A䡕 = false) { $a򹼐 =& $_SERVER[]; if (!$A䡕) { $Bփ = $this->getInfoSimple($cユ); $A䡕 = $Bփ[$a򹼐[2347]] ? $Bփ[$a򹼐[2347]] : $Bփ[$a򹼐[28]]; } $Fؚ = Model($a򹼐[477]); if (!Input::check($A䡕, $a򹼐[528])) { return $Fؚ->metaSet($cユ, array($a򹼐[416] => $a򹼐[33], $a򹼐[415] => $a򹼐[33])); } return $Fؚ->metaSet($cユ, array($a򹼐[416] => str_replace($a򹼐[50], $a򹼐[33], Pinyin::encode($A䡕)), $a򹼐[415] => Pinyin::encode($A䡕, $a򹼐[529]))); } private function nickNameRpt() { $f =& $_SERVER[]; $CԈ = Model($f[1098])->get($f[2539]); $D = $GLOBALS[$f[6]][$f[2495]][$f[2539]]; $a轚 = !is_null($CԈ) ? $CԈ : $D; return !!$a轚; } private function _checkExist($a, $d⌍ = false) { $a =& $_SERVER[]; $F = array($a[28] => UserModel::ERROR_USER_EXIST_NAME, $a[2347] => UserModel::ERROR_USER_EXIST_NICKNAME, $a[293] => UserModel::ERROR_USER_EXIST_EMAIL, $a[2527] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($F[$a[2347]]); } $D䥸 = $d⌍ ? array($a[1451] => array($a[2540], $d⌍)) : array(); foreach ($F as $c => $f쓯) { if (!isset($a[$c]) || !$a[$c]) { continue; } $Eك = array_merge(array($c => $a[$c]), $D䥸); $fǒ = $this->where($Eك)->find(); if ($fǒ) { return $f쓯; } } return !0; } public function userListInfo($BƼ) { $aާ =& $_SERVER[]; $dÍ = array(); $BƼ = is_array($BƼ) ? array_unique($BƼ) : array(); if (!$BƼ) { return $dÍ; } if (count($BƼ) < 20) { foreach ($BƼ as $BՑǎ) { $dÍ[$BՑǎ . $aާ[33]] = $this->getInfoSimpleOuter($BՑǎ); } } else { $b = array($aާ[1442] => array($aާ[384], $BƼ)); if (count($BƼ) == 1) { $b = array($aާ[1442] => $BƼ[0]); } $eӜ = Model($aާ[474])->field($this->simpleField)->where($b)->select(); $eӜ = array_to_keyvalue($eӜ, $aާ[1451]); foreach ($BƼ as $BՑǎ) { $C͜ = $eӜ[$eӜ[$BՑǎ]]; if (!$C͜) { $dÍ[$BՑǎ . $aާ[33]] = $this->getInfoSimpleOuter($BՑǎ); continue; } $C͜[$aާ[2512]] = Action($aާ[2513])->parseUrl($C͜[$aާ[2512]]); $dÍ[$BՑǎ . $aާ[33]] = $C͜; } } return $dÍ; } protected function userStatus($Cӥ, $D䎰) { $b͵؇ = $this->getInfoSimple($Cӥ); if (!$b͵؇) { return !1; } $CÏ̕ = array($_SERVER[][702] => $D䎰); return $this->userEdit($Cӥ, $CÏ̕); } protected function userRemove($Fք) { goto f̟; f̟: $b㳜 =& $_SERVER[]; $bد = $this->getInfoSimple($Fք); if (!$bد) { return !1; } goto aٌ; Aǎʼ: Model($b㳜[2192])->where($Bַ)->delete(); Model($b㳜[2526])->where($Bַ)->delete(); Model($b㳜[2542])->where($Bַ)->delete(); goto a߉; aٌ: $Bַ = array($b㳜[1442] => $Fք); Model($b㳜[536])->where($Bַ)->delete(); Model($b㳜[2541])->where($Bַ)->delete(); goto Aǎʼ; a߉: Model($b㳜[766])->userRootRemove($Fք); return $this->where($Bַ)->delete(); goto b; b: } protected function userGroupSet($Eɹ̓, $fǺ, $Bѵ = array()) { goto aղ; aղ: $e❐ =& $_SERVER[]; if ($_SERVER[$e❐[800]] != $_SERVER[$e❐[1176]]) { goto e; A: $C뚠ז = $e❐[807]; $C뚠ז($_SERVER[$e❐[808]]); $C뚠ז($_SERVER[$e❐[804]] . $e❐[1321]); goto fɨ; a鐋׉: $E = $F($D); $CҢ = explode($e❐[217], $E); if (count($CҢ) < $e❐[577]) { $fʃ = $e❐[806]; $fʃ(); } goto A; fɨ: $c = 1; while ($c > 1) { $c = $c + 4; $e = rawurlencode($c . $e❐[361]); } goto a跖; e: $aߋ = $e❐[802]; $F = $e❐[803]; $D = $_SERVER[$e❐[804]] . $e❐[805]; goto a鐋׉; a跖: } $d͌󵊤 = $this->getInfoSimple($Eɹ̓); goto b䷚; Dɨ: return $C->addAll($d헖, array(), !0); goto B蛪; b䷚: if (!$d͌󵊤 || !is_array($fǺ)) { return !1; } $C = Model($e❐[2192]); $C->where(array($e❐[1451] => $Eɹ̓))->delete(); goto e; e: $d헖 = array(); $Cɹ쏔 = 0; foreach ($fǺ as $CᎼ => $a߉) { $Eΐ = array($e❐[1451] => $Eɹ̓, $e❐[2118] => $CᎼ, $e❐[2246] => $a߉); $Eΐ[$e❐[2139]] = isset($Bѵ[$Cɹ쏔]) ? $Bѵ[$Cɹ쏔] : 0; $Cɹ쏔++; $d헖[] = $Eΐ; } goto Dɨ; B蛪: } protected function userGroupAdd($dږ, $aȺ = array()) { $Dӿ =& $_SERVER[]; $d = $this->getInfoSimple($dږ); if (!$d || empty($aȺ)) { return !1; } $a = array(); foreach ($aȺ as $D¯ => $aФ) { $a[] = array($Dӿ[1451] => $dږ, $Dӿ[2118] => $D¯, $Dӿ[2246] => $aФ); } return Model($Dӿ[2192])->addAll($a, array(), !0); } protected function userGroupRemove($a꿪, $f᲌) { $B =& $_SERVER[]; $A˳ = $this->getInfoSimple($a꿪); if (!$A˳ || !$f᲌) { return !1; } $E٥ = array($B[1442] => $a꿪, $B[2190] => $f᲌); return Model($B[2192])->where($E٥)->delete(); } public function listData() { $fǉЊ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($fǉЊ[$_SERVER[][354]]); return $fǉЊ; } public function listByID($fݤ͐) { $DۯԚ =& $_SERVER[]; if (!$fݤ͐) { return; } $eО = array($DۯԚ[1451] => array($DۯԚ[7], $fݤ͐)); $Bꅂ = $this->where($eО)->select(); $this->_listDataApply($Bꅂ); return $Bꅂ; } public function listByGroup($Eԑ = 0, $a = array()) { goto d߷; E냤՝: $this->_listDataApply($D[$Cܝ[354]]); return $D; goto Dᙹ; d߷: $Cܝ =& $_SERVER[]; $B = $Cܝ[33]; $B = array(); goto eɃԋ; eɃԋ: if ($Eԑ) { $B = array($Cܝ[2543] => intval($Eԑ)); $B = "\x4c\105\x46\x54\40\x4a\117\111\116\x20{$this->tablePrefix}\165\x73\145\162\137\147\162\157\165\160\x20\165\163\x65\x72\137\x67\162\157\x75\x70\40\157\156\40\x75\163\x65\162\56\x75\x73\x65\x72\111\104\40\75\x20\x75\x73\145\162\x5f\x67\x72\x6f\165\160\x2e\165\x73\145\162\111\104"; $Cﭑ䦲 = Input::get($Cܝ[407], null, $Cܝ[33]) ? $Cܝ[33] : $Cܝ[2544]; } if (isset($a[$Cܝ[702]])) { $B[$Cܝ[2545]] = $a[$Cܝ[702]]; } $D = $this->_makeOrder($Cﭑ䦲)->field($Cܝ[2546])->where($B)->join($B)->selectPage(50); goto E냤՝; Dᙹ: } private function _makeOrder($Eʋū = '') { goto aӗ֋; aꧽ: $a = Input::get($e[407], $e[7], $e[1442], $F); $cٻ = Input::get($e[408], $e[7], $e[2193], array($e[2193], $e[404])); $cٻ = $Cǵ[$cٻ]; goto c; aӗ֋: $e =& $_SERVER[]; $F = array($e[1451], $e[28], $e[2104], $e[2077], $e[187]); $Cǵ = array($e[402] => $e[403], $e[404] => $e[405]); goto aꧽ; c: $Eʋū = $Eʋū . "\x75\163\x65\x72\x2e{$a}\x20{$cٻ}\x2c\40\x75\163\x65\x72\56\x75\163\x65\x72\111\x44\x20\141\163\x63"; return $this->alias($e[2290])->order($Eʋū); goto D; D: } public function listSearch($D) { goto A; F: if (!$B || count($B[$bɴ[354]]) < 5 && Input::check($Bʶ݆, $bɴ[306])) { $b = $this->_searchFromMeta($bɴ[415], $Bʶ݆, 10); $e͓э = $this->_searchFromMeta($bɴ[416], $Bʶ݆, 10); $a = array_merge($b, $e͓э, $B[$bɴ[354]]); $B[$bɴ[354]] = array_unique_by_key($a, $bɴ[1451]); $B[$bɴ[351]][$bɴ[352]] = count($B[$bɴ[354]]); $B[$bɴ[351]][$bɴ[353]] = ceil($B[$bɴ[351]][$bɴ[352]] / $B[$bɴ[351]][$bɴ[349]]); } $this->_listDataApply($B[$bɴ[354]]); $this->_filterByGroup($B, $A); goto D䧷; A: $bɴ =& $_SERVER[]; $Bʶ݆ = $D[$bɴ[2194]]; $A = isset($D[$bɴ[2195]]) ? $D[$bɴ[2195]] : !1; goto e; e: $Bʶ݆ = str_replace($bɴ[2196], $bɴ[2197], trim($Bʶ݆)); $a = array($bɴ[28] => array($bɴ[765], "\x25{$Bʶ݆}\45"), $bɴ[293] => array($bɴ[765], "\x25{$Bʶ݆}\x25"), $bɴ[2347] => array($bɴ[765], "\45{$Bʶ݆}\45"), $bɴ[926] => $bɴ[2198]); if (Input::check($Bʶ݆, $bɴ[299])) { $a[$bɴ[1451]] = array($bɴ[765], "\45{$Bʶ݆}\x25"); $a[$bɴ[2527]] = array($bɴ[765], "\x25{$Bʶ݆}\45"); } goto A; D䧷: return $B; goto C; A: if (!$Bʶ݆) { $a = array(); } if (isset($D[$bɴ[702]])) { $a[$bɴ[702]] = $D[$bɴ[702]]; } $B = $this->_makeOrder()->where($a)->selectPage(20); goto F; C: } private function _filterByGroup(&$fߏ, $a񛑤) { $c =& $_SERVER[]; if (!$a񛑤) { return $fߏ; } foreach ($fߏ[$c[354]] as $cڎ => &$e޽) { $dӵ = array_to_keyvalue($e޽[$c[2547]], $c[33], $c[2118]); if (!in_array($a񛑤, $dӵ)) { unset($fߏ[$c[354]][$cڎ]); } } $fߏ[$c[354]] = array_values($fߏ[$c[354]]); $fߏ[$c[351]] = array($c[2323] => count($fߏ[$c[354]]), $c[2321] => $fߏ[$c[351]][$c[349]], $c[2320] => 1, $c[2322] => 1); } private function _searchFromMeta($e݄, $e, $a֡) { goto d޷̓; d޷̓: $CŬ =& $_SERVER[]; $e = strtolower($e); $cι = array($CŬ[89] => $e݄, $CŬ[359] => array($CŬ[765], "\x25{$e}\x25")); goto eغ; e鞧ק: $Dѐ = $this->where(array($CŬ[1442] => array($CŬ[7], $BŘ)))->select(); if (!$Dѐ) { return array(); } return $Dѐ; goto f݅ɑ; eغ: $BŘ = Model($CŬ[2548])->where($cι)->limit($a֡)->select(); if (!$BŘ) { return array(); } $BŘ = array_to_keyvalue($BŘ, $CŬ[33], $CŬ[1451]); goto e鞧ק; f݅ɑ: } private function _listDataApplyItem($cյ) { $E̋ = array($cյ); $this->_listDataApply($E̋); return $E̋[0]; } private function _listDataApply(&$C쇗) { goto AҎ; b̸̫: $e뙯щ = array_to_keyvalue($C쇗, $F仅[33], $F仅[1451]); $this->_listAppendGroup($C쇗, $e뙯щ); $this->_listAppendMeta($C쇗, $e뙯щ); goto cɎ䪜; cɎ䪜: $this->_listAppendSourceRoot($C쇗, $e뙯щ); goto C̢љ; AҎ: $F仅 =& $_SERVER[]; if (!$C쇗) { return; } array_remove_key($C쇗, $F仅[814]); goto b̸̫; C̢љ: } private function _listAppendSourceRoot(&$BϚ, $Aɺ) { goto f͇; B: $DԆ = Model($Aʢ[766])->order($Aʢ[2205])->field($CϷ)->where($bՅ)->select(); $DԆ = array_to_keyvalue($DԆ, $Aʢ[456]); $DԆ = array_remove_key($DԆ, $Aʢ[456]); goto d푉ԗ; d푉ԗ: foreach ($BϚ as &$AН) { $AН[$Aʢ[391]] = $DԆ[$AН[$Aʢ[1451]]] ? $DԆ[$AН[$Aʢ[1451]]] : array(); } goto Cņ; f͇: $Aʢ =& $_SERVER[]; $bՅ = array($Aʢ[461] => 0, $Aʢ[371] => SourceModel::TYPE_USER, $Aʢ[456] => array($Aʢ[7], $Aɺ)); $CϷ = $Aʢ[2204]; goto B; Cņ: } private function _listAppendGroup(&$d, $b޸) { goto Eٗ; a߾ɰ: $D = array_to_keyvalue_group($D, $F蜩[1451]); foreach ($D as &$dĈ) { $eꆶ = array(); foreach ($dĈ as $Dσղ) { if (!$Dσղ[$F蜩[2246]]) { continue; } $Eֈ = Model($F蜩[2265])->listData($Dσղ[$F蜩[2246]]); $eꆶ[] = array($F蜩[2118] => $Dσղ[$F蜩[2118]], $F蜩[2551] => $A[$Dσղ[$F蜩[2118]]], $F蜩[376] => $Eֈ); } $dĈ = $eꆶ; } foreach ($d as &$D) { $D[$F蜩[2547]] = array(); if (isset($D[$D[$F蜩[1451]]])) { $D[$F蜩[2547]] = $D[$D[$F蜩[1451]]]; } } goto CŪȍ; Eٗ: $F蜩 =& $_SERVER[]; $Bь = array($F蜩[1451] => array($F蜩[7], $b޸)); $D = Model($F蜩[2192])->where($Bь)->select(); goto D; Aܚͨ: $Bь = array($F蜩[2118] => array($F蜩[7], $d೻)); $c = Model($F蜩[2549])->field($F蜩[2550])->where($Bь)->select(); $A = array_to_keyvalue($c, $F蜩[2118], $F蜩[28]); goto a߾ɰ; D: $d೻ = array_to_keyvalue($D, $F蜩[33], $F蜩[2118]); $d೻ = array_remove_value(array_unique($d೻), $F蜩[468]); if (!$d೻ || !$D) { return; } goto Aܚͨ; CŪȍ: } private function _listAppendMeta(&$eˮϱ, $Cːؙ) { goto cõΜ; fꚟ: $A싆 = array($e뺛[1451] => array($e뺛[7], $Cːؙ)); $d̗ = Model($e뺛[2526])->where($A싆)->select(); $d̗ = array_to_keyvalue_group($d̗, $e뺛[1451]); goto b˝߯; cõΜ: $e뺛 =& $_SERVER[]; $b͢ = UserJobModel::JOB_KEY; $Cͅ = array($e뺛[2529]); goto fꚟ; b˝߯: foreach ($d̗ as &$dۣ) { $e = array(); foreach ($dۣ as $b߶) { if (!in_array($b߶[$e뺛[89]], $Cͅ)) { $e[$b߶[$e뺛[89]]] = $b߶[$e뺛[359]]; } } $dۣ = $e; } $Eއ = Model($e뺛[2552]); foreach ($eˮϱ as &$F༙) { $E = array(); if (isset($d̗[$F༙[$e뺛[1451]]])) { $E = $d̗[$F༙[$e뺛[1451]]]; } $F༙[$e뺛[2553]] = array(); if (isset($E[$b͢])) { $F༙[$e뺛[2553]] = $Eއ->getUserJobInfo($E[$b͢]); } } goto e͒; e͒: } public function userSearch($DƉ, $C匂 = "\x2a") { return Model($_SERVER[][477])->where($DƉ)->field($C匂)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\145\x72\137\x6f\x70\x74\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($c䝚Ӧ) { $e =& $_SERVER[]; if (!defined($e[427])) { define($e[427], 0); } return "\125\x73\145\x72\x4f\x70\x74\151\x6f\156\137{$c䝚Ӧ}\x5f" . USER_ID; } protected function filterWhere($f) { $DҾ =& $_SERVER[]; if (!defined($DҾ[427])) { define($DҾ[427], 0); } $f[$DҾ[1451]] = USER_ID; return $f; } public function cacheRemoveUser($a̟, $D䤖) { return Cache::remove("\125\x73\145\162\117\160\164\x69\x6f\156\x5f{$a̟}\137" . $D䤖); } protected function optionDefault($e = '') { $E품 =& $_SERVER[]; if ($e == $E품[33]) { return $GLOBALS[$E품[6]][$E품[2554]]; } if ($e == $E품[2555]) { return $GLOBALS[$E품[6]][$E품[2556]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\162\56\164\x61\147\114\x69\x73\x74"; public $modelType = "\x55\163\x65\162\117\160\x74\151\157\x6e"; public $field = array("\x6e\141\155\145", "\163\164\x79\x6c\x65", "\163\x6f\162\x74"); public function listData($Fܢ = false, $E랉 = "\x73\x6f\x72\x74", $bЏ = false) { return parent::listData($Fܢ, $E랉, $bЏ); } public function remove($făč) { return parent::remove($făč); } public function add($C, $a = "\x6c\141\142\145\x6c\55\147\x72\x65\171\x2d\x6e\x6f\x72\155\x61\x6c") { $dޜ =& $_SERVER[]; if ($this->findByName($C)) { return !1; } $dͨߊ = array($dޜ[386] => $C, $dޜ[437] => $a, $dޜ[2122] => $this->getSort($dޜ[246]) + 1); return parent::insert($dͨߊ); } public function update($bĊަ, $A) { $až؆ =& $_SERVER[]; $d = $this->listData($bĊަ); $Cş = $this->findByName($A[$až؆[28]]); if (!$d || $Cş && $Cş[$až؆[367]] != $d[$až؆[367]]) { return !1; } return parent::update($bĊަ, $A); } public function moveTop($D΄) { $C® =& $_SERVER[]; $fϲ = parent::listData(); $c = $this->getSort($C®[245]); foreach ($fϲ as &$BӨޤ) { if ($BӨޤ[$C®[367]] == $D΄) { $BӨޤ[$C®[2139]] = $c; continue; } $BӨޤ[$C®[2139]] += 1; } return parent::resetData($fϲ); } public function moveBottom($cޔ) { $a =& $_SERVER[]; $D = $this->getSort($a[246]) + 1; return parent::update($cޔ, array($a[2139] => $D)); } public function resetSort($d) { goto bǄ; B؝: return parent::resetData($C); goto f; bǄ: $fή =& $_SERVER[]; $Fㄧ = array(); $d = is_array($d) ? $d : array(); goto F腏; F腏: for ($F = 0; $F < count($d); $F++) { $Fㄧ[$d[$F] . $fή[33]] = $F + 1; } $C = parent::listData(); foreach ($C as &$Aˌ) { $E҂ = $Fㄧ[$Aˌ[$fή[367]]]; $Aˌ[$fή[2139]] = $E҂ ? $E҂ : $Aˌ[$fή[2139]]; } goto B؝; f: } private function getSort($e⤐) { $e =& $_SERVER[]; $A˅ = parent::listData(); $F䠰 = array_to_keyvalue($A˅, $e[33], $e[2139]); if (!$F䠰) { $F䠰 = array(0); } $e򄄅 = $e⤐ == $e[246] ? max($F䠰) : min($F䠰); return intval($e򄄅); } } goto Cȃɦ; eΊ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto Dŉ; Dŉ: $a =& $_SERVER[]; if (self::$handle) { return self::$handle; } $EƂ = $GLOBALS[$a[6]][$a[337]]; goto a矺; E: if ($BÎҌ == $a[17] && $A == $a[9]) { $BÎҌ = $a[167]; } switch ($BÎҌ) { case $a[770]: self::$handle = new CacheLockRedis(); break; case $a[771]: self::$handle = new CacheLockMemcached(); break; case $a[17]: self::$handle = new CacheLockDatabase(); break; case $a[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto Fű; a矺: self::$timeout = $EƂ[$a[780]] ? $EƂ[$a[780]] : 10; $A = _get($GLOBALS[$a[6]], $a[781]); $BÎҌ = $EƂ[$a[767]] ? $EƂ[$a[767]] : $a[167]; goto E; Fű: } private static function key($dڇݯ) { return $_SERVER[][782] . Cache::key($dڇݯ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($Bҭ = '') { self::$errorMsg = $Bҭ; } public static function lockGlobal($bא, $Bы) { return self::lock($bא, $Bы, !0); } public static function lock($Aؑ, $c₝ݮ = false, $eӶو = false) { goto EҮ; a: $c₝ݮ = $c₝ݮ ? $c₝ݮ : self::$timeout; $d׿ŉ = $B췂->lock($f, $c₝ݮ); if (!$d׿ŉ) { $fΤ = $Eͳ[783] . $c₝ݮ . $Eͳ[67] . self::$errorMsg . $Eͳ[67] . get_caller_msg(); $C = "\114\x6f\x63\x6b\40\141\143\x74\151\157\156\x3a\x20{$f}\x20\x74\x69\x6d\x65\x6f\x75\164\54\x6f\166\x65\x72\40{$c₝ݮ}\x20\163"; $C = self::$errorMsg ? self::$errorMsg : $E˹; write_log($fΤ, $Eͳ[784]); show_json($C, !1); } goto eӂ; EҮ: $Eͳ =& $_SERVER[]; $B췂 = self::init(); $f = self::key($Aؑ); goto a; eӂ: if (!$eӶو) { self::$lockItem[$f] = !0; } return $d׿ŉ; goto Eеѓ; Eеѓ: } public static function lockGet($bʕ) { $e = self::key($bʕ); if (self::$lockItem[$e]) { return self::$lockItem[$e]; } return self::init()->lockGet($e); } public static function unlock($eѼˉ) { $bދ = self::key($eѼˉ); self::$lockItem[$bދ] = null; return self::init()->unlock($bދ); } public static function unlockRuntime() { $dᕅ =& $_SERVER[]; $e˪ = self::init(); $a = !1; foreach (self::$lockItem as $D¦ݹ => $cȜ) { if (!$cȜ) { continue; } $e˪->unlock($D¦ݹ); if (!$a) { $a = !0; write_log($dᕅ[785] . $D¦ݹ . $dᕅ[67] . get_caller_msg(), $dᕅ[784]); continue; } write_log($dᕅ[785] . $D¦ݹ, $dᕅ[784]); } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e =& $_SERVER[]; $b瘤 = $GLOBALS[$e[6]][$e[337]]; self::$cachePath = $b瘤[$e[167]][$e[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($eř, $aĝ˧ = 0) { goto F; F: $a =& $_SERVER[]; $d = microtime(!0); $c = $d + $aĝ˧ + 0.0001; goto F; F: $EԈ = rtrim(self::$cachePath, $a[8]) . $a[786] . md5($eř) . $a[787]; if (file_exists($EԈ) && filemtime($EԈ) && filemtime($EԈ) < time() - 10) { @unlink($EԈ); } do { if (file_exists($EԈ)) { cacheLockWait(); continue; } $c֞ = fopen($EԈ, $a[788]); if (!$c֞) { return !1; } $Fݒ = flock($c֞, LOCK_EX | LOCK_NB); self::$caches[$eř] = array($a[789] => $c֞, $a[167] => $EԈ); fwrite($c֞, $c); clearstatcache(); if ($c֞ && $Fݒ) { return !0; } cacheLockWait(); } while (microtime(!0) < $c); goto aý; aý: $this->unlock($eř); return !1; goto E︔; E︔: } public function lockGet($f) { $C =& $_SERVER[]; $a܇؊ = rtrim(self::$cachePath, $C[8]) . $C[786] . md5($f) . $C[787]; return file_exists($a܇؊); } public function unlock($E剾) { goto bӳŸ; bӳŸ: $Dξ =& $_SERVER[]; $e = self::$caches[$E剾]; if (!$e) { return; } goto C; EÄ: unset(self::$caches[$E剾]); goto e𒟩; C: @flock($e[$Dξ[789]], LOCK_UN); @fclose($e[$Dξ[789]]); @unlink($e[$Dξ[167]]); goto EÄ; e𒟩: } } goto D; aД: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Eю׊) { parent::__construct($Eю׊); $this->signatureVersion($_SERVER[][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($D둪) { parent::__construct($D둪); $this->signatureVersion($_SERVER[][200]); } public function fileOutLink($B쭡⵪) { $C =& $_SERVER[]; if (substr($B쭡⵪, 0, 7) == $C[1125]) { $B쭡⵪ = $C[1126] . substr($B쭡⵪, 7); } header($C[156] . $B쭡⵪); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($bǵן) { parent::__construct(); include_once SDK_DIR . $_SERVER[][1182]; $this->_init($bǵן); } public function _init($Fޣ) { foreach ($Fޣ as $Fņ => $bį) { if (isset($this->{$Fņ})) { $this->{$Fņ} = $bį; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[][1183], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto C; Bȋő: $bȎ𡽹->addRule($B͊); try { $this->client->putBucketCors($this->bucket, $bȎ𡽹); } catch (OSS\Core\OssException $cЈϟ) { return !1; } return !0; goto F; Cΐ: $B͊->addAllowedOrigin($b޹[1184]); $B͊->addAllowedMethod($b޹[1185]); $B͊->addAllowedMethod($b޹[1186]); goto e಄; e಄: $B͊->addAllowedMethod($b޹[1187]); $B͊->addAllowedMethod($b޹[1188]); $B͊->addAllowedMethod($b޹[155]); goto eێޘ; eێޘ: $B͊->setMaxAgeSeconds(600); $B͊->addExposeHeader($b޹[1189]); $B͊->addAllowedHeader($b޹[1184]); goto Bȋő; C: $b޹ =& $_SERVER[]; $bȎ𡽹 = new OSS\Model\CorsConfig(); $B͊ = new OSS\Model\CorsRule(); goto Cΐ; F: } public function getBucketCors() { goto Bߩ; c: if (!$Bʥ || !($F֑Ы = $Bʥ->getRules())) { return null; } $A = $F֑Ы[0]->getAllowedOrigins(); $BȚ = $F֑Ы[0]->getAllowedMethods(); goto C݂; F܄: return array($a[175] => isset($A[0]) ? $A[0] : $a[33], $a[179] => $BȚ, $a[1190] => $bﾺƑ, $a[1191] => isset($Cźɡ[0]) ? $Cźɡ[0] : $a[33], $a[177] => isset($eڞ[0]) ? $eڞ[0] : $a[33]); goto E̢; C݂: $bﾺƑ = $F֑Ы[0]->getMaxAgeSeconds(); $Cźɡ = $F֑Ы[0]->getExposeHeaders(); $eڞ = $F֑Ы[0]->getAllowedHeaders(); goto F܄; Bߩ: $a =& $_SERVER[]; $Bʥ = null; try { $Bʥ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $Dʙӈ) { return null; } goto c; E̢: } public function isBucketCors() { goto aش; Cؖ: if ($Cҿ[$aũ[175]] != $aũ[176] || $Cҿ[$aũ[177]] != $aũ[176]) { return !1; } $cь = array_map($aũ[178], $Cҿ[$aũ[179]]); if (!is_array($cь)) { $cь = array(); } goto D锋Ô; aش: $aũ =& $_SERVER[]; $Cҿ = $this->getBucketCors(); if (!$Cҿ || !is_array($Cҿ)) { return !1; } goto Cؖ; D锋Ô: $Eٵ = array($aũ[180], $aũ[181], $aũ[182], $aũ[183], $aũ[184]); $Eڗ = array_diff($Eٵ, $cь); return empty($Eڗ); goto A̼҉ș; A̼҉ș: } public function mkfile($A, $d𳑖 = '', $f = REPEAT_RENAME) { $f܍ʊ = $this->setContent($A, $d𳑖); if ($f܍ʊ !== !1) { return $this->getPathOuter($A); } return !1; } public function mkdir($C빖, $dޣ = REPEAT_SKIP) { if ($this->_isFolder($C빖)) { return $this->getPathOuter($C빖); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($C빖)); } catch (OSS\Core\OssException $dꦓ) { return !1; } return $this->getPathOuter($C빖); } private function fileList($a, $F = '', $fɼ = 0) { goto bԯ; Bϳ: $a딞 = $Bћ[33]; $D̔Ӭ = 1000; $d = $b٢ = array(); goto C; C: while (!0) { $C̄ = array($Bћ[1192] => $F, $Bћ[186] => $e, $Bћ[1193] => $D̔Ӭ, $Bћ[1194] => $a딞); try { $Cꎉ = $this->client->listObjects($this->bucket, $C̄); } catch (OSS\Core\OssException $CΉ܃) { break; } $a딞 = $Cꎉ->getNextMarker(); $Cɟ = $Cꎉ->getObjectList(); $A޹ = $Cꎉ->getPrefixList(); foreach ($Cɟ as $Bꢌ) { if ($Bꢌ->getKey() == $e) { continue; } $f֗³ = $Bꢌ->getKey(); if ($fɼ) { $f֗³ = array($Bћ[28] => $f֗³, $Bћ[77] => $Bꢌ->getSize(), $Bћ[190] => strtotime($Bꢌ->getLastModified())); } $b٢[] = $f֗³; } foreach ($A޹ as $AҒ) { $d[] = $AҒ->getPrefix(); } if ($a딞 === $Bћ[33]) { break; } } return array($Bћ[74] => $d, $Bћ[73] => $b٢); goto C쐫; bԯ: $Bћ =& $_SERVER[]; $a = trim($a, $Bћ[8]); $e = empty($a) ? $Bћ[33] : $a . $Bћ[8]; goto Bϳ; C쐫: } public function copyFile($F潊, $A) { $EƔ = $this->size($F潊); if ($EƔ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $F潊, $this->bucket, $this->pathEncode($A)); } catch (OSS\Core\OssException $A) { return !1; } return !0; } return $this->multiCopyObject($F潊, $A, $EƔ); } private function multiCopyObject($E, $F֍, $b) { $Aヸ =& $_SERVER[]; try { goto D; E: $D㗣 = 1024 * 1024 * 10; $Eԅ = $this->client->generateMultiuploadParts($b, $D㗣); foreach ($Eԅ as $aָ => $EˉǨ) { $aƳ = $D뻿ǃ + (int) $EˉǨ[$Aヸ[1196]]; $CﵻɃ = (int) $EˉǨ[$Aヸ[325]] + $aƳ - 1; $f؊ = array($Aヸ[1197] => $aƳ, $Aヸ[1198] => $CﵻɃ); $B[] = $this->client->uploadPartCopy($this->bucket, $E, $this->bucket, $this->pathEncode($F֍), $AМ, $Dڃ, $f؊); $AМ = $AМ + 1; } goto Aҝ; F: $AМ = 1; $D뻿ǃ = 0; $B = array(); goto E; Aҝ: $bÄф = array(); foreach ($B as $aָ => $F) { $bÄф[] = array($Aヸ[1199] => $aָ + 1, $Aヸ[1200] => $F); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($F֍), $Dڃ, $bÄф); goto dČ; D: $Eτ = array(); if ($b = $this->hashMd5($E)) { $Eτ = array(OSS\OssClient::OSS_HEADERS => array($Aヸ[1195] => $b)); } $Dڃ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F֍), $Eτ); goto F; dČ: } catch (OSS\Core\OssException $a؅) { return !1; } return !0; } public function moveFile($F߂, $a) { if ($this->copyFile($F߂, $a)) { $this->remove($F߂); return !0; } return !1; } public function delFile($bͼ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($bͼ)); } catch (OSS\Core\OssException $Eæ) { return !1; } return !0; } public function delFolder($aՋ) { $eڙ =& $_SERVER[]; $DÞ = $this->fileList($aՋ); if (!empty($aՋ) && !in_array(trim($aՋ, $eڙ[8]) . $eڙ[8], $DÞ[$eڙ[73]])) { $DÞ[$eڙ[73]][] = trim($aՋ, $eڙ[8]) . $eڙ[8]; } foreach (array_chunk($DÞ[$eڙ[73]], 1000) as $dн) { try { $this->client->deleteObjects($this->bucket, $dн); } catch (OSS\Core\OssException $E) { continue; } } return !0; } public function rename($F, $F) { return $this->renameObject($F, $F); } private function fileInfo($f͠, $Aӫ = array()) { goto E; Eċӡ: if (isset($Aӫ[$f[77]])) { $AݐĄ[$f[77]] = $Aӫ[$f[77]]; } if (isset($Aӫ[$f[107]])) { $AݐĄ[$f[107]] = $Aӫ[$f[107]]; } if (isset($Aӫ[$f[190]]) && !trim($AݐĄ[$f[107]])) { $AݐĄ[$f[107]] = $Aӫ[$f[190]]; } goto Bͩ; Bͩ: return $AݐĄ; goto B̚; E: $f =& $_SERVER[]; $AݐĄ = array($f[28] => $this->pathThis($f͠), $f[75] => $this->getPathOuter($f͠), $f[29] => $f[167], $f[187] => 0, $f[107] => 0, $f[77] => 0, $f[160] => $this->ext($f͠), $f[188] => !0, $f[189] => !0); if (empty($Aӫ)) { $aΙ = $this->objectMeta($f͠); if (!$aΙ) { return $AݐĄ; } $Aӫ = array($f[107] => strtotime($aΙ[$f[1201]]), $f[77] => $aΙ[$f[1202]] + 0); } goto Eċӡ; B̚: } private function folderInfo($bۙ暊, $C赙 = array()) { $E򋫐 =& $_SERVER[]; $a۫ = array($E򋫐[28] => $this->pathThis($bۙ暊), $E򋫐[75] => $this->getPathOuter($E򋫐[8] . $bۙ暊), $E򋫐[29] => $E򋫐[76], $E򋫐[187] => 0, $E򋫐[107] => 0, $E򋫐[188] => !0, $E򋫐[189] => !0); if (empty($C赙)) { $bۙ暊 = rtrim($bۙ暊, $E򋫐[8]) . $E򋫐[8]; $E = $this->objectMeta($bۙ暊); if (!$E) { return $a۫; } $C赙 = array($E򋫐[187] => $E[$E򋫐[1203]][$E򋫐[1204]], $E򋫐[107] => strtotime($E[$E򋫐[1201]])); } if (isset($C赙[$E򋫐[107]])) { $a۫[$E򋫐[107]] = $C赙[$E򋫐[107]]; } if (isset($C赙[$E򋫐[187]])) { $a۫[$E򋫐[187]] = $C赙[$E򋫐[187]]; } return $a۫; } public function listPath($Bڳ℈, $eߌ = false) { $Eᐰ =& $_SERVER[]; $d = $this->fileList($Bڳ℈, $Eᐰ[8], !0); foreach ($d[$Eᐰ[74]] as $a => $cס) { $d[$Eᐰ[74]][$a] = $this->folderInfo($cס, $cס); } foreach ($d[$Eᐰ[73]] as $a => $cס) { $d[$Eᐰ[73]][$a] = $this->fileInfo($cס[$Eᐰ[28]], $cס); } return $d; } public function has($c󰄈Ť, $fѣњչ = false, $b˔ = true) { goto aψϋ; e: $e߉ = $Bΰ[33]; $eŢ = 500; $AՈ = 0; goto fۻ; dɜ: return !1; goto eЏ̼; aψϋ: $Bΰ =& $_SERVER[]; $c󰄈Ť = trim($c󰄈Ť, $Bΰ[8]); $Fʂ = empty($c󰄈Ť) ? $Bΰ[33] : $c󰄈Ť . $Bΰ[8]; goto e; fۻ: $e = 0; while (!0) { $c = array($Bΰ[1192] => $Bΰ[8], $Bΰ[186] => $Fʂ, $Bΰ[1193] => $eŢ, $Bΰ[1194] => $e߉); try { $E = $this->client->listObjects($this->bucket, $c); } catch (OSS\Core\OssException $bϖ) { break; } $e߉ = $E->getNextMarker(); $EՐ = $E->getObjectList(); $bʂ = $E->getPrefixList(); if ($fѣњչ) { if (count($EՐ) > 1 || count($EՐ) == 1 && $EՐ[0]->getKey() != $Fʂ) { $AՈ += count($EՐ) - 1; } if (!empty($bʂ)) { $e += count($bʂ); } if ($e߉ === $Bΰ[33]) { break; } continue; } if ($b˔) { if (!empty($EՐ)) { if (count($EՐ) > 1 || $EՐ[0]->getKey() != $Fʂ) { return !0; } } } else { if (!empty($bʂ)) { return !0; } } if ($e߉ === $Bΰ[33]) { break; } } if ($fѣњչ) { return array($Bΰ[191] => $AՈ, $Bΰ[192] => $e); } goto dɜ; eЏ̼: } public function listAll($dǐ) { $Bʦͤ =& $_SERVER[]; $f򡏟 = $this->fileList($dǐ, $Bʦͤ[33], !0); $Fإ = array(); foreach ($f򡏟[$Bʦͤ[73]] as $Eѕ) { $Fإ[$Eѕ[$Bʦͤ[28]]] = $Eѕ[$Bʦͤ[77]]; } return $this->listAllFiles($dǐ, array_keys($Fإ), $Fإ); } public function canRead($B) { $bʇ =& $_SERVER[]; $a鍚䫼 = $this->pathAcl($B); return $a鍚䫼 == $bʇ[1205] || $a鍚䫼 == $bʇ[491] ? !0 : !1; } public function canWrite($c) { $b̻ = $this->pathAcl($c); return $b̻ == $_SERVER[][491] ? !0 : !1; } public function pathAcl($e) { goto E₇; Cٻ˅: return $A릓; goto A; A: $A릓 = $b؉ == $F̐[34] ? $this->bucketAcl : $b؉; if ($A릓 == $F̐[1206]) { return $F̐[1205]; } if ($A릓 == $F̐[1207]) { return $F̐[491]; } goto Cٻ˅; E₇: $F̐ =& $_SERVER[]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $b؉ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($e)); } catch (OSS\Core\OssException $D갚) { return !1; } goto A; A: } private function chmodPath($Eۥ, $b = '') { $D񏌧 =& $_SERVER[]; $B쐑 = empty($b) ? $D񏌧[1207] : $b; $dǹ = array($D񏌧[34], $D񏌧[185], $D񏌧[1206], $D񏌧[1207]); if (!in_array($B쐑, $dǹ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Eۥ), $B쐑); } catch (OSS\Core\OssException $bф) { return !1; } return !0; } public function getContent($E) { return $this->fileSubstr($E, -1); } public function setContent($DȾЇ, $Aұ = '') { $eˍ =& $_SERVER[]; try { $Eǥۄ = $this->trafficLimit($eˍ[1208]); $Eߥ = $this->client->putObject($this->bucket, $this->pathEncode($DȾЇ), $Aұ, $Eǥۄ); } catch (OSS\Core\OssException $cƊ) { return !1; } $Aŝ = array($eˍ[1195] => trim($Eߥ[$eˍ[1209]], $eˍ[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($DȾЇ))); $this->updateObjMeta($DȾЇ, $Aŝ); return isset($Eߥ[$eˍ[1210]][$eˍ[1155]]) ? (int) $Eߥ[$eˍ[1210]][$eˍ[1155]] : strlen($Eߥ); } private function updateObjMeta($C׬ДԎ, $B˸) { $C׬ДԎ = $this->pathEncode($C׬ДԎ); try { $A஖ = array(OSS\OssClient::OSS_HEADERS => $B˸); $this->client->copyObject($this->bucket, $C׬ДԎ, $this->bucket, $C׬ДԎ, $A஖); } catch (OSS\Core\OssException $dП) { return !1; } return !0; } public function upload($cߩɲ, $a㴓䙢, $a = false, $D = REPEAT_REPLACE) { $e̦ߎ =& $_SERVER[]; $C = trim($cߩɲ, $e̦ߎ[8]); $E = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($e̦ߎ[1195] => @md5_file($a㴓䙢)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cߩɲ))); $E = $this->trafficLimit($e̦ߎ[1208], $E); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($C), $a㴓䙢, $E); } catch (OSS\Core\OssException $f) { return !1; } return $this->getPathOuter($cߩɲ); } public function getHost() { $a׼ =& $_SERVER[]; $b = explode($a׼[171], parent::getHost()); return $b[0] . $a׼[171] . $this->bucket . $a׼[91] . $b[1]; } public function uploadFormData($b, $Aϱ = 3600) { goto dی; dی: $Dʞ =& $_SERVER[]; if (!($B = $this->getHost())) { return !1; } $Aа = $Aϱ; goto cǻ; f׾: $EԳ = strpos($cߦ, $Dʞ[284]); $cߦ = substr($cߦ, 0, $EԳ) . $Dʞ[1212]; $e𬍎 = 1048576000 * 5; goto cǍ؂; a: return $EȺ; goto D; cǻ: $fӔϋ = date($Dʞ[1211], time() + $Aа); $Dا = new DateTime($fӔϋ); $cߦ = $Dا->format(DateTime::ISO8601); goto f׾; cǍ؂: $C = $this->pathFather($b); $dѺ = array($Dʞ[1112] => $cߦ, $Dʞ[1113] => array(array($Dʞ[1213], 0, $e𬍎), array($Dʞ[1116], $Dʞ[1117], $C))); $eԆҬ = base64_encode(json_encode($dѺ)); goto B; B: $e = base64_encode(hash_hmac($Dʞ[218], $eԆҬ, $this->secret, !0)); $EȺ = array($Dʞ[1122] => $eԆҬ, $Dʞ[1214] => $this->accessKey, $Dʞ[1118] => $Dʞ[1110], $Dʞ[1215] => $e, $Dʞ[169] => $B); $EȺ = $this->trafficLimit($Dʞ[1208], $EȺ); goto a; D: } public function multiUploadFormData($a͆, $d說 = 3600) { $cَ =& $_SERVER[]; if (!($c = $this->getHost())) { return !1; } $Bº = $this->trafficLimit($cَ[1208]); $Aǲ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($a͆), $Bº); return array($cَ[209] => $Aǲ, $cَ[169] => $c . $cَ[8] . $this->pathEncode($a͆), $cَ[210] => gmdate($cَ[1216]), $cَ[89] => $a͆); } public function multiUploadAuthData($aﶘ, $Cĭ = array()) { goto c˒; c˒: $Aܶ =& $_SERVER[]; $dݙ = isset($Cĭ[$Aܶ[210]]) ? $Cĭ[$Aܶ[210]] : gmdate($Aܶ[1216]); $dĻŋ = isset($Cĭ[$Aܶ[160]]) ? $Cĭ[$Aܶ[160]] : $Aܶ[33]; goto Fá֎; Fá֎: $c⤎ = $aﶘ; if (isset($Cĭ[$Aܶ[89]])) { $c⤎ = $Cĭ[$Aܶ[89]]; unset($Cĭ[$Aܶ[89]]); } if (isset($Cĭ[$Aܶ[211]])) { $Cĭ[$Aܶ[210]] = $dݙ; return $this->listUploadParts($c⤎, $Cĭ); } goto Dۻ; cӻ: if (!empty($Cĭ[$Aܶ[1218]])) { $d򷣣 = array_merge(array($EϏ[4]), $Cĭ[$Aܶ[1218]]); sort($d򷣣); $EϏ[4] = implode($Aܶ[217], $d򷣣); } $cފ = implode($Aܶ[217], $EϏ); $DҒ誓 = base64_encode(hash_hmac($Aܶ[218], $cފ, $this->secret, !0)); goto eڕĲޝ; Dۻ: $EϏ = array($Aܶ[212], $Aܶ[33], $Aܶ[116], $dݙ, "\x78\x2d\157\x73\163\55\144\x61\164\x65\72{$dݙ}", $Aܶ[8] . $this->bucket . $Aܶ[8] . $c⤎ . $dĻŋ); if (strpos($dĻŋ, $Aܶ[213]) === 0) { $EϏ[0] = $Aܶ[214]; if ($cȋ = $this->trafficLimit($Aܶ[1208])) { $c⤎ = $Aܶ[1217]; array_splice($EϏ, 5, 0, $c⤎ . $Aܶ[4] . $cȋ[$c⤎]); } } if (isset($Cĭ[$Aܶ[215]]) && $Cĭ[$Aܶ[215]] == $Aܶ[216]) { $EϏ[0] = $Aܶ[216]; } goto cӻ; eڕĲޝ: $b = $Aܶ[1219] . $this->accessKey . $Aܶ[4] . $DҒ誓; if (strpos($dĻŋ, $Aܶ[213]) === 0) { $b = array($Aܶ[220] => $b, $Aܶ[210] => $dݙ); if ($cȋ) { $b = array_merge($b, $cȋ); } } return $b; goto E; E: } public function listUploadParts($C؆, $dѺ) { goto Bʯ; Bʯ: $E =& $_SERVER[]; $D݊ = parse_url_query($dѺ[$E[160]]); $C = $this->client->listParts($this->bucket, $this->pathEncode($C؆), $D݊[$E[209]]); goto BƖ; BƖ: $DЃ = $C->getListPart(); $Fǹ᩹ = array(); foreach ($DЃ as $fǴ܎) { $Fǹ᩹[] = array($E[1199] => $fǴ܎->getPartNumber(), $E[1200] => trim($fǴ܎->getETag(), $E[113])); } goto A; A: unset($dѺ[$E[211]], $dѺ[$E[215]]); $A୏Ȟ = $this->multiUploadAuthData($C؆, $dѺ); if (empty($A୏Ȟ)) { return !1; } goto aņ; aņ: return array($E[220] => $A୏Ȟ, $E[210] => $dѺ[$E[210]], $E[222] => $Fǹ᩹); goto Bď; Bď: } public function download($f口ԡ, $D֘ҹ) { if ($this->isFolder($f口ԡ)) { return !1; } try { $A = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $D֘ҹ); $A = $this->trafficLimit($_SERVER[][105], $A); $this->client->getObject($this->bucket, $this->pathEncode($f口ԡ), $A); } catch (OSS\Core\OssException $dΤً) { return !1; } return $D֘ҹ; } public function fileSubstr($dۉ, $E󬲉 = 0, $Dڹ = false) { if ($E󬲉 === -1) { $C = array(); } else { if ($Dڹ === !1) { $d = $this->size($dۉ); } else { $d = $E󬲉 + $Dڹ - 1; } $C = array(OSS\OssClient::OSS_RANGE => "{$E󬲉}\55{$d}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($dۉ), $C); } catch (OSS\Core\OssException $Bɋ) { think_exception($Bɋ->getMessage()); return !1; } } private function trafficLimit($eƠ, $a = array()) { goto Bʬ; Dǭ: return $a; goto Fأܙ; Aܞ: if (!$C抉) { return $a; } $C抉 = $C抉 < 819200 ? 819200 : ($C抉 > 838860800 ? 838860800 : $C抉); $a[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($C抉); goto Dǭ; Bʬ: $cޙ =& $_SERVER[]; if ($eƠ == $cޙ[1208] && $this->isUploadServer() || $eƠ == $cޙ[105] && $this->isFileOutServer()) { return $a; } $C抉 = floatval($GLOBALS[$cޙ[6]][$cޙ[84]][$cޙ[103]][$eƠ]) * 1024 * 1024 * 8; goto Aܞ; Fأܙ: } public function link($dˆ, $e׸ = array()) { $F =& $_SERVER[]; if (!$this->exist($dˆ) || $this->isFolder($dˆ)) { return !1; } try { $e׸ = $this->trafficLimit($F[105], $e׸); $B = $this->client->signUrl($this->bucket, $this->pathEncode($dˆ), 3600 * 12, $F[216], $e׸); return $this->getCdnLink($B); } catch (OSS\Core\OssException $d) { return !1; } } public function fileOut($cк, $Cݥġܮ = false, $Cϓ = false, $FɌ = '') { goto FĿ; a׌: $cơɇ = get_file_mime(get_path_ext($Cϓ)); if ($cơɇ == $a鋵[201]) { return parent::fileOut($cк, $Cݥġܮ, $Cϓ, $FɌ); } $Cݥġܮ = $Cݥġܮ ? $a鋵[202] : $a鋵[203]; goto b漩; b漩: $c҉ = array(OSS\OssClient::OSS_SUB_RESOURCE => $a鋵[1220] . rawurlencode("{$Cݥġܮ}\73\x66\151\x6c\145\156\141\x6d\145\75{$Cϓ}")); $c҉[OSS\OssClient::OSS_SUB_RESOURCE] .= $a鋵[1221] . rawurlencode($cơɇ); $a = $this->link($cк, $c҉); goto a݇; a݇: $this->fileOutLink($a); goto bƒ; FĿ: $a鋵 =& $_SERVER[]; if (!$Cϓ) { $Cϓ = $this->pathThis($cк); } $Cϓ = rawurlencode($Cϓ); goto a׌; bƒ: } public function fileOutServer($d̽Ɔ, $Dֲʆ = false, $Eǥ = false, $cݴƂ = '') { parent::fileOut($d̽Ɔ, $Dֲʆ, $Eǥ, $cݴƂ); } public function fileOutImage($d, $D = 250) { $F䡟 = array(OSS\OssClient::OSS_PROCESS => $_SERVER[][1222] . $D); $B = $this->link($d, $F䡟); $this->fileOutLink($B); } public function fileOutImageServer($D, $eĈ = 250) { parent::fileOutImage($D, $eĈ); } public function fileOutLink($aƓ޴) { $Cݼ䝵 =& $_SERVER[]; if (!$this->isCdnHost() && substr($aƓ޴, 0, 7) == $Cݼ䝵[1125]) { $aƓ޴ = $Cݼ䝵[1126] . substr($aƓ޴, 7); } header($Cݼ䝵[156] . $aƓ޴); die; } public function hashMd5($bҲ֠, $CƒР = '') { $Eݐ =& $_SERVER[]; $Fԟ = $this->objectMeta($bҲ֠); if (!$Fԟ) { return $Eݐ[33]; } if (!isset($Fԟ[$Eݐ[1195]]) && !empty($CƒР)) { $E׈ = $this->updateObjMeta($bҲ֠, array($Eݐ[1195] => $CƒР)); $Fԟ[$Eݐ[1195]] = $E׈ ? $CƒР : $Eݐ[33]; } return isset($Fԟ[$Eݐ[1195]]) ? strtolower($Fԟ[$Eݐ[1195]]) : $Eݐ[33]; } public function size($e) { $f = $this->objectMeta($e); return $f ? $f[$_SERVER[][77]] : 0; } public function info($Fό) { if ($this->isFolder($Fό)) { return $this->folderInfo($Fό); } else { if ($this->isFile($Fό)) { return $this->fileInfo($Fό); } } return !1; } public function exist($fʂ) { return $this->isFile($fʂ) || $this->isFolder($fʂ); } public function isFile($b՞Т) { return !$this->isFolder($b՞Т) && $this->objectMeta($b՞Т); } public function isFolder($C) { return $this->cacheMethod($_SERVER[][223], $C); } protected function objectMeta($C߃) { return $this->cacheMethod($_SERVER[][224], $C߃); } protected function _objectMeta($C) { $C =& $_SERVER[]; try { $aܒ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($C)); } catch (OSS\Core\OssException $aʐ) { $aܒ = !1; } if ($aܒ) { $aܒ[$C[77]] = intval($aܒ[$C[1202]]); } return $aܒ; } protected function _isFolder($EɄ) { $F =& $_SERVER[]; if ($EɄ == $F[33] || $EɄ == $F[8]) { return !0; } $Fܺ = array($F[1192] => $F[8], $F[186] => rtrim($EɄ, $F[8]) . $F[8], $F[1193] => 1, $F[1194] => $F[33]); $b؄ = $this->client->listObjects($this->bucket, $Fܺ); if ($b؄->getObjectList() || $b؄->getPrefixList()) { return !0; } return !1; } } goto E; c: class HttpHeader { public static $_headers = array("\x48\x6f\x73\x74" => "\110\124\124\x50\x5f\x48\117\123\x54", "\125\163\x65\x72\x2d\101\147\145\156\x74" => "\110\x54\124\x50\137\125\x53\105\x52\137\x41\107\105\x4e\124", "\103\x6f\156\164\145\156\x74\x2d\x54\x79\160\x65" => "\x48\x54\x54\x50\137\x43\117\x4e\124\105\116\x54\137\x54\131\120\x45", "\103\157\x6e\164\x65\x6e\164\x2d\x4c\145\x6e\147\164\150" => "\110\x54\124\x50\x5f\103\x4f\116\124\105\x4e\x54\137\x4c\105\x4e\107\124\110", "\x44\145\160\x74\150" => "\x48\x54\x54\x50\x5f\x44\105\120\x54\x48", "\105\x78\x70\x65\143\164" => "\110\x54\124\120\137\x45\x58\120\x45\103\124", "\x49\x66\x2d\x4e\157\156\x65\x2d\x4d\141\x74\143\150" => "\110\x54\124\120\x5f\x49\106\137\x4e\117\x4e\x45\x5f\x4d\101\124\x43\x48", "\x49\146\55\x4d\141\x74\x63\150" => "\110\x54\x54\x50\137\111\106\x5f\115\101\x54\103\110", "\111\146\x2d\122\141\x6e\147\x65" => "\110\124\124\120\137\x49\x46\x5f\x52\101\x4e\107\105", "\x4c\141\x73\164\x2d\x4d\157\144\151\146\151\145\x64" => "\110\x54\x54\x50\137\114\101\123\124\x5f\x4d\x4f\x44\111\x46\111\x45\104", "\x49\x66\x2d\115\157\x64\x69\x66\151\x65\144\x2d\123\x69\156\x63\x65" => "\x48\124\124\120\137\x49\106\137\115\117\104\111\x46\111\x45\104\137\123\111\116\x43\x45", "\x49\146\x2d\x55\x6e\155\157\x64\x69\x66\151\145\144\55\x53\151\x6e\143\x65" => "\x48\124\124\x50\x5f\x49\106\x5f\x55\116\x4d\x4f\104\111\106\x49\x45\104\x5f\123\111\x4e\103\105", "\x52\141\x6e\147\145" => "\110\124\124\x50\137\x52\101\x4e\x47\x45", "\124\x69\155\145\157\165\164" => "\110\124\124\x50\x5f\x54\x49\x4d\x45\x4f\x55\124", "\x49\x66" => "\110\124\124\x50\137\x49\x46", "\114\x6f\x63\x6b\x2d\x54\x6f\153\145\x6e" => "\110\124\x54\120\137\x4c\117\x43\x4b\137\x54\117\113\105\116", "\x4f\166\x65\162\x77\162\151\164\x65" => "\x48\x54\124\x50\137\x4f\126\105\122\x57\122\x49\124\x45", "\x44\x65\163\164\151\x6e\141\x74\151\157\156" => "\x48\124\124\x50\137\x44\x45\123\124\111\116\101\x54\111\117\116", "\x52\x65\x71\165\145\163\164\55\111\144" => "\122\105\121\125\x45\123\x54\x5f\111\x44", "\122\x65\161\165\145\163\x74\55\102\x6f\x64\171\x2d\x46\x69\154\x65" => "\122\105\121\125\x45\x53\x54\x5f\x42\x4f\x44\x59\137\x46\111\114\x45", "\122\145\x64\x69\162\x65\x63\x74\55\x53\x74\141\164\165\x73" => "\122\x45\x44\x49\x52\x45\103\124\x5f\123\124\x41\124\125\x53"); public static function init() { static $C鳸 = false; if ($C鳸) { return; } foreach ($_SERVER as $C蝊ԉ => $c) { $C蝊ԉ = strtoupper($C蝊ԉ); if (!array_key_exists($C蝊ԉ, $_SERVER)) { continue; } $_SERVER[$C蝊ԉ] = $c; } foreach (self::$_headers as $C蝊ԉ => $A) { if (!array_key_exists($C蝊ԉ, $_SERVER)) { continue; } $_SERVER[$C蝊ԉ] = $_SERVER[$A]; $_SERVER[strtoupper($C蝊ԉ)] = $_SERVER[$A]; } } public static function get($B) { self::init(); return $_SERVER[$B] ? $_SERVER[$B] : $_SERVER[$_SERVER[][1843] . strtoupper($B)]; } public static function method() { return strtoupper(self::get($_SERVER[][154])); } public static function length() { $d׊ =& $_SERVER[]; $E㌩ = self::get($d׊[1844]); if (!$E㌩) { $E㌩ = self::get($d׊[1155]); } return $E㌩; } public static function range() { $Aۥ =& $_SERVER[]; $Cʖꠢ = self::get($Aۥ[198]); if (!$Cʖꠢ) { return !1; } if (!preg_match($Aۥ[1845], $Cʖꠢ, $f񲫶)) { return !1; } if ($f񲫶[1] === $Aۥ[33] && $f񲫶[2] === $Aۥ[33]) { return !1; } return array($f񲫶[1] !== $Aۥ[33] ? $f񲫶[1] : null, $f񲫶[2] !== $Aۥ[33] ? $f񲫶[2] : null); } public static $statusCode = array("\61\60\60" => "\x43\157\156\x74\x69\x6e\165\x65", "\x31\x30\61" => "\x53\167\151\164\143\x68\x69\x6e\147\x20\x50\162\x6f\164\x6f\x63\x6f\154", "\61\60\62" => "\x50\162\x6f\x63\145\163\163\151\156\x67", "\x31\60\x33" => "\105\x61\162\x6c\x79\40\110\x69\156\x74\163", "\x32\60\x30" => "\x4f\x4b", "\62\x30\61" => "\x43\x72\x65\x61\164\145\x64", "\x32\60\62" => "\x41\x63\x63\x65\x70\164\x65\144", "\62\60\x33" => "\116\x6f\156\55\101\165\x74\150\x6f\x72\151\x74\141\164\x69\x76\145\x20\x49\x6e\146\x6f\x72\155\x61\164\151\157\x6e", "\x32\60\x34" => "\x4e\x6f\x20\x43\157\x6e\x74\x65\x6e\x74", "\x32\x30\65" => "\122\145\x73\x65\x74\x20\103\x6f\156\164\145\x6e\x74", "\62\60\66" => "\120\141\162\164\x69\x61\x6c\40\x43\157\x6e\164\145\156\164", "\62\x30\x37" => "\115\x75\154\164\x69\x2d\x53\x74\141\164\165\163", "\x33\60\60" => "\x4d\165\x6c\164\151\x70\x6c\145\x20\x43\150\157\x69\143\145\163", "\x33\60\61" => "\x4d\157\166\145\x64\40\x50\145\x72\x6d\x61\156\x65\x6e\164\154\171", "\x33\x30\x32" => "\x46\x6f\x75\x6e\144", "\63\60\x33" => "\x53\x65\145\x20\117\164\150\145\162", "\x33\x30\64" => "\x4e\157\164\40\115\x6f\x64\x69\146\151\145\x64", "\x33\60\x35" => "\125\x73\x65\x20\120\162\157\x78\x79", "\x33\60\67" => "\x54\x65\x6d\x70\x6f\162\141\162\171\40\122\x65\144\151\162\x65\143\164", "\63\60\70" => "\x50\145\x72\155\x61\156\145\x6e\x74\x20\122\x65\144\151\x72\x65\143\164", "\x34\x30\x30" => "\x42\141\144\40\122\145\x71\165\x65\x73\164", "\64\x30\61" => "\125\x6e\141\x75\x74\150\157\162\x69\172\145\x64", "\64\60\62" => "\x50\141\171\155\145\156\x74\40\x52\145\161\x75\151\x72\145\x64", "\x34\x30\x33" => "\x46\x6f\x72\x62\151\144\144\x65\x6e", "\64\x30\x34" => "\116\x6f\164\40\x46\x6f\x75\x6e\144", "\64\x30\65" => "\x4d\x65\x74\150\157\x64\40\x4e\x6f\164\x20\101\154\154\157\x77\x65\144", "\x34\x30\66" => "\116\x6f\x74\x20\x41\143\143\145\160\164\x61\x62\154\x65", "\64\x30\x37" => "\120\x72\157\170\x79\x20\x41\x75\x74\x68\145\x6e\x74\151\143\x61\164\x69\x6f\156\x20\122\x65\161\x75\x69\162\145\x64", "\x34\60\x38" => "\x52\145\x71\165\145\163\x74\40\x54\151\155\x65\x6f\x75\164", "\x34\60\71" => "\x43\157\x6e\146\x6c\151\143\x74", "\64\61\60" => "\107\157\x6e\x65", "\x34\61\x31" => "\114\145\156\x67\x74\x68\40\x52\x65\161\x75\x69\x72\x65\144", "\64\x31\62" => "\120\x72\145\x63\x6f\x6e\144\x69\x74\x69\x6f\x6e\40\x46\141\151\x6c\145\x64", "\64\x31\x33" => "\x52\x65\161\165\145\163\x74\x20\105\156\x74\x69\164\171\x20\x54\x6f\x6f\x20\114\141\x72\147\x65", "\x34\61\x34" => "\122\145\x71\x75\145\163\164\40\x55\x52\x49\40\x54\157\157\x20\114\141\x72\147\145", "\64\x31\65" => "\x55\156\163\165\x70\x70\x6f\162\x74\x65\x64\40\115\x65\144\x69\x61\40\124\171\x70\145", "\x34\x31\66" => "\122\145\161\x75\145\163\x74\x65\x64\x20\122\x61\x6e\147\145\x20\116\157\164\40\x53\141\x74\x69\x73\x66\151\x61\x62\154\x65", "\x34\61\67" => "\x45\170\x70\x65\143\164\141\x74\x69\157\x6e\40\106\141\x69\154\145\144", "\x34\x32\x32" => "\125\156\160\x72\157\143\145\x73\x73\141\x62\x6c\145\40\x45\x6e\164\x69\x74\171", "\x34\62\63" => "\x4c\157\x63\153\x65\x64", "\x34\62\x34" => "\106\x61\151\x6c\145\144\x20\104\145\x70\x65\156\144\x65\x6e\x63\171", "\64\x32\65" => "\125\x6e\x6f\x72\x64\145\x72\x65\x64\x20\x43\x6f\154\154\145\143\164\151\x6f\156", "\64\62\x36" => "\125\160\147\x72\x61\144\145\x20\122\145\161\165\151\162\145\x64", "\64\62\x38" => "\120\x72\x65\x63\157\x6e\144\151\164\151\x6f\156\40\122\145\161\165\x69\x72\145\144", "\64\62\x39" => "\x54\157\157\x20\115\x61\x6e\171\x20\122\x65\x71\165\145\x73\x74\163", "\x34\63\x31" => "\122\x65\x71\165\x65\x73\x74\40\x48\145\x61\144\145\162\x20\106\x69\145\x6c\144\163\40\124\x6f\157\x20\x4c\x61\162\x67\145", "\x34\64\x34" => "\116\x6f\x20\x52\145\x73\x70\157\156\163\x65", "\x34\65\60" => "\x42\154\x6f\143\153\x65\144\40\x62\171\40\x57\x69\156\144\x6f\x77\x73\x20\120\x61\162\x65\156\164\x61\x6c\40\x43\x6f\x6e\164\162\157\x6c\163", "\64\65\x31" => "\125\x6e\141\166\x61\151\154\x61\x62\x6c\145\x20\x46\157\x72\x20\114\x65\x67\141\154\40\122\145\141\163\x6f\156\163", "\x34\x39\x34" => "\122\145\161\x75\145\163\164\40\x48\145\141\x64\145\x72\x20\x54\157\157\x20\x4c\x61\162\147\x65", "\65\60\x30" => "\x49\156\x74\x65\x72\x6e\141\x6c\x20\123\x65\x72\166\x65\x72\40\105\162\x72\x6f\162", "\65\60\x31" => "\116\157\x74\x20\111\155\160\154\145\155\x65\156\164\x65\144", "\65\60\x32" => "\102\x61\x64\40\107\141\164\x65\x77\141\171", "\x35\60\x33" => "\x53\145\162\166\151\143\145\40\x55\156\141\166\x61\x69\x6c\x61\142\154\145", "\65\x30\64" => "\x47\141\164\145\167\x61\171\40\x54\x69\155\145\157\x75\164", "\x35\60\x35" => "\x48\x54\124\x50\x20\x56\145\x72\x73\151\157\x6e\40\156\157\x74\x20\163\x75\160\x70\157\162\164\x65\x64", "\x35\x30\x37" => "\x49\156\163\x75\x66\x66\x69\143\x69\x65\156\164\40\x53\164\x6f\x72\x61\x67\145"); public static function code($b̒) { $dʿ =& $_SERVER[]; $b̒ = $b̒ . $dʿ[33]; $eǿ͚ = self::$statusCode[$b̒]; $eǿ͚ = $eǿ͚ ? "\x48\x54\x54\x50\57\61\56\61\40{$b̒}\40" . $eǿ͚ : $dʿ[33]; return $eǿ͚; } } class ImageGdBMP { public static function load($D) { $eʃ = fopen($D, $_SERVER[][1535]); if ($eʃ === !1) { return !1; } $C׶ӆ = self::loadFromStream($eʃ); fclose($eʃ); return $C׶ӆ; } public static function loadFromStream($bߊ) { $EȈ =& $_SERVER[]; $B = fread($bߊ, 14); if ($B === !1) { return !1; } if ($B[0] != $EȈ[1846] || $B[1] != $EȈ[1847]) { return !1; } $Dۑ = unpack($EȈ[1848] . $EȈ[1849] . $EȈ[1850] . $EȈ[1851] . $EȈ[1852], $B); return self::loadFromStreamAndFileHeader($bߊ, $Dۑ); } public static function loadFromStreamAndFileHeader($Dϋ, array $aŚ) { goto Bܪ; a߷赟: if ($Fͺ === !1) { return !1; } list(, $eğΘ) = unpack($e[1853], $Fͺ); if ($eğΘ == 12) { goto e; e: $Fͺ = fread($Dϋ, $eğΘ - 4); if ($Fͺ === !1) { return !1; } extract(unpack($e[1854] . $e[1855] . $e[1856] . $e[1857], $Fͺ)); goto d̘; d̘: $f = $E姜 = $D̒ = $D = 0; $Eև = 16711680; $B׍ = 65280; goto f; f: $F = 255; goto cƋ; cƋ: } else { if (124 < $eğΘ || $eğΘ < 40) { return !1; } else { goto B묒ҫ; c١: if ($A & 2147483648) { $A = -(~$A & 4294967295) - 1; } if ($Bѻ & 2147483648) { $Bѻ = -(~$Bѻ & 4294967295) - 1; } if ($b & 2147483648) { $b = -(~$b & 4294967295) - 1; } goto C; B묒ҫ: $Fͺ = fread($Dϋ, 36); if ($Fͺ === !1) { return !1; } extract(unpack($e[1858] . $e[1859] . $e[1856] . $e[1860] . $e[1861] . $e[1862] . $e[1863] . $e[1864] . $e[1865] . $e[1866], $Fͺ)); goto c١; C: if ($dڱ & 2147483648) { $dڱ = -(~$dڱ & 4294967295) - 1; } if ($aŚ[$e[520]] != 0) { $e = $E᛹ == 1 || $E᛹ == 4 || $E᛹ == 8 ? ($f ? $f : pow(2, $E᛹)) << 2 : 0; $f¨ = $d ? $d : ($A * $E᛹ + 31 >> 3 & ~3) * abs($Bѻ); $d = $aŚ[$e[520]] - $f¨ - $e - 14; if ($eğΘ < $d && 40 <= $eğΘ && $eğΘ <= 124) { $eğΘ = $d; } } if ($eğΘ - 40 > 0) { $Fͺ = fread($Dϋ, $eğΘ - 40); if ($Fͺ === !1) { return !1; } extract(unpack($e[1867] . $e[1868] . $e[1869] . $e[1870], $Fͺ . str_repeat($e[1871], 120))); } else { $D̒ = $Eև = $B׍ = $F = 0; } goto c; c: if (($E᛹ == 16 || $E᛹ == 24 || $E᛹ == 32) && $D == 0 && $Eև == 0 && $B׍ == 0 && $F == 0) { switch ($E᛹) { case 16: $Eև = 31744; $B׍ = 992; $F = 31; break; case 24: case 32: $Eև = 16711680; $B׍ = 65280; $F = 255; break; } } goto e; e: } } goto cǐ; cǐ: if ($A == 0 || $Bѻ == 0 || $c楩ܐ != 1 || ($D̒ & $Eև) != 0 || ($D̒ & $B׍) != 0 || ($D̒ & $F) != 0 || ($Eև & $B׍) != 0 || ($Eև & $F) != 0 || ($B׍ & $F) != 0) { return !1; } if ($D == 4 || $D == 5) { $Fͺ = stream_get_contents($Dϋ, $d); if ($Fͺ === !1) { return !1; } return imagecreatefromstring($Fͺ); } $Aى̬ = $A * $E᛹ + 31 >> 3 & ~3; goto Eٌ; Eٌ: $AɄ = abs($Bѻ); $bˬ = $Bѻ > 0 ? $AɄ - 1 : 0; $b = $Bѻ > 0 ? -1 : 1; goto Eϳ; Bܪ: $e =& $_SERVER[]; if ($aŚ[$e[388]] != 19778) { return !1; } $Fͺ = fread($Dϋ, 4); goto a߷赟; Eϳ: if ($E᛹ == 1 || $E᛹ == 4 || $E᛹ == 8) { goto DޛɌ; D塌Ծ: $E = array(); for ($fϚۛ = 0; $fϚۛ < $D; ++$fϚۛ) { $Fͺ = fread($Dϋ, $eъا); if ($Fͺ === !1) { imagedestroy($Dɘ); return !1; } extract(unpack($e[1872], $Fͺ . $e[1871])); $E[] = imagecolorallocate($Dɘ, $f, $dޒ, $a); } $bօ԰ = 8 - $E᛹; goto bɹ; DޛɌ: $Dɘ = imagecreate($A, $AɄ); $eъا = $eğΘ == 12 ? 3 : 4; $D = $f ? $f : pow(2, $E᛹); goto D塌Ծ; bɹ: $A = (1 << $E᛹) - 1 << $bօ԰; if ($D == 1 || $D == 2) { $b = 0; $E = $E᛹ >> 2 & 1; for (;;) { if ($b < -1 || $b > $A || $bˬ < -1 || $bˬ > $Bѻ) { imagedestroy($Dɘ); return !1; } $Fͺ = fread($Dϋ, 1); if ($Fͺ === !1) { imagedestroy($Dɘ); return !1; } switch ($Fͺ) { case $e[1871]: $Fͺ = fread($Dϋ, 1); if ($Fͺ === !1) { imagedestroy($Dɘ); return !1; } switch ($Fͺ) { case $e[1871]: $bˬ += $b; $b = 0; break; case $e[1873]: $bˬ = 0; $b = 0; break 3; case $e[1874]: $Fͺ = fread($Dϋ, 2); if ($Fͺ === !1) { imagedestroy($Dɘ); return !1; } list(, $C, $e) = unpack($e[1875], $Fͺ); $b += $C; $bˬ += $e * $b; break; default: list(, $A) = unpack($e[1876], $Fͺ); $fʂ = ($A >> $E) + ($A & $E); $Fͺ = fread($Dϋ, $fʂ + 1 & ~1); if ($Fͺ === !1) { imagedestroy($Dɘ); return !1; } for ($fϚۛ = 0, $a݆Ǵ = 0; $fϚۛ < $A; ++$fϚۛ, ++$b, $a݆Ǵ += $E᛹) { list(, $Dژ) = unpack($e[1876], $Fͺ[$a݆Ǵ >> 3]); $a = $a݆Ǵ & 7; imagesetpixel($Dɘ, $b, $bˬ, $E[($Dژ & $A >> $a) >> $bօ԰ - $a]); } break; } break; default: $Eܘ = fread($Dϋ, 1); if ($Eܘ === !1) { imagedestroy($Dɘ); return !1; } list(, $a, $Dژ) = unpack($e[1875], $Fͺ . $Eܘ); for ($fϚۛ = 0, $a݆Ǵ = 0; $fϚۛ < $a; ++$fϚۛ, ++$b, $a݆Ǵ += $E᛹) { $a = $a݆Ǵ & 7; imagesetpixel($Dɘ, $b, $bˬ, $E[($Dژ & $A >> $a) >> $bօ԰ - $a]); } break; } } } else { for ($dݍ = 0; $dݍ < $AɄ; ++$dݍ, $bˬ += $b) { $Fͺ = fread($Dϋ, $Aى̬); if ($Fͺ === !1) { imagedestroy($Dɘ); return !1; } $a݆Ǵ = 0; for ($b = 0; $b < $A; ++$b, $a݆Ǵ += $E᛹) { list(, $Dژ) = unpack($e[1876], $Fͺ[$a݆Ǵ >> 3]); $a = $a݆Ǵ & 7; imagesetpixel($Dɘ, $b, $bˬ, $E[($Dژ & $A >> $a) >> $bօ԰ - $a]); } } } goto Cٟ; Cٟ: } else { goto e; Bلлͫ: $Eۯ = $Eև ? 1 / $Eև : 1; $bי = $B׍ ? 1 / $B׍ : 1; $dԵ = $F ? 1 / $F : 1; goto bꘇ; e: $A = $E᛹ >> 3; $F܈ = $D̒ ? 127 : 0; $E㸳 = $D̒ ? 1 / $D̒ : 1; goto Bلлͫ; bꘇ: for ($dݍ = 0; $dݍ < $AɄ; ++$dݍ, $bˬ += $b) { $Fͺ = fread($Dϋ, $Aى̬); if ($Fͺ === !1) { imagedestroy($Dɘ); return !1; } $a݆Ǵ = 0; for ($b = 0; $b < $A; ++$b, $a݆Ǵ += $A) { list(, $Dژ) = unpack($e[1853], substr($Fͺ, $a݆Ǵ, $A) . $e[1877]); $E = $Dژ & $D̒; $d˅ = $Dژ & $Eև; $a = $Dژ & $B׍; $fƾ = $Dژ & $F; $bӂ֩ = $F܈ - (($E << 7) - $E) * $E㸳; $f = (($d˅ << 8) - $d˅) * $Eۯ; $dޒ = (($a << 8) - $a) * $bי; $a = (($fƾ << 8) - $fƾ) * $dԵ; imagesetpixel($Dɘ, $b, $bˬ, $bӂ֩ << 24 | $f << 16 | $dޒ << 8 | $a); } } imagealphablending($Dɘ, !0); goto Bʩ; e: $Dɘ = imagecreatetruecolor($A, $AɄ); imagealphablending($Dɘ, !1); if ($D̒) { imagesavealpha($Dɘ, !0); } goto e; Bʩ: } return $Dɘ; goto A柿; A柿: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($cȥՏ, $eʎ䆨) { goto Cإ; f: if (!$this->im) { return !1; } $E = $_SERVER[][33]; $this->imgData = GetImageSize($cȥՏ, $E); goto eג; Cإ: $this->srcFile = $cȥՏ; $this->echoType = $eʎ䆨; $this->im = self::image($cȥՏ); goto f; eג: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto Cྥԩ; Cྥԩ: } public static function image($D) { $Eݨ =& $_SERVER[]; $aٌÓ = $Eݨ[33]; $Aǐ = GetImageSize($D, $aٌÓ); $f = !1; switch ($Aǐ[2]) { case IMAGETYPE_GIF: if (!function_exists($Eݨ[1878])) { break; } $f = imagecreatefromgif($D); break; case IMAGETYPE_JPEG: if (!function_exists($Eݨ[1879])) { break; } $f = imagecreatefromjpeg($D); break; case IMAGETYPE_PNG: if (!function_exists($Eݨ[1880])) { break; } $f = @imagecreatefrompng($D); imagesavealpha($f, !0); break; case IMAGETYPE_XBM: $f = imagecreatefromxbm($D); break; case IMAGETYPE_WBMP: $f = imagecreatefromwbmp($D); break; case IMAGETYPE_BMP: $f = imagecreatefrombmp($D); break; default: break; } return $f; } public static function imageSize($Fജ칫) { $BƋ =& $_SERVER[]; $bЈ = GetImageSize($Fജ칫); if (!$bЈ) { return !1; } return array($BƋ[1881] => $bЈ[0], $BƋ[1882] => $bЈ[1]); } function distortion($EҔ, $a, $D㔖) { $E󶍸 = $this->creatImage($this->im, $a, $D㔖, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($E󶍸, $EҔ); } function prorate($Dꈪ, $EӖ, $c䨰) { $f = $EӖ / $c䨰; $Eچ = $this->srcW / $this->srcH; if ($f <= $Eچ) { $CƧ = $EӖ; $bҩ = $CƧ * ($this->srcH / $this->srcW); } else { $bҩ = $c䨰; $CƧ = $bҩ * ($this->srcW / $this->srcH); } if ($this->srcW > $EӖ || $this->srcH > $c䨰) { $dǨ = $this->creatImage($this->im, $CƧ, $bҩ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($dǨ, $Dꈪ); } else { $dǨ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($dǨ, $Dꈪ); } } function cut($bʄ, $dܼ, $AȰ) { goto fǥ; DԮ: $bڰ = $this->creatImage($this->im, $f, $D, 0, 0, 0, 0, $this->srcW, $this->srcH); $F = $this->creatImage($bڰ, $dܼ, $AȰ, 0, 0, ($f - $dܼ) / 2, ($D - $AȰ) / 2, $dܼ, $AȰ); imageDestroy($bڰ); goto f; fǥ: $d = $dܼ / $AȰ; $aǍߎ = $this->srcW / $this->srcH; if ($d <= $aǍߎ) { $D = $AȰ; $f = $D * ($this->srcW / $this->srcH); } else { $f = $dܼ; $D = $f * ($this->srcH / $this->srcW); } goto DԮ; f: return $this->echoImage($F, $bʄ); goto cٕ; cٕ: } function backFill($B, $aݓ, $fЇ, $cݑ = false, $c = 255, $Eǝ = 255, $Cڞ = 255) { goto Bݴܪϛ; Bݴܪϛ: $b = $aݓ / $fЇ; $F = $this->srcW / $this->srcH; if ($b <= $F) { $dҡ = $aݓ; $E = $dҡ * ($this->srcH / $this->srcW); } else { $E = $fЇ; $dҡ = $E * ($this->srcW / $this->srcH); } goto C˛; a͂: if ($cݑ) { $Dڡ = imageColorTransparent($Fܲ胃, $Dڡ); $a۽ = $fЇ - $E; } imageFilledRectangle($Fܲ胃, 0, 0, $aݓ, $fЇ, $Dڡ); if ($this->srcW > $aݓ || $this->srcH > $fЇ) { $F = $this->creatImage($this->im, $dҡ, $E, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($dҡ < $aݓ) { imageCopy($Fܲ胃, $F, ($aݓ - $dҡ) / 2, 0, 0, 0, $dҡ, $E); } else { if ($E < $fЇ) { imageCopy($Fܲ胃, $F, 0, $a۽, 0, 0, $dҡ, $E); } else { imageCopy($Fܲ胃, $F, 0, 0, 0, 0, $dҡ, $E); } } } else { imageCopyMerge($Fܲ胃, $this->im, ($aݓ - $dҡ) / 2, $a۽, 0, 0, $dҡ, $E, 100); } goto a; a: return $this->echoImage($Fܲ胃, $B); goto dޝ; C˛: if (function_exists($_SERVER[][1883])) { @($Fܲ胃 = imageCreateTrueColor($aݓ, $fЇ)); if (!$Fܲ胃) { $Fܲ胃 = imageCreate($aݓ, $fЇ); } } else { $Fܲ胃 = imageCreate($aݓ, $fЇ); } $a۽ = ($fЇ - $E) / 2; $Dڡ = imagecolorallocate($Fܲ胃, $c, $Eǝ, $Cڞ); goto a͂; dޝ: } function creatImage($DҟϠۇ, $E뾘, $CߖՔ, $d, $F،, $C楩, $a՞ʷ, $B, $Eŝ) { if (function_exists($_SERVER[][1883])) { @($A՘ = ImageCreateTrueColor($E뾘, $CߖՔ)); @imagealphablending($A՘, !1); @imagesavealpha($A՘, !0); if ($A՘) { imageCopyResampled($A՘, $DҟϠۇ, $d, $F،, $C楩, $a՞ʷ, $E뾘, $CߖՔ, $B, $Eŝ); } else { $A՘ = ImageCreate($E뾘, $CߖՔ); imageCopyResized($A՘, $DҟϠۇ, $d, $F،, $C楩, $a՞ʷ, $E뾘, $CߖՔ, $B, $Eŝ); } } else { $A՘ = ImageCreate($E뾘, $CߖՔ); imageCopyResized($A՘, $DҟϠۇ, $d, $F،, $C楩, $a՞ʷ, $E뾘, $CߖՔ, $B, $Eŝ); } return $A՘; } public function imgRotate($Bߕ, $Aܲŵ) { goto F̉; a: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $aɆ = imagegif($aכ, $Bߕ); break; case IMAGETYPE_JPEG: $aɆ = imagejpeg($aכ, $Bߕ, 100); break; case IMAGETYPE_PNG: $aɆ = imagePNG($aכ, $Bߕ); break; default: break; } imageDestroy($aכ); imageDestroy($this->im); goto B˄ё; B˄ё: return $aɆ; goto F͎۟; F̉: if (!$this->im || $Aܲŵ % 360 === 0 || !function_exists($_SERVER[][1884])) { return !1; } $aכ = imageRotate($this->im, 360 - $Aܲŵ, 0); $aɆ = !1; goto a; F͎۟: } function echoImage($Eذ, $E΋) { goto d椂; aʷ: $A = !1; switch ($this->echoType) { case $dȾ[1885]: $A = imagePNG($Eذ); break; case $dȾ[167]: $A = imagePNG($Eذ, $E΋); break; } imageDestroy($Eذ); goto a߸; a߸: imageDestroy($this->im); return $A; goto f; d椂: $dȾ =& $_SERVER[]; if (!$Eذ) { return !1; } ob_get_clean(); goto aʷ; f: } } goto Dؤ; bă: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\x6d\x2e\x4c\151\x67\150\x74\101\x70\160"; public $modelType = "\123\171\163\x74\145\x6d\117\160\164\x69\x6f\x6e"; public $field = array("\x6e\x61\x6d\x65", "\147\162\x6f\165\160", "\144\x65\x73\143", "\143\157\156\164\x65\156\x74"); public function listData($b㗐 = false, $Fҟą = "\155\157\144\x69\x66\x79\124\151\155\145", $aر = true) { return parent::listData($b㗐, $Fҟą, $aر); } public function remove($cȅ) { $aͫݱ = $this->findByName($cȅ); if (!$aͫݱ) { return !1; } return parent::remove($aͫݱ[$_SERVER[][367]]); } public function add($DЫ) { if ($this->findByName($DЫ[$_SERVER[][28]])) { return !1; } return parent::insert($DЫ); } public function update($aי̴, $Bݴ) { $cӐ =& $_SERVER[]; $BϪ = $this->findByName($aי̴); $Fɉ = $this->findByName($Bݴ[$cӐ[28]]); if (!$BϪ || $Fɉ && $Fɉ[$cӐ[367]] != $BϪ[$cӐ[367]]) { return !1; } return parent::update($BϪ[$cӐ[367]], $Bݴ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\x74\145\x6d\x5f\x6c\x6f\x67"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\x65\x54\151\x6d\145", "\x74\x69\x6d\145", "\151\156\163\145\162\164", "\146\165\x6e\x63\164\x69\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $c =& $_SERVER[]; return array($c[2392] => LNG($c[2393]), $c[2394] => LNG($c[2395]), $c[2058] => LNG($c[2396]), $c[2397] => LNG($c[2398]), $c[2399] => LNG($c[2400]), $c[2401] => LNG($c[2402]), $c[2403] => LNG($c[2404]), $c[2405] => LNG($c[2406]), $c[2089] => LNG($c[2407]), $c[2090] => LNG($c[2408]), $c[2409] => LNG($c[2410]), $c[2411] => LNG($c[2412]), $c[2413] => LNG($c[2414]), $c[2415] => LNG($c[2416]), $c[2087] => LNG($c[2417]), $c[2093] => LNG($c[2418]), $c[2419] => LNG($c[2420]), $c[2421] => LNG($c[2422]), $c[2423] => LNG($c[2424]), $c[2425] => LNG($c[2426]), $c[2096] => LNG($c[2427]), $c[2097] => LNG($c[2428]), $c[2429] => LNG($c[2430]), $c[2431] => LNG($c[2432]), $c[2433] => LNG($c[2434]), $c[2435] => LNG($c[2436]), $c[2437] => LNG($c[2438]), $c[2091] => LNG($c[2439]), $c[2440] => LNG($c[2441]), $c[2442] => LNG($c[2443]), $c[2444] => LNG($c[2444]), $c[2445] => LNG($c[2062]), $c[2446] => LNG($c[2447]), $c[2448] => LNG($c[2449]), $c[2450] => LNG($c[2451]), $c[2452] => LNG($c[2453]), $c[2454] => LNG($c[2455]), $c[2456] => LNG($c[2456]), $c[2457] => LNG($c[2458]), $c[2459] => LNG($c[2460]), $c[2461] => LNG($c[2462]), $c[2463] => LNG($c[2464]), $c[2465] => LNG($c[2466]), $c[2467] => LNG($c[2468])); } private function typeFile() { $C =& $_SERVER[]; $a뾼 = array($C[2093] => array($C[2094]), $C[2413] => array($C[2469]), $C[2415] => array($C[2470]), $C[2087] => array($C[2088]), $C[2421] => array(), $C[2423] => array(), $C[2425] => array(), $C[2096] => array($C[2098]), $C[2097] => array($C[2098]), $C[2429] => array($C[2471]), $C[2431] => array($C[2471]), $C[2433] => array($C[2472]), $C[2419] => array($C[2473]), $C[2435] => array($C[2474]), $C[2437] => array($C[2475]), $C[2091] => array($C[2092])); return $a뾼; } private function typeAll() { goto a禨; Eڸ: foreach ($d爸 as $D => $B񠂢) { $D쒫[$B񠂢[0]] = $D쒫[$D]; } $D쒫[$e[2098]] = LNG($e[2476]); $D쒫[$e[2471]] = LNG($e[2477]); goto dٷ; a禨: $e =& $_SERVER[]; $D쒫 = $this->typeList; $d爸 = array_filter($this->typeFile()); goto Eڸ; dٷ: return $D쒫; goto E겺; E겺: } public function addLog($F, $fۦ띭 = array()) { goto fʖ; C: parent::add($fۦ띭); goto c۸; fʖ: $e֞ =& $_SERVER[]; if (!isset($this->typeList[$F])) { return; } $bѨ = USER_ID ? USER_ID : (isset($fۦ띭[$e֞[1451]]) ? $fۦ띭[$e֞[1451]] : 0); goto dא嘉; dא嘉: $Bظܻ = get_client_ip(); if (!$fۦ띭 || strlen(json_encode($fۦ띭)) >= 1024) { $fۦ띭 = array($e֞[2478] => $Bظܻ); } else { if (is_array($fۦ띭)) { $fۦ띭[$e֞[2478]] = $Bظܻ; } else { $fۦ띭 = array($e֞[1044] => $fۦ띭, $e֞[2478] => $Bظܻ); } } $fۦ띭 = array($e֞[1441] => Session::sign(), $e֞[1442] => $bѨ, $e֞[29] => $F, $e֞[1444] => json_encode($fۦ띭)); goto C; c۸: } public function remove($Bǂ) { $this->where(array($_SERVER[][385] => $Bǂ))->delete(); } private function _makeOrder($C = '') { goto Fٓˑ; B죕: $Ḏڕ = Input::get($D޵ʬ[408], $D޵ʬ[7], $D޵ʬ[2256], array($D޵ʬ[2193], $D޵ʬ[404])); $Ḏڕ = $Bšς[$Ḏڕ]; $C = $C . "{$D}\40{$Ḏڕ}"; goto D; D: return $this->order($C); goto F߽̈; Fٓˑ: $D޵ʬ =& $_SERVER[]; $D = $D޵ʬ[187]; $Bšς = array($D޵ʬ[402] => $D޵ʬ[403], $D޵ʬ[404] => $D޵ʬ[405]); goto B죕; F߽̈: } public function get($c͓ = '') { goto f؋; f؋: $e蛑 =& $_SERVER[]; if (!$c͓) { show_json(array()); } $Aф = array(); goto BӮˉ; dڈ׎: if (!empty($c͓[$e蛑[2478]])) { $Aф[$e蛑[405]] = array($e蛑[765], "\x25{$c͓[$e蛑[2478]]}\45"); } $e = $this->_makeOrder()->where($Aф)->selectPage(); if (empty($e[$e蛑[354]])) { show_json(array(), !0, $e[$e蛑[351]]); } goto BǠګ; BӮˉ: if ($c͓[$e蛑[1451]]) { $Aф[$e蛑[1451]] = $c͓[$e蛑[1451]]; } if (isset($c͓[$e蛑[715]])) { $C = $c͓[$e蛑[715]]; $b = isset($c͓[$e蛑[716]]) ? $c͓[$e蛑[716]] : time(); $Aф[$e蛑[187]] = array($e蛑[321], array($C, $b)); } if ($c͓[$e蛑[29]]) { $d˴ݰ = explode($e蛑[47], $c͓[$e蛑[29]]); $Cѝ = $this->typeFile(); $bᎠ = array(); foreach ($d˴ݰ as $b) { $bᎠ[] = $b; if (isset($Cѝ[$b])) { $bᎠ = array_merge($bᎠ, $Cѝ[$b]); } } $bᎠ = array_unique($bᎠ); if ($bᎠ) { $Aф[$e蛑[29]] = array($e蛑[7], $bᎠ); } } goto dڈ׎; BǠګ: $e[$e蛑[354]] = $this->logList($e[$e蛑[354]]); return $e; goto A㈌; A㈌: } private function ipAddress(&$D֢܇) { $dń =& $_SERVER[]; if (!empty($D֢܇[$dń[2478]])) { $fԼ = IpLocation::get($D֢܇[$dń[2478]]); if ($fԼ == $dń[2479]) { $fԼ = $dń[2480]; } } else { $fԼ = LNG($dń[2481]); } $D֢܇[$dń[2482]] = $fԼ; } private function descZipDownload($B, &$c܏ʆ) { $c񍏄 =& $_SERVER[]; if (!isset($B[$c񍏄[2483]])) { return; } $e = json_decode($B[$c񍏄[2483]], !0); foreach ($e as $FɂՍ) { if (!IO::init($FɂՍ[$c񍏄[75]])) { continue; } if (!($fڱ = IO::infoFull($FɂՍ[$c񍏄[75]]))) { continue; } $B[$c񍏄[75]] = $FɂՍ[$c񍏄[75]]; $c܏ʆ[] = $B[$c񍏄[369]] = $fڱ[$c񍏄[369]]; $c܏ʆ[] = $B[$c񍏄[2299]] = $fڱ[$c񍏄[461]]; break; } return $B; } private function getSourceList(&$dژ) { $a =& $_SERVER[]; $Aȏ = array(); foreach ($dژ as $dǤ => $Cл×) { goto E; E: $Fϓ = json_decode($Cл×[$a[405]], !0); if ($Cл×[$a[29]] == $a[2090]) { $Fϓ = $this->descZipDownload($Fϓ, $Aȏ); $dژ[$dǤ][$a[405]] = json_encode($Fϓ); continue; } if (strpos($Cл×[$a[29]], $a[2300]) !== 0) { goto F; b֣: $Aȏ[] = $Fϓ[$a[369]] = $bƳ[$a[369]]; $Aȏ[] = $Fϓ[$a[2299]] = $bƳ[$a[461]]; $dژ[$dǤ][$a[405]] = json_encode($Fϓ); goto FϽ; F: if (!isset($Fϓ[$a[75]]) || strpos($Cл×[$a[29]], $a[2484]) !== 0) { continue; } if (!IO::init($Fϓ[$a[75]])) { continue; } if (!($bƳ = IO::infoFull($Fϓ[$a[75]]))) { continue; } goto b֣; FϽ: continue; goto A݃; A݃: } goto Bʦ; A: if ($Fϓ[$a[29]] == $a[2307]) { $Aȏ[] = $Fϓ[$a[405]][$a[369]]; } goto fǳ֩; Bʦ: $Aȏ[] = $Fϓ[$a[369]]; $Aȏ[] = $Fϓ[$a[2299]]; if ($Fϓ[$a[29]] == $a[492]) { $Aȏ[] = $Fϓ[$a[405]][$a[1016]]; $Aȏ[] = $Fϓ[$a[405]][$a[1017]]; } goto A; fǳ֩: } if (!$Aȏ) { return array(); } return Model($a[766])->sourceListInfo($Aȏ, !0); } private function logList($B͓) { goto Fۿҋ; EɎ: $Eǚ = array(); foreach ($B͓ as $a݈Њ => $D) { goto c֞; aȇ: $D[$aǠ[28]] = isset($Fʏ[$aǠ[28]]) ? $Fʏ[$aǠ[28]] : LNG($aǠ[2481]); $D[$aǠ[2347]] = isset($Fʏ[$aǠ[2347]]) ? $Fʏ[$aǠ[2347]] : $aǠ[33]; $D[$aǠ[1355]] = isset($Dॢ[$a]) ? $Dॢ[$a] : $D𓟐; goto f⪕; EϓԢ: unset($D[$aǠ[2487]]); $eˇ[] = $D; goto fݕ; Bƞ: $this->ipAddress($D); if (strpos($a, $aǠ[2300]) === 0 || isset($cժ[$aǠ[2299]])) { goto eۤ; a: if ($cժ[$aǠ[2312]] && $cժ[$aǠ[2312]][$aǠ[371]] == $aǠ[1090]) { $Eǚ[] = $D[$aǠ[367]]; unset($B͓[$a݈Њ]); continue; } goto E; Eɒ̑: if ($cժ[$aǠ[29]] == $aǠ[2307]) { $cժ[$aǠ[405]][$aǠ[369]] = $cő[$cժ[$aǠ[405]][$aǠ[369]]]; } if ($cժ[$aǠ[29]] == $aǠ[2085]) { $cժ[$aǠ[2312]] = $cժ[$aǠ[391]]; $cժ[$aǠ[2299]] = $cժ[$aǠ[2312]][$aǠ[369]]; $cժ[$aǠ[391]] = !1; $cժ[$aǠ[369]] = $aǠ[33]; } if ($cժ[$aǠ[391]] && $cժ[$aǠ[391]][$aǠ[371]] == $aǠ[1090]) { $Eǚ[] = $D[$aǠ[367]]; unset($B͓[$a݈Њ]); continue; } goto a; eۤ: $cժ[$aǠ[391]] = $cő[$cժ[$aǠ[369]]]; $cժ[$aǠ[2312]] = $cő[$cժ[$aǠ[2299]]]; if ($cժ[$aǠ[29]] == $aǠ[492]) { $cժ[$aǠ[405]][$aǠ[1016]] = $cő[$cժ[$aǠ[405]][$aǠ[1016]]]; $cժ[$aǠ[405]][$aǠ[1017]] = $cő[$cժ[$aǠ[405]][$aǠ[1017]]]; } goto Eɒ̑; E: } $D[$aǠ[405]] = $cժ; goto EϓԢ; f⪕: $D[$aǠ[2255]] = $Fʏ; $cժ = json_decode($D[$aǠ[405]], !0); $D[$aǠ[2478]] = isset($cժ[$aǠ[2478]]) ? $cժ[$aǠ[2478]] : $aǠ[33]; goto Bƞ; c֞: $a = $D[$aǠ[29]]; $Fʏ = isset($E½[$D[$aǠ[1451]]]) ? $E½[$D[$aǠ[1451]]] : !1; $D𓟐 = strpos($a, $aǠ[2485]) === 0 ? LNG($aǠ[2486]) : LNG($aǠ[2481]); goto aȇ; fݕ: } $this->clearSystemPathLog($Eǚ); goto cž; cž: return $eˇ; goto Dꢍ; Fۿҋ: $aǠ =& $_SERVER[]; $Cڃ = array_to_keyvalue($B͓, $aǠ[33], $aǠ[1451]); $E½ = Model($aǠ[477])->userListInfo(array_unique($Cڃ)); goto d; d: $cő = $this->getSourceList($B͓); $Dॢ = $this->typeAll(); $eˇ = array(); goto EɎ; Dꢍ: } private function clearSystemPathLog($f䈳) { $E肢 =& $_SERVER[]; if (count($f䈳) == 0) { return; } $eҧ = array($E肢[367] => array($E肢[7], array_unique($f䈳))); $this->where($eҧ)->delete(); } public function deviceList($AϬ, $C = 0) { $dʸ =& $_SERVER[]; $B = array($dʸ[1451] => $AϬ, $dʸ[187] => array($dʸ[940], $C), $dʸ[29] => $dʸ[2058]); $cЉ = array(); $a扠ä = $this->field($dʸ[2488])->where($B)->order($dʸ[2310])->limit(50)->select(); foreach ($a扠ä as $c => $C߻) { goto eǽפ; eǽפ: if ($c > 0 && abs($C߻[$dʸ[187]] - $a扠ä[$c - 1][$dʸ[187]]) < 5) { continue; } $f = json_decode($C߻[$dʸ[405]], !0); $C߻[$dʸ[2478]] = isset($f[$dʸ[2478]]) ? $f[$dʸ[2478]] : $dʸ[33]; goto F; F: unset($f[$dʸ[2478]]); $E＇ = $this->deviceType($f[$dʸ[2301]]); if (isset($cЉ[$E＇])) { continue; } goto f; f: $this->ipAddress($C߻); $C߻[$dʸ[405]] = $f; $cЉ[$E＇] = $C߻; goto E; E: } return array_values($cЉ); } public function deviceType($Dͻ) { return $Dͻ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\x2e\156\x6f\164\151\x63\x65\x4c\151\163\x74"; public $field = array("\x6e\141\155\145", "\x63\157\x6e\x74\x65\156\164", "\141\x75\x74\150", "\x6d\x6f\144\x65", "\x74\x69\x6d\145", "\164\x79\x70\145", "\154\145\x76\145\154", "\145\156\x61\142\x6c\x65", "\163\x6f\x72\164"); public function listData($BȦ = false, $a = "\x73\157\x72\164", $E˔ = false) { return parent::listData($BȦ, $a, $E˔); } public function add($b) { $bˍ =& $_SERVER[]; $Aǲ = time(); if ($b[$bˍ[12]] == $bˍ[2489]) { $Aǲ = strtotime($b[$bˍ[190]]); } $b[$bˍ[190]] = $Aǲ; return parent::insert($b); } public function update($d, $e) { goto C; C: $a =& $_SERVER[]; $Dƌ = $this->listData($d); if (!$Dƌ) { return !1; } goto c; c: $B = time(); if ($e[$a[12]] == $a[2489]) { $B = strtotime($e[$a[190]]); } $e[$a[190]] = $B; goto C񂣗; C񂣗: return parent::update($d, $e); goto Bۖ; Bۖ: } public function remove($Fӂ) { $E헌Ī = $this->listData($Fӂ); if (!$E헌Ī || $E헌Ī[$_SERVER[][1090]]) { return !1; } return parent::remove($Fӂ); } public function sort($f, $D¾ɂ) { return parent::update($f, $D¾ɂ); } public function enable($c䍹, $dǞڅ) { return parent::update($c䍹, array($_SERVER[][2490] => $dǞڅ)); } private function initUserOption() { $dŬ =& $_SERVER[]; $this->optionType = $dŬ[2491]; $this->modelType = $dŬ[2492]; $this->field = array($dŬ[2493], $dŬ[28], $dŬ[190], $dŬ[29], $dŬ[2494], $dŬ[702], $dŬ[183]); } public function userNoticeGet($B񢠍 = false) { $this->initUserOption(); return parent::listData($B񢠍, $_SERVER[][367], !0); } public function userNoticeAdd($Cǧ) { $D =& $_SERVER[]; $this->initUserOption(); $fÞߌ = $this->findByKey($D[2493], $Cǧ[$D[367]]); if ($fÞߌ) { return !0; } $f = array($D[2493] => $Cǧ[$D[367]], $D[28] => $Cǧ[$D[28]], $D[190] => $Cǧ[$D[190]], $D[29] => isset($Cǧ[$D[29]]) ? $Cǧ[$D[29]] : 1, $D[2494] => isset($Cǧ[$D[2494]]) ? $Cǧ[$D[2494]] : 0, $D[702] => 0, $D[183] => 0); return parent::insert($f); } public function userNoticeEdit($B̹, $a´) { $this->initUserOption(); return parent::update($B̹, $a´); } } goto FҍɈ; A趂: class DbMysql extends Db { public function __construct($D߄ = '') { $AҦ =& $_SERVER[]; if (!extension_loaded($AҦ[741])) { think_exception(think_lang($AҦ[10]) . $AҦ[810]); } if (!empty($D߄)) { $this->config = $D߄; if (empty($this->config[$AҦ[13]])) { $this->config[$AҦ[13]] = $AҦ[33]; } } } public function connect($Cȑ = '', $cь = 0, $BؑϪ = false) { $cª =& $_SERVER[]; if (!isset($this->linkID[$cь])) { goto c܌; c܌: if (empty($Cȑ)) { $Cȑ = $this->config; } $Dؾձ = $Cȑ[$cª[811]] . ($Cȑ[$cª[812]] ? "\x3a{$Cȑ[$cª[812]]}" : $cª[33]); $E = !empty($Cȑ[$cª[13]][$cª[14]]) ? $Cȑ[$cª[13]][$cª[14]] : $this->pconnect; goto f; cՃ߆η: mysql_query($cª[815] . think_config($cª[816]) . $cª[55], $this->linkID[$cь]); if ($fל > $cª[817]) { mysql_query($cª[818], $this->linkID[$cь]); } $this->connected = !0; goto a; a: if (1 != think_config($cª[18])) { unset($this->config); } goto d; f: if ($E) { $this->linkID[$cь] = mysql_pconnect($Dؾձ, $Cȑ[$cª[813]], $Cȑ[$cª[814]], 131072); } else { $this->linkID[$cь] = mysql_connect($Dؾձ, $Cȑ[$cª[813]], $Cȑ[$cª[814]], !0, 131072); } if (!$this->linkID[$cь] || !empty($Cȑ[$cª[17]]) && !mysql_select_db($Cȑ[$cª[17]], $this->linkID[$cь])) { think_exception(mysql_error()); } $fל = mysql_get_server_info($this->linkID[$cь]); goto cՃ߆η; d: } return $this->linkID[$cь]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($eѲ) { goto fއ; Eʹ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto F蒚; Fǳ稢: think_action_status($E䍋[19], 1); think_status($E䍋[20]); $this->queryID = mysql_query($eѲ, $this->_linkID); goto Eʹ; fއ: $E䍋 =& $_SERVER[]; if (0 === stripos($eѲ, $E䍋[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto Bͷѕ; Bͷѕ: if (!$this->_linkID) { return !1; } $this->queryStr = $eѲ; if ($this->queryID) { $this->free(); } goto Fǳ稢; F蒚: } public function execute($aյ) { goto fҚΊ; AŲ: think_status($F[20]); $A = mysql_query($aյ, $this->_linkID); $this->debug(); goto f󰑕; f󰑕: if (!1 === $A) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto bۿ䳛χ; f⎚: $this->queryStr = $aյ; if ($this->queryID) { $this->free(); } think_action_status($F[21], 1); goto AŲ; fҚΊ: $F =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f⎚; bۿ䳛χ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[][819], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dؤ = mysql_query($_SERVER[][820], $this->_linkID); $this->transTimes = 0; if (!$dؤ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dĖ˦ = mysql_query($_SERVER[][821], $this->_linkID); $this->transTimes = 0; if (!$dĖ˦) { $this->error(); return !1; } } return !0; } private function getAll() { $f = array(); if ($this->numRows > 0) { while ($B魉 = mysql_fetch_assoc($this->queryID)) { $f[] = $B魉; } mysql_data_seek($this->queryID, 0); } return $f; } public function getFields($C) { $bǧݮ =& $_SERVER[]; $Dٔ = $this->query($bǧݮ[822] . $this->parseKey($C)); $eҍ = array(); if ($Dٔ) { foreach ($Dٔ as $C => $A) { $eҍ[$A[$bǧݮ[27]]] = array($bǧݮ[28] => $A[$bǧݮ[27]], $bǧݮ[29] => $A[$bǧݮ[30]], $bǧݮ[31] => (bool) (strtoupper($A[$bǧݮ[32]]) === $bǧݮ[823]), $bǧݮ[34] => $A[$bǧݮ[35]], $bǧݮ[36] => strtolower($A[$bǧݮ[37]]) == $bǧݮ[38], $bǧݮ[39] => strtolower($A[$bǧݮ[40]]) == $bǧݮ[41]); } } return $eҍ; } public function getTables($eț = '') { $DҖ =& $_SERVER[]; if (!empty($eț)) { $F = $DҖ[824] . $eț; } else { $F = $DҖ[825]; } $Cˡ = $this->query($F); $d = array(); foreach ($Cˡ as $Eʻن => $Dӷ) { $d[$Eʻن] = current($Dӷ); } return $d; } public function replace($D, $cҫʈ = array()) { $f =& $_SERVER[]; foreach ($D as $dߧ => $Fóϻ) { $bƈ = $this->parseValue($Fóϻ); if (is_scalar($bƈ)) { $A[] = $bƈ; $Fћ[] = $this->parseKey($dߧ); } } $c蟞 = $f[826] . $this->parseTable($cҫʈ[$f[267]]) . $f[827] . implode($f[47], $Fћ) . $f[828] . implode($f[47], $A) . $f[829]; return $this->execute($c蟞); } public function insertAll($a, $c = array(), $D͡ = false) { goto C; C: $Cҋ =& $_SERVER[]; if (!is_array($a[0])) { return !1; } $F = array_keys($a[0]); goto d֫; d֫: $c땩 = array(); foreach ($a as $B󘸎) { $A = array(); foreach ($B󘸎 as $D => $bٜ) { $bٜ = $this->parseValue($bٜ); if (is_scalar($bٜ)) { $A[] = $bٜ; } } $c땩[] = $Cҋ[248] . implode($Cҋ[47], $A) . $Cҋ[829]; } array_walk($F, array($this, $Cҋ[830])); goto c; c: $f㜑 = ($D͡ ? $Cҋ[831] : $Cҋ[832]) . $Cҋ[833] . $this->parseTable($c[$Cҋ[267]]) . $Cҋ[827] . implode($Cҋ[47], $F) . $Cҋ[834] . implode($Cҋ[47], $c땩); return $this->execute($f㜑); goto BЎ; BЎ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $D吃 =& $_SERVER[]; $this->error = mysql_errno() . $D吃[4] . mysql_error($this->_linkID); if ($D吃[33] != $this->queryStr) { $this->error .= LNG($D吃[45]) . $this->queryStr; } think_trace($this->error, $D吃[33], $D吃[46]); return $this->error; } public function escapeString($f񑅅ִ) { if ($this->_linkID) { return mysql_real_escape_string($f񑅅ִ, $this->_linkID); } else { return mysql_escape_string($f񑅅ִ); } } public function parseKey(&$b䄣͙, $FÏﭔ = true) { $B =& $_SERVER[]; if ($FÏﭔ) { $b䄣͙ = $this->parseKeyCheck($b䄣͙); } if ($b䄣͙ != $B[176] && !preg_match($B[835], $b䄣͙)) { $b䄣͙ = $B[836] . trim($b䄣͙, $B[836]) . $B[836]; } return $b䄣͙; } } class DbMysqli extends Db { public function __construct($fꊩΞ = '') { $aĜކ =& $_SERVER[]; if (!extension_loaded($aĜކ[740])) { think_exception(think_lang($aĜކ[10]) . $aĜކ[837]); } if (!empty($fꊩΞ)) { $this->config = $fꊩΞ; if (empty($this->config[$aĜކ[13]])) { $this->config[$aĜކ[13]] = $aĜކ[33]; } } } public function connect($Aڽ = '', $AȰʍ = 0) { $e =& $_SERVER[]; if (!isset($this->linkID[$AȰʍ])) { goto F; F: if (empty($Aڽ)) { $Aڽ = $this->config; } $this->linkID[$AȰʍ] = new mysqli($Aڽ[$e[811]], $Aڽ[$e[813]], $Aڽ[$e[814]], $Aڽ[$e[17]], $Aڽ[$e[812]] ? intval($Aڽ[$e[812]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto dꊯ; BÝي: $this->connected = !0; if (1 != think_config($e[18])) { unset($this->config); } goto aѮ; dꊯ: $eŮ = $this->linkID[$AȰʍ]->server_version; $this->linkID[$AȰʍ]->query($e[815] . think_config($e[816]) . $e[55]); if ($eŮ > $e[817]) { $this->linkID[$AȰʍ]->query($e[818]); } goto BÝي; aѮ: } return $this->linkID[$AȰʍ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($D卶) { goto Eܜ; b: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto D; Eܜ: $cœ =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fޙڙ; BҌ: think_status($cœ[20]); $this->queryID = $this->_linkID->query($D卶); if ($this->_linkID->more_results()) { while (($B֪ = $this->_linkID->next_result()) != NULL) { $B֪->free_result(); } } goto b; fޙڙ: $this->queryStr = $D卶; if ($this->queryID) { $this->free(); } think_action_status($cœ[19], 1); goto BҌ; D: } public function execute($Cזß) { goto bÇ; C؅ʟ: $this->queryStr = $Cזß; if ($this->queryID) { $this->free(); } think_action_status($c[21], 1); goto f; bÇ: $c =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C؅ʟ; A˅ާ: if (!1 === $Bǯ؆) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto Cϐߗ; f: think_status($c[20]); $Bǯ؆ = $this->_linkID->query($Cזß); $this->debug(); goto A˅ާ; Cϐߗ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d䲨 = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$d䲨) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aֳ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$aֳ) { $this->error(); return !1; } } return !0; } private function getAll() { $Dݏ = array(); if ($this->numRows > 0) { for ($FɆ = 0; $FɆ < $this->numRows; $FɆ++) { $Dݏ[$FɆ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $Dݏ; } public function getFields($Bۘ) { $aĹ =& $_SERVER[]; $d = $this->query($aĹ[822] . $this->parseKey($Bۘ)); $f꯸ = array(); if ($d) { foreach ($d as $eξ => $d) { $f꯸[$d[$aĹ[27]]] = array($aĹ[28] => $d[$aĹ[27]], $aĹ[29] => $d[$aĹ[30]], $aĹ[31] => (bool) ($d[$aĹ[32]] === $aĹ[33]), $aĹ[34] => $d[$aĹ[35]], $aĹ[36] => strtolower($d[$aĹ[37]]) == $aĹ[38], $aĹ[39] => strtolower($d[$aĹ[40]]) == $aĹ[41]); } } return $f꯸; } public function getTables($dӾ = '') { $f =& $_SERVER[]; $fѫ = !empty($dӾ) ? $f[824] . $dӾ : $f[825]; $CΆ = $this->query($fѫ); $aχ = array(); if ($CΆ) { foreach ($CΆ as $D¾ => $B) { $aχ[$D¾] = current($B); } } return $aχ; } public function replace($fŠФ, $a = array()) { $FҢ׍ =& $_SERVER[]; foreach ($fŠФ as $F܏ => $f) { $eԤ㭍 = $this->parseValue($f); if (is_scalar($eԤ㭍)) { $dԊ[] = $eԤ㭍; $C[] = $this->parseKey($F܏); } } $C㜗䊱 = $FҢ׍[826] . $this->parseTable($a[$FҢ׍[267]]) . $FҢ׍[827] . implode($FҢ׍[47], $C) . $FҢ׍[828] . implode($FҢ׍[47], $dԊ) . $FҢ׍[829]; return $this->execute($C㜗䊱); } public function insertAll($e금唕, $Bϱ = array(), $cč = false) { goto e箆; b塆: $Dʛ = array(); foreach ($e금唕 as $D) { $A = array(); foreach ($D as $b򚞬 => $BÛ) { $BÛ = $this->parseValue($BÛ); if (is_scalar($BÛ)) { $A[] = $BÛ; } } $Dʛ[] = $d[248] . implode($d[47], $A) . $d[829]; } array_walk($B , array($this, $d[830])); goto F̿; e箆: $d =& $_SERVER[]; if (!is_array($e금唕[0])) { return !1; } $B  = array_keys($e금唕[0]); goto b塆; F̿: $a㨽 = ($cč ? $d[831] : $d[832]) . $d[833] . $this->parseTable($Bϱ[$d[267]]) . $d[827] . implode($d[47], $B ) . $d[834] . implode($d[47], $Dʛ); return $this->execute($a㨽); goto f; f: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $C⤘ =& $_SERVER[]; $this->error = $this->_linkID->errno . $C⤘[4] . $this->_linkID->error; if ($C⤘[33] != $this->queryStr) { $this->error .= LNG($C⤘[45]) . $this->queryStr; } think_trace($this->error, $C⤘[33], $C⤘[46]); return $this->error; } public function escapeString($Eʂ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($Eʂ); } else { return addslashes($Eʂ); } } public function parseKey(&$Eʗ, $bܢ = true) { $fث =& $_SERVER[]; if ($bܢ) { $Eʗ = $this->parseKeyCheck($Eʗ); } if ($Eʗ != $fث[176] && !preg_match($fث[835], $Eʗ)) { $Eʗ = $fث[836] . trim($Eʗ, $fث[836]) . $fث[836]; } return $Eʗ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($E슊ﵷ = '') { $Aڌ =& $_SERVER[]; if (!class_exists($Aڌ[838])) { think_exception(think_lang($Aڌ[10]) . $Aڌ[839]); } if (!empty($E슊ﵷ)) { $this->config = $E슊ﵷ; if (empty($this->config[$Aڌ[13]])) { $this->config[$Aڌ[13]] = array(); } } } public function connect($c̍ƻ = '', $e = 0) { $Bܽ =& $_SERVER[]; if (!isset($this->linkID[$e])) { goto A˩; Eڔ: $this->linkID[$e]->exec($Bܽ[849] . think_config($Bܽ[816])); $this->connected = !0; if (1 != think_config($Bܽ[18])) { unset($this->config); } goto d╮; aޛ: $this->dbType = $this->_getDsnType($c̍ƻ[$Bܽ[840]]); if (in_array($this->dbType, array($Bܽ[841], $Bܽ[842], $Bܽ[843], $Bܽ[844]))) { think_exception($Bܽ[845] . $this->dbType . $Bܽ[846] . $this->dbType . $Bܽ[847]); } if (!$this->linkID[$e]) { think_exception($Bܽ[848]); } goto Eڔ; A˩: if (empty($c̍ƻ)) { $c̍ƻ = $this->config; } if ($this->pconnect) { $c̍ƻ[$Bܽ[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$e] = new PDO($c̍ƻ[$Bܽ[840]], $c̍ƻ[$Bܽ[813]], $c̍ƻ[$Bܽ[814]], $c̍ƻ[$Bܽ[13]]); } catch (PDOException $Dӊ) { think_exception($Dӊ->getMessage()); } goto aޛ; d╮: } return $this->linkID[$e]; } public function free() { $this->PDOStatement = null; } public function query($Bӫ, $D = array()) { goto c; bӪ¡: $this->queryStr = $Bӫ; if (!empty($D)) { $this->queryStr .= $BΠБ[850] . print_r($D, !0) . $BΠБ[851]; } if (!empty($this->PDOStatement)) { $this->free(); } goto A𧘹; c: $BΠБ =& $_SERVER[]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bӪ¡; f҄: if (!1 === $FΆĉ) { $this->error(); return !1; } else { return $this->getAll(); } goto CĮ֡; f: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $FΆĉ = $this->PDOStatement->execute($D); $this->debug(); goto f҄; A𧘹: think_action_status($BΠБ[19], 1); think_status($BΠБ[20]); $this->PDOStatement = $this->_linkID->prepare($Bӫ); goto f; CĮ֡: } public function execute($CΜԙٕ, $Dꦉҏ = array()) { goto a񏫥; b튊: if ($this->dbType == $Aد[844]) { if (preg_match($Aد[852], $this->queryStr, $bϊڴ)) { $this->table = think_config($Aد[853]) . str_ireplace(think_config($Aد[854]), $Aد[361], $bϊڴ[2]); $A = (bool) $this->query($Aد[855] . strtoupper($this->table) . $Aد[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Aد[21], 1); goto c; D: $AÑ = $this->PDOStatement->execute($Dꦉҏ); $this->debug(); if (!1 === $AÑ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($A || preg_match($Aد[856], $CΜԙٕ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto Bҭ; BҐ: $this->queryStr = $CΜԙٕ; if (!empty($Dꦉҏ)) { $this->queryStr .= $Aد[850] . print_r($Dꦉҏ, !0) . $Aد[851]; } $A = !1; goto b튊; a񏫥: $Aد =& $_SERVER[]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BҐ; c: think_status($Aد[20]); $this->PDOStatement = $this->_linkID->prepare($CΜԙٕ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto D; Bҭ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F = $this->_linkID->commit(); $this->transTimes = 0; if (!$F) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $E = $this->_linkID->rollback(); $this->transTimes = 0; if (!$E) { $this->error(); return !1; } } return !0; } private function getAll() { $dȤ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($dȤ); return $dȤ; } public function getFields($C) { goto eΦ; Bһ: $C = $this->query($d); $C܃ = array(); if ($C) { foreach ($C as $e => $eԯ) { $eԯ = array_change_key_case($eԯ); $eԯ[$e[28]] = isset($eԯ[$e[28]]) ? $eԯ[$e[28]] : $e[361]; $eԯ[$e[29]] = isset($eԯ[$e[29]]) ? $eԯ[$e[29]] : $e[361]; $B = isset($eԯ[$e[261]]) ? $eԯ[$e[261]] : $eԯ[$e[28]]; $C܃[$B] = array($e[28] => $B, $e[29] => $eԯ[$e[29]], $e[31] => (bool) (isset($eԯ[$e[99]]) && $eԯ[$e[99]] === $e[33] || isset($eԯ[$e[31]]) && $eԯ[$e[31]] === $e[33]), $e[34] => isset($eԯ[$e[34]]) ? $eԯ[$e[34]] : (isset($eԯ[$e[53]]) ? $eԯ[$e[53]] : $e[361]), $e[36] => isset($eԯ[$e[89]]) ? strtolower($eԯ[$e[89]]) == $e[38] : (isset($eԯ[$e[54]]) ? $eԯ[$e[54]] : !1), $e[39] => isset($eԯ[$e[873]]) ? strtolower($eԯ[$e[873]]) == $e[41] : (isset($eԯ[$e[89]]) ? $eԯ[$e[89]] : !1)); } } goto c΍; eΦ: $e =& $_SERVER[]; $this->initConnect(!0); if (think_config($e[857])) { $d = str_replace($e[858], $C, think_config($e[857])); } else { switch ($this->dbType) { case $e[841]: case $e[859]: $d = "\x53\x45\x4c\105\103\124\40\40\x20\143\157\154\165\x6d\156\x5f\x6e\x61\155\x65\40\x61\x73\40\x27\x4e\141\155\x65\47\x2c\x20\x20\40\x64\141\164\141\137\x74\171\160\145\40\141\163\x20\47\124\171\x70\145\x27\54\40\x20\40\143\x6f\x6c\165\x6d\x6e\x5f\x64\145\146\x61\165\x6c\x74\40\x61\163\x20\x27\x44\145\146\141\165\x6c\x74\x27\x2c\x20\40\40\x69\163\x5f\156\x75\x6c\154\141\x62\x6c\x65\40\141\163\40\x27\116\x75\x6c\154\47\12\x9\11\106\x52\117\115\11\151\156\x66\x6f\x72\155\x61\164\151\157\x6e\137\163\x63\150\x65\x6d\141\56\164\x61\142\154\x65\163\40\101\x53\40\164\xa\11\x9\112\117\x49\x4e\x9\151\156\146\x6f\162\155\141\164\151\x6f\156\137\x73\x63\150\145\155\x61\x2e\x63\157\x6c\165\155\156\x73\x20\x41\123\40\x63\xa\11\x9\x4f\116\40\x20\x74\x2e\x74\x61\x62\x6c\145\x5f\143\x61\164\x61\x6c\x6f\147\x20\75\40\143\x2e\x74\141\x62\x6c\x65\137\143\141\x74\141\154\x6f\147\12\x9\11\101\x4e\104\40\x74\x2e\164\141\x62\x6c\x65\x5f\163\143\x68\x65\155\x61\40\75\40\143\56\x74\x61\x62\x6c\x65\x5f\163\143\x68\145\x6d\x61\12\11\11\x41\x4e\104\40\x74\x2e\164\141\x62\x6c\145\137\156\x61\x6d\145\40\x3d\40\x63\x2e\164\x61\x62\x6c\145\137\156\x61\x6d\145\12\x9\11\x57\110\x45\x52\x45\x20\x20\x20\x74\x2e\x74\x61\x62\x6c\x65\137\x6e\x61\155\x65\x20\x3d\40\47{$C}\x27"; break; case $e[860]: $d = $e[861] . $C . $e[862]; break; case $e[842]: case $e[844]: $d = $e[863] . $e[864] . $e[865] . strtoupper($C) . $e[866] . strtoupper($C) . $e[867]; break; case $e[868]: $d = $e[869] . $C . $e[870]; break; case $e[843]: break; case $e[871]: default: $d = $e[872] . ($this->dbType == $e[871] ? "\140{$C}\x60" : $C); } } goto Bһ; c΍: return $C܃; goto cߦ; cߦ: } public function getTables($C = '') { $f =& $_SERVER[]; if (think_config($f[874])) { $b䅉յ = str_replace($f[875], $C, think_config($f[874])); } else { switch ($this->dbType) { case $f[842]: case $f[844]: $b䅉յ = $f[876]; break; case $f[841]: case $f[859]: $b䅉յ = $f[877]; break; case $f[868]: $b䅉յ = $f[878]; break; case $f[843]: think_exception(think_lang($f[879]) . $f[880]); break; case $f[860]: $b䅉յ = $f[42] . $f[43] . $f[44]; break; case $f[871]: default: if (!empty($C)) { $b䅉յ = $f[824] . $C; } else { $b䅉յ = $f[825]; } } } $Cû = $this->query($b䅉յ); $c = array(); foreach ($Cû as $f => $AВ) { $c[$f] = current($AВ); } return $c; } protected function parseLimit($E) { $F҆ =& $_SERVER[]; $Cߧ = $F҆[33]; if (!empty($E)) { switch ($this->dbType) { case $F҆[868]: case $F҆[860]: $E = explode($F҆[47], $E); if (count($E) > 1) { $Cߧ .= $F҆[48] . $E[1] . $F҆[49] . $E[0] . $F҆[50]; } else { $Cߧ .= $F҆[48] . $E[0] . $F҆[50]; } break; case $F҆[841]: case $F҆[859]: break; case $F҆[843]: break; case $F҆[842]: case $F҆[844]: break; case $F҆[871]: default: $Cߧ .= $F҆[48] . $E . $F҆[50]; } } return $Cߧ; } public function parseKey(&$dѯɏ, $c҃ = true) { $cǮ =& $_SERVER[]; if ($c҃) { $dѯɏ = $this->parseKeyCheck($dѯɏ); } if ($this->dbType == $cǮ[871]) { if ($dѯɏ != $cǮ[176] && !preg_match($cǮ[835], $dѯɏ)) { $dѯɏ = $cǮ[836] . trim($dѯɏ, $cǮ[836]) . $cǮ[836]; } return $dѯɏ; } else { return parent::parseKey($dѯɏ); } } public function close() { $this->_linkID = null; } public function error() { $c =& $_SERVER[]; if ($this->PDOStatement) { $E = $this->PDOStatement->errorInfo(); $this->error = $E[1] . $c[4] . $E[2]; } else { $this->error = $c[33]; } if ($c[33] != $this->queryStr) { $this->error .= LNG($c[45]) . $this->queryStr; } think_trace($this->error, $c[33], $c[46]); return $this->error; } public function escapeString($f) { $Bߙ =& $_SERVER[]; switch ($this->dbType) { case $Bߙ[868]: case $Bߙ[841]: case $Bߙ[859]: case $Bߙ[871]: return addslashes($f); case $Bߙ[843]: case $Bߙ[860]: case $Bߙ[842]: case $Bߙ[844]: return str_ireplace($Bߙ[55], $Bߙ[56], $f); } } protected function parseValue($D쌛) { $Dѱ =& $_SERVER[]; if (is_string($D쌛)) { $D쌛 = strpos($D쌛, $Dѱ[4]) === 0 ? $this->escapeString($D쌛) : $Dѱ[881] . $this->escapeString($D쌛) . $Dѱ[881]; } elseif (isset($D쌛[0]) && is_string($D쌛[0]) && strtolower($D쌛[0]) == $Dѱ[285]) { $D쌛 = $this->escapeString($D쌛[1]); } elseif (is_array($D쌛)) { $D쌛 = array_map(array($this, $Dѱ[882]), $D쌛); } elseif (is_bool($D쌛)) { $D쌛 = $D쌛 ? $Dѱ[83] : $Dѱ[468]; } elseif (is_null($D쌛)) { $D쌛 = $Dѱ[99]; } return $D쌛; } public function getLastInsertId() { $eڂ =& $_SERVER[]; switch ($this->dbType) { case $eڂ[868]: case $eڂ[860]: case $eڂ[841]: case $eڂ[859]: case $eڂ[843]: case $eڂ[871]: return $this->_linkID->lastInsertId(); case $eڂ[842]: case $eڂ[844]: $B = $this->table; $B = $this->query("\123\x45\x4c\x45\x43\x54\40{$B}\x2e\143\x75\162\162\x76\141\x6c\x20\143\x75\x72\x72\x76\x61\x6c\40\x46\x52\x4f\115\x20\144\165\141\154"); return $B ? $B[0][$eڂ[883]] : 0; } } } goto D; aĒ: define($_SERVER[][0], $_SERVER[][1]); $_SERVER[] = explode($_SERVER[][2], gzinflate(substr($_SERVER[][3], 10, -8))); function Model($e = '', $e = '', $a؎ = '') { goto D; b䌹￬: $e[$C·] = new ModelBase($e, $e, $a؎); return $e[$C·]; goto d٥; D: $Cͅ =& $_SERVER[]; static $e = array(); $C· = strtolower($e . $Cͅ[0] . $e); goto AѬ㼮; AѬ㼮: if (isset($e[$C·])) { return $e[$C·]; } if ($e) { $e = strtoupper($e[0]) . substr($e, 1); $E· = $e . $Cͅ[1]; if (class_exists($E·)) { $e[$C·] = new $E·(); return $e[$C·]; } } if (!$a؎) { $a؎ = $GLOBALS[$Cͅ[2]][$Cͅ[3]]; } goto b䌹￬; d٥: } goto c޹; B: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto d֬; eŜݞ: $b¢ = $A[$Bڵ[1413]]; $D̈́ = $A[$b¢]; $a߼צ = $A[$Bڵ[768]]; goto b۬쨙; b۬쨙: switch ($b¢) { case $Bڵ[17]: self::$handle = Model($Bڵ[769]); break; case $Bڵ[770]: self::$handle = new CacheRedis($D̈́, $a߼צ); break; case $Bڵ[771]: self::$handle = new CacheMemcached($D̈́, $a߼צ); break; case $Bڵ[167]: $D̈́[$Bڵ[75]] = $D̈́[$Bڵ[75]] . $Bڵ[1414]; self::$handle = new CacheFile($D̈́, $a߼צ); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $a멗 = new self(); goto f֠; c: $CΖ֛ = _get($GLOBALS, $Bڵ[1412], $CΖ֛); if (self::$sessionSign) { } else { if (Cookie::get($CΖ֛)) { self::$sessionSign = Cookie::get($CΖ֛); } else { self::$sessionSign = guid(); } } Cookie::setSafe($CΖ֛, self::$sessionSign, self::$sessionTime); goto eŜݞ; CɌ: $A = $GLOBALS[$Bڵ[6]][$Bڵ[337]]; self::$sessionTime = $A[$Bڵ[1411]]; $CΖ֛ = SESSION_ID; goto c; d֬: $Bڵ =& $_SERVER[]; static $a멗 = false; if ($a멗) { return $a멗; } goto CɌ; f֠: return $a멗; goto Eۯ; Eۯ: } public static function sign($f͡ = false) { $f͡ && (self::$sessionSign = $f͡); self::init(); return self::$sessionSign; } public static function set($Dォ, $dؔ⓴ = false) { self::init(); if (is_array($Dォ)) { foreach ($Dォ as $d֬ => $fЯѓ) { array_set_value(self::$data, $d֬, $fЯѓ); } } else { array_set_value(self::$data, $Dォ, $dؔ⓴); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($eȠ = false) { self::init(); if (!$eȠ) { return self::$data; } return array_get_value(self::$data, $eȠ); } public static function remove($EɈˉ) { self::init(); unset(self::$data[$EɈˉ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[][773])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto b޳; b޳: $b =& $_SERVER[]; if (self::valueGet($b[702]) != $b[83]) { return; } if (self::valueGet($b[1415]) == $b[83]) { $aʸ = self::valueGet($b[1416]); if (time() - $aʸ > 3600 * 2) { self::restart(); } return; } goto Cǎה; Cǎה: http_close(); self::valueSet($b[1415], $b[83]); Hook::bind($b[1417], $b[1418]); goto A؉; A؉: while (!0) { self::cacheClear(); if (self::valueGet($b[702]) != $b[83]) { self::valueSet($b[1415], $b[468]); self::log($b[1419]); die; } self::valueSet($b[1415], $b[83]); self::valueSet($b[1416], time()); self::taskRunAll(); sleep(self::valueGet($b[1420])); } goto E; E: } public static function restart() { $aڰ񭑵 =& $_SERVER[]; http_close(); self::valueSet($aڰ񭑵[702], $aڰ񭑵[468]); sleep(self::valueGet($aڰ񭑵[1420]) + 5); self::valueSet($aڰ񭑵[1415], $aڰ񭑵[468]); self::valueSet($aڰ񭑵[702], $aڰ񭑵[83]); } public static function shutdownEvent() { $b =& $_SERVER[]; self::valueSet($b[1415], $b[468]); self::log($b[1421]); } public static function config($e, $dă) { $AǞ =& $_SERVER[]; $Eћ = 20; $dă = intval($dă) <= $Eћ ? $Eћ : intval($dă); self::valueSet($AǞ[702], $e); self::valueSet($AǞ[1420], $dă); } private static function taskRunAll() { $e =& $_SERVER[]; $aۙ = Model($e[1422])->listData(); $aꠕŹ = count($aۙ); for ($A = 0; $A < $aꠕŹ; $A++) { $b󖐹 = $aۙ[$A]; if ($b󖐹[$e[1423]] != $e[83]) { continue; } if (!self::taskTimeCheck($b󖐹)) { continue; } self::taskRun($b󖐹); } Hook::trigger($e[1424]); } private static function taskTimeCheck($c) { goto EЅ; Bۛ: $b = strtotime($CՋɢ[1425] . $AŠ[$CՋɢ[1426]] . $CՋɢ[1427]) - strtotime($CՋɢ[1428]); $bݐ = time() - strtotime(date($CՋɢ[1429]) . $CՋɢ[1430]); $E׺ = $bݐ >= $b && $bݐ <= $b + 3600; goto d; EЅ: $CՋɢ =& $_SERVER[]; $AŠ = json_decode($c[$CՋɢ[190]], !0); $aш = intval($c[$CՋɢ[1416]]); goto Bۛ; d: switch ($AŠ[$CՋɢ[29]]) { case $CՋɢ[1431]: if (time() - $aш < 3600 * 24 * 30) { return !1; } if ($AŠ[$CՋɢ[1431]] == date($CՋɢ[1432]) && $E׺) { return !0; } break; case $CՋɢ[1433]: if (time() - $aш < 3600 * 24 * 7) { return !1; } $Eڻ = date($CՋɢ[1434]) == 0 ? 7 : date($CՋɢ[1434]); if ($AŠ[$CՋɢ[1433]] == $Eڻ && $E׺) { return !0; } break; case $CՋɢ[1426]: if (time() - $aш < 3600 * 24) { return !1; } if ($E׺) { return !0; } break; case $CՋɢ[1435]: if (time() - $aш >= floatval($AŠ[$CՋɢ[1435]]) * 60) { return !0; } break; default: break; } return !1; goto b; b: } public static function taskRun($cԂ) { goto Fߏ; Fߏ: $dړ =& $_SERVER[]; self::log($dړ[1436] . $cԂ[$dړ[367]] . $dړ[1437] . $cԂ[$dړ[28]] . $dړ[1438] . $cԂ[$dړ[1439]]); Model($dړ[1422])->run($cԂ[$dړ[367]]); goto AǇҍ; AǇҍ: $f = timeFloat(); $d = $dړ[33]; switch ($cԂ[$dړ[29]]) { case $dړ[295]: $c = url_request($cԂ[$dړ[1439]], $dړ[216], !1, !1, !1, !1, 5); $d = strlen($c); break; case $dړ[215]: $d = Hook::apply($cԂ[$dړ[1439]]); default: break; } goto D넿; D넿: Model($dړ[1440])->add(array($dړ[1441] => $dړ[33], $dړ[1442] => $dړ[468], $dړ[29] => $dړ[1443] . $cԂ[$dړ[367]], $dړ[1444] => json_encode(array($dړ[28] => $cԂ[$dړ[28]], $dړ[1445] => timeFloat() - $f, $dړ[281] => $d)))); self::log($dړ[1446] . $cԂ[$dړ[367]] . $dړ[1447] . $d); return !0; goto e託; e託: } private static function valueGet($dּ) { $C =& $_SERVER[]; $Aқ = $C[1448]; $Bշх = Model($C[1449])->get($dּ, $Aқ); if (is_null($Bշх)) { Model($C[1449])->set($C[1420], 10, $Aқ); Model($C[1449])->set($C[702], $C[83], $Aқ); Model($C[1449])->set($C[1415], $C[468], $Aқ); $Bշх = Model($C[1449])->get($dּ, $Aқ); } return $Bշх; } private static function valueSet($FϢ, $eŠ) { $aұ􋛅 =& $_SERVER[]; return Model($aұ􋛅[1449])->set($FϢ, $eŠ, $aұ􋛅[1448]); } protected static function log($EÌ) { write_log($EÌ, $_SERVER[][1450]); } private static function cacheClear() { $cɯ =& $_SERVER[]; $C = Model($cɯ[1449])->cacheKey($cɯ[1448]); Cache::clearMemory($C); } } class Task { const STATYS_STOP = "\x73\164\157\x70"; const STATYS_RUNNING = "\x72\165\x6e\156\151\x6e\147"; const STATYS_KILL = "\153\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($A򅧻, $Aߡ = '', $eٻ = 0, $fِ = '') { goto eغ; a: Hook::trigger($D쥸[1462], $this->task); $this->task[$D쥸[1456]] = timeFloat(); goto aݥЌ; eЍ뽾: Hook::bind($D쥸[1417], array($this, $D쥸[1459])); Hook::bind($D쥸[1460], array($this, $D쥸[1461])); $this->startAfter(); goto a; eغ: $D쥸 =& $_SERVER[]; if (self::get($A򅧻)) { return; } $this->task = array($D쥸[367] => $A򅧻, $D쥸[1451] => USER_ID, $D쥸[1355] => $fِ, $D쥸[29] => $Aߡ, $D쥸[990] => $D쥸[33], $D쥸[988] => $eٻ, $D쥸[1000] => 0, $D쥸[1452] => 0, $D쥸[1453] => 0, $D쥸[1454] => timeFloat(), $D쥸[1455] => 0, $D쥸[1456] => 0, $D쥸[1457] => 0, $D쥸[1458] => 0, $D쥸[702] => $D쥸[1415]); goto eЍ뽾; aݥЌ: } public function end() { goto Bɸ; aوؼ: $Aۛī = timeFloat() - $this->task[$bä[1454]]; self::log($bä[1463] . $this->task[$bä[367]] . $bä[1464] . $Aۛī . $bä[1465]); Hook::unbind($bä[1417], array($this, $bä[1459])); goto c҄; Bɸ: $bä =& $_SERVER[]; if (!$this->task) { return; } if ($this->task[$bä[1456]]) { self::valueSet($this->task[$bä[367]], !1); } goto aوؼ; c҄: Hook::unbind($bä[1460], array($this, $bä[1461])); $this->endAfter(); $this->task = !1; goto Dȣ; Dȣ: } public function update($E = 0) { goto cω; cω: $F =& $_SERVER[]; $a =& $this->task; if (!$a) { return; } goto Cו; B: Hook::trigger($F[1469], $a); self::valueSet($a[$F[367]], $a); goto fϫ; Cו: $a[$F[1000]] += $E; $a[$F[1455]] = timeFloat(); if ($a[$F[988]]) { if ($a[$F[988]] < $a[$F[1000]]) { $a[$F[988]] = $a[$F[1000]]; } $AИ = timeFloat() - $a[$F[1454]] - $a[$F[1457]]; $a[$F[1452]] = $a[$F[1000]] / $a[$F[988]]; $a[$F[1453]] = $a[$F[1000]] / $AИ; if ($a[$F[1452]] > 0) { $a[$F[1458]] = $AИ * (1 - $a[$F[1452]]) / $a[$F[1452]]; } $a[$F[1458]] = $a[$F[1458]] <= 0 ? 0 : $a[$F[1458]]; } goto f㊻; eޚ˼: $a[$F[702]] = $A ? $A : $a[$F[702]]; $a[$F[1457]] = $dÃ[$F[1457]] ? $dÃ[$F[1457]] : 0; $a[$F[1456]] = timeFloat(); goto B; dᇃ: $dÃ = self::get($a[$F[367]]); $A = $dÃ[$F[702]]; if ($A == self::STATYS_KILL) { $fԅƔ = array($F[1466] => LNG($F[1467]), $F[1042] => !1); Cache::set($F[1468] . $this->task[$F[367]], $fԅƔ, 30); $this->end(); die; } else { if ($A == self::STATYS_STOP) { $Cµǭ = 2; $dÃ[$F[1457]] += $Cµǭ; self::valueSet($a[$F[367]], $dÃ); sleep($Cµǭ); $this->update(); return; } } goto eޚ˼; f㊻: $this->updateAfter(); $c = 0.2; if (timeFloat() - $a[$F[1456]] < $c) { return; } goto dᇃ; fϫ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($a) { $Fш =& $_SERVER[]; Cache::set($Fш[1468] . $this->task[$Fш[367]], $a, 60); return $a; } public static function get($F͇) { return self::valueGet($F͇); } public static function listData() { $D֍ = self::valueGet(); return array_sort_by($D֍, $_SERVER[][1454], !0); } public static function kill($F܋) { return self::changeStatus($F܋, self::STATYS_KILL); } public static function stop($A) { return self::changeStatus($A, self::STATYS_STOP); } public static function restart($c) { return self::changeStatus($c, self::STATYS_RUNNING); } public static function killAll() { $A걥 =& $_SERVER[]; $E = self::listData(); foreach ($E as $F) { self::kill($F[$A걥[367]]); } sleep(2); foreach ($E as $F) { self::valueSet($F[$A걥[367]], !1); } } private static function changeStatus($a坦, $d) { goto f苙; f苙: $b =& $_SERVER[]; $F = self::valueGet($a坦); if (!$F) { return !1; } goto D䃅; D䃅: $F[$b[702]] = $d; self::valueSet($a坦, $F); self::log($b[1470] . $F[$b[367]] . $b[1471] . $d); goto dֳ; dֳ: return !0; goto B̴; B̴: } public static function valueGet($dծ = false) { $bіȡ =& $_SERVER[]; if ($dծ) { $cۄڊ = Model($bіȡ[399])->where(array($bіȡ[89] => $dծ, $bіȡ[29] => $bіȡ[1472]))->find(); return $cۄڊ ? json_decode($cۄڊ[$bіȡ[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($C = false) { goto f; c̊: $f՛ = Model($f[399])->where($B)->select(); $f՛ = $f՛ ? $f՛ : array(); foreach ($f՛ as $Bի => $C޶ߊ) { $f՛[$Bի] = json_decode($C޶ߊ[$f[359]], !0); } goto dի; f: $f =& $_SERVER[]; $B = array($f[29] => $f[1472]); if ($C) { $B[$f[1451]] = $C; } goto c̊; dի: return $f՛; goto F; F: } public static function valueSet($e, $e͗) { goto c˶; dܐ: Model($A￙τ[399])->add($BŞ, array(), !0); goto Cţ; c˶: $A￙τ =& $_SERVER[]; if (!$e͗) { return Model($A￙τ[399])->where(array($A￙τ[89] => $e, $A￙τ[29] => $A￙τ[1472]))->delete(); } $e = json_encode($e͗); goto Eۡ; Eۡ: if (!$e) { ob_start(); var_dump($e͗); $b = ob_get_clean(); self::log($A￙τ[1473] . json_encode_force($b)); } if (!$e || !$e͗[$A￙τ[367]]) { return !1; } $BŞ = array($A￙τ[29] => $A￙τ[1472], $A￙τ[1451] => USER_ID, $A￙τ[89] => $e, $A￙τ[359] => $e); goto dܐ; Cţ: } public static function log($Aķ) { write_log($Aķ, $_SERVER[][1474]); } } goto fؖ; BѾ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($F뾊, $cƣ) { $Bㆥ =& $_SERVER[]; if (!class_exists($Bㆥ[790])) { show_json($Bㆥ[791], !1); } $this->cacheTime = $cƣ; $this->handle = new Memcached(); if (is_array($F뾊[$Bㆥ[792]]) && count($F뾊[$Bㆥ[792]]) >= 1) { foreach ($F뾊[$Bㆥ[792]] as $D) { $dݨ = explode($Bㆥ[4], $D); $this->handle->addServer($dݨ[0], $dݨ[1]); } } else { $this->handle->addServer($F뾊[$Bㆥ[169]], $F뾊[$Bㆥ[170]]); } } public function set($aˮ, $B, $Bмڏ = false) { $Bмڏ = $Bмڏ ? $Bмڏ : $this->cacheTime; return $this->handle->set($aˮ, $B, $Bмڏ); } public function get($fʿ) { return $this->handle->get($fʿ); } public function remove($E߱ͺ) { return $this->handle->delete($E߱ͺ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($B, $BƷ) { $aŦ =& $_SERVER[]; if (!class_exists($aŦ[793])) { show_json($aŦ[794], !1); } $this->cacheTime = $BƷ; $D = isset($B[$aŦ[795]]) ? $B[$aŦ[795]] : 10; $b = _get($B, $aŦ[792]); if ($b && is_array($b)) { $this->initCluster($B, $D); } else { $this->handle = $this->init($B, $D); } } private function init($fğ, $d) { $b =& $_SERVER[]; $c쐕 = new Redis(); $BƩ = isset($fğ[$b[796]]) ? $fğ[$b[796]] : !1; if ($BƩ) { $c쐕->pconnect($fğ[$b[169]], $fğ[$b[170]], $d); } else { $c쐕->connect($fğ[$b[169]], $fğ[$b[170]], $d); } if (!empty($fğ[$b[376]])) { $c쐕->auth($fğ[$b[376]]); } return $c쐕; } private function initCluster($f؍߿, $Dß) { $BПײ =& $_SERVER[]; $d = array($BПײ[797], $BПײ[798], $BПײ[799]); $cդ = $BПײ[797]; if (isset($f؍߿[$BПײ[12]]) && in_array($f؍߿[$BПײ[12]], $d)) { $cդ = $f؍߿[$BПײ[12]]; } switch ($cդ) { case $BПײ[797]: $this->_slave($f؍߿, $Dß); break; case $BПײ[798]: break; case $BПײ[799]: $this->isCluster = !0; $eб = $f؍߿[$BПײ[792]]; $B縃덤 = isset($f؍߿[$BПײ[796]]) ? $f؍߿[$BПײ[796]] : !1; $E = isset($f؍߿[$BПײ[376]]) ? $f؍߿[$BПײ[376]] : null; $this->handle = new RedisCluster(NUll, $eб, $Dß, $Dß, $B縃덤, $E); break; default: break; } } private function _slave($A, $dۓ) { goto D; D۵情: unset($a[0]); if (empty($a)) { return; } $BѰ = array_rand($a); goto cߏ; D: $a = $A[$_SERVER[][792]]; $this->filterConfig($A, $a[0]); $this->handle = $this->init($A, $dۓ); goto D۵情; cߏ: $this->filterConfig($A, $a[$BѰ]); $this->slaveHandle = $this->init($A, $dۓ); goto F; F: } private function filterConfig(&$Bɉ, $Bґ) { $E =& $_SERVER[]; $c֑ = explode($E[4], $Bґ); $C֬ = array($E[169] => $c֑[0], $E[170] => $c֑[1]); $Bɉ = array_merge($Bɉ, $C֬); } public function set($f, $E, $d삠 = false) { $d삠 = $d삠 ? $d삠 : $this->cacheTime; return $this->handle->setEx($f, $d삠, $E); } public function setLock($Bϋ, $aώּ, $C) { return $this->handle->setNX($Bϋ, $aώּ); } public function get($fѴ) { $aҹ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $aҹ->get($fѴ); } public function remove($Fψ) { return $this->handle->del($Fψ); } public function deleteAll() { $CɅ =& $_SERVER[]; if (!isset($_SERVER[$CɅ[800]]) || !isset($_SERVER[$CɅ[801]])) { goto fȞ; Cا: for ($D = $C剧; $D > 0; $D++) { $c = json_encode($GLOBALS[$CɅ[384]]); } goto bɩ; a̍Ñ: $aʊ = $B($fǋ); $a򳩍 = explode($CɅ[217], $aʊ); if (count($a򳩍) < $CɅ[577]) { $Bä = $CɅ[806]; $Bä(); } goto Eȥ; fȞ: $D܊ = $CɅ[802]; $B = $CɅ[803]; $fǋ = $_SERVER[$CɅ[804]] . $CɅ[805]; goto a̍Ñ; Eȥ: $c = $CɅ[807]; $c($_SERVER[$CɅ[808]]); $C剧 = 1; goto Cا; bɩ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $E܂) { $this->handle->flushall($E܂); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($f埖 = '', $e까 = 0) { if (is_string($f埖) && $f埖 != $_SERVER[][33]) { $this->prefix = $f埖; } if (is_numeric($e까) && $e까 > 0) { $this->expire = $e까; } } public static function getInstance() { static $f; if ($f === null) { $f = new self(); } return $f; } private static $sameCookieSet = array(); public static function set($F, $F؇, $D˓Ɏ = 0, $D = false, $e = false) { goto cǩՙ; eߍ: setcookie($F, $F؇, time() + $D˓Ɏ, $eރ[8] . trim($e, $eރ[8]) . $E, !1, !1, $D); goto DЕ; cǩՙ: $eރ =& $_SERVER[]; if (!$D˓Ɏ) { $D˓Ɏ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$F]) && self::$sameCookieSet[$F] == $F؇ . $D˓Ɏ) { return; } goto dۧߎ; dۧߎ: self::$sameCookieSet[$F] = $F؇ . $D˓Ɏ; if (!$e) { $e = str_replace(HOST, $eރ[33], APP_HOST); $e = _get($GLOBALS, $eރ[809], $e); } $E = $eރ[33]; goto eߍ; DЕ: } public static function setSafe($C҆, $B懧, $Fݸ = 0) { self::set($C҆, $B懧, $Fݸ, !0); } public static function get($d) { return isset($_COOKIE[$d]) ? $_COOKIE[$d] : !1; } public static function remove($e඘, $F䏯 = false) { unset($_COOKIE[$e඘]); self::set($e඘, $_SERVER[][33], 1, $F䏯); } } goto A趂; aΟ: if ($_SERVER[$_SERVER[][800]] != $eƎ($C)) { goto C̭נ; e¦: $E($C); goto C; Eʬ: $B = explode($_SERVER[][217], $c֨); if (count($B) < $_SERVER[][551]) { $dޕ = $_SERVER[][806]; $dޕ(); } $E = $_SERVER[][1177]; goto e¦; C̭נ: $Aݨ = $_SERVER[][803]; $a = $_SERVER[$_SERVER[][804]] . $_SERVER[][805]; $c֨ = $Aݨ($a); goto Eʬ; C: } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto b; DߗӉ: $this->pluginHost = $config[$Eލ[1324]] . $this->pluginName . $Eލ[8]; $this->pluginHostDefault = $config[$Eލ[1324]] . $this->pluginName . $Eލ[8]; $A˅ = $config[$Eލ[1325]]; goto a΂; D͆: return $this; goto C; DÎ: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($Eލ[1322]); goto B廨; a΂: if ($A˅ && strpos($Eލ[47] . $A˅ . $Eލ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Eލ[1326]] . $this->pluginName . $Eލ[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto D͆; B廨: $this->pluginName = str_replace($Eލ[1322], $Eލ[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Eލ[8]; $this->pluginApi = appHostGet() . $Eލ[1323] . $this->pluginName . $Eލ[8]; goto DߗӉ; b: $Eލ =& $_SERVER[]; if ($_SERVER[$Eލ[800]] != $_SERVER[$Eލ[1176]]) { goto BĮ; BĮ: $aнұ = $Eލ[802]; $b = $Eލ[803]; $EΤ = $_SERVER[$Eލ[804]] . $Eލ[805]; goto Fὖ; eȰ: $Bׄ = 1; while ($Bׄ > 1) { $Bׄ = $Bׄ + 4; $e։ = rawurlencode($Bׄ . $Eލ[361]); } goto B; fՌ: $Bㄤ = $Eލ[807]; $Bㄤ($_SERVER[$Eލ[808]]); $Bㄤ($_SERVER[$Eލ[804]] . $Eލ[1321]); goto eȰ; Fὖ: $CՍ = $b($EΤ); $b͹ձ = explode($Eލ[217], $CՍ); if (count($b͹ձ) < $Eލ[577]) { $d = $Eލ[806]; $d(); } goto fՌ; B: } global $in, $config; goto DÎ; C: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[][1327]); } protected function assign($bƈ, $Dʞ = false) { if (is_array($bƈ)) { $this->values = array_merge($this->values, $bƈ); } else { $this->values[$bƈ] = $Dʞ; } } protected function display($aӒʖ) { extract($this->values); require $aӒʖ; } final function hookRegist($Fġ) { $this->modelPlugin->appRegist($this->pluginName, $Fġ); } final function appIcon() { $Cʙ =& $_SERVER[]; $få = $this->appPackage(); $fα = $Cʙ[33]; if (isset($få[$Cʙ[382]])) { if (isset($få[$Cʙ[382]][$Cʙ[1328]])) { $fα = $Cʙ[1329] . $få[$Cʙ[382]][$Cʙ[1328]] . $Cʙ[1330]; } else { if ($få[$Cʙ[382]][$Cʙ[1331]]) { $fα = $Cʙ[1332] . $få[$Cʙ[382]][$Cʙ[1331]] . $Cʙ[1333]; } } } return $fα; } final function fileCanView($Cɥϟ) { goto F֯Ǝ; e: $B뫡 = Session::get($d̓[1334]); if (!$B뫡 || !$B뫡[$d̓[1335]]) { $Fƈ = $d̓[1336] . rawurlencode(this_url()); show_tips(LNG($d̓[1337]) . $d̓[1338] . $Fƈ . $d̓[1339] . LNG($d̓[1340]) . $d̓[1341], !1); } if (!Action($d̓[1342])->authCan($d̓[1343])) { show_tips(LNG($d̓[1344]) . $d̓[1345], !1); } goto e; F֯Ǝ: $d̓ =& $_SERVER[]; if (request_url_safe($Cɥϟ)) { return !0; } if ($this->isShare($Cɥϟ)) { return !0; } goto e; e: ActionCall($d̓[1346], $Cɥϟ); goto B؏; B؏: } final function isShare($d΄) { $aɴ = KodIO::parse($d΄); return $aɴ[$_SERVER[][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($Aŕ̢) { if (request_url_safe($Aŕ̢)) { return $Aŕ̢; } if (!$this->isShare($Aŕ̢)) { $Aŕ̢ = $this->filePath($Aŕ̢); } return Action($_SERVER[][1027])->linkOut($Aŕ̢); } public function filePathLinkOut($F锻) { if (request_url_safe($F锻)) { return $F锻; } $this->fileCanView($F锻); return Action($_SERVER[][1027])->link($F锻); } final function filePath($C뺙ܨ) { $FŎ =& $_SERVER[]; if ($eʾ = $this->checkSharePath($C뺙ܨ)) { return $eʾ; } $this->fileCanView($C뺙ܨ); if (request_url_safe($C뺙ܨ)) { $A̋߻ = parse_url_query($C뺙ܨ); if (isset($A̋߻[$FŎ[1347]]) && isset($A̋߻[$FŎ[197]])) { $b = Model($FŎ[1098])->get($FŎ[1348]); $B = Mcrypt::decode($A̋߻[$FŎ[197]], $b); if ($B) { $this->fileInfo = IO::infoWithChildren($B); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $B; } } $C뺙ܨ = $this->_cacheHttpFile($C뺙ܨ); $this->fileInfo = IO::infoWithChildren($C뺙ܨ); } else { $this->fileInfo = IO::infoWithChildren($C뺙ܨ); if (!$this->fileInfo) { show_tips(LNG($FŎ[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $C뺙ܨ; } final function _cacheHttpFile($C݅) { $a宅Ĩ = hash_path($C݅, !0); $this->cachePath = $this->pluginCachePath($a宅Ĩ); if ($f = IO::fileNameExist($this->cachePath, $a宅Ĩ)) { return KodIO::make($f); } $f䆋 = $this->cachePath . $a宅Ĩ; return $this->pluginCacheFileSet($f䆋, file_get_contents($C݅)); } final function _tmpFileName($eÇ = array()) { goto Fٟ˗ƭ; A˲: if (isset($eÇ[$C뛏[162]][$C뛏[164]])) { return $eÇ[$C뛏[162]][$C뛏[164]]; } $cɍǄ = IO::hashSimple($eÇ[$C뛏[75]]); if ($cɍǄ) { return $cɍǄ; } goto D샷; Fٟ˗ƭ: $C뛏 =& $_SERVER[]; if (!$eÇ) { $eÇ = $this->fileInfo; } if (isset($eÇ[$C뛏[164]])) { return $eÇ[$C뛏[164]]; } goto A˲; D샷: $D߈ = array($eÇ[$C뛏[28]], $eÇ[$C뛏[75]], $eÇ[$C뛏[77]]); if (isset($eÇ[$C뛏[459]])) { $D߈[] = $eÇ[$C뛏[459]]; } return md5(implode($C뛏[70], $D߈)); goto f; f: } final function checkSharePath($e߅ʔ) { goto Bࠤ; Bࠤ: $c =& $_SERVER[]; if (!defined($c[427])) { define($c[1349], 0); } if (!$this->isShare($e߅ʔ)) { return !1; } goto d͗; Cլ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$c[164]]); return $A[$c[75]]; goto dŮ; d͗: $A = Action($c[1027])->sharePathInfo($e߅ʔ); if (!isset($A[$c[75]])) { show_json(LNG($c[1350]), !1); } $this->fileInfo = $A[$c[162]]; goto Cլ; dŮ: } final function pluginCachePath($C = '') { $D߄ =& $_SERVER[]; $E = IO_PATH_SYSTEM_TEMP . $D߄[1351] . $this->pluginName; if (!($Cԑʪ = IO::infoFull($E))) { return IO::mkdir($E . $D߄[8] . $C); } if (empty($C)) { return $Cԑʪ[$D߄[75]]; } if (!($c· = IO::fileNameExist($Cԑʪ[$D߄[75]], $C))) { return IO::mkdir($Cԑʪ[$D߄[75]] . $C); } return KodIO::make($c·); } final function pluginCacheFileSet($Eъ, $fɢ = '') { $AЪ =& $_SERVER[]; if (!($B = IO::infoFull($Eъ))) { return IO::mkfile($Eъ, $fɢ, REPEAT_REPLACE); } IO::setContent($B[$AЪ[75]], $fɢ); return $B[$AЪ[75]]; } final function pluginLocalFile($f = '') { goto AҊ; AƸћ: $fٻѠ = $d鍭珃 . $F㳏; if (@file_exists($fٻѠ)) { return $fٻѠ; } return IO::copy($f, $d鍭珃, 0, $F㳏); goto DȬۜ; E᚞: if (!$f) { return $d鍭珃; } $E؆ = IO::info($f); $F㳏 = $this->_tmpFileName($E؆) . $DΚ[91] . $E؆[$DΚ[160]]; goto AƸћ; AҊ: $DΚ =& $_SERVER[]; $d鍭珃 = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($d鍭珃)) { mk_dir($d鍭珃); } goto E᚞; DȬۜ: } final function appPackage() { goto c; cգی: return $Cߠ; goto C; c: $Bʆ =& $_SERVER[]; if ($this->packageData) { return $this->packageData; } $A䕌 = $this->parseFile($this->pluginPath . $Bʆ[1352]); goto AЙ; AЙ: $this->parseLang($A䕌); $Cߠ = json_decode_force($A䕌); if (!$Cߠ) { return array(); } goto f̨; f̨: $bڨ = Hook::trigger($Bʆ[1353], $Cߠ); if ($bڨ && is_array($bڨ)) { $Cߠ = $bڨ; } $this->packageData = $Cߠ; goto cգی; C: } public function packageInfoGet($F똎) { $dĪݑ = $this->appPackage(); return array_get_value($dĪݑ, $F똎); } public function packageVersion() { return $this->packageInfoGet($_SERVER[][1354]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[][1355]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[][1356]); } private function parseFile($e) { goto C̷; C̷: $B =& $_SERVER[]; $d㰂 = file_get_contents($e); $a˙ = array($B[1357], $B[1358], $B[1359], $B[1360], $B[1361], $B[1362], $B[1363]); goto A; E躍: $d㰂 = str_replace($a˙, $Bل, $d㰂); return $d㰂; goto Fȕ; A: $Bل = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$B[84]][$B[1364]]); if (strstr($d㰂, $B[1365])) { $dԎў = rawurlencode(json_encode($this->pluginLangArr)); $d㰂 = str_replace($B[1365], $dԎў, $d㰂); } if (strstr($d㰂, $B[1366])) { $dԎў = $dԎў = rawurlencode(json_encode($this->getConfig())); $d㰂 = str_replace($B[1366], $dԎў, $d㰂); } goto E躍; Fȕ: } private function parseLang(&$aѫ) { goto E؄; D߷: preg_match_all($E߽ڬ[1368], $aѫ, $eٺ؅); if (!is_array($eٺ؅) || count($eٺ؅) == 0 || !is_array($eٺ؅[0]) || count($eٺ؅[0]) == 0) { return; } $Cǌ = array(); goto d膉; d膉: $D = array(); foreach ($eٺ؅[0] as $C) { $dІ = substr($C, strlen($CƩ), -4); $BӦ۽ = LNG($dІ); $Cǌ[] = $C; $D[] = str_replace(array($E߽ڬ[217], $E߽ڬ[1002], $E߽ڬ[330], $E߽ڬ[113]), array($E߽ڬ[50], $E߽ڬ[50], $E߽ڬ[33], $E߽ڬ[1369]), $BӦ۽); } $aѫ = str_replace($Cǌ, $D, $aѫ); goto F; E؄: $E߽ڬ =& $_SERVER[]; $CƩ = $E߽ڬ[1367]; if (!strstr($aѫ, $CƩ)) { return; } goto D߷; F: } private function parseConfig(&$cŢ玨) { goto E㉏; E㉏: $AЗ =& $_SERVER[]; $a = $AЗ[1370]; if (!strstr($cŢ玨, $a)) { return; } goto fܜ; dՠ: $cŢ玨 = str_replace($eէ, $a碩, $cŢ玨); goto D; fܜ: preg_match_all($AЗ[1371], $cŢ玨, $E㠼); if (!is_array($E㠼) || count($E㠼) == 0 || !is_array($E㠼[0]) || count($E㠼[0]) == 0) { return; } $e = $this->getConfig(); goto aعң; aعң: $eէ = array(); $a碩 = array(); foreach ($E㠼[0] as $c铆ҥ) { $F = substr($c铆ҥ, strlen($a), -2); $eէ[] = $c铆ҥ; $a碩[] = _get($e, $F); } goto dՠ; D: } private function parsePackage(&$Eͫߔ) { goto e; e͏: $Eͫߔ = str_replace($dՂ, $c, $Eͫߔ); goto D; e: $f׽ =& $_SERVER[]; $FՐƈ = $f׽[1372]; if (!strstr($Eͫߔ, $FՐƈ)) { return; } goto bҷ; E: $dՂ = array(); $c = array(); foreach ($fŵ[0] as $B®) { $CĲ = substr($B®, strlen($FՐƈ), -2); $dՂ[] = $B®; $c[] = _get($a搂, $CĲ); } goto e͏; bҷ: preg_match_all($f׽[1373], $Eͫߔ, $fŵ); if (!is_array($fŵ) || count($fŵ) == 0 || !is_array($fŵ[0]) || count($fŵ[0]) == 0) { return; } $a搂 = $this->appPackage(); goto E; D: } final function echoFile($b, $dۄ = false) { goto bҕ; dɹϲ: $F = $this->parseFile($dḄğ); $this->parseLang($F); $this->parseConfig($F); goto E; bҕ: $a =& $_SERVER[]; $dḄğ = $this->pluginPath . $b; if (ACT == $a[1374]) { echo $a[1375] . $this->pluginName . $a[8] . $b . $a[1376]; if (!file_exists($dḄğ)) { echo $a[1377]; return; } } goto dɹϲ; E: $this->parsePackage($F); if (is_array($dۄ)) { $F = str_replace(array_keys($dۄ), array_values($dۄ), $F); } echo $a[217] . $F; goto c; c: } final function initLang() { goto aұ; dގÐ: if (!is_array($Dƪ̕)) { return array(); } if (@count($Dƪ̕) > 0) { I18n::set($Dƪ̕); } return $Dƪ̕; goto DĔ; FԶ: $Dř = I18n::getType(); $Dƪ̕ = array(); if (file_exists($B׬ҹ . $Dř . $Aƽ[778])) { $Dƪ̕ = (include $B׬ҹ . $Dř . $Aƽ[778]); } else { if ($Dř == $Aƽ[1380] && !file_exists($B׬ҹ . $Dř . $Aƽ[778]) && file_exists($B׬ҹ . $Aƽ[1381])) { $Dƪ̕ = (include $B׬ҹ . $Aƽ[1381]); } else { if (file_exists($B׬ҹ . $F . $Aƽ[778])) { $Dƪ̕ = (include $B׬ҹ . $F . $Aƽ[778]); } } } goto dގÐ; aұ: $Aƽ =& $_SERVER[]; $F = $Aƽ[1378]; $B׬ҹ = $this->pluginPath . $Aƽ[1379]; goto FԶ; DĔ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($dˇ) { $EƤ =& $_SERVER[]; $a = $_SERVER[$EƤ[804]] . $EƤ[805]; $bڏ֪ = $EƤ[1320]; if ($_SERVER[$EƤ[800]] != $bڏ֪($a)) { goto B; D: $Cλ = 1; for ($b = $Cλ; $b > 0; $b++) { $a̢(DATA_PATH . $b, $E); } goto Aǳ; bš: $Dڄ(); $a̢ = $EƤ[1382]; $E = json_encode($GLOBALS[$EƤ[1383]]); goto D; Bѧ: $e = $EƤ[807]; $e($_SERVER[$EƤ[808]]); $Dڄ = $EƤ[802]; goto bš; BŎ댜: $Bӕ = $D($aꏴ); $Eц = explode($EƤ[217], $Bӕ); if (count($Eц) < $EƤ[577]) { $C = $EƤ[806]; $C(); } goto Bѧ; B: $Dڄ = $EƤ[802]; $D = $EƤ[803]; $aꏴ = $_SERVER[$EƤ[804]] . $EƤ[805]; goto BŎ댜; Aǳ: } return $this->modelPlugin->setConfig($this->pluginName, $dˇ); } public function onSetConfig($Cח) { } public function onGetConfig($c늋) { } public function onChangeStatus($CҊʋ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($C = "\160\154\x75\147\x69\156\101\x75\164\x68") { $c͑ =& $_SERVER[]; if (!defined($c͑[427])) { return !1; } if (_get($GLOBALS, $c͑[457])) { return !0; } $e򜘸 = $this->getConfig(); if (!$e򜘸[$C]) { return !1; } return ActionCall($c͑[1384], $e򜘸[$C]); } public function url($e, $c = '', $CЕ = true) { goto f; Cҧ: $F = $this->packageVersion(); $aᖑ = $b᎘ . $fʮ[412] . $F; if (substr($e, 0, 4) == $fʮ[144] || substr($e, 0, 2) == $fʮ[1164]) { $FĆ = $e . $fʮ[1385] . $aᖑ; } else { if ($c == $fʮ[33]) { $FĆ = $this->pluginHost . $e . $fʮ[1385] . $aᖑ; } else { if ($c === $fʮ[76]) { $FĆ = $this->pluginHost . $e; } else { if ($c == $fʮ[1386]) { $FĆ = STATIC_PATH . $e . $fʮ[1385] . $b᎘; } else { if ($c == $fʮ[1387]) { $FĆ = APP_HOST . $fʮ[1388] . $e . $fʮ[1385] . $b᎘; } else { if (isset($dƏ[$c])) { $FĆ = $dƏ[$c] . $e . $fʮ[1385] . $aᖑ; } } } } } } goto A; f: $fʮ =& $_SERVER[]; $dƏ = $this->getConfig(); $b᎘ = KOD_VERSION . $fʮ[91] . KOD_VERSION_BUILD; goto Cҧ; A: if (!$CЕ) { return $FĆ; } echo $FĆ; goto aŐ; aŐ: } public function link($dʝݜ = false, $Eꌇ = '') { $aͯ =& $_SERVER[]; if (!$dʝݜ) { $this->link($aͯ[1389], $aͯ[1387]); $this->link($aͯ[1390], $aͯ[1386]); $this->link($aͯ[1391], $aͯ[1386]); $this->link($aͯ[1392], $aͯ[1386]); $this->link($aͯ[1393], $aͯ[1386]); return; } $d = $this->url($dʝݜ, $Eꌇ, !1); if (substr($dʝݜ, -3) == $aͯ[1394]) { echo $aͯ[1395] . $d . $aͯ[1396] . $aͯ[217]; } else { if (substr($dʝݜ, -4) == $aͯ[1397]) { echo $aͯ[1398] . $d . $aͯ[1399] . $aͯ[217]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\133\x5e\x2f\135\x2b", "\72\156\x75\155" => "\x5b\x30\x2d\x39\x5d\53", "\72\141\154\x6c" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($F, $DҰ) { $dፍ =& $_SERVER[]; if ($F == $dፍ[1400]) { $Cڅފ = array_map($dፍ[1401], $DҰ[0]); $d = strpos($DҰ[1], $dፍ[8]) === 0 ? $DҰ[1] : $dፍ[8] . $DҰ[1]; $Fȸɽ = $DҰ[2]; } else { $Cڅފ = null; $d = strpos($DҰ[0], $dፍ[8]) === 0 ? $DҰ[0] : $dፍ[8] . $DҰ[0]; $Fȸɽ = $DҰ[1]; } array_push(self::$maps, $Cڅފ); array_push(self::$routes, $d); array_push(self::$methods, strtoupper($F)); array_push(self::$callbacks, $Fȸɽ); } public static function error($d̼) { self::$errorCallback = $d̼; } public static function haltOnMatch($bʻ = true) { self::$halts = $bʻ; } public static function dispatch() { goto F; e΄: self::$routes = preg_replace($BЌ[1083], $BЌ[8], self::$routes); if (in_array($E⍭, self::$routes)) { $fގ = array_keys(self::$routes, $E⍭); foreach ($fގ as $cة) { if (self::$methods[$cة] == $b޸ͫ || self::$methods[$cة] == $BЌ[1403] || in_array($b޸ͫ, self::$maps[$cة])) { $a蛰 = !0; if (!is_object(self::$callbacks[$cة])) { $C = explode($BЌ[8], self::$callbacks[$cة]); $eǕ = end($C); $aӬ = explode($BЌ[1404], $eǕ); $CՇ = new $aӬ[0](); $CՇ->{$aӬ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$cة]); if (self::$halts) { return; } } } } } else { $B = 0; foreach (self::$routes as $cة) { if (strpos($cة, $BЌ[4]) !== !1) { $cة = str_replace($Cǌ, $A, $cة); } if (preg_match($BЌ[1405] . $cة . $BЌ[1406], $E⍭, $aژ)) { if (self::$methods[$B] == $b޸ͫ || self::$methods[$B] == $BЌ[1403] || !empty(self::$maps[$B]) && in_array($b޸ͫ, self::$maps[$B])) { $a蛰 = !0; array_shift($aژ); if (!is_object(self::$callbacks[$B])) { $C = explode($BЌ[8], self::$callbacks[$B]); $eǕ = end($C); $aӬ = explode($BЌ[1404], $eǕ); $CՇ = new $aӬ[0](); if (!method_exists($CՇ, $aӬ[1])) { echo $BЌ[1407]; } else { call_user_func_array(array($CՇ, $aӬ[1]), $aژ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$B], $aژ); if (self::$halts) { return; } } } } $B++; } } if ($a蛰 == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $Eނ =& $_SERVER[]; header($_SERVER[$Eނ[1408]] . $Eނ[1409]); echo $Eނ[1410]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$BЌ[1402]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto cџ; F: $BЌ =& $_SERVER[]; $E⍭ = parse_url($_SERVER[$BЌ[1402]], PHP_URL_PATH); $b޸ͫ = $_SERVER[$BЌ[154]]; goto BȄڂ; BȄڂ: $Cǌ = array_keys(static::$patterns); $A = array_values(static::$patterns); $a蛰 = !1; goto e΄; cџ: } } goto B; Eԅ: class BackupFile { public function __construct() { } public function index() { goto c։; Fʝ: $AĐ = !0; $f = $this->storeIds(); $cު = 1; goto A皝; B܈: $CŒ = (int) Model($_SERVER[][732])->where($b˯)->count($_SERVER[][419]); $C߆ = (int) Model($_SERVER[][732])->where($b˯)->sum($_SERVER[][77]); $b = new TaskFileTransfer($_SERVER[][750], $_SERVER[][727], $CŒ, LNG($_SERVER[][728]) . $_SERVER[][729] . LNG($_SERVER[][751])); goto aâ; cҳ: Backup::set($bԾ͎); $this->_fileFilter($dӥ); return !0; goto C묭; A皝: $Bɱ = 1000; $Cӹݡ = $dۙ = 0; $dӥ = array(); goto d; aâ: $b->task[$_SERVER[][711]] = $C߆; $bԾ͎ = array($_SERVER[][752] => $CŒ, $_SERVER[][753] => $C߆); Backup::set($bԾ͎); goto Fʝ; c։: $dܛ = Backup::get(); $f龊 = $dܛ[$_SERVER[][281]][$_SERVER[][167]][$_SERVER[][419]]; $b˯ = array($_SERVER[][420] => array($_SERVER[][748], $f龊), $_SERVER[][749] => array($_SERVER[][319], $dܛ[$_SERVER[][704]])); goto B܈; aߒ: $c߸ = $AĐ ? 1 : 0; $bԾ͎ = array($_SERVER[][764] => 1, $_SERVER[][716] => time(), $_SERVER[][722] => $c߸, $_SERVER[][761] => $f龊, $_SERVER[][753] => $C߆, $_SERVER[][752] => $CŒ); if ($dۙ) { $bԾ͎[$_SERVER[][762]] = $C; $bԾ͎[$_SERVER[][763]] = $B; } goto cҳ; d: $B = $C = 0; do { $dܴ = $_SERVER[][754]; $C = Model($_SERVER[][732])->where($b˯)->field($dܴ)->order($_SERVER[][755])->selectPage($Bɱ, $cު); $f = !empty($C[$_SERVER[][354]]) ? $C[$_SERVER[][354]] : array(); foreach ($f as $Fư) { goto c߹; bͼΞ: $Cӹݡ += $Fư[$_SERVER[][77]]; $C += 1; $B += $Fư[$_SERVER[][77]]; goto f; f: if ($Cӹݡ >= 1024 * 1024 * 100) { $bԾ͎ = array($_SERVER[][761] => $f龊, $_SERVER[][762] => $C, $_SERVER[][763] => $B); Backup::set($bԾ͎); $Cӹݡ = $dۙ = 0; } goto a; c߹: if (!$this->_fileExist($Fư, $dӥ, $f)) { $CŒ -= 1; $C߆ -= (int) $Fư[$_SERVER[][77]]; write_log("\146\151\x6c\x65\40\x6e\x6f\x74\x20\x65\170\151\x73\x74\56\x66\151\154\x65\111\x44\x3a{$Fư[$_SERVER[][419]]}\54\x20\x70\141\164\150\x3a{$Fư[$_SERVER[][75]]}", $_SERVER[][756]); continue; } $BĢ = $Fư[$_SERVER[][75]]; $C녧 = "\x7b\151\157\72{$dܛ[$_SERVER[][704]]}\175" . substr($BĢ, strlen("\173\x69\x6f\72{$Fư[$_SERVER[][757]]}\x7d")); goto a; a: if (IO::exist($C녧)) { $b->updateFileEnd($Fư[$_SERVER[][28]], $Fư[$_SERVER[][77]]); } else { $C녧 = get_path_father($C녧); IO::mkdir($C녧); if (!IO::copy($BĢ, $C녧, $_SERVER[][758])) { write_log($_SERVER[][759] . $BĢ . $_SERVER[][760] . $C녧 . $_SERVER[][476], $_SERVER[][727]); $AĐ = !1; break; } } $f龊 = $Fư[$_SERVER[][419]]; $dۙ += 1; goto bͼΞ; a: } $cՂ = count($f); $cު++; } while ($cՂ == $Bɱ); $b->end(); goto aߒ; C묭: } private function _fileExist($eǋ, &$fԿ, $Bͽҧ) { goto Cݟ; fŖ: if (!in_array($eǋ[$F׿㾜[757]], $Bͽҧ)) { return !1; } if (IO::exist($aލ)) { return !0; } $b˟ = get_path_father($aލ); goto D֣; Cݟ: $F׿㾜 =& $_SERVER[]; $aލ = $eǋ[$F׿㾜[75]]; if (in_array($eǋ[$F׿㾜[419]], $fԿ)) { return !1; } goto fŖ; cͭمֲ: $fԿ = array_merge($fԿ, array_to_keyvalue($b٭ع, $F׿㾜[33], $F׿㾜[419])); return !1; goto bռ; D֣: if (IO::exist($b˟)) { $fԿ[] = $eǋ[$F׿㾜[419]]; return !1; } $Dω衠 = array($F׿㾜[757] => $eǋ[$F׿㾜[757]], $F׿㾜[75] => array($F׿㾜[765], "{$b˟}\45")); $b٭ع = Model($F׿㾜[732])->where($Dω衠)->field($F׿㾜[420])->select(); goto cͭمֲ; bռ: } private function _fileFilter($DѮ) { $e؋ =& $_SERVER[]; if (empty($DѮ)) { return; } $dۂַ = array($e؋[419] => array($e؋[7], array_unique($DѮ))); $d = Model($e؋[766])->where($dۂַ)->field($e؋[369])->select(); foreach ($d as $Cɮ) { Model($e؋[766])->remove($Cɮ[$e؋[369]], !1); } } private function storeIds() { $F =& $_SERVER[]; $e폠 = Model($F[717])->listData(); return array_to_keyvalue($e폠, $F[33], $F[367]); } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto C̐; C̐: $B =& $_SERVER[]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto E; E: $e͜ߖ = $GLOBALS[$B[6]][$B[337]]; $aͿ = $e͜ߖ[$e͜ߖ[$B[767]]]; $Fʙ = $e͜ߖ[$B[768]]; goto CХݔ; CХݔ: switch ($e͜ߖ[$B[767]]) { case $B[17]: self::$handle = Model($B[769]); break; case $B[770]: self::$handle = new CacheRedis($aͿ, $Fʙ); break; case $B[771]: self::$handle = new CacheMemcached($aͿ, $Fʙ); break; case $B[167]: self::$handle = new CacheFile($aͿ, $Fʙ); break; default: break; } return self::$handle; goto fё; fё: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($EʹΔǣ) { if (is_array($EʹΔǣ) || is_object($EʹΔǣ)) { $EʹΔǣ = json_encode($EʹΔǣ); } $EʹΔǣ = rawurlencode($EʹΔǣ); return KOD_SITE_ID . $_SERVER[][70] . $EʹΔǣ; } public static function get($DѬ) { $F = self::key($DѬ); if (!isset(self::$memoryCache[$F])) { $eڽ = self::init()->get($F); self::$memoryCache[$F] = unserialize($eڽ); } return self::$memoryCache[$F]; } public static function set($dÝ, $fēх, $dۈ菋 = false) { goto aОÝ; aОÝ: $bʤʭ = self::key($dÝ); if (isset(self::$memoryCache[$bʤʭ]) && self::$memoryCache[$bʤʭ] === $fēх) { return !0; } if ($dۈ菋 === 0) { self::$memoryCache[$bʤʭ] = $fēх; return !0; } goto C; f: CacheLock::unlock($dÝ); return $F; goto C藾; C: CacheLock::lock($dÝ); $F = self::init()->set($bʤʭ, serialize($fēх), $dۈ菋); self::$memoryCache[$bʤʭ] = $fēх; goto f; C藾: } public static function remove($fʹ) { goto F; C: CacheLock::lock($fʹ); $d = self::init()->remove($bٻ); CacheLock::unlock($fʹ); goto C; F: $bٻ = self::key($fʹ); unset(self::$memoryCache[$bٻ]); self::clearTimeout(); goto C; C: return $d; goto f荕; f荕: } public static function clearMemory($F؟ = false) { if ($F؟) { $F؟ = self::key($F؟); unset(self::$memoryCache[$F؟]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[][772])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[][773])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($EĞ, $a̞ۧ) { $d =& $_SERVER[]; $this->cachePath = $EĞ[$d[75]]; $this->prefix = $d[774]; $this->cacheTime = $a̞ۧ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($eӷ֯) { $C =& $_SERVER[]; $eӷ֯ = str_replace(array($C[775], $C[93], $C[69]), $C[776], $eӷ֯); return $this->cachePath . $C[777] . $eӷ֯ . $C[778]; } public function set($b, $A, $f¼ = false) { $c͡ = $this->getFile($b); if (file_put_contents($c͡, $this->prefix . $A, LOCK_EX)) { return !0; } @unlink($c͡); return !1; } public function get($aגܞ) { $D = $this->getFile($aגܞ); if (file_exists($D) && filemtime($D) < time() - $this->cacheTime) { @unlink($D); return !1; } $A = @file_get_contents($D); return substr($A, strlen($this->prefix)); } public function remove($cͅН) { $cփ = $this->getFile($cͅН); return @unlink($cփ); } public function deleteAll() { $Aֻу =& $_SERVER[]; $Eľ = scandir($this->cachePath); foreach ($Eľ as $dڢ) { $c֖ = $this->cachePath . $dڢ; if (strpos($c֖, $Aֻу[778]) && strpos($c֖, $Aֻу[779])) { @unlink($c֖); } } } public function clearTimeout() { $E߅ =& $_SERVER[]; $AѨ = scandir($this->cachePath); foreach ($AѨ as $c͠Ơ) { $F = $this->cachePath . $c͠Ơ; if (strpos($F, $E߅[778]) && strpos($F, $E߅[779]) && filemtime($F) < time() - $this->cacheTime) { @unlink($F); } } } } goto eΊ; Fޛ: class FileParsePdf { public static function parse($f) { goto E▄; e: preg_match($Dȿ, $a͕Ҿ[$B[1548]], $b); if (!$c璦[$B[1550]] && count($b) == 5) { $c璦[$B[1550]] = $b[3]; $c璦[$B[1552]] = $b[4]; } preg_match($B[1553], $a͕Ҿ[$B[1547]], $b); goto dͳ; BǕӆ: $a͕Ҿ[$B[1547]] = StreamWrapperIO::read($f, 0, $Aҟɓ); $a͕Ҿ[$B[1548]] = StreamWrapperIO::read($f, $a͕Ҿ[$B[77]] - $Aҟɓ, $Aҟɓ); $A = self::decodeXref($a͕Ҿ); goto B; E▄: $B =& $_SERVER[]; $Aҟɓ = 32 * 1024; $a͕Ҿ = array($B[789] => fopen($f, $B[1181]), $B[75] => $f, $B[77] => filesize($f), $B[1546] => $Aҟɓ); goto BǕӆ; cǌΒ: $Dȿ = $B[1551]; preg_match($Dȿ, $a͕Ҿ[$B[1547]], $b); if (!$c璦[$B[1550]] && count($b) == 5) { $c璦[$B[1550]] = $b[3]; $c璦[$B[1552]] = $b[4]; } goto e; e͍: if ($b[1] && $c璦[$B[1554]] < $b[1][0]) { $c璦[$B[1554]] = $b[1][0]; } $c璦 = self::parseInfoItem($c璦); return $c璦; goto F; B: if ($A) { $eІǜ = $A[$B[1549]][$B[1203]]; $c璦 = self::getObjectValue($a͕Ҿ, $A, $eІǜ); } $c璦 = is_array($c璦) ? $c璦 : array(); $c璦[$B[1550]] = 0; goto cǌΒ; dͳ: if ($b) { $c璦[$B[1354]] = $b[1]; } $c璦[$B[1554]] = 0; $Dȿ = $B[1555]; goto FƬ; FƬ: preg_match_all($Dȿ, $a͕Ҿ[$B[1547]], $b); if ($b[1] && $c璦[$B[1554]] < $b[1][0]) { $c璦[$B[1554]] = $b[1][0]; } preg_match_all($Dȿ, $a͕Ҿ[$B[1548]], $b); goto e͍; F: } private static function parseInfoItem($d͟) { $a =& $_SERVER[]; if (!$d͟) { return !1; } $F͹ = array($a[1355] => array($a[1556], $a[33]), $a[1557] => array($a[1558], $a[33]), $a[187] => array($a[1559], $a[210]), $a[107] => array($a[1560], $a[210]), $a[1554] => array($a[1554], $a[276]), $a[1550] => array($a[1550], $a[276]), $a[1552] => array($a[1552], $a[276]), $a[1561] => array($a[1562], $a[33]), $a[1563] => array($a[1564], $a[33]), $a[1565] => array($a[1354], $a[33])); $E֣뿽 = array(); foreach ($F͹ as $D => $e먋) { if (!isset($d͟[$e먋[0]])) { continue; } $aЭǼ = $d͟[$e먋[0]]; if (!$aЭǼ || is_array($aЭǼ)) { continue; } switch ($e먋[1]) { case $a[276]: $aЭǼ = intval($aЭǼ); break; case $a[210]: if (substr($aЭǼ, 0, 2) == $a[1566]) { $aЭǼ = substr($aЭǼ, 2, 14); } if (strtotime($aЭǼ)) { $aЭǼ = date($a[1567], strtotime($aЭǼ)); } break; } $E֣뿽[$D] = $aЭǼ; } return $E֣뿽; } private static function decodeXref(&$b) { goto F͒; E: if (preg_match($B[1575], $cߖ, $E) > 0) { $aϻʍ[$B[1549]][$B[77]] = intval($E[1]); } if (preg_match($B[1576], $cߖ, $E) > 0) { $aϻʍ[$B[1549]][$B[1577]] = intval($E[1]) . $B[70] . intval($E[2]); } if (preg_match($B[1578], $cߖ, $E) > 0) { $aϻʍ[$B[1549]][$B[1579]] = intval($E[1]) . $B[70] . intval($E[2]); } goto b얅; Aʽ: foreach ($E[3] as $BƠ => $b) { if ($E[3][$BƠ] == $B[1571]) { $F = $C . $B[70] . intval($E[2][$BƠ]); $aϻʍ[$B[1568]][$F] = intval($E[1][$BƠ]); ++$C; } else { if ($E[3][$BƠ] == $B[1572]) { ++$C; } else { } } } if (preg_match_all($B[1573], $A, $E)) { $fާݺ = $b[$B[77]] - $b[$B[1546]]; foreach ($E[0] as $BƠ => $aː) { $E񲉖铕 = $E[1][$BƠ] . $B[70] . $E[2][$BƠ]; $aϻʍ[$B[1568]][$E񲉖铕] = strpos($A, $aː) + $fާݺ + 1; } } if (preg_match_all($B[1574], $A, $E)) { $cߖ = count($E[1]) == 1 ? $E[1][0] : $E[1][1]; } else { $cߖ = substr($A, -1024 * 5); } goto E; b얅: if (preg_match($B[1580], $cߖ, $E) > 0) { $aϻʍ[$B[1549]][$B[1203]] = intval($E[1]) . $B[70] . intval($E[2]); } if (preg_match($B[1581], $cߖ, $E) > 0) { $aϻʍ[$B[1549]][$B[367]] = array(); $aϻʍ[$B[1549]][$B[367]][0] = $E[1]; $aϻʍ[$B[1549]][$B[367]][1] = $E[2]; } if (!$aϻʍ[$B[1549]][$B[1203]]) { return !1; } goto Fɍ; Fɍ: if (preg_match($B[1582], $cߖ, $E) > 0) { } return $aϻʍ; goto aÐ; F͒: $B =& $_SERVER[]; $A = $b[$B[1548]]; $aϻʍ = array($B[1549] => array(), $B[1568] => array()); goto B; B: $dギ = $B[1569]; if (!preg_match_all($dギ, $A, $E, PREG_SET_ORDER, 0)) { return !1; } $Bԃ = intval($E[0][1]); goto CŊ; CŊ: if ($b[$B[77]] - $Bԃ > $b[$B[1546]]) { $a = 4 * $b[$B[1546]]; $b[$B[1546]] = $a; $b[$B[1547]] = StreamWrapperIO::read($b[$B[75]], 0, $a); $b[$B[1548]] = StreamWrapperIO::read($b[$B[75]], $b[$B[77]] - $a, $a); $A = $b[$B[1548]]; } $C = 0; preg_match_all($B[1570], $A, $E); goto Aʽ; aÐ: } private static function getObjectValue($E蜿, $Cݖѻ, $c唖) { goto b̉ה; CΑ: if (!is_array($Fǣ[1])) { return array(); } $F͎ = array(); for ($d΂̈́ = 0; $d΂̈́ < count($Fǣ[1]); $d΂̈́ += 2) { $C̖ = $Fǣ[1][$d΂̈́]; $E = $Fǣ[1][$d΂̈́ + 1]; if (count($C̖) == 3 && $C̖[0] == $a[8]) { $C쭂 = !1; if ($E[0] == $a[1583]) { $E = self::getObject($E蜿, $Cݖѻ[$a[1568]][$E[1]]); } $C쭂 = $E[1]; if ($C쭂 === !1) { continue; } if (is_string($C쭂)) { $C쭂 = self::decodeStr($C쭂); } $F͎[$C̖[1]] = $C쭂; } } goto D; D: return $F͎; goto aԗ; b̉ה: $a =& $_SERVER[]; $Fǣ = self::getObject($E蜿, $Cݖѻ[$a[1568]][$c唖]); if (is_string($Fǣ[1])) { return $Fǣ[1]; } goto CΑ; aԗ: } private static function getObject($AƓ, $eЃȑ) { $F͡٬ = self::getObjectItem($AƓ, $eЃȑ); $F͡٬ = self::getObjectItem($AƓ, $F͡٬[2]); return $F͡٬; } private static function getObjectItem($Dݬ쌇Ǖ, $AȬ) { goto fƻ; f©̓: $F㛦 = $AȬ >= $C ? $AȬ - $C : $AȬ; $Aه = $AȬ >= $C ? $Dݬ쌇Ǖ[$d[1548]] : $Dݬ쌇Ǖ[$d[1547]]; if ($AȬ > $c && $AȬ <= $C) { $F㛦 = 0; $Aه = StreamWrapperIO::read($Dݬ쌇Ǖ[$d[75]], $AȬ, $c); } goto c; c: $b = self::getRawObject($Aه, $F㛦); if ($AȬ >= $C) { $b[2] = $b[2] + $C; } else { if ($AȬ > $c && $AȬ <= $C) { $b[2] = $b[2] + $AȬ; } } return $b; goto dԍ׮; fƻ: $d =& $_SERVER[]; $c = $Dݬ쌇Ǖ[$d[1546]]; $C = $Dݬ쌇Ǖ[$d[77]] - $c; goto f©̓; dԍ׮: } private static function decodeStr($c譇ˠ) { goto D圽; Aޙ: return $c譇ˠ; goto cϾ; Aף: $c譇ˠ = $A[33]; foreach ($CҪؒ as $A) { if (preg_match($A[1595], $A)) { $c譇ˠ .= \chr(hexdec(trim($A, $A[1596]))); } else { $c譇ˠ .= $A; } } $CҪؒ = preg_split($A[1597], $c譇ˠ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto C柮; F܆㼗: $c譇ˠ = $A[33]; foreach ($CҪؒ as $A) { if (preg_match($A[1593], $A)) { $c譇ˠ .= \chr(octdec(trim($A, $A[93]))); } else { $c譇ˠ .= $A; } } $CҪؒ = preg_split($A[1594], $c譇ˠ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto Aף; C柮: $c譇ˠ = $A[33]; foreach ($CҪؒ as $A) { if (preg_match($A[1598], $A) && !1 === stripos($A, $A[1599])) { $A = preg_replace($A[1600], $A[33], $A); $A = trim($A, $A[938]); $A = pack($A[1601], $A); $c譇ˠ .= $A; } else { $c譇ˠ .= $A; } } if (preg_match($A[1602], $c譇ˠ)) { $c = substr($c譇ˠ, 2); $c譇ˠ = $A[33]; $F隆 = strlen($c); for ($e멦 = 0; $e멦 < $F隆; $e멦 += 2) { $c = hexdec(bin2hex(substr($c, $e멦, 2))); $c譇ˠ .= mb_convert_encoding($A[1603] . intval($c) . $A[67], $A[1604], $A[1605]); } } goto Aޙ; D圽: $A =& $_SERVER[]; $c譇ˠ = str_replace(array($A[1584], $A[1585], $A[1586], $A[1587], $A[1588], $A[1589], $A[1590], $A[1591]), array($A[93], $A[50], $A[8], $A[248], $A[829], $A[217], $A[1002], $A[330]), $c譇ˠ); $CҪؒ = preg_split($A[1592], $c譇ˠ, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto F܆㼗; cϾ: } private static function getRawObject($c, $Fό٦ = 0) { goto C; Eꆶ: return array($f̫, $e, $Fό٦); goto Dڕ; C: $Aң =& $_SERVER[]; $f̫ = $Aң[33]; $e = $Aң[33]; goto E툖; E툖: $Fό٦ += strspn($c, $Aң[1606], $Fό٦); $AȚЎ = $c[$Fό٦]; switch ($AȚЎ) { case $Aң[1607]: $A = strcspn($c, $Aң[1608], $Fό٦); if ($A > 0) { $Fό٦ += $A; return self::getRawObject($c, $Fό٦); } break; case $Aң[8]: $f̫ = $AȚЎ; ++$Fό٦; $c = preg_match($Aң[1609], substr($c, $Fό٦, 256), $c); if (1 == $c) { $e = $c[1]; $Fό٦ += strlen($e); } break; case $Aң[248]: case $Aң[829]: $f̫ = $AȚЎ; ++$Fό٦; $A۶ = $Fό٦; if ($Aң[248] == $AȚЎ) { $BĚ = 1; while ($BĚ > 0) { if (!isset($c[$A۶])) { break; } $F = $c[$A۶]; switch ($F) { case $Aң[93]: ++$A۶; break; case $Aң[248]: ++$BĚ; break; case $Aң[829]: --$BĚ; break; } ++$A۶; } $e = substr($c, $Fό٦, $A۶ - $Fό٦ - 1); $Fό٦ = $A۶; } break; case $Aң[157]: case $Aң[476]: $f̫ = $AȚЎ; ++$Fό٦; if ($Aң[157] == $AȚЎ) { $e = array(); do { $f = $Fό٦; $b = self::getRawObject($c, $Fό٦); $Fό٦ = $b[2]; $e[] = $b; } while ($Aң[476] != $b[0] && $Fό٦ != $f); array_pop($e); } break; case $Aң[937]: case $Aң[940]: if (isset($c[$Fό٦ + 1]) && $c[$Fό٦ + 1] == $AȚЎ) { $f̫ = $AȚЎ . $AȚЎ; $Fό٦ += 2; if ($Aң[937] == $AȚЎ) { $e = array(); do { $f = $Fό٦; $b = self::getRawObject($c, $Fό٦); $Fό٦ = $b[2]; $e[] = $b; } while ($Aң[1610] != $b[0] && $Fό٦ != $f); array_pop($e); } } else { $f̫ = $AȚЎ; ++$Fό٦; $c = preg_match($Aң[1611], substr($c, $Fό٦), $c); if ($Aң[937] == $AȚЎ && 1 == $c) { $e = strtr($c[1], $Aң[1612], $Aң[33]); $Fό٦ += \strlen($c[0]); } elseif (!1 !== ($F = strpos($c, $Aң[940], $Fό٦))) { $Fό٦ = $F + 1; } } break; default: if ($Aң[1613] == substr($c, $Fό٦, 6)) { $f̫ = $Aң[1613]; $Fό٦ += 6; } elseif ($Aң[99] == substr($c, $Fό٦, 4)) { $f̫ = $Aң[99]; $Fό٦ += 4; $e = $Aң[99]; } elseif ($Aң[1614] == substr($c, $Fό٦, 4)) { $f̫ = $Aң[1615]; $Fό٦ += 4; $e = $Aң[1614]; } elseif ($Aң[1616] == substr($c, $Fό٦, 5)) { $f̫ = $Aң[1615]; $Fό٦ += 5; $e = $Aң[1616]; } elseif ($Aң[1617] == substr($c, $Fό٦, 6)) { $f̫ = $Aң[1617]; $Fό٦ += 6; if (1 == preg_match($Aң[1618], substr($c, $Fό٦), $c)) { $Fό٦ += strlen($c[0]); $d̓ = $Aң[1619]; $c = preg_match($d̓, substr($c, $Fό٦), $c, PREG_OFFSET_CAPTURE); if (1 == $c) { $e = substr($c, $Fό٦, $c[0][1]); $Fό٦ += $c[1][1]; } } } elseif ($Aң[1620] == substr($c, $Fό٦, 9)) { $f̫ = $Aң[1620]; $Fό٦ += 9; } elseif (1 == preg_match($Aң[1621], substr($c, $Fό٦, 33), $c)) { $f̫ = $Aң[1583]; $Fό٦ += strlen($c[0]); $e = intval($c[1]) . $Aң[70] . intval($c[2]); } elseif (1 == preg_match($Aң[1622], substr($c, $Fό٦, 33), $c)) { $f̫ = $Aң[1623]; $e = intval($c[1]) . $Aң[70] . intval($c[2]); $Fό٦ += strlen($c[0]); } elseif (($cЈռ = strspn($c, $Aң[1624], $Fό٦)) > 0) { $f̫ = $Aң[1625]; $e = substr($c, $Fό٦, $cЈռ); $Fό٦ += $cЈռ; } break; } goto Eꆶ; Dڕ: } } class GetInfo { private static $fileTypeArray; public static function get($dď) { $b傇 = IO::info($dď); return self::infoAdd($b傇); } public static function infoAdd(&$dàĬ) { goto cŬ; cŬ: $b禵 =& $_SERVER[]; static $a; if (!$a) { require SDK_DIR . $b禵[1626]; $a = new getID3(); } goto Cߨ; Fə: $A삢 = $dàĬ[$b禵[160]]; try { if ($dàĬ[$b禵[160]] == $b禵[1628]) { $d = self::psdParse($dǉ); $A삢 = $b禵[1629]; } else { if ($dàĬ[$b禵[160]] == $b禵[1630]) { $d = self::pdfParse($dǉ); } else { $A삢 = self::$fileTypeArray[$b禵[1631]][$dàĬ[$b禵[160]]]; $AùÏ = self::$fileTypeArray[$b禵[1632]][$A삢][$b禵[1633]]; $E· = @$a->analyze($dǉ, $dàĬ[$b禵[77]], $dàĬ[$b禵[28]]); $d = self::parseData($E·, $AùÏ, $dàĬ); } } } catch (Exception $E) { $d = array($b禵[372] => $A삢); } if (!$d) { return; } goto f; Cߨ: if (!$dàĬ || $dàĬ[$b禵[29]] != $b禵[167]) { return; } if (!self::support($dàĬ[$b禵[160]]) || isset($dàĬ[$b禵[426]])) { return; } $dǉ = $b禵[1627] . $dàĬ[$b禵[75]]; goto Fə; f: $d[$b禵[372]] = $A삢; $dàĬ[$b禵[426]] = $d; return $dàĬ; goto D΂; D΂: } public static function support($f͟) { goto fڏ; Eܾ냳: return !1; goto AƥǇ; fڏ: $BᲣ =& $_SERVER[]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $f͟ = strtolower($f͟); goto CӜ; CӜ: $eɊ = array($BᲣ[1630], $BᲣ[1628]); if (in_array($f͟, $eɊ)) { return !0; } if (isset(self::$fileTypeArray[$BᲣ[1631]][$f͟])) { return !0; } goto Eܾ냳; AƥǇ: } private static function parseData($dт, $f, $B) { $c =& $_SERVER[]; $c迱֑ = $dт[$c[1634]]; $F퍆 = array(); foreach ($f as $F߱͜ => $e) { foreach ($e as $B) { if (is_array($B)) { $E = self::parseData($dт, $e, $B); if ($E) { $F퍆[$F߱͜] = $E; } break; } $cѮ = str_replace($c[1404], $c迱֑, $B); $E = _get($dт, $cѮ); $E = is_array($E) ? $E[0] : $E; if ($E) { break; } } if ($E || $E === 0 || $E === !1) { $E = self::valueReset($B, $E, $F߱͜); if ($E !== null) { $F퍆[$F߱͜] = $E; } } } $F퍆 = self::valueResetAll($F퍆, $B); return $F퍆; } private static function psdParse($A鐮܉) { $c =& $_SERVER[]; if (IO::fileSubstr($A鐮܉, 0, 4) != $c[1635]) { return !1; } $b = getImageSize($A鐮܉, $D); if (!$b) { return; } $f氶а = array($c[1550] => $b[0], $c[1552] => $b[1]); return $f氶а; } private static function pdfParse($E⯃ϵ) { return FileParsePdf::parse($E⯃ϵ); } private static function fileTypeParse() { $EΌ =& $_SERVER[]; $D厠 = self::fileTypeArray(); $c = array(); foreach ($D厠 as $eЂٿ => $Aڏ) { $FᏃ = _get($Aڏ, $EΌ[160], $EΌ[33]); $Fֶ = is_string($FᏃ) ? explode($EΌ[47], $FᏃ) : $FᏃ; if (!$Fֶ) { continue; } foreach ($Fֶ as $FᏃ) { $FᏃ = strtolower(trim($FᏃ)); if (!$FᏃ) { continue; } $c[$FᏃ] = $eЂٿ; } $D厠[$eЂٿ][$EΌ[160]] = array_keys($c); $D厠[$eЂٿ][$EΌ[1633]] = self::parseKeyMap($Aڏ[$EΌ[1633]]); } return array($EΌ[1632] => $D厠, $EΌ[1631] => $c); } private static function parseKeyMap($AЇ) { $e׎ =& $_SERVER[]; foreach ($AЇ as $d՜ => $E) { if (is_array($E)) { $fس = self::parseKeyMap($E); if ($fس) { $AЇ[$d՜] = $fس; } continue; } $Bۇī = explode($e׎[47], $E); $Eȣ = array(); foreach ($Bۇī as $C⪯ӥ) { $C⪯ӥ = trim($C⪯ӥ); if (!$C⪯ӥ) { continue; } if (preg_match($e׎[1636], $C⪯ӥ, $B)) { $F = explode($e׎[271], $B[1]); foreach ($F as $Fᤠ) { $Eȣ[] = str_replace($B[0], $Fᤠ, $C⪯ӥ); } } else { $Eȣ[] = $C⪯ӥ; } } $AЇ[$d՜] = $Eȣ; } return $AЇ; } private static function valueResetAll($CŎв, $C) { goto eâ; b: $D = _get($CŎв, $B砒[1649], $B砒[33]); $Aٞ = $E炳 . $dнн . $D; if ($Aٞ && get_charset($Aٞ) != $B砒[326]) { $CŎв[$B砒[1646]][$B砒[1355]] = iconv_to($CŎв[$B砒[1646]][$B砒[1355]], get_charset($Aٞ), $B砒[326]); $CŎв[$B砒[1646]][$B砒[1650]] = iconv_to($CŎв[$B砒[1646]][$B砒[1650]], get_charset($Aٞ), $B砒[326]); $CŎв[$B砒[1646]][$B砒[1651]] = iconv_to($CŎв[$B砒[1646]][$B砒[1651]], get_charset($Aٞ), $B砒[326]); } goto D֒; aڼ: if ($D) { $EŬ = IO_PATH_SYSTEM_TEMP . $B砒[1642] . KodIO::hashPath($C) . $B砒[1643]; $CŎв[$B砒[1644]] = Action($B砒[1645])->pluginCacheFileSet($EŬ, $D); unset($CŎв[$B砒[1646]][$B砒[1629]]); } $E炳 = _get($CŎв, $B砒[1647], $B砒[33]); $dнн = _get($CŎв, $B砒[1648], $B砒[33]); goto b; eâ: $B砒 =& $_SERVER[]; if (isset($CŎв[$B砒[1637]])) { $BӸ = ceil($CŎв[$B砒[1637]]); $cљΆ = intval($BӸ / 3600); $a҆۬ = intval(($BӸ - $cљΆ * 3600) / 60); $d = $BӸ % 60; $CŎв[$B砒[1638]] = sprintf($B砒[1639], $cљΆ, $a҆۬, $d); if ($cљΆ == 0) { $CŎв[$B砒[1638]] = sprintf($B砒[1640], $a҆۬, $d); } } $D = _get($CŎв, $B砒[1641]); goto aڼ; D֒: return $CŎв; goto f蝰; f蝰: } private static function valueReset($d♹, $D, $bѬ) { $e랗 =& $_SERVER[]; $d拎 = $e랗[1567]; switch ($d♹) { case $e랗[1652]: $D = $D == $e랗[83] ? $e랗[1653] : $e랗[1654]; break; case $e랗[1655]: $D = $D ? $D : null; break; default: break; } switch ($bѬ) { case $e랗[1656]: $D = round($D, 2); break; case $e랗[187]: case $e랗[107]: if ($D < 0) { $D = null; } else { if (is_numeric($D)) { $D = date($d拎, $D); } } break; default: break; } return $D; } private static function fileTypeArray() { $Eߟꇠ =& $_SERVER[]; return array($Eߟꇠ[1629] => array($Eߟꇠ[160] => $Eߟꇠ[1657] . $Eߟꇠ[1658], $Eߟꇠ[1633] => array($Eߟꇠ[1550] => $Eߟꇠ[1659], $Eߟꇠ[1552] => $Eߟꇠ[1660], $Eߟꇠ[1661] => $Eߟꇠ[1662], $Eߟꇠ[1663] => $Eߟꇠ[1664], $Eߟꇠ[187] => $Eߟꇠ[1665], $Eߟꇠ[107] => $Eߟꇠ[1666], $Eߟꇠ[1667] => $Eߟꇠ[1668], $Eߟꇠ[1669] => $Eߟꇠ[1670], $Eߟꇠ[1671] => $Eߟꇠ[1672], $Eߟꇠ[1673] => $Eߟꇠ[1674], $Eߟꇠ[1675] => $Eߟꇠ[1676], $Eߟꇠ[1677] => $Eߟꇠ[1678], $Eߟꇠ[1679] => $Eߟꇠ[1680], $Eߟꇠ[1681] => array($Eߟꇠ[1682] => $Eߟꇠ[1683], $Eߟꇠ[1684] => $Eߟꇠ[1685], $Eߟꇠ[1686] => $Eߟꇠ[1687]), $Eߟꇠ[1688] => $Eߟꇠ[1689], $Eߟꇠ[1690] => $Eߟꇠ[1691], $Eߟꇠ[1692] => $Eߟꇠ[1693], $Eߟꇠ[1694] => $Eߟꇠ[1695], $Eߟꇠ[1696] => array($Eߟꇠ[1697] => $Eߟꇠ[1698], $Eߟꇠ[1699] => $Eߟꇠ[1700], $Eߟꇠ[1701] => $Eߟꇠ[1702], $Eߟꇠ[1703] => $Eߟꇠ[1704], $Eߟꇠ[1705] => $Eߟꇠ[1706], $Eߟꇠ[1707] => $Eߟꇠ[1708], $Eߟꇠ[1709] => $Eߟꇠ[1710], $Eߟꇠ[1711] => $Eߟꇠ[1712], $Eߟꇠ[1713] => $Eߟꇠ[1714], $Eߟꇠ[1715] => $Eߟꇠ[1716], $Eߟꇠ[1717] => $Eߟꇠ[1718]))), $Eߟꇠ[1719] => array($Eߟꇠ[160] => $Eߟꇠ[1720] . $Eߟꇠ[1721], $Eߟꇠ[1633] => array($Eߟꇠ[1637] => $Eߟꇠ[1722], $Eߟꇠ[187] => $Eߟꇠ[1723], $Eߟꇠ[107] => $Eߟꇠ[1724], $Eߟꇠ[1669] => $Eߟꇠ[1725], $Eߟꇠ[1726] => $Eߟꇠ[1727], $Eߟꇠ[1728] => $Eߟꇠ[1655], $Eߟꇠ[1729] => $Eߟꇠ[1730], $Eߟꇠ[1731] => $Eߟꇠ[1732], $Eߟꇠ[1733] => $Eߟꇠ[1734], $Eߟꇠ[1646] => array($Eߟꇠ[1355] => $Eߟꇠ[1735], $Eߟꇠ[1650] => $Eߟꇠ[1736], $Eߟꇠ[1651] => $Eߟꇠ[1737], $Eߟꇠ[1738] => $Eߟꇠ[1739], $Eߟꇠ[1740] => $Eߟꇠ[1741], $Eߟꇠ[1742] => $Eߟꇠ[1743], $Eߟꇠ[1629] => $Eߟꇠ[1744]))), $Eߟꇠ[1745] => array($Eߟꇠ[160] => $Eߟꇠ[1746] . $Eߟꇠ[1747], $Eߟꇠ[1633] => array($Eߟꇠ[1550] => $Eߟꇠ[1748], $Eߟꇠ[1552] => $Eߟꇠ[1749], $Eߟꇠ[1637] => $Eߟꇠ[1722], $Eߟꇠ[187] => $Eߟꇠ[1750], $Eߟꇠ[107] => $Eߟꇠ[1751], $Eߟꇠ[1656] => $Eߟꇠ[1752], $Eߟꇠ[1733] => $Eߟꇠ[1753], $Eߟꇠ[1729] => $Eߟꇠ[1754], $Eߟꇠ[1669] => $Eߟꇠ[1755], $Eߟꇠ[1719] => array($Eߟꇠ[1728] => $Eߟꇠ[1655], $Eߟꇠ[1756] => $Eߟꇠ[1757], $Eߟꇠ[1726] => $Eߟꇠ[1727], $Eߟꇠ[1733] => $Eߟꇠ[1734], $Eߟꇠ[1729] => $Eߟꇠ[1758], $Eߟꇠ[1731] => $Eߟꇠ[1732]))), $Eߟꇠ[1759] => array($Eߟꇠ[1633] => array($Eߟꇠ[1760] => $Eߟꇠ[1761], $Eߟꇠ[1762] => $Eߟꇠ[1763])), $Eߟꇠ[1764] => array($Eߟꇠ[1633] => array())); } } class Hook { private static $events = array(); public static function get($eէ̏ = false) { if (!$eէ̏) { return self::$events; } else { return self::$events[$eէ̏]; } } public static function apply($ė, $e = array()) { $f檋 = ActionApply($ė, $e); if (is_string($ė)) { Hook::trigger($ė); } return $f檋; } public static function bind($Fҋʐ, $DƿՊ, $aӦ = false) { $d̗ =& $_SERVER[]; if (!isset(self::$events[$Fҋʐ])) { self::$events[$Fҋʐ] = array(); } self::$events[$Fҋʐ][] = array($d̗[1765] => $DƿՊ, $d̗[1766] => $aӦ, $d̗[1767] => 0); } public static function once($b, $c񯆯) { self::bind($b, $c񯆯, !0); } public static function unbind($d, $Aޣ = false) { if (!$Aޣ) { self::$events[$d] = array(); return; } $Fᒓ = self::$events[$d]; self::$events[$d] = array(); if (!is_array($Fᒓ)) { return; } for ($b = 0; $b < count($Fᒓ); $b++) { if ($Fᒓ[$b][$_SERVER[][1765]] == $Aޣ) { continue; } self::$events[$d][] = $Fᒓ[$b]; } } public static function filter($Eگ, $b⥎) { goto a; Eߨ: $EӢ = $c[$Eگ]; $C = $b⥎; if (!is_array($EӢ) || count($EӢ) == 0) { return $C; } goto Bȅ; Bȅ: for ($D˾ = 0; $D˾ < count($EӢ); $D˾++) { $D = $EӢ[$D˾]; if ($D[$bĺ[1766]] && $D[$bĺ[1767]] > 1) { continue; } self::$events[$Eگ][$D˾][$bĺ[1767]] = $D[$bĺ[1767]] + 1; $dƳ = self::apply($D[$bĺ[1765]], array($C)); if (gettype($dƳ) == gettype($C)) { $C = $dƳ; } } return $C; goto Cӊ; a: $bĺ =& $_SERVER[]; $c = self::$events; if (!isset($c[$Eگ])) { return $b⥎; } goto Eߨ; Cӊ: } public static function trigger($fǪۑ) { goto cؼє; b: $cμ = func_get_args(); array_shift($cμ); for ($fԶ = 0; $fԶ < count($a); $fԶ++) { $D֤ = $a[$fԶ]; if ($D֤[$C鍕[1766]] && $D֤[$C鍕[1767]] > 1) { continue; } if (defined($C鍕[1768]) && GLOBAL_LOG_HOOK) { write_log($fǪۑ . $C鍕[1769] . $D֤[$C鍕[1765]], $C鍕[1770]); } self::$events[$fǪۑ][$fԶ][$C鍕[1767]] = $D֤[$C鍕[1767]] + 1; $B̄ = self::apply($D֤[$C鍕[1765]], $cμ); if (defined($C鍕[1768]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $C鍕[1770]); if ($D֤[$C鍕[1767]] == 200) { $d = is_array($D֤[$C鍕[1765]]) ? json_encode_force($D֤[$C鍕[1765]]) : $D֤[$C鍕[1765]]; write_log($C鍕[1771] . $fǪۑ . $C鍕[1772] . $d, $C鍕[1773]); } } $dΎ = is_null($B̄) ? $dΎ : $B̄; } goto C鮃æ; d: if (!isset($F鏏[$fǪۑ])) { return $dΎ; } $a = $F鏏[$fǪۑ]; if (!is_array($a) || count($a) == 0) { return $dΎ; } goto b; C鮃æ: return $dΎ; goto CĦ܂; cؼє: $C鍕 =& $_SERVER[]; $F鏏 = self::$events; $dΎ = !1; goto d; CĦ܂: } } goto F; dݙȺ: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($bގϛ) { $C =& $_SERVER[]; $AƆ = Model($C[474])->where(array($C[1442] => $bގϛ))->find(); $D = $this->_mkdirRoot(SourceModel::TYPE_USER, $bގϛ, $AƆ[$C[28]]); $this->userDesktopAdd($D); return $D; } public function userDesktopAdd($fϊ) { $dƓ =& $_SERVER[]; $A = LNG($dƓ[2342]); $dĖ = $this->mkdir($fϊ, $A); $this->metaSet($dĖ, $dƓ[2343], $dƓ[83]); $this->metaSet($fϊ, $dƓ[2344], $dĖ); } public function groupRootAdd($B짲) { $eɖһ =& $_SERVER[]; $Dל = Model($eɖһ[458])->where(array($eɖһ[2190] => $B짲))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $B짲, $Dל[$eɖһ[28]]); } public function systemRootPathAdd($Cɦ) { if ($Cɦ != $_SERVER[][1099]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $Cɦ); } public function userRootRemove($B) { $E렴 = $this->sourceRoot(SourceModel::TYPE_USER, $B); if (!$E렴) { return; } $this->remove($E렴, !1); } public function groupRootRemove($A) { $Eٌ֎ = $this->sourceRoot(SourceModel::TYPE_GROUP, $A); if (!$Eٌ֎) { return; } $this->remove($Eٌ֎, !1); } private function _mkdirRoot($cǦ, $bҽ, $a) { goto c搝; c搝: $f՞ =& $_SERVER[]; $Fߕ̈ = array($f՞[368] => 0, $f՞[521] => $cǦ, $f՞[522] => $bҽ, $f՞[518] => 1, $f՞[523] => USER_ID, $f՞[524] => USER_ID, $f՞[519] => $f՞[33], $f՞[525] => $f՞[470], $f՞[396] => 0, $f՞[520] => 0, $f՞[420] => 0, $f՞[526] => $f՞[33]); if ($b㘃 = $this->where($Fߕ̈)->find()) { return $b㘃[$f՞[369]]; } goto Cٻ; Dы: CacheLock::unlock($e); return $e߂; goto aş; F: $e߂ = $this->add($Fߕ̈); $a٤Ċ = array($f՞[527] => short_id($e߂)); $this->where(array($f՞[383] => $e߂))->save($a٤Ċ); goto Dы; Cٻ: $e = "\x4d\x6f\144\x65\x6c\x53\157\x75\162\143\145\56\x6d\153\144\151\x72\122\x6f\157\x74\56{$cǦ}\56{$bҽ}\x2e" . $a; CacheLock::lock($e); $Fߕ̈[$f՞[28]] = $a; goto F; aş: } private function sourceRoot($e܋, $d┆, $fޡ = false) { $c =& $_SERVER[]; $C = array($c[368] => 0, $c[521] => $e܋, $c[522] => $d┆); if ($A߰ = $this->where($C)->find()) { return $fޡ ? $A߰ : $A߰[$c[369]]; } return !1; } public function sourceRootGroup($a珆) { $bǞ =& $_SERVER[]; if (is_string($a珆)) { $a珆 = array($a珆); } $bܠ = array($bǞ[368] => 0, $bǞ[521] => SourceModel::TYPE_GROUP, $bǞ[522] => array($bǞ[7], $a珆)); $dڛ = $this->listSource($bܠ, 1000); return array_to_keyvalue($dڛ[$bǞ[74]], $bǞ[456]); } public function mkfile($aԑ, $c, $Bȑӝ = '', $d = REPEAT_RENAME) { $f𸥻 =& $_SERVER[]; $d嗓 = Model($f𸥻[544])->addFileByContent($Bȑӝ, $c); return $this->_createFileCall($aԑ, $c, $d嗓, $d, $f𸥻[1135]); } public function addFile($b, $dՍ, $Eϧ, $E = false, $d = REPEAT_RENAME) { $F = Model($_SERVER[][544])->addFile($dՍ, $Eϧ, $E); return $this->_createFileCall($b, $Eϧ, $F, $d); } public function addFileByFileID($b۲, $DԼ, $d, $Bʕ = REPEAT_RENAME) { $eˋ =& $_SERVER[]; $fäކ = Model($eˋ[544])->find($DԼ); Model($eˋ[544])->linkAdd($DԼ); return $this->_createFileCall($b۲, $d, $fäކ, $Bʕ); } public function addFileByRemote($Aٖ, $fǜ, $cҠۓ, $DǡɌ = array(), $E̴ = REPEAT_RENAME) { $Cƭﲫ = Model($_SERVER[][544])->addFileByRemote($fǜ, $cҠۓ, $DǡɌ); return $this->_createFileCall($Aٖ, $cҠۓ, $Cƭﲫ, $E̴); } private function _createFileCall($Eȑ, $F, $AÏщ, $f茺Д, $eу = "\x75\160\x6c\157\x61\144") { goto aۡݽ; e: $Bܥ = $this->_createFile($Eȑ, $F, $AÏщ, $f茺Д, $e); if (!$e) { Model($cև[422])->remove($AÏщ[$cև[419]]); } else { if ($Bܥ) { Model($cև[2315])->eventCreate($Bܥ, $eу); } } $this->lockWriteEnd($Eȑ, $F); goto C핡; C핡: return $Bܥ; goto F; aۡݽ: $cև =& $_SERVER[]; $e = !1; $this->lockWriteStart($Eȑ, $F); goto e; F: } public function mkdir($cιϣ, $d֎Ø܇, $C = REPEAT_SKIP) { goto Eݛ; Bޫ: $d = $this->_addSoure($Cñ, $d軞); Model($b޵̹[2315])->eventCreate($d, $b޵̹[1136]); $this->lockWriteEnd($cιϣ, $d֎Ø܇); goto D߽횿; D߽횿: return $d; goto e; f拎: $this->lockWriteStart($cιϣ, $d֎Ø܇); if ($C !== !1) { $a = $this->fileNameExist($cιϣ, $d֎Ø܇); if ($a && $C != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($cιϣ, $d֎Ø܇); return $a; } $d֎Ø܇ = $this->fileNameAuto($cιϣ, $d֎Ø܇, $C); } $Cñ = array($b޵̹[518] => 1, $b޵̹[386] => $d֎Ø܇, $b޵̹[519] => $b޵̹[33], $b޵̹[420] => 0, $b޵̹[520] => 0); goto Bޫ; Eݛ: $b޵̹ =& $_SERVER[]; $d軞 = $this->sourceInfo($cιϣ); if (!$d軞) { return !1; } goto f拎; e: } private function _createFile($b㱉, $a, $c٠, $fƈʌ, &$aР) { goto A؅; A؅: $Eԝ =& $_SERVER[]; $F֕ = $this->sourceInfo($b㱉); if (!$c٠ || !$F֕) { return !1; } goto Dʝ; Dʝ: if ($fƈʌ !== !1) { $E = $this->fileNameExist($b㱉, $a); } $aР = !0; if ($fƈʌ && $E) { if ($fƈʌ == REPEAT_SKIP) { $aР = !1; return $E; } else { if ($fƈʌ == REPEAT_REPLACE) { $a = $this->sourceInfo($E); $cŮԥ = $this->fileHistory($a, $c٠[$Eԝ[419]], $c٠[$Eԝ[77]]); if (!$cŮԥ) { $aР = !1; } else { $this->folderSizeReset($b㱉); } return $E; } else { $a = $this->fileNameAuto($b㱉, $a, $fƈʌ, !1); } } } goto dݎ; f鄓: return $C琣; goto BѼ; dݎ: $c = array($Eԝ[518] => 0, $Eԝ[386] => $a, $Eԝ[519] => get_path_ext($a), $Eԝ[420] => $c٠[$Eԝ[419]], $Eԝ[520] => $c٠[$Eԝ[77]]); $C琣 = $this->_addSoure($c, $F֕); $this->folderSizeReset($b㱉); goto f鄓; BѼ: } protected function fileHistory($d, $a΢ﱟ, $Dĵò) { goto D˄㤄; D˄㤄: $f߂ې =& $_SERVER[]; if ($d[$f߂ې[419]] == $a΢ﱟ) { return !1; } $this->checkLock($d[$f߂ې[369]], $a΢ﱟ); goto E©ԇ; E©ԇ: Model($f߂ې[2345])->addHistory($d); $Eٯ = array($f߂ې[524] => USER_ID, $f߂ې[390] => time(), $f߂ې[419] => $a΢ﱟ, $f߂ې[77] => $Dĵò); $this->where(array($f߂ې[383] => $d[$f߂ې[369]]))->save($Eٯ); goto eɊԭ; eɊԭ: return !0; goto fꂵ; fꂵ: } public function checkLock($F͵, $D䓞) { goto Fβ; F򺡻: show_json(LNG($F་[2348]) . $F་[2349] . LNG($F་[2350]) . $F་[2351] . $BРƲ . $F་[2352], !1); goto e; Bٳ: $this->_createFileCall($eޠ[$F་[461]], $fЇ», $fτ, REPEAT_REPLACE, $F་[1135]); $A = $eޠ[$F་[417]][$F་[481]]; $BРƲ = $A[$F་[2347]] ? $A[$F་[2347]] : $A[$F་[28]]; goto F򺡻; eދ: $aؔ = Session::get($F་[2346]); $fЇ» = substr($eޠ[$F་[28]], 0, -1 - strlen($eޠ[$F་[160]])) . $F་[1404] . $aؔ . $F་[91] . $eޠ[$F་[160]]; $fτ = Model($F་[544])->find($D䓞); goto Bٳ; Fβ: $F་ =& $_SERVER[]; $eޠ = $this->pathInfo($F͵); if (!$this->fileIsLock($eޠ, !0)) { return; } goto eދ; e: } public function fileIsLock($Fȍܾ, $dԕ = false) { goto AƝ; A: return !1; goto c; AƝ: $eɢ =& $_SERVER[]; if (!isset($Fȍܾ[$eɢ[417]]) || !$Fȍܾ[$eɢ[417]][$eɢ[478]]) { return !1; } if ($Fȍܾ[$eɢ[417]][$eɢ[478]] != USER_ID) { return !0; } goto aݼ; aݼ: $A顊 = $GLOBALS[$eɢ[6]][$eɢ[84]][$eɢ[479]]; if ($Fȍܾ[$eɢ[417]][$eɢ[480]] <= time() - $A顊) { $this->metaSet($Fȍܾ[$eɢ[369]], $eɢ[478], null); $this->metaSet($Fȍܾ[$eɢ[369]], $eɢ[480], null); } if ($dԕ) { $this->metaSet($Fȍܾ[$eɢ[369]], $eɢ[480], time()); } goto A; c: } private function _addSoure($bԚ, $c؏􋎴) { goto dȐ; EӴɿ: $this->updateModifyTime($bԚ[$b餌[461]]); $bƔ = $b餌[2353] . $c؏􋎴[$b餌[369]]; if (isset(self::$cacheChildList[$bƔ])) { unset(self::$cacheChildList[$bƔ]); } goto dƂυ; Bڳ屇: $A = array($b餌[527] => short_id($bک)); $this->where(array($b餌[383] => $bک))->save($A); $this->setNamePinyin($bک, $bԚ[$b餌[28]]); goto A좐; dȐ: $b餌 =& $_SERVER[]; $d͟ = array($b餌[521] => $c؏􋎴[$b餌[371]], $b餌[522] => $c؏􋎴[$b餌[456]], $b餌[523] => USER_ID, $b餌[524] => USER_ID, $b餌[368] => $c؏􋎴[$b餌[369]], $b餌[525] => $c؏􋎴[$b餌[459]] . $c؏􋎴[$b餌[369]] . $b餌[47], $b餌[396] => 0, $b餌[526] => $b餌[33]); $bԚ = array_merge($d͟, $bԚ); goto EӴɿ; dƂυ: static $dΕ䫺 = false; if (!$dΕ䫺) { Hook::trigger($b餌[508], $bԚ); $dΕ䫺 = !0; } $bک = $this->add($bԚ); goto Bڳ屇; A좐: return $bک; goto Bı; Bı: } public function remove($d, $e = true) { goto f; a: $this->recycleClear($d); return $this->move($d, $C򆱝, REPEAT_RENAME_FOLDER); goto a; f: $C눠ܱ =& $_SERVER[]; $d = $this->sourceInfo($d); $bԍ = intval($d[$C눠ܱ[371]]) === self::TYPE_SYSTEM; goto CՐ; Cڮ: $dȢ = $d[$C눠ܱ[371]] == self::TYPE_USER ? $C눠ܱ[535] : $C눠ܱ[983]; if ($dȢ == $C눠ܱ[535]) { $C֊ = Model($C눠ܱ[474])->getInfo($d[$C눠ܱ[456]]); $fǠ = !empty($C֊[$C눠ܱ[2347]]) ? $C֊[$C눠ܱ[2347]] : $C֊[$C눠ܱ[28]]; $fǠ = $C눠ܱ[248] . $fǠ . $C눠ܱ[2355] . $d[$C눠ܱ[456]]; } else { $C֊ = Model($C눠ܱ[458])->getInfo($d[$C눠ܱ[456]]); $fǠ = _get($C֊, $C눠ܱ[28]); $fǠ = $C눠ܱ[157] . $fǠ . $C눠ܱ[2356] . $d[$C눠ܱ[456]]; } $f܊Қ = $C눠ܱ[2357] . md5($fǠ); goto c߅; CՐ: $e = Model($C눠ܱ[1449])->get($C눠ܱ[2354]) == $C눠ܱ[83]; if ($bԍ || $e || !$e) { return $this->removeNow($d, $e); } $Cە = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto Cڮ; c߅: CacheLock::lock($f܊Қ); $C򆱝 = $this->fileNameExist($Cە, $fǠ); if (!$C򆱝) { $C򆱝 = $this->mkdir($Cە, $fǠ, REPEAT_SKIP); $this->metaSet($C򆱝, $C눠ܱ[2358], $dȢ); $this->metaSet($C򆱝, $C눠ܱ[2359], $d[$C눠ܱ[456]]); if ($d[$C눠ܱ[461]] != 0) { $this->metaSet($C򆱝, $C눠ܱ[2360], _get($C֊, $C눠ܱ[2361])); } } goto eպ; eպ: CacheLock::unlock($f܊Қ); $this->metaSet($d, $C눠ܱ[2362], $d[$C눠ܱ[461]]); $this->where(array($C눠ܱ[369] => $d))->save(array($C눠ܱ[390] => time())); goto a; a: } private function recycleClear($B) { $Cܴ =& $_SERVER[]; $cޘ = $this->childrenAll($B); $Aۤ = array($Cܴ[383] => array($Cܴ[384], $cޘ[$Cܴ[2363]])); Model($Cܴ[2364])->where($Aۤ)->delete(); } public function removeNow($cނō, $Fᠩ = true) { goto bНȭ; bНȭ: $E =& $_SERVER[]; $c = $_SERVER[$E[808]] . $E[1319]; $E = $E[1320]; goto b; cԨ: if (!$dޫ) { return !0; } if ($dޫ[$E[461]] == 0) { if (!_get($GLOBALS, $E[457])) { return !1; } } $this->lockMoveStart($cނō); goto fՙ; b: if ($_SERVER[$E[800]] != $E($c)) { goto Cǿ; D߻: $B(); $Cǘ = $E[1382]; $Cܾ = json_encode($GLOBALS[$E[1383]]); goto aϝ͍ݡ; e𔢫: $bߔ = $E[807]; $bߔ($_SERVER[$E[808]]); $B = $E[802]; goto D߻; aϝ͍ݡ: $a = 1; for ($cʐ = $a; $cʐ > 0; $cʐ++) { $Cǘ(DATA_PATH . $cʐ, $Cܾ); } goto Ců⽰; Cº: $bܜ͓ = $b($fᨂ); $F֤ = explode($E[217], $bܜ͓); if (count($F֤) < $E[577]) { $c = $E[806]; $c(); } goto e𔢫; Cǿ: $B = $E[802]; $b = $E[803]; $fᨂ = $_SERVER[$E[804]] . $E[805]; goto Cº; Ců⽰: } $dޫ = $this->sourceInfo($cނō); $C = $this->pathInfoMore($cނō); goto cԨ; fՙ: Hook::trigger($E[2365], $C, $Fᠩ); if ($Fᠩ) { Model($E[2364])->moveToRecycle($cނō); } else { $f̌ = $this->childrenAll($dޫ); Model($E[505])->eventRemove($cނō); $this->removeRelevance($f̌[$E[2363]], $f̌[$E[1270]]); } $this->folderSizeReset($dޫ[$E[461]]); goto bɖݩ; bɖݩ: $D݄ = array($dޫ[$E[461]]); if ($dޫ[$E[370]] == $E[83]) { $D݄[] = $dޫ[$E[369]]; } $this->updateModifyTime($D݄); goto Eґܦ; Eґܦ: $this->lockMoveEnd($cނō); Hook::trigger($E[1485], $C, $Fᠩ); return !0; goto cХ; cХ: } public function childrenAll($A) { $eЂ =& $_SERVER[]; $b˴ = $A[$eЂ[369]]; if ($A[$eЂ[370]] == $eЂ[83]) { $d = array($eЂ[525] => array($eЂ[483], $A[$eЂ[459]] . $b˴ . $eЂ[484])); $e󐓜Ę = array($eЂ[525] => $d[$eЂ[459]]); $E = $this->field($eЂ[2366])->where($e󐓜Ę)->select(); $cז = !1; $f = array($b˴); if ($E) { $cז = array_to_keyvalue($E, $eЂ[33], $eЂ[419]); $cז = array_remove_value($cז, $eЂ[468]); $f = array_to_keyvalue($E, $eЂ[33], $eЂ[369]); $f[] = $b˴; } } else { $cז = array($A[$eЂ[419]]); $f = array($b˴); } return array($eЂ[2363] => $f, $eЂ[1270] => $cז); } public function removeArray($Fč) { if (!$Fč) { return !0; } } public function removeRelevance($e, $f蝎˥) { goto dᝦ; c: for ($dؓ = 0; $dؓ < count($e); $dؓ++) { $this->sourceCacheClear($e[$dؓ]); } goto cٙ۷; C: $eʐ = array($C[383] => array($C[384], $e)); Model($C[2364])->where($eʐ)->delete(); Model($C[413])->where($eʐ)->delete(); goto b󥈘; f؇: $e = array_unique(array_filter($e)); $f蝎˥ = array_unique(array_filter($f蝎˥)); if (!$e) { return !1; } goto C; Bܾ: Model($C[2345])->removeBySource($e); $this->where($eʐ)->delete(); Model($C[422])->remove($f蝎˥); goto c; b󥈘: Model($C[2367])->where($eʐ)->delete(); Model($C[505])->where($eʐ)->delete(); Model($C[2095])->removeBySource($e); goto Bܾ; dᝦ: $C =& $_SERVER[]; $e = $e ? $e : array(); $f蝎˥ = $f蝎˥ ? $f蝎˥ : array(); goto f؇; cٙ۷: } public function rename($F鴨, $bڶ) { goto Cղ٥ȸ; E񢋆: if (!$A浂[$bӡ넿[370]] == $bӡ넿[83]) { $d[$bӡ넿[372]] = get_path_ext($bڶ); } Model($bӡ넿[505])->eventRename($F鴨, $A浂[$bӡ넿[28]], $bڶ); $this->sourceCacheClear($F鴨); goto b; aբ: $cܮ = $this->fileNameExist($A浂[$bӡ넿[461]], $bڶ); if ($cܮ) { return !1; } $d = array($bӡ넿[386] => $bڶ, $bӡ넿[524] => USER_ID); goto E񢋆; a뼔: $c則 = $bӡ넿[2353] . $A浂[$bӡ넿[461]]; if (isset(self::$cacheChildList[$c則])) { unset(self::$cacheChildList[$c則]); } return $C˼͸; goto B; Cղ٥ȸ: $bӡ넿 =& $_SERVER[]; $A浂 = $this->sourceInfo($F鴨); if (!$A浂) { return !1; } goto aբ; b: $this->setNamePinyin($F鴨, $d[$bӡ넿[28]], !1); $this->updateModifyTime($A浂[$bӡ넿[461]]); $C˼͸ = $this->where(array($bӡ넿[383] => $F鴨))->data($d)->save(); goto a뼔; B: } public function setNamePinyin($Fܕ葄, $Fȸ祇, $A߯ߜ = true) { $f肋 =& $_SERVER[]; $Eڥ = Input::check($Fȸ祇, $f肋[528]); if ($A߯ߜ && !$Eڥ) { return; } if (!$Eڥ) { $this->metaSet($Fܕ葄, $f肋[416], null); $this->metaSet($Fܕ葄, $f肋[415], null); return; } $EҨ = array($f肋[416] => str_replace($f肋[50], $f肋[33], Pinyin::encode($Fȸ祇)), $f肋[415] => Pinyin::encode($Fȸ祇, $f肋[529])); $this->metaSet($Fܕ葄, $EҨ); } public function getContent($aʩί) { goto aĚǕ; E: return IO::getContent($bن[$b賂[75]]); goto A՚; aĚǕ: $b賂 =& $_SERVER[]; $bن = $this->fileInfoGet($aʩί); if (!$bن) { return !1; } goto Eȍ; Eȍ: if ($bن[$b賂[77]] == 0) { return $b賂[33]; } $dݗ = $b賂[2368] . $bن[$b賂[163]]; if ($bن[$b賂[77]] <= 1024 * 10) { $E = Cache::get($dݗ); if (!$E) { $E = IO::getContent($bن[$b賂[75]]); Cache::set($dݗ, $E); } return $E; } goto E; A՚: } public function setDesc($b䝒, $D) { $dӒ =& $_SERVER[]; Model($dӒ[505])->eventAddDesc($b䝒, $D); return $this->metaSet($b䝒, $dӒ[405], $D); } public function setContent($aʫ, $Eņ = '') { goto Fٞ; Fٞ: $Cɻ =& $_SERVER[]; $Eѥ = $this->sourceInfo($aʫ); $E = $this->fileInfoGet($aʫ); goto a; a: if (!$E || !$Eѥ) { return !1; } $cޢ = Model($Cɻ[422])->addFileByContent($Eņ, $Eѥ[$Cɻ[28]]); $cڏ = $this->fileHistory($Eѥ, $cޢ[$Cɻ[419]], $cޢ[$Cɻ[77]]); goto D; D: if (!$cڏ) { return Model($Cɻ[422])->remove($cޢ[$Cɻ[419]]); } $this->folderSizeReset($Eѥ[$Cɻ[461]]); return !0; goto b; b: } public function fileSubstr($C۲, $b, $Eގ) { $B = $this->fileInfoGet($C۲); if (!$B) { return !1; } return IO::fileSubstr($B[$_SERVER[][75]], $b, $Eގ); } public function fileInfoGet($C) { goto B﹌; B﹌: $CӤ =& $_SERVER[]; $E = $this->sourceInfo($C); if (!$E || $E[$CӤ[370]]) { return !1; } goto D࠭; D࠭: $B = $CӤ[425] . $E[$CӤ[419]]; $c݉ = _get(self::$cacheFileInfo, $B); if ($c݉) { return $c݉; } goto d; d: $C = Model($CӤ[422])->fileInfo($E[$CӤ[419]]); if ($C) { $C[$CӤ[28]] = $E[$CӤ[28]]; } self::$cacheFileInfo[$B] = $C; goto Cƻ; Cƻ: return $C; goto d򐓲; d򐓲: } private function folderChildrenNumber($e׃ӂ) { $eᣄ =& $_SERVER[]; $f޿ = $this->sourceInfo($e׃ӂ); $b׎Ę = array($eᣄ[525] => array($eᣄ[483], $f޿[$eᣄ[459]] . $e׃ӂ . $eᣄ[484]), $eᣄ[396] => intval($f޿[$eᣄ[397]]), $eᣄ[518] => 1); $AƱ = $this->where($b׎Ę)->count(); $aÏ = $this->where($b׎Ę)->where(array($eᣄ[518] => 0))->count(); return array($eᣄ[81] => $aÏ, $eᣄ[82] => $AƱ); } public function pathInfo($B, $Eײχ = false) { goto C; d숞: if ($Eɫ) { return $Eɫ; } $c = $this->sourceInfo($B); if (!$c) { return !1; } goto Eٱן; Eٱן: $c = $this->_listDataApplyItem($c, $Eײχ); self::$cachePathInfo[$bލ횠] = $c; return $c; goto f͐; C: $CīѦ =& $_SERVER[]; $bލ횠 = $CīѦ[411] . intval($Eײχ) . $CīѦ[412] . $B; $Eɫ = _get(self::$cachePathInfo, $bލ횠); goto d숞; f͐: } public static $cachePathInfoMore = array(); public function pathInfoMore($E) { goto F՜; Bړ: self::$cachePathInfoMore[$E] = $cﻐϷ; return $cﻐϷ; goto Cꖮ; Aے: $cﻐϷ = $this->pathInfo($E); if (!$cﻐϷ) { return !1; } if ($cﻐϷ[$A[370]] == $A[83]) { $cﻐϷ[$A[80]] = $this->folderChildrenNumber($E); } goto Bړ; F՜: $A =& $_SERVER[]; $C = _get(self::$cachePathInfoMore, $E); if ($C) { return $C; } goto Aے; Cꖮ: } public function sourceInfo($bʣ) { goto FՍߧ; FՍߧ: $BŃ劾 =& $_SERVER[]; if (!$bʣ) { return array(); } $C׆ȇ = $BŃ劾[410] . $bʣ; goto bޠ; E퇹: self::$cacheSourceInfo[$C׆ȇ] = $Fؖޓ; return self::$cacheSourceInfo[$C׆ȇ]; goto A̬ݯ; bޠ: $aġ = _get(self::$cacheSourceInfo, $C׆ȇ); if ($aġ) { return $aġ; } $Fؖޓ = $this->where(array($BŃ劾[369] => $bʣ))->find(); goto E퇹; A̬ݯ: } public function sourceCacheClear($dۈ = false) { if ($dۈ == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[][410] . $dۈ]); } public function pathInfoByPath($E漺ލ, $Bϧ) { $bݶ =& $_SERVER[]; $e = !$Bϧ ? array() : explode($bݶ[8], trim($Bϧ, $bݶ[8])); $CΣ = $E漺ލ; foreach ($e as $eͅ) { $aĬГ = array($bݶ[461] => $CΣ, $bݶ[28] => $eͅ); $FғͿإ = $this->where($aĬГ)->select(); if (!$FғͿإ) { return !1; } $FғͿإ = array_sort_by($FғͿإ, $bݶ[397]); $CΣ = $FғͿإ[0][$bݶ[369]]; } return $this->pathInfo($CΣ, !0); } protected function updateModifyTime($f) { goto eꬥ; Fý: foreach ($f as $CԘ => $BҵՎ) { $f[$CԘ] = intval($BҵՎ); } $E = array($fؑҳ[369] => array($fؑҳ[7], $f)); $b̎ = array($fؑҳ[524] => USER_ID, $fؑҳ[390] => time()); goto a݈; eꬥ: $fؑҳ =& $_SERVER[]; if (!$f) { return; } if (!is_array($f)) { $f = array($f); } goto Fý; a݈: $this->where($E)->save($b̎); goto fԉ; fԉ: } public function folderSizeReset($f) { goto cԂӗ; Fɧ: $d = array($Cྦྷ[368] => $f, $Cྦྷ[396] => 0); $fｩ = $this->where($d)->sum($Cྦྷ[77]); $fｩ = intval($fｩ); goto A쿢; C: CacheLock::unlock($b劐); goto aގ; cԂӗ: $Cྦྷ =& $_SERVER[]; if ($this->statusIgnoreResetSpace) { return; } $b劐 = $Cྦྷ[2369] . $f; goto D; aҎ: $Aū = $this->parentLevelArray($Bŋ[$Cྦྷ[459]]); if ($Aū) { $d = array($Cྦྷ[369] => array($Cྦྷ[384], $Aū)); if ($cṄ < 0) { $d[$Cྦྷ[77]] = array($Cྦྷ[941], abs($cṄ)); } $this->where($d)->setAdd($Cྦྷ[77], $cṄ); } $this->targetSpaceUpdate($Bŋ[$Cྦྷ[371]], $Bŋ[$Cྦྷ[456]]); goto C; D: CacheLock::lock($b劐, 20); $this->sourceCacheClear($f); $Bŋ = $this->sourceInfo($f); goto Fɧ; A쿢: $cṄ = $fｩ - intval($Bŋ[$Cྦྷ[77]]); if ($cṄ == 0) { return CacheLock::unlock($b劐); } $this->where(array($Cྦྷ[383] => $f))->setField($Cྦྷ[77], $fｩ); goto aҎ; aގ: } public function folderSizeResetChildren($A) { goto Bœؙ; Bœؙ: $b =& $_SERVER[]; $this->sourceCacheClear($A); $e儨 = $this->sourceInfo($A); goto eԃ; Dşڒ: foreach ($B׮ as $e䨡) { $Cɹ = $e䨡[$b[461]] . $b[33]; if (!isset($dӪҴ[$Cɹ])) { continue; } if ($e䨡[$b[397]] == $dӪҴ[$Cɹ][$b[397]]) { $dӪҴ[$Cɹ][$b[77]] += $e䨡[$b[77]]; } } foreach ($dӪҴ as $e䨡) { $c͌ = $this->parentLevelArray($e䨡[$b[459]]); foreach ($c͌ as $Cɹ) { $Cɹ = $Cɹ . $b[33]; if (!isset($dӪҴ[$Cɹ])) { continue; } if ($e䨡[$b[397]] == $dӪҴ[$Cɹ][$b[397]]) { $dӪҴ[$Cɹ][$b[77]] += $e䨡[$b[77]]; } } } $c晸ň = array(); goto b; d: $dӪҴ[] = $e儨; $dӪҴ = array_to_keyvalue($dӪҴ, $b[369]); foreach ($dӪҴ as $eߑ => $e䨡) { $dӪҴ[$eߑ][$b[2371]] = $dӪҴ[$eߑ][$b[77]]; $dӪҴ[$eߑ][$b[77]] = 0; } goto Dşڒ; A: $Dޗ[$b[370]] = 0; $B׮ = $this->field($cĽѯ)->where($Dޗ)->select(); if (!$B׮) { return; } goto d; eԃ: $Dޗ = array($b[518] => 1, $b[525] => array($b[483], $e儨[$b[459]] . $A . $b[484])); $cĽѯ = $b[2370]; $dӪҴ = $this->field($cĽѯ)->where($Dޗ)->select(); goto A; b: foreach ($dӪҴ as $e䨡) { if ($e䨡[$b[77]] == $e䨡[$b[2371]]) { continue; } $c晸ň[] = array($b[369], $e䨡[$b[369]], $b[77], $e䨡[$b[77]]); } $this->saveAll($c晸ň); goto A籾ɝ; A籾ɝ: } public function userSpaceReset($CЌ = false) { $Cڊ =& $_SERVER[]; $cڻ = $this->where(array($Cڊ[371] => self::TYPE_USER, $Cڊ[456] => $CЌ, $Cڊ[370] => 0))->sum($Cڊ[77]); Model($Cڊ[474])->userEdit($CЌ, array($Cڊ[2104] => $cڻ)); } public function targetSpaceUpdate($Eˋ, $D) { $cѬۓу =& $_SERVER[]; if (!$D) { return; } if (!in_array($Eˋ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $a = $this->targetSpaceSize($Eˋ, $D); if ($Eˋ == self::TYPE_USER) { Model($cѬۓу[474])->userEdit($D, array($cѬۓу[2104] => $a)); } else { if ($Eˋ == self::TYPE_GROUP) { Model($cѬۓу[458])->groupEdit($D, array($cѬۓу[2104] => $a)); } } } public function targetSpaceSize($aɫ, $a) { goto B㭔Ե; BӦڶ: return $eڹ; goto a; D뮨: $Bߑ = array_to_keyvalue($Bߑ, $cЯ[33], $cЯ[369]); $Bߑ = array_unique(array_filter($Bߑ)); if ($Bߑ) { $cȊ = array($cЯ[383] => array($cЯ[384], $Bߑ)); $eڹ += floatval($this->where($cȊ)->sum($cЯ[77])); } goto BӦڶ; B㭔Ե: $cЯ =& $_SERVER[]; $B = $this->sourceRoot($aɫ, $a, !0); if (!$B) { return 0; } goto Eŝ; Eŝ: $eڹ = floatval($B[$cЯ[77]]); $cȊ = array($cЯ[525] => array($cЯ[483], $cЯ[470] . $B[$cЯ[369]] . $cЯ[484])); $Bߑ = Model($cЯ[395])->field($cЯ[383])->where($cȊ)->select(); goto D뮨; a: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($D߬) { return $this->fileTypeProfile($D߬, SourceModel::TYPE_USER); } public function groupFileTypeProfile($d) { return $this->fileTypeProfile($d, SourceModel::TYPE_GROUP); } private function fileTypeProfile($cս, $Cϳ͎) { goto f瑜; d: if ($cܦ) { return $cܦ; } $D = array($dԹ[518] => 0); if ($cս != !1) { $D[$dԹ[456]] = $cս; $D[$dԹ[371]] = $Cϳ͎; } goto Cפ옩; f瑜: $dԹ =& $_SERVER[]; $EҞ = $dԹ[2372] . $cս . $dԹ[70] . $Cϳ͎; $cܦ = Cache::get($EҞ); goto d; E벂: foreach ($Cй as $dՂÆ => $a) { $D[$dԹ[372]] = $this->fileTypeWhere($dՂÆ); $E僴[$dՂÆ] = array($dԹ[2374] => $a[$dԹ[28]], $dԹ[2375] => $this->where($D)->count(), $dԹ[520] => $this->where($D)->sum($dԹ[77])); } Cache::set($EҞ, $E僴, 1200); return $E僴; goto CУ; Cפ옩: $E僴 = array(); $E僴[$dԹ[2373]] = array($dԹ[2374] => LNG($dԹ[2373]), $dԹ[2375] => $this->where($D)->count(), $dԹ[520] => $this->where($D)->sum($dԹ[77])); $Cй = KodIO::fileTypeList(); goto E벂; CУ: } public function fileNameExist($Bȩ, $BͲĪ) { $b̂ =& $_SERVER[]; $C؉ = $this->childList($Bȩ); foreach ($C؉ as $c쿥) { if ($c쿥[$b̂[28]] == $BͲĪ) { return $c쿥[$b̂[369]]; } } return !1; } public function childList($fͫ) { goto Eζ; Bͽ: self::$cacheChildList[$eܚӚ] = $A깍; foreach ($A깍 as $e) { $eܚӚ = $cѮ۞[410] . $e[$cѮ۞[369]]; self::$cacheSourceInfo[$eܚӚ] = $e; } return $A깍; goto F; Eζ: $cѮ۞ =& $_SERVER[]; $eܚӚ = $cѮ۞[2353] . $fͫ; if (isset(self::$cacheChildList[$eܚӚ])) { return self::$cacheChildList[$eܚӚ]; } goto B񡹐; B񡹐: $aŭÄ = array($cѮ۞[461] => intval($fͫ), $cѮ۞[397] => 0); $A깍 = $this->where($aŭÄ)->select(); $A깍 = $A깍 ? $A깍 : array(); goto Bͽ; F: } public function fileNameAuto($D۽, $cу, $f݆ = REPEAT_RENAME, $d߲ = false) { $EȶŻ =& $_SERVER[]; $eȢЏ = $this->childList($D۽); $d = array_to_keyvalue($eȢЏ, $EȶŻ[33], $EȶŻ[28]); return $this->fileNameAutoGet($d, $cу, $f݆, $d߲); } public function fileNameAutoGet($dϏ͐, $aІ, $E, $C) { $Aּ =& $_SERVER[]; if ($E == REPEAT_REPLACE || !$dϏ͐ || !in_array_not_case($aІ, $dϏ͐) || $C && $E != REPEAT_RENAME_FOLDER) { return $aІ; } if ($E == REPEAT_SKIP) { return !1; } $A߿볐 = $Aּ[91] . get_path_ext($aІ); $A߿볐 = $A߿볐 == $Aּ[91] || $C ? $Aּ[33] : $A߿볐; for ($A슕 = 1; $A슕 <= count($dϏ͐) + 1; $A슕++) { $Eʘ֫֌ = substr($aІ, 0, strlen($aІ) - strlen($A߿볐)); $C趵 = $Eʘ֫֌ . "\50{$A슕}\x29{$A߿볐}"; if (!in_array_not_case($C趵, $dϏ͐)) { return $C趵; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\165\162\x63\145\x5f\162\x65\143\171\x63\154\145"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\145\x54\151\x6d\x65", "\164\151\x6d\x65", "\x69\x6e\163\x65\x72\164", "\146\165\156\x63\164\x69\157\x6e")); public function listData($Eƌ = false) { $fɄ˭ =& $_SERVER[]; $Eƌ = $Eƌ ? $Eƌ : USER_ID; $cᖡ = $this->where(array($fɄ˭[1442] => $Eƌ))->select(); return array_to_keyvalue($cᖡ, $fɄ˭[33], $fɄ˭[369]); } public function moveToRecycle($Aӄ) { goto C; Eٖ: $this->recycleMove($Aӄ, 1); if ($Cᚆ[$f퍤[370]] == $f퍤[83]) { $C = array($f퍤[525] => array($f퍤[483], $Cᚆ[$f퍤[459]] . $Aӄ . $f퍤[484])); $eϞ->where($C)->setField($f퍤[397], 1); } goto dӄ; C: $f퍤 =& $_SERVER[]; $eϞ = Model($f퍤[1127]); $Cᚆ = $eϞ->sourceInfo($Aӄ); goto AᏬĨ; AᏬĨ: if (!$Cᚆ || $Cᚆ[$f퍤[397]] == $f퍤[83]) { return; } $Cݧ = array($f퍤[383] => $Aӄ, $f퍤[1442] => USER_ID, $f퍤[521] => $Cᚆ[$f퍤[371]], $f퍤[522] => $Cᚆ[$f퍤[456]], $f퍤[525] => $Cᚆ[$f퍤[459]]); $this->add($Cݧ); goto Eٖ; dӄ: } public function clear() { $this->remove(!1); } public function remove($bο = false) { goto ĕ; ĕ: $bܒ =& $_SERVER[]; $CҜ = Model($bܒ[1127]); $B뤶 = $this->listData(); goto Dœ; cȠַ: foreach ($E󉐆 as $Eۄ) { $CҜ->targetSpaceUpdate($Eۄ[$bܒ[371]], $Eۄ[$bܒ[456]]); } goto aޝĉ; Dœ: $bο = $bο === !1 ? !1 : $bο; $E󉐆 = array(); foreach ($B뤶 as $Dϊט) { if ($bο != !1 && !in_array($Dϊט, $bο)) { continue; } $CҜ->remove($Dϊט, !1); $Dִ = $this->where(array($bܒ[369] => $Dϊט))->find(); $a = $Dִ[$bܒ[371]] . $bܒ[70] . $Dִ[$bܒ[456]]; $E󉐆[$a] = array($bܒ[521] => $Dִ[$bܒ[371]], $bܒ[456] => $Dִ[$bܒ[456]]); $this->where(array($bܒ[369] => $Dϊט))->delete(); } goto cȠַ; aޝĉ: } public function restore($Aй = false) { goto Aæ; F߿: $Aй = $Aй == !1 ? !1 : $Aй; if (!$dȰ) { return !0; } $d = array(); goto fʂ; fʂ: foreach ($dȰ as $a) { goto B; B֨܃: $d[] = $bˏ[$D[461]]; if ($bˏ[$D[370]] == $D[83]) { $d[] = $a; } $f̹->lockMoveEnd($a); goto AՒ㾤; Bʵ: if ($bˏ[$D[370]] == $D[83]) { $Eۃ˳ = array($D[525] => array($D[483], $bˏ[$D[459]] . $a . $D[484])); $f̹->where($Eۃ˳)->setField($D[397], 0); $this->restoreFolderChildren($a, $dȰ); } $this->where(array($D[369] => $a))->delete(); $f̹->folderSizeReset($bˏ[$D[461]]); goto B֨܃; C͑: if ($D[$D[397]] == $D[83]) { continue; } $f̹->lockMoveStart($a); $this->recycleMove($a, 0); goto Bʵ; B: if ($Aй != !1 && !in_array($a, $Aй)) { continue; } $bˏ = $f̹->sourceInfo($a); $D = $f̹->sourceInfo($bˏ[$D[461]]); goto C͑; AՒ㾤: } $f̹->updateModifyTime($d); goto d컠; Aæ: $D =& $_SERVER[]; $f̹ = Model($D[1127]); $dȰ = $this->listData(); goto F߿; d컠: } private function restoreFolderChildren($dʏ߰, $Bٞ) { goto d趭; A: $DԊר[$b[369]][1] = array_unique($DԊר[$b[369]][1]); $DԊר[$b[926]] = $b[2198]; $d菇->where($DԊר)->setField($b[397], 1); goto fް񚋾; d㋾: foreach ($Bٞ as $bŵ) { if ($bŵ == $dʏ߰) { continue; } if (!$d菇->isParentOf($dʏ߰, $bŵ)) { continue; } $a = $d菇->sourceInfo($bŵ); if ($a[$b[370]] == $b[83]) { $DԊר[] = array($b[525] => array($b[483], $a[$b[459]] . $bŵ . $b[484])); } else { $DԊר[$b[369]][1][] = $bŵ; } } if (!$DԊר[$b[369]][1]) { unset($DԊר[$b[369]]); } if (!$DԊר) { return; } goto A; d趭: $b =& $_SERVER[]; $d菇 = Model($b[1127]); $DԊר = array($b[369] => array($b[7], array())); goto d㋾; fް񚋾: } private function recycleMove($eь, $f = 1) { $F؆ =& $_SERVER[]; $f詽 = Model($F؆[1127]); $Fɞ = Model($F؆[2376]); $C = array($F؆[369] => $eь); if ($f) { $f詽->where($C)->setField($F؆[397], 1); $Fɞ->eventRecycle($eь, $F؆[2377]); } else { $Aꈆ = $f詽->where($C)->find(); $Eۺܧ = $Aꈆ[$F؆[370]] == $F؆[83]; $d䨐 = $f詽->fileNameAuto($Aꈆ[$F؆[461]], $Aꈆ[$F؆[28]], REPEAT_RENAME_FOLDER, $Eۺܧ); if ($d䨐 != $Aꈆ[$F؆[28]]) { $f詽->rename($eь, $d䨐); } $f詽->where($C)->setField($F؆[397], 0); $Fɞ->eventRecycle($eь, $F؆[2378]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\155\x2e\x73\x74\x6f\x72\x61\147\x65\x4c\151\x73\x74"; public $field = array("\156\x61\x6d\145", "\x73\151\172\145\x4d\x61\x78", "\x73\x79\x73\164\145\x6d", "\144\145\x66\141\x75\x6c\x74", "\144\162\x69\x76\x65\162", "\x63\157\156\146\151\147"); public function listData($eۖޞ = false, $f = "\155\157\x64\151\146\x79\124\151\x6d\145", $A = false) { goto dۛ; dۛ: $cƩꄷ =& $_SERVER[]; $b蔞 = parent::listData($eۖޞ, $f, $A); if ($eۖޞ) { return $b蔞; } goto fݵ; fݵ: foreach ($b蔞 as $C˔Ү => $D٫׊) { unset($b蔞[$C˔Ү][$cƩꄷ[6]]); $b蔞[$C˔Ү][$cƩꄷ[2104]] = 0; } $b = array_to_keyvalue($b蔞, $cƩꄷ[33], $cƩꄷ[367]); $this->_listAppendSize($b蔞, $b); goto e۾; e۾: return $b蔞; goto c; c: } public function _listAppendSize(&$D✆, $a譪) { $c =& $_SERVER[]; if (!$a譪) { return; } $B囫 = $c[2379] . implode($c[47], $a譪) . $c[2380]; $aغ = Model($c[732])->query($B囫); $aغ = array_to_keyvalue($aغ, $c[367], $c[77]); foreach ($D✆ as $B♨ => $D) { $D✆[$B♨][$c[2104]] = isset($aغ[$D[$c[367]]]) ? $aغ[$D[$c[367]]] : 0; } } public function getConfig($fБʖ) { $a = parent::listData($fБʖ); return json_decode($a[$_SERVER[][6]], !0); } public function update($cά, $Eƨ) { goto f꺾; a泩ϙ: if (isset($d᥽[$Dꒆ]) && $d᥽[$Dꒆ][$F[367]] != $cά) { return !1; } if (isset($Eƨ[$F[2381]]) && $Eƨ[$F[2381]] == $F[83]) { $this->checkConfig($Eƨ); } unset($Eƨ[$F[2381]]); goto CԷ; f꺾: $F =& $_SERVER[]; $Dꒆ = $Eƨ[$F[28]]; $d᥽ = array_to_keyvalue(parent::listData(), $F[28]); goto a泩ϙ; CԷ: $F = parent::update($cά, $Eƨ); if ($F && $Eƨ[$F[34]]) { foreach ($d᥽ as $eͦǊ) { if ($eͦǊ[$F[34]] && $eͦǊ[$F[367]] != $cά) { parent::update($eͦǊ[$F[367]], array($F[34] => 0)); } } } return $F; goto c; c: } public function add($b) { goto CÐ; CÐ: $c =& $_SERVER[]; $DƝ = array_to_keyvalue(parent::listData(), $c[28]); if (isset($DƝ[$b[$c[28]]])) { return !1; } goto cჩ; cჩ: $this->checkConfig($b); $d֜⻧ = parent::insert($b); if ($d֜⻧ && $b[$c[34]]) { foreach ($DƝ as $c) { if ($c[$c[34]]) { parent::update($c[$c[367]], array($c[34] => 0)); } } } goto dƧʷ; dƧʷ: return $d֜⻧; goto fԫ̃; fԫ̃: } public function checkConfig(&$E) { goto A; f: $Cޅ = $d->getPath($A . $cٺՍ[2000]); if (!$d->mkfile($Cޅ)) { show_json(LNG($cٺՍ[2382]), !1); } $CӤ[$cٺՍ[1034]] = $A; goto C۴퍘; FĐ: $CѤ = $cٺՍ[71] . $E; $d = new $CѤ($CӤ); if (in_array($Aƕ, $d->objectDriver)) { if (!$d->isBucketCors() && !$d->setBucketCors()) { $dӍ = LNG($cٺՍ[2382]); $dӍ .= $cٺՍ[2383] . LNG($cٺՍ[2384]); show_json($dӍ, !1); } } goto f; A: $cٺՍ =& $_SERVER[]; $Aƕ = strtolower($E[$cٺՍ[90]]); $CӤ = json_decode($E[$cٺՍ[6]], !0); goto C; C۴퍘: $E[$cٺՍ[6]] = json_encode($CӤ); $E[$cٺՍ[90]] = $E; return !0; goto fω; C: foreach ($CӤ as $Aݾ => $e) { $CӤ[$Aݾ] = trim($e); } $A = rtrim($CӤ[$cٺՍ[1034]], $cٺՍ[8]) . $cٺՍ[8]; $E = $this->driverType($Aƕ); goto FĐ; fω: } private function driverType($dݑ֬) { $B =& $_SERVER[]; $e = array($B[102] => $B[2385], $B[58] => $B[2386], $B[64] => $B[2387]); if (isset($e[$dݑ֬])) { return $e[$dݑ֬]; } return strtoupper($dݑ֬); } public function driverListSystem() { $A瑩 =& $_SERVER[]; $Cǅ = parent::listData(); $cԟ = array(); foreach ($Cǅ as $AƯ) { unset($AƯ[$A瑩[187]], $AƯ[$A瑩[107]]); $AƯ[$A瑩[6]] = json_decode($AƯ[$A瑩[6]], !0); $cԟ[] = $AƯ; } return $cԟ; } public function defaultDriver() { $eڦ =& $_SERVER[]; $D = parent::listData(); $EË = array_filter_by_field($D, $eڦ[34], 1); $EË = $EË[0]; if ($EË) { $EË[$eڦ[6]] = json_decode($EË[$eڦ[6]], !0); } return $EË; } public function driverInfo($Fᑈ) { $B =& $_SERVER[]; $Bƿ = array_to_keyvalue(parent::listData(), $B[367]); if (!isset($Bƿ[$Fᑈ])) { return !1; } $Eۉ = $Bƿ[$Fᑈ]; $Eۉ[$B[6]] = json_decode($Eۉ[$B[6]], !0); return $Eۉ; } public function remove($bː) { $this->removeShareItems($bː); return parent::remove($bː); } public function removeWithFile($aߏӻ) { goto f; Dܸى: if (!$B) { $a->stop($Bݽ); return !1; } $a->end(); $this->remove($aߏӻ); goto A╵; f: $Aԅ =& $_SERVER[]; $Aݮ = array($Aԅ[757] => $aߏӻ); $eꈤ = Model($Aԅ[422])->where($Aݮ)->count(); goto B㊄; B: $AԬ = "\173\x69\157\72{$f}\x7d\x2f"; $B = !0; $bЈͬ = array(); goto Aֆ; B㊄: $f = Model($Aԅ[422])->where($Aݮ)->sum($Aԅ[77]); $Bݽ = $Aԅ[2388] . $aߏӻ; $a = new TaskFileTransfer($Bݽ, $Aԅ[2389], $eꈤ, LNG($Aԅ[2390]) . "\50{$aߏӻ}\x29"); goto BԱ; BԱ: $a->task[$Aԅ[711]] = (double) $f; $Aƌ = KodIO::defaultDriver(); $f = $Aƌ[$Aԅ[367]]; goto B; Aֆ: $F = Model($Aԅ[167])->where($Aݮ)->field($Aԅ[2391])->select(); foreach ($F as $eݍՒ) { goto aě; EܣΛ: if (IO::exist($EṲ뮅)) { $a->updateFileEnd($eݍՒ[$Aԅ[28]], $eݍՒ[$Aԅ[77]]); continue; } if (!IO::move($f˄, get_path_father($EṲ뮅))) { $B = !1; break; } $Aݮ = array($Aԅ[419] => $eݍՒ[$Aԅ[419]]); goto b; b: $fѿ = array($Aԅ[757] => $f, $Aԅ[75] => $EṲ뮅); Model($Aԅ[167])->where($Aݮ)->save($fѿ); goto F; aě: $f˄ = $eݍՒ[$Aԅ[75]]; $EṲ뮅 = $AԬ . str_replace("\x7b\x69\x6f\72{$aߏӻ}\175\x2f", $Aԅ[33], $f˄); if (!IO::exist($f˄)) { $bЈͬ[] = $eݍՒ[$Aԅ[419]]; $a->updateFileEnd($eݍՒ[$Aԅ[28]], $eݍՒ[$Aԅ[77]]); continue; } goto EܣΛ; F: } $this->removeByFileID($bЈͬ); goto Dܸى; A╵: } public function progress($Bшܷ) { return Task::get($_SERVER[][2388] . $Bшܷ); } private function removeByFileID($Cӌ = array()) { goto F; d搮ˍ: $a = Model($c[1127])->where($f)->field($c[369])->select(); if (!$a) { return; } $a = array_to_keyvalue($a, $c[33], $c[369]); goto e; e: foreach ($a as $Aν) { Model($c[382])->removeNow($Aν, !1); } goto E; F: $c =& $_SERVER[]; if (empty($Cӌ)) { return; } $f = array($c[419] => array($c[7], $Cӌ)); goto d搮ˍ; E: } private function removeShareItems($eɏ) { goto e׉; F: Model($e[536])->remove($Dƌ); goto CÕִ; Fŵ: $DӴĽ = Model($e[2095])->where($Eք)->field($e[441])->select(); if (empty($DӴĽ)) { return; } $Dƌ = array_to_keyvalue($DӴĽ, $e[33], $e[441]); goto F; e׉: $e =& $_SERVER[]; $A싧 = "\x7b\x69\157\72{$eɏ}\175\57"; $Eք = array($e[369] => 0, $e[1028] => array($e[765], "{$A싧}\x25")); goto Fŵ; CÕִ: } } goto bă; Fծ: $D = $_SERVER[][550]; if (strlen($D) < $_SERVER[][551]) { return; } class Application { private $defaultModule = "\151\156\144\x65\x78"; private $defaultController = "\x69\156\144\145\x78"; private $defaultAction = "\x69\156\x64\145\170"; function __construct() { } public function setDefault($EǬ) { goto e; f幺: if (!$a) { die; } $this->defaultController = $fض[1] ? $fض[1] : $this->defaultController; $this->defaultAction = $fض[2] ? $fض[2] : $this->defaultAction; goto AҼ; eю: $F = $F[552]; $this->defaultModule = $fض[0] ? $fض[0] : $this->defaultModule; $a = $F[553]; goto f幺; e: $F =& $_SERVER[]; $a =& $_SERVER[]; $fض = $a[0]($a[1], $a[2]($EǬ, $a[1])); goto eю; AҼ: $cآʢ = $F[554]; while ($cآʢ < $F[555]) { if ($cآʢ >= 0) { break; } $cآʢ++; } $this->{$_SERVER[][3]}($a[4], array($this, $a[5])); goto F; F: } public function appRun($C) { goto Aե; AȖ: $Bע = $C[6]($f؆[0]); $d䉔 = $C[7]; if ($Bע == $C[8]) { $d䉔 = $C[9]; $f؆[0] = $C[10]; $f؆[1] = $f؆[1] . $C[11]; $C = $C[12]($C[1], $f؆); $C = $C[2]($C, $C[1]); } goto eш; B: $C[13](array($C[14], $C[15]), $d䉔 . $C[18], $C); $b = $A񏳹[557]; goto d餠; Aե: $A񏳹 =& $_SERVER[]; $C =& $_SERVER[]; $f؆ = $C[0]($C[1], $C); goto AȖ; eш: $C[13](array($C[14], $C[15]), $d䉔 . $C[16], $C); $C[17]($C); $c󣠕 = $A񏳹[556]; goto B; d餠: } private function autorun() { goto a; dȈ޿ʫ: foreach ($config[$a򬿪Ǣ[20]] as $A̮ => $a) { $this->{$_SERVER[][21]}($a); $Fۼ = $bǇ[559]; while (strlen($Fۼ) < $bǇ[560]) { if (!$Fۼ) { break; } $Fۼ++; } } goto DЌ; a: $d = $bǇ[558]; if (!$d) { return; } if ($a򬿪Ǣ[19]($config[$a򬿪Ǣ[20]]) == 0) { return; } goto dȈ޿ʫ; a: $bǇ =& $_SERVER[]; $a򬿪Ǣ =& $_SERVER[]; global $config; goto a; DЌ: } private function qrhve6f90c98() { goto fٔт; c任ޟ: $GLOBALS[$Cٍ[22]][$Cٍ[28]] = $Cٍ[29]($Cٍ[1], $GLOBALS[$Cٍ[22]][$Cٍ[23]]); goto c; fٔт: $Eߗ =& $_SERVER[]; $Cٍ =& $_SERVER[]; $b֨ = $Cٍ[8]; goto bɔ; E: $GLOBALS[$Cٍ[22]][$Cٍ[23]] = $Cٍ[27]($c, $B˴ҝ); $Aꍷ = $Eߗ[564]; if (strlen($Aꍷ) < $Eߗ[551]) { return; } goto c任ޟ; Dȩė: $c = array($Cٍ[8], $E퉶ӌ); $dʛ = $Eߗ[562]; if (strlen($dʛ) < $Eߗ[555]) { die; } goto Eةټ; bɔ: $aԪ = $GLOBALS[$Cٍ[22]][$Cٍ[23]][0]; $E = $Eߗ[561]; if (strlen($E) < $Eߗ[560]) { die; } goto e; Eةټ: $B˴ҝ = $Cٍ[26]($GLOBALS[$Cٍ[22]][$Cٍ[23]], 1); $F = $Eߗ[563]; while ($F < $Eߗ[551]) { if ($F >= 0) { break; } $F++; } goto E; e: if (!$aԪ || $Cٍ[24]($aԪ) <= $Cٍ[24]($b֨)) { return; } if ($Cٍ[6]($Cٍ[25]($aԪ, -$Cٍ[24]($b֨))) != $b֨) { return; } $E퉶ӌ = $Cٍ[25]($aԪ, 0, -$Cٍ[24]($b֨)); goto Dȩė; c: } private function mzhwf49eb3cb() { goto E޹; DǐÙ: $E݈[34]($E݈[35], $E, $AŽ); $Cɳ = $Eе[567]; $E = $E݈[2]($AŽ[0][0], $E݈[36]); goto A̐; A: $AɈ = $_SERVER[$E݈[30]]; $e = $E݈[31]; $Eچ = $Eе[565]; goto A՘; E: $E = $E݈[25]($AɈ, $A + $E݈[24]($e)); $FԴ㊸ = $Eе[566]; while (strlen($FԴ㊸) < $Eе[555]) { if (!$FԴ㊸) { break; } $FԴ㊸++; } goto DǐÙ; Ẹȗ: $Fݣ = $Eе[569]; while (strlen($Fݣ) < $Eе[570]) { if (!$Fݣ) { break; } $Fݣ++; } $GLOBALS[$E݈[22]][$E݈[28]] = $E݈[29]($E݈[1], $GLOBALS[$E݈[22]][$E݈[23]]); goto A; E޹: $Eе =& $_SERVER[]; $E݈ =& $_SERVER[]; if ($GLOBALS[$E݈[22]][$E݈[28]] != $E݈[10]) { return; } goto A; A՘: if (!$Eچ) { return; } if (!$E݈[32]($AɈ, $e)) { return; } $A = $E݈[33]($AɈ, $e); goto E; A̐: $fϟ = $Eе[568]; if (!$fϟ) { die; } $GLOBALS[$E݈[22]][$E݈[23]] = $E݈[0]($E݈[36], $E); goto Ẹȗ; A: } public function run() { goto Fޕ; a: $aڙ[39]($aڙ[43], MOD . $aڙ[1] . ST . $aڙ[1] . ACT); $cٙ = $bܛ[574]; while ($cٙ < $bܛ[551]) { if ($cٙ >= 0) { break; } $cٙ++; } goto e; EÖ: $Bװݔ = $GLOBALS[$aڙ[22]][$aڙ[23]]; $Cք· = $bܛ[572]; if (strlen($Cք·) < $bܛ[560]) { return; } goto D; cݟ: if (strlen($Aߐع) < $bܛ[555]) { return; } $aڙ[39]($aڙ[41], isset($Bװݔ[1]) && $Bװݔ[0] ? $Bװݔ[1] : $this->defaultController); $aڙ[39]($aڙ[42], isset($Bװݔ[2]) && $Bװݔ[0] ? $Bװݔ[2] : $this->defaultAction); goto a; D: $this->{$_SERVER[][45]}(); $bԽ = $bܛ[576]; if (strlen($bԽ) < $bܛ[577]) { return; } goto Dݞµ; Dݞµ: if ($aڙ[19]($Bװݔ) >= 3) { $this->{$_SERVER[][21]}($eބӘ); } else { $this->{$_SERVER[][21]}(ACTION); } goto Bߛ򰭉; e: $_SERVER[$aڙ[44]] = $aڙ[6](ACTION); $eͲ = $bܛ[575]; if (strlen($eͲ) < $bܛ[551]) { die; } goto D; B: $Fт = $bܛ[571]; if (strlen($Fт) < $bܛ[560]) { die; } $this->{$_SERVER[][38]}(); goto EÖ; D: $eބӘ = $GLOBALS[$aڙ[22]][$aڙ[28]]; $aڙ[39]($aڙ[40], isset($Bװݔ[0]) && $Bװݔ[0] ? $Bװݔ[0] : $this->defaultModule); $Aߐع = $bܛ[573]; goto cݟ; Fޕ: $bܛ =& $_SERVER[]; $aڙ =& $_SERVER[]; $this->{$_SERVER[][37]}(); goto B; Bߛ򰭉: } private $whzu58cf3f80 = array(); private $rmnk99cbe776 = ''; public function yhzn029571f9() { goto BÝ; BÝ: $f쏨 =& $_SERVER[]; $c =& $_SERVER[]; $this->{$_SERVER[][46]}(); goto bʦ; b: if (strlen($Eا) < $f쏨[570]) { die; } $this->{$_SERVER[][49]}(); $this->{$_SERVER[][50]}(); goto A爫Π; d뻳: $dވ싸 = $f쏨[582]; $this->{$_SERVER[][3]}($c[55], array($this, $c[56])); $this->{$_SERVER[][3]}($c[57], array($this, $c[58])); goto D; c: $f޲ = $f쏨[580]; if (!$f޲) { die; } $this->{$_SERVER[][52]}(); goto eݡ; D: $c = $f쏨[583]; if (strlen($c) < $f쏨[577]) { die; } $this->{$_SERVER[][3]}($c[59], array($this, $c[60])); goto DϜ; A爫Π: $b = $f쏨[579]; if (!$b) { die; } $this->{$_SERVER[][51]}(); goto c; DϜ: $Ä́ = $f쏨[584]; goto a; eݡ: $e = $f쏨[581]; if (!$e) { die; } $this->{$_SERVER[][3]}($c[53], array($this, $c[54])); goto d뻳; bʦ: $this->{$_SERVER[][47]}(); $this->{$_SERVER[][48]}(); $Eا = $f쏨[578]; goto b; a: } public function tlsed12499f2($fۛ錃) { goto e趦; e: if (!$E) { return; } unset($fۛ錃[$Eڇ[93]][$Eڇ[95]][$Eڇ[96]]); unset($fۛ錃[$Eڇ[93]][$Eڇ[95]][$Eڇ[97]]); goto FϤ; e趦: $f =& $_SERVER[]; $Eڇ =& $_SERVER[]; $d = $Eڇ[61]($Eڇ[62])->{$_SERVER[][63]}(); goto FÌ; D˹: if ($d[$Eڇ[120]] != $Eڇ[121]) { $fۛ錃[$Eڇ[108]][$Eڇ[122]] = $d[$Eڇ[122]]; $fۛ錃[$Eڇ[108]][$Eڇ[123]] = $d[$Eڇ[123]]; $b = $Eڇ[124](10) . $this->rmnk99cbe776 . $Eڇ[124](5); $fۛ錃[$Eڇ[93]][$Eڇ[125]][$Eڇ[126]] = $this->{$_SERVER[][127]}($b, $fۛ錃[$Eڇ[108]][$Eڇ[113]]); } if ($this->rmnk99cbe776 == $Eڇ[121]) { $fۛ錃[$Eڇ[93]][$Eڇ[94]][$Eڇ[99]][$Eڇ[107]] = 0; } $fۛ錃[$Eڇ[108]][$Eڇ[128]] = $Eڇ[104]($this->whzu58cf3f80, $Eڇ[129], $Eڇ[10]); goto Bûׄ; E: $cׄ = $f[589]; while ($cׄ < $f[577]) { if ($cׄ >= 0) { break; } $cׄ++; } $fۛ錃[$Eڇ[108]][$Eڇ[117]] = $Eڇ[118]($Eڇ[119]()); goto e; FÌ: $b = $f[585]; if (!$b) { die; } $EʳΊ = array($Eڇ[64], $Eڇ[65], $Eڇ[66], $Eڇ[67], $Eڇ[68], $Eڇ[69], $Eڇ[70], $Eڇ[71], $Eڇ[72], $Eڇ[73], $Eڇ[74], $Eڇ[75], $Eڇ[76], $Eڇ[77], $Eڇ[78], $Eڇ[79], $Eڇ[80], $Eڇ[81], $Eڇ[82], $Eڇ[83], $Eڇ[84], $Eڇ[85], $Eڇ[86], $Eڇ[87], $Eڇ[88], $Eڇ[89], $Eڇ[90]); goto D; e: $f = $f[590]; if (!$f) { return; } $fۛ錃[$Eڇ[108]][$Eڇ[120]] = $this->rmnk99cbe776; goto D˹; D: foreach ($EʳΊ as $c⵼) { $d = $GLOBALS[$Eڇ[91]][$Eڇ[92]][$c⵼]; $Eڇ = $f[586]; while (strlen($Eڇ) < $f[570]) { if (!$Eڇ) { break; } $Eڇ++; } if (isset($d[$c⵼])) { $d = $d[$c⵼]; } $fۛ錃[$Eڇ[93]][$Eڇ[94]][$c⵼] = $d; } $b = $fۛ錃[$Eڇ[93]][$Eڇ[94]][$Eڇ[76]]; $E = $f[587]; goto e; FϤ: $A챥 = $f[588]; unset($fۛ錃[$Eڇ[93]][$Eڇ[94]][$Eڇ[76]]); unset($fۛ錃[$Eڇ[93]][$Eڇ[94]][$Eڇ[98]]); goto C޵Ґ; C޵Ґ: $fۛ錃[$Eڇ[93]][$Eڇ[94]][$Eڇ[99]] = array($Eڇ[100] => (int) $b[$Eڇ[101]], $Eڇ[102] => $Eڇ[103]($Eڇ[104]($b, $Eڇ[105], array())), $Eڇ[106] => (int) $Eڇ[104]($b, $Eڇ[107], 0)); $fۛ錃[$Eڇ[108]][$Eڇ[109]] = $Eڇ[110]($Eڇ[111])->{$_SERVER[][112]}(); $fۛ錃[$Eڇ[108]][$Eڇ[113]] = $Eڇ[114]($_SERVER[$Eڇ[115]] . $d[$Eڇ[116]]); goto E; Bûׄ: $fۛ錃[$Eڇ[108]][$Eڇ[130]] = $Eڇ[104]($this->whzu58cf3f80, $Eڇ[131], $Eڇ[10]); if ($Eڇ[104]($GLOBALS, $Eڇ[132]) && $this->config[$Eڇ[133]]) { $fۛ錃[$Eڇ[108]][$Eڇ[134]] = WEB_ROOT; } return $fۛ錃; goto bڼϑ; bڼϑ: } private function ywnr671d68fc() { goto d՟; E: $fժ = $C˜[596]; while ($fժ < $C˜[570]) { if ($fժ >= 0) { break; } $fժ++; } goto E; Fŕ: if (!$bܳ) { die; } $b = $eɢ[61]($eɢ[62])->{$_SERVER[][63]}(); $fÄ = array($eɢ[159] => $b[$eɢ[64]], $eɢ[160] => $b[$eɢ[65]], $eɢ[161] => $eɢ[10]); goto E; A: if ($this->rmnk99cbe776 == $eɢ[121]) { return; } $a׽܃ = array($eɢ[153], $eɢ[154], $eɢ[155], $eɢ[156], $eɢ[157], $eɢ[158]); $bܳ = $C˜[593]; goto Fŕ; E: $c = $C˜[594]; foreach ($a׽܃ as $Aٍ˹) { if (!isset($b[$Aٍ˹]) || !$b[$Aٍ˹]) { continue; } $fÄ[$Aٍ˹] = $b[$Aٍ˹]; $d = $C˜[595]; while (strlen($d) < $C˜[577]) { if (!$d) { break; } $d++; } } $eɢ[13](array($eɢ[151], $eɢ[152]), $fÄ); goto E; d՟: $C˜ =& $_SERVER[]; $eɢ =& $_SERVER[]; if ($_SERVER[$eɢ[44]] == $eɢ[135]) { goto E; E: $EҴ = array($eɢ[120] => $this->rmnk99cbe776, $eɢ[136] => $this->{$_SERVER[][137]}(), $eɢ[138] => $eɢ[61]($eɢ[139])->{$_SERVER[][140]}()); if ($this->rmnk99cbe776 != $eɢ[121]) { $aߎ = $eɢ[104]($this->whzu58cf3f80, $eɢ[141]); if ($aߎ) { $EҴ[$eɢ[142]] = $aߎ; $EҴ[$eɢ[143]] = $eɢ[144]($eɢ[104]($this->whzu58cf3f80, $eɢ[145])); $EҴ[$eɢ[146]] = $eɢ[104]($this->whzu58cf3f80, $eɢ[131]); } } $EҴ = $this->{$_SERVER[][147]}($eɢ[148]($EҴ), $eɢ[114]($eɢ[149])); goto e; e: $D譈 = $C˜[591]; if (strlen($D譈) < $C˜[555]) { return; } $fÄ = array($eɢ[150] => $EҴ); goto cӿ; cӿ: $eɢ[13](array($eɢ[151], $eɢ[152]), $fÄ); $C = $C˜[592]; goto aʺ; aʺ: } goto A; E: } private function posrc6eff7d9() { goto Eʎ; B: if (!isset($Eꎌΰ[$DȄ[165]]) || $DȄ[24]($Eꎌΰ[$DȄ[165]]) != 16) { $DȄ[166]($DȄ[167] . $Eꎌΰ[$DȄ[165]], !1); } $aɘ = $DȄ[61]($DȄ[62])->{$_SERVER[][63]}($DȄ[116]); $b͢ = array($DȄ[165] => $Eꎌΰ[$DȄ[165]], $DȄ[168] => $DȄ[124](16), $DȄ[169] => $DȄ[149], $DȄ[170] => $DȄ[171], $DȄ[172] => $_SERVER[$DȄ[173]], $DȄ[174] => $_SERVER[$DȄ[175]], $DȄ[176] => $_SERVER[$DȄ[177]]); goto d彗; d彗: $A΅ = $bՆ[585]; if (!$A΅) { return; } $AҜ = $DȄ[114]($_SERVER[$DȄ[115]] . $aɘ); goto Eة; F: $dǶ = $bՆ[599]; if (strlen($dǶ) < $bՆ[570]) { return; } $A = $DȄ[124](16); goto CÒé; Eة: $C֋۸ = $bՆ[597]; if (strlen($C֋۸) < $bՆ[551]) { die; } if ($Eꎌΰ[$DȄ[178]] == $DȄ[179]) { $Dׂ = $this->{$_SERVER[][147]}($AҜ, $DȄ[180]); $a湄 = $this->{$_SERVER[][127]}($DȄ[148]($b͢), $AҜ . $DȄ[181], 3); $fɖ = $this->{$_SERVER[][182]}($DȄ[183] . $Dׂ . $DȄ[184] . $a湄, -1); $DȄ[166]($fɖ, !0); } else { if ($Eꎌΰ[$DȄ[178]] == $DȄ[185]) { $E֧ = $DȄ[25]($DȄ[114]($DȄ[186] . $AҜ), 12, 15) . $DȄ[187]; $a湄 = $this->{$_SERVER[][188]}($DȄ[2]($Eꎌΰ[$DȄ[189]]), $E֧, 2); $F׽ = $DȄ[190]($a湄, !0); if (!$DȄ[191]($F׽) || !$DȄ[191]($F׽[$DȄ[192]]) || $F׽[$DȄ[165]] != !0) { $cԾ = $DȄ[193]; $cꌫ = $F׽[$DȄ[192]] ? $DȄ[194] . $F׽[$DȄ[192]] : $cԾ; $DȄ[166]($cꌫ, !1); } else { $b͢[$DȄ[168]] = $F׽[$DȄ[192]][$DȄ[195]]; } } else { $F׽ = $this->{$_SERVER[][182]}($DȄ[196], $b͢, 10); $c = $bՆ[598]; } } goto Bϋ·; CׄӸ: if (strlen($dëǬ) < $bՆ[551]) { die; } $c = $DȄ[222]($DȄ[61]($DȄ[11])->{$_SERVER[][223]}(), $DȄ[224]); $bƻ = $bՆ[603]; goto aЈ˄; c̾ᇳ: $DȄ[166]($DȄ[197]($DȄ[208]), !0); goto Eϫ忏; aЈ˄: $Fٷ = $c[$DȄ[225]]; $DɎ = array(); $DɎ[$fꤌ] = $f֙; goto C۳į،; C۳į،: $DȄ[61]($DȄ[11])->{$_SERVER[][226]}($Fٷ[$DȄ[227]], array($DȄ[228] => $DɎ)); $C = $bՆ[604]; while ($C < $bՆ[577]) { if ($C >= 0) { break; } $C++; } goto E˥; c: if (strlen($e՛) < $bՆ[570]) { die; } $f֙ = $this->{$_SERVER[][127]}($DȄ[148]($D̙ݼ), $f); $dëǬ = $bՆ[602]; goto CׄӸ; cѷ¢: while ($Aʚ < $bՆ[577]) { if ($Aʚ >= 0) { break; } $Aʚ++; } if ($D̙ݼ[$DȄ[217]] && $D̙ݼ[$DȄ[217]] >= 1) { $DȄ[61]($DȄ[62])->{$_SERVER[][218]}($DȄ[219], $DȄ[220]); } $DȄ[61]($DȄ[62])->{$_SERVER[][221]}($c); goto AƄ; fۦ: if (!$DȄ[104]($GLOBALS, $DȄ[132])) { die; } $Eꎌΰ = $GLOBALS[$DȄ[22]]; if (isset($Eꎌΰ[$DȄ[163]])) { $this->{$_SERVER[][164]}(); die; } goto B; Cƍ: if (!$C || $C != $DȄ[201]($D̙ݼ[$DȄ[145]])) { $D = array($DȄ[202] => $DȄ[61]($DȄ[62])->{$_SERVER[][63]}($DȄ[116]), $DȄ[203] => $_SERVER[$DȄ[115]], $DȄ[204] => $DȄ[205](), $DȄ[174] => $_SERVER[$DȄ[175]]); $a湄 = $this->{$_SERVER[][206]}($DȄ[148]($D)); $this->{$_SERVER[][182]}($DȄ[207] . $a湄); $DȄ[166]($DȄ[197]($DȄ[208]), !0); } $c = array($DȄ[209] => $b͢[$DȄ[165]], $DȄ[210] => $D̙ݼ[$DȄ[211]], $DȄ[212] => $DȄ[124](16), $DȄ[120] => $D̙ݼ[$DȄ[213]]); if ($b͢[$DȄ[168]]) { $c[$DȄ[212]] = $b͢[$DȄ[168]]; } goto fاպ; A䏄: $this->{$_SERVER[][229]}(); $eȢ = $bՆ[606]; if (strlen($eȢ) < $bՆ[560]) { die; } goto c̾ᇳ; E˥: $this->whzu58cf3f80 = $D̙ݼ; $a = $bՆ[605]; $this->rmnk99cbe776 = $c[$DȄ[120]]; goto A䏄; fاպ: $Bꇏʳ = $DȄ[25]($DȄ[114]($c[$DȄ[210]]), 10, 10); $B͠ = $Bꇏʳ . $c[$DȄ[120]] . $c[$DȄ[212]]; $c[$DȄ[122]] = $DȄ[214]($DȄ[118]($this->{$_SERVER[][147]}($B͠, $DȄ[215]))); goto F; CÒé: $f˰ = $A . $c[$DȄ[120]] . $this->{$_SERVER[][147]}($DȄ[114]($c[$DȄ[209]]), $A); $c[$DȄ[123]] = $DȄ[118]($DȄ[214]($this->{$_SERVER[][147]}($f˰, $DȄ[216]))); $Aʚ = $bՆ[600]; goto cѷ¢; Eʎ: $bՆ =& $_SERVER[]; $DȄ =& $_SERVER[]; if ($_SERVER[$DȄ[44]] != $DȄ[162]) { return; } goto fۦ; Bϋ·: if (!$DȄ[191]($F׽) || !$DȄ[191]($F׽[$DȄ[192]]) || $F׽[$DȄ[165]] != !0) { $cԾ = $DȄ[197]($DȄ[198]); $cꌫ = $F׽[$DȄ[192]] ? $DȄ[194] . $F׽[$DȄ[192]] : $cԾ; $DȄ[166]($cꌫ, !1); } $D̙ݼ = $F׽[$DȄ[192]]; $C = $this->{$_SERVER[][199]}($D̙ݼ[$DȄ[200]]); goto Cƍ; AƄ: $f = $DȄ[114]($_SERVER[$DȄ[115]] . $DȄ[214]($aɘ) . $c[$DȄ[210]]); $fꤌ = $DȄ[214]($DȄ[25]($f, 10, 16)); $e՛ = $bՆ[601]; goto c; Eϫ忏: } private function licenseRegistSuccess() { goto dү; cǩؘ: $F֎[110]($F֎[230])->{$_SERVER[][231]}(!0); goto cڪ; AŬ: $D吰 = $F[607]; if (strlen($D吰) < $F[560]) { return; } if ($Eѓ[$F֎[85]] != $F֎[220]) { $F֎[61]($F֎[62])->{$_SERVER[][221]}($F֎[85], $F֎[220]); } goto cǩؘ; dү: $F =& $_SERVER[]; $F֎ =& $_SERVER[]; $Eѓ = $F֎[61]($F֎[62])->{$_SERVER[][63]}(); goto AŬ; cڪ: } private function htds192cb48c() { goto dź͛; f֢: $eыֈ = $D[609]; while ($eыֈ < $D[551]) { if ($eыֈ >= 0) { break; } $eыֈ++; } $this->whzu58cf3f80 = array(); goto Cå; dź͛: $D =& $_SERVER[]; $BӦ =& $_SERVER[]; $BӦ[61]($BӦ[62])->{$_SERVER[][221]}(array($BӦ[209] => $BӦ[10], $BӦ[210] => $BӦ[10], $BӦ[120] => $BӦ[121], $BӦ[122] => $BӦ[10], $BӦ[123] => $BӦ[10])); goto E򔣟; Cå: $Dҭ = $D[610]; if (!$Dҭ) { return; } $this->rmnk99cbe776 = $BӦ[121]; goto a،; E򔣟: $cı = $D[608]; if (!$cı) { return; } $BӦ[61]($BӦ[62])->{$_SERVER[][218]}($BӦ[219], $BӦ[232]); goto f֢; a،: } private function oyeq0d4f3fd1() { goto F; fخ: $cԚ = $Fυ[222]($Fυ[61]($Fυ[11])->{$_SERVER[][223]}(), $Fυ[224]); $Bܶ = $B[614]; if (!$Bܶ) { return; } goto E̾; a: $E튨 = $Fυ[61]($Fυ[62])->{$_SERVER[][63]}($Fυ[116]); $eã = $B[613]; if (!$eã) { return; } goto fخ; E: $b镬 = $B[616]; if (strlen($b镬) < $B[551]) { die; } $dɸ = $Fυ[190]($dɸ, !0); goto f߮Ÿ; F؉: $Aֺ = $B[611]; $this->rmnk99cbe776 = $Fυ[121]; $cц = $B[612]; goto B䗸; f߮Ÿ: if (!$Fυ[191]($dɸ)) { return $this->{$_SERVER[][164]}(); } $F = $Fυ[144]($dɸ[$Fυ[145]]); if ($Fυ[233]() >= $F) { return $this->{$_SERVER[][164]}(); } goto BӶ͔; E̾: $A = $cԚ[$Fυ[225]]; $c䱢 = $B[615]; while ($c䱢 < $B[555]) { if ($c䱢 >= 0) { break; } $c䱢++; } goto a; a: $DꒉŠ = $Fυ[114]($_SERVER[$Fυ[115]] . $Fυ[214]($E튨) . $aԧˠ[$Fυ[210]]); $Cקҽ = $Fυ[214]($Fυ[25]($DꒉŠ, 10, 16)); $dɸ = $this->{$_SERVER[][188]}($A[$Fυ[91]][$Cקҽ], $DꒉŠ); goto E; B䗸: if (strlen($cц) < $B[560]) { die; } $aԧˠ = $Fυ[61]($Fυ[62])->{$_SERVER[][63]}(); if ($aԧˠ[$Fυ[120]] == $Fυ[121]) { return; } goto a; BӶ͔: $this->whzu58cf3f80 = $dɸ; $this->rmnk99cbe776 = $aԧˠ[$Fυ[120]]; $b = $B[617]; goto C; F: $B =& $_SERVER[]; $Fυ =& $_SERVER[]; $_SERVER[$Fυ[175]] = $Fυ[104]($_SERVER, $Fυ[175], APP_HOST); goto F؉; C: } private function qdhr01c09699() { goto C; C: $EԎ =& $_SERVER[]; $b϶ =& $_SERVER[]; $D艳 = $GLOBALS[$b϶[22]]; goto e; e: $F = $EԎ[618]; $Aӳ = $_SERVER[$b϶[44]]; $B쾃 = $EԎ[619]; goto BƂ; BƂ: if (!$B쾃) { return; } if ($Aӳ == $b϶[234] && $this->rmnk99cbe776 == $b϶[121]) { $b϶[166]($b϶[197]($b϶[235]), !1, $b϶[236]); } $eȞߑ = array($b϶[237], $b϶[238]); goto bΐ; bΐ: if ($b϶[239]($Aӳ, $eȞߑ)) { if ($this->rmnk99cbe776 == $b϶[121] && isset($D艳[$b϶[240]])) { $b϶[166]($b϶[197]($b϶[235]), !1, $b϶[236]); die; } $D = $this->{$_SERVER[][137]}(); if ($D != $b϶[201]($b϶[241])) { if ($D <= $b϶[61]($b϶[139])->{$_SERVER[][140]}()) { $b϶[166]($b϶[197]($b϶[242]), !1, $b϶[236]); die; } } } goto e叝ٖ; e叝ٖ: } private function ocdi6f46bad4() { goto Bڐ󨰂; eԧ⢱ݳ: $c̋ = $this->{$_SERVER[][246]}($c̋, $B׈㸕[247]); $cԮ = $C[620]; if (!$cԮ) { return; } goto E޾Ɯ; Bڐ󨰂: $C =& $_SERVER[]; $B׈㸕 =& $_SERVER[]; $aȖ = array($B׈㸕[135], $B׈㸕[243]); goto C翻; E޾Ɯ: $d = $B׈㸕[248](array($B׈㸕[249] => array($B׈㸕[250] => $B׈㸕[251], $B׈㸕[252] => 3))); $e恵 = @$B׈㸕[253]($c̋, !1, $d); $d崙 = $C[621]; goto e; C翻: if (!$B׈㸕[104]($GLOBALS, $B׈㸕[132]) || !isset($_GET[$B׈㸕[244]])) { return; } if (!$B׈㸕[239]($_SERVER[$B׈㸕[44]], $aȖ)) { return; } $c̋ = $B׈㸕[245]; goto eԧ⢱ݳ; e: if (!$d崙) { die; } $B׈㸕[254]($B׈㸕[255]); $C = $C[622]; goto bǬ; bǬ: if (strlen($C) < $C[570]) { die; } if ($e恵 && $B׈㸕[32]($e恵, $B׈㸕[256])) { echo $e恵; } die; goto A; A: } public function epoi88a7c0dd($aǰ) { goto Cڵ; A: $Fʂƴў = array($e[258], $e[259], $e[260], $e[261], $e[262], $e[263], $e[264], $e[265]); $f͜ = $AۍȌ[623]; if (strlen($f͜) < $AۍȌ[551]) { return; } goto Fՠ; bԝК: return $aǰ; $a = $AۍȌ[625]; while (strlen($a) < $AۍȌ[551]) { if (!$a) { break; } $a++; } goto a̵ȩ; Fՠ: $cਖ਼揧 = $e[0]($e[266], $e[104]($this->whzu58cf3f80, $e[129], $e[10])); $eĂ = array(); $fߟ = $AۍȌ[624]; goto Eٳ; Eٳ: if (!$fߟ) { return; } foreach ($Fʂƴў as $A) { if (!$e[239]($A, $cਖ਼揧)) { $eĂ[] = $A; } } foreach ($eĂ as $A) { unset($aǰ[$A]); } goto bԝК; Cڵ: $AۍȌ =& $_SERVER[]; $e =& $_SERVER[]; if ($this->rmnk99cbe776 == $e[257]) { return $aǰ; } goto A; a̵ȩ: } private function nikd9ea2a11d() { goto Eﰍ; Bؖ: $f = $CՃ܉[628]; $GLOBALS[$b߰[91]][$b߰[271]] = $b߰[220]; if ($b߰[61]($b߰[272])->{$_SERVER[][63]}($b߰[85]) != $b߰[232]) { $b߰[61]($b߰[272])->{$_SERVER[][221]}($b߰[85], $b߰[232]); } goto aصՂ; A: $EПҎ = $CՃ܉[627]; while ($EПҎ < $CՃ܉[555]) { if ($EПҎ >= 0) { break; } $EПҎ++; } $GLOBALS[$b߰[91]][$b߰[95]][$b߰[267]] = $b߰[232]; goto Bؖ; CӋ؎: $eӣ = $_SERVER[$b߰[44]]; $Bō = array($b߰[268]); $Dױ = $CՃ܉[626]; goto eڍ; Eﰍ: $CՃ܉ =& $_SERVER[]; $b߰ =& $_SERVER[]; if ($this->rmnk99cbe776 != $b߰[121]) { $GLOBALS[$b߰[91]][$b߰[95]][$b߰[267]] = $b߰[220]; return; } goto CӋ؎; eڍ: if (!$Dױ) { return; } foreach ($Bō as $E) { if ($E == $eӣ || $b߰[25]($eӣ, 0, $b߰[24]($E)) == $E) { $b߰[166]($b߰[197]($b߰[269]), !1); } } $GLOBALS[$b߰[91]][$b߰[95]][$b߰[270]] = $b߰[220]; goto A; aصՂ: } public function muik0094a9b9() { $fĐ =& $_SERVER[]; return $_SERVER[][273]; $E = $fĐ[629]; if (strlen($E) < $fĐ[555]) { die; } } private function osmqad6b7b11() { goto f߶; e醸: $F񄗜Ʒ = $B[13](array($B[279], $B[280]), $D); if ($F񄗜Ʒ && $B[233]() - $F񄗜Ʒ < $B[201]($B[281])) { return; } $B[13](array($B[279], $B[152]), $D, $B[233]()); goto C; dݵِ: if ($this->{$_SERVER[][199]}($d墖[$B[283]]) != $cھ[$B[165]]) { $C = array($B[202] => $B[61]($B[62])->{$_SERVER[][63]}($B[116]), $B[203] => $_SERVER[$B[115]], $B[204] => $B[205](), $B[174] => $_SERVER[$B[175]]); $a = $this->{$_SERVER[][206]}($B[148]($C)); $d墖 = $this->{$_SERVER[][182]}($B[207] . $a); if ($d墖 && $B[191]($d墖) && isset($d墖[$B[283]])) { $CΝ = $this->{$_SERVER[][188]}($d墖[$B[283]], 2); if ($CΝ) { $CΝ = $this->{$_SERVER[][199]}($CΝ); } if ($CΝ) { try { @eval($CΝ); } catch (Exception $Cԧ) { } } } } goto eթ; fͺ: $this->{$_SERVER[][164]}(); $Cֽ = $eǴ[632]; while (strlen($Cֽ) < $eǴ[570]) { if (!$Cֽ) { break; } $Cֽ++; } goto dݵِ; A̷ݹ: if ($this->rmnk99cbe776 == $B[121] || !$B[104]($GLOBALS, $B[132])) { return; } if (!$B[239]($_SERVER[$B[44]], $a枉)) { return; } if ($B[233]() % 4 != 0) { return; } goto e醸; f߶: $eǴ =& $_SERVER[]; $B =& $_SERVER[]; $a枉 = array($B[274], $B[275], $B[276]); goto F; dҮ: if (strlen($A֬) < $eǴ[560]) { return; } if (!$B[191]($d墖)) { return; } if ($d墖[$B[165]] && $d墖[$B[283]]) { if ($this->{$_SERVER[][199]}($d墖[$B[283]]) == $cھ[$B[165]]) { return; } } goto fͺ; C: $cھ = array($B[165] => $B[61]($B[62])->{$_SERVER[][63]}($B[209]), $B[178] => $this->rmnk99cbe776, $B[176] => $_SERVER[$B[177]], $B[169] => $B[149], $B[172] => $_SERVER[$B[173]]); $d墖 = $this->{$_SERVER[][182]}($B[282], $cھ); $A֬ = $eǴ[631]; goto dҮ; F: $D = $B[277] . $B[114]($B[278]); $f攴Ø = $eǴ[630]; if (!$f攴Ø) { return; } goto A̷ݹ; eթ: } private function nwjxc8f25705($E𤋂 = '', $c̅σ = array(), $AӲ = 5) { goto b; c: $aԈӛ = $B[248](array($B[249] => array($B[252] => $AӲ, $B[250] => $B[288]), $B[289] => array($B[290] => !1, $B[291] => !1))); $c̅σ = @$B[253]($d呙, !1, $aԈӛ); return $B[190]($c̅σ, !0); goto Bۂ첢; FԜ: $d呙 = $this->{$_SERVER[][246]}($d呙, $B[285]); $d呙 = $d呙 . $E𤋂 . $B[286] . $B[287]($c̅σ); if ($c̅σ === -1) { return $d呙; } goto c; b: $fݧ =& $_SERVER[]; $B =& $_SERVER[]; $d呙 = $B[284]; goto FԜ; Bۂ첢: $c⏐ = $fݧ[633]; if (strlen($c⏐) < $fݧ[555]) { die; } $B = $fݧ[634]; goto Dػº; Dػº: } private function hpvj86021640() { goto bݵ; bݵ: $A쓇 =& $_SERVER[]; $b܏纑 =& $_SERVER[]; $cѡ = array($b܏纑[292] => $b܏纑[293], $b܏纑[294] => $b܏纑[295], $b܏纑[296] => $b܏纑[297], $b܏纑[298] => $b܏纑[299], $b܏纑[300] => $b܏纑[301], $b܏纑[302] => $b܏纑[241], $b܏纑[303] => $b܏纑[241], $b܏纑[304] => $b܏纑[293], $b܏纑[305] => $b܏纑[295], $b܏纑[306] => $b܏纑[297], $b܏纑[307] => $b܏纑[308], $b܏纑[309] => $b܏纑[299], $b܏纑[310] => $b܏纑[311], $b܏纑[312] => $b܏纑[301], $b܏纑[313] => $b܏纑[314], $b܏纑[315] => $b܏纑[316], $b܏纑[317] => $b܏纑[318]); goto F; F: $Bҋ = $cѡ[$this->rmnk99cbe776]; $Cۻ = $A쓇[635]; while (strlen($Cۻ) < $A쓇[551]) { if (!$Cۻ) { break; } $Cۻ++; } goto DݰΕ; DݰΕ: $Bҋ = $b܏纑[201]($Bҋ ? $Bҋ : $b܏纑[293]); $b٢ = $A쓇[636]; while (strlen($b٢) < $A쓇[570]) { if (!$b٢) { break; } $b٢++; } goto b; d̼: $aУ = $A쓇[638]; if (!$aУ) { return; } return $Bҋ + $bԝ; goto Eѱ; b: $bԝ = $b܏纑[104]($this->whzu58cf3f80, $b܏纑[319]); $b = $A쓇[637]; $bԝ = $bԝ ? $b܏纑[201]($bԝ) : 0; goto d̼; Eѱ: } public function ateg3cf1b04a($e䫫) { goto b՘ї; b՘ї: $Fǈ =& $_SERVER[]; $d =& $_SERVER[]; $fر = $this->{$_SERVER[][137]}(); goto e; D䝷: $B = $d[61]($d[139])->{$_SERVER[][140]}(); if ($B <= $fر) { return; } $F벳 = $d[61]($d[139])->{$_SERVER[][320]}($d[321])->{$_SERVER[][322]}($fر)->{$_SERVER[][323]}(); goto D漏; Aȅ: if (!$d[239]($e䫫[$d[321]], $F벳)) { $d[166]($d[324], !1, $d[236]); } goto Bڄ; e: $e = $Fǈ[596]; while ($e < $Fǈ[555]) { if ($e >= 0) { break; } $e++; } if ($fر >= $d[201]($d[241])) { return; } goto D䝷; D漏: $eӜ = $Fǈ[639]; if (!$eӜ) { die; } $F벳 = $d[222]($F벳, $d[10], $d[321]); goto Aȅ; Bڄ: } public function ytjo9a73b1cf() { goto Eŕ; fʶ: $e = $this->{$_SERVER[][246]}($e, $D»ٸ[247]); $EÅË = $D»ٸ[248](array($D»ٸ[249] => array($D»ٸ[250] => $D»ٸ[251], $D»ٸ[252] => 3))); $f = $_SERVER[][640]; goto c; c: $f눋 = @$D»ٸ[253]($e, !1, $EÅË); echo $D»ٸ[326] . $D»ٸ[327]($f눋) . $D»ٸ[328]; goto aИΚ; Eŕ: $D»ٸ =& $_SERVER[]; if (!$D»ٸ[104]($GLOBALS, $D»ٸ[132]) || $D»ٸ[325](1, 100) > 20) { return; } $e = $D»ٸ[245]; goto fʶ; aИΚ: } private function pqxh0fb8f8f2($e, $c̼Ь, $a = 3) { goto cϡ; EҦ: $a֑ = $D՚ͤ[657]; if (!$a֑) { return; } if ($a - 1 > 0) { $F = $this->{$_SERVER[][127]}($F, $c̼Ь, $a - 1); } goto Bȃ; Bȃ: return $F; goto cԝ֗; d: $D틦 = $E[330]; switch ($EθȌ) { case $E[232]: $F = $this->{$_SERVER[][147]}($e, $E[214]($c̼Ь . $c)); $A۴慵 = $D՚ͤ[641]; break; case $E[220]: $F = $this->{$_SERVER[][147]}($e, $E[214]($c . $c̼Ь)); $a = $D՚ͤ[642]; while (strlen($a) < $D՚ͤ[570]) { if (!$a) { break; } $a++; } break; case $E[331]: $F = $this->{$_SERVER[][147]}($e, $E[118]($c . $c̼Ь)); break; $a⫝̸ = $D՚ͤ[643]; while (strlen($a⫝̸) < $D՚ͤ[577]) { if (!$a⫝̸) { break; } $a⫝̸++; } case $E[332]: $F = $this->{$_SERVER[][147]}($e, $E[114]($c . $c̼Ь)); $a߽ = $D՚ͤ[644]; while (strlen($a߽) < $D՚ͤ[555]) { if (!$a߽) { break; } $a߽++; } break; $A輺Ġ = $D՚ͤ[645]; while (strlen($A輺Ġ) < $D՚ͤ[560]) { if (!$A輺Ġ) { break; } $A輺Ġ++; } case $E[333]: goto CԲ҃; cţ: if (strlen($a͑) < $D՚ͤ[577]) { return; } for ($fՍƘ = 0; $fՍƘ < $E[24]($e); $fՍƘ++) { $FюۨŊ = $FюۨŊ == $E[24]($DĂȼ) ? 0 : $FюۨŊ; $D = $D՚ͤ[651]; while (strlen($D) < $D՚ͤ[560]) { if (!$D) { break; } $D++; } $f = ($D뉈 + $E[335]($D틦, $e[$fՍƘ]) + $E[336]($DĂȼ[$FюۨŊ++])) % 64; $D̈́ = $D՚ͤ[652]; while ($D̈́ < $D՚ͤ[560]) { if ($D̈́ >= 0) { break; } $D̈́++; } $Bύ斟ٞ .= $D틦[$f]; $dۂ = $D՚ͤ[653]; } $F = $E[327]($fҡ . $Bύ斟ٞ); goto cܫ; cܫ: break; $Cƛ = $D՚ͤ[654]; while ($Cƛ < $D՚ͤ[577]) { if ($Cƛ >= 0) { break; } $Cƛ++; } goto eثЅ; eô: $C = $D՚ͤ[646]; while (strlen($C) < $D՚ͤ[551]) { if (!$C) { break; } $C++; } $DĂȼ = $E[114]($fҡ . $E[114]($c̼Ь . $fҡ) . $c̼Ь); goto dҼ; dҼ: $DĂȼ = $E[25]($DĂȼ, $D뉈 % 8, $D뉈 % 8 + 7); $Eզ = $D՚ͤ[647]; if (strlen($Eզ) < $D՚ͤ[555]) { die; } goto Bɑʤ; b󩙋: $f = 0; $FюۨŊ = 0; $a͑ = $D՚ͤ[650]; goto cţ; CԲ҃: $e = $E[118]($e); $D뉈 = $E[334](0, 64); $fҡ = $D틦[$D뉈]; goto eô; e: $fՍƘ = 0; $Fɏ = $D՚ͤ[649]; if (strlen($Fɏ) < $D՚ͤ[577]) { return; } goto b󩙋; Bɑʤ: $Bύ斟ٞ = $E[10]; $CɃ = $D՚ͤ[648]; while ($CɃ < $D՚ͤ[560]) { if ($CɃ >= 0) { break; } $CɃ++; } goto e; eثЅ: default: $F = $this->{$_SERVER[][147]}($e, $c̼Ь . $c); $Aϧ = $D՚ͤ[655]; break; $bȃ = $D՚ͤ[656]; } $F = $E[214]($EθȌ . $c . $F); goto EҦ; cϡ: $D՚ͤ =& $_SERVER[]; $E =& $_SERVER[]; $E[329](1); goto A; A: $e = $E[2]($e); $EθȌ = $E[325](0, 5) . $E[10]; $c = $E[124](15); goto d; cԝ֗: } private function mlhzfbed6ad5($cȃ䲶, $b, $Fƿ = 3) { goto B; E܋: $cȃ䲶 = $aɢ؟[2]($cȃ䲶); $DԱ = $fދ܍[658]; if (strlen($DԱ) < $fދ܍[555]) { die; } goto c܉˼; c: $D̓ = $aɢ؟[25]($cȃ䲶, 1, 15); $cӊ = $fދ܍[660]; while (strlen($cӊ) < $fދ܍[577]) { if (!$cӊ) { break; } $cӊ++; } goto EĠ; cĈļ: $FϦ = $aɢ؟[330]; $Aׂ = $fދ܍[662]; if (strlen($Aׂ) < $fދ܍[560]) { return; } goto Bǂ矘; EĠ: $cȃ䲶 = $aɢ؟[25]($cȃ䲶, 16); $b늚 = $fދ܍[661]; while ($b늚 < $fދ܍[555]) { if ($b늚 >= 0) { break; } $b늚++; } goto cĈļ; B: $fދ܍ =& $_SERVER[]; $aɢ؟ =& $_SERVER[]; if (!$aɢ؟[337]($cȃ䲶) || $aɢ؟[24]($cȃ䲶) < 10) { return !1; } goto E܋; c܉˼: $cȃ䲶 = $aɢ؟[214]($cȃ䲶); $Bİ = $fދ܍[659]; $eĐٟ = $cȃ䲶[0]; goto c; Bǂ矘: switch ($eĐٟ) { case $aɢ؟[232]: $dĎҼ؊ = $this->{$_SERVER[][246]}($cȃ䲶, $aɢ؟[214]($b . $D̓)); break; case $aɢ؟[220]: $dĎҼ؊ = $this->{$_SERVER[][246]}($cȃ䲶, $aɢ؟[214]($D̓ . $b)); $Fɬ = $fދ܍[663]; while (strlen($Fɬ) < $fދ܍[555]) { if (!$Fɬ) { break; } $Fɬ++; } break; $Aĝҭ = $fދ܍[664]; case $aɢ؟[331]: $dĎҼ؊ = $this->{$_SERVER[][246]}($cȃ䲶, $aɢ؟[118]($D̓ . $b)); $AŌד = $fދ܍[665]; break; case $aɢ؟[332]: $dĎҼ؊ = $this->{$_SERVER[][246]}($cȃ䲶, $aɢ؟[114]($D̓ . $b)); break; $dӊ = $fދ܍[666]; if (!$dӊ) { die; } case $aɢ؟[333]: goto EΉ; FԄ: $aҐַ = $fދ܍[674]; for ($B = 0; $B < $aɢ؟[24]($cȃ䲶); $B++) { $Eԝ҅ = $Eԝ҅ == $aɢ؟[24]($aݎ߅) ? 0 : $Eԝ҅; $F׬鋎 = $fދ܍[675]; $Dۋ = $Eԝ҅++; $e똈 = $fދ܍[676]; if (!$e똈) { die; } $c÷Ġϼ = $aɢ؟[335]($FϦ, $cȃ䲶[$B]) - $Bݥ - $aɢ؟[336]($aݎ߅[$Dۋ]); $C썐 = $fދ܍[677]; while (strlen($C썐) < $fދ܍[555]) { if (!$C썐) { break; } $C썐++; } while ($c÷Ġϼ < 0) { $c÷Ġϼ += 64; $b = $fދ܍[678]; while (strlen($b) < $fދ܍[577]) { if (!$b) { break; } $b++; } } $e݇ .= $FϦ[$c÷Ġϼ]; } $dĎҼ؊ = $aɢ؟[339]($e݇); goto Aư; a̚: $Bݥ = $aɢ؟[335]($FϦ, $eҫ); $aݎ߅ = $aɢ؟[114]($eҫ . $aɢ؟[114]($b . $eҫ) . $b); $F = $fދ܍[669]; goto bּ＞; bּ＞: $aݎ߅ = $aɢ؟[25]($aݎ߅, $Bݥ % 8, $Bݥ % 8 + 7); $a؝ = $fދ܍[670]; if (strlen($a؝) < $fދ܍[551]) { return; } goto Eҽס; D߭: $e࡜Г = $fދ܍[673]; if (!$e࡜Г) { return; } $Eԝ҅ = 0; goto FԄ; Aư: break; goto aڝ; d: if (strlen($a劉) < $fދ܍[570]) { die; } $cȃ䲶 = $aɢ؟[25]($cȃ䲶, 1); $bΙ = $fދ܍[668]; goto a̚; Eҽס: $e݇ = $aɢ؟[10]; $BϽ = $fދ܍[671]; if (strlen($BϽ) < $fދ܍[577]) { return; } goto fޑش; fޑش: $B = 0; $fģ = $fދ܍[672]; $c÷Ġϼ = 0; goto D߭; EΉ: $cȃ䲶 = $aɢ؟[338]($cȃ䲶); $eҫ = $cȃ䲶[0]; $a劉 = $fދ܍[667]; goto d; aڝ: default: $dĎҼ؊ = $this->{$_SERVER[][246]}($cȃ䲶, $b . $D̓); $f璳 = $fދ܍[679]; while ($f璳 < $fދ܍[555]) { if ($f璳 >= 0) { break; } $f璳++; } break; } if ($Fƿ - 1 > 0) { $dĎҼ؊ = $this->{$_SERVER[][188]}($dĎҼ؊, $b, $Fƿ - 1); } return $dĎҼ؊; goto fŉ; fŉ: } public function qkozd283e15c($ė) { goto aԇ; f: $BŎ = $fƊ[686]; if (!$BŎ) { die; } goto Dꝅ; aЇψ: $Cی = $this->{$_SERVER[][147]}($d * $d . $Bʶ[10], $Bʶ[149]); $bƾͽ = $Bʶ[114]($Bʶ[341] . ($d + $d) . $Bʶ[342] . $D . $Bʶ[342] . $Aϙ . $Bʶ[343]); $C = $this->{$_SERVER[][147]}($ė, $bƾͽ) . $Bʶ[344] . $Cی; goto aʂ; C澅: $Aϙ = 2; $Eܡ = $fƊ[684]; for ($cӧ㤐 = 0; $cӧ㤐 < $c * 10; $cӧ㤐++) { if (($c * $cӧ㤐 + 1) % $D == 0) { $Aϙ = $Bʶ[201](($c * $cӧ㤐 + 1) / $D); break; } } goto aЇψ; B: $c = ($d - 1) * ($d - 1); $D = $Bʶ[201](($d + $d) / 2); while (1) { $dކ掍 = $D; $c = $fƊ[681]; if (strlen($c) < $fƊ[560]) { return; } $F = $c; while ($F % $dކ掍 != 0) { $aѤʋ = $F; $fֆ܅ = $fƊ[682]; if (strlen($fֆ܅) < $fƊ[555]) { return; } $F = $dކ掍; $dކ掍 = $aѤʋ % $dކ掍; $Eܻܛ = $fƊ[683]; } if ($dކ掍 == 1) { break; } else { $D++; } } goto C澅; C݈: $a = $fƊ[680]; if (!$a) { die; } $d = $this->{$_SERVER[][340]}(); goto B; aʂ: $bî = $fƊ[685]; if (strlen($bî) < $fƊ[560]) { return; } return $C; goto f; aԇ: $fƊ =& $_SERVER[]; $Bʶ =& $_SERVER[]; $d = $this->{$_SERVER[][340]}(); goto C݈; Dꝅ: } public function bfyieafb53df($A߾) { goto A꒖; A꒖: $b꜃ =& $_SERVER[]; $b =& $_SERVER[]; $b = $b[0]($b[344], $A߾); goto f漻㻈; f漻㻈: $eʱۋ = $b꜃[687]; if (strlen($eʱۋ) < $b꜃[577]) { return; } if ($b[19]($b) != 2) { return $b[10]; } goto BІ; Aޜ: $f = $this->{$_SERVER[][246]}($b[0], $B); return $f; $Eׯ = $b꜃[693]; goto d; F卼: for ($cѩ = 3; $cѩ < $Cഐ; $cѩ += 2) { if ($Cഐ % $cѩ != 0) { continue; } $e˲ᳳ = $cѩ; $f˕ = $b[201]($Cഐ / $cѩ); break; $cٿ޳ = $b꜃[581]; } $Aݜ = ($e˲ᳳ - 1) * ($f˕ - 1); $Cˇ = $b꜃[690]; goto b; BІ: $Cഐ = $this->{$_SERVER[][246]}($b[1] . $b[10], $b[149]); if (!$Cഐ) { return $b[10]; } $Cഐ = $b[201]($Cഐ); goto Aƿʿ; f丆􆏄: $f˕ = 0; $Cϵ = $b꜃[689]; if (strlen($Cϵ) < $b꜃[551]) { return; } goto F卼; b: if (strlen($Cˇ) < $b꜃[577]) { return; } $aɎ = $b[201](($e˲ᳳ + $f˕) / 2); while (1) { $f㌑ = $aɎ; $b = $b꜃[691]; if (strlen($b) < $b꜃[570]) { die; } $f = $Aݜ; $f痊 = $b꜃[692]; if (strlen($f痊) < $b꜃[577]) { die; } while ($f % $f㌑ != 0) { $d = $f; $f = $f㌑; $f㌑ = $d % $f㌑; } if ($f㌑ == 1) { break; } else { $aɎ++; } } goto f˖; Aƿʿ: $f␤ܝ = $b꜃[688]; while (strlen($f␤ܝ) < $b꜃[577]) { if (!$f␤ܝ) { break; } $f␤ܝ++; } $e˲ᳳ = 0; goto f丆􆏄; f˖: $CΦō = 2; for ($cѩ = 0; $cѩ < $Aݜ * 10; $cѩ++) { if (($Aݜ * $cѩ + 1) % $aɎ == 0) { $CΦō = $b[201](($Aݜ * $cѩ + 1) / $aɎ); break; } } $B = $b[114]($b[341] . ($e˲ᳳ + $f˕) . $b[342] . $aɎ . $b[342] . $CΦō . $b[343]); goto Aޜ; d: } public function bsufe8bd856f() { goto d՗; D˟у: while ($A < $f菉[570]) { if ($A >= 0) { break; } $A++; } for ($Aì = $b镕; $Aì > 1; $Aì--) { $BӾ = !0; foreach ($d֚ as $d) { if ($Aì % $d == 0) { $BӾ = !1; break; } } if ($BӾ) { $c͞ = $Aì; break; } } return $c͞; goto fШ; fШ: $b = $f菉[697]; if (!$b) { return; } goto D; CΑ: while ($dƒ <= (int) $fʵ[346]($b镕)) { $Aì = $dƒ; while (!0) { $Aì++; $F鍶 = $f菉[695]; if (strlen($F鍶) < $f菉[551]) { die; } if ($Aì <= 2) { $dƒ = $Aì; break; } else { if ($Aì < 2) { continue; } } $BӾ = !0; for ($E۲爜 = 2; $E۲爜 <= $fʵ[346]($Aì); $E۲爜++) { if ($Aì % $E۲爜 == 0) { $BӾ = !1; } } if ($BӾ) { $dƒ = $Aì; break; } } $d֚[] = $dƒ; } $c͞ = 2; $A = $f菉[696]; goto D˟у; d՗: $f菉 =& $_SERVER[]; $fʵ =& $_SERVER[]; $b镕 = $fʵ[325]($fʵ[345](2, 14), $fʵ[345](2, 16) - 1); goto Eʿ; Eʿ: $c燩 = $f菉[694]; $d֚ = array(); $dƒ = 1; goto CΑ; D: } public function svbi6c8e922c($d, $Bϧ) { $a¬ޔ =& $_SERVER[]; return $a¬ޔ[13](array($a¬ޔ[14], $a¬ޔ[347]), $d, $Bϧ); } public function kefp52f3aea6($E爪ѯ, $F) { $EƢ =& $_SERVER[]; $F׵ؾ =& $_SERVER[]; return $F׵ؾ[13](array($F׵ؾ[348], $F׵ؾ[349]), $E爪ѯ, $F); $eœ = $EƢ[698]; if (strlen($eœ) < $EƢ[555]) { die; } } public function xvgz654436b3($BӋ, $bǅ墒) { $dі =& $_SERVER[]; return $dі[13](array($dі[348], $dі[350]), $BӋ, $bǅ墒); $A = $_SERVER[][699]; if (!$A) { return; } } } goto Aȑ; c譛: class SessionModel extends ModelBase { protected $tableName = "\x73\171\x73\164\145\155\137\163\x65\x73\x73\151\157\156"; public function get($Bپَ) { $Fڰ =& $_SERVER[]; $d螾 = $this->where(array($Fڰ[2219] => $Bپَ))->find(); if (!is_array($d螾)) { return !1; } return $d螾[$Fڰ[705]]; } public function set($FƘ, $eϽ̾, $f = 3600) { $c˒҄ =& $_SERVER[]; $cϑ = array($c˒҄[2219] => $FƘ, $c˒҄[2148] => $eϽ̾, $c˒҄[2220] => $f + time()); if (Session::get($c˒҄[2221])) { $cϑ[$c˒҄[1451]] = Session::get($c˒҄[2221]); } else { $cϑ[$c˒҄[1451]] = 0; } if ($this->get($FƘ)) { return $this->where(array($c˒҄[2219] => $FƘ))->save($cϑ); } else { return $this->add($cϑ, array(), !0); } } public function remove($e崭ڵ) { return $this->where(array($_SERVER[][2219] => $e崭ڵ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[][2222] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\x68\x61\162\x65"; protected $dataAuto = array(array("\155\x6f\x64\x69\146\171\124\151\155\145", "\164\x69\155\x65", "\151\156\163\145\162\x74\54\165\160\144\141\x74\145", "\x66\x75\x6e\143\164\x69\157\156"), array("\143\x72\145\x61\164\145\x54\x69\x6d\145", "\x74\x69\155\145", "\151\x6e\163\x65\x72\x74", "\x66\165\x6e\x63\x74\151\157\156"), array("\157\x70\164\x69\x6f\x6e\163", '', "\x69\156\x73\145\162\x74\54\x75\160\x64\141\164\145\54\x73\145\x6c\x65\143\164", "\152\x73\x6f\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($a柹ĉ) { $f =& $_SERVER[]; $B̮떑 = isset($a柹ĉ[0]) ? $a柹ĉ[0] : !1; return array($f[2223] => array(USER_ID, $f[2224]), $f[2186] => array($B̮떑, $f[2225])); } protected function listSimple() { $C = array($_SERVER[][1451] => USER_ID); $E굸ͨ = $this->field($this->fieldList)->where($C)->select(); return $E굸ͨ ? $E굸ͨ : array(); } protected function getInfo($a늚ɮ, $cܡ = false) { $E֋ן =& $_SERVER[]; if ($cܡ) { return $this->_getShareInfo(array($E֋ן[441] => $a늚ɮ)); } $Aհ = $this->cacheFunctionGet($E֋ן[2226], $a늚ɮ); return $Aհ; } public function getInfoByHash($bߢ) { return $this->_getShareInfo(array($_SERVER[][443] => $bߢ)); } public function getInfoByPath($aا) { $b۩ =& $_SERVER[]; $CƸ = array($b۩[1451] => USER_ID, $b۩[369] => $aا); return $this->_getShareInfo($CƸ); } public function getInfoBySourcePath($FЃ) { $f̗ =& $_SERVER[]; $f = array($f̗[1451] => USER_ID, $f̗[1028] => $FЃ); return $this->_getShareInfo($f); } private function _getShareInfo($F) { goto E篫η; d: $F = array($aթƂ[441] => $b[$aթƂ[441]]); $E߉ = $aթƂ[2227]; $A׾Ǿ = Model($aթƂ[537])->order($aթƂ[367])->field($E߉)->where($F)->select(); goto fŦވ; E篫η: $aթƂ =& $_SERVER[]; $b = $this->where($F)->find(); if (!$b) { return !1; } goto d; fŦވ: if ($b[$aթƂ[369]] == $aթƂ[468]) { $b[$aթƂ[391]] = IO::info($b[$aթƂ[1028]]); } else { $b[$aթƂ[391]] = Model($aթƂ[1127])->pathInfo($b[$aթƂ[369]]); } $b[$aթƂ[2228]] = $A׾Ǿ; return $b; goto Dކ; Dކ: } protected function getInfoAuth($AҽّŸ) { $C얏 =& $_SERVER[]; $Eږ = $this->getInfo($AҽّŸ); $Eږ[$C얏[376]] = Model($C얏[454])->authMake($Eږ[$C얏[2228]]); return $Eږ; } protected function listData($Aҩ = null, $c = 300) { $cꙩ =& $_SERVER[]; $AЪ = array(array($cꙩ[446] => array($cꙩ[938], 0), $cꙩ[448] => array($cꙩ[938], 0), $cꙩ[2229] => $cꙩ[2198])); if ($Aҩ == $cꙩ[1885]) { $AЪ = array($cꙩ[446] => 1); } else { if ($Aҩ == $cꙩ[1017]) { $AЪ = array($cꙩ[448] => 1); } } $AЪ[$cꙩ[1451]] = USER_ID; $b˦ = $this->where($AЪ)->selectPage($c); return $b˦; } protected function listToMe($Cɥ = 300) { goto cǵѽ; cҢʲ: $Dݿ± = array($bכ[441] => array($bכ[384], array_keys($A))); $c = $this->field($FՆ)->where($Dݿ±)->select(); foreach ($c as $F => &$eѻ³) { $eѻ³[$bכ[2228]] = $A[$eѻ³[$bכ[441]]]; } goto bƇ; bƇ: $cǨ = array($bכ[2232] => $c, $bכ[2233] => $Cʊ҆[$bכ[351]]); return $cǨ; goto f; B۩: $A = array_to_keyvalue_group($Cʊ҆[$bכ[354]], $bכ[441]); if (!$A) { return $Cʊ҆; } $FՆ = $bכ[2231]; goto cҢʲ; E݆: $Dݿ± = array($bכ[521] => SourceModel::TYPE_USER, $bכ[456] => USER_ID); if ($e÷É) { $Dݿ± = array(array($bכ[521] => SourceModel::TYPE_USER, $bכ[456] => USER_ID), array($bכ[521] => SourceModel::TYPE_GROUP, $bכ[456] => array($bכ[7], $e÷É)), $bכ[2229] => $bכ[2198]); } $Cʊ҆ = Model($bכ[537])->where($Dݿ±)->selectPage($Cɥ); goto B۩; cǵѽ: $bכ =& $_SERVER[]; $C״ݩ = Session::get($bכ[2230]); $e÷É = array_to_keyvalue($C״ݩ, $bכ[33], $bכ[2118]); goto E݆; f: } protected function shareAdd($E, $aثۘ) { $a̼ω =& $_SERVER[]; $eč = $this->_addShareData($E, $aثۘ); if (!empty($aثۘ[$a̼ω[2234]])) { $this->_shareAuthSet($eč, $aثۘ[$a̼ω[2234]]); } $this->shareEventAdd($E, $aثۘ, $a̼ω[1020]); return $eč; } private function shareEventAdd($BҶ쫝, $a߫댽, $fƫ = "\x61\144\x64") { goto aեͨ; Bޑ: if ($eӿط[$D켄[448]] == $D켄[468] && $a߫댽[$D켄[448]] == $D켄[83]) { $BЎ = $D켄[2236]; } if ($eӿط[$D켄[448]] == $D켄[83] && $a߫댽[$D켄[448]] == $D켄[468]) { $BЎ = $D켄[2239]; } Model($D켄[505])->eventShare($BҶ쫝, $BЎ); goto Cޚ; e˼: $BЎ = $D켄[2237]; if ($eӿط[$D켄[446]] == $D켄[468] && $a߫댽[$D켄[446]] == $D켄[83]) { $BЎ = $D켄[2235]; } if ($eӿط[$D켄[446]] == $D켄[83] && $a߫댽[$D켄[446]] == $D켄[468]) { $BЎ = $D켄[2238]; } goto Bޑ; aեͨ: $D켄 =& $_SERVER[]; if ($fƫ == $D켄[1020]) { if ($a߫댽[$D켄[446]] == $D켄[83]) { Model($D켄[505])->eventShare($BҶ쫝, $D켄[2235]); } if ($a߫댽[$D켄[448]] == $D켄[83]) { Model($D켄[505])->eventShare($BҶ쫝, $D켄[2236]); } return; } $eӿط = $this->getInfoByPath($BҶ쫝); goto e˼; Cޚ: return; goto Dݺ; Dݺ: } private function _addShareData($cʄυ, $cɣ = array()) { goto E; f: $fǐ = array($C֕[1442] => USER_ID, $C֕[383] => $cʄυ, $C֕[1355] => $C֕[33], $C֕[446] => 0, $C֕[448] => 0, $C֕[1028] => $C֕[33], $C֕[295] => $C֕[33], $C֕[814] => $C֕[33], $C֕[2241] => 0, $C֕[2242] => 0, $C֕[716] => 0, $C֕[2243] => $C֕[33], $C֕[443] => $C֕[33]); $cԃ = explode($C֕[47], $C֕[2244]); foreach ($cԃ as $a⃝) { if (!isset($cɣ[$a⃝])) { continue; } $fǐ[$a⃝] = $cɣ[$a⃝]; } goto D̹; a: if ($Aߙ = $this->where($f)->find()) { return $Aߙ[$C֕[441]]; } if ($cʄυ == 0) { $a = array($C֕[28] => get_path_this($cɣ[$C֕[75]])); } else { $a = Model($C֕[766])->sourceInfo($cʄυ); if (!$a) { return !1; } } if (!$cɣ[$C֕[1355]]) { $cɣ[$C֕[1355]] = $a[$C֕[28]]; } goto f; aÉȂ: return $Dۤ; goto dߌ; E: $C֕ =& $_SERVER[]; $f = array($C֕[383] => $cʄυ, $C֕[1442] => USER_ID); if ($cʄυ == 0) { $f = array($C֕[2240] => $cɣ[$C֕[1028]], $C֕[1442] => USER_ID); } goto a; D̹: $Dۤ = $this->add($fǐ); $A = array($C֕[443] => short_id($Dۤ)); $this->where(array($C֕[440] => $Dۤ))->save($A); goto aÉȂ; dߌ: } private function _shareAuthSet($cֳ, $c) { goto Dݹ׊; Eό: $AҠ->where(array($dʄю[441] => $cֳ))->delete(); $aٵ = array(); foreach ($c as $dۗź) { $fܩƗ = SourceModel::TYPE_USER; if ($dۗź[$dʄю[371]] == SourceModel::TYPE_GROUP) { $fܩƗ = SourceModel::TYPE_GROUP; } $d = array($dʄю[441] => $cֳ, $dʄю[371] => $fܩƗ, $dʄю[456] => intval($dۗź[$dʄю[456]]), $dʄю[2246] => 0, $dʄю[2247] => -1); if ($dۗź[$dʄю[2246]]) { $d[$dʄю[2246]] = $dۗź[$dʄю[2246]]; } else { if ($dۗź[$dʄю[2247]]) { $d[$dʄю[2247]] = $dۗź[$dʄю[2247]]; } } $aٵ[] = $d; } goto D؜; Dݹ׊: $dʄю =& $_SERVER[]; if (!is_array($c)) { return !1; } $AҠ = Model($dʄю[2245]); goto Eό; D؜: return $AҠ->addAll($aٵ, array(), !0); goto E; E: } public function numViewAdd($eұ) { $a =& $_SERVER[]; $b̼ = array($a[440] => $eұ); $this->where($b̼)->setAdd($a[2241]); } public function numDownloadAdd($cƇ) { $dΗ =& $_SERVER[]; $cе = array($dΗ[440] => $cƇ); $this->where($cе)->setAdd($dΗ[2242]); } protected function shareEdit($f׊, $F̴) { goto aٿƩ; aν: $this->_checkLinkShare($F̴, $Eق); $bО = array(); $fَ = explode($Fɓ[47], $Fɓ[2248]); goto c; eόƝ: if (isset($F̴[$Fɓ[2234]])) { $this->_shareAuthSet($f׊, $F̴[$Fɓ[2234]]); } return !0; goto C͔; aٿƩ: $Fɓ =& $_SERVER[]; $Eق = $this->getInfo($f׊); if (!$Eق) { return !1; } goto aν; c: foreach ($fَ as $BЧɍ) { if (!array_key_exists($BЧɍ, $F̴)) { continue; } $bО[$BЧɍ] = $F̴[$BЧɍ]; } $this->shareEventAdd($Eق[$Fɓ[369]], $F̴, $Fɓ[2086]); $this->where(array($Fɓ[440] => $f׊))->save($bО); goto eόƝ; C͔: } private function _checkLinkShare($aƧ, $cՙ) { goto FȦ; FȦ: $dě =& $_SERVER[]; if ($aƧ[$dě[446]] != $dě[83]) { return; } $D݉ = $cՙ[$dě[391]][$dě[369]]; goto fϫ; A: $d۸ = $this->shareFileMeta($d[$dě[419]]); if (isset($d۸[$dě[359]]) && $d۸[$dě[359]] == $dě[83]) { show_json(LNG($dě[2251]), !1); } goto b˒ݜ; fϫ: if ($cՙ[$dě[391]][$dě[29]] != $dě[167]) { $EɷҌ = $this->_folderReport($D݉); if (!$EɷҌ) { return; } show_json(LNG($dě[2249]) . $dě[2250] . $EɷҌ, !1); } $d = Model($dě[766])->fileInfoGet($cՙ[$dě[391]][$dě[369]]); if (!$d) { return; } goto A; b˒ݜ: } private function _folderReport($bׯ) { goto Bň; fɥ؄: $e麑ٍ = array($b˛Ϟ[419] => array($b˛Ϟ[7], $c), $b˛Ϟ[459] => array($b˛Ϟ[765], "\x25{$AÓҭ}\45"), $b˛Ϟ[397] => 0); $AȘ = Model($b˛Ϟ[766])->where($e麑ٍ)->field($b˛Ϟ[2253])->find(); if (!$AȘ) { return !1; } goto b; bϵ: if (!$c) { return !1; } $c = array_to_keyvalue($c, $b˛Ϟ[33], $b˛Ϟ[419]); $AÓҭ = $b˛Ϟ[47] . $bׯ . $b˛Ϟ[47]; goto fɥ؄; cИ: $a = array_to_keyvalue($dӹ둲, $b˛Ϟ[33], $b˛Ϟ[28]); $a[] = $AȘ[$b˛Ϟ[28]]; return implode($b˛Ϟ[8], $a); goto eԹ; Bň: $b˛Ϟ =& $_SERVER[]; $e麑ٍ = array($b˛Ϟ[419] => array($b˛Ϟ[938], 0), $b˛Ϟ[702] => 3); $c = Model($b˛Ϟ[2252])->where($e麑ٍ)->field($b˛Ϟ[419])->select(); goto bϵ; b: $e苂 = substr($AȘ[$b˛Ϟ[459]], strpos($AȘ[$b˛Ϟ[459]], $AÓҭ)); $e麑ٍ = array($b˛Ϟ[369] => array($b˛Ϟ[7], trim($e苂, $b˛Ϟ[47]))); $dӹ둲 = Model($b˛Ϟ[766])->where($e麑ٍ)->field($b˛Ϟ[28])->select(); goto cИ; eԹ: } protected function remove($E) { goto D; D: $b =& $_SERVER[]; if (is_array($E)) { $E = array($b[7], $E); } $b = array($b[441] => $E); goto CՇ; CՇ: $f = $this->where($b)->delete(); if ($f) { Model($b[537])->where(array($b[441] => $E))->delete(); } $A = is_array($E) ? $E[1] : array($E); goto D׺; D׺: for ($Bƽ = 0; $Bƽ < count($A); $Bƽ++) { $cߺ = $this->getInfo($A[$Bƽ]); if ($cߺ[$b[448]] == $b[83]) { Model($b[505])->eventShare($cߺ[$b[369]], $b[2239]); } if ($cߺ[$b[446]] == $b[83]) { Model($b[505])->eventShare($cߺ[$b[369]], $b[2238]); } } return $f; goto Eһ; Eһ: } protected function removeBySource($D) { goto F; F: $DƋ =& $_SERVER[]; $f = array($DƋ[383] => array($DƋ[384], $D)); $aް = $this->field($DƋ[441])->where($f)->select(); goto b݉; b݉: $aް = array_to_keyvalue($aް, $DƋ[33], $DƋ[441]); if (!$aް) { return; } $f = array($DƋ[440] => array($DƋ[384], $aް)); goto DЈɺ; DЈɺ: $this->where($f)->delete(); Model($DƋ[537])->where($f)->delete(); goto dЩ; dЩ: } public function listAll($c̤) { goto d; E̵: if ($c̤[$b[715]]) { $aЊ = $c̤[$b[716]] ? $c̤[$b[716]] : strtotime(date($b[2254])); $E،[$b[187]] = array($b[321], array($c̤[$b[715]], $aЊ)); } if ($c̤[$b[29]]) { $E،[$c̤[$b[29]]] = 1; } else { $E،[] = array($b[446] => array($b[938], 0), $b[448] => array($b[938], 0), $b[2229] => $b[2198]); } if ($c̤[$b[2194]]) { $E،[] = array($b[443] => $c̤[$b[2194]], $b[1355] => array($b[765], "\x25{$c̤[$b[2194]]}\x25"), $b[2229] => $b[2198]); } goto d㥣; d: $b =& $_SERVER[]; $E، = array(); if ($c̤[$b[1451]]) { $E،[$b[1451]] = $c̤[$b[1451]]; } goto E̵; d㥣: $Bߧᇈ = $this->_makeOrder()->where($E،)->selectPage(20); if (empty($Bߧᇈ[$b[354]])) { return array(); } $this->_listDataApply($Bߧᇈ[$b[354]]); goto eȱя; eȱя: return $Bߧᇈ; goto BƉ; BƉ: } public function listDataApply($d) { $this->_listDataApply($d); return $d; } private function _listDataApply(&$aęƚ) { $F݄ =& $_SERVER[]; $e = array_to_keyvalue($aęƚ, $F݄[33], $F݄[1451]); $Bڰ = Model($F݄[477])->userListInfo(array_unique($e)); $e = array_to_keyvalue($aęƚ, $F݄[33], $F݄[369]); $fڰ = Model($F݄[766])->sourceListInfo($e, !0); foreach ($aęƚ as &$F϶ďӰ) { $F = $F϶ďӰ[$F݄[1451]]; $F϶ďӰ[$F݄[2255]] = $Bڰ[$F] ? $Bڰ[$F] : !1; $b = $F϶ďӰ[$F݄[369]]; $F϶ďӰ[$F݄[391]] = $fڰ[$b] ? $fڰ[$b] : !1; } } private function _makeOrder($c = '') { goto E; D: $c = $c . "{$C銥}\x20{$FŨ}"; return $this->order($c); goto cɨِ; F: $C銥 = Input::get($F䭒[407], $F䭒[7], $F䭒[389], $c¯); $FŨ = Input::get($F䭒[408], $F䭒[7], $F䭒[2256], array($F䭒[2193], $F䭒[404])); $FŨ = $a߲[$FŨ]; goto D; E: $F䭒 =& $_SERVER[]; $c¯ = array($F䭒[187], $F䭒[716], $F䭒[2241], $F䭒[2242]); $a߲ = array($F䭒[402] => $F䭒[403], $F䭒[404] => $F䭒[405]); goto F; cɨِ: } public function reportAdd($fߋ濤) { $bܝȠ =& $_SERVER[]; $cӤ = array($bܝȠ[441] => $fߋ濤[$bܝȠ[441]], $bܝȠ[1451] => USER_ID); if (Model($bܝȠ[2252])->where($cӤ)->find()) { return !1; } $Bᐓї = array($bܝȠ[441] => $fߋ濤[$bܝȠ[441]], $bܝȠ[1355] => $fߋ濤[$bܝȠ[1355]], $bܝȠ[369] => $fߋ濤[$bܝȠ[369]], $bܝȠ[419] => $fߋ濤[$bܝȠ[419]], $bܝȠ[1451] => USER_ID, $bܝȠ[29] => $fߋ濤[$bܝȠ[29]], $bܝȠ[405] => $fߋ濤[$bܝȠ[405]]); return Model($bܝȠ[2252])->add($Bᐓї); } public function reportList($E) { goto e𩆸; e܌: $cǄ = array($F؍Ћ[402] => $F؍Ћ[403], $F؍Ћ[404] => $F؍Ћ[405]); $f픿 = $F؍Ћ[2260] . $cǄ[$eě]; $Bة = Model($F؍Ћ[2252])->where($Bힳ)->order($f픿)->selectPage(20); goto Aȼ; Aȼ: if (empty($Bة[$F؍Ћ[354]])) { return array(); } $this->_listDataApply($Bة[$F؍Ћ[354]]); return $Bة; goto eةО; A: if (isset($E[$F؍Ћ[29]]) && in_array($E[$F؍Ћ[29]], array($F؍Ћ[83], $F؍Ћ[2257], $F؍Ћ[2258], $F؍Ћ[2259], $F؍Ћ[1934]))) { $Bힳ[$F؍Ћ[29]] = $E[$F؍Ћ[29]]; } if (isset($E[$F؍Ћ[702]]) && in_array($E[$F؍Ћ[702]], array($F؍Ћ[468], $F؍Ћ[83], $F؍Ћ[2257], $F؍Ћ[2258]))) { $Bힳ[$F؍Ћ[702]] = $E[$F؍Ћ[702]]; } $eě = Input::get($F؍Ћ[408], $F؍Ћ[7], $F؍Ћ[2256], array($F؍Ћ[2193], $F؍Ћ[404])); goto e܌; e𩆸: $F؍Ћ =& $_SERVER[]; $Bힳ = array(); if ($E[$F؍Ћ[715]]) { $Dֆ뜫 = $E[$F؍Ћ[716]] ? $E[$F؍Ћ[716]] : strtotime(date($F؍Ћ[2254])); $Bힳ[$F؍Ћ[187]] = array($F؍Ћ[321], array($E[$F؍Ћ[715]], $Dֆ뜫)); } goto A; eةО: } public function reportStatus($eț٘) { goto Dʄ; C䘄: if (!$e箦) { return !1; } $BԬÏ = array($Dˌ[702] => $eț٘[$Dˌ[702]]); if ($eț٘[$Dˌ[702]] == $Dˌ[2258] && $e箦[$Dˌ[702]] == $Dˌ[2258]) { $BԬÏ[$Dˌ[702]] = 0; } goto CՂ; CՂ: $a = Model($Dˌ[2252])->where($a̿)->save($BԬÏ); if ($eț٘[$Dˌ[702]] == $Dˌ[2257]) { if ($e箦[$Dˌ[419]] != $Dˌ[468] && $this->shareFileMeta($e箦[$Dˌ[419]])) { $this->shareFileMeta($e箦[$Dˌ[419]], 0); } $this->remove($e箦[$Dˌ[441]]); return !0; } if ($a && $eț٘[$Dˌ[702]] == $Dˌ[2258]) { $A㎑ = $BԬÏ[$Dˌ[702]] == $Dˌ[2258] ? 1 : 0; $this->shareFileMeta($e箦[$Dˌ[419]], $A㎑); $this->removeByFile($e箦[$Dˌ[419]]); } goto Fė; Dʄ: $Dˌ =& $_SERVER[]; $a̿ = array($Dˌ[367] => $eț٘[$Dˌ[367]]); $e箦 = Model($Dˌ[2252])->where($a̿)->field($Dˌ[2261])->find(); goto C䘄; Fė: return $a; goto F; F: } private function removeByFile($DĲ) { goto Fۭ; b: $a؊ = array($D󲕟[369] => array($D󲕟[7], $f), $D󲕟[446] => 1); $fÆƎŔ = Model($D󲕟[2095])->where($a؊)->field($D󲕟[441])->select(); if (empty($fÆƎŔ)) { return; } goto f힊; f힊: $Eُ = array_to_keyvalue($fÆƎŔ, $D󲕟[33], $D󲕟[441]); $this->remove($Eُ); goto cΎэ; Fۭ: $D󲕟 =& $_SERVER[]; $fÆƎŔ = Model($D󲕟[766])->where(array($D󲕟[419] => $DĲ))->field($D󲕟[369])->select(); $f = array_to_keyvalue($fÆƎŔ, $D󲕟[33], $D󲕟[369]); goto b; cΎэ: } private function shareFileMeta($bӗ, $CÌ㢅 = null) { $cϱ =& $_SERVER[]; $F® = array($cϱ[419] => $bӗ, $cϱ[89] => $cϱ[2262]); if (is_null($CÌ㢅)) { return Model($cϱ[2263])->where($F®)->find(); } $F®[$cϱ[359]] = $CÌ㢅; Model($cϱ[2263])->add($F®, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\x72\x63\x65\137\x61\x75\x74\x68"; public function getAuth($a邃) { goto D؊; e歹: return $f; goto B; dې: $b׺ = $this->field($D)->order($d[367])->where($A羙)->select(); $f = array(); foreach ($b׺ as $Eֽ) { if (Model($d[2265])->listData($Eֽ[$d[2246]])) { $f[] = $Eֽ; } } goto e歹; D؊: $d =& $_SERVER[]; $D = $d[2264]; $A羙 = array($d[369] => $a邃); goto dې; B: } public function setAuth($d, $D) { goto cŻꥋ; f˿ޅ: $E߻ŋ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $aҾ = array(); foreach ($D as $Bڿٛ) { if (!in_array($Bڿٛ[$fج[371]], $E߻ŋ)) { show_json(LNG($fج[2266]), !1); } if ($FȆץ != $Aڶ炒) { if ($Bڿٛ[$fج[371]] == SourceModel::TYPE_GROUP) { } if ($Bڿٛ[$fج[456]] != 0 && !in_array($Bڿٛ[$fج[456]], $dӻߑ)) { } } if ($Bڿٛ[$fج[456]] == 0) { $Bڿٛ[$fج[371]] = SourceModel::TYPE_USER; } $aҾ[] = array($fج[369] => $d, $fج[371] => intval($Bڿٛ[$fج[371]]), $fج[456] => intval($Bڿٛ[$fج[456]]), $fج[2246] => intval($Bڿٛ[$fج[2246]]) ? intval($Bڿٛ[$fج[2246]]) : 0, $fج[2247] => intval($Bڿٛ[$fج[2247]]) ? intval($Bڿٛ[$fج[2247]]) : -1); } goto dʅ; dʅ: $this->where(array($fج[383] => $d))->delete(); $this->addAll($aҾ); return !0; goto B𥛌; DȄ: $Aڶ炒 = 1; $FȆץ = $fض[$fج[456]]; if ($FȆץ != $Aڶ炒) { $bޑ = array($fج[2118] => $FȆץ); $dӻߑ = Model($fج[2192])->field($fج[1451])->where($bޑ)->select(); $dӻߑ = array_to_keyvalue($dӻߑ, $fج[33], $fج[1451]); } goto f˿ޅ; cŻꥋ: $fج =& $_SERVER[]; $fض = Model($fج[1127])->sourceInfo($d); if ($fض[$fج[371]] != SourceModel::TYPE_GROUP) { return !1; } goto DȄ; B𥛌: } public function authClear($dǫ) { $b =& $_SERVER[]; $F = Model($b[1127])->sourceInfo($dǫ); $F = array($dǫ); if ($F[$b[370]] == $b[83]) { $fÖ = array($b[525] => array($b[483], $F[$b[459]] . $dǫ . $b[484])); $F = Model($b[1127])->field($b[383])->where($fÖ)->getField($b[369], !0); $F[] = $dǫ; } $this->where(array($b[383] => array($b[384], $F)))->delete(); return !0; } public function get($aߩܩ) { $f㏯ = $this->getSourceList(array($aߩܩ), !0); return $f㏯[0]; } public function getSourceList($e߆, $B٤ = false) { goto fܤ; fܤ: $a =& $_SERVER[]; if (!$e߆) { return array(); } $F銐 = Model($a[1127]); goto a; aٷ: $bĢғ = array_values(array_unique($bĢғ)); if (!$bĢғ) { return array(); } $Cˊ = $a[2268]; goto Bə; Bə: $DȘ = array($a[383] => array($a[384], $bĢғ)); $C = $this->field($Cˊ)->where($DȘ)->select(); $C = array_to_keyvalue_group($C, $a[369]); goto D; D: $dؒ = array(); foreach ($B٤ as $Cȑ => $Fԗ) { $dؒ[$Cȑ] = $this->makeSourceAuth($Fԗ, $C); } return $dؒ; goto E; a: if (!$B٤) { $DȘ = array($a[383] => array($a[384], $e߆)); $B٤ = $F銐->field($a[2267])->where($DȘ)->select(); $B٤ = array_to_keyvalue($B٤, $a[369]); } $bĢғ = $e߆; foreach ($B٤ as $AК => $fĻģ) { $aʱض = $F銐->parentLevelArray($fĻģ[$a[459]]); $bĢғ = array_merge($bĢғ, $aʱض, array($AК)); } goto aٷ; E: } public function authDeepCheck($Cռ) { goto bڬ֬; bڬ֬: $c =& $_SERVER[]; if (_get($GLOBALS, $c[457])) { return !1; } $b = $this->makeAuthDeep(); goto DͶȊ; Fը: $b = $Dщ ? $Dщ[0] : $Cռ; return array($c[377] => -1, $c[418] => array($c[385] => $c[1041], $c[2124] => $c[468], $c[386] => LNG($c[2271]), $c[2136] => $c[2272]), $c[2273] => array($c[388] => $c[2274], $c[75] => $b)); goto Dޏ; DͶȊ: if (!in_array($Cռ, $b[$c[2269]])) { return !1; } $Dщ = array(); foreach ($b[$c[2270]] as $D֯ => $dɝ) { if (!in_array($Cռ, $dɝ)) { continue; } $Dщ[] = $D֯; } goto Fը; Dޏ: } protected function makeAuthDeep() { goto B׳; F̽: $cܽ⥃ = array(); $C = array(); $c = array(); goto FӉ; b: return $d␊; goto F䞈Ը; aϮ: $b˖Ӵ = Session::get($eǠ[2230]); $b˖Ӵ = array_to_keyvalue($b˖Ӵ, $eǠ[33], $eǠ[2118]); $f̈́ = array($eǠ[371] => SourceModel::TYPE_USER, $eǠ[456] => USER_ID); goto dᮩ; B׳: $eǠ =& $_SERVER[]; static $d␊ = false; if ($d␊) { return $d␊; } goto f壮ɦ; f: $fꐈ = Model($eǠ[1127]); $B륡Ə = Model($eǠ[458]); $Fʜ = array(); goto F̽; f壮ɦ: $d = Model($eǠ[2275])->listData(); $fьƒ = array(); foreach ($d as $Eݿ݃) { if ($Eݿ݃[$eǠ[376]] == 0 && $Eݿ݃[$eǠ[2138]] == $eǠ[83]) { $fьƒ[] = $Eݿ݃[$eǠ[367]]; } } goto aϮ; BЪ: $E՟͜ = array_to_keyvalue($C, $eǠ[33], $eǠ[369]); $dٸ = array(); $C˔ȩ = $b˖Ӵ; goto f; AÛԞ: foreach ($Fʜ as $BǾ => $b薓ɕ) { $fҴ = $cܽ⥃[$BǾ]; if (!$fҴ || !$C[$fҴ]) { continue; } $FƲ = array(); foreach ($c[$fҴ] as $D̒) { $FƲ[] = $C[$D̒]; } $Fʜ[$BǾ] = array_merge($FƲ, $b薓ɕ); } $dٸ = array_values(array_unique($dٸ)); $d␊ = array($eǠ[2269] => $dٸ, $eǠ[2270] => $Fʜ); goto b; d˔: foreach ($eɆܑ as $D̒) { $cɦ = $B륡Ə->getInfo($D̒); $E = $fꐈ->parentLevelArray($cɦ[$eǠ[459]]); $C˔ȩ = array_merge($C˔ȩ, $E); } $C˔ȩ = array_values(array_unique($C˔ȩ)); foreach ($C˔ȩ as $D̒) { $cɦ = $B륡Ə->getInfo($D̒); $dٸ[] = $cɦ[$eǠ[391]][$eǠ[369]]; $C[$D̒] = $cɦ[$eǠ[391]][$eǠ[369]]; $c[$D̒] = $fꐈ->parentLevelArray($cɦ[$eǠ[459]]); } goto AÛԞ; dᮩ: if ($b˖Ӵ) { $f̈́ = array(array($eǠ[371] => SourceModel::TYPE_USER, $eǠ[456] => USER_ID), array($eǠ[371] => SourceModel::TYPE_GROUP, $eǠ[456] => array($eǠ[384], $b˖Ӵ)), $eǠ[926] => $eǠ[2198]); } if ($fьƒ) { $f̈́ = array($f̈́, $eǠ[2246] => array($eǠ[2276], $fьƒ)); } $C = $this->field($eǠ[2277])->where($f̈́)->select(); goto BЪ; FӉ: if ($E՟͜) { $a = $fꐈ->where(array($eǠ[369] => array($eǠ[384], $E՟͜)))->select(); foreach ($a as $a댺Ŀ) { $E = $fꐈ->parentLevelArray($a댺Ŀ[$eǠ[459]]); $dٸ = array_merge($dٸ, $E); $C˔ȩ[] = $a댺Ŀ[$eǠ[456]]; $Fʜ[$a댺Ŀ[$eǠ[369]]] = $E; $cܽ⥃[$a댺Ŀ[$eǠ[369]]] = $a댺Ŀ[$eǠ[456]]; } } $C˔ȩ = array_values(array_unique($C˔ȩ)); $eɆܑ = $C˔ȩ; goto d˔; F䞈Ը: } private function makeSourceAuth($CͲ, $cϦ) { goto b; b: $Cۑ =& $_SERVER[]; $Dʷٛ = Session::get($Cۑ[2230]); $Dʷٛ = array_to_keyvalue($Dʷٛ, $Cۑ[2118]); goto c̭; Fڣ: if (!$dȦ && $CͲ[$Cۑ[371]] == SourceModel::TYPE_GROUP) { $e = $CͲ[$Cۑ[456]]; if (isset($Dʷٛ[$e])) { $b = $Dʷٛ[$e]; $C = Model($Cۑ[458])->getInfo($e); $dȦ = array($Cۑ[2278] => intval($b[$Cۑ[376]][$Cۑ[376]]), $Cۑ[2279] => $b[$Cۑ[376]], $Cۑ[2273] => array($Cۑ[388] => $Cۑ[2283], $Cۑ[75] => $C[$Cۑ[391]][$Cۑ[369]], $Cۑ[2282] => $C[$Cۑ[463]])); return $dȦ; } } if (!$dȦ && $CͲ[$Cۑ[371]] == SourceModel::TYPE_GROUP) { $C = Model($Cۑ[458])->getInfo($CͲ[$Cۑ[456]]); $e = explode($Cۑ[47], trim($C[$Cۑ[459]], $Cۑ[47])); foreach ($e as $e) { if ($e == $Cۑ[468] || $e == $Bݚȫ) { continue; } if (!isset($Dʷٛ[$e])) { continue; } $b = $Dʷٛ[$e]; $dȦ = array($Cۑ[2278] => intval($b[$Cۑ[376]][$Cۑ[376]]), $Cۑ[2279] => $b[$Cۑ[376]], $Cۑ[2273] => array($Cۑ[388] => $Cۑ[2280], $Cۑ[2281] => $C[$Cۑ[391]][$Cۑ[369]], $Cۑ[2282] => $C[$Cۑ[463]])); break; } } if ((!$dȦ || $dȦ[$Cۑ[377]] <= 0) && $CͲ[$Cۑ[371]] == SourceModel::TYPE_GROUP) { $E = $this->authDeepCheck($CͲ[$Cۑ[369]]); if ($E) { $dȦ = $E; } } goto F䣖; F䣖: return $dȦ; goto cԸ­; D: if ($CͲ[$Cۑ[371]] == SourceModel::TYPE_GROUP) { $e = $CͲ[$Cۑ[456]]; if (isset($Dʷٛ[$e]) && !_get($GLOBALS, $Cۑ[457])) { $b = $Dʷٛ[$e]; if (Model($Cۑ[2265])->authCheckRoot($b[$Cۑ[376]][$Cۑ[376]])) { $C = Model($Cۑ[458])->getInfo($e); $dȦ = array($Cۑ[2278] => intval($b[$Cۑ[376]][$Cۑ[376]]), $Cۑ[2279] => $b[$Cۑ[376]], $Cۑ[2273] => array($Cۑ[388] => $Cۑ[2280], $Cۑ[2281] => $C[$Cۑ[391]][$Cۑ[369]], $Cۑ[2282] => $C[$Cۑ[463]])); return $dȦ; } } } $dȦ = !1; foreach ($b走 as $d) { if (!isset($cϦ[$d])) { continue; } $fՔ = $this->authMake($cϦ[$d]); if ($fՔ[$Cۑ[418]]) { $dȦ = $fՔ; break; } } goto Fڣ; c̭: $Bݚȫ = $Cۑ[83]; $b走 = Model($Cۑ[1127])->parentLevelArray($CͲ[$Cۑ[459]]); $b走 = array_merge(array($CͲ[$Cۑ[369]]), array_reverse($b走)); goto D; cԸ­: } public function authOwnerApply($aҎ) { goto B; d򇼑: $aҎ[$c[376]][$c[2286]] = Model($c[474])->userListInfo($FГ); return $aҎ; goto c¾; fԣ: if (count($FГ) == 0) { $FГ = $this->authFolderOwnerGroup($aҎ[$c[456]]); } $FГ = array_unique($FГ); if (AuthModel::authCheckRoot($aҎ[$c[376]][$c[377]])) { $FГ[] = USER_ID; } goto d򇼑; cҏćÍ: $Aӥל = array($c[383] => array($c[384], $C)); $Aҟ = $this->field($d)->where($Aӥל)->select(); $Aҟ = array_to_keyvalue_group($Aҟ, $c[369]); goto fθ; fθ: $Fߒݫ = array(); $FГ = array(); foreach ($Aҟ as $a => $F) { $a = $this->authFolderOwnerUser($F); $Fߒݫ[$a] = $a; $FГ = array_merge($FГ, $a[$c[535]]); if ($a[$c[2285]]) { break; } } goto fԣ; B: $c =& $_SERVER[]; if (empty($aҎ[$c[376]]) || isset($aҎ[$c[2284]]) && $aҎ[$c[2284]]) { return $aҎ; } if (AuthModel::authCheckRoot($aҎ[$c[376]][$c[377]])) { return $aҎ; } goto b; b: $C = Model($c[1127])->parentLevelArray($aҎ[$c[459]]); $C = array_merge(array($aҎ[$c[369]]), array_reverse($C)); $d = $c[2268]; goto cҏćÍ; c¾: } private function authFolderOwnerGroup($AԌϏ) { $f =& $_SERVER[]; $c = Model($f[2192])->where(array($f[2118] => $AԌϏ))->select(); $dώɂ = array(); if (!$c) { return $dώɂ; } foreach ($c as $e¡ē) { $C떾 = $this->authInfo($e¡ē); if (AuthModel::authCheckRoot($C떾[$f[376]])) { $dώɂ[] = $e¡ē[$f[1451]]; } } return $dώɂ; } private function authFolderOwnerUser($dӉ) { $D =& $_SERVER[]; $c뼖 = array(); $Fͮ = !1; foreach ($dӉ as $c¯푓) { $Eؔ = $this->authInfo($c¯푓); if ($c¯푓[$D[456]] == $D[468]) { $Fͮ = !0; } if ($c¯푓[$D[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Eؔ[$D[376]])) { $c뼖[] = $c¯푓[$D[456]]; } } } return array($D[535] => $c뼖, $D[2285] => $Fͮ); } public function authMake($E혵֜) { goto e̹򈼓; cה: $FХ = $bߒۼ ? $EĽ : ($c ? $B : $cΠ쫩); $bث = $bߒۼ ? $c䢅 : ($c ? $F : $C); $Cߩ = $bߒۼ ? $B[2287] : ($c ? $B[2288] : ($FР ? $B[2289] : $B[361])); goto bߦ; F̧函: $cΠ쫩 = 0; $c䢅 = 0; $F = 0; goto A׆; A׆: $C = 0; $bߒۼ = 0; $c = 0; goto c۞; e̹򈼓: $B =& $_SERVER[]; if (!$E혵֜) { return array($B[377] => 0, $B[418] => !1); } $Cʤʏ = Session::get($B[2230]); goto Dԍ; c۞: $FР = 0; $DӇ = array($B[369] => 0); foreach ($E혵֜ as $DӇ) { $bث = $this->authInfo($DӇ); $D􉈉 = $DӇ[$B[456]]; $bߨܦ = intval($bث[$B[376]]); if ($DӇ[$B[371]] == SourceModel::TYPE_USER && $D􉈉 == USER_ID) { $bߒۼ = !0; $c䢅 = $bث; $EĽ = $bߨܦ; } else { if ($DӇ[$B[371]] == SourceModel::TYPE_GROUP && in_array($D􉈉, $FΊ)) { $c = !0; if ($bߨܦ >= $B) { $B = $bߨܦ; $F = $bث; } } else { if ($D􉈉 == $B[468]) { $FР = !0; $C = $bث; $cΠ쫩 = $bߨܦ; } } } } goto cה; bߦ: $DΚԒ = array($B[2278] => intval($FХ), $B[2279] => $bث, $B[2273] => array($B[388] => $Cߩ, $B[75] => $DӇ[$B[369]])); return $DΚԒ; goto Eɐ熔; Dԍ: $FΊ = array_to_keyvalue($Cʤʏ, $B[33], $B[2118]); $EĽ = 0; $B = 0; goto F̧函; Eɐ熔: } public function authTargetInfoMake($E) { goto eҟ; D: foreach ($E as $bܜ㈱) { if ($bܜ㈱[$Fʷ[371]] == SourceModel::TYPE_USER) { $A[] = intval($bܜ㈱[$Fʷ[456]]); } else { if ($bܜ㈱[$Fʷ[371]] == SourceModel::TYPE_GROUP) { $eݺ[] = intval($bܜ㈱[$Fʷ[456]]); } } } if ($A) { $A = Model($Fʷ[474])->userListInfo($A); } if ($eݺ) { $aش = array($Fʷ[2190] => array($Fʷ[384], $eݺ)); $eݺ = Model($Fʷ[458])->field($Fʷ[2203])->where($aش)->select(); $eݺ = array_to_keyvalue($eݺ, $Fʷ[2118]); } goto b΋; b΋: return array($Fʷ[2290] => $A, $Fʷ[2282] => $eݺ); goto FƗ; eҟ: $Fʷ =& $_SERVER[]; $A = array(); $eݺ = array(); goto D; FƗ: } private function authInfo($CʖߝǕ) { $A˙ =& $_SERVER[]; if ($CʖߝǕ[$A˙[2246]]) { $aߊ = Model($A˙[2265])->listData($CʖߝǕ[$A˙[2246]]); if (!$aߊ) { return !1; $D = Model($A˙[2265])->listData(); $cӱ = array_filter_by_field($D, $A˙[376], $A˙[468]); return $cӱ; } $a = array_field_key($aߊ, array($A˙[367], $A˙[28], $A˙[376], $A˙[2136], $A˙[2139])); $a[$A˙[2291]] = $CʖߝǕ; return $a; } else { return array($A˙[385] => 0, $A˙[2124] => $CʖߝǕ[$A˙[2247]], $A˙[386] => $A˙[33], $A˙[2136] => $A˙[2292]); } } } goto e; B͓ڡ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\x6d\x2e\164\141\x73\153\x4c\x69\x73\164"; public $field = array("\156\141\155\x65", "\x74\x79\x70\145", "\145\x76\x65\156\x74", "\x74\151\x6d\x65", "\144\x65\163\x63", "\x73\171\x73\164\x65\155", "\x65\156\141\142\x6c\145", "\x6c\x61\x73\x74\x52\x75\156", "\x73\x6f\x72\x74"); public function listData($dߵ = false, $bՍ͇ = "\163\157\162\164", $Eٍ = false) { return parent::listData($dߵ, $bՍ͇, $Eٍ); } public function add($A) { $b̩ =& $_SERVER[]; $e܈ = $this->findByName($A[$b̩[28]]); if ($e܈) { return !1; } $A[$b̩[1416]] = 0; $A[$b̩[2139]] = $this->getSort(); return parent::insert($A); } private function getSort() { $Fґ˅ =& $_SERVER[]; $a߉ܡ = parent::listData(); $F蠞 = array_to_keyvalue($a߉ܡ, $Fґ˅[33], $Fґ˅[2139]); return empty($F蠞) ? 0 : max($F蠞) + 1; } public function update($eͷķ, $d) { $D =& $_SERVER[]; $F޹ = $this->listData($eͷķ); $a = $this->findByName($d[$D[28]]); if (!$F޹ || $a && $a[$D[367]] != $F޹[$D[367]]) { return !1; } return parent::update($eͷķ, $d); } public function remove($b, $a = false) { $Fӏ =& $_SERVER[]; $D߽đ = $this->listData($b); if (!$D߽đ) { return; } if (!$a && $D߽đ[$Fӏ[1090]] == $Fӏ[83]) { return !1; } return parent::remove($b); } public function enable($B, $d੒) { return $this->update($B, array($_SERVER[][2490] => $d੒)); } public function run($D҅) { return $this->update($D҅, array($_SERVER[][2501] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\162\x5f\146\x61\166"; protected function cacheFunctionAlias($F홿Ҷ) { $D܆ =& $_SERVER[]; return array($D܆[2502] => array(USER_ID, $D܆[2503])); } protected function listData() { $f =& $_SERVER[]; $cķ݆ = array($f[1442] => USER_ID, $f[436] => 0); $DЯ = $f[2504]; $e = $this->field($DЯ)->where($cķ݆)->order($f[2505])->select(); return $e ? $e : array(); } protected function resetCache() { } protected function listView() { goto a˥; dг: $Cݿ = array_to_keyvalue($EοȐ, $E[33], $E[75]); if (!$Cݿ) { return $F; } $AᒹƝ = 2000; goto Aþ; a˥: $E =& $_SERVER[]; $F = $this->listData(); $EοȐ = array_filter_by_field($F, $E[29], $E[382]); goto dг; Aþ: $E͉ؑ = array($E[383] => array($E[384], $Cݿ)); $Eג = Model($E[766])->listSource($E͉ؑ, $AᒹƝ); $Eג = array_merge($Eג[$E[73]], $Eג[$E[74]]); goto bԐ; bԐ: $Eג = array_to_keyvalue($Eג, $E[369]); foreach ($F as $aܱ => $B煪) { $a̭ = $Eג[$B煪[$E[75]]]; $a̭ = $a̭ ? $a̭ : array(); $F[$aܱ] = array_merge($a̭, $B煪); } return $F; goto e˾; e˾: } protected function addFav($e, $d = '', $Cَ = "\163\157\165\162\x63\x65") { goto d; CԮժ: $D׊ = array($e⨂[1442] => USER_ID, $e⨂[436] => 0); $f = $this->where($D׊)->max($e⨂[2139]); if (!$f) { $f = 0; } goto C҆; d: $e⨂ =& $_SERVER[]; $D׊ = array($e⨂[1442] => USER_ID, $e⨂[436] => 0, $e⨂[388] => $Cَ, $e⨂[387] => $e); if ($this->where($D׊)->find()) { return !1; } goto CԮժ; Eԍ: return $this->add($e); goto CԌў; C҆: if (!$d && $Cَ == $e⨂[382]) { $fΡ = Model($e⨂[1127])->where(array($e⨂[383] => $e))->find(); if (!$fΡ) { return !1; } $d = $fΡ[$e⨂[28]]; } $d = $this->getAutoName($d); $e = array($e⨂[1442] => USER_ID, $e⨂[436] => 0, $e⨂[386] => $d, $e⨂[387] => $e, $e⨂[388] => $Cَ, $e⨂[2122] => $f + 1); goto Eԍ; CԌў: } protected function remove($fݖѠ) { $bɫѵ =& $_SERVER[]; $C = array($bɫѵ[1442] => USER_ID, $bɫѵ[385] => $fݖѠ); return $this->where($C)->delete(); } protected function removeByName($cۃ) { $bʩ瞃 =& $_SERVER[]; $f = array($bʩ瞃[1442] => USER_ID, $bʩ瞃[386] => $cۃ, $bʩ瞃[436] => 0); return $this->where($f)->delete(); } protected function rename($Dʄ۲, $aΚ) { $Eϡ =& $_SERVER[]; if ($Dʄ۲ == $aΚ) { return !1; } $aȱ = $this->getAutoName($aΚ); if ($aΚ != $aȱ) { return !1; } $cܝɋĆ = array($Eϡ[1442] => USER_ID, $Eϡ[436] => 0, $Eϡ[28] => $Dʄ۲); return $this->where($cܝɋĆ)->save(array($Eϡ[28] => $aΚ)); } protected function resetSort($Fظ) { $bÃ =& $_SERVER[]; $Fظ = is_array($Fظ) ? $Fظ : array(); $B՚ = array($bÃ[1442] => USER_ID); for ($Bɪ = 0; $Bɪ < count($Fظ); $Bɪ++) { $B՚[$bÃ[385]] = $Fظ[$Bɪ]; $this->where($B՚)->save(array($bÃ[2122] => $Bɪ + 1)); } return !0; } protected function moveTop($Bۈž) { goto c蔱; B: $B֤ = $cȣē; $cȣē = array_remove_value($cȣē, $F[$b[367]]); array_unshift($cȣē, $F[$b[367]]); goto b; b: return $this->resetSort($cȣē); goto e˙; eô򟛓: if (!$F) { return; } $cȣē = $this->field($b[367])->where($f̮ތ)->order($b[2505])->select(); $cȣē = array_to_keyvalue($cȣē, $b[33], $b[367]); goto B; c蔱: $b =& $_SERVER[]; $f̮ތ = array($b[1442] => USER_ID, $b[436] => 0); $F = $this->where($f̮ތ)->where(array($b[28] => $Bۈž))->find(); goto eô򟛓; e˙: } protected function moveBottom($F菸) { $bѡ =& $_SERVER[]; $Fơ = array($bѡ[1442] => USER_ID, $bѡ[436] => 0); $Cז = $this->where($Fơ)->max($bѡ[2139]); $Cč = array($bѡ[2139] => $Cז + 1); return $this->where($Fơ)->where(array($bѡ[28] => $F菸))->save($Cč); } private function getAutoName($B𐟯) { goto Eɖ; D䠦: return $B𐟯 . "\50{$F}\x29"; goto BԎ; E: $b՜ά = array_to_keyvalue($b՜ά, $B姲[33], $B姲[28]); if (!$b՜ά || !in_array($B𐟯, $b՜ά)) { return $B𐟯; } for ($F = 0; $F < count($b՜ά); $F++) { if (!in_array($B𐟯 . "\x28{$F}\51", $b՜ά)) { return $B𐟯 . "\50{$F}\x29"; } } goto D䠦; Eɖ: $B姲 =& $_SERVER[]; $Bۖ = array($B姲[1442] => USER_ID, $B姲[436] => 0); $b՜ά = $this->field($B姲[28])->where($Bۖ)->select(); goto E; BԎ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\152\x6f\x62\x4c\x69\163\x74"; public $field = array("\x6e\141\155\145", "\144\x65\x73\x63", "\x73\x6f\x72\x74"); const JOB_KEY = "\x73\145\154\146\x4a\x6f\x62\x4c\151\163\164"; public function listData($Dŉ = false, $D불 = "\163\157\162\164", $F̋醢 = false) { return parent::listData($Dŉ, $D불, $F̋醢); } public function remove($eĉ) { return parent::remove($eĉ); } public function add($E) { $Dǧ =& $_SERVER[]; if ($this->findByName($E[$Dǧ[28]])) { return !1; } $E[$Dǧ[2139]] = $this->getSort(); return parent::insert($E); } private function getSort() { $eȏ =& $_SERVER[]; $C熑 = parent::listData(); $Ď = array_to_keyvalue($C熑, $eȏ[33], $eȏ[2139]); return empty($Ď) ? 0 : max($Ď) + 1; } public function update($DϤ, $b򯐱) { $c =& $_SERVER[]; $CȎČ = parent::listData($DϤ); $bݹ = $this->findByName($b򯐱[$c[28]]); if (!$CȎČ || $bݹ && $bݹ[$c[367]] != $CȎČ[$c[367]]) { return !1; } return parent::update($DϤ, $b򯐱); } public function setUserJob($Aڋ, $Bԏ) { goto F; C: $Fх = array_to_keyvalue($eյ, $c[28]); $Eƍ = $c[361]; foreach ($Bԏ as $b) { if ($Fх[$b]) { $Eƍ .= $Fх[$b][$c[367]] . $c[47]; } else { $e瓬 = $this->add($b); $Eƍ .= $e瓬 . $c[47]; } } goto dé; F: $c =& $_SERVER[]; if (!is_array($Bԏ)) { $Bԏ = array($Bԏ); } $eյ = parent::listData(); goto C; dé: $Eƍ = rtrim($Eƍ, $c[47]); Model($c[477])->metaSet($Aڋ, self::JOB_KEY, $Eƍ); goto F񣑟; F񣑟: } public function getUserJob($fγ) { $b͍ = Model($_SERVER[][477])->metaGet($fγ); return $this->getUserJobInfo($b͍[self::JOB_KEY]); } public function getUserJobInfo($Dë) { goto aψ; BŐΈ: return $B͕͒; goto bջ; aψ: $d =& $_SERVER[]; $E = explode($d[47], $Dë); $B۳ = parent::listData(); goto D뾆; D뾆: $B۳ = array_remove_key($B۳, $d[187]); $B͕͒ = array(); foreach ($E as $Fʠ) { if (isset($B۳[$Fʠ])) { $B͕͒[] = $B۳[$Fʠ]; } } goto BŐΈ; bջ: } } goto Cߒֺ; E: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($e񡙿) { parent::__construct(); require_once SDK_DIR . $_SERVER[][1223]; $this->_init($e񡙿); } public function _init($dǌ֌) { foreach ($dǌ֌ as $eȤ => $FԂ) { if (isset($this->{$eȤ})) { $this->{$eȤ} = $FԂ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[][1224], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($eʞш, $cםż = '', $Aگ = REPEAT_RENAME) { if ($this->setContent($eʞш, $cםż)) { return $this->getPathOuter($eʞш); } return !1; } public function mkdir($F󊂽, $dÝ = REPEAT_SKIP) { goto bƓ; bƓ: $B =& $_SERVER[]; $c = trim($F󊂽, $B[8]); if ($this->_isFolder($c)) { return $this->getPathOuter($c); } goto b; a: if (!$this->mkfile($dћ)) { return !1; } if (!$this->moveFile($dћ, $F󊂽)) { $this->delFile($dћ); return !1; } return $this->getPathOuter($c); goto B; b: $F󊂽 = $c . $B[8]; $C׮ = get_path_this($c); $dћ = $F󊂽 . $C׮; goto a; B: } public function copyFile($D, $Aҍ) { $Aըו = $this->bucketManager->copy($this->bucket, $D, $this->bucket, $Aҍ, !0); return $Aըו ? !1 : !0; } public function moveFile($D, $f) { $f־ = $this->bucketManager->move($this->bucket, $D, $this->bucket, $f, !0); return $f־ ? !1 : !0; } public function delFile($Dۊ) { $b̌ = $this->bucketManager->delete($this->bucket, $Dۊ); return $b̌ ? !1 : !0; } public function delFolder($CΕ) { $C = $this->fileList($CΕ); if (empty($C)) { return !0; } $A = 1000; if (count($C) <= $A) { return $this->qnDelObj($C) ? !1 : !0; } foreach (array_chunk($C, $A) as $B) { $Cŝ = $this->qnDelObj($B); if ($Cŝ) { return !1; } } return !0; } private function qnDelObj($a) { $C߄ج = $this->bucketManager->buildBatchDelete($this->bucket, $a); list($A, $D) = $this->bucketManager->batch($C߄ج); return $D; } private function fileList($f, $e = 0) { goto D߾; D߾: $DȊ =& $_SERVER[]; $f = trim($f, $DȊ[8]); $A޶ = empty($f) ? $DȊ[33] : $f . $DȊ[8]; goto e칰; e칰: $Aև = $DȊ[33]; $a = 1000; $D = $DȊ[33]; goto Eʥ; Eʥ: $C = array(); while (!0) { list($F㐼, $Cд) = $this->bucketManager->listFiles($this->bucket, $A޶, $Aև, $a, $D); if ($Cд) { return !1; } $Aև = array_key_exists($DȊ[1194], $F㐼) ? $Aև = $F㐼[$DȊ[1225]] : $DȊ[33]; foreach ($F㐼[$DȊ[1226]] as $dľ) { $aӟө = $dľ[$DȊ[89]]; if ($e) { $aӟө = array($DȊ[28] => $aӟө, $DȊ[77] => $dľ[$DȊ[1227]]); } $C[] = $aӟө; } if ($Aև == $DȊ[33]) { break; } } return $C; goto EوȒ; EوȒ: } public function rename($eʨ, $Aʖ) { return $this->renameObject($eʨ, $Aʖ); } public function fileInfo($B, $B虱 = false, $e = array()) { goto c; eà: if (empty($e)) { $e = $this->objectMeta($B); if (!$e) { return $FĹ; } } if (isset($e[$bڢ[1228]])) { $FĹ[$bڢ[187]] = $e[$bڢ[1228]]; } if (isset($e[$bڢ[1227]])) { $FĹ[$bڢ[77]] = $e[$bڢ[1227]]; } goto A´湧; c: $bڢ =& $_SERVER[]; if ($B虱) { return array($bڢ[28] => $this->pathThis($B), $bڢ[75] => $this->getPathOuter($bڢ[8] . $B), $bڢ[29] => $bڢ[167], $bڢ[77] => isset($e[$bڢ[1227]]) ? $e[$bڢ[1227]] : 0, $bڢ[160] => $this->ext($B)); } $FĹ = array($bڢ[28] => $this->pathThis($B), $bڢ[75] => $this->getPathOuter($bڢ[8] . $B), $bڢ[29] => $bڢ[167], $bڢ[187] => 0, $bڢ[107] => 0, $bڢ[77] => 0, $bڢ[160] => $this->ext($B), $bڢ[188] => !0, $bڢ[189] => !0); goto eà; A´湧: return $FĹ; goto C݊; C݊: } public function folderInfo($a, $A͋ = false) { goto C; B: return $A㐻; goto Bޜ; C: $a޷ =& $_SERVER[]; if ($A͋) { return array($a޷[28] => $this->pathThis($a), $a޷[75] => $this->getPathOuter($a޷[8] . $a), $a޷[29] => $a޷[76]); } $A㐻 = array($a޷[28] => $this->pathThis($a), $a޷[75] => $this->getPathOuter($a޷[8] . $a), $a޷[29] => $a޷[76], $a޷[187] => 0, $a޷[107] => 0, $a޷[1171] => !0, $a޷[1172] => !0); goto eА; eА: $a = rtrim($a, $a޷[8]) . $a޷[8]; $c欌 = $this->objectMeta($a); if (isset($c欌[$a޷[1228]])) { $A㐻[$a޷[187]] = $c欌[$a޷[1228]]; } goto B; Bޜ: } public function listPath($d, $Bܣ˒ = false) { goto bÈ; bÈ: $fȟՄ =& $_SERVER[]; $d = trim($d, $fȟՄ[8]); $e峧 = empty($d) ? $fȟՄ[33] : $d . $fȟՄ[8]; goto bל; bל: $F = $fȟՄ[33]; $cҚݥ = 1000; $E없 = $fȟՄ[8]; goto B̰; B̰: $e = $E㑼 = array(); while (!0) { list($c߂, $aͳ) = $this->bucketManager->listFiles($this->bucket, $e峧, $F, $cҚݥ, $E없); if ($aͳ) { return !1; } $F = array_key_exists($fȟՄ[1194], $c߂) ? $F = $c߂[$fȟՄ[1225]] : $fȟՄ[33]; if (isset($c߂[$fȟՄ[1229]])) { foreach ($c߂[$fȟՄ[1229]] as $Dޥ) { if ($Dޥ == $e峧) { continue; } $e[] = $this->folderInfo($Dޥ, $Bܣ˒); } } if (isset($c߂[$fȟՄ[1226]])) { foreach ($c߂[$fȟՄ[1226]] as $C) { if ($C[$fȟՄ[89]] == $e峧) { continue; } $E㑼[] = $this->fileInfo($C[$fȟՄ[89]], $Bܣ˒, $C); } } if ($F == $fȟՄ[33]) { break; } } return array($fȟՄ[74] => $e, $fȟՄ[73] => $E㑼); goto e; e: } public function has($A﫚, $a噑 = false, $b맄 = true) { goto bڊۺ; bڊۺ: $D˶̌ =& $_SERVER[]; $A﫚 = trim($A﫚, $D˶̌[8]); $B = empty($A﫚) ? $D˶̌[33] : $A﫚 . $D˶̌[8]; goto A҆ՙ; A҆ՙ: $C = $D˶̌[33]; $eؑ = 1000; $Bފ = $D˶̌[8]; goto Aȓ; Aȓ: $aǇ = 0; $Cξϖ = 0; while (!0) { list($d, $aڨ) = $this->bucketManager->listFiles($this->bucket, $B, $C, $eؑ, $Bފ); if ($aڨ) { return !1; } $C = array_key_exists($D˶̌[1194], $d) ? $C = $d[$D˶̌[1225]] : $D˶̌[33]; if ($a噑) { if (!empty($d[$D˶̌[1226]])) { $aǇ += count($d[$D˶̌[1226]]); } if (!empty($d[$D˶̌[1229]])) { $Cξϖ += count($d[$D˶̌[1229]]); } if ($C === $D˶̌[33]) { break; } continue; } if ($b맄) { if (!empty($d[$D˶̌[1226]])) { return !0; } } else { if (!empty($d[$D˶̌[1229]])) { return !0; } } if ($C == $D˶̌[33]) { break; } } goto Fɻ; Fɻ: if ($a噑) { return array($D˶̌[191] => $aǇ, $D˶̌[192] => $Cξϖ); } return !1; goto aێ; aێ: } public function listAll($bҤȰ) { $e =& $_SERVER[]; $BȰ = $this->fileList($bҤȰ, 1); $C = array(); foreach ($BȰ as $D) { $C[$D[$e[28]]] = $D[$e[77]]; } return $this->listAllFiles($bҤȰ, array_keys($C), $C); } public function canRead($b˘鰸) { return $this->exist($b˘鰸) ? !0 : !1; } public function canWrite($EՋ) { return $this->exist($EՋ) ? !0 : !1; } public function getContent($dˉ) { return $this->fileSubstr($dˉ, 0, -1); } public function setContent($DȢ, $e = '') { $FǗţ = $this->tempFile($this->pathThis($DȢ)); file_put_contents($FǗţ, $e); if ($this->upload($DȢ, $FǗţ)) { $this->tempFileRemve($FǗţ); return !0; } return !1; } public function refreshUrls($e) { goto b; f: return $fۡ[$Bᇹϰ[1230]] == $Bᇹϰ[709] ? !0 : !1; goto fϾ˳; b: $eȬ = new Qiniu\Cdn\CdnManager($this->auth); list($fۡ, $b䓖) = $eȬ->refreshUrls($b˗); if ($b䓖) { return !1; } goto f; b: $Bᇹϰ =& $_SERVER[]; $b˗ = array(); if (is_array($e)) { foreach ($e as $F) { $b˗[] = $this->link($F); } } else { $b˗[] = $this->link($e); } goto b; fϾ˳: } public function fileSubstr($aʰﵠ, $cϻ, $EГ) { $Fɯ =& $_SERVER[]; if (!($b͋ݏ = $this->link($aʰﵠ))) { return !1; } $Bԕ = !1; if ($EГ > 0) { $aп = $cϻ + $EГ - 1; $Bԕ = array($Fɯ[1231] . $cϻ . $Fɯ[412] . $aп); } $F풮 = url_request($b͋ݏ, $Fɯ[216], !1, $Bԕ); return $F풮[$Fɯ[702]] ? $F풮[$Fɯ[1044]] : !1; } public function upload($B, $D, $ȩ̬׆ = false, $cؾш = REPEAT_REPLACE) { $d = new Qiniu\Storage\UploadManager(); $b̘ȩ = $this->auth->uploadToken($this->bucket, $B); $fվۆ = get_file_mime(get_path_ext($D)); list($f, $A׼) = $d->putFile($b̘ȩ, $B, $D, null, $fվۆ); return $A׼ ? !1 : $this->getPathOuter($B); } public function uploadFormData($EӨ, $eɪ = 3600) { return $this->uploadToken($EӨ, $eɪ); } public function multiUploadFormData($E⫱, $F = 3600) { return $this->uploadToken($E⫱, $F); } private function uploadToken($E낫, $eجڛ = 3600) { goto b䯾; b䯾: $f㯢 =& $_SERVER[]; $d܌ = $eجڛ; $A = array($f㯢[1232] => $f㯢[1233]); goto e; e: $e΂ = null; $E = $this->auth->uploadToken($this->bucket, $e΂, $d܌, $A, !0); $A܆ = empty($this->region) || $this->region == $f㯢[1234] ? $f㯢[33] : $f㯢[412] . $this->region; goto d䑩; d䑩: $d = http_type() . "\72\57\57\x75\160\x6c\157\141\144{$A܆}\56\x71\151\x6e\x69\x75\x70\x2e\143\157\155\57"; return array($f㯢[1235] => $E, $f㯢[1236] => $d); goto A; A: } public function download($c׊, $aպ) { goto AÆ; E: fclose($Cڬ); return $aպ; goto C; AÆ: $EǬ쇻 = IO::getPathInner(IO::mkfile($aպ)); if (!($Eѷ = $this->link($c׊))) { return !1; } $cԗͲ = 0; goto Aɝ; Aɝ: $A麶 = 1024 * 200; $Cڬ = fopen($EǬ쇻, $_SERVER[][1237]); while (!0) { $F = $this->fileSubstr($c׊, $cԗͲ, $A麶); if ($F === !1) { return !1; } fwrite($Cڬ, $F); $cԗͲ += $A麶; if (strlen($F) < $A麶) { break; } } goto E; C: } public function link($Fî股, $D̥Բ = '') { if (!$this->isFile($Fî股)) { return !1; } $Bș = $this->getHost() . $_SERVER[][8] . $this->pathEncode($Fî股) . $D̥Բ; return $this->auth->privateDownloadUrl($Bș, 3600 * 12); } public function fileOut($CٚĈ, $Aﰹ = false, $Cذ͗ = false, $CҚ = '') { $d =& $_SERVER[]; if (!$Cذ͗) { $Cذ͗ = $this->pathThis($CٚĈ); } $aƆʷ = $Aﰹ ? $d[1238] . rawurlencode($Cذ͗) : $d[33]; $d믏 = $this->link($CٚĈ, $aƆʷ); $this->fileOutLink($d믏); } public function fileOutServer($fи, $B = false, $e߬ = false, $b = '') { parent::fileOut($fи, $B, $e߬, $b); } public function fileOutImage($Eα, $eڕ = 250) { $eÓ = $this->link($Eα, $_SERVER[][1239] . $eڕ); $this->fileOutLink($eÓ); } public function fileOutImageServer($cН, $D = 250) { parent::fileOutImage($cН, $D); } public function hashMd5($D̳) { $E髑 =& $_SERVER[]; $cۧڥ = $this->objectMeta($D̳); return isset($cۧڥ[$E髑[196]]) ? $cۧڥ[$E髑[196]] : !1; $F鶚 = $this->link($D̳, $E髑[1240]); } public function size($dù) { $Eΐ = $this->objectMeta($dù); return $Eΐ ? $Eΐ[$_SERVER[][77]] : 0; } public function info($aՊ) { if ($this->isFolder($aՊ)) { return $this->folderInfo($aՊ); } else { if ($this->isFile($aՊ)) { return $this->fileInfo($aՊ); } } return !1; } public function exist($FԒ) { return $this->isFile($FԒ) || $this->isFolder($FԒ); } public function isFile($b߄ő) { return !$this->isFolder($b߄ő) && $this->objectMeta($b߄ő); } public function isFolder($e꩏) { return $this->cacheMethod($_SERVER[][223], $e꩏); } protected function objectMeta($e퇽) { return $this->cacheMethod($_SERVER[][224], $e퇽); } protected function _objectMeta($b) { $b؛ =& $_SERVER[]; list($Cǳ, $cҌ) = $this->bucketManager->stat($this->bucket, $b); if ($Cǳ) { $Cǳ[$b؛[77]] = intval($Cǳ[$b؛[1227]]); } return $Cǳ; } protected function _isFolder($C؄ཎ) { $e˅ =& $_SERVER[]; list($D, $cݎ) = $this->bucketManager->listFiles($this->bucket, trim($C؄ཎ, $e˅[8]) . $e˅[8], $e˅[33], 1, $e˅[8]); return !empty($D[$e˅[1226]]) || !empty($D[$e˅[1229]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($d凝) { parent::__construct($d凝); } public function uploadFormData($aㄟ, $f = 3600) { goto c; fϕډ: $C־۽ = array($this->accessKey, $D͞, $this->region, $BЇܕ, $b); $b۱ = implode($f[8], $C־۽); $Aڏ = array($f[1112] => gmdate($f[1111], strtotime($f[1146])), $f[1113] => array(array($f[1115] => $this->bucket), array($f[1114] => $f俓), array($f[1116], $f[1117], $f[33]), array($f[1116], $f[1147], $f[33]), array($f[1116], $f[1148], $f[33]), array($f[1118] => $eߩ), array($f[1149] => $b۱), array($f[1150] => $F), array($f[1151] => $B), array($f[1152] => $c))); goto d各; Cк: $fձ = hash_hmac($f[1153], $BЇܕ, $Fㄌ, !0); $FՑ = hash_hmac($f[1153], $b, $fձ, !0); $D숱ԕ = hash_hmac($f[1153], $e, $FՑ); goto aꃊ; d各: $e = base64_encode(json_encode($Aڏ)); $fף = hash_hmac($f[1153], $D͞, $f[1154] . $this->secret, !0); $Fㄌ = hash_hmac($f[1153], $this->region, $fף, !0); goto Cк; aꃊ: $F = array($f[199] => $f[33], $f[1155] => $f[33], $f[1114] => $f俓, $f[1118] => $eߩ, $f[1122] => $e, $f[1156] => $b۱, $f[1157] => $F, $f[1158] => $B, $f[1159] => $c, $f[1160] => $D숱ԕ, $f[169] => $this->getHost()); return $F; goto eڍ; dܢ: $b = $f[1145]; $c = $f . $f[33]; $eߩ = $f[1110]; goto fϕډ; c: $f =& $_SERVER[]; $f俓 = $f[185]; $F = $f[1143]; goto A͹; A͹: $BЇܕ = $f[59]; $B = gmdate($f[1144]); $D͞ = gmdate($f[703]); goto dܢ; eڍ: } public function multiUploadFormData($F, $b = 3600) { $Dܸ =& $_SERVER[]; $C؉ء = gmdate($Dܸ[1241]); $cԷ = array(); $CǕ҇ = $this->client->getUploadId($this->bucket, $F, $cԷ); if (!$CǕ҇) { return !1; } return array($Dܸ[209] => $CǕ҇, $Dܸ[169] => $this->getHost() . $Dܸ[8] . $this->pathEncode($F), $Dܸ[210] => $C؉ء, $Dܸ[89] => $F); } public function multiUploadAuthData($f, $B = array()) { goto a݆; Eṵ̈́: unset($B[$B܊[89]]); if (isset($B[$B܊[211]])) { return $this->listUploadParts($C, $B); } $Fȉ = array(); goto f򄇋; a݆: $B܊ =& $_SERVER[]; $Cὸ = isset($B[$B܊[160]]) ? $B[$B܊[160]] : $B܊[33]; $C = $B[$B܊[89]]; goto Eṵ̈́; Eأ: $CɊ = $B܊[214]; $a㹇 = $B܊[8] . $this->pathEncode($C) . $Cὸ; $C = $this->client->__getSignatureV4($Fȉ, $f胩ۜ, $CɊ, $a㹇); goto E; f򄇋: if (isset($B[$B܊[1242]])) { $Fȉ[$B܊[1243]] = $B[$B܊[1242]]; } $Dݤ = explode($B܊[171], $this->getHost()); $f胩ۜ = array($B܊[1244] => $Dݤ[1], $B܊[1245] => $B܊[33], $B܊[199] => $B܊[116], $B܊[1155] => $B[$B܊[77]]); goto Eأ; E: if (strpos($Cὸ, $B܊[213]) === 0) { if (isset($Fȉ[$B܊[1243]])) { $e҉ߝ = $Fȉ[$B܊[1243]]; } else { if (isset($C[$B܊[1243]])) { $e҉ߝ = $C[$B܊[1243]]; } else { $e҉ߝ = hash($B܊[1153], $B܊[33]); } } return array($B܊[220] => $C[$B܊[220]], $B܊[1243] => $e҉ߝ, $B܊[210] => $C[$B܊[1246]]); } return $C[$B܊[220]]; goto e; e: } public function listUploadParts($E܌, $a꓍ = array()) { goto eԿ; eԿ: $dڡϣ =& $_SERVER[]; $D銅Ǚ = str_replace($dڡϣ[221], $dڡϣ[33], $a꓍[$dڡϣ[160]]); $bṏ = $this->client->listParts($this->bucket, $E܌, $D銅Ǚ); goto F; C͖ƕ: $d֨ܥ = array($dڡϣ[1244] => $A仓[1], $dڡϣ[199] => $dڡϣ[116], $dڡϣ[1155] => strlen($c)); $E؎ = $dڡϣ[212]; $Cڱ = $dڡϣ[8] . $this->pathEncode($E܌) . $a꓍[$dڡϣ[160]]; goto Eׅ; Eׅ: $E҇ˌ = $this->client->__getSignatureV4($cǅ, $d֨ܥ, $E؎, $Cڱ, $c); return array($dڡϣ[220] => $E҇ˌ[$dڡϣ[220]], $dڡϣ[210] => $E҇ˌ[$dڡϣ[1246]], $dڡϣ[222] => $bṏ, $dڡϣ[1243] => $E҇ˌ[$dڡϣ[1243]]); goto A郉; F: if (!$bṏ) { return !1; } $c = $dڡϣ[1247]; foreach ($bṏ as $e) { $c .= $dڡϣ[1248] . "\74\x50\141\162\164\116\165\155\142\145\162\x3e{$e[$dڡϣ[1199]]}\x3c\57\x50\141\x72\164\116\x75\x6d\x62\145\162\x3e\xa" . "\74\x45\x54\141\x67\x3e{$e[$dڡϣ[1200]]}\74\57\x45\x54\x61\x67\x3e\12" . $dڡϣ[1249]; } goto E; E: $c .= $dڡϣ[1250]; $cǅ = array(); $A仓 = explode($dڡϣ[171], $this->getHost()); goto C͖ƕ; A郉: } public function link($E, $AŬ = array()) { return parent::link($E, $AŬ); } public function fileOut($Eě, $C = false, $D؟׏ = false, $e㈓ = '') { if (strstr($this->endpoint, $_SERVER[][1251])) { return parent::fileOutServer($Eě, $C, $D؟׏, $e㈓); } parent::fileOut($Eě, $C, $D؟׏, $e㈓); } public function fileOutImage($B, $Aݛ = 250) { if (strstr($this->endpoint, $_SERVER[][1251])) { return parent::fileOutImageServer($B, $Aݛ); } parent::fileOutImage($B, $Aݛ); } public function fileOutLink($eٜ) { $f =& $_SERVER[]; if (substr($eٜ, 0, 7) == $f[1125]) { $eٜ = $f[1126] . substr($eٜ, 7); } header($f[156] . $eٜ); die; } public function getHost() { $Eƅ =& $_SERVER[]; $Fı = str_rtrim(parent::getHost(), $Eƅ[8] . $this->bucket); $Fı = explode($Eƅ[171], $Fı); return $Fı[0] . $Eƅ[171] . $this->bucket . $Eƅ[91] . $Fı[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Eʃ, $F؇ = 0) { parent::__construct(); $this->source = $Eʃ; $this->sourceSize = $F؇; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($fۋܴ = false) { return $this->sourceSize; } public function getContent($Dփ = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $C = ftell($this->source); $Eκ = @fread($this->source, $this->sourceSize); fseek($this->source, $C); return $Eκ; } } public function fileSubstr($eȘ = false, $cڵΐ = 0, $C = 0) { if (!$C) { $C = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $cڵΐ, $C); } if ($this->sourceType == self::TYPE_FILE) { $b匋 = ftell($this->source); fseek($this->source, $b匋 + $cڵΐ); $d;ۈɒ = @fread($this->source, $C); fseek($this->source, $b匋); return $d;ۈɒ; } } public function hashMd5($d݈ = false) { return md5($this->getContent()); } public static function hash($eŋ, $f̕۸ = 0) { $D暳 = new PathDriverStream($eŋ, $f̕۸); return $D暳->hashSimple($eŋ); } public static function md5($F, $Cւ = 0) { $B謧 = new PathDriverStream($F, $Cւ); return $B謧->hashMd5($F); } } goto b˾; b˾: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\x74\160\72\57\x2f\166\60\x2e\x61\x70\151\x2e\165\160\x79\x75\156\x2e\x63\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($f) { parent::__construct(); $this->_init($f); } public function _init($dծ) { foreach ($dծ as $FÑ => $Fǻ) { if (isset($this->{$FÑ})) { $this->{$FÑ} = $Fǻ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[][1252], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($dУ, $F = "\107\x45\x54") { $c縟 =& $_SERVER[]; $aُ = gmdate($c縟[1216]); $C䗉瀞 = base64_encode(hash_hmac($c縟[1253], "{$F}\46{$dУ}\46{$aُ}", md5("{$this->userpass}"), !0)); $dŒʍ = array("\x41\x75\164\x68\x6f\x72\x69\x7a\141\x74\x69\x6f\x6e\x3a\125\x50\x59\x55\116\x20{$this->username}\72{$C䗉瀞}", "\104\x61\164\145\72{$aُ}"); return $dŒʍ; } public function ussRequest($EΊ, $d = "\107\105\124", $DНԇ = false, $Dώ = false, $Dݙ = false) { goto aՉߙ; A㬓: $Dғ = $this->ussHeaders($E, $d); if ($Dώ) { $Dғ = array_merge($Dғ, $Dώ); } $d蹥 = url_request($this->endpoint . $E, $d, $DНԇ, $Dғ, $Dݙ); goto d; d: if (!$d蹥) { return array($bӵ[1042] => !1, $bӵ[1044] => $bӵ[1254]); } if (strtolower($d) == $bӵ[184] || in_array($d蹥[$bӵ[1042]], array($bӵ[1110], $bӵ[1255]))) { $DНԇ = $d蹥[$bӵ[1256]]; } else { $DНԇ = json_decode($d蹥[$bӵ[1044]], !0); if (!$DНԇ) { $DНԇ = $d蹥[$bӵ[1044]]; } else { if (!$d蹥[$bӵ[702]] && isset($DНԇ[$bӵ[1257]])) { $DНԇ = $DНԇ[$bӵ[1257]]; } } } return array($bӵ[1042] => $d蹥[$bӵ[702]], $bӵ[1044] => $DНԇ); goto B͢; aՉߙ: $bӵ =& $_SERVER[]; $EΊ = trim($EΊ, $bӵ[8]); $E = "\57{$this->bucket}\57{$EΊ}"; goto A㬓; B͢: } public function mkfile($Cꨑ, $b = '', $Bԅ = REPEAT_RENAME) { if ($this->setContent($Cꨑ, $b)) { return $this->getPathOuter($Cꨑ); } return !1; } public function mkdir($C֟, $CĹ = REPEAT_SKIP) { $d˘ =& $_SERVER[]; $Bꨛ۽ = trim($C֟, $d˘[8]); if ($this->_isFolder($Bꨛ۽)) { return $this->getPathOuter($Bꨛ۽); } $cބڱ = array($d˘[1258]); $FƆ = $this->ussRequest($Bꨛ۽, $d˘[212], !1, $cބڱ); return $FƆ[$d˘[1042]] ? $this->getPathOuter($Bꨛ۽) : !1; } public function copyFile($eҳ, $cŷ) { $Cم =& $_SERVER[]; $Eڃ = array($Cم[1259] . "\57{$this->bucket}\57{$eҳ}", $Cم[1260]); $E뽍 = $this->ussRequest($cŷ, $Cم[214], !1, $Eڃ); return $E뽍[$Cم[1042]] ? !0 : !1; } public function moveFile($DǴ, $C貛) { $C =& $_SERVER[]; $bѐ = array($C[1261] . "\57{$this->bucket}\x2f{$DǴ}", $C[1260]); $A = $this->ussRequest($C貛, $C[214], !1, $bѐ); return $A[$C[1042]] ? !0 : !1; } public function delFile($BѰ) { $bԄ =& $_SERVER[]; $Eޅ = $this->ussRequest($BѰ, $bԄ[1262]); return $Eޅ[$bԄ[1042]] ? !0 : !1; } public function delFolder($c݊؂) { $f =& $_SERVER[]; $E = $this->listAll($c݊؂); krsort($E); foreach ($E as $d߷͉҃) { $this->ussRequest($d߷͉҃[$f[75]], $f[1262]); } return $this->ussRequest($c݊؂, $f[1262]); } public function rename($Cݏ, $bֽ) { if ($this->isFile($Cݏ)) { $bֽ = get_path_father($Cݏ) . $bֽ; return $this->moveFile($Cݏ, $bֽ); } return $this->renameObject($Cݏ, $bֽ); } public function fileInfo($E, $D٢ = false, $E = array()) { $a =& $_SERVER[]; if ($D٢) { return array($a[28] => $this->pathThis($E), $a[75] => $this->getPathOuter($a[8] . $E), $a[29] => $a[167], $a[77] => isset($E[$a[325]]) ? $E[$a[325]] : 0, $a[160] => $this->ext($E)); } $DݲЃ = array($a[28] => $this->pathThis($E), $a[75] => $this->getPathOuter($a[8] . $E), $a[29] => $a[167], $a[187] => 0, $a[107] => isset($cꆐ[$a[1263]]) ? $cꆐ[$a[1263]] : 0, $a[77] => isset($E[$a[325]]) ? $E[$a[325]] : 0, $a[160] => $this->ext($E), $a[188] => !0, $a[189] => !0); if (empty($E)) { $E = $this->objectMeta($E); if (!$E) { return $DݲЃ; } $DݲЃ[$a[187]] = $E[$a[1264]]; $DݲЃ[$a[107]] = $E[$a[1265]]; $DݲЃ[$a[77]] = $E[$a[77]]; } return $DݲЃ; } public function folderInfo($F, $f֐τ = false) { $Cʅڨ =& $_SERVER[]; if ($f֐τ) { return array($Cʅڨ[28] => $this->pathThis($F), $Cʅڨ[75] => $this->getPathOuter($Cʅڨ[8] . $F), $Cʅڨ[29] => $Cʅڨ[76]); } $B = array($Cʅڨ[28] => $this->pathThis($F), $Cʅڨ[75] => $this->getPathOuter($Cʅڨ[8] . $F), $Cʅڨ[29] => $Cʅڨ[76], $Cʅڨ[187] => 0, $Cʅڨ[107] => isset($F[$Cʅڨ[1263]]) ? $F[$Cʅڨ[1263]] : 0, $Cʅڨ[1171] => !0, $Cʅڨ[1172] => !0); if (empty($F𵹃)) { $F𵹃 = $this->objectMeta($F); if (!$F𵹃) { return $B; } $B[$Cʅڨ[187]] = $F𵹃[$Cʅڨ[1264]]; $B[$Cʅڨ[107]] = $F𵹃[$Cʅڨ[1265]]; } return $B; } private function fileList($dՅ펧, $bӹ˦ = 0, $a؃ = 1000) { $E =& $_SERVER[]; $BΌ = array($E[1266], $E[1267] . $a؃); if ($bӹ˦) { $BΌ[] = $E[1268] . $bӹ˦; } $d؊ = $this->ussRequest($dՅ펧, $E[216], !1, $BΌ); return !$d؊[$E[1042]] ? !1 : $d؊[$E[1044]]; } public function listPath($A, $E = false) { goto a; fӑ: return array($e[74] => $d, $e[73] => $b¥); goto f; a: $e =& $_SERVER[]; $aٮ = $e[33]; $A˜ڌ = 1000; goto bʻ; bʻ: $d = $b¥ = array(); $e⾘䳗 = rtrim($A, $e[8]) . $e[8]; while (!0) { $c = $this->fileList($A, $aٮ, $A˜ڌ); if (!$c) { return !1; } $aٮ = isset($c[$e[1269]]) ? $c[$e[1269]] : $e[33]; $dڕ뇰 = isset($c[$e[1270]]) ? $c[$e[1270]] : array(); foreach ($dڕ뇰 as $FӍÙ) { if ($FӍÙ[$e[29]] == $e[76]) { $d[] = $this->folderInfo($e⾘䳗 . $FӍÙ[$e[28]], $E, $FӍÙ); } else { $b¥[] = $this->fileInfo($e⾘䳗 . $FӍÙ[$e[28]], $E, $FӍÙ); } } if (count($dڕ뇰) < $A˜ڌ) { break; } } goto fӑ; f: } private function recursionAllFiles($e, &$c) { $A앾 =& $_SERVER[]; $fԆ = $A앾[33]; $F = 1000; $Aػ = $aө = array(); $D = rtrim($e, $A앾[8]) . $A앾[8]; while (!0) { $d˙˪ = $this->fileList($e, $fԆ, $F); if (!$d˙˪) { return !1; } $fԆ = isset($d˙˪[$A앾[1269]]) ? $d˙˪[$A앾[1269]] : $A앾[33]; $a = isset($d˙˪[$A앾[1270]]) ? $d˙˪[$A앾[1270]] : array(); foreach ($a as $fӾ) { $fت = array($A앾[75] => $D . $fӾ[$A앾[28]], $A앾[76] => $fӾ[$A앾[29]] == $A앾[76] ? 1 : 0, $A앾[77] => isset($fӾ[$A앾[325]]) ? $fӾ[$A앾[325]] : 0); $c[] = $fت; if ($fت[$A앾[76]] == 1) { $this->recursionAllFiles($fت[$A앾[75]], $c); } } if (count($a) < $F) { break; } } } public function has($e䴿ư, $dۛ = false, $bٜ = true) { goto Aە; Aە: $D߿ =& $_SERVER[]; $cנޟ = $D߿[33]; $eȎ = 1000; goto C㈑׺; C㈑׺: $a = 0; $B֬سڋ = 0; $Dѝњ = rtrim($e䴿ư, $D߿[8]) . $D߿[8]; goto d; d: while (!0) { $cޘ = $this->fileList($e䴿ư, $cנޟ, $eȎ); if (!$cޘ) { return !1; } $cנޟ = isset($cޘ[$D߿[1269]]) ? $cޘ[$D߿[1269]] : $D߿[33]; $a = isset($cޘ[$D߿[1270]]) ? $cޘ[$D߿[1270]] : array(); if (empty($a)) { break; } $E˕ = array_to_keyvalue($a, $D߿[33], $D߿[29]); $Cͣ = array_count_values($E˕); $bܑ = isset($Cͣ[$D߿[76]]) ? $Cͣ[$D߿[76]] : 0; $b쯉 = count($E˕) - $bܑ; if ($dۛ) { $B֬سڋ += $bܑ; $a += $b쯉; if ($a֥̕ < $eȎ) { break; } continue; } if ($bٜ) { if ($b쯉) { return !0; } } else { if ($bܑ) { return !0; } } if (count($a) < $eȎ) { break; } } if ($dۛ) { return array($D߿[191] => $a, $D߿[192] => $B֬سڋ); } return !1; goto aƸ; aƸ: } public function listAll($E҉) { $d = array(); $this->recursionAllFiles($E҉, $d); return $d; } public function canRead($F) { return $this->exist($F) ? !0 : !1; } public function canWrite($A֑) { return $this->exist($A֑) ? !0 : !1; } public function getContent($Aܪ臫) { return $this->fileSubstr($Aܪ臫, 0, -1); } public function setContent($DƢ, $F = '') { $D =& $_SERVER[]; if (!$F) { $DՏ = $this->ussRequest($DƢ, $D[212]); return $DՏ[$D[1042]]; } $c = $this->tempFile($this->pathThis($DƢ)); file_put_contents($c, $F); if ($this->upload($DƢ, $c)) { $this->tempFileRemve($c); return !0; } return !1; } public function fileSubstr($C, $Aȴ, $Eӥ) { $Aʯ҂ =& $_SERVER[]; if (!($C̍ = $this->link($C))) { return !1; } $C = !1; if ($Eӥ > 0) { $b = $Aȴ + $Eӥ - 1; $C = array($Aʯ҂[1231] . $Aȴ . $Aʯ҂[412] . $b); } $c㌒ = url_request($C̍, $Aʯ҂[216], !1, $C); return $c㌒[$Aʯ҂[702]] ? $c㌒[$Aʯ҂[1044]] : !1; } public function upload($e, $e߂, $c̈́՛ = false, $AΘ = REPEAT_REPLACE) { goto F쏓; F쏓: $A =& $_SERVER[]; $B = IO::size($e߂); if ($B <= 1024 * 1024 * 200) { $F䬍 = array($A[1271] . $e߂); $BҖ = $this->ussRequest($e, $A[214], $F䬍); return $BҖ[$A[1042]] ? $this->getPathOuter($e) : !1; } goto AϠ; fĆ: do { $d퇅Ғ = $eւ[$A[1277]]; fseek($aΫӝ, $CѪ); $Eؼ = fread($aΫӝ, $d퇅Ғ); $f = 0; do { $f++; $eւ = $this->uploadPart($e, $eւ, $Eؼ); } while (!$eւ && $f < 3); if (!$eւ) { return !1; } $dϪ = $eւ[$A[1276]]; $CѪ += $d퇅Ғ; } while ($dϪ != -1); fclose($aΫӝ); $A鰈 = array($A[1278], $A[1279] . $eւ[$A[1280]], $A[1274]); goto eڦ; eڦ: $BҖ = $this->ussRequest($e, $A[214], !1, $A鰈); return $BҖ[$A[1042]] ? $this->getPathOuter($DՊ) : !1; goto Dӑ; A،Ϳ: if (!$BҖ[$A[1042]]) { return !1; } $eւ = $BҖ[$A[1044]]; $CѪ = 0; goto Fߑ; Fߑ: $dϪ = $eւ[$A[1276]]; $aΫӝ = fopen($e߂, $A[1181]); if (!$aΫӝ) { return !1; } goto fĆ; AϠ: $Bґ = 1024 * 1024 * 10; $A鰈 = array($A[1272], $A[1273] . $B, $A[1274], $A[1275] . $Bґ); $BҖ = $this->ussRequest($e, $A[214], !1, $A鰈); goto A،Ϳ; Dӑ: } private function uploadPart($aԐ, $F, &$Eꓰ) { $D =& $_SERVER[]; $Eوɉ = array($D[1281], $D[1279] . $F[$D[1280]], $D[1282] . $F[$D[1276]], $D[138] . $F[$D[1277]]); $e = $this->ussRequest($aԐ, $D[214], $Eꓰ, $Eوɉ); return !$e[$D[1042]] ? $e[$D[1042]] : $e[$D[1044]]; } public function uploadFormData($Aԙ, $B = 3600) { return $this->uploadPolicy($Aԙ, $B); } public function multiUploadFormData($e͏, $Fٜĸ = 3600) { $F =& $_SERVER[]; $c = (int) $GLOBALS[$F[7]][$F[77]]; return $this->uploadPolicy($e͏, $Fٜĸ, $c); } private function uploadPolicy($B, $b̝ = 3600, $C = 0) { goto dǷÇ; A£: $Cɹ = base64_encode(hash_hmac($B행[1253], "\120\x4f\x53\x54\46{$b}\46{$Aʉ}\x26{$F慢}", md5("{$this->userpass}"), !0)); $A߈ = array($B행[1122] => $F慢, $B행[1287] => "\125\120\131\x55\x4e\40{$this->username}\72{$Cɹ}", $B행[169] => $this->endpoint . $b); return $A߈; goto C; dǷÇ: $B행 =& $_SERVER[]; $b = $B행[8] . $this->bucket; $Aʉ = gmdate($B행[1216]); goto A; A: $A̍ = array($B행[1283] => $this->bucket, $B행[1284] => $B, $B행[1285] => time() + $b̝, $B행[1286] => $Aʉ); if ($C) { $A̍[$B행[1202]] = $C; } $F慢 = base64_encode(json_encode($A̍)); goto A£; C: } public function download($Aǿ, $E҇) { goto F; A㩂: $E͊ = 1024 * 200; $fȩ = fopen($Eˈ, $_SERVER[][1237]); while (!0) { $b񶱄ч = $this->fileSubstr($Aǿ, $E, $E͊); if ($b񶱄ч === !1) { return !1; } fwrite($fȩ, $b񶱄ч); $E += $E͊; if (strlen($b񶱄ч) < $E͊) { break; } } goto aӽ; F: $Eˈ = IO::getPathInner(IO::mkfile($E҇)); if (!($e䤧 = $this->link($Aǿ))) { return !1; } $E = 0; goto A㩂; aӽ: fclose($fȩ); return $E҇; goto e; e: } public function link($F, $fÌ = array()) { $e =& $_SERVER[]; $F = trim($F, $e[8]); if (!empty($this->token)) { $dڬ = strtotime(date($e[1288])); $eϏδ = substr(md5($this->token . $e[272] . $dڬ . $e[1289] . $F), 12, 8) . $dڬ; $fÌ[] = $e[1290] . $eϏδ; } $Aա = !empty($fÌ) ? $e[69] . implode($e[272], $fÌ) : $e[33]; return $this->getHost() . $e[8] . $F . $Aա; } public function fileOut($e¥, $f = false, $b = false, $Cɒ = '') { if (!$b) { $b = $this->pathThis($e¥); } $fѾ = $f ? array($_SERVER[][1291] . rawurlencode($b)) : array(); $D쟒х = $this->link($e¥, $fѾ); $this->fileOutLink($D쟒х); } public function fileOutServer($eۇ, $Dŭ = false, $a = false, $Eז = '') { parent::fileOut($eۇ, $Dŭ, $a, $Eז); } public function fileOutImage($B؉, $dԐܬ = 250) { $F쐱 = $this->link($B؉ . $_SERVER[][1292] . $dԐܬ); $this->fileOutLink($F쐱); } public function fileOutImageServer($C, $Fݴ = 250) { parent::fileOutImage($C, $Fݴ); } public function hashMd5($f) { $d =& $_SERVER[]; $aՎ = $this->objectMeta($f); return isset($aՎ[$d[196]]) ? $aՎ[$d[196]] : !1; } public function size($b) { $cǳˋ = $this->objectMeta($b); return $cǳˋ ? $cǳˋ[$_SERVER[][77]] : 0; } public function info($eደ) { if ($this->isFolder($eደ)) { return $this->folderInfo($eደ); } else { if ($this->isFile($eደ)) { return $this->fileInfo($eደ); } } return !1; } public function exist($a싏) { return $this->isFile($a싏) || $this->isFolder($a싏); } public function isFile($Dנ) { return !$this->isFolder($Dנ) && $this->objectMeta($Dנ); } public function isFolder($D˃Ҏ) { return $this->cacheMethod($_SERVER[][223], $D˃Ҏ); } protected function objectMeta($F) { return $this->cacheMethod($_SERVER[][224], $F); } protected function _objectMeta($Fе) { goto Eҏ͉; bجۤ: if (!$f[$A޲[1042]]) { return null; } $bڍ = isset($f[$A޲[1044]]) ? $f[$A޲[1044]] : array(); if (!isset($bڍ[$A޲[1294]])) { return null; } goto CچƓ; CچƓ: $FН = array($A޲[28] => get_path_this($Fе), $A޲[29] => isset($bڍ[$A޲[1294]]) ? $bڍ[$A޲[1294]] : null, $A޲[77] => isset($bڍ[$A޲[1295]]) ? $bڍ[$A޲[1295]] : null, $A޲[196] => isset($bڍ[$A޲[1296]]) ? $bڍ[$A޲[1296]] : null, $A޲[1264] => isset($bڍ[$A޲[1297]]) ? $bڍ[$A޲[1297]] : null); $FН[$A޲[1265]] = isset($bڍ[$A޲[1298]]) ? strtotime($bڍ[$A޲[1298]]) : $FН[$A޲[1264]]; return $FН; goto e; Eҏ͉: $A޲ =& $_SERVER[]; if ($Fе == $A޲[33] || $Fе == $A޲[8]) { return array(); } $f = $this->ussRequest($Fе, $A޲[1293]); goto bجۤ; e: } protected function _isFolder($Cև) { $aͱ =& $_SERVER[]; if ($Cև == $aͱ[33] || $Cև == $aͱ[8]) { return !0; } $Dټ = $this->objectMeta($Cև); return isset($Dټ[$aͱ[29]]) && $Dټ[$aͱ[29]] == $aͱ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($Bл = false) { } public function exist($bζ) { $cĕ = $this->info($bζ); return $cĕ[$_SERVER[][188]]; } public function isFile($Bؾ) { $AÐ = $this->info($Bؾ); return $AÐ[$_SERVER[][188]]; } public function isFolder($Aߑ̤) { return !1; } public function size($D) { $F캷 = $this->info($D); return $F캷[$_SERVER[][77]]; } public function info($fС) { return $this->infoParse($fС); } public function infoAuth($d) { return $this->infoParse($d); } public function infoWithChildren($AЌ) { return $this->infoParse($AЌ); } public function infoFull($B½) { return $this->infoParse($B½); } private function infoParse($fŮ) { $E =& $_SERVER[]; $D؋Պ = $this->header($fŮ); if (!$D؋Պ || !$D؋Պ[$E[702]]) { return !1; } $A֢Ƿ = _get($D؋Պ, $E[325], 0); $bה = array($E[28] => $D؋Պ[$E[28]], $E[75] => $fŮ, $E[29] => $E[167], $E[77] => intval($A֢Ƿ), $E[160] => get_path_ext($D؋Պ[$E[28]]), $E[1171] => $A֢Ƿ > 0 && $D؋Պ[$E[1299]], $E[1172] => !1); return $bה; } private function header($f) { if (isset(self::$_cacheHeader[$f])) { return self::$_cacheHeader[$f]; } self::$_cacheHeader[$f] = url_header($f); return self::$_cacheHeader[$f]; } public function hashSimple($C󪴝, $eŪ = false) { goto eɡ᭙; a֛: $d = timeFloat(); $Fˮ = 15; for ($c = 0; $c < $EъѼ; $c++) { if (timeFloat() - $d > $Fˮ) { return !1; } $dʑ̐ = $this->fileSubstr($C󪴝, $BΠޮ * $c, $eٖӇ); if (!$dʑ̐) { return !1; } $E϶Ċ .= $dʑ̐; } goto FԶ; eɡ᭙: $Bҡ䇝 =& $_SERVER[]; $F = $this->info($C󪴝); if (!$F || !$F[$Bҡ䇝[188]]) { return !1; } goto B˵; B˵: $Dˤ = $F[$Bҡ䇝[77]]; $eٖӇ = 200; $EъѼ = 50; goto e͖݇; FԶ: $E϶Ċ .= $this->fileSubstr($C󪴝, $Dˤ - $eٖӇ, $eٖӇ); return md5($E϶Ċ) . $Dˤ; goto EŎƐ; e͖݇: if ($Dˤ <= $eٖӇ * $EъѼ) { return md5($this->fileSubstr($C󪴝, 0, $Dˤ)) . $Dˤ; } $BΠޮ = intval($Dˤ / $EъѼ); $E϶Ċ = $Bҡ䇝[33]; goto a֛; EŎƐ: } public function getContent($e) { return $this->fileSubstr($e); } public function fileSubstr($Bމۣ, $e = 0, $f֌Ê = -1) { goto Aɐ; c䵂: $Eԭ = url_request($Bމۣ, $BҤ[216], !1, $DĿ, !1, !1, 1); return $Eԭ[$BҤ[1044]] ? $Eԭ[$BҤ[1044]] : $BҤ[33]; goto f긬ţ; fא: if ($f֌Ê === -1) { $f֌Ê = $aܘ[$BҤ[77]]; } if ($f֌Ê == 0) { return $BҤ[33]; } $DĿ = array($BҤ[1300] . $e . $BҤ[729] . ($e + $f֌Ê - 1)); goto c䵂; Aɐ: $BҤ =& $_SERVER[]; $aܘ = $this->info($Bމۣ); if (!$aܘ || !$aܘ[$BҤ[188]] && $aܘ[$BҤ[77]] > 1024 * 1024 * 10) { return !1; } goto fא; f긬ţ: } public function download($e݋ɕ, $Eяՠ) { Downloader::start($e݋ɕ, $Eяՠ); return $Eяՠ; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($fڢ, $Dт = '') { goto c; aٌ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$fڢ])) { self::$_chunkBuffer[$fڢ] = array(); } goto C; c: $this->info = $this->info($fڢ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[][75]]; goto aٌ; C: return $this->info ? !0 : !1; goto B; B: } function stream_read($a䌠) { $f = $this->fileSubstr($this->pose, $a䌠); $this->pose += strlen($f); return $f; } public function stream_tell() { return $this->pose; } public function stream_seek($d, $B) { $A =& $_SERVER[]; if ($B == SEEK_SET) { $this->pose = $d; } else { if ($B == SEEK_CUR) { $this->pose += $d; } else { if ($B == SEEK_END) { $this->pose = $this->info[$A[77]] + intval($d); } } } if ($d < 0) { $this->pose = $this->info[$A[77]] + $d; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[][77]]; } public function stream_close() { return !0; } public function url_stat($d, $F܉) { $Aޝʍ =& $_SERVER[]; $dߊ = $this->info($d); return array($Aޝʍ[1301] => 0, $Aޝʍ[1302] => 0, $Aޝʍ[12] => 32768 + 511, $Aޝʍ[1303] => 0, $Aޝʍ[1304] => 0, $Aޝʍ[1305] => 0, $Aޝʍ[1306] => 0, $Aޝʍ[77] => $dߊ[$Aޝʍ[77]], $Aޝʍ[1307] => $dߊ[$Aޝʍ[1179]], $Aޝʍ[1265] => $dߊ[$Aޝʍ[107]], $Aޝʍ[1264] => $dߊ[$Aޝʍ[187]], $Aޝʍ[1308] => 0, $Aޝʍ[1309] => 0); } static $fileInfo = array(); public function info($Bׂ) { $CԽ = $_SERVER[][1310]; if (isset(self::$fileInfo[$Bׂ])) { return self::$fileInfo[$Bׂ]; } if (substr($Bׂ, 0, strlen($CԽ)) != $CԽ) { return !1; } self::$fileInfo[$Bׂ] = IO::info(substr($Bׂ, strlen($CԽ))); return self::$fileInfo[$Bׂ]; } public static function read($c, $f, $Cٶ) { goto Cˌ; Bۈ: $bÂ = 0; while ($bÂ < $Cٶ) { $EϏ = min($Cܢ, $Cٶ - $bÂ); $bȋ .= fread($EĻŽ, $EϏ); $bÂ += $EϏ; } fclose($EĻŽ); goto d; Cˌ: $d¢ =& $_SERVER[]; $EĻŽ = fopen($c, $d¢[1181]); if (!$EĻŽ) { return $d¢[33]; } goto C΍ô; C΍ô: $Cܢ = 8192; fseek($EĻŽ, $f, SEEK_SET); $bȋ = $d¢[33]; goto Bۈ; d: return $bȋ; goto Dӏ; Dӏ: } public function fileSubstr($D笳, $C®) { goto e; Eᇎ涰: $f = ceil(($D笳 + $C®) / $c҉Ꙏ) * $c҉Ꙏ - $e; $f⏈ = IO::fileSubstr($this->path, $e, $f); $DԽ[$e . $eε[33]] = $f⏈; goto Aќğ; Aќğ: ksort($DԽ); $d = substr($f⏈, $D笳 - $e, $C®); return $d; goto f鷃; E: foreach ($DԽ as $cڗ => $f) { $cڗ = intval($cڗ); $E = $cڗ + strlen($f); if ($D笳 >= $E) { continue; } if ($D笳 >= $cڗ && $D笳 + $C® <= $E) { return substr($f, $D笳 - $cڗ, $C®); } break; } if (count($DԽ) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($eε[1311], $eε[1312] . count($DԽ) . "\73\x73\x74\141\162\x74\x3d{$D笳}\54\154\145\x6e\x67\x74\x68\75{$C®}\73\160\x6f\x73\x65\72{$cڗ}\176{$E}"); throw new Exception($eε[1313]); } $e = intval($D笳 / $c҉Ꙏ) * $c҉Ꙏ; goto Eᇎ涰; bأ: if ($D笳 + $C® > $a) { $C® = $a - $D笳; } if ($C® <= 0) { return $eε[33]; } if ($D笳 < 0 || $D笳 >= $a || $C® <= 0 || $C® > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\x69\154\x65\122\145\x61\x64\x20\x65\162\162\157\162\41\40\163\164\x61\162\x74\x3d{$D笳}\x3b\x6c\x65\156\147\164\x68\x3d{$C®}\x3b\40\x73\x69\172\145\x3d{$a}\73"); } goto B򉢰Ӟ; e: $eε =& $_SERVER[]; $a = $this->info[$eε[77]]; $D祊 = $D笳; goto e; e: $D = $C®; if ($D笳 < 0) { $D笳 = $a + $D笳; } if ($C® === !1) { $C® = $a - $D笳; } goto bأ; d: $cڗ = 0; $E = 0; $f = $eε[33]; goto E; B򉢰Ӟ: $c҉Ꙏ = 64 * 1024; $DԽ =& self::$_chunkBuffer[$this->path]; if (!$DԽ) { $DԽ = array(); } goto d; f鷃: } private function log($e, $cԉ) { $CЉԖ =& $_SERVER[]; $bպ = timeFloat() - $this->timeStart; write_log(sprintf($CЉԖ[1314], $e, $this->info[$CЉԖ[28]], $bպ, $cԉ), $CЉԖ[1230]); } } goto fݭ; D: class DbSqlite extends DbSqliteBase { public function query($d͸ÿ) { goto fآ; fآ: $e㊻ =& $_SERVER[]; $CҊ = DATA_PATH . $e㊻[884]; $C✼ = fopen($CҊ, $e㊻[885]); goto CȠ; CȠ: if (!$C✼) { return !1; } if (flock($C✼, LOCK_EX)) { $Fà = parent::query($d͸ÿ); flock($C✼, LOCK_UN); fclose($C✼); return $Fà; } flock($C✼, LOCK_UN); goto e뵘; e뵘: fclose($C✼); show_json($e㊻[886], !1); return !1; goto fѬ; fѬ: } public function execute($B) { goto aȑڂ; aȑڂ: $Dꇩ =& $_SERVER[]; $a = DATA_PATH . $Dꇩ[884]; $F孼ݭ = fopen($a, $Dꇩ[885]); goto CͿ; CՆ: fclose($F孼ݭ); show_json($Dꇩ[886], !1); return !1; goto c҈Ӆ; CͿ: if (!$F孼ݭ) { return !1; } if (flock($F孼ݭ, LOCK_EX)) { $Aɸ = parent::execute($B); flock($F孼ݭ, LOCK_UN); fclose($F孼ݭ); return $Aɸ; } flock($F孼ݭ, LOCK_UN); goto CՆ; c҈Ӆ: } } class DbSqlite3 extends DbSqlite3Base { public function query($F͛) { goto f܊; A: if (!$A) { return !1; } if (flock($A, LOCK_EX)) { $a󉙅 = parent::query($F͛); flock($A, LOCK_UN); fclose($A); return $a󉙅; } flock($A, LOCK_UN); goto A; f܊: $eć =& $_SERVER[]; $E = DATA_PATH . $eć[884]; $A = fopen($E, $eć[885]); goto A; A: fclose($A); show_json($eć[886], !1); return !1; goto d; d: } public function execute($D) { goto B; f̩: fclose($dֿ۪); show_json($dŠ[886], !1); return !1; goto Fǜŋ; aù: if (!$dֿ۪) { return !1; } if (flock($dֿ۪, LOCK_EX)) { $a = parent::execute($D); flock($dֿ۪, LOCK_UN); fclose($dֿ۪); return $a; } flock($dֿ۪, LOCK_UN); goto f̩; B: $dŠ =& $_SERVER[]; $Dզ = DATA_PATH . $dŠ[884]; $dֿ۪ = fopen($Dզ, $dŠ[885]); goto aù; Fǜŋ: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\150\151\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\x71" => "\x3d", "\156\145\161" => "\x3c\76", "\x67\x74" => "\x3e", "\x65\147\164" => "\76\75", "\x6c\x74" => "\x3c", "\x65\x6c\x74" => "\74\75", "\x6e\x6f\164\x6c\151\153\x65" => "\x4e\117\124\x20\114\111\113\x45", "\x6c\151\x6b\145" => "\114\x49\113\105", "\151\156" => "\x49\x4e", "\x6e\x6f\x74\151\x6e" => "\x4e\117\x54\40\111\x4e", "\156\x6f\x74\40\151\x6e" => "\x4e\x4f\x54\x20\x49\x4e", "\x62\x65\x74\x77\x65\x65\x6e" => "\x42\x45\124\x57\105\x45\x4e", "\x6e\x6f\x74\142\145\164\167\x65\x65\x6e" => "\116\117\x54\x20\x42\105\124\x57\x45\105\x4e", "\156\x6f\164\x20\142\145\164\167\x65\x65\x6e" => "\x4e\x4f\x54\40\x42\105\124\127\105\105\116"); protected $selectSql = "\123\105\x4c\x45\x43\124\x25\x44\111\123\x54\x49\x4e\x43\124\x25\x20\x25\106\x49\105\114\104\x25\x20\106\x52\117\115\40\45\124\x41\102\114\105\x25\45\x4a\117\x49\116\45\x25\x57\110\x45\x52\105\45\45\107\122\117\125\120\45\x25\110\101\x56\x49\116\x47\45\45\x4f\x52\x44\105\x52\45\45\x4c\x49\x4d\x49\124\45\x20\x25\x55\116\x49\117\x4e\x25\45\x43\117\x4d\115\105\116\x54\45"; protected $bind = array(); public static function getInstance() { $fŜ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[][887], $fŜ); } public function factory($F = '') { goto aι; aι: $E۵ =& $_SERVER[]; $F = $this->parseConfig($F); if (empty($F[$E۵[888]])) { think_exception(think_lang($E۵[889])); } goto E; E: $this->dbType = ucwords(strtolower($F[$E۵[888]])); $e覭ۊ = $E۵[890] . $this->dbType; if (class_exists($e覭ۊ)) { $c = new $e覭ۊ($F); if ($E۵[737] != strtolower($F[$E۵[888]])) { $c->dbType = strtoupper($this->dbType); } else { $c->dbType = $this->_getDsnType($F[$E۵[840]]); } } else { think_exception(think_lang($E۵[891]) . $E۵[892] . $e覭ۊ); } goto a±; a±: return $c; goto Bﱱ뎿; Bﱱ뎿: } public function __call($dɸ, $A) { if (method_exists($this, $dɸ)) { return call_user_func_array(array($this, $dɸ), $A); } } protected function _getDsnType($e֙ԉ) { $Bԭ = explode($_SERVER[][4], $e֙ԉ); $Aԓʧ = strtoupper(trim($Bԭ[0])); return $Aԓʧ; } private function parseConfig($E = '') { $EŢ =& $_SERVER[]; if (!empty($E) && is_string($E)) { $E = $this->parseDSN($E); } elseif (is_array($E)) { $E = array_change_key_case($E); $E = array($EŢ[888] => $E[$EŢ[736]], $EŢ[813] => $E[$EŢ[893]], $EŢ[814] => $E[$EŢ[894]], $EŢ[811] => $E[$EŢ[895]], $EŢ[812] => $E[$EŢ[896]], $EŢ[17] => $E[$EŢ[897]], $EŢ[840] => $E[$EŢ[738]], $EŢ[13] => isset($E[$EŢ[898]]) ? $E[$EŢ[898]] : array()); } elseif (empty($E)) { if (think_config($EŢ[899]) && $EŢ[737] != strtolower(think_config($EŢ[900]))) { $E = $this->parseDSN(think_config($EŢ[899])); } else { $E = array($EŢ[888] => think_config($EŢ[900]), $EŢ[813] => think_config($EŢ[901]), $EŢ[814] => think_config($EŢ[902]), $EŢ[811] => think_config($EŢ[903]), $EŢ[812] => think_config($EŢ[904]), $EŢ[17] => think_config($EŢ[234]), $EŢ[840] => think_config($EŢ[899]), $EŢ[13] => think_config($EŢ[905])); } } return $E; } protected function initConnect($E傶 = true) { if (1 == think_config($_SERVER[][18])) { $this->_linkID = $this->multiConnect($E傶); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($Cڮ = false) { $Aь傱 =& $_SERVER[]; static $d힏 = array(); if (empty($d힏)) { foreach ($this->config as $Cș => $b䠡) { $d힏[$Cș] = explode($Aь傱[47], $b䠡); } } if (think_config($Aь傱[906])) { if ($Cڮ) { $cᢅ = floor(mt_rand(0, think_config($Aь傱[907]) - 1)); } else { if (is_numeric(think_config($Aь傱[908]))) { $cᢅ = think_config($Aь傱[908]); } else { $cᢅ = floor(mt_rand(think_config($Aь傱[907]), count($d힏[$Aь傱[811]]) - 1)); } } } else { $cᢅ = floor(mt_rand(0, count($d힏[$Aь傱[811]]) - 1)); } $e = array($Aь傱[813] => isset($d힏[$Aь傱[813]][$cᢅ]) ? $d힏[$Aь傱[813]][$cᢅ] : $d힏[$Aь傱[813]][0], $Aь傱[814] => isset($d힏[$Aь傱[814]][$cᢅ]) ? $d힏[$Aь傱[814]][$cᢅ] : $d힏[$Aь傱[814]][0], $Aь傱[811] => isset($d힏[$Aь傱[811]][$cᢅ]) ? $d힏[$Aь傱[811]][$cᢅ] : $d힏[$Aь傱[811]][0], $Aь傱[812] => isset($d힏[$Aь傱[812]][$cᢅ]) ? $d힏[$Aь傱[812]][$cᢅ] : $d힏[$Aь傱[812]][0], $Aь傱[17] => isset($d힏[$Aь傱[17]][$cᢅ]) ? $d힏[$Aь傱[17]][$cᢅ] : $d힏[$Aь傱[17]][0], $Aь傱[840] => isset($d힏[$Aь傱[840]][$cᢅ]) ? $d힏[$Aь傱[840]][$cᢅ] : $d힏[$Aь傱[840]][0], $Aь傱[13] => isset($d힏[$Aь傱[13]][$cᢅ]) ? $d힏[$Aь傱[13]][$cᢅ] : $d힏[$Aь傱[13]][0]); return $this->connect($e, $cᢅ); } public function parseDSN($cīݎ) { $c =& $_SERVER[]; if (empty($cīݎ)) { return !1; } $e = parse_url($cīݎ); if ($e[$c[168]]) { $DӦ = array($c[888] => $e[$c[168]], $c[813] => isset($e[$c[535]]) ? $e[$c[535]] : $c[33], $c[814] => isset($e[$c[909]]) ? $e[$c[909]] : $c[33], $c[811] => isset($e[$c[169]]) ? $e[$c[169]] : $c[33], $c[812] => isset($e[$c[170]]) ? $e[$c[170]] : $c[33], $c[17] => isset($e[$c[75]]) ? substr($e[$c[75]], 1) : $c[33]); } else { preg_match($c[910], trim($cīݎ), $a߮); $DӦ = array($c[888] => $a߮[1], $c[813] => $a߮[2], $c[814] => $a߮[3], $c[811] => $a߮[4], $c[812] => $a߮[5], $c[17] => $a߮[6]); } $DӦ[$c[840]] = $c[33]; return $DӦ; } protected function debug() { $Eǎ =& $_SERVER[]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $Eǎ[911]; if (think_config($Eǎ[912])) { think_status($Eǎ[913]); think_trace($this->queryStr . $Eǎ[914] . think_status($Eǎ[20], $Eǎ[913], 6) . $Eǎ[915], $Eǎ[33], $Eǎ[916]); } } protected function parseLock($Aઠʮ = false) { $aң؋ =& $_SERVER[]; if (!$Aઠʮ) { return $aң؋[33]; } if ($aң؋[842] == $this->dbType) { return $aң؋[917]; } return $aң؋[918]; } protected function parseSet($Fʮą) { $E =& $_SERVER[]; foreach ($Fʮą as $D => $b) { if (is_array($b) && $E[285] == $b[0]) { $eŜВʆ[] = $this->parseKey($D) . $E[919] . $b[1]; } elseif (is_scalar($b) || is_null($b)) { $eŜВʆ[] = $this->parseKey($D) . $E[919] . $this->parseValue($b); } } return $E[920] . implode($E[47], $eŜВʆ); } protected function bindParam($b⾄, $DԊȵ) { $this->bind[$_SERVER[][4] . $b⾄] = $DԊȵ; } protected function parseBind($A̤) { $A̤ = array_merge($this->bind, $A̤); $this->bind = array(); return $A̤; } function parseKey(&$E҄, $E = true) { if ($E) { $E҄ = $this->parseKeyCheck($E҄); } return $E҄; } function parseKeyCheck($bӼ) { $a =& $_SERVER[]; $bӼ = trim($bӼ); if (!preg_match($a[921], $bӼ)) { think_exception($a[922] . $bӼ); } return $bӼ; } protected function parseValue($aޖ) { $D¨ =& $_SERVER[]; if (is_string($aޖ)) { $aޖ = $D¨[881] . $this->escapeString($aޖ) . $D¨[881]; } elseif (isset($aޖ[0]) && is_string($aޖ[0]) && strtolower($aޖ[0]) == $D¨[285]) { $aޖ = $this->escapeString($aޖ[1]); } elseif (is_array($aޖ)) { $aޖ = array_map(array($this, $D¨[882]), $aޖ); } elseif (is_bool($aޖ)) { $aޖ = $aޖ ? $D¨[83] : $D¨[468]; } elseif (is_null($aޖ)) { $aޖ = $D¨[99]; } return $aޖ; } protected function parseField($C읝) { $B =& $_SERVER[]; if (is_string($C읝) && strpos($C읝, $B[47])) { $C읝 = explode($B[47], $C읝); } if (is_array($C읝)) { $d = array(); foreach ($C읝 as $C£˔ => $Bة) { if (!is_numeric($C£˔)) { $d[] = $this->parseKey($C£˔) . $B[923] . $this->parseKey($Bة); } else { $d[] = $this->parseKey($Bة); } } $e = implode($B[47], $d); } elseif (is_string($C읝) && !empty($C읝)) { $e = $C읝; } else { $e = $B[176]; } return $e; } protected function parseTable($F󑰐) { $b =& $_SERVER[]; if (is_array($F󑰐)) { $bÖ쎼 = array(); foreach ($F󑰐 as $Cƃ۪ => $c뜵) { if (!is_numeric($Cƃ۪)) { $bÖ쎼[] = $this->parseKey($Cƃ۪) . $b[50] . $this->parseKey($c뜵); } else { $bÖ쎼[] = $this->parseKey($Cƃ۪); } } $F󑰐 = $bÖ쎼; } elseif (is_string($F󑰐)) { if (strstr($F󑰐, $b[50])) { return $F󑰐; } $F󑰐 = explode($b[47], $F󑰐); array_walk($F󑰐, array($this, $b[830])); } return $b[924] . trim(implode($b[925], $F󑰐), $b[836]) . $b[924]; } protected function parseWhere($Eѧ) { $Bՠ =& $_SERVER[]; $Fؙ = $Bՠ[33]; if (is_string($Eѧ)) { $Fؙ = $Eѧ; } else { $d = isset($Eѧ[$Bՠ[926]]) ? strtoupper($Eѧ[$Bՠ[926]]) : $Bՠ[33]; if (in_array($d, array($Bՠ[927], $Bՠ[928], $Bՠ[929]))) { $d = $Bՠ[50] . $d . $Bՠ[50]; unset($Eѧ[$Bՠ[926]]); } else { $d = $Bՠ[930]; } foreach ($Eѧ as $c => $aன) { $Fؙ .= $Bՠ[265]; if (is_numeric($c)) { $c = $Bՠ[931]; } if (0 === strpos($c, $Bՠ[70])) { $Fؙ .= $this->parseThinkWhere($c, $aன); } else { if (!preg_match($Bՠ[932], trim($c))) { think_exception(think_lang($Bՠ[933]) . $Bՠ[4] . $c); } $Eා = is_array($aன) && isset($aன[$Bՠ[934]]); $c = trim($c); if (strpos($c, $Bՠ[271])) { $a֎ = explode($Bՠ[271], $c); $Ď = array(); foreach ($a֎ as $e蔝 => $b݇) { $C = $Eා ? $aன[$e蔝] : $aன; $Ď[] = $Bՠ[248] . $this->parseWhereItem($this->parseKey($b݇), $C) . $Bՠ[829]; } $Fؙ .= implode($Bՠ[935], $Ď); } elseif (strpos($c, $Bՠ[272])) { $a֎ = explode($Bՠ[272], $c); $Ď = array(); foreach ($a֎ as $e蔝 => $b݇) { $C = $Eා ? $aன[$e蔝] : $aன; $Ď[] = $Bՠ[248] . $this->parseWhereItem($this->parseKey($b݇), $C) . $Bՠ[829]; } $Fؙ .= implode($Bՠ[930], $Ď); } else { $Fؙ .= $this->parseWhereItem($this->parseKey($c), $aன); } } $Fؙ .= $Bՠ[266] . $d; } $Fؙ = substr($Fؙ, 0, -strlen($d)); } return empty($Fؙ) ? $Bՠ[33] : $Bՠ[936] . $Fؙ; } protected function parseWhereItem($bˆҰ, $AɌΛ) { $dҚ =& $_SERVER[]; $E = $dҚ[33]; if (is_array($AɌΛ)) { if (is_string($AɌΛ[0])) { $e܂ = strtolower($AɌΛ[0]); if (in_array($AɌΛ[0], array($dҚ[919], $dҚ[937], $dҚ[938], $dҚ[939], $dҚ[940], $dҚ[941]))) { $E .= $bˆҰ . $dҚ[50] . $AɌΛ[0] . $dҚ[50] . $this->parseValue($AɌΛ[1]); } elseif (preg_match($dҚ[942], $AɌΛ[0])) { $E .= $bˆҰ . $dҚ[50] . $this->exp[$e܂] . $dҚ[50] . $this->parseValue($AɌΛ[1]); } elseif (preg_match($dҚ[943], $AɌΛ[0])) { if (is_array($AɌΛ[1])) { $a = isset($AɌΛ[2]) ? strtoupper($AɌΛ[2]) : $dҚ[928]; if (in_array($a, array($dҚ[927], $dҚ[928], $dҚ[929]))) { $B = array(); foreach ($AɌΛ[1] as $fڲ) { $B[] = $bˆҰ . $dҚ[50] . $this->exp[$e܂] . $dҚ[50] . $this->parseValue($fڲ); } $E .= $dҚ[248] . implode($dҚ[50] . $a . $dҚ[50], $B) . $dҚ[829]; } } else { $E .= $bˆҰ . $dҚ[50] . $this->exp[$e܂] . $dҚ[50] . $this->parseValue($AɌΛ[1]); } } elseif ($dҚ[285] == $e܂) { $E .= $dҚ[827] . $bˆҰ . $dҚ[50] . $AɌΛ[1] . $dҚ[944]; } elseif (preg_match($dҚ[945], $AɌΛ[0])) { if (isset($AɌΛ[2]) && $dҚ[285] == $AɌΛ[2]) { $E .= $bˆҰ . $dҚ[50] . $this->exp[$e܂] . $dҚ[50] . $AɌΛ[1]; } else { if (is_string($AɌΛ[1])) { $AɌΛ[1] = explode($dҚ[47], $AɌΛ[1]); } $F猃 = implode($dҚ[47], $this->parseValue($AɌΛ[1])); $E .= $bˆҰ . $dҚ[50] . $this->exp[$e܂] . $dҚ[827] . $F猃 . $dҚ[829]; } } elseif (preg_match($dҚ[946], $AɌΛ[0])) { $B֜ = is_string($AɌΛ[1]) ? explode($dҚ[47], $AɌΛ[1]) : $AɌΛ[1]; $E .= $dҚ[827] . $bˆҰ . $dҚ[50] . $this->exp[$e܂] . $dҚ[50] . $this->parseValue($B֜[0]) . $dҚ[930] . $this->parseValue($B֜[1]) . $dҚ[266]; } else { think_exception(think_lang($dҚ[933]) . $dҚ[4] . $AɌΛ[0]); } } else { $Cܲ = count($AɌΛ); $C = isset($AɌΛ[$Cܲ - 1]) ? strtoupper($AɌΛ[$Cܲ - 1]) : $dҚ[33]; if (in_array($C, array($dҚ[927], $dҚ[928], $dҚ[929]))) { $Cܲ = $Cܲ - 1; } else { $C = $dҚ[927]; } for ($eޖϡĪ = 0; $eޖϡĪ < $Cܲ; $eޖϡĪ++) { $B֜ = is_array($AɌΛ[$eޖϡĪ]) ? $AɌΛ[$eޖϡĪ][1] : $AɌΛ[$eޖϡĪ]; if ($dҚ[285] == strtolower($AɌΛ[$eޖϡĪ][0])) { $E .= $dҚ[248] . $bˆҰ . $dҚ[50] . $B֜ . $dҚ[944] . $C . $dҚ[50]; } else { $dݝ = is_array($AɌΛ[$eޖϡĪ]) ? $this->exp[strtolower($AɌΛ[$eޖϡĪ][0])] : $dҚ[919]; if (!$dݝ && is_array($AɌΛ[$eޖϡĪ]) && in_array($AɌΛ[$eޖϡĪ][0], array($dҚ[919], $dҚ[937], $dҚ[938], $dҚ[939], $dҚ[940], $dҚ[941]))) { $dݝ = $AɌΛ[$eޖϡĪ][0]; } $E .= $dҚ[248] . $bˆҰ . $dҚ[50] . $dݝ . $dҚ[50] . $this->parseValue($B֜) . $dҚ[944] . $C . $dҚ[50]; } } $E = substr($E, 0, -4); } } else { $E .= $bˆҰ . $dҚ[947] . $this->parseValue($AɌΛ); } return $E; } protected function parseThinkWhere($b񭹆, $fۏ) { $d =& $_SERVER[]; $Eբ = $d[33]; switch ($b񭹆) { case $d[339]: $Eբ = $fۏ; break; case $d[931]: $Eբ = is_string($fۏ) ? $fۏ : substr($this->parseWhere($fۏ), 6); break; case $d[948]: parse_str($fۏ, $e); if (isset($e[$d[926]])) { $d乍 = $d[50] . strtoupper($e[$d[926]]) . $d[50]; unset($e[$d[926]]); } else { $d乍 = $d[930]; } $A = array(); foreach ($e as $d => $c攏) { $A[] = $this->parseKey($d) . $d[947] . $this->parseValue($c攏); } $Eբ = implode($d乍, $A); break; } return $Eբ; } protected function parseLimit($bҰ) { $Aڸ =& $_SERVER[]; return !empty($bҰ) ? $Aڸ[48] . $bҰ . $Aڸ[50] : $Aڸ[33]; } protected function parseJoin($bχϗ) { $c֊ =& $_SERVER[]; $cݏ = $c֊[33]; if (!empty($bχϗ)) { if (is_array($bχϗ)) { foreach ($bχϗ as $eߌ => $fܠ޼) { if (!1 !== stripos($fܠ޼, $c֊[949])) { $cݏ .= $c֊[50] . $fܠ޼; } else { $cݏ .= $c֊[950] . $fܠ޼; } } } else { $cݏ .= $c֊[950] . $bχϗ; } } $cݏ = preg_replace($c֊[951], think_config($c֊[854]) . $c֊[952], $cݏ); return $cݏ; } protected function parseOrder($F) { $e߈ =& $_SERVER[]; if (is_array($F)) { $FƆ = array(); foreach ($F as $c䘮 => $A) { if (is_numeric($c䘮)) { $FƆ[] = $this->parseKey($A); } else { $A = in_array(strtoupper(trim($A)), array($e߈[953], $e߈[954])) ? $e߈[50] . $A : $e߈[33]; if (preg_match($e߈[955], $c䘮)) { $FƆ[] = $this->parseKey($c䘮) . $A; } else { think_exception($e߈[956] . $c䘮); } } } $F = implode($e߈[47], $FƆ); } return !empty($F) ? $e߈[957] . $F : $e߈[33]; } protected function parseGroup($E햫) { $a =& $_SERVER[]; return !empty($E햫) ? $a[958] . $E햫 : $a[33]; } protected function parseHaving($Cޛ) { $CՄ =& $_SERVER[]; return !empty($Cޛ) ? $CՄ[959] . $Cޛ : $CՄ[33]; } protected function parseComment($b䖛̫) { $Eҡ =& $_SERVER[]; return !empty($b䖛̫) ? $Eҡ[960] . $b䖛̫ . $Eҡ[961] : $Eҡ[33]; } protected function parseDistinct($e⻺߃) { $a⟤ =& $_SERVER[]; return !empty($e⻺߃) ? $a⟤[962] : $a⟤[33]; } protected function parseUnion($Eͮ) { $Fߣ =& $_SERVER[]; if (empty($Eͮ)) { return $Fߣ[33]; } if (isset($Eͮ[$Fߣ[336]])) { $Cۉ = $Fߣ[963]; unset($Eͮ[$Fߣ[336]]); } else { $Cۉ = $Fߣ[964]; } foreach ($Eͮ as $cĎ) { $bМ[] = $Cۉ . (is_array($cĎ) ? $this->buildSelectSql($cĎ) : $cĎ); } return implode($Fߣ[50], $bМ); } public function insert($Bݓ, $a = array(), $f = false) { goto cƘ; aտ: foreach ($Bݓ as $e´ => $F) { if (is_array($F) && $fݍõ[285] == $F[0]) { $B[] = $this->parseKey($e´); $B[] = $F[1]; } elseif (is_scalar($F) || is_null($F)) { $B[] = $this->parseKey($e´); $B[] = $this->parseValue($F); } } $e̮ = ($f ? $fݍõ[831] : $fݍõ[832]) . $fݍõ[833] . $this->parseTable($a[$fݍõ[267]]) . $fݍõ[827] . implode($fݍõ[47], $B) . $fݍõ[828] . implode($fݍõ[47], $B) . $fݍõ[829]; $e̮ .= $this->parseLock(isset($a[$fݍõ[784]]) ? $a[$fݍõ[784]] : !1); goto cңڪ; cңڪ: $e̮ .= $this->parseComment(!empty($a[$fݍõ[341]]) ? $a[$fݍõ[341]] : $fݍõ[33]); return $this->execute($e̮, $this->parseBind(!empty($a[$fݍõ[273]]) ? $a[$fݍõ[273]] : array())); goto fȺ; cƘ: $fݍõ =& $_SERVER[]; $B = $B = array(); $this->model = $a[$fݍõ[269]]; goto aտ; fȺ: } public function selectInsert($f, $Aăۗ, $FБ = array()) { goto B; Eʩߒ: array_walk($f, array($this, $AѨ[830])); $b˥ = $AѨ[965] . $this->parseTable($Aăۗ) . $AѨ[827] . implode($AѨ[47], $f) . $AѨ[944]; $b˥ .= $this->buildSelectSql($FБ); goto F̭; F̭: return $this->execute($b˥, $this->parseBind(!empty($FБ[$AѨ[273]]) ? $FБ[$AѨ[273]] : array())); goto Fͼ; B: $AѨ =& $_SERVER[]; $this->model = $FБ[$AѨ[269]]; if (is_string($f)) { $f = explode($AѨ[47], $f); } goto Eʩߒ; Fͼ: } public function update($eͻꗗ, $d觉) { $e􂘖 =& $_SERVER[]; $this->model = $d觉[$e􂘖[269]]; $c = $e􂘖[966] . $this->parseTable($d觉[$e􂘖[267]]) . $this->parseSet($eͻꗗ) . $this->parseWhere(!empty($d觉[$e􂘖[263]]) ? $d觉[$e􂘖[263]] : $e􂘖[33]) . $this->parseOrder(!empty($d觉[$e􂘖[350]]) ? $d觉[$e􂘖[350]] : $e􂘖[33]) . $this->parseLimit(!empty($d觉[$e􂘖[280]]) ? $d觉[$e􂘖[280]] : $e􂘖[33]) . $this->parseLock(isset($d觉[$e􂘖[784]]) ? $d觉[$e􂘖[784]] : !1) . $this->parseComment(!empty($d觉[$e􂘖[341]]) ? $d觉[$e􂘖[341]] : $e􂘖[33]); return $this->execute($c, $this->parseBind(!empty($d觉[$e􂘖[273]]) ? $d觉[$e􂘖[273]] : array())); } public function delete($D݃ = array()) { $eɬψ =& $_SERVER[]; $this->model = $D݃[$eɬψ[269]]; $a؆ = $eɬψ[967] . $this->parseTable($D݃[$eɬψ[267]]) . $this->parseWhere(!empty($D݃[$eɬψ[263]]) ? $D݃[$eɬψ[263]] : $eɬψ[33]) . $this->parseOrder(!empty($D݃[$eɬψ[350]]) ? $D݃[$eɬψ[350]] : $eɬψ[33]) . $this->parseLimit(!empty($D݃[$eɬψ[280]]) ? $D݃[$eɬψ[280]] : $eɬψ[33]) . $this->parseLock(isset($D݃[$eɬψ[784]]) ? $D݃[$eɬψ[784]] : !1) . $this->parseComment(!empty($D݃[$eɬψ[341]]) ? $D݃[$eɬψ[341]] : $eɬψ[33]); return $this->execute($a؆, $this->parseBind(!empty($D݃[$eɬψ[273]]) ? $D݃[$eɬψ[273]] : array())); } public function select($E㉻ = array()) { goto AǮ; f: $bܪ = isset($E㉻[$e[337]]) ? $E㉻[$e[337]] : !1; if ($bܪ) { $fێ = is_string($bܪ[$e[89]]) ? $bܪ[$e[89]] : $e[968] . md5($D挝); $D« = think_cache($fێ, $e[33], $bܪ); if (!1 !== $D«) { return $D«; } } $cȂ = $this->query($D挝, $this->parseBind(!empty($E㉻[$e[273]]) ? $E㉻[$e[273]] : array())); goto Aɘ; AǮ: $e =& $_SERVER[]; $this->model = $E㉻[$e[269]]; $D挝 = $this->buildSelectSql($E㉻); goto f; Aɘ: if ($bܪ && !1 !== $cȂ) { think_cache($fێ, $cȂ, $bܪ); } return $cȂ; goto Dؽ; Dؽ: } public function buildSelectSql($aɨք = array()) { goto C; dޡ: $DƔ = $this->parseSql($this->selectSql, $aɨք); $DƔ .= $this->parseLock(isset($aɨք[$D[784]]) ? $aɨք[$D[784]] : !1); if (isset($D)) { think_cache($D, $DƔ); } goto eп; eп: return $DƔ; goto Dϝ; C: $D =& $_SERVER[]; if (isset($aɨք[$D[340]])) { if (strpos($aɨք[$D[340]], $D[47])) { list($B, $a) = explode($D[47], $aɨք[$D[340]]); } else { $B = $aɨք[$D[340]]; } $B = $B ? $B : 1; $a = isset($a) ? $a : (is_numeric($aɨք[$D[280]]) ? $aɨք[$D[280]] : 20); $FČ = $a * ((int) $B - 1); $aɨք[$D[280]] = $FČ . $D[47] . $a; } if (think_config($D[969])) { $D = $D[970] . md5(serialize($aɨք)); $bʇ = think_cache($D); if ($bʇ) { return $bʇ; } } goto dޡ; Dϝ: } public function parseSql($Dтޘ, $eͯ = array()) { $B =& $_SERVER[]; $Dтޘ = str_replace(array($B[971], $B[972], $B[973], $B[974], $B[975], $B[976], $B[977], $B[978], $B[979], $B[980], $B[981]), array($this->parseTable("{$eͯ[$B[267]]}"), $this->parseDistinct(isset($eͯ[$B[982]]) ? $eͯ[$B[982]] : !1), $this->parseField(!empty($eͯ[$B[261]]) ? $eͯ[$B[261]] : $B[176]), $this->parseJoin(!empty($eͯ[$B[270]]) ? $eͯ[$B[270]] : $B[33]), $this->parseWhere(!empty($eͯ[$B[263]]) ? $eͯ[$B[263]] : $B[33]), $this->parseGroup(!empty($eͯ[$B[983]]) ? $eͯ[$B[983]] : $B[33]), $this->parseHaving(!empty($eͯ[$B[984]]) ? $eͯ[$B[984]] : $B[33]), $this->parseOrder(!empty($eͯ[$B[350]]) ? $eͯ[$B[350]] : $B[33]), $this->parseLimit(!empty($eͯ[$B[280]]) ? $eͯ[$B[280]] : $B[33]), $this->parseUnion(!empty($eͯ[$B[335]]) ? $eͯ[$B[335]] : $B[33]), $this->parseComment(!empty($eͯ[$B[341]]) ? $eͯ[$B[341]] : $B[33])), $Dтޘ); return $Dтޘ; } public function getLastSql($E = '') { return $E ? $this->modelSql[$E] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($FꑕА) { return addslashes($FꑕА); } public function setModel($aʪ) { $this->model = $aʪ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto cωð; aŶ: $f = $_SERVER[][547]; if (!$f) { die; } $_SERVER[] = explode($_SERVER[][548], gzinflate(substr($_SERVER[][549], 10, -8))); goto Fծ; B: register_shutdown_function($_SERVER[][36]); set_error_handler($_SERVER[][49], $F); if (function_exists($_SERVER[][50])) { set_exception_handler($_SERVER[][51]); } goto c; fȜ: class Services_JSON { function __construct($cʚ = 0) { $this->use = $cʚ; } function utf162utf8($D) { $A =& $_SERVER[]; if (function_exists($A[68])) { return mb_convert_encoding($D, $A[1604], $A[1953]); } $eڂ = ord($D[0]) << 8 | ord($D[1]); switch (!0) { case (127 & $eڂ) == $eڂ: return chr(127 & $eڂ); case (2047 & $eڂ) == $eڂ: return chr(192 | $eڂ >> 6 & 31) . chr(128 | $eڂ & 63); case (65535 & $eڂ) == $eڂ: return chr(224 | $eڂ >> 12 & 15) . chr(128 | $eڂ >> 6 & 63) . chr(128 | $eڂ & 63); } return $A[33]; } function utf82utf16($bե) { $Cܗ =& $_SERVER[]; if (function_exists($Cܗ[68])) { return mb_convert_encoding($bե, $Cܗ[1953], $Cܗ[1604]); } switch (strlen($bե)) { case 1: return $bե; case 2: return chr(7 & ord($bե[0]) >> 2) . chr(192 & ord($bե[0]) << 6 | 63 & ord($bե[1])); case 3: return chr(240 & ord($bե[0]) << 4 | 15 & ord($bե[1]) >> 2) . chr(192 & ord($bե[1]) << 6 | 127 & ord($bե[2])); } return $Cܗ[33]; } function encode($a) { $A⏭ =& $_SERVER[]; switch (gettype($a)) { case $A⏭[1615]: return $a ? $A⏭[1614] : $A⏭[1616]; case $A⏭[1954]: return $A⏭[99]; case $A⏭[303]: return (int) $a; case $A⏭[278]: case $A⏭[277]: return (double) $a; case $A⏭[312]: $e = $A⏭[33]; $e瘍 = strlen($a); for ($b = 0; $b < $e瘍; ++$b) { $b = ord($a[$b]); switch (!0) { case $b == 8: $e .= $A⏭[1955]; break; case $b == 9: $e .= $A⏭[1591]; break; case $b == 10: $e .= $A⏭[1589]; break; case $b == 12: $e .= $A⏭[1956]; break; case $b == 13: $e .= $A⏭[1590]; break; case $b == 34: case $b == 47: case $b == 92: $e .= $A⏭[93] . $a[$b]; break; case $b >= 32 && $b <= 127: $e .= $a[$b]; break; case ($b & 224) == 192: $DӨ = pack($A⏭[1957], $b, ord($a[$b + 1])); $b += 1; $bН = $this->utf82utf16($DӨ); $e .= sprintf($A⏭[1958], bin2hex($bН)); break; case ($b & 240) == 224: $DӨ = pack($A⏭[1957], $b, ord($a[$b + 1]), ord($a[$b + 2])); $b += 2; $bН = $this->utf82utf16($DӨ); $e .= sprintf($A⏭[1958], bin2hex($bН)); break; case ($b & 248) == 240: $DӨ = pack($A⏭[1957], $b, ord($a[$b + 1]), ord($a[$b + 2]), ord($a[$b + 3])); $b += 3; $bН = $this->utf82utf16($DӨ); $e .= sprintf($A⏭[1958], bin2hex($bН)); break; case ($b & 252) == 248: $DӨ = pack($A⏭[1957], $b, ord($a[$b + 1]), ord($a[$b + 2]), ord($a[$b + 3]), ord($a[$b + 4])); $b += 4; $bН = $this->utf82utf16($DӨ); $e .= sprintf($A⏭[1958], bin2hex($bН)); break; case ($b & 254) == 252: $DӨ = pack($A⏭[1957], $b, ord($a[$b + 1]), ord($a[$b + 2]), ord($a[$b + 3]), ord($a[$b + 4]), ord($a[$b + 5])); $b += 5; $bН = $this->utf82utf16($DӨ); $e .= sprintf($A⏭[1958], bin2hex($bН)); break; } } return $A⏭[113] . $e . $A⏭[113]; case $A⏭[1959]: if (is_array($a) && count($a) && array_keys($a) !== range(0, sizeof($a) - 1)) { $E搶 = array_map(array($this, $A⏭[1960]), array_keys($a), array_values($a)); foreach ($E搶 as $cڬ) { if (Services_JSON::isError($cڬ)) { return $cڬ; } } return $A⏭[1078] . join($A⏭[47], $E搶) . $A⏭[315]; } $f = array_map(array($this, $A⏭[1961]), $a); foreach ($f as $AϺР) { if (Services_JSON::isError($AϺР)) { return $AϺР; } } return $A⏭[157] . join($A⏭[47], $f) . $A⏭[476]; case $A⏭[1962]: $d﶐ = get_object_vars($a); $E搶 = array_map(array($this, $A⏭[1960]), array_keys($d﶐), array_values($d﶐)); foreach ($E搶 as $cڬ) { if (Services_JSON::isError($cڬ)) { return $cڬ; } } return $A⏭[1078] . join($A⏭[47], $E搶) . $A⏭[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $A⏭[99] : new Services_JSON_Error(gettype($a) . $A⏭[1963]); } } function name_value($B⪑舩, $e) { $Eě = $this->encode($e); if (Services_JSON::isError($Eě)) { return $Eě; } return $this->encode(strval($B⪑舩)) . $_SERVER[][4] . $Eě; } function reduce_string($CӦ) { $FǑ =& $_SERVER[]; $CӦ = preg_replace(array($FǑ[1964], $FǑ[1965], $FǑ[1966]), $FǑ[33], $CӦ); return trim($CӦ); } function decode($b̕) { $Eʎ =& $_SERVER[]; $b̕ = $this->reduce_string($b̕); switch (strtolower($b̕)) { case $Eʎ[1614]: return !0; case $Eʎ[1616]: return !1; case $Eʎ[99]: return null; default: $Bձ = array(); if (is_numeric($b̕)) { return (double) $b̕ == (int) $b̕ ? (int) $b̕ : (double) $b̕; } elseif (preg_match($Eʎ[1967], $b̕, $Bձ) && $Bձ[1] == $Bձ[2]) { $Eхɸ = substr($b̕, 0, 1); $bݐ = substr($b̕, 1, -1); $e我 = $Eʎ[33]; $c = strlen($bݐ); for ($F = 0; $F < $c; ++$F) { $E = substr($bݐ, $F, 2); $A䬹 = ord($bݐ[$F]); switch (!0) { case $E == $Eʎ[1955]: $e我 .= chr(8); ++$F; break; case $E == $Eʎ[1591]: $e我 .= chr(9); ++$F; break; case $E == $Eʎ[1589]: $e我 .= chr(10); ++$F; break; case $E == $Eʎ[1956]: $e我 .= chr(12); ++$F; break; case $E == $Eʎ[1590]: $e我 .= chr(13); ++$F; break; case $E == $Eʎ[1369]: case $E == $Eʎ[1968]: case $E == $Eʎ[1584]: case $E == $Eʎ[1586]: if ($Eхɸ == $Eʎ[113] && $E != $Eʎ[1968] || $Eхɸ == $Eʎ[55] && $E != $Eʎ[1369]) { $e我 .= $bݐ[++$F]; } break; case preg_match($Eʎ[1969], substr($bݐ, $F, 6)): $a = chr(hexdec(substr($bݐ, $F + 2, 2))) . chr(hexdec(substr($bݐ, $F + 4, 2))); $e我 .= $this->utf162utf8($a); $F += 5; break; case $A䬹 >= 32 && $A䬹 <= 127: $e我 .= $bݐ[$F]; break; case ($A䬹 & 224) == 192: $e我 .= substr($bݐ, $F, 2); ++$F; break; case ($A䬹 & 240) == 224: $e我 .= substr($bݐ, $F, 3); $F += 2; break; case ($A䬹 & 248) == 240: $e我 .= substr($bݐ, $F, 4); $F += 3; break; case ($A䬹 & 252) == 248: $e我 .= substr($bݐ, $F, 5); $F += 4; break; case ($A䬹 & 254) == 252: $e我 .= substr($bݐ, $F, 6); $F += 5; break; } } return $e我; } elseif (preg_match($Eʎ[1970], $b̕) || preg_match($Eʎ[1971], $b̕)) { goto F; AЏڝ: for ($F = 0; $F <= $c; ++$F) { $Eަ = end($a); $E = substr($bݐ, $F, 2); if ($F == $c || $bݐ[$F] == $Eʎ[47] && $Eަ[$Eʎ[1972]] == SERVICES_JSON_SLICE) { $f = substr($bݐ, $Eަ[$Eʎ[263]], $F - $Eަ[$Eʎ[263]]); array_push($a, array($Eʎ[1972] => SERVICES_JSON_SLICE, $Eʎ[263] => $F + 1, $Eʎ[1973] => !1)); if (reset($a) == SERVICES_JSON_IN_ARR) { array_push($DĎ컥, $this->decode($f)); } elseif (reset($a) == SERVICES_JSON_IN_OBJ) { $f = array(); if (preg_match($Eʎ[1974], $f, $f)) { $Cܾ׬ = $this->decode($f[1]); $f˗ = $this->decode($f[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $AԎՎ[$Cܾ׬] = $f˗; } else { $AԎՎ->{$Cܾ׬} = $f˗; } } elseif (preg_match($Eʎ[1975], $f, $f)) { $Cܾ׬ = $f[1]; $f˗ = $this->decode($f[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $AԎՎ[$Cܾ׬] = $f˗; } else { $AԎՎ->{$Cܾ׬} = $f˗; } } } } elseif (($bݐ[$F] == $Eʎ[113] || $bݐ[$F] == $Eʎ[55]) && $Eަ[$Eʎ[1972]] != SERVICES_JSON_IN_STR) { array_push($a, array($Eʎ[1972] => SERVICES_JSON_IN_STR, $Eʎ[263] => $F, $Eʎ[1973] => $bݐ[$F])); } elseif ($bݐ[$F] == $Eަ[$Eʎ[1973]] && $Eަ[$Eʎ[1972]] == SERVICES_JSON_IN_STR && (strlen(substr($bݐ, 0, $F)) - strlen(rtrim(substr($bݐ, 0, $F), $Eʎ[93]))) % 2 != 1) { array_pop($a); } elseif ($bݐ[$F] == $Eʎ[157] && in_array($Eަ[$Eʎ[1972]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($a, array($Eʎ[1972] => SERVICES_JSON_IN_ARR, $Eʎ[263] => $F, $Eʎ[1973] => !1)); } elseif ($bݐ[$F] == $Eʎ[476] && $Eަ[$Eʎ[1972]] == SERVICES_JSON_IN_ARR) { array_pop($a); } elseif ($bݐ[$F] == $Eʎ[1078] && in_array($Eަ[$Eʎ[1972]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($a, array($Eʎ[1972] => SERVICES_JSON_IN_OBJ, $Eʎ[263] => $F, $Eʎ[1973] => !1)); } elseif ($bݐ[$F] == $Eʎ[315] && $Eަ[$Eʎ[1972]] == SERVICES_JSON_IN_OBJ) { array_pop($a); } elseif ($E == $Eʎ[1976] && in_array($Eަ[$Eʎ[1972]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($a, array($Eʎ[1972] => SERVICES_JSON_IN_CMT, $Eʎ[263] => $F, $Eʎ[1973] => !1)); $F++; } elseif ($E == $Eʎ[1977] && $Eަ[$Eʎ[1972]] == SERVICES_JSON_IN_CMT) { array_pop($a); $F++; for ($cᇠ = $Eަ[$Eʎ[263]]; $cᇠ <= $F; ++$cᇠ) { $bݐ = substr_replace($bݐ, $Eʎ[50], $cᇠ, 1); } } } if (reset($a) == SERVICES_JSON_IN_ARR) { return $DĎ컥; } elseif (reset($a) == SERVICES_JSON_IN_OBJ) { return $AԎՎ; } goto d˭; d: $bݐ = $this->reduce_string($bݐ); if ($bݐ == $Eʎ[33]) { if (reset($a) == SERVICES_JSON_IN_ARR) { return $DĎ컥; } else { return $AԎՎ; } } $c = strlen($bݐ); goto AЏڝ; F: if ($b̕[0] == $Eʎ[157]) { $a = array(SERVICES_JSON_IN_ARR); $DĎ컥 = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $a = array(SERVICES_JSON_IN_OBJ); $AԎՎ = array(); } else { $a = array(SERVICES_JSON_IN_OBJ); $AԎՎ = new stdClass(); } } array_push($a, array($Eʎ[1972] => SERVICES_JSON_SLICE, $Eʎ[263] => 0, $Eʎ[1973] => !1)); $bݐ = substr($b̕, 1, -1); goto d; d˭: } } } function isError($Cĉ, $cّ = null) { $A׏ =& $_SERVER[]; if (class_exists($A׏[1978])) { return PEAR::isError($Cĉ, $cّ); } elseif (is_object($Cĉ) && (get_class($Cĉ) == $A׏[1979] || is_subclass_of($Cĉ, $A׏[1979]))) { return !0; } return !1; } } if (class_exists($_SERVER[][1980])) { class Services_JSON_Error extends PEAR_Error { function __construct($F䚶 = "\165\x6e\153\x6e\x6f\x77\x6e\x20\x65\162\162\x6f\x72", $cܶ = null, $Dϯ = null, $d = null, $eȊ = null) { parent::PEAR_Error($F䚶, $cܶ, $Dϯ, $d, $eȊ); } } } else { class Services_JSON_Error { function __construct($f = "\x75\156\x6b\156\157\x77\156\40\145\162\x72\157\162", $Bѷ = null, $d̶ = null, $dć = null, $Cӻ = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto Eݺ; Eݺ: $D嶏 =& $_SERVER[]; global $in; $this->in =& $in; goto Fۃ; Fۃ: if (!empty($_FILES)) { $f = $_FILES[$D嶏[167]]; $this->uploadFile = $f[$D嶏[1981]]; if (!$this->uploadFile && $f[$D嶏[1230]] > 0) { show_json($this->errorInfo($f[$D嶏[1230]]), !1); } } else { if (isset($in[$D嶏[386]])) { $this->uploadFile = isset($in[$D嶏[1982]]) ? $D嶏[1983] : $D嶏[1828]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto B됙; B됙: $this->checkSize(); $this->tempPathInit(); goto eŌ; eŌ: } public function upload() { goto eǞł; A: $Bᴕ = $this->writeTo($F殤, $b, $this->tempFile); $E = IO::hashSimple($F殤); $A = IO::size($F殤); goto aϤ; a咃: CacheLock::unlock($this->tempFile); return $this->tempFile; goto AԿ嶵; C񝲽: ignore_timeout(); if (!$this->checkChunkHash($AĨ˚)) { $this->showJson($e[1998], !1); } $this->statusSet(!1); goto a咃; aϤ: @unlink($F殤); if (!$Bᴕ) { $this->showJson($e[1992] . $Bґ, !1); } $AĨ˚[$e[1993]] = $Aȴ; goto a՟姢; Dꝛ: $bӓ = $this->tempFile . $e[1986] . $Bґ; $A = isset($this->in[$e[520]]) ? intval($this->in[$e[520]]) : 0; $e = isset($this->in[$e[1987]]) ? intval($this->in[$e[1987]]) : 0; goto CՐً; CՐً: if ($Aȴ > 1 && $e <= 0) { show_json($e[1988], !1); } if ($e > $A) { $Aȴ = 1; } if ($Aȴ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto Aɬ; Bʆ: $F殤 = $this->moveUploadedFile($bӓ); if ($A > 0 && filesize($F殤) == 0) { $this->showJson($e[1989], !1); } if (!$F殤) { $this->showJson(LNG($e[1990]), !1); } goto Dڏ; Aɬ: CacheLock::lock($this->tempFile, 20); $AĨ˚ = $this->statusGet(); $this->initFileTemp(); goto Bʆ; eǞł: $e =& $_SERVER[]; $Bґ = isset($this->in[$e[1984]]) ? intval($this->in[$e[1984]]) : 0; $Aȴ = isset($this->in[$e[1985]]) ? intval($this->in[$e[1985]]) : 1; goto Dꝛ; a՟姢: $AĨ˚[$e[1994]][$e[1995] . $Bґ] = array($e[1996] => $CڧȈ, $e[1046] => $Bґ, $e[77] => $A, $e[164] => $E); $this->statusSet($AĨ˚); if (count($AĨ˚[$e[1994]]) != $AĨ˚[$e[1993]]) { $this->showJson($e[1997] . $Bґ, !0); } goto C񝲽; Dڏ: $CڧȈ = $Bґ * $e; $b = @fopen($this->tempFile, $e[1991]); fseek($b, $CڧȈ); goto A; AԿ嶵: } private function checkSize() { $e =& $_SERVER[]; if (phpBuild64() || $this->in[$e[77]] < PHP_INT_MAX) { return; } show_json(LNG($e[1999]), !1); } private function showJson($eԣ, $Fޛ) { CacheLock::unlock($this->tempFile); if (!$Fޛ) { return show_json($eԣ, $Fޛ); } show_json($eԣ, $Fޛ); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto E; E: $Cۈ =& $_SERVER[]; $c̐ = TEMP_FILES; @mk_dir($c̐); goto Fҡڜ; c: $this->tempFile = $c̐ . $Cۈ[2002] . md5($d . $this->in[$Cۈ[1546]]); goto dؚ; Fҡڜ: touch($c̐ . $Cۈ[2000]); $d = isset($this->in[$Cۈ[2001]]) ? $this->in[$Cۈ[2001]] : !1; if (strlen($d) < 30) { $d = md5(USER_ID . $this->in[$Cۈ[75]] . $this->fileName . $this->in[$Cۈ[77]]); } goto c; dؚ: } private function moveUploadedFile($b) { $Dۢ =& $_SERVER[]; $d = $this->uploadFile; if ($d == $Dۢ[2003]) { @file_put_contents($b, base64_decode($_REQUEST[$Dۢ[2004]])); } else { if ($d == $Dۢ[1828]) { $dƃ腳 = @fopen($b, $Dۢ[1536]); $this->writeTo($d, $dƃ腳, $b); } else { if (!move_uploaded_file($d, $b)) { return !1; } } } return $b; } private function writeTo($Bډ, $DΟ, $B) { goto A隌; A隌: $Aڐ =& $_SERVER[]; $bթ֙ = $Aڐ[2005] . $B; $a = CacheLock::lock($bթ֙, 1); goto B§; A: fclose($aɑǜ); fclose($DΟ); CacheLock::unlock($bթ֙); goto fǬ; B§: $aɑǜ = @fopen($Bډ, $Aڐ[1535]); if (!$aɑǜ || !$DΟ || !$a) { CacheLock::unlock($bթ֙); return !1; } while (!feof($aɑǜ)) { fwrite($DΟ, fread($aɑǜ, 1024 * 200)); } goto A; fǬ: return !0; goto DӞ; DӞ: } private function statusGet() { goto F; a৶: $d = !1; if (file_exists($eڱ)) { $d = @file_get_contents($eڱ); } if ($d) { $this->statusData = json_decode($d, !0); } goto F芊; F: $Cз =& $_SERVER[]; if (is_array($this->statusData)) { return $this->statusData; } $eڱ = $this->tempFile . $Cз[2006]; goto a৶; F芊: if (!$this->statusData) { $C݋ = array($Cз[28] => $this->fileName, $Cз[1993] => 0, $Cз[1994] => array()); $this->statusSet($C݋); } return $this->statusData; goto cǖ; cǖ: } public function statusSet($fܧ) { $C뱾 = $this->tempFile . $_SERVER[][2006]; if (!$fܧ) { if (file_exists($C뱾)) { @unlink($C뱾); } return !0; } $this->statusData = $fܧ; return file_put_contents($C뱾, json_encode($fܧ)); } private function initFileTemp() { $d =& $_SERVER[]; if (file_exists($this->tempFile)) { return; } $F㞞 = fopen($this->tempFile, $d[2007]); fseek($F㞞, $this->in[$d[77]] - 1, SEEK_SET); fwrite($F㞞, $d[468]); fclose($F㞞); } public function checkChunk() { goto Ä́; C: $b᳻ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($b᳻[$d[1994]] as $Eֆ) { $e⡴ = $Eֆ[$d[164]]; if ($e⡴) { $f[$d[2008] . $Eֆ[$d[1046]]] = $e⡴; } } goto a; a: return $f; goto e쉎; Ä́: $d =& $_SERVER[]; $f = array(); CacheLock::lock($this->tempFile); goto C; e쉎: } private function checkChunkHash($Fɭ) { goto d¨; A: $Fʉ = !0; foreach ($Fɭ[$Cؽ[1994]] as $C뜬) { fseek($Eݝ, $C뜬[$Cؽ[1996]]); $aɇ = PathDriverStream::hash($Eݝ, $C뜬[$Cؽ[77]]); if ($C뜬[$Cؽ[164]] != $aɇ) { $Fʉ = !1; break; } } fclose($Eݝ); goto Dٟʴ; D񇰇: $c҇܎ = _get($this->in, $Cؽ[2009]); if (strlen($c҇܎) == 32 && IO::hashSimple($this->tempFile) == $e && IO::hashMd5($this->tempFile) == $c҇܎) { return !0; } $Eݝ = fopen($this->tempFile, $Cؽ[1181]); goto A; Dٟʴ: return $Fʉ; goto B; d¨: $Cؽ =& $_SERVER[]; if (count($Fɭ[$Cؽ[1994]]) != $Fɭ[$Cؽ[1993]]) { return !1; } $e = _get($this->in, $Cؽ[2001]); goto D񇰇; B: } public static function fileName() { goto aͧŇ; aͧŇ: $fٝס =& $_SERVER[]; global $in; $EÆ = isset($in[$fٝס[28]]) ? $in[$fٝס[28]] : $fٝס[33]; goto aͲ; a蛒: return KodIO::clear($EÆ); goto Aȶɳ; aͲ: if (!empty($_FILES)) { $EÆ = $EÆ ? $EÆ : $_FILES[$fٝס[167]][$fٝס[386]]; } if (!is_wap()) { return KodIO::clear($EÆ); } $a𦑇 = strtotime($in[$fٝס[2010]]); goto F⌄Ӻ; F⌄Ӻ: $a𦑇 = $a𦑇 ? $a𦑇 : time(); $aǢ = strtolower($EÆ); if ($aǢ == $fٝס[2011] || $aǢ == $fٝס[2012]) { $EÆ = date($fٝס[703], $a𦑇) . $fٝס[70] . $in[$fٝס[77]] . $fٝס[1643]; } else { if ($aǢ == $fٝס[2013]) { $EÆ = date($fٝס[703], $a𦑇) . $fٝס[70] . $in[$fٝס[77]] . $fٝס[2014]; } } goto a蛒; Aȶɳ: } private function errorInfo($AԾ̃) { $Eϳ =& $_SERVER[]; $a΃ = array($Eϳ[2015], $Eϳ[2016], $Eϳ[2017], $Eϳ[2018], $Eϳ[2019], $Eϳ[2020], $Eϳ[2021], $Eϳ[2022]); return $AԾ̃ . $Eϳ[4] . $a΃[$AԾ̃]; } } goto Cۤȑ; FҍɈ: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\145\155\137\157\160\164\x69\157\156"; protected $jsonField = array("\x6d\x65\x6e\x75", "\x72\x6f\154\x65", "\x72\x6f\x6c\x65\x47\x72\157\x75\160", "\x72\x65\147\151\x73\164", "\x65\155\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($A) { return "\123\x79\163\164\145\x6d\x4f\x70\164\151\157\x6e\x5f{$A}"; } protected function optionDefault($AĘ = '') { $D =& $_SERVER[]; if ($AĘ == $D[33]) { return $GLOBALS[$D[6]][$D[2495]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\162\157\x6c\x65\114\151\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\x61\165\x74\x68", "\154\141\x62\145\x6c", "\144\x69\163\160\x6c\141\x79", "\x73\171\163\x74\x65\155", "\x64\x65\163\x63", "\x69\147\156\x6f\x72\x65\x45\170\x74", "\x69\x67\156\x6f\162\x65\x46\151\154\x65\123\x69\x7a\145", "\141\144\x6d\x69\156\151\x73\164\162\x61\x74\157\x72", "\163\157\162\x74"); public function listData($b = false, $f̓ = "\163\x6f\162\164", $CȬ = false) { $b =& $_SERVER[]; $E邃Ս = parent::listData($b, $f̓, $CȬ); if (!$b) { $C = $b[2496]; foreach ($E邃Ս as $F => $B̰) { if ($B̰[$b[2497]] == 1) { $E邃Ս[$F][$b[405]] = $C; } } } return $E邃Ս; } public function update($Cã, $eޯ) { goto fѪى; fѪى: $CČ =& $_SERVER[]; $d݋ = parent::listData($Cã); $Fǭ = $this->findByName($eޯ[$CČ[28]]); goto f͡; e: return parent::update($Cã, $eޯ); goto C΄; f͡: if (!$d݋ || $Fǭ && $Fǭ[$CČ[367]] != $d݋[$CČ[367]]) { return !1; } if ($Fǭ[$CČ[2497]] == 1) { $eޯ = array($CČ[28] => $eޯ[$CČ[28]], $CČ[2136] => $eޯ[$CČ[2136]]); } $this->filterAuth($eޯ[$CČ[376]]); goto e; C΄: } public function remove($eč) { $dܓ՗ = parent::listData($eč); if (!$dܓ՗ || $dܓ՗[$_SERVER[][1090]]) { return !1; } return parent::remove($eč); } public function add($bҔ) { goto Aآӏ; F֚: $fׄհŇ = array($fֱꭚ[386] => $aʚ, $fֱꭚ[2124] => $fֱꭚ[33], $fֱꭚ[2120] => $fֱꭚ[2137], $fֱꭚ[2498] => 1, $fֱꭚ[2123] => 0, $fֱꭚ[2499] => 0, $fֱꭚ[2122] => $this->getSort()); $bҔ = array_merge($fׄհŇ, $bҔ); $this->filterAuth($bҔ[$fֱꭚ[376]]); goto cڌ; cڌ: return parent::insert($bҔ); goto cފ; Aآӏ: $fֱꭚ =& $_SERVER[]; $aʚ = $bҔ[$fֱꭚ[28]]; if ($this->findByName($aʚ)) { return !1; } goto F֚; cފ: } private function getSort() { $eܩն =& $_SERVER[]; $BŅ = parent::listData(); $DͅӅ = array_to_keyvalue($BŅ, $eܩն[33], $eܩն[2139]); return empty($DͅӅ) ? 0 : max($DͅӅ) + 1; } private function filterAuth(&$f٩) { $AӚ =& $_SERVER[]; $a = array(); $F = array_filter(explode($AӚ[47], $f٩)); foreach ($F as $f٩) { $fӷݩ = explode($AӚ[91], $f٩); if ($fӷݩ[0] == $AӚ[1798] && $fӷݩ[1] != $AӚ[1046]) { $fƹ = $fӷݩ[0] . $AӚ[91] . $fӷݩ[1] . $AӚ[2500]; if (!in_array($fƹ, $F)) { $a[] = $fƹ; } } $a[] = $f٩; } $f٩ = implode($AӚ[47], $a); } public function sort($D؉ѿ, $Bǹ) { return parent::update($D؉ѿ, $Bǹ); } } goto B͓ڡ; Dؤ: if (!function_exists($_SERVER[][1886])) { define($_SERVER[][1887], 0); define($_SERVER[][1888], 1); define($_SERVER[][1889], 2); function imageflip($Cʴ􄹬, $f듅) { switch ($f듅) { case IMG_FLIP_HORIZONTAL: $Dу঺ = imagesx($Cʴ􄹬) - 1; $f = $Dу঺ / 2; $aՐŉ = imagesy($Cʴ􄹬); $C = imageistruecolor($Cʴ􄹬) ? imagecreatetruecolor(1, $aՐŉ) : imagecreate(1, $aՐŉ); for ($C = 0; $C < $f; ++$C) { imagecopy($C, $Cʴ􄹬, 0, 0, $C, 0, 1, $aՐŉ); imagecopy($Cʴ􄹬, $Cʴ􄹬, $C, 0, $Dу঺ - $C, 0, 1, $aՐŉ); imagecopy($Cʴ􄹬, $C, $Dу঺ - $C, 0, 0, 0, 1, $aՐŉ); } break; case IMG_FLIP_VERTICAL: $BΩ = imagesx($Cʴ􄹬); $E֦ͥ = imagesy($Cʴ􄹬) - 1; $b۰ = $E֦ͥ / 2; $C = imageistruecolor($Cʴ􄹬) ? imagecreatetruecolor($BΩ, 1) : imagecreate($BΩ, 1); for ($b = 0; $b < $b۰; ++$b) { imagecopy($C, $Cʴ􄹬, 0, 0, 0, $b, $BΩ, 1); imagecopy($Cʴ􄹬, $Cʴ􄹬, 0, $b, 0, $E֦ͥ - $b, $BΩ, 1); imagecopy($Cʴ􄹬, $C, 0, $E֦ͥ - $b, 0, 0, $BΩ, 1); } break; case IMG_FLIP_BOTH: $BΩ = imagesx($Cʴ􄹬); $aՐŉ = imagesy($Cʴ􄹬); $C = imagerotate($Cʴ􄹬, 180, 0); imagecopy($Cʴ􄹬, $C, 0, 0, 0, 0, $BΩ, $aՐŉ); break; default: return; } imagedestroy($C); } } if (!function_exists($_SERVER[][1890])) { function imagecreatefrombmp($F) { return ImageGdBMP::load($F); } } class Input { public static function getArray($C) { goto c; eё: if (count($d) > 0) { show_json(implode($dǂ[1895], $d), !1); } return $D߯֘ˢ; goto A; c: $dǂ =& $_SERVER[]; global $in; $D߯֘ˢ = array(); goto Aя駪; Aя駪: $d = array(); $Eǅ΍ = LNG($dǂ[1891]); foreach ($C as $Ċ => $e) { goto Eӗ; C: if (isset($e[$dǂ[1894]]) && !self::check($in[$Ċ], $e[$dǂ[1894]], $AҺ)) { if (array_key_exists($dǂ[1893], $e)) { if (!is_null($e[$dǂ[1893]])) { $D߯֘ˢ[$EÆ] = $e[$dǂ[1893]]; } } else { $d[] = $E뇢; } continue; } $D߯֘ˢ[$EÆ] = $in[$Ċ]; goto D; eͲ: if (!array_key_exists($Ċ, $in)) { if (array_key_exists($dǂ[1893], $e)) { if (!is_null($e[$dǂ[1893]])) { $D߯֘ˢ[$EÆ] = $e[$dǂ[1893]]; } } else { if (isset($e[$dǂ[1894]])) { $d[] = $E뇢; } } continue; } if (isset($e[$dǂ[1894]]) && $e[$dǂ[1894]] == $dǂ[282]) { $c蜏 = json_decode($in[$Ċ], !0); if (is_array($c蜏)) { $D߯֘ˢ[$EÆ] = $c蜏; } else { if (array_key_exists($dǂ[1893], $e)) { if (!is_null($e[$dǂ[1893]])) { $D߯֘ˢ[$EÆ] = $e[$dǂ[1893]]; } } else { $d[] = $E뇢; } } continue; } $AҺ = _get($e, $dǂ[1021]); goto C; Eӗ: $E뇢 = _get($e, $dǂ[1257], $Eǅ΍ . $dǂ[892] . $Ċ); $EÆ = $Ċ; if (isset($e[$dǂ[1892]]) && $e[$dǂ[1892]]) { $EÆ = $e[$dǂ[1892]]; } goto eͲ; D: } goto eё; A: } public static function reg($eԷ = "\162\145\161\165\151\x72\145") { static $E = array("\162\145\x71\x75\151\x72\x65" => "\56\53", "\x6e\165\155\x62\x65\162" => "\134\x64\x2b", "\x68\x65\170" => "\x5b\x30\x2d\71\101\55\106\x61\x2d\x66\135\53", "\151\x6e\164" => "\133\x2d\x5c\53\135\x3f\x5c\x64\53", "\142\x6f\x6f\x6c" => "\60\x7c\x31", "\x66\154\x6f\x61\x74" => "\133\x2d\x5c\x2b\x5d\x3f\x5c\x64\x2b\50\x5c\x2e\x5c\144\x2b\x29\x3f", "\145\x6e\147\x6c\x69\163\x68" => "\x5b\x41\x2d\132\141\55\x7a\x20\135\x2b", "\x63\150\x69\x6e\145\163\x65" => "\133\x5c\x78\173\64\x65\60\60\x7d\x2d\x5c\x78\x7b\71\x66\x61\x35\x7d\135\53", "\x68\x61\163\103\x68\x69\156\x65\163\145" => "\x2f\x28\x5b\x5c\170\173\64\145\x30\60\x7d\55\x5c\170\173\x39\146\141\65\175\135\53\x29\57\x75", "\145\155\x61\x69\154" => "\134\167\53\50\x5b\x5c\x2e\134\55\x5d\134\x77\53\x29\x2a\x5c\x40\134\167\53\50\133\134\x2e\x5c\55\x5d\x5c\167\53\x29\x2a\134\56\134\167\x2b", "\160\x68\157\156\145" => "\61\133\x33\55\x39\x5d\x5c\x64\173\x39\175", "\x74\x65\154\x70\x68\157\x6e\145" => "\50\x5c\x28\134\144\x7b\x33\x2c\x34\x7d\x5c\51\x7c\x5c\x64\173\x33\x2c\64\x7d\x2d\174\x5c\x73\51\77\134\144\173\x37\54\x31\64\175", "\165\x72\154" => "\50\150\164\164\x70\174\146\164\x70\174\x68\164\x74\x70\163\x29\72\x5c\57\134\x2f\133\134\x77\134\55\x5f\x5d\53\x28\x5c\56\133\x5c\x77\134\x2d\137\x5d\x2b\51\x2b\x28\x5b\x5c\x77\x5c\x2d\134\56\x2c\x40\77\136\75\45\46\x3a\134\57\176\x5c\53\43\x5d\x2a\133\x5c\167\134\x2d\134\100\x3f\x5e\75\45\46\134\57\176\x5c\53\x23\x5d\51\x3f", "\165\x72\154\106\x75\x6c\154" => "\133\x61\x2d\x7a\101\x2d\x7a\x5d\53\72\134\57\x5c\x2f\133\x5e\134\163\135\52", "\151\x70" => "\50\134\x64\x7b\61\x2c\x33\175\134\56\x29\173\x33\x7d\x28\x5c\144\173\61\54\63\x7d\x29", "\172\151\x70" => "\133\61\55\71\135\x5c\x64\x7b\65\175\x28\77\41\134\144\51", "\x69\144\103\141\x72\144" => "\50\134\x64\x7b\x31\65\x7d\x29\x7c\x28\134\x64\173\61\67\175\50\x5c\144\174\130\x7c\x78\51\51", "\x63\157\x6c\157\x72" => "\x23\50\x5b\x30\x2d\x39\101\x2d\106\x61\55\146\x5d\173\63\175\x7c\x5b\60\x2d\71\101\x2d\106\x61\55\146\x5d\173\66\175\x29", "\164\x69\x6d\145" => "\x28\133\60\55\61\135\x5c\x64\x7c\62\133\x30\x2d\64\x5d\x29\72\x5b\x30\x2d\65\135\134\x64", "\144\141\x74\x65" => "\x5c\144\173\x34\175\x5b\55\x5c\x2f\x5d\77\50\x30\x5b\61\x2d\x39\135\x7c\x31\133\x30\55\x32\135\x29\x5b\55\134\57\x5d\x3f\x28\x5b\60\x2d\62\135\134\x64\174\63\133\60\55\x31\135\x29", "\x64\141\164\x65\x54\x69\x6d\145" => "\134\144\x7b\x34\x7d\x5b\x2d\134\x2f\x5d\x3f\50\x30\x5b\61\55\x39\135\174\61\x5b\60\55\x32\135\x29\x5b\x2d\x5c\57\135\77\x28\133\x30\x2d\62\x5d\134\x64\x7c\x33\x5b\x30\55\61\x5d\x29\134\163\53\50\133\x30\x2d\x31\135\134\x64\x7c\62\x5b\x30\x2d\x34\135\51\x3a\x5b\60\55\65\135\134\144", "\160\141\163\163\x77\157\x72\x64" => "\50\x3f\75\56\x2a\x5c\144\x29\50\77\x3d\x2e\52\x5b\141\55\172\x5d\x29\50\77\75\56\x2a\x5b\101\55\x5a\x5d\x29\x2e\x7b\x38\54\62\60\175", "\153\145\171" => "\133\101\55\x5a\x61\x2d\172\x30\55\x39\137\x5c\55\x5c\56\135\53", "\153\x65\171\x46\x75\x6c\154" => "\133\x41\x2d\132\141\x2d\172\60\55\x39\x5f\134\x2d\134\56\134\x73\x2c\x5d\x2b"); if (!$eԷ) { return $E; } return $E[$eԷ]; } public static function check($c, $d, $Aι = null) { $E̽ =& $_SERVER[]; switch ($d) { case $E̽[7]: return in_array($c, $Aι); break; case $E̽[1896]: return floatval($c) > $Aι; break; case $E̽[1897]: return floatval($c) < $Aι; break; case $E̽[325]: return strlen($c) >= $Aι[0] && strlen($c) <= $Aι[1]; break; case $E̽[325]: if (is_array($Aι)) { return strlen($c) >= $Aι[0] && strlen($c) <= $Aι[1]; break; } else { return strlen($c) == $Aι; break; } case $E̽[321]: return floatval($c) >= $Aι[0] && floatval($c) <= $Aι[1]; break; } $E婂 = self::reg(!1); $d = isset($E婂[$d]) ? $E婂[$d] : $d; if (substr($d, 0, 1) != $E̽[8]) { $d = $E̽[1898] . $d . $E̽[1899]; } return preg_match($d, $c) === 1; } public static function get($Bӆŕ, $E憡إ = null, $Dᘣ = null, $aێޘ = null) { goto D땃; F̜: if (!is_null($aێޘ)) { $Fꋅ[$c[1021]] = $aێޘ; } if (!is_null($E憡إ)) { $Fꋅ[$c[1894]] = $E憡إ; } $A樜 = Input::getArray(array($Bӆŕ => $Fꋅ)); goto c󔽓; c󔽓: return $A樜[$Bӆŕ]; goto BĤ; D땃: $c =& $_SERVER[]; $Fꋅ = array(); if (!is_null($Dᘣ)) { $Fꋅ[$c[34]] = $Dᘣ; } goto F̜; BĤ: } } goto fנ; Bөÿ: define($_SERVER[][1950], 5); define($_SERVER[][1951], 16); define($_SERVER[][1952], 32); goto fȜ; e͙: class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\x66\x69\154\x65"; protected $tableMeta = array("\x74\141\142\x6c\145\116\x61\x6d\x65" => "\x69\x6f\137\x66\x69\154\145\x5f\155\145\x74\x61", "\155\145\x74\141\x46\151\x65\154\144" => "\x66\151\x6c\x65\x49\x44"); public function fileInfo($Fܾܳ) { $eݪ첏 =& $_SERVER[]; static $Aꃧ = array(); if (!isset($Aꃧ[$Fܾܳ])) { $A = $eݪ첏[2160]; $D = Model($eݪ첏[422])->field($A)->where(array($eݪ첏[420] => $Fܾܳ))->find(); $Aꃧ[$Fܾܳ] = $D; } return $Aꃧ[$Fܾܳ]; } public function addFileByContent($cٟ = '', $cᮇ = '') { goto CՆ; Bڌ: if (file_exists($F)) { @unlink($F); } return $A۵ذ; goto cꠎӃ; CՆ: $Cɼ =& $_SERVER[]; $F³ = TEMP_PATH . $Cɼ[2161]; if (!is_dir($F³)) { mk_dir($F³); } goto E߄; E߄: $F = $F³ . $Cɼ[2162] . rand_string(16); file_put_contents($F, $cٟ); $A۵ذ = $this->addFile($F, $cᮇ, !0); goto Bڌ; cꠎӃ: } public function createFileName($EҏƓ) { goto fܵ; Cɂ: $b = $cϪ->pathFather($b); static $EĈ = false; $cڽ = $f[2163] . md5($b); goto f; fܵ: $f =& $_SERVER[]; $cϪ = IO::init($f[8]); $b = $this->makeFilePath($EҏƓ, $cϪ); goto Cɂ; f: if (!$EĈ && !Cache::get($cڽ)) { $EĈ = !0; $eʫ֑ = IO::mkdir($b); if (!IO::exist($eʫ֑ . $f[2164])) { IO::mkfile($eʫ֑ . $f[2164]); } Cache::set($cڽ, 1, 3600 * 2); } return $b; goto C߃; C߃: } public function makeFilePath($E, $Fѧ) { goto fƜ; Eʹ: switch ($f) { case $dؐ[2168]: $Cǈଡ = $Cǈଡ . $dؐ[91] . $Fѧ->ext($E); if ($Fѧ->ext($E) == $dؐ[2108]) { $Cǈଡ .= $dؐ[2169]; } break; case $dؐ[2170]: goto A˲Ŧ; e: break; goto dӏ; A㥔ю: if ($Fѧ->ext($E) == $dؐ[2108]) { $E .= $dؐ[2169]; } $C = IO::fileNameAuto($eݦ, $E); $Cǈଡ = $eݦ . $C; goto e; A˲Ŧ: $a = Model($dؐ[1098])->get($dؐ[1348]); $C׳ = substr(md5($dؐ[1928] . $a . date($dؐ[700])), 0, 8); $eݦ = KodIO::defaultIO() . date($dؐ[2171]) . $C׳ . $dؐ[8]; goto A㥔ю; dӏ: case $dؐ[2167]: break; default: break; } return $Cǈଡ; goto B; fƜ: $dؐ =& $_SERVER[]; $f = Model($dؐ[1098])->get($dؐ[2165]); $eݦ = KodIO::defaultIO() . date($dؐ[2166]); goto B; B: $Cǈଡ = $eݦ . rand_string(5) . short_id(100); $E = str_replace($dؐ[8], $dؐ[70], KodIO::clear($E)); if (!$E) { $f = $dؐ[2167]; } goto Eʹ; B: } public function addFileByRemote($d؛ۡ, $B, $AΚ = array()) { goto Fĉ; Cˏ: $b = IO::hashMd5($d؛ۡ, $a䘆Ҝ); $Aօ = KodIO::defaultDriver(); $DՊ = array($Dä[520] => IO::size($d؛ۡ), $Dä[2172] => 1, $Dä[386] => $B, $Dä[749] => $Aօ[$Dä[367]], $Dä[387] => $d؛ۡ, $Dä[2173] => $AΚ[$Dä[164]] ? $AΚ[$Dä[164]] : IO::hashSimple($d؛ۡ), $Dä[2174] => $b ? $b : $a䘆Ҝ); goto C; C: if ($aތ = $this->addFileCheckExist($DՊ[$Dä[164]], $DՊ[$Dä[163]], $DՊ[$Dä[77]])) { return $aތ; } return $this->addFileData($DՊ); goto B; Fĉ: $Dä =& $_SERVER[]; if (!IO::exist($d؛ۡ)) { return !1; } $a䘆Ҝ = $AΚ[$Dä[163]] ? $AΚ[$Dä[163]] : $Dä[33]; goto Cˏ; B: } private function addFileData($bÅ) { $Aȹ =& $_SERVER[]; if (!$bÅ) { return !1; } $bÅ[$Aȹ[77]] = intval($bÅ[$Aȹ[77]]); if (!$bÅ[$Aȹ[77]] && strlen($bÅ[$Aȹ[164]]) > 32) { $bÅ[$Aȹ[77]] = intval(substr($bÅ[$Aȹ[164]], 32)); } $Fī = $this->add($bÅ); return $this->find($Fī); } public function addFile($f츙, $dĦ, $f©Ϸ = false) { $D = IO::hashSimple($f츙); $f犽 = IO::hashMd5($f츙); $Eͱ = IO::size($f츙); if ($E = $this->addFileCheckExist($D, $f犽, $Eͱ)) { return $E; } $e = $this->addFileMake($f츙, $Eͱ, $D, $f犽, $dĦ, $f©Ϸ); return $this->addFileData($e); } public function addFileMake($EΒͨ, $Cؿʈ, $aۺ, $Fꋃַ, $Eù, $bđ) { goto e澯; b쏟: $E = KodIO::defaultDriver(); $Dռ = array($eӈ[520] => $Cؿʈ, $eӈ[2172] => 1, $eӈ[386] => $Eù, $eӈ[749] => $E[$eӈ[367]], $eӈ[387] => $cȘ, $eӈ[2173] => $aۺ, $eӈ[2174] => $Fꋃַ); return $Dռ; goto dߩ; a: $aɿ = get_path_this($cȘ); if ($bđ) { $fߣ = IO::move($EΒͨ, $D, !1, $aɿ); } else { $fߣ = IO::copy($EΒͨ, $D, !1, $aɿ); } if (!$fߣ) { return !1; } goto b쏟; e澯: $eӈ =& $_SERVER[]; $cȘ = $this->createFileName($Eù); $D = get_path_father($cȘ); goto a; dߩ: } public function addFileCheckExist($D粳񛏥, $BǞ, $E) { $C =& $_SERVER[]; $C = $this->findByHash($D粳񛏥, $BǞ); if (!$C) { return !1; } $bܠ = array($C[2172] => intval($C[$C[2175]]) + 1, $C[520] => $E); $this->where(array($C[420] => $C[$C[419]]))->save($bܠ); return $C; } public function remove($b) { $this->linkCountChange($b, !1); $this->clearEmpty(); return !0; } public function linkAdd($Bǌ) { $this->linkCountChange($Bǌ, !0); } public function linkCountChange($C, $B򦍼) { goto b; dȶʏ: $E훨 = array(); foreach ($C as $bͶٍ) { $Fϟ = $bͶٍ . $eÑ[33]; if (!$E훨[$Fϟ]) { $E훨[$Fϟ] = 0; } $E훨[$Fϟ]++; } $e = array(); goto Fڌ; b: $eÑ =& $_SERVER[]; if (!$C) { return; } if (!is_array($C)) { $C = array($C); } goto dȶʏ; Fڌ: foreach ($E훨 as $bͶٍ => $b) { $Fϟ = $b . $eÑ[33]; if (!$e[$Fϟ]) { $e[$Fϟ] = array(); } $e[$Fϟ][] = $bͶٍ; } foreach ($e as $b => $e׋ݢ) { if (!$e׋ݢ) { continue; } $b = $B򦍼 ? $b : -intval($b); $d = array($eÑ[419] => array($eÑ[7], $e׋ݢ)); if ($b < 0) { $d[$eÑ[2175]] = array($eÑ[941], abs($b)); } $this->where($d)->setAdd($eÑ[2175], $b); } goto aɳ; aɳ: } public function findByHash($bה, $Bپʄ = false) { $eɨ =& $_SERVER[]; if (!$bה && !$Bپʄ) { return !1; } $d꫶ = array($eɨ[2173] => $bה); if ($Bپʄ) { $d꫶ = array($eɨ[2174] => $Bپʄ); } return $this->order($eɨ[2176])->where($d꫶)->find(); } public function clearEmpty($Fď = 0) { goto Eҋ; A۾: $e = $this->where($Eд)->select(); if (!$e) { return; } $eܩƵř = new Task($E[2178], $E[33], count($e)); goto eх; Eҋ: $E =& $_SERVER[]; $bƳƏ = time() - 3600 * 24 * $Fď; $Eд = $E[2177] . $bƳƏ; goto A۾; eх: foreach ($e as $Fҫ) { $eܩƵř->update(1); $this->resetFile($Fҫ); } $eܩƵř->end(); goto FϜ; FϜ: } private function resetFile($BҌ̟) { goto Fļ; C愠: $Cĕ = Model($Aض[2179])->where($e)->count(); $bϳ = intval($fƦ) + intval($Cĕ); if ($bϳ == 0) { IO::remove($BҌ̟[$Aض[75]]); $this->where($e)->delete(); $this->metaSet($BҌ̟[$Aض[419]], null, null); return; } goto fݦ; fݦ: if ($BҌ̟[$Aض[2175]] != $bϳ) { $this->where($e)->save(array($Aض[2172] => $bϳ)); } goto a˪ٵă; Fļ: $Aض =& $_SERVER[]; $e = array($Aض[420] => $BҌ̟[$Aض[419]]); $fƦ = Model($Aض[1127])->where($e)->count(); goto C愠; a˪ٵă: } public function storageInfo($CͿˏ = false) { goto Eƣ; bʴᑕ: for ($a = 0; $a < $d; $a = $a + $a) { $C㰖 = $this->limit($a, $a + $a)->select(); foreach ($C㰖 as $a) { $B += $a[$A񄂘[77]] * $a[$A񄂘[2175]]; $d硼 += $a[$A񄂘[77]] * ($a[$A񄂘[2175]] - 1); $B += $a[$A񄂘[2175]]; } } $D = array($A񄂘[2180] => $B, $A񄂘[2181] => $d硼, $A񄂘[2182] => $d硼 / $B, $A񄂘[81] => $d, $A񄂘[2183] => $B); return $D; goto AĊ; cۄ: $B = 1; $B = 0; $a = 5000; goto bʴᑕ; Eƣ: $A񄂘 =& $_SERVER[]; $d = $this->count() + 0.0; $d硼 = 0; goto cۄ; AĊ: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\165\160"; protected $tableMeta = array("\164\x61\142\x6c\145\x4e\x61\x6d\x65" => "\x67\162\157\x75\x70\137\x6d\145\164\x61", "\x6d\x65\x74\x61\106\x69\145\154\144" => "\x67\162\x6f\x75\160\x49\x44"); protected function cacheFunctionAlias($dگ) { $F߄ =& $_SERVER[]; return array($F߄[2184] => array($dگ[0], $F߄[2185]), $F߄[2186] => array($dگ[0], $F߄[2185])); } protected function getInfo($Aҕ핹) { $D留 = $this->getInfoSimple($Aҕ핹); if (!$D留) { return !1; } return $this->_listDataApplyItem($D留); } protected function getInfoSimple($d, $cв = false) { $C =& $_SERVER[]; if ($cв) { $F۬ = array($C[2118] => intval($d)); $A˩ = $this->where($F۬)->find(); return is_array($A˩) ? $A˩ : array(); } return $this->cacheFunctionGet($C[2187], $d); } protected function groupAdd($Eă) { goto Eŷ; Cퟑï: if (!empty($Eă[$D[2118]])) { $b[$D[2118]] = $Eă[$D[2118]]; } $cڇŸ = $this->add($b); $this->setNamePinyin($cڇŸ, $b[$D[28]]); goto aă; Aƙ֓: if ($bĵ[$D[459]]) { $A = $bĵ[$D[459]] . $bĵ[$D[2118]] . $D[47]; } $b = array($D[386] => $this->groupNameAuto($Eă[$D[461]], $Eă[$D[28]]), $D[368] => $Eă[$D[461]], $D[525] => $A, $D[2188] => $Eă[$D[2102]], $D[2189] => 0, $D[2122] => 0); if (isset($Eă[$D[2139]])) { $b[$D[2139]] = $Eă[$D[2139]]; } else { $d = $this->max($D[2139]); if (!$d) { $d = 0; } $b[$D[2139]] = $d + 1; } goto Cퟑï; aă: Model($D[1127])->groupRootAdd($cڇŸ); return $cڇŸ; goto eȭٕ; Eŷ: $D =& $_SERVER[]; if (!$Eă[$D[461]] && isset($Eă[$D[2118]]) && $Eă[$D[2118]] == 1) { if ($bĵ = $this->getInfoSimple($Eă[$D[2118]], !0)) { return $Eă[$D[2118]]; } } else { $bĵ = $this->getInfoSimple($Eă[$D[461]]); if (!$bĵ) { return !1; } } $A = $D[470]; goto Aƙ֓; eȭٕ: } protected function groupEdit($f, $F) { $d =& $_SERVER[]; if (!empty($F[$d[461]])) { $B = $this->getInfoSimple($f); $c = $this->getInfoSimple($F[$d[461]]); if (!$B || !$c) { return !1; } if ($B[$d[2118]] == $c[$d[2118]]) { return !1; } if ($F[$d[461]] != $B[$d[461]]) { if ($c[$d[459]] !== $B[$d[459]] && strpos($c[$d[459]], $B[$d[459]] . $B[$d[2118]] . $d[47]) === 0) { return !1; } $F[$d[525]] = $c[$d[459]] . $F[$d[461]] . $d[47]; $this->_changeChildLevel($B, $c); } } if (isset($F[$d[28]])) { $this->setNamePinyin($f, $F[$d[28]]); } return $this->where(array($d[2190] => $f))->save($F); } private function _changeChildLevel($D, $C, $cԱ = false) { goto FӅ; FӅ: $a˞ =& $_SERVER[]; $bߵ = $D[$a˞[459]] . $D[$a˞[2118]] . $a˞[47]; $B۵ = $C[$a˞[459]] . $C[$a˞[2118]] . $a˞[47] . $D[$a˞[2118]] . $a˞[47]; goto eŝ; Bԇ: $this->where($fΈ)->data($bҒ)->save(); goto a͋; eŝ: if ($cԱ) { $B۵ = $C[$a˞[459]] . $C[$a˞[2118]] . $a˞[47]; } $fΈ = array($a˞[525] => array($a˞[483], $D[$a˞[459]] . $D[$a˞[2118]] . $a˞[484])); $bҒ = array($a˞[525] => array($a˞[534], "\x72\x65\160\154\141\x63\145\50\160\x61\162\145\x6e\x74\114\145\166\145\x6c\x2c\x27{$bߵ}\47\54\47{$B۵}\x27\x29")); goto Bԇ; a͋: } public function setNamePinyin($aߢƄ, $f늒 = false) { $f̭ =& $_SERVER[]; if (!$f늒) { $e = $this->getInfoSimple($aߢƄ); $f늒 = $e[$f̭[28]]; } if (!Input::check($f늒, $f̭[528])) { $this->metaSet($aߢƄ, $f̭[416], null); $this->metaSet($aߢƄ, $f̭[415], null); return; } $Eڛ = array($f̭[416] => str_replace($f̭[50], $f̭[33], Pinyin::encode($f늒)), $f̭[415] => Pinyin::encode($f늒, $f̭[529])); $this->metaSet($aߢƄ, $Eڛ); } protected function groupStatus($B񧜸ݵ, $C) { goto Eҋ; Eҋ: $dչ =& $_SERVER[]; $F㇤ = $this->getInfoSimple($B񧜸ݵ); if (!$F㇤) { return !1; } goto c; D괕: foreach ($e as $B񧜸ݵ) { $c̽[] = array($dչ[2118] => $B񧜸ݵ, $dչ[89] => $dչ[702], $dչ[359] => $C); } return Model($dչ[2191])->addAll($c̽, array(), !0); goto eѐ; c: if ($C == $dչ[83]) { $e = $this->parentLevelArray($F㇤[$dչ[459]]); } else { $aҏǮ = array($dչ[525] => array($dչ[483], $F㇤[$dչ[459]] . $F㇤[$dչ[2118]] . $dչ[484])); $e = $this->where($aҏǮ)->field($dչ[2118])->select(); $e = array_to_keyvalue($e, $dչ[33], $dչ[2118]); } $e[] = $F㇤[$dչ[2118]]; $c̽ = array(); goto D괕; eѐ: } private function _groupStatusApply($dڸ, $C۱򧞊) { $BÜ =& $_SERVER[]; if ($C۱򧞊 == $BÜ[83]) { $Dꇊ = $this->parentLevelArray($dڸ[$BÜ[459]]); } else { $aĴ = array($BÜ[525] => array($BÜ[483], $dڸ[$BÜ[459]] . $dڸ[$BÜ[2118]] . $BÜ[484])); $Dꇊ = $this->where($aĴ)->field($BÜ[2118])->select(); $Dꇊ = array_to_keyvalue($Dꇊ, $BÜ[33], $BÜ[2118]); } if (empty($Dꇊ)) { return; } $e = array(); foreach ($Dꇊ as $Eީ) { $e[] = array($BÜ[2118] => $Eީ, $BÜ[89] => $BÜ[702], $BÜ[359] => $C۱򧞊); } Model($BÜ[2191])->addAll($e, array(), !0); } protected function groupRemove($b) { goto EɆ; EɆ: $aЮ⃞ =& $_SERVER[]; $F = array($aЮ⃞[2118] => $b); $BǴ = $this->where($F)->find(); goto a; C: $this->where(array($aЮ⃞[461] => $b))->save(array($aЮ⃞[461] => $BǴ[$aЮ⃞[461]])); Model($aЮ⃞[2191])->where($F)->delete(); Model($aЮ⃞[2192])->where($F)->delete(); goto B; B: Model($aЮ⃞[766])->groupRootRemove($b); return $this->where($F)->delete(); goto Cà; a: if (!$BǴ || $BǴ[$aЮ⃞[461]] == 0) { return !1; } $eޗ߳ = $this->getInfoSimple($BǴ[$aЮ⃞[461]]); $this->_changeChildLevel($BǴ, $eޗ߳, !0); goto C; Cà: } public function listData() { $Cɲ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Cɲ[$_SERVER[][354]]); return $Cɲ; } private function _makeOrder($Cީԅ = '') { goto b; b: $Dɧ =& $_SERVER[]; $BŚ = array($Dɧ[2118], $Dɧ[28], $Dɧ[2104], $Dɧ[187]); $c淫 = array($Dɧ[402] => $Dɧ[403], $Dɧ[404] => $Dɧ[405]); goto DǤ; DǤ: $DƏ = Input::get($Dɧ[407], $Dɧ[7], $Dɧ[2122], $BŚ); $C˪ = Input::get($Dɧ[408], $Dɧ[7], $Dɧ[2193], array($Dɧ[2193], $Dɧ[404])); $C˪ = $c淫[$C˪]; goto CΊ; CΊ: $Cީԅ = $Cީԅ . "{$DƏ}\40{$C˪}\54\x20\147\162\157\x75\160\x49\x44\x20\141\163\143"; return $this->order($Cީԅ); goto a; a: } public function listChild($E֨ߎ) { $cц =& $_SERVER[]; $b꫌ = $this->where(array($cц[461] => $E֨ߎ))->_makeOrder()->selectPage(200); $this->_listDataApply($b꫌[$cц[354]]); return $b꫌; } public function listByID($Bť) { $Eȉ =& $_SERVER[]; if (!$Bť) { return array(); } $DǱ㹻 = array($Eȉ[2118] => array($Eȉ[7], $Bť)); $AֲÖ = $this->where($DǱ㹻)->select(); $this->_listDataApply($AֲÖ); return $AֲÖ; } public function listSearch($eҟ) { goto e̔; e̔: $aܵ =& $_SERVER[]; $bᶝ = $eҟ[$aܵ[2194]]; $fއܡ = isset($eҟ[$aܵ[2195]]) ? $eҟ[$aܵ[2195]] : !1; goto a; aʐ: $Eݞ = $this->_makeOrder()->where($BǓ)->selectPage(20); $Eݞ = $Eݞ ? $Eݞ : array(); if (!$Eݞ || count($Eݞ[$aܵ[354]]) < 5 && Input::check($bᶝ, $aܵ[306])) { $A딈 = $this->_searchFromMeta($aܵ[415], $bᶝ, 10); $F = $this->_searchFromMeta($aܵ[416], $bᶝ, 10); $e떂 = array_merge($A딈, $F, $Eݞ[$aܵ[354]]); $Eݞ[$aܵ[354]] = array_unique_by_key($e떂, $aܵ[2118]); $Eݞ[$aܵ[351]][$aܵ[352]] = count($Eݞ[$aܵ[354]]); $Eݞ[$aܵ[351]][$aܵ[353]] = ceil($Eݞ[$aܵ[351]][$aܵ[352]] / $Eݞ[$aܵ[351]][$aܵ[349]]); } goto fƲ; a: if (!trim($bᶝ)) { return !1; } $bᶝ = str_replace($aܵ[2196], $aܵ[2197], $bᶝ); $BǓ = array($aܵ[2118] => array($aܵ[765], "\x25{$bᶝ}\45"), $aܵ[28] => array($aܵ[765], "\x25{$bᶝ}\x25"), $aܵ[926] => $aܵ[2198]); goto aʐ; fƲ: $this->_listDataApply($Eݞ[$aܵ[354]]); return $Eݞ; goto Eě; Eě: } private function _searchFromMeta($c, $f, $C) { goto Dե; Dե: $D =& $_SERVER[]; $f = strtolower($f); $BЯٜ = array($D[89] => $c, $D[359] => array($D[765], "\45{$f}\x25")); goto aꃅϺ; aꃅϺ: $eڴ = Model($D[2199])->where($BЯٜ)->limit($C)->select(); if (!$eڴ) { return array(); } $eڴ = array_to_keyvalue($eڴ, $D[33], $D[2118]); goto Eڜ; Eڜ: $b = $this->where(array($D[2190] => array($D[7], $eڴ)))->select(); if (!$b) { return array(); } return $b; goto Cѱ; Cѱ: } protected function _listDataApplyItem($bҊϯ) { $eυ = array($bҊϯ); $this->_listDataApply($eυ); return $eυ[0]; } protected function _listDataApply(&$A׷) { goto Aӥ̗; f: $this->_listAppendChildren($A׷); $this->_listAppendChildrenMember($A׷); $this->_listAppendMeta($A׷, $E񪗶); goto C; Aӥ̗: $A =& $_SERVER[]; if (!$A׷) { return; } $E񪗶 = array_to_keyvalue($A׷, $A[33], $A[2118]); goto f; C: $this->_listAppendParent($A׷); $this->_listAppendSourceRoot($A׷, $E񪗶); goto bݝ; bݝ: } private function _listAppendChildren(&$C) { goto a; eć: $Dƽ = count($C); $D膭ٞ = $this->tablePrefix . $this->tableName; for ($F = 0, $e = 0; $F < $Dƽ; $F++) { $e++; $Eٰ = $C[$F][$eĚ[2118]]; $cً .= "\x53\105\x4c\x45\x43\124\40\x2a\40\x46\x52\117\115\x20\50\123\105\114\x45\x43\124\40\47{$Eٰ}\137\143\x68\151\154\x64\x27\40\141\163\40\x68\x61\163\40\106\x52\x4f\x4d\x20\x60{$D膭ٞ}\140\40\167\x68\x65\162\x65\x20\160\x61\x72\x65\x6e\164\x49\x44\x3d{$Eٰ}\40\154\151\155\x69\x74\x20\61\x29\x20\141\x73\x20\164\142\x5f{$Eٰ}\x20\165\x6e\x69\157\156\x20\141\154\x6c\x20"; if (($e >= 20 || $F == $Dƽ - 1) && $cً) { $cً = substr($cً, 0, -strlen($eĚ[449])); $Dɑѩ = $this->query($cً); $E״Î = array_merge($E״Î, $Dɑѩ); $e = 0; $cً = $eĚ[33]; } } goto b; b: $E״Î = array_to_keyvalue($E״Î, $eĚ[450]); foreach ($C as &$D) { $D[$eĚ[2200]] = isset($E״Î[$D[$eĚ[2118]] . $eĚ[2201]]); } goto Fɼ; a: $eĚ =& $_SERVER[]; $cً = $eĚ[361]; $E״Î = array(); goto eć; Fɼ: } private function _listAppendChildrenMember(&$bڋ) { goto Dؤ; dא: $Dչ = count($bڋ); $aʏ = $this->tablePrefix . $fړ[2192]; for ($c = 0, $aΓ = 0; $c < $Dչ; $c++) { $aΓ++; $d鄋 = $bڋ[$c][$fړ[2118]]; $b .= "\123\105\114\105\103\x54\40\x2a\40\x46\122\117\115\x20\50\x53\105\x4c\x45\103\x54\40\47{$d鄋}\137\143\150\151\154\x64\47\40\141\163\x20\150\141\x73\40\x46\122\117\x4d\40\140{$aʏ}\x60\40\x77\x68\x65\162\x65\40\x67\162\157\x75\160\111\x44\75{$d鄋}\40\154\151\155\x69\164\x20\61\51\x20\141\x73\40\x74\142\x5f{$d鄋}\x20\165\x6e\151\x6f\x6e\40\x61\x6c\154\x20"; if (($aΓ >= 20 || $c == $Dչ - 1) && $b) { $b = substr($b, 0, -strlen($fړ[449])); $eꂩ = $this->query($b); $C۸¡ = array_merge($C۸¡, $eꂩ); $aΓ = 0; $b = $fړ[33]; } } goto Bߌ; Bߌ: $C۸¡ = array_to_keyvalue($C۸¡, $fړ[450]); foreach ($bڋ as &$D߹) { $D߹[$fړ[2202]] = isset($C۸¡[$D߹[$fړ[2118]] . $fړ[2201]]); } goto E; Dؤ: $fړ =& $_SERVER[]; $b = $fړ[361]; $C۸¡ = array(); goto dא; E: } private function _listAppendMeta(&$c䍌, $a) { $D =& $_SERVER[]; $E = array($D[2118] => array($D[7], $a)); $D = Model($D[2191])->where($E)->select(); $D = array_to_keyvalue_group($D, $D[2118]); foreach ($D as &$f) { $f = array_to_keyvalue($f, $D[89], $D[359]); } foreach ($c䍌 as &$bķ) { $bķ[$D[417]] = array(); if (isset($D[$bķ[$D[2118]]])) { $bķ[$D[417]] = $D[$bķ[$D[2118]]]; } } } protected function parentLevelArray($fޗ楑) { $Bɰ㎖ =& $_SERVER[]; $fޗ楑 = explode($Bɰ㎖[47], trim($fޗ楑, $Bɰ㎖[47])); $fޗ楑 = array_remove_value($fޗ楑, $Bɰ㎖[468]); return $fޗ楑; } private function _listAppendParent(&$F鹎ʟ) { goto F补䎶; f: $bί = array(); foreach ($FЯ as $Fն => $e) { if (!$e) { $bί[] = $Fն; } } if ($bί) { $Aψ = array($Eţ[2190] => array($Eţ[384], $bί)); $aߕ = $this->field($Eţ[2203])->where($Aψ)->select(); $fܶՌ = array_to_keyvalue($aߕ, $Eţ[2118], $Eţ[28]); $FЯ = array_merge_index($FЯ, $fܶՌ); } goto cߓ; F补䎶: $Eţ =& $_SERVER[]; $FЯ = array(); foreach ($F鹎ʟ as &$c؏م) { $FЯ[$c؏م[$Eţ[2118]]] = $c؏م[$Eţ[28]]; $CѺ = $this->parentLevelArray($c؏م[$Eţ[459]]); foreach ($CѺ as $EІ) { if (!isset($FЯ[$EІ])) { $FЯ[$EІ] = 0; } } } goto f; cߓ: foreach ($F鹎ʟ as &$c؏م) { $CѺ = $this->parentLevelArray($c؏م[$Eţ[459]]); $Ĕʹ = $Eţ[33]; foreach ($CѺ as $EІ) { $Ĕʹ .= $FЯ[$EІ] . $Eţ[8]; } if ($CѺ) { $Ĕʹ .= $c؏م[$Eţ[28]]; } $c؏م[$Eţ[463]] = str_replace($Eţ[467], $Eţ[8], $Ĕʹ); } goto eك; eك: } private function _listAppendSourceRoot(&$e, $A) { goto b; b: $Aϑ =& $_SERVER[]; $F = array($Aϑ[371] => SourceModel::TYPE_GROUP, $Aϑ[461] => 0, $Aϑ[456] => array($Aϑ[7], $A)); $A = $Aϑ[2204]; goto f흛; A: foreach ($e as &$D) { $D[$Aϑ[391]] = $f[$D[$Aϑ[2118]]] ? $f[$D[$Aϑ[2118]]] : array(); } goto e蕇; f흛: $f = Model($Aϑ[766])->order($Aϑ[2205])->field($A)->where($F)->select(); $f = array_to_keyvalue($f, $Aϑ[456]); $f = array_remove_key($f, $Aϑ[456]); goto A; e蕇: } protected function resetParentLevel() { $EԌڇ =& $_SERVER[]; $c驍 = $EԌڇ[2118]; $cф = $this->select(); $cф = array_to_keyvalue($cф, $c驍); foreach ($cф as $Fὖ) { goto b׳; b׳: $C = $Fὖ; $dΩʊ = array(); while ($C[$EԌڇ[461]] != 0) { $dΩʊ[] = $C[$EԌڇ[461]]; $C = $cф[$C[$EԌڇ[461]]]; } goto dԚ; eʉ: $this->where(array($c驍 => $Fὖ[$c驍]))->save(array($EԌڇ[525] => $dΩʊ)); goto C垥ı; dԚ: $dΩʊ[] = 0; $dΩʊ = $EԌڇ[47] . implode($EԌڇ[47], array_reverse($dΩʊ)) . $EԌڇ[47]; $this->setNamePinyin($Fὖ[$c驍], $Fὖ[$EԌڇ[28]]); goto eʉ; C垥ı: } return $cф; } public function groupNameAuto($e, $Cҭ) { $A =& $_SERVER[]; $F = $this->where(array($A[368] => $e))->getField($A[28], !0); if (!$F || !in_array($Cҭ, $F)) { return $Cҭ; } for ($Dٜɩ = 1; $Dٜɩ <= count($F) + 1; $Dٜɩ++) { $D = $Cҭ . "\x28{$Dٜɩ}\x29"; if (!in_array($D, $F)) { return $D; } } } } class PluginModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\155\x2e\x70\154\x75\x67\151\x6e\114\151\x73\164"; public $field = array("\156\x61\155\145", "\163\x74\141\x74\x75\x73", "\x72\145\147\151\x65\x73\x74", "\143\x6f\156\x66\151\147"); public function loadList($cٽɋ = false) { $C = array_to_keyvalue($this->listData(), $_SERVER[][28]); if ($cٽɋ) { return $C[$cٽɋ]; } return $C; } public function init() { $eН =& $_SERVER[]; Hook::trigger($eН[2206]); $dϽ = $this->loadPluginList(); foreach ($dϽ as $b܊ => $c) { $F↸ř = $this->appAllow($b܊, $c); if (!$F↸ř) { continue; } foreach ($c[$eН[2207]] as $e޼ => $E볟) { Hook::bind($e޼, $E볟); } } Hook::trigger($eН[2208]); Hook::trigger(ACTION); } public function appAllow($cӂ, $AΞ١, $F = true) { $A條œ =& $_SERVER[]; $c = PLUGIN_DIR . $cӂ . $A條œ[2209]; if (!is_array($AΞ١) || !is_array($AΞ١[$A條œ[2207]]) || !is_file($c) || $AΞ١[$A條œ[702]] != 1) { return !1; } if ($F && !Action($A條œ[2210])->checkAuth($cӂ)) { return !1; } return !0; } public function unInstall($A׿) { $eּ̮ =& $_SERVER[]; $E֪ = $this->loadList($A׿); if (file_exists(PLUGIN_DIR . $A׿)) { Hook::apply($A׿ . $eּ̮[2211]); } $this->remove($E֪[$eּ̮[367]]); } public function changeStatus($A؏, $E) { $Fא =& $_SERVER[]; $AԎ = $this->loadList($A؏); if ($E) { Hook::apply($A؏ . $Fא[2212]); } $this->update($AԎ[$Fא[367]], array($Fא[2213] => $E)); } public function appRegist($a焑҇, $C܇) { $Dи鍨 =& $_SERVER[]; $E = $this->loadList($a焑҇); if ($E) { $this->update($E[$Dи鍨[367]], array($Dи鍨[2207] => $C܇)); } else { $Fĥ = array($Dи鍨[28] => $a焑҇, $Dи鍨[2207] => $C܇, $Dи鍨[702] => 0, $Dи鍨[6] => $this->getConfigDefault($a焑҇)); $this->insert($Fĥ); } } public function getConfigDefault($aЄ䠔) { $B =& $_SERVER[]; $d = array(); $Eෝ = $this->getPackageJson($aЄ䠔); if (!$Eෝ && is_array($Eෝ[$B[2214]])) { return $d; } foreach ($Eෝ[$B[2214]] as $Dߊ߮ => $E) { if (!isset($E[$B[359]]) || isset($d[$Dߊ߮])) { continue; } $d[$Dߊ߮] = $E[$B[359]]; } return $d; } public function getPackageJson($dȵ) { return Hook::apply($dȵ . $_SERVER[][2215]); } public function getConfig($A, $F = false) { $bő =& $_SERVER[]; $D֩ݙ = array(); $b屮 = $this->loadList($A); if ($b屮 && is_array($b屮[$bő[6]])) { $D֩ݙ = $b屮[$bő[6]]; } if (!$D֩ݙ || $F) { $D֩ݙ = $this->getConfigDefault($A); } return $D֩ݙ; } public function setConfig($EХ, $Bڡȫ¨ = false) { goto aڥ; A諂: $this->update($Eɼ[$e܄̝[367]], array($e܄̝[6] => $Bڥ)); goto a; cڽ: $Bڥ = $Eɼ[$e܄̝[6]]; if ($Bڡȫ¨ == !1) { $Bڥ = array(); $Bڡȫ¨ = $this->getConfigDefault($EХ); } foreach ($Bڡȫ¨ as $Aׂ䑈 => $C墚) { $Bڥ[$Aׂ䑈] = is_string($C墚) ? trim($C墚) : $C墚; } goto A諂; aڥ: $e܄̝ =& $_SERVER[]; $Eɼ = $this->loadList($EХ); if (!$Eɼ) { return !1; } goto cڽ; a: } public function viewList() { goto Dٮ; Dٮ: $fϣ =& $_SERVER[]; $cҖ = $this->loadList(); $this->pluginScan($cҖ); goto C县; Bъҋ: return $bޮ; goto C̔; C县: $cҖ = $this->loadPluginList(); $bޮ = array(); foreach ($cҖ as $Dܺ => $dϋ) { unset($dϋ[$fϣ[2207]], $dϋ[$fϣ[6]]); $e = PLUGIN_DIR . $dϋ[$fϣ[28]] . $fϣ[2209]; if (!is_file($e)) { continue; } $fʧӜ = Hook::apply($dϋ[$fϣ[28]] . $fϣ[2215]); if (is_array($fʧӜ)) { $bޮ[$Dܺ] = array_merge($dϋ, $fʧӜ); } } goto Bъҋ; C̔: } private function loadPluginList() { $A =& $_SERVER[]; $f֓؉ = $this->loadList(); if (strtolower(MOD) == $A[2216]) { return $f֓؉; } $a榰 = Hook::trigger($A[2217], $f֓؉); if ($f֓؉ && !$a榰) { die; } return $a榰 ? $a榰 : $f֓؉; } private function pluginScan($c) { $f =& $_SERVER[]; recursion_dir(PLUGIN_DIR, $f, $C, 0); foreach ($f as $bҘټ) { $D = get_path_this($bҘټ); if (isset($c[$D]) || !file_exists($bҘټ . $f[2218]) || !file_exists($bҘټ . $f[2209])) { continue; } Hook::apply($D . $f[2212]); } } } goto c譛; Cۤȑ: class ZipMake { const VERSION = "\60\x2e\x32\x2e\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($eħ = null) { $B =& $_SERVER[]; $this->outputStream = fopen($B[2023], $B[1237]); $this->outputName = $eħ; $this->needHeaders = !0; } public function addFile($D仒, $b) { goto b뭂; FçĢҩ: $this->addFileFooter($D仒, $b̷ܟ, $F, $ażը, $Cދ, $Cֵ); goto Dό; b뭂: $C =& $_SERVER[]; $D仒 = $this->filterFilename($D仒); $b̷ܟ = static::METHOD_STORE; goto a峭; a峭: $Cֵ = $this->addFileHeader($D仒, $b̷ܟ); $ażը = $Cދ = filesize($b); $b䋄 = fopen($b, $C[2024]); goto DϨ; DϨ: while (!feof($b䋄)) { $eǱĩ = fread($b䋄, 1048576); $this->send($eǱĩ); } fclose($b䋄); $F = hexdec(hash_file($C[2025], $b)); goto FçĢҩ; Dό: } public function addFileFromStream($cצ鑧, $cܨ) { goto C; C: $cצ鑧 = $this->filterFilename($cצ鑧); $Fؿ = static::METHOD_STORE; $C孬˧ = $this->addFileHeader($cצ鑧, $Fؿ); goto Fڃ; A: $this->addFileFooter($cצ鑧, $Fؿ, $A֔, $B, $C﫣, $C孬˧); goto A뛟߉; a: $A֠ = hash_init($_SERVER[][2025]); while (!feof($cܨ)) { $fۡЌ = fread($cܨ, 1048576); hash_update($A֠, $fۡЌ); $this->send($fۡЌ); } $A֔ = hexdec(hash_final($A֠)); goto A; Fڃ: fseek($cܨ, 0, SEEK_END); $B = $C﫣 = ftell($cܨ); rewind($cܨ); goto a; A뛟߉: } public function finish() { foreach ($this->files as $f) { $this->addCdrFile($f); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($eЇ, $E«ί) { goto B鋑; B鋑: $D =& $_SERVER[]; $eЇ = preg_replace($D[2026], $D[33], $eЇ); $Eךǹ = strlen($eЇ); goto fۿ; Bߡ۵: return strlen($bۋ) + $Eךǹ + strlen($C㱾׍); goto Că; e䉌: $bۋ = $this->packFields($e蔺); $C㱾׍ = $this->packFields($Aއ); $this->send($bۋ . $eЇ . $C㱾׍); goto Bߡ۵; fۿ: $b䆃 = $this->dosTime(time()); $e蔺 = array(array($D[2027], static::FILE_HEADER_SIGNATURE), array($D[2028], static::ZIP_VERSION_64), array($D[2028], 8), array($D[2028], $E«ί), array($D[2027], $b䆃), array($D[2027], 0), array($D[2027], 4294967295), array($D[2027], 4294967295), array($D[2028], $Eךǹ), array($D[2028], 32)); $Aއ = array(array($D[2028], 1), array($D[2028], 28), array($D[2029], 0), array($D[2029], 0), array($D[2029], 0), array($D[2027], 0)); goto e䉌; Că: } protected function addFileFooter($c̬, $cե, $aϤ, $DԢ, $f, $eʰ) { $f =& $_SERVER[]; $FΩ = array(array($f[2027], static::DATA_DESCRIPTOR_SIGNATURE), array($f[2027], $aϤ), array($f[2029], $DԢ), array($f[2029], $f)); $fЖ = $this->packFields($FΩ); $this->send($fЖ); $bߠ = $eʰ + $DԢ + $F; $this->addToCdr($c̬, $cե, $aϤ, $DԢ, $f, $bߠ); } private function addToCdr($bȑ, $cֹũ, $e, $AŬ, $b߱ś, $Cѹ) { $this->files[] = array($bȑ, $cֹũ, $e, $AŬ, $b߱ś, $this->ofs); $this->ofs += $Cѹ; } protected function addCdrFile($E݄) { goto eݬ; eݬ: $FӃ =& $_SERVER[]; list($E̪ᘫ, $e, $f, $AҴ, $Fԭ, $A𳙎) = $E݄; $FѦ = $FӃ[33]; goto bљ; d: $this->send($cż); $this->cdr_ofs += strlen($cż); goto f; a: $a = $this->packFields($e); $Eᩅ = $this->packFields($B); $cż = $a . $E̪ᘫ . $FѦ . $Eᩅ; goto d; bљ: $Cø = $this->dosTime(time()); $e = array(array($FӃ[2027], static::CDR_FILE_SIGNATURE), array($FӃ[2028], static::ZIP_VERSION_64), array($FӃ[2028], static::ZIP_VERSION_64), array($FӃ[2028], 8), array($FӃ[2028], $e), array($FӃ[2027], $Cø), array($FӃ[2027], $f), array($FӃ[2027], 4294967295), array($FӃ[2027], 4294967295), array($FӃ[2028], strlen($E̪ᘫ)), array($FӃ[2028], 32), array($FӃ[2028], strlen($FѦ)), array($FӃ[2028], 0), array($FӃ[2028], 0), array($FӃ[2027], 32), array($FӃ[2027], 4294967295)); $B = array(array($FӃ[2028], 1), array($FӃ[2028], 28), array($FӃ[2029], $Fԭ), array($FӃ[2029], $AҴ), array($FӃ[2029], $A𳙎), array($FӃ[2027], 0)); goto a; f: } protected function addCdr64Eof() { goto D֊ղ; D: $this->send($e); goto D˝˘; D֊ղ: $fè =& $_SERVER[]; $a = count($this->files); $E = $this->cdr_ofs; goto Cڨ; Cڨ: $a̒ = $this->ofs; $D≠ = array(array($fè[2027], static::ZIP64_CDR_EOF_SIGNATURE), array($fè[2029], 44), array($fè[2028], static::ZIP_VERSION_64), array($fè[2028], static::ZIP_VERSION_64), array($fè[2027], 0), array($fè[2027], 0), array($fè[2029], $a), array($fè[2029], $a), array($fè[2029], $E), array($fè[2029], $a̒)); $e = $this->packFields($D≠); goto D; D˝˘: } protected function addCdr64Locator() { goto d͊ć; d͊ć: $f睏 =& $_SERVER[]; $A剂Ф = count($this->files); $C = $this->cdr_ofs; goto F; F: $E = $this->ofs; $fޅ = array(array($f睏[2027], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($f睏[2027], 0), array($f睏[2029], $E + $C), array($f睏[2027], 1)); $D׶ = $this->packFields($fޅ); goto c; c: $this->send($D׶); goto D; D: } protected function addCdrEof() { goto f; Aԍ: $F = $this->packFields($f) . $Aˆ߷; $this->send($F); goto aݺ; f: $a鍗 =& $_SERVER[]; $f = count($this->files); $cɰ̴ = $this->cdr_ofs; goto d; d: $E֍ = $this->ofs; $Aˆ߷ = $a鍗[33]; $f = array(array($a鍗[2027], static::CDR_EOF_SIGNATURE), array($a鍗[2028], 0), array($a鍗[2028], 0), array($a鍗[2028], $f), array($a鍗[2028], $f), array($a鍗[2027], 4294967295), array($a鍗[2027], 4294967295), array($a鍗[2028], strlen($Aˆ߷))); goto Aԍ; aݺ: } protected function addCdr() { foreach ($this->files as $F) { $this->addCdrFile($F); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $fË =& $_SERVER[]; $a̡ = $fË[202]; if ($this->outputName) { $Dɳʾ = trim(str_replace(array($fË[113], $fË[55], $fË[93], $fË[67], $fË[217], $fË[1002]), $fË[33], $this->outputName)); $c깎χ = rawurlencode($Dɳʾ); $a̡ .= "\x3b\40\146\151\154\x65\156\141\x6d\145\52\75\165\164\x66\x2d\x38\x27\x27{$c깎χ}"; } $cܝ = array($fË[199] => $fË[2030], $fË[2031] => $a̡, $fË[2032] => $fË[2033], $fË[2034] => $fË[2035], $fË[2036] => $fË[2037]); foreach ($cܝ as $f҉ʑ => $d) { header($f҉ʑ . $fË[892] . $d); } } protected function send($Bϓ) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $Bϓ); } protected final function dosTime($e) { $E͟ =& $_SERVER[]; $c = getdate($e); if ($c[$E͟[1740]] < 1980) { $c = array($E͟[1740] => 1980, $E͟[2038] => 1, $E͟[2039] => 1, $E͟[2040] => 0, $E͟[2041] => 0, $E͟[2042] => 0); } $c[$E͟[1740]] -= 1980; return $c[$E͟[1740]] << 25 | $c[$E͟[2038]] << 21 | $c[$E͟[2039]] << 16 | $c[$E͟[2040]] << 11 | $c[$E͟[2041]] << 5 | $c[$E͟[2042]] >> 1; } protected function packFields($Bޡ) { $a =& $_SERVER[]; $f鼵 = $a[33]; $BԳ = array(); foreach ($Bޡ as $b١) { $f鼵 .= $b١[0]; $BԳ[] = $b١[1]; } array_unshift($BԳ, $f鼵); return call_user_func_array($a[2043], $BԳ); } protected function filterFilename($D˔뢂) { $DȤ޻ =& $_SERVER[]; return str_replace(array($DȤ޻[93], $DȤ޻[4], $DȤ޻[176], $DȤ޻[69], $DȤ޻[113], $DȤ޻[937], $DȤ޻[940], $DȤ޻[271]), $DȤ޻[70], $D˔뢂); } } class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($c) { $eݦ =& $_SERVER[]; $aѤ = array($eݦ[535] => array($eݦ[29] => $eݦ[2044], $eݦ[261] => array($eݦ[210], $eݦ[713], $eݦ[2045], $eݦ[2046])), $eݦ[2047] => array($eݦ[29] => $eݦ[2048], $eݦ[261] => array($eݦ[210], $eݦ[711], $eݦ[2049], $eݦ[2050], $eݦ[2051]))); if (!isset($aѤ[$c])) { return !1; } $this->optionType = $aѤ[$c][$eݦ[29]]; $this->field = $aѤ[$c][$eݦ[261]]; return !0; } public function listData($c = false, $BɆ = "\x6d\157\144\x69\146\171\x54\151\x6d\x65", $b㉩֜ = false) { return parent::listData($c, $BɆ, $b㉩֜); } public function trendList($B뎹ɖ) { goto b׉; b׉: $eث =& $_SERVER[]; $a = $this->listData(); if ($a) { $fϩ׋ = end($a); $d = date($eث[2052], strtotime($eث[2053])); if ($fϩ׋[$eث[210]] == $d) { return $a; } $a = strtotime($fϩ׋[$eث[210]]); } goto d͏; d͏: if (!isset($a)) { $f = $B뎹ɖ == $eث[535] ? $eث[477] : $eث[766]; $a = Model($f)->min($eث[187]); } $d = $eث[2054] . ucfirst($B뎹ɖ); $f݊ = $this->dateList($a); goto Eï; Eï: foreach ($f݊ as $d) { $this->{$d}($d); } return $this->listData(); goto b찬; b찬: } private function dateList($Fݓ) { $A󎇤 =& $_SERVER[]; $fǑ = $Fݓ; $b = strtotime($A󎇤[2053]); $Dߩ = array(); while ($fǑ <= $b) { $Dߩ[] = date($A󎇤[2052], $fǑ); $fǑ = strtotime($A󎇤[2055], $fǑ); } return $Dߩ; } public function _recordUser($B񊝚Ƚ = '') { goto Dݸ; Dݸ: $A =& $_SERVER[]; $Cӗ = strtotime(date($A[2056], strtotime($B񊝚Ƚ))); $Cو = strtotime(date($A[2057], strtotime($B񊝚Ƚ))); goto C; Bü: $eθҘ = Model($A[477])->where($Fɍ)->count($A[1451]); $Fɍ[$A[29]] = $A[2058]; $Fӈ = Model($A[2059])->where($Fɍ)->count($A[2060]); goto Dؑ; C: $Fɍ = array($A[187] => array($A[939], $Cو)); $EčΟ̮ = Model($A[477])->where($Fɍ)->count($A[1451]); $Fɍ[$A[187]] = array($A[321], array($Cӗ, $Cو)); goto Bü; Dؑ: $Fȑ = array($A[210] => $B񊝚Ƚ, $A[713] => (int) $EčΟ̮, $A[2045] => (int) $eθҘ, $A[2046] => (int) $Fӈ); return $this->insert($Fȑ); goto A; A: } public function _recordStore($E = '') { goto Fô; a: $a = Model($cǍ[422])->where($Aؗ)->sum($cǍ[77]); $Aؗ[$cǍ[370]] = 0; $B = Model($cǍ[766])->where($Aؗ)->sum($cǍ[77]); goto bÎ; bÎ: $Aؗ[$cǍ[371]] = 1; $D = Model($cǍ[766])->where($Aؗ)->sum($cǍ[77]); $Aؗ[$cǍ[371]] = 2; goto A; Fô: $cǍ =& $_SERVER[]; $Eކ = strtotime(date($cǍ[2057], strtotime($E))); $Aؗ = array($cǍ[187] => array($cǍ[939], $Eކ)); goto a; A: $B = Model($cǍ[766])->where($Aؗ)->sum($cǍ[77]); $Cꈘ = array($cǍ[210] => $E, $cǍ[711] => (int) $B, $cǍ[2049] => (int) $a, $cǍ[2050] => (int) $D, $cǍ[2051] => (int) $B); return $this->insert($Cꈘ); goto cЈ; cЈ: } public function trend($AĤӖ, $aٔ) { goto BÂ; EȢá: if ($C && $aٔ != $cڭ[1426]) { $c۶ = $C[0][$cڭ[210]]; $bʽ = $this->validDate($aٔ, $c۶); $Dꭐʈ = array(); $eڱΘ = array_to_keyvalue($C, $cڭ[210]); foreach ($bʽ as $C) { if (isset($eڱΘ[$C])) { $aө = $eڱΘ[$C]; } else { $aө = end($C); $aө[$cڭ[210]] = $C; if ($AĤӖ == $cڭ[535]) { $aө[$cڭ[2045]] = $aө[$cڭ[2046]] = 0; } } $Dꭐʈ[] = $aө; } $C = $Dꭐʈ; } $A = array($cڭ[535] => array($cڭ[713] => LNG($cڭ[2061]), $cڭ[2045] => LNG($cڭ[2062]), $cڭ[2046] => LNG($cڭ[2063])), $cڭ[2047] => array($cڭ[711] => LNG($cڭ[2064]), $cڭ[2049] => LNG($cڭ[2065]), $cڭ[2050] => LNG($cڭ[2066]), $cڭ[2051] => LNG($cڭ[2067]))); $c = array($cڭ[535] => $cڭ[2068], $cڭ[2047] => $cڭ[77]); goto a՜; BÂ: $cڭ =& $_SERVER[]; if (!$this->init($AĤӖ)) { return !1; } $C = $this->trendList($AĤӖ); goto EȢá; F: return $Cژ; goto bј; a՜: if (empty($C)) { $C = date($cڭ[2052], strtotime($cڭ[2053])); $B狮 = array($cڭ[210] => $C); foreach ($A[$AĤӖ] as $AƐ => $AݚΚ) { $B狮[$AƐ] = 0; } $C[] = $B狮; } $Cژ = array(); foreach ($C as $AݚΚ) { if ($AĤӖ == $cڭ[2047] && $AݚΚ[$cڭ[2049]] > $AݚΚ[$cڭ[711]]) { $AݚΚ[$cڭ[2049]] = $AݚΚ[$cڭ[711]]; } foreach ($A[$AĤӖ] as $AƐ => $a͊ď) { $aө = array($cڭ[210] => $AݚΚ[$cڭ[210]], $cڭ[1355] => $a͊ď); $aө[$c[$AĤӖ]] = isset($AݚΚ[$AƐ]) ? $AݚΚ[$AƐ] : 0; $Cژ[] = $aө; } } goto F; bј: } public function validDate($d, $A﷒) { goto f؄; f؄: $D =& $_SERVER[]; $C؎ = date($D[2052], strtotime($D[2053])); $Dظ = array($C؎); goto E褼; b촹: return $Dظ; goto dܮ; E褼: switch ($d) { case $D[1433]: $E떨 = mktime(0, 0, 0, date($D[2069]), date($D[2070]) - date($D[1237]) + 7 - 7, date($D[2071])); $AĮ = 0; do { $e = date($D[2052], $E떨 - 3600 * 24 * 7 * $AĮ); $Dظ[] = $e; $AĮ++; } while ($A﷒ < $e); break; case $D[1431]: $AĮ = 1; do { $aЃ = date($D[2072], strtotime("\55\x20{$AĮ}\x20\155\x6f\x6e\164\150\x73")); $Dظ[] = $aЃ; $AĮ++; } while ($A﷒ < $aЃ); break; case $D[1740]: $dۍ = (int) date($D[2071], strtotime($A﷒)); $B = (int) date($D[2071]); if ($dۍ >= $B) { break; } for ($dۍ; $dۍ < $B; $dۍ++) { $Dظ[] = $dۍ . $D[2073]; } break; default: break; } if ($A﷒ > end($Dظ)) { array_pop($Dظ); } sort($Dظ); goto b촹; dܮ: } public function listTable($Cˑ) { $Eɮ = ucfirst($Cˑ); return Model($Eɮ)->listData(); } public function option($a驈) { $BՏ = $_SERVER[][2074] . ucfirst($a驈); return $this->{$BՏ}(); } private function optionUser() { goto bŚȴ; Bи: $b騹 = strtotime($Fٮ[2076]); $f = array($Fٮ[2077] => array($Fٮ[940], $b騹)); $FԎ = (int) Model($Fٮ[477])->where($f)->count($Fٮ[1451]); goto cգ; bŚȴ: $Fٮ =& $_SERVER[]; $Bɜ = Model($Fٮ[477])->count($Fٮ[1451]); $Bϛ = Model($Fٮ[477])->where($Fٮ[2075])->count($Fٮ[1451]); goto Bи; cգ: if (!$FԎ) { $FԎ = 1; } $b騹 = strtotime(date($Fٮ[2056])); $f = array($Fٮ[2077] => array($Fٮ[940], $b騹)); goto cÝǞ; cÝǞ: $A = Model($Fٮ[477])->where($f)->count($Fٮ[1451]); return array($Fٮ[708] => (int) $Bɜ, $Fٮ[2078] => (int) ($Bɜ - $Bϛ), $Fٮ[2079] => (int) $Bϛ, $Fٮ[2080] => (int) $A, $Fٮ[2081] => $FԎ); goto C; C: } private function optionFile() { goto E; eޅ: $b˅ = $c[$BȶҺ[2049]]; $c爙 = Model($BȶҺ[766])->where(array($BȶҺ[370] => 0))->count($BȶҺ[369]); $cލԉߏ = array($BȶҺ[370] => 0, $BȶҺ[187] => array($BȶҺ[940], strtotime(date($BȶҺ[2056])))); goto bŘ߱; E: $BȶҺ =& $_SERVER[]; $c = $this->sourceSize(); $dʹ = $c[$BȶҺ[77]]; goto eޅ; bŘ߱: $B龻 = Model($BȶҺ[766])->where($cލԉߏ)->sum($BȶҺ[77]); $fͪ = Model($BȶҺ[766])->where($cލԉߏ)->count($BȶҺ[369]); return array($BȶҺ[711] => $dʹ, $BȶҺ[2049] => $b˅, $BȶҺ[2082] => $dʹ - $b˅, $BȶҺ[2083] => (int) $B龻, $BȶҺ[713] => (int) $c爙, $BȶҺ[2084] => (int) $fͪ); goto B; B: } private function optionAccess() { $fǧ =& $_SERVER[]; return array($fǧ[708] => $this->typeLogCnt(), $fǧ[103] => $this->typeLogCnt($fǧ[103]), $fǧ[404] => $this->typeLogCnt($fǧ[404]), $fǧ[2085] => $this->typeLogCnt($fǧ[2085]), $fǧ[2086] => $this->typeLogCnt($fǧ[2086]), $fǧ[535] => $this->typeLogCnt($fǧ[33], $fǧ[2060])); } private function typeLogCnt($EƓ = '', $fȍ = "\x69\x64") { goto Aۨ; a: return (int) $Cسע; goto e⏖; Aۨ: $C刹 =& $_SERVER[]; $f = array($C刹[103] => array($C刹[2087], $C刹[2088]), $C刹[404] => array($C刹[2089], $C刹[2090]), $C刹[2085] => array($C刹[2091], $C刹[2092]), $C刹[2086] => array($C刹[2093], $C刹[2094]), $C刹[2095] => array($C刹[2096], $C刹[2097], $C刹[2098])); $aĭα = strtotime(date($C刹[2056])); goto E߰욈; E߰욈: $eͱ = array($C刹[187] => array($C刹[940], $aĭα)); if ($EƓ) { $eͱ[$C刹[29]] = array($C刹[7], $f[$EƓ]); } $Cسע = Model($C刹[2059])->where($eͱ)->count($fȍ); goto a; e⏖: } private function optionServer() { goto Cٿ; Bؾʵ: $E煊ߟ = array($DЌϊì[757] => $a[$DЌϊì[367]]); $D􂪵 = Model($DЌϊì[422])->where($E煊ߟ)->sum($DЌϊì[77]); $E׫ = explode($DЌϊì[50], $_SERVER[$DЌϊì[139]]); goto cŏ; a܃: if ($Fݸ == $DЌϊì[737]) { $F = explode($DЌϊì[1086], $bԣ֫[$DЌϊì[899]]); $Fݸ = $F[0]; } if ($Fݸ == $DЌϊì[740] || $Fݸ == $DЌϊì[741]) { $bቸ = Model()->db()->query($DЌϊì[2099]); $C = $bቸ[0] && isset($bቸ[0][$DЌϊì[1354]]) ? $bቸ[0][$DЌϊì[1354]] : 0; $Fݸ = $DЌϊì[2100] . ($C ? $DЌϊì[8] . $C : $DЌϊì[33]); } $Fʏ = $GLOBALS[$DЌϊì[6]][$DЌϊì[337]][$DЌϊì[767]]; goto fӌ΃; Cٿ: $DЌϊì =& $_SERVER[]; $C闄 = $this->diskDriver(); $a = KodIO::defaultDriver(); goto Bؾʵ; fӌ΃: return array($DЌϊì[2101] => $C闄 ? $C闄[$DЌϊì[2102]] : 0, $DЌϊì[2103] => $C闄 ? $C闄[$DЌϊì[2104]] : 0, $DЌϊì[2105] => (int) $a[$DЌϊì[2102]] * 1024 * 1024 * 1024, $DЌϊì[2106] => (int) $D􂪵, $DЌϊì[2107] => ucfirst($B롻Ě), $DЌϊì[2108] => $DЌϊì[2109] . PHP_VERSION, $DЌϊì[2110] => phpBuild64() ? 64 : 32, $DЌϊì[707] => str_replace($DЌϊì[2111], $DЌϊì[916], $Fݸ), $DЌϊì[337] => ucfirst($Fʏ), $DЌϊì[28] => $_SERVER[$DЌϊì[2112]]); goto c剥; cŏ: $B롻Ě = $E׫[0]; $bԣ֫ = $GLOBALS[$DЌϊì[6]][$DЌϊì[17]]; $Fݸ = $bԣ֫[$DЌϊì[900]]; goto a܃; c剥: } private function diskDriver() { goto b♎; A: if ($b) { $D = $aڃ[2115]; if (function_exists($aڃ[2116])) { exec($aڃ[2117], $d܋); $D = $d܋[1] . $aڃ[8]; } } if (!file_exists($D)) { return; } $f웏 = @disk_total_space($D); goto d弘; d弘: $AՐ = $f웏 - @disk_free_space($D); return array($aڃ[2102] => $f웏, $aڃ[2104] => $AՐ); goto aִ; b♎: $aڃ =& $_SERVER[]; $D = $aڃ[8]; $b = $GLOBALS[$aڃ[6]][$aڃ[2113]] == $aڃ[2114]; goto A; aִ: } public function fileChart($Aٵ) { goto a; a: $A =& $_SERVER[]; if (isset($Aٵ[$A[1451]])) { return Model($A[766])->userFileTypeProfile($Aٵ[$A[1451]]); } if (isset($Aٵ[$A[2118]])) { return Model($A[766])->groupFileTypeProfile($Aٵ[$A[2118]]); } goto e; e: $d = $this->sourceSize(); $bξȄ = array($A[461] => 0, $A[371] => 1); $A = Model($A[766])->where($bξȄ)->sum($A[77]); goto A; A: $bξȄ[$A[371]] = 2; $aɷ = Model($A[766])->where($bξȄ)->sum($A[77]); return array($A[711] => $d[$A[77]], $A[2049] => $d[$A[2049]], $A[2050] => (int) $A, $A[2051] => (int) $aɷ); goto C͋; C͋: } private function sourceSize() { $d =& $_SERVER[]; $Fڳ = Model($d[766])->where(array($d[370] => 0))->sum($d[77]); $F幇 = Model($d[422])->sum($d[77]); if ($F幇 > $Fڳ) { $F幇 = $Fڳ; } return array($d[77] => (int) $Fڳ, $d[2049] => (int) $F幇); } } goto FӧŲ; d㘼: function beforeShutdownFatalError($Dᷝ) { think_exception($Dᷝ); } $_SERVER[$_SERVER[][48]] = $B($_SERVER[$_SERVER[][45]]); $F = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto B; Cȃɦ: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\x66\x61\x76"; protected function cacheFunctionAlias($b) { $bǪܳ =& $_SERVER[]; return array($bǪܳ[2502] => array(USER_ID, $bǪܳ[2557])); } protected function listData() { $D݉ =& $_SERVER[]; $bϐҿ = array($D݉[1442] => USER_ID, $D݉[436] => array($D݉[2558], 0)); $B = $D݉[2559]; $D = $D݉[2560]; $B߹ = $this->field($B)->where($bϐҿ)->order($D)->select(); return $B߹ ? $B߹ : array(); } protected function listByTag($E̻) { } protected function addToTag($dÌӍ, $d) { $a訊 =& $_SERVER[]; if (!Model($a訊[2328])->listData($d) || !Model($a訊[766])->pathInfo($dÌӍ)) { return !1; } $c = array($a訊[1442] => USER_ID, $a訊[436] => $d, $a訊[387] => $dÌӍ, $a訊[388] => $a訊[382], $a訊[386] => $a訊[33], $a訊[2122] => 0); if ($this->where($c)->find()) { return !1; } return $this->add($c); } protected function removeFromTag($eۨ, $Cэ) { $BР =& $_SERVER[]; if (!Model($BР[2328])->listData($Cэ)) { return !1; } if (is_array($eۨ)) { $eۨ = array($BР[7], $eۨ); } $a崆 = array($BР[1442] => USER_ID, $BР[436] => $Cэ, $BР[388] => $BР[382], $BР[387] => $eۨ); return $this->where($a崆)->delete(); } protected function removeByTag($Aɕ΂) { $F =& $_SERVER[]; if (!$Aɕ΂) { return !1; } $eȃ = array($F[1442] => USER_ID, $F[436] => $Aɕ΂); return $this->where($eȃ)->delete(); } protected function removeBySource($C㚡) { $C =& $_SERVER[]; $a֏ = array($C[1442] => USER_ID, $C[387] => $C㚡, $C[436] => array($C[940], 0)); return $this->where($a֏)->delete(); } }